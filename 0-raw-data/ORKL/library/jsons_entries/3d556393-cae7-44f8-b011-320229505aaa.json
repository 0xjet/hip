{
    "id": "3d556393-cae7-44f8-b011-320229505aaa",
    "created_at": "2022-10-25T16:48:15.914952Z",
    "updated_at": "2025-03-27T02:16:13.99902Z",
    "deleted_at": null,
    "sha1_hash": "e58ce98ef061a0c2dd538e2fe1cc6dc9df402285",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-02-10T14:46:59Z",
    "file_modification_date": "2022-02-10T14:46:59Z",
    "file_size": 2262826,
    "plain_text": "# Iranian APT MuddyWater targets Turkish users via malicious PDFs, executables\n\n**[blog.talosintelligence.com/2022/01/iranian-apt-muddywater-targets-turkey.html](https://blog.talosintelligence.com/2022/01/iranian-apt-muddywater-targets-turkey.html)**\n\n[By Asheer Malhotra and Vitor Ventura.](https://twitter.com/asheermalhotra)\n\nCisco Talos has observed a new campaign targeting Turkish private organizations alongside\ngovernmental institutions.\nTalos attributes this campaign with high confidence to MuddyWater — an APT group recently\n[attributed to Iran's Ministry of Intelligence and Security (MOIS) by the U.S. Cyber Command.](https://www.cybercom.mil/Media/News/Article/2897570/iranian-intel-cyber-suite-of-malware-uses-open-source-tools/)\nThis campaign utilizes malicious PDFs, XLS files and Windows executables to deploy malicious\nPowerShell-based downloaders acting as initial footholds into the target's enterprise. MuddyWater's\nuse of script based components such as obfuscated PowerShell based downloaders is also a tactic\ndescribed in the advisory from January 2021 by the U.S. Cyber Command.\nThis campaign also utilizes canary tokens to track successful infection of targets, a new addition to this\ngroup's arsenal of tactics, techniques and procedures (TTPs).\nThis specific method of taking advantage of canary tokens in this campaign may also be a measure to\nevade sandbox based detection systems.\nA highly motivated threat actor such as MuddyWater can use unauthorized access to conduct\n[espionage, intellectual property theft and deploy ransomware and destructive malware in an](https://www.cisa.gov/uscert/ncas/alerts/aa20-006a)\nenterprise.\n\n## Executive summary\n\nMuddyWater has conducted various campaigns against entities spread throughout the U.S.A, Europe,\nMiddle East and South Asia.\n\nA typical TTP employed by the group is the heavy use of scripting in their infection chains using languages\n[like PowerShell and Visual Basic coupled with the frequent use of living-off-the-land binaries (LoLBins).](https://blog.talosintelligence.com/2019/11/hunting-for-lolbins.html)\n\n\n-----\n\nCisco Talos recently observed a campaign operated by MuddyWater targeting users in Turkey. This\ncampaign consists of the use of malicious PDFs and Microsoft Office documents (maldocs) to serve as the\ninitial infection vector. These maldocs were named in such a way as to masquerade as legitimate documents\nfrom the Turkish Health and Interior Ministries.\n\nNext, the malware executes a series of scripts deployed on the infected endpoint to serve as downloaders and\ninstrumentors for additional payloads.\n\nWe've also discovered the use of flags or tokens in attacks conducted by this threat actor in this campaign.\nThese tokens are meant to signal a successful infection of a target by the group's malicious artifacts.\n\n## MuddyWater threat actor\n\nMuddyWater, also known as MERCURY or Static Kitten, is an APT group recently attributed to Iran's\n[Ministry of Intelligence and Security (MOIS) by U.S. Cyber Command. This threat actor, active since at least](http://vaja.ir/)\n[2017, frequently conducts campaigns against high-value targets in American, European and Asian countries.](https://malpedia.caad.fkie.fraunhofer.de/actor/muddywater)\nCampaigns carried out by the threat actor aim to achieve either of three outcomes:\n\nEspionage - Supporting the political dominance of the nation state in the Middle East. This is business\nas usual for the threat actor, motivated by nation-state interests.\n[Intellectual property theft - Enables economic advantages to the nation state. This goal is](https://www.cisa.gov/uscert/ncas/alerts/aa20-006a)\n[accomplished by carrying out aggressive campaigns against private entities and government affiliated](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/seedworm-espionage-group)\ninstitutions such as universities and research entities.\n[Ransomware attacks - MuddyWater has previously attempted to deploy ransomware such as Thanos](https://www.zdnet.com/article/iranian-state-hacker-group-linked-to-ransomware-deployments/)\non victim networks to either destroy evidence of their intrusions or disrupt operations of private\norganizations.\n\nThis group frequently relies on the use of DNS as part of their means to contact the command and control\n(C2), while the initial contact with hosting servers is done via HTTP. Their initial payloads usually use\nPowerShell and Visual Basic scripting along with LoLBins to assist in the initial stages of the infection.\n\n## Campaign targeting Turkey\n\nTalos recently observed a campaign operating as recently as November 2021, which we attribute with high\nconfidence to the MuddyWater group, targeting Turkish government entities, including the Scientific And\nTechnological Research Council of Turkey — Tubitak. This campaign consisted of the use of malicious excel\ndocuments (XLS maldocs) and executables stored on a file hosting domain \"snapfile[.]org\", which would be\ndelivered to the victims in the form of PDF documents with embedded links.\n\nThese maldocs, hosted on attacker-controlled or public media-sharing websites are downloaded by\nmalicious PDFs meant to trick the targets into downloading and opening the maldocs. Based on historic\nevidence of similar campaigns conducted by MuddyWater, it is highly likely that these PDFs served as the\ninitial entry points to the attacks and were distributed via email messages as part of spear-phishing efforts\nconducted by the group.\n\n### Malicious Excel sheets analyses\n\nTalos identified a set of malicious Microsoft Excel spreadsheet files distributed with Turkish language\nnames. Some of these files were named to masquerade as legitimate documents from the Turkish Health and\n\n\n-----\n\nInterior Ministries.\n\nAnother file discovered was called \"Teklif_form_onaylı.xls,\" which can be translated to\n\"Offer_form_approved.xls\" from Turkish. Analysis of the maldocs deployed in this campaign demonstrates\na clear evolution of their implementation culminating into versions that are fully obfuscated.\n\nThe documents have some subtle changes — almost like different versions — were being tested. Older\ndocuments had some information in the document's metadata, such as the title field \"Sayyid\"' and author\nname \"Aurelia\". These initial versions also consisted of an un-obfuscated PowerShell payload in the\ndocument's comments fields. Subsequent iterations of the maldocs saw progressive obfuscation of various\nmalicious code blocks.\n\nNow, the maldocs consist of malicious VBA macros meant to instrument the infection chain. Overall, the\nmacro contained in all the maldocs accomplished the same set of functionalities without any major\nevolutions as described below.\n\n**Persistence**\n\nThe infection chain instrumented by the VBA macros consist of creating three key artifacts on the infected\nendpoint:\n\nRegistry key for persistence.\nMalicious VB script intermediate component that the macro sets up for persistence.\nMalicious PowerShell-based downloader script: The actual post-infection, payload instrumentor used\nfor executing arbitrary code on the infected endpoint.\n\nThe VB script's persistence is set up by creating a malicious Registry Run for the infected user:\nHKCU\\Software\\Microsoft\\windows\\CurrentVersion\\Run | <random>\n\nThis campaign relies on the use of a LoLBin to execute the malicious VBScript.\n\nIn some instances, the attackers make use of a LoLBin DLL called pcwutl.dll, which is part of the operating\nsystem, to execute the VBScript on reboot or re-login. Although the usage of LoLBins is fairly common as a\nmeans of lateral movement, it is not commonly used to execute the malicious payload.\n\n**Tracking tokens**\n\nAs the maldocs were evolving, some of the metadata details were removed or generalized, and eventually,\nthe latest versions consisted of obfuscated PowerShell payloads residing in the comments field.\n\n\n-----\n\nThe malicious VBA macros consisted of the same set of functionalities for creating the malicious VBS and\nPS1 scripts, and achieving persistence across reboots. However, there was one interesting addition to the\nmacro functionality now. The latest versions of the VBA code deployed could make HTTP requests to a\ncanary token from canarytokens.com.\n\nCanary tokens are tokens that can be embedded in objects like documents, web pages and emails. When that\nobject is opened, an HTTP request to canarytokens.com is generated, alerting the token's owner that the\nobject was opened.\n\nThe canary token is typically silently executed twice during the execution of the macro. In cooperation with\n[Canarytokens.com, a list of other tokens created by the same user was added to the IOC section below.](http://canarytokens.com/)\n\nAn attacker may use such tokens to serve one or more purposes such as:\n\nTracking Tokens: A way of tracking who is detonating the malicious code, keeping track of successful\ninfections.\n\nTracking tokens can be an anti-analysis method. In this campaign, the server that hosts the final\npayload may only deliver if it first receives two almost simultaneous requests to the token. This would\nthwart researchers that solely request the payload from the server without registering with the canary\ntokens using an HTTP request.\n\nTracking tokens may also be used as another means of anti-analysis: timing checks. The infection\nchain consists of a PS1-based downloader and two sets of HTTP requests for the canary tokens. A\nreasonable timing check on the duration between the token requests and the request to download a\npayload can indicate automated analysis. Automated sandboxed systems would typically execute the\nmalicious macro generating the token requests. A sandbox would also identify the creation of the\nregistry Run key and re-login the infected user to execute the malicious PS1 that generates the request\nto download the next payload. Typically, since sandbox-based analysis systems spin up analysis\nenvironments for a limited number of minutes, the token requests and payload requests wouldn't be\ntoo far apart from each other temporally. A substantially low interval between the HTTP token\nrequests and PS1 requesting the payload may indicate automated analysis of the maldocs and can be\nused to block payload requests from the infected endpoint.\n\nTracking tokens can also be a method to detect the blocking of the payload server. If they keep\nreceiving requests to the token but not to the payload server, that is an indication of their payload\nserver being blocked, and by whom.\n\n**Intermediate VB Script component (VBS)**\n\n\n-----\n\nThe VBS file is a straightforward executor of the PowerShell script dropped by the macro to disk.\n\nVBS executing the PS1 on the endpoint.\n\n**Malicious PowerShell-based downloader**\n\nThe PowerShell script deployed in the attack is meant to download and execute the next payload (also a PS1\nscript) on the infected endpoint. This PS1 script resides in the metadata of the maldoc and is dropped by the\nmacro.\n\nPrimitive versions of the maldocs consisted of unobfuscated versions of the PS1 script, with obfuscations\nbeing introduced in newer versions.\n\nPS1 downloader script.\n\nThe PowerShell script that downloads another PowerShell from a remote location which will then be\nexecuted. It tries twice, with a custom timeout of 40 seconds and a custom user agent, which is appended\nwith the character \"|\" separator and the username executing the script. In other versions of script, the \"|\"\ncharacter is not appended.\n\nThe fact that the downloader script attempts the download of the payload twice with a big timeout further\nindicates that the canarytokens serve the purpose of anti-analysis. That is, the C2 may need more time to\ncheck if the canarytokens have been accessed before it delivers the final payload. We could not obtain the\nfinal payload, but our tests indicate that there was some kind of verification process being performed prior\nto the delivery of the payload.\n\n### Infection chain\n\nThe delivery mechanism for this campaign is the distribution of PDF files containing embedded links. Talos\nfound at least two PDF files which shared the same author name, \"nejla\", in the metadata. The PDF files\ntypically show an error message and ask the user to click on a link to resolve the issue and display the correct\nformat/extension of the document.\n\n\n-----\n\nOnce the victim clicks on the download button, the endpoint receives a second stage, which can be either a\nmalicious XLS file or a Windows executable that proceeds with the infection as described earlier.\n\nThe maldoc-based infection chain is as follows:\n\n\n-----\n\n### Malicious executables-based infection chain\n\nThe initial delivery mechanism of the infection chains consists of the malicious PDF files as the first stage.\nThe URLs corresponding to the download button in the PDF files will typically host the malicious XLS files\ncontaining the macros that deploy the subsequent VBS and PS1 scripts.\n\nWe have, however, recently observed a variation of this infection chain. This second variation consists of the\nPDF pointing to a URL that delivers a Windows executable (EXE) in the infection chain instead of the\nmalicious XLS files.\n\nThe EXEs are meant to instrument a similar infection chain consisting of the intermediate VBS and final\nPS1-based downloaders.\n\n**Turkey**\n\nThe EXEs typically use a Turkish name indicating that they can either be delivered via the malicious PDFs or\ndistributed independently. One example of an executable was named \"Surec_No_cc2021-pdf377811f**66ad-4397-bd35-3247101e2fda-eta332018.exe\" which can be translated from Turkish as**\n\"Period_No_<...>32018.exe.\"\n\nOnce executed, the sample drops a text file in the victim's temporary folder. This is actually a decoy PDF or\nOffice document in hex format. During execution, the hex representation of the decoy document is hexlified\nto create a readable copy in the %temp% folder. The decoy will then be opened by the system PDF or\ndocument reader and displayed to the victim.\n\n\n-----\n\nOne of the decoy documents used in the EXE based threat vector with similar content to the initial PDF files\ndistributing the maldocs and EXEs.\n\nOnce the decoy document has been displayed to the victim, the executable starts its main malicious task:\nDownloading and executing malicious PowerShell scripts served to it by a remote location. Here, we see that\nthe intermediate VBS scripts used in the maldoc based infection chain have been replaced with a\nPowerShell-based implementation.\n\nThe implant will first create a directory in the user's home folder. This directory will be used to store two\nPowerShell scripts:\n\nInstrumentor script used to activate the next stage from disk called \".CloudCache.conf.\"\nDownloader script used to download the next stage from a remote location for execution on the\nendpoint called \".CloudDrive.conf.\"\n\nJust like maldoc-based infections, a registry key is created at\nHKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN | <Some Application Name> for\npersistence.\n\nFor example:\n\nHKCU\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN | CloudDrive.\n\nThe registry Run key takes advantage of lolbins to run the payload. In this case, it uses\n[SyncAppvPublishingServer.vbs to execute PowerShell code, which will execute the code stored in the](https://lolbas-project.github.io/lolbas/Scripts/Syncappvpublishingserver/)\ninstrumentor script (\".CloudCache.conf\"):\n\n\n-----\n\n```\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n\"CloudDrive\"=\"C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs \\\"n;.('{2}{0}{1}' -f[string]\n[char][int]101,[string][char][int]88,'i')((.('{2}{0}{1}' -f[string][char][int]101,[string][char]\n[int]88,'i')((Get-content $env:USERPROFILE\\\\.CloudDrive\\\\.CloudCache.conf))))\\\"\"\n\n```\nThe instrumentor script is responsible for base64 decoding the contents of the downloader (the second PS1\nscript) and executing it on the endpoint.\n\nContents of the instrumentor PS1 .CloudCache.ps1.\n\nThe second PS1 script is the actual downloader of the next stage of PowerShell code that is run on the\ninfected endpoint. It downloads the next stage of PowerShell code from a remote location and executes it on\nthe infected endpoint.\n\n\n-----\n\nDownloader script.\n\nUnfortunately, there was no way for us to download the final payload.\n\n**Pakistan**\n\nAnother version of the executable deployed by the attacker in August 2021 targeted Pakistani entities. We\nare unsure at this time whether the November 2021 targeting of Turkish users is a continuation of this\nPakistan-related activity.\n\nThis executable again consists of a decoy document presented to the victim followed by the instrumentation\nof a PowerShell-based downloader script.\n\n\n-----\n\nThis executable also uses the Registry run key for persistence of its artifacts on the system. However, in this\ncase, we saw a variation in the infection chain:\n\nThe attackers skipped using the instrumentor PS1 script as seen in the latest infection chain (described\nabove).\nInstead, the attackers configured the Registry run key to execute the downloader script directly via\n[SyncAppvPublishingServer.vbs.](https://lolbas-project.github.io/lolbas/Scripts/Syncappvpublishingserver/)\n```\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n\"OwnDrive\"=\"C:\\\\Windows\\\\System32\\\\SyncAppvPublishingServer.vbs \\\"n;.('{2}{0}{1}' -f[string][char]\n[int]101,[string][char][int]88,'i')\n([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String((Get-content\n $env:USERPROFILE\\\\.VirtualBoxer\\\\.VirtualBoxer.conf))))\\\"\"\n\n```\nThe downloader script used in this instance consists of capabilities to collect preliminary data, such as the\ncomputer name, to register the infection with the C2 server.\n\nThe script will then reach out to the C2 for requesting PowerShell commands to execute. The response\nreceived is parsed by the implant to check if the computer name sent back by the C2 matches the current\ncomputer name. If a match is found, the corresponding PowerShell commands issued by the C2 are executed\non the endpoint and the output/response is AES encrypted and returned to the C2.\n\nThe URL for returning the output of a command executed on the system is:\n\nhttp://<C2_IP>/images?guid=<base64_encoded + AES encrypted output>\n\nThe User Agent used for all these communications is: Googlebot/2.1 (+http://www.google.com/bot.html)\n\n\n-----\n\nPS1-based downloader script.\n\nTracking Tokens\n\nWe observed the decoy documents reaching out to a remote location:\n\nhxxp://172.245.81[.]135:10196/Geq5P3aFpaSrK3PZtErNgUsVCfqQ9kZ9/Pan-op/gallery.jpg\n\n\n-----\n\nSimilar URLs on this server were accessed in previously observed MuddyWater campaigns targeting\nPakistan.\n\nIt is highly likely that the attackers used this server as a token tracker to monitor successful infections in this\ncampaign. This token tracking system was then later migrated to CanaryTokens in September 2021 in the\nattacks targeting Turkey using the malicious Excel documents (illustrated earlier).\n\n**Armenia**\n\nAnother example of a similar executable used by the threat actor in June 2021 was one to target the\ntelecommunications sector in Armenia. The decoy document displayed to the victim in this case consists of\n[an internal guide (Maintenance Operation Protocol (MOP)) for Armenia's Viva-MTS telecom solution](https://www.mts.am/en)\nprovider from Ericsson pertaining to their Smart Services Routers (SSRs) and Evolved Packet Gateway\n(EPG).\n\nDecoy document used while targeting Telecom entities.\n\nWhat's interesting is that the decoy document was created on June 6, 2021 and modified on June 8. The\nmalicious executable carrying this decoy was generated a day later on June 9, thus, it is likely that either the\nattackers created the draft of the decoy themselves or had immediate access to their victims that enabled\nthem to exfiltrate documents that were then used as decoys and lures to proliferate their campaigns to\nsimilar targets of interest.\n\nThe entire infection chain employed in this campaign, using the malicious PowerShell based downloader,\nwas later seen again in the attack targeting Pakistani entities in August 2021.\n\nThe EXE-based infection chain is as follows:\n\n\n-----\n\n### Attribution\n\nTalos assesses with high confidence that these campaigns are the work of the Iranian state-sponsored threat\nactor MuddyWater. This assessment is based on both technical indicators and the tactics, techniques, and\nprocedures (TTPs) employed by the threat actor. The infection chains used in the campaigns illustrated in\n[this research bear a close resemblance to those described in Secureworks' report from 2020. We also have a](https://www.secureworks.com/blog/business-as-usual-for-iranian-operations-despite-increased-tensions)\nhigh-fidelity IOC from a trusted source that was used in a key part of the infection chains. This IOC has also\nbeen used in previous MuddyWater campaigns.\n\nWhile we cannot disclose additional details at this time due to intelligence sharing sensitivities, we assess\nthat this particular finding is significant enough to justify a high-confidence assessment on attribution.\n\nThe malicious XLS lures and the executables used in this campaign deploy two malicious files - a loader and\na downloader that retrieve the final payloads using a hardcoded URL pointing to a specific hardcoded IP\naddress. Secureworks' report shows the same technique, albeit based on a batch file and a PowerShell script,\nwhile the campaign targeting Turkish entities use either a VBS or PS1 script activated via a simple registry\nentry. In both cases, the key PowerShell script's only objective is to download malicious payloads from the\nC2.\n\nCode and metadata similarities in the maldocs and accompanying scripts utilized in this campaign bear a\n[high degree of resemblance to previously discovered MuddyWater artifacts.](https://www.virustotal.com/gui/search/comment%25253A%252522APT_MuddyWater_MalDoc_Feb20_1%252522/files)\n\n(A high-fidelity YARA rule for tracking artifacts related to this campaign and previously discovered\n[MuddyWater artifacts is APT_MuddyWater_MalDoc_Feb20_1, authored by Florian Roth.)](https://valhalla.nextron-systems.com/info/rule/APT_MuddyWater_MalDoc_Feb20_1)\n\nOne of the C2 IP addresses used by the malicious PowerShell downloaders deployed in this campaign,\n185[ ]118[ ]167[ ]120 is also listed in a Turkish threat advisory dated September 2021\n\n\n-----\n\n[English translation of a threat advisory from Trakya.](https://bidb-trakya-edu-tr.translate.goog/news/kurum-ve-kuruluslara-yonelik-apt-saldirilari?_x_tr_sl%3Dtr%26_x_tr_tl%3Den%26_x_tr_hl%3Den%26_x_tr_pto%3Dsc)\n\n[This advisory from the Trakya University in Turkey and a USOM (Turkey National Cyber ​​Incident Response](https://www-en.trakya.edu.tr/)\nCenter) announcement contains an alert to an APT-level attack. The initial attack vector is the email service,\nwith emails sent from the following attacker-owned accounts:\n\nsisterdoreencontreve@gmail[.]com\nlillianwnwindrope@gmail[.]com\ndoctor.x.2020@gmail[.]com\nubuntoubunto1398@gmail[.]com\na.sara.1995a@gmail[.]com\n\nThis advisory lists C2 IP addresses that have also been observed in the this campaign:\n\n**185[.]118[.]167[.]120**\n**185[.]118[.]164[.]165**\n**185[.]118[.]164[.]195**\n185[.]118[.]164[.]213\n\nThe bolded IPs (first three in the list) are used by the PowerShell scripts dropped by the malicious XLS lures\nto download a payload.\n\nTalos confirmed the usage of the email address doctor.x.2020@gmail[.]com listed in the advisory to this\ncampaign using XLS and executables targeting Turkey.\n\n\n-----\n\n## Conclusion\n\nTalos has observed Iranian related groups carry out malicious campaigns all over the world in recent years.\n2021 was also prolific in cybersecurity incidents targeting Iranian state-run organizations. These events were\n[attributed to Western nations by the Iranian regime, with the promise of revenge. It's hard to say if these](https://www.reuters.com/business/energy/iran-says-israel-us-likely-behind-cyberattack-gas-stations-2021-10-30/)\ncampaigns are the result of such promises or just part of MuddyWater's usual activity.\n\nHowever, the fact that the threat actors have changed some of their methods of operation and tools is\nanother sign of their adaptability and unwillingness to refrain themselves from attacking other nations. In\nthis post we have shown the same group running two different campaigns using different tools while\ntargeting the same country, in this case Turkey, showing their capacity and motivation to compromise their\ntargets and perform their espionage activities.\n\nIn-depth defense strategies based on a risk analysis approach can deliver the best results in the prevention.\nHowever, this should always be complemented by a good incident response plan which has been not only\ntested with table top exercises and reviewed and improved every time it's put to the test on real\nengagements.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n\n-----\n\n[Cisco Secure Endpoint (formerly AMP for Endpoints) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\n[malware detailed in this post. Try Secure Endpoint for free here.](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/free-trial.html?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Damp-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Damp-free-trial)\n\n[Cisco Secure Web Appliance web scanning prevents access to malicious websites and detects malware used](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\nin these attacks.\n\n[Cisco Secure Email (formerly Cisco Email Security) can block malicious emails sent by threat actors as part](https://www.cisco.com/c/en/us/products/security/email-security/index.html)\n[of their campaign. You can try Secure Email for free here.](https://www.cisco.com/c/en/us/products/security/cloud-mailbox-defense?utm_medium%3Dweb-referral%26utm_source%3Dcisco%26utm_campaign%3Dcmd-free-trial-request%26utm_term%3Dpgm-talos-trial)\n\n[Cisco Secure Firewall (formerly Next-Generation Firewall and Firepower NGFW) appliances such as Threat](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Defense Virtual, Adaptive Security Appliance and Meraki MX can detect malicious activity associated with](https://www.cisco.com/c/en/us/products/security/adaptive-security-appliance-asa-software/index.html)\nthis threat.\n\n[Cisco Secure Network/Cloud Analytics (Stealthwatch/Stealthwatch Cloud) analyzes network traffic](https://www.cisco.com/c/en/us/products/security/stealthwatch/index.html)\nautomatically and alerts users of potentially unwanted activity on every connected device.\n\n[Cisco Secure Malware Analytics (Threat Grid) identifies malicious binaries and builds protection into all](https://www.cisco.com/c/en/us/products/security/threat-grid/index.html)\nCisco Secure products.\n\n[Umbrella, Cisco's secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs](https://umbrella.cisco.com/)\n[and URLs, whether users are on or off the corporate network. Sign up for a free trial of Umbrella here.](https://signup.umbrella.com/?utm_medium%3Dweb-referral?utm_source%3Dcisco%26utm_campaign%3Dumbrella-free-trial%26utm_term%3Dpgm-talos-trial%26utm_content%3Dautomated-free-trial)\n\n[Cisco Secure Web Appliance (formerly Web Security Appliance) automatically blocks potentially dangerous](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\nsites and tests suspicious sites before users access them.\n\nAdditional protections with context to your specific environment and threat data are available from the\n[Firewall Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\n[Cisco Duo provides multi-factor authentication for users to ensure only those authorized are accessing your](https://signup.duo.com/?utm_source%3Dtalos%26utm_medium%3Dreferral%26utm_campaign%3Dduo-free-trial)\nnetwork.\n\nOpen-source Snort Subscriber Rule Set customers can stay up to date by downloading the latest rule pack\n[available for purchase on Snort.org.](https://www.snort.org/products)\n\nSnort SIDs for this threat are: 58929-58938.\n\n**Orbital Queries**\n\n[Cisco Secure Endpoint users can use Orbital Advanced Search to run complex OSqueries to see if their](https://orbital.amp.cisco.com/help/)\nendpoints are infected with this specific threat. For specific OSqueries on this threat, click below:\n\n[Powershell scripts](https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/malware_muddywater_powershell_file_path.yaml)\n[VB Scripts](https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/malware_muddywater_vbscript_registry_persistence.yaml)\n\n## IOCS\n\n[We would like to thank Canary Tools for their cooperation, support and inputs into this research.](https://help.canary.tools/hc/en-gb)\n\n**Hashes**\n\n\n-----\n\n8d6ed63f2ffa053a683810f5f96c76813cdca2e188f16d549e002b2f63cee001\n42aa5a474abc9efd3289833eab9e72a560fee48765b94b605fac469739a515c1\n\nd3ecc4137fc9a6d7418b4780864baf64cf7417d7badf463dff6ea48cd455915b\n\n9991b185c9e9732501e0c2bd841e32a4022f0735a0527150bc8e64ac363d409d\n\nd9de66497ad189d785d7535ab263e92ffad81df20b903c5e1d36859b4ed38b6d\n\n5cdc7dd6162a8c791d50f5b2c5136d7ba3bf417104e6096bd4a2b76ea499a2f4\n\n26ed7e89b3c5058836252e0a8ed9ec6b58f5f82a2e543bc6a97b3fd17ae3e4ec\n\na8701fd6a5eb45e044f8bf150793f4189473dde46e0af8314652f6bf670c0a34\n\nb726f4dd745891070f2e516d5d4e4f2f1ce0bf3ff685dc3800455383f342e54d\n\nc9931382f844b61a002f83db1ae475953bbab449529be737df1eee8b3065f6eb\n\nfcdd38ff378605c66333429d9df2242fbce25a5f69f4d6d4c11d9613bcb409b0\n\nc13cb1c9277324534075f807a3fcd24d0d3c024197c7437bf65db78f6a987f7a\n\n450302fb71d8e0e30c80f19cfe7fb7801b223754698cac0997eb3a3c8e440a48\n\nb1e30cce6df16d83b82b751edca57aa17795d8d0cdd960ecee7d90832b0ee76c\n\n921b4520b75fcd0071944a483d738223b222ba101e70f2950fbfbc22afbdb5d0\n\nd7de68febbbdb72ff820f6554afb464b5c204c434faa6ffe9b4daf6b691d535f\n\n8b9be9e4d18c5fc71cd12dbfd60ea41eb88a07497e96faa2ba20fdc929b32c0b\n\n7dc49601fa6485c3a2cb1d519794bee004fb7fc0f3b37394a1aef6fceefec0c8\n\na69fee382cf86f9e457e0688932cbd00671d0d5218f8043f1ee385278ee19c8c\n\n63e404011aeabb964ce63f467be29d678d0576bddb72124d491ab5565e1044cf\n\n6910ddb58aee9a77e7bb9cadef9e6280a9b5b495edf0b6538cf8bdc1db8b1f4c\n\nd851badfcf3b3a8b4210bdb33948d0d1d918ec6bf0f1f85cbae6bb8feec7cd74\n\naa72f1543d4a4e6ecbfc2da0167f5601c5c692bed73243cf01f616bc4af68afe\n\n8f255a1f2e17828a5b9205d6991e2c85c3320311da28048785262396cbc568c7\n\ncddd5514b7ed3d33ff8eaa16b7b71621ced857755246683e0d28c4650ea744bf\n\nb4d0161ecab5a7847d325c88ce1a4fc2ca2e11fad0b77638b63ae1781c8b5793\n\nf6569039513e261ba9c70640e6eb8f59a0c72471889d3c0eaba51bdebb91d285\n\n28f2198f811bbd09be31ad51bac49ba0be5e46ebf5c617c49305bb7e274b198c\n\n04d6ed9c6d4a37401ad3c586374f169b0aa8d609710bdcf5434d39e0fd4ed9bd\n\n69e3a454c191ee38663112cf5358a54cca1229188087ed18e92bc9c59b014912\n\ndc28b5e878152b5305b8d251019895caa56a7a95a68eccb89a6ecc41da8aadb9\n\n**IPs**\n\n**URLs**\n\nhxxp://185.118.167[.]120/\n\nhxxp://137.74.131[.]16:443/\n\nhxxp://185.141.27[.]211:443/\n\nhxxp://149.202.242[.]84:443/\n\nhxxp://172.245.81[.]135:10196/Geq5P3aFpaSrK3PZtErNgUsVCfqQ9kZ9/ef4f0d9af47d737076923cfccfe01ba7/layer.jpg\nhxxp://172.245.81[.]135:10196/Geq5P3aFpaSrK3PZtErNgUsVCfqQ9kZ9/Pan-op/gallery.jpg\n\nhxxps://snapfile[.]org/d/c7817a35554e88572b7b\n\nhxxps://snapfile[.]org/d/0c88a47c3160338bbb68\n\nhxxp://snapfile[.]org/756a12c43a0fb8d56fbf\n\nhxxps://snapfile[.]org/5bc3985cf17565a97dbd\n\nhxxps://snapfile[.]org/55e1c83e920bb7dc949c\n\nhxxp://canarytokens[.]com/about/d3g23n4gdcrep20q3wzm153xn/index.html\n\nhxxp://canarytokens[.]com/tags/traffic/images/azp6ai8pg5aq0c619ur0qzi6h/\n\nhxxp://canarytokens[.]com/tags/traffic/images/azp6ai8pg5aq0c619ur0qzi6h/post.jsp\n\n\n-----\n\n**Other canary tokens used by MuddyWater:**\n\noy80la8r9iyub22nbhb7wvxrk\n\nkbu1xo0s8ktfxrzsn9iuei3e9\n\nazp6ai8pg5aq0c619ur0qzi6h\n\no1txrtd8gn7i9rt159k5baoys\n\nsmnszrsk7gqjplt0j1idwjrcr\nagsbmym5re3whgnd5a8kzntai\n\n60ld4guht70xby71u3io4w43n\n\nlmbvetj0iif8dwjgutckpppq3\n\nkc7snpabrp9z0wp1p1klqgkr9\n\n04p62zz698bdzv2fdbgupdm4j\n\nmpei7e608jb22i90z9x8g0gdu\n\nqut1gl1r6ywzgs1ts922sxtqv\n\n09xzzwe761avzxxmyzi85r7hv\n\nnx4fiakqe1gc02hrnlv8fyis4\n\nb90963gx06jykhz61kv534zcm\n\nbruhtg2dtbzk7j1fsttxga85e\n\nd3g23n4gdcrep20q3wzm153xn\n\nxxe2sm2rddhxfto9gjx25fo9c\n\ngikx04xwvf3uu4af8ekrvfeoj\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2022/2022.01.31.MuddyWater_Turkish/Cisco%20Talos%20Intelligence%20Group%20-%20Comprehensive%20Threat%20Intelligence_%20Iranian%20APT%20MuddyWater%20targets%20Turkish%20users%20via%20malicious%20PDFs%2C%20executables.pdf"
    ],
    "report_names": [
        "Cisco Talos Intelligence Group - Comprehensive Threat Intelligence_ Iranian APT MuddyWater targets Turkish users via malicious PDFs, executables"
    ],
    "threat_actors": [
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041773,
    "ts_creation_date": 1644504419,
    "ts_modification_date": 1644504419,
    "files": {
        "pdf": "https://archive.orkl.eu/e58ce98ef061a0c2dd538e2fe1cc6dc9df402285.pdf",
        "text": "https://archive.orkl.eu/e58ce98ef061a0c2dd538e2fe1cc6dc9df402285.txt",
        "img": "https://archive.orkl.eu/e58ce98ef061a0c2dd538e2fe1cc6dc9df402285.jpg"
    }
}