{
    "id": "62e014f9-038c-46cc-8879-0e2527b4117d",
    "created_at": "2023-01-12T15:02:14.062501Z",
    "updated_at": "2025-03-27T02:14:42.869396Z",
    "deleted_at": null,
    "sha1_hash": "6b2adfdd76654e2cfbd71febeb57b9fee0882f67",
    "title": "2020-12-31 - StrongPity APT Extends Global Reach with New Infrastructure",
    "authors": "",
    "file_creation_date": "2022-05-27T23:07:24Z",
    "file_modification_date": "2022-05-27T23:07:24Z",
    "file_size": 847576,
    "plain_text": "# StrongPity APT Extends Global Reach with New Infrastructure\n\n**[cybleinc.com/2020/12/31/strongpity-apt-extends-global-reach-with-new-infrastructure/](https://cybleinc.com/2020/12/31/strongpity-apt-extends-global-reach-with-new-infrastructure/)**\n\nDecember 30, 2020\n\nStrongPity/Promethium APT, also known as APT-C-41, has been active since at least 2012.\nIt was first publicly reported in October 2016, after cyberattacks against users in Belgium and\nItaly in which it used the watering-hole attack technique to deliver malicious versions of\nWinRAR and the TrueCrypt file encryption software.\n\nThe group chiefly uses Truvasys, a first-stage malware that has been employed in several\nattack campaigns with trojanized common computer utilities, including WinRAR, WinUtils,\nTrueCrypt, or SanDisk. In each of its campaigns, the Truvasys malware has emerged with\nevolved features.\n\nResearchers described StrongPity as having the distinctive features of an APT unit that\nutilizes zero-day vulnerabilities and sophisticated attack tools to invade victims for\nespionage. After the 2016 attack, the threat actor has expanded its TTPs to include watering\nhole attacks and mass phishing email campaigns.\n\nHere is the timeline of StrongPity APT group starting from 2016.\n\n\n-----\n\nFigure 1. Timeline of the StrongPity APT attacks\nIn 2016, APT-C-41 was mostly targeting countries like Italy and Belgium. However, its victims\nare now widespread across Europe, Northern Africa, Canada, and Asia. Focused on finding\nand exfiltrating data from infected machines, the StrongPity APT group runs a series of\ncounterfeit websites that pretend to offer an array of software tools. These utilities provide\ntrojanized versions of legitimate applications.\n\nWhile tracking the StrongPity APT group’s campaigns, we discovered that it targets through\nTrojanized Partition Find and Mount software utility along with updated C&C infrastructure. In\nthis blog, we have highlighted the technical details of the latest cyberattacks by the group.\n\nThe high-level process flow of the StrongPity malware installation is shown in the figure\nbelow.\n\nFigure 2: High-level execution flow diagram\nThe high-level execution flow of the StrongPity infection is as follows:\n\nIt starts with the APT actor employing the watering hole attack or Phishing email to\n[deliver trojanized Partition Find and Mount software utility on the victims.](http://findandmount.com/)\nThe Trojanized installer drops multiple malware components in the %temp%\\ndaData\nfolder along with configuration files as shown below\n\n\n-----\n\nFigure 3: Dropped payload files and config files\n\nThe Launcher component is responsible for executing the Exfiltrate module, which runs\nanother File searcher component.\nThe File searcher component enumerates system drives and looks for target files with\nspecific extensions. The list of extensions is embedded in the StrongPity payload.\nIf the files are found in the victim’s machine, it will be copied into a temporary zip\narchive. After completion of adding the files to the archive, it splits into hidden .sft\nencrypted files.\nThese hidden .sft files are sent to the C&C server through a POST request and are\nthen removed from the disk-based on further C&C command. The Exfiltrate module\nhas commands to delete the .sft files after being sent to the hacker C&C server, as\nseen in the figure below.\n\nFigure 4: Payload module with the deletion command\nUpon execution of the trojanized installer, it extracts and drops encrypted payloads, which is\npart of its resource section, as shown in the figure below\n\n\n-----\n\nFigure 5: Encrypted payload in .rsrc section\nStrongPity payloads such as the Launcher & Persistence component, Exfiltration &\nCommand Execution module, and the File Searcher component are extracted and dropped\nin the %temp%\\ndaData folder. The figure below shows the decryption routines as well as\ndecrypted payloads in the process memory.\n\nFigure 6: Decrypted payload in the memory\nThe malware payload creates a mutex named “thUseiGpkMkPkFYrIOvKN” to mark its\nexistence on the victim’s system, as shown in the image below.\n\n\n-----\n\nFigure 7: Creates Mutex function in the payload file\nThe Exfiltrate component has a hardcoded C&C URL, decoded in the memory as depicted in\nthe debugger image below. As seen in earlier variants, the Parse_ini_file.php is used as part\nof the layer 1 communication and the functionality to get commands from the C&C server.\n\nFigure 8: Layer1 C&C link in payload file\nThe network capture depicts multiple connection requests to the attacker layer 1 C&C server\n(uppertrainingtool[.]com) as showcased in the Wireshark image below.\n\nFigure 9: Wireshark image of C&C communication\n**Conclusion:**\n\nThe StrongPity APT group has suspected ties to state-sponsored campaigns and has the\nability to search and exfiltrate multiple files or documents from the victim’s machine. This\ngroup uses a 3-layer C&C for thwarting forensic investigations and operates with fully\nfunctional Trojanized popular tools.\n\n\n-----\n\nThe Cyble Research team is continuously monitoring to harvest the threat indicators/TTPs of\nemerging APTs in the wild to ensure that targeted organizations are well informed and\nproactively protected.\n\n**MITRE ATT&CK Framework:**\n\n**ID** **Description** **Use**\n\n\n**T1547.001** Boot or Logon\nAutostart\nExecution:\nRegistry Run Keys\n/ Startup Folder\n\n**T1543.003** Create or Modify\nSystem Process:\nWindows Service\n\n**T1587.003** Develop\nCapabilities:\nDigital Certificates\n\n**T1189** Drive-by\nCompromise\n\n**T1036.005** Masquerading:\nMatch Legitimate\nName or\nLocation\n\n**T1204.002** User Execution:\nMalicious File\n\n\nUsed Registry run keys to establish persistence.\n\nCreated new services and modified existing services for\npersistence.\n\nCreated self-signed digital certificates for use in HTTPS\nC2 traffic.\n\nUsed watering hole attacks to deliver malicious versions\nof legitimate installers.\n\nDisguised malicious installer files by bundling them with\nlegitimate software installers.\n\nTried to get users to execute compromised installation\nfiles for legitimate software including compression\napplications, security software, browsers, file recovery\napplications, and other tools and utilities.\n\nNamed services to appear legitimate.\n\n\n**T1036.004**\n\n\nMasquerade Task\nor Service\n\n\nSource: [https://attack.mitre.org/groups/G0056/](https://attack.mitre.org/groups/G0056/)\n**Indicators of Compromise (IOC’s):**\n\n**File hashes:**\n– 469C0460E4C1FEFD01DB4AE9F79C53C7\n– 81390CE601D34F384BFF9198EEF793A9\n– 8C24DD49D037121212985C722E1C7D03\n– A969A009D0927B1B4D9F8BB3C1CA49BE\n– C81DCDD13572C151B6E04AA4D8A6DD43\n\n\n-----\n\n**C2 Domains:**\n– uppertrainingtool[.]com\n– updserv-east-cdn3[.]com\n– hybirdcloudreportingsoftware[.]com\n– transferprotocolpolicy[.]com\n\n**About Cyble**\n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect](https://cyble.io/)\nthemselves from cybercrimes and exposure in the darkweb. Cyble’s prime focus is to provide\norganizations with real-time visibility into their digital risk footprint. Backed by Y Combinator\nas part of the 2021 winter cohort, Cyble has also been recognized by Forbes as one of the top\n20 Best Cybersecurity Startups To Watch In 2020. Headquartered in Alpharetta, Georgia, and\nwith offices in Australia, Singapore, and India, Cyble has a global presence. To learn more\nabout Cyble, visit [www.cyble.io.](http://www.cyble.io/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-31 - StrongPity APT Extends Global Reach with New Infrastructure.pdf"
    ],
    "report_names": [
        "2020-12-31 - StrongPity APT Extends Global Reach with New Infrastructure.pdf"
    ],
    "threat_actors": [
        {
            "id": "67fbc7d7-ba8e-4258-b53c-9a5d755e1960",
            "created_at": "2022-10-25T16:07:24.077859Z",
            "updated_at": "2025-03-27T02:02:10.101173Z",
            "deleted_at": null,
            "main_name": "Promethium",
            "aliases": [
                "APT-C-41",
                "Promethium",
                "StrongPity"
            ],
            "source_name": "ETDA:Promethium",
            "tools": [
                "StrongPity",
                "StrongPity2",
                "StrongPity3",
                "Truvasys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cbede712-4cc3-47c6-bf78-92fd9f1beac6",
            "created_at": "2022-10-25T15:50:23.777222Z",
            "updated_at": "2025-03-27T02:00:55.544919Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "PROMETHIUM",
                "StrongPity"
            ],
            "source_name": "MITRE:PROMETHIUM",
            "tools": [
                "Truvasys",
                "StrongPity"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4660477f-333f-4a18-b49b-0b4d7c66d482",
            "created_at": "2023-01-06T13:46:38.511962Z",
            "updated_at": "2025-03-27T02:00:02.852307Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "StrongPity",
                "G0056"
            ],
            "source_name": "MISPGALAXY:PROMETHIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535734,
    "ts_updated_at": 1743041682,
    "ts_creation_date": 1653692844,
    "ts_modification_date": 1653692844,
    "files": {
        "pdf": "https://archive.orkl.eu/6b2adfdd76654e2cfbd71febeb57b9fee0882f67.pdf",
        "text": "https://archive.orkl.eu/6b2adfdd76654e2cfbd71febeb57b9fee0882f67.txt",
        "img": "https://archive.orkl.eu/6b2adfdd76654e2cfbd71febeb57b9fee0882f67.jpg"
    }
}