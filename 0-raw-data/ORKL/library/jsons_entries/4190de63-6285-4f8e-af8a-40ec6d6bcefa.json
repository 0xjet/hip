{
    "id": "4190de63-6285-4f8e-af8a-40ec6d6bcefa",
    "created_at": "2022-10-25T16:48:23.011167Z",
    "updated_at": "2025-03-27T02:10:49.39726Z",
    "deleted_at": null,
    "sha1_hash": "ec7d70f1abbdff4227a39b98306a490085cb5bf6",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-02-01T06:03:55Z",
    "file_modification_date": "2021-02-01T06:03:55Z",
    "file_size": 7306557,
    "plain_text": "**[Top Risks](https://www.f5.com/labs/search?q=%22Top+Risks%22)** March 03, 2020\n\n## New Perl Botnet (Tuyul) Found with Possible Indonesian Attribution\n\n###### ARTICLE • 14 min. read\n\n By Eli Kreminchuker, Remi Cohen\n\n##### Vitals\n\nOn January 15, 2020, F5 threat researchers detected a new campaign targeting\nvulnerable PHPUnit systems (CVE-2017-9841) that tries to install an Internet Relay\nChat (IRC) bot. The bot, called Tuyul, created a botnet smaller than many we’ve\ntracked in the past. At the last check in mid-February, it was composed of around\n350 target systems. This is notably smaller than other botnets, which can range\nfrom around 1,400 infected systems to upwards of 40,000 active systems in use\nper day.1\n\n#### Key Findings\n\nTuyul appears to be new. The peak size we observed had 366 victim systems\nin the IRC channel.\nBots are written in a variety of programming languages, depending on their\nfunction. 2 Tuyul is written in Perl. This is not typical of what we usually see—\noftentimes IRC bots are written in PHP or Python.3\nThere is probable Indonesian attribution for this botnet. We came to this\nassessment based on several clues, including the time zone, the botnet\nname, the admin nicknames used, and the repository server, among others.\nFor details, see the Possible Attribution section of this article.\nWe continue to see this bot being actively worked on and we expect it to\ncontinue to grow. F5 researchers will remain engaged with this botnet and\nwill report on any future findings.\n\n\n-----\n\n#### Technical Details\n\nFirst, we discuss some details of the malware itself and then the composition of\nthe attacker’s network.\n\n###### The Malware\n\nThe threat actor uses an uncommon vulnerability for taking over the victim’s\nserver. The malware specifically searches for unpatched instances of PHPUnit, a\nunit testing framework for the PHP programming language. It specifically exploits\nCVE-2017-9841, which enables the attacker to inject arbitrary PHP code on the\n\nserver.\n\n**_Figure 1. A sample request of the campaign trying to execute a bash script on_**\n**_the server_**\n\nBy witnessing the bots respond to a pwd (print working directory) shell command\n\nsent by the bot master, we were able to confirm this was the only vulnerability\nthat was targeted.\n\n**_Figure 2. Infected servers responding to a “pwd” shell command_**\n\n#### Composition of the Attacker’s Network\n\nWe were able to confirm two of the registered domains the threat actor was\nusing with Tuyul:\n\n**_https://localroot[.]zyx—Malware repository and command-and-control (C&C)_**\n31.220.52.186—C&C development server\n**_http://zer0art[.]com—Infection logging API_**\nhttp://103.3.189.32—API development server\n\nThe localroot[.]xyz server hosts the malware files and acts as C&C under the\nsubdomain irc[.]localroot[.]xyz. In addition to the C&C server, the attacker\nmaintains two development servers for developing and testing its scripts. One\nserver is a development IRC server, and another server is used for logging\nsuccessful infections. The C&C server has a valid SSL certificate. In addition, both\n\n\n-----\n\n**_Figure 3. The C&C serve has a valid SSL certificate, and it takes advantage of_**\n**_Cloudflare protection_**\n\n#### Attack Methods\n\nThe attacker uses two different methods to infect and control the Tuyul-infected\nvictims: injecting a web shell or connecting the server to an IRC server and\njoining a botnet. The following sections describe both.\n\n###### Method #1: Gaining Access by Injecting a Web Shell\n\nThe attacker uses a number of different PHP web shells to gain access to the\nserver. When the campaign launches, an open source application called Tiny File\nManager is used as a back door, giving the attacker easy access to the server’s\nfile system.\n\n**_Figure 4. Tiny File Manager serves as a back door._**\n\nIn later stages of the campaign, a different, unknown web shell is deployed. This\nshell has more advanced capabilities and sophistication. We need to conduct\nadditional research to fully understand its functionality.\n\n**_Figure 5. Unknown web shell with unknown capabilities_**\n\n\n-----\n\ninformation security events.\n\nThe third web shell used was an obfuscated PHP shell that takes three steps\nwhen deployed. In the first step, a bash dropper called inject executes on the\ntarget server. The script does two things: first, it downloads a PHP script from the\nmain localroot[.]xyz server.\n\n**_Figure 6. Inject bash dropper_**\n\nIf this first script is successfully executed on the server, a POST request is sent to\nan API on the second zero0art[.]com server, logging the successful infection.\n\n**_Figure 7. A POST request logging the successful infection in a dedicated API_**\n\nAfter a successful execution, the PHP script server acts as a dropper by installing\nan obfuscated PHP back door in several locations on the server.\n\n**_Figure 8. The PHP dropper inject.php_**\n\nThe back door is installed and receives commands through a parameter called\n**_preman, which appears to be the one of the attacker’s monikers._**\n\n\n-----\n\n**_Figure 9. PHP back door that receives commands_**\n\nWe were able to obtain the source code of the API script and found an important\nclue about the attacker’s origin. The PHP code had a date_default_timezone_set\nfunction set to Asia/Jakarta.\n\n**_Figure 10. The attacker’s API source code with Asia/Jakarta set as the default_**\n**_time_**\n\n###### Method #2: Gaining Access via an IRC Botnet\n\nThe second infection method connects the victim’s server to an IRC botnet. The\nmalware is written in Perl, and this makes it worth thinking about. In the past, Perl\nwas a popular language for writing attack tools. Since Perl is easier than lowerlevel languages such as C, it attracted many script kiddies. 4 The DDoS Perl\nIRCBot script written in 2012 is still one of the most common IRC malware scripts\nin use today. But since 2005, 5 Perl has been on the decline in favor of Python for\nIRC bots and general programming. As noted in the Key Findings, many IRC\nbotnets are now created with Python. Perl is still used due to its low entry barrier\nand is a common language for script kiddies to learn. Because it can be used to\ncreate powerful and dense programs, there are still many Perl users around the\nglobe. 6 Developing a malicious script in 2020 in Perl makes this threat actor’s\nchoice interesting.\n\n\nThe first stage of the infection instructs the server to download a Bash script\ndropper (see Figure 11). The dropper instructs the server to download a compiled\nPerl binary and execute it on the system. If it is unsuccessful, it then tries to\ndownload an uncompiled version of the file and execute it using Perl.\n\n**_Figure 11. The join bash dropper that tells a server to execute a Perl script_**\n\nAt the time of writing, the binary version of this malware went undetected by\nantivirus software. This allows the attacker to work on the machine virtually\nundetected by a signature-based antivirus.\n\n\n-----\n\n**_Figure 12. The binary version of the malware goes undetected by antivirus_**\n**_engines_**\n\nIf successfully executed, the server connects to an IRC server on the attacker’s\nC&C server (irc[.]localroot[.]xyz), where it joins the rest of the infected servers\nwaiting for further instructions from the attacker (see Figure 13).\n\n**_Figure 13. The IRC bot malware configuration_**\n\nTo stay persistent on the system, the malware periodically downloads a bash\nscript named cron, which ensures that the Tuyul script is still installed (see Figure\n14).\n\n**_Figure 14. A bash script checking that the Tuyul script is still running_**\n\nIt also detects and kills rival processes of other malware infections (see Figure\n15).\n\n**_Figure 15. Bash script killing rival malware processes (the comment is in the_**\n**_original script)_**\n\n#### Malware Source Code\n\nWhile monitoring the campaign, we collected four different versions of the\nmalware source code. Despite these different versions, the following core\nfunctionalities remained the same:\n\n\n-----\n\ncommands on other bots.\nnoob: Demotes the bot from “pro” status.\nupdate: Downloads and installs a newer version of the malware.\nbc: Connects to a reverse shell.\nshell: Executes a shell command.\n\nperl: Executes a Perl script.\nterminate, suicide: Kills the bot’s connection.\n\nFrom the list of commands in the script, it is difficult to determine the intentions of\nthe bot master. Unlike previous well-known IRC bots, where commands had more\nspecific descriptions such as DDoS or crypto mining capabilities, Tuyul bot has\nonly general-purpose commands. While monitoring the botnet, we did not notice\nany activity involving these bots besides maintenance. Some individual bots\nwere spotted spreading the Tuyul malware, but we did not detect a mass\nactivation of the botnet.\n\n#### Composition of the Tuyul Botnet\n\nThe infected server connects to the attacker’s IRC server and joins the\nconfigured channel. In the first versions of the malware the channel used was\ncalled “#idiot,” revealing the actor’s feelings toward the victims.\n\nEach bot connecting to the server is given a nickname with a “TuYuL” prefix and a\nrandom string.\n\n**_Figure 16. Tuyul botnet showing 179 bots connected_**\n\nFor obvious reasons, the script permits only certain nicknames to operate the\nbot. In early versions, four different nicknames were defined as admins. This\nindicates that the campaign might be a joint effort and not the work of a single\nindividual. In later versions of the code, the number of admins was reduced to\ntwo.\n\n**_Figure 17. Early version configuration of Tuyul botnet_**\n\nSince we had the source code and could see which admins that bot listens to, we\nwanted to see if it was possible to take over the botnet. First, we tried to activate\na bot in a private chat with a non-admin nickname:\n\n\n-----\n\n**_Figure 18. Users attempting to execute a shell command using a non-admin_**\n**_nickname_**\n\nBut when changing the nickname to one of the admins who was unsigned to the\nserver, we could execute commands on the infected bots, as shown in Figure 19.\n\n**_Figure 19. Users attempting to execute a shell command using an admin_**\n**_nickname_**\n\nAfter a few days of monitoring the channel, the bot master noticed our activity\nand registered the nicknames of the admins and white-listed the IRC clients\nallowed to join the network. This prevented us from pretending to be admins and\ncontrolling the bots.\n\nDuring our research, the botnet peaked at around 350 bots, which is a relatively\nsmall size botnet. For example, last year a different IRC botnet was reported with\nmore than 1,400 bots. 7 Most of the victims are hosted on cloud services such as\nAmazon Web Services (AWS) and DigitalOcean, and about a third are hosted on\nLinode. When we conducted a geolocation of the IP addresses on the botnet, we\nfound that U.S. and U.K. servers accounted for almost half of the bots.\n\n#### Probable Attribution\n\nPlease note that at the time of publication, no group had yet claimed this botnet\nand we do not have official attribution of the individuals writing and operating\nTuyul. Our probable Indonesian attribution is based on many pieces of evidence\ngathered while investigating this malware.\n\nTime zone. The Asia/Jakarta time zone, as discussed in the Attack Methods\n\nsection, is an important clue because it sets the default time zone used by all\ndate/time functions. 8 This is the most convincing evidence of the attacker’s origin\nthat was set inside the API source code, as explained in the Malware section.\nWhile this may be purposefully set to a different time zone, it is only one of many\nindicators we look at when determining possible attribution. In addition, several\nother clues also pointed to Indonesia.\n\nAdministrator nicknames. The admin nicknames when used to configure this\n\nbotnet may provide possible attribution information. Preman, one of the\nmonikers used, is a word for an Indonesian gangster and, according to\nWikipedia, is a member of an organized crime group.9\n\nWhen connecting to the C&C development environment, the Indonesian phrase\n\"assalamualaikum pak aji\" appears. It does not appear on the main C&C.\n\nIP address. As investigations into this bot continued, the new version had an\n\ninteresting IP address that exposed the threat actor’s development environment.\nThe threat actor runs this development environment to test new versions of the\nPerl script. After the admins’ nicknames were registered we continued to monitor\nactivity from both the main and development IRC servers. In the development\nIRC server, admin nicknames were not registered and there was an additional\n\n\n-----\n\n**_pak aji, which translates to “greetings sir Aji.” According to names.org, the name_**\n**_Aji may have many origins—one of the common ones is from Indonesia and_**\nmeans “bless.”10\n\n**_Figure 20. Development server showing the phrase assalamualaikum pak aji_**\n\nMalware repository. In later stages of the research, a message on the main\n\nmalware repository was added when trying to access non-existent files—hidup\n**_ini indah, an Indonesian phrase that translates to “life is beautiful.”_**\n\n**_Figure 21. The phrase “hidup ini indah” in Indonesian (“life is beautiful” in_**\n**_English)_**\n\nBotnet name. The name of this botnet is also a possible indicator of origin and\n\nattribution. A Tuyul, also sometimes spelled Toyol, is a figure in Southeast Asia, in\nparticular in Indonesian folklore. 11 The Tuyul appears in this folklore as an undead\ninfant who is invoked using black magic to conduct tasks such as theft, sabotage,\nor other crimes. According to IMDB, a 2015 horror movie called Tuyul was a\nmodern reimagining of this Indonesian mythology in which the Tuyul hurts a\nfamily living in its house.12\n\n\nBased on these findings, we concluded that the threat actor running the Tuyul\nbotnet was probably in Indonesia. At this time, we do not attribute this activity to\na state-sponsored actor. We cannot say with certainty if this is tied to organized\ncrime or cybercriminal activity, however, cybercriminal activity has often been\nlocated in Indonesia. In January 2020, Indonesia conducted the first arrests of\nthree men on suspicion of being part of the Magecart attacks. 13 Along with that, a\nnumber of nonstate groups in Indonesia have perpetuated malicious activity,\neither under a specific campaign or for personal gain.4, 5, 6\n\nWe are continuing to see this bot being actively worked on, and we expect it to\ngrow. F5 researchers will remain engaged with this botnet and will report on any\nfuture findings.\n\n#### Conclusion\n\nThis new campaign shows that botnets continue to be a threat to organizations\nand have a variety of uses, ranging from IRC bots to shopping bots to crypto\nmining. Those interested in building botnets don’t need to go far to find source\ncode to create their own. Botnets for service are also common and easy to buy.\nResponsible organizations can do their best to protect their employees by having\n\n\n-----\n\ncredential stuffing solutions, and continually educating employees about the\npotential dangers of IoT devices and how to use them safely.\n\n##### IOC and Other Technical Data\n\nIOC\n\nC&C:\n\nirc[.]localroot[.]xyz\n\n63[.]250[.]33[.]43\n\nMalware repository and development servers:\n\nlocalroot[.]xyz\n\nzer0art[.]com\n\n104[.]27[.]154[.]113\n\n104[.]27[.]182[.]106\n\n31[.]220[.]52[.]186\n\n103[.]3[.]189[.]32\n\nAttacking servers:\n\n178[.]128[.]35[.]202\n\n45[.]63[.]127[.]55\n\n45[.]77[.]97[.]0\n\n140[.]82[.]56[.]119\n\n95[.]216[.]210[.]246\n\n138[.]68[.]152[.]125\n\n139[.]99[.]121[.]227\n\n178[.]128[.]95[.]201\n\n142[.]93[.]185[.]6\n\n142[.]93[.]179[.]244\n\n40[.]112[.]129[.]217\n\n52[.]156[.]59[.]22\n\n20[.]37[.]96[.]167\n\n159[.]203[.]189[.]141\n\n118[.]27[.]6[.]13\n\nFiles:\n\n0204e028d242a0cbf1e1611908ff1895 inject\n\n0323eb136c586b96cfade4407fa9abb7 kill\n\n072f9f015fddcbdc1373633dcf8c7520 cron\n\n111b543c6d110da5b3a070fdc44e4c7d z\n\n333a1032f001c677f9925ef228830103 back.php\n\n9 9\n\n\n-----\n\n66027930586b3dbec1c1f84392b0dc13 inject.php\n\n83d555ff340c7a8f3e7c40de496378ae libc6.so\n\n847c8d52bc9c58c1e479fbb0d294cfec hook.php\n\n89398067c033a4d5c69ec56a95ea502f join\n\n8edca42ab0ecc6358eac61a8cf53183f tuyul\n\n9398caaa1f4f583fcd3b6fa51622d3eb unix.so\n\n94186bb97a20b207507b4913ef3aa9a9 cache.php\n\ncbf995e0372230b345cd62178bec5635 dis.so\n\ne2a2b5f9d8798b0865c2f598e7662714 inject\n\n#### Security Controls\n\nTo mitigate the types of attacks discussed here, we recommend putting the\n[following security controls in place:](https://www.f5.com/labs/articles/education/what-are-security-controls)\n\n\nTechnical Preventative\n\n\nDisable remote management, restrict access to a\nmanagement network, or place devices behind a\n�rewall.\nAt a minimum, use network address translation\n(NAT) if the devices are used in a residence.\nChange the vendor default credentials and disable\nthe default administrator account if you can.\nContinually update the devices with the latest\n�rmware releases\n\n\n-----\n\nknown malware.\n\nReview and adjust access controls as necessary.\nNotify customers of malware detected on their\nsystems when signing in, so they can take steps to\nclean their systems.\n\nAdministrative Corrective Implement a patch management system to keep\n\nsystems current on patches.\n\nProvide security awareness training to employees\nand customers.\n\nAdministrative Preventative\n\nAbout the author\n\n###### Eli Kreminchuker\n\nEli Kreminchuker is a researcher and writer for F5 Labs.\n\n[More articles from Eli Kreminchuker](https://www.f5.com/labs/search.author_Eli%2BKreminchuker)\n\nAbout the author\n\n###### Remi Cohen\n\nRemi Cohen is a Threat Research Evangelist with F5 Labs.\nPrior to F5 she worked for a large national laboratory\nconducting vulnerability assessments, and research on\ncurrent threats as well as an civilian analyst for the US\nDepartment of Defense. Her specialty areas of research\ninclude mobile vulnerabilities, Industrial Control Systems,\nand Eastern European threats. She is an associate of (ISC)2\nby passing the CISSP exam and is certified in both\nCOMPTIA Security+ and ECCouncil C|EH. She holds a\nMaster’s degree from New Mexico State University in\nIndustrial Engineering as well as Bachelor’s degrees in\nComputer Science and Government from Georgetown\nUniversity.\n\n[More articles from Remi Cohen](https://www.f5.com/labs/search.author_Remi%2BCohen)\n\n##### Footnotes\n\n###### TAGS: Indonesia, Threats, IRC, PHP, perlb0t\n\n\n-----\n\n### Need-to-Know\n\n###### Expertly picked stories on threat intelligence\n\n\n**[ENCRYPTION](https://www.f5.com/labs/search?q=Encryption)** **TOP**\n\n\n**[STRATEGIES](https://www.f5.com/labs/search?q=Strategies)**\n\n###### Are You Ready for\n DoD CMMC Compliance?\n\nBLOG • 8 min. read\n\n\n**TOP**\n\n\n##### Hundreds of apps will be attacked by the time you read this.\n\nSo, we get to work. We obsess over effective attack\nmethods. We monitor the growth of IoT and its evolving\nthreats. We dive deep into the latest crypto-mining\ncampaigns. We analyze banking Trojan targets. We\ndissect exploits. We hunt for the latest malware. And then\nour team of experts share it all with you. For more than\n20 years, F5 has been leading the app delivery space.\nWith our experience, we are passionate about educating\nthe security community-providing the intel you need to\nstay informed so your apps can stay safe.\n\n\n**[ENCRYPTION](https://www.f5.com/labs/search?q=Encryption)**\n\n###### Introducing the Cryptonice HTTPS\n Scanner\n\nARTICLE • 12 min. read\n\n\n###### Every\n# 9 hrs\n\na critical vulnerability—\nwith the potential for\nremote code execution—\nis released.\n\n\n###### Subscribe and get threat intelligence updates from security leaders with decades of experience\n\n Develop a richer understanding of your security environment with only one email per week.\n\n Always have the latest security research and analysis at your fingertips.\n\n Strategic insights from CISO-level experts give you deeper analysis than your peers who only rely on threat reports.\n\n\n-----\n\n**_Enter your email address_**\n\n###### SUBSCRIBE\n\n_[The information you provide will be treated in accordance with the F5 Privacy Notice.](https://www.f5.com/company/policies/privacy-policy)_\n\n###### THREATS\n\n CISO TO CISO\n\n APPLICATION PROTECTION\n\n© 2021 F5, Inc. All rights reserved\n\n\n###### TWITTER\n\n LINKEDIN\n\n\n[Policies | Privacy | Trademarks | Unsubscribe | Cookie Preferences](https://www.f5.com/company/policies)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.03.03_Tuyul_Botnet_Indonesian/New%20Perl%20Botnet%20%28Tuyul%29%20Found%20with%20Possible%20Indonesian%20Attribution.pdf"
    ],
    "report_names": [
        "New Perl Botnet (Tuyul) Found with Possible Indonesian Attribution"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1612159435,
    "ts_modification_date": 1612159435,
    "files": {
        "pdf": "https://archive.orkl.eu/ec7d70f1abbdff4227a39b98306a490085cb5bf6.pdf",
        "text": "https://archive.orkl.eu/ec7d70f1abbdff4227a39b98306a490085cb5bf6.txt",
        "img": "https://archive.orkl.eu/ec7d70f1abbdff4227a39b98306a490085cb5bf6.jpg"
    }
}