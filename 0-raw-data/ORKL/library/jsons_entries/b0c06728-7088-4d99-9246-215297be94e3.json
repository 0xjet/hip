{
    "id": "b0c06728-7088-4d99-9246-215297be94e3",
    "created_at": "2022-10-25T16:48:13.949055Z",
    "updated_at": "2025-03-27T02:05:27.690892Z",
    "deleted_at": null,
    "sha1_hash": "81af95b9c1e39a49440ea901f059dd19bbac158c",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-01-07T08:01:11Z",
    "file_modification_date": "2021-01-07T08:01:11Z",
    "file_size": 1671854,
    "plain_text": "# Another country-sponsored #malware: Vietnam APT Campaign\n\n**blog.malwaremustdie.org/2014/08/another-country-sponsored-malware.html**\n\n## The background\n\nThis is a team work analysis, we have at least 5 (five) members involved with this investigation.\n\nThe case that is about to be explained here is an APT case. Until now, we were (actually) avoiding APT cases for publicity in Malware Must\nDie! posts. But due to recent progress in \"public privacy violation or power-abuse/bullying\" malware cases, we improved our policy, so\nfor several cases fit to \"a certain condition\", i.e. malware developed by \"powerful actors with budget\" aiming weak victims including the\nAPT method, or, intimidation for public privacy cases using a crafted-malware, are going to be disclosed and reported here \"ala MMD\",\nalong w/public criminal threat too. So don't use malware if you don't want to look BAD :-)\nThis case is NOT a new threat, for the background this threat was written in the Infosec Island blog, written by By Eva Galperin and\nMorgan Marquis-Boire in the good report of article: \"Vietnamese Malware Gets Very Personal\" which is posted several months ago, access\n[is in here-->[LINK], the post was very well written as heads up for this threat. Also, there are similar article supported to this threat and](http://www.infosecisland.com/blogview/23567-Vietnamese-Malware-Gets-Very-Personal.html)\nworth reading beforehand like:\n\n[https://www.hostragon.com/shadowy-pro-government-hacking-squad-spying-vietnamese-bloggers/](https://www.hostragon.com/shadowy-pro-government-hacking-squad-spying-vietnamese-bloggers/)\n\n[http://english.vietnamnet.vn/fms/science-it/102484/chinese-hackers-set-malware-to-trap-vietnamese-internet-users.html](http://english.vietnamnet.vn/fms/science-it/102484/chinese-hackers-set-malware-to-trap-vietnamese-internet-users.html)\n\n\n-----\n\n[http://www.nytimes.com/aponline/2014/01/20/world/asia/ap as vietnam online wars.html](http://www.nytimes.com/aponline/2014/01/20/world/asia/ap-as-vietnam-online-wars.html)\nYou can consider this post is made as additional for the previous writings, to disclose deeper of what public and the victims actually\nSHOULD know in-depth about the malicious activity detail, that is performed by this malware. To be more preventive in the future for the\nsimilar attack that is possibly occurred.\n\nWe suspect a group with good budget is in behind of this malware, aiming and bullying privacy of specific individuals who against one\ncountry's political method. In a glimpse, the malware, which is trying hard to look like a common-threat, looks like a simple backdoor &\nconnecting/sending some stuffs to CNC. But if you see it closely to the way it works, you will be amazed of the technique used to fulfill its\npurpose, and SPYING is the right word for that purpose.\n\nThe sample we analyzed in this post was received from the victims side, we picked the one file called \"Thu moi.7z\" which contains the \"Thu\nmoi.hta\" snipped below:\n\n..which was reported as the latest of this series.\n\nFrom the surface, if \"Thu moi.hta\" file is being executed (double clicked), it will extract (drop) and opening a Microsoft Word DOC file, to\ncamouflage the victim to make them believe that they are opening an archived document file, while what had actually happened is, in the\nbackground a series of infection activities happened in the victim's PC.\n\n## Malware installer scheme\n\nHow the file was extracted from \"Thu moi.hta\" is by utilizing a simple embedded VB Script, you can see it started in the line 307 (of that\n.hta sample file) as per shown below in any text editor you pick:\n\nAt the starting part of this script. you can see three points was used to camouflage, which are : (1) The usage of the long white space to\ncover the evil script start tag from the eye-sight, (2) the effort to minimize the \"window\" for the shell used to run this evil VB Script, and\n(3) the effort to NOT showing the window taskbar during the script running.\n\nI will try to peel the evil script used, with the explanation I commented within the lines, as per below:\n\n\n-----\n\nSo, the script was design to keep on running in any run time error. You will meet the function forming the randomized strings for an \"exe\"\nfilename. You can see how this script generate the \"random seed\" to be used for randomizing the strings used for filename, and how it\nmerged filename with the \".exe\" extension afterwards. Then the script is obfuscating the WScript's (the Windows OS interpreter engine for\nrunning a VB Script) commands to form an object of file system, and the shell for execution a windows command/executable file(s).\n\nThe line 48 & 49 of the script is to declare the file object & shell mentioned above in the variable \"os\" and \"ws\". And following by\ndefining the windows temporary folder as file's path added by the function's generated randomized name as filename+extension. To make\nsure of what these variables generated values, I am using break points formed by Wscript.Echo trick to burp its value in a pop-up.\n\nThe VB Script is creating the EXE file as per previously described above, declared it as an object \"p1\". Then you can see blob of binary\ncodes to be written as HEX to form a file, by using the combination of commands in VB script. This method is commonly used as\ntechnique to write a malware binary in VB Script. But this one is a well-thought one.\n\n\n-----\n\nThe next lines is explaining the same method used for HEX file-writing. Yes, it wrote another file, and declaring it as object \"p\", but this\none is using the static variable name \"Doc Loi.doc\" which is using the %Temp% path too (noted: GetSpecialFolder(x) where x=2 means\n%Temp%).\n\nHere's the punchline, the last part of codes (lines 116 and 117) you will see the script is performing execution of object \"p\" (the .doc file)\nand without waiting it just run the \"p1\" (the .exe malware).\n\nWe recheck the run result of any decoding method we did. In this case I just commented the line 116 and 117 and..as per expected, this\nscript runs and minimizing the window w/o taskbar title:\n\nAnd it creates those two files (before execution). I run it many times for fun..NO!\" ..for \"analysis\"\n(Uhm!), so I can extract randomized injected files to check is it polymorphic or not (and..of\ncourse..it is not, NOT with this plain Hex writing crap).\n\nFurther, we also formed the binary file-injecting itself from hex-strings directly from the\nscript as per snipped below, to study the possibility of a miss-writing that can happened\nduring forming the PE extraction, the test was done with the same result. A snip of scratch\nused (thanks to MMD DE team):\n\n\n-----\n\nWe also check bit-by-bit to make sure which samples belong to which installers, since this malware looks hit some victims / more than one\ntime.\n\nSo what does this \".exe\" malware do?\n\n## Polymorphic self-copy & new process spawner\n\nI picked the .exe file dropped by this .hta installer with the MD5 hash f38d0fb4f1ac3571f07006fb85130a0d, this malware was uploaded to\nVT about 7 months ago.\n\nThe malware is the one was dropped by the installer, you can see the same last bits before blobs of \"00\" hex were written in the malware\nbinary as per snipped and red-marked color in the VB script mentioned in the previous section:\n\nThis binary is having an interesting functionality. There's so much to write from\nit..but I will go to important highlights, or this post is going to be a book. Among all\nusual malicious tricks for evasion & \"reverse/debug checking\" tricks used, it was\ndesigned to detect the way it was called. When it was initially executed as the form of\nthe dropped .exe from the .hta installer it will delete the original file and rewrite itself\nto the %Temp% folder using the random Hex-filename with \".tmp\" extension, below\nis the partial writing codes snipped for it:\n\nThe self-copied files are polymorphic, below some PoC, one AV evasion detection\ndesigned:\n\n?\n\n1 `Size  Exec Date  Filename MD5`\n2 `-------------------------------------------------------------`\n3 `438272 Aug 23 01:28 10.tmp* 577237bfd9c40e7419d27b7b884f95d3`\n4 `438272 Aug 23 07:22 17.tmp* 9451a18db0c70960ace7d714ac0bc2d2`\n```\n   438272 Aug 23 07:36 18.tmp* 53d57a45d1b05dce56dd139fc985c55e\n```\n5\n```\n   438272 Aug 23 07:39 19.tmp* 387321416ed21f31ab497a774663b400\n```\n6 `438272 Aug 23 07:43 1A.tmp* 0a65ecc21f16797594c53b1423749909`\n7 `438272 Aug 23 07:44 1B.tmp* 91a49ed76f52d5b6921f783748edab01`\n8 `438272 Aug 23 07:44 1C.tmp* f89571efe231f9a05f9288db84dcb006`\n9 `438272 Aug 23 07:45 1D.tmp* 7ca95b52ed43d71e2d6a3bc2543b4ee1`\n10 `438272 Aug 23 07:46 1E.tmp* faec9c62f091dc2163a38867c28c224d`\n11 `438272 Aug 23 07:47 1F.tmp* 4b02063c848181e3e846b59cbb6b3a46`\n12 `438272 Aug 23 08:14 20.tmp* 5c8f2f581f75beff1316eee0b5eb5f6d`\n```\n   438272 Aug 23 01:19 F.tmp*  b466cb01558101d934673f56067f63aa\n```\n13\n```\n   :       :\n```\n14\n15\n\nIt'll then create the process (with the command line API), which will be executed at the\nfunction reversed below, I put default IDA commented information since it is important\nfor all of us (not only reverser) to understand flow used below, pls bear the length, just\nplease scroll down to skip these assembly explanation (unless you interest to know how\nit works):\n?\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n\n```\n0x40BF20 sub_40BF20 proc near\n0x40BF20\n0x40BF20 StartupInfo= _STARTUPINFOW ptr -8508h\n0x40BF20 ProcessInformation= _PROCESS_INFORMATION ptr -84C4h\n0x40BF20 var_84B4= dword ptr -84B4h\n0x40BF20 CommandLine= word ptr -84B0h\n0x40BF20 FileName= word ptr -4B0h\n0x40BF20 ApplicationName= dword ptr -2A8h\n0x40BF20 var_A0= dword ptr -0A0h\n0x40BF20 var_1C= dword ptr -1Ch\n0x40BF20 var_18= dword ptr -18h\n0x40BF20 var_10= dword ptr -10h\n0x40BF20 var_8= dword ptr -8\n0x40BF20 var_4= dword ptr -4\n0x40BF20 arg_8= dword ptr 10h\n0x40BF20\n0x40BF20 push ebp\n0x40BF21 mov ebp, esp\n0x40BF23 push 0FFFFFFFEh\n0x40BF25 push offset unk_4284D0\n0x40BF2A push offset sub_416480\n0x40BF2F mov eax, large fs :0\n0x40BF35 push eax\n0x40BF36 sub esp, 8    \n0x40BF39 mov eax, 84F0h\n0x40BF3E call sub_4207F0  \n0x40BF43 mov eax, dword_42A520\n\n```\n\n-----\n\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n\n```\n          [ p ],\n0x40BF4B xor eax, ebp\n0x40BF4D mov [ ebp +var_1C], eax\n0x40BF50 push ebx\n0x40BF51 push esi\n0x40BF52 push edi\n0x40BF53 push eax\n0x40BF54 lea eax, [ ebp +var_10]\n0x40BF57 mov large fs :0, eax\n0x40BF5D mov [ ebp +var_18], esp\n0x40BF60 mov esi, [ ebp +arg_8]\n0x40BF63 xor ebx, ebx\n0x40BF65 push ebx\n0x40BF66 call ds :CoInitialize\n0x40BF6C mov [ ebp +var_4], ebx\n0x40BF6F push 6      \n0x40BF71 push offset aHelp \n0x40BF76 push esi\n0x40BF77 call sub_41196F  \n0x40BF7C add esp, 0Ch\n0x40BF7F test eax, eax\n0x40BF81 jz loc_40C13E\n:\n0x40BF87 call sub_409740  \n0x40BF8C xor eax, eax\n0x40BF8E mov [ ebp +FileName], ax\n0x40BF95 push 206h\n0x40BF9A push ebx\n0x40BF9B lea ecx, [ ebp -4AEh]\n0x40BFA1 push ecx\n0x40BFA2 call sub_412510  \n0x40BFA7 add esp, 0Ch   \n0x40BFAA push 104h \n0x40BFAF lea edx, [ ebp +FileName]\n0x40BFB5 push edx\n0x40BFB6 push ebx\n0x40BFB7 call ds :GetModuleFileNameW\n0x40BFBD test eax, eax\n0x40BFBF jz loc_40C15D\n:\n0x40BFC5 xor eax, eax\n0x40BFC7 mov word ptr [ ebp +ApplicationName], ax\n0x40BFCE push 206h\n0x40BFD3 push ebx\n0x40BFD4 lea ecx, [ ebp +ApplicationName+2]\n0x40BFDA push ecx\n0x40BFDB call sub_412510  \n0x40BFE0 add esp, 0Ch   \n0x40BFE3 lea edx, [ ebp +ApplicationName]\n0x40BFE9 push edx\n0x40BFEA push 104h     \n0x40BFEF call ds :GetTempPathW\n0x40BFF5 test eax, eax\n0x40BFF7 jz loc_40C15D  \n:\n0x40BFFD lea eax, [ ebp +ApplicationName]\n0x40C003 push eax\n0x40C004 push ebx\n0x40C005 push ebx\n0x40C006 mov ecx, eax\n0x40C008 push ecx\n0x40C009 call ds :GetTempFileNameW\n0x40C00F test eax, eax\n0x40C011 jz loc_40C15D\n:\n0x40C017 call sub_4079C0  \n0x40C01C test eax, eax\n0x40C01E jz loc_40C15D  \n:\n0x40C024 mov byte ptr [ ebp +var_A0], bl\n0x40C02A push 80h     \n0x40C02F push ebx\n0x40C030 lea edx, [ ebp +var_A0+1]\n0x40C036 push edx\n0x40C037 call sub_412510  \n0x40C03C add esp, 0Ch   \n0x40C03F mov [ ebp +var_84B4], 81h\n0x40C049 lea edx, [ ebp +var_84B4]\n0x40C04F lea eax, [ ebp +var_A0]\n0x40C055 call sub_40A300  \n0x40C05A test eax, eax\n0x40C05C jz loc_40C15D\n:\n0x40C07B xor eax, eax\n\n```\n\n-----\n\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122\n123\n124\n125\n126\n127\n128\n129\n130\n131\n132\n133\n134\n135\n136\n137\n138\n139\n140\n141\n142\n143\n144\n145\n146\n147\n148\n149\n150\n151\n152\n153\n154\n155\n156\n157\n158\n159\n160\n161\n162\n\n```\n          [ p ],\n0x40C084 push 7FFEh\n0x40C089 push ebx\n0x40C08A lea ecx, [ ebp -84AEh]\n0x40C090 push ecx\n0x40C091 call sub_412510  \n0x40C096 lea edx, [ ebp +var_A0]\n0x40C09C push edx\n0x40C09D lea eax, [ ebp +FileName]\n0x40C0A3 push eax\n0x40C0A4 lea ecx, [ ebp +ApplicationName]\n0x40C0AA push ecx\n0x40C0AB push offset aSHelpSS\n0x40C0B0 push 4000h\n0x40C0B5 lea edx, [ ebp +CommandLine]\n0x40C0BB push edx\n0x40C0BC call sub_411448  \n0x40C0C1 mov [ ebp +StartupInfo.cb], ebx\n0x40C0C7 push 40h     \n0x40C0C9 push ebx\n0x40C0CA lea eax, [ ebp +StartupInfo.lpReserved]\n0x40C0D0 push eax\n0x40C0D1 call sub_412510  \n0x40C0D6 add esp, 30h   \n0x40C0D9 mov [ ebp +StartupInfo.cb], 44h\n0x40C0E3 xor ecx, ecx\n0x40C0E5 mov [ ebp +StartupInfo.wShowWindow], cx\n0x40C0EC mov [ ebp +StartupInfo.dwFlags], 1\n0x40C0F6 mov [ ebp +ProcessInformation.hProcess], ebx\n0x40C0FC xor eax, eax\n0x40C0FE mov [ ebp +ProcessInformation.hThread], eax\n0x40C104 mov [ ebp +ProcessInformation.dwProcessId], eax\n0x40C10A mov [ ebp +ProcessInformation.dwThreadId], eax\n0x40C110 lea edx, [ ebp +ProcessInformation]\n0x40C116 push edx\n0x40C117 lea eax, [ ebp +StartupInfo]\n0x40C11D push eax\n0x40C11E push ebx\n0x40C11F push ebx\n0x40C120 push 8000000h   \n0x40C125 push ebx\n0x40C126 push ebx\n0x40C127 push ebx\n0x40C128 lea ecx, [ ebp +CommandLine]\n0x40C12E push ecx\n0x40C12F lea edx, [ ebp +ApplicationName]\n0x40C135 push edx\n0x40C136 call ds :CreateProcessW\n0x40C13C jmp short loc_40C15D\n\n```\n\nif the .hta dropped malware named \"sample.exe\", new process will be started by launching command line contains parameters described\nbelow:\n?\n\n\n1\n2\n3\n4\n\n```\n\"CreateProcessW\", \"C:\\DOCUME~1\\...\\LOCALS~1\\Temp\\RANDOM[0-9A-F]{1,2}.tmp\", \"SUCCESS|FAIL\",\"PID: xxx,\nCommand line: \"\" C :\\DOCUME~1\\...\\LOCALS~1\\Temp\\RANDOM[0-9A-F]{1,2}.tmp \"\" \\n\n--helpC:\\DOCUME~1\\...\\LOCALS~1\\Temp\\sample.exe \\n\nBCE6D32D8CD4F1E6A1064F66D561FDA47E0CD5F8F330C4856A250BB104BC18320FF75E6E56A1741C6770AD238DCFD23DD8A82DDF332FDC8\n\n```\n\nThe decryption function used is as per below:\n\nAnd this malware will end its process here, raising new process that has just been executed..\n\n## More drops & payload installation\n\n\n-----\n\nThe process RANDOM[0 9A F]{1,2}.tmp started by allocated memory, loading rpcss.dll, uxtheme.dll, MSCTF.dll before it self deleting the\ndropper .exe. The snip code for the deletion is as per below, this isn't also an easy operation, it checks whether the file is really there, if not\nit makes sure it is there..\n\n?\n\n1 `0x40A648` `push` `edi`\n2 `0x40A649` `call` `ds` `:PathFileExistsW`\n3 `:`\n4 `0x40A657` `push` `0Ah`\n5 `0x40A659` `push` `65h`\n6 `0x40A65B` `push` `ebx`\n7 `0x40A65C` `call` `ds` `:FindResourceW`\n8 `0x40A662` `mov` `esi` `,` `eax`\n9 `0x40A664` `cmp` `esi` `,` `ebx`\n10 `0x40A666` `jz` `loc_0x40A7CB`\n11 `:`\n12 `0x40A7CB loc_0x40A7CB:`\n13 `0x40A7CB` `push` `edi`\n14 `0x40A7CC` `call` `ds` `:DeleteFileW`\n15 `0x40A7D2` `mov` `[` `ebp` `+var_18], 1`\n16 `0x40A779` `mov` `ecx` `, [` `ebp` `+lpFile]`\n17 `0x40A77C` `mov` `edx` `, [` `ebp` `+lpExistingFileName]`\n18 `0x40A77F` `push` `ecx`\n19 `0x40A780` `push` `edx`\n20 `:`\n21 `0x40A78B` `mov` `eax` `, [` `ebp` `+lpFile]`\n22 `0x40A78E` `push` `1`\n23 `0x40A790` `push` `ebx`\n24 `0x40A791` `push` `ebx`\n25 `0x40A792` `push` `eax`\n26 `0x40A793` `push` `ebx`\n27 `0x40A794` `push` `ebx`\n28 `0x40A795` `call` `ds` `:ShellExecuteW`\n29 `0x40A79B` `mov` `[` `ebp` `+var_18], 1`\n```\n   :\n```\n30\n31\n32\n33\n\n..up to this point I know that we're dealing with a tailored-made malware.\nBack to the highlights, RANDOM[0-9A-F]{1,2}.tmp executed with the right condition will drop payloads of this threat, the first drop is the\nreal deal payload, following by the second drop as the its driver. The file creation of first payload is handled in function 0x41FC90, with\nthe related snip below:\n\n?\n\n1 `0x41FEAF` `mov` `eax` `, [` `ebp` `+arg_0]`\n2 `0x41FEB2` `mov` `edi` `,` `ds` `:CreateFileW`\n3 `0x41FEB8` `push` `0`\n4 `0x41FEBA` `push` `[` `ebp` `+dwFlagsAndAttributes]`\n5 `0x41FEBD` `mov` `dword` `ptr` `[` `eax` `], 1`\n6 `0x41FEC3` `push` `[` `ebp` `+dwCreationDisposition]`\n7 `0x41FEC6` `lea` `eax` `, [` `ebp` `+SecurityAttributes]`\n8 `0x41FEC9` `push` `eax`\n9 `0x41FECA` `push` `[` `ebp` `+dwShareMode]`\n10 `0x41FECD` `push` `[` `ebp` `+dwDesiredAccess]`\n11 `0x41FED0` `push` `[` `ebp` `+lpFileName]`\n12 `0x41FED0`\n13 `0x41FED0`\n14 `0x41FED0`\n15 `0x41FED0`\n```\n   0x41FED0           \n```\n16\n```\n   0x41FED0           \n```\n17 `0x41FED0`\n18 `0x41FED0`\n19 `0x41FED0`\n20 `0x41FED3` `call` `edi`\n21 `0x41FED5` `mov` `[` `ebp` `+hHandle],` `eax`\n22\n\nAnd the writing this file is written in function 0x418EC2 after deobfuscating data part, as per snipped here:\n?\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n\n```\n0x418FB9 mov eax, [ eax +6Ch]\n0x418FBC xor ecx, ecx\n0x418FBE cmp [ eax +14h], ecx\n0x418FC1 lea eax, [ ebp +CodePage]\n0x418FC7 setz cl\n0x418FCA push eax\n0x418FCB mov eax, [ ebx ]\n0x418FCD push dword ptr [ edi + eax ]\n0x418FD0 mov esi, ecx\n0x418FD2 call ds :GetConsoleMode\n: (etc etc)\n0x4194F0 push ecx\n0x4194F1 lea ecx, [ ebp +var_1AD8]\n0x4194F7 push ecx\n0x4194F8 push [ ebp +nNumberOfBytesToWrite]\n0x4194FB push [ ebp +lpBuffer]\n0x419501 push dword ptr [ eax + edi ]\n0x419504 call ds :WriteFile \n0x41950A test eax, eax\n0x41950C jz short loc_0x419523\n:\n0x419523 call ds :GetLastError\n0x419529 mov dword ptr [ ebp +WideCharStr],\n\n```\n\nwe recorded this drop operation in the forensics way too, as per below as evidence:\n\nAs you can see the wiring method is in redundancy per 4096 bytes.\nThis first drop called defrag.exe looks pretty much like Windows harddisk defragmentation tool, down to its property, a perfectly crafted\nevil file:\n\n[Only by using good analysis binary static analysis tool like PEStudio (maker: Marc Oschenmeier), we can spot and focus investigation to](http://winitor.com/)\nthe badness indicators right away:\n\n[@MalwareMustDie Thx for using PEStudio for your investigation. In that case, PEStudio indicating that the image is a fake Microsoft EXE! :-)](https://twitter.com/MalwareMustDie)\n\nâ€” Marc Ochsenmeier (@ochsenmeier) [August 25, 2014](https://twitter.com/ochsenmeier/statuses/503855648866832384)\n\n\n-----\n\nThe next drop is the next task of this binary, noted that none of these drops were fetched from internet instead the data is already included\nin .hta or .[random].exe or [random.tmp].\nUsing the exactly the same functions described above, 0x41FC90 for creation and 0x418EC2 for writing, the second drop operation were\nalso performed. The file name is formed as per below strings:\n\n?\n\n\n1\n2\n3\n\n```\n\"%USERPROFILE%\\AppData\\Identities\\{RANDOM-ID}\\disk1.img\"\nlike:\n\"C:\\Documents and Settings\\MMD\\Application Data\\Identities\\{116380ff-9f6a-4a90-931989ee4f513542}\\disk1.img\"\n\n```\n\nthe forensics PoC is:\n\nThis file is actually a DLL file, here's some peframe:\n?\n\n1 `File Name:   disk1.img`\n2 `PE32 executable` `for` `MS Windows (DLL) (GUI) Intel 80386 32-bit`\n3 `File Size:   249344 byte`\n4 `Compile Time:  2010-08-14 17:16:08`\n5 `\"DLL:      True\"`\n```\n   Entry Point: 0x0001BBD1\n```\n6\n```\n   Sections:    4\n```\n7 `MD5  hash:   62646ea0a4ce1e6d955cbaef8c4a510d`\n8 `SHA-1 hash:   10116a65e19a7ebc6702250cc1caabf755ce8e7f`\n9 `Anti Debug:   Yes`\n10 `Anti VM:    None`\n11\n\nAnd Virus Total showing the good infection info:\n?\n\n1 `First submission 2013-03-11 10:38:19 UTC ( 1 year, 5 months ago )`\n2 `Last submission 2014-01-21 12:49:00 UTC ( 7 months ago )`\n3 `File names disk1.dl, disk1.img`\n\nThis file is then performing registry query and writing operations, I will skip some assembly for this, so shortly, these are the 8 keys added,\nbelow data I snip from forensics result:\n\nWe can see the autostart, and the way it camouflage malicious data in registry using legit scattered softwares and Windows components.\nLike: Auslogic (RecoveryDataStore), Photo Viewer, Disk Defragment Module, Microsoft Remote Assitance. This all means to hide and\nprevent the quick notice of this malware in the infected PC, it is a well thought plan.\nTo be noted that one of the key is used to run the defrag.exe execution via ShellExecuteW by the [Random].tmp file, and also you can see\nthe \"key\" used for this malware saved, one last thing to be noticed is the the bot ID used.\n\nPS: There are also more drops made which are the Windows task installer for this malware\n\n?\n\n1 `C:\\Windows\\Tasks\\ScheduledDefrag.job`\n2 `C:\\Windows\\Tasks\\ScheduledDefrag_admin.job`\n\nIt is the Windows scheduler (kinda crond) to execute the EXE payload (defrag.exe). Pic:\n\n\n-----\n\n## What this payload does\n\nFirst thing that caught interest and attention is these obfuscation constant variables saved in .rdata section:\n\n?\n\n1 `0x40F3AC`\n2 `0x40F3AC aTztxpx75Xtdsjq:`\n3 `0x40F3AC  unicode 0, <` `\"tztxpx75]xtdsjqu/fyf\"` `>,0`\n4 `0x40F3D6` `align` `4`\n5 `0x40F3D8`\n```\n   0x40F3D8 aTztufn43Xtdsjq:\n```\n6\n```\n   0x40F3D8  unicode 0, < \"tztufn43]xtdsjqu/fyf\" >,0\n```\n7\n```\n   0x40F402   align 4\n```\n8 `0x40F404`\n9 `0x40F404 a2e6g3ddEmm:`\n10 `0x40F404  unicode 0, <` `\"2e6g3dd/emm\"` `>,0`\n11 `0x40F430`\n12 `0x40F430 aQsphsbnGjmftY9:`\n13 `0x40F430  unicode 0, <` `\"Qsphsbn!Gjmft!)y97*]Joufsofu!Fyqmpsfs]jfmpxvujm/fyf\"` `>,0`\n14 `0x40F498`\n```\n   0x40F498 aQsphsbnGjmftNf:\n```\n15\n```\n   0x40F498  unicode 0, < \"Qsphsbn!Gjmft]Nfttfohfs]ntntht/fyf\" >,0\n```\n16\n```\n   0x40F4DE   align 10h\n```\n17 `0x40F4E0`\n18 `0x40F4E0 aQsphsbnGjmft_0:`\n19 `0x40F4E0  unicode 0, <` `\"Qsphsbn!Gjmft!)y97*]Joufsofu!Fyqmpsfs]jfyqmpsf/fyf\"` `>,0`\n20 `0x40F546` `align` `4`\n21 `0x40F548`\n22 `0x40F548 aQsphsbnGjmftJo:`\n23 `0x40F548  unicode 0, <` `\"Qsphsbn!Gjmft]Joufsofu!Fyqmpsfs]jfyqmpsf/fyf\"` `>,0`\n24 `0x40F5A2` `align` `4`\n25\n26\n\nWe have good decoder team in MMD. Soon these data were translated as per below:\n\nWhen these data formed in the functions where they were called, we will have better idea of WHY these strings were obfuscated. This time\nwe will take a look at the dump analysis in disassembly, to seek the executed code parts only:\n?\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n\n```\n0x0C22D37  call 0x0C28720h target: 0x0C28720\n0x0C22D3C  add esp, 0Ch\n0x0C22D3F  push 0x0C2F404h <== UTF-16 \"2e6g3dd/emm\"\n0x0C22D44  lea edx, dword ptr [ ebp -00000084h]\n0x0C22D4A  push edx\n0x0C22D4B  call dword ptr [0x0C2D06Ch] lstrcpyW@KERNEL32.DLL\n0xC2207C  lea ecx, dword ptr [ ebp -00000802h]\n0xC22082  push ecx\n0xC22083  mov word ptr [ ebp -00000804h], ax\n0xC2208A  call 00C28720h target: 00C28720\n0xC2208F  add esp, 0Ch\n0xC22092  push 00C2F278h <== UTF-16\n\"Tpguxbsf]Bvtmphjdt]|11111111.1111.1111.1111.111111111111~]SfdpwfszEbubTupsf\"\n0x0C22A4E  call ebx PathFileExistsW@SHLWAPI.DLL ( Import, 1 Params)\n0x0C22A50  test eax, eax\n0x0C22A52  jne 0x0C22AB8h target: 0x0C22AB8\n0x0C22A54  push 0x0C2F4E0h <== UTF-16 \"Qsphsbn!Gjmft!)y97*]Joufsofu!Fyqmpsfs]jfyqmpsf/fyf\"\n0x0C22625  xor eax, eax\n0x0C22627  push 0000007Eh\n0x0C22629  push eax\n0x0C2262A  lea ecx, dword ptr [ ebp -0x000086h]\n0x0C22630  push ecx\n0x0C22631  mov word ptr [ ebp -0x000088h], ax\n0x0C22638  call 0x0C28720h target: 0x0C28720\n0x0C2263D  mov esi, dword ptr [0x0C2D06Ch] lstrcpyW@KERNEL32.DLL\n0x0C22643  add esp, 0Ch\n0x0C22646  push 0x0C2F360h <== UTF-16 \"//]tlzqf/fyf\"\n0x0C2264B  lea edx, dword ptr [ ebp -0x000088h]\n0x0C22651  push edx\n0x0C22652  call esi lstrcpyW@KERNEL32.DLL\n0x0C229DB  push edx\n0x0C229DC  call ebx PathFileExistsW@SHLWAPI.DLL\n0x0C229DE  test eax, eax\n0x0C229E0  jne 0x0C22A46h target: 0x0C22A46\n0x0C229E2  push 0x0C2F498h <== UTF-16 \"Qsphsbn!Gjmft]Nfttfohfs]ntntht/fyf\"\n0x0C229E7  lea eax, dword ptr [ esp +74h]\n0x0C229EB  push eax\n0x0C229EC  call esi lstrcpyW@KERNEL32.DLL\n0x0C22876  call dword ptr [0x0C2D090h] GetVersion@KERNEL32.DLL ( Import, 0 Params)\n0x0C2287C  mov esi, dword ptr [0x0C2D06Ch] lstrcpyW@KERNEL32.DLL ( Import, 2 Params)\n0x0C22882  push 0x0C2F3ACh <== UTF-16 \"tztxpx75]xtdsjqu/fyf\" ; DECODED: \"syswow64\\wscript.exe\"\n0x0C22887  lea eax, dword ptr [ esp +74h]\n0x0C2288B  push eax\n0x0C2288C  call esi lstrcpyW@KERNEL32.DLL ( Import, 2 Params)\n\n```\n\nFound this function is interesting, I found the check for username \"Administrator\" and SUID \"system\" are checked:\n?\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n```\n0x0C21FAB  xor bl, bl\n0x0C21FAD  call dword ptr [0xC2D00Ch] GetUserNameW@ADVAPI32.DLL ( Import, 2 Params)\n0x0C21FB3  test eax, eax\n0x0C21FB5  je 0x0C21FCEh target: 0xC21FCE\n0x0C21FB7  push 0x0C2F22Ch <== UTF-16 \"system\"\n0x0C21FBC  lea ecx, dword ptr [ ebp -0x000204h]\n0x0C21FC2  push ecx\n0x0C21AC9  call dword ptr [0x0C2D014h] LookupAccountSidW@ADVAPI32.DLL\n0x0C21ACF  test eax, eax\n0x0C21AD1  je 0x0C21AFDh target: 0x0C21AFD\n0x0C21AD3  lea ecx, dword ptr [ ebp -0x000204h]\n0x0C21AD9  push ecx\n0x0C21ADA  push 0x0C2F1FCh <== UTF-16 \"administrators\"\n0x0C21ADF  call dword ptr [0x0C2D030h] lstrcmpiW@KERNEL32.DLL\n0x0C21AE5  test eax, eax\n\n```\n\nSuspicious isn't it?\nI go back to the binary for understanding the related functions, which is in 0x4027F0. I was wondering of what is the part of wscript.exe\n(not again!??) mentioned by this binary. So I trailed the path of the wscript.exe starting here, assumed that the Windows architecture is\nx64:\n\n?\n\n1 `0x40286E` `call` `sub_408720`\n2 `0x402873` `add` `esp` `, 0Ch`\n3 `0x402876` `call` `ds` `:GetVersion`\n4 `0x402876`\n5 `0x40287C` `mov` `esi` `,` `ds` `:lstrcpyW`\n6 `0x402882` `push` `offset` `aTztxpx75Xtdsjq <==` `Push` `:` `\"tztxpx75]xtdsjqu/fyf\"` `to stack`\n7 `0x402882`\n8 `0x402887` `lea` `eax` `, [` `esp` `+694h+pMore]`\n9 `0x40288B` `push` `eax`\n10 `0x40288C` `call` `esi`\n11 `0x40288E` `mov` `dx` `, [` `esp` `+690h+pMore]`\n12 `0x402893` `xor` `edi` `,` `edi`\n13 `0x402895` `xor` `ecx` `,` `ecx`\n14 `0x402897` `movzx` `eax` `,` `dx`\n15 `0x40289A` `cmp` `di` `,` `dx`\n\nthen found the binary wscript.exe is executed in this part:\n?\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n\n```\n0x402B54 xor eax, eax\n0x402B56 push 40h\n0x402B58 push eax\n0x402B59 mov [ esp +698h+ProcessInformation.hThread], eax\n0x402B5D mov [ esp +698h+ProcessInformation.dwProcessId], eax\n0x402B61 mov [ esp +698h+ProcessInformation.dwThreadId], eax\n0x402B65 lea eax, [ esp +698h+StartupInfo.lpReserved]\n0x402B69 push eax\n0x402B6A mov [ esp +69Ch+ProcessInformation.hProcess], 0\n0x402B72 call sub_408720  \n0x402B77 add esp, 0Ch   \n0x402B7A xor ecx, ecx\n0x402B7C lea edx, [ esp +690h+ProcessInformation]\n0x402B80 push edx\n0x402B80           \n0x402B81 lea eax, [ esp +694h+StartupInfo]\n0x402B81           \n0x402B85 push eax\n0x402B86 push offset Buffer\n0x402B8B push ecx\n0x402B8B           \n0x402B8C push ecx\n0x402B8D push ecx\n0x402B8E push ecx\n0x402B8F push ecx\n0x402B90 mov [ esp +6B0h+StartupInfo.wShowWindow], cx\n0x402B95 lea ecx, [ esp +6B0h+CommandLine]\n0x402B9C push ecx\n0x402B9D lea edx, [ esp +6B4h+ApplicationName]\n0x402BA4 push edx\n0x402BA5 mov [ esp +6B8h+StartupInfo.cb], 44h\n0x402BAD mov [ esp +6B8h+StartupInfo.dwFlags], 1\n0x402BB5 call ds :CreateProcessW\n0x402BBB test eax, eax\n\n```\n\nSo we have the wscript.exe process up and running.\nUp to this part our teammate poke me in DM, and he asked me what can he helped, so I asked our friend (Mr. Raashid Bhat) to take over\nthe further analysis of this defrag.exe and disk1.img, while I went to other parts, and after a while he came up straight forward with (1)\ndecoder logic, which is match to our crack team did:\n\nAnd (2) the conclusion of what \"defrag.exe\" is actually doing, is a loader which patches the executed wsscript.exe's ExitProcess to load the\nDLL \"disk1.img\"....Well, it's all starts to make more sense now.\n\nChecking the reported data. I confirmed to find the \"process was read\" from here:\n\n?\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n```\n0x4014BB mov edx, [ ebp +nSize]\n0x4014C1 lea ecx, [ ebp +NumberOfBytesRead]\n0x4014C7 push ecx\n0x4014C8 mov ecx, [ ebp +lpAddress]\n0x4014CE push edx\n0x4014CF lea eax, [ ebp +Buffer]\n0x4014D2 push eax\n0x4014D3 push ecx\n0x4014D4 push esi\n0x4014D5 mov [ ebp +NumberOfBytesRead], ebx\n0x4014DB call ds :ReadProcessMemory\n0x4014E1 test eax, eax\n\n```\n\nAs for the \"Exit Process patching\" itself, it is a quite sophisticate technique was used. It used a tiny shellcode that was observed within\nMem Loc 1 : 009C0000 to 009D0000 (by Raashid)\n\n\n-----\n\nThe shellcode then was saved in binary which I received and then I was reversing it deeper, it looks like as per following snips:\n\nThis shellcode I tweaked a bit, is in a plain assembly, contains three addresses of Windows static API call to (I wrote these API in order of\ncalls from top to bottom) LoadLibraryW@kernel32.dll, RtlGetLastWin32Error@ntdll.dll, Sleep@kernel32.dll which can be\nshown in assembly code of the code as per snips below:\n\nSo now we know that defrag.exe is actually hacked wscript.exe, hooks ExitProcess Function of kernel32.dll and patches it with a\nLoadLibraryW@kernel32.dll and loads a DLL string in local (for further execution), does some error-trapping and gives time for the DLL\nto be processed (loaded and executed).\n\nOK. So now we have the idea on how this binary sniffs for account, checks for processes and load and use the DLL (disk1.img). There are\nmany more details for more operation in defrag.exe, like searching the process of Auslogic and that skype/messenger buff (also many\nregistry values sniffed too), but those will be added later after this main course..\n\n## The DLL Payload\n\nThis DLL is the goal of this infection. It has operations for networking functionalitiy, contains the CNC information and the data to be sent\nto the CNC. If you do forensics, you may never see disk1.img or the deobfuscated DLL filename in the process, but you will see its\noperation by the patched wscript.exe (for it was hacked to load this DLL, the wscript.exe process should appear).\n\nBelow is the DLL part that in charge for the socket connections...\n\n?\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n\n```\n10010593 lea edx, [ ebp +var_8]\n10010596 push edx\n10010597 lea edx, [ ebp +var_2C]\n1001059A push edx\n1001059B push ecx\n1001059C push eax\n1001059D call ds :getaddrinfo\n:\n100105C7 push dword ptr [ esi +0Ch]\n100105CA push dword ptr [ esi +8]\n100105CD push dword ptr [ esi +4]\n100105D0 call ds :socket  \n100105D6 mov edi, eax\n:\n100105DD push dword ptr [ esi +10h]\n100105E0 push dword ptr [ esi +18h]\n100105E3 push edi\n100105E4 call ds :connect\n:\n10010600 push [ ebp +var_8]\n10010603 call ds :freeaddrinfo\n10010609 mov esi, ds :setsockopt\n1001060F push ebx\n10010610 lea eax, [ ebp -1]\n10010613 push eax\n10010614 push ebx\n10010615 push 6      \n10010617 push edi\n10010618 mov [ ebp +var_1], bl\n1001061B call esi\n1001061D push 4      \n1001061F lea eax, [ ebp +optval]\n10010622 push eax\n10010623 push 1006h    \n10010628 push 0FFFFh    \n1001062D push edi\n1001062E call esi\n\n```\n\n..this will be resulted in some internal socket binding operation we spotted in the debug mode as:\n?\n\n1 `Bind IP Port  Status     (n) HookAddr API Calls`\n2 `--------------------------------------------------------`\n3 `0.0.0.0 51902 success 1 100105A3 getaddrinfo`\n4 `0.0.0.0 52652 success 1 100105A3 getaddrinfo`\n```\n   0.0.0.0 57334 success 1 100105A3 getaddrinfo\n```\n5\n```\n   0.0.0.0 1209  success 1 100105EA connect\n```\n6 `0.0.0.0 54643 success 1 100105A3 getaddrinfo`\n7 `0.0.0.0 53539 success 1 100105A3 getaddrinfo`\n8 `0.0.0.0 54536 success 1 100105A3 getaddrinfo`\n9 `0.0.0.0 1210  success 1 100105EA connect`\n10 `0.0.0.0 51696 success 1 100105A3 getaddrinfo`\n11\n\nWhich one of them is successfully established connection to CNC:\n?\n\n1 `Bind IP Port  Status     (n) HookAddr API Calls`\n2 `--------------------------------------------------------`\n3 `\"91.229.77.179 8008 success\"` `or wait 2 100105EA connect`\n\nFrom the further reversing section for this DLL (which was done by Raashid), the domains are encoded using single byte move. and can be\nseen in the below IDA snapshot:\n\nWhich sending the below blobs of binary:\n\n\n-----\n\nWhen I received the result, since I had the report that the CNC was down at the time reversed, I used the local dummy DNS to seek\nwhether the requests was made to those CNC hosts, and is proven:\n\nFurthermore, using the different method of networking (I won't explain this for the security purpose), I could find the alive connection to\nthe CNC's IP and PoC'ing the blob binary sent to initiate the connection. Noted, again the data matched, the reversing blob binary is\nactually the CNC sent data used to initiate the CNC communication, as per captured in the PCAP below, same bits:\n\nDoes it means the CNC still alive?\nI am not so sure. It was connected. The CNC \"allowed\" the bot to send the data to them, yet it was not responding back afterward and let\nthe communication becoming in \"pending\" stage. So, there is many possibility can be happened, like: CNC is gone, or CNC specs has\nchanged, etc. After all this APT sample is about 6-7months old.\nSo please allow me to take a rain check for analysis the blob binary used (still on it..among tons of tasks..). Let's investigate this CNC\nrelated network.\n\n## The CNC investigation\n\nBased on the reverse engineering, forensics & behavior analysis we did, we found the CNC is actually 3 (three) hostnames matched to the\n6 (six) IP addresses as per listed below:\n\n?\n\n1 `static.jg7.org`\n2 `imaps.qki6.com`\n3 `menmin.strezf.com`\n\nWhich historically are using the below IP addresses:\n?\n\n1 `8.5.1.38`\n2 `64.74.223.38`\n3 `208.73.211.66`\n4 `91.229.77.179`\n```\n   124.217.252.186\n```\n5\n```\n   212.7.198.211\n```\n6\n\n[The first three domains is having a very bad reputation in phishing & malware infection globally. PoC-->[here]](http://pastebin.com/9Q91JNeC)\nFor the location of these IP are shown in the below details:\n\n\n-----\n\nAnd the period time for each CNC's used subdomains VS IP addresses above can be viewed clearly below (Thank you FairSight team):\n\n?\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n\n```\nfirst seen 2013-11-01 21:17:45 -0000\nlast seen 2013-11-04 05:22:20 -0000\nstatic.jg7.org. A 8.5.1.41\nfirst seen 2013-10-07 13:10:00 -0000\nlast seen 2013-11-18 14:38:32 -0000\nstatic.jg7.org. A 64.74.223.41\nfirst seen 2013-08-26 10:01:39 -0000\nlast seen 2013-10-07 12:34:21 -0000\nstatic.jg7.org. A 91.229.77.179\nfirst seen 2012-12-17 04:20:19 -0000\nlast seen 2013-06-20 05:53:03 -0000\nstatic.jg7.org. A 124.217.252.186\nfirst seen 2013-06-20 08:00:28 -0000\nlast seen 2013-08-26 09:00:42 -0000\nstatic.jg7.org. A 212.7.198.211\nfirst seen 2013-11-01 21:22:55 -0000\nlast seen 2013-11-04 05:24:20 -0000\nimaps.qki6.com. A 8.5.1.38\nfirst seen 2013-10-07 13:10:18 -0000\nlast seen 2013-11-18 14:38:38 -0000\nimaps.qki6.com. A 64.74.223.38\nfirst seen 2013-08-26 10:02:05 -0000\nlast seen 2013-10-07 12:33:13 -0000\nimaps.qki6.com. A 91.229.77.179\nfirst seen 2012-12-17 04:19:46 -0000\nlast seen 2013-06-20 05:52:30 -0000\nimaps.qki6.com. A 124.217.252.186\nfirst seen 2014-01-06 01:21:07 -0000\nlast seen 2014-01-11 14:30:44 -0000\nimaps.qki6.com. A 208.73.211.66\nfirst seen 2013-06-20 07:07:43 -0000\nlast seen 2013-08-26 09:01:08 -0000\nimaps.qki6.com. A 212.7.198.211\nfirst seen 2013-08-26 10:02:31 -0000\nlast seen 2014-08-22 04:06:36 -0000\nmenmin.strezf.com. A 91.229.77.179\nfirst seen 2013-10-05 11:54:26 -0000\nlast seen 2013-10-07 13:45:55 -0000\nmenmin.strezf.com. A 208.91.197.101\n\n```\n\n-----\n\nAnd below is the DNS queries for these hostname (not IP) recorded in the recent terms, thank s to OpenDNS:\n\nCross checking various similar samples with the all recorded domains & IPs for the related CNC we found more possibility related\nhostnames to the similar series of the threat, suggesting the same actor(s), noted the usage of DDNS domains:\n?\n\n1 `foursquare.dyndns.tv`\n2 `neuro.dyndns-at-home.com`\n3 `tripadvisor.dyndns.info`\n4 `wowwiki.dynalias.net`\n```\n   yelp.webhop.org\n```\n5\n```\n   (there are some more but we are not 100% sure of them yet..is a TBA now..)\n```\n6\n\nThe bully actor(s) who spread this APT loves to hide their domain behind various of services like:\n?\n\n1 `nsX.dreamhost.com`\n2 `nsX.cloudns.net`\n3 `nsXX.ixwebhosting.com`\n4 `nsXX.domaincontrol.com`\n```\n   dnsX.name-services.com\n```\n5\n```\n   nsXX.dsredirection.com\n```\n6 `dnsX.parkpage.foundationapi.com`\n7\n\nWith noted that these THREE CNC domains used by this sample, are made on this purpose only, and leaving many traceable evidence in\nthe internet that we collected all of those successfully. Trailing every info leaves by this domains: jg7.org, qki6.com. strezf.com will\nhelp you to know who is actually behind this attack. Noted: see the time frame data we disclosed above. If there any malware initiators and\ncoders think they can bully others and hide their ass in internet is a BIG FAIL.\nThe data is too many to write it all here, by the same method of previous check we can find the relation between results. It is an interesting\ninvestigation.\n\n## Samples\n\n[What we analyzed is shared only in KernelMode, link-->[here]](http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3451)\n\nWith thankfully to KM team (rocks!) I am reserving a topic there for the continuation disclosure for same nature of sample and threat.\n\n## The epilogue\n\nThis series of APT attack looks come and go, it was reported back then from 2009. This one campaign looks over, but for some reason that\nwe snipped in above writing, there is no way one can be sure whether these networks used are dead. The threat is worth to investigate and\nmonitor deeper. Some posts are suspecting political background supporting a government mission of a certain group is behind this\nactivities, by surveillance to the targeting victims. Avoiding speculation, what we saw is a spyware effort, with a good quality...a handmade level, suggesting a custom made malware, and I bet is not a cheap work too. We talked and compare results within involved\nmembers and having same thought about this.\n\nIf you received the sample, or, maybe got infected by these series, I suggest to please take a look at the way it was spread, dropped\ntechniques used binaries, and the many camouflage tricks used. Further, for the researchers involved, we should add that the way to hide\nthe CNC within crook's network is the PoC for a very well-thought & clever tricks. We have enough idea for whom is capable to do this,\nand now is under investigation.\n\nWe are informing to all MMD friends, this investigation is OPEN, please help in gathering information that is related to this threat for the\nfuture time frame too, as much as possible. We are opposing whoever group that is backing up this evil operation, and believe me, the dots\nare started to connect each other..\n\nWe are going to handle the similar threat from now on, so IF you have the abuse case by malware and need the deep investigation of what\nthat malware does, do not hesitate to send us sample, archive the samples and text contains the explanations of how you got the sample\n[and how can we contact you, with the password \"infected\", and please upload it in this link-->[DropBin].](http://www.mediafire.com/dropbox/dropbox.html?nocache=0.47243585277827493&sId=a5a850a1408899fff22c77ea31229b6599c2c6c025042a434133192a363185f0#)\n\n\n-----\n\nDon t use malware, we never believe that any usage of malware can achieve any goodness. We will battle the malware initiators and its\ncoders for the sake to support a better humanity and better internet usage.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.08.25.Vietnam_APT/blog.malwaremustdie.org-Another%20country-sponsored%20malware%20Vietnam%20APT%20Campaign.pdf"
    ],
    "report_names": [
        "blog.malwaremustdie.org-Another country-sponsored malware Vietnam APT Campaign"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041127,
    "ts_creation_date": 1610006471,
    "ts_modification_date": 1610006471,
    "files": {
        "pdf": "https://archive.orkl.eu/81af95b9c1e39a49440ea901f059dd19bbac158c.pdf",
        "text": "https://archive.orkl.eu/81af95b9c1e39a49440ea901f059dd19bbac158c.txt",
        "img": "https://archive.orkl.eu/81af95b9c1e39a49440ea901f059dd19bbac158c.jpg"
    }
}