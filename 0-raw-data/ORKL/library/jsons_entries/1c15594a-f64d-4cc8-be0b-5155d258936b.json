{
    "id": "1c15594a-f64d-4cc8-be0b-5155d258936b",
    "created_at": "2023-06-05T02:06:59.307948Z",
    "updated_at": "2025-03-27T02:05:59.693657Z",
    "deleted_at": null,
    "sha1_hash": "1c776e1cb324bedafa51163ef69ede8c08e32d2f",
    "title": "2022-10-06 - Amazon Web Services- Exploring The Cost Of Exfil",
    "authors": "",
    "file_creation_date": "2023-06-04T12:24:22Z",
    "file_modification_date": "2023-06-04T12:24:22Z",
    "file_size": 1176056,
    "plain_text": "# Amazon Web Services: Exploring the Cost of Exfil\n\n**[aon.com/cyber-solutions/aon_cyber_labs/amazon-web-services-exploring-the-cost-of-exfil/](https://www.aon.com/cyber-solutions/aon_cyber_labs/amazon-web-services-exploring-the-cost-of-exfil/)**\n\n## Introduction\n\nStroz Friedberg is often called upon by organizations to investigate matters involving\nunintended or unauthorized access to Amazon Web Services (“AWS”). When threat actors\nimpact AWS or more particularly Amazon Simple Storage Service (“S3”), they always leave a\ntrace – but the difficult part is trying to identify the who, what, where, when and why. Also,\njust so it is said, threat actors are not the only ones causing or exploiting issues within AWS.\nStroz Friedberg has also linked what appears to be malicious activity to internal\nmisconfigurations or mistakes by internal employees.\n\nThis article will demonstrate how Stroz Friedberg uses a free and easily accessible AWS tool\nknown as [Cost Explorer to triage AWS during investigations. Cost Explorer’s primary](https://aws.amazon.com/aws-cost-management/aws-cost-explorer/)\npurpose is to provide a visual representation of AWS cost and usage over time. As is usually\nthe case in forensics and investigations, data intended for one use can provide valuable\ninformation to help fill in gaps in a storyline/timeline. In this case, Cost Explorer, while\nintended to provide a view of costs associated with using AWS resources, can also be used\nto spot unintended/unauthorized activity within an AWS environment or to triage a particular\ntimeframe of interest. In the event you see anomalous activity, please contact Stroz\nFriedberg. It is imperative that you have internal or external experts working with your team\nin the event unintended or unauthorized activity presents itself.\n\n## Background\n\nAWS S3 is a scalable, easy-to-use storage solution that many organizations leverage for a\nrange of use cases, such as hosting a website, storing backups, archiving data, and data\nanalytics. When organizations utilize the cloud to host their infrastructure or services, they\nmust invest in adequate risk controls and cyber resilience strategies. That said, when\nmisconfigurations or vulnerabilities are present in AWS S3, threat actors may find and exploit\nthem. [Contact Stroz Friedberg to learn more on how we can help you design, and secure](https://www.aon.com/solutions/commercial-risk/cyber-security/cyber-threat-hunting#ft_form)\nAWS cloud services.\n\n## How to search for possible unintended & unauthorized AWS activity\n\nStroz Friedberg often leverages AWS Cost Explorer to triage AWS incidents in the\npreliminary stages of our AWS investigations.\n\n**So, what is AWS Cost Explorer?**\n\n\n-----\n\nAWS Cost Explorer is an embedded AWS tool that enables one to visualize cost and\nresource usage within your AWS account. In other words, if one were curious why their AWS\nbill increased since the last billing cycle, AWS Cost Explorer can help. Data stored within\nCost Explorer is retained for 12 months by default. Below is a step-by-step process to\nleverage this historical data to identify possible exfiltration events within AWS S3.\n\n**Step 1 – Find Cost Explorer**\n\nTo access the Cost Explorer visualizer tool, search for and select “Cost Explorer” in the\n[search bar of the AWS web console or navigate to the direct link here. This will take you to](http://console.aws.amazon.com/cost-management/home)\nthe AWS Cost Management homepage. On the left side bar, select “Cost Explorer.” You will\nbe presented with a dashboard like Figure 1 below:\n\n_Figure 1. Cost Explorer landing page_\n**Step 2 – Use Cost Explorer**\n\nAWS Cost Explorer is designed with the capability for the user to filter on multiple attributes\nwhich presents them with an interactive visualization of data which is typically camouflaged\nand/or not easily accessible. One powerful feature of Cost Explorer is one can dive in on\ncustom time periods with various levels of specificity and granularity.\n\nTo perform an AWS S3 triage analysis with AWS Cost Explorer:\n\n1. Specify the appropriate time period and set the interval to “Daily”.\n\n\n-----\n\n_Figure 2. Timeframe and Interval filters in Cost Explorer_\n2. Set a filter for “S3” in the “Service” filter category.\n\n_Figure 3. Cost Explorer filtered on service “S3”_\n3. Set the “Usage Type Group” filter to “S3: Data Transfer – Internet (Out)”.\n\n\n-----\n\n_Figure 4 Cost Explorer filtered on Usage Type Group “S3: Data Transfer – Internet (Out)”_\nThe goal of this analysis is to find an abnormality in outgoing AWS S3 data transfer activity\nbased on historical usage within the AWS account, then determine if the activity is the result\nof an expected business function/behavior. In that effort, the graph below (Figure 5) shows\ntwo areas of interest:\n\n1. The top bar graph labeled “Costs ($)” provides an overview of the cost of the AWS S3\n\nservice per day.\n2. The second bar graph labeled “Usage (GB)” provides an overview of the amount of\n\ndata in gigabytes (“GB”) that were transferred per day.\n\n\n-----\n\n_Figure 5. Example of a spike in data transferred outbound to the internet in AWS S3_\nLooking at the Usage graph, there is a clear spike in data usage on December 3, 2021. On\nthis day there was a total of 300.00 GB transferred out to the internet. Compare this to the\nhistorical usage over the last six months, and it is clear a transfer of this size is abnormal\nbehavior.\n\nAdditionally, to discover more about what happened on December 3, 2021, Cost Explorer\ncan be further filtered on specific API (“Application Programming Interfaces”) operations such\nas “GetObject”, even when Object Access logging is not enabled. To do this apply the same\nfilters as above, but instead of grouping by “Service” group by “API Operation” as shown by\nthe top arrow in Figure 6.\n\n_Figure 6. Cost Explorer filtered on API Operation_\n\n\n-----\n\nThe bottom arrows in Figure 6 above indicate that the 300 GB worth of data was transferred\nusing the “GetObject” API call, which is again a clear anomaly based on the other 6 months\nof historical “GetObject” usage. While Cost Explorer will not provide information regarding\nwhat specific objects were downloaded, a forensic investigator now has a more definitive\ntime frame to conduct further investigation.\n\nStroz Friedberg used this same methodology to determine if data from an unintended\npublicly accessible AWS S3 bucket was exfiltrated. Review of the Cost Explorer Usage graph\n(Figure 7) revealed a spike in data transfer on May 16, 2022. On this date, 26.17 GB worth of\ndata was transferred out to the internet. Compare this with the average daily transfer rate of\njust under 1 GB over the last 12 months, and it was clear that May 16, 2022 was a date of\ninterest. While granular object-level logging was not enabled on this particular AWS S3\nbucket to investigate further, the bucket size was just over 26 GB. Using this, Stroz\nFriedberg was able to make a reasonable inference that all objects in this AWS S3 bucket\nwere likely exfiltrated.\n\n_Figure 7. Another example of a large outbound data transfer spike in AWS S3_\nThe same methodology can be applied for other AWS services such as Elastic Compute\nCloud (“EC2”) (shown in Figure 8) and Relational Database Service (“RDS”).\n\n\n-----\n\n_Figure 8. Cost Explorer detailing an anomalous external data transfer in the EC2 service on_\n_January 21 and 22, 2022_\n\n## Additional Use Cases for AWS Cost Explorer\n\n**Validating Threat Actor Exfiltration Claims**\n\nIn matters involving unauthorized access to data within AWS, it is not uncommon for a threat\nactor to attempt to extort the affected organization. Stroz Friedberg has seen this firsthand,\nespecially with regards to AWS S3 and RDS services. Cost Explorer can be used to validate\na threat actor’s claim of data exfiltration. For instance, if the threat actor claims to have\nexfiltrated 250 GB worth of data from AWS S3 and Cost Explorer shows a data transfer\napproximately 250 GB in size around the time of interest that is unaccounted for in legitimate\nbusiness activity, the company can infer that the threat actor likely has that volume of data\nand can approach interactions with the threat actor accordingly.\n\n**Identifying Anomalous Service Usage**\n\nAWS administrators may find regularly checking Cost Explorer each month useful for\nidentifying anomalous behavior such as new service usage. For example, if your\norganization does not use AWS’s Route 53 DNS (“Domain Name System”) service, then\nsudden usage of this service may indicate a threat actor using the environment for hosting\ncommand and control (“C2”) infrastructure.\n\n\n-----\n\n_Figure 9. Cost Explorer filtered on Route 53 service_\nAnother example of anomalous service usage may be a spike in AWS Lambda activity.\nLambda is a serverless computing platform that can run code for virtually any type of\napplication. Threat actors have increasingly targeted Lambda to run code associated with\nmining cryptocurrency.\n\n**Identifying New Region Usage**\n\nA common technique threat actors use to evade detection when compromising an AWS\nenvironment, is to spin up resources in an AWS region that is not being used. Cost Explorer\ncan help detect suspicious new region usage by simply applying “Region” to the Group by\nfeature within the Cost Explorer visualization tool.\n\n_Figure 10. Cost Explorer grouped by “Region”_\n\n## AWS Cost Explorer Limitations\n\nWhile AWS Cost Explorer can be very useful, it is important to understand its limitations and\ngaps. For one, cost metrics within Cost Explorer may be affected by free tier service usage,\nvolume-based discounts, reserved instance contracts, and services which are billed monthly\nor annually Additionally Cost Explorer may take up to 24 hours to reflect costs As such it is\n\n\n-----\n\nnot a valid tool or replacement for real time monitoring of an AWS environment. For real time\ncost anomaly analysis and alerting, one may consider using AWS’s [Cost Anomaly Detection](https://aws.amazon.com/aws-cost-management/aws-cost-anomaly-detection/)\nservice.\n\n## Conclusion\n\nStroz Friedberg continues to see an increase in the number of investigations that involve\ncloud services such as Amazon Web Services. Digital forensics often involves leveraging\nexisting artifacts and data in creative and innovative ways, viewing them from a different\nperspective from what they were intended for to solve often-complex matters. In that vein,\nAWS Cost Explorer has resulted in many quick wins for Stroz Friedberg’s investigators, and\nit is a valuable data point that can be leveraged to look for anomalous activity within your\nown AWS environment or fill in gaps in an investigation of such an environment. If you are\nseeing anomalous behavior in your AWS environment Stroz Friedberg’s team of experienced\ninvestigators can help determine the scope and root cause of the activity.\n\n_Author: Andre Maccarone, John Ailes_\n\nSpecial Thanks: Chapin Bryce\n\nOctober 6, 2022\n\n©Aon plc 2022\n\nThis material has been prepared for informational purposes only and should not be relied on for any other purpose. You\nshould consult with your own professional advisors or IT specialists before implementing any recommendation or\nfollowing the guidance provided herein. Further, the information provided and the statements expressed are not intended\nto address the circumstances of any particular individual or entity. Although we endeavor to provide accurate and timely\ninformation and use sources that we consider reliable, there can be no guarantee that such information is accurate as of\nthe date it is received or that it will continue to be accurate in the future. The examples provided in this article are not\nbased upon an actual Stroz/Aon client, but was provided for illustrative purposes only.\n\n**About Cyber Solutions**\n\nCyber security services are offered by Stroz Friedberg Inc., its subsidiaries and affiliates. Stroz Friedberg is part of Aon’s\nCyber Solutions which offers holistic cyber risk management, unsurpassed investigative skills, and proprietary\ntechnologies to help clients uncover and quantify cyber risks, protect critical assets, and recover from cyber incidents.\n\nCyber security services offered by Stroz Friedberg Inc. and its affiliates. Insurance products\nand services offered by Aon Risk Insurance Services West, Inc., Aon Risk Services Central,\nInc., Aon Risk Services Northeast, Inc., Aon Risk Services Southwest, Inc., and Aon Risk\nServices, Inc. of Florida and their licensed affiliates. Aon UK Limited is authorised and\nregulated by the Financial Conduct Authority in respect of insurance distribution services.\nFP.AGRC.238.JJ The following products or services are not regulated by the Financial\nConduct Authority:\n\n- Cyber risk services provided by Aon UK Limited and its affiliates\n\n- Cyber security services provided by Stroz Friedberg Limited and its affiliates.\n\nCopyright 2021 Aon plc. All Rights Reserved.\n\n\n-----\n\nCyber security services offered by Stroz Friedberg Inc. and its affiliates. Insurance products\nand services offered by Aon Risk Insurance Services West, Inc., Aon Risk Services Central,\nInc., Aon Risk Services Northeast, Inc., Aon Risk Services Southwest, Inc., and Aon Risk\nServices, Inc. of Florida and their licensed affiliates. Aon UK Limited is authorised and\nregulated by the Financial Conduct Authority in respect of insurance distribution services.\nFP.AGRC.238.JJ The following products or services are not regulated by the Financial\nConduct Authority:\n\n- Cyber risk services provided by Aon UK Limited and its affiliates\n\n- Cyber security services provided by Stroz Friedberg Limited and its affiliates.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-06 - Amazon Web Services- Exploring The Cost Of Exfil.pdf"
    ],
    "report_names": [
        "2022-10-06 - Amazon Web Services- Exploring The Cost Of Exfil.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1685930819,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1685881462,
    "ts_modification_date": 1685881462,
    "files": {
        "pdf": "https://archive.orkl.eu/1c776e1cb324bedafa51163ef69ede8c08e32d2f.pdf",
        "text": "https://archive.orkl.eu/1c776e1cb324bedafa51163ef69ede8c08e32d2f.txt",
        "img": "https://archive.orkl.eu/1c776e1cb324bedafa51163ef69ede8c08e32d2f.jpg"
    }
}