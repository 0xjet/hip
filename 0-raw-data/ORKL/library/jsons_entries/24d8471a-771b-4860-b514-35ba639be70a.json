{
    "id": "24d8471a-771b-4860-b514-35ba639be70a",
    "created_at": "2022-10-25T16:48:21.561496Z",
    "updated_at": "2025-03-27T02:17:22.933463Z",
    "deleted_at": null,
    "sha1_hash": "47f5e50b6f18b96f012420b536a1ff120f74c45f",
    "title": "Operation Sharpshooter",
    "authors": "",
    "file_creation_date": "2018-12-06T16:18:44Z",
    "file_modification_date": "2018-12-06T16:18:58Z",
    "file_size": 7020436,
    "plain_text": "# Ope\n\n\n-----\n\n## Operation Sharpshooter\n\n#### The McAfee[®] Advanced Threat Research team and McAfee Labs Malware Operations Group, employing McAfee[®] Global Threat Intelligence, have discovered a new global campaign targeting nuclear, defense, energy, and financial companies. This campaign, Operation Sharpshooter, leverages an in-memory implant to download and retrieve a second-stage implant—which we call Rising Sun—for further exploitation. According to our analysis, the Rising Sun implant uses source code from the Lazarus Group’s 2015 backdoor Trojan Duuzer in a new framework to infiltrate these key industries.\n\n\n**Authors**\n\nThis report was researched\nand written by:\n\n**Ryan Sherstobitoff**\n\n**Asheer Malhotra**\n\n**Contributions from the**\n**McAfee Advanced Threat**\n**Research team**\n\nConnect With Us\n\n\nOperation Sharpshooter’s numerous technical links to\nthe Lazarus Group seem too obvious to immediately\ndraw the conclusion that they are responsible for the\nattacks, and instead indicate a potential for false flags.\nOur research focuses on how this actor operates, the\nglobal impact, and how to detect the attack. We shall\nleave attribution to the broader security community.\n\n##### Have We Seen This Before?\n\nThis campaign, while masquerading as legitimate\nindustry job recruitment activity, gathers information\nto monitor for potential exploitation. Our analysis also\nindicates similar techniques associated with other job\nrecruitment campaigns.\n\nThis research has uncovered a new implant framework\nusing code from the 2015 backdoor Duuzer, which was\n\n\nlast seen targeting South Korea and Japan in 2015. Apart\nfrom Rising Sun, we have seen no other variants since\nthat time.\n\n##### Global Impact\n\nIn October and November 2018, the Rising Sun implant\nhas appeared in 87 organizations across the globe,\npredominantly in the United States, based on McAfee\ntelemetry and our analysis. Based on other campaigns\nwith similar behavior, most of the targeted organizations\nare English speaking or have an English-speaking\nregional office. This actor has used recruiting as a lure\nto collect information about targeted individuals of\ninterest or organizations that manage data related to\nthe industries of interest. The McAfee Advanced Threat\nResearch team has observed that the majority of targets\nwere defense and government related organizations\n\n\n-----\n\n##### Campaign Analysis\n\nThis operation began October 25. A series of malicious\ndocuments carried the author’s name Richard. These\ndocuments contained Korean-language metadata,\nindicating they were created with a Korean version\nof Microsoft Word. All the malicious documents had\nEnglish-language job description titles for positions at\nunknown companies, distributed by an IP address in\nthe United States and through the Dropbox service. The\ndocuments contained a malicious macro that leveraged\nembedded shellcode to inject the Sharpshooter\ndownloader into the memory of Word. Once the Word\nprocess was infected, the downloader retrieved the\nsecond-stage implant Rising Sun.\n\nThe shellcode of the downloader is 3.1KB in size and\nretrieved another implant hosted at\nhxxps://www.kingkoil.com.sg/query.php.\n\n\nFigure 1. Targeted organizations by sector in October 2018. Colors\nindicate the most prominently affected sector in each country.\nSource: McAfee[®] Global Threat Intelligence.\n\n\n-----\n\nFigure 2. Infection flow of the Rising Sun implant, which eventually\n\n\n-----\n\n##### Shellcode behavior\n\nThe shellcode executed by the Visual Basic for\nApplications macro in winword.exe acts as a simple\ndownloader for the second-stage implant. The shellcode\ntakes four steps to infect the endpoint with the secondstage payload:\n\n1. It builds Library and API names by populating string\narrays using hardcoded bytes. (String construction\nis done 1 byte at a time.) This technique is used for\nconstructing all strings in the shellcode, including the\ncontrol server information.\n\n\n2. It resolves the Libraries and APIs using\nLoadLibraryA(), GetProcAddress():\n\n    - urlmon.dll\n\n    - shfolder.dll\n\n    - ntdll.dll\n\n    - kernel32.dll\n\n    - shell32\n\n    - LoadLibraryA\n\n    - GetProcAddress\n\n    - URLDownloadToFileA\n\n    - SHGetFolderPathA\n\n    - strcpy\n\n    - strcat\n\n    - CreateProcessA\n\n    - memset\n\n    - ShellExecuteA\n\n\n-----\n\n3. The implant downloads two files from its control\nserver:\n\n    - **Second-stage payload: The second-stage binary**\nis downloaded from\nhttps://www[dot]kingkoil.com.sg/query.php\nto the startup folder on the endpoint:\n%Startup%\\mssync.exe\nThis step ensures persistence on the system for\nthe second-stage implant as part of the download\nprocess, thereby removing the need for the secondstage implant to set up persistence for itself.\n\nFigure 3. The second-stage implant downloaded from the control\nserver.\n\n\n\n    - **Second OLE (Word) document: Another OLE**\ndocument is downloaded from\nhttps://www[dot]kingkoil.com.sg/\nStrategic Planning Manager.doc\nto:\n%LOCALAPPDATA%\\Strategic Planning\nManager.doc\nThis document is probably benign, used as a\ndecoy to hide the malicious content.\n\nFigure 4. The decoy document downloaded from the control server.\n\n4. Once both the second-stage implant and decoy\ndocument have been downloaded, the two payloads\nare executed:\n\n    - The second-stage implant is executed using the\nCreateProcessA() API.\n\n    - The decoy document is opened using the\nShellExecuteA() with the “open” verb.\n\n\n-----\n\nFigure 5 Control server strings constructed in the shellcode\n\n\nThe Advanced Threat Research team discovered another\nPDF document (10mins.PDF) by the same author. It\nappears to be a smart phone–related questionnaire.\nThis document was hosted on the same server as the\ntwo job-related malicious documents. The questionnaire\nappears to come from a big data analytics company\nthat specializes in antifraud protection and financial\ncompliance.\n\nFigure 6. 10Mins.PDF\n\n\n-----\n\n##### Rising Sun behavior\n\nThe Rising Sun implant is a fully functional modular\nbackdoor that performs reconnaissance on the victim’s\nnetwork.\n\n**Imports**\n\nThis implant starts by building its imports via dynamic\nAPI resolution: LoadLibrary()/GetProcAddress(). The\nlibrary and API names are hardcoded as DWORD/WORD\nvalues in the implant and comprise a blob of bytes 0x147\nbytes in size. This blob of data is decrypted using a\nsimple single-byte XOR scheme with the key 0xC8.\n\nThis scheme used for building the Library and API\nnames is a variant of the byte-chunk string-construction\ntechnique often used by Lazarus implants. The scheme\ntypically involves:\n\n- Hardcoded library and API names in the form of\nDWORD/WORD/byte chunks in the implant.\n\n- Assigning variables with these hardcoded values\nduring the execution of the implant.\n\n- Constructing character arrays that consist of the\nlibrary and API names to be resolved.\n\n- Optionally these arrays may have to be decoded using\nsomething as simple as a single-byte XOR decoding\nscheme.\n\n- Using LoadLibrary()/GetProcAddress() to now resolve\nthe libraries and APIs using the constructed name\narrays.\n\n\nFigure 7. XOR-encoded library and API names in the implant.\n\n**Configuration data**\n\nThe configuration data used by the implant is encrypted\nusing an RC4 stream algorithm. The implant decrypts the\nconfiguration data at runtime and for communicating\nwith the control server. The addresses decrypted from\nthe implant:\n\n- http://34[dot]214.99.20/view_style.php\n\n- http://137[dot]74.41.56/board.php\n\n- https://www[dot]kingkoil.com.sg/board.php\n\n\n-----\n\nFigure 8. The RC4 stream encryption algorithm used to decode the\nimplant’s configuration data.\n\n**Initial reconnaissance**\n\nThe implant fetches the following data from the endpoint\nand exfiltrates it to the control server:\n\n- Network adapter info\n\n- Computer name\n\n- User name\n\n- IP address information\n\n- Native system information\n\n- OS product name from registry:\nSOFTWARE\\MICROSOFT\\Windows NT\\\nCurrentVersion | ProductName\n\n\n**Additional configuration**\n\nThe implant decrypts additional information during the\nreconnaissance process:\n\nVboxHook.dll tmp SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion ProductName RUNAS; RUN;\nDLL; winsta0\\default Kernel32.dll lnk\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\\nRun C:\\Program Files\\Internet Explorer\\\niexplore exe ntuser LOG8\n\nThis configuration data is not completely used by the\nimplant, but there is a high possibility of other variants of\nthe implant using the complete configuration data. The\nconfiguration data may have been copied from another\nimplant family without scrubbing unused strings from\nthe data.\n\n**Data encryption and exfiltration**\n\nThe implant carries out data encryption and exfiltration\nusing the following steps:\n\n- Once the data has been gathered from the endpoint,\nthe implant encrypts it using the RC4 stream\nencryption algorithm.\n\n- After the data has been encrypted, the implant\nperforms another layer of obfuscation of the data by\nBase64-encoding the RC4 encrypted data.\n\n\n-----\n\nThe implant performs an HTTP POST request to the\ncontrol server:\n\n- https://www[dot]kingkoil.com.sg/board.php\n\nAs part of the request, the implant sends data in one of\nthe following formats:\n\n- boardID=<random_number>&page=<request_\ntype>&wr_id=<encoded_time_stamp>&session_\nid=<RC4+base64 encoded data>\n\n- bo_table=<random_number>&page=<request_\ntype>&wr_id=<encoded_time_stamp>&session_\nid=<RC4+base64 encoded data>\n\n- no=<random_number>&page=<request_\ntype>&wr_id=<encoded_time_stamp>&session_\nid=<RC4+base64 encoded data>\n\nThe first variable in the HTTP data can be any of the\nfollowing (randomly selected) values:\n\nvar1_enum =\n{\n“code=”\n“no=”\n“bo_table=”\n“boardID=”\n“pageKey=”\n“structureid=”\n}\n\n\nThe <request_type> can be one of the following values:\n\nrequest_type=\n{\n“free” //indicates initial\nreconnaissance data\n\n“query” //indicates a request to fetch\nthe command ID from the control server\n\n“suggestion” //indicates request to fetch\nadditional data from the control server\n\n“result” //indicates data obtained from\na command’s execution\n}\n\n\n-----\n\n**Implant capabilities**\n\nThe implant carries 14 backdoor capabilities. It receives\na command code (along with supporting data for the\ncommand) from the control server to execute a specific\nfunction. Unless otherwise specified, the implant sends\nthe output of an executed command to the control server\nas an HTTP POST request with optional data in the form:\n\n<var1_enum>=<random_number>&page=result&wr_\nid=<encoded_time_stamp>&session_id=<RC4 +\nBase64-encoded output of command>\n\n**_Capability #1: Execute commands_**\n\nCommand code = 0x6D0017005500F7.\n\n_Description_\n\nThe implant executes a command specified by the\ncontrol server. The command is executed using cmd.exe:\n\ncmd.exe /c “<command> > <%temp%>\\AM<random>.\ntmp” 2>&1\n\nThe contents of the temporary file consist of the output\nof the command executed. The temp file is read, and the\ncontents are subsequently sent to the control server. The\ntemp file is then deleted from the endpoint. This capability\nalso supports changing the current working directory for\nthe implant and natively supports specific cd commands,\nwithout having to execute them through the shell.\n\nSupported cd commands:\n\n- cd <directory_path>\n\n- cd.\n\n- cd\\\n\n\nFigure 9. Command execution using the CreateProcess() function for\ncmd.exe.\n\n\n-----\n\n**_Capability #2: Get drive information_**\n\nCommand code = 0x0AD005F00A300C7.\n\n_Description_\n\nFor every drive on the system, the implant gets the\nfollowing information:\n\n- Drive type\n\n- Total number of bytes on disk\n\n- Total number of free bytes on disk\n\n- Name of a specified volume\n\nFigure 10. Implant collecting drive information from the endpoint.\n\n\n**_Capability #3: Launch process from Windows binary_**\n\nCommand code = 0x8300DA00C50092.\n\n_Description_\n\n- Launch a process from a binary specified by the\nfilepath provided by the control server.\n\n- Send a buffer (size=0x400) containing repeating 0x55\nto the control server if successful or 0xAA if failed.\n\n**_Capability #4: Get processes information_**\n\nCommand code = 0x62009A001C002B.\n\n_Description_\n\nEnumerate all processes currently running and record:\n\n- Process name\n\n- Process creation time\n\n- Process exit time\n\n- Process kernel mode time\n\n- Process user mode time\n\nFigure 11. Process related time stamps collected by the implant\n\n\n-----\n\n**_Capability #5: Terminate process_**\n\nCommand Code = 0x57001D00E20060.\n\n_Description_\n\n- Terminate a process specified by the control server.\n\n- The process can be specified using either:\n\n−−Process name\n\n−−Process ID\n\n- Send a buffer (size=0x400) containing repeating 0x55\nto the control server if successful or 0xAA if failed.\n\n**_Capability #6: Get file times_**\n\nCommand code = 0x0A3001A006E00F8.\n\n_Description_\n\n- Find files based on a filename search string (for\nexample, *.* or *.txt)\n\n- For each file found, get the following times:\n\n−−File creation time\n\n−−Last access time (including read, write, or execute\noperations)\n\n\n**_Capability #7: Read file_**\n\nCommand code = 0x98009C0034002D.\n\n_Description_\n\n- Read the contents of a file specified by the control\nserver and exfiltrate the contents of the file.\n\nFigure 12. Reading a file’s contents.\n\n\n-----\n\n**_Capability #8: Clear process memory_**\n\nCommand codes = 0x1800D50094008F,\n0x22001A00CA005E, 0x4D00D700AC0091, and\n0x0C2009200D30028.\n\n_Description_\n\n- Clear a memory blob in the process by overwriting it\nwith junk bytes.\n\n**_Capability #9: Write file to disk_**\n\nCommand codes = 0x8D001F00FB0061 and\n0x0B700550029003C.\n\n_Description_\n\n- Get a file path from the control server and create a file\ncorresponding to the file path.\n\n- Get content to be written to the file from the control\nserver by sending an HTTP POST request with HTTP\ndata in the format:\n<var1_enum>=<random_\nnumber>&page=suggestion&wr_id=<encoded_\ntime_stamp>&name=jquery2017<encoded_time_\n**stamp>09.css**\n\n- Send a buffer (size=0x400) containing repeating 0x55\nto the control server if successful or 0xAA if failed.\n\n\nFigure 13. Getting file contents from the control server to create a file.\n\n\n-----\n\n**_Capability #10: Delete file_**\n\nCommand code = 0x78005D008B00C6.\n\n_Description_\n\n- Delete a file specified by the control server if it is not a\ndirectory.\n\n- Send a buffer (size=0x400) containing repeating 0x55\nto the control server if successful or 0xAA if failed.\n\n**_Capability #11: Get additional file information for files_**\n**_in a directory_**\n\nCommand code = 0x0D0057005B00C4.\n\n_Description_\n\n- If the file path specified is a directory, then enumerate\nall files in the directory and send to the control server,\nincluding:\n\n−−File size\n\n−−File attributes\n\n−−File creation time\n\n- If the file path is not a directory (regular file), then the\nimplant fetches a DWORD pointed to by offset 0x3C in\nthe file.\n\n−−This parses MZ (executable) files, in particular where\nthe location of IMAGE_NT_HEADERS is specified at\noffset 0x3C.\n\n−−The implant reads the compile date of the MZ files\nby reading the time stamp (DWORD) at IMAGE_NT_\nSIGNATURE + 0x08.\n\n\n\n- The implant also records other data about MZ files:\n\n−−File attributes\n\n−−File size\n\n−−File creation time\n\n−−Last access time\n\n−−File write time\n\n−−MZ compile time\n\nFigure 14. Implant reading the compilation timestamp of a specified MZ\n(Windows executable) file.\n\n\n-----\n\n**_Capability #12: Connect to an IP address_**\n\nCommand code = 0x0B700150099005C.\n\n_Description_\n\n- Tests a connection to a specified network IP address\nover a specified port number.\n\n- The implant only attempts to connect to the network\naddress.\n\n- Based on the connection attempt, sends a buffer\n(size=0x400) containing repeating 0x55 to the control\nserver if successful or 0xAA if failed.\n\n**_Capability #13: Change file attributes_**\n\nCommand code = 0x0EC001700B2005D.\n\n_Description_\n\n- Modifies the following file information based on the\ncontent specified by the control server:\n\n−−File attributes (hidden, system, etc.)\n\n−−If the file is an MZ, then the compile time stamp of\nthe file is also modified in the PE header.\n\n−−If the file is not an MZ, then the implant can move\nthe file to a different location after modifying its\nattributes.\n\n\nFigure 15. Implant modifying the attributes and file times for a file.\n\n**_Capability #14: Variant of change file attributes_**\n**_(capability #13)_**\n\nCommand code = 0x0E200D2007C008E.\n\n_Description_\n\n- Changes file attributes (hidden, system, etc.) and\nmoves the file to a different location.\n\n\n-----\n\n##### Attribution\n\nAttributing an attack to any threat group is often\nriddled with challenges, including potential “false flag”\noperations by other threat actors. Technical evidence\nalone is not sufficient to attribute this activity with\nhigh confidence. However, based on our analysis, this\noperation shares multiple striking similarities with other\nthe Lazarus Group attacks; thus we present them for\nfurther analysis. Although these similarities point to\nLazarus, we also must consider the possibility of false\nflags.\n\n- The malicious Word documents were created in a\nKorean-language environment. (The code page is in\nKorean.)\n\n- The implant uses a variant of the dynamic API\nresolution technique we have observed with multiple\nLazarus implants.\n\n- The operation is very similar to a Lazarus operation\nfrom 2017 that targeted the US defense and energy\nsectors. The techniques, tactics, and procedures\nmatch those in this previous operation.\n\n- Rising Sun is an evolution of the Lazarus backdoor\nDuuzer, which was circulated in 2015 and targeted\nSouth Korea.\n\n\nVboxHook.dll\ntmp SOFTWARE\\\nMicrosoft\\Windows\nNT\\CurrentVersion\nProductName RUNAS;\nRUN; DLL; winsta0\\\ndefault Kernel32.\ndll lnk SOFTWARE\\\nMicrosoft\\Windows\\\nCurrentVersion\\Run\nperfd000 dat\n\n\n**Comparing Rising Sun to Duuzer**\n\nThe Advanced Threat Research team found that Rising\nSun shares code with the Duuzer implant family, which\nwas identified by the security community as belonging to\nLazarus. We compared the following samples and detail\ntheir similarities and differences.\n\nSamples used for comparison:\n\n- **Rising Sun:** f3bd9e1c01f2145eb475a98c87f94a25\n\n- **Duuzer:** 73471f41319468ab207b8d5b33b0b4be\n\n**Configuration data**\n\nAlthough the decryption schemes used by Rising Sun\nand Duuzer are different, both implants use similar\nconfiguration data used to drive their reconnaissance\ncapabilities:\n\n**Configuration data** **Configuration data**\n**decoded by Duuzer** **decoded by Rising Sun**\n\n\nVboxHook.dll\ntmp SOFTWARE\\\nMicrosoft\\Windows\nNT\\CurrentVersion\nProductName RUNAS;\nRUN; DLL; winsta0\\\ndefault Kernel32.\ndll lnk SOFTWARE\\\nMicrosoft\\Windows\\\nCurrentVersion\\Run\nC:\\Program Files\\\nInternet Explorer\\\niexplore exe ntuser\n\n\n-----\n\n**Library/API resolution**\n\nBoth implants use the same technique of constructing\nand decoding library and API names for dynamic API\nresolution. We explained this technique (a variant of\nbyte-chunk library/API name construction) in a preceding\nsection. Although the encoded data blob consisting of\nthe library/API strings in Duuzer is 0x181 bytes in size\nand is decoded using 0x30 as the XOR key, the encoded\ndata blob in Rising Sun is 0x147 bytes in size and is\ndecoded using 0xC8 as the XOR key.\n\nFigure 16. Duuzer string blob (at left) compared to a Rising Sun string\nblob.\n\nFigure 17. Matching Duuzer (at left) and Rising Sun data blob decoding\nschemes.\n\n\n**Library names**\n\nAnother similarity between the two implant families\nis that some of the decoded library names consist of\nrandomized characters. For example, Duuzer capitalizes\nrandom characters of the following library name:\n\n- uSEr32.dlL\n\nRising Sun does something similar in these library\nnames:\n\n- vErsIon.dll\n\n- advapI32.dLL\n\n\n-----\n\n##### Similarities between Rising Sun and Duuzer\n\nThe implant families are a direct match in several\ncapabilities as well as in the code structure and API\nuse to implement these capabilities. The following\ncapabilities are a direct match:\n\n**Initial reconnaissance (gather preliminary system**\n**info)**\n\nBoth implants capture the same information from the\nendpoint during their initial reconnaissance. The order\nof information and the API/code signatures are an exact\nmatch.\n\nInformation captured by both implants:\n\n- Network adapter info\n\n- Computer name\n\n- User name\n\n- IP address information\n\n- Native system information\n\n- OS product name from registry:\nSOFTWARE\\MICROSOFT\\Windows NT\\\nCurrentVersion | ProductName\n\n\nFigure 18. Similarities in Duuzer (at left) and Rising Sun in their\npreliminary reconnaissance code.\n\n\n-----\n\n**_Capability #1: Execute commands_**\n\nBoth implants can execute commands using cmd.exe\nwith the output redirected to a temp file on the\nendpoint:\n\n- cmd.exe /c “<command> > <%temp%>\\<Temp_\nFile_Prefix><random>.tmp” 2>&1\n\nBoth implants support changing directories natively,\nwithout having to execute cd commands through the\nshell. Supported cd commands:\n\n- cd <directory_path>\n\n- cd.\n\n- cd\\\n\n\nFigure 19. Duuzer (at left) and Rising Sun show similar code signatures\nfor executing commands.\n\n\n-----\n\n**_Capability #2: Get drive information_**\n\nBoth implants gather the same data using similar code\nsignatures:\n\n- Drive type\n\n- Total number of bytes on disk\n\n- Total number of free bytes on disk\n\n- Name of a specified volume\n\nFigure 21. Similar code signature and drive information gathered by\nDuuzer (at left) and Rising Sun.\n\n**_Capability #3: Launch a process from Windows binary_**\n\nBoth implants use the same API and flags to launch new\nprocesses on the endpoint.\n\n\n**_Capability #4: Get processes information_**\n\nBoth implants exfiltrate the exact same process\ninformation:\n\n- Process name\n\n- Process creation time\n\n- Process exit time\n\n- Process kernel mode time\n\n- Process user mode time\n\nFigure 22. Duuzer’s (at left) and Rising Sun’s process time information\ngathering code signatures.\n\n**_Capability #5: Terminate process_**\n\nBoth implants support the capability to terminate a\nprocess running on the system based on either the:\n\n- Process Name\n\n- Process ID\n\n\n-----\n\n**_Capability #6: Get file times_**\n\nBoth implants implement the same capabilities:\n\n- Find files based on a filename search string (for\nexample, *.* or *.txt)\n\n- For each file found, get the following times:\n\n−−File creation time\n\n−−Last access time (including read, write, or execute\noperations)\n\nFigure 23. Similarities in Duuzer’s (at left) and Rising Sun’s code for\ngathering file times.\n\n**_Capability #7: Read a file_**\n\nBoth implants can read the contents of a file specified by\nthe control server and exfiltrate the contents of the file.\n\n**_Capability #8: Clear process memory_**\n\nThere are no significant similarities between the two\nimplants.\n\n\n**_Capability #9: Write a file to disk_**\n\nBoth implants can write content served by the control\nserver to a file on disk (with file path also specified by the\ncontrol server) using the same sequence of actions:\n\n- Get a file path from the control server and create a file\ncorresponding to the file path.\n\n- Fetch content to be written to the file from the control\nserver using the implant-specific communication\nmechanism.\n\n- Once the content has been written to the file path,\nsend either a success or a failure response to the\ncontrol server.\n\n**_Capability #10: Delete file_**\n\nBoth implants can delete a file specified by the control\nserver if it is not a directory.\n\nFigure 24. Similarities in Duuzer’s (at left) and Rising Sun’s code for\ndeleting a file.\n\n\n-----\n\n**_Capability #11: Get additional file information for files_**\n**_in a directory_**\n\nBoth implants have the same capability to get file\ninformation for files in a specified directory, including the\nfollowing data:\n\n- File attributes\n\n- File size\n\n- File creation time\n\n- Last access time\n\n- File write time\n\n- MZ compile time\n\nFigure 25. Similar code between Duuzer (at left) and Rising Sun for\nreading the MZ’s compile time stamp.\n\n\n**_Capability #12: Connect to an IP address_**\n\nBoth implants test connections to a specified IP address\nusing the same actions, APIs, and code signatures:\n\n- Test a connection to a specified network IP address\nover a specified port number.\n\n- Only attempt to connect to the network address.\n\n- Based on the connection attempt, send either a\nsuccess or a failure response to the control server.\n\n**_Capability #13: Change file attributes_**\n\nBoth implants can modify the same file attributes:\n\n- File attributes (hidden, system, etc.)\n\n- If the file is an MZ, then the compile time stamp of the\nfile is also modified in the PE header.\n\nFigure 26. Similar code used by both Duuzer (at left) and Rising Sun to\nmodify file attributes and times.\n\n**_Capability #14: Variant of change file attributes_**\n\nBoth implants can change file attributes and move the\nfile to a different location.\n\n\n-----\n\n##### Differences between Rising Sun and Duuzer\n\nThere are some notable differences in implementation\nbetween the two families.\n\n**Communication mechanism: Duuzer uses a simple**\nsocket-based communication mechanism to send and\nreceive data from its control server. Rising Sun uses\nan HTTP-based mechanism. This difference may be an\nenhancement by the attackers because masking the\ncontrol server communication is more effective against\ndetection by the human eye and network intrusion\nprevention systems. High-level differences in the\ncommunication mechanisms:\n\n- Communication schemes (native socket vs. HTTP).\n\n- Command codes used to indicate a specific capability\n\n- Return codes/data indicating success or failure of a\ncommand’s execution\n\n**Encoding schemes: Apart from the library and API**\nname construction and decoding, the encryption\nschemes used in the implant are quite different. While\nDuuzer uses a custom XOR scheme to decode its\nconfiguration data, Rising Sun uses the RC4 stream\nalgorithm.\n\n\n##### Conclusion\n\nOur discovery of a new, high-function implant is\nanother example of how targeted attacks attempt to\ngain intelligence. The malware moves in several steps.\nThe initial attack vector is a document that contains a\nweaponized macro to download the next stage, which\nruns in memory and gathers intelligence. The victim’s\ndata is sent to a control server for monitoring by the\nactors, who then determine the next steps.\n\nWe have not previously observed this implant. Based\non our telemetry, we discovered that multiple victims\nfrom different industry sectors around the world have\nreported these indicators. Operation Sharpshooter’s\nsimilarities to Lazarus Group malware are striking, but\nthat does not ensure attribution. Was this attack just\na first-stage reconnaissance operation, or will there be\nmore? We will continue to monitor this campaign and\nwill report further when we or others in the security\nindustry receive more information. The McAfee\nAdvanced Threat Research team encourages our\npeers to share their insights and attribution of who is\nresponsible for Operation Sharpshooter.\n\n\n-----\n\n##### Indicators of Compromise\n\n MITRE ATT&CK™ techniques\n\n- Account discovery\n\n- File and directory discovery\n\n- Process discovery\n\n- System network configuration discovery\n\n- System information discovery\n\n- System network connections discovery\n\n- System time discovery\n\n- Automated exfiltration\n\n- Data encrypted\n\n- Exfiltration over command and control channel\n\n- Commonly used port\n\n- Process injection\n\n##### Hashes\n\n- 8106a30bd35526bded384627d8eebce15da35d17\n\n- 66776c50bcc79bbcecdbe99960e6ee39c8a31181\n\n- 668b0df94c6d12ae86711ce24ce79dbe0ee2d463\n\n- 9b0f22e129c73ce4c21be4122182f6dcbc351c95\n\n- 31e79093d452426247a56ca0eff860b0ecc86009\n\n\n##### Control servers\n\n- 34.214.99.20/view_style.php\n\n- 137.74.41.56/board.php\n\n- kingkoil.com.sg/board.php\n\n##### Document URLs\n\n- hxxp://208.117.44.112/document/Strategic Planning\nManager.doc\n\n- hxxp://208.117.44.112/document/Business Intelligence\nAdministrator.doc\n\n- hxxp://www.dropbox.com/s/2shp23ogs113hnd/\nCustomer Service Representative.doc?dl=1\n\n##### McAfee detection\n\n- RDN/Generic Downloader.x\n\n- Rising-Sun\n\n- Rising-Sun-DOC\n\n\n-----\n\n##### About McAfee\n\nMcAfee is the device-to-cloud cybersecurity company.\nInspired by the power of working together, McAfee\ncreates business and consumer solutions that make our\nworld a safer place. By building solutions that work with\nother companies’ products, McAfee helps businesses\norchestrate cyber environments that are truly integrated,\nwhere protection, detection, and correction of threats\nhappen simultaneously and collaboratively. By protecting\nconsumers across all their devices, McAfee secures their\ndigital lifestyle at home and away. By working with other\nsecurity players, McAfee is leading the effort to unite\nagainst cybercriminals for the benefit of all.\n\n**[www.mcafee.com.](http://www.mcafee.com)**\n\n2821 Mission College Blvd.\nSanta Clara, CA 95054\n888.847.8766\n[www mcafee com](http://www.mcafee.com)\n\n\n##### About McAfee Labs and Advanced Threat Research\n\nMcAfee Labs, led by McAfee Advanced Threat\nResearch, is one of the world’s leading sources for\nthreat research, threat intelligence, and cybersecurity\nthought leadership. With data from millions of sensors\nacross key threats vectors—file, web, message, and\nnetwork—McAfee Labs and McAfee Advanced Threat\nResearch deliver real-time threat intelligence, critical\nanalysis, and expert thinking to improve protection and\nreduce risks.\n\n**[www.mcafee.com/us/mcafee-labs.aspx.](http://www.mcafee.com/us/mcafee-labs.aspx)**\n\nMcAfee and the McAfee logo are trademarks or registered trademarks of McAfee, LLC or its subsidiaries in the US and other countries.\nOther marks and brands may be claimed as the property of others. MITRE ATT&CK and ATT&CK are trademarks of The MITRE Corporation.\nCopyright © 2018 McAfee, LLC. 4197_1218\nDECEMBER 2018\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.mcafee.com/enterprise/en-us/assets/reports/rp-operation-sharpshooter.pdf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.12.12.Operation_Sharpshooter/rp-operation-sharpshooter.pdf"
    ],
    "report_names": [
        "rp-operation-sharpshooter.pdf",
        "rp-operation-sharpshooter"
    ],
    "threat_actors": [
        {
            "id": "a13b5ca4-fb52-44a9-aa5a-595eca6789ed",
            "created_at": "2022-10-25T15:50:23.4331Z",
            "updated_at": "2025-03-27T02:00:55.46701Z",
            "deleted_at": null,
            "main_name": "Sharpshooter",
            "aliases": [
                "Sharpshooter"
            ],
            "source_name": "MITRE:Sharpshooter",
            "tools": [
                "Rising Sun"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "874ada20-4ca8-4997-9f2e-e3933742d09c",
            "created_at": "2023-01-06T13:46:38.857642Z",
            "updated_at": "2025-03-27T02:00:02.936711Z",
            "deleted_at": null,
            "main_name": "Operation Sharpshooter",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation Sharpshooter",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041842,
    "ts_creation_date": 1544113124,
    "ts_modification_date": 1544113138,
    "files": {
        "pdf": "https://archive.orkl.eu/47f5e50b6f18b96f012420b536a1ff120f74c45f.pdf",
        "text": "https://archive.orkl.eu/47f5e50b6f18b96f012420b536a1ff120f74c45f.txt",
        "img": "https://archive.orkl.eu/47f5e50b6f18b96f012420b536a1ff120f74c45f.jpg"
    }
}