{
    "id": "266b2958-966e-4fcf-96a1-8da1970b69ae",
    "created_at": "2023-01-12T15:04:04.354944Z",
    "updated_at": "2025-03-27T02:16:25.991766Z",
    "deleted_at": null,
    "sha1_hash": "0d80cfaac28f92647e90fb2c37a60415964bc4ca",
    "title": "2021-06-23 - Java Plug-Ins Delivering Zloader",
    "authors": "",
    "file_creation_date": "2022-05-28T03:29:38Z",
    "file_modification_date": "2022-05-28T03:29:38Z",
    "file_size": 1074276,
    "plain_text": "# Java Plug-Ins Delivering Zloader\n\n**labs.k7computing.com/**\n\nBy K7 Labs June 23, 2021\n\nFake plug-ins delivering malware are not new to the cyber security community, but\nmodules used to deliver the malware and the malware itself varies depending on what is\ntrending. As long as naive users exist, this initial vector will always be successful in\nbefooling the users. In this blog, we will be seeing how threat actors used a fake porn site\nto deliver the Zloader malware through a fake Java plug-in. Figure 1 shows how a fake\nporn site urges users to update their Java plug-in in order to play the requested video.\n\n\n-----\n\nFigure 1: Fake Java plug-in installer\nWhen downloaded and executed, the fake Java plug-in gets installed under the following\nfolder C:\\Program Files (x86)\\Microsoft Corporation\\Windows Security\n**Update\\j_service.exe as depicted in Figure 2. It also gives users the option to uninstall**\n**the plug-in from the control panel. In some cases, it also gets installed in C:\\program**\n**files (x86)\\sun technology network\\oracle java se\\j_service.exe.**\n\n\n-----\n\nFigure 2: Installation directory\nj_service.exe marked in Figure 2 is the downloader module which downloads the Zloader\nonto the system. NSudo.exe marked in Figure 2 is a system management toolkit\ndeveloped by M2team that helps to launch any application with full admin privileges.\nFurther information about the tool can be found in hxxps[:]//nsudo.m2team[.]org/zh-hans/.\nThe setup.bat file contains a sequence of instructions to disable/stop/remove Windows\ncomponents like Windows Defender as depicted in Figure 3.\n\n\n-----\n\nFigure 3: setup.bat\nAfter successful installation, the java.msi starts the j_service.exe process. The\nj_service.exe by itself is not responsible for downloading the Zloader, instead it loads\nanother DLL file named AccessibleHandler.dll and creates a new thread to execute it.\nThe AccessibleHandler first checks the region locale to decide whether to continue with\nfurther execution or to terminate the execution. It converts the code page language to\nappropriate locale names so that it can be compared later on. The converted locale names\nare Japan, China, Korea and Taiwan as depicted in Figure 4 which might be their targeted\nregion.\n\nFigure 4: Locale name\n\nAfter that it performs some basic anti-debugging checks like IsDebuggerPresent(), PEB\nchecks which can be easily bypassed. Then it proceeds to contact the URL to download\nthe encrypted Zloader. It first concatenates the parts of the URL to get the full URL as\ndepicted in Figure 5. Later, it contacts the URL to download the encrypted content as\ndepicted in Figure 6 and stores it in a buffer for decrypting later.\n\n\n-----\n\nFigure 5: URL concat\n\nFigure 6: Wireshark capture of encrypted file download\nAfter decrypting it gets the %Appdata% path using SHGetFolderPathA() API as depicted\nin Figure 7. Then it creates a file named Microsoft_shared.tmp in the %appdata% folder\nand writes the decrypted content in the buffer to the file Microsoft_shared.tmp as depicted\nin Figure 8.\n\n\n-----\n\nFigure 7: Get %Appdata%\n\n\nlocation\n\nFigure 8: Createfile and Writefile\n\n\n-----\n\nThe Microsoft_shared.tmp is a DLL file and is executed using regsvr32.exe. It first\nconcatenates the string regsvr32 /s as depicted in Figure 9 using similar routine used to\nconcatenate the URL and executes the Microsoft_shared.tmp using\n**CreateProcessAsUserW() API as depicted in Figure 10 with command line argument**\nregsvr32 /s.\n\nFigure 9: Concat regsvr32 /s\n\nFigure 10: CreateProcessAsUserW()\nThe Microsoft_shared.tmp is a custom packed file which was uploaded to Intezer to see if\nthe memory module matches any genes of the known malware family as depicted in\nFigure 11. As predicted, it matched with the Zloader variant.\n\nFigure 11: Genes matching (courtesy of\n\nIntezer)\n\n\n-----\n\nThe fake porn site Pornovideos8k[.]com might be taken down by the time this blog gets\nreleased. However the URL on which the encrypted file was hosted vivacemusic[.]site\nwould still be live which even has its own login seeming like a bot panel or repository as\ndepicted in Figure 12 and the whois info of the same is depicted in Figure 13.\n\nFigure 12: Authentication page\n\nFigure 13: whois info\nThis type of attack is not new, however users still fall victim to the same trick. We strongly\nrecommend users to be cautious when installing such plug-ins from unknown sites and\nstay away from those showing notifications/pop ups. Install security software from a\nreputed organization like K7 Computing which will protect you from these kinds of threats.\n\n## Indicators Of Compromise (IOCs)\n\n\n-----\n\n**Hash** **File Name** **K7 Detection**\n**Name**\n\n67fc6cca4761bb4913b49d3257dff8a4 Microsoft_shared.tmp Trojan (\n0057dc291 )\n\n1c0cbc7b9df0831070a0b8074d166644 j_service.exe TrojanDownloader (\n0057c2d31 )\n\nDC3B94EAFF84F7E3832E5C91CE044173 AccessibleHandler.dll TrojanDownloader (\n0057dac31 )\n\n65455FE14BB0F3BAA9D43C4CF2B421F7 Java.msi Trojan (\n0001140e1 )\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-23 - Java Plug-Ins Delivering Zloader.pdf"
    ],
    "report_names": [
        "2021-06-23 - Java Plug-Ins Delivering Zloader.pdf"
    ],
    "threat_actors": [
        {
            "id": "6c4f98b3-fe14-42d6-beaa-866395455e52",
            "created_at": "2023-01-06T13:46:39.169554Z",
            "updated_at": "2025-03-27T02:00:03.011739Z",
            "deleted_at": null,
            "main_name": "Evil Corp",
            "aliases": [
                "GOLD DRAKE"
            ],
            "source_name": "MISPGALAXY:Evil Corp",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535844,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653708578,
    "ts_modification_date": 1653708578,
    "files": {
        "pdf": "https://archive.orkl.eu/0d80cfaac28f92647e90fb2c37a60415964bc4ca.pdf",
        "text": "https://archive.orkl.eu/0d80cfaac28f92647e90fb2c37a60415964bc4ca.txt",
        "img": "https://archive.orkl.eu/0d80cfaac28f92647e90fb2c37a60415964bc4ca.jpg"
    }
}