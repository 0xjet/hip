{
    "id": "a8039ab0-027c-4412-b51a-807f89077192",
    "created_at": "2023-01-12T15:08:24.710493Z",
    "updated_at": "2025-03-27T02:09:18.798719Z",
    "deleted_at": null,
    "sha1_hash": "3563d4d896d491e6634c7555313c62025248039e",
    "title": "2020-12-14 - Sunburst- Supply Chain Attack Targets SolarWinds Users",
    "authors": "",
    "file_creation_date": "2022-05-28T22:09:50Z",
    "file_modification_date": "2022-05-28T22:09:50Z",
    "file_size": 1406587,
    "plain_text": "# Sunburst: Supply Chain Attack Targets SolarWinds Users\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/sunburst-supply-chain-attack-solarwinds](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/sunburst-supply-chain-attack-solarwinds)**\n\n\n-----\n\nThreat Hunter TeamSymantec\n\n## A number of Symantec customers affected by wide-ranging trawl for potential targets of interest.\n\n**UPDATE December 16 2020: Our blog has been updated with analysis of the Teardrop**\n_second-stage malware and an example of the post-compromise attack chain. We have also_\n_provided clarification on the use of Symantec’s name in a certificate used to sign the_\n_SolarWinds software._\n\nThousands of organizations have been affected by a supply chain attack that compromised\nthe update mechanism for SolarWinds Orion software in order to deliver a backdoor Trojan\nknown as Sunburst (Backdoor.Sunburst) (aka Solorigate).\n\n[Details on the attacks were disclosed yesterday (December 13) by the security firm FireEye.](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\n[SolarWinds has also published a security advisory for its customers.](https://www.solarwinds.com/securityadvisory)\n\nThe campaign has been underway since at least March 2020. Any Orion user who\ndownloaded an update in this period is likely to have been infected with Sunburst. According\nto FireEye, the attackers conducted further malicious activity on a subset of victim\norganizations that were of interest to them.\n\nBy their nature, supply chain attacks are indiscriminate and will infect any user of the\ncompromised software. They are carried out in order to provide the attacker with access to a\nlarge number of organizations, a subset of which will be identified as targets of interest for\nfurther compromise.\n\nThe Trojanized software was signed by a certificate marked as being issued by Symantec.\nSymantec sold its certificate authority business to Digicert in 2018. The certificate in question\nwas a legacy certificate still using the Symantec brand name. Symantec has contacted\nDigicert, which has confirmed that it is investigating the issue.\n\nSymantec has identified more than 2,000 computers at over 100 customers that received\nTrojanized software updates. We have found a small number of organizations where a\nsecond stage payload (Backdoor.Teardrop) was used.\n\n## Sunburst analysis\n\nAn existing SolarWinds DLL called SolarWinds.Orion.Core.BusinessLayer.dll was modified\nby the attackers to include an added class.\n\nThe malware is designed to remain inactive for a period after installation. It will then attempt\nto resolve a subdomain of avsvmcloud[.]com. The DNS response will deliver a CNAME\nrecord that directs to a command and control (C&C) domain.\n\n\n-----\n\nIn\nSolarWinds.Orion.Core.BusinessLayer.BackgroundInventory.InventoryManager.RefreshInterval()\ncode is added to call OrionImprovementBusinessLayer.Initialize().\n\nOrionImprovementBusinessLayer is a malicious class added by the attacker. It has the\nfollowing functionality:\n\nTerminates the backdoor thread\nSet delay time before execution\nCollect and upload system information including:\n\nDomain\nSID of administrator account\nHostname\nUsername\nOperating system version\nPath of system directory\nDays elapsed since the system started\nInformation on network adapters, including:\n\nDescription\nMACAddress\nDHCPEnabled\nDHCPServer\nDNSHostName\nDNSDomainSuffixSearchOrder\nDNSServerSearchOrder\nIPAddress\nIPSubnet\nDefaultIPGateway\nDownload and run code\nIterate the file system\nCreate and delete files\nCalculate file hashes\nRead, write, and delete registry entries\nReboot the system\n\n## Second-stage payload: Teardrop\n\nA second stage payload, a backdoor called Teardrop, is deployed against a targets of interest\nto the attackers. Symantec has observed two variants of Teardrop, both of which behave\nsimilarly and are used to deliver a further payload – the Cobalt Strike commodity malware.\n\nThe first variant (SHA256:\nb820e8a2057112d0ed73bd7995201dbed79a79e13c79d4bdad81a22f12387e07) is a DLL.\nThe malicious code is contained in the export Tk CreateImageType ordinal 209 When\n\n\n-----\n\nexecuted, that malicious code reads a file named upbeat_anxiety.jpg from the current\ndirectory and ensures it has a jpg header. It will also check that the registry key\nHKCU\\Software\\Microsoft\\CTF exists. An embedded copy of Cobalt Strike is then extracted\nand executed. That CobaltStrike sample connects to infinitysoftwares[.]com for command\nand control.\n\nThe second variant\n(SHA256:1817a5bf9c01035bcf8a975c9f1d94b0ce7f6a200339485d8f93859f8f6d730c) is\nsimilar, except that the file it loads is called festive_computer.jpg. The embedded\nCobaltStrike payload connects to ervsystem[.]com for command and control.\n\n\n-----\n\n-----\n\n## Post-compromise attack chain\n\nThe post-compromise attack chain for one computer investigated saw the initial Sunburst\nmalware, a modified solarwinds.orion.core.businesslayer.dll, installed through the Orion\nupdate process on the victim computer on the 7th of the month.\n\nOn the 28th of the month, 21 days later, the legitimate executable\nsolarwinds.businesslayerhost.exe, which loads the malicious DLL, created a copy of\nTeardrop in a file called cbsys.dll, in the c:\\windows\\panther folder. This filename and path\nappear to be unusual since most instances of Teardrop were created in a file called\nnetsetupsvc.dll in the c:\\windows\\syswow64 folder, as documented by FireEye.\n\nThe Backdoor.Teardrop sample is a DLL with malicious code contained in the export\nTk_CreateImageType. When executed, that export reads a file named upbeat_anxiety.jpg\nfrom the current directory and ensures it has a jpg header. It will also check that the registry\nkey HKCU\\Software\\Microsoft\\CTF exists. An embedded copy of Cobalt Strike is then\nextracted. That CobaltStrike samples connects a C&C server - infinitysoftwares[.]com.\n\nAt this point, the attackers launch WMI to execute rundll32.exe to load another malicious DLL\ncalled resources.dll in the path csidl_windows\\desktoptileresources\\. Resources.dll attempts\nto obtain credentials by accessing lsass.exe using similar techniques to Mimikatz, a widely\nused credential dumping tool.\n\nAdfind, a tool that is able to query Active Directory, is then introduced to the system as\nsearchindex.exe and then executed (cmd.exe /c SearchIndex.exe -sc u:<removed> > .\\h.txt).\nResults are saved in the file h.txt. Using this information, the attackers are attempting to gain\nelevated privileges (e.g. domain administrator) to access the domain or laterally traverse the\nenvironment.\n\n## Recommended actions\n\nOrion users should update to Orion Platform version 2020.2.1 HF 2.\n\nOrion users should check their networks for indications of post-compromise activity,\nincluding:\n\nUse of Teardrop in-memory malware to drop Cobalt Strike Beacon.\n\n\n-----\n\nCommand and control (C&C) infrastructure leaks the configured hostname in RDP SSL\ncertificates. Scanning for your organization’s hostnames can uncover malicious IP\naddresses used by the attackers, indicating post-compromise activity.\nGeolocation of IP addresses used for remote access may reveal if a compromised\naccount is being simultaneously used by a legitimate user and the attackers.\nThe attackers use multiple IP addresses per VPS provider. If a malicious login from an\nunusual ASN is identified, other logins from that ASN may also be malicious.\nLogs for SMB sessions may show access to legitimate directories and follow a deletecreate-execute-delete-create pattern in a short period of time.\n\nIt should be borne in mind that although there may be some commonalities in postcompromise activity, each victim is likely to see different patterns in activity. That activity is\nlikely to involve heavy use of living-off-the-land techniques to minimize the likelihood of being\ndetected, something the attackers seem to be prioritizing based on how they conducted the\nfirst stages of the attack.\n\n## Protection/Mitigation\n\nTools associated with these attacks will be detected and blocked on machines running\nSymantec Endpoint products.\n\n**File-based protection:**\n\nBackdoor.Sunburst\nBackdoor.Sunburst!gen1\nBackdoor.SuperNova\nBackdoor.Teardrop\n\n**Network-based protection:**\n\nSystem Infected: Sunburst Malware Activity\n\n## Indicators of Compromise\n\n**IOC** **File type**\n\nd0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600 Sunburst\ninstaller\n\n019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134 Sunburst\nbackdoor\n\nce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6 Sunburst\nbackdoor\n\n\n-----\n\n**IOC** **File type**\n\n32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77 Sunburst\nbackdoor\n\ndab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b Sunburst\nbackdoor\n\neb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed Sunburst\nbackdoor\n\nc09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77 Sunburst\nbackdoor\n\nac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c Sunburst\nbackdoor\n\n1817a5bf9c01035bcf8a975c9f1d94b0ce7f6a200339485d8f93859f8f6d730c Teardrop\nbackdoor\n\nb820e8a2057112d0ed73bd7995201dbed79a79e13c79d4bdad81a22f12387e07 Teardrop\nbackdoor\n\n*.avsvmcloud[.]com Domain\n\nervsystem[.]com Domain\n\ninfinitysoftwares[.]com Domain\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-14 - Sunburst- Supply Chain Attack Targets SolarWinds Users.pdf"
    ],
    "report_names": [
        "2020-12-14 - Sunburst- Supply Chain Attack Targets SolarWinds Users.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536104,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653775790,
    "ts_modification_date": 1653775790,
    "files": {
        "pdf": "https://archive.orkl.eu/3563d4d896d491e6634c7555313c62025248039e.pdf",
        "text": "https://archive.orkl.eu/3563d4d896d491e6634c7555313c62025248039e.txt",
        "img": "https://archive.orkl.eu/3563d4d896d491e6634c7555313c62025248039e.jpg"
    }
}