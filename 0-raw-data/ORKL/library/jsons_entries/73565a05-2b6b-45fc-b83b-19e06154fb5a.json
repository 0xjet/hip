{
    "id": "73565a05-2b6b-45fc-b83b-19e06154fb5a",
    "created_at": "2023-01-12T15:01:55.981684Z",
    "updated_at": "2025-03-27T02:09:07.900674Z",
    "deleted_at": null,
    "sha1_hash": "048d5e92a8d1df3cfc8e391b88d831c70cd13fdf",
    "title": "2022-04-15 - STRT-TA03 CPE - Destructive Software",
    "authors": "",
    "file_creation_date": "2022-05-28T23:24:56Z",
    "file_modification_date": "2022-05-28T23:24:56Z",
    "file_size": 154177,
    "plain_text": "# STRT-TA03 CPE - Destructive Software\n\n**[splunk.com/en_us/blog/security/strt-ta03-cpe-destructive-software.html](https://www.splunk.com/en_us/blog/security/strt-ta03-cpe-destructive-software.html)**\n\nApril 15, 2022\n\nBy [Splunk Threat Research Team April 15, 2022](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)\n\nThe Splunk Threat Research Team is monitoring several malicious payloads targeting Customer\nPremise Equipment (CPE) devices. These are defined as devices that are at customer (Commercial,\nResidential) premises and that provide connectivity and services to the internet backbone. Examples\ninclude:\n\nCable Modems\n\n\n-----\n\nInternet Gateways\nSatellite Modems\nFirewalls\nHome routers, cable set-top boxes, DSL modems\nVOIP telephones\n\nThe above devices are prevalent and fundamental for internet connectivity. Malicious actors can target\nthese devices to build very powerful botnets which in combination with tactical payloads, can potentially\n[exert a significant effect on critical internet infrastructure or even Operational Technologies devices.](https://en.wikipedia.org/wiki/Operational_technology)\n[CPE devices are generally not very powerful in terms of processing or functionality, however, when](https://en.wikipedia.org/wiki/Customer-premises_equipment)\nhundreds of thousands of these devices are compromised and work in aggregation via Command and\nControl they can cause significant damage. An example of this type of payload is VPNFilter discovered\n[by Cisco Talos and said to have compromised 500,000 devices worldwide.](https://blog.talosintelligence.com/2018/05/VPNFilter.html)\n\nBased on the current, ongoing geopolitical events and the recent takedown of a similar malicious\n[payload by the FBI named “Cyclops Blink” and attributed to Russian Federation’s Main Intelligence](https://www.justice.gov/opa/pr/justice-department-announces-court-authorized-disruption-botnet-controlled-russian-federation)\nDirectorate (GRU). The Splunk Threat Research Team has developed specific analytics to detect this\n[type of malicious code, including Cyclops Blink, and](https://www.ncsc.gov.uk/files/Cyclops-Blink-Malware-Analysis-Report.pdf) [AcidRain.](https://www.sentinelone.com/labs/acidrain-a-modem-wiper-rains-down-on-europe/)\n\nThe main malicious functions of these malicious payloads can be resumed in:\n\nSystem discovery and footprinting\nIn some cases resists removal/reboot\nDestroys infected equipment (Wipes flash memory, sd, memory card, and block devices)\nModification of routing traffic rules\nAbility to download and install additional payloads\nObfuscated multiple C2 callback failover (TOR, VPS, Geolocation)\n\nAnother common thing about these payloads is that they target popular commercial CPE brands. This\nspeaks of the intention of targeting critical infrastructure to gain access, implant malicious payloads,\nand hoard as many compromised devices as possible that can be used for subsequent attacks.\n\nDue to the ability to download additional payloads, these additional payloads may likely be\nimplemented based on tactical objectives (DDoS, Destruction, Espionage, Lateral Movement, etc). It is\nimportant to notice that many of these devices are not just commercial, industrial, or military but used in\ncivilian networks, which exposes the general population to these attacks and presents a direct threat to\ncivilian infrastructure and livelihood.\n\nFor specific make and model of affected devices please refer to the reference section at the end of this\nadvisory.\n\nThe following are the detections crafted for these payloads.\n\n## Cyclops Blink\n\n\n-----\n\nName Technique\nID\n\n\nTactic Description\n\n\nLinux Iptables\nFirewall Modification\n\nLinux Kworker\nProcess\nCommandLine\n\nLinux Stdout\nRedirection To Dev\nNull File\n\n## AcidRain\n\n\n[T1562.004](https://attack.mitre.org/techniques/T1562/004/) Defense\nEvasion\n\n[T1036.004](https://attack.mitre.org/techniques/T1036/004/) Defense\nEvasion\n\n[T1562.004](https://attack.mitre.org/techniques/T1562/004/) Defense\nEvasion\n\n\nThis analytic looks for suspicious command lines that\nmodify the iptables firewall setting of a Linux\nmachine.\n\nThis analytic looks for suspicious process kworker\ncommand lines in a Linux machine.\n\nThis analytic looks for suspicious command lines that\nredirect the stdout or possible stderr to dev/null file.\n\n\nName Technique\nID\n\n\nTactic Description\n\n\nLinux High Frequency Of\nFile Deletion In Etc\nFolder(New)\n\nLinux Deletion Of Init\nDaemon Script(New)\n\nLinux Deletion of SSL\nCertificate(New)\n\nLinux deletion Of SSH\nKey(New)\n\nLinux Deletion Of\nServices(New)\n\nLinux Deletion Of Cron\nJobs(New)\n\n\n[T1485,](https://attack.mitre.org/techniques/T1485)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n[T1485,](https://attack.mitre.org/techniques/T1485)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n[T1485,](https://attack.mitre.org/techniques/T1485)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n[T1485,](https://attack.mitre.org/techniques/T1485)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n[T1485,](https://attack.mitre.org/techniques/T1485)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n[T1485,](https://attack.mitre.org/techniques/T1485)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n\nDefense\nEvasion,\nImpact\n\nDefense\nEvasion,\nImpact\n\nDefense\nEvasion,\nImpact\n\nDefense\nEvasion,\nImpact\n\nDefense\nEvasion,\nImpact\n\nDefense\nEvasion,\nImpact\n\n\nThis analytic looks for a high frequency of file\ndeletion relative to process name and process\nid /etc/ folder.\n\nThis analytic looks for deletion of the init\ndaemon script in a Linux machine.\n\nThis analytic looks for deletion of the SSL\ncertificate in a Linux machine.\n\nThis analytic looks for deletion of an ssh key in\na Linux machine.\n\nThis analytic looks for deletion of services in a\nLinux machine.\n\nThis analytic looks for deletion of cron jobs in a\nLinux machine.\n\n\n-----\n\n[The above searches will be available at research.splunk.com, the Splunk Threat Research Team](https://research.splunk.com/)\n(STRT) [security content repository, and the Splunk ES Content Update (ESCU) application at](https://github.com/splunk/security_content/)\n[Splunkbase.](https://splunkbase.splunk.com/app/3449/)\n\n## IOC:\n\nFilename Size Sha256\n\n\nacid_rain.elf 22656\nbytes\n(22 KiB)\n\ncyclopblink1 2332316\nbytes\n(2277\nKiB)\n\ncyclopblink2 7346456\nbytes\n(7174\nKiB)\n\n## Mitigations\n\n\n9b4dfaca873961174ba935fddaf696145afe7bbf5734509f95feb54f3584fd9a\n\n4ec5e0c5dccc5891d39ea76e3c3d3e26d8830d7aa4d63db6084dbfbec6f0d211\n\nfc1e50172c0ce221452b967d1ef705f11bbfe2d54c533d68bd2a7a094605df2d\n\n\nThe above detections were crafted under a Linux environment and can be used as guidelines for other\narchitectures such as MISP or PowerPC. The key to implementing these types of detections is the\nability to monitor via a logging mechanism (i.e syslog).\n\nAddressing the threat of these types of payloads can be very difficult as many of these devices do not\nallow for the implementation of centralized logging which impairs monitoring and defense. Considering\nthat many enterprises have had remote work programs since the pandemic started, their perimeter\nmay likely have a device affected by these payloads, in which case the best course of action is to\ndisconnect, discard and replace them. Some other mitigation options are:\n\nDiscard affected hardware as payload resists removal, and rebooting.\nImplement integrity validation mechanisms on CPEs software and hardware\nUpgrade and harden CPE devices, discard them if the device has reached the end of life (EOL).\nIf a device cannot be monitored, the device must be discarded.\nConsult with vendors, ISP on how to improve security on CPE devices\nEnable logging of these devices to implement detections\n[Follow CISA Home Network Security Guide (ST15-002)](https://www.cisa.gov/uscert/ncas/tips/ST15-002)\n[Follow CISA Securing Network Infrastructure Devices (ST18-001)](https://www.cisa.gov/uscert/ncas/tips/ST18-001)\n\n\n-----\n\nIt is also important to consider that an advanced adversary as the aforementioned has likely devised\nother ways of access, exploitation or persistence that may be yet unknown and that may target these\ndevices after remediation. This is why prevention, monitoring, and detection are fundamental to defend\nagainst these threats.\n\n## Reference\n\n[CISA Alert (AA22-054A): https://www.cisa.gov/uscert/ncas/alerts/aa22-054a](https://www.cisa.gov/uscert/ncas/alerts/aa22-054a)\n[Watchguard advisory: https://detection.watchguard.com](https://detection.watchguard.com/)\nNCSC Password Administration for System Owners\nGuide: [https://www.ncsc.gov.uk/collection/passwords](https://www.ncsc.gov.uk/collection/passwords)\nNCSC Cyclops Blink Malware Analysis Report: https://www.ncsc.gov.uk/files/Cyclops-BlinkMalware-Analysis-Report.pdf\nCISCO how to harden IOS Devices: https://www.cisco.com/c/en/us/support/docs/ip/accesslists/13608-21.html\nCISA advises D-LINK users to take vulnerable routers\noffline: https://blog.malwarebytes.com/exploits-and-vulnerabilities/2022/04/cisa-advises-d-linkusers-to-take-vulnerable-routers-offline/\nCisco Talos VPNFilter advisory and affected\n[devices: https://en.wikipedia.org/wiki/VPNFilter#cite_note-ars-9](https://en.wikipedia.org/wiki/VPNFilter#cite_note-ars-9)\nCyclops Blink affected devices: https://www.zdnet.com/article/cyclops-blink-botnet-launchesassault-against-asus-routers/\nSentinel One AcidRain analysis: https://www.sentinelone.com/labs/acidrain-a-modem-wiperrains-down-on-europe\nNSA - Protecting VAST\nCommunications: https://media.defense.gov/2022/Jan/25/2002927101/-1/-1/0/CSA_PROTECTIN\nG_VSAT_COMMUNICATIONS_01252022.PDF\n[ASUS security bulletin: https://www.asus.com/content/ASUS-Product-Security-Advisory/](https://www.asus.com/content/ASUS-Product-Security-Advisory/)\n\n## Learn More\n\n[You can find the latest content about security analytic stories on GitHub and in Splunkbase.](https://github.com/splunk/security-content/releases/tag/v3.12.0) Splunk\nSecurity Essentials also has all these detections available via push update. In the upcoming weeks, the\nSplunk Threat Research Team will be releasing a more detailed blog post on this analytic story. Stay\ntuned!\n\nFor a full list of security content, check out the [release notes on](https://docs.splunk.com/Documentation/ESSOC/3.21.0/RN/Enhancements) [Splunk Docs.](https://docs.splunk.com/Documentation/ESSOC)\n\n## Feedback\n\nAny feedback or requests? Feel free to put in an issue on GitHub and we’ll follow up. Alternatively, join\nus on the [Slack channel #security-research. Follow these instructions If you need an invitation to our](https://splunk-usergroups.slack.com/)\nSplunk user groups on Slack.\n\nWe would like to thank the following for their contributions to this post.\n\nTeoderick Contreras\nRod Soto\n\n\n-----\n\nJose Hernandez\nPatrick Barreiss\nLou Stella\nMauricio Velazco\nMichael Haag\nBhavin Patel\nEric McGinnis\n\nPosted by\n\n**[Splunk Threat Research Team](https://www.splunk.com/en_us/blog/author/secmrkt-research.html)**\n\nThe Splunk Threat Research Team is an active part of a customer’s overall defense strategy by\nenhancing Splunk security offerings with verified research and security content such as use cases,\ndetection searches, and playbooks. We help security teams around the globe strengthen operations by\nproviding tactical guidance and insights to detect, investigate and respond against the latest threats.\nThe Splunk Threat Research Team focuses on understanding how threats, actors, and vulnerabilities\n[work, and the team replicates attacks which are stored as datasets in the Attack Data repository.](https://github.com/splunk/attack_data/)\n\nOur goal is to provide security teams with research they can leverage in their day to day operations\nand to become the industry standard for SIEM detections. We are a team of industry-recognized\nexperts who are encouraged to improve the security industry by sharing our work with the community\nvia conference talks, open-sourcing projects, and writing white papers or blogs. You will also find us\npresenting our research at conferences such as Defcon, Blackhat, RSA, and many more.\n\n[Read more Splunk Security Content.](https://github.com/splunk/security_content)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-15 - STRT-TA03 CPE - Destructive Software.pdf"
    ],
    "report_names": [
        "2022-04-15 - STRT-TA03 CPE - Destructive Software.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535715,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653780296,
    "ts_modification_date": 1653780296,
    "files": {
        "pdf": "https://archive.orkl.eu/048d5e92a8d1df3cfc8e391b88d831c70cd13fdf.pdf",
        "text": "https://archive.orkl.eu/048d5e92a8d1df3cfc8e391b88d831c70cd13fdf.txt",
        "img": "https://archive.orkl.eu/048d5e92a8d1df3cfc8e391b88d831c70cd13fdf.jpg"
    }
}