{
    "id": "e2879899-052d-4977-8258-e44f503c1b2c",
    "created_at": "2023-01-12T15:08:12.553288Z",
    "updated_at": "2025-03-27T02:05:56.931954Z",
    "deleted_at": null,
    "sha1_hash": "a5a7acaaf59afc20bd3f2f692ec7f8ea1fcbcab6",
    "title": "2020-07-23 - The resurgence of the Ursnif banking trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T02:35:09Z",
    "file_modification_date": "2022-05-28T02:35:09Z",
    "file_size": 189627,
    "plain_text": "# The resurgence of the Ursnif banking trojan\n\n**[darktrace.com/en/blog/the-resurgence-of-the-ursnif-banking-trojan/](https://www.darktrace.com/en/blog/the-resurgence-of-the-ursnif-banking-trojan/)**\n\nMax Heinemeyer, Director of Threat Hunting | Thursday July 23, 2020\n\nEarlier this month, Darktrace’s Cyber AI detected the Ursnif banking trojan, described as\n[May’s most wanted malware, making a resurgence across its customers’ networks. This blog](https://www.globenewswire.com/news-release/2020/06/15/2047871/0/en/May-2020-s-Most-Wanted-Malware-Ursnif-Banking-Trojan-Ranks-On-Top-10-Malware-List-for-First-Time-Over-Doubling-Its-Impact-On-Organizations.html)\nfollows the malicious activity in one financial services company in the US, detailing how and\nwhy [Darktrace Antigena stepped in and autonomously stopped the attack in real time.](http://10.10.0.46/network)\n\nBanking trojans continue to present a credible and persistent threat to organizations of all\nsizes across the globe. This attack was delivered via phishing email, which initiated a\ndownload of an executable file masquerading as a .cab extension.\n\nThis specific banking trojan is particularly sophisticated, with multiple new command and\ncontrol (C2) domains registered – identifiable because several distinct Domain Generation\nAlgorithms (DGA) were observed across different networks – the majority of which were only\nregistered the day prior to the campaign.\n\nFigure 1: A timeline of the attack\n\n## Phishing email catches organizations unaware\n\n\n-----\n\nThe malware itself was delivered via phishing email. The attack was not recognized by\nantivirus solutions at the time of delivery, slipping through the organization’s perimeter\nsolutions and landing in employees’ inboxes. Unknowingly, an employee opened a disguised\nattachment containing macros, downloading an executable file masquerading as a .cab\nextension.\n\nInterestingly, the malware also used new User Agents imitating Zoom and Webex, a clear\nattempt to blend in with assumed network traffic. After the malware was downloaded, several\ndevices were observed making connections using these Zoom or Webex User Agents to\nnon-Zoom and non-Webex domains, another attempt to blend in.\n\nFigure 2: Darktrace’s Breach Event Log shows a number of models were triggered\n\nFigure 3: Darktrace’s Device Event Log showing the device was connected to Outlook at the\ntime of the executable file download\n\nAfter the downloads, Darktrace’s AI observed beaconing to rare DGA domains. The majority\nof these domains were Russian and registered within the previous 24 hours.\n\nFigure 4: A screenshot taken from one of the C2 domains observed, tobmojiol2adf[.]com,\nwhich appears to host a login page\n\nFigure 5: The External Sites Summary of one of the C2 domains observed,\ntobmojiol2adf[.]com, which was identified as 100% rare for the network at the time of the\nmodel breach.\n\nThis attack managed to evade the rest of the organization’s security stack since the domains\nobserved were recently registered and the majority of the file hashes and IoCs had not yet\nbeen flagged by OSINT tools, thus bypassing all signature-based detections. The initial file\ndownloads also purported to be .cab files, but Darktrace’s AI identified that these were in fact\nexecutable files.\n\nMultiple Darktrace detections, including the ‘Masqueraded File Transfer’ model and the\n‘Initial Breach Chain Compromise’ model, alerted the security team to this activity. At the\nsame time, the models triggered Darktrace’s Cyber AI Analyst to launch an automated\ninvestigation into the security incident, which surfaced additional vital information and\ndramatically reduced time to triage.\n\nFigure 6: The Cyber AI Analyst output showing the subsequent C2 connections made by the\ndevice after the executable file download\n\n\n-----\n\nFigure 7: Model breaches from the affected device, showing the malicious file download and\nsubsequent command and control beaconing activity\n\nFigure 8: Model Breach Event Log, showing Antigena’s response after the masqueraded file\ndownload and a new outbound connection\n\n## The case for Autonomous Response\n\nThe Ursnif banking trojan presents a particularly lethal threat: silent, stealthy, and capable of\nstealing vital financial information, email credentials, and other sensitive data at machine\nspeeds. The rise of advanced malware like this demonstrates the need for security\ntechnology that can stay ahead of attackers. For this organization, the malware download\nand subsequent command and control activity could have represented the start of a costly\nattack.\n\nLuckily the organization had Antigena Network installed in active mode. The C2\ncommunications from infected devices were blocked seconds after the initial connection,\npreventing further C2 activity and the download of any additional malware. Using information\nsurfaced by the Cyber AI Analyst, the security team could catch up and the threat was\nquickly contained.\n\nThis attack highlights the continuously evolving approaches used by malicious actors to\nevade detection. In the same week as the events explained above, Darktrace identified the\nUrnsnif malware in numerous other customers in the US and Italy, across multiple industries.\nAttackers are targeting businesses indiscriminately and are not slowing down.\n\nThanks to Darktrace analysts Grace Carballo and Hiromi Watanabe for their insights on the\nabove threat find.\n\nTo learn how cyber-criminals are using AI to augment their attacks, download the White\nPaper: [The Battle of the Algorithms](http://10.10.0.46/the-machine-fights-back)\n\n## Technical details\n\n**IoCs:**\n\nIoC Comment\n\ntobmojiol2adf[.]com C2 domain, registered July 9\n\nqumogtromb2a[.]com Not yet registered\n\namehota2gfgh[.]com C2 domain, registered July 8\n\ngofast22gfor[.]com C2 domain, registered July 8\n\n\n-----\n\nxquptbabzxhxw[.]com Not yet registered\n\ne9bja[.]com Masqueraded file download source\n\n9ygw2[.]com Masqueraded file download source\n\nn2f79[.]com Masqueraded file download source\n\nioyyf[.]com Masqueraded file download source\n\nhq3ll[.]com Masqueraded file download source\n\nhxxp://9ygw2[.]com/iz5/yaca.php?l=kpt1.cab File path\n\nhxxp://e9bja[.]com/iz5/yaca.php?l=kpt4.cab File path\n\nhxxp://n2f79[.]com/iz5/yaca.php?l=kpt1.cab File path\n\nhxxp://ioyyf[.]com/iz5/yaca.php?l=kpt4.cab File path\n\nhxxp://hq3ll[.]com/iz5/yaca.php?l=kpt12.cab File path\n\n**MD5 hashes**\n\nfa6fc057b3c1bb1e84cc37dbd14e7c10\n37c28815f462115ff1439e251324ed5b\n40f69d093a720c338963bebb3e274593\n5602508f262b92f25dc36c4266f410b4\n619e5f5d56de5dfbe7b76bba924fd631\n30ea60c337c5667be79539f26b613449\n688380643b0d70a0191b7fbbea6fb313\n719f36d41379574569248e599767937f\n7a7ba75af1210e707c495990e678f83e\n7c4207591c6d07ce1c611a8bc4b61898\n8eec0a8518e87d7248d2882c6f05a551\n94915a540ce01fabec9ba1e7913837ea\n94e6d6c3cef950ed75b82428475681c7\nbac0246599a070c8078a966d11f7089d\ndc17489e558d0f07b016636bc0ab0dbe\ndff18317acadc40e68f76d3b33ea4304\ncee72b840f4e79ed5ffde7adc680a7cd\n\n**SHA1 hashes**\n\n42dd5e8ad3f0d4de95eaa46eef606e24f3d253f0\n97d2158a44b0eaa2465f3062413427e33cc2ac50\n435c5ae175b40e5d64907bdb212290af607232eb\n\n\n-----\n\n4b9845e5e7475156efa468a4e58c3c72cf0d4e7e\na0494bf812cf1a5b075109fea1adc0d8d1f236f9\n297b1b5137249a74322330e80d478e68e70add0d\n46a9c4679169d46563cdebae1d38e4a14ed255c9\n4f4f65acf3a35da9b8da460cf7910cd883fe2e46\n60aee8045e0eb357b88db19775c0892f6bd388f1\n7d92dad4971d3c2abfc368a8f47049032ef4d8a9\n9631216035a58d1c3d4404607bd85bf0c80ccfe8\naab6a948d500de30b6b75a928f43891f5daaa2a8\nc31dcf7bc391780ecf1403d504af5e844821e9a4\nc41a9a7f416569a7f412d1a82a78f7977395ce2a\nc7323a5596be025c693535fbb87b84beeacc7733\nd64a6c135d7eac881db280c4cb04443b7d2e2a0b\n331ede8915e42d273722802a20e8bb9a448b39c5\n\n**Darktrace model breaches**\n\nAnomalous File/Masqueraded File Transfer\nCompromise/ Sustained TCP Beaconing Activity to Rare Endpoint\nCompromise/ HTTP Beaconing to Rare Destination\nCompromise/ Slow Beaconing Activity to External rare\nCompromise/ Beaconing Activity to External Rare\nDevice/ Initial Breach Chain Compromise\n\n## Max Heinemeyer\n\nMax is a cyber security expert with over a decade of experience in the field, specializing in a\nwide range of areas such as Penetration Testing, Red-Teaming, SIEM and SOC consulting\nand hunting Advanced Persistent Threat (APT) groups. At Darktrace, Max oversees global\nthreat hunting efforts, working with strategic customers to investigate and respond to cyberthreats. He works closely with the R&D team at Darktrace’s Cambridge UK headquarters,\nleading research into new AI innovations and their various defensive and offensive\napplications. Max’s insights are regularly featured in international media outlets such as the\nBBC, Forbes and WIRED. When living in Germany, he was an active member of the Chaos\nComputer Club. Max holds an MSc from the University of Duisburg-Essen and a BSc from\nthe Cooperative State University Stuttgart in International Business Information Systems.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-23 - The resurgence of the Ursnif banking trojan.pdf"
    ],
    "report_names": [
        "2020-07-23 - The resurgence of the Ursnif banking trojan.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536092,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1653705309,
    "ts_modification_date": 1653705309,
    "files": {
        "pdf": "https://archive.orkl.eu/a5a7acaaf59afc20bd3f2f692ec7f8ea1fcbcab6.pdf",
        "text": "https://archive.orkl.eu/a5a7acaaf59afc20bd3f2f692ec7f8ea1fcbcab6.txt",
        "img": "https://archive.orkl.eu/a5a7acaaf59afc20bd3f2f692ec7f8ea1fcbcab6.jpg"
    }
}