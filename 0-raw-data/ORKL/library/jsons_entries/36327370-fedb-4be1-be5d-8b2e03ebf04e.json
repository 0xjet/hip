{
    "id": "36327370-fedb-4be1-be5d-8b2e03ebf04e",
    "created_at": "2023-01-12T15:10:34.785652Z",
    "updated_at": "2025-03-27T02:05:54.990691Z",
    "deleted_at": null,
    "sha1_hash": "a12fdd02a8590ca6e5259ad92737b88a89597854",
    "title": "2017-07-19 - The NukeBot banking Trojan- from rough drafts to real threats",
    "authors": "",
    "file_creation_date": "2022-05-29T10:35:06Z",
    "file_modification_date": "2022-05-29T10:35:06Z",
    "file_size": 1416688,
    "plain_text": "# The NukeBot banking Trojan: from rough drafts to real threats\n\n**[securelist.com/the-nukebot-banking-trojan-from-rough-drafts-to-real-threats/78957/](https://securelist.com/the-nukebot-banking-trojan-from-rough-drafts-to-real-threats/78957/)**\n\n[Research](https://securelist.com/category/research/)\n\n[Research](https://securelist.com/category/research/)\n\n19 Jul 2017\n\nminute read\n\nAuthors\n\n[Sergey Yunakovsky](https://securelist.com/author/sergeyyunakovsky/)\n\n\n-----\n\nThis spring, the author of the NukeBot banking Trojan published the source code of his\n[creation. He most probably did so to restore his reputation on a number of hacker forums:](https://krebsonsecurity.com/2017/04/self-proclaimed-nuclear-bot-author-weighs-u-s-job-offer/)\nearlier, he had been promoting his development so aggressively and behaving so erratically\n[that he was eventually suspected of being a scammer. Now, three months after the source](https://krebsonsecurity.com/2017/04/self-proclaimed-nuclear-bot-author-weighs-u-s-job-offer/)\ncode was published, we decided to have a look at what has changed in the banking malware\nlandscape.\n\n## NukeBot in the wild\n\nThe publication of malware source code may be nothing new, but it still attracts attention\nfrom across the IT community and some of that attention usually goes beyond just inspecting\nthe code. The NukeBot case was no exception: we managed to get our hands on a number\nof compiled samples of the Trojan. Most of them were of no interest, as they stated local\nsubnet addresses or ‘localhost/127.0.0.1’ as the C&C address. Far fewer samples had\n‘genuine’ addresses and were ‘operational’. The main functionality of this banking Trojan is to\nmake web injections into specific pages to steal user data, but even from operational servers\nwe only received ‘test’ injections that were included in the source code as examples.\n\nTest injections from the NukeBot source code\n\nThe NukeBot samples that we got hold of can be divided into two main types: one with plain\ntext strings, and the other with encrypted strings. The test samples typically belong to type 1,\nso we didn’t have any problems extracting the C&C addresses and other information\nrequired for analysis from the Trojan body. It was a bit more complicated with the encrypted\nversions – the encryption keys had to be extracted first and only after that could the string\nvalues be established. Naturally, all the above was done automatically, using scripts we had\ndeveloped. The data itself is concentrated in the Trojan’s one and only procedure that is\ncalled at the very beginning of execution.\n\n\n-----\n\nA comparison of the string initialization procedure in plain text and with encryption.\n\nDecryption (function sub_4049F6 in the screenshot) is performed using XOR with a key.\n\nImplementation of string decryption in Python\n\nIn order to trigger web injections, we had to imitate interaction with C&C servers. The C&C\naddresses can be obtained from the string initialization procedure.\n\nWhen first contacting a C&C, the bot is sent an RC4 key which it uses to decrypt injections.\nWe used this simple logic when implementing an imitation bot, and managed to collect web\ninjections from a large number of servers.\n\nInitially, the majority of botnets only received test injects that were of no interest to us. Later,\nhowever, we identified a number of NukeBot’s ‘combat versions’. Based on an analysis of the\ninjections we obtained, we presume the cybercriminals’ main targets were French and US\nbanks.\n\n\n-----\n\nExample of ‘combat-grade’ web injections\n\nOf all the Trojan samples we obtained, 2-5% were ‘combat-grade’. However, it is still unclear\nif these versions were created by a few motivated cybercriminals and the use of NukeBot will\ntaper off soon, or if the source code has fallen into the hands of an organized group (or\ngroups) and the number of combat-grade samples is set to grow. We will continue to monitor\nthe situation.\n\nWe also managed to detect several NukeBot modifications that didn’t have web injection\nfunctionality, and were designed to steal mail client and browser passwords. We received\nthose samples exclusively within droppers: after unpacking, they downloaded the required\nutilities (such as ‘Email Password Recovery’) from a remote malicious server.\n\nKaspersky Lab products detect the banking Trojans of the NukeBot family as TrojanBanker.Win32.TinyNuke. Droppers containing this banking Trojan were assigned the verdict\nTrojan-PSW.Win32.TinyNuke.\n\n## MD5\n\n626438C88642AFB21D2C3466B30F2312\n\n697A7037D30D8412DF6A796A3297F37E\n\n031A8139F1E0F8802FF55BACE423284F\n\n93B14905D3B8FE67C2D552A85F06DEC9\n\nA06A16BD77A0FCB95C2C4321BE0D2B26\n\n0633024162D9096794324094935C62C0\n\n9E469E1ADF9AAE06BAE6017A392B4AA9\n\n078AA893C6963AAC76B63018EE4ECBD3\n\n44230DB078D5F1AEB7AD844590DDC13E\n\nFAF24FC768C43B95C744DDE551D1E191\n\n8EBEC2892D033DA58A8082C0C949C718\n\n6DC91FC2157A9504ABB883110AF90CC9\n\n36EB9BDEFB3899531BA49DB65CE9894D\n\nD2F56D6132F4B6CA38B906DACBC28AC7\n\n79E6F689EECB8208869D37EA3AF8A7CA\n\n9831B1092D9ACAEB30351E1DB30E8521\n\n\n-----\n\n[Financial malware](https://securelist.com/tag/financial-malware/)\n[Trojan Banker](https://securelist.com/tag/trojan-banker/)\n\nAuthors\n\n[Sergey Yunakovsky](https://securelist.com/author/sergeyyunakovsky/)\n\nThe NukeBot banking Trojan: from rough drafts to real threats\n\nYour email address will not be published. Required fields are marked *\n\nGReAT webinars\n\n13 May 2021, 1:00pm\n\n### GReAT Ideas. Balalaika Edition\n\n26 Feb 2021, 12:00pm\n17 Jun 2020, 1:00pm\n26 Aug 2020, 2:00pm\nFrom the same authors\n\n\n-----\n\n### Denis and Co.\n\n Tales from the blockchain\n\n Jimmy Nukebot: from Neutrino with love\n\n\n-----\n\n### CowerSnail, from the creators of SambaCry\n\n The Magala Trojan Clicker: A Hidden Advertising Threat\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-19 - The NukeBot banking Trojan- from rough drafts to real threats.pdf"
    ],
    "report_names": [
        "2017-07-19 - The NukeBot banking Trojan- from rough drafts to real threats.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536234,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1653820506,
    "ts_modification_date": 1653820506,
    "files": {
        "pdf": "https://archive.orkl.eu/a12fdd02a8590ca6e5259ad92737b88a89597854.pdf",
        "text": "https://archive.orkl.eu/a12fdd02a8590ca6e5259ad92737b88a89597854.txt",
        "img": "https://archive.orkl.eu/a12fdd02a8590ca6e5259ad92737b88a89597854.jpg"
    }
}