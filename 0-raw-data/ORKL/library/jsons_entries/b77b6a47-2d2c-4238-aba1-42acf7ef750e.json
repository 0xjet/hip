{
    "id": "b77b6a47-2d2c-4238-aba1-42acf7ef750e",
    "created_at": "2022-10-25T16:48:22.345035Z",
    "updated_at": "2025-03-27T02:16:59.214013Z",
    "deleted_at": null,
    "sha1_hash": "de7afe34e66763af6e1b2ca7f77fbe46f33cd235",
    "title": "MacProStorage02:_2019CLF:Bitdefender-Whitepaper-Hard-creat3095-A4-v2-en_EN:Bitdefender-Whitepaper-Hard-creat3095-A4-v2-en_EN.indd",
    "authors": "",
    "file_creation_date": "2019-06-25T10:50:54Z",
    "file_modification_date": "2019-06-25T10:50:59Z",
    "file_size": 2994874,
    "plain_text": "# Scranos Revisited – Rethinking persistence to keep established network alive\n\n\n-----\n\nWhite Paper\n\nAuthors:\n\nAndrei Raul ARDELEAN - Security Researcher, Cyber Threat Intelligence Lab\n\nClaudiu Ștefan COBLIȘ - Security Researcher, Cyber Threat Intelligence Lab\n\nCristofor OCHINCA - Security Researcher, Cyber Threat Intelligence Lab\n\n\n-----\n\nWhite Paper\n\n## Executive Summary\n\nIn April, Bitdefender broke the news of an emerging botnet dubbed Scranos. Originating from China, it has spread across Europe\nand the United States, snaring Windows and Android devices with advertising fraud and social network manipulation.\n\nOur original report shone a spotlight on Scranos operators and exposed their illicit use of Authenticode certificates, and other\nactions. After Bitdefender reached out to Digicert to report the certificate used to sign the rootkit driver for malicious use, the\nScranos operators lost their main mechanism to ensure persistence and disguise. When the the Scranos report was published,\nattackers saw their command and control infrastructure get flagged for malicious activity and shut down.\n\nWe kept an eye on the developments in the weeks after the publication and documented how the operators tried to rebuild the\nbotnet and restore functionality. This led us to identify new components used to generate ad revenue in the background by visiting\narbitrary URLs with Google Chrome and to disguise these ads as notifications, generating additional ad revenue at the user’s\nexpense.\n\nThis report, which updates our original research, includes:\n\n    - An overview of how the cybercrime group compensates for the loss of the stolen digital signing certificate by using\nanother persistence method based on DLL hijacking of legitimate Microsoft executables.\n\n    - A detailed account of how attackers are rebuilding the command and control infrastructure, and information about the\ndomain generation algorithm in the new samples.\n\n    - New functionality to replace hosts file - attackers can redirect any website to their own or restrict access to some domains\naltogether.\n\n    - New payload used to generate ad revenue by visiting arbitrary URLs.\n\n    - New script injected in visited pages for displaying ads and redirecting web searches.\n\n    - Facebook data stealing payload still widely used.\n\n    - A fake application developed by the attackers to disseminate the Scranos malware to new users.\n\n    - Trojan pushed by Scranos capable of distributed denial of service (DDoS) attacks and disabling the Windows security\nservices.\n\n    - Trojan pushed by Scranos which turns the device into a cryptocurrency miner.\n\n\n-----\n\nWhite Paper\n\n## Chapter 1: Recovering after disruption\n\nAfter the publication of our original report on Scranos, operators started losing both infrastructure as it got blacklisted, and the\npersistence mechanisms used by the rootkit component. Despite these major roadblocks, the Scranos gang scrambled to maintain\nthe botnet afloat by pushing updated samples with new command and control centers. They also amended the domain name\ngeneration algorithm to provide names that break the predictable patterns of the previous version.\n\nIn addition to re-designing the command and control infrastructure, the Scranos team changed the way they initially compromise\nvictims. While the previous campaigns used fake applications and cracks for third-party programs, developers have created their\nown application to bundle the new strain. The new application, complete with a new graphical user interface, is called CClear and is\nadvertised as a system optimization tool, even though it has no such functionality.\n\nThis malware distribution technique seems interesting, given that the authors took the time to develop a fake application that is\ndangerously similar to CCleaner, a legitimate system optimization application widely known among computer users. This was\nprobably strategically thought out so users would have fewer reasons to suspect something was not quite right with the application.\n\nThe new Scranos strains also feature the ability to replace the hosts file with an arbitrary one. A hosts file is an operating system\nfile that maps hostnames to IP addresses. It is currently used mostly by developers to locally define domains in a LAN for various\npurposes, such as accessing the company’s internal resources or to preview local websites in development. However, rogue\nmanipulation of the hosts file leads to redirecting any website a user visits to an attacker-controlled website or to blocking certain\ndomains altogether. We also identified new JS scripts that are injected on every page the user visits with the help of the malicious\nbrowser extension. The new scripts not only display ads to the user but can also redirect web searches through another search\nengine at the attacker’s choice.\n\nIn addition to these changes, we noticed the emergence of a new Trojan being pushed across the existing botnet. The Trojan in\nquestion is Yoddos, a piece of malware that dates back to 2012. Its proliferation was somewhat contained until recently, when\nScranos activity contributed to a surge of Yoddos infections. Even though this Trojan has DDoS (Distributed Denial of Service)\ncapabilities, its operators apparently don’t use it yet.\n\nDuring our investigation, Yoddos was used to distribute cryptocurrency miners which abused the user’s computing resources\nto mine Monero (XMR). This further slows down the performance of the victim computer and significantly increases the user’s\nelectricity bill.\n\nMining operations seem to be restricted on systems with the system language set to simplified Chinese, as the attackers probably\ndid not want to ring any alarm bells in their home country. The cryptocurrency miner distributed by Yoddos disables security\nservices from Microsoft, such as Windows Firewall and Windows Defender. It also restricts access to a list of Monero (XMR) mining\npools in an attempt to remove any competition from a different miner on the same machine. It’s also interesting to note that the\nmining process is suspended if Task Manager is running. This is done so users don’t see the mining process consuming a lot of\nresources when checking Task Manager, leaving them fewer reasons to suspect that the mining process is to blame for any drop\nin the computer’s performance.\n\n\n-----\n\nWhite Paper\n\n\nFig. 1: Spike in Yoddos detections caused by Scranos\n\nFig. 2: Scranos distribution by Windows version\n\nFig. 3: Scranos distribution by country\n\n\n-----\n\nWhite Paper\n\n## Chapter 2: Attack Overview\n\nThis chapter presents a brief overview of every payload related to the Scranos attack. Payloads that have been tackled in our first\n[piece of research and have remained unchanged will not be described again. Please refer to our previous report for a complete list](https://download.bitdefender.com/resources/files/News/CaseStudies/study/253/Bitdefender-Whitepaper-RootKit-CREAT3432-en-EN.pdf)\nof payloads.\n\n### Dropper\n\nNew infections are usually caused by fake software that pose as utilities (e.g. make your computer run faster), as well as by cracked\nsoftware or even legitimate repackaged software bundled with the dropper. The dropper acts again as a password stealer, and can\nreplace your hosts file to redirect visited websites to attacker controlled domains. It installs Google Chrome and/or Mozilla Firefox\nif not already installed; other payloads use them to generate traffic to arbitrary domains.\n\nA service running at start-up is registered with a legitimate Microsoft executable vulnerable to DLL hijacking. This service is used\nfor persistence and acts as a downloader for further payloads. A simplified diagram of the infection process can be seen below.\n\nFig. 4: Infection process at a glance\n\n1. The dropper contacts the C&C server with information about the infected machine.\n\n2. The dropper replaces the hosts file with a file downloaded from the C&C.\n\n3. The dropper steals cookies, login credentials, payment information and Facebook-related information (such as number of\nfriends). The date gathered is sent to the C&C.\n\n4. The dropper downloads and installs legitimate copies of Google Chrome and/or Firefox if they aren’t already installed.\nInterestingly, it uses a download manager popular in China, called Xunlei Mini Thunder, to download the installers of Chrome\nand Firefox.\n\n5. A legitimate Microsoft executable and a carefully crafted malicious DLL are placed in the same folder. A new service that runs\nat start-up is created with the legitimate executable. This action ensures persistence after reboot.\n\n6. The fake program is installed at the same time and a shortcut to it is created on the Desktop. Users are less likely to become\n\n\n-----\n\nWhite Paper\n\n7. The registered service is vulnerable to a DLL hijack, and the malicious DLL is loaded into the process by the legitimate\nexecutable. This DLL takes over the original executable.\n\n8. The actual downloader is injected in a newly created rundll32.exe process.\n\n9. The downloader sends information about the system to the C&C and receives download links.\n\n10. Additional payloads are downloaded and executed.\n\n### Traffic Generator Payload\n\nThis payload is used to generate traffic to URLs received from the C&C. The URLs point to advertisements that generate revenue\nfor the attacker.\n\n1. The payload contacts the C&C and expects a list of URLs.\n\n2. A new hidden Chrome instance is started with a command that opens a new tab for each URL received in the previous step.\n\n3. The URLs are visited, with each URL in a new tab. Notifications are enabled for every domain visited. This leads to further\nadvertisements appearing as notifications from some domains.\n\n### The Yoddos Trojan\n\nThis Trojan acts as a remote backdoor that can be used to conduct a DDoS attack. It can download and execute arbitrary payloads.\nWe observed only one payload being downloaded during our investigation, namely a Monero (XMR) cryptocurrency miner. For\nsimplicity, we describe the entire process, including the mining payload in the diagram below:\n\n\n-----\n\nWhite Paper\n\n2. The C&C server is contacted and the Trojan stands by for further instructions.\n\n3. A DDoS attack against an IP address or domain is performed if DDoS instructions are received from the C&C server.\n\n4. An arbitrary payload is downloaded and run if specified by the C&C server. Additional steps describe the dcleard payload, the\nonly payload we observed in our investigation.\n\n5. The payload disables the Yoddos service. It does this to minimize the chance of getting discovered while mining is performed.\n\n6. Another executable is downloaded and executed – abchost.exe. This action is only taken if the default language on the system\nis not simplified Chinese.\n\n7. Windows Firewall and Windows Defender are disabled so they don’t interfere with the mining operation.\n\n8. Three other executables are downloaded, and one of them is also executed with a specific command line.\n\n9. TASKH0ST.EXE is actually a legitimate version of NSSM (the Non-Sucking Service Manager) which is used to register CONH0ST.\nEXE as a service which runs at startup.\n\n10. CONH0ST.EXE starts an instance of PREVH0ST.EXE.\n\n11. Other cryptocurrency miners are blocked by redirecting their domain name to 127.0.0.1 in the hosts file.\n\n12. PREVH0ST.EXE acts as a watchdog for the miner; it also suspends the mining process when users are checking Task Manager.\n\n13. CONH0ST.EXE connects to a mining pool and mines Monero (XMR). It uses a slightly modified version of an open source miner,\n\nXMRig, to perform the actual mining.\n\n### Dropper\n\nFollowing the revocation of the compromised certificate described in our original paper, the cyber-criminal team behind Scranos had\nto adapt to losing their harder-to-detect rootkit persistence mechanism. They adopted a new method, which is not as inconspicuous\nas a rootkit but is still better than simply setting a RUN Registry key.\n\nTo achieve persistence, they now drop a legitimate Microsoft executable in the %TEMP% folder and register it as a start-up service.\nThe catch is that a DLL hijack takes place by copying a specially crafted DLL in the same folder. The DLL is loaded by the legitimate\nexecutable, achieving persistence without raising much suspicion to the untrained eye, given that the service points to a legitimate\nMicrosoft executable.\n\nWe found the attackers using legitimate copies of rc.exe (Microsoft Resource Compiler) and symstore.exe (Symbol Server Builder)\nthat load a hijacked rcdll.dll and symsrv.dll, respectively.\n\nWhile the droppers in our original analysis did not attempt to show anything to the user once the malicious application was run, this\nupdate includes a dropper that masquerades as a utility program that cleans up unwanted or temporary files.\n\nThe dropper is packed with the typical Scranos packer described in our previous work, which decrypts and loads a DLL included in\nthe executable, then calls a function named WorkIn from the loaded DLL.\n\nInside a 7z archive, it also contains another embedded DLL, named WorkKernel.dll by the authors. This DLL is injected in several\nnewly created instances of rundll32.exe process, each started by the malware with different command line parameters, depending\non what needs to be done.\n\nThe arguments provided can be as follows:\n\n    - **001 :**\n\n##### o It overwrites the hosts file (located at \\Windows\\system32\\drivers\\etc\\hosts) with another file received from http://\n\nhh1m[.]com/hosts. However, during our investigation, the attackers didn’t push a replacement hosts file.\n\n\n-----\n\nWhite Paper\n\n##### o It then steals Facebook data if a Facebook account is logged in on a browser. This is done in the same manner as in\n\nour original paper. Furthermore, the same data is being stolen: user name, password, cookies, payment information,\nnumber of friends, pages administered, Instagram accounts. The data is encoded and sent to a domain with a name\ngenerated from the current date string (e.g. http://v01.<domain_generated>.online/t.php?info=<encoded_stolen_\n_facebook_data>)_\n\n    - **002 :**\n\n##### o Silently downloads and installs Google Chrome in the background from the official Chrome website. We found some\n\nversions that also installed Firefox. Interestingly, it drops and uses a download manager popular in China – Xunlei\nMini Thunder, to download Chrome and Firefox in the background.\n\n##### o Contacts the C&C and waits for a list of files to download and run on the infected computer. It performs this\n\naction in a similar manner to the downloader injected in _svchost.exe_ in our original paper. It generates a domain\nname based on the current date, contacts it with information about the infected machine and awaits a list of\nlinks separated by ‘|’ to files to download, unzip and execute. It even creates the same mutex as the original\ndownloader, exist_sign_sys. Unlike before, it can now execute DLL files as well by injecting them in a newly created\n_rundll32.exe_ process. An example of such a request is http://v01.74AE36124716F613CB65D1C467749689[.]\nonline/sta.php?g=3A430EEC3230366B228A1464E7302A0B2838E213E0D68289A9&o=6&b=\nCHROME&v=9.3&l=p001&i=all&s=E78ACE9BC501C438B2E7D6AF5CA82C36 that is composed from the same fields\nas described in our original paper:\n\n#####  g= a computer id generated from the SID of the current user and the system volume serial number\n\n  o= major version of operating system\n\n  b= default browser on the system\n\n  v= trojan version\n\n  l= value «msver1” from “HKLM\\Software\\Microsoft”, or “all” if no such value exists, this value may be set by\n\nthe dropper\n\n#####  i= value «msver2” from “HKLM\\Software\\Microsoft”, or “all” if no such value exists, this value may be set by\n\nthe dropper\n\n#####  s= redundancy hash of computer id (g parameter) + major version of OS (o parameter) + «xyz»\n\n    - **003 :**\n\n##### o Deploys the persistence mechanism. Since its previous persistence mechanism (in the form of a rootkit) has been\n\ndisabled with the revocation of the compromised certificate used to sign it, the attackers now adopt a DLL hijacking\napproach by dropping and registering a legitimate Microsoft application in the %TEMP% directory and registering it\nas a service. A specially crafted DLL is also dropped in the same directory and a DLL hijacking takes place when the\nservice starts. We found the attackers using legitimate copies of rc.exe (Microsoft Resource Compiler) and symstore.\n_exe (Symbol Server Builder) used to load a hijacked rcdll.dll and symsrv.dll respectively. The services are named “rcdll_\n_service” and “symsrv service” respectively._\n```\n    o\n\n```\n    - **004 :**\n\n##### o Drops and runs the application it masquerades as.\n\n    - **005 <arg>:**\n\n##### o Sends a POST request to http://tk.maidi888[.]com/pixel.php?clid=<arg>. In our case <arg> was used as the file name\n\nof the main dropper. This is probably used as a way for the attackers to monitor which of the programs impersonated\nby Scranos is more successful in infecting users.\n\n    - **006 <arg>:**\n\n##### o Sends a POST request to http://www.hh1m[.]com/test/api.php?info=<arg>. We did not notice this argument being\n\n\n-----\n\nWhite Paper\n\nNote that the algorithm that dynamically generates the domain underwent no significant modifications, other than the fact that the\nhardcoded ‘v01’ subdomain is also used now. An example of a response of files to download and execute is:\n\nhttp://down.klldddiso[.]xyz/dll2/js/wcrx.dll.dat---0|http://down.klldddiso[.]xyz/dll2/web_push.dll.dat---0|http://down.klldddiso[.]xyz/\ndll2/e12fefa8771fb741.exe.dat---0|\n\nThe dropper proceeds to disable Windows Defender Real-Time Protection like reported in our initial research paper, then deletes\nitself. Since the driver is not available to assist with deletion, it deletes itself by using “cmd /c ping 127.0.0.1 -n 1 && del “<own_\n**_filename>”” in a newly created cmd before exiting._**\n\nSome strings used for Facebook data extraction can be seen below:\n\n### Downloader\n\nThe downloader component is now represented by the hijacker DLL used for persistence with a legitimate executable. It’s also\npacked with the typical packer used by Scranos and injects the actual payload in a newly created rundll32.exe. It creates the mutex\n“Global\\exist_sign_r3” and proceeds to download and execute samples from a dynamically generated domain based on the current\ndate. The algorithm used to generate the domain remains largely unchanged from our previous report. The only difference is that\nthe string “can’t load the buf2” is concatenated to the current date instead of “can’t load the buf1” as described previously.\n\nUnlike the downloader embedded in the dropper, which could execute DLLs, this version only knows how to execute EXE files.\n\nAn example of a URL – note that the parameters have the same meaning as described in the Dropper section for\nargument **003:** [http://838F57672A2B2B2C9041131351AB996C[.]online/sta.php?g=3A430EEC3230366B228A146](http://838F57672A2B2B2C9041131351AB996C[.]online/sta.php?g=3A430EEC3230366B228A1464E7302A0B2838E213E0D68289A9&o=6&b=CHROME&v=8.0&l=p001&i=all&s=E78ACE9BC501C438B2E7D6AF5CA82C36)\n[4E7302A0B2838E213E0D68289A9&o=6&b=CHROME&v=8.0&l=p001&i=all&s=E78ACE9BC501C438B2E7D6AF5CA82C36](http://838F57672A2B2B2C9041131351AB996C[.]online/sta.php?g=3A430EEC3230366B228A1464E7302A0B2838E213E0D68289A9&o=6&b=CHROME&v=8.0&l=p001&i=all&s=E78ACE9BC501C438B2E7D6AF5CA82C36) and\nresponse: http://down.klldddiso[.]xyz/dll2/syscheck1.dat---0|\n\n### Extension Installer Payload\n\nThe extension installer payload remains largely unchanged. It now sends the C&C the success status of the operations it attempts\nto perform. Below is an example of such requests from an infection where the Chrome extension was installed. Opera was not\ninstalled on the computer, so the Opera extension was not installed, and the Internet Explorer injector was successfully started:\n\nhttp://info.d3pk[.]com/count/dll/?msg=[WCRX]chrome:complete---opera:no_userdata---ie:complete\n\n### Chrome Extensions\n\nWe found the Chrome Filter extension being pushed again by Scranos. Its functionality remains unchanged from our previous\nreport. However, a very basic obfuscation was performed on the Javascript files of the extension; the strings are now stored in\nreverse and only deobfuscated when needed.\n\nWe managed to recover a version of the script that is dynamically written over the main script of the Chrome Filter extension from\n[http://k1l4.club/down/m_inc[.]js – the analogous domain in our previous report was unresponsive.](http://k1l4.club/down/m_inc%5b.%5djs)\n\nThis new main script injects the same script from s3.amazonaws[.]com/jscriptcdn/1f546f49ebf4153c8a.js into every page visited.\nIt may be worth noting that this new script contains some commented functionality that was active previously: three other injected\nadwarescriptsusedtogeneraterevenue,namelycdncache-a.akamaihd.net/sub/u1384f2/029717d6ed8e6a3193a54ce4a6ed7b09/l.\n\n\n-----\n\nWhite Paper\n\nsearch redirector that redirects all searches performed by the user on popular web search engines to http://goto.maxdealz[.]com/\nv1/hostedsearch (a previous version redirected them to https://searchengage[.]com/results.php). Furthermore, the adf.ly API is\nused to generate additional revenue at the expense of the user by injecting the link converter (cdn.adf.ly/js/link-converter.js) and\nentry (cdn.adf.ly/js/entry.js) scripts to every page, making the user view multiple ads before being able to visit a webpage.\n\n### Traffic Generator Payload\n\nThis payload is used to visit arbitrary URLs to generate traffic and income for the attacker. It uses an already installed Google\nChrome from the infected machine to generate traffic in the background.\n\nIt deletes Chrome’s preferences and creates a copy of the chrome.exe executable in the same directory with a name generated\nfrom the current date. This copy is used to visit URLs in the background. The URLs to be visited are received from the C&C at\nhttp://15s0[.].com/webpush/index.php as a list of URLs separated by ‘|’. For example, during our experiments the C&C returned:\n\nhttps://mb-npltfpro[.]com/?a=60811&c=191434|\nhttps://mb-npltfpro[.]com/?a=60811&c=179143|\nhttps://mb-npltfpro[.]com/?a=60811&c=185267|\nhttps://mb-npltfpro[.]com/?a=60811&c=188177|\nhttps://mb-npltfpro[.]com/?a=60811&c=188174|\nhttps://mb-npltfpro[.]com/?a=60811&c=188175|\nhttps://mb-npltfpro[.]com/?a=60811&c=188176|\nhttps://securecloud-smart[.]com/?a=60811&c=122225|\n```\nhttps://mb-npltfpro[.]com/?a=60811&c=191419|\n\n```\nAll of the above URLs redirect to advertisements. The traffic generator payload uses the following command line to open Chrome:\n\n##### “<path_to_chrome_copy>” --user-data-dir=”%TEMP%/temp_159” --disable-popup-blocking --disable-gpu --disable-software-rasterize --safebrowsing-disable-auto-update --window- position=0,-2000 “data:text/html,<html><title>chrome</title><body><script>generated_\n```\nscript</script></body></html>”\n\n Where generated script is a concatenation of window.open(‘<URL_to_visit >›, ‹_blank›,\n‹width=300,height=300›);\n\n```\nfor all URLs received from the C&C.\n\nOne of the visited websites, with the window made visible, can be seen below:\n\n\n-----\n\nWhite Paper\n\nAfter the URL is opened, the program can simulate that a TAB, followed by a short pause, and a RETURN is pressed in the hidden\nChrome window. This has the effect of clicking Allow on the Chrome pop-up, which asks for permission for the website to show\nnotifications. This leads in some cases to intrusive advertisements appearing on the screen as notifications.\n\n\n-----\n\nWhite Paper\n\n### Fake Program\n\nOne of the programs Scranos mimics appears to be written by the same authors as the actual payloads of Scranos. This program\nis advertised as a utility program that cleans your computer, but it never even attempts to perform such an action. It only displays a\nmessage that makes the user believe the program is running and, after a short time, it displays another message that the cleaning\nprocedure is complete in an attempt to fool the user.\n\nThe program comes with a graphical user interface, and creates a desktop icon and registers an uninstall path in the registry at\n**HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\quick_cleaner, it also creates a desktop icon for itself. All of this**\nis done in attempt to seem as legitimate as possible and not arouse any suspicion that it is actually malicious to the user. The simple\ngraphical user interface is illustrated below.\n\n### Other payloads\n\nDuring our analysis, we found samples of Trojan.Yoddos being pushed as a payload of Scranos. This Trojan is a backdoor with DDoS\n(Distributed Denial of Service) capabilities. It has multiple ways of DDoS-ing a domain received from its C&C and can also download\nand install arbitrary executables.\n\nYoddos is not a new Trojan, with samples dating to as far back as 2012. Its spread was rather limited until April 2019 when a surge\nin Yoddos detections was triggered because of Scranos.\n\nThe C&C used by the samples in this attack is a1.dslllllnssss[.]club:55443. During our analysis of the attack, the DDoS capabilities\n\n\n-----\n\nWhite Paper\n\nthe attackers behind Scranos also control the Yoddos samples pushed in the attack. The most likely scenario is that another actor\nis using the already established botnet to infect people in exchange for monetary gains. However, a brief description of the observed\nactions of Yoddos is offered below.\n\nThe actions taken by Yoddos do not target Chinese users. Multiple possible reasons exist for this: either the people behind Yoddos are\nChinese and try to spare their fellow citizens and avoid attracting the attention of Chinese authorities, or the authors of Scranos (who\nare Chinese) have imposed this restriction in distributing third-party malware.\n\nYoddos copies itself in the Windows directory and registers itself as a service. In our case, the service name was _vmvsss and its_\ndescription _VMware Snapshot Provider. The only action observed was that of a file download and execute from_ a1.dslllllnssss[.]\nclub:53888/dcleard.exe. This executable will actually disable the Yoddos service, removing the infection. However, it proceeds to\ndownload and execute another file from http://abc.aaaaabbbbbcccccddddd[.]net:54321/abchost.exe if the default system language\nis not simplified Chinese.\n\nThe new file disables the _SharedAccess,_ _MpsSvc and_ _WinDefend services. These are security services that may interfere with the_\nattack (Windows Firewall and Windows Defender). Afterwards, it downloads and executes three other files, depending on the operating\nsystem version and architecture. A set of files will be downloaded for Windows versions before Windows Vista, and other files will be\ndownloaded for x64-bit and 32-bit versions of Windows. However, they serve the same purpose – installing and hiding a Monero (XMR)\n[mining program – a slightly modified version of the open source XMRig. All three executables are heavily obfuscated through the use](https://github.com/xmrig/xmrig)\nof different packers.\n\nThe three executables are downloaded to C:\\Windows\\Fonts\\xxx and are described below:\n\n    - CONH0ST.EXE – The modified XMRig miner user to mine Monero (XMR) on a mining pool.\n\n    - [TASKH0ST.EXE – A version of the Non-Sucking Service Manager (NSSM) used to easily install CONH0ST.EXE as a service.](https://nssm.cc/)\n\n    - PREVH0ST.EXE – Started by CONH0ST.EXE as a watchdog. Used to modify the hosts file to redirect popular mining pools to\nlocalhost, preventing other miners on the infected machine from consuming resources. It also hides the activity of the miner\nby suspending the CONH0ST mining process when a Task Manager instance is running. This prevents the user from seeing\nhow much CPU the mining process is consuming by checking Task Manager.\n\nOne of the NSSM executables used in the attack was infected with the Virut virus. The Virut virus is a well-known malware botnet\nwhose domains were largely sinkholed in coordinated actions in 2013. Lately, some recovery in Virut attacks has been observed,\nwith multiple samples resurfacing with new C&Cs. It’s unclear whether the Virut infection is a mistake on the attackers’ part, with the\n[attacker being infected as well, or whether it is intentional. We refer to this type of hybrid as “Frankenmalware,” a term we coined back](https://hotforsecurity.bitdefender.com/blog/virus-infects-worm-by-mistake-1246.html)\nin the heyday of file infectors.\n\nThe following domains are used as mining pools:\n\n    - _xxxxx.ririririririririririririririririririri[.]com_\n\n    - _xxxxxx.ririririririririririririririririririri[.]com_\n\n    - _xxxxx.caocaocaocaocaocaocaocaocao[.]com_\n\n    - _xxxxx.nainainainainainainainainainainai[.]com_\n\n    - _xxxxx.gangangangangangangangangangangan[.]com_\n\n    - _xxxxx.weoqieqwuishdwuygqw[.]com_\n\nMining revenue is generated to the following Monero addresses:\n\n    - 43vDmCSyoh4LbHEkUaw1bAUPNq83rQwvyDciYb9Xxj5U5gKni2CRM8TchwHqDDTAz8hT8fkBjhbQJTZ6n41yDo3R6vaV7rz\n\n    - 42PYhxuHuGYQR29JYvJcU7goe5swhiWVL7zpiaZhYTnUFGEdd8LYpc4UkKrQZ6f5r4jPfAL9xexQcUJoV3LenUvgGC1wiN3\n\n    - 422re3xn7ZaPkBurFLZJmcZNXtMN9nFymcDB62QpzD7DSgkeALvi2AjYTfQwWjy6jKjSjy5c3mZJSXFegrLudyJ283RZMGj\n\n    - 49CL1Wcve6LZK1ni4RowwAFXBCKoHTsGv8yrcb9i57q4GuUP2mfQA68Ek16hP86hP9JrEFL2peYqeghn2YCzQ7LqU4uBeeo\n\n45pcPkiuSq1Aj2CTSqDQEv329hXTG4iqHakUWjKMuyXXM5UjtHdgpAx1RxYHENQyi46t4DMr8c97PXztdPPFQ6mQUpU3cTN\n\n\n-----\n\nWhite Paper\n\n## Chapter 3 – Indicators of Compromise\n\n### Domains\n\n#### Scranos\n\n    - _tk.maidi888[.]com_\n\n    - _hh1m[.]com_\n\n    - _15s0[.]com_\n\n    - _down.klldddiso.xyz_\n\n    - _info.d3pk[.]com_\n\n    - _k1l4[.]club_\n\n    - _v01.74AE36124716F613CB65D1C467749689.online_\n\n    - _v01.586B50FC7C8C0677239599562BBF4FEE.online_\n\n    - _v01.26119DAC2973F3B9BE66CEEA938DAEAE.online_\n\n    - _838F57672A2B2B2C9041131351AB996C.online_\n\n    - _C44E9AC1C39D6F01509088DEF3046C15.online_\n\n    - _2D945B616D6FA1E537234277FB7395D8.online_\n\n#### Yoddos\n\n    - _a1.dslllllnssss[.]club_\n\n    - _abc.aaaaabbbbbcccccddddd[.]net_\n\n    - _xx1.aaaaabbbbbcccccddddd[.]net_\n\n    - _xx2.aaaaabbbbbcccccddddd[.]net_\n\n    - _xx3.aaaaabbbbbcccccddddd[.]net_\n\n    - _xx4.aaaaabbbbbcccccddddd[.]net_\n\n    - _xx5.aaaaabbbbbcccccddddd[.]net_\n\n    - _xx6.aaaaabbbbbcccccddddd[.]net_\n\n    - _xxxxx.ririririririririririririririririririri[.]com_\n\n    - _xxxxxx.ririririririririririririririririririri[.]com_\n\n    - _xxxxx.caocaocaocaocaocaocaocaocao[.]com_\n\n    - _xxxxx.nainainainainainainainainainainai[.]com_\n\n    - _xxxxx.gangangangangangangangangangangan[.]com_\n\n    - _xxxxx.weoqieqwuishdwuygqw[.]com_\n\n\n-----\n\nWhite Paper\n\n### URLs\n\n#### Scranos\n\n    - http://tk.maidi888[.]com/pixel.php?clid=\n\n    - http://www.hh1m[.]com/test/api.php?info=\n\n    - http://hh1m[.]com/hosts\n\n    - http://15s0[.]com/webpush/index.php\n\n    - http://k1l4[.]club/down/m_inc.js\n\n    - http://info.d3pk[.]com/count/dll/?msg=\n\n    - http://info.d3pk[.]com/count/webpush?msg=\n\n    - http://down.klldddiso[.]xyz/dll2/js/wcrx.dll.dat\n\n    - http://down.klldddiso[.]xyz/dll2/web_push.dll.dat\n\n    - http://down.klldddiso[.]xyz/dll2/e12fefa8771fb741.exe.dat\n\n    - http://down.klldddiso[.]xyz/dll2/syscheck1.dat\n\n    - http://838F57672A2B2B2C9041131351AB996C[.]online/sta.php\n\n    - http://C44E9AC1C39D6F01509088DEF3046C15[.]online/sta.php\n\n    - http://2D945B616D6FA1E537234277FB7395D8[.]online/sta.php\n\n    - http://v01.74AE36124716F613CB65D1C467749689[.]online/t.php?info=\n\n    - http://v01.74AE36124716F613CB65D1C467749689[.]online/sta.php\n\n    - http://v01.586B50FC7C8C0677239599562BBF4FEE[.]online/t.php?info=\n\n    - http://v01.586B50FC7C8C0677239599562BBF4FEE[.]online/sta.php\n\n    - http://v01.26119DAC2973F3B9BE66CEEA938DAEAE[.]online/t.php?info=\n\n    - http://v01.26119DAC2973F3B9BE66CEEA938DAEAE[.]online/sta.php\n\n    - https://s3.amazonaws[.]com/jscriptcdn/1f546f49ebf4153c8a.js\n\n    - https://cdncache-a.akamaihd[.]net/sub/u1384f2/029717d6ed8e6a3193a54ce4a6ed7b09/l.js?pid=2733&ext=plug_js\n\n    - https://bounce-w[.]top/v/216948.js?j=1221\n\n    - https://s3.amazonaws[.]com/velv1/mnt.js\n\n#### Yoddos\n\n    - http://a1.dslllllnssss[.]club:55443\n\n    - http://abc.aaaaabbbbbcccccddddd[.]net:54321/abchost.exe\n\n    - http://xx1.aaaaabbbbbcccccddddd[.]net:54321/wwkk32.txt\n\n    - http://xx2.aaaaabbbbbcccccddddd[.]net:54321/wwkk732.txt\n\n    - http://xx3.aaaaabbbbbcccccddddd[.]net:54321/wwkk764.txt\n\n    - http://xx4.aaaaabbbbbcccccddddd[.]net:54321/jjkk.txt\n\n    - http://xx5.aaaaabbbbbcccccddddd[.]net:54321/ns32.txt\n\n    - http://xx6.aaaaabbbbbcccccddddd[.]net:54321/ns64.txt\n\n    - http://xxxxx.ririririririririririririririririririri[.]com\n\n    - http://xxxxxx.ririririririririririririririririririri[.]com\n\n   - http://xxxxx caocaocaocaocaocaocaocaocao[ ]com\n\n\n-----\n\nWhite Paper\n\n    - http://xxxxx.gangangangangangangangangangangan[.]com\n\n    - http://xxxxx.weoqieqwuishdwuygqw[.]com\n\n### User-Agents\n\n#### Scranos\n\n    - Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1)\n\n    - Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR\n3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\n\n    - Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\n\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36\n\n    - Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36\n\n    - Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.221 Safari/537.36 SE\n2.X MetaSr 1.0\n\n    - Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0)\n\n#### Yoddos\n\n    - Mozilla/4.0 (compatible)\n\n#### Registry\n\n    - HKCU\\Software\\@demo\n\n    - HKLM\\Software\\Microsoft\\@msver1\n\n    - HKLM\\Software\\Microsoft\\@msver2\n\n    - HKLM\\Software\\Microsoft\\@o2\n\n    - HKLM\\Software\\Microsoft\\@o3\n\n#### Monero addresses\n\n    - 43vDmCSyoh4LbHEkUaw1bAUPNq83rQwvyDciYb9Xxj5U5gKni2CRM8TchwHqDDTAz8hT8fkBjhbQJTZ6n41yDo3R6vaV7rz\n\n    - 42PYhxuHuGYQR29JYvJcU7goe5swhiWVL7zpiaZhYTnUFGEdd8LYpc4UkKrQZ6f5r4jPfAL9xexQcUJoV3LenUvgGC1wiN3\n\n    - 422re3xn7ZaPkBurFLZJmcZNXtMN9nFymcDB62QpzD7DSgkeALvi2AjYTfQwWjy6jKjSjy5c3mZJSXFegrLudyJ283RZMGj\n\n    - 49CL1Wcve6LZK1ni4RowwAFXBCKoHTsGv8yrcb9i57q4GuUP2mfQA68Ek16hP86hP9JrEFL2peYqeghn2YCzQ7LqU4uBeeo\n\n    - 45pcPkiuSq1Aj2CTSqDQEv329hXTG4iqHakUWjKMuyXXM5UjtHdgpAx1RxYHENQyi46t4DMr8c97PXztdPPFQ6mQUpU3cTN\n\n    - 47c9eb5XggFCAxiKRGAkrd8NYojqPvfKGNySuVoT2Gaq5VnqQL5GaLA8jh4FmbscVQfPz1hdf7YetHYebb6NAUpF2HKegvd\n\n### File Hashes\n\n#### dropper\n\n0a17f4b1a8dc5d6e700791624d305d93d3a1d76a\n\n0c792fefe63b1cde3a331fe12da4a2d8eece5ab5\n\n\n-----\n\nWhite Paper\n\n72a15b65857239a33bb8c2049b967cc23daebc4d\n\n8728864801bdffad6269a3faf010d12cacc716b2\n\n9bf6a18c75a941a2052de11a35051aa9e0e50e7c\n\n9ecea6bee3af9e2aee7dcc527eff1603f6ce1496\n\naf08e9325013e7a61d854778c8909a833b49cb0f\n\nafa1847fec29610795ad1a6f19f876d1d9cb50ce\n\nb6215f1362d4136c8c9ad6b398a5c7990f942f56\n\nc000e4b713b16e0fdd58ae36b302f8061af27e90\n\nd6ac635d5e6db4a8a719bea98bdab1db03894c2e\n\nde409f195a0bca55b31477cffffe62fa1a309e51\n\nee9d92d581d62c7f50697ba3a3086241e746bd32\n\n#### fake_program\n\na10f6b2f5ef151b0bc86d9c5eddaa2c46e6b3d3e\n\n#### hijacker_dll\n\n26a00b11677aff3774a108f226c2ad066a53859b\n\n2bb2f8daed1541b387ecdddd0078759379098e47\n\n5f502cec7a29ccfb437c542e9dfdd720292efe5f\n\n9e43a54603f9d175ae7de6b85a5459f57c85ae00\n\nee7afd8698030c64fd382441323f3b5fc69b8a18\n\n#### scripts\n\n3949757f332bc6195d42116e95459aba29bf17d1\n\na69ba4f2f12efc679219ed57d2476a4590d81c17\n\nac7da0a577cb2bd7dd58974f66ade3921ad2630f\n\nd38aaea13d1f47f474d03b2fb366dc55dfcdbcf2\n\nff81018c89e3fc06ad6b76ca10a23f8fde209d69\n\n#### traffic_generator\n\n9455ac911b555002c077d99abc335cc8a4dc2348\n\n#### wcrx\n\n068e4f9288eab755522c7e586da2aee3cef7b197\n\n3786e96dee2261c743e5be9bedc0a7756541415b\n\n\nee19bc8d7ad3906eff05b10335acfcf25efeb5d6\n\n#### workkernel_dll\n\n54ca7887088e46b228a40c3488c78423cb30e600\n\n60b036113d741814559b3b943b6a02435a475646\n\n820ad44ab23c8e42c8110143159cfe2596a24d7f\n\na8e4560be272869a11b4ac06d9b7fb21a0494142\n\ndee530f027dbc63224a3ac90ed61d2c07f4cb7cd\n\nf7eb8c842b0f0b08cf7c82ff624717938c54ef87\n\n#### yoddos\n\n2b8d11e367fb46c042575536b346694751f5c01d\n\nfcaa885c3dd549d443b406ed5055a70af49b76eb\n\n#### yoddos_miner\n\n0e11b85388fa3a333311a832a1517b8058cb9b4c\n\n1c5dda55b4deaff350b0de740cc38487b94f2976\n\n2bd1b092c983351664ccd6ad08f00ba18fdb33f4\n\n2e629596d7d1362579364b5b8aa12d8bf14e4ed7\n\n345d096ed02bff33bd7332f81da2af9ac7e39296\n\n44864f7bee4f73f95b3e15d7ec032d617e178783\n\n47c112c23c7bdf2af24a20bd512f91ff6af76bc6\n\n50919df63a718ff79ba248e8fc773735d214315d\n\n6db9421cd3b410598e763460ed793c303bf469f1\n\n71694cddaca1e34cb4bce62d9956057eecc162fd\n\n720bbb17e4c4d90e7b64972b5c04b3e231fa9d5f\n\n7567c48ef4f2fc8bc74c888c9042296a0f0624b5\n\n7bcea5d87ba7c62e0f26d7e51e5ea0f93c62b50d\n\n8d9694b6c16b579bff14df11445bf2a4e4081cc7\n\n8fc7aba0021652081c754c267cbea29b18ae7dd1\n\n98413b6bd442954becc8931157d1d0a258c7a58f\n\na780c21d12b6d48435455954a92980d3172de6c7\n\nae2a65505ed912619659676579a6ee26a0106610\n\n\n-----\n\nWhite Paper\n\nafab39573cef1e4edb97d110716c3d4da473e06f\n\nb2e9fe3195563fe647234c4f2513fbd11af948e0\n\nb953f4dee2a55d88ec54f7049b074dd30f29ff81\n\nbee878581031d2aeff7eea12ad079ce9ffa988e1\n\nbf6e7f6c88f94502ca6089771d81fac8730af5c5\n\nc21b7ad281472edb748739b15c5fddc0b9d3f612\n\nc6ccbc90520275634ec93ed0d1954b8e3016e30f\n\nd9eac86d503de1b2578fac4b34ba3bcbcde217a9\n\ne3ced5d511e21bfe08c1d249798f19c902cbf7b4\n\nedc77e612cbdb19a424d0514a4abd30802237760\n\nf1cb12ca152e937617d082a85637088b77be7927\n\nf3d9a966d054863d371ceb0ad7402d92e97ddb97\n\nfed4edb5098dd9b00a66b6f87981256715dafd27\n\n\n-----\n\nBitdefender is a global security technology company that delivers solutions in more than 100 countries through a network of\n\nvalue-added alliances, distributors and reseller partners. Since 2001, Bitdefender has consistently produced award-winning\nbusiness and consumer security technology, and is a leading security provider in virtualization and cloud technologies. Through\nR&D, alliances and partnership teams, Bitdefender has elevated the highest standards of security excellence in both its number-\n\none-ranked technology and its strategic alliances with the world’s leading virtualization and cloud technology providers.\n\n[More information is available at http://www.bitdefender.com/.](http://www.bitdefender.com/)\n\nAll Rights Reserved. © 2019 Bitdefender. All trademarks, trade names, and products referenced herein are property of their\n\nrespective owners. FOR MORE INFORMATION VISIT: enterprise.bitdefender.com.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.bitdefender.com/files/News/CaseStudies/study/271/Bitdefender-Whitepaper-Scranos-2.pdf"
    ],
    "report_names": [
        "Bitdefender-Whitepaper-Scranos-2.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1561459854,
    "ts_modification_date": 1561459859,
    "files": {
        "pdf": "https://archive.orkl.eu/de7afe34e66763af6e1b2ca7f77fbe46f33cd235.pdf",
        "text": "https://archive.orkl.eu/de7afe34e66763af6e1b2ca7f77fbe46f33cd235.txt",
        "img": "https://archive.orkl.eu/de7afe34e66763af6e1b2ca7f77fbe46f33cd235.jpg"
    }
}