{
    "id": "d9fae15a-b412-447b-bdb5-623124cbf653",
    "created_at": "2023-01-12T15:03:39.426353Z",
    "updated_at": "2025-03-27T02:05:58.975699Z",
    "deleted_at": null,
    "sha1_hash": "f5e875d29d952139e643d398ec5d6c439dada778",
    "title": "2020-04-08 - Ransomware NetWalker- análisis y medidas preventivas",
    "authors": "",
    "file_creation_date": "2022-05-28T03:11:57Z",
    "file_modification_date": "2022-05-28T03:11:57Z",
    "file_size": 1186382,
    "plain_text": "# Ransomware NetWalker: análisis y medidas preventivas\n\n**[incibe-cert.es/blog/ransomware-netwalker-analisis-y-medidas-preventivas](https://www.incibe-cert.es/blog/ransomware-netwalker-analisis-y-medidas-preventivas)**\n\nApril 8, 2020\n\n\n-----\n\n[Como ya se expuso en otros artículos sobre el ransomware, estos ciberataques han](https://www.incibe-cert.es/blog/sodinokibi-caracteristicas-y-funcionamiento)\nalcanzado el primer puesto en importancia para usuarios y compañías, no tanto por el\nnúmero de ataques en sí (en algunos casos sí pueden resultar masivos), sino por el gran\nbeneficio económico que se obtiene con esta práctica, causando la aparición de muchos\ngrupos especializados en su desarrollo, así como por el daño reputacional que supone para\nla víctima.\n\nEl objetivo de este post es aportar información sobre el ransomware NetWalker, también\ndenominado Mailto o Koko, que se ha utilizado en una reciente campaña de malware\ndistribuida bajo correos electrónicos que simulan aportar información sobre el estado de la\nactual situación de alerta sanitaria generada por el COVID-19.\n\n## Modelo de negocio RaaS\n\nAntes de entrar en detalles técnicos, conviene entender el modelo negocio de los actores\nresponsables de NetWalker. La amenaza comienza a operar en septiembre de 2019, pero\nno es hasta el 19 de marzo de 2020 cuando el usuario con el alias Bugatti abría la\noportunidad a otros cibercriminales de unirse al grupo como parte de un modelo de negocio\nRaaS (Ransomware as a Service):\n\n\n-----\n\n_- Figura 1: Condiciones para unirse a NetWalker. Fuente:_ _[El Mundo -](https://www.elmundo.es/cronica/2020/03/31/5e7e8409fc6c83d7718b46a9.html)_\n\nSu correspondiente traducción al castellano es:\n```\n[SOCIO] Netwalker Ransomware\nAbrimos un conjunto de anuncios para procesar redes y spam.\nInteresados en personas que trabajen por la calidad, no por la cantidad.\nDamos preferencia a aquellos que puedan trabajar con grandes redes y tener su propio\nmaterial.\nReclutamos un número limitado de socios y dejamos de reclutar hasta que queden\nvacantes.\nLe ofrecemos un ransomware rápido y flexible, un panel de administración en TOR y\nservicio automático.\nAcceso al servicio mediante archivos de cifrado desde AV.\nPara anuncios verificados, entregamos material preparado (IP \\ cuenta del dominio\nadmin \\ acceso a NAS \\ información sobre AV \\ nombre de la organización \\ ingresos)\npara el procesamiento de redes.\nEl ransomware ha estado funcionando desde septiembre de 2019 y ha demostrado ser\nbueno, no se puede descifrar.\nRecibirá toda la información detallada sobre el ransomware y las condiciones de\ntrabajo después de compilar la aplicación en el mensaje privado.\nFormulario de solicitud:\n1) ¿En qué dirección estás trabajando?\n2) Experiencia. ¿Con qué programas de afiliación ya trabajó y cuál fue su beneficio?\n3) ¿Cuánto material tiene y cuándo está listo para comenzar, cuánto planea procesar\nel material?\n\n```\n[En un artículo del 18 de marzo en el portal BleepingComputer, se preguntaba a los](https://www.bleepingcomputer.com/news/security/ransomware-gangs-to-stop-attacking-health-orgs-during-pandemic/)\noperadores responsables de NetWalker si atacarían hospitales, y ellos respondieron lo\nsiguiente, dejando claro que no son su objetivo:\n```\n\"Hospitals and medical facilities? Do you think someone has a goal to attack\nhospitals? We don't have that goal - it never was. It coincidence. No one will\npurposefully hack into the hospital.\"\n\n## Análisis de archivos asociados\n\n```\n\n-----\n\nLa muestra de ransomware NetWalker analizada ha sido distribuida utilizando un dropper\ndesarrollado en Visual Basic Script (VBS), que se incluye como fichero adjunto en la\ncampaña de spam. Es un ransomware de cifrado (encrypting ransomware), es decir, impide\nel acceso a los datos del usuario cifrando los archivos del dispositivo, aunque se mantiene el\nacceso al mismo.\n\nEl 18 de marzo de este año se analizó, por primera vez, el archivo CORONAVIRUS_COVID_[19.vbs en la herramienta VirusTotal y, a fecha de 31 de marzo, 32 de los 59 motores](https://www.virustotal.com/gui/file/9f9027b5db5c408ee43ef2a7c7dd1aecbdb244ef6b16d9aafb599e8c40368967/details)_\nantivirus que gestiona VT han clasificado la muestra como maliciosa, tal y como se aprecia\nen la siguiente imagen:\n\n_- Figura 2: Análisis de VirusTotal para CORONAVIRUS_COVID-19.vbs -_\n\nEn la Figura 2, se pueden identificar los distintos códigos hash (MD5, SHA-1 y SHA-256)\nasociados al dropper.\n\nEste archivo dropper contiene, a su vez, un binario embebido, ejecutable para sistemas\nWindows, que tiene varios alias (WTVConverter.exe, qesw.exe y qeSw.exe) y cuyo análisis\n[para VirusTotal puede verse a continuación:](https://www.virustotal.com/gui/file/8639825230d5504fd8126ed55b2d7aeb72944ffe17e762801aab8d4f8f880160/details)\n\n\n-----\n\n_- Figura 3: Análisis de VirusTotal para qeSw.exe -_\n\nLa ejecución del ransomware NetWalker se divide en cuatro fases:\n\n1. El código malicioso importa las funciones de las librerías de Windows que usará\n\ndurante el resto de la ejecución.\n2. El fichero de configuración del ransomware, donde se encuentran diversos parámetros\n\nrelativos al cifrado y rescate, se extrae de los recursos del ejecutable.\n3. Inicialización de variables, tales como el identificador del usuario afectado.\n4. Procedimiento principal donde se llevaría a cabo el proceso de cifrado de archivos.\n\nAntes de proceder al cifrado, se eliminarán las shadow copies (instantáneas de volumen)\nejecutando vssadmin.exe en una ventana oculta, con el objetivo de impedir que se puedan\nrecuperar los ficheros cifrados desde la copia de seguridad generada por el servicio VSS\n(Volume Shadow Copy):\n```\n<SYSTEM32>\\vssadmin.exe delete shadows /all /quiet\n\n```\nEl proceso de cifrado genera un identificador único de 6 caracteres (ID del usuario afectado)\nque utiliza como extensión para los archivos cifrados y como parte del nombre de las notas\nde rescate:\n```\nNombre original: file93.docx\nNombre tras el cifrado: file93.docx.46X19p\nNota de rescate generada en la misma ruta \"46X19p-readme.txt\"\n\n## Instrucciones de rescate\n\n```\n\n-----\n\nCuando un equipo se ve afectado por el ransomware NetWalker, las instrucciones para\ndescifrar los ficheros se muestran a continuación:\n\n_- Figura 4: Nota de rescate de NetWalker. Fuente:_ _[PCrisk -](https://www.pcrisk.es/guias-de-desinfeccion/9587-mailto-ransomware)_\n\nEn esta nota se pide la instalación de Tor Browser, se facilita el sitio web accesible desde la\nred TOR, así como el código personal de la víctima de NetWalker, que debe introducir en la\nsiguiente web:\n\n\n-----\n\n_- Figura 5: Portal de pago accesible desde la red TOR. Fuente:_ _[El Mundo -](https://www.elmundo.es/cronica/2020/03/31/5e7e8409fc6c83d7718b46a9.html)_\n\nUna vez que se ha identificado el usuario, se indica que el precio inicial del rescate\ncomienza en 1.000 dólares, pero que se duplicará esa cantidad de no realizarse el pago\nantes de una semana. La dirección que se proporciona para el pago es única para cada\ninfección.\n\n## Persistencia\n\nAnalizando el modus operandi de NetWalker, y dada la naturaleza de su código, no intenta\nestablecer persistencia en el sistema afectado, tampoco realiza propagación lateral, ni se\naprecia tráfico de red hacia otras máquinas. Además, el ejecutable responsable del cifrado\nse autoelimina tras finalizar su ejecución.\n\n## Recuperación\n\n\n-----\n\nLa primera y principal recomendación que se realiza en los casos de ransomware es no\n**pagar nunca el rescate solicitado por los ciberdelincuentes, ya que esto no garantiza que**\nrespondan una vez se realice el pago, para devolver la normalidad al equipo infectado\nmediante la entrega de la clave de descifrado.\n\nDesafortunadamente, en este momento no se conoce ninguna solución de descifrado de\neste ransomware, por lo que deben considerarse las siguientes medidas de carácter\ngeneral:\n\nAislar el equipo de la red para evitar que el ciberataque se propague a otros\ndispositivos, teniendo en cuenta discos duros, unidades de red o servicios en la nube\nque estuvieran conectados.\nClonar de manera completa el disco duro para conservar el dispositivo original y, de\nesta manera, intentar recuperar los datos sobre el disco clonado. Si no existe solución\nactualmente, como es en el caso de NetWalker, es posible que se desarrolle en el\nfuturo, por lo que se podrían recuperar los ficheros cifrados.\nDesinfectar el disco clonado para intentar recuperar los datos posteriormente,\nutilizando una herramienta adecuada.\nPor último, una vez confirmado que el malware ha sido eliminado del ordenador, se\nrecomienda cambiar todas las contraseñas que se hayan usado en el equipo afectado.\n\n## Medidas preventivas y de protección\n\nDentro de las medidas de prevención a adoptar, es muy importante puntualizar lo siguiente:\n\nNo descargar archivos sospechosos o de un remitente desconocido o no habitual.\nRealizar backups periódicamente para que se puedan restablecer los sistemas\nrápidamente, con la menor pérdida de información y el menor impacto en la operativa\nposibles.\nMejorar la segmentación de la red para evitar una propagación masiva de la amenaza.\nRevisar y reforzar, en caso de que sea necesario, las políticas de seguridad de la\norganización.\n**Nunca se debe pagar el rescate, se debe comunicar el incidente a través del CSIRT**\n(Computer Security Incident Response Team) de referencia.\n\n## Conclusiones\n\nNetWalker es un ransomware relativamente reciente (septiembre 2019) que ha evolucionado\nen los últimos meses, aunque hasta el momento no hay evidencias de víctimas afectadas o\nque sufrieran las consecuencias.\n\n\n-----\n\nTambién cabe destacar que, aunque se ha intentado aprovechar la situación de alarma\ngenerada por el COVID-19, los propios creadores del ransomware han manifestado\nclaramente que los hospitales no son el objetivo.\n\n\n-----",
    "language": "ES",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-08 - Ransomware NetWalker- análisis y medidas preventivas.pdf"
    ],
    "report_names": [
        "2020-04-08 - Ransomware NetWalker- análisis y medidas preventivas.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535819,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1653707517,
    "ts_modification_date": 1653707517,
    "files": {
        "pdf": "https://archive.orkl.eu/f5e875d29d952139e643d398ec5d6c439dada778.pdf",
        "text": "https://archive.orkl.eu/f5e875d29d952139e643d398ec5d6c439dada778.txt",
        "img": "https://archive.orkl.eu/f5e875d29d952139e643d398ec5d6c439dada778.jpg"
    }
}