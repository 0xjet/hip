{
    "id": "37bb0097-72b2-4e9c-a758-0bf2989ce4e9",
    "created_at": "2023-05-06T02:09:20.476124Z",
    "updated_at": "2025-03-27T02:15:26.142339Z",
    "deleted_at": null,
    "sha1_hash": "45419f080de6633fd543ea01d79e0cec8cf3035d",
    "title": "2023-04-13 - Money Ransomware- The Latest Double Extortion Group",
    "authors": "",
    "file_creation_date": "2023-05-05T01:58:40Z",
    "file_modification_date": "2023-05-05T01:58:40Z",
    "file_size": 1194093,
    "plain_text": "# Money Ransomware: The Latest Double Extortion Group\n\n**[yoroi.company/research/money-ransomware-the-latest-double-extortion-group/](https://yoroi.company/research/money-ransomware-the-latest-double-extortion-group/)**\n\nApril 13, 2023\n\n04/13/2023\n\n## Introduction\n\nRansomware attacks have emerged as a predominant menace in recent years, with the\nstrategies employed by malicious actors constantly evolving. Among the most effective and\nworrisome tactics is the \"double extortion\" model, which has rapidly gained popularity as a\npreferred business model for threat actors. Financially motivated perpetrators particularly\nfavor the double extortion model, as it enables them to optimize their profits and bolster the\nlikelihood of victims acquiescing to ransom demands.\n\nIn a double extortion assault, malefactors not only encrypt the targeted party's data but also\nexfiltrate sensitive information from the victim's system prior to encryption. The malicious\nactor subsequently issues a warning to publicize the purloined data unless the ransom is\npaid.\n\nThis deceptively simple yet exceedingly lucrative technique is increasingly being adopted by\ncybercriminals, leading to the emergence of new threats on a daily basis. One such example\nis the Money Ransomware group, which surfaced in March 2023. As of the time of writing,\nthis nascent organization has already claimed two victims.\n\n\n-----\n\n_Figure 1: Leak site_\n\n_Figure 2: Ransom Note Example_\n\n## Technical Analysis\n\nAt the time of writing, we have been unable to completely unravel the infection chain of this\nemerging threat actor, primarily due to the limited number of targets attacked and the lack of\nevidence regarding their modus operandi. However, we do know that they employ a humanoperated intrusion approach, evidenced by the method of data exfiltration and the execution\nof the malware sample.\n\nWe have managed to intercept a sample of the locker used to compromise the Bangladesh\nNational Airport.\n\nHash bbdac308d2b15a4724de7919bf8e9ffa713dea60ae3a482417c44c60012a654b\n\nThreat Money Ransomware\n\n\nBrief\nDescription\n\n\nLocker of Money Ransomware\n\n\nTable 1: File Info\nMoney Ransomware is engineered to accept either no parameters or just one during its\nexecution. If more than one parameter is passed to the program, an error message will be\nlogged. The program can be executed with or without parameters, but if multiple parameters\nare input, a log message will indicate that such execution is unsupported. This behavior\nsuggests that the ransomware may be in the early stages of development.\n\nThe single parameter, if used, designates which drive where the sample will generate the\nRansom Note “money_message.log”.\n\n\n-----\n\n_Figure 3: Execution of the Locker Sample_\nBy performing static analysis, it becomes evident that the code is still in its infancy, as\nnumerous code smells can be found within the binary. One notable example is the\nunobscured configuration data located in the overlay section of the compiled file.\n\n_Figure 4: Configuration stored in clear in the overlay_\nIn the following table we summarize all the parameters in the configuration file:\n\n**Key** **Description**\n\ninfo_text_messag Base64 Encoded Ransom Note\n\nmutex_name String used as Mutex\n\nextensions Extensions to skip\n\nskip_directories Directories to skip\n\n\n-----\n\nnetwork_public_key\n\nnetwork_private_key\n\nprocesses_to_kill Names of processes to kill\n\nservices_to_stop Name of services to stop\n\nlogging Boolean, to print logs\n\ndomain_login List of domain usernames\n\ndomain_password List of domain passwords\n\ncrypt_only_these_directories List of directories to encrypt\n\nTable 2: Description of the Config File\nThe first phase of the execution of the malware is to install a Mutex in order to keep track of\nthe already locked machines. But, if the mutex creation fails, the infection goes on, with the\nrisk to encrypt a second time the machine.\n\nThen, Money Ransomware removes the shadow copies by executing vssadmin, but before\ndoing that, it disables the redirection to WOW64 directory, in order to force the execution of\nthe command from the System32 Directory.\n\nThe next phase of the locking process is to kill the processes which can get an handle to file\nto encrypt.\n\n_Figure 5: Kill Processes routine_\n\n\n-----\n\nThe list of the processes to kill is the following:\n\nsql.exe\noracle.exe\nocssd.exe\ndbsnmp.exe\nsynctime.exe\nagntsvc.exe\nisqlplussvc.exe\nxfssvccon.exe\nmydesktopservice.exe\nocautoupds.exe\nencsvc.exe\nfirefox.exe\ntbirdconfig.exe\nmdesktopqos.exe\nocomm.exe\ndbeng50.exe\nsqbcoreservice.exe\nexcel.exe\ninfopath.exe\nmsaccess.exe\nmspub.exe\nonenote.exe\noutlook.exe\npowerpnt.exe\nsteam.exe\nthebat.exe\nthunderbird.exe\nvisio.exe\nwinword.exe\nwordpad.exe\nvmwp.exe\n\nSubsequently, the malware proceeds to halt services that could potentially disrupt the\nencryption process. In this particular instance, not only are system utilities targeted, but also\nanti-malware software, such as Sophos. It is important to note that the processes and\nservices to be terminated are contingent upon the configuration file. Thus, we can deduce\nthat the threat actor is aware of the victim's use of Sophos as their anti-malware solution. For\nother victims, the attacker could customize the file to disable different services accordingly.\n\nThe list of services targeted in this specific case includes:\n\n\n-----\n\nvss\nsql\nsvc$\nmemtas\nmepocs\nsophos\nveeam\nbackup\nvmms\n\n_Figure 6: Service Stop Routine_\nFigure 6 illustrates that the malware employs two distinct methods to attempt to halt\nWindows services: the first method utilizes Microsoft's WMIC utility, while the second relies\non the SCManager* Windows APIs.\n\nFollowing this, the ransomware extracts information from the configuration file to identify\ndirectories that should be exempt from encryption. In this specific instance, the folders to be\nbypassed include:\n\n\n-----\n\nC:\\\\msocache\nC:\\\\$windows.~ws\nC:\\\\system volume information\nC:\\\\perflogs\nC:\\\\programdata\nC:\\\\program files (x86)\nC:\\\\program files\nC:\\\\$windows.~bt\nC:\\\\windows\nC:\\\\windows.old\nC:\\\\boot\n\nOne of the most serious capabilities of the ransomware is the ability to propagate the locking\nprocess through the network. It uses two different ways to perform that operation. The first\none is to iterate and inside all the connected devices of the machine.\n\nThe second one is sneakier, because it attempts to login to hardcoded domain accounts\nusing the API function WNetAddConnection2W. WNetAddConnection2W is a Windows API\nfunction that allows a program to connect to network resources, such as shared drives or\nprinters, by establishing a network connection. This function enables connection\nestablishment using specified usernames and passwords, and it also permits the user to\ndictate whether the connection should be remembered and reconnected automatically in the\nfuture.\n\nWNetAddConnection2W works by trying to connect to a network resource, like a network\nshare or cloud storage service, using a series of compromised user credentials. These\ncredentials are stored within Money Ransomware's configuration file. This behavior indicates\nthat the ransomware operators have obtained compromised credentials from prior privilege\nescalation activities.\n\nOnce the connection is established, the ransomware can then encrypt the files stored on the\nnetwork resource, in addition to those stored locally on the victim's computer.\n\n\n-----\n\n_Figure 7: Accessing to remote resources abusing compromised credentials and_\n_WNetAddConnection2W API_\nFor the encryption process, the ransomware employs a combination of the Elliptic Curve\nDiffie-Hellman (ECDH) and ChaCha20 algorithms. By doing so, the malware effectively\nharnesses the robust asymmetric encryption capabilities provided by ECDH, along with the\nhigh performance of ChaCha20, to swiftly encrypt all files within the victim's machine.\n\n\n-----\n\n_Figure 8: Encryption Algorithm_\nAnother technique adopted by the ransomware to manage the file encryption process\ninvolves checking the file’s footer. By using the SetFilePointerEx API call, the ransomware\nmoves the file pointer to -172 from the end, searching for the hexadecimal pattern “90 00 00\n00”, which indicates the start of the footer. This approach helps prevent the encryption of the\nsame file twice. Following this pattern, the ransomware writes 168 bytes, which encompass\nthe necessary information to enable the decryption of the encrypted file.\n\n\n-----\n\n_Figure 9: Already Encrypted Check_\nIn the end, we can summarize the malware control flow in the following figure:\n\n\n-----\n\n_Figure 10: Money_\n\n_Ransomware Control Flow_\n\n## Conclusion\n\nMoney Ransomware is part of a growing trend of ransomware attacks that have been on the\nrise since 2019, targeting the encryption, theft, and exfiltration of sensitive data. It is crucial\nto examine, as discussed in the technical details, the way these attacks are executed.\nRansomware payloads do not necessarily require high levels of sophistication if a wellorganized and optimized intrusion underlies the ransomware's deployment.\n\nAdditionally, another issue that has emerged in this case and others is the problem of\npropagation, which involves the abuse of legitimate API calls. For example, the infamous\nBlackCat/AlphV ransomware demonstrated the misuse of API calls to elevate its privileges\nduring execution; in the case of Money Ransomware, API calls have been abused to\n\n\n-----\n\npropagate within remote shared resources. This poses a significant concern for\norganizations, as a single infected system can rapidly result in extensive damage and data\nloss.\n\nTo mitigate this risk, it is vital for organizations to adopt a proactive approach to network\nsecurity. This includes regularly patching and updating software, employing firewalls and\nother network security tools, and educating employees on how to recognize and avoid\ncommon phishing and social engineering attacks. By taking these measures, organizations\ncan reduce their risk of succumbing to ransomware attacks and safeguard their valuable\ndata from harm.\n\n## Indicators of Compromise\n\nHash:\n\nbbdac308d2b15a4724de7919bf8e9ffa713dea60ae3a482417c44c60012a654b\n\n## Yara Rules\n```\nrule money_ransomware\n\n{\n\n     meta:\n\n          author = \"Yoroi Malware ZLab\"\n\n    description = \"Rule for Money Ransomware\"\n\n    last_updated = \"2023-03-28\"\n\n    tlp = \"WHITE\"\n\n    category = \"informational\"\n\n     strings:\n\n          // 0x00445F00 mw_remove_shadow_copies\n\n          $1 = { 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? c7 45 e8 00 00 00 00 ff 15 ?? ??\n?? ?? 50 ff 15 ?? ?? ?? ?? 8b f0 85 f6 0f 84 ?? ?? ?? ?? eb ?? 8b 4d e0 8b 01 ff 50\n04 89 45 e4 8d 45 e4 50 83 ec 08 8b c4 c7 00 ?? ?? ?? ?? c7 40 04 3e 00 00 00 e8 ??\n?? ?? ?? 83 c4 0c b8 ?? ?? ?? ?? c3 }\n\n          // 0044352D -> 00443566 mw_parse_config\n\n          $2 = {8d 47 30 3b c6 74 ?? 8b c8 e8 ?? ?? ?? ?? 8b 0e 89 4f 30 8b 46\n04 89 47 34 8b 46 08 89 47 38 c7 06 00 00 00 00 c7 46 04 00 00 00 00 c7 46 08 00 00\n00 00 8d ?? 14 ff ff ff e8 ?? ?? ?? ??}\n\n     condition:\n\n          uint16(0) == 0x5A4D and ($1 or $2)\n\n}\n\n\n```\n_This blog post was authored by Luigi Martire, Carmelo Ragusa of Yoroi Malware ZLAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-13 - Money Ransomware- The Latest Double Extortion Group.pdf"
    ],
    "report_names": [
        "2023-04-13 - Money Ransomware- The Latest Double Extortion Group.pdf"
    ],
    "threat_actors": [
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338960,
    "ts_updated_at": 1743041726,
    "ts_creation_date": 1683251920,
    "ts_modification_date": 1683251920,
    "files": {
        "pdf": "https://archive.orkl.eu/45419f080de6633fd543ea01d79e0cec8cf3035d.pdf",
        "text": "https://archive.orkl.eu/45419f080de6633fd543ea01d79e0cec8cf3035d.txt",
        "img": "https://archive.orkl.eu/45419f080de6633fd543ea01d79e0cec8cf3035d.jpg"
    }
}