{
    "id": "bb285f42-1225-47e3-b2d8-01c385a45337",
    "created_at": "2023-01-12T15:03:09.74887Z",
    "updated_at": "2025-03-27T02:16:59.139802Z",
    "deleted_at": null,
    "sha1_hash": "cfd45384f984c7dc7316e7c683888e81a31eb1dd",
    "title": "2021-01-28 - Pro-Ocean- Rocke Group’s New Cryptojacking Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:06:58Z",
    "file_modification_date": "2022-05-28T19:06:58Z",
    "file_size": 1687659,
    "plain_text": "# Pro-Ocean: Rocke Group’s New Cryptojacking Malware\n\n**[unit42.paloaltonetworks.com/pro-ocean-rocke-groups-new-cryptojacking-malware/](https://unit42.paloaltonetworks.com/pro-ocean-rocke-groups-new-cryptojacking-malware/)**\n\nAviv Sasson January 28, 2021\n\nBy [Aviv Sasson](https://unit42.paloaltonetworks.com/author/aviv-sasson/)\n\nJanuary 28, 2021 at 6:00 AM\n\n[Category: Cloud,](https://unit42.paloaltonetworks.com/category/cloud/) [Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Cryptocurrency,](https://unit42.paloaltonetworks.com/tag/cryptocurrency/) [Monero,](https://unit42.paloaltonetworks.com/tag/monero/) [Rocke](https://unit42.paloaltonetworks.com/tag/rocke/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/pro-ocean-rocke-groups-new-cryptojacking-malware/)\n\n## Executive Summary\n\n[In 2019, Unit 42 researchers documented cloud-targeted malware used by the](https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/) [Rocke Group to conduct](https://unit42.paloaltonetworks.com/rockein-the-netflow/)\ncryptojacking attacks to mine for Monero. Since then, cybersecurity companies have had the malware on\ntheir radar, which hampered Rocke Group’s cryptojacking operation. In response, the threat actors\nupdated the malware.\n\nHere, we uncover a revised version of the same cloud-targeted cryptojacking malware, which now\nincludes new and improved rootkit and worm capabilities. We also detail the hiding techniques used by\nthe malware to dodge cybersecurity companies’ detection methods, while explaining its four-module\nstructure. We’ve named the malware Pro-Ocean after the name the attacker chose for the installation\nscript.\n\nPro-Ocean uses known vulnerabilities to target cloud applications . In our analysis, we found Pro-Ocean\ntargeting Apache ActiveMQ (CVE-2016-3088), Oracle WebLogic (CVE-2017-10271) and Redis\n(unsecure instances). In the case that the malware runs in Tencent Cloud or Alibaba Cloud, it will use the\nexact code of the previous malware to uninstall monitoring agents to avoid detection. Additionally, it\n\n\n-----\n\nattempts to remove other malware and miners including Luoxk, BillGates, XMRig and Hashfish before\ninstallation. Once installed, the malware kills any process that uses the CPU heavily, so that it’s able to\nuse 100% of the CPU and mine Monero efficiently.\n\n[Palo Alto Networks Prisma Cloud customers are protected from Pro-Ocean through the Runtime](https://www.paloaltonetworks.com/prisma/cloud)\nProtection and Cryptominers Detection features.\n\n## The Malware\n\nAlthough Pro-Ocean attempts to disguise itself as benign, it packs an XMRig miner, which is notorious for\nits use in cryptojacking operations. The miner seeks to hide using several obfuscation layers on top of\nthe malicious code:\n\n[1. The binary is packed using UPX. This means that the actual malware is compressed inside the](https://en.wikipedia.org/wiki/UPX)\n\nbinary and is extracted and executed during the binary execution.\n2. Advanced static analysis tools can unpack UPX binaries and scan their content. However, in this\n\ncase, the UPX magic string has been deleted from the binary, and therefore, static analysis tools\ncannot identify this binary as UPX and unpack it.\n3. The modules are gzipped inside the unpacked binary.\n4. The XMRig binary is inside one of the gzipped modules and is also packed by UPX and does not\n\nhave the UPX magic string.\n\nFigure 1. Obfuscation layers.\nPro-Ocean targets several typical cloud applications including Apache ActiveMQ, Oracle Weblogic and\nRedis, with an emphasis on cloud providers based in China including Alibaba Cloud and Tencent Cloud.\nIt is written in Go and compiled to an x64 architecture binary. It contains four modules that deploy during\nexecution -- hiding, mining, infecting and watchdog. Each module contains some files written in various\nlanguages (C, Python or Bash) and a Bash script that executes it.\n\n**The Modules**\n\nThe four modules of Pro-Ocean are gzipped inside the binary and are extracted and executed one after\nthe other by four different functions.\n\n\n-----\n\nFigure 3. Malware architecture.\n\n**Hiding Module (Rootkit Capabilities)**\n\n\n-----\n\nThe hiding module is responsible for concealing Pro-Ocean s malicious activity. It uses a native Linux\nfeature, LD_PRELOAD. LD_PRELOAD forces binaries to load specific libraries before others, allowing\nthe preloaded libraries to override any function from any library. One of the ways to use LD_PRELOAD is\nto add the crafted library to /etc/ld.so.preload.\n\nThis way, once executed, binaries will load this library and use its functions instead of the functions in the\ndefault libraries. This feature is commonly abused by other malware.\n\nDuring execution, the hiding module compiles a C file into a library and adds it to /etc/ld.so.preload. This\nlibrary contains many functions that are usually exposed by libc, including open, opendir, readdir, stat,\naccess and much more. These functions use the real libc functions while altering the returned data in\norder to hide any information that exposes Pro-Ocean (e.g. malicious files or processes). In some cases,\nthey even return forged data when accessing a specific file such as /proc/stat.\n\n[As in the previous version of the malware, the code uses Libprocesshider, a library for hiding processes.](https://github.com/gianlucaborello/libprocesshider)\nHowever, in addition, it looks like the developer of this code gathered several code snippets from the\ninternet and added them in order to gain more rootkit capabilities.\n\nFor example, let's take a look at the libc function open. This function opens a file and returns its file\ndescriptor, but something else happens once the malicious library is loaded.\n\nFigure 4. Modified open function.\nBefore calling open, the malicious function will determine whether the file in question needs to be hidden\nto obfuscate malicious activities. If it determines that the file needs to be hidden, the malicious function\nwill return a “No such file or directory” error, as if the file in question does not exist.\n\nBesides that, in this module, Pro-Ocean will try to gain persistence by copying itself into numerous\nlocations, create a new malicious service that will execute the malware in case it is not running and add\nseveral [cron jobs that will do the same thing periodically.](https://en.wikipedia.org/wiki/Cron)\n\n**Mining Module**\n\n\n-----\n\nThe mining module is the reason Pro-Ocean exists in the first place. Its goal is to mine Monero into the\nattacker’s wallet, and it does so by deploying an XMRig miner 5.11.1 and a JSON configuration, then\nstarting to mine. This is a common operation for cryptojacking malware.\n\n**Infection Module (Worm Capabilities)**\n\nBehaving differently than they chose to in the previous version of the malware, the Rocke Group does\nnot exploit victims manually with Pro-Ocean. Instead, this version of the malware uses a Python infection\nscript that gives it \"worm\" capabilities. This script retrieves the machine’s public IP by accessing an\nonline service that does so in the address \"ident.me\" and then tries to infect all the machines in the same\n16-bit subnet (e.g. 10.0.X.X). It does this by blindly executing public exploits one after the other in the\nhope of finding unpatched software it can exploit.\n\nFigure 5. Infection scanning loop.\nOnce it finds unpatched software and exploits it, the Python script sends a payload that will download an\ninstallation script from a malicious HTTP server, which will do some preparations and install Pro-Ocean.\n\nThe list of vulnerable software that Pro-Ocean exploits includes:\n\n1. Apache ActiveMQ – CVE-2016-3088.\n2. Oracle WebLogic – CVE-2017-10271.\n3. Redis – unsecure instances.\n\nThis list is not finite (meaning Pro-Ocean targets all cloud applications) since the malware is downloaded\nto the victim from a remote server during the infection. Thus it can be changed, and additional exploits or\nother upgrades could be added.\n\n\n-----\n\nFigure 6. Infection process.\n\n### Installation Script\n\nThe installation script has a crucial role, and it lays the groundwork for Pro-Ocean before installing it by\ndoing several things. It is written in Bash and is obfuscated. By observing it, we can conclude that two of\nthe malware’s targets are Alibaba Cloud and Tencent Cloud.\n\nIt works in this order:\n\n1. Attempt to remove other malware and miners including Luoxk, BillGates, XMRig, Hashfish and\n\nmore. It does this by running the “grep” command searching for other processes and network\nconnections and then terminates them if found.\n2. Erase all of the cron tasks to make sure that other malware will not be able to recover.\n[3. Disable the iptables firewall so that the malware will have full access to the internet.](https://en.wikipedia.org/wiki/Iptables)\n4. In the case that the malware runs in Tencent Cloud or Alibaba Cloud, it will use the exact code of\n\nthe previous malware to uninstall monitoring agents to avoid detection.\n5. Look for SSH keys and attempt to use them in order to infect new machines.\n\n\n-----\n\nFigure 7. Uninstall the cloud monitoring agents.\nAfter laying the groundwork, the installation script will determine the machine CPU architecture and try to\ndownload the corresponding binary using various tools including curl, wget, python2, python3 and PHP.\n\nFigure 8. Obfuscated code that downloads the malware.\n\n**Watchdog Module**\n\nPro-Ocean contains a watchdog module written in Bash. It executes two Bash scripts with different\npurposes.\n\n1. program__kill30 – This script loops forever and searches for processes that utilize more than 30%\n\nof the CPU (not including the malware processes). Once found, it kills them. The malware’s goal is\nto use 100% of the CPU and mine Monero efficiently, so it kills any process that uses the CPU\nheavily.\n\n\n-----\n\n2. Program__daemonload – This process loops forever and checks that the malware is running. If not,\n\nit runs it.\n\n## Conclusion\n\nCryptojacking malware targeting the cloud is evolving as attackers understand the potential of that\nenvironment to mine for crypto coins. We previously saw simpler attacks by the Rocke Group, but it\nseems this group presents an ongoing, growing threat. This cloud-targeted malware is not something\nordinary since it has worm and rootkit capabilities. We can assume that the growing trend of\nsophisticated attacks on the cloud will continue.\n\nThis malware is an example that demonstrates that cloud providers’ agent-based security solutions may\nnot be enough to prevent evasive malware targeted at public cloud infrastructure. As we saw, this sample\nhas the capability to delete some cloud providers’ agents and evade their detection (Figure 7).\n\nPalo Alto Networks Prisma Cloud customers are protected from Pro-Ocean through the Runtime\nProtection and Cryptominers Detection features.\n\nFigure 9. Prisma Cloud incident alert.\n\n## IOCs\n\n**URLs**\n\nhxxp://shop.168bee[.]com/*\n\nhxxps://shop.168bee[.]com/*\n\n**Mining Pool**\n\nhxxp://pool.minexmr[.]com\n\n**Files**\n\nSHA-256 Hash Filename\n\n4ff33180d326765d92e32ec5580f54495bfcdd58a85f908a7ece8d0aedbe5597 pro__autolk.sh\n\n220c2ebacafde95ebf4af12bf0d8eedb6004edd103ecb1d6363e7eb5a3e62c01 pro__automig.sh\n\na81424ec81849950616f932c79db593147b8a01cc6d06d279fd05d61103abdb7 pro__autorkt.sh\n\n\n-----\n\n070afdbb4c2c9e499d55cb8fbc08f98e95725b98682586d42f84fd7181eae1cb pro__autoscan.sh\n\n0a3898da2c6e31f1eed4497c4e4e3cf24138981f35cb3d190b81ba4b24ab3df0 pro__cfg\n\n26a126fd5cd47b62bb5ae3116a509caf84da1ccd414e632f898aec0948cb0dbf pro__wlib.c\n\n37e1c05cc683bac5fe97763023a228a4ca4e0439acc94695724f67b7e0275ece proc__bioset.sh\n\nd3e95ae2f01be948dd11157873b3c84cb3e76dea1b382bcfb2c0cb09a949497c proc__o0mig\n\n713b5447a51a4b930222491a2dfb5b948a5da6860d80cd8663c99432c1e0812f proc__scanr.py\n\n0f7abdceae4353c4a6a8ed6b5d261df0f94c2c52709dd50d38003192492e7d3b pro__o0cean\n\nbfea86bb68b51c6875d541c92bb48b38298982efbe12cf918873642235b99eeb pro__o0cean\n\n575945f6f5149dc48c4a665fcab0cbdbedec1e18b887abe837ed987a7253ad02 proc__sysagent.service\n\nabb36bc19b82a026f7d70919c64ed987ebb71420b04bb848275547e99da485bd .program__daemonload\n\n7888925fe143add65f2ad928a7ee4e4b864d421fde57fac0cb2b218e70fe4d31 .program__kill30\n\n_Table 1. Malicious files hashes_\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-28 - Pro-Ocean- Rocke Group’s New Cryptojacking Malware.pdf"
    ],
    "report_names": [
        "2021-01-28 - Pro-Ocean- Rocke Group’s New Cryptojacking Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "7c053836-8f50-4d40-bc5c-7088967e1b57",
            "created_at": "2022-10-25T16:07:24.549525Z",
            "updated_at": "2025-03-27T02:02:10.278474Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra",
                "Iron Group",
                "Rocke"
            ],
            "source_name": "ETDA:Rocke",
            "tools": [
                "Godlua",
                "Kerberods",
                "LSD",
                "Pro-Ocean",
                "Xbash"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e4389aca-6209-443d-9fdc-7ad01c36e3b4",
            "created_at": "2023-01-06T13:46:39.07782Z",
            "updated_at": "2025-03-27T02:00:02.991346Z",
            "deleted_at": null,
            "main_name": "luoxk",
            "aliases": [],
            "source_name": "MISPGALAXY:luoxk",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aacd5cbc-604b-4b6e-9e58-ef96c5d1a784",
            "created_at": "2023-01-06T13:46:38.953463Z",
            "updated_at": "2025-03-27T02:00:02.961301Z",
            "deleted_at": null,
            "main_name": "APT31",
            "aliases": [
                "JUDGMENT PANDA",
                "BRONZE VINEWOOD",
                "Red keres",
                "Violet Typhoon",
                "TA412"
            ],
            "source_name": "MISPGALAXY:APT31",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "905eabd9-2b7f-483d-86bd-0c72f96b4162",
            "created_at": "2023-01-06T13:46:39.02749Z",
            "updated_at": "2025-03-27T02:00:02.980813Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra"
            ],
            "source_name": "MISPGALAXY:Rocke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9e6186dd-9334-4aac-9957-98f022cd3871",
            "created_at": "2022-10-25T15:50:23.357398Z",
            "updated_at": "2025-03-27T02:00:55.452383Z",
            "deleted_at": null,
            "main_name": "ZIRCONIUM",
            "aliases": [
                "APT31",
                "Violet Typhoon"
            ],
            "source_name": "MITRE:ZIRCONIUM",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0b02af5f-2027-42b7-a6f2-51e2fd49ba7f",
            "created_at": "2022-10-25T15:50:23.360509Z",
            "updated_at": "2025-03-27T02:00:55.45329Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Rocke"
            ],
            "source_name": "MITRE:Rocke",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "774f15f7-832e-4cd4-a1fa-ec6a838f2a40",
            "created_at": "2022-10-25T16:47:55.641406Z",
            "updated_at": "2025-03-27T02:05:17.29791Z",
            "deleted_at": null,
            "main_name": "BRONZE VINEWOOD",
            "aliases": [
                "Judgment Panda ",
                "ZIRCONIUM ",
                "APT31 "
            ],
            "source_name": "Secureworks:BRONZE VINEWOOD",
            "tools": [
                " HanaLoader",
                " Metasploit",
                " Mimikatz",
                " Reverse ICMP shell",
                " Trochilus",
                "DropboxAES RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535789,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653764818,
    "ts_modification_date": 1653764818,
    "files": {
        "pdf": "https://archive.orkl.eu/cfd45384f984c7dc7316e7c683888e81a31eb1dd.pdf",
        "text": "https://archive.orkl.eu/cfd45384f984c7dc7316e7c683888e81a31eb1dd.txt",
        "img": "https://archive.orkl.eu/cfd45384f984c7dc7316e7c683888e81a31eb1dd.jpg"
    }
}