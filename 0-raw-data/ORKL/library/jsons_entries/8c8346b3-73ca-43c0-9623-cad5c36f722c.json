{
    "id": "8c8346b3-73ca-43c0-9623-cad5c36f722c",
    "created_at": "2023-01-12T15:04:22.198786Z",
    "updated_at": "2025-03-27T02:16:26.078794Z",
    "deleted_at": null,
    "sha1_hash": "040981d7f6ea3c9a50ff7a65a8b23a6e7583f886",
    "title": "2021-05-17 - Case Study- Incident Response is a relationship-driven business",
    "authors": "",
    "file_creation_date": "2022-05-28T01:24:10Z",
    "file_modification_date": "2022-05-28T01:24:10Z",
    "file_size": 1993849,
    "plain_text": "# Case Study: Incident Response is a relationship-driven business\n\n**blog.talosintelligence.com/2021/05/ctir-case-study.html**\n\n## Proof that incident response is \"the ultimate team sport\"\n\n_By_ _[Brad Garnett.](https://twitter.com/brgarnett?lang=en)_\n\n## Introduction\n\nAs a seasoned incident responder, and now IR business leader here at Cisco Talos Incident\nResponse (CTIR), I have always said that incident response is the ultimate team sport.\nPeople are building blocks for organizations — and an effective incident response is about\npeople, relationships and leveraging those relationships into the incident response workflow\n(processes and security instrumentation). This all plays a part in effectively containing and\neradicating a determined adversary from the organization’s network environment.\n\nTo highlight this, I want to share a recent CTIR engagement that shows how we can work\ntogether with an organization’s IR and IT teams to quickly contain and remediate a threat. In\nthis case, we dealt with an adversary that could critically affect a business by deploying\nransomware and virtually completely shutting down their network.\n\nOne of my favorite parts about my role with CTIR is the customer relationships I get to build\naround the world by leveraging our awesome Cisco Secure collaboration technology to work\nfrom anywhere and at home during the pandemic. I hear first-hand about the challenges and\nsuccesses our customers have facing today’s most challenging threats\n\n\n-----\n\nThis customer case study I am going to highlight is a publicly traded company with more than\n$8 billion in revenue. This incident was even more complicated because the company was\ngoing through a merger and acquisition when the customer CISO received a phone call from\nmy organization. This customer had an existing IR retainer with us and has a strong\nrelationship with my organization — to the extent that we are viewed as an extended team.\n[We notified this customer after we identified suspicious Cobalt Strike activity and TTPs](https://talos-intelligence-site.s3.amazonaws.com/production/document_files/files/000/095/031/original/Talos_Cobalt_Strike.pdf)\n[consistent with pre-ransomware activity via SecureX telemetry.](https://www.cisco.com/c/en/us/products/security/what-is-secureX.html)\n\n_“Our Cisco Talos partners recognize the critical role relationships play in cybersecurity_\n_and Incident Response. The Talos Team has invested significant time and effort in us to_\n_fully understand our people and environment before an incident occurred. Together, we_\n_built familiarity and trust between our teams that can only be obtained through constant_\n_engagement and drills. When we were faced with a significant security incident, that_\n_trust and familiarity were the key differentiators that enabled us to successfully contain_\n_the threat and minimize damages,” customer CISO._\n\n## Initial notification\n\nDuring the initial notification, we supplied our customer with the specific hostname and\nindicators we contacted them about. Below is the initial Cobalt Strike beacon that we\nidentified in global telemetry:\n\ncmd.exe executed powershell -nop -w hidden -encodedcommand\n<redacted_base64_string>\n\nFollowed by the following for command and control (C2):\n\ncmd.exe executed powershell -nop -w hidden -encodedcommand\n<redacted_base64_string>\n\npowershell.exe Connected to 95[.]174[.]65[.]241[:]4444\n\n_Note: Please visit the_ _[Talos Reputation Center for accurate threat information.](https://talosintelligence.com/reputation)_\n\n## Detection and analysis\n\nThis blog post will only highlight endpoint analysis, but the same approach was included in\nour analysis plan for the two compromised domain controllers.\n\n[Based upon our global SecureX telemetry and the customer’s](https://www.cisco.com/c/en/us/products/security/what-is-secureX.html) [Cisco Secure Endpoint](https://www.cisco.com/c/en/us/products/security/amp-for-endpoints/index.html)\ndeployment, we were identified patient zero and focused our forensic analysis efforts on three\nkey systems as part of our analysis plan:\n\n1 Endpoint (Patient Zero): Windows 10 Enterprise 1909\n\n\n-----\n\n2. Domain Controller 1 (DC1): Windows Server 2016 Standard\n3. Domain Controller 2 (DC2): Windows Server 2012 R2 Standard\n\n\n-----\n\n## Patient zero (Windows 10 endpoint)\n\n**[ATT&CK Technique with Sub-Technique (T1204.002) User Execution: Malicious File](https://attack.mitre.org/techniques/T1204/002/)**\n\nForensic analysis of the patient zero endpoint found that the file\nDocument_1223672987_11142020.zip was downloaded to\n\\Users\\%Compromised_User%\\Downloads. The RecentDocs registry entry shows that the\nuser opened the ZIP archive shortly after the file was downloaded. Analysis of the Excel\ndocument contained within Document_1223672987_11142020.zip showed a malicious macro\nthat was set to execute once the document was opened. This macro attempted to download a\npayload from “http[:]//redacted[.]com/bpebqznfbkgl/55555555555.jpg”. This payload was then\nstored on the system in the “C:\\IntelCompany” folder and executed using the rundll32\nexecutable. The analysis also shows that the payload delivered by this document is the\n[Qakbot banking trojan. The user was not warned of the macros existence before it was](https://blog.talosintelligence.com/search/label/qakbot)\nexecuted because this host was configured to trust all macros and all Excel documents from\nthe internet.\n\n**[ATT&CK Technique with Sub-Technique (T1059.001) Command and Scripting](https://attack.mitre.org/techniques/T1059/001/)**\n**Interpreter: PowerShell**\n\nWe observed multiple executions of Cobalt Strike beacon-encoded PowerShell payloads from\nthe ‘Compromised_User’ user during the analysis of the Windows PowerShell event log.\n\n\n-----\n\nAnalysis of the encoded payloads revealed that the Cobalt Strike command and control traffic\nwas configured to use the following user agents:\n\nMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/74.0.3729.157 Safari/537.36\n\nWindows-Update-Agent/10.0.10011.16384 Client-Protocol/1.40\n\nThe PowerShell event log also showed that at 2020-11-20T16:58:22Z, the following\nPowerShell command was executed to enumerate the domain controllers on the domain:\n\npowershell\n\n[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().DomainControllers\n| Select -property Name,IPAddress,OSVersion\n\n**[ATT&CK Technique with Sub-Technique (T1087.002) Account Discovery: Domain](https://attack.mitre.org/techniques/T1087/002/)**\n**Account**\n\n**[ATT&CK Technique (T1018) Remote System Discovery](https://attack.mitre.org/techniques/T1018/)**\n\n[During analysis of the Master File Table ($MFT), we concluded that at 2020-11-20T17:55:29Z](https://docs.microsoft.com/en-us/windows/win32/fileio/master-file-table)\n“20201120104627_BloodHound.zip”, which was an archive containing an open-source tool\nknown as [BloodHound used for enumerating windows domains, was downloaded to the](https://github.com/BloodHoundAD/BloodHound)\n“\\Users\\Public” folder. At 2020-11-20T18:22:00Z, the file “20201120132133_users.json” was\ncreated in “\\Users\\%Compromised_User%\\Downloads”. Although the contents of the file were\nnot included in the evidence collected, our assumption based upon supporting evidence is\nthat this file is an output file from the execution of bloodhound containing information about\nthe users within the domain. Similarly, at 2020-11-20T20:40:00Z the file\n\n\n-----\n\n20201120132133_computers.json was created in the\n“\\Users\\%Compromised_User%\\Downloads” folder. We concluded with high confidence that\nthis file contained BloodHound output with information about the hosts within the domain.\n\n## Containment, eradication and recovery\n\nThe collaborative, joint incident response between the customer’s IR team and CTIR led to a\nquick containment and full eradication of an active adversary in the enterprise IT environment\nthat had the capability to deploy ransomware. During these phases of the incident response,\nthere were various actions performed, including but not limited to, re-imaging the patient zero\nendpoint, password resets, and the deployment of additional GPOs to restrict document\nmacros, PowerShell and SMB/ Admin Shares. In every incident response, there are lessons\nlearned. This is how organizations continue to evolve defense and detection capabilities,\nthreat models, and incident response plans and playbooks. If your organization is interested\n[in any of these services, please reach out to CTIR for more information.](https://talosintelligence.com/incident_response)\n\n## Post-incident activity\n\nDuring our post-incident briefing with this customer and its executive leadership, we\ncommended the customer and their entire organization for their swift response and\ncollaboration with CTIR to successfully contain and eradicate a determined adversary that\nlikely would’ve caused millions of dollars in lost revenue and recovery expenses. I am\nhumbled to share this joint success story, as a lot of IR organizations are summoned once\nransomware has been deployed and the entire organization has affected, which is something\n[that we observe globally and across industry verticals in our quarterly IR trends.](https://talosintelligence.com/resources)\n\n## Conclusion\n\nI am grateful for the mutual, high-trust relationship between this customer and my\n[organization. Incident response is a relationship-driven business. CTIR retainers are critical](https://talosintelligence.com/IR)\nfor organizations to augment their IR capabilities. A tested incident response plan that\naccurately reflects your organization’s current capabilities is critical, as evidenced in the two\nCase Studies [we released today. Organizational and third-party relationships are tested](https://talosintelligence.com/resources/212)\nduring a crisis. It’s important that there is an elevated level of trust between IR team and\nclient, and that there is an established and agreed-upon process when time is of the essence\nto prevent an enterprise-wide ransomware attack when adversary pre-ransomware activity is\n\n\n-----\n\nidentified. CISOs and executives should review and refine third-party relationships on a\nroutine basis. Have your third-party IR relationships been tried and tested — and are those\nrelationships resilient?\n\n[If you want to learn more about CTIR, check out our website here and visit us at](https://talosintelligence.com/incident_response) this year’s\nvirtual RSA Conference this week.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-17 - Case Study- Incident Response is a relationship-driven business.pdf"
    ],
    "report_names": [
        "2021-05-17 - Case Study- Incident Response is a relationship-driven business.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535862,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653701050,
    "ts_modification_date": 1653701050,
    "files": {
        "pdf": "https://archive.orkl.eu/040981d7f6ea3c9a50ff7a65a8b23a6e7583f886.pdf",
        "text": "https://archive.orkl.eu/040981d7f6ea3c9a50ff7a65a8b23a6e7583f886.txt",
        "img": "https://archive.orkl.eu/040981d7f6ea3c9a50ff7a65a8b23a6e7583f886.jpg"
    }
}