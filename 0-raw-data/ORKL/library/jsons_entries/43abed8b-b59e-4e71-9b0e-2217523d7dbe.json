{
    "id": "43abed8b-b59e-4e71-9b0e-2217523d7dbe",
    "created_at": "2023-01-12T15:09:58.277433Z",
    "updated_at": "2025-03-27T02:05:37.806659Z",
    "deleted_at": null,
    "sha1_hash": "b51436861d6774f73f08d37c1286848410a1f24b",
    "title": "2022-04-01 - Fresh TOTOLINK Vulnerabilities Picked Up by Beastmode Mirai Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T19:03:02Z",
    "file_modification_date": "2022-05-28T19:03:02Z",
    "file_size": 249278,
    "plain_text": "# Fresh TOTOLINK Vulnerabilities Picked Up by Beastmode Mirai Campaign\n\n**[fortinet.com/blog/threat-research/totolink-vulnerabilities-beastmode-mirai-campaign](https://www.fortinet.com/blog/threat-research/totolink-vulnerabilities-beastmode-mirai-campaign)**\n\nApril 1, 2022\n\nBetween February and March 2022, our FortiGuard Labs team observed that the Beastmode\n(aka B3astmode) Mirai-based DDoS campaign has aggressively updated its arsenal of\nexploits. Five new exploits were added within a month, with three targeting various models of\nTOTOLINK routers.\n\nThis inclusion of TOTOLINK exploits is especially noteworthy as they were added just a\nweek after the exploit codes were published on GitHub. We previously reported on the\n[MANGA campaign, which similarly adopted exploit code within weeks of their release.](https://www.fortinet.com/blog/threat-research/manga-aka-dark-mirai-based-campaign-targets-new-tp-link-router-rce-vulnerability)\n\nBy rapidly adopting newly released exploit code, threat actors can potentially infect\nvulnerable devices and expand their botnets before patches are applied to fix these\nvulnerabilities.\n\n\n-----\n\n[TOTOLINK has already released updated firmware for affected models and users are](http://totolink.net/home/news/me_name/id/39/menu_listtpl/DownloadC.html)\nstrongly encouraged to update their devices.\n\nThis post details how this threat leverages these vulnerabilities to control affected devices,\nand ways to protect users from these attacks.\n\n**Affected Platforms: Linux**\n**Impacted Users: Any organization**\n**Impact: Remote attackers gain control of the vulnerable systems**\n**Severity Level: Critical**\n\n## Exploiting New Vulnerabilities\n\nThe Beastmode campaign derives its name from filenames and URLs used for its binary\nsamples (Figure 1), as well as a unique HTTP User-Agent header \"b3astmode\" (Figure 2)\nwithin the exploit requests. Binary samples are based on the publicly available source code\nof the Mirai botnet.\n\nFigure 1. Honeypot log excerpt displaying usage of “beastmode” and “b3astmode” in\nfilenames and URLs\n\nLike most DDOS botnets, aside from brute-forcing credentials, Beastmode employs a variety\nof exploits to infect more devices, as listed below.\n\n[CVE-2022-26210 targets TOTOLINK A800R, A810R, A830R, A950RG, A3000RU, and](https://nvd.nist.gov/vuln/detail/CVE-2022-26210)\nA3100R (Figure 2).\n\nFigure 2. CVE-2022-26210 exploit request\n\n[CVE-2022-26186 targets TOTOLINK N600R and A7100RU (Figure 3).](https://nvd.nist.gov/vuln/detail/CVE-2022-26186)\n\nFigure 3. CVE-2022-26186 exploit request\n\n[CVE-2022-25075/25076/25077/25078/25079/25080/25081/25082/25083/25084 are a family](https://nvd.nist.gov/vuln/detail/CVE-2022-25075)\nof similar vulnerabilities targeting TOTOLINK A810R, A830R, A860R, A950RG, A3100R,\nA3600R, T6, and T10 routers. (Figure 4).\n\nInterestingly, the samples caught on 20 Feb 2022 contained a typo in the URL, where\n“downloadFile.cgi” was used instead of “downloadFlile.cgi” used by the devices. This had\nbeen fixed in samples captured three days later, suggesting active development and\noperation of this campaign.\n\nFigure 4. CVE-2022-25075 exploit with the correct request\n\n\n-----\n\nApart from TOTOLINK products, this campaign also targets discontinued D-Link products\n[(DIR-810L, DIR-820L/LW, DIR-826L, DIR-830L and DIR-836L) via CVE-2021-45382](https://nvd.nist.gov/vuln/detail/CVE-2021-45382)\n(Figure 5). Note that updated firmware is not available as these products have reached their\nend of life/support cycles.\n\nFigure 5. CVE-2021-45382 exploit request\n\n[It is interesting to note that this campaign also attempts to exploit CVE-2021-4045 (Figure 6),](https://nvd.nist.gov/vuln/detail/CVE-2021-4045)\na vulnerability for the TP-Link Tapo C200 IP camera, which we have not observed in other\nMirai-based campaigns. While the current implementation of the exploit is incorrect, device\n[owners should still update their camera firmware to fix this vulnerability.](https://www.tapo.com/us/faq/21/)\n\nFigure 6. CVE-2021-4045 exploit request\n\nA couple of older vulnerabilities were also found in the samples analyzed by FortiGuard Labs\n[researchers, namely CVE-2017-17215 (Figure 7) targeting Huawei HG532 routers, and](https://nvd.nist.gov/vuln/detail/cve-2017-17215)\n[CVE-2016-5674 (Figure 8) targeting NUUO NVRmini2, NVRsolo, Crystal Devices, and](https://nvd.nist.gov/vuln/detail/CVE-2016-5674)\nNETGEAR ReadyNAS Surveillance products.\n\nFigure 7. CVE-2017-17215 exploit request\n\nFigure 8. CVE-2016-5674 exploit request\n\nWhile affecting a variety of products, these vulnerabilities are all similar in that they allow\nthreat actors to inject commands to be executed after successful exploitation. This usually\ninvolves using the wget command to download shell scripts to infect the device with\nBeastmode.\n\nIn addition, exploits lead to slightly different shell scripts. Snippets of the scripts downloaded\nfrom the successful exploitation of CVE-2021-45382, CVE-2022-26186, and CVE-202225075, respectively are shown below (Figure 9).\n\nFigure 9. Executing Beastmode with different filenames and parameters\n\nAs shown in the above figure, each script downloads the same file to different filenames but\nis executed with different parameters.\n\nFor instance, successful exploitation of CVE-2021-45382, a vulnerability involving a function\nnamed “DDNS” within D-Link router firmware, leads to the download and execution (Figure\n5) of the shell script “ddns.sh”. Then, as shown in Figure 9, the script then downloads the\nBeastmode binary, which is saved as “ddns” and executed with the “ddns.exploit” parameter.\nThe parameter (highlighted in blue) allows the infected device to register itself as part of the\n“ddns.exploit” sub-group within the botnet. It could then be used by the botnet operators to\nassess the viability of specific exploits by measuring the number of bots or simply for ease of\nmanagement.\n\n\n-----\n\nOnce devices are infected by Beastmode, the botnet can be used by its operators to\nperform a variety of DDoS attacks commonly found in other Mirai-based botnets, including:\n\nattack_app_http\nattack_tcp_ack\nattack_tcp_syn\nattack_udp_plain\nattack_udp_vse\nattack_udp_ovhhex\nattack_udp_stdhex\nattack_udp_CLAMP\n\n## Conclusion\n\nEven though the original Mirai author was arrested in fall 2018, this article highlights how\nthreat actors, such as those behind the Beastmode campaign, continue to rapidly incorporate\nnewly published exploit code to infect unpatched devices using the Mirai malware.\n\nBy continuously monitoring the evolving threat landscape, FortiGuard Labs researchers\nidentify new vulnerabilities exploited by Mirai variants and malware targeting IoT devices to\nbring greater awareness to such threats and better secure our customers’ networks.\n\n## Fortinet Protections\n\nFortinet customers are protected by the following:\n\nThe following generic FortiGuard IPS signatures detect exploitation attempts from\nBeastmode and other Mirai-based botnets:\n\n[Mirai.Botnet](https://www.fortiguard.com/encyclopedia/ips/43191)\n[HTTP.Unix.Shell.IFS.Remote.Code.Execution](https://www.fortiguard.com/encyclopedia/ips/45677)\nFortiGuard Labs also provides IPS signatures against the following vulnerabilities.\n\n[CVE-2017-17215 - Huawei.HG532.Remote.Code.Execution](https://www.fortiguard.com/encyclopedia/ips/45066)\nCVE-2016-5674 [NUUO.Surveillance.Application.UNAUTH.Remote.Code.Execution](https://www.fortiguard.com/encyclopedia/ips/43028)\nThe FortiGuard Web Filtering Service blocks downloaded URLs and identified C2s.\nThe FortiGuard AntiVirus service detects and blocks this threat as Linux/Mirai and\nELF/Mirai\n\n[FortiGuard IP Reputation & Anti-Botnet Security Service proactively blocks these attacks by](https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/ipreputation-antibot)\naggregating malicious source IP data from the Fortinet distributed network of threat sensors,\nCERTs, MITRE, cooperative competitors, and other global sources that collaborate to\nprovide up-to-date threat intelligence about hostile sources.\n\n## IOCs\n\n\n-----\n\nDownload URLs\n\nhttp://195.133.18[.]119/beastmode/b3astmode.86_64\n\nhttp://195.133.18[.]119/beastmode/b3astmode.arm4\n\nhttp://195.133.18[.]119/beastmode/b3astmode.arm5\n\nhttp://195.133.18[.]119/beastmode/b3astmode.arm6\n\nhttp://195.133.18[.]119/beastmode/b3astmode.arm7\n\nhttp://195.133.18[.]119/beastmode/b3astmode.m68k\n\nhttp://195.133.18[.]119/beastmode/b3astmode.mips\n\nhttp://195.133.18[.]119/beastmode/b3astmode.mpsl\n\nhttp://195.133.18[.]119/beastmode/b3astmode.ppc\n\nhttp://195.133.18[.]119/beastmode/b3astmode.sh4\n\nhttp://195.133.18[.]119/beastmode/b3astmode.x86\n\nC2 IPs\n\n195.133.18[.]119\n\n136.144.41[.]69\n\nSamples (SHA256)\n\n04a50c409a30cdd53036c490534ee7859b828f2b9a9dd779c6b0112b88b74708\n\n0ca74024f5b389fcfa5ee545c8a7842316c78fc53d4a9e94c34d556459a58877\n\n0d442f4327ddd254dbb2a9a243d9317313e44d4f6a6078ea1139ddd945c3f272\n\n14726d501dd489e8228af9580b4369819efb3101f6128df1a1ab0fcc8d96e797\n\n18cefe4333f5f1165c1275c956c8ae717d53818b2c5b2372144fb87d6687f0d8\n\n36a85f2704f77d7e11976541f3d77774109461e1baae984beb83064c2e34239a\n\n3d0a119b68044b841128e451d80ee41d8be9cc61f9ff9a01c3db7d3271e15655\n\n5adfd18422a37a40e6c7626b27d425a4c5a6ca45ecbc8becd690b8533d9d6c7c\n\n635569c7612278d730cb87879843de03d1ea0df4e1c70262ab50659780eace3b\n\n\n-----\n\n676b2aa6839606d49bbd2f29487e4c218e7d14dd1a9b870edcabdd11fcab9cf7\n\n9c88fa218af7fb72188a0262b3a29008fedcf3d434b90e8fa578ac8f250f5025\n\na21aa45045c0d4b0d785891b8be57496d62bc2396d01c24a34b40f3e2227ef07\n\na5cbe89bf1f3121eb2012e3c5bb5c237c613b8b615384be0f1cc92817a2f1efe\n\na6a7e46bd0e9ec67a1adec64af8fddee18ce019f731ee9cbf8341b35b2519dd9\n\nb573f4d58b1fe6309b90611dd1d1030d7a3d1eb8ddb18de6dc58eefa876820fd\n\nbe3248d97653e8f97cb8f69af260f03b19965489478211a5565b786e9f5d3c02\n\nca8980cb3bd286e41950d78555fd070eaf2d3bebf2751cb0d12a3eff0a41f829\n\ncd48523a6dced4054cce051d4dd8c06268cee375e56afbf59d724faa91c3e766\n\nd799ae8a017e76d22f1f35f271ebae9168b7712dce0ce86753edabd6e5f4f0d6\n\nded30dbc39e310ebbc17a9667a14e7f0f2e08999bfc5ebd4eae5c1840b82860a\n\ne7db388460d4e1f8d740018e6012af0ad785d3876a35c924db1f4982d7902db3\n\ne85c3d3ed49d44b1ec3af89d730e129d68a32212e911e6431f405e201597f6ed\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and intelligence organization](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[and the FortiGuard Security Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-01 - Fresh TOTOLINK Vulnerabilities Picked Up by Beastmode Mirai Campaign.pdf"
    ],
    "report_names": [
        "2022-04-01 - Fresh TOTOLINK Vulnerabilities Picked Up by Beastmode Mirai Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536198,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653764582,
    "ts_modification_date": 1653764582,
    "files": {
        "pdf": "https://archive.orkl.eu/b51436861d6774f73f08d37c1286848410a1f24b.pdf",
        "text": "https://archive.orkl.eu/b51436861d6774f73f08d37c1286848410a1f24b.txt",
        "img": "https://archive.orkl.eu/b51436861d6774f73f08d37c1286848410a1f24b.jpg"
    }
}