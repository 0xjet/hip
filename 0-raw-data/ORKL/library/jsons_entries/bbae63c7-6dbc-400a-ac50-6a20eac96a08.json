{
    "id": "bbae63c7-6dbc-400a-ac50-6a20eac96a08",
    "created_at": "2023-05-06T02:08:30.718418Z",
    "updated_at": "2025-03-27T02:15:35.711577Z",
    "deleted_at": null,
    "sha1_hash": "66e6f1612699201c685db827eaa6635400e5e6ac",
    "title": "2023-04-09 - LummaC2 BreakDown",
    "authors": "",
    "file_creation_date": "2023-05-05T01:52:25Z",
    "file_modification_date": "2023-05-05T01:52:25Z",
    "file_size": 3412619,
    "plain_text": "# LummaC2 BreakDown\n\n**[0xtoxin-labs.gitbook.io/malware-analysis/malware-analysis/lummac2-breakdown](https://0xtoxin-labs.gitbook.io/malware-analysis/malware-analysis/lummac2-breakdown#chrome-extensions-crx)**\n\nThis blog will be a bit different from my usual blogs, it will mainly contain scripts and some\nresearch I've spent on finding some of the things you'll read through the blog. I've tried to\ncover things that weren't covered in previous blogs that can be found on Lumma Stealer\nMalpedia entry​\n\n## The Phish\n\nThe phishing email pretends to be from Walmart and targets sellers on the Walmart\nMarketplace. The email claims that the recipient needs to confirm their contact and related\ninformation in order to continue selling on the platform.\nThe email instructs the recipient to\ndownload a file called \"Walmart Brand Portal.rar\" to update their information and suggests\ndisabling antivirus protection if the download doesn't work.\nClearly it's not a mail sent from\nWalmart and the archive will contain a malicious executable in it.\n\n\n-----\n\nPhishing Mail\n\n## Dynamic Triage Procedure\n\nIn many cases when I'm analyzing malwares I want to reach to the final payload rather than\ndealing with the initial loader binary.\nEvery analyst has it's own tricks of how would he find\nand dump the actual piece of malware that he wants to analyze; And I will share what is my\nfavorite tool when I want to get my hands quickly on the final payload.\n\n### PE-Sieve\n\n[​PE-Sieve is a great tool created by](https://github.com/hasherezade/pe-sieve) [hasherezade which:\n\"Scans a given process.](https://twitter.com/hasherezade)\n**_Recognizes and dumps a variety of potentially malicious implants (replaced/injected_**\n**_PEs, shellcodes, hooks, in-memory patches).\"_**\n\n### Dump Lumma Binary\n\n\n-----\n\nSo in order to dump the Lumma binary I will execute the executable which is stored inside of\nthe archive delivered by the phishing email, I will monitor the executable activity in Process\nhacker and wait for some internal process to be created as part of the injection process. (in\nthis case the injected process will be AddInProcess32.exe)\nStep 1 - Execute the payload:\n\nDynamic Execution\n\n**Step 2 - Use PE-Sieve on the Injected Process:**\n\nPeSieve Execution\n\n## Into The Lumma\n\nNow that we have the dumped payload, I will be going through some of the functionalities\nand capabilities that the Lumma Stealer has.\n\n### Control Flow Flattening\n\nLumma's developer added some CFF to the stealer code in order to make some hard time\non reversers to find their way through the right execution flow of the malware.\nThere are a lot\nof blogs talks about this obfuscation technique and how threat actors and malware\ndevelopers leverages this technique to slow down malware reversers (you can find several\nby the end of the blog under the References section)\n\n\n-----\n\nCFF in Lumma's binary\n\n[I've used SophosLabs emotet_unflatten_poc plugin in order to try and clean the decompiler](https://github.com/sophoslabs/emotet_unflatten_poc)\ncode abit, it helped by classifying each section as a Label and now it's abit more accessible\nand not requiring to scroll over the function alot:\n\n\n-----\n\nClearer Code\n\n### Strings Obfuscation\n\nI took a brief look at the strings presented in the extracted payload and witnessed that alot of\nthem are obfuscated:\n\nObfuscated Strings\n\n\n-----\n\nAfter doing a small research, I found out the Lumma obfuscates the strings by inserting the\nstring 576xed inside of them.\nThose strings are being deobfuscated by dedicated function\nwhich requires the obfuscated string as an input and afterward it returns the clean string.\n\nDeobfuscation Function\n\nI've created python script that will get all the xrefs for the strings deobfuscating function,\nextract the argument being passed to the function and then will deobfuscate it and write the\nstrings to a file:\n\nimport idc\n\nimport idautils\n\n​\n\nDECRYPTION_FUNCTION = 0x45DF86 # Change to the relevant function call\n\nSTRINGS_FILE_PATH = '' # Output file for the strings\n\nOBFUSCATOR_STRING = '576xed' # Might be changed in future builds\n\n​\n\ndef getArg(ref_addr):\n\nref_addr = idc.prev_head(ref_addr)\n\nif idc.print_insn_mnem(ref_addr) == 'push':\n\nif idc.get_operand_type(ref_addr, 0) == idc.o_imm:\n\nreturn(idc.get_operand_value(ref_addr, 0))\n\nelse:\n\nreturn None\n\n​\n\nstringsList = []\n\n​\n\nfor xref in idautils.XrefsTo(DECRYPTION_FUNCTION):\n\n\n-----\n\nargPtr = getArg(xref.frm)\n\nif not argPtr:\n\ncontinue\n\ndata = idc.get_bytes(argPtr, 100)\n\nobfuscatedData = data.split(b'\\x00\\x00')[0].replace(b'\\x00',b'').decode()\n\nstringsList.append(obfuscatedData.replace(OBFUSCATOR_STRING,\"\"))\n\n​\n\nprint(f'[+] {len(stringsList)} Strings were extracted')\n\n​\n\nout = open(STRINGS_FILE_PATH, 'w')\n\nfor string in stringsList:\n\nout.write(f'{string}\\n')\n\nout.close()\n\n[+] 135 Strings were extracted\n\n​\n\n################\n\n# OUTPUT FILE: #\n\n################\n\n​\n\n\\Local Extension Settings\\\n\n/Extensions/\n\n\nnkddgncdjgjfcddamfgcmfnlhccnimig\n\nNeoLine\n\ncphhlgmgameodnhkjdmkpanlelnlohao\n\n\n-----\n\nClover\n\nnhnkbkgjikgcigadomkphalanndcapjk\n\nLiquality\n\nkpfopkelmapcoipemfendmdcghnegimn\n\nTerra Station\n\nfhmfendgdocmcbmfikdcogofphimnkno\n\nAuro\n\ncnmamaachppnkjgnildpdmkaakejnhae\n\naeachknmefphepccionboohckonoeemg\n\nAuthenticator\n\nbhghoamapcdpbohphigoooaddinpkbai\n\nCyano\n\ndkdedlpgdmmkkfjabffeganieamfklkm\n\nByone\n\nLogin Data For Account\n\nOneKey\n\nNifty\n\njbdaocneiiinmjbjlgalhcelgbejmnid\n\nMath\n\niWlt\n\nkncchdigobghenbbaddojjnnaogfppfj\n\nEnKrypt\n\nkkpllkodjeloidieedojogacfhpaihoh\n\nWombat\n\namkmjjmmflddogmhpjloimipbofnfjih\n\n\n-----\n\nMEW CX\n\nnlbmnnijcnlegkjjpcfjclmcfggfefdm\n\nGuild\n\nnanjmdknhkinifnkgdcggcfnhdaammmj\n\nCoin98\n\ninfeboajgfhgbjpjbeppbkgnabfdkdaf\n\nLeaf\n\ncihmoadaighcejopammfbmddcmdekcje\n\nAuthy\n\nejbalbakoplchlghecdalmeeeajnimhm\n\nnkbihfbeogaeaoehlefnkodbefgpgknn\n\nTronLink\n\nibnejdfjmmkpcnlpebklmnkoeoihofec\n\nRonin Wallet\n\nfnjhmkhhmkbjkkabndcnnogagogbneec\n\nBinance Chain Wallet\n\nfhbohimaelbohpjbbldcngcnapndodjp\n\nYoroi\n\nafbcbjpbpfadlkmhmclhkeeodmamcflc\n\ngaedmjdfmmahhbjefcbgaolhhanlaolb\n\nSaturn\n\nbcopgchhojmggmffilplmbdicgaihlkp\n\nZilPay\n\nklnaejjgbibmhlephnhpmaofohgkpgkd\n\nPhantom\n\n\n-----\n\nbfnaelmomeimhlpmgjnjophhpkkoljpa\n\nhcflpincpppdclinealmandijcmnkbgn\n\nTemple\n\nookjlbkiijinhpmnjffcofjonbfbgaoc\n\nTezBox\n\nmnfifefkajgofkcjkemidiaecocnkjeh\n\nDAppPlay\n\nlodccjjbdhfakaekdiahmedfbieldgik\n\nBitClip\n\nijmpgkjfkbfhoebgogflfebnmejmfbml\n\nSteem Keychain\n\nHistory\n\nJaxx Liberty\n\ncjelfplplebdjjenllpjcblmjkfcffne\n\nBitApp\n\nfihkakfobkmkjojpchpfgcmhfjnmnfpi\n\nNetwork\\Cookies\n\nHistory\n\nPolymesh\n\njojhfeoedkpkglbfimdfabpdfjaoolaf\n\nICONex\n\nflpiciilemghbmfalicajoolhkkenfel\n\nNabox\n\nffnbelfdoeiohenkjibnmadjiehjhajb\n\nWeb Data\n\n\n-----\n\nLogin Data\n\naiifbnbfobpmeekipheeijimdpnlpgpp\n\nKeplr\n\ndmkamcknogkgcdfhhbddcghachkejeap\n\nSollet\n\nnlgbhdfgdhgbiamfdfmbikcdghidoadd\n\nCoinbase\n\nhnfanknocfeofbddgcijnmhnfnkdnaad\n\nGuarda\n\nhpglfhgfnhbgpjdenjgmdgoeiappafln\n\nEQUAL\n\nblnieiiffboillknjnepogjhkgnoapac\n\nlkcjlnjfpbikmcmbachjpdbijejflpcm\n\nNash Extension\n\nonofpnbbkehpmmoabgpcpmigafmmnjhl\n\nHycon Lite Client\n\nTrezor Password Manager\n\nimloifkgjagghnncjkhggdhalmcnfklk\n\nEOS Authenticator\n\noeljdldpnmdbchonielidgobddffflal\n\nGAuth Authenticator\n\nilgcnhelpchnceeipipijaljkblbcobl\n\nnknhiehlklippafakaeklbeglecifhad\n\nKHC\n\n\\Local State\n\n\n-----\n\n.txt\n\n%userprofile%\n\nWallets/Ethereum\n\nkeystore\n\n%appdata%\\Ethereum\n\n%localappdata%\\Kometa\\User\n\nChromium\n\n%localappdata%\\Chromium\\User Data\n\nEdge\n\n%localappdata%\\Microsoft\\Edge\\Us\n\n%appdata%\\Opera Software\\Op576xe\n\nChrome\n\n%localappdata%\\Google\\Chro\n\nMozilla Firefox\n\nWallets/Binance\n\napp-store.json\n\n%appdata%\\Binance\n\nKometa\n\nImportant Files/Profile\n\nOpera GX Stable\n\n%appdata%\\Opera Software\\Op576xe\n\nOpera Neon\n\nOpera Stable\n\n%appdata%\\Opera Software\\Op576xe\n\nWallets/Electrum\n\n\n-----\n\n%appdata%\\Electrum\\wallets\n\n%appdata%\\Mozilla\\Firefox\\Prof57\n\nSystem.txt\n\n### Chrome Extensions (CRX)\n\nLooking at the strings there is a lot of extensions names that Lumma targets, but the thing\nthat I was curious about were the 32 length lower case strings (for example:\n```\nilgcnhelpchnceeipipijaljkblbcobl) those strings are actually CRX IDs (Chrome\n\n```\nExtension ID) which by navigating to C:\\Users\\User\\AppData\\Local\\Google\\Chrome\\User\n```\nData\\Default\\Extensions and looking for the CRX ID the stealer will know whether or not\n\n```\nthe extension exists on the victims computer and if it does it will continue to exfiltrate the\nextension sensitive data.\n\nChrome Extensions Local Path\n\nI've created a python script that will lookup for those unique ID's in the previously extracted\nstrings file and fetch the name of the extension from google chrome webstore:\n\nimport re, requests\n\n​\n\n\n-----\n\nLUMMA_STRINGS = /Users/igal/malwares/Lumma/29.03.2023/LummaStrings.txt\n\nREGEX_PATTERN = '^[a-z]{32}$'\n\nstrings = open(LUMMA_STRINGS,'r').read()\n\ncrxExtensionList = re.findall(REGEX_PATTERN,strings,re.MULTILINE)\n\n​\n\n​\n\nfor crxId in crxExtensionList:\n\nurl = f'https://chrome.google.com/webstore/detail/{crxId}'\n\nresponseText = requests.get(url).text\n\ntry:\n\nstartIndex = responseText.index('itemprop=\"name\" content=\"') + len('itemprop=\"name\"\ncontent=\"')\n\nendIndex = responseText.index('\"', startIndex)\n\nextensionName = responseText[startIndex:endIndex]\n\nprint(f'[+] Extension name:{extensionName}, CRX ID:{crxId}')\n\nexcept ValueError:\n\ncontinue\n\n[+] Extension name:NeoLine, CRX ID:cphhlgmgameodnhkjdmkpanlelnlohao\n\n[+] Extension name:CLV Wallet, CRX ID:nhnkbkgjikgcigadomkphalanndcapjk\n\n[+] Extension name:Liquality Wallet, CRX ID:kpfopkelmapcoipemfendmdcghnegimn\n\n[+] Extension name:Auro Wallet, CRX ID:cnmamaachppnkjgnildpdmkaakejnhae\n\n[+] Extension name:Coin98 Wallet, CRX ID:aeachknmefphepccionboohckonoeemg\n\n[+] Extension name:authenticator, CRX ID:bhghoamapcdpbohphigoooaddinpkbai\n\n[+] Extension name:Cyano Wallet, CRX ID:dkdedlpgdmmkkfjabffeganieamfklkm\n\n[+] Extension name:iWallet, CRX ID:kncchdigobghenbbaddojjnnaogfppfj\n\n\n-----\n\n[+] Extension name:Enkrypt: Ethereum, Polkadot &amp; Canto Wallet, CRX\nID:kkpllkodjeloidieedojogacfhpaihoh\n\n[+] Extension name:Wombat - Gaming Wallet for Ethereum &amp; EOS, CRX\nID:amkmjjmmflddogmhpjloimipbofnfjih\n\n[+] Extension name:MEW CX - is now Enkrypt, CRX ID:nlbmnnijcnlegkjjpcfjclmcfggfefdm\n\n[+] Extension name:LeafWallet - Easy to use EOS wallet, CRX\nID:cihmoadaighcejopammfbmddcmdekcje\n\n[+] Extension name:MetaMask, CRX ID:nkbihfbeogaeaoehlefnkodbefgpgknn\n\n[+] Extension name:TronLink, CRX ID:ibnejdfjmmkpcnlpebklmnkoeoihofec\n\n[+] Extension name:Ronin Wallet, CRX ID:fnjhmkhhmkbjkkabndcnnogagogbneec\n\n[+] Extension name:Binance Wallet, CRX ID:fhbohimaelbohpjbbldcngcnapndodjp\n\n[+] Extension name:Math Wallet, CRX ID:afbcbjpbpfadlkmhmclhkeeodmamcflc\n\n[+] Extension name:Authy, CRX ID:gaedmjdfmmahhbjefcbgaolhhanlaolb\n\n[+] Extension name:Hycon Lite Client, CRX ID:bcopgchhojmggmffilplmbdicgaihlkp\n\n[+] Extension name:ZilPay, CRX ID:klnaejjgbibmhlephnhpmaofohgkpgkd\n\n[+] Extension name:Phantom, CRX ID:bfnaelmomeimhlpmgjnjophhpkkoljpa\n\n[+] Extension name:KHC, CRX ID:hcflpincpppdclinealmandijcmnkbgn\n\n[+] Extension name:Temple - Tezos Wallet, CRX ID:ookjlbkiijinhpmnjffcofjonbfbgaoc\n\n[+] Extension name:TezBox - Tezos Wallet, CRX ID:mnfifefkajgofkcjkemidiaecocnkjeh\n\n[+] Extension name:DAppPlay, CRX ID:lodccjjbdhfakaekdiahmedfbieldgik\n\n[+] Extension name:Polymesh Wallet, CRX ID:jojhfeoedkpkglbfimdfabpdfjaoolaf\n\n[+] Extension name:ICONex, CRX ID:flpiciilemghbmfalicajoolhkkenfel\n\n[+] Extension name:Yoroi, CRX ID:ffnbelfdoeiohenkjibnmadjiehjhajb\n\n[+] Extension name:Station Wallet, CRX ID:aiifbnbfobpmeekipheeijimdpnlpgpp\n\n[+] Extension name:Keplr, CRX ID:dmkamcknogkgcdfhhbddcghachkejeap\n\n[+] Extension name:Byone, CRX ID:nlgbhdfgdhgbiamfdfmbikcdghidoadd\n\n\n-----\n\n[+] Extension name:Coinbase Wallet extension, CRX\nID:hnfanknocfeofbddgcijnmhnfnkdnaad\n\n[+] Extension name:Guarda, CRX ID:hpglfhgfnhbgpjdenjgmdgoeiappafln\n\n[+] Extension name:Trezor Password Manager, CRX ID:imloifkgjagghnncjkhggdhalmcnfklk\n\n[+] Extension name:EOS Authenticator, CRX ID:oeljdldpnmdbchonielidgobddffflal\n\n[+] Extension name:GAuth Authenticator, CRX ID:ilgcnhelpchnceeipipijaljkblbcobl\n\n[+] Extension name:Nabox Wallet, CRX ID:nknhiehlklippafakaeklbeglecifhad\n\n### Dynamic API Resolve\n\nLumma hides some of its APIs by hashing then using the MurmurHash2 hashing algorithm\n, it can be identified by the const: 0x5bd1e995:\n\nHashing Const References\n\nLumma will pass two arguments to the API resolving function:\n\n1. 1.\n\nThe hash of the wanted API\n\n2. 2.\n\nThe DLL which contains the API\n\n\n-----\n\nAPI Resolving Function\n\nI have two scripts that I wrote for this part, the first script is IDA script that will get all the xrefs\nto the API resolving function, extract the hash and the API hash, and will save the output to a\ntext file:\n\nimport idc\n\nimport idautils\n\n​\n\nAPI_FUNCTION = 0x471958 # Change to the relevant function call\n\nAPIS_FILE_PATH = '' # Output file for the strings\n\n​\n\napiDict = {}\n\n​\n\ndef getDLLRef(hash_addr):\n\nref_addr = idc.prev_head(hash_addr)\n\nif idc.print_insn_mnem(ref_addr) == 'push':\n\n\n-----\n\nif idc.get_operand_type(ref_addr, 0) == idc.o_imm:\n\ndll_addr = idc.get_operand_value(ref_addr, 0)\n\nreturn idc.get_bytes(dll_addr, 50).split(b'\\x00\\x00')[0].replace(b'\\x00',b'').decode()\n\nreturn None\n\n​\n\ndef getHashDict(ref_addr):\n\nref_addr = idc.prev_head(ref_addr)\n\nif idc.print_insn_mnem(ref_addr) == 'push':\n\nif idc.get_operand_type(ref_addr, 0) == idc.o_imm:\n\nhashVal = hex(idc.get_operand_value(ref_addr, 0))\n\nif hashVal not in apiDict or apiDict[hashVal] == None:\n\ndllVal = getDLLRef(ref_addr)\n\napiDict[hashVal] = dllVal\n\n​\n\nfor xref in idautils.XrefsTo(API_FUNCTION):\n\ngetHashDict(xref.frm)\n\n​\n\nprint(f'[+] {len(apiDict)} API hashes were extracted')\n\n​\n\nout = open(APIS_FILE_PATH, 'w')\n\nfor k, v in apiDict.items():\n\nout.write(f'{k} - {v}\\n')\n\nout.close()\n\n​\n\n[+] 18 API hashes were extracted\n\n\n-----\n\n​\n\n################\n\n# OUTPUT FILE: #\n\n################\n\n​\n\n0xe8ff1073 - crypt32.dll\n\n0x864087d1 - crypt32.dll\n\n0x7328f505 - kernel32.dll\n\n0xc40f97d4 - advapi32.dll\n\n0x507048c2 - winhttp.dll\n\n0x406457c2 - winhttp.dll\n\n0x7aa0edcc - winhttp.dll\n\n0xb72f0de - winhttp.dll\n\n0x59886bc0 - winhttp.dll\n\n0x76b029a - winhttp.dll\n\n0xf9f57cf0 - winhttp.dll\n\n0xe268a0c1 - winhttp.dll\n\n0xab3372e8 - winhttp.dll\n\n0x5658bf2e - KernelBase.dll\n\n0x23fef64a - advapi32.dll\n\n0x5f086d32 - kernel32.dll\n\n0xa2f80070 - kernel32.dll\n\n0x2f9959e0 - kernel32.dll\n\n\n-----\n\nThe second script will extract the hashes and the DLLs names from the text file, and based\non the DLL name it will be loaded using PEfile, and iterate through the DLL exports, hash\nthem using murmurhash2 and compare it to the given hash: (NOTE: The seed in this case\nwas 0x20 but it might be possible changed in future builds)\n\nimport pefile\n\nfrom murmurhash2 import murmurhash2\n\n​\n\nDLLS_PATH = '/Users/igal/malwares/Lumma/29.03.2023/dlls/' # can be replaced with\nsystem32 folder\n\nLUMMA_API_HASHES = '/Users/igal/malwares/Lumma/29.03.2023/LummaApiHashes.txt'\n\n​\n\nSEED = 0x20 # might be changed in upcoming builds\n\n​\n\ndef hashDllAPI(dllName, apiHash):\n\npe = pefile.PE(dllName)\n\nfor export in pe.DIRECTORY_ENTRY_EXPORT.symbols:\n\ntry:\n\nexpName = export.name\n\nhashValue = murmurhash2(expName, SEED)\n\nif hex(hashValue) == apiHash:\n\nreturn expName.decode()\n\nexcept AttributeError:\n\ncontinue\n\n​\n\napiHashesFile = open(LUMMA_API_HASHES,'r').read()\n\nlines = apiHashesFile.split('\\n')\n\n\n-----\n\n​\n\n​\n\nfor line in lines:\n\nargs = line.split(' - ')\n\ndllName = hashDllAPI(f'{DLLS_PATH}{args[1]}', args[0])\n\nprint(f'[+] {args[0]} - {dllName}')\n\n[+] 0xe8ff1073 - CryptStringToBinaryA\n\n[+] 0x864087d1 - CryptUnprotectData\n\n[+] 0x7328f505 - ExpandEnvironmentStringsW\n\n[+] 0xc40f97d4 - GetCurrentHwProfileA\n\n[+] 0x507048c2 - WinHttpOpenRequest\n\n[+] 0x406457c2 - WinHttpConnect\n\n[+] 0x7aa0edcc - WinHttpCloseHandle\n\n[+] 0xb72f0de - WinHttpSendRequest\n\n[+] 0x59886bc0 - WinHttpWriteData\n\n[+] 0x76b029a - WinHttpReceiveResponse\n\n[+] 0xf9f57cf0 - WinHttpOpen\n\n[+] 0xe268a0c1 - WinHttpSetTimeouts\n\n[+] 0xab3372e8 - WinHttpAddRequestHeaders\n\n[+] 0x5658bf2e - IsWow64Process2\n\n[+] 0x23fef64a - GetUserNameA\n\n[+] 0x5f086d32 - GetPhysicallyInstalledSystemMemory\n\n[+] 0xa2f80070 - GetComputerNameA\n\n[+] 0x2f9959e0 - GetSystemDefaultLocaleName\n\n\n-----\n\n## Yara Rule\n\nrule Win_LummaC2 {\n\nmeta:\n\nauthor = \"0xToxin\"\n\ndescription = \"LummaC2 Strings\"\n\nstrings:\n\n$obfuscatorString = \"576xed\" ascii wide\n\n$s1 = \"dp.txt\" ascii wide\n\n$s2 = \"c2sock\" ascii wide\n\n$s3 = \"TeslaBrowser\" ascii wide\n\n$s4 = \"Software.txt\" ascii wide\n\ncondition:\n\nuint16(0) == 0x5a4d and all of ($s*) and #obfuscatorString > 10 and filesize < 1500KB\n\n}\n\n[​Yara Hunt of the rule](https://www.unpac.me/yara/results/76b7b685-08a5-49db-9a23-4d227dd0c190)\n\n## Summary\n\nIn this blog I went over some techniques used by the Lumma stealer including the hashing\nalgorithim used in the API hashing procedure, the strings obfuscation and some Google\nChrome extensions research.\nIf you want to learn more about how Lumma exfiltrates it data,\ncheck the blogs in the references below.\n\n## IOCs\n\nURLs:\n\nhttps://marketplace.walmart[.]lc/download.php\n\n\n-----\n\nFiles:\n\nWalmart Brand Portal.rar [d69520637a73226a61c09298295145923fc60a06584528cb1f05a530479a7a36​](https://bazaar.abuse.ch/sample/d69520637a73226a61c09298295145923fc60a06584528cb1f05a530479a7a36/)\nWalmart Brand Portal.exe [9b9388c1b9e9417df5ca4e883ef595455932dfce24ca1dad9897d506aecdac2a​](https://bazaar.abuse.ch/sample/9b9388c1b9e9417df5ca4e883ef595455932dfce24ca1dad9897d506aecdac2a)\nLumma Binary [19fefb958bd9c9280d07754ab903022a3dc9fc380a6964733a1dcc016aba8150​](https://bazaar.abuse.ch/sample/19fefb958bd9c9280d07754ab903022a3dc9fc380a6964733a1dcc016aba8150/)\nC2:\n\n82.117.255[.]80/c2sock\n\nUser Agent:\n\nTeslaBrowser/5.5\n\n## References\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-09 - LummaC2 BreakDown.pdf"
    ],
    "report_names": [
        "2023-04-09 - LummaC2 BreakDown.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1683338910,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1683251545,
    "ts_modification_date": 1683251545,
    "files": {
        "pdf": "https://archive.orkl.eu/66e6f1612699201c685db827eaa6635400e5e6ac.pdf",
        "text": "https://archive.orkl.eu/66e6f1612699201c685db827eaa6635400e5e6ac.txt",
        "img": "https://archive.orkl.eu/66e6f1612699201c685db827eaa6635400e5e6ac.jpg"
    }
}