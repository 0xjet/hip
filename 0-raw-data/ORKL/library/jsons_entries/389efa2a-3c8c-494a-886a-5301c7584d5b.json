{
    "id": "389efa2a-3c8c-494a-886a-5301c7584d5b",
    "created_at": "2023-01-12T15:03:50.63058Z",
    "updated_at": "2025-03-27T02:05:38.02977Z",
    "deleted_at": null,
    "sha1_hash": "1a6a6f40d6e03039b842870b452368d53def8394",
    "title": "2022-03-30 - Malicious Word File Targeting Corporate Users Being Distributed",
    "authors": "",
    "file_creation_date": "2022-05-28T23:24:09Z",
    "file_modification_date": "2022-05-28T23:24:09Z",
    "file_size": 1483193,
    "plain_text": "# Malicious Word File Targeting Corporate Users Being Distributed\n\n**asec.ahnlab.com/en/33186/**\n\nMarch 30, 2022\n\nThe ASEC analysis team discovered a Word file that seems to target corporate users. The\nfile contains an image that prompts users to enable macros like other malicious files. To trick\nusers into thinking that this is an innocuous file, it shows information related to improving\nGoogle account security when the macro is run. Ultimately, it downloads additional malware\nfiles and leaks user information.\n\nWhen the file is run, it shows a warning image that mentions ‘file created in public institution\nform HWP’ in Korean, prompting users to run the VBA macro existing within the file. It also\nhas memos on the right side to make it look as if the file is created by Microsoft. The author\non the document properties is displayed as Microsoft as well.\n\n\n-----\n\nFigure 1. Word file\n\n\n-----\n\nFigure 2. Document properties\n\nWhen users press the Enable Content button, the information about improving the Google\naccount security is displayed as shown below.\n\n\n-----\n\nFigure 3. Content shown when macro is enabled\nTo make it difficult to check the macro code included in the document, VBA Project has a\npassword set for the document.\n\nFigure 4. VBA Project set with a password\nThe confirmed macro code is automatically run through the AutoOpen function and performs\nmalicious activities through the RunFE() function.\n\n\n-----\n\n```\nSub AutoOpen()\n  Call CTD\n  Dim rfRes As Long\n  rfRes = RunFE()\n  If rfRes = 1 Then\n    Call HideInlineShapes\n    Call ShowShapes\n    Call CommnetDelete\n  End If\n'    Call ShowInlineShapes\n'    Call HideShapes\nEnd Sub\n\n```\nThe RunFE() function has the download URL encoded with Base64 and certain Hex values.\n\nFigure 5. Part of macro code\nThe macro code has two download URLs. This is likely done to download the malware that\nfits the user’s PC environment. The decoding result of the encoded URL is as follows:\n\nx86 environment –\nhxxp://4w9H8PS9.naveicoipc[.]tech/ACMS/7qsRn3sZ/7qsRn3sZ32.acm\nx64 environment –\nhxxp://4w9H8PS9.naveicoipc[.]tech/ACMS/7qsRn3sZ/7qsRn3sZ64.acm\n\nWhen the connection fails, a message box telling user to open the document after\nconnecting to the Internet appears.\n\n\n-----\n\nFigure 6. Created message box\nIf the code can access the download URL, the encoded PE data existing in the address is\ndownloaded. The downloaded PE data is run after it is decoded and injected into the Word\nprocess.\n\nInside the injected code is a code that checks if AhnLab products’ process exists within the\ncurrent processes.\n\nFigure 7. Code for checking AhnLab products’ processes\nIf there is a process named v3l4sp.exe (V3Lite), the code will not perform additional\nmalicious behaviors and terminate itself. As such, the code does not perform additional\nmalicious behavior for individual users using V3Lite. The case is different for company users,\nhowever.\n\nIt drops IntelRST.exe to the %ProgramData%\\Intel folder after checking the process and\nuses the following registry to make IntelRST.exe run continuously.\n\n\n-----\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\IntelCUI\nData: “C:\\ProgramData\\Intel\\IntelRST.exe”\n\nIt also runs IntelRST.exe with the privilege escalated via UAC Bypass using winver.exe and\nComputerDefaults.exe. IntelRST.exe is registered as an exclusion for Windows Defender\nthrough the following command.\n\ncmd.exe /c powershell -Command Add-MpPreference -ExclusionPath\n“C:\\ProgramData\\Intel\\IntelRST.exe”\n\nThe figure below shows the process tree that is run.\n\nFigure 8. Process tree\nThe code then sends the user PC information to hxxp://naveicoipc[.]tech/post.php and\nattempts to access hxxp://naveicoipc[.]tech/7qsRn3sZ/7qsRn3sZ_[user\nname]_/fecommand.acm. Since the URL cannot be accessed, the team could not find out\nwhat the code does after.\n\nThe team also found another word file (file name: Case Mediation\nStatement_BA6Q318N.doc) but could not check its content as it was protected with a\npassword. The download URLs checked from the VBA macro included in the document are\nas follows:\n\nx86 – hxxp://MOmls4ii.naveicoipa[.]tech/ACMS/BA6Q318N/BA6Q318N32.acm\nx64 – hxxp://MOmls4ii.naveicoipa[.]tech/ACMS/BA6Q318N/BA6Q318N64.acm\n\n\n-----\n\nFigure 9. Additionally found malicious Word file 1\nAs seen from the figure, among the documents distributed with the malicious macro of this\ntype, there are files protected with passwords. The figure below shows another Word file (file\nname: Binance_Guide (1).doc) that the team found.\n\nx86 environment –\nhxxp://uzzmuqwv.naveicoipc[.]tech/ACMS/1uFnvppj/1uFnvppj32.acm\nx64 environment –\nhxxp://uzzmuqwv.naveicoipc[.]tech/ACMS/1uFnvppj/1uFnvppj64.acm\n\nFigure 10. Additionally found malicious Word file 2\n\n\n-----\n\nAs malicious Word files targeting Korean users have been continually discovered, users\nshould take extreme caution. They must configure appropriate security settings to prevent\nmalicious macros from being automatically enabled and refrain from running files with\nunknown sources.\n\n**[File Detection]**\nDownloader/DOC.Generic\nTrojan/Win.Generic.C5025270\n\n**[IOC]**\nc156572dd81c3b0072f62484e90e47a0\nc9e8b9540671052cb4c8f7154f04855f\n809fff6e5b2aa66aa84582dfc55e7420\n37505b6ff02a679e70885ccd60c13f3b\nhxxp://4w9H8PS9.naveicoipc[.]tech/ACMS/7qsRn3sZ/7qsRn3sZ64.acm\nhxxp://4w9H8PS9.naveicoipc[.]tech/ACMS/7qsRn3sZ/7qsRn3sZ32.acm\nhxxp://naveicoipc[.]tech/post.php\nhxxp://MOmls4ii.naveicoipa[.]tech/ACMS/BA6Q318N/BA6Q318N32.acm\nhxxp://MOmls4ii.naveicoipa[.]tech/ACMS/BA6Q318N/BA6Q318N64.acm\nhxxp://uzzmuqwv.naveicoipc[.]tech/ACMS/1uFnvppj/1uFnvppj32.acm\nhxxp://uzzmuqwv.naveicoipc[.]tech/ACMS/1uFnvppj/1uFnvppj64.acm\n\n**Subscribe to AhnLab’s next-generation threat intelligence platform ‘AhnLab TIP’ to**\n**check related IOC and detailed analysis information.**\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:VBA Macro,](https://asec.ahnlab.com/tag/vba-macro/) [Word](https://asec.ahnlab.com/en/tag/word-en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-30 - Malicious Word File Targeting Corporate Users Being Distributed.pdf"
    ],
    "report_names": [
        "2022-03-30 - Malicious Word File Targeting Corporate Users Being Distributed.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535830,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1653780249,
    "ts_modification_date": 1653780249,
    "files": {
        "pdf": "https://archive.orkl.eu/1a6a6f40d6e03039b842870b452368d53def8394.pdf",
        "text": "https://archive.orkl.eu/1a6a6f40d6e03039b842870b452368d53def8394.txt",
        "img": "https://archive.orkl.eu/1a6a6f40d6e03039b842870b452368d53def8394.jpg"
    }
}