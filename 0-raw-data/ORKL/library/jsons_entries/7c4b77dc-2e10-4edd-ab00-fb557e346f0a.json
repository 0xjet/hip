{
    "id": "7c4b77dc-2e10-4edd-ab00-fb557e346f0a",
    "created_at": "2023-01-12T15:04:38.570087Z",
    "updated_at": "2025-03-27T02:16:25.599938Z",
    "deleted_at": null,
    "sha1_hash": "e1030f278cd33eba34a284c6ad0d5a350b1da9eb",
    "title": "2021-02-14 - Arm'd & Dangerous malicious code, now native on apple silicon",
    "authors": "",
    "file_creation_date": "2022-05-29T01:23:57Z",
    "file_modification_date": "2022-05-29T01:23:57Z",
    "file_size": 3899281,
    "plain_text": "# Objective-See's Blog\n\n**objective-see.com/blog/blog_0x62.html**\n\nArm'd & Dangerous\n\nmalicious code, now native on apple silicon\n\nby: Patrick Wardle / February 14, 2021\n\nüìù üëæ Want to play along?\n[I‚Äôve uploaded a sample (password: infect3d).](https://objective-see.com/downloads/blog/blog_0x62/GoSearch.zip)\n\n...please don‚Äôt infect yourself!\n\n## Background\n\n[Thanks to the amazing support of the ‚ÄúFriends of Objective-See‚Äù (such as](https://objective-see.com/friends.html) [Jamf and](https://www.jamf.com/?utm_source=objective-see&utm_medium=sponsored-link&utm_campaign=next-gen-security&utm_content=2021-02-05_protect)\n[1Password) and my amazing patrons, I recently was able to step down from my 9-5 job to](https://1password.com/?utm_medium=parnter&utm_source=Objective-See&utm_campaign=gp&utm_content=sponsorship)\nfocus exclusively on all things Objective-See, including:\n\n[üõ† Objective-See‚Äôs free, open-source tools](https://objective-see.com/products.html)\n[üìö The free, ‚ÄúThe Art of Mac Malware‚Äù book series](https://taomm.org/)\n[üë• The community focused ‚ÄúObjective by the Sea‚Äù Mac security conference](https://objectivebythesea.com/v4/)\n\nOne of my main focuses has been working to (re)build all of Objective-See‚Äôs tools to run\n[natively on Apple‚Äôs new M1 systems. For example LuLu now runs natively on Apple Silicon:](https://objective-see.com/products/lulu.html)\n\nLuLu, now native on Apple Silicon (M1).\nM1 (aka ‚ÄúApple Silicon‚Äù) is Apple‚Äôs new (system on a) chip. As an arm-based SoC, the CPU\nsupports an `arm64 ( AArch64 ) instruction set architecture (ISA).`\n\n\n-----\n\nThe arm64 binary file format has been used by Apple s iOS and tvOS for many years.\n\nThus, in order for a binary to natively run on an M1 system (2021 MacBook Air, MacBook\nPro, etc.) it must be compiled as an Mach-O 64-bit arm64 binary ‚Ä¶which means developers\nmust (re)compile their applications.\n\n‚ÄúBut wait!‚Äù you might say, ‚ÄúI know can still run many older applications on my shiny new M1\n_system!?‚Äù. And you are correct! Apple (wisely) realized that ‚Äúbackwards compatibility‚Äù was_\nessential to ensure wide-spread customer adoption of their new M1 Mac systems ‚Ä¶and thus\nreleased Rosetta(2).\n\n\"\n\nRosetta is a translation process that allows users to run apps that contain x86_64\ninstructions on Apple silicon. \"\n\nTo the user, Rosetta is mostly transparent. If an executable contains only Intel\ninstructions, macOS automatically launches Rosetta and begins the translation\nprocess. When translation finishes, the system launches the translated executable in\nplace of the original. However, the translation process takes time, so users might\nperceive that translated apps launch or run more slowly at times.\n\nThe system prefers to execute an app's arm64 instructions on Apple silicon.\" -Apple\n\nAs noted in the quotation above, Rosetta will transparently translate `x86_64 (Intel)`\ninstructions into native `arm64 instruction so older applications can run (almost) seamlessly`\non M1 systems.\n\nHowever two points to note:\n\nNon- arm64 code will not run natively on M1 systems (the CPU only ‚Äúspeaks‚Äù `arm64 )`\n‚Ä¶it has to be translated first!\nAs `arm64 code does not have to be translated, applications (re)compiled for M1 will`\nrun natively, and thus faster. And won‚Äôt be subject to any issues or nuances of Rosetta.\n\nFor more information on M1 and Rosetta, see Apple's documentation:\n\n[About the Rosetta Translation Environment.](https://developer.apple.com/documentation/apple_silicon/about_the_rosetta_translation_environment)\nBased on the fact that native ( arm64 ) applications run faster (as they avoid the need for\nruntime translation), and that Rosetta (though amazing), has a few bugs (that may prevent\ncertain older apps from running), developers are wise to (re)compile their applications for\nM1!\n\n\n-----\n\n```\n 1Process:        oahd helper [36752]\n 2Path:         /Library/Apple/*/oahd-helper\n 3Identifier:      oahd-helper\n 4Version:        203.13.2\n 5Code Type:       ARM-64 (Native)\n 6Parent Process:    oahd [506]\n 7Responsible:      oahd [506]\n 8User ID:        441\n 9\n10Date/Time:       2021-02-12 10:34:15.107 -1000\n11OS Version:      macOS 11.1 (20C69)\n12\n13Crashed Thread:    0 Dispatch queue: com.apple.main-thread\n\n```\nLost in Translation ...a Rosetta(2) Crash.\n...hence why I'm working on (re)compiling all of Objective-See's tools to natively run on M1!\n\n## Identifying Native M1 Code\n\nAs I was working on rebuilding my tools to achieve native M1 compatibility, I pondered the\npossibility that malware writers were also spending their time in a similar manner. At the end\nof the day, malware is simply software (albeit malicious), so I figured it would make sense\nthat (eventually) we‚Äôd see malware built to execute natively on Apple new M1 systems.\n\nBefore going off hunting for native M1 malware, we need have to answer the question, ‚ÄúHow\n_can we determine if a program was compiled natively for M1?‚Äù Well, in short, it will contain_\n```\narm64 code! OK, and how do we ascertain this?\n\n```\nOne simple way is via the macOS‚Äôs built-in `file tool (or` `lipo -archs ). Using this tool,`\nwe can examine a binary to see if it contains compiled `arm64 code.`\n\nLet‚Äôs look at Objective-See‚Äôs [LuLu:](https://objective-see.com/products/lulu.html)\n```\n% file /Applications/LuLu.app/Contents/MacOS/LuLu\nLuLu.app/Contents/MacOS/LuLu: Mach-O universal binary with 2 architectures: \n [x86_64:Mach-O 64-bit executable x86_64] [arm64:Mach-O 64-bit executable arm64]\nLuLu.app/Contents/MacOS/LuLu (for architecture arm64): Mach-O 64-bit executable\narm64\nLuLu.app/Contents/MacOS/LuLu (for architecture x86_64): Mach-O 64-bit executable\nx86_64\n\n```\nAs LuLu has been rebuilt to natively run on M1 systems, we can see it contains `arm64`\ncode (\" Mach-O 64-bit executable arm64 \").\n\nIn order to maintain compatibility with older non-M1 systems, LuLu also contains native Intel\n(x86_64) code.\n\nA binary that contains code to run on multiple architectures (e.g. Intel and Apple Silicon), is\ncalled a \"Universal\" or (more traditionally) a \"fat\" binary.\n\n\n-----\n\nAt run time, macOS will automatically select the correct (native) architecture.\nOn the other hand, programs that have not been (re)built for M1 systems, will not have the\nany `arm64 code within them. For example, let‚Äôs look at` [BlockBlock (which I‚Äôve yet to](https://objective-see.com/products/blockblock.html)\nrecompile):\n```\n% file BlockBlock.app/Contents/MacOS/BlockBlock \nBlockBlock.app/Contents/MacOS/BlockBlock: Mach-O 64-bit executable x86_64\n\n```\nAs BlockBlock currently on contains Intel ( x86_64 ) code, it will not run natively on M1\nsystems ‚Ä¶and instead will have to be translated at runtime via Rosetta(2) in order to\nexecute.\n\nOk, so now we know what how to identify if program has been natively build to M1 systems.\nTime to go hunting!\n\n## Malicious Code ‚Ä¶now Arm‚Äôd?\n\nSince I‚Äôm an independent macOS security researcher, I don‚Äôt have access private or\n[proprietary malware collections or feeds. Luckily VirusTotal is generous enough to offer (free)](https://www.virustotal.com/gui/home/search)\nresearcher accounts. Mahalo! ÔøΩ\n\nVirusTotal also supports a wide range of search modifiers, that will be essential in our hunt\nfor malicious (native M1) code.\n\n[Consulting their documentation, we find several relevant search modifiers, including:](https://support.virustotal.com/hc/en-us/articles/360001385897-File-search-modifiers)\n```\n   macho (type)\n\n```\nThe file is a `Mach-O (Apple) executable.`\n```\n   arm (tag)\n\n```\nThe file contains `ARM code/instructions.`\n```\n   64bits (tag)\n\n```\nThe file contains `64-bit code`\n```\n   multi-arch (tag)\n\n```\nThe file contains support for multiple architectures (i.e. its a universal/fat binary).\n```\n   signed (tag)\n\n```\nThe file is signed.\n\nFrom these we can craft a query that should give us a list of candidate files.\n\nSome of the aforementioned tags are used simply to pare down the list (but might incur false\nnegatives).\n\n\n-----\n\nFor example, it seems reasonable to assume that if malware authors are natively compiling\ncode for M1 systems this code will be found within a universal/fat binary such their malicious\ncreations will retain compatibility with older (Intel-based). As such, we leverage the ‚Äúmultiarch‚Äù tag. Similarly since M1 systems will be running Big Sur which requires code to be\nsigned, we assume the malware will be signed (and thus leverage the ‚Äúsigned‚Äù tag).\n\nOf course just combining these tags will yield tens of thousands of results, as there are a ton\nof legitimate multi-architecture `Mach-O binaries! So, let‚Äôs add another search query to look`\nfor binaries that are flagged by at least two anti-virus engines. (Yes, this will limit us to known\nmalware, but the assumption is that as we‚Äôre looking at universal binaries, the detection will\nlikely be due to the Intel code).\n\nAs such, our final search query is: `type:macho tag:arm tag:64bits tag:multi-arch`\n```\ntag:signed positives:2+\n\n```\n‚Ä¶which results in 255 matches:\n\nCandidate Matches.\n\n\n-----\n\nDigging thru these, many are purely iOS binaries (that true, are universal binaries, but in the\nsense that they are compiled to run on multiple iOS architectures e.g. `armv7,` `armv64 ‚Ä¶`\nnot macOS). A quick triage indicates these iOS files are largely flagged due to their relation\nto jailbreaks, and/or are known iOS malware:\n\nA (known) iOS Jailbreak Sample.\nI didn't find a way to create a search that would filter out iOS binaries. Though VirusTotal\nsupports tags such as \"iPhone\" and \"iOS\" and inversion logic (e.g. \"NOT tag:iPhone\"), these\nweren't applicable as the files themselves had not been tagged with these tags.\nIf you have suggestion how to create a search query that ignores iOS files, I‚Äôd love to learn\nhow!\n\nSkipping over the iOS binaries, we soon find a promising candidate, a file named\n```\nGoSearch22 ( SHA-256:\nb94e5666d0afc1fa49923c7a7faaa664f51f0581ec0192a08218d68fb079f3cf ):\n\n```\n\n-----\n\nA Promising Candidate!\n‚Ä¶is this malicious code compiled to run natively on Apple‚Äôs new M1 systems?\n\n## Triaging GoSearch22\n\nFirst, let‚Äôs confirm this indeed is a macOS (vs. iOS) binary ‚Ä¶that can run natively on M1\nsystems:\n```\n$ file GoSearch \nGoSearch: Mach-O universal binary with 2 architectures: \n [x86_64:Mach-O 64-bit executable x86_64] [arm64:Mach-O 64-bit executable arm64]\nGoSearch (for architecture x86_64): Mach-O 64-bit executable x86_64\nGoSearch (for architecture arm64): Mach-O 64-bit executable arm64\n\n```\nSo far, looks good! It‚Äôs universal (fat) Mach-O binary, that supports both Intel ( x86_64 ) and\nApple Silicon ( arm64 ). However to be sure, let‚Äôs track down the full application bundle, and\ncheck its `Info.plist file.`\n\nThanks to VirusTotal‚Äôs ‚ÄòRelations‚Äô logic, we can track down the binary‚Äôs parent ‚Ä¶a full\n[application bundle, unsurprisingly named GoSearch22.app.](https://www.virustotal.com/gui/file/6a79efe8e690d18292c2f47b33f7001d9adde6439a4be981232a757c5d12f611/details)\n\nFirst, let‚Äôs double check the standalone binary we uncovered matches the binary in the\napplication bundle:\n```\n% shasum -a256 GoSearch22.app/Contents/MacOS/GoSearch22 \nb94e5666d0afc1fa49923c7a7faaa664f51f0581ec0192a08218d68fb079f3cf\n% shasum -a256 GoSearch/GoSearch \nb94e5666d0afc1fa49923c7a7faaa664f51f0581ec0192a08218d68fb079f3cf\n\n```\n‚Ä¶as expected they match. This is good news, as having a full application bundle (vs. just the\napplication‚Äôs binary) provides a wealth of additional information.\n\n\n-----\n\nFor example in the application s `Info.plist file, we can confirm that indeed this is an`\napplication, compatible with macOS (not iOS):\n```\n% cat GoSearch/GoSearch22.app/Contents/Info.plist \n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\"\n\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n<plist version=\"1.0\">\n<dict>\n <key>CFBundleExecutable</key>\n <string>GoSearch22</string>\n <key>CFBundleIdentifier</key>\n <string>com.GoSearch22</string>\n <key>CFBundleInfoDictionaryVersion</key>\n <string>6.0</string>\n <key>CFBundleName</key>\n <string>GoSearch22</string>\n <key>CFBundlePackageType</key>\n <string>APPL</string>\n <key>CFBundleShortVersionString</key>\n <string>1.0</string>\n <key>CFBundleSupportedPlatforms</key>\n <array>\n  <string>MacOSX</string>\n </array>\n <key>CFBundleVersion</key>\n <string>146</string>\n <key>LSMinimumSystemVersion</key>\n <string>10.12</string>\n <key>LSMultipleInstancesProhibited</key>\n <true/>\n <key>LSUIElement</key>\n <true/>\n <key>NSAppTransportSecurity</key>\n <dict>\n  <key>NSAllowsArbitraryLoads</key>\n  <true/>\n </dict>\n <key>NSPrincipalClass</key>\n <string>NSApplication</string>\n</dict>\n</plist>\n\n```\n‚Ä¶specifically note that the `CFBundleSupportedPlatforms key is set to an array containing`\n(only) `MacOSX .`\n\nHooray, so we‚Äôve succeeding in finding a macOS program containing native M1 ( arm64 )\ncode ‚Ä¶that is detected as malicious! This confirms malware/adware authors are indeed\nworking to ensure their malicious creations are natively compatible with Apple‚Äôs latest\nhardware. ÔøΩ\n\n\n-----\n\nIt is also important to note that `GoSearch22 was indeed signed with an Apple developer ID`\n( hongsheng yan ), on November 23rd, 2020:\n\nSigned w/ an Apple Developer ID.\n‚Ä¶what is not known is if Apple notarized that code. We cannot answer this question,\nbecause at this time Apple has (now) revoked the certificate:\n\n\n-----\n\nCertificate, now Revoked.\nWhat we do know is as this binary was detected in the wild (and submitted by a user via an\nObjective-See tool) ‚Ä¶so whether it was notarized or not, macOS users were infected.\n\nAs Apple has revoked the certificate, the malicious application will no longer run on macOS\n(unless of course, the attackers re-sign it with another certificate).\n\nLooking at the (current) detection results (via the anti-virus engines on VirusTotal), it appears\nthe `GoSearch22.app is an instance of the prevalent, yet rather insidious, ‚ÄòPirrit‚Äô adware:`\n\nDetections: Pirrit\n\n[In a (guest) blog post in 2016, Amit Serper dove into Pirrit:](https://twitter.com/0xAmit)\n\n\n-----\n\n[Analysis of an Intrusive Cross-Platform Adware; OSX/Pirrit. ...although it should be noted](https://objective-see.com/blog/blog_0x0E.html)\nthat since then, it has evolved significantly.\nThis version/variant of `Pirrit appears to:`\n\npersist a launch agent\ninstall itself as a malicious Safari extension.\n\nAs this adware is rather well known, we won‚Äôt dig into it too much (today) ‚Ä¶though we will\nnote it implements various anti-analysis logic. For example, anti-debugging logic:\n```\n10000000100054118     movz    x0, #0x1a\n2000000010005411c     movz    x1, #0x1f\n30000000100054120     movz    x2, #0x0\n40000000100054124     movz    x3, #0x0\n50000000100054128     movz    x16, #0x0\n6000000010005412c     svc    #0x80\n\n```\nIn the above `arm64 disassembly, the malicious code is invoking` `ptrace ( 0x1a ) via a`\nsupervisor call ( SVC #0x80 ), with the `PT_DENY_ATTACH ( 0x1f ) flag. This attempts to`\nprevent debugging, or if being debugged, will cause the program to terminate.\n\nThe malicious code also attempts to detect if its running in virtual machine by looking for\nvarious virtual machine ‚Äúartifacts‚Äù:\n```\n# ProcessMonitor.app/Contents/MacOS/ProcessMonitor -pretty\n{\n \"event\": \"ES_EVENT_TYPE_NOTIFY_EXEC\",\n \"process\": {\n  \"name\": \"bash\",\n  \"path\": \"/bin/bash\",\n  \"arguments\": [\"/bin/sh\", \"-c\", \"readonly\nVM_LIST=\\\"VirtualBox\\|Oracle\\|VMware\\|Parallels\\|qemu\\\";is_hwmodel_vm(){ ! sysctl -n\nhw.model|grep \\\"Mac\\\">/dev/null;};is_ram_vm(){(($(($(sysctl -n hw.memsize)/\n1073741824))<4));};is_ped_vm(){ local -r ped=$(ioreg -rd1 -c\nIOPlatformExpertDevice);echo \\\"${ped}\\\"|grep -e \\\"board-id\\\" -e \\\"product-name\\\" -e\n\\\"model\\\"|grep -qi \\\"${VM_LIST}\\\"||echo \\\"${ped}\\\"|grep \\\"manufacturer\\\"|grep -v\n\\\"Apple\\\">/dev/null;};is_vendor_name_vm(){ ioreg -l|grep -e \\\"Manufacturer\\\" -e\n\\\"Vendor Name\\\"|grep -qi \\\"${VM_LIST}\\\";};is_hw_data_vm(){ system_profiler\nSPHardwareDataType 2>&1 /dev/null|grep -e \\\"Model Identifier\\\"|grep -qi\n\\\"${VM_LIST}\\\";};is_vm(){\nis_hwmodel_vm||is_ram_vm||is_ped_vm||is_vendor_name_vm||is_hw_data_vm;};main(){\nis_vm&&echo 1||echo 0;};main \\\"${@}\\\"\"],\n  ...\n }\n}\n\n```\nBefore wrapping up this section on triaging the malicious application, let‚Äôs briefly focus on the\nbrowser extension component. First, note that application bundle contains a plugin,\n```\nGoSearch22 Extension.appex :\n\n```\n\n-----\n\nGoSearch22's Extension.\nBelow is the (abridged) the `Info.plist file of the plugin ( GoSearch22`\n```\nExtension.appex/Contents/Info.plist ):\n\n```\n\n-----\n\n```\n% cat GoSearch22 Extension.appex/Contents/Info.plist \n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\" ... >\n<plist version=\"1.0\">\n<dict>\n <key>CFBundleDisplayName</key>\n <string>GoSearch22 Extension</string>\n <key>CFBundleExecutable</key>\n <string>GoSearch22 Extension</string>\n <key>CFBundleIdentifier</key>\n <string>com.GoSearch22.Extension</string>\n ...\n <key>NSExtension</key>\n <dict>\n  <key>NSExtensionPointIdentifier</key>\n  <string>com.apple.Safari.extension</string>\n  <key>NSExtensionPrincipalClass</key>\n  <string>SafariExtensionHandler</string>\n  <key>SFSafariContentScript</key>\n  <array>\n   <dict>\n    <key>Script</key>\n    <string>script.js</string>\n   </dict>\n  </array>\n  ...\n  <key>SFSafariWebsiteAccess</key>\n  <dict>\n   <key>Allowed Domains</key>\n   <array>\n    <string>*</string>\n   </array>\n   <key>Level</key>\n   <string>All</string>\n  </dict>\n </dict>\n</dict>\n</plist>\n\n```\nFrom the plugin‚Äôs `Info.plist file, it‚Äôs clear it‚Äôs a Safari browser extension. And looking at`\nthe value specified by the `SFSafariContentScript key, we can see its logic is contained`\nin the `script.js file:`\n\n\n-----\n\nGoSearch22's Extension Script.\nThe script is unsurprisingly heavily obfuscated:\n```\n% cat \"GoSearch22 Extension.appex/Contents/Resources/script.js\"\nvar a0a=['wr0bRjtVP8KbeFo=','LMOPwqMwNg==','wpfDqMOtw4Rtw6s=','wrpFw5rDhMOG',\n'XFtr','YcOmw41Mw6U=','wqAWwrHCryXDngUnw5fCrg==','CCo/biE=','w77DhiTDsV4=',\n'wpdLw4jCv8Ok','w60Ow5fDrRA=','MsOIwqYPPn7DmnzDvMO8','a8OQw5low45iw4s=',\n'wrhyw5jCusK1JSdfw5dy','wr1Jw6XCpMKS','w70QGMKowrk=','w44hw4/DkjU=',\n'Zgd8wrnDgw==','AMKGHHbCvw==','wqoNw4xkwoU=','w4oSFmhE','AsKoY8Or','WsOTwo/D\n...\nf7;}else{if(a0b('0x169','Lv[Q')===a0b('0x106','uAqz')){f6['bDFeq'](f7,0x0);}\nelse{var fM=document[a0b('0x210','j]sZ')];fM&&f6[a0b('0x76','2PcE')](f6[a0b(\n'0x21','TrXZ')],fM[a0b('0xf3','BKpl')][a0b('0x97','uAqz')])&&window[a0b('0xd'\n,'tvLM')][a0b('0x1e3','[egw')](location[a0b('0x1bc','TpDR')]);}}}catch(fN){}}\n\n```\n[Online sources, note](https://www.pcrisk.com/removal-guides/19782-gosearch22-virus-mac) `GoSearch22 performs standard adware-type behaviors:`\n\n\n-----\n\n_When users have apps like GoSearch22 installed on a browser and/or the operating_\n_system, they are forced to occasionally see coupons, banners, pop-up ads, surveys,_\n_and/or ads of other types. Quite often ads by apps like GoSearch22 are designed to_\n_promote dubious websites or even download and/or install unwanted apps by_\n_executing certain scripts. Moreover, adware-type apps like GoSearch22 tend to be_\n_designed to collect browsing data. For instance, details like IP addresses, addresses of_\n_visited web pages, entered search queries, geolocations, and other browsing-related_\n_information.\"_\n```\nGoSearch22 in the Wild\n\n```\nIn terms of this specific (M1-native) specimen, we can see it was originally submitted to\nVirusTotal at the end December 2020:\n\nInitial Submission.\nRather awesomely, if we analyze details of the VirusTotal submission, it turns out this sample\n[was submitted (by a user) directly through one of Objective-See‚Äôs tools (likely KnockKnock)](https://objective-see.com/products/knockknock.html)\n‚Ä¶after the tool flagged the malicious code, due to its persistence mechanism:\n\nGoSearch22, Detected via Objective-See.\n\n## Why This All Matters\n\n\n-----\n\nToday we confirmed that malicious adversaries are indeed crafting multi-architecture\napplications, so that their code will natively run on M1 systems. The malicious `GoSearch22`\napplication may be the first example of such natively M1 compatible code.\n\nThe creation of such applications is notable for two main reasons.\n\nFirst, (and unsurprisingly), this illustrates that malicious code continues to evolve in direct\nresponse to both hardware and software changes coming out of Cupertino. There are a\nmyriad of benefits to natively distributing native `arm64 binaries, so why would malware`\nauthors resist?\n\nSecondly, and more worrisomely, (static) analysis tools or anti-virus engines may struggle\nwith `arm64 binaries. In a simple experiment, I separated out the` `x86_64 and` `arm64`\nbinaries from the universal `GoSearch22 binary (using macOS built-in` `lipo utility):`\n```\n% lipo GoSearch22 -thin x86_64 -output GoSearch22_ARM64\n% lipo GoSearch22 -thin arm64 -output GoSearch22_X86_64\n% file ~/Desktop/GoSearch22_*                            \nGoSearch22_ARM64: Mach-O 64-bit executable x86_64\nGoSearch22_X86_64: Mach-O 64-bit executable arm64\n\n```\nI then uploaded both (the now separated) binaries to VirusTotal and initiated scans of each.\nIn theory both binaries would be detected at the same rate, as they both contain the same\nlogically equivalent malicious code.\n\n[Unfortunately detections of the arm64 version dropped roughly 15% (when compared to the](https://www.virustotal.com/gui/file/a0d34d3f767078c34fbc72e8cb02aa99196e2136fa88d633f66f717892759e3b/detection)\n[standalone x86_64 version).](https://www.virustotal.com/gui/file/e60ca9d6073dd942207bb8acaee980ed4284e6471a6de32a633a5ce26c9e8964/detection)\n‚Ä¶several industry leading AV engines (who readily detected the `x86_64 version) failed to`\nflag the malicious `arm64 binary. üò¢`\n\nSome AV engines that (correctly) flag both the x86_64 and arm64 binaries, however present\ndiffering names for their detections, of what logically is the same file.\n\nFor example, Trojan:MacOS/Bitrep.B vs. Trojan:Script/Wacatac.C!ml\n\n...such naming confusions, may indicate inconsistencies when processing the differing binary\nfile formats.\n\n## Conclusions\n\nApple‚Äôs new M1 systems offer a myriad of benefits, and natively compiled `arm64 code runs`\nblazingly fast. Today, we highlighted the fact that malware authors have now joined the ranks\nof developers ‚Ä¶(re)compiling their code to `arm64 to gain natively binary compatibility with`\nApple‚Äôs latest hardware.\n\n\n-----\n\nSpecifically, we highlighted a `Pirrit variant ( GoSearch22.app ) that was first discovered`\nand submitted thanks to Objective-See‚Äôs free, open-source tools!\n\nAnd while the `x86_64 and` `arm64 code appears logically identical (as expected), we`\nshowed that defensive security tools may struggle to detect the `arm64 binary üò•`\n\nüìö The Art of Mac Malware\n\nIf this blog posts pique your interest, definitely check out my new book on the topic of Mac\nMalware Analysis:\n\n[\"The Art Of Mac Malware: Analysis\"](https://taomm.org/)\n...it's free online, and new content is regularly added!\n\n## üíï Support Us:\n\n[Love these blog posts? You can support them via my Patreon page!](https://www.patreon.com/bePatron?c=701171)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-14 - Arm'd & Dangerous malicious code, now native on apple silicon.pdf"
    ],
    "report_names": [
        "2021-02-14 - Arm'd & Dangerous malicious code, now native on apple silicon.pdf"
    ],
    "threat_actors": [
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535878,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653787437,
    "ts_modification_date": 1653787437,
    "files": {
        "pdf": "https://archive.orkl.eu/e1030f278cd33eba34a284c6ad0d5a350b1da9eb.pdf",
        "text": "https://archive.orkl.eu/e1030f278cd33eba34a284c6ad0d5a350b1da9eb.txt",
        "img": "https://archive.orkl.eu/e1030f278cd33eba34a284c6ad0d5a350b1da9eb.jpg"
    }
}