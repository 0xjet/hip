{
    "id": "39430216-60ab-4342-ae5d-cb97b8488fa4",
    "created_at": "2023-01-12T15:10:19.20799Z",
    "updated_at": "2025-03-27T02:09:29.840855Z",
    "deleted_at": null,
    "sha1_hash": "e925de122b2b51046162847968f8bf5fc33b70bf",
    "title": "2021-05-02 - Sodinokibi Ransomware Analysis",
    "authors": "",
    "file_creation_date": "2022-05-28T17:37:46Z",
    "file_modification_date": "2022-05-28T17:37:46Z",
    "file_size": 4543020,
    "plain_text": "# Sodinokibi Ransomware Analysis\n\n**[goggleheadedhacker.com/blog/post/sodinokibi-ransomware-analysis](https://www.goggleheadedhacker.com/blog/post/sodinokibi-ransomware-analysis)**\n\nJacob Pimental May 2, 2021\n\n### 02 May 2021\n\nBack in March, a new version of the Sodinokibi (AKA REvil) Ransomware was released.\nSodinokibi is a Ransomware-as-a-Service (RaaS) provider that has been covered in the\nnews quite a bit. With the new version out, I decided to give a technical analysis of how it\noperates. I got the sample from an overview of the new features that R3MRUM gave in a\ntweet towards the end of March. The file, whose hash is\n```\n12d8bfa1aeb557c146b98f069f3456cc8392863a2f4ad938722cd7ca1a773b39, can be\n\n```\nfound on [VirusTotal or](https://www.virustotal.com/gui/file/12d8bfa1aeb557c146b98f069f3456cc8392863a2f4ad938722cd7ca1a773b39/detection) [Any.Run.](https://app.any.run/tasks/41cee64f-b909-4eaf-a106-16865999db4f/)\n\n\n-----\n\nüÜï [#REvil v2.05](https://twitter.com/hashtag/REvil?src=hash&ref_src=twsrc%5Etfw)\n\n-smode switch configures OS to boot into safe mode w/ networking via:\n\n(pre-Vista) bootcfg /raw /a /safeboot:network /id 1\nor\n(Vista+) bcdedit /set {current} safeboot network\n\nconfigures auto-lognn via WinLogon üîë w/ 'DTrump4ever' password\n\n[‚Äî R3MRUM (@R3MRUM) March 26, 2021](https://twitter.com/R3MRUM/status/1375455360878669824?ref_src=twsrc%5Etfw)\n\n## Background\n\nSodinokibi, or REvil, was first discovered in April of 2019 where it was seen exploiting a\nvulnerability in Oracle WebLogic. It shares many similarities to the GandCrab ransomware\nstrain that retired around the same time Sodinokibi popped up, leading researchers to\nspeculate whether this ransomware is operated by the same people.\n\nBeing a Ransomware-as-a-Service means that clients will pay the operators for access to\nthe latest version and have the group operate the infrastructure for them. There are two\nfields in Sodinokibi‚Äôs configuration that will keep track of the client and the particular client\ncampaign during which the ransomware is deployed. You can find this information in the\nconfiguration section below.\n\n[Sodinokbi has been seen used in several notable breaches including Travelex and](https://www.acronis.com/en-us/blog/posts/travelex-hit-powerful-sodinokibi-ransomware-attack) [Acer. The](https://securityboulevard.com/2021/03/sodinokibi-revil-ransomware-gang-hit-acer-with-50m-ransom-demand/)\ngroup has recently updated the strain to add a new feature that will reboot Windows into\nSafe Mode to bypass AV.\n\n## Analysis TL;DR\n\nSodinokibi will start by dynamically building an import table to make it harder for analysts to\nstatically analyze the sample. It also uses encrypted strings throughout the binary to make it\ndifficult to analyze. During the initial startup phase, Sodinokibi will decrypt its configuration\nusing RC4 which contains information such as C2 domains and one of the public keys\nSodinokibi will use when encrypting files.\n\nAfter the initial startup phase, Sodinokibi will check the user‚Äôs language and keyboard layout\nto see if they are in a whitelisted location. If not, then the ransomware will generate a public\nand private key pair using the Elliptic-Curve Diffie-Hellman algorithm. Sodinokibi stores\nprivate and public keys as well as other important information in specific registry keys to use\nnext time the sample is run.\n\n\n-----\n\nThis version of Sodinokibi comes with a new feature known as SafeMode which will reboot\nthe compromised computer into Windows Safe Mode with Networking. This will prevent most\nantivirus software from running which means Sodinokibi can run without issue.\n\nIf the `exp value in the configuration is set to` `true, Sodinokibi will attempt to escalate`\nprivileges by prompting the user in an endless loop. After this, Sodinokibi will delete shadow\ncopies and kill any processes or services that match a list stored in its configuration. It will\nalso send information about the computer it is running on as well as the generated private\nkey to a list of C2 domains during this phase.\n\nFinally, Sodinokibi will use Windows IO Completion Ports to quickly encrypt files on the\nsystem, ignoring those that match the whitelisted filenames. The files are encrypted using\nthe Salsa20 algorithm with a metadata blob the attacker can use to decrypt the file being\nappended to the end. Sodinokibi can walk through local drives as well as network shares\ndepending on if the `-nolan and` `-nolocal command-line switches are set. After all the`\nfiles are encrypted, Sodinokibi will change the user‚Äôs background to tell them to read the\nransom note.\n\n## Anti-Analysis Features Used in Sodinokibi\n\n### Dynamic Import Address Table (IAT)\n\nSodinokibi will manually load the import address table as an anti-analysis technique. It does\nthis by looping through a list of DWORDs and putting the correct function pointer into the IAT\ndepending on the value of the DWORD. To bypass this technique, I ran the binary in x64dbg\nand dumped it after the call to the IAT population function using Scylla. This allowed me to\ncontinue analyzing this sample statically without having to worry about which functions were\nbeing called.\n\n### String Encryption\n\nMost of the strings in the Sodinokibi sample were encrypted. The string decryption function\nwill take five arguments: an address in memory that is served as a base, the offset from that\nbase to the start of the key, the key length, the length of the ciphertext, and a pointer to the\ntarget variable to populate with the decrypted string.\n\n_String Decryption Function_\n\nThe function will then take the data from `base + offset : base + offset + key_length`\nand store it in a buffer that it will use as a key. It will use that key to RC4 decrypt the data at\n```\nbase + offset + key_length : base + offset + key_length + ciphertext_length .\n\n```\nIt will store the RC4 decrypted result in the `target variable.`\n\n\n-----\n\n_Substitution Box generation algorithm which led me to believe this was RC4_\n\n_Structure of the encrypted data_\n\nFrom this information, I created a small script in Python that will take the first four parameters\npassed into the decryption function and return the resulting string. You can find that script on\nmy [GitHub.](https://github.com/JacobPimental/Malware-Analysis-Notes/blob/main/Sodinokibi/string_decrypt.py)\n\n## Configuration Information\n\nThe configuration for the Sodinokibi sample is stored as an RC4 encrypted JSON string in a\nsection of the binary appropriately named `.cfg . The key for decrypting the configuration is`\ncontained in the first 32 bytes of the section. After that section is a CRC hash of the\nciphertext that Sodinokibi uses to validate the data before decrypting. Below is a table of all\nfour parts of the section:\n\n**Offset (Bytes)** **Data**\n\n0x0 - 0x20 RC4 Key\n\n0x20 - 0x24 CRC Hash of Ciphertext\n\n0x24 - 0x28 Length of Ciphertext\n\n\n-----\n\n**Offset (Bytes)** **Data**\n\n0x28 - ‚Ä¶ Ciphertext\n\nThe configuration structure is stored in JSON and contains 19 keys. Below is a table of the\ninformation stored in the config:\n\n\n-----\n\n**Field** **Description**\n\nimg Text to add to the desktop background alerting users that their files are\nencrypted. Stored as a Base64 encoded string\n\narn Whether or not to set a registry key to have the application run on startup\n\nrdmcnt Maximum number of folders to write the ransom note to. If zero, write the ransom\nnote to all folders\n\nAn interesting thing to note is that both of the unused fields in the configuration were used in\n[previous versions of Sodinokibi. According to an analysis done from Panda Security, the](https://www.pandasecurity.com/emailhtml/2007-CAM-RANSOMWARE-AD360-WG/2006-Report-Sodinokibi-EN.pdf)\n```\nwipe value was used to determine if Sodinokibi would delete directories stored in the\nwfld value.\n\n```\n[The full config from this particular sample can be found here.](https://github.com/JacobPimental/Malware-Analysis-Notes/blob/main/Sodinokibi/config.json)\n\n## Command-line Arguments\n\nThe newest version of Sodinokibi has seven optional command-line switches that control\ndifferent aspects of the infection process. The table below gives an overview of the different\nswitches available:\n\n**Switch** **Description**\n\nnolan Do not encrypt network shares\n\nnolocal Do not encrypt local files\n\npath Specify directory to encrypt\n\nsmode Reboots the computer in Windows Safe Mode\n\nsilent Do not kill processes and services\n\nfast Only encrypts the first MB of a file (sets `et to 1)`\n\nfull Encrypts entire file (sets `et to 0)`\n\n## Language Checks\n\nOne of the first things Sodinokibi will do is identify the user‚Äôs location based on the language\nof the system and the user‚Äôs keyboard layout. Sodinokibi utilizes the\n```\nGetUserDefaultUILanguage and GetSystemDefaultUILanguage functions to get the\n\n```\nlanguage code and then runs that code against a list of hardcoded values. If the system\nlanguage matches, then the program will exit.\n\n\n-----\n\n_List of languages that are whitelisted from being encrypted_\n\nNext, it will get a list of input locale identifiers for the system using the\n```\nGetKeyboardLayoutList function. It will take the last byte of these codes and compare\n\n```\nthem to a hardcoded list of values. If any of the input locale identifiers match, then execution\nis halted.\n\n\n-----\n\n_List of input locale_\n\n_codes Sodinokibi looks for_\n\n## Key Generation\n\nSodinokibi will use the elliptic curve algorithm Curve25519 to generate a public and private\nkey pair as well as shared keys that will be used for encryption. Once the key pair is\ngenerated, Sodinokibi will take the new private key and encrypt it using the public key in the\nconfiguration, `pk, and another public key that is stored in the binary.`\n\n_Code snippet that shows public/private key pair being generated and private key being_\n_encrypted_\n\n\n-----\n\nThe encryption process works by creating a new, temporary key pair we ll call `tmp_key and`\ncreating a shared key between the private `tmp_key and the public key passed into the`\nfunction. We will call this `shared_key for simplicity‚Äôs sake. Next, Sodinokibi will generate a`\nrandom 16 byte IV value. It will then use the IV and `shared_key to encrypt the data that is`\npassed into the function using AES. Finally, Sodinokibi will take the newly encrypted data\nand append the value of `shared_key, the IV, and the CRC hash of the encrypted data to`\nthe end.\n\n_Function used to encrypt the private key_\n\nFor the ransomware operator to decrypt the data, they would need to use the `shared_key`\nand their own private key to generate a new Curve25519 shared key. They can use this\nnewly generated shared key to decrypt the data.\n\nAnalysts from Intel471 managed to find the exact open-source implementation of what\n[Sodinokibi is using to implement the Curve25519 algorithm. You can read their full report on](https://github.com/vstakhov/opt-cryptobox/tree/master/curve25519)\nit [here.](https://intel471.com/blog/revil-ransomware-as-a-service-an-analysis-of-a-ransomware-affiliate-operation/)\n\n## Persistence\n\n### Run On Startup\n\nIf the value of `arn in Sodinokibi‚Äôs configuration info is set to` `true, then it will attempt to`\nmake itself persistent by creating a registry key under\n```\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run . It will create the key qZhotTgfr3\n\n```\nwith the path to the binary as the value. This will allow the malware to run every time the user\nreboots their machine.\n\n\n-----\n\n_Function that will allow the ransomware to run on startup_\n\n### Reg Key Creation\n\nSodinokibi will also store important information such as generated keys in the registry to\nretrieve them next time it runs. It will store these keys under\n```\nSOFTWARE\\BlackLivesMatter . The table below shows the keys it creates and their values:\n\n```\n**Key** **Value**\n\n54k Contains the value of `pk from the configuration`\n\nKrdfp Contains the private key encrypted by the public key in the configuration\n\na0w0 Contains the public key generated from elliptic curve function\n\nhq0G6X Contains the private key encrypted by the public key in the binary\n\nXFx41h1r Contains an encrypted string containing information that is sent to C2 servers\n(see C2 Communication section for more info)\n\nx4WHjRs Contains the random file extension that gets appended to encrypted files\n\n## Sodinokibi SafeMode\n\nOne of the new features from this version of Sodinokibi is the `-smode flag. When running`\nwith this flag, Sodinokibi will reboot the computer into Windows Safe Mode with Networking.\nThe reason for this is that most Antivirus software will not run when Windows is in Safe\nMode. This allows Sodinokibi to bypass most Antivirus products easily.\n\nTo set up SafeMode, Sodinokibi will grab the current username and change its password to\n‚ÄúDTrump4ever‚Äù. It will then enable Autologon privileges for the user by editing the\n```\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\winlogon registry key. It will also\n\n```\nenable the setting for the user to log in with Administrator privileges by default.\n\n\n-----\n\n_Code that sets automatic logon and changes user password_\n\nAfter this, the ransomware will set the `SOFTWARE\\Microsoft\\CurrentVersion\\RunOnce`\nregistry key to set itself to run on the next startup. It will store this information in the registry\nkey `AstraZeneca . It will then set the computer to boot into Windows Safe Mode on the`\nnext startup using either `bootcfg or` `bcdedit depending on the Windows version. You`\ncan find the commands in the table below:\n\n**Windows Version** **Command**\n\nWin7 or Greater `bcdedit /set {current} safeboot network`\n\nVista or Below `bootcfg /raw /a /safeboot:network /id 1`\n\nTo ensure these changes aren‚Äôt permanent, the malware will set one more registry key under\n```\nRunOnce called MarineLePen . This will contain another bootcfg or bcdedit\n\n```\ncommand that will undo the changes on startup.\n\n\n-----\n\n_Code that sets the computer to boot into Windows Safe Mode_\n\nFinally, the function will restart the computer by running the command `SHUTDOWN -r -f -t`\n```\n02 .\n\n## Privilege Escalation\n\n```\nIf the value of `exp in Sodinokibi‚Äôs configuration is set to` `true, it will attempt to escalate`\nprivileges to Administrator. First, the malware will get a handle to the current process using\n```\nGetCurrentProcess . It will then check the current permissions that the process is running\n\n```\nusing `OpenProcessToken and` `GetTokenInformation . If the application is already`\nrunning as Administrator, then the function will exit. If not, it will use the `runas command`\nthrough the function `ShellExecute to prompt the user to run the application with`\nAdministrator privileges. It will continue to prompt the user in an endless loop until the user\nfinally accepts.\n\n\n-----\n\n_Function that will elevate Sodinokibi‚Äôs privileges_\n\n## Service and Process Killing\n\nIf Sodinokibi is run without the `-silent switch, it will attempt to kill processes and services`\nthat match the values in the `prc and` `svc lists in the configuration. It will start this by`\nspawning a thread that will create a COM Object for `IWbemServices . Sodinokibi will use`\nthis COM Object to search for newly created processes or modified services with the\nfollowing queries:\n```\nSELECT * FROM __InstanceCreationEvent WITHIN 1 WHERE TargetInstance ISA\n'Win32_Process'\nSELECT * FROM __InstanceModificationEvent WITHIN 1 WHERE TargetInstance ISA\n'Win32_Service'\n\n```\nThe `IWbemServices::ExecMethodAsync function, shown as offset` `0x5c of the created`\nCOM Object, will send the results to an `IWbemObjectSink Interface which runs them`\nthrough another function at offset `0xb32809 . This function will compare the process/service`\nname against the lists in the configuration and kill them if they match.\n\n\n-----\n\n_Function that kills processes and services using COM Objects_\n\nNext, Sodinokibi will use the Service Control Manager to loop through all active services and\nkill them. It does this by getting a handle to the SCManager object by calling\n```\nOpenSCManager with ‚ÄúServicesActive‚Äù as one of the arguments. Then it will use\nEnumServicesStatusExW to enumerate the returned services and compare each service\n\n```\nname to the list in `svc . If they match, then Sodinokibi will delete the service using the`\n```\nDeleteService function.\n\n```\n_Function that deletes services using Service Control Manager_\n\nFinally, Sodinokibi will loop through any active processes using the `Process32FirstW and`\n```\nProcess32NextW functions and run the process name against the prc list. If the prc list\n\n```\ncontains the process name, then the process will be terminated using the\n\n\n-----\n\n```\nTerminateProcess function.\n\n```\n_Loop that will run active process handles through a function that will terminate them_\n\n_Function that will take a process handle and terminate it if it‚Äôs in the_ `prc list`\n\n## Shadow Copy Deletion\n\nWhen the `-silent switch is not present, the Sodinokibi sample will spawn a thread that`\nwill delete any shadow copies that are present on the system. It will do this by using COM\nObjects similar to how it kills processes and services. Sodinokibi will run the query `select`\n```\n* from Win32_ShadowCopy to retrieve an IEnumWbemClassObject object. It will\n\n```\nenumerate each shadow copy object using the `IEnumWbemClassObject::Next function,`\ngrab each ID, and delete it using the `IWbemServices::Delete function. The delete`\nfunction contains a string with the shadow copy‚Äôs ID in the form `Win32_ShadowCopy.ID=`\n```\n<ID> as the parameter.\n\n```\n\n-----\n\n_Function that will delete shadow copies using COM Objects_\n\n## C2 Communication\n\nWhen the `net value in the configuration info is set to` `true, Sodinokibi will reach out to`\none of the Command and Control (C2) servers from the `dmn list. First, it will split the list of`\ndomains by the ‚Äú;‚Äù character. For each C2 in the list, Sodinokibi will build up an information\nstring in the following format:\n```\n{\n \"ver\":\"Version info (0x205, or 2.05 in this case)\",\n \"pid\":\"pid value from config\",\n \"sub\":\"sub value from config\",\n \"pk\": \"pk value from config, base64 decoded\",\n \"uid\":\"Volume Serial Number and CPU Info\",\n \"sk\": \"Private Key encrypted by the value of pk\",\n \"unm\":\"Account Username\",\n \"net\":\"Computer Name\",\n \"grp\":\"Computer Domain Name\",\n \"lng\":\"Language Used (i.e. en-us)\",\n \"bro\":\"Boolean returned by the language and keyboard check\",\n \"os\": \"Product Name\",\n \"bit\":\"Architecture Used (x32 or x64)\",\n \"dsk\":\"Base64 encoded information about the drives on the computer\",\n \"ext\":\"Generated extension used for encrypted files\"\n}\n\n```\nSodinokibi will then take this JSON string and encrypt it using a third public key that is stored\nin the binary. It will use the same encryption method that was used to encrypt the generated\nsecret key that was described earlier in this report. Once the JSON information is encrypted,\nSodinokibi will take the C2 domain and start to build a random URL in the following form:\n\n\n-----\n\n```\n https://<domain>/(wp\ncontent|static|content|include|uploads|news|data|admin)/(images|pictures|image|temp|tm\nz]{2}){1,10}.(jpg|png|gif)\n\n```\nSodinokibi will then send the data in a POST request with the following headers:\n```\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like\nGecko) Chrome/84.0.4147.125 Safari/537.36\nContent-Type: application/octet-stream\nConnection: close\n\n```\n_Function that handles connection for C2 domain, with renamed functions to make it clear_\n_what the function is doing_\n\n## File Encryption\n\n[To perform file encryption, Sodinokibi uses I/O Completion Ports to speed up walking the file](https://docs.microsoft.com/en-us/windows/win32/fileio/i-o-completion-ports)\nsystem. This essentially allows the ransomware to create multiple threads that will wait for a\nfile handle. Once one is sent over, the first available thread will take it and encrypt the file\nusing the Salsa20 Algorithm.\n\n_Code that will create a new completion port to use_\n\nOnce the completion port is created, Sodinokibi will walk the local file system if the `-`\n```\nnolocal command-line switch is not set. It will start by enumerating drives and checking the\n\n```\ndrive type using `GetDriveTypeW . If the drive is valid, it will walk through the files in it using`\n```\nFindFirstFileExW and FindFirstFileW depending on the Windows version. It will also\n\n```\ncheck each file and folder name against the `fld,` `fls, and` `ext lists to see if it is`\nwhitelisted from being encrypted. It will also not encrypt a file if it is already marked as\nencrypted by the Windows File System.\n\nIf the `nolan command-line switch is not set, then Sodinokibi will enumerate network`\nshares. It will use `WNetOpenEnumW and` `WNetEnumResourceW to get shares to which is can`\nconnect. To get permission to access these shares, Sodinokibi will attempt to impersonate\nthe current user using the `ImpersonateLoggedOnUser function. Sodinokibi will first grab`\nthe Process ID of ‚Äúexplorer.exe‚Äù and use that to grab the access token of the user. It can use\nthat access token to access objects for which the user already has access.\n\n\n-----\n\n_Function that will encrypt remote drives_\n\nFor every folder that Sodinokibi finds while walking the file system, it will write a ransom note\nto it. It will then compare a variable against the value of `rdmcnt . If it is greater than`\n```\nrdmcnt, it will not write the note. If rdmcnt is equal to zero, then it will write notes in every\n\n```\nfolder regardless of the count. The count variable will then increment and the function will\nexit. This count variable is reset on every drive that gets encrypted, leading me to believe\nthat the `rdmcnt value dictates the maximum number of ransom notes Sodinokibi will write`\nto a drive.\n\nFor each file, Sodinokibi will build a metadata structure that it will append to the end of the\nencrypted file. This value is part of the `lpOverlapped structure that gets passed to the IO`\nCompletion Port. The structure can be defined as the following:\n\n\n-----\n\n```\nstruct rvl_struct {\n BYTE priv_key_encrypted_w_config_pk[88],\n BYTE priv_key_encrypted_w_bin_pk[88],\n BYTE generated_pub_key[32],\n BYTE salsa20_IV,\n DWORD crc_of_pub_key,\n DWORD value_of_et,\n DWORD spsize,\n DWORD salsa20_encrypted_null_value\n}\n\n```\nThis structure is used to verify that the file is encrypted and is used to decrypt the file by the\nattacker. Using this structure, the operator can decrypt the generated private key and use\nthat with the salsa20 IV to decrypt the file.\n\nOnce this metadata structure is set up, the file will be posted to the IO Completion Port to be\nencrypted by one of the spawned threads. Depending on the encryption type, Sodinokibi will\neither encrypt the entire file ( et =0), only encrypt the first MB ( et =1), or encrypt one MB of\nthe file, skip `spsize MBs then encrypt another MB and repeat ( et =2). Once the file is`\nencrypted, Sodinokibi will append the metadata blob to the end and move to the next file.\n\nOnce all files are encrypted, Sodinokibi will set the background image to display the text from\nthe `img value in the configuration. In this case, it will display:`\n```\nAll of your files are encrypted!\nFind {EXT}-readme.txt and follow instuctions\n\n## Ransom Note Generation\n\n```\nThe ransom note is stored as a Base64 encoded string in Sodinokibi‚Äôs configuration under\nthe `nbody field. The note in this sample contains:`\n\n\n-----\n\n```\n    Welcome. Again.\n[+] Whats Happen? [+]\nYour files are encrypted, and currently unavailable. You can check it: all files on\nyour system has extension {EXT}.\nBy the way, everything is possible to recover (restore), but you need to follow our\ninstructions. Otherwise, you cant return your data (NEVER).\n[+] Attention!!! [+]\nAlso your private data was downloaded.\nWe will publish it in case you will not get in touch with us asap.\n[+] What guarantees? [+]\nIts just a business. We absolutely do not care about you and your deals, except\ngetting benefits. If we do not do our work and liabilities - nobody will not\ncooperate with us. Its not in our interests.\nTo check the ability of returning files, You should go to our website. There you can\ndecrypt one file for free. That is our guarantee.\nIf you will not cooperate with our service - for us, its does not matter. But you\nwill lose your time and data, cause just we have the private key. In practise - time\nis much more valuable than money.\n[+] How to get access on website? [+]\nYou have two ways:\n1) [Recommended] Using a TOR browser!\n a) Download and install TOR browser from this site: https://torproject.org/\n b) Open our website:\nhttp://aplebzu47wgazapdqks6vrcv6zcnjppkbxbr6wketf56nf6aq2nmyoyd.onion/{UID}\n2) If TOR blocked in your country, try to use VPN! But you can use our secondary\nwebsite. For this:\n a) Open your any browser (Chrome, Firefox, Opera, IE, Edge)\n b) Open our secondary website: http://decoder.re/{UID}\nWarning: secondary website can be blocked, thats why first variant much better and\nmore available.\nWhen you open our website, put the following data in the input form:\nKey:\n{KEY}\n---------------------------------------------------------------------------------------!!! DANGER !!!\nDONT try to change files by yourself, DONT use any third party software for restoring\nyour data or antivirus solutions - its may entail damge of the private key and, as\n\n```\n\n-----\n\n```\nresult, The Loss all data.\n!!! !!! !!!\nONE MORE TIME: Its in your interests to get your files back. From our side, we (the\nbest specialists) make everything for restoring, but please should not interfere.\n!!! !!! !!!\n\n```\nThe note contains three template variables: `{UID},` `{KEY}, and` `{EXT} . The` `{UID}`\nvariable will correspond with the CRC of the infected computer‚Äôs volume serial number and\nother information about the CPU. This data is used as a distinct identifier that Sodinokibi can\nuse to keep track of the computer. The `{EXT} value will correspond with the randomly`\ngenerated extension that Sodinokibi will append to encrypted files. Finally, the `{KEY} value`\nis the encrypted JSON string that Sodinokibi will send to the Command and Control server.\nYou can see how this is generated in the C2 Communication section of this post.\n\n_Function that will generate the ransom note body_\n\nOnce the ransom note string is generated, Sodinokibi will write it to the filename specified in\nthe `nname field of the configuration, which in this sample is` `{EXT}-readme.txt . It will`\nreplace the `{EXT} value of the filename with the randomly created extension, just like it`\ndoes for the ransom note body.\n\n## Conclusion\n\n\n-----\n\nSodinokibi is a complex ransomware strain with many different features that the group\ncontinues to add to all the time. This latest version added the new SafeMode feature which is\na smart way to bypass AV. There is definitely a lot to write about when it comes to this\nransomware, and unfortunately, I could not cover it all in a single post. If you have any\n[questions or comments about this analysis, feel free to reach out to me on my Twitter or](https://twitter.com/jacob_pimental)\n[LinkedIn.](https://www.linkedin.com/in/jacobpimental/)\n\nThanks for reading and happy reversing!\n\n## IOCs\n```\nSHA-256: 12d8bfa1aeb557c146b98f069f3456cc8392863a2f4ad938722cd7ca1a773b39\nRegistry Keys:\nSOFTWARE\\BlackLivesMatter\\54k\nSOFTWARE\\BlackLivesMatter\\Krdfp\nSOFTWARE\\BlackLivesMatter\\a0w0\nSOFTWARE\\BlackLivesMatter\\hq0G6X\nSOFTWARE\\BlackLivesMatter\\XFx41h1r\nSOFTWARE\\BlackLivesMatter\\x4WHjRs\nMutexes:\nGlobal\\F69C27FF-AB15-CCAA-A2D6-7F7ADA90E7E3\nHTTP Headers:\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like\nGecko) Chrome/84.0.4147.125 Safari/537.36\nContent-Type: application/octet-stream\nConnection: close\nURL Regex:\nhttps:\\/\\/[^\\/]+\\/(wpcontent|static|content|include|uploads|news|data|admin)\\/(images|pictures|image|temp|t\n[a-z]{2}){1,10}\\.(jpg|png|gif)\n\n ATT&CK Methodologies\n\n```\n**ATT&CK ID** **ATT&CK Technique**\n\n[T1098](https://attack.mitre.org/techniques/T1098/) Account Manipulation\n\n[T1547](https://attack.mitre.org/techniques/T1547/) Boot or Logon Autostart Execution\n\n[T1548](https://attack.mitre.org/techniques/T1548/) Abuse Elevation Control Mechanism\n\n[T1134](https://attack.mitre.org/techniques/T1134/) Access Token Manipulation\n\n\n-----\n\n**ATT&CK ID** **ATT&CK Technique**\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Modify Registry\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or Information\n\n[T1083](https://attack.mitre.org/techniques/T1083/) File and Directory Discovery\n\n[T1135](https://attack.mitre.org/techniques/T1135/) Network Share Discovery\n\n[T1486](https://attack.mitre.org/techniques/T1486/) Data Encrypted for Impact\n\n[T1489](https://attack.mitre.org/techniques/T1489/) Service Stop\n\n**Malware Analysis, Sodinokibi, Ransomware, Cutter, Automation**\n\n## More Content Like This:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-02 - Sodinokibi Ransomware Analysis.pdf"
    ],
    "report_names": [
        "2021-05-02 - Sodinokibi Ransomware Analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536219,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653759466,
    "ts_modification_date": 1653759466,
    "files": {
        "pdf": "https://archive.orkl.eu/e925de122b2b51046162847968f8bf5fc33b70bf.pdf",
        "text": "https://archive.orkl.eu/e925de122b2b51046162847968f8bf5fc33b70bf.txt",
        "img": "https://archive.orkl.eu/e925de122b2b51046162847968f8bf5fc33b70bf.jpg"
    }
}