{
    "id": "d70de1fe-0cb7-4df2-ab1c-c7e21e5aa1f7",
    "created_at": "2023-01-12T15:02:04.650124Z",
    "updated_at": "2025-03-27T02:06:01.74081Z",
    "deleted_at": null,
    "sha1_hash": "779ce51c062dd9faa0352e950e505fe8f7c158b3",
    "title": "2021-02-28 - Laravel Apps Leaking Secrets",
    "authors": "",
    "file_creation_date": "2022-05-28T18:03:31Z",
    "file_modification_date": "2022-05-28T18:03:31Z",
    "file_size": 487027,
    "plain_text": "# Laravel Apps Leaking Secrets\n\n**[thedfirreport.com/2021/02/28/laravel-debug-leaking-secrets/](https://thedfirreport.com/2021/02/28/laravel-debug-leaking-secrets/)**\n\nFebruary 28, 2021\n\nAn attacker logged in through RDP a few days ago to run a “smtp cracker” that scans a list of\nIP addresses or URLs looking for misconfigured Laravel systems. These attackers are\nlooking for websites that have debug mode enabled, which allows the attacker to see their\n.env (config) file. The .env file includes AWS, O365, SendGrid, Twilio credentials and more.\n\nWhat is Laravel?\n\nLaravel is a free, open-source[3] PHP web framework, created by Taylor Otwell and\nintended for the development of web applications\n\n_https://en.wikipedia.org/wiki/Laravel_\n\n\n-----\n\nLaravel provides drivers for SMTP, Mailgun, Mandrill, Amazon SES, PHP s mail\nfunction, and sendmail, allowing you to quickly get started sending mail through a local\nor cloud based service of your choice.\n\n_https://laravel.com/docs/5.1/mail_\n\nThe debug option is turned off by default on Laravel systems, but it appears many users are\nenabling debug and not understanding the consequences. Here’s an example of debug\nbeing enabled (set to true) in the .env config file.\n\nweb response (not actual\n\nconfig file)\nYou can check to see if debug is enabled by checking for .env in the web root (site.com/.env)\nor by sending random data to the webserver and reviewing the response. In the response,\nyou will see the debug option as well as all the information from the .env file, which includes\nthe secrets.\n\nHere’s an example of a web response with debug enabled:\n\n\n-----\n\nHere s an example of an .env file:\n\n\n-----\n\nThe smtp cracker script, which by the way–is not a cracker, and grabs more than just smtp\ncredentials; it uses the above methods to crawl a list of IPs/URLs looking for specific strings\nin the response such as PayPal, AWS_KEY, SES_KEY, Twilio, sendgrid, office365, zoho,\nmailgun and others.\n\nHere’s part of the script, where it looks for a string in mailhost and outputs the secret(s) to the\nappropriate file.\n\nThe output of the script is saved in a folder named Results. The results are divided into\ngroups as seen above.\n\n\n-----\n\nInside those files contain the secrets and method used to extract the information. This is a\npartial example of the sendgrid file:\n\n\n-----\n\nThis is a partial example of the office365 text file:\n\n\n-----\n\nWe are in the process of contacting over 100 people/organizations who’s systems are\nleaking secrets via Laravel debug in hopes that they will remediate the issue and change\n[their passwords. If anyone needs help fixing this issue, please use the Contact Us form to](https://thedfirreport.com/contact/)\nget in touch.\n\n## MITRE ATT&CK\n\n Initial Access\n\nRDP login as local admin from 64.86.198[.]22. No brute force attempts were seen from this\nIP.\n\n## Execution\n\nThe attacker installed and used Python 2.7 to execute the smtp cracker script.\n\n\n-----\n\nPip was used to install 4 modules.\n```\npip install requests\npip install colorama\npip install bs4\npip install tldextract\n\n## Detections\n\n```\n\n-----\n\nWeb requests to root/.env or post data that includes 0x[]:androxgh0st (hard coded string in\nsmtp.py)\n\n## IOCs\n\n[If you would like access to our internal MISP and/or threat feeds please see here.](https://thedfirreport.com/services/)\n\n## File\n\nfilename smtp.py\n\nmd5 39e1ec2c704bcdb57034da4ac288446e\n\nsha1 352e9c78f08574adbaa0aaf49c19d5853bb4be36\n\nsha256 478290f801dafc9086810f857c123d74690920a4c44fb573cd01463c1b6fb432\n\n## Network\n\ntype value comment\n\nip-src 64.86.198.22 RDP Unauthorized Access\n```\nValid Accounts - T1078  \nPython - T1059.006  \nScripting - T1064  \nUser Execution - T1204  \nGraphical User Interface - T1061  \nCommand and Scripting Interpreter - T1059  \nLink to IOCs and artifacts\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-28 - Laravel Apps Leaking Secrets.pdf"
    ],
    "report_names": [
        "2021-02-28 - Laravel Apps Leaking Secrets.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535724,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1653761011,
    "ts_modification_date": 1653761011,
    "files": {
        "pdf": "https://archive.orkl.eu/779ce51c062dd9faa0352e950e505fe8f7c158b3.pdf",
        "text": "https://archive.orkl.eu/779ce51c062dd9faa0352e950e505fe8f7c158b3.txt",
        "img": "https://archive.orkl.eu/779ce51c062dd9faa0352e950e505fe8f7c158b3.jpg"
    }
}