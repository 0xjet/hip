{
    "id": "459f6b58-9962-4029-8afd-8f77ac4ce24c",
    "created_at": "2022-10-25T16:48:23.42456Z",
    "updated_at": "2025-03-27T02:16:39.072676Z",
    "deleted_at": null,
    "sha1_hash": "04146a1e3e7dd4d5e3e2fbd5b0fe8f06720a6a6b",
    "title": "Mosquito campaign by Turla undergoes significant TTPs shift",
    "authors": "",
    "file_creation_date": "2018-05-23T05:49:41Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 447015,
    "plain_text": "#    \n\n\n##### in 2008, when Turla breached the US Department of Defense [1]. Since then, there have been\n\n numerous security incidents involving Turla targeting several governments and sensitive\n\n# \n\n##### businesses such as the defense industry [2].\n\n# \n\n\n##### Our January 2018 white paper [3] was the first public analysis of a Turla campaign called\n\n Mosquito. We have also published indicators of compromise [4]. Since then, the campaign has\n\n remained very active and attackers have been busy changing their tactics to remain as stealthy\n\n as possible.\n\n Starting in March 2018, we observed a significant change in the campaign: it now leverages the\n\n open source exploitation framework Metasploit before dropping the custom Mosquito\n\n backdoor. It is not the first time Turla has used generic tools. In the past, we have seen the\n\n group using open-source password dumpers such as Mimikatz. However, to our knowledge,\n\n this is the first time Turla has used Metasploit as a first stage backdoor, instead of relying on\n\n one of its own tools such as Skipper [5].\n\n## Distribution\n\n\n-----\n\n##### campaign is still a fake Flash installer, in reality installing both the Turla backdoor and the\n\n legitimate Adobe Flash Player. The typical targets are still embassies and consulates in Eastern\n\n Europe.\n\n We showed that the compromise happens when the user downloads a Flash installer from\n\n get.adobe.com through HTTP. Traffic was intercepted on a node between the end machine\n\n and the Adobe servers, allowing Turla’s operators to replace the legitimate Flash executable\n\n with a trojanized version. The following image shows the different points where the traffic\n\n could in theory be intercepted. Please note that we believe the fifth possibility to be excluded,\n\n as, to the best of our knowledge, Adobe/Akamai was not compromised.\n\n\n-----\n\n##### Even though we were not able to spot traffic interception subsequently, we found a new\n\n executable that is still impersonating the Flash installer and is named\n\n flashplayer28_xa_install.exe. Thus, we believe the same method of initial compromise\n\n is still being used.\n\n## Analysis\n\n\n-----\n\n##### some changes in the Mosquito campaign. Even though they did not make use of\n\n groundbreaking techniques, this is a significant shift in Turla’s Tactics, Techniques and\n\n Procedures (TTPs).\n\n Previously, the chain of compromise was a fake Flash installer dropping a loader and the main\n\n backdoor. The following figure summarizes the process.\n\n\n-----\n\n##### DLLs, it executes a Metasploit shellcode and drops, or downloads from Google Drive, a\n\n legitimate Flash installer. Then, the shellcode downloads a Meterpreter, which is a typical\n\n Metasploit payload [6], allowing the attacker to control the compromised machine. Finally, the\n\n machine may receive the typical Mosquito backdoor. The figure below summarizes the new\n\n process.\n\n Because Metasploit is being used, we might also guess that an operator controls the\n\n exploitation process manually. The time frame of the attack was relatively short as the final\n\n backdoor was dropped within thirty minutes of the start of the compromise attempt.\n\n\n-----\n\n-----\n\n-----\n\n##### g p y p y q\n\n domain, psychology-blog.ezua[.]com, was resolving to it in October 2017.\n\n Finally, the fake Flash installer downloads a legitimate Adobe installer, from a Google Drive URL,\n\n and executes it to lull the user into thinking all went correctly.\n\n## Additional tools\n\n##### In addition to the new fake Flash installer and Meterpreter, we observed the use of several\n\n other tools.\n\nA custom executable that only contains the Metasploit shellcode. This is used to maintain access to a\nMeterpreter session. It is saved to C:\\Users\\\n<username>\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\msupdateconf.exe, granting the executable persistence.\n\nAnother custom executable used to execute PowerShell scripts.\n\nThe Mosquito JScript backdoor that uses Google Apps Script as its C&C server.\n\n\n-----\n\n## Conclusion\n\n##### In this post, we have presented the evolutions of the Turla Mosquito campaign over the last\n\n few months. The major change we observed was the use of Metasploit, an open-source\n\n penetration testing project, as a first stage for the custom Mosquito backdoor. This might be\n\n useful information for defenders performing incident response on attacks involving Turla.\n\n For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com.\n\n### C&C\n\nhttps://209.239.115[.]91/6OHEJ\n\nhttps://70.32.39[.]219/n2DE3\n\n### Link to the legitimate Flash installer\n\n\n-----\n\n## IoCs\n\nFilename SHA1 SHA256\n\nflashplayer28_xa_install.exe 33d3b0ec31bfc16dcb1b1ff82550aa17fa4c07c5 f9b83eff6d705c214993be9575\n\nmsupdateconf.exe 114c1585f1ca2878a187f1ce7079154cc60db7f5 1193033d6526416e07a5f20022\n\nmsupdatesmal.exe 994c8920180d0395c4b4eb6e7737961be6108f64 6868cdac0f06232608178b101c\n\n### References\n\n##### [1] B. KNOWLTON, “Military Computer Attack Confirmed,” New York Times, 25 08 2010.\n\n [Online]. Available: https://www.nytimes.com/2010/08/26/technology/26cyber.html?\n\n _r=1&ref=technology. [Accessed 09 04 2018].\n\n\n-----\n\n##### 23 05 2016. [Online]. Available:\n\n https://www.melani.admin.ch/melani/en/home/dokumentation/reports/technical\n reports/technical-report_apt_case_ruag.html.\n\n [3] ESET, “Diplomats in Eastern Europe bitten by a Turla mosquito,” ESET, 01 2018. [Online].\n\n Available: https://www.welivesecurity.com/wp\n content/uploads/2018/01/ESET_Turla_Mosquito.pdf.\n\n [4] ESET, “Mosquito Indicators of Compromise,” ESET, 09 01 2018. [Online]. Available:\n\n https://github.com/eset/malware-ioc/tree/master/turla#mosquito-indicators-of-compromise.\n\n [5] M. Tivadar, C. Istrate, I. Muntean and A. Ardelean, “Pacifier APT,” 01 07 2016. [Online].\n\n Available: https://labs.bitdefender.com/wp-content/uploads/downloads/pacifier-apt/.\n\n [6] “About the Metasploit Meterpreter,” [Online]. Available: https://www.offensive\n security.com/metasploit-unleashed/about-meterpreter/.\n\n\n-----\n\n##### http://radare.today/posts/unpacking-shikata-ga-nai-by-scripting-radare2/.\n\n [8] “meterpreter/source/extensions/priv/server/elevate/,” Rapid7, 26 11 2013. [Online]. Available:\n\n https://github.com/rapid7/meterpreter/tree/master/source/extensions/priv/server/elevate.\n\n\n\n[ESET Research](https://www.welivesecurity.com/author/esetresearch/) 22 May 2018 - 02:58PM\n\n\n#### Similar Articles\n\n\n[ESPIONAGE](https://www.welivesecurity.com/category/espionage/) [ESPIONAGE](https://www.welivesecurity.com/category/espionage/) [ESPIONAGE](https://www.welivesecurity.com/category/espionage/) [ESPIONAGE](https://www.welivesecurity.com/category/espionage/)\n\n\n[ESPIONAGE](https://www.welivesecurity.com/category/espionage/)\n\n\n[ESPIONAGE](https://www.welivesecurity.com/category/espionage/)\n\n\nESET research:\nAppearances are\n\n\n[ESPIONAGE](https://www.welivesecurity.com/category/espionage/)\n\n\nNew ESET research\nuncovers Gazer, the\n\n\n[ESPIONAGE](https://www.welivesecurity.com/category/espionage/)\n\n\nOperation Potao Express:\n[Analysis of a cyber-](https://www.welivesecurity.com/2015/07/30/operation-potao-express/)\n\n\nHuawei? The how, what,\n[and why of telecom](https://www.welivesecurity.com/2012/10/08/huawei-the-how-what-and-why-of-telecom-supply-chain-threats/)\n\n\n-----\n\n#### Discussion\n\n\n-----\n\n[Home](https://www.welivesecurity.com/)\n\nAbout Us\n\nContact Us\n\n\n[Sitemap](https://www.welivesecurity.com/sitemap/)\n\nOur Experts\n\nESET\n\n\n[Research](https://www.welivesecurity.com/research/)\n\nHow To\n\nCategories\n\n\n[RSS Configurator](https://www.welivesecurity.com/rss-configurator/)\n\nNews Widget\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.05.22.Turla_Mosquito/turla-mosquito-shift-towards-generic-tools.pdf"
    ],
    "report_names": [
        "turla-mosquito-shift-towards-generic-tools"
    ],
    "threat_actors": [
        {
            "id": "4a892faf-3d4d-4615-b7b6-cdbc2ce42d8d",
            "created_at": "2022-10-25T16:07:23.99045Z",
            "updated_at": "2025-03-27T02:02:10.06504Z",
            "deleted_at": null,
            "main_name": "Operation Potao Express",
            "aliases": [],
            "source_name": "ETDA:Operation Potao Express",
            "tools": [
                "FakeTC",
                "Patao"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "392aed78-4ef6-46ac-afba-c3920ea05d28",
            "created_at": "2022-10-25T16:07:23.323349Z",
            "updated_at": "2025-03-27T02:02:09.737228Z",
            "deleted_at": null,
            "main_name": "APT 6",
            "aliases": [
                "1.php Group"
            ],
            "source_name": "ETDA:APT 6",
            "tools": [
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "Poison Ivy",
                "SPIVY",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1527054581,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/04146a1e3e7dd4d5e3e2fbd5b0fe8f06720a6a6b.pdf",
        "text": "https://archive.orkl.eu/04146a1e3e7dd4d5e3e2fbd5b0fe8f06720a6a6b.txt",
        "img": "https://archive.orkl.eu/04146a1e3e7dd4d5e3e2fbd5b0fe8f06720a6a6b.jpg"
    }
}