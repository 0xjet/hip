{
    "id": "e248e06e-9ffe-4c2f-93c3-4ab4c1847c2f",
    "created_at": "2023-01-12T15:06:42.688015Z",
    "updated_at": "2025-03-27T02:05:47.229859Z",
    "deleted_at": null,
    "sha1_hash": "df42f174b2028a771fbead2f71b833b45d6e78f7",
    "title": "2020-12-03 - Another LILIN DVR 0-day being used to spread Mirai",
    "authors": "",
    "file_creation_date": "2022-05-28T15:24:48Z",
    "file_modification_date": "2022-05-28T15:24:48Z",
    "file_size": 360659,
    "plain_text": "# Another LILIN DVR 0-day being used to spread Mirai\n\n**[blog.netlab.360.com/another-lilin-dvr-0-day-being-used-to-spread-mirai-en/](https://blog.netlab.360.com/another-lilin-dvr-0-day-being-used-to-spread-mirai-en/)**\n\nGenshen Ye December 3, 2020\n\n### 3 December 2020 / 0-day Author: Yanlong Ma, Genshen Ye\n\n## Background Information\n\n### In March, we reported[1] that multiple botnets, including Chalubo, Fbot,\n Moobot were using a same 0 day vulnerability to attack LILIN DVR devices, the\n vendor soon fixed the vulnerability.\n\n On August 26, 2020, our Anglerfish honeypot detected that another new LILIN\n DVR/NVR 0-day paired with system default credential operxxxx:xxxxx(masked\n for security concern) were used to spread Mirai sample.\n\n On September 21, 2020, we reported the finding to the Merit LILIN contact, and\n the vendor fixed the vulnerability overnight, and also provided us a firmware fix ver 4.0.26.5618.\n\n## Impact devices\n\n### The 360 FirmwareTotal system provides the following firmware list that are\n impacted.\n\n\n-----\n\n```\nDH032 Firmware v1.0.26.3858.zip           \nDH032 Firmware v1.0.28.3858.zip           \nDVR708 Firmware v1.3.4.zip              \nDVR716 Firmware v1.3.4.zip              \nDVR816 Firmware v1.3.4.zip              \nFirmware-DH032-EN.zip                \nFirmware-DVR708-EN.zip                \nFirmware-DVR716-EN.zip                \nFirmware-DVR816-EN.zip                \nFirmware-NVR100L-EN.zip               \nFirmware-NVR1400-EN.zip               \nFirmware-NVR200L-EN.zip               \nFirmware-NVR2400-EN.zip               \nFirmware-NVR3216-EN.zip               \nFirmware-NVR3416-EN.zip               \nFirmware-NVR3416R-EN.zip               \nFirmware-NVR3816-EN.zip               \nFirmware-NVR400L-EN.zip               \nFirmware-NVR5104E-EN.zip               \nFirmware-NVR5208E-EN.zip               \nFirmware-NVR5416E-EN.zip               \nFirmware-NVR5832-EN.zip               \nFirmware-NVR5832S-EN.zip               \nNVR 404C Firmware v1.0.48.zip            \nNVR 404C Firmware v1.0.56.zip            \nNVR 408M Firmware v1.0.56.zip            \nNVR100L 200L Rescue File.zip             \nNVR100L Firmware v1.1.56 - HTML5 Version.zip     \nNVR100L Firmware v1.1.66.zip             \nNVR100L Firmware v1.1.74 - Push Notification Fix.zip \nNVR100L, 200L Rescue File.zip            \nNVR100LFirmware.zip                 \nNVR104 Firmware v1.0.48.zip             \nNVR104 Firmware v1.0.56.zip             \nNVR109 Firmware v1.0.38.zip             \nNVR109 Firmware v1.0.48.zip             \nNVR109 Firmware v1.0.56.zip             \nNVR116 Firmware v1.0.38.zip             \nNVR116 Firmware v1.0.48.zip             \nNVR116 Firmware v1.0.56.zip             \nNVR1400Firmware.zip                 \nNVR1400L Firmware v1.1.56 - HTML5 Version.zip    \nNVR1400L Firmware v1.1.66.zip            \nNVR1400L Firmware v1.1.74 - Push Notification Fix.zip\nNVR200L Firmware v1.1.56 - HTML5 Version.zip     \nNVR200L Firmware v1.1.66.zip             \nNVR200L Firmware v1.1.74 - Push Notification Fix.zip \nNVR200LFirmware.zip                 \nNVR2400Firmware.zip                 \nNVR2400L Firmware v1.1.56 - HTML5 Version.zip    \nNVR2400L Firmware v1.1.66.zip            \nNVR2400L Firmware v1.1.74 - Push Notification Fix.zip\nNVR3216 Firmware v3.0.74.3921.zip          \nNVR3216 Recovery Tool.zip              \nNVR3416 Firmware v3.0.74.3921.zip          \n\n```\n\n-----\n\n```\nNVR3416 Recovery Tool.zip              \nNVR3416r Firmware v3.0.76.3921.zip          \nNVR3816 Firmware v2.0.74.3921.zip          \nNVR400L 1400 2400 Rescue File.zip          \nNVR400L Firmware v1.1.56 - HTML5 Version.zip     \nNVR400L Firmware v1.1.66.zip             \nNVR400L Firmware v1.1.74 - Push Notification Fix.zip \nNVR400L, 1400, 2400 Rescue File.zip         \nNVR5104E Firmware v5.0.24.4078.zip          \nNVR5104E Recovery Tool.zip              \nNVR5208E Firmware v5.0.24.4078.zip          \nNVR5208E Recovery Tool.zip              \nNVR5416E Firmware v4.0.24.4078.zip          \nNVR5832 Firmware v4.0.24.4043.zip          \nNVR5832 Firmware v4.0.24.4043.zip          \nNVR5832 Recovery Tool.zip              \nNVR5832S Firmware v4.0.24.4043.zip          \nNVR5832S Recovery Tool.zip              \nVD022 Firmware 1.0.48.zip              \nVD022 Firmware 1.0.56.zip              \n\n### The 360 Quake cyberspace mapping system mapped assets across the global and discovered that there are 1049094 IP addresses of devices with Merit LILIN DVR/NVR fingerprints (app:\"LILIN_DVR\") on the public network, and 6748 of them are considered vulnerable. The vast majority of these devices are located in Taiwan, China, as shown in the figure below.\n\n```\n\n-----\n\n## Vulnerability Analysis\n\n### Vulnerability Type: Remote Command Execution Vulnerability\n Vulnerability detail: The Web service program /opt/extra/main defines a GET\n```\n/getclock interface for viewing and modifying time-dependent device\n\n configurations. When the /opt/extra/main program is started, the command line\n program /mnt/mtd/subapp/syscmd is started and the commands that need to\n be executed are passed to syscmd via shared memory.\n\n 1. When the value of the incoming parameter cmd is set, the parameter\n NTP_SERVER can be used to set the time synchronization server for the device. 2. The GET /getclock callback function does not check the value of\n NTP_SERVER and saves the relevant fields, then it creates a\n   CMDQ_SET_SYS_TIME message to be pressed into cmdQueue.\n\n 3. The corresponding CMDQ_SET_SYS_TIME message processing function of\n cmdQueue reads the relevant fields and splices the following shell command\n into the shared memory, resulting in a remote command execution vulnerability.\n/opt/extra/subapp/ntpclient -s -t -h %s > %s &\", v4, \"/tmp/ntp.dat\"\n\n Vulnerability Fix: In the updated firmware, we notice that before saving the\nNTP_SERVER parameter, the resolve_ip() function is called to encapsulate the\ninet_aton() function to check if the input is a correct IP address.\n\n The process is as follows.\n\n 1. For parameters in URL format, libadns.so library is called for domain name\n resolving, if it success, the ip address is written into ipAddr and return True; otherwise return False. 2. For IP addresses, write directly to ipAddr and return True.\n\n## Recommendations\n\n### We recommend that Merit LILIN DVR/NVR users check and update the firmware\n system and set strong login credentials for the devices.\n\n We recommend users monitor and block the urls on the IoC list.\n\n## Contact us\n\n```\n\n-----\n\n### Readers are always welcomed to reach us on twitter, or email to netlab at 360 dot cn.\n\n## IoC list\n\n### MD5\n```\n0bf1fd0cfa9ced2d95e17f4d9cf10d34\n1c3b2a0738476c609656515c5422002e\n1c7735dba999c106197bb8defb143925\n1f56696725930ae35428fbdb7c953ce0\n2b1e0f7a3fcf3478ea726a3b04a9e601\n6e90346591e95a623c8a16695c1b36cd\n7d8fb579f1d3a4320fcc5e712970d84e\n8b8800449bf9729e00b41729632699f6\n8f481d0da94b964e4061cd96892386d4\n20b89f0640215b0180b357ce2d07dc10\n43c477a3df65c2ecd4580dc944208d59\n51de7b96b43a4062d578561becff713c\n60d6a7a725221e7772dbd192aaa3f872\n267e120fc765784f852ed6b2fa939f46\n614ca6d9c18fe15db1e8683c9e5caeb8\n64714ff03f088a9702faf9adbdc9f2d6\n32887409ed42e8e6df21c5600e572102\na18266a67bbf45d8bb19bd6f46519587\nafdb1f3312b3029143e9f2d09b92f2a1\nce8bf6ed38037792e25160a37b23cd4f\nf9887d332e35f9901ef507f88b5e06cb\nfcaff61a5de5e44083555a29ee4f5246\nfeaf1296790d3e1becef913add8ba542\n\n URL\n\n```\n\n-----\n\n```\nhttp://2.57.122.167:5858/f\nhttp://2.57.122.167:5858/uwu/arm\nhttp://2.57.122.167:5858/uwu/arm5\nhttp://2.57.122.167:5858/uwu/arm6\nhttp://2.57.122.167:5858/uwu/arm7\nhttp://2.57.122.167:5858/uwu/m68k\nhttp://2.57.122.167:5858/uwu/mips\nhttp://2.57.122.167:5858/uwu/mpsl\nhttp://2.57.122.167:5858/uwu/ppc\nhttp://2.57.122.167:5858/uwu/sh4\nhttp://2.57.122.167:5858/uwu/spc\nhttp://2.57.122.167:5858/uwu/x86\nhttp://2.57.122.167:5858/webos/whoareyou.arm\nhttp://2.57.122.167:5858/webos/whoareyou.arm5\nhttp://2.57.122.167:5858/webos/whoareyou.arm6\nhttp://2.57.122.167:5858/webos/whoareyou.arm7\nhttp://2.57.122.167:5858/webos/whoareyou.m68k\nhttp://2.57.122.167:5858/webos/whoareyou.mips\nhttp://2.57.122.167:5858/webos/whoareyou.mpsl\nhttp://2.57.122.167:5858/webos/whoareyou.ppc\nhttp://2.57.122.167:5858/webos/whoareyou.sh4\nhttp://2.57.122.167:5858/webos/whoareyou.spc\nhttp://2.57.122.167:5858/webos/whoareyou.x86\n\n### IP\n2.57.122.167     Romania        ASN48090       Pptechnology\nLimited\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-03 - Another LILIN DVR 0-day being used to spread Mirai.pdf"
    ],
    "report_names": [
        "2020-12-03 - Another LILIN DVR 0-day being used to spread Mirai.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536002,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1653751488,
    "ts_modification_date": 1653751488,
    "files": {
        "pdf": "https://archive.orkl.eu/df42f174b2028a771fbead2f71b833b45d6e78f7.pdf",
        "text": "https://archive.orkl.eu/df42f174b2028a771fbead2f71b833b45d6e78f7.txt",
        "img": "https://archive.orkl.eu/df42f174b2028a771fbead2f71b833b45d6e78f7.jpg"
    }
}