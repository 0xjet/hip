{
    "id": "3a1eafab-e515-4ec1-a64f-2f82aae96344",
    "created_at": "2022-10-25T16:48:19.183575Z",
    "updated_at": "2025-03-27T02:09:08.012959Z",
    "deleted_at": null,
    "sha1_hash": "3935d58c55bf257dff7b3c263f60e35ea2ab736c",
    "title": "Cisco's Talos Intelligence Group Blog: New VPNFilter malware targets at least 500K networking devices worldwide",
    "authors": "",
    "file_creation_date": "2018-05-24T08:37:50Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 453624,
    "plain_text": "y\nInformation\n\n\np\nCenter\n\n\ny pp\nCommunities\n\n\nBlog\n\n\n**W E D N E S D AY, M AY 2 3, 2 0 1 8**\n\n# New VPNFilter malware targets at least 500K networking devices worldwide\n\n## INTRO\n\nFor several months, Talos has been working with public- and private-sector threat intelligence\n\npartners and law enforcement in researching an advanced, likely state-sponsored or state-affiliated\n\nactor's widespread use of a sophisticated modular malware system we call \"VPNFilter.\" We have\n\n\nSearch Blog\n\n\n**S UB S C R IB E TO OUR FE E D**\n\nPosts\n\nComments\n\n[Subscribe via Email](https://www.talosintelligence.com/blog_subscription)\n\n**B LOG A R C HIV E**\n\n[▼ 2 01 8](javascript:void(0)) (74)\n\n[▼ M AY](javascript:void(0)) (11)\n\nNew VPNFilter malware targets at\n\nleast 500K networ...\n\n[Beers with Talos EP29 - This is a](https://blog.talosintelligence.com/2018/05/beers-with-talos-ep29-this-is-psa-stop.html)\n\nPSA: Stop Clicki...\n\n[TeleGrab - Grizzly Attacks on Secure](https://blog.talosintelligence.com/2018/05/telegrab.html)\n\nMessaging\n\n[Vulnerability Spotlight: Multiple](https://blog.talosintelligence.com/2018/05/multiple-acrobat-reader-vulns.html)\n\nAdobe Acrobat Re...\n\n[Threat Roundup for May 04 - 11](https://blog.talosintelligence.com/2018/05/threat-roundup-0504-0511.html)\n\n\n-----\n\nWhile this isn't definitive by any means, we have also observed VPNFilter, a potentially destructive\n\nmalware, actively infecting Ukrainian hosts at an alarming rate, utilizing a command and control (C2)\n\ninfrastructure dedicated to that country. Weighing these factors together, we felt it was best to\n\npublish our findings so far prior to completing our research. Publishing early means that we don't yet\n\nhave all the answers — we may not even have all the questions — so this blog represents our\n\nfindings as of today, and we will update our findings as we continue our investigation.\n\nBoth the scale and the capability of this operation are concerning. Working with our partners, we\n\nestimate the number of infected devices to be at least 500,000 in at least 54 countries. The known\n\ndevices affected by VPNFilter are Linksys, MikroTik, NETGEAR and TP-Link networking equipment in\n\nthe small and home office (SOHO) space, as well at QNAP network-attached storage (NAS)\n\ndevices. No other vendors, including Cisco, have been observed as infected by VPNFilter, but our\n\nresearch continues. The behavior of this malware on networking equipment is particularly\n\nconcerning, as components of the VPNFilter malware allows for theft of website credentials and\n\nmonitoring of Modbus SCADA protocols. Lastly, the malware has a destructive capability that can\n\nrender an infected device unusable, which can be triggered on individual victim machines or en\n\nmasse, and has the potential of cutting off internet access for hundreds of thousands of victims\n\nworldwide.\n\nThe type of devices targeted by this actor are difficult to defend. They are frequently on the\n\nperimeter of the network, with no intrusion protection system (IPS) in place, and typically do not\n\nhave an available host-based protection system such as an anti-virus (AV) package. We are unsure\n\nof the particular exploit used in any given case, but most devices targeted, particularly in older\n\nversions, have known public exploits or default credentials that make compromise relatively\n\nstraightforward. All of this has contributed to the quiet growth of this threat since at least 2016.\n\nThis post provides the technical findings you would normally see in a Talos blog. In addition, we will\n\ndetail some thoughts on the tradecraft behind this threat, using our findings and the background of\n\nour analysts, to discuss the possible thought process and decisions made by the actor. We will also\n\n\n[Microsoft Patch Tuesday - May 2018](https://blog.talosintelligence.com/2018/05/microsoft-patch-tuesday-may-2018.html)\n\n[Beers with Talos EP 28 - APT, BGP,](https://blog.talosintelligence.com/2018/05/beers-with-talos-ep-28-pt-bgp-rces-and.html)\n\nRCEs, and an Ol...\n\n[Vulnerability Spotlight: MySQL Multi-](https://blog.talosintelligence.com/2018/05/vulnerability-spotlight-mysql-mmm.html)\n\nMaster Manage...\n\n[Threat Round Up for April 27 to May](https://blog.talosintelligence.com/2018/05/threat-round-up-0427-0504.html)\n\n04\n\n[► A P RI L](javascript:void(0)) (21)\n\n[► M A RC H](javascript:void(0)) (10)\n\n[► FE BRU A RY](javascript:void(0)) (14)\n\n[► J A N U A RY](javascript:void(0)) (18)\n\n[► 2 01 7](javascript:void(0)) (172)\n\n[► 2 01 6](javascript:void(0)) (98)\n\n[► 2 01 5](javascript:void(0)) (62)\n\n[► 2 01 4](javascript:void(0)) (67)\n\n[► 2 01 3](javascript:void(0)) (30)\n\n[► 2 01 2](javascript:void(0)) (53)\n\n[► 2 01 1](javascript:void(0)) (23)\n\n[► 2 01 0](javascript:void(0)) (93)\n\n[► 2 009](javascript:void(0)) (146)\n\n[► 2 008](javascript:void(0)) (37)\n\n**R E C OM M E N DE D B LOG S**\n\n[C I S C O BL O G](https://blogs.cisco.com)\n\nDelivering IoT with Best-in-Class Wi-Fi\n[through the Aironet Developer](https://blogs.cisco.com/enterprise/cisco-aironet-access-points-as-a-platform)\nPlatform\n\n[C L A M A V® BL O G](http://blog.clamav.net/)\n\n[ClamAV 0.100.0 has been released!](https://feedproxy.google.com/~r/Clamav/~3/takVpuywnTk/clamav-01000-has-been-released.html)\n\n\n-----\n\n## Brief technical breakdown\n\nThe VPNFilter malware is a multi-stage, modular platform with versatile capabilities to support both\n\nintelligence-collection and destructive cyber attack operations.\n\nThe stage 1 malware persists through a reboot, which sets it apart from most other malware that\n\ntargets internet-of-things devices because malware normally does not survive a reboot of the\n\ndevice. The main purpose of stage 1 is to gain a persistent foothold and enable the deployment of\n\nthe stage 2 malware. Stage 1 utilizes multiple redundant command and control (C2) mechanisms to\n\ndiscover the IP address of the current stage 2 deployment server, making this malware extremely\n\nrobust and capable of dealing with unpredictable C2 infrastructure changes.\n\nThe stage 2 malware, which does not persist through a reboot, possesses capabilities that we have\n\ncome to expect in a workhorse intelligence-collection platform, such as file collection, command\n\nexecution, data exfiltration and device management. However, some versions of stage 2 also\n\npossess a self-destruct capability that overwrites a critical portion of the device's firmware and\n\nreboots the device, rendering it unusable. Based on the actor's demonstrated knowledge of these\n\ndevices, and the existing capability in some stage 2 versions, we assess with high confidence that\n\nthe actor could deploy this self-destruct command to most devices that it controls, regardless of\n\nwhether the command is built into the stage 2 malware.\n\nIn addition, there are multiple stage 3 modules that serve as plugins for the stage 2 malware. These\n\nplugins provide stage 2 with additional functionality. As of this writing, we are aware of two plugin\n\nmodules: a packet sniffer for collecting traffic that passes through the device, including theft of\n\nwebsite credentials and monitoring of Modbus SCADA protocols, and a communications module\n\nthat allows stage 2 to communicate over Tor. We assess with high confidence that several other\n\nplugin modules exist, but we have yet to discover them.\n\n\n-----\n\n## Tradecraft discussion\n\nWe assess with high confidence that this malware is used to create an expansive, hard-to-attribute\n\ninfrastructure that can be used to serve multiple operational needs of the threat actor. Since the\n\nff t d d i l iti t l d b b i i di id l li i ti it d t d\n\n\n-----\n\nAdvanced threat actors, including nation-states, will try to make attribution of their cyber activities\n\nextremely difficult, unless it is in their interest for it to be openly known that they conducted a\n\nspecific act. To this end, advanced threat actors use multiple techniques, including co-opting\n\ninfrastructure owned by someone else to conduct their operations. The actor could easily use\n\ndevices infected with this malware as hop points before connecting to their final victim in order to\n\nobfuscate their true point of origin.\n\nThe malware can also be leveraged to collect data that flows through the device. This could be for\n\nstraightforward data-collection purposes, or to assess the potential value of the network that the\n\ndevice serves. If the network was deemed as having information of potential interest to the threat\n\nactor, they may choose to continue collecting content that passes through the device or to\n\npropagate into the connected network for data collection. At the time of this posting, we have not\n\nbeen able to acquire a third-stage plugin that would enable further exploitation of the network served\n\nby the device. However, we have seen indications that it does exist, and we assess that it is highly\n\nlikely that such an advanced actor would naturally include that capability in malware that is this\n\nmodular.\n\nFinally, this malware could be used to conduct a large-scale destructive attack by using the \"kill\"\n\ncommand, which would render some or all of the physical devices unusable. This command is\n\npresent in many of the stage 2 samples we've observed, but could also be triggered by utilizing the\n\n\"exec\" command available in all stage 2 samples. In most cases, this action is unrecoverable by\n\nmost victims, requiring technical capabilities, know-how, or tools that no consumer should be\n\nexpected to have. We are deeply concerned about this capability, and it is one of the driving reasons\n\nwe have been quietly researching this threat over the past few months.\n\n## Observed activities of concern\n\n\n-----\n\nWhile our research continues, we have also observed activity potentially associated with this actor\n\nthat indicates possible data exfiltration activity.\n\nIn early May, we observed infected devices conducting TCP scans on ports 23, 80, 2000 and 8080.\n\nThese ports are indicative of scanning for additional Mikrotik and QNAP NAS devices, which can be\n\nfound using these ports. These scans targeted devices in more than 100 countries.\n\nWe also used our telemetry to discover potentially infected devices globally. We evaluated their\n\ncollective behavior to try and identify additional features of the C2 infrastructure. Many of these\n\nvictim IPs appeared to demonstrate behavior that strongly indicated data exfiltration.\n\nFinally, on May 8, we observed a sharp spike in VPNFilter infection activity. Almost all of the newly\n\nacquired victims were located in Ukraine. Also of note, a majority of Ukrainian infections shared a\n\nseparate stage 2 C2 infrastructure from the rest of the world, on IP 46.151.209[.]33. By this point,\n\nwe were aware of the code overlap between BlackEnergy and VPNFilter and that the timing of\n\nprevious attacks in Ukraine suggested that an attack could be imminent. Given each of these\n\nfactors, and in consultation with our partners, we immediately began the process to go public before\n\ncompleting our research.\n\nAs we continued to move forward with the public disclosure, we observed another substantial\n\nincrease in newly acquired VPNFilter victims focused in Ukraine on May 17. This continued to drive\n\nour decision to publish our research as soon as possible.\n\n\n-----\n\nDiagram 1. New observed VPNFilter infections over time\n\n## Defending against this threat\n\nDefending against this threat is extremely difficult due to the nature of the affected devices. The\n\nmajority of them are connected directly to the internet, with no security devices or services between\n\nthem and the potential attackers. This challenge is augmented by the fact that most of the affected\n\ndevices have publicly known vulnerabilities which are not convenient for the average user to patch.\n\nAdditionally, most have no built-in anti-malware capabilities. These three facts together make this\n\nthreat extremely hard to counter, resulting in extremely limited opportunities to interdict malware,\n\nremove vulnerabilities, or block threats.\n\nDespite these challenges, Talos has released protections for this threat from multiple angles, to try\n\nto take advantage of the limited options that exist. We developed and deployed more than 100 Snort\n\nsignatures for the publicly known vulnerabilities for the devices that are associated with this threat.\n\nThese rules have been deployed in the public Snort set, and can be used by anyone to help defend\n\ntheir devices. In addition, we have done the usual blacklisting of domains/IPs as appropriate and\n\ni i f h h h i d i h hi h h h d b h Ci\n\n\n-----\n\n[with international law enforcement and our fellow members of the Cyber Threat Alliance in advance](https://www.cyberthreatalliance.org/)\n\nof this publication so they could move quickly to help counter this threat more broadly.\n\n## Recommendations\n\nWe recommend that:\n\nUsers of SOHO routers and/or NAS devices reset them to factory defaults and reboot\nthem in order to remove the potentially destructive, non-persistent stage 2 and stage 3\nmalware.\n\nInternet service providers that provide SOHO routers to their users reboot the routers on\ntheir customers' behalf.\n\nIf you have any of the devices known or suspected to be affected by this threat, it is\nextremely important that you work with the manufacturer to ensure that your device is\nup to date with the latest patch versions. If not, you should apply the updated patches\nimmediately.\n\nISPs work aggressively with their customers to ensure their devices are patched to the\nmost recent firmware/software versions.\n\nDue to the potential for destructive action by the threat actor, we recommend out of an abundance\n\nof caution that these actions be taken for all SOHO or NAS devices, whether or not they are known\n\nto be affected by this threat.\n\n## Multi-Stage Technical Details\n\n\n-----\n\nAt the time of this publication, we do not have definitive proof on how the threat actor is exploiting\n\nthe affected devices. However, all of the affected makes/models that we have uncovered had well\nknown, public vulnerabilities. Since advanced threat actors tend to only use the minimum resources\n\nnecessary to accomplish their goals, we assess with high confidence that VPNFilter required no\n\nzero-day exploitation techniques.\n\nSTAGE 1 (PERSISTENT LOADER)\n\nVPNFilter's stage 1 malware infects devices running firmware based on Busybox and Linux, and is\n\ncompiled for several CPU architectures. The main purpose of these first-stage binaries is to locate\n\na server providing a more fully featured second stage, and to download and maintain persistence for\n\nthis next stage on infected devices. It is capable of modifying non-volatile configuration memory\n\n(NVRAM) values and adds itself to crontab, the Linux job scheduler, to achieve persistence. This is\n\na departure from previous IoT malware, like Mirai, which is ephemeral and disappears with a simple\n\ndevice reboot.\n\nTalos analyzed samples for MIPS and x86 processors. The C2 communication and additional\n\nmalware downloads occur over Tor or SSL-encrypted connections. While the binaries themselves\n\nare not obfuscated beyond being stripped, some strings are stored in an encrypted form, and are\n\nonly decrypted at runtime. The decryption routine looked suspiciously similar to RC4 in the static\n\nanalysis, but it looks like the malware authors got the initialization of the S-boxes wrong. During the\n\npermutation step, values are XOR’d, but not swapped. Analysis of this RC4 implementation shows\n\nthat it is identical to the implementation used in BlackEnergy, which is believed by law enforcement\n\n\nagencies to originate with a state actor.\n\n\n-----\n\nThe RC4 initialization XORs the values in the permutation phase of the internal state initialization. As\n\nyou can see in the last basic block, the code doesn't swap the values of S[i] and S[j] (compared to\n\nth RC4 d d b l )\n\n\n-----\n\nOnce the malware has completed initialization, it starts to download pages from the seed URLs. In\n\nthe MIPS sample cache and all but one URL of the x86 sample, the URLs pointed to\n\nPhotobucket.com, an image-sharing host. The malware downloads the first image from the gallery\n\nthe URL is referencing, and then proceeds to extract the download server's IP address. The IP\n\naddress is extracted from six integer values for GPS latitude and longitude in the EXIF information.\n\nIf stage 1 fails to connect to, download an image from, or successfully acquire an IP address via an\n\nimage from Photobucket, the malware reaches out to a backup domain, toknowall[.]com, to\n\ndownload an image and attempt the same process.\n\nIf the attempt to the backup domain fails, stage 1 opens a listener that waits for a specific trigger\n\npacket to open a connection for the actor to connect interactively to the device. When the listener\n\nopens, it checks its public IP from api.ipify[.]org and stores it for later comparison. Then, when any\n\npacket arrives on any port, the listener performs a series of checks to identify a trigger packet. If\n\nthe packet meets a predefined set of criteria, it will extract an IP address from the packet and\n\nattempt a stage 2 download.\n\nLISTENER ACTIONS:\n\n1. Inspects all TCP/IPv4 packets with a SYN flag set\n\n2. Checks that the destination IP matches what it found when the listener opened (Note: if the\n\n\n-----\n\n5. The bytes directly after that 4 byte marker are interpreted as an IP so \\x01\\x02\\x03\\x04\n\nbecomes -> 1.2.3[.]4\n\n6. Calls out to the newly received IP as usual for stage 2\n\n7. Confirms that stage 2 is at least 1,001 bytes (Note: this is much smaller than the other\n\ncallout methods which require the stage 2 to be 100,000 or more)\n\nSTAGE 2 (NON-PERSISTENT)\n\nThe stage 2 malware first sets up the working environment by creating a modules folder\n\n(/var/run/vpnfilterm) and a working directory (/var/run/vpnfilterw). Afterward, it will run in a loop,\n\nwhere it first reaches out to a C2 server, and then executes commands retrieved from the C2. The\n\ncommand names are encrypted with the same broken RC4 function as in stage 1. Fortunately, older\n\nversions of x86 stage 2 sample were very verbose, and debug printed all the steps it performed.\n\nNewer versions of the x86 stage 2 did not contain the debug prints, nor did the MIPS sample.\n\nThe x86 sample can perform the following operations:\n\nkill: Overwrites the first 5,000 bytes of /dev/mtdblock0 with zeros, and reboots the\ndevice (effectively bricking it).\n\nexec: Executes a shell command or plugin.\n\ntor: Sets the Tor configuration flag (0 or 1).\n\ncopy: Copies a file from the client to the server.\n\nseturl: Sets the URL of the current configuration panel.\n\nproxy: Sets the current proxy URL.\n\nport: Sets the current proxy port.\n\ndelay: Sets the delay between main loop executions.\n\n\n-----\n\nThe MIPS sample has the following additional operations:\n\nstop: Terminate the malware process.\n\nrelay: A misspelled version of the `delay` command from the x86 version.\n\nUntil the Tor module is installed, stage 2 will use one or more IPs stored in its configuration as\n\nSOCKS5 proxies to Tor and attempt to communicate with a control panel also found in its\n\nconfiguration. Like in stage 1, the communication between the malware and the proxy will connect\n\nover a verified SSL connection. When the Tor module is installed, it will connect to .onion domains\n\nthrough the local SOCKS5 proxy provided by the module over plain HTTP instead. We used a fake\n\nSOCKS5 proxy, which redirects all traffic to INetSim for analysis.\n\nAn example request from the malware to the server:\n\n{\n\n\"uq\":\"px(01:02:03:04:05:06)\",\n\n\"pv\":\"pPRXi686QNAPX86\",\n\n\"ad\":\"10.0.0.1\",\n\n\"bv\":\"0.11.1a/0.3.9qa\",\n\n\"nn\":\"YnVpbGRyb290\",\n\n\n-----\n\n}\n\nThe malware encodes this request into a JSON object, which is then base64-encoded and sent to\n\nthe path /bin32/update.php in the HTTP POST parameter \"me\". The user agent used in the request\n\nis peculiar (Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)), as a version \"Windows\n\nNT 5.3\" doesn't exist.\n\nuq: A unique ID for the infected device (the MAC address of the malware's network\ninterface).\n\npv: The platform version the malware is running on\n\nad: The public IP address of the malware's device\n\nbv: Version of the stage 1 loader (0.3.9qa) and the stage 2 binary (0.11.1a)\n\nnn: The node name\n\ntn: The Tor flag\n\non: The onion flag\n\nThe server's response to the message:\n\n{\n\n\"tr\":3060,\n\n\"pxs\":[\"217.12.202.40\",\"94.242.222.68\",\"91.121.109.209\"],\n\n\"tor\":\"tor 1\",\n\n\"mds\":[]\n\n\n-----\n\ntr: Sets the delay for the main loop.\n\npxs: List of panels to connect to. These are the C2 servers.\n\ntor: Sets the name and version of the Tor module.\n\nmds: A list of modules to fetch. Each entry is in the format \"<command_id> <module_id>\n<module_name> <module_args (base64-encoded)>\". The malware will download the\nmodule from /bin32/update.php by setting the POST form parameter me to the module\nname with the architecture appended, e.g., tor_i686 for the Tor module, and execute it in\neach iteration. A blank list of commands (as in the example response above) will clear\nany existing commands by deactivating them and killing any running processes\nassociated with them.\n\nSTAGE 3 (NON-PERSISTENT)\n\nWe have analyzed two plugin modules for the malware, a packet sniffer and a communication plugin\n\nthat allows the malware to communicate over Tor. We assess with high confidence that there are\n\nlikely several more that we have not yet discovered. Among the initial samples Talos acquired, there\n\nwas a plugin for the MIPS stage 2, which is a packet sniffer. It intercepts all network traffic through\n\na raw socket and looks for strings used in HTTP basic authentications. Further, it specifically tracks\n\nModbus TCP/IP packets. The resulting log file is placed in the stage 2 working directory,\n\n/var/run/vpnfilterw. This allows the attackers to understand, capture, and track the traffic flowing\n\nthrough the device.\n\nThe Tor plugin module is partially linked into stage 2, but has a separate Tor executable, which is\n\ndownloaded to /var/run/tor and run in a process separate from stage 2. The Tor binary looks like\n\nthe standard Tor client, in the form of a statically linked and stripped binary. It creates a\n\nconfiguration file in /var/run/torrc and a working directory in /var/run/tord.\n\n\n-----\n\nchallenging to defend. Its highly modular framework allows for rapid changes to the actor's\n\noperational infrastructure, serving their goals of misattribution, intelligence collection, and finding a\n\nplatform to conduct attacks.\n\nThe destructive capability particularly concerns us. This shows that the actor is willing to burn\n\nusers' devices to cover up their tracks, going much further than simply removing traces of the\n\nmalware. If it suited their goals, this command could be executed on a broad scale, potentially\n\nrendering hundreds of thousands of devices unusable, disabling internet access for hundreds of\n\nthousands of victims worldwide or in a focused region where it suited the actor's purposes.\n\nWhile the threat to IoT devices is nothing new, the fact that these devices are being used by\n\nadvanced nation-state actors to conduct cyber operations, which could potentially result in the\n\ndestruction of the device, has greatly increased the urgency of dealing with this issue. We call on\n\nthe entire security community to join us in aggressively countering this threat.\n\nWe will continue to monitor VPNFilter and work with our partners to understand the threat as it\n\ncontinues to evolve in order to ensure that our customers remain protected and the public is\n\ninformed.\n\n## IOCs\n\nAs stated previously, we highly suspect that there are additional IOCs and versions of this malware\n\nthat we are not currently aware of. The following list of IOCs comprises what we know as of this\n\ndate.\n\n## Known C2 Domains and IPs\n\n\n-----\n\nphotobucket[.]com/user/nikkireed11/library\n\nphotobucket[.]com/user/kmila302/library\n\nphotobucket[.]com/user/lisabraun87/library\n\nphotobucket[.]com/user/eva_green1/library\n\nphotobucket[.]com/user/monicabelci4/library\n\nphotobucket[.]com/user/katyperry45/library\n\nphotobucket[.]com/user/saragray1/library\n\nphotobucket[.]com/user/millerfred/library\n\nphotobucket[.]com/user/jeniferaniston1/library\n\nphotobucket[.]com/user/amandaseyfried1/library\n\nphotobucket[.]com/user/suwe8/library\n\nphotobucket[.]com/user/bob7301/library\n\ntoknowall[.]com\n\nASSOCIATED WITH THE 2ND STAGE\n\n91.121.109[.]209\n\n217.12.202[.]40\n\n94.242.222[.]68\n\n82.118.242[.]124\n\n46.151.209[.]33\n\n217.79.179[.]14\n\n91.214.203[.]144\n\n95.211.198[.]231\n\n195.154.180[.]60\n\n5.149.250[.]54\n\n91.200.13[.]76\n\n94.185.80[.]82\n\n62.210.180[.]229\n\nh3 kd4 i k [ ] i /bi 32/ d t h\n\n\n-----\n\n1ST STAGE MALWARE\n\n50ac4fcd3fbc8abcaa766449841b3a0a684b3e217fc40935f1ac22c34c58a9ec\n\n0e0094d9bd396a6594da8e21911a3982cd737b445f591581560d766755097d92\n\n2ND STAGE MALWARE\n\n9683b04123d7e9fe4c8c26c69b09c2233f7e1440f828837422ce330040782d17\n\nd6097e942dd0fdc1fb28ec1814780e6ecc169ec6d24f9954e71954eedbc4c70e\n\n4b03288e9e44d214426a02327223b5e516b1ea29ce72fa25a2fcef9aa65c4b0b\n\n9eb6c779dbad1b717caa462d8e040852759436ed79cc2172692339bc62432387\n\n37e29b0ea7a9b97597385a12f525e13c3a7d02ba4161a6946f2a7d978cc045b4\n\n776cb9a7a9f5afbaffdd4dbd052c6420030b2c7c3058c1455e0a79df0e6f7a1d\n\n8a20dc9538d639623878a3d3d18d88da8b635ea52e5e2d0c2cce4a8c5a703db1\n\n0649fda8888d701eb2f91e6e0a05a2e2be714f564497c44a3813082ef8ff250b\n\n3RD STAGE PLUGINS\n\nf8286e29faa67ec765ae0244862f6b7914fcdde10423f96595cb84ad5cc6b344\n\nafd281639e26a717aead65b1886f98d6d6c258736016023b4e59de30b7348719\n\nSELF-SIGNED CERTIFICATE FINGERPRINTS\n\nd113ce61ab1e4bfcb32fb3c53bd3cdeee81108d02d3886f6e2286e0b6a006747\n\nc52b3901a26df1680acbfb9e6184b321f0b22dd6c4bb107e5e071553d375c851\n\nf372ebe8277b78d50c5600d0e2af3fe29b1e04b5435a7149f04edd165743c16d\n\nbe4715b029cbd3f8e2f37bc525005b2cb9cad977117a26fac94339a721e3f2a5\n\n27af4b890db1a611d0054d5d4a7d9a36c9f52dffeb67a053be9ea03a495a9302\n\n\n-----\n\ncd75d3a70e3218688bdd23a0f618add964603736f7c899265b1d8386b9902526\n\n110da84f31e7868ad741bcb0d9f7771a0bb39c44785055e6da0ecc393598adc8\n\n909cf80d3ef4c52abc95d286df8d218462739889b6be4762a1d2fac1adb2ec2b\n\n044bfa11ea91b5559f7502c3a504b19ee3c555e95907a98508825b4aa56294e4\n\nc0f8bde03df3dec6e43b327378777ebc35d9ea8cfe39628f79f20b1c40c1b412\n\n8f1d0cd5dd6585c3d5d478e18a85e7109c8a88489c46987621e01d21fab5095d\n\nd5dec646c957305d91303a1d7931b30e7fb2f38d54a1102e14fd7a4b9f6e0806\n\nc0f8bde03df3dec6e43b327378777ebc35d9ea8cfe39628f79f20b1c40c1b412\n\n## Known Affected Devices\n\nThe following devices are known to be affected by this threat. Based on the scale of this research,\n\nmuch of our observations are remote and not on the device, so it is difficult to determine specific\n\nversion numbers and models in many cases. It should be noted that all of these devices have\n\npublicly known vulnerabilities associated with them.\n\nGiven our observations with this threat, we assess with high confidence that this list is incomplete\n\nand other devices could be affected.\n\nLINKSYS DEVICES:\n\nE1200\n\nE2500\n\nWRVS4400N\n\nMIKROTIK ROUTEROS VERSIONS FOR CLOUD CORE ROUTERS:\n\n1016\n\n1036\n\n\n-----\n\nDGN2200\n\nR6400\n\nR7000\n\nR8000\n\nWNR1000\n\nWNR2000\n\nQNAP DEVICES:\n\nTS251\n\nTS439 Pro\n\n## Other QNAP NAS devices running QTS software\n\nTP-LINK DEVICES:\n\nR600VPN\n\n## COVERAGE\n\nCisco customers are protected by this threat by Cisco Advanced Malware Protection (AMP), Cloud\n\nWeb Security (CWS), Network Security, ThreatGrid, Umbrella, and Web Security Appliance (WSA).\n\nAdditionally, StealthWatch and StealthWatch Cloud can be utilized to find devices communicating\n\nwith the known C2 IP addresses and domains.\n\nIn StealthWatch, two items need to be configured to send an alert that there are communications to\n\nnefarious IP addresses.\n\n\n-----\n\ncommunications presently occurring.\n\nThis validation can be achieved by right-clicking on the recently created \"VPNFilter C2\"\nHost Group and navigating to Top -> Conversations -> Total.\n\nOnce you are viewing these top conversations, you will easily be able to see if there is\nactive traffic.\n\nIn the event that there is no active traffic, an alarm can be created to generate alerts in\nthe event that traffic to or from any of the \"VPNFilter C2\" hosts is observed.\n\nThis alarm can be configured by creating a custom event and selecting the appropriate\nhosts or objects in the web user interface.\n\nVPNFILTER SPECIFIC SNORT DETECTION:\n\n45563 45564 46782 46783\n\nSNORT RULES THAT PROTECT AGAINST KNOWN VULNERABILITIES IN AFFECTED DEVICES:\n\n25589 26276 26277 26278 26279 29830 29831 44743 46080 46081 46082 46083 46084 46085\n\n46086 46287 46121 46122 46123 46124 41445 44971 46297 46298 46299 46300 46301 46305\n\n46306 46307 46308 46309 46310 46315 46335 46340 46341 46342 46376 46377 37963 45555\n\n46076 40063 44643 44790 26275 35734 41095 41096 41504 41698 41699 41700 41748 41749\n\n41750 41751 44687 44688 44698 44699 45001 46312 46313 46314 46317 46318 46322 46323\n\n40866 40907 45157\n\nCLAMAV SIGNATURES:\n\nUnix.Trojan.Vpnfilter-6425811-0\n\n\n-----\n\nP O S T E D BY [WI L L I AM L ARG E NT AT](https://www.blogger.com/profile/12206979422726316011) 9 : 0 0 AM\n\nL ABE L S : [AM P, C L AM AV](https://blog.talosintelligence.com/search/label/AMP) [, I O T, S NO RT RU L E S, TAL O S, T H RE AT I NT E L L I G E NC E, T H RE AT](https://blog.talosintelligence.com/search/label/IoT)\n\n[RE S E ARC H, VP NFI L E R](https://blog.talosintelligence.com/search/label/VPNFiler)\n\nS H A RE T H I S\n\nP O S T\n\n4 COMMENTS:\n\n[JACOB BAKKE MAY 23, 2018 AT 12:55 PM](https://www.blogger.com/profile/09952491432165225050)\n\nI've always wondered why there isn't anti-malware available for every IOT device. Security by\n\nobscurity isn't security.\n\n\n[Reply](javascript:;)\n\n\n[JULIAN ELISCHER MAY 23, 2018 AT 2:56 PM](https://www.blogger.com/profile/16737043025299805880)\n\nThe trouble with home gateway devices is that as they are the �nal step on the way out the\n\ndoor, there is nowhere to monitor tra�c to them. And you can't really log into them to check\n\non what's in cron.\n\n\n[Reply](javascript:;)\n\n\n[MALWHEER MAY 23, 2018 AT 3:17 PM](https://www.blogger.com/profile/10849527781939298785)\n\n\n-----\n\n[Reply](javascript:;)\n\n\n[SVEN HOEK MAY 23, 2018 AT 8:25 PM](https://www.blogger.com/profile/09470747070700475448)\n\nPhotobucket - should be removing all exif information upon upload, anyway. WTF\n\n\n[Reply](javascript:;)\n\n\nEnter your comment...\n\n\n**PublishPublish**\n\n\nPOST A COMMENT\n\n\n\n[Select profile...]\n\n\n[H O M E](https://blog.talosintelligence.com/)\n\n\n**PreviewPreview**\n\n\nO L D E R\n\nP O S T\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.05.23.New_VPNFilter/VPNFilter.pdf"
    ],
    "report_names": [
        "VPNFilter"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041348,
    "ts_creation_date": 1527151070,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/3935d58c55bf257dff7b3c263f60e35ea2ab736c.pdf",
        "text": "https://archive.orkl.eu/3935d58c55bf257dff7b3c263f60e35ea2ab736c.txt",
        "img": "https://archive.orkl.eu/3935d58c55bf257dff7b3c263f60e35ea2ab736c.jpg"
    }
}