{
    "id": "dfc858cb-1e8d-4125-aeb6-0e033110a5a5",
    "created_at": "2022-10-25T16:48:12.00735Z",
    "updated_at": "2025-03-27T02:16:26.228504Z",
    "deleted_at": null,
    "sha1_hash": "f48dd456559ef8f158786535e70c8fb86f193086",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-02-11T09:19:17Z",
    "file_modification_date": "2020-02-11T09:19:17Z",
    "file_size": 2378275,
    "plain_text": "[Trend Micro](https://www.trendmicro.com/)\n[About TrendLabs Security Intelligence Blog](https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/)\n\nSearch:\n\nGo to…\n\n[Home](http://blog.trendmicro.com/trendlabs-security-intelligence/)\nCategories\n\n[Home  »  Exploits  »  ShadowGate Returns to Worldwide Operations With Evolved Greenflash Sundown](https://blog.trendmicro.com/trendlabs-security-intelligence/)\nExploit Kit\n\n# ShadowGate Returns to Worldwide Operations With Evolved Greenflash Sundown Exploit Kit\n\n[Posted on:June 27, 2019 at 7:16 am](https://blog.trendmicro.com/trendlabs-security-intelligence/2019/06/)\n[Posted in:Exploits](https://blog.trendmicro.com/trendlabs-security-intelligence/category/exploits/)\nAuthor:\n[Joseph C Chen (Fraud Researcher)](https://blog.trendmicro.com/trendlabs-security-intelligence/author/josephcchen/)\n\n0\n\nAfter almost two years of sporadic restricted activity, the ShadowGate campaign has started delivering\ncryptocurrency miners with a newly upgraded version of the Greenflash Sundown [exploit kit. The campaign](https://blog.trendmicro.com/trendlabs-security-intelligence/new-bizarro-sundown-exploit-kit-spreads-locky/)\nhas been spotted targeting global victims, after operating mainly in Asia.\n\n**_Background of the Greenflash Sundown exploit kit_**\n\n\nGo to…\n\n\n-----\n\nkits through the compromised ad servers of Revive/OpenX advertising software. After a [takedown operation](https://blog.talosintelligence.com/2016/09/shadowgate-takedown.html)\non September 2016, the campaign tried to hide their activities.\n\n[However, that same year they also developed their own exploit kit, which we named Greenflash Sundown,](https://blog.trendmicro.com/trendlabs-security-intelligence/new-bizarro-sundown-exploit-kit-spreads-locky/)\nlikely to avoid using exploit kit services from the underground market. At the end of 2016, the campaign\nstopped their injection attacks on the compromised ad servers and restricted their activity to spreading\nransomware via compromised [South Korean websites. In April 2018, ShadowGate was spotted](https://asec.ahnlab.com/1199) spreading\ncryptocurrency miners with Greenflash Sundown. However, the injection was limited to servers in East Asian\ncountries and soon stopped.\n\nAfter a period of relatively restrained activities, we noticed ShadowGate attacking through ad servers again\nthis June. However, these attacks were not just targeting regional victims but global ones. Visitors to websites\nembedded with malicious advertisements (from the compromised ad servers) were redirected to the\nGreenflash Sundown exploit kit and infected with a Monero cryptocurrency miner. This is the most notable\nactivity we have seen from this group since 2016. Despite their low profile over the past couple of years, it\nseems that they have been continuously developing and evolving their exploit kit.\n\nBelow is a report on how the Greenflash Sundown exploit kit has changed since we discovered it in 2016,\nincluding details of their latest activity.\n\n**_Greenflash Sundown refined evasion and targeting techniques_**\n\nShadowGate is invested in the continuous development of their exploit kit. In 2018, Greenflash Sundown was\n[spotted integrating the Flash exploit for CVE-2018-4878 prior to other exploit kits. Greenflash Sundown was](https://malware.dontneedcoffee.com/2018/03/CVE-2018-4878.html)\nthen [identified using another Flash exploit for CVE-2018-15982 this April. The continuous updates of the kit](https://twitter.com/vigilantbeluga/status/1114216872725995520)\nto include new exploits allows it to maintain its infection rate.\n\n_Figure 1. Attack flow of ShadowGate and the Greenflash Sundown exploit kit_\n\n\n-----\n\n_Figure 2. Timeline of ShadowGate Activity (data from Trend Micro Smart Protection Network)_\n\n_Figure 3. Country distribution of ShadowGate Activity (data from Trend Micro Smart Protection Network_\n\n_from June 7, 2019 to June 24, 2019)_\n\nDuring the latest attack of ShadowGate that started this June, we found that they had another version of the\nGreenflash Sundown exploit kit with two updates.\n\n_Figure 4. Greenflash Sundown exploit kit traffic pattern (top) and exploits for CVE-2018-15982 (Flash_\n\n_version 31.0.0.153) (bottom)_\n\nThe first change involves the integration of a [public key encryption algorithm to protect their exploit kit](https://www.khanacademy.org/computing/ap-computer-science-principles/the-internet/tls-secure-data-transport/a/public-key-encryption)\npayload. Last November, we saw that this exploit kit used the same encryption technique to protect their\nmalware payload during the last infection stage. However, this time they used the encryption from the first\nf i ti t t ll f th i t ffi d i i f ti\n\n\n-----\n\na unique secret key during each attack. The secret key will be encrypted by a public key and then securely\nsent to the exploit kit. The exploit kit — using a private key — can recover the secret key and use it to\nencrypt the malicious payload that will be delivered with the [RC4 algorithm (a cipher algorithm requiring a](https://www.vocal.com/cryptography/rc4-encryption-algoritm/)\nshared key for decryption). The payload will then be sent to the victim, who will decrypt it with the secret\nkeys.\n\nThis encryption technique is supposed to prevent security solutions from detecting their malicious payload as\nit is transferred to the victim. In theory, because the secret key only exists in memory and is not supposed to\nbe transferred directly in plaintext, it is difficult for a threat analyst to find the secret key and decrypt the\nmalicious payload.\n\nThe use of public key encryption algorithm was also seen in the [exploit kit Underminer, which we discovered](https://blog.trendmicro.com/trendlabs-security-intelligence/new-underminer-exploit-kit-delivers-bootkit-and-cryptocurrency-mining-malware-with-encrypted-tcp-tunnel/)\nlast year. However, we found that the hackers behind the Greenflash Sundown exploit kit made a mistake\nwith their encryption. They used the generated nonce not only for generating the secret key but also as a key\n[of RC4 to encrypt victim’s WebGL information before sending it to exploit kit server. The generated nonce](https://get.webgl.org/)\nwas actually sent in plaintext during their communication, which makes it accessible and readable. With the\nnonce, it becomes possible to reproduce the secret key and decrypt the malicious payload offline.\n\n_[Figure 5. The Greenflash Sundown exploit kit encrypts the secret key with JSEncrypt library (deobfuscated)](https://github.com/travist/jsencrypt)_\n\nThe latest version of the Greenflash Sundown exploit kit also features an updated PowerShell loader. Since\nNovember 2018, we noticed the exploit kit started to use a PowerShell loader, which makes it capable of\n[fileless malware infection. The upgraded loader in this new version is now capable of collecting a profile of](https://www.trendmicro.com/vinfo/pl/security/news/security-technology/security-101-the-rise-of-fileless-threats-that-abuse-powershell)\nthe victim’s environment and sending the information to the exploit kit server.\n\nThis allows its operators to be more precise in their targeting. If the victim’s profile fits their specifications,\nthe malware will deliver its payload. Otherwise, the server will return an empty response. The upgrade also\nhelps them avoid sandboxes or honeypots that can capture their malware. The information taken from the\nvictim includes OS details, user name, video card, hard disk information, and antivirus products.\n\n_Figure 6. The PowerShell loader sends victim’s profile and loads a malware payload with fileless infection_\n\n**_Recommendations and Solutions_**\n\n\n-----\n\ntargets. These criminals sometimes spend years refining their attacks, as seen with Greenflash Sundown. To\nstay ahead of the curve, users should always keep their systems and applications updated to the latest version.\nThe vulnerabilities targeted by these exploit kits usually have available fixes, so applying a solid patching and\nupdate strategy mitigates much of the risk. To further strengthen security, enterprises are also advised to\nenable a [multilayered protection system that can actively block threats and malicious URLs from the gateway](https://www.trendmicro.com/en_us/business.html)\nto the endpoint.\n\n[A proactive, multilayered approach to security is key against threats that exploit vulnerabilities.](https://www.trendmicro.com/us/enterprise/cloud-solutions/deep-security/index.html) Trend Micro\n[Deep Security and Trend Micro™ Vulnerability Protection also provide](https://www.trendmicro.com/us/enterprise/product-security/vulnerability-protection/) [virtual patching that protects servers](https://www.trendmicro.com/us/enterprise/product-security/vulnerability-protection/)\nand endpoints from threats that abuse vulnerabilities in critical applications or websites.\n\nTrend Micro customers are protected by the following Deep Security rule:\n\n1009405-Adobe Flash Player Use After Free Vulnerability (CVE-2018-15982)\n\n[Trend Micro™ OfficeScan™ with](http://www.trendmicro.com/us/enterprise/product-security/officescan/) [XGen™ endpoint security has](http://www.trendmicro.com/us/business/xgen/index.html) [Vulnerability Protection that shields](https://www.trendmicro.com/us/enterprise/product-security/vulnerability-protection/)\n[endpoints from identified and unknown vulnerability exploits even before patches are even deployed.](http://www.trendmicro.com/us/business/complete-user-protection/index.html) Trend\nMicro™ Smart Protection Suites and [Worry-Free™ Business Security protect end users and businesses from](http://www.trendmicro.com/us/small-business/product-security/)\nthese threats by detecting and blocking malicious files and all related malicious URLs.\n\n**_Additional insights from Chaoying Liu and Nakaya Yoshihiro_**\n\nThis was also earlier [reported by Malwarebytes.](https://blog.malwarebytes.com/threat-analysis/2019/06/greenflash-sundown-exploit-kit-expands-via-large-malvertising-campaign/)\n\n**_Indicators of Compromise_**\n\n**File**\n**Indicator** **Detection**\n**name**\n\nShadowGate/WordsJS\nfastimage[.]site\nmalicious domain\n\nShadowGate/WordsJS\nad4989[.]world\nmalicious domain\n\nGreenFlash Sundown EK\nadsfast[.]site\ndomain\n\nGreenFlash Sundown EK\nadsfast[.]info\ndomain\n\nGreenFlash Sundown EK\ncdn-cloud[.]club\ndomain\naeb073b5ee2e083aba987c7fcaab7265aabe6e5e2cade821db6d46e4 Coinminer.Win32.MALXMR.S hp_3.e\n06e21e95 MBM4 xe\n\n58002d0b8acd1a539503d8ea02ff398e7ad079e0b856087f0ca30d76 Coinminer.Win64.TOOLXMR. hp_6.e\n7588be4e SMA xe\n\n\n_Updated July 1, 4:20PM: Updated to clarify the product of Revive/OpenX that was compromised._\n\n\nLearn how to protect Enterprises, Small Businesses, and Home Users from ransomware:\n\n[ENTERPRISE](http://www.trendmicro.com/us/security-intelligence/enterprise-ransomware/index.html) » [SMALL BUSINESS](http://www.trendmicro.com/us/security-intelligence/small-business-ransomware/index.html) » [HOME](http://www.trendmicro.com/us/home/consumer-ransomware/index.html) »\n\n\n-----\n\n## Security Predictions for 2020\n\nCybersecurity in 2020 will be viewed through many lenses — from differing attacker motivations and\ncybercriminal arsenal to technological developments and global threat intelligence — only so\ndefenders can keep up with the broad range of threats.\n[Read our security predictions for 2020.](https://www.trendmicro.com/vinfo/us/security/research-and-analysis/predictions/2020)\n\n## Business Process Compromise\n\nAttackers are starting to invest in long-term operations that target specific processes enterprises rely on.\nThey scout for vulnerable practices, susceptible systems and operational loopholes that they can\nleverage or abuse. To learn more, [read our Security 101: Business Process Compromise.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/security-101-business-process-compromise)\n\n## Recent Posts\n\n[Outlaw Updates Kit to Kill Older Miner Versions, Targets More Systems](https://blog.trendmicro.com/trendlabs-security-intelligence/outlaw-updates-kit-to-kill-older-miner-versions-targets-more-systems/)\n[Malicious Optimizer and Utility Android Apps on Google Play Communicate with Trojans that Install](https://blog.trendmicro.com/trendlabs-security-intelligence/malicious-apps-on-google-play-communicate-with-trojans-install-malware-perform-mobile-ad-fraud/)\nMalware, Perform Mobile Ad Fraud\n[Security Analysis of Devices That Support SCPI and VISA Protocols](https://blog.trendmicro.com/trendlabs-security-intelligence/security-analysis-of-devices-that-support-scpi-and-visa-protocols/)\n[January Patch Tuesday: Update List Includes Fixes for Internet Explorer, Remote Desktop,](https://blog.trendmicro.com/trendlabs-security-intelligence/january-patch-tuesday-update-list-includes-fixes-for-internet-explorer-remote-desktop-cryptographic-bugs/)\nCryptographic Bugs\n[First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT](https://blog.trendmicro.com/trendlabs-security-intelligence/first-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/)\nGroup\n\n## Popular Posts\n\n[Security Analysis of Devices That Support SCPI and VISA Protocols](https://blog.trendmicro.com/trendlabs-security-intelligence/security-analysis-of-devices-that-support-scpi-and-visa-protocols/)\n\n[January Patch Tuesday: Update List Includes Fixes for Internet Explorer, Remote Desktop,](https://blog.trendmicro.com/trendlabs-security-intelligence/january-patch-tuesday-update-list-includes-fixes-for-internet-explorer-remote-desktop-cryptographic-bugs/)\nCryptographic Bugs\n\n[First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT](https://blog.trendmicro.com/trendlabs-security-intelligence/first-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/)\nGroup\n\n[Why Running a Privileged Container in Docker Is a Bad Idea](https://blog.trendmicro.com/trendlabs-security-intelligence/why-running-a-privileged-container-in-docker-is-a-bad-idea/)\n\n[Looking into Attacks and Techniques Used Against WordPress Sites](https://blog.trendmicro.com/trendlabs-security-intelligence/looking-into-attacks-and-techniques-used-against-wordpress-sites/)\n\n## Stay Updated\n\nEmail Subscription\n\n\n-----\n\n[Home and Home Office](http://www.trendmicro.com/us/home/index.html)\n|\n[For Business](http://www.trendmicro.com/us/business/index.html)\n|\n[Security Intelligence](http://www.trendmicro.com/us/security-intelligence/index.html)\n|\n[About Trend Micro](http://www.trendmicro.com/us/about-us/index.html)\n\n[Asia Pacific Region (APAC): Australia /](http://www.trendmicro.com.au/au/home/index.html) [New Zealand, 中国, ⽇本, 대한민국, 台灣](http://www.trendmicro.co.nz/nz/home/index.html)\nLatin America Region (LAR): [Brasil, México](http://br.trendmicro.com/br/home/index.html)\nNorth America Region (NABU): [United States, Canada](http://www.trendmicro.com/us/index.html)\nEurope, Middle East, & Africa Region (EMEA): [France, Deutschland / Österreich / Schweiz, Italia,](http://www.trendmicro.fr/)\n[Россия, España, United Kingdom / Ireland](http://www.trendmicro.com.ru/)\n\n[Privacy Statement](http://www.trendmicro.com/us/about-us/legal-policies/privacy-statement/index.html)\n[Legal Policies](http://www.trendmicro.com/us/about-us/legal-policies/index.html)\n\nCopyright © 2020 Trend Micro Incorporated. All rights reserved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.06.27.ShadowGate_Returns/ShadowGate%20Returns%20to%20Worldwide%20Operations%20With%20Evolved%20Greenflash%20Sundown%20Exploit%20Kit.pdf"
    ],
    "report_names": [
        "ShadowGate Returns to Worldwide Operations With Evolved Greenflash Sundown Exploit Kit"
    ],
    "threat_actors": [
        {
            "id": "6b9fc913-06c6-4432-8c58-86a3ac614564",
            "created_at": "2022-10-25T16:07:24.185236Z",
            "updated_at": "2025-03-27T02:02:10.135195Z",
            "deleted_at": null,
            "main_name": "SideWinder",
            "aliases": [
                "APT-C-17",
                "APT-Q-39",
                "BabyElephant",
                "GroupA21",
                "HN2",
                "Hardcore Nationalist",
                "Rattlesnake",
                "Razor Tiger",
                "SideWinder",
                "T-APT-04"
            ],
            "source_name": "ETDA:SideWinder",
            "tools": [
                "BroStealer",
                "Capriccio RAT",
                "callCam"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "173f1641-36e3-4bce-9834-c5372468b4f7",
            "created_at": "2022-10-25T15:50:23.349637Z",
            "updated_at": "2025-03-27T02:00:55.450857Z",
            "deleted_at": null,
            "main_name": "Sidewinder",
            "aliases": [
                "Sidewinder",
                "T-APT-04"
            ],
            "source_name": "MITRE:Sidewinder",
            "tools": [
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d0c0a5ea-3066-42a5-846c-b13527f64a3e",
            "created_at": "2023-01-06T13:46:39.080551Z",
            "updated_at": "2025-03-27T02:00:02.992026Z",
            "deleted_at": null,
            "main_name": "RAZOR TIGER",
            "aliases": [
                "SideWinder",
                "APT-C-17",
                "T-APT-04"
            ],
            "source_name": "MISPGALAXY:RAZOR TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1581412757,
    "ts_modification_date": 1581412757,
    "files": {
        "pdf": "https://archive.orkl.eu/f48dd456559ef8f158786535e70c8fb86f193086.pdf",
        "text": "https://archive.orkl.eu/f48dd456559ef8f158786535e70c8fb86f193086.txt",
        "img": "https://archive.orkl.eu/f48dd456559ef8f158786535e70c8fb86f193086.jpg"
    }
}