{
    "id": "7afdf918-90e4-47cb-8108-ee49f1256a12",
    "created_at": "2023-01-12T15:08:58.193147Z",
    "updated_at": "2025-03-27T02:05:48.902575Z",
    "deleted_at": null,
    "sha1_hash": "774c463d2be4aeea38338b59cb860985cf058615",
    "title": "2019-09-06 - PsiXBot Now Using Google DNS over HTTPS and Possible New Sexploitation Module",
    "authors": "",
    "file_creation_date": "2022-05-28T22:00:55Z",
    "file_modification_date": "2022-05-28T22:00:55Z",
    "file_size": 1676617,
    "plain_text": "# PsiXBot Now Using Google DNS over HTTPS and Possible New Sexploitation Module\n\n**[proofpoint.com/us/threat-insight/post/psixbot-now-using-google-dns-over-https-and-possible-new-sexploitation-module](https://www.proofpoint.com/us/threat-insight/post/psixbot-now-using-google-dns-over-https-and-possible-new-sexploitation-module)**\n\nSeptember 6, 2019\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nPsiXBot Now Using Google DNS over HTTPS and Possible New Sexploitation Module\n\n\n-----\n\nSeptember 06, 2019 The Proofpoint Threat Insight Team\n\n## Overview\n\n[Since posting our last PsiXBot update, the group or actor behind this malware has continued to make](https://www.proofpoint.com/us/threat-insight/post/psixbot-continues-evolve-updated-dns-infrastructure)\nchanges. Most notably, we have observed\n\nThe introduction of DNS over HTTPS\nA new version number (1.0.3)\nNew Fast Flux infrastructure\nA newly observed \"PornModule\"\nDistribution via Spelevo EK\n\nWhile tracking this threat, Proofpoint researchers noticed a change in the DNS resolution technique\ndescribed in our previous blog, implementing Google’s DNS over HTTPS (DoH) service. We observed\nsamples exhibiting this behavior as dropped payloads via the Spelevo Exploit Kit. These newer\nsamples (later versions 1.0.2 and 1.0.3) now contain hard-coded C&C domains to be resolved with\nGoogle’s DoH service.\n\n## Analysis of PsiXBot's use of Google's DNS over HTTPS Service\n\nProofpoint researchers observed the use of DNS over HTTPS to retrieve the IP address for the\ncommand and control (C&C) domains. We observed this change while the version number for PsiXBot\nwas still 1.0.2. This update was a stark departure from the previous update[1], which utilized a more\nconvoluted process involving a URL shortener service to gather the IP Address for the C&C\ninfrastructure. On or around August 19, 2019, Proofpoint researchers observed a fresh PsiXBot\nsample which began to utilize DNS over HTTPS (DoH) via Google's DoH service. It was around this\ntime that we also observed the samples resuming a practice from version 1.0.1, in which the C&C\ndomains were hardcoded in the malware samples with RC4 encryption. In the 1.0.2 and 1.0.3 versions\nwhich use DoH, there is no longer a ping sent to either the DNS or C&C servers to ensure uptime.\n\nMany companies now offer DNS over HTTPS as a service to enhance privacy on behalf of the user,\nspeed up DNS queries, and provide a form of security during an encrypted DNS session. The\nauthor(s) behind PsiXBot have now chosen Google's DoH service for routing their DNS queries to\n\n\n-----\n\nreturn the IP addresses of the C&C domains. By using Google s DoH service, it allows attackers to\nhide the DNS query to the C&C domain behind HTTPS. Unless SSL/TLS is being inspected by Man in\nthe Middle (MitM), DNS queries to the C&C server will go unnoticed. This is expressed in sample code\nlike the following:\n\n_Figure 1: Screenshot showing both hardcoded RC4-encrypted C&C domains as well as code showing_\n_the use of Google’s DNS over HTTPS service to return the C&C IP address._\n\nBecause the newer samples of PsiXBot are hardcoding the C&C domains, they are simply placed into\nthe GET request to https://dns.google[.]com as a variable. From the initial samples we saw utilizing the\nDoH method we observed a request and response as such:\n\n\n-----\n\n_Figure 2: Network traffic showing a GET request to the Google DoH service, returning the IP address_\n_for a PsiXBot C&C server._\n\nThis will return the C&C domains’ IP address(es) in a JSON blob. Of note, this is not the standard RFC\n8484[3] DoH format as one researcher[2] pointed out but is rather the JSON API format, provided by\nGoogle. Furthermore, all of the C&C servers observed by Proofpoint researchers utilized HTTPS\nprovided by Let's-Encrypt certificates.\n\nFast Flux is a method for rapidly changing DNS entries using a botnet of compromised hosts to hide\nmalicious activities like phishing and malware distribution. In the most recent samples from PsiXBot,\nwe observed evidence of newly implemented Fast Flux infrastructure in the responses for C&C\ndomains, both in standard DNS queries as well as what is returned via DoH:\n\n\n-----\n\n_Figure 3: A screenshot of Wireshark showing the response from a DNS server observing multiple IP_\n_addresses associated with the C&C domain greentowns[.]hk, possibly indicating fast flux_\n_infrastructure._\n\n## Further Analysis\n\nOn or around September 5, 2019, Proofpoint researchers observed the version number for PsiXBot\nincrement to version 1.0.3.\n\n\n-----\n\n_Figure 4: Newly updated version 1.0.3 for PsiXBot._\n\nThe C&C check-in sequence remained largely the same, but was modified slightly to include a check\nfor whether the infected machine is a member of a domain. In version 1.0.2, a parameter of\n\"user_group\" was used, but in 1.0.3, it simply does a binary check for domain membership. The C&C\ntraffic continues to be POSTed and the client body data is still RC4-encrypted using a hardcoded key\nfound in the sample. An example of the updated decrypted C&C traffic is below:\n\n_Figure 5: Decrypted traffic to PsiXBot C&C infrastructure_\n\nAs evident in the previously analyzed versions of this malware, the C&C response continues to be a\nJSON blob which contains further instructions as well as some arguments for the modules to be run.\n\nThe features for version 1.0.3 are largely the same as previously analyzed versions, but now contain a\nnewly observed module called \"PornModule\". \"GetProcList\" is new to these samples, but is\nfunctionally similar to the \"GetProcessList\" task observed in version 1.0.1.The current features\ncontained in samples with version 1.0.3 are as follows, with the new features identified in bold:\n\nDownloadAndExecute\nExecute\nGetInstalledSoft\nGetOutlook\nGetProcList\nGetSteallerCookies\nGetSteallerPasswords\nSelfDelete\nStartComplexModule\nStartCryptoModule\nStartFGModule\nStartKeylogger\nStartNewComplexModule\n**StartPorn**\nStartSchedulerModule\nStartSpam\n\n## New Module Analysis\n\n**StartPorn**\n\n\n-----\n\nThe PornModule, assembly name **chouhero, is a module likely designed for blackmail/sexploitation**\npurposes. Similar to functionality observed recently in other malware campaigns[4], this module\ncontains a dictionary containing pornography-related keywords used to monitor open window titles. If a\nwindow matches the text, it will begin to record audio and video on the infected machine. Once\nrecorded, the video is saved with a \".avi\" extension and is sent to the C&C. Typically, these recordings\nare used for extortion purposes. Of note, the malware uses the Windows DirectShow library to capture\naudio and video. This module appears incomplete and will likely be modified in future releases.\n\n_Figure 6: PsiXBot’s likely sexploitation/blackmailing PornModule containing keywords to monitor open_\n_windows which begins recording audio and video if found._\n\n**StartSpam**\n\nWhile this module is not new, it has been recently observed returning to infected machines with more\nrobust spam campaign commands and data, as it now contains updated message verbiage and\nattachment information. Below is an example of a recent configuration for the SpamModule returned\n\n\n-----\n\nfrom the C&C server:\n\n_Figure 7: Configuration details retrieved from PsiXBot C&C infrastructure._\n\n_Figure 8: Sample malicious email template sent from the PsiXBot-infected system’s Outlook account_\n\n\n-----\n\n_Figure 9: A look at the malicious document spammed from an infected machine’s Outlook account._\n\nThe document itself contains malicious macros that will retrieve a payload of PsiXBot, and contains the\nabove SpamModule configuration for further replication.\n\n## Distribution via Spelevo EK\n\nOn or around August 29, 2019, we observed a PsiXBot sample\n(afe7192cd7e4be82352ba43f29d54a1a) with version 1.0.2 being dropped as a payload from Spelevo\nExploit Kit. As of now, the code being dropped by the Spelevo EK contains samples with version 1.0.3.\n\n## Conclusion\n\n[As noted in the previous Threat Insight Blog post on PsiXBot, this malware is under active](https://www.proofpoint.com/us/threat-insight/post/psixbot-continues-evolve-updated-dns-infrastructure)\ndevelopment and continues to evolve. By expanding the feature set of the included modules and the\noverall capabilities of this malware, the actor or team behind its development appears to be seeking\nfeature parity with other similar malware on the market. The group also included anti-analysis and\ndetection evasion features by implementing DNS over HTTPS and fast flux infrastructure. We will\ncontinue to monitor PsiXBot as the current pace of updates suggests further refinements will not be far\nbehind.\n\n## References\n\n\n-----\n\n[1] https://www.proofpoint.com/us/threat-insight/post/psixbot-continues-evolve-updated-dnsinfrastructure\n\n[2] [https://twitter.com/seckle_ch/status/1169558035649433600](https://twitter.com/seckle_ch/status/1169558035649433600)\n\n[3] [https://tools.ietf.org/html/rfc8484](https://tools.ietf.org/html/rfc8484)\n\n[4] [https://www.welivesecurity.com/2019/08/08/varenyky-spambot-campaigns-france/](https://www.welivesecurity.com/2019/08/08/varenyky-spambot-campaigns-france/)\n\n**Indicators of Compromise (IOCs)**\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\nfnoetwotb4nwob524o.hk Domain PsiXBot\nCommand\nand Control\n\nv3no4to24wto24.hk Domain PsiXBot\nCommand\nand Control\n\nworldismine.hk Domain PsiXBot\nCommand\nand Control\n\nthe-best.hk Domain PsiXBot\nCommand\nand Control\n\ngreentowns.hk Domain PsiXBot\nCommand\nand Control\n\nwonderlands.hk Domain PsiXBot\nCommand\nand Control\n\nfastyoutube.info Domain PsiXBot\nCommand\nand Control\n\nrealty4rent.hk Domain PsiXBot\nCommand\nand Control\n\n\n-----\n\ne7332d507230fb218cf905a040fe83e81675a44d3da02fb737a2039d04ebea5e Sha256\nHash\n\n979862ba03fd40ed9679989972f7c174332ca2b51efaa1578bdb04dc2a652fff Sha256\nHash\n\nf93973c29125db0d62dbf8be9b73b0957dbc552b5fd277ae0f2e974724ab25bb Sha256\nHash\n\n1961454dca8e742ca967fa1581228b65fdd8a6da9080702d8c11c801aea28920 Sha256\nHash\n\ne847d5fd623a60788776fc662b41abfe8578d85b4136ea6a9933132fe894dc4f Sha256\nHash\n\ne847d5fd623a60788776fc662b41abfe8578d85b4136ea6a9933132fe894dc4f Sha256\nHash\n\n05aa0ca087dc142b96c64c9f5f5f60072b9d5dff57181eb46d6178e73aa9f7fd Sha256\nHash\n\n94bb94f50f9a641b902c031788b1f069a6cc2822fdb99cb833f17f067a05a32a Sha256\nHash\n\n**ET and ETPRO Suricata/Snort Signatures**\n\n2837734 - ETPRO TROJAN Win32/PsiXBot CnC Checkin\n\n2838108 - ETPRO TROJAN Observed Malicious SSL Cert (PsiXBot CnC)\n\n2838127 - ETPRO TROJAN Observed Malicious SSL Cert (PsiXBot CnC)\n\n2838194 - ETPRO TROJAN Observed Malicious SSL Cert (PsiXBot CnC)\n\n2838213 - ETPRO TROJAN Observed Malicious SSL Cert (PsiXBot CnC)\n\n2838289 - ETPRO TROJAN Observed Malicious SSL Cert (PsiXBot CnC)\n\n2838290 - ETPRO TROJAN Observed Malicious SSL Cert (PsiXBot CnC)\n\n2838309 - ETPRO TROJAN Observed Malicious SSL Cert (PsiXBot CnC)\n\nSubscribe to the Proofpoint Blog\n\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nPornModule\n\nPsiXBot\nMalDoc\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-06 - PsiXBot Now Using Google DNS over HTTPS and Possible New Sexploitation Module.pdf"
    ],
    "report_names": [
        "2019-09-06 - PsiXBot Now Using Google DNS over HTTPS and Possible New Sexploitation Module.pdf"
    ],
    "threat_actors": [
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536138,
    "ts_updated_at": 1743041148,
    "ts_creation_date": 1653775255,
    "ts_modification_date": 1653775255,
    "files": {
        "pdf": "https://archive.orkl.eu/774c463d2be4aeea38338b59cb860985cf058615.pdf",
        "text": "https://archive.orkl.eu/774c463d2be4aeea38338b59cb860985cf058615.txt",
        "img": "https://archive.orkl.eu/774c463d2be4aeea38338b59cb860985cf058615.jpg"
    }
}