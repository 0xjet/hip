{
    "id": "cd17b733-7ffd-48f5-b891-1dd99991b42b",
    "created_at": "2023-01-12T15:05:45.693957Z",
    "updated_at": "2025-03-27T02:13:34.588545Z",
    "deleted_at": null,
    "sha1_hash": "18d00f9fd1392dedeec0e88fa60c9bd8772bf9a9",
    "title": "2021-04-21 - Massive Qlocker ransomware attack uses 7zip to encrypt QNAP devices",
    "authors": "",
    "file_creation_date": "2022-05-27T02:08:36Z",
    "file_modification_date": "2022-05-27T02:08:36Z",
    "file_size": 2385148,
    "plain_text": "# Massive Qlocker ransomware attack uses 7zip to encrypt QNAP devices\n\n**[bleepingcomputer.com/news/security/massive-qlocker-ransomware-attack-uses-7zip-to-encrypt-qnap-devices/](https://www.bleepingcomputer.com/news/security/massive-qlocker-ransomware-attack-uses-7zip-to-encrypt-qnap-devices/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nApril 21, 2021\n01:44 PM\n482\n\n**_Update 4/22/21: A bug was discovered last night that allowed victims to recover their 7zip_**\npassword for free but was fixed soon after being discovered. You can find more info in the\nupdate below.\n\n**_Update 4/24/21: A_** frequently asked questions section has been added to the bottom of the\narticle.\n\nA massive ransomware campaign targeting QNAP devices worldwide is underway, and\nusers are finding their files now stored in password-protected 7zip archives.\n\nThe ransomware is called Qlocker and began targeting QNAP devices on April 19th, 2021.\nSince then, there has been an enormous amount of activity in our support forum, and the\n[ID-Ransomware ransomware identification site has seen a surge of submissions from](https://id-ransomware.malwarehunterteam.com/)\nvictims.\n\n\n-----\n\n**ID-R submissions from Qlocker victims**\n[According to reports from victims in a BleepingComputer Qlocker support topic, the](https://www.bleepingcomputer.com/forums/t/749247/qlocker-qnap-nas-ransomware-encrypting-with-extension-7z/)\nattackers use 7-zip to move files on QNAP devices into password-protected archives. While\nthe files are being locked, the QNAP Resource Monitor will display numerous '7z' processes\nwhich are the 7zip command-line executable.\n\n**7zip seen running in the QNAP Resource Monitor**\nWhen the ransomware has finished, the QNAP device's files will be stored in passwordprotected 7-zip archives ending with the .7z extension. To extract these archives, victims\nwill need to enter a password known only to the attacker.\n\n\n-----\n\n**Password-protected 7zip archive**\nAfter QNAP devices are encrypted, users are left with a !!!READ_ME.txt ransom note that\nincludes a unique client key that the victims need to enter to log into the ransomware's Tor\npayment site.\n\n**Qlocker ransom note**\nFrom the Qlocker ransom notes seen by BleepingComputer, all victims are told to pay 0.01\nBitcoins, which is approximately $557.74, to get a password for their archived files.\n\n\n-----\n\n**Qlocker Tor payment site**\nAfter paying the ransom and entering a valid Bitcoin transaction ID, the Tor payment site will\ndisplay the password for the victim's 7Zip archives, as shown below.\n\n\n-----\n\n**The password displayed after a ransom is paid**\nThis password is unique to the victim and cannot be used on other victims' devices.\n\n**Update 4/22/21 09:15 AM EST: Early this morning, BleepingComputer was contacted by**\n[security researcher Jack Cable about a bug he discovered in the Qlocker Tor site that](https://twitter.com/jackhcable)\nallowed users to recover their 7zip passwords for free.\n\nUsing this bug, victims could take a Bitcoin transaction ID from a person who had already\npaid and slightly alter it. When they submitted the altered transaction ID into the Qlocker Tor\nsite, it accepted it as payment and displayed the victim's 7zip password.\n\nLast night, Cable had been privately helping people recover their passwords, and\narrangements were being made with Emsisoft to create a help system to better exploit this\nweakness.\n\nSadly, an hour after we learned of the bug, the ransomware operators caught on and fixed\nit.\n\nUpdate: it looks like this may have been fixed by the ransomware operators,\nunfortunately. I apologize if I was not able to get to yours before it was fixed. In total\ndecrypted around 50 keys worth $27k.\n\n[â€” Jack Cable (@jackhcable) April 22, 2021](https://twitter.com/jackhcable/status/1385112173974745091?ref_src=twsrc%5Etfw)\n\nAt this point, there is no way to recover the files without a password, which can no longer be\nretrieved for free.\n\n## QNAP believes attackers are exploiting vulnerabilities\n\n\n-----\n\nRecently QNAP resolved critical vulnerabilities that could allow a remote actor to gain full\naccess to a device and execute ransomware.\n\nQNAP fixed these two vulnerabilities on April 16th with the following descriptions:\n\n[More information about these vulnerabilities can be found in a blog post by the SAM](https://securingsam.com/new-vulnerabilities-allow-complete-takeover/)\nSeamless Network research team, who disclosed the bugs to QNAP in October and\nNovember.\n\nQNAP told BleepingComputer that they believe Qlocker exploits the CVE-2020-36195\nvulnerability to execute the ransomware on vulnerable devices.\n\nDue to this, it is strongly recommended to update QTS, Multimedia Console, and the Media\nStreaming Add-on to the latest versions.\n\n\"QNAP strongly urges that all users immediately install the latest Malware Remover version\nand run a malware scan on QNAP NAS. The Multimedia Console, Media Streaming Addon, and Hybrid Backup Sync apps need to be updated to the latest available version as well\nto further secure QNAP NAS from ransomware attacks. QNAP is urgently working on a\n[solution to remove malware from infected devices,\" QNAP stated in a security advisory.](https://www.qnap.com/en/news/2021/response-to-qlocker-ransomware-attacks-take-actions-to-secure-qnap-nas)\n\nQNAP warns that if a device's files have been encrypted, they should not reboot the device\nand instead immediately run the malware scanner.\n\n\"If user data is encrypted or being encrypted, the NAS must not be shut down. Users should\nrun a malware scan with the latest Malware Remover version immediately, and then contact\n[QNAP Technical Support at https://service.qnap.com/,\" advises QNAP.](https://service.qnap.com/)\n\nWhile the malware scanner and security updates will not recover your files, they will protect\nyou from future attacks using this vulnerability.\n\n## Qlocker frequently asked questions\n\nTrying to follow all the information in this article's comments and the Qlocker support topics\ncan quickly become overwhelming.\n\nTo help QNAP owners and Qlocker victims, we have put together this FAQ regarding the\nattack using various contributions from QNAP users who have posted comments to this\n[article and the Qlocker help topic.](https://www.bleepingcomputer.com/forums/t/749247/qlocker-qnap-nas-ransomware-encrypting-with-extension-7z/)\n\n### How are my files get encrypted?\n\nThe Qlocker threat actors exploit vulnerabilities in QNAP devices that allow them to execute\ncommands on your NAS device remotely.\n\n\n-----\n\nWhile most ransomware operations deploy specially crafted malware programs, the Qlocker\nattackers are simply scanning for QNAP devices and using vulnerabilities to remotely\nlaunch the built-in 7zip archive utility to password-protect files.\n\nWith this type of attack, QNAP devices are not being infected with any malware but simply\nbeing abused by vulnerabilities taking advantage of software already bundled with the\noperating system.\n\nIt is unclear what vulnerabilities are being used, but it is believed to be one of the following,\nwhich QNAP fixed this month.\n\nQNAP has told BleepingComputer that they believe it is the CVE-2020-36195 vulnerability\nthat is being exploited.\n\nUpdates for all of these vulnerabilities were released earlier this month and should be\ninstalled immediately.\n\n### My files are being encrypted! What should I do?\n\nIf you see that your QNAP files are actively being encrypted, you should immediately\ndisable myQNAPcloud and change the default web admin port from port 8080 to another\nport number.\n\nThese changes will effectively prevent the threat actors from issuing further 7zip commands\nto password-protect your files.\n\nNow that the threat actors can no longer access your device remotely, you should terminate\nany active '7z' processes that may be running to stop any current encryption commands.\n\nYou can do this by logging into your QNAP device via SSH or Telnet using the following\nguide.\n\nThen issue the following command at the console to terminate all 7z processes.\n```\nkill -9 `ps |grep sbin/7z|grep -v grep|awk '{ print $1 }'`\n\n### Is there a way to get our passwords for free?\n\n```\nTuesday night, security researcher Jack Cable discovered a method that tricked the\nransomware payment site into thinking a payment was made and to display the victim's\npasswords.\n\nUnfortunately, this bug was short-lived, and the bug no longer works.\n\nFor users who have not restarted their QNAP device since being encrypted, it may be\npossible to recover your password from the '7z.log' file using a command offered by a\nvictim\n\n\n-----\n\nThe following command must be entered from the QNAP console when you are connected\nvia SSH or Telnet.\n```\ncd /usr/local/sbin; printf '#!/bin/sh \\necho $@\\necho\n$@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x 7z.sh; mv 7z 7z.bak; mv\n7z.sh 7z;\n\n```\nOnce you execute the following command, you can look in the /mnt/HDA_ROOT/7z.log for\na 7z command-line showing your password, as shown in the example below.\n```\na -mx = 0 -sdel -pmFyBIvp55M46kSxxxxxYv4EIhx7rlTD [FOLDER PATH]\n\n```\nIn the above case, the password is 'mFyBIvp55M46kSxxxxxYv4EIhx7rlTD.'\n\nA [YouTube video has been created to demonstrate how to perform this task.](https://www.youtube.com/watch?v=aq_cIdY_ksQ)\n\nIf you have run QNAP's Malware Remover tool, the program will have moved the 7z.log to\n'/share/CACHEDEV1_DATA/.qpkg/MalwareRemover/7z.log'.\n\nQNAP is [emailing customers instructions with more information on possibly recovering a](https://www.bleepingcomputer.com/forums/t/749247/qlocker-qnap-nas-ransomware-encrypting-with-extension-7z-read-metxt/?p=5172025)\npassword from the 7z.log file.\n\nUnfortunately, if you have previously restarted your device, the log file contents will be\nwiped.\n\nIn some cases, even if you have not restarted your device, the log file may be empty.\n\n### What has QNAP's response been?\n\nIn a [security advisory released Tuesday, QNAP advises users not to restart their QNAP](https://www.qnap.com/en/news/2021/response-to-qlocker-ransomware-attacks-take-actions-to-secure-qnap-nas)\ndevices and to run the latest version of the Malware Remover to help protect against\nQlocker.\n\nWhen executed, Malware Remover will perform the following tasks:\n\nRename /usr/local/sbin/7z to 7z.orig\n[Replace /usr/local/sbin/7z to 7z.orig with this script.](https://pastebin.com/mzPfhgy4)\nThe script will copy various data to the current 7z.log file and then copy that file\nto '/share/CACHEDEV1_DATA/.qpkg/MalwareRemover/7z.log'.\nLook for and quarantine the /tmp/qnap/r.py and /tmp/qnap/re.sh scripts to\nthe /tmp/qnap folder. If you have these scripts, we would love to see them, and you\ncan [submit them here.](https://www.bleepingcomputer.com/submit-malware.php?channel=3)\n\nIn addition to running Malware Remover, QNAP is advising users to immediately update to\nthe latest versions of Multimedia Console, Media Streaming Add-on, and Hybrid\n**Backup Sync through the App Center.**\n\n\n-----\n\nAfter installing the latest updates, QNAP advises customers to review their guide on best\npractices to enhance NAS security.\n\n### How to decrypt multiple files at once\n\nIf you found your passwords or paid the ransom, you can use the following command\n(thanks [ss1973) to decrypt all of your files at once from within Windows.](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n```\nSET source=C:\\Users\\thomb158\\Downloads\\5thKind\\7z\nFOR /F \"TOKENS=*\" %%F IN ('DIR /S /B \"%source%\\*.7z\"') DO \"C:\\Program Files\\7Zip\\7z.exe\" x -pPASSWORD \"%%~fF\" -o\"%%~pF\\\"\nEXIT\n\n```\nIn the above command, ' SET source= ' is the path to your encrypted files, and `-p is the`\n[password. You will also need to have installed the 7zip program.](https://www.7-zip.org/download.html)\n\nIf anyone has a command to perform these steps directly through the QNAP console,\n[please let me know.](https://www.bleepingcomputer.com/forums/index.php?app=members&module=messaging%C2%A7ion=send&do=form&fromMemberID=3)\n\n**_Update 4/24/21: Added a frequently asked questions section._**\n\n## Qlocker IOCs:\n\n### Associated Files:\n```\n!!!READ_ME.txt\n\n Ransom note text:\n!!! All your files have been encrypted !!!\nAll your files were encrypted using a private and unique key generated for the\ncomputer. This key is stored in our server and the only way to receive your key and\ndecrypt your files is making a Bitcoin payment.\nTo purchase your key and decrypt your files, please follow these steps:\n1. Dowload the Tor Browser at \"https://www.torproject.org/\". If you need help,\nplease Google for \"access onion page\".\n2. Visit the following pages with the Tor Browser:\ngvka2m4qt5fod2fltkjmdk4gxh5oxemhpgmnmtjptms6fkgfzdd62tad.onion\n3. Enter your Client Key:\n[client_key]\n\n```\n\n-----\n\n### Related Articles:\n\n[QNAP alerts NAS customers of new DeadBolt ransomware attacks](https://www.bleepingcomputer.com/news/security/qnap-alerts-nas-customers-of-new-deadbolt-ransomware-attacks/)\n\n[QNAP warns of ransomware targeting Internet-exposed NAS devices](https://www.bleepingcomputer.com/news/security/qnap-warns-of-ransomware-targeting-internet-exposed-nas-devices/)\n\n[QNAP urges customers to disable UPnP port forwarding on routers](https://www.bleepingcomputer.com/news/security/qnap-urges-customers-to-disable-upnp-port-forwarding-on-routers/)\n\n[QNAP warns severe OpenSSL bug affects most of its NAS devices](https://www.bleepingcomputer.com/news/security/qnap-warns-severe-openssl-bug-affects-most-of-its-nas-devices/)\n\n[Windows 11 KB5014019 breaks Trend Micro ransomware protection](https://www.bleepingcomputer.com/news/security/windows-11-kb5014019-breaks-trend-micro-ransomware-protection/)\n\n[7-Zip](https://www.bleepingcomputer.com/tag/7-zip/)\n[7zip](https://www.bleepingcomputer.com/tag/7zip/)\n[Archive](https://www.bleepingcomputer.com/tag/archive/)\n[NAS](https://www.bleepingcomputer.com/tag/nas/)\n[QLocker](https://www.bleepingcomputer.com/tag/qlocker/)\n[QNAP](https://www.bleepingcomputer.com/tag/qnap/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/linux-bans-university-of-minnesota-for-committing-malicious-code/)\n[Next Article](https://www.bleepingcomputer.com/news/microsoft/windows-10-task-manager-now-lets-you-throttle-resource-hungry-apps/)\n\n### Comments\n\n[Charlie50mm - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203258/charlie50mm/)\n\nHello, Sadly my qnap has been touch by this one... I'm able to go in the ssh console\nbut I don't know how search the password of 7z file. Could you help me for this task\nplease ?\n\n\n-----\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nIn the console type ps -ef and press enter.\n\nLook for a 7z command and if there is a readable password after the -p argument..\n\n[Charlie50mm - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203258/charlie50mm/)\n\nI didn't find the command, but my NAS restart since the ransomware, so did I lost the\nprevious command line ?\n\n\n-----\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\nYou have to exit the QNAP command line by typing \"0\"\n\n[mirror79 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203352/mirror79/)\n\nnot by O but by Q!\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\nSame problem here. I can log into the SSH but after typing ps -ef nothing happens\n\n\n-----\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nNo output when you type the following command and press enter?\n\nps -ef\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\nYes I already exit the Command to standard ssh comandline.\nI typed ps -ef\nand lookinf for 7z proccess, but it is something like this:\n\"/usr/local/sbin/7z a -mx=0 -sdel -p******************************** \"\n\n\n-----\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nOK then this method will not work unfortunately\n\n[Marchande - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203276/marchande/)\n\nplease tel me that al those stars are NOT a 32 character pasword\n\n[sieci - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203277/sieci/)\n\nand like this: 20402 admin 4368 R /usr/local/sbin/7z a -mx=0 -sdel p******************************** /share/CACHEDEV1\n\n\n-----\n\n[Marchande - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203276/marchande/)\n\nseems that I got nailed by this as well.. came here to monitor and see if there is ever a\nfix for it... sadly my nas rebooted and updated before the encryption was completed...\nthank the gods but there are still aLOT of files that did get hit... need to find a way to\ndecrypt every thing... posting here in hopes that some one learns something new and\nhas some ideas.\n\n[ValiantThor - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203150/valiantthor/)\n\nTry this command:\ncd /usr/local/sbin; printf '#!/bin/sh \\necho $@\\necho\n$@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x 7z.sh; mv 7z 7z.bak;\nmv 7z.sh 7z;\n\nthe encryption key would be stored in /mnt/HDA_ROOT/7z.log which you can then\nuse to decrypt\n\n\n-----\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nBe terrific if this works.\n\n[Tweeterhd - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203283/tweeterhd/)\n\nI just tried this option through a SSH connection, however, when trying to access the\n/mnt/HDA_ROOT/7z.log it tells me \"permission denied\". Is there another way to gain\naccess?\n\n\n-----\n\n[Darevx - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203332/darevx/)\n\nYes, i used MobaXterm to access /mnt/HDA_ROOT/ and download 7z.log, i managed\nto recover password from that file. Just remember not to use the first p from that word.\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\n\"Yes, i used MobaXterm to access /mnt/HDA_ROOT/ and download 7z.log, i\nmanaged to recover password from that file. Just remember not to use the first p from\nthat word.\"\n\nWhat is MobaXterm? Could you please provide some step by step instructions?\nThank you\n\n[Marchande - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203276/marchande/)\n\nnothing showing in the HDA_ROOT folder labled anything .log\n\n\n-----\n\n[LaurentH111 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203285/laurenth111/)\n\nNot working ;-(\n\n[Darevx - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203332/darevx/)\n\nGreat job, I managed to recover the password for 3 devices in this way, but I had to\ndownload 7z.log locally to be able to open it, when I tried from the command line I\nreceived a permissions error.\n\n[skiele - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203344/skiele/)\n\nThere's no 7z.log in that folder unfortunately for me\n\n\n-----\n\n[micattack - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203341/micattack/)\n\nWhat can I do when I already killed the encryption process. Will it come back after a\nreboot with the same password?\nCurrently I am leaving the qnap running and whatever the encryption was has not\ncome back (stopped processes, disconnected from Internet, etc)\n\n[mirror79 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203352/mirror79/)\n\nTHANK YOU!!! You saved me from many hours of restoring backups!!! It worked! To\neverybody: you must run the command from ValiantThor above, after this the 7z.log\nfile will reveal, download it to your local PC and open it. You will find the password\ninside.\n\n[workfor747 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203252/workfor747/)\n\nCan you just guide me how you write the code step by step <\n\nwhat You did After open ssh\n\n\n-----\n\n[Boonpot - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203384/boonpot/)\n\nHi\n\nDo I have to wait sleep 60000 finish ?\n\n[NewDayMedia - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203426/newdaymedia/)\n\nSorry for my ignorance. when I try this command I get a series of permission errors:\n\n-sh: 7z.sh: Permission denied\nchmod: 7z.sh: No such file or directory\nmv: can't rename \"7z\": Permission denied\nmv: overwrite \"7z\"?\n\nI am logged in with an administrator account. Am I doing something wrong?\nThanks.\n\n\n-----\n\n[keg415 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203291/keg415/)\n\nIt appears that as of 2021-04-11, Malware Remover now renames /usr/local/sbin/7z to\n7z.orig and replaces 7z with a wrapper script that captures and logs info about the\ncommand and parent process. And if a password option is present, it delays for a few\nseconds before running 7z.orig. So if you've replaced 7z with the little\nHDA_ROOT/7z.log script, Malware Remover may have renamed it instead of the real\n7z and be calling it instead.\n\nNote that on my QNAP TS-253D the log file is:\n/share/CACHEDEV1_DATA/.qpkg/MalwareRemover/7z.log\n\n\n-----\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nKeg, would you be able to send me the original /usr/local/sbin/7z.orig and the new\nhelper script /usr/local/sbin/7z?\n\nWould like to take a look and update the article with info.\n\nAlso, is this file readily accessible by anyone after they run the Malware Remover:\n\n/share/CACHEDEV1_DATA/.qpkg/MalwareRemover/7z.log\n\nCan users simply run the new version and open this file to get their password?\n\nIf you can PM so you can send me the files, it would be appreciated. I can be PMed at\nthis URL:\n\nhttps://www.bleepingcomputer.com/forums/index.php?\napp=members&module=messaging&section=send&do=form&fromMemberID=3\n\n\n-----\n\n[Pim65 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203647/pim65/)\n\nHi,\n\nI have this problem to, but before I new. Did the update and restart 2 days ago. Now\n80GB is encrypted I found this morning. I Have in user/local/sbin 7z.orig and 7z.so but\ncant decrypt them. Did someone found a solution to retreive the password in this\nmatter?\n\n[n3xo - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203649/n3xo/)\n\nJust logged to say thank you ValiantThor!\n\n[Melissa81 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203408/melissa81/)\n\nn3x0 - hi! So you have just done this? Had you rebooted your QNAP prior?\n\n\n-----\n\n[n3xo - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203649/n3xo/)\n\nno i didnt reboot buy the told me It rebooted itself After firmware update\n\n[keg415 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203291/keg415/)\n\n\"It appears that as of 2021-04-11, Malware Remover now renames /usr/local/sbin/7z\nto 7z.orig and replaces 7z with a wrapper script that captures and logs info about the\ncommand and parent process. And if a password option is present, it delays for a few\nseconds before running 7z.orig. So if you've replaced 7z with the little\nHDA_ROOT/7z.log script, Malware Remover may have renamed it instead of the real\n7z and be calling it instead.\nNote that on my QNAP TS-253D the log file is:\n/share/CACHEDEV1_DATA/.qpkg/MalwareRemover/7z.log\"\n\nI've not tested this, but rebooting the QNAP should restore the original\n/usr/local/sbin/7z executable, which Malware Remover will then rename to 7z.orig and\ninstall the 7z wrapper script.\n\nThe command:\n\nmore \"`getcfg MalwareRemover Install_Path -f /etc/config/qpkg.conf`/7z.log\"\n\nwill show the wrapper script log, and (hopefully) the encryption key.\n\n\n-----\n\nnshimin Photo\n[nshimin - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203823/nshimin/)\n\n\"It appears that as of 2021-04-11, Malware Remover now renames /usr/local/sbin/7z\nto 7z.orig and replaces 7z with a wrapper script that captures and logs info about the\ncommand and parent process. And if a password option is present, it delays for a few\nseconds before running 7z.orig. So if you've replaced 7z with the little\nHDA_ROOT/7z.log script, Malware Remover may have renamed it instead of the real\n7z and be calling it instead.\n\nNote that on my QNAP TS-253D the log file is:\n/share/CACHEDEV1_DATA/.qpkg/MalwareRemover/7z.log\"\n\nI have actually followed these and actually found more 7z files located here.\n\nusr\\local\\sbin\n\nThe 7z files are:\n\n7z.so\n\n7z.orig\n\n7z.bak\n\n7z\n\nUnfortunately, no 7z.log files are shown. Is there someone who might know how to get\na .log file based on the 4 files I've found? Or perhaps something I should do to these 4\nfiles.\n\n\n-----\n\n[Tweeterhd - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203283/tweeterhd/)\n\nI would like to thank ValientThor for a quick and helpful response in creating the 7z.log\nand everyone else in this comment thread who worked to help us try to overcome this\nissue. Thanks to the advice given here, commands to try, and shared youtube video\nlinks I have seen several people who have been able to retrieve their passwords and\nbegin work on extracting their files. You have provided a great service to combat what\nfeels like terrorism. For those of you who haven't been able to retrieve your files yet,\nhopefully as things progress you will have your opportunity. By the way, has anyone\nseen files like these 3 on their NAS? \".wfm_upload_7htO7Z\" ; \".wfm_upload_dSrQl1\" ;\n.wfm_upload_ez5d8Z\". I stumbled across these suspicious looking files while looking\nthrough the slew of my encrypted files and wondered if this has anything to do with\nthe 7z ransomeware (be gentle, a lot of this is new to me).\n\n[Tweeterhd - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203283/tweeterhd/)\n\n[duplicate]\n\n\n-----\n\n[Splay - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203281/splay/)\n\nAnother victim here. It got pretty much all of the small files on my business's NAS. I'm\nnot a programmer so if someone does find a fix or potential solution to decrypt the\nfiles, please post in layman terms. I'm not totally unfamiliar with using command lines\nin Windows, but I'm not as proficient on the QNAP system. Thanks in advance for\nanyone looking into this.\n\n[LaurentH111 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203285/laurenth111/)\n\nHi. I've got 2 devices impacted among 20 and i've found a piece of sh... in /root\n-rwxr-xr-x 1 admin administrators 242 2021-04-21 13:35 re.sh*\nI think that's the part deleting snapshots :\nmore re.sh\n#!/bin/sh\n\nexport PATH=\"/bin:/sbin:/usr/bin:/usr/sbin:/usr/bin/X11:/usr/local/sbin:/usr/local/bin\"\n\ndf | grep mapper | grep snap | while read line; do umount $line; done\nfind /dev/vg* -name snap* | while read line; do lvremove -f $line; done\n\nFound only on those 2 infected Qnaps\n\n\n-----\n\n[Marchande - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203276/marchande/)\n\nwhere are you finding this at. loking in rot on mine not seing any .sh file. posilbe it was\nremoved when I did the firmware update?\n\n[LaurentH111 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203285/laurenth111/)\n\nfound at /root. Not yet upgraded. Will do and report if still present\n\n[Marchande - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203276/marchande/)\n\nthanks... my last backup failed I have a qddf file to read from but its sadly corrupted\nand un readable by the q dedupe software that qnap provides.. both on the server and\noff. so im looking for any sliver linning that I might be able to latch on to.\n\n\n-----\n\n[Razorblade - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203383/razorblade/)\n\nThere's another suspicious file:\n./mnt/ext/opt/apps/backup.php\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nCan you send me the backup.php so I can take a look and possibly update the\narticle?\n\nYou can submit it here:\n\n[https://www.bleepingcomputer.com/submit-malware.php?channel=3](https://www.bleepingcomputer.com/submit-malware.php?channel=3)\n\nThanks\n\n\n-----\n\n[Razorblade - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203383/razorblade/)\n\nI deleted it, but it had just one line with \"php eval POST cmd\" (with the missing\ncharacters). Funny because Microsoft Defender detects that file as\nBackdoor:PHP/Remoteshell.B, but the QNAP Malware Remover does not detect it.\n\n[MeanE - 1 year ago](https://www.bleepingcomputer.com/forums/u/1162460/meane/)\n\nOoof. People let their QNAP be internet facing?\n\n[ttanxu - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203320/ttanxu/)\n\nIt's UPnP that exposes QNAP. UPnP is usually by default on on routers. It's necessary\nto discover devices in the same network (e.g. printer & myQNAPCloud), but it opens\nup a lot of attacking surfaces for exploitation.\n\nThe truth is your home network is a lot more open to the Internet as you might have\nimagined. It's especially the case if your ISP and your router have IPv6 support (and\nthey should).\n\n\n-----\n\n[LaurentH111 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203285/laurenth111/)\n\nAfter upgrade/reboot it's gone. Hope it's not coming back !\n\n[cricker - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203295/cricker/)\n\nps -ef revealed; 3504 admin 2564 S /bin/sh /usr/local/sbin/7z x -so ./data.tar.xz\n\nI found the log via SSH in the folder /mnt/HDA_ROOT/7z.log\nI moved it to another location and opened to reveal these contents, the same as\nabove, \"x -so ./data.tar.xz\"\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\nso there is no possibility to decrypt the log file?\n\n\n-----\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nhas anyone had any luck decrypting their data. Or worse case has any one paid the\nransom successfully?\n\n[Marchande - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203276/marchande/)\n\nI imagine its going to be a little more dificult, since its using 7zip for the encryption,\nand its appearing to be a 32 character password wich means that brute forcing it\nusing any of the avalable tools out will be a little challenging... ive been searching all\nevening for something Im holding out hope that those that are far more versed in this\nthan I am are able to find a solution....\n\n\n-----\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nSee update at top of article.\n\n[ttanxu - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203320/ttanxu/)\n\nI seriously doubt CVE-2020-36195 is the vulneribility the attacker used. I am a victim\nof this attack (with 7z files created at 4/21 1AM PDT), while the QuLog center on my\naffected device showed it installed Multimedia Console 1.3.4 on 3/2, Media Streaming\nAddon 500.0.0.1 on 3/2 and updated its firmware to 4.5.2.1630 Build 20210406 on\n4/8. They all are above the patched version QNAP announced and yet the incident\nstill happened.\n\nI don't think it was affected even on 4/19, so it can't be the attacker who changed the\nmodified date of those 7z files. I don't think attackers were interested in changing the\nsoftware update log either.\n\n\n-----\n\n[Veyabilc11 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203330/veyabilc11/)\n\nMay i know how the Qlocker got in?\n\n[micattack - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203341/micattack/)\n\nI am also wondering how it came in. Just 2 days ago I checked and firmware was\ncurrent. I have the suspicion that it came in through Adguard Home (docker container station) but cannot proove it. Stopped some scripts with \"mana...\" in the\nname with \"kill -9\"\n\nIt got 2787 files on my qnap :-(\n\ncheck via ssh with \"find /share -type f -name \"*.7z\"|wc -l\"\n\nto see the affected directories that have encrypted files do \"find /share -type f -name\n'*.7z' | sed -r 's|/[^/]+$||' |sort |uniq\"\n\nso: what do we know of the attack vector and where the scripts are hiding?\n\n\n-----\n\n[Veyabilc11 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203330/veyabilc11/)\n\nHow do we know that it's there already and running? Is it the 7z that shows in the\nResource Monitor?\n\n[micattack - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203341/micattack/)\n\ni used \"top\" and saw some fishy looking things - as explained with \"mana\" in the name\nand I just killed those in my panic (kill -9 <process-id-number>)\nThere might be a 7z task running as well but I didnt see that and dont remember. For\nnow I stopped everything in the web front-end via app-center that might be running\nand am working on the ssh console to debug\n\nUPDATE: What I did probably had no effect at all. It looks like the encryption stopped\non its own at about 4:33 am CET (6-7 hours ago) so that is also why I didnt see a 7z\nprocess running\n\n\n-----\n\n[krysc4d - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203354/krysc4d/)\n\nHi Guys. I am a victim as well. I am completely newbie in terms of NAS. Can someone\nadvice me what to do now? How to get rid of this ransomware? I've turned the QNAP\noff at this moment...\n\n[stook_84 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203345/stook-84/)\n\ni'm in via ssh, but the 7z.log is empty :(\n\n[https://ibb.co/KFV8n7c](https://ibb.co/KFV8n7c)\n\n\n-----\n\n[Darevx - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203332/darevx/)\n\nRun the following command: cd /usr/local/sbin; printf '#!/bin/sh \\necho $@\\necho\n$@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x 7z.sh; mv 7z 7z.bak;\nmv 7z.sh 7z;\n\nAfter that, right click on 7z.log - select download and save the file on your computer.\nNow you can open the file from your computer. Use the password without first \"p\".\n\n[matteocalle - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203181/matteocalle/)\n\nHi Darevx,\nI tried with the command you suggested, but in the folder where I should find the log, I\nfind nothing. My client turned off QNAP after being attacked. Could this be the cause\nof the missing log? Can the decryption password possibly be traced in some other\nway?\nThanks in advance.\nMatteo\n\n\n-----\n\n[cnwong - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203367/cnwong/)\n\nHello Darevx,\nI managed to find the file and I downloaded it on my computer. But when I opened it\nthe file is completely blank - no letters or words at all. Any advice? Thanks very much.\n\n[Boonpot - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203384/boonpot/)\n\nHi\n\nI got the same problem ., there is nothing on 7z.log\nPelse help\n\n[Melissa81 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203408/melissa81/)\n\nthis command is not showing as available in the run program. any other ideas\n\n\n-----\n\n[Koluschki - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203370/koluschki/)\n\nHello Darvex,\ni tried your command\ncd /usr/local/sbin; printf '#!/bin/sh \\necho $@\\necho\n$@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x 7z.sh; mv 7z 7z.bak;\nmv 7z.sh 7z;\nbut the 7z.log file not exits. i hope you can help me. The QNAP is since 24 days on\n\n[icetealight - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203371/icetealight/)\n\nI just registered to thank @Lawrence Abrams for all the work he is doing ... what a\nhero.\n\nI leave my QNAP turned off and untouched until later today when the update comes\nout from Bleepingcomputer.\n\nSince it is personal file storage - I dont REALLY need the files and as soon as there is\nhope that the files can be recovered - I am patient.\n\n\n-----\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nThank you :) Just wish we could have utilized that bug longer and recovered all of\nyour keys.\n\n[perarg - 1 year ago](https://www.bleepingcomputer.com/forums/u/755427/perarg/)\n\nI have a NAS-473 and i am a victim of Qlocker too. I have two volumes in a storage\npool. Only the one volume's files have been encrypted.\n\nI tried the command\ncd /usr/local/sbin; printf '#!/bin/sh \\necho $@\\necho\n$@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x 7z.sh; mv 7z 7z.bak;\nmv 7z.sh 7z;\n\nBut there is no file 7z.log at all at /mnt/HDA_ROOT. This may happens because of the\ntwo volumes?\n\n\n-----\n\n[thetaga - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203377/thetaga/)\n\ni am a victim of Qlocker too.\nI tried cd /usr/local/sbin; printf '#!/bin/sh \\necho $@\\necho\n$@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x 7z.sh; mv 7z 7z.bak;\nmv 7z.sh 7z;\nBut it comes back to me like this:\n\n[bobisnotadmin@NAS3D733E sbin]$ cd /usr/local/sbin; printf '#!/bin/sh \\necho\n$@\\necho $@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x 7z.sh; mv\n7z 7z.bak; mv 7z.sh 7z;\n-sh: 7z.sh: Permission denied\nchmod: 7z.sh: No such file or directory\nmv: unable to rename `7z': Permission denied\nmv: overwrite `7z'? y\nmv: unable to rename `7z.sh': No such file or directory\n\nI am using a different user than admin, since I have disable to avoid other attacks for\nthe time being. What should I do?\n\n[Alexspiteri - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203386/alexspiteri/)\n\nI also have been hit with this attack and have all files encrypted.\nAny possible way of a workaround for laypersons and Mac users.\n\nthank you in advance\n\n\n-----\n\n[Miniman01 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203388/miniman01/)\n\nI have followed the same command and cannot locate the file.\ncd /usr/local/sbin; printf '#!/bin/sh \\necho $@\\necho\n$@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x 7z.sh; mv 7z 7z.bak;\nmv 7z.sh 7z;\n\n7z.log\n\nI have 3 QNAPS with same issue. All have been shutdown and rebooted to access\nssh. Any help please; Also contacted QNAP Support as to why and if there is going to\nbe a new update firmware security for QLOCKER.\n\n[janwozniak - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203389/janwozniak/)\n\nIt looks strange for me, I have two QNAPs at home, one encrypted, the other not, for\nclients from 10, some encrypted part not.\nInterestingly - packed files are without a password. At the moment, I have turned off\nall that I had access to and I am waiting for information on what to do next.\nTwo-step verification doesn't matter how I've seen.\n\n\n-----\n\n[Miniman01 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203388/miniman01/)\n\nThere are 2 on our network, 1 encrypted and 1 not. strange to see how this has been\ntargeted. Waiting for remote support by QNAP.\n\n[MartinMe - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203395/martinme/)\n\nHello all, I've tried your steps. I've used command: cd /usr/local/sbin; printf '#!/bin/sh\n\\necho $@\\necho $@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x\n7z.sh; mv 7z 7z.bak; mv 7z.sh 7z;\n\nlooks it go through smoothly but I cannot find any log file in /mnt/HDA_ROOT/ folder.\nIs there a way to find and open those files manually let say with WinSCP or so?\n\nI've also tried to use ps -ef command. But I cannot see there any line with 7z.\n\nThanks for your help guys.\n\n\n-----\n\n[perarg - 1 year ago](https://www.bleepingcomputer.com/forums/u/755427/perarg/)\n\nSame thing here. No 7z.log file there.\n\n[mirror79 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203352/mirror79/)\n\nDo it like this: [https://youtu.be/aq_cIdY_ksQ](https://youtu.be/aq_cIdY_ksQ)\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nHas any one paid the ransom and regained access to their files successfully?\n\n\n-----\n\n[PhR34k - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203413/phr34k/)\n\n\"Has any one paid the ransom and regained access to their files successfully?\"\n\nI saw someone on Reddit or Qnapforum that had paid and succesfully managed to\nunlock the files. Its a headache thou to open all the files. I dont know how to manage\nthat but there are tools for it I hope.\n\n[PhR34k - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203413/phr34k/)\n\n\"Has any one paid the ransom and regained access to their files successfully?\"\n\nI saw someone on Reddit or Qnapforum that had paid and succesfully managed to\nunlock the files. Its a headache thou to open all the files. I dont know how to manage\nthat but there are tools for it I hope.\n\n[scrumpers - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203372/scrumpers/)\n\nWe paid the ransom got the password and then used peazip to unlock all the files to\ntheir current places and its working\n\n\n-----\n\n[IamAdverb - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203939/iamadverb/)\n\nWould you mind sharing you peazip command line? I would appreciate it.\nTIA\nAdverb\n\n[Tony-OZ - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203400/tony-oz/)\n\nHallow - Another victim here from Down-under (Sydney)\n\nMy office QNAP got hit badly with this rotten Qlocker - it is world wide alright.\nLawrence, you are the only source of information on this to date, I cant thank you\nenough for your prompt and clever presentation. You described the problem exactly. I\ngot all my files locked up and I had to shutdown my entire practice today.\nQnap here in Melbourne must have gone in a meltdown, I phoned them at 9am\nSydney time and it is past 10:30PM and have not heard from them yet.\nI got image files, DBF files, RTF files, excel files all locked for a ransom.\n\nI will be waiting in anticipation for the news and updates\n\nThanks Lawrence\n\n\n-----\n\n[r2d2c3po - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203406/r2d2c3po/)\n\nI see on the top!\nUpdate 4/22/21 12:44 AM: A weakness may have been found that could potentially\nallow victims to recover their files for free. We are still investigating this and will post\nan update around 10 AM EST, or possibly earlier..\n\nGive's new informations?\n\n[klaun1979 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203409/klaun1979/)\n\nhello a question to all users who are affected of this attack:\nis open to the qnap http or https port?\n\n[wydo91 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203410/wydo91/)\n\nhttp set on 8080 but not NAT on Router.\nHttps forced.\nHttps open with NAT.\n\n\n-----\n\n[wydo91 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203410/wydo91/)\n\nHi,\nOne more, near Paris, France.\nTry to figure out with 7z.log but there is not such file.\nMaybe file was deleted after finishing encryption.\nStill waiting for another potentially recover method.\n\n[PhR34k - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203413/phr34k/)\n\nAbout the 7z.log file.\n\nWhat i have gatherd from reddit and qnap forum is that the encrpytion needs to still be\nactive to see this file.\nLike for me the encryption is done so i cant find these file.\nLets hope Lawrence has some good news for us.\n\n\n-----\n\n[perarg - 1 year ago](https://www.bleepingcomputer.com/forums/u/755427/perarg/)\n\nIt seems that if someone made a reboot to the system, the option to get the 7z.log file\nhas been lost. I made the same \"mistake\", i run a firmware update and then reboot the\nmachine so now the 7z.log is not present in the system\n\n[PhR34k - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203413/phr34k/)\n\n\"It seems that if someone made a reboot to the system, the option to get the 7z.log file\nhas been lost. I made the same \"mistake\", i run a firmware update and then reboot the\nmachine so now the 7z.log is not present in the system\"\n\nI have not made a reboot on the system and still can not see the file. I think its a\nmatter wether the encrpytion is done or not.\n\n\n-----\n\n[salvo981 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203415/salvo981/)\n\nhi, I also have the usual problem the only thing is that if I give the command:cd\n/usr/local/sbin; printf '#!/bin/sh \\necho $@\\necho\n$@>>/mnt/HDA_ROOT/7z.log\\nsleep 60000' > 7z.sh; chmod +x 7z.sh; mv 7z 7z.bak;\nmv 7z.sh 7z;\nit returns me the error : no such file or directory\nthe file 7z.log it's no present\nTank you\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\nThis has happened to me too here in North Carolina. I'm fairly new to network storage\nand QNAP and use this for my video editing and have a lot of important video footage\nthat is now encrypted. I'm using an iMac and have tried using the command\nsuggested in terminal but get \"no such file\". My QNAP requested an update last night\nwhich I performed. Any help would be tremendously appreciated. Did not know things\nlike this could happen\n\n\n-----\n\n[vincentw2622 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203419/vincentw2622/)\n\nit's 9:33 am est now, i stayed up all night and hitting my f5 over 10k times and it's\nalmost broken but the solution hasn't been shared yet\n\n[TacticalLynx - 1 year ago](https://www.bleepingcomputer.com/forums/u/1095294/tacticallynx/)\n\nLost all my stuff. I panicked because this is my work NAS and reset everything. I\ncouldn't let a ransomware get to my work computer and mess up that server as well.\nSucks.. I had sooo much stuff on this NAS for work.\n\n[Boydy81 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203422/boydy81/)\n\nYep I have also been hit by the qlocker on my qnap here in Melbourne Aus anxiously\nwaiting a fix as mine is off now !\n\n\n-----\n\n[PhR34k - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203413/phr34k/)\n\nJack Cable was able to pass thru the ransomeware but seems that these has been\nstoped by the Qlocker team.\nI hope this is not the \"fix\" Lawrence was hoping/talking about... :(\n\n[https://twitter.com/jackhcable/status/1385064776435310593](https://twitter.com/jackhcable/status/1385064776435310593)\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nIt was unfortunately :(\n\n\n-----\n\n[Jimac1888 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203430/jimac1888/)\n\nTried the 7z.log which probably would have worked great had i not rebooted and\nstopped the service in a panic before hand.\n\nThankfully it was only small files that i have lost but all my kids school work is now\ngone,\n\nIf anyone has paid to get the key could you post what it consists of for example\n\n32 characters upper and lowercase with numbers and or symbols, i ask as i would like\nto try some brute force attacks to decrypt and if everyone's keys are similar format it\nwould give a good start point.\n\nCan't believe QNAP has let this happen, disgusted to read about all the work places\naffected by this, cyber terrorism.\n\n\n-----\n\n[wtutwiler70 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203429/wtutwiler70/)\n\nI too am a victim, one of my two QNAP NAS was hit. I just read the recent update\n(which is disappointing), and I also shut down both units, so using the mentioned\ncommands to find the password is unlikely an option for me either, when I do turn\nthem back on.\n\nI had just done the firmware update a couple of days ago, but unfortunately, at the\ntime, I did not check the QNAP admin page for potential software updates.\n\nThe majority of the files on my QNAP were backups, so it will be possible to rebuild it,\nif necessary (which it is sounding more and more likely), but it will take DAYS and I will\nstill have lost a good portion of data.\n\nI don't use ANY of the multimedia apps on the QNAP, would uninstalling/disabling\nthem all help prevent this?\n\n[wtutwiler70 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203429/wtutwiler70/)\n\nIronically, when looking on the QNAP website for information on this, and possible\npreventative measures, I only find articles about using the NAS to safeguard from\nransomware, and nothing (recent) about if the NAS itself was the target.\n\n\n-----\n\n[janwozniak - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203389/janwozniak/)\n\nhttps://www.qnap.com/en/news/2021/response-to-qlocker-ransomware-attacks-takeactions-to-secure-qnap-nas?ref=jorma official\n\n[wtutwiler70 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203429/wtutwiler70/)\n\nAh, thanks, I had only found the article from 2019 before.\n\n[krysc4d - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203354/krysc4d/)\n\nFunny enough, I've run this scan on mine and this didn't find any ransomware in data\nlog...\n\n\n-----\n\n[salvo981 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203415/salvo981/)\n\nfile 7z.log no present\n\n[marco1982 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203443/marco1982/)\n\nMy qnap is inaccessible from both ssh and https after reboot. Is there any way to get it\nback?\n\nSARASA Photo\n[SARASA - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203444/sarasa/)\n\nHello, I got caught in ransomware in Korea.\n\nI came here looking for a solution.\n\nIt's too difficult.\n\n\n-----\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\nGuess Iâ€™m going to have to pay this ransom, plan on selling my QNAP after I get all\nmy 60TB of data off of it. No more network storage for me.\n\nSARASA Photo\n[SARASA - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203444/sarasa/)\n\nI thought it would be safe, but I feel betrayed.\n\n[z4kir0v - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203447/z4kir0v/)\n\nSo this problem was known to QNAP for at least 4 month. And it's been 2 weeks since\npublication with enough details to re-implement the attack.\n\nAnd only 3 days since an update with mentioned NO information about security\nproblems it's closing.\n\n[https://securingsam.com/new-vulnerabilities-allow-complete-takeover/](https://securingsam.com/new-vulnerabilities-allow-complete-takeover/)\n\n\n-----\n\n[oblong - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203518/oblong/)\n\nThat explains a lot. Thanks for sharing\n\n[mirror79 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203352/mirror79/)\n\nHi everybody, I made a video how to do it. Hope it helps. This is how I found the\npassword for all my 7z files created using this ransomware:\n[https://youtu.be/aq_cIdY_ksQ](https://youtu.be/aq_cIdY_ksQ)\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\nDo you have any idea when the file 7z.log is empty?\n\n\n-----\n\n[vincentw2622 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203419/vincentw2622/)\n\nYou mean there's nothing in the log file?\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\n\"You mean there's nothing in the log file?\"\n\nYes exacly\n\n[vincentw2622 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203419/vincentw2622/)\n\nDid you reboot your nas?\n\n\n-----\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\n\"Did you reboot your nas? \"\n\nI shut it down during encrypting and it started on its own today morning. I didn't notice\nthat... Probably the encryption has been finished\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\nDo you have any idea when the file 7z.log is empty?\n\n[MartinMe - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203395/martinme/)\n\nHi, I've did the same what you and still cannot see that log file. Do you think that it\nmay be as hidden file? I am using WinSCP.\n\n\n-----\n\n[Jimac1888 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203430/jimac1888/)\n\nI see you still have the attack going on with the failed log ins, i tried unzipping a file in\nfile station, now my log has only that info so if you have restarted or updated you\nmight be out of luck like me, i have re connected to the internet and added some new\nfiles hopefully to receive another attack\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\n\"I see you still have the attack going on with the failed log ins, i tried unzipping a file in\nfile station, now my log has only that info so if you have restarted or updated you\nmight be out of luck like me, i have re connected to the internet and added some new\nfiles hopefully to receive another attack\"\n\nI don't know if it's working like this :/\n\n\n-----\n\n[Jimac1888 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203430/jimac1888/)\n\n\"\"I see you still have the attack going on with the failed log ins, i tried unzipping a file\nin file station, now my log has only that info so if you have restarted or updated you\nmight be out of luck like me, i have re connected to the internet and added some new\nfiles hopefully to receive another attack\"\nI don't know if it's working like this :/\"\n\nYou could be right sadly, i have the failed log in messages again but my newly added\nfiles are still good, will leave for a few hours i have nothing left to lose now\n\n[matteocalle - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203181/matteocalle/)\n\nI did everything exactly as you said but i can't find any .log files in the given directory :(\n\n[Bursat - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203457/bursat/)\n\nwe can not read scripts u write coz of resolution. is it possible to copy paste your\nscript here so we can read it\n\n\n-----\n\n[sirvanux - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203425/sirvanux/)\n\nI have more than 10 QNAP Clients. 3 of them are affected. I want the unaffected\nclients to keep working locally. What steps do you recommend to disable all Internet\nFeatures or internet access while this thing gets clarified?\n\n[Bursat - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203457/bursat/)\n\nwe can not read scripts u write coz of resolution. is it possible to copy paste your\nscript here so we can read it\n\n[mi_w - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203459/mi-w/)\n\n(duplicate)\n\n\n-----\n\n[aston729 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203273/aston729/)\n\nIs there any chance that the second disk was not infected? RAID 1\n\n[nogaret - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203475/nogaret/)\n\nThis is fresh information I just received from QNAP support:\nhttps://www.qnap.com/en/news/2021/response-to-qlocker-ransomware-attacks-takeactions-to-secure-qnap-nas\n\nUnfortunately, that only applies if you're NAS did not restarted.\n\n[lukaszromczyk - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203513/lukaszromczyk/)\n\nThey wrote everything and nothing. I've always updated apps on my NAS, and system\nscanned everyday night at 3 AM. And at all I have the same problem just as i were not\ndoing anything\n\n\n-----\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nSo, after Qnap tech support looked at my drives, they said their is nothing they can do\nto decrypt data. They suggest I pay the ransom if I need the data.\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\n\"So, after Qnap tech support looked at my drives, they said their is nothing they can\ndo to decrypt data. They suggest I pay the ransom if I need the data. \"\n\nF QNAP!! They owe me $550 and they need to buy back this POS NAS that I wonâ€™t be\nable to resale because no one will want to buy their $h*t anymore.\n\n\n-----\n\n[iKooza - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203502/ikooza/)\n\nIt seems that the SSH method mentioned above works only if the ransomware is still\nrunning and using the 7z program. As soon as you update or restart the NAS (which I\ndid as soon as I saw the issue) - the 7z process is no longer active and the method\ndoes not work. Is there a way (for whoever knows how to do that) to start the\nransomware manually on the QNAP again to generate the log file and retrieve the\npassword?\n\n[remy99c - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203507/remy99c/)\n\nI saw the !!README.txt file on a single folder on my nas but none of my files are\naffected. i turned my nas off as soon as i noticed this morning, Now in the evening i\nread that qnap pushed firmware and app updates to fix this but my TS-453B is already\non latest firmware although that one is from 2021-03-02. Should i still be worried or is\nall fine and am i safe?\n\n[Bursat - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203457/bursat/)\n\nHas anyone received a password after making a ransom payment?\n\n\n-----\n\n[lukaszromczyk - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203513/lukaszromczyk/)\n\nIf you'll send money never receive the code for sure. Never negociate with terrorists.\n\n[Bursat - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203457/bursat/)\n\nYou are absolutely right. Thanks.\n\n[lukaszromczyk - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203513/lukaszromczyk/)\n\nThe same problem. Anyone resolved the problem? I've tried description of\n@ValiantThor, but probably too late. File 7z.log, not created at all, so virus creator for\nsure improved fixes to the virus script.\n\n\n-----\n\n[charlespig - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203516/charlespig/)\n\nIf a 7z.log file was created on the HDA_ROOT and was deleted, is it possible to\nrecover it with some utility?\n\n[lukaszromczyk - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203513/lukaszromczyk/)\n\nI'm not sure if it was created at all. Command didn't receive any errors, but file wasn't\ncreated\n\n[yesman686 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203511/yesman686/)\n\nGot the ransomware as well. i unplug the network and power. should i connect it back\nand check the log file? I tried the web portal before unplug which doesn't work.\n\n\n-----\n\n[yesman686 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203511/yesman686/)\n\nI have plug in everything back like network cable and power. however. the log file was\nnot there under: /mnt/HDA_ROOT\nany help?\n\n[Redbeard77 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203505/redbeard77/)\n\nIs there any indication of data being accessed or stolen by a third party in the case of\nQLocker?\n\n[janwozniak - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203389/janwozniak/)\n\nI looked through all the logs from the week, there is neither proper login nor file\ncopying, so I would be confident about that - just a quick action to get rich by looking\nfor a hole in the whole.\n\n\n-----\n\n[oblong - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203518/oblong/)\n\nI'd like to thank everyone around here for the amazing input. The internet is an\namazing place!\n\nI've too been affected. I'm a professional photographer and use my nas as my main\narchive. Following good advice I have a second one at home that backs up all data\nevery night â€” which luckily was not affected (probably because it's not always on, it\nboots up on a schedule and does its tasks, then shuts down again).\nWhile eating breakfast this morning I was wondering why my backup was still running\n(the nas sits atop my refrigerator). In the office I canceled the running backup. It was\nonly later today that I discovered what shenanigans caused my massive 400GB\nbackup job.\nThankfully my archive is approaching 10TB of data â€“ it does take a considerable\namount of time to encrypt this much data. Before I shut the whole thing down and then\nfound this wonderful forum I did check my more important folders and nothing was\nencrypted. There were these text-notes here and there but most things were still\nworking â€” probably because my files tend to be large, well above 20MB. The main\nmachine is powered off for now.\nThis evening I did inspect my backup machine. Luckily it was not affected, but it did\nback up the files that were encrypted on the main machine (Mostly stuff from 10 years\nago â€“ have to check my main machine soon). I'm glad my backups never delete\nanything so now I have both â€“ original file + encrypted backup ;)\n\nI'm super mad about these f***s. So much unnecessary hassle. I whish those pesky\nhacking ransom wankers die a slow and painful death from covid combined with\nebola, aids and cancer. The internet is such a rotten place!\n\n\n-----\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nOK, So I paid the Ransom and received the Key immediately and it works. The shitty\npart is I need to figure out how to batch extract in 7z. the directories are not\ncompressed so I have to go into each folder and select the encrypted files. If any one\nknows how to batch extract with in a directory please share.... So I can maintain the\noriginal file structure\n\n[Marchande - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203276/marchande/)\n\nhow many characters was the password they gave you?\n\n\n-----\n\n[PhR34k - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203413/phr34k/)\n\n\"OK, So I paid the Ransom and received the Key immediately and it works. The shitty\npart is I need to figure out how to batch extract in 7z. the directories are not\ncompressed so I have to go into each folder and select the encrypted files. If any one\nknows how to batch extract with in a directory please share.... So I can maintain the\noriginal file structure\"\n\nWhen did you pay? Did you pay recently?\nIm thinking of paying but i dont now what Bitcoin site to use so i can send them their\nmoney.\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nI did it with in the hour and instantly received key. I ended up going to a bitcoin ATM to\npurchase bitcoin\n\n\n-----\n\n[janwozniak - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203389/janwozniak/)\n\nAll the QNAPs I maintain have the latest software and the latest application updates\n\n\"For details, please refer to the QNAP security advisory QSA-21-11\n[(https://qnap.to/3eq7hy) and QSA-21-13 (https://qnap.to/3dygse).&quot;](https://qnap.to/3eq7hy)\n\nMuch newer than here, QNAP proposes, but unfortunately most of the US were hit,\nafter contacting the store (early Central European hours), the recommendations were\n\n- to turn off the US.\n\nQNAP releases in the late afternoon that it is bad and not to shut down the servers.\n\nAnd here I am surprised because I say about 12 devices, half of which on average is\nencrypted (some only partially), turned off for now but what next? Despite the\nrecommendations of QNAP, unfortunately it does not work as we would like, and most\ndo not intend to pay the ransom.\n\nI went the way: [https://www.youtube.com/watch?v=aq_cIdY_ksQ but on 2 tested](https://www.youtube.com/watch?v=aq_cIdY_ksQ)\ndevices there are no such files after switching off.\n\nAnd now a question for those who paid - after paying you can decrypt everything or\neach file individually. We are not talking about a flat structure, but a tree.\n\n\n-----\n\n[LogicNode - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203535/logicnode/)\n\nI manage about 8 QNAP devices right now. Yesterday I fully patched them all with the\nlatest firmware and also updated all of the applications. I confirmed last night that that\nwere all 100% up to date and secure.\n\nToday 4 of those devices have been subject to this ransomware attack.\n\nI can see from the time stamps on the 7z files that the attack took place some 12\nhours after I updated the QNAPs!\n\nI have being using 2FA, with super secure passwords. All unnecessary services\nswitched of etc. So have followed industry recommended hardening\nrecommendations.\n\nChecking all the devices again now they are still all reporting up to date. No further\nupdates released by QNAP since I applied the fixes yesterday.\n\nSo how is it, that fully patched and updated systems are still being hacked? Could it\nbe that QNAP has not yet correctly identified the vulnerability the hackers are using?\nAre we all still at risk?\n\n\n-----\n\n[wtutwiler70 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203429/wtutwiler70/)\n\nIn case any of you haven't seen this other thread, there is some good info on (1) how\nto grab the password IF the 7z process is still running; (2) steps to take to lock down\nall your QNAPs (without necessarily denying yourself access via the Internet, if that is\nnecessary for you - as it is for me); and (3) How to retrieve the deleted, pre-encrypted\nfiles, so you don't have to go through the hassle of [paying and] extracting all those\nfiles - but it gives you a different pain of renaming and returning the files to their\nproper places.\n\nAnyway, that thread is here:\nhttps://www.bleepingcomputer.com/forums/t/749247/qlocker-qnap-nas-ransomwareencrypting-with-extension-7z-read-metxt/page-24#entry5171519\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nOur developers are currently working on changing one of our brute force tools and are\nhoping that a couple of people who have successfully decrypted anything / received\ntheir password may be willing to share one of their encrypted zip files and their\nreceived password. Note the file should be something that does not contain any\nconfidential information, something like a program readme file or any other random file\nis fine as long as it can be decrypted, we need to validate a couple of things. If anyone\nis willing please PM me.\n\n\n-----\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nOut of curiousity, why are you creating a decryptor for this when the password works\nwith 7zip?\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nUpdated, thank you, We have a distributed brute force tool that has had some luck in\nthe past, just passing on the request from our developers here to the community.\n\n\n-----\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nAhh...looking forward to learning more about the tool. Hope we see good success with\nit.\n\n[jj2134 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203509/jj2134/)\n\nOk, I need the pictures of my kids back. What's the best wallet and place to purchase\nbitcoins to send?\n\n\n-----\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\n\"Shakepay\" phone app works well if in canada, if not I have heard coinbase but have\nnever used them.\n\nXandl Photo\n[Xandl - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203728/xandl/)\n\nIf you want you could try this before you make a payment:\n\nIt worked for me!\n\nhttps://www.bleepingcomputer.com/forums/t/749751/qlocker-full-guide-how-to-getyour-data-back-qnap-nas-hack/\n\nCheers\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\nI've sent the BTC and I'm getting the message \"Waiting for confirmations (confirm:1,\nmust>=2)\" transaction has completed on Coinbase and did so 20 minutes ago.\nAnyone else with any insight on how long it took after sending payment??\n\n\n-----\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nare you using 7zip to extract them?\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\nNo but I just tried to download and it looks like it only works on Windows and I'm on a\nMac\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\nFinally got the code but when I double click a Final Cut Pro file for example it asks me\nto enter password and I do and nothing happens. What do I do??\n\n\n-----\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\n[You will need 7-zip installed to open the file, https://www.7-zip.org/](https://www.7-zip.org/)\nYou can also try copying the file to the local desktop, test with a file with a small file\nsize first.\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\n[\"You will need 7-zip installed to open the file, https://www.7-zip.org/](https://www.7-zip.org/)\nYou can also try copying the file to the local desktop, test with a file with a small file\nsize first.\"\n\nLooks like it only works on Windows, any idea how to do this on a mac??\n\n\n-----\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nPossibly this?\n[https://osxdaily.com/2010/12/13/open-7z-files-on-a-mac/](https://osxdaily.com/2010/12/13/open-7z-files-on-a-mac/)\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\nThe Unarchiver seems to be duplicating the files properly but when I go into Final Cut\nPro and open the affected library my library is empty. Nothing in it\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nThere are likely support files for the project around the decrypted files that are not\nopening, make sure all files have been decrypted before opening projects and that\nthey are in the same folders as the originals.\n\n\n-----\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nIts crazy because I am still seeing constant failed Admin login attempts as we speak. I\nam batch decrypting my files as fast as possible to get them backed up.\n\n[Fugy - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203556/fugy/)\n\nCan anyone tell me if there is a risk of stopping the 7z process when doing a 3 second\nreset to reset the admin password. I can't find any information anywhere about\nwhether this will reboot the NAS.\n\nThanks in advance\n\n\n-----\n\n[wtutwiler70 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203429/wtutwiler70/)\n\n@Fugy, I mentioned this in the other forum, but just to restate here:\n\nDue to the nature of the attack, changing the password would be ineffective to stop it.\nCreating another admin account (without the name 'admin') and disabling the default\none MAY help, but unlikely on its own. Both of these things CAN be done without\nrebooting, though.\n\n[rolextec - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203517/rolextec/)\n\nI want to buy the 0.01 bt, but I am from Peru, some support, I need to recover the\ninformation.\n\nThe password is successful, I have windows 10?????\n\n\n-----\n\n[cavez - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203561/cavez/)\n\nHey guys, affected by this here in Ireland too. Thankfully I only recently began to use\na NAS (needless to say I regret choosing QNAP!) and I only 'dumped' files on it and I\nstill have the HHD with them. I managed to salvage something before it got encrypted\nand I've only lost a few recent files that I can live without. I wouldn't mind finding a\npassword though. I shut down the NAS and rebooted it so the help from Mirror 79\n[here https://www.youtube.com/watch?v=aq_cIdY_ksQ&ab_channel=LinusTechTips](https://www.youtube.com/watch?v=aq_cIdY_ksQ&ab_channel=LinusTechTips)\nmight not be an option for me. Also I'm using mac and I see that there are other\nissues. Hope it gets solved quickly and that those f*%*ers die a slow really painful\ndeath\n\n[Melissa81 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203408/melissa81/)\n\nHow has this not reached the news yet?! This is massive! It should be everywhere!\nWhat are we to do? Will it be possible to bring back our files? Thankfully I am not a\nbusiness that has had my files encrypted but I do have 200 000 files of work and\npersonal life on there. Will there be a chance of re-fixing this?\n\n\n-----\n\n[davisdd - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203567/davisdd/)\n\nThis may sound obvious to some but try and unzip the encrypted files to verify it is\nactually password protected. My QNAP was very recently patched. I assumed the .7z\nfiles were Password protected after finding this article and started the process to try\nand grab the password using the suggestion mentioned here. I decided to check a few\nof the files after an unsuccessful attempt. No Password! I was able to extract all of the\nfiles!\n\n[Melissa81 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203408/melissa81/)\n\nwhen I right click on an image it doesn't come up with an option to unzip it\n\n[davisdd - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203567/davisdd/)\n\nyou will need to download and install 7zip\n\n\n-----\n\n[denmcca - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203316/denmcca/)\n\nAny chance there might be a list of valid passwords for analysis?\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nSeconded, have been asking all day and no one seems to be sharing ;)\n\n[denmcca - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203316/denmcca/)\n\nCcrP7PCP1euF0MBjD2C866YYi388m9jD\nTaken from [https://youtu.be/aq_cIdY_ksQ?t=533](https://youtu.be/aq_cIdY_ksQ?t=533)\nAt least we know the password is ascii-based.\nMix of upper and lower-case letters, numbers, and 32 characters long.\n\n\n-----\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nLooks like an md5 of something,\n\nIf you go to the web address and look at the data page (right click on page and view\nsource to see the background code)\n\nhttp://gvka2m4qt5fod2fltkjmdk4gxh5oxemhpgmnmtjptms6fkgfzdd62tad.onion/data.ph\np\n\nThere is an info block that comes back that we are looking into.\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nI updated the article with an example of another password displayed after making a\npayment.\n\n\n-----\n\n[Tony-OZ - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203400/tony-oz/)\n\nhas anyone thought of combing the files from more than one \"QCRAP\" NAS system\nso as to share the cost of the ransom. if this works then 2 will pay 50% and 3 will pay\n1/3 of the cost and so on.\nWill this work?\n\n[Tony-OZ - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203400/tony-oz/)\n\nhas anyone thought of combing the files from more than one \"QCRAP\" NAS system\nso as to share the cost of the ransom. if this works then 2 will pay 50% and 3 will pay\n1/3 of the cost and so on.\nWill this work?\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nThe ransom is generated per device so this will not work.\n\n\n-----\n\n[Tony-OZ - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203400/tony-oz/)\n\nYes I know but I mean copy the files of one device into the other, so you'll end up with\none device rather than two. will this work?\n\n[jj2134 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203509/jj2134/)\n\nHow do you get the password if you pay the ransom?\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nThe password would be placed on the same page where you input the transaction ID\n\n\n-----\n\n[MFR73 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203577/mfr73/)\n\nafter entering the transaction Id. How long does it take for confirmation and\npassword?\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nUsually About an hour\n\n[vincentw2622 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203419/vincentw2622/)\n\nWhat if i close the page by accident after paying? Can i still get the password entering\nthe page next time?\n\n\n-----\n\n[ChrisBurchett - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203536/chrisburchett/)\n\nYes just re enter the id string they gave you and it should show\n\n[Lawrence Abrams - 1 year ago](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nIf you pay, you can always see the password again by logging into their Tor system\nwith your \"client key\".\n\nFrom my tests, you do not have to enter the transaction ID again.\n\n\n-----\n\n[jj2134 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203509/jj2134/)\n\nI'm not able to edit the transaction ID field after entering my key. Any help? I can't\ndelete it or type.\n\n[imalek - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203579/imalek/)\n\nGot nabbed by this this morning. Files started converting around 4 am EST (4/22/21).\nI was using my laptop at my office and luckily happened to be looking in our archive\nfolders (main purpose of NAS besides camera DVR) and actively saw files being\nreplaced.\nimmediately unplugged everything and shutdown the NAS.\nLuckily for me only local network devices had started propagating the new files and I\nwas able to use a remote PC as a source for the originals after updating, cleaning and\nrestoring everything.\nIMMEDIATELY Bought a backup drive for our backup server and will being taking\nweekly snapshots off-site from now on. It was an eye-opening experience. (our files\nare mostly docs and PDFs and a 3yr archive is only about 100 gb)\nI wish I could turn off ALL outside access, but unfortunately one of the main purposes\nof our QNAP was the abilty for remote cloud service and IP cam DVR w/ remote\nviewing (Everything thing else is disabled except qcloud......)\n\nShout out to ValiantThor for a awesome command for getting the password, I just wish\nI caught it an hour earlier while 7z was still running)\n\nBEST of luck to all those affected, and my hopes for a full recovery of all your stuff\n\n\n-----\n\n[jhy - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203581/jhy/)\n\nCould the password be in the client key? Might help if those who paid the ransom post\ntheir password and client key.\n\n[imalek - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203579/imalek/)\n\nUpdate 4/22/21 09:15 AM EST: Early this morning, BleepingComputer was contacted\nby security researcher Jack Cable about a bug he discovered in the Qlocker Tor site\nthat allowed users to recover their 7zip passwords for free.\n\nUsing this bug, victims could take a Bitcoin transaction ID from a person who had\nalready paid and slightly alter it. When they submitted the altered transaction ID into\nthe Qlocker Tor site, it accepted it as payment and displayed the victim's 7zip\npassword.\n\nLast night, Cable had been privately helping people recover their passwords and\narrangements were being made with Emsisoft to create a help system to better exploit\nthis weakness.\n\nSadly, an hour after we learned of the bug, the ransomware operators caught on and\nfixed it.\n\n\n-----\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nIf you decide to pay the ransom, make sure immediately change passwords and back\nup your files. You are still a target for another attack. Paying the ransom does not\nmake you safe from falling a victim again. I have been constantly getting failed Admin\naccess attempts. Protect your self.\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nIf you decide to pay the ransom, make sure immediately change passwords and back\nup your files. You are still a target for another attack. Paying the ransom does not\nmake you safe from falling a victim again. I have been constantly getting failed Admin\naccess attempts. Protect your self.\n\n\n-----\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nIf you decide to pay the ransom, make sure immediately change passwords and back\nup your files. You are still a target for another attack. Paying the ransom does not\nmake you safe from falling a victim again. I have been constantly getting failed Admin\naccess attempts. Protect your self.\n\n[AirNelly - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203417/airnelly/)\n\nI've turned off uPnP port forwarding but I'm getting constant admin login failed\nnotifications. I'm trying to get all my files off my QNAP and will need it to run overnight\nbut I don't want them to hack my NAS again. What can I do to ensure they can't\naccess my NAS? I've updated everything\n\n\n-----\n\n[wtutwiler70 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203429/wtutwiler70/)\n\n@AIrNelly\n\nHave you tried creating a different account with administrator privileges, and disabling\nthe default admin account? This seemed to take care of the login failures for me, as it\nis no longer a valid account to log in with.\n\n[ss1973 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203306/ss1973/)\n\nI created a new admin with a different username and password. A friend of mine had\nme change my port numbers. And turn on secured https. This has been a stressful 2\ndays I pray their is some kind of class action suit against QNAp.\n\n[Marchande - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203276/marchande/)\n\nso now that we know that the password is 32 characters long, I wonder if it woudl be\npossible to either generate a dictionary file using just 32 character ascii passwordes\nand run it through hascat and see if its possible to brute force it... thought not sure\nhow long something like that could take to both compile and or brute force\n\n\n-----\n\n[salvo981 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203415/salvo981/)\n\nhi, but if i pay the ransom to recover my files can i take legal action against qnap since\nthis problem was caused by them?\n\n[ozstar - 1 year ago](https://www.bleepingcomputer.com/forums/u/384420/ozstar/)\n\nI have got PuTTY on my Win 10x64 (which I have never used before) and given it my\nadmin and pwd for the NAS but what do I do now? The cursor just blinks.\n\n[vincentw2622 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203419/vincentw2622/)\n\ntry this out and dont reboot your nas\n[https://youtu.be/aq_cIdY_ksQ](https://youtu.be/aq_cIdY_ksQ)\n\n\n-----\n\n[salvo981 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203415/salvo981/)\n\nhi, unfortunately I find myself forced to pay as I can to make a transaction in their\nfavor in bitcoin.\n\n[Tony-OZ - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203400/tony-oz/)\n\nwhat did it cost you pal ?\n\n[matteocalle - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203181/matteocalle/)\n\nHi Salvo, After making the payment they give your password successfully?\n\n\n-----\n\n[polarbear616 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203081/polarbear616/)\n\nNevermind\n\n[Chris10eS - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203605/chris10es/)\n\nI was affected by the attack as well (the Nederlands). Noticed that not all files were\nencrypted. But unfortunately the business ones wewe all. Luckely i had switched off\nthe back up possibility, by turning off the main nas straight away, My backup files are\nall okay. No 7z or read me text to be found.\n\n[Chris10eS - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203605/chris10es/)\n\nI was affected by the attack as well (the Nederlands). Noticed that not all files were\nencrypted. But unfortunately the business ones wewe all. Luckely i had switched off\nthe back up possibility, by turning off the main nas straight away, My backup files are\nall okay. No 7z or read me text to be found.\n\n\n-----\n\n[Boydy81 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1203422/boydy81/)\n\nOk so I have an interesting story I noticed yesterday that I was hit by the qlocker as I\nwas working on an After effects file and the file all of a sudden didn't show up, I looked\ncloser as the 7z file was on the end, this brought me to this thread. The NAS had to\nbe turned off due to Electrical works being done at my house, after looking into this\nfurther and from QNAP support themselves they pretty much said that because the\nNAS has been turned off it useless now, (who is unless you say?) So I have recently\nturned the NAS back on for a quick look at the files and noticed all my larger files are\nstill there Pics are not however I have had the Edited ones backed up on Dropbox.\nCan someone recommend how I get the Malware off ? or should I just get the Videos\netc off and start again. Just to add to this I do a lot of my Business stuff through\ndropbox so lucky not off my NAS.\n\n[View all 482 comments](https://www.bleepingcomputer.com/news/security/massive-qlocker-ransomware-attack-uses-7zip-to-encrypt-qnap-devices/?sa=1)\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-21 - Massive Qlocker ransomware attack uses 7zip to encrypt QNAP devices.pdf"
    ],
    "report_names": [
        "2021-04-21 - Massive Qlocker ransomware attack uses 7zip to encrypt QNAP devices.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535945,
    "ts_updated_at": 1743041614,
    "ts_creation_date": 1653617316,
    "ts_modification_date": 1653617316,
    "files": {
        "pdf": "https://archive.orkl.eu/18d00f9fd1392dedeec0e88fa60c9bd8772bf9a9.pdf",
        "text": "https://archive.orkl.eu/18d00f9fd1392dedeec0e88fa60c9bd8772bf9a9.txt",
        "img": "https://archive.orkl.eu/18d00f9fd1392dedeec0e88fa60c9bd8772bf9a9.jpg"
    }
}