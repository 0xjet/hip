{
    "id": "9f69a415-6c11-43c3-822f-adebdb90bb00",
    "created_at": "2023-01-12T15:08:57.252104Z",
    "updated_at": "2025-03-27T02:16:26.235468Z",
    "deleted_at": null,
    "sha1_hash": "234ec29520b600247f36856bb79eaf719cf400a1",
    "title": "2021-04-21 - Monitoring Pulse Connect Secure With Splunk (CISA Emergency Directive 21-03)",
    "authors": "",
    "file_creation_date": "2022-05-28T02:36:59Z",
    "file_modification_date": "2022-05-28T02:36:59Z",
    "file_size": 1098785,
    "plain_text": "# Monitoring Pulse Connect Secure With Splunk (CISA Emergency Directive 21-03)\n\n**[splunk.com/en_us/blog/security/monitoring-pulse-connect-secure-with-splunk-cisa-emergency-directive-21-03.html](https://www.splunk.com/en_us/blog/security/monitoring-pulse-connect-secure-with-splunk-cisa-emergency-directive-21-03.html)**\n\nApril 21, 2021\n\nBy [Dave Herrald April 21, 2021](https://www.splunk.com/en_us/blog/author/dherrald.html)\n[Contributors: Mick Baccio,](https://www.splunk.com/en_us/blog/author/mbaccio.html) _[James Brodsky, Tamara Chacon, Shannon Davis,](https://www.splunk.com/en_us/blog/author/jbrodsky.html)_ _[Dave Herrald,](https://www.splunk.com/en_us/blog/author/dherrald.html)_\n_[Kelly Huang,](https://www.splunk.com/en_us/blog/author/khuang.html)_ _[Ryan Kovar,](https://www.splunk.com/en_us/blog/author/rkovar.html)_ _[Marcus LaFerrerra, Michael Natkin,](https://www.splunk.com/en_us/blog/author/mlaferrera.html)_ _[John Stoner and](https://www.splunk.com/en_us/blog/author/jstoner.html)_ _[Bill Wright](https://www.splunk.com/en_us/blog/author/bwright.html)_\n\n\n-----\n\n**Update May 4, 2021: Over the last two weeks, there have been several significant**\n[developments. First and most importantly, Pulse Secure issued an update on May 3](https://kb.pulsesecure.net/articles/Pulse_Secure_Article/SA44784/)\naddressing multiple vulnerabilities. Splunk recommends that all Pulse Secure users review\n[and install the update as soon as possible. On April 30, CISA updated Alert (AA21-110A)](https://us-cert.cisa.gov/ncas/alerts/aa21-110a)\n[with new detections, including the \"Impossible Travel\" detection and JA3 analysis. We have](https://docs.splunksecurityessentials.com/content-detail/land_speed_privileged/)\nupdated our Splunk-friendly collection of indicators to include the latest from CISA.\n\nTo immediately see how to find potential vulnerabilities or exploits in your Pulse Connect\nSecure appliance, skip down to the \"Identifying, Monitoring and Hunting with Splunk\" section.\nOtherwise, read on for a quick breakdown of what happened, how to detect it, and MITRE\nATT&CK mappings.\n\n_https://snappygoat.com/b/29e92459abc8f20ebaa4fffd7921b8f67513db9e_\n\n## What You Need to Know About the Pulse Connect Secure Attacks\n\nOver the past few weeks, there has been increasing chatter regarding adversary groups\nexploiting multiple vulnerabilities in the Pulse Connect Secure (PCS) virtual private network\n[(VPN) appliance On April 20 2021 the Mandiant team at FireEye released a blog detailing](https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html)\n\n\n-----\n\ntheir findings from multiple recent incidents involving compromised PCS appliances. This\nreport prompted a flurry of activity from various organizations, including government\nagencies and security vendors. That same day, DHS Cybersecurity and Infrastructure\n[Security Agency (CISA) released Alert (AA21-110A) and](https://us-cert.cisa.gov/ncas/alerts/aa21-110a) [Emergency Directive 21-03, the](https://cyber.dhs.gov/ed/21-03/)\nlatter requiring all US Federal agencies to take specific action concerning PCS appliances in\ntheir environments. Splunk recommends all US Federal agencies refer to the DHS directive\nto ensure compliance.\n\nAccording to a [blog post by Pulse Secure, the incidents disclosed this week involve](https://blog.pulsesecure.net/pulse-connect-secure-security-update/)\nvulnerabilities that were patched in 2019 and 2020, plus a new issue (CVE-2021-22893\n[Security Advisory SA44784) discovered this month. The vendor notes that a software update](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784)\nfor this new issue will be available in early May. The post contains valuable information on all\nthe vulnerabilities and recommended mitigation measures, and customer support\ninformation. Of particular importance is the Pulse Connect Secure Integrity Tool, which\nallows you to check if essential components of your PCS appliance software have been\ntampered with. Splunk recommends all PCS customers follow this vendor-published\nguidance in its entirety.\n\nThe PCS appliance is a popular VPN solution that offers workers secure access to an\norganization's internal networks from anywhere in the world. Because VPN appliances play a\ncritical role in securing an organization’s network perimeter and, by design, exposed directly\nto the Internet, they are often targeted by adversaries. Although the latest news is specific to\nPulse Secure products, attacks of this nature are not limited to one vendor. Adversaries\ncommonly return to vulnerabilities in VPN products to gain unauthorized access to\norganizations. As recently as April 16, 2021, the US National Security Agency released a\n[cybersecurity advisory warning that older vulnerabilities in at least five different remote](https://www.nsa.gov/News-Features/Feature-Stories/Article-View/Article/2573391/russian-foreign-intelligence-service-exploiting-five-publicly-known-vulnerabili/)\naccess products were being actively exploited.\n\n## Identifying, Monitoring, and Hunting with Splunk\n\nHere are some hot-off-the-press searches to help find some of the badness described in\nthe FireEye/Mandiant blog and other sources. If we have coverage for these searches in\n[Splunk Security Content, we call them out in the MITRE ATT&CK section.](https://github.com/splunk/security_content)\n\nNote that proof of concept (POC) exploits are only available for some of the vulnerabilities\ninvolved in this attack. The detections below are all derived from a lab environment and\ninformed by the context provided in the FireEye/Mandiant report. If we uncover more\ninformation, we will publish updates!\n\n### Ingesting PCS Appliance Data into Splunk\n\nSeveral of the following techniques require logs from your PCS appliances to be ingested\ninto Splunk for analysis. PCS appliances use syslog to log to external systems like Splunk.\n[Ivanti publishes configuration details in the PCS appliance Admin guide; here is a link to](https://help.ivanti.com/ps/legacy/pcs/9.1rx/9.1r11/ps-pcs-sa-9.1r11.0-admin-guide.pdf)\n\n\n-----\n\n[Admin Guide version 9.1R11 (the latest available at the time of publication). PCS appliances](https://help.ivanti.com/ps/legacy/pcs/9.1rx/9.1r11/ps-pcs-sa-9.1r11.0-admin-guide.pdf)\nsupport multiple log export formats (\"standard,\" \"WELF,\" \"W3C\"). Each of these formats\nyields slightly different data and results. In 2015, Juniper Networks divested the JunOS Pulse\nproduct line to Pulse Secure, LLC, now owned by Ivanti. Early versions of the Splunk Add-on\nfor Juniper included support for the IVE/SA (now PCS) product line, with a sourcetype of\n\"juniper_sslvpn\" or \"juniper:ive.\" Since this time, third parties have published their own TAs\n[on SplunkBase (such as this one) or GitHub (such as](https://splunkbase.splunk.com/app/3852/) [this one) to continue to support the](https://github.com/mnatkin-splunk/TA-PCS)\n[PCS appliance log data. BOTS V’s RWI scenario made use of WELF-formatted log data from](https://www.splunk.com/en_us/blog/conf-splunklive/bots-v-at-conf20.html)\n[a Juniper SA utilizing this TA. Note that some examples in this blog use a sourcetype of](https://github.com/mnatkin-splunk/TA-PCS/blob/main/Legacy%20version/Splunk_TA_ive.spl)\n‘juniper:ive,’ some use a sourcetype of ‘pulse:connectsecure’, and some use a sourcetype of\n‘syslog.’ This emulates the variety of formatting we’ve observed in the wild. You should\ndetermine the sourcetype in use in your environment and substitute it in these example\nsearches when necessary.\n\nAdditionally, we recommend enabling logging for \"Unauthenticated Requests\" (this setting is\ndisabled by default on PCS appliances). While this may slightly increase the log volume, the\n[CISA alert demonstrates that it is vital in revealing evidence of tampering and potentially](https://us-cert.cisa.gov/ncas/alerts/aa21-110a)\nongoing malevolent activity.\n\n### Version Checking\n\nAccording to this week’s advisories, certain versions of the Pulse Secure appliance software\ncontain critical vulnerabilities. Therefore, it is important to catalog the versions of all Pulse\nSecure Connect appliances you have on your network so that you can create a mitigation\nplan. You can use Splunk to do this if you don’t have an alternative method. If you already\nhave a list of IP addresses for your PCS appliances, you can feed that list as a lookup into a\nsimple [Splunk Technical Add-On that we have created, which will sequentially probe each](https://github.com/stressboi/TA-pcsverchecker)\nappliance in the list and report the PCS version found into Splunk for reporting or alerting.\n```\nindex=main source=\"checkpcsversions.sh\"\n| stats values(pcs_version) as \"PCS Version\" by dest_ip\n| iplocation dest_ip\n\n```\n\n-----\n\n### CVE-2021-22893 Mitigation Monitoring\n\nThis technique can be employed to assess your exposure by finding appliances that may still\n[require mitigation according to the Pulse Secure guidance. We suggest you search through](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784)\nthose logs for evidence of the following:\n\nWindows File Share Browse\nPulse Secure Collaboration\n\nWhy? Because both of those services are vulnerable, and the temporary \"workaround\"\nmitigation that you should have already applied turns both of these functions off. Therefore,\n**if you are still seeing activity from either function in the logs, and you know that your**\n**appliance is running a vulnerable Pulse Secure version, you must apply the**\n**[appropriate workaround via application of the \"workaround-2104.xml\" file. You can](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784)**\ncreate a report or alerts based on any appliances still logging file sharing or collaboration\nactivity, and provide the report or alerts to your network team to implement the workaround.\nPulse Secure has committed to releasing an update in early May 2021, at which time this\nworkaround can be reverted, thereby restoring these two capabilities if necessary.\n\n**Pulse Secure Collaboration Activity**\n\nHere is a quick and easy search to determine if Pulse Secure Collaboration is currently being\nused. You might look at the search and think, what is this reference to \"meetings?\" Well,\n[\"Secure Meetings\" is what the original functionality in the appliance was called. Not all of the](https://docs.pulsesecure.net/WebHelp/Content/PCS/PCS_AdminGuide_8.2/Pulse%20Collaboration%20Overview.htm#:~:text=Pulse%20Collaboration%20(formerly%20Secure%20Meeting,and%20non%2DConnect%20Secure%20users.)\nmeeting fields are displayed here nor are they all required to determine if it is running, but it\nis meant to show you what can be seen in the events.\n```\nsourcetype=pulse:connectsecure dest=<IP Address of Pulse devices> meeting_id=*\n| table _time src meeting_name meeting_action meeting_bytes_read\nmeeting_bytes_written meeting_client_version meeting_invitee meeting_server\nmeeting_property meeting_property_initial_value meeting_property_new_value\nmeeting atendee meeting duration\n\n```\n\n-----\n\n```\n| sort + _time\n\n```\n**_Note: You should determine the sourcetype in use in your environment and substitute it in_**\n_these example searches as applicable._\n\n### Windows File Share Activity\n\nAs stated, you’re also going to want to track Windows File Share activity. If your PCS\nappliance is configured to use WebTrends Enhanced Log Format (WELF) formatting for\nsyslog events, this activity will be captured in the proto field. Search your logs for:\n\n**_proto=fbr_** for Windows File Share activity\n\nAnd as an alternative to the meeting search above, you can also search:\n\n**_proto=meeting_** for Pulse Secure Collaboration activity\n\nAn example of this, combining both kinds of activity in the same search, is as follows:\n```\nsearch sourcetype=juniper:ive proto!=auth\n| stats values(proto) AS Activity by user\n\n```\n\n-----\n\n**_Note: You should determine the sourcetype in use in your environment and substitute it in_**\n_these example searches as applicable._\n\nHowever, if your PCS appliance is configured for \"standard\" formatting for your syslog, PCS\nmay identify activity based on a message code within the \"msg\" field. The format is three\nletters followed by five numbers (e.g. \"MTG20035\" or \"FBR20503\"). The examples below\nextract only the three letter code which indicates the feature being used. As previously noted,\nFBR denotes Windows File Share activity.\n\nExamples of this are as follows:\n```\nsourcetype=\"juniper:ive\"\n| rex field=msg \"(?<product>^\\w{3})\"\n| stats values(product) AS Activity by user\n\n```\n\n-----\n\nIn the following example, we’re substituting the activity code in-line (though this could be\naccomplished with a lookup as well):\n```\nsourcetype=\"juniper:ive\"\n| rex field=msg \"(?<product>^\\w{3})\"\n| eval app=case(match(product,\"FBR\"),\"Windows File\nBrowser\",match(product,\"JAV\"),\"Java Embedded App\",match(product,\"MTG\"),\"Secure\nMeeting\")\n| stats values(app) AS Activity by user\n\n```\n**_Note: You should determine the sourcetype in use in your environment and substitute it in_**\n_these example searches as applicable._\n\nAlternatively, if your logging includes URIs, you may search for the following:\n```\n/dana/fb/smb/wfb.cgi for Windows File Share browsing activity\n/dana/fb/smb/swsh.cgi  for Windows File Share activity\n\n```\n\n-----\n\n```\n/dana na/{meeting_base_URL}/meetingrun.cgi for Pulse Secure Collaboration activity\n(where {meeting_base_URL} is the administrator-configured base URL for secure\nmeetings)\n\n```\nDepending on the logging configuration on the PCS appliance, events such as the ones\nbelow are logged when connections are attempted to access files on the Windows servers.\n\nTurning to a familiar source of data that you may also be collecting, Windows Security event\nlogs, the search below provides a way to gain insight into files being accessed through a\nshare directly from Windows. This can be useful in case the PCS appliance is not logging\nthis level of fidelity.\n```\nsource=\"WinEventLog:Security\" EventCode=5145 Source_Address=<IP Address of Pulse\ndevices> Share_Name=\"\\\\\\\\*\\\\C$\"\n| table _time ComputerName Security_ID Relative_Target_Name Accesses\n\n```\n\n-----\n\nSimilarly, if a share is attempted to be accessed without proper permissions, a Windows\nEventCode 4625 will trigger. Turning back to the Pulse Secure logs, in the example below,\nthe user \"badguy\" successfully joins as shown in these events:\n\nHowever, “badguy” tries to connect to a file share and is rejected. The following search\nsheds light on why he was not able to access the desired resource. In this example with\nLDAP configured on the Windows device, the \"user name does not exist.\" This search can\nbe used to determine why login events from that originate from the Pulse Server(s) are not\nauthenticating successfully.\n```\nsource=\"WinEventLog:Security\" EventCode=4625 Source_Network_Address=<IP Address of\nPulse devices> \n| table _time EventCode hostname user Source_Network_Address Logon_Process\n\n```\nWhy is all of that important? Because, it enables another potential detection. FireEye noted\n[in their blog that “the malicious operations of SLOWPULSE can be detected via log](https://www.fireeye.com/blog/threat-research/2021/04/suspected-apt-actors-leverage-bypass-techniques-pulse-secure-zero-day.html)\ncorrelation between the authentication servers responsible for LDAP and RADIUS auth and\nthe VPN server. Authentication failures in either LDAP or RADIUS logs with the associated\nVPN logins showing success would be an anomalous event worthy of flagging.” The\nfollowing search will return a listing of login events from Pulse that are tied into LDAP; in our\ncase we are using Active Directory for LDAP so our realm is called AD.\n```\nsourcetype=pulse:connectsecure dest=<IP Address of Pulse devices> action=success\nrealm=AD\n| table _time user\n| sort + _time\n\n```\n\n-----\n\nFrom there, we could take those Pulse logins and look for the failed login events, Event\nCode 4625. That search is above. Timestamps should be very close to one another, within\nseconds.\n\n**_Note: You should determine the sourcetype in use in your environment and substitute it in_**\n_these example searches as applicable._\n\n### Indicators of Compromise (IOCs)\n\nFireEye/Mandiant published IOCs, including files, hashes, web shells, and sed patterns in\ntheir blog posts. [Ivanti and](https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA44784/) [CISA published additional IOCs (including additional hashes and](https://us-cert.cisa.gov/ncas/alerts/aa21-110a)\naffected URIs) in their respective posts. We have consolidated and converted these\n[indicators into simple CSV format so that you may use them as lookup tables — and posted](https://docs.splunk.com/Documentation/Splunk/8.1.2/Knowledge/Aboutlookupsandfieldactions)\nto Github [here for review and consumption. But what’s a lookup table, and how does it help](https://github.com/mnatkin-splunk/pulse_connect_secure-splunk-csvs)\n[with security detection in Splunk? Got you covered there, too.](https://www.splunk.com/en_us/blog/security/lookup-before-you-go-go-hunting.html)\n\n### Webshells\n\nMany of the attacks disclosed this week result in the installation of webshells on the PCS\n[appliance. We felt it valuable to include a reference to this classic Youtube video from James](https://www.youtube.com/watch?v=FEb8KZoEyzI)\nBower about how to hunt web shells with Splunk.\n\n## Splunk Enterprise Security\n\n### Know Thyself\n\nWhile we have spent some time explaining this attack and effort needs to be put toward\ninvestigating this, it is also important to note that the basics are important. Basic asset\nmanagement, hopefully via your asset and identity framework, will tell you where your\nvulnerable systems reside. Running regular vulnerability scans that integrate into Splunk will\ndisplay which systems are vulnerable and can help you prioritize your patching schedule and\nbetter focus your detection efforts.\n\n\n-----\n\n### Threat Intelligence Framework\n\n[You can also leverage the IOCs above (for those that don’t want to scroll up, here they are)](https://github.com/mnatkin-splunk/pulse_connect_secure-splunk-csvs)\nwith [Splunk Enterprise Security. The Threat Intelligence Framework can easily ingest these](https://www.splunk.com/en_us/software/enterprise-security.html)\nIOCs and Splunk Enterprise Security will let you know if any of them are identified. If you\n[aren’t sure how to do this, check out our recent blog post that walks you through the process](https://www.splunk.com/en_us/blog/security/smoothing-the-bumps-of-onboarding-threat-indicators-into-splunk-enterprise-security.html)\nof onboarding IOCs in Splunk Enterprise Security.\n\n## MITRE ATT&CK\n\nReviewing the blog posts from FireEye/Mandiant, we mapped the adversary’s activity to\nMITRE ATT&CK. Each tactic is then linked to Splunk Content to help you hunt for that\ninformation. Be aware; these searches are provided as a way to accelerate your hunting. We\n[recommend you configure them via the Splunk Security Essentials App. You may need to](https://splunkbase.splunk.com/app/3435/)\nmodify them to work in your environment! Many of these searches are optimized for use with\nthe tstats command.\n\nFinally, as more information becomes available, we will update these searches if more\nATT&CK TTPs become known.\n\n\n**ATT&CK**\n**Tactic**\n\n\n**Title** **Splunk Searches**\n\n\nT1003 OS Credential Dumping [Many Detections](https://github.com/splunk/security_content/search?q=T1003)\n\n\n-----\n\nT1016 System Network\nConfiguration Discovery\n\n\nDetect processes used for System Network\nConfiguration Discovery\n\n\nT1021.001 Remote Desktop\nProtocol [Remote Desktop Network Bruteforce](https://github.com/splunk/security_content/blob/5904eb999d51d86fce9c71c305d4513d2a250276/detections/experimental/network/remote_desktop_network_bruteforce.yml)\n\n[Remote Desktop Process Running On System](https://github.com/splunk/security_content/blob/5904eb999d51d86fce9c71c305d4513d2a250276/detections/experimental/endpoint/remote_desktop_process_running_on_system.yml)\n\n[Remote Desktop Network Traffic](https://github.com/splunk/security_content/blob/5904eb999d51d86fce9c71c305d4513d2a250276/detections/experimental/network/remote_desktop_network_traffic.yml)\n\n\nT1027 Obfuscated Files or\nInformation\n\nT1048 Exfiltration Over\nAlternative Protocol\n\n\nMalicious PowerShell Process - Encoded\nCommand\n\n[Many Detections](https://github.com/splunk/security_content/search?q=T1048)\n\n\nT1053 Scheduled Task/Job [Many Detections](https://github.com/splunk/security_content/search?q=T1053)\n\nT1057 Process Discovery\n\nReconnaissance and Access to Processes and\nServices via Mimikatz modules\n\nReconnaissance and Access to Operating System\nElements via PowerSploit modules\n\n\nT1059 Command and\nScripting Interpreter\n\nT1059.003 Windows Command\nShell\n\nT1070 Indicator Removal on\nHost\n\nT1070.001 Clear Windows Event\nLogs\n\n\n[Many Detections](https://github.com/splunk/security_content/search?q=T1059)\n\n[Many Detections](https://github.com/splunk/security_content/search?q=T1059.003)\n\n[Many Detections](https://github.com/splunk/security_content/search?q=T1070)\n\n[Windows Event Log Cleared](https://github.com/splunk/security_content/blob/6212932c3573345c3e7714ae07cb35693d01ae76/detections/endpoint/windows_event_log_cleared.yml)\n\n\n-----\n\nT1071.001 Web Protocols\n\n[TOR Traffic](https://github.com/splunk/security_content/blob/5904eb999d51d86fce9c71c305d4513d2a250276/detections/experimental/network/tor_traffic.yml)\n\nT1082 System Information\nDiscovery [System Information Discovery Detection](https://github.com/splunk/security_content/blob/5904eb999d51d86fce9c71c305d4513d2a250276/detections/endpoint/system_information_discovery_detection.yml)\n\n[Web Servers Executing Suspicious Processes](https://github.com/splunk/security_content/blob/5904eb999d51d86fce9c71c305d4513d2a250276/detections/experimental/application/web_servers_executing_suspicious_processes.yml)\n\nT1098 Account Manipulation [Many detections](https://github.com/splunk/security_content/search?q=T1098)\n\nT1105 Ingress Tool Transfer\n\nCertUtil Download With URLCache and Split\nArguments\n\nCertUtil Download With VerifyCtl and Split\nArguments\n\n[BITSAdmin Download File](https://github.com/splunk/security_content/blob/a40dc1283291e9959f38720d7f0efbbdf5fbbdf4/detections/endpoint/bitsadmin_download_file.yml)\n\nT1136 Create Account [Many detections](https://github.com/splunk/security_content/search?q=T1136)\n\n\nT1140 Deobfuscate/Decode\nFiles or Information\n\nT1190 Exploit Public Facing\nApplication\n\nT1505.003 Web Shell\n\n\n[CertUtil With Decode Argument](https://github.com/splunk/security_content/blob/6212932c3573345c3e7714ae07cb35693d01ae76/detections/endpoint/certutil_with_decode_argument.yml)\n\n[SQL Injection with Long URLs](https://github.com/splunk/security_content/blob/5904eb999d51d86fce9c71c305d4513d2a250276/detections/experimental/web/sql_injection_with_long_urls.yml)\n\n[Supernova Webshell](https://github.com/splunk/security_content/blob/5904eb999d51d86fce9c71c305d4513d2a250276/detections/experimental/web/supernova_webshell.yml)\n\nW3WP Spawning Shell\n\n[Detect Exchange Web Shell](https://github.com/splunk/security_content/blob/6212932c3573345c3e7714ae07cb35693d01ae76/detections/endpoint/detect_exchange_web_shell.yml)\n\n\nT1518 Software Discovery Reconnaissance and Access to Operating System\nElements via PowerSploit modules\n\n\n-----\n\nT1554 Compromise Client\nSoftware Binary [Applying Stolen Credentials via Mimikatz modules](https://github.com/splunk/security_content/blob/6212932c3573345c3e7714ae07cb35693d01ae76/detections/endpoint/ssa___applying_stolen_credentials_via_mimikatz_modules.yml)\n\nApplying Stolen Credentials via PowerSploit\nmodules\n\nT1562 Impair Defenses [Many detections](https://github.com/splunk/security_content/search?q=T1562)\n\nT1569.002 Service Execution\n\n[Malicious Powershell Executed As A Service](https://github.com/splunk/security_content/blob/a40dc1283291e9959f38720d7f0efbbdf5fbbdf4/detections/endpoint/malicious_powershell_executed_as_a_service.yml)\n\n[Create Service In Suspicious File Path](https://github.com/splunk/security_content/blob/dd2393e0570f99ef7d5d8f0d37469212662ca92c/detections/endpoint/create_service_in_suspicious_file_path.yml)\n\n[First Time Seen Running Windows Service](https://github.com/splunk/security_content/blob/5904eb999d51d86fce9c71c305d4513d2a250276/detections/experimental/endpoint/first_time_seen_running_windows_service.yml)\n\nT1574 Hijack Execution Flow\n\nDetect Path Interception By Creation Of program\nexe\n\nReg exe Manipulating Windows Services Registry\nKeys\n\nHere is the full list of all the MITRE ATT&CK TTP’s that FireEye/Mandiant reported as being\nassociated with malware/groups identified in this attack:\n```\nT1003,T1016, T1021.001, T1027, T1036.005, T1048, T1049, T1053, T1057, T1059,\nT1059.003, T1070, T1070.001, T1070.004, T1071.001, T1082, T1098,\nT1105,T1111,T1133,T1134.001,\nT1136,T1140,T1190,T1505.003,T1518,T1554,T1556.004,T1592.004, T1562,T1569.002,T1574,\nT1600\n\n## Conclusion\n\n```\nWe know that these are significant vulnerabilities and that customers will want to patch as\nsoon as possible and determine if they were affected by this attack. If you haven’t patched\nyet (we’ve all been there), hopefully, these searches will provide you the ability to have more\nvisibility into your environment and any malicious activity that you might be experiencing. If\nthey don’t work perfectly, think of them as \"SplunkSpiration\" :-). As soon as we have more\n\n\n-----\n\n**information, we will update this blog. Need Help? Splunk experts are here for you!**\n**Customers should reach out to their customer success manager, sales engineer, or**\n**regional sales manager.**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-21 - Monitoring Pulse Connect Secure With Splunk (CISA Emergency Directive 21-03).pdf"
    ],
    "report_names": [
        "2021-04-21 - Monitoring Pulse Connect Secure With Splunk (CISA Emergency Directive 21-03).pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536137,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653705419,
    "ts_modification_date": 1653705419,
    "files": {
        "pdf": "https://archive.orkl.eu/234ec29520b600247f36856bb79eaf719cf400a1.pdf",
        "text": "https://archive.orkl.eu/234ec29520b600247f36856bb79eaf719cf400a1.txt",
        "img": "https://archive.orkl.eu/234ec29520b600247f36856bb79eaf719cf400a1.jpg"
    }
}