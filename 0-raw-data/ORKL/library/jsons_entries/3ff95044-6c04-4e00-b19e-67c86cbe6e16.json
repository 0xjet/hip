{
    "id": "3ff95044-6c04-4e00-b19e-67c86cbe6e16",
    "created_at": "2023-01-12T15:03:59.632517Z",
    "updated_at": "2025-03-27T02:05:59.129621Z",
    "deleted_at": null,
    "sha1_hash": "5ddd6443e22ab8ed5df8060a9272ccb962a34784",
    "title": "2022-05-16 - Apollo on Github",
    "authors": "",
    "file_creation_date": "2022-11-28T19:00:04Z",
    "file_modification_date": "2022-11-28T19:00:04Z",
    "file_size": 481706,
    "plain_text": "# MythicAgents/Apollo\n\n**github.com/MythicAgents/Apollo**\n\nMythicAgents\n\nApollo is a Windows agent written in C# using the 4.0 .NET Framework\ndesigned to be used in SpecterOps training offerings.\n\n## Installation\n\nTo install Apollo, you'll need Mythic installed on a remote computer. You can\n[find installation instructions for Mythic at the Mythic project page.](https://github.com/its-a-feature/Mythic/)\n\nFrom the Mythic install directory, use the following command to install Apollo as\nthe root user:\n```\n    ./mythic-cli install github https://github.com/MythicAgents/Apollo.git\n\n```\n\n-----\n\nFrom the Mythic install directory, use the following command to install Apollo as\na non-root user:\n```\nsudo -E ./mythic-cli install github\nhttps://github.com/MythicAgents/Apollo.git\n\n\n```\nOnce installed, restart Mythic to build a new agent.\n\n## Notable Features\n\nP2P Communication\nCredential Tracking and Manipulation\nUnmanged PE, .NET Assembly, and PowerShell Script Execution\nUser Exploitation Suite\nSOCKSv5 Support\n\n## Commands Manual Quick Reference\n\n**Command** **Syntax** **Description**\n\n\nassembly_inject `assembly_inject -PID`\n```\n             [pid] -Assembly\n             [assembly] -Arguments\n             [args]\n\n```\n\nExecute .NET\nassembly in remote\nprocess.\n\nBlock non-Microsoft\nsigned DLLs from\nloading into post-ex\njobs.\n\n\ncat `cat -Path [file]` Retrieve the output\nof a file.\n\ncd `cd -Path [dir]` Change working\ndirectory.\n\ncp `cp -Path [source] -` Copy a file from path\n`Destination` to destination.\n```\n             [destination]\n\n```\ndcsync `dcsync -Domain` DCSync one or more\n`contoso.local [-User` user credentials\n```\n             username -DC dc.ip]\n\n```\ndownload `download -Path [path] [-` Download a file off\n`Host [hostname]]` the target system.\n\n\n-----\n\n**Command** **Syntax** **Description**\n\n\nexecute_assembly `execute_assembly -`\n```\n             Assembly [assembly.exe]              Arguments [args]\n\n```\n\nExecute a .NET\nassembly registered\nwith\n```\nregister_file\n\n```\n\nexecute_pe `execute_pe -PE` Execute a statically\n\n`[binary.exe] -Arguments` compiled executable\n\n`[args]` that's been\n\nregistered with\n```\n                              register_file\n\n```\nexit `exit` Task agent to exit.\n\nget_injection_techniques `get_injection_techniques` Show currently\nregistered injection\ntechniques as well\nas the current\ntechnique.\n\ngetprivs `getprivs` Enable as many\nprivileges as\npossible for the\ncurrent access\ntoken.\n\nifconfig `ifconfig` Get Network\nAdapters and\nInterfaces\n\ninject `inject` Inject a new payload\ninto a remote\nprocess.\n\n\ninline_assembly `inline_assembly -`\n```\n             Assembly [Assembly.exe]              Arguments [Additional\n             Args]\n\n```\n\nExecute a .NET\nassembly in the\ncurrently executing\nprocess that's been\nregistered with\n```\nregister_file\n\n```\n\njobkill `jobkill [jid]` Kill a running job in\nthe agent.\n\njobs `jobs` List all running jobs.\n\nkeylog_inject `keylog_inject -PID [pid]` Inject a keylogger\ninto a remote\nprocess.\n\n\n-----\n\n**Command** **Syntax** **Description**\n\nkill `kill -PID [pid]` Attempt to kill the\nprocess specified by\n```\n                              [pid] .\n\n```\nlink `link` Link to a P2P agent\nvia SMB or TCP.\nModal popup only.\n\nload `load command1 command2` Load new\n`...` commands into the\n\nagent.\n\nls `ls [-Path [path]]` List files and folders\nin `[path] . Defaults`\nto current working\ndirectory.\n\nmake_token `make_token` Impersonate a user\nusing plaintext\ncredentials. Modal\npopup.\n\nmimikatz `mimikatz -Command [args]` Execute Mimikatz\nwith the specified\narguments.\n\nmkdir `mkdir -Path [dir]` Create a directory.\n\nmv `mv -Path [source] -` Move a file from\n`Destination` source to\n\n`[destination]` destination. Modal\n\npopup.\n\n\nnet_dclist `net_dclist`\n```\n             [domain.local]\n\n```\nnet_localgroup_member `net_localgroup_member -`\n```\n             Group [groupname] [             Computer [computername]]\n\n```\nnet_localgroup `net_localgroup`\n```\n             [computer]\n\n```\n\nList all domain\ncontrollers for the\ncurrent or specified\ndomain.\n\nRetrieve\nmembership\ninformation from a\nspecified group on a\ngiven computer.\n\nRetrieve local\ngroups known by a\ncomputer. Default to\nlocalhost.\n\n\n-----\n\n**Command** **Syntax** **Description**\n\n\nnet_shares `net_shares [-Computer`\n```\n             [computer]]\n\n```\nnetstat `netstat [-Tcp -Udp -`\n```\n             Established -Listen]\n\n```\npowerpick `powerpick -Command`\n```\n             [command]\n\n```\npowershell `powershell -Command`\n```\n             [command]\n\n```\n\nShow shares of a\nremote PC.\n\nGet TCP and UDP\nconnections\n\nExecutes\nPowerShell in a\nsacrificial process.\n\nExecutes\nPowerShell in your\ncurrently running\nprocess.\n\n\npowershell_import `powershell_import` Register a new .ps1\nfile to be used in\nother PowerShell\njobs\n\nppid `ppid -PID [pid_integer]` Set the PPID of\nsacrificial jobs to the\nspecified PID.\n\n\nprintspoofer `printspoofer -Command`\n```\n             [command]\n\n```\n\nExecute a command\nin SYSTEM integrity\nso long as you have\nSeImpersonate\nprivileges.\n\n\nps `ps` List process\ninformation.\n\n\npsinject `psinject -PID [pid] -`\n```\n             Command [command]\n\n```\n\nExecutes\nPowerShell in the\nprocess specified by\n```\n[pid] . Note:\n\n```\nCurrently stdout is\nnot captured of child\nprocesses if not\nexplicitly captured\ninto a variable or via\ninline execution\n(such as\n```\n$(whoami) ).\n\n```\n\n-----\n\n**Command** **Syntax** **Description**\n\n\npth `pth -Domain [domain] -`\n```\n             User [username] -NTLM\n             [ntlm_hash] [-AES128\n             [aes128_key] -AES256\n             [aes256_key] -Run\n             [program.exe]]\n\n```\n\nUse `mimikatz 's`\npth module to spawn\na process with\nalternate credentials.\n\n\npwd `pwd` Print working\ndirectory.\n\nreg_query `reg_query -Hive [HKCU:\\ HKU:|HKLM:|HKCR:]\n\n[-Key [keyname]]`\n\n\nreg_write_value `reg_write_value -Hive\n\n[HKCU:\\\n\n\nHKU:|HKLM:|HKCR:]\n-Key [keyname] [Name [value_name]\n-Value\n\n[value_value]]`\n\n\nregister_assembly `register_assembly` Register a .NET\nassembly with the\nagent to be used in\n.NET postexploitation activities\n\nregister_file `register_file` Register a file to the\nagent's file cache.\nUsed to store\nassemblies,\nexecutables, and\nPowerShell scripts.\n\nrev2self `rev2self` Revert the access\ntoken to the original\naccess token.\n\nrm `rm -Path [path] [-Host` Remove a file\n\n`[hostname] -File` specified by\n```\n             [filename]] [path] .\n\n```\nAlternatively, if `-`\n```\n                              File is provided,                               Path will be used\n\n```\nas the directory, and\n```\n                              -File will be the\n\n```\nfilename.\n\n\n-----\n\n**Command** **Syntax** **Description**\n\n\nrun `run -Executable`\n```\n             [binary.exe] -Arguments\n             [args]\n\n```\n```\n[binary.exe] with\n\n```\npassed arguments (if\nany).\n\n\nsc `sc [-Query\\ -Start|-Stop|-Create|Delete] [-Computer\n\n[computername] DisplayName\n\n[display_name] ServiceName\n\n[servicename] BinPath [binpath]]`\n\n\nscreenshot_inject `screenshot_inject -PID`\n```\n             [pid] [-Interval [int]              Count [int]]\n\n```\n\nGet a screenshot of\nthe desktop session\nassociated with\n```\nPID every\nInterval seconds\n\n```\nfor `Count`\nscreenshots.\n\n\nscreenshot `screenshot` Get a screenshot of\nthe current screen.\n\nset_injection_technique `set_injection_technique` Set the injection\n\n`[technique]` technique used in\n\npost-ex jobs that\nrequire injection.\n\nshell `shell [command]` Run a shell\ncommand which will\ntranslate to a\nprocess being\nspawned with\ncommand line:\n```\n                              cmd.exe /S /c\n                              [command]\n\n```\nshinject `shinject` Inject given\nshellcode into a\nspecified pid. Modal\npopup only.\n\nsleep `sleep [seconds]` Set the callback\ninterval of the agent\nin seconds.\n\n\n-----\n\n**Command** **Syntax** **Description**\n\nsocks `socks -Port [port]` Standup the socks\nserver to proxy\nnetwork traffic,\nroutable via Mythic\non `[port] .`\n\nspawn `spawn` Spawn a new\ncallback in the\npostex process\nspecified by\n```\n                               spawnto_* .\n\n```\nspawnto_x64 `spawnto_x64 -Application` Sets the process\n\n`[path] -Arguments [args]` used in jobs\n\nrequiring sacrificial\nprocesses to the\nspecified `[path]`\nwith arguments\n```\n                               [args] .\n\n```\nspawnto_x86 `spawnto_x86 -Application` Sets the process\n\n`[path] -Arguments [args]` used in jobs\n\nrequiring sacrificial\nprocesses to the\nspecified `[path]`\nwith arguments\n```\n                               [args] .\n\n```\nsteal_token `steal_token [pid]` Attempts to steal the\nprocess's primary\ntoken specified by\n```\n                               [pid] and apply it\n\n```\nto our own session.\n\nunlink `unlink` Unlink a callback\nlinked to via the\n```\n                               link command.\n\n```\nModal popup only.\n\nupload `upload` Upload a file to a\nremote path on the\nmachine. Modal\npopup only.\n\nwhoami `whoami` Report access token\nfor local and remote\noperations.\n\n## Supported C2 Profiles\n\n\n-----\n\n### HTTP Profile\n\nThe HTTP profile calls back to the Mythic server over the basic, non-dynamic\nprofile. When selecting options to be stamped into Apollo at compile time, all\noptions are respected with the exception of those parameters relating to GET\nrequests.\n\n### SMB Profile\n\nEstablish communications over SMB named pipes. By default, the named pipe\nname will be a randomly generated GUID.\n\n### TCP Profile\n\nEstablish communications over a specified network socket. Note: If unelevated,\nthe user may receive a prompt to allow communications from the binary to\noccur over the network.\n\n## SOCKSv5 Support\n\nApollo can route SOCKS traffic regardless of what other commands are\ncompiled in. To start the socks server, issue `socks -Port [port] . This`\nstarts a SOCKS server on the Mythic server which is `proxychains4`\ncompatible. To stop the SOCKS proxy, navigate to the SOCKS page in the\nMythic UI and terminate it.\n\n## Quality of Life Improvements\n\n### File Triage\n\nThe `ls command reports back a wealth of information and allows operators`\nto easily copy file paths and examine permissions of files, in addition to being\nable to sort and filter files. Clicking the icon under the ACLs column will show\nall the permissions of a file. Additionally, this hooks into Mythic's native file\nbrowser.\n\n\n-----\n\nThis shows typical ls output:\n\nInterfaces with Mythic's filebrowser and caches data server-side:\n\n### Process Listings\n\nWhen issuing `ps, additional details are retrieved such as:`\n\nCompany name of the process executable\nDescription of the process executable\nFull path of the process\nIntegrity level of the process\nDesktop session\nProcess command line arguments\n\nThis process listing also interfaces with Mythic's builtin process browser, which\nallows you to see process trees more easily.\n\nLastly, the associated browser script will do row highlighting based on the\n[process's name (in a one-to-one port of this script)](https://github.com/harleyQu1nn/AggressorScripts/blob/master/ProcessColor.cna)\n\n\n-----\n\n### Portable Executable, Assembly, and PowerShell Script Caching\n\nApollo can cache files for expeditious task execution. In general, control flow\nfollows the `register_file command followed by whatever command you`\nwish to execute ( execute_assembly, `powerpick,` `execute_pe, etc.).`\nThese files are cached client side via DPAPI encrypted AES256 blobs,\npreventing their signatures being exposed outside of task execution.\n\n### Dynamic Injection Techniques\n\nThe agent can change what code injection technique is in use by postexploitation jobs that require injection through a suite of injection commands.\nCurrently, injection techniques that are supported:\n\nCreateRemoteThread\nQueueUserAPC (Early Bird)\n\n\n-----\n\n### Job Tracking\n\nAgent jobs are tracked by job ID, by command, and by the arguments passed\nto the command so that you know what job correlates to what tasking.\n\n### Artifact Tracking\n\nCommands that manipulate the disk, create new logons, or spawn new\nprocesses will document those changes in the Artifact Reporting page as\nshown below.\n\n### And more!\n\nThere's a number of niceities that come with pairing an agent to Mythic - too\nmany to list in one README. Install the agent and see for yourself!\n\n## Special Thanks\n\nA big thanks goes to those who have contributed to the project in both major\nand minor ways.\n\n[Cody Thomas, @its_a_feature_](https://twitter.com/its_a_feature_)\nCalvin Hedler, [@001SPARTaN](https://twitter.com/001spartan)\n\n\n-----\n\n[Lee Christensen, @tifkin_](https://twitter.com/tifkin_)\n[Brandon Forbes, @reznok](https://twitter.com/rezn0k)\n[Thiago Mayllart, @thiagomayllart](https://twitter.com/thiagomayllart)\nMatt Hand, [@matterpreter](https://twitter.com/matterpreter)\nHope Walker, [@IceMoonHSV](https://twitter.com/IceMoonHSV)\nJack Ullrich, [@winternl_t](https://twitter.com/winternl_t)\nElad Shamir, [@elad_shamir](https://twitter.com/elad_shamir)\n[Ben Turner @benpturner](https://twitter.com/benpturner)\n[Ian Wallace @strawp](https://twitter.com/strawp)\n[m0rv4i @m0rv4i](https://twitter.com/m0rv4i)\n[Harley Lebeau @r3dQu1nn](https://twitter.com/r3dQu1nn)\n[Antonio Quina @st3r30byt3](https://twitter.com/st3r30byt3)\n[Sean Pierce @secure_sean](https://twitter.com/secure_sean)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-16 - Apollo on Github.pdf"
    ],
    "report_names": [
        "2022-05-16 - Apollo on Github.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535839,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1669662004,
    "ts_modification_date": 1669662004,
    "files": {
        "pdf": "https://archive.orkl.eu/5ddd6443e22ab8ed5df8060a9272ccb962a34784.pdf",
        "text": "https://archive.orkl.eu/5ddd6443e22ab8ed5df8060a9272ccb962a34784.txt",
        "img": "https://archive.orkl.eu/5ddd6443e22ab8ed5df8060a9272ccb962a34784.jpg"
    }
}