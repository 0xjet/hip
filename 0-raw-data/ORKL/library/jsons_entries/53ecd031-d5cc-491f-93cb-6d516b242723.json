{
    "id": "53ecd031-d5cc-491f-93cb-6d516b242723",
    "created_at": "2023-01-12T15:04:32.456165Z",
    "updated_at": "2025-03-27T02:05:45.913722Z",
    "deleted_at": null,
    "sha1_hash": "94df9d17bec5ad35d1df9f1ec2bf8da5372f59e1",
    "title": "2022-11-15 - New RapperBot Campaign – We Know What You Bruting for this Time",
    "authors": "",
    "file_creation_date": "2022-11-28T19:09:06Z",
    "file_modification_date": "2022-11-28T19:09:06Z",
    "file_size": 818583,
    "plain_text": "# New RapperBot Campaign – We Know What You Bruting for this Time\n\n**[fortinet.com/blog/threat-research/new-rapperbot-campaign-ddos-attacks](https://www.fortinet.com/blog/threat-research/new-rapperbot-campaign-ddos-attacks)**\n\nNovember 15, 2022\n\nAfter FortiGuard Labs reported on RapperBot in our previous article titled So RapperBot,\nWhat Ya Bruting For? in August 2022, there was a significant drop in the number of samples\ncollected in the wild. But in early October 2022, new samples with the same distinctive C2\nprotocol used by RapperBot were detected.\n\nUnlike the murky objectives of the previous campaign, it is quickly evident that these\n[samples are part of a separate campaign to launch Distributed Denial of Service (DDoS)](https://www.fortinet.com/resources/cyberglossary/ddos-attack)\nattacks against game servers, which we believe to be a re-emergence of a similar campaign\nfrom earlier this year.\n\n**Affected Platforms: Linux**\n\n**Impacted Users: Any organization**\n\n**Impact: Remote attackers gain control of the vulnerable systems**\n\n**Severity Level: Critical**\n\n\n-----\n\nThis article discusses the differences observed in this campaign and its relation to the\nprevious RapperBot and similar campaigns in the past.\n\n## RapperBot Rebooted\n\nFortiGuard Labs encountered this campaign by hunting for samples using the unique bot ID\nused by RapperBot to communicate with its Command-and-Control (C2) server, as reported\nin the previous article.\n\nBut once we analyzed these new samples, we observed a significant difference between\nthem and the earlier campaign. In fact, it turns out that this campaign is less like RapperBot\nthan an older campaign that appeared in February and then mysteriously disappeared in the\nmiddle of April. Other related campaigns uncovered during this investigation are detailed\nlater in this article.\n\n## Network Protocol and Denial-of-Service (DoS) Attacks\n\nThe C2 network protocol used in previous campaigns remains essentially unchanged, with\nadditional commands added to support the Telnet brute force. The list of commands and IDs\nare shown below:\n\n**0x00: Register (used by the client)**\n**0x01: Keep-Alive/Do nothing**\n**0x02: Stop all DoS attacks and terminate the client**\n**0x03: Perform a DoS attack**\n**0x04: Stop all DoS attacks**\n**0x06: Restart Telnet brute forcing**\n**0x07: Stop Telnet brute forcing**\n\nThe previously reported RapperBot campaign was limited to a few generic DoS methods\nagainst TCP and UDP services. This campaign adds DoS attacks against the GRE protocol\n(likely reusing the Mirai source code) and the UDP protocol used by the Grand Theft Auto:\nSan Andreas Multi Player (SA:MP) mod.\n\nHere are the DoS attack commands supported by this botnet:\n\n**0x00: Generic UDP flood**\n**0x01: TCP SYN flood**\n**0x02: TCP ACK flood**\n**0x03: TCP STOMP flood**\n**0x04: UDP SA:MP flood targeting game servers running GTA San Andreas: Multi**\nPlayer (SA:MP)\n**0x05: GRE Ethernet flood**\n**0x06: GRE IP flood**\n\n\n-----\n\n**0x07: Generic TCP flood**\n\nThese specific commands, coupled with the absence of HTTP-related DDoS attacks,\nsuggests that this campaign is primarily geared toward game server DDoS.\n\n## Telnet Self-propagation\n\nThe most significant difference in the new campaign was the complete replacement of the\nSSH brute forcing code with the more usual Telnet equivalent. FortiGuard Labs has observed\nsimilar drastic modifications within RapperBot samples, as detailed in our previous report,\nadding and removing even DoS attack code on an apparent whim.\n\nThe Telnet brute forcing code is designed primarily for self-propagation and resembles the\nold Mirai Satori botnet. Unlike the earlier SSH brute-forcing campaign, the plaintext\ncredentials are embedded into the malware instead of being downloaded from the C2.\n\nFigure 1. Function initializing the credential list\n\nThese credentials used appear to be default credentials for IoT devices. To optimize brute\nforcing efforts, the malware compares the server prompt upon connection to a hardcoded list\nof strings to identify the possible device and then only tries the known credentials for that\ndevice. Unlike less sophisticated IoT malware, this allows the malware to avoid trying to test\na full list of credentials. While not exactly a novel technique, it is still uncommon compared to\nother IoT botnets.\n\nBased on the prompt messages hardcoded into the malware, most of the targeted devices\nare IoT devices such as routers and DVRs. This campaign seems especially interested in\nolder devices with the Qualcomm MDM9625 chipset, such as LTE modems. It attempts to\nspecifically gain root access to these devices via a default password, despite having the\nsame credentials in the list embedded in the binary.\n\nFigure 2. Gaining root access on devices with a default password\n\nLike the earlier SSH brute-forcing campaign, once it has successfully gained access, it sends\nthe credentials used, the compromised device’s IP address, and its architecture to the C2\nserver on a separate port, 5123. After reporting, the malware attempts to install its main\npayload binary on the compromised device.\n\nIt first parses the Executable and Linkable Format (ELF) header of the /bin/busybox file for\nthe e_machine field, which provides the architecture of the compromised device. This allows\nit to download and deploy a RapperBot payload of the correct architecture to ensure proper\nexecution. This selective behavior is more efficient than the shotgun approach in most IoT\nmalware families, whereby all the binaries for the supported architectures are downloaded\nand executed in the victim's system.\n\n\n-----\n\nBased on the payload binaries we collected, this botnet currently seems to only target\ndevices running on ARM, MIPS, PowerPC, SH4, and SPARC architectures. Moreover, it\nspecifically checks and stops its self-propagation if the device is detected to be running on\nIntel processors.\n\nThe bot then downloads its payload via software installed on the compromised device, such\nas ftpget, wget, curl, or tftp, before executing the payload.\n\nFigure 3. Downloading the payload binary using the wget tool\n\nIf none of the software mentioned above is installed, it will extract and send an embedded\nbinary downloader to the compromised device that executes and downloads the primary\npayload.\n\nUnlike in Satori, these embedded downloaders are stored as escaped byte strings, probably\nto simplify parsing and processing within the code.\n\nFigure 4. List of embedded binary downloaders\n\nThe binary downloaders are written by echoing the bytes and piping the content to a file in\nthe victim system. As labeled in Figure 4, each binary has a hardcoded URL for downloading\nthe payload binary of the proper architecture.\n\nFigure 5. Writing downloader binary and executing it\n\nNo attempts to persist on infected or brute-forced devices were observed for this campaign.\n\n## Related Campaigns\n\nFortiGuard Labs compared samples for this and related campaigns from the past to find any\nlinks with the previously reported RapperBot campaign.\n\nWe observed that the earliest samples for this campaign were from December 2021 and that\nthe SA:MP attack was only added in February 2022. This campaign mysteriously\ndisappeared in mid-April 2022, resurfacing in Oct 2022 with the addition of the selfpropagation feature.\n\nWe also found older samples from another campaign that was active in August-September\n2021 with an almost identical list of credentials. These samples contain slightly fewer\ncredentials and a simpler self-propagation code that only supports downloading the payload\nvia wget or the binary downloader embedded directly into the sample. This campaign did not\nsupport stopping or restarting the Telnet propagation, and while the samples support the\nsame commands, their associated IDs did not match.\n\nFigure 6. Timeline of related campaigns\n\n\n-----\n\nThe similar lists of credentials suggest that the threat actor behind this current campaign has\naccess to the source code for the earlier campaign, as this code was not found in other IoT\nmalware samples.\n\n## Connections to RapperBot\n\nThe fact that samples from both campaigns use the same C2 protocol, coupled with the\nabsence of this campaign during the RapperBot campaign active between June and Aug\n2022 and its recent reappearance, seems to be more than a coincidence.\n\nWith the several similarities between the two campaigns outlined below, we believe that\neither the same threat actor might be behind both campaigns or each campaign might have\nbranched from the same privately-shared source code.\n\n1. The C2 commands and corresponding IDs are identical in both campaigns (excluding\n\nthe Telnet-related commands, as those do not apply to RapperBot)\n2. Both campaigns show a certain degree of effort in optimizing the brute forcing\n\nimplementation. Code for the brute forcing implementation is significantly more\nstructured than typical IoT malware that copies and pastes code with minimal\nmodifications.\n3. RapperBot also supported the TCP STOMP attack popularized by Mirai. This attack\n\nwas not observed in the earlier campaigns mentioned above. However, as both Mirai\nand Satori source code are publicly available, this is considered a very weak link\nbetween the campaigns.\n\nIf both campaigns were related, the reason for restarting an older campaign remains a\nmystery.\n\n## Conclusion\n\nBased on the undeniable similarities between this new campaign and the previously reported\nRapperBot campaign, it is highly likely that they are being operated by a single threat actor\nor by different threat actors with access to a privately-shared base source code.\n\nUnlike the previous RapperBot campaign, this new campaign has a clear motivation to\ncompromise as many IoT devices as possible to build a DDoS botnet.\n\nAlthough this new campaign has evolved significantly from previous campaigns, mitigating it\nremains the same—setting strong passwords for all devices connected to the internet.\n\nFortiGuard Labs will continue to monitor RapperBot’s development.\n\n## Fortinet Protections\n\n\n-----\n\nThe FortiGuard Antivirus service detects and blocks this threat as ELF/Mirai, Linux/Mirai,\nand ELF/Gafgyt.\n\n[The FortiGuard AntiVirus service is supported by FortiGate,](https://www.fortinet.com/products/next-generation-firewall.html?utm_source=blog&utm_medium=blog&utm_campaign=2018-q2-fortigate-main-page) [FortiMail,](https://www.fortinet.com/products/email-security/fortimail.html?utm_source=blog&utm_medium=blog&utm_campaign=2018-q2-fortimail-main-page) [FortiClient, and](https://www.fortinet.com/products/endpoint-security/forticlient?utm_source=blog&utm_medium=blog&utm_campaign=forticlient)\n[FortiEDR, and the Fortinet AntiVirus engine is a part of each of those solutions. Customers](https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&utm_medium=blog&utm_campaign=2020-q1-fortiedr)\nrunning current AntiVirus updates are protected.\n\n[FortiGuard Labs provides the Rapper.Botnet IPS signature against RapperBot C2 activity.](https://www.fortiguard.com/encyclopedia/ips/52235)\n\nThe FortiGuard Web Filtering Service blocks the C2 servers and download URLs.\n\n[FortiGuard IP Reputation and Anti-Botnet Security Service proactively block these attacks by](https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/ipreputation-antibot)\naggregating malicious source IP data from the Fortinet distributed network of threat sensors,\nCERTs, MITRE, cooperative competitors, and other global sources that collaborate to\nprovide up-to-date threat intelligence about hostile sources.\n\n## IOCs\n\n### Files\n\n3d5c5d9e792e0a5f3648438b7510b284f924ab433f08d558b6e082e1d5414a03\n\n7afcac5f71e9205879e0e476d3388898a62e7aa4a3e4a059884f40ea36cfd57f\n\n8ec79a35700f6691f0d88d53647e9f2b75648710ecd119e55815331fc3bdd0b5\n\na12ad4bc394d60bc037271e1c2df1bd2b87bdaaba85f6c1b7d046341f027cc2d\n\nf000bf482040b48595badee1fc56afb95449ac48b5dc35fe3a05542cbf18f658\n\n4aa9175c1846557107ec197ea73d4cc8dbe6d575a8fd86ae214ff9b3a00e438b\n\nf98261eb7dc122449c158118cc9c660683206983a9e90ff73eb88c4705e0c48e\n\n### Download URLs\n\nhxxp://185[.]216[.]71[.]149/armv4l\n\nhxxp://185[.]216[.]71[.]149/armv5l\n\nhxxp://185[.]216[.]71[.]149/armv6l\n\nhxxp://185[.]216[.]71[.]149/armv7l\n\nhxxp://185[.]216[.]71[.]149/mips\n\nhxxp://185[.]216[.]71[.]149/mipsel\n\nhxxp://185[.]216[.]71[.]149/powerpc\n\nhxxp://185[.]216[.]71[.]149/sparc\n\n\n-----\n\nhxxp://185[.]216[.]71[.]149/sh4\n\nhxxp://185[.]216[.]71[.]149/bot_arm4_el\n\nhxxp://185[.]216[.]71[.]149/bot_arm5_el\n\nhxxp://185[.]216[.]71[.]149/bot_arm6_el\n\nhxxp://185[.]216[.]71[.]149/bot_arm7_el\n\nhxxp://185[.]216[.]71[.]149/bot_mips_eb\n\nhxxp://185[.]216[.]71[.]149/bot_mips_el\n\nhxxp://185[.]216[.]71[.]149/bot_sh_el\n\n### C2\n\n185[.]216[.]71[.]149\n\n_Learn more about Fortinet’s_ _[FortiGuard Labs threat research and global intelligence](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_medium=blog&utm_campaign=fortiguard-labs)_\n_[organization and Fortinet’s FortiGuard AI-powered Security Services portfolio.](https://www.fortinet.com/solutions/enterprise-midsize-business/security-as-a-service/fortiguard-subscriptions?utm_source=blog&utm_medium=blog&utm_campaign=fortiguard-subscriptions)_ _[Sign up to](https://www.fortinet.com/blog/threat-research?utm_source=blog&utm_medium=blog&utm_campaign=threat-research)_\n_receive our threat research blogs._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-15 - New RapperBot Campaign – We Know What You Bruting for this Time.pdf"
    ],
    "report_names": [
        "2022-11-15 - New RapperBot Campaign – We Know What You Bruting for this Time.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535872,
    "ts_updated_at": 1743041145,
    "ts_creation_date": 1669662546,
    "ts_modification_date": 1669662546,
    "files": {
        "pdf": "https://archive.orkl.eu/94df9d17bec5ad35d1df9f1ec2bf8da5372f59e1.pdf",
        "text": "https://archive.orkl.eu/94df9d17bec5ad35d1df9f1ec2bf8da5372f59e1.txt",
        "img": "https://archive.orkl.eu/94df9d17bec5ad35d1df9f1ec2bf8da5372f59e1.jpg"
    }
}