{
    "id": "8d2647c3-0154-4b2a-b14f-5727ae987f97",
    "created_at": "2022-10-25T16:48:19.802433Z",
    "updated_at": "2025-03-27T02:14:43.596143Z",
    "deleted_at": null,
    "sha1_hash": "d75290d64647f01eda0a1c7495d65d45cc858f19",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-12-09T10:51:14Z",
    "file_modification_date": "2020-12-09T10:51:18Z",
    "file_size": 7083055,
    "plain_text": "##### RESEARCH\n\n# MOLERATS IN\n THE CLOUD:\n\n### New Malware Arsenal Abuses Cloud Platforms in Middle East Espionage Campaign\n\n\n-----\n\n[In February 2020, Cybereason reported the discovery of the Spark and Pierogi backdoors, likely used](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one)\n[in targeted attacks against Palestinian officials. The attacks were attributed to Molerats (aka The Gaza](https://attack.mitre.org/groups/G0021/)\nCybergang), an Arabic-speaking, politically-motivated APT group that has operated in the Middle East since\n2012.\n\nSince the discovery, the Cybereason Nocturnus Team has been tracking the group, and in recent months\nhave detected a new campaign leveraging two previously unidentified backdoors dubbed SharpStage,\n_DropBook, and a downloader dubbed MoleNet. The new malware arsenal is designed for stealthy espionage_\noperations specifically aimed at mainly Arab-speaking targets in the Middle East, being primarily observed in\nthe Palestinian Territories, UAE, and Egypt as well as non-Arabic speaking targets in Turkey.\n\nThis latest campaign leverages social engineering techniques to deliver phishing documents that include\nvarious decoy themes related to current Middle Eastern affairs. Among the themes used in the phishing\ncampaign were:\n\n#### • References to Israeli relations with neighboring Arab countries: Specifically the recent meeting\n\n[between His Royal Highness Mohammed bin Salman, Crown Prince of Saudi Arabia (MBS), the U.S.](https://en.wikipedia.org/wiki/Mohammed_bin_Salman)\n[Secretary of State Mike Pompeo and Israeli PM Benjamin Netanyahu, as reported in the media.](https://en.wikipedia.org/wiki/Mike_Pompeo)\n\n#### • References to Palestinian political affairs: the campaign uses different themes related to Palesitinian\n\npolitical events and public figures:\n\n#### • Hamas Internal Elections\n\n • Dr. Ahmad Majdalani, the Secretary-General of the Palestinian Popular Struggle Front (PPSF)\n\n • Possibly fake documents allegedly authored by the Popular Front for the Liberation of\n\n[Palestine (PFLP) detailing media preparations for PFLP’s 53rd anniversary celebrations](https://en.wikipedia.org/wiki/Popular_Front_for_the_Liberation_of_Palestine)\n\nThe newly discovered backdoors were delivered together with the previously reported Spark backdoor,\nwhich along with other similarities to previous campaigns, further strengthens the attribution to Molerats.\n\nBoth SharpStage and DropBook backdoors operate in a stealthy manner, implementing the legitimate cloud\n[storage service Dropbox to exfiltrate the stolen information from their targets, thus evading detection or](https://www.dropbox.com/?landing=dbv2)\ntakedowns by using legitimate web service. In addition, the team discovered that DropBook, a new Python[based backdoor, exploits the social media platform Facebook, where the backdoor operators create fake](https://www.facebook.com/)\naccounts to control the backdoor while hiding in plain sight. DropBook differs from the other espionage\ntools in the arsenal since it relies solely on fake Facebook accounts for C2 to receive instructions from its\noperators. While the exploitation of social media for C2 communication is not new, it is not often observed in\nthe wild.\n\n\n-----\n\nMoreover, the Cybereason Nocturnus team also uncovered Molerats activity leveraging the Spark backdoor\nagainst Turkish-speaking targets based on observation of phishing documents in Turkish language.\n\nLastly, the team has identified a separate campaign that uses a new variant of the Pierogi backdoor against\nsimilar targets that were also infected with the Spark, SharpStage, and DropBook backdoors. This overlap further\nstrengthens the suspected ties between the two sub-groups of the Gaza Cybergang: Molerats and APT-C-23\n(Arid Viper).\n\nCybereason reached out to Facebook, Dropbox, Google and Simplenote reported the abused accounts.\n\n\n-----\n\n## Key Findings\n\n#### • Threat Actors Assessed to be Molerats (aka The Gaza Cybergang): An Arabic-speaking, politically\n\nmotivated group that has operated in the Middle East since 2012.\n\n#### • New Espionage Tools Developed by Molerats: Cybereason identified two new backdoors dubbed\n\nSharpStage and DropBook, as well as the MoleNet downloader, all of which can allow the attackers the\nability to execute arbitrary code and collect sensitive data for exfiltration from infected computers. The newly\ndiscovered backdoors were used in conjunction with the previously reported Spark backdoor previously\nattributed to Molerats.\n\n#### • Targeting Across the Middle East: Cybereason assesses that the campaign operators seek to target high\n\nranking political figures and government officials in the Middle East, including the Palestinian Territories,\nUAE, Egypt and Turkey.\n\n#### • Political Phishing Themes: Themes used to lure the victims included the Israeli-Saudi relations, Hamas\n\nelections, Palestinian politiicians as well as other recent political events including recent meeting between\n[His Royal Highness Mohammed bin Salman, Crown Prince of Saudi Arabia (MBS), the U.S. Secretary of State](https://en.wikipedia.org/wiki/Mohammed_bin_Salman)\n**[Mike Pompeo and Israeli PM Benjamin Netanyahu.](https://en.wikipedia.org/wiki/Mike_Pompeo)**\n\n#### • Abuse of Facebook, Google Docs, Dropbox and Simplenote Platforms: The newly discovered\n\nDropBook backdoor used fake Facebook accounts or Simplenote for command and control (C2) operations,\nand both SharpStage and DropBook implement a Dropbox client in order to exfiltrate the data stolen from\ntheir targets to a cloud storage, as well as for storing their espionage tools.\n\n#### • Connection to the Pierogi Backdoor: Analysis shows a correlation between the newly discovered\n\nbackdoors, Spark and the previously reported Pierogi backdoor. Cybereason estimates with moderate-tohigh confidence that they were developed by different teams operating on behalf of similar interests or by\nthe same threat actor.\n\n#### • Using Quasar RAT: The attackers used new espionage tools to download additional payloads from DropBox\n\n[including the infamous open-source Quasar RAT that was used before by the Gaza Cybergang.](https://securelist.com/gaza-cybergang-updated-2017-activity/82765/)\n\n\n-----\n\n## The Discovery of Molerats’\n New Cyber Arsenal\n\nWhile hunting for Middle Eastern threats, Cybereason’s Nocturnus team stumbled upon couple of unique malware\nsamples analysis proved to be previously undocumented. These two backdoors, dubbed SharpStage, DropBook,\nand the MoleNet downloader share multiple campaign similarities in TTPs and phishing themes, and were also\ndelivered in conjunction with the Spark backdoor previously attributed to the Gaza Cybergang, aka Molerats.\n\n[Molerats are known to lure their victims using political and Middle Eastern themed phishing files, and this](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one)\ntime they stuck to their way, using recent political events that took place including the peace agreement or\n\nnormalization process between Israel and neighboring Arab countries.\n\n\n-----\n\n[One of the phishing documents observed in the campaign is a PDF file titled “MBS-Israel”, referencing the recent](https://www.aljazeera.com/news/2020/11/23/netanyahu-met-with-mbs-pompeo-in-saudi-arabia-israeli-sources)\n**[talks between Israeli Prime Minister Benjamin Netanyahu and His Royal Highness Mohammed bin Salman, Saudi](https://www.aljazeera.com/news/2020/11/23/netanyahu-met-with-mbs-pompeo-in-saudi-arabia-israeli-sources)**\nCrown Prince:\n\n**FIGURE 3**\nZero detection rate for the phishing PDF file, according to VirusTotal\n\n**FIGURE 4**\nContent of the MBS-Israel.pdf document\n\nThe PDF content instructs the targets to download password-protected archives presumably containing the\nminutes of different meetings from either Dropbox or Google Drive:\n\n**TABLE 1**\n\n|TABLE 1|Col2|\n|---|---|\n|EMBEDDED URL|Archive Type and SHA-256 Hash|\n|https://www.dropbox[.]com/s/r81t6y7yr8w2ymc/ MOM.zip?dl=1|Zip Archive 58f926d9bd70c144f8697905bf81dfff046a12929639dfba3a6bd30a26367823|\n|https://drive.google[.]com/ uc?export=download&id=1NnMlUPwkxK4_ wAJwrqxqBAfdKCPDxyeh|RAR Archive d7675b5c1a47b876b505bf6fd8dc9ea3b35520c13408450df8807a1a5c24da68|\n\n\n-----\n\n**FIGURE 5**\nPayloads downloaded using the PDF\n\n\nTwo of the new files are SharpStage and DropBook:\n\n**TABLE 2**\n\n**FILE NAME** **CLASSIFICATION** **SHA-256**\n\nDetails Crown Prince held SharpStage Backdoor 69af17199ede144d1c743146d4a7b7709b765e­\n'secret meeting' with Israeli 57375d4a4200ea742dabef75ef\nPM.Nov.23.20.MoM.exe\n\nDetails of MBS meeting with Spark Backdoor 54eadcd0b93f0708c8621d2d8d1fb­\nthe US Secretary of State. 4016f617680b3b0496343a9b3fed429aaf9\nNov.23.20.MoM.exe\n\nTalking points for meeting.exe DropBook Backdoor 2578cbf4980569b372e06cf414c3da9e29226d­\nf4612e2fc6c56793f77f8429d8\n\nIt is interesting to note the consistent variations of fake Microsoft Word icons used by the Gaza Cybergang, across\ndifferent malware:\n\n**TABLE 3**\n\n**SharpStage** **DropBook** **Pierogi** **Spark**\n\nAt the time of writing the blog, the newly discovered SharpStage backdoor has a very low detection rate,\naccording to VirusTotal:\n\n|TABLE 2|Col2|Col3|\n|---|---|---|\n|FILE NAME|CLASSIFICATION|SHA-256|\n|Details Crown Prince held 'secret meeting' with Israeli PM.Nov.23.20.MoM.exe|SharpStage Backdoor|69af17199ede144d1c743146d4a7b7709b765e­ 57375d4a4200ea742dabef75ef|\n|Details of MBS meeting with the US Secretary of State. Nov.23.20.MoM.exe|Spark Backdoor|54eadcd0b93f0708c8621d2d8d1fb­ 4016f617680b3b0496343a9b3fed429aaf9|\n|Talking points for meeting.exe|DropBook Backdoor|2578cbf4980569b372e06cf414c3da9e29226d­ f4612e2fc6c56793f77f8429d8|\n\n|TABLE 3|Col2|Col3|Col4|\n|---|---|---|---|\n|SharpStage|DropBook|Pierogi|Spark|\n|||||\n\n\n-----\n\nThe Cybereason Nocturnus team has also observed different Middle-Eastern themed URLs used in the SharpStage’s\nC2 domains:\n\n#### • http://artlifelondon[.]com/hamas_internal_elections.rar\n\n • https://www.artlifelondon[.]com/Hamas.php\n\n • https://forextradingtipsblog[.]com/SaudiRecognitionofIsrael.php\n\n • https://forextradingtipsblog[.]com/AhmedMajdalani.php\n\n##### Analysis of the SharpStage Backdoor\n\nThe SharpStage backdoor is a .NET malware with backdoor capabilities. Its name is a derivative of the main\n\nactivity class called “Stage_One”. The Cybereason Nocturnus team was able to identify three variants of the\nSharpStage backdoor that are under continuous development, with two of them sharing a hardcoded mutex\n_71C19A8DC5F144E5AA9B8E896AE0BFD7:_\n\n\n**FIGURE 7**\nSharpStage mutex as seen in its code\n\n\nThe compilation timestamps of these samples vary between October 4th and November 29th, 2020. All three\ncontain similar functionalities with some variation to several functions as well as an emphasis on code obfuscation,\ncode modularity, logging and connectivity checking as a dependency for further execution. In addition, each has its\nown persistence component.\n\nThe SharpStage backdoor has the following capabilities, some of which depend on the commands received from the\nC2:\n\n#### • Screen capture: The SharpStage backdoor has the ability to capture the victim’s screen.\n\n • Targets Arabic-speaking users: SharpStage checks for the presence of the Arabic language on the infected\n\nmachine, thus avoiding execution on non-relevant devices, and is capable of avoiding most sandboxes.\n\n#### • Dropbox client: A Dropbox client API is implemented in SharpStage and is used to communicate with Dropbox\n\nusing a token to download and exfiltrate data.\n\n#### • Powershell, command line and WMI execution: When receiving a command from the C2, SharpStage has\n\nthe ability to execute arbitrary commands.\n\n#### • Download and execute additional files: The malware has the ability to download and execute additional\n\npayloads.\n\n#### • Unrar an archive: In addition to downloading, SharpStage can also unarchive data downloaded from the C2\n\nthat contains a SharpStage payload along with a persistence module.\n\n\n-----\n\nAs depicted below, Cybereason detects the infection chain of SharpStage. In this variant, the persistence\ncomponent is “shearS.exe” which writes a scheduled task for the downloaded “shear” sample which is the\nSharpStage payload. In general, it can be seen that the SharpStage persistence component shares the “S”\nappendix regardless of SharpStage main module’s name:\n\n**FIGURE 8**\nAttack Tree of SharpStage, as shown in the Cybereason Defence Platform\n\n**SharpStage Dropper (Early Version)**\n\nThe first variant comes packed in a dropper that stages the backdoor and creates persistence. The dropper\nwrites the payload (SharpStage backdoor) both to the temp and startup folders:\n\n\n**FIGURE 9**\nRetrieving the startup and temp folders from the system\n\n\nThe copying and execution of the malware is done by creating an instance of Windows Explorer:\n\n\n**FIGURE 10**\nCreating a Windows Explorer process\n\n\n-----\n\nIn addition, the dropper has the ability to create persistence for the malware dropped in %temp% using the\nregistry autorun key:\n\n\n**FIGURE 11**\nCreating persistence through the registry\n\n\n**Secondary Persistence Implant (Later Versions)**\n\nAs seen in the Cybereason process tree, a newer and more modular variant of SharpStage named “shear” is\ndownloaded from the C2 together with a smaller file called “shearS”. The latter creates persistence for the first\n\nand also includes some machine profiling capabilities. The machine profiling is being done using WMI query, and\ndata such as the system manufacturer and model are collected:\n\n\n**FIGURE 12**\nSystem info collections by the persistence component\n\n\nWhen creating persistence, schtasks are used to create a new scheduled task for “shear”. The reference to “shear”\nbelow is done simply by removing the “S” at the end of “shearS”:\n\n\n**FIGURE 13**\nRun scheduled task method in the persistence component\n\n\n-----\n\n**SharpStage Core Functionality**\n\nThe dropper downloaded from the SharpStage C2 has several backdoor capabilities including implementation of a\nDropbox client API along with a check for the presence of the Arabic language in order to execute only on desired\ntargets and to evade sandbox detection, as the default language setting is usually English.\n\nPrior to the language check, the backdoor automatically captures the screen and saves the image in the %temp%\nfolder:\n\n\n**FIGURE 14**\nCapturing the victim’s screen\n\n\nAs mentioned above, the malware does a check to detect the presence of an Arabic keyboard. If such a keyboard\nlayout was found, the “startLoop” flag is set to “true” and the execution proceeds to the main activity of connecting\nto the C2 and getting further instructions:\n\n**FIGURE 15**\nChecking for an Arabic keyboard and updating the corresponding flag\n\nWhen examining the “GetUpload” method, the backdoor capabilities of the malware are revealed. After the C2 is\ncontacted, SharpStage starts parsing commands:\n\n\n**FIGURE 16**\nContacting the C2 and initiating command related variables\n\n\n-----\n\nAs depicted in the image below, the malware parses commands from the C2 related to command line, Powershell\nand WMI execution and then initiates the relevant variable. In addition, it initiates a Dropbox client in order to\ndownload another file - in this case, it is initiated with the “AcessTo” variable which is a token previously got from\nthe C2:\n\n\n**FIGURE 17**\nParsing commands from the C2 and initiating the Dropbox client\n\n\nThe attacker’s Dropbox account is used to download additional files, and the downloads can also be completed\nusing a web address and a secure connection:\n\n\n**FIGURE 18**\nDownload of additional files\n\n\n-----\n\nThe code below implements a switch-case for command execution and, depending on the command received,\nuses command line, Powershell or WMI:\n\n\n**FIGURE 19**\nCommand line parsing\n\n\nThe later variant of SharpStage also drops a decoy document upon execution:\n\n\n-----\n\n[The decoy document contains information allegedly created by the media department of the Popular Front for](https://en.wikipedia.org/wiki/Popular_Front_for_the_Liberation_of_Palestine)\n**[the Liberation of Palestine (PLFP) describing preparations for the commemoration of the PLFP’s 53rd anniversary:](https://en.wikipedia.org/wiki/Popular_Front_for_the_Liberation_of_Palestine)**\n\n**FIGURE 21**\nSharpStage decoy document\n\nAccording to the document’s metadata, the author of the document is an individual named “ABU-GHASSAN”. In\n[the context of the PFLP, this name could be a reference to Ahmad Sa’adat, who is the PFLP’s Secretary General](https://en.wikipedia.org/wiki/Ahmad_Sa%27adat)\nand is known as ABU-GHASSAN. Cybereason can not determine the authenticity of the document, and as such, it\nis unclear whether it is a stolen authentic document or perhaps a document forged by the attackers and made to\nappear as if it originated from the Front’s high-rank official:\n\n\n-----\n\n##### Analysis of the DropBook Backdoor\n\n**FIGURE 23**\nAttack Tree of DropBook, as shown in the Cybereason Defence Platform\n\n[.One of the malware delivered in the phishing attacks is a Python-based backdoor compiled with PyInstaller](https://www.pyinstaller.org/)\ndubbed “DropBook”. Based on the TTPs and code similarities, Cybereason suspects that DropBook was\n[authored by the same team that developed JhoneRAT, another Python-based malware observed in targeted](https://blog.talosintelligence.com/2020/01/jhonerat.html)\n[attacks in the Middle East which was also reported to have been connected to the Spark backdoor.](https://unit42.paloaltonetworks.com/molerats-delivers-spark-backdoor/)\n\nThe DropBook backdoor has the following capabilities:\n\n#### • Reconnaissance: Collection of installed programs and file names\n\n • Shell commands: Execution of shell commands received from Facebook/Simplenote \n\n • Downloading and executing additional files: DropBook has the ability to to download and execute\n\nadditional payloads using DropBox\n\n#### • Targets arabic speaking users: DropBook checks for the presence of an Arabic language on the infected\n\nmachine, thus avoiding its execution on non-relevant potential victims:\n\n\n-----\n\nDropBook only executes if WinRAR is installed on the infected computer, probably because it is needed for a later\n\nstage of the attack. In addition, the backdoor checks the keyboard language, and only runs if the Arabic language is\n[configured, a method that is used by Molerats quite often.](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one)\n\nIn an attempt to evade network-based detection, DropBook communicates with its operators via legitimate websites\nand services, including Dropbox, Facebook and Simplenote (a service used for keeping notes). By doing so, the\n\nbackdoor’s web traffic appears legitimate and is not likely to raise much suspicion. DropBook is using Dropbox for file\ndownloads and uploads and Facebook/Simplenote posts to deliver C2 commands from the attacker.\n\nDropBook’s flow of execution is as follows:\n\n1. **Fetching Dropbox API token: DropBook fetches a Dropbox token from a Facebook post on a fake Facebook**\n\naccount. The backdoor’s operators are able to edit the post in order to change the token used by the backdoor.\nIn case DropBook fails getting the token from Facebook, it tries to get the token from Simplenote:\n\n**FIGURE 25**\nDropbox token in Facebook\n\n2. **Reconnaissance activity: After receiving the token, the backdoor collets the names of all files and folders in the**\n\n“Program Files” directories and in the desktop, writes the list to a file in ”’C:\\Users\\%username%\\info.txt”, and\nthen uploads the file to Dropbox under the name of the current username logged on to the machine.\n\n3. **Fetching commands from Facebook: DropBook then checks the fake facebook account post, this time in order**\n\nto receive commands to execute on the infected machine. The attackers are able to edit the post in order to\nprovide new instructions and commands to the backdoor, such as:\n\n#### • Executing arbitrary shell commands, either on all victims or a specific one\n\n • Setting the name of the payload that may be downloaded at a later stage\n\n • Setting the sleep time between queries for new commands\n\n\n-----\n\ny g p\n\n**TABLE 4**\n\n**COMMAND** **PURPOSE**\n\nall::tasklist Execute “tasklist” on all infected machines\n\nall::dir Execute “dir” on all infected machines\n\nall::set::soundplyer.exe Set the name of the next file to download to “soundplyer.exe”\n\nall::re::30 Set the sleep time to 30 seconds\n\nall::set::Kd.exe Set the name of the next file to download to “Kd.exe”\n\nall::schtasks Execute “schtasks” on all infected machines\n\nall::set::Firefox.exe Set the name of the next file to download to “Firefox.exe”\n\nall:: %comspec% %userprofile%\\Firefox.exe Probably an attempt to execute “Firefox.exe”\n\nall:: %userprofile%\\Firefox.exe Probably an attempt to execute “Firefox.exe”\n\nall::schtasks /create /sc minute /mo 1 /tn Create a scheduled task for “Firefox.exe”\n\n\"Firefox\" /F /tr \"\\\"%userprofile%\\Firefox.exe\\\"\"\n\nall::schtasks /create /sc minute /mo 1 /tn Create a scheduled task for “soundplyer.exe”\n\"soundplyer\" /F /tr \"\\\"%userprofile%\\soundplyer.\nexe\\\"\"\n\nall::set::PView.exe Set the name of the next file to download to “PView.exe”\n\nall::dir %userprofile% Execute “dir” on %userprofile%\n\nall::schtasks /create /sc minute /mo 1 /tn Create a scheduled task for “PView.exe”\n\"PView\" /F /tr \"\\\"%userprofile%\\PView.exe\\\"\"\n\nall::set::DG3.exe Set the name of the next file to download to “DG3.exe”\n\nBy using Facebook’s “post edit history” feature, it is possible to view all the commands that were posted by\nbackdoor’s operators:\n\n**FIGURE 26**\nShell commands used by the attackers as revealed by\nFacebook’s post edit history feature\n\n|TABLE 4|Col2|\n|---|---|\n|COMMAND|PURPOSE|\n|all::tasklist|Execute “tasklist” on all infected machines|\n|all::dir|Execute “dir” on all infected machines|\n|all::set::soundplyer.exe|Set the name of the next file to download to “soundplyer.exe”|\n|all::re::30|Set the sleep time to 30 seconds|\n|all::set::Kd.exe|Set the name of the next file to download to “Kd.exe”|\n|all::schtasks|Execute “schtasks” on all infected machines|\n|all::set::Firefox.exe|Set the name of the next file to download to “Firefox.exe”|\n|all:: %comspec% %userprofile%\\Firefox.exe|Probably an attempt to execute “Firefox.exe”|\n|all:: %userprofile%\\Firefox.exe|Probably an attempt to execute “Firefox.exe”|\n|all::schtasks /create /sc minute /mo 1 /tn \"Firefox\" /F /tr \"\\\"%userprofile%\\Firefox.exe\\\"\"|Create a scheduled task for “Firefox.exe”|\n|all::schtasks /create /sc minute /mo 1 /tn \"soundplyer\" /F /tr \"\\\"%userprofile%\\soundplyer. exe\\\"\"|Create a scheduled task for “soundplyer.exe”|\n|all::set::PView.exe|Set the name of the next file to download to “PView.exe”|\n|all::dir %userprofile%|Execute “dir” on %userprofile%|\n|all::schtasks /create /sc minute /mo 1 /tn \"PView\" /F /tr \"\\\"%userprofile%\\PView.exe\\\"\"|Create a scheduled task for “PView.exe”|\n|all::set::DG3.exe|Set the name of the next file to download to “DG3.exe”|\n\n\n-----\n\n4. **Downloading additional payloads: DropBook can download and execute an extended arsenal of payloads**\n\n[stored on Dropbox, such as: MoleNet Downloader, Quasar RAT, SharpStage Backdoor, an updated version](https://malpedia.caad.fkie.fraunhofer.de/details/win.quasar_rat)\nof DropBook, and Process **[Explorer, a legitimate tool by Microsoft to monitor Windows processes, often](https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer)**\nused by attackers for reconnaissance and to dump credentials.\n\nAside from posting commands, the fake Facebook profile is empty, showing no connections or any personal\ninformation about its user, which further strengthens the assumption that it was created solely for serving as a\ncommand-and-control for the backdoor:\n\n**FIGURE 27**\nFake Facebook profile used as DropBook’s C2\n\n##### Analysis of the MoleNet Downloader\n\nPerhaps one of the most intriguing tools discovered in this campaign is the MoleNet downloader. Even though\nthe tool itself is previously undocumented, the Nocturnus Team found evidence that it has been in active\ndevelopment since at least 2019 with infrastructure operating as far back as 2017 while remaining under the\nradar.\n\nThe MoleNet downloader is just one of the tools in Molerats’ arsenal, and was discovered in this campaign being\ndelivered by the DropBook backdoor along with the SharpStage and Spark backdoors. It is also written in .NET,\nand heavily obfuscated.\n\nThe MoleNet downloader has the following capabilities:\n\n#### • Perform WMI commands for OS profiling, including the following:\n\n • SELECT * FROM FirewallProduct\n • SELECT * FROM AntivirusProduct\n • SELECT * FROM Win32_PhysicalMedia\n • SELECT * FROM Win32_ComputerSystem\n • SELECT * FROM Win32_DiskDrive\n • SELECT * FROM Win32_LogicalDiskToPartition\n\n\n-----\n\n#### • Check for debuggers: MoleNet performs several checks in order to see if it is being debugged, like querying\n\nAPIs such as IsDebuggerPresent and CheckRemoteDebuggerPresent.\n\n#### • Restart the machine using command line: MoleNet restarts the infected machine by running the shutdown\n\ncommand-line utility:\n\n**FIGURE 28**\nRestarting the victim’s machine using the command line\n\n#### • Submit extensive OS information to the C2: below is an example of parameters that are sent to the C2:\n\n_name={0}&subject={1}&OS={2}&category={3}&priority={4}&message={5}&FileLocation={6}&_\n_email={7}&MyVer={8}&XMLDoc={9}&PCTypeOne={10}_\n\n#### • Downloading additional payloads: MoleNet can download additional payloads from the C2.\n\n • Creating Persistence: MoleNet uses Powershell in order to achieve persistence on the infected machine by\n\nexecuting the command powershell reg add “HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run” /f /v Firefox /t\n_reg_sz /_\n\nThe newer version of MoleNet appears to use the following URLs to communicate with its operators:\n\n#### • hxxps://exchangeupdates[.]com/enterprise/Wenterprise.php\n • hxxps://exchangeupdates[.]com/enterprise/Senterprise.php\n\n\n**Unveiling Old MoleNet Versions**\n\n[By tracking the tools indicative of TTPs and strings, Cybereason was able to uncover an earlier sample dating back](https://app.any.run/tasks/35d4c349-bb67-4d72-a544-4ab1f5953cea/)\nto July 2020, that communicates with the same domain exchangeupdates[.]com.\n\n[Further pivoting on more indicators revealed an even earlier sample dating back to 2019. The sample](https://www.hybrid-analysis.com/sample/3c0a1d657448b90997fd303ce6ac4cf8148faaa45a735a5afc1eea83f3f16fd0?environmentId=120)\n[communicated with a different domain: upgrade.newshelpyou[.]com - this domain was mentioned in a report by](https://securelist.com/gaza-cybergang-updated-2017-activity/82765/)\n**[Kaspersky in 2017, detailing various campaigns on the Gaza Cybergang. The report however, did not include](https://securelist.com/gaza-cybergang-updated-2017-activity/82765/)**\ninformation about the MoleNet downloader.\n\n\n-----\n\n##### Spark Backdoor Activity in Turkey\n\n[Cybereason also observed recent activity of the Spark backdoor targeting Turkish-speaking individuals. It is](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one)\nunclear whether the Turkish campaign is connected to the aforementioned campaign, but both campaigns use the\nSpark backdoor attributed to MoleRats. It is interesting to mention the targeting of Turkish-speaking individuals,\nsince the Spark backdoor is known to specifically check for Arabic language settings on the infected machines.\n\nOne of the Spark backdoor droppers observed in the Turkish campaign is named: “YENİ İNŞAAT İÇİN GEREKLİ\nBELGELER.exe” (translated: DOCUMENTS REQUIRED FOR NEW CONSTRUCTION). Once the malware executes, it\nopens a decoy file in Turkish to distract the victims from the malicious activity:\n\n**File name: YENİ İNŞAAT İÇİN GEREKLİ BELGELER.exe**\n**SHA-256: 5b0693731f100b960720d67bda6f3e6df1c25b7d5024d11cf61c13e7492f18cf**\n**Decoy document SHA-256: dc9aa462547e1436c7254a78c907915d41f771a3a66d2f4656930724cbf3914d**\n\n**FIGURE 29**\nDecoy document in Turkish, dropped along with Spark backdoor\n\nThe Turkish campaign appears to have a distinct C2 domain: brooksprofessional[.]com\n\n\n-----\n\n## Connection to the Pierogi Backdoor\n\n[An interesting connection between the newly discovered malware arsenal described above and the Pierogi](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-2-the-discovery-of-the-new-mysterious-pierogi-backdoor)\n**[backdoor that was previously discovered by Cybereason was also observed during this investigation: it](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-2-the-discovery-of-the-new-mysterious-pierogi-backdoor)**\nappears that some of the victims of the newly discovered backdoors were also targeted by a new variant of\n[the Pierogi backdoor and attributed to APT-C-23, an adjacent sub-group of the Gaza Cybergang linked to](https://github.com/Gcow-Sec/GcowPublic/blob/master/APT-C-23_report.pdf)\nMolerats.\n\nAnalysis of Pierogi’s delivery methods and phishing themes, show a great deal of similarity to the campaigns\nmentioned in this report as well as past campaigns attributed to Molerats and APT-C-23.\n\nFor example, the use of executables with fake Microsoft Word icons was observed on multiple instances with\n\nthe Pierogi backdoor dropper. In addition, there are similarities in the phishing and decoy content sent to the\nvictims:\n\n**FIGURE 30**\nLow Antivirus detection rate for Pierogi backdoor dropper on VirusTotal\n\n**File name: general secretariat for the council of ministers 1839-2021.exe**\n\n**SHA-256: 2d03ff4e5d4d72afffd9bde9225fe03d6dc941982d6f3a0bbd14076a6c890247**\n\n**FIGURE 31**\nPierogi dropper file uploaded from the Palesitnian Territories\n\n**Drops decoy PDF SHA-256:**\n\nb1ac14df66e1b10b3c744431add3d99a7eb39714b61253fb22dd3a00cba61e05\n\n\n-----\n\n**FIGURE 32**\nContent of the decoy document dropped by Pierogi\n\n\nAnother example of a decoy document is the following file, dropped along with the Pierogi backdoor by:\n\n**File name: appreved structural-85763489756-5629857-docx.exe (originally with typo)**\n\n**SHA-256: b61fa79c6e8bfcb96f6e2ed4057f5a835a299e9e13e4c6893c3c3309e31cad44**\n\n\n-----\n\n[While the new Pierogi variant appears to keep most of the previously reported functionality, Cybereason](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-2-the-discovery-of-the-new-mysterious-pierogi-backdoor)\ndetected a few changes and improvements to the code, including code obfuscation, base64 encoded C2\n[communication, and more. In addition, the distinct URI pattern, previously reported has changed, and no](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-2-the-discovery-of-the-new-mysterious-pierogi-backdoor)\nlonger contains words in the Ukrainian language:\n\n**Observed URI pattern in the new Pierogi variant:**\n\n#### • hxxp://ruthgreenrtg[.]live/xqgjdxa/yhhzireha/ibcdgpuw\n • hxxp://ruthgreenrtg[.]live/xqgjdxa/yhhzireha/zbkvngmnc\n • hxxp://ruthgreenrtg[.]live/xqgjdxa/yhhzireha/hknbuahwg\n • hxxp://ruthgreenrtg[.]live/xqgjdxa/yhhzireha/tcpuvvfi\n\n**TABLE 5**\n\n**OLD URI PATTERN** **PURPOSE**\n**(UKRANIAN LANGUAGE COMMANDS)**\n\ndebby/weatherford/Yortysnr Machine information\n\ndebby/weatherford/Ekspertyza Request further commands from the C2\n\ndebby/weatherford/Zavantazhyty Uploading data (mainly screenshots)\n\ndebby/weatherford/Vydalyty Removing information\n\nSee full list of Pierogi IOCs included in the IOCs document linked below.\n\n|OLD URI PATTERN (UKRANIAN LANGUAGE COMMANDS)|PURPOSE|\n|---|---|\n|debby/weatherford/Yortysnr|Machine information|\n|debby/weatherford/Ekspertyza|Request further commands from the C2|\n|debby/weatherford/Zavantazhyty|Uploading data (mainly screenshots)|\n|debby/weatherford/Vydalyty|Removing information|\n\n\n-----\n\n## Conclusion\n\nIn this report, the Cybereason Nocturnus Team investigated an active espionage campaign that largely targets Arabspeaking individuals in the Middle East, primarily observed in the Palestinian Territories, UAE, Egypt and Turkey.\n[Based on our previous research, as well as research by other companies, Cybereason estimates with moderate-high](https://www.cybereason.com/blog/new-cyber-espionage-campaigns-targeting-palestinians-part-one)\n[confidence that these attacks were carried out by Molerats (aka The Gaza Cybergang), an Arabic-speaking, politically](https://attack.mitre.org/groups/G0021/)\nmotivated APT group that has operated in the Middle East since 2012.\n\nAnalysis of the phishing themes and decoy documents used in the social engineering stage of the attacks show that\nthey revolve mainly around Israel’s relations with neighboring Arab countries as well as internal Palesitinian current\naffairs and political controversies. Given the nature of the lure content, Cybereason assesses that the campaign\noperators seek to target high ranking political figures and government officials in the Middle East.\n\nThe investigation uncovered two previously unknown backdoors, dubbed “SharpStage”, “DropBook” and the “MoleNet”\n\ndownloader, which were delivered in conjunction with the previously discovered Spark backdoor. Both SharpStage and\nDropBook seem to exploit legitimate web services such as Dropbox and Google Drive to store their cyber arsenal and\n\nto deliver it to their victims in a stealthy manner, abusing the trust given to these platforms. In addition, the authors\nof the DropBook backdoor abuse Facebook by creating fake public profiles for delivering command and control (C2)\ninstructions to the malware while hiding in plain sight.\n\nFurthermore, Cybereason was able to show similarities between Molerats and APT-C-23, two adjacent sub-groups\nof the Gaza Cybergang, appearing to be operating on behalf of similar interests. The discovery of the new cyber\nespionage tools along with the connection to previously identified tools used by the group suggest that Molerats is\nincreasing their espionage activity in the region in light of the current political climate and recent events in the Middle\nEast.\n\n##### Mitre Att&ck Breakdown\n\n|INITIAL ACCESS|EXECUTION|PERSISTENCE|PRIVELEGE ESCALATION|DEFENSE EVASION|DISCOVERY|COLLECTION|EXFILTRATION|C&C|IMPACT|vi e|\n|---|---|---|---|---|---|---|---|---|---|---|\n|Spearphishing Attachment|Command- Line Interface|Scheduled Task|Bypass User Account Control|Bypass User Account Control|System Information Discovery|Screen Capture|Archive Collected Data|Web Service|System Shutdown / Reboot||\n|Spearphishing Link|Scheduled Task|Registry Run Keys / Startup Folder|Startup Items|Deobfuscate/ Decode Files or Information|System Owner/ User Discovery|Automated Collection||Data Encoding|||\n||Scripting|Shortcut Modification||Disable or Modify Tools|Virtualization/ Sandbox Discovery|||Remote File Copy|||\n||User Execution|||File Deletion||||Encrypted Channel|||\n||Powershell|||Software Packing|||||||\n|||||Masquerading|||Down|load the full|set of IOCs||\n|||||Evade Analysis Environment|||the li|nk at the top|of the||\n|||||Security Software Discovery|||Mole|rats report b|log post her||\n||||||||||||\n\n\nDownload the full set of IOCs via\nthe link at the top of the\n[Molerats report blog post here.](https://www.cybereason.com/blog/new-malware-arsenal-abusing-cloud-platforms-in-middle-east-espionage-campaign)\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.cybereason.com/hubfs/dam/collateral/reports/Molerats-in-the-Cloud-New-Malware-Arsenal-Abuses-Cloud-Platforms-in-Middle-East-Espionage-Campaign.pdf"
    ],
    "report_names": [
        "Molerats-in-the-Cloud-New-Malware-Arsenal-Abuses-Cloud-Platforms-in-Middle-East-Espionage-Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "1162e0d4-b69c-423d-a4da-f3080d1d2b0c",
            "created_at": "2023-01-06T13:46:38.508262Z",
            "updated_at": "2025-03-27T02:00:02.851407Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Gaza Hackers Team",
                "Gaza cybergang",
                "Gaza Cybergang",
                "Operation Molerats",
                "Extreme Jackal",
                "ALUMINUM SARATOGA",
                "G0021",
                "BLACKSTEM"
            ],
            "source_name": "MISPGALAXY:Molerats",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0c502f6d-640d-4e69-bfb8-328ba6540d4f",
            "created_at": "2022-10-25T15:50:23.756782Z",
            "updated_at": "2025-03-27T02:00:55.539397Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "Molerats",
                "Operation Molerats",
                "Gaza Cybergang"
            ],
            "source_name": "MITRE:Molerats",
            "tools": [
                "MoleNet",
                "DustySky",
                "DropBook",
                "SharpStage",
                "PoisonIvy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9ff60d4d-153b-4ed5-a2f7-18a21d2fa05d",
            "created_at": "2022-10-25T16:07:23.539852Z",
            "updated_at": "2025-03-27T02:02:09.853285Z",
            "deleted_at": null,
            "main_name": "Desert Falcons",
            "aliases": [
                "APT-C-23",
                "ATK 66",
                "Arid Viper",
                "Operation Arid Viper",
                "Operation Bearded Barbie",
                "Operation Rebound",
                "TAG-63",
                "TAG-CT1",
                "Two-tailed Scorpion"
            ],
            "source_name": "ETDA:Desert Falcons",
            "tools": [
                "AridSpy",
                "Barb(ie) Downloader",
                "BarbWire",
                "Desert Scorpion",
                "FrozenCell",
                "GlanceLove",
                "GnatSpy",
                "KasperAgent",
                "Micropsia",
                "PyMICROPSIA",
                "SpyC23",
                "Viper RAT",
                "ViperRAT",
                "VolatileVenom",
                "WinkChat",
                "android.micropsia"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "847f600c-cf90-44c0-8b39-fb0d5adfcef4",
            "created_at": "2022-10-25T16:07:23.875541Z",
            "updated_at": "2025-03-27T02:02:10.005591Z",
            "deleted_at": null,
            "main_name": "Molerats",
            "aliases": [
                "ATK 89",
                "Aluminum Saratoga",
                "Extreme Jackal",
                "Gaza Cybergang",
                "Gaza Hackers Team",
                "Molerats",
                "Operation DustySky",
                "Operation DustySky Part 2",
                "Operation Molerats",
                "Operation Moonlight",
                "Operation SneakyPastes",
                "Operation TopHat",
                "TA402",
                "TAG-CT5"
            ],
            "source_name": "ETDA:Molerats",
            "tools": [
                "BadPatch",
                "Bladabindi",
                "BrittleBush",
                "Chymine",
                "CinaRAT",
                "Darkmoon",
                "Downeks",
                "DropBook",
                "DustySky",
                "ExtRat",
                "Gen:Trojan.Heur.PT",
                "H-Worm",
                "H-Worm RAT",
                "Houdini",
                "Houdini RAT",
                "Hworm",
                "Iniduoh",
                "IronWind",
                "Jenxcus",
                "JhoneRAT",
                "Jorik",
                "KasperAgent",
                "Kognito",
                "LastConn",
                "Micropsia",
                "MoleNet",
                "Molerat Loader",
                "NeD Worm",
                "NimbleMamba",
                "Njw0rm",
                "Pierogi",
                "Poison Ivy",
                "Quasar RAT",
                "QuasarRAT",
                "SPIVY",
                "Scote",
                "SharpSploit",
                "SharpStage",
                "WSHRAT",
                "WelcomeChat",
                "Xtreme RAT",
                "XtremeRAT",
                "Yggdrasil",
                "dinihou",
                "dunihi",
                "njRAT",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b1979c55-037a-415f-b0a3-cab7933f5cd4",
            "created_at": "2024-04-24T02:00:49.561432Z",
            "updated_at": "2025-03-27T02:00:55.493381Z",
            "deleted_at": null,
            "main_name": "APT-C-23",
            "aliases": [
                "APT-C-23",
                "Arid Viper",
                "Desert Falcon",
                "TAG-63",
                "Grey Karkadann",
                "Big Bang APT",
                "Two-tailed Scorpion"
            ],
            "source_name": "MITRE:APT-C-23",
            "tools": [
                "Micropsia"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "77c08a4a-b3f9-43ee-9d84-04ba572b7564",
            "created_at": "2024-05-01T02:03:07.927023Z",
            "updated_at": "2025-03-27T02:05:17.248836Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SHADYSIDE",
            "aliases": [
                "Arid Viper ",
                "Desert Falcon ",
                "APT-C-23 "
            ],
            "source_name": "Secureworks:ALUMINUM SHADYSIDE",
            "tools": [
                " SpyC23",
                "Micropsia"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "929d794b-0e1d-4d10-93a6-29408a527cc2",
            "created_at": "2023-01-06T13:46:38.70844Z",
            "updated_at": "2025-03-27T02:00:02.897573Z",
            "deleted_at": null,
            "main_name": "AridViper",
            "aliases": [
                "Arid Viper",
                "APT-C-23",
                "Bearded Barbie",
                "Desert Falcon"
            ],
            "source_name": "MISPGALAXY:AridViper",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041683,
    "ts_creation_date": 1607511074,
    "ts_modification_date": 1607511078,
    "files": {
        "pdf": "https://archive.orkl.eu/d75290d64647f01eda0a1c7495d65d45cc858f19.pdf",
        "text": "https://archive.orkl.eu/d75290d64647f01eda0a1c7495d65d45cc858f19.txt",
        "img": "https://archive.orkl.eu/d75290d64647f01eda0a1c7495d65d45cc858f19.jpg"
    }
}