{
    "id": "a101bb06-c6e5-4fb6-a202-1daf9244decb",
    "created_at": "2023-01-12T15:08:32.667402Z",
    "updated_at": "2025-03-27T02:06:10.319306Z",
    "deleted_at": null,
    "sha1_hash": "8b494ac48bbd51f0396e6ef97cdb16b584c3f2ea",
    "title": "2022-05-12 - New SYK Crypter Distributed Via Discord",
    "authors": "",
    "file_creation_date": "2022-06-13T04:00:50Z",
    "file_modification_date": "2022-06-13T04:00:50Z",
    "file_size": 2489139,
    "plain_text": "# New SYK Crypter Distributed Via Discord\n\n**blog.morphisec.com/syk-crypter-discord**\n\nPosted by [Hido Cohen on May 12, 2022](https://blog.morphisec.com/author/hido-cohen)\n\n[Tweet](https://twitter.com/share)\n\nWith [50% more users last year than in 2020, the number of people using the community chat](https://influencermarketinghub.com/discord-stats/#:~:text=Discord%20has%20150%20Million%20Monthly%20Users,-Discord%20has%20now&text=The%20most%20significant%20growth%20came,spend%20chatting%20on%20Discord%20servers.)\nplatform Discord is growing at a blistering pace. This has led cybercriminals to refine and\nexpand malicious attack use cases for the platform. In this threat research report, Morphisec\nreveals how threat actors are using Discord as part of an increasingly popular attack chain\nwith a new SYK crypter designed to outwit signature and behavior-based security controls.\n\nMorphisec’s Threat Labs team is on the cutting edge of threat research in this area. Our\n[researchers previously dissected other Discord-related threats like Babadeda and NFT-001.](https://blog.morphisec.com/nft-buyers-beware-journey-of-a-crypto-scammer-how-to-stop-them)\nWe can report that as Discord has expanded from a gaming messaging app to broader use,\nit’s being used to distribute a crypter we named SYK.\n\nThe attack chain preceding the SYK crypter deployment demonstrates a new evolution of\nhow threat actors abuse Discord's CDN (content delivery network). As a conduit for new,\nhighly innovative crypters, Discord plays an important role in a campaign that starts with\ntargeted phishing emails directed at organizations in various sectors.\n\nThe attack chain we saw comprises two main components; a .NET loader (which we refer to\nas DNetLoader) and a .NET crypter (SYK Crypter). This crypter delivers many malware\nfamilies, such as AsyncRAT, njRAT, QuasarRAT, WarzoneRAT, NanoCore RAT, and RedLine\n\n\n-----\n\nStealer, putting organizations in every sector and industry at risk.\n\n## Initial Infection\n\nTo lure new victims, attackers disguise the malware as a purchase order using file names\nsuch as Purchase Order.exe, New_Order_*.exe, AMAZON_ORDER*PDF.ex, etc. The\nfollowing example is delivered as a phishing email:\n\n_Phishing email containing the Discord malware_\n\nIf this deception works, the victim opens and executes the attachment and the infection\nbegins.\n\n\n-----\n\n## Technical Analysis\n\nBefore diving into the analysis, let’s look at the execution chain:\n\n_Malware execution flow_\n\nThis execution flow consists of two stages and a final payload. The first stage is the\ndownloader. It connects to a hard coded Discord CDN endpoint and downloads encrypted\ndata. The data, once decrypted, is the second stage—the crypter. This second stage loads\ninto the memory and is responsible for decrypting the final payload, which is stored as a PE\nresource. It includes antivirus evasion, persistence setup, and injection of the final payload to\na newly initiated process.\n\n## Discord CDN as Malware Distributor\n\n**Steps 1-2**\n\nIf you’re unfamiliar with the Discord CDN, it enables Discord users to create and contribute to\ntopic-based text channels. There, users share photos, videos, voice messages, and\nexecutable files, all of which are stored on Discord CDN servers—including malware\nmasquerading as legitimate files.\n\n\n-----\n\nThe URL format for a specific file is as follows:\n\n_hxxps://cdn.discordapp[.]com/attachments/{ChannelID}/{AttachmentID}/{filename}_\n\nIn this context, the DNetLoader is identified by the filename, a three digit number. Let’s look\ninside the code:\n\n_First stage malicious code_\n\nThe first stage is pretty straightforward. The malware downloads the next stage from Discord\nCDN where the file name is hardcoded and used as the decryption key. The decryption\nalgorithm is just a subtraction of the file name from each byte in the downloaded data.\n\n\n-----\n\nOnce decoded, the malware loads it into memory and creates an instance of the first\nexported type. Then the execution moves to the next stage. In other cases, the instance\nname is explicitly noted, usually with type name “B”.\n\n### DNetLoader In the Wild\n\nAt the time of this post’s writing, we observed the following malware distribution initiated by\nthe DNetLoader. Note that the SYK crypter is only one variant; additional crypters have been\ndelivered by the same loader.\n\n_Final payloads distributed by DNetLoader_\n\nBesides the RedLine infostealer, all malware families are RATs (remote access trojans), with\nAsync RAT the most common. We also extracted some of the C2 servers (this list is not\nexhaustive):\n\n**Payload** **C2**\n\njoseedward5001[.]ddns[.]net:1515\n\nAsync RAT\n\nbendito2714[.]duckdns[.]org:7090\n\n\n-----\n\nsgrmbroker[.]com:4404\n\ndedicatedlambo9[.]ddns[.]net:1515\n\nglengaidos2881[.]ddns[.]net:1515\n\npolarjwns[.]xyz:8808\n\nenero2022[.]con-ip[.]com:3028\n\nmijamajor[.]hopto[.]org:4872\n\nNanoCore RAT windapts[.]ddns[.]net:1608\n\nnjRAT diosamor27[.]duckdns[.]org:8899\n\nnipuelputas[.]myftp[.]org:1788\n\nQuasar RAT gu3rr4[.]duckdns[.]org:5965\n\nRedLine Stealer lunovim957[.]duckdns[.]org:42543\n\ncrossred9188[.]duckdns[.]org:29580\n\nasheesh[.]duckdns[.]org:5519\n\nhustlegang[.]duckdns[.]org:34261\n\nWarZone RAT dreams2reality[.]duckdns[.]org:2612\n\n185.19.85[.]163:9961\n\n185.140.53[.]174:2404\n\n_Mapping payload to C2_\n\n\n-----\n\nIn the next section we explain how the next stage, the SYK crypter, decrypts its component,\nhow to extract its configuration, and the AV evasion and persistence techniques in place.\n\n## The SYK Crypter\n\n**Steps 3-5**\n\nBefore diving deeper into the .NET crypter, note that we found that the same crypter was\ndelivered by loaders other than the DNetLoader. However, they all had a resource named\nSYKSBIKO in common—the encrypted payload. For this reason, we dubbed it the SYK\nCrypter.\n\nAs with other crypters, this crypter has a payload decryption method, control flow\nmanipulation, strings and constant obfuscation, AV detection, persistence, and antidebugging features. We examine each capability and explain how it’s implemented.\n\n### Configuration Extraction / Strings Obfuscation\n\nThe SYK crypter holds its configuration inside an obfuscated string represented as a byte\narray:\n\n_Encrypted byte array and access functions_\n\nThe crypter starts with a string de-obfuscation technique. Each string can be accessed and\nused by a predefined function which hardcodes its length and offset in a large byte array. The\nde-obfuscation algorithm is just XOR with 170 and the current index, so we can use the\nfollowing Python script:\n\nencrypted = [231, 216, 235, …]\n\nba_encrypted = bytearray(encrypted)\n\nba_decrypted = bytearray(encrypted)\n\nfor counter, i in enumerate(ba_encrypted):\n\nba decrypted[counter] = (i ^ counter ^ 170) & 0xff\n\n\n-----\n\nA similar method is used as part of an Agent Tesla [delivery campaign.](https://malgamy.github.io/malware-analysis/Deep-Analysis-Agent-Tesla/)\n\nAmong all setting strings inside the configuration, the important ones are the final payload\ndecryption key, list of AV solutions services and process names, and a small .NET delegator\n(base64 encoded).\n\n_Decrypted configuration_\n\nAs you can see above, several strings are still encrypted. The crypter uses subtraction\nencryption for those, with the keys also stored as part of the configuration.\n\n_String decryption algorithm_\n\n### Security Solutions Detection\n\nThe crypter checks for the existence of a set of security solutions using the following two\nmethods.\n\n\n-----\n\nBy calling GetProcessByName:\n\nBy checking if a path exists.\n\nThese actions happen many times throughout the execution, each time with different solution\nnames and/or file paths. The list of process names and paths are in the appendix at bottom.\nNote that if a security vendor is identified, the malware will abort the current functionality.\n\n### “Anti-Debugging”\n\nFor this task, the crypter implements a popular anti-debugging technique by inspecting the\nvalue inside Debugger.IsAttached:\n\n_Anti-debugging function_\n\n### Persistence\n\nOn its first run, the crypter copies itself to the Startup folder by executing a small javascript\nfile:\n\nvar FSO = WScript.CreateObject(\"Scripting.FileSystemObject\"); try { FSO.MoveFile(\"\n<execution_path>\\\\malware.exe\", \"%AppData%\\\\Microsoft\\\\Windows\\\\Start\nMenu\\\\Programs\\\\Startup\\\\malware.exe\");} catch(err) {}\n\nThis javascript file is executed from the %Temp% directory:\n\nNext, the following command is executed:\n\n\n-----\n\nAt this point the malware runs from the Startup folder again, so the current instance is killed:\n\nThe final payload injection starts if the malware execution path is the Startup folder.\n\n### Final Payload Injection\n\n**Payload Decryption and Deobfuscation**\n\nBefore moving forward, we need to understand where the final payload is located and how\nit’s decrypted. We can divide this process into four steps:\n\n1. Read the decryption key from the config—the first element\n2. Read resource bytes from SYKSBIKO.Properties.Resources.a\n3. Use the key to decrypt the resource’s bytes\n4. Deflate the result\n\nThe final payload decryption algorithm is a bit more complicated than the previous\nalgorithms.\n\nThe decryption starts from initializing a new 256 unsigned integer array with its index values.\n\n_Array initialization_\n\nNext, it uses the extracted decryption key to alter the values inside the initialized array:\n\n\n-----\n\n_Altering array values_\n\nOnce the alteration is completed, the array is ready to be used for payload decryption.\n\n\n-----\n\nAs part of the decryption, before XORing the values there is another swapping, as seen\nearlier. Then an index is calculated from the sum of the swapped values. The encrypted data\nis XORed with the value of the array inside the index.\n\nThe end result is a deflated compressed representation of the final payload. So all that’s left\nto do is decompress the result and get the final payload.\n\n### Process Hollowing Injection\n\nThe SYK crypter uses Process Hollowing as its preferred injection method. It creates a new\nprocess—RegAsm.exe or the named process according to the configuration—and injects the\ndecrypted final payload into it.\n\nIt's interesting how the WinAPI functions get loaded into memory. The SYK malware uses the\n.NET Delegator in its configuration to create a delegate for each function.\n\n\n-----\n\nHere, the malware loads the Base64 additional assembly, denoted by “s”, and calls its\nClassLibrary1.Class1.GetDelegateForFunctionPointer function. This delegates to the given\nfunction address. The library and function name are encrypted in the configuration.\n\nThe crypter will create delegation to all APIs in the same manner. For example, the following\nsnippet loads kernel32!GetThreadContext:\n\nWhere the strings are decrypted to: kernel32 and GetThreadContext.\n\n## Defending Against the SYK Crypter\n\nThis attack chain delivers a crypter that is persistent, features multiple layers of obfuscation,\nand uses polymorphism to maintain its ability to avoid detection by security solutions,\ndemonstrating a further escalation of the cybersecurity threat level. By combining a freely\navailable messaging app with a powerful crypter, threat actors have made it easier to\nconduct attacks that signature-based security solutions cannot stop.\n\nIn response, organizations urgently need to acknowledge an important fact. You can no\nlonger depend on malware having recognizable signatures or behaviors. To stop this\ncontinued threat evolution, it's vital to prevent threats by making attack surfaces inherently\ndynamic and hostile to intruders like the SYK crypter by implementing a zero trust\narchitecture (ZTA).\n\nEnabling a zero-trust environment for endpoints, including Microsoft and Linux servers,\nMorphisec’s Moving Target Defense (MTD) technology stops polymorphic threats like the\nSYK crypter. Instead of waiting to react to attacks that have already happened, MTD\nprevents advanced threats from getting a foothold in the first place. MTD morphs application\nmemory, shifting and shrinking the attack surface from threats like SYK, preventing payload\ndeployment.\n\n\n-----\n\nWant to learn more about how combining Moving Target Defense with zero trust works? To\nsee how Morphisec stops threats like the SYK crypter and other advanced attacks, read the\n[white paper: Zero Trust + Moving Target Defense: The Ultimate Ransomware Strategy.](https://engage.morphisec.com/the-ultimate-ransomware-strategy)\n\n## Appendix\n\n Security Solutions Strings\n\n### Process Names\n\nAVGUI\n\nBgScan\n\nBgWsc\n\nBullGuardBhvScanner\n\nWSRA\n\na2guard\n\navp\n\navpui\n\nbdagent\n\nbdredline\n\n\n-----\n\nbdservicehost\n\ndrweb\n\nekrn\n\nmasvc\n\nmbamtray\n\nmfecanary\n\nmfeesp\n\nmfehcs\n\nmfemactl\n\nnavapsvc\n\nodscanui\n\nuiSeAgnt\n\nvsserv\n\n### Paths\n\nC:\\Program Files\\McAfee\\Agent\n\nC:\\Program Files\\AVAST Software\\Avast\\avastUI.exe\n\nC:\\Program Files (x86)\\AVAST Software\\Avast\\avastUI.exe\n\nC:\\Program Files\\AVG\\Antivirus\\AVGUI.exe\n\nC:\\Program Files (x86)\\AVG\\Antivirus\\AVGUI.exe\n\nC:\\Program Files (x86)\\Webroot\\WRSA.exe\n\nC:\\Program Files\\Webroot\\WRSA.exe\n\nC:\\Program Files (x86)\\Trend Micro\n\nC:\\Program Files\\Kaspersky Lab\n\n## Indicators of Compromise\n\n\n-----\n\n## Attachments\n\n64f5839c38382c863ccba737bca9f9726fb395f52bfad3cfabfec0cde05fc47c\n\n11d750682595eef404ad43b2c1e9981dc35bdb180d82709f4d33811a88a8fbfe\n\nbbda6c0478c03c9845285bd399ff04e989106ab461fc773aecb3e03b607b370c\n\n77d7e7c68fdc652d5292d8b474763fb79ec99d2faa9b1d9f6f1c468d0d8f3d87\n\n## First Stage - Discord Downloader\n\n66eca7b1860d778cfce8e0ad6b66e09e12128cb149208122644c0622e0ba3910\n\n0db1d14dc510cf6310e63b3dba2f2168b35dde1066abfa279881b9752b45d49a\n\n2f2b971a4c04c399427f2c71b4fe7c0c945a9223d66b3325f42c9ade54cf6867\n\n4def53afd3cfa7cf644b61a877f18ceed798dc8f62268afb52827ee61280d3ac\n\n07c7268c2f8a736f5c74f9dabfdf5e10c8a4580fdfcf11eaa7e20a88dd52cae8\n\n2775f8771630ffad088473e525e9f7f5bbea7e3314569480eb9efb4767ad1dc6\n\n13d27cdf24f15d418b2197f6d017725bbd26ea1b8db7a61bdd648e90f1d269c5\n\nf9ca68d46bfdd5710abe9d01b9c6de61a0861581b0de9684c202b0c9aff11ccc\n\n769c5c1d9681b468b84a14af0c33ec4ee786f8c7a0eecf7819bd9286cab2d474\n\n561f65daae4410569d883adbb919fe4ea751540330738a3675afdddfe4acf764\n\n1611e88c7df03554eb83b7d5c22610ec8c6bec03c2d52bd451abbf0b9b53687e\n\n6484c71c7cfb6ae4914267ebc7e508665f1996a01c30f46d74494aa540f40eed\n\n43427de4b45f2aa2e6289d1a6d5e6859f4184e5cf638a4b6c185fafca6a85838\n\na72f7b3f503af99c1b930817fe7c14468cf932b924d849d48c84a2b740cd93dc\n\na56025263e68435d2602e821077174aae47ee2944f5719748e653f8f054149b4\n\nbce1723245d13050d1de61f9c8d4ebdf13442208f3baba2326c79d62c3709983\n\nc01c02c1534e41ca75c1ba1fb165252887ed6a5091e0047cf33169f902927503\n\nc04802a977e8d933c30def1dddaee61bbfd0625616960bf05352814b1a002679\n\nc6988c24086656560348185a4d8672463bc19b37c9ff6df4a04810a54127785e\n\n\n-----\n\nf77dbafd3d7b569f613cb5bb8797d010f5c00ab94de46cfde1a0d550c7167979\n\nfaa38595a083c174ccca2b3be0089dc049b429e9d94a77cc1ed862d395372f2e\n\nfac3c7ee9dda4b577571c7bdd28bb802227bdd36585378da354e6e104deb166c\n\nbc5198ebfbe1f184e4649a6c4c7cc14b990bd440dc8367654115d3b4ee178d06\n\n88a95249594b0466dec732c7fe79dcd49cef9b62f416d9d5dd2c18d2ee4b48c7\n\n008665f46f819b9e514f10522115482f0696b43b194af0766df3bd005502d71e\n\n0e4b58eda9ddb835af5e3f91ed71527c0cfae1284af66a7bff2d3c12d873ef79\n\n709dfdb42be61038697b83df71a329ab080f79e2f1d1bae9b4bc162d9af774b0\n\n## Download URLs\n\nhxxps://cdn[.]discordapp[.]com/attachments/874443728855658568/948367670900846643/885\n\nhxxps://cdn[.]discordapp[.]com/attachments/896158305087553560/924658841847726170/981\n\nhxxps://cdn[.]discordapp[.]com/attachments/933520960521400381/933521000300163143/867\n\nhxxps://cdn[.]discordapp[.]com/attachments/875759269977411698/945098629780226158/897\n\nhxxps://cdn[.]discordapp[.]com/attachments/874443728855658568/951729456752508948/910\n\nhxxps://cdn[.]discordapp[.]com/attachments/874443728855658568/946300452096598067/536\n\nhxxps://cdn[.]discordapp[.]com/attachments/874443728855658568/959254345982029855/817\n\nhxxps://cdn[.]discordapp[.]com/attachments/854820268773736493/946915889863860316/778\n\nhxxps://cdn[.]discordapp[.]com/attachments/866351974466977835/950118342172221470/556\n\nhxxps://cdn[.]discordapp[.]com/attachments/900653930571235341/905956542162022420/660\n\nhxxps://cdn[.]discordapp[.]com/attachments/854820268773736493/895128481858474004/804\n\nhxxps://cdn[.]discordapp[.]com/attachments/908007876960854056/928649032665014282/990\n\nhxxps://cdn[.]discordapp[.]com/attachments/873602495736328236/917391419595956234/630\n\nhxxps://cdn[.]discordapp[.]com/attachments/897091209665859596/941748938925563944/982\n\nhxxps://cdn[.]discordapp[.]com/attachments/670204968430600202/886743722224660510/850\n\nhxxps://cdn[ ]discordapp[ ]com/attachments/955620719667068951/960684830159405056/843\n\n\n-----\n\nhxxps://cdn[.]discordapp[.]com/attachments/899050420717101059/941477948916138054/632\n\nhxxps://cdn[.]discordapp[.]com/attachments/955620719667068951/956310954029748254/541\n\nhxxps://cdn[.]discordapp[.]com/attachments/874443728855658568/963787231233990706/753\n\nhxxps://cdn[.]discordapp[.]com/attachments/937717676883714128/937717993683705886/616\n\nhxxps://cdn[.]discordapp[.]com/attachments/854820268773736493/921074463716544534/722\n\nhxxps://cdn[.]discordapp[.]com/attachments/899050420717101059/917505272975597598/954\n\nhxxps://cdn[.]discordapp[.]com/attachments/854820268773736493/897577190647029760/582\n\nhxxps://cdn[.]discordapp[.]com/attachments/874443728855658568/955432766999240724/621\n\nhxxps://cdn[.]discordapp[.]com/attachments/960944829708259331/960944846443511828/610\n\n## Second Stage - Decoded\n\n7ccb0bfb6429080048c8be436589144df05e0152871098e291f548fa55a80d12\n\n998096ef9182f3a82def92be40f03c3de2bdd563dbd64a56281a221b8275453a\n\n117584349ad009a1ff68d5a68ce38dbbf80687424b6c21100a5027523ea84dd5\n\ne6a003c19f1d67b44cff8b9404f3287a2b503b9332def38d0428676d1828ebed\n\n787b25c1baaf0315d6d75110da49f35c62128555117d04b383db5aac5edd4cdd\n\nec7cc391bb77f62288b026039580d0255cd36b619276a8fdc33af8dfdf9ccf95\n\n38f4f07f187ed0356ebe55962fb404109e4c3db39c97c94581c19ceb09eae3be\n\n8a5b720dcbdcb0bf99377ea2f5f69c25a4d7c19a00f43369c223d7060fec176d\n\n0955d76297f215c9898ea4334875dc10ddaca76dea5ec7bc82c870c6f3368672\n\nf77251430ac4e0c5296f85fdca79de02c442348d661a6412737edc1daa384ad2\n\ncc9f4854d7da2e50860c1e9d49647ddc08ae7ebae8f2fea419b1d42a2282a8b2\n\nae39808c101926b43a96b4e46bd21c0e7876fe07d03ee5e74cf66cde723209a1\n\nb835a0febe1a8710f3cb3861944bf32b2061c195d586d74a8870d06a43305d26\n\nd5aedccb962f751a869f1d8ae0b05c27979e4501877a060d9f5498f18b67408d\n\nfbfc1b9b6e0474ac2e279b1f2e5d4a2484d7e3489b20b34828a7e642b38c0447\n\n\n-----\n\n0347192b09ab57e6f9108ed139199aef5473da454c1f315fea00d79b0d718dfd\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-12 - New SYK Crypter Distributed Via Discord.pdf"
    ],
    "report_names": [
        "2022-05-12 - New SYK Crypter Distributed Via Discord.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536112,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1655092850,
    "ts_modification_date": 1655092850,
    "files": {
        "pdf": "https://archive.orkl.eu/8b494ac48bbd51f0396e6ef97cdb16b584c3f2ea.pdf",
        "text": "https://archive.orkl.eu/8b494ac48bbd51f0396e6ef97cdb16b584c3f2ea.txt",
        "img": "https://archive.orkl.eu/8b494ac48bbd51f0396e6ef97cdb16b584c3f2ea.jpg"
    }
}