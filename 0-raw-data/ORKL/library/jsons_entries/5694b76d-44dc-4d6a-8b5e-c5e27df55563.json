{
    "id": "5694b76d-44dc-4d6a-8b5e-c5e27df55563",
    "created_at": "2022-10-25T16:48:22.224357Z",
    "updated_at": "2025-03-27T02:16:50.938978Z",
    "deleted_at": null,
    "sha1_hash": "30247dcb727eaa945d77ffc1f1daf9304691a849",
    "title": "MirageFox: APT15 Resurfaces With New Tools Based On Old Ones - Intezer",
    "authors": "",
    "file_creation_date": "2018-06-19T07:36:32Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1290975,
    "plain_text": "# Blog\n\n#### Cybersecurity DNA\n\n\n-----\n\n##### APT15 Background\n\nCoincidentally, following the recent hack of a US Navy contractor and\n\ntheft of highly sensitive data on submarine warfare, we have found\n\nevidence of very recent activity by a group referred to as APT15,\n\nknown for committing cyber espionage which is believed to be\n\naffiliated with the Chinese government. The malware involved in this\n\nrecent campaign, MirageFox, looks to be an upgraded version of a\n\ntool, a RAT believed to originate in 2012, known as Mirage.\n\nAPT15 is known for committing cyberespionage against companies\n\nand organizations located in many different countries, targeting\n\ndifferent sectors such as the oil industry, government contractors,\n\nmilitary, and more. They are known for “living off the land,” meaning\n\nthey use already available tools and software installed on the\n\ncomputer to operate, and once inside a target network, they will tailor\n\ntheir malware specifically to the target. Other names for the group are\n\nVixen Panda, Ke3chang, Royal APT, and Playful Dragon.\n\nThere are many articles and researches online about APT15 and their\n\n[activities, the most recent one by NCC Group; although posted in](https://www.nccgroup.trust/uk/about-us/newsroom-and-events/blogs/2018/march/apt15-is-alive-and-strong-an-analysis-of-royalcli-and-royaldns/)\n\nMarch 2018, it refers to a campaign in 2017. In addition, although the\n\n2017 campaign has been documented, during our research regarding\n\nMirageFox, we found a recently uploaded binary (6/8/2018) from the\n\n2017 campaign, pretty much identical to a RAT mentioned in their\n\nRoyalAPT report, barely detected with only 7/66 detections on\n\n[VirusTotal.](https://www.virustotal.com/#/file/016948ec7743b09e41b6968b42dfade5480774df3baf915e4c8753f5f90d1734/detection)\n\n##### APT15 Code Reuse\n\nWe found the new version of the RAT on VirusTotal hunting, by a YARA\n\n[signature we created based off code only found in Mirage and Reaver,](https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/)\n\nboth attributed to Chinese government affiliated groups. After seeing\n\nthat these binaries were new uploads to VirusTotal, with very few\n\ndetections, we analyzed them using Intezer Analyze™ to see if we\n\ncould find any code reuse\n\n\n-----\n\n(https://analyze.intezer.com/#/analyses/d00b6787-0078-4148-aec3-\n\na66779a22ba5)\n\nAs can be seen in this code reuse analysis report (SHA256:\n\n28d6a9a709b9ead84aece250889a1687c07e19f6993325ba5295410a478da30a),\n\nthere is shared code with Mirage and Reaver. The compilation\n\ntimestamp is from June 8, 2018 while the upload date to VirusTotal\n\nwas June 9, 2018.\n\n[(VirusTotal)](https://www.virustotal.com/#/file/28d6a9a709b9ead84aece250889a1687c07e19f6993325ba5295410a478da30a/detection)\n\nOn VirusTotal, we can see there are only 10/66 detections for this\n\nbinary, 11/66 for another similar version of MirageFox (SHA256:\n\n97813e76564aa829a359c2d12c9c6b824c532de0fc15f43765cf6b106a32b9a5),\n\n\n-----\n\nRemote Shell:\n\nThe function above is seen throughout many of the binaries in the\n\nMirage family and is executed when a command is sent from the\n\nC&C. It is responsible for executing commands in cmd.exe (later down\n\nin the functions, not seen in the screenshot, it looks for cmd.exe and\n\nexecutes it using CreateProcessA).\n\nConfiguration Decryption:\n\n\n-----\n\nAnother small, but same important function in the photo above, is the\n\nfunction for decrypting the data containing the C&C configuration.\n\n[Similar to Reaver as posted by Palo Alto, it gets the IP or domain of the](https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/)\n\nC&C server, the port, name of the binary, a sleep timer, and what Palo\n\nAlto calls a “campaign identifier.”\n\n##### Technical Details\n\nAt this moment, we were unable to retrieve the original infection\n\nvector and other information regarding what other tools the APT15\n\ngroup is using to attack their targets. We are able to come up with a\n\n_few very interesting conclusions about what is going on here,_\n\n_although we cannot say for sure what the case is without the full_\n\n_context._\n\nFirstly, the reason this has been named MirageFox instead of just\n\nMirage, is because in the Export directory for the modules, the name\n\nfield is filled with a string MirageFox_Server.dat.\n\n\n-----\n\nEvidently in the image, you can see there is an exported function. The\n\nMirageFox binaries export a function called dll_wWinMain, the name of\n\nan export in vsodscpl.dll, a module by McAfee that is loaded by a few\n\nof their executables that import and call this function. This most likely\n\nmeans there is some type of DLL hijacking going on by distributing a\n\nlegitimate McAfee binary with MirageFox to load up the DLL properly\n\ninto a legitimate looking process. DLL hijacking techniques have been\n\nseen in the past with the APT15 group. The problem here is that once\n\nthe export is called the first time, the module renames itself to\n\nsqlsrver.dll and there is no evidence within the module of any type of\n\npersistence. By renaming it to this, the future executions of the RAT\n\nwill not be through a McAfee binary. The future persistence could be\n\nsetup through another component of the malware or even a\n\ncommand sent by the C&C to the infected computer.\n\nThe most interesting part is the decrypted C&C configuration, as can\n\nbe seen in the image below.\n\n\n-----\n\n_Port: 80_\n\n_Sleep Timer: 30000_\n\n_Campaign Identifier: Mirage_\n\nIf you look at it the decrypted configuration, you may notice that the IP\n\n_being used for the C&C is an internal IP address. If you read the report_\n\nmentioned above about RoyalAPT by NCC Group, it is mentioned that\n\nAPT15 infiltrated an organization again after stealing a VPN private\n\nkey, therefore we can assume this version was tailor made to an\n\n_organization they have already infiltrated and are connecting to the_\n\n_internal network using a VPN._\n\nThe rest of MirageFox functions similarly to previous malware created\n\nby APT15, first collecting information about the computer like the\n\n\n-----\n\ntypically seen in APT15 s RATs.\n\n##### Conclusion\n\nThere is high confidence that MirageFox can be attributed to APT15\n\ndue to code and other similarities in the MirageFox binaries. As is\n\nknown about APT15, after infiltrating their target, they conduct a lot of\n\nreconnaissance work, send the commands from the C&C manually,\n\nand will customize their malware components to best suit the\n\nenvironment they have infected.\n\n###### IOCs\n\nMirageFox\n\n28d6a9a709b9ead84aece250889a1687c07e19f6993325ba5295410a478da30a\n\n97813e76564aa829a359c2d12c9c6b824c532de0fc15f43765cf6b106a32b9a5\n\nb7c1ae10f3037b7645541acb9f7421312fb1e164be964ee7acd6eb1299d6acb2\n\nRoyalAPT\n\n016948ec7743b09e41b6968b42dfade5480774df3baf915e4c8753f5f90d1734\n\nRoyalAPT C&C\n\nbuy.healthcare-internet[.]com\n\nMirage (w/ Same C&C Config Decryption)\n\n5787eff4b4d6ee5b4c5457c9af5e2f2e3c75204b5989606b1faa9b944dc49a30\n\nb6bd5d8f5a824db05c37dde459b60a5571df87966e00390f2df56628da49b856\n\n\n-----\n\nda4dbc738d069fbcc9b96ab4af2bd3f7a87c7b69a4b47071e099e36b481dfa01\n\nf633df1fb42666f62eb23fd70dac4e3c0c4908af123f9335f3b58e6ea205df8a\n\ne67e58bc736bd54e6915cb43af5f3c332da3592839a5a4884ba141b089310815\n\n1534432fafb21c0479343bc2d9f3991e56c75baa41c54b3470d41055bb578f8f\n\n27a0ce9761363f6a1eafc719b96bbe1f9a426e50e8b5abf84db963efddb89a8d\n\nd22c2ef1453d5575e05a673777931e07c44734fe467a77969bebe86e26aacf98\n\nf85023ae81917a7fae0d987134a968ffad346d5c3b35d3a98e237419dd334696\n\n24b3c3527a2431d1c1dd27fe6566ddcaa8e4b92e31e468bb733e827350830a14\n\n57550ab2d20a757b24137ab764a2e9bf644fd8e1f4313bca22e04db7fa608cc2\n\n4d45ddc35abf77cded21bafe5483d345585c1d84f52a101a65ebfda88be5ad7d\n\n421f4c83898ff3ae9b2a94621140ef770888a8a0914b163cdae4690433173899\n\nc27fb5fd362fdaec2e344564f76197d01e1dc463ee3552b16452fc41e67f2709\n\ncec9c4e48fad6e4c2b7cf4bc34d357893ef878e8be076c9f680f297e06184c20\n\nBy Jay Rosenberg\n\nJay Rosenberg is a self-taught reverse engineer from a very young age (12 years old),\n\nspecializing in Reverse Engineering and Malware Analysis. Currently working as a Senior\nSecurity Researcher in Intezer.\n\nShare:\n\n\n-----\n\n[Digital Certificates- When The Chain Of T…](https://www.intezer.com/digital-certificates-when-the-chain-of-trust-is-broken/)\n\n## \n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.06.14.MirageFox_APT15/miragefox-apt15-resurfaces-with-new-tools-based-on-old-ones.pdf"
    ],
    "report_names": [
        "miragefox-apt15-resurfaces-with-new-tools-based-on-old-ones"
    ],
    "threat_actors": [
        {
            "id": "0a03e7f0-2f75-4153-9c4f-c46d12d3962e",
            "created_at": "2022-10-25T15:50:23.453824Z",
            "updated_at": "2025-03-27T02:00:55.473216Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "Ke3chang",
                "APT15",
                "Vixen Panda",
                "GREF",
                "Playful Dragon",
                "RoyalAPT",
                "Nylon Typhoon"
            ],
            "source_name": "MITRE:Ke3chang",
            "tools": [
                "Okrum",
                "Systeminfo",
                "netstat",
                "spwebmember",
                "Mimikatz",
                "Tasklist",
                "MirageFox",
                "Neoichor",
                "ipconfig"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c8cf02c-623a-4793-918b-f908675a1aef",
            "created_at": "2023-01-06T13:46:38.309165Z",
            "updated_at": "2025-03-27T02:00:02.801298Z",
            "deleted_at": null,
            "main_name": "APT15",
            "aliases": [
                "BRONZE PALACE",
                "Nylon Typhoon",
                "VIXEN PANDA",
                "Playful Dragon",
                "BRONZE DAVENPORT",
                "BRONZE IDLEWOOD",
                "G0004",
                "Red Vulture",
                "Ke3Chang",
                "Metushy",
                "Lurid",
                "Social Network Team",
                "Royal APT"
            ],
            "source_name": "MISPGALAXY:APT15",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7d5531e2-0ad1-4237-beed-af009035576f",
            "created_at": "2024-05-01T02:03:07.977868Z",
            "updated_at": "2025-03-27T02:05:17.283109Z",
            "deleted_at": null,
            "main_name": "BRONZE PALACE",
            "aliases": [
                "BRONZE DAVENPORT ",
                "BRONZE IDLEWOOD ",
                "CTG-9246 ",
                "Ke3chang ",
                "Playful Dragon",
                "Vixen Panda ",
                "APT15 "
            ],
            "source_name": "Secureworks:BRONZE PALACE",
            "tools": [
                " BS2005",
                " Enfal",
                " Mirage",
                " RoyalCLI",
                " RoyalDNS",
                "BMW"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "17b1b76b-16da-4c4f-8b32-f6fede3eda8c",
            "created_at": "2022-10-25T16:07:23.750796Z",
            "updated_at": "2025-03-27T02:02:09.961401Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "APT 15",
                "BackdoorDiplomacy",
                "Bronze Davenport",
                "Bronze Idlewood",
                "Bronze Palace",
                "CTG-9246",
                "GREF",
                "Ke3chang",
                "Metushy",
                "Nylon Typhoon",
                "Operation Ke3chang",
                "Operation MirageFox",
                "Playful Dragon",
                "Playful Taurus",
                "Red Vulture",
                "Royal APT",
                "Social Network Team",
                "Vixen Panda"
            ],
            "source_name": "ETDA:Ke3chang",
            "tools": [
                "Agentemis",
                "Anserin",
                "BS2005",
                "BleDoor",
                "CarbonSteal",
                "Cobalt Strike",
                "CobaltStrike",
                "DarthPusher",
                "DoubleAgent",
                "EternalBlue",
                "GoldenEagle",
                "Graphican",
                "HenBox",
                "HighNoon",
                "IRAFAU",
                "Ketrican",
                "Ketrum",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MS Exchange Tool",
                "Mebroot",
                "Mimikatz",
                "MirageFox",
                "NBTscan",
                "Okrum",
                "PluginPhantom",
                "PortQry",
                "ProcDump",
                "PsList",
                "Quarian",
                "RbDoor",
                "RibDoor",
                "Royal DNS",
                "RoyalCli",
                "RoyalDNS",
                "SAMRID",
                "SMBTouch",
                "SilkBean",
                "Sinowal",
                "SpyWaller",
                "Theola",
                "TidePool",
                "Torpig",
                "Turian",
                "Winnti",
                "XSLCmd",
                "cobeacon",
                "nbtscan",
                "netcat",
                "spwebmember"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041810,
    "ts_creation_date": 1529393792,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/30247dcb727eaa945d77ffc1f1daf9304691a849.pdf",
        "text": "https://archive.orkl.eu/30247dcb727eaa945d77ffc1f1daf9304691a849.txt",
        "img": "https://archive.orkl.eu/30247dcb727eaa945d77ffc1f1daf9304691a849.jpg"
    }
}