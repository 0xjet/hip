{
    "id": "5d65bb2a-fd30-49e3-ae59-c986cffd19d3",
    "created_at": "2022-10-25T16:48:18.765259Z",
    "updated_at": "2025-03-27T02:09:08.022055Z",
    "deleted_at": null,
    "sha1_hash": "fc604985e3b5fa14ddc905afdad71dec945d5f53",
    "title": "NEWKalnai_Horejsi-VB2015.indd",
    "authors": "",
    "file_creation_date": "2016-03-29T11:39:07Z",
    "file_modification_date": "2016-03-29T11:39:07Z",
    "file_size": 1424854,
    "plain_text": "# CONCEPT THAT CONQUERED THE ELF FORMAT\n## Peter Kálnai & Jaromír Hořejší Avast Software, Czech Republic\n\n Email {kalnai, horejsi}@avast.com\n\n ABSTRACT\n\nDDoS threats have been around ever since the Internet took\nover half of global communications, posing the real problem of\ndenial of access to online service providers. Recently, a new\ntrend has emerged in non-Windows DDoS attacks that has been\ninduced by code availability, lack of security and an abundance\nof resources. The attack infrastructure has undergone\nsignifi cant changes in structure, function and complexity.\nMalware has evolved into complex and relatively sophisticated\npieces of code, employing compression, advanced encryption\nand even rootkit capabilities. Targeted machines are those\nrunning systems supporting the ELF format – anything from\ndesktops and servers to IoT devices such as routers or digital\nvideo recorders (DVRs) could be at risk.\n\nIn this paper, we will look at the current state of DDoS trojans\nforming covert botnets on unsuspecting systems. A technical\nanalysis of the most important malware families will be\nprovided, with a specifi c focus on infection methods, dynamic\nbehaviour, C&C communication, obfuscation techniques,\nadvanced methods of persistence and stealth, and elimination\nof rivals. We will study cybercriminals’ behaviour and\nintroduce their operation tools, including vulnerability\nscanners, brute-forcers, bot builders and C&C panels. In many\ncases, it’s unnecessary to apply reverse engineering within the\nanalysis – the original source codes are indexed in public\nsearch engines and their customization is a subject of\nmonetization. Finally, we will discuss tracking methods and\ntechniques and reveal the targets of these attacks.\n\n## 1. INTRODUCTION\n\nToday, both desktop users and organizations face various types\nof cyber attacks including credential theft, spam distribution,\nclick fraud and denial of services (DoS). These are all usually\nperformed via a series of zombie computers in a malicious\nbotnet controlled by cybercriminals. Distributed DoS (DDoS)\nattacks are carried out using various methods such as\nvolumetric fl ooding, slow HTTP attacks or TCP protocol\nmisuse. A DNS amplifi cation is an example of volumetric\nfl ooding that has become popular recently. Certain trojans for\nthe Windows platform with resources containing Chinese\nsymbols have a long tradition of use in this type of attack and\nlack other spying features that trojans often possess (cf. [1]).\n\nImplementations of fl ooding procedures have been available\nfor a long time on Chinese source-code sharing services,\nespecially in C/C++. Until recently, the shared sources were\nusually compiled as DDoS tools exclusively for the Windows\nplatform. Crossing to another platform like Linux is not a\ncomplicated process though, and we have observed that many\nof these tools have been ported. These tools are not necessarily\ninvasive trojan-type malware. However, they come with an\nadditional framework (often on a different platform from the\n\n\nforming a malicious botnet. The framework consists of C&C\npanels, bot builders, installation scripts, port scanners, SSH\nbrute-forcers, etc. In our paper we provide a survey of current\n_Linux DDoS bots and we sketch a wider context of usage of_\nthe above-mentioned components. This topic has been covered\nby many independent security researchers, e.g. the\n_MalwareMustDie! group summarised their series of blogposts_\nin [2]. The authors presented its early development in [21].\n\n## 2. COMMON CHARACTERISTICS\n\n 2.1 About the ELF format\n\nELF is short for ‘Executable and Linkable Format’, which is a\ncommon standard format for executables under Unix systems.\nThe instruction set architecture (ISA) of the binary is stored at\nthe offset e_machine, and we refer to this parameter using the\nprefi x ‘EM_’. Unix systems power not only desktop and server\nmachines, but are also the main operating systems for\nembedded devices. Although Intel 80386 (EM_386) and\n_AMD64 (EM_x86_64) ISAs are the most common for desktops_\nand servers, the situation for embedded devices is completely\ndifferent – the devices may run on different ISAs, such as EM_\nARM or EM_MIPS. Cross-compilation of malicious binaries to\nthe latter platforms is done with the aim of extending the group\nof potential victims to target a wider range of devices.\n\n## 2.2 Static properties\n\nWe found that debugging symbols were often not stripped\nfrom ELF executables and thus revealed a lot about their\nfunctionality, especially the procedure names. The unstripped\nbinaries listed in the Appendix were chosen intentionally so\nthat we could review their features easily. At the same time,\nplain ELF binaries were occasionally encapsulated with the\nwell-known UPX compression [4], which produced a certain\nlevel of polymorphism for the distributors. There were cases\nwhen packed executables were altered in such a way that the\noffi cial tool did not decompress them (e.g. some chosen\nsamples from the Sotdas and MrBlack families referred to in\nthe Appendix). These modifi cations targeted the UPX header,\nwhich is located at the tail of the fi le. The changed parameters\nwere the UPX magic string, various checksums, fi le sizes or\ndecompression methods. Dynamic behaviour was not affected.\n\nInfected embedded devices do not often hide the presence of\nthe malware – debug information might be displayed directly\non the standard console output.\n\n## 2.3 Autostart\n\nAll programs and tools below are involved in malicious activities,\nbut in a strict sense we consider a DDoS trojan as a DDoS tool\nwith an autostart feature. There are more common methods for\nbots to handle their persistence. This is done by creating\nsymbolic links or executable scripts in the following directories:\n\n  - (AS1) /etc/init.d/ – the central repository of all startup\nscripts.\n\n - (AS2) /etc/cron.<S>/, where S is a period (hourly, daily,\nmonthly, weekly). Additionally, a service might be added\nto run in the cron (/etc/crontab).\n\n - (AS3) /etc/rc<N>.d/, where N is the run level indicator\n(0–6). Alternatively, the desired path can be added to\n\n\n-----\n\nscripts.\n\n## 3. CYBERCRIMINALS’ OPERATION TOOLS\n\nDistribution starts with either an automated SSH\nbrute-forcing of various Windows and Linux servers or\nvulnerability scanning and exploiting using the hacking tools\nand password lists mentioned below. If successful, fl ooding\ntools are downloaded and installed onto the hacked servers.\n\nThe installation process can consist of several steps:\n\n - determining susceptibility to known vulnerabilities of the\nsystem\n\n - killing competing time-consuming processes\n\n - establishing autostart\n\n  - disabling fi rewalls.\n\nWe found that it was not unusual for fl ooding and control\ncomponents to be offered freely as web server stress tests,\nwith a warning that discourages any malicious use. However,\nauthors looking for monetization of their tools offer\ncustomization of attack preferences and their control\nframework in return for a fee.\n\n## 3.1 Bot builders and C&C panels\n\nAccording to the type of machines that botmasters use to\nbuild their botnets, particular C&C panels and bot builders\nare chosen. They might be restricted to MIPS bots (e.g.\nMrBlack) or more heterogeneous with support for Linux,\n_Windows and FreeBSD (e.g. Elknot). A bot builder is_\ndesigned to set up bot details easily (e.g. the IP address of the\nC&C, port number, encryption keys, etc.). The builder\n\n_Figure 1: Example of Chicken Builder for Elknot._\n\n_Figure 2: Example of MrBlack Builder._\n\n\nexecution it is displayed in the control panel. The control\npanels are in the form of Windows executables.\n\nThe acquired builders are written and run under Windows OS,\nalthough they may produce binaries for both Windows and\n_Linux. A few examples are as follows:_\n\n - Chicken Builder (see Figure 1)\n\n - Text-Box Builder & Manager\n\n - MrBlack Builder (see Figure 2)\n\nThe existence of bot-building tools is consistent with the\nenormous number of existing samples that differ only in\nsettings such as C&C domains.\n\n## 3.2 HFS listings\n\nA good insight into the distribution chain was provided by fi le\nlistings displayed as the web content of an HTTP fi le server\n(an HFS listing) that was established on a possibly\ncompromised machine. The listings contained various groups\nof fi les, starting with port scanners, vulnerability scanners,\nlogin/password brute-forcers, password lists, lists of targeted\nIPs and SSH clients, and ended with the proper fl ooding tools,\nbot builders and C&C panels. Sometimes we even noticed\ntext fi les with IP addresses of servers followed by the default\nnames and passwords. These servers were clearly using the\ndefault credentials and were therefore accessible to anyone\nknowing the name/password combination. Additional crucial\ninformation provided by the HTTP fi le servers was the exact\nnumber of downloads of each fi le, giving us a chance to\nestimate the size of botnets.\n\n_Figure 3: An HFS panel used for distribution of malware –_\n_the number of downloads is shown in the right column._\n\n## 3.3 Brute-forcers and vulnerability scanners\n\nFigure 4 shows an SSH brute-forcer, where attackers can\nenter a list of IP addresses and a password list, as well as\nspecifying other parameters of the attack.\n\nFigure 5 shows a vulnerability scanner for Apache Struts,\nwhich was found together with Chinaz samples.\n\n## 4. DDOS TROJANS IN THE ELF MALWARE SPACE\n\nIt should not come as a surprise that ELF malware is not the\nsame as its Windows counterpart. This is due to the fact that\n\n\n-----\n\n_Figure 4: An SSH brute-forcer. Attackers enter an IP list and_\n_password list and specify other parameters of the attack._\n\n_Figure 5: A vulnerability scanner for Apache Struts found_\n_together with Chinaz samples._\n\nmost Windows malware runs on a machine where a user\nperforms personal actions, so info-stealers and banking\ntrojans make sense. ELF malware often targets devices that\nare not accessed by a real user. Therefore, it makes sense to\nmisuse the device’s power for tasks like denial of service,\nbitcoin mining or proxy networking and anonymization.\nFigure 6 sketches the total ELF malware space based on\n_Avast’s internal data, where the nodes represent particular_\nmalware families proportional to the number of unique\nsamples and the edges are present if the corresponding\nfamilies share a signature. The picture has been manipulated\nto omit very old viruses, potentially unwanted applications,\n\n_Figure 6: ELF malware space._\n\n\nleaving only relevant and interesting data.\n\nBased on the similarity of features we tried to group all the\nbots into several clusters. Most of them also exist as Windows\nvariants, but those will not be discussed.\n\n## 4.1 Elknot/Setag\n\nWith the highest incidence among any ELF malware family\n(~1400 unique samples), Elknot/Setag is among the most\npopular malware distributed by attackers. There are two main\nvariants in this family, both of which were written in the\nmodular C++ language. Bots of this type run on Windows\nx86/x64, Linux x86/x64 and FreeBSD systems. Although the\nvariants differ in complexity, we grouped them into one\nfamily because their Windows versions have signifi cantly\nsimilar debug info. They also have a very similar command\ngrammar. A detailed analysis was provided by Kaspersky’s\nMikhail Kuzin in [5].\n\n## 4.1.1 Simple variant\n\nThis variant usually comes as an on-the-fl y patcher of an\nembedded DDoS tool. Its purpose is to replace itself with a\ndropped bot that has the C&C server and the port number\ncarried from the patcher. These data are encrypted with a\nsimple substitution cipher based on adding one from\ncharacters on odd positions and subtracting one from\ncharacters on even positions.\n\nThe tool itself is characterized by the presence of the fi les\nfake.cfg or xmit.ini, which contain information such as the\nattack status, the ranges of outgoing IP addresses and ports, or\na domain name for a DNS fl ood. All network communication\nis a part of the CNetBase class. The commands supported are\nReadTask, StopTask, ReadFake and DestroySocket, and are\nimplemented in the main CManager class.\n\n## 4.1.2 Variant Setag\n\nThis more sophisticated trojan-type bot usually contains the\ncharacter strings ‘Bill’ and ‘Gates’. It recognizes four types of\nexecution: MainBackdoor, MainSystool, MainMonitor and\nMainBeikong.\n\n  - _Type MainBackdoor: A_ bot running this type of execution\nis called as the /usr/bin/bsd-port/getty fi le. At fi rst it\ndecrypts a hard-coded confi guration using RSA-1024 (the\nconfi guration settings are computed as a solution to the\nequation P ^ Q % N, where P and Q are primes and N is\nmodulus). The SetAutoStart procedure creates the selinux\nscript in (AS1) and multiple links under the name\nS99selinux in (AS3). The HandleSystools method of the\nCSystool class replaces the system tools /bin/netstat, /bin/\nlsof, /bin/ps, /usr/bin/netstat, /usr/bin/lsof, /usr/bin/ps, /usr/\nsbin/netstat, /usr/sbin/lsof and /usr/sbin/ps with copies of\nitself and backs up the original fi les into the newly created\n/usr/bin/dpkg/ directory. The proper attack is realized in\nthe MainProcess method of the main CManager class. A\nlist of the IP addresses of DNS servers misused for DNS\namplifi cation attacks are stored in the /usr/lib/libamplify.so\nfi le. The attacking classes are as follows: CAttackIcmp,\nCAttackSyn, CAttackUdp, CAttackAmp (DNS\namplifi cation), CAttackCC, CAttackDns, CAttackPrx,\nCAttackCompress, CTcpAttack, CAttackCc, CAttackIe\nand CAttackTns.\n\n\n-----\n\nmust be named as one of the systools. This type may be\nunder development because, currently, execution of these\nreplaced commands starts a copy of the trojan but does\nnot ensure its autostart or an alteration of outputs.\n\n  - _Type_ _MainMonitor: A_ bot running this type of execution\nis executed as the /usr/bin/.sshd fi le. It spawns an infi nite\nthread which monitors the existence of an instance of the\ntrojan and handles a reinstallation if needed. The PID of\na monitored process is loaded from /tmp/gates.lock. If no\nprocess with the given PID exists, then the trojan is\ninstalled and started again.\n\n  - _Type_ _MainBeikong: The features of this type of execution_\nare very similar to those of MainBackdoor. This type is\nrun if the bot has a different name from the three\nmentioned. The autostart is achieved by the\nDbSecuritySpt script via (AS1) and by multiple links\nunder the name S97DbSecuritySpt via (AS3). In this\nmode, the trojan checks whether another instance of\nmalware is running in the system (via the presence of *.\nlock fi les containing PIDs ). If so, then it terminates all\nof them, deletes all .lock fi les and restarts. This mode is\nprobably used for updates or reinstallation of the trojan.\n\nThe C&C panel is called NFarm and its executable is called\nxitele, which translates as ‘Hitler’ in Chinese (see Figure 7).\n\n\nThis family involves minimalistic DDoS tools characterized\nby the main thread _ConnectServer with a subroutine\nDealwithDDoS that handles the attack. The binaries usually\ncontain character strings such as ‘Hacker’, ‘Mr. Black’,\n‘VERS0NEX’ or a typo ‘connnect’. The support of Linux\narchitectures is wide (EM_386, EM_x86_64, EM_ARM and\nEM_MIPS) and compression with UPX is not exceptional.\nAdditional threads could be spawned for collecting CPU and\nnetwork statistics and reporting them to a C&C server. A\ndetailed analysis was published by Prolexic [6].\n\n## 4.2.1 Aesddos\n\nAesddos is a trojan that extends the core functionality provided\nby MrBlack with C&C communication encrypted with AES.\nPersistence is realized at the beginning of the execution in the\nautoboot procedure by stream editing the fi les /etc/init.d/boot.\nlocal (AS1) and /etc/rc.local (AS3). The attack itself is\nperformed via two main threads, backdoorA and backdoorM.\nThe trojan supports the same Linux architectures as MrBlack,\nbut the EM_ x86_64 variant was not observed. A detailed\nanalysis of the MIPS variant is provided by M.J. Bohio [7].\n\n## 4.2.2 WrkAtk\n\nThis is another trojan subfamily that strongly resembles\nAesddos, with two main threads called DoubleDoMain1 and\n\n\n_Figure 7: Control panel for Elknot family, called xitele._\n\n_Figure 8: Control panel for MrBlack called sword.exe with one connected bot (MIPS)._\n\n\n-----\n\nAttackWorker, which is responsible for calling the\nDealwithDDoS subroutine with appropriate parameters.\nAutostart is achieved using the insert_reboot procedure and is\nbased on the same principle as in the case of Aesddos. The\nalready_running procedure checks that the process is the only\ninstance of the trojan, and the test is done by locking the fi le\n/var/run/dos32.pid. The confi guration fi le dosset.dtdb is an\nadditional IoC.\n\n## 4.3 Iptablesx\n\nIt was observed that a DDoS trojan has been spread by\nexploiting vulnerable Apache Tomcat, Struts or Elasticsearch\nsoftware. The functionality of this piece of malware is divided\ninto two parts: an initial binary is responsible for establishing\npersistence, eliminating an extensive list of rivals (stored in\nkill.txt or fuckopen.txt) and downloading an additional bot\nwith implemented attack routines. IoCs list a binary /usr/bin/\nbtdaemon, a process .fl ush, or S90bluetooth symbolic links.\n\nThe proper DDoS bot is written in C and is downloaded as\ngetsetup.rar. Execution parameters are stored in the global\nvariable g_mainsrvinfo of a struct type MAINSRVINFO with\nentries such as srvver, mainhostip, udpport or Mainisrun. A\nself-installation is performed into the /boot/ directory with an\nautostart script called IptabLes/IptabLex in (AS1). The bot\nthen establishes communication with its C&C server. The\ninitial packet contains the memory and CPU statistics of the\ncompromised machine. Once the connection is established\nand the initial packet has been sent, the bot awaits commands\nfrom its control server. The most important DDoS commands\nare: setlocalip, setrandomip, updatepath, updatesrv,\nDeleteTask and DeleteAllTask. Observed types of attacks\ninclude volumetric SYN_Flood and DNS_Flood. Detailed\nanalyses have been provided by Prolexic [8] and\n_MalwareMustDie! [9]._\n\n## 4.4 Sotdas\n\nThis family is characterized by the presence of the strings\n‘g_nIsStopDDOS’, ‘DOSSTAT’ or ‘# chkconfi g: 2345 77 37’.\nThe encryption of particular strings is done in a similar\nmanner to that in which it is done in the Elknot family, but the\nperiod of substitution is 3 instead of 2. A self-installation\ntakes care of multiple copies as /etc/.zl and /tmp/.lz<digits>\nfi les, where digits are derived from actual time. An autostart\nscript is called .zl in (AS1) and symbolic links are called S77.\nzl in (AS3) (run levels Halt, Single-user mode and Reboot are\nomitted). The closefi rewall procedure clears the environment\nfor the trojan by disabling network fi lters (by stopping\nSuSEfi rewall2 and disabling ufw) and terminating competing\nDDoS processes (obviously targeting IoCs of Iptablesx). The\nrelated binaries are often compressed with modifi ed UPX. A\ndetailed analysis has been published by Dr.Web [10].\n\n## 4.5 Gafgyt\n\nThis is an alternative name for the Lizard Stresser DDoS tool\nadvertised by the Lizard Squad group [11]. It is capable of\ninfecting a variety of devices running on Linux. In-the-wild\nusage of the Bash Bug, a.k.a Shellshock vulnerability (CVE2014-6271), was observed to install Gafgyt’s binaries onto a\ncompromised system [12]. The source code of this IRC bot\nwas leaked in January 2015. The support of architectures is\n\n\nbots for EM_386, EM_x86_64, EM_SPARC, EM_PPC, EM_\nSH, EM_ARM, EM_MIPS and EM_68K. Examples of\nimplemented commands together with an explanation for\neach are shown in Table 1.\n\nPING Reply PONG to the server\n\nGETLOCALIP Get victim’s IP\n\nSCANNER ON | OFF; attempts to login to IPs from\na generated list and to install itself if\nsuccessful\n\nUDP UDP fl ooding\n\nTCP TCP fl ooding\n\nDNS DNS amplifi cation\n\nKILLATTK Stop DDoS attack\n\nLOLNOGTFO Stop the backdoor\n\n_Table 1: Some commands implemented in Gafgyt._\n\nDetailed analyses have been published by Dr.Web [13] and\n_Alienvault [14]._\n\n## 4.6 Xorddos\n\nThis cluster was fi rst discovered in September 2014 [15] and\nlater reported multiple times [16–18]. Its infection vector\nstarts with SSH brute force attacks for the sake of running an\ninstallation script under the root user. The script customizes\nthe installation process and contains procedures like main,\ncheck, compiler, uncompress, setup, generate, upload,\ncheckbuild, etc. and variables like __host_32__, __host_64__,\n__kernel__, __remote__, etc. Three requests are issued to\nhard-coded C&C servers: the initial GET with an\nMD5-hashed string containing the name of the kernel version;\na GET query with the parameters of a customized binary such\nas rootkit version and a list of the bot’s C&Cs; and the fi nal\nGET request of a compiled binary. The rootkit component\nwith a complicated server-assisted installation is where\nXorddos differs from all the other Linux trojans. Due to the\nnature of the Linux operating system, knowledge of kernel\nheaders is crucial for loading any kernel module in the\nvictim’s machine. In case the hash of the kernel version is\nunknown to the server, the system’s kernel headers are\nuploaded via a custom uploader and a new rootkit-equipped\ntrojan can be delivered. The rootkit component is based on\nthe open-source Suterusu rootkit, which is also available on\n_Github [19]._\n\nThe binary itself is copied into /boot/ under a random name.\nThe name is then used to autostart the binary via (AS1),\nanother script called udev.sh or cron.sh via (AS2), and\nsymblic links called S90%s (where %s is randomly\nsubstituted via (AS3). Moreover, a victim might observe\nanother instance of a randomly named binary in the /boot/\nconstantly being deleted and created again. This behaviour\navoids the need to fi nd a single constant process and to apply\nthe kill command.\n\nThe confi guration fi le of the rootkit contains four categories\nof lists: md5, denyip, fi lename and rmfi le, which mean killing\na running process based on its checksum (even though the\n\n|PING|Reply PONG to the server|\n|---|---|\n|GETLOCALIP|Get victim’s IP|\n|SCANNER|ON | OFF; attempts to login to IPs from a generated list and to install itself if successful|\n|UDP|UDP fl ooding|\n|TCP|TCP fl ooding|\n|DNS|DNS amplifi cation|\n|KILLATTK|Stop DDoS attack|\n|LOLNOGTFO|Stop the backdoor|\n\n\n-----\n\n_Figure 9: Elimination of rivals of Xorddos._\n\n_Figure 10: Control Panel for Xorddos with two connected bots, one EM_386, the second EM_ARM._\n\n\nvariable is called md5, the internal implementation is\nCRC32), on the active communication with an IP from the\nlist, on a fi lename, and fi nally removing a fi le with a specifi ed\nname. Figure 9 shows part of the confi g fi le; marked\nfi lenames denote usual competitors such as Elknot, MrBlack,\nSotdas or Iptablesx.\n\nThe C&C communication is encrypted in both directions with\nthe same hard-coded XOR key (BB2FA36AAA9541F0) –\nwhich inspired the trojan’s name.\n\n## 4.7 Chinaz\n\nThis is a collection of DDoS tools with core fl ooding\nfunctionality borrowed from a simple project, DDosClient,\navailable publicly on Github (last update in March 2015). The\ncommands that are supported are at least COMMAND_\nDDOS_ATTACK and COMMAND_DDOS_STOP, and the\nattack arsenal lists at least methods including ATTACK_SYN,\nATTACK_UDP, ATTACK_ICMP, ATTACK_DNS1 and\nATTACK_DNS2. The other character strings are ‘DDos\nATTACE!’, ‘SecurtDoor’, ‘MK32’ and ‘MK64’. Variants have\nbeen observed for multiple platforms: EM_386, EM_x86_64\nand EM_MIPS. Samples are often packed by the unmodifi ed\nUPX tool.\n\n## 5. STATISTICS AND VICTIM PREFERENCES\n\nThe number of bots running on Linux platforms was not\nexpected to be high. The size of a botnet could be estimated\n\n\nby data from HFS panels running on different machines.\nDistributed malicious binaries displayed tens, hundreds,\noccasionally thousands of downloads. However, that value\nwas just an upper bound as bots might have been reinstalled\nrepeatedly on victims’ machines. The situation was similar for\nbotnets of Gafgyt, as [11] revealed.\n\nRegarding the volume of attacks, the reports [8] and [6] state\npeaks of 30.10 Gbps/6.75 Mpps for Iptablesx respectively,\nwith 70 Gbps/28 Mpps for MrBlack. A DDoS attack\nperformed by one victim of Xorddos reported in [20] lasted\nthree hours and the amount of data averaged 6.63 Mbps/70\nKbps.\n\nBy knowing the communication protocol and the command\ngrammar it is possible to harmlessly monitor the C&C\nactivity and to log the targets of DDoS attacks. This was\napplied by a series of Python scripts for the Elknot/Setag\nfamily [21]. We have tried a similar approach for the Xorddos\nfamily. Among the observed victims were especially online\ngaming sites, e-commerce shops, online casinos, etc., all of\nwhich belonged to Chinese, American or Canadian IP ranges.\nThese services had both the nature of small or medium-sized\nlocal businesses and services with a huge anti-DDoS\ninfrastructure. The success of a fl ooding attack on the\nunprotected ones was directly observed in terms of the\nunreachability of a service shortly after the attack command\nhad been issued.\n\nTargeted IP addresses in the United States or Canada involved\ninfrastructure belonging to Google Cloud [20], CNSERVERS\n\n\n-----\n\nor Day of Defeat), CloudFlare; Sharktech; OVH Hosting;\n_Microsoft Hosting, Amazon Cloud; Akamai Technologies, etc._\n\nWhat all these services have in common is that their\nfunctionality and profi tability depend on their ability to stay\nonline and available for customers’ requests. When some of\nthe above-mentioned websites suffer a heavy DDoS attack,\nthey become unreachable to their potential users and/or\ncustomers. Any time the service is not available causes a\nfi nancial loss. Therefore the reason for attacking the abovementioned type of websites is fi nancial – the potential profi t is\nprobably based on the extortion of ransom payments.\n\n## 6. CONCLUSION\n\nThe number of (trojanized) DDoS tools has escalated quickly\nsince the end of 2013. The potential in devices with\nundeveloped or no security measures is very attractive for\nattackers to build botnets. We can also see a variety of projects\nthat wrap the core fl ooding features. We can expect current bots\nto be enhanced and even more families to arise in the near\nfuture, potentially sharing chunks of already known bots as a\nconsequence of a mixture of available source codes. It’s hard to\npredict whether binaries will display an increased level of\npolymorphism than just a (modifi ed) UPX compression. For\nthe time being, it seems that malware distributors do not care\nabout AV detection. The security community has started to pay\nsignifi cant attention to these threats.\n\n## ACKNOWLEDGEMENTS\n\nWe would like to thank @benkow_, Christian Rebischke\n(@Sh1bumi), @threat_inc and Lin Song (University of Iowa)\nfor sharing information and samples. Moreover, we thank the\nfollowing researchers for openly sharing their threat\nintelligence: @MalwareMustDie, @TekDefense and\n@da_667.\n\n## REFERENCES\n\n[1] Edwards, Nazario. J. A Survey of Contemporary\nChinese DDoS Malware, Virus Bulletin 2011\n(Barcelona).\n\n[2] MalwareMustDie! Tango down report of OP China\nELF DDoS’er. September 2014.\nhttp://blog.malwaremustdie.org/2014/09/tangodown-report-of-op-china-elf-ddoser.html.\n\n[3] Kálnai P.; Hořejší J. Chinese Chicken: Multiplatform\nDDoS botnets, https://www.botconf.eu/wp-content/\nuploads/2014/12/2014-2.10-Chinese-ChickenMultiplatform-DDoS-Botnets.pdf.\n\n[4] UPX: the Ultimate Packer for eXecutables.\nhttp://upx.sourceforge.net/.\n\n[5] Kuzin, M. Versatile DDoS Trojan for Linux. July\n2014. https://securelist.com/analysis/\npublications/64361/versatile-ddos-trojan-for-linux/.\n\n[6] Prolexic. Spike DDoS Toolkit. October 2014.\nhttp://www.prolexic.com/kcresources/prolexicthreat-advisories/prolexic-threat-advisory-spikeddos-toolkit-botnet/spike-ddos-toolkit-cybersecurityA4-092414.pdf.\n\n\nSANS Institute. https://www.giac.org/paper/\ngrem/2573/analyzing-backdoor-bot-mipsplatform/124977.\n\n[8] Prolexic. IptabLes/IptabLex DDoS Bots. September\n2014. http://www.prolexic.com/kcresources/prolexicthreat-advisories/prolexic-ddos-threat-advisoryiptables-iptablex-linux-bots-botnet-cybersecurity/TADDos-Binary-Bot-IptabLes-v6-A4.pdf.\n\n[9] MalwareMustDie! ITW Infection of ELF .IptabLex\n& .IptabLes China #DDoS bots malware. June 2014.\nhttp://blog.malwaremustdie.org/2014/06/mmd-00252014-itw-infection-of-elf.html.\n\n[10] Dr.Web. Linux.Myk.5. http://vms.drweb.com/\nvirus/?i=4365599.\n\n[11] Krebs, B. Lizard Stresser Runs on Hacked Home\nRouters. January 2015. http://krebsonsecurity.com/\n2015/01/lizard-stresser-runs-on-hacked-homerouters/.\n\n[12] Security Affairs. Hackers target Bash Bug\nvulnerability in the wild. September 2014.\nhttp://securityaffairs.co/wordpress/28626/cybercrime/hackers-use-bash-bug.html.\n\n[13] Dr.Web. Linux.BackDoor.Fgt.1. November 2014.\nhttp://vms.drweb.com/virus/?i=4242198.\n\n[14] Blasco, J. Attackers exploiting Shellshock (CVE2014-6721) in the wild. September 2014.\nhttps://www.alienvault.com/open-threat-exchange/\nblog/attackers-exploiting-shell-shock-cve-20146721-in-the-wild#sthash.bzInLhax.dpuf;.\n\n[15] MalwareMustDie! Fuzzy reversing a new China ELF\nLinux/XOR.DDoS. September 2014.\nhttp://blog.malwaremustdie.org/2014/09/mmd-00282014-fuzzy-reversing-new-china.html.\n\n[16] Kálnai, P. Linux DDoS Trojan hiding itself with an\nembedded rootkit. January 2015.\nhttps://blog.avast.com/2015/01/06/linux-ddos-trojanhiding-itself-with-an-embedded-rootkit/.\n\n[17] FireEye. Anatomy of a Brute Force Campaign:\nThe Story of Hee Thai Limited. February 2015.\nhttps://www.fi reeye.com/blog/threatresearch/2015/02/anatomy_of_a_brutef.html.\n\n[18] Level3. It Takes a Village – Collaborative Steps to\nBreaking Botnets: How Level 3 and Cisco Worked\nTogether to Improve the Internet’s Security and Stop\nSSHPsychos. April 2015. http://blog.level3.com/\nsecurity/breaking-botnets-how-level-3-and-ciscoworked-together-to-improve-the-internets-securityand-stop-sshpsychos/.\n\n[19] Github. An LKM rootkit targeting Linux 2.6/3.x on\nx86(_64), and ARM. https://github.com/mncoppola/\nsuterusu.\n\n[20] Evidence of a DDoS attack. February 2015.\nhttps://gist.github.com/Manawyrm/\n74e687b2a01527725d33.\n\n[21] ValdikSS. Some tools to monitor BillGates CnC\nservers. February 2014. https://github.com/ValdikSS/\nbillgates-botnet-tracker.\n\n\n-----\n\n|APPENDIX|Col2|\n|---|---|\n|Elknot Builder|F126C3F8530587F7CADEB8B969BC04AB114B468922171A953211345AD5A8F380|\n|Elknot Xitele Kit|48183D0DD8DA484639ADDA9F60E5FEA340D7C6B4C77458384EE98CB21972ADE5|\n|Elknot EM_386|D1F922A762BBD4E0725D4625BE4A39CEBFA03D1875339E9F01F825A2DCDC9E65|\n|Elknot EM_386 (Setag)|568A52AA9A9AC2698BA7C49FE4A3AEE34D96FE0F25ECCB31FC726D941BB135EA|\n|Elknot (Setag) UPX|3E89F0D71671DB79506050E0823D121EA5A19457308AF3E379AC45A0338B1B33|\n|Elknot Script|21ACDA48CAD399B049D03A51A64C9E4BB2DC96C1916BC4EECD6FC828E8036083|\n|Chinaz EM_386|A86B1899821C2833B989A736E928A4137FA6D0954C9816747F6AFEF536F757F9|\n|Chinaz EM_x86_64|1EB72C76F79FA01CE39198C91AF5C7A4E36897E9A9A8F5D29CA68BA7371A2361|\n|Chinaz EM_MIPS|87934D993BB5262FB2826DA05CB4657EC6B20849A65C5D00D260BBF58878F45E|\n|Chinaz Sources|992ED01DEF5ECE5B90CE242820D2BFDD580FDDDE12DBC10CE5A395A7923922C9|\n|MrBlack C&C|1828AC46C67E120274688A562D04E9E9A629C39090A848956FB7DB45B6551B74|\n|MrBlack Builder|E83F69052FC240DC43FC2B32F77408B2B3488E67B29B04041E7C6B8622CE8602|\n|MrBlack EM_x86_64|F2DF127535902E6390CE2EC198C12A5BD9A361901C2D8008A064DF96EFD10E29|\n|MrBlack EM_x86_64 UPX|6DD946E821DF59705DCFEB79FAB810336D0EE497FD715FB5B6711E05C0428F4D|\n|MrBlack EM_386|8766317F20B05C792514ADDD8BB4904021049ACD86E8D70E9FFFD1D12FAD51CE|\n|MrBlack EM_ARM|26FCBDC7EBE2750B4008D8C67186A9DA03D34B994662BD93E49D7C572AADBAE0|\n|MrBlack EM_MIPS|736C08988602155954C02CBEF0B4ED3DD916C7EB659032202F15081620058988|\n|MrBlack Sources|8499E6727253FA98DACC3D753CC08CB207C64A290D9521E94A65C2BDA34F405E|\n|Aesddos EM_ARM|AF765C0F87846E6E1A184B64A4DA8E51588F0F6A7048FEFDD60B53058373C6B6|\n|Aesddos EM_386|D6E77D8F2FFDF61981241022E8D7034014927BFFA23793739051CAD34867F766|\n|Wrkatk EM_386|288D91AF1B5F3A57C0B3D66330F56BBCD38604948B3154CD4842D277FA86F664|\n|Wrkatk EM_x86_64|0940E4A72DBA133838CCD0992914C5FB2BF106D5A018F289B9C5896C0E237CC6|\n|Wrkatk EM_MIPS|8A1CE3302E896CD695528EB0CC744EC6E18C1D708C944BE7C8AFFB3B4D44BD5D|\n|Wrkatk EM_ARM|4ED6E5CFA9D7006E021BBD099AAFD4F2ADAAE3307DC25262E240D9E8829B960D|\n|Iptablesx Dropper|F41C4C9EE0FBAEFF5397F27531A91135C1D98C54A9E0BDC6CA52315E3E208537|\n|Iptablesx EM_386|9F89CA6F4580F6EBE021D2C2E2C528B93E4492C4B6E6BD5F339361E86F8585D8|\n|Sotdas EM_386|E75E49AC157DADC8C4E7230D531BE0DB6FBC339B5D75B7AB8FA6202CE0EC8E2A|\n|Sotdas EM_x86_64 UPX|59D53A8DFB2B646293E422743EAF8C6F3AB576BACCDF36BB133C4F458AAF60A3|\n|Xorddos C&C|496F413E6C8B6F258C238AF6EAF61C2B524DC0DC985E4E659627ADAE1ED31517|\n|Xorddos Script|BA84C056FB4541FE26CB0E10BC6A075585990F3CE3CDE2B49475022AD5254E5B|\n|Xorddos Uploader|44153031700A019E8F9E434107E4706A705F032898D3A9819C4909B2AF634F18|\n|Xorddos EM_386|AD26ABC8CD8770CA4ECC7ED20F37B510E827E7521733ECAEB3981BF2E4A96FBF|\n|Xorddos EM_x86_64|859A952FF05806C9E0652A9BA18D521E57090D4E3ED3BEF07442E42CA1DF04B6|\n|Xorddos EM_ARM|49963D925701FE5C7797A728A044F09562CA19EDD157733BC10A6EFD43356EA0|\n|Xorddos Rootkit|6BE322CD81EBC60CFEEAC2896B26EF015D975AD3DDA95AE63C4C7A28B7809029|\n|Gafgyt Server|2A04C216FCE75D19E5162081EB747B8A77C205F6DD933B0864C08FB086C929C5|\n|Gafgyt EM_x86_64|BAABCECAC23775FDD3E52CD1FB0E4C46777A6747E854074ECE751767D13F6DD7|\n|Gafgyt EM_386|28EA6EE1080B4D436685D0D0C87EEF492EA2A376917437E865D0D1513114B8D7|\n|Gafgyt EM_ARM|67FF5F3F10AD86ED0A9F90244E7B5BE839AFB0AAEB49E22130551A09A0F08FF8|\n\n\n-----\n\n|Gafgyt EM_MIPS|04BEF883E7098FDA9148A75C43165D45AC5FBB8B6032848E9C5D9A5E3897DF52|\n|---|---|\n|Gafgyt EM_PPC|7F13A4C911AB0682D9A7F5988DA9C7BE0AE781CE15945E4C0AA76A78E22CBF2F|\n|Gafgyt EM_SH|D59C7CF8D9EFBD93F0B907C12BB4C18CC5CE7D800B234DB219D2D919C0B0AFDC|\n|Gafgyt EM_SPARC|277D2D00E27BCF4536BB492CAC16001E8832DC9BBED384A8C523B49A199790E6|\n|Gafgyt EM_x86_64|BAABCECAC23775FDD3E52CD1FB0E4C46777A6747E854074ECE751767D13F6DD7|\n|Gafgyt EM_68K|4E611FB1466920885D1216AB7D9B4F16A3F31D52CF7B39FFC21FC6CA41534738|\n|Gafgyt Script|8D0B152A91202356B3B5470C5C017B4E9595C5325D8C14DA1DEBBE1782225A14|\n|Gafgyt Sources|1AF299A269FFDB4461E181CA774FC307A592288AD4B3F6B93226C955EB9B8084|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.virusbulletin.com/uploads/pdf/conference/vb2015/KalnaiHorejsi-VB2015.pdf"
    ],
    "report_names": [
        "KalnaiHorejsi-VB2015.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041348,
    "ts_creation_date": 1459251547,
    "ts_modification_date": 1459251547,
    "files": {
        "pdf": "https://archive.orkl.eu/fc604985e3b5fa14ddc905afdad71dec945d5f53.pdf",
        "text": "https://archive.orkl.eu/fc604985e3b5fa14ddc905afdad71dec945d5f53.txt",
        "img": "https://archive.orkl.eu/fc604985e3b5fa14ddc905afdad71dec945d5f53.jpg"
    }
}