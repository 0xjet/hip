{
    "id": "308d897b-fd9b-47ee-8bc3-56c13630d53d",
    "created_at": "2023-01-12T15:06:45.787909Z",
    "updated_at": "2025-03-27T02:16:25.839719Z",
    "deleted_at": null,
    "sha1_hash": "8a0b0e9670668478c4961bfa1aaecc3ea02499f9",
    "title": "2017-07-05 - SLocker Mobile Ransomware Starts Mimicking WannaCry",
    "authors": "",
    "file_creation_date": "2022-05-28T21:54:41Z",
    "file_modification_date": "2022-05-28T21:54:41Z",
    "file_size": 138177,
    "plain_text": "# SLocker Mobile Ransomware Starts Mimicking WannaCry\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/slocker-mobile-ransomware-starts-mimicking-wannacry/](https://blog.trendmicro.com/trendlabs-security-intelligence/slocker-mobile-ransomware-starts-mimicking-wannacry/)**\n\n_Updated July 6 3:00 AM CDT to clarify statement about Slocker variant being notable as an Android file-encrypting_\n_ransomware._\n\n\nJuly 5, 2017\n\n\nEarly last month, a new variant of mobile ransomware SLocker (detected by Trend Micro as ANDROIDOS_SLOCKER.OPST)\nwas detected, copying the GUI of the now-infamous WannaCry. The [SLocker family is one of the oldest mobile lock screen and](http://blog.trendmicro.com/trendlabs-security-intelligence/mobile-ransomware-pocket-sized-badness/)\nfile-encrypting ransomware and used to impersonate law enforcement agencies to convince victims to pay their ransom. After\n[laying low for a few years, it had a sudden resurgence last May. This particular SLocker variant is notable for being an Android](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/ransomware-recap-ransomware-as-a-service-surge-slocker-resurfaces)\nfile-encrypting ransomware, and the first mobile ransomware to capitalize on the success of the previous WannaCry outbreak.\n\nWhile this SLocker variant is notable for being able to encrypt files on mobile, it was quite short-lived. Shortly after details about\nthe ransomware surfaced, decrypt tools were published. And before long, more variants were found. Five days after its initial\n[detection, a suspect supposedly responsible for the ransomware was arrested by the Chinese police. Luckily, due to the limited](http://m.qq.com/security_lab/news_detail_417.html)\ntransmission channels (it was spread mostly through forums like QQ groups and Bulletin Board Systems), the number of\nvictims was very low.\n\n[Figure 1. Timeline for this ransomware sample](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/06/SLocker1.jpg)\n\n_Figure 1. Timeline for this ransomware sample_\n\nThe original sample captured by Trend Micro was named “王者荣耀辅助” (King of Glory Auxiliary), which was disguised as a\ncheating tool for the game King of Glory. When installed, it has a similar appearance to WannaCry, which has already inspired\na few imitators.\n\n_Figure 2. The first mobile ransomware we’ve seen mimicking WannaCry_\n\nThis ransomware disguises itself as game guides, video players, and so on in order to lure users into installing it. When\ninstalled for the first time, its icon looks like a normal game guide or cheating tool. Once the ransomware runs, the app will\nchange the icon and name, along with the wallpaper of the infected device.\n\nThe ransomware announces a disabled activity alias for “com.android.tencent.zdevs.bah.MainActivity”. It then changes its icon\nby disabling the original activity and enabling the alias.\n\n[Figure 3. After running, the ransomware icon and name changes](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/06/SLocker3.png)\n\n_Figure 3. After running, the ransomware icon and name changes_\n\n\n-----\n\n**How the Ransomware Encrypts Files**\n\nWhen the ransomware is installed, it will check whether it has been run before. If it is not, it will generate a random number and\nstore it in SharedPreferences, which is where persistent application data is saved. Then it will locate the device’s external\nstorage directory and start a new thread.\n\nThe thread will first go through the external storage directory to find files that meet specific requirements:\n\nThe lowercase paths for target files must not contain “/.”, “android”, “com.” and “miad”.\nWith the external storage as the root directory, target files should be in directories whose directory level is smaller than 3\nor the lowercase file paths contain “baidunetdisk”, “download” or “dcim”.\nFile name must contain “.” and the byte length of the encrypted file name should be less than 251\nThe file must be larger than 10 KB and smaller than 50 MB\n\nWe see that the ransomware avoids encrypting system files, focuses on downloaded files and pictures, and will only encrypt\nfiles that have suffixes (text files, pictures, videos). When a file that meets all the requirements is found, the thread will use\nExecutorService (a way for Java to run asynchronous tasks) to run a new task.\n\n[Figure 4. Snippet showing the start of a new task](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/06/SLocker4.png)\n\n_Figure 4. Snippet showing the start of a new task_\n\nThe new task will use a method named “getsss” to generate a cipher based on the previously generated random number. This\nmethod computes the MD5 of the random number and selects 16 characters as a string from the hexadecimal representation\nof the MD5. After the string is generated, the ransomware will feed it to SecretKeySpec to construct the final key for AES\nbefore using AES to encrypt files.\n\n_Figure 5. Snippet showing the “getsss” method_\n\nOnce the file has been encrypted, a suffix will be added to the file name. The suffix contains a QQ number and the random\nnumber used to generate the cipher.\n\n[Figure 6. Sample of encrypted file name](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/06/SLocker6.png)\n\n_Figure 6. Sample of encrypted file name_\n\nThe ransomware presents victims with three options to pay the ransom, but in the sample we analyzed, all three led to same\nQR code that asks the victims to pay via QQ (a popular Chinese mobile payment service). If victims refuse to pay after three\ndays, then the ransom price will be raised. It threatens to delete all files after a week.\n\n[Figure 7. Payment options for the ransomware](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/06/SLocker7.png)\n\n_Figure 7. Payment options for the ransomware_\n\nThe ransomware tells victims that a decrypt key will be sent after the ransom has been paid. Through our analysis, we found\nthat if victims input the key and click the Decrypt button, the ransomware will compare the key input with the value in\nMainActivity.m. But after tracking MainActivity.m, we found that the value is actually the previously mentioned random number\nplus 520.\n\n[Figure 8. Snippet showing the value is the random number plus 520](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/06/SLocker8.png)\n\n_Figure 8. Snippet showing the value is the random number plus 520_\n\nTake the instance we are running as an example: the random number is 10049252. So the decrypting key should be 10049772\n(10049252 + 520). Using that as the key and clicking on the Decrypt button will decrypt the files.\n\n[Figure 9. Decryption screen of mobile ransomware](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2017/06/SLocker9.png)\n\n_Figure 9. Decryption screen of mobile ransomware_\n\n**Numerous New Variants Emerge**\n\n\n-----\n\nAfter the initial ransomware was exposed, more and more variants appeared. While some variants changed the method for\ngenerating the decrypt key, the user can still decrypt the files if they figure out the new formula:\n\nFigure 10. While the original used (random number + 520), these variations are similar but use other formulas\n\nSome pack themselves to avoid static detection:\n\n**Solutions and Recommendations**\n\nCompared to the ransomware we’ve seen before, this ransomware is relatively simple. It is actually quite easy for a security\nengineer to reverse the ransomware and find a way to decrypt files. However, the proliferation of new variants so quickly after\nthe first one shows that these malicious actors are not slowing down. Even though a suspect was caught, more advanced\nransomware may be just around the corner.\n\nTo help you keep the information on your mobile device safe, here are some tips to protect you from ransomware:\n\nOnly install apps downloaded from legitimate app stores such as Google Play\nBe careful about permissions an app asks for, especially permissions that allow the app to read/write on external storage\nBack up your data regularly—either on another secure device or on cloud storage\n[Install comprehensive antivirus solutions. Mobile security solutions such as Trend Micro™ Mobile Security blocks threats](https://blog.trendmicro.com/en_us/forHome/products/mobile-security.html)\n[from app stores before they can be installed and cause damage to devices, while Trend Micro™ Maximum Security](https://blog.trendmicro.com/en_us/forHome/products/maximum-security.html)\noffers in-depth protection for multiple devices and proactively secures them from the threat of ransomware.\n\n**Indicators of Compromise (IOCS)**\n\n**SHA256** **Package** **Application**\n**Name**\n\n200d8f98c326fc65f3a11dc5ff1951051c12991cc0996273eeb9b71b27bc294d com.android.tencent.zdevs.bah 王者荣耀辅\n助\n\n2ffd539d462847bebcdff658a83f74ca7f039946bbc6c6247be2fc62dc0e4060 com.android.tencent.zdevs.bah 千变语音\n\n36f40d5a11d886a2280c57859cd5f22de2d78c87dcdb52ea601089745eeee494 com.android.tencent.zdevs.bah 王者荣耀前\n瞻版\n\nc347e09b1489c5b8061828526f4ce778fda8ef7fb835255914eb3c9268a265bf com.android.tencent.zdevs.bah 千变语音秀\n\ncb0a18bcc8a2c9a966d3f585771db8b2e627a7b4427a889191a93b3a1b261ba3 com.android.tencent.zdevs.bah 主流影视大\n全\n\nRansomware\n\nA new variant of mobile ransomware SLocker was detected. It copies the GUI of the now-infamous WannaCry. It's one of the\nfirst Android file-encrypting ransomware, and the first mobile ransomware to capitalize on the success of the WannaCry\noutbreak.\n\nBy: Ford Quin July 05, 2017 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-05 - SLocker Mobile Ransomware Starts Mimicking WannaCry.pdf"
    ],
    "report_names": [
        "2017-07-05 - SLocker Mobile Ransomware Starts Mimicking WannaCry.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536005,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653774881,
    "ts_modification_date": 1653774881,
    "files": {
        "pdf": "https://archive.orkl.eu/8a0b0e9670668478c4961bfa1aaecc3ea02499f9.pdf",
        "text": "https://archive.orkl.eu/8a0b0e9670668478c4961bfa1aaecc3ea02499f9.txt",
        "img": "https://archive.orkl.eu/8a0b0e9670668478c4961bfa1aaecc3ea02499f9.jpg"
    }
}