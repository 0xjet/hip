{
    "id": "c82b306a-b299-4c7b-a54d-5bff13f92d14",
    "created_at": "2022-10-25T16:48:19.451223Z",
    "updated_at": "2025-03-27T02:16:01.231188Z",
    "deleted_at": null,
    "sha1_hash": "d0ab502c7274156985846d347de606106a649644",
    "title": "MacProStorage-T3:4Work:Bitdefender-WhitePaper-RDPA-CREA4155-en_EN:Bitdefender-WhitePaper-RDPA-CREA4155-en_EN.indd",
    "authors": "",
    "file_creation_date": "2019-12-18T12:17:26Z",
    "file_modification_date": "2019-12-18T12:17:32Z",
    "file_size": 2962023,
    "plain_text": "# RDP Abuse and Swiss Army Knife Tool Used to Pillage, Encrypt and Manipulate Data\n\n\n-----\n\nWhite Paper\n\n## Contents\n\nExecutive Summary........................................................................................................................................................... 3\n\nKey Findings...................................................................................................................................................................... 3\n\nInfection Vector ............................................................................................................................................................... 4\n\nWorker.exe Component – A Swiss Army Knife for Threat Actors....................................................................................... 4\n\nClipboard stealer payloads ............................................................................................................................................... 6\n\nMicroClip ...........................................................................................................................................................................................6\n\nDelphiStealer ....................................................................................................................................................................................7\n\nIntelRapid ..........................................................................................................................................................................................7\n\nAttributing off the shelf tools to the same actor ............................................................................................................... 9\n\nCryptocurrency stealer campaign earnings ...................................................................................................................... 9\n\nRansomware payloads ...................................................................................................................................................... 9\n\nMiner payloads ............................................................................................................................................................... 10\n\nAZORult payloads ........................................................................................................................................................... 12\n\nPayload Evolution & Victims ........................................................................................................................................... 12\n\nRecommendations .......................................................................................................................................................... 15\n\nTactics, Techniques and Procedures (TTP) ..................................................................................................................... 15\n\nIndicators of Compromise............................................................................................................................................... 17\n\nHashes............................................................................................................................................................................................ 17\n\nNetwork indicators........................................................................................................................................................................20\n\nWindows Scheduled Tasks..........................................................................................................................................................20\n\nRegistry locations.........................................................................................................................................................................20\n\n**Authors:**\n\nEduard BUDACA - Security Researcher\n\nVictor VRABIE - Security Researcher\n\n**Co-Authors:**\n\nCristina VATAMANU - Senior Team Lead, Cyber Threat Intelligence Lab\n\nAlexandru MAXIMCIUC - Team Lead, Cyber Threat Intelligence Lab\n\n\n-----\n\nWhite Paper\n\n## Executive Summary\n\nBitdefender researchers recently found threat actors abusing a legitimate feature in the RDP service to act as a fileless attack\ntechnique, dropping a multi-purpose off-the-shelf tool for device fingerprinting and for planting malware payloads ranging from\nransomware and cryptocurrency miners to information and clipboard stealers.\n\nThe attack vector involves the Windows Remote Desktop Server. The RDP client has the ability to share a drive letter on their\n\nmachine, which acts as a resource on the local virtual network. Attackers were able to use the shared directory as a very simple\ndata exfiltration mechanism over the RDP protocol. By using an off-the-shelf component placed on the “tsclient[1]” (Terminal Server\nClient) network location, attackers could execute it using either “explorer.exe” or “cmd.exe” and use it to download additional\nmalware.\n\nThe “worker.exe” component provides a vast array of capabilities, mainly for data gathering. It features capabilities ranging\n\nfrom collecting system information (e.g. architecture, CPU model and core count, RAM size, Windows version etc.) to taking\nscreenshots, collecting the victim’s IP address and domain name, pulling information about default browsers and specific open\nports, and even anti-forensic and detection evasion commands.\n\nThe tool has been found in various campaigns – analyzed below in this paper - potentially associated with one or more\n\ncybercriminals or cybercriminal groups, delivering at least three distinct generations of clipboard stealers, ransomware (Rapid\nRansomware and Nemty ransomware), Monero cryptocurrency miners, and a highly popular Trojan stealer (AZORult).\n\nThe campaigns do not seem to target specific industries or companies; instead, threat actors have used a shotgun approach,\n\nfocusing on reaching as many victims as possible. In terms of financial impact, estimated cryptocurrency earnings based on the\ncryptocurrency wallets found indicate attackers have netted at least $150,000 through some of their campaigns.\n\n## Key Findings\n\n   - RDP abuse to exfiltrate data through network shares\n\n   - Off-the-shelf multi-purpose tool used to screen victims and drop malicious payloads (ransomware, clipboard stealers,\ncryptocurrency miners and info-stealer Trojans)\n\n   - Ready-made ransomware families used as payload (Rapid Ransomware and Nemty)\n\n   - Clipboard stealers replace cryptocurrency addresses with one that belongs to attackers\n\n   - More than $150,000 in cryptocurrency earnings (22.604 BTC, 25.098 ETH, 13.846 DASH and 1.329 LTC), excluding\nMonero.\n\n\n-----\n\nWhite Paper\n\n## Infection Vector \n\nThe infection mechanism is an interesting one, as the attackers used a technique considered fileless from a disk forensics\n\nstandpoint. They used a feature of the Windows Remote Desktop Server in which the RDP client can share a drive letter on their\nmachine, which appears on the server as a share on a virtual network location named “tsclient”. For example, if the client shares\ntheir C: drive (Fig. 1), the files inside will be available in a directory at \\\\tsclient\\c (the single letter directory name is the drive\nletter shared). These shares are both readable and writable, making for a very simple data exfiltration mechanism over the RDP\nprotocol, a common use case for most threat actors.\n\nAdditionally, since Remote Desktop is a built-in feature of most Windows installations (except for limited “Home” Windows\nversions), its file-sharing functionality is built in as well, both contributing to its appeal as an infection vector, while being\nencrypted by default and evading behavior detection.\n\nInterestingly, the limitation of sharing just drive letters is only present in the Remote Desktop client, and not the server. Custom\nRDP clients can share any directory, which will appear as a share on the “tsclient” virtual network location that has a name\nnot limited to a single letter. From what we have seen in our telemetry, these attackers prefer using these kinds of paths, with\nmultiple-letter directory names.\n\nFig 1. Example of a drive shared over RDP, as seen in this PC under Windows 10\n\n(named [drive letter] on [client machine name])\n\nAnalyzing our telemetry, we saw that the main malicious component of this attack, named **_worker.exe, was located on what_**\nappears to be a network share on the “tsclient” network location and was executed by either explorer.exe or cmd.exe. That allows\nus to say with a high degree of confidence that this attacker controls the victims’ machines using the Remote Desktop Protocol.\nHowever, this usually requires the attackers to possess valid credentials to access these machines, and we can only speculate\nas to how the credentials were acquired. Existing cyber security literature seems to link both worker.exe infections and some\nexploitation components used by this attacker (for example, Rapid Ransomware) with RDP bruteforcing, but we have found no\nevidence of this.\n\nIt is important to note that the use of worker.exe does not necessarily indicate an attack by this specific threat actor, as others\nhave used it as well in campaigns distributing SamSam and Dharma ransomware, according to security researchers.\n\n## Worker.exe Component – A Swiss Army\n Knife for Threat Actors\n\nThis component is usually the first executed once a machine is infected. It is located in a “tsclient” share next to a text file\n\nnamed “config.ins” (Fig. 2). These samples do not use C&C servers; instead, communication with the threat actors occurs\nthrough the config.ins file, from which a list of commands is read and executed. The output of these commands is written\nto a .nfo file (Fig. 3), with a filename taken from the first command line argument (in our telemetry, this was the victim’s IP\naddress, used as an identifier). In addition, commands can write files with a name derived from the same identifier. At the end\nof execution, this module, worker.exe, writes an empty file, its name being the same identifier without extensions, to signal that\nit has finished processing the commands and writing the output. These files are written next to the worker.exe sample. This is\nvery convenient, as writing files to the tsclient share is the precise data exfiltration mechanism of choice for this attack, which\nmakes it fileless (from a forensic point of view) as well. This might indicate that the worker.exe component was purposely built\n\n\n-----\n\nWhite Paper\n\nThis component provides a vast array of commands that can be contained in the config.ins file, mainly for data gathering,\n\nbut also providing one command to execute batch or JavaScript files. These commands are in plain text, one per line, with\narguments separated by commas. Information that worker.exe can gather includes:\n\n   - System information: architecture, CPU model and core count, RAM size, Windows version\n\n   - Domain name, whether the user is a local administrator or not, a list of all users on the machine\n\n   - Local IP address, upload and download speed, public IP information as returned by the http://www.ip-score.com/\nservice\n\n   - Default browser, whether specific ports are open on this machine (whether a server is running, listening on that port),\nwhether specific entries exist in the machine’s DNS cache (whether the machine has recently tried to connect to a\nspecific domain, regardless of whether it was found or not)\n\n   - Screenshots\n\n   - Whether a certain process is running, whether specific keys and values in the registry exist, whether specific files or\ndirectories exist, listing all remote drives (connected network shares with a drive letter assigned)\n\nA final command has an anti-forensic and detection-evasion purpose, allowing the attackers to clear the MRUList entry in the\n```\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU registry key,\n\n```\nwhich contains the Run dialog’s history. This indicates that the attackers may use this dialog during Remote Desktop sessions\nand wish to hide the executed commands.\n\nFig 2. An example of a valid config.ins file (based on reverse engineering process)\n\nFig 3. A *.nfo output file for the config.ins input above\n\nSome of the commands supported by this component are specific to a fingerprinting operation. Screening the victims is useful\n\n\n-----\n\nWhite Paper\n\nFor instance, if the victim belongs to a certain domain, the attacker can conclude that the infected system is a part of an\nenterprise network. This means that delivering a ransom payload would benefit them more. However, if the account has admin\nprivileges, they can perform certain actions such as privilege escalation, which can lead to service installation, task creation and\nso on.\n\nSince this component is an off-the-shelf tool, an actor can choose which functionalities from the whole package to actually use\nin their attack.\n\nOur telemetry shows that the worker.exe component has been used since February 2018. From the beginning, this tool was\nemployed, presumably after some data gathering, to run at least three types of malicious programs: Monero miners, ransomware,\nand clipboard stealers (replacing cryptocurrency addresses in the Windows clipboard with one of the attacker’s). Starting in July\nof 2018, we have also seen the AZORult information stealer deployed by the worker.exe component.\n\nAlmost all files we saw during this investigation, both worker.exe and additional components, used the same packer. Unpacking\n\nthem reveals many repeated payloads, which indicates that the attackers sometimes re-packed payloads to escape detection.\nIn some cases, a component had two or more layers of packing applied.\n\n## Clipboard stealer payloads\n\nThe purpose of these payloads is to exploit the way in which cryptocurrency payments are made, in order to divert funds to the\n\nattackers. Since the payment addresses for these cryptocurrency schemes are difficult to type, they are copied to the relevant\nfields in transaction forms through the clipboard. A malicious program can monitor the clipboard for strings of text that resemble\na cryptocurrency address, and, on a match, replace that string with another address that belongs to the attacker.\n\nThree distinct generations of clipboard stealers have been identified:\n\n### MicroClip\n\nThis component seems to have been written in the C++ programming language. It can identify and replace Bitcoin, Ethereum,\n\nMonero and Litecoin addresses in the clipboard, using regular expressions.\n\nThe addresses stored in place are contained in a stringtable resource, encrypted with a SUB 3 operation, one address per\n\ncryptocurrency scheme (Fig. 4). It achieves persistence only if a fifth entry in the stringtable has the value “y”. If so, it copies itself\nto the user’s Application Data directory, in a directory with a name derived from the serial number of the volume where Windows\nis installed, as “svchost.exe”, adds that file to the user’s Run key, with the same name as the directory mentioned above, executes\nits copy, and shuts down. As a measure against one of Windows’ threat protection systems, this component deletes the “Zone.\nIdentifier” alternate data stream of the “svchost.exe” copy before executing it.\n\nFig 4. An example of a MicroClip stringtable resource\n\nThe name comes from two in-the-wild filenames, “MicroClipV.exe” and “MicroClipV3.exe”. Most filenames, however, read like\n\nkeyboard mashing and were presumably intended to be understood only by the attackers (such as “cllipp998565.exe”, “05gold445.\nexe”, “taxi699.exe”). This component was actively spread by worker.exe between June and October 2018.\n\nDuring our investigation, we were able to find a sample of the builder for this generation of clipboard stealers. It simply reads four\n\n\n-----\n\nWhite Paper\n\none named “build_yes_startup.exe” and one named “build_no_startup.exe”. Then, the builder configures them by updating\ntheir stringtable resource with the supplied addresses, as well as the value “y” or “n”, depending on whether the MicroClip build is\nconfigured to install persistence or not. Finally, the builder contains the e-mail address of its developer, and it can itself be found\nfor sale on dedicated forums, which makes MicroClip an off-the-shelf tool.\n\n### DelphiStealer\n\nThis generation of clipboard stealers is written in the Delphi programming language. It does not use regular expressions, instead\n\nmanually splitting the keyboard contents by spaces and checking the length of split tokens and a scheme-specific prefix. It only\nsupports Bitcoin (prefix “1” or “3”) or Ethereum (prefix “0x”) stealing (Fig. 5). The replacement addresses, one for each scheme,\nare hardcoded strings in the binary, encrypted with a SUB 0x6A operation. If a third fill-in-the-blanks string in the binary starts\nwith a “C” character (as was the case in around two-thirds of the samples we saw), this component installs its persistence: the\nbinary sets itself to the current user’s Run key, named “12365435”.\n\nFig 5. DelphiStealer’s heuristics for detecting cryptocurrency addresses\n\nIn our telemetry, the filenames the attackers used for this component were variations of “winlogon.exe” (such as “winlodin.\nexe”, “winlogon64.exe”, “winlogin.exe”) in the Application Data directory, which is a form of masquerading (ATT&CK Technique\nT1036). This component was actively spread by worker.exe between November 2018 and May 2019, with a brief resurgence in\n\nSeptember 2019.\n\nIn some respects, this generation is a downgrade from MicroClip, which supported Monero and Litecoin in addition to Bitcoin\nand Ethereum and used a more robust method of identifying target addresses in the clipboard (the Delphi component can only\nfind addresses separated by spaces). This change may have meant to evade detection, at the cost of lower earnings.\n\n### IntelRapid\n\nThis third and final generation of cryptocurrency stealers seems to be written again in the C++ programming language but appears\n\nto have a different code-writing style from the previously mentioned stealers. Some details are much more carefully designed,\nleading us to believe that this component has a different author than the previous two. The code is also heavily obfuscated\nusing numerous layers of virtual calls, which makes reverse engineering difficult. This generation supports a much wider range\nof cryptocurrency schemes: Bitcoin, Litecoin, Ethereum, Monero, Bitcoin Cash, Dash, Ripple, Dogecoin, Neo, and ZCash. The\nencryption and storage of addresses has been overhauled: each scheme has a PE resource of a custom type (“DATABASE”),\nencrypted with a hardcoded translation table. However, this makes the resources easy to decrypt, since the translation table\nconsists of 256 distinct, continuous bytes in the binary, which are easy to find.\n\nThis component creates a tray window (named “IntelRapidTray”) to be able to intercept the clipboard. When the user copies some\n\ntext, IntelRapid splits it on a predefined list of separators (all kinds of brackets, whitespace, colon, or equals characters) then\ntries to match each token to a cryptocurrency scheme, using a set of rules based on token length, character sets and prefixes.\n\nOn a match, this component tries to find the best of many addresses in that scheme (sometimes exceeding 1,300, as is the\ncase for a sample’s Bitcoin set) as a replacement. It does this by using a complex scoring mechanism that looks for similarities\nbetween the original address and the new one, such as a common prefix, a common suffix or similar-looking characters in close\n\n\n-----\n\nWhite Paper\n\npositions.\n\nTo show an example of this algorithm’s output, we created Table 1 based on the replacements of one of the IntelRapid samples.\n\nOriginal address Coin Replaced address Matching\n\nrule\n\n**3Cd4t2kyPBt4LNk7YXJSQBHriH2v3rXN2E** BTC **3Cd4vNgjWvukvwgxJ7C8n8mKoBiFoXXucq** Prefix\n\n113TsCxFV9JejtMNfdvVpatQSfvMAn3HFZ BTC 3GbzsfYZ5vkY44uGyr4EpVjfpiJJH93HFZ Suffix\n\n1256t2kyPBt4LXk7YXJSQkHriH2v3rXN2E BTC 3JQkgwbKnNDBzcvDpt8W6bxKioqNXQQh2E Suffix\n\n**0x58F1812D85E8396E48592A0E175CEf8a8e89Bf5C** ETH **0x50d9B28510D2Eb442b1716067f9ebBAb1732A055** Prefix\n\n**0x22A4414492071173Dcd9163701a8Edd3Ae673D2A** ETH **0x2FA984ed7762942a34695Cc0B1713670D3A9cB57** Prefix\n\n**0x99b500f473b321ea892617f6b3e9c0880078adaf** ETH **0x9ab12bf9c341c6ba690c8416ceb4f2f8f92afb6f** Prefix\n\n**4Ad8uTQvA7ihvoJv3H7AccUSYpjE9743C5RsjCjsn9cX­** XMR **4AxuhPR6PBJeZcmfxyxyy8SNkSHbF72qiJCQSBx­** Prefix\n\ndKTBt4YkRL4Wrvo5BZ57f3jRjsoGZ8QN59NfjQJrmoWA­ jaf9gDk9idv6bQv5ifJkhM98qPSKGmgJnbfrGXCYH­\n5HiCqGe vmF2cBX8693EEQ1\n\n**48zNHjHYcBq3tL5mFTouT4W85gqZVoCXTNheWFNPrvm­** XMR **48tdP3WtHzW5KL3C36iUHXNbQ6CoLYUfyGHyz4eH­** Prefix\n\nv7ThdV9qb115fWs3WrKjQ62WRN2ekWcsYAc8TpmmK­ 39BeTof135GXmQDf1q1g5UwtuWPeRWPb5pZmLLT­\nC1Ag7Sn9USb kyQ1saz1BArFZtKB\n\n**48xKLsuYBUYbAEwyLKfY5cBWSmJ3L72PUH5YaGSZQb­** XMR **48tdP3WtHzW5KL3C36iUHXNbQ6CoLYUfyGHyz4eH­** Prefix\n\nKmLVYmKdHYBvxGW2kFQBVHMrFgN4MPVqPUoRizWwAW­ 39BeTof135GXmQDf1q1g5UwtuWPeRWPb5pZmLLT­\nJSv5VRCvrWG kyQ1saz1BArFZtKB\n\nTable 1. Example of IntelRapid address replacement algorithm.\nNote how different addresses in the same cryptocurrency scheme are replaced with different addresses, depending on matching characters.\n\nThis generation achieves persistence by copying itself to “Application Data\\Roaming\\Intel Rapid\\IntelRapid.exe” in the current\n\nuser’s directory and adding itself both as an “Intel Rapid” scheduled task and as a “IntelRapid.lnk” shortcut in the user’s Startup\ndirectory of the Start menu. After this component installs itself (on the first run), it runs the new copy and exits.\n\nIntelRapid uses a “{37529D08-A67E-40B3-B0F2-EB87331B47F5}” mutex to ensure only one instance of itself is running.\nInterestingly, the cryptocurrency stealing routines will not run if a Russian or Ukrainian keyboard is installed on the machine,\nwhich seems to be common practice for threats developed by Russian-speaking actors.\n\nThroughout the infection campaign, this component has repeatedly changed its filenames and other names used for persistence.\n“IntelRapid.exe” is not the first filename chronologically, but it is the first recognizable identity that is has assumed. Other\n\nfilenames used include (in chronological order) “wmphostk.exe”, “wmpl.exe”, “windowsmediaplayer32.exe”, “IntelRapid32.\nexe”, “WindowsLogonApplication64.exe”, and more recently (since mid-August 2019) “RealtekDSb.exe”, “RealSoundHelp.exe”\nand “UtilityService.exe”. Other user-visible names (directories, scheduled task names) are changed accordingly, for example to\n“Windows Logon Application 64”, “Realtek Sound Blaster Driver”, “Realtek Sound Help” or “Utility Service”.\n\nThis component was actively spread in April and May 2019, with a small number of infections after August the same year.\n\n|Original address|Coin|Replaced address|Matching rule|\n|---|---|---|---|\n|3Cd4t2kyPBt4LNk7YXJSQBHriH2v3rXN2E|BTC|3Cd4vNgjWvukvwgxJ7C8n8mKoBiFoXXucq|Prefix|\n|113TsCxFV9JejtMNfdvVpatQSfvMAn3HFZ|BTC|3GbzsfYZ5vkY44uGyr4EpVjfpiJJH93HFZ|Suffix|\n|1256t2kyPBt4LXk7YXJSQkHriH2v3rXN2E|BTC|3JQkgwbKnNDBzcvDpt8W6bxKioqNXQQh2E|Suffix|\n|0x58F1812D85E8396E48592A0E175CEf8a8e89Bf5C|ETH|0x50d9B28510D2Eb442b1716067f9ebBAb1732A055|Prefix|\n|0x22A4414492071173Dcd9163701a8Edd3Ae673D2A|ETH|0x2FA984ed7762942a34695Cc0B1713670D3A9cB57|Prefix|\n|0x99b500f473b321ea892617f6b3e9c0880078adaf|ETH|0x9ab12bf9c341c6ba690c8416ceb4f2f8f92afb6f|Prefix|\n|4Ad8uTQvA7ihvoJv3H7AccUSYpjE9743C5RsjCjsn9cX­ dKTBt4YkRL4Wrvo5BZ57f3jRjsoGZ8QN59NfjQJrmoWA­ 5HiCqGe|XMR|4AxuhPR6PBJeZcmfxyxyy8SNkSHbF72qiJCQSBx­ jaf9gDk9idv6bQv5ifJkhM98qPSKGmgJnbfrGXCYH­ vmF2cBX8693EEQ1|Prefix|\n|48zNHjHYcBq3tL5mFTouT4W85gqZVoCXTNheWFNPrvm­ v7ThdV9qb115fWs3WrKjQ62WRN2ekWcsYAc8TpmmK­ C1Ag7Sn9USb|XMR|48tdP3WtHzW5KL3C36iUHXNbQ6CoLYUfyGHyz4eH­ 39BeTof135GXmQDf1q1g5UwtuWPeRWPb5pZmLLT­ kyQ1saz1BArFZtKB|Prefix|\n|48xKLsuYBUYbAEwyLKfY5cBWSmJ3L72PUH5YaGSZQb­ KmLVYmKdHYBvxGW2kFQBVHMrFgN4MPVqPUoRizWwAW­ JSv5VRCvrWG|XMR|48tdP3WtHzW5KL3C36iUHXNbQ6CoLYUfyGHyz4eH­ 39BeTof135GXmQDf1q1g5UwtuWPeRWPb5pZmLLT­ kyQ1saz1BArFZtKB|Prefix|\n\n\n-----\n\nWhite Paper\n\n## Attributing off the shelf tools to the same\n actor\n\nOne important step in our investigation was to expand our sample set and to find similar files for the tools spotted in the first\nstage of the investigation. Since we saw that these attackers use off-the-shelf tools, like the worker.exe component, we wanted\nto make sure that we consider only similar files that are linked to this threat actor in our understanding of the campaigns.\n\nA near-certain indicator of attribution for cryptocurrency stealers is the set of replacement addresses, since it would make little\nsense for an attacker to direct stolen cryptocurrency to an account different than their own.\n\nTo do that, we gathered as many samples as we could of MicroClip, the Delphi stealer, and IntelRapid, then extracted their\n\naddresses and clustered them: if two samples share an address, they belong to the same cluster. This produced interesting\nresults: Most MicroClip and all Delphi stealer samples ended up in the same cluster (“the main cluster” from now on), along with\nseveral IntelRapid binaries.\n\nWhen trying to establish a connection in our telemetry between these samples and the main component, worker.exe, most of\nthose in the main cluster were seen shortly after - or even executed by - a “worker.exe” sample. None of the samples belonging\nto other clusters had any such connection. So, connecting the worker.exe component to the spreading of these cryptocurrency\nstealers is enforced by these observations.\n\nAfter we produced a set of samples known to be linked to the same attacker, we could connect other malicious components\n\nto it: the ransomware, Monero miner and AZORult attacks linked with worker.exe often happened very soon before or after a\ncryptocurrency stealer sample was deployed. Miners are even more connected; the mining of Monero occurs for many of the\nwallets found in the main cluster.\n\n## Cryptocurrency stealer campaign earnings\n\nAfter building a set of samples in the main cluster, we gathered their replacement addresses and scanned the ledgers for\n\ntransactions involving them. Most addresses never received any cryptocurrency, and many, if not all, were routinely emptied\nof all funds and had a balance of zero. Out of the ten cryptocurrency schemes, only four had received funds (and Monero is by\ndesign untraceable): as of the time of writing, (rounded to three decimal places) 22.604 BTC, 25.098 ETH, 13.846 DASH and\n1.329 LTC. To estimate a dollar value for this currency, we used the value of these currencies on the median day of infection in our\n\ntelemetry: the 29th of November 2018. This would put the earnings around $152,500. (Note that Monero could not be included\nin this estimate.)\n\n## Ransomware payloads\n\nStarting around April 2018 (according to our telemetry), these attackers started deploying ransomware to their victims. We’ve\nseen two families being used: Rapid Ransomware and Nemty, both of which seem to be off-the-shelf tools for threat actors.\nMost of these samples we saw are packed in the same way as worker.exe and MicroClip, some under up to three layers.\n\nRapid Ransomware encrypts files using a different AES-256 key for each file, in Cipher Block Chaining (CBC) mode. This key is\nbacked up in the file, encrypted with a per-machine RSA key, the private key of which is also backed up in the file, encrypted with\nthe attacker’s public RSA key. Before running, Rapid Ransomware deletes shadow copies and disables Windows’ Automatic\nRepair startup utility. For persistence, these samples use both the Run registry key and scheduled tasks. No keys, or any other\ninformation, are transmitted to the attacker’s servers, (except for, possibly, an encrypted file sent by the victims) so a decryptor\nmost likely contains the per-machine private RSA key, obtained from the files sent by the victims.\n\n\n-----\n\nWhite Paper\n\nThis ransomware comes in two versions; one known as “Rapid” and the other as “Rapid 2.0”. They share many similarities, but\n\nthe second brings some improvements, such as the file extension being random (the first version had hardcoded file extensions,\n“.rapid” or “.no_more_ransom” depending on sample). In addition, the encryption algorithm was changed to AES-256 in Cipher\n\nFeedback (CFB) mode, the file reading and writing was tweaked to use memory mappings for improved performance, the builds\ncan be configured with different e-mail addresses or RSA keys by changing a “.cfg” PE section, and more. However, only the first\nversion is configured to exit in case the user’s preferred date, time and number format is configured to Russian.\n\nUnfortunately, the ransom notes (Fig. 6) produced by these samples only contain two email addresses that a victim should\ncontact, so there is no way for us to track ransom payments or connect these samples with the clipboard stealers or miners\nthrough cryptocurrency addresses. However, we can connect ransomware samples between themselves using overlap in the\ne-mail addresses contained in the ransom notes, and we could establish their connection with worker.exe and other payloads\nusing our telemetry.\n\nFig 6. Ransom note from one of the Rapid Ransomware samples\n\nAnother ransomware that these attackers deployed on the victims’ computers was Nemty. Existing cybersecurity literature\nalready covers it extensively, so we will not dive into its inner workings. As with Rapid Ransomware, we cannot connect it with\n“worker.exe” and other payloads using cryptocurrency addresses, since the ransom notes only mention a “.onion” URL and an\n\nidentifying key. However, we are able to make a firm connection based on filenames found in our telemetry.\n\nIn an interesting case we found on one of the victims’ computers, the attackers deployed clipboard cryptocurrency stealers and a\nransomware sample at the same time. In this situation, if the victim pays the ransom, the address to which the ransom is wired\nis replaced by the clipboard stealer. There are some theories of why the attacker acts in this manner. If no cryptocurrency could\nbe retrieved through the clipboard stealer, by deploying the ransomware the attacker would force the victim to buy virtual coins.\n\nNow, if the same attacker deploys the ransomware, the money will be received either through the ransomware or through the\nclipboard stealer. But, if the attacker made use of ransomware from the wild, when the ransom is wired, the addresses are\nchanged, and the money will be received by this attacker and not the author of the ransomware. There is also the possibility of\ntrying to extort more money from the victim. If the transfer is redirected, the attacker can claim (and in some cases demonstrate)\nthat they did not receive the money, forcing the victim to send more cryptocurrency.\n\n## Miner payloads\n\nOne of the first means of extracting some financial gain used by these attackers is the deployment of cryptocurrency miners,\nalmost exclusively for Monero. Using the addresses obtained from the clustering mentioned earlier, we can also attribute miner\nsamples we’ve seen in our telemetry to the same actor.\n\nUsing this information, we were able to track this attacker to a point before they started using the worker.exe tool. The oldest\nsample we could find was first seen in our telemetry in July 2017, and distribution tapered off at the start of 2019.\n\nAll miner samples are based on the often-abused XMRig suite. However, comparing different builds among themselves, we can\nsee significant variation in the way these samples masquerade, or not, as different legitimate tools and different techniques that\nare used:\n\n   - Most samples connect to a public Monero mining pool, where they provide a hardcoded address to work for (Fig. 7), and,\nin a few cases, log in to an account with an e-mail address. However, some connect to an IP address (46[.]21.147.75),\nand others to a domain resolving to this address, (workpc[.]biz). In March 2018, a different sample appeared that mined\nfor a SumoCoin address. Both Monero and SumoCoin are untraceable by design, which unfortunately leaves us unable\nt ti t i f th i i ti\n\n\n-----\n\nWhite Paper\n\n   - While initial miner samples relied on the infection vector or deployment mechanism (such as droppers or downloaders,\nalthough these were rarely used) to ensure persistence, many samples were programmed with different techniques\nstarting in October 2017. For instance, they add themselves to the user’s Run or RunOnce keys (with a wide range of\npossible names), one file copies itself to the Startup directory in the user’s Start Menu, and one used Scheduled Tasks.\nDepending on the infection vector, the samples are usually copied to a new directory inside Application Data\\Roaming\n(again, with a wide range of possible names).\n\n   - One method the attackers used to conceal the purpose of these samples is altering their version information resource,\nwhich can be checked by inquisitive victims in the file’s properties. As expected, the replacement information refers\nto Microsoft services, drivers, legitimate Windows binaries like rdpclip.exe (the RDP Clipboard Monitor), utilities like\nMicrosoft Office Word, and others. However, sometimes not all version information is cleared: some files masquerading\nas rdpclip.exe still have the OriginalFilename field set to “xmrig.exe”.\n\n   - Some changes made by the threat actors to disguise miner samples as seemingly legitimate tools include things that\nwould not normally be observed by victims. For instance, the output of some XMRig command-line options, like the\nusage information (accessible by running xmrig.exe --help) or version information (accessible by running xmrig.\n```\n    exe --version) is altered, changing the name of the tool with strings like “Microsoft server”, “Microsoft”, “FileSys”,\n\n```\n“RdpClip”, “Microsoft Office Word”, or “Microsoft Office”.\n\n   - Another difference between the samples we have seen is a side effect of the way most samples hardcode the mining\n\npool URLs and addresses: the XMRig source code is edited to pass a different list of arguments to its command-line\nparsing routine (Fig. 7). By convention, the first argument (at index zero) is the name of the executable (more exactly,\nthe name that was used to find the executable). As far as we have been able to determine, XMRig does not meaningfully\nuse it in any way, which leaves the choice of this argument purely meaningless. However, these attackers have set it,\nacross different samples, to values like “xmmon”, “xmig”, “WmiPrvSE”, “roop”, “maseee”, “visit”, or simply “xmrig”.\n\n   - Finally, some samples have some special functionality: one miner we saw between December 2017 and June 2018 also\nreplaces Monero and Bitcoin addresses found in the clipboard.\n\nAt the height of the mining operation, around March 2018, this attacker used at least 13 different combinations of the features\nabove, at the same time.\n\nFig 7. Comparison of main function in one of the modified XMRig samples (top left) and official XMRig source code (bottom). Note how,\ninstead of passing the command-line arguments (”argc” for argument count and ”argv” for argument values), the malicious build passes a\n\nconstant length (8) and a hardcoded list of values (pictured top right, with string contents in grey).\n\nSome miner samples we saw were in fact droppers that contain a build of XMRig without a hardcoded destination address,\nreceiving it instead via the command line, a separate runner binary embedded in the dropper, or the dropper itself. Apart from\ndeploying these executables, the dropper also installs their persistence mechanisms (copies itself and the embedded binaries to\nthe Application Data directory and adds itself either as a scheduled task or a Run entry in the registry). Also, one miner sample\nwe saw was brought to the system by a binary similar to other droppers used by this attacker. In this particular case, the binary\ndownloads the miner, instead of dropping it from a resource.\n\nAn additional feature of some of the dropper samples we saw was a mechanism of privilege escalation by exploiting the\nWindows Event Viewer. On startup, this legitimate tool needs to open a .msc file, whose default handler application is defined\nin HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\mscfile\\shell\\open\\command, which cannot be edited\nwithout Administrator privileges. However, that handler can also be configured in the user-specific HKEY_CURRENT_USER\\\n##### SOFTWARE\\Classes\\mscfile\\shell\\open\\command, which can in fact be edited without any special rights. Since\nunder default settings the Windows Event Viewer bypasses User Account Control without any user prompt, and the .msc file\n\n\n-----\n\nWhite Paper\n\ncan control (either its own filename, the miner’s, or the runner’s) and run eventwvr.exe (the Event Viewer). That utility will, in turn,\nstart the malicious handler with administrator rights and then silently crash, thus stealthily achieving privilege escalation. While\nthis technique does not succeed in the newest versions of Windows, it can be used to great effect on unpatched systems.\n\n## AZORult payloads\n\nIn July 2019, the attackers started deploying [AZORult for easier, in-the-loop control of victims’ computers. As extensively](https://labs.bitdefender.com/2019/10/a-close-look-at-fallout-exploit-kit-and-raccoon-stealer/)\nmentioned in the existing cybersecurity literature, this is a stealer trojan that can also be used for basic remote control. The\ndifference from the way worker.exe is used is that, while the latter runs a static script-like file, AZORult gets its commands from\na C&C server.\n\nIn our telemetry, we’ve only seen AZORult as a parent process to MicroClip and ransomware samples. We can assume it was\nused for system discovery, as we have seen these attackers deploy different payloads on different machines, but we can only\nspeculate on whether it was used for purposes like credential stealing. It is well connected to the main cluster, as we have seen\nit being executed by “worker.exe”, located next to cryptocurrency stealer samples with timestamps close to each other, and also\nused to start known ransomware samples, and possibly more. In addition, the C&C server of one of the AZORult samples has\nbeen seen hosting a MicroClip sample belonging to the main cluster. As with most tools used by this attacker, the samples are\nusually packed in a similar way.\n\n## Payload Evolution & Victims\n\nWhile victims are relatively distributed across the world (Fig. 8), most of them are located in Brazil, the United States and\nRomania. From our telemetry, these campaigns do not seem to target specific industries, instead trying to reach as many\nvictims as possible.\n\nFig 8. Global distribution of payloads\n\nSince this actor stands out through the wide-ranging use of different tools and payloads, we were curious to see if we can\ndistinguish a trend in their usage, or if the actor prefers one instead of others. As a result, we decided to generate a chart\nillustrating the evolution for all worker.exe payloads (Fig. 9).\n\nThe data was obtained from reports in our telemetry of the samples we can confidently link to this attacker, mostly through\n\nconnections to the main cluster. The top plot contains the number of infection reports (a different sample type first seen on\na victim’s machine) per month, and the bottom plot (the rug plot) represents each individual report as a tick, regardless of the\n\n\n-----\n\nWhite Paper\n\nFig 9. Evolution of payload types\n\nFrom this chart, we can see that only miners were used before approximately April 2018, but since then a wide variety of tools\nwere employed, especially until the early months of 2019.\n\nThe AZORult component was only used between July and November of 2018, right until DelphiStealer started being spread. For\n\nzoomed-in versions of this graph for ransomware and clipboard stealer payloads, see figures 10 and 11.\n\nOn this graph, worker.exe came into use (February 2018) at a time of marked decline in miner distribution, possibly as a trial run,\nbefore its usage with serious delivery of other crimeware payloads starting in April.\n\nThe fact that the actor used multiple types of clipboard cryptocurrency stealers always intrigued us. If we zoom the previous\n\nchart and consider only this type of payload (Fig. 10), some interesting observations emerge.\n\nWhile there is some small overlap, we can see that the attackers first distributed MicroClip, until November 2018, then\nDelphiStealer, and, since April 2019, IntelRapid with rare sightings of the other generations.\n\nWe can also see that IntelRapid was distributed much more aggressively, even If, over time, MicroClip seems to have been\nspread to more victims. In this case, the rug plot proves more useful, as we can more clearly approximate when in the month\nthe campaigns occurred (when reading the rug plot, note that the ticks and labels on the bottom of the charts correspond to the\nmiddle of the month).\n\n\n-----\n\nWhite Paper\n\nFig 10. Evolution of cryptocurrency stealer generations\n\nFinally, we zoomed into part of the graph above to study the usage of ransomware by this author. Apart from a month of Nemty\nusage in September 2019, these kinds of payloads were only distributed until December 2018. In addition, the relatively low\nnumber of infections (at least according to our telemetry) show that deploying ransomware was not seen as the main purpose\nof these attacks.\n\nFig 11. Evolution of ransomware usage\n\n\n-----\n\nWhite Paper\n\n## Recommendations\n\nThis final purpose of this complex campaign is to extract virtual currency from victims using multiple types of payloads.\n\nAccording to our telemetry, throughout the attacks, we observed that the campaign does not seem targeted. The threat actors\nseem interested in compromising as many victims as possible since the financial gain is proportional with this number.\n\nThe threat actors have used ingenious techniques and tactics to follow through with the attacks, some of them taking advantage\n\nof misconfigurations or oversights. With the complexity of today‘s environments and because managing such environments can\noften be overwhelming, tracing each aspect that might represent a risk is very difficult, and omission can happen.\n\nThere are lots of aspects to take into consideration when we talk about cyber security, and reviewing these aspects sometimes\n\ncan prevent the success of an attack. For example, if the policy “Do not allow drive redirection”, located in “Computer Configuration\n\n - Administrative Templates > Windows Components > Remote Desktop Services > Remote Desktop Session Host > Device and\nResource Redirection” is enabled, the infection mechanism for this attack can be prevented.\n\nBitdefender has a dedicated project meant to help identify these types of oversights and misconfigurations and to offer suggestions\nfor their remediation so that certain types of TTPs can be prevented and to make risk management more manageable. For more\n[information: https://businessresources.bitdefender.com/endpoint-risk-analytics-endpoint-security-whitepaper](https://businessresources.bitdefender.com/endpoint-risk-analytics-endpoint-security-whitepaper)\n\n## Tactics, Techniques and Procedures (TTP)\n\nThe MITRE ATT&CK matrix provides a mechanism to share TTP indicators used by threat actors from a public knowledge base,\n\nwhere techniques (general ways to achieve goals) are each assigned a unique identifier and attributed to one or more tactics\n(high-level goals). The procedure is the specific description of a way to apply a technique. Below, we have an overview of how the\nabilities and the in-the-wild behavior of these campaigns map onto the ATT&CK matrix:\n\n**Tactic: Initial Access**\n\n**Technique:** _T1078 “Valid Accounts”: Initial access is through Remote Desktop, and existing cybersecurity literature_\n\npoints to the use of RDP bruteforcing.\n\n**Tactic: Execution**\n\n**Technique: T1059 “Command-Line Interface”: We saw worker.exe and payloads being started by cmd.exe, likely during**\na Remote Desktop session.\n**Technique: T1061 “Graphical User Interface”: We saw worker.exe and payloads being started by explorer.exe, likely**\nduring a Remote Desktop session.\n**Technique: T1064 “Scripting”: worker.exe‘s “config.ins” file is essentially a script (a list of instructions to be executed).**\n\n**Tactic: Persistence**\n\n**Technique: T1060 “Registry Run Keys / Startup Folder”: Most samples make themselves persistent by adding**\n\nthemselves to the Run key (miners, ransomware, MicroClip, ClipDelphi) or the Startup directory in the Start Menu\n(IntelRapid, miners).\n**Technique: T1053 “Scheduled Task”: These are also used when enough rights are available to persist IntelRapid,**\n\nRapidRansowmare, or XMRig infections.\n**Technique: T1158 “Hidden Files and Directories”: Some samples install themselves or their payload as hidden files.**\n**Technique: T1078 “Valid Accounts”: Once an attacker uses valid credentials to infect a machine, it can repeat this at**\nany time, unless security measures are applied (firewall, password change).\n\n**Tactic: Privilege Escalation**\n\n**Technique: T1088 “Bypass User Account Control” and T1068 “Exploitation for Privilege Escalation”: A privilege**\nescalation exploit abusing the Windows Event Viewer is employed by some XMRig droppers.\n\n**Tactic: Defense Evasion**\n\n**Technique: T1036 “Masquerading”: Almost all samples hide their purpose through legitimate-sounding filenames,**\n\n\n-----\n\nWhite Paper\n\n**Technique: T1027 “Obfuscated Files or Information”: Many worker.exe and payload samples are packed to make**\n\nreverse engineering more difficult.\n**Technique: T1158 “Hidden Files and Directories”: Some samples install themselves or their payload as hidden files.**\n**Technique: T1107 “File Deletion”: Many payloads delete the original sample after copying it to its preferred persistent**\n\nlocation (for example the Application Data directory).\n**Technique: T1088 “Bypass User Account Control” and T1211 “Exploitation for Defense Evasion”: A privilege escalation**\nexploit abusing the Windows Event Viewer is employed by some XMRig droppers.\n**Technique: T1064 “Scripting”: Using the «config.ins» script, the worker.exe component performs many actions quickly**\nand, by using the Windows API directly, avoids running command-line tools that may trigger defense mechanisms.\n**Technique: T1070 “Indicator Removal on Host” and T1112 “Modify Registry”: worker.exe contains a command that**\ndeletes the Run dialog history.\n\n**Tactic: Credential Access**\n\n**Technique: T1110 “Brute Force”: Existing cybersecurity literature points to compromise by credential bruteforcing**\n\nthrough RDP.\n\n**Tactic: Discovery**\n\n**Technique: T1082 “System Information Discovery” and T1033 “System Owner/User Discovery”: worker.exe›s**\n«information» command lists information like Windows version, architecture, CPU name, the domain of the logged-in\n\nuser and whether they have administrator rights.\n**Technique: T1087 “Account Discovery”: The worker.exe component has a “userenum” command that lists users on the**\n\nlocal system.\n**Technique: T1135 “Network Share Discovery”: The worker.exe component supports a “sharedrive” command that finds**\ndrive letters associated with network shares.\n**Technique: T1012 “Query Registry”: Apart from using the Windows API, the worker.exe component obtains some of its**\n\ninformation using the Windows registry.\n\n**Tactic: Collection**\n\n**Technique: T1113 “Screen Capture”: The worker.exe‘s can take screenshots of the machine if the “scrshoot” command**\n\nis executed.\n\n**Tactic: Command and Control**\n\n**Technique: T1071 “Standard Application Layer Protocol” and T1219 “Remote Access Tools”: Command and Control of**\nworker.exe is done through the Remote Desktop Protocol.\n**Technique: T1105 “Remote File Copy”: Malicious binaries are delivered using RDP‘s built-in “tsclient” virtual host and**\n\nnetwork shares.\n\n**Tactic: Exfiltration**\n\n**Technique: T1041 “Exfiltration Over Command and Control Channel” and T1020 “Automated Exfiltration”: worker.exe‘s**\noutput files are transferred automatically using the “tsclient” virtual network shares over the same RDP connection as\npayload deployment.\n\n**Tactic: Impact**\n\n**Technique: T1496 “Resource Hijacking”: worker.exe also deploys miners that take advantage of the victims‘ resources**\n\nto extract cryptocurrency.\n**Technique: T1492 “Stored Data Manipulation”: Clipboard stealers are also employed, changing cryptocurrency**\naddresses in the clipboard with the attackers’ in the hopes that they will be unknowingly used as a payment recipient.\n**Technique: T1486 “Data Encrypted for Impact” and T1490 “Inhibit System Recovery”: Some of the payloads used by**\n\nthese attackers are ransomware, which encrypt the user’s data until a ransom is paid. To increase the likelihood of\npayments, these samples first delete shadow copies and disable built-in recovery modes.\n\n\n-----\n\nWhite Paper\n\n## Indicators of Compromise\n\nAn up-to-date list of indicators of compromise is available to Bitdefender Advanced Threat Intelligence users. More information\n[about the program is available at https://www.bitdefender.com/oem/advanced-threat-intelligence.html.](https://www.bitdefender.com/oem/advanced-threat-intelligence.html)\n\n### Hashes\n\nThis is a selection of hashes for the files that we encountered over the course of this investigation, categorized by sample\n\n[type. More hashes are available on our GitHub repository here: https://github.com/bitdefender/malware-ioc/tree/master/rdp_](https://github.com/bitdefender/malware-ioc/tree/master/rdp_abusers)\n[abusers](https://github.com/bitdefender/malware-ioc/tree/master/rdp_abusers)\n\nDelphiStealer (in-the-wild):\n```\n05e2f51dddd77c5db48a72a3bf78cbdf865f02105f852fbfd8db35db80dd51fa\n08517d1fd0a164526683a8708376abeba63d077705dba54fa6f306163471c9c4\n20c942864b74b482b8c7fe07bdb4745388ca6f4e7a90362d271effaa2c21fd19\n3cf63caf7f2a3b37699e2e7f254bb5c33a093bda354510ab72daf662e71e66c0\n5449db2fc3bbb57a05aff4cb26480ee54f2d7bc9118b1c26b0550680a41fd515\n990cfaa8660c8c9118f1e4eebd49ec75844aec93c2385f6cfadac0e94e34799f\nb257c4b962c3de4b9d34afbf23d7b09f9f0741bdd66dbc6733225ae2cca909fb\n\n```\nDeplhiStealer (payloads):\n```\n05e2f51dddd77c5db48a72a3bf78cbdf865f02105f852fbfd8db35db80dd51fa\n20c942864b74b482b8c7fe07bdb4745388ca6f4e7a90362d271effaa2c21fd19\n3cf63caf7f2a3b37699e2e7f254bb5c33a093bda354510ab72daf662e71e66c0\n5449db2fc3bbb57a05aff4cb26480ee54f2d7bc9118b1c26b0550680a41fd515\n990cfaa8660c8c9118f1e4eebd49ec75844aec93c2385f6cfadac0e94e34799f\nb257c4b962c3de4b9d34afbf23d7b09f9f0741bdd66dbc6733225ae2cca909fb\n\n```\nMicroClip (in-the-wild):\n```\n14873eba6c4513ed5b9fdef6b86b5912cfa7df16422efef7ec490b1445b842cc\n30dba80a875553ef8908947bcd37003c328dac366e14c76368361d4f60624cb4\n3861e4627f5c1fd769935d6dca6557e6e26a01d130780cd00675ee98c355259b\n502ba411b7400f3f3ba531584a71da5140b82bb281d33fc0c4d202d584cf7686\n5bc17497a238a15c1a3e31874b418a705c40c13f3c20541cb2504c804c590ab5\n5e13c2986360268b54e95e7133ac07e48c72bfcf1be5778c1f1a62b112942925\n936729e66021fd42f88c2d4f34520810b2b7d5b4b6b5e2b7b1752433aa0ab937\nb53cbaa58d719eadc0bbd127c574f548c016230d31348c9af5f67187b4953398\nefeea68805d393bae0fcc8ccdad5dd6fb36136f71d8f3cf9adf1b788fd7eac49\nf76b7254ccb8731a6f32979a7f82e40b4c7d88e1f186a3d4477da24ea0a205f6\n\n```\nMicroClip (payloads):\n```\n0d1f106eca46b5b4fe9a7e4d5c67405fb12cfe8fd2927f3d40037c03e0fe034e\n\n```\n\n-----\n\nWhite Paper\n```\n2083c01b207b5b7c930ab556490683689cfc9a8118087ae5849fd6416ef1490d\n401c5f405220b4911aa695e37918593078cbe130ee1e00f83e820b981e65ce2d\n68585f9830f174f4ccd53df5d2396e62c88c3ba07645be50f482a980f8ab03cb\ndccc057db24b9178b7851a301885e33c8e7be593deae7bd403446149b5a5e048\nfe328a7074d01f2c9080028ee2962fd2f6b6a80de97bb3efe34b04e6aec4bc3c\n\n```\nIntelRapid (in-the-wild):\n```\n21808615025f902b62e3f6336ba878451ee9ab63c6588b60537407ded9076424\n3e57cf8e94fdd1c2fc41d49aebe87a292add4fd378cb377bbd69b2723343945f\n4d020d354ebcb892bce5cf83a4257edd23f1ceaacd8210f1214054d691094c1f\n63c8d6ab0e57487a02f63501e1f1b98adc18ef4d7dbf61c2bc977cc5f0a2287b\n807a275957f9a0728e6a537d50c97dfd90ae42efa3075e0f531b6a6f353fb007\na36b8cbfe3067f212a3d971d2cb82084d3dac521c58aeb391057ae4d625b9313\nd6d1a78c6df058e68a17ecac6ca839d0c40be4b487fb53ba0bd180992eed9c9b\ne7aec13a3220183ae0be8266a5c79a957d3fbd6bdae3ef1a698d1b3d85d0d1a6\necbd14d38dfd754ea68bfc20b61329d11e39c820af370598824c20e8bfebe4c8\nf15d91582408c43b39560ab46e290c63fdd7eafa6b21de2a7313968eb8257ccc\n\n```\nIntelRapid (payloads):\n```\n05c0f6cee99f2e438c123ba5902fd64c9e064a9ee1b126b3b1b7fb098ef6ccb7\n23a102263fa7b2be5bdeb9d7efcb29be73fb90b2bddce6f086b8d1d36b21b39f\n35ca6031688f5af36e896cc8f4a345a0069e7d6581cf8eaa8dfe30a2f5bcd376\n4db6da27bde99ba28cb9e5cc185ede30ec355e5e8c881c99717765449b045483\n509314c535ccee477b2d88dd0cd8e35e78246962f93a9599a9e33f5d3257fff1\n936da874fd0428fffe0636ce35a218ce93f11a75d13e4118c44e75eb708c9df0\nd04500d89f97daf71b90766e149c315bee2861c61488d870d1a4eccb755ff370\nf0ec3e15c4b6aba9a3290199f6ed14eaa86422675f64c50680e65ccd9c04bb84\n\n```\nXMRig (in-the-wild):\n```\n167faab88b40c13e481677c76f6541ce5081e7c248d2f2e4f0c9a467df3e42c1\n2d199b069ca58b05185b5286bd0bd3deca688fc30f5e1b21a50f496b7f790a7c\n4bea0913904e449def5a94d8e428ec85736fbe42f9086b7a08d085e37e44dd94\n86072e0e7f9bc61e22dbc69b70df0b2c95a0badfdf352b7fc6d9eb6182118b05\n9e1ce9cee6bb35de538afa1ddee8743680d6662d508167ceaeba828d6b74010d\na647c0a8298da14f1402cd16958b31318892b898cadc829dd21436c5b2dd1cb8\ncd2f7f392f02d711b0260dfc080095ea1d2121244b9db9706553bea7c9d29b28\nce9c39ea38114e0bc32161f8ea4b69b4de78991e3a5742763dd20f911ea79855\n\n```\nXMRig (payloads):\n```\n43fee0d62ef0f1991a62cf6a195a5f9c2d7176fdd25fdf585d40ec85e8180a52\n4bea0913904e449def5a94d8e428ec85736fbe42f9086b7a08d085e37e44dd94\n5 07985114053368601 9 3 6 6564349 f b 3 f69 986 8749 9f 99d\n\n```\n\n-----\n\nWhite Paper\n```\n5e15b1c7d8b5564d960010331d753d01e9286a45573a749d7836482abe72dc5f\n6273a8c3f1d748388ca350d24bd8fda86151253b67c26b03ccb5cee5d3499270\n9b934875d44383cdab400506927804809ba665ae80f7d2347db87d583115afbd\na915c72774d31f71143fead1b6fc38e11b283985ae5faefd6c1a90d0de01b3e4\nb84f7256caf521d037d869e6994292248372f2d6fbaf9e8fe1d7d76de9d20265\n\n```\nAZORult (in-the-wild):\n```\n1de9348612df332f39c07ecfb6680d16d8a8978e790183a28878328766e5d843\n383d115201f7ccd9647f4f018c1a40a6625bf0c442558dc00ab83c7dd27621f1\n6adfdb690e2932397a1a5e4edff6f4ad6a3a380400707a71b35c36abb52e8553\n6b1cce3fbac60e735586002b2768059798fefd315010f8d756f40b7c9110a7b5\n88341ac8d35390d70c49f99fd93cd1b139d156fc8bb591c6a1808cc4f83f6218\nb27e3d051882f5554de01603a7ababed0ba587f2854e375853becad1527d811f\ned089448d76df8133fcabfe21e6f6687d71edb6329cc8fea63da42db23487abd\n\n```\nAZORult (payloads):\n```\n35fc256c67aa816e2820779dc1a7cb605cf5b7a6a2464280853533d95826a93a\nbbdf3076132fd5ff62c897e658e65025851d1ddd00e56f71402f14ed10dd271d\n\n```\nRapidRansomware (in-the-wild):\n```\n029b286197dc8842a6126004d0111aad3f947770fe269c7ee8d47fa4d8b750ef\n39a4cca7be143daba488b864e23ba16d9492b70e9e49cc2e574e8e896c717239\n76aa2d373ef3cb101c41808a49054e78747ebc40cf1a5f0993f788609670d07c\nd33eb6000b793805d6071c89cea96d224408e39d79b6931dea41f53887b058cc\ne89dd5d78b75ddc8ba66e30ae51a2df7c4afe186249b9c58b3938b7b394fb6f0\nec5a057f0171aff28630880bee8a5378e0090d27662f949f28dffa3af99658ba\nfa049f7bf36b1287bafc72de17ef11be6f852b6f6f1deebe590d0910aacf563e\nfbbcd4665b581d30d52942aa0dbb469ed35d07a3318bb6abb4d3ba7271b6bc3e\n\n```\nRapidRansomware (payloads):\n```\n041ae2e080b8e03a3b29ea60a688a2235956d9caac188f16c3463b923a199597\n3e975f3d9316f3555750f06facb9aea5eee4d87f269099138c20f283fd2f93c6\n7acb4b6472a3a265bd7752cd2691250b39f49e21cf4c83eea2ad1ecb9dbf55b7\nbea170429c42ad7902e198612f589a686f45da81324ee87cfff4ed5bb52783dd\nd0ad4503386affa3e7de701047ab5a36360483a5161d8498521b5e5432d0113e\ne6c5380cc85eefa4725f50b66fcf13732f1052f809f82bf2a54d125e049a8b2f\n\n```\nNemty (in-the-wild):\n```\n399503962b14b9b08824e15c59a33efcd95e7980fa02fd93908697c67632df20\n455d509757dcad64cb1652d2b83ea5fb3e7b7f3459eb4d7e730a3b8f151bdb51\n481b450a77918de85f17dccf1bba92f366969c6a103bad6053f2a36324f6d8de\ndffec313da406f87b9caa9553838e8d94d25d00d6921dc8f986ff624d6851662\n\n```\nNemty (payloads):\n\n\n-----\n\nWhite Paper\n\n### Network indicators\n```\nworkpc.biz\nmytele.ga\nmegabitcoin.life\nmandevelopm.org\n\n```\npetrofig.beget.tech\n```\n46.21.147.75\n\n### Windows Scheduled Tasks\nEncrypter\nEncrypterSt\nIntel Rapid\nWindows Media Video\nWindows Logon Application 64\nRealtek Sound Blaster Driver\nRealtek Sound Help\n\n Registry locations\n\n```\nRegistry values are shown as “key > value”.\n\nPersistence registry values:\n\n```\nhttp://mytele.ga/index.php\nhttp://mytele.ga\nhttp://megabitcoin.life/index.php\nhttp://mandevelopm.org/index.php\n\n```\nhttp://petrofig.beget.tech/xxx.exe\n\nhttp://petrofig.beget.tech/minexmr.php\n```\nUtility Service\nWinMediaPlay\nWindowsMediaPlayer32\nIntel Rapid32\nClient Server Runtime Process\nAppDataLow\nReadMe\n\n```\n```\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > Client Server Runtime Pro­\ncess\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > RDP Clipboard Monitor\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > winlogon\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > Microsoft server\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > UpgrdWndws\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > Word Processing Software\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > Readme\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > userinfo\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > Encrypter_074\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > 12365435\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > Windows Update Center\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce > Microsoft server\nHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > msword\nHKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run > RDP Clipboard Monitor\n\n```\nddi i l i k d l d b\n\n\n-----\n\nWhite Paper\n```\nHKEY_CURRENT_USER\\Software\\EncryptKeys\\\nHKEY_CURRENT_USER\\SOFTWARE\\AppDataLow\\Software\\\nHKEY_CURRENT_USER\\Software\\EncryptKeys > local_enc_private_key\nHKEY_CURRENT_USER\\Software\\EncryptKeys > local_enc_private_key_len\nHKEY_CURRENT_USER\\Software\\EncryptKeys > local_public_key\nHKEY_CURRENT_USER\\Software\\EncryptKeys > local_public_key_len\nHKEY_CURRENT_USER\\SOFTWARE\\AppDataLow\\Software > key0\nHKEY_CURRENT_USER\\SOFTWARE\\AppDataLow\\Software > key1\nHKEY_CURRENT_USER\\SOFTWARE\\AppDataLow\\Software > key2\n\n```\n\n-----\n\nBitdefender is a global security technology company that delivers solutions in more than 100 countries through a network of\n\nvalue-added alliances, distributors and reseller partners. Since 2001, Bitdefender has consistently produced award-winning\n\nbusiness and consumer security technology, and is a leading security provider in virtualization and cloud technologies.\nThrough R&D, alliances and partnership teams, Bitdefender has elevated the highest standards of security excellence in both\n\nits number-one-ranked technology and its strategic alliances with the world’s leading virtualization and cloud technology\n\nproviders.\n[More information is available at http://www.bitdefender.com/.](http://www.bitdefender.com/)\n\nAll Rights Reserved. © 2019 Bitdefender. All trademarks, trade names, and products referenced herein are property of their\n\nrespective owners. FOR MORE INFORMATION VISIT: enterprise.bitdefender.com.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.bitdefender.com/files/News/CaseStudies/study/302/Bitdefender-WhitePaper-RDP-Abusers.pdf"
    ],
    "report_names": [
        "Bitdefender-WhitePaper-RDP-Abusers.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbefc37d-475c-4d4d-b80b-7a55f896de82",
            "created_at": "2022-10-25T15:50:23.571783Z",
            "updated_at": "2025-03-27T02:00:55.502112Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "BRONZE BUTLER",
                "REDBALDKNIGHT"
            ],
            "source_name": "MITRE:BRONZE BUTLER",
            "tools": [
                "Mimikatz",
                "build_downer",
                "cmd",
                "ABK",
                "at",
                "BBK",
                "schtasks",
                "down_new",
                "Daserf",
                "ShadowPad",
                "Windows Credential Editor",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1576671446,
    "ts_modification_date": 1576671452,
    "files": {
        "pdf": "https://archive.orkl.eu/d0ab502c7274156985846d347de606106a649644.pdf",
        "text": "https://archive.orkl.eu/d0ab502c7274156985846d347de606106a649644.txt",
        "img": "https://archive.orkl.eu/d0ab502c7274156985846d347de606106a649644.jpg"
    }
}