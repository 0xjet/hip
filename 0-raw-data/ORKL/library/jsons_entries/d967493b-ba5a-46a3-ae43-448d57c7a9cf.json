{
    "id": "d967493b-ba5a-46a3-ae43-448d57c7a9cf",
    "created_at": "2023-01-12T14:59:50.817868Z",
    "updated_at": "2025-03-27T02:16:28.731953Z",
    "deleted_at": null,
    "sha1_hash": "3b37d23631ce93b9bfaef0c4633b40aea8920ca8",
    "title": "2019-04-09 - Collection of helper scripts for OceanLotus",
    "authors": "",
    "file_creation_date": "2022-05-28T18:06:52Z",
    "file_modification_date": "2022-05-28T18:06:52Z",
    "file_size": 104827,
    "plain_text": "# Collection of helper scripts for OceanLotus\n\n**[github.com/eset/malware-research/tree/master/oceanlotus](https://github.com/eset/malware-research/tree/master/oceanlotus)**\n\neset\n\nThis repository contains scripts to help analysing OceanLotus' latest campaign using the\nlegitimate \"rastls.exe\" application for side-loading.\n\n[As described in ESET research whitepaper there are two components that has encrypted](https://www.welivesecurity.com/wp-content/uploads/2018/03/ESET_OceanLotus.pdf)\npayloads: the fake document (dropper component) and the backdoor ( rastls.dll ).\n```\nol_unpack_shellcode_from_decoy.py will unpack the shellcode embedded in the\n\n```\nresource of the (fake) decoy document.\n```\nol_unpack_files_from_3rd_stage.py is almost the same script but it is used for the third\n\n```\nstage of the dropper part, obtained after the emulation (using `shellcode_emulator ) of`\nshellcode outputted by `ol_unpack_shellcode_from_decoy.py . The script extracts the`\nencrypted and compressed configuration and parse it. It prints the possible install paths for\nthe backdoor and its persistence mechanism. Finally, the script drops all the backdoor\ncomponents (e.g. `rastls.exe,` `rastls.dll and` `SyLog.bin ). The Kaitai Struct`\nstructure `ol_decoy_dropped_files.ksy was used to create the Python class.`\n\nBoth of these scripts uses [lief as a PE parser so make sure to install it beforehand.](https://github.com/lief-project/LIEF)\n```\nol_unpack_files_from_3rd_stage.py uses Kaitai Struct.\n\n```\n\n-----\n\n```\nol_unpack_shellcode_from_backdoor.py decrypts the shellcode of an installed\n\n```\nbackdoor using the key and IV embedded in the `rastls.dll file and the encrypted`\n```\nOUTLFLTR.DAT file (or SyLog.bin depending on the version).\n\n```\nThe folder `shellcode_emulator contains a script and its description to run the shellcode`\nemulator. Since the same shellcode is used everywhere during this campaign, it was faster\nto emulate it instead of using dynamic analysis.\n\nThe following flow could be used to obtain the dropped files from the decoy document (the\ndropper):\n\n`ol_unpack_shellcode_from_decoy.py` ⇒ `ol_shellcode_emulator.py` ⇒\n```\nol_unpack_files_from_3rd_stage.py\n\n```\nThe following flow could be used to obtain the third stage of the backdoor component:\n\n`ol_unpack_shellcode_from_backdoor.py` ⇒ `ol_shellcode_emulator.py`\n\nFinally, this repository also contains the Kaitai structure for the fifth stage of the backdoor\ncomponent. It will parse the configuration structure of the decrypted resource. In order to\n[generate a parser class or visualize it, Kaitai Struct should be installed.](http://kaitai.io/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-09 - Collection of helper scripts for OceanLotus.pdf"
    ],
    "report_names": [
        "2019-04-09 - Collection of helper scripts for OceanLotus.pdf"
    ],
    "threat_actors": [
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535590,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1653761212,
    "ts_modification_date": 1653761212,
    "files": {
        "pdf": "https://archive.orkl.eu/3b37d23631ce93b9bfaef0c4633b40aea8920ca8.pdf",
        "text": "https://archive.orkl.eu/3b37d23631ce93b9bfaef0c4633b40aea8920ca8.txt",
        "img": "https://archive.orkl.eu/3b37d23631ce93b9bfaef0c4633b40aea8920ca8.jpg"
    }
}