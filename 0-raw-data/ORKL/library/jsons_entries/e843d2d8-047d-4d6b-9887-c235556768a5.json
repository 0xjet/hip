{
    "id": "e843d2d8-047d-4d6b-9887-c235556768a5",
    "created_at": "2022-10-25T16:48:18.493679Z",
    "updated_at": "2025-03-27T02:16:03.282472Z",
    "deleted_at": null,
    "sha1_hash": "56fb96e4d2cd53c6683763d1f81cc69c71e8f9c6",
    "title": "APT Group Targets Indian Defense Officials Through Enhanced TTPs",
    "authors": "Cyble",
    "file_creation_date": "2022-03-04T05:49:22Z",
    "file_modification_date": "2022-03-04T05:49:22Z",
    "file_size": 1570961,
    "plain_text": "# APT Group Targets Indian Defense Officials Through\n\n Enhanced TTPs\n\n[During our routine threat hunting exercise, Cyble Research Labs came across a malware sample posted on Twitter by a](https://twitter.com/s1ckb017/status/1435888576710029315)\n\nresearcher who believes that the malware belongs to Transparent Tribe, an Advanced Persistent Threat (APT) Group.\n\nGiven the nature of the victim and the way they are targeted, we can draw some similarities to the Side Copy APT group.\n\nBoth APT groups are known to have mainly targeted India’s Defense and Government sectors in the past. Additionally, both\n\ngroups have used various other RAT and malware to launch campaigns via multiple modes such as phishing, delivering\n\npayload via mail, etc. The malware posted by the researcher on Twitter has used a technique to hide the actual malware in\n\n[the .vhdx file to avoid any antivirus detection. As per Wikipedia, .vhdx is the successor of VHD (Virtual Hard Disk).](https://en.wikipedia.org/wiki/VHD_%28file_format%29)\n\nThe figure below shows the high-level execution flow of the malware. Upon execution, the malware checks for the current\n\ntime zone. If it is able to verify that the victim system’s time zone is in IST, it connects to the attacker’s URL for downloading\n\nthe second stager. Once downloaded, it executes the second stager payload and deletes itself.\n\nThe second stager payload checks that only one instance of the malware is running, and then it connects with the attacker’s\n\nCommand and Control (C&C) server to start receiving the commands from Threat Actor (TA).\n\nFigure 1 High-Level Execution Flow of Malware\n\n## Technical Analysis\n\nCyble Research started analysis with the malware file name AFD CSD APP.vhdx; the sample had an extension. vhdx. After\n\ndouble-clicking on the AFD CSD APP.vhdx we observed it creating a mount in the Operating System (OS) with the name\n\n“CSD App“. After opening the mounted drive, we got the malicious malware file which is CSD_AppLaunch.exe.\n\nFigure 2 Actual Malware present in CSD APP Mount\n\nWhile performing a static analysis of the CSD_AppLaunch.exe malicious file, we determined that that the file is an x86\n\n\n-----\n\nFigure 3 Static Details of First Stager\n\nThe icon of the malicious app had the logo of the Canteen Store Department (CSD) of the Indian Armed Forces, as shown\n\nin the figure below.\n\nFigure 4 Application Logo Used for First Stager\n\n### Code Analysis (CSD_AppLaunch.exe)\n\nAs per the below code, once the malware has been executed, it checks whether the current OS time Zone is India Standard\n\nTime (IST); if the OS time is not in IST, the malware exits. This tells us that the malware has been created with the explicit\n\npurpose of targeting the Indian Defense establishment and service members.\n\nFi 5 M l Ch k f Ti Z\n\n\n-----\n\nand load the Form1_Load module to execute the malicious malware code.\n\nFigure 6 Malware Loading Indian CSD Website in Custom Browser and Execute Form1_Load\n\nOnce the Form1_Load method is called, the code shown in Figure 7 creates a directory in C:\\\\ProgramData as “Intel Wifi*”.*\n\nIf this directory is not present, it will be created, Once the directory is present, the malware proceeds to download the next\n\nstager payload from URL https[:]//secure256[.]net/ver4.mp3. Then, the malware decrypts the ver4.mp3 content to create\n\nIntelWifi.exe malicious binary in C:\\\\ProgramData\\\\Intel Wifi as shown in the code below.\n\nFigure 7 Create Folder in ProgramData and Download Second Stager\n\nThe code below contains the decryption logic used by the malware to decrypt the content of ver4.mp3 file.\n\n\n-----\n\nFigure 8 Decrypt Second Stager\n\nFinally, the first stager malware calls the Final method to create a new file name music.mp3 which contains the decrypted\n\ndata of ver4.mp3 in the C:\\\\ProgramData directory.\n\nAfter this step, it sleeps for 6 seconds and then uses the Move function to rename the music.mp3 file to IntelWifi.exe. It then\n\nsleeps for five more seconds and then executes IntelWifi.exe binary and delete CSD_AppLaunch.exe (first stager) binary as\n\nshown in the figure below.\n\nFigure 9 Create Second Stager Binary IntelWifi.exe\n\n### Technical Analysis for IntelWifi.exe (Second Stager)\n\nStatic analysis of IntelWifi.exe tells that the binary is an x86 architecture Windows-based Graphical User Interface (GUI)\n\napplication written in .NET language as shown in the figure below.\n\n\n-----\n\nFigure 10 Static Details of IntelWifi (Second Stager)\n\nAs per the below code, initially, the malware checks that only a single instance of a malware process is running. Then, it\n\nchecks whether the current time zone is India Standard Time. Further, it calls CheckDirectory() method to create \\\\Intel Wifi\n\ndirectory and vmnx.dll file. Finally, it calls the Form1 module to execute the malicious codes.\n\nFigure 11 Second Stager Malware Performing Various Checks\n\nForm1() module calls IntializeComponent method, which in turn loads the Form1_Load method. The Form1_Load then calls\n\nRun() method to start the malware activity as shown in the figure below.\n\n\n-----\n\nFigure 12 Execution Flow to Initiate the Malicious Activity\n\nThe Run code is shown in Figure 13. Once executed, it connects to the attacker’s C&C on address\n\n45[.]147[.]228[.]195[:]5434. After establishing contact with the C&C server, it calls the Run method from the Grabber class to\n\nexecute a series of methods to get the victim’s environment details, e.g., OS, current username, etc. Once the victim’s\n\nenvironment details are extracted, the malware sends the details to the attacker’s C&C with key “x999” and then waits for\n\ncommands to be received from the attacker.\n\nFigure 13 Malware Communicating to Attacker’s C&C and Waiting to receive the Command\n\nBelow we have listed a series of methods executed by the Run() method present in the Grabber class.\n\n\n-----\n\n|Col1|Col2|\n|---|---|\n|Methods|Description|\n|CreateID()|Create vmvcx.dll file and Generate Victim ID based on processor detail and P-Followed by random number and write the ID is vmvcx.dll file. E.g., PXXX-XXXXXXXXXXXX|\n|Name()|Get the Computer Name and Current Username|\n|PubIp()|Get the Victim’s public IP using http://icanhazip[.]com|\n|LocIp()|Get the Victim’s Local IP|\n|OSType()|Get the Victim’s Operating System (OS) details|\n|Av()|Get the AV’s List present in Victim’s Machine|\n|MacType()|Check whether Victim’s is using desktop or Laptop|\n|CreateNonStop()|Add persistence in Startup Folder|\n\n\nTable 1 Methods Description Which Malware invokes\n\nThe below figure shows that the cynetcloud shortcut file is created in the startup folder using CreateNonStop() method. The\n\nvalue file:///C:\\ProgramData\\Intel Wifi\\IntelWifi.exe executes whenever the Windows machine starts. This is done for the\n\npurpose of creating and maintaining persistence on the victim machine.\n\nFigure 15 Malware Created Persistent in Start-Up Folder\n\nOnce all the methods are executed, as shown in Table 1, the malware sends the user data to Attacker’s C&C. In the figure\n\nbelow, the malware has connected to our fake emulated C&C.\n\nFigure 16 Malware Connected to Fake C&C\n\nOnce connected, the malware sends the victim’s environment details. The malware goes into a dormant stage to get the\n\nnext command from the attacker’s C&C.\n\nFor example in the below figure we have sent “prc1” to the malware to get the process details of the victim\n\n\n-----\n\nFigure 17 Output Received from malware\n\nBelow is the code used by the malware to handle the commands received from C&C.\n\nFigure 18 Various Functionalities which Malware Support basis on the Command Received from C&C\n\n## Conclusion\n\nThe APT groups are evolving their tools and techniques to stay ahead of various security solutions like AV & EDR. Based\n\non the fact that this malware has multiple artifacts such as the logo, the URL used in the initial code, we can conclude that\n\nthe malware has been created specifically to target Indian Defense or Government officials.\n\nCyble Research Labs will continuously monitor security threats, whether they are ongoing or emerging. We will continue to\n\nupdate our readers with our latest findings.\n\n\n-----\n\nrecommend that our readers follow the suggestions given below:\n\nUse a reputed anti-virus and internet security software package on your connected devices.\n\nUse the shared IOCs to monitor and block the malware infection.\n\nConduct regular backup practices and keep those backups offline or in a separate network.\n\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\n\nTurn on the automatic software update feature on your computer, mobile, and other connected devices wherever\n\npossible and pragmatic.\n\nUse strong passwords and enforce multi-factor authentication wherever possible.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Execution  ** [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n**Persistence** [T1547](https://attack.mitre.org/techniques/T1547/) Boot or Logon Autostart Execution\n\n[T1057](https://attack.mitre.org/techniques/T1057/) Process Discovery\n\n[T1124](https://attack.mitre.org/techniques/T1124/) System Time Discovery\n\n**Discovery**\n\n[T1033](https://attack.mitre.org/techniques/T1033/) System Owner/User Discovery\n\n[T1082](https://attack.mitre.org/techniques/T1082/) System Information Discovery\n\n[T1095](https://attack.mitre.org/techniques/T1095/) Non-Application Layer Protocol\n**Command and Control**\n\n[T1571](https://attack.mitre.org/techniques/T1571/) Non-Standard Port\n\n## Indicators of Compromise (IoCs):\n\n**Indicator**\n**Indicators** **Description**\n**type**\n\n**124023c0cf0524a73dabd6e5bb3f7d61d42dfd3867d699c59770846aae1231ce** SHA-256 IntelWifi.exe\n\n**84841490ea2b637494257e9fe23922e5f827190ae3e4c32134cadb81319ebc34** SHA-256 CSD_AppLaunch.exe\n\n**5e645eb1a828cef61f70ecbd651dba5433e250b4724e1408702ac13d2b6ab836** SHA-256 AFD CSD APP.vhdx\n\n**http://secure256[.]net/** URL Second Stager URL\n\n**45.147.228.195:5434** IP:Port Attacker’s C&C\n\n## Generic signatures and Rules:\n\n Yara Rules:\n\n|Col1|Col2|Col3|\n|---|---|---|\n|Tactic|Technique ID|Technique Name|\n|**Execution **|T1204|User Execution|\n|Persistence|T1547|Boot or Logon Autostart Execution|\n|Discovery|T1057 T1124 T1033 T1082|Process Discovery System Time Disco very System Owner/User Dis covery System Information Discovery|\n|Command and Control|T1095 T1571|Non-Application Layer Protocol Non-Standard Port|\n\n|Indicators of Compromise (IoCs):|Col2|Col3|\n|---|---|---|\n||||\n|Indicators|Indicator type|Description|\n|124023c0cf0524a73dabd6e5bb3f7d61d42dfd3867d699c59770846aae1231ce|SHA-256|IntelWifi.exe|\n|84841490ea2b637494257e9fe23922e5f827190ae3e4c32134cadb81319ebc34|SHA-256|CSD_AppLaunch.exe|\n|5e645eb1a828cef61f70ecbd651dba5433e250b4724e1408702ac13d2b6ab836|SHA-256|AFD CSD APP.vhdx|\n|http://secure256[.]net/|URL|Second Stager URL|\n|45.147.228.195:5434|IP:Port|Attacker’s C&C|\n\n```\nrule win32_csdmalware\n\n{ \nmeta: \n  author= \"Cyble Research\"\n  date= \"2021-09-14\"\n  description= \"Coverage for CSD_Application.exe & IntelWifi.exe\"\n\n```\n```\n  csd_application_hash= \"84841490ea2b637494257e9fe23922e5f827190ae3e4c32134cadb81319ebc34\n\n```\n```\n\"\n  intelwifi_hash= \"124023c0cf0524a73dabd6e5bb3f7d61d42dfd3867d699c59770846aae1231ce\"\nstrings: \n  $header= \"MZ\"\n\n```\n\n-----\n\n```\n  $sig3 = \"MacType\" wide ascii\n  $sig4 = \"45.147.228.195\" wide ascii\n  $sig5 = \"qmquqsqiqcq.qmqpq3q\" wide ascii\n  $sig6 = \"secure256.net\" wide ascii\n  $sig7 = \"ver4.mp3\" wide ascii\n  $sig8 = \"x33117\" wide ascii\ncondition: \n\n  $header at 0 and (3 of ($sig*)) \n}\n\n```\n\n## **About Us **\n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect themselves from cybercrimes and exposure](https://cyble.com/)\n\nin the Darkweb. Its prime focus is to provide organizations with real-time visibility to their digital risk footprint. Backed by Y\n\nCombinator as part of the 2021 winter cohort, Cyble has also been recognized by Forbes as one of the top 20 Best\n\nCybersecurity Startups To Watch In 2020. Headquartered in Alpharetta, Georgia, and with offices in Australia, Singapore,\n\nand India, Cyble has a global presence. To learn more about Cyble, visit www.cyble.com.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/x6otivaxer0pf3hmkfzgwchig41xr7ac"
    ],
    "report_names": [
        "Cyble_APT-Targets-Indian-Defense-Enhanced-TTPs(09-14-2021)"
    ],
    "threat_actors": [
        {
            "id": "b584b10a-7d54-4d05-9e21-b223563df7b8",
            "created_at": "2022-10-25T16:07:24.181589Z",
            "updated_at": "2025-03-27T02:02:10.134233Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "ETDA:SideCopy",
            "tools": [
                "ActionRAT",
                "AllaKore",
                "Allakore RAT",
                "AresRAT",
                "Bladabindi",
                "CetaRAT",
                "DetaRAT",
                "EpicenterRAT",
                "Jorik",
                "Lilith",
                "Lilith RAT",
                "MargulasRAT",
                "ReverseRAT",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "187a0668-a968-4cf0-8bfd-4bc97c02f6dc",
            "created_at": "2022-10-27T08:27:12.955905Z",
            "updated_at": "2025-03-27T02:00:55.41311Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [
                "SideCopy"
            ],
            "source_name": "MITRE:SideCopy",
            "tools": [
                "AuTo Stealer",
                "Action RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a4f0e383-f447-4cd6-80e3-ffc073ed4e00",
            "created_at": "2023-01-06T13:46:39.30167Z",
            "updated_at": "2025-03-27T02:00:03.045082Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "MISPGALAXY:SideCopy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041763,
    "ts_creation_date": 1646372962,
    "ts_modification_date": 1646372962,
    "files": {
        "pdf": "https://archive.orkl.eu/56fb96e4d2cd53c6683763d1f81cc69c71e8f9c6.pdf",
        "text": "https://archive.orkl.eu/56fb96e4d2cd53c6683763d1f81cc69c71e8f9c6.txt",
        "img": "https://archive.orkl.eu/56fb96e4d2cd53c6683763d1f81cc69c71e8f9c6.jpg"
    }
}