{
    "id": "fc29cb54-8837-4e37-900e-e10cb6a56ddf",
    "created_at": "2022-10-25T16:48:23.683199Z",
    "updated_at": "2025-03-27T02:14:43.67417Z",
    "deleted_at": null,
    "sha1_hash": "44034bcbd317f83aba6172387eae7fb102e0926b",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-03-14T15:06:33Z",
    "file_modification_date": "2020-03-14T15:06:33Z",
    "file_size": 27164205,
    "plain_text": "# 刺向巴勒斯坦的致命毒针——双尾蝎 APT 组织的攻击活动分 析与总结 - SecPulse.COM\n\n###### secpulse.com/archives/125292.html\n\n##### 2020-03-12 2,662\n\n\n-----\n\n# 刺向巴勒斯坦的致命毒针——双尾蝎 APT 组织的攻击活动分 析与总结\n\n###### 封⾯-pic1\n\n## ⼀.前⾔\n\n##### 双尾蝎APT组织(⼜名: APT-C-23 ),该组织从 2016 年 5 ⽉开始就⼀直对巴勒斯坦教育机构、军事机 构等重要领域展开了有组织、有计划、有针对性的⻓时间不间断攻击.其在2017年的时候其攻击活 动被360企业安全进⾏了披露,并且其主要的攻击区域为中东,其中以⾊列与巴勒斯坦更受该组织的⻘ 睐。\n\n 攻击平台主要包括 Windows 与 Android :\n\n 其中针对 windows 的平台,其⽐较常⻅的⼿法有投放带有\" *.exe \"或\" *.scr \"⽂件后缀的释放者 ⽂件,在⽬标⽤户打开后释放对应的诱饵⽂档,并且释放下⼀步的侦查者(Recon).持久存在的⽅式也 不唯⼀,⼀般通过写⼊注册表启动项以及释放指向持久化远控的快捷⽅式到⾃启动⽂件夹下.其侦查 者会收集当前机器的相关信息包含(系统版本,计算名,杀毒软件信息,当前⽂件所在路径,恶意软件当 前版本),以及其解析 C2 的回显指令,并执⾏.⽐如:远程shell,截屏和⽂件下载。\n\n 同时根据别的安全⼚商的报告,我们也得知该组织拥有于攻击 Android 平台的组件,拥有定位、短信 拦截、电话录⾳等，并且还会收集⽂档、图⽚、联系⼈、短信等情报信息；PC 端后⻔程序功能包 括收集⽤户信息上传到指定服务器的功能、远程下载⽂件能⼒.\n\n 近⽇ check point 安全⼚商披露了该组织⾃导⾃演,给以⾊列⼠兵⼿上安装恶意软件的攻击活动. 可以从中看出该团伙的攻击设计之巧妙,准备之充分。但最后结果还是被以⾊列给反制了⼀ 波............\n\n Gcow安全团队追影⼩组于 2019.12 ⽉初开始监测到了双尾蝎APT组织通过投递带有诱饵⽂件的相 关可执⾏⽂件针对巴勒斯坦的部⻔ 进⾏了相应的攻击活动,这些诱饵⽂件涉及教育,科技,政治等⽅⾯ 的内容,其攻击活动⼀直持续到了 2020.2 ⽉底.追影⼩组对该组织进⾏了⼀定时间的追踪.遂写成此 报告还请各位看官欣赏.\n\n## ⼆.样本信息介绍以及分析\n\n### 1.样本信息介绍\n\n##### 在本次双尾蝎APT组织针对巴勒斯坦的活动中,Gcow安全团队追影⼩组⼀共捕获了 14 个样本,均 为 windows 样本,其中 12 个样本是释放诱饵⽂档的可执⾏⽂件, 2 个样本是带有恶意宏的诱饵⽂ 档\n\n\n-----\n\n###### 2019.12——2020.2双尾蝎APT组织针对巴勒斯坦所投放样本的样本类型占⽐图-pic2\n\n##### 在这 12 个可执⾏⽂件样本中,有 7 个样本伪装成 pdf ⽂档⽂件,有 1 个样本伪装为 word ⽂档⽂ 件,有 2 个样本伪装为 rar 压缩⽂件.有 2 个样本伪装成 mp3, mp4 ⾳频⽂件\n\n###### 2019.12——2020.2双尾蝎APT组织针对巴勒斯坦所投放可执⾏⽂件样本的样本类型占⽐图-pic3\n\n##### 在这 14 个 Windows 恶意样本中,其诱饵⽂档的题材,政治类的样本数量有 9 个,教育类的样本数量 有 1 个,科研类的样本数量有 1 个,未知类的样本数量有 3 个(注意:未知指得是其诱饵⽂档出现错 误⽆法打开或者其内容属于⽆关内容)\n\n\n-----\n\n###### 2019.12——2020.2双尾蝎APT组织针对巴勒斯坦所投放的样本题材占⽐图-pic4\n\n##### 现在各位看官应该对这批双尾蝎组织针对巴勒斯坦的攻击活动有了⼀个⼤概的认识,但是由于这批 样本之中有⼀些话题是以⾊列和巴勒斯坦共有的,这⾥ Gcow 安全团队追影⼩组持该组织主要是攻 击巴勒斯坦的观点,若各位看官有更多的证据,欢迎联系我们团队.注意:这⾥只是⼀家之⾔,还请各位 看官须知。\n\n 那下⾯追影⼩组将以⼀个恶意样本进⾏详细分析,其他样本采取略写的形式向各位看官描述此次攻 击活动。注意:因为其他样本的主要逻辑是相同的,所以没有必要枉费笔墨\n\n### 2.样本分析\n\n#### (1).Define the Internet in government institutions\n\n a.样本信息\n\n\n-----\n\n###### 样本Define the Internet in government institutions_pdf.exe⽂件信息(表格)-pic5\n\n 样本Define the Internet in government institutions_pdf.exe⽂件信息(图⽚)-pic6\n\n#### b.样本分析\n\n##### 通过对样本的分析我们得知了该样本是兼具释放者(Dropper)与下载者(Downloader)的功能,其释放 者(Dropper)主要是⽤以释放诱饵\n\n ⽂档加以伪装以及将⾃身拷⻉到%ProgramData%⽬录下,并且⽣成执⾏该⽂件的快捷⽅式并且释 放于⾃启动⽂件夹下,⽽下载者(Downloader)\n\n 部分主要是通过进⾏信息收集以及等待C2给予的回显,主要功能有:远程shell,⽂件下载,屏幕截屏\n\n\n-----\n\n#### i.释放者(Dropper)部分:\n\n##### 通过 FindResource 函数查找名称为:MyData的资源\n\n###### FindResource函数查找MyData资源-pic7\n\n##### 通过 LoadResource 函数加载该资源\n\n###### LoadResource函数加载资源-pic8\n\n##### 通过 LockResource 函数锁定资源并且获取资源在内存的地址\n\n\n-----\n\n###### LockResource函数锁定资源-pic9\n\n##### 通过 SizeOfResource 函数通过获取资源的地址计算该资源的⻓度\n\n###### SizeOfResource函数获取资源⻓度-pic10\n\n##### 通过 CreateFile 函数在%temp%⽬录下释放诱饵PDF⽂档Define the Internet in government institutions.pdf\n\n\n-----\n\n###### CreateFile函数创造诱饵PDF⽂档-pic11\n\n##### 通过 WriteFile 函数将PDF源数据写⼊创建的诱饵⽂档内\n\n###### 诱饵PDF⽂档源数据-pic12\n\n\n-----\n\n###### WriteFile函数将PDF⽂档源数据写⼊诱饵PDF⽂档中-pic13\n\n##### 通过 ShellExecute 函数打开PDF诱饵⽂档,以免引起⽬标怀疑\n\n###### ShellExecute函数打开诱饵PDF⽂档-pic14\n\n##### 其PDF诱饵⽂档内容如图,主要关于其使⽤互联⽹的政治类题材样本,推测应该是针对政府部⻔的活 动\n\n\n-----\n\n###### 诱饵PDF⽂档原⽂以及翻译-pic15\n\n##### 同时利⽤ CopyFileA 函数将⾃身拷⻉到 %ProgramData% ⽬录下并且重命名为\n```\nSyncDownOptzHostProc.exe\n\n###### CopyFile函数拷⻉⾃身⽂件并重命名为SyncDownOptzHostProc.exe-pic16\n\n##### 利⽤ CreateFilewW 函数在⾃启动⽂件夹下创造指 向 %ProgramData%SyncDownOptzHostProc.exe 的快捷⽅式 SyncDownOptzHostProc.lnk\n\n###### 利⽤CreateFileW函数创造指向后⻔⽂件的快捷⽅式 pic17\n\n```\n\n-----\n\n###### 指向后⻔⽂件的快捷⽅式于⾃启动⽂件夹下-pic18\n\n#### ii.下载者(Downloader)部分:\n\n##### 通过 CreateFile 函数创造 %ProgramData%GUID.bin ⽂件,内部写⼊对应本机的 GUID .当软件再 次运⾏的时候检查⾃身是否位于 %ProgramData% ⽂件夹下,若不是则释放pdf⽂档。若是,则释放\n```\nlnk 到⾃启动⽂件夹\n\n###### ⽣成GUID码-pic19\n\n```\n\n-----\n\n###### 创造GUID.bin⽂件并将⽣成的GUID码写⼊-pic20\n\n#### ①.信息收集\n\n##### 1.收集当前⽤户名以及当前计算机名称,并且读取 GUID.bin ⽂件中的GUID码\n\n###### 收集username和computername并且读取GUID-pic21\n\n##### 再以如下格式拼接信息\n\n###### 当前计算机名称_当前⽤户名_GUID码\n\n\n-----\n\n###### 编码前cname报⽂-pic22\n\n##### 将这些拼接好的信息利⽤base64进⾏编码,组合成 cname 报⽂\n\n###### 编码后cname报⽂-pic23\n\n##### 2.通过 GetVersion 函数收集当前系统版本\n\n\n-----\n\n###### 通过GetVersion函数收集当前系统版本-pic24\n\n##### 并且将其结果通过Base64进⾏编码,组成 osversion 报⽂\n\n###### 编码osversion报⽂-pic25\n\n##### 3.通过 WMI 查询本地安装的安全软件\n\n 被侦查的安全软件包括 360, F-secure, Corporate, Bitdefender\n\n\n-----\n\n###### 通过wmi查询本地安全的安全软件-pic26\n\n 被侦查的安全软件列表-pic27\n\n##### 如果存在的话,获取结果组成 av 报⽂\n\n 4.通过 GetModuleFile 函数获取当前⽂件的运⾏路径\n\n\n-----\n\n###### 通过GetModuleFile函数获取当前⽂件运⾏路径-pic28\n\n##### 将当前程序运⾏路径信息通过base64编码组成 aname 报⽂\n\n###### 编码aname报⽂-pic29\n\n##### 5.后⻔版本号 ver 报⽂,本次活动的后⻔版本号为:5.HXD.zz.1201\n\n\n-----\n\n###### 编码前ver报⽂-pic30\n\n##### 将版本号通过base64编码组成 ver 报⽂\n\n###### 编码后ver报⽂-pic31\n\n##### 将这些信息按照如下⽅式拼接好后,通过 Send ⽅式向URL地址\n```\nhtp://nicoledotson.icu/debby/weatherford/yportysnr 发送上线报⽂\ncname=&av=&osversion=&aname=&ver=\n\n```\n\n-----\n\n###### 通过send发送报⽂-pic32\n\n wireshark报⽂-pic33\n\n#### ②.获取指令\n\n##### 通过 http://nicoledotson.icu/debby/weatherford/ekspertyza URL获取功能命令(功能为 截屏,远程shell,以及下载⽂件)\n\n\n-----\n\n#### ③.发送屏幕快照\n\n##### 截取屏幕快照函数\n\n\n###### 获取功能指令-pic34\n\n 截屏主要代码-pic35\n\n\n##### 向URL地址 http://nicoledotson.icu/debby/weatherford/Zavantazhyty 发送截屏\n\n###### 发送截屏-pic36\n\n\n-----\n\n#### ④.远程shell\n\n##### 远程shell主要代码\n\n###### 远程shell主要代码-pic37\n\n##### 向URL地址 http://nicoledotson.icu/debby/weatherford/pidnimit 发送shell回显\n\n###### 发送shell回显-pic38\n\n#### ⑤.⽂件下载\n\n##### 下载⽂件,推测应该先另存为base64编码的txt⽂件再解密另存为为exe⽂件,最后删除txt⽂件.由于环 境问题我们并没有捕获后续的代码\n\n\n-----\n\n###### 下载⽂件1-pic39\n\n 下载⽂件2-pic40\n\n\n#### ⑥.删除命令\n\n\n-----\n\n##### 通过URL http://nicoledotson.icu/debby/weatherford/vydalyty 获取删除指令\n\n###### 获取删除指令-pic41\n\n##### 此外我们还关联到⼀个与之相似的样本,诱饵⽂档与之相同故不再赘述\n\n###### 样本Internet in government_984747457_489376.exe信息(表格)-pic42\n\n\n-----\n\n#### (2).Employee-entitlements-2020\n\n a.样本信息\n\n###### 样本Employee-entitlements-2020.doc⽂件信息(表格)-pic43\n\n 样本Employee-entitlements-2020.doc⽂件信息(图⽚)-pic44\n\n##### 该样本属于包含恶意宏的⽂档,我们打开可以看到其内容关于财政部关于⽂职和军事雇员福利的声 明,属于涉及政治类的题材\n\n\n-----\n\n###### 样本Employee-entitlements-2020.doc正⽂与翻译-pic45\n\n#### b.样本分析\n\n##### 通过使⽤ olevba dump出其包含的恶意宏代码(如下图所示:)\n\n 其主要逻辑为:下载该URL http://linda-callaghan.icu/Minkowski/brown 上的内容到本台机 器的 %ProgramData%IntegratedOffice.txt (此时并不是其后⻔,⽽且后⻔⽂件的 base64 编码 后的结果)。通过读取 IntegratedOffice.txt 的所有内容将其解码后,把数据流写 ⼊ %ProgramData%IntegratedOffice.exe 中,并且延迟运 ⾏ %ProgramData%IntegratedOffice.exe 删除 %ProgramData%IntegratedOffice.txt\n\n\n-----\n\n###### 样本Employee-entitlements-2020.doc中的恶意宏⽂件主要代码(带注释)-pic46\n\n 样本IntegratedOffice.exe⽂件信息(表格)-pic47\n\n\n-----\n\n###### 样本IntegratedOffice.exe⽂件信息(图⽚)-pic48\n\n##### 该样本属于上⼀个样本中的下载者(Downloader)部分,其还是通过创建 GUID .bin标记感染机器\n\n###### 创建guid.bin-pic49\n\n##### 并且创建指向⾃身的快捷⽅式于⾃启动⽂件夹中\n\n\n-----\n\n###### 在⾃启动⽂件夹创建指向⾃身的快捷⽅式-pic50\n\n##### 剩下的收集信息并且等待回显数据的操作都与上⽂中提到的相同故此不再赘述\n\n#### (3).Brochure-Jerusalem_26082019_pdf\n\n a.样本信息\n\n\n-----\n\n###### 样本Brochure-Jerusalem_26082019_pdf.exe⽂件信息(表格)-pic51\n\n 样本Brochure-Jerusalem_26082019_pdf.exe⽂件信息(图⽚)-pic52\n\n##### 通过 FindResource 函数查找资源 MYDATA,通过下图我们可以看出该资源是⼀个 PDF ⽂件\n\n\n-----\n\n###### FindResource函数查找资源MYDATA-pic53\n\n##### 通过 CreateFile 函数将⽂件源数据写⼊ %Temp%Brochure-Jerusalem_26082019.pdf (诱饵⽂ 件)中\n\n###### 通过CreateFile函数将⽂件源数据写⼊Brochure-Jerusalem_26082019.pdf-pic54\n\n##### 通过 ShellExecute 函数将 %Temp%Brochure-Jerusalem_26082019.pdf 打开\n\n\n-----\n\n###### 打开Brochure-Jerusalem_26082019.pdf-pic55\n\n##### 该样本关于耶路撒冷的话题,属于政治类诱饵⽂档\n\n###### 诱饵⽂件Brochure-Jerusalem_26082019.pdf内容以及翻译-pic56\n\n##### 之后的⾏为就和之前的如出⼀辙了,在此就不必多费笔墨。\n\n#### (4).Congratulations_Jan-7_78348966_pdf\n\n a.样本信息\n\n\n-----\n\n###### 样本Congratulations_Jan-7_78348966_pdf.exe⽂件信息(表格)-pic57\n\n 样本Congratulations_Jan-7_78348966_pdf.exe⽂件信息(图⽚)-pic58\n\n#### b.样本分析\n\n##### 通过 FindResource 函数查找资源 MYDATA,通过下图我们可以看出该资源是⼀个 PDF ⽂件\n\n###### FindResource函数查找资源MYDATA-pic59\n\n##### 通过 CreateFile 函数将⽂件源数据写⼊ %Temp%Congratulations_Jan-7.pdf (诱饵⽂件)中\n\n\n-----\n\n###### 通过CreateFile函数将⽂件源数据写⼊Congratulations_Jan-7.pdf-pic60\n\n##### 通过 ShellExecute 函数将 %Temp%Congratulations_Jan-7.pdf 打开\n\n###### 打开Scholarships in Serbia 2019-2020.pdf-pic61\n\n##### 该样本关于耶路撒冷归属的话题,属于政治类诱饵⽂档\n\n\n-----\n\n###### 诱饵⽂件Congratulations_Jan-7.pdf内容以及翻译-pic62\n\n##### 之后的⾏为就和之前的如出⼀辙了,在此就不必多费笔墨。\n\n#### (5).Directory of Government Services_pdf\n\n a.样本信息\n\n###### 样本Directory of Government Services_pdf.exe⽂件信息(表格)-pic63\n\n\n-----\n\n###### 样本Directory of Government Services_pdf.exe⽂件信息(图⽚)-pic64\n\n#### b.样本分析\n\n##### 通过 FindResource 函数查找资源 MYDATA,通过下图我们可以看出该资源是⼀个 PDF ⽂件\n\n###### FindResource函数查找资源MYDATA-pic65\n\n##### 通过 CreateFile 函数将⽂件源数据写⼊ %Temp%Directory of Government Services.pdf (诱 饵⽂件)中\n\n\n-----\n\n###### 通过CreateFile函数将⽂件源数据写⼊Directory of Government Services.pdf-pic66\n\n##### 通过 ShellExecute 函数将 %Temp%Directory of Government Services.pdf 打开\n\n###### 打开Directory of Government Services.pdf-pic67\n\n##### 该样本关于政府部⻔秘书处的话题,属于政治类诱饵⽂档\n\n\n-----\n\n###### 诱饵⽂件Directory of Government Services.pdf内容以及翻译-pic68\n\n##### 诱饵内容对应的官⽹图⽚\n\n###### 巴勒斯坦秘书部官⽹图⽚-pic69\n\n#### (6).entelaqa_hamas_32_1412_847403867_rar\n\n a.样本信息\n\n\n-----\n\n###### 样本entelaqa_hamas_32_1412_847403867_rar.exe⽂件信息(表格)-pic70\n\n 样本entelaqa_hamas_32_1412_847403867_rar.exe⽂件信息(图⽚)-pic71\n\n#### b.样本分析\n\n##### 通过 FindResource 函数查找资源 MYDATA,通过下图我们可以看出该资源是⼀个 RAR ⽂件\n\n\n-----\n\n###### FindResource函数查找资源MYDATA-pic72\n\n##### 通过 CreateFile 函数将⽂件源数据写⼊ %Temp%Entelaqa32.rar (诱饵⽂件)中\n\n###### 通过CreateFile函数将⽂件源数据写⼊Entelaqa32.rar-pic73\n\n##### 通过 ShellExecute 函数将 %Temp%Entelaqa32.rar 打开\n\n\n-----\n\n###### 打开Scholarships in Serbia 2019-2020.pdf-pic74\n\n##### 该样本关于哈⻢斯的话题,属于政治类诱饵⽂档\n\n###### 诱饵⽂件Entelaqa32.rar内容-pic75\n\n#### (7).final_meeting_9659836_299283789235_rar\n\n a.样本信息\n\n\n-----\n\n###### 样本final_meeting_9659836_299283789235_rar.exe⽂件信息(表格)-pic76\n\n 样本final_meeting_9659836_299283789235_rar.exe⽂件信息(图⽚)-pic77\n\n#### b.样本分析\n\n##### 通过 FindResource 函数查找资源 MYDATA,通过下图我们可以看出该资源是⼀个 rar ⽂件\n\n\n-----\n\n###### FindResource函数查找资源MYDATA-资源是rar⽂件-pic78\n\n##### 通过 CreateFile 函数将 rar ⽂件源数据写⼊ %Temp%jalsa.rar (诱饵⽂件)中\n\n###### 通过CreateFile函数将rar源数据写⼊jalsa.rar-pic79\n\n##### 通过 ShellExecute 函数将 %Temp%jalsa.rar 打开\n\n\n-----\n\n###### 打开jalsa.rar-pic80\n\n##### 其诱饵⽂件的内容与第⼗⼆届亚洲会议有关,其主体是⽆条件⽀持巴勒斯坦,可⻅可能是利⽤亚洲会 议针对巴勒斯坦*的活动,属于政治类题材的诱饵样本\n\n###### jalsa.rar诱饵⽂件信息(带翻译)-pic81\n\n##### 之后的⾏为就和之前的如出⼀辙了,在此就不必多费笔墨\n\n#### (8).Meeting Agenda_pdf\n\n\n-----\n\n#### a.样本信息\n\n b.样本分析\n\n\n###### 样本Meeting Agenda_pdf.exe⽂件信息(表格)-pic82\n\n 样本Meeting Agenda_pdf.exe⽂件信息(图⽚)-pic83\n\n\n##### 通过 CreateFile 函数将⽂件源数据写⼊ %Temp%Meeting Agenda.pdf (诱饵⽂件)中\n\n\n-----\n\n###### 通过CreateFile函数将源数据写⼊Meeting Agenda.pdf-pic84\n\n##### 通过 ShellExecute 函数将 %Temp%Meeting Agenda.pdf 打开\n\n###### 打开Meeting Agenda.pdf-pic85\n\n##### 但由于其塞⼊数据的错误导致该 Meeting Agenda.pdf ⽂件⽆法正常打开故此将该样本归因到未 知类题材,之后的⾏为就和之前的如出⼀辙了,在此就不必多费笔墨。\n\n#### (9).Scholarships in Serbia 2019-2020_pdf\n\n\n-----\n\n#### a.样本信息\n\n b.样本分析\n\n\n###### 样本Scholarships in Serbia 2019-2020_pdf.exe⽂件信息(表格)-pic86\n\n 样本Scholarships in Serbia 2019-2020_pdf.exe⽂件信息(图⽚)-pic87\n\n\n##### 通过 FindResource 函数查找资源 MYDATA,通过下图我们可以看出该资源是⼀个 PDF ⽂件\n\n\n-----\n\n###### FindResource函数查找资源MYDATA-pic88\n\n##### 通过 CreateFile 函数将⽂件源数据写⼊ %Temp%Scholarships in Serbia 2019-2020.pdf (诱 饵⽂件)中\n\n###### 通过CreateFile函数将⽂件源数据写⼊Scholarships in Serbia 2019-2020.pdf-pic89\n\n##### 通过 ShellExecute 函数将 %Temp%Scholarships in Serbia 2019-2020.pdf 打开\n\n\n-----\n\n###### 打开Scholarships in Serbia 2019-2020.pdf-pic90\n\n##### 该样本关于巴勒斯坦在塞尔维亚共和国奖学⾦的话题,属于教育类诱饵⽂档\n\n###### 诱饵⽂件Scholarships in Serbia 2019-2020.pdf内容以及翻译-pic91\n\n##### 诱饵内容对应的官⽹图⽚\n\n\n-----\n\n###### 巴勒斯坦教育部图⽚-pic92\n\n##### 之后的⾏为就和之前的如出⼀辙了,在此就不必多费笔墨。\n\n#### (10).347678363764_ا�����ات ��أ ��ل �����\n\n a.样本信息\n\n###### 样本347678363764_ا�����ات ��أ ��ل �����.exe的⽂件信息(表格)-pic93\n\n\n-----\n\n###### 样本347678363764_ا�����ات ��أ ��ل �����.exe的⽂件信息(图⽚)-pic94\n\n#### b.样本分析\n\n##### 通过 FindResource 函数查找资源 MYDATA,通过下图我们可以看出该资源是⼀个 docx ⽂件\n\n###### FindResource函数查找资源MYDATA-资源是docx⽂件-pic95\n\n##### 通过 CreateFile 函数将 docx ⽂件源数据写⼊ %Temp%daily_report.docx (诱饵⽂件)中\n\n\n-----\n\n###### 通过CreateFile函数将docx源数据写⼊daily_report.docx-pic96\n\n##### 通过 ShellExecute 函数将 %Temp%daily_report.docx 打开\n\n###### 打开daily_report.docx-pic97\n\n##### 从诱饵样本中的内容我们可以看出其关于巴勒斯坦态势的问题,属于政治类诱饵样本\n\n\n-----\n\n###### 诱饵⽂档daily_report.docx⽂件原⽂与翻译-pic98\n\n##### 之后的⾏为就和之前的如出⼀辙了,在此就不必多费笔墨\n\n#### (11).asala-panet-il-music-live-892578923756-mp3\n\n a.样本信息\n\n###### 样本asala-panet-il-music-live-892578923756-mp3.exe的⽂件信息(表格)-pic99\n\n\n-----\n\n###### 样本asala-panet-il-music-live-892578923756-mp3.exe的⽂件信息(图⽚)-pic100\n\n#### b.样本分析\n\n##### 通过 FindResource 函数查找资源 MYDATA,通过下图我们可以看出该资源是⼀个 unknown ⽂件\n\n###### FindResource函数查找资源MYDATA-pic101\n\n##### 通过 CreateFile 函数将⽂件源数据写⼊ %Temp%asala.mp3 (诱饵⽂件)中\n\n\n-----\n\n###### 通过CreateFile函数将⽂件源数据写⼊asala.mp3-pic102\n\n##### 通过 ShellExecute 函数将 %Temp%asala.mp3 打开\n\n###### 打开asala.mp3.mp4-pic103\n\n##### 歌曲挺好听的,但是我们也不知道啥意思,将其归属于未知类题材样本\n\n#### (12).artisan-video-5625572889047205-9356297846-mp4\n\n a.样本信息\n\n\n-----\n\n###### 样本artisan-video-5625572889047205-9356297846-mp4.exe的⽂件信息(表格)-pic104\n\n 样本artisan-video-5625572889047205-9356297846-mp4.exe的⽂件信息(图⽚)-pic105\n\n#### b.样本分析\n\n##### 通过 FindResource 函数查找资源 MYDATA,通过下图我们可以看出该资源是⼀个 unknown ⽂件\n\n\n-----\n\n###### FindResource函数查找资源MYDATA-pic106\n\n##### 通过 CreateFile 函数将⽂件源数据写⼊ %Temp%artisan-errors.mp4 (诱饵⽂件)中\n\n###### 通过CreateFile函数将⽂件源数据写⼊artisan-errors.mp4-pic107\n\n##### 通过 ShellExecute 函数将 %Temp%artisan-errors.mp4 打开\n\n\n-----\n\n###### 打开artisan-errors.mp4-pic108\n\n##### 该样本伪装成视频丢失的404信号,没有实际参考价值,故归⼊未知类题材样本\n\n###### 诱饵⽂件artisan-errors.mp4内容-pic109\n\n##### 之后的⾏为就和之前的如出⼀辙了,在此就不必多费笔墨。\n\n#### (13).1���ل ���ا��ا ا����ة\n\n a.样本信息\n\n\n-----\n\n###### 样本1���ل ���ا��ا ا����ة.doc的⽂件信息(表格)-pic110\n\n 样本1���ل ���ا��ا ا����ة.doc的⽂件信息(图⽚)-pic111\n\n#### b.样本分析\n\n##### 其诱饵内容关于在东耶路撒冷(巴勒斯坦)的阿布迪斯⼤学秘书,属于⼤学科研类样本\n\n\n-----\n\n###### 样本1���ل ���ا��ا ا����ة.doc原⽂翻译-pic112\n\n##### 同时其包含的恶意宏代码如图所示,由于我们并没有能成功获得下⼀步的载荷,故没法进⾏下⼀步的 分析。不过推测其⼤致功能应该与上⽂相同\n\n###### 恶意宏代码-pic113\n\n\n-----\n\n## 三.组织关联与技术演进\n\n##### 在本次活动中,我们可以清晰的看到双尾蝎APT组织的攻击⼿段,同时 Gcow 安全团队追影⼩组也对 其进⾏了⼀定的组织关联,并且对其技术的演进做了⼀定的研究。下⾯我们将分为组织关联与技术 演进这两部分内容进⾏详细的叙述。\n\n 注意:下⽂中的时间段仅仅为参考值,并⾮准确时间。由于在这⼀时间段内该类样本较多,故此分类。\n\n### 1.组织关联\n\n#### (1).样本执⾏流程基本相似\n\n##### 我们根据对⽐了从 2017 到 2020 年所有疑似属于双尾蝎APT组织的样本,(注意:这⾥⽐对的样本主 要是windows平台的可执⾏⽂件样本).在 2017 年到 2019 年的样本中我们可以看出其先在临时⽂ 件夹下释放诱饵⽂件,再打开迷惑受害者,再将⾃身拷⻉到 %ProgramData% 下.创建指 向%ProgramData%下的⾃拷⻉恶意⽂件的快捷⽅式于⾃启动⽂件夹.本次活动与 2018 年 2019 年 的活动所使⽤样本的流程极为相似.如下图所示.故判断为该活动属于双尾蝎 APT组织。\n\n###### 本次活动的样本流程与2017——2019年双尾蝎APT组织活动所使⽤的流程相似-pic114\n\n#### (2).C&C中存在名⼈姓名的痕迹\n\n##### 根据 checkpoint 的报告我们得知,该组织乐于使⽤⼀些明星或者名⼈的名字在其 C&C 服务器上. 左图是 checkpoint 安全⼚商揭露其针对以⾊列⼠兵的活动的报告原⽂,我们可以看到其中含有\n```\nJim Morrison, Eliza Dollittle, Gretchen Bleiler 等名字.⽽右图在带有恶意宏⽂档的样\n\n```\n\n-----\n\n##### 本中,我们发现了其带有 Minkowski 这个字符.通过搜索我们发现其来源于 Hermann Minkowski 名字的⼀部分,勉强地符合了双尾蝎APT组织的特征之⼀.\n\n###### 双尾蝎组织的C&C域名上存在名⼈名字的痕迹-pic115\n\n### 2.技术演进\n\n#### (1).在编写语⾔上的演进\n\n##### 根据 360 的报告我们可以得知双尾蝎APT组织在 2016 年到 2017 年这段时间内该组织主要采⽤ 了 VC 去编写载荷.再到 2017 年到 2018 年这段时间内该组织主要是以 Delphi 来编写其侦查者 (Recon),根据 Gcow 安全团队追影⼩组的跟踪,该组织在 2018 年到 2019 年这段时间内也使⽤了\n```\nDelphi 编写的恶意载荷。与 2017 年到 2018 年不同的是: 2017 年到 2018 年所采⽤的编译器\n\n 信息是:Borland Delphi 2014XE6。⽽在 2018 年到 2019 年这个时间段内采⽤的编辑器信息 是:Borland Delphi 2014XE7-S.10。同时在本次活动中该组织使⽤ Pascal 语⾔来编写载荷。可 ⻅该组织⼀直在不断寻求⼀些受众⾯现在越来越⼩的语⾔以逃脱杀软对其的监测。\n\n```\n\n-----\n\n###### 载荷编写语⾔的演进-pic116\n\n#### (2).编译时间戳的演进\n\n##### 根据 360 的报告我们可以得知双尾蝎APT组织在 2016 年到 2018 年这个时间段中,该组织所使⽤ 的恶意载荷的时间戳信息⼤部分时间集中位于北京的下午以及第⼆天的凌晨,属于中东地区的时 间。⽽在 2019 年 7 ⽉份捕获的双尾蝎APT组织样本中该组织的编译戳为 2019.7.14 11:08:48 ⽽在本次活动所捕获的样本中我们发现该组织将编译时间戳统⼀改为: 1970.1.1 1:00,也就是置 0.通过伪造时间戳以阻断安全⼈员的关联以及对其的地域判断\n\n###### 编译时间戳的演进-pic117\n\n#### (3).⾃拷⻉⽅式的演进\n\n##### 双尾蝎APT组织在 2017 年到 2019 年的活动中,擅⻓使⽤ copy 命令将⾃身拷⻉ 到 %ProgramData% 下.⽽可能由于 copy 指令的敏感或者已经被各⼤安全⼚商识别。在 2019 年\n```\n7 ⽉份的时候.该组织恢复了之前采⽤ CopyFile windows API函数的⽅式将⾃身拷⻉\n\n 到 %ProgramData% 下\n\n```\n\n-----\n\n###### ⾃拷⻉⼿法的演进-pic118\n\n#### (4).持久化⽅式的演进\n\n##### 根据 360 的报告,我们可以得知双尾蝎APT组织在 2016 年到 2017 年的活动之中,主要采⽤的是修 改注册表添加启动项的⽅式进⾏权限的持久化存在。⽽根据追影⼩组的捕获的样本,我们发现在\n```\n2017 年到 2018 年的这段时间内该组织使⽤拥有⽩名单 Shortcut.exe 通过命令⾏的⽅式在⾃\n\n 启动⽂件夹中添加指向⾃拷⻉后的恶意⽂件的快捷⽅式。⽽在本次活动中,该组织则采⽤调⽤\nCreateFile Windows API函数的⽅式在⾃启动⽂件夹中创建指向⾃拷⻉后恶意⽂件的快捷⽅式\n\n 以完成持久化存在\n\n```\n\n-----\n\n###### 持久化⽅式的演进-pic119\n\n#### (5).C&C报⽂的演进\n\n##### 为了对⽐的⽅便,我们只对⽐双尾蝎APT组织 2018 年到 2019 年的上半年的活动与本次活动的\n```\nC&C 报⽂的区别。如图所示下图的左上是本次活动的样本的 C&C 报⽂,右下⻆的是 2018 年到\n2019 年上半年活动的样本的 C&C 报⽂。通过下⾯所给出的解密我们可以得知两个样本所向 C&C\n\n 收集并发送的信息基本相同。同时值得注意的是该组织逐渐减少明⽂的直接发送收集到的注意⽽开 始采⽤⽐较常⻅的通过Base64的⽅式编码后在发送。同时在ver版本中我们发现: 2018 年到 2019 年上半年的样本的后⻔版本号为: 1.4.2.MUSv1107 (推测是2018.11.07更新的后⻔);⽽在本次活动 中后⻔版本号为: 5.HXD.zz.1201 (推测是2019.12.01号更新的后⻔),由此可⻅该组织正在随着披露 的增加⽽不断的进⾏后⻔的更迭。\n\n```\n\n-----\n\n###### C&C报⽂的演进-pic120\n\n## 四.总结\n\n### 1.概述\n```\nGcow 安全团队追影⼩组针对双尾蝎APT组织此次针对巴勒斯坦的活动进⾏了详细的分析并且通过\n\n##### 绘制了⼀幅样本执⾏的流程图⽅便各位看官的理解\n\n```\n\n-----\n\n###### 双尾蝎本次活动样本流程图-pic121\n\n##### 该组织拥有很强的攻击能⼒,其载荷涵盖较⼴(Windows和Android平台).并且在被以⾊列进⾏**物理 打击后快速恢复其攻击能⼒.对巴勒斯坦地区进⾏了⼀波较为猛烈的攻势,同时我们绘制了⼀幅本次 活动之中样本与 C&C 的关系图\n\n\n-----\n\n###### 双尾蝎本次活动样本与C&C服务器关系图-pic122\n\n##### 通过之前的分析我们发现了该组织拥有很强的技术对抗能⼒,并且其投放的样本⼀直围绕着与巴勒 斯坦和以⾊列的敏感话题进⾏投放,我们对其话题关键字做了统计,⽅便各位看官了解\n\n###### 双尾蝎本次活动所投放样本的话题关键字柱状图统计-pic123\n\n\n-----\n\n### 2.处置⽅案:\n\n##### 删除⽂件\n```\n%TEMP%*.pdf(*.mp3,*.mp4,*.rar,*.doc) [诱饵⽂档]\n%ProgramData%SyncDownOptzHostProc.exe [侦查者主体⽂件]\n%ProgramData%IntegratedOffice.exe[侦查者主体⽂件]\n%ProgramData%MicrosoftWindowsStart MenuProgramsStartupSyncDownOptzHostProc.lnk \n[指向侦查者主体⽂件的快捷⽅式⽤于权限维持]\n%ProgramData%GUID.bin [标记感染]\n\n### 3.结语\n\n##### 通过本次分析报告,我们相信⼀定给各位看官提供了⼀个更加充分了解该组织的机会.我们在前⾯分 析了该组织的技术特点以及对该组织实施攻击的攻击⼿法的演进进⾏了详细的概述。同时在后⾯的 部分我们也会贴出该组织最新活动所使⽤样本的 IOCs 供给各位感兴趣的看官交流与学习.同时我 们希望各位看官如果有其他的意⻅欢迎向我们提出。\n\n## 五.IOCs:\n\n### MD5:\n\n```\n\n-----\n\n###### 样本MD5与样本⽂件名集合-pic124\n\n### URL:\n\n##### http[:]//linda-callaghan[.]icu/Minkowski/brown\n\n http[:]//linda-callaghan[.]icu/Minkowski/microsoft/utilities\n\n http[:]//nicoledotson[.]icu/debby/weatherford/yortysnr\n\n http[:]//nicoledotson[.]icu/debby/weatherford/Zavantazhyty\n\n http[:]//nicoledotson[.]icu/debby/weatherford/Ekspertyza\n\n http[:]//nicoledotson[.]icu/debby/weatherford/Vydalyty\n\n http[:]//nicoledotson[.]icu/debby/weatherford/pidnimit\n\n### C2:\n\n##### linda-callaghan[.]icu\n\n nicoledotson[.]icu\n\n### 释放⽂件:\n\n##### %TEMP% *.pdf(*.mp3,*.mp4,*.rar,*.doc)\n\n %ProgramData%SyncDownOptzHostProc.exe\n\n %ProgramData%MicrosoftWindowsStart MenuProgramsStartupSyncDownOptzHostProc.lnk\n\n %ProgramData%GUID.bin\n\n %ProgramData%IntegratedOffice.exe\n\n## 六.相关链接:\n\n##### https://www.freebuf.com/articles/system/129223.html\n\n https://research.checkpoint.com/2020/hamas-android-malware-on-idf-soldiers-this-is-how-it- happened/\n\n https://mp.weixin.qq.com/s/Rfcr-YPIoUUvc89WFrdrnw\n\n 本⽂作者：SecPulse\n\n 本⽂为安全脉搏专栏作者发布，转载请注明：https://www.secpulse.com/archives/125292.html\n\n\n-----\n\n-----",
    "language": "ZH",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.03.12_Two-tailed_scorpion/Two-tailed_scorpion_CN_version.pdf"
    ],
    "report_names": [
        "Two-tailed_scorpion_CN_version"
    ],
    "threat_actors": [
        {
            "id": "9ff60d4d-153b-4ed5-a2f7-18a21d2fa05d",
            "created_at": "2022-10-25T16:07:23.539852Z",
            "updated_at": "2025-03-27T02:02:09.853285Z",
            "deleted_at": null,
            "main_name": "Desert Falcons",
            "aliases": [
                "APT-C-23",
                "ATK 66",
                "Arid Viper",
                "Operation Arid Viper",
                "Operation Bearded Barbie",
                "Operation Rebound",
                "TAG-63",
                "TAG-CT1",
                "Two-tailed Scorpion"
            ],
            "source_name": "ETDA:Desert Falcons",
            "tools": [
                "AridSpy",
                "Barb(ie) Downloader",
                "BarbWire",
                "Desert Scorpion",
                "FrozenCell",
                "GlanceLove",
                "GnatSpy",
                "KasperAgent",
                "Micropsia",
                "PyMICROPSIA",
                "SpyC23",
                "Viper RAT",
                "ViperRAT",
                "VolatileVenom",
                "WinkChat",
                "android.micropsia"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b1979c55-037a-415f-b0a3-cab7933f5cd4",
            "created_at": "2024-04-24T02:00:49.561432Z",
            "updated_at": "2025-03-27T02:00:55.493381Z",
            "deleted_at": null,
            "main_name": "APT-C-23",
            "aliases": [
                "APT-C-23",
                "Arid Viper",
                "Desert Falcon",
                "TAG-63",
                "Grey Karkadann",
                "Big Bang APT",
                "Two-tailed Scorpion"
            ],
            "source_name": "MITRE:APT-C-23",
            "tools": [
                "Micropsia"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "77c08a4a-b3f9-43ee-9d84-04ba572b7564",
            "created_at": "2024-05-01T02:03:07.927023Z",
            "updated_at": "2025-03-27T02:05:17.248836Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SHADYSIDE",
            "aliases": [
                "Arid Viper ",
                "Desert Falcon ",
                "APT-C-23 "
            ],
            "source_name": "Secureworks:ALUMINUM SHADYSIDE",
            "tools": [
                " SpyC23",
                "Micropsia"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "929d794b-0e1d-4d10-93a6-29408a527cc2",
            "created_at": "2023-01-06T13:46:38.70844Z",
            "updated_at": "2025-03-27T02:00:02.897573Z",
            "deleted_at": null,
            "main_name": "AridViper",
            "aliases": [
                "Arid Viper",
                "APT-C-23",
                "Bearded Barbie",
                "Desert Falcon"
            ],
            "source_name": "MISPGALAXY:AridViper",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041683,
    "ts_creation_date": 1584198393,
    "ts_modification_date": 1584198393,
    "files": {
        "pdf": "https://archive.orkl.eu/44034bcbd317f83aba6172387eae7fb102e0926b.pdf",
        "text": "https://archive.orkl.eu/44034bcbd317f83aba6172387eae7fb102e0926b.txt",
        "img": "https://archive.orkl.eu/44034bcbd317f83aba6172387eae7fb102e0926b.jpg"
    }
}