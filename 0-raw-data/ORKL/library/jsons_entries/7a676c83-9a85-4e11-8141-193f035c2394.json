{
    "id": "7a676c83-9a85-4e11-8141-193f035c2394",
    "created_at": "2023-01-12T15:09:00.594821Z",
    "updated_at": "2025-03-27T02:17:05.50855Z",
    "deleted_at": null,
    "sha1_hash": "5ab55e33f38f86c7b5390bdc1e3e16b267cd25be",
    "title": "2022-05-02 - Analysis on recent wiper attacks- examples and how wiper malware works",
    "authors": "",
    "file_creation_date": "2022-05-28T15:43:09Z",
    "file_modification_date": "2022-05-28T15:43:09Z",
    "file_size": 333564,
    "plain_text": "# Analysis on recent wiper attacks: examples and how wiper malware works\n\n**[cybersecurity.att.com/blogs/labs-research/analysis-on-recent-wiper-attacks-examples-and-how-they-wiper-malware-works](https://cybersecurity.att.com/blogs/labs-research/analysis-on-recent-wiper-attacks-examples-and-how-they-wiper-malware-works)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nMay 2, 2022 | [Fernando Martinez](https://cybersecurity.att.com/blogs/author/fmartinez)\n\n## Executive summary\n\n2022 has experienced an increase in the number of wiper variants targeting Ukrainian entities.\nThis blog post looks to explain how wipers work, what makes them so effective and provides a short\noverview of the most recent samples that appeared in the eastern Europe geopolitical conflict.\n\n## How does wiper malware work?\n\nWiper’s main objective is to destroy data from any storage device and make the information unavailable\n(T1485). There are two ways of removing files, logical and physical.\n\nLogical file removal is the most common way of erasing a file, performed by users daily when a file is sent\nto (and emptied from) the Recycle bin, or when it is removed with the command line or terminal with the\ncommands del/rm. This action deletes the pointer to the file but not the file data, making it recoverable with\nforensic tools as long as the Operative System does not write any other file in the same physical location.\n\nHowever, malware wipers aim to make the data irrecoverable, so they tend to remove the data from the\nphysical level of the disk. The most effective way to remove the data/file is by overwriting the specific\nphysical location with other data (usually a repeated byte like 0xFF). This process usually involves writing to\n\n\n-----\n\ndisk several Gigabytes (or Terabytes) of data and can be time consuming. For this reason, in addition to\ndestroying the data, many wipers first destroy two special files in the system:\n\nThe Master Boot Record (MBR), which is used during the boot process to identify where the\nOperative System is stored in the disk. By replacing the MBR, the boot process crashes, making the\nfiles inaccessible unless forensic methodologies are used.\nThe Master File Table (MFT) is exclusive to NTFS file systems, contains the physical location of files\nin the drive as well as logical and physical size and any associated metadata. If big files need to be\nstored in the drive, and cannot use consecutive blocks, these files will have to be fragmented in the\ndisk. The MFT holds the information of where each fragment is stored. Removing the MFT will require\nthe use of forensic tools to recover small files, and basically prevents recovery of fragmented files\nsince the link between fragments is lost.\n\nThe main difference between wipers and ransomware is that it’s impossible to retrieve the impacted\ninformation after a wiper attack. Attackers using wipers do not usually target financial reward but intend to\ndisrupt the victim’s operations as much as possible. Ransomware operators aim to get a payment in\nexchange for the key to decrypt the user’s data.\n\nWith both wiper and ransomware attacks, the victim depends on their back up system to recover after an\nattack. However, even some wiper attacks carry ransom notes requesting a payment to recover the data. It\nis important that the victim properly identifies the attack they've suffered, or they may pay the ransom\nwithout any chance of retrieving the lost data.\n\nIn the last month and a half, since the war started in Eastern Europe, several wipers have been used in\nparallel with DDoS attacks (T1499) to keep financial institutions and government organizations, mainly\nUkrainian, inaccessible for extended periods of time. Some of the wipers observed in this timeframe have\nbeen: WhisperKill, HermeticWiper, IsaacWiper, CaddyWiper, DoubleZero Wiper and AcidRain.\n\n## Most recent wiper examples\n\n**WhisperKill**\n\nOn January 14, 2022, the Ukrainian government experienced a coordinated attack on 22 of their\ngovernment agencies, defacing their websites. Almost all the compromised websites were developed by\nthe same Ukranian IT company, Kitsoft, and all of them were built on OctoberCMS. Therefore, the attack\nvector was most probably a supply chain attack on the IT provider, or an exploitation of an OctoberCMS\nvulnerability, combined with exploitations of Log4Shell vulnerability (T1190).\n\n\n-----\n\nFigure 1. Example of defaced Ukrainian government website.\n\nIn addition to the website defacement, Microsoft Threat Intelligence Center (MSTIC), identified in a\n[report destructive malware samples targeting Ukrainian organizations with two malware samples. Microsoft](https://www.microsoft.com/security/blog/2022/01/15/destructive-malware-targeting-ukrainian-organizations/)\nnamed the samples WhisperGate, while other security companies labeled the downloader as WhisperGate\nand WhisperKill as the actual wiper, which was considered a component of WhisperGate.\n\nThe identified files were:\n\nStage1 replaces the Master Boot Record (MBR) with a ransom note when the system is powered\ndown, deeming the machine unbootable after that point. When booted up, the system displays Figure\n2 on screen. Despite the ransom request, the data will not be recoverable since all efforts made by\nWhisperKill are looking to destroy data, not encrypt it. In this case, the wallet is most probably an\nattempt to decoy attribution efforts.\n\nFigure 2. Ransom note obtained by MSTIC.\n\nStage 2 attempts to download the next stage malware (T1102.003) from the Discord app, if\nunsuccessful, it sleeps and tries again. The payload downloaded from the messaging app destroys as\nmuch data as possible by overwriting certain file types with 0xCC for the first MB of the file. Then it\nmodifies the file extension to a random four-byte extension. By selecting the file types to be wiped and\nonly writing over the first MB of data, the attackers are optimizing the wiping process. This is due to\nnot wasting time on system files and only spending the necessary time to wipe each file, rapidly\nswitching to the next file as soon as the current one is unrecoverable. Finally, the malware executes a\ncommand to delete itself from the system (T1070.004).\n\n\n-----\n\n**HermeticWiper**\n\n[A month after, on February 23rd 2022, ESET Research reported a new Wiper being used against hundreds](https://www.welivesecurity.com/2022/02/24/hermeticwiper-new-data-wiping-malware-hits-ukraine/)\nof Ukrainian systems. The wiper receives its name from the stolen certificate (T1588.003) it was using to\nbypass security controls “Hermetica Digital Ltd” (T1588.003). According to a Reuters article, the certificate\ncould have also been obtained by impersonating the company and requesting a certificate from scratch.\n\nFigure 3. Hermetica Digital Ltd certificate.\n\nThe attackers have been seen using several methods to distribute the wiper through the domain, like:\ndomain Group Policy Object (GPO) (T1484.001), Impacket or SMB (T1021.002) and WMI (T1047) with an\nadditional worm component named HermeticWizard.\n\nThe wiper component first installs the payload as a service (T1569.002) under\n_C:\\Windows\\system32\\Drivers\\. Afterwards, the service corrupts the first 512 bytes of the MBR of all the_\nPhysical Drives, and then enumerates their partitions. Before attempting to overwrite as much data as the\nwiper can it will delete key files in the partition, like MFT, $Bitmap, $LogFile, the NTUSER registry hive\n(T1112) and the event logs (T1070.001).\n\nOn top of deleting key file system structures, it also performs a drive fragmentation (breaking up files and\nsegregating them in the drive to optimize the system’s performance). The combination of the file\nfragmentation and the deletion of the MFT makes file recovery difficult, since files will be scattered through\nthe drive in small parts - without any guidance as to where each part is located.\n\nFinally, the malware writes randomized contents into all occupied sectors in the partition in an attempt to\nremove all potential hope of recovering any data with forensic tools or procedures.\n\n**IsaacWiper**\n\nA day after the initial destructive attack with HermeticWiper, on February 24th, 2022, a new wiper was used\nagainst the Ukrainian government, as reported by ESET, without any significant similarities to the\nHermaticWiper used the day before.\n\nIsaacWiper identifies all the physical drives not containing the Operative System and locks their logical\npartitions by only allowing a single thread to access each of them. Then it starts to write random data into\nthe drives in chunks of 64 KB. There is a unique thread per volume, making the wiping process very long.\n\nOnce the rest of the physical drives and the logical partitions sharing physical drive with the Operative\nSystem’s volume have been wiped, this last volume is wiped by:\n\nErasing the MBR.\nOverwriting all files with 64 KB chunks of random data with one thread.\n\n\n-----\n\nCreating a new file under the C drive which will be filled with random data until it takes the maximum\nspace it can from the partition, overwriting the already overwritten existing files. This process is\nperformed with a different thread, but it would still take a long time to write the full partition since both\nconcurrent threads are actually attempting to write random data on the full disk.\n\nFigure 4. IsaacWiper strings.\n\nWhen comparing IsaacWiper to WhisperKill, the attackers’ priorities become clear. WhisperKill creators\nprioritized speed and number of affected files over ensuring the full drive is overwritten, since only 1 MB of\neach file was overwritten. On the other hand, IsaacWiper creators gave total priority to deliver the most\neffective wiper, no matter how long it takes to overwrite the full physical disk.\n\n**AcidRain**\n\nOn the same day IsaacWiper was deployed, another wiper attacked Viasat KA-SAT modems in Ukraine,\n[this time with a different wiper, named AcidRain by SentinelLABS. This wiper was particularly aimed at](https://www.sentinelone.com/labs/acidrain-a-modem-wiper-rains-down-on-europe/)\nmodems, probably to disrupt Internet access from Ukraine. This new wiper showed similarities to previously\nseen botnets targeting modems using VPNFilter. It was used in 2018, targeting vulnerabilities in several\ncommon router brands: Linksys, MikroTik, NETGEAR, and TP-Link. Exploiting vulnerabilities allowed the\nattackers to obtain Initial Access inside all types of networks, where the bot would search for Modbus traffic\nto identify infected systems with Industrial Control Systems (ICS).\n\nThe wiper used was the ELF MIPS wiper targeting Viasat KA-SAT modems, which aimed to firstly overwrite\nany file outside of the any common *nix installation: bin, boot, dev, lib, proc, sbin, sys, sur, etc. to then\ndelete data from /dev/.\n\n**CaddyWiper**\n\nThe first version of CaddyWiper was discovered by ESET researchers on 2022-03-14 when it was used\nagainst a Ukrainian bank. This new wiper variant does not have any significant code similarities to previous\nwipers. This sample specifically sets an exclusion to avoid infecting Domain Controllers in the infected\nsystem. Afterwards, it targets C:/Users and any additional attached drive all the way to letter Z:/ and zeroes\nall the files present in such folders/drives. Finally, the extended information of the physical drives is\ndestroyed, including the MBR and partition entries.\n\nA variant of CaddyWiper was used again on 2022-04-08 14:58 against high-voltage electrical substations in\nUkraine. This latest version of the wiper was delivered together with Industroyer2, an evolution of\nIndustroyer, which has the main functionn being to communicate with industrial equipment. In this case, the\nwiper was used with the purpose of slowing down the recovery process from the Industroyer2 attack and\n\n\n-----\n\ngaining back control of the ICS consoles, as well as covering the tracks of the attack. According to\n[Welivesecurity, who have been cooperating with CERT-UA in this investigation, the Sandworm Team is](https://www.welivesecurity.com/)\nbehind this latest attack.\n\nIn this same attack against the energy station in Ukraine, other wiper samples for Linux and Solaris were\nobserved by WeliveSecurity. These wipers leverage the shred command if present, otherwise they use the\nbasic dd or rm commands to wipe the system.\n\n**DoubleZero wiper**\n\n[On March 22, 2022 CERT-UA reported a new wiper used against their infrastructure and enterprises.](https://cert.gov.ua/article/38088)\nNamed DoubleZero, the wiper was distributed as a ZIP file containing an obfuscated .NET program. The\nwiper’s routine sets a hardcoded list of system directories, which are skipped during an initial wiping\ntargeting user files. Afterwards, the skipped system directories are targeted and finally the registry hives:\nHKEY_LOCAL_MACHINE (containing the hives Sam, Security, Software and System),\nHKEY_CURRENT_USER and HKEY_USERS.\n\nThere are two wiping methods, both of which zero out the selected file.\n\nFigure 5. DoubleZero first wiping function.\n\n## Conclusion\n\nAs we have seen in the examples above, the main objective of the attackers behind wipers is to destroy all\npossible data and render systems unbootable (if possible), potentially requiring a full system restore if\nbackups aren’t available. These malware attacks can be as disruptive as ransomware attacks, but wipers\nare arguably worse since there is no potential escape door of a payment to recover the data.\n\nThere are plenty of ways to wipe systems. We've looked at 6 different wiper samples observed targeting\nUkranian entities. These samples approach the attack in very different ways, and most of them occur faster\nthan the time required to respond. For that reason, it is not effective to employ detection of wiper malware,\nas once they are in the system as it is already too late. The best approach against wipers is to prevent\nattacks by keeping systems up to date and by increasing cybersecurity awareness. In addition,\nconsequences can be ameliorated by having periodic backup copies of key infrastructure available.\n\n## Associated indicators (IOCs)\n\nThe following technical indicators are associated with the reported intelligence. A list of indicators is also\navailable in the following OTX Pulses:\n\n\n-----\n\nPlease note, the pulses may include other activities related but out of the scope of the report.\n\nTYPE INDICATOR DESCRIPTION\n\nSHA256 a196c6b8ffcb97ffb276d04f354696e2391311db3841ae16c8c9f56f36a38e92 WhisperKill\n(stage1.exe)\n\nSHA256 dcbbae5a1c61dbbbb7dcd6dc5dd1eb1169f5329958d38b58c3fd9384081c9b78 WhisperKill\n(stage2.exe)\n\nSHA256 0385eeab00e946a302b24a91dea4187c1210597b8e17cd9e2230450f5ece21da HermeticWiper\n\nSHA256 1bc44eef75779e3ca1eefb8ff5a64807dbc942b1e4a2672d77b9f6928d292591 HermeticWiper\n\nSHA256 13037b749aa4b1eda538fda26d6ac41c8f7b1d02d83f47b0d187dd645154e033 IsaacWiper\n\nSHA256 9b4dfaca873961174ba935fddaf696145afe7bbf5734509f95feb54f3584fd9a AcidRain\n\nSHA256 47f521bd6be19f823bfd3a72d851d6f3440a6c4cc3d940190bdc9b6dd53a83d6 AcidRain\n\nSHA256 Fc0e6f2effbfa287217b8930ab55b7a77bb86dbd923c0e8150551627138c9caa CaddyWiper\n\nSHA256 7062403bccacc7c0b84d27987b204777f6078319c3f4caa361581825c1a94e87 Industroyer2\n\nSHA256 3b2e708eaa4744c76a633391cf2c983f4a098b46436525619e5ea44e105355fe DoubleZero\n\nSHA256 30b3cbe8817ed75d8221059e4be35d5624bd6b5dc921d4991a7adc4c3eb5de4a DoubleZero\n\n## Mapped to MITRE ATT&CK\n\n### The findings of this report are mapped to the following MITRE ATT&CK Matrix techniques:\n\nTA0001: Initial Access\n\nT1190: Exploit Public-Facing Application\nTA0002: Execution\n\nT1047: Windows Management Instrumentation\nT1569: System Services\n\nT1569.002: Service Execution\nTA0008: Lateral Movement\n\nT1021: Remote Services\n\nT1021.002: SMB/Windows Admin Shares\n\n\n-----\n\nTA0005: Defense Evasion\n\nT1070: Indicator Removal on Host\n\nT1070.004: File Deletion\nT1070.001: Clear Windows Event Logs\nT1112: Modify Registry\nT1484: Domain Policy Modification\n\nT1484.001: Group Policy Modification\nTA0011: Command and Control\n\nT1102: Web Service\n\nT1102.003: One-Way Communication\nTA0040: Impact\n\nT1485: Data Destruction\nT1499: Endpoint Denial of Service\nTA0042: Resource Development\n\nT1588: Obtain Capabilities\n\nT1588.003: Code Signing Certificates\n\n### Share this with others\n\nTags: [wiper malware,](https://cybersecurity.att.com/blogs/tag/wiper+malware) [doublezero wiper,](https://cybersecurity.att.com/blogs/tag/doublezero+wiper) [acidrain,](https://cybersecurity.att.com/blogs/tag/acidrain) [isaacwiper,](https://cybersecurity.att.com/blogs/tag/isaacwiper) [caddywiper,](https://cybersecurity.att.com/blogs/tag/caddywiper) [hermeticwiper,](https://cybersecurity.att.com/blogs/tag/hermeticwiper) [whisperkill](https://cybersecurity.att.com/blogs/tag/whisperkill)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-02 - Analysis on recent wiper attacks- examples and how wiper malware works.pdf"
    ],
    "report_names": [
        "2022-05-02 - Analysis on recent wiper attacks- examples and how wiper malware works.pdf"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536140,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1653752589,
    "ts_modification_date": 1653752589,
    "files": {
        "pdf": "https://archive.orkl.eu/5ab55e33f38f86c7b5390bdc1e3e16b267cd25be.pdf",
        "text": "https://archive.orkl.eu/5ab55e33f38f86c7b5390bdc1e3e16b267cd25be.txt",
        "img": "https://archive.orkl.eu/5ab55e33f38f86c7b5390bdc1e3e16b267cd25be.jpg"
    }
}