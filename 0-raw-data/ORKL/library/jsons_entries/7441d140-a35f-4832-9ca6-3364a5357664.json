{
    "id": "7441d140-a35f-4832-9ca6-3364a5357664",
    "created_at": "2023-01-12T15:08:36.600173Z",
    "updated_at": "2025-03-27T02:05:24.226832Z",
    "deleted_at": null,
    "sha1_hash": "22f4b8479cdfa9cbdb7ebde042c4a12b3e6a347c",
    "title": "2019-12-16 - Momentum Botnet's Newest DDoS Attacks and IoT Exploits",
    "authors": "",
    "file_creation_date": "2022-05-29T10:36:46Z",
    "file_modification_date": "2022-05-29T10:36:46Z",
    "file_size": 716539,
    "plain_text": "# Momentum Botnet's Newest DDoS Attacks and IoT Exploits\n\n**[trendmicro.com/en_us/research/19/l/ddos-attacks-and-iot-exploits-new-activity-from-momentum-botnet.html](https://www.trendmicro.com/en_us/research/19/l/ddos-attacks-and-iot-exploits-new-activity-from-momentum-botnet.html)**\n\nDecember 16, 2019\n\n[We recently found notable malware activity affecting devices running Linux, a platform that has battled numerous issues just this year. Further](https://blog.trendmicro.com/trendlabs-security-intelligence/a-quick-and-efficient-method-for-locating-the-main-function-of-linux-elf-malware-variants/)\nanalysis of retrieved malware samples revealed that these actions were connected to a botnet called Momentum (named for the image found\nin its communication channel). We found new details on the tools and techniques the botnet is currently using to compromise devices and\nperform distributed denial-of-service (DDoS) attacks.\n\nMomentum targets the Linux platform on various CPU architectures such as ARM, MIPS, Intel, Motorola 68020, and more. The main purpose\nof this malware is to open a backdoor and accept commands to conduct various types of DoS attacks against a given target. The backdoors\nbeing distributed by the Momentum botnet are Mirai, Kaiten, and Bashlite variants; the specific sample we analyzed was pushing a Mirai\nbackdoor. Moreover, Momentum spreads via exploiting multiple vulnerabilities on various routers and web services to download and execute\nshell scripts on the target devices.\n\n**How does Momentum work?**\n\nAfter infecting a device, Momentum attempts to achieve persistence by modifying the “rc” files; then it joins the command and control (C&C)\nserver and connects to an internet relay chat (IRC) channel called #HellRoom to register itself and accept commands. The IRC protocol is the\nmain method of communication with the command and control (C&C) servers. The botnet operators can then control infected systems by\nsending messages to the IRC channel.\n\n\n-----\n\ngu e te a ected de ce jo s t e attac e s C co a d a d co t o c a e\n\nFigure 2. Command and control communication path (downloader/distributer server, IRC server)\n\nThe distribution server (as seen above) hosts the malware executables. The other server is a C&C server for the botnet. The C&C servers\nwere live as recently as November 18 2019.\n\nOnce the communication lines are established, Momentum can use various commands to attack using the compromised devices. In particular,\nMomentum can deploy 36 different methods for DoS, as listed below.\n\n**Command** **Description**\n\nACK ACK flooder\n\nADV-TCP TCP flooding - Improved SSYN Attack\n\nBLACKNURSE An ICMP packet flooder\n\nDNS DNS amplification flooder\n\nECE attacking (Not in use) Type of SYN flood\n\nESSYN ExecuteSpoofedSyn Flooder\n\nFIN attacking (Not in use) FIN flood\n\nFRAGACK ACK Fragmentation Flood\n\nFRAG-TCP Spoofed TCP Fragmentation Flooder\n\nGRE GRE flood\n\nHOLD (Not in use) TCP connect flooder(frag)\n\nHTTP HTTP Flooder\n\nHTTPFLOOD HTTP flooding\n\n\n-----\n\nJUNK TCP flooder (frag)\n\nLDAP LDAP amplification flooder\n\nMEMCACHE MEMCACHE amplification flooder\n\nNSACK Type of ACK flood\n\nNSSYN Type of SYN flooder\n\nOVH Type of UDP flooding (DOMINATE)\n\nPHATWONK Multiple attacks in one e.g. xmas, all flags set at once, usyn (urg syn), and any TCP flag combination.\n\nRTCP A Random TCP Flooder Fragmented packet header\n\nSACK Type of TCP flood\n\nSEW Attack Type of SYN flood\n\nSSYN2 Type of SYN flood\n\nSTUDP STD Flooder\n\nSTUDP STD Flooder\n\nSYN SYN flooder\n\nSYNACK SYN-ACK flood\n\nTCPNULL TCP-Nulled flooding - Flood with TCP packets with no flag set\n\nUDP UDP flood\n\nUDP-BYPASS A udp flooder (vulnMix)\n\nUNKNOWN UDP Flooder\n\nURG attacking \nVOLT-UDP Spoofed UDP Flooder, Can Bypass most firewall\n\nVSE Valve Source Engine Amplification\n\nXMAS TCP Xmas flood\n\nTable 1. Various DoS methods that Momentum is capable of\n\nThe malware uses known reflection and amplifications methods that have a variety of targets: MEMCACHE, LDAP, DNS and Valve Source\nEngine. In these types of attack, the malware typically spoofs source IP addresses (the victims) to various services run on publicly accessible\nservers, provoking a flood of responses to overwhelm the victim’s address.\n\nApart from DoS attacks, we found that Momentum is also capable of other actions: opening a proxy on a port on a specified IP, changing the\nnick of the client, disabling or enabling packeting from the client, and more. In the section below we will run through the specific attack\ncapabilities of Momentum:\n\n**Momentum’s denial-of-service attacks**\n\n_LDAP DDoS reflection_\n\nIn a LDAP DDoS reflection, the malware spoofed the source IP address of a target system to publicly accessible LDAP servers which causes it\nto send a larger response to the target.\n\n_Memcache attack I_\n\nIn a Memcache attack, a remote attacker constructs and sends a malicious UDP request using a spoofed source IP address of a target system\nto a vulnerable UDP memcached server. The memcached server then sends a significantly large response to the target. Momentum uses an\nHTTP GET request to download a reflection file—the malware uses the same request for the same purpose in other amplified DoS attacks as\nwell.\n\nBased on initial data from Shodan, there are over 42,000 vulnerable memcached servers that can be affected by this type of attack.\n\nThe Momentum botnet uses the following HTTP GET request to download reflection file:\n\nGET / HTTP/1.1\n\n\n-----\n\nUse ge t o a/ 5 [e ] ( ; U; u 6 3 686)\n\nHost: <HOST_Address>:80\n\nAccept: */*\n\nConnection: Keep-Alive\n\n_UDP-BYPASS attack_\n\nIn a UDP-BYPASS attack, Momentum floods the target host by constructing and unloading a legitimate UDP payload on a specific port. Upon\nexecution of this attack the malware chooses a random port and a corresponding payload, then sends it against the targeted host. The\nmalware uses multi-threading for this attack; each thread takes a port followed by its payload.\n\nThe following is list of some ports followed by their payload:\n\n**Port** **Payload**\n\n500 \\x00\\x11\\x22\\x33\\x44\\x55\\x66\\x77\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x10\\x02\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\xC0\\x00\\x00\\x00\\xA4\\\n\n1434 \\x02\n\n5353 \\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x09_services\\x07_dns-sd\\x04_udp\\x05local\\x00\\x00\\x0C\\x00\\x01\n\n8767 xf4\\xbe\\x03\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x002x\\xba\\x85\\tTeamSpeak\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\n\n9987 \\x05\\xca\\x7f\\x16\\x9c\\x11\\xf9\\x89\\x00\\x00\\x00\\x00\\x02\\x9d\\x74\\x8b\\x45\\xaa\\x7b\\xef\\xb9\\x9e\\xfe\\xad\\x08\\x19\\xba\\xcf\\x41\\xe0\\x16\\xa2\\x32\\\n\n1604 \\x1e\\x00\\x01\\x30\\x02\\xfd\\xa8\\xe3\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\n\n1900 \\x4d\\x2d\\x53\\x45\\x41\\x52\\x43\\x48\\x20\\x2a\\x20\\x48\\x54\\x54\\x50\\x2f\\x31\\x2e\\x31\\x0D\\x0A\\x48\\x6f\\x73\\x74\\x3a\\x32\\x33\\x39\\x2e\\x32\\x35\\x\n\n623 \\x06\\x00\\xff\\x07\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x09\\x20\\x18\\xc8\\x81\\x00\\x38\\x8e\\x04\\xb5\n\n626 SNQUERY: 127.0.0.1:AAAAAA:xsvr\n\n1194 8d\\xc1x\\x01\\xb8\\x9b\\xcb\\x8f\\0\\0\\0\\0\\0\n\n520 \\x01\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\n\n177 \\x00\\x01\\x00\\x02\\x00\\x01\\x00\n\n389 \\x30\\x84\\x00\\x00\\x00\\x2d\\x02\\x01\\x07\\x63\\x84\\x00\\x00\\x00\\x24\\x04\\x00\\x0a\\x01\\x00\\x0a\\x01\\x00\\x02\\x01\\x00\\x02\\x01\\x64\\x01\\x01\\x00\\x\n\n161 \\x30\\x3A\\x02\\x01\\x03\\x30\\x0F\\x02\\x02\\x4A\\x69\\x02\\x03\\x00\\xFF\\xE3\\x04\\x01\\x04\\x02\\x01\\x03\\x04\\x10\\x30\\x0E\\x04\\x00\\x02\\x01\\x00\\x02\n\n53 %getPayload%getPayload\\x01\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x03\\x77\\x77\\x77\\x06\\x67\\x6f\\x6f\\x67\\x6c\\x65\\x03\\x63\\x6f\\x6d\\x00\\x\n\n7 \\x0D\\x0A\\x0D\\x0A\n\n111 \\x72\\xFE\\x1D\\x13\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\x00\\x01\\x86\\xA0\\x00\\x01\\x97\\x7C\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\n\nTable 2. Ports and their payloads\n\nMost of the scripts seen above are used for service discovery. If they are sent to the target device over a long period of time, denial-of-service\nmay be achieved because they crash a service as a side effect of testing.\n\n_Phatwonk attacks_\n\nPhatwonk attacks perform multiple DoS methods at once: XMAS, all flags at once, usyn (urg syn), and any TCP flag combination.\n\n**Momentum’s other capabilities**\n\nFruitful attacks are also dependent on other capabilities than outright offense. Usually malware attempt to evade detection, maintain open\navenues of communication, and more for a sustained successful campaign.\n\nMomentum has other capabilities that help it spread and compromise devices:\n\n\n-----\n\n_ast u_ e o e tu bot et uses t e ast u tec que o de to a e ts co a d a d co t o et o o e es e t ast u\nnetwork means having multiple IP addresses associated with a domain name and then constantly changing them in quick succession—\nthis is used by attackers to mislead or evade security investigators.\n_Backdoor. The attacker can send a command (“BASH”, “SHD” or SH commands) to the IRC channel and malware clients will receive and_\nexecute it on an infected system. The result will be sent back to the same IRC channel where the attacker executed it.\n_Propagate. Momentum propagates by trying to exploit the vulnerabilities listed in the table below. The particular C&C server that we have_\nbeen investigating has 1,232 victims shown. For other Momentum variants and C&C servers there may be more.\n\n**Vulnerability** **Exploit Format**\n\n[CCTV-DVR RCE](https://www.exploit-db.com/exploits/39596) [Several vendors](https://www.exploit-db.com/exploits/39596)\n\n[ZyXEL Router (appears to be incomplete exploit, similar to this)](https://seclists.org/fulldisclosure/2017/Jan/40)\n\n[Huawei Router](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17215)\n\nSeveral vendors: Crestron AM, Barco wePresent WiPG, Extron ShareLink, Teq AV IT,\nSHARP PN-L703WA, Optoma WPS-Pro, Blackbox HD WPS, InFocus LiteShow Remote\n[Command Injection  (Similar to CVE 2019-3929 and this)](https://www.exploit-db.com/exploits/46786)\n\n[D-Link HNAP1](https://dl.packetstormsecurity.net/papers/attack/dlink_hnap_captcha.pdf)\n\n\n-----\n\n[Realtek SDK UPnP SOAP Command Execution](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-8361)\n\n[GPON80](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10562)\n\n[GPON8080](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10562)\n\n[GPON443](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10562)\n\n[JAWS Webserver unauthenticated shell command execution](https://www.exploit-db.com/exploits/41471)\n\n[Vacron NVR RCE](https://vulners.com/openvas/OPENVAS:1361412562310107187)\n\n[UPnP SOAP Command Execution (similar to this)](https://www.exploit-db.com/exploits/40740)\n\n\n-----\n\n[THINK-PHP](https://www.exploit-db.com/exploits/46150)\n\n[HooTooTripMate RCE](https://www.exploit-db.com/exploits/46143)\n\nTable 3. Vulnerabilities and exploits used in propagation\n\n**Security recommendations and solutions**\n\nSmart and connected devices are prone compromise because of limited security settings and protection options. The devices themselves are\n[often manufactured with operation in mind, not security. Users should take proactive steps in securing their devices, particularly](https://www.trendmicro.com/vinfo/hk-en/security/news/internet-of-things/the-first-steps-in-effective-iot-device-security) [routers. As](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/home-router)\n[mentioned above, the Momentum botnet targets Linux devices which are known to be susceptible to attacks involving botnets,](https://blog.trendmicro.com/trendlabs-security-intelligence/aesddos-botnet-malware-infiltrates-containers-via-exposed-docker-apis/) [ransomware](https://blog.trendmicro.com/trendlabs-security-intelligence/erebus-resurfaces-as-linux-ransomware/)\n[and cryptocurrency miners. However, there are different](https://www.trendmicro.com/vinfo/ph/security/news/cybercrime-and-digital-threats/cryptocurrency-mining-malware-targets-linux-systems-uses-rootkit-for-stealth?_ga=2.76607573.1739751013.1575426438-61030443.1557222425) [ways to protect such devices from attacks.](https://blog.trendmicro.com/trendlabs-security-intelligence/a-quick-and-efficient-method-for-locating-the-main-function-of-linux-elf-malware-variants/)\n\n[Trend Micro Home Network Security provides an embedded network security solution that protects all devices connected to a home network](https://www.trendmicro.com/en_us/forHome/products/homenetworksecurity.html)\nagainst cyberattacks. Based on Trend Micro’s rich threat research experience and industry-leading deep packet inspection (DPI) technology,\nTrend Micro Smart Home Network offers intelligent quality of service (iQoS), parental controls, network security, and more.\n\n[Trend Micro™ Deep Discovery™ provides detection, in-depth analysis, and proactive response to attacks using exploits and similar threats](https://www.trendmicro.com/en_us/business/products/network/advanced-threat-protection/inspector.html)\n[through specialized engines, custom sandboxing, and seamless correlation across the entire attack life cycle, allowing it to detect these kinds](https://blog.trendmicro.com/trendlabs-security-intelligence/deploying-a-smart-sandbox-for-unknown-threats-and-zero-day-attacks/)\n[of attacks even without engine or pattern updates. These solutions are powered by XGen™ security, which provides a cross-generational](https://www.trendmicro.com/en_us/business/products/all-solutions.html)\n[blend of threat defense techniques against a full range of threats for data centers,](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/security-data-center-virtualization.html) [cloud environments,](https://www.trendmicro.com/en_us/business/products/hybrid-cloud.html) [networks, and](https://www.trendmicro.com/en_us/business/products/network.html) [endpoints. Smart,](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\noptimized, and connected, XGen powers Trend Micro’s suite of security solutions: Hybrid Cloud Security, User Protection, and Network\nDefense.\n\n**Indicator of Compromise**\n\n**SHA-256** **Detection**\n\n3c6d31b289c46b98be7908acd84086653a0774206b3310e0ea4e6779e1ff4124 Trojan.Linux.MIRAI.SMMR1\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-16 - Momentum Botnet's Newest DDoS Attacks and IoT Exploits.pdf"
    ],
    "report_names": [
        "2019-12-16 - Momentum Botnet's Newest DDoS Attacks and IoT Exploits.pdf"
    ],
    "threat_actors": [
        {
            "id": "58db0213-4872-41fe-8a76-a7014d816c73",
            "created_at": "2023-01-06T13:46:38.61757Z",
            "updated_at": "2025-03-27T02:00:02.874484Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "BRONZE HUNTLEY",
                "Red Beifang",
                "G0131",
                "PLA Unit 65017",
                "Earth Akhlut",
                "TAG-74",
                "CactusPete",
                "KARMA PANDA"
            ],
            "source_name": "MISPGALAXY:Tonto Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "da483338-e479-4d74-a6dd-1fb09343fd07",
            "created_at": "2022-10-25T15:50:23.698197Z",
            "updated_at": "2025-03-27T02:00:55.526588Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Tonto Team",
                "Earth Akhlut",
                "BRONZE HUNTLEY",
                "CactusPete",
                "Karma Panda"
            ],
            "source_name": "MITRE:Tonto Team",
            "tools": [
                "Mimikatz",
                "Bisonal",
                "ShadowPad",
                "LaZagne",
                "NBTscan",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536116,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1653820606,
    "ts_modification_date": 1653820606,
    "files": {
        "pdf": "https://archive.orkl.eu/22f4b8479cdfa9cbdb7ebde042c4a12b3e6a347c.pdf",
        "text": "https://archive.orkl.eu/22f4b8479cdfa9cbdb7ebde042c4a12b3e6a347c.txt",
        "img": "https://archive.orkl.eu/22f4b8479cdfa9cbdb7ebde042c4a12b3e6a347c.jpg"
    }
}