{
    "id": "b50fadad-22eb-4825-be9e-8b2f087e852c",
    "created_at": "2023-01-12T15:09:28.34257Z",
    "updated_at": "2025-03-27T02:05:19.533201Z",
    "deleted_at": null,
    "sha1_hash": "a318004231239c80b137ef43548fb9092346f3ef",
    "title": "2020-12-17 - The Dangers of Using Abandoned Plugins & Themes",
    "authors": "",
    "file_creation_date": "2022-05-28T04:03:15Z",
    "file_modification_date": "2022-05-28T04:03:15Z",
    "file_size": 314597,
    "plain_text": "# Sucuri Blog\n\n**[blog.sucuri.net/2020/12/the-dangers-of-using-abandoned-plugins-themes.html](https://blog.sucuri.net/2020/12/the-dangers-of-using-abandoned-plugins-themes.html)**\n\nKrasimir Konov December 17, 2020\n\nIt’s not very often that we see abandoned components being used on a website — but when\nwe do, it’s most often because the website was exhibiting malware-like behavior and we\nwere called to investigate and clean up the site.\n\nOld and abandoned plugins and themes are a good target for opportunistic attackers who\nare looking for any expired domains that might be used by those components. Once an\nattacker gets a hold of those domains, they’re able to distribute malware to any users that\nstill have that resource installed on their site. Here’s an example of that exact scenario.\n\n## Expired Domain for My Weather Plugin\n\nThe plugin was called “My Weather” and one of its main functions was to show weather\nwidgets on a website. The data for weather information was retrieved by the plugin from an\nexternal domain (weatherforecastmap[.]com), which happened to expire.\n```\n$widget_call_string = 'hxxp://weatherforecastmap[.]com/' . $typeflag;\n$widget_call_string .= '.php?zona='.$country_name;\n$widget_call_string .= '_'.$city;\n$widget_call_string = str_replace(\" \", \"-\", $widget_call_string);\n$widget_call_string = strtolower($widget_call_string);\nif($fahrenheitflag != 0)\n      $widget_call_string = str_replace(\".php\", \"F.php\", $widget_call_string);\n\n```\n\n-----\n\n## Weather Data Replaced with Malicious Injections\n\nThe URL generated by the plugin for the weather data was based on the city and country —\nfor example: hxxps://weatherforecastmap[.]com/weather3F.php?zona=mexico_playa**del-carmen**\n```\necho '<script type=\"text/javascript\" src=\"'.$widget_call_string . '\"></script>';\n\n```\nAttackers were able to register the domain and, instead of serving the weather information,\nthey replaced the data source with a malicious JavaScript injection which was loaded on a\nuser’s browser whenever they visited a site using the abandoned My Weather plugin.\n\n## Unwanted Browser Add-ons & Advertisements\n\nThis injection resulted in a redirect to another domain:\n“hxxp://fnacgbik9v14[.]com/hdzi0thtzm”.Upon further investigation, we found that the newly\nregistered domain was distributing malware which tricks the user into installing a malicious\ncomponent/extension on their browser. Post-install, additional ads were then served from\nanother malicious domain — terraclicks[.]com.\nThis example clearly demonstrates how outdated and abandoned components can put your\nsite at risk. We recommend keeping all software updated to prevent these types of issues\nfrom impacting your site’s reputation — and if you happen to have a plugin, theme, or\ncomponent on your site that you aren’t using, get rid of it.\n\n[Another way to mitigate risk is to add a WAF (Web Application Firewall) to your website.](https://sucuri.net/website-firewall/)\nWAFs can prevent many attacks, especially if you have old or outdated plugins which may\ncontain known vulnerabilities — the firewall will be able to virtually patch your software until\nyou get the chance to update or transition to a new one.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-17 - The Dangers of Using Abandoned Plugins & Themes.pdf"
    ],
    "report_names": [
        "2020-12-17 - The Dangers of Using Abandoned Plugins & Themes.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536168,
    "ts_updated_at": 1743041119,
    "ts_creation_date": 1653710595,
    "ts_modification_date": 1653710595,
    "files": {
        "pdf": "https://archive.orkl.eu/a318004231239c80b137ef43548fb9092346f3ef.pdf",
        "text": "https://archive.orkl.eu/a318004231239c80b137ef43548fb9092346f3ef.txt",
        "img": "https://archive.orkl.eu/a318004231239c80b137ef43548fb9092346f3ef.jpg"
    }
}