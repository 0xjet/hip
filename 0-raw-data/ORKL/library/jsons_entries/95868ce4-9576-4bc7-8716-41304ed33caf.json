{
    "id": "95868ce4-9576-4bc7-8716-41304ed33caf",
    "created_at": "2023-01-12T15:07:20.452357Z",
    "updated_at": "2025-03-27T02:09:24.552101Z",
    "deleted_at": null,
    "sha1_hash": "6cfbbf3e34867d87cf9dd106d0bfa6460954bdbd",
    "title": "2021-08-24 - ​A Deep-dive Analysis of KARMA Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-27T23:05:35Z",
    "file_modification_date": "2022-05-27T23:05:35Z",
    "file_size": 1598092,
    "plain_text": "# A Deep-dive Analysis of KARMA Ransomware\n\n**[blog.cyble.com/2021/08/24/a-deep-dive-analysis-of-karma-ransomware/](https://blog.cyble.com/2021/08/24/a-deep-dive-analysis-of-karma-ransomware/)**\n\nAugust 24, 2021\n\nWhile performing our routine Open-Source Intelligence (OSINT) research, Cyble Research Labs came\nacross a ransomware group known as KARMA, which encrypts files on the victim’s machine and\nappends the extension of encrypted files to .KARMA. Subsequently, the Threat Actors\n(TAs) demand that the victims pay ransom for the private key to recover their data.\n\nBased on analysis by Cyble Research Labs, we have observed that the executable payload is a consolebased application.\n\nFigure 1 shows the execution flow of the Karma ransomware. After execution, the malware takes\ninputs from the user and checks all A-Z drives, excludes folders and files from encryption. After this, the\nransomware proceeds to drop the ransom note and replaces the original content with encrypted\ncontent. It then appends the extension as .KARMA.\n\n_Figure 1 Execution Flow of Karma Ransomware_\n\n\n-----\n\n## Technical Analysis\n\nOur static analysis found that the malware is a console-based x86 architecture executable written in\nC/C++, as shown in Figure 2.\n\n_Figure 2 Malware Payload Static Information_\nAfter encrypting the files, the ransomware payload drops the ransom note named KARMA_ENCRYPTED.txt in various places in the victim’s machine, as shown in Figure 3._\n\n_Figure 3 Ransom Note_\nIn the above ransom note, the TAs have given email support\nIDs ” _[JamesHoopkins1988@onionmail[.]org“,](http://10.10.0.46/mailto:JamesHoopkins1988@onionmail%5B.%5Dorg)_ _[Leslydown1988@tutanota[.]com“, “](http://10.10.0.46/mailto:Leslydown1988@tutanota%5B.%5Dcom)_\n\n\n-----\n\n_[ollivergreen1977@protonmail[.]com . The victims are asked to reach out to the attackers and pay the](http://10.10.0.46/mailto:ollivergreen1977@protonmail%5B.%5Dcom)_\nransom amount in Bitcoin (BTC) to get the private decryption key.\n\nAfter execution, the malware encrypts the files and appends the extension of encrypted\nfiles as .KARMA and drops ransom note as shown in Figure 4.\n\n_Figure 4 Encrypted_\n\n_Files_\nUpon execution, a Mutex with the name KARMA is createdto ensure that only one instance\nof this ransomware is running at a time, as shown in Figure 5.\n\n_Figure 5 Malware Creates Mutex_\n\nThe malware payload uses the crypt32.dll library, a module used to implement certificate\nand cryptographic messaging functions in the CryptoAPI, as shown below.\n\n_Figure 6 Malware Loads Library crypt32.dll_\n\nAs shown in Figure 7, the malware payload first gets the command-line string and checks if the argument\nis less or equal to 1. It then creates threads depending on the logical drive present in the victim\nmachine.\n\nIf the argument is greater than 1, the malware checks whether the passed argument is a directory.\n\nIf a directory is found, the payload encrypts the directory and its content. Furthermore, if the argument is\nfor any specific file, the malware will start encrypting that file as well.\n\n\n-----\n\n_Figure 7 Malware Encryption Process_\nThe malware payload iterates through all possible A-Z drives on the Windows machine and verifies if the\ndrives are logical, after which it creates a thread. Refer to Figure 8.\n\n_Figure 8 Malware Verifies the Windows Drives and Creates Thread_\n\n\n-----\n\nThe malware excludes the list of folders shown in Table 1 from the encryption routine as shown in Figure\n9.\n\nFolders\n\nAll Users\n\nProgram Files\n\nProgram Files x86\n\nWindows\n\nRecycle bin\n\n_Figure 9 Malware Exclude Folders from Encryption_\nThe malware excludes the list of types of files shown in Table 2 from the encryption routine, as shown\nin Figure 10.\n\nFile Type Description\n\n.EXE Executable\n\n.DLL Dynamic Link Library\n\n.INI Initialization\n\n.URL Uniform Resource Locator\n\n.LNK Link\n\n_Table 2 Excluded Files List_\n\n\n-----\n\n_Figure 10 Malware Excludes Files from Encryption_\nThe malware initially searches for folders, for example, config.Msi in C drive. If it can successfully locate\nthese folders, it performs further actions, as shown in Figure 11.\n\n_Figure 11 Malware Searches for the Folder_\nAfter finding the required folders, the malware creates the ransom note, as shown in Figure 12.\n\n\n-----\n\n_Figure 12 Malware Writes Ransom Note_\nAs seen in Figure 13, the malware generates a seed after creating the ransom note.\n\n_Figure 13 Malware Generates Seed_\nThe malware reads the content and writes encrypted data, as shown in Figure 14.\n\n_Figure 14 Malware Reads the Content and Writes Encrypted Content_\nFigure 15 shows the encryption routine performed by the malware.\n\n\n-----\n\n_Figure 15 Encryption Routine_\nAfter encrypting the files, the malware replaces the original content with encrypted content with appended\nextension as .KARMA, as shown in Figure 16.\n\n_Figure 16 Malware Replaces Original Content with Encrypted Content_\nThe TOR website hxxp://3nvzqyo6l4wkrzumzu5aod7zbosq4ipgf7ifgj3hsvbcr5vcasordvqd[.]onion/shown in\nFigure 17 was present in the ransom note, in the contact section of the website, TAs have\nmentioned two email IDs jeffreyclinton1977@onionmail.org and jackiesmith176@protonmail.com,\nwhich the victims can use to communicate with them to recover the data\n\n\n-----\n\n_Figure 17 Ransomware Tor Website_\n\n## Conclusion \n\nRansomware groups continue to pose a severe threat to firms and individuals. Organizations need to\nstay ahead of the techniques used by TAs, besides implementing the requisite security best practices\nand security controls.\n\nRansomware victims are at risk of losing valuable data as a result of such attacks, resulting in financial\nloss and lost productivity. In the event that the victim is unable or unwilling to pay the ransom, the TA may\nleak or sell this data online. This will not only compromise sensitive user data in the case of banks, online\nshopping portals etc, but it will also lead to a loss of reputation for the affected firm.\n\nCyble Research Lab is continuously monitoring KARMA’s extortion campaign and will keep our readers\nup to date with new information.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow these suggestions given below:\n\nConduct regular backup practices and keep those backups offline or on a separate network.\nRegularly perform the vulnerability assessment of the organizational assets majorly which are\nexposed on internet.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\nAvoid using software cracks or keygens from torrent or third-party servers.\nUse strong passwords and enforce multi-factor authentication wherever possible.\nTurn on the automatic software update feature on your computer, mobile, and other connected\ndevices wherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected devices,\nincluding PC, laptop, and mobile.\n\n\n-----\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Initialaccess** [T1190](https://attack.mitre.org/techniques/T1190/) Exploit Public-Facing Application\n\n\n**DefenseEvasion** [T1112](https://attack.mitre.org/techniques/T1112)\n[T1027](https://attack.mitre.org/techniques/T1027)\n[T1562.001](https://attack.mitre.org/techniques/T1562/001/)\n\n**Discovery** [T1083](https://attack.mitre.org/techniques/T1083)\n[T1135](https://attack.mitre.org/techniques/T1135)\n\n**Impact** [T1486](https://attack.mitre.org/techniques/T1486/)\n[T1490](https://attack.mitre.org/techniques/T1490/)\n\n**Indicators of Compromise (IoCs):**\n\n\nModify Registry\nObfuscated Files or Information\nImpair Defences: Disable or Modify Tools\n\nFile and Directory Discovery\nNetwork Share Discovery\n\nData Encrypted for Impact\nInhibit System Recovery\n\n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n\na63937d94b4d0576c083398497f35abc2ed116138bd22fad4aec5714f83371b0 SHA256 HASH\n\nhxxp://3nvzqyo6l4wkrzumzu5aod7zbosq4ipgf7ifgj3hsvbcr5vcasordvqd[.]onion/ URL URL\n\n## About Us\n\n[Cyble is a global threat intelligence SaaS provider that helps enterprises protect themselves from](https://cyble.com/)\ncybercrimes and exposure in the Darkweb. Its prime focus is to provide organizations with real-time\nvisibility to their digital risk footprint. Backed by Y Combinator as part of the 2021 winter cohort, Cyble has\nalso been recognized by Forbes as one of the top 20 Best Cybersecurity Start-ups To Watch In 2020.\nHeadquartered in Alpharetta, Georgia, and with offices in Australia, Singapore, and India, Cyble has a\nglobal presence. To learn more about Cyble, visit [https://cyble.com.](https://cyble.com/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-24 - ​A Deep-dive Analysis of KARMA Ransomware.pdf"
    ],
    "report_names": [
        "2021-08-24 - ​A Deep-dive Analysis of KARMA Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "20c759c2-cd02-45bb-85c6-41bde9e6a7cf",
            "created_at": "2024-01-18T02:02:34.189827Z",
            "updated_at": "2025-03-27T02:02:09.937024Z",
            "deleted_at": null,
            "main_name": "HomeLand Justice",
            "aliases": [
                "Karma",
                "Storm-842",
                "Void Manticore"
            ],
            "source_name": "ETDA:HomeLand Justice",
            "tools": [
                "BABYWIPER",
                "BiBi Wiper",
                "BiBi-Linux Wiper",
                "BiBi-Windows Wiper",
                "Cl Wiper",
                "LowEraser",
                "No-Justice Wiper",
                "Plink",
                "PuTTY Link",
                "RevSocks",
                "W2K Res Kit"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536040,
    "ts_updated_at": 1743041364,
    "ts_creation_date": 1653692735,
    "ts_modification_date": 1653692735,
    "files": {
        "pdf": "https://archive.orkl.eu/6cfbbf3e34867d87cf9dd106d0bfa6460954bdbd.pdf",
        "text": "https://archive.orkl.eu/6cfbbf3e34867d87cf9dd106d0bfa6460954bdbd.txt",
        "img": "https://archive.orkl.eu/6cfbbf3e34867d87cf9dd106d0bfa6460954bdbd.jpg"
    }
}