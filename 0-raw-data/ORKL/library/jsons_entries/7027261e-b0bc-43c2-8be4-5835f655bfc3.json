{
    "id": "7027261e-b0bc-43c2-8be4-5835f655bfc3",
    "created_at": "2023-01-12T15:04:13.476268Z",
    "updated_at": "2025-03-27T02:09:32.89341Z",
    "deleted_at": null,
    "sha1_hash": "f964e6e902788d50057990328f92723051cb1c8d",
    "title": "2019-09-22 - LookBack Forges Ahead- Continued Targeting of the United States’ Utilities Sector Reveals Additional Adversary TTPs",
    "authors": "",
    "file_creation_date": "2022-05-28T17:51:46Z",
    "file_modification_date": "2022-05-28T17:51:46Z",
    "file_size": 1450864,
    "plain_text": "# LookBack Forges Ahead: Continued Targeting of the United States’ Utilities Sector Reveals Additional Adversary TTPs\n\n**[proofpoint.com/us/threat-insight/post/lookback-forges-ahead-continued-targeting-united-states-utilities-sector-reveals](https://www.proofpoint.com/us/threat-insight/post/lookback-forges-ahead-continued-targeting-united-states-utilities-sector-reveals)**\n\nSeptember 22, 2019\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nLookBack Forges Ahead: Continued Targeting of the United States’ Utilities Sector Reveals Additional\nAdversary TTPs\n\n\n-----\n\nSeptember 23, 2019 Michael Raggi and the Proofpoint Threat Insight Team\n\n## Overview\n\nEarly in August, Proofpoint described what appeared to be state-sponsored activity targeting the US\nutilities sector with malware that we dubbed “Lookback” [1]. Between August 21 and August 29, 2019,\nseveral spear phishing emails were identified targeting additional US companies in the utilities sector. The\nphishing emails originated from what appears to be an actor-controlled domain:\nglobalenergycertification[.]net. This domain, like those used in previous campaigns, impersonated a\nlicensing body related to the utilities sector. In this case, it masqueraded as the legitimate domain for\nGlobal Energy Certification (“GEC”). The emails include a GEC examination-themed body and a malicious\nMicrosoft Word attachment that uses macros to install and run LookBack.\n\nPhishing tactics, techniques, and procedures (TTPs) observed in these campaigns are consistent with\npreviously reported activity. Persistent targeting of entities in the utilities sector demonstrates the\ncontinuing risk to US organizations from the actors responsible for LookBack. Proofpoint has identified at\nleast 17 entities in the US utilities sector targeted by these actors from April 5 through August 29, 2019.\n\n## Reconnaissance\n\nProofpoint analysts have determined that, prior to the initiation of the phishing campaigns described here,\nthreat actors conducted reconnaissance scanning against future targets utilizing a staging IP. This is a\nnewly identified TTP not disclosed in our initial publication regarding LookBack. Scanning activity targets\nSMB over IP via port 445 up to two weeks prior to the arrival of phishing emails. Observed scanning IPs in\nsome instances have also hosted phishing domains prior to their use in phishing campaigns.\n\n## Delivery\n\nEmails delivered between August 21 and August 29, 2019, purported to be an invitation to take the Global\nEnergy Certification (“GEC”) exam administered by the Energy Research and Intelligence Institution. The\nemail utilized the GEC logo and originated from an email address at the domain\nglobalenergycertification[.]net which spoofs the legitimate domain globalenergycertification[.]org. The\nemails included the subject line “Take the exam now” and a malicious Microsoft Word document\nattachment named “take the exam now.doc”. This file, like that used in the initial LookBack campaigns,\ncontained VBA macros which led to the installation of LookBack. Unlike earlier campaigns, actors\n\n\n-----\n\nattached a legitimate and benign PDF file for exam preparation which was also hosted on the legitimate\nGEC site. It is likely that this represents social engineering efforts by the actors to legitimize the email to\nrecipients.\n\n_Figure 1: GEC-themed phishing email_\n\nThe emails originated from the IP address 79.141.169[.]3, which appears to be actor-controlled. An\nexamination of passive DNS and domain registration history for globalenergycertification[.]net indicated\nthat it was previously hosted by the IP 103.253.41[.]75. This staging IP previously hosted the domain\nNCEESS[.]com observed in historic LookBack phishing campaigns.\n\n\n**IP** **Domain** **Dates**\n**Registered**\n\n79.141.169[.]3 globalenergycertification[.]net August 1 –\nSeptember 19,\n2019\n\n103.253.41[.]75 globalenergycertification[.]net June 12 – July\n30, 2019\n\n79.141.168[.]137 nceess[.]com June 24 –\nSeptember 19,\n2019\n\n\n**Impersonated Entity**\n\nGlobal Energy Certification\n(“GEC”)\n\nGlobal Energy Certification\n(“GEC”)\n\nNational Council of Examiners for\nEngineering and Surveying\n\n\n-----\n\n103.253.41[.]75 nceess[.]com May 29 – June\n19, 2019\n\n## Exploitation\n\n\nNational Council of Examiners for\nEngineering and Surveying\n\n\nThe attachments titled “take the exam now.doc” contained VBA macros to install LookBack. The macros\nwere mostly the same as those first observed in July and were similarly obfuscated with concatenation\ncommands that made the macros difficult to detect with static signatures. When a user opens the\nmalicious attachment and enables macros, the VBA macro within the Microsoft Word attachment installs\nseveral privacy-enhanced mail (PEM) files on the host. When decoded, we found these to be both\nmalware modules and macro variables. Tempgup.txt, tempgup2.txt, and tempsodom.txt are LookBack\nmodules. Additionally, the file Temptcm.tmp, which is a version of certutil.exe, is dropped concurrently and\nwill be used to decode the initial files. The macro then decodes the PEM files using Temptcm.tmp. The\nmacro next creates a copy of the decoded PEM files restoring their proper file extensions with the\nWindows essentuti.exe:\n\nTempgup.txt becomes GUP.exe, the GUP Proxy tool.\nTempgup2.txt becomes libcurl.dll, a malicious loader.\nTempsodom.txt becomes sodom.txt, which contains command and control configuration data utilized\nby the SodomNormal module.\n\nThese TTPs are consistent with the initial LookBack phishing campaigns observed in July.\n\nWe observed an update in the macros used in the August campaigns which differed from earlier versions.\nThe July version of the macro creates macro variables by saving PEM .txt files to the host after they are\ncompiled from text blobs contained within the Microsoft Word attachment macro. These files (pense1.txt,\npense2.txt, and pense3.txt) contain macro variables that are referred to when the Word document is\nopened and macros are enabled:\n\nPense1.txt contains variables specific to the creation of the GUP proxy tool\nPense2.txt pertains to the libcurl.dll downloader\nPense3.txt appears to be run alongside pense2.txt.\n\nIn the newly observed macros identified in August 2019 campaigns, the three pense[*].txt macro variables\nare replaced with 9 variable files in total. Pense1.txt and pense2.txt appear to remain constant. However,\npense3.txt is replaced with seven additional PEM files that are each run alongside Pense2.txt individually.\nThe ultimate result of this macro execution appears to be the installation of LookBack malware modules\ndescribed above and first observed in July campaigns. However, the method by which this is achieved has\nbeen altered in more recent macros. Analysts have not determined the reason for altering this macro but\nspeculate that by increasing the number of variable files and maintaining the core functionality of the\nmacro, actors are attempting to further obfuscate this installation method to avoid detection.\n\nIt is notable that additional macro variables were utilized in the installation of the libcurl.dll loader while\nboth the GUP proxy tool and sodom configuration file remained the same. The libcurl.dll module contains\nthe subsequent LookBack modules SodomNormal and SodomMain, which are responsible for configuring\nthe local host proxy and performing remote access Trojan functions. This update may represent an\nattempt by actors to obscure the installation of second stage payloads. A more thorough description of\nLookBack module functionality was included in the initial Proofpoint blog on the malware.\n\n\n-----\n\nThe images below offer a comparison of the different macro versions after the majority of concatenation\ncharacters have been removed for legibility.\n\n**July 2019 Macro**\n\n_Figure 2: July 2019 LookBack Phishing Macro (without concatenation)_\n\n**August 2019 Macro**\n\n\n-----\n\n_Figure 3: August 2019 LookBack Phishing Macro (without concatenation)_\n\n## Command and Control Server\n\nAnalysts have determined that the LookBack samples from recent campaigns utilize the same command\nand control (C&C) server, 103.253.41[.]45, observed in July campaigns. The LookBack beacon is\nidentifiable via the URL format below:\n\nC&C host: 103.253.41[.]45\nC&C URL format: http://%s/status[.]gif?r=%d\n\n## Conclusion\n\nNewly discovered LookBack campaigns observed within the US utilities sector provides insight into an\nongoing APT campaign with custom malware and a very specific targeting profile. The threat actors\ndemonstrate persistence when intrusion attempts have been foiled and appear to have been undeterred\nby publications describing their toolset. In addition to the technical commonalities observed, distinct\ncommonalities among the organizations targeted have begun to emerge. The evolution of TTPs including\nupdated macros demonstrates a further departure from tactics previously employed by known APT\ngroups. However, at the current moment, the creators of LookBack malware are yet to depart from their\npersistent focus on critical infrastructure providers in the United States.\n\n## References\n\n\n-----\n\n[1]https://www.proofpoint.com/us/threat-insight/post/lookback-malware-targets-united-states-utilitiessector-phishing-attacks\n\n**Indicators of Compromise (IOCs)**\n\n\n**IOC** **IOC**\n**Type**\n\n\n**Description**\n\n\nb5436fcb8243a14f683b5074084bb3d9ff56cad35d2db2fda53a57fa6c42a22b SHA256 Microsoft\nWord\nAttachment take the exam\nnow.doc\n\n0a79e053e1ca809aa4b0393a12ccd547462bd076dbfcd8f6228d08ce0f486afa SHA256 Benign PDF GECHandbookStudy-Guideweb.pdf\n\n589229e2bd93100049909edf9825dce24ff963a0c465d969027db34e2eb878b4 SHA256 Certutil Tool Temptcm.tmp\n\n449e1ead309934ac2276a5256cd105dd71d5dd14e49c65bdafc203a0d0eac894 SHA256 Sodom\nModule Congif\n\n                                              - sodom.txt\n\n7e5d2994ac1668178db0ee995cf3b6e4b60d437a09fc10f7afe19b0231615ae2 SHA256 Sodom\nModules C2\nConfig tempsodom.txt\n\n0f951b7a68e9c0984a0bee3c44e2d64aeac6320bbc2ba2a0f1420893550cf441 SHA256 Gup Proxy –\nGUP.exe\n\nc87fa8aed595df1dea39a07abdd640842b1c24343841bd72e43668bcfba7eaf1 SHA256 Libcurl.dll\nloader –\nLibcurl.dll\n\n248ff1a9fc2e2c465354f64172224a7c7c0c503cc03ce4524de1a2379692b017 SHA256 Macro\nVariable pense1.txt\n\n68ce133d4b18ddbf04da3462891dc04e945e499e8720183448ddf87e408b98a3 SHA256 Macro\nVariable –\npense2.txt\n\n\n-----\n\n4909d7092a45bc28fa54bb2ef82d426e30a6815fa33a7c00b38b4c3c42960d91 SHA256 Macro\nVariable –\npense31.txt\n\n05f434598b47a63f9f75ae54118fdf5747c02086ff91c1fdc9ac176cd54f102f SHA256 Macro\nVariable –\npense32.txt\n\na1bc6922c73726b0ff4e807ea8869ce0dae1b34bd32752f6708750c3f1fc7382 SHA256 Macro\nVariable –\npense33.txt\n\n06c8eb45345684a8d3ce35be695074d371fa9f79e549e39881298f547c9ffd18 SHA256 Macro\nVariable –\npense34.txt\n\n6e73fd19e883d295c602f1ea349e14a03f8ff47f3dd588683c1f996853a56d98 SHA256 Macro\nVariable –\npense35.txt\n\nbcefb608cc66c93ea42bc5c50903432e6a37466229a534dfeefedfc7c07df1f9 SHA256 Macro\nVariable –\npense36.txt\n\nff98aea1046dd9f8eda0aa1496660742a4295545d061f811ffa2b45c29fdf4c5 SHA256 Macro\nVariable –\npense37.txt\n\n103.253.41[.]45 IP C&C IP\n\n79.141.169[.]3 IP Sender IP\n\n103.253.41[.]75 IP Staging IP\n\nnceess[.]com Domain Phishing\nDomain\n\nglobalenergycertification[.]net Domain Phishing\nDomain\n\n**ET and ETPRO Suricata/Snort Signatures**\n\n2837783 ETPRO TROJAN Win32/LookBack C&C Activity\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-22 - LookBack Forges Ahead- Continued Targeting of the United States’ Utilities Sector Reveals Additional Adversary TTPs.pdf"
    ],
    "report_names": [
        "2019-09-22 - LookBack Forges Ahead- Continued Targeting of the United States’ Utilities Sector Reveals Additional Adversary TTPs.pdf"
    ],
    "threat_actors": [
        {
            "id": "faa4a29b-254a-45bd-b412-9a1cbddbd5e3",
            "created_at": "2022-10-25T16:07:23.80111Z",
            "updated_at": "2025-03-27T02:02:09.985067Z",
            "deleted_at": null,
            "main_name": "LookBack",
            "aliases": [
                "FlowingFrog",
                "LookBack",
                "LookingFrog",
                "TA410",
                "Witchetty"
            ],
            "source_name": "ETDA:LookBack",
            "tools": [
                "FlowCloud",
                "GUP Proxy Tool",
                "SodomMain",
                "SodomMain RAT",
                "SodomNormal"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535853,
    "ts_updated_at": 1743041372,
    "ts_creation_date": 1653760306,
    "ts_modification_date": 1653760306,
    "files": {
        "pdf": "https://archive.orkl.eu/f964e6e902788d50057990328f92723051cb1c8d.pdf",
        "text": "https://archive.orkl.eu/f964e6e902788d50057990328f92723051cb1c8d.txt",
        "img": "https://archive.orkl.eu/f964e6e902788d50057990328f92723051cb1c8d.jpg"
    }
}