{
    "id": "5e9d1bf8-4cb8-4f62-befb-be81baddca94",
    "created_at": "2022-10-25T16:48:18.852382Z",
    "updated_at": "2025-03-27T02:15:37.930828Z",
    "deleted_at": null,
    "sha1_hash": "d8f51b768c2767132210757a41aa0068c0edcaeb",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-07-13T16:02:52Z",
    "file_modification_date": "2021-07-13T16:02:54Z",
    "file_size": 2197303,
    "plain_text": "### Vol.103\n\n\n-----\n\n## Contents\n\n##### From Kill Chain to Ransomware: Comprehensive Analysis on Cobalt Strike 2021\n\n 1. Attack Flow of Cobalt Strike  04\n\n 2. Cyber Attack Kill Chain Exploiting Cobalt Strike  05\n\n 3. Cobalt Strike Attack Cases  09\n\n 4. Ransomware Cases Exploiting Cobalt Strike   19\n\n 5. Conclusion  26\n\n 6. IOC  27\n\n\n#### Report Vol.103 2021 Q2\n\n\n###### ASEC (AhnLab Security Emergency-response Center) is a global security response group consisting\n\n of malware analysts and security experts. This report is published by ASEC and focuses on the most\n\n significant security threats and latest security technologies to guard against such threats. For further\n\n details, please visit AhnLab, Inc.’s homepage (www.ahnlab.com).\n\n\n-----\n\n# From Kill Chain to Ransomware: Comprehensive Analysis on Cobalt Strike 2021\n\n##### Cobalt Strike is a legitimate penetration test tool that is widely used by red teams and\n\n penetration testers to check security vulnerabilities of networks and systems within\n\n companies and organizations. Its most distinctive characteristic is that it provides\n\n multitude of features for each penetration test stage. However, with the distribution of the\n\n tool’s crack version, cyber criminals have begun to exploit the tool to distribute malware\n\n and carry out malicious activities. Recently, there have been numerous cases of ransomware\n\n attacks targeting Korean companies by exploiting Cobalt Strike.\n\n From creating various types of payloads for system infiltration and stealing account\n\n information to compromising the system via lateral movement, Cobalt Strike provides\n\n features necessary for each stage. It also has many detailed settings and offers high\n\n scalability through third-party modules. Therefore, to analyze and defend attacks that\n\n exploit Cobalt Strike, one must consider many features provided by the tool as well as the\n\n various possibilities arising from a variety of techniques that can bypass detection.\n\n This report introduces Cobalt Strike’s attack method and characteristics of each stage\n\n based on the information tracked and analyzed by AhnLab Security Emergency-response\n\n Center (ASEC). It also examines the actual ransomware attack cases that exploited Cobalt\n\n Strike, discovered up to the recent second quarter of 2021.\n\n\n-----\n\n##### 1. Attack Flow of Cobalt Strike\n\n Cobalt Strike can be largely divided into three parts: beacon, team server, and Cobalt\n\n Strike client. The actual malware that first operates as a backdoor in the infected PC is\n\n the beacon. As stated, beacon is a backdoor that can perform commands provided by\n\n Cobalt Strike and it can perform malicious behaviors in external and internal networks by\n\n receiving commands from the C&C server.\n\n The next aspect is the actual C&C server called 'team server' that the beacon communicates\n\n to. Lastly, there is the Cobalt Strike client. The attacker can use the client to connect to the\n\n team server and send commands to the beacon via the server. Besides controlling the\n\n beacon, the client also provides a feature to create malicious payloads like Beacons and\n\n stager, other features, such as extension, and various UIs.\n\nFigure 1. The flow of Cobalt Strike Attack\n\n##### Figure 1 shows the flow of the attack that utilizes Cobalt Strike. One can see its components\n\n and the attack trend for each stage.\n\n\n-----\n\n##### When a particular company system connected with the external network is infected with\n\n a beacon, the attacker can steal account info using the privilege escalation and tools,\n\n such as Mimikatz, for lateral movement to make their way into other systems within the\n\n company’s system. Cobalt Strike is a tool specialized for supporting such a process.\n\n In effect, the attacker installs another beacon in the remote system through lateral\n\n movement. For internal networks, an SMB beacon is installed instead. For systems\n\n connected to the external network, the malware installs beacons, such as HTTP or HTTPS\n\n to receive commands from the external C&C server. For systems that are not connected to\n\n the external network, it uses the SMB beacon and SMB protocol to communicate. The SMB\n\n beacon can receive commands directly from the C&C server through the HTTP beacon.\n\n Hence, unlike other types of backdoor malware, Cobalt Strike allows the attacker to\n\n directly control the internal system.\n\n It also provides various techniques to bypass detection by security products. When a\n\n beacon is running, it is operating as a process. Cobalt Strike provides various settings, such\n\n as spawn, to prevent the system from detecting a suspicious process. Because it can also\n\n assign arguments, it becomes impossible for the current system to detect a suspicious\n\n process from just the list of processes. Moreover, as Cobalt Strike can directly manipulate\n\n packets for network communications, it is difficult to detect communication of HTTP\n\n and HTTPS beacons via packet-based detection. As such, beacon ends up existing in the\n\n memory of a certain process. Because various settings are also provided for the form of the\n\n beacon existing in the memory, the malware can bypass memory-based detections.\n\n 2. Cyber Attack Kill Chain Exploiting Cobalt Strike\n\n Cobalt Strike goes through the process of ‘initial compromise, establish foothold, privilege\n\n escalation, internal reconnaissance, lateral movement, and maintain persistence’ to\n\n achieve the attacker’s goal. Figure 2 shows the cyber kill chain of an attack exploiting\n\n Cobalt Strike.\n\n\n-----\n\nFigure 2. Cyber Kill Chain of Attacks Exploiting Cobalt Strike\n\n##### 2.1. Initial Compromise and Establish Foothold\n\n Beacon is Cobalt Strike’s agent that acts as a backdoor. If a particular system is infected\n\n by Cobalt Strike, it means that a beacon is installed and executed. Cobalt Strike provides\n\n beacons in various forms. Depending on the method, they can be categorized as either\n\n stager or stageless.\n\n Stager is a meterpreter that downloads a beacon from outside and executes it in the\n\n memory. It has a small size because it does not contain the actual beacon, and it must\n\n additionally download one. It can use HTTP, HTTPS, and DNS protocols to download\n\n a beacon from an external source. Also, when it propagates a beacon to the internal\n\n network during the lateral movement stage, it uses a named pipe (SMB protocol) to send\n\n the beacon. When a stageless method is used, a beacon does not have to be downloaded\n\n from the outside as it is already included. Because of this, the size of a stageless payload is\n\n quite noticeable.\n\n Since both the stager method (downloading and running the beacon) and the stageless\n\n method (loading and running the beacon existing in a particular form) are not required to\n\n\n-----\n\n##### take the form of an executable, Cobalt Strike provides many types of payloads. The builder\n\n provided by default can create an executable with formats, such as exe, dll, and Service\n\n exe as well as hta, vba macro, PowerShell command, and even raw formats.\n\n Like stager, the beacon can also communicate with the C&C server via protocols, such as\n\n HTTP, HTTPS, and dns. As the beacon installed in the internal network during the lateral\n\n movement stage will not be connected with the external network, SMB beacon that\n\n communicates via the SMB protocol is installed.\n\n The initially installed beacon can operate in various processes depending on its form.\n\n This also applies when proceeding with internal propagation during the process of lateral\n\n movement. For Cobalt Strike with default settings, the initial execute process can be\n\n executedll32.exe, powershell.exe, or WinRM-based wsmprovhost.exe depending on the\n\n command. However, Cobalt Strike provides a feature called ‘spawn’ to prevent beacons\n\n from being operated in processes mentioned above as they are very likely to draw admin\n\n or user’s suspicion. Spawn can also be configured in the profile file to assign the file path\n\n and the argument of the normal process that will be injected with the beacon. Even if a\n\n beacon is loaded and executed in powershell.exe, one of the watched processes in an\n\n infected environment, if the beacon was injected into the normal process using spawn,\n\n security programs cannot pinpoint the specific process a detection target.\n\n To maintain the connection with the attacker server after compromising a system, Cobalt\n\n Strike can use a feature called ‘malleable C&C profile’ to bypass the network packet\n based detection system. It allows the attacker to modify Cobalt Strike’s C&C (Command &\n\n Control) traffic to their liking. For instance, the traffic can be disguised as a normal server,\n\n such as Google or Bing, allowing it to communicate with the attacker server without\n\n getting detected by the network security system. Cobalt Strike uses a settings file called\n\n ‘profile,’ one of its core aspects, to execute this feature.\n\n\n-----\n\n##### 2.2. Privilege Escalation\n\n After completing the initial compromise and establishing a foothold, the attacker will\n\n attempt to obtain a local administrator or domain administrator credential to carry out\n\n lateral movement in the internal network. Cobalt Strike provides the Mimikatz feature to\n\n obtain such account information, but to perform the account info-stealing command, the\n\n attacker needs a privilege greater than that of the Administrator. This is why the process\n\n of privilege escalation takes place prior to running Mimikatz. Attackers use UAC bypass or\n\n LPE vulnerabilities to accomplish their goals. They use certain features that Cobalt Strike\n\n provides by default, but sometimes, they also use third-party tools.\n\n 2.3. Internal Reconnaissance\n\n If the attacker succeeds in stealing credentials via privilege escalation and execution of\n\n Mimikatz in the infected system, this effectively means that the attacker has completely\n\n compromised the system. In this stage, the attacker uses ADFind and port scan feature to\n\n collect the information of all the PCs in the network connected with the current system.\n\n Often used by attackers to collect information, ADFind is a command-line tool that collects\n\n the Active Directory information in the current network. For instance, APT attack groups,\n\n such as FIN6 execute ADFind as a batch file and collect information including, but not\n\n limited to, domain controller list, subnet list, computer information existing in the domain,\n\n and information of the Active Directory that the current system belongs.\n\n 2.4. Lateral Movement\n\n After completing the processes of internal reconnaissance and stealing credentials via port\n\n scan and tools like ADFind, the attacker can now proceed with the internal propagation.\n\n Direct shell commands can be used in Cobalt Strike, but attackers can use other commands\n\n provided by default, such as psexec (psexec64), psexec_psh, winrm (winrm64), and ssh\n\n (ssh-key).\n\n\n-----\n\n##### 2.5. Maintain Persistence and Complete Mission\n\n At this stage, the system is completely compromised by the attacker. The malware can\n\n perform commands without restrictions, such as adding extension modules or installing\n\n other types of malware. The first command that will be performed is ‘maintain persistence.’\n\n The attacker performs maintain persistence command so that the beacon can be execute\n\n again when it is unexpectedly terminated due to the reboot of the infected PC or\n\n termination of the beacon-carrying process.\n\n 3. Cobalt Strike Attack Cases\n\n The actual attack cases where Cobalt Strike was used during a certain stage of distribution,\n\n installation, or lateral movement are as follows.\n\n 3.1. Cobalt Strike Distribution Stage\n\n (1) BlueCrab\n\n Also known as Revil or Sodinokibi, BlueCrab ransomware is disguised as crack programs\n\n in phishing pages. When users search crack software on Google for download, they\n\n might download the ransomware instead. Inside the initially downloaded file is a\n\n javascript file that has the downloader feature. When the file is executed, it checks for the\n\n %USERDNSDOMAIN% environment variable in the user system. The environment variable\n\n exists in an environment like a corporate AD server where a domain is configured. If the\n\n variable does not exist, the malware considers the system normal and performs BlueCrab\n\n ransomware activities. If the %USERDNSDOMAIN% environment variable exists, the file\n\n recognizes the system as a company user’s PC and installs Cobalt Strike.\n\n Figure 3 shows the BlueCrab downloader installing Cobalt Strike. js executes the\n\n PowerShell command, leading to load and execution of the loader and injector binaries\n\n in the PowerShell process memory. Ultimately, the PowerShell process that acts as the\n\n injector executes the process in the ‘C:\\Program Files (x86)\\Windows Photo Viewer\\\n\n\n-----\n\n##### ImagingDevices.exe’ path and injects the delphi loader that loads the beacon. The injected\n\n beacon communicates with the C&C server via HTTPS communication.\n\nFigure 3. BlueCrab Downloader Installing Cobalt Strike\n\n##### (2) Hancitor\n\n Hancitor is a downloader malware distributed through attachments in spam emails,\n\n usually Microsoft Office document files. Through the files, the actual Hancitor binary is\n\n execute. Being a downloader itself, it downloads and installs additional malware. When\n\n the Word document is opened, the malware uses a social engineering technique to enable\n\n the macro. As shown in Figure 4, it prompts the user to click the upper ‘Enable Content’\n\n button.\n\n\n-----\n\nFigure 4. Prompting Users to Enable Macro\n\n##### It’s been known that the additionally downloaded malware strains are Pony, the info\n stealer malware from the past, and Vawtrak, the banking malware. Recently, the info\n stealer named FickerStealer is installing Cobalt Strike.\n\n The C&C server sends additional payloads based on the information of the infected PC that\n\n it received. FickerStealer is downloaded in normal environments, but in Active Directory\n\n environments, Cobalt Strike is downloaded additionally. In a corporate (Active Directory)\n\n environment, Hancitor installs both FickerStealer and Cobalt Strike. It was confirmed that\n\n when Hancitor is execute in an AD environment, it sends the domain information, such as\n\n the one shown in Figure 5 and receives commands.\n\nFigure 5. Sending Domain Information\n\n\n-----\n\n##### Among the three downloaded payloads, one is the info-stealer malware named\n\n FickerStealer, and the other two are stager shellcodes that download beacons. Each stager\n\n downloads a beacon and injects it into a normal program called svchost.exe. Inside the\n\n infected PC are two operating Cobalt Strike beacons. Figure 6 shows the download &\n\n execute list of Cobalt Strike.\n\nFigure 6. Downloading and running Cobalt Strike\n\n##### (3) Case of Company A\n\n For company A, python36.exe, which has the loader feature inside the normal installer,\n\n and msvcp140_3.dll, a beacon-encoded data file, were distributed and executed together.\n\n When python36.exe is execute, it loads msvcp140_3.dll existing in the same file path and\n\n executes it in the memory after decoding it. HTTPS beacon is the one that is execute in the\n\n memory, and this is a typical stageless method.\n\n Other beacons were also found; System.Executetime.Local.dll and System.PrintServices.tlb\n\n were moved to the ‘C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\’ path by sch.bat.\n\n Both files were registered to the task scheduler and were executed by InstallUtil.exe. DLL\n\n System.Executetime.Local.dll, after being loaded and executed by InstallUtil.exe, loads and\n\n decodes the data file System.PrintServices.tlb existing in the same path. It then executes\n\n the normal program msdtc.exe and injects the decoded beacon, as shown in Figure 7. The\n\n same HTTPS beacon is execuuted inside the msdtc.exe process.\n\n\n-----\n\nFigure 7. Beacon Injected Inside msdtc.exe Process\n\n##### 3.2. Cobalt Strike Installation Stage\n\n (1) Case of Company B\n\n It was discovered that Company B was a target of the stageless Cobalt Strike distribution\n\n similar to that in company A. The loader with the PE executable file format starts loading\n\n and decoding when the data file dewm.dll is in the same path. Upon decoding, the HTTPS\n\n and dns beacons in the form of a PE file are created. They are executed in the memory and\n\n receive additional commands from the C&C server.\n\n Figure 8 shows the result of extracting the beacon PE loaded in the memory and using\n\n SentinelOne’s parsing tool to check the beacon’s settings information.\n\n\n-----\n\nFigure 8. Beacon Settings Data\n\n##### (2) Case of Company C\n\n Company C is an SME (small or medium-sized enterprise) that develops and supplies\n\n certain solutions. While the details and cause of the initial infection remains unknown, the\n\n PowerShell process downloaded and executed a file named ‘0a3b4f.css’ from the attacker’s\n\n server. The file is a PowerShell script encoded with SecureString. When decoded, a stager\n\n PowerShell script is revealed. See Figure 9 for the decoded PowerShell script.\n\nFigure 9. Partial of the Decoded PowerShell Script\n\n\n-----\n\n##### The detected shellcode is a 64-bit shellcode that uses the wininet api to access the\n\n attacker’s URL and download a beacon that acts as a backdoor. The downloaded beacon is\n\n not created as a file but instead is loaded into the memory and executed via the Reflective\n\n DLL Injection technique.\n\n (3) Case of Company D\n\n For this case, the stageless form was distributed, meaning that the sample contained a\n\n Beacon within. The sample used a custom packer made with Go (programming language)\n\n and was made in the CPL (*.cpl) format. The CPL file is the settings property file that\n\n expresses the applets of the control panel and shows similarity to a DLL file. As such, it\n\n is loaded and executed by executedll32.exe when executed. See Table 1 for the actual\n\n argument that is executed.\n\nC:\\Windows\\system32\\executedll32.exe\" Shell32.dll,Control_ExecuteDLL \"%ALLUSERSPROFILE%\\Control\\c07df469-85e3-430c-81c3\n757d59e3454b\\security_certificate.cpl \"\n\nTable 1. Executed Argument\n\n##### As shown in Table 1, the CPL file is executed through the executedll32.exe process.\n\n Afterward, the major main functions are called via ‘CPlApplet’ of the CPL file’s export\n\n function. The malicious main code inspects the OS version to check if the system is\n\n ‘Windows 10 (10.0).’ If it is, the code deletes all of the hookings from a particular DLL. To\n\n bypass the user-mode hooking, the malware uses the method of reading the DLL file\n\n present in the path shown in Figure 10 as a file form and only overwriting that DLL’s code\n\n section (.text section) existing in the memory.\n\n\n-----\n\nFigure 10. DLL with their Hookings Deleted (kerenl32.dll, kernelbase.dll, and ntdll.dll)\n\n##### (4) Case of University E\n\n The malware discovered in university E used ‘PEzor,’ the open-source packer, and ultimately\n\n ran a specific shellcode. One noticeable feature of the PEzor packer is that it supports an\n\n Artifact Kit, as shown in Figure 11. An Artifact Kit is a build module that helps Cobalt Strike\n\n bypass anti-malware products. When using the Artifact Kit of ‘PEzor,’ the executable is built\n\n in a format different from previous executables (EXE and DLL). It can use features of ‘PEzor,’\n\n such as user-land hook bypass.\n\nFigure 11. Introduction to PEzor’s Artifact Kit\n\n\n-----\n\n##### Like in company D, the malware for this case used 62.171.141[.]54 as the C&C server.\n\n However, a difference is that for company D, the stageless form that decodes and executes\n\n the pre-existing, encoded beacon was used. At the same time, for university E, the malware\n\n was distributed in the stager form that downloads the beacon after connecting to the C&C\n\n server.\n\n (5) Case of Company F\n\n In this case, it was found that the PowerShell process was attempting to execute a\n\n malicious script (%temp%\\tmp5O91.ps1) existing in a certain folder to download a\n\n beacon. The case is similar to that of company C, but as we can see from Figure 12, the\n\n script skips the Base64 decoding process, goes through the XOR (0x35) operation, and\n\n loads the shellcode to the memory.\n\nFigure 12. Malicious Script (tmp5O91.ps1) that Downloads Beacon\n\n##### The executed shellcode is a stager that downloads the beacon from the C&C server\n\n (pilottrustme[.]top, 54.238.214[.]219). However, as the connection is currently unavailable,\n\n the team cannot check the latest information about the beacon.\n\n\n-----\n\n##### 3.3. Lateral Movement Stage\n\n (1) Case of Company G\n\n For company G, the PowerShell command used in the lateral movement was found along\n\n with an HTTPS beacon. The command is an HTTPS stager, downloading the HTTPS beacon\n\n and running it in the memory. It appears that the beacon is used to communicate with the\n\n external network. Inside the beacon existed many PowerShell commands for the lateral\n\n movement. These, as shown in Figure 13, are the basic psexec_psh commands supported\n\n by Cobalt Strike. The attacker likely used the command to propagate the beacon to the\n\n inner part after stealing accounts through the HTTPS beacon. For internal PCs that become\n\n the target of propagation, the PowerShell command is executed. Inside the PowerShell\n\n process, the shellcode with the feature of downloading and running the SMB beacon\n\n through a named pipe is executed.\n\nFigure 13. Cobalt Strike’s psexec_psh Command\n\n##### (2) Case of Company H\n\n The files that company H received are obfuscated JS files, as shown in Figure 14. When they\n\n are executed, they decode the SMB beacon encoded in the script and execute it in the\n\n memory. Unlike the case of company G examined earlier, instead of using Cobalt Strike’s\n\n basic command, files of various formats, such as a JS file were used when propagating to\n\n the inner part to bypass detection.\n\n\n-----\n\nFigure 14. Beacon Loader in Obfuscated JS format\n\n##### 04. Ransomware Cases Exploiting Cobalt Strike\n\n Since Cobalt Strike is an incredibly useful tool to penetrate a company’s infrastructure,\n\n APT groups utilize it in various ways to attack businesses. It is also important to note that\n\n recently, it is being used widely in various ransomware and info-leaker attacks. As shown\n\n in the case of BlueCrab the attacker likely planned to perform ransomware attacks after\n\n compromising a company’s infrastructure through Cobalt Strike. Also, in the case of\n\n Hancitor cases, it is internationally known that the attacker installs Cuba ransomware via\n\n Cobalt Strike.\n\n As we can see, there have been many cases of attackers installing ransomware in companies’\n\n internal infrastructures through Cobalt Strike. The actual case for each ransomware is as\n\n follows.\n\n 4.1. Case of CLOP Ransomware\n\n The TA505 group has been launching CLOP ransomware attacks since 2019, and it is one of\n\n the most notable attacks against Korean companies. The group attacked corporate users\n\n via spam emails and utilized the RAT malware named FlawedAmmyy to send commands\n\n from the infected PC. As shown in Figure 15, the company FlawedAmmyy attacked was\n\n later also attacked by CLOP ransomware after a certain time has passed. However, how\n\n the attacker compromised the internal network and installed CLOP ransomware remains a\n\n mystery.\n\n\n-----\n\nFigure 15. Overview of TA505 Group’s Attack\n\n##### Fortunately, an additional analysis did reveal that the SdbBot malware created by\n\n FlawedAmmyy resided in the infected PC and performed activities after receiving\n\n commands from the attacker. Additionally, a trace of Cobalt Strike being used to propagate\n\n the malware to the internal network was discovered during an investigation of a related\n\n security breach incident. In short, the attacker installed RAT and backdoor on the infected\n\n PC through spam mails. Through Cobalt Strike, the attacker propagated the malware to the\n\n internal network, ultimately compromised the Active Directory environment, and installed\n\n CLOP ransomware on the company’s internal network. Figure 16 shows the Cobalt Strike\n\n stager PowerShell script used in the lateral movement.\n\n\n-----\n\nFigure 16. Cobalt Strike Stager PowerShell Script Used in Lateral Movement\n\n##### 4.2. Case of Conti Ransomware\n\n IcedID, also called Bokbot, is a banking malware distributed as malicious Microsoft Office\n\n attachments of spam mails. The attachments install the IcedID loader, which only has the\n\n download feature. It can install additional modules with features of processing commands,\n\n stealing bank account information, and proxy. Such a process is similar to that of Emotet. It\n\n is recently operating as the MaaS (Malware-as-a-Service) model that installs other types of\n\n malware instead of additional banking modules.\n\n Among malware installed through IcedID, there is Conti ransomware. After the initial\n\n IcedID infection, Cobalt Strike beacon is installed. It then goes through the stages of\n\n information collection and lateral movement stages to ultimately distribute ransomware\n\n\n-----\n\n##### to the company’s internal infrastructure. At the initial compromise stage, the attacker used\n\n commands shown in Table 2 to obtain the information of the current network domain for\n\n internal reconnaissance. The attacker must have used normal utility files to avoid getting\n\n detected by security solutions.\n\n - ipconfig /all: Command for checking network adapter information\n\n - systeminfo: Command for checking system information\n\n - whoami /groups: Command for checking group that the current user belongs to\n\n - net config workstation: Command for checking work group information\n\n - nltest /domain_trusts /all_trusts: Command for listing information of trusted domains (AD environment)\n\n - net view /all /domain: Command for listing information of all domains and networks connected with network\n\n - net group \\ “Domain Admins\\”/domain: Perform work on domain group “Domain Admins”\n\n - net group \\ “Enterprise admins\\”/domain: Perform work on domain group “Enterprise admins”\n\n - dsquery subnet -limit 0: Command for listing subnets connected to directory\n\nTable 2. Commands Used for Internal Reconnaissance\n\n##### After the internal reconnaissance stage, the attacker installed a beacon in the domain\n\n controller server through the privilege escalation provided by Cobalt Strike. The attacker\n\n ultimately distributed and executed Conti ransomware in systems within the domain\n\n environment connected through a beacon through the lateral movement stage.\n\nFigure 17. Distributing Conti Ransomware by Exploiting Cobalt Strike Beacon\n\n\n-----\n\n##### Figure 17 shows the stage of Conti ransomware distribution utilizing the Cobalt Strike\n\n beacon, which is the ‘objective complete’ stage shown in Figure 2.\n\n 4.3. Case of DarkSide Ransomware\n\n DarkSide ransomware recently drew worldwide attention by attacking a U.S. pipeline\n\n company to demand cryptocurrency worth tens of million dollars. The company was first\n\n infected by Zloader malware. Afterward, DarkSide ransomware was installed in the internal\n\n infrastructure through Cobalt Strike. Like IcedID, Zloader is a banking malware. It is usually\n\n distributed as spam mail attachments. As shown in Figure 18, the Excel 4.0 Macro malware\n\n is mainly used in distribution.\n\nFigure 18. Execution of Excel 4.0 Macro Malware (Distributing Zloader)\n\n##### Zloader is a modular malware just like Emotet and IcedID. The first program that is installed\n\n is also a downloader. It employs the DGA technique to communicate with the C&C server\n\n and then installs additional modules with banking and account credentials stealing\n\n features and keylogging features. As for the case of DarkSide, Zloader also installed Cobalt\n\n\n-----\n\n##### Strike to compromise the infrastructure, and ultimately install ransomware.\n\n 4.4. Case of Ryuk Ransomware\n\n The case of Ryuk ransomware is another instance of a Korean company being infected with\n\n malware. In March 2021, it was discovered that more than 100 PCs installed in one Korean\n\n company were infected by certain ransomware. The ransomware that infected the PCs is\n\n Ryuk. At the time of analysis, it was assumed that Cobalt Strike had already compromised\n\n the AD server. The attacker used three tools to propagate the ransomware to the internal\n\n network: PsExec, Bitsadmin, and WMI. These tools are normally used for management\n\n purposes, but they were exploited to spread Ryuk. Analysis of the batch command file\n\n deployed in the tools revealed that the attacker had already obtained the Administrator\n\n account information and attempted to propagate the malware using the information.\n\n Figure 19 shows how the Ryuk ransomware is distributed via the PsExec command as a\n\n flow chart.\n\nFigure 19. Flow of Ryuk Ransomware Distribution through PsExec Command\n\n\n-----\n\n##### Across the globe in 2021, various attackers are indiscriminately attacking global\n\n organizations and companies, including government agencies, medical facilities, and\n\n energy companies. Cobalt Strike was used in all recent infection cases, and one infection\n\n case in 2020 was noticeable. It only took 2-3 hours for the attacker to proceed from the\n\n internal reconnaissance stage to the propagation stage and spread Ryuk ransomware. \n\nFigure 20. Global Malware Distribution Cases (BazarBackdoor, Cobalt Strike, and Ryuk Ransomware)\n\n##### As for Ryuk ransomware that is being discovered, phishing emails are its initial distribution\n\n path. As shown in Figure 20, BazarLoader and BazarBackdoor are initially installed through\n\n a malicious document file. The backdoor then installs Cobalt Strike to perform the internal\n\n reconnaissance and lateral movement. When the malware completely compromises\n\n the internal infrastructure, it installs Ryuk ransomware on the captured systems. Figure\n\n 21 shows a part of BazarBackdoor’s company domain name information collection API\n\n (NetWkstaGetInfo).\n\n\n-----\n\nFigure 21. BazarBackdoor’s Company Domain Name Information Collection API (NetWkstaGetInfo)\n\n##### 5. Conclusion\n\n AhnLab products are equipped with process memory-based detection methods, and\n\n behavior-based detection features that can detect and block the beacon backdoor, the\n\n core module of Cobalt Strike used from the initial invasion stage to the final internal\n\n propagation stage.\n\n As the Cobalt Strike attack tool mainly targets companies’ AD internal networks. Thus,\n\n security managers should pay extra attention to the AD server security to prevent breach\n\n incidents. Because the attacker mainly uses normal Windows features, such as PsExec,\n\n WinRM, and RDP, to assist with management tasks, security managers should continuously\n\n monitor Administrator accounts and disable unnecessary ports. Also, software and security\n\n products should be updated to their latest versions.\n\n\n-----\n\n##### 6. IOC\n\n File\n\n Hancitor\n\n - Word Document File: 693df6e9f5dc0cd3ed4c6ede503ce8bc\n\n - Hancitor DLL: 5122d19bed77851f85775793e34bff09\n\n - FickerStealer: 77be0dd6570301acac3634801676b5d7\n\n Company A\n\n - python36.exe: 622cd25e79dc350ec614530699e84d55\n\n - msvcp140_3.dll: 8baa568281d8971de0e25720e956a89f\n\n - System.Runtime.Local.dll: 38a15672fa8cc5a94b08e4304e7add5b\n\n - System.PrintServices.tlb: 717b4597e0615d728dd82f236e8aef7d\n\n - sch.bat: b37f4043612b68ffba6752402b689c64\n\n Company B\n\n - Loader: e46d58b7339ecb79257ccdd35e9aa837\n\n - dewm.dll: 531adf8a40b386c027a3024e4c6c7c5a\n\n Company C\n\n - 0a3b4f.css: 3b42d9dbd4d898be83daf9d333f4c6d9\n\n Company D\n\n - security_certificate.cpl: 17701d82c332d6ccdb03d4a0e9068478\n\n University E\n\n - msvcruntime.exe: f990c4df6a580794cb6fd1d4fafe64b8\n\n Company F\n\n - tmp5O91.ps1: d782dd504419ef0699d65cfa8c673700\n\n Company G\n\n - PowerShell Command: a272d9c9d9037a68fbb811f8ee4171f2\n\n Company H\n\n - JavaScript Loader: e277845059c6cce8e7763a8314604e81, c2da086384230cc7b1b2352\n\n 94b18a803\n\n\n-----\n\n##### Download and C&C Server\n\n Hancitor Case and Hancitor C&C\n\n - hxxp://sumbahas[.]com/8/forum.php\n\n - hxxp://staciterst[.]ru/8/forum.php\n\n - hxxp://semareake[.]ru/8/forum.php\n\n Hancitor Case and FickerStealer C&C\n\n - hxxp://sweyblidian[.]com\n\n Hancitor Case and Cobalt Strike C&C\n\n - hxxp://kuragnda2[.]ru/2804.bin\n\n - hxxp://kuragnda2[.]ru/2804s.bin\n\n - hxxp://45.170.245[.]190/qbU4\n\n - hxxp://45.170.245[.]190/dO1x\n\n - hxxp://45.170.245[.]190/visit.js\n\n - hxxp://45.170.245[.]190/activity\n\n Company A\n\n - hxxps://azure.microsofts.workers[.]dev/jquery-2.2.2.4.min.js\n\n - hxxps://www.battllestategames[.]com/jquery-3.3.1.min.js\n\n Company B\n\n - ns1.365filtering[.]com/pixel\n\n - ns3.365filtering[.]com/activity\n\n - ns4.365filtering[.]com/cx\n\n - ns1a.365filtering[.]com/cm\n\n - ns2a.365filtering[.]com/ptj\n\n - ns4a.365filtering[.]com/activity\n\n Company C\n\n - 5.34.178[.]203\n\n Company D / University E\n\n - 62.171.141[.]54 (hxxps://oxoo[.]cc)\n\n Company F\n\n - 54.238.214[.]219 (hxxps://pilottrustme[.]top)\n\n\n-----\n\n#### Report Vol.103\n\nContributors **ASEC Researchers**\n\nEditor **Content Creatives Team**\n\nDesign **Content Creatives Team**\n\n\nPublisher **AhnLab, Inc.**\n\nWebsite **www.ahnlab.com**\n\nEmail **global.info@ahnlab.com**\n\n\nDisclosure to or reproduction for others without the specific written authorization of AhnLab is prohibited.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/Report/AhnLab/ASEC_REPORT_vol.103_ENG.pdf"
    ],
    "report_names": [
        "ASEC_REPORT_vol.103_ENG"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041737,
    "ts_creation_date": 1626192172,
    "ts_modification_date": 1626192174,
    "files": {
        "pdf": "https://archive.orkl.eu/d8f51b768c2767132210757a41aa0068c0edcaeb.pdf",
        "text": "https://archive.orkl.eu/d8f51b768c2767132210757a41aa0068c0edcaeb.txt",
        "img": "https://archive.orkl.eu/d8f51b768c2767132210757a41aa0068c0edcaeb.jpg"
    }
}