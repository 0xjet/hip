{
    "id": "3ac7f670-966b-48de-b785-c5f55b588b05",
    "created_at": "2023-01-12T15:09:01.316104Z",
    "updated_at": "2025-03-27T02:06:06.946511Z",
    "deleted_at": null,
    "sha1_hash": "fc617b431dac872e1a6b74b07e53e52d864fef1d",
    "title": "2021-07-29 - “Netfilter Rootkit II ” Continues to Hold WHQL Signatures",
    "authors": "",
    "file_creation_date": "2022-05-28T03:47:02Z",
    "file_modification_date": "2022-05-28T03:47:02Z",
    "file_size": 431696,
    "plain_text": "# “Netfilter Rootkit II ” Continues to Hold WHQL Signatures\n\n**[blog.360totalsecurity.com/en/netfilter-rootkit-ii-continues-to-hold-whql-signatures/](https://blog.360totalsecurity.com/en/netfilter-rootkit-ii-continues-to-hold-whql-signatures/)**\n\nJuly 29, 2021\n\nJul 29, 2021kate\n\n[Tweet](https://twitter.com/share)\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\n**1.Backgroud**\n\nRecently, 360 Security Center discovered that a malicious driver “Netfilter rootkit” with WHQL\nsignature was revealed in mid-June. WHQL signature means that after the hardware driver\npassed the Microsoft certification, Microsoft will add a “Hardware Compatibility Publisher”\ndigital signature to the driver. The Netfilter rootkit has now been updated to the second\ngeneration and continues to hold the Microsoft signature. Moreover, the concealment of the\nupgraded Netfilter rootkit has increased so much that there is still no antivirus report on\nVirustotal.\n\nIn view of the fact that the second generation of Netfilter rootkit differs from the previous\nversion in function and name, 360 Security Center named it “NetRedirect rootkit”. Although\nthe NetRedirect rootkit has strong concealment and hazards, 360 Total Security can still\nachieve targeted defense and thorough investigation and killing, and fundamentally solve the\nuser’s security problems.\n\n\n-----\n\nIn fact, as early as June 25, the Microsoft Security Response Center stated that it had\nsuspended the Netfilter rootkit account and reviewed other documents issued by it.\n“According to our zero-trust and layered defense security posture, we passed Microsoft\nDefender for Endpoint Built-in detection and blocking of this driver and related files.”\nHowever, its second-generation product, the NetRedirect rootkit, which is highly homologous\nand similar in behavior, still has a Microsoft signature, making it more concealed and difficult\nto detect and kill.\n\nIn addition, the harmfulness of NetRedirect rootkit has also been significantly improved. In\nview of the way that NetRedirect rootkit cloud controls the distribution of rootkits, the current\nmalicious vendor is fully capable of not only being limited to the IP hijacking function, but also\n\n\n-----\n\nbeing able to implement any malicious rootkit execution on the infected devices.\n\n1. The hidden behavior of cloud-controlled malicious files and memory loading\n\nDifferent from the previous generation of “Netfilter rootkit” verifying its own file md5 to\nimplement file self-update, “NetRedirect rootkit” adopts the form of disguising the driver and\nthe malicious driver, and the real malicious driver is stored on the Trojan C & C server in a\ncloud-controlled manner, And the local masquerading as the driver of the WFP network\nfiltering function is responsible for requesting malicious file data from the server, and calling\nthe rootkit entry address in a concealed manner of memory loading.\n\nThe source of the “NetRedirect rootkit” is certain private server games. After the private\nserver game runs, it will silently write to the driver registry service, release the\nNetRedirect sys file to the %UserProfile%\\AppData\\Roaming directory and load\n\n\n-----\n\nNetRedirect.sys .\n\nSubsequently, NetRedirect.sys, which has Microsoft’s signature, will request the real\nmalicious driver from the server in the form of a socket:\n\nAfter obtaining the rootkit file data, the memory is self-loaded and the driver entry address is\ncalled:\n\n\n-----\n\nThe Netfilter rootkit loaded in the memory is responsible for IP hijacking. It will repeatedly\ntamper with the HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet\nSettings\\AutoConfigURL key value item, and finally achieve the purpose of IP hijacking:\n\nThe partial hijacking list is as follows:\n\n\n-----\n\nIt is monitored that the “NetRedirect rootkit” does not belong to any module’s memory thread,\nand tampering with the registry AutoConfigURL key value:\n\n\n-----\n\nHowever, users do not need to worry. Under the protection of 360 Total Security’s accuracy,\nreal-time and intelligence, such rootkits cannot bypass 360 Total Security’s behavior-based\ndetection. The new generation of defense technology empowered by 360 Security Center\ncan prevent problems before they happen., It can also carry out thorough investigation and\nkilling of infected devices.\n\n**Security Advice：**\n\n1. Go to https://www.360totalsecurity.com/ to download and install 360 Total Security for\n\nprotection.\n2. For unfamiliar software blocked by 360 Total Security, do not continue to run and add\n\ntrust.\n3. If you have accidentally infected the Trojan, you can go to\n\nhttps://www.360totalsecurity.com/ to download and install 360 Total Security, and use\n360 Total Security’s scan and killing service.\n\n\n-----\n\nFiles Md5:\n\n36b43aa3621e0c4f86a4a61a2ea1f2c4\n\n09ef4b13abda36da6cd3982ae66a59c0\n\n155250268a6080aeeb9a337f76e35599\n\n7b6ebe1f32b204d0e1e4ac92b3ad6baa\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-29 - “Netfilter Rootkit II ” Continues to Hold WHQL Signatures.pdf"
    ],
    "report_names": [
        "2021-07-29 - “Netfilter Rootkit II ” Continues to Hold WHQL Signatures.pdf"
    ],
    "threat_actors": [
        {
            "id": "b584b10a-7d54-4d05-9e21-b223563df7b8",
            "created_at": "2022-10-25T16:07:24.181589Z",
            "updated_at": "2025-03-27T02:02:10.134233Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "ETDA:SideCopy",
            "tools": [
                "ActionRAT",
                "AllaKore",
                "Allakore RAT",
                "AresRAT",
                "Bladabindi",
                "CetaRAT",
                "DetaRAT",
                "EpicenterRAT",
                "Jorik",
                "Lilith",
                "Lilith RAT",
                "MargulasRAT",
                "ReverseRAT",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "187a0668-a968-4cf0-8bfd-4bc97c02f6dc",
            "created_at": "2022-10-27T08:27:12.955905Z",
            "updated_at": "2025-03-27T02:00:55.41311Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [
                "SideCopy"
            ],
            "source_name": "MITRE:SideCopy",
            "tools": [
                "AuTo Stealer",
                "Action RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a4f0e383-f447-4cd6-80e3-ffc073ed4e00",
            "created_at": "2023-01-06T13:46:39.30167Z",
            "updated_at": "2025-03-27T02:00:03.045082Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "MISPGALAXY:SideCopy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536141,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1653709622,
    "ts_modification_date": 1653709622,
    "files": {
        "pdf": "https://archive.orkl.eu/fc617b431dac872e1a6b74b07e53e52d864fef1d.pdf",
        "text": "https://archive.orkl.eu/fc617b431dac872e1a6b74b07e53e52d864fef1d.txt",
        "img": "https://archive.orkl.eu/fc617b431dac872e1a6b74b07e53e52d864fef1d.jpg"
    }
}