{
    "id": "3c099163-eebd-44d4-a138-8cabcffdccf7",
    "created_at": "2022-10-25T16:48:16.03477Z",
    "updated_at": "2025-03-27T02:13:09.680767Z",
    "deleted_at": null,
    "sha1_hash": "a9970d82d1b539ee63838619fcb9aaaae5f0c51d",
    "title": "Cloud Atlas: Redoctober Apt Is Back In Style",
    "authors": "Kaspersky",
    "file_creation_date": "2014-12-10T21:31:47Z",
    "file_modification_date": "2014-12-10T21:31:47Z",
    "file_size": 403710,
    "plain_text": "[Two years ago, we published our research into RedOctober, a complex cyber-espionage operation](http://securelist.com/analysis/publications/36740/red-october-diplomatic-cyber-attacks-investigation/#8)\n\ntargeting diplomatic embassies worldwide. We named it RedOctober because we started this investigation\n\nin October 2012, an unusually hot month.\n\nAfter our announcement in January 2013, the RedOctober operation was promptly shut down and the\n\nnetwork of C&Cs was dismantled. As usually happens with these big operations, considering the huge\n\ninvestment and number of resources behind it, they don't just \"go away\" forever. Normally, the group goes\n\nunderground for a few months, redesigns the tools and the malware and resume operations.\n\nSee:\n\n[RedOctober Part 1](https://securelist.com/blog/incidents/57647/the-red-october-campaign/)\n\n[RedOctober Part 2](http://securelist.com/blog/incidents/57645/red-october-part-two-the-modules/)\n\nSince January 2013, we've been on the lookout for a possible RedOctober comeback. One possible hit was\n\n[triggered when we observed Mevade, an unusual piece of malware that appeared late in 2013. The Mevade](http://en.wikipedia.org/wiki/Mevade_Botnet)\n\nC&C name styles as well as some other technical similarities indicated a connection to RedOctober, but the\n\nlink was weak. It wasn't until August 2014 that we observed something which made us wonder if\n\nRedOctober is back for good.\n\n## Meet Cloud Atlas\n\n[In August 2014, some of our users observed targeted attacks with a variation of CVE-2012-0158 and an](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-0158)\n\nunusual set of malware. We did a quick analysis of the malware and it immediately stood out because of\n\ncertain unusual things that are not very common in the APT world.\n\nSome of the filenames used in the attacks included:\n\nFT - Ukraine Russia's new art of war.doc\n\nКатастрофа малайзийского лайнера.doc\n\nDiplomatic Car for Sale.doc\n\nМВКСИ.doc\n\nOrganigrama Gobierno Rusia.doc\n\nФото.doc\n\nИнформационное письмо.doc\n\nФорма заявки (25-26.09.14).doc\n\nИнформационное письмо.doc\n\n\n-----\n\nПрилож.doc\n\nCar for sale.doc\n\nAf-Pak and Central Asia's security issues.doc\n\nAt least one of them immediately reminded us of RedOctober, which used a very similarly named\n\nspearphish: \"Diplomatic Car for Sale.doc\". As we started digging into the operation, more details emerged\n\nwhich supported this theory.\n\nPerhaps the most unusual fact was that the Microsoft Office exploit didn't directly write a Windows PE\n\nbackdoor on disk. Instead, it writes an encrypted Visual Basic Script and runs it.\n\n_Cloud Atlas exploit payload - VBScript_\n\nThis VBScript drops a pair of files on disk - a loader and an encrypted payload. The loader appears to be\n\ndifferent every time and internal strings indicate it is \"polymorphically\" generated. The payload is always\n\nencrypted with a unique key, making it impossible to decrypt unless the DLL is available.\n\nWe observed several different spear-phishing documents that drop uniquely named payloads. For\n\ninstance, the \"qPd0aKJu.vbs\" file MD5:\n\n\n-----\n\n**DECF56296C50BD3AE10A49747573A346 - bicorporate - encrypted payload**\n\n**D171DB37EF28F42740644F4028BCF727 - ctfmonrn.dll - loader**\n\nThe VBS also adds a registry key:\n\n**HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ setting the**\n\nkey \"bookstore\" to the value \"regsvr32 %path%\\ctfmonrn.dll /s\", which ensures the malware runs every\n\ntime at system boot.\n\nSome of the DLL names we observed include:\n\n**f4e15c1c2c95c651423dbb4cbe6c8fd5 - bicorporate.dll**\n\n**649ff144aea6796679f8f9a1e9f51479 - fundamentive.dll**\n\n**40e70f7f5d9cb1a669f8d8f306113485 - papersaving.dll**\n\n**58db8f33a9cdd321d9525d1e68c06456 - previliges.dll**\n\n**f5476728deb53fe2fa98e6a33577a9da - steinheimman.dll**\n\nSome of the payload names include:\n\n**steinheimman**\n\n**papersaving**\n\n**previliges**\n\n**fundamentive**\n\n**bicorporate**\n\n**miditiming**\n\n**damnatorily**\n\n**munnopsis**\n\n**arzner**\n\n**redtailed**\n\n**roodgoose**\n\n**acholias**\n\n**salefians**\n\n**wartworts**\n\n**frequencyuse**\n\n**nonmagyar**\n\n**shebir**\n\n**getgoing**\n\n\n-----\n\nThe information from the config includes a WebDAV URL which is used for connections, a username and\n\npassword, two folders on the WebDAV server used to store plugins/modules for the malware and where\n\ndata from the victim should be uploaded.\n\n## C&C communication\n\nThe Cloud Atlas implants utilize a rather unusual C&C mechanism. All the malware samples we've seen\n\ncommunicate via HTTPS and WebDav with the same server \"cloudme.com\", a cloud services provider.\n\nAccording to their website, CloudMe is owned and operated by CloudMe AB, a company based in\n\nLinköping, Sweden.\n\n\n-----\n\n_attackers simply create free accounts on this provider and abuse them for command-and-control)._\n\nEach malware set we have observed so far communicates with a different CloudMe account though. The\n\nattackers upload data to the account, which is downloaded by the implant, decrypted and interpreted. In\n\nturn, the malware uploads the replies back to the server via the same mechanism. Of course, it should be\n\npossible to reconfigure the malware to use any Cloud-based storage service that supports WebDAV.\n\nHere's a look at one such account from CloudMe:\n\nThe data from the account:\n\n\n-----\n\nThe files stored in the randomly named folder were uploaded by the malware and contain various things,\n\nsuch as system information, running processes and current username. The data is compressed with LZMA\n\nand encrypted with AES, however, the keys are stored in the malware body which makes it possible to\n\ndecrypt the information from the C&C.\n\nWe previously observed only one other group using a similar method – ItaDuke – that connected to\n\naccounts on the cloud provider mydrive.ch.\n\n## Victim statistics: top 5 infected countries\n\n Similarities with RedOctober\n\nJust like with RedOctober, the top target of Cloud Atlas is Russia, followed closely by Kazakhstan,\n\naccording to data from the Kaspersky Security Network (KSN). Actually, we see an obvious overlap of\n\ntargets between the two, with subtle differences which closely account for the geopolitical\n\n**changes in the region that happened during the last two years.**\n\nInterestingly, some of the spear-phishing documents between Cloud Atlas and RedOctober seem to exploit\n\nthe same theme and were used to target the same entity at different times.\n\nBoth Cloud Atlas and RedOctober malware implants rely on a similar construct, with a loader and the final\n\npayload that is stored encrypted and compressed in an external file. There are some important differences\n\nthough, especially in the encryption algorithms used – RC4 in RedOctober vs AES in Cloud Atlas.\n\nThe usage of the compression algorithms in Cloud Altas and RedOctober is another interesting similarity.\n\nBoth malicious programs share the code for LZMA compression algorithm. In CloudAtlas it is used to\n\ncompress the logs and to decompress the decrypted payload from the C&C servers, while in Red October\n\nthe \"scheduler\" plugin uses it to decompress executable payloads from the C&C.\n\nIt turns out that the implementation of the algorithm is identical in both malicious modules, however the\n\nway it is invoked is a bit different, with additional input sanity checks added to the CloudAtlas version.\n\n\n-----\n\nAnother interesting similarity between the malware families is the configuration of the build system used\n\nto compile the binaries. Every binary created using the Microsoft Visual Studio toolchain has a special\n\nheader that contains information about the number of input object files and version information of the\n\ncompilers used to create them, the \"Rich\" header called so by the magic string that is used to identify it in\n\nthe file.\n\nWe have been able to identify several RedOctober binaries that have \"Rich\" headers describing exactly the\n\nsame layout of VC 2010 + VC 2008 object files. Although this doesn't necessarily mean that the binaries\n\nwere created on the same development computer, they were definitely compiled using the same version of\n\nthe Microsoft Visual Studio up to the build number version and using similar project configuration.\n\n|Number of object files, CloudAtlas loader|Number of object files, Red October Office plugin|Number of object files,Red October Fileputexec plugin|HEX compiler version|Decoded compiler version|\n|---|---|---|---|---|\n|01|01|01|009D766F|VC 2010 (build 30319)|\n|01|01|01|009B766F|VC 2010 (build 30319)|\n|22|2E|60|00AB766F|VC 2010 (build 30319)|\n|5B|60|A3|00010000|–|\n|05|07|11|00937809|VC 2008 (build 30729)|\n|72|5C|AD|00AA766F|VC 2010 (build 30319)|\n|20|10|18|009E766F|VC 2010 (build 30319)|\n\n\n-----\n\n|Col1|Cloud Atlas|RedOctober|\n|---|---|---|\n|Shellcode marker in spearphished documents|PT@T|PT@T|\n|Top target country|Russia|Russia|\n|Compression algorithm used for C&C communications|LZMA|LZMA|\n|C&C servers claim to be / redirect to|BBC (mobile malware)|BBC|\n|Compiler version|VC 2010 (build 30319)|VC 2010 (build 30319) (some modules)|\n\n\nFinally, perhaps the strongest connection comes from targeting. Based on observations from KSN, some\n\n**of the victims of RedOctober are also being targeted by CloudAtlas. In at least one case, the**\n\nvictim's computer was attacked only twice in the last two years, with only two malicious\n\n**programs – RedOctober and Cloud Atlas.**\n\nThese and other details make us believe that CloudAtlas represents a rebirth of the RedOctober attacks.\n\n## Conclusion\n\nFollowing big announcements and public exposures of targeted attack operations, APT groups behave in a\n\npredictable manner. Most Chinese-speaking attackers simply relocate C&C servers to a different place,\n\nrecompile the malware and carry on as if nothing happened.\n\nOther groups that are more nervous about exposure go in a hibernation mode for months or years. Some\n\nmay never return using the same tools and techniques.\n\nHowever, when a major cyber-espionage operation is exposed, the attackers are unlikely to completely\n\n**shut down everything. They simply go offline for some time, completely reshuffle their tools and return**\n\nwith rejuvenated forces.\n\n**We believe this is also the case of RedOctober, which makes a classy return with Cloud**\n\n**Atlas.**\n\nKaspersky products detect the malware from the Cloud Atlas toolset with the following verdicts:\n\nExploit.Win32.CVE-2012-0158.j\n\nExploit.Win32.CVE-2012-0158.eu\n\nExploit.Win32.CVE-2012-0158.aw\n\nExploit.MSWord.CVE-2012-0158.ea\n\nHEUR:Trojan.Win32.CloudAtlas.gen\n\n\n-----\n\nHEUR:Trojan.Script.Generic\n\nTrojan-Spy.Win32.Agent.ctda\n\nTrojan-Spy.Win32.Agent.cteq\n\nTrojan-Spy.Win32.Agent.ctgm\n\nTrojan-Spy.Win32.Agent.ctfh\n\nTrojan-Spy.Win32.Agent.cter\n\nTrojan-Spy.Win32.Agent.ctfk\n\nTrojan-Spy.Win32.Agent.ctfj\n\nTrojan-Spy.Win32.Agent.crtk\n\nTrojan-Spy.Win32.Agent.ctcz\n\nTrojan-Spy.Win32.Agent.cqyc\n\nTrojan-Spy.Win32.Agent.ctfg\n\nTrojan-Spy.Win32.Agent.ctfi\n\nTrojan-Spy.Win32.Agent.cquy\n\nTrojan-Spy.Win32.Agent.ctew\n\nTrojan-Spy.Win32.Agent.ctdg\n\nTrojan-Spy.Win32.Agent.ctlf\n\nTrojan-Spy.Win32.Agent.ctpz\n\nTrojan-Spy.Win32.Agent.ctdq\n\nTrojan-Spy.Win32.Agent.ctgm\n\nTrojan-Spy.Win32.Agent.ctin\n\nTrojan-Spy.Win32.Agent.ctlg\n\nTrojan-Spy.Win32.Agent.ctpd\n\nTrojan-Spy.Win32.Agent.ctps\n\nTrojan-Spy.Win32.Agent.ctpq\n\nTrojan-Spy.Win32.Agent.ctpy\n\nTrojan-Spy.Win32.Agent.ctie\n\nTrojan-Spy.Win32.Agent.ctcz\n\nTrojan-Spy.Win32.Agent.ctgz\n\nTrojan-Spy.Win32.Agent.ctpr\n\nTrojan-Spy.Win32.Agent.ctdp\n\nTrojan-Spy.Win32.Agent.ctdr\n\nTrojan.Win32.Agent.idso\n\nTrojan.Win32.Agent.idrx\n\nHEUR:Trojan.Linux.Cloudatlas.a\n\n\n-----\n\nTrojan.IphoneOS.Cloudatlas.a\n\n## Parallel research:\n\n[Blue Coat Exposes Inception Framework](https://www.bluecoat.com/security-blog/2014-12-09/blue-coat-exposes-%E2%80%9C-inception-framework%E2%80%9D-very-sophisticated-layered-malware)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/pyjpzua55mu6j1my5jegdiiovmpx35yi",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.12.10.RedOctober_APT/CloudAtlas_RedOctober_APT.pdf"
    ],
    "report_names": [
        "CloudAtlas_RedOctober_APT"
    ],
    "threat_actors": [
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9a58d7bb-dd32-41bc-804e-500ef7550cf8",
            "created_at": "2023-01-06T13:46:39.131811Z",
            "updated_at": "2025-03-27T02:00:03.004067Z",
            "deleted_at": null,
            "main_name": "ItaDuke",
            "aliases": [
                "DarkUniverse",
                "SIG27"
            ],
            "source_name": "MISPGALAXY:ItaDuke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "04a7ebaa-ebb1-4971-b513-a0c86886d932",
            "created_at": "2023-01-06T13:46:38.784965Z",
            "updated_at": "2025-03-27T02:00:02.91817Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "G0100"
            ],
            "source_name": "MISPGALAXY:Inception Framework",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041589,
    "ts_creation_date": 1418247107,
    "ts_modification_date": 1418247107,
    "files": {
        "pdf": "https://archive.orkl.eu/a9970d82d1b539ee63838619fcb9aaaae5f0c51d.pdf",
        "text": "https://archive.orkl.eu/a9970d82d1b539ee63838619fcb9aaaae5f0c51d.txt",
        "img": "https://archive.orkl.eu/a9970d82d1b539ee63838619fcb9aaaae5f0c51d.jpg"
    }
}