{
    "id": "6a1f3a49-37d4-483b-92c5-c5890a1bd51e",
    "created_at": "2023-01-12T15:09:44.221596Z",
    "updated_at": "2025-03-27T02:17:22.828838Z",
    "deleted_at": null,
    "sha1_hash": "a50ed566342e87020ed5b90d9ff2f09f67e05ed3",
    "title": "2020-07-28 - Lazarus on the hunt for big game",
    "authors": "",
    "file_creation_date": "2022-05-28T04:50:07Z",
    "file_modification_date": "2022-05-28T04:50:07Z",
    "file_size": 552968,
    "plain_text": "# Lazarus on the hunt for big game\n\n**securelist.com/lazarus-on-the-hunt-for-big-game/97757/**\n\nAuthors\n\n[Ivan Kwiatkowski](https://securelist.com/author/ivankwiatkowski/)\n\n[Pierre Delcher](https://securelist.com/author/pierredelcher/)\n\nFélix Aime\n\nWe may only be six months in, but there’s little doubt that 2020 will go down in history as a\nrather unpleasant year. In the field of cybersecurity, the collective hurt mostly crystallized\naround the increasing prevalence of targeted ransomware attacks. By investigating a number\nof these incidents and through discussions with some of our trusted industry partners, we\nfeel that we now have a good grasp on how the ransomware ecosystem is structured.\n\n\n-----\n\n**_Structure of the ransomware ecosystem_**\n\n[Criminals piggyback on widespread botnet infections (for instance, the infamous Emotet and](https://securelist.com/the-banking-trojan-emotet-detailed-analysis/69560/)\n[Trickbot malware families) to spread into the network of promising victims and license](https://securelist.com/bots-and-botnets-in-2018/90091/#trickster-trickbot)\nransomware “products” from third-party developers. When the attackers have a good\nunderstanding of the target’s finances and IT processes, they deploy the ransomware on all\nthe company’s assets and enter the negotiation phase.\n\nThis ecosystem operates in independent, highly specialized clusters, which in most cases\nhave no links to each other beyond their business ties. This is why the concept of threat\nactors gets fuzzy: the group responsible for the initial breach is unlikely to be the party that\ncompromised the victim’s Active Directory server, which in turn is not the one that wrote the\nactual ransomware code used during the incident. What’s more, over the course of two\nincidents, the same criminals may switch business partners and could be leveraging different\nbotnet and/or ransomware families altogether.\n\nBut of course, no complex ecosystem could ever be described by a single, rigid set of rules\nand this one is no exception. In this blog post, we describe one of these outliers over two\nseparate investigations that occurred between March and May 2020.\n\n## Case #1: The VHD ransomware\n\n\n-----\n\nThis first incident occurred in Europe and caught our attention for two reasons: it features a\nransomware family we were unaware of, and involved a spreading technique reminiscent of\nAPT groups (see the “spreading utility” details below). The ransomware itself is nothing\nspecial: it’s written in C++ and crawls all connected disks to encrypt files and delete any\nfolder called “System Volume Information” (which are linked to Windows’ restore point\nfeature). The program also stops processes that could be locking important files, such as\nMicrosoft Exchange and SQL Server. Files are encrypted with a combination of AES-256 in\nECB mode and RSA-2048. In our initial report published at the time we noted two\npeculiarities with this program’s implementation:\n\nThe ransomware uses Mersenne Twister as a source of randomness, but unfortunately\nfor the victims the RNG is reseeded every time new data is consumed. Still, this is\nunorthodox cryptography, as is the decision to use the “electronic codebook” (ECB)\nmode for the AES algorithm. The combination of ECB and AES is not semantically\nsecure, which means the patterns of the original clear data are preserved upon\nencryption. This was reiterated by cybersecurity researchers who analyzed Zoom\nsecurity in April 2020.\nVHD implements a mechanism to resume operations if the encryption process is\ninterrupted. For files larger than 16MB, the ransomware stores the current\ncryptographic materials on the hard drive, in clear text. This information is not deleted\nsecurely afterwards, which implies there may be a chance to recover some of the files.\n\n**_The Mersenne Twister RNG is reseeded every time it is called._**\n\nTo the best of our knowledge, this malware family was first discussed publicly in this blog\npost.\n\n\n-----\n\nA spreading utility, discovered along the ransomware, propagated the program inside the\nnetwork. It contained a list of administrative credentials and IP addresses specific to the\nvictim, and leveraged them to brute-force the SMB service on every discovered machine.\nWhenever a successful connection was made, a network share was mounted, and the VHD\nransomware was copied and executed through WMI calls. This stood out to us as an\nuncharacteristic technique for cybercrime groups; instead, it reminded us of the APT\n[campaigns Sony SPE,](https://securelist.com/destover/67985/) [Shamoon and OlympicDestroyer, three previous wipers with worming](https://unit42.paloaltonetworks.com/shamoon-3-targets-oil-gas-organization/)\ncapabilities.\n\nWe were left with more questions than answers. We felt that this attack did not fit the usual\n_modus operandi of known big-game hunting groups. In addition, we were only able to find a_\nvery limited number of VHD ransomware samples in our telemetry, and a few public\nreferences. This indicated that this ransomware family might not be traded widely on dark\nmarket forums, as would usually be the case.\n\n## Case #2: Hakuna MATA\n\nA second incident, two months later, was handled by Kaspersky’s Incident Response team\n(GERT). That meant we were able to get a complete picture of the infection chain leading to\nthe installation of the VHD ransomware.\n\nIn this instance, we believe initial access was achieved through opportunistic exploitation of a\nvulnerable VPN gateway. After that, the attackers obtained administrative privileges,\ndeployed a backdoor on the compromised system and were able to take over the Active\n\n\n-----\n\nDirectory server. They then deployed the VHD ransomware to all the machines in the\nnetwork. In this instance, there was no spreading utility, but the ransomware was staged\nthrough a downloader written in Python that we still believe to be in development. The whole\ninfection took place over the course of 10 hours.\n\nA more relevant piece of information is that the backdoor used during this incident is an\n[instance of a multiplatform framework we call MATA (some vendors also call it Dacls). On](https://blog.netlab.360.com/dacls-the-dual-platform-rat-en/)\n[July 22, we published a blog article dedicated to this framework. In it, we provide an in-depth](https://securelist.com/mata-multi-platform-targeted-malware-framework/97746/)\ndescription of its capabilities and provide evidence of its links to the Lazarus group. Other\nmembers of the industry independently reached similar conclusions.\n\nThe forensics evidence gathered during the incident response process is strong enough that\nwe feel comfortable stating with a high degree of confidence that there was only a single\nthreat actor in the victim’s network during the time of the incident.\n\n## Conclusion\n\nThe data we have at our disposal tends to indicate that the VHD ransomware is not a\ncommercial off-the-shelf product; and as far as we know, the Lazarus group is the sole owner\nof the MATA framework. Hence, we conclude that the VHD ransomware is also owned and\noperated by Lazarus.\n\nCircling back to our introduction, this observation is at odds with what we know about the\ncybercrime ecosystem. Lazarus has always existed at a special crossroads between APT\nand financial crime, and there have long been rumors in the threat intelligence community\nthat [the group was a client of various botnet services. We can only speculate about the](https://labs.sentinelone.com/the-deadly-planeswalker-how-the-trickbot-group-united-high-tech-crimeware-apt/)\nreason why they are now running solo ops: maybe they find it difficult to interact with the\ncybercrime underworld, or maybe they felt they could no longer afford to share their profits\nwith third parties.\n\nIt’s obvious the group cannot match the efficiency of other cybercrime gangs with their hitand-run approach to targeted ransomware. Could they really set an adequate ransom price\nfor their victim during the 10 hours it took to deploy the ransomware? Were they even able to\nfigure out where the backups were located? In the end, the only thing that matters is whether\nthese operations turned a profit for Lazarus.\n\nOnly time will tell whether they jump into hunting big game full time, or scrap it as a failed\nexperiment.\n\n## Indicators of compromise\n\n_The spreader utility contains a list of administrative credentials and IP addresses specific to_\n_the victim, which is why it’s not listed in the IoC section._\n\n\n-----\n\n_As the instance of the MATA framework was extracted from memory, no relevant hashes can_\n_be provided for it in the IoC section._\n\n**VHD ransomware**\n6D12547772B57A6DA2B25D2188451983\nD0806C9D8BCEA0BD47D80FA004744D7D\nDD00A8610BB84B54E99AE8099DB1FC20\nCCC6026ACF7EADADA9ADACCAB70CA4D6\nEFD4A87E7C5DCBB64B7313A13B4B1012\n\n**Domains and IPs**\n172.93.184[.]62         MATA C2\n23.227.199[.]69         MATA C2\n104.232.71[.]7           MATA C2\nmnmski.cafe24[.]com    Staging endpoint for the ransomware (personal web space hosted\nat a legit web service and used                        as a redirection to another\ncompromised legit website).\n\n[Botnets](https://securelist.com/tag/botnets/)\n[Cybercrime](https://securelist.com/tag/cybercrime/)\n[Lazarus](https://securelist.com/tag/lazarus/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Ransomware](https://securelist.com/tag/ransomware/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\n[Ivan Kwiatkowski](https://securelist.com/author/ivankwiatkowski/)\n\n[Pierre Delcher](https://securelist.com/author/pierredelcher/)\n\nFélix Aime\n\nLazarus on the hunt for big game\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-28 - Lazarus on the hunt for big game.pdf"
    ],
    "report_names": [
        "2020-07-28 - Lazarus on the hunt for big game.pdf"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536184,
    "ts_updated_at": 1743041842,
    "ts_creation_date": 1653713407,
    "ts_modification_date": 1653713407,
    "files": {
        "pdf": "https://archive.orkl.eu/a50ed566342e87020ed5b90d9ff2f09f67e05ed3.pdf",
        "text": "https://archive.orkl.eu/a50ed566342e87020ed5b90d9ff2f09f67e05ed3.txt",
        "img": "https://archive.orkl.eu/a50ed566342e87020ed5b90d9ff2f09f67e05ed3.jpg"
    }
}