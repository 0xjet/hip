{
    "id": "5cd19c77-bf64-4f5b-80fa-13d2e33f05a5",
    "created_at": "2023-01-12T15:03:15.632754Z",
    "updated_at": "2025-03-27T02:09:30.283107Z",
    "deleted_at": null,
    "sha1_hash": "6ac1ee3d7b3215df12e42f5b674086056a056c39",
    "title": "2022-02-22 - CrowdStrike Research Investigates Exploit Behavior to Strengthen Customer Protection",
    "authors": "",
    "file_creation_date": "2022-05-28T01:56:19Z",
    "file_modification_date": "2022-05-28T01:56:19Z",
    "file_size": 3854462,
    "plain_text": "# Exploit Research Strengthens Customer Protection\n\n**[crowdstrike.com/blog/exploit-research-strengthens-customer-protection/](https://www.crowdstrike.com/blog/exploit-research-strengthens-customer-protection/)**\n\nJoseph Goodwin - Aspen Lindblom February 22, 2022\n\nCrowdStrike continuously observes and researches exploit behavior to strengthen\nprotection for customers\nCode execution techniques constantly target Windows, Linux and macOS operating\nsystems\nSuccessful remote/arbitrary code execution can enable a foothold for attackers to\ncontinue compromise\nUnderstanding and detecting post-exploit activity is imperative for keeping\nenvironments safe\n\nAs technology continues to evolve rapidly, so do the techniques used by adversaries. This\nmay be considered a given, but it is important to appreciate how attackers may leverage\nexisting and commonly used applications within an environment to attempt to seize control\nand achieve their objectives. These post-exploitation tactics are something that the\n[CrowdStrike Falcon®](https://www.crowdstrike.com/endpoint-security-products/) sensor homes in on and detects, generating alerts when it observes a\nprocess acting suspiciously, to ensure our customers are alerted and kept up-to-date with\nprecisely what is happening in their environments.\n\n\n-----\n\nIn most cases, an attacker will attempt to gain some form of code execution — either\narbitrary code execution (ACE) or remote code execution (RCE) — to further their reach into\nan environment and achieve their objectives. If an adversary obtains code execution in a\ntargeted environment, they have succeeded in gaining a foothold to continue their attack.\nHow they choose to continue is determined by their end objective. For example, some\ncommon next steps may include reconnaissance, privilege escalation, information stealing,\nor dropping and executing further payloads. The impact that this may cause can only truly be\nmeasured by the victim after the damage has been done, but suffice to say, it is never a\npositive situation for any company.\n\nCrowdStrike takes a layered approach to security to detect and prevent post-exploit activity,\nsuch as attempted malicious code execution throughout these multiple layers. It is important\nto understand that the concepts of ACE and RCE are not bound to a specific operating\nsystem (although particular instances will be). This is why we research and simulate\nvulnerabilities — to provide customers with the best available defense against exploitation of\nvulnerabilities delivered through these types of attacks.\n\nTo help illustrate the Falcon platform’s diversity in its ability to detect these types of unwanted\ncode-execution vulnerability attacks, this blog discusses examples of both RCE and ACE\nvulnerabilities in Windows, Linux and Mac. We take a deep look into how the Falcon sensor\nidentifies these threats to keep your environment safe.\n\n## Windows: Microsoft MSHTML Remote Code Execution Vulnerability\n\nIn Windows, there are RCE vulnerabilities that affect the MSHTML browser engine. Attackers\ncan create malicious Microsoft Office documents exploiting these vulnerabilities, and then\ntrick users into opening them. In essence, attackers place a special object within a document\nfile. When the victim opens the tainted document, an attacker-controlled external URL is\ncontacted, and its contents are downloaded and subsequently executed by the MSHTML\nengine.\n\nAt the time of its disclosure, this vulnerability was reported to have been observed being\nexploited in the wild. Microsoft has stated that MS Office opens documents in Protected View\nor Application Guard for Office, therefore providing some form of prevention against the\nexploitation of the vulnerability. However, if an attacker is able to craft a document which the\nuser trusts and in turn, enables editing, the vulnerability may be exploited.\n\nCustomers taking advantage of our Spotlight service are able to input CVEs (such as this\none) and get results returned on endpoints that may be vulnerable to the related types of\nattack. Also provided is a wealth of information in relation to the CVE and required steps for\nremediation. One of the links provided within a Spotlight scan for a CVE is a link to the\nvendor advisory for further reading. In the case of this example the related advisory\n[published can also be found here.](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-40444)\n\n\n-----\n\nFigure 1. Spotlight returns results of hosts vulnerable to CVE-2021-40444 (Click to enlarge)\n\nAdditionally, after in-depth testing to replicate how these vulnerabilities are triggered,\ncommon patterns emerge regarding the process trees generated from exploiting them.\n\nFigure 2. Falcon process tree for MSHTML browser engine remote code execution (Click to enlarge)\n\nThis included activities like productivity applications writing binaries with unique, targetable\nvalues such as file name, file type or behavior. Discovering this ensured that the relevant\ndetection research teams could target several different levels of the process trees, which,\nwhen all seen together, indicated this RCE attempt in a myriad of different scenarios.\n\nEven after the initial work had been conducted (and the associated detections released),\n[further analysis uncovered additional areas throughout the kill chain that yielded high true](https://www.crowdstrike.com/cybersecurity-101/cyber-kill-chain/)\npositive detection rates for activity relating to this RCE behavior. This subsequent analysis\nuncovered specific file types being written to targeted locations on disk which matched a\nunique process lineage. For the best possible coverage for customers, this avenue was\nfurther explored and confirmed to indicate behavior associated with MSHTML browser\n\n\n-----\n\nengine RCE. As a result of this research, multiple detections were pushed out to all\ncustomers to form a multi-layered defense against exploitation attempts for this vulnerability\nand ensure that customers are protected.\n\n## Linux: Targeted Arbitrary Code Execution in Specific Server Types\n\nOne example of a Linux vulnerability involves Object-Graph Navigation Language (OGNL)\ninjection in specific server types and data center software. For instance, a specially crafted\nrequest can be sent to vulnerable endpoints on the associated server or data center\ninstance. Furthermore, this could be exploited by either a remotely authenticated attacker or,\nunder the right circumstances, an unauthenticated attacker, which would lead to arbitrary\ncode execution, potentially raising the severity of the vulnerability to critical.\n\n[After its initial public disclosure on August 25, 2021, the CrowdStrike Falcon OverWatch™](https://www.crowdstrike.com/endpoint-security-products/falcon-overwatch-threat-hunting/)\nthreat hunters began to relentlessly investigate any implication that CrowdStrike’s customers\nmay be under attack via this method. Through their investigations, the associated teams\nquickly began to see the attack surface for this vulnerability widen from purely Linux-based\nexploitation attempts to including Windows attempted exploitation.\n\nWith their knowledge of the exploit and their observations on attempted attacks against\ncustomers, OverWatch hunters were quick to identify early signs of attempted exploitation.\nOne such example includes attackers writing and decoding a Base-64 encoded string to a\nfile in the confluence directory. You can read more on the Falcon OverWatch hunting team’s\nefforts [here.](https://www.crowdstrike.com/blog/how-crowdstrike-threat-hunters-identified-a-confluence-exploit/)\n\nDue to the severity of this vulnerability, other internal teams also began performing parallel\nresearch efforts to ensure that CrowdStrike’s scope of coverage against this vulnerability\nensured maximum coverage. These scenarios are thoroughly researched and tested in\ncontrolled environments to obtain as much relevant telemetry as possible. This way, the\nresearch teams can find patterns related to the behavior of the exploit and determine ways in\nwhich the Falcon sensor’s layered approach can detect it. Specific points of interest can\nemerge, such as similarities in the process lineage itself, the associated command lines used\non each level, and specific behavioral traits displayed by the endpoint.\n\nBy reviewing the telemetry and associated process trees in successfully exploited scenarios,\nthe teams can craft detections based on both patterns that emerge in the process trees and\n[observed behavior displayed by the endpoint. This helps further reduce false positive](https://www.crowdstrike.com/cybersecurity-101/endpoint-security/what-is-an-endpoint/)\ndetections and strengthens the probability that the associated activity relates to exploiting a\nknown vulnerability. Associated exploit activity observed in testbed detonations included\nvarious attempts at persistence, network connection activity, recon activity, and attempted file\ndownload, among many others. Targeting the process actions and its requests of the\nendpoint helps ensure that the CrowdStrike Falcon sensor produces high-fidelity detections\nfor customers.\n\n\n-----\n\nFigure 3. Falcon process tree for observing and killing malicious post-exploit behavior occurring on a\n\nvulnerable server (Click to enlarge)\n\nWhat’s interesting about the above screenshot (which shows the related activity being\nblocked) is that it highlights a common post exploit method where attackers often attempt to\nutilize wget/curl (etc.) in order to retrieve further payloads to run in targeted environments to\n[extend their reach. This method is also seen with the more recent Log4j exploit attempts](https://www.crowdstrike.com/log4j2/)\n(shown in Figure 4) where CrowdStrike prevented the malicious actions from occurring.\n\nFigure 4. Process tree of post-exploit log4j attempted malicious download (Click to enlarge)\n\n## macOS: Pre-install Scripts\n\nAnother tactic using post-exploit code execution in macOS environments involves malicious\npost/pre-install of package scripts. In essence, malicious scripts leverage the macOS\nInstaller API during an installation process. This type of behavioral manipulation is yet\nanother avenue that attackers can exploit to gain a foothold into a network. While not\ntechnically considered a “full” RCE (as it still requires user interaction to run the initial install),\nthis technique is another form of RCE that attackers can use to compromise an endpoint and\nsubsequently a network.\n\n\n-----\n\nFigure 5. Falcon process tree for malicious pre-install package scripts (Click to enlarge)\n\nFor instance, Silver Sparrow is a malware example that uses this method. The user runs a\nseemingly innocent .pkg file and unknowingly triggers RCE, which can be used for\npersistence, connect to a command-and-control (C2) channel, perform active recon on the\ntarget machine or conduct other attacker-related activities.\n\nThe important thing to recognize here is that this malware is a pre-installer, which means that\nthe code is run at the very beginning of the .pkg files execution. This means that the end\nuser is already infected by the time the installation of the .pkg file has completed.\nFortunately, the CrowdStrike Content Research and Response team was able to investigate\nand mitigate the associated behavior to ensure that this type of scenario does not play out in\ncustomer environments.\n\nWith the emergence of this technique, CrowdStrike’s Content Research and Response team\nbegan investigating this activity to identify and prevent it within customer macOS\nenvironments. We quickly began to understand the methodology of the attack by reviewing\nexisting telemetry and the associated data generated from further testing. After obtaining a\nthorough understanding of how this attack is conducted, and the risk which it could pose to\ncustomers depending on the potential weaponization, the team found a way to ensure that\nthe associated activity is killed before it has a chance to execute. After rigorous testing,\nCrowdStrike’s Content Research and Response team were then able to ensure high-fidelity\npreventions were put in place to combat this type of exploit attempt by targeting it at multiple\nstages of the process lineage.\n\n## The Ultimate Value of CrowdStrike’s Threat Research and Layered Approach to Security\n\n\n-----\n\nVulnerability exploitation research enables CrowdStrike to protect customers better. Coupled\nwith our on-sensor and in-the-cloud machine learning and behavior-based protection, the\nFalcon platform can detect threats and protect customers. As with most vulnerabilities, the\nbest option is to ensure that systems across any environment are part of a good patch\n[management plan. CrowdStrike Falcon Spotlight™ is a scanless, “always on” vulnerability](https://www.crowdstrike.com/endpoint-security-products/falcon-spotlight-vulnerability-management/)\nmanagement solution for all of the endpoints in your infrastructure shining insight into areas\nof your environment that may require further attention in order to ensure a strong security\nposture is maintained.\n\nUsing an example from the above scenarios, we can see how Spotlight comes in to assist\nwith its ability to utilize scanless technology to determine which endpoints in your\nenvironment may be susceptible to specific vulnerabilities simply by searching the CVE ID.\nThis specific CVE has an ExPRT rating of Critical and a severity of High. Reviewing the\ndetections against this CVE provides a wealth of information including remediation details,\nvendor advisories, references, probable sources and much more. (ExPRT rating is based on\n[a dynamic rating ML model, that may differ from traditional CVSS scores. Learn more here.)](https://www.crowdstrike.com/blog/tech-center/spotlight-exprt-ai/)\n\nFigure 6. CrowdStrike Falcon Spotlight dashboard (Click to enlarge)\n\nWe can also see from the examples above how CrowdStrike’s Falcon OverWatch threat\nhunters are quick to respond to an ever-evolving threat landscape, connecting the dots and\npiecing together critical bits of information to obtain the upper hand and keep our customers’\nenvironments safe.\n\nAdditionally, we can see how other teams such as Content Research and Response also\ninvestigate, analyze and create associated detections and preventions around suspicious\nactivity — which has potential to cause significant harm into customer environments if used\n\n\n-----\n\nunder specific circumstances — while ensuring that related but benign activity is left to run\nunimpeded.\n\nOn top of all of this, there are more additional layers of security used, such as our various\nmachine learning models which weren’t even discussed.\n\nThe examples above describe how a technique, such as code execution, can come in\nvarious flavors across different operating systems and how CrowdStrike researchers\ninvestigate them to protect customers from exploitation and the multiple layers of protection\nwe employ to ensure our customers’ environments remain safe. We strive to ensure that our\ncustomers are kept safe from post-exploitation activity that could have a devastating impact if\nmissed by adopting a layered approach to security. Attackers often find new ways to blend\ninto environments, making it more challenging to detect their attempts to gain a foothold into\nendpoints and networks. At CrowdStrike, we remain dedicated to our mission to stop\nbreaches.\n\n**Additional Resources**\n\n_Read more about how Falcon protects against malware in this recent blog: CrowdStrike_\n_[Falcon Proactively Protects Against Wiper Malware as CISA Warns U.S. Companies of](https://www.crowdstrike.com/blog/how-crowdstrike-protects-against-data-wiping-malware/)_\n_Potential Attacks._\n_Learn about the powerful, cloud-native CrowdStrike Falcon platform by visiting the_\n_product webpage._\n_[Get a full-featured free trial of CrowdStrike Falcon Prevent™ to see for yourself how](https://go.crowdstrike.com/try-falcon-prevent.html)_\n_true next-gen AV performs against today’s most sophisticated threats._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-22 - CrowdStrike Research Investigates Exploit Behavior to Strengthen Customer Protection.pdf"
    ],
    "report_names": [
        "2022-02-22 - CrowdStrike Research Investigates Exploit Behavior to Strengthen Customer Protection.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535795,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1653702979,
    "ts_modification_date": 1653702979,
    "files": {
        "pdf": "https://archive.orkl.eu/6ac1ee3d7b3215df12e42f5b674086056a056c39.pdf",
        "text": "https://archive.orkl.eu/6ac1ee3d7b3215df12e42f5b674086056a056c39.txt",
        "img": "https://archive.orkl.eu/6ac1ee3d7b3215df12e42f5b674086056a056c39.jpg"
    }
}