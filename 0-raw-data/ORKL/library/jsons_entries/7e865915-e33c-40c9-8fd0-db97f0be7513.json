{
    "id": "7e865915-e33c-40c9-8fd0-db97f0be7513",
    "created_at": "2024-07-25T02:06:28.911514Z",
    "updated_at": "2025-03-27T02:17:17.154479Z",
    "deleted_at": null,
    "sha1_hash": "79ff34959da474bdc138cf676d41a925c1e53c95",
    "title": "",
    "authors": "",
    "file_creation_date": "2024-06-28T15:26:47Z",
    "file_modification_date": "2024-06-28T15:26:47Z",
    "file_size": 14395868,
    "plain_text": "# 標的型攻撃の実態と 対策アプローチ\n\n##### 日本を狙うサイバーエスピオナージ（標的型攻撃）の動向2023年度\n\n###### 2024 年 5 月 1日\n\n 株式会社マクニカ\n\n\n-----\n\n## 目次\n\n###### ■ はじめに ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 2\n\n ■ 攻撃のタイムラインと攻撃が観測された業種 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 3\n\n ■ 攻撃の概要 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 5\n\n 2023 年 4 月 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 5\n\n 2023 年 5 月 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 5\n\n 2023 年 6 月 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 7\n\n 2023 年 7 月 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 7\n\n 2023 年 10 月 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 9\n\n 2024 年 1 月 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 10\n\n 2024 年 3 月 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 11\n\n ■ 新しいTTPs や RAT など ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 12\n\n Mustang Panda（PUBLOAD） ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 12\n\n 攻撃キャンペーンの概要 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 12\n\n Mustang Panda 攻撃キャンペーンの特徴と検出 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 18\n\n Mustang Panda（ 東南アジア圏で観測されたPlugDisk による攻撃 ）・・・・・・・・・・・・・・・・・ 20\n\n 攻撃キャンペーンの概要 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 20\n\n 感染フロー ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 20\n\n PlugDisk 詳細解析 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 23\n\n PlugDisk USB を介した感染の考察 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 29\n\n Ivanti 製品の脆弱性を悪用した攻撃キャンペーン ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 30\n\n 攻撃キャンペーンの概要 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 30\n\n 国内で観測された悪用事例 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 30\n\n パッシブバックドア ProxDoor ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 31\n\n ■ 攻撃グループごとの TTPs（ 戦術 、 技術 、 手順 ） ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 34\n\n ■ TTPs より考察する脅威の検出と緩和策 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 36\n\n マルウェアの配送・攻撃について ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 36\n\n インストールされるRAT、遠隔操作（C2 サーバについて ） ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 36\n\n ■ 検知のインディケータ ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 37\n\n本資料に記載されている情報は 、株式会社マクニカが信頼できると判断したソースを活用して記述されていますが 、\n\nそのソースを株式会社マクニカが保証しているわけではありません。この資料に、著者の意見が含まれる場合があ\n\nり ま すが 、そ の 意見は 変 更され る ことが あ ります。この資料は、株式マクニカが著作権を有しています。この資料を、\n\n全体または一部を問わず 、 ハードコピー形式か 、電子的か、またはそれ以外の方式かに関係なく 、株式会社マクニ\n\n\n-----\n\n## はじめに\n\nマクニカでは 、セキュリティ研究センターを中心に 、日本の組織に着弾する標的型攻撃 （ サイバーエスピオナー\n\nジ ） を 2014 年から分析してきました 。 情報窃取を目的としたこの種のサイバー攻撃は 、 ランサムウェアによる\n\n攻撃と違って長期間に渡って侵害に気づかない組織が多く 、 表面化するケースも比較的少ないため 、 情報共有が\n\nされにくいと言えます 。 しかし 、 国内外のサイバーセキュリティ業界の長年の努力によって今日まで収集された\n\n攻撃痕跡 （ マルウェア 、 攻撃インフラ 、 ログ ） を分析していくと 、 各攻撃グループの TTPs、 目的や意図 、 スキ\n\nルレベルなどが 、 徐々に浮き彫りになってきています 。 このような取り組みは 、 組織を超えた戦略的な情報共有\n\nとインテリジェンスへの昇華によって成り立ちます 。\n\n本レポートでは 、2023 年度 (2023 年 4 月から 2024 年 3 月 ) に観測された 、 日本の組織から機密情報 ( 個\n\n人情報 、 政策関連情報 、 製造データなど ) を窃取しようとする攻撃キャンペーンの分析結果について注意喚起を\n\n目的として記載しています 。 ステルス性の高い遠隔操作マルウェア (RAT) を用いた事案を中心に 、 新しい攻撃\n\n手法やその脅威の検出について記載しています 。 レポートの最後には 、 本文中で紹介した攻撃キャンペーンで使\n\nわれたインディケータを掲載しています 。\n\n2023 年度は 、 ここ 10 年ほど継続しているスピアフィッシングに加え 、 外部公開アセットからの侵入 、 更には\n\nUSB や Wi-Fi アクセスポイントからの物理的な侵入なども観測され 、「 標的型攻撃 」 に分類される攻撃は活発で\n\nあった印象があります 。 侵入方法においては 、 特に様々な手法を駆使して標的組織に侵入しようとしているよう\n\nな傾向が見られました 。 侵入方法の中で外部公開アセットの脆弱性を攻撃して侵入するケースが増加している事\n\nが一因となり 、これまで観測のなかったと思われる攻撃グループの観測も見られており 、注意が必要と思われます 。\n\nまた 、 攻撃者間での攻撃ツールのシェアリング 、 オープンソースの遠隔操作ツールなどの活用などもあり 、 攻撃\n\n者の帰属に難しさが生じています 。\n\nこれまでの標的型攻撃の傾向と比べると 、 メディアや安全保障 ・ 外交関連といったここ 10 年ほど継続して標的\n\nとされている業界がある一方 、 広い分野に渡る製造業などは攻撃者の目標の変化があり 、 ひそかに新しい標的に\n\n攻撃が来るような事態が起こり始めていると思われます 。 残念ながら 、 標的型攻撃に分類される特定の組織だけ\n\nを狙った攻撃はまだまだ継続しており 、 警戒が必要な状況です 。 このような日本企業の産業競争力を徐々に蝕ん\n\nでいく標的型攻撃に対して 、 今後も粘り強い分析と啓蒙活動に取り組んでいく所存です 。\n\n本書には 、 検体解析のような技術的に深い内容も含まれるため 、 少々難しいと感じられる読者もいらっしゃると\n\n思います 。 そのような場合 、 難解な箇所はスキップして前半の標的型攻撃の対象となった業種と攻撃が発生した\n\n国内組織の拠点地域 、 後半の攻撃への対策といった箇所だけでも対策の参考にして頂ければと思います 。\n\n\n-----\n\n## 攻撃のタイムラインと攻撃が観測された業種\n\n2023 年度は 、 昨年度までの攻撃 [1] と比較して新たな攻撃グループが多く出現しています 。Barracuda ESG\n\nの CVE-2023-2868 脆弱性攻撃から組織に侵入した UNC4841 [2] 攻撃グループ 、RatelS [3] 遠隔操作マルウェ\n\nアでインフラ関連組織を標的に攻撃を行った TELEBOYi 攻撃グループ [4]、BLOODALCHEMY [5 6] 遠隔操作マル\n\nウェアで製造関連組織を標的に攻撃を行った Vapor Panda 攻撃グループ [7]、Ivanti 社の\n\nCVE-2023-46805/CVE-2024-21887 脆弱性を攻撃して学術系並びに製造業種で攻撃が観測された\n\nUNC5221 [8] 攻撃グループ です 。一方で 、2022 年度やそれ以前にも日本を標的としていた攻撃グループとして 、\n\nAPT10 攻撃グループの LODEINFO マルウェア [9] を使った攻撃 、Tropic Trooper 攻撃グループの\n\nEntryShell [10] マルウェアを使った攻撃 、Mustang Panda 攻撃グループの PlugX [11] や PUBLOAD [12 13] マル\n\nウェアを使った攻撃 、攻撃主体は分析中ではあるものの中国の攻撃グループで利用が報告されているオープンソー\n\nスの Stowaway を悪用した攻撃などが観測されました 。\n\n\n表 1. タイムチャート\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n\n政府関連 製造関連 インフラ 学術 不明\n\nhttps://www.macnica.co.jp/business/security/security-reports/pdf/cyberespionage_report_2022.pdf\n\nhttps://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally\n\nhttps://www.lac.co.jp/lacwatch/report/20230914_003513.html\n\nhttps://jsac.jpcert.or.jp/archive/2024/pdf/JSAC2024_1_8_yi-chin_yu-tung_en.pdf\n\nhttps://www.elastic.co/security-labs/disclosing-the-bloodalchemy-backdoor\n\nhttps://www.botconf.eu/botconf-presentation-or-article/into-the-vapor-to-tracking-down-unknown-pandas-claw-marks/\n\nhttps://www.crowdstrike.com/adversaries/vapor-panda/\n\nhttps://www.mandiant.jp/resources/blog/investigating-ivanti-zero-day-exploitation\n\nhttps://blogs.jpcert.or.jp/ja/tags/lodeinfo/\n\nhttps://www.virusbulletin.com/uploads/pdf/conference/vb2023/slides/Slides-Unveiling-Activities-of-Tropic-Trooper.pdf\n\nhttps://unit42.paloaltonetworks.jp/plugx-variants-in-usbs/\n\nhttps://csirt-cti.net/2024/01/23/stately-taurus-targets-myanmar/\n\nhtt // it42 l lt t k j / hi t t t titi /\n\n\n-----\n\n不明\n\n\n学術\n\nクリティカルインフラ\n\n政府関連\n\n\n製造\n\n\n図 1. 標的業種の割合（2023 年度 ）\n\n\n標的型攻撃の侵入パターンとして 、 これまではスピアフィッシングがもっとも多く観測されていましたが 、2023\n\n年度は外部公開アセットの脆弱性を攻撃して侵入するケースがもっとも多くなっています 。 それに加え 、 製造関連\n\n組織の海外拠点などでは組織の近傍で Wi-Fi アクセスポイントを悪用して組織に侵入する 、USB デバイスからマ\n\nルウェアに感染するといった手法も観測されています 。\n\nWi-Fi アクセスポイント\n\nUSB\n\n外部公開アセット\n\nスピアフィッシング\n\n\n図 2. アタックサーフェースの割合（2023 年度 ）\n\n\n-----\n\n## 攻撃の概要\n\n以下は 、4 月から 3 月までの月ごとに観測された攻撃の概要を記載しています 。\n\n###### 2023 年 4 月\n\nAPT10 LODEINFO ( 標的 : 不明 )\n\nAPT10 攻撃グループの LODEINFO v0.6.9 がパブリックマルウェアリポジトリにアップロードされた事を観\n\n測しました 。 アップロードされたファイル名 「Elze.exe」「frau.dll」「Elze.exe_」 が LODEINFO v0.6.8\n\nのダウンローダがドロップするファイル名と同じである事 、v0.6.9 の感染フローで ”Remote Template\n\nInjection” のテクニックの利用を観測したレポートが公開されている事 [14] から 、4 月にアップロードされたファ\n\nイルもスピアフィッシングメールでドキュメントファイルが配送されて最終的にドロップされたものであると推\n\n測しています 。 機能的には v0.6.8 との大きな違いはみられませんでした 。\n\n\n図 3. ペイロードに埋め込まれているバージョン情報\n\n\n###### 2023 年 5 月\n\nTropic Trooper ( 標的 : 製造関連 )\n\nCobalt Strike や EntryShell マルウェアを遠隔操作ツールとして利用した Tropic Trooper 攻撃グループの\n\n攻撃が 、 製造関連企業の中国拠点で観測されました 。 スピアフィッシングメールや中国で人気のチャットツール\n\nを使ってマルウェアが配送された他 、 組織の Wi-Fi アクセスポイントと同様の偽アクセスポイントを使って情報\n\nを窃取しつつ 、 窃取した情報で正規の Wi-Fi アクセスポイントから侵入し 、 リモートログオンに成功した PC に\n\nマルウェアを設置するといった物理的な侵入も行っていました 。 また 、 攻撃の 2 次バックドアとして\n\nFamousSparrow 攻撃グループの SparrowDoor マルウェアと関連の見られる CrowDoor [15] バックドアや\n\nVisual Studio Code の Remote Tunnel を使った攻撃者による遠隔コマンドの実行 [16] が観測されました 。\n\n\n14\n\n15\n\n16\n\n\nhttps://blog.itochuci.co.jp/entry/2024/01/24/134047\n\nhttps://blog.itochuci.co.jp/entry/2023/10/06/003000\n\nh //j j j / hi /2024/ df/JSAC2024 2 3 d h df\n\n\n-----\n\n図 4. CrowDoor バックドアのコマンド命令\n\n\nVapor Panda ( 標的 : 製造関連 )\n\n製造関連企業の VPN 装置に窃取したアカウントで不正侵入した後 、組織内のリモート接続可能な Windows サー\n\nバに DLL サイドローディングを行うマルウェアを設置した攻撃が検出されました 。 設置されたファイルは 、 ブラ\n\nザー工業社の正規実行ファイル BrDifxapi.exe とローダ DLL の BrLogApi.dll、暗号ファイルの DIFX でした 。\n\nBrDifxapi.exe が実行されると 、BrLogApi.dll が DIFX ファイルを読んで AES で復号してシェルコードを実\n\n行します 。 このシェルコードから展開されるバックドアペイロードは 、BLOODALCHEMY で C2 サーバが\n\nHTTPS[:]cdn1ac7bdd3[.]jptomorrow[.]com でした 。\n\n\n図 5. BLOODALCHEMY マルウェアのコンフィグに含まれる文字列\n\n\n-----\n\n###### 2023 年 6 月\n\nMustang Panda ( 標的 : 製造関連 )\n\n製造関連企業のベトナム拠点で PC に差し込まれた USB リムーバブルドライブから 、PlugX マルウェアへの感\n\n染を狙った攻撃が検出されました 。USB リムーバブルドライブは 、 以前に同じ PlugX に感染した別の PC で使\n\nわれた事があると思われ 、PlugX マルウェアにより USB リムーバブルドライブに自身をコピーして別の PC で\n\n感染するように細工が施されていました 。 リムーバブルドライブのルートフォルダには 、 リムーバブルドライブ\n\nへのアクセスを行うショートカットファイルと隠しフォルダが設定され 、 ショートカットファイルを実行する事\n\nで 、 隠しフォルダの PlugX マルウェアの PC への設置と実行がなされつつ 、 リムーバブルドライブの本来ファ\n\nイルが表示される攻撃となっていました 。\n\n\n図 6. PlugX の感染が仕込まれたリムーバブルフォルダ\n\n\n###### 2023 年 7 月\n\nAPT10 LODEINFO ( 標的 : 不明 )\n\nAPT10 攻撃グループの LODEINFO v0.7.1 のダウンローダがパブリックマルウェアリポジトリにアップロー\n\nドされた事を観測しました 。 ドキュメントに含まれるマクロは複数の base64 でエンコードされた文字列を連結\n\nしてデコードすることでシェルコードのバイト文字列を生成します 。 マクロを有効にした後に 、 表示されている\n\n「OK」 ボタンを押下すると 、 外部サーバから LODEINFO の実行に必要な複数ファイルがバンドルされた暗号化\n\nファイルがダウンロードされ 、 復号 ・ 実行されます 。\n\nまた 、 ダウンローダである doc ファイルには button オブジェクトが多数埋め込まれており 、 ファイルサイズが\n\n約 6.8M に肥大化していました 。 これらの特徴はサンドボックスによる動的解析とシグネチャベースのアンチウ\n\nイルス製品の検知回避を意図したものであるとみています 。\n\n\n-----\n\n図 7. v0.7.1 ダウンローダ ドキュメントファイル\n\n\n-----\n\n図 8. ドキュメントファイルに埋め込まれた多数の buttonオブジェクト\n\n\nシェルコードはハードコードされたバイト文字列をシングルバイトで XOR して URL の文字列を準備し 、\n\nURLDownloadToFile() でファイルをダウンロードします 。 今回のバージョンではダウンロードしたファイル\n\nは PEM 形式の証明書として偽装されており 、\"-----BEGIN CERTIFICATE-----\" から \"-----END\n\nCERTIFICATE-----\" までの文字列を base64 でデコードして 、 先頭から 3 バイト目以降を AES で復号し 、 続\n\nいて AES で復号したデータの 3 バイト目の値を使ってシングルバイトの XOR でデータを復号します 。 ファイ\n\nルはこれまでと同様に 3 つのファイルが含まれており 、 ファイルサイズ 、 ファイル名 、 データのフォーマットで\n\n分割して %UserProfile%\\Downloads にファイルを保存して実行します 。\n\n###### 2023 年 10 月\n\nNA ( 標的 : 製造関連 )\n\n製造関連企業にて 、 ウェブサーバにオープンソースの Go 言語で開発された Stowaway が UPX でパックされ\n\nて設置されました 。Stowaway はファイルのアップロード 、ダウンロードとリモートシェルの機能を持ったバッ\n\nクドアまたはトラフィックを中継するプロキシで 、 中国を拠点としたいくつかの攻撃グループによって攻撃に利\n\n用されており [17]、 中国を拠点とした攻撃グループによる可能性があると思われます 。\n\n\n-----\n\n図 9. Github で公開されているSTOWAWAY\n\n\n###### 2024 年 1 月\n\nUNC5221 ( 標的 : 学術 、 製造関連 )\n\nIvanti 社 CVE-2023-46805 CVE-2024-21887 の脆弱性をついた攻撃が確認されました 。Ivanti 社の\n\nLinux OS 上に ELF バイナリとして動作するバックドアやウェブシェルとして動作するよう改竄されたファイル\n\nなどの他 、 クレデンシャルをダンプした結果の出力ファイルなどが国内でも複数の組織で確認されました 。\n\n\n図10 . Ivanti 社 VPN 製品上でバックドアコードを追加して改竄された python ファイル\n\n\n-----\n\n###### 2024 年 3 月\n\nMustang Panda ( 標的 : 政府関連 )\n\n日本を含むアジア諸国の外交 、 政府関連を狙ったスピアフィッシング攻撃キャンペーンが観測されました 。 観測\n\nされた 1 つのファイルは 「Talking_Points_for_China.zip」 です 。Zip ファイルには 、\n\nTalking_Points_for_China.exe と KeyScramblerIE.DLL が含まれており 、\n\nTalking_Points_for_China.exe を実行すると 、KeyScramblerIE.DLL がロードされて DLL に含まれる\n\nシェルコードが実行され 、103.27.109[.]157 TCP/443 と通信を行い 、 更なるペイロードのダウンロード\n\nを試みます 。\n\n\n図11 . Talking_Points_for_China.zipに含まれるファイル\n\n\n-----\n\n## 新しい TTPs や RAT など\n\nここでは 、 先に引用させて頂いた公開されている調査報告ではまだ触れられていない観測や分析を中心に 、 少\n\nし詳しく紹介します 。\n\n###### Mustang Panda (PUBLOAD)\n\n攻撃キャンペーンの概要\n\n2022 年頃から観測されている Mustang Panda の日本を含むアジア諸国の外交 、 政府関連を狙ったスピア\n\nフィッシング攻撃キャンペーンの 2024 年 3 月に観測された PUBLOAD 検体について記載します 。スピアフィッ\n\nシングメールに添付の 「Talking_Points_for_China.zip」 に含まれる Talking_Points_for_China.exe と\n\nKeyScramblerIE.DLL ですが 、DLL ファイルにはシステム属性と隠し属性が設定されており 、 通常の表示設\n\n定では見ることができません 。\n\nTalking_Points_for_China.exe をユーザが実行すると 、KeyScramblerIE.DLL がロードされて 、\n\nC:\\Users\\\\Public\\Libraries\\SmileTV フォルダにこの 2 つの EXE と DLL ファイルがコピーされます 。\n\nKeyScramblerIE.DLL のエクスポート関数 「KSInit」 にマルウェア由来のコードが含まれており 、\n\nHKYE_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run に\n\n\"KeyScrambler\" を追加して 、 コピーした EXE ファイルの自動起動エントリーが作成されます 。\n\n\n図12 . PUBLOAD の ChooseColorW() によるシェルコード実行\n\n\n-----\n\nDLL ファイルに埋め込まれているエンコードされたシェルコード文字列は 、 これと別に用意された文字列の\n\nテーブルを使って XOR でデコードされ 、ChooseColowrW() のハンドラ関数として登録し起動されます 。 シェ\n\nルコードは E9 のジャンプ命令で 2 回ジャンプを経て実際のコードが開始される作りになっており 、 処理の最初\n\nに ror13AddHash32 のハッシュ値を使い Win32 API のアドレスをロードします 。\n\n\n図13 . PUBLOAD のシェルコード\n\n\nシェルコードの処理は 103.27.109[.]157 TCP/443 と通信を行い 、2nd Stage のシェルコードをダ\n\nウンロードして実行する作りになっています 。 通信プロトコルはこれまで報告されているもの [18] と同じ鍵と\n\nRC4 で通信データを暗号化します 。\n\nデータフォーマット : 17 03 03 + Length (2byte) + RC4 Encrypted data\n\n18 https://www trendmicro com/ja jp/research/23/e/earth preta updated stealthy strategies html\n\n\n-----\n\n鍵 :0x785a124d751414116c0271155a7305087014653b644222232000000000000000\n\n\n図14 . RC4 で暗号化された通信データ\n\n\nまた 、 観測された 2nd Stage のシェルコードは DLL から展開されるシェルコードと同じ宛先に同じプロト\n\nコルで通信するもので 、11 個の遠隔操作命令を持っています 。 今回分析したペイロードもこれまで報告されて\n\nいるもの [19] と同様と思われます 。\n\n\n表 2. PUBLOAD 2nd Stage ペイロードの遠隔操作命令\n\n\n19 https://lab52 io/blog/1943 2/\n\n\n-----\n\nMustang Panda 攻撃グループは 、103.27.109[.]157 を C2 サーバのアドレスとしてしばらく攻撃を継\n\n続していると思われ 、 いくつかの関連ファイルがパブリックマルウェアリポジトリにアップロードされています 。\n\nそのうちの 1 つ 「Proposed List of China Philippines Maritime Cooperation Projects.zip」 ファ\n\nイルに含まれる PUBLOAD の DLL ファイルはアンチウィルスマルウェアでの検出が非常に悪いものと思われま\n\nす 。\n\n\n図15 . 103.27.109[.]157と関連のあるマルウェア\n\n\n「Proposed List of China Philippines Maritime Cooperation Projects.zip」 ファイルに含まれる\n\nPUBLOAD の DLL ファイルをこの他の PUBLOAD マルウェアの DLL ファイルとの類似性をコード類似性分\n\n析ツール MCRIT [20] で分析をさせてみると 、 他のマルウェアと比較すると PUBLOAD と類似性があるものと結\n\n果が得られます 。 一方で静的分析を進めてみると 、 ローダ DLL としての主な処理箇所であるシェルコードを準備\n\nして実行する箇所の変更が大きく 、 アンチウイルス製品でのファイル検出が難しくなっていると思われます 。\n\n20 https://github com/danielplohmann/mcrit\n\n\n-----\n\n図16 . MCRIT での PUBLOAD DLL の類似性の分析\n\n\nPUBLOAD のコード変更ですが 、 これまでの PUBLOAD 検体に見られるような CreateEvent() といった\n\n関数や XOR でのデコード処理が無くなっています 。 エンコードされたシェルコードをデコードする処理は 、 ユ\n\nニークなものになりメモリのスタックにコピーした様々な動物や植物などの文字列を検索マーカとして 0x28 バ\n\nイト先のオフセットにあるバイトを繰り返しコピーしてシェルコードを生成するような作りになっています 。 生\n\n成されたシェルコードは EnumPropsExW() 関数に登録されて実行されます 。 また 、 ここで生成されるシェル\n\nコードの作りと通信先に変更はありません 。\n\n\n-----\n\n図17 . シェルコードの生成ルーチン\n\n\n図18 . シェルコードの実行関数 EnumPropsExW()\n\n\nメモリ上で実行されるシェルコードに変更はないため 、 メモリスキャナーで検出が有効と思われますが 、 注意\n\nが必要です 。EnumPropsExW() 関数に登録されたコールバック関数はメモリの実行領域に置かずに実行する事\n\nが可能と思われ 、 パフォーマンスや過検出を考慮して実行領域を中心にメモリをスキャンするツールでは 、 シェ\n\nルコードのあるメモリセグメントがスキャン対象外となって検出が迂回される可能性があります 。 一方 、2nd\n\nStage のシェルコードがダウンロードされた場合は 、VirtualProtect() 関数でメモリの実行領域に置かれた\n\n2nd Stage シェルコードが実行されるため 、 実行領域を中心にスキャンを行うツールでも検出が行えます 。\n\n\n-----\n\n図19 . 非実行領域のメモリセグメントに展開されて実行される PUBLOAD シェルコード\n\n\nMustang Panda 攻撃キャンペーンの特徴と検出\n\nMustang Panda の日本を含むアジア諸国の外交 、 政府関連を狙ったスピアフィッシング攻撃キャンペーン\n\nでは多くの国に同じ攻撃が展開されていると思われ 、 オープンソースのインテリジェンスをベースとした攻撃の\n\n特徴に気を付けメールの添付ファイルをむやみに実行しないような注意が必要です 。 攻撃が実行されてしまった\n\n場合 、 メモリ上のシェルコードの検出がツールによっては難しいケースがある事にご注意ください 。 ネットワー\n\nクの IOC や EDR ツールで遠隔操作コマンドの実行を振舞で検出する事は容易かと思われます 。\n\n\n-----\n\nPUBLOAD のシェルコードを検出する YARA ルール\n\n\nrule MNC_APT_2024_PUBLOAD_Shell\n\n{\n\nstrings:\n\n$hx1 = { 89 4D F4 8B 55 F8 8A 84 15 EC FE FF FF 88 45 FF 8B 4D F8 8B 55 F4 8A 84 15 EC FE FF FF 88 84 0D EC FE FF FF 8B 4D\n\nF4 8A 55 FF 88 94 0D EC FE FF FF 8B 45 F8 0F B6 8C 05 EC FE FF FF 8B 55 F4 0F B6 84 15 EC FE FF FF 03 C8 89 4D EC 8B 4D 08 03 4D\n\nF0 0F B6 09 8B 45 EC 33 D2 BE 00 01 00 00 F7 F6 0F B6 94 15 EC FE FF FF 33 CA 88 4D FE 8B 45 08 03 45 F0 8A 4D FE 88 08 }\n\n$hx2 = { 55 8B EC 83 EC 0C 83 7D 0C 00 7F 07 C7 45 0C 01 00 00 00 C7 45 F8 00 00 00 00 EB 09 8B 45 F8 83 C0 01 89 45 F8 81 7D\n\nF8 00 01 00 00 7D 0D 8B 4D 10 03 4D F8 8A 55 F8 88 11 EB E1 C7 45 F4 00 00 00 00 C7 45 F8 00 00 00 00 EB 09 8B 45 F8 83 C0 01 89 45\n\nF8 81 7D F8 00 01 00 00 7D 57 8B 45 F8 99 F7 7D 0C 8B 4D 08 0F B6 14 11 8B 45 10 03 45 F8 0F B6 08 03 55 F4 03 CA 81 E1 FF 00 00 80\n\n79 08 49 81 C9 00 FF FF FF 41 89 4D F4 8B 55 10 03 55 F8 8A 02 88 45 FF 8B 4D 10 03 4D F8 8B 55 10 03 55 F4 8A 02 88 01 8B 4D 10 03\n\n4D F4 8A 55 FF 88 11 EB 97 83 C8 FF 8B E5 5D }\n\ncondition:\n\nall of them\n\n}\n\n\n図20 . JPCERT YAMA [21] を使った感染プロセスの検出\n\n\n21 https://blogs jpcert or jp/ja/2023/08/yama html\n\n\n-----\n\n###### Mustang Panda ( 東南アジア圏で観測された PlugDisk による攻撃 )\n\n攻撃キャンペーンの概要\n\n2023 年 6 月 、 国内製造業のベトナム拠点の PC が中国を拠点とした攻撃グループが使う遠隔操作マルウェア\n\nの 1 つである PlugX に USB リムーバブルメディアから感染した事を観測しました 。 感染機器からは PlugX の\n\n暗号化ファイルを入手することができませんでしたが 、 パブリックマルウェアリポジトリから同じ名称のファイ\n\nルを 2 つ入手し分析しました 。 その結果 、 ローダの構造と通信先が Mustang Panda のものと一致しており 、\n\n攻撃の主体者が Mustang Panda である可能性が高いと考えています 。TeamT5 は 、 この USB 感染機能を\n\n持つ PlugX を ”PlugDisk” と呼称しています [22]。\n\n感染フロー\n\nUSB 内にあるショートカットファイルを実行すると 、USB の別フォルダに保存されている PlugDisk 関連の\n\nファイルが実行されます 。\n\n\n図21 . USB に保存されているショートカットファイル\n\n\nショートカットファイルを実行すると 、USB 内にある Docusment\\1\\1.exe が実行されます 。1.exe は 、\n\nAdobe 社の正規ファイル AdobePhots.exe をリネームしたもので 、同じ場所にある Adobe_Caps.dll がロー\n\nドされて PlugDisk の暗号化ファイル AdobeDb.dat が読み込まれてメモリ上で PlugDisk が復号 ・ 実行され\n\nます 。\n\n22 https://jsac jpcert or jp/archive/2023/pdf/JSAC2023 2 LT4 pdf\n\n\n-----\n\n図22 . ショートカットファイルに設定されているコマンド\n\n\nまた 、USB 内のフォルダにはシステム属性と隠し属性が設定されており 、Windows OS の初期設定では表\n\n示されないようになっています 。 それらのフォルダとファイルは 、FTK Imager などのフォレンジックツールを\n\n使い確認することができます 。\n\n\n図23 . システム属性 、隠し属性のファイル表示を有効にした状態\n\n\n図24 . FTK Imager で表示した USB 内のファイル\n\n\n-----\n\nUSB から実行された PlugDisk は設定に従い 、感染端末上の特定の場所に PlugDisk 関連のファイルをコピー\n\nし 、 パーシステンスのための Run レジストリキーを追加します 。\n\n\n図25 . 感染機器に設置された PlugDisk 関連のファイル\n\n\nその後 、 コピーしたファイルを実行した後に自身は終了します 。PlugDisk の処理は起動したファイルの方で\n\n引き継ぐ形となり 、PlugDisk 本体のコードは Microsoft 社の正規実行ファイル tasklist.exe にインジェク\n\nションされて動作します 。 インジェクションされた tasklist.exe には 、 通常存在しない 4 つの起動パラメータ\n\n( 今回の例では 、646, 345, 173, 242) が付与されています 。\n\n\n図26 . PlugDisk 本体のコードがインジェクションされたtasklist.exe\n\n\n-----\n\n###### PlugDisk 詳細解析\n\n 感染機器からは 、 暗号化ファイル Adobedb.dat を入手できていませんが 、 パブリックマルウェアリポ\n\n ジトリから入手した\n\n Adobedb.dat(SHA256:b3caefb141bc47c702e71f773ed246bb9f905a222840365f\n\n 2d6e432218605fd5) が起動時に付与するパラメータの形式や 、 インジェクション 、USB に生成す\n\n るファイル名などの振る舞いが同じであることから 、 同じタイプの PlugDisk が使われたと考えています\n\n 。 本レポートではこの暗号化ファイルを使った分析結果について記載します 。\n\n PlugDisk ローダの Adobe_Caps.dll には 、 暗号化ファイルの名称が固定で埋め込まれています 。\n\n\n図27 . PlugX ローダが読み込む暗号化ファイル名\n\n\n###### また 、 ローダと PlugDisk 本体は解析を阻害するために Control Flow Flattening (CFF) [23]によって\n\n 処理フローが難読化されています 。\n\n23 https://news sophos com/ja jp/2022/05/04/attacking emotets control flow flattening jp/\n\n\n-----\n\n図28 . Control Flow Flattening によって処理フローが難読化されたコード\n\n\n###### PlugDisk の暗号化ファイルはマルチバイトの鍵で XOR されており 、 その鍵はファイル先頭から 0x00\n\n (NULL バイト ) までのバイト列です 。\n\n\n-----\n\n図29 . PlugX 暗号化ファイルの鍵\n\n\nPlugX の設定情報は 、PlugX の .data セクションの先頭から 0xDDB バイトの領域で 、 暗号化ファイルを復\n\n号する鍵とは異なる鍵 ”123456789” を使い XOR でエンコードされています 。\n\n\n図30 . PlugX の設定情報\n\n\n暗号化ファイルから PlugX と設定情報を抽出する Python スクリプトを以下に記載します 。\n\n\n-----\n\n-----\n\ncurrent_key = key[loop_condition % klen]\ndecoded.append(c ^ current_key)\nloop_condition += 1\n\nelse:\ndecoded=config\ns = \"\"\nConfigItems=[]\n\ndecoded = decoded[0x20:]\ngetUTF16LE_ConfigItem(decoded[0x00:0x80], ConfigItems)\ngetUTF16LE_ConfigItem(decoded[0x80:0x80+0x80], ConfigItems)\ngetUTF16LE_ConfigItem(decoded[0x100:0x100+0x288], ConfigItems)\ngetUTF16LE_ConfigItem(decoded[0x388:0x388+0x208], ConfigItems)\ngetUTF16LE_ConfigItem(decoded[0x590:0x590+0x208], ConfigItems)\n\n# C2 1\nc2_base_addr = 0x798\nflag = decoded[c2_base_addr+1] << 8 ¦ decoded[c2_base_addr]\nConfigItems.append(str(flag))\nport = decoded[c2_base_addr+3] << 8 ¦ decoded[c2_base_addr+2]\nConfigItems.append(str(port))\ngetASCII_ConfigItem(decoded[c2_base_addr+4:c2_base_addr+4+0xC0], ConfigItems)\n# C2 2\nc2_base_addr = 0x85C\nflag = decoded[c2_base_addr+1] << 8 ¦ decoded[c2_base_addr]\nConfigItems.append(str(flag))\nport = decoded[c2_base_addr+3] << 8 ¦ decoded[c2_base_addr+2]\nConfigItems.append(str(port))\ngetASCII_ConfigItem(decoded[c2_base_addr+4:c2_base_addr+4+0xC0], ConfigItems)\n# C2 3\nc2_base_addr = 0x920\nflag = decoded[c2_base_addr+1] << 8 ¦ decoded[c2_base_addr]\nConfigItems.append(str(flag))\nport = decoded[c2_base_addr+3] << 8 ¦ decoded[c2_base_addr+2]\nConfigItems.append(str(port))\ngetASCII_ConfigItem(decoded[c2_base_addr+4:c2_base_addr+4+0xC0], ConfigItems)\n# C2 4\nc2_base_addr = 0x9E4\nflag = decoded[c2_base_addr+1] << 8 ¦ decoded[c2_base_addr]\nConfigItems.append(str(flag))\nport = decoded[c2_base_addr+3] << 8 ¦ decoded[c2_base_addr+2]\nConfigItems.append(str(port))\ngetASCII_ConfigItem(decoded[c2_base_addr+4:c2_base_addr+4+0xC0], ConfigItems)\n\nreturn ConfigItems\n\ndef main():\nparser = argparse.ArgumentParser(\nformatter_class=argparse.RawDescriptionHelpFormatter,\ndescription=\"\",\n)\nparser.add_argument(\"-f\", \"--file\", help=\"PlugX Loader File\")\n\nargs = parser.parse_args()\n\nif args.file:\ntry:\nloaderDecode(args.file)\ndata = getData(\"PlugX_Loader_Decoded.exe\")\nwith open(\"PlugX_Loader_Decoded.exe\", 'rb') as f:\nf.read(data)\ntodecode = f.read(0xDD8)\nconfig=configDecode(todecode)\nprint(\"Extracted Configuration Items\")\nfor c in config:\nprint(c)\nexcept:\nprint(\"Something didn't work right, ensure this is a PlugX Loader file and \"\n\"that the correct arguments were passed\")\n\nif __name__ == \"__main__\":\nmain()\n\n\n-----\n\n###### PlugDisk は DLL ファイルの形態で 、 その MZ ヘッダー先頭部がシェルコードになっています 。 そのシェ\n\n ルコードを系由してエクスポート関数 「StartProtect」 が呼ばれメイン処理に移ります 。\n\n\n図31 . PlugX MZ ヘッダーに埋め込まれているシェルコード\n\n\n###### PlugDisk は感染機器上に USB デバイスが接続されていないかをモニターし 、 接続を確認すると USB に\n\n PlugDisk の関連ファイルをコピーし 、USB にショートカットファイルを作成します 。 また接続した USB\n\n ファイルに元々保存されていたファイルは 、USB 内部の別フォルダに移動させて見えなくし 、USB の保有\n\n 者にショートカットファイルを実行させるよう誘導しています 。 ショートカットファイルを実行すると 、\n\n PlugDisk の実行と合わせて元々保存されていたファイルの移動先を表示させて疑いを持たせづらくして\n\n います 。\n\n\n図32 . PlugDisk USB 感染処理\n\n\n-----\n\n###### PlugDisk USB を介した感染の考察\n\n 弊社が分析したケースでは 、PlugDisk に感染した USB が最初にどのようにして持ち込まれたかを特定\n\n することはできませんでした 。 セキュリティベンダー Mandiant 社の調査では 、 地域のプリントショップ\n\n やホテルの USB を接続できる機器が感染源である可能性があることと USB 経由で PlugDisk に感染させる\n\n キャンペーンは 、 国の支援を受けた攻撃グループが関心のあるエリアで長期間の対象を選ばない諜報もし\n\n くは活動後期の追加情報を得ることが目的ではないかという見解を公開しています [24]。\n\n 本ケースも 2021 年には存在が観測されている比較的古いローダが使われていることと拡大手法から無差\n\n 別の情報収集を目的としたキャンペーンでたまたま着弾したのではないかとみています 。\n\n 弊社は USB による感染を 2022 年から国内企業の東南アジア拠点で複数観測しています [25]。 特に製造業で\n\n は業務で USB を使うケースが多くあるため 、 引き続き USB 系由での攻撃は続くとみています 。 また\n\n 2023 年 12 月に脅威リサーチャーによってローダが Nim 言語で開発された USB 系由で感染する\n\n PlugDisk も確認されています [26]。\n\n\n24\n\n25\n\n26\n\n\nhttps://www.mandiant.com/resources/blog/infected-usb-steal-secrets\n\nhttps://www.virusbulletin.com/conference/vb2023/abstracts/usb-flows-great-river-classic-tradecraft-still-alive/\n\nh // /M lG 12/ /1735641623206277356\n\n\n-----\n\n###### Ivanti 製品の脆弱性を悪用した攻撃キャンペーン\n\n攻撃キャンペーンの概要\n\n2024 年 1 月から 2 月にかけて公開された Ivanti Connect Secure、Ivanti Policy Secure ゲートウェ\n\nイの複数の脆弱性は日本を含め世界中の組織に大きな影響を与えました 。 脆弱性の公開に続いてかなり早いタイ\n\nミングで PoC が公開されたことから特定の組織を狙った攻撃だけでなく手当たり次第に多くの組織を狙った攻撃\n\nでも悪用され 、 弊社でも改竄 ・ 設置された多くのファイルを分析しました 。 本章では我々の分析からみえた傾向\n\nと本レポート執筆時点で情報が公開されていないバックドアについて解説します 。\n\n国内で観測された悪用事例\n\n認証バイパス （CVE-2023-46805） とコマンドインジェクション （CVE-2024-21887） を悪用した攻撃\n\nの多くで WIREFIRE と命名された Web Shell が見つかりました 。 一方で ZIPLINE と命名された accept 関\n\n数をハイジャックするバックドアは WIREFIRE が見つかった一部の機器で見つかりました 。 ファイルのタイム\n\nスタンプも考慮すると 、WIREFIRE を使い情報を収集し更なる活動を行うことを決めた組織においてのみ\n\nZIPLINE を設置していた可能性があると考えています 。 我々の観測範囲では数は少ないですが 、Web ログオン\n\n中に入力した認証情報を別サーバに送信する WARPWIRE と LIGHTWIRE Web Shell の亜種を観測していま\n\nす 。 また 、 サーバーサイド・リクエスト・フォージェリ （SSRF）（CVE-2024-21893） を悪用した攻撃では 、\n\nDSLog backdoor [27] が設置されたケースを複数確認しました 。 悪用された脆弱性は不明ですが 、 オープンソー\n\nス C2 フレームワークの Sliver が設置されたケースも確認しています 。\n\n\n図33 . 脆弱性・PoC 公開と弊社で攻撃を確認した時期\n\n\n27 https://www orangecyberdefense com/uk/blog/research/ivanti connect secure journey to the core of the dslog backdoor\n\n\n-----\n\nパッシブバックドア ProxDoor\n\n弊社の分析の中で ZIPLINE [28]、SPAWNMOLE [29] とは異なるパッシブバックドアを発見し 、”ProxDoor”\n\nと命名しました 。ProxDoor は ELF 形式の共有ライブラリファイルで 、 ファイル名 ”librs.so.1” として設置\n\nされており 、 別の改竄された libnspr4.so によりロードされます 。libnspr4.so は 、/home/bin/web プロ\n\nセスが使用しており web プロセスがロードした accept, accept4 関数のアドレスが ProxDoor の関数のア\n\nドレスに書き換えられ 、accept 処理が ProxDoor にハイジャックされます 。\n\n###### sccept\n\n accept4\n accept\n\n accept\n\n libnspr4.so librs.so.1\n\n libnspr4.so を\n\n ロードするプロセス\n\n\n図34 . ProxDoor によりaccept 処理がハイジャックされる処理フロー\n\n\n###### libspr4.so の _init_proc 関数の中には librs.so.1 をロードする処理が追加されていました 。\n\n\n図35 . libnspr4.so に追加されたlibrs.so.1 (ProxDoor)をロードする処理\n\n\n28 https://www.mandiant.jp/resources/blog/suspected-apt-targets-ivanti-zero-day\n\n\n-----\n\n###### ProxDoor は 、 受信したデータの先頭からオフセット 0x0F 以降から 4 バイト単位のデータで XOR を行\n\n い 、 その値がオフセット 0xB からの 4 バイトと一致するかをチェックします 。 一致した場合は命令コマン\n\n ドと判断し 、RC4 で復号します 。\n\n\nunsigned __int32 __cdecl aa_decrypt_data(const void *buf)\n\n{\n\nint pos; // eax\n\nint chk_val; // edx\n\n_BYTE recv[118]; // [esp+Ah] [ebp-18Eh] BYREF\n\nchar sbox_[280]; // [esp+80h] [ebp-118h] BYREF\n\npos = 0;\n\nchk_val = 0;\n\nmemset(sbox_, 0, 256u);\n\nqmemcpy(recv, buf, sizeof(recv));\n\ndo\n\nchk_val ^= *&recv[4 * pos++ + 0xF];\n\nwhile ( pos != 6 );\n\nif ( chk_val != *&recv[0xB] )\n\nreturn -1;\n\nmake_sbox(sbox_, &recv[15], 24u);\n\naa_rc4_(sbox_, &recv[39], 4);\n\nreturn _byteswap_ulong(*&recv[39]);\n\n}\n\n\n図36 . 受信データが命令コマンドであるかの判定処理\n\n\n###### ProxDoor でサポートしている命令コマンドは 、2 つのみでシンプルな作りですが 、 受信データにはコマ\n\n ンド ID 以外に受信データを別 IP、 ポート番号への転送を行うフラグも含まれています 。 コマンド ID は 1 バ\n\n イトデータに対して上位 4bit、 下位 4bit から抽出します 。\n\n\n図37 . コマンド ID 抽出処理\n\n\n-----\n\n表 3. ProxDoor サポートコマンド\n\n\n-----\n\n## 攻撃グループごとの TTPs ( 戦術、技術、手順 )\n\n2023 年度に弊社で観測した攻撃グループごとの TTPs と標的組織を表で大まかに整理します 。MITRE 社\n\nATT&CK に攻撃フレームワークの攻撃番号を記載しますので 、 利用している製品での検出有無などをご確認く\n\nださい 。\n\n※ この表は 、MITRE 社 ATT&CK 攻撃フレームワーク version 15 [30] に基づき作成しています 。\n\n攻撃グループ 攻撃の T TPs 標的組織\n\nTropic Trooper **侵入経路：スピアフィッシングメール** 添付ファイル (Office マクロ、アイコン偽装の 国内製造関連企業\n\n実行ファイル )、Wi-Fi アクセスポイントの悪用 ( 悪魔の双子攻撃 ) 中国拠点\n\n**エクスプロイト：N/A**\n\n**利用するツール・マルウェア：**\n\nEntryShell RAT / Cobalt Strike Beacon / CrowDoor\n\n**C2 通信の特徴：**\n\n業務上あまり使われないポート番号宛の TCP 通信 (4431 8443 など )\n\n**ATT&CK：**\n\n[Initial Access]\n\nPhishing: Spear phishing via Service (T1566.003)\n\n[Execution]\n\nCommand and Scripting Interpreter: Visual Basic (T1059.005)\n\nProcess Injection: Asynchronous Procedure Call (T1055.004)\n\n[Privilege Escalation]\n\nAccess Token Manipulation (T1134)\n\n[Persistence]\n\nHijack Execution Flow: DLL Side-Loading (T1574.002)\n\n[Command and Control]\n\nNon-Standard Port (T1571)\n\nEncrypted Channel: Symmetric Cryptography (1573.001)\n\nMustang Panda **侵入経路：スピアフィッシングメール** 添付ファイル (zip ファイルに EXE ファイルと\n\n隠し DLL ファイル )、USB\n\n**エクスプロイト：N/A**\n\n**利用するツール・マルウェア：**\n\nPUBLOAD Claimloader / PlugDisk\n\n**C2 通信の特徴：**\n\nRC4 暗号通信\n\n**ATT&CK：**\n\n[Initial Access] Phishing: Spearphishing Attachment (T1566.001)\n\n[Initial Access] Replication Through Removable Media (T1091)\n\n[Persistence] Boot or Logon Autostart Execution: Registry Run Keys /\n\nStartup Folder (T1547.001)\n\n[ D e f e n s e E v a s i o n ] H i j a c k E x e c u t i o n F l o w : D L L S i d e - L o a d i n g\n\n(T1574002)\n\n30 https://attack mitre org/versions/v15/\n\n\n-----\n\n-----\n\n## TTPs より考察する脅威の検出と緩和策\n\nマルウェアの配送 ・ 攻撃について\n\n2023 年度は様々なベンダーの外部公開デバイスの脆弱性攻撃からの侵入が観測されています 。 これらにはゼ\n\nロデイ脆弱性攻撃も多くありますが 、 アプライアンス製品のため侵入を早期に検出するためのセキュリティ対策\n\nソフトウェアなどを導入する事ができません 。 標的型攻撃を行う攻撃グループによって 、 ベンダーが提供する外\n\n部公開デバイス製品のゼロデイ脆弱性が発見 ・ 攻撃される事は今後も継続すると思われ 、 この前提での対策を検\n\n討すべきかと思われます 。 外部公開デバイスのゼロデイ脆弱性の対策の 1 つとして 、 これらのアプライアンス製\n\n品の前後にファイアウォールを設置して 、 攻撃を受けた後に発生する外向きのダウンロードなどの通信や内向き\n\nの RDP SMB SSH などの通信をログのモニタリングから検出する事がセキュリティリサーチャーにより共有さ\n\nれており [31]、 有効と思われます 。 また 、 外部公開デバイスのゼロデイ脆弱性攻撃がベンダーから報告があった際 、\n\n海外拠点なども含めて External Attack Surface Management でデバイスの有無やパッチバージョンを把\n\n握して早期の対処を検討頂くと良いかと思われます 。 その他に 、 物理的な侵入が増加している傾向があり 、USB\n\nデバイスや Wi-Fi アクセスポイントの悪用からの物理的な侵入もある前提で 、 レガシーな対策ですが 、 デバイス\n\nコントロールといった対策や Wi-Fi 製品の機能で不審なアクセスポイントが設置されていないかといった事を確\n\n認するような対策もご検討ください 。 これら機器の出力するログもベンダーのベストプラクティスに従い 、 想定\n\nされる攻撃時のログを出力するように設定した上で 、 別の SIEM 装置やログ基盤に転送しておく事が望ましいと\n\n思われます 。 攻撃者はこれら装置上のログを削除する事が多くあり 、 またログ基盤に転送して検出ルールと照合\n\nする事で不正アクセスの検出を行い 、 事後にはフォレンジック調査に役立てる事ができます 。\n\nインストールされる RAT、 遠隔操作 (C2 サーバについて )\n\nLODEINFO、PUBLOAD、PlugX などいずれも DLL サイドローディングで 、暗号化されたペイロードをロー\n\nダ DLL が復号してメモリに展開して実行する手法が多く見られます 。 実行中のプロセスをスキャンしてメモリ上\n\nの RAT の特徴的なコードをファストフォレンジックツールで検出する事や 、 通常とは異なるパスに正規実行ファ\n\nイルが保存されて実行されるといった振る舞いを EDR 製品で検出することは現在ではそれほど難しくないと思\n\nわれます 。 一方 、Stowaway のような GitHub 上で公開されたツールや Visual Studio Code の Remote\n\n機能の悪用など 、 遠隔操作が開始された後の遠隔コマンドなどを EDR で検出しないと検出が難しいと思われる\n\nようなケースも散見されます 。XDR と一括り対策の中でも基本的な EDR の対策を端末 ・ サーバに網羅的に展開\n\nする事が重要です 。 また 、 正規の脆弱性のあるカーネルドライバを悪用して EDR 製品のモニタリングを無効に\n\nするような Bring Your Own Vulnerable Driver（BYOVD） [32] 攻撃もしばしば聞かれるようになっていま\n\nす 。 この攻撃の結果想定される挙動として 、 モニタリング対象の端末やサーバから EDR のログがあがっていな\n\nいなどの兆候にご注意ください 。 また 、EDR 製品によってはこの攻撃自体を検出して検出アラートを上げるもの\n\nもあります 。\n\n31 https://twitter.com/58_158_177_102/status/1756154654256492884/\n\n\n-----\n\n## 検知のインディケータ\n\nTropic Trooper\n\nインディケータ\n\n98af7888655b8bcac49b76c074fc08877807ac074fb4e81a6cacfd1566d52f12\n\n9dff4c8f403338875d009508c64a0e4d4a5eeac191d7654a7793c823fb8e3018\n\n8937e8dd520dc6555c5b2cd62897b8eb5352e43a12af488bd8594449ed114fd5\n\nblog[.]techmersion[.]com\n\nAPT10 (LODEINFO)\n\nインディケータ\n\n7a4fd1cc932b96175055b2940242877cab728a9d7c7ee371cad8438b4e88a812\n\n632975a3642b0f2a6084880e59ffa19dfa8b08d13ac15b639e1e0ad3bdbf45bd\n\nhttp[:]//185.126.236[.]166\n\nhttp[:]//198.13.33[.]117\n\nf21745cc6306461d1ddb3c35ed6016468ce984bbd64bfb86139a392e3a45c495\n\necc746323a432bf483b6b1fff342ebe1834f8271d4cdf81b4f81d0a13e89436e\n\n29bfd90bc23928e9180bd30223dd7f447af1f0f0121386c239f0c0e0c0bc0482\n\nhttp[:]//167.179.77[.]72\n\nhttp[:]//167.179.106[.]224\n\nMustang Panda\n\n\n-----\n\nOthers\n\n\n-----\n\nマクニカは 、1972 年の設立以来 、 最先端の半導体 、 電子デバイス 、 ネットワーク 、 サイバー\n\nセキュリティ商品に技術的付加価値を加えて提供してきました 。 従来からの強みであるグローバ\n\nルにおける最先端テクノロジーのソーシング力と技術企画力をベースに 、AI/IoT、 自動運転 、\n\nロボットなどの分野で新たなビジネスを展開しています 。 その中でセキュリティにおいては 、 最\n\n先端のセキュリティ商材を提供する中で独自の研究機関を有し 、 日本の企業に着弾したサイバー\n\n攻撃や対策をリサーチしています 。\n\n・本資料に記載されている会社名、商品、サービス名等は各社の登録商標または商標です。なお、本資料中では、「™」、「®」は明記しておりません。 ・本資料は、出典元が記載されている\n\n資料、画像等を除き、弊社が著作権を有しています。 ・著作権法上認められた「私的利用のための複製」や「引用」などの場合を除き、本資料の全部または一部について、無断で複製・転用\n\n等することを禁じます。 ・本資料は作成日現在における情報を元に作成されておりますが、その正確性、完全性を保証するものではありません。\n\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.macnica.co.jp/business/security/security-reports/pdf/cyberespionage_report_2023.pdf"
    ],
    "report_names": [
        "cyberespionage_report_2023.pdf"
    ],
    "threat_actors": [
        {
            "id": "f67fb5b3-b0d4-484c-943e-ebf12251eff6",
            "created_at": "2022-10-25T16:07:23.605611Z",
            "updated_at": "2025-03-27T02:02:09.884272Z",
            "deleted_at": null,
            "main_name": "FamousSparrow",
            "aliases": [
                "Earth Estries"
            ],
            "source_name": "ETDA:FamousSparrow",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b2e48aa5-0dea-4145-a7e5-9a0f39d786d8",
            "created_at": "2024-01-18T02:02:34.643994Z",
            "updated_at": "2025-03-27T02:02:10.19518Z",
            "deleted_at": null,
            "main_name": "UNC5221",
            "aliases": [
                "UNC5221",
                "UTA0178"
            ],
            "source_name": "ETDA:UNC5221",
            "tools": [
                "GIFTEDVISITOR",
                "GLASSTOKEN",
                "LIGHTWIRE",
                "PySoxy",
                "THINSPOOL",
                "WARPWIRE",
                "WIREFIRE",
                "ZIPLINE"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6ce34ba9-7321-4caa-87be-36fa99dfe9c9",
            "created_at": "2024-01-12T02:00:04.33082Z",
            "updated_at": "2025-03-27T02:00:03.283512Z",
            "deleted_at": null,
            "main_name": "UTA0178",
            "aliases": [
                "UNC5221",
                "Red Dev 61"
            ],
            "source_name": "MISPGALAXY:UTA0178",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "93542ae8-73cb-482b-90a3-445a20663f15",
            "created_at": "2022-10-25T16:07:24.058412Z",
            "updated_at": "2025-03-27T02:02:10.093621Z",
            "deleted_at": null,
            "main_name": "PKPLUG",
            "aliases": [
                "Stately Taurus"
            ],
            "source_name": "ETDA:PKPLUG",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a2c3c22a-b3db-4d4a-9a5a-76bfe6171843",
            "created_at": "2023-11-21T02:00:07.315543Z",
            "updated_at": "2025-03-27T02:00:03.237322Z",
            "deleted_at": null,
            "main_name": "UNC4841",
            "aliases": [
                "SLIME57"
            ],
            "source_name": "MISPGALAXY:UNC4841",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f0eca237-f191-448f-87d1-5d6b3651cbff",
            "created_at": "2024-02-06T02:00:04.140087Z",
            "updated_at": "2025-03-27T02:00:03.323578Z",
            "deleted_at": null,
            "main_name": "GhostEmperor",
            "aliases": [
                "FamousSparrow",
                "UNC2286",
                "Salt Typhoon",
                "RedMike"
            ],
            "source_name": "MISPGALAXY:GhostEmperor",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f74e4fe6-6281-45e7-8866-0ff4316381cc",
            "created_at": "2024-05-01T02:03:07.959101Z",
            "updated_at": "2025-03-27T02:05:17.270819Z",
            "deleted_at": null,
            "main_name": "BRONZE HOBART",
            "aliases": [
                "Pirate Panda ",
                "Tropic Trooper ",
                "KeyBoy "
            ],
            "source_name": "Secureworks:BRONZE HOBART",
            "tools": [
                " KeyBoy",
                " Pfine",
                "DSNGInstaller"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "61ea51ed-a419-4b05-9241-5ab0dbba25fc",
            "created_at": "2023-01-06T13:46:38.354607Z",
            "updated_at": "2025-03-27T02:00:02.81258Z",
            "deleted_at": null,
            "main_name": "APT23",
            "aliases": [
                "KeyBoy",
                "Tropic Trooper",
                "BRONZE HOBART",
                "G0081",
                "Red Orthrus",
                "Earth Centaur",
                "PIRATE PANDA"
            ],
            "source_name": "MISPGALAXY:APT23",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9baa7519-772a-4862-b412-6f0463691b89",
            "created_at": "2022-10-25T15:50:23.354429Z",
            "updated_at": "2025-03-27T02:00:55.45162Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Mustang Panda",
                "TA416",
                "RedDelta",
                "BRONZE PRESIDENT"
            ],
            "source_name": "MITRE:Mustang Panda",
            "tools": [
                "Cobalt Strike",
                "RCSession",
                "NBTscan",
                "PoisonIvy",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bef7800a-a08f-4e21-b65c-4279c851e572",
            "created_at": "2022-10-25T15:50:23.409336Z",
            "updated_at": "2025-03-27T02:00:55.463048Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "Tropic Trooper",
                "Pirate Panda",
                "KeyBoy"
            ],
            "source_name": "MITRE:Tropic Trooper",
            "tools": [
                "USBferry",
                "ShadowPad",
                "PoisonIvy",
                "BITSAdmin",
                "YAHOYAH",
                "KeyBoy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d390d62a-6e11-46e5-a16f-a88898a8e6ff",
            "created_at": "2024-12-28T02:01:54.899899Z",
            "updated_at": "2025-03-27T02:02:10.122415Z",
            "deleted_at": null,
            "main_name": "Salt Typhoon",
            "aliases": [
                "Earth Estries",
                "FamousSparrow",
                "GhostEmperor",
                "RedMike",
                "Salt Typhoon",
                "UNC2286"
            ],
            "source_name": "ETDA:Salt Typhoon",
            "tools": [
                "Agentemis",
                "Backdr-NQ",
                "Cobalt Strike",
                "CobaltStrike",
                "Crowdoor",
                "Cryptmerlin",
                "Deed RAT",
                "Demodex",
                "FamousSparrow",
                "FuxosDoor",
                "GHOSTSPIDER",
                "HemiGate",
                "MASOL RAT",
                "Mimikatz",
                "NBTscan",
                "NinjaCopy",
                "ProcDump",
                "PsExec",
                "PsList",
                "SnappyBee",
                "SparrowDoor",
                "TrillClient",
                "WinRAR",
                "Zingdoor",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "28ed64bd-f692-4fb4-b41e-cb8d0397bea6",
            "created_at": "2025-03-07T02:00:03.803851Z",
            "updated_at": "2025-03-27T02:00:03.493136Z",
            "deleted_at": null,
            "main_name": "Teleboyi",
            "aliases": [],
            "source_name": "MISPGALAXY:Teleboyi",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1721873188,
    "ts_updated_at": 1743041837,
    "ts_creation_date": 1719588407,
    "ts_modification_date": 1719588407,
    "files": {
        "pdf": "https://archive.orkl.eu/79ff34959da474bdc138cf676d41a925c1e53c95.pdf",
        "text": "https://archive.orkl.eu/79ff34959da474bdc138cf676d41a925c1e53c95.txt",
        "img": "https://archive.orkl.eu/79ff34959da474bdc138cf676d41a925c1e53c95.jpg"
    }
}