{
    "id": "61c84cd8-09be-4aa2-b0f5-c7bfa4543f34",
    "created_at": "2023-01-12T15:09:09.460366Z",
    "updated_at": "2025-03-27T02:05:22.362298Z",
    "deleted_at": null,
    "sha1_hash": "8935469321f1cdbbe46542aec6efa279b0053199",
    "title": "2022-05-05 - Analysis of MS Word to drop Remcos RAT - VBA extraction and analysis - IoCs",
    "authors": "",
    "file_creation_date": "2022-05-27T18:58:28Z",
    "file_modification_date": "2022-05-27T18:58:28Z",
    "file_size": 1642346,
    "plain_text": "# Analysis of MS Word to drop Remcos RAT\n\n**muha2xmad.github.io/mal-document/remcosdoc/**\n\n### Muhammad Hasan Ali\n\nMalware Analysis learner\n\n\nMay 5, 2022\n\n\n-----\n\n4 minute read\n\n**As-salamu Alaykum**\n\n## Introduction\n\nRemcos RATs are delivered by phishing campaigns in form of Excel file and Word file, our\nsample is word file. Which tries to trick the user to click `Enable content which will load the`\n[Macro code and then load the next stage. We start our analysis using REMnux. Download](https://remnux.org/)\n[the sample from MalwareBazaar](https://bazaar.abuse.ch/sample/3bd5892cdc82dc4576eaf2735edb57182ae8b91c8067be305d4e801197d390cc/)\n\n## About MS word\n\nWe will talk about basic structure of Word file. Microsoft suite comes in two two structures.\nBefore `2007, Microsoft used` `structured storage fromat in binary format which is`\nold format `.doc,` `.xls,` `.ppt such as from Word 97 (released in 1997) through Microsoft`\nOffice 2003. After 2007, Microsoft used `office open XML format in Zip archive containing`\nXML `.docx . For more info see` [here](https://docs.fileformat.com/word-processing/doc/)\n\n## Metadata\n\nusing exiftool to extract metadata about the sample which we are analyzing and get more\ninformation about it such as `filesize,` `filetype,` `Language Code,` `Comp Obj User`\n```\nType which shows the eddition of used Microsoft word, and Template . If there is\nNormal.dotm which is an indicator of Macro inside the Doc file.\n\n```\n\n-----\n\n```\nFile Name            :\n3bd5892cdc82dc4576eaf2735edb57182ae8b91c8067be305d4e801197d390cc.doc\nDirectory            : .\nFile Size            : 60 KiB\nFile Modification Date/Time   : 2022:05:05 05:54:50-04:00\nFile Access Date/Time      : 2022:05:05 02:14:10-04:00\nFile Inode Change Date/Time   : 2022:05:05 01:55:39-04:00\nFile Permissions        : rw-r--r-File Type            : DOC\nFile Type Extension       : doc\nMIME Type            : application/msword\nIdentification         : Word 8.0\nLanguage Code          : English (US)\nDoc Flags            : Has picture, 1Table, ExtChar\nSystem             : Windows\nWord 97             : No\nTitle              : \nSubject             : \nAuthor             : \nKeywords            : \nComments            : \nTemplate            : Normal.dotm\nLast Modified By        : \nSoftware            : Microsoft Office Word\nCreate Date           : 2022:04:20 02:06:00\nModify Date           : 2022:04:20 02:06:00\nSecurity            : None\nCode Page            : Windows Latin 1 (Western European)\nChar Count With Spaces     : 1\nApp Version           : 16.0000\nScale Crop           : No\nLinks Up To Date        : No\nShared Doc           : No\nHyperlinks Changed       : No\nTitle Of Parts         : \nHeading Pairs          : Title, 1\nComp Obj User Type Len     : 32\nComp Obj User Type       : Microsoft Word 97-2003 Document\nLast Printed          : 0000:00:00 00:00:00\nRevision Number         : 1\nTotal Edit Time         : 0\nWords              : 0\nCharacters           : 1\nPages              : 1\nParagraphs           : 1\nLines              : 1\n\n## VBA extraction and analysis\n\n```\nThen we try to see if the Doc file has a Macros using `oleid . If` `VBA Macros is set to`\n```\nTrue as we see in next figure, then yes it has Macros and the Macro is not encrypted.\n\n```\n\n-----\n\nFigure(1): oleid output\n\nThen we extract the We Then use `oledump.py to see the content of the Doc file. The`\nnumber on the left called `stream number and` `M indicated that there is Macro and code.`\n\nFigure(2): oledump.py output\n\nWe use `olevba to extract Macros from the Doc file and analyze the` `VBA code. After`\nextraction open the file in `VSCode . We can use` `oledump.py to do this as well, but`\n```\nolevba summerize the important info for us.\nolevba 3bd5892cdc82dc4576eaf2735edb57182ae8b91c8067be305d4e801197d390cc.doc\n> vbacode.vba\n\n```\nThe most important is the table which summerize the VBA code and extracts the important\ncode such as `IoCs and suspicious functions such as` `AutoOpen() .`\n\n\n-----\n\nFigure(3): Extraction of the VBA code\n\nBut this is not enough. We will try to extract much info about the Doc by using `oledump.py`\nand extract the content of all the streams but if you want to short your time extract only the\nstreams `9 and` `10 .`\n```\noledump.py\n3bd5892cdc82dc4576eaf2735edb57182ae8b91c8067be305d4e801197d390cc.doc -s 9 >\nstream_9.vba\noledump.py\n3bd5892cdc82dc4576eaf2735edb57182ae8b91c8067be305d4e801197d390cc.doc -s 10 >\nstream_10.vba\n\n```\nTake your time to analyze the `ASCII to extract more info from the next two figures. In this`\nfigure, stream 9 IoCs which enables the Doc to launch the VBA code.\n\n\n-----\n\n```\nC:\\Program files\\Common files\\Microsoft shared\\VBA\\VBA7.1\\VBE7.dll\nC:\\Windows\\System32\\stdole2.tlb\nC:\\Program files\\Microsoft Office\\root\\Office1.6\\MSWORD\nObjectLibrary\nC:\\Program files\\Common files\\Microsoft shared\\OFFICE16\\MSO.DLL\nautoOpen\nCreateObject\nInstallProduct\n\n```\nFigure(4): Analysis of the VBA code of stream 9\n\nAnd in stream `10 which has less IoCs than stream` `9 .`\n```\nC:.\\Windows.\\System32\\e2tlb\nC:\\Program files\\Common files\\Microsoft shared\\OFFICE1.6\\MSO.DLL\n\n```\n\n-----\n\nFigure(5): Analysis of the VBA code of stream 10\n\nFor more info you can use `lazy office analyzer tool in Windows or open the malicious`\nword and see the Macro inside the Microsoft word application. I tried to use it but in this\nsample gives no info.\n\n## IoCs\n\n**No.** **Description** **Hash and URLs**\n\n1 The Mal DOC file (MD5 ) 090e1dfdcbf2185788ea14cd113cc39f\n\n3 URL https://filebin.net/rf43v6qzghbj7h7b/TRY.msi\n\n## Article quote\n\nﻣﻦ ﯾﺤﻤﻞ ﻗﻨﺪﯾﻠﻪ ﻓﻲ ﺻﺪره ﻻ ﯾُﻌﻨﯿﻪ ﻇﻼم اﻟﻌﺎﻟﻤﯿﻦ\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-05 - Analysis of MS Word to drop Remcos RAT - VBA extraction and analysis - IoCs.pdf"
    ],
    "report_names": [
        "2022-05-05 - Analysis of MS Word to drop Remcos RAT - VBA extraction and analysis - IoCs.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536149,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1653677908,
    "ts_modification_date": 1653677908,
    "files": {
        "pdf": "https://archive.orkl.eu/8935469321f1cdbbe46542aec6efa279b0053199.pdf",
        "text": "https://archive.orkl.eu/8935469321f1cdbbe46542aec6efa279b0053199.txt",
        "img": "https://archive.orkl.eu/8935469321f1cdbbe46542aec6efa279b0053199.jpg"
    }
}