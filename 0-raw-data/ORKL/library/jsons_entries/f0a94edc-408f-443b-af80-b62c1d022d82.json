{
    "id": "f0a94edc-408f-443b-af80-b62c1d022d82",
    "created_at": "2023-01-12T15:08:12.120119Z",
    "updated_at": "2025-03-27T02:05:59.860041Z",
    "deleted_at": null,
    "sha1_hash": "66a98e7be4365e7ba89e428bd510ef7d68a5f478",
    "title": "2022-01-02 - SBIDIOT IoT Malware- miner edition",
    "authors": "",
    "file_creation_date": "2022-05-28T19:49:29Z",
    "file_modification_date": "2022-05-28T19:49:29Z",
    "file_size": 1701788,
    "plain_text": "# SBIDIOT IoT Malware: miner edition\n\n**brianstadnicki.github.io/posts/malware-sbidiot-dec2021/**\n\nBrian Stadnicki January 2, 2022\n\n## Contents\n\n[Brian Stadnicki included in malware analysis](https://brianstadnicki.github.io/)\n2022-01-02 1348 words  7 minutes\n\nThe SBIDIOT IoT malware was observed earlier this year in april. Recently I spotted a\nsample with a cryptominer added on, so let’s see what’s changed.\n\nThe botnet’s main use is for DDOS attacks on game servers.\n\n## Overview\n\n Author\n\nI took a look at one of the past versions of this malware:\n```\n3e948a7995faac6975af3c8c937c66e6b5733cb69dab5d2b87ba4c22e23ef136\n\n```\nIt appears that the author could be `selfrepnetis, who’s instagram is likely @selfrepnetis`\nand @selfrepnetis_.\n\n\n-----\n\nBased on the instagram, it appears that this botnet is likely being used for\n```\nRebirthRebornV2, RebirthVPN, RebirthReboot1.5, Rebirth Stress Hub . This\n\n```\n[seems consistent with the OVH bypass patches listed when googling the tag on Noirth.](https://noirth.com/threads/anonghost720-packetguard-and-smalldoink-release-on-anti-ddos.8716/)\n\nIt appears that SBIDIOT is related to [DemonBot, whose source code is available on](https://blog.radware.com/security/2018/10/new-demonbot-discovered/)\n[pastebin. It looks quite similar, it’s possible that SBIDIOT is based on DemonBot.](https://pastebin.com/QE2GDrvS)\n\n## Version History\n\nThanks to [URLhaus, I believe I have the majority of the versions of SBIDIOT, 20 of them.](https://urlhaus.abuse.ch/)\nMost of these names are from the banner sent to the C&C server, some are from a string.\n\n2020-05-20 - 2020-05-20 - Yakuza - [URLhaus](https://urlhaus.abuse.ch/url/365359/)\n2020-05-20 - 2020-05-21 - Yakuza - [URLhaus](https://urlhaus.abuse.ch/url/365140/)\n[2020-05-26 - 2020-05-26 - HITECH - URLhaus](https://urlhaus.abuse.ch/url/368454/)\n[2020-06-01 - 2020-06-23 - JEW - URLhaus](https://urlhaus.abuse.ch/url/373099/)\n2020-06-25 - 2020-07-01 - Yakuza - [URLhaus](https://urlhaus.abuse.ch/url/401899/)\n[2020-08-21 - 2020-09-27 - Kosha - URLhaus - telnet brute forcer for spreading, based](https://urlhaus.abuse.ch/url/438004/)\non a [leaked source](https://github.com/MrScytheLULZ/telnetlulz/blob/master/rebirth.c)\n2020-08-28 - 2020-08-30 - DGFA - [URLhaus](https://urlhaus.abuse.ch/url/446094/)\n[2020-09-10 - 2020-09-12 - Yakuza/Zeroshell - URLhaus - exploits](https://urlhaus.abuse.ch/url/456635/) `cve-2018-10561`\nin Huawei home routers and CVE-2014-8361 in a Realtek SDK\n[2020-09-14 - 2020-09-16 - DFGA - URLhaus](https://urlhaus.abuse.ch/url/500924/)\n[2020-10-14 - 2020-10-14 - Iris - URLhaus](https://urlhaus.abuse.ch/url/691844/)\n[2020-10-16 - 2020-10-16 - Assassin II - URLhaus](https://urlhaus.abuse.ch/url/701315/)\n[2020-11-19 - 2020-11-19 - Fuze - URLhaus](https://urlhaus.abuse.ch/url/834004/)\n\n\n-----\n\n2020-11-20 - 2020-11-20 - Fuze - [URLhaus](https://urlhaus.abuse.ch/url/835201/)\n2020-11-23 - 2020-11-23 - DGFA - [URLhaus](https://urlhaus.abuse.ch/url/847785/)\n2020-12-01 - 2020-12-01 - Yakuza - [URLhaus - telnet brute forcer for spreading](https://urlhaus.abuse.ch/url/876922/)\n2020-12-02 - 2020-12-03 - Yakuza - [URLhaus](https://urlhaus.abuse.ch/url/883881/)\n[2020-12-04 - 2020-12-05 - RMT - URLhaus - clears bash history, logs, tmp, run.](https://urlhaus.abuse.ch/url/889193/)\nRemoves netstat, kills busybox, perl and python. Disables iptables and firewalld.\n2020-12-14 - 2020-12-28 - DGFA - [URLhaus](https://urlhaus.abuse.ch/url/918771/)\n[2021-12-03 - 2021-12-04 - Fuze - URLhaus](https://urlhaus.abuse.ch/url/1848184/)\n[2021-12-22 - 2021-12-22 - Fuze - URLhaus](https://urlhaus.abuse.ch/url/1909524/)\n\n## Latest version analysis\n\nI’ll do an in-depth analysis of the latest version of the botnet, specifically\n```\nfc0ce41c62734d55e257fcfdfb9118fddb5f0b49646a5731e779570b751ba2ee\n\n## Initial shell script\n\n```\nThe analysis starts at a shell script, which does the following:\n\nDownload a binary for the specific architecture from `20.106.163.35,`\n```\n   [arch].keen.onion.1337\n\n```\nNames it SSH and runs\nDownloads a generic shell script from `20.106.163.35 and names it systemd`\nRuns it with `37.187.95.110:443 and an unidentified address`\n```\n20.106.163.35 appears to be an Azure virtual machine, and 37.187.95.110 appears to\n\n```\nbe OVH instance.\n\nThe binary downloaded is named `cnrig, then it’s renamed to` `systemd . It’s likely this is`\n[CNRig, which is a “Static CryptoNight CPU miner for Linux”.](https://github.com/cnrig/cnrig)\n\n\n-----\n\nThe binary named `[arch].keen.onion.1337 is the main malware binary that I ll be`\nanalysing.\n\n### Unpacking\n\nAs with previous versions, this is packed with UPX and later modified.\n\nThe modification here is again, the same as previous versions, changing the `UPX!`\nsignature for `YTS\\x99 .`\n\nOnce the instances of `YTS\\x99 are replaced with` `UPX!, it can be unpacked.`\n\n### Main\n\n\n-----\n\n**Init garbage data**\n\nFirst of all, the seeds for the generation of garbage data for most packet attacks are\ngenerated.\n\n**Network setup**\n\nThen it attempts to connect to `8.8.8.8 to make sure there is internet access.`\n\nIf there is internet, then it reads `/proc/net/route up until` `\\t00000000\\t to get the`\nname of the default gateway, and sets the socket to use that gateway.\n\n\n-----\n\n**Process forking**\n\nIt attempts to fork itself, where if the exit code is unsucessful then it exits.\n\n**Banner**\n\nThe bot now sends a coloured banner to the command server, `[Fuze] [ %s ] [ %s ] .`\nThe text, apart from the brackets, is coloured red. The first `%s contains the architecture,`\nand the second contains the address of the command server.\n\nBecause of the command server address being sent and it being coloured, I believe that\nwhen the command server receives this, it prints it directly to a console/logs for the owner to\nread.\n\n\n-----\n\n**Command parsing**\n\nIt appears that first whitespace is trimmed from the start and end of the input command’s\ndata.\n\nThe command word itself is at the start of the packet.\n\nThe number of arguments is determined.\n\n\n-----\n\n### C&C commands\n\nWhen SBIDIOT was released, there was originally 16 commands, now there are 41\ncommands:\n```\nALPHA, HXTPA, R6, PUBG, FN, 2K, ARK, BO4, FUZE, OVHHEX, OVHRAW, CHOOPA, LAGOUT,\nHYDRASYN, NFOV6, HOTSPOT, UDPRAPE, CF-DOWN, OVHEXP, HYDRA, OVH-TCP, ARCADE, REVENGE,\nWIFI, FUCK, SHIT, KYS, STOMP, CRUSH, RAW, POXI, XMAS, HTTPSTOMP, RGAME, STD, CUH,\nOVH-TCP, ACID, HAMMED, HTTPS, STOP, Stop, stop\n\n```\nHowever, there are only 11 functions, many of these are different names for the same action.\n\nThe C&C server’s address is still hardcoded, in this case at `54.37.79.0:666, another OVH`\nserver.\n\n**ALPHA**\n\nThe ALPHA command is used to send TCP segments to a specfic host and port for a set\nperiod of time.\n\nArguments:\n\naddress\nunidentified\ntime length\nunidentified\ntcp flags\npacket length (maybe)\n\n\n-----\n\nnumber of packets to send\n\n**HXTPA**\n\nThe HXTPA command is used to send HTTP 1.1 PATCH requests to a specific hostname for\na set period of time. The useragent is picked randomly from a list.\n\nArguments:\n\nhostname\nport\ntime length\nnumber of packets\n\n\n-----\n\n**GAME group**\n\nThe GAME commands appear to be a group of commands related to games, all calling the\nsame function, but with different names.\n\nCommands: R6, PUBG, FN, 2K, ARK, BO4.\n\narguments:\n\naddress\nappears unused\nduration\nsocket type\ndata send seed\nnumber of packets to send\npause every number of packets\nduration of pause\n\n**Scary attack names**\n\n\n-----\n\nThis group of commands sends a byte to a host over a socket, connects and then waits for a\nset duration before closing it.\n\nCommands: FUZE, OVHHEX, OVHRAW, CHOOPA, LAGOUT, HYDRASYN, NFOV6,\nHOTSPOT, UDPRAPE, CF-DOWN, OVHEXP, HYDRA, OVH-TCP, ARCADE, REVENGE,\nWIFI, FUCK, SHIT, KYS, STOMP, CRUSH, RAW.\n\nThe byte sent over is randomly picked from `/73x/6ax/x4a, and interestingly, the length of`\nthis data sent is randomly picked between 1093 and 1193, with odds of 19:41.\n\narguments:\n\nhostname\nport\nduration\n\n**UDP**\n\nThis simply sends packets to an address several times for a duration.\n\narguments:\n\naddress\nundetermined\nduration\npacket length\npacket count\nmagic value\n\n**POXI**\n\nThis sends a packet to a host, connects and then waits before closing it.\n\nInterestingly, the packet payload is:\n\n\n-----\n\n```\nPayload:\n4E/x31/x6B/x4B/x31/x20/x21/x73/x69/x20/x4D/x33/x75/x79/x20/x4C/x30/x56/x72/x33/x20/x3C\n  N1kK1 !si M3uy L0Vr3 <3 Pa2rCH M2 A44rCK\n\n```\nMake of that what you will.\n\narguments:\n\nhostname\nport\nduration\npacket length\n\n**XMAS**\n\nThis sends packets to an address for a duration.\n\narguments:\n\naddress\npossibly packet type\nduration\nundetermined\npacket length\npacket count\n\n**HTTPSTOMP**\n\nHTTPSTOMP sends a HTTP request to a specified host a set number of times and with a\nduration. The user agent is random, and the path is hardcoded bytes it seems.\n\nAfterwards, it sends requests to `/cdn-cgi/l/chk_captcha, in order to try to bypass a`\ncloudfare captcha.\n```\nPayload:\n/x78/xA3/x69/x6A/x20/x44/x61/x6E/x6B/x65/x73/x74/x20/x53/x34/xB4/x42/x03/x23/x07/x82/x\n\n```\narguments:\n\nhttp operation\naddress\nport\nunused\nduration\n\n\n-----\n\npacket count\n\n**RGAME**\n\nThis command sends packets to a host for a duration, pausing sometimes.\n\narguments:\n\nhostname\nundetermined\nduration\nundetermined\npacket length\npacket count\npause threshold\npause duration\n\n**Diseases group**\n\nThese commands send some data to a host, then connects and disconnects after a set\nperiod of time.\n```\nPayload:\n/x6f/x58/x22/x2e/x04/x92/x04/xa4/x42/x94/xb4/xf4/x44/xf4/x94/xd2/x04/xb4/xc4/xd2/x05/x\n\n```\nCommands: STD, CUH, OVH-TCP, ACID, HAMMED, HTTPS.\n\narguments:\n\nhostname\nport\nduration\n\n**RAW**\n\nThis repeatedly sends a string to a host and connects for a specific duration.\n```\nPayload:\n/x50/x33/x43/x4B/x24/x54/x20/x47/x38/x33/x41/x52/x44/x20/x30/x4E/x20/x54/x30/x50/x20/x\n  P3CK$T G83ARD 0N T0P P8TCH IT B\"BY\n\n```\narguments:\n\nhostname\nport\n\n\n-----\n\nduration\n\n**STOP/Stop/stop**\n\nHere all the process’ children are SIGKILL’d.\n\n## Conclusion\n\nI think I’ve covered fairly well the main functionality of this bot, but I’ve left some of the\narguments as unused or undefinied. I belive most of these are for setting a flag in the packet,\nbut I’m not confident on that.\n\nMany of the commands are quite similar in their functionality, so it’s possible that I’ve missed\nsome details.\n\nOverall, it does what it’s meant to do and there aren’t fancy tricks.\n\n## IOCs\n\n[Distribution URLs](https://brianstadnicki.github.io/posts/malware-sbidiot-dec2021/distribution.txt)\n[C&C addresses](https://brianstadnicki.github.io/posts/malware-sbidiot-dec2021/command.txt)\n\n[All of these have been extracted from URLhaus.](https://urlhaus.abuse.ch/)\n\n### Changelog\n\n1/1/21 - Initial\n2/1/21 - Add Overview and IOCs\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-02 - SBIDIOT IoT Malware- miner edition.pdf"
    ],
    "report_names": [
        "2022-01-02 - SBIDIOT IoT Malware- miner edition.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536092,
    "ts_updated_at": 1743041159,
    "ts_creation_date": 1653767369,
    "ts_modification_date": 1653767369,
    "files": {
        "pdf": "https://archive.orkl.eu/66a98e7be4365e7ba89e428bd510ef7d68a5f478.pdf",
        "text": "https://archive.orkl.eu/66a98e7be4365e7ba89e428bd510ef7d68a5f478.txt",
        "img": "https://archive.orkl.eu/66a98e7be4365e7ba89e428bd510ef7d68a5f478.jpg"
    }
}