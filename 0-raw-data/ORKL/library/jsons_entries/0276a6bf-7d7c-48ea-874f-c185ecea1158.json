{
    "id": "0276a6bf-7d7c-48ea-874f-c185ecea1158",
    "created_at": "2023-01-12T15:09:50.96873Z",
    "updated_at": "2025-03-27T02:09:33.39428Z",
    "deleted_at": null,
    "sha1_hash": "95b786ac74c74a585da9676d0b8941da6256e97c",
    "title": "2019-08-14 - In the Balkans, businesses are under fire from a double‑barreled weapon",
    "authors": "",
    "file_creation_date": "2022-05-28T02:46:13Z",
    "file_modification_date": "2022-05-28T02:46:13Z",
    "file_size": 1237199,
    "plain_text": "# In the Balkans, businesses are under fire from a double‑barreled weapon\n\n**welivesecurity.com/2019/08/14/balkans-businesses-double-barreled-weapon/**\n\nAugust 14, 2019\n\nESET researchers discovered a campaign that uses two malicious tools with similar capabilities to ensure both resilience and broader\npotential for the attackers\n\n[Zuzana Hromcová](https://www.welivesecurity.com/author/zhromcova/)\n14 Aug 2019 - 11:30AM\n\nESET researchers discovered a campaign that uses two malicious tools with similar capabilities to ensure both resilience and broader\npotential for the attackers\n\nWe’ve discovered an ongoing campaign in the Balkans spreading two tools having a similar purpose: a backdoor and a remote access trojan\nwe named, respectively, BalkanDoor and BalkanRAT.\n\nBalkanRAT enables the attacker to control the compromised computer remotely via a graphical interface, i.e., manually; BalkanDoor enables\nthem to control the compromised computer remotely via a command line, i.e., possibly en masse. ESET security products detect these\nthreats as Win{32,64}/BalkanRAT and Win32/BalkanDoor.\n\nA typical victim of this campaign, which uses malicious emails as its spreading mechanism, ends up having both these tools deployed on the\ncomputer, each of them capable of fully controlling the affected machine. This rather uncommon setup makes it possible for attackers to\nchoose the most suitable method to instruct the computer to perform operations of their choice.\n\n\n-----\n\ne ca pa g s o e a c g t e e s ta es t t e co te ts o t e e a s, c uded s a d decoy s a o g ta es, t e attac e s\nare apparently targeting the financial departments of organizations in the Balkans region. Thus, although backdoors and other tools for\nremote access are often used for espionage, we believe that this particular campaign is financially motivated.\n\nThe campaign has been active at least from January 2016 to the time of writing (the most recent detections in our telemetry are from July\n[2019). Some parts of the campaign were briefly described by a Serbian security provider in 2016 and the Croatian CERT in 2017. Each of](https://www.it-klinika.rs/blog/prvi-phishing-na-srpskom)\nthese sources focused only on one of the two tools and only on a single country. However, our research shows that there is a significant\noverlap in targets and also in the attackers’ tactics, techniques and procedures.\n\nOur findings show that the mentioned attacks have been orchestrated and we consider them a single long-term campaign that spans Croatia,\nSerbia, Montenegro, and Bosnia and Herzegovina.\n\nOur research has also shed more light at the malware used in this campaign and provided some context. We’ve discovered a new version of\n[BalkanDoor with a new method for execution/installation: an exploit of the WinRAR ACE vulnerability (CVE-2018-20250). Furthermore, we’ve](https://nvd.nist.gov/vuln/detail/CVE-2018-20250)\nseen both malicious tools digitally signed with various certificates the developers paid for to add perceived legitimacy. One of them, issued to\nSLOW BEER LTD, was even valid at the time of writing; we’ve notified the issuer about the misuse and they revoked the certificate.\n\nIn this article, we will describe some notable features of both BalkanDoor and BalkanRAT. Our analysis shows that the former runs as a\nWindows service, which allows it to unlock the Windows logon screen remotely and without the password or start a process with the highest\npossible privileges. The latter misuses a legitimate remote desktop software (RDS) product and uses extra tools and scripts to hide its\npresence from the victim, such as hiding the window, tray icon, process and so on.\n\n## Targets and distribution\n\nBoth BalkanRAT and BalkanDoor have been spread in Croatia, Serbia, Montenegro, and Bosnia and Herzegovina. (These countries, along\nwith Slovenia and former Macedonia, formed the country of Yugoslavia until 1992.)\n\n_Figure 1. Malware distribution by country_\n\nAccording to our telemetry: the campaign spreading these tools has been live since 2016, with the most recent detections as late as in July\n2019.\n\nThe attackers have been distributing their tools via malicious emails (“malspam”) with links leading to a malicious file.\n\nThe links included in the malspam emails used for distribution of both BalkanRAT and BalkanDoor mimic legitimate websites of official\ninstitutions.\n\n**Table 1. Domains misused in the campaign**\n\n**Malicious domain** **Real domain** **Institution**\n\npksrs[.]com [pks.rs](http://www.pks.rs/) Chamber of Commerce and Industry of Serbia\n\nporezna-uprava[.]com [porezna-uprava.hr](http://www.porezna-uprava.hr/) Ministry of Finance of Croatia, Tax Administration\n\nporezna-uprava[.]net\n\npufbih[.]com [pufbih.ba](http://www.pufbih.ba/) Tax Administration of the Federation of Bosnia and Herzegovina\n\nThe decoy PDFs revolve around the tax theme.\n\n\n-----\n\n**Table 2. Decoy PDFs used in the campaign**\n\n**PDF name** **Language** **Content**\n\nMIP1023.pdf Bosnian Tax form\n\nPonovljeni-Stav.pdf Bosnian Tax law\n\nAUG_1031.pdf Bosnian Instructions for using tax filing application\n\nZakon.pdf Croatian Tax law\n\nZPDG.pdf Serbian Tax law\n\n_Figure 2. Decoy PDF documents_\n\nMost often, the links leading to an executable file are disguised as links to a PDF. The executable file is a WinRAR self-extractor with its name\nand icon changed to resemble a PDF to fool the user. When executed, it is configured to unpack its content, open the decoy PDF to prevent\nany suspicion – and silently execute either BalkanRAT or BalkanDoor.\n\n\n-----\n\nso e o t e atest sa p es o a a oo detected 0 9, t e a a e s d st buted as a C a c e, d sgu sed as a a c e\n(i.e., not an executable file), specially crafted to exploit the WinRAR ACE vulnerability (CVE-2018-20250). This vulnerability, which has been\n[remediated in version 5.70 released on February 28, 2019, is known to have been exploited quite often to distribute malware.th](https://www.win-rar.com/singlenewsview.html?&L=0&tx_ttnews%5Btt_news%5D=116&cHash=2b3cf0017a6df3b5a4a66288a60a1eae)\n\nThe exploit-based deployment of BalkanDoor is stealthier than in previous versions of the malware because it does not require executing the\ndownloaded file – an operation that might raise the intended victim’s suspicions.\n\n## The campaign\n\nAccording to our telemetry, most of the time, both tools have been deployed on the same machine. The combination of the tools gives the\nattacker both a command-line interface and a graphical interface to the compromised computer.\n\nIn the case of the whole toolset being deployed on the machine, here is an example scenario for the attack:\n\nThe attacker detects that the victim has the screen locked and thus, most probably, is not using the computer (either via BalkanDoor sending\n[a screenshot showing that computer is locked, or via the View Only mode of BalkanRAT). Via the BalkanDoor backdoor, the attacker sends a](https://www.remoteutilities.com/support/docs/full-control-and-view/)\nbackdoor command to unlock the screen… and using BalkanRAT, they can do whatever they want on the computer.\n\nHowever, even if the victim does not use the computer, the chance of spotting the actions performed by the attackers is still there. Even with\nthis disadvantage, using the RDS tool may be useful. The attackers are not limited by the commands shipped in the backdoor, or by their\nprogramming skills: manually, they can perform actions that would require writing a lot of code if a backdoor were the only tool available.\n\nIn principle, the Balkan- toolset could be used for espionage, among other possible goals. However, not only the campaign’s targets and\ndistribution, but also our analysis of the Balkan-toolset tools show that the attackers are going after money instead of espionage.\n\nThe BalkanDoor backdoor does not implement any exfiltration channel. Presumably, if the campaign were intended for espionage, the\nattackers would need an exfiltration channel for uploading the collected data – at least as a backup to manual exfiltration, which might not be\nalways an option.\n\nOn the contrary – and supporting the notion that the attackers’ goal has been to commit some financial crime – we’ve seen BalkanRAT\ndropping a tool that can list available smart cards, via the SCardListReadersA/ SCardConnectA API functions. Smart cards are usually issued\nby banks or governments for confirmation of the holder’s identity. If misused, smart cards can facilitate illegal/fraudulent activities, e.g. digitally\nsigning a contract, validating a money transaction etc.\n\n[In the past, we’ve seen this feature in Operation Buhtrap, a campaign targeting Russian banks.](https://www.welivesecurity.com/2015/04/09/operation-buhtrap/)\n\n## Analysis – BalkanDoor\n\nBalkanDoor is a simple backdoor with a small number of commands (download and execute a file, create a remote shell, take a screenshot).\nIt can be used to automate tasks on the compromised computer or to automatically control several affected computers at once. We have seen\nsix versions of the backdoor, with a range of supported commands, evolve since 2016.\n\nThe initial dropper unpacks all its components, opens a decoy PDF (in some cases) and executes a batch installation script that ensures\npersistence of the backdoor.\n\nThe backdoor registers itself as a service, under a legitimately-looking service name (e.g. WindowsSvc, WindowsPrnt, WindowsConn or\nWindowsErr); the accompanying batch scripts can further ensure persistence by using Registry Run Keys or Startup folder.\n\nAfter the backdoor is installed, the computer connects to a C&C server, identifying itself by the computer name and requesting commands.\nThe backdoor can connect to any of the C&Cs from a hardcoded list – a measure to increase resilience. It connects via the HTTP or HTTPS\nprotocol; if HTTPS is used, then the server certificates are ignored.\n\nIf the connection is not successful, the backdoor is capable of using the user-configured proxy on the victim’s computer and repeating the\nconnection attempt.\n\nThe backdoor commands come in a format of an INI file, with properties determining the commands, command arguments and intended\nrecipients. Specifying the list of recipients allows the attacker to send their commands to several compromised computers at once, e.g. to\ntake screenshots of all compromised computers automatically.\n\n**Table 3. BalkanDoor’s commands**\n\n**Commands** **Functionality**\n\ncn Specifies computer name(s) of the intended recipients of the commands\n\ndu, int Download and execute a file\n\ndu, ra, de, rpo Download and execute a file, in the specified context and on a specified desktop\n\nrip Create a remote shell accessible from the specified IP address\n\n\n-----\n\n**Table 3. BalkanDoor s commands**\n\nscr_int, scr_dur Capture a series of screenshots of the specified duration\n\nFurthermore, the backdoor itself can be executed in several modes, determined by the command line arguments with which it is executed.\nThese modes themselves can serve as backdoor commands (when executed from the remote shell):\n\n**Table 4. BalkanDoor’s modes**\n\n**Argument** **Functionality**\n\n/unlock Unlocks the screen\n\n/rcmd Creates a remote shell and redirects its input/output to the specified IP address\n\n/takescr Captures a series of screenshots, duration determined by other arguments\n\n/run Executes the specified command using cmd.exe\n\n/runx Executes the specified command using cmd.exe, on the active (input) desktop\n\n/inst Installs itself as a service and starts the main procedure (see /nosvc)\n\n/start Starts the associated service, which starts the main procedure (see /nosvc)\n\n/nosvc Main payload, communicates with C&C and interprets backdoor commands\n\nAmong the BalkanDoor capabilities, the most notable is passwordless screen-unlocking.\n\nThis feature comes in handy to the attackers in cases when a logged-in user locks the computer. The “Lock screen” is just another Desktop\nfor the system, so any malware with the necessary privileges can switch to a real desktop by command. No password is required to perform\nthis operation.\n\n_Figure 3. Code responsible for unlocking the computer when the backdoor is executed remotely with a “/unlock” argument_\n\n## Analysis – BalkanRAT\n\nThe BalkanRAT part of the malicious Balkan- toolset is more complex compared to its backdoor accomplice. Its goal is to deploy a copy of the\nRemote Utilities software, which is commercial software by a Russian vendor, Remote Utilities, LLC, used for remote access to a computer or\nfor remote administration. BalkanRAT also provides the attacker with the credentials needed for this remote access.\n\nBalkanRAT has several additional components to help load, install and conceal the existence of the RDS. They can add exceptions to the\nfirewall, hide the RDS’s window and its tray icon, and hide the presence of related processes in the task manager.\n\n\n-----\n\n_Figure 4. Components used in the campaign to deploy and hide the presence of the RDS_\n\n1. The dropper first unpacks all components; a configuration file, the remote desktop software and a core component installing it, a\n\nuserland rootkit, a GUI hider and a decoy PDF file.\n2. The dropper opens the PDF file so as not to arouse suspicion of the user.\n3. Covertly, the dropper executes the core component (32-bit) in the installation mode.\n4. The core component (32-bit) installs itself to be executed with each start, and adds an exception to the firewall for the RDS. It executes\n\ncommands inst1 and inst2 specified in the configuration file, and executes itself again, now in stealth mode.\n5. In this mode, the core component acts like a keylogger.\n6. The core component (32-bit) executes the 64-bit version of itself, in injection mode (if applicable).\n7. The core component (64-bit) injects the userland rootkit (64-bit) into task manager processes. The userland rootkit then hides the\n\npresence of the malicious processes in the task manager.\n8. The core component (32-bit) executes the RDS. It repeatedly monitors and hides the RDS window (because it is a GUI application).\n9. The core component (32-bit) injects the userland rootkit (32-bit) into task manager processes. The userland rootkit then hides the\n\npresence of the malicious processes in the task manager.\n10. The core component (32-bit) executes commands cmd1 and cmd2, as specified in the configuration file. One such command was seen\n\nexecuting a GUI hider, which is an AutoHotKey script hiding the tray icon of the RDS.\n\n_Note: Some components are optional. Also, sometimes they are deployed as a set comprising an encrypted payload and the corresponding_\n_loader. We are omitting these details._\n\nThe configuration file of BalkanRAT is in INI file format (similarly to BalkanDoor, which uses this format for backdoor commands), with one\nsection named [CFG]. The INI file is used by the malware’ core component and the userland rootkit.\n\n**Property** **Functionality**\n\ninst1, inst2 Commands executed by the core component during installation\n\ncmd1, cmd2 Command executed by the core component main payload\n\nhproc List of processes that should be hidden by userland rootkit\n\nmproc List of processes where userland rootkit is injected\n\n_Figure 5. BalkanRAT’s configuration file – properties (top) and example (below)_\n\nBalkanRAT’s core is a multipurpose component (there are both 32-bit and 64-bit versions); it can be executed in various modes, determined\nby the command-line argument. Most significantly, it is used for installation of BalkanRAT, launching a userland rootkit and adding exceptions\nfor the RDS component in the firewall.\n\n\n-----\n\n**Table 5. BalkanRAT s**\n**core component –**\n**supported functionality**\n\n**Argument** **Functionality**\n\n/rhc Executes a batch file\n\n/fwl Adds exception to the firewall for the specified program\n\n/sreg Sets configuration data for the RDS in the registry (especially email address where the credentials should be\nsent)\n\n/inst Ensures persistence by adding itself to the [HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\nNT\\CurrentVersion\\Windows] registry key under the “load” entry. Adds exception for the RDS to the local\nfirewall. Executes itself again in the main mode (no arguments).\n\n/inj Injects the userland rootkit library into processes, as specified in the configuration file\n\n(none) Main mode. Executes the 64-bit version of itself (if applicable), injects the userland rootkit, executes the RDS\nand hides the window by changing its coordinates to values outside the screen.\nAnother thread captures pressed keystrokes.\n\nThe main part of the BalkanRAT malware is a copy of the Remote Utilities software for remote access. Instead of using the official version,\nBalkanRAT deploys a copy signed by a certificate of the attacker.\n\nThe client side of the RDS running on the victim’s computer must know the unique ID and the password, both generated on the server side, to\nconnect to the server. The RDS deployed by BalkanRAT is configured in such a way that the password is the same for all victims, and the\ngenerated unique ID is sent to the attacker’s email address by the tool itself.\n\nSince the tool BalkanRAT misuses is legitimate, it leverages the genuine Remote Utilities’ infrastructure for this communication (rutils.com,\nserver.rutils.com); due to this, the communication may seem legitimate to the user – and to security products.\n\nAs a result, the attacker has obtained credentials to access the compromised computer via the Remote Utilities software. Using this tool, they\ncan broadcast the screen to monitor the activity of the user and manually take over the compromised computer.\n\n_Figure 6. A window the victim never sees. With a legitimate copy of Remote Utilities, this window is visible; however, BalkanRAT will hide it using the GUI_\n\n_hider feature._\n\nTo remain stealthy, BalkanRAT uses the GUI hider feature. In most samples (some older ones are exceptions), it is implemented as an\nAutoHotKey script, compiled into an executable file so that it can be run on a computer even if AutoHotKey is not installed there. The purpose\nof this script is to hide the tray icon of the RDS client.\n\n\n-----\n\n_Figure 7. AutoHotKey script embedded in the resource section of the executable_\n\nAnother notable feature used by BalkanRAT to stay hidden is the ability to hide processes from the user.\n\nTo achieve this, userland rootkit libraries are injected in processes hardcoded in the configuration file. The userland rootkit hooks the\nNtQuerySystemInformation function for the process in which it is injected. In case SystemProcessInformation is queried, it filters out all\nentries for processes with the names specified in the configuration file. As a result, conventional task manager utilities will not display the\nprocesses the attackers want to keep hidden from the user.\n\n_Figure 8. With the userland rootkit injected, some processes are missing in the list (left). Without the rootkit, the processes are visible (right)._\n\nNaturally, the list of processes that will be hidden contain mostly ones belonging to BalkanRAT. However, we have also seen names like\n“weather.exe” or “preserve.exe” in the list – which belong to the BalkanDoor backdoor. This finding supports the belief these two tools are\nindeed used together.\n\n## Conclusion\n\nBoth BalkanRAT and BalkanDoor have some interesting tricks up their sleeves and each of them separately pose a significant risk to the\nvictims. If used together as a toolset, they make an even more powerful weapon – the campaign we have discovered targets accounting, a\nfunction that is critical for organizations.\n\nThe campaign targeting accountants in the Balkans shows some similarities (in terms of modus operandi) with a campaign aimed at\n[Ukrainian notaries reported in 2016. (The only source we have been able to find describing it is in Russian.) In that case, the attackers’ goal](https://cys-centrum.com/ru/news/black_notaries_case)\nwas to take control over a notary’s computer and issue some illegal operation on behalf of the notary.\n\n\n-----\n\nJust as attac e s ay co a audu e t t a sact o o be a o a ota y, t ey ay pe o a audu e t t a sact o e pe so at g a\nmanager in a company’s financial department.\n\nTo stay safe, business users – and their employers – should follow basic cybersecurity rules: be cautious about emails and scrutinize their\nattachments and links, keep their software updated and use a reputable security solution.\n\n# Indicators of Compromise (IoCs)\n\n## ESET detection names\n\nWin32/BalkanDoor.A\nWin32/BalkanDoor.B\nWin32/BalkanRAT.A\nWin32/BalkanRAT.B\nWin64/BalkanRAT.A\nWin64/BalkanRAT.B\n\n## SHA-1\n\n### BalkanDoor – executable files\n\n02225C58A0800A8FFFE82F7614695FDEEB75C8B3\n\n3E8AF08F2C64D9D305A129FDEA6B24ED3D8D9484\n\n400FF3FD5BEF94DCBEAE24B5B8A6632DCD1D22A6\n\n576EF0057982DE87CA029C736706E840031A27F4\n\n5CC4F248595268A0C9988DAEE3F0F8F9F5AC0A7F\n\n60EB2A19EC63FF36D13F472EC0E6A594C2778CE6\n\n7AA3D6EA4736C3BF627DB1837B9C8D2B29D7AB8D\n\nAC5383306459CE8CD19BFF412875F093B40427C6\n\n### BalkanRAT – executable and auxiliary files\n\n006B8EF615550BA731A30FA83B0E03CD16D2A92D\n\n030DC8C3832F664FA10EFA3105DFF0A9B6D48911\n\n032884A46430039ED4E38518AA20742B79AB2678\n\n09D18CD045285A753BCF4F42C6F10AF76913546A\n\n0F7A95C89911E3DE9205FF6AA03E1A4FCE6BC551\n\n13D8664B438DA278CEB9C8593AE85023432054CD\n\n17EA62EBC5F86997FD7E303FBBFF3E343DA38FCC\n\n1C03ED1ADF4B4E786EFC00F3D892217FAAAFB268\n\n15EC88015FB554302DB131258C8C11C9E46209D4\n\n21DE3EB6F39DF4DBBF2D1FE4B6467AAE3D9FBEBD\n\n21EE61874F299661AECC5453F4D6D0EC5380DAD0\n\n270F1FA36365273F14D89EE852D8A438A594CD05\n\n30BA2213BE4355D619E20DA733F27F59DA7B937E\n\n3170B45FB642301687A3A320282099B9D7B7F0F2\n\n38E7FCD6038E688DEC9F1AF9D2D222B9BBC03A8C\n\n3927B48D315F6712D33166A3B278B7835E76A6A9\n\n3C1FF7BBE8BC2BE9E5531FFAD25B18F03C51CF6B\n\n421F52733D334BE32C899670426C06CB72D92CDE\n\n46E4B456729CF659527D2697BD8518E67B5A0056\n\n4F8BA64DA7EA16A7CE5AA2C83BBFCE1C8646E424\n\n500A447A187240706C059C16366FEDF1AA13EA77\n\n555844CA5CD40DFC27778C2D3B6AFA43D1B76685\n\n5A3201048D8D9D696102A3C3B98DA99C2CC4FF1F\n\n64E3A46BF393936A79478C891654C1070CEC42D1\n\n685314454A7D7987B38ADD2EDDBAC3DB9E78464F\n\n6C83ABE56219CA656B71AA8C109E0955061DA536\n\n6E27F7C61230452555B52B39AB9F51D42C725BED\n\n6EF16FAA19FC4CEF66C4C1B66E58FB9CFFD8098E\n\n72DB8CCC962E2D2C15AC30E98F7382E3ACDEDDA8\n\n730E20EE7228080A7F90A238D9E65D55EDD84301\n\n73E0A62F1AAAB3457D895B4B1E6E2119B8B8D167\n\n7BA4D127C6CD6B5392870F0272C7045C9932DB17\n\n\n-----\n\n56 89 0893 809 3 0C C9 5 08 5\n8852647B1C1A2EFA4F25FEA393D773F9FF94D6FA\n8D9A804B1433A05216CFE1D4E61CE5EB092A3505\n8F85738534158DB9C600A29B9DED8AC85C3DE8C1\n963CF321740C4EF606FEC65FCE85FB3A9A6223AC\n97926E2A7514D4078CF51EAC069A014309E607F1\n9EA0C6A17EE4EB23371688972B7F4E6D4D53F3C8\n9F2C6A44453E882098B17B66DE70C430C64C3B26\nA1DEA762DD4329E77FE59526D4ABC0E15DE2BBBC\nA56A299A8EEF9F4FF082184F66FAD1B76C7CACB8\nA5ACE8F90C33CBDB12D398C0F227EC48F99551BF\nAA4AD783DFE3CC6B0B9612814ED9418253203C50\nAB311B53591C6625335B9B791676A44538B48821\nAEDF43347AF24D266EC5D471723F4B30B4ACC0D0\nB18222E93D25649BC1B67FAB4F9BF2B4C59D9A1A\nB8F67BB5682B26ACD5969D9C6AC7B45FE07E79E1\nBAD38D474D5CAAAC27082E6F727CAE269F64CF3C\nBEEF0EE9397B01855C6DAA2BFF8002DB4899B121\nBFE3F5CEC25181F1B6852E145013E548B920651E\nC268CAB6D8EC267EEE463672809FAAEE99C2F446\nC2F9FFDF518DA9E037F76902746DE89C2E2821E8\nC3813734D3BFC07E339C05417055A1A106E2FBBD\nC8CBBC175451A097E605E448F94C89D3E050ACD5\nC90756A3C6F6DC34E12BABF5F26543510AACE704\nC90B5471BBA3293C0A0E6829A81FBE2EB10B42B2\nCD1BC431F53E9CFF8204279CDF274838DE8EBB61\nCD82D898A3CEA623179456D9AE5FAD1FB5DA01A0\nCDBB74CA0960F2E8631D49ACABF2CEA878AE35B8\nCE7092FF909E9380CC647C3350AA3067E40C36A9\nCEA70DB7FB8E851EF0D6A257A41C9CEE904345B5\nCF7A8AFAC141E162A0204A49BAD0A49C259B5A45\nDEEA26F5AF918CEC406B4F12184F0CAB2755B602\nDFDFCC61770425A8D1520550C028D1DF2861E53F\nE0007A2E0E9AE47DD028029C402D7D0A08EBBC25\nE00C309E3FE09248B8AFCFF29FC1A79445C913DA\nE95C651C539EAF73E142D1867A1A96098A5E219F\nECEEE01F4E8051F544062AE37D76A3DF2921DF82\nF06CB000F9A25DDE791C7E5BC30917C74A8F2876\nF26C663D5F6F534543A7C42B02254C98BB4EC0D5\nF3BC2F436693B61FED7FA7DDF8BC7F27618F24F3\nF6030AE46DC2CEF9C68DA1844F7DCEA4F25A90A3\nFA19E71F9A836EA832B5D738D833C721D776781A\nFFE23D510A24DB27C1C171D2BAF1FBEB18899039\n\n### Remote Utilities (otherwise legitimate releases signed by attackers’ certificates)\n\n038ECEB80597DE438D8194F8F57245EB0239FF4B\n\n2A1BB4BB455D3238A01E121165603A9B58B4D09D\n\n34CE3FBEE3C487F4F467B9E8EB36844BB5ACB465\n\n3B88D4047FA2B8F8FA6241320D81508EB676EA7A\n\n400438EB302886FD064274188647E6653E455EED\n\n42F70DAA8C75E97551935D2370142C8904F5A20D\n\n446D3FBAE9889FE59AFAD02C6FB71D8838C3FC67\n\n4D46FB773C02A9FF98E998DA4F0777FB5D9F796B\n\n510C93D3DC620B17500C10369585F4AF7CF3CE0D\n\n6A5CA3B9EE0A048F0AEE1E99CBF3943D84F597FF\n\n6D53E7B5099CE11ACA176519620E8064D4FF9AD0\n\n7CEC39AC6A436577E02E7E8FE8226A00E58564CB\n\n8888014C16732CD5136A8315127BA50BB8BB94ED\n\nA5A05BA6E24226F1BC575CBC12B9FC59F6039312\n\nB77CFFF0E359946029120DD642505BC0A9713ECC\n\nBC6F31D5EBC71FF83BACC0B4471FDEFC206B28D0\n\nBE8A582360FB16A4B515CD633227D6A002D142FA\n\nC6E62A113E95705F9B612CDBF49DAC6BAD2073BD\n\n\n-----\n\n8 C 8 9 9 9 59 93C C5 5 8 5\nDBE0E084B2A8CE4711C3DF4E62E8062234BF6D3B\nE56189FE86C9537C28099518D4F4EA2E42EF9EEE\nE918192D2B5C565A9B2756A1D01070C6608F361C\n\n### Scripts\n\n0BD6C70B7E2320F42F0CFC2A79E161614C7C4F66\n\n7A41B912A3F99370DF4CD3791C91467E23B2AA82\n\nA15AB505B79B88A9E868C95CE544942403C58CB6\n\nA8A5980DE35FBF580497B43EF7E8499E004F9F38\n\nB248E43BAB127D8E1E466821B96B7B7ECF37CB78\n\n### Configuration files\n\n28F152154F6E6074EA0DE34214102119C8589583\n\n37A2A15C52CAA7D63AF86778C2DD1D2D81D4A270\n\nB4A847D7AAC4164CF90EA585E4842CBF938B26CF\n\n### Decoy PDF files\n\n1E0C4A5F0FF2E835D12C3B6571AE6000E81A014B\n\n8722441FF3678D154C89E312DB1A54951DD21C3F\n\n88C3FDA42768C5B465FD680591639F2CDC933283\n\n9F48E109675CDB0A53400358C27853DB48FCD156\n\nC9B592BD7B69995C75CD5B1E4261B229C27FB479\n\n## Misused certificates\n\n**Name** **Email** **Valid from** **Valid to** **SHA1 Thumbprint**\n\n\n**Status**\n**at the**\n**time of**\n**writing**\n\n\nAMO-K Limited Liability\nCompany\n\n\nllc.amok@list.ru\n\n\nValmpak, TOV tovvalpak@mail.ru\n\n\n2015/07/30 2016/07/28 4E36C4D10F1E3D820058E4D451C4A7B77856BDB3 Expired\n\n2016/04/10 2017/04/01 17D50E2DBBAF5F8F60BFFE1B90F4DD52FDB44A09 Revoked\n\n\nValmpak, TOV - 2016/08/22 2017/11/04 4A362020F1AFD3BD0C67F12F55A5754D2E70338C Revoked\n\n3D PEOPLE LIMITED - 2017/11/05 2018/11/06 936EDFB338D458FBACB25FE557F26AA3E101506E Expired\n\nADUNIK LTD - 2017/10/11 2018/10/12 E7DF448539D1E2671DCF787CF368AAC2ED8F5698 Expired\n\n\nSLOW BEER LTD administrator@\n\nslowbeerltd.info\n\n## File names\n\n### BalkanDoor\n\n**Dropper: Zakon.exe**\n\n\n2019/01/25 2019/12/18 2359D644E48759F43993D34885167FECAFD40022 Revoked\n\n\n**Backdoors: weather.exe, winmihc.exe, Preserve.exe, PreservS.exe, WindowsConnect.exe**\n\n**Scripts: weather.cmd, winmihc4.cmd, mihcupdate.cmd**\n\n**Decoy PDF file: Zakon.pdf**\n\n### BalkanRAT\n\n**Droppers: ZPDGI.exe, ZPDGV.exe, ZPDGE.exe, ZPDGO.exe, ZPDGU.exe, ZPDGA.exe, Ponovljeni-Stav.exe, AUG_1031.exe,**\nMIP1023.exe\n\n**Configuration file: stg.cfg**\n\n**Decoy PDF files: ZPDG.pdf, Ponovljeni-Stav.pdf, AUG_1031.pdf, MIP1023.pdf**\n\n**Core component: winchk32.exe, wininit.exe, hide.exe, winchk64.exe**\n\n**RDS: rutserv.exe, rfusclient.exe**\n\n**Userland rootkit: winmmon.dll, winmmon64.dll**\n\n**GUI hider components: serk.bat, serk.exe**\n\n\n-----\n\n## Folder names\n\n%WINDIR%\\1B20F6AA-6CAD-45A7-81CB-120FB86FECD8\n%WINDIR%\\29D451CF-3548-4486-8465-A23029B8F6FA\n%WINDIR%\\B1EDD68E-6AD8-4A7E-91A1-3C30903B8DD4\n%APPDATA%\\1B20F6AA-6CAD-45A7-81CB-120FB86FECD8\n%APPDATA%\\29D451CF-3548-4486-8465-A23029B8F6FA\n%APPDATA%\\B1EDD68E-6AD8-4A7E-91A1-3C30903B8DD4\n\n## C&C servers\n\nhttp://bestfriendsroot[.]com/smart.php\n\nhttp://bestfriendsroot[.]com/weather.php\n\nhttp://bestfriendsroot[.]com/zagreb.php\n\nhttp://consaltingsolutionshere[.]com/smart.php\n\nhttp://consaltingsolutionshere[.]com/weather.php\n\nhttp://consaltingsolutionshere[.]com/zagreb.php\n\nhttp://dogvipcare[.]net/kversion.php\n\nhttp://hvar.dogvipcare[.]net/dekol.php\n\nhttp://kimdotcomfriends[.]com/smart.php\n\nhttp://kimdotcomfriends[.]com/weather.php\n\nhttp://kimdotcomfriends[.]com/zagreb.php\n\nhttp://limosinevipsalon[.]com/kversion.php\n\nhttp://luxembourgprotections[.]com/kversion.php\n\nhttp://malmevipbikes[.]se/kversion.php\n\nhttp://split.malmevipbikes[.]se/dekol.php\n\nhttp://zagreb.porezna-uprava[.]com/dekol.php\n\n## Email addresses used to exfiltrate Remote Utilities credentials\n\nb.klokov@inbox.ru\ngalkin.valentin.83@bk.ru\ngligorijmaskov@mail.ru\nivan.aslanov@newmail.ru\nivan.tatarov@qip.ru\nmelikov.viktor@yandex.ru\nmr.aleksandrandreev@mail.ru\ntest@bbportal.info\ntgerik@list.ru\nvladzlobin@list.ru\n\n# MITRE ATT&CK techniques\n\n## BalkanRAT\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\n\n[T1192](https://attack.mitre.org/techniques/T1192/) Spearphishing Link BalkanRAT is distributed via emails that contain links\nmalware.\n\n\nExecution [T1059](https://attack.mitre.org/techniques/T1059/) Command-Line Interface BalkanRAT uses cmd.exe to execute files.\n\n\n[T1106](https://attack.mitre.org/techniques/T1106/) Execution through\nAPI\n\n\nBalkanRAT uses ShellExecuteExW and\nLoadLibrary APIs to execute other malware\ncomponents.\n\n\n[T1064](https://attack.mitre.org/techniques/T1064/) Scripting BalkanRAT uses batch scripts for malware\ninstallation and execution.\n\n[T1204](https://attack.mitre.org/techniques/T1204/) User Execution BalkanRAT relies on the victim to execute the initial\ninfiltration. The malware is disguised as PDF\ndocuments with misleading names, in order to\nentice the intended victim to click on it.\n\nPersistence [T1060](https://attack.mitre.org/techniques/T1060/) Registry Run Keys / Startup Folder BalkanRAT uses the following Registry Run key to\nestablish persistence:\n\n[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\W\nNT\\CurrentVersion\\Windows] “load”\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\nPrivilege\nEscalation\n\nDefense\nEvasion\n\n\n[T1134](https://attack.mitre.org/techniques/T1134/) Access Token Manipulation BalkanRAT is able to impersonate the logged-on use\nDuplicateTokenEx or ImpersonateLoggedOnUser AP\n\n[T1116](https://attack.mitre.org/techniques/T1116/) Code Signing BalkanRAT is digitally signed with code-signing certif\n\n\n[T1140](https://attack.mitre.org/techniques/T1140/) Deobfuscate/Decode\nFiles or Information\n\n[T1089](https://attack.mitre.org/techniques/T1089/) Disabling Security\nTools\n\n\nBalkanRAT decrypts and decompresses some of its\ncomponents.\n\nBalkanRAT is capable of adding exceptions to the\nlocal firewall, using its COM interface.\n\n\n[T1112](https://attack.mitre.org/techniques/T1112/) Modify Registry BalkanRAT modifies the\n\n[HKEY_CURRENT_USER\\Software\\Usoris\\Remote\nUtilities\\Server\\Parameters] registry key to store\nconfiguration of the RDS\n\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or\nInformation\n\n\nSome components of BalkanRAT are compressed\nand then encrypted by a XOR cipher.\n\n\n[T1055](https://attack.mitre.org/techniques/T1055/) Process Injection BalkanRAT injects a userland rootkit library into\nprocesses of task manager utilities.\n\n[T1108](https://attack.mitre.org/techniques/T1108/) Redundant Access Operators of BalkanRAT have been seen deploying\na second malicious tool (BalkanDoor) to preserve\nremote access in case BalkanRAT is removed.\n\n[T1014](https://attack.mitre.org/techniques/T1014/) Rootkit BalkanRAT uses a userland rootkit that hooks the\nNtQuerySystemInformation function to hide the\npresence of malicious processes.\n\n[T1143](https://attack.mitre.org/techniques/T1143/) Hidden Window BalkanRAT uses 3rd party remote desktop software\nand hides its window and tray icon in order to hide\nit from the user.\n\nDiscovery [T1082](https://attack.mitre.org/techniques/T1082/) System Information Discovery BalkanRAT collects the computer name and the lang\nsettings from the compromised machine.\n\nCollection [T1056](https://attack.mitre.org/techniques/T1056/) Input Capture BalkanRAT is capable of logging pressed keystrokes\n\n\nCommand\nand Control\n\n\n[T1219](https://attack.mitre.org/techniques/T1219/) Remote Access Tools BalkanRAT has misused legitimate remote desktop\nsoftware for remote access.\n\n\n## BalkanDoor\n\n**Tactic** **ID** **Name** **Description**\n\n\nInitial\nAccess\n\n\n[T1192](https://attack.mitre.org/techniques/T1192/) Spearphishing Link BalkanDoor is distributed via emails that\ncontain links to download malware.\n\n\nExecution [T1059](https://attack.mitre.org/techniques/T1059/) Command-Line Interface BalkanRAT uses cmd.exe to create a remote\nshell.\n\n\n[T1106](https://attack.mitre.org/techniques/T1106/) Execution\nthrough API\n\n[T1203](https://attack.mitre.org/techniques/T1203/) Exploitation\nfor Client\nExecution\n\n\nBalkanRAT uses ShellExecuteExW and LoadLibrary APIs\nto execute files.\n\nBalkanDoor can be distributed as an ACE archive\ndisguised as a RAR archive, exploiting CVE-2018-20250\nvulnerability in WinRAR to execute malicious code.\n\n\n[T1064](https://attack.mitre.org/techniques/T1064/) Scripting BalkanDoor uses batch scripts for malware installation\nand execution.\n\n\n[T1035](https://attack.mitre.org/techniques/T1035/) Service\nExecution\n\n[T1204](https://attack.mitre.org/techniques/T1204/) User\nExecution\n\n\nBalkanDoor’s backdoor can be executed as a service.\n\nBalkanDoor relies on the victim to execute the initial\ninfiltration. The malware is disguised as PDF documents\nor RAR archives with misleading names, in order to entice\nthe intended victim to click on it.\n\n\nPersistence [T1050](https://attack.mitre.org/techniques/T1050/) New Service BalkanDoor can be installed as a new service,\nmimicking legitimate Windows services.\n\n\n-----\n\n**Tactic** **ID** **Name** **Description**\n\n\n[T1060](https://attack.mitre.org/techniques/T1060/) Registry Run\nKeys / Startup\nFolder\n\n\nBalkanDoor can be installed in the Registry Run key, or\ndropped in the Startup folder.\n\n\nPrivilege\nEscalation\n\nDefense\nEvasion\n\n\n[T1134](https://attack.mitre.org/techniques/T1134/) Access Token Manipulation BalkanDoor is able to create a process under\nthe security context of a different user, using\nDuplicateTokenEx, SetTokenInformation or\nCreateProcessAsUserW APIs.\n\n[T1116](https://attack.mitre.org/techniques/T1116/) Code Signing BalkanDoor is digitally signed with code-signing\ncertificates.\n\n\n[T1107](https://attack.mitre.org/techniques/T1107/) File Deletion BalkanDoor deletes files with backdoor commands after\nthe commands have been executed.\n\n\n[T1158](https://attack.mitre.org/techniques/T1158/) Hidden Files\nand\nDirectories\n\n\nBalkanDoor sets attributes of its files to HIDDEN,\nSYSTEM and READONLY.\n\n\n[T1036](https://attack.mitre.org/techniques/T1036/) Masquerading BalkanDoor can be installed as a service with names\nmimicking legitimate Windows services.\n\n\n[T1108](https://attack.mitre.org/techniques/T1108/) Redundant\nAccess\n\n\nOperators of BalkanDoor have been seen deploying a\nsecond malicious tool (BalkanRAT) to preserve remote\naccess in case BalkanDoor is removed.\n\n\nDiscovery [T1082](https://attack.mitre.org/techniques/T1082/) System Information Discovery BalkanDoor collects the computer name from\nthe compromised machine.\n\nCollection [T1113](https://attack.mitre.org/techniques/T1113/) Screen Capture BalkanDoor can capture screenshots of the\ncompromised machine.\n\n\nCommand\nand Control\n\n\n[T1043](https://attack.mitre.org/techniques/T1043/) Commonly Used Port BalkanDoor uses ports 80 and 443 for C&C\ncommunication.\n\n\n[T1090](https://attack.mitre.org/techniques/T1090/) Connection\nProxy\n\n[T1008](https://attack.mitre.org/techniques/T1008/) Fallback\nChannels\n\n[T1071](https://attack.mitre.org/techniques/T1071/) Standard\nApplication\nLayer\nProtocol\n\n14 Aug 2019 - 11:30AM\n\n\nBalkanDoor is capable of identifying a configured proxy\nserver if one exists and then using it to make HTTP\nrequests.\n\nBalkanDoor can communicate over multiple C&C hosts.\n\nBalkanDoor uses HTTP or HTTPS for network\ncommunication.\n\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-14 - In the Balkans, businesses are under fire from a double‑barreled weapon.pdf"
    ],
    "report_names": [
        "2019-08-14 - In the Balkans, businesses are under fire from a double‑barreled weapon.pdf"
    ],
    "threat_actors": [
        {
            "id": "3b046db2-f60e-49ae-8e16-0cf82a4be6fb",
            "created_at": "2022-10-25T16:07:23.427162Z",
            "updated_at": "2025-03-27T02:02:09.79482Z",
            "deleted_at": null,
            "main_name": "Buhtrap",
            "aliases": [
                "Buhtrap",
                "Operation TwoBee",
                "Ratopak Spider",
                "UAC-0008"
            ],
            "source_name": "ETDA:Buhtrap",
            "tools": [
                "AmmyyRAT",
                "Buhtrap",
                "CottonCastle",
                "FlawedAmmyy",
                "NSIS",
                "Niteris EK",
                "Nullsoft Scriptable Install System",
                "Ratopak"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "01d569b1-f089-4a8f-8396-85078b93da26",
            "created_at": "2023-01-06T13:46:38.411615Z",
            "updated_at": "2025-03-27T02:00:02.826863Z",
            "deleted_at": null,
            "main_name": "BuhTrap",
            "aliases": [],
            "source_name": "MISPGALAXY:BuhTrap",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536190,
    "ts_updated_at": 1743041373,
    "ts_creation_date": 1653705973,
    "ts_modification_date": 1653705973,
    "files": {
        "pdf": "https://archive.orkl.eu/95b786ac74c74a585da9676d0b8941da6256e97c.pdf",
        "text": "https://archive.orkl.eu/95b786ac74c74a585da9676d0b8941da6256e97c.txt",
        "img": "https://archive.orkl.eu/95b786ac74c74a585da9676d0b8941da6256e97c.jpg"
    }
}