{
    "id": "22c39700-9ed9-4393-9060-de09bf27d731",
    "created_at": "2023-01-12T15:00:06.136453Z",
    "updated_at": "2025-03-27T02:16:23.232199Z",
    "deleted_at": null,
    "sha1_hash": "51e568b32c82025e69bbb234dabb568c73ae7531",
    "title": "2021-09-30 - New Version Of Apostle Ransomware Reemerges In Targeted Attack On Higher Education",
    "authors": "",
    "file_creation_date": "2022-05-28T00:25:50Z",
    "file_modification_date": "2022-05-28T00:25:50Z",
    "file_size": 1587969,
    "plain_text": "# New Version Of Apostle Ransomware Reemerges In Targeted Attack On Higher Education\n\n**[sentinelone.com/labs/new-version-of-apostle-ransomware-reemerges-in-targeted-attack-on-higher-education/](https://www.sentinelone.com/labs/new-version-of-apostle-ransomware-reemerges-in-targeted-attack-on-higher-education/)**\n\nAmitai Ben Shushan Ehrlich\n\nSentinelLabs has been tracking the activity of Agrius, a suspected Iranian threat actor\noperating in the Middle East, throughout 2020 and 2021 following a set of destructive attacks\n[starting December 2020. Since we last reported on this threat actor in May 2020, Agrius](https://www.sentinelone.com/labs/from-wiper-to-ransomware-the-evolution-of-agrius/)\nlowered its profile and was not observed conducting destructive activity. This changed\nrecently as the threat actor likely initiated a ransomware attack on the Israeli university BarIlan utilizing the group’s custom Apostle ransomware.\n\nAlthough the full technical details of the incident were not disclosed publicly, some\ninformation was released to the public, most notably the ransom demand text file dropped on\nvictim machines. The `.txt file matches that from a new version of Apostle compiled on`\nAugust 15, 2021, the day of the attack.\n\nThe new version of Apostle is obfuscated, encrypted and compressed as a resource in a\nloader we call Jennlog, as it attempts to masquerade payload in resources as log files.\nBefore executing the Apostle payload, Jennlog runs a set of tests to verify that it is not being\nexecuted in an analysis environment based on an embedded configuration. Following the\nanalysis of the Jennlog loader, SentinelLabs retrieved an additional variant of Jennlog, used\nto load and run OrcusRAT.\n\n\n-----\n\n## Jennlog Analysis\n\nJennlog ( 5e5e526a69490399494dcd7195bb6c67 ) is a `.NET loader that deobfuscates,`\ndecompresses and decrypts a `.NET executable from a resource embedded within the file.`\nThe resources within the loader appear to look like log files, and it contains both the binary to\nrun as well as a configuration for the malware’s execution.\n\nJennlog attempts to extract two different resources:\n```\n   helloworld.pr.txt – stores Apostle payload and the configuration.\n   helloworld.Certificate.txt – contains None. If configured to do so, the malware\n\n```\ncompares the MD5 value of the system information (used as system fingerprint) to the\ncontents of this resource.\n\nThe payload hidden in “ helloworld.pr.txt ” appears to look like a log file at first sight:\n\nContents of “ helloworld.pr.txt ” resource embedded within Jennlog\nThe payload is extracted from the resource by searching for a separator word –\n“ Jennifer ”. Splitting the contents of the resource results in an array of three strings:\n\n1. Decoy string – Most likely there to make the log file look more authentic.\n2. Configuration string – Used to determine the configuration of the malware execution.\n3. Payload – An obfuscated, compressed and encrypted file.\n\n## Configuration\n\nThe configuration of Jennlog consists of 13 values, 12 of which are actually used in this\nversion of the malware. In the variants we were able to retrieve, all of these flags are set to 0.\n\n\n-----\n\nJennlog configuration values\nOne of the most interesting flags found here is the certificate flag. If this flag is set, it will\ncause the malware to run only on a specific system. If this system does not match the\nconfigured MD5 fingerprint, the malware either stops operation or deletes itself utilizing the\nfunction `ExecuteInstalledNodeAndDelete(), which creates and runs a BAT file as`\nobserved in other Agrius malware.\n\n\n-----\n\nJennlog `ExecuteInstalledNodeAndDelete() function`\nFollowing all the configuration based-checks, Jennlog continues to unpack the main binary\nfrom within the resource “ helloworld.pr.txt ” by performing the following string\nmanipulations in the function `EditString() on the obfuscated payload:`\n\nReplace all “ \\nLog ” with “ A ”.\nReverse the string.\nRemove all whitespaces.\n\nThis manipulation will result in a long base64-encoded deflated content, which is inflated\nusing the function `stringCompressor.Unzip() . The inflated content highly resembles the`\ncontents of the original obfuscated payload, and it is deobfuscated again using the\n```\nEditString() function.\n\n```\nThe deobfuscation of the inflated content is carried out in a rather peculiar way, being run as\na “catch” statement after attempting to turn a string containing a URL to int, which will always\nresult in an error. The domain presented in the URL was never bought, and highly resembles\nother Agrius malware unpurchased domains, often used as “Super Relays”. Here, however,\nthe domain is not actually contacted.\n\nExecution of `EditString() function as a catch statement`\nFollowing a second run of the `EditString() function, Jennlog decodes the extracted`\ncontent and decrypts it using an implementation of RC4 with a predefined key. The extracted\ncontent found in this sample is a new version of the Apostle ransomware, which is loaded\ninto memory and ran using the parameters given to Jennlog at execution.\n\n\n-----\n\n## Apostle Ransomware Analysis\n\nThe new variant of Apostle ( cbdbda089f7c7840d4daed22c34969fd876315b6 ) embedded\nwithin the Jennlog loader was compiled on August 15, 2021, the day the attack on Bar-Ilan\nuniversity was carried out. Its execution flow is highly similar to the variant described in\nprevious reports, and it even checks for the same Mutex as the previous ransomware\nvariant.\n\nThe message embedded within it, however, is quite different:\n```\nOoops, Your files are encrypted!!! Don't worry,You can return all your files! \nIf you want to restore theme, Send $10000 worth of Monero to following address : \n43JuFUyzfcKQwTzCTHpQoA8uLGtbwFBLyeeXoYEEU5dZLhLT1cZJDk4cytjcgQT7kdjSerJqpEp2gUcH91bjLc\nThen follow this Telegram ID : hxxps://t[.]me/x4ran\n\n```\nThis is the exact same message that was released to the media in the context of the Bar-Ilan\n[ransomware incident, as reported on ynet:](https://www.ynet.co.il/digital/technews/article/rkhrr5llt)\n\nRansom demand text file as seen in Bar-Ilan university\nOther than the ransom demand note, the wallpaper picture used on affected machines was\nalso changed, this time presenting an image of a clown:\n\n\n-----\n\nNew Apostle variant wallpaper image\n\n## OrcusRAT Jennlog Loader\n\nAn additional variant of Jennlog ( 43b810f918e357669be42030a1feb727 ) was uploaded to\nVirusTotal on July 14, 2021 from Iran. This variant is highly similar to the one used to load\nApostle, and contains a similar configuration scheme (all set to 0). It is used to load a variant\nof OrcusRAT, which is extracted from the files resources in a similar manner.\n\nThe OrcusRAT variant ( add7b6b60e746c36a66f5ec233873372 ) extracted from within it\nwas submitted to VT on June 20, 2021 using the same submitter ID from Iran. It seems to\nconnect to an internal IP address – `192.168.178.114, indicating it might have been used`\nfor testing. It also contained the following PDB path:\n```\nC:\\Users\\dou\\Desktop\\repo\\arcu-win\\src\\Orcus\\obj\\Debug\\Orcus.pdb\n\n## Conclusion\n\n```\nAgrius has shown a willingness to strategically wipe systems and has continued to evolve its\ntoolkit to enable ransomware operations. At this time, we don’t know if the actor is committed\nto financially-motivated operations, but we do know the original intent was sabotage. We\nexpect the sort of subterfuge seen here to be deployed in future Agrius operations.\nSentinelLabs continues to track the development of this nascent threat actor.\n\n\n-----\n\n## Technical Indicators\n\nJennlog Loader (Apostle Loader)\n\n5e5e526a69490399494dcd7195bb6c67\nc9428afa269bbf8c48a08a7109c553163d2051e7\n0ba324337b1d76a5afc26956d4dc9f57786483230112eaead5b5c92022c089c7\n\nApostle – Bar-Ilan variant\n\nfc8221382521a40ec0042431a947a3ca\ncbdbda089f7c7840d4daed22c34969fd876315b6\n44c13c46d4f597ea0625f1c87eecffe3cd5dcd257c5fac18a6fa931ba9b5f97a\n\nJennlog Loader (OrcusRAT Loader)\n\n43b810f918e357669be42030a1feb727\n3de36410a99cf3bd8e0c56fdeafa32bbf7625af1\n14659857df1753f720ac797a43a9c3f3e241c3df762de7f50bbbae00feb818c9\n\nOrcusRAT\n\nadd7b6b60e746c36a66f5ec233873372\na35bffc49871bb3a48bdd35b4a4d04d208f23487\n069686119adc13e1785cb7a425611d1ec13f33ae75962a7e50e00414209d1809\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-30 - New Version Of Apostle Ransomware Reemerges In Targeted Attack On Higher Education.pdf"
    ],
    "report_names": [
        "2021-09-30 - New Version Of Apostle Ransomware Reemerges In Targeted Attack On Higher Education.pdf"
    ],
    "threat_actors": [
        {
            "id": "21e01940-3851-417f-9e90-1a4a2da07033",
            "created_at": "2022-10-25T16:07:23.299369Z",
            "updated_at": "2025-03-27T02:02:09.725295Z",
            "deleted_at": null,
            "main_name": "Agrius",
            "aliases": [
                "AMERICIUM",
                "Agonizing Serpens",
                "BlackShadow",
                "DEV-0227",
                "Pink Sandstorm",
                "SharpBoys"
            ],
            "source_name": "ETDA:Agrius",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agrius",
                "BFG Agonizer",
                "BFG Agonizer Wiper",
                "DEADWOOD",
                "DETBOSIT",
                "Detbosit",
                "IPsec Helper",
                "Moneybird",
                "MultiLayer Wiper",
                "PW",
                "PartialWasher",
                "PartialWasher Wiper",
                "SQLShred",
                "Sqlextractor"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "89c0c674-c35d-47a6-bd7c-1e6c1b6beacc",
            "created_at": "2024-05-01T02:03:08.042533Z",
            "updated_at": "2025-03-27T02:05:17.3236Z",
            "deleted_at": null,
            "main_name": "COBALT SHADOW",
            "aliases": [
                "AMERICIUM ",
                "Agrius",
                "BlackShadow",
                "DEV-0227 ",
                "Malek Team",
                "Pink Sandstorm ",
                "Agonizing Serpens "
            ],
            "source_name": "Secureworks:COBALT SHADOW",
            "tools": [
                " DEADWOOD",
                " Fantasy wiper",
                " Host2IP",
                " IPsec Helper",
                " Jennlog Loader",
                " MiniDump",
                " Moneybird ransomware",
                " PSexec",
                " Plink",
                " Sandals",
                " SecretsDump",
                " SoftPerfect Network Scanner",
                "Apostle"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4023e661-f566-4b5b-a06f-9d370403f074",
            "created_at": "2024-02-02T02:00:04.064685Z",
            "updated_at": "2025-03-27T02:00:03.304692Z",
            "deleted_at": null,
            "main_name": "Pink Sandstorm",
            "aliases": [
                "Agonizing Serpens",
                "AMERICIUM",
                "BlackShadow",
                "DEV-0022",
                "Agrius"
            ],
            "source_name": "MISPGALAXY:Pink Sandstorm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7d982d5b-3428-483c-8804-c3ab774f1861",
            "created_at": "2024-11-01T02:00:52.70975Z",
            "updated_at": "2025-03-27T02:00:55.517246Z",
            "deleted_at": null,
            "main_name": "Agrius",
            "aliases": [
                "Agrius",
                "Pink Sandstorm",
                "AMERICIUM",
                "Agonizing Serpens",
                "BlackShadow"
            ],
            "source_name": "MITRE:Agrius",
            "tools": [
                "NBTscan",
                "Mimikatz",
                "IPsec Helper",
                "Moneybird",
                "MultiLayer Wiper",
                "DEADWOOD",
                "BFG Agonizer",
                "ASPXSpy"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535606,
    "ts_updated_at": 1743041783,
    "ts_creation_date": 1653697550,
    "ts_modification_date": 1653697550,
    "files": {
        "pdf": "https://archive.orkl.eu/51e568b32c82025e69bbb234dabb568c73ae7531.pdf",
        "text": "https://archive.orkl.eu/51e568b32c82025e69bbb234dabb568c73ae7531.txt",
        "img": "https://archive.orkl.eu/51e568b32c82025e69bbb234dabb568c73ae7531.jpg"
    }
}