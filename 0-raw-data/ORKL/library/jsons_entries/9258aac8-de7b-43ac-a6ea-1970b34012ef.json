{
    "id": "9258aac8-de7b-43ac-a6ea-1970b34012ef",
    "created_at": "2023-01-12T15:10:05.462107Z",
    "updated_at": "2025-03-27T02:06:06.670087Z",
    "deleted_at": null,
    "sha1_hash": "d14f719244231186162e81f1e2e88058d69ab50e",
    "title": "2015-09-24 - Kovter malware learns from Poweliks with persistent fileless registry update",
    "authors": "",
    "file_creation_date": "2022-05-28T18:19:47Z",
    "file_modification_date": "2022-05-28T18:19:47Z",
    "file_size": 374083,
    "plain_text": "# Endpoint Protection\n\n**[symantec.com/connect/blogs/kovter-malware-learns-poweliks-persistent-fileless-registry-update](https://www.symantec.com/connect/blogs/kovter-malware-learns-poweliks-persistent-fileless-registry-update)**\n\nSep 24, 2015 08:55 AM\n\n[A L Johnson](https://community.broadcom.com/symantecenterprise/network/members/profile?UserKey=cbd453fd-3ce1-4c47-af77-d746256f9bc4)\n\n[Poweliks made headlines in 2014 as the first persistent, fileless, registry-based malware.](http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/evolution-of-poweliks.pdf)\n[This technique had not been seen before Poweliks (Trojan.Poweliks) arrived, but it was only](http://www.symantec.com/security_response/writeup.jsp?docid=2014-080408-5614-99)\n[a matter of time until other malware authors adopted it. A variant of Kovter (Trojan.Kotver),](https://www.symantec.com/security_response/writeup.jsp?docid=2015-082817-0932-99)\nfirst seen in May 2015, looks to be one of the first to incorporate techniques from Poweliks\nin order to evade detection and remain persistent on the compromised computer.\n\nWhen the new Kovter variant compromises a computer, the Trojan has the ability to reside\nonly in the registry and not maintain a presence on disk. It accomplishes this by using\nregistry tricks in an attempt to evade detection. The threat is also memory resident and\nuses the registry as a persistence mechanism to ensure it is loaded into memory when the\ninfected computer starts up.\n\n\n-----\n\nThe Kovter malware family has been around since at least 2013 and has evolved over time.\nThe threat rose to prominence in 2013 and 2014 thanks to its association with traditional\n[ransomware (Trojan.Ransomlock.AK) which locks a victim’s computer screen and displays](https://www.symantec.com/security_response/writeup.jsp?docid=2014-040111-0605-99)\na message demanding a fine for illegal activity. However, Kovter itself is known to perform\nclick-fraud activities.\n\n**A fileless threat**\nSimilar to Poweliks, Kovter (version 2.0.3 onwards) has memory-resident, fileless\ncapabilities and uses several techniques to persist in the registry. During initial infection,\nKovter checks to see if [PowerShell is already installed on the compromised computer. If](https://en.wikipedia.org/wiki/Windows_PowerShell)\nPowerShell is not found on the computer and internet access is available, then the Trojan\ndownloads a version of the framework. If no internet access is available at the time of\ninfection, then Kovter reverts to being a more traditional file-based malware.\n\nIn a fileless infection, Kovter adds a value to one or more of the registry run keys to execute\nJavaScript using the legitimate MSHTA program.\n\n_Figure 1. Registry run key value used to execute the malicious JavaScript_\n\nOnce executed, this JavaScript runs another layer of JavaScript from a different Kovter\nregistry entry. This second JavaScript decodes and executes a malicious Kovter PowerShell\nscript stored within the same JavaScript.\n\n_Figure 2. Kovter registry entry containing second JavaScript_\n\nThe PowerShell script then executes shellcode that decrypts and loads the main Kovter\nmodule into memory from a registry entry as seen in figure 2. After a fileless infection,\nKovter then deletes the initial file infector from disk. A similar technique was implemented\nby Poweliks.\n\n**Protecting the registry entry**\nSimilar to Poweliks, Kovter attempts to protect its registry entries by using a value name\nthat starts with a null or 0 byte character followed by a string of hexadecimal characters\n(such as \"\\x007a865e5da\" where \"\\x00\" is the null character). The null character makes it\ndifficult to view the run key values using tools such as Regedit, as they expect registry\nvalues to use printable characters.\n\n\n-----\n\n_Figure 3. Regedit error when opening Kovter’s run key_\n\n**Distribution**\nSimilar to other common threat actors, the attackers behind Kovter have opted for an\naffiliate business model to push their threat onto victims’ computers. This has led to the\nTrojan’s distribution method changing overtime. Lately, these methods have included\n[malvertisment campaigns targeting adult content websites and news sites. The following](https://en.wikipedia.org/wiki/Windows_PowerShell)\n[exploit kits have reportedly been used to spread the Kovter malware through these attacks:](http://malware.dontneedcoffee.com/2015/07/kovter-adfraud-is-updating-flash-for-you.html)\n\nFiesta\nAngler\nNuclear\nNeutrino\nSweet Orange\n\nMore recently, Kovter has been one of many threats included in a spam campaign’s\nmalicious file attachments. These attachments arrive in various forms, such as .zip files\ncontaining malicious JavaScript or .scr files. If the files are executed, then they download\nKovter and other malware onto the spam recipient’s computer.\n\n\n-----\n\n_Figure 4. Example of malicious spam emails spreading Kovter_\n\n**Prevalence**\nWhile there are no indications to suggest that Kovter is targeting specific regions,\nSymantec’s telemetry clearly shows that the US is the most affected region. Other impacted\nareas include the UK, Canada, Germany, Australia, and Japan.\n\n\n-----\n\n_Figure 5. Top 10 regions reporting Kovter detections_\n\n**Conclusion**\nIt was inevitable that other malware authors would implement the techniques used by\nPoweliks. With these updates, Kovter’s association with ransomware no longer aligned with\nits stealthy, persistent nature. This has led Kovter to continue its click-fraud activities,\nallowing the attackers to take advantage of Trojan’s stealth capabilities and potential\nlongevity of infection. However, if the malware authors feel that this business model is not\nprofitable enough, then they are still in a position to hold infected computers to ransom.\n\nThe Kovter malware family has continually evolved since it was first discovered and shows\nno signs of leaving the threat landscape anytime soon.\n\n**Removal tool**\nIf you believe you have been affected by Kovter or if an intrusion protection signature\nrelated to the threat has triggered on your computer, then you should run the following\nremoval tool:\n\n[Trojan.Kotver Removal Tool](https://www.symantec.com/security_response/writeup.jsp?docid=2015-092321-2230-99)\n\nSymantec and Norton products detect Kovter samples through the following detections:\n\n\n-----\n\n**Antivirus detections**\n\n**Heuristic detections**\n\n**Reputation detections**\n\n**Intrusion protection signatures**\n\n[Symantec and Norton customers that use the Symantec.Cloud service are also protected](http://www.symantec.com/products-solutions/families/?fid=symantec-cloud)\nfrom the spam messages which distribute this malware.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-09-24 - Kovter malware learns from Poweliks with persistent fileless registry update.pdf"
    ],
    "report_names": [
        "2015-09-24 - Kovter malware learns from Poweliks with persistent fileless registry update.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536205,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1653761987,
    "ts_modification_date": 1653761987,
    "files": {
        "pdf": "https://archive.orkl.eu/d14f719244231186162e81f1e2e88058d69ab50e.pdf",
        "text": "https://archive.orkl.eu/d14f719244231186162e81f1e2e88058d69ab50e.txt",
        "img": "https://archive.orkl.eu/d14f719244231186162e81f1e2e88058d69ab50e.jpg"
    }
}