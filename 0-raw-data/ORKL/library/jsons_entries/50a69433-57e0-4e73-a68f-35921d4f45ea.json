{
    "id": "50a69433-57e0-4e73-a68f-35921d4f45ea",
    "created_at": "2022-10-25T16:48:18.638863Z",
    "updated_at": "2025-03-27T02:17:11.230863Z",
    "deleted_at": null,
    "sha1_hash": "d6f66a51549b7c2090135e8cb8c40a68c152018d",
    "title": "Operation Ghost",
    "authors": "ESET",
    "file_creation_date": "2019-10-09T10:16:20Z",
    "file_modification_date": "2019-10-09T10:16:26Z",
    "file_size": 2430957,
    "plain_text": "# OPERATION GHOST\n## The Dukes aren’t back — they never left\n\n#### Matthieu Faou Mathieu Tartare Thomas Dupuy\n\n\n-----\n\n#### TABLE OF CONTENTS\n\n1. Executive summary  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 4\n\n2. Background .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 4\n\n2.1 Timeline .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  4\n\n2.2 Targets .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  5\n\n2.3 Tools and tactics .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  6\n\n3. Operation Ghost  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   7\n\n3.1 Targets and timeline .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  7\n\n3.2 Attribution to the Dukes  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  8\n\n3.3 Tactics and tools .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  10\n\n3.4 Operational times  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 11\n\n4. Technical analysis .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 12\n\n4.1 Compromise vector .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  12\n\n4.2 PolyglotDuke: the first stage .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 12\n\n4.3 RegDuke: a first-stage implant .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  18\n\n4.4 MiniDuke backdoor: the second stage .   .   .   .   .   .   .   .   .   .   .   .   . 21\n\n4.5 FatDuke: the third stage  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 23\n\n4.6 LiteDuke: the former third stage  .   .   .   .   .   .   .   .   .   .   .   .   .   .  30\n\n5. Conclusion .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  33\n\n6. Bibliography  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 34\n\n7. Indicators of Compromise .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  . 36\n\n7.1 Hashes  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  36\n\n7.2 Network .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 36\n\n8. MITRE ATT&CK techniques  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 38\n\n\n-----\n\n#### LIST OF TABLES\n\nTable 1 _List of parameters used to generate GET request to the C&C server  .   .   .   .  14_\n\nTable 2 _Example of redirection from the C&C servers’ root URLs  .   .   .   .   .   .   .   . 16_\n\nTable 3 _List of execution type combination and their corresponding behavior  .   .   .   . 18_\n\nTable 4 _RegDuke Windows registry keys .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   19_\n\nTable 5 _Hardcoded User-Agent .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   25_\n\nTable 6 _FatDuke backdoor commands  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  27_\n\nTable 7 _User-Agent strings used by LiteDuke .   .   .   .   .   .   .   .   .   .   .   .   .   .  33_\n\n#### LIST OF FIGURES\n\nFigure 1 _Dukes history timeline– newly discovered items related to Operation Ghost_\n_are shaded  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 6_\n\nFigure 2 _Historical malicious email example.  .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 7_\n\nFigure 3 _Decoy document opened by the malicious attachment .   .   .   .   .   .   .   .   . 7_\n\nFigure 4 _Reddit post containing an encoded C&C URL  .   .   .   .   .   .   .   .   .   .   .   9_\n\nFigure 5 _Timeline of Operation Ghost  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 9_\n\nFigure 6 _Comparison of a custom string encryption function found in PolyglotDuke_\n_and in OnionDuke samples from 2013 .   .   .   .   .   .   .   .   .   .   .   .   .   .  10_\n\nFigure 7 _Comparison of the same function in MiniDuke from 2014 and in_\n_MiniDuke from 2018 .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 11_\n\nFigure 8 _Summary of Operation Ghost malware platform  .   .   .   .   .   .   .   .   .   .  12_\n\nFigure 9 _Dukes operational hours .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  13_\n\nFigure 10 Example of a public post containing an encoded C&C URL  .   .   .   .   .   .   .  14\n\nFigure 11 C&C response with a path to an image to download .   .   .   .   .   .   .   .   .  16\n\nFigure 12 Communication sequence with the C&C server .   .   .   .   .   .   .   .   .   .   .  16\n\nFigure 13 Embedded blob format .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 17\n\nFigure 14 Decompiled hash signature verification procedure .   .   .   .   .   .   .   .   .   .  18\n\nFigure 15 Public key used to verify the hash signature .   .   .   .   .   .   .   .   .   .   .   .  18\n\nFigure 16 Encrypted blob format after decryption .   .   .   .   .   .   .   .   .   .   .   .   .  18\n\nFigure 17 Obfuscated RegDuke sample  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   19\n\nFigure 18 RegDuke. The path, password and salt are hardcoded in this example.  .   .   .  19\n\nFigure 19 Decryption of RegDuke payload .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   20\n\nFigure 20 Dropbox backdoor configuration (redacted) .   .   .   .   .   .   .   .   .   .   .   . 20\n\nFigure 21 Example of two pictures downloaded from the Dropbox directory .  .  .  .  . 21\n\nFigure 22 Loop extracting a payload from the pixels of a downloaded picture .   .   .   .   21\n\nFigure 23 The least significant bits of each color of each pixel are extracted to recover\n_the hidden data .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  21_\n\nFigure 24 Comparison between a blue of value 255 and a blue of value 248 .   .   .   .   .  22\n\n\n-----\n\nFigure 25 Invalid digital signature added to the backdoor .   .   .   .   .   .   .   .   .   .   .  22\n\nFigure 26 Control flow flattening used to obfuscate the MiniDuke backdoor  .   .   .   .   . 23\n\nFigure 27 Post request to the C&C server that looks like a regular jpeg file upload  .   .   . 23\n\nFigure 28 FatDuke configuration data in the PE resources  .   .   .   .   .   .   .   .   .   .   24\n\nFigure 29 FatDuke configuration example  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 25\n\nFigure 30 FatDuke C&C protocol .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 26\n\nFigure 31 Additional image tag sent by FatDuke C&C .   .   .   .   .   .   .   .   .   .   .   .  27\n\nFigure 32 C&C response including most of a valid PNG header and an encrypted\n_command for FatDuke  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   . 27_\n\nFigure 33 Example of commands sent to FatDuke .   .   .   .   .   .   .   .   .   .   .   .   .  28\n\nFigure 34 FatDuke obfuscation – String stacking .   .   .   .   .   .   .   .   .   .   .   .   .   29\n\nFigure 35 FatDuke obfuscation – Opaque predicate  .   .   .   .   .   .   .   .   .   .   .   .   29\n\nFigure 36 FatDuke obfuscation – Junk function call .   .   .   .   .   .   .   .   .   .   .   .   30\n\nFigure 37 FatDuke obfuscation – Junk function return value .   .   .   .   .   .   .   .   .   . 30\n\nFigure 38 FatDuke obfuscation – Chromium strings  .   .   .   .   .   .   .   .   .   .   .   .  30\n\nFigure 39 LiteDuke unpacking process .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  31\n\nFigure 40 Curious phone number left by the attackers .   .   .   .   .   .   .   .   .   .   .   .  31\n\nFigure 41 Assembler used by the developer (screenshot of DIE analysis) .   .   .   .   .   .  32\n\nFigure 42 Multiple while loops instead of a backdoor switch case  .   .   .   .   .   .   .   .  33\n\nFigure 43 List of LiteDuke command IDs  .   .   .   .   .   .   .   .   .   .   .   .   .   .   .   .  33\n\nFigure 44 LiteDuke C&C domain, resources and parameters  .   .   .   .   .   .   .   .   .   . 34\n\n\n-----\n\n#### 1. EXECUTIVE SUMMARY\n\nIt is exceptionally rare for a well-documented threat actor, previously implicated in very high-profile attacks,\nto stay completely under the radar for several years. Yet, in the last three years that is what APT group\nthe Dukes (aka APT29 and Cozy Bear) has done. Despite being well known as one of the groups to hack the\nDemocratic National Committee in the run-up to the 2016 US election, the Dukes has received little subsequent attention. The last documented campaign attributed to them is a phishing campaign against\nthe Norwegian government that dates back to January 2017.\n\nIn this white paper, we describe how we uncovered that the Dukes had been running successful espionage\ncampaigns while avoiding public scrutiny, thanks to stealthy communication techniques and retooling.\nWe call these newly uncovered Dukes campaigns, collectively, Operation Ghost, and describe how the group\nhas been busy compromising government targets, including three European Ministries of Foreign Affairs and\nthe Washington DC embassy of a European Union country, all without drawing attention to their activities.\n\nKey points in this white paper:\n\nThe Dukes never stopped their espionage activities.\n\n- _Operation Ghost likely started in 2013._\n\n- The last known activity linked to Operation Ghost occurred in June 2019.\n\n- ESET researchers identified at least three victims: all European Ministries of Foreign Affairs including\nthe Washington DC embassy of a European Union country.\n\n- The Dukes have used four new malware families in this campaign: PolyglotDuke, RegDuke, FatDuke\nand LiteDuke.\n\n- _Operation Ghost uses a previously documented Dukes backdoor: MiniDuke._\n\n- The Dukes have leveraged online services such as Twitter, Imgur and Reddit to act as primary Command\nand Control (C&C) channels for their first-stage malware.\n\n- The Dukes have used very stealthy techniques such as steganography to hide communications between\ncompromised machines and their C&C servers.\n\n[For any inquiries related to this white paper, contact us at threatintel@eset.com.](mailto:threatintel@eset.com)\n\n#### 2. BACKGROUND\n\nThe Dukes, also known as APT29 and Cozy Bear, is an infamous cyberespionage group active since at least\n2008. In particular, it is known for being one of the adversaries to have breached the Democratic National\nCommittee during the 2016 US presidential election [1]. It was even featured in a joint report issued by the\nFBI and the Department of Homeland Security (DHS), as part of malicious cyber-activities the report dubbed\nGrizzly Steppe [2]. That report was published in 2017 and describes malicious activities that occurred around\nthe presidential election of 2016.\n\nThis section is a summary of the group’s previously documented activities to refresh the reader’s memory,\nsince the last related publication dates from almost three years ago. Our most recent discoveries are detailed\nin the subsequent sections of this white paper.\n\n##### 2.1 Timeline\n\nEven though the group’s activities are believed to have started in 2008, the first public report was released\nin 2013 with the analysis of MiniDuke by Kaspersky [3]. Over the next two years, multiple reports dissected\nthe Dukes’ arsenal, including a comprehensive summary by F-Secure of the group’s activities from 2008\nto 2015 [4].\n\nOne of the most recent attacks that we can link to the Dukes is the January 2017 phishing attempt against\nthe Ministry of Foreign Affairs, the Labour Party and the Armed Forces of Norway [5]. Since then, most security\nexperts have believed the Dukes went dark or completely changed their arsenal to pursue their mission.\n\n\n-----\n\nIn November 2018, a strange phishing campaign hit dozens of different organizations in the United States,\nincluding government agencies, and think tanks. The attack leveraged a malicious Windows shortcut\n(a .lnk file) that bore similarities to a malicious shortcut used by the Dukes in 2016. However, that earlier\nsample was available in a public malware repository for many years, allowing another actor to easily conduct\na false-flag operation. In addition, there is no evidence that any custom malware used only by the Dukes\nwas employed during this attack. From FireEye’s detailed analysis of the attack [6], it was not possible\nto make a high-confidence attribution to this threat actor.\n\nFigure 1 summarizes the important events of the Dukes history. Some activities related to Operation Ghost\nare also presented to help understand the overlap between all the events.\n\n\n### 2008\n\nDukes’ first known\nactivities\n\n### 2017\nAugust\n\nFirst known deployment\nof the RegDuke malware\n\n### 2018\nOctober\n\nLast known Twitter\naccount registered\nby the Dukes\n\n##### 2.2 Targets\n\n\n### 2013\n\nFirst public report\nby Kaspersky Labs\n\n### 2017\n\nGrizzly Steppe report\nby the FBI and the DHS\n\n### 2019\nJune\n\nLatest observed activity\n\n\n### 2013\n\n\n_Newly discovered_\n_items related_\n_to Operation Ghost_\n\n### 2015\n\nAttack against\nthe US Democratic\nNational Committee\n(discovered in 2016)\n\n\nFigure 1 // Dukes history timeline\n\n\nOver the years, it has been possible to draw the big picture of the Dukes main targets. The group is primarily\ninterested in spying on governments either in the West or in former USSR countries. Besides governments,\nthe group has also targeted various organizations linked to NATO, think tanks, and political parties.\n\nThis targeting suggests a clear interest in collecting information allowing a better understanding of future\ninternational political decisions, which would seem of most interest to a government. Unlike other groups\nsuch as GreyEnergy [7] and TeleBots [8], it is important to note that we have never seen the Dukes engaged\nin cybersabotage operations.\n\nSurprisingly though, the group also has conducted spying operations outside its main focus. In 2013,\nKaspersky researchers found evidence that part of the Dukes toolset had been used against drug dealers\nin Russia [9]. This may suggest that this toolset is not only used for collecting foreign intelligence but also\nfor conducting LE investigations of criminal activities.\n\n\n-----\n\n##### 2.3 Tools and tactics\n\nThe Dukes group is known to be a major player in the espionage scene. It is associated with a large\ntoolset with more than ten different malware families written in C/C++ [10], PowerShell [11], .NET [12]\nand Python [13]. It has also adopted living-off-the-land tactics, misusing standard IT tools such as PsExec\nand Windows Management Instrumentation (WMI).\n\nAs mentioned before, we invite our readers to read the F-Secure summary [4] for an analysis of the earlier\nmalware platforms used by this threat actor.\n\n###### Delivery\n\nThe group’s main initial tactic to breach a network is to send spearphishing emails that contain a link\nor an attachment. Figure 2 is an example of one such campaign, which occurred at the end of 2016. In order\nto increase the attackers’ chances, it is designed to be a subject of particular interest of the recipient. This\nis different from mass-spreading malicious email campaigns where the same email is sent to hundreds\nor thousands of people by crimeware actors.\n\nFigure 2 // Historical malicious email example.\n_[Source: https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/](https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/)_\n\nWhen targets click on these malicious links or attachments, a .zip archive that contains a malicious,\nmacro-enabled Word document and a decoy (as shown in Figure 3) will be downloaded. If victims then\nopen the malicious document and enable the macro, it will then install the PowerDuke backdoor [14].\nIn other cases, malicious Windows shortcuts (.lnk files) have been used instead of Word documents\nwith malicious macros.\n\nFigure 3 // Decoy document opened by the malicious attachment\n\n\n-----\n\nHowever, this is not the only method used by the Dukes to gain initial access. In 2014, the Dukes started\nusing two mass-spreading methods to deliver the OnionDuke implant:\n\n- Trojanized pirated applications downloaded via BitTorrent\n\n- A malicious TOR exit node to trojanize downloaded applications on the fly [15] [16]\n\nOnionDuke has some capabilities outside the standard espionage features, such as a Denial of Service (DoS)\nmodule, but we have not observed them used in the wild.\n\nFinally, the Dukes are also known for using multiple implants to compromise a target. It is very common\nto see an implant delivering another one to regain control of a system.\n\n###### Command and Control (C&C)\n\nThe Dukes have employed several interesting tactics to hide the communications between the implants\nand their C&C servers, including the use of social media platforms and steganography.\n\nMiniDuke [17] and HammerDuke [12] leveraged Twitter to host their C&C URLs. In addition, they use\na Domain Generation Algorithm (DGA) to generate new Twitter handles. Each time the malware generates\na new handle, it fetches the Twitter page corresponding to that handle and searches the page for a specific\npattern, which is the encrypted C&C URL.\n\nIn CloudDuke [18], the operators leveraged cloud storage services such as OneDrive as their C&C channels.\nThey were not the first group to use this technique, but it is generally effective for the attackers\nas it is harder for defenders to spot hostile connections to legitimate cloud storage services than\nto other “suspicious” or low-reputation URLs.\n\n[Moreover, the Dukes like to use steganography to hide data, such as additional payloads, in pictures.](https://www.virusradar.com/en/glossary/steganography)\nIt allows them to blend into typical network traffic by transferring valid images while its true purpose\nis to allow the backdoor to communicate with the C&C server. This technique has been described\nin Volexity’s PowerDuke blogpost [14].\n\n#### 3. OPERATION GHOST\n\nAfter 2017, it was not clear how the Dukes evolved. Did they totally stop their activities? Did they fully\nre-write their tools and change their tradecraft?\n\nWe spent months apparently chasing a ghost then, a few months ago, we were able to attribute several\ndistinct intrusions to the Dukes. During the analysis of those intrusions, we uncovered several new malware\nfamilies: PolyglotDuke, RegDuke and FatDuke. We call the Dukes’ campaigns using these newly discovered\ntools Operation Ghost.\n\n##### 3.1 Targets and timeline\n\nWe believe Operation Ghost started in 2013 and was still ongoing as of this writing. Our research shows\nthat the Ministry of Foreign Affairs in at least three different countries in Europe are affected by this campaign. We also have discovered an infiltration by the Dukes at the Washington, DC embassy of a European\nUnion country.\n\nThis targeting is not surprising, and it shows that the Dukes are still active in high-profile organizations.\nWe also believe that more organizations around the world might be affected but due to the use of unique\nC&C infrastructure for each victim, we were not able to identify other targets.\n\nOne of the first traces of this campaign is to be found on Reddit in July 2014. Figure 4 shows a message\nposted by one of the Dukes’ operators. The strange string using an unusual charset is the encoded URL\nof a C&C server and is used by PolyglotDuke as described in section 4.2.\n\n\n-----\n\nFigure 4 // Reddit post containing an encoded C&C URL\n\nFigure 5 presents the timeline of Operation Ghost. As it is based on ESET telemetry, it might be only a partial\nview of a broader campaign.\n\n\n### 2013\nSeptember\n\nFirst known\ncompilation timestamp\nof PolyglotDuke\n\n### 2019\nOctober\n\nPublication\nof this report\n\n\n### 2014\nJuly\n\nPost on Reddit\ncontaining an encoded\nC&C URL\n\n### 2019\nJune\n\nLatest known FatDuke\nsample deployed\nin the wild\n\n\n### 2016\nSeptember\n\nFirst known deployment\nin the wild of a FatDuke\nsample\n\n### 2018\nOctober\n\nLast Twitter account\nregistered by the Dukes\n\n\n### 2017\nAugust\n\nFirst known deployment\nin the wild of a RegDuke\nsample\n\n\nFigure 5 // Timeline of Operation Ghost\n\n##### 3.2 Attribution to the Dukes\n\n_It is important to note that when we describe so-called “APT groups”, we’re making connections_\n\n_based on technical indicators such as code similarities, shared C&C infrastructure, malware_\n\n_execution chains, and so on. We’re typically not directly involved in the investigations_\n\n_and identification of the individuals writing the malware and/or deploying it, and the interpersonal_\n\n_relationships between them. Furthermore, the term “APT group” is very loosely defined, and often_\n\n_used merely to cluster the abovementioned malware indicators. This is also one of the reasons_\n\n_why we refrain from speculation with regard to attributing attacks to nation states and such._\n\nOn one hand, we noticed numerous similarities in the tactics of this campaign in comparison to previously\ndocumented ones:\n\n- Use of Twitter (and other social websites such as Reddit) to host C&C URLs.\n\n- Use of steganography in pictures to hide payloads or C&C communications.\n\n- Use of Windows Management Instrumentation (WMI) for persistence.\n\n\n-----\n\nWe also noticed important similarities in the targeting:\n\n- All the known targets are Ministries of Foreign Affairs.\n\n- Two of the three known targeted organizations were previously compromised by other Dukes malware\nsuch as CozyDuke, OnionDuke or MiniDuke.\n\n- On some machines compromised with PolyglotDuke and MiniDuke, we noticed that CozyDuke\nwas installed only a few months before.\n\nHowever, an attribution based only on the presence of known Dukes tools on the same machines should be\ntaken with a grain of salt. We also found two other APT threat actors – Turla [19] and Sednit [20] – on some\nof the same computers.\n\nOn the other hand, we were able to find strong code similarities between already documented samples\nand samples from Operation Ghost. We cannot discount the possibility of a false flag operation; however,\nthis campaign started while only a small portion of the Dukes’ arsenal was known. In 2013, at the first known\ncompilation date of PolyglotDuke, only MiniDuke had been documented and threat analysts were not\nyet aware of the importance of this threat actor. Thus, we believe Operation Ghost was run simultaneously\nwith the other campaigns and has flown under the radar until now.\n\nPolyglotDuke (SHA-1: D09C4E7B641F8CB7CC86190FD9A778C6955FEA28), documented in detail in section 4.2\nuses a custom encryption algorithm to decrypt the strings used by the malware. We found functionally\nequivalent code in an OnionDuke sample (SHA-1: A75995F94854DEA8799650A2F4A97980B71199D2)\nthat was documented by F-Secure in 2014 [16]. It is interesting to note that the value used to seed\nthe srand function is the compilation timestamp of the executable. For instance, 0x5289f207\ncorresponds to Mon 18 Nov 2013 10:55:03 UTC.\n\nThe IDA screenshots in Figure 6 show the two similar functions.\n\nPolyglotDuke OnionDuke\n\nFigure 6 // Comparison of a custom string encryption function found in PolyglotDuke\nand in OnionDuke samples from 2013\n\nSimilarly, the recent samples of the MiniDuke backdoor bear similarities with samples documented more\nthan five years ago. Figure 7 is the comparison of a function in a MiniDuke backdoor listed by Kaspersky\nin 2014 [21] (SHA-1: 86EC70C27E5346700714DBAE2F10E168A08210E4) and a MiniDuke backdoor\n(SHA-1: B05CABA461000C6EBD8B237F318577E9BCCD6047) compiled in August 2018.\n\n\nPolyglotDuke OnionDuke\n\n\n-----\n\nMiniDuke from 2014\n\nMiniDuke from 2018\n\n\nFigure 7 // Comparison of the same function in MiniDuke from 2014 and in MiniDuke from 2018\n\nGiven the numerous similarities between other known Dukes campaigns and Operation Ghost, especially\nthe strong code similarities, and the overlap in time with previous campaigns, we assess with high\nconfidence that this operation is run by the Dukes.\n\n##### 3.3 Tactics and tools\n\nIn Operation Ghost, the Dukes have used a limited number of tools, but they have relied on numerous\ninteresting tactics to avoid detection.\n\nFirst, they are very persistent. They steal credentials and use them systematically to move laterally on the\nnetwork. We have seen them using administrative credentials to compromise or re-compromise machines\non the same local network. Thus, when responding to a Dukes compromise, it is important to make sure\nto remove every implant in a short period of time. Otherwise, the attackers will use any remaining implant\nto compromise the cleaned systems again.\n\nSecond, they have a sophisticated malware platform divided in four stages:\n\n- PolyglotDuke, which uses Twitter or other websites such as Reddit and Imgur to get its C&C URL.\nIt also relies on steganography in pictures for its C&C communication.\n\n- RegDuke, a recovery first stage, which uses Dropbox as its C&C server. The main payload is encrypted\non disk and the encryption key is stored in the Windows registry. It also relies on steganography as above.\n\n- MiniDuke backdoor, the second stage. This simple backdoor is written in assembly. It is very similar\nto older MiniDuke backdoors.\n\n- FatDuke, the third stage. This sophisticated backdoor implements a lot of functionalities and has a very\n[flexible configuration. Its code is also well obfuscated using many opaque predicates. They re-compile](https://en.wikipedia.org/wiki/Opaque_predicate)\nit and modify the obfuscation frequently to bypass security product detections.\n\nFigure 8 is a summary of the malware platform of Operation Ghost. During our investigation, we also found\na previously unknown (and apparently now retired) third-stage backdoor, LiteDuke, that was used back\nin 2015. For the sake of historical completeness, it is analyzed in section 4.6.\n\n\n-----\n\nOnline Service\n\nStage 1\n\nDownloads a picture Downloads a picture\nfrom the C&C server from the Dropbox account\n\nDecrypt Decode, decrypt\nand drop and drop\n\nMiniDuke\n\nStage 2\n\nDownloads a picture\nfrom the C&C server\n\nDecrypt\nand drop\n\nStage 3 FatDuke\n\nFigure 8 // Summary of Operation Ghost malware platform\n\nThird, we also noticed that the operators avoid using the same C&C network infrastructure between\ndifferent victim organizations. This kind of compartmentalization is generally only seen by the most\nmeticulous attackers. It prevents the entire operation from being burned when a single victim discovers\nthe infection and shares the related network IoCs with the security community.\n\n##### 3.4 Operational times\n\nWhen it comes to cyberespionage, it is not uncommon for the malware developers and operators to follow\nthe standard working hours of the country where they are located. For instance, we previously showed that\nSednit operators were generally working from 9 AM to 5PM in the UTC+3 time zone [20]. Previously, FireEye\nresearchers noticed that the Dukes were also mainly operating in the UTC+3 time zone [12].\n\nFor Operation Ghost, we compiled three different types of timestamp in order to have an idea of their\noperational times:\n\n- The time at which they uploaded C&C pictures to the Dropbox account used by RegDuke\n\n- The time at which they posted encoded C&C URLs on the social media accounts used by PolyglotDuke\n\n- The compilation timestamps of dozens of samples. We believe they were not tampered with,\nas they are consistent with what we see in ESET telemetry data.\n\nIt should be noted that some of these timestamps may have been generated by an automated command\nsystem or an automated build system.\n\n|ds a picture C&C server|Col2|\n|---|---|\n|Decrypt||\n|and drop||\n\n\n-----\n\nFigure 9 shows the distribution of the operational hours of the Dukes in the three different time zones. The\ndistribution aligns well with working hours in a UTC+2 or UTC+3 time zone, with occasional work during the\nnight. This might be explained by a need to work at the same time as some of their victims.\n\n**Operational Hours**\n\n\n0\n\n\n**Hour**\n\n|Col1|Col2|Col3|Col4|Col5|Hour|Col7|Col8|Col9|Col10|Col11|Col12|Col13|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n0\n\n\n2 4 6 8 10 12 14 16 18 20 22\n\nFigure 9 // Dukes operational hours\n\n\n#### 4. TECHNICAL ANALYSIS\n\nIn this part, we present the technical analyses of the different malware stages used in Operation Ghost.\n\n##### 4.1 Compromise vector\n\nDespite having analyzed the Dukes activities in several different organizations, we were not able to find the\ninitial compromise vector. The group is known for sending well-crafted malicious emails, but we did not find\nany such samples.\n\nIt should also be noted that two of the three targeted organizations we identified had previously been\ncompromised by the Dukes, mainly in 2015. As such, it is highly possible that the attackers kept control over\nthe compromised networks during this whole period. We observed them pivoting in an already-compromised\nnetwork using lateral movement tools like PsExec and stolen administrative credentials. As such, from only a\nfew compromised machines, they are able to expand their operations.\n\n##### 4.2 PolyglotDuke: the first stage\n\nPolyglotDuke is a downloader that is used to download and drop the MiniDuke backdoor. As mentioned\nin section 3.2 and shown in Figure 6, this downloader shares several similarities with other samples from\nprevious Dukes campaigns such as the use of Twitter to retrieve and decode its C&C server address, as well\nas a custom string encryption implementation. Both 32- and 64-bit versions of PolyglotDuke were observed\nand have similar behavior. We dubbed this downloader PolyglotDuke in reference to its use of charsets from\ndifferent languages to encode the C&C addresses.\n\n\n-----\n\n###### Dropper\n\nPolyglotDuke’s dropper embeds an encrypted PolyglotDuke within a resource type named GIF with the\nID 129. The resource is encrypted with the following algorithm, using the string GIF89 from the resource\n(which is the 5 first magic bytes of the start of the GIF header) as the key:\n```\nclearText[i] = (i / 5) ^ cypherText[i] ^ aGif89[i % 5]\n\n```\nAfter decryption, the DLL is written to the current working directory and executed using rundll32.exe.\n\nThe custom string encryption algorithm used by the PolyglotDuke dropper is identical to the one used by\nPolyglotDuke, as well as other samples from previous Dukes campaigns, and is depicted in Figure 7.\n\nAs mentioned in section 3.2, it’s worth noting that this dropper shares a great deal of functionality with\nOnionDuke, such as the use of a GIF resource, the use of the same algorithm with the string GIF89 as key to\ndecrypt the resource, and the use of the same custom encryption algorithm to encrypt the strings.\n\n###### C&C server address retrieval from public webpages\n\nStrings from PolyglotDuke are decrypted using two different algorithms. The string is either RC4 encrypted\nusing the CryptDecrypt API where the key is derived from the system directory path with the drive letter\nremoved, or using the custom encryption algorithm shown in Figure 6. An IDA Python script to decrypt\n[these strings is provided in our GitHub repository.](https://github.com/eset/malware-research/tree/master/dukes)\n\nThe C&C server address is retrieved and decoded from various public webpages such as Imgur, ImgBB or\nFotolog posts, tweets, Reddit comments, Evernote public notes, etc. Several encrypted public webpage URLs\nare hardcoded in each sample (from three to six URLs in a single sample) and it will iterate over the hardcoded list of C&C server addresses until it is able to decode a valid C&C URL successfully. An example\nof a public webpage containing an encoded C&C URL is shown Figure 10.\n\nFigure 10 // Example of a public post containing an encoded C&C URL\n\nAfter retrieving the content of one of these webpages, PolyglotDuke parses it to find two delimiter strings\nand extracts the content between them. The extracted UTF-8 string uses a particular character set within a\nUnicode block such as Katakana [22], Cherokee [23] or Kangxi radicals [24]. Any given sample can only\ndecode a C&C URL encoded in one of those charsets. The string is first converted to UTF-16, only the last\nbyte of each codepoint is kept, then a custom mapping is used to transpose this to printable ASCII. The order\nof the characters of the resulting string is then reversed, resulting in the C&C URL. A script to decrypt the\n[C&C URL, regardless of the Unicode range used, is provided on our GitHub repository.](https://github.com/eset/malware-research/tree/master/dukes)\n\n\n-----\n\nPolyglotDuke, a multilingual downloader\n\nKatakana is a Japanese syllabary (part of the Japanese writing system), while Cherokee syllabary is\nused to write Cherokee (which is a Haudenosaunee language), and Kangxi radicals are components of\nChinese characters. The use of these character sets from different languages is the reason we named\nthis downloader PolyglotDuke:\n\nKatakana\n\nァアィイゥウェエォオカガキギクグケゲコゴサザシジスズセゼソゾタダチヂッツヅテデトドナニヌネノハバパヒビピ\nフブプヘベペホボポマミムメモャヤュユョヨラリルレロヮワヰヱヲンヴヵヶヷヸヹヺ\n\nCherokee\n\nᎠᎡᎢᎣᎤᎥᎦᎧᎨᎩᎪᎫᎬᎭᎮᎯᎰᎱᎲᎳᎴᎵᎶᎷᎸᎹᎺᎻᎼᎽᎾᎿᏀᏁᏂᏃᏄᏅᏆᏇᏈᏉᏊᏋᏌᏍᏎᏏᏐᏑᏒᏓᏔᏕᏖᏗᏘᏙᏚᏛᏜᏝᏞᏟᏠᏡᏢᏣᏤᏥ\nᏦᏧᏨᏩᏪᏫᏬᏭᏮᏯᏰᏱᏲᏳᏴ\n\nKangxi radicals\n\n⽶⽷⽸⽹⽺⽻⽼⽽⽾⽿⾀⾁⾂⾃⾄⾅⾆⾇⾈⾉⾊⾋⾌⾍⾎⾏⾐⾑⾒⾓⾔⾕⾖⾗⾘⾙⾚⾛⾜⾝⾞⾟⾠⾡⾢⾣⾤\n⾥⾦⾧⾨⾩⾪⾫⾬⾭⾮⾯⾰⾱⾲⾳⾴⾵⾶⾷⾸⾹⾺⾻⾼⾽⾾⾿⿀⿁⿂⿃⿄⿅⿆⿇⿈⿉⿊⿋⿌⿍⿎⿏⿐⿑⿒⿓\n⿔⿕\n\n\nInterestingly, the text from the delimiter strings usually makes sense in the context of the fake post.\nThe decoded C&C URL points to a PHP script with which the downloader communicates using GET requests,\nas described in the next section.\n\n###### Communication with the C&C server\n\nOnce the C&C server URL is decoded, the compromised computer sends HTTP GET requests with arguments\nusing the following format:\n```\nGET example.com/name.\nphp?[random_param1]=[random_string1]&[random_param2]=[random_string2]\n\n```\nOnly the argument values are relevant here as the argument names are selected randomly from a hardcoded list. The list of argument names used is shown in Table 1. This makes the communication between\nPolyglotDuke and the C&C server difficult to identify because there are no obvious patterns. Additionally, the\n```\nUser-Agent header used to perform the GET requests is a common one:\nMozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; GTB7.4; InfoPath.2;\nSV1; .NET CLR 3.3.69573; WOW64; en-US)\n\n```\n\nTable 1 _List of parameters used to generate GET request to the C&C server_\n\n\nList of hardcoded argument names\n```\naction Arg campaign_id data\nextra extra_1 Format id\nimg_id Item itemId item_id\nK L mod_id mode\nnum Number Oldid option\n\n```\n`page` `Pf` Pflo `placement`\n```\nref S Show state\ntag Term Title v\nvar View\n\n```\n\n-----\n\nThe GET argument values are randomly generated but the first random string in each request should comply\nwith a constraint based on a specific integer (see below). A string will be randomly regenerated until one\ncomplies with the constraints. The digits from the string representation of the MD5 hash of the randomly\ngenerated string are summed, and then modulo 5 of this value must match a specific integer.\n\nThe communication with the C&C server to retrieve a payload follows this sequence:\n\n- First the communication with the C&C server is checked. The sum of the digits of the MD5 hash\nof the first argument modulo 5 should be equal to 4. The response of the C&C server is matched\nwith the second random string as it will echo back this string in case of successful communication.\n\n- If the communication with the C&C server is successful, a custom hash from the concatenation\nof the username and the volume serial number of the disk of the current directory is generated\nand sent twice. The modulo 5 value of the MD5 hash of the first parameters of these requests should\nbe 0 and 2 respectively.\n\n- In the response to the second request, search for <img src=” and the next “> strings in the last\nresponse and extract the image filename between them, if present. Figure 11 shows a C&C server\nresponse at the identification step, with a path to an image (cuteanimals12.jpg in this case).\n\n- If a filename was extracted in the preceding step, the file is retrieved into the directory whose\nname is the unique ID sent twice at the registration step:\n```\n GET example.com/<Username_VolumeID_Hash>/cuteanimals12.jpg\n\n```\nFigure 11 // C&C response with a path to an image to download\n\nThis sequence continues until a path to a file is provided between the <img src=” and “> strings and the\nfile downloaded. The communication steps are summarized in Figure 12.\n\nPolyglotDuke\n\nTwitter, Imgur\nReddit C&C server\n\nRetrieve C&C address\n\nCommunication check\n\nEcho\n\nIdentification\n\nPath to file\n\nGet img\n\nImg\n\nTime\n\nFigure 12 // Communication sequence with the C&C server\n\n|PolyglotDuke Twitter, Imgur Reddit C&C s Retrieve C&C address Communication check Echo Identification Path to file Get img Img|Col2|Col3|\n|---|---|---|\n||Identification||\n|||Echo|\n||Get img||\n|||Path to file|\n||||\n|||Img|\n\n\n-----\n\nInterestingly, the root URLs of the C&C server used by PolyglotDuke redirect to domains with similar names\nhosting legitimate websites. This technique is probably used in order to avoid suspicion when investigating\nthe traffic with the C&C server. For one of the C&C servers, the attackers forgot to add a TLD to the redirected domain. Examples of redirection are shown in Table 2.\n\n\nTable 2 _Example of redirection from the C&C servers’ root URLs_\n\n\nC&C server domain name Redirection target\n\nrulourialuminiu.co[.]uk rulourialuminiu.ro\n\npowerpolymerindustry[.]com powerpolymer.net\n\nceycarb[.]com ceycarb (invalid, missing TLD)\n\n###### Payload decryption and execution\n\nA data blob containing encrypted data is appended to the end the downloaded file: this technique allows\ndata to be easily included in a JPEG or PNG image download in a way that means the image remains valid.\nWe couldn’t retrieve any of the files downloaded by PolyglotDuke to confirm this hypothesis but the way\nthe encrypted blob is added to such files in addition to their extension being .jpg or .png lead us to think\nthat they were valid images used to look like legitimate traffic.\n\nTo extract the payload from the file downloaded from the C&C server, PolyglotDuke will first decrypt\nthe last eight bytes with RC4 using the same key as the one used for strings decryption. The first four\ndecrypted bytes correspond the offset to the embedded blob relative to the end of the file and the last\nfour bytes provide a value used as integrity check; that value is the same as the first four bytes\nat the beginning of the blob.\n\nThe structure of the file is described in Figure 13.\n\n\n**DWORD**\n\n\n**DWORD** **DWORD** **Size** **0x100** **DWORD**\n\n\nRC4\nencrypted\n0x1BD75010\n\n\nOffset\n\n\nsize RC4 encrypted PE Signature RC4\nencrypted\noffset\n\nFigure 13 // Embedded blob format\n\n\nAfter obtaining the offset to the embedded blob and checking the integrity value, the size of the RC4-encrypted blob is retrieved from immediately afterward. Then, next to the encrypted blob, we find the signed\nSHA-1 hash of the blob. Before decrypting the blob, the hash signature is checked against an RC4-encoded\npublic key hardcoded in the binary. The signature verification procedure is shown in Figure 14, while\nthe public key used to check the hash signature is shown in Figure 15.\n\n\n-----\n\nFigure 14 // Decompiled hash signature verification procedure\n\nFigure 15 // Public key used to verify the hash signature\n\nThis technique ensures that only a payload signed by the operators could be executed on the victim’s\nmachine, since the private key used to sign the hash is needed to generate a valid signature.\n\nAfter having successfully checked the hash signature of the encrypted blob, it is decrypted using the same\nkey used for the RC4-encrypted strings. The format of the decrypted blob is shown in Figure 16.\n\n\n0x1BD75010\n\n\n1\n\n\n**DWORD**\n\nExec\ntype\n\n1 2\n\n\n**PE Size** **DWORD** **Filename size**\n\nPE Size PE 0x1BD75010 Filename Filename\nsize\n\n|Col1|Col2|Col3|\n|---|---|---|\n|Exec type|||\n||||\n\n\nFigure 16 // Encrypted blob format after decryption\n\nNotice that the same delimiter value is used and checked at various positions of the blob (in the example\nin Figure 16 it is 0x1BD75010). Two of the bytes between the first two delimiters define the action\nto be taken with the decrypted blob.\n\nThe value immediately following the second delimiter is the size of the data, being either a PE or an encrypted\nconfiguration, followed by the data itself followed by a third delimiter, the size of the subsequent filename,\nand finally the filename itself. The correct extension (.dll or .exe) will be appended to the filename\nof the PE to be written, depending on the executable type. The list of valid combinations and their respective\nbehaviors is shown on Table 3.\n\n\n-----\n\nTable 3 _List of execution type combination and their corresponding behavior_\n\n\nexec type 1 exec type 2 behavior\n\n0 2 write the executable to disk and launch it using CreateProcess\n\n1 4 write the DLL to disk and launch it using rundll32.exe\n\n2 3 write the DLL to disk and load it using LoadLibraryW\n\nwrite the encrypted JSON config to the registry, updating the list of public pages to\n3 1\nparse for encoded C&C addresses\n\n##### 4.3 RegDuke: a first-stage implant\n\nRegDuke is a first-stage implant that is apparently used only when attackers lose control of the other\nimplants on the same machine. Its purpose is to stay undetected as long as possible to help make sure\nthe operators never lose complete control of any compromised machine.\n\nIt is composed of a loader and a payload, the latter being stored encrypted on the disk. Both components\nare written in .NET. RegDuke persists by using a WMI consumer named MicrosoftOfficeUpdates.\nIt is launched every time a process named WINWORD.EXE is started.\n\nOur analysis is based on the sample with SHA-1 0A5A7DD4AD0F2E50F3577F8D43A4C55DDC1D80CF.\n\n###### The loader\n\nBetween August 2017 and June 2019, we have seen four different main versions of the loader. The first\nversion was not obfuscated and had the encryption key hardcoded in the code. Later versions read the\nencryption key from the Windows registry and use different types of obfuscation such as control-flow\nflattening or directly using .NET Reactor, a commercial obfuscator. Figure 17 is a sample of RegDuke\nobfuscated with .NET Reactor.\n\nFigure 17 // Obfuscated RegDuke sample\n\nThe flow of the loader is simple. It reads the encrypted file at either a hardcoded path or at a value extracted\nfrom the Windows registry, as shown in Figure 18.\n\nFigure 18 // RegDuke. The path, password and salt are hardcoded in this example.\n\n\n-----\n\nThen, it decrypts it using a password and a salt either hardcoded in the loader or stored in the Windows\nregistry. The encryption key and the initialization vector are derived from the password and the salt using\nthe technique described in RFC 2898, also known as PBKDF2, as shown in Figure 19.\n\nFigure 19 // Decryption of RegDuke payload\n\nIn all the samples we have seen, they use only the three different registry keys listed in Table 4.\nIt is interesting to note that attackers seem to have put some effort at selecting registry keys and values that\nmight look legitimate.\n\n\nTable 4 _RegDuke Windows registry keys_\n\n\nValue containing\nRegistry Key the directory of\nthe payload\n\n\nValue containing\nthe filename of\nthe payload\n\n\nValue containing\nthe password and\nthe salt\n\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Intel\\\nPathCPA CPAmodule Init\nMediaSDK\\Dispatch\\0102\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Intel\\\nRootPath APIModule Stack\nMediaSDK\\Dispatch\\hw64-s1-1\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\ MSBuildOverrideDefaultLibs BinaryCache\nMSBuild\\4.0 TasksPath\n\nFinally, the decrypted Windows Executable is loaded using the Assembly.Load method. We only found\none payload, but we cannot be certain that others are not deployed in the wild.\n\n###### The payload: a fileless, Dropbox-controlled backdoor\n\nThe payload is a backdoor that resides in memory only, and that uses Dropbox as its C&C server.\nIts configuration is hardcoded in an internal class, shown in Figure 20. Our analysis is based on the sample\nwith SHA-1 5905C55189C683BC37258AEC28E916C41948CD1C.\n\nFigure 20 // Dropbox backdoor configuration (redacted)\n\nWe have seen the following clientId values being used: collection_3, collection_4, collection_6,\n```\ncollection_7, collection_8 and collection_99. However, other than collection_4, we were not\n\n```\nable to determine the targets for these collections.\n\n\n-----\n\nThe backdoor regularly lists the Dropbox directory corresponding to its clientId and downloads PNG files\nfrom it. The downloaded PNG files are valid pictures, as you can see in Figure 21.\n\nFigure 21 // Example of two pictures downloaded from the Dropbox directory\n\nHowever, the attackers have used steganography to hide data in the pictures. In Figure 22, you can see\nthe code looping over all the pixels of the image and extracting data from them.\n\nFigure 22 // Loop extracting a payload from the pixels of a downloaded picture\n\nEach pixel is encoded into 24 bits: 8 for red, 8 for green and 8 for blue. The developers use a technique\ncalled “Least Significant Bit” to store 8 bits of data in each pixel, as shown in Figure 23. This technique\nhas been used previously by other malware such as Gozi [25]. They extract two bits from the red value,\nthree from the green and three from the blue.\n\n\n**Red** **Green**\n\n\n**Blue**\n\n\nFigure 23 // The least significant bits of each color of each pixel are extracted to recover the hidden data\n\n\n-----\n\nThe steganographically altered image has almost no visible difference from the original image because\nthe two or three least significant bits have a very limited impact on the color. For the green and blue\ncomponents of each pixel a maximum of 7/256, and for the red component 3/256 of a fully saturated pixel\nvariation will occur. Figure 24 shows a blue of value 255 (on the left) and the maximum deviation from that\nin just the blue spectrum with a value of 248 (on the right). There is apparently no difference but, by doing\nthat on every pixel of the image, allows the attacker to store a backdoor in a still valid PNG image.\n\n255 248\n\nFigure 24 // Comparison between a blue of value 255 and a blue of value 248\n\nFinally, it decrypts the extracted bytes using the AES key hardcoded in the config. The decrypted data can be:\n\n- a Windows executable\n\n- a Windows DLL\n\n- a PowerShell script\n\nWe have seen the following executables being dropped by this Dropbox backdoor:\n\n- Several MiniDuke backdoors (see section 4.4)\n\n- [Process Explorer, a utility that is part of the SysInternals suite](https://docs.microsoft.com/en-us/sysinternals/)\n\n##### 4.4 MiniDuke backdoor: the second stage\n\nAs highlighted in section 3.2, the most recent versions of the MiniDuke backdoor have a lot of code similarities\nwith earlier versions, such as the sample with SHA-1 of 86EC70C27E5346700714DBAE2F10E168A08210E4,\ndescribed by Kaspersky researchers in 2014 [21]. Our analysis is based on the sample with\nSHA-1 B05CABA461000C6EBD8B237F318577E9BCCD6047, compiled on August 17, 2018.\n\nMiniDuke acts as a second-stage backdoor, which is dropped by one of the two first-stage components\ndescribed in the sections above.\n\nThe most recent samples we are aware of were compiled in June 2019 and show no major changes, except\nthe C&C domain and the use of an invalid (likely transplanted) digital signature, as shown in Figure 25.\nThis might be an attempt to bypass some security products.\n\nFigure 25 // Invalid digital signature added to the backdoor\n\n\n-----\n\nThe backdoor is still written in pure x86 assembly but its size increased a lot – from 20 KB to 200+ KB.\nThis is due to the addition of obfuscation, mainly control-flow flattening [26], as shown in Figure 26.\nThis is a common obfuscation technique that makes it difficult to read the code because every function\nis split in a switch/case inside a loop.\n\nFigure 26 // Control flow flattening used to obfuscate the MiniDuke backdoor\n\nSome of the Windows API functions are resolved dynamically. The backdoor uses a simple hash function\nto obfuscate the name of the function it tries to resolve.\n\nThe network communication is relatively simple. It can use the GET, POST and PUT HTTP methods to contact\nthe hardcoded C&C server.\n\nIn order to blend into the legitimate traffic, the data are prepended with a JPEG header. The resulting images\nare not valid, but it is very unlikely that anybody will check the validity of all pictures in the network traffic.\nFigure 27 is an example of a POST request to the C&C server. As the server was down at the time of capture,\nwe were not able to receive a reply, but we believe the reply also contains a JPEG header, as the malware\nignores the first bytes of the reply.\n\nFigure 27 // Post request to the C&C server that looks like a regular jpeg file upload\n\nIn addition to the HTTP protocol, the malware is able to send and receive data over a named pipe. This\nfeature typically allows it to reach machines on the local network that don’t have internet access. One\ncompromised machine, with internet access, will forward commands to other compromised machines\nthrough the named pipe.\n\nA similar feature to the named pipe is the HTTP proxy. The malware will listen on a first socket, either\non the default port 8080 or on a port specified by the operators. It will also open a second socket with\nthe C&C server. It waits for connections on the first socket and when one is established, it proxies data\nbetween the two sockets. Thus, a machine without internet access, or with a firewall that blocks connections to the attackers’ domain, might still be able to reach the C&C through the proxy machine.\n\n\n-----\n\nFinally, this malware implements thirty-eight different backdoor functions such as:\n\n- Uploading or downloading files\n\n- Creating processes\n\n- Getting system information (hostname, ID, pipename, HTTP method)\n\n- Getting the list of local drives and their type (unk, nrt, rmv, fix, net, cdr, ram, und)\n\n- Reading and writing in the named pipe\n\n- Starting and stopping the proxy feature\n\n##### 4.5 FatDuke: the third stage\n\nFatDuke is the current flagship backdoor of the group and is only deployed on the most interesting\nmachines. It is generally dropped by the MiniDuke backdoor, but we also have seen the operators dropping\nFatDuke using lateral movement tools such as PsExec.\n\nThe operators regularly repack this malware in order to evade detections. The most recent sample\nof FatDuke we have seen was compiled on May 24, 2019.\n\nWe have seen them trying to regain control of a machine multiple times in a few days, each time with\na different sample. Their packer, described in a later section, adds a lot of code, leading to large binaries.\nWhile the effective code should not be larger than 1MB, we have seen one sample weighing in at 13MB,\nhence our name for this backdoor component: FatDuke.\n\nIn this section, we will use the sample with SHA-1 DB19171B239EF6DE8E83B2926EADC652E74A5AFA\nfor our analysis.\n\n###### Installation and persistence\n\nDuring our investigation, we were not able to find a dropper for FatDuke. We believe the operators simply\ninstall the backdoor and establish persistence using the standard commands of an earlier stage backdoor.\n\nWe also noted that FatDuke generally replaced the second-stage binary, reusing the persistence\nmechanism already in place.\n\nThe persistence we have seen is very standard. They use the registry key HKLM\\SOFTWARE\\Microsoft\\\n```\nWindows\\CurrentVersion\\Run and creatd a new value named Canon Gear and value C:\\Program\nFiles\\Canon\\Network ScanGear\\Canocpc.exe. This launches the backdoor each time a user logs in.\n\n###### Configuration\n\n```\nFatDuke has a hardcoded configuration embedded in the executable’s resources, as shown in Figure 28.\n\nFigure 28 // FatDuke configuration data in the PE resources\n\n\n-----\n\nThe configuration data is a JSON object encoded in base64. Once decoded, it reveals much interesting\ninformation, as shown in Figure 29.\n\n```\n{\n\n```\n\"config_id\": \"145\",\n\"encoding_mode\": \"Base64\",\n\"encryption_mode\": \"Aes256\",\n\"key\": \"62DA45930238A4A1149E76658A35C4A70CE7E0CDF7529C96499FB5F27AA647B3\",\n\"pivoting_ip\": \"<redacted local IP v4 address>\",\n\"pivoting_pipe\": \"lippstdt\",\n\"pivoting_login\": \"Administrator\",\n\"pivoting_password\": \"<redacted>\",\n\"server_address\": \"https://ministernetwork[.]org:443/Main/\",\n\"ignore_certificate_errors\": \"0\",\n\"connection_types\": \"WinInet,WinHttp,UrlMon\",\n\"data_container\": \"Cookie\",\n```\n  \"rsa_public_key\": \"LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0NCk1JSUJJakFOQmdrcWhraUc5dz\nBCQVFFRkFBT0NBUThBTUlJQkNnS0NBUUVBcWZBWHVlRTdiK2pUUFhWb3MxVSsNCnRkcWV5WlR2dFNWYXRvZkt\n1QWZUNm5wVmh3cHBieFRDcjdSN1Y2VXdwK2tPK1pTbWRWTTZ4b3VzOTAyTDVIV3UNCldXK1dOemsraDVJUzFP\ndWdkeUJXQWs4bDRmWVRoMVBNbXgwTzQvZU9JY0g4c1NUNXZPOTB3SEY0T3pXQ1I4b3gNCkxqVGlkTTdpVXQ5Y\nkptVjRkNDZVa2tpL3ZDYXZFU0p5b0l2eU9WS2M0ZjNRczQ2TW1uSjRnd1RoaE4rQkt2dmgNCnphbXJOZ3kzNk\n9QY0IxOFRweGd3OW8vVmpMbTJ2RTB2c3dzM3hqOXlGTERTVFplRUFBY0V6c1NvckRQOFdOWm0NCktyMXVNUFh\nvL3k2by9VOUptM3VPdUFFdG50cEpRQW5SZmFpZGZpbHBVUHF6OXZxWGpiOCtJSXVtWVQvRUVwcmMNCkd3SURB\n\n```\nUUFCDQotLS0tLUVORCBQVUJMSUMgS0VZLS0tLS0NCg==\",\n\"request_min_timeout_s\": \"1\",\n\"request_max_timeout_s\": \"60\",\n\"php_aliases\": \"about.php,list.php,contacts.php,people.php,forum.php,index.php,\nwelcome.php\",\n\"cookies\": \"param,location,id_cookie,info,session_id\",\n\"service_cookie_1\": \"GMAIL_RTT\",\n\"service_cookie_2\": \"SAPISID\",\n\"service_cookie_3\": \"APISID\",\n\"activity_scheduler\": \"Mon,Tue,Wed,Thu,Fri;0:00-23:59\",\n```\n  \"grab_ua_by_probing\": \"0\"\n}\n\n```\n\nFigure 29 // FatDuke configuration example\n\nIncluded in the information contained in the config, we can see:\n\n- The AES key used to encrypt/decrypt the network traffic\n\n- The pipe name and the credentials used to contact another machine on the local network\n\n- The C&C URL\n\n- The time of day when the backdoor is enabled for attacker access\n\n- Cookies that the malware can fetch in the browser’s cookie directory. They are related to cookies used\nby Google services such as YouTube or Gmail\n\nThe operator has the possibility to fetch the configuration from the computer along with usual computer\ninformation like username, Windows version, computer name, build, etc.\n\nFinally, it does not seem possible to update this configuration without dropping a new version\nof the malware.\n\n###### Backdoor and network\n\nFatDuke can be controlled remotely by the attackers using a custom C&C protocol over HTTP or using\nnamed pipes on the local network.\n\nHTTP communications and backdoor commands\n\nIn order to blend into the network traffic, FatDuke tries to mimic the user’s traffic by using the same\n_[User-Agent as the browser installed on the system. It implements two different techniques to gather this](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/User-Agent)_\nvalue.\n\n\n-----\n\nFirst, it can probe the User-Agent by making an HTTP request on a socket it has just created.\n\n1. It creates a socket listening on localhost:80\n\n2. It accepts any connection\n\n3. It calls ShellExecuteW with open and http://localhost: as argument. This will open the default\n\nbrowser on the URL localhost.\n\n4. The socket replies with a hardcoded HTTP reply:\n```\n  HTTP/1.1 200 OK\n  Server: Apache/2.2.14 (Win32)\n  Content-Type: text/html\n  Connection: close\n  <html><script>window.close();</script></html>\n\n```\nThis simple JavaScript code will directly close the browser. The window pops up only for a fraction\n\nof second but the user also loses focus of the currently active window.\n\n5. In order to extract the User-Agent, FatDuke parses the HTTP request sent by the browser to its socket.\n\nIf the previous method did not work, it can check the default browser in the registry key HKCU\\Software\\\n```\nClasses\\http\\shell\\open\\command. It then selects one of the hardcoded User-Agent strings\n\n```\naccordingly, as shown in Table 5.\n\n\nTable 5 _Hardcoded User-Agent_\n\n\nDefault Browser Selected User-Agent\n\nMozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0\nChrome\nSafari/537.36\n\nFirefox Mozilla/5.0 (Windows NT 6.1; WOW64; rv:34.0) Gecko/20100101 Firefox/34.0\n\nInternet Explorer Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)\n\nMozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)\nOpera\nChrome/37.0.2062.35 Safari/537.36 OPR/24.0.1558.21\n\nMozilla/5.0 (Windows; Windows NT 6.1) AppleWebKit/534.57.2 (KHTML, like Gecko) Version/5.1.7\nSafari\nSafari/534.57.2\n\nNext, FatDuke contacts the C&C server, specified in the config, and uses one of the PHP scripts specified in\nthe php_aliases field of the config. It is interesting to note that these filenames are related to the theme\nof the C&C server domain. For example, they registered the domain westmedicalgroup[.]net, and the\naliases list contains filenames such as doctors.php or diagnostics.php.\n\nFigure 30 is a summary of the C&C protocol.\n\n\nImage URL\n\nImage URL\n\n\n##### >[_]\n\n\nMalicious\naction\n\n\nHTML page\n\nExecute **{ JSON }** Decode\nthe command and decrypt\n\nBackdoor\ncommand in JSON\n\nFigure 30 // FatDuke C&C protocol\n\n\n-----\n\nThe requests sent to the C&C server are crafted to look like typical GET requests and once again\nare related to the script name. For example, the request below uses parameters that you might expect\nto find on a forum’s website.\n```\n/homepage/forum.php?newsid=<RANDOM>&article=<REDACTED>&user=\ne40a4bc603a74403979716c932f0523a&revision=3&fromcache=0\n\n```\nHowever, while some fields are randomly generated strings, article and user could be used\nby the operator to pinpoint the victim. The first keyword, article, is an identifier – a SHA-256 hash\nof the volume identifier concatenated with MAC addresses found on the target computer. The other\nkeyword, user, probably flags the general configuration that comes with the malware. This value\nis located in the PE resource section, right before the encoded configuration mentioned in section 4.5.\n\nThe reply is an HTML page, with the HTML content copied from a legitimate website such as the BBC.\nHowever, if the C&C server wants to send a command to the malware, it will add an additional\nHTML img tag to the page, as shown in Figure 31.\n\nFigure 31 // Additional image tag sent by FatDuke C&C\n\nOnce it receives this HTML page, the malware uses the two following regexes:\n\n- `<img id=”id[0-9]+” src=”([^ “]+)” class=”image-replace”[^>]*>`\n\n- `<img id=”idd[0-9]+” src=”([^ “]+)” class=”image-replace”[^>]*>`\n\nThese regexes extract the src attribute value – the URI of the image. If it finds an image, the malware will\nmake another GET request to http(s)://<C&C>/<directory>/<php_script.php>?imageid=<src\n```\nvalue>. In our example, it will make a request to http://<C&C>/about/bottom.php?imageid=32d7\nbcf505ca1af4a38762ff650968ac9cab2ce305cdbf8331d30b.png.\n\n```\nThis will return a file, such as that shown in Figure 32. These files masquerade as PNG images\nin the GET request, but are not valid images. They contain a header of 0x37 bytes, matching one hardcoded\nin the malware, and a chunk of encrypted data that is base64 encoded. To further the PNG subterfuge,\nthe header contains an incomplete, misplaced and corrupted PNG header, which may be sufficient to avert\nconcern under cursory examination.\n\nFigure 32 // C&C response including most of a valid PNG header and an encrypted command for FatDuke\n\n\n-----\n\nThe malware then decrypts this data using AES-256 in ECB mode, with the key hardcoded in the config.\nThe result is a command in JSON. Figure 33 shows six real command examples.\n\n```\n{\"commandBody\":\"14 C:\\\\Users\\\\<redacted>\\\\AppData\\\\\n\n```\nLocal\",\"size\":0,\"iscmd\":true}\n```\n{\"commandBody\":\"5 -parsing=raw -type=exe net.\nexe use \\\\\\\\WORKPC\\\\IPC$ \\\\\"<redacted password>\\\\\" /\n\n```\nUSER:Administrator\",\"size\":0,\"iscmd\":true}\n```\n{\"commandBody\":\"5 -parsing=raw -type=exe schtasks.exe /Query /FO\n\n```\nTABLE\",\"size\":0,\"iscmd\":true}\n{\"commandBody\":\"14 C:\\\\Users\\\\Administrator\",\"size\":0,\"iscmd\":true}\n```\n{\"commandBody\":\"14 \\\\\\\\<redacted>\\\\C$\\\\Users\\\\User\\\\\n\n```\nDesktop\",\"size\":0,\"iscmd\":true}\n{\"commandBody\":\"7\",\"size\":0,\"iscmd\":true}\n\n\nFigure 33 // Example of commands sent to FatDuke\n\nThese JSON objects contain a command identifier and the command arguments. Table 6 shows\nthe commands implemented by FatDuke.\n\n\nTable 6 _FatDuke backdoor commands_\n\n\nID Description ID Description\n\n0 Read or write an environment variable 17 Copy a file or a directory\n\n1 Load a DLL 18 Remove a directory\n\n2 Unload a DLL 19 Remove a file\n\n3 Execute rundll32 20 Compute the MD5 of a file\n\nExecute a command, a wscript, a PowerShell\n4 21 `cat a file`\ncommand or create a process\n\nExecute a command, a wscript, a PowerShell\n5 command or create a process, using a pipe to get 22 Exfiltrate a file\nthe result\n\n6 Kill a process 23 Write a file\n\n7 Kill itself 24 Write random data to a file (secure deletion)\n\nUninstall (secure delete its DLL and exit the\n8 25 System information\nprocess)\n\n9 Turn on or off the random interval 26 Date\n\n10 Set User-Agent to default value 27 List running processes\n\nReturn the list of disks with their type and\n11 Enable debug log 28\navailable space\n\n12 Return the working directory 29 Return malware information\n\n13 Change the working directory 30 Listen to a pipe\n\n14 List directory 31 Stop listening to a pipe\n\n15 Create directory 32 List open pipes\n\n16 Move a file or a directory\n\nThe C&C servers used for FatDuke do not seem to be compromised websites. In order to look legitimate,\nthey register variants of existing domains and redirect the homepage of their C&C server to the homepage\nof the real domain. As mentioned before, this technique is also used for PolyglotDuke C&C servers.\n\nFor example, they registered the domain fairfieldsch[.]org and make it redirect\nto fairfields.northants.sch.uk, the website of a school in the UK.\n\nWe also noticed that they used several C&C servers per targeted organization, but these servers apparently\ndon’t overlap across the victims, ensuring tight compartmentalization.\n\n\n-----\n\nLocal network pivoting\n\nWhat if the compromised machine doesn’t have access, or has restricted access, to the Internet? The\ndevelopers implemented a functionality they called PivotingPipeTransport.\n\nIt allows the malware to communicate with other malware instances using pipes. In order to connect to a\n[remote machine, it first calls WNetAddConnection2. This function takes the following arguments:](https://docs.microsoft.com/en-us/windows/win32/api/winnetwk/nf-winnetwk-wnetaddconnection2a)\n\n- `lpNetResource: the remote machine`\n\n- `lpPassword: the remote password`\n\n- `lpUserName: the remote username`\n\nThese pieces of information are available in the malware configuration under the names:\n\n- `pivoting_ip`\n\n- `pivoting_login`\n\n- `pivoting_password`\n\nThen, it will create a pipe using the name specified in the pivoting_pipe configuration field and use it to\ncommunicate with the other malware instance.\n\nThus, this functionality allows attackers to bypass network restrictions that may be enforced on critical\nsystems. However, they need to steal the credentials of the remote machine first or use organization-level\nadministrative credentials.\n\n###### Obfuscation\n\nThe FatDuke binaries are highly obfuscated. They use three different techniques in order to slow down\nanalysis.\n\nFirst, they use string stacking for all important strings; this consists of building strings dynamically by pushing\neach character separately on the stack, rather than using strings from the .data section. They also add\nsome basic operations to the stacking in order to prevent the extraction without emulating the code. Figure 34\nshows such an example where the ASCII value of each letter is multiplied with a hardcoded value of 1.\n\nFigure 34 // FatDuke obfuscation – String stacking\n\nSecond, they also add opaque predicates in most of the functions. Opaque predicates are conditions that are\nalways True or always False. They are not part of the code's semantic, but the code is harder to read.\nFigure 35 is an example of opaque predicates we found in FatDuke. Whatever the result of rand() is, v11 is\nalways equal to 15. Thus, the condition is always False.\n\nFigure 35 // FatDuke obfuscation – Opaque predicate\n\n\n-----\n\nThird, they add junk code and junk strings. Unlike opaque predicates, the code will be executed\nbut it is useless and again is not part of the semantics of the program. For example, the function in Figure 36\nand in Figure 37 returns always the same value, which is never used.\n\nFigure 36 // FatDuke obfuscation – Junk function call\n\nFigure 37 // FatDuke obfuscation – Junk function return value\n\nThe binary contains a huge amount of strings from different projects like Chromium. It might be an attempt\nto bypass security products, similar to what was posted by SkyLight [27]. These strings are used to fill very\nlarge structures (about 1000 fields), probably to hide the few interesting fields used by the malware, as\nshown in Figure 38.\n\nFigure 38 // FatDuke obfuscation – Chromium strings\n\nWe are not sure whether Dukes’ developers used a commercial obfuscation tool or if they developed\ntheir own. However, given their level of sophistication, it would not be surprising if they rely on their\nown obfuscator.\n\n\n-----\n\n##### 4.6 LiteDuke: the former third stage\n\nLiteDuke is a third-stage backdoor that was mainly used in 2014-2015. It is not directly linked to Operation\n_Ghost, but we found it on some machines compromised by MiniDuke. We chose to document it mainly_\nbecause we did not find it described elsewhere. We have dubbed it LiteDuke because it uses SQLite\nto store information such as its configuration. Our analysis is based on the sample with SHA-1\n```\nAF2B46D4371CE632E2669FEA1959EE8AF4EC39CE.\n\n###### Link with the Dukes\n\n```\nLiteDuke uses the same dropper as PolyglotDuke. It also uses the same encryption scheme, shown in\nFigure 7 in section 3.2, to obfuscate its strings. As we haven’t seen any other threat actor using the same code,\nwe are confident that LiteDuke was indeed part of the Dukes’ arsenal.\n\n###### Packer\n\nLiteDuke is packed using several layers of encryption and steganography.\n\n1. In the PE resources section, the initial dropper has a GIF picture. The picture is not valid but contains\n\na second dropper.\n\n2. This second executable has a BMP picture in its resources. It uses steganography to hide bytes\n\nin the image. Once decoded and decrypted, we have the loader.\n\n3. The loader will decrypt the backdoor code and load it into memory.\n\nFigure 39 summarizes the unpacking process from the initial dropper to the backdoor code.\n\n\nDropper 1\n\n\nDropper 2\n\n\nLoader\n\n\nExtract from\nthe resources\nsection\n\n\nDecrypt\nand execute\n\n\nExtract from\nthe resources\nsection\n\n\nDecode, decrypt,\ndrop and execute\n\n\nDecrypt and load\ninto memory\n\n|1 Extrac he res sec|t from ource tion|\n|---|---|\n\n|Dec and ex|rypt ecute|\n|---|---|\n\n|Extrac he res sec|t from ource tion|\n|---|---|\n\n|code, op and|decry exec|\n|---|---|\n\n|crypt into m|and lo emor|\n|---|---|\n\n\nGIF picture\n(invalid)\n\n\nBMP picture\n(with data hidden\nusing steganography)\n\nFigure 39 // LiteDuke unpacking process\n\n\nBackdoor\n\n\nSide Story\n\nWe also noticed that the attackers left a curious artefact in an older sample (the dropper with SHA-1\n```\n7994714FFDD6411A6D64A7A6371DB9C529E70C37) as shown in Figure 40.\n\n```\nFigure 40 // Curious phone number left by the attackers\n\nThis is the phone number of a mental health specialist in a small city in the state of Indiana\nin the United States.\n\n\n-----\n\n###### Backdoor\n\nThe backdoor code only exists in memory as only the loader is written to disk. The loader persists using\na Windows shortcut (.lnk file) that is registered in the traditional CurrentVersion\\Run registry key.\n\nAccording to the PE header, the developers did not make use of Visual Studio to compile this backdoor.\nFigure 41 shows that they used the linker FASM 1.70. FASM (Flat Assembler) is an assembler that can produce\nWindows or Linux binaries. It reminds us of the MiniDuke backdoor, developed directly in x86 assembly.\n\nFigure 41 // Assembler used by the developer (screenshot of DIE analysis)\n\nThe backdoor DLL exports seven functions that have relatively explicit names (CC being Crypto Container):\n\n- SendBin\n\n- LoadFromCC\n\n- SaveToCC\n\n- GetDBHandle\n\n- GetCCFieldSize\n\n- GetCCFieldLn\n\n- DllEntryPoint\n\nInterestingly, the malware apparently attempts to bypass Kaspersky security products by checking\nif the registry key HKCU\\Software\\KasperskyLab exists and if so, it waits 30 seconds before executing\nany additional code. We do not know whether this really bypasses any Kaspersky security products.\n\nThe Crypto Container is an SQLite database, stored on the disk in the same directory as the loader,\n[and uses SQLCipher. This SQLite extension encrypts the database using AES-256. The encryption key is the](https://www.zetetic.net/sqlcipher/)\nMD5 hash of machine-specific values (such as CPUID, the account name, the BIOS version and the processor\nname) to prevent decryption if, for example, the database ends up in a public malware repository. The key\nis not stored anywhere but is re-generated at each execution.\n\nThe database contains three different tables, which are created using the following commands:\n\n\nCREATE TABLE modules (uid INTEGER PRIMARY KEY, version char(255),\ncode blob, config blob, type char(10), md5sum char(32), autorun\n```\n(INTEGER);\n\n```\nCREATE TABLE objects (uid INTEGER PRIMARY KEY AUTOINCREMENT, name\nCHAR(255), body blob, type char(10), md5sum char(32));\nCREATE TABLE config (uid INTEGER PRIMARY KEY AUTOINCREMENT, agent_id\nCHAR(128), remote_host CHAR(256), remote_port integer, remote_path\nchar(1024), update_interval integer, server_key CHAR(32), rcv_header\n```\nCHAR(64));\n\n```\n\nThe configuration default values are hardcoded in the binary. This SQLite table allows the malware\noperators to update these parameters easily.\n\nSimilarly, the modules, which are plug-ins for the backdoor, are stored in the database. Since the database\nis encrypted, the modules never touch the disk in plaintext and will only be loaded into memory.\nUnfortunately, we have not yet been able to find any of the plug-ins used by LiteDuke.\n\nOne artefact of the development method is the implementation of the backdoor commands. Usually,\na backdoor will have a big switch statement to check the command sent by the C&C server against the list\nof commands implemented in the malware. In the case of LiteDuke, it is a succession of loops: one loop per\nimplemented command, as shown in Figure 42.\n\n\n-----\n\nFigure 42 // Multiple while loops instead of a backdoor switch case\n\nEach of the 41 different commands has between three and six possible command IDs. The program will loop\nsuccessively on the list until the ID in the list matches the ID provided by the operator. The full list is available\nin Figure 43.\n\nFigure 43 // List of LiteDuke command IDs\n\nGiven the large number of different commands, we won’t list them all. Basically, the backdoor can:\n\n- Upload or download files\n\n- Securely delete a file by first writing random data (from a linear congruential generator) to the file\n\n- Update the database (config, modules and objects)\n\n- Create a process\n\n- Get system information (CPUID, BIOS version, account name, etc.)\n\n- Terminate itself\n\nThe network part of the backdoor is relatively simple. It uses GET requests to contact either the hardcoded\nC&C URL or the one stored in the database. Figure 44 shows the domain, resources and parameters used\nby LiteDuke.\n\n\n-----\n\nFigure 44 // LiteDuke C&C domain, resources and parameters\n\nAmong the different samples we analyzed, the C&C domains are different, but they always use a script\nnamed rcv_get.php. We believe that the C&C domains are compromised servers.\n\nIn order to blend into the network traffic, and similar to FatDuke, the malware checks the default browser\nand chooses its User-Agent request header accordingly, as shown in Table 7. It can also get the proxy\nconfiguration from Firefox, in the configuration file prej.js, or from Opera, in the operaprefs.ini file.\nThis information is then used when establishing a connection to the C&C server.\n\n\nTable 7 _User-Agent strings used by LiteDuke_\n\n\nDefault Browser User-Agent\n\nMozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0;\nInternet Explorer\nSLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729)\n\nMozilla/5.0 (Windows NT 6.2; WOW64; rv:23.0) Gecko/20100101\nFirefox\nFirefox/23.0\n\nMozilla/5.0 (Windows; U; Windows NT 6.1; en-US) AppleWebChrome\nKit/534.13(KHTML, like Gecko) Chrome/9.0.597.98 Safari/534.13\n\nMozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/533.19.4\nSafari\n(KHTML, like Gecko) Version/5.0.3 Safari/533.19.4\n\nOpera Opera/9.80 (Windows NT 5.1; U; en-US) Presto/2.7.62 Version/11.01\n\nAs one can see, some of these User-Agents are custom and they all refer to very old browsers, most of them\nreleased in 2011. It is also way less stealthy than with FatDuke’s sniffing of the real User-Agent used by the\nlocal browser. This reinforces our hypothesis that this backdoor was used many years ago and is no longer\ndeployed in the wild.\n\n#### 5. CONCLUSION\n\n_Operation Ghost shows that the Dukes never stopped their espionage activities. They were in the spotlight_\nafter the breach of the Democratic National Committee during the 2016 US presidential elections. However,\nthey then recovered from that media attention and rebuilt most of their toolset.\n\nUsing these new tools and previously used techniques, such as leveraging Twitter and steganography, they\nwere able to breach Foreign Affairs Ministries of several European governments.\n\nThis campaign also shows that APT threat actors going dark for several years does not mean they have\nstopped spying. They might pause for a while and re-appear in another form, but they still need to spy to\nfulfill their mandates.\n\nTo help defenders better protect their networks, we will continue to monitor the Dukes’ developments.\n\n[Indicators of Compromise can also be found on GitHub. For any inquiries, or to make sample submissions](https://github.com/eset/malware-ioc/tree/master/dukes)\n[related to the subject, contact us at: threatintel@eset.com.](mailto:threatintel%40eset.com?subject=Dukes)\n\n\n-----\n\n#### 6. BIBLIOGRAPHY\n\n1 D. Alperovitch, “Bears in the Midst: Intrusion into the Democratic National Committee,” 15 06 2016. [Online].\n[Available: https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/.](https://www.crowdstrike.com/blog/bears-midst-intrusion-democratic-national-committee/)\n\n2 Department of Homeland Security, “Enhanced Analysis of GRIZZLY STEPPE Activity,” 10 02 2017. [Online].\n[Available: https://www.us-cert.gov/sites/default/files/publications/AR-17-20045_Enhanced_Analysis_of_GRIZZLY_](https://www.us-cert.gov/sites/default/files/publications/AR-17-20045_Enhanced_Analysis_of_GRIZZLY_STEPPE_Activity.pdf)\n_[STEPPE_Activity.pdf.](https://www.us-cert.gov/sites/default/files/publications/AR-17-20045_Enhanced_Analysis_of_GRIZZLY_STEPPE_Activity.pdf)_\n\n3 GReAT, “The MiniDuke Mystery: PDF 0-day Government Spy Assembler 0x29A Micro Backdoor,”\n27 02 2013. [Online]. Available:\n_[https://securelist.com/the-miniduke-mystery-pdf-0-day-government-spy-assembler-0x29a-micro-backdoor/31112/.](https://securelist.com/the-miniduke-mystery-pdf-0-day-government-spy-assembler-0x29a-micro-backdoor/31112/)_\n\n4 A. Lehtiö, “THE DUKES: 7 years of Russian cyberespionage,” 17 09 2015. [Online].\n[Available: https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf.](https://www.f-secure.com/documents/996508/1030745/dukes_whitepaper.pdf)\n\n5 S. R. Skjeggestad, H. Stolt-Nielsen, L. Tomter, E. Omland and A. Strønen, “Norge utsatt for et omfattende\nhackerangrep,” 07 02 2017. [Online]. Available:\n_[https://www.nrk.no/norge/norge-utsatt-for-et-omfattende-hackerangrep-1.13358988.](https://www.nrk.no/norge/norge-utsatt-for-et-omfattende-hackerangrep-1.13358988)_\n\n6 A. T. Matthew Dunwoody, B. Withnell, J. Leathery, M. Matonis and N. Carr, “Not So Cozy: An Uncomfortable\n[Examination of a Suspected APT29 Phishing Campaign,” 19 11 2018. [Online]. Available: https://www.fireeye.com/](https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html)\n_[blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html.](https://www.fireeye.com/blog/threat-research/2018/11/not-so-cozy-an-uncomfortable-examination-of-a-suspected-apt29-phishing-campaign.html)_\n\n7 A. Cherepanov, “GREYENERGY: A successor to BlackEnergy,” 10 2018. [Online]. Available:\n_[https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf.](https://www.welivesecurity.com/wp-content/uploads/2018/10/ESET_GreyEnergy.pdf)_\n\n8 A. Cherepanov, “The rise of TeleBots: Analyzing disruptive KillDisk attacks,” ESET, 13 12 2016. [Online].\n[Available: https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/.](https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/)\n\n9 T. Brewster, “Sophisticated ‘MiniDuke’ hackers start hunting governments and drug\n[dealers,” 03 07 2014. [Online]. Available: https://www.theguardian.com/technology/2014/jul/03/](https://www.theguardian.com/technology/2014/jul/03/miniduke-hackers-governments-drug-dealers-kaspersky)\n_[miniduke-hackers-governments-drug-dealers-kaspersky.](https://www.theguardian.com/technology/2014/jul/03/miniduke-hackers-governments-drug-dealers-kaspersky)_\n\n10 F-Secure, “COZYDUKE,” 22 04 2015. [Online]. Available:\n_[https://www.f-secure.com/documents/996508/1030745/CozyDuke.](https://www.f-secure.com/documents/996508/1030745/CozyDuke)_\n\n11 M. Dunwoody, “Dissecting One of APT29’s Fileless WMI and PowerShell Backdoors (POSHSPY),”\n[03 04 2017. [Online]. Available: https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html.](https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html)\n\n12 FireEye, “HAMMERTOSS: Stealthy Tactics Define a Russian Cyber Threat Group,” 07 2015. [Online].\n[Available: https://www2.fireeye.com/rs/848-DID-242/images/rpt-apt29-hammertoss.pdf.](https://www2.fireeye.com/rs/848-DID-242/images/rpt-apt29-hammertoss.pdf)\n\n13 Symantec Security Response, “’Forkmeiamfamous’: Seaduke, latest weapon in the Duke armory,”\n13 07 2015. [Online]. Available:\n_[https://www.symantec.com/connect/blogs/forkmeiamfamous-seaduke-latest-weapon-duke-armory.](https://www.symantec.com/connect/blogs/forkmeiamfamous-seaduke-latest-weapon-duke-armory)_\n\n14 S. Adair, “PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think\n[Tanks and NGOs,” 09 11 2016. [Online]. Available: https://www.volexity.com/blog/2016/11/09/](https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/)\n_[powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/.](https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/)_\n\n15 J. Pitts, “The Case of the Modified Binaries,” 23 10 2014. [Online]. Available:\n_[https://www.leviathansecurity.com/blog/the-case-of-the-modified-binaries/.](https://www.leviathansecurity.com/blog/the-case-of-the-modified-binaries/)_\n\n16 A. Lehtiö, “OnionDuke: APT Attacks Via the Tor Network,” 14 11 2014. [Online]. Available:\n_[https://www.f-secure.com/weblog/archives/00002764.html.](https://www.f-secure.com/weblog/archives/00002764.html)_\n\n17 ESET Research, “Miniduke still duking it out,” 20 05 2014. [Online]. Available:\n_[https://www.welivesecurity.com/2014/05/20/miniduke-still-duking/.](https://www.welivesecurity.com/2014/05/20/miniduke-still-duking/)_\n\n18 S. Lozhkin, “Minidionis – one more APT with a usage of cloud drives,” 15 07 2015. [Online]. Available:\n_[https://securelist.com/minidionis-one-more-apt-with-a-usage-of-cloud-drives/71443/.](https://securelist.com/minidionis-one-more-apt-with-a-usage-of-cloud-drives/71443/)_\n\n19 J.-I. Boutin and M. Faou, “Visiting the snake nest,” 01 2018. [Online]. Available:\n_[https://recon.cx/2018/brussels/resources/slides/RECON-BRX-2018-Visiting-The-Snake-Nest.pdf.](https://recon.cx/2018/brussels/resources/slides/RECON-BRX-2018-Visiting-The-Snake-Nest.pdf)_\n\n\n-----\n\n20 ESET Research, “En Route with Sednit,” 10 2016. [Online]. Available:\n_[https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-full.pdf.](https://www.welivesecurity.com/wp-content/uploads/2016/10/eset-sednit-full.pdf)_\n\n21 GReAT, “Miniduke is back: Nemesis Gemina and the Botgen Studio,” 03 07 2014. [Online]. Available:\n_[https://securelist.com/miniduke-is-back-nemesis-gemina-and-the-botgen-studio/64107/.](https://securelist.com/miniduke-is-back-nemesis-gemina-and-the-botgen-studio/64107/)_\n\n22 The Unicode Consortium, “Katakana Range: 30A0–30FF,” [Online]. Available:\n_[https://www.unicode.org/charts/PDF/U30A0.pdf.](https://www.unicode.org/charts/PDF/U30A0.pdf)_\n\n23 The Unicode Consortium, “Cherokee Range: 13A0-13FF,” [Online]. Available:\n_[https://unicode.org/charts/PDF/U13A0.pdf.](https://unicode.org/charts/PDF/U13A0.pdf)_\n\n24 The Unicode Consortium, “Kangxi Radicals Range: 2F00-2FDF,” [Online]. Available:\n_[https://unicode.org/charts/PDF/U2F00.pdf.](https://unicode.org/charts/PDF/U2F00.pdf)_\n\n25 [P.-M. Bureau and C. Dietrich, “Hiding in Plain Sight,” 2015. [Online]. Available: https://www.blackhat.com/docs/](https://www.blackhat.com/docs/eu-15/materials/eu-15-Bureau-Hiding-In-Plain-Sight-Advances-In-Malware-Covert-Communication-Channels.pdf)\n_[eu-15/materials/eu-15-Bureau-Hiding-In-Plain-Sight-Advances-In-Malware-Covert-Communication-Channels.pdf.](https://www.blackhat.com/docs/eu-15/materials/eu-15-Bureau-Hiding-In-Plain-Sight-Advances-In-Malware-Covert-Communication-Channels.pdf)_\n\n26 T. László and Á. Kiss, “Obfuscating C++ programs via control flow flattening,” 08 2009. [Online].\n[Available: http://ac.inf.elte.hu/Vol_030_2009/003.pdf.](http://ac.inf.elte.hu/Vol_030_2009/003.pdf)\n\n27 Skylight, “Cylance, I Kill You!,” 18 07 2019. [Online]. Available:\n_[https://skylightcyber.com/2019/07/18/cylance-i-kill-you/.](https://skylightcyber.com/2019/07/18/cylance-i-kill-you/)_\n\n\n-----\n\n#### 7. INDICATORS OF COMPROMISE\n\n##### 7.1 Hashes\n\nCompilation ESET detection\nComponent SHA-1\nDate name\n\n`4BA559C403FF3F5CC2571AE0961EAFF6CF0A50F6` 07/07/2014 Win32/Agent.ZWH\n\n`CF14AC569A63DF214128F375C12D90E535770395` 07/06/2017 Win32/Agent.AAPY\n\n\nPolyglotDuke\n\nRegDuke Loader\n\n\n`539D021CD17D901539A5E1132ECAAB7164ED5DB5` 07/06/2017 Win32/Agent.ZWH\n\n`0E25EE58B119DD48B7C9931879294AC3FC433F50` 07/08/2017 Win64/Agent.OL\n\n`D625C7CE9DC7E56A29EC9A81650280EDC6189616` 19/10/2018 Win64/Agent.OL\n\n`0A5A7DD4AD0F2E50F3577F8D43A4C55DDC1D80CF` 21/12/2017 MSIL/Tiny.BG\n\n`F7FD63C0534D2F717FD5325D4397597C9EE4065F` 10/07/2018 MSIL/Tiny.BG\n\n`194D8E2AE4C723CE5FE11C4D9CFEFBBA32DCF766` 29/08/2018 MSIL/Agent.TGC\n\n`64D6C11FFF2C2AADAACEE01B294AFCC751316176` 01/10/2018 MSIL/Agent.SVP\n\n`6ACC0B1230303F8CF46152697D3036D69EA5A849` 25/10/2018 MSIL/Agent.SXO\n\n`170BE45669026F3C1FC5BA2D48817DBF950DA3F6` 01/12/2018 MSIL/Agent.SYC\n\n\nRegDuke Backdoor `5905C55189C683BC37258AEC28E916C41948CD1C` 29/08/2018 MSIL/Agent.CAW\n\n`B05CABA461000C6EBD8B237F318577E9BCCD6047` 17/08/2018 Win32/Agent.TSG\nMiniDuke\n\n`718C2CE6170D6CA505297B41DE072D8D3B873456` 24/06/2019 Win32/Agent.TUF\n\n`A88DA2DD033775F7ABC8D6FB3AD5DD48EFBEADE1` 03/05/2017 Win32/Agent.TSH\nFatDuke\n\n`DB19171B239EF6DE8E83B2926EADC652E74A5AFA` 22/05/2019 Win32/Agent.TSH\n\nFatDuke Loader `9E96B00E9F7EB94A944269108B9E02D97142EEDC` 19/04/2019 Win32/Agent.AAPY\n\nLiteDuke `AF2B46D4371CE632E2669FEA1959EE8AF4EC39CE` 02/10/2014 Win32/Agent.AART\n\n##### 7.2 Network\n\n###### Domains\n\nComponent Domain\n```\n                acciaio.com[.]br\n                ceycarb[.]com\n                coachandcook[.]at\n\n```\nfisioterapiabb[.]it\n```\n                lorriratzlaff[.]com\n\n```\n\nPolyglotDuke\n\n```\nmavin21c.dothome.co[.]kr\nmotherlodebulldogclub[.]com\npowerpolymerindustry[.]com\npubliccouncil[.]org\nrulourialuminiu.co[.]uk\nsistemikan[.]com\nvaruhusmc[.]org\n\n```\n```\n               ecolesndmessines[.]org\n\n```\nMiniDuke\n```\n               salesappliances[.]com\n\n```\n\nFatDuke\n\n\nbusseylawoffice[.]com\n\nfairfieldsch[.]org\n```\nministernetwork[.]org\nskagenyoga[.]com\nwestmedicalgroup[.]net\n\n```\n\nLiteDuke `bandabonga[.]fr`\n\n\n-----\n\n###### Public webpages used by PolyglotDuke\n```\n  http://ibb[.]co/hVhaAq\n  http://imgur[.]com/1RzfF7r\n  http://imgur[.]com/6wjspWp\n  http://imgur[.]com/d4ObKL0\n  http://imgur[.]com/D6U06Ci\n  http://imgur[.]com/GZSK9zI\n  http://imgur[.]com/wcMk7a2\n  http://imgur[.]com/WMTwSMJ\n  http://imgur[.]com/WOKHonk\n  http://imgur[.]com/XFa7Ee1\n  http://jack998899jack.imgbb[.]com\n  http://simp[.]ly/publish/pBn8Jt\n  http://thinkery[.]me/billywilliams/5a0170161cb602262f000d2c\n\n```\nhttp://twitter[.]com/aimeefleming25\n```\n  http://twitter[.]com/hen_rivero\n  http://twitter[.]com/JamesScott1990\n  http://twitter[.]com/KarimM_traveler\n  http://twitter[.]com/lerg5pvo1i\n  http://twitter[.]com/m63vhd7ach3\n  http://twitter[.]com/MarlinTarin\n  http://twitter[.]com/np8j7ovqdl\n  http://twitter[.]com/q5euqysfu5\n  http://twitter[.]com/qistp743li\n  http://twitter[.]com/t8t842io2\n  http://twitter[.]com/ua6ivyxkfv\n  http://twitter[.]com/utyi5asko02\n  http://twitter[.]com/vgmmmyqaq\n  http://twitter[.]com/vvwc63tgz\n  http://twitter[.]com/wekcddkg2ra\n  http://twitter[.]com/xzg3a2e2z\n  http://www.evernote[.]com/shard/s675/sh/6686ff4e-8896-499b-8cdb-a2bbf2cc4db9/\n  fc7fbe66c820f17c30147235e95d31b8\n  http://www.fotolog[.]com/g1h4wuiz6\n  http://www.fotolog[.]com/gf3z425rr0\n  http://www.fotolog[.]com/i4ntff47xfw\n  http://www.fotolog[.]com/joannevil/121000000000030009/\n  http://www.fotolog[.]com/o2rh2s2x7pu\n  http://www.fotolog[.]com/q4tusizx9xb\n  http://www.fotolog[.]com/rypnil03sl6\n  http://www.fotolog[.]com/shx8hypubt\n  http://www.fotolog[.]com/u99aliw5g\n  http://www.fotolog[.]com/uq44y4j19m8\n  http://www.fotolog[.]com/vq21p34\n  http://www.fotolog[.]com/vz1g3wmwu\n\n```\nhttp://www.fotolog[.]com/zu2of5vyfl6\n```\n  http://www.google[.]com/?gws_rd=ssl#q=Heiofjskghwe+Hjwefkbqw\n  http://www.kiwibox[.]com/AfricanRugby/info/\n  http://www.kiwibox[.]com/GaryPhotographe/info/\n  http://www.reddit[.]com/user/BeaumontV/\n  http://www.reddit[.]com/user/StevensThomasWis/\n\n```\n\n-----\n\n#### 8. MITRE ATT&CK TECHNIQUES\n\nTactic ID Name Description\n\n\nInitial\nAccess\n\nExecution\n\nPersistence\n\nDefense\nEvasion\n\nDiscovery\n\n\nSpearphishing The Dukes likely used spearphishing emails to compromise\n_[T1193](https://attack.mitre.org/techniques/T1193/)_\nAttachment the target.\n\nOperators use account credentials previously stolen\n_[T1078](https://attack.mitre.org/techniques/T1078/)_ Valid Accounts\nto come back on the victim’s network.\n\nThey use CreateProcess or LoadLibrary Windows APIs\n_[T1106](https://attack.mitre.org/techniques/T1106/)_ Execution through API\nto execute binaries.\n\nExecution through\n_[T1129](https://attack.mitre.org/techniques/T1129/)_ Some of their malware load DLL using LoadLibrary Windows API.\nModule Load\n\n_[T1086](https://attack.mitre.org/techniques/T1086/)_ PowerShell FatDuke can execute PowerShell scripts.\n\n_[T1085](https://attack.mitre.org/techniques/T1085/)_ Rundll32 The FatDuke loader uses rundll32 to execute the main DLL.\n\n_[T1064](https://attack.mitre.org/techniques/T1064/)_ Scripting FatDuke can execute PowerShell scripts.\n\n_[T1035](https://attack.mitre.org/techniques/T1035/)_ Service Execution The Dukes use PsExec to execute binaries on remote hosts.\n\nRegistry Run Keys / The Dukes use the CurrentVersion\\Run registry key to establish\n_[T1060](https://attack.mitre.org/techniques/T1060/)_\nStartup Folder persistence on compromised computers.\n\n_[T1053](https://attack.mitre.org/techniques/T1053/)_ Scheduled Task The Dukes use Scheduled Task to launch malware at startup.\n\nThe Dukes use account credentials previously stolen to come\n_[T1078](https://attack.mitre.org/techniques/T1078/)_ Valid Accounts\nback on the victim’s network.\n\n\n_[T1085](https://attack.mitre.org/techniques/T1085/)_ Rundll32 The FatDuke loader uses rundll32 to execute the main DLL.\n\n_[T1064](https://attack.mitre.org/techniques/T1064/)_ Scripting FatDuke can execute PowerShell scripts.\n\nThe Dukes use a custom packer to obfuscate MiniDuke\n_[T1045](https://attack.mitre.org/techniques/T1045/)_ Software Packing and FatDuke binaries. They also use the commercial packer\n.NET Reactor to obfuscate RegDuke.\n\nThe Dukes use account credentials previously stolen\n_[T1078](https://attack.mitre.org/techniques/T1078/)_ Valid Accounts\nto come back on the victim’s network.\n\nPolyglotDuke fetches public webpages (Twitter, Reddit,\n_[T1102](https://attack.mitre.org/techniques/T1102/)_ Web Service Imgur, etc.) to get encrypted strings leading to new C&C.\nserver. For RegDuke, they also use Dropbox as a C&C server.\n\nFile and Directory The Dukes can interact with files and directories\n_[T1083](https://attack.mitre.org/techniques/T1083/)_\nDiscovery on the victim’s computer.\n\n_[T1135](https://attack.mitre.org/techniques/T1135/)_ Network Share Discovery The Dukes can list network shares.\n\n_[T1057](https://attack.mitre.org/techniques/T1057/)_ Process Discovery The Dukes can list running processes.\n\n\n_[T1084](https://attack.mitre.org/techniques/T1084/)_\n\n\nWindows Management\nInstrumentation Event The Dukes used WMI to establish persistence for RegDuke.\nSubscription\n\n\nDeobfuscate/Decode The droppers for PolyglotDuke and LiteDuke embed\n_[T1140](https://attack.mitre.org/techniques/T1140/)_\nFiles or Information encrypted payloads.\n\n_[T1107](https://attack.mitre.org/techniques/T1107/)_ File Deletion The Dukes malware can delete files and directories.\n\nThe keys used to decrypt RegDuke payloads are stored\n_[T1112](https://attack.mitre.org/techniques/T1112/)_ Modify Registry\nin the Windows registry.\n\n\nObfuscated Files\n_[T1027](https://attack.mitre.org/techniques/T1027/)_\nor Information\n\n\nThe Dukes encrypts PolyglotDuke and LiteDuke payloads\nwith custom algorithms. They also rely on known obfuscation\ntechniques such as opaque predicates and control flow\nflattening to obfuscate RegDuke, MiniDuke and FatDuke.\n\n\nSystem Network\n_[T1049](https://attack.mitre.org/techniques/T1049/)_\nConnections Discovery\n\n\nThe Dukes can execute commands like net use to gather\ninformation on network connections.\n\n\nLateral\n_[T1077](https://attack.mitre.org/techniques/T1077/)_ Windows Admin Shares The Dukes use PsExec to execute binaries on a remote host.\nMovement\n\n\n-----\n\nCollection\n\nCommand\nand Control\n\n\n_[T1005](https://attack.mitre.org/techniques/T1005/)_ Data from Local System The Dukes can collect files on the compromised machines\n\nData from Network\n_[T1039](https://attack.mitre.org/techniques/T1039/)_ The Dukes can collect files on shared drives.\nShared Drive\n\nData from Removable\n_[T1025](https://attack.mitre.org/techniques/T1025/)_ The Dukes can collect files on removable drives.\nMedia\n\n\nThe Dukes use steganography to hide payloads and commands\n_[T1001](https://attack.mitre.org/techniques/T1001/)_ Data Obfuscation\ninside valid images.\n\nThe Dukes have multiple C&C servers in case one of them\n_[T1008](https://attack.mitre.org/techniques/T1008/)_ Fallback Channels\nis down.\n\nStandard Application The Dukes are using HTTP and HTTPS protocols\n_[T1071](https://attack.mitre.org/techniques/T1071/)_\nLayer Protocol to communicate with the C&C server.\n\nPolyglotDuke fetches public webpages (Twitter, Reddit,\n_[T1102](https://attack.mitre.org/techniques/T1102/)_ Web Service Imgur, etc.) to get encrypted strings leading to new C&C server.\nFor RegDuke, they also use Dropbox as a C&C server.\n\n\n_[T1090](https://attack.mitre.org/techniques/T1090/)_ Connection Proxy\n\n\nThe Dukes can communicate to the C&C server via proxy.\nThey also use named pipes as proxies when a machine\nis isolated within a network and does not have direct access\nto the internet.\n\n\nExfiltration _[T1041](https://attack.mitre.org/techniques/T1041/)_\n\n\nExfiltration Over\nCommand and Control The Dukes use the C&C channel to exfiltrate stolen data.\nChannel\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Operation_Ghost_Dukes.pdf",
        "https://app.box.com/s/vx5jjdejjunjzizwsfl7g4gm163vn4nh",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.10.17.Operation_Ghost/ESET_Operation_Ghost_Dukes.pdf"
    ],
    "report_names": [
        "ESET_Operation_Ghost_Dukes.pdf",
        "ESET_Operation_Ghost_Dukes(10-19-2019)",
        "ESET_Operation_Ghost_Dukes"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d9cdc7f-72d6-4e17-89d8-f6323bfcaebb",
            "created_at": "2023-01-06T13:46:38.82716Z",
            "updated_at": "2025-03-27T02:00:02.928984Z",
            "deleted_at": null,
            "main_name": "GreyEnergy",
            "aliases": [],
            "source_name": "MISPGALAXY:GreyEnergy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "39842197-944a-49fd-9bec-eafa1807e0ea",
            "created_at": "2022-10-25T16:07:24.310589Z",
            "updated_at": "2025-03-27T02:02:10.167471Z",
            "deleted_at": null,
            "main_name": "TeleBots",
            "aliases": [],
            "source_name": "ETDA:TeleBots",
            "tools": [
                "BadRabbit",
                "Black Energy",
                "BlackEnergy",
                "CredRaptor",
                "Diskcoder.C",
                "EternalPetya",
                "ExPetr",
                "Exaramel",
                "FakeTC",
                "Felixroot",
                "GreyEnergy",
                "GreyEnergy mini",
                "KillDisk",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "NonPetya",
                "NotPetya",
                "Nyetya",
                "Petna",
                "Petrwrap",
                "Pnyetya",
                "TeleBot",
                "TeleDoor",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "nPetya"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1570616180,
    "ts_modification_date": 1570616186,
    "files": {
        "pdf": "https://archive.orkl.eu/d6f66a51549b7c2090135e8cb8c40a68c152018d.pdf",
        "text": "https://archive.orkl.eu/d6f66a51549b7c2090135e8cb8c40a68c152018d.txt",
        "img": "https://archive.orkl.eu/d6f66a51549b7c2090135e8cb8c40a68c152018d.jpg"
    }
}