{
    "id": "ef7fc118-a477-4ea5-addc-5b9659da5949",
    "created_at": "2023-01-12T15:03:39.179638Z",
    "updated_at": "2025-03-27T02:09:17.95349Z",
    "deleted_at": null,
    "sha1_hash": "f7baa3bde47d2332ec83e403ee1c00785bb44a3a",
    "title": "2022-02-01 - Zoom For You — SEO Poisoning to Distribute BATLOADER and Atera Agent",
    "authors": "",
    "file_creation_date": "2022-12-29T00:26:39Z",
    "file_modification_date": "2022-12-29T00:26:39Z",
    "file_size": 3560768,
    "plain_text": "# Zoom For You — SEO Poisoning to Distribute BATLOADER and Atera Agent\n\n**mandiant.com/resources/seo-poisoning-batloader-atera**\n\nBlog\n\nNg Choon Kiat, Angelo Del Rosario, Martin Co\n\nFeb 01, 2022\n\n7 min read\n\nThreat Research\n\nThreat Hunting\n\nManaged Defense\n\nMalware\n\n[While defending our customers against threats, Mandiant Managed Defense continues to](https://www.mandiant.com/advantage/managed-defense)\nsee new threats that abuse trust in legitimate tools and products to carry out their attacks.\nThese attacks are effective in getting past security defenses and staying undetected in a\nnetwork.\n\n\n-----\n\nThrough proactive threat hunting, our Managed Defense frontline team uncovered a\ncampaign that used search engine optimization (SEO) poisoning to lead victims to download\nthe [BATLOADER malware for the initial compromise. We also observed a crafty defense](https://advantage.mandiant.com/malware/malware--6fc1a6d9-a41e-56ab-8954-b0987f818273)\nevasion technique using mshta.exe, a Windows-native utility designed to execute Microsoft\nHTML Application (HTA) files.\n\nSEO poisoning is an attack method in which threat actors create malicious websites packed\nwith keywords and use search engine optimization techniques to make them show up\nprominently in search results.\n\n## Infection Chain\n\nThe threat actor used “free productivity apps installation” or “free software development tools\ninstallation” themes as SEO keywords to lure victims to a compromised website and to\ndownload a malicious installer. The installer contains legitimate software bundled with the\nBATLOADER malware. The BATLOADER malware is dropped and executed during the\nsoftware installation process.\n\nThis initial BATLOADER compromise was the beginning of a multi-stage infection chain that\nprovides the attackers with a foothold inside the target organization. Every stage was\nprepared for the next phase of the attack chain. And legitimate tools such as PowerShell,\nMsiexec.exe, and Mshta.exe allow proxy execution of malicious payloads to avoid detection.\n\n## CVE-2020-1599 Patch Bypass\n\nOne notable sample found in the attack chain was a file named, “AppResolver.dll”. This DLL\nsample is an internal component of the Microsoft Windows Operating System developed by\nMicrosoft, but with malicious VBScript embedded inside in a way that the code signature\nremains valid. The DLL sample does not execute the VBScript when run by itself. But when\nrun with Mshta.exe, Mshta.exe locates and executes the VBScript without any issues.\n\n[This issue most closely resembles CVE-2020-1599, PE Authenticode signature remains](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2020-1599)\nvalid after appending HTA supported scripts signed by any software developer. These\nPE+HTA polyglot (.hta files) can be exploited through Mshta.exe to bypass security solutions\nthat rely on Microsoft Windows code signing to decide if files are trusted. This issue was\npatched as CVE-2020-1599.\n\nIn this case, we observed arbitrary script data was appended to the signature section beyond\nthe end of the ASN.1 of a legitimately signed Windows PE file. The resultant polyglot file\nmaintains a valid signature as long as the file has a file extension other than '.hta'. This\npolyglot file will successfully execute the script contents if it is executed with Mshta.exe, as\n\n\n-----\n\nMshta.exe will skip the PE s bytes, locate the script at the end, and execute it. This evasion\ntechnique was used several times during the attack chain to change the host settings and to\nlaunch payloads.\n\nAt the latter stages, goodware such as Gpg4win Utility, [NSUDO Utility, ATERA, and](https://advantage.mandiant.com/malware/malware--24c44ea9-4ddf-5941-8842-94cd3e3145f6)\nSplashTop, are seen installed as part of the attack chain of this campaign. These are to\nsupport remote access, privilege escalation, launching of payloads, encryption, and\n[persistence. There was also malware such as BEACON,](https://www.mandiant.com/resources/defining-cobalt-strike-components) [URSNIF deployed to provide](https://advantage.mandiant.com/malware/malware--b2bd3b57-8820-5c18-a383-990cc3d97c72)\nbackdoor and credential-stealing capabilities.\n\nAttack chain of the BATLOADER campaign\n\n## An Alternate Infection Chain\n\nAlternatively, the Threat Actor may deploy ATERA directly as the initial compromise.\nSimilarly, through SEO poisoning, victims were lured to download an ATERA Agent\nInstallation Package. The installer masquerades as a “free legitimate software” to lure the\nvictim into installing it onto the host for the initial compromise.\n\nATERA is a Remote Monitoring Management Software. It provides IT Automation, Host, and\nNetwork Discovery features. SplashTop is software that can be integrated into ATERA is to\nprovide remote access to a host. The infection chain is as follows:\n\nA user performs a Google search and clicks a link to an actor-created page on a\ncompromised website (Figure 1).\n\n\n-----\n\nFigure 1: Google search results with link to the actor-created content on the compromised\nwebsite\n\nThe benign blog post (Figure 2) will abuse a Traffic Direction System (TDS) to decide if\nthe user should be directed to a webpage that masquerades as a message board that\nhas posted a download link (Figure 3).\n\nFigure 2: Benign blog post\n\n\n-----\n\nFigure 3: Actor-created discussion board with malicious download link\n\nThe download link delivers the ATERA Agent Installer Package, named after the search\nterm. (Figure 4 and Figure 5).\n\nFigure 4: Atera Agent Installer Package named after the search term\n\n\n-----\n\nFigure 5: ATERA Agent Installer Package Masquerading as Microsoft Community Visual\nStudio 2015\n\nAn example of the installation of an ATERA Agent masquerading as “Microsoft\nCommunity Visual Studio 2015 Free.msi” (Figure 6).\n\nFigure 6: Installation of an Atera Agent\n\nAfter the successful ATERA Agent installation, the Splashtop will be downloaded to the\nC:\\Windows\\Temp directory, and installed on the victim’s host to maintain persistence\n(Figure 7 and Figure 8).\nAfter the successful ATERA Agent installation, the ATERA Remote Monitoring &\nManagement capabilities will push down pre-configured scripts, tools such as\nSplashtop Streamer to be installed and run on the victim’s host in a real-time and\nautomated fashion.\n\n\n-----\n\nFigure 7: Auto Deployment of the Splashtop Software\n\nThe ATERA Agent will remove itself after the successful Splashtop Streamer\ninstallation. The default configuration of the Splashtop Streamer is set to AutoStart\nrunning in background without security authentication to connect to the victim’s host to\nmaintain persistence.\n\nFigure 8: Splashtop Streamer Default Configuration\n\nScripts were also pushed down by ATERA Agent to perform malicious task such as\ndisabling functionalities and adding process and file exclusions for Microsoft Windows\nDefender (Figure 9 and Figure 10).\n\n\n-----\n\nFigure 9: Malicious Script that was consistent of disabling Microsoft Windows Defender\nfunctionalities\n\nFigure 10: Malicious Script to download further payload\n\n## Attribution\n\nIn August 2021, a disgruntled CONTI affiliate leaked training documents, playbooks, and\ntools used to assist in CONTI ransomware operations. Mandiant has determined that some\nof the activity listed above overlaps with techniques in the playbooks disclosed in August.\n\nAt this time, due to the public release of this information, other unaffiliated actors may be\nreplicating the techniques for their own motives and objectives. These victims seem to\noperate in a wide range of industries. The threat group's motivations are currently unknown,\nbut we suspect that the group is financially motivated based on the seemingly industryagnostic leading to ransomware activity.\n\n## Managed Defense Threat Hunting\n\n\n-----\n\n[Experienced defenders from Managed Defense are constantly inspired by Mandiant s global](https://www.mandiant.com/advantage/managed-defense)\ncyber threat intelligence and incident response experiences gained on the frontlines of the\nworld’s most consequential cyber-attacks. Fueled by up-to-the-minute threat intelligence, the\nManaged Defense threat hunting team designs and conducts hunt missions to reveal the\nstealthiest threat actors. Mandiant threat hunting combines powerful data analytics,\nautomation and elite experts with intuition and frontline experience. You can follow our\nhunters as their work unfolds in the Managed Defense portal. Each mission is mapped to the\nMITRE ATT&CK framework and includes related intelligence so you can take decisive action\nthroughout your environment.\n\n## Technical Indicators & Warnings\n\n### MD5\n\n1440caafb45e52b0b315c7467fcde11f\n\n2077d8a65c8b08d64123c4ba3f03cbdd\n\n2141919f65ab3ff4eab25e5032e25598\n\n229152f0b00d55796780b00c233bf641\n\n29bc15a6f0ff99084e986c3e6ab1208c\n\n2b16a731a2e4dedfa3db0bf3068614bc\n\n32885d012fa3b50199d7cde9735bcb8a\n\n32cd02c4cd8938645a744b915056d133\n\n3393bd9d04be1ff4e537464e1b79d078\n\n3abbec0420aaf7a9960d9eabc08006d5\n\n3e06c87faede153d4dab5ef1066fe0d7\n\n3ed96f460438e7fddaa48e96c65cb44c\n\n428166c513ed98c72e35fe127a9b5be6\n\n48942b45679b3646000ac2fb6a99e0ed\n\n5376112bebb371cdbe6b2a996fb6dae6\n\n5cae01aea8ed390ce9bec17b6c1237e4\n\n\n-----\n\n5cae01aea8ed390ce9bec17b6c1237e4\n\n60db9dff2e50e00e937661d2a6950562\n\n67a4f35cae2896e3922f6f4ab5966e2b\n\n67a4f35cae2896e3922f6f4ab5966e2b\n\n6ad4e37221adf3861bfa99a1c1d5faaa\n\n6cd13e6429148e7f076b479664084488\n\n7127cbc56e42fc59a09fd9006dd09daa\n\n7575ecc5ac5ac568054eb36a5c8656c4\n\n849b46e14df68dd687e71c7df8223082\n\n8eb5f0bbd73b5ca32e60deb34e435320\n\n9ed2084c6c01935dc5bb2508357be5a6\n\n9f03ad59cb06b40e6187ef6d22d3b76b\n\na046e40693a33a1db2aec6d171d352ce\n\na0b793ff07493951ed392cdc641d3d62\n\na45c0a83ce2ea52d8edf915b1e169b8f\n\nb4a8b58857649fad1cf8f247a0496c95\n\nb850920c95b694f63aa47fc991396457\n\nb9c9da113335874d0341f0ac1f5e225d\n\nbd20223cb57c55559db81f17ef616070\n\nc02916697ed71e5868d8ea456a4a1871\n\nc08de039a30c3d3e1b1d18a9d353f44c\n\nc12452167e810cde373d7a59d3302370\n\nc9be3451e713382ecf0f7da656cef657\n\ncb1fcc1c0c35cd4e0515b8bf02ba3303\n\nd14b4a96edf70c74afe3d99101daaff8\n\n\n-----\n\ne33847174fbd2b09abc418c1338fceec\n\ne5decd05056634eace35396a22148bf1\n\ne66ba648666c823433c473e6cfc2e4fc\n\ne6c2dd8956074363e7d6708fb8063001\n\ne6c2dd8956074363e7d6708fb8063001\n\nf535505f337708fbb41cdd0830c6a2d4\n\n### Network Indicators\n\ncmdadminu[.]com\n\nzoomvideo-s[.]com\n\ncloudfiletehnology[.]com\n\ncommandaadmin[.]com\n\nclouds222[.]com\n\nwebsekir[.]com\n\nteam-viewer[.]site\n\nzoomvideo[.]site\n\nsweepcakesoffers[.]com\n\npornofilmspremium[.]com\n\nkdsjdsadas[.]online\n\nbartmaaz[.]com\n\nfirsone1[.]online\n\n178.21.11[.]77\n\n193.124.18[.]128\n\n### YARA\n\n\n-----\n\nrule M_Hunting_Downloader_BATLOADER_1\n\n{\n\nmeta:\n\nauthor = \"Mandiant\"\n\ndate_created = \"2021-10-28\"\n\ndate_modified = \"2021-10-28\"\n\nversion = \"1.0\"\n\ndescription = \"Detects strings for BATLOADER sample\"\n\nmd5 = \"6cd13e6429148e7f076b479664084488\"\n\nstrings:\n\n$s1 = \"launch.bat\" ascii\n\n$s2 = \"Error writing to batch file:\" ascii\n\n$s3 = \"cmd.exe\" ascii\n\n$s4 = \"/C\" ascii\n\n$s5 = \"You entered an invalid email, please enter the email that was registered on\nwebsite.\" ascii\n\ncondition:\n\nuint16(0) == 0x5A4D and filesize > 4KB and filesize < 5MB and all of them\n\n}\n\n## MITRE ATT&CK Mapping\n\n**ATT&CK Tactic Category** **Techniques**\n\nReconnaissance Search Open Websites/Domains (T1593.002)\n\n\nSearch Engines (T1593.002)\n\n\n-----\n\nResource Development Compromise Infrastructure (T1584)\n\n\nStage Capabilities (T1608)\n\nUpload Malware (T1608.001)\n\nDevelop Capabilities (T1587)\n\nMalware (T1587.001)\n\n\n-----\n\nDiscovery System Information Discovery (T1082)\n\n\nSystem Network Configuration Discovery (T1016)\n\n\nCommand and Control Remote Access Software (T1219)\n\n## Acknowledgements\n\nSpecial Thanks to Alip Asri in creating the IOCs for the Hunting Missions. And Ana Maria\nMartinez Gomez, Tufail Ahmed, Stephen Eckels, Dhanesh Kizhakkinan and Jacob\nThompson for their assistance on the topic.\n\n## Have questions? Let's talk.\n\nMandiant experts are ready to answer your questions.\n\n[Contact Us](https://www.mandiant.com/contact-us)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-01 - Zoom For You — SEO Poisoning to Distribute BATLOADER and Atera Agent.pdf"
    ],
    "report_names": [
        "2022-02-01 - Zoom For You — SEO Poisoning to Distribute BATLOADER and Atera Agent.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535819,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1672273599,
    "ts_modification_date": 1672273599,
    "files": {
        "pdf": "https://archive.orkl.eu/f7baa3bde47d2332ec83e403ee1c00785bb44a3a.pdf",
        "text": "https://archive.orkl.eu/f7baa3bde47d2332ec83e403ee1c00785bb44a3a.txt",
        "img": "https://archive.orkl.eu/f7baa3bde47d2332ec83e403ee1c00785bb44a3a.jpg"
    }
}