{
    "id": "84c8345a-bbc2-4794-8fc8-20b25e07230d",
    "created_at": "2023-01-12T15:04:08.487722Z",
    "updated_at": "2025-03-27T02:12:36.950218Z",
    "deleted_at": null,
    "sha1_hash": "ba23cff324f75c69e6906c62f2048b36d96dc2a0",
    "title": "2021-10-11 - Necro Python Botnet Goes After Vulnerable VisualTools DVR",
    "authors": "",
    "file_creation_date": "2022-05-28T03:55:11Z",
    "file_modification_date": "2022-05-28T03:55:11Z",
    "file_size": 960704,
    "plain_text": "# Necro Python Botnet Goes After Vulnerable VisualTools DVR\n\n**[blogs.juniper.net/en-us/threat-research/necro-python-botnet-goes-after-vulnerable-visualtools-dvr](https://blogs.juniper.net/en-us/threat-research/necro-python-botnet-goes-after-vulnerable-visualtools-dvr)**\n\nOctober 11, 2021\n\nIn the last week of September 2021, Juniper Threat Labs detected a new activity from Necro Python (a.k.a N3Cr0m0rPh, Freakout,\nPython.IRCBot) that is actively exploiting some services, including a new exploit added to its arsenal. This new exploit targets Visual\nTools DVR VX16 4.2.28.0 from visual-tools.com (no CVE number is assigned to this vulnerability). Successful exploitation will\ndownload the bot into the system and install a Monero miner.\n\n[Necro was first discovered in January. The threat actor made a move in March and in May, adding new exploits to its arsenal.](https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/)\n\nNecro bot is an interesting python bot that has many functions which include the following:\n\nNetwork Sniffer\nSpreading by exploits\nSpreading by brute-force\nUsing Domain Generation Algorithm\nInstalling a Windows rootkit\nReceiving and executing bot commands\nParticipating in DDoS attacks\nInfecting HTML, JS, PHP files\nInstalling Monero Miner\n\nThe script can run in both Windows and Linux environments. The script has its own polymorphic engine to morph itself every\nexecution which can bypass signature-based defenses. This works by reading every string in its code and encrypting it using a\nhardcoded key.\n\n\n-----\n\nNecro Python’s\n\npolymorphism, before and after\n\n**Domain Generation Algorithm**\n\nNecro uses DGA for both its CnC and download server. It selects from a list of dynamic DNS services as its domain, e.g., ddns.net\nand prefixes that with 10-19 random characters. E.g., ‘3ood3dfcqchro.ddns.net’\n\nThe domains are pseudo-randomly generated using a hardcoded seed, 0xFAFFDED00001, and a counter is added until 0xFD (253\nin decimal) before the counter is reset to 0. The seed controls the domain to be generated. In effect, it can generate up to 253\nunique domains.\n\nThis seed is different from the previous campaigns. For instance, the sample used in the March attack used a different seed,\n**0x7774DEAD.**\n\nFrom this list of generated domains, it connects to them one by one to see which one is online. During our analysis, the following\nDGA domain was active:\n\ngtmpbeaxruxy[.]myftp.org\n```\n import random\n counter=0\n while 1:\n if counter>=0xFD:\n counter=0\n counter+=1\n random.seed(a=0xFAFFDED00001 + counter)\n DGA_DOMAIN=(''.join(random.choice('abcdefghijklmnopqoasadihcouvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789')\n for _ in range(random.randrange(10,19)))).lower()+\".\"+random.choice(['ddns.net', 'ddnsking.com',\n '3utilities.com', 'bounceme.net', 'freedynamicdns.net', 'freedynamicdns.org', 'gotdns.ch', 'hopto.org',\n 'myddns.me', 'myftp.biz', 'myftp.org', 'myvnc.com', 'onthewifi.com', 'redirectme.net', 'servebeer.com',\n 'serveblog.net', 'servecounterstrike.com', 'serveftp.com', 'servegame.com', 'servehalflife.com',\n 'servehttp.com', 'serveirc.com', 'serveminecraft.net', 'servemp3.com', 'servepics.com', 'servequake.com',\n 'sytes.net', 'viewdns.net', 'webhop.me', 'zapto.org'])\n\n```\nNecro Python’s Domain Generation Algorithm\n\nBot Commands\n\nNecro connects to the CnC server, gtmpbeaxruxy.myftp.org, via IRC to receive commands which include the following:\n\n**Command** **Function**\n\naddport add port to the scanner\n\ndelport remove port from scanner\n\nports send to server the ports currently scanned\n\ninjectcount send to server the number of files injected\n\nreinject launch function to inject to html, php, js, htm files\n\nscanner stop or launch scanner\n\n\n-----\n\nsniffer stop or launch sniffer\n\nscannetrange scan a range of IPs\n\nclearscan empty scanner DB\n\nrevshell launch a reverse shell\n\nshell launch a process using subprocess.Popen()\n\nkillknight kill itself\n\nexecute executes a file\n\nkillbyname kill process by name\n\nkillbypid kill process by pid\n\ndisable disable exploitation module\n\nenable enable exploitation module\n\ngetip get current IP\n\nram get information about the memory\n\nupdate update this bot\n\nvisit visit a URL\n\ndlexe download and execute a file\n\ninfo get system information\n\nrepack morph this bot\n\nlogout logout from the server\n\nreconnect reconnect to the server\n\nudpflood UDP flood\n\nsynflood SYN flood\n\ntcpflood TCP flood\n\nslowloris slowloris DDoS attack\n\nhttpflood launch httpflood\n\ntorflood launch DDoS using TOR SOCKS proxies\n\nloadamp initialize amplification attack\n\nreflect launch DNS reflection attack\n\nWe have noted a few changes on this bot from the previous version. First, it removed the SMB scanner which was observed in the\nMay 2021 attack. Second, it changed the url that it injects to script files on the compromised system. Previously, it used a hardcoded\nurl, ‘ublock-referer[.]dev/campaign.js’ and injects this on the scripts and now it uses the DGA for its url, i.e.,\n**‘DGA_DOMAIN/campaign.js’. As noted in the previous reports, this bot will find HTML, PHP, JS and HTM files in the system and**\nwill inject a javascript code in every file. This is an attempt for that attacker to not only compromise the server but also clients\nconnecting to it. Using a DGA domain to host the javascript makes it more resilient against defenses.\n\n\n-----\n\nNecro injects javascript code to\n\nhtml, htm, php and .js files found on the compromised server. It uses the DGA domain to host campaign.js\nNecro injects javascript code to html, htm, php and .js files found on the compromised server. It uses the DGA domain to host\ncampaign.js\n\nWe also noted a change in its TOR Socks proxies. When the bot receives the “torflood” command, it uses a set of TOR proxies for\nits DDOS attacks.\n\n**New Tor Proxies**\n\n[‘107.150.8.170:9051’, ‘95.217.251.233:1080’, ‘5.130.184.36:9999’, ‘83.234.161.187:9999’, ‘185.186.240.37:9119’,\n‘5.61.53.57:9500’, ‘23.237.60.122:9051’, ‘185.82.217.167:9051’, ‘78.153.5.183:666’, ‘51.210.202.187:8425’, ‘85.159.44.163:9050’,\n‘217.12.221.85:9051’, ‘130.61.153.38:9050’, ‘142.93.143.155:9010’, ‘8.209.253.198:9000’, ‘127.0.0.1:9050’]\n\nVisual Tools DVR Exploit\n\nAs noted above, this bot added a new exploit to its arsenal. The exploit targets Visual Tools DVR VX16 4.2.28.0. A poc for this\nexploit was made available to the public in July, 2021.\n\nHTTP request made to attack Visual Tools\n\nDVR\nAside from the bot, the payload will install a XMRig Monero miner with the following wallet.\n\n45iHeQwQaunWXryL9YZ2egJxKvWBtWQUE4PKitu1VwYNUqkhHt6nyCTQb2dbvDRqDPXveNq94DG9uTndKcWLYNoG2uonhgH\n\nThe scanner function of the bot scans for the following ports and if available, it launches its attack.\n\nTARGET_PORTS = [22, 80, 443, 8081, 8081, 7001]\n\nJuniper Threat Labs is still seeing this Necromorph exploiting the following vulnerabilities:\n\n1. CVE-2020-15568 – TerraMaster TOS before 4.1.29\n2. CVE-2021-2900 – Genexis PLATINUM 4410 2.1 P4410-V2-1.28\n3. CVE-2020-25494 – Xinuos (formerly SCO) Openserver v5 and v6\n4. CVE-2020-28188 – TerraMaster TOS <= 4.2.06\n\n\n-----\n\n5. CVE 2019 12725 Zeroshell 3.9.0\n\nDetection\n\n[Exploits used in this attack are detected by Juniper’s NGFW SRX series.](https://www.juniper.net/us/en/solutions/next-gen-firewall.html)\n\n[HTTP:CGI:BASH-CODE-INJECTION](https://threatlabs.juniper.net/home/search/#/details/?sigtype=ips&sigid=HTTP:CGI:BASH-CODE-INJECTION)\nHTTP:CTS:TERRAMASTER-TOS-INJCTN\nHTTP:CTS:SCO-OPNSRVR-OS-INJ\nHTTP:CTS:GENEXIS-PLAT-RCE\nHTTP:CTS:ZEROSHELL-CGI-BIN-RCE\n\n[Juniper Advanced Threat Prevention Cloud detects this bot as follows:](https://www.juniper.net/us/en/products/security/advanced-threat-prevention.html)\n\nJuniper Advanced Threat Prevention DNS Security also detects the DGA domain.\n\nIndicators of Compromise\n\n**Domains:**\n\ngtmpbeaxruxy[.]myftp.org\n\n**URLs:**\n\nhttp://gtmpbeaxruxy[.]myftp.org/setup.py\n\nhttp://gtmpbeaxruxy[.]myftp.org/setup\n\nhttp://gtmpbeaxruxy[.]myftp.org/xmrig\n\nhttp://gtmpbeaxruxy[.]myftp.org/xmrig1\n\n**Files:**\n\n**File Hash** **File Name**\n\nEb4a48a32af138e9444f87c4706e5c03d8dc313fabb7ea88c733ef1be9372899 setup\n\nE524bd7789b82df11891cc2c12af1ac0ea41dd0b946e1e04a4246cb36321f82f setup.py\n\n0e537db39a7be5493750b7805e3a97da9e6dd78a0c7fca282a55a0241803d803 xmrig\n\nF72babf978d8b86a75e3b34f59d4fc6464dc988720d1574a781347896c2989c7 xmrig1\n\n**IP Addresses & ports:**\n\n107[.]150.8.170:9051\n\n130[.]61.153.38:9050\n\n142[.]93.143.155:9010\n\n\n-----\n\n185[.]186.240.37:9119\n185[.]82.217.167:9051\n217[.]12.221.85:9051\n23[.]237.60.122:9051\n5[.]130.184.36:9999\n5[.]61.53.57:9500\n51[.]210.202.187:8425\n78[.]153.5.183:666\n8[.]209.253.198:9000\n83[.]234.161.187:9999\n85[.]159.44.163:9050\n95[.]217.251.233:1080\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-11 - Necro Python Botnet Goes After Vulnerable VisualTools DVR.pdf"
    ],
    "report_names": [
        "2021-10-11 - Necro Python Botnet Goes After Vulnerable VisualTools DVR.pdf"
    ],
    "threat_actors": [
        {
            "id": "33f527a5-a5da-496a-a48c-7807cc858c3e",
            "created_at": "2022-10-25T15:50:23.803657Z",
            "updated_at": "2025-03-27T02:00:55.550132Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "PLATINUM"
            ],
            "source_name": "MITRE:PLATINUM",
            "tools": [
                "JPIN",
                "Dipsind",
                "adbupd"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7d8ef10e-1d7b-49a0-ab6e-f1dae465a1a4",
            "created_at": "2023-01-06T13:46:38.595679Z",
            "updated_at": "2025-03-27T02:00:02.869216Z",
            "deleted_at": null,
            "main_name": "PLATINUM",
            "aliases": [
                "TwoForOne",
                "G0068",
                "ATK33"
            ],
            "source_name": "MISPGALAXY:PLATINUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e61c46f7-88a1-421a-9fed-0cfe2eeb820a",
            "created_at": "2022-10-25T16:07:24.061767Z",
            "updated_at": "2025-03-27T02:02:10.094583Z",
            "deleted_at": null,
            "main_name": "Platinum",
            "aliases": [
                "ATK 33",
                "Operation EasternRoppels",
                "TwoForOne"
            ],
            "source_name": "ETDA:Platinum",
            "tools": [
                "AMTsol",
                "Adupib",
                "Adupihan",
                "Dipsind",
                "DvDupdate.dll",
                "JPIN",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "RedPepper",
                "RedSalt",
                "Titanium",
                "adbupd",
                "psinstrc.ps1"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535848,
    "ts_updated_at": 1743041556,
    "ts_creation_date": 1653710111,
    "ts_modification_date": 1653710111,
    "files": {
        "pdf": "https://archive.orkl.eu/ba23cff324f75c69e6906c62f2048b36d96dc2a0.pdf",
        "text": "https://archive.orkl.eu/ba23cff324f75c69e6906c62f2048b36d96dc2a0.txt",
        "img": "https://archive.orkl.eu/ba23cff324f75c69e6906c62f2048b36d96dc2a0.jpg"
    }
}