{
    "id": "d1a22567-2dba-4c57-84ad-24e7a331814e",
    "created_at": "2023-01-12T15:01:47.80678Z",
    "updated_at": "2025-03-27T02:06:10.019903Z",
    "deleted_at": null,
    "sha1_hash": "677813c1a377c807b974dca5a8d5a528f97a032b",
    "title": "2021-12-31 - Do you want your Agent Tesla in the 300 MB or 8 kB package-",
    "authors": "",
    "file_creation_date": "2022-05-28T04:03:42Z",
    "file_modification_date": "2022-05-28T04:03:42Z",
    "file_size": 319692,
    "plain_text": "# SANS ISC: InfoSec Handlers Diary Blog - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training InfoSec Handlers Diary Blog\n\n**isc.sans.edu/diary/28202**\n\n## Do you want your Agent Tesla in the 300 MB or 8 kB package?\n\n**Published: 2021-12-31**\n\n**Last Updated: 2021-12-31 12:04:21 UTC**\n\n**by** [Jan Kopriva (Version: 1)](https://isc.sans.edu/handler_list.html#jan-kopriva)\n\n[0 comment(s)](https://isc.sans.edu/forums/diary/Do+you+want+your+Agent+Tesla+in+the+300+MB+or+8+kB+package/28202/#comments)\nSince today is the last day of 2021, I decided to take a closer look at malware that got caught\nby my malspam trap over the course of the year.\n\nOf the several hundred unique samples that were collected, probably the most interesting\none turned out to be a fairly sizable .NET executable caught in October, which “weight in” at\n[300 MB and which has 26/64 detection rating on VT at the time of writing[1].](https://www.virustotal.com/gui/file/3a4fc42fdb5a73034c00e4d709dad5641ca8ec64c0684fa5ce5138551dd3f47a/details)\n\nAs you may see from the following image, the sample was obfuscated using multiple different\ntools.\n\n\n-----\n\nThe size of the file was, however, so significant not because of any complex obfuscation, but\nbecause the executable had a sizable null byte overlay (i.e., a large number of null bytes\nadded after the end of the file).\n\n\n-----\n\nWithout the overlay, the file would have been less than 700 kB in size.\n\nAlthough the use of null bytes to inflate the size of a malicious executable to the point when it\nwill not be analyzed by anti-malware tools (AV tools on endpoints as well as on e-mail\ngateways/web gateways have set limit on the maximum size of files they can scan) is\n[nothing new[2], as the fairly low VT score of this sample shows, it can still be quite effective.](https://isc.sans.edu/forums/diary/Picks+of+2019+malware+the+large+the+small+and+the+one+full+of+null+bytes/25718/)\nEspecially when one considers that after further analysis, the executable turned out to be\n[nothing more than a sample of Agent Tesla infostealer[3]…](https://tria.ge/211231-mfe4yafcfj)\n\nTwo other files I found in my “2021 collection” deserve a short mention in connection with the\nlarge executable described above.\n\n[They were, again, .NET PE files, and, again, were part of an Agent Tesla infection chain[4].](https://tria.ge/210817-c7rr51256x)\n\nBesides this, however they were complete opposites of the sample mentioned before. They\nwere only about 8 kB in size each, no obfuscation was used to protect them and their\n[detections on VT are slightly/significantly higher (37/68[5] and 53/68[6] respectively). I](https://www.virustotal.com/gui/file/f3ebbcbcaa7a173a3b7d90f035885d759f94803fef8f98484a33f5ecc431beb6)\nmention them together because although there are slight differences in their code, as the\nfollowing images show, both were very similar, and one can clearly see that they were only\nsupposed to download and run additional code from the internet.\n\n\n-----\n\nAs the preceding text mentions, although all three samples were used in the infection chains\nof the same malware, the ability of anti-malware tools to detect them varies widely. And since\nthe malware family in question is rather a common one and its samples are often spread by\nuntargeted malspam messages, it goes to show (if anyone still needs to have that pointed\nout to them at the end of 2021) that depending only on traditional anti-malware tools for (not\njust) endpoint protection is simply not enough at this point in time…\n\nNevertheless, since I would like to end this post on a slightly more positive note, let me\nconclude by wishing you – on behalf of all of us at the SANS Internet Storm Center – a\nHappy New Year 2022, with as few malware (and other) infections and serious incidents as\npossible.\n\n[1]\nhttps://www.virustotal.com/gui/file/3a4fc42fdb5a73034c00e4d709dad5641ca8ec64c0684fa5c\ne5138551dd3f47a/details\n\n[2]\n\n\n-----\n\nhttps://isc.sans.edu/forums/diary/Picks+of+2019+malware+the+large+the+small+and+the+o\nne+full+of+null+bytes/25718/\n\n[3] [https://tria.ge/211231-mfe4yafcfj](https://tria.ge/211231-mfe4yafcfj)\n\n[4] [https://tria.ge/210817-c7rr51256x](https://tria.ge/210817-c7rr51256x)\n\n[5]\nhttps://www.virustotal.com/gui/file/f3ebbcbcaa7a173a3b7d90f035885d759f94803fef8f98484a\n33f5ecc431beb6\n\n[6]\nhttps://www.virustotal.com/gui/file/12a978875dc90e03cbb76d024222abfdc8296ed675fca2e1\n7ca6447ce7bf0080\n\n----------Jan Kopriva\n[@jk0pr](https://twitter.com/jk0pr)\n[Alef Nula](https://www.alef.com/en/)\n\n[Keywords: PE](https://isc.sans.edu/tag.html?tag=PE) [Malspam](https://isc.sans.edu/tag.html?tag=Malspam) [Agent Tesla](https://isc.sans.edu/tag.html?tag=Agent%20Tesla) [NET](https://isc.sans.edu/tag.html?tag=NET)\n[0 comment(s)](https://isc.sans.edu/forums/diary/Do+you+want+your+Agent+Tesla+in+the+300+MB+or+8+kB+package/28202/)\n\nJoin us at SANS! Attend [with Jan Kopriva in starting](https://isc.sans.edu/diary/28202)\n\nTop of page\n×\n\n[Diary Archives](https://isc.sans.edu/diaryarchive.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-31 - Do you want your Agent Tesla in the 300 MB or 8 kB package-.pdf"
    ],
    "report_names": [
        "2021-12-31 - Do you want your Agent Tesla in the 300 MB or 8 kB package-.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535707,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1653710622,
    "ts_modification_date": 1653710622,
    "files": {
        "pdf": "https://archive.orkl.eu/677813c1a377c807b974dca5a8d5a528f97a032b.pdf",
        "text": "https://archive.orkl.eu/677813c1a377c807b974dca5a8d5a528f97a032b.txt",
        "img": "https://archive.orkl.eu/677813c1a377c807b974dca5a8d5a528f97a032b.jpg"
    }
}