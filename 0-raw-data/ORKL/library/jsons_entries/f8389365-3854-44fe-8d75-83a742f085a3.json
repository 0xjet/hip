{
    "id": "f8389365-3854-44fe-8d75-83a742f085a3",
    "created_at": "2023-01-12T14:59:31.088606Z",
    "updated_at": "2025-03-27T02:15:35.523231Z",
    "deleted_at": null,
    "sha1_hash": "bc0e99c2c3b4e0d2084e4c525df7a30dcd4880d8",
    "title": "2017-11-12 - Seamless Campaign Delivers Ramnit via RIG EK at 188.225.82.158. Follow-up Malware is AZORult Stealer.",
    "authors": "",
    "file_creation_date": "2022-05-28T15:30:41Z",
    "file_modification_date": "2022-05-28T15:30:41Z",
    "file_size": 1449992,
    "plain_text": "# Seamless Campaign Delivers Ramnit via RIG EK at 188.225.82.158. Follow-up Malware is AZORult Stealer.\n\n**[malwarebreakdown.com/2017/11/12/seamless-campaign-delivers-ramnit-via-rig-ek-at-188-225-82-158-follow-up-malware-is-azorult-stealer/](https://malwarebreakdown.com/2017/11/12/seamless-campaign-delivers-ramnit-via-rig-ek-at-188-225-82-158-follow-up-malware-is-azorult-stealer/)**\n\nNovember 12, 2017\n\n_Note: I took a bit of break, but I will try to get back to posting more regularly._\n\nToday’s infection chain is a familiar one as it includes the Seamless campaign delivering Ramnit banking Trojan via RIG exploit kit. Below is an\nimage of the infection chain, specifically the HTTP requests:\n\nThe infection chain starts off with a normal site and some ad traffic. The HTTP request for ad traffic redirects to an XML feed serving ads. The\nXML feed returned a 302 Found, pointing to hxxp://flinsheer-perreene[.]com/voluum/:\n\nWe then see a series of 3XX redirects:\n\nhxxp://flinsheer-perreene[.]com/voluum/ -> hxxp://194[.]58[.]38[.]57/usa via a 302 Found\nhxxp://194[.]58[.]38[.]57/usa -> /usa/ via a 301 Moved Permanently\n\n/usa/ returns the following JavaScript, which POST information back to /usa/:\n\n\n-----\n\n[Further breakdown of the code can be seen HERE.](https://malwarebreakdown.com/2017/09/19/seamless-malvertising-campaign-leads-to-rig-ek-and-drops-ramnit-follow-up-malware-is-azorult-stealer/)\n\nTypically, it would be at this point that unwanted connections would be filtered out and redirected to a benign site, however I didn’t run any\nfurther test for verification.\n\nThe server returns a 200 OK and points to the next step in the redirection chain via window.location.href=hxxp://flinsheerperreene[.]com/voluum/cebddddb-0f28-4087-99c3-690fa79f4804??track=48tmsGdksmgj383P=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n\nThe response to that request is shown below:\n\n\n-----\n\nWe see a meta refresh, redirecting to hxxp://kcsmj[.]redirectvoluum[.]com:80/redirect?\ntarget=BASE64aHR0cDovLzE5NC41OC40MC4xOTMvdGVzdDIyLnBocA&ts=xxxxxxxxxxxxx&hash=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\nafter 0 seconds (bolded string in URI is Base64 encoded).\n\nThis redirect leads to another response containing one more meta refresh:\n\nThis meta refresh happens immediately, redirecting to hxxp://194[.]58[.]40[.]193/test22.php\n\ntest22.php returns an iframe that contains the RIG EK landing page at 188.225.82.158:\n\n\n-----\n\nAfter this long redirection chain, RIG EK finally delivers Ramnit banking Trojan.\n\nFile System IOCs\n\nThe malware payload is placed in the user’s %TEMP% folder:\n\nIt also created a copy of itself in %LOCALAPPDATA%:\n\nThere is also a copy in %APPDATA%MicrosoftWindowsStart MenuProgramsStartup for persistence:\n\n\n-----\n\nModifies auto-execute functionality by setting/creating values in the registry:\n```\nSETVAL; Path: \"HKCUSOFTWAREMICROSOFTWINDOWSCURRENTVERSIONRUN\"; Key: \"UfyQwfyv\"; Value: \"%LOCALAPPDATA%mykemfpiufyqwfyv.exe\"\nSETVAL; Path: \"HKLMSOFTWAREMICROSOFTWINDOWS NTCURRENTVERSIONWINLOGON\"; Key: \"USERINIT\"; Value:\n\"%WINDIR%system32userinit.exe,,%LOCALAPPDATA%mykemfpiufyqwfyv.exe\"\n\n```\nAfter restarting the machine there are two more copies of the malware placed in %TEMP%:\n\n\n-----\n\nThere was also a copy in %TEMP%Low:\n\nEntry for “Client” found in HKCUSoftwareAppDataLow:\n\nCreates various .log files in %LOCALAPPDATA% and %PROGRAMDATA%:\n\n\n-----\n\nIf you looked at the %LOCALAPPDATA% image you might have noticed another executable file called “APITEM.EXE”. This malware payload\nended up being AZORult stealer and it was download by my infected host after the initial system restart.\n\nSome .tempcbss files created by AZORult are located in %TEMP%:\n\nNetwork Based IOCs\n\nAfter the system restart we could also see the DNS queries for Ramnit DGA domains:\n\n\n-----\n\nSuccessful resolutions:\n\nngbclncfxjdsmmribt.com – 217.20.116.140\naujastmvehxqmlbb.com – 217.20.116.140\nguaevvaxrujnobfytud.com – 194.87.145.189\nkofeydncog.com – 87.106.190.153\nsxkallpiiknswi.com – 87.106.190.153\n\nCallback traffic for Ramnit:\n\n217.20.116.140:443\n194.87.145.189:443\n87.106.190.153:443\n\nBelow is an image of the GET request for AZORult:\n\n_[Note: Further analysis of the server delivering tutu.exe shows that it’s also hosting apis.exe and](https://www.virustotal.com/en/file/35408635b78a61972dd48935fbbeb1fce067615c3cebf4498472252fbf893914/analysis/)_ _[1.exe. 1.exe was identified as Teamspy (aka](https://www.virustotal.com/en/file/cc95870ebece2838ff9b2b8129386f015ea80d497a6c26127c9bd7abc588f2ea/analysis/)_\n_[TVRAT, TVSPY, and SpY-Agent) and apis.exe was identified as DarkVNC (Thanks to @Antelox for identifying the payloads).](https://twitter.com/Antelox)_\n\ntutu.exe was downloaded using the UA string “Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)”, which is Internet Explorer 6 on\nWindows XP SP2.\n\nAZORult was placed in %LOCALAPPDATA% and executed. Following the execution of the payload we see two POST requests:\n\n\n-----\n\nLogin panel:\n\nConfirmation it is AZORult:\n\n\n-----\n\nMain page, passwords, and reports:\n\n\n-----\n\nThese threat actors have collected information on over 600+ victims in the last couple of days.\n\nThere are options for reporting, saved passwords (browsers, FTP, Email, and IM), Bitcoin client files, Skype db files, Steam files, Desktop files\nand CC.\n\nThe criminals are collecting and storing victim information in .zip files, named by the date and machine ID:\n\nInformation in the .zip file includes:\n\n“Browsers” folder\n\n“AutoComplete” subfolder contains .txt files for Chromium, Chrome, Firefox, etc.\n“Cookies” subfolder contains similar files as the AutoComplete subfolder\nCookieList.txt\nIP.txt\nPasswords.txt\nSYSInfo.txt\n\nThese files contain the IP address and location of the compromised machine, saved passwords, system information (Machine ID, file path of\nthe malware – .exe or .dll, Operating System information, computer name, username, CPU information, total RAM, GPU information, system\nprocesses currently running, programs currently installed), and information used by browsers.\n\nDue to security reasons, I will not be giving out certain samples to the public.\n\nIOCs from Infection\n\n52.8.143.12 – flinsheer-perreene.com – GET /voluum/\n194.58.38.57 – GET /usa and /usa/ – POST /usa/\n52.8.229.123 – kcsmj.redirectvoluum.com – GET /redirect?target=BASE64\n194.58.40.193 – GET /test22.php\n188.225.82.158 – IP literal hostname used by RIG EK\n217.20.116.140:443 – ngbclncfxjdsmmribt.com – Ramnit\n217 20 116 140:443 aujastmvehxqmlbb com Ramnit\n\n\n-----\n\n9 8 5 89 3 guae a uj ob ytud co a t\n87.106.190.153:443 – kofeydncog.com – Ramnit\n87.106.190.153:443 – sxkallpiiknswi.com – Ramnit\n\nBonus IOCs Collected During My Research\n\n85.17.29.101:80 – GET /stats/update.php?id=283233394&stat=8f995f306c06b63c100b05fdd300f962 – ET TROJAN\nWin32.Spy/TVRat/Shade Ransomware Checkin\n\nUses UA string “Mozilla/5.0 (Windows NT 5.1)”\n5.79.66.227:443 – Collected from apis.exe sample\n\nHashes From Infection\n\n[SHA256: be28a10416523b9ed143f99a1153f3530565a885c5b7dfa271ebad5a31ff0fb2](https://www.virustotal.com/en/file/be28a10416523b9ed143f99a1153f3530565a885c5b7dfa271ebad5a31ff0fb2/analysis/1510439368/)\nFile name: RigEK 188.225.82.158 landing page.txt\n\n[SHA256: 4f8ee603630bbcc55b33b2c95347fe51d1dbc50531ece60b9f15050aa1119339](https://www.virustotal.com/en/file/4f8ee603630bbcc55b33b2c95347fe51d1dbc50531ece60b9f15050aa1119339/analysis/1510439375/)\nFile name: RigEK 188.225.82.158 Flash exploit.swf\n\n[SHA256: 5c0a56406bd98c4da687fe7bc95d0d0ca271ad38bc394e8f6c4f5ef1c47277d7](https://www.virustotal.com/en/file/5c0a56406bd98c4da687fe7bc95d0d0ca271ad38bc394e8f6c4f5ef1c47277d7/analysis/)\nFile name: o32.tmp\n\nBonus Hashes – Malware Found on Server Hosting AZORult\n\n[SHA256: cc95870ebece2838ff9b2b8129386f015ea80d497a6c26127c9bd7abc588f2ea](https://www.virustotal.com/en/file/cc95870ebece2838ff9b2b8129386f015ea80d497a6c26127c9bd7abc588f2ea/analysis/)\nFile name: 1.exe\n[Hybrid-Analysis Report](https://www.hybrid-analysis.com/sample/cc95870ebece2838ff9b2b8129386f015ea80d497a6c26127c9bd7abc588f2ea?environmentId=100)\n\n[SHA256: 35408635b78a61972dd48935fbbeb1fce067615c3cebf4498472252fbf893914](https://www.virustotal.com/en/file/35408635b78a61972dd48935fbbeb1fce067615c3cebf4498472252fbf893914/analysis/)\nFile name: apis.exe\n[Hybrid-Analysis Report](https://www.hybrid-analysis.com/sample/35408635b78a61972dd48935fbbeb1fce067615c3cebf4498472252fbf893914?environmentId=100)\n\nDownloads\n\n[Artifacts from the infection and bonus malware samples.zip](https://malwarebreakdown.com/wp-content/uploads/2017/11/Malware-samples.zip)\n\nPassword is “infected”\n\nUntil next time!\n\nAdditional Reference for Ramnit:\n[https://www.cert.pl/news/single/ramnit-doglebna-analiza/ (original source)](https://www.cert.pl/news/single/ramnit-doglebna-analiza/)\n[https://www.cert.pl/en/news/single/ramnit-in-depth-analysis/ (English version)](https://www.cert.pl/en/news/single/ramnit-in-depth-analysis/)\n\n## Published by malwarebreakdown\n\n[Just a normal person who spends their free time infecting systems with malware. View all posts by malwarebreakdown](https://malwarebreakdown.wordpress.com/author/malwarebreakdown/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-11-12 - Seamless Campaign Delivers Ramnit via RIG EK at 188.225.82.158. Follow-up Malware is AZORult Stealer..pdf"
    ],
    "report_names": [
        "2017-11-12 - Seamless Campaign Delivers Ramnit via RIG EK at 188.225.82.158. Follow-up Malware is AZORult Stealer..pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d8dd2ca-5592-482e-b89d-6a7e1a49f4f6",
            "created_at": "2023-01-06T13:46:38.408359Z",
            "updated_at": "2025-03-27T02:00:02.826069Z",
            "deleted_at": null,
            "main_name": "TeamSpy Crew",
            "aliases": [
                "TeamSpy",
                "Team Bear",
                "Anger Bear",
                "IRON LYRIC"
            ],
            "source_name": "MISPGALAXY:TeamSpy Crew",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535571,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653751841,
    "ts_modification_date": 1653751841,
    "files": {
        "pdf": "https://archive.orkl.eu/bc0e99c2c3b4e0d2084e4c525df7a30dcd4880d8.pdf",
        "text": "https://archive.orkl.eu/bc0e99c2c3b4e0d2084e4c525df7a30dcd4880d8.txt",
        "img": "https://archive.orkl.eu/bc0e99c2c3b4e0d2084e4c525df7a30dcd4880d8.jpg"
    }
}