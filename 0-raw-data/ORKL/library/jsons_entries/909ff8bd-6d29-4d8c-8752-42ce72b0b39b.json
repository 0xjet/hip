{
    "id": "909ff8bd-6d29-4d8c-8752-42ce72b0b39b",
    "created_at": "2023-01-12T15:05:36.762452Z",
    "updated_at": "2025-03-27T02:16:20.767215Z",
    "deleted_at": null,
    "sha1_hash": "dbd4f9814e370e4db988744b87d72402d6ae56c6",
    "title": "2015-03-11 - Inside the EquationDrug Espionage Platform",
    "authors": "",
    "file_creation_date": "2022-05-28T02:01:05Z",
    "file_modification_date": "2022-05-28T02:01:05Z",
    "file_size": 1482708,
    "plain_text": "# Inside the EquationDrug Espionage Platform\n\n**securelist.com/inside-the-equationdrug-espionage-platform/69203/**\n\nAuthors\n\nGReAT\n\n## Introduction\n\n[EquationDrug is one of the main espionage platforms used by the Equation Group, a highly sophisticated threat](https://securelist.com/equation-the-death-star-of-malware-galaxy/68750/)\nactor that has been engaged in multiple CNE (computer network exploitation) operations dating back to 2001, and\n[perhaps as early as 1996. (See full report here [PDF]).](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/08064459/Equation_group_questions_and_answers.pdf)\n\nEquationDrug, which is still in use, dates back to 2003, although the more modern GrayFish platform is being\npushed to new victims.\n\nEquationDrug represents the main espionage platform from the #EquationAPT Group\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=EquationDrug+represents+the+main+espionage+platform+from+the+%23EquationAPT+Group)\n\nIt’s important to note that EquationDrug is not just a Trojan, but a full espionage platform, which includes a\nframework for conducting cyberespionage activities by deploying specific modules on the machines of selected\nvictims. The concept of a cyberespionage platform is neither new nor unique. Other threat actors known to use\n[such sophisticated platforms include Regin and](https://securelist.com/regin-nation-state-ownage-of-gsm-networks/67741/) [Epic Turla.](https://securelist.com/the-epic-turla-operation/65545/)\n\nThe EquationDrug platform can be extended through plugins (or modules). It is pre-built with a default set of\nplugins supporting a number of basic cyberespionage functions. These include common features such as file\ncollection and the making of screenshots. Sophistication is added by storing stolen data inside a customencrypted virtual file system before it is sent to the command and control servers.\n\n\n-----\n\nThe name EquationDrug or Equestre was assigned to this framework by Kaspersky Lab researchers. The only\nreference left by the framework developers was a short string “UR“, as seen in several string artifacts left in the\nbinaries.\n\n## Platform Architecture\n\nThe EquationDrug platform includes dozens of executables, configurations and protected storage locations.\nPutting all the pieces of this puzzle together in the right order may take time for those who are not familiar with the\nplatform.\n\nThe platform includes executables, configurations and protected storage locations #EquationAPT\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=The+platform+includes+executables%2C+configurations+and+protected+storage+locations+%23EquationAPT)\n\nThe architecture of the whole framework resembles a mini-operating system with kernel-mode and user-mode\ncomponents carefully interacting with each other via a custom message-passing interface. The platform includes a\nset of drivers, a platform core (orchestrator) and a number of plugins. Every plugin has a unique ID and version\nnumber that defines a set of functions it can provide. Some of the plugins depend on others and might not work\nunless dependencies are resolved.\n\n\n-----\n\nSimilar to popular OS kernel designs, such as on Unix-based systems, some of the essential modules are\nstatically linked to the platform core, while others are loaded on demand.\n\nThe hypothesis that these attackers have been active since the 90s seems realistic #EquationAPT\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=The+hypothesis+that+these+attackers+have+been+active+since+the+90s+seems+realistic+%23EquationAPT)\n\nThe platform is started by the kernel mode driver component (“msndsrv.sys” on Windows 2000 or above and\n“mssvc32.vxd” on Windows 9x). The driver then waits for the system to start and initiates execution of the usermode loader “mscfg32.exe”. The loader then starts the platform’s central module (an orchestrator) from the\n“mscfg32.dll” module. Additional drivers and libraries may be loaded by different components of the platform,\neither built-in or auxiliary\n\n\n-----\n\n## Platform Components\n\nThe EquationDrug platform can be as sophisticated as a space station, but it appears to be of no use without its\ncyberespionage features. This function is provided by plugin modules that are part of the massive framework\ndescribed above. We discovered dozens of plugins and each is a sophisticated element that can communicate\nwith the core and become aware of the availability of other plugins.\n\nThe plugins we discovered probably represent just a fraction of the attackers’ potential. Each plugin is assigned a\nunique plugin ID number (WORD), such as 0x8000, 0x8002, 0x8004, 0x8006, etc. All plugin IDs are even\nnumbers and they all start from byte 0x80. The biggest plugin ID we have seen is 0x80CA. To date, we have found\n30 unique plugin IDs in total. Considering the fact that the developers assigned plugin IDs incrementally, and\nassuming that other plugin IDs were assigned to modules that we have not yet discovered, it’s not hard to\ncalculate that 86 **modules have yet to be discovered.**\n\n86 modules have yet to be discovered #EquationAPT\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=86+modules+have+yet+to+be+discovered+%23EquationAPT)\n\nThe most interesting modules we have seen contain the following functionality:\n\nNetwork traffic interception for stealing or re-routing.\nReverse DNS resolution (DNS PTR records).\nComputer management:\n\nStart/stop processes\nLoad drivers and libraries\nManage files and directories\nSystem information gathering:\n\nOS version\nComputer name\nUser name\nLocale\nKeyboard layout\nTimezone\nProcess list\nBrowsing network resources and enumerating and accessing shares.\nWMI information gathering.\nCollection of cached passwords.\nEnumeration of processes and other system objects.\nMonitoring LIVE user activity in web browsers.\nLow-level NTFS filesystem access based on the popular Sleuthkit framework.\nMonitoring removable storage drives.\nPassive network backdoor (runs Equation shellcode from raw traffic).\nHDD and SSD firmware manipulation.\nKeylogging and clipboard monitoring.\nBrowser history, cached passwords and form auto-fill data collection.\n\n## Code Artifacts\n\nDuring our research we paid attention to unique identifiers and codenames used by the developers in the\nmalware. Most of this information is carefully protected with obfuscation or encryption algorithms to prevent quick\nrecognition, but anyone who breaks through this layer of encryption may discover some interesting internal strings,\n\n\n-----\n\nas demonstrated below:\n\nSome other interesting text strings include:\n\n**SkyhookChow Target**\n**SkyhookChow Payload**\nDissecorp\nManual/DRINKPARSLEY/2008-09-30/10:06:46.468-04:00\nVTT/82053737/STRAITACID/2008-09-03/10:44:56.361-04:00\nVTT/82051410/LUTEUSOBSTOS/2008-07-30/17:27:23.715-04:00\n**STRAITSHOOTER30.ex_**\n**BACKSNARF_AB25**\nc:\\users\\rmgree5\\co\\standalonegrok_2.1.1.1\\gk_driver\\gk_sa_driver…\nTo install: run with no arguments\nAttempting to drop\n**SFCriteria_Check failed!**\n**SFDriver**\nError detected! Uninstalling…\nTimeout waiting for the “canInstallNow” event from the implant-specific EXE!\nTrying to call privilege lib…\nHiding directory\nHiding plugin…\nMerging plugin…\nMerging old plugin key…\nCouldn’t reset canInstallNowEvent!\nPerforming UR-specific pre-install…\nWork complete.\nMerged transport manager state.\n!!SFConfig!!\n\nSome other names, such as kernel object and file names, abbreviations, resource code page and several generic\nmessages, point to English-speaking developers. Due to the limited number of such text strings it’s hard to tell\nreliably if the developers were native English speakers.\n\n### Link Timestamp Analysis\n\nWe have gathered a reasonably large number of executable samples to which we have been able to apply link\ntimestamp analysis.\n\nA link timestamp is a 4-bytes value stored in an executable file header. This value is automatically set by compiler\nsoftware when a developer builds a new executable. The value contains a detailed timestamp including minutes\nand even seconds of compilation time (think of it as the file’s moment of birth).\n\n\n-----\n\nLink timestamp analysis require the collection of the timestamps of all available executables, grouping them\naccording to certain criteria, such as the hour or day of the week, and putting them on a chart. Below are some\ncharts built using this approach.\n\n\n-----\n\nCan we trust this information? The answer is: not fully, because the link timestamp can be altered by the\ndeveloper in a way that’s not always possible to spot. However, certain indicators such as matching the year on\nthe timestamp with the support of technology popular in that year leads us to believe that the timestamps were, at\nthe very least, not wholly replaced. Looking at this from the other side, the easiest option for the developer is to\nwipe the timestamp completely, replacing it with zeroes. This was not found in the case of EquationDrug. In fact,\nthe timestamps look very realistic and match the working days and hours of a well-organized software developer\nfrom timezone UTC-3 or UTC-4, if you assume that they come to work at 8 or 9 am.\n\nThe timestamps match the working days of software developer from timezone UTC-3 or UTC-4\n#EquationAPT\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=The+timestamps+match+the+working+days+of+software+developer+from+timezone+UTC-3+or+UTC-4+%23EquationAPT)\n\nAnd finally, in case you are wondering if the developers work on public holidays, you can check this for yourself\nagainst the full list of their working dates:\n\n2001.08.17 2007.12.11 2009.04.16 2011.10.20 2012.08.31 2013.06.11\n\n2001.08.23 2007.12.17 2009.06.05 2011.10.26 2012.09.28 2013.06.26\n\n2003.08.16 2008.01.01 2009.12.15 2012.03.06 2012.10.23 2013.08.09\n\n2003.08.17 2008.01.23 2010.01.22 2012.03.22 2012.11.02 2013.08.28\n\n2005.03.16 2008.01.24 2010.02.19 2012.04.03 2012.11.06 2013.10.16\n\n2005.09.08 2008.01.29 2010.02.22 2012.04.04 2013.01.08 2013.11.04\n\n2006.06.15 2008.01.30 2010.03.27 2012.04.05 2013.02.07 2013.11.26\n\n2006.09.18 2008.04.24 2010.06.15 2012.04.12 2013.02.21 2013.12.04\n\n2006.10.04 2008.05.07 2011.02.09 2012.07.02 2013.02.22 2013.12.05\n\n2006.10.16 2008.05.09 2011.02.23 2012.07.09 2013.02.27 2013.12.13\n\n2007.07.12 2008.06.17 2011.08.08 2012.07.17 2013.04.16\n\n2007.10.02 2008.09.17 2011.08.30 2012.08.02 2013.05.08\n\n2007.10.16 2008.09.24 2011.09.02 2012.08.03 2013.05.14\n\n2007.12.10 2008.12.05 2011.10.04 2012.08.14 2013.05.24\n\n## Conclusions\n\nEquationDrug represents the main espionage platform from the Equation Group. It’s been in use for over 10 years,\nreplacing EquationLaser until it was replaced itself by the even more sophisticated GrayFish platform.\n\nThe EquationDrug case demonstrates an interesting trend: a growth in code sophistication #EquationAPT\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=The+EquationDrug+case+demonstrates+an+interesting+trend%3A+a+growth+in+code+sophistication+%23EquationAPT)\n\nThe EquationDrug case demonstrates an interesting trend that we have been seeing while analyzing supposedly\nnation-state cyberattack tools: a growth in code sophistication. It is clear that nation-state attackers are looking for\nbetter stability, invisibility, reliability and universality in their cyberespionage tools. You can make a basic browser\npassword-stealer or a sniffer within days. However, nation-states are focused on creating frameworks for\nwrapping such code into something that can be customized on live systems and provide a reliable way to store all\n\n\n-----\n\ncomponents and data in encrypted form, inaccessible to normal users. While traditional cybercriminals mass\ndistribute emails with malicious attachments or infect websites on a large scale, nation-states create automatic\nsystems infecting only selected users. While traditional cybercriminals typically reuse one malicious file for all\nvictims, nation-states prepare malware unique to each victim and even implement restrictions preventing\ndecryption and execution outside of the target computer.\n\nNation-state attackers create automatic systems infecting only selected users #EquationAPT\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=Nation-state+attackers+create+automatic+systems+infecting+only+selected+users+%23EquationAPT)\n\nSophistication of the framework is what makes this type of actor different from traditional cybercriminals, who\nprefer to focus on payload and malware capabilities such as implementing a long list of custom third-party\nsoftware credential database parsers.\n\nThe difference in tactics between cybercriminals and nation-state attackers appears to be due to relative resource\navailability. It’s known that cybercriminals attempt to infect as many users as possible and that they can\nsometimes compromise hundreds of thousands of systems. It would will take many years to check all those\nmachines manually, analyzing who owns them, what data is stored on them, and what custom software they run.\n\nCybercriminals probably don’t even have enough disk space to collect all the potentially interesting data from the\nvictims hit by their large scale infections. That is why cybercriminals prefer to extract tiny chunks of the most\nimportant data (credentials, credit card numbers, etc) on the machine of the victim and transfer only few kilobytes\nfrom each compromised host. Such data, when combined from all users, normally takes up gigabytes of disk\nspace.\n\nNation-state attackers have sufficient resources to store as much data as they want. They have access to virtually\nunlimited data storage. However, they don’t need, and often try to avoid, infecting random users, for the obvious\nreason of avoiding attention and remaining invisible. Implementing custom data format parsers in the malware not\nonly doesn’t help them find all the valuable data on the victim’s machine, but may also attract extra attention from\nsecurity software running on the system. They mostly prefer to have a generic remote system management tool\nthat can copy any information they might need even if it causes some redundancy. However, copying large\nvolumes of information might slow down network connection and attract attention, especially in some countries\nwith poorly developed internet infrastructure. To date, nation-state attackers have had to balance between these\ntwo poles: copying victims’ entire hard drives while stealing only tiny bits of passwords and keys.\n\nNation-state attackers use a remote system management tool that can copy any information they need\n#EquationAPT\n\n[Tweet](https://twitter.com/share?url=https%3A%2F%2Fsecurelist.com%2Finside-the-equationdrug-espionage-platform%2F69203%2F&text=Nation-state+attackers+use+a+remote+system+management+tool+that+can+copy+any+information+they+need+%23EquationAPT)\n\nNow, if you wonder why EquationDrug, a powerful cyberespionage platform, doesn’t provide all stealing capability\nas standard in its malware core, the answer is that they prefer to customize the attack for each one of their victims.\nOnly if they have chosen to actively monitor you and the security products on your machines have been disarmed,\nwill you receive a plugin for the live tracking of your conversations or other specific functions related to your\nactivities. We believe modularity and customization will become a unique trademark of nation-state attackers in\nthe future.\n\nSome code paths in EquationDrug modules lead to OS version checks including a test for Windows 95, which is\naccepted as one of supported platforms. While some other checks will not pass on Windows 95, the presence of\nthis code means that this OS was supported in some earlier variants of the malware. Considering this and the\nexistence of components designed to run on Windows 9x (such as VXD-files), as well as compilation timestamps\ndating back to early 2000s, the hypothesis that these attackers have been active since the 90s seems realistic.\nThis makes the current attacker an outstanding actor operating longer than any other in the field.\n\n\n-----\n\n## Technical Details\n\n### Kernel mode stage 0 (Windows 9x) – mssvc32.vxd\n\n**MD5** 0a5e9b15014733ee7685d8c8be81fb0d\n\n**Size** 6 710 bytes\n\n**Format** Linear Executable (LE)\n\nThis VXD driver handles only two control messages: W32_DeviceIoControl and Dynamic_Init. The\nDeviceIoControl part is not completely implemented and the driver is only able to check for some known control\ncodes. However it does nothing. This handler looks more like a code stub rather than actual payload.\n\nOn the Dynamic_Init event, the driver retrieves the location of the user-mode loader executable from the following\nregistry value:\n\n**_[HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\MemSubSys] Config_**\n\nIf the value is not present in the registry, it uses the following fallback string hardcoded in the binary:\n\n**C:\\WINDOWS\\SYSTEM\\SVCHOST32.EXE**\n\nNext, it installs a callback procedure using Windows function _SHELL_CallAtAppyTime. This procedure will be\ncalled when CPU is running in ring-3 mode, so that a new executable (loader process) can be started via the\ntraditional way. This is a standard trick that was used by developers in the 90s to initiate a call to DLL export in\nring-3 from ring-0 in Windows 9x OS family.\n\n### Kernel mode stage 0 and rootkit (Windows 2000 and above) – msndsrv.sys\n\n**MD5** c4f8671c1f00dab30f5f88d684af1927\n\n**Size** 105 392 bytes\n\n**Format** PE32 Native\n\n**Compiled** 2008.01.23 14:12:33 (GMT)\n\n**Location** %System32%\\drivers\\msndsrv.sys\n\nThis module can create log files in the following known locations:\n\n**%systemroot%\\system32\\mslog32.dat**\n\n**%systemroot%\\system32\\msperf32.dat (default location)**\n\nThe driver acts as the first stage of the EquationDrug platform on Windows 2000+ and implements rootkit\nfunctions for hiding the components of the platform. Additionally, it implements a NDIS driver for filtering network\ntraffic.\n\nWhen started and initialized, the driver retrieves the location of the user-mode loader executable from the registry\nvalue:\n\n**_[HKLM\\System\\CurrentControlSet\\Services\\%driver name%] Config_**\n\n\n-----\n\nThe %driver name% is not hardcoded and is obtained dynamically from the current module name, which means\nthat different instances may check different registry keys and this may not be a reliable way to check for infection.\nThe sample we analyzed used “msndsrv” as the %driver name%.\n\nNext, it crafts and injects a shellcode in “services.exe” or “winlogon.exe”. The shellcode is designed to spawn the\nloader process from the executable called “mscfg32.exe”.\n\nThe rootkit code in the driver hooks several Native API functions that lets it hide or protect registry keys, files and\nrunning processes. The components of EquationDrug can modify the list of protected objects by sending\nDeviceIoControl messages to the driver. The driver also maintains a persistent list of protected objects that is\nstored in the following registry values:\n\n**_[HKLM\\System\\CurrentControlSet\\Services\\%driver name%] 1_**\n\n**_[HKLM\\System\\CurrentControlSet\\Services\\%driver name%] 2_**\n\nThese values are also protected by the rootkit. They can be revealed by booting Windows in Safe Mode.\n\nThe driver contains the following unused strings:\n\n**\\\\.\\mailslot\\dskInfo**\n**Dissecorp**\n\n### User-mode loader – mscfg32.exe, svchost32.exe\n\n**MD5** c3af66b9ce29efe5ee34e87b6e136e3a\n\n**Size** 22 016 bytes\n\n**Format** PE32 EXE\n\n**Compiled** 2008.01.23 14:26:05 (GMT)\n\n**Location** %System32%\\mscfg32.exe\n\nThis module opens a unique event named “D0385CB7-B834-45d1-A501-1A1700E6C34E“. If the event exists, it\nwaits for 10 seconds and attempts to open a file whose name can be decrypted as “\\\\.\\MSNDSRV“. If the device\nfile is successfully opened, the code issues a device request with IOCTL code 0x80000194 and no parameters.\n\nThis module uses RC5 in CBC-like mode with a key length of 96-bit for string encryption.\n\nCareful analysis reveals some bits of uninitialized memory found next to encryption key locations. This is unused\nbut partly meaningful memory, because it seems to contain short chunks of strings resembling some local\nfilepaths:\n\n**“rver\\8” (probably part of “Server\\8…” string)**\n**“LInj” (could be a part of “DLLInjector” or similar)**\n\nIt’s apparent that some parts of the code were designed to run on Windows 9x, for example a call to\n**RegisterServiceProcess Windows API function makes sense only on Windows 9x OS family, because this API**\nfunction doesn’t exist on Windows NT platform.\n\nThe module uses a unique algorithm for generating registry value names. The code contains strings, such as\n“SkyhookChow Target“, that are converted to GUID-like strings by calculating SHA1 hash and using its\nhexadecimal representation as a string. The resulting strings are used as actual registry value names in\n\n**_[HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\MemSubSys] registry key._**\n\n\n-----\n\nSample registry value names:\n\n**Original String** **GUID-like registry value name**\n\nSkyhookChow Target {B6F5CD13-A74D-8B82-A6AA-6FA1BE2484C1-6832DF06}\n\nSkyhookChow Payload {F4CF0326-6DCD-EEC8-5323-01CEDB66741A-B55F6F12}\n\nThese registry values are encrypted using an RC5 algorithm using a hardcoded 1024-bit key with 24 rounds.\n\nThe registry value:\n\n**_[HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\MemSubSys] {F4CF0326-6DCD-EEC8-5323-_**\n**_01CEDB66741A-B55F6F12} (“SkyhookChow Payload”)_**\nshould contain the location of the orchestrator DLL file (“mscfg32.dll”). If the value is not present a default value\n**“%SYSTEM%\\mscfg32.dll” is used.**\n\nThe registry value:\n\n**_[HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\MemSubSys] {B6F5CD13-A74D-8B82-A6AA-_**\n**_6FA1BE2484C1-6832DF06} (“SkyhookChow Target”)_**\nmay contain the location of the executable file that will be used as a “shell” process for the orchestrator library.\n\nThe module attempts to start the “shell” process in suspended mode. If there is no “SkyhookChow Target” value or\nthe specified executable fails to start, the module tries different failsafe locations of the programs that can be used\ninstead:\n\n1. Default browser set in the registry [HKLM\\SOFTWARE\\Clients\\StartMenuInternet\\{current @default\n\n**_value}\\shell\\open\\command]_**\n2. %SystemRoot%\\System32\\svchost.exe\n3. %SystemRoot%\\System32\\lsass.exe\n4. Spoolsv service binary from the [HKLM\\SYSTEM\\CurrentControlSet\\Services\\Spooler] ImagePath\n\nregistry value.\n5. Default html file handler from [HKLM\\SOFTWARE\\Classes\\htmlfile\\shell\\open\\command]registry value.\n6. Internet Explorer path from [HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\]\n\n**_IEXPLORE.EXE registry value._**\n\nNext, the module injects extra code into a newly started target process. The injected code loads the payload DLL\n(“mscfg32.dll”) into the target process and waits for the parent process to exit. When the parent process quits, it\nunloads the payload DLL and exits as well. The rest of the logic relies on the loaded DLL in that new process. See\nthe description of the “mscfg32.dll” module below.\n\nThe module communicates with the Stage0/Rootkit driver “msndsrv.sys” by sending DeviceIoControl messages\nto the device “\\\\.\\MSNDSRV”. It activates the rootkit for its own process, for the target process holding the\norchestrator and for all the files involved.\n\n### Platform orchestrator – mscfg32.dll, svchost32.dll\n\n**MD5** 5767b9d851d0c24e13eca1bfd16ea424\n\n**Size** 249 856 bytes\n\n**Format** PE32 DLL\n\n**Compiled** 2008.01.24 22:11:34 (GMT)\n\n\n-----\n\n**Location** %System%\\mscfg32.dll\n\nCreates mutex: “01C482BA-BD31-4874-A08B-A93EA5BCE511“, or terminates if one already exists.\n\nWrites a timestamped log file to one of the following locations:\n\n**%SystemRoot%\\temp\\~yh56816.tmp**\n**C:\\Windows\\Temp\\~yh56816.tmp**\n**%Registry_SystemRoot_Value%\\temp\\~yh56816.tmp**\nValue of [HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\MemSubSys] D\n\nThe file “~yh56816.tmp” retains the history of execution. It comprises debug records of simple structure:\n\n**Stage: DWORD | DateTimeLow: DWORD | DateTimeHigh: DWORD**\n\nBasically, it logs the execution of every stage of the orchestrator and the time of execution. The Stage is an integer\nnumber starting from 1.\n\nThis module spawns a new thread in the DllMain function which contains the main function body. The procedure\ndisables application error popups shown by the default exception handler. This is probably done only in the\n“Release” version of the malware, because the following code generates exceptions that are reported to the user if\napplication error popups are not disabled. We assume that the “Debug” version of the code doesn’t suppress error\npopups when exception occurs as this helps with the debugging of the code.\n\nThe module checks the OS version and if it encounters an unsupported operating system the code generates an\nexception which terminates the application. The list of OS versions that pass this test:\n\nWindows 95/98/ME\nWindows NT 4.0 and above.\n\nIf the module runs on Win9x, it executes Win9x-specific function RegisterServiceProcess to hide from the\nWindows Task Manager application. If the module is NOT running on WinNT6.0+, it then attempts to open a virtual\ndevice file with one of the following names:\n\n**\\\\.\\MSSVC32 on Win9x**\n**\\\\.\\MSNDSRV on WinNT**\n\nIf the device file is successfully opened, the module activates a rootkit for its process and for the file location\n**“%SYSTEM%\\unilay.dll” local path. This is followed by finding and terminating a process named “winproc.exe”**\nwhich is the name of another component of the platform. Note that this part of the code is executed only on\nplatforms different from WinNT 6.x (Windows Vista and later).\n\nThe module was designed to fetch or update its main configuration data from different places. There are some\ndefault values set inside the code, such as some timeout values and the following C&Cs:\n\n**www.waeservices[.]com**\n**213.198.79.49**\n\nThese default values can be overwritten later.\n\nNext, it locates a data section called “Share2” in the current module and verifies the starting magic number. If it is\n**0x63959700, it then decrypts the rest of the data in the section and interprets it as a configuration block. However,**\ndata from the next location can override all previous settings. This is a registry value with special name.\n\nThe naming of the registry location is the same GUID-like SHA1 value as the one used in the loader\n(“mscfg32 exe”) and is produced from the source string “Configuration”:\n\n\n-----\n\n**_[HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\MemSubSys] {42E14DD3 F07A 78F1 7659_**\n**_26AE141569AC-E0B3EE89}_**\n\nThe configuration block stored in the registry value is encrypted using RC5 with the 1024-bit key. Both the loader\nand the orchestrator share the same key for encrypting and decrypting the registry values in the “MemSubSys”\nkey.\n\nThe decrypted configuration block consists of a series of tagged configuration records in the following format:\n\n**[RecordType:DWORD][RecordSize: DWORD][RecordValue: %RecordSize%]**\n\nWe retrieved a copy of a configuration block and decrypted and partly interpreted it. We are including the results\nfor one of the configuration blocks:\n\n**Time value: 1 year 0 months 1 days 22 hours 6 mins 52 secs. The orchestrator is expected to set this field to the**\ntime of initial configuration.\n**Binaries: 3×1024-bit encryption keys**\n1b8e7818dad6345c53c2707a2c44648eee700d5cf34fea6a19a3fa0a6a871c72963fdded\n91e2703c82b7747b8793e3063700da32cfb8d907dcce1beb36edd575418d1134ef188b\n27ec3ce23711a656b0a8bf28921fbf1c39b4c90ad561e4174ed90f26ce11245bb9deb4b\n4720403f47ca865ec8bbd3c1df9d93d042ff5b52ec6\n05000000000000000000000000000000000000000000000000000000000000000000\n00000000000000000000000000000000000000000000000000000000000000000000\n00000000000000000000000000000000000000000000000000000000000000000000\n0000000000000000000000000000000000000000000000000000\ned04953f3452068ae6439f04c7904c8be5e98e66e2cd0f267d65240aeed88bd4d3c6105\nc99950dd42ccde4bc6bbaf9f6cb1b4e628d943e91f8f97f2aff705fdd25e3af6ba0bc4fd13\nd67a2bcb751bb8f21f3d4b66c599f3e572802911394d142f8cf3a299d6d4558f9f0f01634\n9afd1888472f4f8c729ffe913f670931f1a227\n**C&C domain: www[dot]waeservices[dot]com**\n**C&C IP address: 213.198.79.49**\n**C&C port: 443**\n**Timestamp: 2010-12-08 11:35:57**\n**Tool Reference: VTT/82055898/STEALTHFIGHTER/ 2008-10-16/14:59:06.229-04:00**\n**TimeoutA: 25200 sec (7 hours)**\n**TimeoutB: 32400 sec (9 hours)**\n**TimeoutC: 3600 sec (1 hour)**\n**TimeoutD: 172800 sec (48 hours)**\n+Several Unknown Values\n\nOther configuration blocks we discovered contained similar information, with only some unique values:\n\n**Timestamp: 2009-11-23 14:10:15**\n**Tool Reference: Manual/DRINKPARSLEY/2008-09-30/10:06:46.468-04:00**\n**Tool Reference: VTT/82053737/STRAITACID/2008-09-03/10:44:56.361-04:00**\n**Tool Reference: STRAITSHOOTER30.ex_**\n**Tool Reference: VTT/82051410/LUTEUSOBSTOS/2008-07-30/17:27:23.715-04:00**\n**Tool Reference: BACKSNARF_AB25**\n\nDuring the next step, the module obtains PE file version information from the resource section. It loads the version\ninfo using hard-coded module names, which are supposed to match the current module name:\n\n**SVCHOST32.DLL for Windows 9x**\n**MSCFG32.DLL for Windows NT**\n\n\n-----\n\nIf file version information is available, it gets language specific values of the PrivateBuild block. The codepage and\nlanguages that are verified: Unicode, LANG_NEUTRAL and LANG_ENGLISH_US. When this check passes, the\nmodule gets @default registry value from the following location:\n\n**_[HKLM\\SOFTWARE\\Classes\\CLSID\\{091FD378-422D-A36E-8487-83B57ADD2109}] TypeLib_**\n\nIf the key is not found, the code checks for registry value TypeLib in the following key:\n\n**_[HKLM\\SOFTWARE\\Classes\\CLSID\\{091FD378-422D-A36E-8487-83B57ADD2109}]_**\n\nIf such a value is found, it is then deleted along with the Version value if it exists in the same key.\n\nThe string obtained from one of two possible registry values is processed as if this value is a CLSID-like string: the\ncode takes the last 16 hexadecimal digits, splits them in two 8-chars values, converts them to binary form (two\nDWORDs) and reverses the order of bytes in each DWORD and XORs, the first value with 0x8ED400C0, and the\nsecond with 0x4FC2C17B. Next, the first DWORD value becomes second and the second becomes first. In this\norder, they are stored in a structure in memory. These two values seem to be very important as they override a\nfew values in the previously known configuration. If they don’t exist, values from the current configuration replace\nthem and are stored back in the registry following the reverse procedure:\n\n1. [HKLM\\SOFTWARE\\Classes\\CLSID\\{091FD378-422D-A36E-8487-83B57ADD2109}\\Version] is created\n\nand @default value is set to version obtained from file version information PrivateBuild field (i.e.\n**3.04.00.0001). This seems to be used as kit version number.**\n2. [HKLM\\SOFTWARE\\Classes\\CLSID\\{091FD378-422D-A36E-8487-83B57ADD2109}\\Version] is created\n\nand @default value is set to a CLSID like string generated from the following:\n\nFixed prefix string: “{8C936AF9-243D-11D0-“\nTwo important DWORD values in the format of “%04X-%04X%08X}” string.\n\nWe collected and decrypted several samples of such values. According to the code, they are initialized with values\nof the Microsoft filetime format. So, we decided to interpret them as filetime values:\n\n20101C04EC2C17B: 1 year(s) 7 month(s) 21 day(s) 23 hour(s) 32 min(s) 1 sec(s)\n81E01C04EC2C17B: 1 year(s) 7 month(s) 8 day(s) 12 hour(s) 13 min(s) 5 sec(s)\nE0001C04EC2C17B: 1 year(s) 7 month(s) 21 day(s) 1 hour(s) 6 min(s) 15 sec(s)\n77101C04EC2C17B: 1 year(s) 5 month(s) 20 day(s) 19 hour(s) 15 min(s) 4 sec(s)\n30F01C04EC2C17B: 1 year(s) 8 month(s) 0 day(s) 6 hour(s) 10 min(s) 33 sec(s)\nC0901C04EC2C17B: 1 year(s) 8 month(s) 2 day(s) 6 hour(s) 29 min(s) 39 sec(s)\n66701C04EC2C17B: 1 year(s) 6 month(s) 9 day(s) 2 hour(s) 10 min(s) 23 sec(s)\nF6501C04EC2C17B: 1 year(s) 6 month(s) 6 day(s) 19 hour(s) 53 min(s) 22 sec(s)\n01401C04EC2C17B: 1 year(s) 6 month(s) 25 day(s) 23 hour(s) 34 min(s) 13 sec(s)\n\nAfter that, the module stores current time values in encrypted form in the registry value:\n\n**_[HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\MemSubSys] {08DAB849-0E1E-A1F0-DCF1-_**\n**_457081E091DB-117DB663} (encoded SHA1 of “StartTime”)_**\n\nThe module contains an additional compressed Windows DLL file in the resource section, which is extracted as\n**“unilay.dll” (see below). This DLL exports a number of functions that are just wrappers of the system API used to**\nwork with files and the registry, and also start processes and load additional DLL files.\n\nThe orchestrator contains several built-in plugins that form the core of the platform. These are initialized in the first\nplace, and then additional plugins are loaded. All the plugins are indexed in a single encrypted registry value:\n\n**_[HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\MemSubSys] 1_**\n\n\n-----\n\nThis value has information about all the components of the current kit. It may include Unicode strings with paths to\nextra DLLs which serve as plugins. Each DLL exports at least four functions which are imported by ordinal\nnumbers from 1 to 4.\n\nThe structure of the registry value “1”:\n\n**[Count:DWORD]{ [Plugin Id:WORD][Plugin Path Length:DWORD][Plugin Path String:VARIABLE] }**\n\nPlugins interact with each other and with the orchestrator by exchanging messages of pre-defined format. The\nmessage transport is implemented as a global object that contains four communication streams. Every stream\ncontains a pair of kernel synchronization object handles (a semaphore with fixed maximum value defaulted to\n1000 and a mutex) and a message queue as an array. A dedicated thread processes messages that appear in the\nmessage queues.\n\nA message arrives in a parcel, represented as two DWORD values that contain the size of the message and a\npointer to the message data. The message data starts with a DWORD identifying a class of message (a request,\nreply, etc).\n\nThe orchestrator contains the following built-in plugins (listed by internal ID): 8000, 8022, 8024, 803C, 8046, 800A,\n8042, 8002, 8004, 8006, 8008, 8070, 808E. Several additional built-in modules have been discovered in newer\nversions of the orchestrator that was shipped with the GrayFish platform.\n\n## EquationDrug Plugins:\n\n\n**Plugin**\n**ID**\n\n\n**File name** **Description**\n\n\n8000 _Built-in_ Core, basic API for other modules\n\n8002 wshcom.dll C&C communication using Windows sockets\n\n8004 _Built-in_ Additional message queue\n\n8006 _Built-in_ Memory allocation / storage\n\n8008 vnetapi32.dll& C&C communication code based on DoubleFantasy, using WinInet API\n\n800A _Built-in_ C&C communication orchestrator\n\n800C perfcom.dll HTTP communication\n\n8022 khlp680w.dll System API: execute processes, load libraries, manipulate files and directories\n\n8024 cmib158w.dll Collects system information: OS version, computer name, user name, locale,\nkeyboard layout, timezone, process lists\n\n8034 cmib456w.dll Management of the VFS backed by encrypted “.FON” files in the “Fonts\\Extension”\ndirectory. Provides encryption using RC5 for these files\n\n803E nls_874w.dll Network sniffer\n\n803C _Built-in_ Communication with the NDIS filter part of “msndsrv.sys”\n\n8040 khlp807w.dll Network exploration API, share enumeration and access\n\n8042 _Built-in_ Compression library based on Nrv2d / UCL\n\n8046 _Built-in_ Communication with the rootkit part of “msndsrv.sys”\n\n\n-----\n\n8048 mstkpr.dll Disk forensics and direct NTFS reader based on sources of SleuthKit\n\n8050 khlp760w.dll Additional encryption facilities for the file-backed VFS\n\n8058 khlp733w.dll Collects local system information, WMI information, cached passwords\n\n8070 khlp747w.dll Enumerates processes and system objects\n\n807A mscoreep32.dll Plugins for monitoring Internet Explorer and Mozilla browser activities\n\n808A khlp866w.dll Compression library based on Zlib\n\n808E _Built-in_ Reverse (PTR record) DNS resolver\n\n8094 _Built-in_ In-memory storage\n\n809C _Built-in_ In-memory storage\n\n80AA nls933w.dll HDD / SSD firmware manipulation\n\n80AE wpl913h.dll Keylogger and clipboard monitoring (aka “GROK”)\n\n80BE vnetapi.dll C&C communication via WinHTTP API\n\n80C6 webmgr.dll Extracts web history, Mozilla/Internet Explorer-saved form data and cached\ncredentials\n\n80CA wshapi.dll C&C communications interface via Windows sockets\n\n## Additional components\n\n### Unilay.DLL\n\nThis module provides a compatibility layer for accessing system API functions for Windows 9x. It redirects\nUnicode (“W”) variants of Windows API functions to corresponding ANSI variants by converting Unicode string\nparameters to multi-byte strings and calling the respective ANSI API.\n\n**MD5** EF4405930E6071AE1F7F6FA7D4F3397D\n\n**Size** 9 728 bytes\n\n**Compiled** 2008.01.23 14:23:10 (GMT)\n\n**Format** PE32 DLL, linker version 6.0 (Microsoft Visual C++ 6.0)\n\nExported functions (redirected to ANSI variants):\n\n100017EF: CopyFileW\n10001039: CreateDirectoryW\n10001111: CreateFileW\n100011B3: CreateProcessW\n10001177: DeleteFileW\n10001516: FindFirstChangeNotificationW\n10001466: FindFirstFileExW\n10001300: FindFirstFileW\n100014C6: FindNextFileW\n10001564: GetCurrentDirectoryW\n1000188F: GetFileAttributesW\n\n\n-----\n\n100016C6: GetStartupInfoW\n10001602: GetSystemDirectoryW\n10001664: GetWindowsDirectoryW\n10001853: LoadLibraryW\n1000178B: MoveFileExW\n1000172D: MoveFileW\n10001913: RegCreateKeyExW\n100019F5: RegDeleteKeyW\n10001DDF: RegDeleteValueW\n10001A39: RegEnumKeyExW\n10001BE2: RegEnumValueW\n1000199B: RegOpenKeyExW\n10001B23: RegQueryInfoKeyW\n10001D57: RegSetValueExW\n100010D5: RemoveDirectoryW\n10001E81: SHGetFileInfoW\n100015C6: SetCurrentDirectoryW\n100018CB: SetFileAttributesW\n10001E23: lstrcmpW\n\n### Network-sniffer/patcher – atmdkdrv.sys\n\n**MD5s** 8d87a1845122bf090b3d8656dc9d60a8\n\n214f7a2c95bdc265888fbcd24e3587da\n\n**Size** 41 440, 43 840 bytes\n\n**Format** PE32 Native\n\n**Compiled** 2009.04.16 17:19:30 (GMT)\n\n2008.05.07 19:55:14 (GMT)\n\n**Version Info** FileDescription: Network Services\nLegalCopyright: Copyright (C) Microsoft Corp. 1981-2000\nInternalName: atmdkdrv.sys\n\nor\n\nFileDescription: CineMaster C 1.1 WDM Main Driver\nLegalCopyright: Copyright 1999 RAVISENT Technologies Inc.\nInternalName: ATMDKDRV.SYS\n\nCreates a file storage “\\SystemRoot\\fonts\\vgafixa1.fon“. Its first word is set to 0x21 at the beginning of the\nDriverEntry function, and is replaced with 0x20 at the end of DriverEntry.\n\nThis driver appears to have been put together in “quick-and-dirty hack” style, using parts of the “mstcp32.sys”\nsniffer and other unknown drivers. It contains a lot of unused code which is partially broken or disabled. These\ninclude a broken “Dynamically disable/enable windows audit logging” subsystem and an incomplete “Patcher\nmode”.\n\nThere are three algorithms used for strings encryption – RC5; alphabet encryption like the one used in\n“mstcp32.sys”; and XOR with a pre-seeded random number generator. Decrypted strings are immediately\nencrypted back until the next usage to avoid in-memory detection.\n\n\n-----\n\nThe driver s filename and device name differ across the samples. They depend on the name of the registry key\nthat is used to start the driver.\n\nThe driver may operate in one of two independent modes – as a network sniffer or as a memory patcher. The\nmode of operation is selected on startup, based on the “Config2” value of the driver’s registry key. By default the\ndriver starts in “sniffer mode”.\n\n**Sniffer mode**\n\nThe sniffer code is similar to the one used in the driver’s “tdip.sys” and “mstcp32.sys” and uses NT4 NDIS-4, XP\nNDIS-5 interfaces, targeting incoming traffic on Ethernet and VPN (ndiswanip) interfaces. It captures only directed\npackets (containing a destination address equal to the station address of the NIC). Packers-filtering engine rules\nmay be set via DeviceIoControl messages. Filtered packets are stored in-memory until requested. Maximum\npackets storage list length is 128 items per filtering rule.\n\n**Patcher mode**\n\nAlmost broken, it does nothing interesting except, possibly, replace the thread’s ServiceTable to an unchanged,\nclear copy taken from the on-disk image of “ntoskrnl.exe”.\n\n**Sniffer only IOCTLs:**\n\n44038004 – add filtering rule\n\n44038008 – clear stored packet in specified filtering rules list\n\n4403800C – enable specified filtering rule\n\n44038010 – disable specified filtering rule\n\n44038014 – get stored packet from specified filtering rules list\n\n44038018 – process packet like the one received from the wire (filter and store)\n\n4403801C – set maximum rules list length\n\n44038020 – get maximum rules list length\n\n80000004 – enablePacketsFiltering\n\n80000008 – disablePacketsFiltering (PauseSniffer)\n\n800024B4 – send packet to the specified network interface\n\n**Common IOCTLs:**\n\n80000028 – do nothing (broken/unused part)\n\n80000038 – set external object (broken/unused part)\n\n8000003C – get 4 dwords struct (broken/unused part)\n\n80000040 – copy 260 bytes from the request (broken/unused part)\n\n80000320 – set I/O port mapping (broken/unused part)\n\n80000324 – clear I/O port mapping (broken/unused part)\n\n80000328 – set external PnP Event (broken/unused part)\n\n80000640 – replace specified thread’s SDT (ETHREAD.ServiceTable field) to a given copy\n\n### Backdoor driven by network sniffer – “mstcp32.sys”, “fat32.sys”\n\n**MD5s** 74DE13B5EA68B3DA24ADDC009F84BAEE\n\nB2C7339E87C932C491E34CDCD99FEB07\n\n311D4923909E07D5C703235D83BF4479\n\n21C278C88D8F6FAEA64250DF3BFFD7C6\n\n**Size** 57 328 – 57 760 bytes\n\n**Format** PE32 Native\n\n\n-----\n\n**Compiled** 2007.10.02 12:42:14 (GMT)\n\n2001.08.17 20:52:04 (GMT)\n\n**Version Info** FileDescription: TCP/IP driver\nLegalCopyright: Copyright (C) Microsoft Corp. 1981-1999\nInternalName: mstcp32.sys\n\nThis is a sniffer tool similar to “tdip.sys” and it uses NT4 NDIS-4, XP NDIS-5 interfaces. It targets incoming traffic\non Ethernet and VPN (ndiswanip) interfaces, but instead of dumb packet dumping, it uses received packets as\ncommands for the “process injector” subsystem that is able to extract and execute code from the specially crafted\nnetwork packets.\n\nDefault filtering rules are stored in the “Options” registry value of the driver’s registry key. It captures only directed\npackets (containing a destination address equal to the station address of the NIC).\n\nThe driver’s filename and device name differ across the samples. They depend on the name of the registry key\nthat is used to start the driver.\n\n**Code Patcher**\n\nThe driver patches OS code to dynamically disable or enable Windows audit logging.\n\nIt patches the function “LsapAdtWriteLog” in “lsasrv.dll” module of the “lsass.exe” process.\n\nIt searches for pre-defined signatures of the function “LsapAdtWriteLog” of known Windows versions – 4.0, 5.0,\n5.1, 5.2 (NT4, Win2000, XP, WinSrv2003).\n\nThen it selects a corresponding offset to replace the opcodes:\n\n‘jz’ to never taken ‘jo’ in case of XP\njmp over inner logic to procedure epilog in case of Windows Server 2003 so LsapAdtWriteLog skips logging\nof audit records\n\nThe module also patches “SepAdtLogAuditRecord” inside “ntoskrnl.exe” to “retn 4” instead of the first opcode of\nthe function.\n\nThe disabled audit can be restored after a timeout or on-event by a dedicated thread.\n\n**Expected IOCTL codes:**\n\n80000004 – setFilteringRules\n80000008 – disablePacketsFiltering (PauseSniffer)\n80000028 – do nothing (possible broken GetDriverName)\n80000038 – disable_audit\n8000003C – enable_audit\n\n**Code Injector**\n\nThe code-builder within this module facilitates exploitation by providing up to four predefined execution templates,\nwhich seem to be suitable for generating several code patterns.\n\nBelow is a list of the execution templates we found:\n\nlocate a DLL via PEB structure and resolve exports\ncall single function\ncall four functions\n\n\n-----\n\ncall six functions\n\nUsing these as a base for the templates, the code-builder inserts parameters and proper offsets to call one of the\nfollowing code patterns:\n\nLocate and call WinExec\nLocate and call LoadLibraryW, GetProcAddress, call exported procedure, FreeLibrary\nLocate and call LoadLibraryW, GetProcAddress, call GetModuleHandle, FreeLibrary\nLocate and call OpenProcess, VirtualAllocEx, WriteProcessMemory, CreateRemoteThread, VirtualFreeEx,\nCloseHandle\n\nThe code injection procedure allocates memory via ZwAllocateVirtualMemory in services.exe and copies\nimplanted code. After that it uses KeInsertQueueApc to let the code run and waits 30 seconds for APC to\ncomplete.\n\nWhen the module starts, it reads registry value [HKLM\\System\\CurrentControlSet\\Services\\%driver name%]\n**_Processes. This value may contain a list of process names that should be started by injected executable code but_**\nonly after services.exe and winlogon.exe has been started. The injection of code into winlogon.exe and\nservices.exe ensures that the newly started process will have SYSTEM user privileges. During the injection stage\nWindows Audit Logging is fully disabled to avoid leaving any suspicious records in Windows Logs.\n\n**Magic Packet Recognition**\n\nAll incoming packets are first filtered by BPF-like rules. The filtering rules are located in\n\n**_[HKLM\\System\\CurrentControlSet\\Services\\%driver name%] Options registry value or passed via_**\ncorresponding IOCTL. Packets that passed through the filter are added in the end of processing queue.\n\nPackets from the queue must have valid checksum values. After checking that, the code XOR-decrypts additional\ndata from the end of the packet. The decrypted end of the packet contains another control structure that defines\nwhich encryption algorithm is used to decipher packet body. Supported algorithms include RC5 and RSA. There is\na 1024-bits RSA public key hardcoded inside the module body, while a 96-bits RC5 key is generated dynamically.\n\nThe backdoor command may arrive in a single packet or be split into pieces and come with several packets. There\nis a procedure for re-assembling pieces together: a multi-packet command is added to a special packet collector\nwhich puts all the pieces together before passing it further.\n\n**Backdoor command is stored in the first byte of the decrypted request and can be one of the following values:**\n\n\n**Command**\n**Byte**\n\n\n**Short Name** **Description**\n\n\n0 StatusCheck Reply with encrypted DriverName, packet collector keys, “Processes” and\n“Params” registry values, names of processes for code injection (defaults\nare “services.exe” and “winlogon.exe”), list of unprocessed commands\nfrom packet collector.\n\n1 Panic Disable packet filtering, securely delete driver file, clear related registry\nkeys, set ClearPageFileAtShutdown flag, unbind adapters, delete devices\nand prepare for unloading. However, the driver cannot unload itself and it\nremains in the memory until reboot, which means it can be detected via\nDRIVER_OBJECT structure.\n\n2 CodeInject Injects code implant received from packet body.\n\n3 CallWinExec Disable Windows Audit and start new process via standard code injection\nin Winlogon.exe.\n\n4 ResetCollector Drop all packets with specific key from packet collector.\n\n\n-----\n\n5 Unused or disabled\n\n6 GenerateRC5Key Generates RC5 session key. 96-bits RC5 key is generated by taking a\nSHA1 hash of value from KeTickCount, XOR-encrypt with SHA1 hash of\ntwo PerformanceFrequency values, which is followed by nine more\nadditional SHA1 hashing.\n\n7 SetRegProcesses Sets new “Processes” registry value.\n\n8 DeleteRegProcesses Deletes current “Processes” registry value.\n\n9 SetRegParams Sets a universal “Params” registry value which is used for storing any\ninformation, i.e. could be a unique victim marker or exploitation stage\nnumber.\n\na Unused or disabled\n\nb Ping Reply with classic ICMP Echo Response packet.\n\nc ChangeInjectTarget Set new target injection processes (defaults are “Winlogon.exe” and\n“Services.exe”). Effective until reboot.\n\nNote: “mstcp32” is mentioned together with rootkit-like behavior in 2004 here:\n[http://www.pcreview.co.uk/forums/mstcp32-t1445152.html](http://www.pcreview.co.uk/forums/mstcp32-t1445152.html)\n\n### Network Sniffer – tdip.sys\n\n**MD5s** 20506375665a6a62f7d9dd22d1cc9870\n\n60dab5bb319281747c5863b44c5ac60d\n\n**Size** 22448 – 28800 bytes\n\n**Format** PE32 Native\n\n**Compiled** 2006.10.16 18:42:40 (GMT)\n\n2003.08.17 21:47:33 (GMT)\n\nSupports the following versions of Windows: NT4 using NDIS-4 and XP using NDIS-5. Doesn’t use Vista and later\nNDIS-6 features. However, later NDIS versions are backward-compatible, so the driver is still valid for current\nversions of Windows.\n\n**Version Info:**\n\nFileDescription: IP Transport Driver\nLegalCopyright: © Microsoft Corporation. All rights reserved.\nFileVersion: 5.1.2600.2180\nInternalName: tdip.sys\n\nThis driver is a packet sniffer for incoming-only traffic on Ethernet and VPN (ndiswanip) interfaces or any used with\nms_pschedmp as an alternative connection.\n\nIt implements a BPF (Berkeley packet filter) style packet-filtering system that is configured from the driver’s\nregistry configuration values or from DeviceIoControl messages.\n\nThe captured network packets may be written to disk in libpcap format (magic 0xA1B2C3D4 version 2.4) and\nencrypted with one-byte XOR, key 0xE3.\n\n\n-----\n\nThe driver s configuration is stored in the registry key:\n\n**[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\tdip]**\n\n**Options – packet filtering rules in BPF format**\n**Tag – selector of filtered packet types / Defaults in case of MediumWan to**\nNDIS_PACKET_TYPE_BROADCAST|NDIS_PACKET_TYPE_MULTICAST|NDIS_PACKET_TYPE_DIRECTED;\n(or NDIS_PACKET_TYPE_BROADCAST|NDIS_PACKET_TYPE_DIRECTED in any other case)\n**ImageFile – full path name to the resulting pcap file**\n**Duration – used as Length of the original packet in dump file. (default 0xffff)**\n**Backup – max size of the pcap file**\n\nIOCTLs:\n\n0x80002004 getCurrentState\n0x80002008 setFilteringRules\n0x8000200C getFilteringRules\n0x80002024 getDumpFileSize\n0x80002010/0x80002014/0x80002018/0x8000201C pause/resume\n0x80002020 getVersion – returns 2.4.0\n\nDriver has three logical parts, and uses an incomplete function pointer table as interface:\n\n1. Business logic: filtering rules, packet dumping, device ioctl, options\n2. Ndis driver skeleton\n3. Primitives lib: Strings, XORing, registry I/O\n\nThe code is of very good quality. It looks more complicated than Winpcap 2.3 (released 28 mar 2002), but less so\nthan Winpcap 3.0 (released by 10 apr 2003). Interestingly, the driver identifies itself as “version 2.4” in the pcap file\ndespite there being no Winpcap version 2.4.\n\n### Key/clipboard logger driver – msrtvd.sys\n\n**MD5s** 98dea1bce37bf7087360e1958400589b\n\nbb8f56874189d5dfe9294f0553a49b83\n\nf6bf3ed3bcd466e5fd1cbaf6ba658716\n\n**Size** 31 488 – 36 736 bytes\n\n**Format** PE32 Native\n\n**Compiled** 2010.02.19 22:45:18 (GMT)\n\n2008.09.17 16:23:54 (GMT)\n\n**Version Info** FileDescription: MSRTvd interface driver\nLegalCopyright: © Microsoft Corporation. All rights reserved.\nInternalName: msrtvd.sys\n\nThis is a keylogger and clipboard monitoring tool.\n\nOn startup, the driver creates a device named “\\Device\\Gk0” and a symbolic link named “\\DosDevices\\Gk“.\n\nThen it attaches to the csrss.exe process and disassembles user32.dll and ntdll.dll routines to obtain\n**win32k.sys and ntoskrnl.exe SDT services indexes and pointers of needed Nt/Zw APIs.**\n\n\n-----\n\nThen, using a built in disassembler, it obtains pointers to NtUserPeekMessage, NtUserGetMessage,\nNtUserGetClipboardData and using the disassembler again selects the parts of the code that will be then hooked\nby splicing.\n\nThe interceptor routines are copied from a special PE section named “.msda”. These routines are able to collect\nkey press chains and clipboard text data, add information about current Time, ProcessName,\nForegroundWindowText,and UserName related to this event.\n\nA dedicated thread (“dumper”) gathers the collected data, compresses the results with LZO appends it every 30\nminutes to a file “%system-wide TEMP%\\tm154o.da“.\n\nMost strings inside are encrypted by XOR with a pre-seeded random number generator.\n\nIOCTLs:\n\n0x22002C -start dumper thread\n0x220030 – stop dumper thread\n0x220034 – check if the driver has new data to dump\n0x220038 – set two external events signaled on dump data availability (it references a plugin possibility)\n0x22003C – restart dumper thread\n0x220040 – get size of available data\n\n### Collector plugin for Volrec – msrstd.sys\n\n**MD5s** 69e7943f3d48233de4a39a924c59ed2c\n\n15d39578460e878dd89e8911180494ff\n\n**Size** 13 696 – 17 408 bytes\n\n**Format** PE32 Native\n\n**Compiled** 2009.06.05 16:21:55 (GMT)\n\n2009.12.15 16:33:52 (GMT)\n\n**Version Info** FileDescription: msrstd driver\nLegalCopyright: © Microsoft Corporation. All rights reserved.\nInternalName: msrstd.sys\n\nThis driver is a plugin that collects events from the “volrec.sys” driver, and delivers them by sending\nDeviceIoControl messages. It collects events about file and disk volume operations.\n\nOn startup the driver obtains a pointer to “\\Device\\volrec“, then creates a control device “\\Device\\msrstd0” and a\nsymbolic link to it named “\\DosDevices\\msrstd”\n\nAll strings inside the driver are encrypted by XOR with a pre-seeded random number generator.\n\nFor file events the driver collects the filenames, and caches data about read and write operations. For disk volume\nevents it queries disk properties and reads volume labels and disk serial numbers of removable drives (USB,\nFireWire drives).\n\nIOCTLs:\n\n**0x220004 – turn on VolumeEvents collection**\n\n**0x220008 – turn off VolumeEvents collection**\n\n**0x22000C – retrieve previously stored VolumeEvent (operationType, deviceTypeFlags, VolumeLabel,**\nvolumeSerialNumber, DosDriveLetter)\n\n\n-----\n\n**0x220010 turn on FileEvents collection**\n**0x220014 – turn off FileEvents collection**\n**0x220018 – retrieve previously stored FileEvent (fileName, deviceTypeFlags, VolumeLabel, volumeSerialNumber,**\nDosDriveLetter)\n**0x22001C – connect to Volrec.sys (send ioctl 0x220004), enable plugin operation**\n**0x220020 – disconnect from Volrec.sys (send ioctl 0x220008), disable plugin operation**\n\n### Filesystem filter driver – volrec.sys, scsi2mgr.sys\n\n**MD5s** a6662b8ebca61ca09ce89e1e4f43665d\n\nc17e16a54916d3838f63d208ebab9879\n\n**Size** 14 464-14 848 byres\n\n**Format** PE32 Native\n\n**Compiled** 2009.06.05 16:21:57 (GMT)\n\n2009.12.15 16:33:57 (GMT)\n\n**Version Info** FileDescription: Volume recognizer driver\nLegalCopyright: © Microsoft Corporation. All rights reserved.\nInternalName: volrec.sys\n\nThis driver is a generic filesystem filter which feeds system events to user-mode plugins.\n\nOn startup the driver creates a control device named “\\Device\\volrec” and a symbolic link to it named\n“\\DosDevices\\volrec0”. It then attaches all available filesystem devices. It is also, able to handle removable\nstorage devices.\n\nAll strings inside the driver are encrypted by XOR with a pre-seeded random number generator.\n\nIOCTLs:\n\n0x220004 – setup plugin interface\n0x220008 – disable plugin calls\n\nThe driver handles the following system events:\n\nfile opened, created or closed\ndata is read or written to a file\nnew volume is mounted, unmounted\nnew USB or FireWire device attached\n\n### HDD/SSD operation helper driver – WIN32M.SYS\n\n**MD5s** 2b444ac5209a8b4140dd6b747a996653\n\nb3487fdd1efd2d1ea1550fef5b749037\n\n**Size** 19 456 – 26 631 bytes\n\n**Format** PE32 Native, PE32+ Native\n\n**Compiled** 2001.08.23 17:03:19 (GMT)\n\n2013.05.14 15:58:36 (GMT)\n\n**Description** This module will be the subject of a dedicated blogpost.\n\n\n-----\n\n### HDD/SSD firmware operation nls_933w.dll\n\n**MD5s** 11fb08b9126cdb4668b3f5135cf7a6c5\n\n9f3f6f46c67d3fad2479963361cf118b\n\n**Size** 212 480 – 310 272 bytes\n\n**Format** PE32 DLL, PE32+ DLL\n\n**Compiled** 2010.06.15 16:23:37 (GMT)\n\n2013.05.14 16:12:35 (GMT)\n\n\n**Version Info**\n(64bit dll only)\n\n\nFileDescription: Windows Networking Library\nLegalCopyright: Copyright (C) Microsoft Corp. 1981-2001\nFileVersion: 80AA\nInternalName: nls_933w.dll\nOriginalFilename: nls_933w.dll\nPrivateBuild: 4.0.1.0\nProductName: Microsoft(R) Windows (R) 2000 Operating System\nProductVersion: 5.0.2074.0\nFull Version: 1.0.0.1\n\n\n**Description** This (80AA) plugin is a HDD firmware flashing tool which includes an API and the ability to\nread/write arbitrary information into hidden sectors on the disk.\n\nThe plugin will be the subject of a separate blogpost.\n\n[APT](https://securelist.com/tag/apt/)\n[Cyber espionage](https://securelist.com/tag/cyber-espionage/)\n[Equation](https://securelist.com/tag/equation/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Nation State Sponsored Espionage](https://securelist.com/tag/nation-state-sponsored-espionage/)\n[Spyware](https://securelist.com/tag/spyware/)\n[Stuxnet](https://securelist.com/tag/stuxnet/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\nGReAT\n\nInside the EquationDrug Espionage Platform\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-03-11 - Inside the EquationDrug Espionage Platform.pdf"
    ],
    "report_names": [
        "2015-03-11 - Inside the EquationDrug Espionage Platform.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535936,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653703265,
    "ts_modification_date": 1653703265,
    "files": {
        "pdf": "https://archive.orkl.eu/dbd4f9814e370e4db988744b87d72402d6ae56c6.pdf",
        "text": "https://archive.orkl.eu/dbd4f9814e370e4db988744b87d72402d6ae56c6.txt",
        "img": "https://archive.orkl.eu/dbd4f9814e370e4db988744b87d72402d6ae56c6.jpg"
    }
}