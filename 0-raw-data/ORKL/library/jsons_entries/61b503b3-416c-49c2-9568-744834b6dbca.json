{
    "id": "61b503b3-416c-49c2-9568-744834b6dbca",
    "created_at": "2023-01-12T15:05:42.612191Z",
    "updated_at": "2025-03-27T02:16:35.017471Z",
    "deleted_at": null,
    "sha1_hash": "830d079ae5d92d013c0487642e6f862222bfd032",
    "title": "2020-12-24 - SUNBURST Additional Technical Details",
    "authors": "",
    "file_creation_date": "2022-05-28T00:25:09Z",
    "file_modification_date": "2022-05-28T00:25:09Z",
    "file_size": 134073,
    "plain_text": "# SUNBURST Additional Technical Details\n\n**[fireeye.com/blog/threat-research/2020/12/sunburst-additional-technical-details.html](https://www.fireeye.com/blog/threat-research/2020/12/sunburst-additional-technical-details.html)**\n\nThreat Research\n\nStephen Eckels, Jay Smith, William Ballenthin\n\nDec 24, 2020\n\n18 mins read\n\nThreat Research\n\nFireEye has discovered additional details about the SUNBURST backdoor since our initial\npublication on Dec. 13, 2020. Before diving into the technical depth of this malware, we\nrecommend readers familiarize themselves with our blog post about the SolarWinds supply\nchain compromise, which revealed a global intrusion campaign by a sophisticated threat\nactor we are currently tracking as UNC2452.\n\n\n-----\n\nSUNBURST is a trojanized version of a digitally signed SolarWinds Orion plugin called\nSolarWinds.Orion.Core.BusinessLayer.dll. The plugin contains a backdoor that\ncommunicates via HTTP to third party servers. After an initial dormant period of up to two\nweeks, SUNBURST may retrieve and execute commands that instruct the backdoor to\ntransfer files, execute files, profile the system, reboot the system, and disable system\nservices. The malware's network traffic attempts to blend in with legitimate SolarWinds\nactivity by imitating the Orion Improvement Program (OIP) protocol and persistent state data\nis stored within legitimate plugin configuration files. The backdoor uses multiple obfuscated\nblocklists to identify processes, services, and drivers associated with forensic and anti-virus\ntools.\n\nIn this post, the following topics are covered in greater detail:\n\nAnti-Analysis Environment Checks and Blocklists\nDomain Generation Algorithm and Variations\nCommand and Control (C2) behaviors for DNS A and CNAME records\nMalware modes of operation\n\n**Anti-Analysis Environment Checks**\n\nBefore reaching out to its C2 server, SUNBURST performs numerous checks to ensure no\nanalysis tools are present. It checks process names, file write timestamps, and Active\nDirectory (AD) domains before proceeding. We believe that these checks helped\nSUNBURST evade detection by anti-virus software and forensic investigators for seven\nmonths after its introduction to the SolarWinds Orion supply chain.\n\nFirst, the backdoor verifies that the lowercase name of the current process is\nsolarwinds.businesslayerhost. UNC2452 avoided including this string directly in the source\ncode by computing a hash of the string and comparing the result to the 64-bit number\n17291806236368054941. The hash value is calculated as a standard FNV-1A 64-bit hash\nwith an additional XOR by the 64-bit number 6605813339339102567. The additional XOR\noperation forces malware analysts to develop custom tools to brute force the hash preimage.\n\nNext, the backdoor only executes if the filesystem last write time of the .NET assembly\nSolarWinds.Orion.Core.BusinessLayer.dll is at least 12 to 14 days prior to the current time.\nThe exact threshold is selected randomly from this interval. In other words, SUNBURST lays\nlow for almost two weeks before raising its head. If the timestamp check fails, the backdoor\nwill execute again at a random later time when it is invoked by a legitimate recurring\nbackground task. Once the threshold is met, the sample creates the named pipe 583da94562af-10e8-4902-a8f205c72b2e to ensure only one instance of the backdoor is running. If the\nnamed pipe already exists, the malware exits.\n\n\n-----\n\nSUNBURST stores its configuration in the legitimate\nSolarWinds.Orion.Core.BusinessLayer.dll.config file. It repurposes two existing settings in\nthe appSettings section: ReportWatcherRetry and ReportWatcherPostpone. During\ninitialization, the backdoor determines if the ReportWatcherRetry setting is the value 3. This\nvalue indicates the malware has been deactivated and will no longer perform any network\nactivity. As we describe later, UNC2452 can command the backdoor to disable itself. This\nfeature may be utilized when the operator determines the victim is not of interest or that\nthey’ve completed their mission. When investigating a system compromised by SUNBURST,\nreview this setting to determine if the backdoor has been disabled. Note, the presence of this\nvalue does not offer proof the actor did not further compromise the environment before\ndisabling SUNBURST.\n\nThe backdoor also determines if the system is joined to an Active Directory (AD) domain\nand, if so, retrieves the domain name. Execution ceases if the system is not joined to an AD\ndomain. SUNBURST checks the AD domain name against a blocklist and halts execution if it\ncontains one of the following values:\n\nswdev.local emea.sales pci.local apac.lab\n\nswdev.dmz cork.lab saas.swi dmz.local\n\nlab.local dev.local lab.rio lab.brno\n\nlab.na test solarwinds\n\nWe suspect these hard-coded AD domains may be SolarWinds internal domains that\nUNC2452 wanted to avoid.\n\nFinally, SUNBURST verifies the system has internet connectivity by ensuring it can resolve\nthe DNS name api.solarwinds.com. Otherwise, execution stops and retries at a random later\ntime.\n\n**Anti-Analysis Blocklists**\n\nSUNBURST's behavior is affected by the presence of malware analysis and security\nsoftware. To disguise the strings used to detect these security tools, UNC2452 calculated\nand embedded a hash value for each string. While it is trivial for the backdoor to check for\nthe existence of a hashed process name, it is computationally expensive to determine what\nstring a hash value corresponds to (the “preimage”). However, thanks to some hard work by\nmembers of the information security community, the hashes have been successfully bruteforced. The list of hashes and their corresponding strings can be viewed at this FireEye\nGitHub page.\n\n\n-----\n\nSUNBURST uses the aforementioned FNV-1A plus XOR algorithm to compute the hash of\neach process name, service name, and driver filename on the system.\n\nIf a blocklisted process or driver name is found, SUNBURST pauses and tries again later.\nThe backdoor continues past this check only when there are no processes nor drivers from\nthe blocklist present.\n\nIf a blocklisted service is found, SUNBURST attempts to disable the blocklisted service by\nmanipulating the service configuration in the Windows Registry. It sets the registry value\nHKLM\\SYSTEM\\CurrentControlSet\\services\\<service_name>\\Start to the value 4, which\ncorresponds to SERVICE_DISABLED. As a result, the blocklisted service is disabled on the\n_next power cycle. This means the presence of a blocklisted service on a compromised host_\ndoes not make a system immune to SUNBURST.\n\nAfter the registry modification is made, SUNBURST updates the ReportWatcherPostpone\nconfiguration value to reflect the service it disabled. Then, the backdoor pauses and retries\nthe process and service blocklist checks at a later time.\n\nSubsequent service blocklist checks skip services already present in the\nReportWatcherPostpone configuration key. SUNBURST will not treat the services it has\ndisabled as members of the blocklist anymore. Therefore, during an incident response,\nforensic teams should consider recovering and decoding this configuration key to parse out\nwhich services SUNBURST attempted to disable.\n\n**Domain Generation Algorithm**\n\nIn this section we describe how SUNBURST uses an intermediary command and control\n(C2) coordinator to retrieve its final C2 server. The C2 coordinator instructs the backdoor to\ncontinue or halt beaconing. It also redirects SUNBURST to its final C2 server via DNS\nCNAME records. We believe this enables UNC2452 to compartmentalize their operations,\nlimiting the network infrastructure shared among victims.\n\nThe C2 coordinator is implemented as the authoritative DNS server for the avsvmcloud[.]com\ndomain. To communicate with the C2 coordinator, SUNBURST uses a Domain Generation\nAlgorithm (DGA) to construct subdomains of avsvmcloud[.]com and resolves the fully\nqualified domain names (FQDN) using the system DNS client. The backdoor interprets the\nDNS responses in an unusual way to receive orders from the C2 coordinator.\n\nThe DGA generates subdomains with the following DNS suffixes to create the FQDN:\n\n.appsync-api.eu-west-1[.]avsvmcloud[.]com\n.appsync-api.us-west-2[.]avsvmcloud[.]com\n.appsync-api.us-east-1[.]avsvmcloud[.]com\n.appsync-api.us-east-2[.]avsvmcloud[.]com\n\n\n-----\n\nA method named Update is responsible for initializing cryptographic helpers for the\ngeneration of these random-looking C2 subdomains. Subdomains are generated by\nconcatenating an encoded user ID with an encoding of the system's domain name. The C2\ncoordinator can recover the victim domain name from the encoded data and likely uses this\nto route SUNBURST to its final C2 server.\n\nA user ID is generated based on three values:\n\nMAC address of the first available, non-loopback network interface\nDomain name\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography\\MachineGuid value\n\nSUNBURST takes the MD5 hash of these combined values and encodes it using a custom\nXOR scheme. We believe this value is used by UNC2452 to track unique victims.\n\nSUNBURST uses four different forms of subdomains to signify the operating mode of the\nbackdoor. Each form contains slightly different information. However, in two of the forms,\ninvestigators can recover the domain names of victim organizations. We recommend\nreviewing DNS logs to confirm the presence of a victim’s domain in SUNBURST C2\ncoordinator traffic.\n\nWhen SUNBURST is in its initial mode, it embeds the domain of the victim organization in its\nDGA-generated domain prefix. Once the malware transitions to an “active” mode, the\nmalware uses the other two forms of subdomains. These do not include the AD domain, but\ninstead include encodings of either the list of running and stopped services or a timestamp.\n\nThe open-source community has done a fantastic job reverse engineering many of the\nsubdomain forms. While we are not aware of any public decoder scripts that reverse all four\npossible encodings, most decoders focus on recovering the most useful information: the user\nID and domain name embedded in the subdomains. We recommend that incident\nresponders for victim organizations with access to DNS logs use these tools to confirm their\nAD domains are not embedded within SUNBURST generated DNS subdomains. Note that\nthis does not indicate follow-on activity.\n\nThe following sources may be referenced for decoding such domains:\n\n[https://securelist.com/sunburst-connecting-the-dots-in-the-dns-requests/99862/](https://securelist.com/sunburst-connecting-the-dots-in-the-dns-requests/99862/)\n[https://github.com/RedDrip7/SunBurst_DGA_Decode](https://github.com/RedDrip7/SunBurst_DGA_Decode/blob/main/decode.py)\n[https://blog.cloudflare.com/a-quirk-in-the-sunburst-dga-algorithm/](https://blog.cloudflare.com/a-quirk-in-the-sunburst-dga-algorithm/)\n\n\n-----\n\nDiagram of actor operations and usage of SUNBURST\n\n\nFigure 1: Diagram of actor operations and usage of SUNBURST\n\n**Command and Control**\n\nSUNBURST uses a two-part C2 protocol that involves both DNS and HTTP. In “passive”\nmode, the backdoor communicates with its C2 coordinator via DNS and receives high-level\nupdates to its state. For example, the C2 coordinator may tell the backdoor to go to sleep or\nspring into action. When the backdoor is in “active” mode, it communicates via HTTP to its\nfinal C2 server and receives detailed commands such as “spawn a process” or “transfer a\nfile”.\n\n**DNS C2 and the C2 Coordinator Protocol**\n\nWhen communicating with the C2 coordinator, the backdoor continuously generates domains\nvia its DGA. The backdoor delays execution for random intervals between generating\ndomains In some cases this delay is up to 9 hours\n\n\n-----\n\nIf the C2 coordinator responds with a DNS A record, SUNBURST checks the resolved\naddress against a hard-coded list of IP address blocks. If the address falls within a block, the\nbackdoor transitions into an associated mode. The backdoor starts in the “passive” mode\nwhere it does nothing but check blocklists, sleep, and beacon via DNS until a transition is\nseen. Other modes are “active”, in which the malware communicates via HTTP, and\n“disabled”, in which the malware is permanently disabled. These modes and transitions are\ndefined in the Modes of Operation section.\n\nThe C2 coordinator may also respond with a DNS CNAME response. In this case, the\nmalware uses the pointed-to domain from the CNAME response for HTTPS C2\ncommunications. SUNBURST starts a thread to handle command execution and further C2\nHTTP(S) callouts. As an investigator, if you see CNAME resolutions for subdomains of\navsvmcloud[.]com, it‘s possible that UNC2452 initiated follow-on C2 within the environment.\n\nNote, the malware must receive a DNS A record response pointing to one of the following\nsubnets immediately prior to receiving a DNS CNAME response. Otherwise, the CNAME\nresolution will be ignored and treated as an error. In addition, for these subnets, the leastsignificant bytes from the A record IP address are parsed to obtain configuration data such\nas the proxy method to use, the URI scheme to use, and a delay value used in the HTTP\nthread.\n\n18.130.0.0/16 99.79.0.0/16 184.72.0.0/15\n\nSubsequent DNS A record responses in the following subnet ranges cause the DGA\nbeaconing to continue.\n\n8.18.144.0/23 18.130.0.0/16 71.152.53.0/24 99.79.0.0/16\n\n87.238.80.0/21 199.201.117.0/24 184.72.0.0/15\n\nOtherwise, subsequent DNS A record responses in the following subnet ranges cause\nSUNBURST to terminate and update the configuration key ReportWatcherRetry to a value\nthat prevents further execution. This is the killswitch.\n\n10.0.0.0/8 fc00:: - fe00:: 96.31.172.0/24\n\n172.16.0.0/12 fec0:: - ffc0:: 131.228.12.0/22\n\n192.168.0.0/16 ff00:: - ff00:: 144.86.226.0/24\n\n\n-----\n\n224.0.0.0/3 20.140.0.0/15\n\nWhile in “active” mode, the DGA subdomain encoding does not include victim machine\ndomain name information. Instead, the DGA subdomains encode a timestamp or the list of\nstopped/running services. To transition back to “passive” mode, the malware operator may\nset the DNS server to resolve A records within the following IP ranges:\n\n41.84.159.0/24 74.114.24.0/21 154.118.140.0/24 217.163.7.0/24\n\nIf the malware is transitioned from the “active” mode back to “passive”, the C2 coordinator\nmust repeat the activation process if the operator wants to re-activate the sample.\n\n**HTTP(S) C2**\n\nAfter receiving a CNAME DNS response with a new host to communicate with, SUNBURST\nstarts a new thread to execute the method HttpHelper.Initialize. This method is responsible\nfor the C2 communications and dispatching. The HTTP thread begins by delaying for a\nconfigurable amount of time that is controlled by the SetTime command. The HTTP thread\ndelays for a minimum of one minute between callouts. The malware uses HTTP GET or\nPOST requests. The sample disables certificate verification so it is possible to decrypt\nHTTPS traffic if SSL man-in-the-middle is performed.\n\nThe malware constructs HTTP GET or POST request URIs from random selections of\nsubstrings. The scheme used depends on the A record received just prior to the CNAME\nDNS response. When sending a GET request, the malware adds an \"If-None-Match\" HTTP\nheader that includes the encoded user ID. This likely allows the C2 server to determine\nwhich SUNBURST installation generated the request, further enabling multiplexing of C2\nstreams on a single server.\n\nIn observed traffic, the C2 server employs steganography to hide data within HTTP response\nbodies and attempts to appear as benign XML related to .NET assemblies. Command data is\nspread across many GUID and hexadecimal strings. Commands are extracted from HTTP\nresponse bodies by searching for hexadecimal strings using the following regular expression:\n\"\\{[0-9a-f-]{36}\\}\"|\"[0-9a-f]{32}\"|\"[0-9a-f]{16}\". Matched substrings in the response are filtered\nfor non-hex characters, joined together, and hex-decoded. Depending on the mode of\noperation, the malware may skip the steganography and send the encoded response in an\nHTTP response body.\n\n\n-----\n\nC2 response embeds commands in XML GUIDs\n\n\nFigure 2: C2 response embeds commands in XML GUIDs\nIn the received C2 response, the first DWORD value indicates the actual size of the\nmessage. This value is followed immediately by the message with optional junk bytes added.\nThe extracted message is single-byte XOR decoded using the first byte of the message. The\nresult is then DEFLATE decompressed. The first character of the decompressed data is an\nASCII integer that maps to a command ID, with optional additional command arguments\ndelimited by space characters. The supported commands are shown in the following table.\n\n**Command** **ID** **Operation**\n\nIdle 0 No operation\n\nExit 1 Terminate the current thread.\n\n\n-----\n\nSetTime 2 Sets the delay time between main event loop\nexecutions Delay is in seconds, and varies\nrandom between [.9 * <delay>, 1.1 * <delay>]\n\nIf the delay is < 300 it is doubled on the next\nexecution through the loop, this means it\nshould settle onto an interval of around [5, 10]\nminutes\n\no There is a second, unrelated delay routine\nthat delays for a random interval between\n\n[16hrs, 83hrs]\n\nCollectSystemDescription 3 Profile the local system including hostname,\nusername, OS version, MAC addresses, IP\naddress, DHCP configuration, and domain\ninformation.\n\nUploadSystemDescription 4 Perform an HTTP request to the specified\nURL, parse the results and send the response\nto the C2 server.\n\nRunTask 5 Starts a new process with the given file path\nand arguments\n\nGetProcessByDescription 6 Returns a process listing. If no arguments are\nprovided, returns just the PID and\nprocess name. If an argument is provided, it\nalso returns the parent PID and\nusername and domain for the process owner.\n\nKillTask 7 Terminate the given process, by PID.\n\nGetFileSystemEntries 8 Given a path, and a match pattern recursively\nlist files and directories.\n\nWriteFile 9 Given a file path and a Base64-encoded\nstring write the contents of the Base64 string\nto the given file path. Write using append\nmode. Delay for [1s, 2s] after writing is done.\n\nFileExists 10 Tests whether the given file path exists.\n\n\n-----\n\nDeleteFile 11 Deletes the specified file path.\n\nGetFileHash 12 Compute the MD5 of a file at a given path and\nreturn the result as a hex string. If an\nargument is provided, it is the expected MD5\nhash of the file and returns an error if the\ncalculated MD5 differs.\n\nReadRegistryValue 13 Arbitrary registry read from one of the\nsupported hives.\n\nSetRegistryValue 14 Arbitrary registry write from one of the\nsupported hives.\n\nDeleteRegistryValue 15 Arbitrary registry delete from one of the\nsupported hives.\n\nGetRegistrySubKeyAndValueNames 16 Returns listing of subkeys and value names\nbeneath the given registry path.\n\nReboot 17 Attempts to immediately trigger a system\nreboot.\n\nSUNBURST sends messages back to the C2 server using a protocol that consists of UTF-8\nstrings and an appended 4-byte error DWORD and 8-byte userID. These are bare DEFLATE\ncompressed and single-byte XOR encoded with the XOR key prepended to the message.\nMessage payloads of length 10,000 or less are turned into JSON documents that resemble\nthe Orion Improvement Program (OIP) messages used legitimately by SolarWinds.\nMessages larger than 10,000 bytes are sent as-is in the HTTP request body.\n\nThe fake OIP document contains the following fields:\n\nuserId – a unique identifier for the victim machine\nsessionID – stores a new random GUID for each HTTP thread\nsteps – an array of objects that contain the following keys: Timestamp, Index,\nEventType, EventName, DurationMs, Succeeded, and Message.\n\nThe JSON key EventType is hard-coded to the value Orion and the EventName is hardcoded to EventManager. The encoded message to send to the C2 server is split up into\nrandom ranges, Base64-encoded, and stored in the Message field of the objects in the steps\narray. Not all objects in the steps array contribute to the malware response. The integer in\nthe Timestamp field must have the 0x2 bit set to indicate the contents of the Message field\n\n\n-----\n\nare used in the malware response. steps objects whose 0x2 bit is clear in the Timestamp\nfield contain random data and are discarded when assembling the malware response. This\nmay be an attempt to hinder analysis in the absence of the malware sample.\n\n\nHTTP callout masquerades as OIP protocol\n\n\nFigure 3: HTTP callout masquerades as OIP protocol\n\n**Modes of Operation**\n\nAs detailed in the DGA section, the malware has multiple modes of operation configured by\nthe IP block that A records resolve to as well as depending on if CNAME records exist.\nThese modes of operation are stored in internal enumerations. These mappings and values\nare described next.\n\nInternal Modes\n\nThe following modes govern internal operations of the malware:\n\n\n-----\n\n**Mode**\n**Name**\n\n\n**Value** **Description**\n\n\nTruncate 3 Disabled; the malware killswitch has been activated and the sample\nmay never run again without external modification to the XML\nconfiguration on-disk.\n\nNew 4 Passive mode; DGA subdomains encode the system’s domain name\n\nAppend 5 Active mode; C2 beaconing will occur on next CNAME resolve or is\nalready actively occurring. DGA domains encode either the userID or\nthe list of services\n\nThe mode values are written into the backdoor configuration key ReportWatcherRetry.\nInvestigators may consider recovering the malware configuration and inspecting this\nconfiguration value to determine the last running mode of the malware.\n\nThe following transitions govern how IP block ranges are translated into running modes:\n\n**Transition Name** **Description**\n\nAtm Transition to Truncate\n\nIpx Transition from Append to New\n\nImpLink Transition to Truncate\n\nNetBios Transition to Append, either start or continue C2 beaconing\n\nUnknown Not an IPv4 or IPv6 address, exit and retry DGA later\n\nThe following diagram describes how the SUNBURST’s DGA DNS responses act as mode\ntransitions to control the malware before HTTP-based C2 beaconing has even begun:\n\n\n-----\n\nsunburst diagram\n\n\nAdditionally, here is an annotated network log showing how a sequence of DNS resolutions\ncan transition the malware mode:\n\n\n-----\n\nsunburst annotated network log\n\n\nTo end this discussion of modes and transitions, a small note about the choices of these IP\nblocks. In cases such as the ImpLink IP blocks that activate the killswitch, it’s likely that the\nranges were specifically chosen by the attacker to avoid being discovered by security\nresearchers. In other cases, such as the NetBios and \"special\" NetBios IP blocks, the\ncompanies these blocks resolve to is likely irrelevant or at least beyond what can be\ndefinitively said without speculation.\n\n**Malware Flow Diagram**\n\nThe following diagram provides a full picture of the malware's execution. Internally,\nSUNBURST uses a set of modes and transitions as described earlier. The names of these\nmodes and transitions have no meaning. The malware authors purposely chose them as a\n\n\n-----\n\nform of obfuscation. When diagraming the malware s execution, these names were reused\nfor clarity.\n\n\nMalware logic and decision states\n\n\nFigure 4: Malware logic and decision states\n\n**Q&A**\n\n_Is a system running blocklisted processes, services, or drivers safe from compromise?_\n\nSometimes, but not always. SUNBURST unconditionally exits if blocklisted processes or\ndrivers are found and will not run until they are no longer detected. On the other hand,\nservices are disabled by setting a registry value that controls startup initialization and are not\nexplicitly stopped. As a result, a blocklisted service may still be running when the malware\nperforms its service checks later. For this reason, it is possible for a victim system to be\ninfected while a blocklisted service is running. Additionally, SUNBURST only attempts to\n\n\n-----\n\ndisable a service once and updates its configuration to mark the service as disabled. Once\nthe configuration is updated, the service is not treated as a blocklisted entry during\nsubsequent execution.\n\n_Does observing one DGA encoding over another provide any information during incident_\n_response?_\n\nShort answer: it provides a hint for where to look but isn’t a be-all tell-all alone. Noticing the\nDGA encoding change in network logs is a hint that the malware may have moved from New\nto Append or Append to New. This puts the malware in a mode where if a CNAME record is\nseen soon after, then HTTP C2 can begin. Incident response should focus on trying to\nidentify CNAME records being successfully resolved instead of focusing on DGA encodings\nentirely. Identifying CNAME records is easier than tracking the malware mode through logs\nand a stronger signal.\n\n_What is the \"killswitch\"?_\n\nFireEye discovered that certain DNS responses cause the malware to disable itself and stop\nfurther network activity. With the support and help of GoDaddy’s Abuse Team and the\nMicrosoft Threat Intelligence Center, the domain used for resolving DGA domains was\nreconfigured to point to a sinkhole server under Microsoft’s control. The IP of this sinkhole\nserver was specially chosen to fall into the range used by the malware to transition from its\ncurrent mode (New or Append) into Truncate mode where it will be permanently inactive. In\nother words, SUNBURST infections should now be inoculated due to the killswitch.\n\n_When C2 communication occurs, is a CNAME record required?_\n\nCNAME records are required for HTTP C2 beaconing to occur and are provided by the C2\ncoordinator to specify the final C2 server. C2 activity must occur over a domain name\nprovided via a CNAME record. It cannot occur directly via a raw IP. To initialize C2\nbeaconing, the backdoor first looks for an A record response from one of its special NetBios\nsubnets and subsequently expects to receive a CNAME record.\n\n_If a DGA domain is decoded to a company domain name, is that company compromised?_\n\nWhen the backdoor is in “passive” mode it uses the DGA encoding which embeds victim AD\ndomain names. This means that any system where the backdoor is present may have\nstarted trying to contact DNS servers where an attacker could then activate the backdoor to\nbegin active C2 communications. In most cases this did not occur and backdoors for nontargets were disabled by the operator. Therefore, it cannot be assumed that an organization\nexperienced follow-on activity if their domain is decoded from any DNS logs. Specifically, it’s\nonly an indicator that the backdoor code was present and capable of being activated.\n\n**Public Contributions**\n\n\n-----\n\nWe have seen substantial community contributions to our public SUNBURST GitHub\nrepository.\n\nWe would like to publicly thank all contributors to this repository. Specifically, all FNV hashes\nembedded within SUNBURST have been brute-forced. This is a huge amount of compute\npower that members of the community provided free-of-charge to help others. We want to\nthank everyone who contributed hashes and specifically callout the Hashcat community,\nwhich organized to systematically break each hash. This was essential for breaking the final\nfew hashes whose preimage were of considerable length.\n\n**Acknowledgements**\n\nMatthew Williams, Michael Sikorski, Alex Berry and Robert Wallace.\n\n_For additional information on UNC2452, register for our webinar,_ _UNC2452: What We Know_\n_So Far, on Tuesday, Jan. 12, at 8 a.m. PT/11 a.m. ET._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-24 - SUNBURST Additional Technical Details.pdf"
    ],
    "report_names": [
        "2020-12-24 - SUNBURST Additional Technical Details.pdf"
    ],
    "threat_actors": [
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535942,
    "ts_updated_at": 1743041795,
    "ts_creation_date": 1653697509,
    "ts_modification_date": 1653697509,
    "files": {
        "pdf": "https://archive.orkl.eu/830d079ae5d92d013c0487642e6f862222bfd032.pdf",
        "text": "https://archive.orkl.eu/830d079ae5d92d013c0487642e6f862222bfd032.txt",
        "img": "https://archive.orkl.eu/830d079ae5d92d013c0487642e6f862222bfd032.jpg"
    }
}