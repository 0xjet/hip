{
    "id": "38b8ffc7-3b2a-4c0e-8627-41588d5316d7",
    "created_at": "2023-01-12T15:10:19.306854Z",
    "updated_at": "2025-03-27T02:16:03.329604Z",
    "deleted_at": null,
    "sha1_hash": "1f822501b64b0cc1a8691486bca602fd5e1fa714",
    "title": "2019-08-26 - APT-C-09 Reappeared as Conflict Intensified Between India and Pakistan",
    "authors": "",
    "file_creation_date": "2022-05-28T22:00:35Z",
    "file_modification_date": "2022-05-28T22:00:35Z",
    "file_size": 1625332,
    "plain_text": "# 奇安信威胁情报中心\n\n**[ti.qianxin.com/blog/articles/apt-c-09-reappeared-as-conflict-intensified-between-india-and-pakistan/](https://ti.qianxin.com/blog/articles/apt-c-09-reappeared-as-conflict-intensified-between-india-and-pakistan/)**\n\n## Overview\n\nRecently, an XLSM decoy document is captured by the RedDrip team of QiAnXin Threat Intelligence Center by utilizing public intelligence.\nAfter taking a deeper analysis, we figure out that the C2 configurations are located on Github and Feed43. Multiple Github spaces have been\nexposed through correlation analysis and the earliest one could trace back to July 2018. The relevant accounts were still in use when the\nreport was completed.\n\nDecryption algorithm for configurations retrieved from Github will be described in detail and the portrait of the attacker is partially based on\nstatistics of the decrypted data.\n\n## Sample Analysis\n\nThe related attack vector is an XLSM file, created on August 8 and uploaded to VT on August 13, that leverages CVE-2017-11882 vulnerability\nto release MSBuild.exe to the %AppData% directory and then add registry Run key to stay persistent. To obtain C2 address, it reads data from\nGithub and Feed43 where the content could be controlled by attackers. HTTP/HTTPS protocols are used while communicating with available\nC2s.\n\n## Dropper Analysis\n\nThe sample was uploaded to VT at 5:05 on Aug 13, 2019 with below details:\n\nMD5 0D38ADC0B048BAB3BD91861D42CD39DF\n\nName India makes Kashmir Dangerous Place in the World.xlsm\n\nTime 2019-08-13 05:05:15\n\nAfter opening, a blurred picture shows up to lure the victim to enable macro. After that, a clear picture titled \"India has made Kashmir the most\ndangerous place in the world\" gets displayed.\n\nFigure 2.1 Images before and after enabling macro\nIn fact, the clear picture is covered with a vague one. When macro is enabled, the above picture will be deleted so that the clear one will be\ndisplayed:\n\n\n-----\n\nFigure 2.2 Content of the macro\nThere is an OLE object embedded inside, and it seems that the attacker packed the .bak file by mistake:\n\nFigure 2.3 The ole objects packed inside\nShellcode inside the OLE object performs below functions:\n\n1.Correct the MZ header located at offset 0x558 of the shellcode entry point (add “MZ”)\n\n2.Drop the PE file to \"%AppData%\\MSBuild.exe\".\n\n3.Add registry run key (key value: lollipop) to make \"%AppData%\\MSBuild.exe\" persistent.\n\nFigure 2.4 Shellcode to correct the header\n\n## MSBuild.exe Analysis\n\nMSBuild.exe is released to the %AppData% directory, and the compilation time is August 8th, 2019 which coincides with the XML creation time\non Github that will be described later on:\n\nName MSBuild.exe\n\nMD5 0f4f6913c3aa57b1fc5c807e0bc060fc\n\nCompile Time 2019-08-08 14:00:32\n\nThe main purpose of this sample is to obtain C2 configuration from the attacker's Github and feed43 space, and then performs decryption and\nconnects to C2 for further communications.\n\nAfter the malicious code is executed, it will “sleep” for a period of time. This is implemented by executing function in a loop for 80,000 times, to\nd l ti i th db\n\n\n-----\n\nFigure 3.1 Executing function in a big loop to achieve sleep purpose\nIt checks network connectivity by connecting to “https://en.wikipedia.org\", then retrieves C2 configuration from two hard coded addresses (one\nworks as a backup). The hard coded address is encrypted, each byte need to be subtracted by one to obtain the decrypted URL:\n\nFigure 3.2 Code to decrypt C2 configuration\n\nSource Decrypted Content\n\nfeed43 URL https://node2.feed43.com/0056234178515131.xml\n\nGithub URL https://raw.githubusercontent.com/petersonmike/test/master/xml.xml\n\nThe Github account used by the attacker is created on August 7th, 2019, which matches the compilation time of the sample:\n\n\n-----\n\nFigure 3.3 The attacker's Github home page\nThe C2 configuration is located inside the “description” field after encryption:\n\nFigure 3.4 Github configuration file content\nThe Base64 encoded data get decoded first, then performs ROL1((v11 + 16 * v9) ^ 0x23, 3) operation. After that, Base64 decode again and\nfinally uses Blowfish (older version without Blowfish decryption) by decryption key below:\n\nF0 E1 D2 C3 B4 A5 96 87 78 69 5A 4B 3C 2D 1E 0F 00 11 22 33 44 55 66 77\n\nThe decrypted C2 address is 139.28.38.236 and the malware uses HTTP/HTTPS in network communication:\n\n\n-----\n\ngu e 3 5 C dec ypt o a go t\nSystem information of the compromised computer will be collected and then exfiltrated, AES encryption and Base64 encoding will be\nperformed before sending out the collected data:\n\nURI Content\n\nuuid ID generated by GetCurrentHwProfile\n\nun System info\n\ncn Computer name\n\non OS version\n\nlan IP list\n\nnop Blank\n\nver Malware version, here it is 1.0\n\nAfter that the malware enters a while loop, to perform actions according to HTTP response:\n\nURI Function\n\n/e3e7e71a0b28b5e96cc492e636722f73/4sVKAOvu3D/ABDYot0NxyG.php Online, message queue\n\n/e3e7e71a0b28b5e96cc492e636722f73/4sVKAOvu3D/UYEfgEpXAOE.php Upload data\n\nFigure 3.6 Loop thread creation and message receiving\nThe following table is a comparison table of the received tokens and the functions to be performed:\n\nToken Function\n\n0 Exit\n\n8 Upload keylog file\n\n23 Upload screen capture file\n\n13 Upload collected list of files for a specific suffix\n\n5 Upload local file\n\n33 Extract EXE download link from URL, then download and execute.\n\nThe attacker uploads the files generated after executing remote commands to the C&C server. The following table is a comparison table of the\ncached files and the contents of the records:\n\n\n-----\n\nFile Name Content\n\n9PT568.dat UUID\n\nTPX498.dat Keylog file\n\nTPX499.dat Screen capture file\n\nAdbFle.tmp Retrieved files specified by attacker\n\nedg499.dat Files with specific suffixes:\n(\".txt\",\".doc\",\".xls\",\".xlsx\",\".docx\",\".xls\",\".ppt\",\".pptx\",\".pdf\")\n\nThe malware collects a list of files with specific suffixes, stores them in a local file, and uploads to the C2 server:\n\nFigure 3.7 List of specified file extensions\n\n## Data Analysis\n\nAfter performing correlation analysis, we discovered 44 configuration files hosted on Github and utilized by this APT group. All C2s have been\ndecrypted and extracted for investigation. From the time of file creation, the attacker started working at least as early as July 2018. The earliest\ncreated account was on July 3, 2018, and continued to August 2019 when the document was completed. In terms of the statistics of monthly\ncreations, the number of creations in July 2018 is much higher than the follow-up. We give the following reasonable speculations based on the\ndata distribution.\n\nThe attacker may conduct a concentrated attack from July to September in 2018.\nAccounts are created on demand when the sample gets updated or related Github link is blocked.\n\n\n-----\n\nFigure 4.1 Configuration file distribution\nSome extracted Github user names are listed as follows. We found that the names are generated based on some family names. So the attacks\nmay be completed by multiple attackers considering the different names being used. Many IDs can be found on social media, and most of\n**them are located in India and Pakistan:**\n\nmalikzafar786,Zunaidzunaid1,a1amir1,Alaeck,aleks0rg0v,alexboycott,alfreednobeli,chrisyoks,dawoood,ehsaankhan,fakheragainfkhr,fangflee,habrew,hazkabeeb,husngil\n\nKeywords such as “android” and “mobile” are used in the Github directory, perhaps it indicates there are samples for Android phones.\n\ntesty,test,amnigomestro,android,blch,cartoon,fashion,harrypotter,haz,helbrat,huric,husnahazrt,introduction,Joncorbat,kjhlkjhjkl,likingd,mdfs,metest,\n\nMost of the C2s are located in Ukraine, while there are 2 IPs in China:\n\nFigure 4.2 C2 distribution\nStatistics of XML creation time is provided in the below (the horizontal axis is the time of UTC+0, and the vertical axis is the number of\noccurrences).\n\n\n-----\n\nFigure 4.3 Attacker's 24-hour activity distribution\n\n## Conclusion\n\nThe link to feeds.rapidfeeds.com left in its XML configuration file was also mentioned by Kaspersky’s report in the reference section, which\nconfirms that the APT-C-09 group keeps updating its C2 configuration channel and the recent one reserves some past features.\n\nIn the perspective of cyber wars, the conflict between India and Pakistan over the territory of Kashmir has lasted for decades, which makes it a\nperfect topic in target attacks. For example, Donot and Bitter disguised as Kashmiri Voice to attack Pakistan, Transparent Tribe attacked India\nwith decoy document regarding terrorist attacks in Kashmir. These combats have proved that national power plays an important role in\ndefending the national sovereignty and in the mean while spying on the military intelligence.\n\nIndia’s attempt to abolish India-controlled Kashmir is to detonate the conflict between the two countries. The two sides exchanged fire and\nsome soldiers have died because of this. In terms of cyber attacks, related incidences will continue to rise up. Considering APT-C-09, Bitter\nand Donot have carried out targeted attacks against China, we must take actions in advance and keep a close eye on their recent activities.\n\nQiAnXin Threat Intelligence Center will provide customers with the latest attack trends in the first time, helping government and enterprises to\nresist network intrusions from foreign enemies.\n\n## IOCs\n\nC2:\n\n139.28.38.236\n\nAES Key:\n\nDD1876848203D9E10ABCEEC07282FF37\n\nBlowFish Key:\n\nF0E1D2C3B4A5968778695A4B3C2D1E0F0011223344556677\n\nHost Name:\n\nWIN-ABPA7FG820B\n\n## Appendix: Extracted C2 Information\n\nC2 Time Github username\n\n\n-----\n\nhttp://149.56.80.64/u5b62ed973d963913bb/u5a3ewfasdk9.php 2018-07-03T05:19:43 y4seenkhan\n\nhttp://149.56.80.64/u5b62ed973d963913bb/u5a3ewfasdk9.php 2018-07-03T05:29:54 hazkabeeb\n\nhttp://43.249.37.165/kungfu/ghsnls.php 2018-07-04T12:45:13 Zunaid-zunaid1\n\nhttp://123.57.158.115/shujing/ghsnls.php 2018-07-04T14:39:00 Zunaid-zunaid1\n\n185.82.217.200/@lb3rt/dqvabs.php 2018-07-04T20:46:50 Zunaid-zunaid1\n\n185.82.217.200/N3wt0n/dqvabs.php 2018-07-04T22:01:40 aleks0rg0v\n\nhttp://185.82.217.200/d3m0n/dqvabs.php 2018-07-05T10:43:25 Vldir\n\nhttp://81.17.30.28/th0mas/dqvabs.php 2018-07-05T20:30:57 Alaeck\n\nhttp://46.183.216.222/0racl3/dqvabs.php 2018-07-07T12:10:04 yamichaeldavid\n\nhttp://91.229.79.183/b15d0e30a7738037/j8fiandfuesmg.php 2018-07-10T16:26:55 habrew\n\nhttp://176.107.182.24/f0357a3f154bc2ff/sadk9f043ejf.php 2018-07-10T16:35:49 ehsaankhan\n\nhttp://146.185.234.71/Ms3f3g45thgy5/f3af3fasf32.php 2018-07-11T00:03:07 dawoood\n\nhttp://185.203.116.58/d394d142687ff5a0/dfae43rsfdgq4e.php 2018-07-11T01:24:49 fangflee\n\n185.156.173.73 2018-07-11T02:47:04 noorhasima\n\nhttp://188.165.124.30/c6afebaa8acd80e7/byuehf8af.php 2018-07-11T03:15:07 alfreednobeli\n\nhttp://146.185.234.71/Ms3f3g45thgy5/f3af3fasf32.php 2018-07-11T09:27:55 jahilzubaine\n\n94.156.35.204 2018-07-11T11:23:16 husngilgit\n\nhttp://94.156.35.204/22af645d1859cb5c/sg4gasdnjf984.php 2018-07-11T16:26:29 raqsebalooch\n\n185.203.118.115 2018-07-12T10:19:05 lctst\n\n185.29.11.59 2018-07-13T18:28:04 rehmanlaskkr\n\n?桔%�?旵`辚3 2018-07-13T19:33:56 noorfirdousi\n\n185.206.144.67 2018-07-14T12:04:38 rizvirehman\n\n185.36.188.14 2018-08-20T10:58:18 fakheragainfkhr\n\n199.168.138.119 2018-08-24T12:46:00 malikzafar786\n\n199.168.138.119 2018-08-24T12:55:02 malikzafar786\n\n199.168.138.119 2018-08-24T12:57:59 malikzafar786\n\n85.217.171.138 2018-09-01T09:47:20 malikzafar786\n\n85.217.171.138 2018-09-01T09:53:03 malikzafar786\n\nhttp://46.183.216.222/0racl3/dqvabs.php 2018-09-01T10:35:34 malikzafar786\n\n199.168.138.119 2018-09-18T10:34:23 malikzafar786\n\n199.168.138.119 2018-09-18T10:37:49 malikzafar786\n\n193.37.213.101 2018-11-05T11:53:40 a1amir1\n\n178.33.94.35 2018-12-05T12:11:46 malikzafar786\n\n178.33.94.35 2018-12-05T12:38:34 malikzafar786\n\n;3癬??^a;?筛 2018-12-17T06:50:14 yusufk1\n\n185.29.11.59 2019-01-15T08:03:17 str1ngstr\n\n164.132.75.22 2019-03-01T05:28:04 z00min\n\n193.22.98.17 2019-05-27T05:47:11 alexboycott\n\n91.92.136.239 2019-06-24T11:14:16 imrankhan713\n\n\n-----\n\n91.92.136.239 2019-06-24T12:05:21 imranikhan17\n\n185.116.210.8 2019-07-18T10:35:43 chrisyoks\n\n185.161.210.8 2019-07-18T12:10:48 johnhenery12\n\n139.28.38.231 2019-08-07T10:58:56 petersonmike\n\n139.28.38.236 2019-08-08T09:06:03 shaikmalik22\n\n## Reference\n\n1. https://securelist.com/the-dropping-elephant-actor/75328/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-26 - APT-C-09 Reappeared as Conflict Intensified Between India and Pakistan.pdf"
    ],
    "report_names": [
        "2019-08-26 - APT-C-09 Reappeared as Conflict Intensified Between India and Pakistan.pdf"
    ],
    "threat_actors": [
        {
            "id": "bf6cb670-bb69-473f-a220-97ac713fd081",
            "created_at": "2022-10-25T16:07:23.395205Z",
            "updated_at": "2025-03-27T02:02:09.777308Z",
            "deleted_at": null,
            "main_name": "Bitter",
            "aliases": [
                "T-APT-17",
                "TA397"
            ],
            "source_name": "ETDA:Bitter",
            "tools": [
                "Artra Downloader",
                "ArtraDownloader",
                "Bitter RAT",
                "BitterRAT",
                "Dracarys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "655f7d0b-7ea6-4950-b272-969ab7c27a4b",
            "created_at": "2022-10-27T08:27:13.133291Z",
            "updated_at": "2025-03-27T02:00:55.490812Z",
            "deleted_at": null,
            "main_name": "BITTER",
            "aliases": [
                "T-APT-17"
            ],
            "source_name": "MITRE:BITTER",
            "tools": [
                "ZxxZ"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b29dd16-a06f-4830-81a1-365443bc54b8",
            "created_at": "2023-01-06T13:46:38.460047Z",
            "updated_at": "2025-03-27T02:00:02.839173Z",
            "deleted_at": null,
            "main_name": "QUILTED TIGER",
            "aliases": [
                "ATK11",
                "G0040",
                "Orange Athos",
                "Chinastrats",
                "Sarit",
                "Dropping Elephant",
                "APT-C-09",
                "Thirsty Gemini",
                "ZINC EMERSON"
            ],
            "source_name": "MISPGALAXY:QUILTED TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536219,
    "ts_updated_at": 1743041763,
    "ts_creation_date": 1653775235,
    "ts_modification_date": 1653775235,
    "files": {
        "pdf": "https://archive.orkl.eu/1f822501b64b0cc1a8691486bca602fd5e1fa714.pdf",
        "text": "https://archive.orkl.eu/1f822501b64b0cc1a8691486bca602fd5e1fa714.txt",
        "img": "https://archive.orkl.eu/1f822501b64b0cc1a8691486bca602fd5e1fa714.jpg"
    }
}