{
    "id": "848376ae-e217-45fc-b788-d4e45d616c57",
    "created_at": "2023-03-03T02:06:23.838801Z",
    "updated_at": "2025-03-27T02:05:38.20102Z",
    "deleted_at": null,
    "sha1_hash": "4d1ccd3a113c25957065fb581b3a1927d3ec8e66",
    "title": "2022-02-17 - Ransomware Windows DarkBit",
    "authors": "",
    "file_creation_date": "2023-03-01T09:21:29Z",
    "file_modification_date": "2023-03-01T09:21:29Z",
    "file_size": 518575,
    "plain_text": "# malware-notes/README.md at master · albertzsigovits/malware-notes · GitHub\n\n**[github.com/albertzsigovits/malware-notes/blob/master/Ransomware-Windows-DarkBit/README.md](https://github.com/albertzsigovits/malware-notes/blob/master/Ransomware-Windows-DarkBit/README.md)**\n\nalbertzsigovits\n\n### master\n\n## Name already in use\n\n### A tag already exists with the provided branch name. Many Git commands accept both tag and branch names, so creating this branch may cause unexpected behavior. Are you sure you want to create this branch?\n\n## malware-notes/Ransomware-Windows-DarkBit/README.md\n\n### Cannot retrieve contributors at this time\n\n## DarkBit Ransomware\n\n\n-----\n\n## YARA rules:\n\n\n-----\n\n```\nrule ransomware_darkbit_ransomnote : windows ransomware darkbit {\n\n  meta:\n\n    author = \"albertzsigovits\"\n\n    reference =\n\"https://twitter.com/vxunderground/status/1624814604936249345\"\n\n    date = \"2023-02-13\"\n\n  strings:\n\n    $note1 = \"But, you can contact us via TOX messenger if you\nwant to recover your files personally.\" ascii wide\n\n    $note2 = \"All your files are encrypted using AES-256 military\ngrade algorithm.\" ascii wide\n\n    $note3 = \"They should pay for firing high-skilled experts.\"\nascii wide\n\n    $tor =\n\"iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad.onion\"\nascii wide\n\n  condition:\n\n    2 of ($note*) or $tor\n\n}\n\nrule ransomware_darkbit_windows_Strings : windows ransomware darkbit\n{\n\n  meta:\n\n    author = \"albertzsigovits\"\n\n    date = \"2023-02-16\"\n\n    filetype = \"pe\"\n\n    threat = \"Ransomware.DarkBit.Windows\"\n\n     sha256 =\n\"9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff\"\n\n  strings:\n\n    $goinf = \" Go buildinf:\"\n\n    $mingw = \"Mingw-w64 runtime failure:\"\n\n    $cgo = \"_cgo_dummy_export\"\n\n    $rstr1 = \"Rstrtmgr.dll\"\n\n    $rstr2 = \"RmStartSession\"\n    $rstr3 = \"RmRegisterResources\"\n\n    $rstr4 = \"RmGetList\"\n\n    $rstr5 = \"RmShutdown\"\n\n    $rstr6 = \"RmEndSession\"\n\n    $cfg1 = \"\\\"names\\\":\"\n\n    $cfg2 = \"\\\"limits\\\":\"\n\n    $cfg3 = \"\\\"extensions\\\":\"\n\n    $cfg4 = \"\\\"processes\\\":\"\n\n    $cfg5 = \"\\\"hostnames\\\":\"\n\n    $db1 = \"\\\"darkbit.jpg\\\":\"\n\n    $db2 = \"\\\"recovery_darkbit.txt\\\":\"\n\n    $db3 = \"\\\"Darkbit\\\":\"\n\n  condition:\n\n    uint16(0) == 0x5A4D\n\n```\n\n-----\n\n```\n    and uint32(uint32(0x3C))  0x00004550\n\n    and (\n\n        ( $goinf and $mingw and $cgo and 2 of ($rstr*) and 3\nof ($cfg*) )\n\n        or\n\n        ( 2 of ($cfg*) and 1 of ($db*) )\n\n    )\n\n}\n\nrule ransomware_darkbit_windows_asm : windows ransomware darkbit {\n\n  meta:\n\n    author = \"albertzsigovits\"\n\n    date = \"2023-02-16\"\n\n    filetype = \"pe\"\n\n    threat = \"Ransomware.DarkBit.Windows\"\n\n     sha256 =\n\"9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff\"\n\n  strings:\n\n    $gob1 = {\n\n          45 88 47 ??        // mov byte [r15 + 1],\nr8b\n\n          90            // nop\n\n          4C 8B 84 24 ?? ?? 00 00 // mov r8, qword [rsp +\n0x88]\n\n          49 C1 E8 ??        // shr r8, 4\n\n          49 83 C7 ??        // add r15, 2\n\n          48 8B 44 24 ??      // mov rax, qword [rsp\n+ 0x78]\n\n          4C 8B 8C 24 ?? ?? 00 00  // mov r9, qword [rsp\n+ 0xb0]\n\n          48 89 D0        // mov rax, rdx\n\n          48 8B 94 24 ?? ?? 00 00  // mov rdx, qword [rsp\n+ 0xc0]\n\n          4C 89 84 24 ?? ?? 00 00  // mov qword [rsp +\n0x88], r8\n\n          41 ?? ?? ??        // and r8d, 0xf\n\n          49\n\n    }\n\n    $gob2 = {\n\n          48 89 84 24 ?? ?? 00 00  // mov qword ptr ss:\n[rsp+D0],rax\n\n          48 89 5C 24 ??      // mov qword ptr ss:\n[rsp+60],rbx\n\n          31 C0          // xor eax,eax\n\n          48 8D 5C 24 ??      // lea rbx,qword ptr\nss:[rsp+44]\n\n          B9 ?? 00 00 00      // mov ecx,6\n\n    }\n\n    $wyhash = {\n\n          4D 8B 88 ?? ?? 00 00      // mov r9, qword\n\n```\n\n-----\n\n```\n[r8 + 0xf0]\n\n          49 BA 2F 64 BD 78 64 1D 76 A0  // movabs r10,\n0xa0761d6478bd642f\n\n          4D 01 D1            // add r9, r10\n\n          49 BB DB 28 B4 A0 D1 7E 03 E7  // movabs r11,\n0xe7037ed1a0b428db\n\n          4D 31 CB            // xor r11, r9\n\n    }\n\n    $vss1 = {\n\n          48 8B 94 24 ?? ?? 00 00    // mov rdx,qword\nptr ss:[rsp+C8] [rsp+C8]:\"delete\"\n\n          48 89 94 24 ?? ?? 00 00    // mov qword ptr\nss:[rsp+138],rdx [rsp+138]:\"delete\"\n\n          48 8B 54 24 ??        // mov rdx,qword\nptr ss:[rsp+58]\n\n          48 89 94 24 ?? ?? 00 00    // mov qword ptr\nss:[rsp+140],rdx\n\n          48 8B 94 24 ?? ?? 00 00    // mov rdx,qword\nptr ss:[rsp+F0] [rsp+F0]:\"shadows\"\n\n          48 89 94 24 ?? ?? 00 00    // mov qword ptr\nss:[rsp+148],rdx [rsp+148]:\"shadows\"\n\n          48 8B 94 24 ?? ?? 00 00    // mov rdx,qword\nptr ss:[rsp+80]\n\n          48 89 94 24 ?? ?? 00 00    // mov qword ptr\nss:[rsp+150],rdx\n\n          48 8B 94 24 ?? ?? 00 00    // mov rdx,qword\nptr ss:[rsp+C0] [rsp+C0]:\"/all\"\n\n          48 89 94 24 ?? ?? 00 00    // mov qword ptr\nss:[rsp+158],rdx [rsp+158]:\"/all\"\n\n          48 8B 54 24 ??        // mov rdx,qword\nptr ss:[rsp+50]\n\n          48 89 94 24 ?? ?? 00 00    // mov qword ptr\nss:[rsp+160],rdx\n\n          48 89 84 24 ?? ?? 00 00    // mov qword ptr\nss:[rsp+168],rax [rsp+168]:\"/Quiet\"\n\n          48 89 9C 24 ?? ?? 00 00    // mov qword ptr\nss:[rsp+170],rbx\n\n          48 8B 84 24 ?? ?? 00 00    // mov rax,qword\nptr ss:[rsp+D0] [rsp+D0]:\"vssadmin.exe\"\n\n          48 8B 5C 24 ??        // mov rbx,qword\nptr ss:[rsp+60]\n\n          48 8D 8C 24 ?? ?? 00 00    // lea rcx,qword\nptr ss:[rsp+138] [rsp+138]:\"delete\"\n\n    }\n\n    $vss2 = {\n\n          48 BA CB BB 16 11 B4 B1 42   // mov\nrdx,AD42B1B41116BBCB\n\n          48 89 94 24 ?? ?? 00 00     // mov qword ptr\nss:[rsp+B1],rdx\n\n          48 BA 6D A1 5B 11 15 7B 7B  // mov\n\n```\n\n-----\n\n```\nrdx,7B7B15115BA16DAD\n\n          48 89 94 24 ?? ?? 00 00      // mov qword\nptr ss:[rsp+B8],rdx\n\n          48 BA 9D C8 65 70 D0 DC 2B C3  // mov\nrdx,C32BDCD07065C89D\n\n          48 89 94 24 ?? ?? 00 00      // mov qword\nptr ss:[rsp+A2],rdx\n\n          48 BA C3 4D C5 3E 7D 70 0F 1E  // mov\nrdx,1E0F707D3EC54DC3\n\n          48 89 94 24 ?? ?? 00 00      // mov qword\nptr ss:[rsp+A9],rdx\n\n    }\n\n  condition:\n\n    uint16(0) == 0x5A4D\n\n    and uint32(uint32(0x3C)) == 0x00004550\n\n    and 3 of them\n\n}\n\n## DarkBit diary:\nSHA256:\n9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff\n\nPacker: None\n\nCompile time: 2023-02-11 22:10:54\n\nPEInfo: PE32+ executable (console) x86-64 (stripped to external PDB),\nfor MS Windows\n\nLanguage: Golang (CGO)\n\nObfuscation: Gobfuscate\n\nHashing: Wyhash hash algorithm and wyrand PRNG\n\nRansomware Mutex: Global\\dbdbdbdb\n\nRansomware Note: RECOVERY_DARKBIT.txt\n\nSHA256:\nfca050431ba94630d691a7d6cbdd491354c69f738b0d8e03b531173a741ad286\n\nTOR:\nhxxp://iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad[.]oni\non/support\n\nTOX ID:\nAB33BC51AFAC64D98226826E70B483593C81CB22E6A3B504F7A75348C38C862F00042\nF5245AC\n\nTelegram: DarkBitChannel\n\nTwitter: DarkBitTW\n\n DarkBit parameters:\n\n```\n\n-----\n\n```\n h | Help\n\n-all | Run on all without timeout counter\n\n-domain | Domain\n\n-force | Force blacklisted computers\n\n-list | List\n\n-nomutex | Force not checking mutex\n\n-noransom | No encryption\n\n-password | Password\n\n-path | Path\n\n-t | Threads\n\n-username | Username\n\n## VirusTotal perks:\nvhash:0560b76d5555151c051d1az3f1d&z1 \n\nauthentihash:8a1db8d4c117daa25ab31735b9866cb989907cf524fe2c052ffa9e67\nf582c79c \n\nimphash:9bcadd8ed34a63728178995d1b006421 \n\nssdeep:\"49152:S4mkYp+03HbhndpeoVK9/0cjXd77yg6PxHuy7vDKD12K5EKGHg1q14g\nUynCLgIMk:UF31ed/XB7AbvbAEKGpTI7\" \n\nbehaviour_files:\"%HOMEPATH%\\\\recovery_darkbit.txt\" \n\nbehaviour_files:\"%HOMEPATH%\\\\appdata\\\\recovery_darkbit.txt\" \n\nbehaviour:\"Global\\\\dbdbdbdb\" \n\nbehaviour:\"\\\\Sessions\\\\1\\\\BaseNamedObjects\\\\Global\\\\dbdbdbdb\" \n\n Config template:\n\n```\n\n-----\n\n```\n  limits : [\n\n      \"limitMB\": 25,\n\n      \"parts\": 1,\n\n      \"eachPart\": -1\n\n    },\n\n    {\n\n      \"limitMB\": 1000,\n\n      \"parts\": 2,\n\n      \"eachPart\": 12000\n\n    },\n\n    {\n\n      \"limitMB\": 4000,\n\n      \"parts\": 3,\n\n      \"eachPart\": 10000\n\n    },\n\n    {\n\n      \"limitMB\": 7000,\n\n      \"parts\": 2,\n\n      \"eachPart\": 20000\n\n    },\n\n    {\n\n      \"limitMB\": 11000,\n\n      \"parts\": 3,\n\n      \"eachPart\": 30000\n\n    },\n\n    {\n\n      \"limitMB\": 51000,\n\n      \"parts\": 5,\n\n      \"eachPart\": 30000\n\n    },\n\n    {\n\n      \"limitMB\": 1000000,\n\n      \"parts\": 3,\n\n      \"eachPart\": 1000000\n\n    },\n\n    {\n\n      \"limitMB\": 5000000,\n\n      \"parts\": 5,\n\n      \"eachPart\": 1000000\n\n    },\n\n    {\n\n      \"limitMB\": 6000000,\n\n      \"parts\": 20,\n\n      \"eachPart\": 10000000\n\n    }\n\n  ],\n\n  \"extensions\": {\n\n    \"msilog\": 1,\n\n    \"log\": 1,\n\n    \"ldf\": 1,\n\n    \"lock\": 1,\n\n    \"theme\": 1,\n\n```\n\n-----\n\n```\n    msi : 1,\n\n    \"sys\": 1,\n\n    \"wpx\": 1,\n\n    \"cpl\": 1,\n\n    \"adv\": 1,\n\n    \"msc\": 1,\n\n    \"scr\": 1,\n\n    \"key\": 1,\n\n    \"ico\": 1,\n\n    \"dll\": 1,\n\n    \"hta\": 1,\n\n    \"deskthemepack\": 1,\n\n    \"nomedia\": 1,\n\n    \"msu\": 1,\n\n    \"rtp\": 1,\n\n    \"msp\": 1,\n\n    \"idx\": 1,\n\n    \"ani\": 1,\n\n    \"386\": 1,\n\n    \"diagcfg\": 1,\n\n    \"bin\": 1,\n\n    \"mod\": 1,\n\n    \"ics\": 1,\n\n    \"com\": 1,\n\n    \"hlp\": 1,\n\n    \"spl\": 1,\n\n    \"nls\": 1,\n\n    \"cab\": 1,\n\n    \"diagpkg\": 1,\n\n    \"icl\": 1,\n\n    \"ocx\": 1,\n\n    \"rom\": 1,\n\n    \"prf\": 1,\n\n    \"themepack\": 1,\n\n    \"msstyles\": 1,\n\n    \"icns\": 1,\n\n    \"mpa\": 1,\n\n    \"drv\": 1,\n\n    \"cur\": 1,\n\n    \"diagcab\": 1,\n\n    \"exe\": 1,\n\n    \"cmd\": 1,\n\n    \"shs\": 1,\n\n    \"Darkbit\": 1\n\n  },\n\n  \"names\": {\n\n    \"thumbs.db\": 1,\n\n    \"desktop.ini\": 1,\n\n    \"darkbit.jpg\": 1,\n\n    \"recovery_darkbit.txt\": 1,\n\n    \"system volume information\": 1\n\n  },\n\n```\n\n-----\n\n```\n  processes : [],\n\n    \"hostnames\": [\n\n          --- LIST OF TARGET HOSTNAMES --\n          ]\n\n## Ransom note:\n\n```\n\n-----\n\n```\nDear Colleagues,\n\nWe’re sorry to inform you that we’ve had to hack Technion network\ncompletely and transfer “all” data to our secure servers.\n\nSo, keep calm, take a breath and think about an apartheid regime that\ncauses troubles here and there.\n\nThey should pay for their lies and crimes, their names and shames.\nThey should pay for occupation, war crimes against humanity,\n\nkilling the people (not only Palestinians’ bodies, but also Israelis’\nsouls) and destroying the future and all dreams we had.\n\nThey should pay for firing high-skilled experts.\n\nAnyway, there is nothing for you (as an individual) to be worried.\n\nThat’s the task of the administration to follow up our instruction\nfor recovering the network.\n\nBut, you can contact us via TOX messenger if you want to recover your\nfiles personally. (TOX ID:\nAB33BC51AFAC64D98226826E70B483593C81CB22E6A3B504F7A75348C38C862F00042\nF5245AC)\n\nOur instruction for the administration:\n\nAll your files are encrypted using AES-256 military grade algorithm.\nSo,\n\n     1. Don't try to recover data, because the encrypted files are\nunrecoverable unless you have the key.\n\n     Any try for recovering data without the key (using thirdparty applications/companies) causes PERMANENT damage. Take it\nserious.\n\n     2. You have to trust us. This is our business (after firing\nfrom high-tech companies) and the reputation is all we have.\n\n     3. All you need to do is following up the payment procedure\nand then you will receive decrypting key using for returning all of\nyour files and VMs.\n\n     4. Payment method:\n\n          Enter the link below\n\nhttp://iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad.onion\n/support\n\n          Enter the ID below and pay the bill (80 BTC)\n\n              $TARGETID\n\nYou will receive decrypting key after the payment.\n\nNotice that you just have 48 hours. After the deadline, a 30% penalty\nwill be added to the price.\n\nWe put data for sale after 5 days.\n\nTake it serious and don’t listen to probable advices of a stupid\ngovernment.\n\nGood Luck!\n\n“DarkBit”\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-17 - Ransomware Windows DarkBit.pdf"
    ],
    "report_names": [
        "2022-02-17 - Ransomware Windows DarkBit.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1677809183,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1677662489,
    "ts_modification_date": 1677662489,
    "files": {
        "pdf": "https://archive.orkl.eu/4d1ccd3a113c25957065fb581b3a1927d3ec8e66.pdf",
        "text": "https://archive.orkl.eu/4d1ccd3a113c25957065fb581b3a1927d3ec8e66.txt",
        "img": "https://archive.orkl.eu/4d1ccd3a113c25957065fb581b3a1927d3ec8e66.jpg"
    }
}