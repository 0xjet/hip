{
    "id": "7179b691-03c6-49b7-8c6e-6545c3a49b97",
    "created_at": "2023-01-12T15:02:13.013419Z",
    "updated_at": "2025-03-27T02:05:51.749833Z",
    "deleted_at": null,
    "sha1_hash": "093bf0ba703c5b8bae0afeac06045ba5dd881170",
    "title": "2021-10-28 - A Detailed Walkthrough of Ranzy Locker Ransomware TTPs",
    "authors": "",
    "file_creation_date": "2022-05-29T10:38:53Z",
    "file_modification_date": "2022-05-29T10:38:53Z",
    "file_size": 1841844,
    "plain_text": "# A Detailed Walkthrough of Ranzy Locker Ransomware TTPs\n\n**[picussecurity.com/resource/blog/a-detailed-walkthrough-of-ranzy-locker-ransomware-ttps](https://www.picussecurity.com/resource/blog/a-detailed-walkthrough-of-ranzy-locker-ransomware-ttps)**\n\n### Keep up to date with latest blog posts\n\nAs we all observed, the number of ransomware attacks increased dramatically in 2021.\nSince late 2020, the Ranzy Locker ransomware has been responsible for dozens of highprofile breaches. Essentially, Ranzy is a rebranded and improved version of the ThunderX\nransomware. Since a free decryption tool of ThunderX is released, Ranzy Locker has been\nreleased by the threat actors. Note that the Tor onion URL used by Ranzy was the same as\nthe one previously used by the Ako ransomware. So, it is also a successor of Ako.\n\nRanzy threat actors also have established a Ransomware as a Service (RAAS) model and\nutilize the double extortion tactic. In other words, they exfiltrate critical data before encrypting\nfiles and threaten the victim with the release of the exfiltrated data to encourage ransom\npayment.\n\nAccording to [the flash report of the FBI, the Ranzy Locker ransomware gang had](https://www.ic3.gov/Media/News/2021/211026.pdf)\ncompromised over 30 businesses in the U.S. alone as of July 2021. Victims of ransomware\nare in various sectors, such as manufacturing, government, transformation, and IT.\n\n\n-----\n\nWe provide the tactics, techniques, and procedures (TTPs) used by the Ranzy Locker threat\nactors in this blog post because detecting and blocking a threat's TTPs is the most effective\nmethod of preventing that threat. TTPs enable us to identify potential intrusions and analyze\nthe behavior of threat actors.\n\n## Tactics, Techniques, and Procedures (TTPs) used by Ranzy Locker Ransomware\n\nThis section presents the malicious behaviors of the Ranzy Locker ransomware group. Our\nanalysis uses the MITRE Adversarial Tactics, Techniques, and Common Knowledge\n(ATT&CKÂ®) version 10 framework. See [the ATT&CK Matrix for Enterprise v10 for all](https://attack.mitre.org/versions/v10/)\nreferenced tactics and techniques.\n\n### 1. Initial Access\n\nThe Initial Access tactic includes techniques used by attackers to gain an initial foothold\nwithin a network, such as exploiting vulnerabilities on public-facing web servers.\n\n**1.1. ATT&CK T1190 Exploit Public-Facing Application**\n\nRanzy Locker operators leverage known Microsoft Exchange Server vulnerabilities to\ncompromise target systems.\n\n1.2. ATT&CK T1566 Phishing\n\nThe Ranzy Locker ransomware is also distributed via phishing campaigns.\n\n1.3. ATT&CK T1078 Valid Accounts\n\nThe ransomware gang leverages valid accounts with Remote Desktop Protocol (RDP) to\naccess target systems.\n\n### 2. Execution\n\nThis tactic includes techniques that result in adversary-controlled code running on a local or\nremote system. The execution technique cannot be detached from other techniques; it is\noften paired with techniques from all other tactics.\n\n2.1. MITRE ATT&CK T1106 Native API\n\nAdversaries can execute behaviors directly through the native OS application programming\ninterface (API). The Ranzy Locker ransomware leverages Windows API for a variety of\noperations, such as enumerating shared resources, as explained below.\n\n### 3. Defense Evasion\n\n\n-----\n\nDefense evasion techniques are used by adversaries to avoid detection by security controls.\n\n### 3.1. ATT&CK T1027 Obfuscated Files or Information\n\nThe Ranzy Locker ransomware uses Base64 encoding to obfuscate its configuration in the\nransom note.\n\n**3.2. ATT&CK T1497 Virtualization/Sandbox Evasion**\n\nAdversaries may use a variety of techniques to detect and avoid virtualization and analysis\nenvironments. This may include altering behavior in response to the detection of artifacts\nindicative of a virtual machine (VM) environment or sandbox. If the adversary detects a VM\nenvironment, they may modify their malware in order to disengage from the victim or conceal\nthe implant's core functions. The Ranzy locker ransomware group uses IsDebuggerPresent\nAPI call to detect debuggers by checking if a program is running in debugging mode.\n\n### 4. Credential Access\n\n4.1. ATT&CK T1110 Brute Force\n\nThe ransomware gang acquires valid accounts through brute force.\n\n### 5. Discovery\n\nAdversaries use the techniques in the Discovery tactic to obtain information about the target\nenvironment, such as services, processes, network, files, software, system, accounts,\ndomain, and registry.\n\n**5.1. ATT&CK T1083 File and Directory Discovery**\n\nThe Ranzy Locker ransomware discovers critical files to exfiltrate, such as customer data,\npersonally identifiable information (PII) files, and financial records. It uses GetLogicalDrives\n[API call to enumerate all mounted drives, as also used by the Ryuk ransomware.](https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/)\n\n### 5.2. ATT&CK T1135 Network Share Discovery\n\nRanzi utilizes NetShareEnum API call for discovering shared resources, such as SMB\nnetwork shares, to encrypt files stored in these resources. This API call is also used by the\n[Conti ransomware. It also sends ARP broadcast requests for network device lookup.](https://blogs.vmware.com/security/2020/07/tau-threat-discovery-conti-ransomware.html)\n\n5.3. ATT&CK T1057 Process Discovery\n\nAdversaries get information about running processes to understand software and\napplications running on the system and shape follow-on behaviors. Ranzy uses Windows\nNative API calls to enumerate running processes.\n\n5.4. ATT&CK T1120 Peripheral Device Discovery\n\n\n-----\n\nThe Ranzy Locker ransomware scans all drive letters to infect USB drives.\n\n5.5. ATT&CK T1018 Remote System Discovery\n\nRanzy reads the host file (C:\\Windows\\System32\\drivers\\etc\\hosts) to discover the hostname\nto IP address mappings of remote systems.\n\n5.6. T1082 System Information Discovery\n\nThe ransomware queries the volume information to determine the disks in the system.\n\n### 6. Impact\n\nThe Impact tactic covers techniques that manipulate, interrupt, or destroy your systems to\ndisrupt availability, compromise integrity, or cover a confidentiality breach.\n\n6.1. ATT&CK T1490 Inhibit System Recovery\n\nRanzy Locker ransomware attacks utilize multiple procedures to inhibit system recovery:\n\nFirst, it disables shadowcopy notifications using wmic.exe, a command-line utility to\naccess Windows Management Instrumentation (WMI)\n\nWMIC.exe SHADOWCOPY /nointeractive\n\nWbadmin is a built-in Windows tool that allows you to backup and restore your\noperating system, volumes, files, folders, and programs. Ranzy Locker uses wbadmin\nto delete system state backups with the following command:\n\nwbadmin DELETE SYSTEMSTATEBACKUP\n\nIt also uses a more specific version of this command to delete the oldest system state\nbackup:\n\nwbadmin DELETE SYSTEMSTATEBACKUP - deleteOldest\n\nBCDEdit is a command-line tool for managing Boot Configuration Data (BCD) stores\nthat are used to describe boot applications and boot application settings. Ranzy Locker\nuses bcdedit.exe twice to disable automatic Windows recovery features by modifying\nboot configuration data with the following commands, which are also used by REvil\n(Sodinokibi) and [Nefilim ransomware families.](https://www.picussecurity.com/resource/blog/how-to-beat-nefilim-ransomware-attacks?hsLang=en-gb)\n\nbcdedit /set {default} recoveryenabled No\n\nbcdedit /set {default} bootstatuspolicy ignoreallfailures\n\n\n-----\n\nvssadmin (Volume Shadow Copy Service Admin) is another native Windows tool that\ncan display current volume shadow copy backups and all installed shadow copy writers\nand providers. The Ranzy Locker ransomware abuses vssadmin.exe with the following\ncommand to delete all volume shadow copies on the system to prevent recovery, as\n[also used by REvil (Sodinokibi).](https://www.picussecurity.com/resource/blog/a-brief-history-and-further-technical-analysis-of-sodinokibi-ransomware?hsLang=en-gb)\n\nvssadmin.exe Delete Shadows /All /Quiet\n\nREAD our blog post titled \"An Underrated Technique to Delete Volume Shadow Copies DeviceIoControl\" to learn more about four methods used by ransomware threat groups to\nprevent the recovery of encrypted files from volume shadow copies.\n\n**6.2. ATT&CK T1486 Data Encrypted for Impact**\n\nThreat actors may encrypt data on target systems or on a large number of systems\nconnected to a network to disrupt the system and network resource availability. They can\nmake stored data unusable by encrypting files or data on local and remote drives, which is a\ncommon behavior of ransomware.\n\nRanzy uses the following encryption schemes.\n\nSalsa20 to encrypt files.\nRSA to encrypt Salsa20 keys.\n\nSalsa20 is a faster encryption algorithm than RSA. So, they encrypt files with Salsa20, but\nencrypt the Salsa20 keys with a more secure but slower RSA 2048 bits encryption. This\n[combination is also used by the recent BlackMatter ransomware.](https://www.picussecurity.com/resource/blog/blackmatter-ransomware-analysis-ttps-and-iocs?hsLang=en-gb)\n\nUnfortunately, there is not a public Ranzy Locker ransomware decryption tool as of today.\n\nRanzy Locker creates a readme.txt file that includes the following instruction. It explains that\nthe files were encrypted and stolen. So, Ranzy is double extortion ransomware like\n[DarkSide.](https://www.picussecurity.com/resource/whitepaper/illuminating-darkside-ransomware?hsLang=en-gb)\n\n\n-----\n\nThe Tor onion URL in the ransom note includes a live chat to learn detailed instructions for\nbuying the decryption key.\n\n\n-----\n\n## How Picus Helps Simulate and Prevent the Ranzy Locker Ransomware\n\nWe strongly suggest simulating the Ranzy Locker ransomware to test the effectiveness of\nyour security controls using the Picus Security Control Validation Platform. Picus Threat\nLibrary includes the following threats for the Ranzy Locker ransomware.\n\n**Picus ID** **Threat Name**\n\n252070 Ranzy Locker Ransomware .EXE File Download Variant-1\n\n845084 Ranzy Locker Ransomware .EXE File Download Variant-2\n\n\n-----\n\n772539 Ranzy Locker Ransomware .EXE File Download Variant-3\n\n700399 Ranzy Locker Ransomware .EXE File Download Variant-4\n\n445953 Ranzy Locker Ransomware .EXE File Download Variant-5\n\n## Ranzy Locker Ransomware IOCs (Indicators of Compromise)\n\n### SHA256 Hashes\n\nade5d0fe2679fb8af652e14c40e099e0c1aaea950c25165cebb1550e33579a79\n\nbbf122cce1176b041648c4e772b230ec49ed11396270f54ad2c5956113caf7b7\n\nc4f72b292750e9332b1f1b9761d5aefc07301bc15edf31adeaf2e608000ec1c9\n\n393fd0768b24cd76ca653af3eba9bff93c6740a2669b30cf59f8a064c46437a2\n\n90691a36d1556ba7a77d0216f730d6cd9a9063e71626489094313c0afe85a939\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-28 - A Detailed Walkthrough of Ranzy Locker Ransomware TTPs.pdf"
    ],
    "report_names": [
        "2021-10-28 - A Detailed Walkthrough of Ranzy Locker Ransomware TTPs.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535733,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1653820733,
    "ts_modification_date": 1653820733,
    "files": {
        "pdf": "https://archive.orkl.eu/093bf0ba703c5b8bae0afeac06045ba5dd881170.pdf",
        "text": "https://archive.orkl.eu/093bf0ba703c5b8bae0afeac06045ba5dd881170.txt",
        "img": "https://archive.orkl.eu/093bf0ba703c5b8bae0afeac06045ba5dd881170.jpg"
    }
}