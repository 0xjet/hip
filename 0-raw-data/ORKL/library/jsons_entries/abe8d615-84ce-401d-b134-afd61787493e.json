{
    "id": "abe8d615-84ce-401d-b134-afd61787493e",
    "created_at": "2023-01-12T15:06:10.984195Z",
    "updated_at": "2025-03-27T02:05:54.269616Z",
    "deleted_at": null,
    "sha1_hash": "ce4a3bff8f25216d714156cb497cc93eee45c19a",
    "title": "2018-07-06 - HNS Botnet Recent Activities",
    "authors": "",
    "file_creation_date": "2022-05-28T18:28:00Z",
    "file_modification_date": "2022-05-28T18:28:00Z",
    "file_size": 377488,
    "plain_text": "# HNS Botnet Recent Activities\n\n**blog.netlab.360.com/hns-botnet-recent-activities-en/**\n\nRootKiter July 6, 2018\n\n6 July 2018 / [HNS](https://blog.netlab.360.com/tag/hns/)\nAuthor: Rootkiter, yegenshen\n\nHNS is an IoT botnet (Hide and Seek) originally discovered by BitDefender in January this\nyear. In that [report, the researchers pointed out that HNS used CVE-2016-10401, and other](https://labs.bitdefender.com/2018/01/new-hide-n-seek-iot-botnet-using-custom-built-peer-to-peer-communication-spotted-in-the-wild/)\nvulnerabilities to propagate malicious code and stole user information. The HNS\ncommunicates through the P2P mechanism, which is the second IoT botnet that we know\nuses P2P communication after Hajime.\n\nP2P-like botnets are hard to take down, and the HNS botnet has been continuously updated\nover the past few months, some major updates we see:\n\nAdded exploits for AVTECH devices (webcam, webcam), CISCO Linksys router,\nJAWS/1.0 web server, Apache CouchDB, OrientDB; with the two devices mentioned in\nthe original report, HNS currently supports 7 exploiting methods all together\nHard-coded P2P node addresses have been increased to 171;\nIn addition, we observed that the HNS botnet adds a cpuminer mining program, it is not\nfunctioning properly yet.\nIn particular, with the added support of OrientDB and CouchDB database servers, HNS\nis no longer just an IoT botnet, but a cross-platform botnet now.\n\n**Malware Samples**\n\nWe analyzed following samples:\n```\nc1816d141321276cd4621abcd280ee40  #hns x86\n0770ff1a6e90eb5d083c16452e45abd5  #hns arm\n30ebaaeb61a4ecae3ade7d1d4e5c7adb  #hns_miner\n\n```\n**Network Scanning and Exploits**\n\nHNS botnet looks for potential victims by initiating a network scanning. In this scanning, HNS\nborrows code from mirai botnet, and shares the same characters.\n\nThe scanning target ports include fixed TCP port 80/8080/2480/5984/23 and other random\nports.\n\n\n-----\n\nThese ports and their corresponding well known services are:\n```\n23  Telnet\n80  HTTP Web Service\n2480 OrientDB\n5984 CouchDB\n8080 HTTP Web Service\nRandom-Port  NA\n\n```\nHNS will try to implant itself on these ports, utilizing the following exploits. In these exploits, 1\nand 2 are listed in bitdefender original report. The other 5 are newly integrated.\n\n[1. TPLink-Routers RCE](https://sekurak.pl/tp-link-httptftp-backdoor/)\n[2. Netgear RCE](https://www.exploit-db.com/exploits/43055/)\n3. new: [AVTECH RCE](https://www.exploit-db.com/exploits/40500/)\n4. new: [CISCO Linksys Router RCE](https://vuldb.com/?id.12362)\n5. new: [JAW/1.0 RCE](https://www.pentestpartners.com/security-blog/pwning-cctv-cameras/)\n6. new: [OrientDB RCE](https://www.exploit-db.com/exploits/42965/)\n7. new: [CouchDB RCE](https://www.exploit-db.com/exploits/44913/)\n\n**171 Hard-coded P2P peer**\n\nHNS node contacts to other P2P peers with the following 3 methods, in which, 2 and 3 are\nlisted in bitdefender original report.\n\n1. From a hard-coded built-in list of 171 peer addresses\n2. From the command-line args\n3. From the other P2P peers\n\nThese 171 peers will interact during the check-in and following interaction process\n\nThe Check-in Process\n\n\n-----\n\nWhen started with no command-line args, HNS node will send lots of UPD check-in packets.\nIP addresses of these packets are randomized, while some others are set based on the\nbuild-in list. Part of the list is shown as follows, with a full list can be seen in the IoC section.\n\nThe Interaction Process\n\nHNS has the following characteristics when doing P2P interaction between its nodes:\n\nThe check-in packet is a UDP packet with random length and content. So no significant\nfeature here. The stands out is in the second packet from the upstream nodes, which\nhas a length of 2 and the first byte is the uppercase letter ‘O’. In addition, the second\nbyte of the return packet is actually a checksum value calculated from the request\npacket, so as can also be used to ID HNS communications. The detailed verification\nalgorithm is shown as below.\nAfter joining into the P2P network, HNS needs to perform address synchronization\nconstantly to ensure nodes connections. This synchronous operation has strong\nnetwork characteristics. First, the downstream node sends a request packet with the\nlength 1 with content \"~\" to the upstream node, and then the upstream node replies\nwith a packet of length 8 with the initial letter \"^\".\nHNS nodes interact frequently and have lots of data exchange. The request packet\nlength is 69 with initial letter \"y\", and the reply packet has a length of 261 with initial\nletter uppercase \"Y\".\n\nThe algorithm for service repond packets, based on python 2.7\n\nWhen sending the following request packet:\n```\ndata_pointer = \"5b 02 d7 ff 52 02 61 e9 a5 7e 0b 07 c5 43\n5b\".replace(\"\",\"\").decode('hex')\n\n```\nThe expected response packet from the upstream node would be:\n```\nack=\"4f b6\".replace(\" \",\"\").decode('hex')\n\n```\nWhere chr(0x4f) is fixed and chr(0xb6) is calculated as follows:\n\n\n-----\n\n```\ndef calc_crc(data_pointer):\n  data_len_1 = len(data_pointer)-1\n  tmp = 88\n  for i in range(0,data_len_1):\n    tmp += ord(data_pointer[i])\n    tmp = tmp &0xff\n  tmp2 = tmp^0x3d\n  print hex(tmp2),hex(ord(data_pointer[data_len_1]))\n  if(tmp2 == ord(data_pointer[data_len_1])):\n    return (2*tmp2&0xfe)\n  return -1;\n\n```\n**Contact Us**\n\n[If readers have new discoveries, feel free to contact us on twitter.](https://twitter.com/360netlab)\n\n**IoC**\n\nMalware Sample md5\n```\nc1816d141321276cd4621abcd280ee40  #hns x86\n0770ff1a6e90eb5d083c16452e45abd5  #hns arm\n30ebaaeb61a4ecae3ade7d1d4e5c7adb  #hns_miner\n\n```\n[All 171 hard coded P2P peer address list is here.](https://blog.netlab.360.com/file/hns_hardcoded_peer_list.txt)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-06 - HNS Botnet Recent Activities.pdf"
    ],
    "report_names": [
        "2018-07-06 - HNS Botnet Recent Activities.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535970,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1653762480,
    "ts_modification_date": 1653762480,
    "files": {
        "pdf": "https://archive.orkl.eu/ce4a3bff8f25216d714156cb497cc93eee45c19a.pdf",
        "text": "https://archive.orkl.eu/ce4a3bff8f25216d714156cb497cc93eee45c19a.txt",
        "img": "https://archive.orkl.eu/ce4a3bff8f25216d714156cb497cc93eee45c19a.jpg"
    }
}