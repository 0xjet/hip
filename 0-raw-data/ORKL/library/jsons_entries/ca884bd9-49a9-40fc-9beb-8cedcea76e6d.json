{
    "id": "ca884bd9-49a9-40fc-9beb-8cedcea76e6d",
    "created_at": "2023-01-12T15:07:39.017022Z",
    "updated_at": "2025-03-27T02:16:03.283844Z",
    "deleted_at": null,
    "sha1_hash": "b40f19ed548713b03baf3ea8594d800d3613a40c",
    "title": "2022-01-24 - New TransparenTribe Operation- Targeting India with weaponized COVID-19 lure documents",
    "authors": "",
    "file_creation_date": "2022-05-28T01:19:47Z",
    "file_modification_date": "2022-05-28T01:19:47Z",
    "file_size": 2102413,
    "plain_text": "# New TransparenTribe Operation: Targeting India with weaponized COVID-19 lure documents\n\n**[lab52.io/blog/new-transparentribe-operation-targeting-india-with-weaponized-covid-19-lure-documents/](https://lab52.io/blog/new-transparentribe-operation-targeting-india-with-weaponized-covid-19-lure-documents/)**\n\nOver the last months, lab52 has been researching an attack campaign which targets\ngovernment and military personnel of India. In fact, targeting the Indian government seems\nto be one of the key indicators of the group that may be behind this attack. Furthermore,\nsome of the artifacts and infrastructure used to carry out the novel infection campaign are\nstrongly related to the threat group Transparent Tribe.\n\nInitially, Lab52 detected a suspicious IMG file (Covid_Letter.img –\n948dffef9a11c11a6d81905e59ca1882) that was uploaded in VirusTotal via the web site from\nIndia, with upload date 09-06-2021. This file may have been sent attached to an email and\ncontains a PDF document and some artifacts in order to display a decoy PDF to the user and\ninitiate the infection process in the background.\n\nThe PDF is named Vaccination06042021.pdf and its contents are related to COVID\nvaccination for employees over 45 years of age at the Central Administration of the\nGovernment of India.\n\n\n-----\n\nAlthough this decoy PDF document is harmless, the IMG file contains some other artifacts\nthat will carry out the infection. Firstly, the IMG file contains a shortcut with the same name\nas the PDF document, which will be in charge of starting the infection by launching a Visual\nBasic script called doc.vbs. The infection chain continues executing both the decoy PDF\n\n\n-----\n\ndocument and a Windows PE (ServiceHub.MsDetouredHost.exe –\n68d73d596a7103e517967f7f4e22cecb) which after being analyzed, we have been able to\nidentify it as a Python/PeppyRAT.\n\nThe main feature of this Windows executable is the ability to run embedded Python\ncommands from itself. For this, the threat firstly relaunches itself and then starts building a\nnew IAT (Import Address Table) referencing a large number of Python functions contained in\nthe Python27.dll library that will be executed later.\n\n\n-----\n\nThe crux of the matter is that by dropping all python compiled objects and dynamic-link\nlibraries required into %TEMP% directory, it makes this python command execution\ntechnique possible through a Windows PE file.\n\n\n-----\n\nAn example of python command execution though a Windows PE can be seen below:\n\n\n-----\n\nOnce the threat gets its environment all set, it builds and loads into memory a Python script\nthat will be in charge of obtaining the list of running processes and notifying the commandand-control server through an HTTP POST request.\n\nNext, in the following code block it is shown the script load by iterations:\n\n\n-----\n\nAs a result, we have a python script composed by seven functions plus its main function.\nThis script will notify to the C2C the extracted computer info and also set persistence into the\nvictim machine.\n\nMost important python functions are the following:\n\n**Function 1 – Name: setdelimeters**\n\n**Description: Collect computer data: Get list of running processes**\n\n**Function 2 – Name: getallusready**\n\n**Description: Collect computer data: Get OS version and machine name**\n\n\n-----\n\n**Function 3 – Name: simplify**\n\n**Description: Set persistence mechanism through Windows startup folders in the current**\nuser context\n\n**Function 4 – Name: synchronize**\n\n**Description: Send collected information to the command-and-control server**\n\n\n-----\n\nAs for network communications, as seen in the synchronize python function, the threat sends\nthe list of running processes obtained, the OS version and the username through an HTTP\nrequest.\n\nThis domain, where the C2C is hosted, resolves to an IP address that belongs to Digital\nOcean VPS service. So, the threat actors make use of this infrastructure to take control of\ncompromised computers and carry out actions from their C2C.\n\nResolution history:\n\n\n-----\n\nFinally, as a persistence mechanism, simplify function drops a new Windows PE file into the\ncurrent user startup folder:\n\n(%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\devenv.defender.scr).\n\nThis later artifact has been developed in .NET framework and its purpose is very simple:\nwaiting to receive a new infection module from the C2C, which is a DLL file named\nmscontainer.dll:\n\nSo far, we analyzed a threat whose main capabilities are for initial access and recognition of\nthe compromised computer as a common operational characteristic of the threat group, in\norder to detect if the malware was executed in a sandbox or others analysis environments.\nTherefore, we could consider it as the first stage and wait for new artifacts from the\ncommand-and-control server.\n\nThe Windows DLL mscontainer.dll sent afterwards by the C2C seems to be the next stage of\ninfection. Remember that this artifact is expected by the last analyzed PE\ndevenv.defender.scr which persists on the Windows startup folders.\n\nThe analyzed mscontainer.dll sample, also developed in .NET, is composed of 10\nfunctionalities plus its main function.\n\n\n-----\n\nThe threat-analysis has allowed us to obtain 37 decrypted strings, the commands accepted\nby the C2C and its hosted domain and others related to their capabilities, etc.\n\nThe most outstanding ones being considered:\n\nsenddevices\nsame\nOS\nIntranet\nStart\nPending\nresult\ndone\n\nFor the time being, no new infection scenarios and/or modules implemented by the C2C\nserver have been obtained. However, variations in the names of the artifacts that keeps the\nsame infection chain have been detected.\n\nOn the whole, this infection campaign seems to be related to the threat group Transparent\nTribe, trying to compromise Indian government once again. This assumption is based on the\nfact that the PDF content targeted to the government of India and the TTPs employed during\nthe infection process are common on this group. Even though this threat group usually\ndeploys CrimsonRAT as an initial access threat, this time they have deployed PeppyRAT. So,\nit could be considered a variation of the TTPs related to the APT group Transparent Tribe.\nFurthermore, no similarities have been found to any know malware in the mscontainer.dll\nartifact. In fact, it could be indeed a new malware developed by the threat group.\n\n**INDICATORS OF COMPROMISE:**\n\nARTIFACTS:\n\n**FILENAME** **SHA1**\n\nCovid_Letter.img c060431e55db84a195241be1cffdbdc30f42d666\n\n\n-----\n\nServiceHub.MsDetouredHost.exe 37dfea2d3e123ad91a8782debccb8f5c923b1a37\n\ndevenv.defender.scr 226781c376d6b4bdb8935dc98f645744da41ef68\n\ndoc.vbs f4ccf4dfcd6966eaa0b96b3977266113d71c5fa8\n\nVaccination06042021.PDF aa9eb957a3f46dc6a3d300c730c2d3892f577100\n\nVaccination06042021.pdf.lnk 9e27af77135943714bd5821f628c53af9a3f5fc9\n\nmscontainer.dll cfe0dba23fb55450d158731a35097de6c34679bd\n\nNETWORK:\n\n**Domain**\n\niwestcloud[.]com\n\nzoneflare[.]com\n\n**IP Address**\n\n167.99.40[.]13\n\n46.101.202[.]66\n\nRELATED INDICATORS:\n\n**FILENAME** **SHA1**\n\ntracking_notice.xls c65bb0e553dcc2ee68f24a862766cf1a813f0e0f\n\nmybinder.exe 4c5d43a71a24f4aa60f28613f2e26845418f4304\n\nuipool.scr e4f90256b82b7d09bdd5c622982a20fe064ae7a9\n\nMITRE TTPs:\n\n**TECHNIQUE ID** **Name**\n\nT1547.001 Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder\n\nT1566.001 Phishing: Spearphishing Attachment\n\nT1059.006 Command and Scripting Interpreter: Python\n\nT1057 Process discovery\n\n\n-----\n\nT1046 Network Service Scanning\n\nT1041 Exfiltration Over C2 Channel\n\nT1568 Dynamic Resolution\n\nT1005 Data from Local System\n\nCustomers with Lab52’s APT intelligence private feed service already have more tools and\nmeans of detection for this campaign.\n\nIn case of having threat hunting service or being client of S2Grupo CERT, this intelligence\nhas already been applied.\n\nIf you need more information about Lab52’s private APT intelligence feed service, you can\n[contact us through the following link](https://lab52.io/contact)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-24 - New TransparenTribe Operation- Targeting India with weaponized COVID-19 lure documents.pdf"
    ],
    "report_names": [
        "2022-01-24 - New TransparenTribe Operation- Targeting India with weaponized COVID-19 lure documents.pdf"
    ],
    "threat_actors": [
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536059,
    "ts_updated_at": 1743041763,
    "ts_creation_date": 1653700787,
    "ts_modification_date": 1653700787,
    "files": {
        "pdf": "https://archive.orkl.eu/b40f19ed548713b03baf3ea8594d800d3613a40c.pdf",
        "text": "https://archive.orkl.eu/b40f19ed548713b03baf3ea8594d800d3613a40c.txt",
        "img": "https://archive.orkl.eu/b40f19ed548713b03baf3ea8594d800d3613a40c.jpg"
    }
}