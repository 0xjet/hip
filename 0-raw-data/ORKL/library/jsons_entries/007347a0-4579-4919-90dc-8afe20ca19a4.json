{
    "id": "007347a0-4579-4919-90dc-8afe20ca19a4",
    "created_at": "2022-10-25T16:48:12.241874Z",
    "updated_at": "2025-03-27T02:16:23.246765Z",
    "deleted_at": null,
    "sha1_hash": "bab9bb00d8257cc19a6053d24e649884cebcec3a",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-10-07T09:45:45Z",
    "file_modification_date": "2021-10-07T09:45:45Z",
    "file_size": 3446014,
    "plain_text": "# Operation GhostShell: Novel RAT Targets Global Aerospace and Telecoms Firms\n\n**[cybereason.com/blog/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms](https://www.cybereason.com/blog/operation-ghostshell-novel-rat-targets-global-aerospace-and-telecoms-firms)**\n\nOctober 6, 2021 |\n16 minute read\n\nIn July 2021, the Cybereason Nocturnus and Incident Response Teams responded to Operation GhostShell, a highlytargeted cyber espionage campaign targeting the Aerospace and Telecommunications industries mainly in the Middle\nEast, with additional victims in the U.S., Russia and Europe.\n\nThe Operation GhostShell campaign aims to steal sensitive information about critical assets, organizations’\ninfrastructure and technology. During the investigation, the Nocturnus Team uncovered a previously undocumented\nand stealthy RAT (Remote Access Trojan) dubbed ShellClient which was employed as the primary espionage tool.\n\nThe Nocturnus Team found evidence that the ShellClient RAT has been under ongoing development since at least\n2018, with several iterations that introduced new functionalities, while it evaded antivirus tools and managed to\nremain undetected and publicly unknown.\n\nAssessments as to the identity of the operators and authors of ShellClient resulted in the identification of a new Iranian\nthreat actor dubbed MalKamak that has operated since at least 2018 and remained publicly unknown thus far. In\naddition, our research points out possible connections to other Iranian state-sponsored APT threat actors such as\nChafer APT (APT39) and Agrius APT. However, we assess that MalKamak has distinct features that separate it from the\nother Iranian groups.\n\n## Key Findings\n\n**New Iranian Threat Actor MalKamak: A newly discovered Iranian threat actor dubbed**\n_MalKamak that has been operating since at least 2018 and remained unknown thus far. In addition,_\nthe investigation draws possible connections to other Iranian state-sponsored threat actors including\nChafer APT (APT39) and Agrius APT.\n\n**Discovery of New ShellClient RAT: The Cybereason Nocturnus team discovered a sophisticated**\nand previously undocumented RAT (Remote Access Trojan) dubbed ShellClient used for highly\ntargeted cyber espionage operations.\n\n\n-----\n\n**Targeting Aerospace and Telecom Companies: Based on the telemetry, this threat has been**\npredominantly observed in the Middle East region, but has also been observed targeting organizations\nin the U.S., Russia and Europe, with a focus on the Aerospace and Telecommunications industries.\n\n**Ongoing Development Since 2018: Our investigation revealed this threat was first**\noperationalized in 2018, and since then has been under active development with each new version\nadding more features and stealth. This threat is still active as of September 2021.\n\n**Abusing Cloud Services for C2: The most recent ShellClient versions were observed to be abusing**\ncloud-based storage services for Command and Control (C2), in this case the popular Dropbox service,\nin order to remain undetected by blending in with legitimate network traffic.\n\n**Designed for Stealth: The authors of ShellClient invested a lot of effort into making it stealthy to**\nevade detection by antivirus and other security tools by leveraging multiple obfuscation techniques\nand recently implementing a Dropbox client for command and control (C2), making it very hard to\ndetect.\n\n## ShellClient: The Silent RAT\n\nThe following sections recap the recently observed Operation GhostShell campaign and the evolution of this stealthy\nShellClient RAT, which has been operationalized and actively developed since at least November 2018.\n\n### Recent Campaign\n\nIn July 2021, Cybereason encountered an unidentified threat actor carrying out a cyber espionage operation using a\npreviously undocumented and stealthy RAT dubbed ShellClient.\n\nUsing this RAT, the threat actors were first observed conducting reconnaissance and the exfiltration of sensitive data\nfrom leading Aerospace and Telecommunications companies in the Middle East region, and was later observed\ntargeting the same industries in other regions including the U.S, Russia and Europe.\n\nWhen first inspecting the ShellClient RAT, the malicious binary was found to be running on victim machines as\n“svchost.exe” while its internal name was disguised as “RuntimeBroker.exe”:\n\n_ShellClient RAT internal name masquerades as a legitimate Microsoft RuntimeBroker.exe binary_\n\nThis executable was determined to have been compiled on May 22nd, 2021, and was observed to be executing adjacent\nto additional TTPs.\n\n### ShellClient Structure and Configuration\n\n[The ShellClient RAT is a modular PE leveraging Costura to compress each of the modules using zlib:](https://github.com/Fody/Costura)\n\n\n-----\n\n_ShellClient RAT utilizing Costura_\n\nTwo of the references are DLLs containing supporting functionalities:\n\n**ExtensionLib.dll contains utilities and functionalities such as:**\n\nAES Encryption, including an AES Key and an Initialization Vector (IV)\nHashing\nFile Operations\nRegistry Operations\nProcess Creation\nSerialization\n\n_ExtensionLib.dll_\n\n**ClientCore.dll holds other core functionalities of the the client such as:**\n\nFingerprinting\nFile Operations\nUser Impersonation\nToken Handling\nFTP Client\nTelnet Client\nSettings & Strings\n\n\n-----\n\n_ClientCore.dll_\n\nThe executable stores most of the its strings, including configuration strings, as bytes and then converts them in realtime to Unicode/ASCII to evade antivirus strings detection:\n\n_ShellClient using Unicode/ASCII to evade antivirus strings detection_\n\n### Execution Flow\n\n\n-----\n\nThe ShellClient RAT executes according to the following arguments:\n\nIf no arguments are provided, the binary executes itself using InstallUtil.exe to install and run a\nmalicious nhdService service\nIf there is one argument and it is equal to -c, the binary will be executed using the Service Control\n_Manager (SCM) to create a reverse shell, communicating with a configured Dropbox storage as a C2_\n\nIf there is one argument and it is equal to -d, the binary will execute as a regular process\n\n_ShellClient RAT arguments_\n\nWhen either of the -c or -d arguments are provided, the malware performs basic fingerprinting using WMI to collect:\n\nHardware information such as BIOS information, Mac address, etc.\nNetworking Information including a request to ipinfo[.]io/ip to retrieve the public IP address of the infected\nmachine\nWhich antivirus products are installed\n\nThe abovementioned collected information is also used to create a unique agent identifier for each infected machine:\n\n_Creating a unique identifier_\n\n### Command and Control (C2) Communications\n\nThe C2 communications this malware implements are quite unique, as they rely on “cold files” being saved to a remote\nDropbox, instead of a common interactive session. This method of communication is an interesting Operational\nSecurity (OPSEC) solution, making it difficult to trace the threat actor’s infrastructure by utilizing a public service such\nas Dropbox.\n\nTo communicate with Dropbox, ShellClient uses Dropbox’s API with a unique embedded API key. Before\ncommunicating, it encrypts the data using an hardcoded AES encryption key.\n\nThe Dropbox storage contains 3 folders:\n\n**AS Folder (Agents Folder): Stores uploaded information on infected machines**\n**CS Folder (Commands Folder): Stores commands to be fetched, executed and then deleted by ShellClient**\n**RS Folder (Results Folder): Stores the output of commands executed by ShellClient**\n\n\n-----\n\nEvery 2 seconds, the victim machine checks the commands folder, retrieves files that represent commands, parses their\ncontent, then deletes them from the remote folder and enables them for execution:\n\n_ShellClient C2 Communications_\n\nAfter executing the commands, the executable uploads the results to the corresponding folder with a randomly\ngenerated file name based on the unique victim ID that the threat actor calls as HardwareID:\n\n_ShellClient C2 Communications_\n\nThe destinations for these communications will be api.dropboxdapi[.]com and content.dropboxapi[.]com.\n\n### Persistence and Privilege Escalation\n\nThe ShellClient RAT achieves persistence and privilege escalation to run with SYSTEM privileges on victim machines\nby creating the nhdService disguised as Network Hosts Detection Service:\n\n**Service Name: nhdService**\n**Display Name: Network Hosts Detection Service**\n**Description: Searches and manages hosts in the Network and Dial-Up Connections folder, where both**\nlocal area network and remote connections are viewable\n**Start Type: Automatic**\n**Account: LocalSystem**\n\n### Supported Commands\n\n\n-----\n\nThe executable contains multiple command functions that enable its capabilities, including arbitrary command\nexecution, FTP/Telnet clients, lateral movement, file manipulation, etc.\n\nIn addition, the malware contains several command functions that seem to do nothing and have no reference in the\ncode; this could indicate that the malware is still under development.\n\nThe following table describes the purpose of each command:\n\n**Command** **Description**\n\ncode10 Query hostname, malware version, executable path, IP address and Antivirus products\n\ncode11 Execute an updated version of ShellClient\n\ncode12 Self delete using InstallUtil.exe\n\ncode13 Restart the ShellClient service\n\ncode20 Start a CMD shell\n\ncode21 Start a PowerShell shell\n\ncode22 Add to the results message the following line: “Microsoft Windows Command Prompt Alternative\nStarted …”\n\ncode23 Open a TCP Client\n\ncode24 Start a FTP client\n\ncode25 Start a Telnet client\n\nCode26 Execute a shell command\n\ncode29 Kill active CMD or PowerShell shell\n\ncode31 Query files and directories\n\ncode32 Create a Directory\n\ncode33 Delete files and folders\n\ncode34 Download a file to the infected machine\n\ncode35 Upload a File to Dropbox\n\ncode36 Does nothing\n\ncode37 Download a file to the infected machine and execute it\n\n\n-----\n\ncode38 Lateral movement using WMI\n\n_ShellClient C2 Commands_\n\n### Additional TTPs Observed with ShellClient\n\nUsing the ShellClient RAT, the threat actor deployed additional tools to perform various activities to support their\noperation such as reconnaissance, lateral movement, data collection and more.\n\n**Lateral Movement**\n\n[The attackers were observed using PAExec and “net use” for lateral movement. PAExec is a redistributable version of](https://www.poweradmin.com/paexec/)\n[the famous Sysinternals PsExec, with some additional options.](https://docs.microsoft.com/en-us/sysinternals/downloads/psexec)\n\nThe attackers leveraged PAExec to:\n\n**Execute a CMD shell as SYSTEM on remote machines**\n**Perform remote service related operations like start, stop, restart, status and more**\n**Exfiltrate organizational Active Directory structure using a remotely executed csvde.exe -f < output**\n_file > command_\n**[Check internet connectivity using ping to reach Google.com](https://attack.mitre.org/software/S0097/)**\n**[Gather host information by executing ipconfig, tasklist and net use](https://attack.mitre.org/software/S0100/)**\n\n_ShellClient leveraging PAExec as observed in the Cybereason Defense Platform_\n\n**Credential Dumping Tool**\n\nDuring the observed attacks, the ShellClient RAT activity group deployed and executed an unknown executable named\n_lsa.exe to perform credential dumping. Lsa.exe dumped the memory of lsass.exe to a file named debug.bin and was_\nobserved executing with the following command-line arguments:\n\nlsa.exe -d\n\nlsa.exe -m\n\nAlthough the Cybereason Nocturnus team was unable to retrieve the lsa.exe executable, we speculate the tool might be\n[a variation of the tool SafetyKatz based on the debug.bin dump file the tool creates, which is also the name of the dump](https://github.com/GhostPack/SafetyKatz)\nfile created by SafetyKatz that was previously tied to Iranian threat actors:\n\n\n-----\n\n_ShellClient credential dumping as observed in the Cybereason Defense Platform_\n\n**Staging**\n\nIn order to exfiltrate data, the attackers used WinRar to compress important files before data exfiltration using a\nrenamed rar.exe WinRar file:\n\n\n-----\n\n_ShellClient using WinRar to compress data before exfiltration_\n\n## The Evolution of ShellClient and Finding the Missing Link\n\n_Known ShellClient RAT version history timeline_\n\n\n-----\n\nOne of the questions that came up during the investigations was regarding how far back the use of the malware can be\nobserved. At first it was thought to have been developed recently since there was no publicly available documentation\nor any mention of it available. However, the code indicates that the sample we analyzed was version 4.0, which implies\nthere should be several previous versions.\n\nWith that in mind, the investigation revealed the missing link in a .NET GUID that appeared in the metadata of the\n[observed sample. Pivoting on this unique identifier, we were able to uncover an older instance (version 3.1, VT link)](https://www.virustotal.com/gui/file/a541afa0e73c3942b8c3645a3ba1ea59c4d6e1110e271be34fdb6a8c02a299e2)\nthat used the same .NET TypeLibID GUID, a unique ID generated by Visual Studio per project - fd01304b-571f-4454b52b-19cfb8af44a9:\n\n_Shared .NET TypeLib Id GUID between the recent and the older version of ShellClient_\n\nFrom there, finding the other previous versions of ShellClient was achieved by pivoting searching for string and code\nsimilarities. This pivoting process proved that ShellClient has been under continuous development since at least\nNovember of 2018, marking almost three years of development work to evolve the malware from a simple standalone\nreverse shell to a stealthy modular espionage tool.\n\nIn each new iteration of the malware, the authors added new features and capabilities, attempting to use various\nexfiltration protocols and methods, such as using an FTP client and a Dropbox account to hide in plain site. In\naddition, from version 4.0.0 and up, the authors made significant design and architecture changes like introducing\nmodular design.\n\nBelow is a summary of the variants that were discovered so far:\n\n\n**VT**\n**Link**\n\nVT\nlink\n\nVT\nlink\n\nVT\nlink\n\nVT\nlink\n\nVT\nlink\n\n\n**Variant**\n**Version**\n\nEarliest\n\nvariant\n\n\n4.0.0 RuntimeBroker.exe\n/ svchost.exe\n\n\n**Name** **Compilation**\n**Date**\n\nsvchost.exe 2018-11-06\n21:35:41\n\n\n**First**\n**Submission**\n**Date**\n\n2018-11-11\n15:28:46\n\n2020-04-15\n23:22:13\n\n2020-04-14\n22:59:49\n\n2019-01-17\n22:53:43\n\n2021-09-22\n09:18:59\n\n\n**PDB Path**\n\nD:\\projects\\07 - Reverse\nShell\\ShellClientServer_HTTP\\obj\\Release\\svchost.pdb\n\nE:\\Projects (Confidential)\\07 - Reverse\nShell\\ShellClientServer_HTTP.v2\\obj\\Release\\svchost.pdb\n\nD:\\Visual Studio\n2017\\v3.1\\ShellClient\\obj\\Release\\svchost.pdb\n\n\n1 svchost.exe 2018-11-29\n23:41:15\n\n2.1 svchost.exe 2018-12-16\n11:19:14\n\n3.1 svchost.exe 2019-01-12\n18:37:20\n\n\n2021-08-10\n11:14:51\n\n\n-----\n\nVT\nlink\n\n\n4.0.1 RuntimeBroker.exe\n/ svchost.exe\n\n\n2021-05-22\n12:06:05\n\n\n2021-07-20\n16:16:06\n\n\n_Known ShellClient RAT version history_\n\n## Overview of ShellClient Evolution\n\n### Earliest Variant (November 2018)\n\nThe earliest variant traced was compiled on November 06, 2018, and was purposefully named svchost.exe to allow it to\nmasquerade as a legitimate Windows binary. This early variant is not very rich in features and lacks the sophistication\n[and functionality that are manifested in its successors. In essence, it is a rather simple reverse shell.](https://www.netsparker.com/blog/web-security/understanding-reverse-shells/)\n\nMain Features:\n\n**File name: svchost.exe**\n\n**File description: Windows Defender Service**\n\n**Core functionality: Simple websocket-based reverse shell**\n**Hardcoded C2 domain: azure.ms-tech[.]us:80**\n\n### Variant V1 (November 2018)\n\nThe second oldest variant emerged about 3 weeks after the initial version. This variant is more mature and contains\ncapabilities of both of a client and a server, including a new service persistence method disguising as a Windows\nDefender Update service. This version of ShellClient also communicates with the following C2 domain: azure.ms_tech[.]us:80_\n\n**Main Updates:**\n\n**File description: Host Process For Windows Processes**\n\n**Core functionalities:**\n\nPredefined set of C2 commands\nExecuting arbitrary commands via CMD shell or PowerShell\nClient and Server components\nPersistence via Windows Service, masquerading as Windows Defender\n\nBase64 encoding/decoding for data sent from / to C2\n\n### Version V2.1 (December 2018)\n\nCompiled approximately 2 weeks after variant V1, this variant keeps the same name and description attributes but\nshows further progress in development by adding a variety of new capabilities, including FTP and Telnet clients, AES\nencryption, self-update capabilities and more. This version of ShellClient also communicates with the following C2\ndomain: azure.ms-tech[.]us:80\n\n**Main Changes:**\n\n\n-----\n\n**Core functionalities:**\n\nImplementing FTP and Telnet clients\nAES encryption of data sent to the C2\nSelf-updating feature\nClient ID and versioning attributes added\n\nExtended set of predefined C2 commands\n\n### Variant V3.1 (January 2019)\n\nAbout a month after the emergence of variant V2.1, the V3.1 variant was seen in January of 2019. It has mostly minor\nchanges in regards to functionality. The main difference is the removal of the “Server” component from the executable,\nas well as new code obfuscation and an upgraded commands menu. This version of ShellClient also communicates with\nthe following C2 domain: azure.ms-tech[.]us:80\n\n**Main Changes:**\n\n**Core functionality:**\n\nRemoval of the Server component\nIntroduction of command-line arguments\nFirst attempts of code obfuscation\nMore predefined C2 commands\n\nOS fingerprinting via WMI\n\n### Variant V4.0.0 (August 2021)\n\nPerhaps one of the biggest advancements in the ShellClient evolution came with version V4.0.0 and continued with its\nsuccessor V4.0.1, in which the malware authors implemented many changes and improvements, adding new\ncapabilities, enhancing code obfuscation and code protection using Costura packer, as well as abandoning the C2\ndomain that was active since 2018.\n\nThe traditional C2 communications were replaced with a Dropbox built-in client, abusing the popular online platform\nto send commands to ShellClient as well as storing the stolen data exfiltrated to a designated Dropbox account. This\nultimately makes it harder to detect since the network traffic would appear legitimate to security analysts as well as\nmost security solutions.\n\n**_Note: For full analysis of the variants, please refer to Appendix A in the IOCs popup in lower right of_**\n**_your screen._**\n\n## Attribution\n\nDuring the investigation, efforts were made to identify instances of the ShellClient code and to determine its origin or\naffiliation with known threat actors. Given the fact that ShellClient was previously undocumented and unknown at the\ntime of the investigation, and the identity of the threat actor behind the attack was unclear, the Nocturnus Team first\nattempted to find links to known adversary groups that have carried out similar attacks in the past against this industry\nand the affected regions.\n\nWhile some possible connections to known Iranian threat actors were observed, our conclusion is that MalKamak is a\nnew and distinct activity group, with unique characteristics that distinguish it from the other known Iranian threat\nactors. In publishing this data, it is hoped that more attention will be given to this threat and over time more\ninformation about ShellClient origins will emerge.\n\n### Likely Nation State-Sponsored Threat Actor\n\n\n-----\n\nThe current working assumption is that ShellClient was created and maintained by a nation-state sponsored threat\nactor, or Advanced Persistent Threat (APT). The intrusions analyzed by Cybereason suggest that the motivation is\ncyber espionage against a very small set of carefully selected targets. This is supported by the fact that there are very\nfew samples found in the telemetry or in-the-wild since 2018, in contrast to commodity malware that can usually be\nfound in abundance.\n\nIn addition, the PDB path that is embedded in some of the ShellClient samples suggests that this malware is part of a\nrestricted or classified project that could be related to military or intelligence agency operations:\n\n_E:\\Projects (Confidential)\\07 - Reverse Shell\\ShellClientServer_HTTP.v2\\obj\\Release\\svchost.pdb_\n\n### Russian Turla Connection or a Yara False Positive?\n\nIn examining some “low hanging fruit, ”the first clue examined was a Yara rule comment that appeared in VirusTotal\nalong with some of the older variants of ShellClient. The Yara rule that was indicated is named\n**_APT_Turla_MSTCSS_Malware_Jun19_1:_**\n\n_Yara rule comment that appeared in VirusTotal_\n\nThe Nocturnus Team examined the possibility that the ShellClient malware might have been created by the Russian\nAPT group Turla. However, upon careful analysis of known Turla malware, and even more specifically the ones\n[indicated in a Symantec report referenced in the Yara rule, the team did not find any significant similarities or evidence](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/waterbug-espionage-governments)\nthat can tie Turla to ShellClient or the activity that was observed in the intrusion investigated.\n\n### An Iranian Connection\n\nGiven that most of the victims were located in the Middle East region and considering the affected industries, the\nunique profile of the attacked organizations, as well as other characteristics related to the intrusion and the malware,\nthe team also examined the possibility that an Iranian state-sponsored threat actor might be behind the Operation\nGhostShell intrusions.\n\nThe Nocturnus team compared our observations with previous campaigns that were attributed to known Iranian threat\nactors, and was able to point out some interesting similarities between ShellClient and previously reported Iranian\nmalware and threat actors.\n\nHowever, at this point, our estimation is that this operation was carried out by a separate activity group, dubbed\n_MalKamak, which has its own distinct characteristics that distinguish it from the other groups._\n\nNonetheless, we believe that highlighting the possible connections between various Iranian threat actors could be\nbeneficial. Whether such connection is a result of a direct collaboration among these threat actors is currently\nunknown.\n\nThese connections can also be explained in other ways, which are less direct, for example - a cyber mercenary who\ncodes for multiple threat actors - could also be a likely explanation that can account for some of these observed\noverlaps.\n\n### Meet MalKamak: A New Iranian Threat Actor\n\n\n-----\n\n_MalKamak Diamond Model Summary_\n\nUsing the famous diamond model of attribution, the Nocturnus team was able to determine that the attacks were\ncarried out by a new activity group, dubbed MalKamak, which was unknown thus far and believed to be operating on\nbehalf of Iranian interests. Following is a quick summary of its main characteristics:\n\n**Country of Origin: Iran**\n**Years of Activity: Since at least 2018**\n**Motivation: Cyber Espionage**\n\n**Victimology:**\n\n**Affected Regions: Predominantly the Middle East, with victims in the US, Europe and Russia.**\n\n**Affected Industries: Aerospace and Telecommunications**\n\n**Unique Tools: ShellClient (evolving from a simple reverse shell to a complex RAT)**\n\n**[Generic Tools: SafetyKatz, PAExec, ping, ipconfig, tasklist, net, and WinRAR.](https://www.poweradmin.com/paexec/)**\n\n**Known Infrastructure:**\n\n**2018-2020: ms-tech[.].us**\n\n**2021: DropBox C2**\n\n[*MalKamak is derived from Kamak, the name of an ancient Persian mythological creature thought responsible for](https://www.worldhistory.org/article/1484/twelve-ancient-persian-mythological-creatures/)\ndroughts and spreading chaos.\n\n### Similarities to Previous Chafer APT-Related Campaigns\n\nDuring the analysis, it was observed that there were some potentially interesting links and similarities to an Iranian\n[threat actor called Chafer APT (also known as APT39, ITG07 or Remix Kitten).](https://attack.mitre.org/groups/G0087/)\n\nThe group has been active since at least 2014, and is believed to be linked to the Rana Intelligence Computing\n_[Company, a Teheran-based company, previously known to serve as a front company for the Iranian Ministry of](https://www.iranwatch.org/library/governments/united-states/executive-branch/department-justice/indicators-compromise-associated-rana-intelligence-computing-also-known-advanced)_\nIntelligence and Security (MOIS). The Chafer APT is known to attack targets in the Middle East as well as the U.S. and\nEurope.\n\n\n-----\n\n[Examining past campaigns, such as the one analyzed in Bitdefender’s Chafer APT report, the team noticed interesting](https://www.bitdefender.com/files/News/CaseStudies/study/332/Bitdefender-Whitepaper-Chafer-creat4491-en-EN-interactive.pdf)\noverlaps with observations in this investigation, as detailed in the following sections.\n\nOur current assessment is that while these overlaps are interesting, they are not enough to establish attribution with an\nadequate certainty.\n\n**Credential Dumping**\n\n[Chafer has been known to use the SafetyKatz tool to harvest credentials from compromised endpoints. As mentioned](https://www.bitdefender.com/files/News/CaseStudies/study/332/Bitdefender-Whitepaper-Chafer-creat4491-en-EN-interactive.pdf)\npreviously in this report, there are indications that the threat actor analyzed here used the same tool.\n\n**Obfuscated Persistence**\n\nIn both of the investigations, the threat actors maintained persistence by obfuscating the malware as legitimate\nWindows-related components on victims’ systems. To achieve that, both operations used the Windows Defender\n_Update name to disguise their activity:_\n\n**ShellClient Disguised Persistence** **[Previous Chafer APT Disguised Persistence](https://www.bitdefender.com/files/News/CaseStudies/study/332/Bitdefender-Whitepaper-Chafer-creat4491-en-EN-interactive.pdf)**\n\n**WIndows Defender Update service** **Defender Update scheduled task**\n\n_Obfuscated Persistence_\n\n**PDBs**\n\nExecutable in both of the operations were found to be compiled from similar paths, particularly containing the\n“projects” folder under a root drive:\n\n**ShellClient PDB Paths** **Chafer APT Disguised Persistence**\n\n\n**D:\\projects\\07 - Reverse**\nShell\\ShellClientServer_HTTP\\obj\\Release\\svchost.pdb\n\n**E:\\Projects (Confidential)\\07 - Reverse**\nShell\\ShellClientServer_HTTP.v2\\obj\\Release\\svchost.pdb\n\n_PDB Evidence_\n\n**Similarities to Agrius APT-Related Campaigns**\n\n\n**F:\\Projects\\94-**\n06\\RCE\\bin\\Release\\x64\\mas.pdb\n\n**F:\\Projects\\94-**\n08\\XNet\\bin\\Release\\Win32\\XNet.pdb\n\n\n[Another Iranian threat actor that was examined is a relatively new activity group known as Agrius APT. The group has](https://apt.thaicert.or.th/cgi-bin/showcard.cgi?g=Agrius)\nbeen known to attack mainly Israeli organizations and companies, carrying out destructive operations under the guise\nof ransomware attacks.\n\n[A report about Agrius attacks mentions a custom .NET backdoor called IPsec Helper. Although the IPsec Helper](https://www.sentinelone.com/labs/from-wiper-to-ransomware-the-evolution-of-agrius/)\nbackdoor and ShellClient are quite different, there were some interesting similarities in the coding style and naming\nconventions, which may indicate a link between the two malware and the possibility that they were authored by\ndevelopers from the same or adjacent teams.\n\nThese interesting code similarities could indicate a similar developer was also behind the ShellClient, or at the very\nleast indicate a person who had access to the code of the two malware. That being said, the TTPs and the intrusions\nconducted by Agrius seem very different than the TTPs and intrusions observed in Operation GhostShell - and\ntherefore we concluded that it is unlikely that Agrius is behind this operation.\n\n**Possible Coding Style Overlap**\n\nWhen comparing the command parsing function of both IPsec Helper and ShellClient, a similar code structure and\nlogic can be seen:\n\n\n-----\n\n_Code similarities between IPsec Helper and ShellClient_\n\n**Naming Conventions**\n\nBoth ShellClient and IPsec Helper use a similar naming convention for the classes used to launch the malware as a\nservice:\n\n\n-----\n\n_Similarities between ShellClient and IPsec Helper naming conventions_\n\n**Kill Techniques**\n\nBoth ShellClient and IPsec Helper use InstallUtil.exe in the self kill mechanism. When ShellClient receives a self kill\ncommand, It executes InstallUtil.exe in order to delete the service created and remove itself from the infected machine.\nWhen IPsec Helper receives a self kill command, it creates and executes a batch script named “remover.bat”. The script\nuses InstallUtil.exe to delete the service created for the malware.\n\n**Data Decoding and Encryption**\n\nBoth ShellClient and IPsec Helper use Base64 and AES to encode and encrypt data sent to the C2. In addition, both\nmalware have a separate class for Base64 encoding and decoding, and for AES encryption and decryption:\n\n_ShellClient and IPsec Helper data decoding and encryption similarities_\n\n**Other Similar Functions**\n\nSome functions of ShellClient, IPsec Helper and Apostle malware are very similar, for example the Serialize function,\nwhich is found on all three malware variants.\n\n\n-----\n\n_ShellClient, IPsech Helper and Apostle malware similarities_\n\n**Possible Infrastructure Connection**\n\nAnother interesting connection identified between these malware is based on past IP address resolutions of the domain\nused by ShellClient azure.ms-tech[.]us and a domain used by IPsec Helper _whynooneistherefornoneofthem[.]com._\nBoth of these domains have been resolved to both of the IP addresses 139.162.120.150 and 50.116.17.41.\n\n[Upon examination of these IP addresses, they function as a sinkhole. Further examination of other domains that were](https://en.wikipedia.org/wiki/DNS_sinkhole)\nresolved to these IP addresses in the past revealed a significant number of malicious domains that were used by Iranian\nAPTs.\n\n## Conclusion\n\nIn the Operation GhostShell report, the Cybereason Nocturnus and Incident Response Teams discovered a\nsophisticated new Remote Access Trojan (RAT) dubbed ShellClient that was used in highly targeted attacks against a\nselect few Aerospace and Telecommunications companies mainly in the Middle East, with other victims located in the\nU.S., Russia and Europe. Our current assessment is that the attacks were perpetrated by a newly discovered Iranian\nactivity group dubbed MalKamak that has been operating since at least 2018 and remained in the dark until now.\n\nThe investigation into Operation GhostShell also revealed that ShellClient dates back to at least 2018, and has been\ncontinuously evolving ever since while successfully evading most security tools and remaining completely unknown. By\nstudying the ShellClient development cycles, the researchers were able to observe how ShellClient has morphed over\ntime from a rather simple reverse shell to a sophisticated RAT used to facilitate cyber espionage operations while\nremaining undetected.\n\nThe most recent ShellClient versions observed in Operation GhostShell follow the trend of abusing cloud-based storage\nservices, in this case the popular Dropbox service. The ShellClient authors chose to abandon their previous C2 domain\nand replace the command and control mechanism of the malware with a more simple yet more stealthy C2 channel\nusing Dropbox to exfiltrate the stolen data as well as to send commands to the malware. This trend has been\nincreasingly adopted by many threat actors due to its simplicity and the ability to effectively blend in with legitimate\nnetwork traffic.\n\n\n-----\n\nIt is the intention of the researchers that the information provided in the Operation GhostShell report will inspire\nfurther research regarding ShellClient and the newly identified MalKamak activity group, and that it will ultimately\nassist in shedding more light on this mysterious malware that was kept well-hidden for many years.\n\n## authors\n\nTOM FAKTERMAN, THREAT RESEARCHER\n\nTom Fakterman, Cyber Security Analyst with the Cybereason Nocturnus Research Team,\nspecializes in protecting critical networks and incident response. Tom has experience in\nresearching malware, computer forensics and developing scripts and tools for automated\ncyber investigations.\n\nDANIEL FRANK, SENIOR MALWARE RESEARCHER\n\nWith a decade in malware research, Daniel uses his expertise with malware analysis and\nreverse engineering to understand APT activity and commodity cybercrime attackers.\nDaniel has previously shared research at RSA Conference, the Microsoft Digital Crimes\nConsortium, and Rootcon.\n\nCHEN ERLICH, INCIDENT RESPONSE ENGINEER\n\nChen has almost a decade of experience in Threat Intelligence & Research, Incident\nResponse and Threat Hunting. Before joining to Cybereason, Chen spent three years\ndissecting APTs, investigating underground cybercriminal groups and discovering security\nvulnerabilities in known vendors. Previously, he served as a Security Researcher in the\nIDF.\n\nASSAF DAHAN, HEAD OF THREAT RESEARCH\n\nAssaf has over 15 years in the InfoSec industry. He started his career in the Israeli Military\n8200 Cybersecurity unit where he developed extensive experience in offensive security.\nLater in his career he led Red Teams, developed penetration testing methodologies, and\nspecialized in malware analysis and reverse engineering.\n\n## INDICATORS OF COMPROMISE\n\n_Open the chatbot on the bottom right corner of your screen to access the Ghostshell IOCs and Appendix A._\n\n## MITRE ATT&CK BREAKDOWN\n\n\n**Execution** **Persistence** **Privilege**\n**Escalation**\n\n\n**Defense Evasion** **Credential**\n**Access**\n\n\n[Command-line interface](https://attack.mitre.org/techniques/T1059/) Windows\nService\n\n\n[Valid Accounts](https://attack.mitre.org/techniques/T1078/) Obfuscated Files or\nInformation\n\n\nCredential\nDumping\n\n\n-----\n\nWindows Management\nInstrumentation\n\n[PowerShell](https://attack.mitre.org/techniques/T1086/)\n\n\n[Masquerading](https://attack.mitre.org/techniques/T1036/)\n\n\n**Discovery** **Lateral Movement** **Collection** **Command and**\n**Control**\n\n\n**Exfiltration**\n\nExfiltration Over Web\nService\n\n\n[Security Software Discovery](https://attack.mitre.org/techniques/T1518/001/) SMB/Windows\nAdmin Shares\n\nSystem Information\nDiscovery\n\nSystem Network\nConfiguration Discovery\n\nAbout the Author\n\n**Cybereason Nocturnus**\n\n\nArchive\nCollected Data [Data Encoding](https://attack.mitre.org/techniques/T1132/)\n\n\nEncrypted\nChannel Exfiltration Over C2\nChannel\n\n\nFile Transfer\nProtocols\n\n[Web Protocols](https://attack.mitre.org/techniques/T1071/001/)\n\n\nExfiltration Over\nAlternative Protocol\n\n\nThe Cybereason Nocturnus Team has brought the world’s brightest minds from the military, government intelligence,\nand enterprise security to uncover emerging threats across the globe. They specialize in analyzing new attack\nmethodologies, reverse-engineering malware, and exposing unknown system vulnerabilities. The Cybereason\nNocturnus Team was the first to release a vaccination for the 2017 NotPetya and Bad Rabbit cyberattacks.\n\n[All Posts by Cybereason Nocturnus](https://www.cybereason.com/blog/authors/cybereason-nocturnus)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.10.06.Operation_GhostShell/Operation%20GhostShell_%20Novel%20RAT%20Targets%20Global%20Aerospace%20and%20Telecoms%20Firms.pdf"
    ],
    "report_names": [
        "Operation GhostShell_ Novel RAT Targets Global Aerospace and Telecoms Firms"
    ],
    "threat_actors": [
        {
            "id": "8205484f-7cf2-4b43-b2de-c1a500ae310e",
            "created_at": "2022-10-25T16:07:23.861533Z",
            "updated_at": "2025-03-27T02:02:10.001066Z",
            "deleted_at": null,
            "main_name": "MalKamak",
            "aliases": [
                "Operation GhostShell"
            ],
            "source_name": "ETDA:MalKamak",
            "tools": [
                "PAExec",
                "SafetyKatz",
                "ShellClient",
                "WinRAR"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7261dbea-1283-4a30-8da6-c30ccfc25024",
            "created_at": "2023-11-30T02:00:07.289432Z",
            "updated_at": "2025-03-27T02:00:03.254343Z",
            "deleted_at": null,
            "main_name": "MalKamak",
            "aliases": [],
            "source_name": "MISPGALAXY:MalKamak",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "21e01940-3851-417f-9e90-1a4a2da07033",
            "created_at": "2022-10-25T16:07:23.299369Z",
            "updated_at": "2025-03-27T02:02:09.725295Z",
            "deleted_at": null,
            "main_name": "Agrius",
            "aliases": [
                "AMERICIUM",
                "Agonizing Serpens",
                "BlackShadow",
                "DEV-0227",
                "Pink Sandstorm",
                "SharpBoys"
            ],
            "source_name": "ETDA:Agrius",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agrius",
                "BFG Agonizer",
                "BFG Agonizer Wiper",
                "DEADWOOD",
                "DETBOSIT",
                "Detbosit",
                "IPsec Helper",
                "Moneybird",
                "MultiLayer Wiper",
                "PW",
                "PartialWasher",
                "PartialWasher Wiper",
                "SQLShred",
                "Sqlextractor"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bee22874-f90e-410b-93f3-a2f9b1c2e695",
            "created_at": "2022-10-25T16:07:23.45097Z",
            "updated_at": "2025-03-27T02:02:09.808919Z",
            "deleted_at": null,
            "main_name": "Chafer",
            "aliases": [
                "APT 39",
                "Cobalt Hickman",
                "ITG07",
                "Radio Serpens",
                "Remix Kitten",
                "TA454"
            ],
            "source_name": "ETDA:Chafer",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Antak",
                "CACHEMONEY",
                "EternalBlue",
                "HTTPTunnel",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MechaFlounder",
                "Metasploit",
                "Mimikatz",
                "NBTscan",
                "NSSM",
                "Non-sucking Service Manager",
                "POWBAT",
                "Plink",
                "PuTTY Link",
                "Rana",
                "Remcom",
                "Remexi",
                "RemoteCommandExecution",
                "SafetyKatz",
                "UltraVNC",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "nbtscan",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "89c0c674-c35d-47a6-bd7c-1e6c1b6beacc",
            "created_at": "2024-05-01T02:03:08.042533Z",
            "updated_at": "2025-03-27T02:05:17.3236Z",
            "deleted_at": null,
            "main_name": "COBALT SHADOW",
            "aliases": [
                "AMERICIUM ",
                "Agrius",
                "BlackShadow",
                "DEV-0227 ",
                "Malek Team",
                "Pink Sandstorm ",
                "Agonizing Serpens "
            ],
            "source_name": "Secureworks:COBALT SHADOW",
            "tools": [
                " DEADWOOD",
                " Fantasy wiper",
                " Host2IP",
                " IPsec Helper",
                " Jennlog Loader",
                " MiniDump",
                " Moneybird ransomware",
                " PSexec",
                " Plink",
                " Sandals",
                " SecretsDump",
                " SoftPerfect Network Scanner",
                "Apostle"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1b3a247f-6186-4482-8b92-c3fb2d767c7d",
            "created_at": "2023-01-06T13:46:38.883911Z",
            "updated_at": "2025-03-27T02:00:02.942724Z",
            "deleted_at": null,
            "main_name": "APT39",
            "aliases": [
                "COBALT HICKMAN",
                "G0087",
                "Radio Serpens",
                "TA454",
                "REMIX KITTEN"
            ],
            "source_name": "MISPGALAXY:APT39",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a761f2a6-26ba-47fd-89c3-6a74f847a3b2",
            "created_at": "2024-05-01T02:03:08.025289Z",
            "updated_at": "2025-03-27T02:05:17.312292Z",
            "deleted_at": null,
            "main_name": "COBALT HICKMAN",
            "aliases": [
                "Chafer ",
                "ITG07 ",
                "APT39 "
            ],
            "source_name": "Secureworks:COBALT HICKMAN",
            "tools": [
                " Mimikatz",
                " Remexi",
                " TREKX",
                "MechaFlounder"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4023e661-f566-4b5b-a06f-9d370403f074",
            "created_at": "2024-02-02T02:00:04.064685Z",
            "updated_at": "2025-03-27T02:00:03.304692Z",
            "deleted_at": null,
            "main_name": "Pink Sandstorm",
            "aliases": [
                "Agonizing Serpens",
                "AMERICIUM",
                "BlackShadow",
                "DEV-0022",
                "Agrius"
            ],
            "source_name": "MISPGALAXY:Pink Sandstorm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6b6155e4-94ec-4909-b908-550afe758ad6",
            "created_at": "2022-10-25T15:50:23.365074Z",
            "updated_at": "2025-03-27T02:00:55.455014Z",
            "deleted_at": null,
            "main_name": "APT39",
            "aliases": [
                "APT39",
                "ITG07",
                "Remix Kitten"
            ],
            "source_name": "MITRE:APT39",
            "tools": [
                "NBTscan",
                "MechaFlounder",
                "Remexi",
                "CrackMapExec",
                "pwdump",
                "Mimikatz",
                "Windows Credential Editor",
                "Cadelspy",
                "PsExec",
                "ASPXSpy",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7d982d5b-3428-483c-8804-c3ab774f1861",
            "created_at": "2024-11-01T02:00:52.70975Z",
            "updated_at": "2025-03-27T02:00:55.517246Z",
            "deleted_at": null,
            "main_name": "Agrius",
            "aliases": [
                "Agrius",
                "Pink Sandstorm",
                "AMERICIUM",
                "Agonizing Serpens",
                "BlackShadow"
            ],
            "source_name": "MITRE:Agrius",
            "tools": [
                "NBTscan",
                "Mimikatz",
                "IPsec Helper",
                "Moneybird",
                "MultiLayer Wiper",
                "DEADWOOD",
                "BFG Agonizer",
                "ASPXSpy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041783,
    "ts_creation_date": 1633599945,
    "ts_modification_date": 1633599945,
    "files": {
        "pdf": "https://archive.orkl.eu/bab9bb00d8257cc19a6053d24e649884cebcec3a.pdf",
        "text": "https://archive.orkl.eu/bab9bb00d8257cc19a6053d24e649884cebcec3a.txt",
        "img": "https://archive.orkl.eu/bab9bb00d8257cc19a6053d24e649884cebcec3a.jpg"
    }
}