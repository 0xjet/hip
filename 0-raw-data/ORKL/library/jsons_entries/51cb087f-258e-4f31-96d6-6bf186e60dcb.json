{
    "id": "51cb087f-258e-4f31-96d6-6bf186e60dcb",
    "created_at": "2023-01-12T15:03:40.591118Z",
    "updated_at": "2025-03-27T02:05:53.704107Z",
    "deleted_at": null,
    "sha1_hash": "809525e9d0a76f7c32810a397229a43b6cc0c75d",
    "title": "2022-02-08 - Attackers Disguise RedLine Stealer as a Windows 11 Upgrade",
    "authors": "",
    "file_creation_date": "2022-05-28T19:09:29Z",
    "file_modification_date": "2022-05-28T19:09:29Z",
    "file_size": 2984009,
    "plain_text": "# Recent Posts\n\n**[threatresearch.ext.hp.com/redline-stealer-disguised-as-a-windows-11-upgrade/](https://threatresearch.ext.hp.com/redline-stealer-disguised-as-a-windows-11-upgrade/)**\n\n[HP Threat Research Blog • Attackers Disguise RedLine Stealer as a Windows 11 Upgrade](https://threatresearch.ext.hp.com/blog/)\n\n## Attackers Disguise RedLine Stealer as a Windows 11 Upgrade\n\n\nFebruary 8, 2022\n\n\nThreat actors are always looking for topical lures to socially engineer victims into infecting systems. We recently analyzed\none such lure, namely a fake Windows 11 installer. On 27 January 2022, the day after the final phase of the Windows 11\nupgrade was announced, we noticed a malicious actor registered the domain windows-upgraded[.]com, which they used\nto spread malware by tricking users into downloading and running a fake installer. The domain caught our attention\nbecause it was newly registered, imitated a legitimate brand and took advantage of a recent announcment. The threat\n[actor used this domain to distribute RedLine Stealer, an information stealing malware family that is widely advertised for](https://malpedia.caad.fkie.fraunhofer.de/details/win.redline_stealer)\nsale within underground forums.\n```\nDomain Name: windows-upgraded.com\nCreation Date: 2022-01-27T10:06:46Z\nRegistrar: NICENIC INTERNATIONAL GROUP CO., LIMITED\nRegistrant Organization: Ozil Verfig\nRegistrant State/Province: Moscow\nRegistrant Country: RU\n\n```\nThe attackers copied the design of the legitimate Windows 11 website, except clicking on the “Download Now” button\ndownloads a suspicious zip archive called Windows11InstallationAssistant.zip. The file was hosted on Discord’s content\ndelivery network.\n\n\n-----\n\nFigure 1 – Fake Windows 11 website hosted on windows-upgraded[.]com.\n\n## File Analysis\n\n_Windows11InstallationAssistant.zip is only 1.5 MB and contains six Windows DLLs, an XML file and a portable_\nexecutable.\n\nFigure 2 – Zip archive contents.\n\nAfter decompressing the archive, we get a folder with a total size of 753 MB. The executable\n_Windows11InstallationAssistant.exe was the largest file at 751 MB._\n\nFigure 3 – File sizes after decompression.\n\n\n-----\n\nSince the compressed size of the zip file was only 1.5 MB, this means it has an impressive compression ratio of 99.8%.\n[This is far larger than the average zip compression ratio for executables of 47%. To achieve such a high compression](https://support.winzip.com/hc/en-us/articles/115011987668-Varying-File-Compression-Explored)\nratio, the executable likely contains padding that is extremely compressible. Viewed in a hex editor, this padding is easily\nspotted (Figure 4).\n\nFigure 4 – 0x30 filler area inside Windows11InstallationAssistant.exe.\n\nA large part of the file is padded with 0x30 bytes and is irrelevant to run the file. Since many sandboxes and other\nmalware analysis tools are unable to process very large files, we must either analyze the file manually or shrink it to a\nreasonable size. The large filler area is located at the end of the file just before the file signature. Due to a digest\nmismatch, the signature verification results in an error, which is why we did not include it further in the analysis. By\ntruncating the filler area as well as the signature, we obtain a valid portable executable. One reason why the attackers\nmight have inserted such a filler area, making the file very large, is that files of this size might not be scanned by an antivirus and other scanning controls, thereby increasing the chances the file can execute unhindered and install the\nmalware. Figure 5 shows the sections of the executable after removing the padding.\n\n\n-----\n\n[Figure 5 – File sections of Windows11InstallationAssistant.exe (padding removed) viewed in PE-bear.](https://hshrzd.wordpress.com/pe-bear/)\n\n## Dynamic Analysis\n\nWe can now analyze this file dynamically in a sandbox or with static malware analysis tools. Immediately after execution,\nthe malware starts a PowerShell process with an encoded argument. This causes a cmd.exe process to be launched\nwith a timeout of 21 seconds. Once this timeout expires, the initial process downloads a file named win11.jpg from a\nremote web server (Figure 6).\n\n\n-----\n\nFigure 6 – Process execution leading to RedLine Stealer.\n\nRunning the file utility against win11.jpg fails to identify its file type, suggesting that it is encoded or encrypted. However,\nopening the file in a text editor revealed that the contents are simply stored in reverse order.\n\nFigure 7 – Reversed DLL file viewed in a text editor.\n\nOnce the contents of the file are reversed, we get a dynamic link library (DLL). This DLL is loaded by the initial process,\nwhich executes itself again then replaces the current thread context with the downloaded DLL. This is the RedLine\nStealer payload, a classic information stealer. It collects various information about the current execution environment,\nsuch as the username, computer name, installed software and hardware information. The malware also steals stored\npasswords from web browsers, auto-complete data such as credit card information, as well as cryptocurrency files and\nwallets. To exfiltrate information or receive further instructions, RedLine Stealer opens a TCP connection to a configured\ncommand and control (C2) server, in this case 45.146.166[.]38:2715.\n\n## Links to December 2021 RedLine Stealer Campaign\n\nThe tactics, techniques and procedures (TTPs) in this RedLine Stealer campaign are similar to a campaign we analyzed\nin December 2021. In that campaign, the malicious actor registered discrodappp[.]com, which they used to serve\nRedLine Stealer disguised as an installer for the popular messaging app. In both campaigns, the threat actor used fake\nwebsites mimicking popular software to trick users into installing their malware, registered the domains using the same\ndomain registrar, used the same DNS servers, and delivered the same family of malware.\n\n\n-----\n\nFigure 8 – Fake Discord website distributing RedLine Stealer, December 2021.\n\n## Conclusion\n\nThis campaign highlights once again how attackers are quick to take advantage of important, relevant and interesting\ncurrent events to create effective lures. Prominent announcements and events are always interesting topics for threat\nactors, which can be exploited to spread malware. Since such campaigns often rely on users downloading software from\nthe web as the initial infection vector, organizations can prevent such infections by only downloading software from\ntrustworthy sources.\n\n## Indicators of Compromise\n\n**Files**\n\nWindows11InstallationAssistant.zip\n\n4293d3f57543a41005be740db7c957d03af1a35c51515585773cedee03708e54\n\nWindows11InstallationAssistant.exe\n\nb50b392ccb07ed7a5da6d2f29a870f8e947ee36c43334c46c1a8bb21dac5992c\n\nWindows11InstallationAssistant.exe – no filler area\n\n7d5ed583d7efe318fdb397efc51fd0ca7c05fc2e297977efc190a5820b3ee316\n\nwin11.jpg\n\nc7bcdc6aecd2f7922140af840ac9695b1d1a04124f1b3ab1450062169edd8e48\n\nwin11_reversed.dll\n\n6b089a4f4fde031164f3467541e0183be91eee21478d1dfe4e95c4a0bb6a6578\n\n\n-----\n\n**Network connections**\n\nwindows-upgraded[.]com\n\nhxxps://cdn.discordapp[.]com/attachments/928009932928856097/936319550855716884/Windows11InstallationAssistant.zip\n\nhxxp://81.4.105[.]174/win11.jpg\n\n45.146.166[.]38:2715\n\nTags\n\n[redline stealer](https://threatresearch.ext.hp.com/blog/?post-tag=redline%20stealer) [windows 11](https://threatresearch.ext.hp.com/blog/?post-tag=windows%2011)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-08 - Attackers Disguise RedLine Stealer as a Windows 11 Upgrade.pdf"
    ],
    "report_names": [
        "2022-02-08 - Attackers Disguise RedLine Stealer as a Windows 11 Upgrade.pdf"
    ],
    "threat_actors": [
        {
            "id": "059b16f8-d4e0-4399-9add-18101a2fd298",
            "created_at": "2022-10-25T15:50:23.29434Z",
            "updated_at": "2025-03-27T02:00:55.431907Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Evilnum"
            ],
            "source_name": "MITRE:Evilnum",
            "tools": [
                "More_eggs",
                "EVILNUM",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "39ea99fb-1704-445d-b5cd-81e7c99d6012",
            "created_at": "2022-10-25T16:07:23.601894Z",
            "updated_at": "2025-03-27T02:02:09.882982Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Jointworm",
                "Operation Phantom in the [Command] Shell",
                "TA4563"
            ],
            "source_name": "ETDA:Evilnum",
            "tools": [
                "Bypass-UAC",
                "Cardinal RAT",
                "ChromeCookiesView",
                "EVILNUM",
                "Evilnum",
                "IronPython",
                "LaZagne",
                "MailPassView",
                "More_eggs",
                "ProduKey",
                "PyVil",
                "PyVil RAT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraPreter",
                "TerraStealer",
                "TerraTV"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535820,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653764969,
    "ts_modification_date": 1653764969,
    "files": {
        "pdf": "https://archive.orkl.eu/809525e9d0a76f7c32810a397229a43b6cc0c75d.pdf",
        "text": "https://archive.orkl.eu/809525e9d0a76f7c32810a397229a43b6cc0c75d.txt",
        "img": "https://archive.orkl.eu/809525e9d0a76f7c32810a397229a43b6cc0c75d.jpg"
    }
}