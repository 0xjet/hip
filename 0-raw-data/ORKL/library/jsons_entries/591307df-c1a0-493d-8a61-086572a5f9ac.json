{
    "id": "591307df-c1a0-493d-8a61-086572a5f9ac",
    "created_at": "2023-06-05T02:06:35.965931Z",
    "updated_at": "2025-03-27T02:16:22.906678Z",
    "deleted_at": null,
    "sha1_hash": "df172ac098fbd6c47cf42e057707976415d1e3fc",
    "title": "2023-05-02 - IcedID Malware- Traversing Through its Various Incarnations",
    "authors": "",
    "file_creation_date": "2023-06-04T12:39:13Z",
    "file_modification_date": "2023-06-04T12:39:13Z",
    "file_size": 677201,
    "plain_text": "# IcedID Malware: Traversing Through its Various Incarnations\n\n**[research.loginsoft.com/threat-research/icedid-malware-traversing-through-its-various-incarnations/](https://research.loginsoft.com/threat-research/icedid-malware-traversing-through-its-various-incarnations/)**\n\nMay 02, 2023\n\nBy System-41 Team\n\n**Executive Summary**\n\n\nMay 2, 2023\n\n\nIcedID, the notorious malware, is actively involved in several delivery campaigns,\ndemonstrating versatility and adaptability.\nThe latest IcedID variants indicate the malware’s continuous evolution, and the need\nfor robust cybersecurity measures.\nSurging use of IcedID in order to deploy ransomware makes it a significant threat to\norganizations worldwide.\nIcedID stays true to its roots, employing consistent Tactics, Techniques, and\nProcedures (TTPs) across various campaigns over the year.\nTidal Cyber’s visibility and features provide a better landscape for identifying and\nunderstanding TTPs.\nOsquery rules by Loginsoft published on Tidal Cyber’s platform will bolster your\norganization’s security posture.\n\n**Evolution & Variants**\n\nContinuously active since its initial appearance, IcedID has no periods of dormancy. Using\nvarious delivery mechanisms, and evolutionary strategies, IceID serves as an exemplary\nmodel for other malware. Widely observed in countries like the United States, United\nKingdom and Canada, where the Threat Actors (TAs) not only targeted financial Institutions\nbut also ecommerce, payment, and telecommunication industries. In recent years, these\nthreat actors repurposed IcedID’s functionality, transforming it from a banking Trojan to a\nransomware detonator. As a result, many TAs added IcedID to their arsenal, while most TAs\nstill prefer the standard variant of the malware. The standard IcedID variant propagates\nthrough emails with diverse attachments like html files, zip files, iso images and more.\n\nIn March of 2023, [Proofpoint reported the discovery of two new variations of IcedID.](https://www.proofpoint.com/us/blog/threat-insight/fork-ice-new-era-icedid)\nDetected in November 2022 as part of the Emotet malware campaign, the first novel variant\nlacked certain features, making it lightweight and difficult to detect. The second new variant,\nobserved in February 2023, bore a strong resemblance to the standard edition, and mainly\n[propagated through phishing emails with OneNote attachments.](https://research.loginsoft.com/threat-research/from-innocence-to-malice-the-onenote-malware-campaign-uncovered/)\n\n**Malware Progression**\n\n\n-----\n\n**[ICEDID CAMPAIGN – 2021](https://app.tidalcyber.com/share/8b7899cd-6e13-48b0-91b5-82f697d8141a?utm_campaign=CTI%20Content%202022-23&utm_source=loginsoft&utm_medium=blog)**\n\n_Figure: IcedID 2021 Distribution Chain_\nOur observations reveal that TA551 employed several tactics to distribute malicious payloads\nvia email, including office files with malicious macros. Another variant of this campaign used\nan archived JavaScript file that downloads the IcedID DLL, and masquerades with .jpg or\n.png extension to evade detection. The execution of the IcedID DLL, accomplished by\nexecuting Rundll32 LOLBin with an uncommon DllRegisterServer parameter, establishes\ncommunication with the attacker’s command and control (C2) server.\n\n**[ICEDID CAMPAIGN – 2022](https://app.tidalcyber.com/share/64337eee-bfaa-4411-b862-55e508f6d3be?utm_campaign=CTI%20Content%202022-23&utm_source=loginsoft&utm_medium=blog)**\n\n\n-----\n\n_Figure: IcedID 2022 Distribution Chain_\nTAs began disseminating malware through ISO files sent via email. Once clicked, the\nshortcut file executes the IcedID payload using regsvr32 or rundll32 LOLBin, bypassing\nMoTW flag. Upon execution of the IcedID DLL, the malware performed discovery tasks\nthrough Windows utilities like systeminfo, ipconfig, net, and nltest. A Cobalt Strike beacon\n[was then deployed, and hands-on-keyboard activities were observed executing AdFind to](https://www.joeware.net/freetools/tools/adfind/)\n[perform enumeration. IcedID obtained credentials by accessing LSASS memory, using the](https://app.tidalcyber.com/capability/cc5b3d24-4c00-54eb-9364-24354e6b39e4-Abnormal%20LSASS%20Child%20and%20Parent%20Process%20Relationships?utm_campaign=CTI%20Content%202022-23&utm_source=loginsoft&utm_medium=blog)\ncredentials to establish RDP connections within the network. Subsequently, the TAs initiated\na ransomware attack after gaining access to the compromised network.\n\nAdditionally, in the same year, the TAs spread IcedID malware via Google Ads by creating\nfake software installer pages. Some variations of IcedID were also found to use Dark VNC as\na backdoor.\n\n**[ICEDID CAMPAIGN – 2023](https://app.tidalcyber.com/share/8e3a3aaf-bbda-4e1b-83e4-447c0b1bd5be?utm_campaign=CTI%20Content%202022-23&utm_source=loginsoft&utm_medium=blog)**\n\n\n-----\n\n_Figure: IcedID 2023 Distribution Chain_\nIn 2023, TAs launched various IcedID malware distribution campaigns, but quickly\nconsolidated due to their common delivery method, phishing emails. Initially, emails\n[contained ISO files as attachments, later the TAs switched to OneNote, and PDFs, to spread](https://app.tidalcyber.com/capability/7da10280-0b82-5727-97bf-ee236e879adb-OneNote%20Attachment%20File%20Dropped%20in%20Suspicious%20Location?utm_campaign=CTI%20Content%202022-23&utm_source=loginsoft&utm_medium=blog)\nthe malware.\n\nThe IcedID infection started when the user clicked on the malicious file, which then executed\n[the IcedID DLL. In some cases, it created a scheduled task to run the malware. Once the](https://app.tidalcyber.com/capability/a5ff66c5-448c-59d3-b2cc-ef27549b8cee-Suspicious%20Scheduled%20Task%20Creation%20to%20execute%20LOLbins?utm_campaign=CTI%20Content%202022-23&utm_source=loginsoft&utm_medium=blog)\npatient-zero machine was infected, the malware began enumerating to escalate privileges\nand move laterally across the network. After gaining access to all the machines, including the\nAD server, the threat actors detonated the ransomware.\n\nKnown cases where IcedID executed quantum ransomware, surprised many. Despite the\nchange in behaviour of the malware, from a banking trojan to a ransomware deployer using\nmany tactics, techniques and procedures (TTPs) were common.\n\n**Visibility Through Tidal**\n\n[For better visibility of all three campaigns, we used Tidal Cyber’s Community Edition to map](https://app.tidalcyber.com/?utm_campaign=CTI%20Content%202022-23&utm_source=loginsoft&utm_medium=blog)\nthe TTPs. Tidal Cyber is a defense platform utilizing threat intelligence to help cybersecurity\nteams promptly, and effortlessly, identify and address potential security incidents. The\n\n\n-----\n\nplatform incorporates osquery from Loginsoft, detecting security threats and allowing users\nto research, and create, threat profiles. This results in Tidal Cyber enabling defenders to take\ninformed defensive measures by prioritizing relevant threats.\n\n[The image below displays a matrix that covers the TTPs of the IcedID malware campaign](https://app.tidalcyber.com/share/63516261-6516-4a24-b28f-9d9e3976eb6b?utm_campaign=CTI%20Content%202022-23&utm_source=loginsoft&utm_medium=blog)\nfrom the past three years.\n\n_Figure: Tidal Cyber’s Navigation Layer_\nLoginsoft uploaded osquery rules on the Tidal platform, which can be used to detect\n[malicious activities based on TTPs. Access these rules here.](https://app.tidalcyber.com/products/6db010c7-203b-5eac-bff5-b3e82effdaa5-System-41?utm_campaign=CTI%20Content%202022-23&utm_source=loginsoft&utm_medium=blog)\n\n## Osquery Rules To Detect IcedID Activity\n\nBelow are specific osquery rules to help defend against the malicious behaviours exhibited\nby IcedID malware.\n\n**Detects** **suspicious hidden files from the mounted drive**\n\n\n-----\n\n```\nSELECT \n\n  atime, \n\n  btime, \n\n  ctime, \n\n  device, \n\n  directory, \n\n  path, \n\n  filename, \n\n  file_id,\n\n  attributes\n\nFROM file\n\nJOIN (SELECT device_id FROM logical_drives where file_system = 'UDF') AS drives\n\nON directory LIKE device_id || '\\%' \n\nAND \n\n( \n\n  path LIKE '%.dll' \n\n  OR path LIKE '%.bat' \n\n  OR path LIKE '%.cmd'  \n\n  OR path LIKE '%.dat' \n\n) \n\nAND attributes LIKE '%H%';\n\n```\n**Detects** **the use of windows binary Regsvr32 making a network connection**\n```\nSELECT\n\n ps.name AS process_name,\n\n ps.pid AS process_id,\n\n ps.cmdline AS process_cmdline,\n\n pos.local_address AS local_address,\n\n pos.local_port AS local_port,\n\n pos.remote_address AS remote_address,\n\n pos.remote_port AS remote_port\n\nFROM processes ps, process_open_sockets pos\n\nWHERE ps.pid = pos.pid\n\nAND LOWER(ps.name) = 'regsvr32.exe';\n\n\n```\n**Detects** **named pipes used by CobaltStrike**\n\n\n-----\n\n```\nSELECT\n\n p.name as process_name,\n\n p.pid as process_pid,\n\n p.path as process_path,\n\n p.cmdline as process_cmdline,\n\n pipes.name as pipe_name,\n\n pipes.instances as pipe_instances,\n\n pipes.flags as pipe_flags\n\nFROM processes p, pipes\n\nWHERE p.pid = pipes.pid\n\nAND\n\n(\n\n LOWER(pipe_name) LIKE 'msagent_%'\n\n OR LOWER(pipe_name) LIKE 'interprocess_%'\n\n OR LOWER(pipe_name) LIKE 'sarpc_%'\n\n OR LOWER(pipe_name) LIKE 'samr_%'\n\n OR LOWER(pipe_name) LIKE 'netlogon_%'\n\n OR LOWER(pipe_name) LIKE 'wkssvc_%'\n\n OR LOWER(pipe_name) LIKE 'srvsvc_%'\n\n OR LOWER(pipe_name) LIKE 'mojo_%'\n\n OR LOWER(pipe_name) LIKE 'postex%'\n\n OR LOWER(pipe_name) LIKE 'status_%'\n\n OR LOWER(pipe_name) LIKE 'msse-%'\n\n);\n\n```\n**Threat Bites**\n\n**Threat Actor**\n\n**Targeted Country**\n\n**Targeted Industry**\n\n**First Seen**\n\n**Last Seen**\n\n**LOLBAS**\n\n**Backdoor**\n\n**Telemetry**\n\n**Samples**\n\n:\n\n:\n\n:\n\n\n-----\n\n:\n\n:\n\n:\n\n:\n\n:\n\n:\n\nTA578, TA551, TA577, TA544, TA581, TA542\n\nUS, UK, Canada, Italy\n\nFinancial Institution, Ecommerce, Payment, Telecommunication\n\n2017\n\n2023\n\nRundll32, Regsvr32, Wmic\n\nDark VNC, Anubis VNC, Keyhole VNC\n\nSysmon, Security, Windefend, PowerShell\n\n[https://bazaar.abuse.ch/browse/tag/IcedID/](https://bazaar.abuse.ch/browse/tag/IcedID/)\n\n**References**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-02 - IcedID Malware- Traversing Through its Various Incarnations.pdf"
    ],
    "report_names": [
        "2023-05-02 - IcedID Malware- Traversing Through its Various Incarnations.pdf"
    ],
    "threat_actors": [
        {
            "id": "26a04131-2b8c-4e5d-8f38-5c58b86f5e7f",
            "created_at": "2022-10-25T15:50:23.579601Z",
            "updated_at": "2025-03-27T02:00:55.50292Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "TA551",
                "GOLD CABIN",
                "Shathak"
            ],
            "source_name": "MITRE:TA551",
            "tools": [
                "QakBot",
                "IcedID",
                "Valak",
                "Ursnif"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e8e18067-f64b-4e54-9493-6d450b7d40df",
            "created_at": "2022-10-25T16:07:24.515213Z",
            "updated_at": "2025-03-27T02:02:10.267637Z",
            "deleted_at": null,
            "main_name": "Mummy Spider",
            "aliases": [
                "ATK 104",
                "Gold Crestwood",
                "Mummy Spider",
                "TA542"
            ],
            "source_name": "ETDA:Mummy Spider",
            "tools": [
                "Emotet",
                "Geodo",
                "Heodo"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04e34cab-3ee4-4f06-a6f6-5cdd7eccfd68",
            "created_at": "2022-10-25T16:07:24.578896Z",
            "updated_at": "2025-03-27T02:02:10.286803Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "Gold Cabin",
                "Monster Libra",
                "Shathak",
                "TA551"
            ],
            "source_name": "ETDA:TA551",
            "tools": [
                "BokBot",
                "CRM",
                "Gozi",
                "Gozi CRM",
                "IceID",
                "IcedID",
                "Papras",
                "Snifula",
                "Ursnif",
                "Valak",
                "Valek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "90f216f2-4897-46fc-bb76-3acae9d112ca",
            "created_at": "2023-01-06T13:46:39.248936Z",
            "updated_at": "2025-03-27T02:00:03.031127Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "Shakthak",
                "TA551",
                "ATK236",
                "G0127",
                "Monster Libra"
            ],
            "source_name": "MISPGALAXY:GOLD CABIN",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "62585174-b1f8-47b1-9165-19b594160b01",
            "created_at": "2023-01-06T13:46:39.369991Z",
            "updated_at": "2025-03-27T02:00:03.065156Z",
            "deleted_at": null,
            "main_name": "TA578",
            "aliases": [],
            "source_name": "MISPGALAXY:TA578",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c91f7778-69aa-45fa-be0e-4ee33daf8fbd",
            "created_at": "2023-01-06T13:46:39.110148Z",
            "updated_at": "2025-03-27T02:00:02.998873Z",
            "deleted_at": null,
            "main_name": "NARWHAL SPIDER",
            "aliases": [
                "GOLD ESSEX",
                "TA544"
            ],
            "source_name": "MISPGALAXY:NARWHAL SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b4f83fef-38ee-4228-9d27-dde8afece1cb",
            "created_at": "2023-02-15T02:01:49.569611Z",
            "updated_at": "2025-03-27T02:00:03.114739Z",
            "deleted_at": null,
            "main_name": "TA577",
            "aliases": [
                "Hive0118"
            ],
            "source_name": "MISPGALAXY:TA577",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "506404b2-82fb-4b7e-b40d-57c2e9b59f40",
            "created_at": "2023-01-06T13:46:38.870883Z",
            "updated_at": "2025-03-27T02:00:02.939775Z",
            "deleted_at": null,
            "main_name": "MUMMY SPIDER",
            "aliases": [
                "TA542",
                "GOLD CRESTWOOD"
            ],
            "source_name": "MISPGALAXY:MUMMY SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1f679d2e-c5c9-49e9-b854-2eca06a870e4",
            "created_at": "2022-10-25T16:07:24.453427Z",
            "updated_at": "2025-03-27T02:02:10.237233Z",
            "deleted_at": null,
            "main_name": "Bamboo Spider",
            "aliases": [
                "Bamboo Spider",
                "TA544"
            ],
            "source_name": "ETDA:Bamboo Spider",
            "tools": [
                "AndroKINS",
                "Bebloh",
                "Chthonic",
                "DELoader",
                "Dofoil",
                "GozNym",
                "Gozi ISFB",
                "ISFB",
                "Nymaim",
                "PandaBanker",
                "Pandemyia",
                "Sharik",
                "Shiotob",
                "Smoke Loader",
                "SmokeLoader",
                "Terdot",
                "URLZone",
                "XSphinx",
                "ZLoader",
                "Zeus OpenSSL",
                "Zeus Panda",
                "Zeus Sphinx",
                "ZeusPanda",
                "nymain"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "40b623c7-b621-48db-b55b-dd4f6746fbc6",
            "created_at": "2024-06-19T02:03:08.017681Z",
            "updated_at": "2025-03-27T02:05:17.342829Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "TA551 ",
                "Shathak"
            ],
            "source_name": "Secureworks:GOLD CABIN",
            "tools": [
                ""
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2ac83159-1d9d-4db4-a176-97be6b7b07c9",
            "created_at": "2024-06-19T02:03:08.024653Z",
            "updated_at": "2025-03-27T02:05:17.348806Z",
            "deleted_at": null,
            "main_name": "GOLD CRESTWOOD",
            "aliases": [
                "TA542 ",
                "Mummy Spider "
            ],
            "source_name": "Secureworks:GOLD CRESTWOOD",
            "tools": [
                "Emotet"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "22d450bb-fc7a-42af-9430-08887f0abf9f",
            "created_at": "2024-11-01T02:00:52.560354Z",
            "updated_at": "2025-03-27T02:00:55.425961Z",
            "deleted_at": null,
            "main_name": "TA577",
            "aliases": [
                "TA577"
            ],
            "source_name": "MITRE:TA577",
            "tools": [
                "Pikabot",
                "QakBot",
                "Latrodectus"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "52eb5fb6-706b-49c0-9ba5-43bea03940d0",
            "created_at": "2024-11-01T02:00:52.694476Z",
            "updated_at": "2025-03-27T02:00:55.51014Z",
            "deleted_at": null,
            "main_name": "TA578",
            "aliases": [
                "TA578"
            ],
            "source_name": "MITRE:TA578",
            "tools": [
                "Latrodectus",
                "IcedID"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1685930795,
    "ts_updated_at": 1743041782,
    "ts_creation_date": 1685882353,
    "ts_modification_date": 1685882353,
    "files": {
        "pdf": "https://archive.orkl.eu/df172ac098fbd6c47cf42e057707976415d1e3fc.pdf",
        "text": "https://archive.orkl.eu/df172ac098fbd6c47cf42e057707976415d1e3fc.txt",
        "img": "https://archive.orkl.eu/df172ac098fbd6c47cf42e057707976415d1e3fc.jpg"
    }
}