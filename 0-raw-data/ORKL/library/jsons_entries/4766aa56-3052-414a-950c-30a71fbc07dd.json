{
    "id": "4766aa56-3052-414a-950c-30a71fbc07dd",
    "created_at": "2022-10-25T16:48:22.245315Z",
    "updated_at": "2025-03-27T02:17:02.258029Z",
    "deleted_at": null,
    "sha1_hash": "a2eda1118a65efba6df93feb42bdd785989cb7ca",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-01-27T08:27:02Z",
    "file_modification_date": "2021-01-27T17:35:59Z",
    "file_size": 2933373,
    "plain_text": "# “LuoYu”\n\n###### The eavesdropper sneaking in multiple platforms\n\n Leon & Shui\n\n\n-----\n\n###### Speakers’ Bio\n\n\n###### Shui is a cyber threat Analyst working for TeamT5. Holding a master’s degree from Johns Hopkins SAIS, she has a keen eye for international affairs. She mainly works on Cyber Espionage campaign tracking and involves in the underground market research.\n\n\n###### Leon is a cyber threat analyst in the Cyber Threat Intelligence team at TeamT5. His major areas of research include APT campaign tracking, malware analysis. He has participated in information security diagnosis services for government and financial institutions and research on vulnerabilities in IoT devices in the past.\n\n\n-----\n\n### AGENDA\n\n###### 01 The Luoyu Threat Group Overview\n\n 02 Activity Timeline\n\n 03 ReverseWindow Analysis\n\n 04 Case Study\n\n 05 Key Takeaway\n\n\n-----\n\n###### The Luoyu Group Overview\n\n\n-----\n\n### The name: 蠃魚(Luoyu)\n\nu\n###### 蠃魚(LuoYu) a Chinese mythological creature\n\nu\n###### 蠃魚，魚身而鳥翼，音如鴛鴦，見則其邑大水。\n\nu\n###### Translation: Fish with a pair of wings; When it appears, floods always follow.\n\n\n-----\n\n###### Origin\n\n China\n\n Malware\n\n ReverseWindow\n\n\n###### WinDealer SpyDealer\n\n\n###### Target Industry\n\n Profile Technology Media Education\n\n Target Areas\n\n**China** **Hong Kong** **Japan** **Korea** **Taiwan**\n\n\n-----\n\n### Goal\n\n\n###### Attack\n\n\n###### Message Apps Collecting information from dissidents?\n\n\n-----\n\n###### Activity Timeline\n\n\n-----\n\n### 2014-2017 China focused\n\n###### 2016 2017 2014 2015\n\n\n###### Spying apps circulating in the wild\n\n\n###### Android malware spying on Apps\n\n A d\n\n\n-----\n\n### 2017- now: Expand to East Asia\n\n###### Jun. 2017 May. 2019\n\n\n###### IT company in China\n\n\n###### Apr. 2017\n\n\n###### University in Hong Kong\n\n 2019\n\n\n###### IT company in Taiwan, Japan, and South Korea\n\n\n###### Watering Hole Attack against Chinese Website\n\n\n-----\n\n###### Malware profile: ReverseWindow\n\n\n-----\n\n###### Malware profile: ReverseWindow\n\nu ReverseWindow(aka sysetmd, OSX.Demsty) is a multi-platform malware,\n###### it supports Windows, Linux, Mac, Android.\n\nu Create mutex string prefix “LOOTWODNIW” is the reverse of “WINDOWTOOL”.\n\nu Use DES algorithm for configuration decryption and data encryption.\n\nu Uses TLV(type-length-value) protocol to send and receive data.\n\n\n-----\n\n###### Evolution of ReverseWindow\n\n\n-----\n\n###### Evolution of ReverseWindow\n\n IT company in Taiwan, Japan, IT company in China and South Korea\n\n University researcher in Hong Kong\n\n Android app\n\n\n###### 1.1.6 1.1.7\n\n Apr. 2017\n\n\n###### 1.2.1 1.2.27 0.997 1.3.3d\n\n\n###### 2.2.1905131\n\n Nov. 2019\n\n\n###### 2.2.1911271\n\n Mar. 2020\n\n\n###### May. 2017 Jul. 2017\n\n\n###### Jan. 2019 May. 2019\n\n\n###### 2.2.19102123\n\n Aug. 2019\n\n\n###### 2.2.2006131\n\n Dec. 2020\n\n\n-----\n\n###### In-Depth Analysis of ReverseWindow\n\n\n-----\n\n###### Hide the malicious traces\n\nu At first run, ReverseWindow will make the user think that the file was corrupted.\n\nu Persistence method:\n\nu Copy self to ” ~/.local/bin/sysetmd”, write .bashrc and create cronjob.\n\n###### OSX\n\n Linux\n\n\n-----\n\n###### Decrypt malware C&C configuration\n\n\n###### Config head signature (16 bytes)\n\n\n###### Encrypted Malware Encrypted Config block Config\n\n\n###### malware Configuration\n\n\n###### DES_ECB_decrypt\n\n\n###### ReverseWindow\n\n\n###### config size (2 Bytes) AA BB CC DD\n\n|w|Col2|\n|---|---|\n\n\n-----\n\n###### Decrypt malware C&C configuration\n\nu\n###### Test Sample C2:192.168.8.107:10443\n\n type length value\n\n\n###### malware Configuration\n\n\n-----\n\n###### Collecting host information\n\nu Hostname\n\nu Operating System Version\n\nu User name\n\nu MAC address and IP address (IPv6,IPv4)\n\nu CPU info\n\nu the amount of physical RAM\n\nu External IP address\n\nu Hard drive volume name (Windows only)\n\nu Removable device file (Windows only)\n\n\n-----\n\n###### Collecting host information\n\nu The victim information is arranged by TLV(type-length-value) format.\n\nu\n###### ReverseWindow encrypts victim data using DES algorithm with hard-coded key table.\n\n head signature Index Size Data\n Index Size Data\n\n\n###### 1 byte 4 bytes\n\n\n###### . . .\n\n\n###### DES_encrypt\n\n\n###### Encrypted victim data\n\n\n-----\n\n###### Collecting host information\n\n Send Beacon\n\n response\n\n Send victim infomation\n\n ReverseWindow Send command\n\n\n###### C2 Server\n\n\n###### C2 Server\n\n\n-----\n\n###### Custom ReverseWindow Android APK\n\nu In 2019, LuoYu actor developed an Android variant of ReverseWindow.\n\nu We found that the attacker disguised the apk as a popular messaging app.\n\nu The actor also added another custom-developed spying library to the apk.\n\nu Unfortunately, currently, we are unsure how the actor spread the malware.\n\n\n-----\n\n###### Custom ReverseWindow Android APK\n\n\n###### Install\n\n\n###### Load library Connect to C2\n\n Malicious APK ReverseWindow ELF\n\n\n###### C2 Server\n\n\n###### C2 Server\n\n\n###### decrypt config\n\n\n###### Collect sensitive data\n\n Custom spying library\n\n\n###### Config file\n\n\n-----\n\n###### Version changes\n\n\n###### Windows 1.2.27\n\n OSX 1.2.1\n\n Windows 2.2.*\n\n Windows 2.2.1905131\n\n Windows 2.2.2006131\n\n\n###### The command Protocol 0x0100(install Persistence) was only supported in Windows(1.2.27)\n\n Support proxy setting\n\n String obfuscation Stack string & GetProcessAddress to get WinAPI\n\n ReverseWindow interest in two popular messaging app and three popular browsers in China (360SE, 360chrome, SougouExplorer)\n\n Support networking status\n\n\n-----\n\n###### Command Details\n\n\n###### Common\n\n|etails|Col2|\n|---|---|\n|Command code|Description|\n|0x0200|File Operations|\n|0x0300|Shell Command|\n|0x0400|update RAT|\n|0x0500|Uninstall RAT|\n\n\n###### 0x0800 Update malware Config\n\n\n-----\n\n###### Command Details\n\n\n###### Common\n\n|etails|Col2|\n|---|---|\n|Command code|Description|\n|0x0900|(Linux)install plug-in | (Windows)execute a file|\n|0x0A00|(Windows only) Screenshot|\n|0x0B00|Proxy|\n|0x1200|(Windows only) Enumerate process, Netstat|\n\n\n-----\n\n###### Command Details\n\n|d Details|Col2|Col3|\n|---|---|---|\n|Command code|Description||\n|0x0900|(Windows) execute a file||\n|0x0A00|Screenshot||\n\n\n###### Common\n\n\n###### expatriate\n\n dissident\n\n\n-----\n\n###### Command Details\n\n\n###### Android\n\n|etails|Col2|\n|---|---|\n|Command code|Description|\n|0x0700|setTransType|\n|0x0A00|setCaptureScreen|\n|0x0F00|setRecordConfig|\n|0x1000|setSMSConfig|\n\n\n###### 0x1100 setCallLogConfig\n\n\n-----\n\n###### Targeted attack\n\n Collect data\n\n ReverseWindow\n\n Over the wall\n\n Chi G i ll\n\n\n###### Control\n\n C2 Server\n\n\n###### dissident Chinese\n\n Victim host\n\n\n###### Monitor\n\n Notify\n\n\n###### Check installed app\n\n 1. Three popular browsers in China 2. Two messaging apps 3. Proxy Setting\n\n\n-----\n\n###### Targeted attack\n\n implant\n\n ReverseWindow\n\n\n###### Expatriate\n\n Victim host\n\n\n###### upload VPN profiles\n\n\n###### Control\n\n C2 Server\n\n lateral movement\n\n\n###### Collect VPN profiles\n\n connect\n\n\n-----\n\n###### Case Study\n\n\n-----\n\n### Watering hole attack\n\nu\n###### Compromised a Chinese news site based in the US\n\n\n###### Compromised a Chinese news site based in the US\n\n\n-----\n\n### Watering hole attack\n\nu\n###### Malicious Files disguised as legitimate programs\n\n qq.exe\n\n youku.exe\n\n\n###### WinDealer\n\n\n-----\n\n### More APKs found\n\n###### C2 Server\n\n\n-----\n\n### IT company in East Asia\n\n###### 2017 2019\n\n ReverseWindow ReverseWindow\n\n\n-----\n\n### Messaging Apps Focused\n\n\n###### 2017&2019 Attack IT companies in East Asia\n\n\n-----\n\n##### g messaging apps\n\nu\n###### The 2019 attack overlapped with Hong Kong anti-extradition bill protest\n\n To collect protesters’ information?\n\n\n-----\n\n###### Before 2017\n\nu\n###### Monitoring messaging apps of individual users\n\n\n###### After 2017\n\nu Monitoring messaging apps of individual\n###### users\n\nu Attack the IT company which develops apps\n###### for direct user information?\n\n\n-----\n\n##### Threat for both users and company\n\n\n###### Installed\n\n ReverseWindow apk Personal Mobile & SpyDealer\n\n Installed\n\n ReverseWindow\n\n\n###### Collect personal messages\n\n Collect user information\n\n\n-----\n\n#### Key Takeaway\n\n\n-----\n\n###### Key Takeaway\n\n u Luoyu is a well-developed Chinese APT.\n\n u Its cyber attacks have started since 2014\n\nu Keep developing malware crossing multi-platform\n\nu Monitoring expatriate and dissident\n\n###### u It has expanded its target scope.\n\nu China’s neighbor countries\n\nu Against IT companies\n\n\n-----\n\n## THANK YOU!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://jsac.jpcert.or.jp/archive/2021/pdf/JSAC2021_301_shui-leon_en.pdf"
    ],
    "report_names": [
        "JSAC2021_301_shui-leon_en.pdf"
    ],
    "threat_actors": [
        {
            "id": "b72c2616-cc7c-4c47-a83d-6b7866b94746",
            "created_at": "2023-01-06T13:46:39.425297Z",
            "updated_at": "2025-03-27T02:00:03.08718Z",
            "deleted_at": null,
            "main_name": "Red Nue",
            "aliases": [
                "LuoYu"
            ],
            "source_name": "MISPGALAXY:Red Nue",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1611736022,
    "ts_modification_date": 1611768959,
    "files": {
        "pdf": "https://archive.orkl.eu/a2eda1118a65efba6df93feb42bdd785989cb7ca.pdf",
        "text": "https://archive.orkl.eu/a2eda1118a65efba6df93feb42bdd785989cb7ca.txt",
        "img": "https://archive.orkl.eu/a2eda1118a65efba6df93feb42bdd785989cb7ca.jpg"
    }
}