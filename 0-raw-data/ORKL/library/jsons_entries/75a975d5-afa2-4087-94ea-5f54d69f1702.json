{
    "id": "75a975d5-afa2-4087-94ea-5f54d69f1702",
    "created_at": "2023-01-12T15:05:39.469929Z",
    "updated_at": "2025-03-27T02:13:12.192884Z",
    "deleted_at": null,
    "sha1_hash": "535cd0406f95903b503892d8e36fb8c1fb82ef2b",
    "title": "2021-07-09 - Hancitor tries XLL as initial malware file",
    "authors": "",
    "file_creation_date": "2022-05-28T00:22:39Z",
    "file_modification_date": "2022-05-28T00:22:39Z",
    "file_size": 3436000,
    "plain_text": "# SANS ISC: InfoSec Handlers Diary Blog - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training InfoSec Handlers Diary Blog\n\n**isc.sans.edu/diary/rss/27618**\n\n## Hancitor tries XLL as initial malware file\n\n**Published: 2021-07-09**\n\n**Last Updated: 2021-07-09 01:44:31 UTC**\n\n**by** [Brad Duncan (Version: 1)](https://isc.sans.edu/handler_list.html#brad-duncan)\n\n[3 comment(s)](https://isc.sans.edu/forums/diary/Hancitor+tries+XLL+as+initial+malware+file/27618/#comments)\n**_Introduction_**\n\nOn Thursday 2021-07-08, for a short while when Hancitor was initially active, if any victims\nclicked on a malicious link from the malspam, they would receive a XLL file instead of a\nmalicious Word doc. I tried one of the email links in my lab and received the malicious XLL\nfile. After other researchers reported they were receiving Word documents, I tried a few\nhours later and received a Word document instead.\n\n\n-----\n\n_Shown above: Flow chart for my first Hancitor infection on 2021-07-08._\n\nSince November 2020, Hancitor has consistently followed specific patterns of infection\nactivity, and [my previous diary from January 2021 is typical of what I've seen. Only one](https://isc.sans.edu/forums/diary/Hancitor+activity+resumes+after+a+hoilday+break/26980/)\nchange has happened recently. Since June 8th 2021, malicious spam (malspam) pushing\nHancitor switched from docs.google.com links in their messages to using\n**_[feedproxy.google.com URLs, which was initially reported by @James_inthe_box,](https://twitter.com/James_inthe_box/status/1402273859278082052)_**\n[@mesa_matt, and](https://twitter.com/mesa_matt/status/1402313759989932036) [@executemalware.](https://twitter.com/executemalware/status/1402394091644723205)\n\n\n-----\n\n_Shown above: Flow chart for my second Hancitor infection on 2021-07-08 (what I normally_\n_see)._\n\n[I've also seen these Google feedproxy URLs used for Hancitor infections, but I had not seen](https://www.malware-traffic-analysis.net/2021/06/17/index.html)\nthe XLL files until now.\n\n**_What is an XLL file?_**\n\n[XLL files are Excel add-in files. They're DLL files specifically designed to be run by Microsoft](https://www.lifewire.com/xll-file-2622527)\nExcel. Think of an XLL file as an \"Excel DLL.\"\n\n**_The emails_**\n\nAs usual, emails for this wave of Hancitor used a DocuSign theme, and they spoofed\n**_cabanga[.]com as the sending domain. Just like in recent weeks, links went to a Google_**\nfeedproxy URL.\n\n\n-----\n\n_Shown above: Example of malspam pushing Hancitor from 2021-07-08._\n\nThe Google feedproxy URL leads to a malicious page on a compromised webite designed to\nsend the initial malicious file and redirect the browser to DocuSign's website. I've described\n[the process here and](https://unit42.paloaltonetworks.com/hancitor-infections-cobalt-strike/) [here. This process makes it appear as if the file was offered by](https://unit42.paloaltonetworks.com/wireshark-tutorial-hancitor-followup-malware/)\nDocuSign, when it was actually sent through a malicious web page.\n\n\n-----\n\n_Shown above: The website for DocuSign appears in a victim's browser immediately after a_\n_malicious file is offered for download._\n\nRemember, this malicious activity is not caused by DocuSign. DocuSIgn is one of many\ncompanies that cybercriminals impersonate when distributing malware like Hancitor.\nDocuSign is aware of this long-running effort by the criminals behind Hancitor, and the\n[company has guidelines for dealing with this sort of malicious activity.](https://www.docusign.com/blog/dealing-with-spam-malware-and-viruses-2)\n\n**_Running the XLL_**\n\nWhen opening the XLL file, Excel asks if you want to enable the add-in as shown below.\n\n_Shown above: Opening the malicious XLL file in Excel._\n\n\n-----\n\nThe default option was to leave the add-in disabled. But when I opened the XLL file in my\nlab enviornment, I enabled all code for the add-in. Excel immediately ran the add-in and\nclosed. I didn't see any sort of fake template like we usually see when Hancitor uses a Word\ndocument as the initial file.\n\n**_Infection traffic_**\n\nDuring my first infection run with the XLL file, most of the traffic followed known patterns for\nHancitor and Cobalt Strike, I saw two additional URLs as noted below.\n\n_Shown above: Traffic from my first Hancitor infection filtered in Wireshark, with the two_\n_unusual URLs noted._\n\nThes two URLs returned files that were saved to my Windows client in the C:\\Users\\Public\\\ndirectory. The first URL returned an HTML file that was saved as res32.hta. That .hta file\nretrieved an EXE for Hancitor which was saved as snd32sys.exe.\n\n\n-----\n\n_Shown above: HTML (.hta) and EXE files saved the Windows host._\n\nHancitor showed a build number of 0707in2_wvcr in C2 traffic caused by the EXE. During\nmy second infection run with a Hancitor DLL, I saw a build number of 0707_wvcr,\n\n_Shown above: C2 traffic from Hancitor EXE during my first infection._\n\n\n-----\n\n_Shown above: C2 traffic from Hancitor DLL during my second infection._\n\n**_Indicators of Compromise (IOCs)_**\n\n[This Github page contains 35 Google feedproxy URLs and 35 associated URLs used to send](https://github.com/brad-duncan/IOCs/blob/main/2021-07-08-Hancitor-links.txt)\nthe initial malicious file. Other indicators follow.\n\nSHA256 hash:\n[73b8c566d8cdf3200daa0b698b9d32a49b1ea8284a1e6aa6408eb9c9daaacb71](https://bazaar.abuse.ch/sample/73b8c566d8cdf3200daa0b698b9d32a49b1ea8284a1e6aa6408eb9c9daaacb71/)\n\nFile size: 24,488 bytes\nFile name: 0708_0112181856.xll\nFile description: Excel add-in (an \"Excel DLL\")\n\nSHA256 hash:\n[da92436d2bbcdef52b11ace6e2e063e9971cefc074d194550bd425305c97cdd5](https://bazaar.abuse.ch/sample/da92436d2bbcdef52b11ace6e2e063e9971cefc074d194550bd425305c97cdd5/)\n\nFile size: 8,419 bytes\nFile location: hxxp://srand04rf[.]ru/92375234.xml\nFile location: C:\\Users\\Public\\res32.hta\nFile description: HTML file used to retrieve Hancitor EXE\n\n\n-----\n\nSHA256 hash:\n[3db14214a9eb98b3b5abffcb314c808a25ed82456ce01251d31e8ea960f6e4e6](https://bazaar.abuse.ch/sample/3db14214a9eb98b3b5abffcb314c808a25ed82456ce01251d31e8ea960f6e4e6/)\n\nFile size: 763,392 bytes\nFile location: hxxp://srand04rf[.]ru/08.jpg\nFile location: C:\\Users\\Public\\snd32sys.exe\nFile description: Hancitor EXE\n\n[SHA256 hash: b4d402b4ab3b5a5568f35562955d5d05357a589ccda55fde5a2c166ef5f15699](https://bazaar.abuse.ch/sample/b4d402b4ab3b5a5568f35562955d5d05357a589ccda55fde5a2c166ef5f15699/)\n\nFile size: 898,048 bytes\nFile name: 0708_3355614568218.doc\nFile description: Word doc with macros for Hancitor\n\n[SHA256 hash: 4dc9d5ee1debdba0388fbb112d4bbbc01bb782f015e798cced3fc2edb17ac557](https://bazaar.abuse.ch/sample/4dc9d5ee1debdba0388fbb112d4bbbc01bb782f015e798cced3fc2edb17ac557/)\n\nFile size: 274,432 bytes\nFile location: C:\\Users\\[username]\\AppData\\Roaming\\Microsoft\\Template\\niberius.dll\nFile description: Hancitor DLL\nRun method: rundll32.exe [filename],ONOQWPYIEIR\n\nSHA256 hash:\n[dee4bb7d46bbbec6c01dc41349cb8826b27be9a0dcf39816ca8bd6e0a39c2019](https://bazaar.abuse.ch/sample/dee4bb7d46bbbec6c01dc41349cb8826b27be9a0dcf39816ca8bd6e0a39c2019/)\n\nFile size: 272,910 bytes\nFile location: hxxp://srand04rf[.]ru/7hfjsdfjks.exe\nFile description: EXE for Ficker Stealer malware\nNote: This file was first submitted to VirusTotal on 2021-06-09.\n\nTraffic related to Hancitor:\n\n8.211.241[.]0 port 80 - srand04rf[.]ru - GET /92375234.xml\n8.211.241[.]0 port 80 - srand04rf[.]ru - GET /08.jpg\nport 80 - api.ipify.org - GET / [not inherently malicious]\n77.222.42[.]67 port 80 - sudepallon[.]com - POST /8/forum.php\n194.147.78[.]155 port 80 - anspossthrly[.]ru - POST /8/forum.php\n194.147.115[.]74 port 80 - thentabecon[.]ru - POST/8/forum.php\n\nTraffic related to Ficker Stealer:\n\n8.211.241[.]0 port 80 - srand04rf[.]ru - GET /7hfjsdfjks.exe\nport 80 - api.ipify.org - GET /?format=xml [not inherently malicious]\n95.213.179[.]67 port 80 - pospvisis[.]com - TCP traffic\n\nTraffic related to Cobalt Strike:\n\n\n-----\n\n8.211.241[.]0 port 80 - srand04rf[.]ru - GET /0707s.bin\n8.211.241[.]0 port 80 - srand04rf[.]ru - GET /0707.bin\n191.101.17[.]21 port 443 - HTTPS traffic\n191.101.17[.]21 port 80 - 191.101.17[.]21 - GET /5lyB\n191.101.17[.]21 port 80 - 191.101.17[.]21 - GET /IE9CompatViewList.xml\n191.101.17[.]21 port 80 - 191.101.17[.]21 - POST /submit.php?id=[9-digit number]\n\n**_Final words_**\n\n[A pcap of the infection traffic from my first infection run (with the XLL file) can be found here.](https://github.com/brad-duncan/IOCs/blob/main/2021-07-08-Hancitor-XLL-infection-with-Cobalt-Strike.pcap.zip)\n\n--\nBrad Duncan\nbrad [at] malware-traffic-analysis.net\n\n[Keywords: TA511](https://isc.sans.edu/tag.html?tag=TA511) [Moskalvzapoe](https://isc.sans.edu/tag.html?tag=Moskalvzapoe) [MAN1](https://isc.sans.edu/tag.html?tag=MAN1) [Hancitor](https://isc.sans.edu/tag.html?tag=Hancitor) [Ficker Stealer](https://isc.sans.edu/tag.html?tag=Ficker%20Stealer) [Cobalt Strike](https://isc.sans.edu/tag.html?tag=Cobalt%20Strike) [Chanitor](https://isc.sans.edu/tag.html?tag=Chanitor)\n[3 comment(s)](https://isc.sans.edu/forums/diary/Hancitor+tries+XLL+as+initial+malware+file/27618/)\n\nJoin us at SANS! Attend [with Brad Duncan in starting](https://isc.sans.edu/diary/rss/27618)\n\nTop of page\n√ó\n\n[Diary Archives](https://isc.sans.edu/diaryarchive.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-09 - Hancitor tries XLL as initial malware file.pdf"
    ],
    "report_names": [
        "2021-07-09 - Hancitor tries XLL as initial malware file.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1f6ae238-765f-4495-9d54-6a7883d7a319",
            "created_at": "2022-10-25T16:07:24.573456Z",
            "updated_at": "2025-03-27T02:02:10.284644Z",
            "deleted_at": null,
            "main_name": "TA511",
            "aliases": [
                "MAN1",
                "Moskalvzapoe"
            ],
            "source_name": "ETDA:TA511",
            "tools": [
                "Agentemis",
                "Chanitor",
                "Cobalt Strike",
                "CobaltStrike",
                "Ficker Stealer",
                "Hancitor",
                "NetSupport",
                "NetSupport Manager",
                "NetSupport Manager RAT",
                "NetSupport RAT",
                "NetSupportManager RAT",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "542cf9d0-9c68-428c-aff8-81b6f59dc985",
            "created_at": "2023-02-15T02:01:49.554105Z",
            "updated_at": "2025-03-27T02:00:03.110991Z",
            "deleted_at": null,
            "main_name": "Moskalvzapoe",
            "aliases": [
                "MAN1",
                "TA511"
            ],
            "source_name": "MISPGALAXY:Moskalvzapoe",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535939,
    "ts_updated_at": 1743041592,
    "ts_creation_date": 1653697359,
    "ts_modification_date": 1653697359,
    "files": {
        "pdf": "https://archive.orkl.eu/535cd0406f95903b503892d8e36fb8c1fb82ef2b.pdf",
        "text": "https://archive.orkl.eu/535cd0406f95903b503892d8e36fb8c1fb82ef2b.txt",
        "img": "https://archive.orkl.eu/535cd0406f95903b503892d8e36fb8c1fb82ef2b.jpg"
    }
}