{
    "id": "035961c8-4dac-4927-b46a-698f66006222",
    "created_at": "2023-01-12T15:08:42.583457Z",
    "updated_at": "2025-03-27T02:06:07.984676Z",
    "deleted_at": null,
    "sha1_hash": "e76ffea00890e62a8013b4461982c7e77016ff8a",
    "title": "2022-01-22 - Malware Headliners- Emotet",
    "authors": "",
    "file_creation_date": "2022-05-29T10:35:48Z",
    "file_modification_date": "2022-05-29T10:35:48Z",
    "file_size": 932472,
    "plain_text": "# Malware Headliners: Emotet\n\n**atomicmatryoshka.com/post/malware-headliners-emotet**\n\nz3r0day_504 January 22, 2022\n\nEmotet is a banking trojan that topped the list for most widely seen malware in 2021. Similar\nto some of my previous posts, Emotet is usually delivered via phishing campaign. In this blog\npost we'll cover some initial .xlsm analysis and extract useful IOCs.\n\nIf you're interested in learning how to set up an environment and replicate some of this\n[activity, check out my \"Cracking the Malware Pi√±ata\" series here.](https://www.atomicmatryoshka.com/blog/categories/reversing-malware-fundamentals)\n\n## INITIAL ANALYSIS\n\nRunning exiftool, we get the following information from the sample:\n\n\n-----\n\nOn the exiftool output, we see that this is an XLSM file type. XLSM files, according to\nMicrosoft, are Excel Macro-Enabled Workbooks. Macros allow for the automation of tasks\nwithin Microsoft Office documents, and this file extension and type applies specifically to\nthose documents compatible with Microsoft Excel.\n\n## TOOL GEARED TOWARDS MACROS\n\n[While we can absolutely use zipdump and have some findings, olevba proves to be more](https://github.com/decalage2/oletools)\nsuccessful in this specific circumstance. Developed by Decalage, olevba parses Microsoft\nOLE2 files. In simple terms, OLE2 files serve as structured storage for linked objects and\nembedded objects. This tool interacts with files in this format to extract the necessary data\nfor analysis.\n\nBelow are screenshots of the olevba tool at work:\n\n\n-----\n\nThere's a lot of information here. We see that the macro calls out to 3 different domains with\nthe intent of downloading a file. The file has an .ocx extension, meaning it is used as an\nActiveX control and, once configured, can steal information from the browser, download\nadditional files, amongst other malicious behaviors.\n\nWe see the DllRegisterServer function, which is typically used with the regsvr32.exe binary\nbut can also be leveraged by rundll32.exe, shown in olevba's output. According to Microsoft,\nthe DllRegisterServer function \"instructs an in-process server to create its registry entries for\nall classes supported.\" In this instance, it is being used to register the ActiveX controls and\nbypass application controls in the process.\n\nAt the bottom of the olevba output, we see a reference to an XLM macro. It doesn't hurt to\nrun the file through XLMdeobfuscator to see if we can extract any additional information. In\nthis instance, the output already corroborates our findings from olevba:\n\n\n-----\n\n## INDICATORS OF COMPROMISE\n\n**Domains:**\n\nhttps://zml.laneso[.]com/packet/AlvJ80dtSYEeeCQP/\n\nhttp://ostadsarma[.]com/wp-admin/JNgASjNC/\n\nhttp://govtjobresultbd[.]xyz/sjjz/UIUh0HsLqj0y9/\n\n**File names:**\n\nerum.ocx\n\n**File hash:**\n\n1a243db583013a6999761dad88d6952351fdc2cd17d2016990276a9dd11ac90b\n\n## FURTHER REFERENCES\n\n[OLE Formats (Microsoft)](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-oleds/fdc5e702-d09e-4344-a77f-eb079d41f23f)\n\n\n-----\n\n[DLLRegisterServer Function (Microsoft)](https://docs.microsoft.com/en-us/windows/win32/api/olectl/nf-olectl-dllregisterserver)\n\n[2021 Threat Detection Report - rundll32.exe (Red Canary)](https://redcanary.com/threat-detection-report/techniques/rundll32/)\n\n[Register an ActiveX Control Manually (Microsoft)](https://docs.microsoft.com/en-us/previous-versions/troubleshoot/visualstudio/foxpro/register-activex-control-manually)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-22 - Malware Headliners- Emotet.pdf"
    ],
    "report_names": [
        "2022-01-22 - Malware Headliners- Emotet.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536122,
    "ts_updated_at": 1743041167,
    "ts_creation_date": 1653820548,
    "ts_modification_date": 1653820548,
    "files": {
        "pdf": "https://archive.orkl.eu/e76ffea00890e62a8013b4461982c7e77016ff8a.pdf",
        "text": "https://archive.orkl.eu/e76ffea00890e62a8013b4461982c7e77016ff8a.txt",
        "img": "https://archive.orkl.eu/e76ffea00890e62a8013b4461982c7e77016ff8a.jpg"
    }
}