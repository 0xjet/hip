{
    "id": "b608548d-377c-41ee-98c0-dc2beaaf5bfc",
    "created_at": "2023-01-12T15:02:15.079083Z",
    "updated_at": "2025-03-27T02:05:18.419229Z",
    "deleted_at": null,
    "sha1_hash": "08b9e955b73cf656cae597e6ca3155da93c8b495",
    "title": "2017-05-11 - Mac.BackDoor.Systemd.1",
    "authors": "",
    "file_creation_date": "2022-05-27T23:26:51Z",
    "file_modification_date": "2022-05-27T23:26:51Z",
    "file_size": 137062,
    "plain_text": "# Mac.BackDoor.Systemd.1\n\n**vms.drweb.com/virus/**\n\n## SHA1:\n```\n   3cb1cfa072dbd28f02bd4a6162ba0a69f06f33f0\n\n Trojan backdoor for macOS. Once launched, it sends the following string to the console:\nThis file is corrupted and connot be opened\n\n It is executed as a daemon called systemd. In order to conceal its file, the Trojan marks it with flags uchg, schg and hidden. It can use the following arguments for the launch:\n\n argument value\n\n d daemon\n\n r launch\n\n u update\n\n Then the Trojan creates file with SH commands and a PLIST file in order to register itself in the autorun.\n\n```\n\n-----\n\n```\n#!/bin/sh\n. /etc/rc.common\nStartService (){\n  ConsoleMessage \"Start system Service\"\n  “File path\" d\n}\nStopService (){\n  return 0\n}\nRestartService (){\n  return 0\n}\nRunService \"$1\"\n\n## A file with the following content is created:\n{\n  Description   = \"Start systemd\";\n  Provides    = (\"system\");\n  Requires    = (\"Network\");\n  OrderPreference = \"None\";\n}\n\n Also a PLIST file is created:\n\n```\n\n-----\n\n```\n<?xml version 1.0 encoding UTF 8 ?>\n<!DOCTYPE plist PUBLIC \"-//Apple//DTD PLIST 1.0//EN\"\n\"http://www.apple.com/DTDs/PropertyList-1.0.dtd\">\n   <plist version=\"1.0\">\n   <dict>\n        <key>Disabled</key>\n        <false/>\n        <key>UserName</key>\n        <string>root</string>\n        <key>Label</key>\n        <string>\n        com.appule.sysetmd\n        </string>\n        <key>KeepAlive</key>\n        <dict>\n          <key>NetworkState</key>\n          <true/>\n        </dict>\n        <key>ProgramArguments</key>\n          <array>\n            <string>\n            File path\n            </string>\n            <string>d</string>\n         </array>\n        <key>RunAtLoad</key>\n        <true/>\n        <key>StartInterval</key>\n        <integer>5</integer>\n   </dict>\n   </plist>\n\n## The Trojan stores configuration information in its own file and encrypts it with the 3DES algorithm. Example of the decrypted configuration is as follows:\n\n```\n\n-----\n\n```\n01 02 00 00 00 30 31 02 32 00 00 00 31 32 39 2E ☺☻  01☻2  .\n32 33 32 2E-31 39 35 2E-32 32 36 2C-34 33 2E 32 ***.***.226,**.2\n34 37 2E 32-36 2E 33 37-2C 78 69 73-66 69 77 70 **.**.37,xis****\n65 69 64 73-73 64 77 65-61 64 2E 63-6F 6D 03 05 *****wead.com♥♣\n00 00 00 31-30 34 34 33-04 02 01 00-00 00 04 BC   10443♦☻☺  ♦╝\n8E 12 99 9C-83 58 E6 0C-52 0C 3E DE-00 CA F2 0E О↕ЩЬГXц♀R♀>▐ ╩Є♫\nA4 1D ED 65-BF 47 3A CB-F9 26 3E B9-D9 3F 08 4C д↔эe┐G:╦∙&>╣┘?◘L\n57 E8 C4 F6-05 3D 27 98-74 29 5D 1C-A8 44 ED 87 Wш─Ў♣='Шt)]∟иDэЗ\nF4 86 98 5F-4B A8 13 BA-5A FE 8F 90-FF C0 41 F0 ЇЖШ_Kи‼║Z■ПР └AЁ\nCC D9 60 4D-F5 C3 42 29-19 88 95 72-10 64 6F 00 ╠┘`Mї├B)↓ИХr►do\n22 8E 49 1C-28 CE DC AC-AA 1B 61 A3-97 2F 76 00 \"ОI∟(╬▄мк←aгЧ/v\n7E 1C ED 05-7D FC A3 96-A9 8A E4 57-6F 10 3A 2F ~∟э♣}№гЦйКфWo►:/\n56 3B EA EB-1E CE 41 93-61 B2 FC 09-10 30 4F 00 V;ъы▲╬AУa▓№○►0O\n00 00 00 00-00 00 00 00-00 00 00 00-00 00 00 00\n00 00 00 00-00 00 00 00-00 00 00 00-00 00 00 00\n00 00 00 00-00 00 00 00-00 00 00 00-00 00 00 00\n00 00 00 00-00 00 00 00-00 00 00 00-00 00 00 00\n00 00 00 00-00 00 00 00-00 00 00 00-00 00 00 00\n00 00 00 00-00 00 00 00-00 00 00 00-00 00 00 00\n00 00 00 00-00 00 00 00-00 00 00 00-00 00 00 00\n00 00 00 00-00 00 00 00-00 00 00 00-01 00 01 05       ☺ ☺♣\n10 00 00 00-62 31 65 31-35 64 38 61-36 63 36 34 ►  b1e15d8a6c64\n34 39 30 33-08 80 00 00-00 82 76 EE-86 35 91 59 4903◘А  ВvюЖ5СY\nEF 72 28 0F-6A AB 99 33-4B 18 22 3F-AA 66 69 78 яr(☼jлЩ3K↑\"?кfix\n79 25 65 5D-15 B5 00 7A-B8 5A 79 F6-CF E1 71 C3 y%e]§╡ z╕ZyЎ╧сq├\nEB F9 D4 95-2E 2B E9 C8-C5 81 3E 65-FB 19 EA 79 ы∙╘Х.+щ╚┼Б>e√↓ъy\nA1 38 B4 06-0B AF A5 02-6C 19 65 BA-5C 2C 51 BE б8┤♠♂пе☻l↓e║\\,Q╛\n05 11 4C 8C-24 54 E5 2A-BC 4A 74 01-1C F3 51 6A ♣◄LМ$Tх*╝Jt☺∟єQj\n1D 91 2E A1-05 02 5C 58-AA 5F F2 C7-A3 F5 08 3D ↔С.б♣☻\\Xк_Є╟гї◘=\nBE 3E 3C 8F-09 DB FE DD-B3 8C D5 9B-23 8B 11 AA ╛><П○█■▌│М╒Ы#Л◄к\nCA C5 48 8A-C7 A5 D1 F6-1B 00 00 00-00 00 00 07 ╩┼HК╟е╤Ў←   •\n\n## Depending on the Trojan configuration, it establishes a connection with the command and control server itself or waits for an incoming connection request. Once connected, the backdoor executes the commands it receives and periodically sends the following information to cybercriminals:\n\n Name and version of the operating system; User name; Availability of root privileges; MAC addresses of all available network interfaces; IP addresses of all available network interfaces; External IP address; CPU type; RAM amount; Data about the malware version and its configuration.\n\n Information, which is shared between the Trojan and the C&C server, is encrypted with the 3DES algorithm. The backdoor can execute the following commands:\n\n```\n\n-----\n\n## command Parameter Value\n\n 0x200 file manager execute commands of the file manager\n\n 1 - list dir (ls -la *) receive a list of the contents of a specified directory\n\n 2 - read file read a file\n\n 3 - write file write to a file, it also can write data to a file for an update\n\n 4 - list file (ls -la file) get the contents of a file\n\n\n## 5 - chmod/chown/rename\n\n\n## execute CHMOD, CHOWN and RENAME commands\n\n\n## 6 - delete file delete a file\n\n 7 - mkdir create a directory\n\n 0x300 execute a command in the bash shell\n\n 0x400 update the Trojan\n\n 0x500 reinstall the Trojan\n\n 0x800 change the command and control server’s IP address\n\n 0x900 install a plug-in\n\n News about the Trojan\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-05-11 - Mac.BackDoor.Systemd.1.pdf"
    ],
    "report_names": [
        "2017-05-11 - Mac.BackDoor.Systemd.1.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535735,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1653694011,
    "ts_modification_date": 1653694011,
    "files": {
        "pdf": "https://archive.orkl.eu/08b9e955b73cf656cae597e6ca3155da93c8b495.pdf",
        "text": "https://archive.orkl.eu/08b9e955b73cf656cae597e6ca3155da93c8b495.txt",
        "img": "https://archive.orkl.eu/08b9e955b73cf656cae597e6ca3155da93c8b495.jpg"
    }
}