{
    "id": "2f13f332-19f8-44e8-80e1-908ff7859fb3",
    "created_at": "2022-10-25T16:48:18.81909Z",
    "updated_at": "2025-03-27T02:11:06.168987Z",
    "deleted_at": null,
    "sha1_hash": "fef39bfaa9737417e6512c34c8e671fa93b77e78",
    "title": "teamspy_report-v1",
    "authors": "",
    "file_creation_date": "2013-03-20T20:10:20Z",
    "file_modification_date": "2013-03-20T20:10:20Z",
    "file_size": 1769595,
    "plain_text": "# TeamSpy – Obshie manevri. Ispolzovat tolko s\n razreshenija S-a.\n\n##### v1 (March 20, 2013) \n\n## Technical Report \n\n by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n##### Authors:\n###### Hungarian National Security Authority (NSA HUN) and CrySyS Lab Malware Intelligence Team\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n## Technical Report \n\n by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n## Technical Report \n\n by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n## Technical Report \n\n by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## Technical Report \n\n by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## Technical Report \n\n by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n\n## by\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n#### Laboratory of Cryptography and System Security (CrySyS Lab)\n\n http://www.crysys.hu/\n\n Budapest University of Technology and Economics\n\n Department of Networked Systems and Services\n\n http://www.bme.hu/\n\n\n-----\n\n## Table of contents\n\n**1.** **Introduction .............................................................................................................................................3**\n\n**2.** **Overview of malicios activities..........................................................................................................5**\n\n**3.** **C&C servers...............................................................................................................................................7**\n_3.1_ _C&C whois information....................................................................................................................................... 8_\n_3.2_ _C&C communications ........................................................................................................................................10_\n_3.3_ _bannetwork.org databases.............................................................................................................................12_\n_3.4_ _Statistics from other C&C servers................................................................................................................20_\n\n**4.** **Hashes of known malware modules............................................................................................. 23**\n\n**5.** **Analysis of individual modules ...................................................................................................... 28**\n_5.1_ _Avicap32.dll ...........................................................................................................................................................28_\n_5.2_ _Modules found on bannetwork.org.............................................................................................................29_\n_5.3_ _Modules found on planetanews.org............................................................................................................34_\n_5.4_ _Modules found on politnews.org..................................................................................................................35_\n_5.5_ _Other related samples.......................................................................................................................................43_\n_5.6_ _Partially analyzed / unanalyzed samples................................................................................................45_\n\n**6.** **Additional information received from different partners ................................................... 50**\n_6.1_ _ESET ..........................................................................................................................................................................50_\n_6.2_ _Kaspersky Lab.......................................................................................................................................................52_\n_6.3_ _Symantec.................................................................................................................................................................52_\n\n**7.** **Conclusions............................................................................................................................................ 53**\n\n2\n\n\n-----\n\n### 1. Introduction\n\nThe CrySyS Lab, Budapest has been notified by the Hungarian National Security Authority\n(www.nbf.hu) about the detection of an ongoing high profile targeted attack affecting our home\ncountry, Hungary. During our investigation of the incident, we discovered a number of C&C servers,\nand a large number of malware samples that have been used in multiple attacks campaigns in the\nlast couple of years. Indeed, the collected evidences suggest that part of the attack toolkit we\ndiscovered was used back in 2010. It seems that the main objective of the attackers was information\ngathering from the infected computers. Many of the victims appear to be ordinary users, but some of\nthe victims are high profile industrial, research, or diplomatic targets, including the case that\ntriggered our investigation. As part of the attackers’ activities is based on misusing the TeamViewer\nremote access tool, we named the entire malicious toolkit TeamSpy.\n\nAs mentioned above, a distinct feature of the attack is the abuse of the legitimate TeamViewer\nremote access tool. The attackers install an original, legitimate TeamViewer instance on the victim\ncomputer, but they modify its behavior with DLL hijacking, and they obtain remote access to the\nvictim computers in real-time. Therefore, the attackers are not only able to remotely observe the\ninfected computers, but they can also misuse TeamViewer to install other tools to obtain important\ninformation, files, and other data from the victim.\n\nThe collected evidences suggest that attacks have been carried out in multiple campaigns. In addition\nto the TeamViewer based campaigns, we also saw signs indicating a number of older attacks based\non proprietary malware with C&C server based control. We estimate the number of distinct\ncampaigns to be in the order of tens.\n\nThe activities of the attackers might be related to other known attack campaigns, like the\nTeamBot/Sheldor campaign (banking cyber-crime), as we describe later in this document. Despite of\nthis relation to cyber-crime activities, we believe TeamSpy has been used in high-profile targeted\nattacks too. This is underpinned by the following observations:\n\n  - In case of the Hungarian incident, the signs clearly show that the target is high-profile.\n\n  - Some malware samples were created just for the retrieval of specific office documents (see\nthe analysis of module 2016_11.txt below) whose name (e.g. “gaza tunnel”) indicate that the\ntarget is probably high-profile.\n\n  - The telemetry revealed additional high-profile victims outside Hungary. Indeed, multiple\nvictims were found in Iran, including victims at an industrial company, which is an electronics\ncompany with government background. The possible date of infection for this victim is from\n2010.\n\n  - Some tools used by the attackers run traceroute to an unknown host on a subnet, where\nsome other hosts belong to the Ministry of Foreign Affairs of Uzbekistan.\n\n3\n\n\n-----\n\n  - Some tools used in the attacks look for files matching the following templates *saidumlo*\n*secret*.* *секрет*.* *парол*.*  *.xls  *.pdf  *.pgp  *pass*.*  *.rtf  *.doc. This list\nshows the interest of the attackers in “secret” and “password” documents. In addition, the\nattackers’ interest in .pgp and .p12 files indicates that they were looking not only for\npasswords, but also for cryptographic keys, which goes beyond attacks against ordinary\nusers.\n\n**Figure 1– File searches done by modules of TeamSpy related malware samples**\n\nDuring our investigation, we uncovered a large set of malware samples that were probably utilized\nback in the past; hence, our analysis can also shed light on older malware campaigns and might help\nvictims to reveal incidents that are several years old. Therefore, the information disclosed in this\nreport could be used to perform a longitudinal study of targeted malware attacks.\n\nWhile identity of most of the victims could not be revealed, we have information on some highprofile victims, e.g.:\n\n11/2012: Hungarian high profile governmental victim.\n\n03/2013: Embassy of NATO/EU state in Russia\n\n04/2010: Electronics company in Middle-East, Govt. background\n\n03/2013: Multiple research/educational organizations in France and Belgium\n\n03/2013: Industrial manufacturer in Russia\n\n4\n\n\n-----\n\n### 2. Overview of malicios activities\n\nDuring our investigations, we detected two radically different types of activities of the TeamSpy\nattackers. In the actual targeted attack detected by the Hungarian National Security Agency, they\nused components of the TeamViewer tool combined with other malware modules. In other cases,\nthey used “traditional” self-made malware tools to form a botnet and perform their attacks. For the\nTeamViewer-based activities, we have traces in the past until September 2012. The forensics\nmaterial on other malware campaigns suggests that the attackers’ activities may go back as far as\n2004.\n\n**Figure 2 – Activities of the TeamSpy attackers**\n\nTeamViewer has also been used in the “Sheldor” attack campaign, which was detected between\n2010 and 2011, and which resulted in assets stolen at the value of $600k and $832k. Successful\ninvestigation led to arrests in at least two criminal groups. More information is available on the slides\nfrom Eset and Group-IB[1] (also check Symantec’s Teambot [2]information).\n\nAccording to the slides, the Sheldor campaign was also based on the usage of TeamViewer (although\nin a slightly different manner). C&C communications included the HTTP requests of type “GET\n/getinfo.php?id=414%20034%20883&pwd=6655&stat=1”, which matches the query format of the\ncampaign we were investigating. We have also been informed that the control panel part of the C&C\nserver of the Sheldor campaign match the control panel used in the campaign we were investigating\n(see Figures below). This match shows a direct relationship between Sheldor and TeamSpy, although\nwe do not known if the connection is only at the tool level or at the operation level too.\n\n1 _go.eset.com/us/resources/white-papers/CARO_2011.pdf_\n\n2 http://www.symantec.com/security_response/writeup.jsp?docid=2011-011802-4837-99&tabid=2799&tabid=2\n\n5\n\n\n-----\n\n**Figure 3 – Sheldor C&C server attacker’s dashboard**\n\n**Figure 4 – C&C control panel obtained from newslite.org**\n\n\n6\n\n\n-----\n\n### 3. C&C servers\n\nKnown TeamSpy C&C servers include the following:\n\nbannetwork.org\nplanetanews.org\npolitnews.org\nnewslite.org\nbulbanews.org\nr2bnetwork.org - sinkholed by Kaspersky Lab\nkortopla.org - registered by Krepov Bogdan Serafimovich, who also registered\nplanetanews.org and bulbanews.org; sinkholed by Kaspersky Lab\nother C&C servers are also found by security companies in the recent days\n\nThe roles of the individual servers are not yet fully understood, but there are clear connections\namong them, as shown in Figure 5 below:\n\n**Figure 5 – Relationship between the TeamSpy C&C servers**\n\nIn the following, we discuss the discovery of the C&C servers:\n\n   - We started the investigations from the Hungarian victim. Network traffic and activity logs\nhave shown that traffic is going to the TeamViewer service and to the newslite.org server.\n\n   - Historical data revealed that before the TeamViewer-based campaign, the same set of\ncompromised computers connected to the bulbanews.org C&C server.\n\n   - Finally, analysis of the malware and web traffic logs revealed that some modules are\ndownloaded from the C&C server bannetwork.org.\n\nMore investigations revealed additional C&C servers:\n\n7\n\n\n-----\n\n  - The web page of bannetwork.org accidentally had a HTML <title> tag “politnews”, and\npolitnews.org was found to have similar structure and services like bannetwork.org.\n\n  - Investigations on whois registration data revealed that the same person, Krepov Bogdan\nSerafimovich, registered two additional domains. These are planetanews.org and\nkortopla.org. Planetanews.org was found to be a functional C&C server, while kortopla.org is\nderegistered. This latter domain is currently sinkholed by our partners, and we do not know\nyet if it was used for rogue activities or not.\n\n  - Investigations uncovered a sample in our malware repositories,\n539b0094e07e43bfced8a415ba5c84e3, that is related to a module of the TeamSpy kit. It has\nreferences to politnews.org and another domain, r2bnetwork.org, which is again expired, but\nthe malware sample proves that it was used for C&C activity. The domain r2bdomain.org is\ncurrently sinkholed by our partners.\n\nThe structure and services of the distinct C&C servers are similar, but each server is unique,\ncontaining some specific files and modules. We could not discover the internal structure of all C&C\nservers, but we are sure, that the listed domains are related to the TeamSpy activity (except for the\nderegistered kortopla.org, for which we have no such evidence). In the recent days we collaborated\nwith multiple security companies and organizations, additional C&C servers were unveiled by their\nresearch.\n\n##### 3.1 C&C whois information\n\nIn this section we provide partial whois information for the discovered C&C domains.\n```\nDomain Name:NEWSLITE.ORG\nCreated On:27-Oct-2011 13:36:40 UTC\nLast Updated On:29-Oct-2012 05:40:58 UTC\nExpiration Date:27-Oct-2013 13:36:40 UTC\nSponsoring Registrar:PDR Ltd. d/b/a PublicDomainRegistry.com (R27-LROR)\nStatus:CLIENT TRANSFER PROHIBITED\nRegistrant ID:DI_18504545\nRegistrant Name:David van Cleve\nRegistrant Organization:N/A\nRegistrant Street1:Meester S. van Houtenstraat\nRegistrant Street2:\nRegistrant Street3:\nRegistrant City:Assen\nRegistrant State/Province:Assen\nRegistrant Postal Code:9400-9409\nRegistrant Country:AN\nRegistrant Phone:+599.89261215320\nRegistrant Phone Ext.:\nRegistrant FAX:\nRegistrant FAX Ext.:\nRegistrant Email:vancleve_david@yahoo.nl\n\n```\n**Figure 6 – Politnews.org whois record**\n\n8\n\n\n-----\n\n```\nDomain Name:BANNETWORK.ORG\nCreated On:02-Sep-2004 10:20:14 UTC\nLast Updated On:03-Sep-2012 01:28:34 UTC\nExpiration Date:02-Sep-2013 10:20:14 UTC\nSponsoring Registrar:OnlineNIC Inc. (R64-LROR)\nStatus:OK\nRegistrant ID:ONLC-1304805-4\nRegistrant Name:Dmitryi Ivastov\nRegistrant Organization:host-telecom.com\nRegistrant Street1:Mira street, 1a\nRegistrant Street2:\nRegistrant Street3:\nRegistrant City:Moscow\nRegistrant State/Province:Moscow\nRegistrant Postal Code:103555\nRegistrant Country:RU\nRegistrant Phone:+7.0957777777\nRegistrant Phone Ext.:\nRegistrant FAX:+7.0957777777\nRegistrant FAX Ext.:\nRegistrant Email:bannetwork@mail.ru\n\n```\n**Figure 7 – bannetwork.org whois record**\n```\nDomain Name:POLITNEWS.ORG\nCreated On:18-Jun-2004 09:01:13 UTC\nLast Updated On:18-Jun-2012 13:38:58 UTC\nExpiration Date:18-Jun-2013 09:01:13 UTC\nSponsoring Registrar:OnlineNIC Inc. (R64-LROR)\nStatus:OK\nRegistrant ID:ONLC-1203640-4\nRegistrant Name:Zacepenko Ilia Igorevich\nRegistrant Organization:host-telecom\nRegistrant Street1:9th square, 10-1,1\nRegistrant Street2:\nRegistrant Street3:\nRegistrant City:NI Larne city\nRegistrant State/Province:NI Larne\nRegistrant Postal Code:127591\nRegistrant Country:GB\nRegistrant Phone:+44.3378845676\nRegistrant Phone Ext.:\nRegistrant FAX:+44.3378845676\nRegistrant FAX Ext.:\nRegistrant Email:politnews@mail.ru\n\n```\n**Figure 8 – politnews.org whois record**\n```\nDomain Name:BULBANEWS.ORG\nCreated On:05-Oct-2011 09:20:16 UTC\nLast Updated On:05-Sep-2012 06:56:01 UTC\nExpiration Date:05-Oct-2013 09:20:16 UTC\nSponsoring Registrar:OnlineNIC Inc. (R64-LROR)\nStatus:CLIENT TRANSFER PROHIBITED\nRegistrant ID:oln106154829\nRegistrant Name:Krepov Bogdan Serafimovich\nRegistrant Organization:\n```\n\n9\n\n\n-----\n\n```\nRegistrant Street1:g. Lugansk, Hersonskaya 52\nRegistrant Street2:\nRegistrant Street3:\nRegistrant City:Lugansk\nRegistrant State/Province:Lugansk\nRegistrant Postal Code:91000\nRegistrant Country:UA\nRegistrant Phone:+3.80443640571\nRegistrant Phone Ext.:\nRegistrant FAX:+3.80443640571\nRegistrant FAX Ext.:\nRegistrant Email:krepov@i.ua\n\n```\n**Figure 9 – bulbanews.org whois record**\n```\nDomain Name:PLANETANEWS.ORG\nCreated On:23-Mar-2012 08:52:26 UTC\nLast Updated On:06-Sep-2012 13:59:36 UTC\nExpiration Date:23-Mar-2014 08:52:26 UTC\nSponsoring Registrar:OnlineNIC Inc. (R64-LROR)\nStatus:CLIENT TRANSFER PROHIBITED\nRegistrant ID:oln122048890\nRegistrant Name:Krepov Bogdan Serafimovich\nRegistrant Organization:Registrant Street1:g. Lugansk, Hersonskaya 52\nRegistrant Street2:\nRegistrant Street3:\nRegistrant City:Lugansk\nRegistrant State/Province:Lugansk\nRegistrant Postal Code:91000\nRegistrant Country:UA\nRegistrant Phone:+3.80443640571\nRegistrant Phone Ext.:\nRegistrant FAX:+3.80443640571\nRegistrant FAX Ext.:\nRegistrant Email:krepov@i.ua\n\n```\n**Figure 10 – planetanews.org whois record**\n\nNote that Krepov Bogdan Serafimovich registered multiple domains and this name is a link between\nthose C&C servers. On the C&C server “planetanews.org” the unix user name used by the web server\ncomponents is also “krepov”.\n\n##### 3.2 C&C communications\n\nThe attackers remotely control the malware running on victim computers using the TeamViewer\napplication. On the victim computers, teamviewer.exe runs as a legitimate process, started from\nHKCU\\Software\\Microsoft\\CurrentVersion\\Run as shown in the figure below:\n\n10\n\n\n-----\n\n**Figure 11 – teamviewer.exe is running as a legitimate process**\n\nThe malicious activity is started by loading a DLL called avicap32.dll. This DLL is not a legitimate part\nof TeamViewer, but a malware responsible for the C&C communications. It most likely gets the\nnecessary references to reach the C&C server from the configuration file tv.conf,\n```\nTable stat_TV_log has essenti\nszadminstat \"tv/getinfo.php\"\nszadminhost \"newslite.org\"\nszfilehost \"\"\nnTimeOut \"10000\"\nnStartIdleTime \"60\"\nnregKey \"\"\nszSubKey \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\"\nszValueName \"svchost\"\nszteampass \"1234\"\nnVideo \"4\"\nszlogftp \"bannetwork.org\"\nszusername \"bannetwo\"\nszpassword \"X[erased in this document]XXX\"\nszlogkey \"sysenter\"\nszlogstat \"log.php\"\nszpostdata \"id=\"\nnkilltvwin7 \"\"\nnkilltvwinXp \"\"\nnfakedel \"1\"\n\n```\n**Figure 12 – Configuration file for TeamViewer contains refs to the C&C server**\n\n11\n\n\n-----\n\nNote that the configuration file contains references to two servers (in this case, newslite.org and\nbannetwork.org), where one of them is accessed via the FTP protocol. The necessary access\ncredentials (e.g., FTP username and password) are also given in this configuration file.\n\nTeamViewer communication is used to directly command the victim computer; to investigate screen\ncaptures in real-time. The goal of the newslite.org and similar C&C traffic is to maintain a list of the\nTeamViewer ID and password of victim computers and also to monitor the availability, to check\nwhich victims can be controlled currently. The communication to bulbanews.org at the original victim\nstopped when the TeamViewer based malware was installed to the victim computer, therefore, this\nserver was most likely used for an older type of attack.\n\nWe collected the recently used IP addresses of victims from all the above mentioned C&C server\ndatabases, but only those addresses, for which we have an IP address later than 2012-09-01. The\nresults are depicted on the following heat map.\n\n**Figure 13  – Heat map of all known victims after 2012-09-01**\n\n##### 3.3 bannetwork.org databases\n\nWe have investigated the contents of the C&C servers. For some of them, we have partial\ninformation only. We obtained the best view on bannetwork.org, where we found detailed\ninformation related to multiple attack campaigns.\n\n12\n\n\n-----\n\nWe obtained information from the following database tables on bannetwork.org:\n\naccs\nclients_counter\nconf\ndoatk\nlog\nstat\nstat2\nstat5057\nstat5058\nstat_TV\nstat_TV_log\nstatistic\n\nIt seems that the C&C servers are used for longer duration and contain data not just relevant to\ncurrent attacks, but also historical information. This reveals the incremental work method of the\nattackers: reuse of code, reuse of servers, and only make incremental changes on the existing\nmaterial.\n\nThe database tables contain information about different attack campaigns and their related log\ninformation and statistics. The numbers 5057, 5058, 5016, etc. might be campaign IDs or version\n(build) numbers. We observed similar numbers in the malware samples we collected from this and\nother C&C servers. The string “TV” refers to TeamViewer, so these tables probably contain statistics\nof attacks that used TeamViewer as the command channel between the attackers and the victim.\n\nThe doatk table contains the following entries:\n```\n| id | doatk | komments                       |\n| 1 |   0 | Obshie manevri. Ispolzovat' tolko s razreshenija S-a. |\n| 2 |   0 | vkluchenie oomask                   |\n| 3 |   0 | Ispolzovanie bilda 5016                |\n| 4 |   0 | Ispolzovanie bilda 5018 vihodov 5 i off        |\n| 5 |   0 | Ispolzovanie bilda 5034 VML              |\n| 6 |   0 | Using 5016d                      |\n| 7 |   0 | Using 5053 (VML DebSXS) v70XX             |\n| 8 |   0 | Using 5153 (HTML 7.0) v70xx              |\n\n```\n**Figure 14  – Content of the doatk table found on bannetwork.org**\n\nThe list may contain specific attacks, and the comments may refer to the campaign ID or the version\nnumber used.\n\nThe log table contains information about the IP addresses and user agents that accessed the C&C\nserver and the referrer of the queries. The timestamps show that the latest data logged is from 2009:\n\n13\n\n\n-----\n\n```\n/home/bannetwo/public_html/5016d/oo.php \nXXX.XXX.118.40      \nMozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; MRA 4.10 (build 01952); MRSPUTNIK 1,\n8, 0, 17 SW; NetCaptor 7.5.4; .NET CLR 1.1.4322)      \nwww.kavkazanhaamash.com/                          \nru                 \n1215148098 \n/home/bannetwo/public_html/5016d/oo.php \nXXX.XXX.102.64       \n'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1b2)'                        \nkavkazanhaamash.com/index.php?option=com_content&task=view&id=178&Itemid=31                 \n1215147932 \n\n```\n**Figure 15 – Sample from the contents of the log table found on bannetwork.org**\n\nThis gives the idea that we are actually seeing an exploit kit/ watering hole attack here. The attacked\nhosts are like kavkazanhaamash.com, they contain malicious contents (exploits). After successful\nexploitation, the malicious content downloads additional modules from the current site\n(bannetwork.org). Information is available about possible other similar web pages:\n```\nichkeria.info\nkavkazanhaamash.com\nchechenpress.org\ncaucasuslive.org\nkonflikt.ru\nwww.daymohk.org/rus\nwww.turkmenistan.gov.tm\nwww.timorseada.org\nwww.kauna-talu.com.ua\n\n```\n**Figure 16 – Some web pages possibly used for watering hole type of attacks**\n\nThe stat tables (stat, stat2, stat5057, stat5058) also seem to contain access log data, but most of the\ntime, old information:\n```\nstat:\n| 100 | 2010-07-29 03:59:30 | 207.46.12.109 | Windows Server 2003 | MSIE  | US   |  1        \n| 99 | 2010-07-28 04:20:06 | 207.46.12.163 | Windows Server 2003 | MSIE  | US   |  1 \nstat2:\n| 105 | 2010-07-29 01:18:31 | 207.46.195.206 | Windows Server 2003 | MSIE  | US   |  1   \n| 104 | 2010-07-28 03:41:00 | 207.46.12.64  | Windows Server 2003 | MSIE  | US  \nstat5057:\n| 169 | 2010-07-29 11:59:33 | 208.80.194.31 | Windows XP   | MSIE  | US   |\n208.80.194.31Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; FunWebProducts; .NET CLR\n1.0.3705; .NET CLR 1.1.4322; Media Center PC 4.0; .NET CLR 2.0.50727; Zune 2.0)  |  0 |    \n| 170 | 2010-07-29 11:59:33 | 208.80.194.31 | Windows XP   | MSIE  | US   |\n208.80.194.31Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; YPC 3.2.0; .NET CLR 1.0.3705;\nMedia Center PC 3.1; .NET CLR 1.1.4322; yplus 5.1.04b)\nstat5058:\n| 57 | 2010-07-29 11:59:36 | 208.80.194.31 | Windows XP     | MSIE7  | US |  0 |  |\n| 56 | 2010-07-29 08:29:12 | 207.46.12.120 | Windows Server 2003 | MSIE7  | US |  1 |  |\n\n```\n**Figure 17 – Content of the stat* tables found on bannetwork.org**\n\n14\n\n\n-----\n\nNote that the IP address 208.80.194.31 belongs to Websense company, so perhaps the campaigns\n5057 and 5058 has been identified and Websense security researchers checked the attackers’ server\nafter which they stopped their attack (no more logs collected).\n\nThe tables stat_TV and stat_TV_log has some more recent entries. The oldest entry in stat_TV has\nthe timestamp 1316787025 which is Fri, 23 Sep 2011 14:10:25 GMT until now. Similarly, stat_TV_log\ncontains data from 1316774934 (Fri, 23 Sep 2011 10:48:54 GMT) until now.\n\nTable stat_TV contains ~800 IP addresses from the following countries (number of IPs + country):\n```\n   1 BE, Belgium\n   1 CD, Congo, The Democratic Republic of the\n   2 CH, Switzerland\n   8 DJ, Djibouti\n   2 ES, Spain\n   4 FR, France\n   1 GE, Georgia\n   2 IN, India\n   33 IR, Iran, Islamic Republic of\n   1 IT, Italy\n   2 KE, Kenya\n   16 KZ, Kazakhstan\n   1 NO, Norway\n   1 RO, Romania\n  706 RU, Russian Federation\n   2 SE, Sweden\n   18 TR, Turkey\n   4 UA, Ukraine\n   5 US, United States\n   2 VN, Vietnam\n\n```\n**Figure 18 – Distribution of IP addresses in table stat_TV found on bannetwork.org**\n\nWe depict the information on the IP address distribution in the following heat map.\n\n**Figure 19 – Distribution of IP addresses as a map in table stat_TV found on bannetwork.org**\n\n15\n\n\n-----\n\nTable stat_TV_log has essentially the same content. Most of the Russian IP addresses seem to\nlocated in Ingushethia (e.g., 212.94.14.XXX from ingushsvyaz network). Note, that this map was\ncreated by the IP addresses only, so it is possible that some victims with dynamic IP addresses are\nshown multiple times.\n\nWhile stat_TV table is the most interesting, as “TV” refers to the TeamViewer campaign, the victim IP\ninformation stored in different tables among different C&C servers are also revealing.\nHere, we show distribution of IP addresses on heat maps for each information source. One can\nclearly see how different campaigns focus on different geographic regions.\n\n**Figure 20** **– Distribution of IP address used to upload files into the bannetwork.org FTP server,**\n**2010-02-01 – 2013-02-25**\n\n16\n\n\n-----\n\n**Figure 21– Distributions of IP addresses in the stat2 table of bannetwork.org, 2010-05-14 - 2010-07-29**\n\n**Figure 22– Distributions of IP addresses in the stat5057 table of bannetwork.org, 2010-07-16- 2010-07-29**\n\n17\n\n\n-----\n\n**Figure 23– Distributions of IP addresses in the stat5058 table of bannetwork.org, 2010-07-16- 2010-07-29**\n\n**Figure 24– Distributions of IP addresses in the statistic table of bannetwork.org, 2010-07-23- 2010-07-29**\n\n18\n\n\n-----\n\n**Figure 25– Distributions of IP addresses in the stat table of bannetwork.org, 2010-05-14- 2010-07-29**\n\n**Figure 26– Distributions of IP addresses in the log table of bannetwork.org**\n\n\n19\n\n\n-----\n\n##### 3.4 Statistics from other C&C servers\n\n**Figure 27 – Distribution of IP addresses politnews, “getid” function, data 2012-10 to 2012-12-06**\n\n**Figure 28– Distributions of IP addresses in the bots table of polit_new database**\n\n\n20\n\n\n-----\n\n**Figure 29– Distributions of IP addresses in the seansi table of polit_new database**\n\n**Figure 30– Distributions of IP addresses in the seansi table of polit_agent_database**\n\n\n21\n\n\n-----\n\n**Figure 31– Distributions of IP addresses in bulbanews.org DreamLite DB error log, 2011-09-08-2013-03-13**\n\n22\n\n\n-----\n\n### 4. Hashes of known malware modules\n```\nd21cabb0c00595cfe7a74607fd85954e *avicap32.dll (teamviewer)\n0926bf7a4623d72311e43b16d667ae1a *DSC.exe (installer)\n3299885cf257d6482ee0f2132585e9c6 *TeamViewer.ico (installer)\nf445d90fdd7ab950adabc79451e57e2a *NetScanFiles_2.jpg (executable)\n696f408af42071fbf1c60e6e50b60e09 *NetScanShares_2.jpg\n341b430d96a06d9489fc49206a5b1cdd *SystemInfoSafe_2.jpg\n5c7bf0bb019b6c2dcd7de61f89a2de2e *SystemInfo_2.jpg\ncd56d04639dd395a035bc2a2e11f5d3d *bi.jpg\n6b3a74728f8683c0fa14a2675e5364c6 *fileList_2.jpg\nb3258020b9ab53a1635da844aed955ea *klg.jpg\n5f7a067f280ac0312abfbd9ee35cb522 *sc_and_console.jpg\nc75f7a3a1d1695797e1a55e1200a6044 *acxAgin.dll\n0b74db5420416129ce82c65c03df337e *acxMonitor.exe\n5c03228a7f9149b07fc7316d68119342 *planetnews_ode.ex\n90e94213e30bbcc37ce5ba79442310bd *planetnews_odi.ex\nba7f9a2cec106773d17df4f571b4b8e8 *politenews_ct.ex\nba586d6e142aa9c6ca79aeee709456ed *politnews_201611_10.txt_ex\n3962e531a76bb6ca4f95d5cc5566311a *politnews_201611_11.ex\n0ea74e62f388289c29e6f33b7a24092c *politnews_201611_12.ex\n0595cfd03a907848de03b153ce0b49e3 *politnews_201611_8.ex\n6ce9d38bce3915f1bc007b24ed8921e8 *politnews_201611_9.ex\nbbd2ffbe44cc3534dc0d1df533867777 *politnews_201617_10.ex\n0ea74e62f388289c29e6f33b7a24092c *politnews_201617_11.ex\n105717c09298da26f27efa132657b4b0 *politnews_201617_8.ex\n966721bc07b1d561314dcc3286744dd9 *politnews_201617_9.ex\nce22d988e1023843474849176ceb18b9 *politnews_cp.ex\na34d3909ce3f91aa3ace63bbf29e6340 *politnews_di.ex\n5c03228a7f9149b07fc7316d68119342 *politnews_fe.ex\n17430f5e1af28e8c25dc34684e647c97 *politnews_ieh.ex\nebfb4a858b4c172b8f92bb4b8fa0b020 *politnews_kbas_201617_8.ex\n22dd42246ebec969e1a9c608793a644e *politnews_n.ex\n3b37f7e46d75398c03344c7f778d0e28 *politnews_nb.ex\n0fdb2616920bfd47b7e1205f831261b3 *politnews_nsd.ex\nce22d988e1023843474849176ceb18b9 *politnews_ocp.ex\nba7f9a2cec106773d17df4f571b4b8e8 *politnews_oct.ex\n3b37f7e46d75398c03344c7f778d0e28 *politnews_onb.ex\n0f9c86ea21f37d0a3b8c842302c4b262 *politnews_otr.ex\n9c2f495379b0b013a89eb6e1f8a6b717 *politnews_overlay_201606_9.ex\n3b37f7e46d75398c03344c7f778d0e28 *politnews_overlay_203426_25.ex\n3b37f7e46d75398c03344c7f778d0e28 *politnews_reqdis_201611_8.ex\n3a6282107987adec9a768169ef77823f *politnews_sc_1.ex\n0f9c86ea21f37d0a3b8c842302c4b262 *politnews_tr.ex\ncbf6f449c54f11d4ac28fad203c1d88a *bi_1.ex\ned12789b2efc87c4f39fa2367755c835 *3.exe\nd3aea67a9f189c1d1f8da9669dc693c8 *mod3_2.ex\na4b75778e89e9f69ea808e0fe257fa7a *atl_1 (module 3 parts)\na8488c36a9dcecff1c81fdbc89d21dff *atl_2\n276f480ef79e86bcf83f7a2be6e91c9a *atl_3\n\n```\n\n23\n\n\n-----\n\n```\nb36c7479791c1c370c727b426185321a *atl_4\n28442e848a200fb873b830c060c75616 *politnews_mod3_index4.hta (visual basic script)\n9e8daad0b3591bf83c88048c82d00bfe *mod3_1.ex\n72ec4047db89a70e5be7370a19bcd600 *CmdCapture.exe (probably legitimate)\n01522d075c026b809a747cb44a10c885\n708ceccae2c27e32637fd29451aef4a5\nb0b59e2569fb1de00f76a8d234d2088a\n22d9278c43700b82260a7ad212192ab6\n539b0094e07e43bfced8a415ba5c84e3\n\n```\n**Figure 32 – MD5 hash list**\n```\nb7aeddaea76fa97fb2bab9c1c0a4a14038ad37c2 *avicap32.dll (teamviewer)\nb23f0a628c0f612a38975ac4edbbf14b6b80ec91 *DSC.exe\n9507ef76cdc79cd3de59c0770d166d6f9161ce2b *TeamViewer.ico\na37187a2f6bd3f3daf5db46e9058380f94fae7a4 *NetScanFiles_2.jpg (executable)\ndb0cbb2405749e9ad24cbe8d2da5e6e913ca51a9 *NetScanShares_2.jpg\nac3753635ac0fb9c05f52da5057fa32ee4da034d *SystemInfoSafe_2.jpg\n7e9314629d8607948933eeb9c51f71ede30582c3 *SystemInfo_2.jpg\n3438c55aa2e8b9a3c998b56cc16d034b7183f351 *bi.jpg\ned7dc72f00dcddf9aa89f77c778731216c3830e9 *fileList_2.jpg\ne672d02adc947910a425691fab34eed13fd2fbc7 *klg.jpg\n005b5a71c9b4afc45c404103584ae98ed033deef *sc_and_console.jpg\nda5c7c3bb8f6ad3bde1f29e5f6a8bb640fecf09d *acxAgin.dll\n890c4462d23777752e60b425de2ab5fdb379ae42 *acxMonitor.exe\n4db050497d56c1537ec2787512a18da091027960 *planetnews_ode.ex\n8d9fe12071906f05c9050cf20152dd9ae381d292 *planetnews_odi.ex\n80144e50051431badda4ffaf4a8920617639d57e *politenews_ct.ex\na7c2399ce2dfed5bc4eb8549990c674b8afe8097 *politnews_201611_11.ex\n172bc3c4cbf3c9187bcb0bc77e350af121b2c2d2 *politnews_201611_12.ex\n1f129bc1f05a34434394c0991c11045b3310e535 *politnews_201611_8.ex\n4a8187d66d1f62c274908d8995aa9eb2d64eeb47 *politnews_201611_9.ex\ne42d74c081ad5b86cad7f14c17b605696c7a7a03 *politnews_201617_10.ex\n172bc3c4cbf3c9187bcb0bc77e350af121b2c2d2 *politnews_201617_11.ex\n1921f9fa117c19fabd8754350827210752893019 *politnews_201617_8.ex\n7ccd60ba7310039a593cb97116b976a7dffa1bcc *politnews_201617_9.ex\n841bedfd39276b1ac8eb0540d83e95c99833bc2f *politnews_cp.ex\n3a6b892c53c881a77e67500ff4fe7f8630ef6ea3 *politnews_di.ex\n4db050497d56c1537ec2787512a18da091027960 *politnews_fe.ex\n6dded3f2cda4e7399081ea1b2eea5d60c8b0457a *politnews_ieh.ex\n6b27de2258d5b6035f8a4692a638ad779bfdfef9 *politnews_kbas_201617_8.ex\n95a80fcfa8d278e340e931bcc24f144023114e53 *politnews_n.ex\n59cbf6e6f6e92a4998dc54e6a7905590df875653 *politnews_nb.ex\n39c5e44f0b836d2244293829486d45a2b3ada63b *politnews_nsd.ex\n841bedfd39276b1ac8eb0540d83e95c99833bc2f *politnews_ocp.ex\n80144e50051431badda4ffaf4a8920617639d57e *politnews_oct.ex\n59cbf6e6f6e92a4998dc54e6a7905590df875653 *politnews_onb.ex\n4205fd58209968b173adaf5e8d2fb57343b06e60 *politnews_otr.ex\n63d9622578205bca62aa2f1b35c930a4d2923d18 *politnews_overlay_201606_9.ex\n59cbf6e6f6e92a4998dc54e6a7905590df875653 *politnews_overlay_203426_25.ex\n59cbf6e6f6e92a4998dc54e6a7905590df875653 *politnews_reqdis_201611_8.ex\n7d1c331b8920e3f4a1bad126b12552f0c3e44ca4 *politnews_sc_1.ex\n4205fd58209968b173adaf5e8d2fb57343b06e60 *politnews_tr.ex\n00f7e6d60360f066c9c184284f0f4e233e0d8658 *bi_1.ex\n\n```\n24\n\n\n-----\n\n```\nc21fddbb247813f0742c34f9e9678acef58150a7 *3.exe\n080895aee628835628a15a94747d456517aac2b8 *mod3_2.ex\n53f0d9ea073749f808e0453cf52c225da8e08627 *atl_1\n5128523f4d3f268dbcdc1480c13acd0fe1621f0c *atl_2\n2da90dee3d2cfe1b4be5a3b6d59c65d997a3660d *atl_3\n67bc227c8a1d15571ccdd1c8ca7708f0de5e1ab5 *atl_4\n31ad3210d8c3c62582defaff312fe52ecd1e561d *politnews_mod3_index4.hta\nd0d69b0783a5905bc1d7c9ed1e1996179ce009a7 *CmdCapture.exe\n399763293405c8a498b182247b492aca7d242b30 *mod3_1.ex\nd6059e02698071cb4980d61ae44707e37f027be4 *01522d075c026b809a747cb44a10c885\n3d4c6a0119a9f2d9384406326820cc79bde21a81 *708ceccae2c27e32637fd29451aef4a5\n2765b4e748e5d547f08ba67c2594de07e4cb056f *b0b59e2569fb1de00f76a8d234d2088a\n1cce8b615a118e49898e6dcd0f43c001728ede0a *22d9278c43700b82260a7ad212192ab6\n2b677dc5e1e14818dbe31f5913453eeaa8cf7230 *539b0094e07e43bfced8a415ba5c84e3\n\n```\n**Figure 33 – SHA1 hash list**\n\nThe following table is created from the ftp log data obtained from the bannetwork.org ftp server. The\nfilenames reveal information about how many other modules, not yet found, existed on the site and\nused in recent years. The list also contains known module names, the functionality of those are\ndescribed later in this document.\n\n**File** **Language** **Translation**\n\n.222.htaccess.suspend\n1.exe\n5056/spl/vx_2c.exe\n5056_2/spl/vx_2c.exe\n5057/spl/error_log.txt\n5057/spl/inc/GeoIP.dat\n5057/spl/inc/images/dot.gif\n5057/spl/inc/images/style.css\n5057/spl/logo.gif\n5057/spl/ms-041.jpg\n5057/spl/shl.js\n5057/spl/shl.js.txt\n5057/spl/spl/buf.png\n5057/spl/vx_2c.exe\n5057/xmps5060/dx_ds.gif\n5057/xmps5060/elen2.sql\n5057/xmps5060/GeoIP.dat\n5057/xmps5060/i/1.png\n5057/xmps5060/i/clear.gif\n5057/xmps5060/i/country.gif\n5057/xmps5060/i/footer.jpg\n5057/xmps5060/i/form_inputtext.jpg\n5057/xmps5060/i/heading_background.jpg\n5057/xmps5060/i/heading_background_-_НЙк__.jpg Ukranian …_-_NYk__.jpg\n5057/xmps5060/i/ifr.gif\n\n25\n\n|File|Language|Translation|\n|---|---|---|\n|.222.htaccess.suspend 1.exe 5056/spl/vx_2c.exe 5056_2/spl/vx_2c.exe 5057/spl/error_log.txt 5057/spl/inc/GeoIP.dat 5057/spl/inc/images/dot.gif 5057/spl/inc/images/style.css 5057/spl/logo.gif 5057/spl/ms-041.jpg 5057/spl/shl.js 5057/spl/shl.js.txt 5057/spl/spl/buf.png 5057/spl/vx_2c.exe 5057/xmps5060/dx_ds.gif 5057/xmps5060/elen2.sql 5057/xmps5060/GeoIP.dat 5057/xmps5060/i/1.png 5057/xmps5060/i/clear.gif 5057/xmps5060/i/country.gif 5057/xmps5060/i/footer.jpg 5057/xmps5060/i/form_inputtext.jpg 5057/xmps5060/i/heading_background.jpg 5057/xmps5060/i/heading_background_-_НЙк__.jpg 5057/xmps5060/i/ifr.gif|Ukranian|…_-_NYk__.jpg|\n\n\n-----\n\n|5057/xmps5060/i/index.css 5057/xmps5060/i/logout.gif 5057/xmps5060/i/main.gif 5057/xmps5060/i/referer.gif 5057/xmps5060/i/submit.jpg 5057/xmps5060/i/Thumbs.db 5057/xmps5060/i/wrapper-a.jpg 5057/xmps5060/i/wrapper-b.gif 5057/xmps5060/img.jpg 5057/xmps5060/vx_2c.exe 5058/spl/vx_2c.exe 5060/dx_ds.gif 5060/elen2.sql 5060/error_log 5060/GeoIP.dat 5060/i/1.png 5060/i/clear.gif 5060/i/country.gif 5060/i/footer.jpg 5060/i/form_inputtext.jpg 5060/i/heading_background.jpg 5060/i/heading_background_-_НЙк__.jpg 5060/i/ifr.gif 5060/i/index.css 5060/i/logout.gif 5060/i/main.gif 5060/i/referer.gif 5060/i/submit.jpg 5060/i/Thumbs.db 5060/i/wrapper-a.jpg 5060/i/wrapper-b.gif 5060/load.exe 5060/vx_2c.exe bi.jpg bn5.jpg brbr.jpg ContainerAMI_ENC_3.exe crypted.exe crypted_18_10_2011.exe crypted_bulba_2012_05_04.exe crypted_el.exe Проверка_на_прото_2.exe DREAMLITE_SKOTINA.exe DS.exe DS.jpg DSC.exe getBatList-можно_выдавать_2012_02_27_без_lzf_xor.exe|Ukranian Russian Lithuanian Russian|…_-_NYk__.jpg Check_for_proto_2.exe DREAMLITE_GROUSE may_be_issued_2012_ 02_27_without_lzf_xor.exe|\n|---|---|---|\n\n\n26\n\n\n-----\n\n|getiosdata.exe InstallTV.exe ipconfig.jpg job.txt klg-1.exe klg.exe klg.jpg log.txt Mbox.exe New/fileList_2.jpg New/NetScanFiles_2.jpg New/NetScanShares_2.jpg New/SystemInfo_2.jpg New/SystemInfoSafe_2.jpg proxy.jpg reg.exe reg.jpg result.txt sc_and_console.jpg submit.jpg TeamViewer.exe TestProto2Dream.exe TV6.jpg unpack-можно_выдавать_2011_11_11.exe unpack.exe user_offline.gif user_online.gif WebCam.exe WebCamGrabbing.exe|Russian|…-may_be_issued_...|\n|---|---|---|\n\n\n**Figure 34 – List of files uploaded to the bannetwork.org FTP server. The list does not contain .php files**\n\n\n27\n\n\n-----\n\n### 5. Analysis of individual modules \n\n##### 5.1 Avicap32.dll\n\nThe investigation described in this document was started by the discovery of unusual network traffic\npatterns. Later, it was found that the suspicious network traffic is due to a malware based on the\nTeamViewer application. The installation of the malware is based on a NullSoft installer. We are\naware of two versions of this installer using the filenames DSC.exe and TeamViewer.ico. During\ninstallation, the following files are saved into the folder “\\Documents and Settings\\user\\Application\nData”:\n\navicap32.dll\nTeamViewer.exe (d0847c10f8b2253b194cda859d3a52a3)\nTeamViewer_Resource_ru.dll (165e720c32ae372864b9b654e44e2650)\ntv.cfg\n\nThe TeamViewer parts are genuine, digitally signed TeamViewer binaries, except for Avicap32.dll.\nThe DLL Avicap32.dll modifies the behavior of TeamViewer by removing its icon from the system\ntray. The module uses the encrypted tv.cfg configuration file, which contains parameters for the C&C\ncommunication. The encryption is based on the Volume ID of the hard drive.\n```\n result = GetVolumeInformationA(\n       RootPathName,\n       0,\n       0,\n       &VolumeSerialNumber,\n       &MaximumComponentLength,\n       &FileSystemFlags,\n       0,\n       0);\n if ( result )\n {\n  v1 = VolumeSerialNumber;\n  v5 = VolumeSerialNumber ^ _byteswap_ulong(VolumeSerialNumber);\n  v2 = 0;\n  v3 = 4;\n  do\n  {\n   v4 = *((_BYTE *)&v5 + v2++);\n   v1 = v4 + ((v1 >> 27) | 32 * v1);\n   --v3;\n  }\n  while ( v3 );\n  result = v1;\n }\n\n```\n**Figure 35 – tv.cfg encryption key derived from Volume ID**\n\nIf the malware finds procexp.exe (Sysinternals Process Explorer) running, then it quits. Simple\nrenaming of the tool can help during investigations. More detailed analysis is ongoing on this sample.\n\n28\n\n\n-----\n\n##### 5.2 Modules found on bannetwork.org\n\nModules found on this server are most likely connected to recent activities of the attackers.\nTherefore, these modules can be used to infer the relationship between new and old campaigns\ncarried out by the attackers. Indeed, the identified structure and functionality of these modules let us\nconclude that the creators of these modules are the same as the creators of some older samples\nfound on other C&C servers. Most of these modules provide very basic functionality with very\nefficient, simple code.\n\nAll executable files disguised as JPG images and they are encrypted. Encryption is based on cyclic\nXORing with the 5-byte key 0x0e 0f 10 11 12. No additional header is given, thus, all the encrypted\nimages begin with “CU” which is the encryption of “MZ”.\n```\n0000000000: 43 55 80 11 11 0E 0F 10 │ 15 12 0E 0F EF EE 12 0E CU?◄◄♫☼►§↕♫☼ďî↕♫\n0000000010: B7 10 11 12 0E 0F 10 11 │ 52 0E 0F 10 11 12 0E 0F •►◄↕♫☼►◄R♫☼►◄↕♫☼\n0000000020: 10 11 12 0E 0F 10 11 12 │ 0E 0F 10 11 12 0E 0F 10 ►◄↕♫☼►◄↕♫☼►◄↕♫☼►\n0000000030: 11 12 0E 0F 10 11 12 0E │ 0F 10 11 12 E6 0F 10 11 ◄↕♫☼►◄↕♫☼►◄↕ć☼►◄\n0000000040: 1C 11 B5 1E 11 A6 07 C2 │ 31 A9 13 42 C2 31 45 7A ∟◄u▲◄|•Â1c‼BÂ1Ez\n0000000050: 67 7C 30 61 60 61 68 62 │ 70 7F 2E 6C 71 7F 7C 61 g|0a`ahbp⌂.lq⌂|a\n0000000060: 7B 30 73 77 2E 7D 65 7F │ 32 67 61 30 55 5D 5D 2F {0sw.}e⌂2ga0U]]/\n\n```\n`0000000070: 7D 7E 76 6B 21` `1D` `1C 18` │ 2A 0F 10 11 12 0E 0F 10 }~vk!↔∟↑*☼►◄↕♫☼►\n\n**Figure 36 – Encrypted MZ files masqueraded as JPG from bannetwork.org**\n\n##### bi.jpg\n\nhash: CD56D04639DD395A035BC2A2E11F5D3D\ncompile time: 2012-10-25\n\nThis module runs the commands “wmic os get /format:HFORM” and “wmic bios list /format:HFORM”\nand saves the output into the file “ProgramData\\Adobe\\AdobeArm\\ sysdll155.html”. The outputs of\nthese commands contain basic information (the name “bi” may refer to this) about the system\nconfiguration and the operating system settings. There seems to be some delay in the execution\n(“wait” in the code). After completing execution, the module deletes itself.\n\n##### fileList_2.jpg\n\nhash: 6B3A74728F8683C0FA14A2675E5364C6\ncompile time: 2012-07-18\n\nThis module writes the list of files found on the infected system whose filename match specific\ntemplates into the file “\\ProgramData\\Adobe\\AdobeArm\\sysdll2.txt”. The set of specific templates\nused for filtering is the following: *.pst, *.mdb, *.doc, *.rtf, *.xls, *.pgp, *.pdf, *.vmdk, *.tc, *.p12,\n*pass*.*, *secret*.*, *saidumlo*, *секрет*.* and *парол*.*\n\n29\n\n\n-----\n\nNote that the word “saidumlo” means “secret” in Georgian (საიდუმლო), and *секрет*.* and\n*парол*.* are written in Cyrillic and they mean “secret” and “password”, respectively, in Russian.\n\nBased on these templates, we can conclude that the attackers are interested in office documents and\nfiles (e.g., *.doc, *.rtf, *.xls, *.mdb), pdf files (*.pdf), disk images (e.g., *.tc, *.vmdk), as well as files\nthat potentially contain sensitive information such as keys (e.g.,*. pgp, *.p12) and passwords (e.g.,\n*pass*, *secret*, *saidumlo*, *секрет*.* and *парол*.*).\n\nThe following is a sample output produced by the module:\n```\n[/N2.0-01.01.01.00:0000000630]\nc:\\Documents and Settings\\Default User\\Templates\\winword.doc 4608 04.08.2004 12:00\nc:\\Documents and Settings\\Default User\\Templates\\winword2.doc 1769 04.08.2004 12:00\nc:\\Documents and Settings\\Default User\\Templates\\excel.xls 5632 04.08.2004 12:00\nc:\\Documents and Settings\\Default User\\Templates\\excel4.xls 1518 04.08.2004 12:00\nc:\\Documents and Settings\\vendeg\\Templates\\winword.doc 4608 04.08.2004 12:00\nc:\\Documents and Settings\\vendeg\\Templates\\winword2.doc 1769 04.08.2004 12:00\nc:\\Documents and Settings\\vendeg\\Templates\\excel.xls 5632 04.08.2004 12:00\nc:\\Documents and Settings\\vendeg\\Templates\\excel4.xls 1518 04.08.2004 12:00\nc:\\WINDOWS\\Debug\\PASSWD.LOG 0 06.03.2013 13:22\nc:\\WINDOWS\\Help\\password.chm 21891 04.08.2004 12:00\nc:\\WINDOWS\\ServicePackFiles\\i386\\passwrdw.chm 21891 04.08.2004 12:00\nc:\\WINDOWS\\system32\\config\\systemprofile\\Templates\\winword.doc 4608 04.08.2004 12:00\nc:\\WINDOWS\\system32\\config\\systemprofile\\Templates\\winword2.doc 1769 04.08.2004 12:00\nc:\\WINDOWS\\system32\\config\\systemprofile\\Templates\\excel.xls 5632 04.08.2004 12:00\nc:\\WINDOWS\\system32\\config\\systemprofile\\Templates\\excel4.xls 1518 04.08.2004 12:00\nc:\\WINDOWS\\system32\\ias\\dnary.mdb 294912 04.08.2004 12:00\nc:\\WINDOWS\\system32\\ias\\ias.mdb 233472 04.08.2004 12:00 \n\n```\n**Figure 37 – Sample file list collected by the fileList_2.jpg module**\n\n##### klg.jpg\n\nhash: B3258020B9AB53A1635DA844AED955EA\ncompile time: 2013-01-28\n\nThis is a keylogger module. It copies itself into the file “C:\\Documents and\nSettings\\vendeg\\Application Data\\WCF Data Services\\WcfAudit.exe” and also creates the shortcut\n“C:\\Documents and Settings\\vendeg\\Start menu\\Programs\\Startup\\WcfAudit.lnk” in order to start\nautomatically at the next boot.\n\nThe following figure shows the running WcfAudit.exe process:\n\n30\n\n\n-----\n\n**Figure 38 – The keylogger is running as WcfAudit.exe**\n\nThe keylogger saves output into files with extension .klg. The saved output contains per-process\nkeylogs in unencrypted form. Below is a sample output from a file called klg71378843.klg:\n```\n*************************** Process Monitor - Sysinternals: www.sysinternals.com\n*************************** [17:18 - 07/03/2013; Procmon.exe;]\nsdsdfdsfasdfasdfsadfasdf\n*************************** {C:\\Documents and Settings\\vendeg\\Application Data\\WCF Data\nServices} - Far 2.0.1807 x86 Administrator *************************** [17:18 - 07/03/2013;\nFar.exe;]\nssdfsdfsdfsdfsdfdfgdfgdfgsdfgsdfg[RSHIFT][HOME]dsf;lkj;lasjdflj[LWIN]\n*************************** Start Menu *************************** [17:19 - 07/03/2013;\nexplorer.exe;]\nnote\n*************************** Windows XP Tour *************************** [17:19 - 07/03/2013;\ntourstart.exe;]\n[ESC]\n*************************** Run *************************** [17:20 - 07/03/2013;\nexplorer.exe;]\nnotepad[ENTER]\n*************************** Untitled - Notepad *************************** [17:20 07/03/2013; notepad.exe;]\nlakjsdf;lkjz[ENTER]\nxcvz[ENTER]\ncxv[ENTER]\n\n```\n**Figure 39 – Sample of the output of the keylogger module. Keylogs are collected on a per process basis.**\n\n31\n\n\n-----\n\n##### NetScanFiles_2.jpg\n\nhash: F445D90FDD7AB950ADABC79451E57E2A\ncompile time: 2012-07-19\n\nThis module scans mapped network shares for specific file names and writes their list into the file\n“\\ProgramData\\Adobe\\AdobeArm\\sysdll2.txt”\nThe file names to be found include the follwoing: *saidumlo* *secret*.* *секрет*.* *парол*.*\n*.xls  *.pdf  *.pgp  *pass*.*  *.rtf  *.doc”\n\nThe collected file list consists of items formatted according to the following structure:\n“[/N2.0-02.02.01.00:0000000032]\\\\SRV\\share\\a.xls   5    01.03.2013 06:43”\n\n##### NetScanShares_2.jpg\n\nhash: 696F408AF42071FBF1C60E6E50B60E09\ncompile time: 2012-07-19\n\nThis module enumerates network resources and writes its output into the file\n“\\ProgramData\\Adobe\\AdobeArm\\sysdll2.txt”\nThe output contains Server, Share and Domain lists in use by the computer.\nInterestingly, the binary contains leftover data that is not used, like the listing of interesting files:\n“*saidumlo* *secret*.* *секрет*.* *парол*.*  *.xls  *.pdf  *.pgp  *pass*.*  *.rtf  *.doc”\n\n##### SystemInfo_2.jpg\n\nhash: 5C7BF0BB019B6C2DCD7DE61F89A2DE2E\ncompile time: 2012-07-19\n\nThis module obtains information about the victim system and its environment by executing the\nfollowing commands:\n```\nroute print\nnetstat -r\nnetstat -b\nnetstat -a\nsysteminfo\nwmic computersystem get * /format:list\nwmic os get * /format:list\nwmic logicaldisk get * /format:list\nwmic product get * /format:list\nwmic service get * /format:list\nwmic process get * /format:list\nwmic useraccount get * /format:list\nwmic qfe get * /format:list\n\n```\nOutput is written into “\\ProgramData\\Adobe\\AdobeArm\\sysdll2.txt”\n\n\n32\n\n\n-----\n\n##### SystemInfoSafe_2.jpg\n\nhash: 341B430D96A06D9489FC49206A5B1CDD\ncompile time: 2012-07-20\n\nThis module lists running processes and process IDs, and it saves the values of the following system\nvariables:\n\nSYSTEMDRIVE\nPROGRAMDATA\nCOMPUTERNAME\nOS\nPROCESSOR_ARCHITECTURE\nPROCESSOR_IDENTIFIER\nPROCESSOR_LEVEL\nNUMBER_OF_PROCESSORS\nUSERDOMAIN\nUSERNAME\nTIME\nPATH\n\nIt then lists all directories that have been modified (i.e., contain modified files) since the creation\ntime of the directory. The output contains the directory path and the last modification time of the\nmodified directory entry.\n\nOutput is written into “\\ProgramData\\Adobe\\AdobeArm\\sysdll2.txt”\n\n##### getiosdata.jpg \n\nhash: 83A1634F660D22B990B0A82B1185DE5B\ncompile time: 1992-06-19 (most likely be fake)\n\nThis module searches through the %APPDATA% directory for files with .plist extension. Found files\nare then copied into the folder “C:\\ProgramData\\Adobe\\AdobeArm” under their original name. It is\nlikely that the attackers wanted to obtain Apple iOS .plist files that may be saved on the victim\ncomputer as a result of synchronizing with Apple devices.\n\n33\n\n\n-----\n\n##### 5.3 Modules found on planetanews.org\n\nThe modules found on the servers planetanews.org and politnews.org are generally old, they most\nlikely belong to older campaigns. The files are generally stored in files with “.txt” extension in ASCIIhexadecimal format extended with command tags. An example is shown below:\n```\n[DATA]<br>\n4D5A90000300000004000000FFFF0000B8000000000000004000000000000000000000000000000\n0CCCCCCCCCCE966000000E996000000E970020000E9CB000000E92F020000E90E010000E9C70200\n…\n00000000000000<br>\n[/DATA]<br>\n[EXT]<br>\nc:\\sys.exe<br>\n\n```\n**Figure 40– Executable file format in .txt files found on planetanews and politnews**\n\nAs one can see, the hex string begins with 4D5A, which is the equivalent of “MZ”, so no extra\nencryption is in place.\n\nMost likely these modules are deciphered and used by C&C communication tools, like the sample\nb0b59e2569fb1de00f76a8d234d2088a described below.\n\nSome of the modules are found in raw hex-ascii files like:\n```\n4D5A90000300000004000000FFFF0000B80...\n\n```\n**Figure 41– Executable file format in .txt files found on politnews – without tags – ct.txt**\n\n##### ode.txt\n\nhash: 5c03228a7f9149b07fc7316d68119342\ncompile time: 2009-08-04\n\nThis module saves the list of running processes and the content of the “\\windows\\system32\\wbem”\nfolder into the file “C:\\sysdll12.txt”\n\n##### ct.txt\n\nhash: BA7F9A2CEC106773D17DF4F571B4B8E8\ncompile time: 2009-08-11\n\nThis module uses the GetTcpTable call and saves the list of active TCP connections and their status\ninto the file “C:\\\\sysdll9.txt”.\n\n34\n\n\n-----\n\nInterestingly, executable contains command reference for traceroute (check otr.txt), but it is not\nused. This is an indication of code reuse.\n\n##### 5.4 Modules found on politnews.org\n\n fe.txt\n\nhash: A34D3909CE3F91AA3ACE63BBF29E6340\ncompile time: 2009-07-27\n\nThis module is essentially the same as the ode.txt module found on planetnews.org: It saves the list\nof running processes and the content of the directory “windows\\system32\\wbem” into the file\n“c:\\sysdll9.txt”. One can observe strange use of English inside the code, e.g., the following error\nmessage: \"File not copy\\n\"\n\n##### ieh.txt\n\nhash: 17430F5E1AF28E8C25DC34684E647C97\ncompile time: 2010-02-01\n\nThis module saves the browsing history of Internet Explorer into the text file “C:\\sysdll4.txt”\n\n##### nb.txt (keylogger)\n\nhash: 3B37F7E46D75398C03344C7F778D0E28\ncompile time: 2005-12-06\n\nThis module is identical with other files found on the same server called “nb.txt”, “overlay\\\n203426_25.txt” and “reqdis\\201611_8.txt” and “onb.txt”.\n\nIt creates the following registry entry\n\nwsock32 REG_SZ “C:\\Program Files\\Common Files\\wsock32.exe –i:”\n\nin HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce and saves some data (e.g. “Flags:\n0x00000001 ExtData:00000002”) into the file “C:\\sysdll2.txt”\n\nIt also extracts code from itself and drops two files “kidll.dll” and “wsock32.exe” in the folder\n”C:\\Program Files\\Common Files\\”. The hashes for the dropped components are the following:\n\nkidll.dll\nMD5: 25315f85e1476260651393e86cd81664\nSHA1: 173e672c6f0a44178302ccb0f9b1371227d2c75f\n\n35\n\n\n-----\n\nwsock32.exe\nMD5: 3238f6f8787376c8f1547310d0b8a6dd\nSHA1: 88b955f332f4214f1841555ce03dd0878af99856\n\nThe file “kidll.dll” is UPX encoded and the compile time is 2005-12-06. It writes into files\n“C:\\windows\\system32\\ks.txt” and “C:\\sysdll3.txt”. The file “ks.txt” is basically a cleartext file\ncontaining user activity (e.g., which programs were used and when), while “sysdll32.txt” contains\nkeylog data in encrypted form with larger blocks and markers. The encryption used is XORing with\nthe following hard-coded 1024-byte key:\n```\n              2A 82 6B 09 F0 D7 DC 9A C8 D8 B0 4A 1F 6A 71 11\n              7F 40 BD 1A 90 39 4E 03 D9 50 2A 92 36 AF F9 0E\n              63 2C B1 01 B7 21 0B 32 59 F6 73 13 72 5E 77 E0\n              6C FC C9 CE F9 11 70 E3 96 CB 33 E8 3D F1 D6 93\n              FA 7D C6 D4 A8 C3 31 57 DA EA B9 BA 67 A8 41 FD\n              12 1E 78 30 A8 3F A1 DE 33 9D CC C6 FD 13 6F 51\n              A0 85 13 E1 C1 E0 0E EF C4 6C 7E 6F 17 20 F1 2A\n              D2 9F F5 58 ED 6E 82 30 99 A9 F4 D2 A3 33 87 A0\n              E5 AB 05 7F 28 A9 24 0F F3 06 C1 52 BD AE 6B D8\n              F2 50 72 54 3F 5D F8 C8 1A 21 AD 29 FB 85 A4 8F\n              C3 29 90 72 23 E9 BC 01 A8 17 08 78 BC CF D6 2F\n              9D 55 23 26 B6 DD AD 4C 65 10 FA D8 FA 51 11 5E\n              15 0C AC F8 1F 7C 60 44 08 51 58 EA 19 14 9F 8B\n              DE A5 BF C4 92 55 0E 93 12 D0 E8 64 37 F1 5A 83\n              9A 35 52 42 2B D0 61 8A 9A BC 3E 25 7C A3 F6 7B\n              28 8D 86 1A 34 BF 4B 2B 1C 14 03 C2 EB 55 D4 27\n              F5 DA 01 73 7B 6C 50 3B 4B B2 C9 1A 32 35 CF C3\n              4F AC 37 03 A1 AA 59 D3 60 E0 DC 5F F6 81 13 29\n              AE 87 3C A1 68 E6 84 70 EB 63 8D AE AB 97 63 5B\n              8D F5 16 D3 84 38 73 81 A1 8D 0A 99 DB 0B F1 99\n              B1 98 09 DC 6D 6D 1A 78 AF D0 A2 3A 7E AB 2D 6D\n              80 33 EB D0 AB 1F 94 DC 86 49 25 C2 C2 9E 0F 3D\n              4D BF F3 A1 AB BF 70 57 30 D1 A4 8B 63 66 6D D9\n              29 FD 06 B3 09 A9 7F 43 9A 92 CC A4 F4 7A CB 10\n              34 02 0A 66 E4 31 29 41 E9 90 32 E3 36 D1 29 B4\n              EC 47 B4 AA B0 35 38 44 49 3F A1 F7 E0 F3 4F 3C\n              7F 3B DD 91 02 AA 2D 22 BA 0D EF F5 F8 0A 27 C4\n              95 D2 4C 59 5F 34 89 25 E6 77 C8 EB 1B EF 04 27\n              A9 96 87 00 10 2A 26 19 6A 19 04 6D D0 C1 F4 06\n              D0 37 26 54 EF 2E 7F 5D A9 B9 6D 25 5A 6B 96 E2\n              12 97 21 02 BC BC 84 76 20 5C 9B 65 84 3D E0 28\n              2F 61 1F 25 66 BC EA 9A 2D D4 3B 39 78 74 79 3B\n              FA 14 48 DA DD 89 7A C3 67 51 65 70 83 D5 01 0E\n              27 12 95 CB 67 0D E1 3D EC 6E E6 B3 73 AF E3 AC\n              8E 34 21 C2 EA 48 00 38 B1 C6 16 92 DD F7 2C 4F\n              90 DA 71 B8 BE 63 3C D8 4E 7F A2 13 F0 D3 CF 69\n              56 F7 51 65 7E 43 CF 45 D2 DE E3 C4 48 A7 7F 38\n              AA 24 19 52 58 94 98 37 95 D4 A9 4B B6 2B 7A 56\n              C2 2F 04 E3 D9 5C E8 0C 83 90 0C F3 9B 77 DA C7\n              94 2B 7A 72 47 0B D6 54 6E 0F 3A C2 30 96 E6 0D\n              A5 01 E6 D2 61 88 8E 63 DF 27 CD 82 D4 91 E1 B0\n              56 FD 05 E7 3F C5 1D DF 67 A1 16 55 6A 08 5A 5B\n              B7 E6 2E 37 9B CE C7 D4 68 C1 EB C3 95 34 7C DC\n              D7 02 AE 73 9D D6 D4 BF F0 57 81 D0 19 86 DF C2\n              93 2D 10 10 B4 4B 60 A0 82 52 2F 82 A1 2F 58 65\n              E6 6D 6E 4D 5E E3 2A 8B E3 CB 46 F8 14 2F C5 78\n              B9 78 46 CB FC AF 66 B8 74 1F E1 79 E1 69 E3 9A\n              B3 CC C2 1D 23 27 8E 11 79 F0 33 04 56 30 1D E5\n              0C BB 90 CF 68 BE AD 42 6C 44 D4 DB E3 D9 D4 01\n              D5 FE 2B 02 B3 EF 37 CF CF 8A 99 9E FC CC 3C 2A\n              D2 C2 B0 F1 8E D1 4E 1A 7A AF 5B 4E D8 8F A2 CD\n              45 B9 AC 8D 77 A0 1D 7B 6A B0 4E 66 CB DB 3F 94\n\n```\n\n36\n\n\n-----\n\n```\n              BA 2A ED 00 2B D4 A1 CD 93 25 CC E8 94 2B 88 EF\n              5F 82 50 46 FC 2E 7D FD 2E D1 AB 6E 2B C9 01 AB\n              51 E4 92 BA 9F 47 47 1E 8D 3A 05 B7 11 E2 08 83\n              67 B6 22 26 F6 A4 5A 73 E6 AD 0F BE A4 15 27 A9\n              89 B6 ED 54 6D BF 24 04 28 D9 E4 3F EA FE E4 DD\n              00 06 33 9A 3C 9F F6 AC 43 59 DA 51 E5 50 94 FA\n              BC 3C 52 F4 BD 63 5C 2A 02 C4 CD 71 E1 5C A6 86\n              B3 F3 97 07 C3 53 5E 2E D3 3E 73 95 C4 25 F5 41\n              25 60 95 39 DD F0 5E 6C 9E 8A A8 B8 DC EC 1B 38\n              EF 57 E8 40 AE 86 DD AE 8F 97 C3 6F 36 4C 38 53\n              62 66 92 32 BA B7 D6 DF 68 14 61 72 E3 B7 CF 63\n              07 DD 42 90 BB 12 84 9D D2 F7 39 B3 54 96 8D 38\n\n```\nThe compile time of file “wsock32.exe” is also 2005-12-06. It creates a registry entry in\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run in order to be started at boot time.\n\nBoth “kidll.dll” and “wsock32.exe” uses the registry entry\nHKLM\\Software\\Microsoft\\CurrentVerion\\PF_WorkingState possibly to obtain some status\ninformation (e.g., REG_DWORD 0x00000001).\n\n##### nsd.txt\n\nhash: 0FDB2616920BFD47B7E1205F831261B3\ncompile time: 2009-06-02\n\nThis module tries to discover certain types of files on the mounted network shares. If no files are\nfound, then an error message is written in the file “C:\\sysdll9.txt”. Otherwise, the files found are\ncompressed and stored in the file “C:\\sysdll2.txt”.\n\nThe filenames of the files that the attackers are interested in match the following templates:\n*saidumlo*, *secret*.*, *pass*.*, *секрет*.*, *парол*.*, *.xls, *.rtf, *.doc, *.pdf, *.pgp\n\nClearly, this module looks very similar in functionality to “fileList_2.jpg” module found on\nbannetwork.org, however, it is interesting that “nsd.txt” does not check for .pst, .mdb, .vmdk, .tc and\n.p12 files.\n\n##### sc.txt \n\nhash: 3A6282107987ADEC9A768169EF77823F\ncompile time: 1992-06-19 (most likely fake)\n\nThis is a UPX compressed file, which contains an executable originally written in Delphi. The original\ncompilation date of the compressed content is also 1992-06-19. When run, the executable renames\nitself to “vgtk.exe”.\n\nAs for functionality, this module saves screen captures (hence maybe the name “sc”) into the file\n“C:\\sysdll5.txt” in standard JPG format. More specifically, the following behavior is repeated: once a\n\n37\n\n\n-----\n\nscreen capture is saved, it checks in every 40 seconds if the file “C:\\sysdll5.txt” was deleted, and if so,\nit makes and saves another screen capture.\n\n##### 2016_11.txt \n\nhash: 3962E531A76BB6CA4F95D5CC5566311A\ncompile time: 2004-01-24\n\nThis module reads some specified files (names are hard-coded), compresses them, and saves the\nresult into temporary files, whose names look like hexadecimal numbers (e.g., “1F.tmp”). There are\nsimilar modules with similar names (e.g., “2016\\10.txt”) and functionality. The output is also written\nin file “C:\\sysdll9.txt” or in some cases in “C:\\sysdll2.txt”. The output format is shown below:\n\nFormat is as below:\n```\n0000000000: 5B 4E 31 2E 36 2D 06 00 │ 2E 01 00 3A 33 00 00 00 [N1.6-♠ .☺ :3\n0000000010: 2E 01 00 00 00 2E 01 00 │ 00 00 2E 2B 00 00 00 2E .☺  .☺  .+  .\n0000000020: 61 56 65 72 3A 30 30 30 │ 31 3B 75 50 61 63 6B 65 aVer:0001;uPacke\n0000000030: 64 53 69 7A 65 3A 30 30 │ 30 30 30 30 33 30 3B 43 dSize:00000030;C\n0000000040: 52 43 3A 65 35 32 31 34 │ 30 35 64 5D 00 1B 82 EB RC:e521405d] ←‚ë\n\n```\n**Figure 42– Output format of module 2016\\11.txt**\n\nThe files that our samples where looking for include the following:\n```\nD:\\yazilar\\beyaz okuz ve arab ata sozu(mahmut topbas).doc (2016\\11.exe)\nD:\\yazilar\\gazzedeki tunelin isigi sizsiniz.doc (2016\\10.exe)\n\n```\n`C:\\Documents and Settings\\user\\Рабочий` стол\\Комерческие предложения\\Ком\nпредложение общее (Елена Никитина).doc (201617\\8.exe)\n```\nD:\\yazilar\\?з'e kapanmayla d??'a yamanma aras?nda…(yusuf kaplan).doc (201611\\8.exe)\nD:\\yazilar\\Cocuk yeti?tirmek (yavuz bahadiroglu).doc (201611\\9.exe)\n\n```\n`C:\\Documents and Settings\\user\\Рабочий` стол\\пароль 696806.txt (201617\\10.exe)\n```\nfile “==================8<=======================” (201611\\12.exe\nfile “==================8<=======================” (201617\\11.exe)\n\n```\n`D:\\на` отправку\\Изготовление листовок.xls (kbas\\201617\\8.exe)\n\n**Figure 43– Files searched for by different variants of module 2016/11.txt**\n\nNote that “Рабочий стол\\Комерческие предложения\\Компредложение общее (Елена\nНикитина)” translates into “Desktop \\ Commercial offers \\ Comoffer general (Elena Nikitina)”,\n“Рабочий стол\\пароль” translates into “Desktop \\ password”, and “на отправку\\Изготовление\nлистовок.xls” means “shipment \\ Manufacturing leaflets.xls”.\n\n38\n\n\n-----\n\n##### otr.txt\n\nMD5 hash: 0f9c86ea21f37d0a3b8c842302c4b262\nSHA1 hash: 4205fd58209968b173adaf5e8d2fb57343b06e60\ncompile time: 2009-08-14\n\nThis module is identical to “tr.txt”, and it saves the traceroute from the infected machine towards\nthe IP address 57.66.151.195 in the file “C:\\ sysdll9.txt”.\n\nThe address belongs to the following address range:\n```\n  NetRange:    57.0.0.0 - 57.255.255.255\n  OrgName:    SITA-Societe Internationale de Telecommunications Aeronautiques\n  OrgId:     SIDTA\n  Address:    112 Avenue Charles de Gaulle\n  Address:    Neuilly, 92522 Cedex\n  Country:    FR\n\n```\nWe could not identify the owner of the IP address above, but it might be an important target, and\nthe operators might want to check if the high-profile target is accessible from the attacked network.\nClose to this IP address, we could identify a computer that most likely belongs to the Ministry of\nForeign Affairs of Uzbekistan, but we have no proof about the importance of the specific IP address\nand, thus, it needs further investigations.\n\nOther modules containing the same command: ct.txt oct.txt tr.txt\n\n##### ocp.txt\n\nMD5 hash: ce22d988e1023843474849176ceb18b9\nSHA1 hash: 841bedfd39276b1ac8eb0540d83e95c99833bc2f\n\ncompile time: 2009-10-02\n\nThis module drops the file “C:\\Documents and Settings\\All Users\\Application Data\\iepv.exe” and\nexecutes it with parameter /stext. The program iepv.exe (Internet Explorer Password Viewer –\nNirSoft) saves Internet Explorer passwords into the file “C:\\sysdll10.txt”. The original executable is\ndeleted after starting iepv.exe.\n\n39\n\n\n-----\n\n**Figure 44– Process Monitor shows that ocp.exe drops iepv.exe**\n\nThe dropped file iepv.exe has the following hashes and compile time:\n\nMD5 hash: 28c110b8d0ad095131c8d06043678086\nSHA1 hash: c684cf321e890e0e766a97609a4cde866156d6c5\ncompile time: 2009-09-28 09:29:03\n\nThe file is packed with UPX, and its content is compiled with Microsoft Visual C++ 7.1. Its known\nfunctionality is to reveal the passwords stored by IExplorer. The file has been submitted for analysis\nto VirusTotal on March 8, 2013, and it is recognized by multiple anti-virus products.\n\n##### oct.txt\n\nMD5 hash: ba7f9a2cec106773d17df4f571b4b8e8\nIdentical with: planetnews_ct.ex\n\n40\n\n\n-----\n\n##### overlay\\201606\\9.txt\n\nMD5 hash: 9c2f495379b0b013a89eb6e1f8a6b717\nSHA1 hash: 63D9622578205BCA62AA2F1B35C930A4D2923D18\ncompile time: 2008-10-28\n\nThis module searches for specific files (e.g., *.doc, *.pdf, *.xls, *.pgp) on available drives and saves\nthe list in encrypted form into the file “C:\\sysdll2.txt”. An example decrypted output is shown below:\n```\nc:\\Documents and Settings\\Default User\\Templates\\winword.doc 4608 04.08.2004 12:00\nc:\\Documents and Settings\\Default User\\Templates\\winword2.doc 1769 04.08.2004 12:00\nc:\\Documents and Settings\\Default User\\Templates\\excel.xls  5632 04.08.2004 12:00\nc:\\Documents and Settings\\Default User\\Templates\\excel4.xls 1518 04.08.2004 12:00\n\n```\n**Figure 45– Example output of module overlay\\201606\\9.ex**\n\nEncryption is based on XORing with a fix 1024 byte key and it is performed with the following\nroutine:\n```\n for ( i = 0; i < (signed int)nNumberOfBytesToWrite; ++i )\n  {\n   *((_BYTE *)lpBuffer + i) ^= byte_403010[dword_403410++];\n   if ( dword_403410 >= 1024 )\n    dword_403410 = 0;\n  }\n\n```\n**Figure 46– Encryption routine used by module overlay\\201606\\9.ex**\n\nThe 1024 byte key used for encryption is the same as for module “nb.txt”.\n\n##### mod3\\index4.hta\n\nMD5 hash: 28442e848a200fb873b830c060c75616\nSHA1 hash: 31ad3210d8c3c62582defaff312fe52ecd1e561d\n\nThis file contains a VB script, with the following functionality:\n\n1. It checks the path for “Application Data” in the registry by reading the key\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell\nFolders\\Common AppData” in order get the execution path for IExplore.exe (Internet Explorer).\n2. Once this AppData path is found, it searches for the\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\IExplore”\nregistry key to determine whether the executable is among the autorun applications. If it is not,\nit places the application path here.\n3. In the next step it checks whether the IE executable exists on the physical drive. If it is not, the\nscript can place any binary there called as IExplore.exe via the szBinary parameter.\n4. Finally the binary behind the name “IExplore.exe” is executed.\n\n41\n\n\n-----\n\n5. The script also writes an autorun path into the registry for “C:\\altnet.exe” by setting the key\n“HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ RunOnce\\altnet”.\n6. The script repeats the same checks and steps for “C:\\altnet.exe” as in step 3 for IExplore.exe.\n7. Finally, the script uses an HTML javascript tag to close the current browser window, an HTML\nbody section with an “img” reference to image.php and a closing HTML tag (</html>). We\nsuspect that this file must have been the final part of a larger script.\n\n##### bi_1.txt\n\nhash: CBF6F449C54F11D4AC28FAD203C1D88A\ncompile time: 2004-01-24\n\nMost likely a screen capture module.\n\nCreates two files in \\Documents and Settings\\user\\Local Settings\\Temp\n\n3.exe and bi~.tmp\n\n3.exe has a hash of ED12789B2EFC87C4F39FA2367755C835 and interestingly does not has valid PE\nheader. It was created with Borland C++ compiler. It writes to the bi~.tmp file.\n\nThe created bi~.tmp observed was of length 11074 bytes long and contains binary data, most likely\nsome graphical image, e.g screen capture or similar, but we did not analyze this in details.\n\nThe same information is also saved to c:\\sysdll7.txt by bi_1.exe.\n\nbi_1.exe also starts windows component ntvdm.exe which then writes temporary information into\n\\windows\\temp\\scs8.tmp and scs7.tmp in the same directory.\n\n42\n\n\n-----\n\n##### 5.5 Other related samples\n\nWe have looked at our own malware repository for samples that are similar to those described\nabove, and we found the following related samples from the past.\n\n##### 01522d075c026b809a747cb44a10c885\n\nMD5 hash: 01522d075c026b809a747cb44a10c885\nSHA1 hash: d6059e02698071cb4980d61ae44707e37f027be4\ncompile time: 2011-06-27\nlatest Virus Total detection: 2011-07-14\n\nThis malware sample collects system information by running the following commands with cmd.exe\nand saving the result in “\\ProgramData\\Adobe\\AdobeArm\\sysdll15.txt”:\n```\nwmic os get /format:\"c:\\Windows\\System32\\wbem\\en-US\\hform.xsl”\nwmic process list brief /format:\"c:\\Windows\\System32\\wbem\\en-US\\htable.xsl”\nwmic bios list /format:\"c:\\Windows\\System32\\wbem\\en-US\\hform. xsl”\nwmic computersystem list /format:\"c:\\Windows\\System32\\wbem\\en-US\\hform.xsl”\nwmic logicaldisk list brief /format:\"c:\\Windows\\System32\\wbem\\en-US\\htable.xsl”\nwmic useraccount list brief /format:\"c:\\Windows\\System32\\wbem\\en-US\\htable.xsl”\nwmic startup list /format:\"c:\\Windows\\System32\\wbem\\en-US\\htable.xsl\"\nwmic share list brief /format:\"c:\\Windows\\System32\\wbem\\en-US\\htable.xsl”\nwmic onboarddevice list brief /format:\"c:\\Windows\\System32\\wbem\\en-US\\htable.xsl”\nwmic ntdomain list brief /format:\"c:\\Windows\\System32\\wbem\\en-US\\htable.xsl”\n\n```\n**Figure 47– Commands for collection of system information**\n\nThe program sometimes fails when wmic is not properly installed and on systems where the folder\n„en-US” does not exists (e.g., we could not run it on Windows XP). The malware erases itself after\nsuccessful running.\n\n##### 708ceccae2c27e32637fd29451aef4a5\n\nMD5 hash: 708ceccae2c27e32637fd29451aef4a5\nSHA1 hash: 3d4c6a0119a9f2d9384406326820cc79bde21a81\ncompile time: 2011-09-07\nlatest VT detection: None\n\nThis malware is essentially the same as the fileList_2.jpg module found on bannetwork.org. It writes\nthe list of files matching the following templates into the file\n“\\ProgramData\\Adobe\\AdobeArm\\sysdll2.txt”: *.pst, *.mdb, *.doc, *.rtf, *.xls, *.pgp, *.pdf, *.vmdk,\n*.tc, *.p12, *pass*.*, *secret*.*, *saidumlo*, *секрет*.* and *парол*.*\n\n43\n\n\n-----\n\n##### 22d9278c43700b82260a7ad212192ab6\n\nMD5 hash: 22D9278C43700B82260A7AD212192AB6\nSHA1 hash: 1CCE8B615A118E49898E6DCD0F43C001728EDE0A\ncompile time: 2011-05-16\n\nThis sample uses standard WinAPI functions (e.g., GetDesktopWindows() and\nCreateCompatibleBitmap() ) in order to create screenshots of the entire screen on the infected\nmachine and saves these bitmaps into file PrintScreen.bmp. After that this bitmap file is converted\ninto a corresponding jpg file (PrintScreen.jpg) by using Gdi API functions. Then, the file\nPrintScreen.jpg is moved into “SystemDrive\\ProgramData\\Adobe\\AdobeArm\\sysdll5.txt” after\nwaiting 6 seconds. Note that SystemDrive represents the drive where the OS was installed (most of\nthe time it is C:\\). Finally the original and large PrintScreen.bmp file is deleted after waiting 3\nseconds.\n\nThe file contains debugging symbols as it is linked with the PDB information that makes analysis\neasier, and also reveals some details about the attacker. One such detail is the internal path\ninformation about the project: C:\\PrintScreen\\PrintScreen-DED version\\Release\\PrintScreen.pdb\n\n##### 539B0094E07E43BFCED8A415BA5C84E3\n\nMD5 hash: 539B0094E07E43BFCED8A415BA5C84E3\nSHA1 hash: 2B677DC5E1E14818DBE31F5913453EEAA8CF7230\ncompile time: 2008-09-02\n\nThe malware first creates a registry key as “HKEY_LOCAL_MACHINE\\Software\\Microsoft\\ MS QAG”\nand sets various the values ID, Interval, Ul1 and Ul2 as follows:\nID = 1245641\nInterval = 120s\nUl1 = http://www.politnews.org/dd_4.php\nUl2 = http://www.r2bnetwork.org/dd_4.php\nThe most important data here is Ul1 and Ul2 that are representing C&C servers, however, the latter\none is not active any more. The result of each registry value write operation (RegSetValueExA) is\nsaved and the result is stored in c:\\sysdll9.txt\nThe module uses a well-known anti-debugging technique by calling the IsDebuggerPresent() WinAPI\nfunction, and terminates if this function returns true.\n\n44\n\n\n-----\n\n##### 5.6 Partially analyzed / unanalyzed samples\n\n b0b59e2569fb1de00f76a8d234d2088a\n\nMD5 hash: b0b59e2569fb1de00f76a8d234d2088a\nSHA1 hash: 2765b4e748e5d547f08ba67c2594de07e4cb056f\ncompile time: 1992-06-19 (0x2A425E19)  (most likely fake)\nlatest VT detection: None\n\nThis is a module that communicates with the C&C server at http://www.politnews.org/dd.php. It\nwaits for commands encoded as [TO][/TO] [NS][/NS] [EXT][/EXT] [DATA] [/DATA] [CMD][/CMD] tags.\nIt can also receive the [nocommand] command. Needs more investigations. This component can\nmost likely shed light to the connection between older campaigns and recent activity.\n\nThe files referred by this module include the following entries:\n\nc:\\sjdwdd1.txt\nc:\\sysdll2.txt\nc:\\ag_tcp.txt\nc:\\ag_mngr.txt\nc:\\halt.1\nc:\\ageer.txt\nc:\\update2.vbs\n\n##### politnews – module 3 \n\nThese modules seem to be about 7 years old, going back to 2005. The interesting thing is that these\nmodules possibly provide C&C communications based on POP3/SMTP based communications\ntowards specific hard coded addresses. The corresponding name/password pairs seem to be nonfunctional as of today, but this gives another hint that, most likely, the operators have long\nexperience on targeted attacks.\n\nMD5 hash: multiple\nindex2.hta index3.hta index4.hta\n\nThe visual basic script file, index4.hta reads registry, then writes the registry entry\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\altnet.\n\nIt also puts the “ImageAtl” key in\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run, pointing to\n%SystemRoot%\\system32\\atlsrv.exe\n\n45\n\n\n-----\n\nThe ~24kb size module from index3.hta contains 4 distinct MZ headers. We name them atl_1 to atl_4\nin the hash list. The 24k long file is compiled on 2005-04-04.\n\n**Submodule atl_1**\n\nrefers to \\atlsrv.exe \\altnet32.exe \\atlsrv.exe sdmnet32.dll srvshell.dll sdmnet.dll srvshell32.dll\n\nIt contains debug information that gives hint on the code goal:\n\ni:\\119prj\\Bv\\REPLACE Kasp\\3 otdel\\1.2m UnderKasper\\installer\\Release\\installer.pdb\n\nThe module communicates with other modules through the registry, under the key\nSoftware\\Microsoft\\Internet Explorer\\MainFileSRC\n\nThis module saves an interesting email address “<banny.bigs@freemail.lt>” into the registry.\n\nThe module also uses a mutex named “{118-32-FOOTBOLL-15}” and it is also able to set\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run for its goals.\n\nIt modifies “\\AUTOEXE.BAT” (no typo) in some cases to:\n```\n:LOOP \nDEL \"%s\"'\nIF EXIST \"%s\" GOTO LOOP\nDEL \"%s\"\n\n```\n**Figure 48 – .bat file created by submodule atl_1**\n\n**Module atl_2**\n\nThis module uses mutexes “{132-79-FOOTBOLL-18}”, “{118-32-FOOTBOLL-15}” and {167-53BADFOOD-14}, as well as DLLs sdmnet32.dll sdmnet.dll srvshell.dll or srvshell32.dll\n\nIt has some relation to explorer.exe, and it calls the _NetBiosDisconnectNt export of another module.\n\nBasically this module is a middle layer between atl_1 and atl_3.\n\n**Module atl_3**\n\nCompile time: 2005-04-04\n\nThis module is UPX compressed (ver 1.92 – released in 2004). When uncompressed, this module is\n28kb long, therefore, it is the biggest “main” module among the four submodules.\n\nIt provides functionality to other modules, the defined export functions are as follows, where the\nmost important export function is probably NetBiosDisconnectNt:\n```\n_NetBiosConnectNt@8\n_NetBiosDisconnectNt@8\n_NtDR@0\n\n```\n46\n\n\n-----\n\n```\n_NtDSLLRC@4\n_NtDSLLRV@8\n_NtDSLLSP@20\n_NtDSLLSPC@8\n_NtDSLLSPCTY@12\n_NtDSLLSPX@0\n_SafeModeNt@12\n_StartNetBiosNt@12\n_xDSLConnect@8\n\n```\n**Figure 49 – Exports of mod3 atl_3**\n\nThe main purpose of this module is POP3 and SMTP communication based on registry defined\nconfiguration through HKLM\\ Software\\Microsoft\\Internet Explorer\\MainFileSRC\n\nAs a self-defense, the process tries to terminate the following security product related executables:\nOUTPOST.EXE, McVSEscn.exe\n\nThe module has references to the following e-mail related programs, but the use of these is unclear\nyet:\n\nAvant.exe\nAvant.EXE\nAVANT.EXE\navant.exe\nfirefox.exe\nthunderbird.exe\nPostman2.exe\nEudora.exe\nNetscp.exe\nMyIE.exe\nmozilla.exe\nthebat.exe\nopera.exe\nOUTLOOK.EXE\nmsimn.exe\noutlook.exe\n\nFor file names in conversation, it probably uses extensions like .suo .oji .dat .ilk .ncb .opt\n\nThe following hard coded addresses might be used: <lisa.tomys@mail.bulgaria.com>\n\nIn the email, it uses “--------------060501080505070400060304” as a separator, which can be used as\nIDS signature (remember – this sample is from 2005!)\n\nStrangely, it seems to add “User-Agent: Mozilla 0.7.3 (“ header to the email, and possibly “XComment: rv.1.2.2”.\n\nIt uses mutexes {119-36-FOOTBOLL-92}  and {118-32-FOOTBOLL-15}.\n\n47\n\n\n-----\n\nThe module is capable to send emails, but also to receive emails from POP3 connection. It can send\nbasic information about the victim e.g. Computer Name, Operating system language, available\ndrives.\n\n**Module atl_4**\n\nModule atl_4 uses Mutex {119-36-FOOTBOLL-92}\n\nIt sets the target addresses for atl_3.through registry keys: EX S2 S1\n\nThe values to be used for user name and password for pop3 login are: bibi.lima/yergt37h for\n\nhost pop.laposte.net Another likely name/password pair is bine.bono/hdyw386k\n\nTwo corresponding email address also exists in the binary: <ladonia.mix@laposte.net>\n\nsmtp.laposte.net and  <ursprung.loos@zoznam.sk>\n\nSome host references can also be found, namely:\n\nmail.zoznam.sk post.freemail.lt\n\n##### politnews – n.txt\n\nMD5 hash: 22dd42246ebec969e1a9c608793a644e\ncompile time: 2004-01-24\nThe size of the module is ~160k.\n\nThis module installs acxMonitor.exe and acxAgin.dll into the directory “c:\\windows\\system32”, then\ninstalls a new key to HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run,\nnamely “acxMonitor” pointing to “C:\\WINDOWS\\system32\\acxMonitor.exe”\n\nThe MD5 hash of acxMonitor.exe is: 0b74db5420416129ce82c65c03df337e\n\nThe MD5 hash of acxAgin.dll is: c75f7a3a1d1695797e1a55e1200a6044\n\nThe compile time for the samples according to the binaries is: 1992-06-19\n\nThe output files are c:\\sysdll2.txt and c:\\sysdll8.txt, where the latter contains debug data related to\nmodem communications:\n```\n11:32:27 PM   ATR0\n11:32:28 PM   ATDP**\n11:32:33 PM   OPEN LINK.....COM3\n11:32:33 PM   CHECK GDT.....OK\n11:32:33 PM   CHECK GDT.....OK\n11:32:33 PM   CHECK DT.....OFF\n\n```\n48\n\n\n-----\n\n```\n11:32:50 PM   OPEN LINK.....COM3\n11:32:50 PM   CHECK GDT.....OK\n11:32:50 PM   CHECK GDT.....OK\n11:32:50 PM   CHECK DT.....OFF\n\n```\n**Figure 50– n.exe comms log in sysdll8.txt**\n\nOtherwise, we had not enough resources to check functionality of this interesting sample.\n\n##### bannetwork - sc_and_console.jpg\n\nMD5 hash: 5F7A067F280AC0312ABFBD9EE35CB522\ncompile time: 2011-11-11\n\nThis module drops the file c:\\ProgramData\\CmdCapture\\CmdCapture.exe (698353 bytes long)\n\nThe hash of CmdCapture.exe is: 72EC4047DB89A70E5BE7370A19BCD600\nIts compile time is 2010-04-16, and its latest VT upload is 2013-03-13.\n\nThe program CmdCapture.exe creates “ProgramData\\Adobe\\AdobeArm\\sysdll5.jpg”, which contains\nthe actual screen capture. It also creates “ProgramData\\Adobe\\AdobeArm\\sysdll555.txt” with some\nsystem information. It was found that possibly this module is a known screen capture executable,\ndescription is available at: http://www.ducklink.com/p/command-line-screen-capture/\n\n49\n\n\n-----\n\n### 6. Additional information received from different partners\n\nIn the last days we shared some of the information related to the threat with different security\nvendors and other organization. With the permission of the partners we provide here some\nadditional information received from them.\n\n##### 6.1 ESET\n\n_ESET also confirmed seeing some of these malicious components around the world in_\n_very small quantities over the course of last few years -- which supports the idea that_\n_these attacks were targeting specific victims. Geographically speaking, these reports_\n_came from Turkey, Russia, Ukraine, Italy and a few Middle-East and former USSR_\n_countries. We can also confirm existence of more variants of the avicap32.dll file used_\n_with TeamViewer; some of them being quite recent._\n```\n1CCE8B615A118E49898E6DCD0F43C001728EDE0A\n2765B4E748E5D547F08BA67C2594DE07E4CB056F\nD6059E02698071CB4980D61AE44707E37F027BE4\n3D4C6A0119A9F2D9384406326820CC79BDE21A81\n59CBF6E6F6E92A4998DC54E6A7905590DF875653\n173E672C6F0A44178302CCB0F9B1371227D2C75F\n88B955F332F4214F1841555CE03DD0878AF99856\n63D9622578205BCA62AA2F1B35C930A4D2923D18\n7D1C331B8920E3F4A1BAD126B12552F0C3E44CA4\n2B677DC5E1E14818DBE31F5913453EEAA8CF7230\n82cd656f77f7ee81c735396ab0ceadd3ea0aa33a\nd3c90ba477668a68c04d138744b577d4215d421d\n285d41f35b40bb2afe6e990f0b16b7d4ecfa89cf\n64506f30edd9e0585942132c277b0290d8f214c7\nbdf6ba0d25eb070c535b4a50e0946988273894ee\n00b6dce99f377e64b5a738393ad79ebbdad7307c \n01e8d4c761cd8dd415fdeab52a056598500b51ce \n02ecb87ec290ba32b4caf6727f57e0b0e6c107ec \n1d703345704860df4f4e593190d9cb5233857cb2 \n1f603a3a1e4f6ba0a07fbff11b820be9e86daec9 \n29be8a8d40784ce372d2361cdf1dacd0102e8dc7 \n2d145c86a8e757e3bc1d049cc1abd38728b14b69 \n33387d44f7d32deca73adc62eccaa1488d7c48c8 \n386489c05aa8870e67ef37b638a3a1f6da6e5714 \n3c2191c780c015d7980cbdc55d2adddca0d4294b \n3c63e5cb98811480e81b500694c1a37a5685ce70 \n705f9b6634ee38accaa918b0dbb33511f91b48e1 \n7fa13fba910911a23c7e807dd75d58807dd87e21 \n82cd656f77f7ee81c735396ab0ceadd3ea0aa33a \n\n```\n50\n\n\n-----\n\n```\n8656219860cf087a9c2be05a7706556b444ade13 \n8804f39d3f76417ed81c0e29645b7d6a0aa70c90 \n8d11efffa7a70095ddb1d07e1658b12af4a689be \n8e88362ca49350a33fe7f089bd8ecef81d437037 \n9723878bcc89feb076a16fe2191fb13bbe4b9b4c \n9c54f977da5b02693d3f6c75984bd8b5d358c6e5 \nda39a3ee5e6b4b0d3255bfef95601890afd80709 \na6a2ae9423580df494202e46bd12bd8eb38de5bd \nb57e1c4a93853e1d07efaca13e27527f11379d52 \nd9b8a55762c2e85a100d03a553b52af82fd51507 \ne2d0cb2f7478766c3e1b7f293eff37d6cb00b673 \ne567b8a1fec52a6961eb18e12df3feedb8eb7a58 \nf6780eba8f61b206d5800867a7c6251373c291bd\n\n```\n**Figure 51– Possibly related malware component hashes provided by ESET**\n\nESET also provided a list of domain names that were possibly related to TeamSpy:\n```\nnews-top.org\nwww.greekpod101.com\ndanielramirez.com.co\nswingzombi.com\ncountlist.org [sinkholed by Kaspersky Lab]\n\n```\n**Figure 52– Possibly related domains provided by ESET**\n\n\n51\n\n\n-----\n\n##### 6.2 Kaspersky Lab\n\nKaspersky lab provided us telemetry data heat map about their detections on avicap32.dll.\n\n**Figure 53– Teamspy KSN detections (unique PCs) – March 2013**\n**(c) Kaspersky Lab 2013, used with permission**\n\n##### 6.3 Symantec\n\nSymantec provided us telemetry data over their Teamspy detections.\n\n**Figure 54– Detections on Teamspy by country – provided by Symantec**\n\n\n52\n\n\n-----\n\n### 7. Conclusions\n\nIn this document, we described a strange series of attack campaigns from one or multiple distinct\nthreat actor or actors. From the samples we collected, we can conclude that the same threat actor\nproduced many individual malware modules during the last ten years.\n\nHere, we detail a list of conclusions we derived from the data available at the time of this writing.\nSome of these items may change and new items may be added to the list as more evidence is\nuncovered.\n\n  - Most likely the same attackers are behind the attacks that span for the last 10 years, as there\nare clear connections between samples used in different years and campaigns. Interestingly,\nthe attacks began to gain new momentum in the second half of 2012.\n\n  - The campaigns are a mix of targeted attacks and conventional cyber crime activities (e.g.,\nbanking cybercrime operations, such as the Sheldor campaign)\n\n  - It seems that no comprehensive investigation has been done on these modules yet – some\nmodules were submitted and analyzed by A/V companies, but the main activity of the threat\nactor was not clearly seen and could have been hidden for long time.\n\n  - The attackers use distinct tools for nearly every simple activity – this means that most likely\nthe group is small and technically professional people carry out all types of activities,\nincluding strategic planning and executing the attacks.\n\n  - The attackers commit errors and produce a lot of garbage. One reason for this carelessness\nmay be that after so many years of undetected operation, they are not afraid of detection.\n\n  - The attackers surely aim for important targets. This conclusion comes from a number of\ndifferent facts, including victim IPs, known activities on some targets, traceroute for probably\nhigh profile targets, file names used in information stealing activities, strange paramilitary\nlanguage of some structures, etc.\n\n53\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.crysys.hu/publications/files/teamspy.pdf"
    ],
    "report_names": [
        "teamspy.pdf"
    ],
    "threat_actors": [
        {
            "id": "1d8dd2ca-5592-482e-b89d-6a7e1a49f4f6",
            "created_at": "2023-01-06T13:46:38.408359Z",
            "updated_at": "2025-03-27T02:00:02.826069Z",
            "deleted_at": null,
            "main_name": "TeamSpy Crew",
            "aliases": [
                "TeamSpy",
                "Team Bear",
                "Anger Bear",
                "IRON LYRIC"
            ],
            "source_name": "MISPGALAXY:TeamSpy Crew",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041466,
    "ts_creation_date": 1363810220,
    "ts_modification_date": 1363810220,
    "files": {
        "pdf": "https://archive.orkl.eu/fef39bfaa9737417e6512c34c8e671fa93b77e78.pdf",
        "text": "https://archive.orkl.eu/fef39bfaa9737417e6512c34c8e671fa93b77e78.txt",
        "img": "https://archive.orkl.eu/fef39bfaa9737417e6512c34c8e671fa93b77e78.jpg"
    }
}