{
    "id": "ed192dbc-76c8-4068-9229-1d5ec55b8cd0",
    "created_at": "2023-01-12T15:06:43.100684Z",
    "updated_at": "2025-03-27T02:17:01.456437Z",
    "deleted_at": null,
    "sha1_hash": "9653e8d6923a322ec9564dcee2cba667a223d370",
    "title": "2021-12-11 - Guidance for preventing, detecting, and hunting for exploitation of the Log4j 2 vulnerability",
    "authors": "",
    "file_creation_date": "2022-08-18T03:29:47Z",
    "file_modification_date": "2022-08-18T03:29:47Z",
    "file_size": 2793626,
    "plain_text": "# Guidance for preventing, detecting, and hunting for exploitation of the Log4j 2 vulnerability\n\n**microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-**\nexploitation\n\nDecember 12, 2021\n\n**_January 10, 2022 recap – The Log4j vulnerabilities represent a complex and high-risk_**\n_situation for companies across the globe. This open-source component is widely used across_\n_many suppliers’ software and services. By nature of Log4j being a component, the_\n_vulnerabilities affect not only applications that use vulnerable libraries, but also any services_\n_that use these applications, so customers may not readily know how widespread the issue is_\n_in their environment. Customers are encouraged to utilize scripts and scanning tools to_\n_assess their risk and impact. Microsoft has observed attackers using many of the same_\n_inventory techniques to locate targets. Sophisticated adversaries (like nation-state actors)_\n_and commodity attackers alike have been observed taking advantage of these vulnerabilities._\n_There is high potential for the expanded use of the vulnerabilities._\n\n_In January, we started seeing attackers taking advantage of the vulnerabilities in internet-_\n_facing systems, eventually deploying ransomware._ _We have observed many existing_\n_attackers adding exploits of these vulnerabilities in their existing malware kits and tactics,_\n_from coin miners to hands-on-keyboard attacks. Organizations may not realize their_\n_environments may already be compromised. Microsoft recommends customers to do_\n_additional review of devices where vulnerable installations are discovered. At this juncture,_\n_customers should assume broad availability of exploit code and scanning capabilities to be a_\n_real and present danger to their environments. Due to the many software and services that_\n_are impacted and given the pace of updates, this is expected to have a long tail for_\n_remediation, requiring ongoing, sustainable vigilance._\n\n**_January 19, 2022 update – We added new information about an unrelated vulnerability we_**\n_discovered while investigating Log4j attacks._\n\n**_January 21, 2022 update –_** _Threat and vulnerability management can now discover_\n_vulnerable Log4j libraries, including Log4j files and other files containing Log4j, packaged_\n_into Uber-JAR files._\n\nThe remote code execution (RCE) vulnerabilities in Apache Log4j 2 referred to as\n[“Log4Shell” (CVE-2021-44228,](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44228) [CVE-2021-45046,](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046) [CVE-2021-44832) has presented a new](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44832)\nattack vector and gained broad attention due to its severity and potential for widespread\nexploitation. The majority of attacks we have observed so far have been mainly massscanning, coin mining, establishing remote shells, and red-team activity, but it’s highly likely\nthat attackers will continue adding exploits for these vulnerabilities to their toolkits.\n\n\n-----\n\nWith nation-state actors testing and implementing the exploit and known ransomwareassociated access brokers using it, we highly recommend applying security patches and\nupdating affected products and services as soon as possible. Refer to the Microsoft Security\nResponse Center blog for technical information about the vulnerabilities and mitigation\nrecommendations.\n\nMeanwhile, defenders need to be diligent in detecting, hunting for, and investigating related\nthreats. This blog reports our observations and analysis of attacks that take advantage of the\nLog4j 2 vulnerabilities. It also provides our recommendations for using Microsoft security\nsolutions to (1) find and remediate vulnerable services and systems and (2) detect,\ninvestigate, and respond to attacks.\n\nThis blog covers the following topics:\n\n## Attack vectors and observed activity\n\nMicrosoft’s unified threat intelligence team, comprising the Microsoft Threat Intelligence\nCenter (MSTIC), Microsoft 365 Defender Threat Intelligence Team, RiskIQ, and the Microsoft\nDetection and Response Team (DART), among others, have been tracking threats taking\n[advantage of the remote code execution (RCE) vulnerabilities in Apache Log4j 2 referred to](https://logging.apache.org/log4j/2.x/)\nas “Log4Shell”.\n\nThe bulk of attacks that Microsoft has observed at this time have been related to mass\nscanning by attackers attempting to thumbprint vulnerable systems, as well as scanning by\nsecurity companies and researchers. An example pattern of attack would appear in a web\nrequest log with strings like the following:\n\nAn attacker performs an HTTP request against a target system, which generates a log using\nLog4j 2 that leverages JNDI to perform a request to the attacker-controlled site. The\nvulnerability then causes the exploited process to reach out to the site and execute the\npayload. In many observed attacks, the attacker-owned parameter is a DNS logging system,\nintended to log a request to the site to fingerprint the vulnerable systems.\n\nThe specially crafted string that enables exploitation of the vulnerabilities can be identified\nthrough several components. The string contains “jndi”, which refers to the Java Naming and\nDirectory Interface. Following this, the protocol, such as “ldap”, “ldaps”, “rmi”, “dns”, “iiop”, or\n“http”, precedes the attacker domain.\n\n\n-----\n\nAs security teams work to detect the exploitation, attackers have added obfuscation to these\nrequests to evade detections based on request patterns. We’ve seen things like running a\nlower or upper command within the exploitation string and even more complicated\nobfuscation attempts, such as the following, that are all trying to bypass string-matching\ndetections:\n\nThe vast majority of observed activity has been scanning, but exploitation and postexploitation activities have also been observed. Based on the nature of the vulnerabilities,\nonce the attacker has full access and control of an application, they can perform a myriad of\nobjectives. Microsoft has observed activities including installing coin miners, using Cobalt\nStrike to enable credential theft and lateral movement, and exfiltrating data from\ncompromised systems.\n\n### Exploitation continues on non-Microsoft hosted Minecraft servers\n\nMinecraft customers running their own servers are encouraged to deploy the latest Minecraft\nserver update as soon as possible to protect their users. More information can be found\nhere: [https://aka.ms/mclog.](https://aka.ms/mclog)\n\nMicrosoft can confirm public reports of the Khonsari ransomware family being delivered as\n[payload post-exploitation, as discussed by Bitdefender. In Microsoft Defender Antivirus data](https://businessinsights.bitdefender.com/technical-advisory-zero-day-critical-vulnerability-in-log4j2-exploited-in-the-wild)\nwe have observed a small number of cases of this being launched from compromised\nMinecraft clients connected to modified Minecraft servers running a vulnerable version of\nLog4j 2 via the use of a third-party Minecraft mods loader.\n\nIn these cases, an adversary sends a malicious in-game message to a vulnerable Minecraft\nserver, which exploits CVE-2021-44228 to retrieve and execute an attacker-hosted payload\non both the server and on connected vulnerable clients. We observed exploitation leading to\na malicious Java class file that is the Khonsari ransomware, which is then executed in the\ncontext of javaw.exe to ransom the device.\n\nWhile it’s uncommon for Minecraft to be installed in enterprise networks, we have also\nobserved PowerShell-based reverse shells being dropped to Minecraft client systems via the\nsame malicious message technique, giving an actor full access to a compromised system,\nwhich they then use to run Mimikatz to steal credentials. These techniques are typically\nassociated with enterprise compromises with the intent of lateral movement. Microsoft has\nnot observed any follow-on activity from this campaign at this time, indicating that the\nattacker may be gathering access for later use.\n\n\n-----\n\nDue to the shifts in the threat landscape, Microsoft reiterates the guidance for Minecraft\ncustomers running their own servers to deploy the latest Minecraft server update and for\nplayers to exercise caution by only connecting to trusted Minecraft servers.\n\n### Nation-state activity\n\nMSTIC has also observed the CVE-2021-44228 vulnerability being used by multiple tracked\nnation-state activity groups originating from China, Iran, North Korea, and Turkey. This\nactivity ranges from experimentation during development, integration of the vulnerabilities to\nin-the-wild payload deployment, and exploitation against targets to achieve the actor’s\nobjectives.\n\nFor example, MSTIC has observed PHOSPHORUS, an Iranian actor known to deploy\nransomware, acquiring and making modifications of the Log4j exploit. We assess that\nPHOSPHORUS has operationalized these modifications.\n\nIn addition, HAFNIUM, a threat actor group operating out of China, has been observed\nutilizing the vulnerability to attack virtualization infrastructure to extend their typical targeting.\nIn these attacks, HAFNIUM-associated systems were observed using a DNS service\ntypically associated with testing activity to fingerprint systems.\n\n### Access brokers associated with ransomware\n\nMSTIC and the Microsoft 365 Defender team have confirmed that multiple tracked activity\ngroups acting as access brokers have begun using the vulnerability to gain initial access to\ntarget networks. These access brokers then sell access to these networks to ransomwareas-a-service affiliates. We have observed these groups attempting exploitation on both Linux\nand Windows systems, which may lead to an increase in human-operated ransomware\nimpact on both of these operating system platforms.\n\n### Mass scanning activity continues\n\nThe vast majority of traffic observed by Microsoft remains mass scanners by both attackers\nand security researchers. Microsoft has observed rapid uptake of the vulnerability into\nexisting botnets like Mirai, existing campaigns previously targeting vulnerable Elasticsearch\nsystems to deploy cryptocurrency miners, and activity deploying the Tsunami backdoor to\nLinux systems. Many of these campaigns are running concurrent scanning and exploitation\nactivities for both Windows and Linux systems, using Base64 commands included in the\nJDNI:ldap:// request to launch bash commands on Linux and PowerShell on Windows.\n\nMicrosoft has also continued to observe malicious activity performing data leakage via the\nvulnerability without dropping a payload. This attack scenario could be especially impactful\nagainst network devices that have SSL termination, where the actor could leak secrets and\ndata.\n\n\n-----\n\n### Additional RAT payloads\n\nWe’ve observed the dropping of additional remote access toolkits and reverse shells via\nexploitation of CVE-2021-44228, which actors then use for hands-on-keyboard attacks. In\naddition to the Cobalt Strike and PowerShell reverse shells seen in earlier reports, we’ve\nalso seen Meterpreter, Bladabindi, and HabitsRAT. Follow-on activities from these shells\nhave not been observed at this time, but these tools have the ability to steal passwords and\nmove laterally.\n\nThis activity is split between a percentage of small-scale campaigns that may be more\ntargeted or related to testing, and the addition of CVE-2021-44428 to existing campaigns that\nwere exploiting vulnerabilities to drop remote access tools. In the HabitsRAT case, the\ncampaign was seen overlapping with infrastructure used in prior campaigns.\n\n### Webtoos\n\nThe Webtoos malware has DDoS capabilities and persistence mechanisms that could allow\n[an attacker to perform additional activities. As reported by RiskIQ, Microsoft has seen](https://community.riskiq.com/article/67ba1386)\nWebtoos being deployed via the vulnerability. Attackers’ use of this malware or intent is not\nknown at this time, but the campaign and infrastructure have been in use and have been\ntargeting both Linux and Windows systems prior to this vulnerability.\n\n### A note on testing services and assumed benign activity\n\nWhile services such as interact.sh, canarytokens.org, burpsuite, and dnslog.cn may be used\nby IT organizations to profile their own threat footprints, Microsoft encourages including\nthese services in your hunting queries and validating observations of these in environments\nto ensure they are intentional and legitimate activity.\n\n### Exploitation in internet-facing systems leads to ransomware\n\nAs early as January 4, attackers started exploiting the CVE-2021-44228 vulnerability in\ninternet-facing systems running VMware Horizon. Our investigation shows that successful\nintrusions in these campaigns led to the deployment of the NightSky ransomware.\n\nThese attacks are performed by a China-based ransomware operator that we’re tracking as\nDEV-0401. DEV-0401 has previously deployed multiple ransomware families including\nLockFile, AtomSilo, and Rook, and has similarly exploited Internet-facing systems running\nConfluence (CVE-2021-26084) and on-premises Exchange servers (CVE-2021-34473).\n\nBased on our analysis, the attackers are using command and control (CnC) servers that\nspoof legitimate domains. These include service[.]trendmrcio[.]com, api[.]rogerscorp[.]org,\napi[.]sophosantivirus[.]ga, apicon[.]nvidialab[.]us,\nw2zmii7kjb81pfj0ped16kg8szyvmk.burpcollaborator[.]net, and 139[.]180[.]217[.]203.\n\n\n-----\n\n### Attackers propagating Log4j attacks via previously undisclosed vulnerability\n\nDuring our sustained monitoring of threats taking advantage of the Log4j 2 vulnerabilities, we\nobserved activity related to attacks being propagated via a previously undisclosed\nvulnerability in the SolarWinds Serv-U software. We discovered that the vulnerability, now\ntracked as [CVE-2021-35247, is an input validation vulnerability that could allow attackers to](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-35247)\nbuild a query given some input and send that query over the network without sanitation.\n\nWe reported our discovery to SolarWinds, and we’d like to thank their teams for immediately\ninvestigating and working to remediate the vulnerability. We strongly recommend affected\ncustomers to apply security updates released by referring to the SolarWinds advisory here:\n[https://www.solarwinds.com/trust-center/security-advisories/cve-2021-35247.](https://www.solarwinds.com/trust-center/security-advisories/cve-2021-35247)\n\nMicrosoft customers can use threat and vulnerability management in Microsoft Defender for\nEndpoint to identify and remediate devices that have this vulnerability. In addition, Microsoft\nDefender Antivirus and Microsoft Defender for Endpoint detect malicious behavior related to\nthe observed activity.\n\n## Finding and remediating vulnerable apps and systems\n\n### Threat and vulnerability management\n\n[Threat and vulnerability management capabilities in Microsoft Defender for Endpoint monitor](https://www.microsoft.com/security/business/threat-protection/threat-vulnerability-management)\nan organization’s overall security posture and equip customers with real-time insights into\norganizational risk through continuous vulnerability discovery, intelligent prioritization, and\nthe ability to seamlessly remediate vulnerabilities.\n\n**Discovering affected components, software, and devices via a unified Log4j**\n**dashboard**\n\nThreat and vulnerability management automatically and seamlessly identifies devices\naffected by the Log4j vulnerabilities and the associated risk in the environment and\nsignificantly reduces time-to-mitigate. Microsoft continues to iterate on these features based\non the latest information from the threat landscape. This section will be updated as those\nnew features become available for customers.\n\nThe wide use of Log4j across many supplier’s products challenge defender teams to mitigate\n[and address the risks posed by the vulnerabilities (CVE-2021-44228 or](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228) [CVE-2021-45046).](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)\nThe threat and vulnerability management capabilities within Microsoft 365 Defender can help\nidentify vulnerable installations. On December 15, we began rolling out updates to provide a\nconsolidated view of the organizational exposure to the Log4j 2 vulnerabilities—on the\ndevice, software, and vulnerable component level—through a range of automated,\ncomplementing capabilities. These capabilities are supported on Windows 10, Windows 11,\n\n\n-----\n\nand Windows Server 2008, 2012, and 2016. They are also supported on Linux, but they\nrequire updating the Microsoft Defender for Endpoint Linux client to version 101.52.57\n(30.121092.15257.0) or later. The updates include the following:\n\nDiscovery of vulnerable Log4j library components (paths) on devices\nDiscovery of vulnerable installed applications that contain the Log4j library on devices\nA [dedicated Log4j dashboard that provides a consolidated view of various findings](https://security.microsoft.com/vulnerabilities/vulnerability/CVE-2021-44228/overview)\nacross vulnerable devices, vulnerable software, and vulnerable files\nIntroduction of a new schema in advanced hunting,\n**DeviceTvmSoftwareEvidenceBeta, which surfaces file-level findings from the disk**\nand provides the ability to correlate them with additional context in advanced hunting:\n```\nDeviceTvmSoftwareEvidenceBeta\n\n| mv-expand DiskPaths\n\n| where DiskPaths contains \"log4j\"\n\n| project DeviceId, SoftwareName, SoftwareVendor, SoftwareVersion, DiskPaths\n\n```\nTo complement this new table, the existing DeviceTvmSoftwareVulnerabilities table in\nadvanced hunting can be used to identify vulnerabilities in installed software on devices:\n```\nDeviceTvmSoftwareVulnerabilities\n\n| where CveId in (\"CVE-2021-44228\", \"CVE-2021-45046\")\n\n```\nThese capabilities integrate with the existing threat and vulnerability management\nexperience and are gradually rolling out. As of December 27, 2021, discovery is based on\ninstalled application CPEs that are known to be vulnerable to Log4j RCE, as well as the\npresence of vulnerable Log4j Java Archive (JAR) files.\n\nAs of January 20, 2022, threat and vulnerability management can discover vulnerable Log4j\nlibraries, including Log4j files and other files containing Log4j, packaged into Uber-JAR files.\nThis capability is supported on Windows 10, Windows 11, Windows Server 2019, and\nWindows Server 2022. It is also supported on Windows Server 2012 R2 and Windows\nServer 2016 using the Microsoft Defender for Endpoint solution for earlier Windows server\nversions.\n\nThreat and vulnerability management provides layers of detection to help customers discover\nand mitigate vulnerable Log4j components. Specifically, it:\n\n1. determines if a JAR file contains a vulnerable Log4j file by examining JAR files and\n\nsearching for the following file: \\META-INF\\maven\\org.apache.logging.log4j\\log4j_core\\pom.properties; if the said file exists, the Log4j version is read and extracted_\n2. searches for the JndiLookup.class file inside the JAR file by looking for paths that\n\ncontain the string “/log4j/core/lookup/JndiLookup.class”; if the JndiLookup.class\nfile exists, threat and vulnerability management determines if this JAR contains a Log4j\nfile with the version defined in pom.properties\n\n\n-----\n\n3. searches for any vulnerable Log4j-core JAR files embedded within nested-JAR by\n\nsearching for paths that contain any of these strings:\n\n_lib/log4j-core-_\n_WEB-INF/lib/log4j-core-_\n_App-INF/lib/log4j-core-_\n\n_Figure 1. Threat and Vulnerability recommendation “Attention required: Devices found with_\n_vulnerable Apache Log4j versions”_\n\nIn the Microsoft 365 Defender portal, go to Vulnerability management > Dashboard >\n**Threat awareness, then click View vulnerability details to see the consolidated view of**\norganizational exposure to the Log4j 2 vulnerability (for example, CVE-2021-44228\n\n\n-----\n\ndashboard, as shown in the following screenshots) on the device, software, and vulnerable\ncomponent level.\n\n_Figure 2. Threat and vulnerability management dedicated CVE-2021-44228 dashboard_\n\n_Figure 3. Threat and vulnerability management finds exposed paths_\n\n\n-----\n\n_Figure 4. Threat and vulnerability management finds exposed devices based on vulnerable_\n_software and vulnerable files detected on disk_\n\nNote: Scan results may take some time to reach full coverage, and the number of discovered\ndevices may be low at first but will grow as the scan reaches more devices. A regularly\nupdated list of vulnerable products can be viewed in the Microsoft 365 Defender portal with\nmatching recommendations. We will continue to review and update this list as new\ninformation becomes available.\n\nThrough [device discovery, unmanaged devices with products and services affected by the](https://techcommunity.microsoft.com/t5/microsoft-defender-for-endpoint/unmanaged-device-protection-capabilities-are-now-generally/ba-p/2463796)\nvulnerabilities are also surfaced so they can be onboarded and secured.\n\n_Figure 5. Finding vulnerable applications and devices via software inventory_\n\n**Applying mitigation directly in the Microsoft 365 Defender portal**\n\n\n-----\n\nWe have released two new threat and vulnerability management capabilities that can\nsignificantly simplify the process of turning off JNDI lookup, a workaround that can prevent\nthe exploitation of the Log4j vulnerabilities on most devices, using an environment variable\ncalled LOG4J_FORMAT_MSG_NO_LOOKUPS. These new capabilities provide security\nteams with the following:\n\n1. View the mitigation status for each affected device. This can help prioritize mitigation\n\nand/or patching of devices based on their mitigation status.\n\n[To use this feature, open the Exposed devices tab in the dedicated CVE-2021-44228](https://security.microsoft.com/vulnerabilities/vulnerability/CVE-2021-44228/exposedDevices)\ndashboard and review the Mitigation status column. Note that it may take a few hours for\nthe updated mitigation status of a device to be reflected.\n\n_Figure 6. Viewing each device’s mitigation status_\n\n1. Apply the mitigation (that is, turn off JNDI lookup) on devices directly from the portal.\n\nThis feature is currently available for Windows devices only.\n\nThe mitigation will be applied directly via the Microsoft Defender for Endpoint client. To view\nthe mitigation options, click on the Mitigation options button in the [Log4j dashboard:](https://security.microsoft.com/vulnerabilities/vulnerability/CVE-2021-44228/overview)\n\nYou can choose to apply the mitigation to all exposed devices or select specific devices for\nwhich you would like to apply it. To complete the process and apply the mitigation on\ndevices, click Create mitigation action.\n\n\n-----\n\n_Figure 7. Creating mitigation actions for exposed devices._\n\nIn cases where the mitigation needs to be reverted, follow these steps:\n\n1. Open an elevated PowerShell window\n2. Run the following command:\n```\n[Environment]::SetEnvironmentVariable(\"LOG4J_FORMAT_MSG_NO_LOOKUPS\", $null,\n[EnvironmentVariableTarget]::Machine)\n\n```\nThe change will take effect after the device restarts.\n\n### Microsoft 365 Defender advanced hunting\n\nAdvance hunting can also surface affected software. This query looks for possibly vulnerable\napplications using the affected Log4j component. Triage the results to determine applications\nand programs that may need to be patched and updated.\n```\nDeviceTvmSoftwareInventory\n\n| where SoftwareName contains \"log4j\"\n\n| project DeviceName, SoftwareName, SoftwareVersion\n\n```\n\n-----\n\n_Figure 8. Finding vulnerable software via advanced hunting_\n\n### Microsoft Defender for Cloud\n\n**Microsoft Defender for servers**\n\n[Organizations using Microsoft Defender for Cloud can use Inventory tools to begin](https://docs.microsoft.com/azure/defender-for-cloud/asset-inventory)\ninvestigations before there’s a CVE number. With Inventory tools, there are two ways to\ndetermine exposure across hybrid and multi-cloud resources:\n\nVulnerability assessment findings – Organizations who have enabled any of the\nvulnerability assessment tools (whether it’s Microsoft Defender for Endpoint’s threat\n[and vulnerability management module, the built-in Qualys scanner, or a](https://docs.microsoft.com/azure/defender-for-cloud/deploy-vulnerability-assessment-vm) bring your own\nlicense solution), they can search by CVE identifier:\n\n_Figure 9. Searching vulnerability assessment findings by CVE identifier_\n\n\n-----\n\nSoftware inventory – With the combined integration with Microsoft Defender for\nEndpoint and [Microsoft Defender for servers, organizations can search for resources](https://docs.microsoft.com/azure/defender-for-cloud/defender-for-servers-introduction)\nby installed applications and discover resources running the vulnerable software:\n\n_Figure 10. Searching software inventory by installed applications_\n\nNote that this doesn’t replace a search of your codebase. It’s possible that software with\nintegrated Log4j libraries won’t appear in this list, but this is helpful in the initial triage of\ninvestigations related to this incident. For more information about how Microsoft Defender for\n[Cloud finds machines affected by CVE-2021-44228, read this tech community post.](https://techcommunity.microsoft.com/t5/microsoft-defender-for-cloud/how-defender-for-cloud-finds-machines-affected-by-log4j/ba-p/3037271)\n\n**Microsoft Defender for Containers**\n\nMicrosoft Defender for Containers is capable of discovering images affected by the\n[vulnerabilities recently discovered in Log4j 2: CVE-2021-44228,](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228) [CVE-2021-45046, and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046) CVE2021-45105. Images are automatically scanned for vulnerabilities in three different use\ncases: when pushed to an Azure container registry, when pulled from an Azure container\nregistry, and when container images are running on a Kubernetes cluster. Additional\n[information on supported scan triggers and Kubernetes clusters can be found here.](https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction?tabs=defender-for-container-arch-aks)\n\nLog4j binaries are discovered whether they are deployed via a package manager, copied to\nthe image as stand-alone binaries, or included within a JAR Archive (up to one level of\nnesting).\n\nWe will continue to follow up on any additional developments and will update our detection\ncapabilities if any additional vulnerabilities are reported.\n\n**Finding affected images**\n\nTo find vulnerable images across registries using the Azure portal, navigate to the Microsoft\n**Defender for Cloud service under Azure Portal. Open the Container Registry images**\n**should have vulnerability findings resolved recommendation and search findings for the**\n\n\n-----\n\nrelevant CVEs.\n\n_Figure 11. Finding images with the CVE-2021-45046 vulnerability_\n\n**Find vulnerable running images on Azure portal [preview]**\n\nTo view only vulnerable images that are currently running on a Kubernetes cluster using the\nAzure portal, navigate to the Microsoft Defender for Cloud service under Azure Portal.\nOpen the Vulnerabilities in running container images should be remediated (powered\n**by Qualys) recommendation and search findings for the relevant CVEs:**\n\n_Figure 12. Finding running images with the CVE-2021-45046 vulnerability_\n\n\n-----\n\nNote: This recommendation requires clusters to run Microsoft Defender security profile to\nprovide visibility on running images.\n\n**Search Azure Resource Graph data**\n\nAzure Resource Graph (ARG) provides instant access to resource information across cloud\nenvironments with robust filtering, grouping, and sorting capabilities. It’s a quick and efficient\nway to query information across Azure subscriptions programmatically or from within the\nAzure portal. ARG provides another way to query resource data for resources found to be\naffected by the Log4j vulnerability.\n\nThe following query finds resources affected by the Log4j vulnerability across subscriptions.\nUse the additional data field across all returned results to obtain details on vulnerable\nresources:\n```\nsecurityresources\n\n| where type =~ \"microsoft.security/assessments/subassessments\"\n\n| extend assessmentKey=extract(@\"(?\ni)providers/Microsoft.Security/assessments/([^/]*)\", 1, id),\nsubAssessmentId=tostring(properties.id), parentResourceId= extract(\"\n(.+)/providers/Microsoft.Security\", 1, id)\n\n| extend Props = parse_json(properties)\n\n| extend additionalData = Props.additionalData\n\n| extend cves = additionalData.cve\n\n| where isnotempty(cves) and array_length(cves) > 0\n\n| mv-expand cves\n\n| where tostring(cves) has \"CVE-2021-44228\" or tostring(cves) has \"CVE-2021-45046\" or\ntostring(cves) has \"CVE-2021-45105\"\n\n### Microsoft Sentinel queries\n\n```\nMicrosoft Sentinel customers can use the following detection query to look for devices that\nhave applications with the vulnerability:\n\n[Vulnerable machines related to Log4j CVE-2021-44228](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/SecurityNestedRecommendation/Log4jVulnerableMachines.yaml)\n\nThis query uses the Microsoft Defender for Cloud nested recommendations data to find\nmachines vulnerable to Log4j CVE-2021-44228.\n\nMicrosoft Sentinel also provides a CVE-2021-44228 Log4Shell Research Lab Environment\nfor testing the vulnerability: https://github.com/OTRF/MicrosoftSentinel2Go/tree/master/grocery-list/Linux/demos/CVE-2021-44228-Log4Shell\n\n### RiskIQ EASM and Threat Intelligence\n\n\n-----\n\nRiskIQ has published a few threat intelligence articles on this CVE, with mitigation guidance\n[and IOCs. The latest one with links to previous articles can be found here. Both Community](https://community.riskiq.com/article/67ba1386)\nusers and enterprise customers can search within the threat intelligence portal for data about\npotentially vulnerable components exposed to the Internet. For example, it’s possible to\n[surface all observed instances of Apache or](https://community.riskiq.com/search/components?category=Server&query=Apache) [Java, including specific versions. Leverage this](https://community.riskiq.com/research?query=java)\nmethod of exploration to aid in understanding the larger Internet exposure, while also filtering\ndown to what may impact you.\n\nFor a more automated method, registered users can view their attack surface to understand\ntailored findings associated with their organization. Note, you must be registered with a\ncorporate email and the automated attack surface will be limited. Digital Footprint customers\ncan immediately understand what may be vulnerable and act swiftly and resolutely using the\n[Attack Surface Intelligence Dashboard Log4J Insights tab.](https://app.riskiq.net/a/main/index#/dashboards/379/RiskIQ%20Attack%20Intelligence%20Dashboard)\n\n## Detecting and responding to exploitation attempts and other related attacker activity\n\n### Microsoft 365 Defender\n\nMicrosoft 365 Defender coordinates multiple security solutions that detect components of\nobserved attacks taking advantage of this vulnerability, from exploitation attempts to remote\ncode execution and post-exploitation activity.\n\n\n-----\n\n_Figure 13. Microsoft 365 Defender solutions protect against related threats_\n\nCustomers can click Need help? in the Microsoft 365 Defender portal to open up a search\nwidget. Customers can key in “Log4j” to search for in-portal resource, check if their network\nis affected, and work on corresponding actionable items to mitigate them.\n\n**Microsoft Defender Antivirus**\n\nTurn on cloud-delivered protection in Microsoft Defender Antivirus to cover rapidly evolving\nattacker tools and techniques. Cloud-based machine learning protections block the majority\nof new and unknown variants. Microsoft Defender Antivirus detects components and\nbehaviors related to this threat as the following detection names:\n\nOn Windows:\n\n[Trojan:Win32/Capfetox.AA– detects attempted exploitation on the attacker machine](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/Capfetox.AA&threatId=-2147159827)\n[HackTool:Win32/Capfetox.A!dha – detects attempted exploitation on the attacker](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win32/Capfetox.A!dha&threatId=-2147159807)\nmachine\n[VirTool:Win64/CobaltSrike.A,](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=VirTool:Win64/CobaltStrike.A&threatId=-2147200161) [TrojanDropper:PowerShell/Cobacis.A – detects Cobalt](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDropper:PowerShell/Cobacis.A&threatId=-2147200375)\nStrike Beacon loaders\n[TrojanDownloader:Win32/CoinMiner – detects post-exploitation coin miner](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:Win32/CoinMiner&threatId=-2147257370)\n[Trojan:Win32/WebToos.A – detects post-exploitation PowerShell](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/WebToos.A&threatId=-2147278986)\n\n\n-----\n\n[Ransom:MSIL/Khonsari.A – detects a strain of the Khonsari ransomware family](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Ransom:MSIL/Khonsari.A&threatId=-2147159485)\nobserved being distributed post-exploitation\n[Trojan:Win64/DisguisedXMRigMiner – detects post-exploitation cryptocurrency miner](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win64/DisguisedXMRigMiner&threatId=-2147169351)\n[TrojanDownloader:Java/Agent.S – detects suspicious class files used in post-](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:Java/Agent.S&threatId=-2147159796)\nexploitation\n[TrojanDownloader:PowerShell/NitSky.A – detects attempts to download CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:PowerShell/NitSky.A&threatId=-2147157401)\nBeacon payload\n\nOn Linux:\n\n[Trojan:Linux/SuspectJavaExploit.A,](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Linux/SuspectJavaExploit.A&threatId=-2147159829) [Trojan:Linux/SuspectJavaExploit.B,](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Linux/SuspectJavaExploit.B&threatId=-2147159828)\n[Trojan:Linux/SuspectJavaExploit.C – blocks Java processes downloading and](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Linux/SuspectJavaExploit.C&threatId=-2147159808)\nexecuting payload through output redirection\n[Trojan:Linux/BashMiner.A – detects post-exploitation cryptocurrency miner](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Linux/BashMiner.A&threatId=-2147159832)\n[TrojanDownloader:Linux/CoinMiner – detects post-exploitation cryptocurrency miner](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:Linux/CoinMiner&threatId=-2147241315)\n[TrojanDownloader:Linux/Tusnami – detects post-exploitation Backdoor Tsunami](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:Linux/Tusnami.A&threatId=-2147159794)\ndownloader\n[Backdoor:Linux/Tusnami.C – detects post-exploitation Tsunami backdoor](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Backdoor:Linux/Tusnami.C!MTB&threatId=-2147178887)\n[Backdoor:Linux/Setag.C – detects post-exploitation Gates backdoor](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Backdoor:Linux/Setag.C&threatId=-2147277056)\n[Exploit:Linux/CVE-2021-44228.A,](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Exploit:Linux/CVE-2021-44228.A&threatId=-2147159804) [Exploit:Linux/CVE-2021-44228.B – detects](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Exploit:Linux/CVE-2021-44228.B&threatId=-2147159803)\nexploitation\n[TrojanDownloader:Linux/Capfetox.A,](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:Linux/Capfetox.A&threatId=-2147159639) [TrojanDownloader:Linux/Capfetox.B](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:Linux/Capfetox.B&threatId=-2147159640)\n[TrojanDownloader:Linux/ShAgnt!MSR,](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:Linux/ShAgnt!MSR&threatId=-2147159432) [TrojanDownloader:Linux/ShAgnt.A!MTB](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:Linux/ShAgnt.A!MTB&threatId=-2147159607)\n[Trojan:Linux/Kinsing.L – detects post-exploitation cryptocurrency Kinsing miner](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Linux/Kinsing.L&threatId=-2147189973)\n[Trojan:Linux/Mirai.TS!MTB – detects post-exploitation Mirai malware capable of](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Linux/Mirai.TS!MTB&threatId=-2147159629)\nperforming DDoS\n[Backdoor:Linux/Dakkatoni.az!MTB – detects post-exploitation Dakkatoni backdoor](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Backdoor:Linux/Dakkatoni.az!MTB&threatId=-2147205141)\ntrojan capable of downloading more payloads\n[Trojan:Linux/JavaExploitRevShell.A – detects reverse shell attack post-exploitation](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Linux/JavaExploitRevShell.A&threatId=-2147159631)\n[Trojan:Linux/BashMiner.A,](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Linux/BashMiner.A&threatId=-2147159832) [Trojan:Linux/BashMiner.B – detects post-exploitation](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Linux/BashMiner.B&threatId=-2147159820)\ncryptocurrency miner\n\n**Microsoft Defender for Endpoint**\n\nUsers of Microsoft Defender for Endpoint can turn on the following attack surface reduction\nrule to block or audit some observed activity associated with this threat.\n\nBlock executable files from running unless they meet a prevalence, age, or trusted list\ncriterion\n\nDue to the broad network exploitation nature of vectors through which this vulnerability can\nbe exploited and the fact that applying mitigations holistically across large environments will\ntake time, we encourage defenders to look for signs of post-exploitation rather than fully\n\n\n-----\n\nrelying on prevention. Observed post exploitation activity such as coin mining, lateral\nmovement, and Cobalt Strike are detected with behavior-based detections.\n\nAlerts with the following titles in the Security Center indicate threat activity related to\nexploitation of the Log4j vulnerability on your network and should be immediately\ninvestigated and remediated. These alerts are supported on both Windows and Linux\nplatforms:\n\n**Log4j exploitation detected – detects known behaviors that attackers perform**\nfollowing successful exploitation of the CVE-2021-44228 vulnerability\n**Log4j exploitation artifacts detected (previously titled Possible exploitation of CVE-**\n2021-44228) – detects coin miners, shells, backdoor, and payloads such as Cobalt\nStrike used by attackers post-exploitation\n**Log4j exploitation network artifacts detected (previously titled Network connection**\nseen in CVE-2021-44228 exploitation) – detects network traffic connecting traffic\nconnecting to an address associated with CVE-2021-44228 scanning or exploitation\nactivity\n\nThe following alerts may indicate exploitation attempts or testing/scanning activity. Microsoft\nadvises customers to investigate with caution, as these alerts don’t necessarily indicate\nsuccessful exploitation:\n\n**Possible target of Log4j exploitation – detects a possible attempt to exploit the**\nremote code execution vulnerability in the Log4j component of an Apache server in\ncommunication received by this device\n**Possible target of Log4j vulnerability scanning – detects a possible attempt to**\n_scan for the remote code execution vulnerability in a Log4j component of an Apache_\nserver in communication received by this device\n**Possible source of Log4j exploitation – detects a possible attempt to exploit the**\nremote code execution vulnerability in the Log4j component of an Apache server in\ncommunication initiated from this device\n**Possible Log4j exploitation – detects multiple behaviors, including suspicious**\ncommand launch post-exploitation\n**Possible Log4j exploitation (CVE-2021-44228) – inactive, initially covered several of**\nthe above, now replaced with more specific titles\n\nThe following alerts detect activities that have been observed in attacks that utilize at least\none of the Log4j vulnerabilities. However, these alerts can also indicate activity that is not\nrelated to the vulnerability. We are listing them here, as it is highly recommended that they\nare triaged and remediated immediately given their severity and the potential that they could\nbe related to Log4j exploitation:\n\nSuspicious remote PowerShell execution\n\n\n-----\n\nDownload of file associated with digital currency mining\nProcess associated with digital currency mining\nCobalt Strike command and control detected\nSuspicious network traffic connection to C2 Server\nOngoing hands-on-keyboard attacker activity detected (Cobalt Strike)\n\nSome of the alerts mentioned above utilize the enhanced network inspection capabilities in\nMicrosoft Defender for Endpoint. These alerts correlate several network and endpoint signals\ninto high-confidence detection of successful exploitation, as well as providing detailed\nevidence artifacts valuable for triage and investigation of detected activities.\n\n_Figure 14. Example detection leveraging network inspection provides details about the Java_\n_class returned following successful exploitation_\n\n**Microsoft Defender for Cloud Apps (previously Microsoft Cloud App Security)**\n\nMicrosoft 365 Defender detects exploitation patterns in different data sources, including\ncloud application traffic reported by Microsoft Defender for Cloud Apps. The following alert\nsurfaces exploitation attempts via cloud applications that use vulnerable Log4j components:\n\nLog4j exploitation attempt via cloud application (previously titled Exploitation attempt\nagainst Log4j (CVE-2021-44228))\n\n\n-----\n\n_Figure 15. Microsoft 365 Defender alert “Exploitation attempt against Log4j (CVE-2021-_\n_4428)”_\n\n**Microsoft Defender for Office 365**\n\nTo add a layer of protection against exploits that may be delivered via email, Microsoft\nDefender for Office 365 flags suspicious emails (e.g., emails with the “jndi” string in email\nheaders or the sender email address field), which are moved to the Junk folder.\n\nWe also added the following new alert, which detects attempts to exploit CVE-2021-44228\nthrough email headers:\n\nLog4j exploitation attempt via email (previously titled Log4j Exploitation Attempt – Email\nHeaders (CVE-2021-44228))\n\n\n-----\n\n_Figure 16. Sample alert on malicious sender display name found in email correspondence_\n\nThis detection looks for exploitation attempts in email headers, such as the sender display\nname, sender, and recipient addresses. The alert covers known obfuscation attempts that\nhave been observed in the wild. If this alert is surfaced, customers are recommended to\nevaluate the source address, email subject, and file attachments to get more context\nregarding the authenticity of the email.\n\n_Figure 17. Sample email with malicious sender display name_\n\nIn addition, this email event as can be surfaced via advanced hunting:\n\n\n-----\n\n_Figure 18. Sample email event surfaced via advanced hunting_\n\n**Microsoft 365 Defender advanced hunting queries**\n\nTo locate possible exploitation activity, run the following queries:\n\n**Possible malicious indicators in cloud application events**\n\nThis query is designed to flag exploitation attempts for cases where the attacker is sending\nthe crafted exploitation string using vectors such as User-Agent, Application or Account\nname. The hits returned from this query are most likely unsuccessful attempts, however the\nresults can be useful to identity attackers’ details such as IP address, Payload string,\nDownload URL, etc.\n```\nCloudAppEvents\n\n| where Timestamp > datetime(\"2021-12-09\")\n\n| where UserAgent contains \"jndi:\"\n\nor AccountDisplayName contains \"jndi:\"\n\nor Application contains \"jndi:\"\n\nor AdditionalFields contains \"jndi:\"\n\n| project ActionType, ActivityType, Application, AccountDisplayName, IPAddress,\nUserAgent, AdditionalFields\n\n```\n**Alerts related to Log4j vulnerability**\n\nThis query looks for alert activity pertaining to the Log4j vulnerability.\n```\nAlertInfo\n\n| where Title in~('Suspicious script launched',\n\n'Exploitation attempt against Log4j (CVE-2021-44228)',\n\n'Suspicious process executed by a network service',\n\n'Possible target of Log4j exploitation (CVE-2021-44228)',\n\n'Possible target of Log4j exploitation',\n\n'Possible Log4j exploitation',\n\n'Network connection seen in CVE-2021-44228 exploitation',\n\n'Log4j exploitation detected',\n\n'Possible exploitation of CVE-2021-44228',\n\n'Possible target of Log4j vulnerability (CVE-2021-44228) scanning',\n\n'Possible source of Log4j exploitation',\n\n'Log4j exploitation attempt via cloud application', // Previously titled Exploitation\nattempt against Log4j\n\n'Log4j exploitation attempt via email' // Previously titled Log4j Exploitation\nAttempt\n\n)\n\n```\n\n-----\n\n**Devices with Log4j vulnerability alerts and additional other alert-related context**\n\nThis query surfaces devices with Log4j-related alerts and adds additional context from other\nalerts on the device.\n```\n// Get any devices with Log4J related Alert Activity\n\nlet DevicesLog4JAlerts = AlertInfo\n\n| where Title in~('Suspicious script launched',\n\n'Exploitation attempt against Log4j (CVE-2021-44228)',\n\n'Suspicious process executed by a network service',\n\n'Possible target of Log4j exploitation (CVE-2021-44228)',\n\n'Possible target of Log4j exploitation',\n\n'Possible Log4j exploitation',\n\n'Network connection seen in CVE-2021-44228 exploitation',\n\n'Log4j exploitation detected',\n\n'Possible exploitation of CVE-2021-44228',\n\n'Possible target of Log4j vulnerability (CVE-2021-44228) scanning',\n\n'Possible source of Log4j exploitation'\n\n'Log4j exploitation attempt via cloud application', // Previously titled Exploitation\nattempt against Log4j\n\n'Log4j exploitation attempt via email' // Previouskly titled Log4j Exploitation\nAttempt\n\n)\n\n// Join in evidence information\n\n| join AlertEvidence on AlertId\n\n| where DeviceId != \"\"\n\n| summarize by DeviceId, Title;\n\n// Get additional alert activity for each device\n\nAlertEvidence\n\n| where DeviceId in(DevicesLog4JAlerts)\n\n// Add additional info\n\n| join kind=leftouter AlertInfo on AlertId\n\n| summarize DeviceAlerts = make_set(Title), AlertIDs = make_set(AlertId) by DeviceId,\nbin(Timestamp, 1d)\n\n```\n**Suspected exploitation of Log4j vulnerability**\n\nThis query looks for exploitation of the vulnerability using known parameters in the malicious\nstring. It surfaces exploitation but may surface legitimate behavior in some environments.\n```\nDeviceProcessEvents\n\n| where ProcessCommandLine has_all('${jndi') and ProcessCommandLine has_any('ldap',\n'ldaps', 'http', 'rmi', 'dns', 'iiop')\n\n//Removing FPs\n\n| where not(ProcessCommandLine has_any('stackstorm', 'homebrew'))\n\n```\n**Regex to identify malicious exploit string**\n\nThis query looks for the malicious string needed to exploit this vulnerability.\n\n\n-----\n\n```\nDeviceProcessEvents\n\n| where ProcessCommandLine matches regex @'(?i)\\$\\{jndi:\n(ldap|http|https|ldaps|dns|rmi|iiop):\\/\\/(\\$\\{([a-z]){1,20}:([a-z]){1,20}\\})?(([a-zAZ0-9]|-){2,100})?(\\.([a-zA-Z0-9]|-){2,100})?\\.([a-zA-Z0-9]|-){2,100}\\.([a-z0-9])\n{2,20}(\\/).*}'  \n\nor InitiatingProcessCommandLine matches regex @'(?i)\\$\\{jndi:\n(ldap|http|https|ldaps|dns|rmi|iiop):\\/\\/(\\$\\{([a-z]){1,20}:([a-z]){1,20}\\})?(([a-zAZ0-9]|-){2,100})?(\\.([a-zA-Z0-9]|-){2,100})?\\.([a-zA-Z0-9]|-){2,100}\\.([a-z0-9])\n{2,20}(\\/).*}'\n\n```\n**Suspicious process event creation from VMWare Horizon TomcatService**\n\nThis query identifies anomalous child processes from the ws_TomcatService.exe process\nassociated with the exploitation of the Log4j vulnerability in VMWare Horizon installations.\nThese events warrant further investigation to determine if they are in fact related to a\nvulnerable Log4j application.\n```\nDeviceProcessEvents\n\n| where InitiatingProcessFileName has \"ws_TomcatService.exe\"\n\n| where FileName != \"repadmin.exe\"\n\n```\n**Suspicious JScript staging comment**\n\nThis query identifies a unique string present in malicious PowerShell commands attributed to\nthreat actors exploiting vulnerable Log4j applications. These events warrant further\ninvestigation to determine if they are in fact related to a vulnerable Log4j application.\n```\nDeviceProcessEvents\n\n| where FileName has \"powershell.exe\"\n\n| where ProcessCommandLine has \"VMBlastSG\"\n\n\n```\n**Suspicious PowerShell curl flags**\n\nThis query identifies unique, uncommon PowerShell flags used by curl to post the results of\nan attacker-executed command back to the command-and-control infrastructure. If the event\nis a true positive, the contents of the “Body” argument are Base64-encoded results from an\nattacker-issued comment. These events warrant further investigation to determine if they are\nin fact related to a vulnerable Log4j application.\n```\nDeviceProcessEvents\n\n| where FileName has \"powershell.exe\"\n\n| where ProcessCommandLine has_all(\"-met\", \"POST\", \"-Body\")\n\n### Microsoft Defender for Cloud\n\n```\nMicrosoft Defender for Cloud’s threat detection capabilities have been expanded to surface\nexploitation of CVE-2021-44228 in several relevant security alerts:\n\nOn Windows:\n\n\n-----\n\nDetected obfuscated command line\nSuspicious use of PowerShell detected\n\nOn Linux:\n\nSuspicious file download\nPossible Cryptocoinminer download detected\nProcess associated with digital currency mining detected\nPotential crypto coin miner started\nA history file has been cleared\nSuspicious Shell Script Detected\nSuspicious domain name reference\nDigital currency mining related behavior detected\nBehavior similar to common Linux bots detected\n\n### Microsoft Defender for IoT\n\nMicrosoft Defender for IoT has released a dedicated threat Intelligence update package for\ndetecting Log4j 2 exploit attempts on the network (example below).\n\n_Figure 19. Microsoft Defender for IoT alert_\n\nThe package is available for download from the Microsoft Defender for IoT\nportal (Click Updates, then Download file (MD5: 4fbc673742b9ca51a9721c682f404c41).\n\n\n-----\n\n_Figure 20. Microsoft Defender for IoT sensor threat intelligence update_\n\nMicrosoft Defender for IoT now pushes new threat intelligence packages to cloud-connected\n[sensors upon release, click here for more information. Starting with sensor version 10.3,](https://docs.microsoft.com/en-us/azure/defender-for-iot/organizations/release-notes)\nusers can automatically receive up-to-date threat intelligence packages through Microsoft\nDefender for IoT.\n\nWorking with automatic updates reduces operational effort and ensures greater security.\nEnable automatic updating on the [Defender for IoT portal by onboarding your cloud-](https://ms.portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard/Sites)\nconnected sensor with the toggle for Automatic Threat Intelligence Updates turned on. For\nmore information about threat intelligence packages in Defender for IoT, please refer to the\n[documentation.](https://docs.microsoft.com/en-us/azure/defender-for-iot/organizations/how-to-work-with-threat-intelligence-packages)\n\n### Microsoft Sentinel\n\nA new Microsoft Sentinel solution has been added to the Content Hub that provides a central\nplace to install Microsoft Sentinel specific content to monitor, detect, and investigate signals\nrelated to exploitation of the CVE-2021-44228 vulnerability.\n\n\n-----\n\n_Figure 21. Log4j Vulnerability Detection solution in Microsoft Sentinel_\n\nTo deploy this solution, in the Microsoft Sentinel portal, select Content hub (Preview) under\n**Content Management, then search for Log4j in the search bar. Select the Log4j**\n**vulnerability detection solution, and click Install. Learn how to centrally discover and**\ndeploy Microsoft Sentinel out-of-the-box content and solutions.\n\n\n-----\n\n_Figure 22. Microsoft Sentinel Analytics showing detected Log4j vulnerability_\n\nNote: We recommend that you check the solution for updates periodically, as new collateral\nmay be added to this solution given the rapidly evolving situation. This can be verified on the\nmain Content hub page.\n\n**Microsoft Sentinel queries**\n\nMicrosoft Sentinel customers can use the following detection queries to look for this activity:\n\n[Possible exploitation of Apache Log4j component detected](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Syslog/Apache_log4j_Vulnerability.yaml)\n\nThis hunting query looks for possible attempts to exploit a remote code execution\nvulnerability in the Log4j component of Apache. Attackers may attempt to launch arbitrary\ncode by passing specific commands to a server, which are then logged and executed by the\nLog4j component.\n\n[Cryptocurrency miners EXECVE](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Syslog/CryptoCurrencyMiners.yaml)\n\nThis query hunts through EXECVE syslog data generated by AUOMS to find instances of\ncryptocurrency miners being downloaded. It returns a table of suspicious command lines.\n\n[Azure WAF Log4j CVE-2021-44228 hunting](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/AzureDiagnostics/WAF_log4j_vulnerability.yaml)\n\nThis hunting query looks in Azure Web Application Firewall data to find possible exploitation\nattempts for CVE-2021-44228 involving Log4j vulnerability.\n\n[Log4j vulnerability exploit aka Log4Shell IP IOC](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/Log4J_IPIOC_Dec112021.yaml)\n\nThis hunting query identifies a match across various data feeds for IP IOCs related to the\nLog4j exploit described in CVE-2021-44228.\n\n[Suspicious shell script detected](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Syslog/Suspicious_ShellScript_Activity.yaml)\n\n\n-----\n\nThis hunting query helps detect post-compromise suspicious shell scripts that attackers use\nfor downloading and executing malicious files. This technique is often used by attackers and\nwas recently used to exploit the vulnerability in Log4j component of Apache to evade\ndetection and stay persistent or for more exploitation in the network.\n\nThis query alerts on a positive pattern match by Azure WAF for CVE-2021-44228 Log4j\nexploitation attempt. If possible, it then decodes the malicious command for further analysis.\n\n[Suspicious Base64 download activity detected](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Syslog/Base64_Download_Activity.yaml)\n\nThis hunting query helps detect suspicious encoded Base64 obfuscated scripts that\nattackers use to encode payloads for downloading and executing malicious files. This\ntechnique is often used by attackers and was recently used to the Log4j vulnerability in order\nto evade detection and stay persistent in the network.\n\n[Linux security-related process termination activity detected](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Syslog/Process_Termination_Activity.yaml)\n\nThis query alerts on attempts to terminate processes related to security monitoring. Attackers\noften try to terminate such processes post-compromise as seen recently to exploit the CVE2021-44228 vulnerability.\n\n[Suspicious manipulation of firewall detected via Syslog data](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Syslog/Firewall_Disable_Activity.yaml)\n\nThis query uses syslog data to alert on any suspicious manipulation of firewall to evade\ndefenses. Attackers often perform such operations as seen recently to exploit the CVE-202144228 vulnerability for C2 communications or exfiltration.\n\n[User agent search for Log4j exploitation attempt](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/UserAgentSearch_log4j.yaml)\n\nThis query uses various log sources having user agent data to look for CVE-2021-44228\nexploitation attempt based on user agent pattern.\n\n[Network connections to LDAP port for CVE-2021-44228 vulnerability](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/MultipleDataSources/NetworkConnectionldap_log4j.yaml)\n\nThis hunting query looks for connection to LDAP port to find possible exploitation attempts\nfor CVE-2021-44228.\n\n[Linux toolkit detected](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Syslog/Linux_Toolkit_Detected.yaml)\n\nThis query uses syslog data to alert on any attack toolkits associated with massive scanning\nor exploitation attempts against a known vulnerability\n\n[Container miner activity](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/Syslog/Container_Miner_Activity.yaml)\n\nThis query uses syslog data to alert on possible artifacts associated with containers running\nimages related to digital cryptocurrency mining.\n\n\n-----\n\n[Network connection to new external LDAP server](https://github.com/Azure/Azure-Sentinel/blob/master/Hunting%20Queries/CommonSecurityLog/NetworkConnectionToNewExternalLDAPServer.yaml)\n\nThis query looks for outbound network connections using the LDAP protocol to external IP\naddresses, where that IP address has not had an LDAP network connection to it in the 14\ndays preceding the query timeframe. This could indicate someone exploiting a vulnerability\nsuch as CVE-2021-44228 to trigger the connection to a malicious LDAP server.\n\n### Azure Firewall Premium\n\nCustomers using Azure Firewall Premium have enhanced protection from the Log4j RCE\nCVE-2021-44228 vulnerability and exploit. Azure Firewall premium IDPS (Intrusion Detection\nand Prevention System) provides IDPS inspection for all east-west traffic and outbound\ntraffic to internet. The vulnerability rulesets are continuously updated and include CVE-202144228 vulnerability for different scenarios including UDP, TCP, HTTP/S protocols since\nDecember 10th, 2021. Below screenshot shows all the scenarios which are actively\nmitigated by Azure Firewall Premium.\n\n**[Recommendation: Customers are recommended to configure Azure Firewall Premium with](https://docs.microsoft.com/en-us/azure/firewall/premium-migrate)**\nboth IDPS Alert & Deny mode and TLS inspection enabled for proactive protection against\n**CVE-2021-44228 exploit.**\n\n_Figure 23. Azure Firewall Premium portal_\n\nCustomers using Azure Firewall Standard can migrate to Premium by following these\ndirections. Customers new to Azure Firewall premium can learn more about Firewall\nPremium.\n\n\n-----\n\n### Azure Web Application Firewall (WAF)\n\nIn response to this threat, Azure Web Application Firewall (WAF) has updated Default Rule\nSet (DRS) versions 1.0/1.1 available for Azure Front Door global deployments, and OWASP\nModSecurity Core Rule Set (CRS) version 3.0/3.1 available for Azure Application Gateway\nV2 regional deployments.\n\nTo help detect and mitigate the Log2Shell vulnerability by inspecting requests’ headers, URI,\nand body, we have released the following:\n\nFor Azure Front Door deployments, we have updated the rule 944240 “Remote\n**Command Execution” under Managed Rules**\nFor Azure Application Gateway V2 regional deployments, we have introduced a new\nrule Known-CVEs/800100 in the rule group Known-CVEs under Managed Rules\n\nThese rules are already enabled by default in block mode for all existing WAF Default Rule\nSet (DRS) 1.0/1.1 and OWASP ModSecurity Core Rule Set (CRS) 3.0/3.1 configurations.\nCustomers using WAF Managed Rules would have already received enhanced protection for\n[Log4j 2 vulnerabilities (CVE-2021-44228 and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44228) [CVE-2021-45046); no additional action is](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)\nneeded.\n\n**Recommendation: Customers are recommended to enable WAF policy with Default Rule**\nSet 1.0/1.1 on their Front Door deployments, or with OWASP ModSecurity Core Rule Set\n(CRS) versions 3.0/3.1 on Application Gateway V2 to immediately enable protection from\nthis threat, if not already enabled. For customers who have already enabled DRS 1.0/1.1 or\nCRS 3.0/3.1, no action is needed. We will continue to monitor threat patterns and modify the\nabove rule in response to emerging attack patterns as required.\n\n_Figure 24. Remote Code Execution rule for Default Rule Set (DRS) versions 1.0/1.1_\n\n\n-----\n\n_Figure 25. Remote Code Execution rule for OWASP ModSecurity Core Rule Set (CRS)_\n_version 3.1_\n\nNote: The above protection is also available on Default Rule Set (DRS) 2.0 preview version\nand OWASP ModSecurity Core Rule Set (CRS) 3.2 preview version, which are available on\nAzure Front Door Premium and Azure Application Gateway V2 respectively. Customers\nusing Azure CDN Standard from Microsoft can also turn on the above protection by enabling\nDRS 1.0.\n\nMore information about Managed Rules and Default Rule Set (DRS) on Azure Web\n[Application Firewall can be found here. More information about Managed Rules and OWASP](https://docs.microsoft.com/azure/web-application-firewall/afds/waf-front-door-drs)\n[ModSecurity Core Rule Set (CRS) on Azure Web Application Firewall can be found here.](https://docs.microsoft.com/azure/web-application-firewall/ag/application-gateway-crs-rulegroups-rules)\n\n## Indicators of compromise (IOCs)\n\nMicrosoft Threat Intelligence Center (MSTIC) has provided a list of IOCs related to this attack\nand will update them with new indicators as they are\ndiscovered: https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Sample\nData/Feeds/Log4j_IOC_List.csv\n\nMicrosoft will continue to monitor this dynamic situation and will update this blog as new\nthreat intelligence and detections/mitigations become available.\n\n**Revision history**\n\n**_[01/21/2022] –_** _Threat and vulnerability management can now discover vulnerable Log4j_\n_libraries, including Log4j files and other files containing Log4j, packaged into Uber-JAR files._\n\n**_[01/19/2022] New information about an unrelated vulnerability we discovered while_**\n_investigating Log4j attacks_\n\n\n-----\n\n**_[01/11/2022]_** _New threat and vulnerability management capabilities to apply mitigation_\n_directly from the portal, as well as new advanced hunting queries_\n\n**_[01/10/2022] Added new information about a China-based ransomware operator targeting_**\n_internet-facing systems and deploying the NightSky ransomware_\n\n**_[01/07/2022] Added a new rule group in Azure Web Application Firewall (WAF)_**\n\n**_[12/27/2021] New capabilities in threat and vulnerability management including a new_**\n_advanced hunting schema and support for Linux, which requires updating the Microsoft_\n_Defender for Linux client; new Microsoft Defender for Containers solution._\n\n**_[12/22/2021] Added new protections across Microsoft 365 Defender, including Microsoft_**\n_Defender for Office 365._\n\n**_[12/21/2021]_** _Added a note on testing services and assumed benign activity and additional_\n_guidance to use the Need help? button in the_ _Microsoft 365 Defender portal._\n\n**_[12/17/2021] New updates to observed activity, including more information about limited_**\n_ransomware attacks and additional payloads; additional updates to protections from_\n_Microsoft 365 Defender and_ _Azure Web Application Firewall (WAF), and new Microsoft_\n_Sentinel queries._\n\n**_[12/16/2021] New Microsoft Sentinel solution and additional Microsoft Defender for Endpoint_**\n_detections._\n\n**_[12/15/2021] Details about ransomware attacks on non-Microsoft hosted Minecraft servers,_**\n_as well as updates to product guidance, including threat and vulnerability management._\n\n**_[12/14/2021] New insights about multiple threat actors taking advantage of this vulnerability,_**\n_including nation-state actors and_ _access brokers linked to ransomware._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-11 - Guidance for preventing, detecting, and hunting for exploitation of the Log4j 2 vulnerability.pdf"
    ],
    "report_names": [
        "2021-12-11 - Guidance for preventing, detecting, and hunting for exploitation of the Log4j 2 vulnerability.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "81e29474-63ad-4ce8-97db-b1712d5481d5",
            "created_at": "2024-04-24T02:00:49.570158Z",
            "updated_at": "2025-03-27T02:00:55.49842Z",
            "deleted_at": null,
            "main_name": "Cinnamon Tempest",
            "aliases": [
                "Cinnamon Tempest",
                "DEV-0401",
                "Emperor Dragonfly",
                "BRONZE STARLIGHT"
            ],
            "source_name": "MITRE:Cinnamon Tempest",
            "tools": [
                "Pandora",
                "PlugX",
                "Cheerscrypt",
                "Impacket",
                "Cobalt Strike",
                "HUI Loader",
                "Rclone"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04888f75-158b-47f9-8ad9-4ff83f618ece",
            "created_at": "2024-05-01T02:03:08.03763Z",
            "updated_at": "2025-03-27T02:05:17.319276Z",
            "deleted_at": null,
            "main_name": "COBALT MIRAGE",
            "aliases": [
                "Nemesis Kitten ",
                "PHOSPHORUS ",
                "TunnelVision ",
                "UNC2448 ",
                "DEV-0270 "
            ],
            "source_name": "Secureworks:COBALT MIRAGE",
            "tools": [
                " Custom powershell scripts",
                " DiskCryptor",
                " Drokbk",
                " FRPC",
                " Fast Reverse Proxy (FRP)",
                " Impacket wmiexec",
                " Ngrok",
                " Plink",
                " PowerLessCLR",
                " TunnelFish",
                "BitLocker"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "6eabf1ca-1d3a-4c27-893e-c4e0eb58e285",
            "created_at": "2024-06-04T02:03:07.737006Z",
            "updated_at": "2025-03-27T02:05:17.29122Z",
            "deleted_at": null,
            "main_name": "BRONZE STARLIGHT",
            "aliases": [
                "DEV-0401 "
            ],
            "source_name": "Secureworks:BRONZE STARLIGHT",
            "tools": [
                " Cobalt Strike",
                " HUI Loader",
                " LockFile",
                " NightSky",
                " Pandora",
                " PlugX",
                " Rook",
                "AtomSilo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f63c346d-18c8-4821-a56d-fefb1ad7ed5d",
            "created_at": "2022-10-25T16:07:23.42507Z",
            "updated_at": "2025-03-27T02:02:09.793332Z",
            "deleted_at": null,
            "main_name": "Bronze Starlight",
            "aliases": [
                "Cinnamon Tempest",
                "DEV-0401",
                "Operation ChattyGoblin",
                "SLIME34"
            ],
            "source_name": "ETDA:Bronze Starlight",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "AtomSilo",
                "Cobalt Strike",
                "CobaltStrike",
                "Destroy RAT",
                "DestroyRAT",
                "HUI Loader",
                "Kaba",
                "Korplug",
                "LockFile",
                "Night Sky",
                "NightSky",
                "Pandora",
                "PlugX",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c69bcda3-0893-4ea1-9ec1-ae016332d283",
            "created_at": "2023-01-06T13:46:39.410593Z",
            "updated_at": "2025-03-27T02:00:03.081388Z",
            "deleted_at": null,
            "main_name": "BRONZE STARLIGHT",
            "aliases": [
                "DEV-0401",
                "Cinnamon Tempest",
                "Emperor Dragonfly",
                "SLIME34"
            ],
            "source_name": "MISPGALAXY:BRONZE STARLIGHT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536003,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1660793387,
    "ts_modification_date": 1660793387,
    "files": {
        "pdf": "https://archive.orkl.eu/9653e8d6923a322ec9564dcee2cba667a223d370.pdf",
        "text": "https://archive.orkl.eu/9653e8d6923a322ec9564dcee2cba667a223d370.txt",
        "img": "https://archive.orkl.eu/9653e8d6923a322ec9564dcee2cba667a223d370.jpg"
    }
}