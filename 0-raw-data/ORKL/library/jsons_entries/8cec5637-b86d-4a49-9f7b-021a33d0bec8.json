{
    "id": "8cec5637-b86d-4a49-9f7b-021a33d0bec8",
    "created_at": "2023-01-12T15:04:19.786471Z",
    "updated_at": "2025-03-27T02:16:26.390391Z",
    "deleted_at": null,
    "sha1_hash": "92db6be70651d77fa3e3e3b1f06f8abbd623f8b1",
    "title": "2019-08-01 - Cerberus - A New Banking Trojan from the Underworld",
    "authors": "",
    "file_creation_date": "2022-05-28T23:38:46Z",
    "file_modification_date": "2022-05-28T23:38:46Z",
    "file_size": 2171366,
    "plain_text": "# Cerberus - A new banking Trojan from the underworld\n\n**[threatfabric.com/blogs/cerberus-a-new-banking-trojan-from-the-underworld.html](https://www.threatfabric.com/blogs/cerberus-a-new-banking-trojan-from-the-underworld.html)**\n\nAugust 2019\n\n## Intro\n\nIn June 2019, ThreatFabric analysts found a new Android malware, dubbed “Cerberus”, being rented out on\nunderground forums. Its authors claim that it was used for private operations for two years preceding the start of the\nrental. They also state that the code is written from scratch and is not using parts of other existing banking Trojans\nunlike many other Trojans that are either based completely on the source of another Trojan (such as the leaked Anubis\nsource code that is now being resold) or at least borrow parts of other Trojans. After thorough analysis we can confirm\nthat Cerberus was indeed not based on the Anubis source code.\n\nOne peculiar thing about the actor group behind this banking malware is that they have an “official” twitter account that\nthey use to post promotional content (even videos) about the malware. Oddly enough they also use it to make fun of the\nAV community, sharing detection screenshots from VirusTotal (thus leaking IoC) and even engaging in discussions with\nmalware researchers directly.\n\nThe following screenshot shows tweets from their advertisement campaign:\n\n\n-----\n\nThat unusual behavior could be explained by the combination of the need for attention and a probable lack of\nexperience.\n\nWhat is sure is that the gap in the Android banking malware rental business left open after the rental of the Anubis 2\nand RedAlert 2 Trojans ended provides a good opportunity for the actors behind Cerberus to grow their business\nquickly.\n\n## The Android banking Trojan rental business\n\nRental of banking Trojans is not new. It was an existing business model when computer-based banking malware was\nthe only form of banking malware and has shifted to the Android equivalent a few years later.\n\nThe life span of Android banking malware is limited to either the will of its author(s) to support it or the arrest of those\nactors. This malware-life-cycle has been observed to reoccur every few years, bringing new malware families into light.\nEach time a rented malware reaches the end of its life it provides the opportunity for other actors a to take over the\nmalware rental market-share.\n\nAs visible on following chart, the lifespan of many well-known rented Android bankers is usually no more than one or\ntwo years. When the family ceases to exist a new one is already available to fill the void, proving that the demand for\nsuch malware is always present and that therefore Cerberus has a good chance to survive.\n\n\n-----\n\nAfter the actor behind RedAlert 2 decided to quit the rental business, we observed a surge in Anubis samples in the\nwild. After the Anubis actor was allegedly arrested and the source code was leaked there was also huge increase in the\nnumber of Anubis samples found in the wild, but the new actors using Anubis have no support or updates.\n\nDue to this Cerberus will come in handy for actors that want to focus on performing fraud without having to develop and\nmaintain a botnet and C2 infrastructure.\n\n## Analysis of evasion techniques\n\nAlong with the standard payload and string obfuscation, Cerberus uses a rather interesting technique to prevent\nanalysis of the Trojan.\n\nUsing the device accelerometer sensor it implements a simple pedometer that is used to measure movements of the\nvictim. The idea is simple - if the infected device belongs to a real person, sooner or later this person will move around,\nincreasing the step counter. The Trojan uses this counter to activate the bot - if aforementioned step counter hits the\npre-configured threshold it considers running on the device to be safe. This simple measure prevents the Trojan from\nrunning and being analyzed in dynamic analysis environments (sandboxes) and on the test devices of malware\nanalysts.\n\nThe code responsible for this verification is shown in the following snippet:\n\n\n-----\n\n```\nthis.sensorService.registerListener(this, this.accelerometer, 3);\nSensor localSensor = sensorEvent.sensor;\nthis.sensorService.registerListener(this, localSensor, 3);\nif(localSensor.getType() == 1) {\n  float\\[\\] values = sensorEvent.values;\n  float Gx = values\\[0\\];\n  float Gy = values\\[1\\];\n  float Gz = values\\[2\\];\n  long timestamp = System.curTimeMillis();\n  if(timestamp - this.previousTimestamp > 100L) {\n    long interval = timestamp - this.previousTimestamp;\n    this.previousTimestamp = timestamp;\n    if(Math.abs(Gx + Gy + Gz - this.curGx - this.curGy - this.curGz) \n      / (((float)interval)) * 10000f > 600f) {\n      this.increaseStepCount();\n    }\n    this.curGx = Gx;\n    this.curGy = Gy;\n    this.curGz = Gz;\n  }\n}\n...\nif(Integer.parseInt(\n  this.utils.readConfigString(arg7, this.constants.step)) < this.constants.limit) {\n  goto skip;\n}\n\n## How it works\n\n```\nWhen the malware is first started on the device it will begin by hiding its icon from the application drawer. Then it will ask\nfor the accessibility service privilege as visible in the following screenshot:\n\n\n-----\n\nAfter the user grants the requested privilege, Cerberus starts to abuse it by granting itself additional permissions, such\nas permissions needed to send messages and make calls, without requiring any user interaction. It also disables Play\nProtect (Google’s preinstalled antivirus solution) to prevent its discovery and deletion in the future. After conveniently\ngranting itself additional privileges and securing its persistence on the device, Cerberus registers the infected device in\nthe botnet and waits for commands from the C2 server while also being ready to perform overlay attacks.\n\nThe commands supported by the analyzed version of the Cerberus bot are listed below. As can be seen, the\npossibilities offered by the bot are pretty common.\n\n**Command** **Description**\n\npush Shows a push notification. Clicking on thenotification will result in launching a specified app\n\n\n-----\n\n**Command** **Description**\n\nstartApp Starts the specified application\n\ngetInstallApps Gets the list of installedapplications on the infected device\n\ngetContacts Gets the contact names and phone numbers from the addressbook on the infected device\n\ndeleteApplication Triggers the deletion of the specified application\n\nforwardCall Enables call forwarding to the specified number\n\nsendSms Sends a text message with specified text from the infecteddevice to the specified phone number\n\nstartInject Triggers the overlay attack against the specified application\n\nstartUssd Calls the specified USSD code\n\nopenUrl Opens the specified URL in the WebView\n\ngetSMS Gets all text messages from the infected device\n\nkillMe Triggers the kill switch for the bot\n\nupdateModule Updates the payload module\n\n## Cerberus features\n\nCerberus malware has the same capabilities as most other Android banking Trojans such as the use of overlay attacks,\nSMS control and contact list harvesting. The Trojan can also leverage keylogging to broaden the attack scope. Overall,\nCerberus has a pretty common feature list and although the malware seems to have been written from scratch there\ndoes not seem to be any innovative functionality at this time. For example, some of the more advanced banking Trojans\nnow offer features such as a back-connect proxy, screen-streaming and even remote control.\n\nCerberus embeds the following set of features that allows itself to remain under the radar and successfully perform\nattacks:\n\nOverlaying: Dynamic (Local injects obtained from C2)\nKeylogging\nSMS harvesting: SMS listing\nSMS harvesting: SMS forwarding\nDevice info collection\nContact list collection\nApplication listing\nLocation collection\nOverlaying: Targets list update\nSMS: Sending\nCalls: USSD request making\nCalls: Call forwarding\nRemote actions: App installing\nRemote actions: App starting\nRemote actions: App removal\nRemote actions: Showing arbitrary web pages\nRemote actions: Screen-locking\nNotifications: Push notifications\nC2 Resilience: Auxiliary C2 list\nSelf-protection: Hiding the App icon\nSelf-protection: Preventing removal\nSelf-protection: Emulation-detection\n\n\n-----\n\nArchitecture: Modular\n\n## Overlay attack\n\nMost Android banking Trojans use overlay attacks to trick the victim into providing their personal information (such as\nbut not limited to: credit card information, banking credentials, mail credentials) and Cerberus is no exception. In this\nparticular case, the bot abuses the accessibility service privilege to obtain the package name of the foreground\napplication and determine whether or not to show a phishing overlay window, as shown in the following code snippet:\n```\nthis.foregroundAppPackage = accesibilityEvent.getPackageName().toString();\n...\nString target = this.strings.empty;\nif(this.strings.CC_apps.contains(this.foregroundAppPackage)) {\n  target = this.strings.grabbCC;\n}\nelse if(this.strings.MAIL_apps.contains(this.foregroundAppPackage)) {\n  target = this.strings.grabMails;\n}\ntry {\n  Utils utils = this.utils;\n  String v1_10 = target.isEmpty() ? this.foregroundAppPackage : target;\n  if(utils.readConfigString(this, v1_10).length() > 10) {\n    JSONObject config = new JSONObject();\n    config.put(this.strings.params, this.strings.startViewInject);\n    config.put(this.strings.packageAppStart, this.foregroundAppPackage);\n    config.put(this.strings.nameInject, target);\n    config.put(this.strings.packageProject, this.getPackageName());\n    config.put(this.strings.packageView, InjectActivity.class.getCanonicalName(););\n    Utils utils1 = this.utils;\n    utils1.callModule(this, config.toString());\n  }\n}\ncatch(Exception e) {\n  ...\n}\n\n### Targets\n\n```\nSome examples of phishing overlays are shown below. They exist in two types: the credentials stealers (first 2\nscreenshots) and the credit card grabbers (last screenshot).\n\n\n-----\n\nThe only active target list observed in the wild is available in the appendix and contains a total of 30 unique targets.\n\nIt is interesting to observe that the actual target list contains:\n\n7 French banking apps\n7 U.S. banking apps\n1 Japanese banking app\n15 non-banking apps\n\nThis uncommon target list might either be the result of specific customer demand, or due to some actors having partially\nreused an existing target list.\n\n## Conclusion\n\nAlthough not yet mature enough to provide the equivalent of a full-blown set of Android banking malware features (such\nas RAT, RAT with ATS (Automated Transaction Script), back-connect proxy, media streaming), or providing an\nexhaustive target list, Cerberus should not be taken lightly.\n\nDue to the current absence of maintained and supported Android banking Malware-as-a-Service in the underground\ncommunity, there is a certainly demand for a new service. Cerberus is already capable to fulfill this demand. In addition\nto the feature base it already possesses and the money that can be made from the rental, it could evolve to compete\nwith the mightiest Android banking Trojans. Next to the features, we expect the target list to be expanded to contain\nadditional (banking) apps in the near future.\n\nKnowledge of the threat landscape and implementation of the right detection tools remains crucial to be able to protect\nyourself from fraud; Cerberus is yet a new Trojan active in the wild!\n\n## Mobile Threat Intelligence\n\n\n-----\n\nOur threat intelligence solution MTI, provides the context and in depth knowledge of the past and present malware\npowered threats in order to understand the future of the threat landscape. Such intelligence, includes both the strategic\noverview on trends and the operational indicators to discern early signals of upcoming threats and build a future-proof\nsecurity strategy.\n\n## Client Side Detection\n\nOur online fraud detection solution – CSD, presents financial institutions with the real-time overview on the risk status of\ntheir online channels and related devices. This overview provides all the relevant information and context to act upon\nthreats before they turn into fraud. The connectivity with existing risk or fraud engines allows for automated and\norchestrated, round the clock fraud mitigation.\n\n## Appendix\n\n### Samples\n\nSome of the latest Cerberus samples found in the wild:\n\n**App**\n**name** **Package name** **SHA 256 hash**\n\n\nFlash\nPlayer\n\nFlash\nPlayer\n\nFlash\nPlayer\n\nFlash\nPlayer\n\nFlash\nPlayer\n\nFlash\nPlayer\n\n\ncom.uxlgtsvfdc.zipvwntdy 728a6ea44aab94a2d0ebbccbf0c1b4a93fbd9efa8813c19a88d368d6a46b4f4f\n\ncom.ognbsfhszj.hqpquokjdp fe28aba6a942b6713d7142117afdf70f5e731c56eff8956ecdb40cdc28c7c329\n\ncom.mwmnfwt.arhkrgajn ffa5ac3460998e7b9856fc136ebcd112196c3abf24816ccab1fbae11eae4954c\n\ncom.wogdjywtwq.oiofvpzpxyo 6ac7e7ed83b4b57cc4d28f14308d69d062d29a544bbde0856d5697b0fc50cde4\n\ncom.hvdnaiujzwo.fovzeukzywfr cfd77ddc5c1ebb8498c899a68ea75d2616c1c92a0e618113d7c9e5fcc650094b\n\ncom.gzhlubw.pmevdiexmn 3f2ed928789c200e21fd0c2095619a346f75d84f76f1e54a8b3153385850ea63\n\n\n### Target list\n\nThe actual observed list of mobile apps targeted by Cerberus contains a total of 30 unique applications. This list is\nexpected to expand:\n\n**Package name** **Application name**\n\ncom.android.vending Play Market\n\ncom.boursorama.android.clients Boursorama Banque\n\ncom.caisseepargne.android.mobilebanking Banque\n\ncom.chase.sig.android Chase Mobile\n\ncom.clairmail.fth Fifth Third Mobile Banking\n\ncom.connectivityapps.hotmail Connect for Hotmail\n\ncom.google.android.gm Gmail\n\ncom.imo.android.imoim imo free video calls and chat\n\n\n-----\n\n**Package name** **Application name**\n\ncom.infonow.bofa Bank of America Mobile Banking\n\ncom.IngDirectAndroid ING\n\ncom.instagram.android Instagram\n\ncom.konylabs.capitalone Capital One® Mobile\n\ncom.mail.mobile.android.mail mail.com mail\n\ncom.microsoft.office.outlook Microsoft Outlook\n\ncom.snapchat.android Snapchat\n\ncom.tencent.mm WeChat\n\ncom.twitter.android Twitter\n\ncom.ubercab Uber\n\ncom.usaa.mobile.android.usaa USAA Mobile\n\ncom.usbank.mobilebanking U.S. Bank - Inspired by customers\n\ncom.viber.voip Viber\n\ncom.wf.wellsfargomobile Wells Fargo Mobile\n\ncom.whatsapp WhatsApp\n\ncom.yahoo.mobile.client.android.mail Yahoo Mail – Organized Email\n\nfr.banquepopulaire.cyberplus Banque Populaire\n\nfr.creditagricole.androidapp Ma Banque\n\njp.co.rakuten_bank.rakutenbank 楽天銀行 -個人のお客様向けアプリ\n\nmobi.societegenerale.mobile.lappli L’Appli Société Générale\n\nnet.bnpparibas.mescomptes Mes Comptes BNP Paribas\n\norg.telegram.messenger Telegram\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-01 - Cerberus - A New Banking Trojan from the Underworld.pdf"
    ],
    "report_names": [
        "2019-08-01 - Cerberus - A New Banking Trojan from the Underworld.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535859,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653781126,
    "ts_modification_date": 1653781126,
    "files": {
        "pdf": "https://archive.orkl.eu/92db6be70651d77fa3e3e3b1f06f8abbd623f8b1.pdf",
        "text": "https://archive.orkl.eu/92db6be70651d77fa3e3e3b1f06f8abbd623f8b1.txt",
        "img": "https://archive.orkl.eu/92db6be70651d77fa3e3e3b1f06f8abbd623f8b1.jpg"
    }
}