{
    "id": "c56abcbe-1149-4717-a442-b38e941c537a",
    "created_at": "2023-01-12T15:00:28.849342Z",
    "updated_at": "2025-03-27T02:05:58.775939Z",
    "deleted_at": null,
    "sha1_hash": "aa5c598c9505785390671a5d581b6fb7168958c2",
    "title": "2014-04-27 - Analysis of the Predator Pain Keylogger",
    "authors": "",
    "file_creation_date": "2022-05-28T03:55:32Z",
    "file_modification_date": "2022-05-28T03:55:32Z",
    "file_size": 1298214,
    "plain_text": "# Stop Malvertising\n\n**[stopmalvertising.com/malware-reports/analysis-of-the-predator-pain-keylogger.html](http://stopmalvertising.com/malware-reports/analysis-of-the-predator-pain-keylogger.html)**\n\nAnalysis of the Predator Pain Keylogger\n\n[Written by Kimberly on Sunday, 27 April 2014. Posted in Malware Reports Viewed 11403](https://stopmalvertising.com/malware-reports/)\ntimes\n\nThe Predator Pain Keylogger incorporates Browser, Messenger, FTP and File stealers\nand is able of Clipboard and Screenhot logging, Bitcoin Wallet theft.\n\nPredator Pain targets Steam, MineCraft and World of WarCraft usernames and\npasswords. A Runescape Pin Stealer is also available.\n\nPredator Pain can disable several Windows features and spread via USB or P2P.\n**KazyLoader, also known as Karagany, is used as the file downloader in this sample.**\n\nThe Predator Pain Keylogger is advertised for 35$ on underground forums and comes with\nits own crypter.\n\n[Predator Pain is the payload of an unsolicited email from the IRS with the subject line](http://techhelplist.com/index.php/spam-list/549-swift-transfer-confirmation-google-docs-malware)\n\"Swift Transfer Confirmation\". No money at the horizon in this fake email but a swift\ntransfer of all logins and passwords the Predator Pain Keylogger can possibly grab.\n\n**Predator Pain Keylogger**\n\nUpon execution SWIFTTRANSFERRECEPTS_FDP.EXE will display an error message\nstating that the application failed to initialize properly. The warning is a fake error\n**message and part of the Predator Pain builder options.**\n\n\n-----\n\nIn meanwhile SWIFTTRANSFERRECEPTS_FDP.EXE will create a copy of itself as\nWINLOGON.EXE in the %AppData%\\Roaming folder and start the newly created process.\nWINLOGON.EXE will also create a global Low Level Keyboard hook and display the same\nfake error as above.\n\nWINLOGON.EXE creates the following files in the %AppData%\\Roaming folder:\n\n**pid.txt: contains the PID of the Predator Pain Keylogger process - e.g. 1628**\n**pidloc.txt: contains the path to the Predator Pain logger executable - e.g.**\n%AppData%\\Roaming\\winlogon.exe\n\n\n-----\n\nPredator Pain will also create a copy of itself as WINDOWSUPDATE.EXE in the\n%AppData%\\Roaming folder. Predator Pain checks periodically for the existence of\nWindowsUpdate.exe. If the file is deleted a new copy is written to the HDD.\n\nThe following registry keys are created to ensure persistence:\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run \"Windows\nUpdate\"\nType: REG_SZ\nData: C:\\Users\\MxAngel\\AppData\\Roaming\\WindowsUpdate.exe\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\n\"Shell\"\nType: REG_SZ\nData: explorer.exe, C:\\Users\\MxAngel\\AppData\\Roaming\\winlogon.exe\n\nBefore we go any further there are a few things that need clarification. When the Predator\nPain binary - winlogon.exe in our analysis - is running, we can dump the strings contained\nin the different memory regions. The list is quite huge but for now we will focus on the\nthree following elements:\n\n**WebBrowserPassView: WebBrowserPassView.exe**\n**Mail PassView: mailpv.exe**\n**CMemoryExecute: CMemoryExecute.dll**\n\nWebBrowserPassView\n\n[WebBrowserPassView, developed by Nir Sofer, is a tool to recover lost passwords stored](http://www.nirsoft.net/utils/web_browser_password.html)\nin your web browser.\n\nWebBrowserPassView supports Internet Explorer,Mozilla, Google Chrome, Safari, and\nOpera and can be used to recover lost / forgotten passwords of any website, including\nFacebook, Yahoo, Google, and GMail, as long as the password is stored by the browser.\nThe passwords can be saved to text / html / csv / xml files.\n\nMail PassView\n\n[Mail PassView, developed by Nir Sofer, allows extracting lost email passwords from the](http://www.nirsoft.net/utils/mailpv.html)\nfollowing email clients:\n\nOutlook Express\nMicrosoft Outlook 2000 (POP3 and SMTP Accounts only)\nMicrosoft Outlook 2002/2003/2007/2010/2013 (POP3, IMAP, HTTP and SMTP\nAccounts)\nWindows Mail\nWindows Live Mail\nIncrediMail\nEudora\n\n\n-----\n\nNetscape 6.x/7.x (If the password is not encrypted with master password)\nMozilla Thunderbird (If the password is not encrypted with master password)\nGroup Mail Free\nYahoo! Mail - If the password is saved in Yahoo! Messenger application.\nHotmail/MSN mail - If the password is saved in MSN/Windows/Live Messenger\napplication.\nGmail - If the password is saved by Gmail Notifier application, Google Desktop, or by\nGoogle Talk.\n\nCMemoryExecute - CMemoryExecute.dll\n\nCMemoryExecute, written by Affixiate, is used to run a non .NET executable from\nmemory without storing it on the hard-disk first. It uses the native WinAPI and the\nexecutable needs to be injected in VBC.EXE, the Visual Basic Command Line Compiler.\n\nThe syntax is as follows:\n```\nCMemoryExecute.Run(IO.File.ReadAllBytes(\"C:\\run_me_in_memory.exe\"),\n\"C:\\inject_me_in_memory.exe\", \"(Optional) Command Line Parameters To Be Passed To\nC:\\run_me_in_memory.exe\")\n\n```\nPredator Pain is thus able to harvest logins and passwords from several mail and browser\nclients with the help of two incorporated legit programs: WebBrowserPassView and Mail\nPassView.\n\nPredator Pain will start up VBC.EXE, the Visual Basic Command Line Compiler, which is\none of the requirements to run a PE from memory.\n\nThe Predator Pain Keylogger will:\n\n\n-----\n\nRun MAILPV.EXE from memory via VBC.EXE and dump the results to\nHOLDERMAIL.TXT.\nWINLOGON.EXE checks if HOLDERMAIL.TXT exists.\nWINLOGON.EXE reads HOLDERMAIL.TXT and uploads the harvested email\ncredentials via mail - to This e-mail address is being protected from spambots. You\nneed JavaScript enabled to view it in our analysis.\n\nThe same tasks will be performed using WEBBROWSERPASSVIEW.EXE & VBC.EXE to\nharvest stored passwords in browsers.\n\n\n-----\n\nBelow is a screenshot illustrating the flow of processes and services started by Predator\nPain. The Protected Storage and Credential Manager services are started by the injected\nVBC.EXE process.\n\n\n-----\n\nBesides harvesting various logins and passwords, Predator Pain reports the local Date\nand Time, the OS and the OS language, the internal and external IP address, installed\nantivirus and / or firewall. The external IP is obtained by querying whatismyipaddress.com.\n\nIn this sample all harvested information is send to This e-mail address is being protected\nfrom spambots. You need JavaScript enabled to view it . The interval and the chosen\nmethod (FTP / PHP / MAIL) can be set in the Predator Pain builder’s options.\n\nPredator Pain is also a Bitcoin Stealer. It steals the WALLET.DAT file that holds the users\nbitcoin currency.\n\nAfter a while the WINLOGON.EXE process stopped working. It’s hard to tell whether this is\non purpose or simply because the logger is unstable.\n\n\n-----\n\nWhen the WINLOGON.EXE process runs, the code in memory is unencrypted and its\nstrings can be dumped from the different memory regions. I've posted a small snippet on\nour [Pastebin.](http://pastebin.com/RBt3M3hq)\n\n**VirusTotal Results**\n\n\n-----\n\nswifttransferrecepts_fdp.exe\n\n**Additional information**\n\n**MD5: 8ce71e40eda2d9304c1e127c60500e0c**\n\n**SHA1: 93ef97529dcaa047d023456103827b6f97345caf**\n\n**SHA256: e63b24adf9119f7d500167a62d62d3b8a35f4694f8488fc764523fd322fb2dce**\n\n**File size: 612.0 KB ( 626688 bytes )**\n\n**Detection ratio: 16 / 51**\n\n**Analysis date: 2014-04-26 08:52:43 UTC**\n\n**Antivirus** **Result** **Update**\n\nAd-Aware Gen:Variant.Zusy.69824 20140426\n\nAegisLab 20140426\n\nAgnitum 20140425\n\nAhnLab-V3 Trojan/Win32.Inject 20140425\n\nAntiVir 20140425\n\nAntiy-AVL 20140426\n\nAvast Win32:VB-AHWF [Trj] 20140426\n\nAVG 20140426\n\nBaidu-International 20140426\n\nBitDefender Gen:Variant.Zusy.69824 20140426\n\nBkav 20140425\n\nByteHero 20140426\n\nCAT-QuickHeal 20140425\n\n\n-----\n\nClamAV 20140426\n\nCMC 20140424\n\nCommtouch 20140426\n\nComodo 20140426\n\nDrWeb 20140426\n\nEmsisoft Gen:Variant.Zusy.69824 (B) 20140426\n\nESET-NOD32 a variant of MSIL/Injector.CUZ 20140426\n\nF-Prot 20140426\n\nF-Secure Gen:Variant.Zusy.69824 20140426\n\nFortinet MSIL/Injector.CSZ!tr 20140426\n\nGData Gen:Variant.Zusy.69824 20140426\n\nIkarus 20140426\n\nJiangmin 20140426\n\nK7AntiVirus 20140425\n\nK7GW 20140425\n\nKaspersky Trojan.Win32.Fsysna.zcf 20140426\n\nKingsoft 20140426\n\nMalwarebytes Spyware.Zbot 20140426\n\nMcAfee Artemis!8CE71E40EDA2 20140426\n\nMcAfee-GW-Edition Heuristic.LooksLike.Win32.Suspicious.E 20140425\n\nMicrosoft 20140426\n\nMicroWorld-eScan Gen:Variant.Zusy.69824 20140426\n\nNANO-Antivirus 20140426\n\nNorman 20140426\n\nnProtect 20140425\n\nPanda 20140425\n\n\n-----\n\nQihoo-360 Win32/Trojan.53c 20140426\n\nRising 20140425\n\nSophos 20140426\n\nSUPERAntiSpyware 20140426\n\nSymantec 20140426\n\nTheHacker 20140425\n\nTotalDefense 20140426\n\nTrendMicro 20140426\n\nTrendMicro-HouseCall TROJ_GEN.F47V0425 20140426\n\nVBA32 20140425\n\nVIPRE 20140425\n\nViRobot 20140426\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-04-27 - Analysis of the Predator Pain Keylogger.pdf"
    ],
    "report_names": [
        "2014-04-27 - Analysis of the Predator Pain Keylogger.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535628,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1653710132,
    "ts_modification_date": 1653710132,
    "files": {
        "pdf": "https://archive.orkl.eu/aa5c598c9505785390671a5d581b6fb7168958c2.pdf",
        "text": "https://archive.orkl.eu/aa5c598c9505785390671a5d581b6fb7168958c2.txt",
        "img": "https://archive.orkl.eu/aa5c598c9505785390671a5d581b6fb7168958c2.jpg"
    }
}