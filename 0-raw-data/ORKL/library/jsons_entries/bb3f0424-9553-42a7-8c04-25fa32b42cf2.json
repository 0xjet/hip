{
    "id": "bb3f0424-9553-42a7-8c04-25fa32b42cf2",
    "created_at": "2023-01-12T15:04:44.974163Z",
    "updated_at": "2025-03-27T02:16:26.424012Z",
    "deleted_at": null,
    "sha1_hash": "765b4e6bc99d021393321b7933a38976623553e7",
    "title": "2021-05-05 - Joker",
    "authors": "",
    "file_creation_date": "2022-05-28T18:59:28Z",
    "file_modification_date": "2022-05-28T18:59:28Z",
    "file_size": 1226868,
    "plain_text": "# No Joking Around with JOKER\n\n**labs.k7computing.com/**\n\nBy Baran S May 5, 2021\n\nThe Joker malware family has been consistently targeting Android users since it was discovered in 2017 and is\none of the most active malware families on the Google Play Store. It continues to find new tricks and tactics to\nstay undetected by doing small changes in its code or changing the payload download techniques.\n\nThe family name “Joker” was derived from the Command and Control (C2) domain name it used in its early days.\nThis malware attempts to steal SMS messages, contacts from the victim’s device and silently signs up its victims\nto the premium services without their knowledge.\n\nAt K7 Labs, we recently noticed a new Joker malware sample on Google Play Store, which utilizes Android\npackers like “Tencent’s Legu” and “ijiami” packers to evade detection.\n\n\n-----\n\nFigure 1: Malicious Joker\n\nApps from Google Play Store Protected with Packer\nIn this blog, we will be analyzing the sample kindledev.nap.ksms which uses Tencent’s Legu Packer to hide its\nmalicious payload functionality as shown in Figure 2.\n\nFigure 2: APK Protected with Tencent’s Legu Packer\n\n\n-----\n\n### Technical Analysis\n\nOnce launched, at runtime it unpacks the malicious Android Package (APK) and contacts the C2 server to\ndownload a malicious Dalvik Executable (DEX) file payload as shown in Figure 3, which enables the malware and\nadds other capabilities.\n\nFigure 3: Malicious Payload from C2 Server\nThis malicious payload continuously sends POST requests to hxxp[:]//161[.]117[.]46[.]64/svhyqj/mjcxzy for\ncommunication as shown in Figure 4.\n\nFigure 4: Encrypted Data sent to C2 in POST\nThis Joker Trojan attempts to intercept SMS messages notifications as shown in Figure 5.\n\n\n-----\n\nFigure 5: Intercept SMS Messages\nThis Trojan also silently signs up the victim for the WAP (Wireless Application Protocol) fraud as shown in Figure\n6.\n\nFigure 6: WAP Fraud by Joker Trojan\n\n### Mitigations\n\n\n-----\n\nUse the official App Store to download the apps\nCarefully read the user reviews before installing the apps\nEnsure you protect your device and data by using a reputable security product like K7 Mobile Security and\n**keeping it up-to-date, to scan all the downloaded apps, irrespective of the source**\n\n## Indicators Of Compromise (IOCs)\n\n\n**Infected Package Name on Google Play**\n**Store**\n\n\n**Hash** **Packer** **Detection**\n**Name**\n\n\ncom.upinklook.kunicam 4a0d873780a7132d1e2b407d9c5db801 ijiami Trojan (\n0057931a1\n)\n\ncom.keykeybor.borprem.forpiknovonlines dab94a0370d933a12f1bba217e9b29ad ijiami Trojan (\n0001140e1\n)\n\n\nkindledev.nap.ksms 8e6ef3afeac8aaf94191fa95121244a9 Tencent’s\nLegu\n\ncom.beautifulnature.freshwallpapers 18a9aa9d52d78c2b87ac0b2332e46b03 Tencent’s\nLegu\n\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\n\ncom.camerasideas.collagemaker f36aa54257bb4ca184db537293415a4a ijiami Trojan (\n0057931a1\n)\n\n\ncc.lask.as b3a7042186cb7957726b468bc1024d6b Tencent’s\nLegu\n\ninksms.beatmessages.messaging ac2f1708ba265b2152aed0c43b7be2ea Tencent’s\nLegu\n\ncom.translate2021.forall.language bf84acfcd727c8aead7f81d73fc41082 Tencent’s\nLegu\n\ncom.multicamera.coolwending.translator fccf657d5e61d53ceff6943e7263f8d3 Tencent’s\nLegu\n\ncom.alltxt.translate.photo.convert 8668549e97b60bfccfb4082f2bb9fc62 Tencent’s\nLegu\n\ncom.sophisticated.gifmakermax c5eb32e4ff466702fd95429b8a367686 Tencent’s\nLegu\n\neverysearch.artifact f9b089e22514f1824a0e0c0bee4248ce Tencent’s\nLegu\n\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\n\ncom.kong.toouch.ass.iphoea 0f9f4d088a69659a4791ef5d883c0487 ijiami Trojan (\n0057931a1\n)\n\n\n-----\n\nlivepictures.livebackground.lightningwallpaper 652d67cfb68278306e22545c551ac64d Tencent’s\nLegu\n\ncom.camscanner.docscanner.multidocscanner 8cb23726b1438e734ba3708995ae36c2 Tencent’s\nLegu\n\ncplus.mirzatext.translateapp 33b6a1a6d1d31a63c33666ba6a8be8d3 Tencent’s\nLegu\n\ncom.freecollger.make.photocollage f53560912c64f236bbd71995204b4962 Tencent’s\nLegu\n\ncom.wandaretech.flashinterpreter d595f2c5b39728269a531bd018740484 Tencent’s\nLegu\n\n**Payload URLs**\n\nmul4[.oss-ap-southeast-5.aliyuncs[.com\n\nhwayt[.oss-us-east-1.aliyuncs[.com\n\nwansgo[.oss-ap-southeast-5.aliyuncs[.com\n\nselct[.oss-ap-southeast-2.aliyuncs[.com\n\nscanlucky[.oss-us-east-1.aliyuncs[.com\n\nbanca[.oss-us-east-1.aliyuncs[.com\n\nbiggerone[.oss-us-east-1.aliyuncs[.com\n\nlucky-bird[.oss-me-east-1.aliyuncs[.com\n\nlinchen-bucket[.oss-us-east-1.aliyuncs[.com\n\nbreezea[.oss-us-east-1.aliyuncs[.com\n\nfronta[.oss-us-west-1.aliyuncs[.com\n\nwarriorss[.oss-us-west-1.aliyuncs[.com\n\n**Final C2 Servers**\n\n161[.117.226.98\n\n161[.117.250.158\n\n161[.117.62.127\n\n161[.117.46.64\n\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n0001140e1\n)\n\nTrojan (\n00579d201\n)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-05 - Joker.pdf"
    ],
    "report_names": [
        "2021-05-05 - Joker.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535884,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653764368,
    "ts_modification_date": 1653764368,
    "files": {
        "pdf": "https://archive.orkl.eu/765b4e6bc99d021393321b7933a38976623553e7.pdf",
        "text": "https://archive.orkl.eu/765b4e6bc99d021393321b7933a38976623553e7.txt",
        "img": "https://archive.orkl.eu/765b4e6bc99d021393321b7933a38976623553e7.jpg"
    }
}