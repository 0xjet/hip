{
    "id": "55d6ecec-e643-4f72-a412-63425d6402d1",
    "created_at": "2023-01-12T15:04:48.51701Z",
    "updated_at": "2025-03-27T02:05:56.957159Z",
    "deleted_at": null,
    "sha1_hash": "518b1abdafa23395ec223555fa9a9a7f436d57c4",
    "title": "2020-11-16 - Massive threat campaign strikes open-source repos, Sonatype spots new CursedGrabber malware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:27:38Z",
    "file_modification_date": "2022-05-28T19:27:38Z",
    "file_size": 1554285,
    "plain_text": "# Massive threat campaign strikes open-source repos, Sonatype spots new CursedGrabber malware\n\n**blog.sonatype.com/npm-malware-xpc.js**\n\nSonatype has discovered more malware in the npm registry which, following our analysis and multiple cyber threat intelligence reports, has led\nto the discovery of a novel and large scale malware campaign leveraging the open-source ecosystem.\n\nThe malware called “xpc.js” was spotted on Friday by our Nexus Intelligence research service which includes next generation machine\nlearning algorithms that automatically detect potentially malicious activity associated with open source ecosystems.\n\nThis follows on the heels of last week's news when Sonatype’s Nexus Intelligence engine and it’s release integrity algorithm discovered\n[discord.dll: the successor to “fallguys” malware and 3 other components. Since launching Release Integrity out of beta on Oct. 7 this year, our](https://blog.sonatype.com/discord.dll-successor-to-npm-fallguys-)\nNexus Intelligence service has discovered five malicious components.\n\nIt is worth noting xpc.js was published to npm by the same author _[luminate_ aka](https://www.npmjs.com/~luminate_)_ [Luminate-D who is also behind additional malware](https://github.com/Luminate-D)\ndiscovered last week: discord.dll, discord.app, wsbd.js, and ac-addon.\n\nSonatype’s deep dive research analysis has concluded both “xpc.js” and malicious components identified last week are part of a newly\nidentified family of Discord malware called CursedGrabber.\n\n\n-----\n\n## What is xpc.js and what does it do?\n\n[xpc.js is not a JavaScript file but the name of the malicious npm component itself.](https://www.npmjs.com/package/xpc.js)\n\n[The component exists as a tar.gz (tgz) archive with just one version 6.6.6 (likely a pun) and was published to npm registry around November](https://en.wikipedia.org/wiki/Number_of_the_beast)\n11, 2020.\n\nxpc.js has scored just under a 100 downloads as Sonatype discovered it almost immediately after the author published it.\nThe NodeJS files it includes have a very similar structure to malware reported by Sonatype last week: discord.app, wsbd.js and ac-addon.\n\nSonatype security researcher Sebastián Castro who analyzed xpc.js explains:\n\n“The malware targets Windows hosts. It contains two EXE files which are invoked and executed via ‘postinstall’ scripts from the manifest file,\n‘package.json’.”\n\n**The manifest file package.json contained within “xpc.js”**\n\nThe npm component’s manifest file launches lib.js which has just two lines of code, shown below. This is where the EXEs that Castro refers to\nare invoked.\n\nrequire('child_process').exec('lib.exe');\n\nrequire('child_process').exec('lib2.exe');\n\nThe “lib.exe” and “lib2.exe” bundled within the “xpc.js” package itself are Discord information stealing malware written in C# and compressed\ntogether with [Fody-Costura.](https://github.com/Fody/Costura)\n\n“These two PE32 files were forged with Fody-Costura,” states Castro.\n\nBoth executables have references to, or rather assert they are based on “CursedGrabber” information stealing Discord malware.\n\n**Lib.exe**\n\n[Much like other Discord malware, lib.exe reads roaming user profiles from multiple web browsers along with Discord leveldb files, steals](https://blog.sonatype.com/discord.dll-successor-to-npm-fallguys-)\nDiscord Tokens, and sends user data via a webhook to the attacker.\n\nIt is worth noting, at the time of writing the webhook used by lib.exe is still active and a potential Indicator of Compromise (IOC) to watch\nout for:\n\nhttps://discordapp[.]com/api/webhooks/769943162193707098/jacVRUcz9zBrsstbdIzhzGoRCvfbz3J9BOk8bV5UA_DpUKMtEW3KULQA2q2m\n\nImage: Discord webhook used by lib.exe still up and running\n\n“lib.exe” was also caught mapping user’s payment card details and billing information, in addition to other sensitive data.\n\n\n-----\n\nLib.exe retrieving payment information in addition to Discord tokens and web browser files\n\nIn our tests, we noticed lib.exe was stealthy. For example, in certain VM environments it would not perform its malicious activities until after a\nfew minutes had elapsed, to evade analysis by bots and researchers alike.\n\n**lib2.exe is a dropper that downloads yet another file, a malicious ZIP archive whose name/location is provided by a hardcoded webhook.**\n\nOnce again, the Discord webhook is up and running at the time of writing:\n\nhttps://discord[.]com/api/webhooks/770716126988599316/o7GXYebuPQzx7RQFUD4cTOPMq2gGicypOMyNpFVQsIb9qyVW2bgZ4MMT6c7\n\nThe archive “lib2.exe” downloads and unzips a Discord attachment called: bundle-5.0.5.zip.\n\nThis archive contains 34 DLLs, and 2 EXEs.\n\nThe EXEs are launched automatically by lib2.exe itself as shown by the process tree below. These include “osloader.exe” and\n“winresume.exe”\n\n**lib2.exe is a dropper which downloads and unzips an archive and further spins up osloader.exe and eventually winresume.exe**\n\n[The winresume binary is a tainted version of the legitimate winresume.exe application that helps Windows computers resume after periods of](https://www.fileinspect.com/fileinfo/winresume-exe/)\nhibernation. Again, this is part of malware’s evasive tactics to forge legitimate binaries with malicious code.\n\nHere’s how the malware execution sequence would appear to a Windows user:\n\nThe “Windows NT is not supported” message shown in the screenshot, however, is a false error thrown by the malware in an attempt to fool\nboth antivirus products and the end-user.\n\n\n-----\n\ne a a e d opped by b e e co ta s ad a ced, u t p e capab t es, suc as, p ege esca at o, ey ogg g, ta g sc ee s ots,\nplanting backdoors, accessing webcam, etc.,” explains Castro.\n\nWe also noticed the backdoor spun up by the CursedGrabber malware had a REST API running on port 20202 on an infected machine for\neasy command-and-control (C2) access:\n\n## Low detection rate\n\nA worrisome finding is some crucial binaries contained in this malware have a low detection rate:\n\n[For example, osloader.exe that fires up a bunch of malicious processes had such a low detection rate on VirusTotal that just about 2%](https://www.virustotal.com/gui/file/5ac15e584b3a530a9aa62ea0e490b3dc14357155bebe7e5b71b3f680f2117e3c/detection)\n**antivirus engines today would be able to spot it:**\n\n[Likewise, Backdoor.dll and](https://www.virustotal.com/gui/file/3b2605312429165bde5a1423afb932e89deb0c218c8b5adf6b005b7efad1c138/detection) [BackdoorApi.dll binaries tainted with CursedGrabber have zero or low detection rates too.](https://www.virustotal.com/gui/file/21cefa7debf535cf389c5f150428f2b40be7222706896df17a9d529b76b79b1a/detection)\n\nAll Discord malware identified thus far, both by Sonatype and external members of the security community execute nearly the same tasks:\nsteal Discord tokens and sensitive user data.\n\nAnd yet, there are differences in virtually every single Discord malware sample—including samples created by the same author to perform\nidentical tasks.\n\n[For example, the npm author ~luminate_ who had published discord.app, wsbd.js, ac-addon, and finally this xpc.js has made each of these](https://www.npmjs.com/~luminate_)\npackages drop a different CursedGrabber strand.\n\nThe dropped binaries perform nearly identical tasks—some to a greater degree than others, but the differences between them seem\nintentional, to make detection harder.\n\n## More Discord malware to strike open-source ecosystem\n\nThe timing of Sonatype’s discovery of npm malware last week, including the latest xpc.js npm component of the CursedGrabber malware\n[family roughly coincides with Netskope’s discovery of TroubleGrabber Discord malware family which spreads via GitHub.](https://www.bleepingcomputer.com/news/security/new-troublegrabber-discord-malware-steals-passwords-system-info/)\n\nTroubleGrabber, which leverages GitHub to spread, is based off of yet another C# Discord malware AnarchyGrabber. It comprises around\n[2,000 file hashes and over 700 Discord addresses, making detection increasingly challenging by the day.](https://github.com/netskopeoss/NetskopeThreatLabsIOCs/blob/main/TroubleGrabber/TroubleGrabber_hashes.txt)\n\n\n-----\n\nou ece t state o t e so t a e supp y c a epo t, e docu e ted a 30% c ease [a c ous code](https://www.sonatype.com/2020ssc) ject o t OSS p ojects o\nnext-gen software supply chain attacks, and this isn’t the first time we have seen attacks including counterfeit components.\n\nDiscovery of yet another family of counterfeit components, especially after “Discord.dll” malware had already made headlines, speaks to the\ndamage that is possible to your software supply chain if adequate protections are not in place.\n\nSonatype is tracking CursedGrabber malware including npm’s xpc.js as Sonatype-2020-1096, Sonatype-2020-1097, and Sonatype-20201109.\n\nMore Sonatype identifiers may be assigned as more samples in the wild are identified.\n\n**Timeline:**\n\nSonatype’s timeline related to the malicious package’s discovery and reporting is as follows:\n\n1. November 9th, 2020: Suspicious package `wsbd.js` is picked up by our automated malware detection system. While manually analyzing\n\nthe package, 3 other packages that seem suspicious are revealed lurking in ~luminate_’s npm portfolio.\n\nAlthough suspicious components can be automatically quarantined, our Security Research team immediately adds the packages to our\ndata assigning them identifiers: sonatype-2020-1096, sonatype-2020-1097.\n\n2. November 9th, 2020: npm team is notified the same day of malicious packages, and public disclosure is made via blog post. Npm team\n\nshortly removes all 4 malicious packages.\n\n3. November 11th-12th, 2020: Roughly 2 days later, ~luminate_ publishes “xpc.js”\n\n4. November 13th, 2020: This new “xpc.js” malware is yet again picked up by our automated malware detection system. It is entered into\n\nour data as Sonatype-2020-1109 and the npm team is simultaneously identified. Malware is taken down by npm within a few hours of our\nreport.\n5. November 16th, 2020: Full public disclosure on CursedGrabber\n\nBased on the visibility we have, no Sonatype customers have downloaded “xpc.js” and our customers remain protected against counterfeit\ncomponents like CursedGrabber.\n\nSonatype’s world-class open source intelligence, which includes our automated malware detection technology, safeguards your developers,\ncustomers, and software supply chains from infections like these.\n\n[If you're not a Sonatype customer and want to find out if your code is vulnerable, you can use Sonatype's free Nexus Vulnerability Scanner to](https://www.sonatype.com/appscan)\nfind out quickly.\n\nVisit the [Nexus Intelligence Insights page for a deep dive into other vulnerabilities like this one or subscribe to automatically receive Nexus](https://www.sonatype.com/nexus-intelligence-insights)\nIntelligence Insights hot off the press.\n\n**Indicators of Compromise (IOCs):**\n\nThis is not an exhaustive list of IOCs. Other CursedGrabber variants are believed to exist in the wild.\n\n**URLs and IPs:**\n\n46.185.116.2\n\nhttps://discordapp[.]com/api/webhooks/769943162193707098/jacVRUcz9zBrsstbdIzhzGoRCvfbz3J9BOk8bV5UA_DpUKMtEW3KULQA2q2mBMqj\n\nhttps://discord[.]com/api/webhooks/770716126988599316/o7GXYebuPQzx7RQFUD4cTOPMq2gGicypOMyNpFVQsIb9qyVW2bgZ4MMT6c7jvGED\nhttps://cdn.discordapp[.]com/attachments/761673865285337119/776740716524601374/bundle-5.0.5.zip\n\n**Hashes:**\n\n5ac15e584b3a530a9aa62ea0e490b3dc14357155bebe7e5b71b3f680f2117e3c\n927d94157e4460a249adb482357abc5c7bcd98cf27b091af6886761b76d25b70\n\n3b2605312429165bde5a1423afb932e89deb0c218c8b5adf6b005b7efad1c138\n\ncd900739cfb6ca1f9945cffbb892681f14f68325b1a0169062c8b412a2a316c7\n\n89fef995339abb188a5a84ba8078c0f9e9927d14fb99c1bb93493442365055cf\n\n\n-----\n\nacb0e5d6c6 c38e5d59b 9 59 3 0 0 c0e8dd abedba6 a a 096 a 9d6e0\n\na0f8aec40f1d7cd0820b83b430890dcb922cc24c117bd9af3fa7d884194286aa\n\n11721669feb37886b20e215032ee73de844b78105d41d5922a69cd65df1df260\n\n1bfea7d6440b3e77e328076821d77e4a7b5daf1b50194e35bd279f0282623641\n\n3ecaea3ac9b31ea28fefc61c8d8a04d665287c1d16a3bef05fcf9d765090fb65\n\nTags: [vulnerabilities,](https://blog.sonatype.com/topic/vulnerabilities) [featured,](https://blog.sonatype.com/topic/featured) [Nexus Intelligence Insights](https://blog.sonatype.com/topic/nexus-intelligence-insights)\n\n### Written by Ax Sharma\n\nAx is a Security Researcher at Sonatype and Engineer who holds a passion for perpetual learning. His works and expert analyses have\nfrequently been featured by leading media outlets. Ax's expertise lies in security vulnerability research, reverse engineering, and software\ndevelopment. In his spare time, he loves exploiting vulnerabilities ethically and educating a wide range of audiences.\n\nFollow me on:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-16 - Massive threat campaign strikes open-source repos, Sonatype spots new CursedGrabber malware.pdf"
    ],
    "report_names": [
        "2020-11-16 - Massive threat campaign strikes open-source repos, Sonatype spots new CursedGrabber malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535888,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1653766058,
    "ts_modification_date": 1653766058,
    "files": {
        "pdf": "https://archive.orkl.eu/518b1abdafa23395ec223555fa9a9a7f436d57c4.pdf",
        "text": "https://archive.orkl.eu/518b1abdafa23395ec223555fa9a9a7f436d57c4.txt",
        "img": "https://archive.orkl.eu/518b1abdafa23395ec223555fa9a9a7f436d57c4.jpg"
    }
}