{
    "id": "c13111cb-6908-4353-9fd7-35879a25b8cf",
    "created_at": "2023-01-12T15:02:54.652678Z",
    "updated_at": "2025-03-27T02:05:28.934676Z",
    "deleted_at": null,
    "sha1_hash": "055e283442ea5afb67b06e60850816a484c406de",
    "title": "2022-06-17 - BRATA is evolving into an Advanced Persistent Threat",
    "authors": "",
    "file_creation_date": "2022-07-02T23:14:09Z",
    "file_modification_date": "2022-07-02T23:14:09Z",
    "file_size": 9426571,
    "plain_text": "# BRATA is evolving into an Advanced Persistent Threat\n\n**[cleafy.com/cleafy-labs/brata-is-evolving-into-an-advanced-persistent-threat](https://www.cleafy.com/cleafy-labs/brata-is-evolving-into-an-advanced-persistent-threat)**\n\nFrancesco Iubatti, Alessandro Strino\n\n## Download your PDF guide to TeaBot \n\nGet your free copy to your inbox now\n\nDownload PDF Version\n\n## Introduction\n\nHere we go with another episode about our (not so) old friend, BRATA. In almost one year,\nthreat actors (TAs) have further improved the capabilities of this malware. In our previous\n[blog post [1] we defined three main BRATA variants, which appeared during two different](https://www.cleafy.com/labs)\nwaves detected by our telemetries at the very end of 2021. However, during the last months\nwe have observed a change in the attack pattern commonly used.\n\nIn fact, the modus operandi now fits into an Advanced Persistent Threat (APT) activity\npattern. This term is used to describe an attack campaign in which criminals establish a longterm presence on a targeted network to steal sensitive information.\n\nThreat Actors behind BRATA, now target a specific financial institution at a time, and change\ntheir focus only once the targeted victim starts to implement consistent countermeasures\nagainst them. Then, they move away from the spotlight, to come out with a different target\n\n\n-----\n\nand strategies of infections. At first glance, it seems to be a good strategy with a relevant pay\noff. However, it’s important to point out also the struggles and the plan needed to apply this\npattern.\n\nAs we highlighted through our metrics, when a new release comes out there are also new\nfeatures that make it more dangerous. During the last months, a new BRATA.A variant has\nbeen spotted in EU territory posing as specific bank applications, including some internal\nchanges, such as:\n\nA new phishing technique that is in charge of mimicking a login page of the targeted\nbank;\nBrand new classes in charge to acquire GPS, overlay, SMS and device management\npermissions;\nSideloading a piece of code (second stage) downloaded from its C2 to perform Event\nLogging.\n\nIn this article, we give an overview of these new features in order to figure out their purposes\nand forecast new evolutions.\n\nFigure 1 – BRATA activities during 2021/2022\n\n[[1]](https://www.cleafy.com/labs) [https://www.cleafy.com/labs](https://www.cleafy.com/labs)\n\n[[2]](https://www.cleafy.com/cleafy-labs/how-brata-is-monitoring-your-bank-account) [https://www.cleafy.com/cleafy-labs/how-brata-is-monitoring-your-bank-account](https://www.cleafy.com/cleafy-labs/how-brata-is-monitoring-your-bank-account)\n\n[[3]](https://www.cleafy.com/cleafy-labs/mobile-banking-fraud-brata-strikes-again) [https://www.cleafy.com/cleafy-labs/mobile-banking-fraud-brata-strikes-again](https://www.cleafy.com/cleafy-labs/mobile-banking-fraud-brata-strikes-again)\n\n## BRATA updates\n\nAs we already mentioned in the previous paragraph, TAs are modifying their code in order to\ntailor their malware on specific banking institutions. This code refractory is actually doing\nsmall changes compared to old versions of BRATA, as there are a bunch of classes that\nhave been added for very specific purposes.\n\nNevertheless, before proceeding with a deep dive into BRATA’s features, in Figure 2 we have\nhighlighted all new functions that we observed in the last month. Most of them are very\nspecific and their purpose is crystal clear.\n\n\n-----\n\nFigure 2 – Differences between BRATA variants\n\n\n-----\n\nSpeaking about examples, we could observe a login class that disguises a classic login page\nin order to harvest credentials from unaware users, as well as classes like startactdevmang,\n_startactgpper, startactoverlay and startsmspermnew have been introduced to request_\nadditional permissions for later fraud phases (e.g., device administration, gps, overlay, SMS,\netc. ).\n\n## Credential Harvesting Attack\n\nInvestigation on this sample has led our researchers to discover that BRATA has been\nequipped with a phishing page that recreates a login page of a famous Italian bank. In this\nway, TAs are trying to steal sensitive information from their victims to perform some sort of\nsocial engineering in a later stage of the fraud. As shown in Figure 3, the victim is lured to\ntype Numero Cliente and PIN. This information is the foundation of the authentication\nprocess commonly used by banks.\n\n\n-----\n\nFigure 3 - BRATA phishing page\nIt’s worth mentioning that, at the time of writing, this information seems to be under\ndevelopment. This hypothesis is supported by the fact that there is no data exchange\nbetween the victim device and the TA infrastructure. Moreover, log information and local\ndatabases did not show evidence that these information are stored somewhere on the\ndevice. Another technique is related to the usage of screen recording functionality that could\navoid storing this information, however, adopting this strategy requires additional alerting\nmechanisms in order to properly see all codes typed.\n\nFurthermore, the current version of BRATA has introduced two new permissions inside the\nAndroidManifest file, the RECEIVE_SMS and SEND_SMS. The combination of the phishing\npage with the possibility to receive and read the victim’s sms could be used to perform a\ncomplete Account Takeover (ATO) attack\n\n\n-----\n\nFigure 4 – Function used to create the phishing page\n\n## External Payload - Event logging\n\nAs we already mentioned above, after being correctly installed on the victim’s phone, this\nBRATA version is going to download a .zip file from its C2. This file contains a jar file named\n_unrar.jar._\n\nFigure 5 – BRATA external payload\nFrom the information retrieved, this plugin seems to be in charge of monitoring events that\nare generated from applications. More specifically, each time there is a change in a text view,\nit stores within a local database a pair of Event Text and a Date when the event occurred.\n\n\n-----\n\nFigure 6 – BRATA keylogger function\nAt the time of writing, this feature seems to be under development too. However, our\nhypothesis is that TAs are trying to extend the functionality of the malware to get data from\nother applications, abusing the Accessibility Service.\n\n## SMS Stealer\n\nDuring our analysis of the last BRATA campaign, we found a suspicious app connected to\nthe same BRATA C2 infrastructure.\n\nFigure 7 – Low detection of the SMS stealer app\n\n\n-----\n\nFigure 8 – Permissions declared inside the AndroidManifest file\nAnalyzing the suspicious app, we observed that the developer(s) of the app used the same\nframework used in BRATA malware and also the same names for different classes (Figure\n9).\n\nThanks to a deeper analysis, it is possible to say that the TAs have used some portions of\nBRATA code’s to create this new malicious app. Our hypothesis is that TAs are trying to\ndevelop new types of malware or they are just making some simple experiments to create\nnew types of attacks, like contacts harvesting or SMS sniffers in order to stay undetected.\n\n\n-----\n\nFigure 9 – Names similarities between BRATA and the SMS stealer\n\n\n-----\n\nFigure 10 – Code similarities between BRATA and SMS stealer\nThe malicious app seems to target three different countries: Great Britain, Italy and Spain.\nDuring the installation phases, in fact, it requires you to choose the language of the app.\n\nFigure 11 – SMS stealer targeted countries\n\n\n-----\n\nOnce installed, the pattern of the attack is similar to other SMS stealers. This consists in the\nmalicious app asking the user to change the default messaging app with the malicious one to\nintercept all incoming messages, typically used by banks in PSD2 area for sending\nauthorization codes (2FA/OTP).\n\nFigure 12 - factory reset command sent\nThe similarities between the SMS stealer and BRATA can be found in the network\ncommunication since both use the following two different ports and the endpoint \"/rdc\":\n\nPort 19999: used to notify to the C2 that the malicious app was installed on the victim\ndevice\nPort 18888: used to send SMS intercepted to the C2\n\n\n-----\n\nFigure 13 – Address and ports used to communicate with C2\n\n## Final Considerations\n\nStarting from June 2021, when we first intercepted the BRATA campaigns in Italy, we\nobserved an uninterrupted evolution of both the malware and the attack methodologies used\nby the TAs. The first campaigns of malware were distributed through fake antivirus or other\ncommon apps, while during the campaigns the malware is taking the turn of an APT attack\nagainst the customer of a specific Italian bank.\n\nThe latter trend, the so-called “Advanced Persistent Threat”, seems to be the attack pattern\nthat TAs are going to use in the coming year.. They usually focus on delivering malicious\napplications targeted to a specific bank for a couple of months, and then moving to another\ntarget.\n\n‍\n\n**Appendix 1: IOCs**\n\n**IoC** **Description**\n\n1ae5fcbbd3d0e13192600ef05ba5640d BRATA\n\n69d3ce972e66635b238dc17e632474ec SMS stealer\n\n51[.]83[.]251[.]214 C2 server used by BRATA and the SMS stealer\n\n51[.]83[.]225[.]224 Other BRATA C2 server\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-17 - BRATA is evolving into an Advanced Persistent Threat.pdf"
    ],
    "report_names": [
        "2022-06-17 - BRATA is evolving into an Advanced Persistent Threat.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535774,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1656803649,
    "ts_modification_date": 1656803649,
    "files": {
        "pdf": "https://archive.orkl.eu/055e283442ea5afb67b06e60850816a484c406de.pdf",
        "text": "https://archive.orkl.eu/055e283442ea5afb67b06e60850816a484c406de.txt",
        "img": "https://archive.orkl.eu/055e283442ea5afb67b06e60850816a484c406de.jpg"
    }
}