{
    "id": "58b456da-7e0b-46f5-a530-4dd63f16b4f1",
    "created_at": "2023-01-12T15:02:48.57456Z",
    "updated_at": "2025-03-27T02:05:20.667783Z",
    "deleted_at": null,
    "sha1_hash": "c5828cba81e8137d09a00c875da4a1328b77d090",
    "title": "2022-04-25 - Static unpacker and decoder for Hello Kitty Packer",
    "authors": "",
    "file_creation_date": "2022-05-28T16:13:50Z",
    "file_modification_date": "2022-05-28T16:13:50Z",
    "file_size": 64319,
    "plain_text": "# Static unpacker and decoder for Hello Kitty Packer\n\n**[medium.com/proferosec-osm/static-unpacker-and-decoder-for-hello-kitty-packer-91a3e8844cb7](https://medium.com/proferosec-osm/static-unpacker-and-decoder-for-hello-kitty-packer-91a3e8844cb7)**\n\nBrenton Morris April 25, 2022\n\nBre\nnton\n\n\n[Brenton Morris](https://medium.com/@_scrapbird?source=post_page-----91a3e8844cb7--------------------------------)\n\nApr 25\n\n\n3 min read\n\nDuring a recent incident response engagement, the Profero IR team observed a sample of\nHello Kitty ransomware. This version of ransomware is intriguing as this sample is packed with\na packer written in Go. This packer decrypts the final Hello Kitty payload, which is written in\nC++, before executing it in memory. The Hello Kitty ransomware is written as a simple tool that\nan attacker can use to encrypt data on the victim’s machine and not as a full-fledged malware\nwith persistence methods of its own. This malware has been covered by previous researchers\nin-depth, however, there is much less information about the packer used by this ransomware\ngang.\n\n## HelloKitty (Malware Family)\n\n### TLP:WHITE] win_hellokitty_auto (20220411 | Detects win.hellokitty.) rule win_hellokitty_auto { meta: author = \"Felix…\n\nmalpedia.caad.fkie.fraunhofer.de\n\nDue to this fact, we are releasing this report along with a tool that can be used to unpack the\npayload contained within the Go packer.\n\n## Analysis\n\n Overview\n\nThe use of a Go packer makes it hard for reverse engineers to analyze the binary and assists\nthe malware in evading detection by antivirus and other detection systems. This is due to the\nlow detection rate on Go binaries and due to the nature of packers themselves, as they encrypt\nthe final malicious payload to prevent signature-based detections.\n\n\n-----\n\nBelow is an example of the ransom note used by HelloKitty (extracted using the\n[https://hatching.io/ sandbox):](https://hatching.io/)\n\nRansom note used in this attack\nWhen analyzing the unpacked payload, we can see that the ransomware is not written to install\non a machine but rather it is written as a command-line tool that attackers will use after gaining\naccess to target machines. The unpacked tool even provides a command-line help message.\nThis can be seen in the screenshot below.\n\n\n-----\n\nCommand help message\n\n## Packer Decryption\n\nThe packer’s decryption process is as follows:\n\nThe packed binary is executed and passed a 16-byte decryption key as a command-line\nparameter which the packer will use to decrypt the payload\nThe encrypted blob is located at the overlay of the packed binary. The location in the file is\nobtained by parsing the PE header from the binary:\n\n\n-----\n\nParsing PE headers\n\nThis encrypted blob is then decrypted using the AES-128-CBC algorithm with IV passed\nas an embedded string from the binary, this can be seen in the image below:\n\n\n-----\n\nLocating the IV\n\nThe packer then resolves the entry point of the payload and passes execution to it:\n\n\n-----\n\nFinding and jumping to the entry point of the packed binary\n\n## Unpacking Tool\n\nTo assist in the analysis, the Profero team has developed a tool that can be used to unpack the\nbinary and do the following:\n\nCheck if the packed binary is a hello kitty binary\nExtracts the RSA key, C2 server used, IV, etc\nUnpacks the packed file\n\nThe tool can be executed as follows:\n\n./HelloKittyUnpacker.exe [input] [key] [dump]\n\n\n-----\n\nWe hope that this tool will assist in speeding up analysis in any future incidents involving this\nmalware. In addition, we wanted to open source the code so it can be used as a blueprint for\nsimilar malware.\n\nIt can be found on GitHub:\n\n[https://github.com/proferosec/HelloKittyUnpacker](https://github.com/proferosec/HelloKittyUnpacker)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-25 - Static unpacker and decoder for Hello Kitty Packer.pdf"
    ],
    "report_names": [
        "2022-04-25 - Static unpacker and decoder for Hello Kitty Packer.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535768,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1653754430,
    "ts_modification_date": 1653754430,
    "files": {
        "pdf": "https://archive.orkl.eu/c5828cba81e8137d09a00c875da4a1328b77d090.pdf",
        "text": "https://archive.orkl.eu/c5828cba81e8137d09a00c875da4a1328b77d090.txt",
        "img": "https://archive.orkl.eu/c5828cba81e8137d09a00c875da4a1328b77d090.jpg"
    }
}