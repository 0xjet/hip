{
    "id": "c5082dd9-c652-4717-9130-ad1cb3cdeec9",
    "created_at": "2023-01-12T14:59:02.341755Z",
    "updated_at": "2025-03-27T02:13:48.713292Z",
    "deleted_at": null,
    "sha1_hash": "7380ac4a639427340d32dc6acd4b9b432ac8482e",
    "title": "2022-11-15 - Billbug- State-sponsored Actor Targets Cert Authority, Government Agencies in Multiple Asian Countries",
    "authors": "",
    "file_creation_date": "2022-11-28T19:05:19Z",
    "file_modification_date": "2022-11-28T19:05:19Z",
    "file_size": 392314,
    "plain_text": "# Billbug: State-sponsored Actor Targets Cert Authority, Government Agencies in Multiple Asian Countries\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-asia-governments-cert-authority](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/espionage-asia-governments-cert-authority)**\n\nThreat Hunter TeamSymantec\n\nState-sponsored actors compromised a digital certificate authority in an Asian country during a campaign in which multiple government\nagencies were also targeted.\n\nSymantec, by [Broadcom Software, was able to link this activity to a group we track as Billbug due to the use in this campaign of tools](https://software.broadcom.com/)\npreviously attributed to this group. Billbug (aka Lotus Blossom, Thrip) is a long-established advanced persistent threat (APT) group that\n[is believed to have been active since at least 2009. Symantec has previously published on this group’s activity in 2018 and 2019 under](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets)\n[the Thrip name, but following our 2019 investigation, we determined that Thrip and Billbug were most likely the same group so now](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/thrip-apt-south-east-asia)\ntrack all activity under the Billbug name.\n\nIn activity documented by Symantec in 2019, we detailed how the group was using a backdoor known as Hannotog\n(Backdoor.Hannotog) and another backdoor known as Sagerunex (Backdoor.Sagerunex). Both these tools were also seen in this more\nrecent activity.\n\nThe victims in this campaign included a certificate authority, as well as government and defense agencies. All the victims were based in\nvarious countries in Asia. Billbug is known to focus on targets in Asian countries. In at least one of the government victims, a large\nnumber of machines on the network were compromised by the attackers.\n\nThe targeting of a certificate authority is notable, as if the attackers were able to successfully compromise it to access certificates they\ncould potentially use them to sign malware with a valid certificate, and help it avoid detection on victim machines. It could also\npotentially use compromised certificates to intercept HTTPS traffic. However, although this is a possible motivation for targeting a\ncertificate authority, Symantec has seen no evidence to suggest they were successful in compromising digital certificates. Symantec\nhas notified the cert authority in question to inform them of this activity.\n\nThis activity has been ongoing since at least March 2022.\n\n\n-----\n\n## Attack chain\n\nThere are some indications that the attackers are exploiting public-facing applications to gain initial access to victim networks.\n\nThe attackers use multiple dual-use tools in this attack campaign, as well as custom malware. Billbug’s extensive use of dual-use and\nliving-off-the-land tools was also notable in its previous campaigns. Among the dual-use tools leveraged in this recent activity are:\n\n**AdFind – A publicly available tool that is used to query Active Directory. It has legitimate uses but is widely used by attackers to**\nhelp map a network.\n**Winmail – Can open winmail.dat files.**\n**WinRAR – An archive manager that can be used to archive or zip files - for example, prior to exfiltration.**\n**Ping – A tool that is freely available online that can allow users to determine if a specific location on a network is responding.**\n**Tracert – A network tool that can be used to determine the “path” packets take from one IP address to another. It provides the**\nhostname, IP address, and the response time to a ping.\n**Route – A path for sending packets through the internet network to an address on another network.**\n**NBTscan – Open-source command-line NetBIOS scanner.**\n**Certutil – Microsoft Windows utility that can be used for various malicious purposes, such as to decode information, to download**\nfiles, and to install browser root certificates.\n**Port Scanner – Allows an attacker to determine what ports are open on a network and could potentially be used to send and**\nreceive data.\n\nMultiple files that are believed to be loaders for the Hannotog backdoor were spotted on victim machines. A backdoor was then\ndeployed on the compromised system. This backdoor has multiple functionalities:\n\nIt executes netsh to update the firewall settings:\n_netsh advfirewall firewall add rule name=\"Core Networking - Router Solicitation (ICMP-In)\" dir=in action=allow program=\"%s\"_\n_enable=yes_\n\n_netsh firewall add portopening UDP 5900 @xpsp2res.dll,-22006 ENABLE ALL',0_\n\n_netsh firewall add allowedprogram name=\"SNMP Trap Service\" program=\"%s\" mode=enable_\n\nListens on port 5900\nCan create a service for persistence\nCan also stop services\nCan upload encrypted data\nCan execute cmd.exe /c %s command to gather system information\nCan download files to the machine\n\nA tool called Stowaway Proxy Tool was also downloaded to victim machines. Stowaway is a multi-level proxy tool written in the Go\nlanguage and intended for use by penetration testers. Users can use this program to proxy external traffic to the intranet through\nmultiple nodes, break through intranet access restrictions, construct a tree-like node network, and easily implement management\nfunctions. It is not unusual to see penetration testing tools misused by threat actors. Cobalt Strike, which is a penetration testing\nframework, is considered commodity malware by many due to how often it is used by malicious actors.\n\n## Sagerunex - Technical details\n\nThe Sagerunex backdoor is fairly resilient and implements multiple forms of communication with its command-and-control (C&C) server.\nThe analyzed sample had no hardcoded configuration, so it had to be dropped on the machine by a loader malware, such as Hannotog.\n\nIn the sample analyzed by Symantec, configuration is passed to the sample via a parameter of the exported function (called MainEntry).\nThat configuration is decrypted with a simple XOR operation:\n\n_def simplecrypt(x):_\n\n_return xor(x, b\"\\xad\" + x[:-1])_\n\nNext, the sample finds the explorer.exe process and uses it to change the token of the current thread. It then writes logs to a temporary\nfile (%TEMP%/TS_FB56.tmp), but only if the file already exists. These logs are encrypted and the encryption algorithm used is\nAES256-CBC with 8192 rounds of SHA256:\n\n_def decrypt(datasample):_\n\n_key =_\n_b'\\x53\\x12\\x76\\x23\\x94\\x89\\x78\\x45\\x58\\x31\\x62\\x83\\x77\\x95\\x59\\x17\\x31\\x47\\x73\\x50\\x22\\x34\\x65\\x89\\x49\\x12\\x67\\x41\\x90\\x35\\x91\\x37'_\n\n_realkey = datasample[:0x10]+ b'\\x00' * 0x10_\n\n\n-----\n\n_for i in range(0x2000):_\n_realkey = hashlib.sha256(realkey + key).digest()_\n\n_raw = aes.cbc.decrypt(realkey, datasample[:16], datasample[16:])_\n\n_print(\"checksum\", raw[-32:].hex())_\n\n_return raw[:-32]_\n\nThe encryption key is hardcoded, and was previously used in an older sample of this malware. The same encryption algorithm is used\nfor network communication. The encrypted data structure is as follows:\n\n_struct encrypted_data {_\n\n_byte[16] IV;_\n\n_byte[N] message_data; // always divisible by 16, padding added as necessary_\n\n_byte[32] sha256_checksum;_\n\n_}_\n\nThe sample stores configuration and state in the following file:\n\n_%appdata%/microsoft/protect/windows/DMI%X.DAT (where %X is variable and depends on the parameter with which sample was_\nstarted).\n\nIt is also encrypted, but with RC4. This key was hardcoded in older versions of Sagerunex, but recent samples started to read the key\nfrom configuration instead. The config file modification date will always be in the year 2011 – the “file last edit” year is changed by the\nmalware to 2011.\n\n**Network communication**\n\nIn normal mode, the sample will try all the following supported connection modes in this order. In all cases, HTTPS is used, with user\nagent equal to: Mozilla/5.0 (compatible; MSIE 7.0; Win32).\n\n_- 1: httpsviaconfigproxy: HTTPS with configured proxy_\n\n_- 2: httpswpadproxy: instead of using configured proxy, use proxy provided by WPAD mechanism (web proxy autodiscovery)_\n\n_- 3: httpsviaiexproxy: self-explanatory. Use proxy from \\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ProxyServer_\n\n_- 4: httpsviafirefoxproxy - get proxy from \\\\Mozilla\\\\Firefox\\\\profiles.ini (one of FF config files)_\n\n_- 5: httpsviaautoproxy - use proxy obtained from WinHttpGetIEProxyConfigForCurrentUser_\n\n_- 6: httpspreconfig - try to connect without proxy_\n\nThe network packet is composed of two parts: the header and the payload. Both are encrypted separately.\n\n_struct network_packet {_\n\n_byte[64] encrypted_header; // see encrypted_data above_\n\n_byte[N] encrypted_payload; // see encrypted_data above_\n\n_}_\n\nThe structure of the decrypted header is as follows:\n\n_struct header {_\n\n_int32 command_id;_\n\n_int16 packet_length;_\n\n_int32 packet_crc32;_\n\n_}_\n\nThe structure of the decrypted payload mostly depends on the command ID. The list of supported commands includes:\n\n7: Return the list of currently configured proxies.\n9: Execute a program, DLL or shell command. There are three supported subcommands: \"runexe\" to run an executable, \"rundll\"\nto run a DLL file, and anything else for arbitrary shell command.\n11: Steal a local file (gets a file name specified in the command payload).\n15: Get a configured file path (configured by command 18).\n17: Drop a file to a specified path – but only if the specified path was previously selected by command 18\n\n\n-----\n\n18: Select a file path for commands 15 and 17.\n\n## Motivation\n\nWhile we do not see data being exfiltrated in this campaign, Billbug is widely regarded as being an espionage actor, indicating that data\ntheft is the most likely motivation in this campaign. The victims in this campaign – government agencies and a certificate authority –\nalso point to an espionage and data-theft motive. The targeting of the government victims is most likely driven by espionage\nmotivations, with the certificate authority likely targeted in order to steal legitimate digital certificates, as mentioned in the introduction.\n\nThis is potentially very dangerous, as if Billbug is able to sign its malware with a valid digital certificate it may be able to bypass security\ndetections on victim machines. The ability of this actor to compromise multiple victims at once indicates that this threat group remains a\nskilled and well-resourced operator that is capable of carrying out sustained and wide-ranging campaigns. Billbug also appears to be\nundeterred by the possibility of having this activity attributed to it, with it reusing tools that have been linked to the group in the past.\n\n## Protection\n\n[For the latest protection updates, please visit the Symantec Protection Bulletin.](https://www.broadcom.com/support/security-center/protection-bulletin)\n\n## Indicators of Compromise\n\n072022b54085690001ff9ec546051b2f60564ffbf5b917ac1f5a0e3abe7254a5\n\n0cc6285d4bfcb5de4ebe58a7eab9b8d25dfcfeb12676b0c084e8705e69f6f281\n\n148145b9a2e3f3abdc6c2d3de340eabc82457be67fb44cfa400a5e7bd2f88760\n\n2a4302e61015fdf5f65fbd456249bafe96455cd5cc8aefe075782365b9ae3076\n\n3585a5cbbf1b8b3206d7280355194d5442ed997f61e061fd6938a93163c79507\n\n37fe8efe828893042e4f1db7386d20fec55518a3587643f54d4c3ec82c35df6d\n\n3c35514b27c57a46a5593dbbbfceddbc49979b20fddc14b68bf4f0ee965a7c59\n\n3dd7b684024941d5ab26df6730d23087037535783e342ee98a3934cccddb8c3e\n\n64c546439b6b2d930f5aced409844535cf13f5c6d24e0870ba9bc0cf354d8c11\n\n79f9f25b15e88c47ce035f15dd88f18ecc11e1319ff6f88568fdd0d327ad7cc1\n\n7fe67567a5de33166168357d663b85bd452d64a4340bdad29fe71588ad95bf6f\n\n80a8a9a2e91ead0ae5884e823dca73ef9fce59ff96111c632902d6c04401a4fe\n\n861d1307913d1c2dbf9c6db246f896c0238837c47e1e1132a44ece5498206ec2\n\n8f7c74a9e1d04ff116e785f3234f80119d68ae0334fb6a5498f6d40eee189cf7\n\na462085549f9a1fdeff81ea8190a1f89351a83cf8f6d01ecb5f238541785d4b3\n\nadb61560363fcda109ea077a6aaf66da530fcbbb5dbde9c5923a59385021a498\n\nbcc99bc9c02e1e2068188e63bc1d7ebe308d0d12ce53632baa31ce992f06c34a\n\nb631abbfbbc38dac7c59f2b0dd55623b5caa1eaead2fa62dc7e4f01b30184308\n\nc4a7a9ff4380f6b4730e3126fdaf450c624c0b7f5e9158063a92529fa133eaf2\n\ne4a460db653c8df4223ec466a0237943be5de0da92b04a3bf76053fa1401b19e\n\nf7ea532becda13a1dcef37b4a7ca140c56796d1868867e82500e672a68d029e4\n\nf969578a0e7fe90041d2275d59532f46dee63c6c193f723a13f4ded9d1525c6b\n\nfea2f48f4471af9014f92026f3c1b203825bb95590e2a0985a3b57d6b598c3ff\n\n\n-----\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to investigate targeted attacks, drive\nenhanced protection in Symantec products, and offer analysis that helps customers respond to attacks.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-15 - Billbug- State-sponsored Actor Targets Cert Authority, Government Agencies in Multiple Asian Countries.pdf"
    ],
    "report_names": [
        "2022-11-15 - Billbug- State-sponsored Actor Targets Cert Authority, Government Agencies in Multiple Asian Countries.pdf"
    ],
    "threat_actors": [
        {
            "id": "a1ce86c2-3efc-4115-a85e-92c5fa461838",
            "created_at": "2022-10-25T16:47:55.561071Z",
            "updated_at": "2025-03-27T02:05:17.261424Z",
            "deleted_at": null,
            "main_name": "BRONZE ELGIN",
            "aliases": [
                "Lotus Blossom ",
                "Lotus Panda ",
                "Lstudio",
                "Spring Dragon ",
                "CTG-8171 "
            ],
            "source_name": "Secureworks:BRONZE ELGIN",
            "tools": [
                " Lzari",
                "Elise"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c4bc6ac9-d3e5-43f1-9adf-e77ac5386788",
            "created_at": "2022-10-25T15:50:23.722608Z",
            "updated_at": "2025-03-27T02:00:55.533377Z",
            "deleted_at": null,
            "main_name": "Thrip",
            "aliases": [
                "Thrip"
            ],
            "source_name": "MITRE:Thrip",
            "tools": [
                "PsExec",
                "Mimikatz",
                "Catchamas"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2fa14cf4-969f-48bc-b68e-a8e7eedc6e98",
            "created_at": "2022-10-25T15:50:23.538608Z",
            "updated_at": "2025-03-27T02:00:55.495551Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "Lotus Blossom",
                "DRAGONFISH",
                "Spring Dragon",
                "RADIUM",
                "Raspberry Typhoon"
            ],
            "source_name": "MITRE:Lotus Blossom",
            "tools": [
                "Elise"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "eaa8168f-3fab-4831-aa60-5956f673e6b3",
            "created_at": "2022-10-25T16:07:23.805824Z",
            "updated_at": "2025-03-27T02:02:09.986613Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "ATK 1",
                "ATK 78",
                "Billbug",
                "Bronze Elgin",
                "CTG-8171",
                "Dragonfish",
                "Lotus Blossom",
                "Operation Lotus Blossom",
                "Red Salamander",
                "Spring Dragon",
                "Thrip"
            ],
            "source_name": "ETDA:Lotus Blossom",
            "tools": [
                "BKDR_ESILE",
                "Catchamas",
                "EVILNEST",
                "Elise",
                "Group Policy Results Tool",
                "Hannotog",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PsExec",
                "Rikamanu",
                "Sagerunex",
                "Spedear",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie",
                "gpresult"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a0548d4e-edc2-40c1-a4e2-c1d6103012eb",
            "created_at": "2023-01-06T13:46:38.793461Z",
            "updated_at": "2025-03-27T02:00:02.920553Z",
            "deleted_at": null,
            "main_name": "Thrip",
            "aliases": [
                "G0076",
                "ATK78"
            ],
            "source_name": "MISPGALAXY:Thrip",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "91a034c4-75af-4f4f-9fb0-2d6167cf2038",
            "created_at": "2024-05-01T02:03:07.991617Z",
            "updated_at": "2025-03-27T02:05:17.292551Z",
            "deleted_at": null,
            "main_name": "BRONZE THORNWELL",
            "aliases": [
                "Thrip ",
                "BRONZE ELGIN "
            ],
            "source_name": "Secureworks:BRONZE THORNWELL",
            "tools": [
                " Rikamanu",
                " Syndicasec Trojan",
                "Catchamas"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "87a20b72-ab72-402f-9013-c746c8458b0b",
            "created_at": "2023-01-06T13:46:38.293223Z",
            "updated_at": "2025-03-27T02:00:02.796483Z",
            "deleted_at": null,
            "main_name": "LOTUS PANDA",
            "aliases": [
                "Lotus BLossom",
                "Spring Dragon",
                "ST Group",
                "DRAGONFISH",
                "BRONZE ELGIN",
                "ATK1",
                "G0030",
                "Red Salamander"
            ],
            "source_name": "MISPGALAXY:LOTUS PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535542,
    "ts_updated_at": 1743041628,
    "ts_creation_date": 1669662319,
    "ts_modification_date": 1669662319,
    "files": {
        "pdf": "https://archive.orkl.eu/7380ac4a639427340d32dc6acd4b9b432ac8482e.pdf",
        "text": "https://archive.orkl.eu/7380ac4a639427340d32dc6acd4b9b432ac8482e.txt",
        "img": "https://archive.orkl.eu/7380ac4a639427340d32dc6acd4b9b432ac8482e.jpg"
    }
}