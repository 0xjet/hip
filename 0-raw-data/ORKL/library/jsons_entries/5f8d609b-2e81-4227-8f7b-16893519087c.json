{
    "id": "5f8d609b-2e81-4227-8f7b-16893519087c",
    "created_at": "2023-01-12T15:02:55.854978Z",
    "updated_at": "2025-03-27T02:17:02.724315Z",
    "deleted_at": null,
    "sha1_hash": "34ce76b4c7a47ad674ac2ccea1bd8de37ee354dc",
    "title": "2022-12-13 - I Solemnly Swear My Driver Is Up to No Good- Hunting for Attestation Signed Malware",
    "authors": "",
    "file_creation_date": "2022-12-29T00:39:55Z",
    "file_modification_date": "2022-12-29T00:39:55Z",
    "file_size": 10657759,
    "plain_text": "# I Solemnly Swear My Driver Is Up to No Good: Hunting for Attestation Signed Malware\n\n**mandiant.com/resources/blog/hunting-attestation-signed-malware**\n\n#### During a recent Incident Response investigation, Mandiant discovered a malicious driver used to terminate select processes on Windows systems. In this case, the driver was used in an attempt to terminate the Endpoint Detection and Response (EDR) agent on the endpoint. Mandiant tracks the malicious driver and its loader as POORTRY and STONESTOP respectively. Soon after the initial discovery, Mandiant observed a POORTRY driver sample signed with a Microsoft Windows Hardware Compatibility Authenticode signature. Careful analysis of the driver’s Authenticode metadata led to a larger investigation into malicious drivers signed via the Windows Hardware Compatibility Program. The investigation found a wider issue:\n\n The malicious drivers are signed directly by Microsoft and identifying the original software vendor requires inspecting the signature with code Several distinct malware families, associated with distinct threat actors, have been signed with this process Mandiant identified at least nine unique organization names associated with attestation signed malware\n\n This research is being released alongside a blog post by our colleagues at SentinelOne.\n\n## Code Signing and the Windows Hardware Compatibility Program\n\n#### Relationships are built on trust. The same goes for the relationship we have with the software we rely on when using our computers every day; do I trust the execution of this program, and why? Software can be very opaque to end users; when it claims to be from Company X, what mechanisms exist to verify software’s trustworthiness?\n\n [Queue John Cena walk-out music.]\n\n Code signing has entered the ring.\n\n Code signing is a means to ensure integrity and authenticity of a given file. Software vendors obtain certificates used for code signing from trusted Certificate Authorities (CA), who abide by standards set forth by the CA/Browser Forum and CA Security Council. These guidelines detail requirements, which include verifying the legal existence and identity of the company, and that the requestor of the certificate is authorized to act on behalf of the software vendor they claim to represent.\n\n This certificate is then used to sign the software and provide a level of trust between the software and the operating system. Code signing enforcement policies differ per operating system and file type, from only allowing signed code to execute, to minimizing security warnings for execution of signed code, to purely serving as a digital signature denoting the authenticity of an application.\n\n\n-----\n\n#### Figure 1: Code signing overview (source) Microsoft’s code signing implementation for Windows binaries is known as Authenticode. Authenticode has several features specific to drivers and driver packages, and assists hardware vendors in getting their drivers signed properly via the Windows Hardware Compatibility Program.\n\n “The Windows Hardware Compatibility Program is designed to help your company deliver systems, software and hardware products that are compatible with Windows and run reliably on Windows 10, Windows 11 and Windows Server 2022. The program also provides guidance for developing, testing and distributing drivers. Using the Windows Hardware Dev Center dashboard, you can manage submissions, track the performance of your device or app, review telemetry and much more.”\n\n There are multiple phases to work through the Windows Hardware Compatibility Program process.\n\n Figure 2: Steps in Windows Hardware Compatibility Program For operability on Windows 10 and later, drivers can be submitted to Microsoft for attestation signing.\n\n In this attestation signing process, digital signatures are used to verify the integrity of submitted driver packages and to verify the identity of the software publisher who provided the driver packages. This process requires that the submitting organization sign their driver package with an Extended Validation (EV) certificate, which has enhanced identification requirements over other code-signing certificates and must use stronger encryption algorithms. These EV certificates are offered by a smaller circle of Certificate Authorities who have agreed to enhanced auditing requirements.\n\n As an additional step, vendors can submit their driver for Hardware Lab Kit (HLK) testing, to become Windows Certified. When a driver receives attestation signing, it's not Windows Certified. An attestation signature from Microsoft indicates that the driver can be trusted by Windows, but because the driver has not been tested in HLK Studio, there are no assurances made around compatibility, functionality, and so on.\n\n At a high level, there are 9 steps to submit an attestation signed driver within the compatibility program process.\n\n 1. Register for the Hardware Developer program 2. Identify or purchase an Extended Validation (EV) certificate 3. Download and install the Windows Driver Kit (WDK) 4. Create the CAB file that will be submitted for approval. The CAB file includes the driver itself, driver INF, symbol file, and catalog files. 5. Sign the CAB file with the EV certificate 6. Submit the EV signed CAB via the hardware dashboard 7. Microsoft will sign the driver 8. Download signed driver from the hardware dashboard\n\n\n-----\n\n#### 9 a date a d test t e s g ed d e\n\n The output of this process is an attestation signed driver.\n\n Mandiant has continually observed threat actors use compromised, stolen, and illicitly purchased code-signing certificates to sign malware, lending legitimacy and subverting security controls such as application allow-listing policies. Attestation signed drivers take the trust granted to them by the CA and transfers it to a file whose Authenticode signature originates from Microsoft itself. We assess with high confidence that threat actors have subverted this process using illicitly obtained EV code signing certificates to submit driver packages via the attestation signing process, and in effect have their malware signed by Microsoft directly.\n\n## Threat Data and Observations\n\n#### Mandiant has observed UNC3944 utilizing malware that has been signed via the attestation signing process. UNC3944 is a financially motivated threat group that has been active since at least May 2022 and commonly gains initial network access using stolen credentials obtained from SMS phishing operations. In some cases, the group’s post-compromise objectives have focused on accessing credentials or systems used to enable SIM swapping attacks, likely in support of secondary criminal operations occurring outside of victim environments.\n\n UNC3944 has been observed deploying both STONESTOP and POORTRY as early as August 2022.\n\n STONESTOP is a Windows userland utility that attempts to terminate processes by creating and loading a malicious driver. Mandiant tracks this malicious driver as POORTRY. POORTRY is a Windows driver that implements process termination and requires a userland utility to initiate the functionality. At driver entry it registers device \\device\\KApcHelper1 for interaction by user-space utilities like STONESTOP.\n\n Mandiant has observed signed POORTRY drivers dating back to June of 2022 with a mix of certificates, including stolen certificates that have been widely circulated. Usage of POORTRY appears across different threat groups and is consistent with malware available for purchase or shared freely between different groups.\n\n Table 1: Additional signed POORTRY samples\n\n Compile time Signing time MD5 Certificate Subject Common Name\n\n\n#### 2022-06-02\n 10:09:08\n\n 2022-06-02\n 10:09:08\n\n 2022-06-02\n 10:09:08\n\n 2022-06-06\n 15:14:46\n\n 2022-08-20\n 15:19:01\n\n 2022-10-02\n 19:48:02\n\n\n#### 20220811\n 13:27:00\n\n 20220915\n 15:49:00\n\n 20220821\n 05:43:00\n\n 20221019\n 17:15:00\n\n\n#### 10f3679384a03cb487bda9621ceb5f90 Zhuhai liancheng Technology Co., Ltd.\n\n 04a88f5974caa621cee18f34300fc08a Zhuhai liancheng Technology Co., Ltd.\n\n 6fcf56f6ca3210ec397e55f727353c4a Microsoft Windows Hardware Compatibility Publisher\n\n 0f16a43f7989034641fd2de3eb268bf1 NVIDIA Corporation\n\n ee6b1a79cb6641aa44c762ee90786fe0 Microsoft Windows Hardware Compatibility Publisher\n\n 909f3fc221acbe999483c87d9ead024a Microsoft Windows Hardware Compatibility Publisher\n\n\n#### Unlike the earlier examples, many of which were improperly signed, this POORTRY sample is legitimately signed and verified with a Microsoft Windows Hardware Compatibility Publisher certificate. This is a Microsoft certificate that is used across the attestation program, and therefore is used extensively on legitimate binaries as well.\n\n\n-----\n\n#### Figure 3: Valid POORTRY signature data The public key used for the attestation signing (Appendix C: POORTRY Certificate Details) contains two object identifiers (OIDs) of interest within the key usage value:\n\n Figure 4: Extended Key Usage\n```\n X509v3 Extended Key Usage:\n          1.3.6.1.4.1.311.10.3.5, 1.3.6.1.4.1.311.10.3.5.1, Code Signing\n\n RFC 5280 Section 4.2.1.12 defines Extended Key Usage (EKU). The EKU values in this signature help identify which method was used to sign this file and what purposes this signing certificate may be used for. The values defined show that this certificate is used in the Windows Hardware Compatibility driver signing process and is used specifically for attestation signed drivers. Table 1 shows the OID descriptions.\n\n Table 2: WHQL Extended Key Usage object IDs\n\n EKU OID Symbolic Name Description\n\n 1.3.6.1.4.1.311.10.3.5 szOID_WHQL_CRYPTO Windows Hardware Driver Verification\n\n 1.3.6.1.4.1.311.10.3.5.1 szOID_ATTEST_WHQL_CRYPTO Windows Hardware Driver Attested Verification\n\n```\n\n-----\n\n#### e co ect o bet ee t e OO sa p e, t e attestat o ce t cate, a d t e u e ous eg t ate sa p es s g ed t t s ce t cate ed Mandiant to assess with high confidence that this malware was verified via the Windows Hardware Compatibility process.\n\n RFC 2315 for the PKCS #7 v1.5 specification defines a SignerInfo content type, which for Authenticode signed PEs contains several interesting structures that can be used to identify samples related to the initially identified POORTRY driver (6fcf56f6ca3210ec397e55f727353c4a).\n\n The field of interest, programName, is contained in the SpcSpOpusInfo attribute, which is specific to Authenticode. Mandiant assesses with high confidence that the programName field (hereafter referred to as Program Name) for attestation signed drivers contains identifiable information about the individual hardware vendor who submitted the driver for attestation signing.\n\n Figure 5: Windows Authenticode Portable Executable Signature Format\n\n SpcSpOpusInfo\n  SpcSpOpusInfo is identified by SPC_SP_OPUS_INFO_OBJID\n  (1.3.6.1.4.1.311.2.1.12) and is defined as follows:\n  SpcSpOpusInfo ::= SEQUENCE {\n   programName [0] EXPLICIT SpcString OPTIONAL,\n   moreInfo   [1] EXPLICIT SpcLink OPTIONAL,\n  } --#public-\n  SpcSpOpusInfo has two fields:\n   programName\n    This field contains the program description:\n    If publisher chooses not to specify a description, the SpcString\n    structure contains a zero-length program name.\n    If the publisher chooses to specify a\n    description, the SpcString structure contains a Unicode string.\n   moreInfo\n    This field is set to an SPCLink structure that contains a URL for\n    a Web site with more information about the signer. The URL is an\n    ASCII string.\n\n Figure 6: Program Name value from POORTRY Authenticode data (6fcf56f6ca3210ec397e55f727353c4a)\n\n 大连纵梦网络科技有限公司\n\n This field becomes an important artifact for identifying additional associated samples, and by pivoting on the Program Name, Mandiant identified eleven new suspicious files, including an additional POORTRY sample.\n\n Table 3: Samples with Program Name of 大连纵梦网络科技有限公司\n\n MD5 Family Filename Signature Date\n\n`6fcf56f6ca3210ec397e55f727353c4a` POORTRY `4.sys` `2022/09/15 11:49`\n\n`ee6b1a79cb6641aa44c762ee90786fe0` POORTRY `NodeDriver.sys` `2022/08/21 01:43`\n```\n 1f2888e57fdd6aee466962c25ba7d62d Air_SYSTEM10.sys 2022/10/01 11:43\n 22949977ce5cd96ba674b403a9c81285 PcieCubed.sys 2022/08/20 09:37\n 4e1f656001af3677856f664e96282a6f Sense5Ext.sys 2022/08/09 07:20\n 7f9309f5e4defec132b622fadbcad511 2022/08/24 07:33\n acac842a46f3501fe407b1db1b247a0b 2022/08/23 04:40\n b164daf106566f444dfb280d743bc2f7 2022/08/17 10:48\n bd25be845c151370ff177509d95d5add 2.sys 2022/09/19 24:33\n dc564bac7258e16627b9de0ce39fae25 7.sys 2022/08/19 08:03\n\n```\n\n-----\n\n```\n f9844524fb0009e5b784c21c7bad4220 Sense5Ext.sys 2022/08/22 14:48\n\n#### The programName field for attestation signed drivers appears to be populated by the X.509 Subject Organization Name (O) of the EV Code Signing certificate used to sign the initial CAB submission to the WHCP portal. This is corroborated by the high amount of malicious detections for samples associated with this Organization Name and other corresponding Program Name values on VirusTotal and within other Mandiant data sets. At time of writing, we have not been able to confirm with Microsoft that this is the exact mechanism for how the programName field is populated for attestation signed drivers.\n\n Table 4: Digicert EV code signing certificates with Organization Name of 大连纵梦网络科技有限公司\n\n MD5 Family Certificate Serial\n\n```\n`05a56a88f34718cabd078dfd6b180ed0` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`2406150783d3ec5de13c2654db1a13d5` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`29506adae5c1e97de49e3a0d3cd974d4` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`48c1288cd35504de6f4bd97ec02decb1` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`578e70a8a7c1972bbc35c3e14e53cbee` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`6216fba5cf44aa99a73ca919301142e9` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`69fa8946c326d4b66a371608d8ffbe5e` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`6e4e37641e24edc89cfa3e999962ea34` Fast Reverse Proxy `0c:25:f1:f2:a8:d4:a2:93:21:e8:28:6e:ed:50:e3:e2`\n\n`8a930742d1da0fcfe5492d4eb817727c` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`8fbad6e5aa15857f761e6a7a75967e85` SOGU Launcher `03:25:0b:78:25:67:56:fc:10:db:c6:7a:22:52:7b:44`\n\n`976bac6cfb21288b4542d5afe7ce7be7` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`aaeedaa5880e38dc63a5724cf18baf13` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`ab5d85079e299ac49fcc9f12516243de` SOGU Launcher `0c:59:d4:65:80:f0:39:af:2c:4a:b6:ba:0f:fe:d1:97`\n\n`c43de22826a424b2d24cf1b4b694ce07` SOGU Launcher `0c:59:d4:65:80:f0:39:af:2c:4a:b6:ba:0f:fe:d1:97`\n\n`d312a6aeffec3cff78e9fad141d3aaba` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`d36084aad079ca8d91c2985eca80327b` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n`e086d7d5a5657800a0d7e9c144fac16d` Fast Reverse Proxy `01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52`\n\n#### All the observed corresponding EV code signing certificates were issued by Digicert. Over time certificate serial\n```\n01:15:3e:7a:3c:8d:c5:0b:3d:23:c8:ba:31:d3:70:52 was revoked, however several others appear to have not been revoked (bolded in\n\n Table 4). These corresponding Extended Validation certificates were used to sign launchers for SOGU malware utilized by Temp.Hex as well as signed distributions of the open source Fast Reverse Proxy tool, which has been used by suspected Iranian state-sponsored threat actors in intrusions observed by Mandiant.\n\n Utilizing the OIDs and certificate data, YARA rules were developed to collect additional attestation signed drivers.\n\n Examining these additional attestation signed drivers led to 57 suspicious samples that shared program names that were observed in malicious binaries (Appendix B: Indicators of Interest). These samples were spread across nine different program names.\n\n Fi 7 Id tifi d P N i i tt t ti i d l\n\n```\n\n-----\n\n```\n Qi Lijun\n Luck Bigger Technology Co., Ltd\n XinSing Network Service Co., Ltd\n Hangzhou Shunwang Technology Co.,Ltd\n\n#### 福州超人\n\n 北京弘道长兴国际贸易有限公司\n\n 福建奥创互娱科技有限公司\n\n 厦门恒信卓越网络科技有限公司\n\n 大连纵梦网络科技有限公司\n\n## Malicious Driver Signing as a Service\n\n#### The suspicious samples identified through this investigation have led to multiple development environment artifacts, specifically program database (PDB) paths, implying multiple different development environments and potentially multiple different malware authors.\n\n Mandiant has previously observed scenarios when it is suspected that groups leverage a common criminal service for code signing. This is not a new phenomenon, and has been documented by the Certified Malware project at the University of Maryland in 2017. This is what Mandiant believes is occurring with these suspicious attestation signed drivers and related EV signed samples.\n\n The use of stolen or fraudulently obtained code signing certificates by threat actors has been a common tactic and providing these certificates or signing services has proven a lucrative niche in the underground economy. Mandiant has identified numerous threat actors and services advertising in a variety of languages, including English, Russian, and Chinese, that claim to provide code signing certificates or sign malware on behalf of threat actors. For example, while analyzing chat messages leaked by the Twitter user “@ContiLeaks,” Mandiant identified several instances where threat actors involved in Trickbot operations purchased code signing certificates from multiple threat actors, with observed pricing ranging between approximately $1,000-$3,000 USD for a single certificate.\n\n While most of these advertisements only mention EV code signing certificates, we have identified a small number of discussions focused on signing drivers through WHQL. While most of these discussions lamented to the challenges presented by WHQL restrictions, we observed at least one actor who mentioned experience signing drivers with WHQL, and we have also identified multiple websites on the open Internet advertising WHQL driver signing services to enterprise businesses. While we are unable to link the signed payloads observed in this activity to any of the identified services, it’s plausible that actors are either enlisting services from underground forums or abusing commercial services to obtain signed driver malware.\n\n A pattern emerges of suspected malicious attestation signed drivers that contain the programName corresponding to EV certificates that have also signed other suspected malicious samples. The Certificates appear to be issued primarily via Digicert and Globalsign to Chinese customers, indicating possible abuse of a Chinese market certificate reseller or signing service.\n\n Given the different company names identified and the differing development environments Mandiant suspects there is a service provider getting these malware samples signed through the attestation process on behalf of the actors. Unfortunately, at this time, this assessment is stated with low confidence.\n\n## Hunting and Blocking\n\n#### Attestation signing is a legitimate Microsoft program, and the resulting drivers are signed with legitimate Microsoft certificates. This makes execution-time detection difficult as Microsoft and most EDR tools will allow Microsoft signed binaries to load. Organizations must instead depend on behavioral detections to overcome the implicit trust granted to Microsoft-signed binaries and alert on suspicious or rootkit-like activities. For proactive hunts, however, there are numerous ways to search for these files.\n\n### YARA Rules and Descriptions\n\n#### M_Hunting_Signed_Driver_Attestation_1\n\n The OLEs allow detection to be implemented to identify any binary that is signed via the attestation process. This rule matches on the presence of the OLEs and the Microsoft Windows Hardware Compatibility Publisher certificate subject.\n\n M_Win_Hunting_CertEngine_Attestation_ProgramName_1\n\n The identified company names that were in the certificate program name can be used to home in on potentially suspicious samples. However, know that due to the nature of these certificates it is not true that all samples with the certificate are malicious, but simply have been abused in the past and warrant further investigation.\n\n```\n\n-----\n\n#### _ g _ _ _ g _\n\n The VirusTotal dataset has additional data available for access via LiveHunt rules. This includes various tags and other metadata from the related sandbox execution. This information can be used to identify suspected malicious attestation signed binaries by combining the M_Hunting_Signed_Driver_Attestation_1 rule with the malicious count metadata.\n\n M_Hunting_Win_ConventionEngine_PDB_Attestation_Multiple_1\n\n As documented in the Definitive Dossier of Devilish Debug Details, PDB paths can be used to identify strings that are present within the malware.However, it’s important to remember that this is a consequence of the malware and malware developers, and not the certificate or signing process.\n\n See Appendix A: YARA for the full list of detections.\n\n## Conclusion\n\n#### The attestation signing process offloads the responsibility of verifying the identity of the requesting hardware or software vendor to the Certificate Authorities. In theory this is a valid process as the CAs must follow agreed upon procedures to verify the identity of the requesting entity and the authority of the individual making the request to represent the software vendor. However, this process is being abused to obtain malware signed by Microsoft.\n\n This is not a new occurrence; both GData and BitDefender released reports on Microsoft signed malicious drivers in 2021. “Microsoft signed a malicious Netfilter rootkit” and “Digitally-Signed Rootkits are Back – A Look at FiveSys and Companions” discussed malicious drivers signed via the same attestation process discussed in this blog post.\n\n While this blog post has focused on POORTRY and the attestation signing process, Mandiant has observed other malware being signed via attestation. TEMPLESHOT is a malware family consisting of dropper, backdoor, a filter driver, and a protection driver. The TEMPLESHOT driver with MD5 48bf11dd6c22e241b745d3bb1d562ca1 has been observed in the wild and is signed via attestation.\n\n## Acknowledgements\n\n#### Use of the Signify python library made automated analysis of Authenticode data extremely efficient. This content would not have been possible without the assistance of analysts across the Mandiant Intelligence and FLARE organizations.\n\n## Appendix A: YARA\n```\n import \"pe\"\n rule M_Hunting_Signed_Driver_Attestation_1\n {\n   meta:\n     author = \"Mandiant\"\n     date_created = \"2022-10-20\"\n     description = \"Find driver signed via Microsoft attestation signing only (no EV certificate signing outside of\n Microsoft Windows Hardware Compatibility Publisher)\" //https://learn.microsoft.com/en-us/windows hardware/drivers/dashboard/code-signing-attestation\n   strings:\n     $whql_oid = {2b0601040182370a030501} //OID 1.3.6.1.4.1.311.10.3.5.1, Windows Hardware Quality Labs (WHQL)\n crypto -- \"szOID_WHQL_CRYPTO\"\n     $spc_statement_type = {2b060104018237020115} //OID 1.3.6.1.4.1.311.2.1.21, SPC_INDIVIDUAL_SP_KEY_PURPOSE_OBJID\n     $spc_sp_opus_info_oid = {2b06010401823702010c} //OID 1.3.6.1.4.1.311.2.1.12, SPC_SP_OPUS_INFO_OBJID\n   condition:\n     pe.signatures[0].subject == \"/C=US/ST=Washington/L=Redmond/O=Microsoft Corporation/CN=Microsoft Windows\n Hardware Compatibility Publisher\" and\n     $whql_oid and\n     $spc_sp_opus_info_oid and\n     $spc_statement_type\n }\n\n```\n\n-----\n\n```\nimport pe\nrule M_Win_Hunting_CertEngine_Attestation_ProgramName_1\n{\n  meta:\n    author = \"Mandiant\"\n    description = \"Find driver signed via Microsoft attestation signing only with one of the identified company\nnames of interest.\"\n  strings:\n    $whql_oid = {2b0601040182370a030501} //OID 1.3.6.1.4.1.311.10.3.5.1, Windows Hardware Quality Labs (WHQL)\ncrypto -- \"szOID_WHQL_CRYPTO\"\n    $spc_statement_type = {2b060104018237020115} //OID 1.3.6.1.4.1.311.2.1.21, SPC_INDIVIDUAL_SP_KEY_PURPOSE_OBJID\n    $spc_sp_opus_info_oid = {2b06010401823702010c} //OID 1.3.6.1.4.1.311.2.1.12, SPC_SP_OPUS_INFO_OBJID\n    $unicode1 = {59278FDE 7EB568A6 7F517EDC 79D16280 67099650 516C53F8}\n    $unicode2 = {51 69 20 4c 69 6a 75 6e}\n    $unicode3 = {4c 75 63 6b 20 42 69 67 67 65 72 20 54 65 63 68 6e 6f 6c 6f 67 79 20 43 6f 2e 2c 20 4c 74 64}\n    $unicode4 = {58 69 6e 53 69 6e 67 20 4e 65 74 77 6f 72 6b 20 53 65 72 76 69 63 65 20 43 6f 2e 2c 20 4c 74 64}\n    $unicode5 = {48 61 6e 67 7a 68 6f 75 20 53 68 75 6e 77 61 6e 67 20 54 65 63 68 6e 6f 6c 6f 67 79 20 43 6f 2e\n2c 4c 74 64}\n    $unicode6 = {54 41 20 54 72 69 75 6d 70 68 2d 41 64 6c 65 72 20 47 6d 62 48}\n    $unicode7 = {798f 5dde 8d85 4eba}\n    $unicode8 = {5317 4eac 5f18 9053 957f 5174 56fd 9645 8d38 6613 6709 9650 516c 53f8}\n    $unicode9 = {798f 5efa 5965 521b 4e92 5a31 79d1 6280 6709 9650 516c 53f8}\n    $unicode10 = {53a6 95e8 6052 4fe1 5353 8d8a 7f51 7edc 79d1 6280 6709 9650 516c 53f8}\n  condition:   \n    $whql_oid and\n    $spc_sp_opus_info_oid and\n    $spc_statement_type and\n    pe.signatures[0].subject == \"/C=US/ST=Washington/L=Redmond/O=Microsoft Corporation/CN=Microsoft Windows\nHardware Compatibility Publisher\" and\n    (1 of ($unicode*))\n}\n\n```\n\n-----\n\n```\n import vt\n import \"pe\"\n rule M_CertEngine_Malicious_Attestation_Signed_Driver\n {\n   meta:\n     author = \"Mandiant\"\n     description = \"Find driver signed via Microsoft attestation signing only and greater than 3 malicious hits in\n VirusTotal.”\n   strings:\n     $whql_oid = {2b0601040182370a030501} //OID 1.3.6.1.4.1.311.10.3.5.1, Windows Hardware Quality Labs (WHQL)\n crypto -- \"szOID_WHQL_CRYPTO\"\n     $spc_statement_type = {2b060104018237020115} //OID 1.3.6.1.4.1.311.2.1.21, SPC_INDIVIDUAL_SP_KEY_PURPOSE_OBJID\n     $spc_sp_opus_info_oid = {2b06010401823702010c} //OID 1.3.6.1.4.1.311.2.1.12, SPC_SP_OPUS_INFO_OBJID\n   condition:\n     for any tag in vt.metadata.tags : ( tag == \"signed\" ) and\n     pe.signatures[0].subject == \"/C=US/ST=Washington/L=Redmond/O=Microsoft Corporation/CN=Microsoft Windows\n Hardware Compatibility Publisher\" and\n     vt.metadata.analysis_stats.malicious > 3 and\n     $whql_oid and\n     $spc_sp_opus_info_oid and\n     $spc_statement_type\n }\n rule M_Hunting_Win_ConventionEngine_PDB_Attestation_Multiple_1\n {\n   meta:\n     author = \"Mandiant\"\n     description = \"Looking for PDB path strings that has been observed in malicious samples which were attestation\n signed\"\n   strings:\n     $anchor = \"RSDS\"\n     $pdb1 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\.{0,250}gamehacks.{0,250}boot_driver.{0,250}\\.pdb\\x00/ nocase\n     $pdb2 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\.{0,250}MyDriver1.{0,250}wfp_vpn.{0,250}\\.pdb\\x00/ nocase\n     $pdb3 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\.{0,250}FilDriverx64_win10.{0,250}\\.pdb\\x00/ nocase\n     $pdb4 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\.{0,250}RedDriver_win10.{0,250}\\.pdb\\x00/ nocase\n     $pdb5 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\.{0,250}sellcode.{0,250}MyDriver.{0,250}\\.pdb\\x00/ nocase\n     $pdb6 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\.{0,250}Users\\\\ljl11{0,250}\\.pdb\\x00/ nocase\n     $pdb7 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\.{0,250}RkDriver64.{0,250}MyDriver1.{0,250}\\.pdb\\x00/ nocase\n     $pdb8 = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\.{0,250}\\\\ApcHelper.{0,250}TSComputerManager.{0,250}\\.pdb\\x00/ nocase\n   condition:\n     (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and filesize < 20MB and $anchor and (1 of\n ($pdb*))\n }\n\n## Appendix B: Indicators of Interest\n\n### Attestation Signed Binaries with Suspicious Program Name Values\n\n```\n\n-----\n\n#### s tab e s so ted by S g atu e ate S g atu e ate s a aut e t cated att bute, co ta g t e t esta p o s g g So t g by t s date allows readers to view how the programName is used and changed over time.\n\n One sample (688c138fffbb4e7297289433c79d62f5) does not have a Signature Date, and this is likely due to binary tampering including the use of VMProtect after signing and other modifications.\n\n MD5 Program Name Signature Date\n\n`688c138fffbb4e7297289433c79d62f5` 北京弘道长兴国际贸易有限公司 `N/A`\n\n`0b4a0fe7db8400ef65ce7618177351cf` 福建奥创互娱科技有限公司 `2021/07/09 11:35`\n\n`6e3516775e7e009777dcdb7a314f1482` 福建奥创互娱科技有限公司 `2021/07/19 07:39`\n\n`ea5f6ab5666193f805d13a49009f0699` 福建奥创互娱科技有限公司 `2021/07/20 06:43`\n\n`63960dbc7d63767edb6e1e2dc6f0707b` 福建奥创互娱科技有限公司 `2021/07/28 13:05`\n\n`ddee86b84dcb72835b57b1d049e9e0cd` 福建奥创互娱科技有限公司 `2021/07/29 09:25`\n\n`19d99758b1f33b418cb008530b61a1e7` 福建奥创互娱科技有限公司 `2021/07/29 10:02`\n\n`f9aad310a5d5c80bbc61d10cc797e4f0` 北京弘道长兴国际贸易有限公司 `2021/11/06 17:38`\n\n`ff43f91f2465504e5e67d0b37d92ef18` 厦门恒信卓越网络科技有限公司 `2021/12/30 06:12`\n\n`45be5c0e7dfe37f88f1fa6c2fbb462c5` 厦门恒信卓越网络科技有限公司 `2022/01/13 24:00`\n\n`26d6833b1875b138ea34d6ab430cafcd` 厦门恒信卓越网络科技有限公司 `2022/02/07 03:47`\n\n`561bc6902367d9e43e27c5543e7a5818` 厦门恒信卓越网络科技有限公司 `2022/02/09 11:35`\n\n`929b293090bcc7900c1e8f9ba519e219` 厦门恒信卓越网络科技有限公司 `2022/02/13 12:25`\n\n`b500ee8d8cb045936d2996a1747bcded` 厦门恒信卓越网络科技有限公司 `2022/02/14 24:25`\n\n`42200c8422347f63b3edb45ea5aa9c45` 厦门恒信卓越网络科技有限公司 `2022/02/14 12:25`\n\n`48fc05c42549d0b3ec9e73bbb5be40dc` 厦门恒信卓越网络科技有限公司 `2022/02/14 12:25`\n\n`bf13a2f4e2deb62b7dee98a012e94d61` 厦门恒信卓越网络科技有限公司 `2022/02/14 12:25`\n\n`d66fc4e2f537566bb4d91cdea0ac64e5` 厦门恒信卓越网络科技有限公司 `2022/02/14 12:25`\n\n`de4b5043c82ab3b36b4ae73a2e96d969` 厦门恒信卓越网络科技有限公司 `2022/02/14 12:25`\n\n`cc29cf2294175315acbf33054151f3cd` 厦门恒信卓越网络科技有限公司 `2022/02/15 06:07`\n\n`6e730cf4ebcd166d26414378cab3a6d8` 厦门恒信卓越网络科技有限公司 `2022/02/18 06:58`\n\n`8e4d0f679b092296a2f74cf812907d05` 厦门恒信卓越网络科技有限公司 `2022/02/18 06:58`\n\n`f8ccabcbe08bbd2c8420f4d1cffcefd8` 厦门恒信卓越网络科技有限公司 `2022/02/18 06:58`\n\n\n-----\n\n`9f1d3b0fb49e063f4804aa60b7b708ac` 厦门恒信卓越网络科技有限公司 `2022/02/18 08:23`\n\n`2bbfb9cb4550109da5ae336d3d3dd984` 厦门恒信卓越网络科技有限公司 `2022/02/23 03:55`\n\n`42a417e54639c69f033f72bbafe6e09a` 北京弘道长兴国际贸易有限公司 `2022/02/25 09:18`\n\n`7ee0c884e7d282958c5b3a9e47f23e13` 北京弘道长兴国际贸易有限公司 `2022/02/26 24:58`\n\n`66c145233576766013688088b03103e3` 厦门恒信卓越网络科技有限公司 `2022/03/08 07:16`\n\n`1f929fd617471c4977b522c71b4c91ed` 北京弘道长兴国际贸易有限公司 `2022/03/26 24:09`\n\n`4a0f22286134a58d9d20f911a608f636` 福州超人 `2022/03/28 09:34`\n\n`947ebc3f481a7b9ee3cf3a34d9830159` 福州超人 `2022/03/28 09:40`\n\n`33b5485b35b33fd8ead5a38899522cce` 福州超人 `2022/03/28 10:20`\n\n`721b40a0c2a0257443f7dcc2c697e28a` 福州超人 `2022/04/09 17:06`\n\n`b44dfd8c5e7b0c8652d7a647dfe252e4` 福州超人 `2022/05/03 09:25`\n\n`1a57c1d80018bfef1e243f9eba2955f2` 北京弘道长兴国际贸易有限公司 `2022/05/09 01:18`\n\n`ac2a1f2ae6b547619bef93dfadb48937` 福州超人 `2022/05/19 07:09`\n\n`8ac6ef2475ec89d3709fc124573cb380` 北京弘道长兴国际贸易有限公司 `2022/05/31 11:06`\n\n`b34403502499741762912c7bfc9ff21f` Hangzhou Shunwang Technology Co.,Ltd `2022/06/13 08:25`\n\n`734b3a6e6cbd1f53fbb693140d2c3049` 北京弘道长兴国际贸易有限公司 `2022/06/13 08:45`\n\n`c0471f78648643950217620f6e7e24cc` 北京弘道长兴国际贸易有限公司 `2022/06/13 08:45`\n\n`228f9f0a0466fba21ac085626020a8e1` Qi Lijun `2022/08/02 16:10`\n\n`65a3f812ea031f4d53ba09f33c058ab6` Qi Lijun `2022/08/02 16:10`\n\n`7d78b5773845c5189ca09227d27a9d5a` Qi Lijun `2022/08/03 01:56`\n\n`e7ff38a94ad765eb305fc7f0837f5913` Qi Lijun `2022/08/03 01:58`\n\n`4e1f656001af3677856f664e96282a6f` 大连纵梦网络科技有限公司 `2022/08/09 07:20`\n\n`b164daf106566f444dfb280d743bc2f7` 大连纵梦网络科技有限公司 `2022/08/17 10:48`\n\n`dc564bac7258e16627b9de0ce39fae25` 大连纵梦网络科技有限公司 `2022/08/19 08:03`\n\n`22949977ce5cd96ba674b403a9c81285` 大连纵梦网络科技有限公司 `2022/08/20 09:37`\n\n`ee6b1a79cb6641aa44c762ee90786fe0` 大连纵梦网络科技有限公司 `2022/08/21 01:43`\n\n\n-----\n\n`f9844524fb0009e5b784c21c7bad4220` 大连纵梦网络科技有限公司 `2022/08/22 14:48`\n\n`acac842a46f3501fe407b1db1b247a0b` 大连纵梦网络科技有限公司 `2022/08/23 04:40`\n\n`7f9309f5e4defec132b622fadbcad511` 大连纵梦网络科技有限公司 `2022/08/24 07:33`\n\n`7ba744b584e28190eb03b9ecd1bb9374` XinSing Network Service Co., Ltd `2022/09/07 02:24`\n\n`6fcf56f6ca3210ec397e55f727353c4a` 大连纵梦网络科技有限公司 `2022/09/15 11:49`\n\n`bd25be845c151370ff177509d95d5add` 大连纵梦网络科技有限公司 `2022/09/19 24:33`\n\n`1f2888e57fdd6aee466962c25ba7d62d` 大连纵梦网络科技有限公司 `2022/10/01 11:43`\n\n`909f3fc221acbe999483c87d9ead024a` Luck Bigger Technology Co., Ltd `2022/10/19 13:15`\n\n### Signed POORTRY Samples\n\n#### The following table includes signed POORTRY samples.\n\n\n#### Compile Time\n```\n20220602\n10:09:08\n20220602\n10:09:08\n20220602\n10:09:08\n20220606\n15:14:46\n20220820\n15:19:01\n20221002\n19:48:02\n\n```\n\n#### Signing Status\n\n```\nRevoked D:\\KApcHelper\\x64\\\n           Release\\KApcHelper.pdb\n     20220915\n     15:49:00\nExpired D:\\KApcHelper\\x64\\\n           Release\\KApcHelper.pdb\n     20220821\n     05:43:00\n     20221019\n     17:15:00\n\n```\n\n#### Signing Time\n\n\n#### PDB path MD5 Filename Serial C N\n\n```\nRevoked 20220811\n     13:27:00\n\n```\n```\nD:\\KApcHelper\\x64\\\nRelease\\KApcHelper.pdb\n\n```\n```\n10f3679384a03cb4\n87bda9621ceb5f90\n04a88f5974caa621\ncee18f34300fc08a\n6fcf56f6ca3210ec\n397e55f727353c4a\n0f16a43f79890346\n41fd2de3eb268bf1\nee6b1a79cb6641aa\n44c762ee90786fe0\n909f3fc221acbe99\n9483c87d9ead024a\n\n```\n```\nprokiller64.sys 62:7d:fd:f7:3a:14:55:de:\n            51:43:a2:70:79:9e:6b:7b\ngftkyj64.sys 62:7d:fd:f7:3a:14:55:de:\n            51:43:a2:70:79:9e:6b:7b\n            33:00:00:00:57:ee:4d:65:9a:9\n            2:3e:7c:10:00:00:00:00:00:57\nKApcHelper_x64.sys 43:bb:43:7d:60:98:66:28:\n            6d:d8:39:e1:d0:03:09:f5\nNodeDriver.sys 33:00:00:00:57:ee:4d:65:9a:9\n            2:3e:7c:10:00:00:00:00:00:57\nLcTkA.sys 33:00:00:00:57:ee:4d:65:9a:9\n            2:3e:7c:10:00:00:00:00:00:57\n\n```\n```\nZh\nli\nTe\nCo\nZh\nli\nTe\nCo\nMi\nWi\nHa\nCo\nPu\nNV\nCo\nMi\nWi\nHa\nCo\nPu\nMi\nWi\nHa\nCo\nPu\n\n```\n\n### Extended Validation Signed Samples\n\n#### The following table includes samples signed by EV certificates where the Organization Name is 大连纵梦网络科技有限公司.\n\n\n#### Compile Time\n\n\n#### Signed Time\n\n\n#### MD5 Family Filename Certificate Serial Certificate Issuer Common Name\n\n\n#### Organization Name\n\n\n-----\n\n```\n19700101\n00:00:00\n19700101\n00:00:00\n19700101\n00:00:00\n19700101\n00:00:00\n19700101\n00:00:00\n19700101\n00:00:00\n19700101\n00:00:00\n19700101\n00:00:00\n19700101\n00:00:00\n20211220\n07:37:56\n19700101\n00:00:00\n19700101\n00:00:00\n20200704\n03:53:04\n\n```\n```\n20201006\n16:26:00\n20201128\n18:12:00\n20210226\n22:11:00\n20220219\n13:29:00\n20200820\n12:34:00\n20201128\n18:13:00\n20220219\n13:29:00\n20200802\n07:11:00\n20210605\n19:09:00\n20201224\n19:02:00\n20210605\n19:09:00\n20200704\n08:13:00\n\n```\n```\n05a56a88f34718ca\nbd078dfd6b180ed0\n2406150783d3ec5d\ne13c2654db1a13d5\n29506adae5c1e97d\ne49e3a0d3cd974d4\n48c1288cd35504de\n6f4bd97ec02decb1\n578e70a8a7c1972b\nbc35c3e14e53cbee\n6216fba5cf44aa99\na73ca919301142e9\n69fa8946c326d4b6\n6a371608d8ffbe5e\n6e4e37641e24edc8\n9cfa3e999962ea34\n8a930742d1da0fcf\ne5492d4eb817727c\n8fbad6e5aa15857f\n761e6a7a75967e85\n976bac6cfb21288b\n4542d5afe7ce7be7\naaeedaa5880e38dc\n63a5724cf18baf13\nab5d85079e299ac4\n9fcc9f12516243de\n\n```\n```\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nSOGU\nLauncher\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nSOGU\nLauncher\n\n```\n```\nfrpc.exe 01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\nfrpc.exe 01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\n\n```\n```\npowerdvd18.exe 03:25:0b:78:25:67:56:fc:\n               10:db:c6:7a:22:52:7b:44\nfrpc.exe 01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\nfrpc_windows_386.exe 01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\nSmadavMain.exe 0c:59:d4:65:80:f0:39:af:\n               2c:4a:b6:ba:0f:fe:d1:97\n\n```\n```\n%home%\\unpack\\\nsakuralauncher_v2.0.1.2\n\\frpc.exe\n\n```\n```\n01:15:3e:7a:3c:8d:c5:0b:\n3d:23:c8:ba:31:d3:70:52\n\n```\n```\nsvchost.exe 01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\nfrpc.exe 01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\n               01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\nfrpc_windows_amd64.exe 01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\nfrpc.exe 0c:25:f1:f2:a8:d4:a2:93:\n               21:e8:28:6e:ed:50:e3:e2\n\n```\n```\nc:\\program\nfiles\\sakurafrplauncher\n\\frpc.exe\n\n```\n```\n01:15:3e:7a:3c:8d:c5:0b:\n3d:23:c8:ba:31:d3:70:52\n\n```\n```\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nHigh\nAssurance\nCode\nSigning\nCA-1\n\n```\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n\n-----\n\n```\n20200522\n10:23:03\n19700101\n00:00:00\n19700101\n00:00:00\n19700101\n00:00:00\n\n```\n```\n20200523\n06:16:00\n20201006\n16:28:00\n20210321\n09:12:00\n20201224\n19:02:00\n\n```\n```\nc43de22826a424b2\nd24cf1b4b694ce07\nd312a6aeffec3cff\n78e9fad141d3aaba\nd36084aad079ca8d\n91c2985eca80327b\ne086d7d5a5657800\na0d7e9c144fac16d\n\n```\n```\nSOGU\nLauncher\nFast\nReverse\nProxy\nFast\nReverse\nProxy\nFast\nReverse\nProxy\n\n```\n```\nAdobeHelp.exe 0c:59:d4:65:80:f0:39:af:\n               2c:4a:b6:ba:0f:fe:d1:97\nfrpc.exe 01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\n\n```\n```\nfrpc.exe 01:15:3e:7a:3c:8d:c5:0b:\n               3d:23:c8:ba:31:d3:70:52\n\n```\n```\nc:\\program\nfiles\\sakurafrplauncher\n\\frpc.exe\n\n```\n```\n01:15:3e:7a:3c:8d:c5:0b:\n3d:23:c8:ba:31:d3:70:52\n\n```\n```\nDigiCert\nHigh\nAssurance\nCode\nSigning\nCA-1\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\nDigiCert\nEV Code\nSigning\nCA\n\n```\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n大连纵梦网络科\n技有限公司\n\n\n### Suspicious Attestation Signed Samples\n\n#### The following list of MD5s are attestation signed binaries that have been identified as suspicious by numerous security solutions. While each one may not be directly malicious, they warrant an investigation should they be present in an environment.\n```\n 0080fde587d6aedccb08db1317360d32 ff985a86bfa60576a8e86b05603ac5fa b00c95692923b8c1e2d45c4a64a5ff05\n 00a7538086c266e8bcf8a0b1c2b6a2e4 62f289f3b55b0886c419a5077d11eb3c b0fea98c70e510f88b57f45a3f516326\n 00dd476fa04da76fc2ed37cfdde59875 63960dbc7d63767edb6e1e2dc6f0707b b164daf106566f444dfb280d743bc2f7\n 024e92733def0b1180f0ee54b81e5836 63d877650a3219f5991fd66bafc46bc5 b34403502499741762912c7bfc9ff21f\n 03710450e5bebd207bbe471c4685dc49 64a81238d20dcbd4b21abb609040f698 b44dfd8c5e7b0c8652d7a647dfe252e4\n 07bac50f875f09ad644827c8918e6837 66c145233576766013688088b03103e3 b500ee8d8cb045936d2996a1747bcded\n 07c4309678ce891fdd868e10c6e7aad4 66d2860a078fb11832ceef28b23481c2 b5c73db8e70d6f46ad9b693f3ce060d2\n 0ae78b90151ec2b0457bb0c2675048f5 67ff9de8e72c4dfdf4b4404abf253e7e b7239e06bcbe6e2c7bb2f7a859cbf4f7\n 0b4a0fe7db8400ef65ce7618177351cf 688c138fffbb4e7297289433c79d62f5 b83d8761748abb032ab5ae75519eaf71\n 0d0ffa28823276732a9e4dea5c25cc34 688ca3c12b63fec9f921334d24cf6f78 b849deae20052d72c3c623660fa97e64\n 14a1d3e07520df607635a3356877f5b9 6916b29893f618ba76b36bd8c297b7ac b8783155d6be5bb3a6d75edaa7ae7f71\n 14e6507566a404e3158b3e36314bb3a1 6a066d2be83cf83f343d0550b0b8f206 b9d40581ae936662c37f2edc979d7e99\n 1548b70d8581cbde703b1fb50b48a6a8 6a23d752fbc30e603bbb050a83a580eb ba9907be3a0752369082199ed126f8d8\n 163118c947aacd0978ad3e019c7d121f 6a893aab7b79b73da7a049c2707aabf1 bb46eb379caae3b05e32d3089c0dd6d0\n 179ca82f2e523be47df0dcebe808408d 6b0a733568d80be653fc9a568cdd88c5 bd25be845c151370ff177509d95d5add\n 198877a8ce99289f7281b1475c13ba9f 6c3180163e4a5371647e734c7c817de5 bf13a2f4e2deb62b7dee98a012e94d61\n 19d14bf80b3dc4e5b774b362f079a102 6c7479b5bb27f250fa32331b6457883a c0471f78648643950217620f6e7e24cc\n\n```\n\n-----\n\n```\n19d99758b1f33b418cb008530b61a1e7 6d32d2d7a44584c92115ac2a2c3ba3af c0debd2cfb62fc2c56bfd4104b1ff760\n1e63ec5b89edb805956f347b5b5cfaae 6e1bb443369973923c8eced16fcbd5cf c12d465743b9c167fc819b7872cd014c\n1f2888e57fdd6aee466962c25ba7d62d 6e3516775e7e009777dcdb7a314f1482 c35e6a0e1aef31ed9855499df4317acd\n1f46065ac9479253e4babc42b72bc4a8 6e730cf4ebcd166d26414378cab3a6d8 c5120095bf08655407c2f0215d10ac1d\n1f929fd617471c4977b522c71b4c91ed 6fcf56f6ca3210ec397e55f727353c4a c77e931a6388b2040cc7c5a1a0f56d93\n207cfc647647419adcfcc44c6059a1d1 7182ed3da406ba19bb9ffd8e4948d858 c7850060cfe574a2ef278ba46a136a5e\n20f94c9cfc3cf012bf90546985f9f3c4 721b40a0c2a0257443f7dcc2c697e28a c812fa7c628c3e19a3da5910acf6206e\n22519936cd9e8c7d524b0590826c3e6e 72dbbd1dd61c6b0c2571e83f2c3d1825 c8495649615bf1b9f839d7f357d6d02f\n228f9f0a0466fba21ac085626020a8e1 734b3a6e6cbd1f53fbb693140d2c3049 cadc3e4090aed708526f0d6016aba7fd\n22949977ce5cd96ba674b403a9c81285 761939b0e442821985ab3281f97e6ceb cb68b7979bbb55bbde0a8c60fe3e5184\n232b0156173a9f8f5db6b65aa91e923b 76c6ae0157ea7f41f55ed7e7d241f910 cb6a416204b57470fab0b944d7b59756\n23cebc6b0eb76262d796577895f418d2 7737e5e40a439899f326279b7face22c cbc3d1c88a5d0491b7b50bb77ada93fe\n24eb9eef69475e4980a555898b25f0c1 77392be5eae901ae371c37861aa88589 cc29cf2294175315acbf33054151f3cd\n262c92f2437c80adf232ef147ca2d734 787782e0395b3d5e32cda6fdea2faba0 cd4b6d8bb762c2281c9b1142588ede4c\n267c30e484322ad31fa9e1374d6653f0 79ebae9ab3f3b59c754ab1cc82bf7e95 ce455358bf71c88b45fcb5789100969a\n26caf3361ec353593f51ebbd3fe5bbde 7a5896673b81beb5589b512c6d781a85 ce4d3a69331ff87920c903a4e4091904\n26d6833b1875b138ea34d6ab430cafcd 7a9df5c46c7c65b807f78c6c0bb2c38c ce658935ef6e223893121dce22908655\n2739311a6bb1a7b0b88ff24bf603a54d 7b6e3fe75c5ae68d7d5a3ae7b00097e0 ce6ef4dc1dd54baddaa51eaf594a496a\n27bb03f2659cd95bf9e7af899ee32728 7ba744b584e28190eb03b9ecd1bb9374 d11b9a4664ea03dfe3e8e1d737cd15f8\n286b10451fe364310f4a7baeb0e94a3f 7c6c1b7e6378b4c0bcceee84e0e26fde d22a56e31b4e1fd5b06d46fa56f59151\n2a12b959c55f4a2d34f96e45e2417a71 7cb012393114dfb35d60e70166a97986 d27fac80339ad1f2ee86374884996c52\n2aa8dc7a5dff7817ce0a9c7cf30847bf 7d78b5773845c5189ca09227d27a9d5a d2ed678542a5d1db494dc47359861467\n2bec13be352db14fc9665ddf128deb8c 7dd800f100a049a72983dd75f5286d70 d47494b717c82eca8278dea610e1265d\n2cc14f20cf6847a2084f2c9cc0622015 7e0a6a234a64350e684544e272c7fc41 d60d8f3f12550dca4ba07ff61263b67f\n2d84c734d813af49cec3c3aa4aa4e6e3 7e2e29707e7a601e8ea7f3e2f4d672a2 d60e235b769cadbc7e83090b79b73ed3\n2e323c67a8781531a294684f7d2761ec 7e7002dc10c62fb674a3184f4ad6688a d617c9a86328921a8caf924575faf2a2\n2f6daca66d2f64c7b1b6f8693ea09cb7 7ee0b286003dc9e8006c22dcd70663f0 d66fc4e2f537566bb4d91cdea0ac64e5\n309f16f50e9074ce797eb38eda279298 7f9309f5e4defec132b622fadbcad511 d6b2947d8ff985fa84d697cc6cfdb7ff\n\n```\n\n-----\n\n```\n331113d1d54a3610f9c9bd72fc783721 811f8d76ff00c9eda27b51a0fb2b0d39 d6e506a1e0417c4507a5314529d84e34\n33b5485b35b33fd8ead5a38899522cce 822bbdec4e5630c3170ee05119dcfb5c d77209a21352486435d85e339596eeae\n3452586b669e12c1c4ee9db3c1006018 8264b3bdf46c0ece4f66151a613baed5 d87f08d1e50f2a3423813bf161b40859\n35c95b6b5f4a6a0bda56276846dae17b 832fe73a91993b387f9a49fafb9d4ea7 dc170d9bba14b0421c2514465055a93f\n35deaa9d004714dc6ef9661b91889148 84ce2a917e3d4aefcfc7d17e4a840a99 dc564bac7258e16627b9de0ce39fae25\n3608b3a24736dea4bf24a8ac5ae00e30 85063d67203b91bef9772446a1723021 dd1a5bd34f8cfa56e439c6fb275356d6\n37d4ba16136986bfded2b6fc698abf02 860f5812d65dc157a59c14e57bc0eaaf ddee86b84dcb72835b57b1d049e9e0cd\n395ea8b7d0f257850a3a04a1484bac4d 8986b5b6013cfb2bd3e6c8d22c453390 de4b5043c82ab3b36b4ae73a2e96d969\n398384a6cf2b7e26947d2e0acbfeeda5 8ac6ef2475ec89d3709fc124573cb380 e051141b1dcb9e7f889fea7c8b1d6ba5\n39ee31f03fe1bb93d47f560f73deffa9 8af6a129902a594ddaceafba38b7c060 e0e0c46ba4f969919e2879717c60ef2a\n3d4b685dcaebc5bba5f9421572a4ab91 8b423e0395ba6419fcedc0701327c97c e2465ea5c2d5dac4ae1b8d50da1d7cce\n3db8146544ee26866a8e99bacb11188c 8d38a092ae5a3511bedadb7243a84409 e2c146a2522e4f40e5036c3fe12c3560\n3ecaf3ba4e93916714cc43320f6f2c58 8e4d0f679b092296a2f74cf812907d05 e30830c05ed3d2a3178a3678f3169bec\n3fd815ebb7d2ab2b62cff3c777b51e30 8fc8c6e1b2a1047752f60549878fb55f e5f62ef06b0dd656e1e47913f01f9f8a\n4070a8b16f318d108be0984e628421ad 909f3fc221acbe999483c87d9ead024a e6960ae657786979493da1786191bcf4\n40fda9a3c1be41be414f3795b25647f5 90affc996a2932cb0fec4e31cd673ae9 e777e5a8d2ba97c82128f04272e7841c\n415240633837ebcbd80e080ba99c03a9 90b9a4328c4f712815760f9da49bcb6a e7ff38a94ad765eb305fc7f0837f5913\n42200c8422347f63b3edb45ea5aa9c45 913d50851abf337abc3c73f2d4e7fb34 ea033ee6df904d863448ffef6386b6ae\n42a417e54639c69f033f72bbafe6e09a 929b293090bcc7900c1e8f9ba519e219 ea45419d992c15002c93067840568121\n4349378822e2316f18784c10c7ca08a1 934d0cda4cba428e9b75ff16d5f4b0b1 ea5f6ab5666193f805d13a49009f0699\n45991757d4ca2dab9e81f2fcbbc1ae23 93c5faf90bc889963f10c608cbde5a14 ee3bad1f5508e2129e0b423b009383e3\n45be5c0e7dfe37f88f1fa6c2fbb462c5 947ebc3f481a7b9ee3cf3a34d9830159 ee6b1a79cb6641aa44c762ee90786fe0\n467e60b9a0d1153057e0cfd0e721e198 95a04866e6afb8e9b0426f5890681f9a f07506c30237c96e49eecafa0e5a4ed4\n48190fd615dcea5c6679b8e30a8bfec0 9885d56d64ac2391a43f02abb2202181 f111bd9b8e55f60f909649820e116430\n486b1afce3484a784a1662513ca1272a 9a8323bc7187441a0d85b9a2e8f580e3 f35a8a8f36c13769b9e9fff05fa4f720\n48bf11dd6c22e241b745d3bb1d562ca1 9c4034691f6508e2361b6fca890671f9 f4ee6bee04b2ed18024e3a64a0d58385\n48fc05c42549d0b3ec9e73bbb5be40dc 9d1424c87d89095e3cd6785adb54d2ec f59a1409ce773658e72ad73424841890\n4a0f22286134a58d9d20f911a608f636 9dabf30a780794200cd068b145730317 f783277840bbd2023879a87d0788f36e\n\n```\n\n-----\n\n```\n 4b2e59a821589ab091a63770f4a658ed 9e91e55c89f9c17c0a2acaf4376cd72b f78915cbf89d8749a0a4ab18a2b182bd\n 4d4c17d8b52cd89da0b17cc9653b2010 9f1d60d3cddea7f7558fad0217759094 f8ccabcbe08bbd2c8420f4d1cffcefd8\n 4d947e4163e8aeafbfc626eb033bc665 a0fdc4543687a1b341b365d6dd16551c f9844524fb0009e5b784c21c7bad4220\n 4e1f656001af3677856f664e96282a6f a2ee1cc9e80390ca248863004adbde60 f9aad310a5d5c80bbc61d10cc797e4f0\n 4e8d5c44bfdeffd0168f8a05f6a04e8b a2f3bce86beef23aede69396dcf7e184 fa00cc96c5bea2979a59d0da0d22c83d\n 4f5c7367f2ebae0097b6f2f1bebd19b6 a55cb8be2887e99b4f662fc1ae08d265 fa914061f5a40b324454d3fb9fc85ca5\n 508d42f26f8bd562728e6fca866e05eb a7251aad1e81c6194b34dabf6edd6b4a faa5806826ff1ba749b70de0e14835c3\n 50d13758b811c794bc13769ee3b42e85 a9541530619a3ac2615b92603b705fe6 fbd9ba2b8b2d677d41c30a01c02cfd01\n 52494f624378ef6ee298f0fc73082d0e aba1be25da0691761f593725e9c067e5 fd3b7234419fafc9bdd533f48896ed73\n 52fc9ec7a5c177fe27fb00b6c2c5ff09 ac2a1f2ae6b547619bef93dfadb48937 fd4cee1c7b8167f25a8b4b864ede3c5d\n 548d48b658305ffb77cc814ea080b542 ac7f0fcb6040eb47ea9855d418c32510 fdb6dae1e8c182089fdb86996436330c\n 561bc6902367d9e43e27c5543e7a5818 acac842a46f3501fe407b1db1b247a0b fe2f8e46ae540d7299c61ba083d52399\n 5800a88d39fdf63e5a43bfcc6700d907 adab615712eac2719691d01b69254f29 fe7ecd399eec7036a63f0b7eb5ebcfb1\n 5b281df4aaa915f660e075dc944a02c2 add02792cfff7b19b8e526a247acb0ba ff43f91f2465504e5e67d0b37d92ef18\n 5e5d9971c90287a6aa905e54b2a21b1c ae2f3e2412925a767e372c9c0ccf7ced\n\n## Appendix C: POORTRY Certificate Details\n\n#### The following certificate details are extracted from the certificate signing to the POORTRY sample. However, note that this is a legitimate attestation signing Microsoft certificate. Note that some details were removed for brevity.\n\n```\n\n-----\n\n```\nCertificate:\n  Data:\n    Version: 3 (0x2)\n    Serial Number:\n      33:00:00:00:57:ee:4d:65:9a:92:3e:7c:10:00:00:00:00:00:57\n    Signature Algorithm: sha256WithRSAEncryption\n    Issuer: C = US, ST = Washington, L = Redmond, O = Microsoft Corporation, CN = Microsoft Windows Third Party\nComponent CA 2014\n    Validity\n      Not Before: Jun 7 18:08:06 2022 GMT\n      Not After : Jun 1 18:08:06 2023 GMT\n    Subject: C = US, ST = Washington, L = Redmond, O = Microsoft Corporation, CN = Microsoft Windows Hardware\nCompatibility Publisher\n    Subject Public Key Info:\n      Public Key Algorithm: rsaEncryption\n        RSA Public-Key: (2048 bit)\n        Exponent: 65537 (0x10001)\n    X509v3 extensions:\n      X509v3 Extended Key Usage:\n        1.3.6.1.4.1.311.10.3.5, 1.3.6.1.4.1.311.10.3.5.1, Code Signing\n      X509v3 Subject Key Identifier:\n        41:8F:FB:78:B4:1F:1F:7F:19:8E:36:12:08:D0:22:76:6B:58:FA:29\n      X509v3 Subject Alternative Name:\n        DirName:/OU=Microsoft Operations Puerto Rico/serialNumber=232147+470769\n      X509v3 Authority Key Identifier:\n        keyid:C8:3A:9C:A7:4A:C3:23:F2:25:7E:B9:DA:AB:29:53:0E:54:00:C3:A1\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-13 - I Solemnly Swear My Driver Is Up to No Good- Hunting for Attestation Signed Malware.pdf"
    ],
    "report_names": [
        "2022-12-13 - I Solemnly Swear My Driver Is Up to No Good- Hunting for Attestation Signed Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "c3b908de-3dd1-4e5d-ba24-5af8217371f0",
            "created_at": "2023-10-03T02:00:08.510742Z",
            "updated_at": "2025-03-27T02:00:03.139677Z",
            "deleted_at": null,
            "main_name": "Scattered Spider",
            "aliases": [
                "Scatter Swine",
                "Storm-0971",
                "UNC3944",
                "Scattered Swine",
                "Octo Tempest",
                "0ktapus",
                "DEV-0971",
                "Starfraud",
                "Muddled Libra",
                "Oktapus"
            ],
            "source_name": "MISPGALAXY:Scattered Spider",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c416260c-7ff6-4a74-a5ba-a15f40d3543f",
            "created_at": "2024-05-01T02:03:07.939268Z",
            "updated_at": "2025-03-27T02:05:17.25652Z",
            "deleted_at": null,
            "main_name": "BRONZE DUDLEY",
            "aliases": [
                "Temp.Hex ",
                "Vicious Panda ",
                "TA428 "
            ],
            "source_name": "Secureworks:BRONZE DUDLEY",
            "tools": [
                "PoisonIvy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1691c25f-1aa4-4168-8ce2-7aa8f23246e7",
            "created_at": "2024-06-04T02:03:07.724221Z",
            "updated_at": "2025-03-27T02:05:17.284601Z",
            "deleted_at": null,
            "main_name": "BRONZE PRESIDENT",
            "aliases": [
                "Mustang Panda ",
                "Red Lich ",
                "Temp.Hex ",
                "HoneyMyte "
            ],
            "source_name": "Secureworks:BRONZE PRESIDENT",
            "tools": [
                " Cobalt Strike",
                " ORat",
                " PlugX",
                " RCSession",
                "China Chopper"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e424a2db-0f5a-4ee5-96d2-5ab16f1f3824",
            "created_at": "2024-06-19T02:03:08.062614Z",
            "updated_at": "2025-03-27T02:05:17.373121Z",
            "deleted_at": null,
            "main_name": "GOLD HARVEST",
            "aliases": [
                "Scatter Swine ",
                "Scattered Spider ",
                "UNC3944 ",
                "Roasted 0ktapus "
            ],
            "source_name": "Secureworks:GOLD HARVEST",
            "tools": [
                " ConnectWise Control",
                " LogMeIn",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2ee03999-5432-4a65-a850-c543b4fefc3d",
            "created_at": "2022-10-25T16:07:23.882813Z",
            "updated_at": "2025-03-27T02:02:10.0116Z",
            "deleted_at": null,
            "main_name": "Mustang Panda",
            "aliases": [
                "Bronze President",
                "Camaro Dragon",
                "Earth Preta",
                "HoneyMyte",
                "Mustang Panda",
                "Operation SMUGX",
                "Operation SmugX",
                "PKPLUG",
                "Red Lich",
                "Stately Taurus",
                "TEMP.Hex"
            ],
            "source_name": "ETDA:Mustang Panda",
            "tools": [
                "9002 RAT",
                "AdFind",
                "Agent.dhwf",
                "Agentemis",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "ClaimLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "DCSync",
                "DOPLUGS",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Farseer",
                "Gen:Trojan.Heur.PT",
                "HOMEUNIX",
                "Hdump",
                "HenBox",
                "HidraQ",
                "Hodur",
                "Homux",
                "HopperTick",
                "Hydraq",
                "Impacket",
                "Kaba",
                "Korplug",
                "LadonGo",
                "MQsTTang",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "NBTscan",
                "NetSess",
                "Netview",
                "Orat",
                "POISONPLUG.SHADOW",
                "PUBLOAD",
                "PVE Find AD Users",
                "PlugX",
                "Poison Ivy",
                "PowerView",
                "QMAGENT",
                "RCSession",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Sogu",
                "TIGERPLUG",
                "TONEINS",
                "TONESHELL",
                "TVT",
                "TeamViewer",
                "Thoper",
                "TinyNote",
                "WispRider",
                "WmiExec",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "cobeacon",
                "nbtscan",
                "nmap",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d093e8d9-b093-47b8-a988-2a5cbf3ccec9",
            "created_at": "2023-10-14T02:03:13.99057Z",
            "updated_at": "2025-03-27T02:02:09.728121Z",
            "deleted_at": null,
            "main_name": "Scattered Spider",
            "aliases": [
                "0ktapus",
                "LUCR-3",
                "Muddled Libra",
                "Octo Tempest",
                "Scatter Swine",
                "Scattered Spider",
                "Star Fraud",
                "Storm-0875",
                "UNC3944"
            ],
            "source_name": "ETDA:Scattered Spider",
            "tools": [
                "ADRecon",
                "AnyDesk",
                "ConnectWise",
                "DCSync",
                "FiveTran",
                "FleetDeck",
                "Govmomi",
                "Hekatomb",
                "Impacket",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "Lumma Stealer",
                "LummaC2",
                "Mimikatz",
                "Ngrok",
                "PingCastle",
                "ProcDump",
                "PsExec",
                "Pulseway",
                "Pure Storage FlashArray",
                "Pure Storage FlashArray PowerShell SDK",
                "RedLine Stealer",
                "Rsocx",
                "RustDesk",
                "ScreenConnect",
                "SharpHound",
                "Socat",
                "Spidey Bot",
                "Splashtop",
                "Stealc",
                "TacticalRMM",
                "Tailscale",
                "TightVNC",
                "VIDAR",
                "Vidar Stealer",
                "WinRAR",
                "WsTunnel",
                "gosecretsdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535775,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1672274395,
    "ts_modification_date": 1672274395,
    "files": {
        "pdf": "https://archive.orkl.eu/34ce76b4c7a47ad674ac2ccea1bd8de37ee354dc.pdf",
        "text": "https://archive.orkl.eu/34ce76b4c7a47ad674ac2ccea1bd8de37ee354dc.txt",
        "img": "https://archive.orkl.eu/34ce76b4c7a47ad674ac2ccea1bd8de37ee354dc.jpg"
    }
}