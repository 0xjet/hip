{
    "id": "5eefadcf-65ce-41d5-8bac-73d10fecf058",
    "created_at": "2022-10-25T16:48:12.625457Z",
    "updated_at": "2025-03-27T02:11:53.058202Z",
    "deleted_at": null,
    "sha1_hash": "54840544c79d24dace32a7a4caa8678036b4f7e7",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-12-13T02:34:49Z",
    "file_modification_date": "2019-12-13T02:34:49Z",
    "file_size": 466722,
    "plain_text": "# GALLIUM: Targeting global telecom\n\n**[microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom](https://www.microsoft.com/security/blog/2019/12/12/gallium-targeting-global-telecom/)**\n\nDecember 12, 2019\n\nMicrosoft Threat Intelligence Center (MSTIC) is raising awareness of the ongoing activity by a\ngroup we call GALLIUM, targeting telecommunication providers. When Microsoft customers have\nbeen targeted by this activity, we notified them directly with the relevant information they need to\nprotect themselves. By sharing the detailed methodology and indicators related to GALLIUM\nactivity, we’re encouraging the security community to implement active defenses to secure the\nbroader ecosystem from these attacks.\n\nTo compromise targeted networks, GALLIUM target unpatched internet-facing services using\npublicly available exploits and have been known to target vulnerabilities in WildFly/JBoss. Once\npersistence is established in a network, GALLIUM uses common techniques and tools like\nMimikatz to obtain credentials that allows for lateral movement across the target network. Within\ncompromised networks, GALLIUM makes no attempt to obfuscate their intent and are known to\nuse common versions of malware and publicly available toolkits with small modifications. The\noperators rely on low cost and easy to replace infrastructure that consists of dynamic-DNS\ndomains and regularly reused hop points.\n\nThis activity from GALLIUM has been identified predominantly through 2018 to mid-2019.\nGALLIUM is still active; however, activity levels have dropped when compared to what was\npreviously observed.\n\nFollowing Microsoft’s internal practices of assigning chemical elements to activity groups,\nGALLIUM is the code name for this activity group.\n\n## GALLIUM’s profile\n\n**Reconnaissance methods**\n\n\n-----\n\nAs is often the case with the reconnaissance methods, it’s difficult to be definitive about those\nemployed by GALLIUM. This is due to the passive nature of reconnaissance activities by the\nactor including the use of freely available data from open sources, such as public websites and\nsocial media outlets. However, based on MSTIC analyst assessments, GALLIUM’s exploitation of\ninternet-facing services indicates it’s likely they use open source research and network scanning\ntools to identify likely targets.\n\n## Delivery and exploitation\n\nTo gain initial access a target network, GALLIUM locates and exploits internet-facing services\nsuch as web servers. GALLIUM has been observed exploiting unpatched web services, such as\nWildFly/JBoss, for which exploits are widely available. Compromising a web server gives\nGALLIUM a foothold in the victim network that doesn’t require user interaction, such as traditional\ndelivery methods like phishing.\n\n[Following exploitation of the web servers, GALLIUM actors typically install web shells, and then](https://attack.mitre.org/techniques/T1100/)\ninstall additional tooling to allow them to explore the target network.\n\n**Lateral movement**\n\nGALLIUM uses a variety of tools to perform reconnaissance and move laterally within a target\nnetwork. The majority of these are off-the-shelf tools or modified versions of known security tools.\nMSTIC investigations indicate that GALLIUM modifies its tooling to the extent it evades\nantimalware detections rather than develop custom functionality. This behavior has been\nobserved with GALLIUM actors across several operational areas.\n\nGALLIUM has been observed using several tools. Samples of the most prevalent are noted in\nTable 1.\n\n### Tool Purpose\n\n HTRAN Connection bouncer to proxy connections.\n\n Mimikatz Credential dumper.\n\n NBTScan Scanner for open NETBIOS nameservers on a local or re‐ mote TCP/IP network.\n\n Netcat Reads from and writes to network connections using TCP or UDP protocols.\n\n PsExec Executes a command line process on a remote machine.\n\n\n### Windows Credential Edi‐ tor (WCE)\n\n\n### Credential dumper.\n\n\n### WinRAR Archiving utility.\n\n_Table 1: GALLIUM tooling._\n\n\n-----\n\nGALLIUM has signed several tools using stolen code signing certificates. For example, they’ve\nused a credential dumping tool signed using a stolen certificate from Whizzimo, LLC, as shown in\nFigure 1. The code signing certificate shown in Figure 1 was no longer valid at the time of writing;\nhowever, it shows GALLIUM had access to such certificates.\n\n_Figure 1. Credential dumping tool signed using a stolen Whizzimo, LLC certificate._\n\nGALLIUM primarily relies on compromised domain credentials to move through the target\nnetwork, and as outlined above, uses several credential harvesting tools. Once they have\nacquired credentials, the activity group uses PsExec extensively to move laterally between hosts\nin the target network.\n\n**Installation**\n\nGALLIUM predominantly uses widely available tools. In certain instances, GALLIUM has modified\nthese tools to add additional functionality. However, it’s likely these modifications have been made\nto subvert antimalware solutions since much of the malware and tooling employed by GALLIUM is\n[historic and is widely detected by security products. For example, QuarkBandit is a modified](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/QuarkBandit.A!dha)\nversion of the widely used Gh0st RAT, an openly available remote access tool (RAT). Similarly,\n[GALLIUM has made use of a modified version of the widely available Poison Ivy RAT. These](https://www.cyber.nj.gov/threat-profiles/trojan-variants/poison-ivy)\n[RATs and the China Chopper web shell form the basis of GALLIUM’s toolkit for maintaining](https://attack.mitre.org/software/S0020/)\naccess to a victim network.\n\n**Infrastructure**\n\nGALLIUM predominantly uses dynamic DNS subdomains to provide command and control (C2)\ninfrastructure for their malware. Typically, the group uses the ddns.net and myftp.biz domains\nprovided by noip.com. MSTIC analysis indicates the use of dynamic DNS providers as opposed\nto registered domains is in line with GALLIUM’s trend towards low cost and low effort operations.\n\nGALLIUM domains have been observed hosted on infrastructure in mainland China, Hong Kong\nSAR, and Taiwan.\n\nWhen connecting to web shells on a target network GALLIUM has been observed employing\nTaiwan-based servers. Observed IP addresses appear to be exclusive to GALLIUM, have little to\nno legitimate activity, and are reused in multiple operations. These servers provide high fidelity\n\n\n-----\n\npivot points during an investigation.\n\nA package of GALLIUM indicators containing GALLIUM command and control domains used\n[during this operation have been prepared for Azure Sentinel and is available on the Microsoft](https://azure.microsoft.com/en-us/services/azure-sentinel/)\nGitHub.\n\n_Figure 2. Azure Sentinel query of GALLIUM indicators._\n\n## GALLIUM use of malware\n\n**First stage**\n\nGALLIUM does not typically use a traditional first stage installer for their malware. Instead, the\ngroup relies heavily on web shells as a first method of persistence in a victim network following\nsuccessful exploitation. Subsequent malware is then delivered through existing web shell access.\n\nMicrosoft Defender Advanced Threat Protection (ATP) exposes anomalous behavior that indicate\nweb shell installation and post compromise activity by analysing script file writes and process\n[executions. Microsoft Defender ATP offers a number of detections for web shell activity protecting](https://www.microsoft.com/en-us/microsoft-365/windows/microsoft-defender-atp)\n\n\n-----\n\ncustomers not just from GALLIUM activity but broader web shell activity too. Read the full report\n[in your Microsoft Defender ATP portal.](https://securitycenter.windows.com/threatanalytics2/52fd70be-ec19-48d7-84e8-dfb7a0ed7123)\n\n_Figure 3. Microsoft Defender ATP web shell detection._\n\nWhen alerted of these activities, the security operations team can then use the rich capabilities in\nMicrosoft Defender ATP to investigate web shell activity and subsequent reconnaissance and\nenumeration activity to resolve web shell attacks.\n\n_Figure 4. Microsoft Defender ATP web shell process tree._\n\n[In addition to standard China Chopper, GALLIUM has](https://attack.mitre.org/software/S0020/)\nbeen observed using a native web shell for servers\nrunning Microsoft IIS that is based on the China Chopper\nweb shell; Microsoft has called this “BlackMould.”\n\nBlackMould contains functionality to perform the\nfollowing tasks on a victim host:\n\nEnumerate local drives.\nEmploy basic file operations like find, read, write,\ndelete, and copy.\nSet file attributes.\nExfiltrate and infiltrate files.\nRun cmd.exe with parameters.\n\nCommands are sent in the body of HTTP POST\nrequests.\n\n**Second stage**\n\n\n-----\n\nIn cases where GALLIUM has deployed additional malware on a victim network, they’ve used\n[versions of the Gh0st RAT (modified Ghost RAT detected as QuarkBandit) and Poison Ivy](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/QuarkBandit.A!dha)\nmalware. In both cases, GALLIUM has modified the communication method used by the malware,\nlikely to prevent detection through existing antimalware signatures since both malware families\nhave several detections based on their original communication methods. Malware families are\nnoted in Table 2.\n\n\n### Mal‐ ware family\n\n Black‐ Mould\n\n China Chop‐ per\n\n Poison Ivy (modi‐ fied)\n\n Quark‐ Bandit\n\n\n### Description and primary usage\n\n Native IIS web shell based on the China Chopper web shell.\n\n Commonly used and widely shared web shell used by several threat actors. Not unique to GALLIUM.\n\n Poison Ivy is a widely shared remote access tool (RAT) first identified in 2005. While Poison Ivy is widely used, the variant GALLIUM has been observed us‐ ing is a modified version that appears to be unique to GALLIUM.\n\n Gh0st RAT variant with modified configuration options and encryption.\n\n\n_Table 2. GALLIUM malware families._\n\nGALLIUM’s malware and tools appear to be highly disposable and low cost. In cases where\nGALLIUM has invested in modifications to their toolset, they appear to focus on evading\nantimalware detection, likely to make the malware and tooling more effective.\n\nThe MSTIC team works closely with Microsoft security products to implement detections and\nprotections for GALLIUM malware and tooling in a number of Microsoft products. Figure 4 shows\none such detection for a GALLIUM PoisonIvy loader in Microsoft Defender ATP.\n\n_Figure 5. GALLIUM PoisonIvy loader in Microsoft Defender ATP._\n\n\n-----\n\nAdditionally, MSTIC has authored a number of antimalware signatures for Windows Defender\nAntivirus covering the aforementioned malware families, a list of GALLIUM exclusive signature\ncan be found in the Related indicators” section.\n\nIn addition to these malware families, GALLIUM has been observed employing SoftEther VPN\nsoftware to facilitate access and maintain persistence to a target network. By installing SoftEther\non internal systems, GALLIUM is able to connect through that system as though they are on the\ninternal network of the target. SoftEther provides GALLIUM with another means of persistence\nand flexibility with the added benefit that its traffic may appear to be benign on the target network.\n\n## Recommended defenses\n\nThe following are recommended defenses security operations teams can take to mitigate the\nimpact of threats like GALLIUM in your corporate environment:\n\nMaintain web server patching and log audits, run web services with minimum required\noperating system permissions\nInstall security updates on all applications and operating systems promptly. Check the\n[Security Update Guide for detailed information about available Microsoft security updates.](https://portal.msrc.microsoft.com/)\nFor efficient incident response, maintain a forensics-ready network with centralized event\nlogging, file detonation services, and up-to-date asset inventories.\nEnable cloud-delivered protection and maintain updated antivirus.\nTurn on cloud-delivered protection and automatic sample submission on Windows\nDefender Antivirus. These capabilities use artificial intelligence (AI) and machine learning to\nquickly identify and stop new and unknown threats.\nUse behavior detection solutions to catch credential dumping or other activity that may\nindicate a breach.\n[Adopt Azure ATP—a cloud-based security solution that leverages your on-premises Active](https://docs.microsoft.com/en-us/azure-advanced-threat-protection/what-is-atp)\nDirectory signals—to identify, detect, and investigate advanced threats, compromised\nidentities, and malicious insider actions directed at your organization.\n[Use Microsoft Defender ATP to help enterprise networks prevent, detect, investigate, and](https://docs.microsoft.com/en-us/windows/security/threat-protection/microsoft-defender-atp/microsoft-defender-advanced-threat-protection)\nrespond to advanced threats. Educate users about protecting personal and business\ninformation in social media, filtering unsolicited communication, identifying lures in spearphishing email and watering holes, and reporting of reconnaissance attempts and other\nsuspicious activity.\nEncourage users to use Microsoft Edge and other web browsers that support SmartScreen,\nwhich identifies and blocks malicious websites, including phishing sites, scam sites, and\nsites that contain exploits and host malware.\nInstitute Multi-Factor Authentication (MFA) to mitigate against compromised accounts.\n\n**Note: Microsoft strongly encourages all customers download and use passwordless**\n[solutions like the Microsoft Authenticator app or Windows Hello to secure your](https://www.microsoft.com/en-us/account/authenticator/)\naccounts.\n[For Office 365 users, see MFA support.](https://docs.microsoft.com/en-us/office365/admin/security-and-compliance/set-up-multi-factor-authentication?view=o365worldwide)\n[For consumer and personal email accounts, see how to use two-step verification.](https://support.microsoft.com/en-us/help/12408/microsoft-account-how-to-use-two-step-verification)\n\n## Related indicators\n\n\n-----\n\nThe list below provides known GALLIUM tooling and Indicators of Compromise (IOCs) observed\nduring this activity. Microsoft encourages customers to implement detections and protections to\nidentify possible prior campaigns or prevent future campaigns against their systems.\n\n**Tooling**\n\n### Tool Purpose\n\n HTRAN Connection bouncer to proxy connections.\n\n Mimikatz Credential dumper.\n\n NBTScan Scanner for open NETBIOS nameservers on a local or re‐ mote TCP/IP network.\n\n Netcat Reads from and writes to network connections using TCP or UDP protocols.\n\n PsExec Executes a command line process on a remote machine.\n\n\n### Windows Credential Edi‐ tor (WCE)\n\n\n### Credential dumper.\n\n\n### WinRAR Archiving utility.\n\n**Malware**\n\n\n### Mal‐ ware\n\n Black‐ Mould\n\n China Chop‐ per\n\n Poison Ivy (modi‐ fied)\n\n Quark‐ Bandit\n\n**Indicators**\n\n\n### Notes\n\n Native IIS version of the China Chopper web shell.\n\n Commonly used and widely shared web shell used by several threat actors. Not unique to GALLIUM.\n\n Poison Ivy is a widely shared remote access tool (RAT) first identified in 2005. While Poison Ivy is widely used, the variant GALLIUM has been observed us‐ ing is a modified version which appears to be unique to GALLIUM.\n\n Gh0st RAT variant with modified configuration options and encryption.\n\n\n### Indicator Type\n\n asyspy256[.]ddns[.]net Domain\n\n hotkillmail9sddcc[.]ddns[.]net Domain\n\n\n-----\n\n### rosaf112[.]ddns[.]net Domain\n\n cvdfhjh1231[.]myftp[.]biz Domain\n\n sz2016rose[.]ddns[.]net Domain\n\n dffwescwer4325[.]myftp[.]biz Domain\n\n cvdfhjh1231[.]ddns[.]net Domain\n\n 9ae7c4a4e1cfe9b505c3a47e66551eb1357affee65bfefb0109d02f4e97c06dd Sha256\n\n\n### 7772d624e1aed327abcd24ce2068063da0e31b‐ b1d5d3bf2841fc977e198c6c5b\n\n 657fc7e6447e0065d488a7db2caab13071e44741875044f9024‐ ca843fe4e86b5\n\n 2ef157a97e28574356e1d871abf75deca7d7a1ea662f38b577a06dd039d‐ bae29\n\n\n### Sha256\n\n Sha256\n\n Sha256\n\n\n### 52fd7b90d7144ac448af4008be639d4d45c252e51823f4311011af3207a5fc77 Sha256\n\n\n### a370e47cb97b35f1ae6590d14ada7561d22b4a73be0cb6d‐ f7e851d85054b1ac3\n\n 5bf80b871278a29f356bd42af1e35428aead20cd90b0c7642247af‐ caaa95b022\n\n 6f690c‐ cfd54c2b02f0c3cb89c938162c10cbeee693286e809579c540b07ed883\n\n 3c884f776fbd16597c072afd81029e8764dd57ee79d798829ca111f5e170b‐ d8e\n\n 1922a419f57afb351b58330ed456143cc8de8b3ebcb‐ d236d26a219b03b3464d7\n\n\n### Sha256\n\n Sha256\n\n Sha256\n\n Sha256\n\n Sha256\n\n\n### fe0e4ef832b62d49b43433e10c47dc51072959af93963c790892efc20ec422f1 Sha256\n\n\n### 7ce9e1c5562c8a5c93878629a47fe6071a35d604ed57a8f918f3ead‐ f82c11a9c\n\n 178d5ee8c04401d332af331087a80fb4e5e2937edf‐ ba7266f9be34a5029b6945\n\n 51f70956‐ fa8c487784fd21ab795f6ba2199b5c2d346acdeef1de0318a4c729d9\n\n 889bca95f1a69e94aaade1e959ed0d3620531d‐ c0fc563be9a8decf41899b4d79\n\n 332ddaa00e2eb862742cb8d7e24ce52a5d38ffb22f6c8bd51162b‐ d35e84d7ddf\n\n\n### Sha256\n\n Sha256\n\n Sha256\n\n Sha256\n\n Sha256\n\n\n-----\n\n### 44bcf82fa536318622798504e8369e9dcdb32686b95fcb44579f0b4efa79df08 Sha256\n\n 63552772fdd8c947712a2cff00dfe25c7a34133716784b6d486227384f8cf3ef Sha256\n\n 056744a3c371b5938d63c396fe094afce8fb153796a65afa5103e1bffd7ca070 Sha256\n\n TrojanDropper:Win32/BlackMould.A!dha Signa‐ ture Name\n\n Trojan:Win32/BlackMould.B!dha Signa‐ ture Name\n\n Trojan:Win32/QuarkBandit.A!dha Signa‐ ture Name\n\n Trojan:Win32/Sidelod.A!dha Signa‐ ture Name\n\n[Bookmark the Security blog to keep up with our expert coverage on security matters. Also, follow](https://www.microsoft.com/security/blog/)\n[us at @MSFTSecurity for the latest news and updates on cybersecurity.](https://twitter.com/@MSFTSecurity)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.12.12.GALLIUM/GALLIUM_%20Targeting%20global%20telecom.pdf"
    ],
    "report_names": [
        "GALLIUM_ Targeting global telecom"
    ],
    "threat_actors": [
        {
            "id": "9faf32b7-0221-46ac-a716-c330c1f10c95",
            "created_at": "2022-10-25T16:07:23.652281Z",
            "updated_at": "2025-03-27T02:02:09.908624Z",
            "deleted_at": null,
            "main_name": "Gallium",
            "aliases": [
                "Alloy Taurus",
                "Granite Typhoon",
                "Phantom Panda"
            ],
            "source_name": "ETDA:Gallium",
            "tools": [
                "Agentemis",
                "BlackMould",
                "CHINACHOPPER",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "Gh0stCringe RAT",
                "HTran",
                "HUC Packet Transmit Tool",
                "LaZagne",
                "Mimikatz",
                "NBTscan",
                "PingPull",
                "Plink",
                "Poison Ivy",
                "PsExec",
                "PuTTY Link",
                "QuarkBandit",
                "Quasar RAT",
                "QuasarRAT",
                "Reshell",
                "SPIVY",
                "SinoChopper",
                "SoftEther VPN",
                "Sword2033",
                "WCE",
                "WinRAR",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Yggdrasil",
                "cobeacon",
                "nbtscan",
                "netcat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7bf3ffe5-09ba-4378-8ea4-a6d748a494fd",
            "created_at": "2022-10-25T15:50:23.264584Z",
            "updated_at": "2025-03-27T02:00:55.414817Z",
            "deleted_at": null,
            "main_name": "GALLIUM",
            "aliases": [
                "GALLIUM",
                "Granite Typhoon"
            ],
            "source_name": "MITRE:GALLIUM",
            "tools": [
                "ipconfig",
                "cmd",
                "China Chopper",
                "PoisonIvy",
                "at",
                "PlugX",
                "PingPull",
                "BlackMould",
                "Mimikatz",
                "PsExec",
                "HTRAN",
                "NBTscan",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c87ee2df-e528-4fa0-bed6-6ed29e390688",
            "created_at": "2023-01-06T13:46:39.150432Z",
            "updated_at": "2025-03-27T02:00:03.008665Z",
            "deleted_at": null,
            "main_name": "GALLIUM",
            "aliases": [
                "Red Dev 4",
                "Alloy Taurus",
                "Granite Typhoon"
            ],
            "source_name": "MISPGALAXY:GALLIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041513,
    "ts_creation_date": 1576204489,
    "ts_modification_date": 1576204489,
    "files": {
        "pdf": "https://archive.orkl.eu/54840544c79d24dace32a7a4caa8678036b4f7e7.pdf",
        "text": "https://archive.orkl.eu/54840544c79d24dace32a7a4caa8678036b4f7e7.txt",
        "img": "https://archive.orkl.eu/54840544c79d24dace32a7a4caa8678036b4f7e7.jpg"
    }
}