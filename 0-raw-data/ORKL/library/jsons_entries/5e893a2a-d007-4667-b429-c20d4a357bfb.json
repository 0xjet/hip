{
    "id": "5e893a2a-d007-4667-b429-c20d4a357bfb",
    "created_at": "2023-01-12T15:00:18.275305Z",
    "updated_at": "2025-03-27T02:16:25.663262Z",
    "deleted_at": null,
    "sha1_hash": "db5a00537dc46d73b3885dfe9a09866c13f8bdda",
    "title": "2016-02-18 - New Android Trojan “Xbot” Phishes Credit Cards and Bank Accounts, Encrypts Devices for Ransom",
    "authors": "",
    "file_creation_date": "2022-05-29T10:47:54Z",
    "file_modification_date": "2022-05-29T10:47:54Z",
    "file_size": 1235734,
    "plain_text": "# New Android Trojan “Xbot” Phishes Credit Cards and Bank Accounts, Encrypts Devices for Ransom\n\n**researchcenter.paloaltonetworks.com/2016/02/new-android-trojan-xbot-phishes-credit-cards-and-bank-accounts-**\nencrypts-devices-for-ransom/\n\nCong Zheng, Claud Xiao, Zhi Xu February 18, 2016\n\nBy [Cong Zheng,](https://unit42.paloaltonetworks.com/author/cong-zheng/) [Claud Xiao and](https://unit42.paloaltonetworks.com/author/claud-xiao/) [Zhi Xu](https://unit42.paloaltonetworks.com/author/zhi-xu/)\n\nFebruary 18, 2016 at 4:00 PM\n\n[Category: Financial Services,](https://unit42.paloaltonetworks.com/category/financial-services/) [Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Threat Prevention,](https://unit42.paloaltonetworks.com/category/threat-prevention-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [Android,](https://unit42.paloaltonetworks.com/tag/android/) [apps,](https://unit42.paloaltonetworks.com/tag/apps/) [AutoFocus,](https://unit42.paloaltonetworks.com/tag/autofocus/) [banking,](https://unit42.paloaltonetworks.com/tag/banking/) [Google Play,](https://unit42.paloaltonetworks.com/tag/google-play/) [IPS,](https://unit42.paloaltonetworks.com/tag/ips/) [JavaScript,](https://unit42.paloaltonetworks.com/tag/javascript/) [PayPal,](https://unit42.paloaltonetworks.com/tag/paypal/) [Trojan,](https://unit42.paloaltonetworks.com/tag/trojan/)\n[URL filtering,](https://unit42.paloaltonetworks.com/tag/url-filtering/) [WildFire,](https://unit42.paloaltonetworks.com/tag/wildfire/) [Xbot](https://unit42.paloaltonetworks.com/tag/xbot/)\n\nWe recently discovered 22 Android apps that belong to a new Trojan family we’re calling\n“Xbot”. This Trojan, which is still under development and regularly updated, is already\ncapable of multiple malicious behaviors. It tries to steal victims’ banking credentials and\ncredit card information via phishing pages crafted to mimic Google Play’s payment interface\nas well as the login pages of 7 different banks’ apps. It can also remotely lock infected\nAndroid devices, encrypt the user’s files in external storage (e.g., SD card), and then ask for\na U.S. $100 PayPal cash card as ransom. In addition, Xbot will steal all SMS messages and\ncontact information, intercept certain SMS messages, and parse SMS messages for mTANs\n(Mobile Transaction Authentication Number) from banks.\n\nSo far the malware doesn’t appear to be widespread, and some markers in its code and\nfaked app interfaces indicate, at least for now, it mainly appears to target Android users in\nRussia and Australia. Of note, of the seven bank apps it is seen to imitate, six of them belong\nto some of the most popular banks in Australia. However, Xbot was implemented in a flexible\narchitecture that could be easily extended to target more Android apps. Given we also\nobserved the author making regular updates and improvements, this malware could soon\nthreaten Android users around the world.\n\nXbot primarily uses is a popular attack technique called “activity hijacking” by abusing some\nfeatures in Android. The apps Xbot is mimicking are not themselves being exploited. Starting\nwith Android 5.0, Google adopted a protection mechanism to mitigate this attack but other\nattack approaches used by Xbot are still affecting all versions of Android.\n\n## Xbot’s Evolution and Spreading\n\n\n-----\n\n[We believe Xbot is a successor to the Android Trojan Aulrin that was first discovered in 2014.](http://maldr0id.blogspot.com/2015/03/android-malware-goes-mono-net-and-lua.html)\nXbot and Aulrin have very similar code structures and behaviors, and some resource files in\nAulrin are also in Xbot samples. The main difference between them is that Xbot implements\nits behaviors using JavaScript through Mozilla’s Rhino framework, while Aulrin used Lua and\n.NET framework. The earliest sample of Xbot we found was compiled in May 2015 and while\ncomparing Xbot to Aulrin, it seemed to us the author re-wrote Aulrin using a different\nlanguage and framework. The author has also progressively made Xbot more complex; the\nmost recent versions use Dexguard, a legitimate tool intended to protect Android apps by\nmaking them difficult to reverse engineer or be tampered with.\n\nWe are not clear how Xbot spreads in the wild. However, using VirusTotal we found samples\nthat were hosted on the below URLs over the past several months:\n\nhxxp://market155[.]ru/Install.apk\nhxxp://illuminatework[.]ru/Install.apk\nhxxp://yetiathome15[.]ru/Install.apk\nhxxp://leeroywork3[.]co/install.apk\nhxxp://morning3[.]ru/install.apk\n\nThere are several things that imply the developer of Xbot could be of Russian origin. The\nearlier versions of Xbot displayed a fake notification in Russian for Google Play phishing,\nthere are Russian comments in its JavaScript code, and the domains we’ve uncovered were\nregistered via a Russian registrar. Xbot will also intercept SMS messages from a specific\nbank in Russia and parse them for bank account information, which it will exfiltrate if found.\nWhile later versions use English instead of Russian for the notification, the language was not\nchanged elsewhere.\n\nFigure 1. Xbot's JavaScript code commented in Russian.\n\n## Phishing for Credit Cards and Bank Accounts\n\nAfter being installed on an Android device, Xbot will start communicating with its C2 server.\nWhen certain commands are received it will launch phishing attacks at users of Google Play\nand certain Australian bank apps. We observed three different phishing approaches and one\nuse of activity hijacking. The four approaches with their commands are shown in Figure 2.\n\n\n-----\n\nFigure 2. Xbot's phishing commands.\n\nIf the C2 command is “cc_notify”, Xbot will display a fake system notification to the victim\nwith the Google Play logo and the text “Add payment method” in either Russian or English\n(Figure 3). This imitates an actual popup the official Google Play app will show a user that\nhas registered for the service but not yet provided a credit card. However, Xbot will display\nthis whenever it receives the command, regardless of whether the Google Play app already\nhas a credit card tied to it.\n\nFigure 3. Code to display the fake notification in Russian or English.\n\nIf a victim clicks the fake notification, Xbot connects to its C2 server to download a webpage\nand display it with WebView. The page looks like Google Play’s actual interface for credit\ncard information (Figure 4). Its user interaction procedures are also almost exactly the same\nas the legitimate version. All information input into this page will be uploaded to its C2 server\n(Figure 5). The information it asks for includes:\n\ncredit card number\n\n\n-----\n\nexpiration date\nCVV number\ncard holder’s name\ncard holder’s billing address\ncard holder’s phone number\nVBV (Verified by Visa) or McSec (MasterCard SecureCode) number\n\nFigure 4. Fake Google Play payment pages.\n\n\n-----\n\nFigure 5. JavaScript code for uploading credit card information.\n\nIf the C2 command is “cc_dialog”, the fake notification step will be skipped and the fake\nGoogle Play webpage will be directly displayed to victims.\n\nIf the C2 command is “enable_inject”, Xbot will begin to monitor currently running apps via\nthe getRunningTasks() API in Android. If the app running in the foreground is Google Play or\none of several Australian bank apps (which is specified by the C2 server via the “add_inject”\ncommand), and immediately popup another interface on the top of running app (Figure 6).\nThis is a classic attack technique called “activity hijacking”. Note that Android 5.0\nimplemented a security enhancement to keep apps from getting running app information\nthrough the getRunningTasks() API. So this attack won’t be effective on devices running\nAndroid 5.0 or later.\n\nFigure 6. Code for hijacking Google Play and banking apps.\n\nIn the activity hijacking attack scenario, the faked app interfaces are also webpages\ndownloaded from a C2 and displayed by WebView. So far we’ve found 7 different faked\ninterfaces. We identified 6 of them – they’re imitating apps for some of the most popular\nbanks in Australia. The interfaces are very similar to these banks’ official apps’ login\ninterfaces. If a victim fills out the form, the bank account number, password, and security\ntokens will be sent to C2 server (Figure 8).\n\nIt’s worth noting that, since Xbot’s C2 server can remotely decide which faked app webpage\nto display, it would be easy to expand this attack to more apps without even having to update\nthe code.\n\n\n-----\n\nFigure 7. Example of an Xbot banking app phishing interface.\n\n\n-----\n\nFigure 8. JavaScript code for uploading bank login information.\n\n## Locking, Encrypting, and Ransoming\n\nAfter being installed, Xbot asks the user to authorize it as a device administrator. Then, if the\nC2 server sends the command “killon”, it will change the phone to silent mode, reset the\npassword to “1811blabla”, then toggle the device screen to activate the new password.\n\nFigure 9. Code to change the device password.\n\nIf the C2 command is “enable_locker”, Xbot will display a ransom webpage claiming to be\nCryptolocker, still using WebView, from either “hxxp://23[.]227.163.110/locker.php” or another\naddress specified by the C2 server. When we analyzing the sample, the webpage came from\nits C2 server, as seen in Figure 10:\n\n\n-----\n\nFigure 10. Xbot ransom page.\n\nXbot will also start the onBackPressed(), onDestroy() and onPause() callback methods to\nprevent the user from exiting. Xbot will also encrypt the victim’s files in external storage\n(Figure 11). Currently, the encryption algorithm is pretty simple: just XOR each byte in all files\nby the fixed integer number 50.\n\n\n-----\n\nFigure 11. Code to encrypt files in external storage.\n\nAccording to the ransom webpage, the victim has to purchase a U.S. $100 PayPal My Cash\nCard from www.paypal-cash[.]com, and input the card number within 5 days. The webpage\nalso says it’s impossible to decrypt the files by yourself, which is obviously not true for\nexisting samples.\n\nIt should be noted that since the ransom page comes from a remote server, the attacker can\nupdate it to change the payment method and/or the amount of money at any time.\n\n## Information Stealing\n\nXbot has some additional capabilities. It will collect all contacts’ names and phone numbers\nand upload them to its C2 server, as well as all new SMS messages. In some samples, Xbot\nwill also intercept and parse specific SMS messages. It parses all SMS messages sent by a\nspecific premium rate SMS short number in an attempt to collect the victim’s account and\nconfirmation numbers from a bank in Russia, and then uploads the information to its C2\nserver.\n\n\n-----\n\nFigure 12. Code to steal SMS messages from a bank in Russia.\n\n## Conclusion\n\nWhile Android users running version 5.0 or later are so far protected from some of Xbot’s\nmalicious behaviors, all users are vulnerable to at least some of its capabilities. As the author\nappears to be putting considerable time and effort into making this Trojan more complex and\nharder to detect, it’s likely that its ability to infect users and remain hidden will only grow, and\nthat the attacker will expand its target base to other regions around the world. We’ll continue\nto watch and report on this threat as the attacker introduces new versions. We also want to\nre-emphasize that the banking apps imitated by Xbot are not themselves being exploited.\n\nCustomers of Palo Alto Networks are protected with our WildFire, URL filtering, and IPS\nservices. An AutoFocus tag has also been created to identify this family and its variants.\nCustomers can also refer to IPS signature (13997) for details about Xbot C2 traffic\ninformation.\n\n**Acknowledgments**\n\n\n-----\n\nWe greatly appreciate the help from Rongbo Shao, Yi Ren, Bowen Jiao, Michael Scott, Jen\nMiller-Osborn, Chad Berndtson, Chris Clark, and Ryan Olson from Palo Alto Networks in\nworking on the analysis and coverage of Xbot family.\n\n## IOCs\n\n**Sample hashes**\n\ndfda8e52df5ba1852d518220363f81a06f51910397627df6cdde98d15948de65\ne905d9d4bc59104cfd3fc50c167e0d8b20e4bd40628ad01b701a515dd4311449\nf2cfbc2f836f3065d5706b9f49f55bbd9c1dae2073a606c8ee01e4bbd223f29f\n029758783d2f9d8fd368392a6b7fdf5aa76931f85d6458125b6e8e1cadcdc9b4\n1264c25d67d41f52102573d3c528bcddda42129df5052881f7e98b4a90f61f23\n20bf4c9d0a84ac0f711ccf34110f526f2b216ae74c2a96de3d90e771e9de2ad4\n33230c13dcc066e05daded0641f0af21d624119a5bb8c131ca6d2e21cd8edc1a\n4b5ef7c8150e764cc0782eab7ca7349c02c78fceb1036ce3064d35037913f5b6\n7e939552f5b97a1f58c2202e1ab368f355d35137057ae04e7639fc9c4771af7e\n93172b122577979ca41c3be75786fdeefa4b80a6c3df7d821dfecefca1aa6b05\na22b55aaf5d35e9bbc48914b92a76de1c707aaa2a5f93f50a2885b0ca4f15f01\nd082ec8619e176467ce8b8a62c2d2866d611d426dd413634f6f5f5926c451850\na94cac6df6866df41abde7d4ecf155e684207eedafc06243a21a598a4b658729\n58af00ef7a70d1e4da8e73edcb974f6ab90a62fbdc747f6ec4b021c03665366a\n7e47aaa8a1dda7a413aa38a622ac7d70cc2add1137fdaa7ccbf0ae3d9b38b335\nd1e5b88d48ae5e6bf1a79dfefa32432b7f14342c2d78b3e5406b93ffef37da03\nc2354b1d1401e31607c770c6e5b4b26dd0374c19cc54fc5db071e5a5af624ecc\n12f75b8f58e1a0d88a222f79b2ad3b7f04fd833acb096bb30f28294635b53637\n1b84e7154efd88ece8d6d79afe5dd7f4cda737b07222405067295091e4693d1b\n616b13d0a668fd904a60f7e6e18b19476614991c27ef5ed7b86066b28952befc\n2e2173420c0ec220b831f1c705173c193536277112a9716b6f1ead6f2cad3c9e\n595fa0c6b7aa64c455682e2f19d174fe4e72899650e63ab75f63d04d1c538c00\n\n**C2 Servers and Malicious URLs**\n\nmelon25[.]ru\n81[.]94.205.226:8021\n104[.]219.250.16:8022\nhxxp://52[.]24.219.3/action.php\nhxxp://192[.]227.137.154/request.php\nhxxp://23[.]227.163.110/locker.php\nhxxp://market155[.]ru/Install.apk\nhxxp://illuminatework[.]ru/Install.apk\nhxxp://yetiathome15[.]ru/Install.apk\nhxxp://leeroywork3[.]co/install.apk\nhxxp://morning3[ ]ru/install apk\n\n\n-----\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-02-18 - New Android Trojan “Xbot” Phishes Credit Cards and Bank Accounts, Encrypts Devices for Ransom.pdf"
    ],
    "report_names": [
        "2016-02-18 - New Android Trojan “Xbot” Phishes Credit Cards and Bank Accounts, Encrypts Devices for Ransom.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535618,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653821274,
    "ts_modification_date": 1653821274,
    "files": {
        "pdf": "https://archive.orkl.eu/db5a00537dc46d73b3885dfe9a09866c13f8bdda.pdf",
        "text": "https://archive.orkl.eu/db5a00537dc46d73b3885dfe9a09866c13f8bdda.txt",
        "img": "https://archive.orkl.eu/db5a00537dc46d73b3885dfe9a09866c13f8bdda.jpg"
    }
}