{
    "id": "d3c49b1d-0af2-43eb-a5f5-2941d6fcd65b",
    "created_at": "2023-01-12T14:58:59.364373Z",
    "updated_at": "2025-03-27T02:05:26.226589Z",
    "deleted_at": null,
    "sha1_hash": "bd25ee1cbefdb4e097b4db79deba2705d5e30e4c",
    "title": "2021-02-09 - Threat actors now target Docker via container escape features",
    "authors": "",
    "file_creation_date": "2022-05-28T17:06:21Z",
    "file_modification_date": "2022-05-28T17:06:21Z",
    "file_size": 315940,
    "plain_text": "# Threat Actors Now Target Docker via Container Escape Features\n\n**[trendmicro.com/en_us/research/21/b/threat-actors-now-target-docker-via-container-escape-features.html](https://www.trendmicro.com/en_us/research/21/b/threat-actors-now-target-docker-via-container-escape-features.html)**\n\nFebruary 9, 2021\n\nAn increasing number of enterprises and organizations have adopted the microservice architecture for its simplicity and\nflexibility. In fact, a [2019 survey states that 89% of technology leaders believe that microservices are vital for enterprises to](https://devops.com/survey-sees-massive-adoption-of-microservices/)\nremain competitive in an ever-evolving digital world. As more developers deploy containers on-premises and in cloud\nservices, critical data could be inadvertently exposed due to security control failures, making them an interesting target for\nthreat actors. We are seeing ongoing attacks against misconfigured services, such as cryptocurrency-mining malware being\n[deployed in exposed Redis instances and as rogue containers using a community-contributed container image on Docker Hub.](https://www.trendmicro.com/en_us/research/20/d/exposed-redis-instances-abused-for-remote-code-execution-cryptocurrency-mining.html)\n\n[We saw an attack where cryptocurrency-mining malware searched and killed off other existing cryptocurrency miners in](https://www.trendmicro.com/en_us/research/20/i/war-of-linux-cryptocurrency-miners-a-battle-for-resources.html)\ninfected Linux systems to maximize their own computing power. This attack showcased the malicious actors’ familiarity with\nDocker and Redis, as the malware featured in this attack looked for exposed application programming interfaces (APIs) in\nthese platforms. However, we’re currently seeing something completely different — a payload specifically crafted to be able to\nescape privileged containers with all of the root capabilities of a host machine. It’s important to note that being on Docker\ndoesn’t automatically mean that a user’s containers are all privileged. In fact, the vast majority of Docker users do not use\nprivileged containers. However, this is further proof that using privileged containers without knowing how to properly secure\nthem is a bad idea.\n\n## Technical analysis\n\n_Case details by Alfredo Oliveira_\n\n[In July 2019, Felix Wilhelm from the Google Security Team tweeted a proof of concept (PoC) showcasing how “trivial” it would](https://twitter.com/_fel1x/status/1151487053370187776?lang=en)\nbe to break out a privileged Docker container or a Kubernetes pod abusing the cgroups release_agent feature.\n\nOur team recently spotted a container abuse attack using the same approach to try to break out of our honeypot environment.\n\n\n-----\n\nFigure 1. Attack chain that features the abuse of a privileged Docker container\nBased on our investigation, the attacker or bot source IP addresses feature addresses from the UK and France. A malicious\ncontainer running on a Docker-run host is deployed and ran. The attacker’s entry point is a shell script called calm.sh. Calm.sh\nwill then drop another shell script called cmd. Calm.sh will call nginx, a fake app that is actually an executable and linkable\nformat (ELF) cryptocurrency miner. The attackers possibly used the name nginx, which is usually associated with an HTTP\nserver, to fly under the radar and fool victims into thinking that it’s legitimate.\n\nOur honeypot was caught by a network scanner that has become very popular among container attacks. The scanner called\n_zgrab mapped the container with the exposed API, and we found that the following connection deployed the malicious_\ncontainer in the system.\n\nFigure 2. The connection that deployed the malicious container on the exposed API\n\nThe API using the command create pulled the container image called “gin” from its registry. One of the options used as a\ndeployment parameter was privileged, since it’s a requirement for this specific escape technique.\n\n\n-----\n\nFigure 3. Code that shows the API pulling the container image “gin” and the privileged\n\ndeployment parameter\nIn case the exploitation is not successful, we observed that the attackers didn’t miss the opportunity to launch a cryptocurrency\nminer on a vulnerable server that didn’t need a privileged container to run on.\n\nFigure 4. A cryptocurrency miner running on a vulnerable server\nThe cryptocurrency miner binary is an ELF file called nginx, which is also embedded inside a malicious container image. It\nattempts to operate stealthily by pretending to be a valid service instead of being a malicious file with the purpose of using all\n[of the infected container’s available resources to mine cryptocurrency — a trend that we have been talking about for a while](https://www.trendmicro.com/en_ca/research/20/i/the-evolution-of-malicious-shell-scripts.html)\nnow.\n\nFigure 5. The nginx ELF file embedded\n\nin a malicious container image\n\n## Is vulnerability checking enough to secure a container image?\n\nAn important process that will help guarantee that a container image is kept secure is to scan it for vulnerabilities — but that\nshouldn’t be all that should be done to secure containers. Security teams should also regularly scan container images for\nmalware and exploit files.\n\n\n-----\n\nIn this specific attack, the nginx binary is a known sample to Trend Micro s threat intelligence and solutions, which is why our\nanti-malware engine promptly detected it. It is a myth that Linux-based operating systems are immune from threats and risks\n[such as this. As we’ve recently discussed in another article, malicious actors are zeroing in on Linux as a lucrative target due](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/a-look-at-linux-threats-risks-and-recommendations)\nto the influx of enterprises and organizations moving to the cloud and using Linux in their critical business operations.\n\n## Conclusion\n\n[Malicious actors are targeting popular DevOps technologies and finding new ways to attack containers and cloud](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/devops)\nenvironments.\n\nMost of the earlier samples we analyzed did not implement any security checks. What attackers seemed to have been doing is\nto try everything and to see what would work; it was a matter of throwing everything at the wall and seeing what would stick.\n\nWe’re now seeing that malicious actors are becoming more sophisticated with their techniques. They are currently\nimplementing security checks to try to exploit a bad implementation and escape from the container to the host or deploy a\ncryptocurrency miner and profit from their victims’ resources.\n\n## Trend Micro solutions\n\n**[Trend Micro™ Cloud One™is a security services platform for cloud builders. It provides automated protection for cloud](https://www.trendmicro.com/en_us/business/campaigns/cloud-one-services.html)**\nmigration, cloud-native application development, and cloud operational excellence. It also helps identify and resolve security\nissues sooner and improves delivery time for DevOps teams. It includes the following:\n\n[Workload Security: runtime protection for workloads](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\n[Container Security: automated container image and registry scanning](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-container-image-security.html)\n[File Storage Security: security for cloud file and object storage services](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-file-storage-security.html)\n[Network Security: cloud network layer IPS security](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-network-security.html)\n[Application Security: security for serverless functions, APIs, and applications](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-application-security.html)\n[Conformity: real-time security for cloud infrastructure — secure, optimize, and comply](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-conformity.html)\n\n## Indicators of compromise (IoCs)\n\n\nSHA-256 File\nname\n\n\nDetection name\n\n\n6f2825856a5ae87face1c68ccb7f56f726073b8639a0897de77da25c8ecbeb19 nginx Coinminer.Linux.MALXMR.SMDSL64\n\n548236b18ae6c6b588f1180ac70561f20c1bce33b98ef15e385b5c060921b871 calm.sh Trojan.SH.DOKI.A\n\nCloud\n\nWe provide a technical analysis of a container abuse attack that features a payload that’s specifically crafted to be able to\nescape privileged Docker containers.\n\nBy: Alfredo Oliveira, David Fiser February 09, 2021 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-09 - Threat actors now target Docker via container escape features.pdf"
    ],
    "report_names": [
        "2021-02-09 - Threat actors now target Docker via container escape features.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535539,
    "ts_updated_at": 1743041126,
    "ts_creation_date": 1653757581,
    "ts_modification_date": 1653757581,
    "files": {
        "pdf": "https://archive.orkl.eu/bd25ee1cbefdb4e097b4db79deba2705d5e30e4c.pdf",
        "text": "https://archive.orkl.eu/bd25ee1cbefdb4e097b4db79deba2705d5e30e4c.txt",
        "img": "https://archive.orkl.eu/bd25ee1cbefdb4e097b4db79deba2705d5e30e4c.jpg"
    }
}