{
    "id": "19ebc0dc-6de4-4ef5-a391-a8a23189151c",
    "created_at": "2023-01-12T15:05:30.392112Z",
    "updated_at": "2025-03-27T02:09:18.657471Z",
    "deleted_at": null,
    "sha1_hash": "38ed383a218e4e3d408f496280052e9ebfc5c996",
    "title": "2021-06-16 - Gootloader- ‘Initial Access as a Service’ Platform Expands Its Search for High Value Targets",
    "authors": "",
    "file_creation_date": "2022-05-28T17:39:00Z",
    "file_modification_date": "2022-05-28T17:39:00Z",
    "file_size": 1965354,
    "plain_text": "# Gootloader: ‘Initial Access as a Service’ Platform Expands Its Search for High Value Targets\n\n**[labs.sentinelone.com/gootloader-initial-access-as-a-service-platform-expands-its-search-for-high-value-targets/](https://labs.sentinelone.com/gootloader-initial-access-as-a-service-platform-expands-its-search-for-high-value-targets/)**\n\nAntonio Pirozzi\n\n_The ongoing Gootloader campaign expands its scope to highly sensitive assets worldwide_\n_including financial, military, automotive, pharmaceutical and energy sectors, operating on an_\n_Initial Access as a Service model._\n\n## Executive Summary\n\nSince the beginning of Jan 2021 an active Gootloader campaign has been observed in\nthe wild expanding its scope of interest to a wider set of enterprise verticals worldwide.\nAnalysis of over 900 unique droppers reveals that the campaign targets diverse\nenterprise and government verticals including military, financial, chemistry, banks,\nautomotive, investment companies and energy stakeholders, primarily in the US,\nCanada, Germany, and South Korea.\nAround 700 high-traffic compromised websites were used as a delivery network.\nThe campaign uses tailored filenames to lure targets in a typical form of social\nengineering.\nThis campaign has a low static detection rate alongside robust sandbox evasion\ntechniques and ‘fileless’ stages.\n\n\n-----\n\nConsidering the wide distribution of the campaign and the heterogeneity of its deployed\narsenal, we assess that Gootloader acts as an ‘Initial Access As a Service’ provider,\nafter which a variety of tools may be deployed.\n\n## Introduction\n\nWe have been tracking an active Gootloader campaign aimed at enterprise and government\ntargets worldwide. The primary industries of interest appear to be U.S. military,\ngovernmental, and financial entities, trading, mining, green energy, game industries and\nautomotive companies, as well as their suppliers and service providers.\n\nFirst spotted in 2014, Gootkit was born as a banking trojan. It has since evolved to become\nmore of an infostealer, operated by what appears to be a cluster of actors. The name\n‘Gootkit’ is often used interchangeably to refer to both the malware and the group, but that’s\n[admittedly loose. In March 2021, Sophos were the first to identify the multi-payload delivery](https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/)\nplatform and call it “Gootloader”.\n\n[Early activity of Gootloader campaigns was first spotted by security researcher @ffforward in](https://twitter.com/ffforward)\n[late 2020 and later published by ASEC,](https://asec.ahnlab.com/en/20130/) [malwarebytes, and](https://blog.malwarebytes.com/threat-analysis/2020/11/german-users-targeted-with-gootkit-banker-or-revil-ransomware/) [TrendMicro. Pivoting on those](https://www.trendmicro.com/en_us/research/20/l/investigating-the-gootkit-loader.html)\nfindings, we were able to gather a sizable amount of malicious artifacts related to the same\nGootloader campaign. We collected about 900 JavaScript (js) droppers from a period of four\n[months (1 Jan 2021 – 25 April 2021) by leveraging this Gootloader_JavaScript_infector](https://github.com/sophoslabs/IoCs/blob/master/Troj-gootloader.yara)\nYARA Rule. Our aim is to deepen our understanding of the Gootloader service platform and\nthe selective nature of this campaign: topics that haven’t been investigated at scale.\n\nThe campaign uses customized filenames to lure targets through SEO poisoning, with the\nname of the js loader playing an active part of the social engineering process. For this\nreason, we deemed that in this campaign the filenames provided a strong indication of the\ncontents victims were interested in searching for and, by extension, the scope of the\nintended targets.\n\nThe detection rate of these artifacts on by VirusTotal engines is very low and ranges from 1\nto 7:\n\n\n-----\n\nLow detection on VirusTotal\nMoreover, considering that the subsequent stages are downloaded and executed in-memory,\nthis ‘fileless’ mechanism is very effective at evading standard sandboxes.\n\n## The Stealthy JS Loader\n\nThe core component of Gootloader is a small js loader (2.8 KB) that acts as the first-stage of\nthe infection chain. It’s not new, and the same artifact is used in other Gootkit campaigns.\nThe loader is composed of three highly obfuscated layers that contain encoded URLs. These\nform part of a network of compromised websites used to deliver the final payload, typically\none of the malware families listed below:\n\nBlueCrab (mostly targeting Korean Users)\nCobalt Strike Beacons\nGootkit\nKronos\nRevil\n\nWe see Gootloader as a cluster of activity representing an ‘Initial Access as a Service’\nbusiness model, allowing it to distribute malware for different cybercrime groups for affiliate\nfees. All of the above payloads are known ‘MaaS’ (Malware-as-a-Service) families that thrive\n\n\n-----\n\non affiliate distribution models. Seeing that in some cases the payload distributed is Cobalt\nStrike, we cannot exclude that the Gootloader operators are conducting their own\nreconnaissance or credential harvesting for further gain.\n\nAnalyzing the JavaScript components was made drastically easier with the use of HP’s\n[Gootloader decoder to automate the deobfuscation and extraction of embedded URLs and](https://github.com/hpthreatresearch/tools/tree/main/gootloader)\ncontent.\n\nThe beautified version of the js loader’s first layer reveals the malicious logic:\n\njs loader 1st layer\nOnce deobfuscated, we obtain the 2nd layer:\n\njs loader 2nd layer\nAnd finally the cleartext (and beautified) version:\n\n\n-----\n\njs loader decoded\nFrom the decoded script we can now see how Gootloader performs some target filtering to\nensure that the victim is a part of an Active Directory domain via expanding the\n```\n\"%USERDNSDOMAIN%\"  environment variable.\n\n```\nChecking to see if the user is an AD domain\nIf the check returns true, then it appends an id (278146 in the above example) at the end of\nthe query string and requests the next stage from one of the websites contained in the ‘K’\narray.\n\n## Gootloader Delivery Platform\n\nIn this section, we examine how the Gootloader delivery network works, starting with the\ndistribution of the js loader using a social engineering lure all the way to the final payload.\n\nThe delivery network is composed of two levels. The first level consists of compromised wellranked websites indexed by Google and hijacked by threat actors to host a js redirector.\n\nHijacked websites host a js redirector\nAt the time of writing, we estimate there are around 700 different compromised websites\nworldwide.\n\nThe script embedded on these compromised websites is responsible for performing the\nfollowing checks via HTTP headers before delivering the js loader to the target:\n\nreferral: check that the request comes specifically from a Google search\nfirst time condition: check that the host/machine has not previously visited the site\ntimezone: check the timezone based on the requester IP\n\n\n-----\n\nThe timezone check is particularly interesting: in our analysis, the Gootloader platform\napparently ‘geofences’ its intended targets by only deliverering malware if the victim comes\nfrom specific countries: the US, Canada, Germany, and South Korea.\n\nIf any of the above conditions is not met, then the redirector builds a dummy page without a\nmalicious component for the user, such as the following:\n\nDummy page for uninteresting visitors\nOtherwise, the embedded script automatically builds and displays a fake forum page\ncontaining a thread relevant to the user’s search content, along with the link to the js loader:\n\n\n-----\n\nFake forum page for interesting targets\nThe compromised websites use old and vulnerable CMS versions that have been exploited\nto insert the malicious script.\n\nDuring our analysis, we were able to extract the exploited domains used as a second-level\ndelivery network for this campaign (the list is not exhaustive):\n```\nwww[.]kartatatrzanska[.]pl\nwww[.]hrgenius-uk[.]com\nwww[.]joseph-koenig-gymnasium[.]de\nwww[.]hagdahls[.]com\nwww[.]formenbau-jaeger[.]de\nwww[.]fabiancoutoxp[.]com[.]ar\nwww[.]cristianivanciu[.]ro\nwww[.]communityhalldp[.]org[.]uk\nwww[.]hoteladler[.]it\nwww[.]handekazanova[.]com\nwww[.]hccpa[.]com[.]tw\nwww[.]forumeuropeendebioethique[.]eu\nwww[.]cwa1037[.]org\nwww[.]edmondoberselli[.]net\nwww[.]ehiac[.]com\nwww[.]cljphotographyny[.]com\nwww[.]charismatrade[.]ro\nwww[.]commitment[.]co[.]at\nwww[.]giuseppedeluigi[.]com\nwww[.]esist[.]org\nwww[.]dischner-kartsport[.]de\nwww[.]espai30lasagrera[.]cat\nwww[.]kettlebellgie[.]be\nwww[.]frerecapucinbenin[.]org\nwww[.]adpm[.]com[.]br\n\n```\n\n-----\n\nThe malicious link embedded into the fake page points to a .php resource. In turn, that\ncomponent is responsible for delivering the malicious loader to victims by pulling a zip\narchive containing the js loader with the same name from the second level delivery network.\n```\nhttps://<2nd_level_compromised_domain>/about.php?\nkiaorsruvr=kdwpx&id=6d6563463546734e487841532f31306d374b77736274446b70356e505257655464\n\n```\nThe above URL reminds us of a typical webshell schema through which it’s possible to track\ncampaigns and victims. Moreover, subsequent attempts to download the same file using the\nsame URL from the same machine will fail. Each download attempt automatically generates\na new URL. In fact, three different attempts from different IPs generate the following unique\nURLs:\n\nDifferent IPs generate unique URLs\nThis substantiates the notion of a fully-automated assembly line process for malicious\nbundles.\n\nOnce the malicious js loader is delivered to the victim and executed through the wscript.exe\nprocess, it performs another request to one of the embedded domains belonging to the same\n2nd level delivery network.\n\nIn the request, the loader passes a random-looking parameter ( “?wmsyxqsucnsif=” ) to the\n```\nsearch.php component, assigning a value to it. The assigned value consists of a randomly\n\n```\ngenerated numeric value followed by an ID that signals that the user is part of a domain.\n\nThe `“?wmsyxqsucnsif=” query parameter changes for each analyzed dropper. By`\nextracting a few of them, we noticed differences in length:\n\n\n-----\n\n```\n     Iywoiqoagiqj  Length: 12\n     Ulxoflokgzjuj  Length: 13\n     Xksrabkxexxje  Length: 13\n     Ulxoflokgzjuj  Length: 13\n     Frzlewezxuqra  Length: 13\n     Wehzijrczmewt  Length: 13\n     Fzwuidcgfwpid  Length: 13\n     Xrplomnpnofoc  Length: 13\n     Jrnfrcbxrmwnr  Length: 13\n     Zlurylnryiaupe  Length: 14\n     Bhqtjmvrrnpttw  Length: 14\n     Hmdfwcokgjutia  Length: 14\n     Btvhenvucpmtvpta  Length: 16\n     Vzhnbqsvkxxndgem  Length: 16\n     Mnxcmedoofhmjhob  Length: 16\n     Olwakhzcqflqrbln  Length: 16\n     Ecteaaaqztxoqblrar  Length: 18\n\n```\nWe were able to populate at least five different clusters based on assigned lengths: 12, 13,\n14, 16 and 18. A randomly generated, unique string is assigned to each loader. The query\nparameter, at this stage, may be used for download tracking or other purposes.\n\n## Delivery of the Final Payload\n\nIf the js loader succeeds in contacting the C2, then it retrieves an encoded PowerShell\nstager that in turn downloads the next payload and writes it to the registry as a list of keys.\nThe js loader then deploys additional PowerShell responsible for loading and decoding the\ncontent hidden in the registry.\n\n\n-----\n\nBase64 obfuscated PowerShell\n\nDecoded\n\nPowerShell content\nThe additional PowerShell is responsible for extracting the payload from the registry,\nconverting it from `ascii into bytes through the` `chba() function then loading and`\nexecuting it by reflection.\nAt this point, the code spawns the ImagingDevices.exe process and injects itself into it via\nprocess hollowing. As noted above, the injected payload varies between Cobalt Strike\nBeacons and various well-konwn malware families such as REvil and Kronos.\n\nPowerShell execution chain\nAnalysis of the network communication allowed us to spot different network clusters\nrevolving around the following IPs:\n\n23.106.122[.]245\n78.128.113[.]14\n\n\n-----\n\nNetwork clusters\nThese two Cobalt Strike Team Servers now appear to serve Gootloader exclusively,\nhowever, there appears to be some infrastructure overlap on 78.128.113[.14]. This particular\nhost has been observed as part of multiple Cobalt Strike-centric campaigns over the last\nseveral years. It is not possible to conclusively say that the same “actor” or “group” has been\noperating that infrastructure throughout the history of its misuse. That said, it is important to\nnote that while campaigns have varied, this host has constantly been utilized to stage and\nserve CS Beacons and additional payloads, up to and including this ongoing Gootloader\ncampaign. It is reasonable to assume given such history that the host is at least partially\nunder control of an affiliate group.\n\n## Victimology\n\nAs evidenced by artifacts in the code, this ongoing Gootloader campaign is selective and\ntargets users from enterprise environments. Extrapolating from the variety of languages used\nin various components of the campaign, we can surmise that the operators favored targets in\nKorean, German and English-speaking environments.\n\nFile names in different\n\nlanguages\n\n\n-----\n\nThe names of lures embedded into Gootloader samples also offer additional insights into the\nnature of the desired targets. For example, the artifact ‘besa_national_agreement_2021.js’\n(SHA1: `b0251c0b26c6541dd1d6d2cb511c4f500e2606ce ) could suggest targets interested`\nin components supplied by an Italian manufacturing company that produces security valves.\nCategorizing the loaders by their names, we can surmise targeted verticals:\n\nTargeted industries\nInterestingly, Korean loaders follow a different naming convention to that used for other\nlanguages. Rather than using company names or specific entities, they use a more generic\nnaming scheme. This could indicate the presence of region-specific Gootloader operators\nwith their own TTPs. It’s notable that despite not expressly targeting specific entities, these\ninfections continue to check for users that are part of corporate domains.\n```\nNAME TRANSLATION\n\n```\n유튜브_영상(egj).js `YouTube_Video(egj).js`\n휴먼명조_폰트(fm).js ( `Human Myeongjo_Font(fm).js`\n살육의_천사_게임(lep).js `Slaughter_angel_game(lep).js`\n바코드생성프로그램(bo).js `Barcode generation program (bo).js`\n웨스트월드_시즌2_2화(jbk).js `West World_Season 2 Episode 2(jbk).js`\n스팀_게임_무료(wdb).js `Steam_Game_Free(wdb).js`\n\n## Conclusion\n\nWe analyzed an ongoing Gootloader campaign attempting to lure professionals and\nenterprise employees worldwide. The selective nature of this campaign, the option to deliver\nmultiple payloads, as well as the utilization of Cobalt Strike leads us to believe that\nGootloader is an ‘Initial Access as a Service’ provider primarily for ransomware operators.\n\n\n-----\n\nThis malicious operation is still active at the time of writing and we continue to expect future\ncampaigns seeking additional targets and verticals. For that reason, we continue to actively\nmonitor Gootloader as a means of distribution for the next strand of widespread ransomware.\n\n## IoCs Gootloader Q1 2021\n\n### MITRE TTPs\n\n**Js loader + powershell stage:**\n\nInitial Access (TA0001):\n\nT1566 Phishing\nT1566.002 Spear Phishing Link\nT0817 Drive-by Compromise\n\nExecution (TA0002):\n\nT1059.007 Command and Scripting Interpreter: JavaScript\nT1059.001 Command and Scripting Interpreter: Powershell\nT1204.002 User Execution: Malicious File\n\nPersistence (TA0003):\n\nT1547.001 Boot or Logon Autostart Execution\n\nDefence Evasion(TA0005):\n\nT1027 Obfuscated Files or Information\n\nPrivilege Escalation(TA0004):\n\nT1055.012 Process Injection: Process Hollowing\n\n### URLs (Delivery Network):\n\nwww[.]hagdahls[.]com/search[.]php? | /about[.]php?\nwww[.]hoteladler[.]it/search[.]php? | /about[.]php?\nwww[.]handekazanova[.]com/search[.]php? | /about[.]php?\nwww[.]hccpa[.]com[.]tw/search[.]php? | /about[.]php?\nwww[.]hrgenius-uk[.]com/search[.]php? | /about[.]php?\nwww[.]joseph-koenig-gymnasium[.]de/search[.]php? | /about[.]php?\nwww[.]kartatatrzanska[.]pl/search[.]php? | /about[.]php?\nwww[.]edmondoberselli[.]net/search[.]php? | /about[.]php?\nwww[.]cwa1037[.]org/search[.]php? | /about[.]php?\nwww[.]ehiac[.]com/search[.]php? | /about[.]php?\n\n\n-----\n\nwww[.]cljphotographyny[.]com/search[.]php? | /about[.]php?\nwww[.]charismatrade[.]ro/search[.]php? | /about[.]php?\nwww[.]commitment[.]co[.]at/search[.]php? | /about[.]php?\nwww[.]giuseppedeluigi[.]com/search[.]php? | /about[.]php?\nwww[.]esist[.]org/search[.]php? | /about[.]php?\nwww[.]dischner-kartsport[.]de/search[.]php? | /about[.]php?\nwww[.]espai30lasagrera[.]cat/search[.]php? | /about[.]php?\nwww[.]kettlebellgie[.]be/search[.]php? | /about[.]php?\nwww[.]forumeuropeendebioethique[.]eu/search[.]php? | /about[.]php?\nwww[.]frerecapucinbenin[.]org/search[.]php? | /about[.]php?\nwww[.]formenbau-jaeger[.]de/search[.]php? | /about[.]php?\nwww[.]fabiancoutoxp[.]com[.]ar/search[.]php? | /about[.]php?\n\n### Cobalt C2\n\n78.128.113[.]14\n23.106.122[.]245\n\n### Network Communication\n\nhttps://78.128.113[.]14/j.ad\nhttps://78.128.113[.]14/ca\nhttps://78.128.113[.]14/updates.rss\nhttps://78.128.113[.]14/load\nhttps://78.128.113[.]14/pixel.gif\nhttps://23.106.122[.]245/pixel.gif\nhttps://23.106.122[.]245/fwlink\n\n### YARA\n\n[https://github.com/sophoslabs/IoCs/blob/master/Troj-gootloader.yara<](https://github.com/sophoslabs/IoCs/blob/master/Troj-gootloader.yara)\n\n### SHA1s and Lures\n\nOver 900 SHA1 hashes identified as part of the Gootloader Q1 2021 campaign along with\nsome of the most relevant lures and embedded URLs used for the delivery of the payloads:\n\n[https://github.com/SentineLabs/Gootloader-iocs-q1-2021](https://github.com/SentineLabs/Gootloader-iocs-q1-2021)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-16 - Gootloader- ‘Initial Access as a Service’ Platform Expands Its Search for High Value Targets.pdf"
    ],
    "report_names": [
        "2021-06-16 - Gootloader- ‘Initial Access as a Service’ Platform Expands Its Search for High Value Targets.pdf"
    ],
    "threat_actors": [
        {
            "id": "dd5d24e4-366c-4bd4-8587-fc9606a0cff6",
            "created_at": "2022-10-25T16:07:24.383804Z",
            "updated_at": "2025-03-27T02:02:10.202949Z",
            "deleted_at": null,
            "main_name": "Void Balaur",
            "aliases": [
                "Rockethack"
            ],
            "source_name": "ETDA:Void Balaur",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "eed84d1d-a457-43d7-8dba-e41cf7cea6e5",
            "created_at": "2023-01-06T13:46:39.474045Z",
            "updated_at": "2025-03-27T02:00:03.103088Z",
            "deleted_at": null,
            "main_name": "Void Balaur",
            "aliases": [],
            "source_name": "MISPGALAXY:Void Balaur",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535930,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653759540,
    "ts_modification_date": 1653759540,
    "files": {
        "pdf": "https://archive.orkl.eu/38ed383a218e4e3d408f496280052e9ebfc5c996.pdf",
        "text": "https://archive.orkl.eu/38ed383a218e4e3d408f496280052e9ebfc5c996.txt",
        "img": "https://archive.orkl.eu/38ed383a218e4e3d408f496280052e9ebfc5c996.jpg"
    }
}