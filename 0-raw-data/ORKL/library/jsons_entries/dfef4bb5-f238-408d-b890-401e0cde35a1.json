{
    "id": "dfef4bb5-f238-408d-b890-401e0cde35a1",
    "created_at": "2023-01-12T15:09:34.891983Z",
    "updated_at": "2025-03-27T02:13:33.719363Z",
    "deleted_at": null,
    "sha1_hash": "62a9c51d2b8851538aa6fecca715f4d3ba8fe298",
    "title": "2022-02-01 - Sneaky Spies and Backdoor RATs - SysJoker and DazzleSpy Malware Target macOS",
    "authors": "",
    "file_creation_date": "2022-05-28T19:56:18Z",
    "file_modification_date": "2022-05-28T19:56:18Z",
    "file_size": 1968475,
    "plain_text": "# Sneaky Spies and Backdoor RATs | SysJoker and DazzleSpy Malware Target macOS\n\n**[sentinelone.com/blog/sneaky-spies-and-backdoor-rats-sysjoker-and-dazzlespy-malware-target-macos/](https://www.sentinelone.com/blog/sneaky-spies-and-backdoor-rats-sysjoker-and-dazzlespy-malware-target-macos/)**\n\nFebruary 1, 2022\n\n[As last year closed out, we provided a round up of the previous 12 months of Mac malware,](https://www.sentinelone.com/blog/top-10-macos-malware-discoveries-in-2021-a-guide-to-prevention-detection/)\nmaking the observation that, among other things, 2021’s macOS malware cohort saw a\nfocus on spyware and the targeting of users in Asia, particularly China and Hong Kong. The\nfirst month of 2022 has seen those trends continue with two new malware campaigns\ndiscovered in January, namely SysJoker and DazzleSpy.\n\nIn this post, we give brief overviews of these two new malware families, offering both\nadditional details not previously reported along with indicators for detection and threat\nhunting.\n\n\n-----\n\n## SysJoker (11th Jan, 2022)\n\nThe first new Mac malware report of 2022 came courtesy of researchers at Intezer in the\nform of a threat they dubbed [SysJoker, which comes in Windows, Linux and macOS](https://www.intezer.com/blog/malware-analysis/new-backdoor-sysjoker/)\nvariants. Researchers say that the Linux version was found in-the-wild infecting a server\nbelonging to “a leading educational institution”.\n\nThe Mac-specific variant of this malware is a Universal binary named `types-config.ts,`\ncompiled for both Intel x86 and Apple silicon M1 arm64 architectures.\n\nUpon execution, the Mach-O installs a persistence LaunchAgent that masquerades as an\nApple launch service `~/Library/LaunchAgents/com.apple.update.plist .`\n\n\n-----\n\nPersistence mechanism used by SysJoker malware on macOS\nThe fake service targets an executable called `~/Library/MacOsServices/updateMacOs .`\nThis file is also written by the `types-config.ts file and is in fact a straight copy of itself.`\nThe SentinelOne agent captures the chain of execution and displays it in the Management\nconsole for easy pivoting and threat hunting.\n\nOSX.SysJoker backdoor execution chain as captured by the SentinelOne agent\nThe malware is written in C++ and much of the initial action occurs in the `entry.init0`\nfunction. [Using r2, we can get a quick summary of the function’s important strings.](https://www.sentinelone.com/labs/techniques-for-string-decryption-in-macos-malware-with-radare2/)\n\n\n-----\n\nSome of the embedded strings in the SysJoker binary\nThe “drive.google.com” address delivers a file “domain.txt” that contains an obfuscated\ndomain name address. The key shown above at address `0x1000139e2 is used to decode`\nthe contents of “domain.txt”, which turns out to to be the DNS address “graphicupdater.com”.\n\nOther hardcoded strings are then concatenated with the decoded DNS address to form a full\nC2.\n```\nhttps://graphic-updater[.]com/api/attach\n\n```\nThe C2 address is determined on-the-fly during execution\nWe note that SysJoker has a peculiarity that, to our knowledge, has not been described by\nother researchers. In our tests, if the malware is run as root when the path\n```\n/Users/root/Library/SystemNetwork\n\n```\ndoes not exist, the malware will abort.\n\nThat’s an unusual path, as the root user on macOS typically exists under `/var/root, not`\n```\n/Users/root .\n\n```\nWhether this is an oversight or a peculiarity of SysJoker’s intended target is unclear. At this\npoint, we have no explanation for this behaviour, but merely note that if `/Users/root does`\nexist, then the malware executes as expected, and drops the components under that file\npath hierarchy.\n\n\n-----\n\nSysJoker uses an unorthodox path for a macOS root user\nAccording to previous researchers who also analyzed the Windows and Linux variants,\nSysJoker’s primary purpose is to await commands from the C2. We, and our sample, did\nindeed wait, but the C2 appeared to be uninterested in talking to either of us. Intezer has\nmore [details on the backdoor’s functionality.](https://www.intezer.com/blog/malware-analysis/new-backdoor-sysjoker/)\n\n## How To Protect Against OSX.SysJoker\n\nThe SentinelOne Singularity platform fully detects OSX.SysJoker.\n\nSentinelOne detects SysJoker on execution\nAside from the one reported in-the-wild incident against a “leading educational institution”, it\nis unclear at this time how SysJoker is distributed, who it targets, or what the authors’\nobjectives are. However, the cross-platform nature of the malware suggests that it may be\n\n\n-----\n\npart of a wider campaign, and it is imperative that organizations have a capable multiengined security solution in place to defend against these kinds of attacks.\n\n## DazzleSpy (25th Jan)\n\n[OSX.DazzleSpy was discovered by ESET researchers following the same trail as Google’s](https://www.welivesecurity.com/2022/01/25/watering-hole-deploys-new-macos-malware-dazzlespy-asia/)\n[Project Zero from a poisoned watering hole targeting Hong Kong pro-democracy activists.](https://blog.google/threat-analysis-group/analyzing-watering-hole-campaign-using-macos-exploits/)\n[Whereas Google’s investigation led them to macOS.Macma, researchers Marc L’Etienne and](https://www.sentinelone.com/blog/backdoor-macos-macma-spies-on-activists-but-cant-hide-from-behavioral-detection/)\nAnton Cherepanov caught a quite different payload.\n\n[OSX.DazzleSpy comes in the form of an unsigned, Mach-O file compiled for Intel x86](https://go.sentinelone.com/rs/327-MNM-087/images/reverse_mw_final_9.pdf)\narchitecture, although it’s perfectly possible that undiscovered ARM versions exist as well.\n\nOn execution, the Mach-O installs a persistence LaunchAgent that masquerades as an\nApple launch service at `~/Library/LaunchAgents/com.apple.softwareupdate . This`\nfake service targets an executable called “softwareupdate” written inside a hidden folder of\nthe user’s home folder, `~/.local/softwareupdate .`\n\nDazzleSpy LaunchAgent property list for persistence\nThe executable “softwareupdate” contains a mixture of public and private frameworks. On\n[the public side, the malware authors have adopted the tonymillion Reachability framework to](https://github.com/tonymillion/Reachability)\n[determine network connections, YYModel for efficient parsing of JSON data, and](https://github.com/ibireme/YYModel)\n[GCDAsyncSocket to handle TCP/IP socket networking tasks. A date comparison method,](https://github.com/robbiehanson/CocoaAsyncSocket) `+`\n```\n(int)compareOneDay:(NSDate *)oneDay withAnotherDay:(NSDate *)anotherDay, also\n\n```\n[appears to have been lifted from a Chinese-language programming forum.](https://its401-com.translate.goog/article/u012592258/50766938?_x_tr_sl=zh-CN&_x_tr_tl=en&_x_tr_hl=en&_x_tr_pto=sc)\n\n\n-----\n\nDazzleSpy contains a mix of public and private frameworks and methods\nFor functionality, DazzleSpy contains code for searching and writing files, exfiltrating\nenvironmental info, dumping the keychain, running a remote desktop and running shell\ncommands, among others.\n\nA number of methods are run as shell commands via NSTask APIs\nDazzleSpy collects and drops a number of other files in the hidden `~/.local directory`\nrelated to espionage and data collection.\n\nSome of the hardcoded paths found in the DazzleSpy executable\n```\n~/.local/softwareupdate\n~/.local/security/keystealDaemon\n~/.local/security.zip\n~/.local/SearchFiles\n~/.local/RecoveryFiles\n~/.local/security\n\n```\nAlthough we only saw the first of these files dropped in our tests, analysis of the static code\nsuggests that another hidden directory, `.Documenty, may also be used by the malware.`\n\nA path we didn’t see on execution, but potentially useful for hunting\n\n\n-----\n\nThe authors appear to have been careless (or perhaps deliberate!) in leaving artifacts from\nthe development environment. As noted by ESET, one user name embedded in the malware\nis “wangping”, but we also note two others: “wp” and “XpathX”.\n\nUsernames found embedded in the DazzleSpy binary\nOf these, “XpathX” seems to have a number of paths typical of an active user, but why these\nshould have found their way into the code is both mysterious and suspicious.\n\nMultiple paths for user “XpathX” are embedded in DazzleSpy\nThere’s no obvious mechanism that would easily result in those being embedded\naccidentally, and one could be forgiven for thinking that these paths were deliberately placed.\nWe might also wonder about the authenticity of other paths such as\n```\n/Users/wangping /pangu/.\n\n## How To Protect Against OSX.DazzleSpy\n\n```\nOSX.DazzleSpy, like [macOS.Macma before it, appears to be aimed at visitors to certain](https://www.sentinelone.com/labs/infect-if-needed-a-deeper-dive-into-targeted-backdoor-macos-macma/)\nwebsites holding content about, or of interest to, Hong Kong pro-democracy activists and\nactivism. Although that is a small demographic, the threat actors also exploited a (nowpatched) local privilege escalation, CVE-2021-30869, to run the payload as root.\n\nSentinelOne’s behavioral engine detects OSX.DazzleSpy on execution. In order to prevent\ninfections like DazzleSpy, be sure to install a good behavioral AI engine that can recognize\nnovel threats based on what they do. Legacy AV scanners that rely on known signatures or\ncloud reputation services alone will not be able to stop threats that have not previously been\ndetected in the wild\n\n\n-----\n\nSentinelOne detects OSX.DazzleSpy on execution\nAdmin users can view details including threat indicators in the Management console and\npivot directly from there to Deep Visibility for extended threat hunting across the estate if\nrequired.\n\nThe SentinelOne behavioral AI catches the malware attempting persistence\n\n\n-----\n\nWatch Video At:\n\nhttps://youtu.be/CeqKNrQJuPM\n\n## Conclusion\n\n[These two new Mac malware families continue trends we noted previously in macOS](https://www.sentinelone.com/blog/top-10-macos-malware-discoveries-in-2021-a-guide-to-prevention-detection/)\nmalware. DazzleSpy’s use of vulnerabilities is a clear warning to those that continue to insist\nMac users cannot get malware if they engage in “safe behavior”: such a stance does not\nmatch today’s threatscape.\n\nMeanwhile, SysJoker’s cross-platform backdoor functionality shows that threat actors are\nfactoring in Mac targets along with Windows and Linux as they develop new ways to steal\ndata and compromise organizations. As with all your other endpoints, it is vital to keep your\nMac fleet protected by a capable, defense-in-depth security solution such as the SentinelOne\nplatform.\n\nIf you would like to learn more about how SentinelOne can protect your Mac, Windows,\n[Linux, ChromeOS, IoT and Cloud workload endpoints, contact us or request a](https://www.sentinelone.com/contact/) [free demo.](https://www.sentinelone.com/request-demo/)\n\n## Indicators of Compromise\n\n**OSX.SysJoker**\n\nDNS REQUESTS\ndrive.google.com.\ngooglehosted.l.googleusercontent.com.\ngraphic-updater.com.\n\n\n-----\n\nDNS RESPONSES\n142.250.199.14\n216.58.199.225\n216.58.203.78\n23.254.131.176\n36.4.104.0\n\nCOMMANDS EXECUTED\n/bin/sh\n/bin/bash\n/usr/bin/whoami\n\nFILEPATHS\n/Users/root/Library/SystemNetwork\n~/Library/MacOsServices/updateMacOs\n\nHASHES\n**updateMacOs**\n554aef8bf44e7fa941e1190e41c8770e90f07254\n1a9a5c797777f37463b44de2b49a7f95abca786db3977dcdac0f79da739c08ac\n\n**types-config.ts**\n01d06375cf4042f4e36467078530c776a28cec05\nd0febda3a3d2d68b0374c26784198dc4309dbe4a8978e44bb7584fd832c325f0\n\n**OSX.DazzleSpy**\n\nFILEPATHS\n~/Library/LaunchAgents/com.apple.softwareupdate.plist\n~/.local/softwareupdate\n~/.local/security.zip\n~/.local/security/keystealDaemon\n.Documenty/security/libkeystealClient.dylib\n.Documenty/security/keys.err\n.Documenty/security/security-unsigned\n.Documenty/security/keystealDaemon\n\nC2\n88.218.192[.]128:5633\n\nHASHES\n**server.enc**\nee0678e58868ebd6603cc2e06a134680d2012c1b\nf9ad42a9bd9ade188e997845cae1b0587bf496a35c3bffacd20fefe07860a348\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-01 - Sneaky Spies and Backdoor RATs - SysJoker and DazzleSpy Malware Target macOS.pdf"
    ],
    "report_names": [
        "2022-02-01 - Sneaky Spies and Backdoor RATs - SysJoker and DazzleSpy Malware Target macOS.pdf"
    ],
    "threat_actors": [
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536174,
    "ts_updated_at": 1743041613,
    "ts_creation_date": 1653767778,
    "ts_modification_date": 1653767778,
    "files": {
        "pdf": "https://archive.orkl.eu/62a9c51d2b8851538aa6fecca715f4d3ba8fe298.pdf",
        "text": "https://archive.orkl.eu/62a9c51d2b8851538aa6fecca715f4d3ba8fe298.txt",
        "img": "https://archive.orkl.eu/62a9c51d2b8851538aa6fecca715f4d3ba8fe298.jpg"
    }
}