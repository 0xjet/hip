{
    "id": "42069f27-49b8-4413-8a31-c296b8307b46",
    "created_at": "2023-01-12T15:01:16.676074Z",
    "updated_at": "2025-03-27T02:06:10.312547Z",
    "deleted_at": null,
    "sha1_hash": "68749240ea733d5ec2b49197aee408fe243fe8e6",
    "title": "2020-09-29 - LodaRAT Update- Alive and Well",
    "authors": "",
    "file_creation_date": "2022-05-28T16:53:11Z",
    "file_modification_date": "2022-05-28T16:53:11Z",
    "file_size": 3993164,
    "plain_text": "# LodaRAT Update: Alive and Well\n\n**[blog.talosintelligence.com/2020/09/lodarat-update-alive-and-well.html](https://blog.talosintelligence.com/2020/09/lodarat-update-alive-and-well.html)**\n\n[By Chris Neal.](https://twitter.com/g0jirasan)\n\nDuring our continuous monitoring of LodaRAT, Cisco Talos observed changes in the\nthreat that add new functionality.\nMultiple new versions of LodaRAT have been spotted being used in the wild.\n\n\n-----\n\nThese new versions of LodaRAT abandoned their previous obfuscation techniques.\nDirect interaction with the threat actor was observed during analysis, indicating the\nactor is actively monitoring infected hosts.\n\n### What's New?\n\nTalos recently identified new versions of LodaRAT, a remote access trojan written in AutoIt.\nNot only have these versions abandoned their usual obfuscation techniques, but several\nfunctions have also been rewritten and new functionality has been added. In one version, a\nhex-encoded PowerShell keylogger script has been added, along with a new VB script, only\nto be removed in a later version. Direct interaction from the threat actor was observed during\nanalysis.\n\n### So What?\n\nSince our [blog post on Loda in February 2020, Talos has been continually monitoring](https://blog.talosintelligence.com/2020/02/loda-rat-grows-up.html)\nLodaRAT for new behavior. Recently there have been several changes that indicate that the\nauthors are learning new techniques to improve the effectiveness of Loda. While these\nchanges are somewhat minor, it shows that the authors are continually developing Loda into\na more robust RAT.\n\n## Distribution\n\nIn previous campaigns, the infection chain started with a malicious Microsoft Word document\n[that downloaded a second document which then exploited CVE-2017-11882. The exploit](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882)\npayload in turn downloaded an MSI that contained the compiled Loda AutoIt script.\n\nThe samples analyzed in this post were distributed in a much simpler manner. Loda is now\nbeing distributed via a malicious RAR archive attached to phishing emails. Here's a look at\none of these emails:\n\nThe RAR attachments have the file extension \".rev\" and contain the compiled Loda AutoIt\nbinary. Actual \".rev\" files are recovery files that can be created alongside multi-volume RAR\n\n\n-----\n\narchives. However, the files attached to these emails were standard RAR files with the\nextension name changed.\n\nThe overall complexity of this infection chain is significantly lower than previous campaigns,\nwhich may be a detriment to the effectiveness of the current campaigns. Execution relies\nsolely on the target user double-clicking on the binary and running it, rather than triggering\nan exploit to start an infection chain that is more or less automated.\n\n## Malware\n\nDuring our investigation, multiple versions of Loda were found to be distributed at the same\ntime. The overall functionality of the different versions is quite similar to one another, with\nsome key differences. The different versions being used at the same time could indicate that\nthere are several threat actors using Loda, with each actor in possession of a different\nversion. In our investigation, most samples found in the wild are older versions â€” the newest\nversions being less common.\n\nThe version numbers embedded in Loda do not have a reliable order. In our previous Loda\npost, the version number was \"1.1.1,\" which has not been incremented in some new\nversions, even though there have been multiple updates and changes. However, we have\nalso identified a new version labeled \"1.1.7\" which has additional changes to its code and\nfunctionality. Consequently, these numbers should be considered unreliable as the sole\ndetermining factor for identifying the version of Loda being analyzed. The string \"beta\" has\nbeen seen in every version of Loda as well.\n\n_Version number 1.1.1_\n\n\n-----\n\n_Version number 1.1.7_\n\n## Obfuscation\n\nThe most readily apparent change in these new iterations of Loda is the complete removal of\nany obfuscation. Typically, Loda utilizes a combination of string obfuscation and function\nname randomization. These techniques may have been abandoned since they no longer\nprovide a significant reduction in AV detection. The image below shows obfuscated code\nfrom a previous version of Loda, containing both random function names and string\nobfuscation.\n\nThe next image is of the same section of code from the recent version of Loda. The functions\nhave meaningful names and there is a complete lack of string obfuscation.\n\n\n-----\n\n## 1.1.1\n\nAs for new functionality, the new version labeled as 1.1.1 has implemented a PowerShell\nkeylogger that is stored as a hex-encoded string as shown below:\n\n_Hex-encoded PowerShell script_\n\n\n-----\n\n_Decoded keylogger_\n\n[This PowerShell script appears to be copied and pasted from a short blog post with the](https://community.idera.com/database-tools/powershell/powertips/b/tips/posts/creating-simple-keylogger)\ncomments removed. If the command \"MgPlugUp\" is received from C2, the script is written to\na file called \"tmpwstz21.ps1\" and executed. The logs are output into the temp directory as a\ntext file named with the current date.\n\nA VB script has also been added that searches for the Loda AutoIt script by process name to\n\n\n-----\n\nensure only one instance is running. This script is also partially stored as a hex-encoded\nstring that is decoded and appended to a file called \"BYDVRI.vbs\".\n\n_Hex-encoded script_\n\n_Decoded VB script_\n\n## 1.1.7\n\n\n-----\n\nThe version of Loda labeled as 1.1.7 has made several changes, most notably removing the\nPowerShell script and the VB script mentioned above. Numerous small improvements have\nbeen made to the code's syntax and cleanliness, although a large portion remains\nunchanged. This newest version focuses on what Loda was originally intended for: stealing\npasswords and cookies from browsers.\n\nThe only new function in 1.1.7 is shown below. First, Loda detects the OS version by using\nthe AutoIt [macro \"@OSVERSION\" and copies itself to either the Temp or startup directories](https://www.autoitscript.com/autoit3/docs/macros.htm)\ndepending on the version of Windows. After copying itself, it then executes the copy.\n\nAlthough the version number is 1.1.7, this iteration of Loda appears to have reduced\nfunctionality. Some code may have been removed or altered for the sake of reliability.\n\n\n-----\n\n## Useless Code\n\nThere are two functions that persist through all versions of Loda that are effectively useless.\nThe first being the command \"QURAN.\" This command is intended to stream audio in\nWindows Media Player of a reading of the Quran on the infected host using the deprecated\nMMS protocol (Microsoft Media Server). The URL for this stream is\n\"live.mp3quran[.]net:9976\" which seems to no longer exist, effectively making the command\nunusable. This command is outlined in the previous LodaRAT post.\n\nThe second function is \"__SQLITE_DOWNLOAD_SQLITE3DLL\" which attempts to\ndownload a SQLite3 DLL from a dead URL.\n\n## C2\n\n[For both versions, C2 communication has shifted to abusing legitimate services. Ngrok.io](https://ngrok.com/product)\n[and portmap.io were both observed to be used during analysis. These services are intended](https://portmap.io/)\nto be used by developers and administrators to communicate with hosts not directly\nconnected to the internet but can easily be abused by threat actors for purposes of\nanonymization. Talos has previously covered threats that use this technique and can be read\n[about here.](https://blog.talosintelligence.com/2019/08/rat-ratatouille-revrat-orcus.html)\n\nWhile performing analysis on version 1.1.1, several commands from C2 were observed in\nreal-time. The first command that Loda typically receives from C2 is the \"Screen\" command,\nwhich sends a screenshot of the infected host back to C2. This command is sent at regular\nintervals to continuously provide the threat actor with a current screenshot of the host.\n\nAfter several screenshots were sent to the C2 server, the threat actor responded and\ninteracted directly with our analysis machine. The command \"MpS8x\" was used to generate\na small VB script to display a message box with a custom message.\n\n\n-----\n\n_\"MpS8x\" command_\n\nJudging from the content of the message, the threat actor realized the malware was running\nin a sandbox. An interesting aspect of this interaction is that there is no sandbox detection\nfunction within Loda itself. Prior to this message box, there was no data sent to C2 that\nindicated that the malware was running on a virtual machine. Without this functionality, the\nthreat actor realized they were looking at a sandbox purely from the appearance of the\nscreenshot. This direct interaction indicates that the threat actor is actively monitoring\ninfected hosts.\n\n_Packet capture of the interaction_\n\n\n-----\n\n_Resulting message box_\n\nIt is worth reiterating that most instances of Loda found in the wild are older versions that still\nuse the same techniques. The unobfuscated versions analyzed in this post are quite rare in\ncomparison to previous versions. The frequency of use may increase over time if the new\niterations of Loda prove to be effective. It is also worth mentioning that these versions may\nalso soon employ string obfuscation and function name randomization, as Loda has\nhistorically used these techniques regularly.\n\n## Conclusion\n\n\n-----\n\nLoda continually proves to be an effective RAT and consistently changes and adds to its\nfunctionality. While some of these changes are minor and simplified in some ways, it displays\nthat Loda is constantly evolving. This malware poses a serious threat to an infected host due\nto its capabilities. Loda may be simple, but it is more than effective enough to cause serious\nfinancial damage.\n\n### COVERAGE\n\n**Snort**\n\n[SID] 53031\n\n**OSQUERY**\n\nCisco AMP users can use Orbital Advanced Search to run complex OSqueries to see if their\nendpoints are infected with this specific threat. For specific OSqueries on this threat, click\nbelow:\n\n[Loda RAT File Path](https://github.com/Cisco-Talos/osquery_queries/blob/master/win_malware/malware_lodarat_filepath.yaml)\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nmalware used by these threat actors.\n\n\n-----\n\n[Cisco Cloud Web Security (CWS) or](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html) [Web Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\naccess to malicious websites and detects malware used in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity](https://meraki.cisco.com/products/appliances)\nassociated with this threat.\n\n[AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\nIOCs\n\nAttachments\n\n0d181658d2a7f2502f1bc7b5a93b508af7099e054d8e8f57b139ad2702f3dc2d\n\nfcbaf2e5ed0b1064da6a60101f231096164895328fd6c338b322b163d580b6e3\n\ncf40e1ec36f44e20a9744e8038987527027e2a6ee7e96d9044842f92ece9d7e8\n\n05d2fa5bb97f37edaaff99f58ffedbd438e928fb3881ede921a19b07fb884b0b\n\n1.1.1\n\n866397c8db26190c5a346bd863d9beb81e53d96011af9a3be6eeb713bbb57287\n\ncfb12ee4004cea2a396e1cecd7105760b17a73a67a95156d675cfec76fc37ba2\n\n70526973e70acef4a71f474b0e321b9e600a327522903ee6bfac4e6f07935f7f\n\nf169680d8f24694e2d99c9df31988511e212e088f4dc2854ef059915019e8348\n\n1.1.7\n\n2d317bcccea4739b2deefcc3b14cf5eafe147162f62c5ff1288db3635b5c3f10\n\nC2\n\nhttp://roodan888tools[.]atwebpages[.]com/ng.txt\n\n\n-----\n\nIPs associated with samples:\n\n193[.]161[.]193[.]99\n\n174[.]126[.]51[.]178\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-29 - LodaRAT Update- Alive and Well.pdf"
    ],
    "report_names": [
        "2020-09-29 - LodaRAT Update- Alive and Well.pdf"
    ],
    "threat_actors": [
        {
            "id": "7268a08d-d4d0-4ebc-bffe-3d35b3ead368",
            "created_at": "2022-10-25T16:07:24.225216Z",
            "updated_at": "2025-03-27T02:02:10.144446Z",
            "deleted_at": null,
            "main_name": "Sprite Spider",
            "aliases": [
                "Gold Dupont",
                "Sprite Spider"
            ],
            "source_name": "ETDA:Sprite Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Coroxy",
                "Defray 2018",
                "Defray777",
                "DroxiDat",
                "Glushkov",
                "LaZagne",
                "Metasploit",
                "PyXie",
                "PyXie RAT",
                "Ransom X",
                "RansomExx",
                "SharpHound",
                "Shifu",
                "SystemBC",
                "Target777",
                "Vatet",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "27e51b73-410e-4a33-93a1-49cf8a743cf7",
            "created_at": "2023-01-06T13:46:39.210675Z",
            "updated_at": "2025-03-27T02:00:03.022315Z",
            "deleted_at": null,
            "main_name": "GOLD DUPONT",
            "aliases": [
                "SPRITE SPIDER"
            ],
            "source_name": "MISPGALAXY:GOLD DUPONT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535676,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1653756791,
    "ts_modification_date": 1653756791,
    "files": {
        "pdf": "https://archive.orkl.eu/68749240ea733d5ec2b49197aee408fe243fe8e6.pdf",
        "text": "https://archive.orkl.eu/68749240ea733d5ec2b49197aee408fe243fe8e6.txt",
        "img": "https://archive.orkl.eu/68749240ea733d5ec2b49197aee408fe243fe8e6.jpg"
    }
}