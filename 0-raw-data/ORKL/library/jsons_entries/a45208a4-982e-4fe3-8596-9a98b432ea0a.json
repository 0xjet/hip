{
    "id": "a45208a4-982e-4fe3-8596-9a98b432ea0a",
    "created_at": "2023-01-12T15:04:56.585534Z",
    "updated_at": "2025-03-27T02:09:15.371712Z",
    "deleted_at": null,
    "sha1_hash": "2b2cf4f1dc9fe6317c3a5a7ab30299e642b45d1c",
    "title": "2020-09-25 - APT-C-43 steals Venezuelan military secrets to provide intelligence support for the reactionaries - HpReact campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T03:46:31Z",
    "file_modification_date": "2022-05-28T03:46:31Z",
    "file_size": 964662,
    "plain_text": "# APT-C-43 steals Venezuelan military secrets to provide intelligence support for the reactionaries — HpReact campaign\n\n**blog.360totalsecurity.com/en/apt-c-43-steals-venezuelan-military-secrets-to-provide-intelligence-support-for-the-**\nreactionaries-hpreact-campaign/\n\nSeptember 25, 2020\n\nSep 25, 2020kate\n\n[Tweet](https://twitter.com/share)\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\nIn June 2020, 360 Security Center discovered a new backdoor Pyark written in Python by the\nfileless attack protection function. Through in-depth excavation and trace analysis of the\nbackdoor, we discovered a series of advanced threat actions that have been active since\n2019. By invading various military institutions in Venezuela, the attackers deployed backdoor\nto continuously monitor and steal the latest military secrets. We named it APT-C-43 based on\n360’s way of naming the APT organization\n\nWhen tracing the attacker’s source, we found that the duration of this attack coincided with\nthe Venezuelan political chaos, and the network assets used by the attackers were mostly\ndeployed in Colombia, and some assets were frequently found in Venezuela and Colombia.\nAfter the United Venezuelan coup, the reactionary government headed by Juan Gerardo\nGuaidó Márquez fled to Colombia to seek military assistance. We guess the political\nbackground of APT-C -43’s campaign may be to help the reactionaries led by Juan steal\nmilitary secrets of the Venezuelan military and provide intelligence support for the\nconfrontation between the reactionary government and the current Venezuelan government.\nTherefore, we named this series of attacks HpReact.\n\nIn the process of tracing the source, the campaign was linked to the APT group Machete,\nand Machete can be traced back to 2010. The organization is an APT organization with\nSpanish roots. Its targets are military, embassies and government agencies in Latin America.\nthe Lord. Obviously, the HpReact campaign is only a small part of the organization’s cyber\nwarfare in Latin America.\n\nThe picture below shows the decoy document used by APT-C-43 in this campaign. The\ncontent of the document is a policy issued by the Venezuelan authorities to prevent deserters\nfrom going to Colombia to support the reactionary government. More about this policy. For\ndetails, please refer to Appendix 1. It can be seen that the attackers have a good\nunderstanding of Venezuela’s current politics, military, etc., and are good at using such\nsensitive files to make decoy documents, which are highly targeted and inductive.\n\n\n-----\n\n## Technical Details\n\n\n-----\n\nThe APT-C-43 organization is good at launching attacks using phishing emails, and deploys\nthe backdoor program Pyark (Machete) written in python after invading the victim’s machine.\nThe network communication mainly relies on FTP and HTTP protocols. After successfully\ninfiltrating the target machine, APT-C-43 organization monitors the target users, steal\nsensitive data, etc. The complete process of infecting the target machine is as follows:\n\n### The infection process\n\nThe decoy document carries malicious macrocode. Download the next stage of malicious\ncomponent NisSrv.bat through FTP protocol, and we can see many variables named after\nSpanish vocabulary in the code, such as servidor (server), Usuario (user name), Contraseña\n(password), etc.:\n\n\n-----\n\nNisSrv.bat downloads malicious components:\n\nThe file of “setupXOX.msi” is a Windows Installer installation program made by MSI Wrapper\nto deploy the final backdoor components. When we studied the historical samples of the\nMachete organization, we found that the organization’s technology for deploying backdoor\nhas undergone an important change, with a clear time division. Through the following\ntimeline, we can clearly see that the organization is constantly changing and innovating its\nown Attack technique:\n\nMany fields in the installation program are forged into Acrobat Reader installation program,\nand the interface after running is related to Acrobat Reader:\n\n\n-----\n\nAfter the program runs, the Fpyark backdoor components will be released to the\n%ProgramData%\\USOEnable directory. The backdoor of Fpyark is writing by python. During\nthe running process, python is required to execute the environment and various dependent\nlibraries required by the script, which also caused the size of setupXOX.msi to reach 8.10M.\nAfter installation, the entire directory structure is as follows:\n\n\n-----\n\nAfter deploying the above backdoor components, run svchostt.exe according to the\nmsiwpper configuration file:\n\nThe file of “setupXOX.msi” is a virus releaser written in Microsoft Visual Basic language,\nwhich releases NisSrv.bat registered scheduled tasks to realize self-starting and staying. The\nprogram has the following vbp compilation path:\n\n@*\\AC:\\Users\\MITM\\Desktop\\malware\\3_svchostt\\Proyecto1.vbp\n\nThe relevant code is as follows:\n\n\n-----\n\n### Backdoor module\n\nUpdateSession is the main control module of the backdoor. Its functions include self-starting\nof the backdoor, collection of network configuration, keystroke records, and schedule other\nmodules to execute by means of timers:\n\nUpdateService traverses the disk directory and collects more than ten kinds of sensitive files\nwith suffixes such as doc, xlsx, and pdf in other directories, except for some system\ndirectories and security software directories.\n\n\n-----\n\nUpdateDevice takes screenshot\n\nCapture camera screen:\n\nUpdatePlugin takes audio from the microphone:\n\n\n-----\n\nNotification is responsible for uploading the sensitive data collected by the above modules to\nthe FTP server:\n\n\n-----\n\nThe interactive traffic characteristics are as follows:\n\n\n-----\n\nWhen analyzing the uploaded FTP server, we found that APT-C-43 manages the uploaded\nsensitive files through Tiny File Manager:\n\n\n-----\n\n## Summary\n\nThe entire campaign of HpReact highly coincides with the timeline of Venezuelan political\nturmoil. APT-C-43 took Venezuelan military agencies as the main targets and carried out\nsurveillance and stealing activities for about two years, forming a significant impact on\nVenezuela’s national security. Great safety hazard. In recent years, with the intensification of\ncyber warfare in various countries, cyberspace security has become another important area\nfor each country to maintain national security, and building a strong cybersecurity has\nbecome a top priority for each country.\n\nAt present, 360 Total Security has supported the detection of attacks on this organization.\n\n## Team Introduction\n\n360 Baize Lab (formerly 360 FirstAid team): Focusing on BOOTKIT/ROOTKIT Trojan\nanalysis and traceability, it was the first to discover the world’s first UEFI Trojan Spy Shadow\n（UEFI木马谍影），boot area Trojan Hidden Soul（引导区木马隐魂），dual guns（双枪,）\nand multiple large-scale dark brush botnets, such as black fog and diaster. Now it is renamed\n360 Baize Lab based on the original business, it is involved in APT testing and research. The\nlaboratory provides core safety data for 360 Security Guards, 360 FirstAid team and other\nproducts, as well as stubborn Trojan detection and killing solutions, while providing 360\nSecurity Center Technical Support.\n\n## Appendix 1\n\n\n-----\n\nhttps://www.totalnewsagency.com/internacionales/ante-la-alarmante-desercion-el-ministrode-defensa-de-venezuela-ordeno-convencer-a-los-soldados-de-regresar-como-sea\n\n## Appendix 2\n\nhttps[:]//securelist.com/el-machete/66108\n\nhttps[:]//www.welivesecurity.com/wp-content/uploads/2019/08/ESET_Machete.pdf\n\n## Appendix 3\n\nMD5:\n\nfbe5b66db57fb52b231c5374ac2ac805\n\n6b33fa0c52ca413d4214dcde007f89c1\n\nf85489c1d1ff3374f92ccb7267032016\n\nIP:\n\n92.249.44.53\n\n185.70.105.33\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-25 - APT-C-43 steals Venezuelan military secrets to provide intelligence support for the reactionaries - HpReact campaign.pdf"
    ],
    "report_names": [
        "2020-09-25 - APT-C-43 steals Venezuelan military secrets to provide intelligence support for the reactionaries - HpReact campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "d303c77e-0110-471b-a3a6-37fce9ac848d",
            "created_at": "2022-10-25T15:50:23.342452Z",
            "updated_at": "2025-03-27T02:00:55.447692Z",
            "deleted_at": null,
            "main_name": "Machete",
            "aliases": [
                "APT-C-43",
                "El Machete"
            ],
            "source_name": "MITRE:Machete",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "edc11896-f4f1-4132-9c38-d073ccdcf5b6",
            "created_at": "2022-10-25T16:07:23.576476Z",
            "updated_at": "2025-03-27T02:02:09.873658Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "ATK 97",
                "Operation HpReact",
                "TAG-NS1",
                "TEMP.Andromeda"
            ],
            "source_name": "ETDA:El Machete",
            "tools": [
                "El Machete",
                "ForeIT",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "Pyark"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ba4f277c-c3da-45e6-a2fb-4ed556dbae64",
            "created_at": "2023-01-06T13:46:38.605117Z",
            "updated_at": "2025-03-27T02:00:02.871423Z",
            "deleted_at": null,
            "main_name": "El Machete",
            "aliases": [
                "APT-C-43",
                "G0095",
                "machete-apt"
            ],
            "source_name": "MISPGALAXY:El Machete",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535896,
    "ts_updated_at": 1743041355,
    "ts_creation_date": 1653709591,
    "ts_modification_date": 1653709591,
    "files": {
        "pdf": "https://archive.orkl.eu/2b2cf4f1dc9fe6317c3a5a7ab30299e642b45d1c.pdf",
        "text": "https://archive.orkl.eu/2b2cf4f1dc9fe6317c3a5a7ab30299e642b45d1c.txt",
        "img": "https://archive.orkl.eu/2b2cf4f1dc9fe6317c3a5a7ab30299e642b45d1c.jpg"
    }
}