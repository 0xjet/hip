{
    "id": "e4d62d42-40c1-4a43-84ba-656b28af230d",
    "created_at": "2022-10-25T16:48:13.629847Z",
    "updated_at": "2025-03-27T02:05:58.921084Z",
    "deleted_at": null,
    "sha1_hash": "d95f10b2f4711a2f0b410ad5218a49f0a80e8c13",
    "title": "Damballa discovers new toolset linked to Destover",
    "authors": "",
    "file_creation_date": "2015-11-20T11:50:20Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 292405,
    "plain_text": "# Day Before Zero Blog\n\n\n## Damballa discovers new toolset linked to Destover Attacker’s arsenal helps them to broaden attack surface\n\n**November 18, 2015**\n\n**[Tags: Destover, malware, trojan](https://www.damballa.com/tag/destover/)**\n\n**Destover is best known as the malware used in**\n\n**[the attack on Sony Pictures Entertainment](https://en.wikipedia.org/wiki/Sony_Pictures_Entertainment_hack)** **in**\n\n**November 2014, and also for its relationship**\n\n**based on its wiping technique with the Shamoon**\n\n**[malware used in the attack on Saudi Aramco](http://money.cnn.com/2015/08/05/technology/aramco-hack/index.html)** **in**\n\n**2012. The Destover trojan is a wiper that deletes**\n\n**files off of an infected system, rendering it�**\n\n**useless.**\n\n**Unlike most malware, the goal of Destover and**\n\n**other wiping malware is to cause damage for**\n\n**ideological and political reasons not for financial�**\n\n**gain. For example, at Sony, attackers wiped files�**\n\n**off of workstations making them completely**\n\n**inoperative for unclear political goals of the**\n\n**attackers. The Saudi Aramco attack using Shamoon was so destructive it temporarily drove up the price**\n\n**[of hard drives because an estimated 50,000 were needed to help Saudi Aramco recover, also for](http://www.darkreading.com/attacks-breaches/inside-the-aftermath-of-the-saudi-aramco-breach/d/d-id/1321676)**\n\n**[unclear ideological and political motives against the Al-Saud royal family.](http://pastebin.com/HqAgaQRj)**\n\n**Much was revealed In the weeks and months following these breaches, except for how attackers were**\n\n**able to stay undetected within the network long enough to expand their presence and exfiltrate�**\n\n**Terabytes of sensitive information.**\n\n\n-----\n\n**closely related to Destover. Both utilities would be used during an attack to evade detection while**\n\n**moving laterally through a network to broaden the attack surface. Both utilities had usage statements**\n\n**and were named as setMFT and afset.**\n\n#### What is setMFT?\n\n**setMFT is used to copy the timestamp settings from a source file on disk to a destination file, also�**\n\n**called timestomping. Timestomping combined with similar file naming enables a file to blend in with�**\n\n**legitimate files in the same directory. This can conceal a file’s existence from security personnel looking�**\n\n**for malicious files or scans of files created after a certain date. Timestomping can get past a cursory�**\n\n**check for malicious files. A thorough forensic examination will reveal that a file has been timestomped�**\n\n**based on conflicting record dates and possibly log files.�**\n\n**The sample discovered by Damballa requires the presence of the file ‘usbdrv3.sys’ in the same�**\n\n**directory. It turns out to be the renamed Eldos RawDisk driver used by Destover to gain direct access to**\n\n**disk. Either the driver is meant to be delivered with setMFT or is dropped along with setMFT from**\n\n**Destover itself. Destover and setMFT are related via the lengthy license key used with the Eldos driver:**\n\n**99E2428CCA4309C68AAF8C616EF3306582A64513E55C786A864BC83DAFE0C78585B692047273**\n\n**B0E55275102C664C5217E76B8E67F35FCE385E4328EE1AD139EA6AA26345C4F93000DBBC7EF1579D4F**\n\n**Another feature is that this utility interacts with the attacker through on the command line rather than**\n\n**being delivered and executed by a dropper without interaction. setMFT comes with an English usage**\n\n**statement in case the attacker forgets the placement of arguments:**\n\n#### What is afset?\n\n**afset, like setMFT is also used to timestomp files plus clean Microsoft Windows logs based on criteria�**\n\n**(id, time) from the user. It also changes the PE build time and checksum. afset provides more granular**\n\n**functionality to allow the user to set only certain timestamps on a file (sia, fna or both). To achieve the�**\n\n**timestomping and log cleaning functions, afset uses the RawDisk driver with the same lengthy license**\n\n**key.**\n\n**The afset sample we obtained appeared to be incomplete or a partial development version. The sample**\n\n**attempted to write a randomly named file with a .sys extension to the local directory with the contents of�**\n\n**the “ICONS” resource which is supposed to be the encoded RawDisk driver. However, it failed to**\n\n**decode on execution. If the driver write had completed it would have registered as a service using the**\n\n**same random driver name. Plus, it would have been used to obtain a handle to write the MFT record for**\n\n**the target file to match either a user supplied file or by default the file�**\n\n**“%SYSTEMROOT%\\system32\\tapi32.dll”.**\n\n**According to the handy usage statement, conditional log cleaning is only available on 32-bit systems.**\n\n**From our dynamic testing, it appears to clear the event log and then rewrite it without the offending**\n\n**entries. A full reversing of the log cleaning feature was not performed and dynamic analysis failed due**\n\n**to errors in the driver extraction routine from the resources. Fortunately, the usage statement gives**\n\n**insight to the full functionality of the tool:**\n\n\n-----\n\n**Afset is used interactively on the target system. It allows the attacker to remain stealthy and erase their**\n\n**tracks as they move through the network. A full forensic analysis of a system would reveal the**\n\n**presence of afset and missing log activity but it’s likely this activity would go undetected initially creating**\n\n**high-risk infection dwell time.**\n\n**For enterprise security teams, the utility of setMFT and afset means that many of the tools and methods**\n\n**they use to identify the presence of attackers would be thwarted. If the adversary gains access to**\n\n**corporate servers and can clean and redirect log files, they can prevent any evidence of their activity�**\n\n**from reaching a SIEM or log analysis solution.**\n\n**These tools appear to have limited distribution, which means that newer versions of the tools could go**\n\n**undetected by standard AV for an extended length of time. Also, as mentioned, the ability to have the**\n\n**tools blend with legitimate system files allows the attacker to evade detection during a cursory glance�**\n\n**by personnel. These capabilities, when used together with tools that enable attackers to obtain network**\n\n**credentials and disable defenses, allows them to permeate the network undetected for an extended**\n\n**period of time.**\n\n#### Conclusion\n\n**The attackers behind large and long-lasting attacks are very well organized, patient and determined.**\n\n**Toolsets like Destover, afset and setMFT are part of an arsenal used during a cyber attack. These tools**\n\n**are mainly used to help the attackers remain under the radar for months or longer. Gaining a foothold**\n\n**inside the victim’s network is a top priority. History tells us that in most of the high-profile hacks making�**\n\n**news headlines, the attackers were able to spend months hidden inside the victim’s network exfiltrating�**\n\n**Terabytes of data.**\n\n**Attack modus-operandi:**\n\n\n**_Steps_**\n\n**Reconnaissance**\n\n**_Tools_**\n\n**Scanners, Open source intelligence gathering**\n\n**_Steps_**\n\n**Breach**\n\n\n-----\n\n**_Steps_**\n\n**Foothold**\n\n**_Tools_**\n\n**afset, setMFT, RATs, credential theft**\n\n**_Steps_**\n\n**Move laterally**\n\n**_Tools_**\n\n**Stolen administrative credentials and RATs**\n\n**_Steps_**\n\n**Exfiltrate�**\n\n**_Tools_**\n\n**VPN accounts, RATs, out of band comms**\n\n**_Steps_**\n\n**Delete tracks**\n\n**_Tools_**\n\n**afset, setMFT, Destover / Shamoon**\n\n**_Steps_**\n\n**Exit**\n\n**_Tools_**\n\n**Publish stolen data, clean with Destover / Shamoon**\n\n\n**The table above, represents the different steps attackers would go through to penetrate a network and**\n\n**where they could use the new afset and setMFT utilities. They are used for different purposes and at**\n\n**different steps. There is no doubt that attackers are using these tools right now and are continuing to**\n\n**develop their capabilities.**\n\n#### IOCs\n\n**afset**\n\n**MD5: b5ddd6ed3bd16c6f438b3bc95a2b49a8**\n\n**SHA256: 38c87a92694b597e5d402342ab4a9ff88b5b81beb2791405637bdca2b8384eac**\n\n**setMFT**\n\n**MD5: f83f9d1797f5dbd419dfa86987790153**\n\n**SHA256: fe30da9e47010d3522d30ff90fb10d6c30302e8d16001c1a12c149b508888ab8**\n\n**YARA**\n\n\n-----\n\n**description = “Rule to detect Destover trojan and associated tools by license key”**\n\n**author = “Willis McDonald”**\n\n**company = “Damballa Inc.”**\n\n**reference = “not set”**\n\n**date = “2015/10/30”**\n\n**strings:**\n\n**$key = “99E2428CCA4309C68AAF8C616EF3306582A64513E55C786A864BC83DAFE0C**\n\n**78585B692047273B0E55275102C664C5217E76B8E67F35FCE385E4328EE1AD139EA6AA2634**\n\n**5C4F93000DBBC7EF1579D4F”**\n\n**$MZ = “MZ”**\n\n**condition:**\n\n**$key and $MZ at 0**\n\n**}**\n\n**Willis McDonald**\n\n**Sr. Threat Researcher**\n\n**Loucif Kharouni**\n\n**Sr. Threat Researcher**\n\n##### Share this:\n\n You might also like\n\n\n**[Point of Sale (POS) and Card Reader Tampering](https://www.damballa.com/point-of-sale-pos-and-card-reader-tampering/)**\n\n\n**Learning from DNS**\n\n\n**The IMDDOS Botnet Service**\n\n\n**The ZitMo Rewind**\n\n\n-----\n\n**Is Mac OS X secure?**\n\n\n###### A B O U T D A M B A L L A\n\n**[Damballa delivers advanced threat protection for active threats that bypass traditional security](https://www.damballa.com/)**\n\n**layers, rapidly discovering infections with certainty and pinpointing compromises that represent**\n\n**the highest risk to a business.**\n\n\n##### Email Us to Learn More\n\n\n-----\n\n###### E V E N T S\n\n**2015 Seattle SecureWorld**\n\n**RSA Conference 2016**\n\n###### N E W S\n\n**[Hackers can still access your car in more than 15 ways](http://www.11alive.com/story/tech/2015/11/17/hackers-can-access-your-car-in-more-than-15-ways/75932832/)**\n\n**[Scammer turned ‘cybercriminal’ asks Damballa for help installing Pony Loader](http://www.scmagazine.com/scammer-turned-cybercriminal-asks-damballa-for-help-installing-pony-loader/article/453981/)**\n\n**5 CyberHacks That Could Affect Your Life in 2016**\n\n**817 W. Peachtree St. NW | Suite 800**\n\n**Atlanta, GA 30308**\n\n**Phone: 404 961 7400​**\n\n**[Email: info@damballa.com](mailto:info@damballa.com)**\n\n**[Safe Harbor Privacy Policy](https://www.damballa.com/company/safe-harbor/)**\n\n\n**© Copyright 2006-2015 Damballa,**\n\n**Inc.**\n### �\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.11.18.Destover/amballa-discovers-new-toolset-linked-to-destover-attackers-arsenal-helps-them-to-broaden-attack-surface.pdf"
    ],
    "report_names": [
        "amballa-discovers-new-toolset-linked-to-destover-attackers-arsenal-helps-them-to-broaden-attack-surface"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1448020220,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/d95f10b2f4711a2f0b410ad5218a49f0a80e8c13.pdf",
        "text": "https://archive.orkl.eu/d95f10b2f4711a2f0b410ad5218a49f0a80e8c13.txt",
        "img": "https://archive.orkl.eu/d95f10b2f4711a2f0b410ad5218a49f0a80e8c13.jpg"
    }
}