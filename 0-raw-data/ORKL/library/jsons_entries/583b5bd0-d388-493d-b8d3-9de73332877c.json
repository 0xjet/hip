{
    "id": "583b5bd0-d388-493d-b8d3-9de73332877c",
    "created_at": "2023-01-12T15:04:25.39147Z",
    "updated_at": "2025-03-27T02:05:37.823093Z",
    "deleted_at": null,
    "sha1_hash": "76b29cf4362cad3f631b458812310fa3eaef9584",
    "title": "2022-04-26 - Emotet malware now installs via PowerShell in Windows shortcut files",
    "authors": "",
    "file_creation_date": "2022-05-28T03:10:31Z",
    "file_modification_date": "2022-05-28T03:10:31Z",
    "file_size": 1375625,
    "plain_text": "# Emotet malware now installs via PowerShell in Windows shortcut files\n\n**[bleepingcomputer.com/news/security/emotet-malware-now-installs-via-powershell-in-windows-shortcut-files/](https://www.bleepingcomputer.com/news/security/emotet-malware-now-installs-via-powershell-in-windows-shortcut-files/)**\n\nIonut Ilascu\n\nBy\n[Ionut Ilascu](https://www.bleepingcomputer.com/author/ionut-ilascu/)\n\nApril 26, 2022\n05:17 PM\n1\n\nThe Emotet botnet is now using Windows shortcut files (.LNK) containing PowerShell\ncommands to infect victims computers, moving away from Microsoft Office macros that are\nnow disabled by default.\n\nThe use of .LNK files is not new, as the Emotet gang previously used them in a combination\nwith Visual Basic Script (VBS) code to build a command that downloads the payload.\nHowever, this is the first time that they utilized Windows shortcuts to directly execute\nPowerShell commands.\n\n## New technique after botched campaign\n\nLast Friday, Emotet operators [pulled the plug on a phishing campaign because they botched](https://www.bleepingcomputer.com/news/security/emotet-malware-infects-users-again-after-fixing-broken-installer/)\ntheir installer after using a static file name to reference the malicious .LNK shortcut.\n\n\n-----\n\nLaunching the shortcut would trigger a command that extracted a string of VBS code and\nadded it to a VBS file to execute.\n\nHowever, as the distributed shortcut files had a different name than the static one they were\nlooking for, it would fail to create the VBS file correctly. The gang fixed the problem\nyesterday.\n\nToday, security researchers noticed that Emotet switched to a new technique that uses\nPowerShell commands attached to the LNK file to download and execute a script on the\ninfected computer.\n\nThe malicious string appended to the .LNK file is obfuscated and padded with nulls (blank\nspace) so that it does not show in the target field (the file the shortcut points to) of the file’s\nproperties dialog box.\n\n_source: BleepingComputer_\nEmotet’s malicious .LNK file includes URLs for several compromised websites used for\nstoring the PowerShell script payload. If the script is present at one of the defined locations,\nit is downloaded to the system’s temporary folder as a PowerShell script with a random\nname.\n\nBelow is the deobfuscated version of the malicious string Emotet attached to the .LNK\npayload:\n\n\n-----\n\n_source: BleepingComputer_\nThis script generates and launches another PowerShell script that downloads the Emotet\nmalware from a list of compromised sites and save it to the %Temp% folder. The\ndownloaded DLL is then executed using the regsvr32.exe command.\n\nExecuting the PowerShell script is done using the Regsvr32.exe command-line utility and\nends with downloading and launching Emotet malware.\n\n[Security researcher Max Malyutin says that along with using PowerShell in LNK files, this](https://twitter.com/Max_Mal_/status/1518730615352401921)\nexecution flow is new to Emotet malware deployment.\n\n## New technique on the rise\n\nThe Cryptolaemus researcher group, which is closely monitoring Emotet activity, notes that\nthe new technique is a clear attempt from the threat actor to bypass defenses and automated\ndetection.\n\nSecurity researchers at cybersecurity company ESET also noticed that the use of the new\nEmotet technique has increased in the past 24 hours.\n\n\n-----\n\n_source:_ _[ESET](https://twitter.com/ESETresearch/status/1518923380782739458)_\nESET’s telemetry data shows that the countries most affected by Emotet via the new\ntechnique are Mexico, Italy, Japan, Turkey, and Canada.\n\nApart from switching to PowerShell in .LNK files, the Emotet botnet operators have made a\nfew other changes since they resumed activity to steadier levels in November, such\nas [moving to 64-bit modules.](https://www.bleepingcomputer.com/news/security/emotet-botnet-switches-to-64-bit-modules-increases-activity/)\n\nThe malware is typically used as a gateway for other malware, particularly ransomware\nthreats like Conti.\n\n## Related Articles:\n\n[Automate Windows tasks with this PowerShell certification bundle deal](https://www.bleepingcomputer.com/offer/deals/automate-windows-tasks-with-this-powershell-certification-bundle-deal/)\n\n[Historic Hotel Stay, Complementary Emotet Exposure included](https://www.bleepingcomputer.com/news/security/historic-hotel-stay-complementary-emotet-exposure-included/)\n\n[Using PowerShell to manage password resets in Windows domains](https://www.bleepingcomputer.com/news/security/using-powershell-to-manage-password-resets-in-windows-domains/)\n\n[Microsoft PowerShell lets you track Windows Registry changes](https://www.bleepingcomputer.com/news/microsoft/microsoft-powershell-lets-you-track-windows-registry-changes/)\n\n[EmoCheck now detects new 64-bit versions of Emotet malware](https://www.bleepingcomputer.com/news/security/emocheck-now-detects-new-64-bit-versions-of-emotet-malware/)\n\n[Ionut Ilascu](https://www.bleepingcomputer.com/author/ionut-ilascu/)\n\nIonut Ilascu is a technology writer with a focus on all things cybersecurity. The topics he\nwrites about include malware, vulnerabilities, exploits and security defenses, as well as\n\n\n-----\n\nresearch and innovation in information security. His work has been published by Bitdefender,\nNetgear, The Security Ledger and Softpedia.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-26 - Emotet malware now installs via PowerShell in Windows shortcut files.pdf"
    ],
    "report_names": [
        "2022-04-26 - Emotet malware now installs via PowerShell in Windows shortcut files.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535865,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653707431,
    "ts_modification_date": 1653707431,
    "files": {
        "pdf": "https://archive.orkl.eu/76b29cf4362cad3f631b458812310fa3eaef9584.pdf",
        "text": "https://archive.orkl.eu/76b29cf4362cad3f631b458812310fa3eaef9584.txt",
        "img": "https://archive.orkl.eu/76b29cf4362cad3f631b458812310fa3eaef9584.jpg"
    }
}