{
    "id": "b08d22d8-6cfb-4fc7-9c81-24ffd2929e2c",
    "created_at": "2023-01-12T15:07:17.183632Z",
    "updated_at": "2025-03-27T02:16:25.752432Z",
    "deleted_at": null,
    "sha1_hash": "ff925ed777dcfc4ba393e0d3a950500cf76f6266",
    "title": "2021-06-07 - Malware family naming hell is our own fault",
    "authors": "",
    "file_creation_date": "2022-05-28T02:22:30Z",
    "file_modification_date": "2022-05-28T02:22:30Z",
    "file_size": 971717,
    "plain_text": "# Malware family naming hell is our own fault\n\n**gdatasoftware.com/blog/malware-family-naming-hell**\n\nEternalPetya has more than 10 different names. Many do not realize that CryptoLocker is\nlong dead. These are not isolated cases but symptoms of a systemic problem: The way we\nname malware does not work. Why does it happen and how can we solve it?\n\n## Current state of malware naming\n\nMalware names are not clear. Neither the terms related to them have a common\nunderstanding, nor the names themselves. There is no common standard. There is no\ninstitution, database or organization that has an exhaustive list of malware names and their\ndefinition.\n\nOur current use of malware names and their creation suffer from the following problems.\n\n**Problem** **Examples**\n\n\nMalware families and variants\nhave several names\n\nOne name used\nsimultaneously for several\nfamilies\n\n\nEternalPetya probably holds the record. Some of its\nnames (not exhaustive): NonPetya, NotPetya, Petna,\nExPetr, Pnyetya, Nyetya, nPetya, BadRabbit,\nEternalBluePetya, BluePetya, petrWrap.\n\n[The ransomware JesusCrypt in 2019 and a different](https://twitter.com/malwrhunterteam/status/1194239320804220933)\n[JesusCrypt in 2021. Both use the .NET framework.](https://twitter.com/malwrhunterteam/status/1367450129603690501)\n\n\n-----\n\n**Problem** **Examples**\n\n\nMalware families are conflated\nwith their detection name\n\nMalware families are conflated\nwith their loader, downloader,\nspreading campaign, threat\nactor(s), or packer\n\nThe meaning of a name can\nchange over time\n\nThe meaning of a name can\ndepend on the person or\norganization using it\n\nThe same name is used for the\nfamily as well as the malware\ntype\n\n\nMalware prevalence reports by many antimalware\ncompanies write \"malware family\" but use detection\nnames.\n\nGootkit and its loader were conflated, although the\nloader also ships other families than Gootkit.\n\nNemucod was at first only a family and was later used to\nrefer to malicious JScript downloaders in general.\n\nArtemis by McAfee does not refer to the malware family\nbut to a detection technology.\n\nCryptoLocker may refer to the ransomware family or file\nencrypting ransomware in general.\n\n\n## Terminology: Detection names are misunderstood\n\n[As I explained in my previous article about detection names, the](https://www.gdatasoftware.com/blog/2019/08/35146-taming-the-mess-of-av-detection-names) CARO Virus Naming\nConvention back in 1991 were an attempt to streamline malware naming and taxonomy.\nHowever, the threat landscape changed which made CARO's naming convention outdated.\nAs a result the antimalware industry adopted and modified the CARO's naming convention to\ntheir own needs; but the purpose of these malware names shifted from identification to\ndetection.\n\n**Identification has the goalto determine the correct malware family and potentially also the**\nvariant.\n\n**Detection has the goal to distinguish between clean, potentially unwanted and malicious**\nfiles, registry entries, settings, events, or requests, so that the user's systems can be\nprotected from harm.\n\n\n-----\n\n\"Detection\" and \"Identification\" are often used synonymously, but there is an important\ndifference between the two.\nBig testing organizations like AV Test and AV Comparatives therefore test the detection\ncapabilities of antimalware products, not their correct identification of malware. For\nantimalware products there is not much incentive to program their scanners for identification.\nThey look like they identify and classify malware but they are doing a pretty bad job at this.\n\nA malware family is a group of malware samples that have a common code base.\n\nA malware variant is a subgroup of a malware family. Different malware variants have\nnotable derivations from the code base of the family. One malware variant contains all\nsamples that have the same derivation.\n\nAn example for a malware family is Petya, whereas GoldenPetya and GreenPetya are\nvariants of the Petya family. The most notable difference of these Petya variants is the color\nof their ransom note text. The terms malware family and malware variant should not be\nconfused with the Family and Variant component in detection names.\n\n**Detection namesare readable names that map to certain detection signatures or**\ntechnologies. Detection names are used by antimalware products and vendors.\n\nBecause the purpose of detection names is not identification, they are not viable to be used\nthat way. But as we can see in many malware prevalence reports, detection names are still\nassumed to represent malware variants, leading to confusing and wrong statements by\nmedia and news.\n\nYes, detection names can contain malware family names in their Family component.\nHowever, it is not necessarily the correct one, nor is it clear if that part of the detection name\n[is actually a family or an umbrella term or something else (see Detection naming conventions](https://www.gdatasoftware.com/blog/2019/08/35146-taming-the-mess-of-av-detection-names#c192748)\n\n\n-----\n\ntoday).\n\nYes, detection names contain a Variant component, but this component does not represent a\nmalware variant. It is rather used either as a counter that increments with every added\ndetection signature or it represents a hash value which might be a different one for every\nsample. The Variant component in detection names is crucial to the mapping for the\ndetection technologies and signatures and used to identify and maintain them. Thus, they\nare an internal information that is only useful for the antimalware vendor.\n\nNow that the terms used in this article are clear, we will focus on how and by whom malware\nfamily names are created in order to answer these questions: What is actually the issue with\nthis process? How can we make it better?\n\n## Creation of malware family names\n\nMalware family names are mainly created by malware analysts. The general procedure is as\nfollows.\n\n### 1.Cross-checking with known malware families\n\nA malware analyst gets a sample to analyse. A primary analysis may tell them if the sample\nis a known malware family, e.g., because the analyst has seen this family before and\nrecognizes strings in the binary, the code or the behaviour.\n\nIf the malware analyst doesn't recognize the family, they search for clues on what it could be.\nThis can be done via the following methods:\n\nThe analyst extracts strings from the binary. They research those strings that seem\nunique, e.g., a mutex, unique file path, strings that contain typos\nSometimes the malware developer's project name is part of the binary, e.g., via the\nPDB path. Many malware family names are based on the project name.\nSometimes the malware developer includes their own nickname or social media\nhandle, e.g., for Twitter, Telegram, Discord. Researching their accounts often leads to\npostings or videos about their malware which include the developer's malware name\nThe analyst checks the hash on various sample databases and comments by other\nanalysts, e.g., on Virustotal.\nThe analyst checks detection names by other vendors, e.g., on Virustotal, preferably on\nthe unpacked sample. If certain family names appear in many different scanners, the\nchance is higher that this might be the family.\nThe analyst looks up general behaviour and extracts interesting data via automated\nanalysis systems, e.g., Any.Run, Hybrid-Analysis, VMRay, ... These may also be used\nfor cross-checking.\nInternal as well as public analysis systems may provide similarity analysis to known\nfamilies. A good example is Intezer.\n\n\n-----\n\nAsking colleagues. A tweet may provide more than hours of research.\n\nIdeally the malware analyst now has assumptions what family it might be. They now crosscheck their assumption with public analysis reports. This includes searching for aliases of the\nsame family and checking them as well. Public analysis reports are crucial at this point.\n\nIf no malware family can be found or if the name is not suitable for the analyst's\nrequirements, they create a new family name.\n\n### 2. Inventing or deriving a new family name\n\nFamily name creation is a pet peeve of many malware analysts, especially those who\nanalyse lots of samples a day to create detection signatures. They often just need quickly a\nname to tie it on their detection signature. Time is crucial, especially if there is a current\nmalware outbreak on customer's systems. Remember: detection names are nothing more\nthan mappings to the detection signature. The family part of the detection name can feel\nparticularly frustrating if it is holding one back to commit the signature. How often did I end\nup in this situation:\n\n1. I find a name that sounds great. I type it into Google, and it turns out to be a city.\n2. I change my name by mixing up some of its letters. Google now tells me this new name\n\nis a company's name.\n3. I reverse the string. Google tells me it is a person's family name.\n4. At this point I use my fail-safe method to create a completely unique name: I roll my\n\nhead on the keyboard while making frustrated noises. I call this the \"I give up\" method.\nAllegedly some analysts let their cat sit or walk over the keyboard while others give it to\ntheir toddler to play with. This \"random\" generated word turns out to be an offensive\n**word in a few languages that I don't speak.**\n\nAll of the mentioned names, companies, persons and offensive words, are not suitable to be\nused as malware family names. Additionally trademarks, products and common words are\nnot permitted. No person or organization would like to see themselves associated to a\nmalware. Side note: Company or product names may show up in detection names if it is a\nPUP (=potentially unwanted software) detection. But that's not the same as a malware family\nname. In many antimalware companies it is also not permitted to use the name that the\nmalware author intended. The reason is that the malware author should not get any fame for\ntheir product.\n\nApart from this process, what strings are actually used to create or derive a family name?\n\nAs I mentioned above the analyst cross-checks unique strings as well as project names\nwith known family names. If no known family names come up, these strings are often used to\nderive the new family name. In some cases they are used verbatim, in others they are\n\n\n-----\n\nmodified to fit to the naming policies. Malware authors often use racist, sexist, homomisic,\nableist or plain offensive language that may bleed into their project names. It is obviously not\nsuitbale for a family name.\n\nApart from unique strings, analysts may also derive names from the sample's file path, its\nprogramming environment or language, its malware type and behaviour. E.g., PyCrypter is a\nmixture of Python and a file encrypting ransomware. The worm Conficker is a pun for\n\"configure\" and the German word \"Ficker\" which means \"fucker\" in English. In this case the\nrule to not use offensive words has been violated, but the name stuck.\n\nMalware analysts do not only use puns to derive names. They literally like to reverse (pun\n[intended). E.g., the first versions of Nemucod loader used download URLs that contained](https://cofense.com/a-peek-inside-an-affiliates-malspam-operation-kovter-and-miurefboaxxe-infections/)\n\"document.php\". Nemucod is \"documen\"(t) backwards. The \"t\" was likely removed to make it\npronouncable.\n\n## Case study: How I misnamed GooLoad aka GootLoader\n\nGootkit is a banker that was shipped with a very specific combination of PowerShell, JScript\nand .NET assembly to allow fileless persistence on the infected system. This loader, later\n[dubbed GootLoader and GooLoad, was described in previous Gootkit articles but not](https://blogs.blackberry.com/en/2020/04/threat-spotlight-gootkit-banking-trojan)\nspecifically named.\n\n\n-----\n\nAt some point the loader started shipping malware other than Gootkit, such as Gozi which is\nalso a banker. Unaware of the situation, one of our malware analysts correctly identified such\na sample as Gozi and wrote a signature that included patterns of GooLoad as well as Gozi.\nDue to the nature of the infection, fileless persistence via registry stuffing, our team created\nspecific cleaning procedures for samples detected by this particular signature—Gozi in\ncombination with GootLoader.\n\nNew infections appeared later that shipped a different malware via GootLoader. The Gozi\nsignature did not match anymore, but we identified many common strings in that signature\nfor the old and new infections. Subsequent signatures contained only GooLoad strings but\nwere also named Gozi.\n\nAt this point I realized that team members had added the very same registry cleaning\nalgorithm for certain Gootkit signatures as they did with Gozi. At that point I started to\nquestion the malware family identification. Most of our Gozi signatures contained GooLoad\nstrings at that point, yet these strings were described in Gootkit articles. A few tweets and\nlots of research later it dawned on me that this malware did not have a name yet.\n\nI renamed the related Gootkit and Gozi signatures to GooLoad. I chose this name because\n\"goo\" means sticky substance and GooLoad is somewhat close to Gootkit loader but still\ndifferent enough to not associate it as loader for Gootkit alone. While I was working on a blog\n[article to clear up the confusion, Sophos researchers settled on the name GootLoader at the](https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/)\nsame time.\n\nSo yes, I am at fault for spreading false information about Gozi (which I later corrected) and\nalso for creating yet another name for GootLoader aka GooLoad malware. The reason for\nnot reverting the name to GootLoader is simple: It would require too many changes in too\nmany signatures and cleaning algorithms and none of them improve the protection of our\nproduct. This is why coupling malware taxonomy with detection names is not a good idea.\n\n## Underlying causes of misnaming\n\nSome of the causes might have already popped up in your mind while reading the malware\nname creation section.\n\nMalware analysts who create malware names often don't have the time nor the incentive to\nbe accurate. Even if analysts want to be accurate, it is a tedious task that may still not result\nin the correct name. Analysts create new family names if they can't find any that fits.\n\nMistakes are often not noticed because no testing is done for identification. Even if naming\nmistakes are noticed they are often not corrected: Doing it consistently requires a lot of effort\nand doesn't improve protection.\n\n\n-----\n\nNames that have already been established may not be applicable for every party involved.\nThere may be policies that prevent the use of these names, and such policies are different in\nevery organization. Therefore, new names are created to abide by these policies. The names\nmay also need to fit PR purposes, e.g., Sodinokibi is hard to pronounce and to remember,\nbut its alias REvil is much better suited for blog articles and news.\n\nWe have no common agreement on malware naming, nor is there any review procedure or\ninstitution to oversee it. Wrong identification or use of names is usually not even noticed.\n\nNoteworthy outbreaks of malware infections require fast reaction times by malware analysts\nas well as the news media. This results in simultaneous creation of new malware names for\nthe same family or variant. It is the reason why the Petya variant EternalPetya has so many\nnames—its first outbreak was pandemic and all antimalware companies had been working\non it on the same day.\n\nMalware detection is already difficult, mathematically it is an undecidable problem (see Fred\n[Cohen, 1987, Computer Viruses, p. 28). Identification more so because it requires additional](https://profsandhu.com/cs5323_s18/cohen-1987.pdf)\nsteps. If I identify a malware family, the detection of its malicious components is a\nprerequisite.\n\n## Solutions to malware naming hell\n\nThe antivirus industry focuses on protection, not identification. Yet, their employees are the\nmain creators of malware names, most of the time indirectly via detection names that are\npicked up by publications and news. As a result we have at least as many malware naming\nconventions as there are antivirus companies, and no common understanding.\n\n### Step 1: Detach detection names from malware taxonomy\n\nIf detection names did not attempt or pretend to be a malware taxonomy, many\nmisunderstandings, misuses and wrong identifications can be prevented. So what we need is\na decoupling of detection names and malware taxonomy. An alternative way to create\n[detection names is described in the IceWater project.](https://github.com/SupportIntelligence/Icewater)\n\nIf any product seemingly identifies malware, it should be tested for identification\n**capabilities; not only for detection. It must be made clear for consumers of such products**\nwhether a product detects or identifies. Pretending to do one thing while actually doing\nanother is unfortunately how detection names are presented currently.\n\n### Step 2: Create a common taxonomy and quality process\n\nOnce there is a decoupling (see Step 1), the antimalware industry and sciences may be\nopen to agree on a common taxonomy, policies to deal with name conflicts, and a\n**process to ensure quality. That's because this agreement doesn't directly affect**\n\n\n-----\n\nantimalware company s detection names anymore which are necessary for their operational\nwork. Without that detachment, antimalware companies would not be able nor willing to unify\nmalware family naming or the naming procedure.\n\nWe might adopt scientific peer-review procedures for malware analysis papers and new\nmalware names just as it is common in academia to peer-review research papers.\n\n### Step 3: Build a vetted, public malware database\n\nWe have public sample and malware databases, but they are not suited for this purpose yet.\nE.g., there is [Malpedia by Fraunhofer FKIE. It is a malware database of currently 2023](https://malpedia.caad.fkie.fraunhofer.de/)\nfamilies with short descriptions, some aliases, links to blog articles and Yara rules.\n\nHowever, Malpedia does not comment on the linked articles which naturally contain\ncontradicting information. It merely acts as a reference collection. The Yara rules of Malpedia\ndo not suffice for proper identification of malware families as many of them suffer from false\npositive and false negative matches as well as conflation of a family with its packer, loader or\nother detached components. This is not necessarily the result of bad rule writing. Rather the\nmethodology of using signature-based detection is not best suited to identify families.\n\n[Intezer has a more adequate methodology for identification. It compares similarities of code](https://www.intezer.com/)\nand strings to reference files of a malware family. It does this on the sample itself as well as\nthe memory contents while running it. But Intezer is not meant as a database to look up\nfamilies, aliases, and their common defining behaviour as well as capabilities.\n\nWe need a public malware database that includes:\n\nmalware families, including their aliases, but with one official name\nrepresentative, non-packed samples for each family\na detailed description of what makes up the family, and potential border cases to other\nfamilies that might look similar\na code and string based comparison of the family's main body to other input samples\n(like Intezer); this must not include its loader, downloader or unpacking stub, unless the\nfamily itself is a loader or downloader\nvetting of new entries\n\n### Feasibility\n\nThe first step is probably the hardest. The same inflexibility that causes the inaccuracy of\nmalware naming also makes it difficult move away from a pretense malware taxonomy in\ndetection names. Especially because there is no immediate gain by doing this step. On the\ncontrary, loosing the pretense malware identification might seem like a loss at first. An easier\ntransition might be possible by just adapting new detection names and technologies or only\nchanging what is shown to the user of the antimalware product.\n\n\n-----\n\nYou might ask if such a database is possible with the new appearance of threats every day. I\nam confident that it is! The huge threat counts we see in malware prevalence reports are\nbased on sample counts, or infection attempts, but not families. Malpedia currently lists only\n2023 families, and during my daily work I usually find what I am looking for. There are\ncertainly a few thousand families more than those listed on Malpedia, but the magnitude is\neasy enough to handle. The number of families can be reduced if we concentrate on those\nthat are at least active for a few months.\n\nThe gains in the long run would be huge. If we actually made improvements in malware\nfamily naming, it would be easier to find information about malware, mistakes were less likely\nand work would less likely be done twice (e.g., because a family is already known but the\nanalyst did not find the information). That in turn improves detection signature writing,\nreponse times to malware incidents, adequate treatment of such incidents, threat prevention\nand malware research time and quality.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-07 - Malware family naming hell is our own fault.pdf"
    ],
    "report_names": [
        "2021-06-07 - Malware family naming hell is our own fault.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536037,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653704550,
    "ts_modification_date": 1653704550,
    "files": {
        "pdf": "https://archive.orkl.eu/ff925ed777dcfc4ba393e0d3a950500cf76f6266.pdf",
        "text": "https://archive.orkl.eu/ff925ed777dcfc4ba393e0d3a950500cf76f6266.txt",
        "img": "https://archive.orkl.eu/ff925ed777dcfc4ba393e0d3a950500cf76f6266.jpg"
    }
}