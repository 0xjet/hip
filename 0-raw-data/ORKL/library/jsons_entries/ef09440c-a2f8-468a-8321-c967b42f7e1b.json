{
    "id": "ef09440c-a2f8-468a-8321-c967b42f7e1b",
    "created_at": "2023-01-12T15:09:03.150512Z",
    "updated_at": "2025-03-27T02:06:15.230466Z",
    "deleted_at": null,
    "sha1_hash": "9a863689a3d92b2b2edda91a32d5c60cb260effa",
    "title": "2014-07-16 - Mini Analysis of the TinyBanker Tinba",
    "authors": "",
    "file_creation_date": "2022-05-28T03:55:37Z",
    "file_modification_date": "2022-05-28T03:55:37Z",
    "file_size": 906388,
    "plain_text": "# Stop Malvertising\n\n**[stopmalvertising.com/malware-reports/mini-analysis-of-the-tinybanker-tinba.html](http://stopmalvertising.com/malware-reports/mini-analysis-of-the-tinybanker-tinba.html)**\n\nMini Analysis of the TinyBanker Tinba\n\n[Written by Kimberly on Wednesday, 16 July 2014. Posted in Malware Reports Viewed](https://stopmalvertising.com/malware-reports/)\n7516 times\n\nToday we’ll have a look at Tinba (Tiny Banker), the smallest banker in the world. Without\nthe use of a packer or crypter Tinba is around 20 KB, default configuration and web injects\nincluded. A few days ago the source code of Tinba 1 was released on a closed\n[underground forum. Reference.](https://www.csis.dk/en/csis/news/4303)\nTinba uses MiTB (Man in The Browser) tricks and web injects to change the appearance\nof certain webpages. Objective: circumvent two factor Authentication and/or trick the victim\nin giving up additional sensitive data.\n\nTinba uses RC4 encryption to communicate with its C&C servers. The key and the servers\nare hardcoded into the binary. Before downloading updates from the C&C server, Tinba\nsends out an RC4 encrypted string.\n\nI accidentally found this sample of Tinba because the author used the same crypter as\n[ZeuS GameOver Reloaded. The sample was submitted to VirusTotal the same day as the](http://stopmalvertising.com/spam-scams/zeus-gameover-reloaded.html)\nnew ZeuS GameOver and seems to be the payload of a spam email targeting mainly\nusers from Poland and the Czech Republic. We can find back traces of the crypter in the\nmemory space of Tinba:\n```\n 0x987041 (17): OU___Enemy %d, \n 0x987053 (13): OU___Bomb %d\n\n```\nAlong with the following strings:\n```\n 0x14562a8 (11): LoadBitmapA\n 0x14562d0 (13): IntersectRect\n 0x1456342 (18): CreateCompatibleDC\n 0x1456358 (22): CreateCompatibleBitmap\n 0x145637c (14): ImageList_Draw\n 0x145638e (19): ImageList_AddMasked\n\n```\n\n-----\n\nThe executable is 88.0 KB (90,112 bytes) and contains an RCData resource with the ID\n56. The size (9479176 bytes) is fake; it’s bigger than the size of the executable. This will\ncause a warning in Olly and makes it harder to extract the resource.\n\n\n-----\n\nThe resource with the ID 56 contains a fake JPG header. JPEGsnoop, a free windows\napplication able to examine and decode the inner details of JPEG images, reports an\nunknown marker at the offset 0x000004B1 and notifies of existing data after EOF. Hiding\nan executable in a resource is a method to evade anti-virus detections.\n\nUpon execution TINBA.EXE [PID 2724] launches an instance of itself [PID 3004]. Note the\nsize of the executable: 20KB.\n\nAfter approximately 1 minute (I noticed the SLEEP command in the code but didn’t time it)\nTINBA.EXE will launch an instance of TASKMGR.EXE (Windows Task Manager), inject\ncode into the newly created process and exit.\n\nBefore terminating its process, TINBA.EXE contained the following Section:\n\n\n-----\n\n\\BaseNamedObjects\\redhot\n\nThe same Section is found back in the TASKMGR.EXE process.\n\nTASKMGR.EXE:\n\nReads the Volume Name and Serial Number\nCreates a directory named \"AdobeChk\" in the %APPDATA% folder\nRenames TINBA.exe to %APPDATA%\\AdobeChk\\chk.exe\nc:\\Documents and Settings\\[User Name]\\Application Data\\AdobeChk\\chk.exe\nDate: 7/14/2014 4:36 PM\nSize: 90,112 bytes\n\nCreates the following Registry entry so that CHK.EXE runs each time Windows\nstarts:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\"AdobeChk\"\nType: REG_SZ\nData: C:\\Documents and Settings\\[User Name]\\Application Data\\AdobeChk\\chk.exe\n\nSets tabs and frames to run within the same process in IE:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Internet Explorer\\Main\n\"TabProcGrowth\"\nType: REG_DWORD\nData: 01, 00, 00, 00\n\n\n-----\n\nTASKMGR.EXE will establish a little routine in case the file or the Registry keys are\ndeleted but the procedure looks a bit flawed to me. The injected process attempts to\ncreate a folder that already exists (resulting in a name collision) and checks for a file called\n\"empty\" in the folder where TINBA.EXE was located.\n\nTinba sends out an RC4 encrypted string to the C&C located at plsecdirect.ru and\nreceives a 403 Forbidden. The decrypted string is EHLO.\n\n\n-----\n\nHardcoded User Agent:\n\nMozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)\n\nRC4 key:\n\nwer8c7ygbw485ghw\n\nHardcoded C&C:\n\nplsecdirect.ru - 91.237.198.54\nframesoutchk.ru - 91.237.198.54\n\nTargeted Browsers:\n\niexplore.exe | firefox.exe | maxthon.exe | chrome.exe\n\nPath to configuration and web injects:\n\nC:\\Documents and Settings\\[User Name]\\Application Data\\AdobeChk\\cof.dat\nC:\\Documents and Settings\\[User Name]\\Application Data\\AdobeChk\\cot.dat\n\nMemory Strings:\n\n\n-----\n\n```\n0x3b170e (20): POST /re/ HTTP/1.1\n0x3b1739 (71): Accept: text/html, application/xhtml+xml, */*\nAccept-Language: en-US\n0x3b1791 (75): User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1;\nTrident/5.0)\n0x3b17ed (57): \nContent-Type: application/x-www-form-urlencoded\nHost: \n0x3b1842 (18): \nContent-Length: \n0x3b1875 (48): \nConnection: Close\nCache-Control: no-cache\n0x3b215d (13): \n[urlfilter]\n0x3b22c4 (13): \ndata_before\n0x3b22f5 (10): \ndata_end\n0x3b2329 (13): \ndata_inject\n0x3b235e (10): \ndata_end\n0x3b2392 (12): \ndata_after\n0x3b23c6 (10): \ndata_end\n0x3b25e3 (14): %SAVEDATA_*=*%\n0x3b26aa (11): %BOTDATA_*%\n0x3b28e8 (15): X-Frame-Options\n0x3b2aab (27): Accept-Encoding: identity\n0x3b2adc (50): If-Modified-Since: Thu, 01 Jan 1970 00:00:00 GMT\n0x3b2e78 (18): Content-Length: \n0x3b2ed8 (20): Transfer-Encoding:\n0x3b3038 (19): X-Frame-Options: \n0x3b306c (29): X-Content-Security-Policy:\n\n```\n**VirusTotal Results**\n\ntinba.exe\n\n\n-----\n\n**Additional information**\n\n**MD5: faba9ee82dfa2629098c8ef884395d5a**\n\n**SHA1: c0e40cb29a1e6b5a4174727f49ef871aafb684d5**\n\n**SHA256:**\ncbb16b01a8dcf3747a597ceb4176939f83083a6293b60aaca00e040970d63379\n\n**File size: 88.0 KB ( 90112 bytes )**\n\n**Detection ratio: 34 / 54**\n\n**Analysis date: 2014-07-12 16:31:02**\n\n**Antivirus** **Result** **Update**\n\nAd-Aware Trojan.GenericKD.1750488 20140712\n\nAegisLab 20140712\n\nAgnitum 20140712\n\nAhnLab-V3 Trojan/Win32.Zbot 20140712\n\nAntiVir TR/Crypt.Xpack.71693 20140712\n\nAntiy-AVL Trojan/Win32.Inject 20140712\n\nAvast Win32:Malware-gen 20140712\n\nAVG Generic_r.DYS 20140712\n\nBaidu-International Trojan.Win32.Tinba.BAX 20140712\n\nBitDefender Trojan.GenericKD.1750488 20140712\n\nBkav 20140711\n\nByteHero 20140712\n\nCAT-QuickHeal 20140712\n\nClamAV 20140712\n\nCMC 20140711\n\nCommtouch W32/Zbot.IWEE-4148 20140712\n\nComodo 20140712\n\nDrWeb Trojan.Encoder.682 20140712\n\n\n-----\n\nEmsisoft Trojan.GenericKD.1750488 (B) 20140712\n\nESET-NOD32 Win32/Tinba.AX 20140712\n\nF-Prot W32/Zbot.BZY 20140712\n\nF-Secure Trojan.GenericKD.1750488 20140712\n\nFortinet W32/Tinba.AX!tr 20140712\n\nGData Trojan.GenericKD.1750488 20140712\n\nIkarus Trojan-Spy.Zbot 20140712\n\nJiangmin 20140712\n\nK7AntiVirus 20140711\n\nK7GW 20140711\n\nKaspersky Trojan.Win32.Tinba.bl 20140712\n\nKingsoft 20140712\n\nMalwarebytes Trojan.Zbot 20140712\n\nMcAfee RDN/Generic.dx!ddw 20140712\n\nMcAfee-GW-Edition RDN/Generic.dx!ddw 20140711\n\nMicrosoft Trojan:Win32/Tinba.A 20140712\n\nMicroWorld-eScan Trojan.GenericKD.1750488 20140712\n\nNANO-Antivirus Trojan.Win32.Encoder.dcdrmp 20140712\n\nNorman Troj_Generic.UXHBG 20140712\n\nnProtect 20140711\n\nPanda Trj/CI.A 20140712\n\nQihoo-360 Win32/Trojan.Multi.daf 20140712\n\nRising 20140712\n\nSophos Troj/HkMain-AQ 20140712\n\nSUPERAntiSpyware 20140712\n\nSymantec Trojan.Zbot 20140712\n\n\n-----\n\nTencent Win32.Trojan.Tinba.Egek 20140712\n\nTheHacker 20140711\n\nTotalDefense 20140711\n\nTrendMicro TROJ_TINBA.TFB 20140712\n\nTrendMicro-HouseCall TROJ_TINBA.TFB 20140712\n\nVBA32 20140712\n\nVIPRE Trojan.Win32.Generic!BT 20140712\n\nViRobot Trojan.Win32.Agent.324096 20140712\n\nZillya 20140710\n\nZoner 20140711\n\nTags:\n\n[Tinba](https://stopmalvertising.com/tag/tinba.html)\n[Tinybanker](https://stopmalvertising.com/tag/tinybanker.html)\n\n[If our research has helped you, please consider making a donation through PayPal.](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=4SV5GCQMUP2RL)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-07-16 - Mini Analysis of the TinyBanker Tinba.pdf"
    ],
    "report_names": [
        "2014-07-16 - Mini Analysis of the TinyBanker Tinba.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536143,
    "ts_updated_at": 1743041175,
    "ts_creation_date": 1653710137,
    "ts_modification_date": 1653710137,
    "files": {
        "pdf": "https://archive.orkl.eu/9a863689a3d92b2b2edda91a32d5c60cb260effa.pdf",
        "text": "https://archive.orkl.eu/9a863689a3d92b2b2edda91a32d5c60cb260effa.txt",
        "img": "https://archive.orkl.eu/9a863689a3d92b2b2edda91a32d5c60cb260effa.jpg"
    }
}