{
    "id": "b3f5d4e7-2b32-4325-9210-07ec6c7b8cfe",
    "created_at": "2023-01-12T15:07:20.793076Z",
    "updated_at": "2025-03-27T02:14:02.739702Z",
    "deleted_at": null,
    "sha1_hash": "1a0f0365a1b997260e1186d63683721f2c8442c6",
    "title": "2018-05-22 - Nmap Script to scan for Winnti infections",
    "authors": "",
    "file_creation_date": "2022-05-27T22:25:46Z",
    "file_modification_date": "2022-05-27T22:25:46Z",
    "file_size": 124401,
    "plain_text": "# Nmap Script to scan for Winnti infections\n\n**github.com/TKCERT/winnti-nmap-script**\n\nTKCERT\n\n### This Nmap script can be used to scan hosts for Winnti infections. It uses parts of Winnti's protocol as seen in the wild in 2016/2017 to check for infection and gather additional information.\n\n## Winnti\n\n### Winnti is a malware that is used by some APT groups.\n\n It has been used since at least 2013 and has evolved over time. You can find some information here\n\n https://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/winnti-more-than- just-a-game-130410.pdf https://www.novetta.com/wp-content/uploads/2015/04/novetta_winntianalysis.pdf https://hitcon.org/2016/pacific/0composition/pdf/1201/1201%20R2%201610%20winnti %20polymorphism.pdf\n\n## SecOps Warning\n\n### WINNTI ONLY SUPPORTS ONE CONNECTION AT A TIME. IF YOU SCAN A HOST FOR WINNTI YOU WILL RESET THE CURRENT CONNECTION IF THERE IS ONE.\n\n\n-----\n\n## Requirements\n\n### This script needs liblua 5.3 to work. You may want to download the latest Nmap version to get support out of the box (confirmed working with Nmap 7.25BETA2 and 7.60).\n\n## Installation\n```\nuser@mint ~/src $ wget https://raw.githubusercontent.com/TKCERT/winnti-nmapscript/master/winnti-detect.nse\nuser@mint ~/src $ wget https://nmap.org/dist/nmap-7.60.tar.bz2\nuser@mint ~/src $ tar xvf nmap-7.60.tar.bz2\nuser@mint ~/src $ cd nmap-7.60\nuser@mint ~/src/nmap-7.60 $ apt install build-essential\nuser@mint ~/src/nmap-7.60 $ ./configure && make\nuser@mint ~/src/nmap-7.60 $ ./nmap -sT 127.0.0.1 -p 80,631 --script ../winntidetect.nse\nStarting Nmap 7.60 ( https://nmap.org ) at 2018-03-10 12:25 CET\nNmap scan report for localhost (127.0.0.1)\nHost is up (0.0018s latency).\nPORT  STATE SERVICE\n80/tcp closed http\n631/tcp open  ipp\nHost script results:\n| winnti-detect:\n|  PORTS\n|_   631 clean\nNmap done: 1 IP address (1 host up) scanned in 0.33 seconds\n\n Show script help\n\n```\n\n-----\n\n```\n $ nmap script help winnti detect.nse\nStarting Nmap 7.25BETA2 ( https://nmap.org ) at 2016-09-26 17:00 CEST\nwinnti-detect\nCategories: malware safe\nhttps://nmap.org/nsedoc/scripts/winnti-detect.html\n The winnti-detect script checks if the host is backdoored by winnti rootkit. It\n sends a winnti command to the first three open TCP ports and checks the\n response. When the connection to one of these ports fails, the next port is\n chosen until three successful tries are completed. When a winnti infection is\n found the script gathers basic host information by sending a query to the\n backdoor and printing the response. Version 1.0, 2016-09-26\n *** SECOPS-WARNING ***\n Winnti only supports one connection at a time. If you scan a host for winnti\n you will reset the current connection if there is one.\n *** IMPORTANT ***\n Winnti installations may use different encryption keys. The default value\n included in this script is 0xABC18CBA (taken from a real sample).\n You can set a custom key with --script-args key=0x........\n The key must be given in big-endian.\n\n## Run Detection\n\n```\n\n-----\n\n```\n $ nmap script winnti detect.nse 10.10.0.2\nStarting Nmap 7.25BETA2 ( https://nmap.org ) at 2016-09-26 16:37 CEST\nNmap scan report for 10.10.0.2\nHost is up (0.013s latency).\nNot shown: 991 closed ports\nPORT   STATE SERVICE\n135/tcp  open msrpc\n139/tcp  open netbios-ssn\n445/tcp  open microsoft-ds\n49152/tcp open unknown\n49153/tcp open unknown\n49154/tcp open unknown\n49155/tcp open unknown\n49156/tcp open unknown\n49157/tcp open unknown\nHost script results:\n| winnti-detect:\n|  PORTS\n|    135 found WINNTI\n|    139 skipped\n|    445 skipped\n|   49152 skipped\n|   49153 skipped\n|   49154 skipped\n|   49155 skipped\n|   49156 skipped\n|   49157 skipped\n|  HOSTINFO\n|   Hostname: SRV1\n|   Winnti-ID: NKASJ-OQMDA-NDKQP-AJNCK-MQLAI_\n|   Hostname2 XXXXXXXXXX-t\n|_  Domain   XXXXXX\nNmap done: 1 IP address (1 host up) scanned in 6.11 seconds\n\n## Winnti static key\n\n### Winnti installations may use different encryption keys. The default value included in this script is 0xABC18CBA (taken from a real sample). You can set a custom key with --script- args key=0x........ The key must be given in big-endian.\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-22 - Nmap Script to scan for Winnti infections.pdf"
    ],
    "report_names": [
        "2018-05-22 - Nmap Script to scan for Winnti infections.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536040,
    "ts_updated_at": 1743041642,
    "ts_creation_date": 1653690346,
    "ts_modification_date": 1653690346,
    "files": {
        "pdf": "https://archive.orkl.eu/1a0f0365a1b997260e1186d63683721f2c8442c6.pdf",
        "text": "https://archive.orkl.eu/1a0f0365a1b997260e1186d63683721f2c8442c6.txt",
        "img": "https://archive.orkl.eu/1a0f0365a1b997260e1186d63683721f2c8442c6.jpg"
    }
}