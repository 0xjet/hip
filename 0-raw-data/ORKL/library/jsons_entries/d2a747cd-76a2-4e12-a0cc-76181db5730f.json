{
    "id": "d2a747cd-76a2-4e12-a0cc-76181db5730f",
    "created_at": "2023-06-05T02:07:22.647142Z",
    "updated_at": "2025-03-27T02:05:47.120278Z",
    "deleted_at": null,
    "sha1_hash": "d07e92c8b65d6fdd244c88db0c84ff84257643db",
    "title": "2023-03-14 - South Korean Android Banking Menace - Fakecalls",
    "authors": "",
    "file_creation_date": "2023-06-04T12:29:14Z",
    "file_modification_date": "2023-06-04T12:29:14Z",
    "file_size": 2556118,
    "plain_text": "# South Korean Android Banking Menace – FakeCalls\n\n**[research.checkpoint.com/2023/south-korean-android-banking-menace-fakecalls/](https://research.checkpoint.com/2023/south-korean-android-banking-menace-fakecalls/)**\n\nMarch 14, 2023\n\n_Research by: Bohdan Melnykov, Raman Ladutska_\n\nWhen malware actors want to enter the business, they can choose markets where their profit\nis almost guaranteed to be worth the effort – according to past results. The malware does not\nneed to be high profile, just careful selection of the audience and the right market can be\nenough.\n\nThis “stay-low-aim-high” approach is what the Check Point Research team saw in our\nrecent Android malware research. We encountered an Android Trojan named FakeCalls, a\nmalware that can masquerade as one of more than 20 financial applications and imitate\nphone conversations with bank or financial service employees – this attack is called voice\n**phishing. FakeCalls malware targeted the South** **Korean market and possesses the**\nfunctionality of a Swiss army knife, of being able not only to conduct its primary aim but also\nto extract private data from the victim’s device.\n\nVoice phishing attacks have a long history in the South Korean market. According to\nthe [report published on the South Korean government website, financial losses due to voice](https://www.data.go.kr/data/15063815/fileData.do)\nphishing constituted approximately 600 million USD in 2020, with the number\nof [victims reaching as many as 170,000 people in the period from 2016 to 2020.](https://it.chosun.com/site/data/html_dir/2020/09/28/2020092802480.html)\n\n\n-----\n\nWe discovered more than 2500 samples of the FakeCalls malware that used a variety of\ncombinations of mimicked financial organizations and implemented anti-analysis (also\ncalled evasions) techniques. The malware developers paid special attention to the\nprotection of their malware, using several unique evasions that we had not previously seen in\nthe wild.\n\nIn our report, we describe all of the encountered anti-analysis techniques and show how to\nmitigate them, dive into the key details of the malware functionality and explain how to stay\nprotected from this and similar threats.\n\n## Voice phishing\n\nBefore we get to the technical details, let’s discuss how voice phishing works in the example\nof FakeCalls malware.\n\nThe idea behind voice phishing is to trick the victim into thinking that there is a real bank\nemployee on the other side of the call. As the victim thinks that the application in use is an\ninternet-banking application (or payment system application) of a real financial institution,\nthere is no reason to be suspicious of an offer to apply for a loan with a lower interest rate –\nwhich is fake, of course. At this step, the malware actors can lay the necessary groundwork\nto understand how to approach the victim in the best way possible.\n\nAt the point where conversation actually happens, the phone number belonging to the\nmalware operators, unknown to the victim, is replaced by a real bank number. Therefore, the\nvictim is under the impression that the conversation is made with a real bank and its real\nemployee. Once the trust is established, the victim is tricked into “confirming” the credit card\ndetails in the hope of qualifying for the (fake) loan.\n\nThis is the principal scheme of the attack:\n\n\n-----\n\n_Image 1 – The key steps of a voice phishing attack._\n\nTargeted financial institutions are selected from amongst the largest and most prominent\nones in the banking sector: strong repay capacity ratings as evaluated by the South Korean\ngovernment and major world agencies, with billions of South Korean Won (KWR) revenue\n(equal to millions of the United States dollar (USD). Mimicking applications from such\ncompanies increases the chances of attracting suitable victims.\n\nWhen victims install the FakeCalls malware, they have no reason to suspect that some\nhidden catches are present in the “trustworthy” internet-banking application from a solid\norganization.\n\nAt step 2 of voice phishing attack, instead of a phone conversation with a malware operator,\na pre-recorded audio-track can be played imitating instructions from the bank. Several\ndifferent tracks are embedded into different malware samples corresponding to different\nfinancial organizations.\n\nOne way or another, malware operators get the private financial data of the victim which\nmeans that the aim of attack is achieved successfully.\n\n**Technical details**\n\nIn this section we describe the anti-analysis techniques as well as the process of dropping\nthe final payload and the details of FakeCalls’ network communication.\n\n## Anti-analysis techniques\n\n\n-----\n\nThere are three unique anti-analysis techniques encountered in different malware samples\nthat we did not observe previously in the wild. We took the following malware sample and\nanalyzed all three evasions we encountered inside:\n\n**_f8823780d2822307e995528bd7a34a1735e66bd2fe22404e02053cb92b0a56cb_**\n\nIf you try loading such a sample into analysis tools, they fail, as shown on this JEB Pro\nexample:\n\n_Image 2 – FakeCalls failed to load in JEB Pro._\n\nLet’s dissect and mitigate each of the anti-analysis techniques one by one, to finally be able\nto load and analyze the malicious payload.\n\n### Multi-Disk\n\nThe first evasion is called “Multi-Disk.” We clearly understand that APK cannot be split into\nmulti-disk archives, so we check this information in the APK by analyzing the ZIP header\ndata.\n\nThe necessary entry is the central directory file header. The end of this\n[record EOCD contains information about disk count.](https://docs.fileformat.com/compression/zip/#end-of-central-directory-record)\n\n**Offset** **Bytes** **Description**\n\n0 4 End of central directory signature = 0x06054b50\n\n4 2 Number of this disk (or 0xffff for ZIP64)\n\n6 2 Disk where central directory starts (or 0xffff for ZIP64)\n\n8 2 Number of central directory records on this disk (or 0xffff for ZIP64)\n\n\n-----\n\n**Offset** **Bytes** **Description**\n\n10 2 Total number of central directory records (or 0xffff for ZIP64)\n\n12 4 Size of central directory (bytes) (or 0xffffffff for ZIP64)\n\n16 4 Offset of start of central directory, relative to start of archive (or 0xffffffff\nfor ZIP64)\n\n20 2 Comment length (n)\n\n22 _n_ Comment\n\nEOCD marks the end of ZIP so the needed byte sequence can be found at the end of the\nfile:\n\n_Image 3 – Selected sequence at the end of the file._\n\nThe processed struct looks like this:\n\n_Image 4 – Values of the structure fields._\n\nBased on the very large values in the disk number fields, we understand that malware\ndevelopers edited these fields and entries. This means that the disk numbers should be set\nto 0, and the disk entries to the value equal to the directory entries: 1075.\n\n### AndroidManifest\n\n\n-----\n\nThe second evasion goes by the name AndroidManifest. The AndroidManifest file must\nstart with specific magic numbers (0x00080003 or 0x00080001) but our file starts from\n0x00080000.\n\n_Image 5 – Magic number at the beginning of the AndroidManifest file._\n\nBesides the magic number, the file contains other things that break the decoding process.\n\n_Image 6 – Values of the fields in the STRINGCHUNK structure._\n\nThe value of the scStylePoolOffset field points from the actual AndroidManifest file. Based\non the scStyleCount field, we see that file shouldn’t contain “styles”, and the value of this\nfield should be 0x00000000. The next thing we look at is scStringCount. The value here\nlooks normal, except for the moment when string analysis occurs. The image below informs\nus that the offset of the last string is pointing out of the file.\n\n\n-----\n\n_Image 7 –Wrong last string offset in the array._\n\nWe see that the string “theme” is wrongly interpreted as an offset value in the last element of\nthe array, number 87. This means that the value of the scStringCount should be less by 1,\ni.e., set to 86.\n\n### Files\n\nThe third and the final evasion is called simply “Files.” This technique is related to the files\ninside the APK.\n\n\n-----\n\n_Image 8 – Files inside the APK._\n\nDevelopers added a large number of files inside nested directories to the asset folder. As a\nresult, the length of the file name and path is over 300 characters.\n\n_Image 9 – Length of the file name (selected in the screenshot)._\n\nThese files break the logic of tools that cannot remap file locations and may fail during APK\ndecompilation. However, after all the previous fixes, such files can be manually removed\nfrom the APK as they are not required anymore.\n\nIn the end, the resulting APK file can be processed inside typical analysis tools.\n\n\n-----\n\n_Image 10 – FakeCalls successfully loaded in JEB Pro._\n\n## Inside the malware\n\nFakeCalls payload is not launched at once. Instead, the dropper is used as an intermediate\nstep.\n\n### Dropping process\n\nThe malware registers BroadcastReciever for the application installation events. This\nreceiver launches the dropped APK later in the process.\n\n\n-----\n\n_Image 11 – Function with the BroadcastReciever register functionality._\n\nThen malware shows a button to click to start the payload installation.\n\n\n-----\n\n_Image 12 – Button saying “Click Install Setup” in Korean._\n\nThe APK is located inside the asset folder and is copied during the process of loading the\nview components.\n\n\n-----\n\n_Image 13 – Code responsible for copying the APK._\n\nWhen the payload is successfully dropped, the malware launches the application with the\nconfiguration that it gets during the runtime.\n\n\n-----\n\n_Image 14 – Setting up the parameters when launching the application._\n\n### Live stream capture\n\nFakeCalls malware also has a possibility to capture live audio and video streams from the\ndevice’s camera to C&C servers with the help of open source library:\n\n[https://github.com/pedroSG94/rtmp-rtsp-stream-client-java](https://github.com/pedroSG94/rtmp-rtsp-stream-client-java)\n\nThe command processing method has a command called “stream”:\n\n\n-----\n\n_Image 15 – Option in the code enabling capture of live streams._\n\nThe corresponding method starts an audio or video service, or stops them, depending on the\n“state” variable value received from the C&C server.\n\n\n-----\n\n_Image 16 – Code to capture live streams._\n\nUpon the creation of video service, the RtspCamera2 object is initialized by setting the\nauthorization details and audio/video configuration (bitrate, fps, noise cancellation, etc.).\n\n\n-----\n\n_Image 17 – Initialization of RtspCamera2 object._\n\nThen the malware selects the front camera and starts streaming to C&C server which will be\nstopped after 5 minutes.\n\n_Image 18 – Code lunching live streaming to C&C server._\n\nFakeCalls may receive a command from C&C server to switch the camera during the live\nstreaming.\n\n### Network communication\n\nThe malware developers implemented several ways to keep their real Command-and**Control (C&C) servers hidden: reading the data via dead drop resolvers in Google Drive or**\nusing an arbitrary Web server. Dead Drop Resolver is a technique when malicious content is\nstored on legitimate web services. Inside malicious domains and IP addresses are hidden to\ndisguise the communication with real C&C servers. We have identified more than 100 unique\nIP addresses by processing the data from dead drop resolvers.\n\n**Google Drive**\n\n\n-----\n\nThe first variant is reading the configuration via Google Drive: the malware contains an\nencrypted string with a link to Google Drive where the file is stored.\n\n_Image 19 – Link to Google Drive inside the FakeCalls malware._\n\nThe name of the file is encrypted with AES.\n\n_Image 20 – The code to get the encrypted file name from Google Drive._\n\n\n-----\n\nAfter reading the file name, FakeCalls decrypts it with a hardcoded AES key and gets the\nreal C&C configuration:\n\nSERVER1_156.245.21.38-SERVER2_156.245.12.211-SERVER3_154.38.113.162SERVER4_154.197.48.72-SERVER5_154.197.48.125-SERVER6_154.197.48.195SERVER7_206.119.82.78-SERVER8_154.23.182.63-SERVER9_154.197.48.93SERVER10_154.197.48.212-SERVERLK_127.0.0.1\n\n**Fetch from alternative**\n\nThe other variant to communicate with C&C servers is when the malware has hardcoded an\nencrypted link to a specific resolver that contains a document with an encrypted server\nconfiguration.\n\nWe used the following sample for the analysis of this network communication method:\n\n**_4a422047bc0a2ca692b33a80740ab64a5bbc325c348d3d4eea0f304d3c256e03_**\n\n_Image 21 – The code to perform a request to the arbitrary C&C resolution server._\n\n$ curl https://www.daebak222.com/huhu/admin.txt\n\n{\n\n“a01”: “eWVlYWIrPj5mZmY_dXB0c3B6IyMjP3J-fA==”,\n\n“b05”: “Y2ViYWIrPj4gICI_IyAjPykpPyAlKSspIiMjPn14Z3Q=”,\n\n“a07”: “eWVlYWIrPj4gKSM_ICc_JSM_ICkrJCEkJD55ZHlkPnB1fHh_P2VpZQ==”\n\n}\n\nThe first element is a new server address, the second one is the address of a stream server\nused for live streams capture, and the last one is a link to a new dead drop resolver.\n\nThe malware decrypts all the data pieces and stores them for future use:\n\n\n-----\n\n_Image 22 – The code for decrypting the information received from the server._\n\n## Protections\n\nCheck Point’s [Harmony Mobile Prevents malware from infiltrating mobile devices by](https://www.checkpoint.com/harmony/mobile-security/mobile/)\ndetecting and blocking the download of malicious apps in real-time. Harmony Mobile’s\nunique network security infrastructure – On-device Network Protection – allows you to stay\nahead of emerging threats by extending Check Point’s industry-leading network\nsecurity [technologies to mobile devices.](https://www.checkpoint.com/quantum/maestro-hyperscale-network-security/)\n\n## Threat Emulation Protections\n\nBanking.Andorid.FakeCalls.TC.*\nFakeCalls.TC.*\n\n## Conclusion\n\nIn the FakeCalls malware case, the developers decided not to leave any aspect of their\noperations to chance. They selected a profitable voice phishing market in South Korea\nwhere past results proved to bring tremendous value for cybercrime operators, harvesting\napproximately 600 million USD from unsuspecting victims in 2020. The coverage of 170,000\n**victims in the period of 5 years from 2016 to 2020 only added fuel to the mix.**\n\nBut the story did not stop there. The malware developers took special care with the technical\naspects of their creation as well implementing several unique and effective anti**analysis techniques. In addition, they devised mechanisms for disguised resolution of**\nthe Command-and-Control servers behind the operations.\n\nThis case shows the utmost importance of researching malware that is active in just a single\ncountry out of almost 200 in the world. The tricks and approaches used in this particular\nmalware can be re-used in other applications targeting other markets around the globe.\nThere is no physical distance in a digital sphere, the information spreads rapidly and we\nmust react quickly in an ever-changing malware landscape.\n\n\n-----\n\nThe Check Point Research team stays vigilant and ready to adapt to the upcoming\nchallenges.\n\n## IOCs\n\n Hashes\n\nThe list of hashes below is not excessive by any means:\n\n0e26be5dbdc3656b09cc6d7d231b2285a7e52a4dc42c63021b57ee40b9694f34\n\n2b003f6638b56a56bc4f59058fc5b8e0ca6f34b79b83145fe9d80a5653ee2c85\n\n2fc09a2a0426e1fca7d9675c2f1734e36b3a13c260044ee70a7893419ab1bbe2\n\n3038c7a9c170e974421c5389ecb24f1e27ff9ba178e6f7f4929e5c54cac0c658\n\n39c7f217e55809b762b998198f6ae1e30ed87f0838f8e01e3fd838a77831bd3d\n\n497b9561e84e5bab365fd5283d45f6c76555e89c0b0dc57a91b338bf30ab1a54\n\n49c460158f23d12200488612242d2b8f50fdad38d5edb006e8c3a90b8005172c\n\n4a422047bc0a2ca692b33a80740ab64a5bbc325c348d3d4eea0f304d3c256e03\n\n522b4b565f34309713497d5fa2bfb6aa403cf7547c1ba2c114fc59fa8252b472\n\n65e875b1eed232e462cb654b110a895e2c87d420c9ef21a53683e27bcbcfbcc6\n\n76b94289ad36015d91e26ef1298fc04ca6f7ad7be1fe2d07ecf8a12be20996f3\n\n7d55250d76fcc3006a7cb727ba7521e0f17f8fd9311cf799442b1a737702a028\n\n834e678c8bb755d6bd21a886a39fea19613fd80a3894e4d6ddff3652170a0464\n\n97d20d26826a83de014b6711b87f18a98464e07b6ebc3a0480e4007d2f47e603\n\nb7ee5e7a4b9937e5fd9eebed01eabc36b22c8c6931e63f934bbdb961346169b3\n\ncbcffbf761b644f20486f7164a3b97a7c083dfcd774ed0ebbbcd6109fd6c47e1\n\ncc4dc5afeb91ef2ad364cda511777b888a4ba9a90ae49e9181494b2ff32d50ed\n\ndb9d55a7b05253fd7367c5fa25d07d6962c1a9b58a136f76c7ef236ad2aec94b\n\nde743563f41553f47bb7073ac28ed4d79e1a4031b3da732497805aa8a297943f\n\n\n-----\n\nf8823780d2822307e995528bd7a34a1735e66bd2fe22404e02053cb92b0a56cb\n\nSample with all the evasion techniques described (also included Google Drive dead drop\nresolvers):\n\n**_f8823780d2822307e995528bd7a34a1735e66bd2fe22404e02053cb92b0a56cb_**\n\nSample with the arbitrary CnC resolution method:\n\n**_4a422047bc0a2ca692b33a80740ab64a5bbc325c348d3d4eea0f304d3c256e03_**\n\nSample with video stream functionality:\n\n**_e8396aa5cccd30478e8fd0cf959ee996b6b727531bdece1ed63482b053c24004_**\n\n## URLs\n\nThe full list of dead drop resolvers:\n\nhttps://drive.google.com/file/d/1L7CMBiv5NLIrCxmUpkXRZcyFqbgmcKy5/view?usp=sharing\n\nhttps://drive.google.com/file/d/1HZg40qw7DGgl2HT6ZuGkKLkf5a0DnaBT/view?\nusp=share_link\n\nhttps://www.daebak222.com/huhu/admin.txt\n\nhttps://182.16.42.18:5055/huhu/admin.txt\n\nhttp://182.16.42.18:10102/Teamviewer/admin.txt\n\nhttp://182.16.42.18:10102/HanaBank/admin/admin.txt\n\nhttp://182.16.42.18:10102/HanaBank/admin.txt\n\nhttp://192.168.99.186:5000/admin.txt\n\nhttp://192.168.99.33:5055/admin.txt\n\nhttp://192.168.99.191:5055/admin.txt\n\n## Sources\n\n1. National Police Agency. Status of voice phishing\n\n// [https://www.data.go.kr/data/15063815/fileData.do](https://www.data.go.kr/data/15063815/fileData.do)\n2. Voice phishing damage of 1.7 trillion won over the past 5 years… 170,000 victims\n\n// [https://it.chosun.com/site/data/html_dir/2020/09/28/2020092802480.html](https://it.chosun.com/site/data/html_dir/2020/09/28/2020092802480.html)\n3. End of Central Directory Record // https://docs.fileformat.com/compression/zip/#end-of\ncentral-directory-record\n\n\n-----\n\n4. rtmp-rtsp-stream-client-java library // https://github.com/pedroSG94/rtmp-rtsp-stream\nclient-java\n\nGO UP\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-14 - South Korean Android Banking Menace - Fakecalls.pdf"
    ],
    "report_names": [
        "2023-03-14 - South Korean Android Banking Menace - Fakecalls.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1685930842,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1685881754,
    "ts_modification_date": 1685881754,
    "files": {
        "pdf": "https://archive.orkl.eu/d07e92c8b65d6fdd244c88db0c84ff84257643db.pdf",
        "text": "https://archive.orkl.eu/d07e92c8b65d6fdd244c88db0c84ff84257643db.txt",
        "img": "https://archive.orkl.eu/d07e92c8b65d6fdd244c88db0c84ff84257643db.jpg"
    }
}