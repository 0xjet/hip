{
    "id": "c2b6be4a-9461-434f-9059-b9403a3b4379",
    "created_at": "2023-01-12T15:06:37.963356Z",
    "updated_at": "2025-03-27T02:09:07.943104Z",
    "deleted_at": null,
    "sha1_hash": "060e3314734e8774569db473b0b7bcde28a110e4",
    "title": "2022-01-10 - Abcbot - An Evolution of Xanthe",
    "authors": "",
    "file_creation_date": "2022-05-28T16:16:17Z",
    "file_modification_date": "2022-05-28T16:16:17Z",
    "file_size": 3086279,
    "plain_text": "# Abcbot - An Evolution of Xanthe\n\n**cadosecurity.com/abcbot-an-evolution-of-xanthe/**\n\nBlog\n\nJanuary 10, 2022\n\n**Overview**\n\n\nJanuary 10, 2022\n\n\n[Abcbot, the emerging botnet that we recently analyzed and reported on, has a longer history](https://www.cadosecurity.com/the-continued-evolution-of-abcbot/)\nthan we first thought. Our continued analysis on this malware family reveals a clear link with\nthe Xanthe-based cryptojacking campaign discovered by Cisco’s Talos security research\nteam in late 2020. Researchers at Talos discovered malware resembling a cryptocurrency\nmining bot when they were alerted to an intrusion on one of their Docker honeypots.\n\n[The malware was named Xanthe and its main purpose is to hijack the resources of a](https://blog.talosintelligence.com/2020/12/xanthe-docker-aware-miner.html)\ncompromised host to mine cryptocurrency. We discovered a link between the two campaigns\nwhen analyzing the infrastructure behind Abcbot. Once we began comparing analysis of\nmalware samples from both campaigns, similarities within the code and feature-sets of both\nmalware families became apparent too.\n\nBased on this analysis, we believe that the same threat actor is responsible for both Xanthe\nand Abcbot and is shifting its objective from mining cryptocurrency on compromised hosts to\nactivities more traditionally associated with botnets, such as DDoS attacks.\n\n**Understanding the Infrastructure Behind Abcbot & Xanthe**\n\n\n-----\n\nGraph showing Abcbot infrastructure on the left and Xanthe infrastructure on the right (credit:\nAl Carchrie). The links are discussed below.\nTo begin mapping the Abcbot campaign, we collated all known Indicators of Compromise\n[(IoCs), including IP addresses, URLs and hashes. From this, we built a VirusTotal Graph](https://www.virustotal.com/graph/g03c53d6d0d8f4d00b8216599eb13f3211c024db29ac14fa7af8aafaa902ff581)\nwhich displayed this data in an easily-browsable format. After doing so, it became apparent\nthat there were four main hosts comprising what we thought was the infrastructure behind\nAbcbot. Instead, we were looking at the infrastructure responsible for delivering two distinct\nmalware campaigns – Abcbot and Xanthe.\n\n**Infrastructure Overlaps**\n\nThere are a few infrastructure overlaps. For example, the following rule allowing ingress\ntraffic from 64[.]225[.]46[.]44 in the [Xanthe sample also appears in the Abcbot sample:](https://www.virustotal.com/gui/file/6a5a0bcb60944597d61d5311a4590f1850c2ba7fc44bbcde4a81b2dd1effe57c)\n\n_iptables ingress traffic rule in Xanthe sample_\n\n\n-----\n\n_iptables ingress traffic rule in Abcbot sample_\n\nWhilst it’s common to see cryptojacking malware authors simply copy code from each other,\nthere are a number of other similarities discussed below which make a direct link in\nownership between the Xanthe and Abcbot campaigns more likely.\n\n**_For guidance on performing cloud IR, check out our latest playbook_** **_the Ultimate_**\n**_Guide to Forensics of Mining Malware in Linux Container and Cloud Environments._**\n\n**Xanthe – An Overview**\n\nXanthe is a family of cryptojacking malware with the primary goal of hijacking a system’s\nresources to mine the Monero cryptocurrency. Readers with some knowledge of the cloud\n[threat landscape will not be surprised to hear that Xanthe utilizes XMRig for its mining](https://xmrig.com/)\ncapabilities. XMRig has been used in several similar campaigns due to its highlyconfigurable and open source nature.\n\nXanthe spreads through the discovery of exposed Docker API endpoints. An initial script is\nused to install the malware’s main module xanthe.sh, which is responsible for propagation,\nnetwork scanning and the downloading of four additional payloads. These additional\npayloads include a malicious library for hiding processes (libprocesshider.so), a script to\ndisable security services and remove miners from competing campaigns and the XMRig\nbinary itself along with configuration data.\n\nIf you read our [analysis of Abcbot, you will likely recognize some of the above and may also](https://www.cadosecurity.com/the-continued-evolution-of-abcbot/)\nnotice some differences between these malware families.\n\n**Code Similarities**\n\nIn this section we’ll take a closer look at the code of the main Xanthe modules and we’ll\ncompare this with the Abcbot sample we analysed previously. As we’ll see, there are several\nsimilarities in both the code itself and overall functionality that suggest the same person(s)\nare behind both malware families.\n\n**Code Formatting**\n\nIn the original report from Cisco’s Talos security research team, researchers commented on\nthe coding style of the shell scripts being analysed – in particular, functions being declared at\nthe top of the file and then invoked in some of the later lines. Talos researchers suggested\n\n\n-----\n\nthat this likely aids testing of new iterations, with functionality enabled/disabled through\ncommenting of the lines responsible for function invocation. Both the Abcbot and Xanthe\nsamples we compared follow this coding style:\n\n_Function invocation in Xanthe_\n\n_Function invocation in Abcbot_\n\nLinking these two samples based on code style similarities alone would be tenuous, at best.\nHowever, if we look at some of the function names themselves, correlation becomes\napparent. Several of the functions have “go” appended to the end of the function name and\nsome functions have identical names. The following names appear in both samples:\n\n**nameservercheck**\n**croncheckgo**\n**checkrc**\n**iptableschecker**\n**filerungo**\n\nWe decided to dig deeper and compare the code from each of these functions individually to\nsee if we could further confirm our hypothesis that these samples were related.\n\n\n-----\n\n**nameservercheck()**\n\n_Xanthe nameservercheck function_\n\n\n-----\n\n_Abcbot nameservercheck function_\n\nComparing the above, we can immediately see that the Abcbot version of the\nnameservercheck function is significantly larger than the Xanthe counterpart. The Xanthe\nsample we analyzed is older than the Abcbot sample by over a year (according to VirusTotal\nsubmissions). This could indicate that the Abcbot version of the function has been iterated on\nseveral times, with new functionality added at each iteration. We covered the semantics of\nthis function in our analysis of Abcbot, but if we focus on lines 59-79, we can see that they’re\nvirtually identical to the Xanthe equivalent.\n\n\n-----\n\n_Abcbot nameservercheck function displayed to the left, Xanthe’s equivalent to the right_\n\nAs we covered previously, this function ensures that DNS requests are being resolved by a\npublic DNS provider – allowing the malware to make network requests across the internet.\n\n**croncheckgo()**\n\nThe croncheckgo function in both samples is responsible for achieving persistence via the\ncron scheduling utility common to most Linux distributions. Both samples include a TODO\ncomment from the author, regarding adding logic to determine whether cron is running on\ndifferent Linux distributions – a note to add logic presumably to deal with this. The service\ncommand is then used to start the cron daemon and cron itself, guaranteeing that any\nmodifications made to the crontab would be honoured by the scheduling utility.\n\n_Xanthe Cron TODO_\n\n_Abcbot Cron TODO_\n\nThis is fairly standard and although the wording of the comment is identical, it probably isn’t\nenough to be considered a link between the two samples.\n\nThe content of the following lines does differ slightly and is better-covered by both our\nAbcbot article and Talos’ Xanthe article. However, we begin to notice some interesting\nsimilarities when we reach the lines responsible for the cron entry itself.\n\n_Xanthe Cron entry_\n\n\n-----\n\n_Abcbot Cron entry_\n\nThe cron entries consist of curl commands with specified user-agent strings. The purpose of\nthis is covered in Talos’ research but if we look at the strings themselves, we can see that\n_fczyo-cron is used in both samples, with different version numbers appended to each._\nIncidentally, one of the payloads downloaded by Xanthe is also named “fczyo”.\n\nReuse of a unique string such as this does seem more than coincidental and suggests that\nthe code running on servers from both the Xanthe and Abcbot campaigns expects this string\nto be present in the user-agent.\n\n**checkrc()**\n\nThis function handles registration of an additional persistence mechanism in both samples –\nvia the /etc/rc.local file. Rc.local is common to most UNIX and UNIX-like systems and it\nallows commands specified by the user to be run at startup. This is especially useful for\nmalware persistence and, unsurprisingly, is a technique we see often when analysing Linux\nmalware.\n\n_Beginning of checkrc() in Xanthe_\n\n\n-----\n\n_Beginning of checkrc() in Abcbot_\nWhen comparing the two functions we can immediately see identical commenting, as we\nsaw in the croncheckgo function. The checkrc function has similar logic to croncheckgo;\npersistence is achieved by writing shell commands to the rc.local file and a unique useragent string (rc.local/1.5) is specified. Again, we can see different version numbers\nappended to this string between the samples, suggesting that the author has iterated on the\nfunction itself. It seems logical to assume that the purpose of this string is to identify the\nmethod of persistence to server(s) controlled by the attacker and serve an appropriate\npayload.\n\nReturning to the beginning of the function, we can see that each of the lines preceding the\ncomments are virtually identical between both samples. The author performs an existence\ncheck for /etc/rc.local and then checks the contents using grep. A seemingly-random string is\nsearched for in the rc.local file; this string differs between samples but is likely used to\nidentify the campaign.\n\nThe author also uses the chattr command to remove attributes from the file (ensuring\nmodification is possible) and re-adds them. This is a common technique used by other cloudfocused malware campaigns so can’t be relied upon solely for attribution. However, it is\ninteresting to note that both the structure of the code, TODO comments, the wording of the\nlogging output and several of the lines themselves are identical in this function.\n\n**iptableschecker()**\n\n\n-----\n\n_iptableschecker function in Xanthe_\n\n\n-----\n\n_iptableschecker function in Abcbot_\n\nCode style similarities between these two functions are immediately apparent. We can see\nthat in both cases, the author makes use of the hash symbol to delimit distinct iptables rules\nand the wording of the logging statements are identical throughout.\n\nIt’s clear that the Abcbot version of this function has been simplified somewhat, perhaps\nindicating a difference in objective between the campaigns. If we examine the rules\nthemselves, we can see clear connections in terms of the infrastructure used in the\ncampaigns. For example, the following rule allowing ingress traffic from 64[.]225[.]46[.]44 in\nthe Xanthe sample also appears in Abcbot:\n\n_iptables ingress traffic rule in Xanthe_\n\n\n-----\n\n_iptables ingress traffic rule in Abcbot_\n\nEvidenced by the above, the author clearly no longer deems it necessary to add this rule to\nthe iptables ruleset if it does not exist on a host compromised by Abcbot. This could indicate\nthat the remote server is no longer in use or that the payloads/C2 infrastructure hosted at this\nIP is no longer relevant to the Abcbot campaign. It’s interesting to note that the author still\nchecks for the existence of this rule. This could indicate a desire to check whether this host\nwas successfully compromised by an earlier campaign, such as Xanthe.\n\nSimilarly, the Xanthe version of this function includes rules to drop ingress traffic from ports\n2375 and 2376.\n\n_iptables Docker rules in Xanthe_\n\nThese ports are associated with Docker’s API and researchers at Talos suggested that this\ncould be a tactic to prevent the system from being reinfected by other malware abusing\nexposed Docker API endpoints. This functionality has been commented-out in the Abcbot\nversion of the function although, once again, the check for the rule is still performed and\nlogged. This could suggest a shift away from targeting misconfigured instances of Docker in\nthe Abcbot campaign.\n\n\n-----\n\n_iptables Docker rules in Abcbot_\n\n**filerungo()**\n\n_filerungo function in Xanthe_\n\n\n-----\n\n_filerungo function in Abcbot_\n\nThese functions have more syntactic and style differences than the functions we previously\nanalyzed. However, if we consider the logic that the function is responsible for, we can begin\nto notice similarities. Firstly, let’s look at an example of lines that are virtually identical\nbetween the samples.\n\n_vm.nr_hugepages configuration in Xanthe_\n\n\n-----\n\n_Commented equivalent in Abcbot_\n\nIn the Xanthe sample, we can see that the authors configure the HugePages feature via the\nvm.nr_hugepages parameter. This likely facilitates cryptocurrency mining, by configuring the\nsystem to support memory pages greater than the default. In Abcbot, we can see these\nsame lines commented-out, potentially indicating that mining is no longer an objective of this\n[campaign. This supports the findings in our initial analysis of Abcbot, as we didn’t see any](https://www.cadosecurity.com/the-continued-evolution-of-abcbot/)\ndeliberate attempts to install the XMRig mining software in that particular sample.\n\nSemantically, the two functions are similar in that they check for a process associated with a\nprior compromise, log whether the process is running and, if not, launch the process as\nnecessary. The lines used to check for the existence of the process (711-712 in Xanthe and\n1196-1197 in Abcbot) are virtually identical.\n\n**Miscellaneous Findings**\n\n**SSH Propagation**\n\nTalos researchers noted that the method of propagation utilized by Xanthe was via\nenumeration of the known_hosts file, allowing the malware to spread to new hosts based on\nhosts the current host had previously connected to. The code responsible for this can be\nseen below:\n\n_Propagation code seen in Xanthe – image credit: talosintelligence.com_\n\nWe observed this same technique being used by the authors of Abcbot, in the creativelynamed function fucksshlog():\n\n_SSH propagation code seen in Abcbot_\n\n\n-----\n\n**Adding Malicious Users**\n\nOur research of Abcbot showed examples of code used to add four malicious users to the\ncompromised host, effectively creating four backdoors for the actor to utilize. The malicious\nusernames in question were:\n\n**logger**\n**sysall**\n**system**\n**autoupdater**\n\nIn the Xanthe sample, users with the same usernames are added to the system (if they do\nnot already exist).\n\n\n-----\n\n_Adding of malicious users in Xanthe_\n\n\n-----\n\nSimilarly, both Abcbot and Xanthe search for and remove users that we assumed were from\ncompeting campaigns. However, we now believe that at least some of these users come\nfrom historical campaigns by this same actor. Both samples include code to remove a user\nwith the username “opsecx12”. A similar string can be found displayed as ASCII art at the\ntop of the Xanthe sample (along with an appeal for donations from other actors making use\nof this malware).\n\n_opsec_x12 ASCII art in the Xanthe sample_\n\n_Code to remove a user with the_\n\n_username “opsecx12” in Abcbot_\n\n**References to /etc/ld.so.preload**\n\nAs researchers at Talos reported, perhaps one of the defining features of Xanthe was the\nuse of an open source process hiding library named libprocesshider.so. This was used to\nhide the process created by the XMRig miner by inserting the path to the library into the\n/etc/ld.so.preload file.\n\nWe did not see evidence of this process hiding technique in the Abcbot sample we analyzed.\nWe did, however, see some code that references use of the technique in previous\ncampaigns (such as Xanthe) in the function kill_miner_proc; a function responsible for\nclearing artifacts of miners from competing or prior campaigns.\n\n\n-----\n\n_Removal of /etc/ld.so.preload file_\n\nGiven that this technique was a fairly noteworthy feature of the Xanthe malware, we believe\nthis indicates yet another link between the two families.\n\n**Conclusion**\n\nReaders with some experience in this field will have probably already considered the fact\nthat the samples analysed in both of these campaigns are shell scripts and, therefore,\nincredibly easy to copy. This is, of course, common. Code reuse and even like-for-like\ncopying is often seen between malware families and specific samples on any platform. It\nmakes sense from a development perspective; just as code for legitimate software is reused\nto save development time, the same occurs with illegitimate or malicious software.\n\nAs we’ve shown in this report, we believe that there are several links between both the\nXanthe and Abcbot malware families that suggest the same threat actor is responsible.\nThese include reuse of unique strings, mentions of shared infrastructure, stylistic choices\nand functionality that can be seen in both samples – most of which would be difficult and/or\npointless to copy exactly. If the same threat actor is behind both campaigns, it signals a shift\naway from the objective of mining cryptocurrency on compromised hosts onto activities more\ntraditionally associated with botnets – such as DDoS attacks. We suspect this won’t be the\nlast malware campaign we analyze from this actor.\n\n**Indicators of Compromise (IoCs)**\n\n**Filename** **SHA256**\n\nxanthe.sh 6a5a0bcb60944597d61d5311a4590f1850c2ba7fc44bbcde4a81b2dd1effe57c\n\nff.sh 56d677ed192b5010aa780d09c23b8ee8fdff94d39b20a07c7de76705e5f8c51f\n\n**References**\n\n**_For tips and best practices when conducting forensics and incident response of_**\n**_mining malware attacks in Linux container and cloud environments, read_** **_the Ultimate_**\n**_Guide to Forensics of Mining Malware in Linux Container and Cloud Environments._**\n\nAbout The Author\n\n\n-----\n\nMatt Muir\n\nMatt is a security researcher with a passion for UNIX and UNIX-like operating systems. He\npreviously worked as a macOS malware analyst and his background includes experience in\nthe areas of digital forensics, DevOps, and operational cyber security. Matt enjoys technical\nwriting and has published research including pieces on TOR browser forensics, an emerging\ncloud-focused botnet, and the exploitation of the Log4Shell vulnerability.\n\n**About Cado Security**\n\nCado Security provides the cloud investigation platform that empowers security teams to\nrespond to threats at cloud speed. By automating data capture and processing across cloud\nand container environments, Cado Response effortlessly delivers forensic-level detail and\nunprecedented context to simplify cloud investigation and response. Backed by Blossom\nCapital and Ten Eleven Ventures, Cado Security has offices in the United States and United\n[Kingdom. For more information, please visit https://www.cadosecurity.com/ or follow us on](https://www.cadosecurity.com/)\nTwitter [@cadosecurity.](https://twitter.com/CadoSecurity)\n\n[Prev Post](https://www.cadosecurity.com/our-take-four-cloud-security-predictions-for-2022/) [Next Post](https://www.cadosecurity.com/resources-for-dfir-professionals-responding-to-whispergate-malware/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-10 - Abcbot - An Evolution of Xanthe.pdf"
    ],
    "report_names": [
        "2022-01-10 - Abcbot - An Evolution of Xanthe.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535997,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653754577,
    "ts_modification_date": 1653754577,
    "files": {
        "pdf": "https://archive.orkl.eu/060e3314734e8774569db473b0b7bcde28a110e4.pdf",
        "text": "https://archive.orkl.eu/060e3314734e8774569db473b0b7bcde28a110e4.txt",
        "img": "https://archive.orkl.eu/060e3314734e8774569db473b0b7bcde28a110e4.jpg"
    }
}