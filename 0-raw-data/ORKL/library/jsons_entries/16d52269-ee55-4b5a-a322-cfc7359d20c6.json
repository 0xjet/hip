{
    "id": "16d52269-ee55-4b5a-a322-cfc7359d20c6",
    "created_at": "2023-01-12T15:04:03.858724Z",
    "updated_at": "2025-03-27T02:09:07.941823Z",
    "deleted_at": null,
    "sha1_hash": "b76743a97db3664476bc8d8a49b64aecb30e6d28",
    "title": "2016-08-01 - CrowdStrike’s New Methodology for Tracking eCrime",
    "authors": "",
    "file_creation_date": "2008-12-30T14:32:05Z",
    "file_modification_date": "2008-12-30T14:32:05Z",
    "file_size": 2125786,
    "plain_text": "# Leveraging Ethernet Card Vulnerabilities \n in Field Devices\n\nDaniel Peck, Dale Peterson\n\nDigital Bond, Inc.\nFort Lauderdale, Florida\n{peck, peterson}@digitalbond.com\n\n**Abstract: Field devices essential for the monitoring and control in DCS and SCADA**\nsystems are increasingly being deployed with Ethernet cards to connect these devices to\nlocal and wide area IP networks. Many of the Ethernet cards have their own CPU,\nmemory, operating system and applications. Field device vendors are also providing the\ncapability to upgrade or replace the firmware in these Ethernet cards. Unfortunately in\nmost cases there is no effective security on the firmware upload to the field device\nEthernet cards.\n\nIn this paper the authors demonstrate how using commonly available tools an attacker\ncan learn how firmware is loaded into two different field device Ethernet cards, write his\nown malicious firmware, and load that malicious firmware into the field device Ethernet\ncards. After this proof of concept malicious firmware load, the authors discuss different\nclasses of attacks that could be launched against the process being controlled, other field\ndevices and other systems on the control system network.\n\nThe paper concludes with a brief discussion and examples of vulnerabilities in common\nmanagement services, such as HTTP, FTP and SNMP, found on many field device\nEthernet cards.\n\n**Keywords: Unauthenticated Firmware Upload, PAC, PLC, RTU, Controller, Field**\nDevice, Field Device Worm, Field Device Ethernet Card\n\n## 1 Introduction\n\nField devices are critical components of control systems. They communicate with\nsensors and actuators to monitor and control a process. The increasing computing\npower and capabilities in field devices allows asset owners to push more intelligence to\nthese field devices, and they become much more than communication devices between\nan HMI or control center and the sensors and actuators on the plant floor or field site.\nCommon terms for field devices include Programmable Logic Controllers (PLC),\nProgrammable Automation Controllers (PAC), Remote Terminal Units (RTU) and\nIntelligent Electronic Devices (IED).\n\nAs with most control system components, field devices were designed for a closed,\ntrusted network with little thought for security. If an attacker can ping the typical field\ndevice, and has a client or HMI to communicate with the field device, he can send any\n\n\n-----\n\nread, write, diagnostic or configuration command to the field device. This is due to a\nlack of source or data authentication in most control system protocols. Some examples\nof control system protocol based attacks include:\n\n  - Writing new values to set points, thereby changing the process\n\n  - Rebooting the field device continuously to affect availability\n\n  - Setting the field device to listen only mode so it will not respond to requests\n\nDigital Bond has developed network Intrusion Detection System (IDS) signatures that\nhave been integrated into most commercial IDS sensors to identify these attacks for\nModbus TCP, DNP3, and ICCP [1].\n\nA similar lack of security features is often found in non-control system protocols such as\nTelnet, FTP, HTTP and SNMP that are used to manage a field device. Some field\ndevices support one or more user accounts for login, but even this feature is rarely used.\n\nBeyond demonstrating the ease in exploiting an insecure control system or management\nprotocol, most field device security analysis and testing to date has involved fuzz testing\nthe field device’s protocol stack [2]. Unfortunately many field devices have failed even\nminor fuzz testing of Ethernet, IP and TCP/UDP protocols. Some have even failed\nwhen legitimate, properly formatted broadcast and multi-cast packets are sent to the\nfield device. Failure most often is a crash of the Ethernet interface or the entire field\ndevice and requires a reboot to resume normal operations.\n\nGiven this extremely vulnerable state of most field devices, why is further testing or\nanalysis of exploits warranted? For at least two reasons:\n\n1. A knowledgeable attacker could stage an attack for a time and purpose with\n\nmaximum impact, and this could be done well after the compromise. This paper\nwill discuss some potentially devastating scenarios.\n\n2. A compromised field device can be used as an attack platform for other\n\nelements in the network. There are tens or hundreds of field devices in control\nsystems that could be used for individual or coordinated attacks. Imagine a\ndistributed denial of service (DDOS) from the field devices on all servers and\nworkstations in the control center. A field device is also less likely to be\nanalyzed for its security posture as compared to an HMI running Windows or a\nserver running Unix. This is analogous to the use of compromised printers as an\nattack platform in a corporate network.\n\nThe easiest point of field device access for a cyber attacker is the Ethernet card. Many of\nthese cards have their own CPU, RAM and operating system. The computers on these\ncards can be attacked and often exploited. Once exploited, they can be used to attack the\nCPU and other cards on the field device as well as other devices on the control system\nLAN and WAN.\n\nThis paper describes different classes of attacks on field device Ethernet cards, sample\nvulnerabilities found in numerous field devices and corresponding exploits, and the\npotential consequences of these exploits assuming a knowledgeable attacker.\n\n\n-----\n\n## 2 Rogue Firmware Load\n\nMany field devices allow the firmware to be updated over the network. This is also often\ntrue of field device Ethernet cards with their own computing resources. A remote\nfirmware update can be very useful, especially in a geographically dispersed SCADA\nnetwork, for recovery from system corruption, patching newly discovered problems or\nupdating the field device software with new features. It also can be very useful for an\nattacker if it is not properly authenticating the source and data being uploaded prior to\naccepting and loading this new firmware.\n\nIn the multiple field devices that Digital Bond has in its lab, not one of these field\ndevices authenticates the source or data prior to accepting and loading the firmware. If it\nis possible for a legitimate user to upload new firmware over the network, it is possible\nfor an attacker, with some work at the assembly code level and logical access to the field\ndevice, to upload his own firmware.\n\nIn Section 2, the authors will describe the steps required to load arbitrary firmware on\ntwo different systems and some possible ways an attacker might use this capability\nbeyond simply attacking the selected field device. It is important to note that this\nproblem is widespread, and goes much beyond these two systems. Any vendor or asset\nowner that has field devices that allow unauthenticated or weak authentication firmware\nuploads should be concerned and contact their vendor for guidance and a solution.\n\n2.1 Systems Described\n\nOur test devices for this research were the Rockwell 1756 ENBT Ethernet module and\nthe Koyo H4-ECOM100 Ethernet module, see Figure 1. While similar in functionality\nthese devices were built on very different platforms.\n\nThe 1756 ENBT module is a PowerPC device running a VxWorks 5.5 operating system,\nintended to be managed primarily by the RSLogix family of products. Services available\non the device include EtherNet/IP, HTTP, and SNMP. FTP is also available with a little\nmore work, as we’ll discuss later.\n\nThe H4-ECOM100 module is a device based on a Nios Altera Field Programmable\nGate Array (FPGA) chipset. The services available on this device include HTTP and\nMODBUS/TCP.\n\nWhile the web interface on the 1756 ENBT is intended almost exclusively for displaying\ndiagnostic information, the H4-ECOM100 web server is used extensively for\nconfiguration and maintenance activities.\n\n\n-----\n\n_Figure 1 – Koyo H4-ECOM100 and Rockwell Automation 1756 ENBT Modules_\n\n2.2 Learning and Exploiting the Load\n\nWe began the process by obtaining several sets of firmware images from the Rockwell\nvendor site. Several versions were downloaded to allow for comparison, to help in\nidentifying static fields, and various “special” locations in the firmware. Our first step in\nthe analysis was to examine the binaries themselves. In this analysis we find several\ndifferent segments, some with readable text, that appear to be some of the web pages\nthat the device serves. These appear to exist in a CISF FTL partition, which is similar\nenough to FAT16. These will be investigated later, but for now we will move on and\ncontinue looking for the actual code that gets executed, and being that we are at a bit of\na dead end here we’ll start to rely of assumptions and experience.\n\n\n-----\n\n_Figure 2 - HTML Visible in Firmware_\n\nUsing a tool developed by Matasano named deezee, we scan the firmware image looking\nfor zlib compressed sections, and we get a hit. Pulling this into our hex editor and\nexamine some strings, we find what appears to be some symbol names, such as AB_Exit\nat 0x001ef0b4 and AB_Init at 0x001ef0ac. These seem interesting but we have to find\nthe offset table to be able to do anything very useful. Looking through the file we notice\na very regular ten-byte pattern beginning at 0x001fbdf8.\n\n\n-----\n\n_Figure 3 – Ten Byte Pattern: 0x 0000 0500 0000 0000 002E_\n\nThe first address looks a lot like the address of AB_Exit, and the second one looks a lot\nlike the address of AB_Init. Some quick subtraction and we find that our load address is\n0x00100000, and it looks like the next entry in that repeating pattern is the address of\nthe code itself. We’re almost ready to begin some real analysis, but first we have to know\nwhat kind of processor this code was meant to run on, our first guess was that it was on\nan ARM chip, but looking at the firmware dump we see r0, sp, r2, and quite a few\nothers, we have our answer, a Power PC processor.\n\n\n-----\n\n_Figure 4 – Identifying the Power PC Processor_\n\nWe have loaded the file into the IDA PRO disassembler and debugger program and\nrebased the image. Now after a little scripting to add the rest of the symbols into our\nfirmware image we can get down to business on understanding the rest of the firmware\nfile structure and any validation routines it might have in place. The function\nnv_RamValidateChecksumsWriteFlash that makes two calls to ffs_CalcChecksum looks\ninteresting, and here is where we begin to really understand the inner workings of the\ndevice.\n\n\n-----\n\n_Figure 5 – nv_RamValidateChecksumsWriteFlash Function_\n\nReverse engineering the disassembly we find 2 checksums. A 2 byte sum or 2 byte\nhalfwords of the header, and a 2 byte sum of 2 byte halfwords of the remainder of the\n\n\n-----\n\nfile. So we have the header of the file, 2 byte header checksum at 0x0, 4 bytes data offset\nat 0xc, 4 byte data size at 0x10, and 2 byte data checksum at 0x14. With this knowledge\nwe are able to change the external “wrapper” portion of the firmware as we see fit, this\ninclude the web pages stored there, and upload it with the ControlFlash program\nprovided by the vendor so customers can load new firmware.\n\n_Figure 6 – Firmware Header and Checksum_\n\nThe authors developed proof of concept shellcode that makes use of the “PING”\nfunction already in the 1756 ENBT module. This is much like making use of a system\ncall on a Windows operating system. Being careful not to disrupt the current functions\nof the device we have embedded this code into a portion of the FTP server code. The\n1756 ENBT module now pings a specified IP address while continuing to perform its\ndesigned purpose for the Logix PAC.\n\nThis ping is meant only as a demonstration that an attacker with logical access could\nload and run arbitrary firmware on the 1756 ENBT module due to lack of any source or\ndata authentication. Since the card has significant unused memory and processing\npower, an attacker could load and run much more substantial and dangerous code on\nthe module within a reasonable amount of development time. The vendor’s\n\n\n-----\n\nControlFlash program was used to make the upload easier, but we could have developed\nour own flash upload utility if necessary.\n\nThe process of learning and exploiting the load with Koyo/AutomationDirect H4ECOM100 module was similar. In fact, the process was similar for all of the field\ndevices in our lab that had a firmware upload lacking in source and data authentication.\n\nWith firmware images and utilities found on AutomationDirect.com website and the\ncommonly used packet capture utility, Wireshark, we find that the firmware is upgraded\nusing a protocol that Wireshark doesn’t know about. We need more information on this\nupload protocol. One thing that is common in all the messages is they begin with\n“HAP”.\n\n_Figure 7 – Identifying “HAP” in Messages_\n\nWe could not find information on this protocol on the Koyo or Automation Direct\nwebsites. However, an Internet search revealed a document that described the protocol\nand ECOM interface in some detail [3], see Figure 8.\n\n\n-----\n\n_Figure 8 – ECOM Protocol Packet Header_\n\nExamining the firmware images we get some clues about the internals of the module.\n“Nios OS” is a good bit of information that its run on the NIOS embedded FPGA\nprocessor from Altera. Looking further into the firmware upload procedure we find that\nthe upgrade program, netedit, seems to work over UDP broadcast protocol. However\nwith further investigation we find that this is a weakness of the program and not a\nweakness of the protocol itself.\n\nWe find the same lack of source and data authentication on firmware uploads in the\nKoyo system as found in the Rockwell Automation PAC. In fact the Koyo PLC\nfirmware upload appears to even lack a checksum. As a proof of concept for malicious\nfirmware upload, we uploaded modified web pages that are available from the ECOM\nmodule.\n\nWhile it is bad enough that these systems can be so easily compromised, an even greater\nconcern is as long as the compromised field device is still functioning as expected the\nasset owner could be completely oblivious to the fact that many or even all of the field\ndevices in the control system have been compromised.\n\nExtrapolating out from this and working with other devices we have found similar\nresults. Over the network firmware uploads are, in general, not authenticated or\notherwise protected in any meaningful way. Typically a checksum is used to authenticate\n\n\n-----\n\nthe integrity from a non-malicious, load integrity standpoint. This checksum offers little\nprotection from a motivated and moderatedly skilled attacker.\n\nMany field devices use different and more obscure processors than what an average\nattacker would see in the PC-dominated corporate world. While the obscurity of a\nprocessor can make the potential attackers work harder to investigate, develop and\nimplement a malicious firmware upload to a field device, it is not a safeguard. Much\nwork has been done on similar platforms by the gray and black hat community, such as\nhome switches and routers, and that knowledge will transfer over easily for future field\ndevice hackers.\n\nEven this security by obscurity is becoming less of a deterrent. Many field devices are\nmoving to Intel x86 chips as well as more common operating systems such as embedded\nXP or embedded Linux. While these are not necessarily easier to develop firmware\nuploads for, there are many more attackers and tools available to help an attacker exploit\nthese systems. It will take less specialized knowledge and less expensive tools to attack a\nfield device on an x86 platform as compared to a field device with an ARM.\n\n2.3 Attacking the PLC\n\nAs mentioned in the Introduction section, logical access to most field devices allows an\nattacker to read and write to the device. So what benefit is there in uploading new\nfirmware over directly monitoring the sensors and controlling the actuators and other\ninstruments in real time? The answer to this question is limited only by imagination.\nHere are a few scenarios to illustrate the benefit to an attacker.\n\n2.3.1 Delayed Attack\n\nAn attacker may want to stage an attack in advance and have it ready to launch at a time\nthat is particularly damaging. Imagine an attack on a region’s power system that caused\nan outage at 11:58 on New Years Eve, on election day, or at the start of a big event like\nthe Olympics. The malicious firmware upload could allow normal operations until a\ncertain time and date and then launch a scheduled attack.\n\nA delayed attack scenario could be coordinated between multiple field devices that had\nbeen exploited with a malicious firmware upload that set up a cron job to run at a\nspecific time. These could be field devices across a single control system or even field\ndevices in multiple control systems.\n\nAnother benefit of the delayed attack is it would be substantially harder for an asset\nowner to determine what caused the outage or incident. A review of recent traffic to and\nfrom the field device, if this were even available, would not show the firmware upload.\nDepending on the nature of the attack, there is a good chance that the asset owner\nwould not even realize a cyber attack took place. It could be made to look like a\nhardware failure, communications error or some other non-malicious cause.\n\nFinally, a delayed attack can address the situation of an attacker losing access to the field\ndevice. Imagine a malicious firmware upload that required a message from the attacker\non a monthly basis or an attack would be launched. This attacker may want to have the\ncapability to bring down part of the critical infrastructure or a particular organization he\n\n\n-----\n\nholds a grudge against, but chooses to reserve that capability for an unspecified future\nneed. If the asset owner has improved perimeter security and the attacker no longer has\naccess to field devices he owned. His capability to schedule an attack is lost, but the\nattack would launch within a month.\n\n2.3.2 Brick the Ethernet Card\n\nThe malicious firmware could be programmed for an Ethernet card failure that required\na return to factory by removing the ability to reload new firmware and removing the\nproper firmware capabilities - - turning the card into essential dead weight or a brick.\n\nA single Ethernet card failure is unlikely to cause much of a problem for an organization\nmindful of redundancy and recovery requirements in a control system. Spares would be\navailable. However it will take time to replace the card, especially in a geographically\ndispersed SCADA system. If this attack was made on Ethernet cards in a large number\nof controllers this could exhaust the spares and cause availability problems to travel and\nreplace numerous simultaneous Ethernet card failures.\n\n2.4 “Random” Attack or Failures\n\nAn attacker’s goal may not be to cause an outage that affects a large number of people.\nThe attacker may not want to shut down power to a region or affect the ability of a large\ncity to get gasoline or water. This level of impact may be more than the attacker desires\nand the consequences of getting caught performing such an attack is likely to prevent\nmany potential attackers as discussed in the Langner and Singer paper [4].\n\nFor an attacker, perhaps a disgruntled insider, who just wants to make difficulties for the\noperators and engineers a “random” attack or failure mode may be more interesting.\nThe attacker could load malicious firmware into multiple field devices and have a\npseudo random number generator select the attack and the attack time. Imagine the case\nwhere the malicious software could temporarily make the device unavailable, brick the\ncard, send false data back to the control center, make process changes or simply reboot\nthe system multiple times. The random number could select the attack from the list, a\nsecond number could select the attack start time and date, and a third random number\ncould select the attack duration.\n\nTroubleshooting these problems could be made very difficult if the field device returned\nthe expected information, such as version number and checksum, during diagnostic\ntests. The malicious software could also prevent the loading of new firmware onto the\nEthernet card without a special code or authentication mechanism. The malicious\nfirmware could be programmed to issue a response that indicated the asset owner had\nsuccessfully loaded new firmware, perhaps even modifying the firmware version number\nreturned when requested, while in fact the malicious firmware remained intact.\n\n2.5 A Field Device Worm\n\nEach field device has its own set of software and methods to program, configure and\nmanage the system. Once an asset owner has purchased and learned to configure and\nprogram a field device, they are likely to purchase additional field devices of the same\n\n\n-----\n\nmodel. While it is not unusual for an asset owner to have a variety of field devices, it is\ntypical that they will have tens or hundreds of each vendor model.\n\nSince the unauthenticated firmware upload allows an attacker to load malicious code on\nthe field device, the attacker may be interested in identifying all field devices of the same\nmodel and compromise all of them. This is achievable with a field device worm designed\nto take advantage of the lack of source and data authentication of a field device firmware\nupload.\n\nAs an example, imagine an attacker has identified an Allen Bradley field device on the\nnetwork. Since these devices typically use the EtherNet/IP protocol on TCP/44818\nthey are easy identify on a network with a port scan of that port. A worm can be written\nthat would:\n\n1. Port scan to identify other systems with EtherNet/IP ports that are open\n\n2. Attempt to load the attacker’s firmware on all identified EtherNet/IP systems\n\n3. Report back to the master after the system is compromised\n\n4. Standby for future instructions or take preprogrammed actions\n\nAn attacker would be in a similar situation to attackers that have control of an army of\nbots except they would be on a control system network.\n\n2.6 Attack Other Cards on the Field Device\n\nWhile the Ethernet card is the most accessible to an attacker or malware, it is not the\nmost important card in a field device. In fact many control systems today use the field\ndevice Ethernet card for maintenance and still rely on serial communication cards for\nSCADA system monitoring and control. This is likely to be less common over time as\nmore asset owners move to an IP WAN for their SCADA systems.\n\nThe most important card in field devices is typically the CPU card. If this card is not\nfunctioning properly, the entire field device will not function. Some CPU cards also\nsupport a remote firmware update through the Ethernet card. The CPU card may have a\ndifferent computing architecture, different load utility and other differences from the\nEthernet card, but it also may be identical.\n\nPerhaps the simplest attack on the CPU card is a denial of service attack that could brick\nthis CPU card. Imagine a case where the Ethernet card is compromised with rogue\nfirmware that periodically, or perhaps pseudo randomly, uploaded to firmware to the\nCPU card that bricked the CPU card. The asset owner would replace the CPU card, but\nthe underlying problem would remain in the Ethernet card.\n\n2.7 Attack Other Systems\n\nThe attacks discussed in Section 2 to this point have focused on attacking the field\ndevices to affect the monitoring and control of the process. However, one or more\ncompromised systems on a control center LAN or WAN provide an attack platform to\ngo after other systems on the SCADA or DCS, such as workstations or servers.\n\n\n-----\n\nField devices are usually not considered as potential attack platforms. They are not\npatched or upgraded frequently; typical asset owners do not worry about security\npatches, anti-virus and security configuration issues with field devices nearly as much as\nthey do for a Windows HMI; they are deployed and often not touched for years. In\nmany ways, these field devices are similar to printers on a corporate network. They are\ncomputing platforms spread throughout the network that are treated like appliances\nrather than computing devices.\n\nOne of the common findings in control system security assessments is missing security\npatches. It is not unusual to find Windows systems missing patches for many years. An\nasset owner who is diligently patching the Windows OS every month may be missing\npatches in the Oracle database, Java Runtime Environment, Apache web server, or other\nnon-Windows software. An attacker could upload malicious firmware on a field device\nto identify and exploit missing security patches on workstations and servers on the\nSCADA and DCS.\n\nAn example of this malicious software could be in the form of a worm that would seek\nout other similar devices to exploit and load itself onto, but also have a set of attacks for\nHMI’s, real time servers, and historians. This behavior could be uncontrolled as many\nearly worms were, and simply exist for destructiveness, or it could be controlled by an\nauthority or “botmaster” directing the activities of the compromised devices and\nsystems.\n\n2.8 Solutions\n\nThe solutions to the malicious firmware upload over the network are straightforward.\nThe low-tech solution is to not allow over the network firmware upload. Many\ncontrollers have physical keys that can restrict the ability to load new firmware over the\nnetwork or locally. This is an effective control, but it can have a significant impact on\nthe ability to manage a system of field devices, especially in a geographically dispersed\nSCADA system.\n\nThe high-tech solution is to add source and data authentication to the firmware upload\nprocess. The most straightforward way to do this is with a public key certificate\ninfrastructure and a digital signature on the firmware upload. The field device could\nverify the certificate and the digital signature to confirm the firmware was from an\nauthorized entity and had not been changed in transit. This would require public key\nimplementations on the Ethernet cards, but efficient and secure algorithms are available\nusing elliptic curve technology [5]. Since firmware updates are rare events, the\nprocessing time required to verify the certificate and digital signature is not an important\nfactor.\n\n## 3 Management Application Vulnerabilities\n\nField device vendors have been trying to find ways to make field device management\neasier and provide more status information to network management and monitoring\nsystems. It is common to find field devices with web servers, FTP servers, the SNMP\n\n\n-----\n\nservice, and the Telnet service. Each of these servers or services are well known and\ncommonly attacked by the hacking community.\n\nSometimes the operating system on the Ethernet card provides these servers and\nservices; in other cases the field device vendor develops their own server and service;\nand in many cases the field device vendor buys a low cost or obtains a free management\nserver or service. The commonality in all these cases is these management servers and\nservices are rarely designed to be full featured, maintained and secured. They often fall\ninto the category of “quick and dirty”.\n\nAn alert asset owner will know they should patch a Microsoft IIS or Apache web server\nby monitoring one or more cyber security bug fix lists. But that same asset owner is\nunlikely to even monitor the vendor of the web server on a field device for\nvulnerabilities and security patches.\n\nIn a review of the field devices installed in Digital Bond’s lab, we found that many of the\ncommon vulnerabilities in similar IT applications in the applications integrated into the\nfield device. This section provides examples of common vulnerabilities in these\nmanagement services found in a small sample of field devices.\n\n3.1 Web Server\n\nSeveral different forms of cross site scripting (XSS) were found on the sample field\ndevices. These vulnerabilities can be leveraged to exploit vulnerabilities in client side\nsoftware, such as Internet Explorer. We found both persistent and non persistent XSS,\nsome that would require social engineering to encourage a user to follow a link, and\nothers that could wait for a user to visit the management interface before the attack was\nlaunched, weeks or even months later.\n\nFlaws were also found which enabled unauthenticated users to view the ASP source\ncode of a page and access configuration files without a password by appending a trailing\n“/” to the URL.\n\n3.1.1 Example\n\nThe Koyo H4-ECOM100 module provides a good demonstration of these types of\nvulnerabilities. The management interface requires no authentication to access the device\nand the user editable fields are not properly sanitized before being served back to the\nuser.\n\n_Figure 9 – Part 1 of XSS Example on Koyo H4-ECOM100 Module_\n\n\n-----\n\n_Figure 10 – Part 2 of XSS Example on Koyo H4-ECOM100 Module_\n\n3.2 FTP Server\n\nDuring the disassembly of the Rockwell Automation device code a FTP server was\ndiscovered, however the device does not have this FTP server functionality enabled. By\nmanipulating the firmware and simply replacing a 0 with a 1 in an XML configuration\nfile that was clearly visible in the firmware we were able to activate and interact with the\nFTP service. So we have not only expanded the functionality of the device, but also\nexpanded the attack surface. This functionality was provided by the underlying operating\nsystem and the vendor may not have been aware that the FTP server code was even on\nthe Ethernet card.\n\nInitially we are simply presented with a login when connecting to the FTP service, but\nwith the Administrator username and blank password, discovered through the\nassessment of web server, we are able to login to the device. Not only did this open up\nmany other FTP commands to attack, commands in which vulnerabilities were found,\nbut also now provides a location to store information for later use in exploitation or to\nstore damaging or illicit data.\n\n3.3 SNMP\n\nThe Rockwell Automation 1756 ENBT module also runs a SNMP service that allows\nlarge amounts of information to unauthenticated sources that could be leveraged in\nfurther attacks against the system, such as services and types of device. The lack of\nauthentication is just further evidence that these field devices were designed with the\n\n\n-----\n\nexpectation they would be in a secure environment and only accessible by authorized\nusers.\n\n## 4 Operating System Vulnerabilities\n\nWhile beyond the scope of this paper, the authors feel it is important to recognize that\nthe underlying field device operating system is a large attack surface that has received\nlittle scrutiny by security researchers or the hacking community to date. Some real time\nand embedded operating systems are used in numerous field devices that monitor and\ncontrol critical infrastructures. These are likely to garner more attention by directed\nattackers in the future and are worthy of analysis by security researchers.\n\n## 5 Conclusion\n\nThe Ethernet cards on field devices present an attractive target for attackers because of\ntheir distribution throughout a modern control system, lack of security features and lack\nof security attention paid to these cards. In this paper, the authors have demonstrated\nhow a lack of authentication in the firmware upload allows an attacker to load malicious\ncode into two field device Ethernet cards. The impact of this malicious code on the\nprocess, field device and other components on the control system is limited only by the\ncreativity and imagination of an attacker.\n\nControl system asset owners should be determining if firmware can be uploaded into\ntheir field device Ethernet cards. And if the answer is yes, is this source and integrity of\nthis firmware upload authenticated prior to loading on the card? If firmware\nauthentication is not required, the vendor should be contacted and strongly encouraged\nto address this vulnerability. Asset owners should also consider adding authentication of\nfirmware uploads to any future buying criteria.\n\nFinally, control system asset owners and vendors should not ignore the security of the\nmanagement services commonly found on Ethernet cards such as HTTP, FTP, Telnet\nand SNMP.\n\n## _______________________\n\n**About the Authors – Daniel Peck is an Offensive Security Researcher at Digital Bond, and a key**\nmember of the U.S. Government funded Portaledge and Quickdraw research projects. Prior to\njoining Digital Bond, Mr. Peck was a security researcher at SecureWorks and a frequent presenter\nat leading security events such as BlackHat, Defcon and the Pentagon Security Forum.\n\nDale Peterson is a founder of Digital Bond, Inc. and has led their Control System Security\nConsulting and Research Practice since 2000. He began his career as an award winning\nCryptanalyst at the National Security Agency and has more than twenty years experience in\ninformation security.\n\n\n-----\n\n## References\n\n[1] Digital Bond SCADApedia,\n\nhttp://www.digitalbond.com/wiki/index.php/SCADA_IDS_Signatures.\n\n[2] E. Byres, D. Hoffman and N. Kube, “On Shaky Ground – A Study of Security\n\nVulnerabilities in Control Protocols”, American Nuclear Society, November 2006.\n\n[3] ECOM Ethernet Interface Specification, Host Engineering.\n\n[4] R. Lagner and B. Singer, “SCADA Threat Modeling Using Attack Scenarios”, 2008\n\nS4 Proceedings, Digital Bond Press, 2008.\n\n[5] R. Lambert, “ECC and SCADA Key Management”, 2007 S4 Proceedings, Digital\n\nBond Press, 2007.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/ICS SCADA/ICS Vulnerabilities/Leverage Ethernet Vulnerabilities in Field Devices.pdf"
    ],
    "report_names": [
        "Leverage Ethernet Vulnerabilities in Field Devices.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535843,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1230647525,
    "ts_modification_date": 1230647525,
    "files": {
        "pdf": "https://archive.orkl.eu/b76743a97db3664476bc8d8a49b64aecb30e6d28.pdf",
        "text": "https://archive.orkl.eu/b76743a97db3664476bc8d8a49b64aecb30e6d28.txt",
        "img": "https://archive.orkl.eu/b76743a97db3664476bc8d8a49b64aecb30e6d28.jpg"
    }
}