{
    "id": "d46c5a11-79bd-45e9-8540-cfa5f7f4f114",
    "created_at": "2023-01-12T15:03:42.930904Z",
    "updated_at": "2025-03-27T02:06:10.372965Z",
    "deleted_at": null,
    "sha1_hash": "1d996d90fd9392fa7edee4bbb041a44ab796f2d9",
    "title": "2020-06-11 - Qbot Banking Trojan Still Up to Its Old Tricks",
    "authors": "",
    "file_creation_date": "2022-05-29T01:18:11Z",
    "file_modification_date": "2022-05-29T01:18:11Z",
    "file_size": 555654,
    "plain_text": "# Qbot Banking Trojan Still Up to Its Old Tricks\n\n**[f5.com/labs/articles/threat-intelligence/qbot-banking-trojan-still-up-to-its-old-tricks](https://www.f5.com/labs/articles/threat-intelligence/qbot-banking-trojan-still-up-to-its-old-tricks)**\n\nAttack Type:\n\n[Client-side Attacks](https://www.f5.com/labs/search?q=%22Client-side+Attacks%22)\nAttack Method:\n\n[Credential Theft](https://www.f5.com/labs/search?q=%22Credential+Theft%22)\nAttack Motive:\n\n[Cybercrime](https://www.f5.com/labs/search?q=Cybercrime)\nMalware Type:\n\n[Trojan](https://www.f5.com/labs/search?q=Trojan)\nMalware / Campaign Name:\n\n[Qbot](https://www.f5.com/labs/search?q=Qbot)\nApp Tiers Affected:\n\nClient\n\n\nJune 11, 2020\n\n\n-----\n\nServices\n\nAccess\n\nTLS\n\nDNS\n\n\n-----\n\nNetwork\n\nApp Tiers Affected:\n\nClient\n\nServices\n\n\n-----\n\nAccess\n\n\n-----\n\nTLS\n\nDNS\n\n\n-----\n\nNetwork\n\nThere is no cease-fire in the continuing battle against malware. Qbot, a banking trojan malware\nactive since 2008, is back in business with new functions and new stealth capabilities. In the past\n12 years, this malware has gone by a handful of names, including Qakbot and Pinkslipbot.\n\nDespite all the variations and evolutions, Qbot’s main goal has remained the same: collect browsing\nactivity and steal bank account credentials and other financial information. Attackers usually infect\nvictims using phishing techniques to lure victims to websites that use exploits to inject Qbot via a\ndropper. It does this through a combination of techniques that subvert the victim’s web sessions,\nincluding keylogging, credential theft, cookie exfiltration, and process hooking.\n\nPreviously, Qbot also used worm self-replication techniques to copy itself over shared drives and\nremovable media. Qbot is still Windows-based, but this latest version adds both detection and\nresearch-evasion techniques. It has a new packing layer that scrambles and hides the code from\nscanners and signature-based tools. It also includes anti-virtual machine techniques, which helps it\nresist forensic examination. However, that didn’t deter us analyzing its new capabilities and\ndocumenting the infection flow.\n\n## Qbot’s Infection Process\n\nHere’s how the new Qbot infection typically occurs on a targeted computer:\n\n\n-----\n\n1. Qbot is loaded into the running explorer.exe memory from an executable introduced via\n\nphishing, an exploit’s dropper, or an open file share.\n2. Qbot copies itself into the application folder’s default location, as defined in the %APPDATA%\n\nregistry key.\n3. Qbot creates a copy of itself in the specific registry key\n\n**HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run to run when the system reboots.**\n4. Qbot drops a .dat file with a log of the system information and the botnet name.\n5. Qbot executes its copy from the %APPDATA% folder and, to cover its tracks, replaces the\n\noriginally infected file with a legitimate one.\n6. Lastly, Qbot creates an instance of explorer.exe and injects itself into it. The attackers then\n\nuse the always-running explorer.exe process to update Qbot from their external commandand-control server.\n\n## Qbot Web Banking Target List\n\nOur latest analysis of several sample of the malware from this year showed that Qbot’s focus is on\nbanks in the United States. This appears to be a dedicated campaign with a browser hijack, or\nredirection, as the main attack method when the machine is infected. As Qbot watches a victim’s\nweb traffic, it looks for specific financial services from which to harvest credentials. We found\nspecific strings within Qbot that targeted financial institutions, as shown in Table 1.\n\n**Target** **Locale**\n\nhttps://*.jpmorgan.com/*logoff* U.S.\n\nhttps://*/cmserver/logout.cfm* Any\n\nhttps://express.53.com/express/logoff.action* U.S.\n\nhttps://businessaccess.citibank.citigroup.com/cbusol/quit.do* U.S.\n\nhttps://businessaccess.citibank.citigroup.com/cbusol/signOff.do* U.S.\n\nhttps://singlepoint.usbank.com/cs70_banking/logon/sbbExit/logout.do* U.S.\n\n\nhttps://*citizensbankmoneymanagergps.com/cb/servlet/cbonline/jsp/invalidatesession.jsp*\n\n\nU.S.\n\n\nhttps://www#.citizensbankmoneymanagergps.com/cb/servlet/cbonline/LogEZDExit* U.S.\n\nhttps://ktt.key.com/ktt/cmd/logoff* U.S.\n\nhttps://cashproonline.bankofamerica.com/cpwportal/terminateSession.jsp* U.S.\n\nhttps://top.capitalonebank.com/cashplus/security?*Logout* U.S.\n\nhttps://cbs.firstcitizensonline.com/cb/servlet/cbonline/invalidate-session.jsp* U.S.\n\n\nhttps://www.corporatebanking.firsttennessee.com/cb/servlet/cbonline/jsp/invalidatesession.jsp*\n\n\nU.S.\n\n\n-----\n\nhttps://otm.suntrust.com/stbcorp/logon/cpExit* U.S.\n\nhttps://ocm.suntrust.com/sunt/logon/sbbExit* U.S.\n\nhttps://e-access.compassbank.com/bbw/cmserver/logout.cfm* U.S.\n\nhttps://treasurydirect.soc.tdbank.com/bbw/cmserver/logout.cfm* U.S.\n\nhttps://wellsoffice.wellsfargo.com/ceoportal/framework/ceo_logout.jsp* U.S.\n\nhttps://*.ebanking-services.com/nubi/SignOut.aspx* U.S.\n\nhttps://*.ebanking-services.com/nubi/SignIn.aspx?timeout=y* U.S.\n\nhttps://business-eb.ibanking-services.com/K1/logout.jsp* U.S.\n\n\nhttps://business-eb.ibankingservices.com/K1/servlet/com.brokatfs.typhoon.htmlinf.servlet.CustLogoffServlet*\n\n\nU.S.\n\n\nhttps://tcfexpressbusiness.com/bbw/cmserver/logout.cfm* U.S.\n\nhttps://treas-mgt.frostbank.com/rdp/cgi-bin/logout* U.S.\n\nhttps://treas-mgt.frostbank.com/rdp/cgi-bin/welcome.cgi?loggedOff=True* U.S.\n\nhttps://businessonline.huntington.com/BOLHome/LogoutIntercept.aspx* U.S.\n\nhttps://businessonline.huntington.com/bolhome/BusinessOnlineAutoLogoff.aspx* U.S.\n\nhttps://webinfoplus.mandtbank.com/cashplus/security?requestID=Logout* U.S.\n\nhttps://businessonline.tdbank.com/CorporateBankingWeb/Core/SessionTimeout.aspx* U.S.\n\nhttps://businessonline.tdbank.com/CorporateBankingWeb/Core/Logout.aspx* U.S.\n\nhttps://www.scotiaconnect.scotiabank.com/scoui/pki/LogoutFromSCO.bns* CA\n\nhttps://www.firstmeritib.com/Logout.aspx* U.S.\n\nhttps://www.firstmeritib.com/cb/servlet/cbonline/jsp-ns/redirectFM.jsp?Page=Logoff* U.S.\n\nhttps://www.easterntreasuryconnect.com/bbw/cmserver/logout* U.S.\n\n\nhttps://*/wcmfd/wcmframework/TrapFunctionality?\nfunctionalityURL=/wcmfd/wcmframework/Signoff*\n\n\nAny\n\n\nhttps://*/wcmfd/wcmframework/Signoff* Any\n\nhttps://www.abnamro.nl/nl/logon/logoff.html* Netherlands\n\nhttps://*treasury.pncbank.com/TSCMCWeb/logoutMC.htm* US\n\nhttps://*/TMConnectWeb/cgi-bin/logoutconfirm.cgi* Any\n\nhttps://*/TMConnectWeb/cgi-bin/logout.cgi* Any\n\n\n-----\n\nhttps://*svbconnect.com/LogoutServlet/* U.S.\n\nhttps://*.web-cashplus.com/Cashplus/*Logout* U.S.\n\nhttps://*/cmserver/logout.cfm* Any\n\nhttps://weblink.websterbank.com/weblink/logout.asp* U.S.\n\nhttps://*/CLKCCM/*/exit.asp* Any\n\nhttps://*.secure.fundsxpress.com/piles/fxweb.pile/exit* U.S.\n\nTable 1. Financial institutions Qbot targets.\n\n## Regional Targeting by Qbot\n\nAnalysis of the latest Qbot campaign shows that it is mainly focused on the United States (see\nFigure 1), targeting approximately 36 U.S. financial institutions and two banks in Canada and the\nNetherlands; the rest of the list contains generic URL targets that might be added as a second\nstage in the fraud action.\n\nFigure 1. Breakdown of Qbot redirection target list by country\n\n## Conclusion\n\nQbot has been around for a dozen years with pretty much the same functionality. The targets\nchanged and features were added, but it’s still primarily about keylogging and, secondarily, about\nextracting a victim’s personal data. As Qbot waxes and wanes in popularity with attackers, it is hard\nto gauge its overall impact on a global scale. However, it is still a viable threat for defenders to be\naware of.\n\n## Recommendations\n\n**Use updated antivirus software: Antivirus software is still a powerful tool for detecting and**\nstopping malware infections. Configure it to update its signatures without intervention and to\nalert you when it stops functioning.\n**Apply critical patches: Apply critical patches for vulnerabilities with published, weaponized**\nexploits for applications that touch the Internet, such as browsers and mail clients.\n**Inspect encrypted traffic: Most malware and phishing sites are buried within encrypted**\nSSL/TLS sessions, often using legitimate certificates. Decrypt, inspect, and sanitize this traffic.\n**Provide meaningful security awareness training: Make it easy for users to report**\nsuspicious behavior. The [F5 Labs 2018 Phishing and Fraud Report showed that training](https://www.f5.com/labs/articles/threat-intelligence/2018-phishing-and-fraud-report--attacks-peak-during-the-holidays)\nemployees to recognize phishing attempts can reduce click-through rates on malicious emails,\nlinks, and attachments from 33% to 13%.\n\n**IOCs**\n\n\n-----\n\n### MD5\n\n C2\n\n\n571cdef12082946e34b77bd50fcb0d38\n06ec0af8411d864211baff8afb117f72\n2d2fa093dd4fb26a8d14f1906552d238\n842d7815923dffc1e1cf2ebbcd0fdf49\n2e4c99684fc0046934b984268b16c25b\n\nhxxp://w1.plenimusic[.]com/fakes/\n\n\nF5 Labs Newsletter\n\nOne email per week, with newsletter exclusives\nLatest security research insights\nCISO-level expert analysis\n\nF5 Labs Newsletter\n\n_[The information you provide will be treated in accordance with the F5 Privacy Notice.](https://www.f5.com/company/policies/privacy-policy)_\n\nGreat! You should receive your first email shortly.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-11 - Qbot Banking Trojan Still Up to Its Old Tricks.pdf"
    ],
    "report_names": [
        "2020-06-11 - Qbot Banking Trojan Still Up to Its Old Tricks.pdf"
    ],
    "threat_actors": [
        {
            "id": "3f6650a3-9f50-47c4-bd7a-008b63bde191",
            "created_at": "2022-10-25T16:07:23.949232Z",
            "updated_at": "2025-03-27T02:02:10.044899Z",
            "deleted_at": null,
            "main_name": "Operation Earth Kitsune",
            "aliases": [],
            "source_name": "ETDA:Operation Earth Kitsune",
            "tools": [
                "SLUB",
                "WhiskerSpy",
                "agfSpy",
                "dneSpy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535822,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1653787091,
    "ts_modification_date": 1653787091,
    "files": {
        "pdf": "https://archive.orkl.eu/1d996d90fd9392fa7edee4bbb041a44ab796f2d9.pdf",
        "text": "https://archive.orkl.eu/1d996d90fd9392fa7edee4bbb041a44ab796f2d9.txt",
        "img": "https://archive.orkl.eu/1d996d90fd9392fa7edee4bbb041a44ab796f2d9.jpg"
    }
}