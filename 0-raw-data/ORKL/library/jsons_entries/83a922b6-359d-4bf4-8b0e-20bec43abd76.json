{
    "id": "83a922b6-359d-4bf4-8b0e-20bec43abd76",
    "created_at": "2023-06-05T02:07:43.55921Z",
    "updated_at": "2025-03-27T02:11:51.153671Z",
    "deleted_at": null,
    "sha1_hash": "9aad3b3f04d17a0a5dcd4bcde174e2a7ad2e1680",
    "title": "2023-02-03 - AgentVX And Taurus",
    "authors": "",
    "file_creation_date": "2023-06-04T12:24:26Z",
    "file_modification_date": "2023-06-04T12:24:26Z",
    "file_size": 239845,
    "plain_text": "# AgentVX and Taurus\n\n**aon.com/cyber-solutions/aon_cyber_labs/agentvx-and-taurus/**\n\n[In an investigation occurring in 2021, Stroz Friedberg Incident Response Services team (Stroz Friedberg) encountered](https://www.aon.com/cyber-solutions/solutions/breach-response/)\n[a new payload associated with the Taurus loader. Typically, the information security community sees this loader](https://blog.minerva-labs.com/taurus-user-guided-infection)\n[associated with the Taurus Stealer malware. The Taurus Stealer has the ability to collect information from various web](https://www.zscaler.com/blogs/security-research/taurus-new-stealer-town)\nbrowsers, including passwords, cookies, autofill forms and history. However, in this instance, Stroz Friedberg identified\na new payload named “AgentVX”. This payload contains several functions outlined below. On September 19, 2022,th\nNSFOCUS Security Labs [released an article attributing AgentVX to the group “Evilnum.” Since 2021, Stroz Friedberg](https://nsfocusglobal.com/operation-darkcasino-in-depth-analysis-of-attacks-by-apt-group-evilnum-part-1/)\nhas not seen publicly available information relating this loader and payload. We are releasing this blog post to provide\nadditional threat intelligence on the AgentVX payload and release a script to assist with the automated decoding of the\nTaurus loader.\n\n## Taurus Loader\n\n[In this investigation, the Taurus loader matched publicly available analysis and Minerva Labs posted analysis on it](https://github.com/StrangerealIntel/CyberThreatIntel/blob/master/Additional%20Analysis/UnknownTA/2020-09-07/Analysis.md)\nearlier in 2021. The execution chain begins with a self-extracting archive. This archive drops the following files to\n“%AppData%\\BueedgFYHdzEt\\”:\n\nFile Description\n\n**Andate.xlm** Corrupt PE, used to build “Sapro.exe.com”\n\n**Calpestare.pptm** Unused\n\n**Poi.xltx** Obfuscated AutoIT loader is renamed to “x” and executed\n\n**Sapro.exe.com** AutoIT executable used for injection of payload\n\n**Seguente.mpg** Obfuscated batch file used to control the execution flow\n\n**Sta.xll** Encrypted “AgentVX” payload that is injected into “Sapro.exe.com”\n\nUpon execution, the malware executes “Seguente.mpg”, which conducts multiple kill-switch checks that are consistent\nwith the Taurus loader including:\n\nAttempts to connect to the non-existent domain “QYLBUtMSCcIS.QYLBUtMSCcIS”\nChecks for the existence of a file called “C:\\aaa_TouchMeNot_.txt”\n[Checks to see if the system name is “DESKTOP-QO5QU33”. The information security community has written](https://www.secplicity.org/2021/06/29/autoit-malware-to-obfuscate-or-not-to-obfuscate/)\n[about the name of this system multiple times.](https://www.zscaler.com/blogs/security-research/cybergate-rat-and-redline-stealer-delivered-ongoing-autoit-malware-campaigns)\n\n[When the checks pass, the malware continues execution to execute the obfuscated AutoIT script, “Poi.xlxt”. The AutoIT](https://www.autoitscript.com/site/autoit/)\nscript conducts additional checks like the above, including checking for the same system name of “DESKTOPQO5QU33”. If these checks pass, the malware injects a decrypted version of “Sta.xll” (AgentVX) into the newly created\n“Sapro.exe.com” process.\n\nThe Taurus AutoIT loader, “Poi.xlxt”, obfuscates its strings by using an algorithm which takes an integer and an offset,\nthen converts the integer and offset to its ASCII value. Below is an example of an encoded string that uses an offset\nvalue of 2:\n\nEncoded String Decoded String\n\n**“74>89>112>102>42>51>56>56>43”,2** HWnd(166)\n\n\n-----\n\nPerforming the decoding manually for a sample is a very lengthy and cumbersome process. Stroz Friedberg has\nreleased code to assist with automatic extraction and decoding of the Taurus AutoIT loader strings. Decoding of the\nstrings allows for quicker analysis of the Taurus loader, allowing an analyst to see de-obfuscated function calls to\nkernel32 and commands to be run by the script. The Python function described below will de-obfuscate AutoIT strings\nmanually:\n```\ndef decodeTaurus(string, integer, delim):\n\n  res = ''\n\n  tab = string.split(delim)\n\n  for character in tab:\n\n      res = res + chr(int(character)-int(integer))\n\n  return res\n\n```\nThe execution chain of the self-extracting archive to AgentVX is described in the below figure, followed by a short\ndescription of each step in the chain:\n\n_Figure 1: Execution chain of self-extracting archive to final AgentVX payload._\n\nA Execution of self-extracting archive\n\nB Start of execution of extracting routine\n\nC Execution of obfuscated batch script\n\nD Identification of start of encrypted payload\n\n\nE Execution of Taurus AutoIT loader which is renamed from “Poi.xlxt” to “x”\n\nF Execution of AgentVX via injection into “Sapro.exe.com”\n\n## AgentVX\n\nOnce the loading steps complete, the malware attempts to establish a connection to the Command and Control (C2)\nserver with the following details:\n\nType IOC\n\n**Domain** cdn.nvbcloud[.]com\n\n**URI** /timeout/voip.aspx\n\n\n**User-**\n**Agent**\n\n\nMozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/57.0.2987.133 Safari/537.36\n\n\nAgentVX begins by dynamically resolving functions. The malware will gather fingerprint information to send to the C2\nserver, including:\n\nJava Runtime Environment (JRE) version\n.NET version\nDirectory listing for “Program Files” and “Program Files (x86)” directories\nDrive letters\nOS version\n\n\n-----\n\nOnce the malware establishes C2 connectivity, it beacons out to the C2 every 6 seconds using the same details above.\nIt waits to receive a “task list” from the server. The task list contains one or multiple tasks to complete and options for\nthose tasks. The tasks within the task list can be any of the following:\n\nDownload and execute – this receives a payload from a server provided in the task options. The options allow for\nthe operator to save the payload to disk and execute it, or to inject it into another process memory using calls to:\nNtMapViewOfSection, VirtualProtectEx, WriteProccessMemory, and ResumeThread. If the operator chooses\nprocess injection, they can specify if they wish the payload to be injected into one of the following:\n\n– %SystemRoot%\\Microsoft.NET\\Framework\\v4.0.30319\\InstallUtil.exe\n\n– %SystemRoot%\\Syswow64\\nslookup.exe\n\nIf this task fails, the malware prints a debug string of “Download and execute failed.”\n\nExecute – this receives a base64 encoded payload from the task options. If the payload is an executable, it writes\nthe executable to disk and names it a random number from 6 to 12 and appends a “.exe” on the end. If the\npayload is a DLL, it allows the operator to choose one of the following to inject the payload into:\n\n– %SystemRoot%\\Microsoft.NET\\Framework\\v4.0.30319\\InstallUtil.exe\n\n– %SystemRoot%\\Syswow64\\nslookup.exe\n\n– %SystemRoot%\\System32\\nslookup.exe\n\nExecute and setup persistence – this allows the operator to provide three base64 encoded payloads, at least one\nof which must be an executable. The malware downloads and writes the executable to disk. The executable is\nnamed with a random number between 6 and 12 and is given the “.exe” extension (i.e., 6.exe). It will set this\nexecutable up with persistence by adding the following registry key:\n\n– HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\n<random_string> = <XXX_PATH_TO_EXECUTE_XYZ>\n\nThe other two payloads use hardcoded file names:\n\n– Dbghelp.dll\n\n– Pic.png\n\nCleanup Persistence – this option removes the registry run key persistence set by the “Execute and setup\npersistence” option.\nSetup new module – This function receives a base64 encoded DLL which the malware parses for the following\nexports:\n\n– AgentVXModuleInitializer\n\n– OnLoad\n\n– OnUnLoad\n\n– IsPersistent\n\n– GetModuleName\n\n– GetMinimumVersion\n\n– ReadCommunication\n\nThe malware checks its version and if the version is less than “1.6d.1”, it prints the debug string: “Bot version is too low\nto install.”\n\nGet running modules – this gets the list of running modules specific to the malware.\n\n\n-----\n\nExecute Function This allows the operator to specify another function of the malware to execute. In total, there\nare 156 functions that the malware can execute. Below are examples of the capabilities that four of these\nfunctions provide:\n\nManipulation of clipboard data\nCollection of browser data from Firefox or Chrome. Only one of the browsers is targeted at a time. Stroz\nFriedberg suspects this is a bug in the malware. During this process, the malware creates the folder:\n%AppData%\\XProfiles\nFile and directory upload and download\nCollection of screenshots\n\n## Threat Intelligence\n\nStroz Friedberg captured an image of the threat actor’s malware administration panel for AgentVX. The panel shows\nthe title of “AgentVX from Cerberus” in the top left corner. Additionally, Stroz Friedberg observed the following\nsimilarities during our analysis of the malware:\n\nThe BotID length and alphanumeric pattern matches what we observed in the threat actor’s control panel.\n\nThe malware shows the error message “Download and Execute failed” while the threat actor’s control panel\ndisplays a task named “Download and Execute”.\n\nThe malware can execute various procedures which it refers to as “tasks”. The threat actor’s control panel shows\nthat “tasks” for bots can be updated.\n\nIn the malware, one particular task can have options such as EXE, MEMORY and NATIVE associated with it while\nthe threat actor’s control panel shows that a task has options of EXE, MEMORY and DISK.\n\n## Indicators of Compromise\n\nStroz Friedberg recommends alerting and blacklisting (where possible) the following indicators to help prevent and\ndetect the AgentVX malware:\n\nType IOC Indicates Notes\n\nDomain cdn.nvbcloud[.]com Malware\nsuccessfully\ninitiated\ncommunications\nwith C2\n\nDomain QYLBUtMSCcIS.QYLBUtMSCcIS The malware\nattempted an\nanti-sandbox\ncheck\n\nURI /timeout/voip.aspx Malware\nsuccessfully\ninitiated\ncommunications\nwith C2\n\n\nUserAgent\n\n\nMozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like\nGecko) Chrome/57.0.2987.133 Safari/537.36\n\n\nMalware\nsuccessfully\ninitiated\ncommunications\nwith C2\n\n\nEnsure to\ncombine\nthis with\nother\nIOCs to\nmake this\na higher\nfidelity\nindicator\n\n\n-----\n\nFile Update.exe The initial\ndropped may\nexist on the\nsystem\n\nFile Andate.xlm The initial\ndropper has\nexecuted\n\nFile Calpestare.pptm The initial\ndropper has\nexecuted\n\nFile Poi.xltx The initial\ndropper has\nexecuted\n\nFile Sapro.exe.com The initial\ndropper has\nexecuted\n\nFile Seguente.mpg The initial\ndropper has\nexecuted\n\nFile Sta.xll The initial\ndropper has\nexecuted\n\nFolder %AppData%\\XProfiles The malware\nstarted\ncollecting\nbrowser\ninformation\n\nFolder %AppData%\\BueedgFYHdzEt\\ The initial\ndropper has\nexecuted\n\nFile %TEMP%\\\\[0-9]\\.png The malware\nhas loaded an\nadditional\nmodule\n\nFile Dbghelp.dll The malware\nhas loaded an\nadditional\nmodule\n\nFile Pic.png The malware\nhas loaded an\nadditional\nmodule\n\nSHA256 e437a05b660338b5bf068d8cd17c08a9dbf6499cac7f709ccfbf2dcce0fc759b Hash of\nupdate.exe\n\n\nEnsure to\ncombine\nthis with\nother\nIOCs to\nmake this\na higher\nfidelity\nindicator\n\nThis file\nis deleted\nonce it is\ninjected\ninto\nmemory\nand\ndecrypted\n\nRegex\nIOC\n\n\n-----\n\nSHA256 7477aa86458346df14d8f7315391a28190c01a2caa5f3891eef0ffdb86072116 Hash of\nAndate.xlm\n\nSHA256 0f34cbd62be0b3024e6a630763e5952e1445f74e96d23f862f7845067b1a76f5 Hash of\nCalpestare.pptm\n\nSHA256 9c3d15cb8795e1d7e47d702c6530b960919c2de7bfe191a37b3ac2a2f5259d55 Hash of Poi.xltx\n\nSHA256 05d8cf394190f3a707abfb25fb44d7da9d5f533d7d2063b23c00cc11253c8be7 Hash of\nSapro.exe.com\n\nSHA256 e0f90d7c68e0aeff8b2932b0e7e2b04c6d44728b383b34d810e3b127ff9f91e3 Hash of\nSeguente.mpg\n\nSHA256 918a5954dc12b16b85900fd72fee1d76cef624b903d78f3ecc6d57a2a3840bb1 Hash of Sta.xll\n\n_Author: Zachary Reichert_\n\nFebruary 3, 2023\n\n©Aon plc 2023\n\nWhile care has been taken in the preparation of this material and some of the information contained within it has been obtained from sources that Stroz\nFriedberg believes to be reliable, Stroz Friedberg does not warrant, represent or guarantee the accuracy, adequacy, completeness or fitness for any purpose\nof the article and accepts no liability for any loss incurred in any way whatsoever by any person or organization who may rely upon it. It is for informational\npurposes only. You should consult with your own professional advisors or IT specialists before implementing any recommendation or following the guidance\nprovided herein. Further, we endeavor to provide accurate and timely information, there can be no guarantee that such information is accurate as of the date\nit is received or that it will continue to be accurate in the future. Further, this article has been compiled using information available to us up to 02/03/2023.\n\n**About Cyber Solutions**\n\nCyber security services are offered by Stroz Friedberg Inc., its subsidiaries and affiliates. Stroz Friedberg is part of Aon’s Cyber Solutions which offers\nholistic cyber risk management, unsurpassed investigative skills, and proprietary technologies to help clients uncover and quantify cyber risks, protect critical\nassets, and recover from cyber incidents.\n\nCyber security services offered by Stroz Friedberg Inc. and its affiliates. Insurance products and services offered by Aon\nRisk Insurance Services West, Inc., Aon Risk Services Central, Inc., Aon Risk Services Northeast, Inc., Aon Risk\nServices Southwest, Inc., and Aon Risk Services, Inc. of Florida and their licensed affiliates. Aon UK Limited is\nauthorised and regulated by the Financial Conduct Authority in respect of insurance distribution services.\nFP.AGRC.238.JJ The following products or services are not regulated by the Financial Conduct Authority:\n\n- Cyber risk services provided by Aon UK Limited and its affiliates\n\n- Cyber security services provided by Stroz Friedberg Limited and its affiliates.\n\nCopyright 2021 Aon plc. All Rights Reserved.\nCyber security services offered by Stroz Friedberg Inc. and its affiliates. Insurance products and services offered by Aon\nRisk Insurance Services West, Inc., Aon Risk Services Central, Inc., Aon Risk Services Northeast, Inc., Aon Risk\nServices Southwest, Inc., and Aon Risk Services, Inc. of Florida and their licensed affiliates. Aon UK Limited is\nauthorised and regulated by the Financial Conduct Authority in respect of insurance distribution services.\nFP.AGRC.238.JJ The following products or services are not regulated by the Financial Conduct Authority:\n\n- Cyber risk services provided by Aon UK Limited and its affiliates\n\n- Cyber security services provided by Stroz Friedberg Limited and its affiliates.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-02-03 - AgentVX And Taurus.pdf"
    ],
    "report_names": [
        "2023-02-03 - AgentVX And Taurus.pdf"
    ],
    "threat_actors": [
        {
            "id": "059b16f8-d4e0-4399-9add-18101a2fd298",
            "created_at": "2022-10-25T15:50:23.29434Z",
            "updated_at": "2025-03-27T02:00:55.431907Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Evilnum"
            ],
            "source_name": "MITRE:Evilnum",
            "tools": [
                "More_eggs",
                "EVILNUM",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0bc63952-5795-4fc7-85c1-50a7f207f2f0",
            "created_at": "2023-11-14T02:00:07.095723Z",
            "updated_at": "2025-03-27T02:00:03.223759Z",
            "deleted_at": null,
            "main_name": "DarkCasino",
            "aliases": [],
            "source_name": "MISPGALAXY:DarkCasino",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "39ea99fb-1704-445d-b5cd-81e7c99d6012",
            "created_at": "2022-10-25T16:07:23.601894Z",
            "updated_at": "2025-03-27T02:02:09.882982Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Jointworm",
                "Operation Phantom in the [Command] Shell",
                "TA4563"
            ],
            "source_name": "ETDA:Evilnum",
            "tools": [
                "Bypass-UAC",
                "Cardinal RAT",
                "ChromeCookiesView",
                "EVILNUM",
                "Evilnum",
                "IronPython",
                "LaZagne",
                "MailPassView",
                "More_eggs",
                "ProduKey",
                "PyVil",
                "PyVil RAT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraPreter",
                "TerraStealer",
                "TerraTV"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a5bd315b-6220-441f-8ed1-39e194dcd0e3",
            "created_at": "2023-12-01T02:02:33.667762Z",
            "updated_at": "2025-03-27T02:02:09.84638Z",
            "deleted_at": null,
            "main_name": "DarkCasino",
            "aliases": [
                "Water Hydra"
            ],
            "source_name": "ETDA:DarkCasino",
            "tools": [
                "CloudEyE",
                "DarkMe",
                "GuLoader",
                "PikoloRAT",
                "vbdropper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1685930863,
    "ts_updated_at": 1743041511,
    "ts_creation_date": 1685881466,
    "ts_modification_date": 1685881466,
    "files": {
        "pdf": "https://archive.orkl.eu/9aad3b3f04d17a0a5dcd4bcde174e2a7ad2e1680.pdf",
        "text": "https://archive.orkl.eu/9aad3b3f04d17a0a5dcd4bcde174e2a7ad2e1680.txt",
        "img": "https://archive.orkl.eu/9aad3b3f04d17a0a5dcd4bcde174e2a7ad2e1680.jpg"
    }
}