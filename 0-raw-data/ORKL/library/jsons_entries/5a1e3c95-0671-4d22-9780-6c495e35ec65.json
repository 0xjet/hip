{
    "id": "5a1e3c95-0671-4d22-9780-6c495e35ec65",
    "created_at": "2022-10-25T16:48:19.278913Z",
    "updated_at": "2025-03-27T02:16:01.229625Z",
    "deleted_at": null,
    "sha1_hash": "3bdd11d0b197ebbc1542554c51f8796f7c3477a2",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-05-27T09:10:00Z",
    "file_modification_date": "2020-05-27T09:10:00Z",
    "file_size": 10954643,
    "plain_text": "# 標的型攻撃の実態と\n\n#### 第4版\n\n# 対策アプローチ\n\n##### 日本を狙うサイバーエスピオナージの動向 2019 年度下期\n\n###### 2020年5月1日\n\n Macnica Networks\n\n TeamT5\n\n\n-----\n\n本資料に記載されている情報は、マクニカネットワークス株式会社が信頼できると判断したソースを活用して記述されていますが、そ\n\nのソースをマクニカネットワークス株式会社が保証しているわけではありません。この資料に、著者の意見が含まれる場合があります\n\nが、その意見は変更されることがあります。この資料は、マクニカネットワークス株式会社と TeamT5 が著作権を有しています。こ\n\nの資料を、全体または一部を問わず、ハードコピー形式か、電子的か、またはそれ以外の方式かに関係なく、マクニカネットワークス\n\n株式会社または TeamT5 の事前の同意なしに複製または再配布することは禁止いたします。\n\n\n-----\n\n## 目 次\n\n###### はじめに ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 2\n\n 攻撃が観測された業種と傾向 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 3\n\n 攻撃のタイムラインと攻撃の概要 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 4\n\n 2019 年9 月（化学）・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 4\n\n 2019 年12 月（メディア）・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 5\n\n 2020 年1月（防衛関連）・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 5\n\n 2020 年2 月（IT サービス）・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 6\n\n 新しいTTPsやRAT など・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 7\n\n Tick ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 7\n\n BlackTech ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 18\n\n LODEINFO ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 23\n\n 攻撃グループについて ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 29\n\n Tick（Nian）・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 29\n\n BlackTech（Huapi）・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 30\n\n 攻撃グループごとのTTPs（戦術、技術、手順）・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 31\n\n TTPsより考察する脅威の検出と緩和策・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 33\n\n マルウェアの配送・侵入攻撃について ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 33\n\n インストールされるRAT、遠隔操作（C&C について）・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 33\n\n 侵入拡大・目的実行 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 34\n\n 検知のインディケータ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 35\n\n\n-----\n\n## はじめに\n\n本書は、日本の組織を標的とし活動を行う攻撃者グループに関してマクニカネットワークスと TeamT5 が行った調\n\n査をまとめたものです。\n\n2019 年度 (2019 年 4 月 ̃ 2020 年 3 月 ) に観測された日本の組織から機密情報 ( 個人情報、政策関連情報、製造デー\n\nタなど ) を窃取しようとする攻撃キャンペーンについて、注意喚起を目的として記載します。\n\n2019 年度下期に観測されたステルス性の高い遠隔操作マルウェア (RAT) を用いた事案を中心に、新しい攻撃手法や\n\nその脅威の検出について記載しています。最後に、本文中で紹介した攻撃キャンペーンで使われたインディケータを掲\n\n載しています。\n\n\n-----\n\n## 攻撃が観測された業種と傾向\n\n2019 年度の攻撃動向は、前年度の観測 [1] から継続して、Tick と BlackTech 攻撃グループの活動が活発であるものの、\n\n今年度は日本を標的としてきた攻撃グループ数は減少していると分析しています。上期にメディアを標的とした\n\nDarkHotel 攻撃グループの活動が増加したため、メディアを標的とした攻撃が全体的に多くなっています。下期に入っ\n\nて、IT サービス系の企業を標的とした BlackTech 攻撃グループの活動が観測されています。昨年度の観測では、\n\nBlackTech 攻撃グループの標的業種は製造業を中心としていましたが、今年度はリサーチ、クリティカルインフラ、\n\nIT サービスなど多岐に渡っており、製造業の技術情報だけでなく、個人情報、ビジネスインテリジェンスをも標的にし\n\nている可能性があるのではないかと分析しています。また、大手電気系企業 2 社は、2017 年、2018 年頃に標的攻\n\n撃を受けていた事を公表しています [234]。報道によると、大手電気系企業の 1 社は、Tick と BlackTech 攻撃グループ\n\nによって侵害をうけ 、自社の情報に加え、防衛省等の複数の官公庁、電力、通信、鉄道、自動車などの様々な情報が不\n\n正アクセスされたといいます。また、報道によると、この大手電気系企業は中国の拠点が最初に侵害され、アンチウイ\n\nルス製品のサーバの脆弱性が攻撃され、製品の更新機能の悪用によって感染が拡大し、本社へ侵入されたとされます [5]。\n\nアンチウイルス製品の管理サーバの脆弱性で、ファイルの差し替えや任意のコード実行を許可し、感染拡大につながる\n\nような脆弱性として、CVE-2019-9489、CVE-2019-18187 があげられ、警戒情報があがっています [67]。昨年、\n\n一昨年と弊社報告の統計には、これらインシデントはカウントしていないため、標的型攻撃については発見や検出が困\n\n難であり、侵入を検出するまでにも時間がかかる厄介な問題である事が再認識されています。本書の統計は氷山の一角\n\nととらえ、ここで記載する攻撃手法も参考にして頂き、注意警戒を怠らないようにして頂ければと思います。\n\n\nIT サービス\n8%\n\nリサーチ 通信製造\n9% 9%\n\n\nメディア\n25%\n\n\n防 衛\n8%\n\nクリティカルインフラ\n8%\n\n\n官公庁\n8%\n\n半導体\n8%\n\n\n化 学\n17%\n\n\n図 1. 標的組織のパイチャート (2019 年度 )\n\n\n1 https://www.macnica.net/mpressioncss/feature_03.html/\n\n2 https://www.asahi.com/articles/ASN1M6VDSN1MULFA009.html\n\n3 https://www.mitsubishielectric.co.jp/news/2020/0212-b.pdf\n\n4 https://jpn.nec.com/press/202001/20200131_01.html\n\n\n5 https://www.asahi.com/articles/ASN1P6TGLN1PUTIL02V.html\n\n6 https://www.jpcert.or.jp/at/2019/at190034.html\n\n7 https://www.jpcert.or.jp/at/2019/at190041.html\n\n\n-----\n\n## 攻撃のタイムラインと攻撃の概要\n\n以下は、4 月から 3 月までの月ごとの攻撃グループの活動を表にしています。9 月以降、Tick と BlackTech 攻撃グルー\n\nプの新規の活動が低下していると分析しています。一方、足場を作った組織への攻撃活動は継続しており、後半に入っ\n\nて 9 月に化学系組織で Tick グループの活動、2 月に IT サービス系企業で BlackTech 攻撃グループの活動が検出され\n\nています。また、12 月と 1 月に攻撃グループへの帰属はまだできていないものの、APT10 攻撃グループが過去の攻\n\n撃で利用した ANEL マルウェア [8] に似たつくりの RAT (LODEINFO) を使った攻撃が観測されています。\n\n\n19/04 19/05 19/06 19/07 19/08 19/09 19/10 19/11 19/12 20/1 20/02 20/03\n\n\nDarkHotel\n\nBlackTech\n\nTick\n\nN/A\n(LODEINFO)\n\n|メディア|Col2|Col3|メディア 防衛|Col5|Col6|Col7|Col8|Col9|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n||リサーチ||半導体|クリティカル インフラ||||||ITリサーチ|\n||通信||化学||化学||||||\n\n\nメディア\n\n\n防衛\n\n\n表 1. 2019 年タイムライン\n\n##### 2019 年 9 月 ( 化学 )\n\nTick グループによる、国内化学系組織の中国拠点を狙った攻撃が観測されました [9]。攻撃に使われたマルウェアには、\n\npdb (C:\\Users\\jack\\Desktop\\test\\version\\Release\\version.pdb) が残されており、この文字列と機能から、\n\n“version RAT”と命名しました。version RAT は、Windows10 の環境でのみ動作するよう作りこまれており、遠\n\n隔操作でリモートシェルの実行、ファイルのアップロードとダウンロードの 3 つの機能を有していました。特定の OS\n\n環境でのみ動作するつくりから、ある程度 Tick グループによる標的環境の把握を行った後に使われた可能性があると\n\n分析しています。\n\n8 https://jsac.jpcert.or.jp/archive/2019/pdf/JSAC2019_6_tamada_jp.pdf\n\n9 https://www.macnica.net/mpressioncss/feature_05.html/\n\n\n-----\n\n##### 2019 年 12 月 ( メディア )\n\n2019 年 12 月末にメディア企業を中心に、年賀の挨拶を装ったスピアフィッシュメールが配送されました。添付さ\n\nれたファイルは、マクロのついた WORD のファイルで、マクロを有効にしてしまう事で、マルウェアがディスクに書\n\nき込まれ、実行されます。このマルウェアは、DLL ファイルで実行されると、別の svchost.exe プロセスにインジェ\n\nクションして動作します。Unix コマンドに似た命令セットを持っており、LODEINFO マルウェアと呼ばれています [10]。\n\n図 2. LODEINFO マルウェアの配送に使われたマクロつき WORD ファイル\n\n##### 2020 年 1 月 ( 防衛関連 )\n\n2020 年 1 月に入ってからも、LODEINFO マルウェアをドロップする Office マクロファイルを添付したスピアフィッ\n\nシュメールが防衛関連組織を標的として観測されました。\n\n10 https://blogs.jpcert.or.jp/ja/2020/02/LODEINFO.html\n\n\n-----\n\n##### 2020 年 2 月 (IT サービス )\n\nIT サービス系組織にて、BlackTech 攻撃グループによる Linux OS を動作環境とした 32bit 遠隔操作マルウェアが\n\n観測されました。このマルウェアは、BlackTech 攻撃グループによる TsCookie マルウェアとの類似性が指摘されて\n\nいます [11]。この攻撃ではその他複数の攻撃ツールが観測されており、BlackTech 攻撃グループの攻撃ツールとして、\n\n本書で紹介します。\n\n図 3. BlackTech 攻撃グループの 32bit Linux マルウェア\n\n11 https://blogs.jpcert.or.jp/ja/2020/02/elf_tscookie.html\n\n\n-----\n\n## 新しい TTPs や RAT など\n\nここでは、先に引用させて頂いた公開されている調査報告ではまだ触れられていない観測や分析を中心に、少し詳し\n\nく紹介します。\n\n##### Tick\n\n**Evolving Downloader**\n\n2019 年 9 月に国内企業の中国拠点で攻撃を観測しています。その手法 ( 使われたマルウェアの機能、コードレベル\n\nの特徴、正規サイトを C&C サーバとして悪用 ) と標的業種から Tick グループによる攻撃と分析しています。使われた\n\nマルウェアには、従来の Tick が使うダウンローダから見られているアンチウイルス製品の停止や暗号化の処理が実装\n\nされており、Tick はダウンローダの改良を継続的に行なっていると見ています。特に大きな特徴はリモートシェル機能\n\nが実装された事です。これまではダウンローダが自動的に収集した感染機器の情報が、通信先のサーバ側の条件をクリ\n\nアした時に次のペイロードを送り込む事でターゲットの選別が行われていましたが、インタラクティブに情報収集でき\n\nる機能をダウンローダに追加したのを観測したのは、この時が初めてです。これは、より多くの情報を収集しターゲッ\n\nト選別の精度を高めるためと考えています。このマルウェアを、残されていたデバッグ情報ファイル (pdb) 名と機能か\n\nら”version RAT”と呼称しています。\n\nMay-2018 Aug-2018 May-2019 Aug-2019 Sep-2019\nABKDLL ABK Avenger Ravirra version\n\n\nCPU CPU CPU CPU\n\nAnti-Virus Anti-Virus Anti-Virus\n\nVolume\nOS version\nInformation\n\n\nRemote\nShell\n\n\nHostname\n\n\nNIC MAC\nAddress\n\n\n図 4. ダウンローダが持つ情報収集機能の進化\n\n\n-----\n\n本攻撃では複数の機器で version RAT の感染が確認されました。特徴の１つは、各 RAT の通信先が異なっていた事です。\n\nこれは 1 台の機器で RAT が検出できたとしても、得られた通信先の情報だけでは他の感染機器を特定できないように\n\nして可能な限り長期間潜伏できるようにする為と考えています。各 RAT に残されている pdb のパスが異なっていた事\n\nからソースコード一式を攻撃者グループの複数の開発者間で共有し、オペレーション毎に C&C 等の設定をチューニン\n\nグし、使い分けていると見られます。１つの検体の pdb パスには、ハングル文字が含まれていました。また、Tick は\n\n韓国の組織も標的にしていることから開発者の中にハングル語に精通している人物を採用している可能性がうかがえま\n\nす。\n\npdb path C:\\Users\\jack\\Desktop\\test\\version\\Release\\version.pdb\n\nversion RAT1 SHA256 ec052815b350fc5b5a3873add2b1e14e2c153cd78a4f3cc16d52075db3f47f49\n\nC&C http://www.<redacted>.com/banner/acom/list.php\n\npdb path C:\\Users\\jack\\Desktop\\test\\version\\Release\\version.pdb\n\nversion RAT2 SHA256 e3624fdb484ae20c47f2e54bda914a12776c8e65b0fe0c6f23640452d37c1545\n\nC&C http://www.<redacted>.co.jp/old/keisokuki/\n\npdb path C:\\Users\\허쟉\\Documents\\Visual Studio 2010\\Projects\\새로\\version\\Release\\version.pdb\n\nversion RAT3 SHA256 d2d5b3e48bb8ac413fffa230bf913283a7c1009981dec20e610f1020ee720fa6\n\nC&C http://www.<redacted>.com/data/\n\n表 2. 攻撃で使われた version RAT\n\nこのマルウェアは DLL ファイル形式で、Windows にインストールされている version.dll と同じファイル名でした。\n\nversion.dll をロードする Fortigate 社の正規ファイルがあるフォルダにその DLL ファイルを設置する事で\n\nSystem32 フォルダにある正規の version.dll ではなくマルウェアがロードされるようになっていました。(DLL\n\nSearch Order Hijacking)\n\nこの手法を使う事で感染機器が再起動した後も自動起動・常駐をするようになっています。\n\nFortiTray.exe version.dll(verion RAT)\n\n###### c:￥Windows￥System32\n\nversion.dll\n\n図 5. DLL Search Order Hijacking\n\n\n-----\n\nDLL Search Order Hijacking 自体は古くから使われている手法ですが、現在も多くの攻撃者に使われている状況から、\n\nこの手法がアンチウイルス製品やホワイトリスト対策等のいくつかのセキュリティを回避するのに、未だに有効である\n\n事を示していると言えます。\n\nまた、感染機器の OS を判別するのに特徴的な方法を使っています。\n\nマルウェアは、System32 フォルダにある正規の version.dll をロードし、特定の API がロードできるかを確認して\n\nいきます。GetFileVersionInfoExA 関数は、Windows10 の version.dll でエクスポートされており、それ以外の OS\n\nではロードをする事ができません。これにより Windows10 以外の OS では動かないようにプロテクトされています。\n\n図 6. 稼働環境の OS が Windows10 環境であるかの確認をする処理\n\n\n-----\n\n**version RAT 通信の特徴**\n\n正規サイトを悪用して構築された C＆C サーバと HTTP リクエストで通信を行います。ユーザエージェントは、マル\n\nウェアに埋め込まれている固定文字列を使いますが、感染機器にある mshtml.dll のバージョン情報から複数の文字列\n\nのいずれかを使うようになっています（表 3） 。\n\nmshtml.dll バージョン ユーザエージェント文字列\n\n8 Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0)\n\n9 Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)\n\n10 Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)\n\n11 Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\n\n表 3. 固定ユーザエージェント文字列 (version RAT)\n\n通信データは、AES CBC モード ( 鍵と初期化ベクトル (IV) は、2 つの固定文字列 '!@#$%^$$#$%^%$#@' と\n\n'sdjfiejkflmvjfkd' とランダム値を使い生成 ) と base64 を組み合わせて暗号化されています。\n\nアクセスする通信先は、いずれも日本にある侵害された正規サイトでした。通信を検知するためのシグネチャ作成とい\n\nう観点では、検知条件に成り得るマルウェアに埋め込まれている固定 URL パラメータも存在しますが、それは頻繁に\n\n変更される為、マルウェアが使われた直近ではシグネチャによる通信検知は難しいと考えています。その為、セキュリティ\n\nベンダー等から Tick が使うダウンローダの通信先 URL が公開された際には、後追いになりますが固定の URL パター\n\nン部を条件とした通信ログの調査をされる事を推奨します。\n\nURL パターン例 ( 青太字が固定 )\n\n**http://www.<redacted>.com/banner/acom/list.php? < 端末情報から生成する** 5 文字 >=usq\n\nversion RAT SHA256: ec052815b350fc5b5a3873add2b1e14e2c153cd78a4f3cc16d52075db3f47f49\n\n**http://www.<redacted>.com/img/home/index.php?< 端末情報から生成する** 5 文字 >=google\n\ndown_new SHA256: 80ffaea12a5ffb502d6ce110e251024e7ac517025bf95daa49e6ea6ddd0c7d5b\n\n**観測された内部活動**\n\nversion RAT のリモートシェルを使い ping コマンドで対象機器への疎通を確認した後に net use コマンドで横移動\n\nを試みていました。\n\n\n_net group “domain admins” /domain_\n\n_ping -n 1 <hostname1>_\n\n_net use \\\\<hostname1> [redacted] /u:<hostname1>\\administrator_\n\n\n-----\n\n**C＆C**\n\n侵害された正規サイトには、PHP ファイルが設置されていました。その PHP ファイルのコードは 200 行程度で難\n\n読化もされておらず感染機器や攻撃者からのアクセスの際に設定される URL パラメータに応じて処理を分岐するよう\n\nになっています。この PHP コードには、ユーザインタフェース処理や暗号化されたデータの復号処理がなく、攻撃者\n\nと感染機器間の暗号データを中継する機能のみを有しています。このことから攻撃者が操作をするためのユーザインタ\n\nフェース部は、攻撃者の操作端末もしくは別のサーバに実装されていたと考えています。攻撃者は侵害したサイトに海\n\n外の VPS サービス上に立てたサーバからアクセスをしていました。PHP コードをこのようにシンプルにした理由は、\n\nWebshell のようにコードを難読化すると特徴的なコードが多くなりアンチウイルス製品に検知される可能性が高くな\n\nると攻撃者が考えたためではないかと見ています。攻撃者と C&C サーバとの間でやり取りされる通信データも RAT と\n\nC&C サーバ間の通信と同じ方式 (AES + base64) で行われています。鍵と初期化ベクトル (IV) が通信データに含ま\n\nれているため（図 7）（図 8）、URL パラメータや POST データがログに残っている場合は復号をする事が可能です。\n\nIV とデータは、2 つに分割されて通信データに設定されます。 RAT への送信データの最後には、データの正当性を確\n\n認するための識別子としてエクスクラメーション・マーク (!) が付与されます。\n\n\n16bytes\n\n\n16bytes\n\n\n###### Key IV Data\n\n AES\n\n base64 base64 base64\n\n Data1 IV1 Key IV2 Data2\n\n3bytes 5bytes 24bytes 19bytes Data Len - 3bytes\n\n図 7. 通信データフォーマット\n\n\n###### +‘!’\n\n\n-----\n\nファイルを送信する場合も、同様に AES と base64 を使用していますが手順とフォーマットを少し変更しています。\n\n\n16bytes\n\n\n16bytes\n\n\n10bytes\n\n\n###### Key IV Data\n\n base64\n\n AES\n\n base64 base64 base64\n\n IV1 Key IV2 Data2\n\n15bytes 24bytes 9bytes Data Len - 10 bytes\n\n\n###### Data Format:<file name>xxxxxxxx<Data> e.g. aaa.exexxxxxxxxMZ...\n\n図 8. ファイルアップロードデータフォーマット\n\nURL パラメータ 機 能\n\nfr=AS4Q&name=< 暗号化されたコマンド - 命令コマンド\n\n< 不定 >=dd&na=< ファイル名 - ファイルの内容をクリア｠\n\n< 不定 >=de&ui=< ファイル名 - ファイル削除\n\n<target id>=usq ビーコン GET /index.php?abcde=usq\n\n<target id>=kjg コマンド結果アップロード POST /index.php?abcde=kjg\n\n<target id>=dvg ファイルアップロード POST /index.php?abcde=dvg\n\n表 4. version RAT C&C PHP URL パラメータ一覧\n\n攻撃者が発行する命令コマンドは、以下のフォーマットとなっています。\n\nMMddHHmmss<Command ID><Target ID>[Sub Command ID][Parameter]\n\n- Sub Command ID と Parameter は省略可能\n\n- Target ID が AAAAA: ターゲット機器の指定なし\n\n\n-----\n\nコマンド 例 1) 0330170142SAAAAA\n\nインストールされているアプリケーション一覧を表示\n\nコマンド 例 2) 0330170142DAAAAA0BLc:¥intel¥logs\n\nファイルをダウンロード、かつサイズを肥大化させて c:¥intel¥logs に保存\n\nversion RAT は、ビーコンのレスポンスデータを復号して Command ID、Sub Command ID、Parameter を抽出、\n\n読み取り処理を行います。\n\nCommand ID Command Sub Command ID（組み合わせ可能） Command\n\nC リモートシェル\n\nC＆C からファイルダウンロード R ダウンロード後、実行\n\nD （ダウンロードするファイル名は、 B ファイルサイズ肥大化 ( 約 50MB～100MB)\n\nマルウエァに埋め込まれており、\n\n固定。logo.jpg 等） L ファイル保存場所指定\n\nS インストールアプリケーション一覧取得\n\nG インターバルスリープ秒変更\n\nU ファイルアップロード\n\nM Sleep\n\n表 5. version RAT コマンド一覧\n\n図 9. 遠隔操作の流れ ( インストールされているアプリケーションを表示 )\n\n\n-----\n\n図 10. 正規サイトに設置された php コード\n\n**down_new**\n\n2019 年 11 月にオープンマルウェアリポジトリに Tick のダウンローダと見られる 2 つのファイルがアップロード\n\nされたのを観測しました。\n\n暗号方式は、version RAT と同じ AES+base64 で鍵の作成に使う２つの文字列も同一のものでした。これらのマル\n\nウェアは DLL ではなく EXE 形式のファイルで、実行した際に永続化方法として指定場所に自身をコピーしログオンス\n\nクリプトのレジストリを追加します。これによりユーザが感染機器にログインした際に自動起動されるようになります。\n\nまた、これらの検体にも Tick が使う検体に残されている特徴的な pdb ファイルのパスが残されていました。\n\n\n-----\n\nSHA256: 80ffaea12a5ffb502d6ce110e251024e7ac517025bf95daa49e6ea6ddd0c7d5b\n\nPDB: C:\\Users\\jack\\Desktop\\test\\ec_new\\down_new\\Release\\down_new.pdb\n\n追加レジストリ値 : HKEY_CURRENT_USER\\Environment\\UserInitMprLogonScript = \"C:\\Users\\＜ユーザ名\n\n＞\\AppData\\Roaming\\Microsoft\\winlogon.exe\"\n\nSHA256: 2411d1810ac1a146a366b109e4c55afe9ef2a297afd04d38bc71589ce8d9aee3\n\nPDB: C:\\Users\\jack\\Desktop\\test\\ec_new\\down_new\\Release\\down_new.pdb\n\n追加レジストリ値 : HKEY_CURRENT_USER\\Environment\\UserInitMprLogonScript = \"C:\\Users\\＜ユーザ名\n\n＞\\AppData\\Local\\Microsoft\\Internet Explorer\\wuauct.exe\"\n\n大きな違いは、この 2 つの down_new 検体には、リモートシェル機能が実装されていない事です。version RAT と比\n\n較すると機能が少ない点や検体コンパイル日時、パッシブ DNS の情報からこれら 2 つの down_new は、version\n\nRAT 開発のベースであり、2019 年 7 月以前に使われたと考えています。\n\n通信に設定されるユーザエージェントは、version RAT と同様に固定ですが OS の CPU 情報 (32bit/64bit) に応じ\n\nて変更しています。\n\nOS ユーザエージェント文字列\n\n32bit Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36\n\n64bit Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36\n\n表 6. 固定ユーザエージェント文字列 (down_new)\n\ndown_new version RAT\n\nファイルタイプ EXE DLL\n\nアンチウイルス製品停止機能 あり あり\n\n永続化方法 ログオンスクリプト DLL Search Order Hijacking( 正規ファイルによりロード )\n\n動作環境 Windows 32bit/64bit Windows 10\n\n通信の暗号化 AES + base64 AES + base64\n\n主機能 新たなファイルをダウンロード 遠隔操作 ( 簡易 )\n\n表 7. down_new と version RAT の機能比較\n\n\n-----\n\n**ShadowPAD**\n\n2019 年後半、Tick 攻撃グループによるインシデントを調査する過程で、興味深い痕跡を発見しました。この事案では、\n\nABK ダウンローダ [12] が観測されましたが、このダウンローダによって ShadowPAD RAT または POISONPLUG と\n\n呼ばれる RAT がダウンロードされ、攻撃に利用された事を観測しました。ShadowPAD は、中国の複数の攻撃グルー\n\nプによって利用されますが、Tick グループでの観測は初めてです。この一方で、ABK ダウンローダは、Tick グループ\n\nだけで観測されています。\n\nABK によりダウンロードされた検体は、正規の実行ファイル EXE と ShadowPAD RAT を内部に含む mscoree.dll\n\nファイルでした。DLL には、ShadowPAD をロードするローダー箇所と、5 つの関数モジュール、シェルコードが含まれ、\n\nすべて難読化されていました。最初にシェルコードがローダー箇所をメモリにインジェクションし、ローダーがその他\n\n箇所をメモリにインジェクションします。シェルコードは、複雑に難読化されていただけでなく、WindowsAPI はハッ\n\nシュ値または暗号化された文字列から動的にロードされるような、分析のきっかけとなる文字列がまったく見当たらな\n\nい、大変複雑なものでした。\n\n図 11. 難読化されたシェルコード ( 左 )、難読化を解除したシェルコード ( 右 )\n\n‘E8’バイトがデバッガに CALL 命令の解釈をさせるが、実際には異なるコードになる\n\n12 https://jsac.jpcert.or.jp/archive/2020/pdf/JSAC2020_8_koike-nakajima_jp.pdf\n\n\n-----\n\n5 つの関数モジュールは、それぞれ、メインモジュール、レジストリの C2 値を読み取るモジュール、C&C と通信す\n\nる 2 つのモジュール、これらのモジュールに機能を提供するモジュールから成り立っていました。このようなモジュー\n\nルで設計されているため、攻撃者はモジュールを追加し、変更する事で機能を変更する事ができます。メインモジュー\n\nルは、自身が自動起動するようにレジストリ設定を行い、その他のモジュールとともに正規の svchost.exe プロセス\n\nにインジェクションして動作します。そして、svchost.exe プロセスにインジェクションされると、他のモジュールを\n\n開始し、C&C と通信します。\n\n図 12. ShadowPAD (POISONPLUG) のモジュール動作イメージ\n\nこのインシデントの C&C は、114.118.21[.]146 で中国の北京にあります。443 ポートと通信しますが、POST\n\n通信のコンテンツは暗号化されていません。C&C モジュールの通信パターンは、異なる ShadowPAD では異なる実装\n\nがされていると思われます。また、C&C モジュールは 2 つありますが、1 つは C&C と通信する役割で、もう 1 つは\n\nC&C のドメインや IP アドレス、そして通信方法の設定です。\n\n\n-----\n\n##### BlackTech\n\n2020 年 1 月末から 2 月にかけて、BlackTech 攻撃グループが利用したと思われる TsCookie マルウェアの\n\nLinux 版と一連の攻撃ツールが発見されています。攻撃ツールには、TsCookie マルウェア Linux 版の他に、ウェブシェ\n\nル、ポートフォワードツール、GoogleAPI トークンのアップデータ、Bifrose マルウェアの Linux 版などがありました。\n\n**TsCookie Linux**\n\nTsCookie の Linux 版は、ツールの機能や特徴は公開情報 [13] と一致していましたが、C&C サーバが異なるものでした ( 図\n\n13)。\n\nsha256:62840976ab695211447b47ea4555ae665c7039c74a3f2167d660a85283eae86b\n\nfilename:acud\n\n図 13. TsCookie の設定コード\n\n13 https://blogs.jpcert.or.jp/ja/2020/02/elf_tscookie.html\n\n\n-----\n\n**Bifrose Linux**\n\nこの標的組織からは、TsCookie と同じような RAT に分類される Bifrose マルウェアの Linux バージョン\n\n(sha256: 3cad20318f36b020cf4d6b44320eb5a6dae0a78339a0fdc3a1fe5e280a8507f1、\n\nfilename: sshd) が確認されています。Bifrose マルウェアの Linux バージョンは、公開情報 [14] より 2014 年頃から\n\nBlackTech 攻撃グループにより利用されていたと思われますが、当時から大きな変更がないバージョンで、C&C サー\n\nバなどの設定情報は暗号化されず検体に含まれていました（図 14）。\n\n図 14. Linux 版 Bifrose の通信先とポート番号\n\nC&C サーバ：107.191.61[.]247:443 へ通信する際の最初のビーコンパケットもフォーマットは、下記のようになり、\n\nこちらも引用した公開情報と同様になっていました。\n\nフォーマット :<vitcim IP>¦unix¦<hostname>¦<username>¦5.0.0.0¦0¦1¦1¦0¦<pid>¦0¦0¦0¦0¦None¦¦¦¦¦\n\n例 :172.16.108.141¦unix¦web1.localdomain¦NULL¦5.0.0.0¦0¦1¦1¦0¦4789¦0¦0¦0¦0¦None¦¦¦¦¦\n\n通信データは、\"\\xA3\\x78\\x26\\x35\\x57\\x32\\x2D\\x60\\xB4\\x3C\\x2A\\x5E\\x33\\x34\\x72\\x00\" の鍵を使っ\n\nて、RC4 アルゴリズムで暗号される特徴があります。\n\n図 15. 通信データフォーマット\n\n14 https://blogs.jpcert.or.jp/ja/2020/02/elf_tscookie.html\n\n\n-----\n\n今回発見された Bifrose の Linux には、つぎのように C&C サーバからの命令を受けるための豊富な機能が実装されて\n\nいます ( 表 8)。\n\n命令番号 機 能\n\n0x89 mkdir\n\n0xF6 Run Remote Shell\n\n0xF7 exit\n\n0xF8 Open Remote Shell\n\n0x8B Delete File\n\n0x8F Rename File\n\n0x84 Open File\n\n0x85 Write File\n\n0x86 Read File\n\n0x87 Close File\n\n0x82 Send\n\n0x83 List Directory\n\n表 8. Bifrose Linux の機能\n\n**Perl WebShell**\n\n続いて、Linux 版の RAT の他に WebShell が発見されています。発見されたウェブシェルファイル (sha256:\n\n35f8dec25f11b8a1340d4a1e4c0bc55ed8d8560425d0d50ad6c002bc74f0fa6a) は、CGI-Perl で動\n\n作するファイルで、GitHub で公開されている WebShell ファイル [15] を若干改良したものでした。WebShell にアクセ\n\nスするパスワードは“www.org”で、リモートシェルの実行とファイルのアップロード、ダウンロードがサポートされ\n\nていました。\n\n図 16. WebShell へのアクセス画面\n\n15 https://github.com/backlion/webshell/blob/master/pl/Silic%20Group_cgi.pl\n\n\n-----\n\n**Google API Token Updater**\n\nこれまでと同様に Linux で動作する Google API Token のアップデータが検出されました。このファイルは、sem\n\nのファイル名で、Golang でコンパイルされています。パッカーの UPX で圧縮されていますが、Golang は API を静\n\n的リンクするためにファイルサイズが大きくなるため、通常のパッカーによる検知回避の目的ではなくサイズを小さく\n\nする目的で UPX パッカーが利用された可能性があると思われます。このファイルは、Google API のアクセスに必要\n\nなトークンを更新し、保存します。\n\n( 使用例 ) $sem < トークンファイルのパス - < 更新したトークンファイルのパス \nGoogle API のクライアント ID とシークレットキーは以下のものが使われています。\n\nclient_id=637778819557-clle39i9dlnpkq3i2kobmtl8dcnc4iv0.apps.googleusercontent.com&\n\nclient_secret=D2wmg1foukw6LIT7o2Ieg3rq&\n\ngrant_type=refresh_token &\n\nrefresh_token=1%2FFE88fgt3ZzLKx85a5cWeHa1wQE8AXcB4SuhRhuy8rE@\n\n図 17. Google API Token の更新ツール\n\n\n-----\n\nBlackTech 攻撃グループはデータを窃取する際に Google API を使ってクラウド上の Google ドライブにデータを保\n\n存する事が報告されています [16]。今回発見された Google API Token の更新ツールが一連の BlackTech 攻撃グルー\n\nプによるものである場合、おそらく Google ドライブにデータを保管する別のツールがあり、Google API Token を\n\n更新するためにツールとして利用されたものと考えています。\n\nこの攻撃で検出された TsCookie の通信先 fortigatecloud[.]com は、過去に BlackTech 攻撃グループが攻撃で利用\n\nしたネットワークインフラとの関連が見られます（図 18）。\n\n図 18. BlackTech インフラ関連\n\nこのように、BlackTech 攻撃グループは、過去の攻撃インフラを再利用する傾向があり、BlackTech 攻撃グループの\n\nインディケータをネットワークセキュリティ機器のブラックリストとして活用する事で、攻撃の検出に役立てる事がで\n\nきます。また、Linux サーバのネットワークにも侵入し、独自の TsCookie Linux 版を利用する事から、ホスト型のセ\n\nキュリティ対策は Windows だけでなく Linux サーバにも適用し、Linux サーバの出口ネットワークの通信も監査し忘\n\nれないようご注意ください。\n\n16 https://hitcon.org/2015/CMT/download/day2-f-r0.pdf\n\n\n-----\n\n##### LODEINFO\n\n2019 年 12 月下旬に、国内複数企業に対して標的型攻撃メールが配送されました。添付されていた doc ファイル\n\nのマクロを有効にすると LODEINFO と呼ばれているマルウェアに感染します。\n\n図 19. LODEINFO を使った攻撃の流れ\n\ndoc ファイルに含まれるマクロは、主に base64 を使い難読化しています。難読化を解くと別のマクロに含まれた\n\nbase64 エンコードされたデータを取得し、デコードしたデータを .txt の拡張子で保存します。.txt 拡張子で保存しま\n\nすが、形式は DLL で rundll32.exe を使い起動されます。機器再起動後も自動起動されるように Run レジストリキー\n\nに値を追加します。\n\nLODEINFO は複数存在していますが、確認したレジストリに追加される値は以下の 2 つです。\n\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurentVersion\\Run\\\"BIG_POOH\" = cmd /c cd\n\n%ProgramData%&start rundll32.exe Windows.SecurityMitigationsBroker.txt main\n\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\\"MsiWrapper\" = cmd /c cd\n\n%ProgramData%&start rundll32.exe euwPvlGQN.Ikbn main\n\n\n-----\n\n**LODEINFO の特徴**\n\nドロップされる DLL(LODEINFO) には、pdb ファイルのパスが残されていました。\n\nE:\\Production\\Tool-Developing\\png_info\\Release\\png_info.pdb\n\nLODEINFO は、GitHub で公開されている PNG ファイルのエンコーダ / デコーダ”LodePNG”のソースコード [17] をベー\n\nスに開発されています。このように正規のソースコードに悪意のあるコードを入れ込み分析を逃れようとするテクニッ\n\nクは、中国語圏を拠点とする攻撃者グループでよく使われています。\n\nLODEINFO は、svchost.exe に PE 形式の RAT コードをインジェクションするタイプと、ロードした rundll32.exe\n\nのメモリ上に RAT コードを展開するタイプの 2 つが存在します。\n\nコードインジェクションするタイプでは、攻撃者のコードは main 関数の最後に１つの関数として追加されています。\n\n図 20. インジェクションタイプ : ペイロードの復号とコードインジェクション処理部\n\n17 https://github.com/lvandeve/lodepng/blob/master/examples/example_png_info.cpp\n\n\n-----\n\n関数の中では、ペイロードの復号と正規の svchost.exe を起動し PE 形式のコードをインジェクションします。\n\nペイロードはデータセクションに含まれており、128bit 値で XOR して復号します。\n\nrundll32.exe メモリ上にコードを展開するタイプでは、main 関数内に直接復号する処理と復号したコードをメモリ上\n\nに展開して実行する処理が実装されています。\n\n図 21. メモリ展開タイプ : ペイロードの復号と復号コードの呼び出し\n\n\n-----\n\n**LODEINFO RAT**\n\n最終的に svchost.exe または、rundll32.exe のメモリ上で動くコードが RAT 機能を有しています。\n\n定期的に HTTP POST 通信を C＆C サーバに行い、レスポンスに含まれている命令コードに応じて処理を行います。\n\n命令コードは、”send”、”recv”、”kill”等 UNIX 系 OS 環境を示唆するものが使われています。\n\n攻撃者が RAT を休止状態にする時には、命令コマンド文字列の条件にない”stay calm!”というコードを送信してい\n\nました。ユーザエージェントは、固定の文字列 “Mozilla/5.0 (Windows NT 10.0; Win64; x64)\n\nAppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.90 Safari/537.36”が使われています。\n\n図 22. C&C コマンド処理部\n\n図 23. 攻撃者が使った休止状態コマンド\n\n\n-----\n\n通信データは、AES+base64 で暗号化されています。特徴的な点としては、AES S-BOX 等の定数がデータ領域に埋\n\nめ込まれているのでなく、スタック領域に値を積み上げて使用する処理になっている事です。これは、暗号処理部の検\n\n出を困難にし、分析を阻害する事が目的と見られます。\n\n図 24. AES 処理部\n\n**APT10 ANEL とのコードレベルの類似点**\n\nAPT10 の攻撃ツールの１つである RAT に、“ANEL”[18] があります。今回観測した RAT と ANEL との間には、い\n\nくつかの類似点が見られました。しかし、それ以上の裏付けとなり得る情報が入手できていないため本書執筆時点では、\n\nこのマルウェアを使う攻撃者グループを特定できていません。\n\n\n**ANEL との類似点**\n\n1. Main 処理の最初で、1 つの文字列変数に複数の C＆C を用意し、パースして利用する\n\n2. 通信データ ( 暗号 +Base64)\n\n暗号でバイトデータとなった値を Base64 するため、CryptBinaryToString() を使う\n\n3. 固定のユーザエージェントを使い、HTTP POST 通信\n\n4. 実装量の多い暗号アルゴリズムをライブラリの使用をせずにコーディングしている\n\n5. C2 命令を InternetReadFile() で拾い、命令処理だけ別スレッドで開始する\n\n6. RAT にバージョン情報が埋め込まれている\n\n\n18 https://jsac.jpcert.or.jp/archive/2019/pdf/JSAC2019_6_tamada_jp.pdf\n\n\n-----\n\n図 25. C＆C 文字列設定部 ( 上 :LODEINFO RAT 下 : ANEL 5.1.1)\n\n\n-----\n\n## 攻撃グループについて\n\n昨年度活発な活動が観測された 2 つの攻撃グループについて、攻撃グループの概要と特徴を記載します。\n\n##### Tick (Nian)\n\nTick 攻撃グループは、2019 年度はこれまでの攻撃ツールの新しいバージョンや亜種を使って攻撃活動を行っていた\n\nと思われます。Tick 攻撃グループの攻撃ツールには、cpycat や 9002 などがあります [19]。これらは最近でも観測さ\n\nれていますが、Ravirra や ABK といった頻繁に改良されるダウンローダとともに利用されています。Tick 攻撃グルー\n\nプは、日本と韓国を主な標的としていますが、政府や官公庁、防衛関連組織からのインテリジェンス収集だけでなく、\n\n最近は電気や化学といった民間の製造業も標的にしています。また、国内でユーザの多い資産管理ツールの脆弱性をつ\n\nいた 2017 年の攻撃が有名です [20]。\n\n19 https://jp.ahnlab.com/global/upload/download/asecreport/PressAhn_Vol64.pdf\n\n20 https://www.secureworks.jp/̃/media/Files/JP/Reports/Secureworks-Bronze-Butler-Report.ashx\n\n\n-----\n\n##### BlackTech (Huapi)\n\nBlackTech (Huapi) 攻撃グループは、最初の 10 年間は台湾と台湾に関連した組織だけを標的にしていました。\n\n2017 年から日本も標的に加えています。日本と台湾の政府、防衛関連、製造業、教育、通信、メディアと様々な業種\n\nに攻撃を行っています。BlackTech 攻撃グループで特筆すべき点は、主にアンチウイルス製品の脆弱性を発見し、そ\n\nれを攻撃する事です。この能力によって、BlackTech 攻撃グループは、侵入した組織の感染拡大フェーズにおいて、ネッ\n\nトワークを掌握する事に長けていると思われます。\n\n\n-----\n\n## 攻撃グループごとの TTPs（ 戦術 、技術 、手順 ）\n\n攻撃グループごとの TTPs と標的組織を表で大まかに整理します。MITRE 社 ATT&CK に攻撃フレームワークの攻\n\n撃番号を記載しますので、利用している製品での検出有無などをご確認ください。\n\n\n-----\n\n-----\n\n## TTPs より考察する脅威の検出と緩和策\n\n##### マルウェアの配送・侵入攻撃について\n\n標的型攻撃の起点となるマルウェアの配送について、Tick 攻撃グループと LODEINFO RAT を使った攻撃で、スピ\n\nアフィッシュメールの添付ファイルを利用する事が観測されています。Tick グループは、国内企業の海外拠点を標的に\n\n現地の言語 ( 中国拠点のユーザを標的とした中国語 ) で作られたスピアフィッシュ攻撃が観測されています。侵害され\n\nた正規アカウントから送信されたメールもあり、かつ海外ユーザという点で、標的業種として観測された化学や通信系\n\n組織などでは、海外拠点へも不審なメール添付のファイルを実行しないよう、ご注意頂ければと思います。昨年度は、\n\n標的型攻撃には分類されないものの、関係者を装ったマクロ付きのスピアフィッシュメールが送付される EMOTET の\n\n事案 [21] が、活発に観測されました。国内企業では、海外拠点へも同様にこれらのメールが送付されている事もあり、昨\n\n今は標的型攻撃にかかわらず、海外拠点でもメールに添付されたマクロは実行しないよう、注意を徹底していく必要が\n\nあると思われます。BlackTech 攻撃グループは、VPN 装置などのネットワーク機器の脆弱性をついた攻撃からの侵入、\n\nまた Linux で動作する RAT が公開サーバで観測された事から、外部に公開した資産にもご注意頂ければと思います。\n\nVPN 装置は、昨今のテレワーク拡大に伴い、急に稼動させた資産なども忘れずに管理し、メーカーからの情報に従い、\n\n特にリモートコード実行（Remote Code Execution、RCE）などの危険な脆弱性に対するパッチは迅速に適用する\n\nようご注意ください。その他に公開サーバ ( 主に Linux) での脆弱性検査も行うようご注意ください。\n\n##### インストールされる RAT、遠隔操作（C&C について）\n\nTick グループは、従来観測されていた ABK/Avenger/Ravirra ダウンローダではなく、リモートシェル機能のある\n\nversion RAT や down_new ダウンローダを使っています。新しく観測されたダウンローダにも、セキュリティ製品を\n\n停止したり、ファイルサイズを肥大化させて検出を迂回する機能があり、更には特定の OS バージョンや正規ソフトウェ\n\nアとの組み合わせでないと動作しないなどの特徴が見られています。また、新たに GitHub 上の公開ツールに RAT コー\n\nドを追加した LODEINFO が観測されています。これら攻撃グループの使うマルウェアは、標的性が高く、上述のセキュ\n\nリティ製品を直接停止する迂回機能や、正規コードに紛れ込ませるなどの工夫があり、検出がますます難しくなってい\n\nると言えるのではないでしょうか。一方で、これらの特徴自体がユニークであると言え、特にマルウェアが動作してい\n\nるメモリ上では、これらの特徴をメモリから直接検出し、感染痕跡を診断する技術も発達しています。そのような技術\n\nを使って検出する事は、つぎに述べる EDR を使った監視とは異なり、現在の状態ですぐに侵害を特定・把握する事が\n\nできます。また、BlackTech 攻撃グループは、過去に使用したドメイン名を利用し、IP アドレスを変更して攻撃に使\n\nう特徴が見られるため、BlackTech 攻撃グループの過去のネットワークインディケータは引き続きブラックリストと\n\nして、プロキシ通信ログの照合などで活用する事が推奨されます。BlackTech 攻撃グループの検出を検討する上では、\n\n公開サーバなどの Linux にも、先に述べたメモリ検出技術を使った診断の活用や、普段からアンチウイルスや EDR を\n\nインストールし、マルウェアを検出できるように準備する必要があると思われます。\n\n21 https://www.jpcert.or.jp/at/2019/at190044.html\n\n\n-----\n\n##### 侵入拡大・目的実行\n\n現在のところ、知財を窃取する目的で RAT を使った標的型攻撃の単純な本質は、遠隔からコマンドを実行できるな\n\nんらかのプログラム (RAT) を動作させる事です。version RAT、LODEINFO、Bifrose で示したように遠隔から正規\n\nのコマンドを必ず実行してきます。この実行コマンドの記録を行えるのが、EDR にカテゴライズされるプロダクトの特\n\n徴です。エキスパートが EDR の実行ログをモニタリングする事で、正規コマンドの実行状態から遠隔操作を特定し、\n\n攻撃を遮断する事も可能です。前段の配送、インストール、C&C の TTPs が変更されても、遠隔操作でコマンド実行\n\nされる点は変わらないため、EDR で記録するだけでなくエキスパートが監視することは有効な手段と考えています。こ\n\nの基盤を構築するためのオープンソースのツールもリリースされています [22]。\n\nTick グループの海外拠点への侵害を想定すると、海外拠点にも国内本社のセキュリティ基準で攻撃を検出できるよう準\n\n備を進めていく必要があると思われます。国内企業の海外拠点は、現地法人の M&A でグループ企業化した組織も多く\n\n見られ、現地で利用しているネットワークインフラや端末をそのまま、別の会社 ( 本社 ) の内部ネットワークに接続す\n\nるようなシステムが多いのではないでしょうか。また、従来の業務に支障がなければ、セキュリティ対策については、\n\nこの後それほど踏み込まずに稼動している組織が多いのではないでしょうか。今回あえて脆弱な海外拠点を狙ってから、\n\n国内への侵入を図るような攻撃の意図も見え、標的型攻撃を想定する上では、海外拠点に対しても目を光らせておく必\n\n要があると思われます。 侵入拡大のフェーズでは、国内側の EDR でリモートからのログインや NDR でネットワーク通\n\n信の可視化や監視を行う事で、海外拠点から内部ネットワークを使って国内拠点への侵入を早期に検出できる可能性が\n\nあります。一方で、海外拠点のセキュリティレベル自体をあげていく必要もあり、推奨対策の提示や、前述のメモリ診\n\n断技術なども用いた侵害調査 (Compromised Assessment) を一度実施しておき、対策を加速させるなどのはたらき\n\nかけも有効かと思われます。しばしば、海外拠点においてランサムウェアなどマルウェア感染によるサービス停止が発\n\n生し、国内で実装している対策を急遽海外にも展開せざるを得ず、セキュリティレベルが一気に向上するケースが見ら\n\nれます。\n\n22 http://www.jpcert.or.jp/magazine/acreport-SysmonSearch.html\n\n\n-----\n\n## 検知のインディケータ\n\n###### Tick/Bronze Butler\n\n\n-----\n\n###### BlackTech\n\n\n-----\n\n###### LODEINFO\n\n\n-----\n\n###### 第4版\n\n\n本社\n\n西日本営業所\n\n\n〒222-8562 横浜市港北区新横浜1-5-5\nTEL.045-476-2010 FAX.045-476-2060\n\n〒530-0005 大阪市北区中之島2-3-33 大阪三井物産ビル 14階\nTEL 06-6227-6916 FAX 06-6227-6917\n\n\n2020年5月 © Macnica Networks Corp.\n\n- ホワイトペーパーに掲載されております社名および製品名は、各社の商標および登録商標です。\n\n\n-----",
    "language": "JA",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.macnica.net/file/mpressioncss_ta_report_2019_4.pdf"
    ],
    "report_names": [
        "mpressioncss_ta_report_2019_4.pdf"
    ],
    "threat_actors": [
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbefc37d-475c-4d4d-b80b-7a55f896de82",
            "created_at": "2022-10-25T15:50:23.571783Z",
            "updated_at": "2025-03-27T02:00:55.502112Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "BRONZE BUTLER",
                "REDBALDKNIGHT"
            ],
            "source_name": "MITRE:BRONZE BUTLER",
            "tools": [
                "Mimikatz",
                "build_downer",
                "cmd",
                "ABK",
                "at",
                "BBK",
                "schtasks",
                "down_new",
                "Daserf",
                "ShadowPad",
                "Windows Credential Editor",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1590570600,
    "ts_modification_date": 1590570600,
    "files": {
        "pdf": "https://archive.orkl.eu/3bdd11d0b197ebbc1542554c51f8796f7c3477a2.pdf",
        "text": "https://archive.orkl.eu/3bdd11d0b197ebbc1542554c51f8796f7c3477a2.txt",
        "img": "https://archive.orkl.eu/3bdd11d0b197ebbc1542554c51f8796f7c3477a2.jpg"
    }
}