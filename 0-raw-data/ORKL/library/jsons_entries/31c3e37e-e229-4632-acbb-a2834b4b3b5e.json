{
    "id": "31c3e37e-e229-4632-acbb-a2834b4b3b5e",
    "created_at": "2022-10-25T16:48:18.795257Z",
    "updated_at": "2025-03-27T02:17:11.86572Z",
    "deleted_at": null,
    "sha1_hash": "4911b137926b6b17044141527980cdb9e4a9cb13",
    "title": "Microsoft PowerPoint - CCT-W08_Evolving-Threats-Dissection-of-a-Cyber-Espionage-Attack.pptx",
    "authors": "",
    "file_creation_date": "2015-11-04T03:47:07Z",
    "file_modification_date": "2015-11-04T03:47:07Z",
    "file_size": 3650627,
    "plain_text": "-----\n\n#### Before that I have been a cracker in Europe «underground scene» of Amiga and\n\n\n-----\n\n-----\n\n-----\n\n-----\n\n-----\n\n#### The lack of the patch MS14-068 is a key to understand how deep and how hard\n\n\n-----\n\n-----\n\n#### In seven cases, the exploit, despite successfully detonated, was not able to start the\n\n\n-----\n\n**EVILTOSS** **CHOPSTICK**\n**can** **allows the** **Complete**\n**download** **attacker to** **control over**\n**CHOPSTICK** **extend the** **target**\n**TROJAN** **control of** **system**\n**from C&C** **the target**\n\n\n**Vector +**\n**First**\n**Dropper**\n\n\n**Second**\n**Stage**\n**backdoor**\n**download**\n\n**(EVILTOSS)**\n\n\n**Coreshell**\n**Dropper**\n\n\n**First C&C**\n\n**HTTP POST**\n**message**\n\n\n**Streams to**\n**external C2 or**\n**Dropzone**\n\n\n-----\n\nAttempts to access C2\n\n**Base**\n\n###### : The repeated attempts to communicate externally from infected machines blocked\n\n\n-----\n\n#### One lesson I learn from Sharepoint… it has a horrible Log format.\n\n\n-----\n\nStill under control\nStill under control\n\nVictim 1\n\nVictim 2\n\nC2s\n\nBase hosts\n\nWashington\n\n**Public WAN**\n\nMoskow\n\nAddis Ababa\n\nKiev\n\n\nWashington\n\n**Public WAN**\n\n\n-----\n\n-----\n\n#### The victims have direct access to the abovementioned AD servers because they use\n\n\n-----\n\n-----\n\n#### execution in UserMode with the privileges of the System process.\n\n\n-----\n\n#RSAC\n\n## The Incident\n\n\n-----\n\n-----\n\n## Patient Zero\n\n###### What’s on Customer “Patient Zero” machine?\n\n  The forensic analysis on the «Patient Zero» identified by the Customer showed\n#### the following suspicious files and registry modifications, but no attempts to expand the focus of the investigation have been made.\n\n\n#RSAC\n\n|Registry Keys and Values|Created|Modified|\n|---|---|---|\n|HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\Network Identification Service\\parameters\\ServiceDll = C:\\Windows\\System32\\netids.dll|Yes|No|\n|HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\Network Identification Service\\parameters\\ServiceDllUnloadOnStop = 1|Yes|No|\n|HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\\ntsvcs = Network Identification Service|Yes|No|\n|HKEY_LOCAL_MACHINE\\software\\microsoft\\windowsNT\\currentversion\\svchost\\ntsvcs\\CoInitializeSecurityParam ➝1|Yes|No|\n\n\n#### EVILTOSS backdoor\n\n\n-----\n\n#### Looking at the logs, they have discovered the presence of repeated accesses from\n\n\n-----\n\n#RSAC\n## The Methodology\n\n\n-----\n\n#### It involves aggregation of IoCs and their classification to create a “Knowledge Base” of attacks, tools and strategies that could be “reused” in subsequent\n\n\n-----\n\nMalware Incident\nvisibility surface.\n\nNetwork, system\n\nTriage planned from\n\nSystem and log indicators.\n\na tailored set of\n\nvisibility Classification and\n\nstrategic actions.\n\nattribution.\n\n\n-----\n\n-----\n\n-----\n\n_The initial investigation has_\n_been limited to MD5 search_\n_on Domain machines._\n\n\n-----\n\nSuccessful\ncommunication\nrecorded after\n\n\ncommunication\n\n#### proactively\n\nrecorded after\nexpulsion/triage… monitor the\n\n#### occurrence of other malicious attacks.\n\n\n-----\n\nIOCs at Network, System\nand Log level for different\nplatforms and systems.\n\nImproved the triage\n\nRefocused the malware strategy by moving from\nanalysis on all identified °seek & destroy° to a\nsamples to identify more strategic approach.\nActionable IOCs.\n\n\n-----\n\n#RSAC\n\n## Attacker Tools\n\n\n-----\n\n#### : This is a modular implant compiled from a software framework that\n\n : Everyone of us knows this tool. In this case, this has been of\n\n\n-----\n\n-----\n\n-----\n\n## APT 28 Tools\n\n###### EVILTOSS IOCs\n  At system level the malware modifies the Registry in order to ensure persistence.\n\n  It is dropped and executed, usually, from one of these folders:\n\n\n#RSAC\n\n|Registry Keys and Values|Created|Modified|\n|---|---|---|\n|HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\Network Identification Service\\parameters\\ServiceDll = %EVILTOSS folder%<EVILTOSSNAME>.dll|Yes|No|\n|HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\Network Identification Service\\parameters\\ServiceDllUnloadOnStop = 1|Yes|No|\n|HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\\ntsvcs = Network Identification Service|Yes|No|\n|HKEY_LOCAL_MACHINE\\software\\microsoft\\windowsNT\\currentversion\\svchost\\ntsvcs\\CoInitializeSecurityParam ➝1|Yes|No|\n\n\n**Yes** **No**\n\n**Yes** **No**\n\n➝ **1** **Yes** **No**\n\n\n-----\n\n-----\n\nC2 ack for exfil\n\n\nC2 ack for exfil\n\n\n-----\n\n#### CHOPSTICK main executable creates a “mailslot” in Windows machines and acts as the mailslot server, while its code injected into the other processes acts as a client\n\n The RC4 encryption used here also uses a 50 bytes static key plus four-byte random\n\n\n-----\n\n/open/?ags=bBz&ags=qVs5d0kGHtil&oprnd=6ZCuc7XQ&channel=gBDFmj_fJdNk9&itwm=HJxam7mDOyIBftJ6OwEQjGBzyjpQv HTTP/1.1\n\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)\n\n\n-----\n\n## The attack strategy\n\n###### IOC: C2 list\n\n\n#RSAC\n\n\n######  Thanks to our structured approach we have been able to identify the C2s used by\n#### the attacker and with them, we have been able to enumerate infected hosts based on network communications.\n\n##### Note: The attacker has\n\n###### URL IP Type\n\n##### used different\n\nmicrosofthelpcenter.info 87.236.215.13 HTTP/HTTPS Main C2 _infrastructures for_\n\n##### managing infected\n\ndriversupdate.info 46.19.138.66 HTTPS C2\n\n##### hosts.\n\n|URL|IP|Type|\n|---|---|---|\n|microsofthelpcenter.info|87.236.215.13|HTTP/HTTPS Main C2|\n|driversupdate.info|46.19.138.66|HTTPS C2|\n|1oo7.net|5.199.171.58|HTTPS C2|\n|66.172.12.133|66.172.12.133|Coreshell C2|\n|45.64.105.23|45.64.105.23|Coreshell C2|\n|176.31.112.10|176.31.112.10|HTTPS C2|\n|176.31.96.178|176.31.96.178|HTTPS C2|\n\n\nmicrosofthelpcenter.info 87.236.215.13 HTTP/HTTPS Main C2\n\ndriversupdate.info 46.19.138.66 HTTPS C2\n\n1oo7.net 5.199.171.58 HTTPS C2\n\n66.172.12.133 66.172.12.133 Coreshell C2\n\n45.64.105.23 45.64.105.23 Coreshell C2\n\n176.31.112.10 176.31.112.10 HTTPS C2\n\n176.31.96.178 176.31.96.178 HTTPS C2\n\n\n-----\n\nPeak of attack distribution\n\n300 **Final triage managed by**\n\n**our Team**\n\n250\n\n200\n\nFirst Phase of\n\nInitial\n\n150 Attack\n\nSpearphishing\n\n100 Patient Zero\n\nLast record of infected\n\n50 machine\n\n0\n\nOct‐14 Nov‐14 Dec‐14\nJan‐15\nFeb‐15 Mar‐15 Remediation\nApr‐15\nMay‐15 Jun‐15 APT28\nJul‐15\nAug‐15\nSep‐15\n\n**Initial massive**\n**First time our**\n**triage**\n**methodology has applied**\n\nAPT28 Remediation\n\n\n-----\n\n#### It could be extremely important to streamline the IR procedures by transforming IOCs to actionable IOCs, that means to evaluate and define which IOC can be reused and\n\n It is important to drill and to give IR personnel the chance to learn how to build, use,\n### .\n\n\n-----\n\n###### use IoCs as key element to\n capabilities updated\n evaluate the attack surface\n\n You should organize the triage in a strategic approach.\n\n\n###### You should avoid to rely only on technologies\n\n\n###### You should organize the triage in a strategic approach.\n\n\n###### You should not approach IR operations in a unstructured way.\n\n\n-----\n\n#RSAC\n\n\n-----\n\nEMC, RSA, the EMC logo and the RSA logo are trademarks of EMC Corporation in the U.S. and other countries.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://paper.seebug.org/papers/APT/APT_CyberCriminal_Campagin/2015/2015.11.04_Evolving_Threats/cct-w08_evolving-threats-dissection-of-a-cyber-espionage-attack.pdf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.11.04_Evolving_Threats/cct-w08_evolving-threats-dissection-of-a-cyber-espionage-attack.pdf"
    ],
    "report_names": [
        "cct-w08_evolving-threats-dissection-of-a-cyber-espionage-attack.pdf",
        "cct-w08_evolving-threats-dissection-of-a-cyber-espionage-attack"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1446608827,
    "ts_modification_date": 1446608827,
    "files": {
        "pdf": "https://archive.orkl.eu/4911b137926b6b17044141527980cdb9e4a9cb13.pdf",
        "text": "https://archive.orkl.eu/4911b137926b6b17044141527980cdb9e4a9cb13.txt",
        "img": "https://archive.orkl.eu/4911b137926b6b17044141527980cdb9e4a9cb13.jpg"
    }
}