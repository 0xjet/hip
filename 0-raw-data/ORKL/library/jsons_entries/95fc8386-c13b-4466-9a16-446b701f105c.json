{
    "id": "95fc8386-c13b-4466-9a16-446b701f105c",
    "created_at": "2023-01-12T15:08:07.688831Z",
    "updated_at": "2025-03-27T02:12:11.05858Z",
    "deleted_at": null,
    "sha1_hash": "0631f79e913cbb5d487788f14c0c2284fa45afd9",
    "title": "2021-09-14 - TeamTNT Script Employed to Grab AWS Credentials",
    "authors": "",
    "file_creation_date": "2022-05-28T19:19:46Z",
    "file_modification_date": "2022-05-28T19:19:46Z",
    "file_size": 898256,
    "plain_text": "# TeamTNT Script Employed to Grab AWS Credentials\n\n**[cadosecurity.com/teamtnt-script-employed-to-grab-aws-credentials/](https://www.cadosecurity.com/teamtnt-script-employed-to-grab-aws-credentials/)**\n\nSeptember 14, 2021\n\nBlog\n\nSeptember 14, 2021\n\nA TeamTNT script has been employed to target a Confluence vulnerability that grabs AWS\ncredentials including those from ECS.\n\n[We’ve been tracking TeamTNT since the adversary group was tied back to a crypto-mining](https://www.cadosecurity.com/botnet-deploys-cloud-and-container-attack-techniques/)\nworm that specifically targeted Kubernetes clusters — the first known worm that contained\nAWS-specific credential theft functionality.\n\n**What We Found**\n\nThe IP address 3.10.224[.]87 is serving a clever script built by the TeamTNT crew to steal\ncredentials. It steals AWS EC2 and AWS ECS credentials via their meta-data urls\n(169.254.169.254 for EC2 and 169.254.170.2 for ECS), as well as environment variables\nfrom Docker systems:\n\n\n-----\n\n-----\n\nThe contents of malicious scripts at https://3.10.224[.]87/.a\n\n[This IP address is also being used to attack vulnerable Confluence servers with the recent](https://www.countercraftsec.com/blog/post/cve-2021-26084-payloads-and-oob-interaction/)\nCVE-2021-26084 exploit:\n\nCVE-2021-26084 Exploit code\n\nThe [backdoor being distributed by the server, however, is well attributed to the Mushtik](https://www.virustotal.com/gui/file/0e574fd30e806fe4298b3cbccb8d1089454f42f52892f87554325cb352646049/community)\nbotnet.\n\nHave two different crews hacked the same server and are using it for hosting? Or has\nMushtik borrowed some code from TeamTNT?\n\n**Indicators of Compromise**\n\n3.10.224[.]87\n\nhttps://3.10.224[.] 87/.a\n\n0e574fd30e806fe4298b3cbccb8d1089454f42f52892f87554325cb352646049\n\nF22ce94c41d69e539206f6832b046ca21b7d7e0a090918564d20d0ac91045276\n\n54934e404f70b23dc23945a61a9cc511fadeaf97a3e9b6a949b740130e9052bb\n\n**Recommendations**\n\nGiven these findings, we recommend blocking IP address 3.10.224[.]87 to not fall victim.\n\n[In addition, in our previous post detailing TeamTNTs techniques from August 2020, we’ve](https://www.cadosecurity.com/team-tnt-the-first-crypto-mining-worm-to-steal-aws-credentials/)\nprovided general recommendations on how to protect against these threats:\n\nIdentify which systems are storing AWS credential files and delete them if they aren’t\nneeded. It’s common to find development credentials have accidentally been left on\nproduction systems.\nUse firewall rules to limit any access to Docker APIs. We strongly recommend using a\nallowlisted approach for your firewall ruleset.\nReview network traffic for any connections to mining pools, or using the Stratum mining\nprotocol.\nReview any connections sending the AWS Credentials file over HTTP.\n\n\n-----\n\nAbout The Author\n\nChris Doman\n\n[Chris is well known for building the popular threat intelligence portal ThreatCrowd, which](https://www.threatcrowd.org/)\n[subsequently merged into the AlienVault Open Threat Exchange, later acquired by AT&T.](https://otx.alienvault.com/)\nChris is an industry leading threat researcher and has published a number of widely read\narticles and papers on targeted cyber attacks. His research on topics such as the North\nKorean government’s [crypto-currency theft schemes, and China’s attacks](https://www.wsj.com/articles/in-north-korea-hackers-mine-cryptocurrency-abroad-1515420004) against dissident\nwebsites, have been widely discussed in the media. He has also given interviews to print,\n[radio and TV such as CNN and BBC News.](https://www.youtube.com/watch?v=z_0oV_hsc08)\n\n**About Cado Security**\n\nCado Security provides the cloud investigation platform that empowers security teams to\nrespond to threats at cloud speed. By automating data capture and processing across cloud\nand container environments, Cado Response effortlessly delivers forensic-level detail and\nunprecedented context to simplify cloud investigation and response. Backed by Blossom\nCapital and Ten Eleven Ventures, Cado Security has offices in the United States and United\n[Kingdom. For more information, please visit https://www.cadosecurity.com/ or follow us on](https://www.cadosecurity.com/)\nTwitter [@cadosecurity.](https://twitter.com/CadoSecurity)\n\n[Prev Post](https://www.cadosecurity.com/azurescape/) [Next Post](https://www.cadosecurity.com/docker-kubernetes-forensics-incident-response/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-14 - TeamTNT Script Employed to Grab AWS Credentials.pdf"
    ],
    "report_names": [
        "2021-09-14 - TeamTNT Script Employed to Grab AWS Credentials.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536087,
    "ts_updated_at": 1743041531,
    "ts_creation_date": 1653765586,
    "ts_modification_date": 1653765586,
    "files": {
        "pdf": "https://archive.orkl.eu/0631f79e913cbb5d487788f14c0c2284fa45afd9.pdf",
        "text": "https://archive.orkl.eu/0631f79e913cbb5d487788f14c0c2284fa45afd9.txt",
        "img": "https://archive.orkl.eu/0631f79e913cbb5d487788f14c0c2284fa45afd9.jpg"
    }
}