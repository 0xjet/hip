{
    "id": "c2cf5fb1-b3b2-47ea-98e6-2cc2949cf653",
    "created_at": "2023-04-05T02:09:49.711724Z",
    "updated_at": "2025-03-27T02:09:30.29179Z",
    "deleted_at": null,
    "sha1_hash": "9ff4620282912a464a46131cf0cc77776525cbd7",
    "title": "2023-03-09 - BlackSnake Ransomware Emerges from Chaos Ransomware’s Shadow",
    "authors": "",
    "file_creation_date": "2023-04-03T08:24:46Z",
    "file_modification_date": "2023-04-03T08:24:46Z",
    "file_size": 1072805,
    "plain_text": "# BlackSnake Ransomware Emerges from Chaos Ransomware’s Shadow\n\n**[blog.cyble.com/2023/03/09/blacksnake-ransomware-emerges-from-chaos-ransomwares-shadow/](https://blog.cyble.com/2023/03/09/blacksnake-ransomware-emerges-from-chaos-ransomwares-shadow/)**\n\nMarch 9, 2023\n\n## New Ransomware Goes Beyond Traditional Tactics with Clipper Integration\n\nRansomware is a significant threat that can encrypt its victims’ files and demand a ransom. Additionally, the Threat\nActors (TAs) responsible for these attacks often use a double extortion technique, where they encrypt the files and\nexfiltrate sensitive data from the victim’s device before encryption. These TAs then leverage this stolen data to extort\ntheir victims further by threatening to release it on a leaked site unless their demands are met.\n\nThe TAs are constantly devising new methods to extort money from their victims. In the previous year, Cyble\n[Research and Intelligence Labs (CRIL) discovered a ransomware variant that not only encrypts victims’ files but also](https://blog.cyble.com/2022/11/18/axlocker-octocrypt-and-alice-leading-a-new-wave-of-ransomware-campaigns/)\nsteals their Discord tokens.\n\nRecently, CRIL spotted a new strain of malware known as the “BlackSnake” ransomware that is capable of\nperforming clipper operations aimed at cryptocurrency users. This variant was initially identified by a researcher\n[@siri_urz. It was detected in the cybercrime forum in 2022, and the TAs behind it were actively seeking affiliates.](https://twitter.com/siri_urz/status/1630571985653702661?s=20)\n\nIn addition, the TAs claimed they would take a 15% share of the profits generated through the affiliation process, as\nshown in the figure below.\n\n\n-----\n\n_Figure 1 –TAs advertisement in Cyber Crime Forum_\nOur analysis has uncovered evidence suggesting that BlackSnake Ransomware has been created based on the\nsource of Chaos ransomware. In this blog, we delve into the technical aspects of BlackSnake Ransomware, including\nits clipper operations.\n\n## Technical Analysis\n\nStatic analysis of the sample with hash:\ne4c2e0af462ebf12b716b52c681648d465f6245ec0ac12d92d909ca59662477b shows that the malicious file is a 32-bit\nPE binary compiled using .NET, as demonstrated in the following figure:\n\n_Figure 2 –File_\n\n_Information_\nUpon execution, the BlackSnake Ransomware performs an initial check to verify if the current input language of the\nsystem matches the language codes “az-Latn-AZ” or “tr-TR”.\n\nIf a match is found, the ransomware immediately terminates itself, indicating that the TAs of BlackSnake ransomware\nintend to exclude systems located in Azerbaijan or Turkey from being infected, as shown below.\n\n\n-----\n\n_Figure 3 –_\n\n_Locale Check_\nAfter confirming the user’s location, the BlackSnake Ransomware creates a registry entry, as shown below.\n\n_HKEY_CCURRENT_USER\\SOFTWARE\\oAnWieozQPsRK7Bj83r4_\n\nThe BlackSnake ransomware has a method of detecting whether it has already infected a system. It does this by\nchecking the location of the executing assembly with the path “C:\\Users[user-name]\\AppData\\Roaming\\svchost.exe”.\nIf this path matches, the ransomware continues to search for the file named “UNLOCK_MY_FILES.txt” in the\n%appdata% directory. Once the file is found, the ransomware will terminate itself. This behavior suggests that the\nransomware is designed to avoid infecting a system more than once, and it may be an attempt to limit the impact of\nthe ransomware.\n\nThe below figure shows the code snippet used by the malware for validation.\n\n\n-----\n\n_Figure 4 – File Path Validation_\nTo prevent multiple instances of the malware from running concurrently, the malware enumerates the names of all\ncurrently running processes, retrieves the filename of the current executing assembly, and compares it with the\nfilenames of the running processes. If there is a match, the malware then compares the Process ID of the current\nprocess with that of the target process. If there is a difference in the IDs, the malware identifies itself as a duplicate\ninstance and terminates itself to avoid running multiple copies at the same time.\n\nThe below figure shows the code snippet used by the ransomware for checking the malware instance.\n\n_Figure 5 –Check for Duplicate Instances of Malware_\nAfter confirming that there is no existing infection of itself, the ransomware creates a copy of itself in the %appdata%\ndirectory with the file name “svchost.exe” and executes the newly created process as shown below.\n\n\n-----\n\n_Figure 6 –_\n\n_Creates New Process and Executes_\nThe ransomware now creates a new thread for executing the clipper module, which includes functions such as\nGetText(), PatternMatch(), and SetText(). These functions allow the clipper module to perform its intended task of\nintercepting and modifying clipboard data as needed.\n\nThe below figure shows the clipper module.\n\n_Figure 7 – Clipper Module_\nBy constantly monitoring the user’s clipboard activity, the BlackSnake malware can check whether any cryptocurrency\naddresses are present by utilizing a hardcoded regular expression pattern for validation, as shown below.\n\n\n-----\n\n_Figure 8 – regex pattern Match_\nThe BlackSnake clipper module appears to specifically target Bitcoin wallet addresses, as indicated by the pattern\nused for identification.\n\nWhen a matching wallet address is found in the clipboard data, the malware utilizes the SetText() method to replace it\nwith a hardcoded Bitcoin wallet address belonging to the attacker, as shown in the figure below.\n\n_Figure 9 – Replacing Clipboard value with TA’s wallet address_\nOnce the clipper module is executed, the BlackSnake ransomware jumps to the encrypting modules. The malware\ncreates a below registry entry that automatically launches whenever the system starts to ensure it remains active and\npersistent on the infected system.\n\n_HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run_\n\n_“C:\\Users\\ [user-name]\\AppData\\Roaming\\svchost.exe”_\n\nBefore encrypting files, the ransomware identifies the list of directories to be enumerated and excludes a few folders\nfrom its encryption process. The below figure shows the folders excluded by the ransomware.\n\n_Figure 10 – Folder excluded by BlackSnake Ransomware_\n\n\n-----\n\nOnce the relevant directories are identified, the malware enumerates all the files. During this stage, the ransomware\nchecks the file path against a pre-defined list of strings, as mentioned in Figure 11. Any file path that matches these\nstrings is then excluded from the encryption process.\n\n_Figure 11 – Exclusion List_\n\nThe ransomware specifically focuses on encrypting files that have the below file extensions.\n\n.txt .jar .dat .contact .settings .doc .docx .xls\n\n.xlsx .ppt .pptx .odt .jpg .mka .mhtml .oqy\n\n.png .csv .sql .mdb .php .asp .aspx .html\n\n.htm .xml .psd .pdf .xla .cub .dae .indd\n\n.mp3 .mp4 .dwg .zip .rar .mov .rtf .bmp\n\n.mkv .avi .apk .lnk .dib .dic .dif .divx\n\n.iso .7zip .ace .arj .bz2 .cab .gzip .lzh\n\n.tar .jpeg .mpeg .torrent .mpg .core .pdb .ico\n\n.pas .wmv .swf .cer .bak .backup .accdb .bay\n\n.p7c .exif .vss .raw .m4a .wma .flv .sie\n\n.sum .ibank .wallet .css .crt .xlsm .xlsb .cpp\n\n.java .jpe .ini .blob .wps .docm .wav .3gp\n\n.webm .m4v .amv .m4p .svg .ods .vdi .vmdk\n\n.onepkg .accde .jsp .json .gif .log .config .m1v\n\n.sln .pst .obj .xlam .djvu .inc .cvs .dbf\n\n.tbi .wpd .dot .dotx .xltx .pptm .potx .potm\n\n.pot .xlw .xps .xsd .xsf .xsl .kmz .accdr\n\n.stm .accdt .ppam .pps .ppsm .1cd .3ds .3fr\n\n.3g2 .accda .accdc .accdw .adp .ai3 .ai4 .ai5\n\n.ai6 .ai7 .ai8 .arw .ascx .asm .asmx .avs\n\n\n-----\n\n.bin .cfm .dbx .dcm .dcr .pict .rgbe .dwt\n\n.f4v .exr .kwm .max .mda .mde .mdf .mdw\n\n.mht .mpv .msg .myi .nef .odc .geo .swift\n\n.odm .odp .oft .orf .pfx .p12 .pls .safe\n\n.tab .vbs .xlk .xlm .xlt .xltm .svgz .slk\n\n.tar.gz .dmg .psb .tif .rss .key .vob .epsp\n\n.dc3 .iff .onepkg .onetoc2 .opt .p7b .pam .r3d\n\n.pse .webp\n\nThe BlackSnake ransomware encryption process consists of several stages. In the first step, the malware employs a\nstring_Builder() function to generate a 40-byte random string. Next, it retrieves a pre-defined RSA public key that is\nhard-coded within the malware file. This key encrypts the previously generated random string, producing a key\nsuitable for AES encryption.\n\n_Figure 12 – parameters passed to the encryption function_\nOnce the malware gets the key, it encrypts all the identified files from the directory using the AES algorithm and\nappends the generated key (base64 encoded) to the end of the encrypted file.\n\nThe below figure shows the key appended to the encrypted file.\n\n_Figure 13 – RSA Encrypted Key_\n\nOn successful encryption, it appends the “pay2unlock” extension to the encrypted files and drops a ransom note in\nthat folder.\n\n\n-----\n\n_Figure 14 – Encrypted files_\n\nFinally, the victims are presented with a ransom note, “UNLOCK_MYFiles.txt” that directs them to contact the\nattackers via their TOX_ID if they wish to recover their encrypted files, as shown below.\n\n_Figure 15 – Ransom note_\n\n## Conclusion\n\nIt is convenient and straightforward for TAs to use pre-existing ransomware codes as a basis for developing new\n[ransomware families. Onyx and Yashma ransomware families were already linked to the Chaos ransomware family,](https://blog.cyble.com/2022/08/10/onyx-ransomware-renames-its-leak-site-to-vsop/)\nand the BlackSnake ransomware is another family now associated with Chaos ransomware. The Threat Actor has\ntweaked the Chaos ransomware source code and added a clipper module directly into the file, which is different from\nthe usual approach of having a separate file for the clipper.\n\nCyble Research & Intelligence Labs continuously monitors all ransomware campaigns and will keep updating our\nreaders with the latest information as and when we find it.\n\n## Our Recommendations\n\n\n-----\n\nWe have listed some essential cybersecurity best practices that create the first line of control against attackers. We\nrecommend that our readers follow the best practices given below:\n\nBack up data on different locations and implement Business Continuity Planning (BCP). Keep the Backup\nServers isolated from the infrastructure, which helps fast data recovery.\nFrequent Audits, Vulnerability Assessments, and Penetration Testing of organizational assets, including network\nand software.\nEnforcement of VPN to safeguard endpoints.\nConduct frequent training on security awareness for the company’s employees to inform them about emerging\nthreats.\nImplementation of technology to understand the behavior of the ransomware-malware families and variants to\nblock malicious payloads and counter potential attacks.\nThe users should carefully check their wallet addresses before making any cryptocurrency transaction to ensure\nthere is no change when copying and pasting the actual wallet addresses.\nThe seeds for wallets should be stored safely and encrypted on any devices.\n\n## MITRE ATT&CK® Techniques\n\nTactic **Technique ID** **Technique Name**\n\nExecution [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n\nImpact [T1486](https://attack.mitre.org/versions/v11/techniques/T1486/)\n\n[T1490](https://attack.mitre.org/techniques/T1490/)\n\nDiscovery [T1082](https://attack.mitre.org/techniques/T1082)\n\n[T1083](https://attack.mitre.org/techniques/T1083)\n\n[T1057](https://attack.mitre.org/techniques/T1057/)\n\nDefense Evasion [T1140](https://attack.mitre.org/techniques/T1140/)\n\n\nData encrypted for impact\n\nInhibit System Recovery\n\nSystem Information\n\nDiscovery File and Directory Discovery\n\nProcess Discovery\n\nDeobfuscate/Decode Files or Information\n\n\nPersistence [T1547](https://attack.mitre.org/techniques/T1547/001/) Registry Run Keys / Startup Folder\n\n## Indicators of Compromise (IOCs)\n\nIndicators Indicator\n\nType\n\n\nDescription\n\n\ne4c2e0af462ebf12b716b52c681648d465f6245ec0ac12d92d909ca59662477b Sha256 BlackSnake Ransomware\n\nafa9d7c88c28e9b8cca140413cfb32e4 MD5 BlackSnake Ransomware\n\n6936af81c974d6c9e2e6eaedd4026a37135369bc SHA-1 BlackSnake Ransomware\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-09 - BlackSnake Ransomware Emerges from Chaos Ransomware’s Shadow.pdf"
    ],
    "report_names": [
        "2023-03-09 - BlackSnake Ransomware Emerges from Chaos Ransomware’s Shadow.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1680660589,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1680510286,
    "ts_modification_date": 1680510286,
    "files": {
        "pdf": "https://archive.orkl.eu/9ff4620282912a464a46131cf0cc77776525cbd7.pdf",
        "text": "https://archive.orkl.eu/9ff4620282912a464a46131cf0cc77776525cbd7.txt",
        "img": "https://archive.orkl.eu/9ff4620282912a464a46131cf0cc77776525cbd7.jpg"
    }
}