{
    "id": "70056c33-92ed-4695-b776-db1f9c93406f",
    "created_at": "2022-10-25T16:48:11.666969Z",
    "updated_at": "2025-03-27T02:05:26.423678Z",
    "deleted_at": null,
    "sha1_hash": "479a70bbfa14396cebb0e4768c8521a53b899337",
    "title": "URI Terror Attack & Kashmir Protest Themed Spear Phishing Emails Targeting Indian Embassies And Indian Ministry Of External Affairs",
    "authors": "Cysinfo",
    "file_creation_date": "2017-02-23T04:35:02Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 3542192,
    "plain_text": "# emails targeting Indian Embassies and Indian Ministry of external affairs\n\n**cysinfo.com/uri-terror-attack-spear-phishing-emails-targeting-indian-embassies-and-indian-mea/**\n\n1/19/2017\n\n[In my previous blog I posted details of a cyber attack targeting Indian government organizations. This blog post](https://cysinfo.com/malware-actors-using-nic-cyber-security-themed-spear-phishing-target-indian-government-organizations/)\n[describes another attack campaign where attackers used the Uri terror attack and Kashmir protest themed spear](https://en.wikipedia.org/wiki/2016_Uri_attack)\nphishing emails to target officials in the Indian Embassies and Indian Ministry of External Affairs (MEA). In order to\ninfect the victims, the attackers distributed spear-phishing emails containing malicious word document which\ndropped a malware capable of spying on infected systems. The email purported to have been sent from legitimate\nemail ids. The attackers spoofed the email ids associated with Indian Ministry of Home Affairs to send out email to\nthe victims. Attackers also used the name of the top-ranking official associated with Minister of Home affairs in the\nsignature of the email, this is to make it look like the email was sent by a high-ranking Government official\nassociated with Ministry of Home Affairs (MHA).\n\n**Overview of the Malicious Emails**\n\nIn the The first wave of attack, The attackers spoofed an email id that is associated with Indian Ministry of Home\nAffairs (MHA) and an email was sent on September 20th, 2016 (just 2 days after the Uri terror attack) to an email id\nassociated with the Indian Embassy in Japan. The email was made to look like as if an investigation report related\nto Uri terror attack was shared by the MHA official. This email contained a malicious word document (Uri Terror\n_Report.doc) as shown in the below screen shot_\n\nOn Sept 20th,2016 similar Uri Terror report themed email was also sent to an email id connected with Indian\nembassy in Thailand. This email was later forwarded on Oct 24th,2016 from a spoofed email id which is associated\nwith Thailand Indian embassy to various email recipients connected to the Indian Ministry of External Affairs as\nshown in the below screen shot. This email also contained the same malicious word document (Uri Terror\n_Report.doc)_\n\n\n-----\n\nIn the second wave of attack slightly different theme was used, this time attackers used the Jammnu & Kashmir\nprotest theme to target the victims. In this case Attackers again spoofed an email id associated with Indian Ministry\nof Home Affairs and the mail was sent on September 1,2016 to an email id associated Thailand Indian embassy, this\nemail was later forwarded on Oct 24th,2016 from a spoofed email of Thailand Indian embassy to various email\nrecipients connected to the Indian Ministry of External Affairs (MEA). This time the email was made to look like an\ninvestigation report related to Jammu & Kashmir protest was shared by the Ministry of Home Affairs Official and the\nforwarded email was made to look like the report was forwarded by an Ambassador in Thailand Indian embassy to\nthe MEA officials. This email contained a different malicious word document (mha-report.doc) as shown in the below\nscreen shot.\n\nFrom the emails (and the attachments) it looks like the goal of the attackers was to infect and take control of the\nsystems and also to spy on the actions of the Indian Government post the Jammu & Kashmir protest and Uri Terror\nattack.\n\n\n-----\n\ndocuments (Uri Terror Report.doc and mha-report.doc) displayed the same content and contained a Show\nDocument button as shown below\n\nIn case of both the documents (Uri Terror Report.doc and mha-report.doc) the malicious macro code was heavily\nobfuscated(used obscure variable/function names to make analysis harder) and did not contain any auto execute\nfunctions . Malicious activity is trigged only on user interaction, attackers normally use this technique to bypass\nsandbox/automated analysis. Reverse engineering both the word documents (Uri Terror Report.doc & mha_report.doc) exhibited similar behaviour except the minor difference mentioned below._\n\nIn case of _mha-report.doc the malicious activity triggered only when the show document button was clicked, when_\nthis event occurs the macro code calls a subroutine CommandButton1_Click() which in turn calls a malicious\nobfuscated function (Bulbaknopka()) as shown in the below screen shot.\n\nIn case of _Uri Terror Report.doc the malicious activity triggered when the document was either closed or when the_\nshow document button was clicked, when any of these event occurs a malicious obfuscated function\n(chugnnarabashkoim()) gets called as shown below.\n\n\n-----\n\nThe malicious macro code first decodes a string which contains a reference to the pastebin url. The macro then\ndecodes a PowerShell script which downloads base64 encoded content from the pastebin url.\n\nBelow screen shot shows the network traffic generated as a result of macro code executing the PowerShell script.\n\nBelow screen shot shows the malicious base64 encoded content hosted on that pastebin link.\n\n\n-----\n\nThe base64 encoded content downloaded from the Pastebin link is then decoded to an executable and dropped on\nthe system. The technique of hosting malicious code in legitimate sites like Pastebin has advantages and it is highly\nunlikely to trigger any suspicion in security monitoring and also can bypass reputation based devices. Below screen\nshot shows the file (officeupdate.exe) decoded and dropped on the system.\n\nThe dropped file was determined as modified version of njRAT trojan. The dropped file ( officeupdate.exe) is then\nexecuted by the macro code using the PowerShell script.\n\nnjRAT is a Remote Access Tool (RAT) used mostly by the actor groups in the middle east. Once infected njRAT\ncommunicates to the attacker and allows the attacker to log keystrokes upload/download files access victims web\n\n\n-----\n\n**Analysis of the Dropped Executable (officeupdate.exe)**\n\nThe dropped file was analyzed in an isolated environment (without actually allowing it to connect to the c2 server).\nThis section contains the behavioral analysis of the dropped executable\n\nOnce the dropped file (officeupdate.exe) is executed the malware drops additional files ( _googleupdate.exe, malib.dll_\n_and msccvs.dll) into the %AllUsersProfile%\\Google directory and then executes the dropped googleupdate.exe_\n\nThe malware then communicates with the C2 server (khanji[.]ddns[.]net) on port 5555\n\n\n-----\n\n**C2 Communication Pattern**\n\nUpon execution malware makes a connection to the c2 server on port 5555 and sends the system & operating\nsystem information along with some base64 encoded strings to the attacker as shown below.\n\nBelow is the description of the strings passed in the C2 communication\n\n**_WIN-T9UN4HIIHEC -> is the hostname of the infected system_**\n**_Administrator -> is the username_**\n**_16-12-04 -> is the infection date_**\n**_No -> Indicates that the system has no camera_**\n\nThe below screen shot shows the base64 decoded strings associated with the C2 communication\n\nBelow is the description of the decoded strings\n\n\n-----\n\n**_Process Hacker [WIN-T9UN4HIIHEC\\Administrator]+ -> Reports open window, In my case I was using a tool_**\n**_called Process Hacker, The information on the open window lets the attacker know what tools are running_**\n**_on the system or if analysis tools are used to inspect the malware._**\n\n**C2 Domain Information**\n\nThis section contains the details of the C2 domain (khanji[.]ddns[.]net). Attackers used the DynamicDNS to host the\nC2 server, this allows the attacker to quickly change the IP address in real time if the malware C2 server\ninfrastructure is unavailable. The C2 domain was associated with multiple IP addresses in past as shown below\n\nDuring the timeline of this cyber attack most of these IP addresses were located in Pakistan and few IP addresses\nused the hosting provider infrastructure as shown in the screen shot below\n\n\n-----\n\nBelow screenshot shows the timeline when these IP addresses were active.\n\nThe C2 domain (khanji[.]ddns[.]net) was also found to be associated with multiple malware samples in the past,\nSome of these malware samples made connection to pastebin urls upon execution, which is similar to the behavior\nmentioned previously.\n\n\n-----\n\n**Threat Intelligence**\n\nBased on the base64 encoded content posted in the Pastebin, userid associated with the Pastebin post was\ndetermined. The same user posted multiple similar posts most of them containing similar base64 encoded content\n(probably used by the malwares in other campaigns to decode and drop malware executable), these posts were\nmade between July 21st, 2016 to September 30, 2016. Below screen shot shows the posts made by the user, the\nhits column in the below screen shot gives an idea of number of times the links were visited (probably by the\nmalicious macro code), this can give rough idea of the number of users who are probably infected as a result of\nopening the malicious document.\n\n\n-----\n\nBelow screen shot shows one of the post containing base64 encoded data made by the user on Sept 26th,2016\n\nDoing a Google search for the Pastebin userid landed me on a YouTube video posted by an individual\ndemonstrating his modified version of njRAT control panel/builder kit. The Pastebin userid matched with the Email\nID mentioned by this individual in the YouTube video description section as shown below.\n\nThis individual also used a specific keyword in his Skype id, Twitter id, and the YouTube username. This same\nkeyword was also found in the njRAT C2 communication used in this attack as shown below.\n\n\n-----\n\nAfter inspecting the njRAT builder kit it was determined that this individual customized the existing njRAT builder kit\nto bypass security products. The product information in the builder kit matched with this individual’s YouTube\nusername and the YouTube channel. The njRAT used in this cyber attack was built from this builder kit.\n\nBased on this information it can be concluded that espionage actors used this individual’s modified version of njRAT\nin this cyber attack.\n\nEven though this individual’s email id matched with the Pastebin id where base64 encoded malicious code was\nfound, it is hard to say if this individual was or was not involved in this cyber attack. It could be possible that the\nespionage actors used his public identity as a diversion to mislead and to hide the real identity of the attackers or it\nis also possible that this individual was hired to carry out the attack.\n\n**Indicators Of Compromise**\n\nThe indicators are provided below, these indicators can be used by the organizations (Government, Public and\nPrivate organizations) to detect and investigate this attack campaign.\n\n**_Dropped Malware Samples:_**\n_14b9d54f07f3facf1240c5ba89aa2410 (googleupdate.exe)_\n_2b0bd7e43c1f98f9db804011a54c11d6 (malib.dll)_\n_feec4b571756e8c015c884cb5441166b (msccvs.dll)_\n_84d9d0524e14d9ab5f88bbce6d2d2582 (officeupdate.exe)_\n\n\n-----\n\n_139[.]190[.]6[.]180_\n_39[.]40[.]141[.]25_\n_175[.]110[.]165[.]110_\n_39[.]40[.]44[.]245_\n_39[.]40[.]67[.]219_\n_119[.]160[.]68[.]178_\n_175[.]107[.]13[.]215_\n_39[.]47[.]125[.]110_\n_175[.]107[.]5[.]247_\n_175[.]107[.]6[.]174_\n_182[.]191[.]90[.]91_\n_175[.]107[.]7[.]50_\n_182[.]191[.]90[.]92_\n_175[.]107[.]7[.]69_\n_39[.]47[.]84[.]127_\n_192[.]169[.]136[.]121_\n_155[.]254[.]225[.]24_\n_203[.]31[.]216[.]214_\n_45[.]42[.]243[.]20_\n\n**_Pastebin URL’s Hosting Malicious Payload:_**\n_hxxp://pastebin.com/raw/5j4hc8gT_\n_hxxp://pastebin.com/raw/6bwniBtB_\n\n**_Related Malware Samples associated with C2 (khanji[.]ddns[.]net):_**\n_028caf3b1f5174ae092ecf435c1fccc2_\n_7732d5349a0cfa1c3e4bcfa0c06949e4_\n_9909f8558209449348a817f297429a48_\n_63698ddbdff5be7d5a7ba7f31d0d592c_\n_7c4e60685203b229a41ae65eba1a0e10_\n_e2112439121f8ba9164668f54ca1c6af_\n_784b6e13f195236304e1c172dcdab51f_\n_b0f0350a5c2480d8419d14ec3445b765_\n_9a51db9889d4fd6d02bdb35bd13fb07e_\n_8199667bad5559ee8f04fd6b1a587a75_\n_7ad6aaa107a7616a3dbe8e3babf5d310_\n\n**Conclusion**\n\nAttackers in this case made every attempt to launch a clever attack campaign by spoofing legitimate email ids and\nusing an email theme relevant to the targets. The following factors in this cyber attack suggests the possible\ninvolvement of Pakistan state sponsored cyber espionage group to mainly spy on India’s actions related to these\nGeo-political events (Uri terror attack and Jammu & Kashmir protests).\n\n_Victims/targets chosen (Indian Embassy and Indian MEA officals)_\n\n_Use of Email theme related to the Geo-political events that is of interest to the targets_\n\n_Timing of the spear phishing emails sent to the victims_\n\n_Location of the C2 infrastructure_\n\n\n-----\n\ngain long-term access by evading anti-virus, sandbox and security monitoring at both the desktop and network\nlevels.\n\n_Use of obfuscated malicious macro code_\n\n_Use of macro code that triggers only on user intervention (to bypass sandbox analysis)_\n\n_Use of legitimate site (Pastebin) to host malicious code (to bypass security monitoring)_\n\n_Use of customized njRAT (capable of evading anti-virus)_\n\n_Use of Dynamic DNS to host C2 infrastructure_\n\n[I would like to thank Brian Rogalski who after reading my](https://twitter.com/br0g_RE) [previous blog post shared a malicious document which he](https://cysinfo.com/malware-actors-using-nic-cyber-security-themed-spear-phishing-target-indian-government-organizations/)\n[thought was similar to the document mentioned in my previous blog. This malicious document shared by Brian](https://cysinfo.com/malware-actors-using-nic-cyber-security-themed-spear-phishing-target-indian-government-organizations/)\ntriggered this investigation and helped me in identifying the related Emails and related documents associated with\nthis cyber attack.\n\n**References**\n\nhttps://www.zscaler.com/blogs/research/njrat-h-worm-variant-infections-continue-rise\n\nhttp://threatgeek.typepad.com/files/fta-1009—njrat-uncovered-1.pdf\n\nhttps://www.eff.org/files/2013/12/28/quantum_of_surveillance4d.pdf\n\nhttps://www.symantec.com/connect/blogs/simple-njrat-fuels-nascent-middle-east-cybercrime-scene\n\n[Follow us on Twitter: @monnappa22](https://twitter.com/monnappa22) [@cysinfo22](https://twitter.com/cysinfo22)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/aw4frbwy7jj5iqlhn9mas4qmc8ogfljg"
    ],
    "report_names": [
        "Cysinfo-Uri-KashmirProtest-Phishing-targeting-Indian-Embassies(01-19-2017)"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041126,
    "ts_creation_date": 1487824502,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/479a70bbfa14396cebb0e4768c8521a53b899337.pdf",
        "text": "https://archive.orkl.eu/479a70bbfa14396cebb0e4768c8521a53b899337.txt",
        "img": "https://archive.orkl.eu/479a70bbfa14396cebb0e4768c8521a53b899337.jpg"
    }
}