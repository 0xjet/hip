{
    "id": "feac4e06-f17f-4447-b9ba-273152a2e2c7",
    "created_at": "2023-01-12T15:09:29.94238Z",
    "updated_at": "2025-03-27T02:05:51.738721Z",
    "deleted_at": null,
    "sha1_hash": "0611e2a84e59ca3e8e7df2637ccc946a44ae56d5",
    "title": "2017-10-03 - The Flusihoc Dynasty, A Long Standing DDoS Botnet",
    "authors": "",
    "file_creation_date": "2022-05-28T16:53:49Z",
    "file_modification_date": "2022-05-28T16:53:49Z",
    "file_size": 1249899,
    "plain_text": "# The Flusihoc Dynasty, A Long Standing DDoS Botnet\n\n**[arbornetworks.com/blog/asert/the-flusihoc-dynasty-a-long-standing-ddos-botnet/](https://www.arbornetworks.com/blog/asert/the-flusihoc-dynasty-a-long-standing-ddos-botnet/)**\n\n\nNETSCOUT Blog\n\n\nby [ASERT Team on October 3rd, 2017](https://www.netscout.com/blog/asert/asert-team)\nSince 2015, ASERT has observed and followed a DDoS Botnet named Flusihoc. To date\nvery little has been published about this family, despite numerous anti-virus and intrusion\ndetection signatures created by various vendors. Flusihoc has remained persistent with\nmultiple variants, over 500 unique samples in our malware zoo, and continued development.\nFlusihoc is a versatile C++ malware capable of a variety of DDoS attacks as directed by a\nCommand and Control server. We have decided to take a look at this malware family due to\na recent uptick in observed activity. This post will discuss this family, its features and\nobserved activity over the years.\n\n## Possible Chinese Origin\n\nThe geolocation of the identified C2 addresses and static attributes of the malware suggest\nthat Flusihoc may be of Chinese origin. Looking at Flusihoc samples, we find debug strings\nsuch as:\n\n\n-----\n\nC:\\Users\\chengzhen\\Desktop\\svchost\\Release\\svchost.pdb\n\nbearing the word Chengzhen which translates to the phrase, “to become true”, in English\nfrom Chinese. Additionally, other samples contained debug strings and values which\nincluded Chinese characters. Looking at PE resources of samples we find a large portion of\nsamples have Chinese_Simplified language resources. It is important to note these points\ncould be part of the attacker’s intentional effort to mislead researchers.\n\n## Command and Control (C2) Communications\n\nFlusihoc communicates with its C2 via HTTP in plain text. An example C2 communication\nlooks like:\n\nThe C2 uses a command structure based on numbers; the bot will receive a number and\nrespond appropriately based on the command associated with that number value. The\ncommunication strings are separated by \"|\" characters and terminated with the string \"end\".\nASERT identified the following numbered commands: 1 - Requests the bot to send infected\nsystem information; this command will prompt the bot to return information such as,\noperating system name, CPU details, RAM size and network speed. 22 - Tells the bot to\ncheck for attack payloads and send a \"null\" to the C2 if it has not previously received a\npayload. If the bot responds with a “null”, the C2 will send a blob of text which the bot will\nparse out and use for its attack payloads. If the bot already has an attack payload it will send\nan \"end\" to the C2. 333 - Gets attack status and will prompt the bot to send a \"Busy\" or\n\"Idle\" message based on if it is actively attacking a target. 4444 - Commands the bot to stop\nthe current attack Additionally, the C2 will send a command in this format to initiate an attack:\n\n\n-----\n\n<attack command #>|<target>|<port>|<# of threads>|<uri>|<attack type>\\n…end\n\n## DDoS Attack Types\n\nFlusihoc is capable of 9 types of DDoS attacks:\n\nSYN_Flood (1)\nUDP_Flood (2)\nICMP_Flood (3)\nTCP_Flood (4)\nHTTP_Flood (5)\nDNS_Flood (6)\nCON_Flood (7)\nCC_Flood (8)\nCC_Flood2 (9)\n\nThese attack types are sent by the C2 in string format for the bot to parse and issue attacks\nbased off of. The mechanisms used to conduct these attacks vary by attack type and variant\nprimarily utilizing Winsock2 from the Windows SDK.\n\n## Observed Improvements and Changes\n\n### Removed then Re-Added Persistence\n\n[Early variants of Flusihoc such as this sample available on VirusTotal used a persistence](https://www.virustotal.com/en/file/e2d2b5746990c06b84d4cbe2df76f882e792de3549f64d941a31e4e38c660656/analysis/)\nregistry entry in 'Software\\Microsoft\\Windows\\CurrentVersion\\Run'. However, in later\nsamples, this persistence mechanism is not present in a large portion of samples. This may\nbe to evade detection however, it also makes it harder for the bot to restart after a system\nreboot. In newer samples, we see the Flusihoc authors bring back this persistence\nmechanism, presumably due to the difficulties maintaining persistence after the run entry\nwas removed.\n\n### Encrypted C2 Address\n\nFlusihoc also transitioned from a plaintext C2 to a RC4 encrypted C2 address in later\n[variants. In a sample with a March 2017 compilation date, available on VirusTotal, we can](https://www.virustotal.com/en/file/d516fb73271cce3391340d71b0f2c6be6c1347cb81abb7eb272da46b0caaaa1b/analysis/)\nsee the C2 address in plaintext:\n\n\n-----\n\n[However, we see an encrypted C2 in a newer sample on VirusTotal with a compilation date](https://www.virustotal.com/en/file/6e4c85916dc98ea5ac981157f2a4adae3384009b646f6835a570c6b3c1083850/analysis/)\nin April 2017. In this sample, the C2 looks similar to the March 2017 variant however, instead\nof a plain text C2, we have an encrypted C2:\n\nThe bot then calls a function that employs standard RC4 encryption to decrypt the C2 value\nwith a key. In the case of this sample the RC4 key was \"crealloc\" which we found within the\nbyte ptr of the RC4 decryption function seen below: The RC4 function is standard and when\ngiven the above encrypted C2 value and the key you will get the C2 address of:\n**Main[.]dresou[.]net**\n\n### Download and Execute Functionality\n\n\n-----\n\nIn the same sample from April 2017, we found new functionality where the bot will download\nand execute a file using the Windows API functions URLDownloadToFileA, WinExec and\n**ShellExecuteA. If the file ends with \"exe\" it will download a file from the provided URL and**\nexecute it.\n\nIf the file name does not end with \"exe\", it will run it with ShellExecuteA using the \"open\"\noperation.\n\nThis feature allows the botnet controller to update Flusihoc malware or download additional\nmalicious files remotely.\n\n## Campaign activity\n\n### C2s Discovered\n\nUsing our botnet infiltration system, ASERT has tracked 154 different C2s associated with\nFlusihoc issuing 24,137 attacks commands since July 2015. 48 C2s are still active as of\nSept. 2017. below are the C2s generating the most attack commands:\n\nwm[.]sshtdk[.]com\n1211[.]sshtdk[.]com\n121[.]sshtdk[.]com\npp[.]sshtdk[.]com\nqq[.]sshtdk[.]com\n\nThe majority of C2s observed geo-locate to China with most of the attack commands\ndirected towards target URLs within China. A cursory review of the target URLs does not\nreveal any obvious correlation between targets suggesting this family is likely part of a\nfinancially motivated booter service in China.\n\n\n-----\n\n### Observed DDoS Activity\n\nArbor ATLAS infrastructure collects anonymized DDoS attack data from nearly 400 globally\ndistributed service providers running the Arbor SP/TMS Platform. Leveraging ATLAS, we are\nable to measure a portion of the botnet's attacks. Since July 2017, we can correlate\nobserved Flusihoc attack commands with 909 subsequent DDoS events reported into\nATLAS. The peak attack size was 45.08 Gbps seen on July 6th, 2017. A majority of the\nDDoS attacks involve TCP SYN over port 80, 1-1023 and 443. These events have an\naverage attack size of 603.24 Mbps usually launching around 14 different attacks per day.\n\n## Conclusion\n\nFlusihoc is likely a Chinese DDoS botnet which primarily focuses on targets in China.\nAnalysis suggests this botnet is part of a regional DDoS service based on the variance of\ntargets. This malware family has been around since at least 2015 and has been associated\nwith over 154 C2s. Flusihoc, although not the largest DDoS botnet, would still be capable of\ncausing problems given the fragility and brittleness of so many sites, servers, services, and\napplications. These DDoS attacks can be mitigated by Arbor solutions like Arbor SP/TMS.\n\n## Indicators\n\n\n-----\n\n**Samples:**\n\n41f1c2b942fb8c78d9d3b9e339480970ead06241\n2ff3eab0892325b936beee70d8625c4e8d50d7c0\n6a1863abded29f1151db7f1eebe33298adbcb793\n\n**C2s:**\n\nMain[.]dresou[.]net\nwm[.]sshtdk[.]com\n1211[.]sshtdk[.]com\n121[.]sshtdk[.]com\npp[.]sshtdk[.]com\nqq[.]sshtdk[.]com\n\n**Yara Rule:**\n\n(GitHub URL removed)\n\nPosted In\n\nAnalysis\nArbor Networks - DDoS Experts\nATLAS\nAttacks and DDoS Attacks\nBotnets\nInteresting Research\nMalware\nthreat analysis\nUncategorized\n\n## Subscribe\n\n_Sign up now to receive the latest notifications and updates from NETSCOUT's ASERT._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-10-03 - The Flusihoc Dynasty, A Long Standing DDoS Botnet.pdf"
    ],
    "report_names": [
        "2017-10-03 - The Flusihoc Dynasty, A Long Standing DDoS Botnet.pdf"
    ],
    "threat_actors": [
        {
            "id": "1c97ccfd-1888-492c-b7b9-bb52c4c3809b",
            "created_at": "2023-01-06T13:46:38.940529Z",
            "updated_at": "2025-03-27T02:00:02.957652Z",
            "deleted_at": null,
            "main_name": "Operation ShadowHammer",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation ShadowHammer",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536169,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1653756829,
    "ts_modification_date": 1653756829,
    "files": {
        "pdf": "https://archive.orkl.eu/0611e2a84e59ca3e8e7df2637ccc946a44ae56d5.pdf",
        "text": "https://archive.orkl.eu/0611e2a84e59ca3e8e7df2637ccc946a44ae56d5.txt",
        "img": "https://archive.orkl.eu/0611e2a84e59ca3e8e7df2637ccc946a44ae56d5.jpg"
    }
}