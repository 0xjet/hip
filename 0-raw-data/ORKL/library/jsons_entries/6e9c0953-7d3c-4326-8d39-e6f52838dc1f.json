{
    "id": "6e9c0953-7d3c-4326-8d39-e6f52838dc1f",
    "created_at": "2023-01-12T15:00:33.593674Z",
    "updated_at": "2025-03-27T02:16:25.706275Z",
    "deleted_at": null,
    "sha1_hash": "0b14690e14b202483572325ae0b37768f884a0b2",
    "title": "2018-06-18 - New Telegram‑abusing Android RAT discovered in the wild",
    "authors": "",
    "file_creation_date": "2022-05-28T23:28:19Z",
    "file_modification_date": "2022-05-28T23:28:19Z",
    "file_size": 2536371,
    "plain_text": "# New Telegram‑abusing Android RAT discovered in the wild\n\n**[welivesecurity.com/2018/06/18/new-telegram-abusing-android-rat/](https://www.welivesecurity.com/2018/06/18/new-telegram-abusing-android-rat/)**\n\nJune 18, 2018\n\nEntirely new malware family discovered by ESET researchers\n\n[Lukas Stefanko](https://www.welivesecurity.com/author/lstefanko/)\n18 Jun 2018 - 02:58PM\n\nEntirely new malware family discovered by ESET researchers\n\n\n-----\n\nESET researchers have discovered a new family of Android RATs (Remote Administration\nTools), that has been abusing the Telegram protocol for command and control, and data\nexfiltration.\n\nInvestigating what at first seemed like increased activity on the part of the previously\nreported [IRRAT and](https://news.drweb.com/show/?i=11331&lng=en) [TeleRAT, we identified an entirely new malware family that has been](https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/)\nspreading since at least August 2017. In March 2018, its source code was made available\nfor free on Telegram hacking channels, and as a result, hundreds of parallel variants of the\nmalware have been circulating in the wild.\n\nOne of these variants is different from the rest – despite the freely available source code, it\nis offered for sale on a dedicated Telegram channel, marketed under the name HeroRat. It\nis available in three pricing models according to functionality, and comes with a support\nvideo channel. It is unclear whether this variant was created from the leaked source code,\nor if it is the “original” whose source code was leaked.\n\n## How does it operate?\n\nAttackers lure victims into downloading the RAT by spreading it under various attractivesounding guises, via third-party app stores, social media and messaging apps. We’ve seen\nthe malware distributed mostly in Iran, as apps promising free bitcoins, free internet\nconnections, and additional followers on social media. The malware has not been seen on\nGoogle Play.\n\n\n-----\n\nFigure 1 – Some of the guises used to propagate the RAT\n\n\n-----\n\nThe malware runs on all Android versions: however, affected users need to accept\npermissions required by the app (sometimes including activating the app as device\nadministrator), which is where social engineering comes into play.\n\n\n-----\n\nFigure 2 – The RAT requesting device administrator rights\n\nAfter the malware is installed and launched on the victim’s device, a small popup appears,\nclaiming the app can’t run on the device and will therefore be uninstalled. In the variants we\nanalyzed, the fake uninstall message can be displayed in English or Persian, depending on\nthe target device‘s language settings.\n\nAfter the uninstallation is seemingly completed, the app’s icon disappears. On the attacker’s\nside, however, a new victimized device has just been registered.\n\n\n-----\n\nFigure 3 – HeroRat author s demonstration of installing the RAT on his own device (screenshots\n\nfrom an instructional video provided by the malware author)\n\nFigure 4 – Malware source code with fake uninstallation messages in both English and Persian\n\nHaving gained access to the victim’s device, the attacker then leverages Telegram’s bot\nfunctionality to control the newly listed device. Each compromised device is controlled via a\nbot, set up and operated by the attacker using the Telegram app.\n\nThe malware has a wide array of spying and file exfiltration capabilities, including\nintercepting text messages and contacts, sending text messages and making calls, audio\nand screen recording, obtaining device location, and controlling the device’s settings.\n\nHeroRat’s functionality is divided into three “bundles” – bronze, silver and gold panels –\noffered for sale for 25, 50, and 100 USD, respectively. The source code itself is offered for\n650 USD by HeroRat’s (ambitious) author.\n\nThe malware’s capabilities are accessible in the form of clickable buttons in the Telegram\nbot interface. Attackers can control victimized devices by simply tapping the buttons\navailable in the version of the malware they are operating.\n\n\n-----\n\nFigure 5 – HeroRat control panel\n\n\n-----\n\nFigure 6 – HeroRat functionality – from left to right, “Bronze panel”, “Silver panel” and “Gold panel”\n\n(screenshots from an instructional video provided by the malware author)\n\nUnlike the Telegram-abusing Android RATs previously analyzed, which are written in\nstandard Android Java, this newly-discovered malware family has been developed from\n[scratch in C# using the Xamarin framework – a rare combination for Android malware.](https://www.xamarin.com/)\n\nThe way the malware communicates via the Telegram protocol has been adapted to its\n[programming language – instead of the Telegram Bot API leveraged by the RATs previously](https://core.telegram.org/bots/api)\n[described, this malware family uses Telesharp, a library for creating Telegram bots with C#.](https://github.com/DaFri-Nochiterov/Telesharp/blob/master/README.md)\n\nCommunicating commands to and exfiltrating data from the compromised devices are both\ncovered entirely via the Telegram protocol – a measure aimed at avoiding detection based\non traffic to known upload servers.\n\n## How to stay safe\n\nWith the malware’s source code recently made available for free, new mutations could be\ndeveloped and deployed anywhere in the world. Since the distribution method and form of\ndisguise of this malware varies case by case, checking your device for the presence of any\nspecific applications is not enough to tell if your device has been compromised.\n\nIf you have reason to believe your device has been compromised by this malware, scan it\nusing a reliable mobile security solution. ESET systems detect and block this threat as\nAndroid/Spy.Agent.AMS and Android/Agent.AQO.\n\nTo avoid falling victim to Android malware, stick to the official Google Play store when\ndownloading apps, make sure to read user reviews before downloading anything to your\ndevice and pay attention to what permissions you grant to apps both before and after\ninstallation.\n\n## IoCs\n\n\n-----\n\n**Package Name** **Hash** **Detection**\n\nSystem.OS 896FFA6CB6D7789662ACEDC3F9C024A0 Android/Agent.AQO\n\nAndro.OS E16349E8BB8F76DCFF973CB71E9EA59E Android/Spy.Agent.AMS\n\nFreeInterNet.OS 0E6FDBDF1FB1E758D2352407D4DBF91E Android/Agent.AQO\n\n18 Jun 2018 - 02:58PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-06-18 - New Telegram‑abusing Android RAT discovered in the wild.pdf"
    ],
    "report_names": [
        "2018-06-18 - New Telegram‑abusing Android RAT discovered in the wild.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535633,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653780499,
    "ts_modification_date": 1653780499,
    "files": {
        "pdf": "https://archive.orkl.eu/0b14690e14b202483572325ae0b37768f884a0b2.pdf",
        "text": "https://archive.orkl.eu/0b14690e14b202483572325ae0b37768f884a0b2.txt",
        "img": "https://archive.orkl.eu/0b14690e14b202483572325ae0b37768f884a0b2.jpg"
    }
}