{
    "id": "efb6bef6-9891-4233-a147-4efdb7e64ec5",
    "created_at": "2023-01-12T15:05:49.728708Z",
    "updated_at": "2025-03-27T02:14:04.043959Z",
    "deleted_at": null,
    "sha1_hash": "30d39b782ad62d91b5b8fae31908d7511a45a99a",
    "title": "2020-09-23 - Case Study- Emotet Thread Hijacking, an Email Attack Technique",
    "authors": "",
    "file_creation_date": "2022-12-29T00:16:50Z",
    "file_modification_date": "2022-12-29T00:16:50Z",
    "file_size": 5482475,
    "plain_text": "# Case Study: Emotet Thread Hijacking, an Email Attack Technique\n\n**unit42.paloaltonetworks.com/emotet-thread-hijacking/**\n\nBrad Duncan September 23, 2020\n\nBy [Brad Duncan](https://unit42.paloaltonetworks.com/author/bduncan/)\n\nSeptember 23, 2020 at 6:00 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [botnet,](https://unit42.paloaltonetworks.com/tag/botnet/) [cyber crime,](https://unit42.paloaltonetworks.com/tag/cyber-crime/) [Emotet,](https://unit42.paloaltonetworks.com/tag/emotet/) [MealyBug,](https://unit42.paloaltonetworks.com/tag/mealybug/) [TA542](https://unit42.paloaltonetworks.com/tag/ta542/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/emotet-thread-hijacking/)\n\n## Executive Summary\n\nMalicious spam (malspam) pushing Emotet malware is the most common email-based\n[threat, far surpassing other malware families, with only a few other threats coming close.](https://www.proofpoint.com/us/blog/threat-insight/comprehensive-look-emotets-summer-2020-return)\n\nIn recent weeks, we have seen significantly more Emotet malspam using a technique called\n\"thread hijacking\" that utilizes legitimate messages stolen from infected computers' email\nclients. This malspam spoofs a legitimate user and impersonates a reply to the stolen email.\nThread hijacked malspam is sent to addresses from the original message.\n\n\n-----\n\nThis technique is much more effective than less sophisticated methods, which many people\nhave now learned to spot. The approach is more successful at convincing potential victims to\nclick on an attached file, or to click on a link to download a malicious Word document with\nmacros designed to infect a user with Emotet.\n\nHere, we review a case study of Emotet's thread hijacking process so we can better\nrecognize and understand this technique.\n\n[Palo Alto Networks customers are protected from this threat because our Threat Prevention](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\n[security subscription detects and prevents these types of Emotet infections. AutoFocus users](https://www.paloaltonetworks.com/cortex/autofocus)\n[can track Emotet activity using the Emotet tag.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Emotet)\n\nFigure 1. Visual representation of Emotet’s thread hijacking process.\n\n## Case Study Timeline\n\n\n-----\n\nTo illustrate Emotet s thread hijacking process, our case study focuses on an infection from\nSept. 3, 2020. In this example, Emotet hijacks the most recent email in an Outlook inbox\nfrom an infected host.\n\nThe timeline is:\n\n15:35 UTC – Legitimate message received by email client on host.\n16:31 UTC – Host infected with Emotet.\n16:34 UTC – Legitimate message collected from infected host is sent through Emotet\ncommand and control (C2) traffic.\n18:22 UTC – Emotet botnet sends spoofed email using legitimate message from the\ninfected host.\n\nThis process took one hour and 51 minutes to progress from the infection to the arrival of a\nthread-hijacked email.\n\n## Legitimate Email From the Infected Host\n\nIn our example, a vulnerable Windows 10 host used Microsoft Outlook as its email client.\nOutlook was synchronized to a Microsoft account at k*********.r*******@outlook.com (we\nhave redacted information from the email addresses for this case study). The most recent\nmessage in the infected host’s email client is shown in Figure 2, and we have loaded a\n[redacted copy of the legitimate email to GitHub.](https://github.com/pan-unit42/iocs/blob/master/Emotet-thread-hijacking/2020-09-03-Emotet-thread-hijacking-legitimate-email.txt)\n\n\n-----\n\nFigure 2. Most recent email from an infected host’s Outlook client.\nAs we see in Figure 2, the most recent email was received at 15:35 UTC, approximately one\nhour before the host was infected with Emotet. This email is a response from\nt****.h******@yahoo.com to a previous message from k*********.r*******@outlook.com.\n\n## Data Exfiltration Through C2 Traffic\n\nEmotet uses HTTP POST requests over C2 traffic to send data collected from the infected\nhost. This data is encoded or otherwise encrypted before it is sent over HTTP.\n\nMost of these POST requests contain only a small amount of encoded data from the infected\nhost, often much less than 1,000 bytes. These requests contain an extra 4 kB of data for\npadding and form header data. Figure 3 shows a typical example of Emotet C2 traffic from\nour case study.\n\n\n-----\n\nFigure 3. Example of HTTP POST data from Emotet C2 traffic in our case study.\nSince the amount of encoded data is so small, it does not contain any email chain data\ncollected from the infected user’s email client. However, at 16:34 UTC, we find 13.9 kB of\nencoded data sent over Emotet HTTP C2 traffic as shown in Figure 4.\n\n\n-----\n\nFigure 4. Approximately 13.9 kB of encoded data in Emotet C2 traffic at 16:34 UTC.\nThis amount is large enough to contain email chain data collected from the infected Windows\nhost. It is the only significant amount of data sent in HTTP POST requests from the Emotetinfected host before we find the thread-hijacked email at 18:22 UTC.\n\n## Spoofed Message From Hijacked Email\n\nAt 18:22 UTC, a spoofed email was received by t****.h******@yahoo.com, the Yahoo account\nthat had sent the most recent message in correspondence to the infected host. It contains an\nattached Word document with macros for Emotet. This message is shown in Figure 5, and\n[we have loaded a copy of the spoofed email to GitHub.](https://github.com/pan-unit42/iocs/blob/master/Emotet-thread-hijacking/2020-09-03-Emotet-thread-hijacking-spoofed-malspam-from-botnet.txt)\n\n\n-----\n\nFigure 5. Hijacked email sent from the Emotet botnet.\nThe message is a reply to t****.h******@yahoo.com that spoofs\nk*********.r*******@outlook.com from the infected host.\n\n\n-----\n\nThese thread-hijacked messages either have an attached file, or they have a link to\ndownload a malicious Word document with macros designed to infect a vulnerable host with\nEmotet.\n\nEmotet’s thread-hijacked message from this case study spoofed the name in the sending\naddress line from the infected host. Headers from the spoofed message indicate the actual\nsender may have been from a botnet host in Brazil, or a Brazil-based host may have been\nused to relay the message. Botnet hosts from all over the world are used to send these\nthread-hijacked messages from Emotet infections.\n\nFigure 6. Header lines from hijacked message sent to t****.h******@yahoo.com.\nThese spoofed messages tend to be the most recent emails from a victim’s email client\nbecause those are the most likely to fool someone.\n\nOf note, we cannot always assume the spoofed sending address is from an infected victim. If\nthe original message from an infected victim has multiple recipients, a hijacked email could\nspoof one of the other recipients.\n\n## Conclusion\n\nWe’ve stored [an example of the legitimate email that was hijacked in this case study.](https://github.com/pan-unit42/iocs/blob/master/Emotet-thread-hijacking/2020-09-03-Emotet-thread-hijacking-legitimate-email.txt)\n\n\n-----\n\n[We ve also stored an example of the spoofed messages sent from the Emotet botnet.](https://github.com/pan-unit42/iocs/blob/master/Emotet-thread-hijacking/2020-09-03-Emotet-thread-hijacking-spoofed-malspam-from-botnet.txt)\n\nThe [pcap of infection traffic from this case study is also available.](https://www.malware-traffic-analysis.net/2020/09/03/index.html)\n\nThis case study shows an example of Emotet thread hijacking so we can better understand\nhow Emotet malware utilizes this technique. Emotet is a very active threat that constantly\nupdates its malware in an attempt to evade detection. This vector of infection can reach a\ngreat deal of potential victims.\n\nHowever, organizations with effective spam filtering that follow best security practices have a\nmuch lower risk from this infection vector. Palo Alto Networks customers are further\n[protected from this threat, because our Threat Prevention security subscription detects and](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\nprevents these types of Emotet infections. [AutoFocus users can track Emotet activity using](https://www.paloaltonetworks.com/cortex/autofocus)\nthe [Emotet tag.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Emotet)\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-23 - Case Study- Emotet Thread Hijacking, an Email Attack Technique.pdf"
    ],
    "report_names": [
        "2020-09-23 - Case Study- Emotet Thread Hijacking, an Email Attack Technique.pdf"
    ],
    "threat_actors": [
        {
            "id": "e8e18067-f64b-4e54-9493-6d450b7d40df",
            "created_at": "2022-10-25T16:07:24.515213Z",
            "updated_at": "2025-03-27T02:02:10.267637Z",
            "deleted_at": null,
            "main_name": "Mummy Spider",
            "aliases": [
                "ATK 104",
                "Gold Crestwood",
                "Mummy Spider",
                "TA542"
            ],
            "source_name": "ETDA:Mummy Spider",
            "tools": [
                "Emotet",
                "Geodo",
                "Heodo"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "506404b2-82fb-4b7e-b40d-57c2e9b59f40",
            "created_at": "2023-01-06T13:46:38.870883Z",
            "updated_at": "2025-03-27T02:00:02.939775Z",
            "deleted_at": null,
            "main_name": "MUMMY SPIDER",
            "aliases": [
                "TA542",
                "GOLD CRESTWOOD"
            ],
            "source_name": "MISPGALAXY:MUMMY SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2ac83159-1d9d-4db4-a176-97be6b7b07c9",
            "created_at": "2024-06-19T02:03:08.024653Z",
            "updated_at": "2025-03-27T02:05:17.348806Z",
            "deleted_at": null,
            "main_name": "GOLD CRESTWOOD",
            "aliases": [
                "TA542 ",
                "Mummy Spider "
            ],
            "source_name": "Secureworks:GOLD CRESTWOOD",
            "tools": [
                "Emotet"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535949,
    "ts_updated_at": 1743041644,
    "ts_creation_date": 1672273010,
    "ts_modification_date": 1672273010,
    "files": {
        "pdf": "https://archive.orkl.eu/30d39b782ad62d91b5b8fae31908d7511a45a99a.pdf",
        "text": "https://archive.orkl.eu/30d39b782ad62d91b5b8fae31908d7511a45a99a.txt",
        "img": "https://archive.orkl.eu/30d39b782ad62d91b5b8fae31908d7511a45a99a.jpg"
    }
}