{
    "id": "7e927880-1089-4896-a194-e15235a0a35c",
    "created_at": "2023-01-12T14:59:27.247193Z",
    "updated_at": "2025-03-27T02:15:38.094396Z",
    "deleted_at": null,
    "sha1_hash": "5aaa72c65b3cf59c272d757da326385df9544685",
    "title": "2022-01-09 - Malware Headliners- Dridex",
    "authors": "",
    "file_creation_date": "2022-05-29T10:35:29Z",
    "file_modification_date": "2022-05-29T10:35:29Z",
    "file_size": 1012657,
    "plain_text": "# Malware Headliners: Dridex\n\n**atomicmatryoshka.com/post/malware-headliners-dridex**\n\nz3r0day_504 January 9, 2022\n\nFor this blog post, we're taking a dive into the initial stages of a prevalent banking trojan\nknown as Dridex. Developed by Maksim Yakubets and leveraged by advanced e-crime threat\ngroups such as TA505 and Indrik Spider, this malware is commonly delivered in a Microsoft\nOffice document as part of phishing campaigns.\n\n[The sample we're analyzing was downloaded from MalwareBazaar and submitted recently.](https://www.blogger.com/u/0/blog/post/edit/8377069834909459034/2523301002024575880#)\nAlthough the file being analyzed is a Microsoft Excel file, the analysis will take place in\nREMnux. All the tools I use will have their documentation/websites referenced at the bottom\nof the post.\n\nDISCLAIMER: Some of the IOCs identified in this sample are vulgar. This is a real malware\nsample identified in \"the wild\" and as such offers a good representation of what analysts may\ncome across in their day-to-day. I've added this disclaimer to mention, for those that may not\nunderstand, that the vulgar terminology did not originate from my work and is the work of the\nmalware developer.\n\n## INITIAL ANALYSIS\n\nA quick analysis with TrID, developed by Marco Pontello, shows us that the file is likely in\nextensible markup language (XML) format.\n\n\n-----\n\n## USING ZIPDUMP AND XMLDUMP\n\nzipdump.py is one of the many tools developed by Didier Stevens. It is useful in this instance\nbecause files in XML format are technically zip files. Running the command displayed in the\nscreenshot below lists the underlying streams.\n\nTo get started, I chose stream 4 since it's listed as the workbook. Piping the output to\nxmldump.py (also developed by Didier Stevens) with the 'pretty' parameter gives us a more\nreadable result.\n\nIn the result we see 2 references under the \"sheets\" tag: one to Macro1, and another to\nSheet1. We also see that for each of the entries there's an \"r:id.\" Looking up these ID\nnumbers in the rels stream will tell us what these sheets are pointing to.\n\n\n-----\n\nFirst we'll take a look at \"rId1,\" which is associated with Macro1. This points to the stream\n\"macrosheets/sheet1.xml.' \"rId2,\" associated with Sheet1, points to \"worksheets/sheet1.xml.\"\nGoing back to the original zipdump.py output, we see that \"macrosheets/sheet1.xml\" is\nstream 13, so we select it for review and pipe it to xmldump for a cleaner output.\n\n\n-----\n\nA more condensed output can be achieved in this circumstance by using celltext instead of\n\"pretty\" for the xmldump parameter:\n\nOn the left of the output you can see the cell in the sheet where the text to its right is found.\nWe can kind of figure out what some of the data here is, but we can use xlmdeobfuscator\n(developed by Malwrologist) to get a clearer glimpse.\n\n## XLMDEOBFUSCATOR FOR CLARITY\n\nThe tool will ask for an entry point that includes the sheet name and the cell to start on. I\npassed it the name of the sheet (Macro1) followed by the first cell listed as having data in the\nzipdump output we saw above (F14) .\n\nWe now have some initial IOCs to make a note of, particularly the following file path:\n\n\n-----\n\n_C:\\ProgramData\\RZciQoqRVKyOIRh.vbs_\n\n## TIME TO MANIPULATE SOME CODE\n\nIf we look at the entry for cell F39, we see that it references Sheet1. If you recall, Sheet1 is\nthe other sheet listed in the workbook stream and we know has some relevance to function\nof the file so far. If we run the following command grabbing the celltext from the stream\nwhere xl/worksheets/sheet1 resides, we get a ton of entries that look like this:\n\nHere we see the cell column and row, a set of quotes, and a number. My inference is that\neach cell contains a character, and this is charcode. Using sed and tr, we clean up the char\ncode to get just the numbers and remove the new line characters:\n\n\n-----\n\nCopying everything except the Reference, Formula, Value at the beginning of the text, and\nputting it into a tool that can convert this from charcode to ASCII (CyberChef works great,\nthere are other resources online), we get the following:\n\nThis now looks a lot more like a VBA script. There's still some residual characters that need\nswapped over to ASCII, and a lot of the ampersands and quotes can be removed to make\nthis more human readable. The objective in my analysis is not to arrive at code that can still\nrun, but rather code that I can easily read and therefore deduce what functionality it has.\nSnapshots from some of that cleanup are below:\n\nAmpersands and quotes removed:\n\n\n-----\n\nThe last thing I did was start converting the \"gibberish\" seeming variable and function names\nto something that made sense. For example, I renamed the variable \"EMHPXpkoyrz\" to\n\"UserDomainString\" because that's the data it contains. Aside from variable declarations and\nfunction definitions, the code below is the actual \"meat and potatoes\" functionality of this\nscript.\n\n\n-----\n\nIn layman's terms, the code checks and sees if the \".bin\" file exists. If it does not, then for\neach URL in the array at line 50, it will initiate a GET request for the \".bin\" files identified in\nthe URLs. The InternetFunction(MSXMLServerCreation) value of 1 comes from the function\nstarting at line 33. If the GET request responds with a status code 200, meaning \"OK,\" then it\nwill save the \".bin\" file as identified in line 39. Jumping back down to line 55, with a value of\n1, the code will then execute several Wmic Process Calls for regsvr32 and rundll32 to\nexecute the \".bin\" file downloaded and therefore execute the next stage of the malware.\n\n## IOCs FOR THIS DRIDEX SAMPLE\n\n**File type: OOXML**\n\n**File hash: 77ea99933030294970a8d11a20f0fab4e540133931e91358d2dde3b97d6a521d**\n\n**Files it writes/renames downloaded files:**\n\nC:\\ProgramData\\mhunigger.bin\n\n**Files it downloads:**\n\nReMxcvxKeOzodickpenis.bin\n\nZvdFNlHdickpenis.bin\n\nCdNiUWXvKRUbUidickpenis.bin\n\n**Domain file downloads from:**\n\nhttps://caioaraujo[.]vip\n\n## TOOLS AND DOCUMENTATION\n\n[TrID](https://www.blogger.com/u/0/blog/post/edit/8377069834909459034/2523301002024575880#)\n\n[zipdump.py](https://www.blogger.com/u/0/blog/post/edit/8377069834909459034/2523301002024575880#)\n\n\n-----\n\n[xmldump.py](https://www.blogger.com/u/0/blog/post/edit/8377069834909459034/2523301002024575880#)\n\n[xlmdeobfuscator](https://www.blogger.com/u/0/blog/post/edit/8377069834909459034/2523301002024575880#)\n\n[CyberChef](https://www.blogger.com/u/0/blog/post/edit/8377069834909459034/2523301002024575880#)\n\n## REFERENCES\n\n[Indrik Spider (ThaiCERT)](https://www.blogger.com/u/0/blog/post/edit/8377069834909459034/2523301002024575880#)\n\n[TA505 (MITRE)](https://www.blogger.com/u/0/blog/post/edit/8377069834909459034/2523301002024575880#)\n\nBig Game Hunting: The Evolution of INDRIK SPIDER From Dridex Wire Fraud to BitPaymer\nTargeted Ransomware (CrowdStrike)\n\n[Dridex - 2021 Threat Detection Report - Red Canary (Red Canary)](https://www.blogger.com/u/0/blog/post/edit/8377069834909459034/2523301002024575880#)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-09 - Malware Headliners- Dridex.pdf"
    ],
    "report_names": [
        "2022-01-09 - Malware Headliners- Dridex.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d706edf6-cb86-4611-99e1-4b464e9dc5b9",
            "created_at": "2023-01-06T13:46:38.839083Z",
            "updated_at": "2025-03-27T02:00:02.93205Z",
            "deleted_at": null,
            "main_name": "INDRIK SPIDER",
            "aliases": [],
            "source_name": "MISPGALAXY:INDRIK SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b296f34c-c424-41da-98bf-90312a5df8ef",
            "created_at": "2024-06-19T02:03:08.027585Z",
            "updated_at": "2025-03-27T02:05:17.350153Z",
            "deleted_at": null,
            "main_name": "GOLD DRAKE",
            "aliases": [
                "Indrik Spider ",
                "Evil Corp"
            ],
            "source_name": "Secureworks:GOLD DRAKE",
            "tools": [
                " Cobalt Strike",
                " Covenant",
                " Donut",
                " Dridex",
                " Hades",
                " Koadic",
                " LockBit",
                " Macaw Locker",
                " Mimikatz",
                " Payload.Bin",
                " Phoenix CryptoLocker",
                " PowerSploit",
                " Powershell Empire",
                " SocGholish",
                " WastedLocker",
                "BitPaymer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535567,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1653820529,
    "ts_modification_date": 1653820529,
    "files": {
        "pdf": "https://archive.orkl.eu/5aaa72c65b3cf59c272d757da326385df9544685.pdf",
        "text": "https://archive.orkl.eu/5aaa72c65b3cf59c272d757da326385df9544685.txt",
        "img": "https://archive.orkl.eu/5aaa72c65b3cf59c272d757da326385df9544685.jpg"
    }
}