{
    "id": "2e40232b-87a2-4076-b3a3-0e282dde6ae0",
    "created_at": "2023-01-12T15:07:26.904362Z",
    "updated_at": "2025-03-27T02:05:56.18939Z",
    "deleted_at": null,
    "sha1_hash": "513e8b76368c70a5d19e30bbe83d7bbf24bf2eb3",
    "title": "2020-06-02 - In-depth analysis of the new Team9 malware family",
    "authors": "",
    "file_creation_date": "2022-05-28T17:14:06Z",
    "file_modification_date": "2022-05-28T17:14:06Z",
    "file_size": 221817,
    "plain_text": "# In-depth analysis of the new Team9 malware family\n\n**[blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/](https://blog.fox-it.com/2020/06/02/in-depth-analysis-of-the-new-team9-malware-family/)**\n\n_Author: Nikolaos Pantazopoulos_\n\n_[Co-author: Stefano Antenucci (@Antelox)](https://twitter.com/antelox)_\n\n_And in close collaboration with NCC’s RIFT._\n\n## 1. Introduction\n\n\nJune 2, 2020\n\n\n[Publicly discovered in late April 2020, the Team9 malware family (also known as ‘Bazar [1]’) appears to](https://www.bleepingcomputer.com/news/security/bazarbackdoor-trickbot-gang-s-new-stealthy-network-hacking-malware/)\nbe a new malware being developed by the group behind Trickbot. Even though the development of the\nmalware appears to be recent, the developers have already developed two components with rich\nfunctionality. The purpose of this blog post is to describe the functionality of the two components, the\nloader and the backdoor.\n\n_About the Research and Intelligence Fusion Team (RIFT):_\nRIFT leverages our strategic analysis, data science, and threat hunting capabilities to create\nactionable threat intelligence, ranging from IOCs and detection rules to strategic reports on\ntomorrow’s threat landscape. Cyber security is an arms race where both attackers and defenders\ncontinually update and improve their tools and ways of working. To ensure that our managed services\nremain effective against the latest threats, NCC Group operates a Global Fusion Center with Fox-IT\nat its core. This multidisciplinary team converts our leading cyber threat intelligence into powerful\ndetection strategies.\n\n## 2. Early variant of Team9 loader\n\nWe assess that this is an earlier variant of the Team9 loader\n(35B3FE2331A4A7D83D203E75ECE5189B7D6D06AF4ABAC8906348C0720B6278A4) because of its\nsimplicity and the compilation timestamp. The other variant was compiled more recently and has\nadditional functionality. It should be noted that in very early versions of the loader binaries\n(2342C736572AB7448EF8DA2540CDBF0BAE72625E41DAB8FFF58866413854CA5C), the\ndevelopers were using the Windows BITS functionality in order to download the backdoor. However, we\nbelieve that this functionality has been dropped.\n\nBefore proceeding to the technical analysis part, it is worth mentioning that the strings are not\nencrypted. Similarly, the majority of the Windows API functions are not loaded dynamically.\n\n\n-----\n\nWhen the loader starts its execution, it checks if another instance of itself has infected the host already\nby attempting to read the value ‘BackUp Mgr’ in the ‘Run’ registry key\n‘Software\\Microsoft\\Windows\\CurrentVersion\\Run’ (Figure 1). If it exists, it validates if the current\nloaders file path is the same as the one that has already been set in the registry value’s data (BackUp\nMgr). Assuming that all of the above checks were successful, the loader proceeds to its core\nfunctionality.\n\n**Figure 1 – Loader verifies if it has already infect the host**\n\nHowever, if any of the above checks do not meet the requirements then the loader does one of the\nfollowing actions:\n\n1. Copy itself to the %APPDATA%\\Microsoft folder, add this file path in the registry ‘Run’ key under\n\nthe value ‘BackUp Mgr’ and then execute the loader from the copied location.\n2. If the loader cannot access the %APPDATA% location or if the loader is running from this location\n\nalready, then it adds the current file path in the ‘Run’ registry key under the value ‘BackUp Mgr’\nand executes the loader again from this location.\n\nWhen the persistence operation finishes, the loader deletes itself by writing a batch file in the Windows\ntemporary folder with the file name prefix ‘tmp’ followed by random digits. The batch file content:\n```\n@echo off\nset Module=%1\n:Repeat\ndel %Module%\nif exist %Module% goto Repeat\ndel %0\n\n```\nNext, the loader fingerprints the Windows architecture. This is a crucial step because the loader needs\nto know what version of the backdoor to download (32-bit or 64-bit). Once the Windows architecture has\nbeen identified, the loader carries out the download.\n\nThe core functionality of the loader is to download the Team9 backdoor component. The loader contains\ntwo ‘.bazar’ top-level domains which point to the Team9 backdoor. Each domain hosts two versions of\nthe Team9 backdoor on different URIs, one for each Windows architecture (32-bit and 64-bit), the use of\ntwo domains is highly likely to be a backup method.\n\nAny received files from the command and control server are sent in an encrypted format. In order to\ndecrypt a file, the loader uses a bitwise XOR decryption with the key being based on the infected host’s\nsystem time (Year/Month/Day) (Figure 2).\n\n\n-----\n\n**Figure 2 – Generate XOR key based on infected host’s time**\n\nAs a last step, the loader verifies that the executable file was decrypted successfully by validating the\nPE headers. If the Windows architecture is 32-bit, the loader injects the received executable file into\n‘calc.exe’ (Windows calculator) using the ‘Process Hollowing’ technique. Otherwise, it writes the\nexecutable file to disk and executes it.\n\nThe following tables summarises the identified bazar domains and their URIs found in the early variants\nof the loader.\n\n**URI** **Description**\n\n/api/v108 Possibly downloads the 64-bit version of the Team9 backdoor\n\n/api/v107 Possibly downloads the 32-bit version of the Team9 backdoor\n\n/api/v5 Possibly downloads an updated 32-bit version of the Team9 loader\n\n/api/v6 Possibly downloads an updated 64-bit version of the Team9 loader\n\n/api/v7 Possibly downloads the 32-bit version of the Team9 backdoor\n\n/api/v8 Possibly downloads the 64-bit version of the Team9 backdoor\n\n**Table 1 – Bazar URIs found in early variants of the loader**\n\nThe table below (table 2) summarises the identified domains found in the early variants of the loader.\n\n**Bazar domains**\n\nbestgame[.]bazar\n\nforgame[.]bazar\n\nzirabuo[.]bazar\n\ntallcareful[.]bazar\n\ncoastdeny[.]bazar\n\n**Table 2 – Bazar domains found in early variants of the loader**\n\nLastly, another interesting observation is the log functionality in the binary file that reveals the following\nproject file path:\n\n\n-----\n\n```\nd:\\\\development\\\\team9\\\\team9_restart_loader\\\\team9_restart_loader\n\n## 3. Latest variant of Team9 loader\n\n```\nIn this section, we describe the functionality of a second loader that we believe to be the latest variant of\nthe aforementioned Team9 loader. This assessment is based on three factors:\n\n1. Similar URIs in the backdoor requests\n2. Similar payload decryption technique\n3. Similar code blocks\n\nUnlike its previous version, the strings are encrypted and the majority of Windows API functions are\nloaded dynamically by using the Windows API hashing technique.\n\nOnce executed, the loader uses a timer in order to delay the execution. This is likely used as an antisandbox method. After the delayed time has passed, the loader starts executing its core functionality.\n\nBefore the malware starts interacting with the command and control server, it ensures that any other\nrelated files produced by a previous instance of the loader will not cause any issues. As a result the\nloader appends the string ‘_lyrt’ to its current file path and deletes any file with this name. Next, the\nloader searches for the parameter ‘-p’ in the command line and if found, it deletes the scheduled task\n‘StartDT’. The loader creates this scheduled task later for persistence during execution. The loader also\nattempts to execute hijacked shortcut files, which will eventually execute an instance of Team9 loader.\nThis functionality is described later.\n\nThe loader performs a last check to ensure that the operating systems keyboard and language settings\nare not set to Russian and creates a mutex with a hardcoded name ‘ld_201127’. The latter is to avoid\ndouble execution of its own instance.\n\nAs mentioned previously, the majority of Windows API functions are loaded dynamically. However, in an\nattempt to bypass any API hooks set by security products, the loader manually loads ‘ntdll’ from disk,\nreads the opcodes from each API function and compares them with the ones in memory (Figure 3). If\nthe opcodes are different, the loader assumes a hook has been applied and removes it. This applies\nonly to 64-bit samples reviewed to date.\n\n**Figure 3 – Scan for hooks in Windows API functions**\n\nThe next stage downloads from the command and control server either the backdoor or an updated\nversion of the loader. It is interesting to note that there are minor differences in the loader’s execution\nbased on the identified Windows architecture and if the ‘-p’ parameter has been passed into the\ncommand line.\n\n\n-----\n\nAssuming that the -p parameter has not been passed into the command line, the loader has two loops.\nOne for 32-bit and the other for 64-bit, which download an updated version of the loader. The main\ndifference between the two loops is that in case of a Windows x64 infection, there is no check of the\nloader’s version.\n\nThe download process is the same with the previous variant, the loader resolves the command and\ncontrol server IP address using a hardcoded list of DNS servers and then downloads the corresponding\nfile. An interesting addition, in the latest samples, is the use of an alternative command and control\nserver IP address, in case the primary one fails. The alternative IP address is generated by applying a\nbitwise XOR operation to each byte of the resolved command and control IP address with the byte\n0xFE. In addition, as a possible anti-behaviour method, the loader verifies that the command and\ncontrol server IP address is not ‘127.0.0.1’. Both of these methods are also present in the latest Team9\nbackdoor variants.\n\nAs with the previous Team9 loader variant, the command and control server sends back the binary files\nin an encrypted format. The decryption process is similar with its previous variant but with a minor\nchange in the XOR key generation, the character ‘3’ is added between each hex digit of the day format\n(Figure 4). For example:\n```\n332330332330330335331338 (ASCII format, host date: 2020-05-18)\n\n```\n**Figure 4 – Add the character ‘3’ in the generated XOR key**\n\nIf the ‘-p’ parameter has been passed into the command line, the loader proceeds to download the\nTeam9 backdoor directly from the command and control server. One notable addition is the process\ninjection (hollow process injection) when the backdoor has been successfully downloaded and\ndecrypted. The loader injects the backdoor to one of the following processes:\n\n1. Svchost\n2. Explorer\n3. cmd\n\nWhenever a binary file is successfully downloaded and properly decrypted, the loader adds or updates\nits persistence in the infected host. The persistence methods are available in table 3.\n\n\n**Persistence**\n**Method**\n\nScheduled\ntask\n\n\n**Persistence Method Description**\n\nThe loader creates two scheduled tasks, one for the updated loader (if any) and one\nfor the downloaded backdoor. The scheduled task names and timers are different.\n\n\n-----\n\nWinlogon\nhijack\n\nShortcut in\nthe Startup\nfolder\n\nHijack\nalready\nexisting\nshortcuts\n\n\nAdd the malware’s file path in the ‘Userinit’ registry value. As a result, whenever the\nuser logs in the malware is also executed.\n\nThe loaders creates a shortcut, which points to the malware file, in the Startup folder.\nThe name of the shortcut is ‘adobe’.\n\nThe loader searches for shortcut files in Desktop and its subfolders. If it finds one then\nit copies the malware into the shortcut’s target location with the application’s file name\nand appends the string ‘__’ at the end of the original binary file name. Furthermore,\nthe loader creates a ‘.bin’ file which stores the file path, file location and parameters.\nThe ‘.bin’ file structure can be found in the Appendix section. When this structure is\nfilled in with all required information, It is encrypted with the XOR key 0x61.\n\n\n**Table 3 – Persistence methods loader**\n\nThe following tables summarises the identified bazar domains and their URIs for this Team9 loader\nvariant.\n\n**URI** **Description**\n\n/api/v117 Possibly downloads the 32-bit version of the Team9 loader\n\n/api/v118 Possibly downloads the 64-bit version of the Team9 loader\n\n/api/v119 Possibly downloads the 32-bit version of the Team9 backdoor\n\n/api/v120 Possibly downloads the 64-bit version of the Team9 backdoor\n\n/api/v85 Possibly downloads the 32-bit version of the Team9 loader\n\n/api/v86 Possibly downloads the 64-bit version of the Team9 loader\n\n/api/v87 Possibly downloads the 32-bit version of the Team9 backdoor\n\n/api/v88 Possibly downloads the 64-bit version of the Team9 backdoor\n\n**Table 4 – Identified URIs for Team9 loader variant**\n\n**Bazar domain**\n\nbestgame[.]bazar\n\nforgame[.]bazar\n\n**Table 5 – Identified domains for Team9 loader variant**\n\n## 4. Team9 backdoor\n\nWe are confident that this is the backdoor which the loader installs onto the compromised host. In\naddition, we believe that the first variants of the Team9 backdoor started appearing in the wild in late\nMarch 2020. Each variant does not appear to have major changes and the core of the backdoor\nremains the same.\n\n\n-----\n\nDuring analysis, we identified the following similarities between the backdoor and its loader:\n\n1. Creates a mutex with a hardcoded name in order to avoid multiple instances running at the same\n\ntime (So far the mutex names which we have identified are ‘mn_185445’ and ‘{589b7a4a-37764e82-8e7d-435471a6c03c}’)\n2. Verifies that the keyboard and the operating system language is not Russian\n3. Use of Emercoin domains with a similarity in the domain name choice\n\nFurthermore, the backdoor generates a unique ID for the infected host. The process that it follows is:\n\n1. Find the creation date of ‘C:\\Windows’ (Windows FILETIME structure format). The result is then\n\nconverted from a hex format to an ASCII representation. An example is shown in figures 5 (before\nconversion) and 6 (after conversion).\n2. Repeat the same process but for the folder ‘C:\\Windows\\System32’\n3. Append the second string to the first with a bullet point as a delimiter. For example, 01d3d1d8\n\nb10c2916.01d3d1d8 b5b1e079\n4. Get the NETBIOS name and append it to the previous string from step 3 along with a bullet point\n\nas a delimiter. For example: 01d3d1d8 b10c2916.01d3d1d8 b5b1e079.DESKTOP-4123EEB.\n5. Read the volume serial number of C: drive and append it to the previous string. For example:\n\n01d3d1d8 b10c2916.01d3d1d8 b5b1e079.DESKTOP-SKCF8VA.609fbbd5\n6. Hash the string from step 5 using the MD5 algorithm. The output hash is the bot ID.\n\nNote: In a few samples, the above algorithm is different. The developers use hard-coded dates, the\nWindows directory file paths in a string format (‘C:\\Windows’ and ‘C:\\Windows\\system32’) and the\nNETBIOS name. Based on the samples’ functionality, there are many indications that these binary files\nwere created for debugging purposes.\n\n**Figure 5 – Before conversion**\n\n**Figure 6 – After conversion**\n\n### 4.1 Network communication\n\nThe backdoor appears to support network communication over ports 80 (HTTP) and 443(HTTPS). In\nrecent samples, a certificate is issued from the infected host for communication over HTTPS. Each\nrequest to the command and control server includes at least the following information:\n\n1. A URI path for requesting tasks (/2) or sending results (/3).\n2. Group ID. This is added in the ‘Cookie’ header.\n\nLastly, unlike the loader which decrypts received network replies from the command and control server\nusing the host’s date as the key, the Team9 backdoor uses the bot ID as the key.\n\n### 4.2 Bot commands\n\nThe backdoor supports a variety of commands These are summarised in the table below\n\n\n-----\n\n**Command**\n**ID**\n\n\n**Description** **Parameters**\n\n\n0 Set delay time for the command and\ncontrol server requests\n\n\nTime to delay the requests\n\n\n1 Collect infected host information Memory buffer to fill in the collected\ndata\n\n\n10 Download file from an address and inject\ninto a process using either hollowing\nprocess injection or Doppelgänging\nprocess injection\n\n\nDWORD value that represents the\ncorresponding execution method.\nThis includes:\n\nProcess hollowing injection\nProcess Doppelgänging\ninjection\nWrite the file into disk and\nexecute it\nProcess mask – DWORD value that\nrepresents the process name to\ninject the payload. This can be one\nof the following:\n\n1. Explorer\n2. Cmd\n3. Calc (Not used in all variants)\n4. Svchost\n5. notepad\nAddress from which the file is\ndownloaded\nCommand line\n\n\n11 Download a DLL file and execute it Timeout value\nAddress to download the DLL\nCommand line\nTimeout time\n\n\n12 Execute a batch file received from the\ncommand and control server\n\n13 Execute a PowerShell script received from\nthe command and control server\n\n14 Reports back to the command and control\nserver and terminates any handled tasks\n\n\nDWORD value to determine if the\nbatch script is to be stored into a\nWindows pipe (run from memory) or\nin a file into disk\nTimeout value.\nBatch file content\n\nDWORD value to determine if the\nPowerShell script is to be stored into\na Windows pipe (run from memory)\nor in a file into disk\nTimeout value.\nPowerShell script content\n\n\nNone\n\n\n-----\n\n15 Terminate a process PID of the process to terminate\n\n\n16 Upload a file to the command and control\nserver. Note: Each variant of the backdoor\nhas a set file size they can handle.\n\n100 Remove itself None\n\n**Table 6 – Supported backdoor commands**\n\n\nPath of the file to read and upload to\nthe command and control server.\n\n\nTable 7 summarises the report structure of each command when it reports back (POST request) to the\ncommand and control server. Note: In a few samples, the backdoor reports the results to an additional\nIP address (185.64.106[.]73) If it cannot communicate with the Bazar domains.\n\n**Command ID/Description** **Command execution results structure**\n\n1/ Collect infected host information The POST request includes the following\ninformation:\n\nOperating system information\nOperating system architecture\nNETBIOS name of the infected host\nUsername of the infected user\nBackdoor’s file path\nInfected host time zone\nProcesses list\nKeyboard language\nAntivirus name and installed applications\nInfected host’s external IP\nShared drives\nShared drives in the domain\nTrust domains\nInfected host administrators\nDomain admins\n\n11/ Download a DLL file and execute it The POST request includes the following\nparameters:\n\nCommand execution errors (Passed in the\nparameter ‘err’)\nProcess identifier (Passed in the ‘pid’\nparameter)\nCommand execution output (Passed in the\nparameter ‘stdout’, if any)\nAdditional information from the command\nexecution (Passed in the parameter ‘msg’, if\nany)\n\n\n12/ Execute a batch file received from the\ncommand and control server\n\n13/ Execute a PowerShell script received from\nthe command and control server\n\n\nSame as the previous command (11/ Download a\nDLL file and execute it)\n\nSame as the previous command (11/ Download a\nDLL file and execute it)\n\n\n-----\n\n14/ Reports back to the command and control\nserver and terminate any handled tasks\n\n\nPOST request with the string ‘ok’\n\n\n15/ Terminate a process Same as the previous command (11/ Download a\nDLL file and execute it)\n\n\n16/ Upload a file to the command and control\nserver\n\n\nNo parameters. The file’s content is sent in a POST\nrequest.\n\n\n100/ Remove itself POST request with the string ‘ok’ or ‘process\ntermination error’\n\n**Table 7 – Report structure**\n\n## 5. Appendix\n\n### 5.1 struct shortcut_bin\n```\nstruct shortcut_bin \n{\nBYTE junk_data[434];\nBYTE file_path[520];\nBYTE filepath_dir[520];\nBYTE file_loader_parameters[1024];\n};\n\n 5.2 IOCs\n\n```\n**File hashes**\n\n**Description** **SHA-256 Hash**\n\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\n\n4F258184D5462F64C3A752EC25FB5C193352C34206022C0755E48774592B7707\n\nB10DCEC77E00B1F9B1F2E8E327A536987CA84BCB6B0C7327C292F87ED603837D\n\n363B6E0BC8873A6A522FE9485C7D8B4CBCFFA1DA61787930341F94557487C5A8\n\nF4A5FE23E21B6B7D63FA2D2C96A4BC4A34B40FD40A921B237A50A5976FE16001\n\nA0D0CFA8BF0BC5B8F769D8B64EAB22D308B108DD8A4D59872946D69C3F8C58A5\n\n\n-----\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x64)\n\nTeam9\nbackdoor\n(x86)\n\nTeam9\nbackdoor\n(x86)\n\nTeam9\nbackdoor\n(x86)\n\nTeam9\nbackdoor\n(x86)\n\nTeam9\nbackdoor\n(x86)\n\nTeam9\nbackdoor\n(x86)\n\nTeam9\nbackdoor\n(x86)\n\n\n059519E03772D6EEEA9498625AE8B8B7CF2F01FC8179CA5D33D6BCF29D07C9F4\n\n0F94B77892F22D0A0E7095B985F30B5EDBE17AB5B8D41F798EF0C708709636F4\n\n2F0F0956628D7787C62F892E1BD9EDDA8B4C478CF8F1E65851052C7AD493DC28\n\n37D713860D529CBE4EAB958419FFD7EBB3DC53BB6909F8BD360ADAA84700FAF2\n\n3400A7DF9EC3DC8283D5AC7ACCB6935691E93FEDA066CC46C6C04D67F7F87B2B\n\n5974D938BC3BBFC69F68C979A6DC9C412970FC527500735385C33377AB30373A\n\nC55F8979995DF82555D66F6B197B0FBCB8FE30B431FF9760DEAE6927A584B9E3\n\n94DCAA51E792D1FA266CAE508C2C62A2CA45B94E2FDFBCA7EA126B6CD7BC5B21\n\n4EE0857D475E67945AF2C5E04BE4DEC3D6D3EB7C78700F007A7FF6F8C14D4CB3\n\n8F552E9CA2BEDD90CE9935A665758D5DE2E86B6FDA32D98918534A8A5881F91A\n\nAE7DAA7CE3188CCFE4069BA14C486631EEA9505B7A107A17DDEE29061B0EDE99\n\nF3C6D7309F00CC7009BEA4BE6128F0AF2EA6B87AB7A687D14092F85CCD35C1F5\n\n6CBF7795618FB5472C5277000D1C1DE92B77724D77873B88AF3819E431251F00\n\nB0B758E680E652144A78A7DDECC027D4868C1DC3D8D7D611EC4D3798358B0CE5\n\n\n-----\n\nTeam9\nbackdoor\n(x86)\n\nTeam9\nbackdoor\n(x86)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x64)\n\nTeam9\nloader (x86)\n\nTeam9\nloader (x86)\n\nTeam9\nloader (x86)\n\nTeam9\nloader (x86)\n\nTeam9\nloader (x86)\n\n\n959BA7923992386ABF2E27357164672F29AAC17DDD4EE1A8AD4C691A1C566568\n\n3FE61D87C9454554B0CE9101F95E18ABAD8AC6C62DCC88DC651DDFB20568E060\n\nB3764EF42D526A1AE1A4C3B0FE198F35C6BC5C07D5F155D15060B94F8F6DC695\n\n210C51AAB6FC6C52326ECE9DBD3DDAB5F58E98432EF70C46936672C79542FBD0\n\n11B5ADAEFD04FFDACEB9539F95647B1F51AEC2117D71ECE061F15A2621F1ECE9\n\n534D60392E0202B24D3FDAF992F299EF1AF1FB5EFEF0096DD835FE5C4E30B0FA\n\n9D3A265688C1A098DD37FE77C139442A8EB02011DA81972CEDDC0CF4730F67CF\n\nCE478FDBD03573076394AC0275F0F7027F44A62A306E378FE52BEB0658D0B273\n\n5A888D05804D06190F7FC408BEDE9DA0423678C8F6ECA37ECCE83791DE4DF83D\n\nEB62AD35C613A73B0BD28C1779ACE80E2BA587A7F8DBFEC16CF5BF520CAA71EE\n\nA76426E269A2DEFABCF7AEF9486FF521C6110B64952267CFE3B77039D1414A41\n\n65CDBDD03391744BE87AC8189E6CD105485AB754FED0B069A1378DCA3E819F28\n\n38C9C3800DEA2761B7FAEC078E4BBD2794B93A251513B3F683AE166D7F186D19\n\n8F8673E6C6353187DBB460088ADC3099C2F35AD868966B257AFA1DF782E48875\n\n35B3FE2331A4A7D83D203E75ECE5189B7D6D06AF4ABAC8906348C0720B6278A4\n\n65E44FC8527204E88E38AB320B3E82694D1548639565FDAEE53B7E0F963D3A92\n\nF53509AF91159C3432C6FAF4B4BE2AE741A20ADA05406F9D4E9DDBD48C91EBF9\n\n73339C130BB0FAAD27C852F925AA1A487EADF45DF667DB543F913DB73080CD5D\n\n2342C736572AB7448EF8DA2540CDBF0BAE72625E41DAB8FFF58866413854CA5C\n\n\n-----\n\nTeam9\nloader (x86)\n\nTeam9\nloader (x86)\n\nTeam9\nloader (x86)\n\nTeam9\nloader (x86)\n\nTeam9\nloader (x86)\n\n\n079A99B696CC984375D7A3228232C44153A167C1936C604ED553AC7BE91DD982\n\n0D8AEACF4EBF227BA7412F8F057A8CDDC54021846092B635C8D674B2E28052C6\n\nF83A815CE0457B50321706957C23CE8875318CFE5A6F983A0D0C580EBE359295\n\n3FA209CD62BACC0C2737A832E5F0D5FD1D874BE94A206A29B3A10FA60CEB187D\n\n05ABD7F33DE873E9630F9E4F02DBD0CBC16DD254F305FC8F636DAFBA02A549B3\n\n\n**Table 8 – File hashes**\n\n**Identified Emercoin domains**\n\n**Domains**\n\nnewgame[.]bazar\n\nthegame[.]bazar\n\nportgame[.]bazar\n\nworkrepair[.]bazar\n\nrealfish[.]bazar\n\neventmoult[.]bazar\n\nbestgame[.]bazar\n\nforgame[.]bazar\n\nZirabuo[.]bazar\n\n**Table 9 – Identified Emercoin domains**\n\n**Command and Control IPs**\n\n**C&C IPs**\n\n34.222.222[.]126\n\n71.191.52[.]192\n\n77.213.120[.]90\n\n179[.]43.134.164\n\n185[.]65.202.62\n\n220[.]32.32.128\n\n\n-----\n\n34[.]222.222.126\n\n51[.]81.113.26\n\n71[.]191.52.192\n\n77[.]213.120.90\n\n85[.]204.116.58\n\n**Table 10 – Command and Control IPs**\n\n**Identified DNS IPs**\n\n**DNS IPs**\n\n51[.]254.25.115\n\n193[.]183.98.66\n\n91[.]217.137.37\n\n87[.]98.175.85\n\n185[.]121.177.177\n\n169[.]239.202.202\n\n198[.]251.90.143\n\n5[.]132.191.104\n\n111[.]67.20.8\n\n163[.]53.248.170\n\n142[.]4.204.111\n\n142[.]4.205.47\n\n158[.]69.239.167\n\n104[.]37.195.178\n\n192[.]99.85.244\n\n158[.]69.160.164\n\n46[.]28.207.199\n\n31[.]171.251.118\n\n81[.]2.241.148\n\n82[.]141.39.32\n\n50[.]3.82.215\n\n\n-----\n\n46[.]101.70.183\n\n5[.]45.97.127\n\n130[.]255.78.223\n\n144[.]76.133.38\n\n139[.]59.208.246\n\n172[.]104.136.243\n\n45[.]71.112.70\n\n163[.]172.185.51\n\n5[.]135.183.146\n\n51[.]255.48.78\n\n188[.]165.200.156\n\n147[.]135.185.78\n\n92[.]222.97.145\n\n51[.]255.211.146\n\n159[.]89.249.249\n\n104[.]238.186.189\n\n139[.]59.23.241\n\n94[.]177.171.127\n\n45[.]63.124.65\n\n212[.]24.98.54\n\n178[.]17.170.179\n\n185[.]208.208.141\n\n82[.]196.9.45\n\n146[.]185.176.36\n\n89[.]35.39.64\n\n89[.]18.27.167\n\n77[.]73.68.161\n\n185[.]117.154.144\n\n176[.]126.70.119\n\n\n-----\n\n139[.]99.96.146\n\n217[.]12.210.54\n\n185[.]164.136.225\n\n192[.]52.166.110\n\n63[.]231.92.27\n\n66[.]70.211.246\n\n96[.]47.228.108\n\n45[.]32.160.206\n\n128[.]52.130.209\n\n35[.]196.105.24\n\n172[.]98.193.42\n\n162[.]248.241.94\n\n107[.]172.42.186\n\n167[.]99.153.82\n\n138[.]197.25.214\n\n69[.]164.196.21\n\n94[.]247.43.254\n\n94[.]16.114.254\n\n151[.]80.222.79\n\n176[.]9.37.132\n\n192[.]71.245.208\n\n195[.]10.195.195\n\n**Table 11 – Identified DNS IPs**\n\n**Mutexes**\n\n**Component** **Mutex name**\n\nTeam9 backdoor mn_185445\n\nTeam9 backdoor {589b7a4a-3776-4e82-8e7d-435471a6c03c}\n\nTeam9 loader ld_201127\n\n**Table 12 – Mutex names Team9 components**\n\n\n-----\n\n**Host IOCs**\n\n1. Files ending with the string ‘_lyrt’\n2. Scheduled tasks with names ‘StartAT’ and ‘StartDT’\n3. Shortcut with file name ‘adobe’ in the Windows ‘StartUp’ folder\n4. Registry value name ‘BackUp Mgr’ in the ‘Run’ registry key\n\n**Network detection**\n\nalert dns $HOME_NET any -> any 53 (msg:”FOX-SRT – Suspicious – Team9 Emercoin DNS Query\nObserved”; dns_query; content:”.bazar”; nocase; dns_query;\npcre:”/(newgame|thegame|portgame|workrepair|realfish|eventmoult|bestgame|forgame|zirabuo)\\.bazar/i”;\nthreshold:type limit, track by_src, count 1, seconds 3600; classtype:trojan-activity; metadata:created_at\n2020-05-28; metadata:ids suricata; sid:21003029; rev:3;)\n\n**Source(s):**\n\n[1] https://www.bleepingcomputer.com/news/security/bazarbackdoor-trickbot-gang-s-new-stealthynetwork-hacking-malware/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-02 - In-depth analysis of the new Team9 malware family.pdf"
    ],
    "report_names": [
        "2020-06-02 - In-depth analysis of the new Team9 malware family.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536046,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1653758046,
    "ts_modification_date": 1653758046,
    "files": {
        "pdf": "https://archive.orkl.eu/513e8b76368c70a5d19e30bbe83d7bbf24bf2eb3.pdf",
        "text": "https://archive.orkl.eu/513e8b76368c70a5d19e30bbe83d7bbf24bf2eb3.txt",
        "img": "https://archive.orkl.eu/513e8b76368c70a5d19e30bbe83d7bbf24bf2eb3.jpg"
    }
}