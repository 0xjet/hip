{
    "id": "e976f1c8-459b-4d7a-8fbd-8f63fd68ff69",
    "created_at": "2023-01-12T15:10:32.887039Z",
    "updated_at": "2025-03-27T02:08:00.044878Z",
    "deleted_at": null,
    "sha1_hash": "29a2188b70bf0143c2f52e91218f510dbc42c347",
    "title": "2022-06-30 - How to Expose a Potential Cybercriminal due to Misconfigurations",
    "authors": "",
    "file_creation_date": "2022-09-01T10:30:02Z",
    "file_modification_date": "2022-09-01T10:30:02Z",
    "file_size": 901155,
    "plain_text": "# How to expose a potential cybercriminal due to misconfigurations\n\n**[cybergeeks.tech/how-to-expose-a-potential-cybercriminal-due-to-misconfigurations](https://cybergeeks.tech/how-to-expose-a-potential-cybercriminal-due-to-misconfigurations)**\n\nSummary\n\nWe’ve investigated a new phishing campaign spreading malicious documents that exploit the\nCVE-2017-0199 and CVE-2017-11882 vulnerabilities.\n\nThe purpose of this campaign is to deploy the Lokibot stealer on the infected machines. In\nour investigation we found misconfigurations on the malicious domains that allowed us to\nidentify a hostname which was a name server for two scam domains registered in Brazil.\n\nWe believe that the owner of these domains might be involved in the malicious campaign.\n\nTechnical analysis\n\nWe begin the analysis with a document that impersonates the Romanian ANAF (National\nAgency for Fiscal Administration) called “Factura fiscala ANAF270622.xlsx” (SHA256:\n098335ca421ca8501fd243714fd02457ebbaa40dd6f91cf1ab61a58c415a27a0). The\ndocument was downloaded from https://app.any.run/tasks/e5624c90-9c9c-4f35-a80a3beed6370c35/.\n\nThe malicious document is a xlsx file that contains a blurred image which seems to be an\ninvoice, as highlighted below:\n\n\n-----\n\nFigure 1\nThe file is an encrypted Excel document with a common password (“VelvetSweatshop”), as\nshown below:\n\nFigure 2\n\nFigure 3\nUsing oledump it`s possible to determine that there is an embedded OLE object in the\ndocument:\n\n\n-----\n\nFigure 4\nThe document tries to exploit a vulnerability found in Microsoft Office and WordPad, that is\ndescribed in CVE-2017-0199 . If successful, the malware would download a file found at\nhttp[:]//itssotiny.com/fYYbO (returns 404 at this time). However, according to VirusTotal, the\nlink redirected to http[:]//192.3.239.42/document/77.doc (still active). Figure 5 reveals that\nthere are two documents hosted in the same location:\n\n\n-----\n\nFigure 5\nThe 77.doc file is an obfuscated RTF file, which exploits the another Microsoft Office\nvulnerability, CVE-2017-11882 :\n\nFigure 6\nThe rtfdump.py script is utilized to list groups and the structure of the RTF file:\n\nFigure 7\nThe Microsoft Equation Editor process that can be identified in the sandbox analysis is a\nstrong indicator that the vulnerability is indeed CVE-2017-11882, which is a vulnerability in\nMicrosoft Equation Editor (https://www.trendmicro.com/vinfo/us/security/news/vulnerabilitiesand-exploits/17-year-old-ms-office-flaw-cve-2017-11882-actively-exploited-in-the-wild).\n\nThe final stage consists of downloading the Lokibot stealer from\nhttp[:]//192.3.239.42/77/vbc.exe\n(https://www.virustotal.com/gui/file/d243ac3d475a2e3dad62640525d3b4f102bb8140cc84436\n\n\n-----\n\n3d61e95ea5fc4f8fb/detection).\n\nDue to the attacker’s mistake, phpinfo.php can be accessed by anybody and reveals crucial\ninformation about the potential attacker. As we can see in figure 8, the hostname is “WIN2NF07F1AQLT” and it runs on a Windows Server 2016 machine:\n\nFigure 8\nWe have expended the attacker’s infrastructure via OSINT. The following files/IP addresses\ncould be identified:\n\nhttp[:]//192.3.239.42/receipt/88.doc\n\nhttp[:]//192.3.239.42/receipt/99.doc\n\nhttp[:]//192.227.129.26/document/receipt.doc\n\nhttp[:]//192.3.239.42/office/100.doc\n\nhttp[:]//192.3.239.42/office/110.doc\n\n192.227.168.194, 107.175.218.40, 104.168.32.21, 104.168.32.14\n\nAs we can see in figure 9, the hostname is the same for a different domain:\n\nFigure 9\n\n\n-----\n\nWe have identified another hostname for an older campaign – WIN-3JS0MA784YQ :\n\nFigure 10\nWe’ve performed an OSINT investigation and found that the “WIN-2NF07F1AQLT” hostname\nappears as a name server for two domains registered in Brazil: Webcamer.com[.]br and\nCitydesconto.com[.]br. According to website.informer.com, these 2 domains were registered\nby an individual “Noe Yvert Etoua Evina” with the noeyvert@gmail.com email address:\n\nFigure\n\n11\nThese two domains seem to be scam domains. An individual with the same name appears in\nmultiple judicial processes on jusbrasil.com.br.\n\nIndicators of Compromise\n\nSHA256: 098335ca421ca8501fd243714fd02457ebbaa40dd6f91cf1ab61a58c415a27a0\n\nSHA256: d243ac3d475a2e3dad62640525d3b4f102bb8140cc844363d61e95ea5fc4f8fb\n\nIP addresses:\n\n192.3.239.42\n\n192.227.129.26\n\n\n-----\n\n192.227.168.194\n\n107.175.218.40\n\n104.168.32.21\n\n104.168.32.14\n\n103.207.39.127\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-30 - How to Expose a Potential Cybercriminal due to Misconfigurations.pdf"
    ],
    "report_names": [
        "2022-06-30 - How to Expose a Potential Cybercriminal due to Misconfigurations.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536232,
    "ts_updated_at": 1743041280,
    "ts_creation_date": 1662028202,
    "ts_modification_date": 1662028202,
    "files": {
        "pdf": "https://archive.orkl.eu/29a2188b70bf0143c2f52e91218f510dbc42c347.pdf",
        "text": "https://archive.orkl.eu/29a2188b70bf0143c2f52e91218f510dbc42c347.txt",
        "img": "https://archive.orkl.eu/29a2188b70bf0143c2f52e91218f510dbc42c347.jpg"
    }
}