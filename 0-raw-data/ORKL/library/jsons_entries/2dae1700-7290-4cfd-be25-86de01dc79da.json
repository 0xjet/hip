{
    "id": "2dae1700-7290-4cfd-be25-86de01dc79da",
    "created_at": "2023-01-12T15:02:16.438207Z",
    "updated_at": "2025-03-27T02:13:50.33266Z",
    "deleted_at": null,
    "sha1_hash": "cc4cf26ead69d176b434484fe62321f2efd35b66",
    "title": "2019-04-02 - Xwo - A Python-based bot scanner",
    "authors": "",
    "file_creation_date": "2022-05-27T21:37:51Z",
    "file_modification_date": "2022-05-27T21:37:51Z",
    "file_size": 538786,
    "plain_text": "# Xwo - A Python-based bot scanner\n\n**[alienvault.com/blogs/labs-research/xwo-a-python-based-bot-scanner](https://www.alienvault.com/blogs/labs-research/xwo-a-python-based-bot-scanner)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nApril 2, 2019 | [Tom Hegel](https://www.alienvault.com/blogs/author/tomhegel)\nJaime Blasco and Chris Doman collaborated on this blog.\n\n## Overview:\n\nRecently, AT&T Alien Labs identified a new malware family that is actively scanning for\nexposed web services and default passwords. Based on our findings we are calling it “Xwo” taken from its primary module name. It is likely related to the previously reported malware\nfamilies [Xbash and](https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/) [MongoLock.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-mongolock-immediately-deletes-files-formats-backup-drives)\n\n[Alien Labs initially identified Xwo being served from a server serving a file named xwo.exe.](https://otx.alienvault.com/indicator/hostname/bucket-chain.oss-cn-hongkong.aliyuncs.com)\nBelow are the initial technical findings of Xwo, while all associated indicators are in our Xwo\nOTX Pulse.\n\n## Xwo’s relation to MongoLock & XBash:\n\n[MongoLock is a ransomware that wipes MongoDB servers and demands a ransom paid to](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-mongolock-immediately-deletes-files-formats-backup-drives)\nthe attackers to recover their database. Both Xwo and MongoLock use similar Python-based\n[code, command and control (“C2”) domain naming, and have an overlap in C2 infrastructure.](https://otx.alienvault.com/indicator/hostname/s.rapid7.xyz)\n\n\n-----\n\nUnlike MongoLock, Xwo does not have any ransomware or exploitation capabilities, but\nrather sends stolen credentials and service access back to the C2 infrastructure.\n\nThe sample was created via PyInstaller and the original Python code can be easily recover\nusing [python_exe_unpack and](https://github.com/countercept/python-exe-unpacker) [uncompyle6. The python script of Xwo contains code copied](https://github.com/rocky/python-uncompyle6)\nfrom [XBash:](https://unit42.paloaltonetworks.com/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/)\n\nFigure 1: Xwo code (left) copied from Xbash (right)\n\n[As of this report, it is unclear if Xwo relates with same adversary known as “Iron Group”, or if](https://otx.alienvault.com/pulse/5b0db2c6c1916a4c39846d10)\nthey have repurposed public code. Based on our research to date, a potential relationship\nmay exist between Iron Cybercrime Group and Rocke. We are unable to assess the\nrelationship with acceptable confidence as of this report.\n\n## Command and Control:\n\nFollowing execution, Xwo first performs an HTTP POST request with a random User-Agent\nfrom a hardcoded list of choices, and then receives instructions from the C2 domain with an\nencoded public network range to scan:\n\n\n-----\n\nFigure 2: Xwo beacon and returned instructions.\n\nThe IP range supplied by the C2 infrastructure is base64 encoded and zlib compressed. As\nreceived in Figure 1, we can decode the response\n[“eJwzMjDSM7Qw0DM0M9Yz0DcyAQAaQwMX” with Python, or a CyberChef recipe to view](https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)Zlib_Inflate(0,0,'Adaptive',false,false)&input=ZUp3ek1qRFNNN1F3MERNME05WXowRGN5QVFBYVF3TVg)\nthe range to attack next:\n\n\"eJwzMjDSM7Qw0DM0M9Yz0DcyAQAaQwMX\".decode('base64').decode('zlib')\n\nResults in the range:\n\n202.180.163.0/24\n\nTo get the list of command and control servers it uses hardcoded data stored in base64\nencoding:\n\no0OO0oo0oOO = ['xm3f3sc84Lf96Nbwr+n/k0fQ98hd0wZadHDILvY4hb0=',\n\n'HGL91M2wOu+nLP1xlsNujqDjbbP5TktwjNaFtORL0oo=',\n\n'NNlmU+31V4LIV/j1Yo2lAehyF6eWj8tL1xXQsn+Liug=',\n\n\n-----\n\nNNlmU+31V4LIV/j1Yo2lAaicPP4buKiGYusLhKxS7AA= ]\n\nWhich decodes into:\n\ns.propub3r6espa33w[.]tk\n\ns.blockchainbdgpzk[.]tk\n\ns.pcrisk[.]xyz\n\ns.rapid7[.]xyz\n\nThe above C2 infrastructure is associated with MongoLock, which is found in our OTX Pulse\nfor that malware family. The entity behind the creation of the referenced C2 infrastructure\nfollows patterns of registering domains mimicking security and news organizations and\nwebsites like Rapid7 (rapid7.com), PCRisk (pcrisk.com), and ProPublica’s onion site\n(propub3r6espa33w.onion) but with .tk TLDs. This trend serves as supplemental links to the\nabove mentioned reports to other malware families.\n\nWe have contacted CloudFlare to report the C2 domains, and they have since been\nterminated, preventing further use by the adversary.\n\n## Scanning & Spreading:\n\nFirst Xwo scans the network range provided by the command and control server. It then\ncommences reconnaissance activity to collect information on available services. We assess\nthe adversary collects this information for later use by the attacking entity. Collected\ninformation includes:\n\nUse of default credentials in FTP, MySQL, PostgreSQL, MongoDB, Redis, Memcached.\nTomcat default credentials and misconfigurations.\nDefault SVN and Git paths.\nGit repositoryformatversion content.\nPhpMyAdmin details.\nWww backup paths.\nRealVNC Enterprise Direct Connect.\nRSYNC accessibility.\n\n\n-----\n\nFigure 3: An example credential testing module for Tomcat.\n\nFigure 4: An example of additional modules.\n\nThe results of the script are then sent back to the command and control server through an\nHTTP POST request.\n\n\n-----\n\nFigure 5: An example of scanning findings reporting back to adversary.\n\n## Conclusion:\n\nThe Alien Labs findings around Xwo introduce yet another iteration from what has been a\nrather publicity attracting adversary. While Xwo steps away from a variety of malicious\nfeatures observed the entity using, such as ransomware or exploits, the general use and\n**potential it holds can be damaging for networks around the globe. Xwo is likely a new**\nstep to an advancing capability, and we expect the full value of this information collection tool\nto be acted on in the future.\n\nNetwork owners should avoid the use of default service credentials and ensure publicly\naccessible services are restricted when possible. We are unable to assess what exactly the\noperators behind Xwo will use this information for, but based on links to MongoLock and\nXbash we expect it to be abused for further malicious activity in time.\n\n## Appendix\n\n**IOCs:**\n\n[Full list available in the OTX Pulse.](https://otx.alienvault.com/pulse/5c9a935fc43b7801e1ed3f05)\n\nMD5 File Hash:\n\nfd67a98599b08832cf8570a641712301\n\nSHA1 File Hash:\n\n1faf363809f266bb2d90fb8d3fc43c18253d0048\n\n\n-----\n\nSHA256 File Hash:\n\n6408c69e802de04e949ed3047dc1174ef20125603ce7ba5c093e820cb77b1ae1\n\nDomain:\n\nblockchainbdgpzk[.]tk\npcrisk[.]xyz\npropub3r6espa33w[.]tk\n\nHostname:\n\nd.pcrisk[.]xyz\ns.blockchainbdgpzk[.]tk\ns.pcrisk[.]xyz\ns.propub3r6espa33w[.]tk\ns.rapid7[.]xyz\n\nURL:\n\nhxxp://bucket-chain.oss-cn-hongkong.aliyuncs[.]com/xwo.exe\nhxxp://s.blockchainbdgpzk[.]tk/ci2\nhxxp://s.pcrisk[.]xyz/ci2\nhxxp://s.propub3r6espa33w[.]tk/ci2\nhxxp://s.rapid7[.]xyz/ci2\n\nHardcoded UserAgents\n\nMozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR\n1.1.4322; .NET CLR 2.0.50727)\nMozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR\n2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\nMozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET\nCLR 1.1.4322; .NET CLR 2.0.50727)\nMozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\nMozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET\nCLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\nMozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0;\nSLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR\n1.0.3705; .NET CLR 1.1.4322)\nMozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR\n2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\nMozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like\nGecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\n\n\n-----\n\nMozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko,\nSafari/419.3) Arora/0.6\nMozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 KNinja/2.1.1\nMozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0\nKapiko/3.0\nMozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\nMozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10\nKazehakase/0.5.6\nMozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko)\nChrome/17.0.963.56 Safari/535.11\nMozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like\nGecko) Chrome/19.0.1036.7 Safari/535.20\nOpera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\nMozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko)\nChrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\nMozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko)\nChrome/21.0.1180.71 Safari/537.1 LBBROWSER\nMozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2;\n.NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC\n6.0; .NET4.0C; .NET4.0E; LBBROWSER)\nMozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732;\n.NET4.0C; .NET4.0E; LBBROWSER)\nMozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko)\nChrome/17.0.963.84 Safari/535.11 LBBROWSER\nMozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2;\n.NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC\n6.0; .NET4.0C; .NET4.0E)\nMozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2;\n.NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC\n6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\nMozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732;\n.NET4.0C; .NET4.0E)\nMozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload\n732; .NET4.0C; .NET4.0E; 360SE)\nMozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732;\n.NET4.0C; .NET4.0E)\nMozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2;\n.NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC\n6.0; .NET4.0C; .NET4.0E)\nMozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko)\nChrome/21.0.1180.89 Safari/537.1\n\n\n-----\n\nMozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko)\nChrome/21.0.1180.89 Safari/537.1\nMozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9\n(KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\nMozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307\nFirefox/4.0b13pre\nMozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\nMozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko)\nChrome/23.0.1271.64 Safari/537.11\nMozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10\n(maverick) Firefox/3.6.10']\n\n### Share this with others\n\nTags:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-02 - Xwo - A Python-based bot scanner.pdf"
    ],
    "report_names": [
        "2019-04-02 - Xwo - A Python-based bot scanner.pdf"
    ],
    "threat_actors": [
        {
            "id": "7c053836-8f50-4d40-bc5c-7088967e1b57",
            "created_at": "2022-10-25T16:07:24.549525Z",
            "updated_at": "2025-03-27T02:02:10.278474Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra",
                "Iron Group",
                "Rocke"
            ],
            "source_name": "ETDA:Rocke",
            "tools": [
                "Godlua",
                "Kerberods",
                "LSD",
                "Pro-Ocean",
                "Xbash"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5b9d2809-47b7-46a8-ab2d-9687537f1bc7",
            "created_at": "2023-01-06T13:46:38.804869Z",
            "updated_at": "2025-03-27T02:00:02.923702Z",
            "deleted_at": null,
            "main_name": "Iron Group",
            "aliases": [
                "Iron Cyber Group"
            ],
            "source_name": "MISPGALAXY:Iron Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "905eabd9-2b7f-483d-86bd-0c72f96b4162",
            "created_at": "2023-01-06T13:46:39.02749Z",
            "updated_at": "2025-03-27T02:00:02.980813Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra"
            ],
            "source_name": "MISPGALAXY:Rocke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0b02af5f-2027-42b7-a6f2-51e2fd49ba7f",
            "created_at": "2022-10-25T15:50:23.360509Z",
            "updated_at": "2025-03-27T02:00:55.45329Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Rocke"
            ],
            "source_name": "MITRE:Rocke",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535736,
    "ts_updated_at": 1743041630,
    "ts_creation_date": 1653687471,
    "ts_modification_date": 1653687471,
    "files": {
        "pdf": "https://archive.orkl.eu/cc4cf26ead69d176b434484fe62321f2efd35b66.pdf",
        "text": "https://archive.orkl.eu/cc4cf26ead69d176b434484fe62321f2efd35b66.txt",
        "img": "https://archive.orkl.eu/cc4cf26ead69d176b434484fe62321f2efd35b66.jpg"
    }
}