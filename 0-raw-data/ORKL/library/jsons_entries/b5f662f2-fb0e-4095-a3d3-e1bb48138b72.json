{
    "id": "b5f662f2-fb0e-4095-a3d3-e1bb48138b72",
    "created_at": "2022-10-25T16:48:13.095048Z",
    "updated_at": "2025-03-27T02:09:54.220638Z",
    "deleted_at": null,
    "sha1_hash": "6d0de3e44a012f45a7b56a9862d1d67ef8bfd7e8",
    "title": "From Bahrain With Love: Finfisher Spy Kit Exposed?",
    "authors": "Citizen Lab",
    "file_creation_date": "2015-03-17T15:43:11Z",
    "file_modification_date": "2015-03-17T15:43:11Z",
    "file_size": 1350754,
    "plain_text": "**Research Brief**\n\n# The Citizen Lab \n\nJuly 2012\n\n\n**_From Bahrain with Love:_**\n\n**_FinFisher’s Spy Kit Exposed?_**\n\nAuthor: Morgan Marquis-Boire\n\n## INTRODUCTION\n\nThe FinFisher Suite is described by its distributors, Gamma International UK Ltd., as \"Governmental IT\n[Intrusion and Remote Monitoring Solutions.\" [1]](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#1) The toolset first gained notoriety after it was revealed that the\n[Egyptian Government’s state security apparatus had been involved in negotiations](https://www.f-secure.com/weblog/archives/00002114.html) with Gamma International\n\n[UK Ltd. over the purchase of the software. Promotional materials have been leaked](http://wikileaks.org/spyfiles/list/tags/gamma-finfisher-trojan.html) that describe the tools as\n[providing a wide range of intrusion and monitoring capabilities.[2]](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#2) Despite this, however, the toolset itself has\nnot been publicly analyzed.\n\nThis post contains analysis of several pieces of malware obtained by Vernon Silver of Bloomberg News that\nwere sent to Bahraini pro-democracy activists in April and May of this year. The purpose of this work is\n\nidentification and classification of the malware to better understand the actors behind the attacks and the risk\nto victims. In order to accomplish this, we undertook several different approaches during the investigation.\n\nAs well as directly examining the samples through static and dynamic analysis, we infected a virtual machine\n\n(VM) with the malware. We monitored the filesystem, network, and running operating system of the infected\nVM.\n\nThis analysis suggests the use of “Finspy”, part of the commercial intrusion kit, Finfisher, distributed by\nGamma International.\n\n\n-----\n\n## DELIVERY\n\n_This section describes how the malware was delivered to potential victims using e-mails with malicious_\n_attachments._\n\nIn early May, we were alerted that Bahraini activists were targeted with apparently malicious e-mails. The\nemails ostensibly pertained to the ongoing turmoil in Bahrain, and encouraged recipients to open a series of\nsuspicious attachments. The screenshot below is indicative of typical message content:\n\nThe attachments to the e-mails we have been able to analyze were typically .rar files, which we found to\ncontain malware. Note that the apparent sender has an e-mail address that indicates that it was being sent by\n“Melissa Chan,” who is a real correspondent for Aljazeera English. We suspect that the e-mail address is not\n[her real address.[3]](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#3) The following samples were examined:\n\n\n324783fbc33ec117f971cca77ef7ceaf7ce229a74edd6e2b3bd0effd9ed10dcc الفعاليات.rar\nc5b39d98c85b21f8ac1bedd91f0b6510ea255411cf19c726545c1d0a23035914 _gpj.ArrestedXSuspects.rar\nc5b37bb3620d4e7635c261e5810d628fc50e4ab06b843d78105a12cfbbea40d7\n\nKingXhamadXonXofficialXvisitXtoX.rar\n80fb86e265d44fbabac942f7b26c973944d2ace8a8268c094c3527b83169b3cc MeetingXAgenda.rar\nf846301e7f190ee3bb2d3821971cc2456617edc2060b07729415c45633a5a751 Rajab.rar\n\n\nThese contained executables masquerading as picture files or documents:\n\n\n49000fc53412bfda157417e2335410cf69ac26b66b0818a3be7eff589669d040 dialoge.exe\ncc3b65a0f559fa5e6bf4e60eef3bffe8d568a93dbb850f78bdd3560f38218b5c ex.eRajabpj.1g\n39b325bd19e0fe6e3e0fca355c2afddfe19cdd14ebda7a5fc96491fc66e0faba exi.emagepj.1g\ne48bfeab2aca1741e6da62f8b8fc9e39078db574881691a464effe797222e632 ex.eRajapj.bg\n2ec6814e4bad0cb03db6e241aabdc5e59661fb580bd870bdb50a39f1748b1d14 ex.eAerrets dSuspepj.stcg\nc29052dc6ee8257ec6c74618b6175abd6eb4400412c99ff34763ff6e20bab864 News about the existence of a\nnew dialogue between AlWefaq & Govt..doc\n\n\n-----\n\nThe emails generally suggested that the attachments contained political content of interest to pro-democracy\n\nactivists and dissidents. In order to disguise the nature of the attachments a malicious usage of\n[the “righttoleftoverride\" (RLO) character](https://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/) was employed. The RLO character (U+202e in unicode) controls the\npositioning of characters in text containing characters flowing from right to left, such as Arabic or Hebrew.\nThe malware appears on a victim’s desktop as \"exe.Rajab1.jpg\" (for example), along with the default\nWindows icon for a picture file without thumbnail. But, when the UTF-8 based filename is displayed in\nANSI, the name is displayed as \"gpj.1bajaR.exe”. Believing that they are opening a harmless “.jpg”, victims\n[are instead tricked into running an executable \".exe\" file.[4]](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#4)\n\nUpon execution these files install a multi-featured trojan on the victim’s computer. This malware provides the\n\nattacker with clandestine remote access to the victim’s machine as well as comprehensive data harvesting and\nexfiltration capabilities.\n\n## INSTALLATION\n\n_This section describes how the malware infects the target machine._\n\nThe malware displays a picture as expected. This differs from sample to sample. The sample “Arrested\nSuspects.jpg” (“gpj.stcepsuS detserrA.exe”) displays:\n\n\n-----\n\nIt additionally creates a directory (which appears to vary from sample to sample):\n\nC:\\Documents and Settings\\XPMUser\\Local Settings\\Temp\\TMP51B7AFEF\n\nIt copies itself there (in this case the malware appears as “Arrested Suspects.jpg”) where it is renamed:\n\n\nC:\\Documents and Settings\\XPMUser\\Local Settings\\Temp\\TMP51B7AFEF\\Arrested Suspects.jpg” =>\nC:\\Documents and Settings\\XPMUser\\Local Settings\\Temp\\TMP51B7AFEF\\tmpD.tmp\n\n\nThen it drops the following files:\n\n\nC:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\delete.bat\nC:\\DOCUME~1\\%USER%\\LOCALS~1\\Temp\\driverw.sys\n\n\nIt creates the folder (the name of which varies from host to host):\n\n\nC:\\Documents and Settings\\%USER%\\Application Data\\Microsoft\\Installer\\{5DA45CC9-D840-47CC9F86-FD2E9A718A41}\n\n\nThis process is observable on the filesystem timeline of the infected host (click image to enlarge):\n\n“driverw.sys” is loaded and then “delete.bat” is run which deletes the original payload and itself. It then\ninfects existing operating system processes, connects to the command and control server, and begins data\nharvesting and exfiltration.\n\n\n-----\n\nExamining the memory image of a machine infected with the malware shows that a technique for infecting\n\nprocesses known as “process hollowing\" is used. For example, the memory segment below from the\n“winlogon.exe” process is marked as executable and writeable:\n\nHere the malware starts a new instance of a legitimate process such as “winlogon.exe” and before the\nprocess’s first thread begins, the malware de-allocates the memory containing the legitimate code and injects\nmalicious code in its place. Dumping and examining this memory segment reveals the following strings in the\ninfected process:\n\nNote the string:\n\n\ny:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\libs\\libgmp\\mpn-tdiv_qr.c\n\n\n-----\n\nThis file seems to correspond to a file in the GNU Multi-Precision arithmetic library:\n[http://gmplib.org:8000/gmp/file/b5ca16212198/mpn/generic/tdiv_qr.c](http://gmplib.org:8000/gmp/file/b5ca16212198/mpn/generic/tdiv_qr.c)\n\nThe process “svchost.exe” was also found to be infected in a similar manner:\n\n\n-----\n\nFurther examination of the memory dump also reveals the following:\n\nThis path appears to reference the functionality that the malware uses to modify the boot sequence to enable\npersistence:\n\n\ny:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv\ner.pdb\n\n\nA pre-infection vs post-infection comparison of the infected VM shows that the Master Boot Record (MBR)\nwas modified by code injected by the malware.\n\nThe strings found in memory “finspyv4.01” and “finspyv2” are particularly interesting. The FinSpy tool is\n[part of the FinFisher intrusion and monitoring toolkit.[5]](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#5)\n\n## OBFUSCATION AND EVASION\n\n_This section describes how the malware is designed to resist analysis and evade identification._\n\nThe malware employs a myriad of techniques designed to evade detection and frustrate analysis. While\ninvestigation into this area is far from complete, we discuss several discovered methods as examples of the\nlengths taken by the developers to avoid identification.\n\nA virtualised packer is used. This type of obfuscation is used by those that have “strong motives to prevent\n[their malware from being analyzed”.[6]](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#6)\n\nThis converts the native x86 instructions of the malware into another custom language chosen from one of 11\ncode templates. At run-time, this is interpreted by an obfuscated interpreter customized for that particular\nlanguage. This virtualised packer was not recognised and appears to be bespoke.\n\n\n-----\n\nSeveral anti-debugging techniques are used. This section of code crashes the popular debugger, OllyDbg.\n\n.text:00401683 finit\n.text:00401686 fld ds:tbyte_40168E\n.text:0040168C jmp short locret_401698\n--------------------------------------------------------------------.text:0040168E tbyte_40168E dt 9.2233720368547758075e18\n--------------------------------------------------------------------.text:00401698 locret_401698:\n.text:00401698 retn\n\nThis float value causes OllyDbg to crash when trying to display its value. A more detailed explanation of this\n[can be found here.](http://qunpack.ahteam.org/?p=386)\n\nTo defeat DbgBreakPoint based debuggers, the malware finds the address of DbgBreakPoint, makes the page\nEXECUTE_READWRITE and writes a NOP on the entry point of DbgBreakPoint.\n\nThe malware checks via PEB to detect whether or not it is being debugged, and if it is it returns a random\naddress.\n\nThe malware calls ZwSetInformationThread with ThreadInformationClass set to 0x11, which causes the\nthread to be detached from the debugger.\n\nThe malware calls ZwQueryInformationProcess with ThreadInformationClass set to 0x(ProcessDebugPort)\nand 0x1e (ProcessDebugObjectHandle) to detect the presence of a debugger. If a debugger is detected it jumps\nto a random address. ZwQueryInformationProcess is also called to check the DEP status on the current\nprocess, and it disables it if it’s found to be enabled.\n\nThe malware deploys a granular solution for Antivirus software, tailored to the AV present on the infected\nmachine. The malware calls ZwQuerySystemInformation to get ProcessInformation and ModuleInformation.\n\nThe malware then walks the list of processes and modules looking for installed AV software. Our analysis\nindicates that the malware appears to have different code to Open/Create process and inject for each AV\nsolution. For some Anti-Virus software this even appears to be version dependent. The function\n“ZwQuerySystemInformation” is also hooked by the malware, a technique frequently used to allow process\nhiding:\n\n\n-----\n\n## DATA HARVESTING AND ENCRYPTION\n\n_This section describes how the malware collects and encrypts data from the infected machine._\n\n\n-----\n\nOur analysis showed that the malware collects a wide range of data from an infected victim. The data is\n\nstored locally in a hidden directory, and is disguised with encryption prior to exfiltration.\n\n\n\"C:\\Windows\\Installer\\{49FD463C-18F1-63C4-8F12-49F518F127}.\"\n\n\nOn the reference victim host, the directory was:\n\nWe conducted forensic examination of the files created in this directory and identified a wide range of data\ncollected. Files in this directory were found to be screenshots, keylogger data, audio from Skype calls,\npasswords and more.  For the sake of brevity we include a limited set of examples here.\n\nThe malware attempts to locate the configuration and password store files for a variety browsers and chat\nclients as seen below:\n\n\n-----\n\nWe observed the creation of the file “t111o00000000.dat” in the data harvesting directory, as shown in the\nfilesystem timeline below:\n\n**Thu Jun 14 2012 12:31:34 52719 mac. r/rr-xr-xr-x 0 0 26395-128-5 C:/WINDOWS/Installer/{49FD463C-**\n18F1-63C4-8F12-49F518F127}/09e493e2-05f9-4899-b661-c52f3554c644\n**Thu Jun 14 2012 12:32:18 285691 ...b r/rrwxrwxrwx 0 0 26397-128-4 C:/WINDOWS/Installer/{49FD463C-**\n18F1-63C4-8F12-49F518F127}/t111o00000000.dat\n**Thu Jun 14 2012 12:55:12 285691 mac. r/rrwxrwxrwx 0 0 26397-128-4**\nC:/WINDOWS/Installer/{49FD463C-18F1-63C4-8F12-49F518F127}/t111o00000000.dat\n\n4096 ..c. -/rr-xr-xr-x 0 0 26447-128-4\n\nThe infected process “winlogon.exe” was observed writing this file via Process:\n\n\n-----\n\nExamination of this file reveals that it is a screenshot of the desktop:\n\nMany other modules providing specific exfiltration capabilities were observed. Generally, the exfiltration\nmodules write files to disk using the following naming convention: XXY1TTTTTTTT.dat. XX is a two-digit\nhexadecimal module number, Y is a single-digit hexadecimal submodule number, and TTTTTTTT is a\nhexadecimal representation of a unix timestamp (less 1.3 billion) associated with the file creation time.\n\n## ENCRYPTION\n\nThe malware uses encryption in an attempt to disguise harvested data in the .dat files intended for exfiltration.\nData written to the files is encrypted using AES-256-CBC (with no padding). The 32-byte key consists of 8\nreadings from memory address 0x7ffe0014: a special address in Windows that contains the low-order-4-bytes\nof the number of hundred-nanoseconds since 1 January 1601. The IV consists of 4 additional readings.\n\nThe AES key structure is highly predictable, as the quantum for updating the system\nclock (HKLM\\SYSTEM\\CurrentControlSet\\Services\\W32Time\\Config\\LastClockRate) is set to\n\n\n-----\n\n[0x2625A hundred-nanoseconds by default, and the clock readings that comprise the key and IV are taken in a](http://technet.microsoft.com/en-us/library/cc773263%28v=ws.10%29.aspx)\ntight loop:\n\n...\n0x406EA4: 8D45C0 LEA EAX,[EBP-0x40]\n0x406EA7: 50 PUSH EAX\n\n**0x406EA8: FF150C10AF01 CALL DWORD PTR [0x1AF100C]**\n0x406EAE: 8B4DE8 MOV ECX,DWORD PTR [EBP-0x18]\n\n**0x406EB1: 8B45C0 MOV EAX,DWORD PTR [EBP-0x40]**\n0x406EB4: 8345E804 ADD DWORD PTR [EBP-0x18],0x4\n\n0x406EB8: 6A01 PUSH 0x1\n0x406EBA: 89040F MOV DWORD PTR [EDI+ECX],EAX\n0x406EBD: FF152810AF01 CALL DWORD PTR [0x1AF1028]\n\n**0x406EC3: 817DE800010000 CMP DWORD PTR [EBP-0x18],0x100**\n0x406ECA: 72D8 JB 0x406EA4\n\n**0x406ECC: 80277F AND BYTE PTR [EDI],0x7F**\n...\n\nThe following AES keys were among those found to be used to encrypt records in .dat files. The first contains\nthe same 4 bytes repeated, whereas in the second key, the difference between all consecutive 4-byte blocks\n(with byte order swapped) is 0x2625A.\n\n\n70 31 bd cc 70 31 bd cc 70 31 bd cc 70 31 bd cc 70 31 bd cc 70 31 bd cc 70 31\nbd cc 70 31 bd cc\n\n26 e9 23 60 80 4b 26 60 da ad 28 60 34 10 2b 60 8e 72 2d 60 e8 d4 2f 60 42 37\n32 60 9c 99 34 60\n\n\nIn all, 64 clock readings are taken. The readings are encrypted using an RSA public key found in memory\n(whose modulus begins with A25A944E) and written to the .dat file before any other encrypted data. No\npadding is used in the encryption, yielding exactly 256 encrypted bytes. After the encrypted timestamp\nvalues, the file contains a number of records encrypted with AES, delimited by EAE9E8FF.\n\n\n-----\n\nIn reality, these records are only partially encrypted: if the record’s length is not a multiple of 16 bytes (the\nAES block size), then the remainder of the bytes are written to the file unencrypted. For example, after typing\n“FinSpy” on the keyboard, the keylogger module produced the following (trailing plaintext highlighted):\n\nThe predictability of the AES encryption keys allowed us to decrypt and view these partially-encrypted\nrecords in full plaintext. The nature of the records depends on the particular module and submodule. For\nexample, submodule Y == 5 of the Skype exfiltration module (XX == 14), contains a csv representation of the\nuser’s contact list:\n\n\n**Record # 0 Length: 243 bytes:**\nó\n@þÿÌ³Ð\n@\n¤b¯Opþ192.168.131.67JRecordingEcsv 0þ-0800UTC DST.1þ2012-07-18 18:00:21.:þ1970-01-01\n00:16:00Abhwatch1\n\n**Record # 1 Length: 96 bytes:**\n`USERNAME,FULLNAME,COUNTRY,AUTHORIZED,BLOCKED\n\n**Record # 2 Length: 90 bytes:**\nZecho123,Echo / Sound Test Service,,YES,NO\n\n**Record # 3 Length: 95 bytes:**\n^bhwatch2,Bahrain Watch,United States,YES,NO\n\n\n-----\n\nSubmodule Y == 3 records file transfers. After a Skype file transfer concludes, the following file is created:\n\n%USERPROFILE%\\Local Settings\\Temp\\smtXX.tmp. This file appears to contain the sent / received\nfile. As soon as smtXX.tmp is finished being written to disk, a file (1431XXXXXXXX.dat) is written,\nroughly the same size as smtXX.tmp. After sending a picture (of birdshot shotgun shell casings used by\nBahrain’s police) to an infected Skype client, the file 1431028D41FD.dat was observed being written to\ndisk. Decrypting it revealed the following:\n\n\n**Record # 0 Length: 441 bytes:**\n¹\n@þÿÌ³Ð\n\n@\n¤b¯Opþ192.168.131.67Abhwatch1Bbhwatch2\"CBahrain WatchIreceivedrC:\\Documents and\nSettings\\XPMUser\\My Documents\\gameborev3.jpgJRecording 0þ-0800UTC DST.1þ2012-07-20\n12:18:21.:þ2012-07-20 12:18:21\n\n\n**Record # 1 Length: 78247 bytes:**\n\n[Note: Record #1 contained the contents of the .jpg file, preceded by hex A731010090051400, and\nfollowed by hex 0A0A0A0A.]\n\n\n-----\n\nAdditionally, submodule Y == 1 records Skype chat messages, and submodule Y == 2 records audio from all\n\nparticipants in a Skype call. The call recording functionality appears to be provided by hooking\nDirectSoundCaptureCreate:\n\n## COMMAND AND CONTROL\n\n_This section describes the communications behavior of the malware._\n\nWhen we examined the malware samples we found that they connect to a server at IP address 77.69.140.194\n\n\n-----\n\n[WHOIS data[7]](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#7) [reveals that this address is owned by Batelco, the principal telecommunications company of](https://en.wikipedia.org/wiki/Batelco)\nBahrain:\n\n\ninetnum: 77.69.128.0 - 77.69.159.255\nnetname: ADSL\ndescr: Batelco ADSL service\ncountry: bh\n\n\nFor a period of close to 10 minutes, traffic was observed between the infected victim and the command and\ncontrol host in Bahrain.\n\nA summary of the traffic by port and conversation size (click image to enlarge):\n\nThe infected VM talks to the remote host on the following five TCP ports:\n\n\n**22**\n\n**53**\n**80**\n**443**\n**4111**\n\n\nBased on observation of an infected machine we were able to determine that the majority of data is exfiltrated\nto the remote host via ports 443 and 4111.\n\n\n-----\n\n**192.168.131.65:1213 -> 77.69.140.194:443 1270075 bytes**\n**192.168.131.65:4111 -> 77.69.149.194:4111 4766223 bytes**\n\n\n## CONCLUSIONS ABOUT MALWARE IDENTIFICATION\n\nOur analysis yields indicators about the identity of the malware we have analyzed: (1) debug strings found the\nin memory of infected processes appear to identify the product and (2) the samples have similarities with\nmalware that communicates with domains belonging to Gamma International.\n\n## Debug Strings found in memory\n\nAs we previously noted, infected processes were found containing strings that include “finspyv4.01” and\n“finspyv2”:\n\n\ny:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\libs\\libgmp\\mpn-tdiv_qr.c\ny:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\libs\\libgmp\\mpn-mul_fft.c\ny:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\target\\bootkit_x32driver\\objfre_w2k_x86\\i386\\bootkit_x32driv\ner.pdb\n\n\n[Publicly available descriptions of the FinSpy tool collected by Privacy International](https://www.privacyinternational.org/) among others and posted\n[on Wikileaks[8]](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#8) make the a series of claims about functionality:\n\n  - Bypassing of 40 regularly tested Antivirus Systems\n\n  - Covert Communication with Headquarters\n\n  - Full Skype Monitoring (Calls, Chats, File Transfers, Video, Contact List)\n\n  - Recording of common communication like Email, Chats and Voice-over-IP\n\n  - Live Surveillance through Webcam and Microphone\n\n  - Country Tracing of Target\n\n  - Silent Extracting of Files from Hard-Disk\n\n  - Process-based Key-logger for faster analysis\n\n  - Live Remote Forensics on Target System\n\n  - Advanced Filters to record only important information\n\n  - Supports most common Operating Systems (Windows, Mac OSX and Linux)\n\n\n-----\n\n## Shared behavior with a sample that communicates with Gamma\n\nThe virtual machine used by the packer has very special sequences in order to execute the virtualised code, for\nexample:\n\n66 C7 07 9D 61 mov word ptr [edi], 619Dh\nC6 47 02 68 mov byte ptr [edi+2], 68h\n89 57 03 mov [edi+3], edx\nC7 47 07 68 00 00 00 mov dword ptr [edi+7], 68h\n89 47 08 mov [edi+8], eax\nC6 47 0C C3 mov byte ptr [edi+0Ch], 0C3h\n\nBased on this we created a signature from the Bahrani malware, which we shared with another security\nresearcher who identified a sample that shared similar virtualised obfuscation. That sample is:\n\n\n**md5: c488a8aaef0df577efdf1b501611ec20**\n**sha1: 5ea6ae50063da8354e8500d02d0621f643827346**\n**sha256: 81531ce5a248aead7cda76dd300f303dafe6f1b7a4c953ca4d7a9a27b5cd6cdf**\n\n\nThe sample connects to the following domains:\n\n\n**tiger.gamma-international.de**\n**ff-demo.blogdns.org**\n\n\n[The domain tiger.gamma-international.de has the following Whois information[9]:](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#9)\n\n\nDomain: gamma-international.de\n\nName: Martin Muench\nOrganisation: Gamma International GmbH\nAddress: Baierbrunner Str. 15\nPostalCode: 81379\nCity: Munich\nCountryCode: DE\nPhone: +49-89-2420918-0\nFax: +49-89-2420918-1\nEmail: info@gamma-international.de\nChanged: 2011-04-04T11:24:20+02:00\n\n\n-----\n\n[Martin Muench is a representative of Gamma International, a company that sells “advanced technical](http://www.bbc.co.uk/news/technology-14981672)\n[surveillance and monitoring solutions”. One of the services they provide is FinFisher: IT Intrusion, including](http://www.finfisher.com/FinFisher/en/index.php&sa=D&sntz=1&usg=AFQjCNGsJVX58w-1pPJc-v9nwhCG1rH0UA)\nthe FinSpy tool. This labelling indicates that the matching sample we were provided may be a demo copy a\nFinFisher product per the domain ff-demo.blogdns.org.\n\nWe have linked a set of novel virtualised code obfuscation techniques in our Bahraini samples to another\nbinary that communicates with Gamma International IP addresses. Taken alongside the explicit use of the\nname “FinSpy” in debug strings found in infected processes, we suspect that the malware is the FinSpy remote\nintrusion tool. This evidence appears to be consistent with the theory that the dissidents in Bahrain who\n\nreceived these e-mails were targeted with the FinSpy tool, configured to exfiltrate their harvested information\nto servers in Bahraini IP space. If this is not the case, we invite Gamma International to explain.\n\n## RECOMMENDATIONS\n\nThe samples from email attachments have been shared with selected individuals within the security\ncommunity, and we strongly urge antivirus companies and security researchers to continue where we have left\noff.\n\nBe wary of opening unsolicited attachments received via email, skype or any other communications\n\nmechanism. If you believe that you are being targeted it pays to be especially cautious when downloading\nfiles over the Internet, even from links that are purportedly sent by friends.\n\n## ACKNOWLEDGEMENTS\n\n[Malware analysis by Morgan Marquis-Boire and Bill Marczak. Assistance from Seth Hardy and Harry Tuttle](http://www.cs.berkeley.edu/~wrm/)\ngratefully received.\n\n[Special thanks to John Scott-Railton.](http://www.johnscottrailton.com/)\n\nThanks to Marcia Hofmann and the Electronic Frontier Foundation (EFF).\n\n[We would also like to acknowledge Privacy International](https://www.privacyinternational.org/) for their continued work and graciously provided\nbackground information on Gamma International.\n\n\n-----\n\n## FOOTNOTES\n\n1 [http://www.finfisher.com/](http://www.finfisher.com/)\n\n2 [http://owni.eu/2011/12/15/finfisher-for-all-your-intrusive-surveillance-needs/#SpyFiles](http://owni.eu/2011/12/15/finfisher-for-all-your-intrusive-surveillance-needs/#SpyFiles)\n\n3 [http://blogs.aljazeera.com/profile/melissa-chan](http://blogs.aljazeera.com/profile/melissa-chan)\n\n[4 This technique was used in the recent Madi](https://www.securelist.com/en/blog/208193677/The_Madi_Campaign_Part_I) malware attacks.\n\n5 [http://www.finfisher.com/](http://www.finfisher.com/)\n\n6 Unpacking Virtualised Obfuscators by Rolf Rolles [http://static.usenix.org/event/woot09/tech/full_papers/rolles.pdf](http://static.usenix.org/event/woot09/tech/full_papers/rolles.pdf)\n\n7 http://whois.domaintools.com/77.69.140.194\n\n[8 E.g. http://wikileaks.org/spyfiles/files/0/289_GAMMA-201110-FinSpy.pdf](http://wikileaks.org/spyfiles/files/0/289_GAMMA-201110-FinSpy.pdf)\n\n9 http://whois.domaintools.com/gamma-international.de\n\n[Back to top](https://citizenlab.org/wp-admin/post.php?post=14092&action=edit#top)\n\n## MEDIA COVERAGE\n\n[The Wall Street Journal](http://blogs.wsj.com/digits/2012/07/25/how-pro-regime-forces-use-spyware-to-target-arab-spring-rebels/)\n[Slate](http://www.slate.com/blogs/future_tense/2012/07/25/finspy_trojan_from_gamma_group_may_have_been_used_against_bahraini_activists_says_report_.html)\n[CSO](http://www.cso.com.au/article/431899/finfisher_fingered_bahrain_folk_surveillance/?fp=4&fpid=959105)\n\n[Tech Week Europe](http://www.techweekeurope.co.uk/news/cyber-spy-bahrain-gamma-international-87396)\n[Bloomberg](http://www.bloomberg.com/news/2012-07-25/cyber-attacks-on-activists-traced-to-finfisher-spyware-of-gamma.html)\n[Electronic Frontier Foundation](https://www.eff.org/deeplinks/2012/07/elusive-finfisher-spyware-identified-and-analyzed%3Cbr%20/%3E)\n[Privacy International](https://www.privacyinternational.org/blog/british-spyware-used-to-target-bahraini-activists)\n[Spiegel Online](http://www.spiegel.de/netzwelt/netzpolitik/bahrain-trojanerangriff-auf-buergerrechtler-a-846515.html)\n[PC Mag](http://securitywatch.pcmag.com/none/301324-finfisher-spyware-c-c-server-detected-in-us)\n[The New York Times](http://bits.blogs.nytimes.com/2012/08/13/elusive-finspy-spyware-pops-up-in-10-countries/)\n\n**About the Author**\n\nMorgan Marquis-Boire is a Technical Advisor at the Citizen Lab, Munk School of Global Affairs, University\nof Toronto. He works as a Security Engineer at Google specializing in Incident Response, Forensics and\nMalware Analysis.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/1y57tx3onyislwp9w9k0dqew874y11s9",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2012/2012.07.25.FinFisher_Spy_Kit/From-Bahrain-With-Love-FinFishers-Spy-Kit-Exposed.pdf"
    ],
    "report_names": [
        "From-Bahrain-With-Love-FinFishers-Spy-Kit-Exposed"
    ],
    "threat_actors": [
        {
            "id": "b07fec96-80cd-4d92-aa52-a26a0b25b7c2",
            "created_at": "2022-10-25T16:07:23.826594Z",
            "updated_at": "2025-03-27T02:02:09.994638Z",
            "deleted_at": null,
            "main_name": "Madi",
            "aliases": [
                "Mahdi"
            ],
            "source_name": "ETDA:Madi",
            "tools": [
                "Madi"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "322a0ef1-136b-400e-89d0-0d62ee2bd319",
            "created_at": "2023-01-06T13:46:38.662109Z",
            "updated_at": "2025-03-27T02:00:02.885938Z",
            "deleted_at": null,
            "main_name": "Madi",
            "aliases": [],
            "source_name": "MISPGALAXY:Madi",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041394,
    "ts_creation_date": 1426606991,
    "ts_modification_date": 1426606991,
    "files": {
        "pdf": "https://archive.orkl.eu/6d0de3e44a012f45a7b56a9862d1d67ef8bfd7e8.pdf",
        "text": "https://archive.orkl.eu/6d0de3e44a012f45a7b56a9862d1d67ef8bfd7e8.txt",
        "img": "https://archive.orkl.eu/6d0de3e44a012f45a7b56a9862d1d67ef8bfd7e8.jpg"
    }
}