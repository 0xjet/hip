{
    "id": "df9c751e-4bc5-4d9b-b1b3-4f66b06280d6",
    "created_at": "2023-01-12T15:00:58.564045Z",
    "updated_at": "2025-03-27T02:09:18.63824Z",
    "deleted_at": null,
    "sha1_hash": "43523adbce1bd284a008b46802c1224e0aa58698",
    "title": "2020-12-17 - SolarWinds Backdoor (Sunburst) Incident Response Playbook",
    "authors": "",
    "file_creation_date": "2022-05-29T00:54:13Z",
    "file_modification_date": "2022-05-29T00:54:13Z",
    "file_size": 512151,
    "plain_text": "# SolarWinds Backdoor (Sunburst) Incident Response Playbook\n\n**[trustedsec.com/blog/solarwinds-backdoor-sunburst-incident-response-playbook/](https://www.trustedsec.com/blog/solarwinds-backdoor-sunburst-incident-response-playbook/?hss_channel=tw-403811306)**\n\nBy TrustedSec in Incident Response, Incident Response & Forensics, Research, Security Remediation, Security Testing &\nAnalysis, Technical Counter Surveillance Measures, Threat Hunting\n\nDecember 17, 2020\n\nOver the last several days, TrustedSec has received queries on the best ways to contain,\neradicate, and remediate the SolarWinds backdoor (aka #solarigate aka Sunburst). The\nTrustedSec Incident Response team has put together a playbook of recommended actions to\nprovide some level of assurance that your organization is no longer affected by the backdoor.\n\nThis is almost the worst-case scenario for many organizations: an advanced, statesponsored actor (may have) had an undetected backdoor into your network for months. Even\nworse, the system(s) that backdoor was on had full access to your environment. Due to this,\nas many others in the industry have stated, organizations have to assume they have been\nfully breached. Therefore, the following playbook operates under this assumption.\n\nTwo (2) notes before we get started:\n\n1. Even if you have already taken steps to respond, we recommend looking through this\n\nlist. There may be something you did not think of.\n2. Do not blindly take all the actions below. Every organization must perform their own\n\ndue diligence of determining what the effects of the actions below are and to ensure\nthat the organization is OK with those effects.\n\n\n-----\n\n## Investigation\n\nThe investigation should take place concurrent to the containment, eradication, and recovery\nprocesses. SolarWinds Orion servers should be forensically preserved, if possible, to allow\nforensic examination. This includes:\n\nObtaining live response data, including RAM\nImaging and hashing the disk\nSaving any network logs (e.g., firewall, NetFlow) of the servers before they are rolled\nout\nExporting any centralized logs from the servers before they are rolled out\n\nSince every organization’s internal visibility is different, rather than providing a list of tasks to\nperform when investigating, we have compiled a list of questions that should be answered.\nFor any questions that cannot be answered, organizations should determine what can be put\nin place in the future to sufficiently answer those questions. Timeframes for all questions\nshould be for as long as your organization has had SolarWinds Orion deployed, going back\nto March 2020.\n\n### User Activity\n\nThe accounts mentioned below include both accounts used by SolarWinds Orion to perform\nits monitoring and management, which are stored within SolarWinds, and local accounts in\nthe Orion server operating system.\n\nDid accounts authenticate (successful or failed) to any systems or applications that\nthey should not have?\n\nIf you do not have logs that go back that far, you will have to perform a search\nacross locally stored logs in your environment.\nDid accounts receive authentication attempts (successful or failed) from external\nlocations, especially those they have not logged in from before (e.g., on the VPN)?\nHave accounts set off impossible travel alerts?\nAre any suspicious OAUTH applications allowed Mail.Read or Mail.ReadWrite\npermissions (or excessive permissions) within Office 365?\n\n### Network Activity\n\nHave any systems connected to known command and control (C2) domains or IP\naddresses?\nHave any systems connected to the DNS sinkhole IP address (20.140.0.1)?\nHave the servers connected to any other external domains or IP addresses?\nHave the servers connected to any internal systems they should not have?\nHave the servers connected to any internal systems at odd times or days?\nHave any new federation trusts been added to existing Azure tenants?\n\n\n-----\n\n### Endpoint Activity\n\nIs the backdoor Dynamic-Link Library (DLL) still present on the Orion servers?\nIs the backdoor DLL on any other servers? (Hint: Use FireEye Yara signatures or\nhashes of DLLs to search.)\nIs there any indication of suspicious activity on the Orion servers?\nIs there any indication of suspicious activity on any systems/applications whose\ncredentials were held within the Orion servers?\nAre there any suspicious ASEPs on the servers or remote access software?\nWere any accounts added or reenabled on the Orion servers or any systems or\napplications to which Orion had administrative access?\nHave all network device configuration files to which Orion had access been validated?\nHave security software (anti-virus, Endpoint Detection and Response (EDR)) detected\nany suspicious activity or malware on systems?\n\n### Post-Exploitation Activity\n\nHas any post-exploitation activity been detected on any system?\n\nFireEye reports state that Cobalt Strike has been used as a post-exploitation\npayload. (https://www.fireeye.com/blog/threat-research/2020/12/evasive-attackerleverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\nKnown files include c:\\windows\\syswow64\\netsetupsvc.dll.\nHas your organization’s domain been leaked in RDP SSL certificates online? (Hint:\nCheck Shodan.)\n\n## Containment\n\nContainment is the process of stopping the spread of or preventing further damage from an\nattack.\n\n1. Quarantine the SolarWinds Orion servers that have the backdoor DLL so they cannot\n\ncommunicate with any other network or system. Possible options include:\n\n1. NULL-routing their IP addresses\n2. Placing the Orion servers in their own network with no access to any other\n\nsystems or the Internet\n3. Utilizing EDR to contain the systems\n4. Shutting down the servers\n\nIf you go this route, be sure to grab live response forensic data first—it is\nbetter to have it and not need it than vice versa.\n\n\n-----\n\n2. Disable any accounts utilized by SolarWinds Orion to access other devices or\n\ncommunicate in your network. These include:\n\n1. Orion platform service account\n2. SQL database service account\n3. Any accounts used for application/system/WMI monitoring from Orion\n4. Accounts used by Orion to email/send alerts\n5. SNMP community strings\n3. Block network communication to the known C2 domains and IP addresses for all\n\nsystems. Possible options include:\n\n1. DNS sinkhole domains\n2. Block IP addresses at firewalls\n3. Block domains and IP addresses in proxy servers\n4. Turn on Sunburst-related IPS signatures\n4. Block all Internet access for SolarWinds Orion servers.\n5. Configure alerting for any system accessing known Indicators of Compromise (IoCs) of\n\nSunburst or the use of any user ID that has been disabled. This should be done for\nboth endpoint and network monitoring.\n\n## Eradication\n\nEradication is the process of removing an attacker or affected system from an environment.\n\n1. Change passwords for any account used by SolarWinds Orion. User sturdyerde posted\n\nan excellent method to do this on SolarWinds’ community forum.\n(https://thwack.solarwinds.com/t5/NPM-Discussions/When-you-have-to-change-allpasswords-for-the-Orion-monitoring/td-p/613340)\n2. Change any shared passwords for accounts that were on the SolarWinds Orion\n\nservers. This includes shared local account passwords or service accounts on the\nsystem.\n3. Change the passwords or community strings that are stored within Orion to perform\n\nmonitoring.\n4. If this was not done in the containment phase, remove the Orion servers from the\n\nnetwork.\n\nNote that instead of changing passwords for accounts, some reports have suggested that it\nis faster and easier to create new accounts and remove the old accounts used in and by\nSolarWinds Orion.\n\n## Recovery\n\nRecovery is the act of bringing systems back to normal operations.\n\n\n-----\n\n1. Back up the SolarWinds configuration and database.\n\n1. Information on how to do this should be in the SolarWinds Orion documentation.\n2. Rebuild the operating system from a known good golden image.\n3. Install SolarWinds version 2020.2.1 HF 2.\n\n[(https://www.solarwinds.com/securityadvisory)](https://www.solarwinds.com/securityadvisory)\n4. Ensure security and endpoint visibility onto the server.\n5. Restore the data from the backed-up configuration and database.\n6. Verify the cryptographic hashes of the SolarWinds.Orion.Core.BusinessLayer.dll file\n\ninstalled to ensure that the backdoor DLL is no longer present.\n\n1. Hashes can be found in the Microsoft customer guidance.\n\nAlternatively, it may not be possible to completely rebuild the server from scratch, although\nthis is our preferred and recommended method. If you cannot do this, perform the following:\n\n1. Back up the SolarWinds configuration and database.\n2. Install the hotfix for SolarWinds Orion 2020.2.1 HF 2.\n3. Ensure security and endpoint visibility into the servers.\n4. Verify the cryptographic hashes of the SolarWinds.Orion.Core.BusinessLayer.dll file\n\ninstalled to ensure that the backdoor DLL is no longer present.\n\nIf you take the restore approach rather than the rebuild approach, you still need to perform\ncontainment and eradication procedures!\n\nRegardless of which approach is taken, the following recovery activities also need to occur:\n\n1. Remove any temporary containment measures that were put into place.\n2. Ensure endpoint and network alerting is configured for the following:\n\n1. Presence of any known IoCs\n2. Use of accounts in a suspicious manner (e.g., a SolarWinds service account\n\ntrying to log in to the VPN)\n3. Ensure all network and endpoint security software is up to date on signatures, including\n\nthose related to Sunburst.\n\n## References to Lists of Known Indicators\n\n[https://github.com/fireeye/sunburst_countermeasures](https://github.com/fireeye/sunburst_countermeasures)\nhttps://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-statecyber-attacks/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-17 - SolarWinds Backdoor (Sunburst) Incident Response Playbook.pdf"
    ],
    "report_names": [
        "2020-12-17 - SolarWinds Backdoor (Sunburst) Incident Response Playbook.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535658,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653785653,
    "ts_modification_date": 1653785653,
    "files": {
        "pdf": "https://archive.orkl.eu/43523adbce1bd284a008b46802c1224e0aa58698.pdf",
        "text": "https://archive.orkl.eu/43523adbce1bd284a008b46802c1224e0aa58698.txt",
        "img": "https://archive.orkl.eu/43523adbce1bd284a008b46802c1224e0aa58698.jpg"
    }
}