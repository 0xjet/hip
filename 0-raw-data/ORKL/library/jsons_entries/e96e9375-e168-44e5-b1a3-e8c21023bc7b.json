{
    "id": "e96e9375-e168-44e5-b1a3-e8c21023bc7b",
    "created_at": "2023-01-12T15:01:26.031821Z",
    "updated_at": "2025-03-27T02:08:40.696874Z",
    "deleted_at": null,
    "sha1_hash": "087b3f7860c40dc99e353daa1118920a9740d426",
    "title": "2020-06-30 - EvilQuest wiper uses ransomware cover to steal files from Macs",
    "authors": "",
    "file_creation_date": "2022-05-28T01:24:39Z",
    "file_modification_date": "2022-05-28T01:24:39Z",
    "file_size": 1414681,
    "plain_text": "# ThiefQuest ransomware is a file-stealing Mac wiper in disguise\n\n**[bleepingcomputer.com/news/security/evilquest-wiper-uses-ransomware-cover-to-steal-files-from-macs/](https://www.bleepingcomputer.com/news/security/evilquest-wiper-uses-ransomware-cover-to-steal-files-from-macs/)**\n\nSergiu Gatlan\n\nBy\n[Sergiu Gatlan](https://www.bleepingcomputer.com/author/sergiu-gatlan/)\n\nJune 30, 2020\n08:31 PM\n5\n\nA new data wiper and info-stealer called ThiefQuest is using ransomware as a decoy to\nsteal files from macOS users. The victims get infected after downloading trojanized\ninstallers of popular apps from torrent trackers.\n\nWhile not common, ransomware has been known to target the macOS platform in the past,\nwith [KeRanger,](https://www.bleepingcomputer.com/tag/keranger/) [FileCoder (aka](https://securelist.com/unfinished-ransomware-for-macos-x/66760/) [Findzip), and](https://blog.malwarebytes.com/cybercrime/2017/02/decrypting-after-a-findzip-ransomware-infection/) [Patcher being three other examples of](https://www.welivesecurity.com/2017/02/22/new-crypto-ransomware-hits-macos/)\nmalware designed to encrypt Mac systems.\n\nThiefQuest was first [spotted by K7 Lab malware researcher Dinesh Devadoss and analyzed](http://twitter.com/dineshdina04/status/1277668001538433025)\nby [Malwarebytes' Director of Mac & Mobile Thomas Reed,](https://blog.malwarebytes.com/mac/2020/06/new-mac-ransomware-spreading-through-piracy/) Jamf Principal Security\n[Researcher Patrick Wardle, and BleepingComputer's Lawrence Abrams, who found an](https://twitter.com/LawrenceAbrams)\ninteresting twist.\n\n## Installs a keylogger and opens a reverse shell\n\n\n-----\n\nDevadoss discovered that ThiefQuest includes the capability to check if it's running in a\nvirtual machine (more of a sandbox check according to Wardle), and it features anti-debug\ncapabilities.\n\nIt also checks for some common security tools (Little Snitch) and antimalware solutions\n(Kaspersky, Norton, Avast, DrWeb, Mcaffee, Bitdefender, and Bullguard) and opens a\nreverse shell used for communication with its command-and-control (C2) server as VMRay\n[technical lead Felix Seele found.](https://twitter.com/c1truz_/status/1277890179257303040)\n\nThe malware will connect to http://andrewka6.pythonanywhere[.]com/ret.txt to get the IP\naddress of the C2 server to download further files and send data.\n\n\"Armed with these capabilities the attacker can maintain full control over an infected host,\"\nWardle said.\n\n**Pirated app infected with ThiefQuest ransomware promoted on RUTracker**\n(Malwarebytes)\n\n## Distributed as pirated apps on torrent sites\n\nAs Reed found after examining the ransomware, ThiefQuest is dropped using infected\ninstallers wrapping legitimate software including but not limited to Little Snitch, Ableton, and\nMixed in Key.\n\nEven though the malicious .PKG installers downloaded from popular torrent sites are code\nsigned and look just as any legitimate installer would when launched, they are distributed as\nDMG files and don't have a custom icon, a warning sign that something is not quite right for\nmany macOS users.\n\nReed also found that, in the case of one of the ThiefQuest samples analyzed, the packages\nof compressed installer files include the pirated apps' original installers and uninstallers,\ntogether with a malicious patch binary and a post-install script used to launch the installer\nand launch the malware.\n\n\n-----\n\nThiefQuest also copies itself into ~/Library/AppQuest/com.apple.questd and creates a\nlaunch agent property list at ~/Library/LaunchAgents/com.apple.questd.plist with a\n_RunAtLoad key set to true to automatically get launched whenever the victim logs into the_\nsystem.\n\nAfter gaining persistence on the infected device, ThiefQuest launches a configured copy of\nitself and starts encrypting files appending a BEBABEDD marker at the end.\n\nUnlike Windows ransomware, ThiefQuest has issues starting to encrypt files. When it does,\nit isn't picky.\n\nIt seems to be locking files randomly, generating various issues on the compromised\nsystem from encrypting the login keychain to resetting the Dock to the default look, and\ncausing Finder freezes.\n\n\n-----\n\nOnce file encryption is complete, it creates a text file named READ_ME_NOW.txt with the\nransom instructions,\" Wardle added, and it will also display and read a modal prompt using\nmacOS' text-to-speech feature letting the users know that their documents were encrypted.\n\nThe victims are asked to pay a $50 ransom in bitcoins within three days (72 hours) to\nrecover their encrypted files and are directed to read a ransom note saved on their\ndesktops.\n\n**ThiefQuest encryption message** **ThiefQuest ransom note**\n\nSuspiciously, ThiefQuest is using the same [static Bitcoin address for all victims and does](https://www.blockchain.com/btc/address/13roGMpWd7Pb3ZoJyce8eoQpfegQvGHHK7)\nnot contain an email address to contact after payment has been made.\n\nThis makes it impossible for the attackers to identify victims who paid the ransom, and for a\nvictim to contact the ransomware operators for a decryptor.\n\nCombining a static Bitcoin address with a lack of contact methods is a strong indication that\nthe ransomware is a wiper instead.\n\nWipers, though, are usually used as a cover for some other malicious activity.\n\n## Wiper malware used for data theft\n\nAfter the malware was analyzed by BleepingComputer's Lawrence Abrams, we believe that\nthe ransomware is simply a decoy for the true purpose of this malware.\n\nThat is to search for and steal certain file types from the infected computer.\n\nWhen the malware is executed on a Mac, it will execute shell commands that download\nPython dependencies, Python scripts disguised as GIF files, and then run them.\n\n\n-----\n\n**Executed shell commands**\n\nSource: BleepingComputer\nThe tasks conducted by the above command are:\n\nDelete the /Users/user1/client/exec.command and /Users/user1/client/click.js files.\nDownload and install PIP\nInstall the Python 'requests' dependency\nDownload p.gif, which is a Python file, and execute it.\nDownload pct.gif, which is another Python file, and execute it.\n\nThe p.gif file is a [heavily obfuscated Python script, and we have not been able to determine](https://pastebin.com/S6CXCRBi)\nwhat its functionality is.\n\n**Heavily obfuscated Python script**\n\nSource: BleepingComputer\nOf particular interest in the above file is the comment:\n\n\n-----\n\n```\n# n__ature checking PoC\n# TODO: PoCs are great but this thing will\n# deliver much better when implemented in\n# production\n\n```\nThe pct.gif file is not obfuscated and is clearly a data exfiltration script that steals files under\nthe /Users folder and sends it to a remote URL.\n\n**Data exfiltration script**\n\nSource: BleepingComputer\nWhen executed, this script will search for any files under the /Users folder that contain the\nfollowing extensions\n```\n.pdf, .doc, .jpg, .txt, .pages, .pem, .cer, .crt, .php, .py, .h, .m, .hpp, .cpp,\n.cs, .pl, .p, .p3, .html, .webarchive, .zip, .xsl, .xslx, .docx, .ppt, .pptx,\n.keynote, .js, .sqlite3, .wallet, .dat\n\n```\nFor any files that matches the search criteria, it will base64 encode the contents of the file\nand send it and the path of the file back to the threat actors Command & Control server.\n\nThese files include text files, images, Word documents, SSL certificates, code-signing\ncertificates, source code, projects, backups, spreadsheets, presentations, databases, and\ncryptocurrency wallets.\n\nTo illustrate how this may look on the other end for the threat actor, BleepingComputer\ncreated a proof-of-concept script that accepted the requests from the above data-stealing\nscript.\n\n\n-----\n\n**PoC of receiving of stolen files**\n\nSource: BleepingComputer\nWhile our PoC only logs the contents of a file to our log file, it could have written each file to\na folder matching the victim's IP address.\n\nOne interesting feature of this script is that it will not transfer any files greater than 800KB in\nsize.\n\nAdvanced Intel's [Vitali Kremez, who BleepingComputer shared the script with, agreed with](https://twitter.com/VK_Intel)\nour findings and pointed out that many of the searched file types are generally over 800KB\nin size.\n\n## What victims should do?\n\nAs you can see, the ThiefQuest wiper is much more damaging than first thought, as not\nonly will data be encrypted, but it may not even be decryptable if a victim pays.\n\nTo make matters worse, the malware will steal files from your computer that contain\nsensitive information that could be used for a variety of malicious purposes, including\nidentity theft, password harvesting, stealing of cryptocurrency, and stealing private security\nkeys and certificates.\n\nIf you were infected with this malware, you should assume any files that match the listed\nextensions have been stolen or compromised in some manner.\n\nWhile it is not known if a decryptor can be made, users can install Wardle's free\nRansomWhere utility, which detects ThiefQuest's attempts to gain persistence and allows\nthem to terminate it once it starts locking their files.\n\nReed also says that Malwarebytes for Mac is capable of detecting this new macOS\nransomware as Ransom.OSX.ThiefQuest and will remove it from infected Macs.\n\nAt the moment, researchers are still looking into what encryption ThiefQuest uses to encrypt\nits victims' files and if there are any weaknesses in the encryption.\n\n\n-----\n\n**_Update July 02, 09:00 EDT: We updated the title and the article to reflect the malware s_**\nname change to ThiefQuest from EvilQuest (a name used by Chaosoft Games Xbox 360\nand PC video game since 2012.)\n\n### Related Articles:\n\n[Apple emergency update fixes zero-day used to hack Macs, Watches](https://www.bleepingcomputer.com/news/security/apple-emergency-update-fixes-zero-day-used-to-hack-macs-watches/)\n\n[These refurbished Macs for testing, relaxing, and experimenting](https://www.bleepingcomputer.com/offer/deals/these-refurbished-macs-for-testing-relaxing-and-experimenting/)\n\n[Apple emergency update fixes zero-days used to hack iPhones, Macs](https://www.bleepingcomputer.com/news/security/apple-emergency-update-fixes-zero-days-used-to-hack-iphones-macs/)\n\n[Industrial Spy data extortion market gets into the ransomware game](https://www.bleepingcomputer.com/news/security/industrial-spy-data-extortion-market-gets-into-the-ransomware-game/)\n\n[Adware Maker Tries to Intimidate Security Firm with Cease and Desist Letters](https://www.bleepingcomputer.com/news/security/adware-maker-tries-to-intimidate-security-firm-with-cease-and-desist-letters/)\n\n## IOCs\n\n### Network traffic:\n```\nhttp://andrewka6.pythonanywhere.com/ret.txt\nhttp://167.71.237.219\n\n Ransom note text:\n\n```\n\n-----\n\n```\nYOUR IMPORTANT FILES ARE ENCRYPTED\nMany of your documents, photos, videos, images and other files are no longer\naccessible because they have been encrypted. Maybe you are busy looking for a way to\nrecover your files, but do not waste your time. Nobody can recover your file without\nour decryption service.\nWe use 256-bit AES algorithm so it will take you more than a billion years to break\nthis encryption without knowing the key (you can read Wikipedia about AES if you\ndon't believe this statement).\nAnyways, we guarantee that you can recover your files safely and easily. This will\nrequire us to use some processing power, electricity and storage on our side, so\nthere's a fixed processing fee of 50 USD. This is a one-time payment, no additional\nfees included.\nIn order to accept this offer, you have to deposit payment within 72 hours (3 days)\nafter receiving this message, otherwise this offer will expire and you will lose\nyour files forever.\nPayment has to be deposited in Bitcoin based on Bitcoin/USD exchange rate at the\nmoment of payment. The address you have to make payment is:\n          13roGMpWd7Pb3ZoJyce8eoQpfegQvGHHK7\nDecryption will start automatically within 2 hours after the payment has been\nprocessed and will take from 2 to 5 hours depending on the processing power of your\ncomputer. After that all of your files will be restored.\nTHIS OFFER IS VALID FOR 72 HOURS AFTER RECEIVING THIS MESSAGE\n\n```\n[Apple](https://www.bleepingcomputer.com/tag/apple/)\n[Data Exfiltration](https://www.bleepingcomputer.com/tag/data-exfiltration/)\n[Mac](https://www.bleepingcomputer.com/tag/mac/)\n[macOS](https://www.bleepingcomputer.com/tag/macos/)\n[Piracy](https://www.bleepingcomputer.com/tag/piracy/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n[ThiefQuest](https://www.bleepingcomputer.com/tag/thiefquest/)\n[Wiper](https://www.bleepingcomputer.com/tag/wiper/)\n\n[Sergiu Gatlan](https://www.bleepingcomputer.com/author/sergiu-gatlan/)\n\nSergiu Gatlan is a reporter who covered cybersecurity, technology, Apple, Google, and a\nfew other topics at Softpedia for more than a decade. Email or Twitter DMs for tips.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/microsoft-releases-urgent-security-updates-for-windows-10-codecs-bugs/)\n[Next Article](https://www.bleepingcomputer.com/news/microsoft/microsoft-lifts-windows-10-2004-update-block-on-surface-devices/)\n\n### Comments\n\n\n-----\n\n[Some-Other-Guy - 1 year ago](https://www.bleepingcomputer.com/forums/u/1150694/some-other-guy/)\n\nThe fix for wipers and ransomware is obvious\n\nThe U.S. Federal Communications Commission (FCC) should formally designate\nApple and Microsoft Operating Systems as national security threats to the integrity of\nU.S. communications networks or the communications supply chain.\n\nEasy Peasy\n\nLoL\n\nWe can ask nicely for physical write protect switches on our drives and SSD's for\nanother 40 years to protect our backups from malware but we ain't getting them are\nwe?\n\nMy backups are on write protected Blu-Ray Optical Discs!\n\nWhere's yours?\n\n[vuksha_xc60 - 1 year ago](https://www.bleepingcomputer.com/forums/u/1167356/vuksha-xc60/)\n\nMaybe it's better to use SD cards for that purpose instead of Blueray discs.\n\n\n-----\n\n[Some-Other-Guy - 1 year ago](https://www.bleepingcomputer.com/forums/u/1150694/some-other-guy/)\n\nDefinitely not!\n\nSD cards are normally rated to retain your data for 12-18 months\nBlu-Ray retains data for several years\n(over 1000 years for M-Disc)\n\nSD cards cost much more than Blu-Ray discs\n\nSD write protection can be defeated easily\nBlu-Ray protection cannot\n\nand lets not forget labelling....\nEver try finding the right backup on hundreds of SD cards?\nIt is much easier to read the contents of a properly labelled optical disc\n\nDyingCrow Photo\n[DyingCrow - 1 year ago](https://www.bleepingcomputer.com/forums/u/1030683/dyingcrow/)\n\nAs we're talking about personal backups, you can create a single container backup\nusing 7zip or something, dump all the stuff in there and manually change the\nextension to something ransomware ignores and is not conspicuous. If that container\nis big enough, there's a good chance it will be unattractive for encryption or\nexfiltration. For example, some custom game archive extensions can be pretty big in\nsize, so use one of those, why not? Heck, you can even use a ransomware extension!\nlul\n\n\n-----\n\n[R-K - 1 year ago](https://www.bleepingcomputer.com/forums/u/1137491/r-k/)\n\nRansomware cyber-terrorists must be put to death sentences.\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-30 - EvilQuest wiper uses ransomware cover to steal files from Macs.pdf"
    ],
    "report_names": [
        "2020-06-30 - EvilQuest wiper uses ransomware cover to steal files from Macs.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535686,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653701079,
    "ts_modification_date": 1653701079,
    "files": {
        "pdf": "https://archive.orkl.eu/087b3f7860c40dc99e353daa1118920a9740d426.pdf",
        "text": "https://archive.orkl.eu/087b3f7860c40dc99e353daa1118920a9740d426.txt",
        "img": "https://archive.orkl.eu/087b3f7860c40dc99e353daa1118920a9740d426.jpg"
    }
}