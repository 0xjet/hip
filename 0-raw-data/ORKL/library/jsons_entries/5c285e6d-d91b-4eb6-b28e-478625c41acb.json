{
    "id": "5c285e6d-d91b-4eb6-b28e-478625c41acb",
    "created_at": "2023-01-12T15:03:41.898267Z",
    "updated_at": "2025-03-27T02:17:23.491789Z",
    "deleted_at": null,
    "sha1_hash": "a080b8d9a64a58c13761f58f921f3a5d6415618d",
    "title": "2022-05-05 - North Korea’s Lazarus- their initial access trade-craft using social media and social engineering",
    "authors": "",
    "file_creation_date": "2022-05-28T15:45:59Z",
    "file_modification_date": "2022-05-28T15:45:59Z",
    "file_size": 201710,
    "plain_text": "# North Korea’s Lazarus: their initial access trade-craft using social media and social engineering\n\n**research.nccgroup.com/2022/05/05/north-koreas-lazarus-and-their-initial-access-trade-craft-using-social-media-and-**\nsocial-engineering/\n\nMay 5, 2022\n\nAuthored by: Michael Matthews and Nikolaos Pantazopoulos\n\n## tl;dr\n\nThis blog post documents some of the actions taken during the initial access phase for an\nattack attributed to Lazarus, along with analysis of the malware that was utilised during this\nphase.\n\nThe methods used in order to gain access to a victim network are widely reported however,\nnuances in post-exploitation provide a wealth of information on attack paths and threat\nhunting material that relate closely to TTP’s of the Lazarus group.\n\n\n-----\n\nIn summary, we identified the following findings:\n\nLazarus used LinkedIn profiles to impersonate employees of other legitimate\ncompanies\nLazarus communicated with target employees through communication channels such\nas WhatsApp.\nLazarus entices victims to download job adverts (zip files) containing malicious\ndocuments that lead to the execution of malware\nThe identified malicious downloader appears to be a variant of LCPDOT\nScheduled tasks are utilised as a form of persistence ( rundll32 execution from a\nscheduled task)\n\n## Initial Access\n\nIn line with what is publicly documented[1], the initial entry revolves heavily around social\nengineering, with recent efforts involving the impersonation of Lockheed Martin employees\nwith LinkedIn profiles to persuade victims into following up with job opportunities that result in\na malicious document being delivered.\n\nIn this instance, the domain hosting the document was `global-job[.]org, likely`\nattempting to impersonate `globaljobs[.]org, a US based government/defence`\nrecruitment website. In order to subvert security controls in the recent changes made by\nMicrosoft for Office macros, the website hosted a ZIP file which contained the malicious\ndocument.\n\nThe document had several characteristics comparable to other Lazarus samples however,\ndue to unknown circumstances, the “shapes” containing the payloads were unavailable and\ncould not be analysed.\n\nFollowing the execution of the macro document, `rundll32.exe is called to execute the`\nDLL `C:\\programdata\\packages.mdb, which then led to the initial command-and-control`\nserver call out. Unfortunately, the binary itself was no longer available for analysis however, it\nis believed that this component led to the LCPDot malware being placed on the victim’s host.\n\n## LCPDot\n\nWe were able to recover a malicious downloader that was executed as a scheduled task.\nThe identified sample appears to be a variant of LCPDot, and it is attributed to the threat\nactor ‘Larazus’.\n\nThe file in question attempted to blend into the environment, leveraging the `ProgramData`\ndirectory once again `C:\\ProgramData\\Oracle\\Java\\JavaPackage.dll . However, the file`\nhad characteristics that stand out whilst threat hunting:\n\n\n-----\n\nLarge file size (60mb+) – likely to bypass anti-virus scanning\nTime stomping – timestamps copied from `CMD.exe`\nDLL owned by a user in the `ProgramData directory (Not SYSTEM or Administrator)`\n\nTo execute LCPDot, a scheduled task was created named “Windows Java Vpn Interface”,\nattempting to blend into the system with the Java theme. The scheduled task executed the\nbinary but also allowed the threat actor to persist.\n\nThe scheduled task was set to run daily with the following parameter passed for execution,\nrunning:\n```\n  <Exec>\n   <Command>c:\\windows\\system32\\rundll32.exe</Command>\n<Arguments>C:\\ProgramData\\Oracle\\Java\\JavaPackage.dll,VpnUserInterface</Arguments>\n  </Exec>\n\n## LCPDot Binary Analysis\n\n```\nThe downloader’s malicious core starts in a separate thread and the execution flow is\ndetermined based on Windows messages IDs (sent by the Windows API function\n```\nSendMessage ).\n\n```\nIn the following sections we describe the most important features that we identified during\nour analysis.\n\n## Initialisation Phase\n\nThe initialisation phase takes place in a new thread and the following tasks are performed:\n\nInitialisation of class `MoscowTownList . This class has the functionality to read/write`\nthe configuration.\nCreation of configuration file on disk. The configuration file is stored under the filename\n```\n   VirtualStore.cab in %APPDATA%\\Local folder. The configuration includes various\n\n```\nmetadata along with the command-and-control servers URLs. The structure that it uses\nis:\n\n\n-----\n\n```\nstruct Configuration\n{\n DWORD Unknown; //Unknown, set to 0 by default. If higher than 20 then it \n        // can cause a 2-hour delay during the network \n        // communication process.\n SYSTEMTIME Variant_SystemTime; // Configuration timestamp created by  \n                // SystemTimeToVariantTime.\n SYSTEMTIME Host_SystemTime; // Configuration timestamp. Updated during\n               // network communication process.\n DWORD Logical_drives_find_flag; // Set to 0 by default\n DWORD Active_sessions_flag; // Set to 0 by default\n DWORD Boot_Time; // Milliseconds since boot time\n char *C2_Data;// Command-and-Control servers’ domains\n};\n\n```\nThe configuration is encrypted by hashing (SHA-1) a random byte array (16 bytes) and then\nuses the hash output to derive (CryptDeriveKey) a RC4 key (16 bytes). Lastly it writes to the\nconfiguration file the random byte array followed by the encrypted configuration data.\n\nEnumeration of logical drives and active logon sessions. The enumeration happens\nonly if specified in the configuration. By default, this option is off. Furthermore, even if\nenabled, it does not appear to have any effect (e.g. sending them to the command-andcontrol server).\n\nOnce this phase is completed, the downloader starts the network communication with its\ncommand-and-control servers.\n\n## Network Communication\n\nAt this stage, the downloader registers the compromised host to the command-and-control\nserver and then requests the payload to execute. In summary, the following steps are taken:\n\nInitialises the classes `Taxiroad and` `WashingtonRoad .`\nCreates a byte array (16 bytes), which is then encoded (base64), and a session ID.\nBoth are sent to the server. The encoded byte array is used later to decrypt the\nreceived payload and is added to the body content of the request:\n```\n   redirect=Yes&idx=%d&num=%s, where idx holds the compromised host’s boot\n\n```\ntime value and `num has the (BASE64) encoded byte array.`\n\nIn addition, the session ID is encoded (BASE64) and added to the following string:\n```\n   SESSIONID-%d-202110, where 202110 is the network command ID.\n\n```\nThe above string is encoded again (BASE64) and then added to the `SESSIONID`\nheader of the POST request.\n\nAfter registering the compromised host, the server replies with one of the following\nmessages:\n\nValidation Success – Bot registered without any issues.\n\n\n-----\n\nValidation Error – An error occurred.\n\nOnce the registration process has been completed, the downloader sends a GET request to\ndownload the second-stage payload. The received payload is decrypted by hashing (SHA-1)\nthe previously created byte array and then use the resulting hash to derive\n( CryptDeriveKey ) a RC4 key.\n\nLastly, the decrypted payload is loaded directly into memory and executed in a new thread.\n\nIn summary, we identified the following commands (Table 1).\n\n**Command ID** **Description**\n\n202110 Register compromised host to the command-and-control server\n\n202111 Request payload from the command-and-control server\n\nTable 1 – Identified network commands\n\n## Unused Commands and Functions\n\nOne interesting observation is the presence of functions and network commands, which the\ndownloader does not seem to use. Therefore, we concluded that the following network\ncommands are not used by the downloader (at least in this variant) but we do believe that\nthe operators may use them on the server-side (e.g. in the PHP scripts that the downloader\nsends data) or the loaded payload does use them (Note: Commands 789020, 789021 and\n_789022 are by default disabled):_\n\n202112 – Sends encrypted data in a POST request. Data context is unknown.\n202114 – Sends a POST request with body content ‘Cookie=Enable’.\n789020 – Same functionality as command ID 202111.\n789021 – Same functionality as command ID 202112.\n789022 – Sends a POST request with body content ‘Cookie=Enable’.\n\n## Indicators of Compromise\n\n Domains\n\nats[.]apvit[.]com – Legitimate Compromised website\nbugs-hpsm[.]mobitechnologies[.]com – Legitimate Compromised website\nglobal-job[.]org\nthefrostery[.]co[.]uk – Legitimate Compromised website\nshoppingbagsdirect[.]com – – Legitimate Compromised website\n\n\n-----\n\n## IP Address\n\n13[.]88[.]245[.]250\n\n## Hashes\n\n### Javapackage.dll\n\nMD5: AFBCB626B770B1F87FF9B5721D2F3235\n\nSHA1: D25A4F20C0B9D982D63FC0135798384C17226B55\n\nSHA256:\nFD02E0F5FCF97022AC266A3E54888080F66760D731903FC32DF2E17E6E1E4C64\n\n### Virtualstore.cab\n\nMD5: 49C2821A940846BDACB8A3457BE4663C\n\nSHA1: 0A6F762A47557E369DB8655A0D14AB088926E05B\n\nSHA256:\nF4E314E8007104974681D92267673AC22721F756D8E1925142D9C26DC8A0FFB4\n\n## MITRE ATT&CK\n\n**Technique** **ID**\n\nPhishing: Spearphishing via Service T1566.003\n\nScheduled Task/Job: Scheduled Task T1053.005\n\nUser Execution: Malicious File T1204.002\n\nApplication Layer Protocol T1071.001\n\nMITRE ATT&CK\n\n## References\n\n[1] https://www.microsoft.com/security/blog/2021/01/28/zinc-attacks-against-securityresearchers/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-05 - North Korea’s Lazarus- their initial access trade-craft using social media and social engineering.pdf"
    ],
    "report_names": [
        "2022-05-05 - North Korea’s Lazarus- their initial access trade-craft using social media and social engineering.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535821,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1653752759,
    "ts_modification_date": 1653752759,
    "files": {
        "pdf": "https://archive.orkl.eu/a080b8d9a64a58c13761f58f921f3a5d6415618d.pdf",
        "text": "https://archive.orkl.eu/a080b8d9a64a58c13761f58f921f3a5d6415618d.txt",
        "img": "https://archive.orkl.eu/a080b8d9a64a58c13761f58f921f3a5d6415618d.jpg"
    }
}