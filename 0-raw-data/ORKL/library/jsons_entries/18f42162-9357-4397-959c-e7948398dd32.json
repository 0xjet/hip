{
    "id": "18f42162-9357-4397-959c-e7948398dd32",
    "created_at": "2023-01-12T15:10:46.433433Z",
    "updated_at": "2025-03-27T02:17:05.504548Z",
    "deleted_at": null,
    "sha1_hash": "347e5512042fb572e573ab464c62feb41347f131",
    "title": "2022-05-12 - Threat Thursday- Malware Rebooted - How Industroyer2 Takes Aim at Ukraine Infrastructure",
    "authors": "",
    "file_creation_date": "2022-05-28T23:25:52Z",
    "file_modification_date": "2022-05-28T23:25:52Z",
    "file_size": 1190242,
    "plain_text": "# Threat Thursday: Malware Rebooted - How Industroyer2 Takes Aim at Ukraine Infrastructure\n\n**blogs.blackberry.com/en/2022/05/threat-thursday-malware-rebooted-how-industroyer2-takes-aim-at-ukraine-**\ninfrastructure\n\nThe BlackBerry Research & Intelligence Team\n\n[1. BlackBerry ThreatVector Blog](https://blogs.blackberry.com/en.html)\n2. Threat Thursday: Malware Rebooted - How Industroyer2 Takes Aim at Ukraine\n\nInfrastructure\n\n[Since the outbreak of conflict in Eastern Ukraine in 2014, following Russia’s annexation of](https://www.cfr.org/global-conflict-tracker/conflict/conflict-ukraine)\nCrimea, there have been several notable attempts to disrupt the electrical infrastructure of\nthe country. While an attack with Industroyer2 was recently thwarted, analysis of this\nmalware provides useful insight into threat actors’ behaviors.\n\n[Industroyer2 was first reported by CERT-UA and confirmed by ESET on April 12, 2022, as](https://cert.gov.ua/article/39518)\nthe third major attempt at taking out part of Ukraine’s electrical substations and controllers.\n[This attack was repelled by CERT-UA in partnership with ESET.](https://www.cnbc.com/2022/04/12/ukraine-says-russian-cyberattack-sought-to-shut-down-energy-grid.html)\n\nThis was just the latest in a string of attacks against Ukraine’s electric grid. The first\nelectrical disruption attempt occurred in December 2015, using an updated version of the\n[BlackEnergy malware. This attack successfully caused power outages in several regions of](https://blogs.blackberry.com/en/2016/01/blackenergy-and-the-ukraine-signals-vs-noise)\n\n\n-----\n\n[Ukraine. In December 2016, the first version of Industroyer caused blackouts for several](https://cyberlaw.ccdcoe.org/wiki/Industroyer_%E2%80%93_Crash_Override_(2016))\nhours in the capital, Kyiv.\n\n[The 2015 and 2016 attacks were both attributed to the Sandworm group. It is likely](https://attack.mitre.org/groups/G0034/)\nIndustroyer2 is yet another attempt by the Sandworm group to cause damage to the critical\ninfrastructure of Ukraine in support of the ongoing Russian incursions. The U.S. Department\n[of Justice has previously released indictments accusing the Russian GRU of being behind](https://www.justice.gov/opa/pr/six-russian-gru-officers-charged-connection-worldwide-deployment-destructive-malware-and)\nBlackEnergy and Industroyer in an attempt to “undermine, retaliate against, or otherwise\ndestabilize” Ukraine, among other geopolitical targets.\n\n### Operating System\n\n Risk & Impact\n\n Technical Analysis\n\n**Overview**\n\nSample:\n**D69665F56DDEF7AD4E71971F06432E59F1510A7194386E5F0E8926AEA7B88E00**\n\n_Figure 1 – Compilation date_\n\nIndustroyer2 was compiled on March 23, 2022, nearly a month after the initial invasion of\nUkraine. This threat was deployed alongside several wipers, a worm, and a loader. CERTUA reports that the wipers that came with the attack included CaddyWiper, SoloShred, and\nAwfulShred. CaddyWiper targets Windows® systems, while the other wipers target Linux®\nsystems. The Linux worm OrcShred and the loader ArguePatch were also included.\n\n\n-----\n\nTo understand how Industroyer2 works, we first need to look into the IEC 60870-5-104\nprotocol used for communication on a TCP/IP network. This protocol is used in the\nUkrainian electrical stations and substations that were targeted by this attack. By following\nthe commands used by the malware, we can observe the execution flow of Industroyer2\nand see what messages are sent to disrupt the targeted devices.\n\n### IEC-104\n\nThe [IEC 60870-5-104 protocol, shortened as IEC-104, is a telecontrol equipment and](https://www.fit.vut.cz/research/publication-file/11570/TR-IEC104.pdf)\nsystems standardization for TCP communication over port 2404. This protocol is used to\ninterface with power control stations and substations.\n\nAn Application Protocol Data Unit (APDU) transmission frame contains the Application\nService Data Unit (ASDU), which is a message structure carrying application data sent\nbetween stations. The ASDU transmits an Information Object Address (IOA), which is used\nto interact with the switches and breakers in a station. During normal everyday function, a\ncontroller can send an APDU frame with an ASDU that contains specific IOA commands to\nchange the state of the stations and substations.\n\nStatus checking on the controller stations is carried out by sending a Test Frame (TESTFR)\ncommand – TESTFR act APDU, to activate – which is verified with a return – TESTFR con\nAPDU, to confirm the system is online. The commands Start Data Transfer (STARTDT) and\nStop Data Transfer (STOPDT) control data transfer from the control station. These actions\nare sent in an APDU.\n\n### Behavior\n\nOnce Industroyer2 is launched, a command prompt window opens and displays the\ncommands that are being sent and received, as seen in Figure 2. In this instance, we see\nthat port 2404 is being targeted. Port 2404 is used by IEC-104 to send TCP messages. This\noutput also corresponds to the IOA commands found inside the file, which are shown in\nFigure 3.\n\n\n-----\n\nFigure 2 – Console output while executing\n\n_Figure 3 – Configuration found inside the file_\n\nA TESTFR act APDU is sent to establish a connection to a station, shown in Figure 4,\nalong with a STARTDT command. Upon successful connection, a TESTFR con APDU is\nsent back from the station. With the confirmation received from the station, a STARTDT\nAPDU is sent to open data transfer. As with TESTFR, STARTDT will need to send an act to\nactivate, and to receive a con from the station to confirm, before data transfer can begin.\n\n_Figure 4 – TESTFR act and STARTDT act commands_\n\nNext, the ASDU frames will communicate commands to the station, as shown in Figure 5.\nAn ASDU interrogation command determines the status of the station. The hardcoded\nmessages in Figure 3 will get sent and modify the station’s IOA.\n\n_Figure 5 – ASDU IOA commands_\n\nNot much else can be discerned from these IOA modifications without knowledge of the\nspecific systems that were being targeted. This points to the possibility that the malware\nauthors have some level of access or insider knowledge of the systems they were\nattacking.\n\n### Industroyer vs. Industroyer2\n\nWhile Industroyer2 is an updated version of the original Industroyer, it comes with a slightly\nnarrower scope of action. The original version of the threat had four distinct modules\ntargeting IEC 60870-5-101 (IEC-101), IEC 60870-5-104 (IEC-104), IEC-61850, and OLE for\n\n\n-----\n\nProcess Control Data Access (OPC DA).\n\nIEC-101 is a protocol for controlling and monitoring electrical stations, while IEC-104 utilizes\nIEC-101 and sends communications over a TCP/IP network. IEC-61850 is a communication\nstandard for automated substation devices, and OPC DA is a client-server standardization\nfor real-time data acquisition devices.\n\nIndustroyer2 focuses primarily on disrupting services by targeting the IEC-104 controllers.\nIt’s not clear why the focus was narrowed down to this one service, but judging from the\ncompilation date of March 23, 2022, the malware was likely rushed through development.\nAdditionally, Industroyer has a separate config file with the IOAs, while Industroyer2 stores\nthat information inside its executable.\n\n### Conclusion\n\nIndustroyer2 is the latest attempt by state-level threat actors to cause what they hope will\n[be severe damage to the critical infrastructure of the targeted region. This tactic has proven](https://www.blackberry.com/us/en/solutions/endpoint-security/shields-up-protecting-critical-infrastructure)\neffective in the past as a method of spooking the populace, even when the attack itself was\nnot successful.\n\nFew details surrounding this specific attack are currently available to us, but what we do\nknow is that the deployment of Industroyer2 represents an increasing escalation of\ncyberattacks on Ukraine’s crucial resources. Attackers are now escalating their intrusion\nattempts far beyond the usual “smash-and-grab” tactics of infostealing, to focus on just the\n“smash” part. This method of operation not only causes population distress and widespread\ndisruptions, but also has the potential to take out critical infrastructure in a way that causes\nimmediate damage to the basic services that keep countries functioning.\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to\ncatch the threat described in this document:\n\n\n-----\n\nrule Industroyer2{\n\nmeta:\n\ndescription = \"Detects Industroyer2\"\n\nauthor = \"BlackBerry Threat Research Team\"\n\ndate = \"2022-05-03\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n\n$s1 = \"02d:%lS\" wide\n\n$s2 = \"M%X - %02d:%02d:%02d\" wide\n\n$s3 = \"02hu:%02hu:%02hu:%04hu\" wide\n\n$s4 = \"T%d %08x\" wide\n\n$s5 = \"T%d %h\" wide\n\n$s6 = \"%s M%X %d (%s)\" wide\n\n$s7 = \"%s M%X SGCNT %d\" wide\n\n$s8 = \"ASDU:%u | OA:%u | IOA:%u\" wide\n\n$s9 = \"Cause: %s (x%X) | Telegram type: %s (x%X)\" wide\n\n$c1 = \"TESTFR act\" wide\n\n$c2 = \"TESTFR con\" wide\n\n$c3 = \"STARTDT act\" wide\n\n$c4 = \"STARTDT con\"\n\ncondition:\n\nuint16(0) == 0x5a4d and filesize < 50KB and all of them\n\n}\n\n### Indicators of Compromise (IoCs)\n\n\n-----\n\nD69665F56DDEF7AD4E71971F06432E59F1510A7194386E5F0E8926AEA7B88E00\n\n43D07F28B7B699F43ABD4F695596C15A90D772BFBD6029C8EE7BC5859C2B0861\n\nBCDF0BD8142A4828C61E775686C9892D89893ED0F5093BDC70BDE3E48D04AB99\n\n87CA2B130A8EC91D0C9C0366B419A0FCE3CB6A935523D900918E634564B88028\n\nCDA9310715B7A12F47B7C134260D5FF9200C147FC1D05F030E507E57E3582327\n\n1724A0A3C9C73F4D8891F988B5035EFFCE8D897ED42336A92E2C9BC7D9EE7F5A\n\nFC0E6F2EFFBFA287217B8930AB55B7A77BB86DBD923C0E8150551627138C9CAA\n\n7062403BCCACC7C0B84D27987B204777F6078319C3F4CAA361581825C1A94E87\n\n3851A064AABAB557CE162E01A77681B3954B006117EDD0563EDD2B3E5A082ACE\n\nEA16CB89129AB062843C84F6C6661750F18592B051549B265AAF834E100CD6FC\n\n### References\n\n[https://cert.gov.ua/article/39518](https://cert.gov.ua/article/39518)\n\n[https://www.welivesecurity.com/2022/04/12/industroyer2-industroyer-reloaded/](https://www.welivesecurity.com/2022/04/12/industroyer2-industroyer-reloaded/)\n\n[https://pylos.co/2022/04/23/industroyer2-in-perspective/](https://pylos.co/2022/04/23/industroyer2-in-perspective/)\n\n[https://www.fit.vut.cz/research/publication-file/11570/TR-IEC104.pdf](https://www.fit.vut.cz/research/publication-file/11570/TR-IEC104.pdf)\n\n[https://www.mandiant.com/resources/industroyer-v2-old-malware-new-tricks](https://www.mandiant.com/resources/industroyer-v2-old-malware-new-tricks)\n\n[https://attack.mitre.org/groups/G0034/](https://attack.mitre.org/groups/G0034/)\n\nhttps://www.justice.gov/opa/pr/six-russian-gru-officers-charged-connection-worldwidedeployment-destructive-malware-and\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless\nof your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\n\n-----\n\nWe have a global consulting team standing by to assist you, providing around-the-clock\nsupport where required, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incidentresponse-containment\n\n### Related Reading\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-12 - Threat Thursday- Malware Rebooted - How Industroyer2 Takes Aim at Ukraine Infrastructure.pdf"
    ],
    "report_names": [
        "2022-05-12 - Threat Thursday- Malware Rebooted - How Industroyer2 Takes Aim at Ukraine Infrastructure.pdf"
    ],
    "threat_actors": [
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536246,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1653780352,
    "ts_modification_date": 1653780352,
    "files": {
        "pdf": "https://archive.orkl.eu/347e5512042fb572e573ab464c62feb41347f131.pdf",
        "text": "https://archive.orkl.eu/347e5512042fb572e573ab464c62feb41347f131.txt",
        "img": "https://archive.orkl.eu/347e5512042fb572e573ab464c62feb41347f131.jpg"
    }
}