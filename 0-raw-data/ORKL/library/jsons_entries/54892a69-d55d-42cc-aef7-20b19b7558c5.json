{
    "id": "54892a69-d55d-42cc-aef7-20b19b7558c5",
    "created_at": "2023-01-12T15:03:34.848627Z",
    "updated_at": "2025-03-27T02:16:25.6241Z",
    "deleted_at": null,
    "sha1_hash": "a114516e04a2ac13ab4a279692bdf8dbc74d7789",
    "title": "2021-08-11 - IISerpent- Malware‑driven SEO fraud as a service",
    "authors": "",
    "file_creation_date": "2022-05-28T02:46:37Z",
    "file_modification_date": "2022-05-28T02:46:37Z",
    "file_size": 467015,
    "plain_text": "# IISerpent: Malware‑driven SEO fraud as a service\n\n**[welivesecurity.com/2021/08/11/iiserpent-malware-driven-seo-fraud-service/](https://www.welivesecurity.com/2021/08/11/iiserpent-malware-driven-seo-fraud-service/)**\n\nAugust 11, 2021\n\nThe last in our series on IIS threats introduces a malicious IIS extension used to manipulate\npage rankings for third-party websites\n\n[Zuzana Hromcová](https://www.welivesecurity.com/author/zhromcova/)\n11 Aug 2021 - 11:30AM\n\nThe last in our series on IIS threats introduces a malicious IIS extension used to manipulate\npage rankings for third-party websites\n\n\n-----\n\nESET researchers have discovered and analyzed a previously undocumented server-side\ntrojan that manipulates search engine results by hijacking the reputation of the websites it\ncompromises. We named the trojan IISerpent to highlight its two main features: being\nimplemented as a malicious extension for Internet Information Services (IIS) web server,\nand using shady techniques to manipulate search engine result pages (SERPs). IISerpent’s\noperators use a variety of techniques for search engine optimization (SEO), in an attempt to\nimprove page ranking for third-party websites – likely the paying customers of these\ncriminals.\n\n_This blogpost is the last installment in our series where ESET researchers put IIS web_\n_server threats under the microscope – the previous parts discuss IIS malware used for_\n_[cybercrime and](https://www.welivesecurity.com/2021/08/06/iistealer-server-side-threat-ecommerce-transactions/)_ _[cyberespionage. For a comprehensive guide on how to detect, analyze and](https://www.welivesecurity.com/2021/08/09/iispy-complex-server-side-backdoor-antiforensic-features/)_\n_remove IIS malware, refer to our white paper Anatomy of native IIS malware, where_\n_IISerpent is featured as one of the studied families (Group 13)._\n\n[Anatomy of native IIS malware](https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-Anatomy-Of-Native-Iis-Malware-wp.pdf)\n\n[Download Research Paper](https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-Anatomy-Of-Native-Iis-Malware-wp.pdf)\n\n## Attack overview\n\nIISerpent is implemented, and configured, as a malicious extension for IIS – Microsoft’s web\nserver software. That allows the malware to intercept all HTTP requests made to the\nwebsites hosted by the compromised server, but also to actively change the server’s HTTP\nresponses. In the previous installments of this series, we discussed how other IIS malware\nfamilies leverage these powers – for example, to steal credit card information from e[commerce website customers (IIStealer), or to execute backdoor commands on the](https://www.welivesecurity.com/2021/08/06/iistealer-server-side-threat-ecommerce-transactions/)\n[compromised IIS server (IISpy).](https://www.welivesecurity.com/2021/08/09/iispy-complex-server-side-backdoor-antiforensic-features/)\n\nContrary to those families, IISerpent directly affects neither the compromised server nor the\nserver’s users – in fact, this malware completely ignores all requests coming from legitimate\nvisitors of the compromised websites. The malware listens to and parses all HTTP requests\nsent to the compromised server, only to search for those originating from specific search\nengine crawlers. As shown in Figure 1, IISerpent relays these requests to its C&C server (or\nuses its local configuration) to modify the content served to these crawlers.\n\n\n-----\n\n_Figure 1. IISerpent operating mechanism_\n\n### SEO fraud\n\nWhat is the purpose of this scheme? Search engines regularly crawl the internet, and then\nindex (record) all the content found online, building associations between search terms and\nthe content and using various algorithms to calculate rankings of the results for particular\nsearch terms.\n\nVarious legitimate techniques can be used to increase page ranking in search engine result\npages – buying advertisements or employing search engine optimization (SEO) strategies –\nbut not all digital marketers play by the rules. The term unethical SEO (historically known as\n[black hat SEO) refers to SEO-boosting techniques (which, however,](https://blog.hubspot.com/marketing/black-hat-seo) violate webmaster\nguidelines), such as loading pages with irrelevant keywords, or buying backlinks to increase\na website’s reputation.\n\nIISerpent’s attack pattern uses some of these unethical SEO techniques, and could be best\ndescribed as “SEO fraud as a service” – as it employs SEO fraud techniques on\ncompromised IIS servers for the benefit of a third party without webmaster consent.\nIISerpent’s operators use this malware to boost page ranking for third-party websites by\nleeching off the compromised website’s ranking and by employing the following techniques:\n\nRedirecting the search engines to the particular website chosen by the attacker,\n[effectively making the compromised website a doorway page](https://developers.google.com/search/docs/advanced/guidelines/doorway-pages)\nInjecting a list of backlinks (pre-configured or obtained from the C&C server on the fly)\ninto the HTTP response for search engine crawlers, making the servers compromised\nby IISerpent something of a [link farm](https://en.wikipedia.org/wiki/Link_farm)\n\nIn an example scenario shown in Figure 2, an adversary compromises a number of IIS\nservers with IISerpent, and uses its capabilities to inject backlinks to all websites hosted by\nthese servers. Websites 1 – N are legitimate, with good reputations; from the perspective of\na search engine crawler, they all link to a third-party website of the attacker’s choice (in this\ncase, a scam website). As a result, the scam website may seem more popular – since it is\nreferenced by reputable websites – which may boost its page ranking.\n\n\n-----\n\n_Figure 2. Example of an SEO fraud mechanism_\n\nNote that the legitimate visitors of the compromised server will still be served the expected\ncontent, so the users and the webmaster may fail to notice that something is wrong with the\nserver. This sets IISerpent apart from [other malware](https://www.buzzfeednews.com/article/craigsilverman/hackers-website-links-backlinks-seo-spam) [families that inject artificial backlinks](https://elite-strategies.com/inside-a-hacked-seo-backlink-network/)\ninto compromised sites – by operating as a server extension, IISerpent can reserve these\nmodifications for the search engine crawlers, without interfering with content served to\nstandard visitors (as opposed to permanently modifying the compromised website by\nadding the undesired backlinks for all its visitors to see).\n\nOf course, the misused websites hosted on the compromised IIS servers do not benefit at\nall in this scheme – on the contrary, it is against the webmaster guidelines to fool the search\nengine crawlers by displaying a different version of the website to them than the one shown\nto the regular visitors, and so these websites could even end up penalized by the search\nengines, lowering their SEO statistics.\n\n## Technical analysis\n\nUnder its skin, IISerpent is a native IIS module – implemented as a C++ DLL and\nconfigured in the %windir%\\system32\\inetsrv\\config\\ApplicationHost.config file. That way,\nIISerpent secures both persistence and execution, as all IIS modules are loaded by the IIS\n\n\n-----\n\nWorker Processes (w3wp.exe) and used to handle inbound HTTP requests.\n\nWe don’t have any information about how IISerpent’s operators initially penetrate IIS\nservers, but we know that administrative privileges are required to configure it as a native\nIIS module, which reduces the number of plausible scenarios. A configuration weakness or\nvulnerability in a web application or the server are likely culprits.\n\nAs with all native IIS modules, IISerpent exports a function called RegisterModule (see\nFigure 3), which implements the module initialization. The core malicious functionality is\n[hidden in its event handlers – methods of the module class (inherited from CHttpModule)](https://docs.microsoft.com/en-us/iis/web-development-reference/native-code-api-reference/chttpmodule-class)\nthat are called on certain server events. More specifically, IISerpent’s code class overrides\nits OnBeginRequest and OnSendResponse methods, which means that the malware’s\nhandlers will be called every time the IIS server starts processing a new inbound HTTP\nrequest, and every time it sends the response buffer.\n\n_Figure 3. IISerpent’s DLL exports_\n\nIISerpent parses the incoming requests and uses its complex configuration data to\nmanipulate content served to search engine crawlers. As Table 1 lists in full, the\nconfiguration includes fields such as a redirect URL, or a list of backlinks to be injected. The\nattackers can display or update the malware’s configuration by sending any HTTP request\nto the compromised IIS server with the query parameter ?DisplayModuleConfig=1 or ?\nReloadModuleConfig=1, respectively, in the request URI.\n\nUpon receiving the update request, IISerpent obtains the configuration from the C&C server\nby sending an HTTP GET request to this URL:\n\nhttp://sb.qrfy[.]net/mconfig/<host>.xml\n\nThe value <host> is taken from the original attacker request, and it is probably used as a\nvictim ID. The libcurl library is used for the network communication.\n\n_Table 1. Configuration fields used by IISerpent_\n\n**Configuration**\n**field** **Comment**\n\n\n-----\n\n**Configuration**\n**field** **Comment**\n\nbanip List of IP addresses. The malware ignores HTTP requests from these\nIP addresses.\n\nredirectreferer Binary flag – set if the malware should handle requests with the\nstrings spider, bot or baidu.com/ in the Referer header.\n\nonlymobilespider Binary flag – set if the malware should only handle crawler requests\nwith the strings Android or AppleWebKit in the Referer header.\n\nredirect If these values are set, the malware will redirect all crawler requests\nto the configured URL via an HTTP 301 response.\n\nredirecturl\n\nproxy If these values are set, the malware will forward the search engine\ncrawler requests to its C&C server, and replace the HTTP response\nwith the obtained data, instead of redirecting the crawlers to a\nmalicious URL directly.\n\nproxyurl\n\nproxymode\n\nfolderlink If these values are set, the malware will add all of them as backlinks\nto the response for any HTTP request with the strings spider or bot in\nthe User-Agent header.\n\nfolderlinkcount\n\nfolderlinkpath\n\nproxyfolder\n\nlocallink\n\nlocallinkext\n\nlocallinkfolder\n\nlocallinkcount\n\nIISerpent recognizes search engine crawler requests by parsing the User-Agent header and\nlooking for specific substrings, as seen in Figure 4. If the redirecturl field is configured, the\nmalware redirects all requests with the strings spider or bot in the User-Agent header to this\nURL by setting the Location header in the HTTP response. The HTTP status is set to 301\n(“Moved Permanently”).\n\n\n-----\n\n_Figure 4. IISerpent recognizes search engine crawler requests by parsing the User-Agent header_\n\nIf proxymode is set, instead of redirecting the crawlers to a malicious URL, IISerpent\nforwards the crawler request to its C&C server proxyurl, and replaces the HTTP response\nbody with the acquired data. This is applied to all the HTTP requests with spider, bot or\nbaidu.com/ in the Referer header, or optionally to requests with the strings Android or\nAppleWebKit in the Referer header. Additionally, the malware can be configured to:\n\nOnly handle those HTTP requests where the IIS server has set the response status to\n404\nIgnore requests coming from a configurable list of banned IP addresses\n\nFinally, IISerpent can have a list of links configured and add these links to the HTTP\nresponse body for any search engine crawler requests. These links are added as HTML\nentities to the existing HTTP response body:\n\n<a href=’/<link><timestamp1>_<timestamp2>_<randomId>.html’></a>\n\n## Other notable serpents\n\n\n-----\n\nIISerpent is not the only known malicious IIS module with SEO fraud capabilities – out of\n[the 14 malware families we analyzed for our paper Anatomy of native IIS malware, six have](https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-Anatomy-Of-Native-Iis-Malware-wp.pdf)\nsupport for SEO fraud techniques. In these families, the SEO fraud functionality is often\nbundled with other malicious capabilities (such as backdoor support, or serving malicious\ncontent to legitimate website visitors).\n\nWhile we first detected IISerpent in May 2021, we were able to trace the SEO fraud\nphenomenon to the first publicly known case in 2019, when Secpulse published an incident\nreport in Chinese on unnamed malware affecting IIS servers. The analysis of that malware\nand its SEO fraud capabilities is featured in our white paper under the Group 9 category.\n\nThe various SEO fraud families that we analyzed differ in the unethical SEO techniques\nsupported, and target a wide range of search engine crawlers – specified in the clear\n(Group 12 in the paper, as shown in Figure 5), as an encrypted list (Group 9), or obtained\non the fly by querying DNS TXT records of the C&C server hostname (Group 11). All these\nfamilies are detected by ESET security solutions as Win32/BadIIS.\n\n_Figure 5. Example of strings used to recognize search engine crawler requests by IIS malware_\n\n[For a complete breakdown of these other IIS malware families, refer to our white paper.](https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-Anatomy-Of-Native-Iis-Malware-wp.pdf)\n\n\n-----\n\n## Conclusion\n\nIISerpent is a malicious IIS module with unusual targets and purpose, designed to aid in\nshady practices aimed at boosting the page rank of third-party websites. Even though it\ndoesn’t affect legitimate visitors of the compromised server, it nevertheless still deserves\nattention for distorting search results, and its potential for monetization.\n\nOn top of hijacking the reputation of the compromised websites, IISerpent can be a cause\nfor headaches for the digital marketers, as any website participating in unethical SEO\npractices can be penalized by search engine algorithms. The best bet to prevent a\ncompromise by IISerpent (and other IIS malware) is keeping your IIS servers up to date,\nand being careful not to download IIS extensions from untrusted sources – be especially\naware of modules promising too-good-to-be-true features such as magically improving\nSEO. For additional protection, consider using a web application firewall, and/or a security\nsolution on your IIS server.\n\n_Additional mitigation recommendations and Indicators of Compromise can be found in our_\n_[comprehensive white paper, and on](https://i.blackhat.com/USA21/Wednesday-Handouts/us-21-Anatomy-Of-Native-Iis-Malware-wp.pdf)_ _[GitHub. For any inquiries, or to make sample](https://github.com/eset/malware-ioc/tree/master/badiis)_\n_[submissions related to the subject, contact us at: threatintel@eset.com.](http://10.10.0.46/mailto:threatintel@eset.com)_\n\n## Indicators of Compromise (IoCs)\n\n### ESET detection names\n\nWin32/BadIIS.H\n\n### SHA-1\n\nD0F274EBD2A0636FEF9D9C48A7AC2FAD7B661653\n\n### Filename\n\nstati.dll\n\n### Network indicators\n\n**_URL query parameters_**\n\n?DisplayModuleConfig=1\n\n?ReloadModuleConfig=1\n\n**_C&C server_**\n\nhttp://sb.qrfy[.]net\n\n\n-----\n\n## MITRE ATT&CK techniques\n\n_[Note: This table was built using version 9 of the MITRE ATT&CK framework.](https://attack.mitre.org/resources/versions/)_\n\n**Tactic** **ID** **Name** **Description**\n\n\nResource\nDevelopment\n\n\n[T1587.001](https://attack.mitre.org/versions/v9/techniques/T1587/001/) Develop\nCapabilities:\nMalware\n\n\nExecution [T1569.002](https://attack.mitre.org/versions/v9/techniques/T1569/002/) System\nServices:\nService\nExecution\n\nPersistence [T1546](https://attack.mitre.org/versions/v9/techniques/T1546/) Event Triggered\nExecution\n\n\nIISerpent is a custom-made malware\nfamily.\n\nIIS server (and by extension, IISerpent)\npersists as a Windows service.\n\nIISerpent is loaded by the IIS Worker\nProcess (w3wp.exe) when the IIS server\nreceives an inbound HTTP request.\n\nAdversaries send HTTP requests with\nspecific query parameters to the\ncompromised IIS server to control\nIISerpent.\n\nIISerpent modifies content served by the\ncompromised server to search engine\ncrawlers.\n\n\nCommand\nand Control\n\n\n[T1071.001](https://attack.mitre.org/versions/v9/techniques/T1071/001/) Application\nLayer Protocol:\nWeb Protocols\n\n\nImpact [T1565.002](https://attack.mitre.org/versions/v9/techniques/T1565/002/) Data\nManipulation:\nTransmitted\nData\nManipulation\n\n11 Aug 2021 - 11:30AM\n\n\n-----\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-11 - IISerpent- Malware‑driven SEO fraud as a service.pdf"
    ],
    "report_names": [
        "2021-08-11 - IISerpent- Malware‑driven SEO fraud as a service.pdf"
    ],
    "threat_actors": [
        {
            "id": "3fad11c6-4336-4b28-a606-f510eca5452e",
            "created_at": "2022-10-25T16:07:24.346573Z",
            "updated_at": "2025-03-27T02:02:10.183211Z",
            "deleted_at": null,
            "main_name": "Turbine Panda",
            "aliases": [
                "APT 26",
                "Black Vine",
                "Bronze Express",
                "Group 13",
                "JerseyMikes",
                "KungFu Kittens",
                "PinkPanther",
                "Shell Crew",
                "Turbine Panda",
                "WebMasters"
            ],
            "source_name": "ETDA:Turbine Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Hurix",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mivast",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sakula",
                "Sakula RAT",
                "Sakurel",
                "Sogu",
                "StreamEx",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon",
                "ffrat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "46a151bd-e4c2-46f9-aee9-ee6942b01098",
            "created_at": "2023-01-06T13:46:38.288168Z",
            "updated_at": "2025-03-27T02:00:02.794118Z",
            "deleted_at": null,
            "main_name": "APT19",
            "aliases": [
                "Black Vine",
                "TEMP.Avengers",
                "PinkPanther",
                "G0073",
                "KungFu Kittens",
                "Group 13",
                "Shell Crew",
                "BRONZE FIRESTONE",
                "G0009",
                "Sunshop Group",
                "DEEP PANDA",
                "Codoso"
            ],
            "source_name": "MISPGALAXY:APT19",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535814,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653705997,
    "ts_modification_date": 1653705997,
    "files": {
        "pdf": "https://archive.orkl.eu/a114516e04a2ac13ab4a279692bdf8dbc74d7789.pdf",
        "text": "https://archive.orkl.eu/a114516e04a2ac13ab4a279692bdf8dbc74d7789.txt",
        "img": "https://archive.orkl.eu/a114516e04a2ac13ab4a279692bdf8dbc74d7789.jpg"
    }
}