{
    "id": "156192c4-dd99-4f86-ae6f-a5c350d7cda2",
    "created_at": "2023-02-02T02:07:59.413359Z",
    "updated_at": "2025-03-27T02:06:11.806167Z",
    "deleted_at": null,
    "sha1_hash": "35db8838ddadac02d41ea01fdd31ba81e9d1a9c6",
    "title": "2022-10-19 - From RM3 to LDR4- URSNIF Leaves Banking Fraud Behind",
    "authors": "",
    "file_creation_date": "2023-02-01T07:47:39Z",
    "file_modification_date": "2023-02-01T07:47:39Z",
    "file_size": 8352170,
    "plain_text": "# From RM3 to LDR4: URSNIF Leaves Banking Fraud Behind\n\n**mandiant.com/resources/blog/rm3-ldr4-ursnif-banking-fraud**\n\nA new variant of the URSNIF malware, first observed in June 2022, marks an important milestone for the tool. Unlike previous iterations of\n[URSNIF, this new variant, dubbed LDR4, is not a banker, but a generic backdoor (similar to the short-lived SAIGON variant), which may have](https://www.mandiant.com/resources/blog/saigon-mysterious-ursnif-fork)\nbeen purposely built to enable operations like ransomware and data theft extortion. This is a significant shift from the malware’s original\npurpose to enable banking fraud, but is consistent with the broader threat landscape.\n\nMandiant believes that the same threat actors who operated the RM3 variant of URSNIF are likely behind LDR4. Given the success and\nsophistication RM3 previously had, LDR4 could be a significantly dangerous variant—capable of distributing ransomware—that should be\nwatched closely.\n\n## Brief History\n\nBeing one of the oldest banking malware families still active today, it is no surprise that there is a long and adventurous history behind URSNIF\n(aka. Gozi or Gozi/ISFB), which is sometimes intertwined with other malware families and variants. Its source code was leaked at least twice\nsince the first major version appeared in 2016, resulting in other variants, from which multiple are still in circulation today (e.g., IAP). This\nmeans neither Gozi nor URSNIF is a single malware family, but more like a set of related siblings (usually called variants). Most researchers\ntoday have standardized on the malware family name Gozi, but for mainly historical reasons, other researchers and vendors—including\nMandiant—still reference these variants as URSNIF (the older malware from which Gozi originated from back in the mid-2000s with Haxdoor)\nor even ISFB (which is technically the latest living branch of this banking malware family). Just to make things clear, we use URSNIF\n(capitalized, according to Mandiant’s naming scheme) throughout this blog post when referring to the current variants that are still active today.\n\nIn recent years, multiple variants of URSNIF, based on ISFB, have been observed in the wild including:\n\nDreambot – One of the most successful variants\nIAP – The most actively developed and distributed ISFB branch with frequent malware campaigns coming from CUTWAIL and targeting\nItaly\nRM2 – Also widely known as GoziAT, started its activity years ago with the Chanitor malware (aka Hancitor)\nRM3 – Due to its custom executable file format, it is the most sophisticated version to date, which has mostly impacted Oceania and UK\nsince 2017\n\nAs of writing this, our research indicates ISFB might be the last and only active branch of the infamous URSNIF banking malware. Over the\npast three years, this banking malware has seen some interesting changes, which suggest a major paradigm shift and that the entire project\nwas redesigned.\n\n\n-----\n\nFigure 1: Genealogy of different URSNIF branches and variants\nFrom a malware developer’s perspective, it is a complicated task to provide updates for so many different projects (or forks in this case), which\ninevitably leads to dead-ends and mistakes. Mandiant believes that IAP 2.0 & RM2 builds over version 2.50.000 and RM3 builds over version\n3.00.700 focused on removing unnecessary features and merges all forks and development branches into a single main branch. Some of the\nnotable changes intended to support this unification effort include\n\nThe RSA public key is now encrypted with a very specific embedded decryption key, and this has been progressively pushed into all\nvariants\nAES encryption replaced the older Serpent encryption\nMerging and simplification of fields in the beacon requests\n\nThe year 2020 was highly unsuccessful for the RM3 variant, with decreasing reliable distributions and multiple backends that collapsed (mostly\nin Europe). Furthermore, this specific variant failed to take the opportunity to grow its popularity to obtain market share with the disruption of\nTRICKBOT and EMOTET. One of the greatest winners of this was the ICEDID malware family, which managed to leverage the shrinking\ncompetition on the banking malware landscape, putting RM3 into a difficult situation. It was extremely unusual for URSNIF’s ISFB variant to not\nreceive any updates after June 2020, thus some researchers hypothesized that the only way for this banking malware to return was to do\nsome major refurbishing on its code. In June 2022, with Internet Explorer finally being fully removed from Microsoft Windows, the RM3 variant\nwas officially seen as a “dead” malware from a technical point of view, as RM3 was reliant on this browser for some of its critical network\ncommunication.\n\n## Distribution\n\nMandiant first observed LDR4 in the wild on June 23, 2022, via a recruitment related lure, resembling RM3’s distribution reported back in April\n2021 (Figure 2). The email contains a link to a compromised website that redirects to a domain masquerading as a legitimate company (Figure\n3). A CAPTCHA challenge is presented to download an Excel document purported to contain information related to the email lure (Figure 4\nand Figure 5). This document then downloads and executes the LDR4 payload. A similar chain leading to LDR4 was later observed but with a\nlure pertaining to an accounting software instead (Figure 6).\n\nIn addition to HR/recruitment, Mandiant also observed RM3 in the more conventional payment/invoice lures that leverage XLM 4.0 macros in\nExcel document attachments to download the payload. In April 2022, we observed its last distribution via UNC2420 as a downloaded payload\nof the MOTEISLAND document. Mandiant tracks UNC2420 as a distribution threat cluster that uses malicious Microsoft Word documents as\nattachments in campaigns using subjects that appear to be replies to legitimate email chains.\n\n\n-----\n\nFigure 2: Email lure for URSNIF (RM3) in April 2021\n\nFigure 3: Email lure for URSNIF (LDR4) on June 23, 2022\n\n\n-----\n\nFigure 4: June 2022, CAPTCHA page for the Excel document download\n\n\n-----\n\nFigure 5: Excel document downloader for URSNIF (LDR4) on June 24, 2022\n\nFigure 6: Email lure for URSNIF (LDR4) on June 24, 2022\n\n## Static Analysis\n\n\n-----\n\ne a a t appea s as a odu e o t e ected co pute, c s o ed a t e _eg ste Se_ _e_ u ct o, but t e e a e o te\nother randomly named decoy functions exported to confuse sandboxes. Some of the binaries were using valid code-signing certificates (e.g.,\n_NAILS UNLIMITED LIMITED and ANGOSTONE GROUP LTD LIMITED). The binaries can have either a 32-bit or 64-bit architecture and are_\npacked with various PE crypters. One of the crypters, tracked by Mandiant as SPELLBOOK, has an interesting property that it leaves the\nsignature “|SPL|” in memory after unpacking the core malware. We identified overlaps in the usage of this crypter between URSNIF LDR4 and\nSNOWCONE.GZIPLOADER (ICEDID’s loader component). The unpacked core for the analyzed URSNIF LDR4 sample has the internal name\n_LOADER.dll._\n\nURSNIF LDR4 is a mix of code refactoring, regressions and interesting simplification strategies.\n\nFigure 7: IAP/RM3/LDR4 payload structures\nWe made the following major observations:\n\n1. The PX era is now over.\n\nThe LDR4 variant no longer uses the custom PX executable format, that was first introduced by the RM3 variant. We believe this choice\nwas made to avoid overcomplicating the troubleshooting of software issues. From a developer’s point of view, spending more time that is\nsupposed into some superficial layer of issues and refocusing into more important pipelines of requested features are crucial for your\nreputation. Equally important, given the notoriety of the PX format among analysts and AV/EDR products, it was only a matter of time for\nthat path to come to an end. From the attacker’s perspective, investing in a product that everyone knows how to detect, is not a very\nefficient use of resources, so going back to the roots with a classic PE format is in fact a rational choice on their side.\n\n\n-----\n\n_J e e go e o_ e o ed\nSince the beginning of ISFB, a steganography tool called FJ.exe (File Joiner) is used for hiding multiple files into a single payload. This\none isn’t unique to ISFB but forked from another notorious banking malware called CARBERP. By comparing the code of those two,\nthere are no doubts this same program is used in both.\n\nFigure 8: ISFB FJ.exe overlapping code with CARBERP FJ.cpp\n\n**Malware Family** **PDB Path / Project Path**\n\nCarberp bootkit.old/FJ/\n\nISFB d:\\work\\projects\\bk2\\bin\\release\\i386\\FJ.pdb (The bk2 project name in the file path stands for “Bootkit v2”)\n\n_FJ.exe is the tool responsible for creating the JJ, J1, J2, or WD fields on URSNIF payloads based on the variant. But in LDR4 those_\nmagic bytes are missing, and the hidden files usually hardcoded at the end of the payload are now gone.\n3. LDR4 is a backdoor.\n\nURSNIF is the latest malware following the same path that EMOTET and TRICKBOT did before, by focusing into a new strategy and\nleaving behind its banking fraud legacy. LDR4 is the proof of that statement by removing all its banking malware features and modules\nand only focusing into getting VNC and/or remote shell into the compromised machine.\n\n## Obfuscation\n\nIt is a common practice in offensive software operations to apply some sort of obfuscation to the code itself or at least to API calls to thwart\nanalysis efforts. URSNIF historically did not use this (except for the outermost crypter layer used for AV evasion). However, this new LDR4\nvariant incorporated obfuscation for the Windows API calls. First, it builds a hash lookup table from the export names and addresses of the\nWindows modules used by the malware (kernel32, ntdll, crypt32, advapi32, ws2_32), that maps the JAMCRC32 checksum (JAMCRC32 is the\nmodification of the regular CRC32 algorithm, where all the bits of the final checksum are flipped) of the function names to their respective\nvirtual addresses in memory. Later in the code, any invocation to the Windows API functions will just look up the checksum value in the table to\nquickly retrieve the function address. Apart from this, no further code obfuscation is leveraged in the compiled binaries, making LDR4 a\nrelatively easy family to reverse engineer.\n\n## Behavior\n\nOne of the most noticeable things during analysis was that the developers had simplified and cleaned up various parts of the code, compared\nto previous variants. Most notably, its banking features were totally scrapped.\n\n\n-----\n\ne a a e st ocates t e bss sect o t e e ecutab e, a d dec ypts t us g a s p e O based a go t s s pe o ed t a ey\nthat is constructed of the PE Timestamp, and the section’s PointerToRawData and SizeOfRawData fields. To ensure that the decryption was\nsuccessful, it calculates a checksum on part of the decrypted data, which must match the checksum of the UTF-16 encoded string \"All rights\n_reserved.\". This checksum will be used in later operations as a XOR key (similar to the XOR cookie value used in leaked source code, which_\nrefers to this value as CsCookie).\n\nNext, it gathers a list of system services by enumerating the subkeys under the registry key HKLM\\SYSTEM\\CurrentControlSet\\Control, and it\ngenerates two separate IDs: a System ID, which is derived from the creation date of pagefile.sys or hiberfil.sys – which is exactly the way how\nthe RM3 and SAIGON variants did it; and a User ID, which is simply the MD5 hash of the current user’s username.\n\nTo ensure that only one instance of the malware is active at a time, it creates a mutex with a randomized name, where the System ID created\nin the previous step is used as a random seed value. Then the decrypted configuration (from the .bss section) is validated to see if it contains\nboth the required bot configuration and an RSA public key that is used for decrypting data from the command and control (C2) servers. This is\nfollowed by launching the main communication thread via the QueueUserAPC () function.\n\nThe main communication loop retrieves the C2 server information from the embedded bot config.\n\nIf the IdleTime option is present in the configuration, then the code waits for this many seconds before starting communication with the\nservers.\nIf the RunCommand option is present, its value is executed in a separate thread with the output of the command redirected to a\ntemporary file. All the binaries we encountered contained two embedded commands: “echo Commands” and “dir”.\n\nThe C2 servers are contacted one by one trying to download the file TASK.BIN which contains a list of commands to perform. The list of\npotential commands is detailed in the Capabilities section.\n\n## Network Communication\n\nThe communication protocol used by LDR4 does not differ too much from the protocol used by the older RM3 variant. It uses POST requests\nover HTTPS, with beacon URLs ending in /index.html. The User Agent string depends on the exact Windows version and architecture with the\nfollowing format:\n```\n Mozilla/5.0 (Windows NT %d.%d; %s) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36\n\n```\nThe use of an outdated Chrome version in the User Agent string provides a good detection opportunity in environments where a proxy server\noversees outbound HTTP/HTTPS connections, and can block or alert based on the User Agent string.\n\nThe beacon request’s query string uses the following format (which is almost the same as RM3’s beacon format):\n```\n version=%u&user=%s&group=%u&system=%s&file=%08x&arc=%u&crc=%08x&size=%u\n\n```\nThe meaning of the parameters is detailed in the following table:\n\n**Parameter Name** **Description**\n\nversion Bot version, e.g., “100123” (1.00.123)\n\nuser User ID\n\ngroup Botnet ID\n\nsystem System ID\n\nfile File ID (the JAMCRC32 checksum of the uppercase filename)\n\narc File architecture (0 – x86, 1 – x64)\n\ncrc File checksum (only if it was downloaded before, otherwise 0)\n\nsize File size (only if it was downloaded before, otherwise 0)\n\n\n-----\n\na e pa a ete co s st g o a a do a e a d a ue s p epe ded to t e a o e e t o ed que y st g, e e y t e a equest s ade, t e\nthe entire request string is encrypted using AES-256 in CBC mode, with an embedded key (see ServerKey in the Configuration section) and an\ninitialization vector (IV) consisting of sixteen “0” characters, then encoded using Base64 (any ending “=” characters are stripped from the end\nof the encoded string), and then sent as the payload of a POST request.\n\nExample query string of an initial beacon (file ID 0x8fd8a91e corresponds to the filename TASK.BIN):\n```\n clypnrkl=wsktexbmn&version=100123&user=f2472a25a2e15c3d&group=202208152&system=18245c7ff14d7902&file=8fd8a91e&arc=0&crc=00\n\n```\nExample query string for subsequent beacons (existing TASK.BIN size is 320 bytes, and the checksum of its contents is 0x3e3edc47):\n```\n chjm=kckhu&version=100123&user=f2472a25a2e15c3d&group=202208152&system=18245c7ff14d7902file=8fd8a91e&arc=0&crc=3e3edc47&si\n\n```\nExample network beacon (with the request string encrypted with AES, and encoded as Base64):\n```\n POST /index.html\n Host: logotep[.]xyz\n Cache-Control: no-cache\n Connection: Keep-Alive\n Pragma: no-cache\n Content-Type: multipart/form-data; boundary=9808fdecfe274c1d\n User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66\n Safari/537.36\n Content-Length: 285\n --9808fdecfe274c1d\n Content-Disposition: form-data; name=\"rcgmbh\"\n QgrHabeBs9/vsorhqEP2jV88dSwmgvyxepEZczkNSFXt89yV2nH9/7A5QYcIslSIoimlOmGG53oykoFVIfc\n rge6eCwchr62tLGsho13OHolmwJBYFYH0+sxqa1AH8qV4CEjKX+UwyioMNnv0QlW9pagvAc6JMo1JoTHjrq\n aci07r/dByQSndma/MhZU1aIrI\n --9808fdecfe274c1d-\n```\nAll of the control servers that we identified used domain names consisting of 5-10 letters, were registered under the .xyz, .cyou or .com toplevel domains, and used Let’s Encrypt TLS certificates. The domain names are registered with Namecheap, and the infrastructure is hosted at\na company named Stark Industries Solutions Ltd., registered in the UK in February 2022. This company is listed on the website for Perfect\nQuality Hosting (aka. PQ Hosting).\n\n## Configuration\n\nAs mentioned, in the LDR4 variant of URSNIF, the configuration storage was significantly reworked. Previous URSNIF variants used magic\nmarkers to locate additional files that were embedded into the binary, called joined files. The magic markers varied between different URSNIF\nvariants, i.e. JF, JJ, J1, J2, or WD.\n\nThis new LDR4 variant introduces a new data structure for storing joined files, which are now merged with the strings in the encrypted .bss\nsection.\n\n\n-----\n\nFigure 9: LDR4 decrypted .bss section structure\nThe data structure has an 8-byte header, and has the following fields:\n\n**Data Size** **Field Name** **Description**\n\n2 bytes NextOffset The offset to the next element in the linked list, if zero, then no more elements\n\n2 bytes ItemSize The size of the data in bytes in the ItemValue field\n\n4 bytes ItemID A value that uniquely identifier the item, this is usually the JAMCRC32 hash of the item name\n\n_ItemSize bytes_ ItemValue The value of the current element\n\nThere are two joined files that must always be present, otherwise the malware will not operate: the bot configuration, and the RSA public key\nthat is used to decrypt and verify responses from the command server. Like in other URSNIF variants, the configuration options are identified\nby a hexadecimal number, which is the JAMCRC32 checksum of the option’s uppercase name. Note, that the name of the option is not\nreferenced anywhere in the binary or in the configuration, and it is only possible to find it out by brute-forcing the checksum.\n\nList of currently known configuration options:\n\n\n-----\n\n**Option ID** **Option Name** **Description**\n\n0xb892845a Controller List of C2 URLs used for communication (whitespace separated)\n\n0x656b798a Group Botnet ID\n\n0x4fa8693e ServerKey AES key used for communicating with the C2\n\n0x8c871ff9 IdleTime Number of seconds to wait before the initial request to the C2\n\n0x9d29ade4 RequestTime Number of seconds between beacon requests to the C2\n\n0xf76f421a HostKeepTime In case of communication failures, the number of minutes to wait before trying the next C2 server\n\n0x08b2f0fb HostShiftTime In case of successful communication, the number of minutes to wait before switching to the next C2 server\n\n0x89a5deaa RunCommand Embedded initial command list to execute upon startup\n\n0x303378c6 _<unknown>_ Unknown timeout parameter, probably unused as of now\n\n## Capabilities\n\nThe following commands are implemented in the malware:\n\n**Command ID** **Command Name** **Description**\n\n0xf880e2be LOAD_DLL Load a DLL module into the current process\n\n0xfee861f1 SHELL_STATE Retrieve the state of the cmd.exe reverse shell\n\n0xc202e685 SHELL_START Start the cmd.exe reverse shell\n\n0xa5946e4a SHELL_STOP Stop the cmd.exe reverse shell\n\n0xa04d6355 SHELL_RESTART Restart the cmd.exe reverse shell\n\n0x5d2295b5 RUN_COMMAND Run an arbitrary command\n\n0x5d639645 EXIT Terminate\n\nThe two most common commands that we have observed sent out to new victims are related to network reconnaissance:\n\nRUN_COMMAND=net group \"domain computers\" /domain\nRUN_COMMAND=net session\n\nThe same two commands were also observed from the RM3 variant of URSNIF in the past, which is another behavioral trait that proves the\nconnection between the two variants.\n\n## Command Shell\n\nThe built-in command shell functionality provides a reverse shell that connects to a remote IP address and gives the attackers the ability to\nexecute system commands via the cmd.exe program. This functionality is almost an exact copy to what the RM3 variant provided via its\nseparate cmdshell.dll plugin. The remote IP address and port number to connect to is provided at run time, as an argument to the\n_SHELL_START command. This functionality gives the attackers the ability to perform hands-on-keyboard attacks, perform further host and_\nnetwork reconnaissance, and do lateral movement.\n\n## Plugins\n\n\n-----\n\ne ous U S a a ts ad a eatu e t at a o ed t e capab t es o t e a a e to be e te ded t a ous p ug s oaded a t e\nLOAD_PLUGIN command, which was not implemented in the URSNIF LDR4 binary we analyzed. However, we have observed at least one\noccasion where a VNC module was downloaded via the LOAD_DLL command. The LOAD_DLL command thus allows for a simpler, more\ngeneric way of providing a plugin-like feature by extending the features of the malware via arbitrary DLL modules (in contrast to regular plugin\nDLLs, which must be implemented in a specific way to work with the main malware). Interestingly, the VNC module still uses an older way of\nstoring its embedded configuration (using the J1 magic bytes), so it is possible that it was originally compiled for a different URSNIF variant\n(likely for IAP 2.0).\n\nVNC module\n\n**Filename** vnc64_1.dll\n\n**Internal name** VncDLL.dll\n\n**MD5 hash** bd4a92d4577ddedeb462a71cdf2fa934\n\n**PE timestamp** Tue Sep 14 19:32:19 2021\n\n**Embedded VNC C2** 141[.]98.169.6:80\n\n## Attribution\n\nSome of the LDR4 control servers are configured to leak detailed error messages and file paths, and the file paths indicate that the bot panel is\ninstalled into the home directory of the user expro with the directory name www_loader_ldl (Figure 10).\n\nFigure 10: Error message from the C2\n\nserver revealing the expro home directory\nThis supports our current understanding that expro is the nickname of the web developer responsible for the bot panel for both the RM3 and\nLDR4 variants.\n\n## Implications\n\nThe demise of the RM3 variant earlier this year, and the author’s decisions to make heavy simplifications to their code, including the removal of\nall banking related features, point toward a drastic change in their previously observed TTPs. These shifts may reflect the threat actors’\nincreased focus towards participating in or enabling ransomware operations in the future. This assessment is further supported by the fact that\nMandiant identified an actor operating in underground communities seeking partners to distribute a new ransomware and the URSNIF RM3\nvariant, which is highly similar to the new LDR4 variant, since at least early 2022\n\n## Acknowledgements\n\nThe authors would like to thank Benoit Ancel for providing additional malware IOCs in relation to the LDR4 variant, and Cian Lynch for spotting\nthe initial malware sample.\n\n## Appendix A: Comparison with other recently active URSNIF variants\n\n**IAP 2.0** **RM3** **LDR4**\n\n\n_Persistence method_ Scheduled task that executes code\nstored in a registry key using\nPowerShell\n\n\nScheduled task that executes code\nstored in a registry key using\nPowerShell\n\n\nNo persistence\n\n\n-----\n\n_Configuration storage_ Security PE directory points to\nembedded binary data starting with\n'JJ' magic bytes\n\n\nSecurity PE directory points to\nembedded binary data starting with\n'WD' magic bytes\n\n\nHidden into the encrypted .bss section\n\n\n_PRNG algorithm_ Various xorshift64* Various\n\n\n_Checksum algorithm_ JAMCRC (aka. CRC32 with all the\nbits flipped)\n\n\nJAMCRC (aka. CRC32 with all the\nbits flipped)\n\n\nJAMCRC (aka. CRC32 with all the bits\nflipped)\n\n\n_Data compression_ aPLib aPLib No compression\n\n\n_Encryption/Decryption_ Old versions: Serpent CBC New\nversions: AES-256 CBC\n\n\nOld versions: Serpent CBC New\nversions: AES-256 CBC\n\n\nAES-256 CBC\n\n\n_Data integrity_\n_verification_\n\n\n_Communication_\n_method_\n\n\nRSA signature RSA signature RSA signature\n\nHTTP GET/POST requests HTTP GET/POST requests HTTP POST requests\n\n\n_Payload encoding_ Unpadded Base64 ('+' and '/' are\nreplaced with '_2B' and '_2F'\nrespectively), random slashes are\nadded\n\n\nUnpadded Base64 ('+' and '/' are\nreplaced with '_2B' and '_2F'\nrespectively), random slashes are\nadded\n\n\nUnpadded Base64 ('+' and '/' are URL\nencoded as '%2B' and '%2F'\nrespectively), random slashes are NOT\nadded\n\n\n_Uses URL path_\n_mimicking?_\n\n\nNo Yes No\n\n\n_Uses PX file format?_ No Yes No\n\n\n_Embedded commands_\n_in binary_\n\n\nYes No Yes\n\n\n## Appendix B: IOCs\n\nMalware sample hashes:\n\n[360417f75090c962adb8021dbb478f67 [VT]](https://www.virustotal.com/gui/file/eb2564a6f22dcec73dda3b6e4dc5fd37a4fa017f6b98b6dea5ac5b23a44b1f57)\n3e0f28bcaf35af2802f45b58f49481be\n590d96a7be55240ad868ebec78ce38f2\n[8c658b9b02814927124351484c42a272 [VT]](https://www.virustotal.com/gui/file/1480777c361ac1d398cc26c90215de629733f66d60dcbd5970700db0ce786ae1)\n[9f68d1a4b33e3ace6215040dc9fc73e8 [VT]](https://www.virustotal.com/gui/file/d2fc2e2b90b23c2a91e144fd8ac22668dd682f7d0145963615203d087c48aca4)\nb4610d340a9bff58616543b10e961cd3\n[baa784967fd0558715f4011a72eb872e [VT]](https://www.virustotal.com/gui/file/c2b80b8cbd660c3208162ed596e0443ea8f786b6fd1f809f2d2a1e07fe6475cd)\nbd4a92d4577ddedeb462a71cdf2fa934\n[bea60bab50d47f239132890a343ae84c [VT]](https://www.virustotal.com/gui/file/74b57e264dd84cbb7c4e1a7eb8a8dbdb932f01ac34e48e2e6d41ab82f05c682f)\n[d38f6f01bb926df07d34de0649f608f6 [VT]](https://www.virustotal.com/gui/file/b59430d733e346aef69dc5992cee0f06d8dbfca7744d212159528c89d1008953)\n[d6ef4778f7dc9c31a0a2a989ef42d2fd [VT]](https://www.virustotal.com/gui/file/54de1f2c26a63a8f6b7f8d5de99f8ebd4093959ab07f027db1985d0652258736)\n[d94657449f8d8c165ef88fd93e463134 [VT]](https://www.virustotal.com/gui/file/2502a3f8c9a6a8681f9222e93b14e077bf879e3009571c646ee94275bc994d01)\n[eee617806c18710e8635615de6297834 [VT]](https://www.virustotal.com/gui/file/12d88935437064d8478bc4adec0c0042fb73da774905004c7de55e559729e15c)\n[f4b0a6ab164f7c58cccce651606caede [VT]](https://www.virustotal.com/gui/file/88de34ad95486071b8796d95150461a8a7968d1eb8817772e892d258f3aa1c91)\n\nMalware sample hashes (unpacked):\n\n[00b981b4d3f47bcbd32dfa37f3b947e5 [VT]](https://www.virustotal.com/gui/file/5d1dbec0a0fb5014c387c308a83c9259774713219d283cd3653897b527e83713)\n[09bc2a1aefbafd3e7577bc3c352c82ad [VT]](https://www.virustotal.com/gui/file/6039fcf4b3d79f847f7b545ae0d7767a4d58e12721b049b04ade6550eef549b9)\n1b0ec09ca4cb7dcf5d59cea53e1b9c93\n3c5f002b46ef11700caca540dcc7c519\n498d5e8551802e02fe4fa6cd0425c608\n[58169007c2e7a0d022bc383f9b9476fe [VT]](https://www.virustotal.com/gui/file/082c51164b2c20ff163f2640313c81cd64a26ff9790d3570e5cde857fa93272a)\n7808d22a4343b2617ceef63fd0d43651\n7eea48e592c4bccbfa3929b1b35a7c0b\n\n\n-----\n\n89b dd 8bea8 ddd0 aa d 09ec3\n[a3539bc682f39406c050e5233058c930 [VT]](https://www.virustotal.com/gui/file/f7c5b8ea8de9aad8ea2661e79636a87a4a5949217cfbe5e97fcef4fb881701af)\nac39f1a22538f0211204037cce30431d\nc1989d25287cd9044b4d936e73962e35\nc7facfffad15a9c84239b495770183bb\n[cde05576e7c48ca89d2f21c283a4a018 [VT]](https://www.virustotal.com/gui/file/78fed40495b176adaf7093f946a1ee07cd7cf455858804e08446571bc8be799a)\n\nNetwork indicators (domains):\n\nastope[.]xyz\nbinchfog[.]xyz\ndamnater[.]com\ndaydayvin[.]xyz\ndodsman[.]com\ndodstep[.]cyou\nfineg[.]xyz\nfingerpin[.]cyou\nfishenddog[.]xyz\ngiantos[.]xyz\ngigeram[.]com\ngigiman[.]xyz\ngigimas[.]xyz\nhigmon[.]cyou\nisteros[.]com\nkidup[.]xyz\nlionnik[.]xyz\nlogotep[.]xyz\nmainwog[.]xyz\nmamount[.]cyou\nminotos[.]xyz\npinki[.]cyou\npipap[.]xyz\nprises[.]cyou\nreaso[.]xyz\nrorfog[.]com\ntornton[.]xyz\nvavilgo[.]xyz\n\nNetwork indicators (IP addresses):\n\n5[.]182.36.248 (CH) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n5[.]182.37.136 (RU) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n5[.]182.38.43 (HU) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n5[.]182.38.68 (HU) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n5[.]252.23.238 (SK) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]8.147.179 (SE) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]8.147.215 (SE) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]67.34.75 (RO) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]67.34.172 (RO) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]67.34.245 (RO) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]67.229.39 (MD) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]89.54.122 (SK) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]89.54.152 (SK) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]95.11.62 (SK) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]140.146.241 (MD) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]142.212.87 (MD) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n45[.]150.67.4 (MD) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n77[.]75.230.62 (CZ) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n77[.]91.72.15 (HU) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n94[.]131.100.71 (FI) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n94[.]131.100.209 (FI) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n94[.]131.106.8 (NL) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n94[.]131.106.16 (NL) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n94[.]131.107.13 (NL) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n\n\n-----\n\n9 [ ] 3 0 3 ( ) S S US S SO U O S (G )\n94[.]131.107.252 (NL) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n141[.]98.169.6 (FI) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n185[.]250.148.35 (MD) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n188[.]119.112.104 (NL) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n193[.]38.54.157 (NL) – ISP: STARK INDUSTRIES SOLUTIONS LTD (GB)\n\nUser Agent strings:\n\nMozilla/5.0 (Windows NT <os_version>; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36\nMozilla/5.0 (Windows NT <os_version>; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.66 Safari/537.36\n\n## Appendix C: YARA rule\n\nThe following YARA rule is not intended to be used on production systems or to inform blocking rules without first being validated through an\norganization's own internal testing processes to ensure appropriate performance and limit the risk of false positives. This rule is intended to\nserve as a starting point for hunting efforts to identify new LDR4 samples; however, it may need adjustment over time if the malware family\nchanges.\n\n```\nrule URSNIF_LDR4 {\n  strings:\n    $str1 = \"LOADER.dll\" fullword\n    $str2 = \"DllRegisterServer\" fullword\n    $str3 = \".bss\" fullword\n    $x64_code1 = { 3D 2E 62 73 73 74 0A 48 83 C7 28 }\n    $x64_code2 = { 8B 17 48 83 C7 04 8B CA 8b C2 23 CB 0B C3 F7 D1 23 C8 41 2B CA 44 8B D2 41 89 08 41 8B CB 49 83\nC0 04 83 E1 07 FF C1 41 D3 C2 41 83 EB 04 79 }\n    $x64_code3 = { 41 0F B6 01 49 FF C1 8B C8 8B D0 83 E1 03 C1 E1 03 D3 E2 44 03 C2 41 83 C2 FF 75 }\n    $x64_code4 = { 45 8D 45 08 48 8D 8C 24 [4] BA 30 00 FE 7F E8 }\n    $x64_code5 = { 48 8D 8C 24 [4] BA 30 00 FE 7F 41 B8 08 00 00 00 E8 }\n    $x86_code1 = { 81 F9 2E 62 73 73 74 09 83 C6 28 }\n    $x86_code2 = { 8B 06 8B D0 23 55 0C 8B D8 0B 5D 0C F7 D2 23 D3 2B D1 8A 4D 08 80 E1 07 83 C6 04 89 17 83 C7 04\nFE C1 D3 C0 83 6D 08 04 8B C8 79 }\n    $x86_code3 = { 8A 0E 0F B6 D1 8B CA 83 E1 03 C1 E1 03 D3 E2 46 03 C2 4F 75 }\n    $x86_code4 = { 6A 08 8D 45 F8 68 30 00 FE 7F 50 E8 }\n  condition:\n    5 of them\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-19 - From RM3 to LDR4- URSNIF Leaves Banking Fraud Behind.pdf"
    ],
    "report_names": [
        "2022-10-19 - From RM3 to LDR4- URSNIF Leaves Banking Fraud Behind.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1675303679,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1675237659,
    "ts_modification_date": 1675237659,
    "files": {
        "pdf": "https://archive.orkl.eu/35db8838ddadac02d41ea01fdd31ba81e9d1a9c6.pdf",
        "text": "https://archive.orkl.eu/35db8838ddadac02d41ea01fdd31ba81e9d1a9c6.txt",
        "img": "https://archive.orkl.eu/35db8838ddadac02d41ea01fdd31ba81e9d1a9c6.jpg"
    }
}