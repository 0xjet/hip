{
    "id": "b30095ec-abf2-4abf-a64d-d52302723351",
    "created_at": "2023-01-12T15:10:09.532428Z",
    "updated_at": "2025-03-27T02:06:09.105834Z",
    "deleted_at": null,
    "sha1_hash": "bc253325578d06bc20b2622c6b348c429822a990",
    "title": "2021-11-11 - AT&T Alien Labs finds new Golang malware (BotenaGo) targeting millions of routers and IoT devices with more than 30 exploits",
    "authors": "",
    "file_creation_date": "2022-05-27T22:17:23Z",
    "file_modification_date": "2022-05-27T22:17:23Z",
    "file_size": 1560012,
    "plain_text": "# AT&T Alien Labs finds new Golang malware (BotenaGo) targeting millions of routers and IoT devices with more than 30 exploits\n\n**[cybersecurity.att.com/blogs/labs-research/att-alien-labs-finds-new-golang-malwarebotenago-targeting-millions-of-routers-and-iot-devices-with-more-than-30-exploits](https://cybersecurity.att.com/blogs/labs-research/att-alien-labs-finds-new-golang-malwarebotenago-targeting-millions-of-routers-and-iot-devices-with-more-than-30-exploits)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nNovember 11, 2021 | [Ofer Caspi](https://cybersecurity.att.com/blogs/author/ofer-caspi)\n\n## Executive summary\n\nAT&T Alien Labs™ has found new malware written in the open source programming language Golang. Deployed with more than\n30 exploits, it has the potential of targeting millions of routers and IoT devices.\n\n### Key Takeaways:\n\nBotenaGo has more than 30 different exploit functions to attack a target.\nThe malware creates a backdoor and waits to either receive a target to attack from a remote operator through port 19412 or\nfrom another related module running on the same machine.\nIt is yet unclear which threat actor is behind the malware and number of infected devices.\n\n## Background\n\n[Golang (also known as Go) is an open-source programming language designed by Google and first published in 2007 that makes it](https://golang.org/)\neasier for developers to build software.\n\nAccording to a recent Intezer post, the Go programming language has dramatically increased in its popularity among malware\nauthors in the last few years. The [site suggests there has been a 2,000% increase in malware code written in Go being found in the](https://www.intezer.com/blog/malware-analysis/year-of-the-gopher-2020-go-malware-round-up/)\nwild.\n\nSome of the reasons for its rising popularity relate to the ease of compiling the same code for different systems, making it easier for\nattackers to spread malware on multiple operating systems.\n\n[As of the publishing of this article, BotenaGo currently has low antivirus (AV) detection rate with only 6/62 known AVs seen in](https://www.virustotal.com/gui/file/0c395715bfeb8f89959be721cd2f614d2edb260614d5a21e90cc4c142f5d83ad)\nVirusTotal: (Figure 1)\n\n\n-----\n\nFigure 1. VirusTotal scanning results of BotenaGo malware\n\nSome AVs detect these new malware variants using Go as Mirai malware — the payload links do look similar. However, there is a\ndifference between the Mirai malware and the new malware variants using Go, including differences in the language in which it is\nwritten and the malware architectures. Mirai is a botnet that initiates its communication with its command and control (C&C). It also\nhas different DDoS functionality. The new malware strains Alien Labs has discovered do not have the same attack functions as\nMirai malware, and the new strains only look for vulnerable systems to spread its payload. In addition, Mirai uses a “XOR table” to\nhold its strings and other data, as well as to decrypt them when needed — this is not the case for the new malware using Go. For\nthis reason, Alien Labs believes this threat is new, and we have named it BotenaGo.\n\n## Analysis\n\nThe BotenaGo malware starts by initializing global infection counters that will be printed to the screen, informing the hacker about\ntotal successful infections.(Figure 2)\n\nFigure 2. BotenaGo execution output\n\nIt then looks for the 'dlrs' folder in which to load shell scripts files. A loaded script will be concatenated as 'echo -ne %s >> '. If the\n'dlrs' folder is missing, the malware will stop and exit at this point.\n\nFor the last and most important preparation, the malware calls the function 'scannerInitExploits', which initiates the malware attack\nsurface by mapping all offensive functions with its relevant string that represent the targeted system.\n\nThe malware maps each function with a string that represents a potential targeted system — such as a signature, which we’ll\nexplain later in this blog (see figure 3)\n\n\n-----\n\nFigure 3. Mapping attack functions to relevant vulnerable systems\n\n## Exploit delivery\n\nTo deliver its exploit, the malware first queries the target with a simple “GET” request. It then searches the returned data from the\n“GET” request with each system signature that was mapped to attack functions (as seen in figure 3).\n\nFigure 4. Example 1: Mapping function to the relevant system string signature\n\nThe string “Server: Boa/0.93.15” is mapped to the function “main_infectFunctionGponFiber,” (see figure 4) which attempts to exploit\na vulnerable target, allowing the attacker to execute an OS command via a specific web request (CVE-2020-8958 as shown in\nfigure 5).\n\n\n-----\n\nFigure 5. Example 1: main_infectFunctionGponFiber function, exploits CVE 2020 8958\n\n[If we search the string \"Server: Boa/0.93.15\" in SHODAN, results show almost 2 million potential targets to this attack (see figure](https://shodan.io/)\n6). [Boa is a discontinued, open-source and small-footprint web server which is mostly suitable for embedded applications.](https://en.wikipedia.org/wiki/Boa_(web_server))\n\nFigure 6. Example 1: Shodan search result for potential targets for specific function\n\nLet's look on another example of a signature mapped to an attack function. We searched the string \"Basic realm=\\\"Broadband\nRouter\\\"\" which is mapped to the function “m_infectFunctionComtrend” (see figure 7).\n\nFigure 7. Example 2: mapping function to the relevant system string signature\n\nA search on Shodan returns approximately 250,000 potential devices that could be attacked by this function ( see figure 8).\n\n\n-----\n\nFigure 8. Example 2: Shodan search result for string\n\nThe function exploiting the vulnerability CVE-2020-10173 is shown in figure 9. In total, the malware initiates 33 exploit functions\nthat are ready to infect potential victims.\n\nFigure 9. Example 2: Function exploiting vulnerability CVE-2020-10173\n\n## Receiving directions from Command & Control\n\nThe malware can receive commands to target victims in two different ways:\n\n1. It creates two backdoor ports: 31412 and 19412. On port 19412 it will listen to receive the victim IP. Once a connection with\n\ninformation to that port is received, it will loop through mapped exploit functions and execute them with the given IP (see\nfigure 10).\n\n\n-----\n\nFigure 10. BotenaGo backdoor ports\n\n2. The malware sets a listener to system IO (terminal) user input and can receive a target through it.\n\nFor example, if the malware is running locally on a virtual machine, a command can be sent through telnet. The target in figure 11 is\na fake web server Alien Labs set up locally.\n\nFigure 11. Sending the malware a target to attack\n\n[Using this information, we can see the results of some of the attacks with](https://www.wireshark.org/) [Wireshark (see figures 12 and 13).](https://cybersecurity.att.com/blogs/security-essentials/network-traffic-analysis-using-wireshark)\n\nFigure 12. Malware communication as seen in Wireshark\n\nFigure 13. Malware communication as seen in Wireshark\n\nThe new BotenaGo malware exploits more than 30 vulnerabilities. Below, Alien Labs has listed some of the CVE numbers of\nvulnerabilities that can be exploited. In addition, some of the vulnerabilities have been disclosed without CVE.\n\n\n-----\n\nVulnerability Affected devices\n\n\nCVE-20208515\n\nCVE-20152051\n\nCVE-20161555\n\nCVE-20176077\n\nCVE-20166277\n\nCVE-201810561,\nCVE-201810562\n\nCVE-20133307\n\nCVE-20209377\n\nCVE-201611021\n\nCVE-201810088\n\nCVE-202010173\n\nCVE-20135223\n\nCVE-20208958\n\nCVE-201919824\n\nCVE-202010987\n\nCVE-20209054\n\n\nDrayTek Vigor2960 1.3.1_Beta, Vigor3900 1.4.4_Beta, and Vigor300B 1.3.3_Beta, 1.4.2.1_Beta, and 1.4.4_Beta\ndevices\n\nD-Link DIR-645 Wired/Wireless Router Rev. Ax with firmware 1.04b12 and earlier\n\nNetgear WN604 before 3.3.3 and WN802Tv2, WNAP210v2, WNAP320, WNDAP350, WNDAP360, and\nWNDAP660 before 3.5.5.0\n\nNETGEAR DGN2200 devices with firmware through 10.0.0.50\n\nNETGEAR R6250 before 1.0.4.6.Beta, R6400 before 1.0.1.18.Beta, R6700 before 1.0.1.14.Beta, R6900, R7000\nbefore 1.0.7.6.Beta, R7100LG before 1.0.0.28.Beta, R7300DST before 1.0.0.46.Beta, R7900 before 1.0.1.8.Beta,\nR8000 before 1.0.3.26.Beta, D6220, D6400, D7000\n\nGPON home routers\n\nLinksys X3000 1.0.03 build 001\n\nD-Link DIR-610\n\nD-Link DCS-930L devices before 2.12\n\nXiongMai uc-httpd 1.0.0\n\nComtrend VR-3033 DE11-416SSG-C01_R02.A2pvI042j1.d26m\n\nD-Link DSL-2760U Gateway\n\nGuangzhou 1GE ONU V2801RW 1.9.1-181203 through 2.9.0-181024 and V2804RGW 1.9.1-181203 through\n2.9.0-181024\n\nTOTOLINK Realtek SDK based routers, this affects A3002RU through 2.0.0, A702R through 2.1.3, N301RT\nthrough 2.1.6, N302R through 3.4.0, N300RT through 3.4.0, N200RE through 4.0.0, N150RT through 3.4.0, and\nN100RE through 3.4.0.\n\nTenda AC15 AC1900 version 15.03.05.19\n\nMultiple ZyXEL network-attached storage (NAS) devices running firmware version 5.2, Affected products include:\nNAS326 before firmware V5.21(AAZF.7)C0 NAS520 before firmware V5.21(AASZ.3)C0 NAS540 before firmware\nV5.21(AATB.4)C0 NAS542 before firmware V5.21(ABAG.4)C0 ZyXEL has made firmware updates available for\nNAS326, NAS520, NAS540, and NAS542 devices. Affected models that are end-of-support: NSA210, NSA220,\nNSA220+, NSA221, NSA310, NSA310S, NSA320, NSA320S, NSA325 and NSA325v2\n\n\n-----\n\nCVE-201718368\n\nCVE-20142321\n\nCVE-20176334\n\n\nZyXEL P660HN-T1A v1 TCLinux Fw $7.3.15.0 v001 / 3.40(ULM.0)b31 router distributed by TrueOnline\n\nZTE F460 and F660 cable modems\n\nNETGEAR DGN2200 devices with firmware through 10.0.0.50\n\n\n## The payload\n\nAs payload, BotenaGo will execute remote shell commands on devices in which the vulnerability has been successfully exploited.\nDepending on the infected system, the malware uses different links, each with a different payload. At time of analysis, all the\npayloads had been removed from the hosted servers by the attacker(s), and so Alien Labs could not analyze any of them.\n\nBotenaGo does not have any active communication to its C&C, which raises the question: how does it operate? Alien Labs has a\nfew theories on how the malware is being operated and receives a target to attack (the attacker could be using one or a mix of the\nactions below):\n\n1. The malware is part of a \"malware suite\" and BotenaGo is only one module of infection in an attack. In this case, there should\n\nbe another module either operating BotenaGo (by sending targets) or just updating the C&C with a new victim’s IP.\n2. The links used for the payload on a successful attack imply a connection with Mirai malware. It could be the BotenaGo is a\n\nnew tool used by Mirai operators on specific machines that are known to them, with the attacker(s) operating the infected endpoint with targets.\n3. This malware is still in beta phase and has been accidently leaked.\n\n## Recommended actions\n\n1. Maintain your software with the latest security updates.\n2. Ensure minimal exposure to the Internet on Linux servers and IoT devices and use a properly configured firewall.\n3. Monitor network traffic, outbound port scans, and unreasonable bandwidth usage.\n\n## Conclusion\n\nMalware authors continue to create new techniques for writing malware and upgrading its capabilities. In this case, new malware\nwriting in Golang (which Alien Labs has named BotenaGo) can run as a botnet on different OS platforms with small modifications.\n\n## Detection methods\n\nThe following associated detection methods are in use by Alien Labs. They can be used by readers to tune or deploy detections in\ntheir own environments or for aiding additional research.\n\nSURICATA IDS SIGNATURES\n\n4001488: AV TROJAN Mirai Outbound Exploit Scan, D-Link HNAP RCE (CVE-2015-2051)\n\n4000456: AV EXPLOIT Netgear Device RCE (CVE-2016-1555)\n\n4000898: AV EXPLOIT Netgear DGN2200 ping.cgi - Possible Command Injection ( CVE-2017-6077 )\n\n2027093: ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6077)\n\n2027881: ET EXPLOIT NETGEAR R7000/R6400 - Command Injection Inbound (CVE-2019-6277)\n\n2027882: ET EXPLOIT NETGEAR R7000/R6400 - Command Injection Outbound (CVE-2019-6277)\n\n\n-----\n\n2830690: ETPRO EXPLOIT GPON Authentication Bypass Attempt (CVE-2018-10561)\n\n2027063: ET EXPLOIT Outbound GPON Authentication Bypass Attempt (CVE-2018-10561)\n\n2830690: ETPRO EXPLOIT GPON Authentication Bypass Attempt (CVE-2018-10561)\n\n2027063: ET EXPLOIT Outbound GPON Authentication Bypass Attempt (CVE-2018-10561)\n\n2831296: ETPRO EXPLOIT XiongMai uc-httpd RCE (CVE-2018-10088)\n\n4001914: AV EXPLOIT DrayTek Unauthenticated root RCE (CVE-2020-8515)\n\n2029804: ET EXPLOIT Multiple DrayTek Products Pre-authentication Remote RCE Outbound (CVE-2020-8515) M1\n\n2029805: ET EXPLOIT Multiple DrayTek Products Pre-authentication Remote RCE Inbound (CVE-2020-8515) M1\n\n2029806: ET EXPLOIT Multiple DrayTek Products Pre-authentication Remote RCE Outbound (CVE-2020-8515) M2\n\n2029807: ET EXPLOIT Multiple DrayTek Products Pre-authentication Remote RCE Inbound (CVE-2020-8515) M2\n\n4002119: AV EXPLOIT Comtrend Router ping.cgi RCE (CVE-2020-10173)\n\n2030502: ET EXPLOIT Possible Authenticated Command Injection Inbound - Comtrend VR-3033 (CVE-2020-10173)\n\n4001814: AV EXPLOIT TOTOLINK Router PostAuth RCE (CVE-2019-19824)\n\n2029616: ET EXPLOIT Zyxel NAS RCE Attempt Inbound (CVE-2020-9054) M1\n\n2029617: ET EXPLOIT Zyxel NAS RCE Attempt Inbound (CVE-2020-9054) M2\n\n4001142: AV EXPLOIT ManagedITSync - Kaseya exploitation (CVE-2017-18362) v1\n\n4001143: AV EXPLOIT ManagedITSync - Kaseya exploitation (CVE-2017-18362) v2\n\n2032077: ET EXPLOIT ZTE Cable Modem RCE Attempt (CVE-2014-2321)\n\n4000897: AV EXPLOIT Netgear DGN2200 dnslookup.cgi Lookup - Possible Command Injection (CVE-2017-6334)\n\n2027094: ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6334)\n\n## Associated indicators (IOCs)\n\nThe following technical indicators are associated with the reported intelligence. A list of indicators is also available in the OTX\nPulse. Please note, the pulse may include other activities related but out of the scope of the report.\n\nTYPE INDICATOR DESCRIPTION\n\nSHA256 0c395715bfeb8f89959be721cd2f614d2edb260614d5a21e90cc4c142f5d83ad BotenaGo\nmalware hash\n\n\n-----\n\nURL http://107[.]172.30.215/shell/wget.sh Malware\npayload\ndownload link\n\nURL http://rippr[.]cc/u Malware\npayload\ndownload link\n\nURL http://107[.]172.30.215/b Malware\npayload\ndownload link\n\nURL http://37[.]0.11.220/g+-O- Malware\npayload\ndownload link\n\nURL http://107[.]172.30.215/l Malware\npayload\ndownload link\n\nURL http://107[.]172.30.215/a/wget.sh Malware\npayload\ndownload link\n\nURL http://107[.]172.30.215/multi/wget.sh Malware\npayload\ndownload link\n\nURL http://107[.]172.30.215/arm/arm5/arm7/i586/i686/m68k/mips/mipsel/powerpc/sh4/sparc/x86_64bot.mips Malware\npayload\ndownload link\n\nURL http://107[.]172.30.215/arm/arm5/arm7/i586/i686/m68k/mips/mipsel/powerpc/sh4/sparc/x86_64bot.arm7 Malware\npayload\ndownload link\n\nURL http://37[.]0.11.220/a/wget.sh Malware\npayload\ndownload link\n\n## Mapped to MITRE ATT&CK\n\n[The findings of this report are mapped to the following MITRE ATT&CK Matrix techniques:](https://attack.mitre.org/)\n\nTA0008: Lateral Movement\n\nT1210: Exploitation of Remote Services\nT1570: Lateral Tool Transfer\nTA0011: Command and Control\n\nT1571: Non-Standard port\n\n### Share this with others\n\nTags: [alien labs](https://cybersecurity.att.com/blogs/tag/alien+labs)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-11 - AT&T Alien Labs finds new Golang malware (BotenaGo) targeting millions of routers and IoT devices with more than 30 exploits.pdf"
    ],
    "report_names": [
        "2021-11-11 - AT&T Alien Labs finds new Golang malware (BotenaGo) targeting millions of routers and IoT devices with more than 30 exploits.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536209,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1653689843,
    "ts_modification_date": 1653689843,
    "files": {
        "pdf": "https://archive.orkl.eu/bc253325578d06bc20b2622c6b348c429822a990.pdf",
        "text": "https://archive.orkl.eu/bc253325578d06bc20b2622c6b348c429822a990.txt",
        "img": "https://archive.orkl.eu/bc253325578d06bc20b2622c6b348c429822a990.jpg"
    }
}