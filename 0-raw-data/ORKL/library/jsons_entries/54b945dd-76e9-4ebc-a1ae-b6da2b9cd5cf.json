{
    "id": "54b945dd-76e9-4ebc-a1ae-b6da2b9cd5cf",
    "created_at": "2022-12-08T02:08:26.655188Z",
    "updated_at": "2025-03-27T02:17:05.569789Z",
    "deleted_at": null,
    "sha1_hash": "f36b4d4ba9a966e066d94ad15a9cc11e1c22ef1a",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-12-07T01:29:47Z",
    "file_modification_date": "2022-12-07T01:29:47Z",
    "file_size": 1338855,
    "plain_text": "# Threat Thursday: Malware Rebooted - How Industroyer2 Takes Aim at Ukraine Infrastructure\n\n**blogs.blackberry.com/en/2022/05/threat-thursday-malware-rebooted-how-industroyer2-takes-aim-at-ukraine-**\ninfrastructure\n\n[Since the outbreak of conflict in Eastern Ukraine in 2014, following Russia’s annexation](https://www.cfr.org/global-conflict-tracker/conflict/conflict-ukraine)\nof Crimea, there have been several notable attempts to disrupt the electrical\ninfrastructure of the country. While an attack with Industroyer2 was recently thwarted,\nanalysis of this malware provides useful insight into threat actors’ behaviors.\n\n[Industroyer2 was first reported by CERT-UA and confirmed by ESET on April 12, 2022,](https://cert.gov.ua/article/39518)\nas the third major attempt at taking out part of Ukraine’s electrical substations and\n[controllers. This attack was repelled by CERT-UA in partnership with ESET.](https://www.cnbc.com/2022/04/12/ukraine-says-russian-cyberattack-sought-to-shut-down-energy-grid.html)\n\nThis was just the latest in a string of attacks against Ukraine’s electric grid. The first\nelectrical disruption attempt occurred in December 2015, using an updated version of the\n[BlackEnergy malware. This attack successfully caused power outages in several regions of](https://blogs.blackberry.com/en/2016/01/blackenergy-and-the-ukraine-signals-vs-noise)\n[Ukraine. In December 2016, the first version of Industroyer caused blackouts for several](https://cyberlaw.ccdcoe.org/wiki/Industroyer_%E2%80%93_Crash_Override_(2016))\nhours in the capital, Kyiv.\n\n[The 2015 and 2016 attacks were both attributed to the Sandworm group. It is likely](https://attack.mitre.org/groups/G0034/)\nIndustroyer2 is yet another attempt by the Sandworm group to cause damage to the\ncritical infrastructure of Ukraine in support of the ongoing Russian incursions. The U.S.\n\n\n-----\n\n[Department of Justice has previously released indictments accusing the Russian GRU of](https://www.justice.gov/opa/pr/six-russian-gru-officers-charged-connection-worldwide-deployment-destructive-malware-and)\nbeing behind BlackEnergy and Industroyer in an attempt to “undermine, retaliate\nagainst, or otherwise destabilize” Ukraine, among other geopolitical targets.\n\n### Operating System\n\n Risk & Impact\n\n Technical Analysis\n\n**Overview**\n\nSample:\n**D69665F56DDEF7AD4E71971F06432E59F1510A7194386E5F0E8926AEA7B88E00**\n\n_Figure 1 – Compilation date_\n\nIndustroyer2 was compiled on March 23, 2022, nearly a month after the initial invasion\nof Ukraine. This threat was deployed alongside several wipers, a worm, and a loader.\n[CERT-UA reports that the wipers that came with the attack included CaddyWiper,](https://thehackernews.com/2022/04/russian-hackers-tried-attacking.html)\nSoloShred, and AwfulShred. CaddyWiper targets Windows® systems, while the other\nwipers target Linux® systems. The Linux worm OrcShred and the loader ArguePatch\nwere also included.\n\nTo understand how Industroyer2 works, we first need to look into the IEC 60870-5-104\nprotocol used for communication on a TCP/IP network. This protocol is used in the\nUkrainian electrical stations and substations that were targeted by this attack. By\nfollowing the commands used by the malware, we can observe the execution flow of\nIndustroyer2 and see what messages are sent to disrupt the targeted devices.\n\n\n-----\n\n### IEC-104\n\n[The IEC 60870-5-104 protocol, shortened as IEC-104, is a telecontrol equipment and](https://www.fit.vut.cz/research/publication-file/11570/TR-IEC104.pdf)\nsystems standardization for TCP communication over port 2404. This protocol is used to\ninterface with power control stations and substations.\n\nAn Application Protocol Data Unit (APDU) transmission frame contains the Application\nService Data Unit (ASDU), which is a message structure carrying application data sent\nbetween stations. The ASDU transmits an Information Object Address (IOA), which is\nused to interact with the switches and breakers in a station. During normal everyday\nfunction, a controller can send an APDU frame with an ASDU that contains specific IOA\ncommands to change the state of the stations and substations.\n\nStatus checking on the controller stations is carried out by sending a Test Frame\n(TESTFR) command – TESTFR act APDU, to activate – which is verified with a return\n– TESTFR con APDU, to confirm the system is online. The commands Start Data\nTransfer (STARTDT) and Stop Data Transfer (STOPDT) control data transfer from the\ncontrol station. These actions are sent in an APDU.\n\n### Behavior\n\nOnce Industroyer2 is launched, a command prompt window opens and displays the\ncommands that are being sent and received, as seen in Figure 2. In this instance, we see\nthat port 2404 is being targeted. Port 2404 is used by IEC-104 to send TCP messages.\nThis output also corresponds to the IOA commands found inside the file, which are\nshown in Figure 3.\n\n_Figure 2 – Console output while executing_\n\n\n-----\n\n_Figure 3 – Configuration found inside the file_\n\nA TESTFR act APDU is sent to establish a connection to a station, shown in Figure 4,\nalong with a STARTDT command. Upon successful connection, a TESTFR con APDU\nis sent back from the station. With the confirmation received from the station, a\n**STARTDT APDU is sent to open data transfer. As with TESTFR, STARTDT will need**\nto send an act to activate, and to receive a con from the station to confirm, before data\ntransfer can begin.\n\n_Figure 4 – TESTFR act and STARTDT act commands_\n\nNext, the ASDU frames will communicate commands to the station, as shown in Figure 5.\nAn ASDU interrogation command determines the status of the station. The hardcoded\nmessages in Figure 3 will get sent and modify the station’s IOA.\n\n_Figure 5 – ASDU IOA commands_\n\nNot much else can be discerned from these IOA modifications without knowledge of the\nspecific systems that were being targeted. This points to the possibility that the malware\nauthors have some level of access or insider knowledge of the systems they were\nattacking.\n\n### Industroyer vs. Industroyer2\n\nWhile Industroyer2 is an updated version of the original Industroyer, it comes with a\nslightly narrower scope of action. The original version of the threat had four distinct\nmodules targeting IEC 60870-5-101 (IEC-101), IEC 60870-5-104 (IEC-104), IEC-61850,\nand OLE for Process Control Data Access (OPC DA).\n\nIEC-101 is a protocol for controlling and monitoring electrical stations, while IEC-104\nutilizes IEC-101 and sends communications over a TCP/IP network. IEC-61850 is a\ncommunication standard for automated substation devices, and OPC DA is a client-server\nstandardization for real-time data acquisition devices.\n\n\n-----\n\nIndustroyer2 focuses primarily on disrupting services by targeting the IEC-104\ncontrollers. It’s not clear why the focus was narrowed down to this one service, but\njudging from the compilation date of March 23, 2022, the malware was likely rushed\nthrough development. Additionally, Industroyer has a separate config file with the IOAs,\nwhile Industroyer2 stores that information inside its executable.\n\n### Conclusion\n\nIndustroyer2 is the latest attempt by state-level threat actors to cause what they hope will\n[be severe damage to the critical infrastructure of the targeted region. This tactic has](https://www.blackberry.com/us/en/solutions/endpoint-security/shields-up-protecting-critical-infrastructure)\nproven effective in the past as a method of spooking the populace, even when the attack\nitself was not successful.\n\nFew details surrounding this specific attack are currently available to us, but what we do\nknow is that the deployment of Industroyer2 represents an increasing escalation of\ncyberattacks on Ukraine’s crucial resources. Attackers are now escalating their intrusion\nattempts far beyond the usual “smash-and-grab” tactics of infostealing, to focus on just\nthe “smash” part. This method of operation not only causes population distress and\nwidespread disruptions, but also has the potential to take out critical infrastructure in a\nway that causes immediate damage to the basic services that keep countries functioning.\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team\nto catch the threat described in this document:\n\n\n-----\n\nrule Industroyer2{\n\nmeta:\ndescription = \"Detects Industroyer2\"\nauthor = \"BlackBerry Threat Research Team\"\ndate = \"2022-05-03\"\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization,\nas long as you use it under this license and ensure originator credit in any derivative to\nThe BlackBerry Research & Intelligence Team\"\n\nstrings:\n$s1 = \"02d:%lS\" wide\n$s2 = \"M%X - %02d:%02d:%02d\" wide\n$s3 = \"02hu:%02hu:%02hu:%04hu\" wide\n$s4 = \"T%d %08x\" wide\n$s5 = \"T%d %h\" wide\n$s6 = \"%s M%X %d (%s)\" wide\n$s7 = \"%s M%X SGCNT %d\" wide\n$s8 = \"ASDU:%u | OA:%u | IOA:%u\" wide\n$s9 = \"Cause: %s (x%X) | Telegram type: %s (x%X)\" wide\n\n$c1 = \"TESTFR act\" wide\n$c2 = \"TESTFR con\" wide\n$c3 = \"STARTDT act\" wide\n$c4 = \"STARTDT con\"\n\ncondition:\nuint16(0) == 0x5a4d and filesize < 50KB and all of them\n\n}\n\n\n-----\n\n### Indicators of Compromise (IoCs)\n\nD69665F56DDEF7AD4E71971F06432E59F1510A7194386E5F0E8926AEA7B88E00\n\n43D07F28B7B699F43ABD4F695596C15A90D772BFBD6029C8EE7BC5859C2B0861\n\nBCDF0BD8142A4828C61E775686C9892D89893ED0F5093BDC70BDE3E48D04AB99\n\n87CA2B130A8EC91D0C9C0366B419A0FCE3CB6A935523D900918E634564B88028\n\nCDA9310715B7A12F47B7C134260D5FF9200C147FC1D05F030E507E57E3582327\n\n1724A0A3C9C73F4D8891F988B5035EFFCE8D897ED42336A92E2C9BC7D9EE7F5A\n\nFC0E6F2EFFBFA287217B8930AB55B7A77BB86DBD923C0E8150551627138C9CAA\n\n7062403BCCACC7C0B84D27987B204777F6078319C3F4CAA361581825C1A94E87\n\n3851A064AABAB557CE162E01A77681B3954B006117EDD0563EDD2B3E5A082ACE\n\nEA16CB89129AB062843C84F6C6661750F18592B051549B265AAF834E100CD6FC\n\n### References\n\n[https://cert.gov.ua/article/39518](https://cert.gov.ua/article/39518)\n\n[https://www.welivesecurity.com/2022/04/12/industroyer2-industroyer-reloaded/](https://www.welivesecurity.com/2022/04/12/industroyer2-industroyer-reloaded/)\n\n[https://pylos.co/2022/04/23/industroyer2-in-perspective/](https://pylos.co/2022/04/23/industroyer2-in-perspective/)\n\n[https://www.fit.vut.cz/research/publication-file/11570/TR-IEC104.pdf](https://www.fit.vut.cz/research/publication-file/11570/TR-IEC104.pdf)\n\n[https://www.mandiant.com/resources/industroyer-v2-old-malware-new-tricks](https://www.mandiant.com/resources/industroyer-v2-old-malware-new-tricks)\n\n[https://attack.mitre.org/groups/G0034/](https://attack.mitre.org/groups/G0034/)\n\nhttps://www.justice.gov/opa/pr/six-russian-gru-officers-charged-connection-worldwidedeployment-destructive-malware-and\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place,\nregardless of your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated](https://www.blackberry.com/us/en/services/incident-response)\nto handling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\n\n-----\n\nWe have a global consulting team standing by to assist you, providing around-the-clock\nsupport where required, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergencyincident-response-containment\n\n### Related Reading\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they\nserve.\n\n[Back](javascript:history.back())\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "4e039bf8-7239-4999-8ec0-eb202d1465af",
            "created_at": "2022-12-04T11:19:36.52593Z",
            "updated_at": "2022-12-04T11:19:36.52593Z",
            "deleted_at": null,
            "name": "ORKL",
            "url": "https://github.com/ORKL/library",
            "description": "ORKL Community Contributed Content",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2022/2022.05.12.Industroyer2_Ukraine/Threat%20Thursday_%20Malware%20Rebooted%20-%20How%20Industroyer2%20Takes%20Aim%20at%20Ukraine%20Infrastructure.pdf"
    ],
    "report_names": [
        "Threat Thursday_ Malware Rebooted - How Industroyer2 Takes Aim at Ukraine Infrastructure"
    ],
    "threat_actors": [
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1670465306,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1670376587,
    "ts_modification_date": 1670376587,
    "files": {
        "pdf": "https://archive.orkl.eu/f36b4d4ba9a966e066d94ad15a9cc11e1c22ef1a.pdf",
        "text": "https://archive.orkl.eu/f36b4d4ba9a966e066d94ad15a9cc11e1c22ef1a.txt",
        "img": "https://archive.orkl.eu/f36b4d4ba9a966e066d94ad15a9cc11e1c22ef1a.jpg"
    }
}