{
    "id": "18083908-6f42-41a2-b5f9-a06ed469be2d",
    "created_at": "2023-01-12T15:02:45.311812Z",
    "updated_at": "2025-03-27T02:05:40.44593Z",
    "deleted_at": null,
    "sha1_hash": "7dabe06dbb4ed749d3830b0225ac6403865bfd78",
    "title": "2021-07-07 - Netskope Threat Coverage- REvil",
    "authors": "",
    "file_creation_date": "2022-05-28T17:12:44Z",
    "file_modification_date": "2022-05-28T17:12:44Z",
    "file_size": 944949,
    "plain_text": "# Netskope Threat Coverage: REvil\n\n**netskope.com/blog/netskope-threat-coverage-revil**\n\nGustavo Palazolo July 7, 2021\n\n## Summary\n\nThe [REvil ransomware (a.k.a Sodinokibi) is a threat group that operates in the RaaS](https://malpedia.caad.fkie.fraunhofer.de/details/win.revil)\n(Ransomware-as-a-Service) model, where the infrastructure and the malware are supplied to\naffiliates, who use the malware to infect target organizations. On July 2, the REvil threat\ngroup launched a supply chain ransomware attack using an exploit in Kaseya’s VSA remote\nmanagement software. REvil claims to have infected more than one million individual\ndevices around the world. The attackers demanded $45,000 USD to restore the files from a\nsingle infected device, or $70 million USD paid in BTC for a universal decrypter that will\nallegedly work for all of the victims of the Kaseya attack. This threat is targeting anyone with\nKaseya’s VSA Remote Management Platform agent installed on Microsoft Windows systems\n(any version).\n\n## Threat\n\n[The REvil group has likely used a zero-day exploit against Kaseya’s management server,](https://news.sophos.com/en-us/2021/07/04/independence-day-revil-uses-supply-chain-exploit-to-attack-hundreds-of-businesses/)\nallowing the attackers to deploy the malware remotely on Windows devices running the VSA\nagent application. The first step executed by the group was to deploy a base64-encoded file\nto Kaseya’s working directory, which was probably ignored by anti-virus engines as\n[recommended by Kaseya.](https://helpdesk.kaseya.com/hc/en-gb/articles/229014948-Anti-Virus-Exclusions-and-Trusted-Apps)\n\n\n-----\n\nOnce the encoded file ( agent.crt ) was deployed, the attacker executed a set of shell\ncommands remotely to decode and execute the payload, as well as to disable the Windows\nDefender protections. The decoded file ( agent.exe ) is a malware dropper that writes to\ndisk two different files:\n\n1. `MsMpEng.exe : This is an outdated version of Microsoft’s Antimalware Service that is`\n\nvulnerable to a technique known as DLL Hijacking.\n2. `mpsvc.dll : This is the packed REvil payload, which is loaded by` `MsMpEng.exe`\n\nthrough the DLL Hijacking technique.\n\n_“Agent.exe” writing REvil packed payload “mpsvc.dll” to disk_\nOnce executed, the REvil packed sample loads and executes a small shellcode, which is\nresponsible for unpacking and executing the final payload, which contains an encrypted\nconfiguration within the binary.\n\n\n-----\n\n_REvil ransomware encrypted configuration_\nThe data is encrypted with RC4, so we can use a small Python script to decrypt it:\n\n_Decrypting REvil configuration using Python_\n\nAfter decrypting the configuration, we can obtain more detailed information about the\nsample, such as the “affiliate” ID, ignored folders, C2 domains, etc.\n\n\n-----\n\n_Part of the decrypted_\n\n_REvil configuration_\nIn this case, the “net” option is set to “false” in the configuration, which tells the ransomware\nto ignore the C2 addresses. However, in case this option is set to “true,” the malware sends\na POST request to available addresses with information about the infected machine, such as\nthe encryption key and the machine name.\n\n_REvil ransomware preparing to send the POST request to the C2_\nWithin this REvil configuration, we have found 1,221 unique domains that could be used for\nnetwork communication.\n\nAfter encrypting the files, REvil changes the user’s background:\n\n\n-----\n\n_Image set by REvil as the user’s background_\nAlso, the ransom note is created in the directories where there are encrypted files:\n\n_Part of REvil ransom note_\n\n## Protection\n\nNetskope Threat Labs is actively monitoring this campaign and has ensured coverage for all\nknown threat indicators and payloads.\n\n**Netskope Threat Protection**\n```\n      Generic.Ransom.Sodinokibi.B.8FB3E6FD\n      Gen:Variant.Ransom.Sodinokibi.61\n      Gen:Variant.Razy.525651\n\n```\n**Netskope Advanced Threat Protection provides proactive coverage against this**\nthreat.\n```\n      Gen.Malware.Detect.By.StHeur indicates a sample that was detected using\n\n```\nstatic analysis\n```\n      Gen.Malware.Detect.By.Sandbox indicates a sample that was detected by\n\n```\nour cloud sandbox\n\n\n-----\n\n## Sample Hashes\n\n**Name** **sha256**\n\nagent.exe d55f983c994caa160ec63a59f6b4250fe67fb3e8c43a388aec60a4a6978e9f1e\n\nmpsvc.dll e2a24ab94f865caeacdf2c3ad015f31f23008ac6db8312c2cbfb32e4a5466ea2\n\nmpsvc.dll 8dd620d9aeb35960bb766458c8890ede987c33d239cf730f93fe49d90ae759dd\n\nunpacked 5286889a725a109df74bdee612ce2c288a61970d3126c466c4e8c5cde1cc23c3\n\nA full list of sample hashes, domains, and a tool to extract and decrypt the config from a\n[REvil sample are available in our Git repo.](https://github.com/netskopeoss/NetskopeThreatLabsIOCs/tree/main/REvil)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-07 - Netskope Threat Coverage- REvil.pdf"
    ],
    "report_names": [
        "2021-07-07 - Netskope Threat Coverage- REvil.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535765,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1653757964,
    "ts_modification_date": 1653757964,
    "files": {
        "pdf": "https://archive.orkl.eu/7dabe06dbb4ed749d3830b0225ac6403865bfd78.pdf",
        "text": "https://archive.orkl.eu/7dabe06dbb4ed749d3830b0225ac6403865bfd78.txt",
        "img": "https://archive.orkl.eu/7dabe06dbb4ed749d3830b0225ac6403865bfd78.jpg"
    }
}