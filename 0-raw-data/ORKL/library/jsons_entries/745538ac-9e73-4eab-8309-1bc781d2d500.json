{
    "id": "745538ac-9e73-4eab-8309-1bc781d2d500",
    "created_at": "2023-01-12T15:08:39.276019Z",
    "updated_at": "2025-03-27T02:15:59.335755Z",
    "deleted_at": null,
    "sha1_hash": "899e9fd8a1760eacb8e93261065f87f0ee3f1799",
    "title": "2019-09-24 - REvil- The GandCrab Connection",
    "authors": "",
    "file_creation_date": "2022-05-28T22:01:14Z",
    "file_modification_date": "2022-05-28T22:01:14Z",
    "file_size": 411465,
    "plain_text": "# REvil: The GandCrab Connection\n\n**secureworks.com/blog/revil-the-gandcrab-connection**\n\nCounter Threat Unit Research Team\n\n_Technical links between the REvil and GandCrab ransomware families prove that the_\n_GandCrab malware authors did not retire in June 2019 as they claimed. Tuesday, September_\n24, 2019 By: Counter Threat Unit Research Team\nOn May 31, 2019, the developers of the highly profitable GandCrab 'ransomware-as-aservice' [announced that they were retiring after earning over $2 billion USD since January](https://www.zdnet.com/article/gandcrab-ransomware-operation-says-its-shutting-down/)\n2018. The news was met with interest and skepticism within the security community, as\n\n\n-----\n\nmultiple affiliate groups regularly conducted extremely successful GandCrab campaigns\nsince its inception. After analyzing the threat landscape, Secureworks® Counter Threat\nUnit™ (CTU) researchers determined that some or all of GandCrab's developers, which the\nCTU™ research team refers to as GOLD GARDEN, simply shifted their focus to a different\nransomware variant.\n\n## Enter REvil\n\n[The REvil (also known as Sodinokibi) ransomware was first spotted in the wild (ITW) on April](https://blog.talosintelligence.com/2019/04/sodinokibi-ransomware-exploits-weblogic.html)\n17, when threat actors leveraged an Oracle WebLogic exploit to deliver both REvil and\nGandCrab. CTU analysis and tracking of REvil samples suggest that the ransomware was in\ndevelopment and testing between April 10 and May 7 and was not intended for public\nrelease.\n\nFollowing the release of version 1.01 on May 7, the REvil developers, which CTU\nresearchers refer to as GOLD SOUTHFIELD, began pushing a new release of the\nransomware at the beginning of each month. The features and modifications of each version\nare listed in the Appendix of this blog post. As of this publication, August is the only skipped\nmonth. This cadence and the ransomware's capabilities indicate a structured development\nprocess by dedicated and experienced malware authors.\n\nAfter GOLD GARDEN's retirement announcement, REvil activity increased with expanded\n[delivery methods such as malicious spam campaigns and](https://www.gdatasoftware.com/blog/2019/06/31724-strange-bits-sodinokibi-spam-cinarat-and-fake-g-data) [RDP attacks. This surge suggests](https://twitter.com/VirITeXplorer/status/1133302287491842049)\nthat the ransomware operators deemed it ready for public release. On June 20, REvil was\n[leveraged in a strategic web compromise (SWC) against the Italian WinRAR . it website,](https://www.drcommodore.it/2019/06/20/hackerato-winrar-it-malware-al-posto-del-programma/)\nreplacing the WinRAR installation executable with an instance of the malware to infect\ncustomers' systems. On the same day, threat actors breached at least three managed\nservice providers (MSPs) and used the access to deploy REvil to the MSPs' customers.\nOther high-profile supply-chain attacks involving REvil have impacted 22 Texas\n[municipalities and hundreds of dentist offices in the United States. Figure 1 shows a timeline](https://www.zdnet.com/article/ransomware-hits-hundreds-of-dentist-offices-in-the-us/)\nof REvil releases and malicious activity.\n\n\n-----\n\n_Figure 1. Timeline of REvil activity before and after GOLD GARDEN's retirement_\n_announcement. (Source: Secureworks)_\n\n## Connecting the dots\n\nNumerous characteristics indicate that the same developers were involved in producing\nGandCrab and REvil, suggesting a connection between members of the GOLD GARDEN\nand GOLD SOUTHFIELD threat groups. In a [technical analysis of REvil version 1.01, CTU](https://www.secureworks.com/research/revil-sodinokibi-ransomware)\nresearchers identified possible overlap between REvil and GandCrab. Even the earliest\nidentified REvil sample (REvil Beta) included elements that appear to refer to GandCrab.\n\n### Nearly identical string decoding function\n\nCTU researchers found that the string decoding functions employed by REvil and GandCrab\nare nearly identical. Because malware authors typically implement custom\nencoding/decoding logic in their malware, the code can be used as a fingerprint to identify\nother samples associated with the malware family. When analyzing REvil, CTU researchers\nidentified and extracted a portion of the opcodes (outlined in red in Figure 2) associated with\nits string decoding function.\n\n\n-----\n\n_Figure 2. Opcodes for FOR-loop within REvil and GandCrab string decoder function._\n_(Source: Secureworks)_\n\nWhen searching VirusTotal for samples containing this opcode pattern, 286 unique samples\nwere identified. Further analysis of all 286 samples were confirmed to be either GandCrab or\nREvil (including REvil's decryptor). CTU researchers have not identified other malware\nfamilies using this opcode pattern as of this publication, supporting the theory that these\nmalware families share code.\n\n### Similar URL building logic\n\nREvil 1.00 implements URL building functionality that produces the same command and\ncontrol (C2) URL pattern as GandCrab. The C2 URLs for both families consist of two URI\nsubpaths followed by a randomly generated resource name and an extension (see Figure 3).\nThe subpath names and extension are retrieved from the hard-coded values listed in Table 1.\n\n_Figure 3. Example C2 server URLs. (Source: Secureworks)_\n\n**Values for first subpath** **Values for second subpath** **Extensions for resource**\n\n\nwp-content\nstatic\ncontent\ninclude\nuploads\nnews\ndata\nadmin\n\n\nimages\npictures\nimage\ntemp\ntmp\ngraphic\nassets\npics\ngame\n\n\n.jpg\n.png\n.gif\n.bmp\n\n\n-----\n\n_Table 1. Hard-coded values for REvil and GandCrab C2 URLs._\n\nWhile technically it would be possible for an unaffiliated threat actor to reproduce this logic\nwithin a separate malware family, doing so with such accuracy would require the threat actor\nto reverse engineer a GandCrab sample. Given the level of effort requires and the\ninsignificant nature of the URI pattern, it is more likely that code originally created for\nGandCrab was repurposed in REvil.\n\n### Hints at GandCrab version 6\n\nCTU analysis of the [REvil Beta sample revealed two findings that are significant in proving a](https://www.virustotal.com/gui/file/3641b09bf6eae22579d4fd5aae420476a134f5948966944189a70afd8032cb45/)\nlink between GandCrab and this first-identified version of REvil:\n\n**gcfin and gc6 debug paths — A debug path is typically created by the integrated**\ndevelopment environment (IDE) used by the malware author. Competent malware\n[authors remove this information prior to distribution, as it could reveal the malware's](https://www.fireeye.com/blog/threat-research/2019/08/definitive-dossier-of-devilish-debug-details-part-one-pdb-paths-malware.html)\nname or details about the malware author's environment. The REvil Beta sample\nincludes the d:\\code\\csrc\\!1\\new_a\\gcfin\\bin\\debug\\rwenc_exe_x86_debug.pdb debug\npath. gcfin is the malware author's name for the development project, and in context\nwith other evidence appears to refer to “GandCrab Final”. Similarly, a [discovered REvil](https://twitter.com/noblebarstool/status/1146079158096687105)\nfile decryptor executable specifies the D:\\\\gc6\\\\core\\\\src\\\\common\\\\debug.c debug path.\nThe reference to gc6 in the debug path could be a reference to GandCrab 6, which\nsuggests that REvil was originally intended as GandCrab version 6.\n\n**REvil version 6.00? — REvil populates a stat JSON data structure with information**\nabout the malware and the compromised host. Starting with REvil 1.00, the stat JSON\nis encrypted and sent to the attacker's C2 server. CTU researchers determined that the\ninteger value assigned to the ver key located within the stat JSON represents the\nmalware version. REvil interprets the value as hexadecimal. The REvil Beta sample\nincludes the hard-coded value 1536, which converts to hexadecimal is 0x600 and\nindicates version 6.00. This version does not align with REvil's incremental numbering\npattern as the next release is version 1.00, but it would align with the GandCrab\n[numbering pattern given that the last observed version of GandCrab was 5.2.](https://www.bleepingcomputer.com/news/security/release-of-gandcrab-52-decryptor-ends-a-bad-ransomware-story/)\n\n### Region whitelisting\n\nBoth REvil and GandCrab whitelist similar keyboard locales to prevent infection of Russiabased hosts. Malware authors commonly whitelist regions where they reside to prevent\nscrutiny from local law enforcement. This similarity does not establish a direct connection\nbetween REvil and GandCrab but does indicate that the malware authors likely reside in the\nsame region.\n\n\n-----\n\n## Conclusion\n\nGandCrab's 'ransomware-as-a-service model' proved to be a highly lucrative endeavor for\nGOLD GARDEN, so it is unlikely that the threat actors abandoned all malicious activity.\nCharacteristics of REvil that appear to be operational security mistakes by the malware\nauthors enabled CTU researchers to technically link the REvil and GandCrab ransomware\nfamilies. This link indicates that the malware authors have shifted their focus from GandCrab\nto REvil.\n\n## Appendix — REvil version features and modifications\n\n**REvil Beta**\n\n**MD5: bed6fc04aeb785815744706239a1f243**\n\n**SHA1: 3d0649b5f76dbbff9f86b926afbd18ae028946bf**\n\n**SHA256: 3641b09bf6eae22579d4fd5aae420476a134f5948966944189a70afd8032cb45**\n\nPrivilege escalation via CVE-2018-8453 (64-bit only)\nRerun with RunAs to elevate privileges\nImplements a requirement that if “exp” is set, privilege escalation must be successful\nfor full execution to occur\nImplements target whitelisting using GetKetboardLayoutList\nContains debug console logging functionality\nDefines the REvil registry root key as SOFTWARE\\!test\nIncludes two variable placeholders in the ransom note: UID & KEY\nTerminates processes specified in the “prc” configuration key prior to encryption\nDeletes shadow copies and disables recovery\nWipes contents of folders specified in the \"wfld\" configuration key prior to encryption\nEncrypts all non-whitelisted files on fixed drives\nEncrypts all non-whitelisted files on network mapped drives if it is running with\nSystem-level privileges or can impersonate the security context of explorer.exe\nPartially implements a background image setting to display a basic \"Image text\"\nmessage\nSends encrypted system data to a C2 domain via an HTTPS POST request (URI\npath building is not implemented.)\n\n**REvil 1.00**\n\n\n-----\n\n**MD5: 65aa793c000762174b2f86077bdafaea**\n\n**SHA1: 95a21e764ad0c98ea3d034d293aee5511e7c8457**\n\n**SHA256: f0c60f62ef9ffc044d0b4aeb8cc26b971236f24a2611cb1be09ff4845c3841bc**\n\nAdds 32-bit implementation of CVE-2018-8453 exploit\nRemoves console debug logging\nChanges the REvil registry root key to SOFTWARE\\recfg\nRemoves the System/Impersonation success requirement for encrypting network\nmapped drives\nAdds a \"wipe\" key to the configuration for optional folder wiping\nFully implements the background image setting and leverages values defined in the\n“img” configuration key\nAdds an EXT variable placeholder to the ransom note to support UID, KEY, and EXT\nImplements URI path building so encrypted system data is sent to a C2 pseudorandom URL\nFixes the function that returns the victim's username so the correct value is placed in\nthe stats JSON data\n\n**REvil 1.01**\n\n**MD5: 2abff29b4d87f30f011874b6e98959e9**\n\n**SHA1: 9d1b61b1cba411ee6d4664ba2561fa59cdb0732c**\n\n**SHA256: a88e2857a2f3922b44247316642f08ba8665185297e3cd958bbd22a83f380feb**\n\nRemoves the exp/privilege escalation requirement for full execution and encrypts\ndata regardless of privilege level\nMakes encryption of network mapped drives optional by adding the “-nolan”\nargument\n\n**REvil 1.02**\n\n\n-----\n\n**MD5: 4af953b20f3a1f165e7cf31d6156c035**\n\n**SHA1: b859de5ffcb90e4ca8e304d81a4f81e8785bb299**\n\n**SHA256: 89d80016ff4c6600e8dd8cfad1fa6912af4d21c5457b4e9866d1796939b48dc4**\n\nEnhances whitelisting validation by adding inspection of GetUserDefaultUILanguage\nand GetSystemDefaultUILanguage\nPartially implements “lock file” logic by generating a lock filename based on the first\nfour bytes of the Base64-decoded pk key, appending a .lock file extension, and\nadding the filename to\n\nthe list of whitelisted files in the REvil configuration (It does not appear that this value\nis referenced after it is created and stored in memory. There is no evidence that a\nlock file is dropped to disk.)\nEnhances folder whitelisting logic that take special considerations if the folder is\nassociated with \"program files\" directories\n\nHard-codes whitelisting of all direct content within the Program Files or\nProgram Files x86 directories\nHard-codes whitelisting of \"sql\" subfolders within program files\nEncrypts program files sub-folders that does not contain \"sql\" in the path\nCompares other folders to the list of whitelisted folders specified in the REvil\nconfiguration to determine if they are whitelisted\nEncodes stored strings used for URI building within the binary and decodes them in\nmemory right before use\nIntroduces a REvil registry root key \"sub_key\" registry value containing the attacker's\npublic key\n\n**REvil 1.03**\n\n**MD5: 3cae02306a95564b1fff4ea45a7dfc00**\n\n**SHA1: 0ce2cae5287a64138d273007b34933362901783d**\n\n**SHA256: 78fa32f179224c46ae81252c841e75ee4e80b57e6b026d0a05bb07d34ec37bbf**\n\nRemoves lock file logic that was partially implemented in 1.02\nLeverages WMI to continuously monitor for and kill newly launched processes whose\nnames are listed in the prc configuration key (Previous versions performed this\naction once.)\nEncodes stored shellcode\nAdds the -path argument:\n\nDoes not wipe folders (even if wipe == true)\nDoes not set desktop background\nDoes not contact the C2 server (even if net == true)\nEncrypts files in the specified folder and drops the ransom note\nChanges the REvil registry root key to SOFTWARE\\QtProject\\OrganizationDefaults\nChanges the registry key value names\n\n**REvil 1.04**\n\n\n-----\n\n**MD5: 6e3efb83299d800edf1624ecbc0665e7**\n\n**SHA1: 0bd22f204c5373f1a22d9a02c59f69f354a2cc0d**\n\n**SHA256: 2ca64feaaf5ab6cf96677fbc2bc0e1995b3bc93472d7af884139aa757240e3f6**\n\nLeverages PowerShell and WMI to delete shadow copies if the victim's operating\nsystem is newer than Windows XP (For Windows XP or older, it uses the original\ncommand that was executed in all previous REvil versions.)\nRemoves the folder wipe capability\nChanges the REvil registry root key to SOFTWARE\\GitForWindows\nChanges the registry key value names\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-24 - REvil- The GandCrab Connection.pdf"
    ],
    "report_names": [
        "2019-09-24 - REvil- The GandCrab Connection.pdf"
    ],
    "threat_actors": [
        {
            "id": "70268431-11ed-474f-9fbc-96f894684201",
            "created_at": "2023-01-06T13:46:39.26058Z",
            "updated_at": "2025-03-27T02:00:03.034054Z",
            "deleted_at": null,
            "main_name": "GOLD GARDEN",
            "aliases": [],
            "source_name": "MISPGALAXY:GOLD GARDEN",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c84bbd2e-003d-4c43-8a46-d777455db2c7",
            "created_at": "2022-10-25T15:50:23.701006Z",
            "updated_at": "2025-03-27T02:00:55.527357Z",
            "deleted_at": null,
            "main_name": "GOLD SOUTHFIELD",
            "aliases": [
                "GOLD SOUTHFIELD",
                "Pinchy Spider"
            ],
            "source_name": "MITRE:GOLD SOUTHFIELD",
            "tools": [
                "ConnectWise",
                "REvil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "02ef8063-7ad4-42ba-a646-97210000f6b5",
            "created_at": "2024-06-19T02:03:08.117993Z",
            "updated_at": "2025-03-27T02:05:17.397211Z",
            "deleted_at": null,
            "main_name": "GOLD SOUTHFIELD",
            "aliases": [
                ""
            ],
            "source_name": "Secureworks:GOLD SOUTHFIELD",
            "tools": [
                "REvil"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "404bb014-d051-447e-90d8-1a4adc3409b0",
            "created_at": "2024-06-19T02:03:08.058292Z",
            "updated_at": "2025-03-27T02:05:17.370545Z",
            "deleted_at": null,
            "main_name": "GOLD GARDEN",
            "aliases": [
                ""
            ],
            "source_name": "Secureworks:GOLD GARDEN",
            "tools": [
                "GandCrab"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "7961bf6e-e429-484c-93e2-bd1d36fa5588",
            "created_at": "2023-01-06T13:46:39.275053Z",
            "updated_at": "2025-03-27T02:00:03.037764Z",
            "deleted_at": null,
            "main_name": "GOLD SOUTHFIELD",
            "aliases": [],
            "source_name": "MISPGALAXY:GOLD SOUTHFIELD",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9df68733-9bcd-43b1-88f1-24b110fa3d56",
            "created_at": "2022-10-25T16:07:24.051993Z",
            "updated_at": "2025-03-27T02:02:10.091553Z",
            "deleted_at": null,
            "main_name": "Pinchy Spider",
            "aliases": [
                "Gold Garden",
                "Gold Southfield",
                "Pinchy Spider"
            ],
            "source_name": "ETDA:Pinchy Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "GandCrab",
                "GrandCrab",
                "REvil",
                "Sodin",
                "Sodinokibi",
                "VIDAR",
                "Vidar Stealer",
                "certutil",
                "certutil.exe",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536119,
    "ts_updated_at": 1743041759,
    "ts_creation_date": 1653775274,
    "ts_modification_date": 1653775274,
    "files": {
        "pdf": "https://archive.orkl.eu/899e9fd8a1760eacb8e93261065f87f0ee3f1799.pdf",
        "text": "https://archive.orkl.eu/899e9fd8a1760eacb8e93261065f87f0ee3f1799.txt",
        "img": "https://archive.orkl.eu/899e9fd8a1760eacb8e93261065f87f0ee3f1799.jpg"
    }
}