{
    "id": "5864edb4-960b-4261-8319-923d67f48da1",
    "created_at": "2023-01-12T15:09:18.844164Z",
    "updated_at": "2025-03-27T02:05:39.033763Z",
    "deleted_at": null,
    "sha1_hash": "43b08aecc6b9e1f15b2c9d27c8304f1c623c8c59",
    "title": "2022-06-28 - Interactive Phishing Mark II- Messenger Chatbot Leveraged in a New Facebook-Themed Spam",
    "authors": "",
    "file_creation_date": "2022-09-01T10:09:19Z",
    "file_modification_date": "2022-09-01T10:09:19Z",
    "file_size": 808390,
    "plain_text": "# Interactive Phishing Mark II: Messenger Chatbot Leveraged in a New Facebook-Themed Spam\n\n**trustwave.com/en-us/resources/blogs/spiderlabs-blog/interactive-phishing-mark-ii-messenger-chatbot-leveraged-in-a-**\nnew-facebook-themed-spam\n\nLoading...\n\nBlogs & Stories\n\n## SpiderLabs Blog\n\nAttracting more than a half-million annual readers, this is the security community's go-to\ndestination for technical breakdowns of the latest threats, critical vulnerability disclosures\nand cutting-edge research.\n\nFacebook Messenger is one of the most popular messaging platforms in the world,\n[amassing 988 million monthly active users as of January 2022, according to Statista. One](https://www.statista.com/topics/2018/whatsapp/#:~:text=As%20of%202022%2C%20WhatsApp%20is%20the%20most%20popular,is%20the%20third%20most%20popular%20social%20network%20worldwide.)\nimportant feature of this platform is Messenger’s bot. Within the current digital landscape,\nchatbots are widely used by companies and individuals to connect with their customers\nonline, and almost immediately pops up when chatting with brands or businesses. This was\n[shown in an earlier Trustwave SpiderLabs blog that detailed how chatbots are used in email](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/interactive-phishing-using-chatbot-like-web-applications-to-harvest-information/)\nphishing attacks.\n\n\n-----\n\nThe application s popularity makes it an attractive target for cybercriminals. With millions of\nactive users, scammers and threat actors have easy access to numerous potential victims.\nIn this case, the threat actors are attempting to steal Facebook login credentials.\n\nFrom phishing and scam attempts, to bogus job offers, fraudsters are always coming up\nwith new techniques to steal credentials or money. This time, our team came across a\nphishing email that makes use of Meta’s Messenger chatbot feature.\n\nFigure 1 Spam Email\n\nThis malicious email claims that the user’s page is about to be terminated due to a violation\nof Facebook’s community standards. This claim can resonate with Facebook users as most\npeople have heard that the social media site is clamping down on users who violate the\nrules. The sender, who appears to be from Facebook’s support team, is giving the user a\nchance to appeal this termination. A 48-hour ultimatum was given, invoking a sense of\nurgency to the recipient. Some errors are present in the message such as the improper\ncapitalization of the word “Page”, and the missing dot at the end of the third sentence. Such\nmistakes are almost always indicators that a message may not be legitimate.\n\nFigure 2 Email Header\n\nOn closer inspection, several additional red flags are seen in the email header. The sender\nis named as “Policy Issues”, a tricky way to lure and cause panic to the recipient. The\nsender domain does not belong to Facebook. It is also evident in the email’s Received\n\n\n-----\n\nheaders and sender IP address that it was not sent by the social media platform but a tool\ndesigned for marketing and Customer Relation Management.\n\nFigure 3 Embedded link in email body\n\nThere is a shortened URL embedded in the “Appeal Now” button which contains a\nsupposed case number in its path. Meta, formerly known as Facebook, Inc., has its own\nURL shortener which uses m.me domain that redirects the user to a personal account page,\nor conversation in Messenger. In our email sample, the embedded link redirects to a\nMessenger conversation with a chatbot.\n\nFigure 4 Chat message with alleged Facebook Support\n\n\n-----\n\nThe user must be logged into the platform to engage with the chatbot. If not, it prompts the\nuser to log in to Facebook. Once that is done, the user can view the conversation window\nand press the default “Get Started” button. The chatbot will then respond with a message\nsimilar to that contained in the email shown earlier.\n\nThe persona that the user is chatting with is supposedly someone from the Facebook\nsupport team. However, closer inspection of the profile owning the page will reveal that this\nis not an actual support page. The profile used is just a normal business/fan page with zero\nfollowers and no posts. Even though this page may seem unused, it had a “Very\nResponsive” badge which Facebook defines as having a response rate of 90% and\nresponds within 15 minutes. It even sported a Messenger logo as its profile picture to\nappear legitimate.\n\nThe account handle “case932571902” also does not pertain to the official Facebook support\nchannel. The handle was designed to make the shortened URL appear as if it was an actual\nlink to a violation case.\n\nFigure 5 Fake Facebook Support Page\n\nClicking the “Appeal Now” button in the chat opens a new tab to a website hosted in Google\nFirebase. Firebase is an application development software that provides developers with a\nvariety of tools to help build, improve, and grow the app. With the rise of app and web\nbuilding tools, it is easy for anyone to create and publish webpages. Spammers take\nadvantage of this availability and in this case they built a website disguised as a Facebook\n\n\n-----\n\nSupport Inbox where the user can purportedly appeal the supposed deletion of their page.\nHere, another piece of evidence points to how this interaction is fake. Notice how the case\nnumber in this website is inconsistent with the first URL.\n\nFigure 6 Fake Facebook Support Inbox Page\n\nSeveral elements of the website such as “OPEN” and “Appeal” look like buttons, but in fact\nare not clickable as shown by the code below. The fields for detail collection are located\ntowards the bottom part of the website.\n\nFigure 7 Code Snippet for Open and Appeal \"Button\"\n\nThe user is then required to enter their credentials such as an email address or mobile\nnumber, first and last name and page name. An additional text box for a phone number is\ndisplayed even though a mobile number is already being asked in the first text box. This\ndetail will serve a function later in the phishing chain.\n\n\n-----\n\nFigure 8 Initial data gathering\n\nAfter pressing the Submit button, a pop-up window will appear asking for the user’s\npassword. This is a clever trick to remain inconspicuous and not immediately raise alarms\nto the user.\n\nFigure 9 Window for password gathering\n\nThe collected information is posted to the spammers’ database after pressing the Submit\nbutton as shown by this code snippet.\n\n\n-----\n\nFigure 10 Code snippet for POST method\n\nHowever, the attack does not end there. Using the location.href property, the user is\nredirected to a supposed two-factor authentication page with a count-down timer. It is\nasking for a 6-digit One-Time Password (OTP) to be sent to the user. One-Time Passwords\ncan be sent to a user through different channels, including a Short Message Service (SMS)\ntext, an email, or a dedicated application. Since the email address, password and mobile\nnumber were collected from the user before, a subsequent 2-FA page is shown to continue\nthis deception. This may makes sense to the victim as it is now common practice to have\nanother layer of authentication after providing such credentials.\n\nFigure 11 Fake OTP Page\n\nThe form will accept multi-digit input but has no length-checking as shown below.\n\n\n-----\n\nFigure 12 Source code for OTP textbox\n\nUpon checking the website’s entire source code, no mechanism for OTP generation, such\nas an API, is seen. Users can input any numerical code and it will be posted to the same\ndatabase, and the page will then be redirected to the actual Facebook Help Centre.\n\nFigure 13 POST method for OTP input\n\nThe final landing page is an article on intellectual property and copyright guidelines of\nFacebook.\n\n\n-----\n\nFigure 14 Facebook Help Centre\n\n**Phishing Link Chain:**\n\nMessenger Chatbot hxxps://m[.]me/case932571902\n\n\nEmail address, name, mobile number\ncollection\n\n\nhxxps://appeal59321958[.]web[.]app/appeal[.]html\n\n\nPassword collection hxxps://appeal59321958[.]web[.]app/pointp[.]html\n\nOTP Page hxxps://appeal59321958[.]web[.]app/twofac.html\n\nThe spammers used the words “case” and “appeal” in the URL path to tie these websites in\nto the lure of the phishing email and make them appear legitimate.\n\nAt the time of writing, the fake Facebook Support page and the phishing website have been\ntaken down, but there is no reason to believe another threat actor might not use the same\ntactic in the future.\n\n### Conclusion\n\n[This spam is reminiscent of a faux chatbot phishing website that we reported before.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/interactive-phishing-using-chatbot-like-web-applications-to-harvest-information/)\nChatbots serve a huge purpose in digital marketing and live support, so it is no wonder that\ncyber attackers are now abusing this feature. People are not inclined to be suspicious of its\ncontents, specially if it comes from a seemingly genuine source.\n\nThe fact that the spammers are leveraging the platform that they are mimicking makes this\ncampaign a perfect social engineering technique.\n\nAs always, we advise everyone to remain vigilant when surfing the web and to not interact\nwith unsolicited emails. MailMarshal provides protection against this phishing email.\n\n### IOCs:\n\nhxxps://m[.]me/ case932571902\n\nhxxps://www[.]facebook[.]com/case932571902/\n\nhxxps://appeal-59321958[.]web[.]app/appeal[.]html\n\nhxxps://appeal-59321958[.]web[.]app/pointp[.]html\n\n\n-----\n\nhxxps://appeal-59321958[.]web[.]app/twofac.html\n\nReference:\n\nStatista - https://www.statista.com/statistics/272014/global-social-networks-ranked-bynumber-of-users/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-28 - Interactive Phishing Mark II- Messenger Chatbot Leveraged in a New Facebook-Themed Spam.pdf"
    ],
    "report_names": [
        "2022-06-28 - Interactive Phishing Mark II- Messenger Chatbot Leveraged in a New Facebook-Themed Spam.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536158,
    "ts_updated_at": 1743041139,
    "ts_creation_date": 1662026959,
    "ts_modification_date": 1662026959,
    "files": {
        "pdf": "https://archive.orkl.eu/43b08aecc6b9e1f15b2c9d27c8304f1c623c8c59.pdf",
        "text": "https://archive.orkl.eu/43b08aecc6b9e1f15b2c9d27c8304f1c623c8c59.txt",
        "img": "https://archive.orkl.eu/43b08aecc6b9e1f15b2c9d27c8304f1c623c8c59.jpg"
    }
}