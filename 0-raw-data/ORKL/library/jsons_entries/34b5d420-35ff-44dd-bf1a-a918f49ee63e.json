{
    "id": "34b5d420-35ff-44dd-bf1a-a918f49ee63e",
    "created_at": "2023-01-12T15:06:46.080539Z",
    "updated_at": "2025-03-27T02:10:49.307321Z",
    "deleted_at": null,
    "sha1_hash": "a0cb86008cc131b2668dd87ba631706fa4368a60",
    "title": "2020-11-26 - Payment skimmer hides in social media buttons",
    "authors": "",
    "file_creation_date": "2022-05-28T22:08:26Z",
    "file_modification_date": "2022-05-28T22:08:26Z",
    "file_size": 336761,
    "plain_text": "# Payment skimmer hides in social media buttons\n\n**sansec.io/research/svg-malware**\n\n26th November 2020\n\n[Web Skimming / Sansec Threat Research](https://sansec.io/research)\nLearn about new eCommerce hacks?\n\n\nNovember 26, 2020\n\n\nReceive an alert whenever we discover new hacks or vulnerabilities that may affect\nyour online store.\n\nWhat is\n\nMagecart?\n\nAlso known as digital skimming, this crime has surged since 2015. Criminals steal card\ndata during online shopping. Who are behind these notorious hacks, how does it work,\nand how have Magecart attacks evolved over time?\n\n[About Magecart](https://sansec.io/what-is-magecart)\n\n\n-----\n\nResearchers at Sansec have uncovered a novel technique to inject payment skimmers onto\ncheckout pages. This new malware has two parts: a concealed payload and a decoder, of\nwhich the latter reads the payload and executes the concealed code.\n\nWhile skimmers have added their malicious payload to benign files like images in the past,\nthis is the first time that malicious code has been constructed as a perfectly valid image. The\nresult is that security scanners can no longer find malware just by testing for valid syntax.\n\nThe malicious payload assumes the form of an html `<svg> element, using the` `<path>`\nelement as a container for the payload. The payload itself is concealed utilizing syntax that\nstrongly resembles correct use of the `<svg> element. To complete the illusion of the image`\nbeing benign, the malware’s creator has named it after a trusted social media company.\nFurther investigation has revealed there are at least six major names being used:\n```\ngoogle_full\nfacebook_full\ntwitter_full\ninstagram_full\nyoutube_full\npinterest_full\n\n## Steganography\n\n```\nThe second part of the malware is a decoder that interprets & executes the payload. Below is\na beautified version:\n\n\n-----\n\nIt is worth noting that the decoder does not have to be injected in the same location as the\npayload. This adds to it’s concealment, as finding only one of the parts, one might not\ndeduce the true purpose of a slightly strangely formatted svg.\n\nAn attacker can of course conceal any payload with this technique. Samples taken by\nSansec revealed payment skimming as the true purpose of the malware injections.\n\n## Possible Test Run?\n\nIn June 2020 a similar malware was detected by Sansec, using the same technique. This\nmalware was not as sophisticated and was only detected on 9 sites on a single day. Of these\n9 infected sites, only 1 had functional malware. The 8 remaining sites all missed one of the\ntwo components, rendering the malware useless.\n\nAfter the discovery of this new and more sophisticated malware, the question arises if the\nJune injections could have been the creator running a test to see how well their new creation\nwould fare. This new malware was first found on live sites in mid-September.\n\n[data-size=\"large\" > Follow @sansecio](https://twitter.com/sansecio)\n\nStay ahead of eCommerce hacks,\n\nprotect your store today!\n\nSansec forensic experts were the first to document large scale digital skimming in 2015.\nSince then, we have investigated thousands of hacked stores. Our research of the latest\nattack vectors protects our customers around the world. Our anti-skimming technology and\ndata are used by merchants, forensic investigators, financial anti-fraud teams and service\nproviders\n\n[Try our malware scanner](https://sansec.io/ecomscan)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-26 - Payment skimmer hides in social media buttons.pdf"
    ],
    "report_names": [
        "2020-11-26 - Payment skimmer hides in social media buttons.pdf"
    ],
    "threat_actors": [
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536006,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1653775706,
    "ts_modification_date": 1653775706,
    "files": {
        "pdf": "https://archive.orkl.eu/a0cb86008cc131b2668dd87ba631706fa4368a60.pdf",
        "text": "https://archive.orkl.eu/a0cb86008cc131b2668dd87ba631706fa4368a60.txt",
        "img": "https://archive.orkl.eu/a0cb86008cc131b2668dd87ba631706fa4368a60.jpg"
    }
}