{
    "id": "797a0040-5f58-4249-962a-9f050ea632a5",
    "created_at": "2023-02-02T02:08:17.5832Z",
    "updated_at": "2025-03-27T02:09:18.302074Z",
    "deleted_at": null,
    "sha1_hash": "5568b1fecd2dcb7a4e2bcebd915d3300ffe9f38f",
    "title": "2023-01-12 - Gootloader Malware Leads to Cobalt Strike and Hand-on-Keyboard Activity",
    "authors": "",
    "file_creation_date": "2023-02-01T07:48:30Z",
    "file_modification_date": "2023-02-01T07:48:30Z",
    "file_size": 2353829,
    "plain_text": "# Gootloader Malware Leads to Cobalt Strike and…\n\n**[esentire.com/blog/gootloader-leads-to-cobalt-strike-and-hand-on-keyboard-activity](https://www.esentire.com/blog/gootloader-leads-to-cobalt-strike-and-hand-on-keyboard-activity)**\n\nResources\n\nTRU INTELLIGENCE CENTER\n\nOur Threat Response Unit (TRU) publishes security advisories, blogs, reports, industry\npublications and webinars based on its original research and the insights driven through\nproactive threat hunts.\n\n[View Threat Intelligence Resources →](https://www.esentire.com/resources/tru-intelligence-center)\nCompany\n\nABOUT ESENTIRE\n\nAbout Us\n\neSentire is The Authority in Managed Detection and Response Services, protecting the\ncritical data and applications of 1500+ organizations in 80+ countries from known and\nunknown cyber threats. Founded in 2001, the company’s mission is to hunt, investigate and\nstop cyber threats before they become business disrupting events.\n\n[Read about how we got here](https://www.esentire.com/company/about-us)\n\n\n-----\n\n[Leadership](https://www.esentire.com/company/leadership) [Work at eSentire](https://www.esentire.com/company/careers)\nEVENT CALENDAR\n\nFeb\n\n20\n\nNetDeligence Cyber Risk Summit\n\neSentire will be a Sponsor at the NetDeligence Cyber Risk Summit in Fort…\n\nMar\n\n28\n\nNetDeligence Cyber Risk Summit\n\neSentire will be a Sponsor at the NetDeligence Cyber Risk Summit in…\n\nApr\n\n24\n\nRSA Conference\n\neSentire is an exhibitor at RSAC 2023. Visit us at Booth 0535.\n\n[View Event Calendar →](https://www.esentire.com/company/event-calendar)\nPartners\n\nPARTNER PROGRAM\n\ne3 Ecosystem\n\nWe provide sophisticated cybersecurity solutions for Managed Security Service Providers\n(MSSPs), Managed Service Providers (MSPs), and Value-Added Resellers (VARs). Find out\nwhy you should partner with eSentire, the Authority in Managed Detection and Response,\ntoday.\n\n[Learn more](https://www.esentire.com/partners)\nSearch\n\nResources\n\n[Speak With A Security Expert Now](https://www.esentire.com/get-started)\n\n\n-----\n\n[Adversaries don t work 9-5 and neither do we. At eSentire, our 24/7 SOCs are staffed with](https://www.esentire.com/what-we-do/security-operations-center)\nElite Threat Hunters and Cyber Analysts who hunt, investigate, contain and respond to\nthreats within minutes.\n\nWe have discovered some of the most dangerous threats and nation state attacks in our\nspace – including the Kaseya MSP breach and the more_eggs malware.\n\nOur Security Operations Centers are supported with Threat Intelligence, Tactical Threat\nResponse and Advanced Threat Analytics driven by our Threat Response Unit – the TRU\nteam.\n\nIn TRU Positives, eSentire’s Threat Response Unit (TRU) provides a summary of a recent\nthreat investigation. We outline how we responded to the confirmed threat and what\nrecommendations we have going forward.\n\n**Here’s the latest from our TRU Team…**\n\n## What did we find?\n\n[We uncovered Gootloader malware using a new infection technique, which helped](https://www.esentire.com/blog/gootloader-striking-with-a-new-infection-technique)\nfurther insights into the threat actor(s) tools and next infection phase.\nGootloader’s initial JavaScript payload was delivered using the same technique via a\ncompromised WordPress website.\n\n_Figure 1: Compromised WordPress site serving the initial payload_\n\nBased on the sample retrieved from the infected webpage, the initial payload creates\nseveral files under a legitimate folder inAppData\\Roaming:\n\nParliamentary Procedure.log (Engineering Geology.log on the infected machine)\nTIBCO Rendezvous.js (Custom Built-ins.js on the infected machine)\n\n\n-----\n\nIt is worth mentioning that the filenames and scheduled task name can be different even if\nthe initial payload was downloaded from the same infected webpage.\n\nThe scheduled task “Foreign Languages” is also created to run the “TIBCO\nRendezvous.js” file with TIBCOR~1.JS argument at the log on from the sample we\nretrieved.\nApproximately 2 hours after the initial infection, we observed hands-on activity on the\nsystem. The threat actor(s) deployed a Cobalt Strike payload via the existing\nPowerShell process that beaconed out to several domains with /GET /xmlrpc.php\nrequests (e.g. hxxps[://]thetripgoeson[.]com/xmlrpc[.]php).\n\n### The next stage of Gootloader (threat actor(s)’ hands-on activity)\n\nThe threat actor(s) retrieved and ran the Cobalt Strike payload zieu.ps1 from path\nappdata\\roaming\\btbh\\.\n\n_Figure 2: Retrieved zieu.ps1 Cobalt Strike payload_\nAfter establishing the connection with the Cobalt Strike server (91.215.85[.]176), the threat\nactor(s) proceeded with retrieving and extracting BloodHound, a tool used for graphically\nanalyzing Active Directory and other identity systems to identify attack pathways\n(20230103151757_bloodhound.zip) that contained pshound.ps1 under C:\\Users\\\n<username>.\n\nAfter further analyzing the Windows Event Logs, we concluded that the script is similar to the\n[one mentioned\nby GuidePoint Security that appears to be a BloodHound executable.](https://www.guidepointsecurity.com/blog/how-to-peel-a-powershell-onion-a-bloodhound-case-study/)\n\n\n-----\n\nBesides the Cobalt Strike payload, the threat actor(s) retrieved the following files/tools:\n\nPsExec (C:\\Users\\) – a command-line tool used to execute processes on remote\ncomputers, enabling administrators to remotely control other systems on a network.\nnwu2ndiyotmtmdvmnc00zja1lwi3yjmtyzllztrlngixm2vk.bin (C:\\Users\\). Unfortunately, we\ncould not retrieve the file for analysis.\ns5.ps1, son.ps1 (AppData\\Local) - PowerShell SOCKS proxy script that connects to the\nC2 server 91.92.136[.]20 over port 4001.\n\n_Figure 3: Snippet of s5.ps1 script_\nThe persistence via Registry Run Keys was created to run the PowerShell SOCKS proxy\nscript with the following values:\n\nRegistry Run Key name: socks_powershell\n\nData (command to run): Powershell.exe -windowstyle hidden -ExecutionPolicy Bypass -File\n\"C:\\Users\\\\AppData\\Local\\s5.ps1\"\n\nThe threat actor(s) removed most of the files they dropped on the host including the results\nproduced by BloodHound as well as an unidentified krb.txt file dropped under C:\\Users\\.\n\nAfter running BloodHound, the threat actor(s) attempted to move laterally by using PsExec to\nexecute file rz.ps1 on a second host. This was not successful due to the PowerShell\nexecution policy preventing execution of untrusted scripts. We were unable to retrieve the\nrz.ps1 script, but we assess it was likely a Cobalt Strike payload.\n\n## How did we find it?\n\n\n-----\n\nBlueSteel, our machine-learning powered PowerShell classifier identified postcompromise activity on the system.\n\n## What did we do?\n\nOur team of [24/7 SOC Cyber Analysts isolated the host and alerted the customer.](https://www.esentire.com/what-we-do/security-operations-center)\nThe SOC updated the customer with detailed findings and recommendations to\nremediate this threat.\nWe added C2 addresses to our global blocklist and performed proactive threat hunts\nfor similar activity across all customers.\nWe also updated our Gootloader detection and runbook for this new infection\ntechnique.\n\n## What can you learn from this TRU positive?\n\nGootloader is a prevalent drive-by threat distributed through poisoned search results.\nInfected devices present a valuable foothold for adversaries to conduct follow-on\nattacks across the network.\n\nIn the above case, the infected device transitioned to a hands-on-keyboard attack\nin approximately 2 hours.\nThe drive-by distribution method presents an alternative to email as a vector for\ndelivering malicious code.\n\n[Gootloader uses blackhat SEO techniques to manipulate search results and](https://www.esentire.com/blog/black-hat-seo-techniques-employed-by-gootloader)\ndeliver malware disguised as documents.\nOther drive-by threats utilize malicious search engine advertisements to push\nlookalike software containing malware.\nGootloader follows a general trend observed across several threats where widely\ndistributed, opportunistic infections are weaponized for network intrusions including\nransomware deployment.\nIn this case, we assess the goal was likely data theft or ransomware deployment.\nGootloader has been previously used as a precursor to the REvil ransomware group in\n2021.\n\n## Recommendations from our Threat Response Unit (TRU) Team:\n\n\n-----\n\nUsing [Phishing and Security Awareness Training (PSAT), educate your employees](https://www.esentire.com/what-we-do/managed-vulnerability-and-risk/technical-testing/security-awareness-training-managed-phishing-training)\nregarding the risk of Gootloader and, more broadly, the cybersecurity risks associated\nwith using search engines to find free document templates.\n\nMake sure you trust document sources. Even legitimate Word and Excel\ndocuments from the Internet can lead to malware infections.\nEnsure your downloaded content is what you intended. If you intended to\ndownload a document (.docx) but you are served a JavaScript (.js) file, do not\nopen it. Escalate it to your internal IT security team.\nEnsure standard procedures are in place for employees to submit potentially malicious\ncontent for review.\nUse [Windows Attack Surface Reduction rules to block JScript and VBScript from](https://docs.microsoft.com/en-us/microsoft-365/security/defender-endpoint/attack-surface-reduction?view=o365-worldwide#block-javascript-or-vbscript-from-launching-downloaded-executable-content)\nlaunching downloaded content.\nEmploy an [Endpoint Detection and Response (EDR) product to help detect, isolate,](https://www.esentire.com/how-we-do-it/signals/endpoint)\nand remediate cyber threats impacting your company’s endpoint devices.\n\n## Indicators of Compromise\n\n|Indicator|Note|\n|---|---|\n|23d3d8cd3a5b8e4703a9b91970d790d1|zieu.ps1 (Cobalt Strike payload)|\n|785fcb9380b4c2310c2200790641bc73|s5.ps1 (PowerShell SOCKS proxy)|\n|cadb91ac90f52e27c0acae43b79aa202|son.ps1 (PowerShell SOCKS proxy)|\n|bbbfab2763b717178141f0561584d087|contract salary calculator ontario 34123.js|\n|hxxps[://]skymedia360[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]filorga[.]com/xmlrpc[.]php|Contacted domain|\n|hxxp[://]breadoflifetabernacle[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]lyngsfjord[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]galonivan[.]com[.]br/xmlrpc[.]php|Contacted domain|\n|hxxps[://]assistironline[.]net/xmlrpc[.]php|Contacted domain|\n|hxxps[://]dexacoin[.]net/xmlrpc[.]php|Contacted domain|\n|hxxps[://]thetripgoeson[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]hcss[.]nl/xmlrpc[.]php|Contacted domain|\n|hxxp[://]beechdesigngroup[.]com/xmlrpc[.]php|Contacted domain|\n\n\n-----\n\n|hxxp[://]dentalofficeathens[.]gr/xmlrpc[.]php|Contacted domain|\n|---|---|\n|hxxp[://]aracelicolin[.]org[.]mx/xmlrpc[.]php|Contacted domain|\n|hxxps[://]shareddata[.]org/xmlrpc[.]php|Contacted domain|\n|hxxps[://]dunkandjump[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]nickthomm[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]1worldsync[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]hozoboz[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]burmancoffee[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]tonyevers[.]com/xmlrpc[.]php|Contacted domain|\n|hxxps[://]serialowy[.]pl/xmlrpc[.]php|Contacted domain|\n\n\neSentire’s Threat Response Unit (TRU) is a world-class team of threat researchers who\ndevelop new detections enriched by original threat intelligence and leverage new machine\nlearning models that correlate multi-signal data and automate rapid response to advanced\nthreats.\n\nIf you are not currently engaged with an MDR provider, eSentire MDR can help you reclaim\nthe advantage and put your business ahead of disruption.\n\nLearn what it means to have an elite team of Threat Hunters and Researchers that works for\nyou. [Connect with an eSentire Security Specialist.](https://www.esentire.com/get-started)\n\n[View Most Recent Blogs](https://www.esentire.com/resources/blog)\n\n\n-----\n\neSentire Threat Response Unit (TRU)\n\nOur industry-renowned Threat Response Unit (TRU) is an elite team of threat hunters and\nresearchers, that supports our 24/7 Security Operations Centers (SOCs), builds detection\nmodels across our Atlas XDR Cloud Platform, and works as an extension of your security\nteam to continuously improve our Managed Detection and Response service. TRU has been\nrecognized for its threat hunting, original research and content development capabilities.\nTRU is strategically organized into cross-functional groups to protect you against advanced\nand emerging threats, allowing your organization to gain leading threat intelligence and\nincredible cybersecurity acumen.\n\n\n-----\n\nCookies allow us to deliver the best possible experience for you on our website - by\ncontinuing to use our website or by closing this box, you are consenting to our use of\n[cookies. Visit our Privacy Policy to learn more.](https://www.esentire.com/legal/privacy-policy)\n\nAccept\n\n**The Authority in Managed Detection and Response.**\n\n2023 eSentire, Inc. All Rights Reserved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-01-12 - Gootloader Malware Leads to Cobalt Strike and Hand-on-Keyboard Activity.pdf"
    ],
    "report_names": [
        "2023-01-12 - Gootloader Malware Leads to Cobalt Strike and Hand-on-Keyboard Activity.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1675303697,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1675237710,
    "ts_modification_date": 1675237710,
    "files": {
        "pdf": "https://archive.orkl.eu/5568b1fecd2dcb7a4e2bcebd915d3300ffe9f38f.pdf",
        "text": "https://archive.orkl.eu/5568b1fecd2dcb7a4e2bcebd915d3300ffe9f38f.txt",
        "img": "https://archive.orkl.eu/5568b1fecd2dcb7a4e2bcebd915d3300ffe9f38f.jpg"
    }
}