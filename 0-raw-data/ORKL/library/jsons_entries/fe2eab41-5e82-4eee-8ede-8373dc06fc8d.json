{
    "id": "fe2eab41-5e82-4eee-8ede-8373dc06fc8d",
    "created_at": "2023-01-12T15:07:38.717755Z",
    "updated_at": "2025-03-27T02:12:37.921313Z",
    "deleted_at": null,
    "sha1_hash": "f1c6d01a3f24b249a9a01b53f751a2b729aadd4c",
    "title": "2019-02-28 - Technical Analysis- Pacha Group Deploying Undetected Cryptojacking Campaigns on Linux Servers",
    "authors": "",
    "file_creation_date": "2022-05-28T19:04:37Z",
    "file_modification_date": "2022-05-28T19:04:37Z",
    "file_size": 8349608,
    "plain_text": "# Technical Analysis: Pacha Group Deploying Undetected Cryptojacking Campaigns on Linux Servers\n\n**intezer.com/blog-technical-analysis-pacha-group/**\n\nFebruary 28, 2019\n\nWritten by Ignacio Sanmillan - 28 February 2019\n\n## Get Free Account\n\nJoin Now\n\n**Introduction**\n\nCryptomining malware, also known as cryptojacking or cryptocurrency mining malware,\nrefers to software developed to take over a computer’s resources and use them\n[forcryptocurrency mining without a user’s explicit permission.](https://www.webopedia.com/TERM/C/cryptocurrency-mining.html)\n\n[There are several reports documenting this newer malware breed and how it has become](https://www.symantec.com/blogs/threat-intelligence/cryptojacking-modern-cash-cow)\nmore popular in the last few years.\n\n[Antd is a miner found in the wild on September 18, 2018. Recently we discovered that the](https://translate.google.com/translate?hl=en&sl=auto&tl=en&u=https%3A%2F%2Fwww.acey.me%2Fantd-miner%2F)\nauthors from Antd are actively delivering newer campaigns deploying a broad number of\ncomponents, most of them completely undetected and operating within compromised third\n\n\n-----\n\nparty Linux servers. Furthermore, we have observed that some of the techniques\nimplemented by this group are unconventional, and there is an element of sophistication to\nthem. We believe the authors behind this malware are from Chinese origin. We have\nlabeled the undetected Linux.Antd variants, Linux.GreedyAntdand classified the threat\nactor as Pacha Group.\n\n_String Reuse from Antd and GreedyAntd_\n\n**Technical Analysis**\n\n**Infrastructure Overview:**\n\nBased on our findings Linux.GreedyAntd’s operations closely resemble previous\ncryptojacking campaigns deployed by Pacha Group in the past. A resumed overview of the\ncurrent infrastructure is as follows:\n\n\n-----\n\nThe attack chain commences by intruding into a given vulnerable server. Based on the\nservices the compromised servers were publicly exposing, we can assume the attackers\nopted to launch a brute-force attack against services like WordPress or PhpMyAdmin, or\nused a known exploit for an outdated version of alike services. The following is an overview\nof the open services and known vulnerabilities found in one of the compromised systems:\n\n\n-----\n\nOnce the attackers are able to break into a given compromised server, they will run a series\nof stages in their attack chain.\n\n**Main Dropper:**\n\nOnce a system is compromised the first implant that will be executed is a UPX packed\nstatically linked stripped ELF.\n\nThis ELF binary is the main component in the intrusion stage and it is worth dedicating a\nseparate section to. We will refer to this binary as the ‘first stage’ or ‘main dropper’\nthroughout the blog.\n\nThis binary is responsible for various tasks. One of the first actions it will take is to assure\nthat the current compromised server is not infected by other cryptominers by using a\ntechnique similar to that of a ‘bot kill’ approach (as known in the DDoS scene) killing any\nother cryptominer that is currently running in the system. The following list contains the file\nnames belonging to known foreign cryptominers:\n\n\n-----\n\nWe recognized that one of the file names in this list is the Korkerds miner reported by\n[TrendMicro as well as other known miners such as DDG or](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/cryptocurrency-mining-malware-targets-linux-systems-uses-rootkit-for-stealth) [XMRig. This reinforces the](https://github.com/xmrig/xmrig)\nassumption that the list is indeed a blacklist of file names of known miners operating in the\nwild.\n\nProcesses with a filepath residing in ‘/tmp/’, ‘/usr/tmp’ or ‘/dev/shm’ will be killed. We\nconcluded that the purpose of this aggressive behavior is intended to discover further miner\nprocesses or malware that were not covered in the initial miner process blacklist.\n\n\n-----\n\nWe have also noticed that some implants were checking for potential JBOSS compromised\nservers by attempting to access specific paths in order to detect and restrict potential\noperational webshells or dropped binaries by removing all available file permissions to\n\n\n-----\n\n[them. There is a github project called JexBoss regarding JBOSS serialization vulnerabilities](https://github.com/joaomatosf/jexboss)\nthat uses these same paths, suggesting that authors behind other cryptomining campaigns\ncould be using it to spread their infrastructures, answering why these paths are being\nsearched for:\n\nAs previously mentioned, evaluation of the current system in order to know if it is already\ncompromised has been accomplished. Furthermore, there may be a chance that the current\nsystem is already compromised by the same group. In order to figure out whether this is the\ncase all process names are checked again with the end goal of recognizing any familiar\nprocess names used by the same group and if found, the process will terminate. This could\npotentially work as a possible vaccine to be used by some miner-protection solutions\nagainst this specific miner:\n\n\n-----\n\nAfter the first stage has completed an initial reconnaissance for the running processes, it\nproceeds to create a random string to rename itself. It also overwrites some known memory\nlocations where the original process name resides and overwrites them with a fake process\nname (in this case ‘[kworker/1:7]’). An example of such memory locations is argv[0]:\n\n\n-----\n\nFurthermore it will fork itself and detach from its parent to become an independent process\nrunning on a different session as a means to create a fresh new process:\n\n\n-----\n\nLastly, the current session username is checked and the control flow will diverge\naccordingly:\n\n\n-----\n\nAs demonstrated in the previous screenshot, the main difference is that if the file was\nexecuted as root, persistence mechanisms would be enforced.\n\n**Persistence Mechanisms:**\n\nThe applied persistence mechanisms consist mainly of a given dropped implant saved as\n‘mand’ followed by installing a Systemd service which will grant its persistence in the\nsystem. In addition, the timestamp of the dropped implants will be replaced as for the one of\n‘/usr/bin/find’ as a means to make the dropped file unnoticed in the filesystem.\n\n\n-----\n\nA Systemd unit file will be decoded and dropped as ‘systemd-mandb.service’ masquerading\nthe genuine mandb service. The following is the decoded Systemd unit file:\n\n\n-----\n\nIt is important to highlight that this persistence measure will make the intrusion harder to\nspot for the untrained eye since it is not the average cron-job that most Linux malware tend\nto use. Furthermore we spotted other components of this campaign dropping and installing\ninitrd scripts as well as the following one:\n\nAfter persistence measures have been enforced, several components will be downloaded to\nthe current compromised system to remain with the attack chain:\n\n\n-----\n\n**Multi-Stage Architecture:**\n\nThe following diagram is a simplified version of the various components that make up the\nmalware’s main infrastructure:\n\n\n-----\n\nWe can assume that the main reason for having such a broad infrastructure involving a\nlarge number of components is to make it more resilient to server shutdowns as well as to\nprovide a factor of modularity. Furthermore, having this amount of components\ninterconnected with each other also implies to invest a much greater effort in order to clean\na given compromised system.\n\nThese components will run according to a small protocol involving the main dropper and all\nremaining components executed via a shared named pipe. This execution protocol is the\nfollowing:\n\nThe majority of the secondary stagers create (or just open if it already exists) a named pipe\non execution with write permissions in which they write their pid to:\n\n\n-----\n\nOn the other hand, the main dropper serializes each stager by reading and logging the\ncontents of the named pipe therefore retrieving each stager’s pid. This way the main\ndropper acts as a manager for each active stager in the system:\n\n\n-----\n\nThe first stage’s main threat will continue execution attempting to update the available\nstagers by downloading them in intervals on an infinite loop:\n\n\n-----\n\nIn addition, a timed routine will be executed by triggering a SIGALRM signal also in\nintervals, handling this signal via sigaction sycall, and therefore pivoting control of execution\nto its correspondent signal handler intermittently. This same technique has been spotted in\nvarious components of this malware’s infrastructure:\n\n\n-----\n\nThis installed signal handler is mainly used to drop further artifacts using embedded oneliner python scripts such as the following:\n\nThis script will drop further stages as well as further scripts. The following is an example of\nsuch scripts:\n\n**GreedyAntD Miner Client**\n\nThe deployed miner instance is a XMRig variant. We can confirm this via code reuse:\n\n\n-----\n\nWe can also confirm the miner shares code with other components from the same\ninfrastructure, also based on code reuse:\n\nIt uses the [Stratum mining protocol and connects to a XMRig proxy in order to conduct the](https://en.bitcoin.it/wiki/Stratum_mining_protocol)\nmining operation. We assume the reason to use this specific protocol is to prevent to deploy\nits clients with encoded configurations containing the target wallet address they will be\nmining to, instead they connect to already configured proxies:\n\n\n-----\n\nThe following are the Proxies that interacts with:\n\n\n-----\n\nFurthermore, we can also confirm it is using Stratum by sniffing the Miner’s stream to these\nproxies:\n\nWe notice that the client and server are exchanging information encoded as json-rpc\nstrings, which is commonly used in stratum mining protocol.\n\nHighlighted are the different cryptocurrency mining algorithms that the client supports.\n[These names can be seen in the main XMRig-proxy GitHub repository:](https://github.com/xmrig/xmrig-proxy/blob/master/doc/STRATUM_EXT.md#extended-mining-statistics)\n\n\n-----\n\nThe following screenshot is a process list view on htop of a compromised system.\nHighlighted are some of the malicious processes related to the campaign:\n\n**Connections with Linux.HelloBot**\n\n\n-----\n\nAmong the artifacts hosted in GreedyAntd s servers, we managed to find a single\ncomponent not related to the same cryptojacking operation just previously discussed and\nleveraged by Pacha Group. This file was hosted on a compromised third party server and\nits main purpose was to drop a xmr-stak json configuration. This json file was the following:\n\nWhen we analyzed this binary for code reuse connections we found it shared a significant\namount of code with Linux.HelloBot, a Chinese bot discovered by Intezer along with\nMalwareMustDie in January 2019:\n\nAfter analyzing the code connections we came to the realization that both samples were\nsharing the same instance of some static libc implementation:\n\n\n-----\n\nLibrary similarities tend to not be as relevant in some specific scenarios in regards to\nfinding connections between threat actors. However, in this case these library similarities\nseem to be relevant enough to consider a potential link between these two threat actors.\nEspecially since from viewing all different x86 libc versions in our database, it only matched\nwith Linux.HelloBot’s statically linked libc. In addition, this libc instance has identical code in\nboth samples which implies it was compiled with the same compilation flags. This reinforces\nthat the particular libc instance may be a potential link to connect these binaries with a\nsingle author, also taking into account that both of them have indicators that suggest they\nhave Chinese origin.\n\n**Conclusion**\n\nThis cryptominer use case is another example of an undetected Linux malware operating in\nthe wild. After conducting more research we concluded that the approach of interconnecting\nall second-stagers to a manager (this being the main dropper) via IPCs is successful for\nanti-dynamic analysis. In order for any of the secondary-stages to run successfully they will\nneed to be present with the main dropper in a given system. This implies that behavior and\n\n\n-----\n\ndynamic analysis will fail if any of the second-stager components are analyzed\nindependently without tampering the original sample. This may explain why the majority of\nthe components in this malware’s infrastructure remain practically undetected:\n\n**IOCs:**\n\n185.165.169.6\n\n185.10.68.100\n\n4d1a6151166048ea066c6b5918fbb02a43ed357e3e7eb75bc73970a97008337e\n\n**chn**\n\n206287e22445431ccab0a574f3002e28d1aaffa5153ba66f2a754d1f92b90a78\n\n**chn.unpacked**\n\n9119d47ee2b6e7bf94245699fec1432042e30255d9f64289f8e0aca56570eab3\n\n**ofd**\n\n096f8f387200fa70dddb2bfe5a77a50c88acb155d4f296f1fa6cb09109053246\n\n**ofd.unpacked**\n\nee0ab03909ca433deb9161e831512c5bd6c64ffbc9332c3eea14b85b996ba882\n\n\n-----\n\n**rlr**\n1161fbe0a9ae1c5e0792d23682b602990af31c6847865220cf4f2f91981d426c\n**rlr.unpacked**\n3c3379284417070983da222f8ea347a4166c28a2ba3445e19f92b10b9b539573\n**_j.jpg**\n9ff1bf60e35912141c74728738c3af105d06ea8fa9c0cbd7a4b196ec1cdc9e22\n**j.jpg**\ndafac060867643d27a81e99e3753d155658e5f4a7f359317e0e8609fc7d14373\n**jm**\n069a87fbd966df854f55d82fc98f89ef394cee59b352fba5fb402887892a4161\n**jm.unpacked**\n84165c21fc144894c5fe674cfd06edafd4b95d52abf86afef4d61db91099bf8a\n**jpp**\n544e71e3a7ff1f1f0e902cef00156aa157790f7c3450870ca9272936443e05af\n**jpp.unpacked**\na9656439d1ac3881c1ba9e0f2fd462b8a4469bf79035233517eae65ed6afafd0\n**jrd**\ne43d381c43749d7d267d207273ef3b634bfaeb0ff76f8e2cd6e0b27c6e3b07c8\n**jrd.unpacked**\n3c3379284417070983da222f8ea347a4166c28a2ba3445e19f92b10b9b539573\n**_j.sh**\nb6455e0335ad99028656b5b847fd5d530bc079b2524b2ecbf4f06d5e69473e7d\n**lmmml**\n39904faf4a620aa3a9e9ece3022f0bced20ef7684e0f352f99267e7c462d227c\n**lmmml.unpck**\n910fea37c73fc328522e04c77d1ad555c990f0376960770698bd3590c5b1b485\n**nvn**\n81b8860ecf21a73de8663188962fb1dae5a5c17e7b6f4ac41e0198d12497838f\n**nvn.unpacked**\n371f52a238d4be6eb8d7fd0130684f4286681f09adb61fbca3bdfacef8c747f7\n**sds**\nb72074b6c75b4fe5ea74e2db716f488a356d9d879c6d3aa5e9ed4bb786993761\n**sds.unpacked**\n42a423b6107f2186964ac9a1e7882a50f6b5cb9f96926dd2a69b1fc5eaba81d6\n**lmmml.1**\ne9a06f7183f7e06d8e414e16caae769a3859fcca20acae735f6744712f84b3e5\n**sss**\n4f9e77b4e0d80ea74ba861ab54b7360df7b823f24fd9cedb1fd44a29da70b11f\n**sss.unpacked**\n0940472a185099df2f814bcedbc1c913a7075168ab90d63249c6301849c1d93f\n**dld**\n6ff5e36d2999f8593cc4daa5e7c633abe0f28b0cba9da0339fc8d3cb7f6090a3\n\n\n-----\n\n**dld.unpacked**\nc70423e5d44cc31df70a69d65e56be1621956bccec2a3a68a69195ecccd4e881\n**_jj.jpg**\n452ed9cf53aed0afdc7900ca855f652a7c1585c2b03b27e6f3224fb6204da25a\n**_jj.sh**\n6f3add7ec36a710973d09b814082e105b848cd78f2769ba6bbc946f59f463457\n**ldl**\n045d7afaf53692607e7433a4fe8f19b2e3790414c649c8630086039d88935a02\n**ldl.unpacked**\n0940472a185099df2f814bcedbc1c913a7075168ab90d63249c6301849c1d93f\n**olo**\n6ff5e36d2999f8593cc4daa5e7c633abe0f28b0cba9da0339fc8d3cb7f6090a3\n**olo.unpacked**\n7ae8c6c65955fb9340b07afd380bbf3383b5030a92ba204cd61ca21c13a955e8\n**_z.jpg**\n9e049a51741f22403a9c08d3d7625ad4761cbfda5a8a051f6e8195e0f6a8e9cd\n**z.jpg**\n7ae8c6c65955fb9340b07afd380bbf3383b5030a92ba204cd61ca21c13a955e8\n**_z.sh**\n9e049a51741f22403a9c08d3d7625ad4761cbfda5a8a051f6e8195e0f6a8e9cd\n**z.sh**\nCceddd7e9a7ddb4991776239cb0b941d061ac21db00b1021a8c45660f52e56b7\nE2e07782dbfddeb95661c7360db5113c9b035cfb8e43e038106bd0f537553b36\n40d8d89aa19ca4121ab583758692752964402923917da766f39a32cbc8bdd6dd\n\n**Ignacio Sanmillan**\nNacho is a security researcher specializing in reverse engineering and malware analysis.\nNacho plays a key role in Intezer\\'s malware hunting and investigation operations, analyzing\nand documenting new undetected threats. Some of his latest research involves detecting\nnew Linux malware and finding links between different threat actors. Nacho is an adept ELF\nresearcher, having written numerous papers and conducting projects implementing state-ofthe-art obfuscation and anti-analysis techniques in the ELF file format.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-28 - Technical Analysis- Pacha Group Deploying Undetected Cryptojacking Campaigns on Linux Servers.pdf"
    ],
    "report_names": [
        "2019-02-28 - Technical Analysis- Pacha Group Deploying Undetected Cryptojacking Campaigns on Linux Servers.pdf"
    ],
    "threat_actors": [
        {
            "id": "484c5fed-029e-4504-b75a-bbdbc9460595",
            "created_at": "2022-10-25T16:07:24.529893Z",
            "updated_at": "2025-03-27T02:02:10.273182Z",
            "deleted_at": null,
            "main_name": "Pacha Group",
            "aliases": [],
            "source_name": "ETDA:Pacha Group",
            "tools": [
                "Antd",
                "DDG",
                "GreedyAntd",
                "Korkerds",
                "XMRig"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "18bcbaa6-8e7b-43c4-9db7-8b0b315ee5a3",
            "created_at": "2023-01-06T13:46:39.024086Z",
            "updated_at": "2025-03-27T02:00:02.980081Z",
            "deleted_at": null,
            "main_name": "Pacha Group",
            "aliases": [],
            "source_name": "MISPGALAXY:Pacha Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536058,
    "ts_updated_at": 1743041557,
    "ts_creation_date": 1653764677,
    "ts_modification_date": 1653764677,
    "files": {
        "pdf": "https://archive.orkl.eu/f1c6d01a3f24b249a9a01b53f751a2b729aadd4c.pdf",
        "text": "https://archive.orkl.eu/f1c6d01a3f24b249a9a01b53f751a2b729aadd4c.txt",
        "img": "https://archive.orkl.eu/f1c6d01a3f24b249a9a01b53f751a2b729aadd4c.jpg"
    }
}