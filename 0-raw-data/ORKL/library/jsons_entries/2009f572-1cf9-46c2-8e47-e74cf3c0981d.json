{
    "id": "2009f572-1cf9-46c2-8e47-e74cf3c0981d",
    "created_at": "2023-01-12T15:01:21.565017Z",
    "updated_at": "2025-03-27T02:16:01.118861Z",
    "deleted_at": null,
    "sha1_hash": "f0c95a86c6879b3eac7b60e1d542c1da82148636",
    "title": "2021-11-15 - Fake Ransomware Infection Spooks Website Owners",
    "authors": "",
    "file_creation_date": "2022-05-28T15:42:45Z",
    "file_modification_date": "2022-05-28T15:42:45Z",
    "file_size": 320495,
    "plain_text": "# Sucuri Blog\n\n**[blog.sucuri.net/2021/11/fake-ransomware-infection-spooks-website-owners.html](https://blog.sucuri.net/2021/11/fake-ransomware-infection-spooks-website-owners.html)**\n\nBen Martin November 15, 2021\n\nStarting this past Friday we have seen a number of websites showing a fake ransomware\ninfection. Google search results for “FOR RESTORE SEND 0.1 BITCOIN” were sitting at 6\nlast week and increased to 291 at the time of writing this. Upon visiting their website\nwebmasters have been met with an alarming message:\n```\nSITE ENCRYPTED\nFOR RESTORE SEND 0.1 BITCOIN: 3BkiGYFh6QtjtNCPNNjGwszoqqCka2SDEc\n(create file on site /unlock .txt with transaction key inside)\n\n```\n\n-----\n\nThe warning indicated that the website was hit with a ransomware attack. The files were\nreported to be encrypted and the attackers demanded a ransom payment of 0.1 Bitcoin.\nWhile the price of Bitcoin is extremely volatile, at the time of writing this article that would\nclock in at a whopping $6,000+ USD\n\nNot a negligible sum of money for an average website owner, to say the least! Before\npanicking and paying the ransom (or completely re-building their website from scratch)\nthankfully some website owners hired us to take a look.\n\n## Past Cases of Website Ransomware\n\nThis would certainly not be our first time seeing websites impacted by ransomware. Typically\nransomware affects endpoint devices, sometimes entire businesses and institutions. In fact,\nas I type this the entire provincial health care system of Newfoundland has been brought to\nits knees with thousands of delayed surgeries due to a crippling suspected ransomware\n[attack.](https://www.cbc.ca/news/canada/newfoundland-labrador/health-services-it-outage-update-nov-1-1.6232426)\n\nStarting at the beginning of 2016 we saw some examples of website files themselves being\n[encrypted by attackers with a ransom being demanded, which we wrote about on our blog at](https://blog.sucuri.net/2016/01/ransomware-strikes-websites.html)\nthe time. This was pretty short lived, however. Attackers always go after the money to\nmaximise their profits. We can only presume that targeting websites wasn’t terribly profitable\nand was best for them to go after endpoints, businesses and organisations. It’s also much\nmore common for website owners to have backups handy, rendering the entire attack moot.\n\n## More than Meets the Eye\n\nThe clock was ticking on the ransom notification: Seven days, ten hours, 21 minutes and 9\nseconds to pay the ransom before the files would be encrypted and irretrievable forever.\nTick, tock, tick, tock ⏰\n\nHowever, when we began our investigation into the website it turned out that nothing was\nencrypted at all! Normally when ransomware attacks website files the extension is changed\nto .lock or something similar, and the files have been rendered as unreadable, encrypted\nrubbish. Not so in this example!\n\nSo what was causing the frightening warning?\n\n\n-----\n\n## Fake Ransomware Warning Generated by Plugin\n\nThe solution to the source was actually quite simple: All we had to do was to query the file\nstructure for the BitCoin account number. That led us to the following file:\n```\n./wp-content/plugins/directorist/directorist-base.php\n\n```\nSure enough, the ransom warning was completely bogus. Nothing was encrypted at all! It\nwas a simple HTML page generated by this bogus plugin and nothing more. Let’s take a look\nat this code and see what exactly it was doing.\n\nNear the end of that file we can see that the malicious bit is just using some very basic HTML\nto generate the ransom message:\n\n_FOR RESTORE SEND 0.1 BITCOIN: 3BkiGYFh6QtjtNCPNNjGwszoqqCka2SDEc_\n\nAs well as some basic PHP to generate the countdown clock:\n\n\n-----\n\n_All cases so far have defaulted to November 20th, 2021_\n\nThe desired date can be edited here to instill more panic into the request. Remember folks,\nrule number one about online scams like phishing is instilling a sense of urgency to the\nvictim!\n\n## Removing the Infection\n\nGetting this infection cleared up is easy enough, all we had to do was remove the plugin from\nthe wp-content/plugins directory. However, once we got the main website page back all of\ntheir pages and posts were leading to 404 Not Found responses.\n\nThe reason for this is the last snippet of the malicious plugin:\n\n\n-----\n\nHere we see a basic SQL command which finds any posts and pages with the **publish**\nstatus and changes them to “null“. All the content was still in the database, just unable to be\nviewed! This can be reversed with an equally simple SQL command:\n```\nUPDATE `wp_posts` SET `post_status` = 'publish' WHERE `post_status` = 'null';\n\n```\nThis will publish any content in the database marked as null. If you have other content\nmarked as such, it will re-publish that, but that is certainly better than losing all your website\nposts and pages.\n\nWe also see the plugin including the following file:\n```\n./wp-content/plugins/directorist/azz_encrypt.php\n\n```\nHowever, so far we haven’t seen this file present in any of the infections. It’s possible that in\nother cases of this infection this file could contain functionality to encrypt the files, but so far\nwe haven’t found a candidate with it present.\n\n## Determining the Source\n\nIn checking the access logs for the website it was easy enough to determine the IP address\nresponsible. Our client was located in the southern United States, however we saw quite a\nfew requests from a foreign IP address which was interacting with the directorist plugin using\nthe plugin editor feature of wp-admin. This suggests that the legitimate plugin was already\ninstalled on the website and later tampered with by the attackers.\n\nInterestingly, the very first request that we saw from the attacker IP address was from the\nwp-admin panel, suggesting that they had already established administrator access to the\nwebsite before they began their shenanigans. Whether they had brute forced the admin\npassword using another IP address or had acquired the already-compromised login from the\nblack market is anybody’s guess.\n\n## How to Protect your Site\n\nOnce the plugin is removed and the nulled content in the database restored then tying up the\nloose ends is pretty straightforward!\n\nReview admin users on the site, remove any bogus accounts and update/change all\nwp-admin passwords\nSecure your wp-admin administrator page\nChange other access point passwords (database, FTP, cPanel, etc)\n[Ideally, place your website behind a firewall](https://sucuri.net/website-firewall/)\n[Don’t forget about reliable backups! Even if hackers manage to encrypt your whole site,](https://sucuri.net/website-backups/)\nit will be easy to restore it from the latest backup.\n\n\n-----\n\n[We recently published a detailed article on many of the different options that WordPress](https://blog.sucuri.net/2021/07/basic-wordpress-hardening.html)\nwebsite owners have at their disposal to secure their admin page. Be sure to give it a read to\nmake sure your website isn’t low hanging fruit for the bad guys! In particular, the\n_disallow_file_edit function would have helped prevent this attack!_\n\nIf you are a website owner and are affected by this attack our remediation analysts can help\n[remove the infection for you!](https://sucuri.net/website-security-platform/signup/)\n\n**UPDATE: While the original point of this article was to mention this new malware infection**\nand not locate its source we mentioned it may have been a compromised admin account.\nUpon further evaluation it was due to a cross-side request forgery vulnerability in the\nDirectorist plugin which has since been patched. Thank you to Plugin Vulnerabilities for\nreading and paying close attention to our blog posts. Users of this plugin should update\nimmediately!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-15 - Fake Ransomware Infection Spooks Website Owners.pdf"
    ],
    "report_names": [
        "2021-11-15 - Fake Ransomware Infection Spooks Website Owners.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3fad11c6-4336-4b28-a606-f510eca5452e",
            "created_at": "2022-10-25T16:07:24.346573Z",
            "updated_at": "2025-03-27T02:02:10.183211Z",
            "deleted_at": null,
            "main_name": "Turbine Panda",
            "aliases": [
                "APT 26",
                "Black Vine",
                "Bronze Express",
                "Group 13",
                "JerseyMikes",
                "KungFu Kittens",
                "PinkPanther",
                "Shell Crew",
                "Turbine Panda",
                "WebMasters"
            ],
            "source_name": "ETDA:Turbine Panda",
            "tools": [
                "Agent.dhwf",
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Hurix",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mivast",
                "PlugX",
                "RbDoor",
                "RedDelta",
                "RibDoor",
                "Sakula",
                "Sakula RAT",
                "Sakurel",
                "Sogu",
                "StreamEx",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Winnti",
                "Xamtrav",
                "cobeacon",
                "ffrat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535681,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1653752565,
    "ts_modification_date": 1653752565,
    "files": {
        "pdf": "https://archive.orkl.eu/f0c95a86c6879b3eac7b60e1d542c1da82148636.pdf",
        "text": "https://archive.orkl.eu/f0c95a86c6879b3eac7b60e1d542c1da82148636.txt",
        "img": "https://archive.orkl.eu/f0c95a86c6879b3eac7b60e1d542c1da82148636.jpg"
    }
}