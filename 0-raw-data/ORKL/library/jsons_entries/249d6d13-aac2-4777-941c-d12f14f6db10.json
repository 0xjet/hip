{
    "id": "249d6d13-aac2-4777-941c-d12f14f6db10",
    "created_at": "2023-01-12T15:08:29.542365Z",
    "updated_at": "2025-03-27T02:06:05.372085Z",
    "deleted_at": null,
    "sha1_hash": "74788bdfb664acd8e33f407263d37f7731f5ab6f",
    "title": "2019-09-26 - Masad Stealer- Exfiltrating using Telegram",
    "authors": "",
    "file_creation_date": "2022-05-28T03:54:36Z",
    "file_modification_date": "2022-05-28T03:54:36Z",
    "file_size": 1055173,
    "plain_text": "# Masad Stealer: Exfiltrating using Telegram\n\n**[blogs.juniper.net/en-us/threat-research/masad-stealer-exfiltrating-using-telegram](https://blogs.juniper.net/en-us/threat-research/masad-stealer-exfiltrating-using-telegram)**\n\nSeptember 26, 2019\n\nJuniper Threat Labs discovered a new Trojan-delivered spyware that uses Telegram to exfiltrate stolen information. Using\nTelegram as a Command and Control (C&C) channel allows the malware some anonymity, as Telegram is a legitimate\nmessaging application with 200 million monthly active users.\n\nThe malware is being advertised on black market forums as “Masad Clipper and Stealer.” It steals browser data, which might\ncontain usernames, passwords and credit card information. Masad Stealer also automatically replaces cryptocurrency\nwallets from the clipboard with its own.\n\nMasad Stealer sends all of the information it collects – and receive commands from – a Telegram bot controlled by the threat\nactor deploying that instance of Masad. Because Masad is being sold as off-the-shelf malware, it will be deployed by\nmultiple threat actors who may or may not be the original malware writers.\n\n**What it does**\n\nThis malware is written using Autoit scripts and then compiled into a Windows executable. Most samples we have seen are\nabout 1.5 MiB in size, however, Masad Stealer can be found in larger executables as it is sometimes bundled into other\nsoftware.\n\nWhen Masad Stealer is executed, it drops itself in %APPDATA%\\folder_name}\\{file_name}, where folder_name and\nfile_name are defined in the binary. Examples include amd64_usbhub3.inf.resources and ws2_32.exe, respectively. As a\npersistence mechanism, mMasad Stealer creates a scheduled task that will start itself every one minute.\n\n_Masad stealer using scheduled task as persistence mechanism_\n\n**Stealing routine**\n\nAfter installing itself, Masad Stealer starts by collecting sensitive information from the system, such as:\n\nCryptocurrency Wallets\nPC and system information\nCredit Card Browser Data\nBrowser passwords\nInstalled software and processes\nDesktop Files\nScreenshot of Desktop\nBrowser cookies\n\n\n-----\n\nSteam files\nAutoFill browser fields\nDiscord and Telegram data\nFileZilla files\n\nIt zips this information into a file using 7zip utility, which is bundled into the malware binary.\n\n_A screenshot of what this malware have exfiltrated on one test machine_\n\nThe above screenshot is a view of what Masad Stealer tries to exfiltrate from a sandbox. But the data that it can exfiltrate\ncan expand to the following list:\n\n_A list of information that this malware can steal_\n\nUsing a hardcoded bot token, which is basically a way to communicate with the Command and Control bot, Masad Stealer\nsends this zip file using the sendDocument API.\n\n\n-----\n\n_A snip of sendDocument telegram bot API that this malware used to exfiltrate data_\n\nIn order to communicate with the Command and Control bot, Masad Stealer first sends a getMe message using the bot\ntoken to be able to confirm that the bot is still active. Upon receiving this request, the bot replies with the user object that\ncontains the username of the bot. This username object is useful for identifying possible threat actors related to this\nmalware. This is an important consideration because of the off-the-shelf nature of this malware – multiple parties will be\noperating Masad Stealer instances for different purposes.\n\n_Initial request by the malware to the telegram bot to make sure it is active._\n\nWhere the bot’s token is “719604859:AAE3Pg_oJ8cPgTxKzDtysU-3Zpj6hsBxNqI”.\n**Clipping Routine**\nThis malware includes a function that replaces wallets on the clipboard, as soon as it matches a particular configuration.\nBelow are the regular expressions and supported wallets that it matches against the clipboard data:\n\n\n-----\n\n_A list of wallet and corresponding regular expressions that it monitors on the clipboard_\n\nBelow is a list of coins/wallet it tries to clip:\n\nMonero Bitcoin Cash Litecoin Neo Web Money\n\nADA ZCASH DogeCoin Stratis QIWI Pay\n\nBicond Waves Reddcoin Qtum Payeer\n\nBytecoin Bitcoin Black Coin VIA\n\nSteam Trade Link Bitcoin Gold Emercoin Lisk\n\nEthereum Dash Ripple Yandex Money\n\nIf the clipboard data matches one of the patterns coded into Masad Stealer, the malware replaces the clipboard data with\none of the threat actors’ wallets, which are also found in its binary. Below are the bitcoin and monero wallets found in one of\nthe samples:\n\n**Bitcoin: 1AtwyYF2TGR969cyRDrR2XFDqSPzwCXKfe**\n\n**Monero:**\n42Mm9gjuUSmPNr7aF1ZbQC6dcTeSi1MgB1Tv41frv1ZRFWLn4wNoLH3LDAGn9Fg2dhJW2VRHTz8Fo9ZAit951D2pDY8ggCR\n\nBelow is a snapshot of the bitcoin wallet transaction, as of this writing. This wallet has already received around $9,000 USD\nequivalent of bitcoins (as of Sept 15 2019) which may or may not come from the activity of this malware\n\n\n-----\n\n_A sample fraudulent bitcoin wallet found on one of the sample_\n\n**Attack Vector**\n\nBased on our telemetry, Masad Stealer’s main distribution vectors are masquerading as a legitimate tool or bundling\nthemselves into third party tools. Threat actors achieve end user downloads by advertising in forums, on third party\ndownload sites or on file sharing sites. Below are the currently known list of software that Masad Stealer has been seen\nmimicking:\n\n[ProxySwitcher (legitimate version here: https://www.proxyswitcher.com/)](https://www.proxyswitcher.com/)\n[CCleaner.exe (legitimate version here: https://ccleaner.com/)](https://ccleaner.com/)\nUtilman.exe (legitimate version comes with Windows)\nNetsh.exe (legitimate version comes with Windows)\n[Iobit v 1.7.exe (legitimate version here:https://www.iobit.com/)](https://www.iobit.com/)\nBase Creator v1.3.1 [FULL CRACK].exe (there is no legitimate version)\nEXEA HACK CRACKED (PUBG,CS GO,FORTNITE,GTA 5,DOTA).exe (there is no legitimate version)\nIcacls.exe (legitimate version comes with Windows)\nWSManHTTPConfig.exe (legitimate version comes with Windows)\nRADMIR CHEAT MONEYY.exe (there is no legitimate version)\n[Tradebot_binance.exe (legitimate version here: https://tradesanta.com/en)](https://tradesanta.com/en)\nWhoami.exe (legitimate version comes with Windows)\nProxo Bootstrapper.exe (this is actually a reasonably popular form of malware)\nFortniteaimbot 2019.exe (there is no legitimate version)\n[Galaxy Software Update.exe (https://www.samsung.com/us/support/answer/ANS00077582/)](https://www.samsung.com/us/support/answer/ANS00077582/)\n\n**Download additional malware**\nSome samples of Masad Stealer have the capability to download additional malware. We have seen samples that download\nother malware, usually a miner, from these URLs:\n\nhttps://masadsasad[.]moy.su/base.txt (miner)\nhttps://zuuse[.]000webhostapp.com/mi.exe (miner)\nhttp://37[.]230.210.84/still/Build.exe\nhttp://37[.]230.210.84/still/SoranoMiner.exe\nhttp://187[.]ip-54-36-162.eu/steal.exe\nhttp://bgtyu73[.]ru/22/Build.exe\n\n\n-----\n\n_Masad stealer downloading a miner via HTTPS and with modified header_\n\nThe figure above is a response from the request to https://masadsasad[.]moy.su/base.txt. This response contains an\nexecutable file with modified header. In addition to connecting via TLS, the modified header is an added trick by the malware\nto hide itself.\n\nTLS streams are more difficult to inspect, helping to hide them from network-based security defenses. The modified header\nhelps to hide the fact that the payload being downloaded is an executable from endpoint security products.\n\n**Threat Actors**\n\nThis malware is being advertised in several hack forums as Masad Stealer. It starts with a free version and ladders up to\nversions asking up to $85, with each tier of the malware offering different features.\n\n_Sample Masad stealer ad found in hackforums_\n\nThere is at least one dedicated website (masadproject[.]life) in existence to promote the sale of Masad Stealer. The\ndevelopers have also created a Telegram group for their potential clients, and presumably to offer tech support. At time of\nwriting, this group has more than 300 members.\n\n\n-----\n\n_Screenshot of a telegram group where one threat actor is operating_\n\nOf the more than 1,000 samples we identified to be variants of this malware, there where 338 unique Telegram Command\nand Control bot IDs. From this data, we can estimate the number of threat actors – or at least the number of different\ncampaigns being run using the Masad Stealer malware – and the size of their operations. We used the getMe API, along\nwith the bot token, to identify the usernames. Among the top bot IDs are as follows:\n\n**Telegram Bot ID** **Telegram Bot Username** **Unique Hashes**\n\nbot610711208 potterk_bot 45\n\nbot830353220 reaper228bot 24\n\nbot661438794 RanisYolo19_bot 23\n\nbot796671289 dfsklnjfmkdvehfsf454sdfbot 22\n\nbot870978042 dawdvwabot 20\n\nbot753197414 korote_bot 14\n\nbot823037532 NA/Inactive 13\n\nbot699800942 RcbBots_Bot 13\n\nbot831297312 xAmytBot 13\n\nbot883608782 bichpaket777_bot 12\n\nbot656889928 notius_bot 12\n\nbot813438470 idontknowubot 12\n\nbot911603667 Masat_bot 11\n\nbot963764792 NA/Inactive 11\n\nbot930786995 reborntodes_bot 9\n\nbot884837464 istrong_bot 9\n\nbot646596033 SkyDen_bot 9\n\nbot865594389 gnoy199519bot] 8\n\n\n-----\n\nPrevious versions of this malware (or possibly a direct ancestor) are called Qulab Stealer .\n**How does Juniper Networks protect you against this?**\nJuniper Advanced Threat Protection products JATP and Sky ATP use machine learning to be able to accurately identify\nmalware. The following images show the Sky ATP detecting multiple variations of this malware.\n\n_Juniper Sky ATP’s detection of this malware family_\n\nThe use of machine learning is critical to defending against this malware because of the number of rapid iterations it\nunderwent throughout its development. Machine learning allows Juniper Connected Security to identify Masad Stealer\nvariants as they emerge, helping to keep customers protected even before new strains have been identified.\n**Conclusion**\nJuniper Threat Labs believes that Masad Stealer represents an active and ongoing threat. Command and Control bots are\nstill alive and responding as of this writing, and the malware appears to still be available for purchase on the black market.\n\nIn order to protect your organization, make sure that you have a next generation firewall (NGFW) with Advanced Threat\nProtection. NGFWs have the ability to identify the Telegram protocol and block it, if there is no legitimate business use, while\nAdvanced Threat Protection products offer other methods to detect and counteract this malware.\n\nJuniper Sky ATP, in conjunction with our SRX firewall will block any client infected with Masad Stealer from reaching out to\nthe Command and Control bot master. It will also block the download of the Masad Stealer malware files in the first place,\noffering both remediation and prevention capabilities.\n\n**Indicators of Compromise**\n\n**Sha256**\n\ne968affb1fc7756deb0e29807a06681d09a0425990be76b31816795875469e3d\n\n4b1ccf6b823ee82e400ba25b1f532cd369d7e536475a470e2011b77ffeaf7bb3\n\nfc84d6636a34ad1a11dbaa1daec179e426bdcd9887b3d26dc06b202417c08f95\n\n\n-----\n\n9ca15f15fbae58cb97b0d48a0248461e78e34e6d530338e3e5b91f209a166267\n\n31f3a402c1662ed6adffbf2b1b65cf902d1df763698eb76d21e4e94b4c629714\n\n8d9f124ddd69c257189f1e814bb9e3731c00926fc2371e6ebe2654f3950ca02e\n\na0923d7645604faaa864a079adeb741a5d6e65507a2819b2fee4835d396077d9\n\na19b790ea12f785256510dde367d3313b5267536a58ca0c27dbdac7c693f57e1\n\nf030fb4e859ee6a97c50c973a73dced3640befe37f579cfd15367ce6a9bbede2\n\nf01db6d77ac21211992ceae4e66e1e03c1cb39d61e03645b9369f28252ca7693\n\ndfe3d0e95feaed685a784aed14d087b019ba2eb0274947a840d2bdbae4ae3674\n\nbf6083040ca51e83415f27c9412d9e3d700bd0841493b207bc96abf944ab0ca7\n\nb154151dc8ace5c57f109e6bb211a019db20c4f0127c4d13c7703f730bf49276\n\n6bf6b1bde63cee9b81902efd187fdd56ecee5853754ce0a19d5ab5c3b0242988\n\n0dcf547bd8f4074af97416d8b84ea64b2f3319064aa4bce64ad0c2e2d3957175\n\n6cff1249cc45b61ce8d28d87f8edc6616447e38168e610bed142f0b9c46ea684\n\n5b5ebe019806885bbaafe37bc10ca09549e41c240b793fd29a70690a5d80b496\n\n103d87098c9702cab7454b52869aeeb6a22919f29a7f19be7509255ce2d8c83e\n\nc73675005a09008bc91d6bc3b5ad59a630ab4670dca6ac0d926165a3ecfd8d92\n\nef623aadd50330342dc464a31b843b3d8b5767d62a62f5e515ac2b380b208fbe\n\n3ba3c528d11d1df62a969a282e9e54534fb3845962672ad6d8bbc29cb6d062f5\n\nb763054180cd4e24c0a78b49055ad36dbc849f1a096cddf2db8cee0b9338c21d\n\nd5ce4b04b7eec6530a4a9d40510177468fadc235253e5a74530a8c9d990f3c50\n\n965a5949d8f94e17ebcd4cb6d0a7c19f49facbfc1b1c74111e5ceb83550d6c8f\n\n44134b9d4b10d94f6381b446a1728b116d62e65c1a52db45235af12caf7e38c0\n\n848d76a227f4fe282b7ddfd82a6dfc4c25da2735a684462b42fe4e1c413d8e34\n\n5ca0a957fe6c253827f344da4ba8692d77a4e21a1df4251594be2d27d87dd8ae\n\n016fa511f6546ed439d2606c6db8821685a99f5a14ef3f710668b58dc89c6926\n\n22be594fbfa878f631c0632f6c4d260b00918817ff66a1f9f15efe44c1a58460\n\nf3571ec66288405dab43332ca03812617f85fb08832fbbe1f1d89901fe034b8a\n\n04c949eca23103b1de05278b49f42c3ab6b06f4bf20aafa5f2faefaa84c16ecd\n\ne968affb1fc7756deb0e29807a06681d09a0425990be76b31816795875469e3d\n\nd6fc04acda8f33a6d35eb577c27754c2f2b4d6f4869576c7c4e11b2c5e9b0176\n\n18c0bd4dd98008383fc52045ad896449fa7f0037593bb730ed1ef88aa547006d\n\n4c9d5469e9095813418260045c2b11e499e4eaa0ffb25293f90f580c464157df\n\n0b5f1fbc05dc8baca492b748adeb01fb4904e02723b59211ecde222f7b12d91e\n\n\n-----\n\n31ad5c4547ceae4d0550c8460524c16a6105afc056760e872c4966656256c9dc\n\nedb00a0e5ff70e899857549e3263c887a799416c8bbab43ab130ca1be9bbd78c\n\n96f852b81760a425befaa11ea37c0cdea2622630bf2a0c94bb95042211ab614d\n\n57fd171a5b1a88e9583b42439851a91a940eb31105ab29cb314846da2ed43b82\n\n277018b2cc6226dca6c7678cac6718c8584f7231340ad8cd7c03477559fdf48b\n\n1acf5a461ee16336eb8bbf8d29982c7e26d5e11827c58ca01adac671a28b52ad\n\n290a1b89517dec10bfd9938a0e86ae8c53b0c78ed7c60dc99e4f8e5837f4f24a\n\n7937a1068f130a90b44781eea3351ba8a2776d0fede9699ba8b32f3198de045b\n\n87e44bca3cc360c64cc7449ec1dc26b7d1708441d471bf3d36cd330db3576294\n\ncf97d52551a96dacb089ac41463d21cab2b004ba8c38ffc6cb5fb0958ddd34db\n\n79aa23c5a25c7cdbaba9c6c655c918dac3d9823ac62ebed9d7d3e94e1eaafc07\n\n03d703f6d341be258ac3d95961ff0a67d4bf792f9e896530e193b091dca29c2e\n\na368b6755e62e5c0ff79ea1e3bd146ee8a349af309b4acf0558a9c667e78293a\n\nba933cefbe9a8034f0ba34e7d18481a7db7451c8ef4b6172fb0cad6db0513a51\n\n**URLs:**\n\nhttps://masadsasad[.]moy.su/base.txt\n\nhttps://zuuse[.]000webhostapp.com/mi.exe\n\nhttp://37[.]230.210.84/still/Build.exe\n\nhttp://37[.]230.210.84/still/SoranoMiner.exe\n\nhttp://187[.]ip-54-36-162.eu/steal.exe\n\nhttp://bgtyu73[.]ru/22/Build.exe\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-26 - Masad Stealer- Exfiltrating using Telegram.pdf"
    ],
    "report_names": [
        "2019-09-26 - Masad Stealer- Exfiltrating using Telegram.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536109,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653710076,
    "ts_modification_date": 1653710076,
    "files": {
        "pdf": "https://archive.orkl.eu/74788bdfb664acd8e33f407263d37f7731f5ab6f.pdf",
        "text": "https://archive.orkl.eu/74788bdfb664acd8e33f407263d37f7731f5ab6f.txt",
        "img": "https://archive.orkl.eu/74788bdfb664acd8e33f407263d37f7731f5ab6f.jpg"
    }
}