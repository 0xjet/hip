{
    "id": "4c68fac1-f506-489d-ba30-b19bd6c75c31",
    "created_at": "2023-01-12T15:08:59.526141Z",
    "updated_at": "2025-03-27T02:09:18.415342Z",
    "deleted_at": null,
    "sha1_hash": "f6ef2434156c82c40728a6d72a2556a18c5fd204",
    "title": "2020-11-06 - Linking Vatet, PyXie and Defray777",
    "authors": "",
    "file_creation_date": "2022-05-28T23:47:36Z",
    "file_modification_date": "2022-05-28T23:47:36Z",
    "file_size": 231094,
    "plain_text": "# When Threat Actors Fly Under the Radar: Vatet, PyXie and Defray777\n\n**unit42.paloaltonetworks.com/vatet-pyxie-defray777/4**\n\nRyan Tracey, Drew Schmitt November 7, 2020\n\nBy [Ryan Tracey and](https://unit42.paloaltonetworks.com/author/ryan-tracey/) [Drew Schmitt](https://unit42.paloaltonetworks.com/author/drew-schmitt/)\n\nNovember 6, 2020 at 6:15 PM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Ransomware,](https://unit42.paloaltonetworks.com/category/ransomware/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Defray777,](https://unit42.paloaltonetworks.com/tag/defray777/) [PyXie,](https://unit42.paloaltonetworks.com/tag/pyxie/) [Vatet](https://unit42.paloaltonetworks.com/tag/vatet/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/vatet-pyxie-defray777/)\n\n## Linking Vatet, PyXie and Defray777\n\nWhile researching these malware families, we found that there were several consistencies\nbetween Vatet, PyXie and Defray777 that strongly suggest that all three malware families\nwere created, and are currently maintained by, the same financially motivated threat group.\n\n**PDB Path Reuse**\n\nAs we saw with the Defray777 decryptors, there are numerous victims that have been\nimpacted by Defray777. However, these decryptors also show some overlap with PyXie. One\nof the decryptors we analyzed shares a common path with earlier versions of PyXie and its\n\n\n-----\n\nCobalt Mode downloader.\n\nDefray777 Decryptor Z:\\coding\\pyproject\\compiled\\ransom\\ransom.pdb\n\nPyXie z:\\coding\\pyproject\\python_static_2.7.15\\\n\nCobalt Mode Z:\\coding\\pyproject\\compiled\\cobalt_mode\\cobalt_mode.pdb\n\n_Table 19. PDB paths shared between Defray777, PyXie and Cobalt Mode._\n\nAdditionally, some of the variants of Vatet we observed also have overlapping PDB paths.\n\nTetris C:\\Users\\1\\Downloads\\tetris-game-master\\Release\\TetrisGame_zjy.pdb\n\nNotepad C:\\Users\\1\\Downloads\\notepad-master\\Debug\\notepad.pdb\n\nRainmeter C:\\Users\\1\\Downloads\\rainmeter-master\\x32Release\\Obj\\Library\\Rainmeter.pdb\n\nRainmeter C:\\Users\\1\\Downloads\\rainmeter-master\\x32Release\\Obj\\Application\\Rainmeter.pdb\n\nNotepad++ C:\\Users\\1\\Downloads\\notepad-plus-plus-master\\PowerEditor\\bin\\npp.pdb\n\n_Table 20. PDB paths shared between Vatet variants._\n\n**String Encryption**\n\nDuring our research, we observed that the method of string encryption in each of the variants\nwas consistent. Defray777 uses the same string encryption that was used in PyXie.\nAdditionally, the same string encryption methodology was observed in the Tetris variant of\nVatet loader.\n\nFigure 26. Defray777 string decryption example.\n\n**Creating Mutexes**\n\n\n-----\n\nDefray777 uses the same Mutex routine as the updated PyXie sample we analyzed,\nincluding the DEFAULTCOMPNAME fallback. One thing Defray777 does differently is that it\nomits the step where the computed MD5 hash is XOR’d with 0x2.\n\nFigure 27. The Defray777 mutex creation process.\n\n## Conclusion\n\nSince 2018, a financially-motivated threat group has been using a combination of Vatet\nloader, PyXie RAT and Defray777 ransomware to target organizations in the healthcare,\neducation, government and technology industries without drawing attention to themselves.\nThey’ve only been a blip on the radar.\n\nWe have exposed this group’s desire to use open source tools as a means for the Vatet\nloader. We have shown how PyXie is used to conduct reconnaissance and find and exfiltrate\ndata. We have also uncovered how this group uses Cobalt Strike to deliver Defray777 into\nmemory to encrypt files, causing catastrophic damage to their victims.\n\nWe hope that by shining more light on this group of threat actors, we can help disrupt their\nability to conduct ransomware operations. Now that they are on the radar, we must aim to\nkeep them there.\n\nPalo Alto Networks customers are protected from this threat in the following ways:\n\n[All samples in this report have a malicious verdict in WildFire.](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\n[Cortex XDR detects these threats.](https://www.paloaltonetworks.com/cortex/endpoint-protection)\n[Command and Control infrastructure has been classified as malicious in URL Filtering.](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security)\n\n[Continue reading: Indicators of Compromise](https://unit42.paloaltonetworks.com/vatet-pyxie-defray777/5)\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-06 - Linking Vatet, PyXie and Defray777.pdf"
    ],
    "report_names": [
        "2020-11-06 - Linking Vatet, PyXie and Defray777.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536139,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653781656,
    "ts_modification_date": 1653781656,
    "files": {
        "pdf": "https://archive.orkl.eu/f6ef2434156c82c40728a6d72a2556a18c5fd204.pdf",
        "text": "https://archive.orkl.eu/f6ef2434156c82c40728a6d72a2556a18c5fd204.txt",
        "img": "https://archive.orkl.eu/f6ef2434156c82c40728a6d72a2556a18c5fd204.jpg"
    }
}