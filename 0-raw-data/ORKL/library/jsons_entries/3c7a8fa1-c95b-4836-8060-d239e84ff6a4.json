{
    "id": "3c7a8fa1-c95b-4836-8060-d239e84ff6a4",
    "created_at": "2023-01-12T15:08:37.344233Z",
    "updated_at": "2025-03-27T02:16:26.406667Z",
    "deleted_at": null,
    "sha1_hash": "d2e8c50b1888aca7a2c916e6f5a0f4d938300ac8",
    "title": "2020-07-09 - New Joker variant hits Google Play with an old trick",
    "authors": "",
    "file_creation_date": "2022-05-28T02:34:32Z",
    "file_modification_date": "2022-05-28T02:34:32Z",
    "file_size": 3756120,
    "plain_text": "# New Joker variant hits Google Play with an old trick\n\n**[research.checkpoint.com/2020/new-joker-variant-hits-google-play-with-an-old-trick/](https://research.checkpoint.com/2020/new-joker-variant-hits-google-play-with-an-old-trick/)**\n\nJuly 9, 2020\nResearch By: Aviran Hazum, Bogdan Melnykov, Israel Wernik\n\n**Overview:**\n\n\nJuly 9, 2020\n\n\n[Check Point’s researchers recently discovered a new variant of the Joker Dropper and Premium Dialer spyware in](https://threatpoint.checkpoint.com/ThreatPortal/threat?threatType=malwarefamily&threatId=7485)\nGoogle Play. Hiding in seemingly legitimate applications, we found that this updated version of Joker was able to\ndownload additional malware to the device, which subscribes the user to premium services without their\nknowledge or consent.\n\n\n-----\n\n_Figure 1 – Joker application on Google Play_\n\n**General:**\n\n\n-----\n\nJoker, one of the most prominent types of malware for Android, keeps finding its way into Google s official\napplication market as a result of small changes to its code, which enables it to get past the Play store’s security\nand vetting barriers. This time, however, the malicious actor behind Joker adopted an old technique from the\nconventional PC threat landscape and used it in the mobile app world to avoid detection by Google.\n\nTo realize the ability of subscribing app users to premium services without their knowledge or consent, the Joker\n[utilized two main components – the Notification Listener service that is part of the original application, and a](https://developer.android.com/reference/android/service/notification/NotificationListenerService)\ndynamic dex file loaded from the C&C server to perform the registration of the user to the services.\n\nIn an attempt to minimize Joker’s fingerprint, the actor behind it hid the dynamically loaded dex file from sight\nwhile still ensuring it is able to load – a technique which is well-known to developers of malware for Windows PCs.\nThis new variant now hides the malicious dex file inside the application as Base64 encoded strings, ready to be\ndecoded and loaded.\n\n**Technical Analysis:**\n\nOriginally, the code that was responsible for communicating with the C&C and downloading the dynamic dex file\nwas located inside the main classes.dex file, but now the functionality of the original classes.dex file includes\nloading the new payload.\n\nJoker triggers the malicious flow from the Activity by creating a new object that communicates with the C&C to\ncheck if the campaign was still active. After confirmation, it can then prepare the payload module to be loaded.\n\n_Figure 2 – Creation of the malicious object_\n\n\n-----\n\n_Figure 3 – malicious object communicates with C&C_\n\n_Figure 4 – response from C&C server_\n\nThe first method used to load the dex file was to read it from the manifest file. When inspecting the manifest file,\nwe could see that there was another metadata field that contained a Base64 encoded dex file. So all that was\nneeded was to read the data from the manifest file, decode the payload, and load the new dex file.\n\n_Figure 5 – Manifest file containing the Base64 encoded dex_\n\n\n-----\n\n_Figure 6 – reading data from manifest_\n\nDuring our research, we have also detected an “in-between” variant, that utilized the technique of hiding the .dex\nfile as Base64 strings – but instead of adding the strings to the Manifest file, the strings were located inside an\ninternal class of the main application. In this case, all that was needed for the malicious code to run was to read\nthe strings, decode them from Base64, and load it with reflection.\n\n_Figure 7 – Strings inside main application_\n\n_Figure 8 – Reading class strings and decode_\n\n\n-----\n\n_Figure 9 – Loading the dex file with Reflection_\n\n_Figure 10 – Decrypting strings_\n\nThe new payload contained code that the original Joker had in its main dex file – the registration of the\nNotificationListener service, subscribing the user to premium services, and more. But now, after this change, all\nthat the actor needed in order to hide the entire functionality was to set the C&C server to return “false” on the\nstatus code, and none of the malicious activity would occur.\n\n**Conclusion:**\n\nIf you suspect you may have one of these infected apps on your device, here’s what you should do:\n\nUninstall the infected application from the device\nCheck your mobile and credit-card bills to see if you have been signed up for any subscriptions and\nunsubscribe if possible\nInstall a security solution to prevent future infections\n\nProtect your enterprise and users from sophisticated mobile cyberattacks like Haken or any other ones\nwith [SandBlast Mobile. To protect personal devices against attacks, check out ZoneAlarm Mobile Security.](https://www.checkpoint.com/products/mobile-security/)\n\n**IOC’s:**\n\n**sha256** **Package Name**\n\ndb43287d1a5ed249c4376ff6eb4a5ae65c63ceade7100229555aebf4a13cebf7 com.imagecompress.android\n\nd54dd3ccfc4f0ed5fa6f3449f8ddc37a5eff2a176590e627f9be92933da32926 com.contact.withme.texts\n\n5ada05f5c6bbabb5474338084565893afa624e0115f494e1c91f48111cbe99f3 com.hmvoice.friendsms\n\n2a12084a4195239e67e783888003a6433631359498a6b08941d695c65c05ecc4 com.relax.relaxation.androidsms\n\n96f269fa0d70fdb338f0f6cabf9748f6182b44eb1342c7dca2d4de85472bf789 com.cheery.message.sendsms\n\n0d9a5dc012078ef41ae9112554cefbc4d88133f1e40a4c4d52decf41b54fc830 com.cheery.message.sendsms\n\n\n-----\n\n2dba603773fee05232a9d21cbf6690c97172496f3bde2b456d687d920b160404 com.peason.lovinglovemessage\n\n46a5fb5d44e126bc9758a57e9c80e013cac31b3b57d98eae66e898a264251f47 com.file.recovefiles\n\nf6c37577afa37d085fb68fe365e1076363821d241fe48be1a27ae5edd2a35c4d com.LPlocker.lockapps\n\n044514ed2aeb7c0f90e7a9daf60c1562dc21114f29276136036d878ce8f652ca com.remindme.alram\n\nf90acfa650db3e859a2862033ea1536e2d7a9ff5020b18b19f2b5dfd8dd323b3 com.training.memorygame\n\n**Mitre ATT&CK**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-07-09 - New Joker variant hits Google Play with an old trick.pdf"
    ],
    "report_names": [
        "2020-07-09 - New Joker variant hits Google Play with an old trick.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536117,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653705272,
    "ts_modification_date": 1653705272,
    "files": {
        "pdf": "https://archive.orkl.eu/d2e8c50b1888aca7a2c916e6f5a0f4d938300ac8.pdf",
        "text": "https://archive.orkl.eu/d2e8c50b1888aca7a2c916e6f5a0f4d938300ac8.txt",
        "img": "https://archive.orkl.eu/d2e8c50b1888aca7a2c916e6f5a0f4d938300ac8.jpg"
    }
}