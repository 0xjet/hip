{
    "id": "7adc3937-42da-4560-a76b-13140ebaa3a8",
    "created_at": "2022-10-25T16:48:20.73195Z",
    "updated_at": "2025-03-27T02:16:20.676695Z",
    "deleted_at": null,
    "sha1_hash": "7f3e46c42095721ba79b1a47e26e662eb7492057",
    "title": "Tr-25 Analysis - Turla / PNet / Snake/ Uroburos",
    "authors": "CIRCL",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 304428,
    "plain_text": "### 1 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n## Sample A\n\n### Hashes:\n\n#### Type of Hash Hash\n\n MD5 5b4a956c6ec246899b1d459838892493\n\n SHA1 217b8fa45a24681551bd84b573795b5925b2573e\n\n SHA-256 93742b415f28f57c61e7ce7d55208f71d5c4880dc66616da52f3c274b20b43b0\n\n ssdeep 24576:D0MfCZaSyUS7YXz3aHUXXeJozanHZCfBvt9MSc99rdI+6cGHe:D02saHQXeManH81t9BONdI3VHe\n\n### VirusTotal results for sample A\n\n#### AV product Result\n\n Bkav W32.Clod24a.Trojan.ceee\n\n MicroWorld-eScan Dropped:Backdoor.Generic.252173\n\n nProtect Dropped:Backdoor.Generic.252173\n\n McAfee Artemis!5B4A956C6EC2 K7AntiVirus Riskware ( 10a2c0f80 ) K7GW Trojan ( 00155adb1 ) NANO-Antivirus Trojan.Win64.Agent.lsivh F-Prot W32/MalwareS.IHA Symantec Backdoor.Pfinet Norman Suspicious_Gen3.DGZV TotalDefense Win32/Pfinet.A TrendMicro-HouseCall TROJ_GEN.R27E1AH Avast Win32:Malware-gen ClamAV Trojan.Agent-126457 Kaspersky Trojan.Win32.Genome.hitb BitDefender Dropped:Backdoor.Generic.252173 Agnitum Trojan.Meredrop!A/hBhJu+uNc Ad-Aware Dropped:Backdoor.Generic.252173 Sophos Mal/Generic-S Comodo TrojWare.Win32.Agent.czua F-Secure Dropped:Backdoor.Generic.252173 DrWeb Trojan.Siggen.27969 VIPRE Trojan.Win32.Generic!BT AntiVir TR/Agent.czua TrendMicro TROJ_GEN.R27E1AH\n McAfee-GW-Edition Artemis!5B4A956C6EC2\n Emsisoft Dropped:Backdoor.Generic.252173 (B) Microsoft Backdoor:WinNT/Pfinet.B GData Dropped:Backdoor.Generic.252173\n Commtouch W32/Risk.DWJW-7987\n VBA32 Trojan.Agent2 Baidu-International Trojan.Win32.Genome.aR ESET-NOD32 a variant of Win32/Turla.AC\n Ikarus Trojan.Win32.Genome\n Fortinet W32/Pfinet!tr AVG Generic16.BBMD\n Panda Trj/Hmir.F\n\n Scanned: 2014-03-16 01:12:54 - 49 scans - 37 detections (75.0%)\n\n\n### 2 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### File characteristics\n\n#### Meta data\n\nSize:  1052672 bytes\nType:  PE32 executable (GUI) Intel 80386, for MS Windows\nDate:  0x4AC5A74C [Fri Oct 2 07:10:04 2009 UTC]\nEP:   0x4021bb .text 0/5\nCRC:   Claimed: 0x0, Actual: 0x110f40 [SUSPICIOUS]\n\n#### Resource entries\n\nName   RVA   Size   Lang     Sublang       Type\n-------------------------------------------------------------------------------BINARY  0xd190  0x3dc00 LANG_ENGLISH SUBLANG_ENGLISH_US PE32 executable (DLL) (native) Intel 80386, for MS Windows\nBINARY  0x4ad90 0x1d000 LANG_ENGLISH SUBLANG_ENGLISH_US PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\nBINARY  0x67d90 0x21000 LANG_ENGLISH SUBLANG_ENGLISH_US PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\nBINARY  0x88d90 0x1f9  LANG_ENGLISH SUBLANG_ENGLISH_US ASCII text, with CRLF, LF line terminators\nBINARY  0x88f90 0x37c00 LANG_ENGLISH SUBLANG_ENGLISH_US PE32+ executable (DLL) (native) x86-64, for MS Windows\nBINARY  0xc0b90 0x1bc00 LANG_ENGLISH SUBLANG_ENGLISH_US PE32+ executable (DLL) (GUI) x86-64, for MS Windows\nBINARY  0xdc790 0x24200 LANG_ENGLISH SUBLANG_ENGLISH_US PE32+ executable (DLL) (GUI) x86-64, for MS Windows\n\n#### Version info\n\n No version information included.\n\n Sections\n\nName    VirtAddr   VirtSize   RawSize   Entropy\n-------------------------------------------------------------------------------.text   0x1000    0x6f34    0x7000    6.582374\n.rdata   0x8000    0x1fb8    0x2000    4.803196\n.data   0xa000    0x26f4    0x1000    1.559595\n.rsrc   0xd000    0xf3990   0xf4000   5.977919\n.reloc   0x101000   0x188c    0x2000    2.462180\n\nSECTION 1 (.text  ):\nvirtual size         : 00006F34 ( 28468.)\nvirtual address        : 00001000\nsection size         : 00007000 ( 28672.)\noffset to raw data for section: 00001000\noffset to relocation     : 00000000\noffset to line numbers    : 00000000\nnumber of relocation entries : 0\nnumber of line number entries : 0\nalignment           : 0 byte(s)\nFlags 60000020:\ntext only\nExecutable\nReadable\nSECTION 2 (.rdata ):\nvirtual size         : 00001FB8 (  8120.)\nvirtual address        : 00008000\nsection size         : 00002000 (  8192.)\noffset to raw data for section: 00008000\noffset to relocation     : 00000000\noffset to line numbers    : 00000000\nnumber of relocation entries : 0\nnumber of line number entries : 0\nalignment           : 0 byte(s)\nFlags 40000040:\ndata only\nReadable\nSECTION 3 (.data  ):\nvirtual size         : 000026F4 (  9972.)\nvirtual address        : 0000A000\nsection size         : 00001000 (  4096.)\noffset to raw data for section: 0000A000\noffset to relocation     : 00000000\noffset to line numbers    : 00000000\nnumber of relocation entries : 0\nnumber of line number entries : 0\nalignment           : 0 byte(s)\nFlags C0000040:\n\n\n### 3 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 4 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 5 f 34 12/31/2014 09 19 AM\n\n\n-----\n\nStart: 1 (SERVICE_SYSTEM_START)\nErrorControl: 0 (SERVICE_ERROR_IGNORE)\nGroup:    Streams Drivers\nDisplayName: usblink\nImagePath:  \\SystemRoot\\$NtUninstallQ722833$\\usbdev.sys\n\n#### If during installation anything goes wrong, the registry keys are deleted. The files however are not.\n\n During the installation process, extensive logging is ensuring good visibility on potential installation problems. The attacker uses english language for the logging, although he is lacking attention to detail when it comes to correct usage of the language, as the following examples demonstrate:\n\nwin32 detect... (should be simple past)\nx64 detect... (should be simple past)\nCretaFileA(%s): (should be CreateFileA)\nCan`t open SERVICES key (that shouldn't be a backtick)\n\n#### Language deficits are also demonstrated in other files of this collection. We show them in a separate chapter.\n\n A list of dropped files is given in the next chapter.\n\n## Dropped files\n\n Sample B - usbdev.sys (Resource: 101)\n\n### Hashes\n\n#### Type of Hash Hash\n\n MD5 db93128bff2912a75b39ee117796cdc6 SHA1 418645c09002845a8554095b355f47907f762797 SHA-256 57b8c2f5cfeaca97da58cfcdaf10c88dbc2c987c436ddc1ad7b7ed31879cb665\n 3072:3B9f3bhj+FqCjAsWnQNCb/XzeQdRSFqfCeEmI/2XxjptNdjxjkMAE4E:3B9tQHWLrFfCZmI ssdeep /MttB+E4\n\n### VirusTotal results for sample B\n\n#### AV product Result\n Bkav W32.Cloda11.Trojan.222a MicroWorld-eScan Backdoor.Generic.252173 nProtect Trojan/W32.Agent2.252928 McAfee Artemis!DB93128BFF29 K7GW Trojan ( 0001140e1 )\n K7AntiVirus Riskware ( 10a2c0f80 ) Agnitum Trojan.Agent2!HMPS2EOZWFE F-Prot W32/MalwareS.IHA\n Symantec Backdoor.Pfinet\n Norman Suspicious_Gen3.DGZV TrendMicro-HouseCall TROJ_GEN.R27E1AH Avast Win32:Malware-gen\n Kaspersky Trojan.Win32.Agent2.flce\n BitDefender Backdoor.Generic.252173 Ad-Aware Backdoor.Generic.252173 Sophos Mal/Generic-S\n F-Secure Backdoor.Generic.252173\n DrWeb Trojan.Siggen1.51234 VIPRE Trojan.Win32.Generic!BT\n AntiVir TR/Rootkit.Gen\n TrendMicro TROJ_GEN.R27E1AH\n\n\n### 6 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n#### AV product Result\n\n McAfee-GW-Edition Artemis!DB93128BFF29\n\n Emsisoft Backdoor.Generic.252173 (B)\n\n Jiangmin Trojan/Agent.djjf\n\n Antiy-AVL Trojan/Win32.Agent2\n\n Kingsoft Win32.Troj.Agent2.(kcloud)\n\n Microsoft Backdoor:WinNT/Pfinet.B\n\n GData Backdoor.Generic.252173\n\n Commtouch W32/Risk.DWJW-7987\n\n VBA32 Trojan.Agent2\n\n Panda Rootkit/Agent.IOO\n\n ESET-NOD32 a variant of Win32/Turla.AC\n\n Ikarus Trojan.Win32.Agent\n\n Fortinet W32/Agent2.LDY!tr\n\n AVG Agent2.AHWF\n\n Baidu-International Trojan.Win32.Agent.AFZ\n\n Scanned: 2014-03-23 21:28:41 - 51 scans - 36 detections (70.0%)\n\n### File characteristics\n\n#### Meta data\n\nSize:  252928 bytes\nType:  PE32 executable (DLL) (native) Intel 80386, for MS Windows\nDate:  0x4AC48FC8 [Thu Oct 1 11:17:28 2009 UTC]\nEP:   0x22d80 .text 0/5\nCRC:   Claimed: 0x3e7fe, Actual: 0x3e7fe\n\n#### Sections\n\nName    VirtAddr   VirtSize   RawSize   Entropy\n-------------------------------------------------------------------------------.text   0x1000    0x28084   0x28200   6.325480\n.basein  0x2a000   0x135    0x200    3.791369\n.data   0x2b000   0x20e34   0x12600   1.335577\nINIT    0x4c000   0xebc    0x1000    5.343628\n.reloc   0x4d000   0x1de0    0x1e00    6.448244\n\n#### Strings\n\n Interesting strings:\n\nCsrClientCallServer\nExitThread\nLdrGetProcedureAddress\nZwTerminateThread\n\\SystemRoot\\system32\\%s\nIoCreateDevice\nModuleStart\nModuleStop\n\\??\\%s\\cryptoapi.dll\n\\??\\%s\\inetpub.dll\nservices.exe\niexplore.exe\nfirefox.exe\nopera.exe\nnetscape.exe\nmozilla.exe\nmsimn.exe\noutlook.exe\nadobeupdater.exe\n\n## Sample C - inetpub.dll (Resource: 102)\n\n\n### 7 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### Hashes\n\n#### Type of Hash Hash\n\n MD5 2145945b9b32b4ccbd498db50419b39b\n\n SHA1 690f18810b0cbef06f7b864c7585bd6ed0d207e0\n\n SHA-256 3de0ba77fa2d8b26e4226fd28edc3ab8448434d851f6b2b268ec072c5da92ade\n\n ssdeep 3072:HPHvQByUS7Yqy7UKJm1Y3a3v/z61dmh9f3b/LAaulNA7:HPHqyUS7YqyIKH3aHz61Mh9jZulNC\n\n### VirusTotal results for sample C\n\n#### AV product Result\n\n McAfee Generic.dx!wel K7AntiVirus Riskware\n\n Symantec Backdoor.Pfinet\n\n Norman W32/Suspicious_Gen3.UANR\n\n Avast Win32:Malware-gen\n\n eSafe Win32.TRATRAPS\n\n BitDefender Backdoor.Generic.429659 F-Secure Backdoor.Generic.429659 VIPRE Trojan.Win32.Generic!BT AntiVir TR/ATRAPS.Gen McAfee-GW-Edition Generic.dx!wel Emsisoft Backdoor.SuspectCRC!IK Antiy-AVL Trojan/win32.agent.gen GData Backdoor.Generic.429659 AhnLab-V3 Backdoor/Win32.Pfinet PCTools Backdoor.Pfinet Ikarus Backdoor.SuspectCRC Panda Trj/CI.A Avast5 Win32:Malware-gen\n\n Scanned: 2011-07-07 04:43:10 - 43 scans - 19 detections (44.0%)\n\n### File characteristics\n\n#### Meta data\n\nSize:  118784 bytes\nType:  PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\nDate:  0x4AC5A6A4 [Fri Oct 2 07:07:16 2009 UTC]\nEP:   0x20013857 .text 0/5\nCRC:   Claimed: 0x0, Actual: 0x2cb10 [SUSPICIOUS]\n\n#### Sections\n\nName    VirtAddr   VirtSize   RawSize   Entropy\n-------------------------------------------------------------------------------.text   0x1000    0x12976   0x13000   6.509133\n.basein  0x14000   0x97     0x1000    0.418760  [SUSPICIOUS]\n.rdata   0x15000   0x4ede    0x5000    7.011329  [SUSPICIOUS]\n.data   0x1a000   0x15f0    0x1000    5.453684\n.reloc   0x1c000   0x152a    0x2000    4.423836\n\n#### Exports\n\nFlags     : 00000000\nTime stamp  : Fri Oct 2 09:07:16 2009\nVersion    : 0.0\nDLL name   : CARBON.dll\nOrdinals base : 1. (00000001)\n# of Addresses: 2. (00000002)\n\n\n### 8 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n# of Names  : 2. (00000002)\n1. 00002CB9 ModuleStart\n2. 0000266C ModuleStop\n\n#### Strings\n\n\\\\.\\IdeDrive1\\\\config.txt\nReceiveTimeout\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\nNAME\nobject_id\nVERSION\nUser\nCarbon v3.51\nOPER|Wrong config: bad address|\nMozilla/4.0 (compatible; MSIE 6.0)\nOPER|Wrong config: no port|\nOPER|Wrong config: empty address|\naddress\nCW_INET\nquantity\nuser_winmax\nuser_winmin\nST|Carbon v3.51|\n\\\\.\\IdeDrive1\\\\log.txt\nGlobal\\MSMMC.StartupEnvironment.PPT\nGlobal\\411A5195CD73A8a710E4BB16842FA42C\nGlobal\\881F0621AC59C4c035A5DC92158AB85E\nGlobal\\MSCTF.Shared.MUTEX.RPM\nGlobal\\WindowsShellHWDetection\nGlobal\\MSDBG.Global.MUTEX.ATF\nTR|%d|\n$Id: hide_module_win32.c 10189 2008-11-25 14:25:41Z gilg $\nZwWow64ReadVirtualMemory64\n$Id: load_lib_win32.c 10180 2008-11-20 12:13:01Z gilg $\n\\SysWOW64\\\n\\System32\\\nCreateRemoteThread\nZwTerminateThread\nLdrGetProcedureAddress\nExitThread\n$Id: mutex.c 3940 2006-03-20 16:47:16Z vlad $\n$Id: rw_lock.c 4482 2006-08-30 13:07:14Z vlad $\n%x-%x-%x-%x\n%02d/%02d/%02d|%02d:%02d:%02d|%s|u|\nsearch.google.com\nwww.easports.com\nwww.sun.com\nwww.dell.com\nwww.3com.com\nwww.altavista.com\nwww.hp.com\nsearch.microsoft.com\nwindowsupdate.microsoft.com\nwww.microsoft.com\nwww.asus.com\nwww.eagames.com\nwww.google.com\nwww.astalavista.com\nwww.bbc.com\nwww.yahoo.com\nCreateToolhelp32Snapshot() failed: %d\nOPER|Sniffer '%s' running... ooopppsss...|\nsnoop.exe\nettercap.exe\nwireshark.exe\nethereal.exe\nwindump.exe\ntcpdump.exe\nHTTP/1.1\n%sauth.cgi?mode=query&id=%u:%u:%u:%u&serv=%s&lang=en&q=%u-%u&date=%s\n%Y-%m-%d\n%sdefault.asp?act=%u&id=%u&item=%u&event_id=%u&cln=%u&flt=%u&serv=%s&t=%ld&mode=query&lang=en&date=%s\nlastconnect\ntimestop\n.bak\n\\\\.\\IdeDrive1\\\\\nD:AI\n\n\n### 9 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n@OPER|Wrong timeout: high < low|\nMem alloc err\nP|-1|%d|NULL|%d|\nP|0|%s|%d|HC=%d\nHC|%d|\nP|-1|%d|%s|%d|\n\\\\.\\IdeDrive1\\\\Results\\result.txt\nPOST\nHTTP/1.0\nA|-1|%u|%s|%s|\n%u|%s|%s\nTask %d failed %s,%d\n\\\\.\\IdeDrive1\\\\Results\\\n207.46.249.57\n207.46.249.56\n207.46.250.119\nmicrosoft.com\n207.46.253.125\n207.46.18.94\nupdate.microsoft.com\nG|0|%d|%d|\n%u|%s|%s|%s\nOPER|Wrong config|\nS|0|%s|\nS|-1|%d|%s|\nlogperiod\nlastsend\nlogmax\nlogmin\nCopyFile(%s, %s):%d\nCrPr(),WL(),AU() error: %d\nCrPr() WaitForSingleObject() error: %d\nCrPr() wait timeout %d msec exceeded: %d\nT|-1|%d|%d|\nTask not execute. Arg file failed.\nWORKDATA\nrun_task\nDELETE\nCOMPRESSION\nRESULT\nstdout\nCONFIG\ncmd.exe\ntime2task\nm_recv() RESULT failed.\nA|-1|%u|%s|%d|\nactive_con\nm_send() TASK failed.\nOBJECT ACK failed.\nInternal task %d obj %s not equal robj %s... very strange!!!\nm_recv() OBJECT failed.\nm_send() OBJECT failed.\nm_send() WHO failed.\nAUTH failed.\nm_recv() AUTH failed.\nm_send() AUTH failed.\nm_connect() failed.\nm_setoptlist() failed.\nnet_password=\nnet_user=\nallow=*everyone\nwrite_peer_nfo=%c%s%c\nfrag_no_scrambling=1\nfrag_size=32768\nm_create() failed.\nfrag.np\n\\\\%s\\pipe\\comnode\nW|2|%s|%d|\n127.0.0.1\nm_send() ZERO failed.\nTrans task %d obj %s ACTIVE fail robj %s\nnet_password=%s\nnet_user=%s\n\\\\%s\\pipe\\%s\nfrag.tcp\n%s:%d\nW|1|%s|%d|\n%u|%s|%s|%s|%s|%d|%s|%s\n\\\\.\\IdeDrive1\\\\Tasks\\task_system.txt\n\n\n### 10 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n%u|%s|%s|%s|%s|%d\n\\\\.\\IdeDrive1\\\\Tasks\\task.txt\n%u|%s|%s|%s|%s\n\\\\.\\IdeDrive1\\\\Tasks\\\nW|0|%s|%d|\nW|-1|%s|%d|\nstart\nT|e|%d|\nT|s|%d|\ntask_max\ntask_min\nI|%d|\nreconstructing block ...\n%6d unresolved strings\ndepth %6d has\nbucket sorting ...\n%d pointers, %d sorted, %d scanned\nqsort [0x%x, 0x%x]  done %d  this %d\nmain sort initialise ...\ntoo repetitive; using fallback sorting algorithm\n%d work, %d block, ratio %5.2f\nCONFIG_ERROR\nOUTBUFF_FULL\nUNEXPECTED_EOF\nIO_ERROR\nDATA_ERROR_MAGIC\nDATA_ERROR\nMEM_ERROR\nPARAM_ERROR\nSEQUENCE_ERROR\ncodes %d\ncode lengths %d,\nselectors %d,\nbytes: mapping %d,\npass %d: size is %d, grp uses are\ninitial group %d, [%d .. %d], has %d syms (%4.1f%%)\nY@   %d in block, %d after MTF & 1-2 coding, %d+2 syms in use\nfinal combined CRC = 0x%x\nblock %d: crc = 0x%8x, combined CRC = 0x%8x, size = %d\n$Id: b2_to_m2_stub.c 5273 2007-01-23 17:41:15Z vlad $\n$Id: b_tcp.c 8474 2007-09-19 15:40:39Z vlad $\nTCP: closed.\nTCP: connecting...\nY1N0\nnodelay\nTCP: send\nTCP: recv\n%s:%u\nnodelay=1\nTCP: resolved %s\nTCP: resolving host name...\n$Id: l1_check.c 4477 2006-08-28 15:58:21Z vlad $\n$Id: m2_to_b2_stub.c 4477 2006-08-28 15:58:21Z vlad $\n$Id: m_frag.c 8715 2007-11-29 16:04:46Z urik $\npeer_frag_size\nfrag_no_scrambling\nfrag_size\nFrag: send\n$Id: m_np.c 8825 2008-01-10 13:13:15Z vlad $\n\\\\.\\pipe\\\nno_server_hijack\nimp_level\nnet_password\nnet_user\nwrite_peer_nfo\nread_peer_nfo\n*everyone\nallow\n$Id: np_win32_common.c 4483 2006-08-30 13:13:51Z vlad $\nanonymous\nevery1\n\\ipc$\n\\pipe\\\n$Id: t_byte1.c 5324 2007-01-30 12:45:35Z vlad $\nfrag\n$Id: t_manager.c 8715 2007-11-29 16:04:46Z urik $\ntransports\n$Id: t_message1.c 5290 2007-01-26 11:15:03Z vlad $\nlicence error\n\n\n### 11 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n## Sample D - cryptoapi.dll (Resource: 105)\n\n### Hashes\n\n#### Type of Hash Hash\n\n MD5 a67311ec502593630307a5f3c220dc59\n\n SHA1 74b0c62737f43b0138cfae0d0972178a14fbea10\n\n SHA-256 67bc775cc1a58930201ef247ace86cc5c8569057d4911a8e910ac2263c8eb880\n\n ssdeep 3072:/eZCuX04e/tmjQFFTNna3bFy99f3bay/FjIJA:/eZbUIj4zaLFw9/JI+\n\n### VirusTotal results for sample D\n\n#### AV product Result\n\n CAT-QuickHeal Backdoor.Pfinet\n\n McAfee Generic.dx!ueu\n\n K7AntiVirus Riskware\n\n VirusBuster Backdoor.Agent!JK8atQHb1PQ\n\n Symantec Backdoor.Pfinet Norman W32/Suspicious_Gen3.JVLR TrendMicro-HouseCall TROJ_GEN.R47C3JS Avast Win32:Malware-gen Kaspersky UDS:DangerousObject.Multi.Generic BitDefender Backdoor.Generic.264016 Emsisoft Backdoor.SuspectCRC!IK Comodo UnclassifiedMalware F-Secure Backdoor.Generic.264016 VIPRE Trojan.Win32.Generic!BT AntiVir TR/ATRAPS.Gen TrendMicro TROJ_GEN.R47C3JS McAfee-GW-Edition Heuristic.BehavesLike.Win32.Suspicious.H GData Backdoor.Generic.264016 AhnLab-V3 Backdoor/Win32.Pfinet PCTools Backdoor.Pfinet Ikarus Backdoor.SuspectCRC Panda Trj/CI.A Avast5 Win32:Malware-gen\n\n Scanned: 2011-05-08 11:16:36 - 42 scans - 23 detections (54.0%)\n\n### File characteristics\n\n#### Meta data\n\nSize:  135168 bytes\nType:  PE32 executable (DLL) (GUI) Intel 80386, for MS Windows\nDate:  0x4AC5A662 [Fri Oct 2 07:06:10 2009 UTC]\nEP:   0x20015d85 .text 0/5\nCRC:   Claimed: 0x0, Actual: 0x2ccd6 [SUSPICIOUS]\n\n#### Exports\n\nFlags     : 00000000\nTime stamp  : Fri Oct 2 09:06:07 2009\nVersion    : 0.0\nDLL name   : carbon_system.dll\nOrdinals base : 1. (00000001)\n# of Addresses: 1. (00000001)\n# of Names  : 1. (00000001)\n\n\n### 12 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n1. 00002655 ModuleStart\n\n#### Sections\n\nName    VirtAddr   VirtSize   RawSize   Entropy\n-------------------------------------------------------------------------------.text   0x1000    0x150d5   0x16000   6.417399\n.basein  0x17000   0x97     0x1000    0.418760  [SUSPICIOUS]\n.rdata   0x18000   0x5380    0x6000    6.450645\n.data   0x1e000   0x15e0    0x1000    5.450370\n.reloc   0x20000   0x15e4    0x2000    4.991237\n\n#### Strings\n\n$Id: t_utils.c 5503 2007-02-26 13:14:30Z vlad $\n$Id: t_status.c 5666 2007-03-19 16:18:00Z vlad $\n$Id: t_message1.c 5290 2007-01-26 11:15:03Z vlad $\n$Id: t_manager.c 8715 2007-11-29 16:04:46Z urik $\n$Id: t_byte1.c 5324 2007-01-30 12:45:35Z vlad $\n$Id: np_win32_common.c 4483 2006-08-30 13:13:51Z vlad $\n$Id: m_np.c 8825 2008-01-10 13:13:15Z vlad $\n$Id: m_frag.c 8715 2007-11-29 16:04:46Z urik $\n$Id: m2_to_b2_stub.c 4477 2006-08-28 15:58:21Z vlad $\n$Id: l1_check.c 4477 2006-08-28 15:58:21Z vlad $\n$Id: b_tcp.c 8474 2007-09-19 15:40:39Z vlad $\n$Id: b2_to_m2_stub.c 5273 2007-01-23 17:41:15Z vlad $\n$Id: thread.c 4593 2006-10-12 11:43:29Z urik $\n$Id: rw_lock.c 4482 2006-08-30 13:07:14Z vlad $\n$Id: mutex.c 3940 2006-03-20 16:47:16Z vlad $\n$Id: load_lib_win32.c 10180 2008-11-20 12:13:01Z gilg $\n$Id: hide_module_win32.c 10189 2008-11-25 14:25:41Z gilg $\n\\\\.\\IdeDrive1\\\\Tasks\\\n\\\\.\\IdeDrive1\\\\Results\\\nGlobal\\MSDBG.Global.MUTEX.ATF\nGlobal\\WindowsShellHWDetection\nGlobal\\MSCTF.Shared.MUTEX.RPM\nGlobal\\881F0621AC59C4c035A5DC92158AB85E\nGlobal\\411A5195CD73A8a710E4BB16842FA42C\nGlobal\\MSMMC.StartupEnvironment.PPT\n\\\\.\\IdeDrive1\\\\log.txt\nTR|%d|\nSR|%d|\nST|Carbon v3.61|\n\\\\.\\IdeDrive1\\\\*.bak\n\\\\.\\IdeDrive1\\\\\n\\\\.\\IdeDrive1\\\\Tasks\\task.txt\n\\\\.\\IdeDrive1\\\\Tasks\\task_system.txt\n\\\\.\\IdeDrive1\\\\Tasks\\*.tmp\n\\\\.\\IdeDrive1\\\\config.txt\nsys_winmin\nTIME\nsys_winmax\n\\\\.\\IdeDrive1\\\\restrans.txt\nquantity\nCW_LOCAL\naddress\nobject\nD:(A;OICIID;GRGWGX;;;WD)\nCarbon v3.61\nSystem\nVERSION\nobject_id\nNAME\nCW_INET\nlogperiod\nOPER|Survive me, i`m close to death... free space less than 5%%...|\nOPER|Low space... free space less than 10%%...|\nZwWow64ReadVirtualMemory64\nExitThread\nLdrGetProcedureAddress\nZwTerminateThread\nCreateRemoteThread\n\\System32\\\n\\SysWOW64\\\nOPER|Wrong timeout: high < low|\n%02d/%02d/%02d|%02d:%02d:%02d|%s|s|\nCreateToolhelp32Snapshot() failed: %d\n\n\n### 13 f 34 12/31/2014 09 19 AM\n\n\n-----\n\ntcpdump.exe\nwindump.exe\nethereal.exe\nwireshark.exe\nettercap.exe\nsnoop.exe\nOPER|Sniffer '%s' running... ooopppsss...|\n%x-%x-%x-%x\nrun_task_system\nWORKDATA\n\\\\.\\IdeDrive1\\\\Results\\result.txt\nI|%d|\ntask_min\ntask_max\nT|s|%d|\n%u|1|%s|%s\n%u|2|%s|%s|%s\nT|e|%d|\nstart\ntime2task\ncmd.exe\nCONFIG\nstdout\nRESULT\nCOMPRESSION\nDELETE\n%u|%s|%s\n%u|%s|%s|%s\nTask not execute. Arg file failed.\nT|-1|%d|%d|\nAS_USER:LogonUser():%d\nAS_USER:DuplicateTokenEx():%d\nexplorer.exe\nAS_CUR_USER:OpenProcessToken():%d\nAS_CUR_USER:DuplicateTokenEx():%d\nCrPr() wait timeout %d msec exceeded: %d\nCrPr() WaitForSingleObject() error: %d\nCrPr(),WL(),AU():%d\nCopyFile(%s, %s):%d\nMemory allocation error. Use no compression\nfrag.np\n\\\\.\\Global\\PIPE\\comnode\nfrag_size=32768\nfrag_no_scrambling=1\nallow=*everyone\nactive_con\nfrag.tcp/%s:445\nfrag.np/%s\n\\\\.\\IdeDrive1\\\\logtrans.txt\nA|2|%s|\nW|%s|%s|\nm_send() ZERO1 failed\nW|%s|%s|%s|\n\\*.tmp\nm_send() ZERO2 failed\nR|%s|%d|\n\\\\%s\\pipe\\comnode\nfrag.tcp\nnet_user=\nnet_password=\nwrite_peer_nfo=%c%s%c\nP|0|%s|%d|\nP|-1|%d|%s|%d|\nP|-1|%d|%d|\nnodelay=N\nW|-1|%d|%s|\nSEND AUTH\nW|-1|%d|%s|%s|\nRECV AUTH\nAUTH FAILED\nSEND WHO\nSEND OBJECT_ID\nlogmin\nlogmax\nlastsend\nS|0|%s|\nS|-1|%d|%s|\nTask %d failed %s, %d\nA|-1|%u|%s|%s|\n\n\n### 14 f 34 12/31/2014 09 19 AM\n\n\n-----\n\ntimestop\nlastconnect\n.bak\n%u:%u:%u:%u:%u\nFreeze Ok.\n\\$NtUninstallQ722833$\\usbdev.sys\n\\\\.\\IdeDrive1\\\\usbdev.bak\n\\\\.\\IdeDrive1\\\\inetpub.bak\n\\\\.\\IdeDrive1\\\\inetpub.dll\n\\\\.\\IdeDrive1\\\\cryptoapi.bak\n\\\\.\\IdeDrive1\\\\cryptoapi.dll\nUpdate Ok.\nUpdate failed =(( Can`t create file.\n\\\\.\\IdeDrive1\\\\Plugins\\\nCan't create file '%s', error %d =((\nCreate plugin '%s' OK.\nCreate plugin '%s' failed. Write error, %d.\nPLUGINS\nFind existing record.\nnot_started|%d\nConfig update success.\nenable%s\nConfig record error: %s = %s.\nPlugin not found in config.\nPlugin already loaded.\nModuleStart\ncan`t find entry point.\nloadlibrary() failed.\nPlugin start failed, %d\ntry to run dll with user priv.\ncan`t get characs.\nPlugin not PE format.\nPlugin start success.\nPlugin start failed.\ndisable%s\nremoved%s\nPlugin not loaded.\nPlugin deleted.\nPlugin delete failed, %d.\nPlugin terminated.\nPlugin terminate failed, %d.\nModuleStop\nPlugin dll stop success.\nPlugin dll stop failed.\nPlugin freelib success.\nPlugin freelib failed, %d.\nInternal command not support =((\n%u|1|%s\nG|0|%d|%d|\nW|0|%s|%d|\nA|0|%s|%d|\n%u|%s|%s|%s|%s\n%u|%s|%s|%s|%s|%d|%s|%s\n%u|%s|%s|%s|%s|%d\nW|1|%s|%d|\nA|1|%s|%d|\n%s:%d\n\\\\%s\\pipe\\%s\nm_create() failed.\nnet_user=%s\nnet_password=%s\nm_setoptlist() failed.\nm_connect() failed.\nm_send() AUTH failed.\nm_recv() AUTH failed.\nAUTH failed.\nm_send() WHO failed.\nm_send() OBJECT failed.\nm_recv() OBJECT failed.\nTrans task %d for obj %s ACTIVE fail robj=%s\nOBJECT ACK failed.\nm_send() TASK failed.\nm_recv() WIN RESULT failed.\nm_recv() ACT RESULT failed.\nm_send() ACT RESULT failed.\nenable\nL|-1|can`t find entry point %s|\nL|-1|loadlibrary() failed %d|\nL|-1|%s|%d|\n\n\n### 15 f 34 12/31/2014 09 19 AM\n\n\n-----\n\nL|-1|try to run dll %s with user priv|\nL|-1|can`t get characs %s|\nL|-1|not PE format %s|\nL|-1| parse error %s|\nL|-1| parse error %s|\nL|0|%s|\nL|-1|AS_CUR_USER:OpenProcessToken():%d, %s|\nL|-1|AS_CUR_USER:DuplicateTokenEx():%d, %s|\nL|-1|AS_CUR_USER:LogonUser():%d, %s|\nL|-1|wrong priv %s|\nL|-1|CreateProcessAsUser():%d, %s|\nD:AI\nTCP: resolving host name...\nTCP: resolved %s\nTCP: closed.\nTCP: connecting...\nnodelay\nY1N0\nTCP: send\nTCP: recv\n%s:%u\nFrag: send\nfrag_size\nfrag_no_scrambling\npeer_frag_size\n\\\\.\\pipe\\\nallow\n*everyone\nread_peer_nfo\nwrite_peer_nfo\nnet_user\nnet_password\nimp_level\nno_server_hijack\nevery1\nanonymous\n\\pipe\\\n\\ipc$\nfrag\ntransports\nlicence error\n\n## Sample E - usbdev.sys - x64 - (Resouce: 161)\n\n### Hashes\n\n#### Type of Hash Hash\n MD5 62e9839bf0b81d7774a3606112b318e8 SHA1 6f2e50c5f03e73e77484d5845d64d952b038a12b SHA-256 39050386f17b2d34bdbd118eec62ed6b2f386e21500a740362454ed73ea362e8 ssdeep 3072:S9f3buYUVKa6a1206K55kL+tkA3qkQQ0dwZATH:S9iYUImo06KXkL+qA6kf0dwK\n\n### VirusTotal results for sample E\n\n#### AV product Result\n McAfee+Artemis Pfinet\n nProtect Trojan/W32.Agent.228352.W\n McAfee Pfinet F-Prot W32/Pfinet.A a-squared Backdoor.Pfinet!IK\n Avast Win32:Malware-gen\n ClamAV Trojan.Agent-126457 Kaspersky Trojan.Win32.Agent.czua\n BitDefender Trojan.Generic.2617254 Comodo TrojWare.Win32.Agent.czua\n F-Secure Trojan:W64/Carbys.gen!A\n\n\n### 16 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n#### AV product Result\n\n DrWeb Trojan.Siggen.27969\n\n TrendMicro TROJ_PFINET.A\n\n Authentium W32/Pfinet.A\n\n Jiangmin Trojan/Agent.dcrw\n\n Antiy-AVL Trojan/Win32.Agent.gen\n\n Symantec Backdoor.Pfinet\n\n Microsoft Backdoor:WinNT/Pfinet.B\n\n GData Trojan.Generic.2617254\n\n VBA32 Trojan.Win32.Agent.czua\n\n PCTools Backdoor.Pfinet\n\n Ikarus Backdoor.Pfinet\n\n AVG Agent2.YKW\n\n Panda Rootkit/Agent.MXI\n\n Scanned: 2009-12-27 12:15:01 - 40 scans - 24 detections (60.0%)\n\n### File characteristics\n\n#### Meta data\n\nSize:  228352 bytes\nType:  PE32+ executable (DLL) (native) x86-64, for MS Windows\nDate:  0x4AC48FE7 [Thu Oct 1 11:17:59 2009 UTC]\nEP:   0x21454 .text 0/6\nCRC:   Claimed: 0x397f7, Actual: 0x397f7\n\n#### Sections\n\nName    VirtAddr   VirtSize   RawSize   Entropy\n-------------------------------------------------------------------------------.text   0x1000    0x2126c   0x21400   6.518352\n.basein  0x23000   0xc7     0x200    2.902918\n.data   0x24000   0x23a3c   0x13400   1.284443\n.pdata   0x48000   0x10b0    0x1200    5.035513\nINIT    0x4a000   0x10ce    0x1200    4.944873\n.reloc   0x4c000   0x99a    0xa00    4.576183\n\n#### Strings\n\n The strings correspond mostly to the ones of Sample B.\n\n## Sample F - inetpub.dll - x64 (Resource: 162)\n\n### Hashes\n\n#### Type of Hash Hash\n\n MD5 e1ee88eda1d399822587eb58eac9b347 SHA1 32287d26656587c6848902dbed8086c153d94ee7\n SHA-256 92c2023095420de3ca7d53a55ed689e7c0086195dc06a4369e0ee58a803c17bb\n ssdeep 3072:vr84EaVK9B9MklzeALxqS6kcLyHFQ+vYnb9f3bkrlESXdMQyFc8:QPp9B9MkllLMScLmsb9IKrF1\n\n### VirusTotal results for sample F\n\n#### AV product Result\n\n Symantec Backdoor.Pfinet\n\n Scanned: 2014-03-23 21:27:06 - 51 scans - 1 detections (1.0%)\n\n\n### 17 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### File characteristics\n\n#### Meta data\n\nSize:  113664 bytes\nType:  PE32+ executable (DLL) (GUI) x86-64, for MS Windows\nDate:  0x4AC5A6C2 [Fri Oct 2 07:07:46 2009 UTC]\nEP:   0x200149d0 .text 0/5\nCRC:   Claimed: 0x0, Actual: 0x1e6b8 [SUSPICIOUS]\n\n#### Sections\n\nName    VirtAddr   VirtSize   RawSize   Entropy\n-------------------------------------------------------------------------------.text   0x1000    0x13b8d   0x13c00   6.247940\n.rdata   0x15000   0x582e    0x5a00    6.692290\n.data   0x1b000   0x1ae0    0x1400    4.598089\n.pdata   0x1d000   0x8c4    0xa00    4.522066\n.reloc   0x1e000   0x248    0x400    2.325587\n\n#### Strings\n\n The strings correspond mostly to the ones of Sample C.\n\n## Sample G - cryptoapi.dll - x64 (Resource: 165)\n\n### Hashes\n\n#### Type of Hash Hash\n\n MD5 a7853bab983ede28959a30653baec74a SHA1 eee11da421c7268e799bd938937e7ef754a895bf SHA-256 0e3842bd092db5c0c70c62e8351649d6e3f75e97d39bbfd0c0975b8c462a65ca ssdeep 3072:U/ylCK5WUZFspUjcF65zlEzEOflC9Pw6OPEH66kcXF9f3b6ivgCUHXM:1gWWUrg3ANOP+6cXF9/u\n\n### VirusTotal results for sample G\n\n#### AV product Result\n Symantec Backdoor.Pfinet AntiVir TR/ATRAPS.Gen2\n\n Scanned: 2014-03-23 21:26:59 - 51 scans - 2 detections (3.0%)\n\n### File characteristics\n\n#### Meta data\n\nSize:  147968 bytes\nType:  PE32+ executable (DLL) (GUI) x86-64, for MS Windows\nDate:  0x4AC5A685 [Fri Oct 2 07:06:45 2009 UTC]\nEP:   0x2001bd80 .text 0/6\nCRC:   Claimed: 0x0, Actual: 0x32c9f [SUSPICIOUS]\n\n#### Sections\n\nName    VirtAddr   VirtSize   RawSize   Entropy\n-------------------------------------------------------------------------------.text   0x1000    0x1af6d   0x1b000   6.195387\n.basein  0x1c000   0xc7     0x200    2.902918\n.rdata   0x1d000   0x66f0    0x6800    6.585248\n.data   0x24000   0x1b00    0x1400    4.647566\n.pdata   0x26000   0xad4    0xc00    4.848795\n.reloc   0x27000   0x2a6    0x400    2.344107\n\n\n### 18 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 19 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 20 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 21 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 22 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 23 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n[...]\n.text:0001E122         mov   [ebp+xor_key], 4E415341h ; key\n.text:0001E129         mov   [ebp+part_1], 7253605h  ; part 1 encrypted\n.text:0001E130         mov   [ebp+part_2], 3C282524h ; part 2 encrypted\n\n[...]\n.text:0001E17B         mov   eax, [ebp+part_1]\n.text:0001E17E         xor   eax, [ebp+xor_key]    ; decrypt part 1: IdeD\n.text:0001E181         mov   [ebp+part_1], eax\n\n[...]\n.text:0001E184         mov   ecx, [ebp+part_2]\n.text:0001E18A         xor   ecx, [ebp+xor_key]    ; decrypt part 2: rive\n.text:0001E18D         mov   [ebp+part_2], ecx\n\n[...]\n\n#### They are seriously using a key 0x4E415341 to decrypt the string. 0x4E415341 is ASCII for ‘NASA’. That’s how they decrypt and assemble the string IdeDrive, appending a ‘1’ in the next step and using if for creating the destination. Full excerpt below:\n\n[...]\n.text:0001E11B         mov   [ebp+var_20], 0\n.text:0001E122         mov   [ebp+xor_key], 4E415341h\n.text:0001E129         mov   [ebp+part_1], 7253605h\n.text:0001E130         mov   [ebp+part_2], 3C282524h\n.text:0001E13A         xor   eax, eax\n.text:0001E13C         mov   [ebp+drive], eax\n.text:0001E142         mov   [ebp+var_338], eax\n.text:0001E148         mov   [ebp+var_334], ax\n.text:0001E14F         push  104h      ; size_t\n.text:0001E154         push  0        ; int\n.text:0001E156         lea   ecx, [ebp+cryptoapi.dll]\n.text:0001E15C         push  ecx       ; void *\n.text:0001E15D         call  memset\n.text:0001E162         add   esp, 0Ch\n.text:0001E165         push  104h      ; size_t\n.text:0001E16A         push  0        ; int\n.text:0001E16C         lea   edx, [ebp+inetpub.dll]\n.text:0001E172         push  edx       ; void *\n.text:0001E173         call  memset\n.text:0001E178         add   esp, 0Ch\n.text:0001E17B         mov   eax, [ebp+part_1]\n.text:0001E17E         xor   eax, [ebp+xor_key]\n.text:0001E181         mov   [ebp+part_1], eax\n.text:0001E184         mov   ecx, [ebp+part_2]\n.text:0001E18A         xor   ecx, [ebp+xor_key]\n.text:0001E18D         mov   [ebp+part_2], ecx\n.text:0001E193         mov   edx, [ebp+part_1]\n.text:0001E196         push  edx\n.text:0001E197         call  order_bytes\n.text:0001E19C         mov   [ebp+part_1], eax\n.text:0001E19F         mov   eax, [ebp+part_1]\n.text:0001E1A2         mov   [ebp+part_1], eax\n.text:0001E1A5         mov   ecx, [ebp+part_2]\n.text:0001E1AB         push  ecx\n.text:0001E1AC         call  order_bytes\n.text:0001E1B1         mov   [ebp+part_2], eax\n.text:0001E1B7         mov   edx, [ebp+part_2]\n.text:0001E1BD         mov   [ebp+part_2], edx\n.text:0001E1C3         mov   eax, [ebp+part_1]\n.text:0001E1C6         mov   [ebp+drive], eax\n.text:0001E1CC         mov   ecx, [ebp+part_2]\n.text:0001E1D2         mov   [ebp+var_338], ecx\n.text:0001E1D8         lea   edx, [ebp+drive]\n.text:0001E1DE         add   edx, 0FFFFFFFFh\n.text:0001E1E1         mov   [ebp+var_454], edx\n.text:0001E1E7         mov   eax, [ebp+var_454]\n.text:0001E1ED         mov   cl, [eax+1]\n.text:0001E1F0         mov   [ebp+var_455], cl\n.text:0001E1F6         add   [ebp+var_454], 1\n.text:0001E1FD         cmp   [ebp+var_455], 0\n.text:0001E204         jnz   short loc_1E1E7\n.text:0001E206         mov   edi, [ebp+var_454]\n.text:0001E20C         mov   dx, word ptr ds:a1 ; \"1\"\n.text:0001E213         mov   [edi], dx\n.text:0001E216         lea   eax, [ebp+drive]\n.text:0001E21C         push  eax\n.text:0001E21D         push  offset a??SCryptoapi_d ; \"\\\\??\\\\%s\\\\cryptoapi.dll\"\n.text:0001E222         lea   ecx, [ebp+cryptoapi.dll]\n.text:0001E228         push  ecx       ; char *\n\n\n### 24 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 25 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 26 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 27 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n.data:2001EF58          offset sub_2000DDC0>\n\n#### TODO: these functions need to be analyzed and described\n\n Other reports mention different other transports that are not present in this collection.\n\n Transport (Type) CIRCL BAE deresz/tecamac\n\n tcp (1) x x\n\n b2m (1) x\n\n np (2) x x\n\n enc (2) x\n\n reliable (2) x\n\n frag x x x\n\n m2b (2) x x\n\n m2d (2) x\n\n t2m (3) x\n\n udp (4) x\n\n doms (4) x\n\n domc (4) x\n\n frag.np and frag.tcp replies:\n\nSEND AUTH\nRECV AUTH\nAUTH FAILED\nSEND WHO\nSEND OBJECT_ID\n\n#### frag.np/frag.tcp options:\n\nfrag_size=32768\nfrag_no_scrambling=1\nallow=*everyone\nactive_con\nnet_user=\nnet_password=\nwrite_peer_nfo=%c%s%c\nnodelay=N\n\n### Files from cryptoapi.dll\n\n\\\\.\\IdeDrive1\\\n\\\\.\\IdeDrive1\\log.txt\n\\\\.\\IdeDrive1\\*.bak\n\\\\.\\IdeDrive1\\Tasks\\\\task.txt\n\\\\.\\IdeDrive1\\Tasks\\\\task_system.txt\n\\\\.\\IdeDrive1\\Tasks\\\\*.tmp\n\\\\.\\IdeDrive1\\config.txt\n\\\\.\\IdeDrive1\\restrans.txt\n\\\\.\\IdeDrive1\\Tasks\\\\\n\\\\.\\IdeDrive1\\Results\\\\\n\\\\.\\IdeDrive1\\logtrans.txt\n\\\\.\\IdeDrive1\\usbdev.bak\n\\\\.\\IdeDrive1\\inetpub.bak\n\\\\.\\IdeDrive1\\inetpub.dll\n\\\\.\\IdeDrive1\\cryptoapi.bak\n\\\\.\\IdeDrive1\\cryptoapi.dll\n\\\\.\\IdeDrive1\\Plugins\\\\\n\n### Pipes from cryptoapi.dll\n\n\\\\\\\\.\\\\Global\\\\PIPE\\\\comnode\n\\\\\\\\%s\\\\pipe\\\\comnode\n\\\\\\\\%s\\\\pipe\\\\%s\n\n### Custom error codes, shared in sample B, C and D (E and F to be check)\n\nCUSTOM_ERROR_01 = 21590001h\n\n\n### 28 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 29 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 30 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 31 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 32 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 33 f 34 12/31/2014 09 19 AM\n\n\n-----\n\n### 34 f 34 12/31/2014 09 19 AM\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/54kvbxp9nc0xtme1omd1xpxcckwm945g",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.07.10.Turla_Pfinet_Snake_Uroburos/circl-tr25-analysis-turla-pfinet-snake-uroburos.pdf"
    ],
    "report_names": [
        "circl-tr25-analysis-turla-pfinet-snake-uroburos"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/7f3e46c42095721ba79b1a47e26e662eb7492057.pdf",
        "text": "https://archive.orkl.eu/7f3e46c42095721ba79b1a47e26e662eb7492057.txt",
        "img": "https://archive.orkl.eu/7f3e46c42095721ba79b1a47e26e662eb7492057.jpg"
    }
}