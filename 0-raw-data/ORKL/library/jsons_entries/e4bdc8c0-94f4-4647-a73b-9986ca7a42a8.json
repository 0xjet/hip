{
    "id": "e4bdc8c0-94f4-4647-a73b-9986ca7a42a8",
    "created_at": "2023-01-12T15:06:37.525254Z",
    "updated_at": "2025-03-27T02:11:51.181031Z",
    "deleted_at": null,
    "sha1_hash": "58037724e123f911fc209732b0a9828439969814",
    "title": "2022-06-27 - Return of the Evilnum APT with updated TTPs and new targets",
    "authors": "",
    "file_creation_date": "2022-07-02T23:17:48Z",
    "file_modification_date": "2022-07-02T23:17:48Z",
    "file_size": 2073716,
    "plain_text": "# Return of the Evilnum APT with updated TTPs and new targets\n\n**[zscaler.com/blogs/security-research/return-evilnum-apt-updated-ttps-and-new-targets](https://www.zscaler.com/blogs/security-research/return-evilnum-apt-updated-ttps-and-new-targets)**\n\n## Summary\n\nSince the beginning of 2022, ThreatLabz has been closely monitoring the activities of the\nEvilnum APT group. We identified several instances of their low-volume targeted attack\ncampaigns launched against our customers in the UK and Europe region.\n\nThe new instances of the campaign use updated tactics, techniques, and procedures. In\nearlier campaigns observed in 2021, the main distribution vector used by this threat group was\nWindows Shortcut files (LNK) sent inside malicious archive files (ZIP) as email attachments in\nspear phishing emails to the victims.\n\nIn the most recent instances, the threat actor has started using MS Office Word documents,\nleveraging document template injection to deliver the malicious payload to the victims’\nmachines. In this blog, we present the technical details of all components involved in the endto-end attack chain. At the time of writing, to the best of our knowledge, the complete attack\nchain of this new instance of Evilnum APT group is not publicly documented anywhere.\n\nThreatLabz has identified several domains associated with Evilnum APT group which have not\nbeen previously detected by security vendors. This discovery indicates that the Evilnum APT\ngroup has been successful at flying under the radar and has remained undetected for a long\ntime.\n\n## Key points\n\n\n-----\n\nThe key targets of the Evilnum APT group have predominantly been in the FinTech\n(Financial services) sector, specifically companies dealing with trading and compliance in\nthe UK and Europe.\n\nIn March 2022, we observed a significant update in the choice of targets of Evilnum APT\ngroup. They targeted an Intergovernmental organization which deals with\n**international migration services.**\n\nThe timeline of the attack and the nature of the chosen target coincided with RussiaUkraine conflict.\n\nMacro-based documents used in the template injection stage leveraged VBA code\nstomping technique to bypass static analysis and also to deter reverse engineering.\n\nA heavily obfuscated JavaScript was used to decrypt and drop the payloads on the\nendpoint. The JavaScript configured a scheduled task to run the dropped binary. This\nJavaScript has significant improvements in the obfuscation technique compared to the\nprevious versions used by EvilNum APT group.\n\nThe names of all the file system artifacts created during the course of execution were\nchosen carefully by the threat actor to spoof legitimate Windows and other legitimate\nthird party binaries' names.\n\nIn each new instance of the campaign, the APT group registered multiple domain names\nusing specific keywords related to the industry vertical targeted.\n\n## Attack flow\n\n\n-----\n\n_Figure 1: Attack chain_\n\n## Technical Analysis\n\nFor the purpose of technical analysis we will consider the document with MD5:\n0b4f0ead0482582f7a98362dbf18c219\n\n## Stage 1: Malicious document\n\nThe stage 1 malicious document is delivered via spear phishing email. Once the user\ndownloads and opens the malicious document, it fetches the stage 2 macro template from the\nattacker-hosted domain and displays the decoy content as shown in Figure 2 asking the user\nto enable the macro content.\n\n\n-----\n\n_Figure 2: Decoy content_\n\n## Stage 2: Macro template [VBA code stomping technique]\n\nThe stage 2 template contains the main malicious macro code. It makes use of VBA code\nstomping technique which is fairly uncommon in the wild. This technique destroys the original\nsource code and only a compiled version of the VBA macro code (also known as p-code) is\nstored in the document.\n\nAs a result, this technique prevents static analysis tools such as olevba from extracting the\ndecompiled VBA code.\n\n\n-----\n\nUsing the technique mentioned by the Walmart team [here, we were able to extract the full](https://medium.com/walmartglobaltech/vba-stomping-advanced-maldoc-techniques-612c484ab278)\nmacro code.\n\nAll the strings in the macro code are decrypted using the string decryption function shown in\nFigure 3.\n\n_Figure 3: String decryption function used in the VBA macro code_\n\nBelow are the key functionalities of the macro.\n\n**1. The document file has two text boxes with encrypted contents. These textboxes will be**\ndecrypted at run time by the VBA macro code.\n\na) Textbox 1 - msform_ct.TextBox1.Text. This will be decrypted and contents will be written\nto %appdata%\\\"ThirdPartyNotices.txt\"\n\nb) Textbox 2 - msform_ct.TextBox2.Text - This will be decrypted and contents will be written\nto \"%appdata%\\Redist.txt\"\n\n\n-----\n\n**2. Copies the legitimate Windows binary Wscript.exe to a file with the name** **msdcat.exe .**\nSuch file copy operations are done by malwares as a way to bypass endpoint security\nproducts.\n\n**3. The file - Redist.txt contains the obfuscated JavaScript which will be executed with the**\nfollowing command line:\n\n**_msdcat.exe\" /E:jscRipt \"%appdata%\\Redist.txt\" dg ThirdPartyNotices.txt_**\n\n**Note: \"dg\" is a hard coded command line parameter present inside the VBA macro code.**\n\n**4. During the course of execution of VBA macro code, there are multiple calls to**\ndoc.Shapes.AddPicture() which fetches a JPG image from the attacker-controlled server. We\nbelieve this was done by the attacker to trace and log the execution of code on the endpoint.\n\nOne such example is shown in Figure 4. There is a call to doc.Shapes.AddPicture() between\nthe building of the command line and the execution of the command line.\n\n_Figure 4: VBA code fetches image from attacker’s server to log actions on endpoint_\n\n## Stage 3: Dropped JavaScript [Deobfuscation and analysis]\n\nThe original JavaScript dropped by the VBA-based macro code is heavily obfuscated. We will\nhighlight some of the unique obfuscation techniques used which are rarely observed in\nobfuscated JavaScripts.\n\nThere are two parameters passed to this JavaScript at the time of execution with following\ncommand line:\n\nmsdcat.exe\" /E:jscRipt \"C:\\Users\\user\\AppData\\Roaming\\Redist.txt\" dg ThirdPartyNotices.txt\n\n**parameter 1: \"dg\". This string is later used in the string decryption function in JavaScript.**\n\n**parameter 2: The file \"ThirdPartyNotices.txt\" contains the encrypted code which will be**\ndecrypted and dropped by the JavaScript on the filesystem with binary name SerenadeDACplApp.exe\n\n\n-----\n\nMost obfuscation techniques involve a large array of encrypted and encoded strings which are\nreferenced throughout the code using indexes. A common approach to deobfuscate this\nrequires multiple \"search and replace\" operations where you replace the reference with the\nactual decrypted and decoded string.\n\nJavaScript in this case used an interesting technique where the original array of strings was\nshuffled, and would be unshuffled in memory at the time of execution. So, any attempt to\ndereference the strings without unshuffling the array would result in an error. Such a method\ncan be used to deter reverse engineering and also bypass some tools which try to automate\nthe process of deobfuscation.\n\nLet's look at it in more detail.\n\nFigure 5 below shows the huge array of strings defined at the beginning of the JavaScript. This\narray is wrapped inside a function as an extra layer of obfuscation.\n\n_Figure 5: array of encoded and encrypted strings_\n\nThe next step is to unshuffle the array. Figure 6 below shows the relevant JavaScript code\nwhich uses a brute force approach to unshuffle the array. It has a predefined seed of value\n\"0x6467a\". Upon each iteration, the function computes a seed using various mathematical\noperations and compares it with the predefined seed \"0x6467a\". The function continues to shift\nthe contents of the array by one position to the right until this condition is satisfied.\n\nRelevant comments are included in the code to illustrate the unshuffling logic.\n\n\n-----\n\n_Figure 6: JavaScript function which unshuffles the array_\n\nOther techniques used for obfuscation involve control flow flattening techniques which\nleverage switch-case obfuscation. Figure 7 shows one of the string decryption functions which\nuses such an obfuscation technique.\n\n_Figure 7: Control flow flattening using switch-case obfuscation_\n\nThe sequence of steps of decryption are shuffled using switch-case and the order is followed\naccording to the following sequence:\n\n\"15|12|3|2|14|5|1|10|9|17|8|7|6|4|13|16|0|11\"\n\n\n-----\n\nIt means, case 15 is executed followed by case 12 and so on. The final case 11 returns\nthe decrypted string.\n\nWe can re-write the string decryption function as shown in Figure 8 which is easier to analyze.\n\n_Figure 8: re-written string decryption function_\n\nWe have included a list of interesting decrypted strings extracted from the JavaScript in\nAppendix I.\n\n**[+] Persistence**\n\nThe threat actor achieves persistence via Scheduled task. During JavaScript execution, a\nscheduled task with the name \"UpdateModel Task'' will be created to execute the dropped\nloader binary with required command line arguments.\n\n**Task details:**\n\n<Exec>\n\n<Command>\n\n%appdata%\\Microsoft\\FontCache\\CloudFonts\\SerenadeDACplApp.exe\n\n</Command>\n\n<Arguments>\n\n\"OUM3NjBDNjAtRkNDQi00Q0FDLUE5NEMtNzY0RTc5MDNDN0Mw\" \"devZUQVD.tmp\"\n\n\n-----\n\nNzkzMTA3 Ni4xLjc2MDE%3D 0 E4A6450B NTk1NDQxWwpaWhlhdmVbB1tf Z\n</Arguments>\n<WorkingDirectory>\n\n%appdata%\\Microsoft\\FontCache\\CloudFonts\n\n</WorkingDirectory>\n\n</Exec>\n\n## Stage 4: Dropped binary (Loader)\n\nAs described in previous section, the JavaScript drops two files:\n\n**a) An executable file (SerenadeDACplApp.exe) - It turns out to be a loader**\n\n**b) A binary file (devZUQVD.tmp) - This is the file loaded during runtime by the loader**\n\nThe loader is executed by the scheduled task along with the required arguments. During the\ncourse of its execution it performs following operations:\n\n**1. Performs command-line checks and extracts the file name for the binary to be loaded**\n\nThe loader checks if the command-line ends with (\"). If true then it will terminate the process\nelse it will parse the arguments to extract the file name for the binary file to be loaded.\n\n**# There are two code logics to extract the file name**\n\nIf the first argument has the format (--[char]=[char]*) then the loader will remove the first\n5 characters from this argument string, prepend \"dev\" and append \".tmp\" to it. The\nresulting string is used as the file name for the dropped binary.\n\n**Example:**\n\n**Argument string: --E=nThisIsUsedInFileName**\n\n**Extracted file name: devThisIsUsedInFileName.tmp**\n\nThe second argument string is used as the file name for the dropped binary\n\n**2. Generate full path for the dropped binary file in DOS format**\n\nThe loader first extracts the full path of the currently executing binary and prepends it with\n**“\\\\??\\\\” and then overwrites the file name of the currently executing binary with the file name**\nextracted in Step-1.\n\n**3. Using the Heaven's gate technique calls the NtOpenFile API to create a file handle**\n\n**4. Allocates memory for reading the file content using RtlAllocateHeap API**\n\n\n-----\n\n**5. Using the Heaven s gate technique calls the NtReadFile API to read the file content to**\nallocated memory\n\n**6. Decrypt the file content**\n\n**# Encrypted content format**\n\nXOR key length (1 byte) + XOR key + encrypted content size (4 bytes) + encrypted content\n\n_Figure 9: Encrypted content format_\n\nThe decrypted content turns out to be a PE file that uses a custom header for storing the PE\nheader and section header information.\n\n**# Decrypted content format**\nPE header format (+ Section header format + Section data)*Number of sections\n\n**# PE header format**\n\nStart of decrypted content as well as PE heaser (1 byte - 00) + Image Base (4 bytes) + Size of\nImage (4 bytes) + Entry Point (4 bytes) + Number of sections (4 bytes) + Offset to first section\ninformation from start of decrypted content (4 bytes) + Size of decrypted content (4 bytes)\n\n**# Section header format**\n\nSection number marker (1 byte) + Section RVA (4 bytes) + Section VirtualSize (4 bytes) +\nUnknown (4 bytes)\n\n\n-----\n\n_Figure 10: PE header, Section header and Section data_\n\n**7. Using the Heaven's gate technique calls the NtAllocateVirtualMemory API to allocate**\nmemory for the PE file to be mapped.\n\n**Note: The size is taken from the PE header format described above.**\n\n**8. Map the PE file in memory.**\n\n**9. Using Heaven's gate technique calls the NtCreateThreadEx API to create a thread pointing**\nto the entry point of mapped PE.\n\n**Note: The loader uses Heaven's gate technique to evade endpoint security products as well**\nas syscall or API monitoring applications. It uses a custom header format to thwart memory\nscanning for PE header or section header patterns and also makes it difficult to dump and\nanalyze the PE file as a standalone executable.\n\n## Stage 5: Mapped PE (Main backdoor)\n\nThe mapped PE is the main backdoor of the attack chain. On execution it performs the\nfollowing operations:\n\n**1. Decrypts the backdoor configuration which includes :**\n\na) C2 domains\n\nb) User Agent strings\n\nc) Network paths\n\nd) Referrer strings\n\n\n-----\n\ne) Cookies type strings\n\nf) Request methods + Library names (These will be loaded during further execution) + Network\ncommunication key generation seed bytes + Mutex name\n\nAll the information inside the configuration is encrypted using XOR key. The XOR key is\ndifferent for each data item within the configuration.\n\n**# Encrypted data item format**\n\nEncrypted data size (2 bytes) + Encrypted data + XOR Key length (2 bytes) + XOR Key\n\n_Figure 11: Encrypted data item format_\n\n**2. Resolves API addresses for the libraries retrieved from the configuration**\n\n**3. Performs mutex check**\n\n**4. Builds data exfiltration string to be sent as part of the beacon request**\n\n**# String format**\n\n{\n\n\"v\":\"62\",\"u\":\"{first_arg-user_id}\",\"a\":\"{third_arg}\",\"w\":\"{fourth_arg}\",\"d\":\"{sixth_argument}\",\"n\":\"\n{seventh_arg}\",\"r\":\"0\",\"xn\":\"{name_of_executing_binary}\",\"s\":0\n\n}\n\n**5. Encrypt and Base64 encode the generated string**\n\n\n-----\n\n_Figure 12: Steps performed for encrypting and encoding the exfiltrated data_\n\n**Note: You can find the decryption code under Appendix III section**\n\n\n-----\n\n**6. Embed the encoded string inside the cookie header field by selecting one of the cookie type**\nstrings from the configuration.\n\n**[+] Network communication**\n\nOnce all the above operations are done. The backdoor selects one of the C2 domains and a\npath string from the configuration and sends the beacon network request.\n\nIf the beacon request is successful, the backdoor will query the server for available content\nand download it.\n\nBased on the content size two different operations are performed:\n\n**1. If the content size is 4 then the backdoor checks if the downloaded data is equal to \"01\". If**\ntrue, it takes the machine snapshot and sends it to the C2 server via POST request. The\nsnapshot data is exfiltrated in encrypted form with the cookie header containing additional\ninformation.\n\n**# Format of cookie header string**\n\n{\n\n\"u\":\"{first_arg-user_id}\", \"sc\":1, \"dt\"=\"{snapshot_date_time}\"\n\n}\n\n**2. If the content size is greater than 4, then the backdoor decrypts the downloaded data and**\nexecutes it.\n\n## Zscaler Sandbox report\n\n**# Template payload**\n\n\n-----\n\n## Indicators of compromise\n\n**[+] Hashes**\n\n**MD5** **Description** **Filename**\n\n0b4f0ead0482582f7a98362dbf18c219 Document proof of ownership.docx\n\n4406d7271b00328218723b0a89fb953b Document tradersway compliance.docx\n\n61776b209b01d62565e148585fda1954 Document vantagemarkets\ndocuments.docx\n\n6d329140fb53a3078666e17c249ce112 Document vantagefx compliance.docx\n\nDocument calliber docs (2).docx\n\ndb0866289dfded1174941880af94296f\n\nf0d3cff26b419aff4acfede637f6d3a2 Document complaince\ntfglobaltrading.docx\n\n\n-----\n\n79157a3117b8d64571f60fe62c19bf17 Document complaint\neuropatradecapital.com.docx\n\nDocument fxtm_compliance.docx\n\n63090a9d67ce9534126cfa70716d735f\n\nf5f9ba063e3fee25e0a298c0e108e2d4 Document livetraderfx.docx\n\nea71fcc615025214b2893610cfab19e9 Loader SerenadeDACplApp.exe\n\n\n51425c9bbb9ff872db45b2c1c3ca0854 Encrypted\nbinary\n\n**[+] C2 Domains**\n\ntravinfor[.]com\n\nwebinfors[.]com\n\nkhnga[.]com\n\nnetwebsoc[.]com\n\ninfcloudnet[.]com\n\nbgamifieder[.]com\n\nbunflun[.]com\n\nrefinance-ltd[.]com\n\nbook-advp[.]com\n\nmailservice-ns[.]com\n\nadvertbart[.]com\n\ninetp-service[.]com\n\nyomangaw[.]com\n\ncovdd[.]org\n\n\ndevZUQVD.tmp\n\n\n-----\n\nvisitaustriaislands[.]com\n\ntraveladvnow[.]com\n\ntripadvit[.]com\n\nmoreofestonia[.]com\n\nmoretraveladv[.]com\n\nestoniaforall[.]com\n\nbookingitnow[.]org\n\ntravelbooknow[.]org\n\nbookaustriavisit[.]com\n\nwindnetap[.]com\n\nroblexmeet[.]com\n\nnetrcmapi[.]com\n\nmeetomoves[.]com\n\nbingapianalytics[.]com\n\nazuredcloud[.]com\n\nappdllsvc[.]com\n\nudporm[.]com\n\npcamanalytics[.]com\n\nnortonalytics[.]com\n\ndeltacldll[.]com\n\nmscloudin[.]com\n\nmsdllopt[.]com\n\n**[+] Unique URI paths**\n\n**# Below URI paths are appended to the domain names by the malware while sending**\n**POST requests**\n\n/actions/async.php\n\n\n-----\n\n/admin/settings.php\n\n/admin/user/controller.php\n\n/admin/loginauth.php\n\n/administrator/index.php\n\n/cms/admin/login.php\n\n/backend/login/ajax_index.php\n\n/wp-admin/media-new.php\n\n/get.php\n\n/auth/login\n\n**[+] Scheduled task names**\n\nUpdateModel Task\n\nPropertyDefinitionSync\n\nSchedule Defrag\n\n## Appendix I\n\n**# Unique strings extracted from the deobfuscated JavaScript**\n\nappdata%\\Microsoft\\FontCache\\CloudFonts\\Fonts\n\nSchedule.Service\n\nSELECT UUID FROM Win32_ComputerSystemProduct\n\nSELECT Version FROM Win32_OperatingSystem\n\n%USERDOMAIN%\n\n%USERNAME%\n\nMUID\n\nUpdateModel Task\n\n/c start /min \"\" powershell -inputformat none -outputformat none -windowstyle hidden -c\n\n%localappdata%\\DELL\\DellMobileConnect\\Dumps\\TechToolkit.exe\n\n\n-----\n\n%localappdata%\\DELL\\DellMobileConnect\\Dumps\n\nPropertyDefinitionSync\n\nPT5H\n\n%appdata%\\Mael Horz\\HxD Hex Editor\\Logs\\nvapiu.exe\n\n%appdata%\\Mael Horz\\HxD Hex Editor\\Logs\n\nSchedule Defrag\n\nPT5H\n\nMetadataRefreshTask\n\nWsSwap AssessmentTask\n\nU64Pan.exe\n\ncmd /c \"\"ping 1.1.1.1 -n 5 -w 10000 > nul & del /q\n\navast\n\navg\n\nAntiVirusProduct\n\nSerenadeDACplApp.exe\n\nWestern Digital\\WD Backup\\Storage\n\ncalcy\n\nSupportAssistAppWire.exe\n\nE4A6450B\n\nwctXSPKB.tmp\n\nmsdcat\n\n## Appendix II\n\n**# Runtime strings present inside the unpacked backdoor binary**\n\n/admin/settings.php\n\n/admin/index.php\n\n\n-----\n\n/actions/authenticate.php\n\n/index.php\n\n/actions/async.php\n\n/wp-admin/media-new.php\n\n/backend/login/ajax_index.php\n\n/administrator/index.php\n\n/admin/login.php\n\n/admin/loginauth.php\n\n/wp-admin/admin-ajax.php\n\n/admin/user/controller.php\n\n/get.php\n\n/cms/admin/login.php\n\nAPISID\n\nSAPISID\n\nSIDCC\n\nMSFPC\n\n__cfruid\n\n_vwo_uuid_v2\n\ncampaign\n\nsource\n\nReferer: http://www.bing.com\n\nReferer: http://www.google.com\n\nReferer: http://www.yahoo.com\n\nReferer: http://www.facebook.com\n\nReferer: http://github.com\n\n\n-----\n\nReferer: http://www.instagram.com\n\nReferer: http://mail.google.com\n\nConnection: keep-Alive\n\nContent-Type: text/plain\n\nAccept-Language: en-US,en;q=0.8\n\nAccept: */*\n\nCookie:\n\nGlobal\\wU3aqu1t2y8uN\n\nntdll.dll\n\nkernel32.dll\n\ncombase.dll\n\nole32.dll\n\nOleAut32.dll\n\nwininet.dll\n\nShell32.dll\n\nShcore.dll\n\nUser32.dll\n\nGdi32.dll\n\n## Appendix III\n\n**# Decryption code for network communication**\n\n#include <Windows.h>\n\n#include <stdio.h>\n\n#define SEED_SIZE 32\n\nVOID DeriveKey(BYTE seed[], BYTE key[]) {\n\nBYTE swapByte = 0;\n\n\n-----\n\nBYTE seedIndex = 0;\n\nBYTE calKeyIndex = 0;\n\n/* Initialize the key array */\n\nfor (int i = 0; i < 256; i++) {\n\nkey[i] = i;\n\n}\n\n/* Calculate XOR key */\n\nfor (int currKeyIndex = 0; currKeyIndex < 256; currKeyIndex++) {\n\ncalKeyIndex = seed[currKeyIndex % SEED_SIZE] + key[currKeyIndex] + calKeyIndex;\n\nswapByte = key[currKeyIndex];\n\nkey[currKeyIndex] = key[calKeyIndex];\n\nkey[calKeyIndex] = swapByte;\n\n}\n\n/* Print the derived XOR key */\n\nfor (int k = 0; k < 256; k++) {\n\nprintf(\"%02x \", key[k]);\n\n}\n\n}\n\nVOID Decrypt(BYTE data[], BYTE key[]) {\n\nBYTE XORKeySize = data[0];\n\nBYTE *XORKey = (BYTE*)data + sizeof(BYTE);\n\nUINT encryptedDataSize = data[sizeof(BYTE) + XORKeySize];\n\nBYTE *encryptedData = (BYTE*)data + (sizeof(BYTE) + XORKeySize + sizeof(UINT));\n\n\n-----\n\nBYTE layer1DecryptedData = (BYTE )malloc(encryptedDataSize);\n\nfor (UINT dataIndex = 0; dataIndex < encryptedDataSize; dataIndex++) {\n\nlayer1DecryptedData[dataIndex] = encryptedData[dataIndex] ^ XORKey[dataIndex %\nXORKeySize];\n\n}\n\nBYTE swapByte = 0;\n\nBYTE calKeyIndex = 0;\n\nBYTE finalKeyIndex = 0;\n\nfor (UINT index = 1; index <= encryptedDataSize; index++) {\n\ncalKeyIndex = key[index] + calKeyIndex;\n\nswapByte = key[index];\n\nkey[index] = key[calKeyIndex];\n\nkey[calKeyIndex] = swapByte;\n\nfinalKeyIndex = key[index] + key[calKeyIndex];\n\nprintf(\"%c \", layer1DecryptedData[index - 1] ^ key[finalKeyIndex]);\n\n}\n\n}\n\nint main() {\n\nBYTE key[256];\n\nBYTE seed[SEED_SIZE] = { // Taken from configuration\n\n0xBD, 0xDE, 0x96, 0xD2, 0x9C, 0x68, 0xEE, 0x06, 0x49,\n\n0x64, 0xD1, 0xE5, 0x8A, 0x86, 0x05, 0x12, 0xB0, 0x9A,\n\n0x50, 0x00, 0x4E, 0xF2, 0xE4, 0x92, 0x5C, 0x76, 0xAB,\n\n0xFC, 0x90, 0x23, 0xDF, 0xC6\n\n};\n\nBYTE data[] = {\n\n\n-----\n\n// Put Base64 decoded encrypted data here in HEX format\n\n};\n\nDeriveKey(seed, key);\n\nprintf(\"\\n\\n\");\n\nDecrypt(data, key);\n\nreturn 0;\n\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-27 - Return of the Evilnum APT with updated TTPs and new targets.pdf"
    ],
    "report_names": [
        "2022-06-27 - Return of the Evilnum APT with updated TTPs and new targets.pdf"
    ],
    "threat_actors": [
        {
            "id": "059b16f8-d4e0-4399-9add-18101a2fd298",
            "created_at": "2022-10-25T15:50:23.29434Z",
            "updated_at": "2025-03-27T02:00:55.431907Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Evilnum"
            ],
            "source_name": "MITRE:Evilnum",
            "tools": [
                "More_eggs",
                "EVILNUM",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "39ea99fb-1704-445d-b5cd-81e7c99d6012",
            "created_at": "2022-10-25T16:07:23.601894Z",
            "updated_at": "2025-03-27T02:02:09.882982Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Jointworm",
                "Operation Phantom in the [Command] Shell",
                "TA4563"
            ],
            "source_name": "ETDA:Evilnum",
            "tools": [
                "Bypass-UAC",
                "Cardinal RAT",
                "ChromeCookiesView",
                "EVILNUM",
                "Evilnum",
                "IronPython",
                "LaZagne",
                "MailPassView",
                "More_eggs",
                "ProduKey",
                "PyVil",
                "PyVil RAT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraPreter",
                "TerraStealer",
                "TerraTV"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535997,
    "ts_updated_at": 1743041511,
    "ts_creation_date": 1656803868,
    "ts_modification_date": 1656803868,
    "files": {
        "pdf": "https://archive.orkl.eu/58037724e123f911fc209732b0a9828439969814.pdf",
        "text": "https://archive.orkl.eu/58037724e123f911fc209732b0a9828439969814.txt",
        "img": "https://archive.orkl.eu/58037724e123f911fc209732b0a9828439969814.jpg"
    }
}