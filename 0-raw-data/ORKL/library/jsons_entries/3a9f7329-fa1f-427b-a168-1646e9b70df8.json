{
    "id": "3a9f7329-fa1f-427b-a168-1646e9b70df8",
    "created_at": "2022-10-25T16:48:22.590658Z",
    "updated_at": "2025-03-27T02:10:49.440402Z",
    "deleted_at": null,
    "sha1_hash": "5146f2c397ee9343d59dec88160bad750d8e4e1c",
    "title": "Amid Rising Magecart Attacks on Online Ordering Platforms, Recent Campaigns Infect 311 Restaurants",
    "authors": "",
    "file_creation_date": "2022-07-18T17:39:55Z",
    "file_modification_date": "2022-07-18T17:42:34Z",
    "file_size": 2278115,
    "plain_text": "### CYBER\n\n THREAT\n\n ANALYSIS\n\n## By Insikt Group®\n\nJuly 19, 2022\n\n# Amid Rising Magecart Attacks on Online Ordering Platforms, Recent Campaigns\n\n\n-----\n\n_Threat actors infect e-commerce websites with Magecart e-skimmers to steal_\n_online shoppers’ payment card data, billing information, and personally identifiable_\n_information (PII). To counter this threat, Recorded Future’s Magecart Overwatch_\n_program monitors hundreds of thousands of e-commerce websites to identify the_\n_presence of e-skimmer infections. This report details 2 recent Magecart campaigns_\n_that targeted 3 restaurant online ordering platforms, leading to the exposure of online_\n_transactions at 311 restaurants. The intended audience is financial institutions’ fraud_\n_and cyber threat intelligence (CTI) teams and e-commerce security professionals._\n\n#### Executive Summary Key Findings\n\nOnline ordering platforms for restaurants enable customers     - The online ordering platforms MenuDrive and\nto make online food orders and allow restaurants to outsource Harbortouch were targeted by the same Magecart\nthe burden of developing an ordering system. While top-end campaign, resulting in e-skimmer infections on 80\nonline ordering platforms like Uber Eats and DoorDash dominate restaurants using MenuDrive and 74 using Harbortouch.\nthe market, there are also hundreds of smaller online ordering This campaign likely began no later than January 18,\nplatforms that serve small, local restaurants — and even small- 2022, and as of this report, a portion of the restaurants\nscale platforms may have hundreds of restaurants as clients. As remained infected; however, the malicious domain used\na result, online ordering platforms have become a high-value for the campaign (authorizen[.]net) has been blocked\ntarget for threat actors conducting Magecart e-skimmer attacks since May 26, 2022.\nbecause compromising a single online ordering platform typically   - The online platform InTouchPOS was targeted by a\nresults in the exposure of online transactions performed at a separate, unrelated Magecart campaign, resulting in\nsignificant portion of the restaurants that use the platform. e-skimmer infections on 157 restaurants using the\n\nplatform. This campaign began no later than November\n\nRecently, we identified 2 separate ongoing Magecart\n\n12, 2021, and as of this report, a portion of the\n\ncampaigns that have injected e-skimmer scripts into the online\n\nrestaurants remain infected and the malicious domains\n\nordering portals of restaurants using 3 separate platforms:\n\n(bouncepilot[.]net and pinimg[.]org) remain active.\n\n[MenuDrive, Harbortouch, and InTouchPOS. Across all 3 platforms,](https://www.menudrive.com/)\nat least 311 restaurants have been infected with Magecart   - We have identified more than 50,000 payment card\ne-skimmers, a number that is likely to grow with additional records that were skimmed from these 311 restaurants\nanalysis. and posted for sale on the dark web. Additional\n\ncompromised records from these restaurants have likely\n\nThe Magecart e-skimmer infections on these restaurants’\n\nbeen, and will continue to be, posted for sale on the dark\n\nwebsites often result in the exposure of customers’ payment card\n\nweb.\n\ndata and PII (their billing information and contact information).\n\n                                   - The tactics, techniques, and procedures (TTPs) and\n\nTo date, we have already identified over 50,000 compromised\n\nindicators of compromise (IOCs) associated with the\n\npayment card records that were exposed from these infected\n\ncampaign targeting InTouchPOS match those of another\n\nrestaurants and posted for sale on the dark web.\n\ncampaign targeting e-commerce websites that do not\nuse a centralized online ordering platform. This related\ncampaign has infected over 400 e-commerce websites\nsince May 2020, with over 30 of the websites still\ninfected as of June 21, 2022.\n\n\n-----\n\n_Figure 1: Restaurants discovered per ordering platform, divided between infected and not infected (Source: Recorded Future)_\n\n\n#### Background\n\nCybercriminals often seek the highest payout for the least\namount of work. This has led them to target restaurants’ online\nordering platforms; when even a single platform is attacked,\ndozens or even hundreds of restaurants can have their\ntransactions compromised, which allows cybercriminals to steal\nvast amounts of customer payment card data disproportionate\nto the number of systems they actually hack. The COVID-19\npandemic has only exacerbated this due to an influx of online\nordering as restaurants’ dine-in options were restricted.\n\nIn May 2021, we reported on [breaches at 5 restaurant](https://geminiadvisory.io/breached-online-ordering-platforms/)\n[online ordering platforms, including Grabull, EasyOrdering, and](https://geminiadvisory.io/breached-online-ordering-platforms/)\neDiningExpress. The latter 2 platforms (as well as MenuDrive,\nHarbortouch, and InTouchPOS) all operate in a similar way:\nthey offer a restaurant-specific ordering application hosted on\nplatform-operated domains. As a result, if threat actors gain\nunauthorized access to a given online ordering platform’s shared\nlibraries, they can modify server-side scripts to affect numerous\nmerchants through a single compromise, as these merchants\noften rely on the same shared libraries.\n\nThis most recent attack was not Harbortouch’s first breach.\nIn 2015, Harbortouch admitted to a data breach exposing an\n[unspecified number of restaurants; cybersecurity blog Krebs on](https://krebsonsecurity.com/2015/05/harbortouch-is-latest-pos-vendor-breach/)\n[Security reported that at least 4,200 stores running Harbortouch](https://krebsonsecurity.com/2015/05/harbortouch-is-latest-pos-vendor-breach/)\nsoftware were compromised.\n\n\n#### Threat Analysis\n\nRecorded Future discovered the MenuDrive and Harbortouch\nMagecart campaign’s e-skimmers on 154 restaurants’ ordering\nwebpages: 80 restaurants hosted on MenuDrive’s domains\norder.menudrive[.]com and orderstart[.]com, and 74 restaurants\nhosted on Harbortouch’s domain holo.harbortouch[.]com. These\n154 infected restaurants represent 32% of the 488 restaurants\nthat Recorded Future determined use either online ordering\nplatform.\n\nBased on transaction analysis of when compromised\npayment cards transacted at the infected restaurants, the\ncampaign began no later than January 18, 2022. The malicious\ne-skimmer loader scripts are still present on a portion of the\nwebsites; however, authorizen[.]net, the malicious domain used\nto host the e-skimmers themselves and receive stolen data, has\nbeen blocked since May 26, 2022. While this means that it is\nhighly likely that online transactions conducted after May 26,\n2022 were not compromised, restaurants using MenuDrive and\nHarbortouch remain at high risk until the underlying vulnerabilities\nare remediated.\n\nThe InTouchPOS Magecart campaign’s e-skimmers appeared\non 157 restaurants’ ordering webpages. Based on file modification\ndata contained in the e-skimmer scripts, this campaign began\nno later than November 12, 2021, and a significant portion of the\nrestaurants remain infected as of this writing. Magecart analysis\nof the restaurants’ portals revealed that 135 of the restaurants\nwere victimized through the malicious domain bouncepilot[.]net\nand 22 through the malicious domain pinimg[.]org. As detailed\nbelow in the “Campaign Analysis” section for InTouchPOS, both\nof these malicious domains have been attributed to a single\nMagecart campaign.\n\n\n-----\n\n##### Campaign Analysis\n\n MenuDrive and Harbortouch\n\nUsing open-source intelligence (OSINT) search techniques,\nwe identified 369 restaurants with ordering portals hosted\non MenuDrive domains and 123 with ordering portals hosted\non Harbortouch domains. In analyzing these ordering portal\nwebpages, we identified 154 victimized restaurants: 80 on\nMenuDrive and 74 on Harbortouch.\n\nMost of the MenuDrive victims were small, local restaurants\nthat chose to rely on third-party software rather than design their\nown checkout webpages. We determined that 3 of the victim\nrestaurants on the MenuDrive platform were infected at some\npoint prior to March 18, 2022, with the earliest exposure likely\noccurring on January 18, 2022. As the infection on Harbortouch\nonly appears in the checkout webpage, which cannot be reached\nwithout an item in the shopping basket, internet history had no\nrecords for prior instances of these webpages.\n\nTherefore, based on the analysis and limited historical\ninternet history, it is highly likely that the campaign began no\nlater than January 18, 2022. As we continue to uncover additional\nmerchant data for the infected restaurants, we will work with\npartner financial institutions to further refine the affected\nrestaurants’ full exposure windows.\n\nThe infections of MenuDrive and Harbortouch are linked\nto a single Magecart campaign. The e-skimmer infections for\nthe victimized restaurants’ webpages are highly similar in their\nstructure and all send stolen data to the same exfiltration domain\n(authorizen[.]net), indicating that the same threat actors are most\nlikely behind both attacks. On May 16, 2022, the FBI published\nan [alert regarding attacks related to the domain authorizen[.]](https://www.ic3.gov/Media/News/2022/220516.pdf)\nnet. The key differences between the e-skimmers on MenuDrive\nvictims versus Harbortouch victims are:\n\n  - The MenuDrive e-skimmer is directly injected into a\n\ngiven restaurant’s main webpage on 1 of the 2 MenuDrive\nrestaurant hosting domains (order.menudrive[.]com and\norderstart[.]com). The e-skimmer itself uses 2 scripts\nto collect data: 1 for payment card data and 1 for each\ncardholder’s name, phone number, and email address.\n\n  - The Harbortouch e-skimmer is injected into a given\n\nrestaurant’s checkout webpage on the Harbortouch\nrestaurant hosting domain (holo.harbortouch[.]com). The\ne-skimmer uses a single script to collect both sets of\ndata.\n\n\nAlthough the current campaign targeting MenuDrive and\nHarbortouch restaurants appears to have begun no later than\nJanuary 2022, the Magecart threat actors behind this campaign\nhave likely been active since at least March 2021, based on an\ne-skimmer identified on the e-commerce website hairfinity[.]com\nin an unrelated campaign. This e-skimmer contained 2 indicators\nlinking the infection to the Magecart group responsible for the\nMenuDrive and Harbortouch campaign:\n\n  - The exfiltration domain authorizen[.]net was used.\n\n  - The exfiltration filename was hai[.]php, consistent with\n\nthe 3-letter naming scheme observed in the current\nMenuDrive and Harbortouch campaign.\n\n##### InTouchPOS\n\nUsing OSINT techniques, analysts discovered 157 restaurants\nthat use InTouchPOS as their online ordering platform. Magecart\nanalysis revealed that all 157 of the restaurants were infected\nwith Magecart e-skimmer infections. A large number of the\nvictims were located in California (90), followed by Florida (19)\nand Ohio (17), most of which are pizzerias.\n\nThe majority of victims (135) were associated with the\nattacker domain bouncepilot[.]net, with the remainder (22)\nassociated with pinimg[.]org. The design, functionality, and\nobfuscation methods of the e-skimmers hosted on bouncepilot[.]\nnet and pinimg[.]org were identical (except for the use of different\nmalicious domains for hosting the e-skimmer and exfiltrating\nstolen data), thereby linking each set to a single campaign.\n\nBased on the file modification timestamps for files containing\nthe malicious e-skimmer scripts, the Magecart campaign\ntargeting InTouchPOS began no later than November 12, 2021.\nHowever, the majority of the restaurants’ ordering portals on\nInTouchPOS became infected in January 2022. As of this report,\na portion of the restaurants remain infected and the malicious\ndomains (pinimg[.]org and bouncepilot[.]net) remain active.\n\nFurthermore, the e-skimmer in this campaign resembles\none that Recorded Future found earlier this year. The scripts’\nlogical structure, variable naming, obfuscation, and encryption\nalgorithm all have a high level of overlap, indicating that the\nInTouchPOS threat actors are likely also responsible for the\nearlier campaign. The earlier campaign dates back to May 2020,\nand prior to InTouchPOS’s infection, over 50 malicious domains\ninfected more than 400 victim merchants. As of June 21, 2022,\nthe earlier campaign is still ongoing with over 30 of the merchants\nstill infected. We continue to track this campaign.\n\n\n-----\n\n_Figure 3: Known InTouchPOS victim restaurant locations (Source: Recorded Future)_\n\n_Figure 2: Infected restaurants discovered per ordering platform (red markers are MenuDrive, blue markers are Harbortouch) (Source: Recorded Future)_\n\n\n-----\n\n_Figure 4: Screenshot of infection on MenuDrive platform showing the e-skimmer JavaScript (blue highlight) and exfiltration URL (green highlight) (Source: Recorded Future)_\n\n\n##### E-Skimmer Technical Analysis\n\n MenuDrive E-Skimmer\n\nFor the MenuDrive infections, the e-skimmer is directly\ninjected into the victim restaurant’s platform-specific main\nwebpage.\n\n\nThe e-skimmer attaches itself to the “onmousedown” event\nfor elements with the class “theme-btn”. This results in the\ne-skimmer responding to clicks of multiple buttons during the\naccount creation and checkout processes. The e-skimmer\ncollects elements with the following identifiers or names: “cc_\n```\nnumber”, “ex_month”, “ex_year”, “cvv2”, “cc_address”, and\n\n```\n“cc_zip”. It also attaches data from “nmem” retrieved from local\nstorage (explained below).\n\nRecorded Future found a secondary <script> element within\nthe victim restaurant’s HTML that contained JavaScript to collect\nthe “contactname”, “contactphone”, and “contactemail”\nelements, which it stores in “nmem” (referenced above).\n\n\n-----\n\n_Figure 6: Screenshot of secondary JavaScript used to collect customer PII for infections on the MenuDrive platform (Source: Recorded Future)_\n\n##### Harbortouch E-Skimmer\n\nThe e-skimmer used on Harbortouch victims is similar to\nthat used on MenuDrive, although it collects all customer PII and\npayment card data in a single script. The Harbortouch e-skimmer\nattaches to the “onmousedown” event of the element named\n“checkout_submit” (Harbortouch platform’s “Submit Order”\nbutton).\n\n_Figure 7: Screenshot of infection on Harbortouch platform showing e-skimmer JavaScript (blue highlight) and exfiltration URL (green highlight) (Source: Recorded Future)_\n\n\n-----\n\n_Figure 8: Screenshot of e-skimmer JavaScript used on Harbortouch victims (Source: Recorded Future)_\n\nAs can be seen in the JavaScript above, both e-skimmers\nexfiltrate the stolen data to a PHP webpage on authorizen[.]net.\nThe name of the PHP file reflects the source platform (ord[.]php\nfor MenuDrive and har[.]php for Harbortouch). The e-skimmer\nstructures the data for exfiltration using the “|” (pipe) character\nas a delimiter (Figure 9).\n\n_Figure 9: Screenshot of exfiltration traffic showing pipe-delimited data (Source: Recorded Future)_\n\n##### InTouchPOS E-Skimmer\n\nIn the Magecart attack, the threat actors injected a firststage downloader into an in-use JavaScript file hosted on the\nvictim restaurant’s platform-specific main page. The loader is\ndesigned to immediately retrieve and execute the e-skimmer\nscript.\n\n\n-----\n\n_Figure 10: Screenshot of infection on InTouchPOS platform showing the first-stage loader injected into an in-use JavaScript file (red box) and the e-skimmer URL (green highlight)_\n_(Source: Recorded Future)_\n\n\nThe malicious JavaScript declares several functions that make\nup the functionality of the e-skimmer. After the declarations, the\nscript uses the “setInterval” function to schedule 2 routines:\none that checks the user’s current location within the website,\nand another that resets the webpage to its normal behavior once\nthe e-skimming process has completed. If certain conditions are\nmet to indicate a customer is checking out via payment card, the\nfirst scheduled routine creates a fake payment form that collects\nthe payment card data.\n\n_Figure 11: Screenshot of the data exfiltration function (Source: Recorded Future)_\n\n\nCalled on a timed interval, the first function checks for the\npresence of the cookie value “product_data_storage-id”,\nwhich indicates the submit button was pressed. If this value is\nfound, the second function is called to remove the fake payment\nform and display the legitimate form. Upon return from this\nsecondary call, the value `“isShowIframe” variable is set to`\nfalse, indicating the fake payment card form has been removed.\nThe exfiltration function sends the stolen payment card data to\nthe hacker’s server.\n\n\n-----\n\n#### Mitigations\n\nAs the current MenuDrive and Harbortouch infections exist\nwithin a subdirectory on the platforms’ domains, many public\nwebsite security scanners may not discover its presence.\nAdditionally, the appearance of the Harbortouch infection only\nwithin the validated checkout webpage may further inhibit public\nsecurity scanners. These difficulties reinforce the importance\nof static security scanning of the browser and server-side\ncode of e-commerce websites to ensure attacks such as these\nare detected and remediated. Furthermore, current [PCI-DSS](https://www.pcidssguide.com/pci-dss-requirement-6/)\nstandards require e-commerce websites to inventory JavaScript\non their websites and track traffic in and out of their website,\ndemonstrating an increased emphasis on detection of Magecart\ne-skimmer and other related threats.\n\nThe InTouchPOS infection’s downloader exists within an inuse JavaScript file hosted on the platform’s server, so it should\nbe easily identifiable by most security scanners. Additionally,\ncode/script version control software checks would have shown\na difference between the original JavaScript file and the infected\nversion.\n\n\n#### Outlook\n\nCentralized ordering platforms servicing multiple merchants\noffer a unique opportunity for Magecart threat actors to collect\ncustomer PII and payment card data. The first campaign saw 2\ninfected restaurant ordering platforms with 154 compromised\nrestaurants, and the second campaign saw one infected ordering\nplatform with 157 compromised restaurants. Both of these\ncampaigns demonstrate the amplified effect hackers can expect\nwhen successfully conducting this type of attack.\n\nWe have identified more than 50,000 payment card records\nstolen from these 3 ordering platforms from 311 restaurants\nconfirmed to be compromised. Since current data indicates that\nthe MenuDrive and Harbortouch campaign began at the latest in\nmid-January 2022 and is still ongoing, additional compromised\nrecords from these restaurants have likely been, and will\ncontinue to be, posted for sale on the dark web. Similarly, since\nInTouchPOS’s ongoing campaign began in November 2021 but\nthe majority of its infections occurred in January 2022, more\nrecords will likely continue to appear in the dark web.\n\nCybercriminals’ increasing interest in targeting online ordering\nplatforms represents a new dimension of risk for restaurants.\nWhile they previously needed to worry about securing their own\npoint-of-sale (POS) devices and websites, restaurants must now\ncarefully select online ordering platforms to prioritize security.\nWithout a thorough understanding of these third-party platforms’\nsecurity practices, restaurants are at risk of ever-higher levels of\nfraud from hackers and the dark web carding markets.\n\n\n-----\n\nAbout Insikt Group[®]\n\nInsikt Group is Recorded Future’s threat research division, comprising analysts and\n\nsecurity researchers with deep government, law enforcement, military, and intelligence\n\nagency experience. Their mission is to produce intelligence on a range of cyber and\n\ngeopolitical threats that reduces risk for clients, enables tangible outcomes, and prevents\n\nbusiness disruption. Coverage areas include research on state-sponsored threat groups;\n\nfinancially-motivated threat actors on the darknet and criminal underground; newly\n\nemerging malware and attacker infrastructure; strategic geopolitics; and influence\n\noperations.\n\nAbout Recorded Future[®]\n\nRecorded Future is the world’s largest intelligence company. Recorded Future’s\n\ncloud-based Intelligence Platform provides the most complete coverage across\n\nadversaries, infrastructure, and targets. By combining persistent and pervasive\n\nautomated data collection and analytics with human analysis, Recorded Future provides\n\nreal-time visibility into the vast digital landscape and empowers clients to take proactive\n\naction to disrupt adversaries and keep their people, systems, and infrastructure safe.\n\nHeadquartered in Boston with offices and employees around the world, Recorded\n\nFuture works with more than 1,400 businesses and government organizations across\n\nmore than 60 countries.\n\nLearn more at recordedfuture.com and follow us on Twitter at @RecordedFuture.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://go.recordedfuture.com/hubfs/reports/cta-2022-0719.pdf"
    ],
    "report_names": [
        "cta-2022-0719.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5a0483f5-09b3-4673-bb5a-56d41eaf91ed",
            "created_at": "2023-01-06T13:46:38.814104Z",
            "updated_at": "2025-03-27T02:00:02.925972Z",
            "deleted_at": null,
            "main_name": "MageCart",
            "aliases": [],
            "source_name": "MISPGALAXY:MageCart",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041449,
    "ts_creation_date": 1658165995,
    "ts_modification_date": 1658166154,
    "files": {
        "pdf": "https://archive.orkl.eu/5146f2c397ee9343d59dec88160bad750d8e4e1c.pdf",
        "text": "https://archive.orkl.eu/5146f2c397ee9343d59dec88160bad750d8e4e1c.txt",
        "img": "https://archive.orkl.eu/5146f2c397ee9343d59dec88160bad750d8e4e1c.jpg"
    }
}