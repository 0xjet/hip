{
    "id": "4fd76552-7f91-4b41-b15f-66341c84860f",
    "created_at": "2023-01-12T15:00:12.891851Z",
    "updated_at": "2025-03-27T02:14:02.827475Z",
    "deleted_at": null,
    "sha1_hash": "23c4da5ae9f9c3789f291586639fde5041fa974c",
    "title": "2019-07-24 - Winnti analysis",
    "authors": "",
    "file_creation_date": "2022-05-28T21:45:34Z",
    "file_modification_date": "2022-05-28T21:45:34Z",
    "file_size": 123278,
    "plain_text": "# Winnti analysis\n\n**github.com/br-data/2019-winnti-analyse/**\n\nbr-data\n\nFor a number of years now, a group of professional hackers has been busy spying on\nbusinesses all over the world: Winnti. It is believed to be a digital mercenary group controlled\nby China. For the first time, in a joint investigation, German public broadcasters BR and NDR\nare shedding light on how the hackers operate and how widespread they are.\n\nRead the full article on hackers for hire, conducting industrial espionage, here:\n\n**BR24:** [Attacking the Heart of the German Industry.](https://br24.de/winnti/english)\n\n## Background\n\nThe search for affected company networks is mostly build around so-called campaign\n**identifiers. In some instances, Winnti operators wrote the names of their targets directly into**\n[the malware, obfuscated with a rolling XOR cipher. In a first step, we tried to verify the](https://my.safaribooksonline.com/book/networking/security/9780470613030/de-obfuscation/decoding_common_algorithms)\n[information we were provided with, using a (not very good) python script. We then used](https://github.com/br-data/2019-winnti-analyse/blob/master/firsttry_hextoascii.py) [yara](https://yara.readthedocs.io/)\nrules to hunt for Winnti samples. The yara rules we used are included in this repo, hopefully\nthey prove useful to other researchers.\n\n[Another way of finding networks with Winnti infections is this Nmap script by the](https://github.com/TKCERT/winnti-nmap-script)\nThyssenkrupp CERT.\n\n## Analysis\n\n\n-----\n\nAn execellent script for extracting the configuration details from a Winnti sample was written\nby [Moritz Contag. He thankfully allowed us to share it. Here is how to use it:](https://www.syssec.ruhr-uni-bochum.de/chair/staff/mcontag/)\n\n### Requirements\n\nThe script requires `lief in version 0.9 to be installed and thus is currently tied to Python`\n2.7. The dependency can be installed running `pip on the command line:`\n```\npip2 install -r requirements.txt\n\n### Usage\n\n```\nTo extract the configuration of multiple Winnti samples, simply pass the directory to the\nscript. The script will also recurse into subdirectory and blindly try to parse each file it\nencounters.\n\nThe script does not try to identify Winnti samples and might produce incoherent output if the\nsample looks too different. Currently, it tries to parse configuration information stored in the\nexecutable's overlay as well as inline configurations indicated by a special marker. Further, it\nalso tries to repair broken or \"encrypted\" files before processing them.\n\nIt is recommended to name the samples according to their, e.g., SHA-256 hash for better\nidentification.\n\nTo scan a directory called `samples, simply invoke the script as follows:`\n\n\n-----\n\n```\n$ python2 parse.py ./samples\n--------------------------------------------------------------------------------------------------./9c3415507b38694d65262e28f73c3fade5038e455b83d41060f024403c26c9ee: Parsed\nconfiguration (overlay).\n- Size:  0x50E\n- Type:  exe \n- Configuration:\n     +0x000: \"\"\n     +0x304: \"1\"\n     +0x324: \"shinetsu\"\n     +0x356: 4B A0 D6 05 \n     +0x3C2: \"HpInsightEx.dll\"\n     +0x3E2: \"kb25489.dat\"\n     +0x402: \"HPSupportService\"\n     +0x442: \"HP Insight Extension Support\"\n     +0x50A: A9 A1 A5 A6 \n--------------------------------------------------------------------------------------------------./585fa6bbc8bc9dbd8821a0855432c911cf828e834ec86e27546b46652afbfa5e: Parsed\nconfiguration (overlay).\n- Size:  0x048\n- Type:  dll exe \n- Exports: #3\n      GetFilterVersion\n      HttpFilterProc\n      TerminateFilter\n- Configuration:\n     +0x000: \"DEHENSV533-IIS\"\n     +0x020: \"de.henkelgroup.net\"\n     +0x044: 99 DE DF E0 \n\n## Acknowledgments\n\n```\n[Moritz Contag for writing the great script and allowing us to share it](https://www.syssec.ruhr-uni-bochum.de/chair/staff/mcontag/)\n[Silas Cutler who helped us a great deal to corroborate our findings](https://twitter.com/silascutler)\n\n## Contact\n\nBR Data is a data-driven investigative unit at the German public broadcaster Bayerischer\nRundfunk. We are a team of journalists, developers and data scientist. We specialize in dataand document-driven research and interactive storytelling.\n\n\n-----\n\nPlease send us your questions and feedback:\n\nTwitter: [@br_data](https://twitter.com/br_data)\nE-Mail: [data@br.de](http://10.10.0.46/mailto:data@br.de)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-24 - Winnti analysis.pdf"
    ],
    "report_names": [
        "2019-07-24 - Winnti analysis.pdf"
    ],
    "threat_actors": [
        {
            "id": "60b64223-652b-4177-a678-3d675b79cff4",
            "created_at": "2022-10-25T16:07:24.478235Z",
            "updated_at": "2025-03-27T02:02:10.246897Z",
            "deleted_at": null,
            "main_name": "Dark Basin",
            "aliases": [
                "Mercenary.Amanda"
            ],
            "source_name": "ETDA:Dark Basin",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "1a933813-3deb-4d6f-8e0f-33b9187970f9",
            "created_at": "2023-01-06T13:46:39.147547Z",
            "updated_at": "2025-03-27T02:00:03.007913Z",
            "deleted_at": null,
            "main_name": "Dark Basin",
            "aliases": [],
            "source_name": "MISPGALAXY:Dark Basin",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535612,
    "ts_updated_at": 1743041642,
    "ts_creation_date": 1653774334,
    "ts_modification_date": 1653774334,
    "files": {
        "pdf": "https://archive.orkl.eu/23c4da5ae9f9c3789f291586639fde5041fa974c.pdf",
        "text": "https://archive.orkl.eu/23c4da5ae9f9c3789f291586639fde5041fa974c.txt",
        "img": "https://archive.orkl.eu/23c4da5ae9f9c3789f291586639fde5041fa974c.jpg"
    }
}