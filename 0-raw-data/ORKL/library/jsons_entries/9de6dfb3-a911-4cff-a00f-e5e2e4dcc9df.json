{
    "id": "9de6dfb3-a911-4cff-a00f-e5e2e4dcc9df",
    "created_at": "2023-01-12T15:04:38.294852Z",
    "updated_at": "2025-03-27T02:06:07.872453Z",
    "deleted_at": null,
    "sha1_hash": "0e26817b80c8e534c81a2f0a79a48ebf1fbefec0",
    "title": "2021-11-23 - BazarLoader Adds Compromised Installers, ISO to Arrival and Delivery Vectors",
    "authors": "",
    "file_creation_date": "2022-05-28T03:49:05Z",
    "file_modification_date": "2022-05-28T03:49:05Z",
    "file_size": 324332,
    "plain_text": "# BazarLoader Adds Compromised Installers, ISO to Arrival and Delivery Vectors\n\n**[trendmicro.com/en_us/research/21/k/bazarloader-adds-compromised-installers-iso-to-arrival-delivery-vectors.html](https://www.trendmicro.com/en_us/research/21/k/bazarloader-adds-compromised-installers-iso-to-arrival-delivery-vectors.html)**\n\nNovember 23, 2021\n\nAs the installers load, it drops and executes a BazarLoader executable. This is also one of\nthe notable differences from recent BazarLoader arrival mechanisms wherein the malicious\nactors appeared to favor dynamic link libraries (DLL).\n\nFigure 2. As the VLC installer executes, the bundle drops and executes ste.exe, a\nBazarLoader executable\nUsing Trend Micro Vision One, we tracked the installer creating a process, “vlc-3.0.16win3..2.tmp,” after executing ste.exe, which copies the latter executable to the disk and\nexecutes it. It then connects with the command and control (C&C) server and injects a copy\nof itself into a new suspended MS Edge process.\n\nFigure 3. Tracking the BazarLoader executable’s process\n\n\n-----\n\nFigure 4. The ste.exe executable connects to the C&C server via MS Edge\nArrival via ISO file\n\nMeanwhile, we also found a delivery mechanism abusing ISO files, wherein DLL and LNK\nfiles contained inside execute the BazarLoader DLL in it. The LNK file uses a folder icon to\ndeceive the user into double clicking the icon, enabling the file to run the enclosed\nBazarLoader DLL file.\n\nFigure 5. LNK using a folder icon to trick users into double-clicking the BazarLoader DLL\n\n\n-----\n\nIt then calls the export function EnterDLL, a function that BazarLoader has used recently.\nRundll32.exe loads the malicious DLL and communicates with the C&C server, then\nproceeds to spawn a suspended MS Edge process to inject itself into it.\n\nFigure 6. Observing EnterDll, an export\n\nfunction previously used by BazarLoader actors\n\n\n-----\n\nFigure 7. Tracking BazarLoader opening MS Edge and injecting itself to it\nConclusion\n\nThe number of arrival mechanism variations used in BazarLoader campaigns continue to\nincrease as threat actors diversify their attack patterns to evade detection. However, both\ntechniques are noteworthy and still work despite their lack of novelty due to singular\ndetection technologies’ limitations. For instance, while the use of compromised installers has\nbeen observed with other malware, the large file size can still challenge detection solutions\n— such as sandboxes — which may implement file size limits. On the other hand, LNK files\nserving as shortcuts will also likely be obfuscated for the additional layers created between\nthe shortcut and the malicious files itself.\n\nIn addition, the deployment of BazarLoader malware for initial access is a known technique\nfor modern ransomware such as Conti and Ryuk as service affiliates. Aside from these\nknown ransomware families including more tools for entry into their arsenal, other malware\ngroups and ransomware operators may pick up on the additional means, if they have not\nalready done so.\n\nBest practices\n\n\n-----\n\nBazarLoader is an example of a versatile malware delivery mechanism that will likely find\nmore ways to adapt to deceive more users. For details on all the other measures that\n[BazarLoader uses to get into systems, read our technical brief here.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/21/k/bazarloader-adds-compromised-installers-iso-to-arrival-delivery-vectors/tb-bazarloader-looking-in-analyzing-the-infection-chains-stages-and-campaigns.pdf)\n\nHere are some best practices to defend against this threat:\n\nEnable security solutions that allow for visibility in tracking processes of files, allowing\nsecurity teams to detect malicious outgoing and incoming network communication and\ntraffic.\nDownload installers and updates only from their respective official websites and\nplatforms.\n\nTrend Micro solutions\n\nBazarLoader will continue to evolve as an information stealer malware on its own, an initial\naccess malware-as-a-service (MaaS) for other malware operators, and as an enabler for\nsecondary payload delivery for even more disruptive attacks like modern ransomware.\nSecurity teams must make monitoring and tracking for known threats more visible based on\nknown data and use multilayered solutions capable of pattern recognition and behavior\nmonitoring for unknown threats.\n\n[Trend Micro Vision One™ helps detect and block suspicious activity, even those that might](https://www.trendmicro.com/en_us/business/products/detection-response.html)\nseem insignificant when monitored from only a single layer, through multilayered protection\nand behavior detection. It helps spot and block BazarLoader and its other components\n[wherever it might be on the system. Trend Micro Apex One™ employs behavior analysis to](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nprotect systems against malicious scripts, injection, ransomware, and memory and browser\nattacks related to fileless threats from initial access, execution, and C&C communication.\n[Trend Micro Worry-Free™ Business Security can protect users and businesses from](https://www.trendmicro.com/en_us/small-business/worry-free.html)\nBazarLoader by detecting malicious files and spammed messages, JavaScript droppers, and\nDLL loaders, as well as URLs associated with the threat.\n\n[Trend Micro Email Security delivers continuously updated protection to stop spam, malware,](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-security.html)\nspear phishing, ransomware, and advanced targeted attacks before they reach the network.\nIt protects Microsoft Exchange, [Microsoft Office 365, Google Apps, and other hosted and on-](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/cloud-app-security.html)\n[premises email solutions. Trend Micro™](https://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/) [Deep Discovery™ provides detection, in-depth](https://www.trendmicro.com/us/enterprise/security-risk-management/deep-discovery/)\nanalysis, and proactive response to ransomware attacks through specialized engines,\ncustom [sandboxing, and seamless correlation across the entire attack life cycle such as tool](https://blog.trendmicro.com/trendlabs-security-intelligence/deploying-a-smart-sandbox-for-unknown-threats-and-zero-day-attacks/)\ningress, exploits, C&C activities, and lateral movements. Trend Micro™ Deep Discovery™\nEmail Inspector and [InterScan™ Web Security perform custom sandboxing and advanced](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html)\nanalysis techniques to prevent malware from ever reaching end users, especially potentially\nvulnerable users working remotely. These effectively deter potential ransomware attacks that\nare delivered through malicious emails.\n\n\n-----\n\n[Cloud-specific security solutions such as Trend Micro™ Hybrid Cloud Security can help](https://www.trendmicro.com/en_us/business/products/hybrid-cloud.html)\n[protect cloud-native systems and their various layers. Trend Micro Cloud One™ protects](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-migration-security.html)\ncloud-native systems by securing continuous-integration and continuous-delivery (CI/CD)\npipelines and applications. It also helps identify and resolve security issues sooner and\nimproves delivery time for DevOps teams.\n\nIndicators of Compromise (IOCs)\n\nVisit [this page to view the full list of IOCs.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/21/k/bazarloader-adds-compromised-installers-iso-to-arrival-delivery-vectors/IOCs-bazarloader-adds-compromised-installers-ISO-arrival-and-delivery-vectors.txt)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-23 - BazarLoader Adds Compromised Installers, ISO to Arrival and Delivery Vectors.pdf"
    ],
    "report_names": [
        "2021-11-23 - BazarLoader Adds Compromised Installers, ISO to Arrival and Delivery Vectors.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535878,
    "ts_updated_at": 1743041167,
    "ts_creation_date": 1653709745,
    "ts_modification_date": 1653709745,
    "files": {
        "pdf": "https://archive.orkl.eu/0e26817b80c8e534c81a2f0a79a48ebf1fbefec0.pdf",
        "text": "https://archive.orkl.eu/0e26817b80c8e534c81a2f0a79a48ebf1fbefec0.txt",
        "img": "https://archive.orkl.eu/0e26817b80c8e534c81a2f0a79a48ebf1fbefec0.jpg"
    }
}