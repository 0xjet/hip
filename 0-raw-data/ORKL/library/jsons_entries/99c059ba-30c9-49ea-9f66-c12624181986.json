{
    "id": "99c059ba-30c9-49ea-9f66-c12624181986",
    "created_at": "2024-01-13T02:07:33.072921Z",
    "updated_at": "2025-03-27T02:10:20.826636Z",
    "deleted_at": null,
    "sha1_hash": "adc02a61be87eeccc1ea3e3c6a5db73e3946f258",
    "title": "",
    "authors": "",
    "file_creation_date": "2024-01-12T09:30:54Z",
    "file_modification_date": "2024-01-12T09:30:54Z",
    "file_size": 8671470,
    "plain_text": "# Welcome to Goot Camp: Tracking the Evolution of GOOTLOADER Operations\n\n**mandiant.com/resources/blog/tracking-evolution-gootloader-operations**\n\nSince January 2021, Mandiant Managed Defense has consistently responded to GOOTLOADER infections. Threat actors cast a widespread net\nwhen spreading GOOTLOADER and impact a wide range of industry verticals and geographic regions. We currently only attribute\nGOOTLOADER malware and infrastructure to a group we track as UNC2565, and we believe it to be exclusive to this group.\n\nBeginning in 2022, UNC2565 began incorporating notable changes to the tactics, techniques, and procedures (TTPs) used in its operations.\nThese changes include the use of multiple variations of the FONELAUNCH launcher, the distribution of new follow-on payloads, and changes to\nthe GOOTLOADER downloader and infection chain, including the introduction of GOOTLOADER.POWERSHELL. These changes are illustrative\nof UNC2565’s active development and growth in capabilities.\n\nMandiant’s observation of post-compromise GOOTLOADER activity has largely been limited to internal reconnaissance, as these intrusions have\nbeen quickly detected and mitigated.\n\nThis blog post will also cover the various methods used by the malware to obscure its code, as well as provide scripts that can automate the\ndeobfuscation process.\n\n## Infection Chain\n\nGOOTLOADER infections begin with the user searching for business-related documents online, like templates, agreements, or contracts. The\nvictim is lured into visiting a compromised website and downloading a malicious archive that contains a JavaScript file known as GOOTLOADER.\n\nSuccessful execution of the GOOTLOADER file will download additional payloads, FONELAUNCH and Cobalt Strike BEACON or SNOWCONE\nthat will be stored in the registry. These payloads are executed via PowerShell in the later stages.\n\nSince late 2020, GOOTLOADER campaigns have implemented relatively consistent infection chains. However, the infection chain incorporated\nnotable shifts starting in mid-November 2022. Prior to November 2022, the typical GOOTLOADER infection chain consisted of the following:\n\n1. The user visits an UNC2565-compromised site (usually related to business documents) and downloads a malicious ZIP archive.\n2. The malicious ZIP file is saved to the user's Downloads folder.\n3. The user opens the ZIP file and clicks the .JS file inside.\n4. The JS file is launched using WScript.exe.\n5. The WScript.exe process reaches out to three hard coded domains and downloads two payloads that are saved to the registry.\n6. WScript.exe stores the first registry payload (FONELAUNCH) as a value in the path HKCU\\SOFTWARE\\Microsoft\\\n\n_<STRING>\\%USERNAME%0._\n7. WScript.exe stores the second registry payload (usually BEACON) as a value in the path HKCU\\SOFTWARE\\Microsoft\\\n\n_<STRING>\\%USERNAME%._\n8. WScript.exe executes a PowerShell script that decodes and executes the first payload. This payload is a .NET-based launcher that\n\nMandiant tracks as FONELAUNCH.\n9. WScript.exe executes a PowerShell command that creates a scheduled task which executes the same PowerShell script mentioned in the\n\nprevious step. The current account username will be used for the task name, and the task will be set to run when the user logs in.\n10. The first registry payload (FONELAUNCH) decodes and executes the second registry payload, which contains Cobalt Strike BEACON or\n\nSNOWCONE malware.\n\nFigure 1: GOOTLOADER attack chain\n\nIn November 2022, Managed Defense observed a new variant of GOOTLOADER, tracked as GOOTLOADER.POWERSHELL, leveraging a new\ninfection chain. This new variant writes a second .JS file to disk and creates a scheduled task to execute it. The script reaches out to 10 hard\ncoded URLs. The URL request contains encoded data about the host such as running processes and local drives. Follow up activity is similar to\nprevious GOOTLOADER versions where payloads are written to the registry. The attack chain of this new variant is listed as follows:\n\n1. The user visits an UNC2565-compromised site (usually related to business documents) and downloads a malicious ZIP archive.\n2. The malicious ZIP file is saved to the user's Downloads folder.\n\n\n-----\n\n3. The user opens the ZIP file and clicks the .JS file inside. This is a trojanized JavaScript library containing an obfuscated JScript file, which\n\nwill ultimately execute GOOTLOADER.POWERSHELL. Recently observed trojanized JavaScript libraries include jQuery, Chroma.js, and\nUnderscore.js.\n4. The JS file is launched using WScript.exe.\n5. The WScript.exe process creates an inflated file with a .LOG extension to C:\\Users\\%USERNAME%\\AppData\\Roaming\\\n\n_<RANDOM_DIRECTORY>\\<HARD_CODED_FILE_NAME>. The dropper writes more obfuscated JScript code followed by a padding of_\nrandom characters to increase the file size.\n6. The .LOG file is renamed with a .JS file extension.\n7. The dropper creates a scheduled task that executes the new JScript file. The scheduled task is executed immediately after creation but also\n\nserves as a persistence mechanism to run the second JScript file at the next logon.\n8. WScript.exe and CScript.exe launch a PowerShell process that reaches out to 10 hard coded domains.\n\nVictim information collected includes environment variables, Windows OS version, filenames, and running processes. This information\nis Gzip compressed, Base64 encoded, and sent to the command and control (C2) server in the Cookie header.\n9. The C2 returns a payload, which is executed using the Invoke-Expression PowerShell cmdlet. This leads to the download of two payloads\n\ninto registry keys: FONELAUNCH and a secondary payload to be executed by FONELAUNCH (mirroring steps 6 through 10 of the previous\ninfection chain).\n\nFigure 2: GOOTLOADER.POWERSHELL attack chain\n\n## The Evolution of GOOTLOADER Obfuscation\n\nIn addition to observing GOOTLOADER.POWERSHELL, several variants of FONELAUNCH, and a new infection chain, Mandiant has also\nobserved an evolution in the methods used to obfuscate GOOTLOADER. Mandiant currently tracks three obfuscation variants that have been\nleveraged. Beginning in early 2021, GOOTLOADER was distributed as a small JS file with one obfuscated block of code (MD5:\nab1171752af289e9f85a918845859848). These samples have been tracked as obfuscation variant 1 (Figure 3).\n\nFigure 3: GOOTLOADER obfuscation variant 1 in February 2021\n\nAround October 2021, Managed Defense observed GOOTLOADER embedded within trojanized jQuery libraries instead of being on its own, likely\nin attempt to evade detection and hinder analysis (MD5: 82607b68e061abb1d94f33a2e06b0d20). These samples have been tracked as\nobfuscation variant 2 (Figure 4).\n\n\n-----\n\nFigure 4: GOOTLOADER obfuscation variant 2 in October 2021\n\nIn August 2022, Managed Defense observed new samples with slight variations in the obfuscation code. These new samples spread the\nobfuscated string variables throughout the file rather than having them all on the same line (MD5: d3787939a5681cb6d6ac7c42cd9250b5). These\n[GOOTLOADER samples trojanized jit.js file rather than jQuery (Figure 5).](https://github.com/philogb/jit/blob/master/Jit/jit.js)\n\nFigure 5: GOOTLOADER obfuscation variant 2 in August 2022\n\nBeginning in November 2022, Managed Defense observed a new obfuscation variant, tracked as variant 3, with modified infection that is more\ncomplex than the previous variants. This new variant contains additional string variables that are used in a second deobfuscation stage. This new\nvariant has been observed trojanizing several legitimate JavaScript libraries, including jQuery, Chroma.js, and Underscore.js (MD5:\nea2271179e75b652cafd8648b698c6f9).\n\nFigure 6: GOOTLOADER obfuscation variant 3 in November 2022\n\n## GOOTLOADER Obfuscation Variant Comparison\n\nTable 1 compares different obfuscation variants of the GOOTLOADER JavaScript files based on samples observed by Mandiant.\n\n**Variant 1** **Variant 2** **Variant 3**\n\n\nFirst\nObserved\n\nMalicious\nCode\n\n\nFeb 2021 Oct 2021 Nov 2022\n\n\nOne obfuscated block\nof code, easily\nrecognizable.\n\n\nMalicious code has been nested within the\nfile. Early samples had all the variables in one\nblock of code, later samples spread the code\nthroughout the file.\n\n\nMalicious code has been nested throughout the file.\nAdditional string variables added for the second de‐\nobfuscation iteration.\n\n\n-----\n\nPayload (See\nInfection\nChain)\n\n\nGOOTLOADER GOOTLOADER GOOTLOADER.POWERSHELL\n\nTable 1: Comparison between different GOOTLOADER obfuscation variants\n\n\n## Fileless Registry Payloads\n\nThe successful execution of GOOTLOADER will result in the download of two additional payloads, FONELAUNCH and an in-memory dropper\nthat typically delivers BEACON, to the registry paths in Figure 7. These are registry resident malware samples stored in the Windows registry to\nremain persistent and evade detection. GOOTLOADER subsequently launches these payloads in memory.\n\nHKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME%0 (FONELAUNCH)\n\nHKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME% (Secondary registry payload)\n\nHKCU\\SOFTWARE\\Microsoft\\Personalization\\%USERNAME%0 (FONELAUNCH)\n\nHKCU\\SOFTWARE\\Microsoft\\Personalization\\%USERNAME% (Secondary registry payload)\n\nHKCU\\SOFTWARE\\Microsoft\\Fax\\%USERNAME%0 (FONELAUNCH)\n\nHKCU\\SOFTWARE\\Microsoft\\Fax\\%USERNAME% (Secondary registry payload)\n\nHKCU\\SOFTWARE \\Microsoft\\Personalization\\<RANDOM_STRING> (FONELAUNCH & The secondary registry payload)\n\nFigure 7: Payloads downloaded to the registry hive by GOOTLOADER\n\nThe second stage PowerShell script attempts to create a scheduled task (Figure 8) that launches the malicious payloads that were saved to the\nregistry (Figure 9).\n\nFigure 8: Second stage PowerShell script that creates a scheduled task for malware persistence\n\nFigure 9: The Base64 data from Figure 8 is a PowerShell script that reconstructs and executes the first\n\nregistry payload.\n\nThe PowerShell script performs the following steps to execute the FONELAUNCH malware in memory:\n\n1. Query the HKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME%0 registry key\n2. Merge all the registry values together (usually 7 entries)\n3. Replace the \"#\" character with the string \"1000\"\n4. Convert the data from hex to bytes\n5. Load the payload (FONELAUNCH) into memory and execute it\n\n\n-----\n\n### FONELAUNCH\n\nFONELAUNCH is one of the payloads written into the registry by GOOTLOADER. It is a .NET-based loader that loads an encoded payload from\nthe registry into memory.\n\nSince May 2021 Mandiant has observed UNC2565 use three different variants of FONELAUNCH, distinguished by their loading mechanism\n(Table 2). The evolution of FONELAUNCH variants over time has allowed UNC2565 to distribute and execute a wider variety of payloads,\nincluding DLLs, .NET binaries, and PE files.\n\nFONELAUNCH.FAX reads and decodes data from the HKCU\\SOFTWARE\\Microsoft\\Fax\\%USERNAME% registry key. The returned\ncontent is expected to be a .NET assembly, which is loaded at runtime into memory.\n\nFONELAUNCH.FAX establishes its persistence by creating a registry key in the current user registry hive (Figure 10) (MD5:\nd6220ca85c44e2012f76193b38881185).\nFONELAUNCH.PHONE mainly reads and decodes data placed in a specific registry key. The returned data is expected to be a DLL, which\nis loaded via a publicly available DynamicDllLoader project.\n\nInitial samples of FONELAUNCH.PHONE read and decoded data from the HKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME%\nregistry key (MD5: 35238d2a4626e7a1b89b13042f9390e9).\nStarting in October 2022 a subset of FONELAUNCH.PHONE samples read and decoded data from the\n_HKCU\\SOFTWARE\\Microsoft\\Personalization\\%USERNAME% registry key._\nFONELAUNCH.DIALTONE reads and decodes data from the HKCU\\SOFTWARE\\Microsoft\\%USERNAME% registry key. The returned\ncontent is expected to be a PE file, which is injected into a separate process and executed (MD5: aef6d31b3249218d24a7f3682a00aa10).\nNotably, all incidents in which FONELAUNCH.DIALTONE was deployed have led to the execution of SNOWCONE.GZIPLOADER.\n\n**FONELAUNCH.FAX** **FONELAUNCH.PHONE** **FONELAUNCH.DIALTONE**\n\n\n**First**\n**Observed**\n\n**Observed**\n**Registry**\n**Paths**\n\n**Supported**\n**Payload**\n\n\nMay 2021 September 2021 May 2022\n\n\nHKCU\\SOFTWARE\\Microsoft\\Fax\\%USER‐\nNAME%\n\n\nHKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME%\n\nHKCU\n\\SOFTWARE\\Microsoft\\Personalization\\%USERNAME%\n\n\nHKCU\\SOFTWARE\\Microsoft\\%US\n\n\n.NET DLL PE\n\n\n**Persistence** RunOnce registry key None None\n\nTable 2: Comparison between FONELAUNCH variants\n\nFigure 10: FONELAUNCH.FAX persistence mechanism\n\nOpening FONELAUNCH with dnSpy reveals a substitution cipher key that can be used to decode the second registry payload located in the\n_HKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME% registry key._\n\n\n-----\n\nFigure 11: The dnSpy screenshot shows the substitution table and loading function\n\n### The Secondary Registry Payload\n\nThe secondary registry payload written into the registry by GOOTLOADER is a memory-only dropper written in .NET or C++ that decodes an\nembedded payload located in a randomly named function and executes it. Opening the .NET secondary registry payload with dnSpy reveals that\nit will be decoded and eventually launched in memory (Figure 12). Mandiant has observed that in most cases, this is a Cobalt Strike BEACON\npayload.\n\nFigure 12: dnSpy screenshot showing the payload that will be launched in memory\n\n## Deobfuscating GOOTLOADER\n\n[You can download all scripts mentioned in this blog post from the Gootloader repository on GitHub.](https://github.com/mandiant/gootloader)\n\n### GOOTLOADER Obfuscation Variant 1\n\nAs mentioned previously, deobfuscation of GOOTLOADER obfuscation variant 1 is straight-forward. Two iterations of the Python function in\nFigure 13 deobfuscate the contents of the JavaScript file.\n\nFigure 13: deobfuscation function\n\nThe function in the red box contains the relevant code from GOOTLOADER 1 that must be deobfuscated (Figure 14).\n\n\n-----\n\nFigure 14: GOOTLOADER obfuscation variant 1 JS sample\n\nThe result of the first deobfuscation iteration is shown in Figure 15.\n\nFigure 15: First GOOTLOADER deobfuscation iteration\n\nDeobfuscating the code in single quotes again results in the decoded script. Figure 16 shows the result after using the CyberChef “Generic Code\nBeautify” recipe.\n\nFigure 16: Using CyberChef to beautify the code\n\n### GOOTLOADER Obfuscation Variant 2\n\nDespite ultimately using the same decoding function, the updated variant of GOOTLOADER hides itself within over 10,000 lines of code for\nadditional obfuscation.\n\n\n-----\n\nThe regex expression “.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*\\+.*(\\n.*\\=.*\\+.*)*” can be used to find the relevant code block.\n\nFigure 17: Malicious code in the GOOTLOADER obfuscation variant 2 JS file sample\n\nAs shown in Figure 17, the code populates several variables and then concatenates them together. Using the GOOTLOADER 1 script would not\nwork here since there is no “single” string in the obfuscated code.\n\nTruncated sample of the formula:\n\nwabjrw = siyiqs+ektlkoi+nknhti+idkbqxaw+pqxyicj+vzphnjxnkwqcf+yycsvqac+udazlru+rnoyxn+pdolnhb+oznmgnee;\n\nThe following code block shows a different GOOTLOADER variant that uses multiple equals statements to further obfuscate the code:\n\nSdcsd= sdcdscs+sdcsdc; wabjrw =ujmlmdcd+sdcsd\n\nLater samples spread the relevant code throughout the file rather than having it on a single line. However, the variables are still being set in the\nsame order (from the top of the file down) so it is possible to automate the deobfuscation of the script.\n\nAnother distinction between samples is the comment block at the top of the file. Early samples contain “jQuery JavaScript Library” (MD5:\n82607b68e061abb1d94f33a2e06b0d20) whereas later samples contain “Copyright © 2011 Sencha In–. - Author: Nicolas Garcia Belmonte” (MD5:\nd3787939a5681cb6d6ac7c42cd9250b5) (Figure 18 and Figure 19).\n\nFigure 18: Early GOOTLOADER obfuscation variant 2 JS file header\n\nFigure 19: Later GOOTLOADER obfuscation variant 2 JS file header\n\nManually calculating the result of the concatenated variable would be time consuming since there are many variables, and they are declared out\nof order. A better approach is to have a script run the string concatenation code and deobfuscate the result.\n\nThe manual deobfuscation script requires manually finding the relevant code block in the JavaScript file and entering it into the script. This is\n[useful since minor changes in the GOOTLOADER script could break a fully automated script. Detailed deobfuscation instructions can be found in](https://github.com/mandiant/gootloader/blob/main/ManualDecoding.md)\n[the Gootloader GitHub page.](https://github.com/mandiant/gootloader/blob/main/ManualDecoding.md)\n\n\n-----\n\n**Automated Deobfuscation of GOOTLOADER Obfuscation Variant 2 JS**\n\nRather than manually finding the relevant code, the \"GootLoaderAutoJsDecode.py\" script can be used to automate the entire process. The script\nuses the file headers to differentiate between samples and adjust the regex search accordingly. Passing the JavaScript file as a parameter to the\nscript will return a list of all malicious domains, and the deobfuscated code will be written to the file \"DecodedJsPayload.js_\". The script can be\n[found in the Gootloader GitHub page.](https://github.com/mandiant/gootloader/blob/main/GootLoaderAutoJsDecode.py)\n```\n python GootLoaderAutoJsDecode.py evil.js\n\n```\nFigure 20: Result of the decoding script\n\n### GOOTLOADER Obfuscation Variant 3\n\nUnlike previous variants, GOOTLOADER obfuscation variant 3 leverages two obfuscated JavaScript files during its execution. These samples use\na similar method of deobfuscation where multiple string variables are concatenated and decoded. However, an additional decoding routine is\nused to decode the second file that is dropped (Figure 21). Manually decoding these samples is possible but too cumbersome, using an\nautomated script is preferred.\n\nFigure 21: Python version of the decoding routine\n\n**Automated Deobfuscation of GOOTLOADER Obfuscation Variant 3 JS**\n\nThe “GootLoaderAutoJsDecode.py” script can also be used to decode GOOTLOADER obfuscation variant 3 samples. The script uses the new\ndecoding routine to deobfuscate the first file and saves all the relevant output to “GootLoader3Stage2.js_” which is passed back into the script for\n[decoding. Once the script completes, the output is saved to “DecodedJsPayload.js_”, which will resemble Figure 22. The script can be found in](https://github.com/mandiant/gootloader/blob/main/GootLoaderAutoJsDecode.py)\n[the Gootloader GitHub page.](https://github.com/mandiant/gootloader/blob/main/GootLoaderAutoJsDecode.py)\n\nFigure 22: Decoded output showing the C2 domains\n\n## Reconstructing the Registry Payloads\n\nIt is possible to reconstruct the registry payloads depending on where their data resides.\n\n\n-----\n\n### Off Host — Python Script + CSV\n\nThe script “GootloaderRegDecode.py”, combined with a CSV registry export, can be used to automatically reconstruct the payloads. The script\nprovides details on how the CSV file must be formatted, one or both registry payloads can be processed at the same time.\n\nGootloaderRegDecode.py Payload-1-and-2-Reg-Export.csv\n\nGootloaderRegDecode.py Payload-1-Reg-Export.csv\n\nGootloaderRegDecode.py Payload-2-Reg-Export.csv\n\nBoth payloads will be saved to the current directory and an MD5 hash for each payload will be provided.\n\nThis script was tested using a registry export from Redline and Trellix HX triage packages. The script should work with other EDRs directly or with\nslight modification.\n\n### Off Host — CyberChef + Reg Export\n\nCyberChef can be used to extract the payloads from a registry export.\n\n1. Create separate .reg exports of the HKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME%0 and\n\n_HKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME% registry keys. The following commands can be used:_\n\nreg export HKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME%0\\ reg_stage1.reg\n\nreg export HKCU\\SOFTWARE\\Microsoft\\Phone\\%USERNAME%\\ reg_stage2.reg\n\n2. Import the file into CyberChef.\n3. Load the appropriate CyberChef recipe (GootloaderCyberChef-Stage1.recipie) (GootloaderCyberChef-Stage2.recipie).\n4. Save the output.\n\n### On Host — PowerShell Script\n\nThe script “GootloaderWindowsRegDecode.ps1” can be run on a host that currently has the registry keys present. The script can be executed\nagainst the current user, or another user that exists on the system.\n\n#Run against the current user account\n\nGootloaderWindowsRegDecode.ps1\n\n#Run against the JSmith user account\n\nGootloaderWindowsRegDecode.ps1 -User JSmith\n\nBoth payloads will be saved to the current directory and an MD5 hash for each payload will be provided.\n\n## Technical Indicators\n\n_GOOTLOADER ZIP file_\n\n1011b2cbe016d86c7849592a76b72853\n80a79d0c9cbc3c5188b7a247907e7264\nbee08c4481babb4c0ac6b6bb1d03658e\n\n_GOOTLOADER JS file_\n\n82607b68e061abb1d94f33a2e06b0d20\n961cd55b17485bfc8b17881d4a643ad8\naf9b021a1e339841cfdf65596408862d\nd3787939a5681cb6d6ac7c42cd9250b5\nea2271179e75b652cafd8648b698c6f9\nab1171752af289e9f85a918845859848\n\n_Registry Payload 1 (FONELAUNCH)_\n\nFONELAUNCH.FAX\n\nd6220ca85c44e2012f76193b38881185\n\n\n-----\n\nFONELAUNCH.PHONE\n\n35238d2a4626e7a1b89b13042f9390e9\n53c213b090784a0d413cb00c27af6100\n7352c70b2f427ef4ff58128a428871d3\na0b7da124962b334f6c788c27beb46e3\na4ee41bd81dc3b842ddb2952d01f14ed\nd401dc350aff1e3fd4cc483238208b43\nec17564ac3e10530f11a455a475f9763\nf9365bf8d4b021a873eb206ec98453d9\naec78c1ef489f3f4b621037113cbdf81\nFONELAUNCH.DIALTONE\n\n08fa99c70e90282d6bead3bb25c358dc\naef6d31b3249218d24a7f3682a00aa10\n\n_Registry Payload 2_\n\nCobalt Strike BEACON\n\n04746416d5767197f6ce02e894affcc7\n2eede45eb1fe65a95aefa45811904824\n3d768691d5cb4ae8943d8e57ea83cac1\n84f313426047112bce498aad97778d38\n92a271eb76a0db06c94688940bc4442b\nSNOWCONE\n\n328b032c5b1d8ad5cf57538a04fb02f2\n7a1369922cfb6d00df5f8dd33ffb9991\n\n## Network Indicators\n\njonathanbartz[.]com\njp[.]imonitorsoft[.]com\njunk-bros[.]com\nkakiosk[.]adsparkdev[.]com\nkepw[.]org\nkristinee[.]com\nlakeside-fishandchips[.]com\n\n## Cobalt Strike Beacon Backdoor\n\nhxxps://108.61.242[.]65/dot.gif\nhxxps://108.61.242[.]65/submit.php\nhxxps://146.70.78[.]43/fwlink\nhxxps://146.70.78[.]43/submit.php\nhxxps://87.120.254[.]39/ga.js\nhxxps://87.120.254[.]39/submit.php\nhxxps://45.150.108[.]213/ptj\nhxxps://45.150.108[.]213/submit.php\nhxxps://92.204.160[.]240/load\nhxxps://92.204.160[.]240/submit.php\n\n[More atomic indicators may be found in our Mandiant Advantage portal.](https://advantage.mandiant.com/malware/malware--0c0760b0-976d-5331-82e9-bcee24040d39)\n\n## YARA Rules\n\nThe following YARA rules are not intended to be used on production systems or to inform blocking rules without first being validated through an\norganization's own internal testing processes to ensure appropriate performance and limit the risk of false positives. These rules are intended to\nserve as a starting point for hunting efforts to identify FONELAUNCH and GOOTLOADER.POWERSHELL samples; however, they may need\nadjustment over time if the malware family changes.\n\n\n-----\n\n```\nrule M_Launcher_FONELAUNCH_1\n{\n  meta:\n   author = \"Mandiant”\n   description = \"Hunting rule looking for FONELAUNCH.FAX samples.”\n   md5 = \"d6220ca85c44e2012f76193b38881185\"\n  strings:\n   $str_method_a = \"OpenSubKey\" ascii\n   $str_namespace = \"System.Reflection\" ascii\n   $str_method_b = \"[Environment]::GetEnvironmentVariable(\" wide\n   $ilasmx86_sequence_encoding_a = { 0A 06 02 7D [3] 04 00 16 06 }\n   $ilasmx86_sequence_encoding_b = { 72 [3] 70 72 [3] 70 6F ?? 00 00 0A }\n  condition:\n   uint16(0) == 0x5A4D and all of ($str_*) and\n   (\n    $ilasmx86_sequence_encoding_a and #ilasmx86_sequence_encoding_b >= 16\n   )\n}\n\n```\nFONELAUNCH.FAX YARA rule\n```\nrule M_Launcher_FONELAUNCH_2\n{\n  meta:\n   author = \"Mandiant\"\n   description = \"Hunting rule looking for FONELAUNCH.DIALTONE samples.\"\n   md5 = \"aef6d31b3249218d24a7f3682a00aa10\"\n  strings:\n   $ilasmx86_sequence_fprototype_a = { 1F 30 20 1B 00 10 00 28 } \n   $ilasmx86_sequence_fprototype_b = { 26 11 ?? 11 ?? 07 6A 20 ?? 30 00 00 1F 40 28 }\n   $ilasmx86_sequence_encoding_a = { 0A 06 02 7D [3] 04 00 16 06 }\n   $ilasmx86_sequence_encoding_b = { 72 [3] 70 72 [3] 70 6F ?? 00 00 0A }\n  condition:\n   uint16(0) == 0x5A4D and all of ($ilasmx86_sequence_fprototype_*) and\n   (\n    $ilasmx86_sequence_encoding_a and #ilasmx86_sequence_encoding_b >= 16\n   )\n}\n\n```\nFONELAUNCH.DIALTONE YARA rule\n\n\n-----\n\n```\nrule M_Launcher_FONELAUNCH_3\n{\n  meta:\n   author = “Mandiant”\n   description = “Hunting rule looking for FONELAUNCH.PHONE samples.”\n   md5 = \"ec17564ac3e10530f11a455a475f9763\"\n  strings:\n   $str_winfunction = \"LoadLibrary\" ascii\n   $str_registrykey = \"SOFTWARE\\\\\" wide\n   $str_constant = \"PAGE_EXECUTE_READWRITE\" ascii\n   $ilasmx86_sequence_encoding_a = { 0A 06 02 7D [3] 04 00 16 06 }\n   $ilasmx86_sequence_encoding_b = { 72 [3] 70 72 [3] 70 6F ?? 00 00 0A }\n  condition:\n   uint16(0) == 0x5A4D and all of ($str_*) and\n   (\n    $ilasmx86_sequence_encoding_a and #ilasmx86_sequence_encoding_b >= 16\n   )\n}\n\n```\nFONELAUNCH.PHONE YARA rule\n```\nrule M_Downloader_GOOTLOADER_POWERSHELL\n{\n meta:\n  author = \"Mandiant\"\n  description = \"Hunting rule looking for GOOTLOADER.POWERSHELL samples.\"\n  md5 = \"2567a2bca964504709820de7052d3486\"\n strings:\n  $ps_object_a = \".IsLink\" ascii\n  $ps_object_b = \".IsFolder\" ascii\n  $ps_object_c = \".IsFileSystem\" ascii\n  $ps_code_parseresponse = \"[1] -replace\" ascii nocase\n  $ps_code_httpheader = \".Headers.Add(\\\"Cookie:\" ascii nocase\n  $ps_code_concatenatedata = \"([String]::Join(\\\"|\" ascii nocase\n condition:\n  all of ($ps_code_*) and any of ($ps_object_*)\n}\n\n```\nGOOTLOADER.POWERSHELL YARA rule\n\n\n-----\n\n```\n import \"pe\"\n rule M_Hunting_Win_FONELAUNCH\n {\n   meta:\n     author = \"Mandiant\"\n     description = \"Hunting rule looking for suspicious version information metadata observed in FONELAUNCH samples\"\n     md5 = \"35238d2a4626e7a1b89b13042f9390e9\"\n   strings:\n     $m1 = { 49 00 6E 00 74 00 65 00 72 00 6E 00 61 00 6C 00 4E 00 61 00 6D 00 65 00 00 00 70 00 6F 00 77 00 65 00 72\n 00 73 00 68 00 65 00 6C 00 6C 00 2E 00 64 00 6C 00 6C 00 }\n     $m2 = { 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 70\n 00 6F 00 77 00 65 00 72 00 73 00 68 00 65 00 6C 00 6C 00 2E 00 64 00 6C 00 6C 00 }\n   condition:\n     filesize < 15MB and uint16(0) == 0x5a4d and uint32(uint32(0x3C)) == 0x00004550 and\n (pe.version_info[\"OriginalFilename\"] == \"powershell.dll\" or pe.version_info[\"InternalName\"] == \"powershell.dll\" or any of\n\n```\n($m*))\n\n}\n\nFONELAUNCH YARA rule\n\n## Detection Techniques\n\n**Product** **Signature**\n\nTrellix Endpoint Security SUSPICIOUS POWERSHELL USAGE B (METHODOLOGY)\nPowershell Encoded Command\nJS loader extracted from ZIP file\nPotential GootLoader File\nCRITICAL: JS loader extracted from ZIP file\n\nTrellix Endpoint Security (Hunting) WSCRIPT WRITES LARGE REG KEY VALUE (METHODOLOGY)\nEXPLORER LAUNCHING WSCRIPT (METHODOLOGY)\nFILEWRITE TO ARCHIVE (FILETRACKER)\n\nMicrosoft Defender for Endpoint Suspicious PowerShell command line\nSuspicious file launch\nSuspicious JavaScript process\nAn active 'Gootkit' malware in a PowerShell script was detected while executing via AMSI\nAn active 'Gootkit' malware in a PowerShell script was prevented from executing via AMSI\n\nTrellix Network Security Downloader.JS.GOOTLOADER\nBackdoor.BEACON\nM.Malicious.SSL.Certificate.[CobaltStrike]\nM.Malicious.SSL.Certificate.[146473198]\n\n## Malware Definitions\n\n_BEACON_\n\n[BEACON is a backdoor written in C/C++ that is part of the Cobalt Strike framework. Supported backdoor commands include shell command](https://advantage.mandiant.com/malware/malware--448e822d-8496-5021-88cb-599062f74176)\nexecution, file transfer, file execution, and file management. BEACON can also capture keystrokes and screenshots as well as act as a proxy\nserver. BEACON may also be tasked with harvesting system credentials, port scanning, and enumerating systems on a network. BEACON\ncommunicates with a C2 server via HTTP or DNS.\n\n\n-----\n\n_FONELAUNCH_\n\n[FONELAUNCH is a .NET-based loader that loads an encoded payload from registry into memory.](https://advantage.mandiant.com/malware/malware--19cefe8e-b3ce-5d17-a0c4-987d208b1305)\n\n_GOOTLOADER_\n\n[GOOTLOADER is a JavaScript downloader that comes in an obfuscated form. It downloads another JavaScript file which drops and executes the](https://advantage.mandiant.com/malware/malware--0c0760b0-976d-5331-82e9-bcee24040d39)\nintended payload.\n\n_GOOTLOADER.POWERSHELL_\n\n[GOOTLOADER.POWERSHELL is a variant of the GOOTLOADER downloader that was rewritten in PowerShell and retrieves payloads via HTTP.](https://advantage.mandiant.com/malware/malware--84ffef06-5aaa-5691-92f8-a6878809f52c)\nPrior to obtaining the payload, the downloader collects specific victim host information, including current Windows OS version, environment\nvariables, list of files and running processes, and sends this information to one of ten hard-coded C2 URLs. We have observed instances where\nseveral decoy URLs were distributed amongst the list of hard-coded C2s.\n\n_SNOWCONE_\n\n[SNOWCONE is a family of downloaders that retrieve their next stage payloads via HTTP and have historically been observed to download](https://advantage.mandiant.com/malware/malware--5a482a36-511c-5031-8ee3-8f8bc4e76a25)\nICEDID.\n\n## Acknowledgements\n\nNg Choon Kiat, David Lindquist, Yash Gupta, Jonathan Lepore, Tufail Ahmed and Moritz Raabe\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2023/2023.01.26.GOOTLOADER_Operations/Welcome%20to%20Goot%20Camp_%20Tracking%20the%20Evolution%20of%20GOOTLOADER%20Operations%20_%20Mandiant.pdf"
    ],
    "report_names": [
        "Welcome to Goot Camp_ Tracking the Evolution of GOOTLOADER Operations _ Mandiant"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "fc7f0460-0a66-4178-9c5b-75abb22b87b0",
            "created_at": "2023-11-08T02:00:07.15123Z",
            "updated_at": "2025-03-27T02:00:03.19992Z",
            "deleted_at": null,
            "main_name": "UNC2565",
            "aliases": [
                "Hive0127"
            ],
            "source_name": "MISPGALAXY:UNC2565",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1705111653,
    "ts_updated_at": 1743041420,
    "ts_creation_date": 1705051854,
    "ts_modification_date": 1705051854,
    "files": {
        "pdf": "https://archive.orkl.eu/adc02a61be87eeccc1ea3e3c6a5db73e3946f258.pdf",
        "text": "https://archive.orkl.eu/adc02a61be87eeccc1ea3e3c6a5db73e3946f258.txt",
        "img": "https://archive.orkl.eu/adc02a61be87eeccc1ea3e3c6a5db73e3946f258.jpg"
    }
}