{
    "id": "968bbc19-1815-4f95-a24c-f43c843c6113",
    "created_at": "2023-01-12T14:59:17.253629Z",
    "updated_at": "2025-03-27T02:15:46.123329Z",
    "deleted_at": null,
    "sha1_hash": "e949c9d5745f8766fc3ef7b9f207238af8addc18",
    "title": "2020-04-23 - Quick look at Nazar backdoor - Capabilities",
    "authors": "",
    "file_creation_date": "2022-05-28T04:04:54Z",
    "file_modification_date": "2022-05-28T04:04:54Z",
    "file_size": 67175,
    "plain_text": "# Quick look at Nazar's backdoor - Capabilities\n\n**blog.malwarelab.pl/posts/nazar_eyservice/**\n\n## Intro\n\n\nApril 23, 2020\n\n\n[Yesterday at a virtual edition of OPCDE](https://online.opcde.com/) [Juan Andrés Guerrero-Saade disclosed to the world](https://twitter.com/juanandres_gs)\npart of his research on threat groups listed in `Lost in Translation, a leak of Equation`\nGroup tools done by Shadowbrokers in 2017. Shortly after he published an analysis on his\n[blog and shared hashes. During the talk Juan mentioned that he doesn’t really know what](https://www.epicturla.com/blog/the-lost-nazar)\nthe piece of malware, belonging to Nazar APT, actually does so we put some time to find out.\n\n## EYService\n\nEYService (2fe9b76496a9480273357b6d35c012809bfa3ae8976813a7f5f4959402e3fbb6)\nis a main part of the backdoor and its the one we took a look at. This a passive backdoor that\nrelies on, now discontinued, Packet Sniffer SDK (PSSDK) from Microolap. We wont go into\ndetails of communication and how packets from and to c2 are build, this will be a subject of\nfollowing posts. Instead we will present capabilities of this malware. All magic is happening in\n```\n00404F10h where we can find a big if-else tree with various commands id.\n\n```\n**Command** **Action** **Comments**\n\n\n311 prepare/execute\nkeyloger\n\n\nloads %WINSYSDIR%\\hodll.dll calls `instalhook and`\n```\nremovehook from it, saves data to\n\n```\n%WINSYSDIR%\\report.txt\n\n\n139 shutdown os calls ole object via rclsid: F6E5B398-E3DF-496B-A2ADC20FEA30DBFE, riid: DBCB4B31-21B8-4A0F-BC690C3CE3B66D00 - registerd by godown.dll\n\n\n189 prepare/take\nscreen shot\n\n119 prepare/record\naudio\n\n\nloads ViewScreen.dll, calls SaveBitmapToPNGFile, saves\nscreenshot to %CWD%\\z.png\n\nusing mixer* WINAPI, saves recorded audio to\n%WINSYSDIR%\\music.mp3\n\n\n199 list drives Enumerates drives, saves results to\n%WINSYSDIR%\\Drives.txt\n\n200 list files Enumerates files on drive, save results to\n%WINSYSDIR%\\Files.txt\n\n201 read file\n\n209 remove file\n\n\n-----\n\n**Command** **Action** **Comments**\n\n499 list programs Its done by enumerating\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall,\nresults are saved to %WINSYSDIR%\\Programs.txt\n\n599 list available\ndevices\n\n999 ping sends back pong\n\n555 get os info sends back windows version and computer name\n\n315 disable audio\nrecording\n\n312 disable keyloger\n\n313 disable\nscreenshot\n\n666 set unused flag\n\n## Update 27.04.2020\n\nQuick update regarding commands 555, 999, 139\n\n999 - ping\n555 - get os info\n139 - shut down system via godown.dll\n\n## Conclusion\n\nIn this short post we showed a capabilities of a malware used by Nazar APT, clearly\ndesigned with espionage purposes. Stay tune for next part about abusing IP and TCP\nprotocol in order to smuggle commands. In the meantime if you have an interesting piece of\nmalware and need someone to take a look at it don’t hesitate to contact us [contact@malwarelab.pl](http://10.10.0.46/mailto:contact@malwarelab.pl)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-04-23 - Quick look at Nazar backdoor - Capabilities.pdf"
    ],
    "report_names": [
        "2020-04-23 - Quick look at Nazar backdoor - Capabilities.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bf773c52-830b-46e3-aa61-58c82eb323ee",
            "created_at": "2023-01-06T13:46:39.135077Z",
            "updated_at": "2025-03-27T02:00:03.004808Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "MISPGALAXY:Nazar",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f3b19931-3751-4ece-a235-15b397951dc2",
            "created_at": "2022-10-25T16:07:23.889537Z",
            "updated_at": "2025-03-27T02:02:10.015565Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "ETDA:Nazar",
            "tools": [
                "Distribute.exe",
                "EYService",
                "GpUpdates.exe",
                "Microolap Packet Sniffer",
                "TCPDUMP for Windows"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535557,
    "ts_updated_at": 1743041746,
    "ts_creation_date": 1653710694,
    "ts_modification_date": 1653710694,
    "files": {
        "pdf": "https://archive.orkl.eu/e949c9d5745f8766fc3ef7b9f207238af8addc18.pdf",
        "text": "https://archive.orkl.eu/e949c9d5745f8766fc3ef7b9f207238af8addc18.txt",
        "img": "https://archive.orkl.eu/e949c9d5745f8766fc3ef7b9f207238af8addc18.jpg"
    }
}