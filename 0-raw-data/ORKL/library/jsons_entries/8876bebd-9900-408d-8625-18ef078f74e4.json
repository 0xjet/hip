{
    "id": "8876bebd-9900-408d-8625-18ef078f74e4",
    "created_at": "2023-01-12T15:04:01.767825Z",
    "updated_at": "2025-03-27T02:05:25.60096Z",
    "deleted_at": null,
    "sha1_hash": "878d9e19e654361782f5a4cefa8246d093a07675",
    "title": "2019-09-07 - Malicious RATatouille",
    "authors": "",
    "file_creation_date": "2022-05-28T01:27:48Z",
    "file_modification_date": "2022-05-28T01:27:48Z",
    "file_size": 2668960,
    "plain_text": "# Malicious RATatouille ðŸ€\n\n**dissectingmalwa.re/malicious-ratatouille.html**\n\nSat 07 September 2019 in [RATs](https://dissectingmalwa.re/category/rats.html)\n\nRemcos is a commercially sold Remote Adiministration Toolkit (RAT) that is regularly\ndistributed as Spyware\n\nDepending on the licensing model and capabilities Remcos is sold for 58$ to 389$ by the\ncompany (with the pretty fitting name) Breaking Security. Feature-wise the manfacturer's\nwebsite lists: Remote Administration, Support, Surveillance, Anti-Theft and Proxy. In most\ncases the executable is dropped via a boobytrapped Office or XML Document. Of course I\nwill not link to any of their webpages or products since shilling out for cybercriminals would\nbe the last thing I'd do.\n\nInspiration for this blog post came from @wwp96 on Twitter:\n\n[#remcos](https://twitter.com/hashtag/remcos?src=hash&ref_src=twsrc%5Etfw)\n\njkharding2014.myddns[.]rocks\n\ntomharry.ddns[.]net\n\n2c8b1cca4ee54428dffc203b76c4dc30 - Dhl protected.iso\n\n[06469856a9bdecae989b64daf9db09c7 - carved exehttps://t.co/YtsJYbhle9](https://t.co/YtsJYbhle9)\n\n[â€” wwp96 (@wwp96) September 7, 2019](https://twitter.com/wwp96/status/1170332469960331266?ref_src=twsrc%5Etfw)\n\n\n-----\n\nRemcos uses a Control instance (the C&C) and the so-called Agent (the executable that is\ndelivered to the victim). It was first spotted in 2016 when it was being sold on HackForums.\nSince then it was being used in targeted attacks (mostly spear-phishing) against turkish\ngovernment/military contractors or other businesses/individuals in the European Union. The\nAgent is written in C++ (while the Control application is written in Borland Delphi) and is\n[110KB in size. Click here for the AnyRun Analysis.](https://app.any.run/tasks/8c9c6779-0f98-4ab4-b28c-1154f7b489eb/)\n\nOf course it fiddles around in the registry as well. It uses the Key in\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run to bind to the\nsystem startup.\n\nAlthough there are versions of Remcos that are packed with UPX and MPRESS1 this\nsample is not obfuscated in any way.\n\n\n-----\n\nIn terms of network interactions it queries two Dynamic DNS URLs that both point to the\nsame host at 66.154.113[.]142\n\nWith Version 1.7 Pro we've got an old Version of the RAT in our hands which dates back to\n5th of January 2017. The most recent version of the malware according to the changelog is\nV2.4.7. Another thing one usually doesn't get with malware: a 31-page manual. It goes over\nthe features and configuation points the malware has to offer and even includes a \"Terms of\nService\" chapter which states that users have to be notified that there is surveillance\n_software in place and that the use of remcos for illegal activities is forbidden. As if they would_\ncare that their software was probably used in >95% of malicious acts. Judging by the typos\nand a few screenshots I'd attribute this malware to eastern european threat-actors.\n\nThe following Screenshots were captured after decompiling the executable with the\n[retargetable Decompiler retdec by Avast. The decompiled result can be found here.](https://retdec.com/)\n\n\n-----\n\nAs a first step it runs its dropped install script called install.bat and uses a ping to localhost to\nstall the process and make sure it is finished before proceding.\n\nIn terms of Evasion techniques Remcos turns up with detection methods for both Virtualbox\nand Sandboxie.The above example shows the method it employs for Virtualbox via a registry\nkey that is set if the Guest Additions are in place on the guest system. In the same manner it\ntries to call SbieDll.dll to check if Sandboxie is present.\n\nThe Remcos Agent also has debugging functionality via a console window, for example for\nthe communication with the C&C Server.\n\n\n-----\n\nRemcos also employs Process Injection via a static Mutex. This behaviour is often used as a\nsimple way of achieving persistence and to decrease the risk of a possible detection. Most\nversions of the RAT seem to inject into svchost.exe.\n\n\n-----\n\nVia the command & control structure we also get a pretty good look at all the features the\nmalware supports. In this screenshot we can see the file operations, process manipulations\nand window interactions it has to offer to the operator.\n\nAnother \"standard\" feature for RATs is accessing Browser History, cache and password\nstores. In this case Remcos is trying to manipulate user data in Mozilla Firefox.\n\n\n-----\n\nWe also get a Look at the webcam capture module of the RAT which seems to support\ndifferent camera modes. Additionally it also supports audio capture via a built-in microphone.\n\nLastly the malware also has the capabilities to manipulte the system power state depending\non the current priviledges.\n\nAlthough Remcos is not a \"new\" malware by today's definition it is still a serious threat to\nlook out for. In my test it scores 53/68 on [VirusTotal.](https://www.virustotal.com/gui/file/1c3a298dd32da9de457842613dd4f07e0e57131a94bc13d868ffcbbebfab6d63/detection)\n\n## IOCs\n\n### Remcos RAT (SHA256)\n```\n1c3a298dd32da9de457842613dd4f07e0e57131a94bc13d868ffcbbebfab6d63\n11535ea0ba3bf9ed0691b850955ef2613475dfdce7d8a32fa3d2d7ae066de73d\n\n C&C URLs\nhttx://tomharry.ddns[.]net\nhttx://jkharding2014.myddns[.]rocks\nhttx://gratefulheart.ddns[.]net\nhttx://uaeoffice999.warzonedns[.]com\n\n```\n\n-----\n\n### IPs\n```\n66.154.113[.]142\n79.134.225[.]77\n79.134.225[.]81 \n\n Modified Registry Keys\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nremcos --> \"C:\\Users\\admin\\AppData\\Roaming\\remcos\\remcos.exe\" \nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\nUNCAsIntranet --> 0\nAutoDetect --> 1\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-07 - Malicious RATatouille.pdf"
    ],
    "report_names": [
        "2019-09-07 - Malicious RATatouille.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535841,
    "ts_updated_at": 1743041125,
    "ts_creation_date": 1653701268,
    "ts_modification_date": 1653701268,
    "files": {
        "pdf": "https://archive.orkl.eu/878d9e19e654361782f5a4cefa8246d093a07675.pdf",
        "text": "https://archive.orkl.eu/878d9e19e654361782f5a4cefa8246d093a07675.txt",
        "img": "https://archive.orkl.eu/878d9e19e654361782f5a4cefa8246d093a07675.jpg"
    }
}