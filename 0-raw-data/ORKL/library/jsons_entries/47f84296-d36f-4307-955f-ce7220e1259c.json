{
    "id": "47f84296-d36f-4307-955f-ce7220e1259c",
    "created_at": "2023-04-05T02:10:08.538508Z",
    "updated_at": "2025-03-27T02:05:57.094773Z",
    "deleted_at": null,
    "sha1_hash": "eb52ee08af2ec3ca308754d178e34295d45cf62b",
    "title": "2023-03-29 - SmoothOperator - Ongoing Campaign Trojanizes 3CXDesktopApp in Supply Chain Attack",
    "authors": "",
    "file_creation_date": "2023-04-03T08:59:10Z",
    "file_modification_date": "2023-04-03T08:59:10Z",
    "file_size": 314694,
    "plain_text": "# SmoothOperator | Ongoing Campaign Trojanizes 3CXDesktopApp in Supply Chain Attack\n\n**[sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/](https://www.sentinelone.com/blog/smoothoperator-ongoing-campaign-trojanizes-3cx-software-in-software-supply-chain-attack/)**\n\nMarch 29, 2023\n\n**By Juan Andres Guerrero-Saade, Asaf Gilboa, David Acs, James Haughom &**\n**SentinelLabs**\n\n## Executive Summary\n\nAs of Mar 22, 2023 SentinelOne began to see a spike in behavioral detections of the\n3CXDesktopApp, a popular voice and video conferencing software product categorized\nas a Private Automatic Branch Exchange (PABX) platform.\nBehavioral detections prevented these trojanized installers from running and led to\nimmediate default quarantine.\nThe trojanized 3CXDesktopApp is the first stage in a multi-stage attack chain that pulls\nICO files appended with base64 data from Github and ultimately leads to a 3rd stage\ninfostealer DLL still being analyzed as of the time of writing.\nThe compromise includes a code signing certificate used to sign the trojanized\nbinaries.\nOur investigation into the threat actor behind this supply chain is ongoing. The threat\nactor has registered a sprawling set of infrastructure starting as early as February\n2022, but we don’t yet see obvious connections to existing threat clusters.\nMarch 30th, 2023: We have updated our IOCs with contributions from the research\ncommunity.\nMarch 30th, 2023: We can confirm that the MacOS installer is trojanized, as reported\nby [Patrick Wardle. We have identified the limited deployment of a second-stage](https://objective-see.org/blog/blog_0x73.html)\npayload for Mac infections. We have updated our IOCs to reflect MacOS components.\nOur telemetry now sets the earliest infection attempt as March 8th, 2023.\n\n\n-----\n\n## Background\n\n3CXDesktopApp is a voice and video conferencing Private Automatic Branch Exchange\n(PABX) enterprise call routing software developed by 3CX, a business communications\nsoftware company. The company website claims that 3CX has 600,000 customer companies\n[with 12 million daily users. 3CX lists customer organizations in the following sectors:](https://www.3cx.com/pbx/hosted/)\n\nAutomotive\nFood & Beverage\nHospitality\nManaged Information Technology Service Provider (MSP)\nManufacturing\n\nThe 3CX PBX client is available for Windows, macOS, and Linux; there are also mobile\nversions for Android and iOS, as well as a Chrome extension and a Progressive Web App\n(PWA) browser-based version of the client.\n\nPBX software makes an attractive supply chain target for actors; in addition to monitoring an\n[organization’s communications, actors can modify call routing or broker connections into](https://blog.checkpoint.com/2020/11/05/whos-calling-gaza-and-west-bank-hackers-exploit-and-monetize-corporate-voip-phone-system-vulnerability-internationally/)\nvoice services from the outside. There have been other instances where actors use PBX and\n[VOIP software to deploy additional payloads, including a 2020 campaign against Digium](https://unit42.paloaltonetworks.com/digium-phones-web-shell/)\nVOIP phones using a vulnerable PBX library, FreePBX.\n\n## Campaign Overview\n\nAs others have noted, SentinelOne began automatically detecting and blocking the activity\nover the span of the week prior to our active investigation of the campaign\n\n\n-----\n\nSeems like this has progressed into 3cx desktop app is compromised and the\nprevailing theory is that its the wannacry people who are behind it”? So that’s\n[something to keep an eye on I guess… pic.twitter.com/vkVnXtRDd5](https://t.co/vkVnXtRDd5)\n\n[— patrick (@ggstoneforge) March 29, 2023](https://twitter.com/ggstoneforge/status/1641132937264365579?ref_src=twsrc%5Etfw)\n\nAs we actively analyze the malicious installer, we see an interesting multi-stage attack chain\nunfolding. The 3CXDesktopApp application serves as a shellcode loader with shellcode\nexecuted from heap space. The shellcode reflectively loads a DLL, removing the “MZ” at the\nstart. That DLL is in turn called via a named export ‘DllGetClassObject’ with the following\narguments:\n```\n1200 2400 \"Mozilla/5.0 (Windows NT 10.0; Win64; x64)\n\nAppleWebKit/537.36 (KHTML, like Gecko) 3CXDesktopApp/18.11.1197\n\nChrome/102.0.5005.167 Electron/19.1.9 Safari/537.36”\n\n\n```\nas well as the size of this User-Agent string.\n\nThis stage will in turn download icon files from a dedicated Github repository:\n```\nhttps://github[.]com/IconStorages/images\n\n```\nThese ICO files have Base64 data appended at the end. That data is then decoded and\nused to download another stage. At this time, the DLL appears to be a previously unknown\ninfostealer meant to interface with browser data, likely in an attempt to enable future\noperations as the attackers sift through the mass of infected downstream customers. We\nhave issued a takedown request for this repository.\n\nThe final stage (cad1120d91b812acafef7175f949dd1b09c6c21a) implements infostealer\nfunctionality, including gathering system information and browser information from Chrome,\nEdge, Brave, and Firefox browsers. That includes querying browsing history and data from\nthe Places table for Firefox-based browsers and the History table for Chrome-based\nbrowsers.\n\n\n-----\n\nused to query for History and Places tables\n\n## SentinelOne Protects Against SmoothOperator\n\nhttps://youtu.be/jbIGuCG7fyA\n\n## Recommendations\n\n\nInfostealer strings\n\nWatch Video At:\n\n\n-----\n\nFor SentinelOne customers, no action is needed. We ve provided technical indicators to\nbenefit all potential victims in hunting for the SmoothOperator campaign.\n\n## Indicators of Compromise\n\nNote: we have removed soyoungjun[.]com and convieneonline[.]com as they were linked\nbased on inaccurate information from a passive DNS provider. Thank you to Daniel Gordon\nfor the tip.\n\nWe have also added the full list of URIs decrypted from the ICO files previously referenced.\nThanks to [Johann Aydinbas for the excellent work!](https://twitter.com/jaydinbas)\n\nURL github[.]com/IconStorages/images\n\nEmail [email protected][.]me\n\nEmail [email protected][.]me\n\nSHA-1 cad1120d91b812acafef7175f949dd1b09c6c21a\n\nSHA-1 bf939c9c261d27ee7bb92325cc588624fca75429\n\nSHA-1 20d554a80d759c50d6537dd7097fed84dd258b3e\n\nURI https://www.3cx[.]com/blog/event-trainings/\n\nURI https://akamaitechcloudservices[.]com/v2/storage\n\nURI https://azureonlinestorage[.]com/azure/storage\n\nURI https://msedgepackageinfo[.]com/microsoft-edge\n\nURI https://glcloudservice[.]com/v1/console\n\nURI https://pbxsources[.]com/exchange\n\nURI https://msstorageazure[.]com/window\n\nURI https://officestoragebox[.]com/api/session\n\nURI https://visualstudiofactory[.]com/workload\n\nURI https://azuredeploystore[.]com/cloud/services\n\nURI https://msstorageboxes[.]com/office\n\nURI https://officeaddons[.]com/technologies\n\nURI https://sourceslabs[.]com/downloads\n\n\n-----\n\nURI https://zacharryblogs[.]com/feed\n\nURI https://pbxcloudeservices[.]com/phonesystem\n\nURI https://pbxphonenetwork[.]com/voip\n\nURI https://msedgeupdate[.]net/Windows\n\nAdditional Mac Indicators\n\nSHA-1 libffmpeg.dylib\n\n769383fc65d1386dd141c960c9970114547da0c2\n\nSHA-1 3CXDesktopApp-18.12.416.dmg\n\n3dc840d32ce86cebf657b17cef62814646ba8e98\n\nSHA-1 UpdateAgent\n\n9e9a5f8d86356796162cee881c843cde9eaedfb3\n\nURI https://sbmsa[.]wiki/blog/_insert\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-29 - SmoothOperator - Ongoing Campaign Trojanizes 3CXDesktopApp in Supply Chain Attack.pdf"
    ],
    "report_names": [
        "2023-03-29 - SmoothOperator - Ongoing Campaign Trojanizes 3CXDesktopApp in Supply Chain Attack.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1680660608,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1680512350,
    "ts_modification_date": 1680512350,
    "files": {
        "pdf": "https://archive.orkl.eu/eb52ee08af2ec3ca308754d178e34295d45cf62b.pdf",
        "text": "https://archive.orkl.eu/eb52ee08af2ec3ca308754d178e34295d45cf62b.txt",
        "img": "https://archive.orkl.eu/eb52ee08af2ec3ca308754d178e34295d45cf62b.jpg"
    }
}