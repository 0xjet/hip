{
    "id": "8662aa79-3a3a-4055-8279-369ca173652a",
    "created_at": "2023-01-12T15:01:44.610023Z",
    "updated_at": "2025-03-27T02:16:01.150861Z",
    "deleted_at": null,
    "sha1_hash": "7527a3a05e51b4e142d9ed973388113c0058f232",
    "title": "2017-11-07 - REDBALDKNIGHT-BRONZE BUTLER’s Daserf Backdoor Now Using Steganography",
    "authors": "",
    "file_creation_date": "2022-05-28T23:51:18Z",
    "file_modification_date": "2022-05-28T23:51:18Z",
    "file_size": 247207,
    "plain_text": "# REDBALDKNIGHT’s Daserf Backdoor Now Uses Steganography\n\n**blog.trendmicro.com/trendlabs-security-intelligence/redbaldknight-bronze-butler-daserf-backdoor-now-using-**\nsteganography/\n\nNovember 7, 2017\n\nAPT & Targeted Attacks\n\nREDBALDKNIGHT a.k.a BRONZE BUTLER cyberespionage group employ the Daserf\nbackdoor in campaigns. We found that Daserf was not only used on Japanese targets, but\nalso against other countries. We also found versions of Daserf that use steganography.\n\nBy: Joey Chen, MingYen Hsieh November 07, 2017 Read time: ( words)\n\n**_Additional analysis and insights by Higashi Yuka and Chizuru Toyama_**\n\nREDBALDKNIGHT, also known as [BRONZE BUTLER and](http://securityaffairs.co/wordpress/64311/apt/bronze-butler-ttps.html) [Tick, is a cyberespionage group](https://www.scmagazine.com/tick-cyberespionage-group-targets-japanese-firms-using-custom-malware/article/528602/)\nknown to target Japanese organizations such as government agencies (including defense)\nas well as those in biotechnology, electronics manufacturing, and industrial chemistry. Their\ncampaigns employ the Daserf backdoor (detected by Trend Micro as BKDR_DASERF,\notherwise known as Muirim and Nioupale) that has four main capabilities: execute shell\ncommands, download and upload data, take screenshots, and log keystrokes.\n\n\n-----\n\nOur recent telemetry, however, indicates that variants of Daserf were not only used to spy on\nand steal from Japanese and South Korean targets, but also against Russian, Singaporean,\nand Chinese enterprises. We also found various versions of Daserf that employ different\ntechniques and use steganography—embedding codes in unexpected mediums or locations\n(i.e., images)—to conceal themselves better.\n\nLike many cyberespionage campaigns, REDBALDKNIGHT’s attacks are intermittent but\ndrawn-out. In fact, REDBALDKNIGHT has been zeroing in on Japanese organizations as\nearly as 2008—at least based on the file properties of the decoy documents they’ve been\nsending to their targets. The specificity of their targets stems from the social engineering\ntactics used. The decoy documents they use in their attack chain are written in fluent\nJapanese, and particularly, created via the Japanese word processor Ichitaro. One of the\ndecoy documents, for instance, was about the “plan of disaster prevention in heisei 20”\n(Heisei is the current/modern era in Japan).\n\n_Figure 1: File properties of one of the decoy documents that REDBALDKNIGHT sends to_\n_Japanese targets_\n\n_Figures 2: Sample of decoy documents used by REDBALDKNIGHT, employing socially_\n_engineered titles in their spear phishing emails such as “disaster prevention”_\n\n**Attack ChainREDBALDKNIGHT’s attacks typically use spear phishing emails as an entry**\npoint. Their attachments exploit a vulnerability in Ichitaro, as shown above. These are decoy\ndocuments, often used by cyberespionage groups as a distraction while they execute their\nmalware behind the scenes using lures such as “CPR” and “disaster prevention.”\n\nDaserf will be installed and launched on the affected machine once the victim opens the\n[document. Daserf wasn’t well-known until security researchers publicly disclosed it last year,](http://blog.jpcert.or.jp/2017/01/2016-in-review-top-cyber-security-trends-in-japan.html)\nand whose beginnings they’ve traced as far back as 2011. Based on the hardcoded version\nnumber they divulged (Version:1.15.11.26TB Mini), we were able to source other versions of\nthe backdoor (listed in the appendix).\n\n**Fine-tuning DaserfOur analyses revealed Daserf regularly undergo technical improvements**\nto keep itself under the radar against traditional anti-virus (AV) detection. For instance,\nDaserf versions 1.50Z, 1.50F, 1.50D, 1.50C, 1.50A, 1.40D, and 1.40C use encrypted\nWindows application programming interfaces (APIs). Version v1.40 Mini uses the MPRESS\npacker, which provides some degree of protection against AV detection and reverse\nengineering. Daserf 1.72 and later versions use the alternative base64+RC4 to encrypt the\nfeedback data, while others use different encryption such as 1.50Z, which uses the Ceasar\ncipher (which substitutes letters in plaintext with another that corresponds to a number of\nletters, either upwards or downwards).\n\n\n-----\n\nMore notably, REDBALDKNIGHT integrated steganography to conduct second-stage,\ncommand-and-control (C&C) communication and retrieve a second-stage backdoor. This\ntechnique has been observed in Daserf v1.72 Mini and later versions. Daserf’s use of\nsteganography not only enables the backdoor to bypass firewalls (i.e., web application\nfirewalls); the technique also allows the attackers to change second-stage C&C\ncommunication or backdoor faster and more conveniently.\n\n**How REDBALDKNIGHT Employs SteganographyDaserf’s infection chain accordingly**\nevolved, as shown below. It has several methods for infecting its targets of interest: spear\n[phishing emails, watering hole attacks, and exploiting a remote code execution vulnerability](https://www.trendmicro.com/vinfo/tmr/?/us/threat-encyclopedia/web-attack/137/watering-hole-101)\n[(CVE-2016-7836, patched last March 2017) in SKYSEA Client View, an IT asset](https://www.jpcert.or.jp/english/at/2016/at160051.html)\nmanagement software widely used in Japan.\n\n_Figure 3: Daserf’s latest execution and infection flow_\n\nA downloader will be installed on ther victim’s machine and retrieve Daserf from a\ncompromised site. Daserf will then connect to another compromised site and download an\nimage file (i.e., .JPG, .GIF). The image is embedded in either the encrypted backdoor\nconfigurations or hacking tool. After their decryption, Daserf will connect to its C&C and await\nfurther commands. Daserf 1.72 and later versions incorporate steganographic techniques.\n\nREDBALDKNIGHT’s use of steganography isn’t limited to Daserf. We also found two of their\ntoolkits employing the same technique—xxmm2_builder, and xxmm2_steganography. Based\non their pdb strings, they’re both components of another REDBALDKNIGHT-related threat,\nXXMM (TROJ_KVNDM), a downloader Trojan that can also act as a first-stage backdoor\nwith its capability to open a shell. While xxmm2_builder allows REDBALDKNIGHT to\ncustomize the settings of XXMM, xxmm2_ steganography is used to hide malicious code\nwithin an image file.\n\nREDBALDKNIGHT’s tool can create, embed, and hide executables or configuration files\nwithin the image file with its tag and encrypted strings via steganography. An encrypted\nstring can be an executable file or a URL. A threat actor will use/upload an existing image\nthat the builder then injects with steganographic code. Additionally, we also found that the\nsteganography algorithm (alternative base64 + RC4) between XXMM and Daserf were the\nsame.\n\n_Figure 4: Code snippets showing Daserf’s decode function, which is the same as XXMM’s_\n\n_Figure 5: Steganography toolkit used by REDBALDKNIGHT for XXMM_\n\n_Figure 6: Snapshots of Daserf’s steganographic code generated by their toolkit_\n\n**MitigationSteganography is a particularly useful technique in purposeful cyberattacks: the**\nlonger their malicious activities stay undetected, the more they can steal and exfiltrate data.\nAnd indeed, the routine is increasingly gaining cybercriminal traction, in varying degrees of\n\n\n-----\n\n[proficiency—from exploit kits,](http://blog.trendmicro.com/trendlabs-security-intelligence/updated-sundown-exploit-kit-uses-steganography/) [malvertising campaigns,](http://blog.trendmicro.com/trendlabs-security-intelligence/microsoft-patches-ieedge-zeroday-used-in-adgholas-malvertising-campaign/) [banking Trojans, and](http://blog.trendmicro.com/trendlabs-security-intelligence/sunsets-and-cats-can-be-hazardous-to-your-online-bank-account/) C&C\ncommunication to even [ransomware. In the case of REDBALDKNIGHT’s campaigns, the use](http://blog.trendmicro.com/trendlabs-security-intelligence/picture-perfect-crylocker-ransomware-sends-user-information-as-png-files/)\nof steganography is further compounded by their use of malware that can better evade\ndetection and analysis.\n\nREDBALDKNIGHT’s continuous campaigns—along with their diversity and scope—highlight\nthe importance of [defense in depth. Organizations can mitigate these threats by enforcing](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/form-strategies-based-on-these-targeted-attack-stages)\nthe principle of least privilege to reduce their opportunities for lateral movement significantly.\n[Network segmentation and](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/protecting-data-through-network-segmentation) [data categorization help in this regard. Mechanisms like access](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/keeping-digital-assets-safe-need-for-data-classification)\n[control and blacklisting as well as intrusion detection and prevention systems help further](http://blog.trendmicro.com/en_us/business/products/network/intrusion-prevention.html)\nsecure the network while whitelisting (e.g., application control) and behavior monitoring help\ndetect and block anomalous activities from suspicious or unknown files. Safeguard the email\ngateway to defend against REDBALDKNIGHT’s spear phishing methods. Disable\nunnecessary and outdated components or plug-ins, and ensure that the system\nadministration tools are used securely, as they can be misused by threat actors. And more\ncrucially, keep the infrastructure and its applications up-to-date to reduce attack surface—\nfrom the gateways and networks to endpoints, and servers.\n\n**[Trend Micro SolutionsTrend Micro™ Deep Discovery™ provides detection, in-depth](http://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection/deep-discovery-threat-intelligence-network-analytics.html)**\nanalysis, and proactive response to today’s stealthy malware and targeted attacks in realtime. It provides a comprehensive defense tailored to protect organizations against targeted\n[attacks and advanced threats through specialized engines, custom sandboxing, and](http://blog.trendmicro.com/trendlabs-security-intelligence/deploying-a-smart-sandbox-for-unknown-threats-and-zero-day-attacks/)\nseamless correlation across the entire attack lifecycle, allowing it to detect threats like\nREDBALDKNIGHT’s attacks even without any engine or pattern update. Trend Micro™ Deep\nSecurity™ and Vulnerability Protection provide virtual patching that protects endpoints from\nthreats that abuses unpatched vulnerabilities. OfficeScan’s Vulnerability Protection shield\nendpoints from identified and unknown vulnerability exploits even before patches are\ndeployed.\n\n[Trend Micro’s suite of security solutions is powered by XGen™ security, which features high-](http://blog.trendmicro.com/en_us/business/products/all-solutions.html)\nfidelity machine learning to secure the gateway and endpoint data and applications. XGen™\nprotects against today’s purpose-built threats that bypass traditional controls, exploit known,\nunknown, or undisclosed vulnerabilities, and either steal or encrypt personally-identifiable\ndata.\n\nA list of the Indicators of Compromise (hashes, C&Cs) related to this research is in\nthis [appendix.](https://documents.trendmicro.com/assets/appendix-redbaldknight-bronze-butler-daserf-backdoor-steganography.pdf)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-11-07 - REDBALDKNIGHT-BRONZE BUTLER’s Daserf Backdoor Now Using Steganography.pdf"
    ],
    "report_names": [
        "2017-11-07 - REDBALDKNIGHT-BRONZE BUTLER’s Daserf Backdoor Now Using Steganography.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbefc37d-475c-4d4d-b80b-7a55f896de82",
            "created_at": "2022-10-25T15:50:23.571783Z",
            "updated_at": "2025-03-27T02:00:55.502112Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "BRONZE BUTLER",
                "REDBALDKNIGHT"
            ],
            "source_name": "MITRE:BRONZE BUTLER",
            "tools": [
                "Mimikatz",
                "build_downer",
                "cmd",
                "ABK",
                "at",
                "BBK",
                "schtasks",
                "down_new",
                "Daserf",
                "ShadowPad",
                "Windows Credential Editor",
                "gsecdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535704,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1653781878,
    "ts_modification_date": 1653781878,
    "files": {
        "pdf": "https://archive.orkl.eu/7527a3a05e51b4e142d9ed973388113c0058f232.pdf",
        "text": "https://archive.orkl.eu/7527a3a05e51b4e142d9ed973388113c0058f232.txt",
        "img": "https://archive.orkl.eu/7527a3a05e51b4e142d9ed973388113c0058f232.jpg"
    }
}