{
    "id": "21a2bb0e-5ca7-478d-8eba-5c23268866c4",
    "created_at": "2023-01-12T14:59:21.755637Z",
    "updated_at": "2025-03-27T02:17:05.830608Z",
    "deleted_at": null,
    "sha1_hash": "6f86e0bf602050f0eed4139ecc71b9cfa7a123e5",
    "title": "2022-04-21 - Threat Thursday- BlackGuard Infostealer Rises from Russian Underground Markets",
    "authors": "",
    "file_creation_date": "2022-05-28T23:25:09Z",
    "file_modification_date": "2022-05-28T23:25:09Z",
    "file_size": 2964756,
    "plain_text": "# Threat Thursday: BlackGuard Infostealer Rises from Russian Underground Markets\n\n**blogs.blackberry.com/en/2022/04/threat-thursday-blackguard-infostealer**\n\nThe BlackBerry Research & Intelligence Team\n\nBlackGuard is one of the latest .NET-based information-stealers to rise to prominence in Russian underground markets.\nThough not as broad in functionality as other infostealers, BlackGuard’s focus is on web browsers, cryptocurrency services,\nand “cold wallets” – crypto wallets that store assets offline for greater security.\n\n[BlackGuard has specific functions to extract critical information from a victim's device, similar to both Arkei and](https://blogs.blackberry.com/en/2022/02/threat-thursday-arkei-infostealer) Bhunt\nScavenger. Additionally, the malware will target VPN clients, instant messaging services, FTP clients and VoIP services.\n\nFollowing a growing trend for modern malware, BlackGuard is sold and distributed as Malware-as-a-Service (MaaS). The\nthreat group behind the malware offers both monthly subscriptions and a lifetime pass to use the malware. (For “lifetime,”\nread “until the malware authors get caught.”)\n\n[While BlackGuard was first observed by researchers at ZScaler, our analysts took a deeper dive to plumb its depths, and in](https://www.zscaler.com/blogs/security-research/analysis-blackguard-new-info-stealer-malware-being-sold-russian-hacking)\nso doing discovered some functions not previously described, including the malware’s features for evaluating high-value\ntargets, and default browser checks. This blog also includes exclusive screenshots taken from the threat actor’s original\nsales thread.\n\n### Operating System\n\n Risk & Impact\n\n\n-----\n\n### Technical Analysis\n\nBlackGuard infostealer fits neatly into the space a few older, discontinued threats have left behind. It provides a degree of\nobfuscation that other malware authors often charge a sizeable add-on fee for, all included at a relatively cheap price. The\nthreat also offers ease of use, as well as ease of procurement, as it’s sold on a variety of different forums.\n\n### Anti-Analysis Checks\n\nOn execution, BlackGuard conducts anti-analysis and anti-detection checks to determine if the malware is being run inside a\nsandbox or on a device with a specific type of antivirus software installed. If the malware detects the presence of any of the\nDynamic-Link Library (.DLL) files listed in the following table, it will attempt to terminate itself, to prevent execution and\nsubsequent detection.\n\n**DLL Name** **Application Name**\n\nSbieDll.dll Sandboxie Sandbox\n\nSxIn.dll 360 Total Security\n\nSf2.dll Avast Antivirus\n\nsnxhk.dll Avast Antivirus\n\ncmdvrt32.dll COMODO Internet Security\n\nBlackGuard will also query \"IP-Whois\" to determine the approximate location of the victim. In some samples of BlackGuard,\nthis function is used to prevent the malware’s execution in specific Eastern European nations, which would appear to confirm\nsuspicions regarding where the malware authors are located.\n\nIn the samples we analyzed, the malware will stop executing if the victim is based in the following countries:\n\nArmenia Moldova\n\nAzerbaijan Tajikistan\n\nBelarus Uzbekistan\n\nKazakhstan Ukraine\n\nKyrgyzstan Russia\n\n### String Obfuscation\n\n\n-----\n\nBlackGuard is built using the .NET programming language, which is easily human readable. To foil this transparency, it\n[makes use of the .NET obfuscator, \"Obfuscar.” This technique is often used in malware – and in legitimate software](https://www.obfuscar.com/)\ndevelopment to prevent unauthorized analysis that might lead to things like cracking and piracy – as an obfuscator makes\nthe source code of a program harder for a human reader to understand.\n\nObfuscar aggregates all of BlackGuard’s string data into a byte array, and then it XORs the data to prevent the strings from\nbeing visible during static analysis. The XOR cipher is a simple additive cipher often used in cryptography.\n\nThe byte array is then de-obfuscated at run-time. All original string references are replaced by function calls that use an\nindex and a length to pull the appropriate string out of the byte array. This action is displayed below in Figure 1.\n\nIn some cases, the strings are also Base64-encoded and therefore need to be decoded after being retrieved from the byte\narray. It’s possible that this has been done specifically for the strings that are more obviously indicative of suspicious activity.\n\nThese strings contain some of the key malicious functions of the malware, and likely have this additional layer of obfuscation\nadded so the decoded version of the strings do not exist in memory for very long. This additional level of obfuscation makes\nit less likely for the malicious activity to be picked up by memory scanners and other detection-based antivirus systems.\n\n\n-----\n\n_Figure 1: Breakdown of string de-obfuscation_\n\n\n-----\n\n### Information Stealing\n\nOnce all the anti-analysis checks are complete, BlackGuard will create a folder in %AppData% to store its stolen\ninformation.\n\nAfter it has created this folder, BlackGuard starts its information-stealer functionality. The malware is designed to have\ndifferent functions carry out various goals of information theft, as shown in Figure 2 below. Once decoded, each function can\nbe then mapped to a specific goal the threat actor wants to achieve.\n\n_Figure 2 - Breakdown of core infostealer functions_\n\n### VPNs\n\nBlackGuard will seek out the presence of two popular Virtual Private Networking (VPN) applications, OpenVPN and\nNordVPN. The threat searches for both applications by looking for their common installation path. It then searches for the\nusername and password in the user data of both applications.\n\n### Victim Device Information\n\nBlackGuard calls multiple functions to collect data from the victim, which is then stored in a file called “information.txt.”\nTargeted data includes the following:\n\nIP address\nCountry/location\nHardware identification (HWID)\nOperating system (OS)\nLog data (of infection)\n\n\n-----\n\nThe malware also has a separate function for taking a screenshot of the victim s screen without their knowledge or consent.\nThis only occurs once during the main info-stealing function of the malware. The screenshot is stored in the %AppData%\ndirectory alongside “information.txt” as “Screen.Png.”\n\n### Browsers\n\nLike many other modern information stealers, BlackGuard has the functionality to obtain stored browser information to\nplunder a victim’s saved login credentials.\n\nBlackGuard attempts to find the following information from the user’s browser:\n\nLogins\nAutofill information\nURL/History\nDownload paths\n\nAs each browser stores its information in a different location, and uses its own method of storage, BlackGuard has specific\nfunctions to tackle info-stealing from the most popular browsers, including the following:\n\nChromium Iridium Epic Privacy Browser\n\nGoogle Chrome 7Star Coz Media Uran\n\nGoogle(x86) Chrome CentBrowser Fenrir Inc Sleipnir5\n\nOpera Software Chedot Catalina Group Citrio\n\nOpera GX Stable Vivaldi Coowon\n\nMozilla Firefox Kometa Liebao\n\nMaple Studio Chrome Plus Elements Browser QIP Surf\n\nOrbitum Comodo Dragon Amigo\n\nTorch Comodo 360Browser\n\nMaxthon3 K-Melon Sputnik\n\nNichrome CocCoc Uran\n\nChromodo Microsoft Edge Brave-Browser\n\n### Message Applications\n\nBlackGuard also targets popular instant messenger (IM) applications for pilfering sensitive information. It achieves this by\nreading information stored in the application’s relevant%AppData% directory.\n\nAs with browser data, each instant messaging application stores its data in different locations, so BlackGuard has individual\nbuilt-in functions to search individual apps.\n\nLet’s look at some examples:\n\n\n-----\n\nFor Telegram s collection function, it checks %AppData% before looking for the presence of Telegram.exe, plus a\nlocally stored %tdata% folder that is generated by the messenger.\nFor Pidgin, the collection function reads the \"accounts.xml\" file and copies the protocol, login, and password.\n\nThe method for stealing data from the other messaging applications is cruder; BlackGuard simply copies all files from each\napp’s respective application directory.\n\n**Application Name** **Application Path**\n\nTelegram %AppData%\\Telegram Desktop\\tdata\n\nPidgin %AppData%\\.purple\\accounts.xml\n\nTox %AppData%\\Tox\n\nElement %AppData%\\Element\\Local Stroage\\leveldb\n\nSignal %AppData%\\Signal\\Local Storage\\\\leveldb\n\nProxifier %AppData%\\Proxifier4\\Profiles\n\n### Discord Versions\n\nDiscord is a relatively new area of interest for malware authors, as it has become one of the most popular Voice-over-IP\n(VoIP) services globally, with over 150 million active monthly users.\n\nBlackGuard will attempt to check for the existence of various versions of Discord on the victim’s machine before exfiltrating\nany user data stored locally, in hopes of finding passwords and accounts.\n\n**Name** **Path**\n\nDiscord Discord\\\\Local Storage\\\\leveldb\n\nDiscord PTB (Public Test Build) Discord PTB\\\\Local Storage\\\\leveldb\n\nDiscord Canary Discord Canary\\\\leveldb\n\n### Cryptocurrency\n\nA primary focus of BlackGuard is stealing cryptocurrency. Like [Arkei infostealer, BlackGuard aims to cover all aspects of](https://blogs.blackberry.com/en/2022/02/threat-thursday-arkei-infostealer)\ncrypto applications, services and wallets, to ensure it is hitting all available crypto targets on the victim’s machine.\n\nAll the crypto resources targeted by BlackGuard are noted below:\n\n### Crypto Wallet Applications\n\n**Wallet name** **Application Path**\n\n\n-----\n\nZcash \\\\Zcash\n\nArmory \\\\Armory\n\nJaxx \\\\com.liberty.jaxx\\\\IndexedDB\\\\file__0.indexeddb.leveldb\n\nExodus \\\\Exodus\\\\exodus.wallet\n\nEthereum \\\\Ethereum\\\\keystore\n\nElectrum \\\\Electrum\\\\wallets\n\nAtomicWallet \\\\atomic\\\\Local Storage\\\\leveldb\n\nGuarda \\\\Guarda\\\\Local Storage\\\\leveldb\n\nZap \\\\Zap\\\\Local Storage\\\\leveldb\n\nBinance \\\\Binance\\\\Local Storage\\\\leveldb\n\natomic_qt \\\\atomic_qt\\\\config\n\nFrame \\\\Frame\\\\Local Storage\\\\leveldb\n\nIo.solarwallet.app \\\\io.solarwallet.app\\\\Local Storage\\\\leveldb\n\nTokenPocket \\\\TokenPocket\\\\Local Storage\\\\leveldb\n\nLitecoin \\\\Litecoin\n\nDash \\\\DashCore\n\n### Chrome Wallets\n\n**Hardcoded Name** **Hardcoded Path** **Extension ID and Link**\n\n\nChrome_Binance \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\fhbohimaelbohpjbbldcngcnapndodjp\\\n\nChrome_Bitapp \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\fihkakfobkmkjojpchpfgcmhfjnmnfpi\n\nChrome_Coin98 \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\aeachknmefphepccionboohckonoeemg\\\n\nChrome_Equal \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\nkbihfbeogaeaoehlefnkodbefgpgknn\\\n\n\n[fhbohimaelbohpjbbldcngcnapndodjp](https://chrome.google.com/webstore/detail/binance-chain-wallet/fhbohimaelbohpjbbldcngcnapndodjp)\n\n[fihkakfobkmkjojpchpfgcmhfjnmnfpi](https://chrome.google.com/webstore/detail/bitapp-wallet/fihkakfobkmkjojpchpfgcmhfjnmnfpi?catego...&hl=et)\n\n[aeachknmefphepccionboohckonoeemg](https://chrome.google.com/webstore/detail/coin98-wallet/aeachknmefphepccionboohckonoeemg)\n\n[nkbihfbeogaeaoehlefnkodbefgpgknn](https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn)\n\n\n-----\n\nChrome_Guild \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\nanjmdknhkinifnkgdcggcfnhdaammmj\\\n\nChrome_Iconex \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\flpiciilemghbmfalicajoolhkkenfel\\\n\nChrome_Math \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\afbcbjpbpfadlkmhmclhkeeodmamcflc\\\n\nChrome_Mobox \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\fcckkdbjnoikooededlapcalpionmalo\\\n\nChrome_Phantom \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\bfnaelmomeimhlpmgjnjophhpkkoljpa\\\n\nChrome_Tron \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\ibnejdfjmmkpcnlpebklmnkoeoihofec\\\n\nChrome_XinPay \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\bocpokimicclpaiekenaeelehdjllofo\\\n\nChrome_Ton \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\nphplpgoakhhjchkkhmiggakijnkhfnd\\\n\nChrome_Metamask \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\nkbihfbeogaeaoehlefnkodbefgpgknn\\\n\nChrome_Sollet \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\fhmfendgdocmcbmfikdcogofphimnkno\\\n\nChrome_Slope \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\pocmplpaccanhmnllbbkpgfliimjljgo\\\n\nChrome_Starc \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\mfhbebgoclkghebffdldpobeajmbecfk\\\n\nChrome_Swash \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\cmndjbecilbocjfkibfbifhngkdmjgog\\\n\nChrome_Finnie \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\cjmkndjhnagcfbpiemnkdpomccnjblmj\\\n\nChrome_Keplr \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\dmkamcknogkgcdfhhbddcghachkejeap\\\n\nChrome_Crocobit \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\pnlfjmlcjdjgkddecgincndfgegkecke\\\n\nChrome_Oxygen \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\fhilaheimglignddkjgofkcbgekhenbh\\\n\nChrome_Nifty \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\jbdaocneiiinmjbjlgalhcelgbejmnid\\\n\n\n[nanjmdknhkinifnkgdcggcfnhdaammmj](https://chrome.google.com/webstore/detail/guildwallet/nanjmdknhkinifnkgdcggcfnhdaammmj)\n\n[flpiciilemghbmfalicajoolhkkenfel](https://chrome.google.com/webstore/detail/iconex/flpiciilemghbmfalicajoolhkkenfel?hl=en)\n\n[afbcbjpbpfadlkmhmclhkeeodmamcflc](https://chrome.google.com/webstore/detail/math-wallet/afbcbjpbpfadlkmhmclhkeeodmamcflc?hl=en)\n\n[fcckkdbjnoikooededlapcalpionmalo](https://chrome.google.com/webstore/detail/mobox-wallet/fcckkdbjnoikooededlapcalpionmalo)\n\n[bfnaelmomeimhlpmgjnjophhpkkoljpa](https://chrome.google.com/webstore/detail/phantom/bfnaelmomeimhlpmgjnjophhpkkoljpa?hl=en)\n\n[ibnejdfjmmkpcnlpebklmnkoeoihofec](https://chrome.google.com/webstore/detail/tronlink/ibnejdfjmmkpcnlpebklmnkoeoihofec)\n\n[bocpokimicclpaiekenaeelehdjllofo](https://chrome.google.com/webstore/detail/xdcpay/bocpokimicclpaiekenaeelehdjllofo)\n\n[nphplpgoakhhjchkkhmiggakijnkhfnd](https://chrome.google.com/webstore/detail/ton-wallet/nphplpgoakhhjchkkhmiggakijnkhfnd)\n\n[nkbihfbeogaeaoehlefnkodbefgpgknn](https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn?hl=en)\n\n[fhmfendgdocmcbmfikdcogofphimnkno](https://chrome.google.com/webstore/detail/sollet/fhmfendgdocmcbmfikdcogofphimnkno?hl=en)\n\n[pocmplpaccanhmnllbbkpgfliimjljgo](https://chrome.google.com/webstore/detail/slope-wallet/pocmplpaccanhmnllbbkpgfliimjljgo)\n\n[mfhbebgoclkghebffdldpobeajmbecfk](https://chrome.google.com/webstore/detail/starmask/mfhbebgoclkghebffdldpobeajmbecfk?hl=en)\n\n[cmndjbecilbocjfkibfbifhngkdmjgog](https://chrome.google.com/webstore/detail/swash/cmndjbecilbocjfkibfbifhngkdmjgog?hl=en)\n\n[cjmkndjhnagcfbpiemnkdpomccnjblmj](https://chrome.google.com/webstore/detail/finnie/cjmkndjhnagcfbpiemnkdpomccnjblmj)\n\n[dmkamcknogkgcdfhhbddcghachkejeap](https://chrome.google.com/webstore/detail/keplr/dmkamcknogkgcdfhhbddcghachkejeap?hl=en)\n\n[pnlfjmlcjdjgkddecgincndfgegkecke](https://chrome.google.com/webstore/detail/crocobit-wallet/pnlfjmlcjdjgkddecgincndfgegkecke)\n\n[fhilaheimglignddkjgofkcbgekhenbh](https://chrome.google.com/webstore/detail/oxygen-atomic-crypto-wall/fhilaheimglignddkjgofkcbgekhenbh?hl=en)\n\n[jbdaocneiiinmjbjlgalhcelgbejmnid](https://chrome.google.com/webstore/detail/nifty-wallet/jbdaocneiiinmjbjlgalhcelgbejmnid?hl=en)\n\n\n-----\n\nChrome_Liquality \\Google\\Chrome\\User Data\\Default\\Local\nExtensionSettings\\kpfopkelmapcoipemfendmdcghnegimn\\\n\n### Edge Wallets\n\n\n[kpfopkelmapcoipemfendmdcghnegimn](https://chrome.google.com/webstore/detail/liquality-wallet/kpfopkelmapcoipemfendmdcghnegimn?hl=en)\n\n\n**Hardcoded**\n**Name**\n\n\n**Hardcoded Path** **Extension ID**\n\n\nEdge_Auvitas \\Microsoft\\Edge\\User Data\\Default\\Local Extension Settings\\\n**klfhbdnlcfcaccoakhceodhldjojboga\\**\n\nEdge_Math \\Microsoft\\Edge\\User Data\\Default\\Local Extension Settings\\\n**dfeccadlilpndjjohbjdblepmjeahlmm\\**\n\nEdge_Metamask \\Microsoft\\Edge\\User Data\\Default\\Local Extension Settings\\\n**ejbalbakoplchlghecdalmeeeajnimhm\\**\n\nEdge_MTV \\Microsoft\\Edge\\User Data\\Default\\Local Extension Settings\\\n**oooiblbdpdlecigodndinbpfopomaegl\\**\n\nEdge_Rabet \\Microsoft\\Edge\\User Data\\Default\\Local Extension Settings\\\n**aanjhgiamnacdfnlfnmgehjikagdbafd\\**\n\nEdge_Ronin \\Microsoft\\Edge\\User Data\\Default\\Local Extension Settings\\\n**bblmcdckkhkhfhhpfcchlpalebmonecp\\**\n\nEdge_Yoroi \\Microsoft\\Edge\\User Data\\Default\\Local Extension Settings\\\n**akoiaibnepcedcplijmiamnaigbepmcb\\**\n\n### FTP Clients\n\n\n[klfhbdnlcfcaccoakhceodhldjojboga](https://microsoftedge.microsoft.com/addons/detail/auvitas-wallet/klfhbdnlcfcaccoakhceodhldjojboga)\n\n[dfeccadlilpndjjohbjdblepmjeahlmm](https://microsoftedge.microsoft.com/addons/detail/math-wallet/dfeccadlilpndjjohbjdblepmjeahlmm)\n\n[ejbalbakoplchlghecdalmeeeajnimhm](https://microsoftedge.microsoft.com/addons/detail/metamask/ejbalbakoplchlghecdalmeeeajnimhm)\n\nOooiblbdpdlecigodndinbpfopomaegl\n(No longer present)\n\n[aanjhgiamnacdfnlfnmgehjikagdbafd](https://microsoftedge.microsoft.com/addons/detail/rabet/aanjhgiamnacdfnlfnmgehjikagdbafd)\n\n[bblmcdckkhkhfhhpfcchlpalebmonecp](https://microsoftedge.microsoft.com/addons/detail/ronin-wallet/kjmoohlgokccodicjjfebfomlbljgfhk)\n(Relisted Link)\n\n[akoiaibnepcedcplijmiamnaigbepmcb](https://microsoftedge.microsoft.com/addons/detail/yoroi/akoiaibnepcedcplijmiamnaigbepmcb)\n\n\nBlackGuard also attempts to search the victim’s device for two known File Transfer Protocol (FTP) services; FileZilla and\nWinSCP. These are both popular freeware applications with over a 100 million active downloads at the time of writing.\n\nBlackGuard will attempt to obtain locally stored information pertaining to the victim’s recent and current FTP servers. It does\nthis to gain access to potentially valuable data the victim has been transferring and interacting with.\n\n### High-Value Target Evaluation\n\nIn the creation of a BlackGuard sample, a threat actor can provide a list of relevant strings for the malware to focus on.\nLocated in the resource section of each sample’s binary, BlackGuard’s final information collection process involves the\ntokenization of these included strings.\n\nThe malware will seek out any references to these relevant strings, iterating through all the data it has gathered. If a string\nmatches, it will be highlighted as a high-value target for the threat actor to note when reviewing successfully exfiltrated data.\n\nThe code for this activity can be seen in the following Figures 3 and 4:\n\n\n-----\n\n_Figure 3 – High-value target evaluation, part 1_\n\n_Figure 4 – High-value target evaluation, part 2_\n\nAs these string lists are defined on the creation of a new sample of BlackGuard, we’ve observed a degree of uniqueness in\nsamples found in the wild. Many of the tokenized strings we’ve found are related to cryptocurrency, banking, and antivirus\nvendor websites.\n\nBy examining the resources of multiple BlackGuard samples, we have created a list of the most common strings targeted:\n\n**String** **Category**\n\n\n-----\n\nadmin Administration\n\nads.google.com Advertising\n\nkaspersky.com Antivirus\n\navast.ru Antivirus\n\nmalwarebytes.com Antivirus\n\nchase.com Banking\n\nsantander.com Banking\n\nwww.hsbc.com Banking\n\nwww.wellsfargo.com Banking\n\nwww.jpmorgan.com Banking\n\nblockchain.com Cryptocurrency\n\ngate.io Cryptocurrency\n\nbitpapa.com Cryptocurrency\n\ncoinpayments Cryptocurrency\n\nton.org Cryptocurrency\n\nbtc.com Cryptocurrency\n\nblock.io Cryptocurrency\n\ncoinbase.com Cryptocurrency\n\npayeer.com Cryptocurrency\n\ncrypto.com Cryptocurrency\n\npaypal.com Online Commerce\n\n$#!3301)&(*&$&*$#!234)&(*&$&*$#!234)& Unknown\n\n&(*&$&*$#!3301)&(*&$&*$#!234)&(*&$&*$#!234)&(*&$&*$#!234) Unknown\n\nAny matches are written to “search_link.txt” and saved to the temporary %AppData% directory along with all other stolen\ninformation.\n\n\n-----\n\nBy viewing screenshots posted on the sales thread created by the malware author, we can identify where these matches are\ndisplayed in the command-and-control (C2) panel, as seen in Figure 5 below.\n\n_Figure 5 – Screenshot of BlackGuard C2 panel_\n\n### Exfiltration to C2\n\nOnce BlackGuard has copied all the information it has gathered into its temporary directory in %AppData%, it zips the\ninformation into a handy RAR archive with a randomly generated name.\n\nThe filename is generated using the country of the victim, as recorded from the IP information previously requested, and\nthen concatenated with a pseudo-random string.\n\nThe string is generated from the following charset: “aytdgirlzxcvbnmasdfghjklqwertyuiopAABBFFGKKDS”\n\nExample: (Ireland)_[SrqFrBDjypKrrielGGoFAkAFt].rar\n\n_Figure 6 – Generation of pseudo-random RAR filename_\n\nThe newly created RAR file is then sent via a POST request to a hardcoded C2 server, as shown in Figure 7. The request\nincludes some basic details to allow the attacker to quickly identify valuable targets, such as the following:\n\nUsername Stolen wallet count\n\nAntivirus Stolen Telegram count\n\nOperating System Stolen VPN count\n\nStolen password count Stolen FTP count\n\nStolen cookie count Country\n\nHigh-value target evaluation result\n\n\n-----\n\n_Figure 7 – Interception of data via a POST Request_\n\n_Figure 8 – POST request of data_\n\nIn the examples shown above, the malware failed to generate the expected filename for the RAR archive, as our malware\nanalysis took place in an offline and closed environment. Therefore, the IP address was not successfully gathered, and the\ngeo-located country is missing from the filename (as seen in Figures 6 and 8).\n\n### Files Sent in POST Request\n\n**Item** **Description**\n\nBrowsers (Directory) Data collected from Opera, Edge and Chrome. Contains cookies, downloads, history and results of\nhigh-value target search.\n\n\nChrome_wallet\n(Directory)\n\nEdge_wallet\n(Directory)\n\n\nData collected from Chrome Wallet extensions (from list above).\n\nData collected from Edge Wallet extensions (from list above).\n\n\nFiles (Directory) Files collected from the user’s profile (desktop, documents, etc.)\n\nTelegram (Directory) Telegram data stolen\n\nInformation.txt Containing information regarding country, HWid, operating system and log date\n\nScreen.png Screenshot of user’s desktop\n\n### Conclusion\n\nAs malware infostealers evolve, so too does the market for them. BlackGuard is a complex threat that still seems to be in\ndevelopment, as seen in Figure 9.\n\n\n-----\n\n_Figure 9 – Malware author update log (translated from Russian to English)_\n\nAs this threat becomes increasingly popular and widely distributed as a MaaS offering, and the malware’s attack vector\nvaries, it’s difficult to map an exact diagram of a typical attack. Each attack is likely to be tailored to the requirements of the\ntarget, so it’s hard to know how this threat is likely to appear in a victim’s environment. Since this threat is priced reasonably\ninexpensively, it gives novice cyber-criminals access to advanced malware for a nominal fee.\n\nIt has become more common in recent years for people to store financial information and cryptocurrency data on their\ndevices, for the sake of ease and convenience. This makes information-stealing from these devices an extremely rewarding\npursuit for profit-driven threat actors. This is true whether the target is an individual or part of a larger enterprise.\n\nWith BlackGuard’s primary laser-focus on cryptocurrency data and wallet information, it is critical for crypto enthusiasts to\nadd more effective security measures to their endpoints.\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to catch the threat described in this\ndocument:\n\n\n-----\n\nimport \"pe\"\n\nrule Mal_Infostealer_Win32_BlackGuard\n\n{\nmeta:\n\ndescription = \"Detects W32 BlackGuard Infostealer\"\n\nauthor = \"BlackBerry Threat Research team \"\n\ndate = \"2022-14-04\"\n\nsha256 = \"6AB3B21FA7CB638ED68509BE1ED6302284E8A9CD1A10F9B6837C057154AA6162\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0 (https://www.apache.org/licenses/LICENSE-2.0)\nand open to any user or organization, as long as you use it under this license and ensure originator credit in any derivative\nto The BlackBerry Research & Intelligence Team\"\n\nstrings:\n$a1 = { 06 91 06 61 20 AA 00 00 00 61 D2 9C 06 17 58 0A }\n\n$a2 = \"System.Data.SQLite\"\n\n$a3 = \"FromBase64String\"\n\n$a4 = \"BlockInput\"\n\n$a5 = \"UploadFile\"\n\n$a6 = \"Passwords\"\n\n$a7 = \"Discord\"\n\n$a8 = \"GetVolumeInformationA\"\n\n$a9 = \"NordVPN\"\n\n$a10 = \"OpenVPN\"\n\n$a11 = \"ProtonVPN\"\n\n$a12 = \"OperaCookies\"\n\n$a13 = \"EdgeCookies\"\n\n$a14 = \"ChromeCookies\"\n\n$b1 = \"upche\" wide\n\ncondition:\n\nuint16(0) == 0x5a4d and\n\npe.imphash() == \"f34d5f2d4577ed6d9ceec516c1f5a744\" and\n\npe.number_of_sections == 3 and\n\npe.section_index(\".text\") == 0 and\n\npe.section_index(\".rsrc\") == 1 and\n\npe.section_index(\".reloc\") == 2 and\n\n((all of ($a*)) or ((12 of ($a*) and all of ($b*))))\n\n}\n\n### Indicators of Compromise (IoCs)\n\n**SHA256:**\n\n3df93a8c2843f1e91c7625685fbc4a7fc9438d8debf765d5a5bf9c62dbed6aef\n\n6ab3b21fa7cb638ed68509be1ed6302284e8a9cd1a10f9b6837c057154aa6162\n\nac6fb63231a7cfc8380400721b6b2be8fd4c65f10947edb8b500f5779441338b\n\naadec91cc7481998ba59f2ad65005144417c7bde5e28114fc57cd04ee3551be8\n\n8b6a82bd10fc3cab378e9c2023bee639ed81d1ee02fb882b8601f451466d76bf\n\n**C2 Domains:**\n\nhXXps://greenblguard[.]shop\n\nhXXps://win[.]mirtonewbacker[.]com\n\nhXXps://skazkahoho[.]space\n\nhXXps://fuzzyjazz[.]me\n\n### BlackBerry Assistance\n\nIf you’re battling this malware or a similar threat, you’ve come to the right place, regardless of your existing BlackBerry\nrelationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to handling response and](https://www.blackberry.com/us/en/services/incident-response)\ncontainment services for a wide range of incidents, including ransomware and Advanced Persistent Threat (APT) cases.\n\n\n-----\n\nWe have a global consulting team standing by to assist you, providing around the clock support where required, as well as\nlocal assistance. Please contact us here: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incidentresponse-containment\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats, providing intelligence analysis for\nthe benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-21 - Threat Thursday- BlackGuard Infostealer Rises from Russian Underground Markets.pdf"
    ],
    "report_names": [
        "2022-04-21 - Threat Thursday- BlackGuard Infostealer Rises from Russian Underground Markets.pdf"
    ],
    "threat_actors": [
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75455540-2f6e-467c-9225-8fe670e50c47",
            "created_at": "2022-10-25T16:07:23.740266Z",
            "updated_at": "2025-03-27T02:02:09.955585Z",
            "deleted_at": null,
            "main_name": "Iridium",
            "aliases": [],
            "source_name": "ETDA:Iridium",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "LazyCat",
                "Powerkatz",
                "SinoChopper",
                "reGeorg"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "0661a292-80f3-420b-9951-a50e03c831c0",
            "created_at": "2023-01-06T13:46:38.928796Z",
            "updated_at": "2025-03-27T02:00:02.953963Z",
            "deleted_at": null,
            "main_name": "IRIDIUM",
            "aliases": [],
            "source_name": "MISPGALAXY:IRIDIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04a7ebaa-ebb1-4971-b513-a0c86886d932",
            "created_at": "2023-01-06T13:46:38.784965Z",
            "updated_at": "2025-03-27T02:00:02.91817Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "G0100"
            ],
            "source_name": "MISPGALAXY:Inception Framework",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535561,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1653780309,
    "ts_modification_date": 1653780309,
    "files": {
        "pdf": "https://archive.orkl.eu/6f86e0bf602050f0eed4139ecc71b9cfa7a123e5.pdf",
        "text": "https://archive.orkl.eu/6f86e0bf602050f0eed4139ecc71b9cfa7a123e5.txt",
        "img": "https://archive.orkl.eu/6f86e0bf602050f0eed4139ecc71b9cfa7a123e5.jpg"
    }
}