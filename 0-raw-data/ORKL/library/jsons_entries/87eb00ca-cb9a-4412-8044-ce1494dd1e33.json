{
    "id": "87eb00ca-cb9a-4412-8044-ce1494dd1e33",
    "created_at": "2023-01-12T14:59:49.644911Z",
    "updated_at": "2025-03-27T02:13:07.937974Z",
    "deleted_at": null,
    "sha1_hash": "a8a3e3726096375ac2dea773c7f7de2374bdb27b",
    "title": "2022-09-15 - Webworm- Espionage Attackers Testing and Using Older Modified RATs",
    "authors": "",
    "file_creation_date": "2022-10-02T12:19:30Z",
    "file_modification_date": "2022-10-02T12:19:30Z",
    "file_size": 425631,
    "plain_text": "# Webworm: Espionage Attackers Testing and Using Older Modified RATs\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/webworm-espionage-rats](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/webworm-espionage-rats)**\n\nThreat Hunter TeamSymantec\n\nSymantec, by [Broadcom Software, has gained insight into the current activities of a group we](https://software.broadcom.com/)\ncall Webworm. The group has developed customized versions of three older remote access\nTrojans (RATs), including Trochilus, Gh0st RAT, and 9002 RAT. At least one of the indicators\nof compromise (IOCs) observed by Symantec was used in an attack against an IT service\nprovider operating in multiple Asian countries, while others appear to be in pre-deployment\nor testing stages.\n\n## Webworm\n\nSymantec’s Webworm has links to a group dubbed Space Pirates, which was previously\n[documented in a May 2022 report from Positive Technologies. It is likely that the two groups](https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/space-pirates-tools-and-connections/)\nare one and the same.\n\n\n-----\n\nActive since at least 2017, Webworm has been known to target government agencies and\nenterprises involved in IT services, aerospace, and electric power industries located in\nRussia, Georgia, Mongolia, and a number of other Asian countries.\n\nPrevious research on the group’s activity found that it uses custom loaders hidden behind\ndecoy documents and modified backdoors that have been around for quite some time. This\ncorresponds with recent Webworm activity observed by Symantec.\n\nMalware used by Webworm includes versions of the following threats:\n\n**Trochilus RAT**\n\nFirst spotted back in 2015, Trochilus is a RAT implemented in C++ and its source code is\navailable for download on GitHub. The malware has been used in targeted threat operations\nby multiple groups and has features that can help it evade sandbox analysis and be useful in\ncyber-espionage operations. The RAT’s features include, but are not limited to, the ability to\nremotely uninstall a file manager, and the ability to download, upload, and execute files.\n\n[Trochilus has been previously linked to malware operations from threat actors also using](https://threatpost.com/new-rat-trochilus-skilled-at-espionage-evading-detection/115857/)\nmalware such as PlugX and a variant of the 9002 RAT.\n\n**9002 RAT**\n\nThe 9002 RAT appears to have been in use since at least 2009 and has historically been\nused by state-sponsored actors. The malware provides attackers with extensive data\nexfiltration capabilities. Some variants of 9002 RAT inject into memory and do not write to the\ndisk, something that also applies to the sample analyzed by Symantec.\n\nThe malware has been used in multiple campaigns by a range of actors, including in a\nhacking operation targeting several large corporations located in South Korea. The RAT was\nused to deliver additional malware, including the PlugX RAT, onto compromised machines. It\n[has also been involved in attacks making use of zero-day exploits.](https://exchange.xforce.ibmcloud.com/collection/f4470320456b13c8ebe26d2108e69ef8)\n\n**Gh0st RAT**\n\nWhile the source code for Gh0st RAT was released online in 2008, the malware has\ncontinued to be used by advanced persistent threat (APT) groups.\n\nGh0st RAT first made headlines back in 2009, when a cyber-espionage group called\nGhostNet used it to target diplomatic, political, economic, and military targets around the\nworld.\n\n## Observed Webworm activity\n\nSymantec observed three malware droppers developed by Webworm:\n\n\n-----\n\n6201c604ac7b6093dc8f6f12a92f40161508af1ddffa171946b876442a66927e (Trochilus\ndropper)\nb9a0602661013d973bc978d64b7abb6bed20cf0498d0def3acb164f0d303b646\n(Trochilus Dropper)\nc71e0979336615e67006e20b24baafb19d600db94f93e3bf64181478dfc056a8\n(Trochilus Dropper)\n\nAnalysis of one of the droppers revealed that it drops the following files:\n\n[TEMP]\\Logger.exe\n(28d78e52420906794e4059a603fa9f22d5d6e4479d91e9046a97318c83998679)\n\n[TEMP]\\sc.cfg\n(a618b3041935ec3ece269effba5569b610da212b1aa3968e5645f3e37d478536)\n\n[TEMP]\\logexts.dat\n(a6b9975bfe02432e80c7963147c4011a4f7cdb9baaee4ae8d27aaff7dff79c2b)\n\n[TEMP]\\logexts.dll\n(a73a4c0aa557241a09e137387537e04ce582c989caa10a6644d4391f00a836ef)\n\n[TEMP]\\logger.dat\n(10456bc3b5cfd2f1b1ab9c3833022ef52f5e9733d002ab237bdebad09b125024)\n[TEMP]\\[RANDOM_DIGITS].doc\n(d295712185de2e5f8811b0ce7384a04915abdf970ef0f087c294bb00e340afad)\n\nThe legitimate executable Logger.exe is used to call the “LoadLibraryA” API in order to load\nthe malicious \"[TEMP]\\logexts.dll\" file.\n\nThelogexts.dll file is a loader. Once run, it checks the process command-line parameters. If\nthe command-line is the single parameter \"isdf\", it attempts to steal a token from the\n\"WINLOGON.EXE\" process. It then starts the following process by calling the\nCreateProcessAsUserW API:\n\n_C:\\ProgramData\\Logger\\Logger.exe mdkv_\n\nOtherwise it constructs the pathname of the second stage based on its own running\nexecutable, where it replaces the last three characters with hardcoded \"dat\" (resulting with\n\"Logger.dat\"). Then it reads and executes the second stage as shellcode.\n\nThe second stage (\"Logger.dat\") constructs the pathname of the third stage also based on its\nown running executable, where it combines the directory part with hardcoded \"logexts.dat\".\nFinally, it reads and executes the third stage.\n\nThelogexts.dat file is obfuscated and includes several User Account Control (UAC)\nbypasses.\n\nIt attempts to copy the previously dropped files to the following new locations:\n\n\n-----\n\n[Temp]\\Logger.exe to C:\\ProgramData\\Logger\\Logger.exe\n\n[Temp]\\Logger.dat to C:\\ProgramData\\Logger\\logger.dat\n\n[Temp]\\logexts.dll to C:\\ProgramData\\Logger\\logexts.dll\n\n[Temp]\\logexts.dat to C:\\ProgramData\\Logger\\logexts.dat\n\n[Temp]\\sc.cfg to C:\\ProgramData\\Logger\\sc.cfg\n\nThen the file unpacks and executes in memory its backdoor payload, a variant of the\nTrochilus RAT\n(e69177e58b65dd21e0bbe4f6caf66604f120e0c835f3ee0d16a45858f5fe9d90).\n\nThe Trochilus modifications include functionality to load its configuration from a file by\nchecking for any of the following locations (in order of preference):\n\nC:\\ProgramData\\Logger\\sc.cfg\nC:\\ProgramData\\resmon.resmoncfg\nC:\\ProgramData\\appsoft\\resmon.resmoncfg\n\nThe content of the configuration file is decompressed using the Lempel–Ziv–Welch (LZW)\nalgorithm.\n\nInterestingly, one of the locations described above (“C:\\ProgramData\\resmon.resmoncfg”) is\nmentioned in third-party research detailing previous Space Pirates (Webworm) activity.\n\nThe malware then injects svchost.exe with the ability to:\n\nExecute commands\nDownload potentially malicious files\n\nFurther investigation by Symantec found that droppers that share a similar structure to the\none used to deploy the version of Trochilus RAT modified by Webworm were also used to\ndeploy two additional modified versions of Gh0st RAT and 9002 RAT. Some code\nmodifications made to the variant of Trochilus RAT were also present in the two additional\nretooled RATs. The additional RATs included:\n\n**Gh0st RAT:**\n\n1e725f1fe67d1a596c9677df69ef5b1b2c29903e84d7b08284f0a767aedcc097 (Dropper)\nb0a58c6c859833eb6fb1c7d8cb0c5875ab42be727996bcc20b17dd8ad0058ffa\n(Shellcode loader)\n1CC32C7F2C90A558BA5FF6BA191E655B20D7C65C10AF0D5D06820A28C2947EFD\n(Shellcode loader)\n\n**9002 RAT:**\n\n\n-----\n\n6e46054aa9fd5992a7398e0feee894d5887e70373ca5987fc56cd4c0d28f26a1\n(Dropper)\n37fa5108db1ae73475911a5558fba423ef6eee2cf3132e35d3918b9073aeecc1 (Packed\nbackdoor)\n\nChanges made by Webworm to this version of 9002 RAT are apparently intended to evade\ndetection. For example, the details of the RAT’s communication protocol, such as encryption,\nhave also been modified by the threat actors.\n\nGh0st RAT (BH_A006) was documented in third-party research detailing previous Webworm\n(Space Pirates) activity. In that research, the version of Gh0st RAT included features such as\nlayers of obfuscation to bypass security protections and hinder analysis, network service\ncreation, UAC bypassing, and shellcode unpacking and launching in the memory. Some of\nthese features were also present in the version of the RAT being prepared by Webworm.\n\n## Conclusion\n\nWebworm’s use of customized versions of older, and in some cases open-source, malware,\nas well as code overlaps with the group known as Space Pirates, suggest that they may be\nthe same threat group. However, the common use of these types of tools and the exchange\nof tools between groups in this region can obscure the traces of distinct threat groups, which\nis likely one of the reasons why this approach is adopted, another being cost, as developing\nsophisticated malware can be expensive in terms of both money and time.\n\n## Protection/Mitigation\n\n[For the latest protection updates, please visit the Symantec Protection Bulletin.](https://www.broadcom.com/support/security-center/protection-bulletin)\n\n## IOCs\n\nc71e0979336615e67006e20b24baafb19d600db94f93e3bf64181478dfc056a8 - Trochilus\ndropper\n\n28d78e52420906794e4059a603fa9f22d5d6e4479d91e9046a97318c83998679 – Logger.exe\n\na6b9975bfe02432e80c7963147c4011a4f7cdb9baaee4ae8d27aaff7dff79c2b – logexts.dat\n\na73a4c0aa557241a09e137387537e04ce582c989caa10a6644d4391f00a836ef – logexts.dll\n\n10456bc3b5cfd2f1b1ab9c3833022ef52f5e9733d002ab237bdebad09b125024 – logger.dat\n\nd295712185de2e5f8811b0ce7384a04915abdf970ef0f087c294bb00e340afad –\n\n[RANDOM_DIGITS].doc\n\ne69177e58b65dd21e0bbe4f6caf66604f120e0c835f3ee0d16a45858f5fe9d90 – Trochilus RAT\n\n\n-----\n\na618b3041935ec3ece269effba5569b610da212b1aa3968e5645f3e37d478536 - Backdoor\nconfiguration\n\n6201c604ac7b6093dc8f6f12a92f40161508af1ddffa171946b876442a66927e – Trochilus\ndropper\n\n3629d2ce400ce834b1d4b7764a662757a9dc95c1ef56411a7bf38fb5470efa84 - Backdoor\nconfiguration\n\nb9a0602661013d973bc978d64b7abb6bed20cf0498d0def3acb164f0d303b646 - Trochilus\ndropper\n\n824100a64c64f711b481a6f0e25812332cc70a13c98357dd26fb556683f8a7c7 – Packed\nbackdoor\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-15 - Webworm- Espionage Attackers Testing and Using Older Modified RATs.pdf"
    ],
    "report_names": [
        "2022-09-15 - Webworm- Espionage Attackers Testing and Using Older Modified RATs.pdf"
    ],
    "threat_actors": [
        {
            "id": "3cc6c262-df23-4075-a93f-b496e8908eb2",
            "created_at": "2022-10-25T16:07:23.682239Z",
            "updated_at": "2025-03-27T02:02:09.920109Z",
            "deleted_at": null,
            "main_name": "GhostNet",
            "aliases": [
                "GhostNet",
                "Snooping Dragon"
            ],
            "source_name": "ETDA:GhostNet",
            "tools": [
                "AngryRebel",
                "Farfli",
                "Gh0st RAT",
                "Gh0stnet",
                "Ghost RAT",
                "Ghostnet",
                "Moudour",
                "Mydoor",
                "PCRat",
                "Remosh",
                "TOM-Skype"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "536ca49a-2666-4005-8a50-e552fc7e16ef",
            "created_at": "2023-11-21T02:00:07.375813Z",
            "updated_at": "2025-03-27T02:00:03.245695Z",
            "deleted_at": null,
            "main_name": "Webworm",
            "aliases": [
                "Space Pirates"
            ],
            "source_name": "MISPGALAXY:Webworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e91dae30-a513-4fb1-aace-4457466313b3",
            "created_at": "2023-01-06T13:46:38.974913Z",
            "updated_at": "2025-03-27T02:00:02.967085Z",
            "deleted_at": null,
            "main_name": "GhostNet",
            "aliases": [
                "Snooping Dragon"
            ],
            "source_name": "MISPGALAXY:GhostNet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8e385d36-06a2-4294-b3d3-01fe8e9d95f4",
            "created_at": "2022-10-25T16:07:24.219051Z",
            "updated_at": "2025-03-27T02:02:10.142803Z",
            "deleted_at": null,
            "main_name": "Space Pirates",
            "aliases": [
                "Erudite Mogwai",
                "Webworm"
            ],
            "source_name": "ETDA:Space Pirates",
            "tools": [
                "9002 RAT",
                "Agent.dhwf",
                "AngryRebel",
                "BH_A006",
                "Chymine",
                "Darkmoon",
                "Deed RAT",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "Homux",
                "Hydraq",
                "Kaba",
                "Korplug",
                "McRAT",
                "MdmBot",
                "Moudour",
                "MyKLoadClient",
                "Mydoor",
                "PCRat",
                "PCShare",
                "POISONPLUG.SHADOW",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "Roarur",
                "SPIVY",
                "ShadowPad Winnti",
                "SnappyBee",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "XShellGhost",
                "Xamtrav",
                "Zupdax",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535589,
    "ts_updated_at": 1743041587,
    "ts_creation_date": 1664713170,
    "ts_modification_date": 1664713170,
    "files": {
        "pdf": "https://archive.orkl.eu/a8a3e3726096375ac2dea773c7f7de2374bdb27b.pdf",
        "text": "https://archive.orkl.eu/a8a3e3726096375ac2dea773c7f7de2374bdb27b.txt",
        "img": "https://archive.orkl.eu/a8a3e3726096375ac2dea773c7f7de2374bdb27b.jpg"
    }
}