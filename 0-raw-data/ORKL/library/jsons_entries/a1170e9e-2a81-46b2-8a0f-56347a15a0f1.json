{
    "id": "a1170e9e-2a81-46b2-8a0f-56347a15a0f1",
    "created_at": "2023-01-12T15:09:35.458179Z",
    "updated_at": "2025-03-27T02:09:18.36844Z",
    "deleted_at": null,
    "sha1_hash": "3e5746b8822b70b4b17ad78a7ea82bad0083e991",
    "title": "2020-12-14 - Responding to Solarigate",
    "authors": "",
    "file_creation_date": "2022-05-27T23:22:51Z",
    "file_modification_date": "2022-05-27T23:22:51Z",
    "file_size": 989013,
    "plain_text": "# Responding to Solarigate\n\n**cadosecurity.com/post/responding-to-solarigate**\n\nDecember 14, 2020\n\nAs you are no doubt aware, on Sunday the security software provider SolarWinds\nannounced that installers for it’s Orion monitoring platform had been backdoored by “a\nnation-state”. Typical customers of SolarWinds are enterprise scale and security conscious.\nReported organisations compromised through these attacks include various parts of the US\ngovernment, as well as a number of large organisations in the private sector.\n\nBelow we have included some suggestions for those responding to these incidents or\nperforming forensics to confirm if they may be compromised.\n\n**Background**\n\nReviewing the backdoored Orion installers, they match what appears to be SolarWind’s\nnormal build process. It is likely the attackers have compromised both the SolarWind source\ncode, and their build process to deliver backdoored updates through their normal release\nprocess.\n\n[The first backdoored installers identified so far date back to October 2019, though](https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/)\n[SolarWinds themselves have only referred to backdoored installers starting in May 2020.](https://uk.reuters.com/article/us-usa-solarwinds-cyber-idUKKBN28N0Y7)\n\n\n-----\n\n[On Sunday 13th December 2020, SolarWinds sent an email to customers informing them of](https://thwack.solarwinds.com/t5/NPM-Discussions/Hackers-getting-in-via-NPM-maybe/m-p/612422)\nthe situation:\n\n**Figure 1: Statement and email from SolarWinds**\n\n**Backdoored Orion Installers**\n\n[A number of backdoored installers have been identified, and are still being served from the](https://twitter.com/KyleHanslovan/status/1338408803503644673)\nSolarWinds website. Below is a non-exhaustive list of the installers:\n\n_Version 2019.4.5220.20161_\n\n_*https://downloads.solarwinds[.]_\ncom/solarwinds/CatalogResources/Core/2019.4/2019.4.5220.20161/CoreInstaller.msi(\n38385a81664ce562a6777fa4564ae7b93f38f1224e1206550136e2b6b5dbb9dd )\n\nContains OrionCore.cab/SolarWinds.Orion.Core.BusinessLayer.dll:(\na25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc )\n\n- This version is listed as Suspicious by Microsoft (likely due to the presence of\nSolarWinds.Orion.Core.BusinessLayer.dll) but not confirmed malicious.\n\n_Version 2020.2.5220.27327_\n\nhttps://downloads.solarwinds[.]\ncom/solarwinds/CatalogResources/Core/2020.2/2020.2.5220.27327/CoreInstaller.msi(\nad2fbf4add71f61173975989d1a18395afb8538ed889012b9d2e21c19e98bbd1 )\n\nContains OrionCore.cab/SolarWinds.Orion.Core.BusinessLayer.dll\n(019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134 )\n\n\n-----\n\nThis version is listed as Suspicious by Microsoft (likely due to the presence of\nSolarWinds.Orion.Core.BusinessLayer.dll) but not confirmed malicious.\n\n_Version 2020.2.5220.27327_\nhttps://downloads.solarwinds[.]\ncom/solarwinds/CatalogResources/Core/2020.2/2020.2.5220.27327/CoreInstaller.msi(\nad2fbf4add71f61173975989d1a18395afb8538ed889012b9d2e21c19e98bbd1 )\n\nContains OrionCore.cab/SolarWinds.Orion.Core.BusinessLayer.dll\n(019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134 )\n\n_Version 2020.2.5320.27438_\nhttps://downloads.solarwinds[.]\ncom/solarwinds/CatalogResources/Core/2020.2/2020.2.5320.27438/CoreInstaller.msi(\nc20fd967d64e9722d840ec4292645b65896d0ee3ebe31090e15c5312d889c89e )\n\nContains OrionCore.cab/SolarWinds.Orion.Core.BusinessLayer.dll:(\nce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6 )\n\n**SunBurst/Solorigate Backdoor**\n\nThe file CoreInstaller.msi/OrionCore.cab/SolarWinds.Orion.Core.BusinessLayer.dll is what\nFireEye calls SunBurst and Microsoft calls Solorigate. SunBurst performs the typical firststage backdoor tasks of downloading and executing files, whilst subtly evading detection.\n\nSunBurst deploys basic Base64 encoding to hide key strings such as the command and\ncontrol protocol:\n\n\n-----\n\n**Figure 2: Command and Control domains from SunBurst**\nAnd impersonates normal Orion network traffic to blend in:\n\nFigure 3: Command and Control Traffic\n[A detailed analysis of SunBurst is available in the FireEye report, and we have included the](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\nde-obfuscated source-code in Appendix B to save others having to do perform the same deobfuscation.\n\n**Later Stages of the Attack**\n\nBoth Microsoft and FireEye have provided details of second stages of the attacks they have\nidentified, including malware:\n\n\n-----\n\n[SuperNova – A .NET Web shell](https://github.com/fireeye/sunburst_countermeasures/blob/main/rules/SUPERNOVA/APT_Webshell_SUPERNOVA_1.yar)\n[CosmicGale – A Powershell credential theft script](https://github.com/fireeye/sunburst_countermeasures/blob/main/rules/COSMICGALE/yara/APT_HackTool_PS1_COSMICGALE_1.yar)\n[TearDrop – A memory resident dropper](https://github.com/fireeye/sunburst_countermeasures/blob/main/rules/TEARDROP/yara/APT_Dropper_Win64_TEARDROP_1.yar)\n[Cobalt Strike – A commercially available backdoor, observed dropped by TearDrop](https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike)\n\nAnd also attacker activity such as:\n\n[Adding new federation trusts. Microsoft recently added new detections for Modified](https://activedirectoryfaq.com/2018/06/o365-hybrid-exchange-federation-trust/)\ndomain federation trust settings likely to hunt for this activity.\n[Adding OAuth credentials to Exchange](https://docs.microsoft.com/en-us/cloud-app-security/investigate-risky-oauth)\n\n**Suggestions for Forensic Analysis**\n\nThe Department of Homeland security advises agencies with SolarWinds installations, and\n[the required expertise, to perform a full forensic investigation:](https://cyber.dhs.gov/ed/21-01/)\n\n_a. Forensically image system memory and/or host operating systems hosting all instances of_\n_SolarWinds Orion versions 2019.4 through 2020.2.1 HF1]. Analyze for new user or service_\n_accounts, privileged or otherwise._\n\n_b. Analyze stored network traffic for indications of compromise, including new external DNS_\n_domains to which a small number of agency hosts (e.g., SolarWinds systems) have had_\n_connections._\n\nPay attention to Windows event logs with:\n\nSysmon Event IDs [17 and](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90017) [18 relating to named pipes](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=90018)\nSecurity Event ID [7045 relating to service creation, and](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4697) [4702 relating to the creation of](https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventID=4702)\na [scheduled task](https://twitter.com/lostinsecurity/status/1338388788524052480)\n[Windows Exploit Guard event ID 12, relating to a non-Microsoft-signed binary being](https://github.com/palantir/exploitguard)\n[blocked from loading](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\n[Microsoft provides guidance on how to enable increased logging of AD FS (Active](https://docs.microsoft.com/en-us/windows-server/identity/ad-fs/troubleshooting/ad-fs-tshoot-logging)\nDirectory Federation Services).\n\nLook for the existence of the following file:\n\nC:\\WINDOWS\\SysWOW64\\netsetupsvc.dll\n\n(**note the normal legitimate path for this file-name is within C:\\WINDOWS\\SYSTEM32):\n\nAdditional mitigation considerations:\n\nIt is strongly suggested where practical, that sensitive systems, or systems that imply a\nthird party risk be monitored and audited regularly.\n\n\n-----\n\nWe suggest where possible servers should allow whitelisted internet access only. For\nexample, if your SolarWinds server was only allowed to access the necessary IP\naddresses, and or IP ranges for its function. It would help prevent communication to\nunknown command and control infrastructure.\nAlways utlise the concept of least privileged access, and look to monitor account usage\nthat is beyond its normal purpose or operation. For example, a service account\nperforming an interactive logon or querying other services that have no relation to the\naccounts purposes.\n\n**About Cado Security**\n\nWe have built the first cloud-native forensics and response platform for responding to\nsecurity incidents. Join our pilot partner program today, [sign up for details here.](https://www.cadosecurity.com/platform)\n\n**Appendix A – Consolidated Indicators of Compromise**\n\nThe file-hashes (SHA256) below relate to malicious installers we have seen and file-hashes\nconsolidated from earlier reporting. Additional indicators of compromise are available from\n[FireEye,](https://github.com/fireeye/sunburst_countermeasures) [Microsoft and](https://msrc-blog.microsoft.com/2020/12/13/customer-guidance-on-recent-nation-state-cyber-attacks/) [AlienVault OTX.](https://otx.alienvault.com/pulse/5fd6df943558e0b56eaf3da8)\n```\n019085a76ba7126fff22770d71bd901c325fc68ac55aa743327984e89f4b0134\n292327e5c94afa352cc5a02ca273df543f2020d0e76368ff96c84f4e90778712\n32519b85c0b422e4656de6e6c41878e95fd95026267daab4215ee59c107d6c77\n38385a81664ce562a6777fa4564ae7b93f38f1224e1206550136e2b6b5dbb9dd\n53f8dfc65169ccda021b72a62e0c22a4db7c4077f002fa742717d41b3c40f2c7\na25cadd48d70f6ea0c4a241d99c5241269e6faccb4054e62d16784640f8e53bc\nac1b2b89e60707a20e9eb1ca480bc3410ead40643b386d624c5d21b47c02917c\nad2fbf4add71f61173975989d1a18395afb8538ed889012b9d2e21c19e98bbd1\nc09040d35630d75dfef0f804f320f8b3d16a481071076918e9b236a321c1ea77\nc15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71\nc20fd967d64e9722d840ec4292645b65896d0ee3ebe31090e15c5312d889c89e\nce77d116a074dab7a22a0fd4f2c1ab475f16eec42e1ded3c0b0aa8211fe858d6\nd0d626deb3f9484e649294a8dfa814c5568f846d5aa02d4cdad5d041a29d5600\ndab758bf98d9b36fa057a66cd0284737abf89857b73ca89280267ee7caf62f3b\neb6fab5a2964c5817fb239a7a5079cabca0a00464fb3e07155f28b0a57a2c0ed\n\n```\n**Appendix B – De-obfuscated SunBurst Source Code**\nSee\nhttps://github.com/cadosecurity/MalwareAnalysis/blob/main/OrionImprovementBusinessLaye\nr.cs\n\n**Appendix C – SuperNova .NET WebShell**\nSee [https://github.com/cadosecurity/MalwareAnalysis/blob/main/LogoImageHandler.cs](https://github.com/cadosecurity/MalwareAnalysis/blob/main/LogoImageHandler.cs)\n\nAbout The Author\n\n\n-----\n\nChris Doman\n\n[Chris is well known for building the popular threat intelligence portal ThreatCrowd, which](https://www.threatcrowd.org/)\n[subsequently merged into the AlienVault Open Threat Exchange, later acquired by AT&T.](https://otx.alienvault.com/)\nChris is an industry leading threat researcher and has published a number of widely read\narticles and papers on targeted cyber attacks. His research on topics such as the North\nKorean government’s [crypto-currency theft schemes, and China’s attacks](https://www.wsj.com/articles/in-north-korea-hackers-mine-cryptocurrency-abroad-1515420004) against dissident\nwebsites, have been widely discussed in the media. He has also given interviews to print,\n[radio and TV such as CNN and BBC News.](https://www.youtube.com/watch?v=z_0oV_hsc08)\n\n**About Cado Security**\n\nCado Security provides the cloud investigation platform that empowers security teams to\nrespond to threats at cloud speed. By automating data capture and processing across cloud\nand container environments, Cado Response effortlessly delivers forensic-level detail and\nunprecedented context to simplify cloud investigation and response. Backed by Blossom\nCapital and Ten Eleven Ventures, Cado Security has offices in the United States and United\n[Kingdom. For more information, please visit https://www.cadosecurity.com/ or follow us on](https://www.cadosecurity.com/)\nTwitter [@cadosecurity.](https://twitter.com/CadoSecurity)\n\n[Prev Post](https://www.cadosecurity.com/introducing-our-next-stage-cado-response/) [Next Post](https://www.cadosecurity.com/botnet-deploys-cloud-and-container-attack-techniques/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-14 - Responding to Solarigate.pdf"
    ],
    "report_names": [
        "2020-12-14 - Responding to Solarigate.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536175,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653693771,
    "ts_modification_date": 1653693771,
    "files": {
        "pdf": "https://archive.orkl.eu/3e5746b8822b70b4b17ad78a7ea82bad0083e991.pdf",
        "text": "https://archive.orkl.eu/3e5746b8822b70b4b17ad78a7ea82bad0083e991.txt",
        "img": "https://archive.orkl.eu/3e5746b8822b70b4b17ad78a7ea82bad0083e991.jpg"
    }
}