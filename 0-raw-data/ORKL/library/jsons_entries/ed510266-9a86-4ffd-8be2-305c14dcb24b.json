{
    "id": "ed510266-9a86-4ffd-8be2-305c14dcb24b",
    "created_at": "2022-10-25T16:48:13.307082Z",
    "updated_at": "2025-03-27T02:17:15.027098Z",
    "deleted_at": null,
    "sha1_hash": "18c269d1eaa29438861255b754cdf766df09110a",
    "title": "Operation Earth Berberoka: An Analysis of a Multivector and Multiplatform APT Campaign Targeting Online Gambling Sites",
    "authors": "",
    "file_creation_date": "2022-05-23T10:33:33Z",
    "file_modification_date": "2022-05-23T10:33:36Z",
    "file_size": 2674320,
    "plain_text": "-----\n\n**TREND MICRO LEGAL DISCLAIMER**\n\nThe information provided herein is for general information\n\nand educational purposes only. It is not intended and\n\nshould not be construed to constitute legal advice. The\n\ninformation contained herein may not be applicable to all\n\nsituations and may not reflect the most current situation.\n\nNothing contained herein should be relied on or acted\n\nupon without the benefit of legal advice based on the\n\nparticular facts and circumstances presented and nothing\n\nherein should be construed otherwise. Trend Micro\n\nreserves the right to modify the contents of this document\n\nat any time without prior notice.\n\nTranslations of any material into other languages are\n\nintended solely as a convenience. Translation accuracy\n\nis not guaranteed nor implied. If any questions arise\n\nrelated to the accuracy of a translation, please refer to\n\nthe original language official version of the document. Any\n\ndiscrepancies or differences created in the translation are\n\nnot binding and have no legal effect for compliance or\n\nenforcement purposes.\n\nAlthough Trend Micro uses reasonable efforts to include\n\naccurate and up-to-date information herein, Trend Micro\n\nmakes no warranties or representations of any kind as\n\nto its accuracy, currency, or completeness. You agree\n\nthat access to and use of and reliance on this document\n\nand the content thereof is at your own risk. Trend Micro\n\ndisclaims all warranties of any kind, express or implied.\n\nNeither Trend Micro nor any party involved in creating,\n\nproducing, or delivering this document shall be liable\n\nfor any consequence, loss, or damage, including direct,\n\nindirect, special, consequential, loss of business profits,\n\nor special damages, whatsoever arising out of access to,\n\nuse of, or inability to use, or in connection with the use of\n\nthis document, or any errors or omissions in the content\n\nthereof. Use of this information constitutes acceptance for\n\nuse in an “as is” condition.\n\nPublished by\n###### Trend Micro Research\n\nWritten by\n###### Daniel Lunghi Jaromir Horejsi\n\nStock image used under license from\n\nEnvato.com\n\n\n### Contents\n\n#### 4\n###### Targets\n\n#### 6\n###### Technical Analysis\n\n#### 36\n###### Attribution\n\n#### 38\n###### Conclusion\n\n\n-----\n\nIn recent years, there has been an advent of new technologies that power e-gambling\n\nwebsites and applications, causing the online gambling market to continuously grow. In\n\nfact, this market is expected to be valued at more than US$92.9 billion by 2023.[1] And\n\nwhen the Covid-19 pandemic happened, online gambling numbers soared even higher.\n\nAccording to a study conducted by the University of Bristol and published in the Journal of\n\nGambling Studies, gamblers were more than six times more likely to participate in online\n\ngambling activities compared to before the pandemic struck.[2]\n\nBecause malicious actors tend to follow the money trail, it is not at all surprising that the\n\nonline gambling industry has been targeted by cybercriminals. In 2020, we reported on\n\nOperation DRBControl, an advanced persistent threat (APT) group that used malware in\n\na cyberespionage campaign aimed at gambling companies in Southeast Asia.[3] And in\n\n2021, Akamai reported that a European gambling company suffered a distributed denial-\n\nof-service (DDoS) attack that peaked at a whopping 800 gigabits per second.[4]\n\nWe discovered an APT group that we have dubbed Earth Berberoka (aka GamblingPuppet).\n\nBased on our analysis, this APT group targets gambling websites. Our investigation also\n\nshows that this group’s campaign uses multiple malware families that target the Windows,\n\nLinux, and macOS platforms, and that have been attributed to Chinese-speaking actors.\n\nAside from using tried-and-tested malware families that have been upgraded, such as PlugX\n\nand Gh0st RAT, Earth Berberoka has also developed a brand-new complex, multistage\n\nmalware family, which we have dubbed PuppetLoader.\n\nIn this report, we present a detailed technical analysis of the different malware families that\n\nEarth Berberoka uses on the three platforms that it targets. We also provide details on the\n\ninfection vectors used by the group and information on other cybercriminal groups to which\n\nEarth Berberoka is potentially linked.\n\n\n-----\n\n## Targets\n\nWe believe that Earth Berberoka’s primary targets have been gambling websites in China, but we also\n\nhave evidence that the group has also targeted one government institution related to education, two IT\n\nservices companies, and one electronics manufacturing company.\n\nFrom Dec. 12, 2020, to April 29, 2022, we noted 15 downloads of a fake Adobe Flash Player installer in\n\nChina. We also saw eight redirects from certain websites to the malicious Adobe Flash Player website\n\n(five from a legitimate news website in the US and three from an unknown website, two of which were\n\nfrom Hong Kong and one from Malaysia), and one PlugX DLL detection in Taiwan. (In the context of this\n\ncampaign, a redirect means an HTTP request to the script that redirects to the fake Adobe Flash Player\n\ninstaller. The script itself is hosted in a third-party server. Earth Berberoka thus compromises a website,\n\ninserts in that compromised website a redirection to a third-party website, and that third-party website\n\nredirects to the website hosting the fake Adobe Flash Player installer. We explain this mode of infection\n\nfurther in the “Infection Vectors” subsection of this report.)\n\n\n###### China\n\n US\n\n Hong Kong\n\n Malaysia\n\n Taiwan\n\n\n###### 15\n\n 5\n\n 2\n\n 1\n\n 1\n\n\nFigure 1. Earth Berberoka telemetry hits from Dec. 12, 2020, to April 29, 2022\n\nWe also retrieved logs generated by Earth Berberoka’s keyloggers that showed a hosting provider from\n\nMalaysia that was being compromised. A similar log file found in the wild contained an IP address belonging\n\nto a Chinese gambling website. A third log file contained the login page URL of another Chinese gambling\n\nwebsite. These two files reinforced our belief that the gambling industry had indeed been at the crosshairs\n\nof this campaign.\n\n\n-----\n\nAnother hint of Earth Berberoka’s targeted countries can be found in one of the backdoored applications\n\nthat the group has used. The registration process is restricted to countries in North America and countries\n\nin Asia, including China, Hong Kong, Macao, Taiwan, the Philippines, Japan, and South Korea. A detailed\n\nexplanation can be found in the “Infection Vectors” subsection of this report.\n\nThe last hint resides in the decrypted configuration files from samples of two malware families used by\n\nEarth Berberoka to target the Linux platform, Xnote and HelloBot. These samples contain some words\n\nthat might relate to gambling companies, such as “caipiao”, which translates to “lottery,” and “Yabo”,\n\nwhich could refer to a gambling website.\n\nOther decrypted configuration files contain keywords that are related to a Russian defense company,\n\nwhich we have elected not to disclose. This proves that Earth Berberoka also targets other, sensitive\n\nindustries.\n\n\n-----\n\n## Technical Analysis\n\n##### Malware Toolkit\n\nFrom our investigation, we found that Earth Berberoka uses multiple malware families that target the\n\nWindows, Linux, and macOS platforms. We found most of these malware families via shared back-end\n\ninfrastructure, specifically by pivoting on domains and malware samples. In this subsection, we provide\n\nan analysis of each of the malware families that we found for each platform.\n\n###### Windows Platform\n\n PuppetLoader\n\nWe discovered that Earth Berberoka has developed a new complex, multistage malware family, which we\n\nhave dubbed PuppetLoader. This loader uses some interesting techniques: It hijacks loaded modules to\n\nlaunch malicious code, and hides malicious payloads and modules in modified bitmap image (BMP) files.\n\nWe present our analysis of PuppetLoader’s stages in the succeeding subsections:\n\n- Stage 1: Obfuscator and Loader\n\n- Stage 2: Dropper (drops BasicLoader plus encrypted Core and Client.MainConsole)\n\n- Stage 3: BasicLoader (loads Core)\n\n- Stage 4: Core (loads Client.MainConsole)\n\n- Stage 5: Client.MainConsole\n\n###### Stage 1: Obfuscator and Loader\n\n**Incorrect RC4 Implementation**\n\nIn this stage, a blob of payload data is decrypted using a hard-coded key\n\n(2726c6aea9970bb95211304705b5f595) and what appears to be an RC4 (Rivest Cipher 4) algorithm.\n\nHowever, our analysis shows that the cipher is implemented incorrectly: Only the headers and first\n\nfew sections of the payload were properly encrypted, and the latter sections were left almost entirely\n\nin clear text. This behavior is caused by the improper implementation of the “swap” operation in the\n\npseudorandom generation part of the cipher code.\n\n\n-----\n\nIt seems that this hard-coded key and this flawed RC4 implementation were also used in a malware family\n\nnamed TigerPlug[5] (probably because it spreads the PlugX malware). We found no public reporting of its\n\nbehavior and features.\n\n**Hijacking Loaded Module**\n\nAfter the payload is decrypted, PuppetLoader loads the payload in the machine’s memory and executes\n\nit. PuppetLoader uses a stealthy hijacking method: It starts by loading a legitimate DLL from the\n\nWindows\\System32 directory, and then hijacks the loading process and replaces the content of the\n\nlegitimate library with malicious data. The loader achieves this task by hooking several NTDLL APIs, such\n\nas NtQueryAttributesFile, NtOpenFile, NtCreateSection, NtMapViewOfSection, NtQuerySection, and\n\nZwClose.\n\nTo avoid recursive hooking, which occurs when the hooked function indirectly calls itself, the loader uses\n\nundocumented NDTLL APIs, namely, RtlPushFrame, RtlPopFrame, and RtlGetFrame. These APIs are\n\nspecifically designed to prevent recursive hooking from happening.\n\nThe loader allocates a frame tagged as “LDFM” and fills it with the necessary parameters to properly load\n\nthe malicious payload. Some parameters are set immediately, while others are set later, after their values\n\nare identified. These parameters include file names’ memory addresses and allocated buffer handles or\n\naddresses that contain the malicious payload.\n\nFigure 2. The LDFM loading frame\n\nThe loader calls the LdrLoadDll API to load a legitimate asycfilt.dll library. It then calls previously hooked\n\nAPI functions, resulting in the loaded DLL name’s being replaced with lz32.dll, which is a legitimate DLL.\n\nThen, it replaces the content of the loaded lz32.dll with a malicious payload that is inside the hooked\n\nNtMapViewOfSection function.\n\nAfterward, the LdrLoadDll function rebases the newly loaded malicious image and loads all of the required\n\ndependencies. After the handle is returned from LdrLoadDll, PuppetLoader does not need the frame\n\nanymore, so it pops the frame by calling RtlPopFrame, unhooks previously hooked functions, and verifies\n\nwhether the loading is successful or not by calling GetModuleHandleW (asycfilt.dll).\n\n\n-----\n\nIn the last step, PuppetLoader dynamically resolves the export function called Install and sets the\n\nparameter value to “11BF29E1371C0D83C530BD1BF346”, which decrypts to a function called OneTime.\n\nFor its command-line parameters, PuppetLoader uses the same flawed RC4 implementation using the\n\npassword “whk0q9ogev6ofg8d”.\n\nThese hijacking steps result in the following:\n\n- The loaded asycfilt.dll can be seen by parsing the PEB_LDR_DATA[6] structure containing all loaded\n\nmodules in the current process.\n\nFigure 3. asycfilt.dll shown among loaded module names\n\n- The process monitoring tools report that one of the opened files is lz32.dll.\n\nFigure 4. Lz32.dll shown among opened files\n\n- The payload that is loaded is none of the previously mentioned libraries but is actually PuppetLoader’s\n\ndropper.\n\n###### Stage 2: Dropper\n\nThe dropper creates and drops several files in an infected machine.\n\n**File** **Function**\n\nCpuppetProcessFileSharer Used for sharing data during the different infection stages\n\nConfig.ini Saves the execution reason and the globally unique identifier (GUID)\nvalue based on ComputerName\n\nMSVCPX00.dll DLL file of BasicLoader\n\nverisign.bmp BMP file with encrypted Core\n\nbitmap.bmp BMP file with encrypted Client.MainConsole\n\nTable 1. The files created and dropped by the dropper\n\n|File|Function|\n|---|---|\n|CpuppetProcessFileSharer|Used for sharing data during the different infection stages|\n|Config.ini|Saves the execution reason and the globally unique identifier (GUID) value based on ComputerName|\n|MSVCPX00.dll|DLL file of BasicLoader|\n|verisign.bmp|BMP file with encrypted Core|\n|bitmap.bmp|BMP file with encrypted Client.MainConsole|\n\n\n-----\n\nThe malware inserts the hard-coded GUID ({78106D5F-CD1A-A8C4-A625-6863092B4BBA}) into\n\nCPuppetProcessFileSharer (C:\\\\Users\\\\Public\\\\Pictures\\\\Desktop.inf), likely as a marker that stage 2 has\n\nbeen completed.\n\nConfig.ini (C:\\Users\\Public\\Videos\\Config.ini) contains the GUID and the reason, which is the hard-coded\n\nvalue “StartupBasicLoader” encrypted using the key “whk0q9ogev6ofg8d”.\n\nThe dropper then starts svchost.exe in suspended mode with this command-line parameter:\n\n\n-cmd -NoModuleLoadDLL -DisplayName=KeepAuthority.Client.MainConsole.x64.Release\n\n-InvokeMethodName=Run -InokeMethodParam=NULL\n\n\nThe dropper also encrypts it with the key “whk0q9ogev6ofg8d” and creates a new thread within\n\nsvchost.exe to make it load MSVCPX00.dll, which is the BasicLoader payload. It is interesting to note that\n\nthere is a typographical error in “-InokeMethodParam”.\n\n###### Stage 3: BasicLoader\n\nThe BasicLoader stage starts by adding a hard-coded GUID ({78106D5F-CD1A-A8C4-A625\n6863092B4BBA}) into CPuppetProcessFileSharer, likely as a marker that stage 3 has started running.\n\nBasicLoader then searches for BMP files across directories in Users\\\\Public, such as Desktop, Documents,\n\nDownloads, Music, Pictures, and Videos. It performs a series of checks for each of the BMP file that it\n\nfinds. If a BMP file passes those checks and has the required structure, then BasicLoader decrypts, loads\n\ninto memory, and executes the payload appended to the BMP file.\n\nAs it turns out, the actual BMP file is tiny: It is made up of only 33 by 11 pixels and 338 bytes. The data\n\nappended to it is the payload, encrypted with the same flawed RC4 implementation.\n\nFigure 5. A small BMP file, to which the encrypted payload is appended\n\n###### Stage 4: Core\n\nThe Core stage starts by adding a hard-coded GUID ({7D8DA9DC-1F3B-2E5C-AA59-9418E652E4AA})\n\ninto CPuppetProcessFileSharer. Similar to the other stages, this is likely a marker that stage 4 has started\n\nrunning.\n\n\n-----\n\nThen, the malware starts a system logger thread, where the logged information, which can come from\n\nother modules or processes, is received via a pipe and is saved to a file with a hard-coded name. Each\n\nentry in the log file is separated by a separator (0xAABBCCDD), followed by a custom RC4 password and\n\nmessage length.\n\nThe decrypted log can include information about which module was run, with which parameters, and at\n\nwhich stage (GUID from CPuppetProcessFileSharer) the action was performed.\n\nFigure 6. The decrypted log from Core\n\nThe Core stage is run with these command-line arguments:\n\n- -DisplayName\n\n- -InokeMethodParam (sic)\n\n- -InvokeMethodName\n\n- -NoModuleLoadDLL\n\n- -LoadShellcode\n\n-NoModuleLoadDLL uses the same technique as the stage 1 loader, while -LoadShellcode allocates a\n\nmemory block, copies shellcode, and executes it. The other arguments are self-explanatory.\n\n###### Stage 5: Client.MainConsole\n\nClient.MainConsole is the main client binary, which is the last stage of PuppetLoader’s infection chain.\n\nThe client is written in C++ and the code is structured in several classes that handle different tasks, such\n\nas managing the interactive shell, uploading and downloading files, installing new modules, monitoring\n\nvictim behavior, and executing callback functions when conditions are met.\n\n- CPipeCmdManager – interactive shell manager\n\nArguments:\n\n-flushusersession\n\n-createcmd\n\n-destorycmd (sic)\n\n\n-----\n\n-excutecmd\n\n-cmdkeepalive\n\n- CommonLib::CcmdMulArgDecoder – command-line argument decoder, additional module related to\n\ncommand-line arguments\n\nArguments:\n\n-ModuleLog\n\n-LogText\n\n-ModuleID\n\n-ModuleVersion\n\n-MountStatus\n\n-Path\n\n-IsDelete\n\n-ModuleKeepAlive\n\n-UploadFile\n\nThe client then establishes communication with a command-and-control (C&C) server via UDP (User\n\nDatagram Protocol) and recognizes different types of custom UDP packets.\n\n**UDP packet** **Description**\n\nRemoteModuleCommandPacket Command to be executed by interactive shell\n\nRemoteModuleCommandResultPacket Result of running shell command\n\nFileTransferContent_Packet Determines whether to upload or download a file\n\nUploadFilePacket Uploaded file content\n\nFileManage_FolderContent_Packet Folder content\n\nVecProcessPacket Vector object with running processes\n\nInstallModulePacket BMP file with encrypted module to be installed\n\nRemoteClientSystemInfoPacket Sent by login callback every time a new user logs\nin\n\nModuleKeepAlivePacket Tells the C&C server that the connection is still alive\n\nTable 2. The custom UDP packets recognized by the client\n\n|UDP packet|Description|\n|---|---|\n|RemoteModuleCommandPacket|Command to be executed by interactive shell|\n|RemoteModuleCommandResultPacket|Result of running shell command|\n|FileTransferContent_Packet|Determines whether to upload or download a file|\n|UploadFilePacket|Uploaded file content|\n|FileManage_FolderContent_Packet|Folder content|\n|VecProcessPacket|Vector object with running processes|\n|InstallModulePacket|BMP file with encrypted module to be installed|\n|RemoteClientSystemInfoPacket|Sent by login callback every time a new user logs in|\n|ModuleKeepAlivePacket|Tells the C&C server that the connection is still alive|\n\n\n-----\n\nThe backdoor functions implemented in the main client are:\n\n- Interactive shell\n\n- Upload file\n\n- Download file\n\n- List files\n\n- Terminate process\n\n- List processes\n\n- Install module\n\n- Login callback\n\n- Enumerate RDP sessions\n\nThe communication protocol via UDP uses the same RC4 encryption. One sent and/or received packet\n\ncontains a 16-byte RC4 key and the length of an RC4 encrypted payload, followed by another packet\n\nwith the encrypted payload itself.\n\n###### oRAT\n\nWe also saw Windows and macOS samples of the oRAT malware in our investigation. This was the first\n\ntime that we had come across this malware family written in the Go language.\n\nWe found two oRAT droppers in our investigation: a DMG (disk image) file and a fake chat app built using\n\nthe Electron JS framework. We discuss the former in the “MacOS Platform” subsection and the latter in\n\nthe “Infection Vectors” subsection of this report.\n\nThe oRAT samples for both Windows and macOS are flagged as version 0.5.1 and have the same features\n\nand configurations.\n\nThe configuration file and the AES (Advanced Encryption Standard) decryption key are appended in an\n\nencrypted form to the PE (Portable Executable) file overlay.\n\nFigure 7. The decrypted oRAT configuration\n\n\n-----\n\nAfter decrypting the configuration using the AES-GCM (AES with Galois/Counter Mode) algorithm, the\n\nmalware parses it and enables the gateway or traffic forwarder mode if it is specified in the configuration\n\nsettings.\n\nThen, it starts local servers on the infected machine, listening on ports that have been specified in the\n\nconfiguration settings for control commands. This means that the malware operator can directly connect\n\nto the infected machine and execute commands via GET or POST requests.\n\nThe network communications can be in plain text or encrypted, depending on the configuration of the file:\n\n- “tcp” for plain text\n\n- “stcp” for encrypted TCP (Transmission Control Protocol) communications using the golang-tls\n\nlibrary[7]\n\n- “sudp” for encrypted UDP traffic using the Quic-go library[8]\n\nThe malware implements the control server by registering routes.[9] This simple mechanism leads to\n\ntranslating GET/POST requests directly to internal Go commands. Requesting a URL therefore results in\n\nexecuting the corresponding code on an infected system.\n\nWe obtained oRAT samples that register these routes:\n\n- GET /agent/info\n\n- GET /agent/ping\n\n- POST /agent/upload\n\n- GET /agent/download\n\n- GET /agent/screenshot\n\n- GET /agent/zip\n\n- GET /agent/unzip\n\n- GET /agent/kill-self\n\n- GET /agent/portscan\n\n- GET /agent/proxy\n\n- GET /agent/ssh\n\n- GET /agent/net\n\n\n-----\n\n###### PuppetDownloader (C++ Downloader)\n\nWe found samples of a C++ downloader being delivered through fraudulent websites that distribute fake\n\nAdobe Flash Player updates. We describe it in detail in the “Infection Vectors” subsection of this report.\n\nWe have dubbed this downloader PuppetDownloader since we believe that it is closely linked to the\n\nPuppetLoader malware described in a previous subsection of this report.\n\nPuppetDownloader’s infection starts with an executable written in C++ that connects through a Winsock\n\nAPI to a domain or IP address in a specific port. It then saves the downloaded content as SMTemp.dat.\n\nThen, using the executable’s file name and a hard-coded XOR key, it decrypts a file named Loader.dll and\n\ncopies it to the disk. If the executable is renamed, as online sandboxes would do, the DLL decryption fails\n\nand the malware’s second stage does not load.\n\nThe Loader.dll file executes the SMTemp.dat file, if it exists. The loader then decrypts and executes a\n\nlegitimate Adobe Flash Player installer in order to deceive the victim into thinking that the executable is\n\na legitimate installer.\n\nIt should be noted that in all the PuppetDownloader samples that we found during our investigation, the\n\nserver hosting the second-stage malware payload was offline.\n\nIt is also interesting to note that the string decryption routine of this malware is a simple XOR with the\n\nstring “2020-05-24 13:00:29” as its key. The first 13 bytes of the password that is used to decode the\n\nstring are the same as the last 13 bytes.\n\nFigure 8. The XOR decryption routine with a hard-coded string\n\n\n-----\n\nWe believe that PuppetDownloader is connected to PuppetLoader on the basis of these observations:\n\n - PuppetDownloader and PuppetLoader both use the same string decryption routine that uses the\n\nsame key.\n\n - PuppetDownloader and PuppetLoader both use the same XOR key\n\n(2726c6aea9970bb95211304705b5f595) that is used to decrypt the embedded Loader.dll file.\n\n - PuppetDownloader and PuppetLoader’s decrypted Loader.dll files share similar strings such as\n\n“[-] UnExist pwszModuleFunName:”. This suggests that a common framework was used to compile\n\nboth DLLs.\n\n###### MFC Socket Downloaders\n\nWe also found downloaders dropped by WinRAR self-extracting (SFX) files and written using the Microsoft\n\nFoundation Class Library (MFC) framework. These MFC socket downloaders feature an identical structure:\n\nOne function creates a socket, connects to a domain or IP address, sends a short string, and then calls\n\n“recv” twice. They redirect the code flow through a call to EnumDesktopsA or EnumWindows, whose\n\ncallback function pointers point to the downloaded content. The downloaders attempt to access ports\n\n8080, 8885, and 29527, and send the strings “feiji”, “@5436”, and “fhfgj@jfggdsg” to the sockets.\n\nWe found multiple samples of the same malware family that have the same structure and send the same\n\nstrings to the sockets. However, it is possible that multiple malicious actor groups might be covertly\n\nsharing the source code for this malware. This means that these malware samples could be completely\n\nunrelated to Earth Berberoka. Because of this, we chose not to include those samples in our compilation\n\nof indicators of compromise (IOCs) for Earth Berberoka’s campaign.[10]\n\nWhen we limited our analysis to the samples that shared Earth Berberoka’s infrastructure, we discovered\n\nthat we could not download the second stage of the infection chain. The multiple C&C servers we tested\n\ndid not return any content possibly because the remote IP addresses and ports were shut down or\n\nbecause they were filtered.\n\nIn the case of one MFC socket downloader sample, the remote IP address and port returned an assembly\n\ncode and a .NET executable. The expected string was “@5436”, but we noticed that any string containing\n\n“@” would return the malware’s second stage. Because we were not certain whether the related sample\n\nbelonged to Earth Berberoka, we decided not to detail the next stage and related pivoting in this report.\n\n###### PlugX\n\nPlugX[11] is a remote access tool (RAT) that has been used by malicious actors in espionage campaigns for\n\nmore than 10 years. In our investigation, we found multiple samples of the malware targeting both 32-bit\n\nand 64-bit architectures.\n\n\n-----\n\nWhile the features of this malware have been extensively discussed, it seems that it is still being actively\n\ndeveloped. It has been pointed out that PlugX sends a DWORD, which is a 32-bit unsigned integer, in\n\nthe HELLO packet. A compromised system then sends the HELLO packet, which looks like a date in the\n\n“yyyymmdd” format, to the C&C server.[12]\n\nIn the multiple samples that we analyzed, we found the DWORDs “20190520”, “20201106”, and\n\n“20210804”, suggesting that the versions we found were developed within the last three years.\n\nAll of the samples we found are loaded in the same way: A legitimate and signed file that is vulnerable to\n\nDLL sideloading is placed alongside a malicious DLL, which decrypts and loads the third file containing\n\nthe final payload.\n\nOne of these malicious DLL files has the PDB (program database) path C:\\Users\\Administrator\\Desktop\\\n\nPlug7.0(Logger)\\logexts\\x64\\Release\\logexts.pdb. A certificate from the company Gravity signs this\n\nsame file. We discuss Gravity in the “Attribution” section of this report.\n\n###### Gh0st RAT\n\nLike PlugX, Gh0st RAT[13] has been around for more than 10 years.[14] This malware family’s source code is\n\npublic, which is why it has many variants.\n\nDuring our investigation, we found at least three different variants of Gh0st RAT being used in Earth\n\nBerberoka’s campaign. One of them had an interesting destructive feature: It replaces the master boot\n\nrecord (MBR) to display an explicit message (“I am virus ! F*ck you :-)”). This particular message was also\n\nseen in a public report from a victim of this Gh0st RAT variant.[15] A 2017 Industrial Control Systems Cyber\n\nEmergency Response Team (ICS-CERT) report also discussed how Gh0st RAT variants wiped the MBR\n\nand replaced it with messages that varied across different samples.[16]\n\n###### Other Known Malware Families\n\nBy pivoting on domain names, we found other known malware families that Earth Berberoka had used in\n\nsome of its targeted attacks:\n\n - AsyncRAT – an open-source RAT that can be used to remotely monitor and control devices via an\n\nencrypted connection\n\n - Quasar RAT – a Windows-based open-source RAT that has been used by APT groups for network\n\nexploitation\n\n- Trochilus – a stealthy RAT that can evade sandbox analysis and can be used in cyberespionage\n\ncampaigns\n\n\n-----\n\n###### Linux Platform\n\n Xnote\n\nWe found multiple samples of Xnote, a backdoor that targets the Linux platform.[17] Although this malware\n\nhad been in the wild for at least six years, we did not find any report of its being used by advanced threat\n\nactors or in relation to espionage. What we found was a 2019 report that states how cybercriminals used\n\nXnote to attack web servers to insert content that promoted gambling websites.[18]\n\nDr.Web attributes the development of Xnote to the ChinaZ group,[19] a threat actor group known for using\n\nLinux botnets in its DDoS attacks. This malware has typical backdoor capabilities such as uploading and\n\ndownloading files, executing arbitrary commands, and giving access to a shell. It can also be used to start\n\na SOCKS (Socket Secure) proxy and a portmap server.\n\nInterestingly, one of the Xnote samples we found is linked to a domain name that we encountered during\n\nour Operation DRBControl investigation.[20] Our analysis showed that the configuration files used by this\n\nmalware can be decrypted. It also has C&C domains, ports, and a field that could be some sort of\n\ncampaign identifier.\n\nAmong Xnote’s different configurations, we found a couple of strings that are possibly gambling-related,\n\nsuch as “caipiao”, which means “lottery” in Chinese, and “W88”, which could refer to a gambling website.[21]\n\nIt is also worth noting that upon execution, the malware creates and blocks the file /tmp/.wq4sMLArXw.\n\nThis is a typical behavior of malware families that prevents them from running in an already infected\n\ncomputer, similar to how a mutual exclusion object (mutex) is used in the Windows platform.\n\n###### HelloBot\n\nHelloBot is a Linux-targeting malware family that was first detected by MalwareMustDie in early 2019.[22]\n\nDuring our investigation, we saw Chinese comments in the decrypted configuration files of HelloBot. We\n\nalso discovered that HelloBot is cross-platform. We found multiple Linux ELF (Executable and Linkable\n\nFormat) samples and one Windows PE sample of HelloBot that are connected to the Earth Berberoka\n\ncampaign.\n\nUpon decrypting the configuration files, we saw that the HelloBot samples contained multiple fields. The\n\nfollowing is an example of a decrypted configuration file in the Linux version. (The decrypted configuration\n\nfile included comments in Chinese. We translated these comments to English for this report).\n\n\n-----\n\n[main]\n\n;上线域名端口 – Active domain name and port\n\nhost0=linux.daj8.me:443\n\n;组名称 – Group name\n\ngroup=yeji\n\n;安装后的文件名 注意：不能选择 tmp 目录 – File name after installation Note: tmp\n\ndirectory cannot be selected\n\ninstall_path=/usr/bin/dpkg-apts\n\n;安装之后备份的安装文件路径 – The backup path after installation\n\ninstall_path_bak=/usr/bin/retatelogs\n\n;上线间隔 5 秒重连一下 – Reconnect every 5 seconds\n\nretry_interval=5\n\n;域名解析使用的 DNS 注意 国内已经封锁了 8.8.8.8 – DNS used for domain name resolution\n\nNote that 8.8.8.8 has been blocked in China\n\ndns=114.114.114.114\n\n;伪装的进程名称 – Masquerading/fake process name\n\nfake_ps=[ksoftirqd/0]\n\n;自启动 – Self-start/self-boot\n\nauto_start=1\n\n;备注 – Remark\n\nnote=\n\n;锁文件 – Lock file\n\nlock_file=/bin/sh\n\n;插件目录 – Plugin directory\n\nplugin_dir=/usr/lib/plgs/\n\n;监控进程循环执行检测的时间间隔 – Monitor the time interval of process-checking loop\n\n\n-----\n\nmon_interval=10\n\n;监控进程每次检查要执行的命令 – Monitor the command to be executed for process-checking\n\n;cmd0=”fuser -k /tmp/.wq4sMLArXw”\n\n;是否自动清除iptables规则 木马会自动执行 iptables -F – Whether to automatically clear\n\niptables rules. Trojan will automatically execute the command “iptables -F”\n\nclose_iptable=0\n\n;运行目录，启动之后会复制自身到这个目录来运行 – Running directory to where it will copy\n\nitself for running after startup\n\ntmp_start_dir=/var/tmp\n\n\nThe following table indicates the additional fields in the Linux version.\n\n**Field** **Description**\n\nhost0 C&C address\n\ninstall_path, install_path_bak Paths to the malicious executable\n\nretry_interval Connection to C&C server time interval (in seconds)\n\ndns DNS server IP address (114.114.114.114 is a public\nChinese DNS server.[23])\n\nfake_ps Disguised process name appearing in “ps” output\n\nauto_start Identifies whether persistence is enabled or not\n\nnote Developer’s remarks\n\nplugin_dir Directory containing additional plug-ins\n\nmon_interval Execution of monitoring process time interval\n\ncmd0 Commands to be executed by the monitoring process\n\nclose_iptable Automatically flushes firewall (iptables) rules if the\nvalue is 1. If the value is 0, nothing happens.\n\ntmp_start_dir Directory from which the malicious executable is\nlaunched\n\nTable 4. The additional fields in the Linux version of HelloBot\n\nThe following is the decrypted Windows version of HelloBot. (The decrypted configuration file included\n\ncomments in Chinese. We translated these comments to English for this report).\n\n|Field|Description|\n|---|---|\n|host0|C&C address|\n|install_path, install_path_bak|Paths to the malicious executable|\n|retry_interval|Connection to C&C server time interval (in seconds)|\n|dns|DNS server IP address (114.114.114.114 is a public Chinese DNS server.23)|\n|fake_ps|Disguised process name appearing in “ps” output|\n|auto_start|Identifies whether persistence is enabled or not|\n|note|Developer’s remarks|\n|plugin_dir|Directory containing additional plug-ins|\n|mon_interval|Execution of monitoring process time interval|\n|cmd0|Commands to be executed by the monitoring process|\n|close_iptable|Automatically flushes firewall (iptables) rules if the value is 1. If the value is 0, nothing happens.|\n|tmp_start_dir|Directory from which the malicious executable is launched|\n\n\n-----\n\n[main]\n\n;上线域名端口 – Active domain name and port\n\nhost0=win.googie.ph:443\n\n;组名称 – Group name\n\ngroup=windows\n\n;设置互斥，为空不设置互斥体 – Set a mutex; it will not set the mutex if it is null/empty\n\nmutex=\n\n;自启动注册表键值 – Autostart registry key value\n\nautorun_key=ctfmon\n\n;安装后的文件名 注意：目录必须存在 – Filename after installation. Note: The directory\n\nmust exist\n\ninstall_path=c:\\windows\\system32\\ctfmon3.jpg\n\n;上线间隔 5 秒重连一下 – Reconnect every 5 seconds\n\nretry_interval=5\n\n;自启动 – Self-start/self-boot\n\nauto_start=1\n\n;备注 – Remark\n\nnote=\n;服务名称 – Service name\n\nsvr_name=NetCrypt\n\n;服务描述 – Service description\n\nsvr_desc=Crypt data transfer on local network\n\n;服务显示名称 – Service display name\n\nsvr_display_name=Net.Crypt\n\n;0 UDP 1 TCP 2 UDP & TCP 3 HTTP\n\nprotocol=1\n\n\n-----\n\nThe following table indicates the additional fields in the Windows version.\n\n**Field** **Description**\n\nmutex Name of a mutex set by the malware\n\nautorun_key Value of the registry key set for persistence\n\nsvr_name Name of the service used for persistence\n\nsvr_desc Description of the service used for persistence\n\nsvr_display_name Display name of the service used for persistence\n\nauto_start Identifies whether persistence is enabled or not\n\nprotocol Protocol used for network communication (UDP, TCP,\nUDP and TCP, or HTTP)\n\nTable 5. The additional fields in the Windows version of HelloBot\n\nWe found the “note” values “rootkit” and “web”. We also found the following “group” values in multiple\n\nconfiguration files, some of which have possible China- or gambling-related meanings.\n\n**“Group”**\n**Note**\n**value**\n\naite Could refer to the AITE Institute,[24] an international school that has\nheadquarters in Suzhou, China\n\nidc Could refer to International Data Corporation (IDC) China[25]\n\nCG A type of lottery\n\nSF A type of lottery\n\nyabo Could refer to the Yabo gambling website[26]\n\nyeji A group value that is also present in the decrypted Xnote configuration\n\ngamebox\n\nbos\n\nxingcai\n\njinbo\n\nqp\n\nabcb\n\nwindows\n\nTable 6. “Group” values found in multiple configuration files of HelloBot\n\n|Field|Description|\n|---|---|\n|mutex|Name of a mutex set by the malware|\n|autorun_key|Value of the registry key set for persistence|\n|svr_name|Name of the service used for persistence|\n|svr_desc|Description of the service used for persistence|\n|svr_display_name|Display name of the service used for persistence|\n|auto_start|Identifies whether persistence is enabled or not|\n|protocol|Protocol used for network communication (UDP, TCP, UDP and TCP, or HTTP)|\n\n|“Group” value|Note|\n|---|---|\n|aite|Could refer to the AITE Institute,24 an international school that has headquarters in Suzhou, China|\n|idc|Could refer to International Data Corporation (IDC) China25|\n|CG|A type of lottery|\n|SF|A type of lottery|\n|yabo|Could refer to the Yabo gambling website26|\n|yeji|A group value that is also present in the decrypted Xnote configuration|\n|gamebox||\n|bos||\n|xingcai||\n|jinbo||\n|qp||\n|abcb||\n|windows||\n\n\n-----\n\nThe developers of HelloBot used object-oriented programming, and we were able to identify several self\nexplanatory class names during our analysis. We saw that some of the classes were not implemented,\n\nwhich likely means that Earth Berberoka reused the source code and implemented only select features.\n\nThe following analysis is based on the Windows version of HelloBot (with the SHA-256 hash value\n\n74d93253090f999977fa8e32b03b94bb8d35f59a8390545fd10da0f7fb1fcd13). The sample starts the\n\nC&C communication thread by processing these bot commands:\n\n- Uninstall\n\n- Restart\n\n- Update\n\n- Change_grp\n\n- Change_note\n\n- Manager_exit\n\n- Monitor_exit\n\nThe Windows HelloBot sample also executes a monitor thread, which checks if the bot has not been\n\nremoved from its install_path and if persistence settings are still present, and a manager thread. The\n\nmanager thread receives tasks from C&C servers and processes them.\n\n**Task** **Description**\n\nCManager Performs client management operations such as CShellTask,\nCFileTask, CPortMapTask, and CProxyTask\n\nCFileTask Performs file operations such as move, delete, list files, upload,\ndownload, create directory, run file, and list disks\n\nCPortmapTask Port scanner\n\nCProxyTask Proxy server\n\nCShellTask Interactive shell\n\nCRdpInfectTask Not implemented\n\nCSvchostInstaler Runs HelloBot as a service\n\nCAntiAV Not implemented\n\nCKeepLiveTask Sends keepalive (heartbeat) packet every five seconds\n\nTable 7. HelloBot’s client management tasks\n\nThe communication with the HelloBot C&C is done via TCP. The headers in the following figure show\n\nHTTP Host header spoofing. HelloBot spoofs HTTP Host headers to show traffic that appears as requests\n\nfrom legitimate sites.[27] In our investigation, we saw that HTTP headers appear to show traffic to a popular\n\nChina-based search engine.\n\n|Task|Description|\n|---|---|\n|CManager|Performs client management operations such as CShellTask, CFileTask, CPortMapTask, and CProxyTask|\n|CFileTask|Performs file operations such as move, delete, list files, upload, download, create directory, run file, and list disks|\n|CPortmapTask|Port scanner|\n|CProxyTask|Proxy server|\n|CShellTask|Interactive shell|\n|CRdpInfectTask|Not implemented|\n|CSvchostInstaler|Runs HelloBot as a service|\n|CAntiAV|Not implemented|\n|CKeepLiveTask|Sends keepalive (heartbeat) packet every five seconds|\n\n\n-----\n\nFigure 10. HelloBot’s HTTP Host header spoofing\n\nAside from the fake headers, we also saw zlib-compressed data that contains infected machine information.\n\nKeepalive (heartbeat) packets follow a similar format: the packet length (0x11), the payload length (0x01),\n\nand the zlib compression level (78 9c), which is the default zlib compression level.[28] The keepalive packet\n\ndecompresses to just one character, the letter “e”.\n\nWe found over a hundred old HelloBot samples, some of which we could cluster based on their\n\ninfrastructure. One cluster caught our eye because the decrypted configuration files contained in the\n\nsamples mentioned several Chinese news websites, suggesting that they could be or were potential\n\ntargets. We no longer included the details in this report because the samples are not connected to Earth\n\nBerberoka.\n\n###### Connection to Xnote\n\nWe noticed an interesting command in some configurations of the HelloBot samples that we analyzed:\n\n\nfuser -k /tmp/.wq4sMLArXw\n\n\nThis command kills every process accessing the /tmp/.wq4sMLArXw file. As discussed in the “Xnote”\n\nsubsection of this report, Xnote creates the /tmp/.wq4sMLArXw file to avoid running on an already infected\n\ncomputer. This means that the HelloBot process would kill the Xnote process. We can only hypothesize\n\nabout the logic behind this behavior. It is possible that it is meant to kill off malware competitors, similar to\n\nwhat happened between the SpyEye and ZeuS botnet malware over a decade ago.[29] Another possibility\n\ncould be that HelloBot is a newer version of Xnote.\n\n\n-----\n\n###### Pupy RAT\n\nPupy is a cross-platform RAT written in Python whose code is available on GitHub.[30] We found some Linux\n\nsamples of Pupy linked to domain names owned by Earth Berberoka. One of these was hidden by the\n\nReptile rootkit, which we discuss in the succeeding subsection.\n\nIn typical deployments of Pupy, its malicious ELF file is copied and run from /usr/bin/atd. In the case of\n\nEarth Berberoka, the configuration was customized: The malicious process is displayed as “[kworker/2:0]”\n\nin the process list.\n\n###### Reptile Rootkit\n\nReptile[31] is an open-source rootkit that uses a kernel module to hide files, directories, processes, and\n\nnetwork connections. During our investigation, we found it being used to hide connections and processes\n\nrelated to a sample of the Pupy RAT.\n\nThe following Bash configuration script of Reptile includes the [kworker/2:0] process name, which is the\n\nsame process name that we mention in the preceding subsection on Pupy. The DEFAULT_IP address is\n\nlinked to the dust[.]github[.]wiki domain name, which is a C&C server of one of the Pupy samples.\n\nFigure 11. The Reptile rootkit’s Bash configuration script\n\nThe persistence is done via a kernel module launched through a udev rule copied into the\n\n/usr/lib/udev/rules.d/ directory, which has the following content.\n\n\n-----\n\nFigure 12. Persistence via the udev rule\n\nThe backdoor is split among different files. In our investigation, the backdoor was named k5734, but the\n\ndefault name is “reptile”:\n\n- k5734 – the kernel module\n\n- k5734_cmd – a userland executable that handles some specific keywords, such as “hide”, “show”,\n\n“root”, and “conn”, that send input/output controls (IOCTLs) to the kernel module\n\n- k5734_shell – a userland shell that handles other commands and IOCTLs\n\n- k5734_start – a Bash script that contains the rootkit’s configuration\n\nOur findings are consistent with the content of the default Bash installation script[32] in the code repository.\n\nDuring its launch, the Reptile module is first decrypted in memory through a custom rol32 routine (in our\n\nanalysis, the decryption key was 0xD75581AA) and is then loaded through the kmatryoshka loader[33] (with\n\nthe decryption key 0x3D8F0A02).\n\n###### Modified System Binaries\n\nWe found two slightly modified Linux binaries in the wild. The first one was lsof, a legitimate tool that\n\ncan display information such as opened files or network connections in a Linux system. In our analysis,\n\nwe found that Earth Berberoka added a slight modification to avoid displaying specific items such as IP\n\naddresses.\n\nThe malicious lsof binary that we found modified the print_file function to skip the printing in case the\n\ncurrent item matched a specific IP address. This was done by adding two calls to the strstr function.\n\nFigure 13. A modified lsof binary\n\nThe specific IP address was linked to, among others, the domain name linux[.]daj8[.]me, which is a C&C\n\nserver of some HelloBot samples that we found.\n\n\n-----\n\nThe second modified binary was ps, which displays current running processes. Earth Berberoka modified\n\nit to skip displaying a process if it was named [ksoftirqd/0] and also used the strstr function for that\n\npurpose.\n\nFigure 14. A modified ps binary\n\nWe found the [ksoftirqd/0] process name in multiple HelloBot configurations. By combining these modified\n\nLinux system binary findings, we found multiple HelloBot samples that matched.\n\nThe following is an excerpt of a HelloBot configuration file that contains the process name that is hidden\n\nby the modified ps binary. The HelloBot configuration file also contains the domain name that is related\n\nto the IP address hidden by the modified Isof binary.\n\nFigure 15. A HelloBot configuration that contains the domain name hidden by the modified ps binary\nand the domain name that is related to the IP address hidden by the modified Isof binary\n\n###### MacOS Platform\n\nWe found two malicious macOS binaries related to Earth Berberoka: a DMG file and a fake chat app.\n\n###### DMG File\n\nWe found the first malicious macOS binary on VirusTotal, a DMG file named “bitget-0.0.7 (1).dmg.” It\n\ncontained an XAR (extensible archive) file named “Bitget Apps.pkg.”\n\nAfter extracting the XAR archive, we noticed that the PackageInfo file referenced “preinstall” scripts.\n\nFigure 16. The PackageInfo file referencing “preinstall” scripts\n\n\n-----\n\nWe also observed a “Scripts” gzip (GNU zip) file in the “Flash_Player.pkg/preinstall” directory, which\n\ncontained certain Bash commands.\n\nFigure 17. A Bash command from the “Flash_Player.pkg/preinstall” directory\n\nThat URL leads to the sample ee07dfd6443af8f20f5f11effb9cbcec07e125697a28aee78718caeed17f1407,\n\nwhich is a UPX x64 Mach-O executable. After we unpacked the executable, we noticed that it was the\n\nsame oRAT malware version that we discuss in the subsection on the Windows platform of this report.\n\n###### Fake Chat App\n\nWe also found a malicious website delivering Windows and macOS files for a chat app named MiMi.\n\nWhen a user selects the “Mac” app option from the website’s menu, a file named mmchat-1.1.6.3.dmg is\n\ndownloaded. We discuss this website and the mmchat-1.1.6.3.dmg file content further in the “Infection\n\nVectors” subsection of this report.\n\nAfter analyzing the Info.plist of the MiMi chat app, we observed the following:\n\n - NSTemporaryExceptionAllowsInsecureHTTPLoads is enabled, which allows the malicious app to\n\nconnect to HTTP websites.\n\n - NSCameraUsageDescription is set to “用于进行视频通话”, which states that camera permission is\n\nrequested by the app for supposed video calls.\n\n - NSMicrophoneUsageDescription is set to “用于进行语音通话”, which states that microphone permission\n\nis requested by the app for supposed voice calls.\n\nThe final payload is a macOS version of the oRAT malware.\n\n###### Infrastructure\n\nThis report discusses a number of malware families used in targeting three different platforms. These\n\nmalware families are all linked by their infrastructure, and this was how we were able to connect them\n\nall to the same threat actor group, Earth Berberoka. As previously mentioned, although we found some\n\nsamples that could be related to Earth Berberoka based on their respective codes, we chose not to list\n\nthem here to avoid the risk of linking different groups that might only be using the same source codes or\n\nbuilders.\n\nDuring our investigation, we saw that some domain names were connected to multiple malware families.\n\nUsually, each malware family would point to a different domain name. For example, we found multiple\n\n“linux.*” subdomains linked to Linux malware families.\n\n\n-----\n\nWe noticed one case where the root domain, github.wiki, hosted a copy of GitHub’s documentation while\n\nmultiple subdomains were listed as C&C servers of multiple malware families. This was likely done to\n\nincrease the chances of the whole domain’s being allowlisted or misclassified during threat investigations.\n\nFigure 18. A copy of GitHub’s documentation hosted on a root domain\n\n###### Infection Vectors\n\nWe found different infection vectors that were used in the delivery of some of the malware families that\n\nwe linked to Earth Berberoka.\n\n###### Backdoored ‘Secure’ Chat App\n\nIt seems somewhat common for apps to use some variation of “MiMi” as part of their names. It is unclear\n\nwhether there is any relationship between any other apps that use this name and the app discussed\n\nin this report, such as an attempt to confuse potential users about the identity or origin of the app in\n\nquestion. Based on our analysis, the app that this report is concerned with is one that connects to the\n\nmmchat.online domain to make the chat features work and contains embedded malware. And although\n\nthe app loads malicious code, it should be noted that we did not analyze the app itself as it seemed to be\n\na legitimately functioning chat app.\n\nWe found a website written in Chinese offering a so-called secure chat platform named MiMi. In Chinese,\n\n“mì mì (密密)” means “secret,” ergo “secret chat application.” The website links to an installer for both\n\nWindows and macOS.\n\nIf the width of a web browser was lower than 720 pixels, the mobile version of the website was displayed.\n\nHowever, based on our experience, the Android and iOS links were empty or did not contain any values.\n\nWe are unsure if the website’s template was not properly customized at the time of our investigation or if\n\nthe malicious actors behind the website had planned to target those platforms in the future.\n\n\n-----\n\nFigure 19. The MiMi chat website as displayed on a screen\nwith a width higher than 720 pixels\n\nFigure 20. The MiMi chat website as displayed on a screen\nwith a width lower than 720 pixels (mobile version)\n\n\n-----\n\nWe could not find any public source for MiMi, so we do not know if the malicious actors behind the\n\nchat app wrote it from scratch or if it impersonates a private platform that is relevant to its targets. It\n\nis common for gambling companies in China to use custom chat apps to avoid being spied on by the\n\ngovernment. A “private” chat app like this could be an attractive lure as users would think that it would\n\nnot be monitored by the government, unlike popular chat apps such as WeChat.\n\nInstallation begins once the MiMi app executable is launched. Meanwhile, another executable with\n\nmalware is also downloaded and runs in the background. After the MiMi chat app has been successfully\n\ndownloaded, the app’s chat user interface appears.\n\nFigure 21. Installation of the MiMi chat app, which begins\nimmediately after the MiMi chat app executable is launched\n\nFigure 22. The launched MiMi chat user interface, shown while another executable with malware\nis running in the background\n\nBoth the executable’s icon and the image displayed next to the login prompt were taken from public\n\nsources.[34]\n\n\n-----\n\nFigure 23. The MiMi chat app registration screen, with the mobile number registration field\nfeaturing a drop-down menu with mostly Asian phone number prefixes\n\nMiMi prompts new users to register with either a phone number or an email address. The choices of\n\ncountries that the app supports are limited to the US, Canada, and Asian countries, based on the phone\n\nnumber prefixes available in the drop-down menu:\n\n- +1: USA\n\n- +1: Canada\n\n- +63: Philippines\n\n- +65: Singapore\n\n- +66: Thailand\n\n- +81: Japan\n\n- +82: South Korea\n\n- +852: Hong Kong\n\n- +853: Macao\n\n- +86: China\n\n- +886: Taiwan\n\nThis reinforces our belief that gambling websites catering to Asian countries are the primary targets of\n\nEarth Berberoka.\n\n\n-----\n\nThe MiMi chat app is written using Electron JS, a JavaScript framework using the Node.js runtime software\n\nstack. In the Resources/app/package.json file, the “private” item is set to “True”, which means that the\n\npackage is not intended for publication. Also, the “main” item points to the ./electron-main.js file, which\n\ncontains some lines that are processed after Electron has finished initializing.[35]\n\nIn the macOS version of the MiMi chat app, two different executables are referenced:\n\n- ./mimi.app/Contents/Resources/app/statics/deps/windowsx64\n\n- ./mimi.app/Contents/Resources/app/statics/deps/darwinx64\n\nThey are both samples of the oRAT malware that we discuss in a previous subsection of this report. They\n\nare of the same malware variant — one is compiled in the PE format while the other is compiled as a\n\nMach-O executable — and both can be found in the mimi.app/Contents/Resources/app/statics/deps\n\nfolder after decompression of the DMG file. Ironically, the Windows executable will never be launched\n\nsince a DMG file will never run on the Windows platform.\n\nFigure 24. An excerpt of the macOS version of electron-main.js (beautified)\n\nOn the Windows platform, the electron-main.js file references a file named USOPrivate.\n\nFigure 25. An excerpt of the Windows version of electro-main.js (beautified)\n\n\n-----\n\nThe resources/app/statics/deps folder contains three files:\n\n- resources/app/statics/deps/USOPrivate.exe\n\n- resources/app/statics/deps/log.dll\n\n- resources/app/statics/deps/USOPrivate.dat\n\nThe USOPrivate.exe file is a legitimate file signed by Bitdefender and is vulnerable to DLL sideloading.\n\nBy exploiting an untrusted search path vulnerability (CVE-2019-17100),[36] the malicious log.dll file is\n\nloaded, which in turn loads the USOPrivate.dat file in memory and executes the code inside it. After being\n\nunpacked in memory, the resulting sample is a recent 64-bit version of the PlugX malware.\n\nLoads\n(if Windows)\n\nPlugX malware\n\nVisits Delivers\n\n|Col1|Col2|Delivers|\n|---|---|---|\n||||\n\n\nTarget\n\n\nChat app’s website Electron JS chat app\n\n\nLoads\n(if macOS)\n\noRAT malware\n\nFigure 26. Earth Berberoka’s infection chain via the MiMi chat app’s website\n\n###### Fake BitGet App\n\nIn our investigation, we also saw that Earth Berberoka had created a fake BitGet app for macOS. BitGet\n\nis a Singapore-based cryptocurrency exchange app.\n\nThe preinstall script of the fake BitGet app downloads and executes the oRAT malware.\n\nFigure 27. The preinstall script of the fake BitGet app\n\n###### Fake Website Delivering Backdoored Adobe Flash Player Installer\n\nWe noticed that Earth Berberoka exploited a persistent cross-site scripting (XSS) vulnerability in a\n\nlegitimate website to execute JavaScript code hosted in a third-party server. The injected code calls a\n\nPHP script named xss.php, verifies that the victim is running Windows, and sets a cookie to ensure the\n\ncode will not be executed more than once. Then, it displays a pop-up with a message in Chinese stating\n\nthat the version of Adobe Flash Player is too old to display the content and redirects the victim to a\n\nwebsite offering Adobe Flash Player.\n\n\n-----\n\nFigure 28. An XSS attack pop-up message on a legitimate website\n\nWe found multiple websites that promise victims a free version of Adobe Flash Player but in fact tricks\n\nthem into downloading malware. While this technique is not new, we thought that the lure would not be\n\nas appealing to users since Adobe has not supported Flash Player since Dec. 31, 2020, and all major\n\nbrowsers have disabled Flash plug-ins. However, we discovered that Adobe officially allows a third-party\n\neditor to deliver a version of Flash Player in mainland China through the flash.cn website.\n\nLoads JS code\nVisits and PHP script\n\nLegitimate website XSS platform\n\nRedirects\n\nTarget C&C or download server\n\nFalls for Delivers Connects to\nlure\n\nFake Adobe Malware\nFlash Player website\n\nFigure 29. Earth Berberoka’s infection chain via a fake website offering a backdoored\nAdobe Flash Player installer\n\nThis malicious website is also written in Chinese, which is consistent with the other fake websites related\n\nto Earth Berberoka’s campaign. This suggests that Earth Berberoka primarily targets Chinese-speaking\n\nindividuals.\n\n|Col1|Loads JS code|\n|---|---|\n||Loads JS code and PHP script|\n|||\n|||\n\n|Col1|Col2|\n|---|---|\n|||\n|||\n||Delivers|\n\n\n-----\n\nFigure 30. A Fake Chinese Adobe Flash Player website\n\nAll of the Earth Berberoka–related websites that we analyzed looked identical and delivered different\n\npayloads throughout 2021.\n\nDuring our investigation of the third-party server hosting the injected JavaScript code and xss.php script,\n\nwe noticed that it also hosted an authentication page titled “Xss平台”, which means “Xss platform.”\n\nFigure 31. An XSS platform authentication page\n\nThe message at the bottom of the page is a disclaimer explaining that it is a private access platform and\n\nthat there are free XSS platforms available on the internet. Upon checking the HTML source code of this\n\nauthentication page, we noticed a comment advising to compare the hash of a file named “XSS平台源\n\n码.rar” (“XSS platform source code”) with the hash stored in a now-closed Chinese forum. This comment\n\nsuggests that the source code for the XSS platform was downloaded from that forum. Our assumption\n\nis that this platform allows malicious actors to automatically search for XSS vulnerabilities in remote\n\nwebsites and inject code of their choice. The invoked xss.php script is probably meant to collect statistics\n\non or keep track of victims.\n\nBased on our telemetry, we saw that two websites were exploited. One is a news website aimed at the\n\nChinese community of a large US city, while the second is an unknown website that was offline and had\n\nno domain name at the time of our investigation.\n\n\n-----\n\n## Attribution\n\n\nC&C domain\nshopingchina.net\n\n\nOperation Domain name Winnti Connecting\nDRBControl (passive DNS) (Casper/Lead) the dots\n\n\nXnote ChinaZ\n\n\nOperation Iron Tiger Signing certificate\nPZCHao from Gravity\n\n\nFigure 32. Potential links between different threat actor groups\n\nOne of the DLLs used in one of the 64-bit PlugX samples that we found was signed with a stolen certificate\n\nfrom the Gravity company. QuoIntelligence believes that Gravity might be one of the gaming companies\n\ntargeted by the Winnti group.[37] If this proves to be true, Earth Berberoka could be linked to the Winnti\n\ngroup, based on ESET’s description of the Winnti group in its paper.[38]\n\nOne of the Xnote samples we found had linux[.]shopingchina[.]net as its C&C domain. We previously saw\n\nthe shopingchina[.]net domain during our investigation of Operation DRBControl.\n\nWe linked the shopingchina[.]net domain to the following malware families:\n\n- A Type 1 sample with test66[.]shopingchina[.]net as its C&C domain\n\n- Trochilus samples with fn[.]shopingchina[.]net as their C&C domain\n\n- MFC keyloggers with jqb[.]shopingchina[.]net as their C&C domain\n\nWe have yet to see the Type 1 malware family, which is a backdoor written in C++ that uses Dropbox as\n\na secondary C&C channel, being used by other threat actors. However, this does not mean it could not\n\nbe a shared tool.\n\n\n-----\n\nThere are two potential connections between Earth Berberoka and Iron Tiger. It should be noted, though,\n\nthat the possibility of these groups’ being connected is slim. In Operation DRBControl, the HyperBro\n\nmalware family was used, and we have come to associate it with the Iron Tiger group.\n\nAccording to Dr.Web, Xnote was developed by the ChinaZ group.[39] And because of a shared Gh0st RAT\n\nRC4 decryption key, a report by Intezer mentions some links between ChinaZ and Operation PZChao,[40]\n\nwhich Bitdefender also believes to be linked to Iron Tiger.[41]\n\nOperation DRBControl also has some links to the Winnti group, according to a report by ClearSky Cyber\n\nSecurity that features Operation DRBControl’s infrastructure and samples.[42] More specifically, BlackBerry\n\nattributes the related domain names to the Casper APT group (aka Lead).[43, 44]\n\nBecause these links are extremely complicated and do not provide evidence for strict attribution, we\n\ndecided to name the threat actors behind this operation. One of our goals for publishing our findings is to\n\nhelp other researchers in making their own assessments.\n\nRegarding Earth Berberoka’s origin, several clues point toward Chinese-speaking threat actors, although\n\nnone of them are high-confidence:\n\n- The encrypted configuration of some HelloBot samples contain comments or words in Chinese.\n\n- Some of the malware families, such as PlugX and Gh0st RAT, are known to be of Chinese origin.\n\n- A probable malware control panel we found in a domain related to this group has a login prompt in\n\nChinese.\n\nFigure 33. A probable malware control panel in Chinese\n\n\n-----\n\n## Conclusion\n\nThis investigation shows that the threat actor group behind this operation has a lot of manpower, on account\n\nof the large infrastructure and the various tools it has developed and used. Based on our telemetry and\n\nother hints we discuss in this report, we were able to assess that the group primarily targets the gambling\n\nindustry catering to Asia, more specifically Chinese-speaking users and operators of gambling websites.\n\nEarth Berberoka uses a plethora of tools. Some of these are malware families that have existed for more\n\nthan 10 years and that the group has enhanced, while others are malware families that it seemingly built\n\nspecifically for this campaign. It is also interesting to see Earth Berberoka’s use of portable frameworks\n\nand languages such as Electron JS and Golang to target multiple platforms.\n\nWe also found that some Linux malware families that were believed to have been used for cybercrime\n\ncould also be used for espionage. Earth Berberoka did not hesitate to use open-source malware families\n\nsuch as the Pupy RAT and the Reptile rootkit for this purpose.\n\nFinally, this investigation shows the difficulty in attributing such an infrastructure when the threat actors\n\nbehind it use tools that are shared among multiple groups.[45]\n\n\n-----\n\n##### References\n\n1 S. Lock. (March 10, 2022). Statista. “Market size of the online gambling industry worldwide from 2019 to 2023.” Last accessed\n[on April 11, 2022, at https://www.statista.com/statistics/270728/market-volume-of-online-gaming-worldwide/.](https://www.statista.com/statistics/270728/market-volume-of-online-gaming-worldwide/)\n\n2 University of Bristol. (May 17, 2021). ScienceDaily. “Study shows online gambling soared during lockdown, especially among\n[regular gamblers.” Accessed on April 11, 2022, at https://www.sciencedaily.com/releases/2021/05/210517083636.htm.](https://www.sciencedaily.com/releases/2021/05/210517083636.htm)\n\n3 Trend Micro Research. (Feb. 18, 2020). Trend Micro Security News. “Operation DRBControl: Uncovering a Cyberespionage\n[Campaign Targeting Gambling Companies in Southeast Asia.” Accessed on April 1, 2022, at https://www.trendmicro.com/](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-companies-in-southeast-asia)\n[vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-companies-in-southeast-asia)\n[companies-in-southeast-asia.](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-companies-in-southeast-asia)\n\n4 Ionut Ilascu. (March 31, 2021). Bleeping Computer. “800Gbps DDoS extortion attack hits gambling company.” Accessed\n[on April 11, 2022, at https://www.bleepingcomputer.com/news/security/800gbps-ddos-extortion-attack-hits-gambling-](https://www.bleepingcomputer.com/news/security/800gbps-ddos-extortion-attack-hits-gambling-company/)\n[company/.](https://www.bleepingcomputer.com/news/security/800gbps-ddos-extortion-attack-hits-gambling-company/)\n\n5 [Nick Carr (@ItsReallyNick). (May 15, 2020). Twitter. Accessed on April 18, 2022, at https://twitter.com/ItsReallyNick/](https://twitter.com/ItsReallyNick/status/1261318098092724226)\n[status/1261318098092724226.](https://twitter.com/ItsReallyNick/status/1261318098092724226)\n\n6 [Microsoft. (Oct. 7, 2021). Microsoft. “PEB_LDR_DATA structure (winternl.h).” Accessed on April 1, 2022, at https://docs.](https://docs.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb_ldr_data)\n[microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb_ldr_data.](https://docs.microsoft.com/en-us/windows/win32/api/winternl/ns-winternl-peb_ldr_data)\n\n7 [Denis Denisov. (Nov. 21, 2020). GitHub. “go-lang tls.” Accessed on April 4, 2022, at https://github.com/denji/golang-tls.](https://github.com/denji/golang-tls)\n\n8 [Lucas Clemente. (March 22, 2022). GitHub. “quic-go.” Accessed on April 4, 2022, at https://github.com/lucas-clemente/quic-](https://github.com/lucas-clemente/quic-go)\n[go.](https://github.com/lucas-clemente/quic-go)\n\n9 Develop Paper. (Dec. 12, 2020). Develop Paper. “Understanding the implementation of HTTP server in golang.” Accessed on\n[April 4, 2022, at https://developpaper.com/understanding-the-implementation-of-http-server-in-golang/.](https://developpaper.com/understanding-the-implementation-of-http-server-in-golang/)\n\n10 Daniel Lunghi and Jaromir Horejsi. (April 27, 2022). Trend Micro Research, News, and Perspectives. “New APT Group Earth\n[Berberoka Targets Gambling Websites With Old and New Malware.” Accessed on May 6, 2022, at https://www.trendmicro.](https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html)\n[com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html.](https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html)\n\n11 Trend Micro. (Sept. 17, 2012). Trend Micro Research, News, and Perspectives. “Unplugging PlugX Capabilities.” Accessed on\n[April 5, 2022, at https://www.trendmicro.com/en_us/research/12/i/unplugging-plugx-capabilities.html.](https://www.trendmicro.com/en_us/research/12/i/unplugging-plugx-capabilities.html)\n\n[12 Fabien Perigaud. (June 1, 2014). Airbus Cybersecurity. “PlugX: some uncovered points.” Accessed on April 5, 2022, at https://](https://airbus-cyber-security.com/plugx-some-uncovered-points/)\n[airbus-cyber-security.com/plugx-some-uncovered-points/.](https://airbus-cyber-security.com/plugx-some-uncovered-points/)\n\n[13 MITRE ATT&CK. (April 23, 2021). MITRE ATT&CK. “gh0st RAT.” Accessed on April 6, 2022, at https://attack.mitre.org/](https://attack.mitre.org/software/S0032/)\n[software/S0032/.](https://attack.mitre.org/software/S0032/)\n\n[14 Trend Micro. (Sept. 21, 2012). Trend Micro Threat Encyclopedia. “GHOSTRAT.” Accessed on April 6, 2022, at https://www.](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ghostrat)\n[trendmicro.com/vinfo/us/threat-encyclopedia/malware/ghostrat.](https://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ghostrat)\n\n﻿15 ThaiHostTalk. (n.d.). ThaiHostTalk. “I am virus! Fuck You slight_smile คัยเคยเจออาการนี้�มั่�งคับ ขอคำ�ปรึกษาหน่อย.” Accessed on\n[April 6, 2022, at https://d.thaihosttalk.com/t/i-am-virus-fuck-you/34081.](https://d.thaihosttalk.com/t/i-am-virus-fuck-you/34081)\n\n16 National Cybersecurity and Communications Integration Center. (March 2017). ICS-CERT. “Destructive Malware.” Accessed\n[on April 6, 2022, at https://www.cisa.gov/uscert/sites/default/files/documents/Destructive_Malware_White_Paper_S508C.pdf.](https://www.cisa.gov/uscert/sites/default/files/documents/Destructive_Malware_White_Paper_S508C.pdf)\n\n[17 Dr.Web. (May 12, 2015). Dr.Web. “Linux.BackDoor.Xnote.1.” Accessed on April 6, 2022, at https://vms.drweb.com/](https://vms.drweb.com/virus/?i=4372602&lng=en)\n[virus/?i=4372602&lng=en.](https://vms.drweb.com/virus/?i=4372602&lng=en)\n\n18 Weibu Intelligence Bureau. (April 16, 2019). Snowflake News. “Analysis Report of XJ Gang of Gaming Black Production |\n[Weibu Online Report.” Accessed on May 6, 2022, at https://www.xuehua.tw/a/5ec83986e3f5c17164172a23.](https://www.xuehua.tw/a/5ec83986e3f5c17164172a23)\n\n[19 Dr.Web. (Feb. 5, 2015). Dr.Web. “New Linux backdoor carries extensive payload.” Accessed on May 6, 2022, at https://news.](https://news.drweb.com/show/?i=9272)\n[drweb.com/show/?i=9272.](https://news.drweb.com/show/?i=9272)\n\n20 Trend Micro Research. (Feb. 18, 2020). Trend Micro Security News. “Operation DRBControl: Uncovering a Cyberespionage\n[Campaign Targeting Gambling Companies in Southeast Asia.” Accessed on April 6, 2022, at https://www.trendmicro.com/](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-companies-in-southeast-asia)\n[vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-companies-in-southeast-asia)\n[companies-in-southeast-asia.](https://www.trendmicro.com/vinfo/us/security/news/cyber-attacks/operation-drbcontrol-uncovering-a-cyberespionage-campaign-targeting-gambling-companies-in-southeast-asia)\n\n\n-----\n\n[21 w88you. (n.d.). w88you. “W88 Malaysia.” Accessed on April 6, 2022, at https://www.w88you.com/.](https://www.w88you.com/)\n\n22 Imgur. (Jan. 4, 2019). Imgur. “Linux / HelloBot (bot / backdoor / new china origin ELF malware).” Accessed on April 6, 2022, at\n\n[https://imgur.com/a/lAQ1tMQ.](https://imgur.com/a/lAQ1tMQ)\n\n[23 114DNS. (n.d.). 114DNS. “114DNS.” Accessed on April 6, 2022, at https://www.114dns.com/.](https://www.114dns.com/)\n\n[24 AITE Institute. (n.d.). AITE Institute. “About us.” Accessed on April 6, 2022, at https://www.aiteinstitute.com/en/about/.](https://www.aiteinstitute.com/en/about/)\n\n[25 IDC China. (n.d.). IDC China. “IDC China.” Accessed on April 6, 2022, at https://www.idc.com/cn_eng.](https://www.idc.com/cn_eng)\n\n[26 BetVision. (n.d.). BetVision. “BetVision.” Accessed on April 19, 2022, at https://www.yabo.uk/.](https://www.yabo.uk/)\n\n27 Virus Bulletin. (Sept. 4, 2013). Virus Bulletin. “Malware spoofing HTTP Host header to hide C&C communication.” Accessed\n[on April 6, 2022, at https://www.virusbulletin.com/blog/2013/09/malware-spoofing-http-host-header-hide-c-amp-c-](https://www.virusbulletin.com/blog/2013/09/malware-spoofing-http-host-header-hide-c-amp-c-communication/)\n[communication/.](https://www.virusbulletin.com/blog/2013/09/malware-spoofing-http-host-header-hide-c-amp-c-communication/)\n\n[28 unixman83. (Jan. 12, 2012). Stack Overflow. “What does a zlib header look like?” Accessed on May 8, 2022, at https://](https://stackoverflow.com/questions/9050260/what-does-a-zlib-header-look-like)\n[stackoverflow.com/questions/9050260/what-does-a-zlib-header-look-like.](https://stackoverflow.com/questions/9050260/what-does-a-zlib-header-look-like)\n\n29 Brian Krebs. (Oct. 24, 2010). Krebs On Security. “SpyEye v. ZeuS Rivalry Ends in Quiet Merger.” Accessed on April 6, 2022, at\n\n[https://krebsonsecurity.com/2010/10/spyeye-v-zeus-rivalry-ends-in-quiet-merger/.](https://krebsonsecurity.com/2010/10/spyeye-v-zeus-rivalry-ends-in-quiet-merger/)\n\n[30 n1nj4sec. (Sep. 2, 2021). GitHub. “pupy.” Accessed on May 6, 2022, at https://github.com/n1nj4sec/pupy.](https://github.com/n1nj4sec/pupy)\n\n[31 Ighor Augusto. (June 28, 2020). GitHub. “Reptile.” Accessed on April 6, 2022, at https://github.com/f0rb1dd3n/Reptile.](https://github.com/f0rb1dd3n/Reptile)\n\n[32 Ighor Augusto. (June 28, 2020). GitHub. “Reptile.” Accessed on April 6, 2022, at https://github.com/f0rb1dd3n/Reptile.](https://github.com/f0rb1dd3n/Reptile)\n\n[33 Ilya V. Matveychikov. (Feb. 5, 2020). GitHub. “kmatryoshka.” Accessed on April 6, 2022, at https://github.com/milabs/](https://github.com/milabs/kmatryoshka)\n[kmatryoshka.](https://github.com/milabs/kmatryoshka)\n\n[34 Helena Zhang. (n.d.). Icon Bolt. “Chat teardrop dots icon.” Accessed on May 6, 2022, at https://www.iconbolt.com/iconsets/](https://www.iconbolt.com/iconsets/phosphor-regular/chat-teardrop-dots)\n[phosphor-regular/chat-teardrop-dots.](https://www.iconbolt.com/iconsets/phosphor-regular/chat-teardrop-dots)\n\n[35 Electron. (n.d.). Electron. “app.” Accessed on May 6, 2022, at https://www.electronjs.org/docs/v14-x-y/api/app#event-ready.](https://www.electronjs.org/docs/v14-x-y/api/app#event-ready)\n\n36 Bitdefender. (Dec. 19, 2019). Bitdefender. “Untrusted Search Path vulnerability in Bitdefender Total Security 2020 (VA-5895).”\n[Accessed on May 8, 2022, at https://www.bitdefender.com/support/security-advisories/untrusted-search-path-vulnerability-](https://www.bitdefender.com/support/security-advisories/untrusted-search-path-vulnerability-bitdefender-total-security-2020-va-5895/)\n[bitdefender-total-security-2020-va-5895/.](https://www.bitdefender.com/support/security-advisories/untrusted-search-path-vulnerability-bitdefender-total-security-2020-va-5895/)\n\n37 QuoIntelligence. (April 20, 2020). QuoIntelligence. “WINNTI GROUP: Insights From the Past.” Accessed on May 6, 2022, at\n\n[https://quointelligence.eu/2020/04/winnti-group-insights-from-the-past/.](https://quointelligence.eu/2020/04/winnti-group-insights-from-the-past/)\n\n38 Marc-Etienne Léveillé and Mathieu Tartare. (Oct. 2019). ESET Research White Papers. “CONNECTING THE DOTS: Exposing\n[the arsenal and methods of the Winnti Group.” Accessed on April 10, 2022, at https://www.welivesecurity.com/wp-content/](https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf)\n[uploads/2019/10/ESET_Winnti.pdf.](https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf)\n\n[39 Dr.Web. (May 12, 2015). Dr.Web. “Linux.BackDoor.Xnote.1. Accessed on April 11, 2022, at https://vms.drweb.com/](https://vms.drweb.com/virus/?i=4372602&lng=en)\n[virus/?i=4372602&lng=en.](https://vms.drweb.com/virus/?i=4372602&lng=en)\n\n40 Ignacio Sanmillan. (Jan. 7, 2019). Intezer. “ChinaZ Revelations: Revealing ChinaZ Relationships with other Chinese Threat\n[Actor Groups.” Accessed on April 11, 2022, at https://www.intezer.com/blog/malware-analysis/chinaz-relations/.](https://www.intezer.com/blog/malware-analysis/chinaz-relations/)\n\n41 Ivona Alexandra Chili. (Feb. 2, 2018). Bitdefender. “Operation PZChao: a possible return of the Iron Tiger APT.” Accessed on\n[April 11, 2022, at https://www.bitdefender.com/blog/labs/operation-pzchao-a-possible-return-of-the-iron-tiger-apt/.](https://www.bitdefender.com/blog/labs/operation-pzchao-a-possible-return-of-the-iron-tiger-apt/)\n\n42 ClearSky Research Team. (July 18, 2017). ClearSky Cyber Security. “Recent Winnti Infrastructure and Samples.” Accessed on\n[April 11, 2022, at https://www.clearskysec.com/winnti/.](https://www.clearskysec.com/winnti/)\n\n43 BlackBerry. (2020). BlackBerry. “Decade of the RATS: Cross-Platform APT Espionage Attacks Targeting Linux, Windows and\n[Android.” Accessed on April 11, 2022, at https://www.blackberry.com/content/dam/blackberry-com/asset/enterprise/pdf/](https://www.blackberry.com/content/dam/blackberry-com/asset/enterprise/pdf/direct/report-bb-decade-of-the-rats.pdf)\n[direct/report-bb-decade-of-the-rats.pdf.](https://www.blackberry.com/content/dam/blackberry-com/asset/enterprise/pdf/direct/report-bb-decade-of-the-rats.pdf)\n\n44 Microsoft Defender Security Research Team. (Jan. 25, 2017). Microsoft Security. “Detecting threat actors in recent German\n[industrial attacks with Windows Defender ATP.” Accessed on April 11, 2022, at https://www.microsoft.com/security/](https://www.microsoft.com/security/blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp/)\n[blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp/.](https://www.microsoft.com/security/blog/2017/01/25/detecting-threat-actors-in-recent-german-industrial-attacks-with-windows-defender-atp/)\n\n45 Daniel Lunghi and Jaromir Horejsi. (April 27, 2022). Trend Micro Research, News, and Perspectives. “New APT Group Earth\n[Berberoka Targets Gambling Websites With Old and New Malware.” Accessed on May 6, 2022, at https://www.trendmicro.](https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html)\n[com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html.](https://www.trendmicro.com/en_us/research/22/d/new-apt-group-earth-berberoka-targets-gambling-websites-with-old.html)\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://documents.trendmicro.com/assets/white_papers/wp-operation-earth-berberoka.pdf"
    ],
    "report_names": [
        "wp-operation-earth-berberoka.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9f778366-a4a7-42f1-ab1e-362aa065ee4f",
            "created_at": "2022-10-25T16:07:23.362157Z",
            "updated_at": "2025-03-27T02:02:09.757401Z",
            "deleted_at": null,
            "main_name": "APT 42",
            "aliases": [
                "GreenBravo"
            ],
            "source_name": "ETDA:APT 42",
            "tools": [
                "BROKEYOLK",
                "CHAIRSMACK",
                "CORRUPT KITTEN",
                "DOSTEALER",
                "GORBLE",
                "Ghambar",
                "MAGICDROP",
                "PINEFLOWER",
                "POWERPOST",
                "SILENTUPLOADER",
                "TABBYCAT",
                "TAMECAT",
                "VBREVSHELL",
                "VINETHORN"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5bbced13-72f7-40dc-8c41-dcce75bf885e",
            "created_at": "2022-10-25T15:50:23.695735Z",
            "updated_at": "2025-03-27T02:00:55.525839Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Winnti Group"
            ],
            "source_name": "MITRE:Winnti Group",
            "tools": [
                "PipeMon",
                "Winnti for Windows",
                "PlugX"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f3b19931-3751-4ece-a235-15b397951dc2",
            "created_at": "2022-10-25T16:07:23.889537Z",
            "updated_at": "2025-03-27T02:02:10.015565Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "ETDA:Nazar",
            "tools": [
                "Distribute.exe",
                "EYService",
                "GpUpdates.exe",
                "Microolap Packet Sniffer",
                "TCPDUMP for Windows"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "945a572f-ebe3-4e2f-a288-512fe751cfa8",
            "created_at": "2022-10-25T16:07:24.413971Z",
            "updated_at": "2025-03-27T02:02:10.212853Z",
            "deleted_at": null,
            "main_name": "Winnti Group",
            "aliases": [
                "Wicked Panda",
                "Winnti Group"
            ],
            "source_name": "ETDA:Winnti Group",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "FunnySwitch",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "452d2d74-e812-45d6-b0fe-b8a6cc4ebd01",
            "created_at": "2022-10-25T16:07:23.562676Z",
            "updated_at": "2025-03-27T02:02:09.865955Z",
            "deleted_at": null,
            "main_name": "Earth Berberoka",
            "aliases": [
                "GamblingPuppet"
            ],
            "source_name": "ETDA:Earth Berberoka",
            "tools": [
                "Agent.dhwf",
                "AngryRebel",
                "AsyncRAT",
                "CinaRAT",
                "Destroy RAT",
                "DestroyRAT",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "Kaba",
                "Korplug",
                "Moudour",
                "Mydoor",
                "PCRat",
                "PlugX",
                "PuppetLoader",
                "Quasar RAT",
                "QuasarRAT",
                "RedDelta",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Trochilus RAT",
                "Xamtrav",
                "Yggdrasil",
                "oRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e254cf33-e7f5-407b-a8a1-1a856a9f1c71",
            "created_at": "2025-01-21T02:00:03.599871Z",
            "updated_at": "2025-03-27T02:00:03.480307Z",
            "deleted_at": null,
            "main_name": "Operation DRBControl",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation DRBControl",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2664d6f5-f918-4978-87f8-f6afad7402c6",
            "created_at": "2023-01-06T13:46:39.393669Z",
            "updated_at": "2025-03-27T02:00:03.073942Z",
            "deleted_at": null,
            "main_name": "Earth Berberoka",
            "aliases": [
                "GamblingPuppet"
            ],
            "source_name": "MISPGALAXY:Earth Berberoka",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6d2910b0-9fea-46a2-84e6-a043b1e023e4",
            "created_at": "2022-10-25T16:07:23.946958Z",
            "updated_at": "2025-03-27T02:02:10.044112Z",
            "deleted_at": null,
            "main_name": "Operation DRBControl",
            "aliases": [],
            "source_name": "ETDA:Operation DRBControl",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041835,
    "ts_creation_date": 1653302013,
    "ts_modification_date": 1653302016,
    "files": {
        "pdf": "https://archive.orkl.eu/18c269d1eaa29438861255b754cdf766df09110a.pdf",
        "text": "https://archive.orkl.eu/18c269d1eaa29438861255b754cdf766df09110a.txt",
        "img": "https://archive.orkl.eu/18c269d1eaa29438861255b754cdf766df09110a.jpg"
    }
}