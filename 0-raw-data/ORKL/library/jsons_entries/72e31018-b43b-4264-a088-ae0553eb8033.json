{
    "id": "72e31018-b43b-4264-a088-ae0553eb8033",
    "created_at": "2023-01-12T14:59:00.652632Z",
    "updated_at": "2025-03-27T02:05:28.471753Z",
    "deleted_at": null,
    "sha1_hash": "957ef6699a199804d81da92aba7a57117b4e0233",
    "title": "2021-08-31 - BlackMatter - The New Star Of Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T05:01:14Z",
    "file_modification_date": "2022-05-28T05:01:14Z",
    "file_size": 349532,
    "plain_text": "# BlackMatter - The New Star Of Ransomware\n\n**blog.minerva-labs.com/blackmatter**\n\n[Tweet](https://twitter.com/share)\n\n\n-----\n\nAfter the demise of the [DarkSide ransomware affiliate program, a vacuum was left in the](https://blog.minerva-labs.com/dont-be-next-prevent-darksides-mutating-mutex-with-minerva?hsLang=en-us)\nmarket. This space was promptly filled by new groups such as Lockbit and BlackMatter.\nBlackMatter, the up-and-coming star of the ransomware scene, is thought to be DarkSide’s\ndirect heir, from which it got [some of its code. While no high-profile breach of BlackMatter](https://www.tesorion.nl/en/posts/analysis-of-the-blackmatter-ransomware/)\n[have been published yet, BleepingComputer claims the group already netted a 4 million](https://www.bleepingcomputer.com/news/security/blackmatter-ransomware-gang-rises-from-the-ashes-of-darkside-revil/)\nransom payment.\n\nMinerva’s research team obtained a recent BlackMatter sample, and in this blog, we will give\nsome crucial details of the ransomware’s inner workings and evasion techniques.\n\n**Evasion Techniques:**\n\nLike most modern malware, BlackMatter employs string encryption and dynamic API function\nresolving, that is done to hinder static analysis. The ransomware’s API resolving routine is\nquite unique, as it will save resolved function pointers in an encoded form and decode them\nonly when used.\n\nA de-compilation of the API resolving function:\n\nTo further complicate the analysis, if a heap allocation ends with the integer 0xABABABAB\nthe malware will not save the stub’s address in the reconstructed import address table. This\nwill effectively crash the ransomware if it is running under a debugger. More information on\n[why this technique works can be found here under “Heap Protection”.](https://anti-debug.checkpoint.com/techniques/debug-flags.html)\n\nAnother anti-debugging technique used by BlackMatter is hiding threads using the\nNtSetInformationThread function with the parameter ThreadHideFromDebugger (0x11). This\nwill cause a thread to “run away” from a debugger resulting in an encrypted machine It is\n\n\n-----\n\nworth mentioning that this exact technique is used by Lockbit 2.0, further strengthening the\nevidence that the two are linked.\n\nThread hiding code from BlackMatter:\n\nUnlike other ransomware, BlackMatter will encrypt Russian devices. The sample we\nanalyzed did not bother to check the computer’s locale before encrypting it. The malware\ndoes not care where it executes and will even encrypt a commercial sandbox.\n\nRansomware is seldom the initial payload of an attack, which must be resistant to security\nproducts, hence environmental awareness must be part of its repertoire. To evade security\ntools it will usually employ evasion techniques such as memory injection and ‘living off the\n[land’. Minerva Labs prevents the initial payload from executing, thereby stopping threats like](http://www.minerva-labs.com/ransomware-protection-2021)\nBlackMatter from gaining a foothold on the network in the first place.\n\n**IOCs:**\n\n78826cac6f30f62cb6499cebc97d6a9bed22b0a2adef6e0cad14742a4b593e68\n\n**References:**\n\nhttps://news.sophos.com/en-us/2021/08/09/blackmatter-ransomware-emerges-fromthe-shadow-of-darkside/\n[https://www.tesorion.nl/en/posts/analysis-of-the-blackmatter-ransomware/.](https://www.tesorion.nl/en/posts/analysis-of-the-blackmatter-ransomware/)\nhttps://www.bleepingcomputer.com/news/security/blackmatter-ransomware-gang-risesfrom-the-ashes-of-darkside-revil/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-31 - BlackMatter - The New Star Of Ransomware.pdf"
    ],
    "report_names": [
        "2021-08-31 - BlackMatter - The New Star Of Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535540,
    "ts_updated_at": 1743041128,
    "ts_creation_date": 1653714074,
    "ts_modification_date": 1653714074,
    "files": {
        "pdf": "https://archive.orkl.eu/957ef6699a199804d81da92aba7a57117b4e0233.pdf",
        "text": "https://archive.orkl.eu/957ef6699a199804d81da92aba7a57117b4e0233.txt",
        "img": "https://archive.orkl.eu/957ef6699a199804d81da92aba7a57117b4e0233.jpg"
    }
}