{
    "id": "e40ef768-7de1-40a1-ae86-3e77f6c24d76",
    "created_at": "2023-11-01T02:05:36.832982Z",
    "updated_at": "2025-03-27T02:15:18.791656Z",
    "deleted_at": null,
    "sha1_hash": "beec09c9b7d2993e12a1354c80866e1ddf0673b7",
    "title": "Operation Saffron Rose",
    "authors": "",
    "file_creation_date": "2014-08-13T13:42:35Z",
    "file_modification_date": "2021-09-13T21:23:36Z",
    "file_size": 4355503,
    "plain_text": "## OPERATION\n SAFFRON ROSE\n\n### 2013\n\n##### Authors: Nart Villeneuve, Ned Moran, Thoufique Haq and Mike Scott\n\n# SECURITY\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n## CONTENTS\n\n###### Introduction................................................................................................................................................................................................................................................................................................................................................2\n\n Background...................................................................................................................................................................................................................................................................................................................................2\n\n Attack Vectors......................................................................................................................................................................................................................................................................................................................................4\n\n The “Stealer” Malware....................................................................................................................................................................................................................................................................................................6\n\n The “Stealer” Builder and Tools.........................................................................................................................................................................................................................................................11\n\n Command-and-Control Infrastructure..................................................................................................................................................................................................................13\n\n Victimology...........................................................................................................................................................................................................................................................................................................................................15\n\n Attribution..............................................................................................................................................................................................................................................................................................................................................16\n\n Conclusion................................................................................................................................................................................................................................................................................................................................................19\n\n About FireEye, Inc..........................................................................................................................................................................................................................................................................................19\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n#### We believe we’re seeing an evolution and development in Iranian-based cyber activity. In years past, Iranian actors primarily committed politically-motivated website defacement and DDoS attacks.[1] More recently, however, suspected Iranian actors have destroyed data on thousands of computers with the Shamoon virus,[2] and they have penetrated the Navy Marine Corps Intranet (NMCI), which is used by the U.S. Navy worldwide.[3 ]\n\n\nIn this report, we document the activities of the\nAjax Security Team, a hacking group believed to be\noperating from Iran. Members of this group have\naccounts on popular Iranian hacker forums such as\nashiyane[.]org and shabgard[.]org, and they have\nengaged in website defacements under the group\nname “AjaxTM” since 2010. By 2014, the Ajax\nSecurity Team had transitioned from performing\ndefacements (their last defacement was in\nDecember 2013) to malware-based espionage,\nusing a methodology consistent with other\nadvanced persistent threat actors in this region.\n\nIt is unclear if the Ajax Security Team operates in\nisolation or if they are a part of a larger\ncoordinated effort. The Ajax Security Team itself\nuses malware tools that do not appear to be\npublicly available. We have seen this group\nleverage varied social engineering tactics as a\nmeans to lure their targets into infecting\nthemselves with malware. Although we have not\nobserved the use of exploits as a means to infect\nvictims, members of the Ajax Security Team have\npreviously used publicly available exploit code in\nweb site defacement operations.\n\nIn sum, FireEye has recently observed the Ajax\nSecurity Team conducting multiple cyber\nespionage operations against companies in the\ndefense industrial base (DIB) within the Unites\nStates, as well as targeting local Iranian users of\nanti-censorship technologies that bypass Iran’s\nInternet filtering system.\n\n1 HP Security Research. “Threat Intelligence Briefing Episode 11”. February 2014.\n\n\n###### Background\nThe transition from patriotic hacking to cyber\nespionage is not an uncommon phenomenon. It\ntypically follows an increasing politicization within\nthe hacking community, particularly around\ngeopolitical events. This is followed by increasing\nlinks between the hacking community and the\nstate, particularly military and/or intelligence\norganizations.\n\nIn the late 1990’s and early 2000’s, a similar\ntransition occurred within the Chinese hacking\ncommunity. During that time period, the Chinese\nhacking community engaged in website\ndefacements and denial of service attacks in\nconjunction with incidents such as the accidental\nbombing of the Chinese embassy in Belgrade in\n1999, the collision of a U.S. spy plane and a\nChinese military plane in 2001, and the Japanese\nPrime Minister’s controversial visit to the\nYasukuni shrine in 2005[.4] Around this time a\nsignificant shift in philosophy began to take place.\n\nMembers of the Chinese hacking community that\nparticipated in such attacks soon found that\ntransitioning to cyber espionage was more\nrewarding—both in terms of developing a more\nadvanced skill set as well as in monetary\nremuneration. One group known as NCPH\n(Network Crack Program Hacker), whose\nfounding member “Wicked/Withered Rose” was a\npatriotic hacker, made the transition to cyber\nespionage by founding a “hacker-for-hire” group\n\n\n2 Perlroth, N. “In Cyberattack on Saudi Firm, U.S. Sees Iran Firing Back”. October 2012.\n\n3 Gallagher, S. “Iranians hacked Navy network for four months? Not a surprise”. February 2014.\n\n4 Key. “Honker Union of China to launch network attacks against Japan is a rumor”. September 2010.\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\nthat simultaneously developed an association with\nthe Chinese military.[5] The group began developing\nzero-day exploits, rootkits and remote access\ntools (RATs)—using them in attacks against a\nvariety of targets including the U.S. Department of\nDefense.[6] (One of this group’s associates, “whg”, is\nstill active and is believed to have developed one\nvariant of the PlugX/SOGU malware.[7]) The\nrationale behind this transition within the Chinese\nhacking community is nicely summed up in a\nmessage by the “Honker Union of China” to its\nmembers in 2010:\n\nWhat benefit can hacking a Web page bring our\ncountry and the people? It is only a form of\nemotional catharsis, please do not launch any\npointless attacks, the real attack is to fatally\ndamage their network or gain access to their\nsensitive information.[8]\n\nIn Iran, the hacking community appears to be\nundergoing a similar transformation. While a\nvariety of Iranian hacker groups had engaged in\npolitically motivated website defacements, the\nemergence of the “Iranian Cyber Army” in 2009\ndemonstrated “a concentrated effort to promote\nthe Iranian government’s political narrative\nonline”.[9] They targeted, among others, news\norganizations, opposition websites and social\nmedia.[10] This marked the beginning of a largescale cyber offensive against the perceived\nenemies of the Iranian government.\n\n\nForeign news and opposition websites are\nroutinely blocked in Iran, as are the tools that\nallow users in Iran to bypass these restrictions.[11]\nOne of the key stakeholders in Iran’s Internet\ncensorship program is the Iranian Revolutionary\nGuard Corps (IRGC), under which the Basij\nparamilitary organization operates.\n\nThe Basij formed the Basij Cyber Council and\nactively recruits hackers in order to develop both\ndefensive and offensive cyber capabilities.[12] There\nis increasing evidence to suggest that the hacker\ncommunity in Iran is engaged in a transition from\npolitically motivated defacements and denial of\nservice attacks to cyber espionage activities. This\nmodel is consistent with the Basij’s recruitment of\nparamilitary volunteer hackers to “engage in less\ncomplex hacking or infiltration operations” leaving\nthe more technical operations to entities over\nwhich they have increasingly direct control.[13]\n\nAs such, the capabilities of threat actors operating\nfrom Iran have traditionally been considered\nlimited.[14] However, the “Shamoon” attacks, which\nwiped computers in Saudi Arabia and Qatar,\nindicate an improvement in capabilities.[15] And\nunsurprisingly, Iran has reportedly increased its\nefforts to improve offensive capabilities after\nbeing targeted by Stuxnet and Flame.[16]\n\n\n5 Elegant, S. “Enemies at The Firewall”. December 2007. Dunham, K. & Melnick, J. “’Wicked Rose’ and the NCPH Hacking Group”.\n\nWikipedia. “Network Crack Program Hacker Group”.\n\n6 Dunham, K. & Melnick, J. “’Wicked Rose’ and the NCPH Hacking Group”.\n\n7 Blasco, J. “The connection between the Plugx Chinese gang and the latest Internet Explorer Zeroday”. September 2012.\n\n8 Key. “Honker Union of China to launch network attacks against Japan is a rumor”. September 2010.\n\n9 OpenNet Initiative. “After the Green Movement: Internet Controls in Iran 2009 – 2012”. February 2013.\n\n10 Rezvaniyeh, F. “Pulling the Strings of the Net: Iran’s Cyber Army”. February 2010. “Twitter hackers appear to be Shiite group”. December 2009.\n\n11 OpenNet Initiative. “Iran”. June 2009.\n\n12 The IRGC has also indicated that they would welcome hackers that support the Iranian government. Esfandiari, G.\n\n“Iran Says It Welcomes Hackers Who Work For Islamic Republic”. March 2011, HP Security Research.\n\n“Threat Intelligence Briefing Episode 11”. February 2014.\n\n13 BBC Persian. “Structure of Iran’s Cyber Warfare”.\n\n14 Mandiant. “M-Trends: Beyond the Breach, 2014”, page 9. April 2014.\n\n15 Mount, M. “U.S. Officials believe Iran behind recent cyber attacks”. October 2012.\n\n16 Shalal-Esa, A. “Iran strengthened cyber capabilities after Stuxnet: U.S. general”. January 2013, Lim, K. “Iran’s cyber posture”. November 2013.\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n###### Attack Vectors\n\nWe have observed the Ajax Security Team use a\nvariety of vectors to lure targets into installing\nmalicious software and/or revealing login\ncredentials. These attack vectors include sending\nemail, private messages via social media, fake login\npages, and the propagation of anti-censorship\nsoftware that has been infected with malware.\n\n**Spear phishing**\nDuring our investigation, we discovered that these\nattackers sent targeted emails, as well as private\nmessages through social media. For example, the\nattackers targeted companies in the DIB using a\nfake conference page as a lure to trick targets into\ninstalling malicious software. The attackers\n\n\nregistered the domain “aeroconf2014[.]org” in\norder to impersonate the IEEE Aerospace\nconference—the conference’s actual domain is\naeroconf.org—and sent out an email with the\nfollowing information:\n\nFrom: invite@aeroconf2014[.]org\nSubject: IEEE Aerospace Conference 2014\n\nThe email encouraged users to visit a fake\nconference website owned by the attackers:\n\nUpon visiting the website, visitors were notified\nthat they must install “proxy” software in order to\naccess it, which is actually malware.\n\n\n**Figure 1: The Fake**\nIEEE Aerospace\nConference Website\n\n\n7 Bloomberg. “Neiman Marcus Hackers Set Off 60,000 Alerts While Bagging Credit Card Data.” February 2014.\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n**Credential Phishing**\nThe attackers have also used phishing attacks, in\nwhich they set up Web pages to emulate various\nservices that require security credentials. The\nattackers tailored these login pages for specific\ntargets in the DIB and spoofed a variety of services\nsuch as Outlook Web Access and VPN login pages.\n\nIf users attempt to login through these fake Web\npages, the attackers collect their login credentials.\n\n**Anti-censorship Tools**\nAll Internet Service Providers (ISPs) in Iran are\nrequired to implement filtering technology that\ncensors access to content which the Iranian\ngovernment deems unacceptable.[17] This content\nincludes categories such as pornography and\n\n\npolitical opposition.[18] In response to these\nrestrictions, Iranians have been increasingly using\nsoftware that bypasses such filtering technology.\n\nTo counter anti-censorship efforts, Iran has\nattempted to block the use of certain software\ntools.[19] In 2012, researchers found that an\nanti-censorship tool that is primarily used by\nInternet users in Iran was bundled with malware\nand redistributed.[20]\n\nOur investigation found that malware-laden\nversions of legitimate anti-censorship software,\nsuch as Psiphon and Ultrasurf, were distributed to\nusers Iran and Persian speaking people around the\nworld.\n\n\n**Figure 2: The Fake Outlook**\nWeb Access page\n\n\n17  OpenNet Initiative. “Iran”. June 2009.\n\n18  OpenNet Initiative. “After the Green Movement: Internet Controls in Iran 2009 – 2012”. February 2013.\n\n19  Torbati, Y. “Iran blocks use of tool to get around Internet filter”. March 2013.\n\n20  Marquis-Boire, M. “Iranian anti-censorship software ‘Simurgh’ circulated with malicious backdoor”. May 2012.\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n###### The “Stealer” Malware\n\n**Host-based Indicators and Malware**\n**Functionality**\nWe have observed the Ajax Security Team use a\nmalware family that they identify simply as ‘Stealer’.\nThey deliver this malware as a malicious executable\n(dropper). The executable is a CAB extractor that\ndrops the implant IntelRS.exe. This implant, in turn,\ndrops various other components into C:\\\nDocuments and Settings\\{USER}\\Application\nData\\IntelRapidStart\\. The following files are\nwritten to disk in this location:\n\n\nThe IntelRS.exe is written in .NET and is aptly\nnamed “Stealer”, as it has various data collection\nmodules. It drops and launches AppTransferWiz.dll\nvia the following command:\n\n“C:\\WINDOWS\\system32\\rundll32.exe” “C:\\\nDocuments and Settings\\{USER}\\Application\n\nData\\IntelRapidStart\\AppTransferWiz.dll”,#110\n\n110 is an ordinal that corresponds to “StartBypass”\nexport in AppTransferWiz.dll.\n\n|File|Functionality|\n|---|---|\n|IntelRS.exe|Various stealer components and encryption implementation|\n|DelphiNative.dll|Browser URL extraction, IE Accounts, RDP accounts (Imported by IntelRS.exe)|\n|IntelRS.exe.config|Config containing supported .NET versions for IntelRS.exe|\n|AppTransferWiz.dll|FTP exfiltration (Launched by IntelRS.exe)|\n|RapidStartTech.stl|Base64 encoded config block containing FTP credentials, implant name, decoy name, screenshot interval and booleans for startup, keylogger and screenshot|\n\n\n**Figure 3: StartBypass**\nOrdinal\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\nData exfiltration is conducted over FTP by\nAppTransferWiz.dll, which acts as an FTP client.\nThis DLL is written in Delphi. There is code to\nexfiltrate data over HTTP POST as well, but it is\nunused. We also found incomplete code that would\nperform SFTP and SMTP exfiltration, which could\nbe completed in a future version.\n\nState is maintained between the stealer\ncomponent IntelRS.exe and the FTP component\nAppTransferWiz.DLL using a file from the FTP\nserver “sqlite3.dll”, as well as a global atom\n“SQLiteFinish”. IntelRS.exe waits in an indefinite\nloop, until AppTransferWiz.DLL defines this state.\n\nOnce the state is set, IntelRS.exe proceeds to\ncollect data from various areas in the system as\ndescribed below:\n\n               - Collects system information: hostname,\nusername, timezone, IP addresses, open ports,\ninstalled applications, running processes, etc.\n\n               - Performs key logging\n\n\n\n- Takes various screenshots\n\n- Harvests instant messaging (IM) account\ninformation: GTalk, Pidgin, Yahoo, Skype\n\n- Tracks credentials, bookmarks and history\nfrom major browsers: Chrome, Firefox, Opera\n\n- Collects email account information\n\n- Extracts installed proxy software\nconfiguration information\n\n- Harvests data from installed cookies\n\nIntelRS.exe loads a Delphi component called\nDelphiNative.DLL, which implements some\nadditional data theft functionality for the following:\n\n- Internet Explorer (IE) accounts\n\n- Remote Desktop Protocol (RDP) accounts\n\n- Browser URLs\n\n\n**Figure 4: AppTransferWizard.**\ndll creates sqlite3.dll and\nglobal atom\n\n**Figure 5: IntelRS.exe sleeps**\nuntil global atom is set and\nsqlite3.dll is present\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\nThe Stealer component uses common techniques\nto acquire credential data. For instance, it loads\nvaultcli.DLL and uses various APIs shown below to\nacquire RDP accounts from the Windows vault.\n\nHarvested data is encrypted and written to disk on\nthe local host. The filenames for these encrypted\nfiles follow this naming scheme:\n\n{stolen data type}_{victim system name}_\nYYYYMMDD_HHMM.Enc\n\nThe {stolen data type} parameter indicates where\nthe data was harvested from (e.g., a Web browser,\nan instant messenger application, installed proxy\nsoftware).\n\n\nAnalysis of the malware indicates that the data is\nencrypted via a Rijndael cipher implementation;\nmore specifically it uses AES which is a specific set\nof configurations of Rijndael. It uses a key size of\n256 bytes and block size of 128 bytes, which\nconforms to the FIPS-197 specification of\nAES-256.[21] It utilizes the passphrase ‘HavijeBaba’\nand a salt of ‘salam!*%#’ as an input to PBKDF2\n(Password-Based Key Derivation Function 2) to\nderive the key and initialization vector for the\nencryption.[22] This key derivation implementation in\n.NET is done using the Rfc2898DeriveBytes\nclass.[23] The passphrase and salt are Persian\nlanguage words. “Havij” means “carrot”, “Baba”\nmeans “father”, and “Salam” is a common greeting\nthat means “Peace”.\n\n\n**Figure 6: Acquiring RDP**\nAccounts\n\n\n21  ShawnFa. “The Differences Between Rijndael and AES”. October 2006.\n\n22  Wikipedia. “PBKDF2”.\n\n23  Microsoft. “Rfc2898DeriveBytes Class”.\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n**Sample Timeline**\nWe identified 17 droppers during this research,\nincluding:\n\n               - 9 samples compiled on 2013-02-17 07:00\n\n               - 4 samples compiled on 2009-07-13 23:42\n\n               - 3 sample compiled on 2013-10-14 06:48\n\n               - 1 sample compiled on 2013-10-13 09:56\n\nThe 2009 compile time appears to have been\nforged, while the 2013 compile times may be\nlegitimate.\n\nIn some cases, we found an implant but not the\nparent dropper. In total, 22 of the 23 implants that\nwe identified during our research had unique\ncompile times ranging from 2013-10-29 until\n2014-03-15. We identified two implants that were\nboth compiled on 2014-3-15 at 23:16. These\ncompile times appear to be legitimate and coincide\nwith attempted intrusion activity attributed to\nthese attackers.\n\n\n**Spoofed Installers**\nMany of the malicious executables (droppers) that\nwe collected were bundled with legitimate\ninstallers for VPN or proxy software. Examples\ninclude:\n\n- 6dc7cc33a3cdcfee6c4edb6c085b869d was\nbundled with an installer for Ultrasurf Proxy\nsoftware.\n\n- 3d26442f06b34df3d5921f89bf680ee9 was\nbundled with an installer for Gerdoovpn\nvirtual private network software.\n\n- 3efd971db6fbae08e96535478888cff9 was\nbundled with an installer for the Psiphon\nproxy.\n\n- 288c91d6c0197e99b92c06496921bf2f was\nbundled with an installer for Proxifier\nsoftware.\n\nThese droppers were also designed to visually\nspoof the appearance of the above applications.\nThese droppers contained icons used in the\nlegitimate installers for these programs.\n\n\n**Figure 7: Icon for the Psiphon**\nAnti-censorship Tool\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n**Process Debug (PDB) Strings**\nAnalysis of the PDB strings seen in the implants\nindicates that there may be more than one\ndeveloper working on the source code for the\nStealer builder. The following two PDB paths were\nseen in the collection of implants that we\ncollected:\n\n               - d:\\svn\\Stealer\\source\\Stealer\\Stealer\\obj\\\nx86\\Release\\Stealer.pdb\n\n               - f:\\Projects\\C#\\Stealer\\source\\Stealer\\\nStealer\\obj\\x86\\Release\\Stealer.pdb\n\nThese strings indicate that the Stealer source\ncode was stored in two different paths but not\nnecessarily on two different computers. The f:\\\nProjects\\ path may be from an external storage\ndevice such as a thumb drive. It is therefore\npossible that only one person has access to the\nsource code, but keeps a separate repository on\nan external storage device. Alternatively, the\ndifferent file paths could be the result of two\ndifferent actors storing their source code in two\ndifferent locations.\n\n**Builder Artifacts**\nIn nine of the implants that we collected, we found\na consistent portable executable (PE) resource\nwith a SHA256 of\n5156aca994ecfcb40458ead8c830cd66469d5f5\na031392898d323a8d7a7f23d3. This PE\nresource contains the VS_VERSION_INFO. In\nlayman’s terms, this can best be described as the\nmetadata describing the executable file. This\nspecific PE resource contained the\nfollowing information:\n\nNote the InternalName of ‘Stealer.exe’. This is the\nattackers’ name for this malware family.\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n###### The “Stealer” Builder and Tools\nDuring our research, we recovered two different\ntools used by the members of the Ajax Security\nTeam in conjunction with targeted intrusion\nactivities. The first tool, labeled the ‘Stealer Builder’\nwas compiled on 2014-04-08. This compile date\nmay indicate that the group is still active.\n\nUpon executing the ‘Stealer Builder’ the user is\npresented with an option to load the ‘Builder’ or to\n‘Decrypt’ logs generated from a victim and\nexfiltrated to a command-and-control (CnC) server\nunder the groups’ control.\n\n\nThe Builder option enables an attacker to\nconfigure a new Stealer backdoor. The user can\nconfigure the new backdoor to connect to a\nspecific CnC server with a personalized username\nand password. The attacker can bind the backdoor\nto a legitimate application of his or her choosing, or\nthey can cloak it with an icon designed to make the\nbackdoor appear as though it is a legitimate file.\nWe also noted that the Builder did not allow the\nattacker to select a new passphrase or salt used to\nencrypt the stolen data. The passphrase\n‘HavijeBaba’ and a salt of ‘salam!*%#’ are both\nhardcoded into the builder.\n\n\n**Figure 8: The Stealer Tool**\n\n**Figure 9: The Stealer Builder**\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\nDuring testing, we observed that backdoors\ngenerated by this Stealer Builder had a timestamp\nof 2013-12-19. We had one backdoor in our\nrepository with this same timestamp. This sample\n\n(MD5 1823b77b9ee6296a8b997ffb64d32d21)\nwas configured to exfiltrate data to ultrasms[.]ir.\nThe VS_VERSION_INFO PE resource mentioned\nabove (SHA256\n5156aca994ecfcb40458ead8c830cd66469d5f5\na031392898d323a8d7a7f23d3) is an artifact of\nthe Stealer builder that we recovered. The builder\ngenerates an executable named IntelRapidStart.\nexe. This executable contains the aforementioned\nVS_VERSION_INFO PE resource.\n\nWe also recovered a tool designed to encode\nplaintext into Base64 encoded text or decode\n\n\nBase64 encoded text into plaintext. Members of\nthe Ajax Security Team likely this use tool to\nencode the configuration data seen in\nRapidStartTech.stl files. As noted above, the\nRapidStartTech.stl contains the backdoor’s FTP\ncredentials, implant name, decoy name, and\nscreenshot interval, along with boolean settings for\nstartup, keylogger, and screenshot plugins.\n\nEncoding and decoding Base64 data is a\nstraightforward task and the standard Linux\noperating system offers a number of command line\ntools to achieve this task. The presence of a\nWindows-based GUI tool that simplifies encoding\nand decoding Base64 data indicates that these\ntools may have been developed for less adept\nusers.\n\n\n**Figure 10: Base64 Encoder**\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n###### Command-and-Control Infrastructure\nThe CnC infrastructure consists of distinct, but\nlinked, clusters that have targeted both the users\nof anti-censorship tools in Iran as well as defense\ncontractor companies in the U.S.\n\nThe first cluster contains the domain used in the\nAerospace Conference attack as well as the\ndomains used in phishing attacks designed to\ncapture user credentials:\n\n\nThe website used in the Aerospace Conference\nattack was aeroconf2014[.]org, which is registered\nto info@usa.gov[.]us. However, historical WHOIS\ninformation shows that the domain was registered\nby keyvan.ajaxtm@gmail[.]com—the same domain\nused to register ajaxtm[.]org, the website of the\nAjax Security Team. The same email addresses\nwere used to register variations of domain names\nassociated with popular services provided by\ncompanies such as Google, Facebook, Yahoo and\nLinkedIn.\n\n\n**Figure 11: Ajax Security**\nTeam’s Phishing\nInfrastructure\n\n\nAjax Security\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\nThe second cluster comprises the CnC\ninfrastructure used in the anti-censorship attacks.\nThe majority of the samples we analyzed connect\nto intel-update[.]com and update-mirror[.]com,\nwhich were registered by james.mateo@aim[.]com.\nThe domain intel-update[.]com resolved to the IP\naddress 88.150.227.197, which also hosted\n\n\ndomains registered by osshom@yahoo[.]com, many\nof which are consistent with the pattern of\nregistering domains with associations to Google\nand Yahoo services. We also observed crossover\nwith a sample that connected to both intelupdate[.]com and ultrasms[.]ir, which was\nregistered by lvlr98@gmail[.]com.\n\n\n**Figure 12: Ajax Security**\nTeam’s Stealer CnC\nInfrastructure\n\n**Figure 13: Overlap between the**\nphishing and stealer clusters\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\nThese two clusters are linked by a common IP\naddress (5.9.244.151), which is used by both ns2.\naeroconf2014[.]org and office.windowsessentials[.]tk.\n\nA third cluster of activity was found via analysis of\n1d4d9f6e6fa1a07cb0a66a9ee06d624a. This\nsample is a Stealer variant that connects to the\naforementioned intel-update[.]com as well as\nplugin-adobe[.]com. The domain plugin-adobe[.]\ncom resolved to 81.17.28.235. Other domains\nseen resolving to IP address nearby include the\nfollowing:\n\nAside from the sample connecting to pluginadobe[.]com, we have not discovered any malware\nconnecting to these domains.\n\n###### Victimology\nDuring our investigation, we were able to recover\ninformation on 77 victims from one CnC server\nthat we discovered while analyzing malware\nsamples that were disguised as anti-censorship\ntools. While analyzing the data from the victims, we\n\n\nfound that the majority had either their timezone\nset to “Iran Standard Time” or had their language\nsetting set to Persian:\n\n- 44 had their timezone set to “Iran Standard\nTime” (37 of those also have their language set\nto Persian)\n\n- Of the remaining 33, 10 have Persian\nlanguage settings\n\n- 12 have either Proxifier or Psiphon installed\nor running (all 12 had a Persian language\nsetting and all but one had their timezone set\nto “Iran Standard Time”)\n\nThe largest concentration of victims is in Iran,\nbased on the premise that Persian language\nsettings and “Iran Standard Time” correlate the\nvictim to be geographically located in Iran. As such,\nwe believe that attackers disguised malware as\nanti-censorship tools in order to target the users of\nsuch tools inside Iran as well as Iranian dissidents\noutside the country.\n\n|Domain|IP|First Seen|Last Seen|\n|---|---|---|---|\n|yahoomail.com.co|81.17.28.227|2013-11-28|2014-4-10|\n|privacy-google.com|81.17.28.229|2014-02-14|2014-02-23|\n|xn--google-yri.com|81.17.28.229|2013-12-08|2014-01-15|\n|appleid.com.co|81.17.28.231|2014-02-20|2014-02-20|\n|accounts-apple.com|81.17.28.231|2013-12-31|2014-02-20|\n|users-facebook.com|81.17.28.231|2014-01-15|2014-01-15|\n|xn--facebook-06k.com|81.17.28.231|2013-11-27|2014-03-07|\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n###### Attribution\nThe Ajax Security Team appears to have been\nformed by personas named “HUrr!c4nE!” and\n“Cair3x” in 2010.[24] Both members were engaged in\nwebsite defacements prior to the forming of the\nAjax Security Team, and both were members of\nIranian hacker forums such as ashiyane[.]org and\nshabgard[.]org. Other members include “0day”,\n“Mohammad PK” and “Crim3r”. The Ajax Security\nTeam website at ajaxtm[.]org had a Web forum\nwith at least 236 members. The group published\n\n\nseveral exploits for content management systems\nand engaged in defacements.[25] Initially, the\ndefacements seemed to be motivated by a desire\nto demonstrate the group’s prowess—they even\ndefaced an Iranian government website.[26]\n\nHowever, the group appears to have become\nincreasingly political. For example, in a blog post in\n2012, “Cair3x” announced the targeting of Iran’s\npolitical opponents.\n\n\n24 By March 2010 HUrr!c4nE! was identifying as a member of Ajax Security Team in exploit releases http://www.exploit-db.com/exploits/17011/ and the\n\nfirst defacement archived by Zone-H, which lists both HUrr!c4nE! and Cair3x as members was December 2010 http://www.zone-h.org/mirror/\n\nid/12730879\n\n25 http://osvdb.org/affiliations/1768-ajax-security-team http://www.exploit-db.com/author/?a=3223 http://packetstormsecurity.com/files/author/9928/\n\n26 http://www.zone-h.org/mirror/id/13225183\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\nIn 2013, the Ajax Security Team, and “HUrr!c4nE!”\nin particular, took part in “#OpIsrael” and\n“#OpUSA”.27\n\nBy early 2014, the Ajax Security Team appears to\nhave dwindled. There have been no defacements\nsince December 2013. The website and forum at\najaxtm[.]org operated by “HUrr!c4nE!”, aka\n“k3yv4n”, is no longer active.\n\n\n“HUrr!c4nE!” has the most open/documented\nInternet persona of the Ajax Security Team. He\nregistered the ajaxtm[.]org domain name using the\nemail address keyvan.ajaxtm@gmail[.]com. This\nwas also the email address used to register the\ndomain aerospace2014[.]org, which was used in\nspear phishing attacks against companies in the\nU.S. and is linked with malware activity directed at\nusers of anti-censorship tools in Iran.\n\n\n**Figure 15: Screenshot of the**\ndefacement content used in\n#OpUSA\n\n\n27 Ashraf, N. “#OpIsrael: Hacktivists Starting Cyber Attack against Israel on 7th of April”. March 2013. “OpUSA Targeting Government & Financial Sectors on\n\n07 May 2013: Likely Tools, Targets and Mitigating Measures”. May 2013.\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n“HUrr!c4nE!” features prominently in all the\ngroup’s activities and defacements. Although there\nhas been a decline in public-facing Ajax Security\nTeam activity, this coincides with an increase in\nmalware activity linked to the group’s\ninfrastructure.\n\n             - ~2009—Membership in ashiyane.org and\nshabgard.org forums\n\n             - 2010 – 2012—Defacements, Release of exploits\nfor CMS\n\n              - 2012 – 2013—Increasing politicization,\nparticipation on #OpIsrael, #OpUSA\n\n             - 2013 – 2014—Transition to cyber-espionage\n\nThe increasing politicization of the Ajax Security\nTeam aligns with the timing of their activities\nagainst the perceived enemies of Iran. In addition\nto attacking companies in the U.S., they have\ntargeted domestic users of anti-censorship\ntechnology.\n\nWhile the objectives of this group are consistent\nwith Iran’s efforts at controlling political dissent\nand expanding offensive cyber capabilities, the\nrelationship between this group and the Iranian\ngovernment remains inconclusive.\n\n\nFor example, the Ajax Security Team could just be\nusing anti-censorship tools as a lure because they\nare popular in Iran, in order to engage in activities\nthat would be considered traditional cybercrime. In\none case, “HUrr!c4nE!”, using the email address\nkeyvan.ajaxtm@gmail[.]com, has been flagged for\npossible fraud by an online retailer. While\n“HUrr!c4nE!” is engaged in operations that align\nwith Iran’s political objectives, he may also be\ndabbling in traditional cybercrime.\n\nThis indicates that there is a considerable grey area\nbetween the cyber espionage capabilities of Iran’s\nhacker groups and any direct Iranian government\nor military involvement.\n\nOn the spectrum of state responsibility, these\nattacks align with state-encouraged attacks, which\nare defined as attacks in which:\n\nThird parties control and conduct the attack, but\nthe national government encourages them as a\nmatter of policy.[28]\n\nRecruiting hackers through this model allows Iran\nto influence their activities, and provides the\nIranian government plausible deniability, but a lack\nof direct control also means that the groups may be\nunpredictable and engage in unsanctioned attacks.\n\n\n**Figure 16: Screenshot**\nof an online retailer’s\nfraud alert\n\n\n28 Healey, J. “Beyond Attribution: Seeking National Responsibility for Cyber Attacks”. January 2012.\n\n\n-----\n\n**Fireeye: Operation Saffron Rose 2013**\n\n###### Conclusion\nThe increased politicization of the Ajax Security\nTeam, and the transition from nuisance\ndefacements to operations against internal\ndissidents and foreign targets, coincides with\nmoves by Iran aimed at increasing offensive cyber\ncapabilities. While the relationship between actors\nsuch as the Ajax Security Team and the Iranian\ngovernment is unknown, their activities appear to\nalign with Iranian government political objectives.\n\nThe capabilities of the Ajax Security Team remain\nunclear. This group uses at least one malware\nfamily that is not publicly available. We have not\ndirectly observed the Ajax Security Team use\nexploits to deliver malware, but it is unclear if they\nor other Iranian actors are capable of producing or\nacquiring exploit code.\n\nWhile the Ajax Security Team’s capabilities remain\nunclear, we know that their current operations\nhave been somewhat successful as measured by\nthe number of victims seen checking into to an Ajax\nSecurity Team controlled CnC server. We believe\nthat if these actors continue the current pace of\ntheir operations they will improve their capabilities\nin the mid-term.\n\n\n###### About FireEye\nFireEye has invented a purpose-built, virtual\nmachine-based security platform that provides\nreal-time threat protection to enterprises and\ngovernments worldwide against the next\ngeneration of cyber attacks. These highly\nsophisticated cyber attacks easily circumvent\ntraditional signature-based defenses, such as\nnext-generation firewalls, IPS, anti-virus, and\ngateways. The FireEye Threat Prevention Platform\nprovides real-time, dynamic threat protection\nwithout the use of signatures to protect an\norganization across the primary threat vectors and\nacross the different stages of an attack life cycle.\n\nThe core of the FireEye platform is a virtual\nexecution engine, complemented by dynamic\nthreat intelligence, to identify and block cyber\nattacks in real time. FireEye has over 1,500\ncustomers across more than 40 countries,\nincluding over 100 of the Fortune 500.\n\nWe thank Kenneth Geers and Jen Weedon for their support and analysis on\n\nthese findings.\n\n\n[FireEye, Inc. | 1440 McCarthy Blvd. Milpitas, CA 95035 | 408.321.6300 | 877.FIREEYE (347.3393) | info@fireeye.com | www.fireeye.com](mailto:info%40FireEye.com)\n\n© 2014 FireEye, Inc. All rights reserved. FireEye is a registered trademark of FireEye,\nInc. All other brands, products, or service names are or may be trademarks or service\nmarks of their respective owners. – RPT.OSR.EN-US.082014\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www.mandiant.com/sites/default/files/2021-09/rpt-operation-saffron-rose.pdf"
    ],
    "report_names": [
        "rpt-operation-saffron-rose.pdf"
    ],
    "threat_actors": [
        {
            "id": "8e1bae2f-2a21-4ba8-a6f1-42155f96aec8",
            "created_at": "2022-10-25T16:07:23.645758Z",
            "updated_at": "2025-03-27T02:02:09.905135Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Ajax Security Team",
                "Flying Kitten",
                "Group 26",
                "Operation Saffron Rose"
            ],
            "source_name": "ETDA:Flying Kitten",
            "tools": [
                "Stealer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8faa11f5-2a14-479c-9ea8-3779e6de9749",
            "created_at": "2022-10-25T15:50:23.814205Z",
            "updated_at": "2025-03-27T02:00:55.551798Z",
            "deleted_at": null,
            "main_name": "Ajax Security Team",
            "aliases": [
                "Ajax Security Team",
                "Operation Woolen-Goldfish",
                "AjaxTM",
                "Rocket Kitten",
                "Flying Kitten",
                "Operation Saffron Rose"
            ],
            "source_name": "MITRE:Ajax Security Team",
            "tools": [
                "sqlmap",
                "Havij"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4d7cba1-dbdd-42a9-88c5-4d0c81659ee0",
            "created_at": "2023-01-06T13:46:38.357581Z",
            "updated_at": "2025-03-27T02:00:02.813318Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Saffron Rose",
                "AjaxSecurityTeam",
                "Ajax Security Team",
                "Group 26",
                "Sayad",
                "SaffronRose"
            ],
            "source_name": "MISPGALAXY:Flying Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1698804336,
    "ts_updated_at": 1743041718,
    "ts_creation_date": 1407937355,
    "ts_modification_date": 1631568216,
    "files": {
        "pdf": "https://archive.orkl.eu/beec09c9b7d2993e12a1354c80866e1ddf0673b7.pdf",
        "text": "https://archive.orkl.eu/beec09c9b7d2993e12a1354c80866e1ddf0673b7.txt",
        "img": "https://archive.orkl.eu/beec09c9b7d2993e12a1354c80866e1ddf0673b7.jpg"
    }
}