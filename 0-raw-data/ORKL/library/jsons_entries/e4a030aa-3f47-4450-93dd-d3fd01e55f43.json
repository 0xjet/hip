{
    "id": "e4a030aa-3f47-4450-93dd-d3fd01e55f43",
    "created_at": "2023-01-12T15:01:38.261479Z",
    "updated_at": "2025-03-27T02:06:11.265241Z",
    "deleted_at": null,
    "sha1_hash": "08e439fc027c2d56ff80b41e96d7653b1d0da2cb",
    "title": "2018-04-13 - Say “Cheese”- WebMonitor RAT Comes with C2-as-a-Service (C2aaS)",
    "authors": "",
    "file_creation_date": "2022-05-28T02:27:17Z",
    "file_modification_date": "2022-05-28T02:27:17Z",
    "file_size": 3115558,
    "plain_text": "# Say “Cheese”: WebMonitor RAT Comes with C2-as-a- Service (C2aaS)\n\n**[researchcenter.paloaltonetworks.com/2018/04/unit42-say-cheese-webmonitor-rat-comes-c2-service-c2aas/](https://researchcenter.paloaltonetworks.com/2018/04/unit42-say-cheese-webmonitor-rat-comes-c2-service-c2aas/)**\n\nMike Harbison, Simon Conant April 13, 2018\n\nBy [Mike Harbison and](https://unit42.paloaltonetworks.com/author/mike-harbison/) [Simon Conant](https://unit42.paloaltonetworks.com/author/simon-conant/)\n\nApril 13, 2018 at 5:00 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit42/)\n\nTags: [C2aaS,](https://unit42.paloaltonetworks.com/tag/c2aas/) [RAT,](https://unit42.paloaltonetworks.com/tag/rat/) [WebMonitor](https://unit42.paloaltonetworks.com/tag/webmonitor/)\n\nWhile looking at commodity RATs currently offered on underground\nforums, we came across “WebMonitor”, on the market since mid-2017.\nWe noticed that while detection was high for most anti-virus vendors, all\ntagged it with only generic detection. At this point we realized that\nalthough this malware had been around for almost a year, we were\nlooking at a hitherto-undocumented commodity RAT.\n\nFor Sale\n\nCommodity RATs are typically peddled on underground forums and come and go with new\nofferings springing up to replace those taken down by law enforcement actions.\n\n\n-----\n\n_Figure 1 – WebMonitor RAT Forum sales thread_\n\nWe first observed apparent tests of this RAT in late February 2017. In May 2017, “Revcode”\nadvertises his RAT “WebMonitor” at hackforums[.]net (Figure 1) for €14.99 - €29.99 (Figure\n2):\n\n“[#1 Web RAT, CONTROL FROM WEB BROWSER, No PORTFORWARD, KEYLOGGER, +\nVPN]”.\n\n\n-----\n\n_Figure 2 – Editions of WebMonitor RAT sold at three different pricepoints._\n\nIn addition to forum sales thread, Revcode’s main sales and support site is at revcode[.] eu\n(Figure 3).\n\n_Figure 3 – Screenshot of revcode[.]eu advertising WebMonitor_\n\n\n-----\n\nFeatures\nOn the server-side, WebMonitor offers an included VPN and C2 service (discussed in detail\nlater in this report), with a web-based interface (Figure 4).\n\n_Figure 4 - Web-based C2 interface_\n\nWebMonitor offers two interface options: the original “Lite” version, and a slicker interface in\nthe “Enterprise” version.\n\nA list of features is provided at the site, some of which stretch the guise of a legitimate\nadministration tool:\n\nApplications\n\nApp crash log\nInjected DLLs list\nInstalled codes list\nLoaded DLLs list\nOverview\nBluetooth\n\nBluetooth log view\nBluetooth view\nBrowser\n\nAddons list\nHistory\nImage cache\n\n\n-----\n\nCredentials\n\nBrowser\n\nPasswords\nMail\n\nAll clients\nMessenger live\n\nAll clients\nNetwork\n\nNet pass\nWifi key view\nSystem\n\nKeys\nFilesystem\n\nDisk smart view\nFile browser\nRecent files list\nForensics\n\nHarddrive operations\nPhysical RAM dump\nKeyboard\n\nHarddrive operations\nPhysical RAM dump\nMessengers\n\nHarddrive operations\nPhysical RAM dump\nMonitor\n\nHarddrive operations\nPhysical RAM dump\nNetworking\n\nNet route view\nTCP analyze\nURL protocol view\nUser profiles view\nWiFi info\nWiFi channel monitor\nWiFi history\nWireless networks\nWireless watcher\nRuntime\n\nBlue screen log\nTurned on times\n\n\n-----\n\nSystem\n\nBattery info\nConnections\nDevice manager\nDrivers\nFirmtables\nHardware manager\nInformation\nInternal activity\nMUI cache\nProcess manager\nRemote registry\nRemote shell\nSecurity software list\nServices\nStartup view\nWin logon activity\nWindows list\nWindows update list\nWebcam\n\nSnapshot\nStream Webcam\n\nA recent development, in January Revcode partner “Softpatch” offers an Android RAT client,\n[posting the source code at Github.](https://github.com/rev-code/AndroidClient)\n\nWebMonitor Client\n\nThe WebMonitor client (ie: the RAT) is written in Visual Basic 6 (VB6) and packed with UPX.\nIt installs to users\\%USERNAME%\\AppData\\Roaming\\REVCODE-***.EXE,\nwhere **** is a random 4-digit hex value.\nFor persistence it creates a registry key under\n**x86: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run**\n**x64:HKCUU\\Software\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Run) (Figure 5),**\nsimilarly appending using the same 4-digit value.\n\n\n-----\n\n_Figure 5 - Persistence registry key_\n\nAlong with the C2-as-a-Service, the client builder is designed for ease of use, with a focus on\nsimplicity. Along with deciding whether a pop-up is displayed – or not – the customer can\ndecide whether the client should run at startup, and if the process should restart if terminated\n(Figure 6).\n\n_Figure 6 - Client Builder Interface_\n\nRevcode partner (or alternative forum account) attempts to claim legitimacy “We have to\n_follow the laws and therefore have to display installation dialogs. However, we can't help if_\n_people bypass that by cracking or patching the executable.” But then contradicts himself in_\nfact, with the builder option to NOT create an installation pop-up, and “The reason why me\n_made it possible in a way to bypass the dialog is when customers want to update their_\n_clients. We don't find it necessary to reproduce the installation dialogs.”._\n\nC2aaS\n\n[As previously seen in Quaverse RAT / QRAT, WebMonitor offers Command-and-Control](https://www.trustwave.com/Resources/SpiderLabs-Blog/Quaverse-RAT--Remote-Access-as-a-Service/)\n(C2)-as-a-Service (C2aas). Customers don’t have to (in fact, can’t) run their own C2 system,\nit’s provided for them. WebMonitor C2s to virtual-hostnames, apparently unique to each\ncustomer, at one of two root C2 domains. Although C2 communication is over HTTPS, an\nobvious downside to such a C2 domain architecture is that the C2 traffic is easily detected\nand blocked based upon the domains.\n\nWebMonitor customers access their C2 web interface via user-specific virtual hostnames at\nthe host C2s (Figure 7).\n\n\n-----\n\n_Figure 7 - C2 Virtual Hosts_\n\nThe original C2 domain was the same as the sales website, revcode[.]eu. In late July 2017, a\nsecond root-C2 was brought online, wm01[.]to (“WebMonitor”).\n\nDNS & Coin Mining\n\nStarting in samples first observed late-November 2017, in addition to DNS lookups for the C2\nas described above, the RAT clients also performed multiple lookups for non-existent\ndomains (Figure 8).\n\n\n-----\n\n_Figure 8 - NXD and Monero Mining Pool DNS lookups_\n\nThese take the form <username>.<8_char_hex_value>.to. No domains in any observed\nsamples using this technique actually exist, and as such the DNS “NXD” (non-existent\ndomain) response has no obvious C2 function.\n\nIt is possible that this is may be a yet-to-be-implemented Domain Generation Algorithm\n(DGA) implementation, otherwise possibly a clumsy and ineffectual effort to attempt to\ncamouflage the genuine C2 DNS lookup among invalid ones.\n\nOne of the very first samples observed using this new technique also contacted a Monero\nMining Pool server pool1.minexmr[.]com, as seen in Figure 8 above. This may have been the\n\n\n-----\n\nauthor testing rather than a feature released to his customers, as we only observed this once\nin the wild. Monero mining is hardly representative of a feature of a “legitimate remote\nadministration utility”.\n\nRAT Customers and Targets\nRevcode[.]eu is observed being used less often in recent months, in favor of wm01[.]to, with\nsome samples contacting both. At time of writing, we understand those to be the only two\ndomains used by WebMonitor’s C2-as-a-Service. Based upon analysis of passive DNS\nrecords, we observed just under 100 virtual hosts under the two domains, giving an\nindication of the relatively small number of customers. To date Palo Alto Networks has\ncollected just over 500 distinct samples of WebMonitor.\n\n_Figure 9 - Verticals_\n\nThe apparently-small number of customers and the “commodity” nature of this malware, with\n[a modest price tag, might suggest an innocuous threat. However, using AutoFocus, we have](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/autofocus)\nobserved over 2000 WebMonitor infection attempts against Palo Alto Networks customers\nacross multiple verticals (Figure 9), worldwide (Figure 10).\n\n\n-----\n\n_Figure 10 - Global distribution of targets_\n\nAuthor\n\nThe domain revcode[.]eu has an in-the-clear, non-anonymized WHOIS (Figure 11). Several\ncurrent and historical domains are registered with identical information, some back to 2013.\nResearch into the information in the WHOIS found corroborating information, identifying a\n25-year-old from the state of Bavaria in southern Germany.\n\n\n-----\n\n_Figure 11 – en-clar revcoce[.]eu WHOIS registration_\n\nInterestingly, while WebMonitor has been marketed since May 2017, there has been no other\nformal analysis and write-up in the year that it has been sold. The tongue-in-cheek, Floridabased blogger “Krabs on Security” offers an [analysis, but this hasn’t been picked up by](https://krabsonsecurity.com/2017/08/08/revcode-webmonitor-the-legal-malware-used-in-ceo-fraud/)\nmainstream malware researchers. She opines “a very very legal malware backed by a .eu\n_domain and a very very long Term of Service that was used in CEO Fraud, as seen below._\n_Who would’ve thought such legal software being advertised on the benign forums dubbed_\n_“HackForums” would be used for such notorious cybercriminal purposes?”. “Revcode”_\npartner “SoftPatch” seemed slighted and was quick to attack this analysis, pointing out in a\nforum post (Figure 12) multiple apparent inaccuracies.\n\n_Figure 12 - SoftPatch fires back at krabsonsecurity_\n\nAnd Revcode himself, despite the usual attempts at pretense-of-legitimacy seen in\nCommodity RAT sales, markets features that have no utility for legitimate use: “perfectly\n_compatible with all crypters and protectors”, “Privacy is our priority, so no logs are saved on_\n_our servers.”. Revcode partner (or alternative forum account” posts an exhaustive list of_\n\n\n-----\n\ncredentials that this RAT can recover _Here is a list of what kind of credentials RevCode is_\n_capable of recovering”:_\n**_Web Browsers:_**\n\n_* Internet Explorer 4.0 - 11.0_\n\n_* Mozilla Firefox - All versions_\n\n_* Google Chrome_\n\n_* Safari_\n\n_* Opera_\n\n**_IM Clients:_**\n\n_* MSN Messenger_\n\n_* Windows Messenger (In Windows XP)_\n\n_* Windows Live Messenger (In Windows XP/Vista/7)_\n\n_* Yahoo Messenger (Versions 5.x and 6.x)_\n\n_* Google Talk_\n\n_* ICQ Lite 4.x/5.x/2003_\n\n_* AOL Instant Messenger v4.6 or below, AIM 6.x, and AIM Pro_\n\n_* Trillian_\n\n_* Trillian Astra_\n\n_* Miranda_\n\n_* GAIM/Pidgin_\n\n_* MySpace IM_\n\n_* PaltalkScene_\n\n_* Digsby_\n\n**_Email Clients:_**\n\n_* Outlook Express_\n\n_* Microsoft Outlook 2002/2003/2007/2010/2013/2016_\n\n_* Windows Mail_\n\n_* Windows Live Mail_\n\n_* IncrediMail_\n\n_* Eudora_\n\n_* Netscape 6.x/7.x (If the password is not encrypted with master password)_\n\n_* Mozilla Thunderbird (If the password is not encrypted with master password)_\n\n_* Group Mail Free_\n\n_* Yahoo! Mail - If the password is saved in Yahoo! Messenger application_\n\n_* Hotmail/MSN mail - If the password is saved in MSN/Windows/Live Messenger application_\n\n_* Gmail - If the password is saved by Gmail Notifier application, Google Desktop, or by_\n_Google Talk_\n\n**_Windows Network Credentials:_**\n\n_* Login passwords of remote computers on your LAN_\n\n\n-----\n\n_Passwords of mail accounts on exchange server (stored by Microsoft Outlook)_\n\n_* Password of MSN Messenger / Windows Messenger accounts_\n\n_* Internet Explorer 7.x and 8.x_\n\n_* The passwords stored by Remote Desktop 6_\n\n**_Protected Storage:_**\n\n_* Outlook 97_\n\n_* Outlook 2000_\n\n_* Outlook XP, 2003, 2007, 2010, 2013, 2016_\n\n**_Product Keys:_**\n\n_* Microsoft Windows XP, Vista, Server, 7, 8, 10_\n\n_* Microsoft Office 2000, 2003, 2007, 2010_\n\n_* Microsoft SQL Server 2000, 2005_\n\n_* Microsoft Exchange Server 2000, 2003_\n\n_* Visual Studio_\n\n_* Some of the Adobe and Autodesk products_\n\n**_Network Credentials:_**\n\n_* WiFi stored WEP and WPA keys_\n\n_* Remote Desktop credentials_\n\nSummary\nThe feature set of this RAT would afford an attacker significant access to and control of a\nvictim. Fortunately, owing to the “C2aaS” model employed, detection of and prevention\nagainst WebMonitor C2 traffic is trivial. Webmonitor’s addition to the list of currentlymarketed commodity RATs demonstrates their continued popularity, enabling successful\nattacks even in the hands of the unsophisticated attacker.\nWe predict that WebMonitor won’t last much longer, at least not with this model as the C2s\nare too easily identified/blocked. Indeed, another aspect of this centralized model, having the\nhosted service create each client for customers, might put the author’s hands on every one\nof the malware samples in the eyes of the law.\n\nCoverage\nPalo Alto Networks customers are protected from this threat in the following ways:\n\n1. WildFire accurately identifies WebMonitor RAT samples as malicious.\n2. Traps prevents this threat on endpoints, based upon WildFire prevention.\n3. WebMonitor root C2 domains are flagged as malicious in Threat Prevention.\n\n[AutoFocus users can view WebMonitor RAT samples using the “WebMonitorRAT” tag.](https://autofocus.paloaltonetworks.com/#/tag/Unit42.WebMonitor)\nIOCs can be found in the appendices of this report.\n\n\n-----\n\nAppendices - IOCs\n\n**Appendix I – C2 domains**\nrevcode[.]eu\nwm01[.]to\n\n**Appendix II – Sample hashes**\n[Hashes of WebMonitor samples can be found here.](https://github.com/pan-unit42/iocs/blob/master/WebMonitor/WebMonitor.txt)\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-04-13 - Say “Cheese”- WebMonitor RAT Comes with C2-as-a-Service (C2aaS).pdf"
    ],
    "report_names": [
        "2018-04-13 - Say “Cheese”- WebMonitor RAT Comes with C2-as-a-Service (C2aaS).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535698,
    "ts_updated_at": 1743041171,
    "ts_creation_date": 1653704837,
    "ts_modification_date": 1653704837,
    "files": {
        "pdf": "https://archive.orkl.eu/08e439fc027c2d56ff80b41e96d7653b1d0da2cb.pdf",
        "text": "https://archive.orkl.eu/08e439fc027c2d56ff80b41e96d7653b1d0da2cb.txt",
        "img": "https://archive.orkl.eu/08e439fc027c2d56ff80b41e96d7653b1d0da2cb.jpg"
    }
}