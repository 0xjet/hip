{
    "id": "77d15f3c-97b7-4fcc-b553-07ba0f02adc6",
    "created_at": "2023-01-12T15:08:02.924826Z",
    "updated_at": "2025-03-27T02:16:39.988058Z",
    "deleted_at": null,
    "sha1_hash": "f0545987983e08fa48843f953216c23f6962ce55",
    "title": "2021-07-18 - Forensic Methodology Report- How to catch NSO Group’s Pegasus",
    "authors": "",
    "file_creation_date": "2022-05-28T03:20:55Z",
    "file_modification_date": "2022-05-28T03:20:55Z",
    "file_size": 1181735,
    "plain_text": "# Forensic Methodology Report: How to catch NSO Group’s Pegasus\n\n**[amnesty.org/en/latest/research/2021/07/forensic-methodology-report-how-to-catch-nso-groups-pegasus/](https://www.amnesty.org/en/latest/research/2021/07/forensic-methodology-report-how-to-catch-nso-groups-pegasus/)**\n\nJuly 18, 2021\n[A copy of this report is available for download here.](https://www.amnesty.org/en/documents/doc10/4487/2021/en/)\n\n## Introduction\n\n\nJuly 18, 2021\n\n\n[NSO Group claims that its Pegasus spyware is only used to “investigate terrorism and crime” and](https://www.nsogroup.com/) [“leaves no traces whatsoever”. This](https://www.documentcloud.org/documents/4599753-NSO-Pegasus.html)\nForensic Methodology Report shows that neither of these statements are true. This report accompanies the release of the Pegasus Project, a\ncollaborative investigation that involves more than 80 journalists from 17 media organizations in 10 countries coordinated by Forbidden Stories\nwith technical support of Amnesty International’s Security Lab.[1]\n\nAmnesty International’s Security Lab has performed in-depth forensic analysis of numerous mobile devices from human rights defenders\n(HRDs) and journalists around the world. This research has uncovered widespread, persistent and ongoing unlawful surveillance and human\nrights abuses perpetrated using NSO Group’s Pegasus spyware.\n\nAs laid out in the UN Guiding Principles on Business and Human Rights, NSO Group should urgently take pro-active steps to ensure that it\ndoes not cause or contribute to human rights abuses within its global operations, and to respond to any human rights abuses when they do\noccur. In order to meet that responsibility, NSO Group must carry out adequate human rights due diligence and take steps to ensure that HRDs\nand journalists do not continue to become targets of unlawful surveillance.\n\nIn this Forensic Methodology Report, Amnesty International is sharing its methodology and publishing an open-source mobile forensics tool\nand detailed technical indicators, in order to assist information security researchers and civil society with detecting and responding to these\nserious threats.\n\nThis report documents the forensic traces left on iOS and Android devices following targeting with the Pegasus spyware. This includes forensic\nrecords linking recent Pegasus infections back to the 2016 Pegasus payload used to target the HRD Ahmed Mansoor.\n\nThe Pegasus attacks detailed in this report and accompanying appendices are from 2014 up to as recently as July 2021. These also include\nso-called “zero-click” attacks which do not require any interaction from the target. Zero-click attacks have been observed since May 2018 and\ncontinue until now. Most recently, a successful “zero-click” attack has been observed exploiting multiple zero-days to attack a fully patched\niPhone 12 running iOS 14.6 in July 2021.\n\nSections 1 to 8 of this report outline the forensic traces left on mobile devices following a Pegasus infection. This evidence has been collected\nfrom the phones of HRDs and journalists in multiple countries.\n\nFinally, in section 9 the report documents the evolution of the Pegasus network infrastructure since 2016. NSO Group has redesigned their\nattack infrastructure by employing multiple layers of domains and servers. Repeated operational security mistakes have allowed the\nAmnesty International Security Lab to maintain continued visibility into this infrastructure. We are publishing a set of 700 Pegasus-related\n\n\n-----\n\ndo a s\n\nNames of several of the civil society targets in the report have been anonymized for safety and security reasons. Individuals who have been\nanonymized have been assigned an alphanumeric code name in this report.\n\n## 1. Discovering Pegasus network injection attacks\n\nAmnesty International’s technical investigation into NSO Group’s Pegasus intensified following our discovery of the targeting of an Amnesty\nInternational staffer and a Saudi activist, Yahya Assiri, in 2018. Amnesty International’s Security Lab began refining its forensics methodology\n[through the discovery of attacks against HRDs in Morocco in 2019, which were further corroborated by attacks we discovered against a](https://www.amnesty.org/en/latest/research/2019/10/Morocco-Human-Rights-Defenders-Targeted-with-NSO-Groups-Spyware/)\nMoroccan journalist in 2020. In this first section we detail the process which led to the discovery of these compromises.\n\nNumerous public reports had identified NSO Group’s customers using SMS messages with Pegasus exploit domains over the years. As a\nresult, similar messages emerged from our analysis of the phone of Moroccan activist Maati Monjib, who was one of the activists targeted as\ndocumented in Amnesty International’s [2019 report.](https://www.amnesty.org/en/latest/research/2019/10/Morocco-Human-Rights-Defenders-Targeted-with-NSO-Groups-Spyware/)\n\nHowever, on further analysis we also noticed suspicious redirects recorded in Safari’s browsing history. For example, in one case we noticed a\nredirect to an odd-looking URL after Maati Monjib attempted to visit Yahoo:\n\n\n**Visit**\n**ID**\n\n\n**Date (UTC)** **URL** **Redirect**\n**Source**\n\n\n**Redirect**\n**Destination**\n\n\n16119 2019-07-22\n17:42:32.475\n\n16120 2019-07-22\n17:42:32.478\n\n\nhttp://yahoo.fr/ null 16120\n\nhttps://bun54l2b67.get1tn0w.free247downloads[.]com:30495/szev4hz 16119 null\n\n\n(Please note: throughout this document we escaped malicious domains with the marking [.] to prevent accidental clicks and visits.)\n\nThe URL https://bun54l2b67.get1tn0w.free247downloads[.]com:30495/szev4hz immediately appeared suspicious, particularly because of\nthe presence of a 4th level subdomain, a non-standard high port number, and a random URI similar to links contained in SMS messages\npreviously documented in connection to NSO Group’s Pegasus. As you can see in the table above, the visit to Yahoo was immediately\nredirected to this suspicious URL with database ID 16120.\n\nIn our [October 2019 report, we detail how we determined these redirections to be the result of network injection attacks performed either](https://www.amnesty.org/en/latest/research/2019/10/morocco-human-rights-defenders-targeted-with-nso-groups-spyware/)\nthrough tactical devices, such as rogue cell towers, or through dedicated equipment placed at the mobile operator. When months later we\nanalysed the iPhone of Moroccan independent journalist Omar Radi, who as documented in our 2020 report was targeted, we found similar\nrecords involving the free247downloads[.]com domain as well.\n\nIn November 2019, after Amnesty International’s initial report, a new domain urlpush[.]net was registered. We found it subsequently involved\nin similar redirects to the URL https://gnyjv1xltx.info8fvhgl3.urlpush[.]net:30875/zrnv5revj.\n\nAlthough Safari history records are typically short lived and are lost after a few months (as well as potentially intentionally purged by malware),\nwe have been able to nevertheless find NSO Group’s infection domains in other databases of Omar Radi’s phone that did not appear in\nSafari’s History. For example, we could identify visits through Safari’s Favicon.db database, which was left intact by Pegasus:\n\n\n**Date**\n**(UTC)**\n\n201902-11\n14:45:53\n\n201909-13\n17:01:38\n\n201909-13\n17:01:56\n\n202001-17\n11:06:32\n\n\n**URL**\n\nhttps://d9z3sz93x5ueidq3.get1tn0w.free247downloads[.]com:30897/rdEN5YP\n\nhttps://2far1v4lv8.get1tn0w.free247downloads[.]com:31052/meunsnyse#0113565702571172968348457040223389731330224333972\n\nhttps://2far1v4lv8.get1tn0w.free247downloads[.]com:31052/meunsnyse#0680995616146262785199253586387891615724278336453\n\nhttps://gnyjv1xltx.info8fvhgl3.urlpush[.]net:30875/zrnv5revj#074196419827987919274001548622738919835556748325946%2324\n\n\n-----\n\n202001-27\n11:06:24\n\n\nhttps://gnyjv1xltx.info8fvhgl3.urlpush[.]net:30875/zrnv5revj#074196419827987919274001548622738919835556748325946\n\n\n[As explained in the Technical Appendix of our 2020 report on Pegasus attacks in Morocco, these redirects do not only happen when the target](https://www.amnesty.org/en/latest/research/2020/06/moroccan-journalist-targeted-with-network-injection-attacks-using-nso-groups-tools/)\nis navigating the Internet with the browser app, but also when using other apps. For example, in one case Amnesty International identified a\nnetwork injection while Omar Radi was using the Twitter app. When previewing a link shared in his timeline, the service\n**com.apple.SafariViewService was invoked to load a Safari WebView, and a redirect occurred.**\n\nBecause of this, we can find additional records involving the domains free247downloads[.]com and urlpush[.]net in app-specific WebKit\nlocal storage, IndexedDB folders, and more. In multiple cases IndexedDB files were created by Safari shortly after the network injection\nredirect to the Pegasus Installation Server.\n\nIn addition, Safari’s Session Resource logs provide additional traces that do not consistently appear in Safari’s browsing history. It appears\nSafari does not record full redirect chains, and might only keep history records showing the final page that was loaded. Session Resource logs\nrecovered from the analysed phones demonstrate that additional staging domains are used as trampolines eventually leading to the infection\nservers. In fact, these logs reveal that the very first network injection against Maati Monjib we describe at the beginning of this post also\ninvolved the domain documentpro[.]org:\n\n**Redirect Source** **Origin** **Redirect Destination**\n\nyahoo.fr documentpro[.]org free247downloads[.]com\n\nMaati Monjib visited http://yahoo.fr, and a network injection forcefully redirected the browser to documentpro[.]org before further redirecting to\nfree247downloads[.]com and proceed with the exploitation.\n\nSimilarly, on a different occasion Omar Radi visited the website of French newspaper Le Parisien, and a network injection redirected him\nthrough the staging domain tahmilmilafate[.]com and then eventually to free247downloads[.]com as well. We also saw tahmilmilafate[.]info\nused in the same way:\n\n**Redirect Source** **Origin** **Redirect Destination**\n\nleparisien.fr tahmilmilafate[.]com free247downloads[.]com\n\nIn the most recent attempts Amnesty International observed against Omar Radi in January 2020, his phone was redirected to an exploitation\npage at gnyjv1xltx.info8fvhgl3.urlpush[.]net passing through the domain baramije[.]net. The domain baramije[.]net was registered one day\nbefore urlpush[.]net, and a decoy website was set up using the open source Textpattern CMS.\n\nTraces of network activity were not the only available indicators of compromise, and further inspection of the iPhones revealed executed\nprocesses which eventually led to the establishment of a consistent pattern unique to all subsequent iPhones that Amnesty International\nanalysed and found to be infected.\n\n## 2. Pegasus’ BridgeHead and other malicious processes appear\n\nAmnesty International, Citizen Lab, and others have primarily attributed Pegasus spyware attacks based on the domain names and other\nnetwork infrastructure used to deliver the attacks. However, forensic evidence left behind by the Pegasus spyware provides another\nindependent way to attribute these attacks to NSO Group’s technology.\n\niOS maintains records of process executions and their respective network usage in two SQLite database files called “DataUsage.sqlite” and\n“netusage.sqlite” which are stored on the device. It is worth noting that while the former is available in iTunes backup, the latter is not.\nAdditionally, it should be noted that only processes that performed network activity will appear in these databases.\n\nBoth Maati Monjib’s and Omar Radi’s network usage databases contained records of a suspicious process called “bh”. This “bh” process was\nobserved on multiple occasions immediately following visits to Pegasus Installation domains.\n\nMaati Monjib’s phone has records of execution of “bh” from April 2018 until March 2019:\n\n**Fist date (UTC)** **Last date (UTC)** **Process Name** **WWAN IN** **WWAN OUT** **Process ID**\n\n2018-04-29 00:25:12 2019-03-27 22:45:10 **bh** 3319875.0 144443.0 59472\n\nAmnesty International found similar records on Omar Radi’s phone between February and September 2019:\n\n\n-----\n\n**Fist date (UTC)** **Last date (UTC)** **Process Name** **WWAN IN** **WWAN OUT** **Process ID**\n\n2019-02-11 14:45:56 2019-09-13 17:02:11 **bh** 3019409.0 147684.0 50465\n\nThe last recorded execution of “bh” occurred a few seconds after a successful network injection (as seen in the favicon records listed earlier at\n2019-09-13 17:01:56).\n\nCrucially, we find references to “bh” in the Pegasus iOS sample recovered from the 2016 attacks against UAE human rights defender Ahmed\nMansoor, [discovered by Citizen Lab and](https://citizenlab.ca/2016/08/million-dollar-dissident-iphone-zero-day-nso-group-uae/) [analysed in depth by cybersecurity firm Lookout.](https://info.lookout.com/rs/051-ESQ-475/images/pegasus-exploits-technical-details.pdf)\n\nAs described in Lookout’s analysis, in 2016 NSO Group leveraged a vulnerability in the iOS JavaScriptCore Binary (jsc) to achieve code\nexecution on the device. This same vulnerability was also used to maintain persistence on the device after reboot. We find references to “bh”\nthroughout the exploit code:\n\nvar compressed_bh_addr = shellcode_addr_aligned + shellcode32.byteLength;\n\nreplacePEMagics(shellcode32, dlsym_addr, compressed_bh_addr, bundle.bhCompressedByteLength);\n\nstoreU32Array(shellcode32, shellcode_addr);\n\nstoreU32Array(bundle.bhCompressed32, compressed_bh_addr);\n\nThis module is described in Lookout’s analysis as follows:\n\n_“bh.c – Loads API functions that relate to the decompression of next stage payloads and their proper placement on the victim’s iPhone by_\n_using functions such as BZ2_bzDecompress, chmod, and malloc”_\n\nLookout further explains that a configuration file located at /var/tmp/jb_cfg is dropped alongside the binary. Interestingly, we find the path to this\nfile exported as _kBridgeHeadConfigurationFilePath in the libaudio.dylib file part of the Pegasus bundle:\n\n__const:0001AFCC         EXPORT _kBridgeHeadConfigurationFilePath\n\n__const:0001AFCC _kBridgeHeadConfigurationFilePath DCD cfstr_VarTmpJb_cfg ; “/var/tmp/jb_cfg”\n\nTherefore, we suspect that “bh” might stand for “BridgeHead”, which is likely the internal name assigned by NSO Group to this component\nof their toolkit.\n\nThe appearance of the “bh” process right after the successful network injection of Omar Radi’s phone is consistent with the evident purpose of\nthe BridgeHead module. It completes the browser exploitation, roots the device and prepares for its infection with the full Pegasus suite.\n\n## 2.1 Additional suspicious processes following BridgeHead\n\nThe bh process first appeared on Omar Radi’s phone on 11 February 2019. This occurred 10 seconds after an IndexedDB file was created by\nthe Pegasus Installation Server and a favicon entry was recorded by Safari. At around the same time the file com.apple.CrashReporter.plist file\nwas written in /private/var/root/Library/Preferences/, likely to disable reporting of crash logs back to Apple. The exploit chain had obtained root\npermission at this stage.\n\nLess than a minute later a “roleaboutd” process first appears.\n\n**Date (UTC)** **Event**\n\n2019-02-11 14:45:45 IndexedDB record for URL https_d9z3sz93x5ueidq3.get1tn0w.free247downloads.com_30897/\n\n2019-02-11 14:45:53 Safari Favicon record for URL hxxps//d9z3sz93x5ueidq3.get1tn0w.free247downloads[.]com:30897/rdEN5YP\n\n2019-02-11 14:45:54 Crash reporter disabled by writing com.apple.CrashReporter.plist\n\n2019-02-11 14:45:56 Process: bh\n\n2019-02-11 14:46:23 Process: roleaboutd first\n\n2019-02-11 17:05:24 Process: roleaboutd last\n\n\n-----\n\nO a ad s de ce as e p o ted aga o t e 3 Septe be 0 9 ga a b p ocess sta ted s o t y a te a ds ou d t s t e t e\n_com.apple.softwareupdateservicesd.plist file was modified. A “msgacntd” process was also launched._\n\n**Date (UTC)** **Event**\n\n2019-09-13 17:01:38 Safari Favicon record for URL hxxps://2far1v4lv8.get1tn0w.free247downloads[.]com:31052/meunsnyse\n\n2019-09-13 17:02:11 Process: bh\n\n2019-09-13 17:02:33 Process: msgacntd first\n\n2019-09-13 17:02:35 File modified: com.apple.softwareupdateservicesd.plist\n\n2019-09-14 20:51:54 Process: msgacntd last\n\nBased on the timing and context of exploitation, Amnesty International believes the roleaboutd and msgacntd processes are a later stage of\nthe Pegasus spyware which was loaded after a successful exploitation and privilege escalation with the BridgeHead payload.\n\nSimilarly, the forensic analysis of Maati Monjib’s phone revealed the execution of more suspicious processes in addition to bh. A process\nnamed pcsd and one named fmld appeared in 2018:\n\n**Fist date** **Last date** **Process Name** **WWAN IN** **WWAN OUT** **Process ID**\n\n2018-05-04 23:30:45 2018-05-04 23:30:45 **pcsd** 12305.0 10173.0 14946\n\n2018-05-21 23:46:06 2018-06-4 13:05:43 **fmld** 0.0 188326.0 21207\n\n**Amnesty International verified that no legitimate binaries of the same names were distributed in recent versions of iOS.**\n\nThe discovery of these processes on Omar Radi’s and Maati Monjib’s phones later became instrumental for Amnesty International’s continued\ninvestigations, as we found processes with the same names on devices of targeted individuals from around the world.\n\n## 3. Pegasus processes following potential Apple Photos exploitation\n\nDuring Amnesty International’s investigations as part of The Pegasus Project we discovered additional cases where the above mentioned “bh”\nprocess was recorded on devices compromised through different attack vectors.\n\nIn one instance, the phone of a French human rights lawyer (CODE: FRHRL1) was compromised and the “bh” process was executed seconds\nafter network traffic for the iOS Photos app (com.apple.mobileslideshow) was recorded for the first time. Again, after a successful exploitation,\ncrash reporting was disabled by writing a com.apple.CrashReporter.plist file to the device.\n\n2019-10-29 09:04:32 Process: mobileslideshow/com.apple.mobileslideshow first\n\n2019-10-29 09:04:58 Process: bh\n\n2019-10-29 09:05:08 com.apple.CrashReporter.plist dropped\n\n2019-10-29 09:05:53 Process: mptbd\n\nThe next and last time network activity for the iOS Photos app was recorded was on 18 December 2019, again preceding the execution of\nmalicious processes on the device.\n\n2019-12-18 08:13:33 Process: mobileslideshow/com.apple.mobileslideshow last\n\n2019-12-18 08:13:47 Process: bh\n\n2019-12-18 11:50:15 Process: ckeblld\n\n\n-----\n\na sepa ate case, e de t ed a s a patte t t e ob es des o a d b p ocesses o t e o e o a e c jou a st (CO\nFRJRN1) in May 2020:\n\n2020-05-24 15:44:21 Process: mobileslideshow/com.apple.mobileslideshow first\n\n2020-05-24 15:44:39 Process: bh\n\n2020-05-24 15:46:51 Process: fservernetd\n\n…\n\n2020-05-27 16:58:31 Process: mobileslideshow/com.apple.mobileslideshow last\n\n2020-05-27 16:58:52 Process: bh\n\n2020-05-27 18:00:50 Process: ckkeyrollfd\n\nAmnesty International was not able to capture payloads related this exploitation but suspects that the iOS Photos app or the Photostream\nservice were used as part of an exploit chain to deploy Pegasus. The apps themselves may have been exploited or their functionality misused\nto deliver a more traditional JavaScript or browser exploit to the device.\n\nAs you can see from the tables above, additional process names such as mptbd, ckeblld, fservernetd, and ckkeyrollfd appear right after bh.\nAs with fmld and pcsd, Amnesty International believes these to be additional payloads downloaded and executed after a successful\ncompromise. As our investigations progressed, we identified dozens of malicious process names involved in Pegasus infections.\n\nAdditionally, Amnesty International found the same iCloud account bogaardlisa803[@]gmail.com recorded as linked to the\n“com.apple.private.alloy.photostream” service on both devices. Purposefully created iCloud accounts seem to be central to the delivery of\nmultiple “zero-click” attack vectors in many recent cases of compromised devices analysed by Amnesty International.\n\n## 4. An iMessage zero-click 0day used widely in 2019\n\nWhile SMS messages carrying malicious links were the tactic of choice for NSO Group’s customers between 2016 and 2018, in more recent\nyears they appear to have become increasingly rare. The discovery of network injection attacks in Morocco signalled that the attackers’ tactics\nwere indeed changing. Network injection is an effective and cost-efficient attack vector for domestic use especially in countries with leverage\nover mobile operators. However, while it is only effective on domestic networks, the targeting of foreign targets or of individuals in diaspora\ncommunities also changed.\n\nFrom 2019 an increasing amount of vulnerabilities in iOS, especially iMessage and FaceTime, started getting patched thanks to their\ndiscoveries by vulnerability researchers, or to cybersecurity vendors reporting exploits discovered in-the-wild.\n\nIn response, Amnesty International extended its forensic methodology to collect any relevant traces by iMessage and FaceTime. iOS keeps a\nrecord of Apple IDs seen by each installed application in a plist file located at\n_/private/var/mobile/Library/Preferences/com.apple.identityservices.idstatuscache.plist. This file is also typically available in a regular iTunes_\nbackup, so it can be easily extracted without the need of a jailbreak.\n\nThese records played critical role in later investigations. In many cases we discovered suspected Pegasus processes executed on devices\nimmediately following suspicious iMessage account lookups. For example, the following records were extracted from the phone of a French\njournalist (CODE FRJRN2):\n\n2019-06-16 12:08:44 Lookup of **[[email protected] by com.apple.madrid (iMessage)](https://www.amnesty.org/cdn-cgi/l/email-protection)**\n\n2019-08-16 12:33:52 Lookup of [[email protected]\\x00\\x00om by com.apple.madrid (iMessage)](https://www.amnesty.org/cdn-cgi/l/email-protection)\n\n2019-08-16 12:37:55 The file Library/Preferences/com.apple.CrashReporter.plist is created within RootDomain\n\n2019-08-16 12:41:25 The file Library/Preferences/roleaccountd.plist is created within RootDomain\n\n2019-08-16 12:41:36 Process: roleaccountd\n\n2019-08-16 12:41:52 Process: stagingd\n\n\n-----\n\n2019-08-16 12:49:21 Process: aggregatenotd\n\nAmnesty International’s forensic analysis of multiple devices found similar records. In many cases the same iMessage account reoccurs\nacross multiple targeted devices, potentially indicating that those devices have been targeted by the same operator. Additionally, the processes\n**roleaccountd and stagingd occur consistently, along with others.**\n\nFor example, the iPhone of a Hungarian journalist (CODE HUJRN1) instead showed the following records:\n\n2019-09-24 13:26:15 Lookup of **[[email protected] by com.apple.madrid (iMessage)](https://www.amnesty.org/cdn-cgi/l/email-protection)**\n\n2019-09-24 13:26:51 Lookup of **[[email protected] by com.apple.madrid (iMessage)](https://www.amnesty.org/cdn-cgi/l/email-protection)**\n\n2019-09-24 13:32:10 Process: roleaccountd\n\n2019-09-24 13:32:13 Process: stagingd\n\nIn this case, the first suspicious processes performing some network activity were recorded 5 minutes after the first lookup. The\n_com.apple.CrashReporter.plist file was already present on this device after a previous successful infection and was not written again._\n\nThe iPhone of yet another Hungarian journalist (CODE HUJRN2) show lookups for the same iMessage accounts along with numerous other\nprocesses along with roleaccountd and stagingd:\n\n2019-07-15 12:01:37 [Lookup of mailto:e\\x00\\x00[email protected] by com.apple.madrid (iMessage)](https://www.amnesty.org/cdn-cgi/l/email-protection)\n\n2019-07-15 14:21:40 Process: accountpfd\n\n2019-08-29 10:57:43 Process: roleaccountd\n\n2019-08-29 10:57:44 Process: stagingd\n\n2019-08-29 10:58:35 Process: launchrexd\n\n2019-09-03 07:54:26 Process: roleaccountd\n\n2019-09-03 07:54:28 Process: stagingd\n\n2019-09-03 07:54:51 Process: seraccountd\n\n2019-09-05 13:26:38 Process: seraccountd\n\n2019-09-05 13:26:55 Process: misbrigd\n\n2019-09-10 06:09:04 Lookup of **[[email protected] by com.apple.madrid (iMessage)](https://www.amnesty.org/cdn-cgi/l/email-protection)**\n\n2019-09-10 06:09:47 Lookup of **[[email protected] by com.apple.madrid (iMessage)](https://www.amnesty.org/cdn-cgi/l/email-protection)**\n\n2019-10-30 14:09:51 Process: nehelprd\n\nIt is interesting to note that in the traces Amnesty International recovered from 2019, the iMessage lookups that immediately preceded the\nexecution of suspicious processes often contained two-bytes 0x00 padding in the email address recorded by the ID Status Cache file.\n\n## 5. Apple Music leveraged to deliver Pegasus in 2020\n\nIn mid-2021 Amnesty International identified yet another case of a prominent investigative journalist from Azerbaijan (CODE AZJRN1) who\nwas repeatedly targeted using Pegasus zero-click attacks from 2019 until mid-2021.\n\nYet again, we found a similar pattern of forensic traces on the device following the first recorded successful exploitation:\n\n\n-----\n\n2019-03-28 07:43:14 File: Library/Preferences/com.apple.CrashReporter.plist from RootDomain\n\n2019-03-28 07:44:03 File: Library/Preferences/roleaccountd.plist from RootDomain\n\n2019-03-28 07:44:14 Process: roleaccountd\n\n2019-03-28 07:44:14 Process: stagingd\n\nInterestingly we found signs of a new iOS infection technique being used to compromise this device. A successful infection occurred on 10th\nJuly 2020:\n\n\n2020-07-06\n05:22:21\n\n2020-07-10\n14:12:09\n\n2020-07-10\n14:12:21\n\n2020-07-10\n14:12:53\n\n2020-07-13\n05:05:17\n\n\n[Lookup of f\\x00\\[email protected] by iMessage (com.apple.madrid)](https://www.amnesty.org/cdn-cgi/l/email-protection)\n\nPegasus request by Apple Music app:\n**https://x1znqjo0x8b8j.php78mp9v.opposedarrangement[.]net:37271/afAVt89Wq/stadium/pop2.html?**\n**key=501_4&n=7**\n\nProcess: roleaccountd\n\nProcess: stagingd\n\nPegasus request by Apple Music app:\n**https://4n3d9ca2st.**\n\n**php78mp9v.opposedarrangement[.]net:37891/w58Xp5Z/stadium/pop2.html?key=501_4&n=7**\n\n\nShortly before Pegasus was launched on the device, we saw network traffic recorded for the Apple Music service. These HTTP requests were\nrecovered from a network cache file located at /private/var/mobile/Containers/Data/Application/D6A69566-55F7-4757-96DE_EBA612685272/Library/Caches/com.apple.Music/Cache.db which we retrieved by jailbreaking the device._\n\nAmnesty International cannot determine from forensics if Apple Music was itself exploited to deliver the initial infection or if instead, the app\n[was abused as part of a sandbox escape and privilege escalation chain. Recent research has shown that built-in apps such as the iTunes](https://blog.chichou.me/mistune/)\nStore app can be abused to run a browser exploit while escaping the restrictive Safari application sandbox.\n\nMost importantly however, the HTTP request performed by the Apple Music app points to the domain opposedarrangement[.]net, which we\nhad previously identified as belonging to NSO Group’s Pegasus network infrastructure. This domain matched a distinctive fingerprint we\ndevised while conducting Internet-wide scans following our discovery of the network injection attacks in Morocco (see section 9).\n\nIn addition, these URLs show peculiar characteristics typical of other URLs we found involved in Pegasus attacks through the years, as\nexplained in the next section.\n\n## 6. Megalodon: iMessage zero-click 0-days return in 2021\n\nThe analysis Amnesty International conducted of several devices reveal traces of attacks similar to those we observed in 2019. These attacks\nhave been observed as recently as July 2021. Amnesty International believes Pegasus is currently being delivered through zero-click exploits\nwhich remain functional through the latest available version of iOS at the time of writing (July 2021).\n\nOn the iPhone of a French human rights lawyer (CODE FRHRL2), we observed a lookup of a suspicious iMessage account unknown to the\nvictim, followed by an HTTP request performed by the com.apple.coretelephony process. This is a component of iOS involved in all\ntelephony-related tasks and likely among those exploited in this attack. We found traces of this HTTP request in a cache file stored on disk at\n_/private/var/wireless/Library/Caches/com.apple.coretelephony/Cache.db containing metadata on the request and the response. The phone_\nsent information on the device including the model 9,1 (iPhone 7) and iOS build number 18C66 (version 14.3) to a service fronted by Amazon\nCloudFront, suggesting NSO Group has switched to using AWS services in recent months. At the time of this attack, the newer iOS version\n14.4 had only been released for a couple of weeks.\n\n**Date (UTC)** **Event**\n\n\n2021-02-08\n10:42:40\n\n\nLookup of **[[email protected] by iMessage (com.apple.madrid)](https://www.amnesty.org/cdn-cgi/l/email-protection)**\n\n\n-----\n\n2021-02-08\n11:27:10\n\n2021-02-08\n11:27:21\n\n2021-02-08\n11:27:22\n\n2021-02-08\n11:27:23\n\n\ncom.apple.coretelephony performs an HTTP request to\n**https://d38j2563clgblt.cloudfront[.]net/fV2GsPXgW//stadium/megalodon?m=iPhone9,1&v=18C66**\n\nProcess: gatekeeperd\n\ngatekeeperd performs an HTTP request to https://d38j2563clgblt.cloudfront.net/fV2GsPXgW//stadium/wizard/01**00000000**\n\nProcess: gatekeeperd\n\n\nThe Cache.db file for com.apple.coretelephony contains details about the HTTP response which appeared to have been a download of ~250kb\nof binary data. Indeed, we found the downloaded binary in the fsCachedData sub-folder, but it was unfortunately encrypted. Amnesty\nInternational believes this to be the payload launched as gatekeeperd.\n\nAmnesty International subsequently analysed the iPhone of a journalist (CODE MOJRN1), which contained very similar records. This device\nwas exploited repeatedly on numerous times between February and April 2021 and across iOS releases. The most recent attempt showed the\nfollowing indicators of compromise:\n\n\n**Date**\n**(UTC)**\n\n2021-04-02\n10:15:38\n\n2021-04-02\n10:36:00\n\n2021-04-02\n10:36:08\n\n2021-04-02\n10:36:16\n\n2021-04-02\n10:36:16\n\n2021-04-02\n10:36:35\n\n2021-04-02\n10:36:45\n\n\n**Event**\n\nLookup of **[[email protected] by iMessage (com.apple.madrid)](https://www.amnesty.org/cdn-cgi/l/email-protection)**\n\ncom.apple.coretelephony performs an HTTP request to\n**https://d38j2563clgblt.cloudfront[.]net/dMx1hpK//stadium/megalodon?m=iPhone8,1&v=18D52&u=[REDACTED]**\n\nProcess PDPDialogs performs an HTTP request to\n**https://d38j2563clgblt.cloudfront[.]net/dMx1hpK//stadium/wizard/ttjuk**\n\nProcess PDPDialogs performs an HTTP request to\n**https://d38j2563clgblt.cloudfront[.]net/dMx1hpK//stadium/wizard/01-00000000**\n\ncom.apple.coretelephony performs an HTTP request to\n**https://d38j2563clgblt.cloudfront[.]net/dMx1hpK//stadium/wizard/cszjcft=frzaslm**\n\nProcess: gatekeeperd\n\nProcess: rolexd\n\n\nAs is evident, the same iMessage account observed in the previous separate case was involved in this exploitation and compromise months\nlater. The same CloudFront website was contacted by com.apple.coretelephony and the additional processes executed, downloaded and\nlaunched additional malicious components.\n\nThe initial check-in indicates the compromised iPhone 6s was running iOS 14.4 (build number 18D52) at the time of the attack. Although\nversions 14.4.1 and 14.4.2 were already available then, they only addressed vulnerabilities in WebKit, so it is safe to assume the vulnerability\nleveraged in these iMessage attacks was exploited as a 0-day.\n\nIt is worth noting that among the many other malicious process names observed executed on this phone we see msgacntd, which we also\nfound running on Omar Radi’s phone in 2019, as documented earlier.\n\nIn addition, it should be noted that the URLs we have observed used in attacks throughout the last three years show a consistent set of\npatterns. This supports Amnesty International’s analysis that all three URLs are in fact components of Pegasus customer attack infrastructure.\nThe Apple Music attack from 2020 shows the same 4th level domain structure and non-standard high port number as the 2019 network\ninjection attack. Both the free247downloads[.]com and opposedarrangements[.]net domains matched our Pegasus V4 domain fingerprint.\n\nAdditionally, the Apple Music attack URL and the 2021 Megalodon attack URLs share a distinctive pattern. Both URL paths start with a random\nidentifier tied to the attack attempt followed by the word “stadium”\n\n\n-----\n\n**Attack** **URL**\n\n\nNetwork injection\n(2019)\n\nApple Music attack\n(2020)\n\niMessage zero-click\n(2021)\n\n\nhttps://2far1v4lv8.get1tn0w.free247downloads[.]com:31052/meunsnyse\n\nhttps://4n3d9ca2st.php78mp9v.opposedarrangement[.]net:37891/w58Xp5Z/stadium/pop2.html?\nkey=501_4&n=7\n\nhttps://d38j2563clgblt.cloudfront[.]net/dMx1hpK//stadium/wizard/ttjuk\n\n\nAmnesty International reported this information to Amazon, who informed us they “acted quickly to shut down the implicated infrastructure and\n_accounts”.[2]_\n\nThe iPhone 11 of a French human rights activist (CODE FRHRD1) also showed an iMessage look-up for the account\n**linakeller2203[@]gmail.com on June 11th 2021 and malicious processes afterwards. The phone was running iOS 14.4.2 and was upgraded**\nto 14.6 the following day.\n\nMost recently, Amnesty International has observed evidence of compromise of the iPhone XR of an Indian journalist (CODE INJRN1) running\niOS 14.6 (latest available at the time of writing) as recently as 16th June 2021. Lastly, Amnesty International has confirmed an active infection\nof the iPhone X of an activist (CODE RWHRD1) on June 24th 2021, also running iOS 14.6. While we have not been able to extract records\nfrom Cache.db databases due to the inability to jailbreak these two devices, additional diagnostic data extracted from these iPhones show\nnumerous iMessage push notifications immediately preceding the execution of Pegasus processes.\n\nThe device of a Rwandan activist (CODE RWHRD1) shows evidence of multiple successful zero-click infections in May and June 2021. We\ncan see one example of this on 17 May 2021. An unfamiliar iMessage account is recorded and in the following minutes at least 20 iMessage\nattachment chunks are created on disk.\n\n**Date (UTC)** **Event**\n\n\n2021-05-17\n13:39:16\n\n2021-05-17\n13:40:12\n\n2021-05-17\n13:40:21\n\n\nLookup for iCloud account benjiburns8[@]gmail.com (iMessage)\n\nFile: /private/var/mobile/Library/SMS/Attachments/dc/12/DEAE6789-0AC4-41A9-A91C5A9086E406A5/.eBDOuIN1wq.gif-2hN9\n\nFile: /private/var/mobile/Library/SMS/Attachments/41/01/D146B32E-CA53-41C5-BF6155E0FA6F5FF3/.TJi3fIbHYN.gif-bMJq\n\n\n… …\n\n\n2021-05-17\n13:44:19\n\n\nFile: /private/var/mobile/Library/SMS/Attachments/42/02/45F922B7-E819-4B88-B79A0FEE289701EE/.v74ViRNkCG.gif-V678\n\n\nAmnesty International found no evidence that the 17 May attack was successful. Later attacks on the 18 June and 23 June were successful\nand led to Pegasus payloads being deployed on the device.\n\nInitially, many iMessage (com.apple.madrid) push notifications were received, and attachment chunks were written to disk. The following table\nshow a sample of the 48 attachment files found on the filesystem.\n\n**Date (UTC)** **Event**\n\n\n2021-06-23\n20:45:00\n\n2021-06-23\n20:46:00\n\n2021-06-23\n20:46:19\n\n\n8 push notifications for topic com.apple.madrid (iMessage)\n\n46 push notifications for topic com.apple.madrid (iMessage)\n\nFile: /private/var/tmp/com.apple.messages/F803EEC3-AB3A-4DC2-A5F1-9E39D7A509BB/.cs/ChunkStoreDatabase\n\n\n-----\n\n2021-06-23\n20:46:20\n\n\nFile: /private/var/mobile/Library/SMS/Attachments/77/07/4DFA8939-EE64-4CB5-A111B75733F603A2/.8HfhwBP5qJ.gif-u0zD\n\n\n… …\n\n\n2021-06-23\n20:53:00\n\n2021-06-23\n20:53:54\n\n2021-06-23\n20:53:54\n\n2021-06-23\n20:54:00\n\n\n17 push notifications for topic com.apple.madrid (iMessage)\n\nFile: /private/var/tmp/com.apple.messages/50439EF9-750C-4449-B7FC-851F28BD3BD3/.cs/ChunkStoreDatabase\n\nFile: /private/var/mobile/Library/SMS/Attachments/36/06/AA10C840-1776-4A51-A547BE78A3754773/.7bb9OMWUa8.gif-UAPo\n\n54 push notifications for topic com.apple.madrid (iMessage)\n\n\nA process crash occurred at 20:48:56 which resulted in the ReportCrash process starting followed by restarts of multiple processes related to\niMessage processing:\n\n**Date (UTC)** **Event**\n\n2021-06-23 20:48:56 Process with PID 1192 and name ReportCrash\n\n2021-06-23 20:48:56 Process with PID 1190 and name IMTransferAgent\n\n2021-06-23 20:48:56 Process with PID 1153 and name SCHelper\n\n2021-06-23 20:48:56 Process with PID 1151 and name CategoriesService\n\n2021-06-23 20:48:56 Process with PID 1147 and name MessagesBlastDoorService\n\n2021-06-23 20:48:56 Process with PID 1145 and name NotificationService\n\nA second set of crashes and restarts happened five minutes later. TheReportCrash process was started along with processes related to\nparsing of iMessage content and iMessage custom avatars.\n\n**Date (UTC)** **Event**\n\n2021-06-23 20:54:16 Process with PID 1280 and name ReportCrash\n\n2021-06-23 20:54:16 Process with PID 1278 and name IMTransferAgent\n\n2021-06-23 20:54:16 Process with PID 1266 and name com.apple.WebKit.WebContent\n\n2021-06-23 20:54:16 Process with PID 1263 and name com.apple.accessibility.mediaac\n\n2021-06-23 20:54:16 Process with PID 1262 and name CategoriesService\n\n2021-06-23 20:54:16 Process with PID 1261 and name com.apple.WebKit.Networking\n\n2021-06-23 20:54:16 Process with PID 1239 and name avatarsd\n\nShortly afterwards at 20:54 the exploitation succeeded, and we observe that a network request was made by the com.apple.coretelephony\nprocess causing the Cache.db file to be modified. This matches the behaviour Amnesty International hasseen in the other Pegasus zero-click\nattacks in 2021.\n\n\n-----\n\n**Date (UTC)** **Event**\n\n\n2021-06-23\n20:54:35\n\n2021-06-23\n20:54:35\n\n2021-06-23\n20:54:47\n\n2021-06-23\n20:54:53\n\n2021-06-23\n20:55:08\n\n2021-06-23\n20:55:09\n\n2021-06-23\n20:55:10\n\n2021-06-23\n20:55:10\n\n2021-06-23\n20:59:35\n\n2021-06-23\n20:59:35\n\n\nFile: /private/var/wireless/Library/Caches/com.apple.coretelephony/Cache.db-shm\n\nFile: /private/var/wireless/Library/Caches/com.apple.coretelephony/fsCachedData/3C73213F-73E5-4429-AAD90D7AD9AE83D1\n\nFile: /private/var/root/Library/Caches/appccntd/Cache.db\n\nFile: /private/var/tmp/XtYaXXY\n\nFile: /private/var/tmp/CFNetworkDownload_JQeZFF.tmp\n\nFile: /private/var/tmp/PWg6ueAldsvV8vZ8CYpkp53D\n\nFile: /private/var/db/com.apple.xpc.roleaccountd.staging/otpgrefd\n\nFile: /private/var/tmp/vditcfwheovjf/kk\n\nProcess: appccntd\n\nProcess: otpgrefd\n\n\nLastly, the analysis of a fully patched iPhone 12 running iOS 14.6 of an Indian journalist (CODE INJRN2) also revealed signs of successful\ncompromise. These most recent discoveries indicate NSO Group’s customers are currently able to remotely compromise all recent\n**iPhone models and versions of iOS.**\n\nWe have reported this information to Apple, who informed us they are investigating the matter.[3]\n\n## 7. Incomplete attempts to hide evidence of compromise\n\nSeveral iPhones Amnesty International has inspected indicate that Pegasus has recently started to manipulate system databases and records\non infected devices to hide its traces and and impede the research efforts of Amnesty International and other investigators.\n\nInterestingly, this manipulation becomes evident when verifying the consistency of leftover records in the DataUsage.sqlite and netusage.sqlite\nSQLite databases. Pegasus has deleted the names of malicious processes from the ZPROCESS table in DataUsage database but not the\ncorresponding entries from the ZLIVEUSAGE table. The ZPROCESS table stores rows containing a process ID and the process name. The\nZLIVEUSAGE table contains a row for each running process including data transfer volume and the process ID corresponding to the\nZPROCESS entry. These inconsistencies can be useful in identifying times when infections may have occurred. Additional Pegasus indicators\nof compromise were observed on all devices where this anomaly was observed. No similar inconsistencies were found on any clean iPhones\nanalysed by Amnesty International.\n\nAlthough most recent records are now being deleted from these databases, traces of recent process executions can also be recovered also\nfrom additional diagnostic logs from the system.\n\nFor example, the following records were recovered from the phone of an HRD (CODE RWHRD1):\n\n**Date (UTC)** **Event**\n\n2021-01-31 23:59:02 Process: libtouchregd (PID 7354)\n\n2021-02-21 23:10:09 Process: mptbd (PID 5663)\n\n\n-----\n\n2021-02-21 23:10:09 Process: launchrexd (PID 4634)\n\n2021-03-21 06:06:45 Process: roleaboutd (PID 12645)\n\n2021-03-28 00:36:43 Process: otpgrefd (PID 2786)\n\n2021-04-06 21:29:56 Process: locserviced (PID 5492)\n\n2021-04-23 01:48:56 Process: eventfssd (PID 4276)\n\n2021-04-23 23:01:44 Process: aggregatenotd (PID 1900)\n\n2021-04-28 16:08:40 Process: xpccfd (PID 1218)\n\n2021-06-14 00:17:12 Process: faskeepd (PID 4427)\n\n2021-06-14 00:17:12 Process: lobbrogd (PID 4426)\n\n2021-06-14 00:17:12 Process: neagentd (PID 4423)\n\n2021-06-14 00:17:12 Process: com.apple.rapports.events (PID 4421)\n\n2021-06-18 08:13:35 Process: faskeepd (PID 4427)\n\n2021-06-18 15:31:12 Process: launchrexd (PID 1169)\n\n2021-06-18 15:31:12 Process: frtipd (PID 1168)\n\n2021-06-18 15:31:12 Process: ReminderIntentsUIExtension (PID 1165)\n\n2021-06-23 14:31:39 Process: launchrexd (PID 1169)\n\n2021-06-23 20:59:35 Process: otpgrefd (PID 1301)\n\n2021-06-23 20:59:35 Process: launchafd (PID 1300)\n\n2021-06-23 20:59:35 Process: vm_stats (PID 1294)\n\n2021-06-24 12:24:29 Process: otpgrefd (PID 1301)\n\nSystem log files also reveal the location of Pegasus binaries on disk. These file names match those we have consistently observed in the\nprocess execution logs presented earlier. The binaries are located inside the folder /private/var/db/com.apple.xpc.roleaccountd.staging/\nwhich is [consistent with the findings by Citizen Lab in a December 2020 report.](https://citizenlab.ca/2020/12/the-great-ipwn-journalists-hacked-with-suspected-nso-group-imessage-zero-click-exploit/)\n\n/private/var/db/com.apple.xpc.roleaccountd.staging/launchrexd/EACA3532-7D15-32EE-A88A-96989F9F558A\n\nAmnesty International’s investigations, corroborated by secondary information we have received, seem to suggest that Pegasus is no longer\nmaintaining persistence on iOS devices. Therefore, binary payloads associated with these processes are not recoverable from the non-volatile\nfilesystem. Instead, one would need to be able to jailbreak the device without reboot, and attempt to extract payloads from memory.\n\n## 8. Pegasus processes disguised as iOS system services\n\nAcross the numerous forensic analyses conducted by Amnesty International on devices around the world, we found a consistent set of\nmalicious process names executed on compromised phones. While some processes, for example bh, seem to be unique to a particular attack\nvector, most Pegasus process names seem to be simply disguised to appear as legitimate iOS system processes, perhaps to fool forensic\ninvestigators inspecting logs.\n\n\n-----\n\nSe e a o t ese p ocess a es spoo eg t ate OS b a es\n\n**Pegasus Process Name** **Spoofed iOS Binary**\n\nABSCarryLog ASPCarryLog\n\naggregatenotd aggregated\n\nckkeyrollfd ckkeyrolld\n\ncom.apple.Mappit.SnapshotService com.apple.MapKit.SnapshotService\n\ncom.apple.rapports.events com.apple.rapport.events\n\nCommsCenterRootHelper CommCenterRootHelper\n\nDiagnostic-2543 Diagnostic-2532\n\neventsfssd fseventsd\n\nfmld fmfd\n\nJarvisPluginMgr JarvisPlugin\n\nlaunchafd launchd\n\nMobileSMSd MobileSMS\n\nnehelprd nehelper\n\npcsd com.apple.pcs\n\nPDPDialogs PPPDialogs\n\nReminderIntentsUIExtension RemindersIntentsUIExtension\n\nrlaccountd xpcroleaccountd\n\nroleaccountd xpcroleaccountd\n\n[The list of process names we associate with Pegasus infections is available among all other indicators of compromise on our GitHub page.](https://github.com/AmnestyTech/investigations)\n\n## 9. Unravelling the Pegasus attack infrastructure over the years\n\nThe set of domain names, servers and infrastructure used to deliver and collect data from NSO Group’s Pegasus spyware has evolved several\ntimes since first publicly disclosed by Citizen Lab in 2016.\n\n[In August 2018, Amnesty International published a report “Amnesty International Among Targets of NSO-powered Campaign“ which described](https://www.amnesty.org/en/latest/research/2018/08/amnesty-international-among-targets-of-nso-powered-campaign/)\nthe targeting of an Amnesty International staff member and a Saudi human rights defender. In this report, Amnesty International presented an\n[excerpt of more than 600 domain names tied to NSO Group’s attack infrastructure. Amnesty International published the full list of domains in](https://github.com/AmnestyTech/investigations/blob/master/2018-08-01_nso/indicators.csv)\nOctober 2018. In this report, we refer to these domains as Pegasus network Version 3 (V3).\n\nThe Version 3 infrastructure used a network of VPS’s and dedicated servers. Each Pegasus Installation server or Command-and-Control\n(C&C) server hosted a web server on port 443 with a unique domain and TLS certificate. These edge servers would then proxy connections\nthrough a chain of servers, referred to by NSO Group as the “Pegasus Anonymizing Transmission Network” (PATN).\n\n\n-----\n\nt as poss b e to c eate a pa o ge p ts o t e d st ct e set o S c p e su tes suppo ted by t ese se e s e ge p t tec que\n[is conceptually similar to the JA3S fingerprint technique published by Salesforce in 2019. With that fingerprint, Amnesty International’s Security](https://engineering.salesforce.com/tls-fingerprinting-with-ja3-and-ja3s-247362855967?gi=f49f869acaa2)\nLab performed Internet-wide scans to identify Pegasus Installation/infection and C&C servers active in the summer of 2018.\n\nNSO Group made critical operational security mistakes when setting up their Version 3 infrastructure. Two domains of the previous Version 2\nnetwork were reused in their Version 3 network. These two Version 2 domains, pine-sales[.]com and ecommerce-ads[.]org had previously\nbeen identified by Citizen Lab. These mistakes allowed Amnesty International to link the attempted attack on our colleague to NSO Group’s\n[Pegasus product. These links were independently confirmed by Citizen Lab in a 2018 report.](https://citizenlab.ca/2018/07/nso-spyware-targeting-amnesty-international/)\n\nNSO Group rapidly shutdown many of their Version 3 servers shortly after the Amnesty International and Citizen Lab’s publications on 1\nAugust 2018.\n\nAmnesty International\n\n## 9.1 Further attempts by NSO Group to hide their infrastructure\n\nIn August 2019, the Amnesty International identified another case of NSO Group’s tools being used to target a human rights defender, this time\n[in Morocco. Maati Monjib was targeted with SMS messages containing Version 3 Pegasus links.](https://www.amnesty.org/en/latest/research/2019/10/morocco-human-rights-defenders-targeted-with-nso-groups-spyware/)\n\nAmnesty performed a forensic analysis of his iPhone as described previously. This forensic analysis showed redirects to a new domain name\n**free247downloads.com. These links looked suspiciously similar to infection links previously used by NSO.**\n\nAmnesty International confirmed this domain was tied to NSO Group by observing distinctive Pegasus artefacts created on the device shortly\nafter the infection URL was opened. With this new domain in hand, we were able to begin mapping the Pegasus Version 4 (V4) infrastructure.\n\nNSO Group re-factored their infrastructure to introduce additional layers, which complicated discovery. Nevertheless, we could now observe at\nleast 4 servers used in each infection chain.\n\n**Validation domain: https://baramije[.]net/[ALPHANUMERIC STRING]**\n\n**Exploit domain:   https://[REDACTED].info8fvhgl3.urlpush[.]net:30827/[SAME ALPHANUMERIC STRING]**\n\n1. A validation server: The first step was a website which we have seen hosted on shared hosting providers. Frequently this website was\n\nrunning a random and sometimes obscure PHP application or CMS. Amnesty International believes this was an effort to make the\ndomains look less distinguishable.\n\nThe validation server would check the incoming request. If a request had a valid and still active URL the validation server would redirect\nthe victim to the newly generated exploit server domain. If the URL or device was not valid it would redirect to a legitimate decoy website.\nAny passer-by or Internet crawler would only see the decoy PHP CMS.\n\n2. Infection DNS server: NSO now appears to be using a unique subdomain for every exploit attempt. Each subdomain was generated\n\nand only active for a short period of time. This prevented researchers from finding the location of the exploit server based on historic\ndevice logs.\n\nTo dynamically resolve these subdomains NSO Group ran a custom DNS server under a subdomain for every infection domain. It also\nobtained a wildcard TLS certificate which would be valid for each generated subdomain such\nas *.info8fvhgl3.urlpush[.]net or *.get1tn0w.free247downloads[.]com.\n\n\n-----\n\n3 **egasus** **sta at o** **Se** **e** o se e t e actua ect o pay oad SO G oup eeds to u a eb se e so e e e o t e te et\nAgain, NSO Group took steps to avoid internet scanning by running the web server on a random high port number.\n\nWe assume that each infection webserver is part of the new generation “Pegasus Anonymizing Transmission Network”. Connections\nto the infection server are likely proxied back to the customer’s Pegasus infrastructure.\n4. Command and Control server: In previous generations of the PATN, NSO Group used separate domains for the initial infection and\n\n[later communication with the spyware. The iPwn report from Citizen Lab provided evidence that Pegasus is again using separate](https://citizenlab.ca/2020/12/the-great-ipwn-journalists-hacked-with-suspected-nso-group-imessage-zero-click-exploit/)\ndomains for command and control. To avoid network-based discovery, the Pegasus spyware made direct connections the Pegasus C&C\nservers without first performing a DNS lookup or sending the domain name in the TLS SNI field.\n\n## 9.2 Identifying other NSO attack domains\n\nAmnesty International began by analysing the configuration of the infection domains and DNS servers used in the attacks against Moroccan\njournalists and human rights defenders.\n\nBased on our knowledge of the domains used in Morocco we developed a fingerprint which identified 201 Pegasus Installation domains which\nhad infrastructure active at the time of the initial scan. This set of 201 domains included both urlpush[.]net and free247downloads[.]com.\n\nAmnesty International identified an additional 500 domains with subsequent network scanning and by clustering patterns of domain\nregistration, TLS certificate issuance and domain composition which matched the initial set of 201 domains.\n\nAmnesty International believes that this represents a significant portion of the Version 4 NSO Group attack infrastructure. We are publishing\nthese 700 domains today. We recommend the civil society and media organisations check their network telemetry and/or DNS logs for traces\nof these indicators of compromise.\n\n## 9.3 What can be learned from NSO Group’s infrastructure\n\nThe following chart shows the evolution of NSO Group Pegasus infrastructure over a 4-year period from 2016 until mid-2021. Much of\nthe Version 3 infrastructure was abruptly shut down in August 2018 following our report on an Amnesty International staff member targeted\nwith Pegasus. The Version 4 infrastructure was then gradually rolled out beginning in September and October 2018.\n\nA significant number of new domains were registered in November 2019 shortly after WhatsApp notified their users about alleged targeting\nwith Pegasus. This may reflect NSO rotating domains due to perceived risk of discovery, or because of disruption to their existing hosting\ninfrastructure.\n\n[The V4 DNS server infrastructure began going offline in early 2021 following the Citizen Lab iPwn report which disclosed multiple Pegasus V4](https://citizenlab.ca/2020/12/the-great-ipwn-journalists-hacked-with-suspected-nso-group-imessage-zero-click-exploit/)\ndomains.\n\nAmnesty International suspects the shutting down of the V4 infrastructure coincided with NSO Group’s shift to using cloud services such as\nAmazon CloudFront to deliver the earlier stages of their attacks. The use of cloud services protects NSO Group from some Internet scanning\ntechniques.\n\n## 9.4 Attack infrastructure hosted primarily in Europe and North America\n\nNSO Group’s Pegasus infrastructure primarily consists of servers hosted at datacentres located in European countries. The countries hosting\nthe most infection domain DNS servers included Germany, the United Kingdom, Switzerland, France, and the United States (US).\n\n**Country** **Servers per country**\n\nGermany 212\n\nUnited Kingdom 79\n\n\n-----\n\nSwitzerland 36\n\nFrance 35\n\nUnited States 28\n\nFinland 9\n\nNetherlands 5\n\nCanada 4\n\nUkraine 4\n\nSingapore 3\n\nIndia 3\n\nAustria 3\n\nJapan 1\n\nBulgaria 1\n\nLithuania 1\n\nBahrain 1\n\nThe following table shows the number of DNS servers hosted with each hosting provider. Most identified servers are assigned to the USowned hosting companies Digital Ocean, Linode and Amazon Web Services (AWS).\n\nMany hosting providers offer server hosting in multiple physical locations. Based on these two tables it appears that NSO Group is primarily\nusing the European datacentres run by American hosting companies to run much of the attack infrastructure for its customers.\n\n**Network** **Servers per network**\n\nDIGITALOCEAN-ASN 142\n\nLinode, LLC 114\n\nAMAZON-02 73\n\nAkenes SA 60\n\nUpCloud Ltd 9\n\nChoopa 7\n\nOVH SAS 6\n\nVirtual Systems LLC 2\n\nASN-QUADRANET-GLOBAL 1\n\ncombahton GmbH 1\n\nUAB Rakrejus 1\n\nHZ Hosting Ltd 1\n\nPE Brezhnev Daniil 1\n\nNeterra Ltd. 1\n\nKyiv Optic Networks Ltd 1\n\nAmnesty International’s research identified 28 DNS servers linked to the infection infrastructure which were hosted in the US.\n\n**Domain name** **DNS server IP** **Network**\n\ndrp32k77.todoinfonet.com 104.223.76.216 ASN-QUADRANET-GLOBAL\n\nimgi64kf5so6k.transferlights.com 165.227.52.184 DIGITALOCEAN-ASN\n\npc43v65k.alignmentdisabled.net 167.172.215.114 DIGITALOCEAN-ASN\n\nimg54fsd3267h.prioritytrail.net 157.245.228.71 DIGITALOCEAN-ASN\n\n\n-----\n\njsfk3d43.netvisualizer.com 104.248.126.210 DIGITALOCEAN-ASN\n\ncdn42js666.manydnsnow.com 138.197.223.170 DIGITALOCEAN-ASN\n\ncss1833iv.handcraftedformat.com 134.209.172.164 DIGITALOCEAN-ASN\n\njs43fsf7v.opera-van.com 159.203.87.42 DIGITALOCEAN-ASN\n\npypip36z19.myfundsdns.com 167.99.105.68 DIGITALOCEAN-ASN\n\ncss912jy6.reception-desk.net 68.183.105.242 DIGITALOCEAN-ASN\n\nimgi64kf5so6k.transferlights.com 206.189.214.74 DIGITALOCEAN-ASN\n\njs85mail.preferenceviews.com 142.93.80.134 DIGITALOCEAN-ASN\n\ncss3218i.quota-reader.net 165.227.17.53 DIGITALOCEAN-ASN\n\nmongo87a.sweet-water.org 142.93.113.166 DIGITALOCEAN-ASN\n\nreact12x2.towebsite.net 3.13.132.96 AMAZON-02\n\njsb8dmc5z4.gettingurl.com 13.59.79.240 AMAZON-02\n\nreact12x2.towebsite.net 3.16.75.157 AMAZON-02\n\ncssgahs5j.redirigir.net 18.217.13.50 AMAZON-02\n\njsm3zsn5kewlmk9q.dns-analytics.com 18.225.12.72 AMAZON-02\n\nimgcss35d.domain-routing.com 13.58.85.100 AMAZON-02\n\njsb8dmc5z4.gettingurl.com 18.191.63.125 AMAZON-02\n\njs9dj1xzc8d.beanbounce.net 199.247.15.15 CHOOPA\n\njsid76api.buildyourdata.com 108.61.158.97 CHOOPA\n\ncdn19be2.reloadinput.com 95.179.177.18 CHOOPA\n\nsrva9awf.syncingprocess.com 66.175.211.107 Linode\n\njsfk3d43.netvisualizer.com 172.105.148.64 Linode\n\nimgdsg4f35.permalinking.com 23.239.16.143 Linode\n\nsrva9awf.syncingprocess.com 45.79.190.38 Linode\n\n## 9.5 Infection domain resolutions observed in Passive DNS database\n\nBased on forensic analysis of compromised devices, Amnesty International determined that NSO Group was using a unique and randomly\ngenerated subdomain for each attempt to deliver the Pegasus spyware.\n\nAmnesty International searched passive DNS datasets for each of the Pegasus Version 4 domains we have identified. Passive DNS databases\nrecord historic DNS resolution for a domain and often included subdomains and the corresponding historic IP address.\n\nA subdomain will only be recorded in passive DNS records if the subdomain was successfully resolved and the resolution transited a network\nwhich was running a passive DNS probe.\n\nThis probe data is collected based on agreements between network operators and passive DNS data providers. Many networks will not be\ncovered by such data collection agreements. For example, no passive DNS resolutions were recorded for either Pegasus infection domains\nused in Morocco.\n\n**As such, these resolutions represent only a small subset of overall NSO Group Pegasus activity.**\n\n**Infection domain** **Unique infection subdomains**\n\nmongo77usr.urlredirect.net 417\n\nstr1089.mailappzone.com 410\n\napiweb248.theappanalytics.com 391\n\ndist564.htmlstats.net 245\n\ncss235gr.apigraphs.net 147\n\n\n-----\n\nnodesj44s.unusualneighbor.com 38\n\njsonapi2.linksnew.info 30\n\nimg9fo658tlsuh.securisurf.com 19\n\npc25f01dw.loading-url.net 12\n\ndbm4kl5d3faqlk6.healthyguess.com 8\n\nimg359axw1z.reload-url.net 5\n\ncss2307.cssgraphics.net 5\n\ninfo2638dg43.newip-info.com 3\n\nimg87xp8m.catbrushcable.com 2\n\nimg108jkn42.av-scanner.com 2\n\nmongom5sxk8fr6.extractsight.com 2\n\nimg776cg3.webprotector.co 1\n\ntv54d2ml1.topadblocker.net 1\n\ndrp2j4sdi.safecrusade.com 1\n\napi1r3f4.redirectweburl.com 1\n\npc41g20bm.redirectconnection.net 1\n\njsj8sd9nf.randomlane.net 1\n\nphp78mp9v.opposedarrangement.net 1\n\nThe domain urlredirect.net had the highest number of observed unique subdomains. In total 417 resolutions were recorded between 4\nOctober 2018, and 17 September 2019. The second highest was mailappzone.com which has 410 resolutions in a 3-month period between\n23 July 2020, and 15 October 2020.\n\nAmnesty International believes that each of these subdomain resolutions, 1748 in total, represent an attempt to compromise a device with\nPegasus. These 23 domains represent less than 7% of the 379 Pegasus Installation Server domains we have identified. Based on this small\nsubset, Pegasus may have been used in thousands of attacks over the past three years.\n\n## 10. Mobile devices, security and auditability\n\nMuch of the targeting outlined in this report involves Pegasus attacks targeting iOS devices. It is important to note that this does not\nnecessarily reflect the relative security of iOS devices compared to Android devices, or other operating systems and phone manufacturers.\n\nIn Amnesty International’s experience there are significantly more forensic traces accessible to investigators on Apple iOS devices than on\nstock Android devices, therefore our methodology is focused on the former. As a result, most recent cases of confirmed Pegasus infections\nhave involved iPhones.\n\nThis and all previous investigations demonstrate how attacks against mobile devices are a significant threat to civil society globally. The\ndifficulty to not only prevent, but posthumously detect attacks is the result of an unsustainable asymmetry between the capabilities readily\navailable to attackers and the inadequate protections that individuals at risk enjoy.\n\nWhile iOS devices provide at least some useful diagnostics, historical records are scarce and easily tampered with. Other devices provide little\nto no help conducting consensual forensics analysis. Although much can be done to improve the security posture of mobile devices and\nmitigate the risks of attacks such as those documented in this report, even more could be achieved by improving the ability for device owners\nand technical experts to perform regular checks of the system’s integrity.\n\nTherefore, Amnesty International strongly encourages device vendors to explore options to make their devices more auditable, without of\ncourse sacrificing any security and privacy protections already in place. Platform developers and phone manufacturers should regularly\nengage in conversations with civil society to better understand the challenges faced by HRDs, who are often under-represented in\ncybersecurity debates.\n\n## 11. With our Methodology, we release our tools and indicators\n\nFor a long time, triaging the state of a suspected compromised mobile device has been considered a near-impossible task, particularly within\nthe human rights communities we work in. Through the work of Amnesty International’s Security Lab we have built important capabilities that\nmay benefit our peers and colleagues supporting activists, journalists, and lawyers who are at risk.\n\n\n-----\n\ne e o e, t oug t s epo t, **e a e** **ot o** **y s a** **g t e** **et odo ogy** **e** **a e bu t o e yea s o** **esea c** **but a so t e too s** **e**\n**created to facilitate this work, as well as the Pegasus indicators of compromise we have collected.**\n\n[All indicators of compromise are available on our GitHub, including domain names of Pegasus infrastructure, email addresses recovered from](https://github.com/AmnestyTech/investigations/tree/master/2021-07-18_nso)\niMessage account lookups involved in the attacks, and all process names Amnesty International has identified as associated with Pegasus.\n\n[Amnesty International is also releasing a tool we have created, called Mobile Verification Toolkit (MVT). MVT is a modular tool that simplifies](https://github.com/mvt-project/mvt)\nthe process of acquiring and analysing data from Android devices, and the analysis of records from iOS backups and filesystem dumps,\nspecifically to identify potential traces of compromise.\n\n[MVT can be provided with indicators of compromise in STIX2 format and will identify any matching indicators found on the device. In](https://oasis-open.github.io/cti-documentation/stix/intro.html)\nconjunction with Pegasus indicators, MVT can help identify if an iPhone have been compromised.\n\nAmong others, some of the features MVT has include:\n\nDecrypt encrypted iOS backups.\nProcess and parse records from numerous iOS system and apps databases and system logs.\nExtract installed applications from Android devices.\nExtract diagnostic information from Android devices through the adb protocol.\nCompare extracted records to a provided list of malicious indicators in STIX2 format. Automatically identify malicious SMS messages,\nvisited websites, malicious processes, and more.\nGenerate JSON logs of extracted records, and separate JSON logs of all detected malicious traces.\nGenerate a unified chronological timeline of extracted records, along with a timeline all detected malicious traces.\n\n## Acknowledgements\n\nThe Amnesty International Security Lab wishes to acknowledge all those who have supported this research. Tools released by the iOS security\nresearch community including libimobiledevice and checkra1n were used extensively as part of this research. We would also like to thank\nCensys and RiskIQ for providing access to their internet scan and passive DNS data.\n\nAmnesty International wishes to acknowledge Citizen Lab for its important and extensive research on NSO Group and other actors\n[contributing to the unlawful surveillance of civil society. Amnesty International thanks Citizen Lab for its peer-review of this research report.](https://citizenlab.ca/2021/07/amnesty-peer-review/)\n\nFinally Amnesty International wishes to thank the numerous journalists and human rights defenders who bravely collaborated to make this\nresearch possible.\n\n## Appendix A: Peer review of Methodology Report by Citizen Lab\n\nThe Citizen Lab at the University of Toronto has independently peer-reviewed a draft of the forensic methodology outlined in this report. Their\n[review can be found here.](https://citizenlab.ca/2021/07/amnesty-peer-review/)\n\n## Appendix B: Suspicious iCloud Account Lookups\n\nThis Appendix shows the overlap of iCloud accounts found looked-up on the mobile devices of different targets. This list will be progressively\nupdated.\n\n**iCloud Account** **Target**\n\nemmaholm575[@]gmail.com -    AZJRN1 – Khadija Ismayilova\n\nfilip.bl82[@]gmail.com -    AZJRN1 – Khadija Ismayilova\n\nkleinleon1987[@]gmail.com -    AZJRN1 – Khadija Ismayilova\n\n\n-----\n\nbergers.o79[@]gmail.com -    Omar Radi\n\n                  -    FRHRL1 – Joseph Breham\n\n                    -    FRHRL2\n\n                   -    FRJRN1 – Lenaig Bredoux\n\n                    -    FRJRN2\n\n                    -    FRPOI1\n\n                   -    FRPOI2 – François de Rugy\n\nnaomiwerff772[@]gmail.com -    Omar Radi\n\n                  -    FRHRL1 – Joseph Breham\n\n                    -    FRPOI1\n\nbogaardlisa803[@]gmail.com -    FRHRL1 – Joseph Breham\n\n                   -    FRJRN1 – Lenaig Bredoux\n\n                    -    FRJRN2\n\nlinakeller2203[@]gmail.com -    FRHRD1 – Claude Mangin\n\n                   -    FRPOI3 – Philippe Bouyssou\n\n                    -    FRPOI4\n\n                   -    FRPOI5 – Oubi Buchraya Bachir\n\n                  -    MOJRN1 – Hicham Mansouri\n\njessicadavies1345[@]outlook.com -    HUJRN1 – András Szabó\n\n                   -    HUJRN2 – Szabolcs Panyi\n\nemmadavies8266[@]gmail.com -    HUJRN1 – András Szabó\n\n                   -    HUJRN2 – Szabolcs Panyi\n\nk.williams.enny74[@]gmail.com -    HUPOI1\n\n                   -    HUPOI2 – Adrien Beauduin\n\n                    -    HUPOI3\n\ntaylorjade0303[@]gmail.com -    INHRD1 – SAR Geelani\n\n                   -    INJRN6 – Smita Sharma\n\n                    -    INPOI1 – Prashant Kishor\n\nlee.85.holland[@]gmail.com -    INHRD1 – SAR Geelani\n\n                   -    INJRN6 – Smita Sharma\n\n                    -    INPOI1 – Prashant Kishor\n\nbekkerfredi[@]gmail.com -    INHRD1 – SAR Geelani\n\n                      -    INPOI2\n\nherbruud2[@]gmail.com -    INJRN1 – Mangalam Kesavan Venu\n\n                   -    INJRN2 – Sushant Singh\n\n                    -    INPOI1 – Prashant Kishor\n\nvincent.dahl76[@]gmail.com -    KASH01 – Hatice Cengiz\n\n                  -    KASH02 – Rodney Dixon\n\noskarschalcher[@]outlook.com -    KASH03 – Wadah Khanfar\n\nbenjiburns8[@]gmail.com -    RWHRD1 – Carine Kanimba\n\n## Appendix C: Detailed Traces per Target\n\nThis Appendix contains detailed breakdowns of forensic traces recovered for each target. This Appendix will be progressively updated.\n\n### C.1 Forensic Traces Overview for Maati Monjib\n\n\n**Date**\n**(UTC)**\n\n2017-1102\n12:29:33\n\n2017-1102\n16:42:34\n\n2017-1102\n16:44:00\n\n\n**Event**\n\nPegasus SMS with link to hxxps://tinyurl[.]com/y73qr7mb redirecting to hxxps://revolution-news[.]co/ikXFZ34ca\n\nPegasus SMS with link to hxxps://stopsms[.]biz/vi78ELI\n\nPegasus SMS with link to hxxps://stopsms[.]biz/vi78ELI from +212766090491\n\n\n-----\n\n2017-1102\n16:45:10\n\n2017-1102\n16:57:00\n\n2017-1102\n17:13:45\n\n2017-1102\n17:21:57\n\n2017-1102\n17:30:49\n\n2017-1102\n17:40:46\n\n2017-1115\n17:05:17\n\n2017-1120\n18:22:03\n\n2017-1124\n13:43:17\n\n2017-1124\n17:26:09\n\n2017-1127\n15:56:10\n\n2017-1127\n17:32:37\n\n201712-07\n18:21:57\n\n201801-08\n12:58:14\n\n201802-09\n21:12:49\n\n201803-16\n08:24:20\n\n201804-28\n22:25:12\n\n201805-04\n21:30:45\n\n201805-21\n21:46:06\n\n\nPegasus SMS with link to Hxxps://stopsms[.]biz/bi78ELI from +212766090491\n\nPegasus SMS with link to Hxxps://stopsms[.]biz/bi78ELI from +212766090491\n\nPegasus SMS with link to Hxxps://stopsms[.]biz/bi78ELI from +212766090491\n\nPegasus SMS with link to Hxxps://stopsms[.]biz/bi78ELI from +212766090491\n\nPegasus SMS with link to Hxxps://stopsms[.]biz/bi78ELI from +212766090491\n\nPegasus SMS with link to Hxxps://stopsms[.]biz/bi78ELI from +212766090491\n\nPegasus SMS with link to hxxps://videosdownload[.]co/nBBJBIP\n\nPegasus SMS with link to hxxps://infospress[.]com/LqoHgMCEE\n\nPegasus SMS with link to hxxps://tinyurl[.]com/y9hbdqm5 redirecting to hxxps://hmizat[.]co/JaCTkfEp\n\nPegasus SMS with link to hxxps://stopsms[.]biz/2Kj2ik6\n\nPegasus SMS with link to hxxps://stopsms[.]biz/yTnWt1Ct\n\nPegasus SMS with link to hxxps://hmizat[.]co/ronEKDVaf\n\nPegasus SMS with link to hxxp://tinyurl[.]com/y7wdcd8z redirecting to hxxps://infospress[.]com/Ln3HYK4C\n\nPegasus SMS with link to hxxp://tinyurl[.]com/y87hnl3o redirecting to hxxps://infospress[.]com/asjmXqiS\n\nProcess: pcsd\n\nProcess: pcsd\n\nProcess: bh\n\nProcess: pcsd\n\nProcess: fmld\n\n\n-----\n\n201805-22\n17:36:51\n\n201806-04\n11:05:43\n\n201903-27\n21:45:10\n\n201904-14\n23:02:41\n\n201906-27\n20:13:10\n\n201907-22\n15:42:32\n\n2019-07\n22\n15:42:32\n\n201907-22\n15:43:06\n\n\nProcess: bh\n\nProcess: fmld\n\nProcess: bh\n\nSafari favicon from URL hxxps://c7r8x8f6zecd8j.get1tn0w.free247downloads[.]com:30352/Ld3xuuW5\n\nSafari favicon from URL\nhxxps://3hdxu4446c49s.get1tn0w.free247downloads[.]com:30497/pczrccr#0520458712028268373373081847500232386308468830\n\nSafari visit to hxxps://bun54l2b67.get1tn0w.free247downloads[.]com:30495/szev4hz\n\nSafari visit to\nhxxps://bun54l2b67.get1tn0w.free247downloads[.]com:30495/szev4hz#048634787343287485982474853012724998054718494423\n\nSafari favicon from URL\nhxxps://bun54l2b67.get1tn0w.free247downloads[.]com:30495/szev4hz#048634787343287485982474853012724998054718494423\n\n\nn/a WebKit IndexedDB file for URL hxxps://c7r8x8f6zecd8j.get1tn0w.free247downloads[.]com\n\nn/a WebKit IndexedDB file for URL hxxps://bun54l2b67.get1tn0w.free247downloads[.]com\n\nn/a WebKit IndexedDB file for URL hxxps://keewrq9z.get1tn0w.free247downloads[.]com\n\nn/a WebKit IndexedDB file for URL hxxps://3hdxu4446c49s.get1tn0w.free247downloads[.]com\n\n### C.2 Forensic Traces Overview for Omar Radi\n\n\n**Date**\n**(UTC)**\n\n201902-11\n14:45:45\n\n201902-11\n13:45:53\n\n201902-11\n13:45:56\n\n201902-11\n13:46:16\n\n201902-11\n13:46:23\n\n201902-11\n16:05:24\n\n201908-16\n17:41:06\n\n201909-13\n15:01:38\n\n\n**Event**\n\nWebkit IndexedDB file for URL hxxps://d9z3sz93x5ueidq3.get1tn0w.free247downloads[.]com\n\nSafari favicon from URL hxxps://d9z3sz93x5ueidq3.get1tn0w.free247downloads[.]com:30897/rdEN5YP\n\nProcess: bh\n\nProcess: roleaboutd\n\nProcess: roleaboutd\n\nProcess: roleaboutd\n\niMessage lookup for account bergers.o79[@]gmail.com\n\nSafari favicon for URL\nhxxps://2far1v4lv8.get1tn0w.free247downloads[.]com:31052/meunsnyse#01135657025711729683484570402233897313302243339\n\n\n-----\n\n201909-13\n15:01:56\n\n201909-13\n15:02:11\n\n201909-13\n15:02:20\n\n201909-13\n15:02:33\n\n201909-14\n15:02:57\n\n201909-14\n18:51:54\n\n201910-29\n12:21:18\n\n202001-27\n10:06:24\n\n202001-27\n10:06:26\n\n202001-27\n10:06:26\n\n202001-27\n10:06:32\n\n\nSafari favicon for URL\nhxxps://2far1v4lv8.get1tn0w.free247downloads[.]com:31052/meunsnyse#06809956161462627851992535863878916157242783364\n\nProcess: bh\n\nProcess: msgacntd\n\nProcess: msgacntd\n\nProcess: msgacntd\n\nProcess: msgacntd\n\niMessage lookup for account naomiwerff772[@]gmail.com\n\nSafari favicon for URL\nhxxps://gnyjv1xltx.info8fvhgl3.urlpush[.]net:30875/zrnv5revj#074196419827987919274001548622738919835556748325946\n\nSafari visit to\nhxxps://gnyjv1xltx.info8fvhgl3.urlpush[.]net:30875/zrnv5revj#074196419827987919274001548622738919835556748325946#2\n\nSafari visit to\nhxxps://gnyjv1xltx.info8fvhgl3.urlpush[.]net:30875/zrnv5revj#074196419827987919274001548622738919835556748325946#24\n\nSafari favicon for URL\nhxxps://gnyjv1xltx.info8fvhgl3.urlpush[.]net:30875/zrnv5revj#074196419827987919274001548622738919835556748325946%2324\n\n\n## Appendix D: Pegasus Forensic Traces per Target\n\n[Appendix D can be found here.](https://www.amnesty.org/en/latest/research/2021/07/forensic-methodology-report-appendix-d/)\n\n[[1] The technical evidence provided in the report includes the forensic research carried out as part of the Pegasus Project as well as additional](https://www.amnesty.org/en/latest/research/2021/07/forensic-methodology-report-how-to-catch-nso-groups-pegasus/#_ftnref1)\nAmnesty International Security Lab research carried out since the establishment of the Security Lab in 2018.\n\n[[2] Email to Amnesty International, May 2021](https://www.amnesty.org/en/latest/research/2021/07/forensic-methodology-report-how-to-catch-nso-groups-pegasus/#_ftnref1)\n\n[[3] Email to Amnesty International, July 2021.](https://www.amnesty.org/en/latest/research/2021/07/forensic-methodology-report-how-to-catch-nso-groups-pegasus/#_ftnref1)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-18 - Forensic Methodology Report- How to catch NSO Group’s Pegasus.pdf"
    ],
    "report_names": [
        "2021-07-18 - Forensic Methodology Report- How to catch NSO Group’s Pegasus.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536082,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1653708055,
    "ts_modification_date": 1653708055,
    "files": {
        "pdf": "https://archive.orkl.eu/f0545987983e08fa48843f953216c23f6962ce55.pdf",
        "text": "https://archive.orkl.eu/f0545987983e08fa48843f953216c23f6962ce55.txt",
        "img": "https://archive.orkl.eu/f0545987983e08fa48843f953216c23f6962ce55.jpg"
    }
}