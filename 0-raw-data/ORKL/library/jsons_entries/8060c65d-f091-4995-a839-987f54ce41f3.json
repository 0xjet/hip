{
    "id": "8060c65d-f091-4995-a839-987f54ce41f3",
    "created_at": "2023-01-12T15:07:55.403104Z",
    "updated_at": "2025-03-27T02:17:11.353461Z",
    "deleted_at": null,
    "sha1_hash": "d0cad6ed159b9fa9fb718fc0651354a8948667b7",
    "title": "2018-05-31 - APT28 Rollercoaster- The Lowdown on Hijacked Lo",
    "authors": "",
    "file_creation_date": "2022-05-29T01:26:56Z",
    "file_modification_date": "2022-05-29T01:26:56Z",
    "file_size": 646928,
    "plain_text": "# APT28 Rollercoaster: The Lowdown on Hijacked LoJack\n\n**[lastline.com/labsblog/apt28-rollercoaster-the-lowdown-on-hijacked-lojack/](https://www.lastline.com/labsblog/apt28-rollercoaster-the-lowdown-on-hijacked-lojack/)**\n\nMay 31, 2018\n\nPosted by [David Wells,](https://www.lastline.com/author/dwells/) [Stefano Ortolani and](https://www.lastline.com/author/stefano/) [Luukas Larinkoski ON MAY 31, 2018](https://www.lastline.com/author/luukas/)\n[Recently, the ASERT team at Arbor Networks, published a report on an old version of the Absolute Software](https://asert.arbornetworks.com/lojack-becomes-a-double-agent/)\nproduct, [Absolute LoJack for laptops, being illicitly modified by suspected APT28 actors. The LoJack implant,](https://www.absolute.com/en/resources/faq/absolute-response-to-arbor-lojack-research)\npreviously known as Computrace and brought into the spotlight in 2014 at Black Hat USA because it was\n[enabled on some brand new laptops, is an anti-theft technology used in modern laptops to allow remote](https://www.blackhat.com/docs/us-14/materials/us-14-Kamluk-Computrace-Backdoor-Revisited-WP.pdf)\ntracing, data deletion, and system lockdown.\n\nBased on information from a number of reports, ASERT estimates with moderate confidence that the APT28\ngroup, also known as Fancy Bear, has maliciously modified and deployed Absolute LoJack samples to support\nits own campaigns against government and defense-related contractors. (See the advice from Absolute\nSoftware regarding these modified samples.) As sophisticated implants often reveal non-trivial dynamic\nbehaviors, we began an investigation process to analyze this threat in more detail.\n\n## A New Sample\n\nFrom the IOCs in the ASERT report, we hunted through our knowledge base for additional samples using the\nsearch query below:\n```\ncode_hash: '21B04C7DF33277B9927D0D3E3ADC545D' AND user_agent: 'Mozilla/4.0 (compatible;\n\n```\n\n-----\n\n```\nMSIE 6.0;) AND NOT domain: search.namequery.com\n\n```\nThe code hash search term allowed us to query for all LoJack implants. We filtered on user agent while\nremoving the resolved domain used by all legitimate implants. The search uncovered a new and previously\nunmentioned sample, below (see Figure 1 for the analysis overview):\n```\nSHA1: 09d2e2c26247a4a908952fee36b56b360561984f\nCompilation time: 2008-04-01 19:35:07\nC&C server: webstp[.]com\n\n```\nThis new sample was detected for the first time in the second half of 2017, the sample relies on a previously\nunknown C&C server: the webstp[.]com domain originally resolved to the IP address 185.94.191[.]65, but was\nlater sinkholed at sinkhole.tigersecurity.pro via 91.134.203[.]113 and later 54.36.134[.]247.\n\nFigure 1: Analysis overview of the newly discovered hijacked LoJack sample.\n\nOur investigation started by focusing on that specific domain and IP association. While we had no reputation\ninformation related to the IP 185.94.191[.]65, whois historical data showed that webstp[.]com had been\nregistered on August 11, 2017 with the hosting company ititch[.]com (Figure 2).\n\n\n-----\n\nFigure 2: Registration details for webstp.com before sinkholing (from whoxy.com).\n\nIn their own words:\n\n“IT Itch is different. We’re all about helping people, businesses and activist groups keep their digital\nidentity anonymous, their online data private and their websites always online. We’re doing this by\nactively ignoring and impeding digital data requests and take-down notices, and we’re pretty good at it –\nwe have a 100% non-compliance rate. We’re also helping domain name owners and website operators\nunderstand more about data privacy protection, and offering products and services designed to keep your\nidentity secret, such as anonymous web hosting and private domain registration.”\n\nWhether intentionally or not, this desire to support internet freedoms has attracted cyberthreat actors because\nof the operational anonymity and bulletproof infrastructure.\n\n## The Fallback Revelation\n\nDuring our investigation, we decided to verify whether we could detect other hijacked LoJack samples being\nused in the wild. As the traffic from hijacked agents is otherwise indistinguishable from legitimate agents, we\ndeployed a network signature to monitor HTTP traffic with the same distinct User-Agent header, but connecting\nto other (non-legitimate) domains. Unfortunately, this approach quickly proved to be prone to false positives; in\nparticular, in a small number of legitimate LoJack interactions, the contacted host of the HTTP request was a\nplain IP address instead of a domain name (see Figure 3).\n\n\n-----\n\nFigure 3: A legitimate LoJack network interaction using the IP address as contacted hostname.\n\nThe fact that a legitimate sample was including this fallback mechanism led us to wonder whether the malicious\nbinary was doing the same. As Figure 4 shows, that was indeed the case: it turns out Computrace samples\nembed both a XORed IP address as well as a XORed domain. The XORed IP address is used as a backup\ncommunication channel when domain callout fails (the logic can be seen in Figure 5).\n\nFigure 4: The XORed IP and domain name.\n\n\n-----\n\nFigure 5: The logic used to decide when to fallback to an IP address.\n\nWe also checked all other hijacked LoJack implants, and in all cases, the binary included a fallback IP, meaning\nthat in all cases the implant would have been able to connect to the C&C regardless of whether the domain had\nbeen sinkholed or blacklisted. Only in two cases, the fallback IP address did not match the address pointed to\nby the domain. Table 1 shows detailed network IOCs for all known hijacked LoJack samples.\n\n\n**Sample SHA1** **Domain** **Original**\n**resolving IP**\n\n\n**Fallback IP**\n\n\n1470995de2278ae79646d524e7c311dad29aee17 sysanalyticweb[.]com 54.37.104[.]106 93.113.131[.]103\n\n10d571d66d3ab7b9ddf6a850cb9b8e38b07623c0 sysanalyticweb[.]com 54.37.104[.]106 93.113.131[.]103\n\n397d97e278110a48bd2cb11bb5632b99a9100dbd elaxo[.]org 86.106.131[.]54 86.106.131[.]54\n\nddaa06a4021baf980a08caea899f2904609410b9 ikmtrust[.]com 185.144.82[.]239 185.144.82[.]239\n\n2529f6eda28d54490119d2123d22da56783c704f lxwo[.]org 185.86.149[.]54 185.86.149[.]54\n\n**09d2e2c26247a4a908952fee36b56b360561984f** **webstp[.]com** **185.94.191[.]65** **185.94.191[.]65**\n\nTable 1: Hijacked LoJack samples and their C&C infrastructure (including the fallback IP). In bold the sample\nwe uncovered.\n\n## Attribution\n\nWe can assert with high confidence that this specific hijacked Absolute LoJack for laptops sample appears to\nbe related to the campaign recently unveiled by Arbor Networks. Our reasoning follows:\n\n\n-----\n\nThe domain webstp[.]com is associated to an Absolute LoJack agent utilizing the exact same compile\ntime of other hijacked LoJack samples, thus matching the same criteria used to cluster the original\nartifacts.\nThe domain sysanalyticweb[.]com and webstp[.]com share the same registrar, ititch[.]com, a company\n[claiming to provide bulletproof hosting, and used in other APT28 campaigns.](https://www.fidelissecurity.com/threatgeek/2016/08/fancy-bear-has-it-itch-they-can%E2%80%99t-scratch)\nThe domain in the registrant email address for webstp[.]com is centrum[.]cz, which appears frequently in\nother registrant email addresses of domains linked to previous APT28 campaigns associated with\nititch[.]com.\nThe Absolute LoJack for laptops agent connecting to webstp[.]com has been seen in the wild during the\nsame time frame of all other samples.\n\n## Conclusions\n\nIn this blog post, we further analyzed the C&C infrastructure used by the samples of Absolute LoJack for\nlaptops illicitly modified by APT28. We unveiled a new sample submitted from organizations with a consistent\nvictimology to other LoJack targets and domains that are part of the C&C infrastructure. We also discovered\nthat all Absolute LoJack for laptops samples had a fallback mechanism to increase their robustness against\nsinkholes. This infrastructure used in our new sample is linked to pro-European Union companies and/or exSoviet Union states. We will continue to publish new IOCs in this blog for the LoJack campaign as future\nsubmissions appear.\n\nAbout\nLatest Posts\n\n## David Wells\n\nDavid Wells is a Malware Reverse Engineer at Lastline with 4 years experience working in malware, botnet,\nand exploitation research. Previously he worked at Integral Ad Science and independent contracting for botnet\ntracking and exploitation research. His background consists of Windows internals with emphasis on\ncryptography and protocol reverse engineering for botnet/C&C research.\n\n**[Latest posts by David Wells (see all)](https://www.lastline.com/author/dwells/)**\n\n[APT28 Rollercoaster: The Lowdown on Hijacked LoJack - May 31, 2018](https://www.lastline.com/labsblog/apt28-rollercoaster-the-lowdown-on-hijacked-lojack/)\n[When Scriptlets Attack: Excel’s Alternative to DDE Code Execution - December 7, 2017](https://www.lastline.com/labsblog/when-scriptlets-attack-excels-alternative-to-dde-code-execution/)\n\nAbout\nLatest Posts\n\n\n-----\n\n## Stefano Ortolani\n\nStefano Ortolani is Director of Threat Intelligence at Lastline. Prior to that he was part of the research team in\nKaspersky Lab in charge of fostering operations with CERTs, governments, universities, and law enforcement\nagencies. Before that he earned his Ph.D. in Computer Science from the VU University Amsterdam.\n\n**[Latest posts by Stefano Ortolani (see all)](https://www.lastline.com/author/stefano/)**\n\n[Evolution of Excel 4.0 Macro Weaponization - June 2, 2020](https://www.lastline.com/labsblog/evolution-of-excel-4-0-macro-weaponization/)\n[InfoStealers Weaponizing COVID-19 - May 11, 2020](https://www.lastline.com/labsblog/infostealers-weaponizing-covid-19/)\n[Nemty Ransomware Scaling UP: APAC Mailboxes Swarmed by Dual Downloaders - February 18, 2020](https://www.lastline.com/labsblog/nemty-ransomware-scaling-up-apac-mailboxes-swarmed-dual-downloaders/)\n\nAbout\nLatest Posts\n\n## Luukas Larinkoski\n\nLuukas Larinkoski is a Network Threat Analyst at Lastline. He enjoys uncovering and defending against both\nnew and emerging network threats, and spends most of his time researching and developing systems for\nprotecting customer networks. His research interests include network anomaly detection and security event\ncorrelation.\n\n**[Latest posts by Luukas Larinkoski (see all)](https://www.lastline.com/author/luukas/)**\n\n[APT28 Rollercoaster: The Lowdown on Hijacked LoJack - May 31, 2018](https://www.lastline.com/labsblog/apt28-rollercoaster-the-lowdown-on-hijacked-lojack/)\n[A Wild Port Scan Appears. What now? - May 9, 2018](https://www.lastline.com/labsblog/a-wild-port-scan-appears-what-now/)\n\nTags:\n\n[Andy Norton,](https://www.lastline.com/tag/andy-norton/) [APT28,](https://www.lastline.com/tag/apt28/) [attribution,](https://www.lastline.com/tag/attribution/) [C&C infrastructure,](https://www.lastline.com/tag/cc-infrastructure/) [Computrace,](https://www.lastline.com/tag/computrace/) [David Wells,](https://www.lastline.com/tag/david-wells/) [Fancy Bear,](https://www.lastline.com/tag/fancy-bear/) [Lastline Labs,](https://www.lastline.com/tag/lastline-labs/)\n[LoJack implant,](https://www.lastline.com/tag/lojack-implant/) [Luukas Larinkoski,](https://www.lastline.com/tag/luukas-larinkoski/) [Stefano Ortolani](https://www.lastline.com/tag/stefano-ortolani/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-31 - APT28 Rollercoaster- The Lowdown on Hijacked Lo.pdf"
    ],
    "report_names": [
        "2018-05-31 - APT28 Rollercoaster- The Lowdown on Hijacked Lo.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536075,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653787616,
    "ts_modification_date": 1653787616,
    "files": {
        "pdf": "https://archive.orkl.eu/d0cad6ed159b9fa9fb718fc0651354a8948667b7.pdf",
        "text": "https://archive.orkl.eu/d0cad6ed159b9fa9fb718fc0651354a8948667b7.txt",
        "img": "https://archive.orkl.eu/d0cad6ed159b9fa9fb718fc0651354a8948667b7.jpg"
    }
}