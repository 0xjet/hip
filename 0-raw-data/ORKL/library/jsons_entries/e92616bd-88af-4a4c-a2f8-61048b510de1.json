{
    "id": "e92616bd-88af-4a4c-a2f8-61048b510de1",
    "created_at": "2022-10-25T16:48:13.585883Z",
    "updated_at": "2025-03-27T02:16:45.741772Z",
    "deleted_at": null,
    "sha1_hash": "d76a268a20027c5f56e67b2743ac747a466c257e",
    "title": "",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1012705,
    "plain_text": "[B](http://www.twitter.com/volexity) [M](http://www.volexity.com/blog/?feed=rss2)\n\n\nIncident Response &\n\nSuppression\n\n\n[Home](http://www.volexity.com/blog/)\n\n\n# APT Group Wekby Leveraging Adobe Flash Exploit (CVE-2015-5119)\n\n[Posted on July 8, 2015 by Steven Adair](http://www.volexity.com/blog/?p=158)\n\n[As if the recent breach and subsequent public data dump involving the Italian company Hacking Team wasn’t bad](http://www.csoonline.com/article/2943968/data-breach/hacking-team-hacked-attackers-claim-400gb-in-dumped-data.html)\n\nenough, it all gets just a little bit worse. Emerging from the bowels of Hacking Team data dump was a Flash 0-day\n\n[exploit (CVE-2015-5119) that was just patched today by Adobe as covered in APSB15-16. The exploit has since been](https://helpx.adobe.com/security/products/flash-player/apsb15-16.html)\n\n[added into the Angler Exploit Kit and integrated into Metasploit. However, not to be out done, APT attackers have](http://malware.dontneedcoffee.com/2015/07/hackingteam-flash-0d-cve-2015-xxxx-and.html)\n\nalso started leveraging the exploit in targeted spear phishing attacks as well. Before we start dishing the details,\n\nthere is going to be one main takeaway from this blog post: If you haven’t already, update/patch your Adobe Flash\n\nnow.\n\n## Spear Phishing\n\nThis morning, a well known APT threat group, often referred to as Wekby, kicked off a rather ironic spear phishing\n\ncampaign. The attackers launched spoofed e-mail messages purporting to be from Adobe. The e-mail messages\n\nreferences an Adobe Flash update and encourage the recipients to click a link to download and install the update.\n\nTake a look at an example of the spear phish e-mail message below.\n\n\n-----\n\nThe visible and spoofed source e-mail address for “Andre Vangils” is avangils@adobe.com. This is not a particularly\n\nadvanced spear phish message. However, the visible link http://get.adobe.com, as you have likely guessed, does not\n\nactually go to Adobe’s website. Instead it leads to index.htm on an IP address belonging to a hosting provider\n\nnamed PEG TECH INC. This page is far less helpful than one would hope. Instead of providing a legitimate Adobe\n\nFlash update, the page loads a malicious SWF file instead. The following contents are found from the HTML page\n\nfrom the link:\n\n<body>\n\n<div style=”position:fixed; top:50%; left:50%; width:600; height:400; margin-left:-300; margin-top:-200;”>\n\n<object classid=”clsid:D27CDB6E-AE6D-11cf-96B8-444553540000″ id=”swf” width=”600″ height=”400″>\n\n<param name=”movie” value=”movie.swf” />\n\n<param name=”allowScriptAccess” value=”always” />\n\n<embed src=”movie.swf” width=”600″ height=”400″ allowScriptAccess=”always” type=”application/x\nshockwave-flash” />\n\n</object>\n\n</div>\n\n</body>\n\n</html>\n\nIf you guess this was a Flash exploit, then you are 100% correct.\n\n## Exploits and Malware\n\nThe aforementioned exploit works on Adobe Flash versions all the way up to 18.0.0.194. You need to have updated\n\nyour Flash since this morning to be safe from its grips The attackers appear to have modified one of the exploits that\n\n\n-----\n\nfile is LZMA compressed and has the ZWS file header. There are plenty of great tools out there that can be used to\n\n[look at Flash files. One of our favorites is SWF Investigator from Adobe. Poking around a bit we can see a few](http://labs.adobe.com/downloads/swfinvestigator.html)\n\ninteresting labels that appear to reference Hacking Team, such as the one shown below:\n\nNotice the “HT_exploit” label. Further down in the file is a class with the same name. These appear to be not so subtle\n\nreferences to the source of this exploit. We did not see these labels or class names in any of the other files we\n\nobserved thus far, so we presume these were recently created as part of this new exploit file. At the end of the day,\n\nthe goal of this attack is to install malware on target systems. If a vulnerable system were to visit the exploit site from\n\nthe spear phish message, this is exactly what would happen. In this case the flash file would drop an executable into\n\nthe victim user’s Temp directory similar to the path shown below:\n\n**C:\\Users\\$Username\\AppData\\Local\\Temp\\Rdws.exe**\n\nThe malware would then execute and immediately start beaconing to the Singapore IP address 223.25.233.248 on TCP\n\n**port 80. This is a well known Wekby command and control (C2) IP address that has been used for years. Currently**\n\nthere a few other active DNS names that resolve to IP such as gmail.bkz88.com and info.imly.org. Any connection\n\ninvolving this IP address or these hostnames should be consider hostile and a likely indicator of compromise.\n\nThe 223.25.233.248 IP address has served as a C2 server for a variety of different malware in the past (Poison Ivy,\n\nGh0st, Remote RSS, etc.). However, this go around the malware is a modified version of the Gh0st remote access\n\ntrojan (RAT). Typically the default version of Gh0st sends a packet flag of “Gh0st” in the first 5-bytes. This has been\n\nheavily modified over the years and several custom versions of Gh0st have emerged with dozens and dozens of\n\ncustomer packet flags such as cb1st, Winds, https, and so on. However, the Wekby APT actor last year started using a\n\nmodified version that has an 18 character packet flag. This version was reused in this attack and an infected system\n\nwill send a rather peculiar packet flag as seen in the image below:\n\n\n-----\n\nYou are reading that correctly, it’s sending: HTTP\\1.1 Sycmentec. Presumably this is a poor attempt to blend in as\n\nHTTP traffic and appear to be affiliated with Symantec. There are plenty of signatures in the Emerging Threats\n\nrulesets to pick up on Gh0st, but you can use the signature below to pickup on this specific instance of Gh0st.\n\nalert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:”Volexity – Wekby Gh0st Variant [HTTP\\1.1\n\nSycmentec]”; flow:to_server,established; content:”HTTP|5c|1.1 Sycmentec”; depth:18; sid:201507081;)\n\nYou can add in a check for two null bytes followed by zlib header (“|000789c|”) for an additional match. However,\n\nchances are a hit on that string by itself is probably bad news and solid enough. Add a rule for the reverse direction to\n\ncatch the server’s response as well.\n\nAlso, pretty interesting and funny is what happens is your version of Flash is up-to-date when you visit the exploit\n\npage. Instead of silently failing in the background, it instead results in the rather obvious popup:\n\nYour eyes are not deceiving you. It says faile! right on the screen. It looks like the attackers may have left a debug\n\nmessage from their testing. Not very subtle at all.\n\n## File Details and Persistence\n\nHere’s what to look for when it comes to file indicators.\n\n|Filename|movie.swf|\n|---|---|\n\n\n-----\n\n|MD5|079a440bee0f86d8a59ebc5c4b523a07|\n|---|---|\n|SHA1|7389e78cca58de6cb2cbe2b631d2fec259e9cdcc|\n|Notes|Malicious flash file that drops Wekby Gh0st RAT.|\n\n|Filename|Rdws.exe|\n|---|---|\n|File size|138240 bytes|\n|MD5|cfbcb83f8515bd169afd0b22488b4430|\n|SHA1|959638ee177b51bda8701c10258b4956f8b1c367|\n|Notes|HTTP\\1.1 Sycmentec packet flag malware.|\n\n\nThe malware sets its persistence adding an entry to the HKCU “RUN” key\n\n(HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run):\n\n**NAME: CSics**\n\n**DATA: C:\\Users\\$User\\AppData\\Local\\Rdws.exe**\n\n## Conclusion\n\nVolexity is aware of multiple other ongoing APT and non-APT cyber attacks leverage CVE-2015-5119. While it is always\n\nimportant to patch your software and keep it up-to-date, it is CRITICAL that you patch your Adobe Flash immediately.\n\nThe attackers are having a field day with this exploit and will not slow down any time soon. Patching is the most\n\nprudent course of action to deal with this exploit that is very much in the wild. Additionally, as always, for Microsoft\n\n[Windows users, looking at deploying the Enhance Mitigation Experience Toolkit (EMET) would also be advised.](https://support.microsoft.com/en-us/kb/2458544)\n\n[FOLLOW US ON TWITTER @VOLEXITY.](https://twitter.com/volexity)\n\n[This entry was posted in Adobe Flash, APT, China, Exploits, Vulnerabilities. Bookmark the permalink.](http://www.volexity.com/blog/?cat=13)\n\n\n[« Afghan Government Compromise: Browser Beware](http://www.volexity.com/blog/?p=134) Virtual Private Keylogging: Cisco Web VPNs Leveraged for\n\nAccess and Persistence »\n\n\nSearch …\n\n\n**Recent Posts**\n\nf[Virtual Private Keylogging:]\n\n[Cisco Web VPNs Leveraged for](http://www.volexity.com/blog/?p=179)\n\nAccess and Persistence\n\nf[APT Group Wekby]\n\n\n-----\n\nf[Afghan Government]\n\nCompromise: Browser Beware\n\nf[A New Shellshock Worm on]\n\nthe Loose\n\nf[Drupal Vulnerability: Mass]\n\nScans & Targeted Exploitation\n\n\n**Archives**\n\n[f[October 2015]](http://www.volexity.com/blog/?m=201510)\n\n[f[July 2015]](http://www.volexity.com/blog/?m=201507)\n\n[f[June 2015]](http://www.volexity.com/blog/?m=201506)\n\n[f[April 2015]](http://www.volexity.com/blog/?m=201504)\n\n[f[October 2014]](http://www.volexity.com/blog/?m=201410)\n\n[f[September 2014]](http://www.volexity.com/blog/?m=201409)\n\n\n**Categories**\n\n[f[Adobe Flash]](http://www.volexity.com/blog/?cat=13)\n\n[f[APT]](http://www.volexity.com/blog/?cat=4)\n\n[f[China]](http://www.volexity.com/blog/?cat=6)\n\n[f[Digital Surveillance]](http://www.volexity.com/blog/?cat=9)\n\n[f[Drupal]](http://www.volexity.com/blog/?cat=10)\n\n[f[Exploits]](http://www.volexity.com/blog/?cat=3)\n\n[f[Hong Kong]](http://www.volexity.com/blog/?cat=7)\n\n[f[Japan]](http://www.volexity.com/blog/?cat=5)\n\n[f[Java]](http://www.volexity.com/blog/?cat=8)\n\n[f[Scanning]](http://www.volexity.com/blog/?cat=11)\n\n[f[Vulnerabilities]](http://www.volexity.com/blog/?cat=2)\n\n\n[© 2015 Volexity, LLC](http://www.volexity.com/blog/www.volexity.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2015/2015.07.08.APT_CVE-2015-5119/APT%20Group%20Wekby%20Leveraging%20Adobe%20Flash%20Exploit%20%28CVE-2015-5119%29%20_%20Volexity%20Blog.pdf"
    ],
    "report_names": [
        "APT Group Wekby Leveraging Adobe Flash Exploit (CVE-2015-5119) _ Volexity Blog"
    ],
    "threat_actors": [
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c8aefee7-fb57-409b-857e-23e986cb4a56",
            "created_at": "2023-01-06T13:46:38.285223Z",
            "updated_at": "2025-03-27T02:00:02.79333Z",
            "deleted_at": null,
            "main_name": "APT18",
            "aliases": [
                "TG-0416",
                "SCANDIUM",
                "PLA Navy",
                "Wekby",
                "G0026",
                "DYNAMITE PANDA"
            ],
            "source_name": "MISPGALAXY:APT18",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "17b92337-ca5f-48bb-926b-c93b5e5678a4",
            "created_at": "2022-10-25T16:07:23.333316Z",
            "updated_at": "2025-03-27T02:02:09.74201Z",
            "deleted_at": null,
            "main_name": "APT 18",
            "aliases": [
                "APT 18",
                "Dynamite Panda",
                "Scandium",
                "TG-0416",
                "Wekby"
            ],
            "source_name": "ETDA:APT 18",
            "tools": [
                "AngryRebel",
                "AtNow",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HttpBrowser RAT",
                "HttpDump",
                "Moudour",
                "Mydoor",
                "PCRat",
                "Pisloader",
                "QUICKBALL",
                "Roseam",
                "StickyFingers",
                "Token Control",
                "TokenControl",
                "hcdLoader"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041805,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/d76a268a20027c5f56e67b2743ac747a466c257e.pdf",
        "text": "https://archive.orkl.eu/d76a268a20027c5f56e67b2743ac747a466c257e.txt",
        "img": "https://archive.orkl.eu/d76a268a20027c5f56e67b2743ac747a466c257e.jpg"
    }
}