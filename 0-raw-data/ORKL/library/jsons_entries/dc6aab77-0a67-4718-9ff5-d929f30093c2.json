{
    "id": "dc6aab77-0a67-4718-9ff5-d929f30093c2",
    "created_at": "2023-01-12T15:09:01.423152Z",
    "updated_at": "2025-03-27T02:05:41.45321Z",
    "deleted_at": null,
    "sha1_hash": "cf8ebe2539876d60d42a86dd6101d3ad2b924272",
    "title": "2022-05-03 - Subdomain Takeovers and 1.1 million “dangling” risks",
    "authors": "",
    "file_creation_date": "2022-08-18T03:20:49Z",
    "file_modification_date": "2022-08-18T03:20:49Z",
    "file_size": 1021869,
    "plain_text": "# Subdomain Takeovers and 1.1 million “dangling” risks\n\n**[silentpush.com/blog/subdomain-takeovers-and-other-dangling-risks](https://www.silentpush.com/blog/subdomain-takeovers-and-other-dangling-risks)**\n\nMay 3, 2022\n\nMay 3\nWritten By [The Team](http://10.10.0.46/blog?author=6081bc3c4920d358398731f8)\n\nSubdomain takeover proof of concept by Silent Push on an Azureedge.net target.\n\nThere have been an incredible number of very large scale data breaches lately that seemed\nto have unexplained entry points. Combining social engineering with “token” collection or\nstealing seems to be a more efficient way to gain access to customers who are heavy users\nof cloud based applications.\n\nLet me begin with the most simple explanation of a subdomain takeover. Your organization\nowns a domain, lets say for example, it is `israwords.com.`\n\nOne day someone sets up a service using a third party, it could be anything, a wordpress\nsite, a CDN, heroku, github. The thing is it needs you to point a subdomain at the service so\nit appears to be under your domain. In this case it is the Microsoft CDN which uses\ncustomername.azureedge.net .\n\nSo for this example the company put in place a CNAME record\n\n```\n2010.israwords.com. 800 IN CNAME 2010israwords.azureedge.net.\n\n```\n\nSo far so good. The organization is using this service from Microsoft Azure and any traffic\nfor 2010.israwords.com gets redirected to the Content Delivery Network provided by Azure.\nHowever, at some point the organization changes provider or gives up on the service. At\nsome point Microsoft will deem 2010israwords to be an unused subdomain in\nAzureedge.net and someone else can use it. So we did this as a Proof Of Concept.\n\nTarget dangling domain on Azure\n\nThen, we looked up the original subdomain to see if it had worked.\n\n\n-----\n\nFull subdomain takeover.\n\nWe would like to emphasize that we did not really take over anything for this to happen. We\ndidn’t need to. The dangling CNAME just points at something we control. However, what\nare the potential consequences of that?\n\n## Potential Damage\n\nWe have found 1.1 million CNAME’s that are potentially vulnerable to a takeover.\n\nWe didn’t want to take the Proof Of Concept any further than that but the possibilities are\nlarge. A number of them are called out on Hacker One here\nhttps://www.hackerone.com/application-security/guide-subdomain-takeovers\n\n**Loss of control over the content of the subdomain - The party controlling the endpoint**\ncould post any content they wanted there. This could be insulting to the original domain\nowner or malicious.\n\n**[Session Cookie Harvesting and OAuth Tokens- Becoming a valuable resource and](https://www.hackerone.com/application-security/guide-subdomain-takeovers)**\none of the main vectors in modern hacking and access brokerage cookies and OAuth\ntokens are worth money immediately in hacker forums and can quickly escalate the\naccess that they have.\n\n\n-----\n\n**Phishing campaigns - One of the main concerns resulting from subdomain take**\novers is Phishing campaigns targeting your staff or customers. Your staff will be very\nvulnerable to campaigns appearing to be on your own domain and at high risk of\nentering valid credentials in any forms. The reputational damage to customers would\nbe very large if they are targeted as they will take some convincing that you didn’t\nhave a breached network when they enter their details on a site that appears on your\ndomain.\n\n**Further risks - Malicious sites might be used to escalate into other classic attacks**\nsuch as XSS, CSRF, CORS bypass, and more.\n\n## How Can I Protect My Organization From Sub-Domain Takeover?\n\nFortunately, this is an easy answer.\n\n[We provide a free lookup tool in our Community Edition. From our Explore page, choose](https://www.silentpush.com/products)\nQuery Builder.\n\nThen from the bottom left in our Experimental section choose -PADNS search dangling\nrecords\n\nEnter your domain, wildcards are accepted. If you wish you can also enter the target\nservice. For example, if you are concerned about having a dangling domain pointed at\nsome Azure service you can enter\n\n\n-----\n\nThis will give you the results you need. In the example below, I have just entered the target.\nThis could be used by security researchers to look for soft targets.\n\n\n-----\n\nWe have achieved this by marking all CNAME records where the target has no destination\nas a dangling record. We do the same for Name Servers.\n\n## Next Steps\n\nNow you need to delete all of these dangling DNS entries so they no longer leave you\nexposed.\n\n## Access\n\nYou can apply for access to the community edition of our service here\n\nName\n*\nThank you!\nOr for a trial of the main service with all its real time monitoring and threat feeds,\n\nName\n*\nThank you!\n\n[The Team](http://10.10.0.46/blog?author=6081bc3c4920d358398731f8)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-03 - Subdomain Takeovers and 1.1 million “dangling” risks.pdf"
    ],
    "report_names": [
        "2022-05-03 - Subdomain Takeovers and 1.1 million “dangling” risks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536141,
    "ts_updated_at": 1743041141,
    "ts_creation_date": 1660792849,
    "ts_modification_date": 1660792849,
    "files": {
        "pdf": "https://archive.orkl.eu/cf8ebe2539876d60d42a86dd6101d3ad2b924272.pdf",
        "text": "https://archive.orkl.eu/cf8ebe2539876d60d42a86dd6101d3ad2b924272.txt",
        "img": "https://archive.orkl.eu/cf8ebe2539876d60d42a86dd6101d3ad2b924272.jpg"
    }
}