{
    "id": "63f91f64-d612-458a-a5f7-e2195dce9943",
    "created_at": "2023-01-12T15:04:52.820148Z",
    "updated_at": "2025-03-27T02:14:45.141798Z",
    "deleted_at": null,
    "sha1_hash": "7118b9bb771802007d37446950deab77e400a8d2",
    "title": "2019-11-21 - New SectopRAT- Remote access malware utilizes second desktop to control browsers",
    "authors": "",
    "file_creation_date": "2022-05-27T23:13:42Z",
    "file_modification_date": "2022-05-27T23:13:42Z",
    "file_size": 372127,
    "plain_text": "# New SectopRAT: Remote access malware utilizes second desktop to control browsers\n\n**[gdatasoftware.com/blog/2019/11/35548-new-sectoprat-remote-access-malware-utilizes-second-desktop-to-control-browsers](https://www.gdatasoftware.com/blog/2019/11/35548-new-sectoprat-remote-access-malware-utilizes-second-desktop-to-control-browsers)**\n\n11/21/2019\n\nG DATA Blog\nThis new remote access malware creates a second desktop that is invisible to the system's user. The threat actor can surf the Internet using\nthe infected machine.\n\n## General appearance and obfuscation\n\n[SectopRAT is a .NET based remote access malware. The sample[1] was originally found by MalwareHunterTeam and announced in a tweet on](https://twitter.com/malwrhunterteam/status/1195288774957244416)\n15. November 2019. It was compiled on 13. November 2019. Using the following Yara rule we were able to obtain a second sample[2] that was\ncompiled on 14. November 2019 and submitted a day later to Virustotal.\n\n```\nrule SectopRat\n{ meta: author = \"Karsten Hahn at G DATA CyberDefense AG\" strings: $s_1 = \"RemoteClient\\x00\" $s_2 =\n\"InitHDesktop\\x00\" $s_3 = \"InitBrowser\\x00\" $s_4 = \"EnoghtSpace\\x00\" $s_5 = \"SPI_SETSCREENSAVEACTIVE\\x00\"\ncondition: all of them and uint16(0) == 0x5A4D\n}\n\n```\nThe first sample[1] is signed by Sectigo RSA Code Signing CA, uses a Flash icon and has the following Version Information.\n\nlanguage ID: 0x0409\n\ncode page: 0x04B0\n\nComments: Idito PleasweN MinIMus Inc.\n\nCompanyName: Nikler\n\nLegalCopyright: Nikler\n\nProductName: Idito PleasweN MinIMus Inc.\n\nFileVersion: 3.21.0005\n\nProductVersion: 3.21.0005\n\nInternalName: Burataslop\n\nOriginalFilename: Burataslop.exe\n\n\nThe second sample[2] is not signed and uses an icon that looks like a red floppy disk. The Version Information looks different too but follows a\nsimilar pattern of upper and lower case combinations in a jumble of arbitrary words.\n\nlanguage ID: 0x0409\n\ncode page: 0x04B0\n\nComments: errORs KilEfnos INCreASe MY Wife\n\n\n-----\n\nCo pa y a e o ase usce ea G Jo\nLegalCopyright: FAW ISir Polaris ComapNY\nLegalTrademarks: investORS Leanda MikiRUck\nProductName: Colleti\nFileVersion: 4.01.0009\nProductVersion: 4.01.0009\nInternalName: Veerfus413\nOriginalFilename: Veerfus413.exe\n\nThe first section of both samples has arbitrary characters for its name and has write and execute characteristics. The 5th and last section has\nno name and contains the entry point. The other sections look rather typical.\n\nThe threat actor used ConfuserEx to obfuscate the control flow and add anti-tamper to the .NET assembly. The anti-tamper prevents tools like\nDnSpy from decompiling the code (see picture below).\n\nConfuserEx adds anti-tamper that leads to decompilation errors\n\n## Configuration and persistence\n\nThe assembly has a RemoteClient.Config class containing four public static variables for the configuration: ip, retip, filename, mutexName. The\nip is the Command and Control (C&C) server IP. The retip variable is for setting a new C&C IP that the server can override by using the \"set IP\"\ncommand. The configuration is the same for both SectopRAT samples.\n\nConfig class in SectopRAT sample\n\nThe variables filename and mutexName are set but not used in the code. Instead it uses a hardcoded filename, spoolsvc.exe, and copies itself\nto %LOCALAPPDATA%\\Microsoft\\\n\nPersistence is achieved by adding spoolsvc.exe to the RUN key in the registry.\n```\nHKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\SFddg --> %LOCALAPPDATA%\\Microsoft\\spoolsvc.exe\n\n```\nNote that the legitimate Print Spooler Service system file by Microsoft is named spoolsv.exe\n\n## Command & control features\n\nSectopRAT command and control operates with packet types which are distinguished by a certain byte value in every packet.\n\n**Byte value** **Packet type**\n\n\n-----\n\n**Byte value** **Packet type**\n\n1 Start stream\n\n2 Stop stream\n\n3 Handle mouse event\n\n4 Handle keyboard event\n\n5 Init browser\n\n6 Disconnect\n\n7 Get codec info (not implemented)\n\n8 Send computer info\n\n9 Set IP\n\nThe \"Start stream\" packet will either stream the current desktop or create another desktop using the hardcoded desktop name \"sdfsddfg\". The\nsecond desktop is not visible to the person who sits in front of the infected computer. The threat actor however can use \"Init browser\" to surf\nthe Internet via the second desktop on the infected system.\n\nThe \"Init browser\" packet has support for running Chrome, Firefox or Internet Explorer. It will change browser configuration, use start\nparameters and modify registry settings to disable security and make the browsers faster. E.g. for Chrome it disables sandboxes, the graphics\ncache and graphics options like 3d-apis, flash-3d, gpu-rasterization, gpu-vsync. The browser paths are hardcoded and don't use any\nenvironmental variables, which limits compatibility of the RAT.\n\nThe \"Send computer info\" packet will send the operating system name, the username, an id that is based on a randomly created path name\nand a hash value that is based on hardware information like the processor name, the number of cores and RAM.\n\n\"Get codec info\" is not implemented yet. The client does not do anything.\n\n\"Set IP\" makes it possible to change the IP of the C&C server.\n\nThis code creates another desktop on\n\nthe infected system.\n\n## Unfinished but we will probably see more\n\n\n-----\n\nSectop s used t e d but st oo s u s ed a d pa ts ast y do e So e o t e c ass a es a d a so t e a e o t e seco d\ndesktop look like they were produced while trying to type arbitrarily on the keyboard because the keys are right next to each other and\nrepeated by finger motion.\n\nDespite obvious flaws like using hardcoded paths without environmental variables to access system files, the RAT's architecture, the use of a\nsecond desktop and changes in browser configuration files and parameters show some internal knowledge that is far from a greenhorn. It is\nquite possible that the first samples in the wild are merely for testing. We expect to see new versions with additional features in the future.\n\n## Indicators of Compromise\n\n**Description** **Filenames** **SHA256** **URL**\n\n\n\n[1]\nSectopRAT\n\nDeobfuscated\nSectopRAT\n\n[1]\n\n[2]\nSectopRAT\n\n**Karsten Hahn**\n\nMalware Analyst\n\n\nBurataslop.exe\n\nblad.exe\n\nVeerfus413.exe\n\nbssd.exe\n\n\nb1e3b5de12f785c45d5ea3fc64412ce640a42652b4749cf73911029041468e3a hxxp://45.142.213.230/blad.\n\n4409d2170aa9989c6a8dd32b617c51a7c3e328b3c86410813c016691b2bd7774\n\nd5a3d47e1945e9d83a74a96f02a0751abd00078ee62e6d3a546a050e0db10d93 hxxp://45.142.213.230/bssd\n\n\nYou are here:\n[Blog (EN)](https://www.gdatasoftware.com/blog)\nRemote access malware utilizes second desktop to control browsers\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-11-21 - New SectopRAT- Remote access malware utilizes second desktop to control browsers.pdf"
    ],
    "report_names": [
        "2019-11-21 - New SectopRAT- Remote access malware utilizes second desktop to control browsers.pdf"
    ],
    "threat_actors": [
        {
            "id": "b69037ec-2605-4de4-bb32-a20d780a8406",
            "created_at": "2023-01-06T13:46:38.790766Z",
            "updated_at": "2025-03-27T02:00:02.919758Z",
            "deleted_at": null,
            "main_name": "MUSTANG PANDA",
            "aliases": [
                "TEMP.HEX",
                "TA416",
                "TANTALUM",
                "Twill Typhoon",
                "Earth Preta",
                "Stately Taurus",
                "LuminousMoth",
                "Polaris",
                "BRONZE PRESIDENT",
                "HoneyMyte",
                "Red Lich"
            ],
            "source_name": "MISPGALAXY:MUSTANG PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535892,
    "ts_updated_at": 1743041685,
    "ts_creation_date": 1653693222,
    "ts_modification_date": 1653693222,
    "files": {
        "pdf": "https://archive.orkl.eu/7118b9bb771802007d37446950deab77e400a8d2.pdf",
        "text": "https://archive.orkl.eu/7118b9bb771802007d37446950deab77e400a8d2.txt",
        "img": "https://archive.orkl.eu/7118b9bb771802007d37446950deab77e400a8d2.jpg"
    }
}