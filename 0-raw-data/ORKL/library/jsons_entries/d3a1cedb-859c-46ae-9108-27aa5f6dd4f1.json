{
    "id": "d3a1cedb-859c-46ae-9108-27aa5f6dd4f1",
    "created_at": "2023-01-12T15:09:44.003469Z",
    "updated_at": "2025-03-27T02:05:55.343344Z",
    "deleted_at": null,
    "sha1_hash": "cc743f4c2da5140c9b3e5108140dfdf01f266b8b",
    "title": "2022-08-18 - BianLian- New Ransomware Variant On The Rise",
    "authors": "",
    "file_creation_date": "2022-11-28T18:53:10Z",
    "file_modification_date": "2022-11-28T18:53:10Z",
    "file_size": 6015062,
    "plain_text": "# BianLian: New Ransomware variant on the rise\n\n**[blog.cyble.com/2022/08/18/bianlian-new-ransomware-variant-on-the-rise/](https://blog.cyble.com/2022/08/18/bianlian-new-ransomware-variant-on-the-rise/)**\n\n## GoLang-based Ransomware targets multiple industries\n\n\nAugust 18, 2022\n\n\nCyble Research Labs has observed that malware written in the programming language “Go” has recently\nbeen popular among Threat Actors (TAs). This is likely due to its cross-platform functionalities and the\nfact that it makes reverse engineering more difficult. We have seen many threats developed using the Go\nlanguage, such as Ransomware, RAT, [Stealer, etc.](https://blog.cyble.com/2022/08/03/loli-stealer-golang-based-infostealer-spotted-in-the-wild/)\n\n[During our routine threat-hunting exercise, we came across a Twitter post about a ransomware variant](https://twitter.com/malwrhunterteam/status/1557789273595731969)\nwritten in Go named “BianLian,” which was first identified halfway through July 2022.\n\nThe ransomware has targeted many well-known organizations (9 victims so far) across several industry\nsectors such as Manufacturing, Education, Healthcare, BFSI, etc. In the figure below, we have prepared\na breakdown of the industries targeted by the BianLian ransomware.\n\n\n-----\n\nFigure 1 – Industries Targeted by the BianLian Ransomware\n\n## Technical Analysis\n\nWe have taken the below sample hash for the purposes of this analysis:\n(SHA256), eaf5e26c5e73f3db82cd07ea45e4d244ccb3ec3397ab5263a1a74add7bbcb6e2, which is a 64bit GoLang binary executable.\n\nThe unique build ID of the GoLang ransomware is shown below.\n\nFigure 2 – Go Build ID\nUpon execution of the ransomware, it attempts to identify if the file is running in a WINE environment by\nchecking the wine_get_version() function via the GetProcAddress() API.\n\nFigure 3 – Anti-analysis Technique\n\n\n-----\n\nThen, the ransomware creates multiple threads using the CreateThread() API function to perform faster\nfile encryption, making reverse engineering the malware more difficult. The below figure shows the\nmultiple threads created by the ransomware.\n\nFigure 4 – Multiple Thread Creation\nNext, the malware identifies the system drives (from A:\\ to Z:\\) using the GetDriveTypeW() API function\nand encrypts any files available in the connected drives. Then, the malware drops a ransom note in\nmultiple folders with the file name “Look at this instruction.txt.”\n\nThe ransomware creates a ransom note with the content shown below.\n\nFigure 5 – Malware Writing Ransom Notes\nAfter dropping the ransom note, the malware searches files and directories for encryption by enumerating\nthem using the FindFirstFileW() and FindNextFileW() API functions.\n\nThe ransomware excludes the below file extensions and file/folder names from encryption.\n\nFile extension .exe, .dll, .sys, .txt, .lnk and .html\n\nFile names bootmgr, BOOTNXT, pagefile.sys, thumbs.db, ntuser.dat and swapfile.sys\n\nFolder names Windows, Windows.old\n\n\n-----\n\nThe ransomware usesGoLang Packages such as _crypto/cipher, crypto/aes and crypto/rsa  for file_\nencryption on the victim machine.\n\nFigure 6 – Hardcoded Strings of “Crypto”\n\nGoLang Packages\nFor encryption, the malware divides the file content into 10 bytes chunks. First, it reads 10 bytes from the\noriginal file, then encrypts the bytes and writes the encrypted data into the target file. Dividing the data\ninto small chunks is a method to evade detection by Anti-Virus products.\n\nThe figure below shows the code snippet of the encryption loop and the original and infected file content\nbefore and after encryption.\n\n\n-----\n\nFigure 7 – Encryption routine and Original/Encrypted file content\nIn the next step, the malware renames the encrypted files with the “.bianlian” extension and replaces\nthem with the original file using the MoveFileExW() API function, as shown below.\n\nFigure 8 – MoveFileExW() API\nFinally, the ransomware deletes itself using the following command line, leaving only the encrypted files\nand the ransom note on the victim’s machine.\n\n_cmd /c del C:\\Users\\<Admin>\\Desktop\\new_one.exe_\n\nThe below figure shows the BianLian ransomware encrypted files and ransom note text file after the\nsuccessful infection of a victim’s machine.\n\n\n-----\n\nFigure 9 – Files encrypted by BianLian Ransomware\nIn the dropped ransom note, victims are given instructions on how they can contact the TAs to restore\ntheir encrypted files.\n\nThe TAs threaten their victims, stating that their important data, such as financial, client, business,\ntechnical, and personal files, has been downloaded and will be posted on their leak site if the ransom is\nnot paid within ten days.\n\nThe ransom note also contains the ID of TOX Messenger for ransom negotiations and the Onion URL of\nthe leak site page – shown in the figure below.\n\n\n-----\n\n_Figure 10 – Ransom note_\nThe figure below shows the BianLian ransomware Onion leak home page and the affected company’s\nextortion objects.\n\nFigure 11 – BianLian Leak site home page\nThe BianLian Leak site contains the list of all companies affected by the ransomware and the TA’s\ncontact details for ransomware data recovery.\n\n\n-----\n\nFigure 12 – BianLian Leak site affected companies list & TAs contact details\n\n## Conclusion\n\nRansomware is becoming an increasingly common and effective attack method that affects organizations\nand their productivity. BianLian is GoLang-based ransomware that continues to breach several industries\nand demand large ransom amounts. The TAs also use the double extortion method by stealing an\naffected organization’s files and leaking them online if the ransom is not paid on time.\n\nTAs write their ransomware in GoLang for various reasons; the language enables a single codebase to\nbe compiled into all major operating systems. The TAs behind BianLian are constantly making changes\nand adding new capabilities to avoid detection.\n\nCyble Research Labs will continue to monitor BianLian and other similar Ransomware groups’ activities\nand analyze them to better understand their motivations.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\n**Safety Measures Needed to Prevent Ransomware Attacks**\n\nConduct regular backup practices and keep those backups offline or in a separate network.\nTurn on the automatic software update feature on your computer, mobile, and other connected\ndevices wherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected devices,\nincluding PC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\n\n**Users Should Take the Following Steps After the Ransomware Attack**\n\nDetach infected devices on the same network.\nDisconnect external storage devices if connected.\nInspect system logs for suspicious events.\n\n\n-----\n\n**Impact of BianLian Ransomware**\n\nLoss of Valuable data.\nLoss of the organization’s reputation and integrity.\nLoss of the organization’s sensitive business information.\nDisruption in organization operation.\nFinancial loss.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n\nExecution [T1204](https://attack.mitre.org/techniques/T1204/)\n\n[T1059](https://attack.mitre.org/techniques/T1059/)\n\nDefense Evasion [T1497](https://attack.mitre.org/techniques/T1497/)\n\n[T1027](https://attack.mitre.org/techniques/T1027/002/)\n\n[T1036](https://attack.mitre.org/techniques/T1036/)\n\nDiscovery [T1082](https://attack.mitre.org/techniques/T1082/)\n\n[T1083](https://attack.mitre.org/techniques/T1083/)\n\n[T1518](https://attack.mitre.org/techniques/T1518/001/)\n\n[T1120](https://attack.mitre.org/techniques/T1120/)\n\n\nUser Execution\n\nCommand and Scripting Interpreter\n\nVirtualization/Sandbox Evasion\n\nSoftware Packing\n\nMasquerading\n\nSystem Information Discovery\n\nFile and Directory Discovery\n\nSecurity Software Discovery\n\nPeripheral Device Discovery\n\n\nImpact [T1486](https://attack.mitre.org/techniques/T1486/) Data Encrypted for Impact\n\nLateral Movement [T1091](https://attack.mitre.org/techniques/T1091/) Replication Through Removable Media\n\n## Indicator Of Compromise (IOCs)\n\n**Indicators** **Indicator**\n\n**Type**\n\n\n**Description**\n\nBianLian\n\nRansomware\nExecutable\n\nBianLian\n\nRansomware\nExecutable\n\n\n0c756fc8f34e409650cd910b5e2a3f00\n\n70d1d11e3b295ec6280ab33e7b129c17f40a6d2f\n\neaf5e26c5e73f3db82cd07ea45e4d244ccb3ec3397ab5263a1a74add7bbcb6e2\n\n08e76dd242e64bb31aec09db8464b28f\n\n3f3f62c33030cfd64dba2d4ecb1634a9042ba292\n\n1fd07b8d1728e416f897bef4f1471126f9b18ef108eb952f4b75050da22e8e43\n\n\nMD5\n\nSHA1\n\nSha256\n\nMD5\n\nSHA1\n\nSha256\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-18 - BianLian- New Ransomware Variant On The Rise.pdf"
    ],
    "report_names": [
        "2022-08-18 - BianLian- New Ransomware Variant On The Rise.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536184,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 1669661590,
    "ts_modification_date": 1669661590,
    "files": {
        "pdf": "https://archive.orkl.eu/cc743f4c2da5140c9b3e5108140dfdf01f266b8b.pdf",
        "text": "https://archive.orkl.eu/cc743f4c2da5140c9b3e5108140dfdf01f266b8b.txt",
        "img": "https://archive.orkl.eu/cc743f4c2da5140c9b3e5108140dfdf01f266b8b.jpg"
    }
}