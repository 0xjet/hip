{
    "id": "2d815297-98ed-48d8-b10c-a604228ed9ac",
    "created_at": "2023-01-12T15:01:07.439471Z",
    "updated_at": "2025-03-27T02:17:02.754996Z",
    "deleted_at": null,
    "sha1_hash": "fe181765418a019e973f56ec4834ddab7ae3d353",
    "title": "2022-05-06 - Rebranded Babuk Ransomware In Action- DarkAngels Ransomware Performs Targeted Attack",
    "authors": "",
    "file_creation_date": "2022-05-28T05:02:41Z",
    "file_modification_date": "2022-05-28T05:02:41Z",
    "file_size": 917704,
    "plain_text": "# Rebranded Babuk Ransomware in Action: DarkAngels Ransomware Performs Targeted Attack\n\n**[blog.cyble.com/2022/05/06/rebranded-babuk-ransomware-in-action-darkangels-ransomware-performs-targeted-attack/](https://blog.cyble.com/2022/05/06/rebranded-babuk-ransomware-in-action-darkangels-ransomware-performs-targeted-attack/)**\n\nMay 6, 2022\n\nCyble Research Labs has identified a new ransomware malware known as DarkAngels.\nAnalysis of the DarkAngels malware uncovered similarities between it and the Babuk\nRansomware.\n\nWhile executing the sample, we observed that the ransom note, and the TAs website,\ncontain a specific organization’s name indicating that the malware sample may have been\ndeveloped as part of a highly targeted attack.\n\nThis blog showcases the deep-dive analysis of one of the DarkAngels ransomware samples\nto identify their capabilities and the way to protect yourself/your organization from them.\n\n## Technical Analysis\n\n\n-----\n\nBased on static analysis, we found that the malicious file is a 32-bit Graphical User Interface\n(GUI) based binary, as shown in Figure 1.\n\nFigure 1 – Static File Information of DarkAngels Sample\nUpon execution, the malware first changes the priority of the process i.e to zero by calling\nthe SetProcessShutdownParameters() API so that the malware’s activities can be terminated\nonly before the system shutdown. This is a way to increase the amount of time the malware\ngets to execute in the compromised machine.\n\nFigure 2 – Malware\n\nChanges the Priority of the Process\nThe malware tries to terminate the services before encrypting the system to ensure no\ninterruption during its encryption process. To identify the services in the victim’s machine,\nit calls the OpenSCManagerA() API, which establishes a connection to the service control\nmanager and gives the malware access to the service control manager database, as shown\nin Figure 3.\n\n\n-----\n\nFigure 3 –\n\nEnumerates Services\nAfter gaining access, the malware enumerates the services and fetches the service names in\nthe victim’s machines. The ransomware then checks the presence of the services such as\nVSS, SQL, Memtas, etc., and terminates them if the services are actively running on the\nvictim’s machine.\n\nThe ransomware also enumerates the running processes using\n_CreateToolhelp32Snapshot(), Process32FirstW(), and Process32NextW() APIs, checks the_\nprocess names such as sql.exe,oracle.exe, powerpnt.exe, etc., and terminates them if they\nare actively running.\n\nFigure 4 – Terminates Active Processes\n\nFurthermore, we noticed that the binary launches the vssadmin.exe process to delete all\nShadow Copy, as shown in figure 5. The malware deletes shadow copies to avoid recovery\nof the system after encrypting the files.\n\n\n-----\n\nFigure 5 – Deletes All Shadow Copies\nThe malware deletes all items from the Recycle Bin by calling the “SHEmptyRecycleBinA()\nAPI to ensure no deleted files are restored after encryption.\n\nFigure 6 – Deletes Items\n\nfrom Recycle Bin\nAfter execution, DarkAngels Ransomware tries to get system information using\n_GetSystemInfo() API, which extracts information such as NumberOfProcessors._\n\nFigure 7 –\n\nDarkAngels Ransomware Collect System Info\nThe malware then creates a thread for all CPUs that it encounters, creates ransom notes\nnamed How_To_Restore_Your_Files.txt, and encrypts the files present in the victim’s\nmachine.\n\nThe malware enumerates the system and excludes the folders such as AppData, Boot,\nWindows, Windows.old, etc., from the encryption process.\n\nThe ransomware specifically excludes files such as autorun.inf, boot.ini,bootfont.bin, etc.,\nfrom encryption.\n\nThe ransomware also excludes file extensions such as .exe, .dll, and .babyk. The .babyk is a\nwell-known extension for Babuk ransomware which indicates the DarkAngels is linked to\nBabuk ransomware.\n\nLike Babuk ransomware, the DarkAngels appends a signature “choung dong looks like hot\ndog” at the end of the encrypted file, indicating the ransomware is linked to Babuk.\n\nFigure 8 – Appends Signature\n\nat the end of an encrypted file\nThe below figure demonstrates the ransom note dropped by the malware with the name\n“How_To_Restore_Your_Files.txt” to instruct the victims to pay the ransom money for the\ndecryption tool.\n\n\n-----\n\nFigure 9 – Ransom note\nIn their ransom note, the TAs have instructed victims to contact them through their TOR\nwebsite. In addition, the TAS threatens the victims to disclose their data if they do not\nrespond within four days after the attack and notify government supervision agencies,\ncompetitors, and clients.\n\nAfter dropping the ransom notes, the malware encrypts the files on the victim’s machine and\nappends the extension with “.crypt,” as shown in the below figure.\n\n\n-----\n\nFigure 10 –\n\nEncrypted Files on the Machine\nDarkAngels has the capability to be spared through network shares and paths of the infected\nmachine, as shown in Figure 11.\n\nFigure 11 – Checks for Network shares\n\nand paths\nIf the given command-line argument is “shares,” then the ransomware finds Network shares\nand retrieves information about each shared resource on a server using NetShareEnum()\nAPI. Furthermore, it checks for $ADMIN share and starts encrypting the files.\n\n\n-----\n\nFigure 12 – Enumerate Shares and Encrypt\n\nFiles\nIf the given command-line argument is “paths,” then the ransomware calls GetDriveTypeW()\nAPI to find out the network drive connected to the infected machine. Once the network drive\nis identified, the ransomware starts encrypting the files.\n\n\n-----\n\nFigure 13 – Enumerate\n\nDrives and Encrypt Files\nWhen the command line arguments “-paths” and “-shares” are not provided, and also no\nmutex named “DarkAngels” opened in the infected machine then, the ransomware\nrecursively traverses through all local drives and encrypts the files.\n\nFigure 14 – Enumerates Local Drives\n\nThe below image shows the warning message to a victim company.\n\n\n-----\n\nFigure 15 – Warning message to a Victim Company\nThe below image shows the financial transactions of over $1M to the TAs BTC address.\n\nFigure\n\n16 – Financial Transactions\n\n## Conclusion\n\nThere is a strong correlation between the DarkAngels malware and the existing Babuk\nransomware code. It is common for threat actors to leverage existing code, modifying it, and\nrebranding it. Unlike Babuk ransomware, the Dark Angels are using the malware to target\nspecific organizations. This approach shows some TAs are specifically selecting their targets.\nThus far no DarkAngels leak site has been identified. However, considering the targeted\nattacks one might appear soon.\n\nWe will continue to monitor DarkAngels’ extortion campaigns and update our readers with\nthe latest information.\n\n## Our Recommendations\n\n\n-----\n\nWe have listed some essential cybersecurity best practices that create the first line of control\nagainst attackers. We recommend that our readers follow the best practices given below:\n\n### Safety measures needed to prevent ransomware attacks\n\nConduct regular backup practices and keep those backups offline or in a separate\nnetwork.\nTurn on the automatic software update feature on your computer, mobile, and other\nconnected devices wherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected\ndevices, including PC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without verifying their\nauthenticity.\n\n### Users should take the following steps after the ransomware attack\n\nDetach infected devices on the same network.\nDisconnect external storage devices if connected.\nInspect system logs for suspicious events.\n\n### Impacts and cruciality Of DarkAngels Ransomware:\n\nLoss of Valuable data.\nLoss of organization’s reliability or integrity.\nLoss of organization’s business information.\nDisruption in organization operation.\nEconomic loss.\n\n## MITRE ATT&CK® Techniques\n\n**Tactic** **Technique ID** **Technique Name**\n\n**Execution** [T1204](https://attack.mitre.org/techniques/T1204/) User Execution\n\n**Discovery** [T1082](https://attack.mitre.org/techniques/T1082/) System Information Discovery\n\n\n**Impact** [T1490](https://attack.mitre.org/techniques/T1490/)\n\n[T1489](https://attack.mitre.org/techniques/T1489/)\n\n[T1486](https://attack.mitre.org/techniques/T1486/)\n\n\nInhibit System Recovery\n\nService Stop\n\nData Encrypted for Impact\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-06 - Rebranded Babuk Ransomware In Action- DarkAngels Ransomware Performs Targeted Attack.pdf"
    ],
    "report_names": [
        "2022-05-06 - Rebranded Babuk Ransomware In Action- DarkAngels Ransomware Performs Targeted Attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "3752ab7a-08c0-4e06-9896-eda2c3231ba7",
            "created_at": "2024-12-11T02:03:09.781792Z",
            "updated_at": "2025-03-27T02:05:17.331097Z",
            "deleted_at": null,
            "main_name": "GOLD ANGEL",
            "aliases": [
                "Dark Angels"
            ],
            "source_name": "Secureworks:GOLD ANGEL",
            "tools": [
                " FileShredder",
                " Filezilla",
                " Godzilla webshell",
                " Neo-Georg webshell",
                " WinSCP",
                "Advanced IP Scanner"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535667,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1653714161,
    "ts_modification_date": 1653714161,
    "files": {
        "pdf": "https://archive.orkl.eu/fe181765418a019e973f56ec4834ddab7ae3d353.pdf",
        "text": "https://archive.orkl.eu/fe181765418a019e973f56ec4834ddab7ae3d353.txt",
        "img": "https://archive.orkl.eu/fe181765418a019e973f56ec4834ddab7ae3d353.jpg"
    }
}