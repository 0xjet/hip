{
    "id": "b97109df-9af0-45b1-9c75-7271dedb1baf",
    "created_at": "2023-01-12T15:10:12.003132Z",
    "updated_at": "2025-03-27T02:16:20.922125Z",
    "deleted_at": null,
    "sha1_hash": "6910e14d267c15a9f95e89616bd5ba453b5125b4",
    "title": "Out of sight but not invisible - Defeating fileless malware with behavior monitoring AMSI and next-gen ",
    "authors": "",
    "file_creation_date": "2022-08-28T11:41:30Z",
    "file_modification_date": "2022-08-28T11:41:30Z",
    "file_size": 1722787,
    "plain_text": "# Out of sight but not invisible: Defeating fileless malware with behavior monitoring, AMSI, and next-gen AV\n\n**microsoft.com/security/blog/2018/09/27/out-of-sight-but-not-invisible-defeating-fileless-malware-with-behavior-**\nmonitoring-amsi-and-next-gen-av\n\nSeptember 27, 2018\n\nConsider this scenario: Two never-before-seen, heavily obfuscated scripts manage to slip past\nfile-based detection and dynamically load an info-stealing payload into memory. The scripts\nare part of a social engineering campaign that tricks potential victims into running the\nscripts, which use the file names install_flash_player.js and\n_BME040429CB0_1446_FAC_20130812.XML.PDF.js, to distribute and run the payload._\n\n_In MITRE’s evaluation of EDR solutions, Windows Defender ATP demonstrated industry-_\n_leading optics and detection capabilities. The breadth of telemetry, the strength of threat_\n_intelligence, and the advanced, automatic detection through machine learning, heuristics,_\n_and behavior monitoring delivered comprehensive coverage of attacker techniques across_\n_the entire attack chain._\n_[Read: Insights from the MITRE ATT&CK-based evaluation of Windows Defender ATP](https://cloudblogs.microsoft.com/microsoftsecure/2018/12/03/insights-from-the-mitre-attack-based-evaluation-of-windows-defender-atp/)_\n\nThe payload is sophisticated and particularly elusive, given that it:\n\nDoesn’t touch the disk, and does not trigger antivirus file scanning\nIs loaded in the context of the legitimate process that executed the scripts (i.e.,\n_wscript.exe)_\nLeaves no traces on the disk, such that forensic analysis finds limited evidence\n\n[These are markers of a fileless threat. Still, Windows Defender Advanced Threat Protection](https://docs.microsoft.com/en-us/windows/security/threat-protection/intelligence/fileless-threats)\n[(Windows Defender ATP) antivirus capabilities detect the payload, stopping the attack in its](https://www.microsoft.com/en-us/windowsforbusiness/windows-atp?ocid=cx-blog-mmpc)\ntracks. How is this possible?\n\n[In this scenario, Antimalware Scan Interface (AMSI) facilitates detection. AMSI is an open](https://cloudblogs.microsoft.com/microsoftsecure/2015/06/09/windows-10-to-offer-application-developers-new-malware-defenses/?source=mmpc)\ninterface that allows antivirus solutions to inspect script behavior by exposing script contents\nin a form that is both unencrypted and unobfuscated.\n\nAMSI is part of the range of dynamic next-gen features that enable antivirus capabilities in\nWindows Defender ATP to go beyond file scanning. These features, which also include\nbehavior monitoring, memory scanning, and boot sector protection, catch a wide spectrum of\nthreats, including new and unknown (like the two scripts described above), fileless threats\n(like the payload), and other sophisticated malware.\n\n## Generically detecting fileless techniques\n\n\n-----\n\nThe two aforementioned obfuscated scripts are actual malware detected and blocked in the\nwild by antivirus capabilities in Windows Defender ATP. Removing the first layer of\nobfuscation reveals a code that, while still partially obfuscated, showed some functions\n[related to a fileless malware technique called Sharpshooter. We found the two scripts, which](https://www.mdsec.co.uk/2018/03/payload-generation-using-sharpshooter/)\nwere variants of the same malware, not long after the Sharpshooter technique was\ndocumented and published by MDSec in 2017.\n\nThe Sharpshooter technique allows an attacker to use a script to execute a .NET binary\ndirectly from memory without ever needing to reside on the disk. This technique provides a\nframework that can enable attackers to easily repackage the same binary payload within a\nscript. As demonstrated by the example of the two scripts, files that use the Sharpshooter\ntechnique can then be used in social engineering attacks to lure users into running the script\nto deliver a fileless payload.\n\nFigure 1. Obfuscated code from install_flash_player.js script\n\nFigure 2. After de-obfuscation, the script contains functions typically used in the Sharpshooter technique\n\nWhen the Sharpshooter technique became public, we knew it was only a matter time before it\nwould be used it in attacks. To protect customers from such attacks, we implemented a\ndetection algorithm based on runtime activity rather than on the static script. In other words,\nthe detection is effective against the Sharpshooter technique itself, thus against new and\nunknown threats that implement the technique. This is how Windows Defender ATP blocked\nthe two malicious scripts at first sight, preventing the fileless payload from being loaded.\n\n\n-----\n\nThe detection algorithm leverages AMSI support in scripting engines and targets a generic\nmalicious behavior (a fingerprint of the malicious fileless technique). Script engines have the\ncapability to log the APIs called by a script at runtime. This API logging is dynamic and is\ntherefore not hindered by obfuscation: a script can hide its code, but it cannot hide its\nbehavior. The log can then be scanned by antivirus solutions via AMSI when certain\ndangerous APIs (i.e., triggers) are invoked.\n\nThis is the dynamic log generated by the scripts and detected by Windows Defender ATP at\nruntime via AMSI:\n\nFigure 3. Dynamic AMSI log generated during the execution of the Sharpshooter technique in the two\n\nmalicious scripts\n\nUsing this AMSI-aided detection, Windows Defender ATP disrupted two distinct malware\ncampaigns in June, as well as the steady hum of daily activities.\n\nFigure 4. Windows Defender ATP telemetry shows two Sharpshooter campaigns in June\n\nFurthermore, generically detecting the Sharpshooter technique allowed us to discover a\nparticularly sophisticated and interesting attack. Windows Defender ATP’s endpoint and\ndetection response capabilities caught a VBScript file that used the Sharpshooter technique.\n\n\n-----\n\nFigure 5. Sample Windows Defender ATP alert showing how detection of the Sharpshooter technique by\n\nWindows Defender AV is surfaced in Windows Defender Security Center\n\nWe analyzed the script and extracted the fileless payload, a very stealthy .NET executable.\nThe malware payload downloads data from its command-and-control (C&C) server via the\nTXT records of DNS queries. In particular, it downloads the initialization vector and\ndecryption key necessary to decode the core of the malware. The said core is also fileless\nbecause it’s executed directly in memory without being written on the disk. Thus, this attack\nleveraged two fileless stages.\n\nFigure 6. The core component of the malware is decrypted and executed from memory\n\nOur investigation into the incident turned up enough indicators for us to conclude that this\nwas likely a penetration testing exercise or a test involving running actual malware, and not a\nreal targeted attack.\n\nNonetheless, the use of fileless techniques and the covert network communication hidden in\nDNS queries make this malware similar in nature to sophisticated, real-world attacks. It also\nproved the effectiveness of the dynamic protection capabilities of Windows Defender ATP. In\n\n\n-----\n\n[a previous blog post, we documented how such capabilities allow Windows Defender ATP to](https://cloudblogs.microsoft.com/microsoftsecure/2017/12/04/windows-defender-atp-machine-learning-and-amsi-unearthing-script-based-attacks-that-live-off-the-land/)\ncatch KRYPTON attacks and other high-profile malware.\n\n## Upward trend in fileless attacks and living off the land\n\nRemoving the need for files is the next progression of attacker techniques. Antivirus\nsolutions have become very efficient in detecting malicious executables. Real-time protection\ngives visibility on each new file that lands on the disk. Furthermore, file activity leaves a trail\nof evidence that can be retrieved during forensic analysis. That’s why we are seeing an\nincrease in attacks that use of malware with fileless techniques.\n\nAt a high level, a fileless malware runs its main payload directly in memory without having to\ndrop the executable file on the disk first. This differs from traditional malware, where the\npayload always requires some initial executable or DLL to carry out its tasks. A common\n[example is the Kovter malware, which stores its executable payload entirely in registry keys.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/kovter-an-evolving-malware-gone-fileless)\nGoing fileless allows the attackers to avoid having to rely on physical files and improve\nstealth and persistence.\n\nFor attackers, building fileless attacks poses some challenges; in primis: how do you execute\ncode if you don’t have a file? Attackers found an answer in the way they infect other\ncomponents to achieve execution within these components’ environment. Such components\nare usually standard, legitimate tools that are present by default on a machine and whose\nfunctionality can be abused to accomplish malicious operations.\n\nThis technique is usually referred to as “living off the land”, as malware only uses resources\nalready available in the operating system. An example is the Trojan:Win32/Holiks.A malware\nabusing the mshta.exe tool:\n\nFigure 7. Trojan:Win32/Holiks.A is abusing mshta.exe to execute a script from command-line\n\nThe malicious script resides only in the command line; it loads and executes further code\nfrom a registry key. The whole execution happens within the context of the mshta.exe\nprocess, which is a clean executable and tends to be trusted as a legitimate component of the\noperating system. Other similar tools, such as cmstp.exe, regsvr32.exe, powershell.exe,\n_odbcconf.exe, rundll3.exe, just to name a few, have been abused by attackers. Of course, the_\nexecution is not limited to scripts; the tools may allow the execution of DLLs and executables,\neven from remote locations in some cases.\n\n\n-----\n\nBy living off the land, fileless malware can cover its tracks: no files are available to the\nantivirus for scanning and only legitimate processes are executed. Windows Defender ATP\novercomes this challenge by monitoring the behavior of the system for anomalies or known\npatterns of malicious usage of legitimate tools. For example, Trojan:Win32/Powemet.A!attk\nis a generic behavior-based detection designed to prevent attacks that leverage the\n_regsvr32.exe tool to run malicious scripts._\n\nFigure 8. Antivirus capabilities in Windows Defender ATP blocking legitimate regsvr32 tool\n\nabused to download and run a malicious remote script\n\n## What exactly is “fileless”?\n\nThe term “fileless” suggests that a threat that does not come in a file, such as a backdoor that\nlives only in the memory of a machine. However, there’s no generally accepted definition.\nThe term is used broadly; it’s also used to describe malware families that do rely on files in\norder to operate. In the Sharpshooter example, while the payload itself is fileless, the entry\npoint relies on scripts that need to be dropped on the target’s machine and executed. This,\ntoo, is considered a fileless attack.\n\n[Given that attacks involve several stages for functionalities like execution, persistence,](https://attack.mitre.org/wiki/ATT&CK_Matrix)\ninformation theft, lateral movement, communication with command-and-control, etc., some\nparts of the attack chain may be fileless, while others may involve the filesystem in some\n\n\n-----\n\nform or another.\n\nTo shed light on this loaded term, we grouped fileless threats into different categories.\n\nFigure 9. Taxonomy of fileless threats\n\nWe can classify fileless threats by their entry point (i.e., execution/injection, exploit,\nhardware), then the form of entry point (e.g., file, script, etc.), and finally by the host of the\ninfection (e.g., Flash, Java, documents).\n\nFrom this classification, we can glean three big types of fileless threats based on how much\nfingerprint they may leave on infected machines.\n\n**Type I: No file activity performed. A completely fileless malware can be**\nconsidered one that never requires writing a file on the disk.\n\n\n-----\n\n**Type II: No files written on disk, but some files are used indirectly. There are**\nother ways that malware can achieve fileless presence on a machine without requiring\nsignificant engineering effort. Fileless malware of this type do not directly write files on\nthe file system, but they can end up using files indirectly.\n**Type III: Files required to achieve fileless persistence. Some malware can have**\nsome sort of fileless persistence but not without using files in order to operate.\n\nHaving described the broad categories, we can now dig into the details and provide a\nbreakdown of the infection hosts. This comprehensive classification covers the panorama of\nwhat is usually referred to as fileless malware. It drives our efforts to research and develop\nnew protection features that neutralize classes of attacks and ensure malware does not get\nthe upper hand in the arms race.\n\n**Exploits** **Hardware** **Execution or injection**\n\nFile-based (Type III: Device-based File-based (Type III:\nexecutable, Flash, (Type I: network executables, DLLs, LNK\nJava, documents) card, hard disk) files, scheduled tasks)\nNetwork-based (Type CPU-based Macro-based (Type III:\nI) (Type I) Office documents)\n\nUSB-based Script-based (Type II: file,\n(Type I) service, registry, WMI repo,\nBIOS-based shell)\n(Type I) Disk-based (Type II: Boot\nHypervisor-based Record)\n(Type I)\n\nFor a detailed description and examples of these categories, visit this **comprehensive**\n**page on fileless threats.**\n\n## Defeating fileless malware with next-gen protection\n\nFile-based inspection is ineffective against fileless malware. Antivirus capabilities in\nWindows Defender ATP use defensive layers based on dynamic behavior and integrate with\nother Windows technologies to detect and terminate threat activity at runtime.\n\nWindows Defender ATP’s next-gen dynamic defenses have become of paramount importance\nin protecting customers from the increasingly sophisticated attacks that fileless malware\nexemplifies. In a previous blog post we described some of the offensive and defensive\n[technologies related to fileless attacks and how these solutions help protect our customers.](https://cloudblogs.microsoft.com/microsoftsecure/2017/12/04/windows-defender-atp-machine-learning-and-amsi-unearthing-script-based-attacks-that-live-off-the-land/)\nEvolving from the file-centric scanning model, Windows Defender ATP uses a generic and\nmore powerful behavior-centric detection model to neutralize generic malicious behaviors\nand thus take out entire classes of attack.\n\n|Exploits|Hardware|Execution or injection|\n|---|---|---|\n|File-based (Type III: executable, Flash, Java, documents) Network-based (Type I)|Device-based (Type I: network card, hard disk) CPU-based (Type I) USB-based (Type I) BIOS-based (Type I) Hypervisor-based (Type I)|File-based (Type III: executables, DLLs, LNK files, scheduled tasks) Macro-based (Type III: Office documents) Script-based (Type II: file, service, registry, WMI repo, shell) Disk-based (Type II: Boot Record)|\n\n\n-----\n\n### AMSI\n\n[Antimalware Scan Interface (AMSI) is an open framework that applications can use to](https://docs.microsoft.com/en-us/windows/desktop/AMSI/antimalware-scan-interface-portal)\nrequest antivirus scans of any data. Windows leverages AMSI extensively in JavaScript,\nVBScript, and PowerShell. In addition, [Office 365 client applications integrates with AMSI,](https://cloudblogs.microsoft.com/microsoftsecure/2018/09/12/office-vba-amsi-parting-the-veil-on-malicious-macros/)\nenabling antivirus and other security solutions to scan macros and other scripts at runtime to\ncheck for malicious behavior. In the example above, we have shown how AMSI can be a\npowerful weapon to fight fileless malware.\n\nWindows Defender ATP integrates with AMSI and consumes all AMSI signals for protection,\nthese signals are especially effective against obfuscation. It has led to the disruption of\nmalware campaigns like Nemucod. During a recent investigation, we stumbled upon some\nmalicious scripts that were heavily obfuscated. We collected three samples that were evading\nstatic signatures and are a mixture of barely recognizable script code and binary junk data.\n\nFigure 10. Heavy obfuscation of three different samples of TrojanDownloader:Script/Nemucod.JAC.\n\n\n-----\n\nHowever, after manual de-obfuscation, it turned out that these samples decode and execute\nthe same .js script payload, a known downloader:\n\nFigure 11: A portion of the second stage downloader decrypted by Nemucod.JAC\n\nThe payload does not have any obfuscation and is very easy to detect, but it never touches the\ndisk and so could evade file-based detection. However, the scripting engine is capable of\nintercepting the attempt to execute the decoded payload and ensuring that the payload is\npassed to the installed antivirus via AMSI for inspection. Windows Defender ATP has\nvisibility on the real payload as it’s decoded at runtime and can easily recognize known\npatterns and block the attack before it deals any damage.\n\n\n-----\n\nInstead of writing a generic detection algorithm based on the obfuscation patterns in the\nsamples, we trained an ML model on this behavior log and wrote heuristic detection to catch\nthe decrypted scripts inspected via AMSI. The results proved effective, catching new and\nunknown variants, protecting almost two thousand machines in a span of two months.\nTraditional detection would not have been as effective.\n\nFigure 12. Nemucod.JAC attack campaigns caught via AMSI\n\n### Behavior monitoring\n\nWindows Defender ATP’s behavior monitoring engine provides an additional layer of\nantivirus protection against fileless malware. The behavior monitoring engine filters\nsuspicious API calls. Detection algorithms can then match dynamic behaviors that use\nparticular sequences of APIs with specific parameters and block processes that expose known\nmalicious behaviors. Behavior monitoring is useful not only for fileless malware, but also for\ntraditional malware where the same malicious code base gets continuously repacked,\nencrypted, or obfuscated. Behavior monitoring proved effective against WannaCry, which\nwas distributed through the DoublePulsar backdoor and can be categorized as a very\ndangerous Type I fileless malware. While several variants of the WannaCry binaries were\nreleased in attack waves, the behavior of the ransomware remained the same, allowing\nantivirus capabilities in Windows Defender ATP to block new versions of the ransomware.\n\nBehavior monitoring is particularly useful against fileless attacks that live off the land. The\n[PowerShell reverse TCP payload from Meterpreter is an example: it can be run completely on](https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/)\na command line and can provide a PowerShell session to a remote attacker.\n\nFigure 13. Example of a possible command line generated by Meterpreter\n\n\n-----\n\nThere s no file to scan in this attack, but through behavior monitoring in its antivirus\ncapabilities, Windows Defender ATP can detect the creation of the PowerShell process with\nthe particular command line required. Behavior monitoring detects and blocks numerous\nattacks like this on a daily basis.\n\nFigure 14. Detections of the PowerShell reverse TCP payload\n\nBeyond looking at events by process, behavior monitoring in Windows Defender ATP can\nalso aggregate events across multiple processes, even if they are sparsely connected via\ntechniques like code injection from one process to another (i.e., not just parent-child\nprocesses). Moreover, it can persist and orchestrate sharing of security signals across\nWindows Defender ATP components (e.g., endpoint detection and response) and trigger\nprotection through other parts of the layered defenses.\n\nBehavior monitoring across multiple processes is not only an effective protection against\nfileless malware; it’s also a tool to catch attack techniques in generic ways. Here is another\nexample where multi process behavior monitoring in action, Pyordono.A is a detection based\non multi-process events and is aimed at blocking scripting engines (JavaScript, VBScript,\nOffice macros) that try to execute cmd.exe or powershell.exe with suspicious parameters.\nWindows Defender ATP telemetry shows this detection algorithm protecting users from\nseveral campaigns.\n\n\n-----\n\nFigure 15. Pyordono.A technique detected in the wild\n\nRecently, we saw a sudden increase in Pyordono.A encounters, reaching levels way above the\naverage. We investigated this anomaly and uncovered a widespread campaign that used\nmalicious Excel documents and targeted users in Italy from September 8 to 12.\n\n\n-----\n\nFigure 16. Malicious Excel document with instructions in Italian to click “Enable content”\n\nThe document contains a malicious macro and uses social engineering to lure potential\nvictims into running the malicious code. (Note: We have recently integrated Office 365\nclients apps with AMSI, enabling antivirus solutions to scan macros at runtime to check for\nmalicious content).\n\n\n-----\n\nFigure 17. The obfuscated macro code attempts to run an obfuscated Cmd command which in turns\n\nexecutes an obfuscated Powershell script. In the end, the Ursnif trojan is delivered.\n\nThe macro makes use of obfuscation to execute a cmd command, which is also obfuscated.\nThe cmd command executes a PowerShell script that in turn downloads additional data and\n[delivers the payload, infostealing Ursnif. We recently reported a small-scale Ursnif campaign](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?name=win32/ursnif)\nthat targeted small businesses in specific US cities. Through multi-process behavior\nmonitoring, Windows Defender ATP detected and blocked the new campaign targeting users\nin Italy using a generic detection algorithm without prior knowledge of the malware.\n\n### Memory scanning\n\nAntivirus capabilities in Windows Defender ATP also employ memory scanning to detect the\npresence of malicious code in the memory of a running process. Even if malware can run\nwithout the use of a physical file, it does need to reside in memory in order to operate and is\ntherefore detectable by means of memory scanning. An example is the GandCrab\n[ransomware, which was reported to have become fileless. The payload DLL is encoded in a](https://isc.sans.edu/diary/rss/23321)\n[string, then decoded and run dynamically via PowerShell. The DLL itself is never dropped on](https://www.defcon.org/images/defcon-21/dc-21-presentations/Bialek/DEFCON-21-Bialek-PowerPwning-Post-Exploiting-by-Overpowering-Powershell.pdf)\nthe disk. Using memory scanning, Windows Defender ATP can scan the memory of running\nprocesses and detect known patterns of the ransomware run from the stealthy DLL.\n\nMemory scanning, in conjunction with behavior monitoring and other dynamic defenses,\n[helped Windows Defender ATP to disrupt a massive Dofoil campaign. Dofoil, a known nasty](https://cloudblogs.microsoft.com/microsoftsecure/2018/03/07/behavior-monitoring-combined-with-machine-learning-spoils-a-massive-dofoil-coin-mining-campaign/)\ndownloader, uses some sophisticated techniques to evade detection, including process\nhollowing, which allows the malware to execute in the context of a legitimate process (e.g.,\n_explorer.exe). To this day, memory scanning detects Dofoil activities._\n\n\n-----\n\nFigure 18. Detections of the memory-resident Dofoil payload\n\nMemory scanning is a versatile tool: when suspicious APIs or behavior monitoring events are\nobserved at runtime, antivirus capabilities in Windows Defender ATP trigger a memory scan\nin key points it is more likely to observe (and detect) a payload that has been decoded and\nmay be about to run. This gives Windows Defender ATP granular control on which actions\nare more interesting and may require more attention. Every day, memory scanning allows\nWindows Defender ATP to protect thousands of machines against active high-profile threats\nlike Mimikatz and WannaCry.\n\n### Boot Sector protection\n\nWith [Controlled folder access on Windows 10, Windows Defender ATP does not allow write](https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-exploit-guard/controlled-folders-exploit-guard?ocid=cx-blog-mmpc)\n[operations to the boot sector, thus closing a dangerous fileless attack vector used by Petya,](https://cloudblogs.microsoft.com/microsoftsecure/2017/06/27/new-ransomware-old-techniques-petya-adds-worm-capabilities/?source=mmpc)\n[BadRabbit, and](https://cloudblogs.microsoft.com/microsoftsecure/2017/12/11/detonating-a-bad-rabbit-windows-defender-antivirus-and-layered-machine-learning-defenses/) [bootkits in general. Boot infection techniques can be suitable for fileless](https://attack.mitre.org/wiki/Technique/T1067)\nthreats because they can allow malware to reside outside of the file system and gain control\nof the machine before the operating system is loaded. The use of rootkit techniques, like in\n[the defunct Alureon malware (also known as TDSS or TDL-4), can then render the malware](https://en.wikipedia.org/wiki/Alureon)\ninvisible and extremely difficult to detect and remove. With Controlled folder access, which is\npart of Windows Defender ATP’s attack surface reduction capabilities, this entire class of\n[infection technique has become a thing of the past.](https://cloudblogs.microsoft.com/microsoftsecure/2017/06/27/new-ransomware-old-techniques-petya-adds-worm-capabilities/?source=mmpc)\n\nFigure 19. Control Folder Access preventing a boot sector infection attempted by Petya\n\n### Windows 10 in S mode: Naturally resistant to fileless attacks\n\n\n-----\n\n[Windows 10 in S mode comes with a preconfigured set of restrictions and policies that make](https://www.microsoft.com/en-us/windows/s-mode)\nit naturally protected against a vast majority of the fileless techniques (and against malware\nin general). Among the available security features, the following ones are particularly\neffective against fileless threats:\n\nFor executables: Only Microsoft-verified applications from the Microsoft Store are allowed to\nrun. Furthermore, Device Guard provides User Mode Code Integrity (UMCI) to prevent the\nloading of unsigned binaries.\n\nFor scripts: [Scripting engines are not allowed to run (including JavaScript, VBScript, and](https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-10s-security)\nPowerShell).\n\nFor macros: Office 365 does not allow the execution of macros in documents from the\ninternet (for example, documents that are downloaded or received as attachment in emails\nfrom outside the organization).\n\nFor exploits: [Exploit protection and Attack surface reduction rules are also available on](https://cloudblogs.microsoft.com/microsoftsecure/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/?ocid=cx-blog-mmpc?source=mmpc)\nWindows 10 in S mode as a consistent barrier against exploitation.\n\nWith these restrictions in place, Windows 10 in S mode devices are in a robust, locked down\nstate, removing crucial attack vectors used by fileless malware.\n\n## Conclusion\n\nAs antivirus solutions become better and better at pinpointing malicious files, the natural\nevolution of malware is to shift to attack chains that use as few files as possible. While fileless\ntechniques used to be employed almost exclusively in sophisticated cyberattacks, they are\nnow becoming widespread in common malware, too.\n\nAt Microsoft, we actively monitor the security landscape to identify new threat trends and\ndevelop solutions that continuously enhance Windows security and mitigate classes of\nthreats. We instrument durable generic detections that are effective against a wide range of\nthreats. Through AMSI, behavior monitoring, memory scanning, and boot sector protection,\nwe can inspect threats even with heavy obfuscation. Machine learning technologies in the\ncloud allow us to scale these protections against new and emerging threats.\n\nSecurity solutions on Windows 10 integrate into a unified endpoint security platform in\n[Windows Defender Advanced Threat Protection. Windows Defender ATP includes attack](https://www.microsoft.com/en-us/windowsforbusiness/windows-atp?ocid=cx-blog-mmpc)\nsurface reduction, next-generation protection, endpoint protection and response, auto\ninvestigation and remediation, security posture, and advanced hunting capabilities. To test\nhow Windows Defender ATP can help your organization detect, investigate, and respond to\nadvanced attacks, **[sign up for a free trial.](https://www.microsoft.com/en-us/windowsforbusiness/windows-atp?ocid=cx-blog-mmpc)**\n\n\n-----\n\nProtections against fileless and other threats are shared across Microsoft 365, which\nintegrate technologies in Windows, Office 365, and Azure. Through the Microsoft Intelligent\nSecurity Graph, security signals are shared and remediation is orchestrated across Microsoft\n365.\n\n**_Andrea Lelli_**\n\n_Windows Defender Research_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/AV Tech/Out of sight but not invisible - Defeating fileless malware with behavior monitoring AMSI and next-gen .pdf"
    ],
    "report_names": [
        "Out of sight but not invisible - Defeating fileless malware with behavior monitoring AMSI and next-gen .pdf"
    ],
    "threat_actors": [
        {
            "id": "a13b5ca4-fb52-44a9-aa5a-595eca6789ed",
            "created_at": "2022-10-25T15:50:23.4331Z",
            "updated_at": "2025-03-27T02:00:55.46701Z",
            "deleted_at": null,
            "main_name": "Sharpshooter",
            "aliases": [
                "Sharpshooter"
            ],
            "source_name": "MITRE:Sharpshooter",
            "tools": [
                "Rising Sun"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536212,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1661686890,
    "ts_modification_date": 1661686890,
    "files": {
        "pdf": "https://archive.orkl.eu/6910e14d267c15a9f95e89616bd5ba453b5125b4.pdf",
        "text": "https://archive.orkl.eu/6910e14d267c15a9f95e89616bd5ba453b5125b4.txt",
        "img": "https://archive.orkl.eu/6910e14d267c15a9f95e89616bd5ba453b5125b4.jpg"
    }
}