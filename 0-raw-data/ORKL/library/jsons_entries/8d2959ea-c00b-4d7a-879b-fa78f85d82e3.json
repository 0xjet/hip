{
    "id": "8d2959ea-c00b-4d7a-879b-fa78f85d82e3",
    "created_at": "2023-01-12T15:03:03.55605Z",
    "updated_at": "2025-03-27T02:15:38.138018Z",
    "deleted_at": null,
    "sha1_hash": "6a372a5e012239bb17cc3541dd5ce8508fbd828e",
    "title": "2021-12-28 - Cases of Lockis ransomware infection",
    "authors": "",
    "file_creation_date": "2022-05-28T23:19:41Z",
    "file_modification_date": "2022-05-28T23:19:41Z",
    "file_size": 4740396,
    "plain_text": "# 기업의 백신 잠금 정책 미사용으로 인한 Lockis 랜섬웨어 감염 사례\n\n**asec.ahnlab.com/ko/30284/**\n\n2021년 12월 28일\n\n지난 11월경 안랩의 한 고객사에서 다수의 서버가 Lockis 랜섬웨어에 감염된 사고가 발생했\n다. 피해 업체는 V3 백신을 사용하고 있었음에도 불구하고 랜섬웨어에 감염되어 감염 원인을\n파악하기 위해 안랩 A-FIRST가 투입돼 포렌식 분석을 수행했다.\n\nLockis 랜섬웨어는 [“ASEC 블로그 : Lockis 랜섬웨어와](https://asec.ahnlab.com/ko/30236/) 함께 사용된 해킹 툴” 포스팅에서 언급\n한 바와 같이 GlobImposter 랜섬웨어의 변종으로, 9월 16일에 최초 발견됐다.\n\n안랩에서는 2018년 5월경부터 GlobImposter 류의 랜섬웨어를 진단명\nTrojan/Win32.FileCoder로 진단하고 있었고, 9월 16일 등장한 Lockis 랜섬웨어도 진단이 가능\n한 상황이었다.\n\n피해 시스템에서 확인된 공격자의 공격 순서는 다음과 같다.\n\n1. RDP 연결 (로컬 Administrator 계정)\n2. 백신 언인스톨\n\nV3 Uninstall\n\n\n-----\n\n3. 해킹 툴 및 랜섬웨어 복사\n\nProcessHacker.exee\nNetscan.Chs.exe\ndControl.exe\nlockisdog.exe\n4. 해킹 툴 및 랜섬웨어 실행\n\ndControl.exe 실행\nNetscan.Chs.exe 실행\nProcessHacker.exe 실행\nlockisdog.exe 실행 (랜섬웨어)\n\n공격자는 랜섬웨어가 OS의 보안 기능이나, 보안 제품에 탐지돼 차단되는 것을 우회하기 위해\n랜섬웨어를 실행하기 전 V3 백신을 언인스톨 하고, Windows Defender를 비활성화 했으며, 방\n해되는 프로세스를 종료시키기 위해 ProcessHacker를 사용했다.\n\n즉, 랜섬웨어가 안전(?)하게 실행될 수 있도록 철저히 준비 후 랜섬웨어를 실행시킨 것이다.\n\n이러한 방식의 공격이 가능한 이유는 우선 Administrator 계정으로 RDP 접속해 관리자 권한으\n로 시스템을 GUI 제어할 수 있었던 것이 1차적인 원인이며, 보안 제품의 임의 삭제가 가능한\n것이 2차적인 원인일 것이다. 관리자 권한을 가진 사용자는 시스템에서 거의 모든일을 수행할\n수 있는 관리자이므로 당연히 백신을 언인스톨 하는 것이 가능하다.\n\n따라서, 기업 환경에서는 이와 같이 IT 인프라 부서에서 설치 혹은 설정한 보안 기능들이 무력\n화되지 않도록 보안 제품의 언인스톨 혹은 설정 등을 사용자가 임의로 변경하지 못하도록 해\n야 한다.\n\n안랩 APC는 V3 제품의 삭제나 설정 변경 등을 제한하기 위해 ‘잠금 설정’ 기능을 제공하고 있\n으나, 아쉽게도 해당 업체에는 잠금 정책을 사용하고 있지 않았다.\n\n[그림] 안랩 APC의잠금설정적용화면\n\n\n-----\n\n## 결론\n\n백신을 사용 중임에도 백신의 보호를 받지 못한 이유는 백신의 ‘잠금 설정’ 정책이 적용\n돼 있지 않았기 때문이다.\n기업 보안 담당자는 자사에 적용된 보안 제품이 임의로 삭제되거나, 설정이 변경되지 않\n도록 해당 제조사에서 제공되는 잠금 기능을 반드시 활성화 하도록 하자.\n\n**[파일** 진단]\n\nTrojan/Win32.FileCoder\nHackTool/Win.NetScan\nHackTool/Win.Disabler\nTrojan/BAT.Delete\n\n**[IOC 정보]**\n\n58c8c8c3038a5fbca2202248a1101da0\n48755f2d10f7ff1050fbd081f630aaa3\n230c143d283842061b14967d4df972d0\n0a50081a6cd37aea0945c91de91c5d97\n116e1e7a0c8d3ff9175b87927d188835\n\n## 관련글\n\n동일한 패스워드가 설정된 Local Administrator 계정을 사용하는 기업의 랜섬웨어 감염 사례 –\nASEC BLOG\nASEC 분석팀은 최근 Lockis 랜섬웨어 감염 피해를 입은 업체의 피해 시스템들을 분석한 결과,\n공격자가 피해 시스템들에 로컬 Administrator 계정으로 RDP 접속 후 랜섬웨어를 실행시킨 것\n\n\n-----\n\n을 확인했다. 피해 시스템들의 로컬 Administrator 정보를 조사한 결과, 1~2년동안 패스워드를\n변경하지 않았으며, 모두 동일한 패스워드가 설정돼 있는 것으로 확인됐다. 게다가 해당\nNTLM 해시를 복호화한 결과 Administrator 계정의 평문 패스워드는 `1qazxcv 인 것으로 확인\n됐다. 이 패스워드 문자열은 영…\n\nLockis 랜섬웨어와 함께 사용된 해킹 툴 – ASEC BLOG\n안랩 A-FIRST는 지난 11월경 Lockis 랜섬웨어에 감염된 피해 시스템을 대상으로 포렌식 분석\n을 수행했다. Lockis 랜섬웨어는 러시아 공격 그룹인 TA505가 사용하는 GlobeImposter 랜섬\n웨어의 변종으로, 지난 9월 16일 처음 등장했다. GlobeImposter 랜섬웨어는 2017년 2월에 처\n음 등장한 이래로 꾸준히 변종이 증가해 현재까지 총 192개의 변종이 발견됐다. 공격자는 랜\n섬웨어 감염을 위해 악성 스팸 메일 발송, 익스플로잇 공격, RDP 접속 등의 공격 기법을 사용\n하는 것으로 알려져 있다. 현재 Lo…\n연관 IOC 및 관련 상세 분석 정보는 안랩의 차세대 위협 인텔리전스 플랫폼 ‘AhnLab TIP’ 구\n독 서비스를 통해 확인 가능하다.\n\n[Categories:미분류,](https://asec.ahnlab.com/ko/category/uncategorized-ko/) [악성코드](https://asec.ahnlab.com/ko/category/malware/) 정보, 침해사고 [분석](https://asec.ahnlab.com/category/%ec%b9%a8%ed%95%b4%ec%82%ac%ea%b3%a0-%eb%b6%84%ec%84%9d-%ec%82%ac%eb%a1%80/) 사례\n\n\n-----\n\n[Tagged as:Forensics,](https://asec.ahnlab.com/tag/forensics/) [침해사고,](https://asec.ahnlab.com/tag/%ec%b9%a8%ed%95%b4%ec%82%ac%ea%b3%a0/) [Lockis](https://asec.ahnlab.com/tag/lockis/)\n\n\n-----",
    "language": "KO",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-28 - Cases of Lockis ransomware infection.pdf"
    ],
    "report_names": [
        "2021-12-28 - Cases of Lockis ransomware infection.pdf"
    ],
    "threat_actors": [
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535783,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1653779981,
    "ts_modification_date": 1653779981,
    "files": {
        "pdf": "https://archive.orkl.eu/6a372a5e012239bb17cc3541dd5ce8508fbd828e.pdf",
        "text": "https://archive.orkl.eu/6a372a5e012239bb17cc3541dd5ce8508fbd828e.txt",
        "img": "https://archive.orkl.eu/6a372a5e012239bb17cc3541dd5ce8508fbd828e.jpg"
    }
}