{
    "id": "a7b6fcc3-80c1-4472-b06b-f137d0c05002",
    "created_at": "2022-10-25T16:48:20.117202Z",
    "updated_at": "2025-03-27T02:17:22.926707Z",
    "deleted_at": null,
    "sha1_hash": "e9f32f7b199787f8b8bb42c90054f2db6a1fee0f",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-11-13T04:15:09Z",
    "file_modification_date": "2020-11-13T04:15:09Z",
    "file_size": 3654235,
    "plain_text": "# CRAT wants to plunder your endpoints\n\n**[blog.talosintelligence.com/2020/11/crat-and-plugins.html](https://blog.talosintelligence.com/2020/11/crat-and-plugins.html)**\n\n[By Asheer Malhotra.](https://twitter.com/asheermalhotra)\n\nCisco Talos has observed a new version of a remote access trojan (RAT) family known\nas CRAT.\nApart from the prebuilt RAT capabilities, the malware can download and deploy\nadditional malicious plugins on the infected endpoint.\nOne of the plugins is a ransomware known as \"Hansom.\"\nCRAT has been attributed to the Lazarus APT Group in the past.\nThe RAT consists of multiple obfuscation techniques to hide strings, API names,\ncommand and control (C2) URLs and instrumental functions, along with static\ndetection evasion.\nThe attack also employs a multitude of anti-infection checks to evade sandbox based\ndetection systems.\n\n## What's new?\n\nCisco Talos has recently discovered a new version of the CRAT malware family. This version\nconsists of multiple RAT capabilities, additional plugins and a variety of detection-evasion\ntechniques. In the past, CRAT has been attributed to the Lazarus Group, the malicious threat\nactors behind multiple cyber campaigns, including attacks against the entertainment sector.\n\n\n-----\n\nIndicators and tactics, techniques and procedures (TTPs) discovered by this investigation\nresemble those of the Lazarus Group.\n\n## How did it work?\n\nThe attack consists of a highly modular malware that can function as a standalone RAT and\ndownload and activate additional malicious plugins from its C2 servers. Cisco Talos has\ndiscovered multiple plugins so far, consisting of ransomware, screen-capture, clipboard\nmonitoring and keylogger components.\n\n## So what?\n\nThis attack demonstrates how the adversary operates an attack that:\n\nUses obfuscation and extensive evasion techniques to hide its malicious indicators.\nHas evolved across versions to achieve effectiveness of their attack.\nEmploys a highly modular plugin framework to selectively infect targeted endpoints.\nMost importantly, it deploys RAT malware to ransack the endpoint, followed by\ndeployment of ransomware to either extort money or burn infrastructure of targeted\nentities.\n\n## Distribution vector\n\n[The first version of CRAT has been known to be distributed via malicious HWPs. The HWPs](https://otx.alienvault.com/pulse/5e8edeec3c1da2b0f89707aa)\nmasquerade as a COVID-19 themed document pertaining to an infectious disease\nmanagement support group from South Korea. The HWPs consisted of an exploit for CVE2017-8291 used to activate malicious shellcode. The shellcode would then download and\nexecute CRATv1 on the infected endpoint.\n\nThe distribution vector of the new version of CRAT (v2) is currently unknown. However, it is\nhighly likely the attackers may have re-used a maldoc-based infection vector to spread\nCRATv2 as well.\n\n\n-----\n\nMalicious HWP document - downloader for CRATv1\n\n\n-----\n\nShellcode executing PowerShell to download and activate CRATv1 via regsvr32.\n\n## Obfuscation\n\nBefore we analyze the attack it is important to understand the extensive measures taken by\nthe attackers to conceal the RAT executables. The RAT is highly obfuscated in terms of:\n\nString Obfuscation: Almost all of the strings are obfuscated using a four-byte XOR key\nand subsequent base64 encoding. String obfuscations are used to thwart string-based\nstatic malware detection signatures.\nAPI Resolution: All APIs used are resolved dynamically. The process of selecting the\nAPI to call is also a cumbersome algorithm (overkill) involving index tables, switch\ncases and API name deobfuscation. This technique is used to make analysis\ncumbersome for an analyst by hiding API call sequences.\nRuntime Code Patching: The malware consists of a select few instrumental subroutines\nthat are decoded, executed and then patched/encoded again (during runtime). On-thefly patching of subroutines/functions may be aimed towards evading detection\nmechanisms that scan process memory to identify malicious strings and code.\n\n**Why the occurrence of multiple obfuscations?**\n\nThe use of multiple obfuscations signifies the attackers confidence in selective obfuscation\nrather than the use of packers as a means of evasion. Many detection systems look for the\npresence of a packer using techniques such as entropy analysis, Import API analyses, etc.\nSelective obfuscation of code and strings prevents these systems from detecting the malware\nsolely on the basis of the obfuscations.\n\nIt is also likely that this group of attackers employs a modular build system that obfuscates\ndifferent aspects of malware. Different modules can thus be used in conjunction to produce a\ncombination of obfuscations for the same malware.\n\n**Masquerading as legitimate**\n\nThe attackers have also used file names and export API names in the CRAT DLLs to\nmasquerade the RAT as a benign application's library. Some examples of the exported\nfunction names are:\n\nConfigChrome\nDownloadChrome\n\n\n-----\n\nGetChromeVersion\nInstallChrome\nUninstallChrome\nUpdateChrome\nInstallFirefox\nSaveMicrosoftEdge\nExtractMicrosoftEdge\nExtractMicrosoftWord\n\n## Anti-Infection Checks\n\nThe implant performs checks to verify its execution on an allowed endpoint. The implant\nuses a variety of criteria to identify a blocklisted system by utilizing:\n\nProcess name blocklists\nNetwork adapter name blocklists\nMAC Address blocklists\nAnalysis tool names blocklists\n\nThe implant also checks for indicators that the process is being debugged (including\nCheckRemoteDebuggerPresent). If the infected endpoint fails any of the anti-infection\nchecks, the implant quits execution. The blocklists are provided at the end of this post.\n\n## Finding the right process — Sweet Home Alabama\n\nThe CRAT DLL ensures it resides in the desired process on the infected endpoint. Depending\non the MS Windows OS version, it will inject and reflectively-load itself into the right\nprocess. The processes trojanized by CRAT v2 are:\n\nWin10:\n\nsihost.exe\ntaskhostw.exe\nApplicationFrameHost.exe\nsvchost.exe\n\nWin 6.1:\n\ndwm.exe\ntaskhostex.exe\nsvchost.exe\nnotepad.exe\n\nOther Win 6.x:\n\ndwm exe\n\n\n-----\n\ntaskhost.exe\nsvchost.exe\nnotepad.exe\n\nOS agnostic injection fall back process: explorer.exe\n\n## Communication mechanisms\n\nBefore detailing CRAT's capabilities, it is important to illustrate the communication\nmechanism used by CRAT to talk to its C2 servers.\n\nBoth versions of CRAT use HTTP to communicate with the C2 servers. The data sent to the\nC2 is in the form of URL-encoded form data and may consist of 3 types of requests:\n\nLogin: Login/check-in with the C2 to register the infected endpoint.\nQuestion: Request a command code to execute a malicious RAT functionality on the\nendpoint.\nAnswer: Respond to the C2's command with the output of the executed RAT\nfunctionality.\n\nThe HTTP GET/POST requests are sent to the C2 URLs appended with a 'timestamp' value:\nhttp(s)://<C2_url>?ts=<epoch_time>_<rand>\n\n**Exfiltration Mechanism**\n\nCRAT uses the following algorithm to encode the data before sending it out via the HTTP\nPOST request:\n\n1. Generate a random four-byte value (DWORD).\n2. XOR the data to be exfiltrated with the DWORD.\n3. Base64-encode (std alphabet) the XOR key and the XORed data to achieve the final\n\nform of the data.\n4. Exfiltrate the encoded data as URL encoded form data.\n\nThe format of the response to the C2 is:\n\ncode=answer&token=<token>&content=<base64_encoded_data>frags=\n<fragment_count>&limit=10\n\nWhere:\n\ncode = type of the communication being done. Values include:\n\nlogin = login request to C2 from implant\nquestion = request command to be processed\nanswer = response to command executed\n\n\n-----\n\ntoken = a token value sent by the C2 as a response to the login (session identifier)\ncontent = the actual base64-encoded + XORed data being exfiltrated\nfrags = number of fragments of data being POSTed to the C2\nlimit = retry count in case of failure to send\n\nThe C2 server will respond with a JSON containing command codes and supporting data to\nbe recognized by the implant to execute a corresponding RAT capability.\n\n## RAT capabilities\n\nThe CRAT malware consists of multiple RAT capabilities that allow it to be highly versatile\nand dangerous. CRAT executes these capabilities by receiving command codes and\ncorresponding data from the C2 in the form of JSONs communicated over HTTP.\n\nApart from the introduction of a wide variety of new RAT capabilities in CRAT version 2 (vs\nCRAT version 1), the biggest update is the spin-off of key RAT capabilities into plugin\nmodules. These plugins (DLLs) are downloaded on-the-fly by CRATv2 and injected into\nspecific processes running on the infected endpoint.\n\nThe following capabilities have been observed in CRATv2.\n\n**Collect System Information**\n\nCollects the following system information:\n\nInstalled AntiVirus software names\nInstalled FirewallProduct names\nDomain Names:\n\nNetbios domain name\nDNS domain name\nDomain forest name\n\nFile version number from DLLs embedded Version Information\nPath to the system folder\nFlag if the current user has administrative privileges\n\nImplant checking for ADMIN privileges\n\nTCP/IP enabled MAC Addresses using WMI query:\n\n\n-----\n\nwmic PATH Win32_NetworkAdapterConfiguration WHERE IPEnabled=TRUE GET\nMACAddress.\n\nImplant replacing strings in the output of the WMIC command to obtain only the MAC\nAddresses\n\n**Enumerate drives and gather file size information**\n\nCollects size information about all files and folders on the infected endpoint except:\n\nRecycle Bin\n%windir%\n\nThe data gathered is arranged into a specific format:\n\n<Drive_Letter>\\t<Disk_Type>\\r\\n\n\n[DIR]\\t<Folder_Path>\n\n\\t<File_Name><spaces><size_in_bytes> bytes\n\nWhere Disk Type =\n\nLocal Disk\n\n\n-----\n\nCD ROM\nRemovable Disk\nRemote Disk\nRAM Disk\nUnknown Disk\n\nE.g.\nSnippet of drive and file size information\ngathered by the implant.\n\n**Enumerate Drives using dir**\n\nEnumerate drives using the 'dir' command:\n\ncmd /c \"dir <drive_name> /s >> %temp%\\<custom_prefix>error.log\"\n\nWhere custom_prefix = file name prefix specified by the C2\n\nE.g. cmd /c \"dir C:\\ /s >> C:\\Users\\<username>\\AppData\\Local\\Temp\\BLAHerror.log\"\n\nImplant constructing the dir cmd to be executed.\n\nThe log file is then rolled up into a \".rar\" archive using a pre-existing installation of a RAR\narchiver program using the command:\n\n<rar_utility> a -k -r -s -ibck -m5 <output_rar_filepath> <input_log_filepath>\n\nThe RAR archive is then read to memory and exfiltrated to the C2, followed by deletion of the\n.rar and log files.\n\n**Read and write file**\n\n\n-----\n\nCRAT has the capability to read the contents of the file specified by the C2 and exfiltrate\nthese to the C2. The write file capability consists of writing the data received from the C2 to a\ntemporary file in the %temp% folder: %temp%\\<temp_name>.tmp\n\nThe implant will also timestomp the tmp file to either a hardcoded value or copy the filetimes\nfrom a system file such as %windir%\\system32\\user32.dll.\n\n**Execute commands**\n\nExecute commands with two variations of the functionality:\n\nSimply execute the command on the endpoint.\nExecute a command and send output of command to C2.\n\n**Reverse Shell**\n\nOpen up a reverse command shell for arbitrary command execution using Windows pipes.\n\n**Set query times**\n\nThis capability allows the C2 to specify delays between consecutive command queries from\nthe implant to the C2 for:\n\nReceiving commands from the C2.\nReceiving arbitrary commands to execute in the reverse shell.\n\n**Steal browser passwords: ChromePass**\n\nExecute chromepass.exe with the /stext switch to obtain the usernames and passwords\nstored in Google Chrome. The credentials are dumped to a text file which is read and\nexfiltrated to the C2.\n\nCommand format: chromepass.exe /stext <output_filepath>\n\n**File explorer**\n\nCRAT contains a RAT functionality that implements a custom-built File Explorer submodule.\n\nThe C2 specifies the parent functionality command code and an additional sub-command\ncode to specify the sub-capability to be executed in the file explorer. The file explorer submodule contains the following sub-capabilities:\n\nGather free and total disk space information for each drive on the system.\nEnumerate file listings (recursively) in a given directory.\nMove files across locations.\nFind and remove files and folders.\nCreate RAR archive files from files specified.\nCreate RAR archives and exfiltrate file contents to C2.\n\n\n-----\n\nExecute arbitrary commands specified by C2 on the endpoint.\n\n**Plugin administration**\n\nDownloads and installs a malicious plugin from the C2. The plugin is placed in a standard\ndirectory specified by the C2, and locations may include:\n\n%PUBLIC%\\Documents\n%USERPROFILE%\\Downloads\n%PUBLIC%\\Music\n%PUBLIC%\\Pictures\n%PUBLIC%\\Videos\n%windir%\n%windir%\\system32\n%APPDATA% (%USERPROFILE%\\AppData\\Roaming)\n\nCRAT can also administer the malicious plugins by performing the following actions:\n\nFor EXE based plugins:\n\nExecute plugin as an independent process.\n\nFor DLL plugins:\n\nActivate using regsvr32.exe\nActivate using rundll32.exe\nReflective load into its own process\nReflectively load into a target process\nDelete files related to plugins\n\n**Uninstall CRAT**\n\nThe RAT comes with an uninstallation routine built into it as well. This routine can be\ntriggered in response to a command issued by the C2 or if the endpoint fails its anti-infection\nchecks. The uninstallation routine consists of:\n\nDeleting .exe and .lnk files associated with the RAT.\nSending the uninstall flag to the communications pipe.\nDelete associated plugin files (EXEs and DLLs) from the endpoint.\n\n**Additional capabilities**\n\nIn addition to the RAT capabilities, CRAT also consists of additional functionalities that are\nimplemented as part of independent threads in the infected process:\n\nSend Heartbeat Thread: This will send four bytes of data periodically to a named pipe.\nUpload File Thread: This thread will periodically send the contents of a file to the C2\nserver over HTTP. The contents of either the Keylogger or Clipboard monitor files are\nread and sent to the C2.\n\n\n-----\n\nUpload Screen Thread: This thread reads and sends the contents of another file to the\nC2 server over HTTP. Most likely the content of screenshots taken by the Screen\nRecorder plugin.\n\n## CRATv2 plugins\n\nWith version 2, the attackers have evolved CRAT into a modular RAT with the ability to\ndownload and activate additional malicious plugins (DLLs) on the infected endpoint. The\nfirst version of CRAT had these plugin capabilities implemented within the RAT. Cisco Talos\nhas discovered these capabilities so far:\n\nScreen capture plugins\nClipboard monitor plugins\nKeylogger plugins\nRansomware\n\n**Screen capture plugin**\n\nThe screen capture plugin will capture the current foreground window (every second or so)\nand save the screenshot to a .tmp file in a hardcoded directory. The screenshot is saved in\nTIFF file format. Since TIFF is widely supported by scanning and faxing systems, the\nmalicious screenshots may be mis-identified as document scans by a forensic analyst instead\nof malicious screen captures.\n\nThe saved screenshot file is also XORed using a variable length XOR key hardcoded into the\nplugin as saved to add a further layer of obfuscation.\n\nSample screenshot captured by the plugin\n\n**Clipboard monitor plugin**\n\nThis plugin will read the clipboard data and write the contents of the clipboard to a log file.\nThe format of the clipboard data logged is:\n\n\\r\\n[YYYY-mm-DD HH:MM:SS]\\r\\n<clipboard_data>\n\nThe data is stored in a seemingly benign file location such as:\n%localappdata%\\Google\\Chrome\\Application\\Update.chk\n\nClipboard monitor implant getting clipboard data.\n\n**Keylogger plugin**\n\nThe keylogger plugin monitors the state of all the alphanumeric keys pressed. It also logs the\nfollowing keys:\n\nCtrl\nShift\n\n\n-----\n\nMenu\nAlt\nEnter\nTab\nBackspace\nCapslock\nDelete\nEnd\nHome\nUp\nDown\nLeft\nRight\nFunction keys\n\nThe keystrokes are logged to another seemingly benign file on the endpoint such as:\n%localappdata%\\Google\\Chrome\\Application\\Update.cert\n\nThe format of the log file is:\n\\r\\n[<Window_Name> - YYYY-mm-DD HH:MM:SS]\\r\\n<keylogger_data>\n\\r\\n[YYYY-mm-DD HH:MM:SS]\\r\\n<keylogger_data>\n\nExample:\n\n[Untitled - Notepad - 2020-06-05 01:02:03]\nThese keystrokes are being recorded[ENTER]\n\n[Blah - 2020-06-05 01:02:03]\n\n[CTRL] + c\n\nKeywords used to log keys being pressed.\n\n\n-----\n\n-----\n\n## Ransomware plugin — Hansom\n\nWe also discovered a ransomware plugin that encrypts specific file extensions on the infected\nendpoint. Traditionally ransomware encrypts files on the infected endpoint using a\ncombination of asymmetric and symmetric encryption. This plugin is different.\n\nIt locks files into individually created archives using randomly generated passwords. The\npasswords are then encrypted using an embedded public key (part of an embedded pub\ncertificate). Once the infected user gets access to the private key (after the ransom has been\npaid), the private key can be plugged into the accompanying decryptor .exe that decrypts the\narchive passwords and subsequently unpacks the original files from the archive.\n\nThe plugin performs the following housekeeping actions before it begins encrypting files on\nthe endpoint:\n\nTerminate specific application processes.\n\nSuppress Windows Defender notifications by setting registry value:\nHKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\UX Configuration |\nNotification_Suppress = 0x1\n\nTerminate Windows Defender process \"MsMpEng.exe\" specifically.\n\nDisable task manager via registry:\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System |\nDisableTaskMgr = 0x1\n\nSetup persistence for self via registry and regsvr32:\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run | HANSOM = regsvr32.exe\n/s <filepath_to_ransomware_dll>\n\n**Targeted File Extensions**\n\nThe following file extensions are targeted by the ransomware plugin. The ransomware\nexcludes certain file and folder names from encryption to ensure the stability of the\nOperating System (listed in the IOCs section).\n\ndoc,docx,ppt,pps,pptx,xls,xlsx,mdb,chm\ntxt,log,pdf,hwp,hst,ods,odt,rtf,csv,hwpml,show,eps,epub,eml\nhtm,html,js,css,vbs,php,jsp,xml,asp,aspx\nasm,java,c,cpp,cs,h,m,3ds,max,dwg,cad\nrar,zip,alz,tar,tgz,gz,7z,iso,bz2,bzip2,arj,arc,ace,xz,lz\njpg,jpeg,png,bmp,tiff,gif,psd,ai,fla,ppm,xbm\n\n\n-----\n\nexe,dll,jar,war,bat,py,pl,apk,msi,ocx,cmd\ndb,frm,myd,myi,mdf,sdf,dbf,sql,sqlite3,dat\ncer,crt,der,p7b,p7c,p12,pfx,pem,csr,key\nini,inf,reg,bak,ldf,config,conf,cka,au3\n\n**Ransomware Encryption Algorithm**\n\nThe plugin uses the following sequence of steps to encrypt/lock files on the infected\nendpoint:\n\n1. Create a password by generating random 0x48 bytes and base64 encoding them. Then\n\ntake the target file and add it to a password-protected RAR archive using command:\n\n\"C:\\Users\\<username>\\AppData\\Roaming\\WinRar\\Rar.exe\" a -y -ep -k -r -s -ibck -df\n-m0 -hp<password> -ri1:250 \"<target_filepath>.rar\" \"<target_filepath>\"\n\nThis command also deletes the target file once it has been added to the archive.\n\n2. After the target file has been archived, the random password used for the creation of\n\nthe RAR archive is encrypted using an embedded RSA public key.\n\n3. The encrypted password blob is appended to the archive along with a marker indicating\n\nthat the file has been encrypted successfully. The marker used is:\n\n48 61 6E 73 6F 6D 32 30 30 38 20 20 07 29 Hansom2008 .)\n\n4. Then the RAR archive is renamed (via file move) to the name of the original file.\n\nE.g. C:\\blah\\abc.txt.rar is renamed back to C:\\blah\\abc.txt\n\n5. A ransom note is dropped in the target file's directory named HANSOM_README.txt\n\ninforming the user of the ransomware infection.\n\n\n-----\n\nRansom Note\n\nThe BTC addresses discovered so far do not hold any money (with no transactions made in or\nout of the BTC addresses).\n\n**Post-Processing Activities**\n\nThe ransomware plugin performs the following activities after it has encrypted all the\ntargeted files on the system:\n\n1. Create and encrypt sample files on desktop folder \"Hansom_Sample\" for\n\ndemonstrating the decryptor:\n\nsample.docx\nsample.jpg\nsample.pdf\nsample.zip\n2 Drop the decryptor exe to the current user's desktop as \"Hansom Decryptor exe\"\n\n\n-----\n\n3. Copy the ransom note JPG to C:\\Users\\Public\\Pictures\\hansom.jpg and set it as the\n\ncurrent wallpaper via registry.\nHansom ransomware wallpaper:\n\n4. Remove any registry based persistence mechanisms such as Run keys to prevent re\nencryption of files on startup.\n5. Delete disk shadow copies using wmic command: shadowcopy delete\n\nThe ransomware plugin also communicates with a C2 server URL, sending it details (as\nJSONs) such as:\n\nUnique ID of machine (generated similar to CRAT)\nRansom ID of the plugin\nNumber of files encrypted\nPrivilege level of the process, etc.\n\n## Loaders\n\nIn addition to the CRATv2 DLLs, Cisco Talos discovered multiple loaders related to the RAT\nfamily. This section provides an overview of these components.\n\n**EXE Loaders**\n\nThe EXE based loader serves two primary purposes:\n\n1. Establish persistence for itself using a scheduled task on the infected endpoint. Usually\n\nscheduled to run once every few minutes. The loader may also obtain persistence using\na registry RUN key.\n\n\n-----\n\n2. Perform anti-infection checks and inject the CRAT DLL into a target process.\n\n1. The CRAT DLL isn't dropped or downloaded by the .exe based loader to the\n\nendpoint.\n2. It simply reads the DLL from a hardcoded filepath, un-XORs it using a 4-byte key\n\nand the resulting DLL is reflectively injected into a specified target process.\n\nVariant #2\n\nThe latest variant of the EXE loader contains the following capabilities/upgrades:\n\n1. Establish persistence for itself using two mechanisms:\n\n1. Create and run a malicious service on the endpoint to run itself.\n2. Create a malicious LNK for itself which is persisted via a malicious RUN registry\n\nkey value.\n2. Read an implant (most likely CRATv2) into memory and reflectively load it into the\n\nloader's process space.\n\n**DLL Loaders**\n\nApart from EXE based loaders, this CRAT also uses DLL based loaders. The DLL loaders\ncarry out the same function of decoding the CRAT DLL and reflectively injecting it into a\nspecified process.\n\nThe differences are in the persistence techniques used:\n\nThe DLL loader copies itself to a specified directory and creates a LNK that activates\nthe loader via rundll32.exe\nThe LNK file is then persisted across reboots via the registry RUN key:\nHKCU\\Software\\Microsoft\\windows\\CurrentVersion\\Run | <Value_Name> =\n<LNK_filepath>\n\nVariant #2\n\nCisco Talos discovered another variant of the DLL-based loader that acts as a packager as\nwell. Depending on the option specified, the loader will either:\n\nActivate CRAT:\n\nActivate unpacked CRAT DLL:\n\nReflectively inject an existing CRAT DLL into a hardcoded process.\n\nUnpack and activate:\n\nExtract components of the attack from a RAR archive and execute an\naccompanying EXE file (Most likely used to load the CRAT DLL).\nThe extraction isn't carried out directly. This variant will create a VBS file to\nrun rar.exe to extract CRAT components. Syntax used:\n\n\n-----\n\nSet s = Wscript.CreateObject(\"Wscript.Shell\"): s.Run \"\"\"%s\"\" x -y -p%s \"\"%s\"\"\n\"\"%s\"\"\", 0, TRUE: s.Run \"\"\"%s\\%s\"\"\", 0: Set s = Nothing\n\nE.g.\n\nSet s = Wscript.CreateObject(\"Wscript.Shell\"): s.Run \"\"\"C:\\Users\\\n<username>\\AppData\\Roaming\\WinRar\\Rar.exe\"\" x -y -p[password] \"\"\n<path_to_rar_file>\\<filename>.rar\"\" \"\"<target_dir>\"\"\", 0, TRUE: s.Run \"\"\"\n<target_dir>\\<extracted_exe>.exe\"\"\", 0: Set s = Nothing\n\nJust like the previous DLL loader, this variant will create an LNK file to run\nthe VBS script upon reboot by setting up registry key:\nHKCU\\Software\\Microsoft\\windows\\CurrentVersion\\Run |\n<Value_Name> = <LNK_filepath>\n\nPackage CRAT: This variant of the loader also has the capability to create an archive\nfrom a specified file on disk. This functionality may be used to create deployment\npackages for another part of the infection chain. Syntax used:\n\n\"<path_to>\\Rar.exe\" a -k -r -s -ibck -m5 -df -ep -hp[password] \"\n<filepath_of_rar_archive_to_be_created>.rar\" \"<file_to_be_archived>\"\n\nInfection chain of CRATv2\n\n## Evolution Timeline of CRAT and Components\n\nThe earliest versions of CRAT discovered were compiled in April 2020. The following is a\ntimeline of events in the lifecycle of CRAT with the introduction/modification of its\ncomponents at different stages of the engineering process.\n\n**April 2020**\n\nEarliest known version of CRAT (v1) created. Limited capabilities and basic string\nobfuscation. Downloaded by malicious HWPs from an infected Wordpress website.\n\n**May 2020**\n\nThe following components were first built May 2020:\n\nEXE loader v1 in early May 2020.\nDLL loader v1 in late May 2020.\nCRATv2 seen for the first time in early May 2020.\nThree CRAT plugins seen for the first time in early May 2020.\n\nScreen Recorder.\n\n\n-----\n\nClipboard Monitor.\nKeylogger.\n\n**June 2020**\n\nDLL loader v2 first seen in June 2020.\n\n**July 2020**\n\nEXE loader v1 continues evolving to add more persistence mechanisms (LNK and\nregistry Run key combination) in July 2020.\nRansomware plugin - Hansom spotted in the wild.\n\n**August 2020**\n\nEXE loader v2 first seen in August 2020.\n\n**September 2020**\n\nLatest version of the Ransomware plugin spotted in mid September.\n\nThis timeline shows that the attackers have been busy developing a new component of the\ninfection chain almost every month since April 2020.\n\nA visual timeline of the evolution is presented here:\n\nVisual timeline of the evolution of the infection chain of CRAT.\n\n## Links to Lazarus\n\n[Attribution is hard. Although prior reporting has linked CRAT to Lazarus, there has been no](https://blog.talosintelligence.com/2020/08/attribution-puzzle.html)\nsolid evidence to back these claims. There are however some aspects of the attack that\nresemble Lazarus' practices:\n\n**Code Reuse - CRAT uses the same HTTP wrapper library used by other Lazarus**\nimplants such as Wild Positron and Rising Sun. Although this may be a weak\nattribution link, it does make sense for the group to reuse code they've had success with\nin the past.\n\n\n-----\n\n**Functionality Duplication - Lazarus tends to mix-and-match RAT capabilities and**\nperipheral functionalities to stitch together variations of the same implant. That is,\ndifferent obfuscations mechanisms, communication techniques and RAT capabilities\nare assembled together to create variations of the implant. This may cause duplication\nof certain functionalities.\n\nIn the case of CRAT, the occurrence of the same capability like 'execution of arbitrary\ncommands' multiple times as independent RAT commands and also as part of the File Explorer\nsub-module indicates a factory-based build approach for the implants. Although a weak link,\nthis process is still in sync with Lazarus' build paradigms.\n\n**[Ransomware Plugin - Lazarus has been known to distribute ransomware as a means](https://securelist.com/lazarus-on-the-hunt-for-big-game/97757/)**\nof sponsoring their malicious activities. The BTC addresses used by the ransomware\nplugin in the case of CRAT (Hansom Ransomware) do not currently hold any funds.\nThus, it is unclear whether this module is in fact ransomware or a pseudo-ransomware\n(posing as ransomware but meant to burn endpoints).\n\n**Wordpress C2s - CRAT uses Wordpress based websites to act as its C2 servers. This**\n[practice is in sync with Lazarus' TTPs of using Wordpress websites to place C2 modules](https://blog.alyac.co.kr/3018)\nthat act as intermediaries between the implants and real C2 servers.\n\n**[Past Attribution - CRAT has been attributed to Lazarus in the past by the security](https://blog.alyac.co.kr/2896)**\ncommunity\n\n**Targets - Based on the lures observed so far by Cisco Talos, CRAT aims to infect**\nKorean-speaking entities. This may also be an indicator of Lazarus targeting specific\nparties of interest.\n\n## Conclusion\n\nThis investigation illustrates the continued use and evolution of the CRAT implant. CRAT\nstarted out as a nascent RAT with limited capabilities, which evolved to introduce a wide\nvariety of malicious capabilities including a full-fledged File Explorer.\n\nThe latest iteration of CRAT now has the capability to download and deploy arbitrary plugins\non the infected endpoint. These plugins have capabilities ranging from spying to encrypting\nand holding the user's data hostage. The ransomware plugin in particular has the potential to\ncause extensive loss of services, time and money to affected organizations.\n\n\n-----\n\nThe continued evolution of loaders used to deploy CRAT also indicates that the attackers are\nactively developing novel ways of infecting their targets. The extensive use of obfuscation,\npatching and anti-infection techniques indicates that the attackers have taken great care\ntowards evading detection systems. Thus, while static and network-based detection is\nimportant, it should be complimented with system behavior analysis and endpoint\nprotections.\n\n## Coverage\n\nWays our customers can detect and block this threat are listed below.\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nmalware detailed in this post. Below is a screenshot showing how AMP can protect\n[customers from this threat. Try AMP for free here.](https://cisco.com/go/tryamp)\n\n[Cisco Cloud Web Security (CWS) or Web Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\naccess to malicious websites and detects malware used in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as Next-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html)\nassociated with this threat.\n\n[Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs and URLs, whether users are on or off the corporate network.\n\nAdditional protections with context to your specific environment and threat data are\n[available from the Firepower Management Center.](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html)\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n## IOCs\n\n**CRATv1 HWPs**\n\n\n-----\n\neae3dc403d36b115aa4f7db64cb1a64fa50dbff2b6ce3d118eeb1f745d1ecd14\n7050af905f1696b2b8cdb4c6e6805a618addf5acfbd4edc3fc807a663016ab26\nb962e4580e05e004df9fe2c22b34556bc513370c9a775bfe185e05a9d0df494e\nbd1a0425ffaafa54a1c950fbb3d0defe9fa145131e4bd15d392597de408f5287\nc0bd35a36ea5227b9b981d7707dff0e2c5ca87453a5289dc4a5cd04c7e8b728c\n\n**CRATv1 Hashes**\n\n8edfc15862e3a9b7824fcb4b55c4fefdb4b28b66e3689a6f854e05aef5206dbb\n\n833a896b9236164472fa3ba30e63446b474f9f204fee06ac297877246b674871 win32\n\n88c168cd261dabea1b7223e8c05042be7e0505dedf6fd5effea90ae42e127968 win32\n\ne99c9190cfdc6ad1e45efc6b993078f3122857607f1fede91757a04064f71ad7 win32\n\nc77e5533285871b888257e32653b33acf7e6a7b06d200d02995ae365dfa0a26f win32\n\na36a7e247ea5920514b4d918a6dcdcc7c7f84f0c657b2297a1a0eba3558e24c2 win32\n\ne0fa30565977fb3b97102eef8d28f86cdcd6685aa0d20eee4baaa72216fa562b win32\n\n3689c56b854a99133818618dc97465d9303b3a4009a3c890f7afdfacadd0e1af win32\n\n**CRATv1 Download Locations**\n\nhxxp://teslacontrols[]ir/wp-includes/images/detail31.jpg\n\nhxxp://teslacontrols[]ir/wp-includes/images/detail32.jpg\n\nhxxp://www[]sofa.rs/wp-content/themes/twentynineteen/sass/layout/h1.jpg\n\n**CRATv2 DLLs**\n\n40273d18abc0d623a1798766e0d388f2f46bfa7ad535cad46098a5262382fa13\n\n1e34709734b401413cc38818c1d7e34126fdc01a9bc47a1607e1371dd8d1385b\n\n389518ac65595ad9138b5dd0185aae851d979d4705d74f191492f002e63438c5\n\n916654e2ee43d2ee43f0d5e9d41f8527aaf239684f91f9b92ac5c1937cd45c91\n\n098d190bdfe85b9c366f8ead0fd2c4e469c54ad2d484f19647f0bba8e5d84fe7\n\ne893b4f6b6f3ab977c96ab5e2c6115969cbe46a143531bfc9920d1b9972ebc12\n\neab9136da8cc5c1a8a9fc528d64ef1ce11e385def98957712887785178e202a3\n\n04c46c55336ac40d567ef0aac98ff8424872b584ea169c1a098ced833dd9bab4\n\n2cff5e7d4405bf09f423db1d7a8e535a6be2f68cc4ce4a5817ae01bee09f088a\n\n4aa2dc282c56e397b501d84cfd6c582cc256c42e8b6722b45a592cf2008a6495\n\n05d4da2cb9f6d5d44c399f42a81bb393b2ff6669d64ea773b58d2daf4df10d00\n\n5b627647df675d746f63280cf10a221abfe0a93bab88a96e45b4734beb05c021\n\n11c266c1b0f0428585d40fc95d1a7d3eedb3d0f304cf7ebc692c4487e18c9afb\n\n26c70fa62e1d092ad1855900cd0db4e224b11e84fdf14105ade5e2b2a3dc1b62\n\n37f3f6cdb0a35b4cea75b7cf2dae613c71370e00acdb2cebfc7d95fe33eb97a9\n\n87ce3a13a58ae8007b002ac81f43dc364c1b93b0d3c2a19d46a4480caca9ae29\n\n88f5c94ad66e75a66795875bacafb3cbbe87d1533ae3ddb41575b9711965c75b\n\n\n-----\n\n844d60691d843de53d42b73d635314d50c4ba4d3b2aa2b93465ac0336e4c0588\n931f57262214890f3eff9add25fb5dc2521185e4567c722637f173343b02b9fb\n2263031c15809b49e7d8161e147a4844722f6f576d276b2be38a0c794417dd2a\n\n**EXE Loaders v1**\n\n6f79db3e7fa1f3c9e1ea2e0fe098994f109949f82b97c6612386693164d3c7e2\n\nca3372bb37e7109896c28247faadd157759d5e68ac324a54ff0759590f956094\n\n0eca58ef6f2aba6b3e686f76039945b3a8a8110d357a4f8d857757c218ca0c1e\n\n59628b36ba65a57600c48eaa57c8dcfffc955e447cb3e41b7351e875b359f714\n\na668af2c1b45bf83d509c88ad4b3e6fbadc7e9e3db4ea688888c7712866d1339\n\n955abf30fd464dd572938eaf324d3447ecd8cb6df183bbddee2a58f54da83f4c\n\n**EXE Loaders v2**\n\n2916801be5b6d26d735aaa11eb5631fc6dbe234ed2e0980b8d7366c89ad7ba39\n\n8377a53f7890f3cf01f8919207c981fb63b1b0e63860d5731622a0cad94fdd09\n\n8ae6f663bf40036379857d65521ce1c78c11cd9b5b4848cec0e7f1ad56e65743\n\nab794769599c3f046d34d00051685b7235bce119f212ec8739b6e206dd73b0bf\n\n**DLL Loaders v1**\n\n4dc302e1f7cf8bdc4983fdf02cf5b13bcd9314bb87953b9c6797187700192665 win32\n\n1fc8fb396a22f98c1230d0d8877f3806d52c1a2723add033223753f83628c826\n\nb27c02b4a272453194d0f03c395c4e3dbdf0efc4b8a61cd33b1a70320acf5345\n\n**DLL Loaders v2 (loaders/packagers)**\n\n1ea8b9f307f2c4202380f1fe14044ff4b9140337b53fdf627e5411e979b4b5ea\n\n3b55f8467b2d3bc34c7fe4e0c4502bc1045c50d7c7fedda4a14eaf9094dfc8bf\n\n3f47d73a9d6597da1bdbf36f804b0b69a9958225ace088747098d3a24f5a5957\n\n5464728537836d4aa3d03e4d29ef21e59a324252c4b2a15ec21e9f5280f7c280\n\n7a78dacbb7ff88b536d4a8db4e647df9efed8cea2d26cef0e21f7791e61bfbad\n1101d00223a62e77718da28053758208897d1dc627a06a01f0e620a6ccad3812\n\n277931bf51f195fceb9befad6f4cc9e613d203ed90d3e4a05a16bc603809dec6\n\n4dccd9861da3b47bef43c72546044c1d136a5cb020aaa65a1ea494aec35e4910\n\n5e10cda5415e28b3efc9b909da6518d1cbcb56957e9850b99a4eee3893400012\n\n5fd89dbd129877d5141f9731a61af867b74fc7a33213233307b725ec97532a7b\n\n72d7b55e82080ff84693e1ecdfa7128ef9c513b3b8cc5e411715a40ef4ee0557\n\n8f0bfbde00e5e86223e586874df892e6fb2b97b133a909b7fdeacf7614df478f\n\n9461599bc85cf2ef11cb79a827fd365a086726b7c022fb2bfe5fb9f83e71cf9a\n\nf051c2f99b2d94b0fc5ae7893ec0467f4175cfa926cfc573a6b65a40c566f94d\n\ne93423a1c8add21c5676680a090ddc913d359c29ea9e44ffc91fb10396e3e858\n\na24d66f4356de33ba9227d4e496cc975995f1bd72d72e47f74f07648c45c5308\n\n\n-----\n\n147f1de257ccbe54b0fca9e61e0f2061172459bef4eeb12014d27e48d99f27ab\n1c17b631988d0b8b722adf9c973c6577c7983a9b0cb069dd1d442d04f4dd73df\n2ef70a256dde1a9700527c995be417447dee1857759e8279aa7a287f85c9de96\n359bfd21ed9a5deedc19700355776ede266e5c8532584289db45ebe2fd8d8afe\n3c2e708989193b3497c2c97c3957d4abd2d5989c82832ce5c4a3b5a4c9ecd3f8\na1c7709d147d8182892585bc965317816367ebabc273e8a99559ade24b19ed7f\n057cffe539a414ec4cef730e4fbf7861b61a7331bbd6d7feb55c76221a8cc6d3\n12a7cec5631141f61ef159fbb43103a3cdd79ddd3a0270df62d4c4fa4635b03e\n6d57df368c3e58be61bc36ee35123dcc5ce6d7a04cd6acfe7e10588038589ad4\na7da1ec5745bb7ef5a4fd05d37d83b49b41ab70fae518e6a00b7caa30c417576\n3c6b9fb9d680704a1a6c17ef5b3e10b043d15c137dc04688f5802cddbddf90fe\na52a8a9c99f58fb18ca3f969736f1deffd611c35851cff1bd5bd36ef27f2426d\nf070b78ca7269addb922f9ea9a31f76198edb2e1064d9b04ca8d80ecba175ca4\n683b4472a0df8af6c93ff10179e981a7908173bfb81bac2e12a3b9a022cf08d7\n49aa98e2100752c09d01a7638ea9ead3dd2fc72d826c4b77d188990b3599b08c\n9f953f544afd265176ecb904cc8286cafc27270df0cec56265259c1588083202\na052ee9f75231a60ad1210411b7296ff5adf7e9e268bf2f123f0560e0cb37b09\n46fd13169cf8e3dcefbd552918a0914261fd22dc22bd9cba167042288432f2b2\n9a6d3d07e784247fac1292c0f17a46247e8bdeb1f468c9b8b48c4459063c3ed5\n70d92da003eb044d9c5aa057400256a51836466d2f20066deedf64e294466c20\neb9382b77f7ed3429b0fcfb5d5d64c0702f0c4d91c45bb8d3442ff1f851b8035\ncd20d7209db84b35cae88affe228f42258b497eee2b36f0e3364779e58e5e2ce\ne4c1eaf014773cc25e2881fa2b2a67490a73c66683f5746276af7067777ed8b2\n396ffa925165de08d0b5bf6cc6974a02a18b44ce60c3d3e657ba6c6153760138\n9fc572e3a6c30221e5eecdd488efabbaf1bab04dff34860263495620fa4706c1\n0313641c0ed1defa6cb52e787f81eab3de8c0c546b4e157d803aab721fec3dc8\n7a3915a7d919fb266496616a06311c456c8e45b98cfd24c92ac4bf0af75fa3ef\n02c4ba967900b49828985f7b67ebd21daa11b8bc9e4e0b6e5e9fef2de8fdc6d4\n3d47ca0810b2d296aaa2541ef621f5d834dfbbd89cb671a2a95b7f2bddbd3e4e\nbb1af121502e40a549135b72f34ad49d11cfbfa49b5cbcf549777549087fe751\nfb2ad747903f46d03b19b12c46a3e678e8a0c156092fb334aab47714a041265c\n\n**Plugins: ClipboardMonitor**\n\n562c4102d48414ab32c6742f270948a5d92e3b2af6d30d04ba1f7411302cbea8\n\nc4875cc728e7c4bc00646df57c8c38370fe11439e4c95e38040ba84fe27eb0b9 win32\n\n**Plugins: ScreenCapture**\n\n1764ceca4425c6f577ecdb5c9435cf01807663508c3e1bbe1de2800d6c725a01\n\n6caa98870efd1097ee13ae9c21c6f6c9202a19ad049a9e65c60fce5c889dc4c8 win32\n\n**Plugins: KeyLogger**\n\n\n-----\n\nc9ba7e700276e0fd3e7060f81d4487f81d06bc3cba1e0a0eacd1ca21faca4400\n6d461bf3e3ca68b2d6d850322b79d5e3e647b0d515cb10449935bf6d77d7d5f2 win32\n\n**Plugins: Hansom Ransomware**\n\ncb141c743ac41784501e2e84ccd9969aade82b296df077daff3c0734bb26c837\n\n5384e1ab95d2cbac7e4cd5b781ad2520\n\n**C2 URLs**\n\nwww[]publishapp.co/update/check.php\n\nwww[]sideforum.cc/forum/list.php\n\nwww[]freeforum.co/forum/list.php\n\nwww[]goodfriend.pro/projects/list.php\n\nwww[]friendship.me/users/register.php\n\nwww[]threegood.cc/api/manage/customers\n\nwww[]Engpro.xyz/images/detail.php\n\nwww[]infocop.me/products/list.php\n\nwww[]teamspit.pro/adverts/follow.php\n\nwww[]dodoi.cc/photos/preview.php\n\nwww[]advertapp.me/user/invite.php\n\nwww[]insideforum.me/forum/list.php\n\nwww[]anyoneforum.cc/forum/list.php\n\nwww[]goodproject.xyz/projects/list.php\n\nwww[]hellofriend.pro/users/register.php\n\nwww[]moonge.cc/wp-content/plugins/google-sitemap-generator/sitemap-builderembed.php\n\nhxxps://calculactcal[]org/wp-content/themes/twentysixteen/body.php\n\nhxxp://3cuartos[]com/wp-content/plugins/music-press-pro/templates/global/update.php\n\nhxxps://www[]worldfoodstory.co.uk/wp-includes/register.php\n\nhxxps://bokkeriejesj[]nl/wp-content/plugins/music-press-pro/upload.php\n\nhxxps://encontrosmaracatu[]com.br/wp-content/plugins/music-presspro/templates/global/topmenu.php\n\nhxxps://www.theblackout[]fr/wp-content/plugins/music-press-pro/music-pro.php\n\nhxxps://mokawafm[]com/wp-content/plugins/ckeditor-forwordpress/ckeditor/plugins/image/dialog.php\n\nhxxps://www.tiramisu[]it/wp-content/plugins/wp-comment-form.php\n\nhxxp://www.kartacnictvi[]cz/wp-content/plugins/ckeditor-forwordpress/ckeditor/plugins/image/upload.php\n\nhxxp://www.dimer-group[]com/wp-content/plugins/ckeditor-forwordpress/ckeditor/plugins/image/download.php\n\nhxxps://ecolerubanvert[]com/wp-content/plugins/image-intense/know.php\n\nhxxp://lwac[]com/wp-content/plugins/gallery-plugin/includes/demo\n\n-----\n\ndata/images/music/photo.php\nhxxps://www[]copansrl[]it/wp-admin/user/invite.php\nhxxps://arar-musique[]fr/wp-content/plugins/music-presspro/includes/admin/upgrade.php\nhxxps://www[]firstalliance[]church/wp-content/plugins/music-press/templates/404.php\nhxxps://erickeleo[]com[]br/wp-content/plugins/music-press-pro/go.php\nhxxp://www[]kingsvc.cc/index.php\nhxxp://www[]sofa.rs/wp-admin/network/server_test.php\nhxxp://www[]afuocolento.it/wp-admin/network/server_test.php\nhxxp://www[]mbrainingevents.com/wp-admin/network/server_test.php\nhxxp://www[]afuocolento.it/wp-includes/process.php\n\n**Mutex Names**\n\nCRAT\nCRAT2<FileVersionNumber_from_rsrc> E.g. \"CRAT21.0.0.7\"\nCratScreenCaptureMutex\nCratClipboardMonitor2Mutex\nCratKeyLog2Mutex\nMutex_Hansom2008\n\n## Anti-Infection Checks\n\nThe following is the blocklist of the various artifacts checked on the infected endpoint. If any\nof these are detected the malware stops execution.\n\n**VM related process names**\n\nVmtoolsd.exe\nVmwaretrat.exe\nVmwareuser.exe\nVmacthlp.exe\nvboxservice.exe\nvboxtray.exe\n\n**Network adapter descriptions**\n\nVMware Virtual Ethernet Adapter\nVirtualBox Host-Only Ethernet Adapter\n\n**MACAddress prefixes**\n\n\n-----\n\n00:05:69\n00:0C:29\n00:1C:14\n00:50:56\n\n**Window names**\n\nWinDbg\nx64_dbg\nx64dbg\nOllyICE\nOllyDbg\nImmunity\nida\nwww.sysinternals.com\nProcess Explorer\nProcess Monitor\nFiles Monitor\nWireshark\nFiddler\nTcpdump\nTcpView\nBurp Suite\n\n**Analysis tools process names**\n\nWinDbg\nx64_dbg\nx64dbg\nOllyICE\nOllyDbg\nImmunity\nida\nProcExp\nProcMon\nFileMon\nWireshark\nFiddler\nTcpdump\n\n\n-----\n\nTcpView\nBurpSuite\n\n## Ransomware Plugin Details\n\n**BTC addresses**\n\nbc1q3tdfzfjngzdlup7x50x3tkfs2mx90a85en9z74 [0 BTC as of publication date]\nbc1qpy4dn79xyac8ep6a2daupqmxd6c4cxlywq4fe3 [0 BTC as of publication date]\n\n**Attacker email addresses**\n\nkeepcredit015[at]protonmail.com\n\nhonestman0023[at]protonmail.com\n\nhansom2008[at]protonmail.com\n\nhansompay2008[at]yandex.com\n\n**Processes terminated**\n\nmsftesql.exe\nsqlbrowser.exe\nsqlagent.exe\nsqlwriter.exe\nsqlservr.exe\nocssd.exe\noracle.exe\nsynctime.exe\ndbsnmp.exe\nagntsvc.exe\nmydesktopqos.exe\nxfssvccon.exe\nisqlplussvc.exe\nocautoupds.exe\nmydesktopservice.exe\nagntsvc.exe\nagntsvc.exe\nencsvc.exe\nagntsvc.exe\ntbirdconfig.exe\nfirefoxconfig.exe\nmysqld.exe\nocomm.exe\n\n\n-----\n\nmysqld-opt.exe\nmysqld-nt.exe\nsqbcoreservice.exe\ndbeng50.exe\ninfopath.exe\nexcel.exe\nmspub.exe\nmsaccess.exe\noutlook.exe\nonenote.exe\nsteam.exe\npowerpnt.exe\nthebat.exe\nsqlservr.exe\nthunderbird.exe\nthebat64.exe\nwinword.exe\nvisio.exe\nWordpad.exe\n\n**File name exclusions**\n\ndesktop.ini\nntuser.dat\nautorun.inf\nbootsect.bak\niconcache.db\nntuser.dat.log\nboot.ini\nthumbs.db\nHANSOM_README.txt\nShowNote.vbs\n\n**Folder name exclusions**\n\nThe following folders are excluded from the encryption process by the ransomware plugin.\n\nIETldCache\nProgramData\nProgram Files\nBoot\nTor Browser\nProgram Files (x86)\nAll Users\n\n\n-----\n\nHansom_Sample\nWindows\nLocal Settings\nINetCache\n$Recycle.bin\ncache2\nLocalCache\nSample9\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.11.12.CRAT_Lazarus/Cisco%20Talos%20Intelligence%20Group%20-%20Comprehensive%20Threat%20Intelligence_%20CRAT%20wants%20to%20plunder%20your%20endpoints.pdf"
    ],
    "report_names": [
        "Cisco Talos Intelligence Group - Comprehensive Threat Intelligence_ CRAT wants to plunder your endpoints"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041842,
    "ts_creation_date": 1605240909,
    "ts_modification_date": 1605240909,
    "files": {
        "pdf": "https://archive.orkl.eu/e9f32f7b199787f8b8bb42c90054f2db6a1fee0f.pdf",
        "text": "https://archive.orkl.eu/e9f32f7b199787f8b8bb42c90054f2db6a1fee0f.txt",
        "img": "https://archive.orkl.eu/e9f32f7b199787f8b8bb42c90054f2db6a1fee0f.jpg"
    }
}