{
    "id": "ec9f5455-b758-4d59-acc6-0ee25a91b5b0",
    "created_at": "2023-01-12T15:07:05.19438Z",
    "updated_at": "2025-03-27T02:10:04.296185Z",
    "deleted_at": null,
    "sha1_hash": "ae84d2e632e5012324457d9c7050bf0c93ccfe04",
    "title": "2022-06-24 - We see you, Gozi Hunting the latest TTPs used for delivering the Trojan",
    "authors": "",
    "file_creation_date": "2022-09-01T10:08:19Z",
    "file_modification_date": "2022-09-01T10:08:19Z",
    "file_size": 1749502,
    "plain_text": "# We see you, Gozi\n\n**blog.group-ib.com/gozi-latest-ttps**\n\n24.06.2022\n\nHunting the latest TTPs used for delivering the Trojan\n\nAlbert Priego\n\nMalware Analyst at Group-IB\n\nThe ISFB Trojan also known as Gozi ISFB first appeared in 2014. It is based on Gozi, which was released in 2006 and\n[developed by Russian threat actors. Gozi was designed to collect network traffic and steal credentials from browsers and](https://thehackernews.com/2013/01/russian-hacker-behind-gozi-malware.html)\nemail clients. It has screen grabbing and keylogging functionalities.\n\nThe ISFB banking Trojan is a modified version of Gozi. The malware was identified in 2014 and it is also known as Gozi2\nand Ursnif. It collects credentials and is mainly used for attacks on the client side of online banking (ATS attacks) and fraud.\n\nGiven that the source code for Gozi ISFB is available online, there are now various forks based on ISFB such as GozNym\nor Dreambot.\n\nGroup-IB Threat Intelligence\n\nSupercharge security and defeat attacks before they begin with knowledge of how and when you will be attacked\n\n\n-----\n\nTest Drive Group-IB Threat Intelligence\n\n## New Gozi TTPs\n\nGroup-IB has been tracking the Gozi banking Trojan since its early days. During recent threat hunting operations, we\n[detected a new sample of the Trojan in the wild, on June 14. As soon as we conducted an in-depth investigation, we](https://twitter.com/AlbertPriego/status/1537777013829906434)\nrealized that the methods and techniques used had no relationship with those seen so far.\n\nWe are aware that reading articles on reverse engineering is often tedious and even difficult, which is why we will look at the\nlatest version at a high level.\n\nThe kill chain resembles a matryoshka doll. All the stages are executed in memory by downloading, uncompressing and\nunpacking different stages, without directly dropping files to disk.\nKill chain\n\n1\n\nInitial .EXE self-decompress in memory and executes .NET downloader.\n\n2\n\n.NET downloader performs GET request to Discord resource using a shortener (tiny[.]one) to download the next-stage\npayload, which is a .NET packer.\n\n3\n\nThe .NET packer gets executed. It decrypts and unpacks the packer of the Gozi downloader.\n\n4\n\nThe packer of the Gozi downloader unpacks the DLL, which is the real Gozi downloader module.\n\n5\n\nThe Gozi downloader behaves as usual by trying to contact the Command & Control server found in its configuration in\norder to download the main module and continue executing it.\n\n## Analysis\n\n\n-----\n\nThe first file we found was the executable traktor.exe, which self decompresses itself in memory into the file\n“SEB6A8~1.EXE” and executes it. The new file then acts as a .NET downloader for the next-stage payload. Once executed,\nthe downloader performs a GET request, passing through a shortener to try to hide the final URL of the resource. Shortener\nrequest: hXXps://tiny[.]one/yt52rdce → points to:\ncdn[.]discordapp[.]com/attachments/977479165555146754/984345564407812106/wiztree_4_08_setup_4_Qfmhjhgh.bmp\n\nAfter being downloaded, it reverses the bytes (usually in order to interfere with detection mechanisms) and executes it. The\nnew executed file is an obfuscated .NET DLL that serves as a packer.\n\nOnce launched in memory, the .NET packer decrypts and unpacks the next-stage payload in memory, which is the packed\nGozi downloader. The DLL is obfuscated with various namespaces, classes and methods to throw analysts and reverse\nengineers off track.\n\nAs in all typical Gozi kill chains, the packed downloader unpacks itself into a DLL (the real payload) and executes it. Given\nthat Gozi downloader is run in memory, it will behave as usual and try to contact the Command & Control server in order to\ndownload the main module and perform further actions.\n\n**﻿**\nBesides the research was finished really quick we were unable to obtain the main module to investigate further. We also\ncould not obtain web injects and the target list because the contacted Command & Control server from the downloader was\nalready down.\n\n## Gozi downloader configuration\n\n\n-----\n\n```\n{\n  \"server_key\": \"guVZ8lGzorgMS7cj\",\n\n  \"group\": \"7776\",\n\n  \"timer\": \"1\",\n\n  \"server\": \"50\",\n\n  \"0x54432e74\": \"/drew/\",\n\n  \"0x48295783\": \"20\",\n\n  \"0x73d11ee\": \".bmp\",\n\n  \"0x41cae66d\": \"0\",\n\n  \"cnc\": [\n\n    \"update[.]zonealarm[.]com\",\n\n    \"iiso[.]in\"\n\n  ],\n\n  \"0xbbb5c71d\": \".jlk\",\n\n  \"0x584e5925\": \"0\"\n\n}\n\n## IOCs\n\n```\n**Network﻿**\n\ncdn[.]discordapp[.]com/attachments/977479165555146754/984345564407812106/wiztree_4_08_setup_4_Qfmhjhgh.bmp\ntiny[.]one/yt52rdce\nupdate[.]zonealarm[.]com\niiso[.]in\n\n**Files**\n\nName: traktor.exe\nClassification: Cabinet Self-Extractor\nMD5: A0BB2D133B174436A9D4CCE527FB78D7\nSHA1: 8E72E0115E01F32A2F72D1F31C3E641C6B66AB45\nSHA256: 904CA32CB62DC94B61092F80FA78C5BC97D0A5394FA03438AEEC85ED87AB763E\nSigner: Sectigo RSA\nCompiler stamp: Tue Jul 25 08:18:00 2062\nVT First submission: 2022-06-14 23:34:20 UTC\n\nName: SEB6A8~1.EXE\nClassification: .NET downloader\nMD5: 63fdefb66fd14dc92a7d1f773d6f619b\nSHA-1: 0a96e7edc7a7e4b805f29691a0d39e21453f9eb0\nSHA-256: 360703b2b2c324dde72dcd0651251c9e882e245c22d6b7e8c3163ed34ddb62b9\nSigner: Sectigo RSA\nCompiler stamp: Fri Mar 09 00:13:06 2074\nVT First submission: 2022-06-14 23:41:06 UTC\n\nClassification: .NET Packer\nOriginal filename: Deocqpqvayitfaqvcfovoryc.dll\nMD5: 2B348E0106F20C14615212D7EFF0DB88\nSHA1: 4DCD93A1CFD7F630C5FE71F5B31B298582B8BD39\nSHA256: 90660936CB65E0F929F32615EF400E0D0F80232F7F2003778C27E28B84468666\nCompiler stamp: Thu Jun 09 08:37:18 2022\nVT First submission: None (at the day of research)\n\nClassification: Packed GOZI downloader\nMD5: 1C847FED91BA95A65FF0160757C5B187\n\n\n-----\n\nSHA1: 17CA3FA3BEC22507798B5B21906559134F4CD3AA\nSHA256: 3EF96CFB78CB553943CE591C985FDC793D2ACF342A536B90D0F9EF72BDB15ECD\nCompiler stamp: Tue Apr 26 21:11:45 2022\nVT First submission: VT First submission: None (at the day of research)\n\nClassification: GOZI downloader\nMD5: D3D4B79106465363155A3F4F6C1A5E05\nSHA1: 9E978AD8C58FBBE59B470E26709687023161A5B8\nSHA256: 011F6F038B1398C03AE15D3CB81412D32AD0AD554DFBB5D38FAE78577FB2B777\nCompiler stamp: Tue Apr 26 21:11:39 2022\nVT First submission: VT First submission: None (at the day of research)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-24 - We see you, Gozi Hunting the latest TTPs used for delivering the Trojan.pdf"
    ],
    "report_names": [
        "2022-06-24 - We see you, Gozi Hunting the latest TTPs used for delivering the Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "b753c6a8-a83d-47bc-829d-45e56136eb7d",
            "created_at": "2023-01-06T13:46:38.97802Z",
            "updated_at": "2025-03-27T02:00:02.967861Z",
            "deleted_at": null,
            "main_name": "GozNym",
            "aliases": [],
            "source_name": "MISPGALAXY:GozNym",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536025,
    "ts_updated_at": 1743041404,
    "ts_creation_date": 1662026899,
    "ts_modification_date": 1662026899,
    "files": {
        "pdf": "https://archive.orkl.eu/ae84d2e632e5012324457d9c7050bf0c93ccfe04.pdf",
        "text": "https://archive.orkl.eu/ae84d2e632e5012324457d9c7050bf0c93ccfe04.txt",
        "img": "https://archive.orkl.eu/ae84d2e632e5012324457d9c7050bf0c93ccfe04.jpg"
    }
}