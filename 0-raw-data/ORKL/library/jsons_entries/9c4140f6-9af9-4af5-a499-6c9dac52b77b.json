{
    "id": "9c4140f6-9af9-4af5-a499-6c9dac52b77b",
    "created_at": "2022-10-25T16:48:24.259549Z",
    "updated_at": "2025-03-27T02:16:28.860469Z",
    "deleted_at": null,
    "sha1_hash": "251139b66d8a6e68a38000d1e05befd26bf535ca",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-05-03T03:22:09Z",
    "file_modification_date": "2018-05-03T03:22:09Z",
    "file_size": 1802642,
    "plain_text": "# 集顶尖研究团队\n\n 提供最实时的威胁情报\n\n[威胁检测平台](https://s.tencent.com/research/) [联合实验室](https://s.tencent.com/research/slab.html) [研究报告](https://s.tencent.com/research/report/) [威胁通告](https://s.tencent.com/research/bsafe/) [荣誉认证](https://s.tencent.com/research/honor/)\n\n\n[研究报告 > 正文](https://s.tencent.com/research/report/)\n\n### 海莲花APT组织最新攻击样本分析\n\n2018­04­27 15:47:32\n\n海莲花（OceanLotus）也叫APT32或APT­C­00，是一个长期针对中国及其他东亚国家（地区）政府、\n\n科研机构、海运企业等领域进行攻击的APT组织。近日腾讯御见威胁情报中心捕获到了一个该组织的最\n\n新攻击样本。在本次攻击事件中，该组织使用了CVE­2017­11882漏洞并结合白签名利用程序...\n\n## 0x1 概况\n\n海莲花（OceanLotus）也叫APT32或APT­C­00，是一个长期针对中国及其他东亚国家（地\n\n区）政府、科研机构、海运企业等领域进行攻击的APT组织。近日腾讯御见威胁情报中心\n\n捕获到了一个该组织的最新攻击样本。在本次攻击事件中，该组织使用了CVE­2017­1188\n\n2漏洞并结合白签名利用程序来最大化隐藏自己的后门木马。后门木马将常驻用户电脑，\n\n并根据云控指令伺机窃取机密信息或进行第二阶段攻击。\n\n图1\n\n（攻击流程图）\n\n## 0x2 载荷投递\n\n本次攻击时使用了CVE­2017­11882漏洞文档，诱饵文档文件名为《Document_GPI Invitat\n\nion­UNSOOC China.doc》，内容为一模糊的图片。\n\n\n#### 最新资讯\n\n\n医院遭勒索病毒攻击—腾讯企业安\n速响应成功防御获感谢\n\n企业未修复Apache Struts 2漏洞 致\n服务器被批量入侵\n\n黑产竞争激烈：一台服务器遭遇两\n客进攻\n\nPhotoMiner木马挖矿收入8900万 已\n门罗币“黄金矿工”\n\n腾讯2018年Q1季度互联网安全报告\n基础设施或成重点攻击对象\n\n以Windows服务器为攻击目标 或成\n病毒新趋势\n\n[最新APT组织“寄生兽”活动披露](https://s.tencent.com/research/report/465.html)\n\n[针对企业定向攻击的Xtreme、Tes](https://s.tencent.com/research/report/464.html)\n\nAVC安卓杀软测评最佳名额独占三\n讯TAV杀毒引擎大放异彩\n\nWeblogic 反序列化命令执行 (CVE\n­2628)\n\n\n-----\n\n图2\n\n(诱饵文档)\n\n漏洞触发后，公式编辑器进程会在“C:\\Program Files\\Microsoft­Windows­DiskDiagnost\n\nicResolver_2021325962”目录下释放MicrosoftWindowsDiskDiagnosticResolver.exe、OUTL\n\nFLTR.DAT、rastls.dll 3个文件。其中MicrosoftWindowsDiskDiagnosticResolver.exe有有效\n\n签名，原始名为dot1xtra.exe，这是典型的白加黑利用技术,带有效签名的exe运行后会自动\n\n加载木马文件rastls.dll。\n\n图3\n\n(签名信息)\n\n\n-----\n\n图4\n\n（文件详细信息）\n\n## 0x3 RAT分析\n\n### 1.rastls.dll 行为分析\n\n该组织在本次攻击中使用的关键模块文件都加入了大量混淆，混淆代码如下所示。此d\n\nll会在DLLMain函数中加载OUTLFLTR.DAT，进行解密后得到一段shellcode。接着会将宿主\n\nexe即MicrosoftWindowsDiskDiagnosticResolver.exe 0x401000（默认基址为0x400000）开\n\n始的一大片代码修改为无实际作用的指令，宿主exe oep位置的指令也被修改了。当宿主e\n\nxe从OEP位置开始执行时，就会跳转到木马的shellcode部分。\n\n图5\n\n（混淆代码）\n\n\n-----\n\n图6\n\n（宿主exe 0x401000处被修改后的指令）\n\n图7\n\n（宿主exe 被修改后OEP附近的代码）\n\n图8\n\n（rastls.dll 跳转到shellcode执行）\n\nOUTLFLTR.DAT中的shellcode被执行后，会自加载shellcode中存储的一个名为{92BA18\n\n18­0119­4F79­874E­E3BF79C355B8}.dll。接着执行此dll的导出函数DllEntry。\n\n图9\n\n（dll内部名称及导出函数）\n\n{92BA1818­0119­4F79­874E­E3BF79C355B8}.dll 又会从资源中解密出木马功能文件\n\n{A96B020F­0000­466F­A96D­A91BBF8EAC96}.dll，并自加载此dll，执行此dll的导出函数\n\n\n-----\n\n图10\n\n（木马功能文件导出函数及内部文件名）\n\n### 2. {A96B020F­0000­466F­A96D­A91BBF8EAC96}.dl l 行为分析\n\n该dll执行后，会解密资源得到木马的c2等配置信息及3个通信相关的dll，名称分别为Ht\n\ntpProv.dll、DnsProvider.dll、HttpProv.dll。每个通信dll都导出一个\"CreateInstance\"函数。\n\n图11\n\n(加载资源)\n\n图12\n\n（解密资源）\n\n\n-----\n\n图13\n\n（解密资源的函数代码片断）\n\n图14\n\n（资源解密后的明文内容）\n\n将解密后的资源进行分析后得到资源中各字段的值及部分含义\n\n|字段序号|字段内容|\n|---|---|\n|1|Unicode 字符串“ghijklmnop”|\n\n\n2\n\n\nUnicode字符串，注册表键值“SOFTWARE\\App\\AppXbf13d4ea29\n\nd b b b \\ l ”\n\n\n-----\n\n|Col1|45444d8b13e2121cb6b663\\DefaultIcon”，存储发包时用的guid|\n|---|---|\n|4|Unicode字符串“Data”|\n|5|“ghi” 此值与计算机用户名进行运算后得到互斥体名称|\n|6|andreagahuvrauvin.com c2|\n|7|byronorenstein.com c2|\n|8|straliaenollma.xyz c2|\n|9|0x54400字节的pe文件，名称为HttpProv.dll|\n|10|0x35c00字节的pe文件，名称为DnsProvider.dll|\n|11|0x073a00字节的pe文件，名称也为HttpProv.dll|\n|12|4字节，值为0x88a36523，可以理解为版本号|\n|13|4字节，值为0x13|\n|14|Unicode字符串“46405”，即c2端口号|\n|15|8字节，Hex值为”2B CA 18 AF D7 11 EA 59”，发包时会带上此 值|\n|16|8字节，Hex值为“80 A9 03 00 30 75 00 00”，根据此值Sleep一 定时间后再执行木马功能|\n\n\n图15\n\n（通信dll导出函数）\n\n接着此dll会根据资源中的配置信息Sleep一定的时间后再开始后续的操作。后续会再利用\n\n自加载的方式将3个通信相关的dll全部加载起来。自加载时用到的函数主要有VirtualAlloc\n\n、\n\nRtlMoveMemory。木马还会创建名为“Microsoft­Windows­DiskDiagnosticResolver“的任务\n\n计划，达到常驻的目的。\n\n图16\n\n（根据资源中的配置的信息，sleep一段时间）\n\n\n-----\n\n图17\n\n（自加载时分配内存）\n\n图18\n\n（自加载时填充内存）\n\n木马会根据资源中的c2，使用DGA（域名生成算法）生成通信时的域名信息，木马上线时\n\n会将用户名、计算机名、操作系统等信息加密后上报给c2。\n\n图19\n\n（DGA得到的通信域名）\n\n\n-----\n\n图20\n\n(上线时的第一个明文包)\n\n木马上线后，根据服务器下发的指令执行相应的功能，主要功能有：\n\nl 文件操作，比如创建文件或目录、删除文件或目录、查找文件\n\nl 注册表读写\n\nl 远程执行代码，比如创建进程、执行dll等\n\nl 设置环境变量\n\n## 0x4 溯源\n\n从该RAT通信的C&C地址154.16.138.89在腾讯御见威胁情报中心平台进行反查，得到下列\n\n结果：\n\n图21\n\n随便选一个域名orinneamoure com继续反查：\n\n\n-----\n\n图22\n\n可以发现，该域名被腾讯御见威胁情报平台为标注为海莲花。而该域名也在之前友商对海\n\n莲花的报告中披露过。此外，该攻击使用的技术、网络通信协议等和以往的海莲花的攻击\n\n样本进行比对也完全一致。因而我们可以确认，该次攻击属于海莲花APT团队所为。\n\n## 0x5 总结\n\n从上文的分析可以看出该组织在漏洞利用、白加黑利用技术、代码混淆等方面都有着很深\n\n的技术积累。后门木马不落地直接内存执行、签名程序白利用、shellcode隐藏可执行文\n\n件、多变的网络通信等技术手段大大增加了杀软的查杀难度。因此，我们提醒政府、企业\n\n等广大用户，切勿随意打开来历不明的文档，同时安装安全软件。\n\n目前，腾讯御界高级威胁检测系统已经可以检测该轮攻击的连接行为。御界高级威胁\n\n检测系统，是基于腾讯反病毒实验室的安全能力、依托腾讯在云和端的海量数据，研发出\n\n的独特威胁情报和恶意检测模型系统。\n\n凭借基于行为的防护和智能模型两大核心能力，御界高级威胁检测系统可高效检测未\n\n知威胁，并通过对企业内外网边界处网络流量的分析，感知漏洞的利用和攻击。通过部署\n\n御界高级威胁检测系统，及时感知恶意流量，检测钓鱼网址和远控服务器地址在企业网络\n\n中的访问情况，保护企业网络安全。\n\n图23\n\n## 0x6 附录(IOCs):\n\n**Hash:**\n\n02AE075DA4FB2A6D38CE06F8F40E397E (Document_GPI Invitation­UNSOOC China.doc)\n\nD7C172D4A88573B7E373F2B666C011AC(GPI Invitation­UNSOOC China.doc)\n\n72A5AD375401F33A5079CAEE18884C9D ({92BA1818­0119­4F79­874E­E3BF79C355B8}.\n\ndll)\n\n79D06DD20768FD8CD4A043833C1F2D4B ({A96B020F­0000­466F­A96D­A91BBF8EAC9\n\n\n-----\n\n2559738D1BD4A999126F900C7357B759(HttpProv.dll)\n\n2DFAEDD9265642E430E6635F210FABB4(DnsProvider.dll)\n\nF775CC387A55831386E44DD00EF9723E(rastls.dll)\n\nB10F93CDBCDF43D4C5C5770872E239F4(OUTLFLTR.DAT)\n\n**C&C:**\n\nandreagahuvrauvin.com\n\nbyronorenstein.com\n\nstraliaenollma.xyz\n\ndieordaunt.com\n\nchristienoll.xyz\n\nillagedrivestralia.xyz\n\n154.16.99.85\n\n154.16.47.41\n\n154.16.138.89\n\n注册表：\n\n“SOFTWARE\\App\\AppXbf13d4ea2945444d8b13e2121cb6b663\\DefaultIcon”\n\n“SOFTWARE\\App\\AppXbf13d4ea2945444d8b13e2121cb6b663\\Application”\n\n#### 相关文章\n\n\nPhotoMiner木马挖矿收入890\n0万 已成门罗币“黄金矿工”\n\n\n企业未修复Apache Struts 2\n漏洞 致Web服务器被批量入\n\n\n黑产竞争激烈：一台服务器\n遭遇两拨黑客进攻\n\n\n#### 产品中心\n\n[御点终端安全管理系统](https://s.tencent.com/product/yd/index.html)\n\n[御界防APT邮件网关](https://s.tencent.com/product/yjwg/index.html)\n\n[御界高级威胁检测系统](https://s.tencent.com/product/gjwxjc/index.html)\n\n[御知网络空间风险雷达](https://s.tencent.com/product/yuzhi/index.html)\n\n\n#### 安全服务\n\n[渗透测试服务](https://s.tencent.com/service/stcs/index.html)\n\n[安全咨询](https://s.tencent.com/service/aqzx/index.html)\n\n[等保合规](https://s.tencent.com/service/dbhg/index.html)\n\n[PCI ­ DSS 合规](https://s.tencent.com/service/pci-dss/index.html)\n\n\n#### 管理与支持\n\n[产品激活](https://s.tencent.com/license/activate)\n\n[修改企业信息](https://s.tencent.com/user/login)\n\n[联系我们](https://s.tencent.com/about/contact.html)\n\n\n#### 威胁研究\n\n[哈勃分析系统](https://habo.qq.com/?ADTAG=innerenter.qygw)\n\n[腾讯安全服务平台](https://110.qq.com/?ADTAG=innerenter.qygw)\n\n[反信息诈骗联盟](https://guanjia.qq.com/online_server/txwz/?ADTAG=innerenter.qygw)\n\n[神羊情报分析平台](https://shenyang.qq.com/?ADTAG=innerenter.qygw)\n\n\n关注微信号 关注新浪\n\n\nCopyright©1998­2018 Tencent. All Rights Reserved.\n\n\n-----",
    "language": "ZH",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.04.27.OceanLotus_new_malware/%5BCN%5D_OceanLotus_new_malware.pdf"
    ],
    "report_names": [
        "[CN]_OceanLotus_new_malware"
    ],
    "threat_actors": [
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1525317729,
    "ts_modification_date": 1525317729,
    "files": {
        "pdf": "https://archive.orkl.eu/251139b66d8a6e68a38000d1e05befd26bf535ca.pdf",
        "text": "https://archive.orkl.eu/251139b66d8a6e68a38000d1e05befd26bf535ca.txt",
        "img": "https://archive.orkl.eu/251139b66d8a6e68a38000d1e05befd26bf535ca.jpg"
    }
}