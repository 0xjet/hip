{
    "id": "3ded967f-f9da-457a-b895-86b2d7244355",
    "created_at": "2023-01-12T15:05:38.801257Z",
    "updated_at": "2025-03-27T02:09:17.784516Z",
    "deleted_at": null,
    "sha1_hash": "ed32c33130254e66aba82a37d9f64c7a32a1e1c8",
    "title": "2020-10-21 - Life of Maze ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T19:36:19Z",
    "file_modification_date": "2022-05-28T19:36:19Z",
    "file_size": 2808805,
    "plain_text": "# Life of Maze ransomware\n\n**securelist.com/maze-ransomware/99137/**\n\nAuthors\n\n\n-----\n\nFedor Sinitsyn\n\nNikita Galimov\n\n[Vladimir Kuskov](https://securelist.com/author/vladimirkuskov/)\n\nIn the past year, Maze ransomware has become one of the most notorious malware families\nthreatening businesses and large organizations. Dozens of organizations have fallen victim\n[to this vile malware, including LG,](https://www.kaspersky.com/blog/transatlantic-cable-podcast-154/36645/) [Southwire, and the](https://www.kaspersky.com/blog/ransomware-data-disclosure/32410/) [City of Pensacola.](https://threatpost.com/maze-ransomware-pensacola-attack-data-breach/151066/)\n\nThe history of this ransomware began in the first half of 2019, and back then it didn’t have\nany distinct branding – the ransom note included the title “0010 System Failure 0010”, and it\nwas referenced by researchers simply as ‘ChaCha ransomware’.\n\n**_Ransom note of an early version of Maze/ChaCha ransomware_**\n\nShortly afterwards, new versions of this Trojan started calling themselves Maze and using a\nrelevantly named website for the victims instead of the generic email address shown in the\nscreenshot above.\n\n\n-----\n\n**_Website used by a recent version of Maze ransomware_**\n\n## Infection scenarios\n\n### Mass campaigns\n\nThe distribution tactic of the Maze ransomware initially involved infections via exploit kits\n(namely, Fallout EK and Spelevo EK), as well as via spam with malicious attachments. Below\nis an example of one of these malicious spam messages containing an MS Word document\nwith a macro that’s intended to download the Maze ransomware payload.\n\n\n-----\n\nIf the recipient opens the attached document, they will be prompted to enable editing mode\nand then enable the content. If they fall for it, the malicious macro contained inside the\ndocument will execute, which in turn will result in the victim’s PC being infected with Maze\nransomware.\n\n\n-----\n\n### Tailored approach\n\n\n-----\n\nIn addition to these typical infection vectors, the threat actors behind Maze ransomware\nstarted targeting corporations and municipal organizations in order to maximize the amount\nof money extorted.\n\nThe initial compromise mechanism and subsequent tactics vary. Some incidents involved\nspear-phishing campaigns that installed Cobalt Strike RAT, while in other cases the network\nbreach was the result of exploiting a vulnerable internet-facing service (e.g. Citrix\nADC/Netscaler or Pulse Secure VPN). Weak RDP credentials on machines accessible from\nthe internet also pose a threat as the operators of Maze may use this flaw as well.\n\nPrivilege escalation, reconnaissance and lateral movement tactics also tend to differ from\ncase to case. During these stages, the use of the following tools has been observed:\nmimikatz, procdump, Cobalt Strike, Advanced IP Scanner, Bloodhound, PowerSploit, and\nothers.\n\nDuring these intermediate stages, the threat actors attempt to identify valuable data stored\non the servers and workstations in the compromised network. They will then exfiltrate the\nvictim’s confidential files in order to leverage them when negotiating the size of the ransom.\n\nAt the final stage of the intrusion, the malicious operators will install the Maze ransomware\nexecutable onto all the machines they can access. This results in the encryption of the\nvictim’s valuable data and finalizes the attack.\n\n## Data leaks/doxing\n\nMaze ransomware was one of the first ransomware families that threatened to leak the\nvictims’ confidential data if they refused to cooperate.\n\nIn fact, this made Maze something of a trendsetter because this approach turned out to be\nso lucrative for the criminals that it’s now become standard for several notorious ransomware\ngangs, including REvil/Sodinokibi, DoppelPaymer, JSWorm/Nemty/Nefilim, RagnarLocker,\nand Snatch.\n\nThe authors of the Maze ransomware maintain a website where they list their recent victims\nand publish a partial or a full dump of the documents they have managed to exfiltrate\nfollowing a network compromise.\n\n\n-----\n\n**_Website with leaked data published by Maze operators_**\n\n## Ransomware cartel\n\nIn June 2020, the criminals behind Maze teamed up with two other threat actor groups,\n[LockBit and](https://www.bleepingcomputer.com/news/security/ransomware-gangs-team-up-to-form-extortion-cartel/) [RagnarLocker, essentially forming a ‘ransomware cartel’. The data stolen by](https://www.bleepingcomputer.com/news/security/maze-ransomware-adds-ragnar-locker-to-its-extortion-cartel/)\nthese groups now gets published on the blog maintained by the Maze operators.\n\n\n-----\n\nIt wasn t just the hosting of exfiltrated documents where the criminals pooled their efforts –\napparently they are also sharing their expertise. Maze now uses execution techniques that\n[were previously only used by RagnarLocker.](https://threatpost.com/maze-ransomware-ragnar-locker-virtual-machine/159350/)\n\n## Brief technical overview\n\nThe Maze ransomware is typically distributed as a PE binary (EXE or DLL depending on the\nspecific scenario) which is developed in C/C++ and obfuscated by a custom protector. It\nemploys various tricks to hinder static analysis, including dynamic API function imports,\ncontrol flow obfuscation using conditional jumps, replacing RET with JMP dword ptr [esp-4],\nreplacing CALL with PUSH + JMP, and several other techniques.\n\nTo counter dynamic analysis, this Trojan will also terminate processes typically used by\nresearchers, e.g. procmon, procexp, ida, x32dbg, etc.\n\nThe cryptographic scheme used by Maze consists of several levels:\n\nTo encrypt the content of the victim’s files, the Trojan securely generates unique keys\nand nonce values to use with the ChaCha stream cipher;\nThe ChaCha keys and nonce values are encrypted by a session public RSA-2048 key\nwhich is generated when the malware is launched;\nThe session private RSA-2048 key is encrypted by the master public RSA-2048 key\nhardcoded in the Trojan’s body.\n\nThis scheme is a variation of a more or less typical approach used by developers of modern\nransomware. It allows the operators to keep their master private RSA key secret when\nselling decryptors for each individual victim, and it also ensures that a decryptor purchased\nby one victim won’t help others.\n\nWhen executing on a machine, Maze ransomware will also attempt to determine what kind of\nPC it has infected. It tries to distinguish between different types of system (‘backup server’,\n‘domain controller’, ‘standalone server’, etc.). Using this information in the ransom note, the\nTrojan aims to further scare the victims into thinking that the criminals know everything about\nthe affected network.\n\n\n-----\n\n**_Strings that Maze uses to generate the ransom note_**\n\n**_Fragment of the procedure that generates the ransom note_**\n\n## How to avoid and prevent\n\nRansomware is evolving day by day, meaning a reactive approach to avoid and prevent\ninfection is not profitable. The best defense against ransomware is proactive prevention\nbecause often it is too late to recover data once they have been encrypted.\n\nThere are a number of recommendations that may help prevent attacks like these:\n\n\n-----\n\n1. Keep your OS and applications patched and up to date.\n2. Train all employees on cybersecurity best practices.\n3. Only use secure technology for remote connection in a company local network.\n4. Use endpoint security with behavior detection and automatic file rollback, such\n\n[asKaspersky Endpoint Security for Business.](https://www.kaspersky.com/small-to-medium-business-security/endpoint-select)\n5. Use the latest [threat intelligence information to detect an attack quickly, understand](https://www.kaspersky.com/enterprise-security/threat-intelligence)\n\nwhat countermeasures are useful, and prevent it from spreading.\n\n## Detection\n\nKaspersky products protect against this ransomware, detecting it as Trojan[Ransom.Win32.Maze; it is blocked by Behavior-based Protection as](https://www.kaspersky.com/enterprise-security/wiki-section/products/behavior-based-protection)\nPDM:Trojan.Win32.Generic.\n\n[We safeguard our customers with the best Ransomware Protection technologies.](https://www.kaspersky.com/enterprise-security/wiki-section/products/ransomware-protection)\n\n\n-----\n\n**_TIP Cloud Sandbox report summary and execution map with mapping on MITRE_**\n**_ATT&CK Framework_**\n\n## IOCs\n\n[2332f770b014f21bcc63c7bee50d543a](https://opentip.kaspersky.com/2332f770b014f21bcc63c7bee50d543a/)\n\n[CE3A5898E2B2933FD5216B27FCEACAD0](https://opentip.kaspersky.com/CE3A5898E2B2933FD5216B27FCEACAD0/)\n\n[54C9A5FC6149007E9B727FCCCDAFBBD4](https://opentip.kaspersky.com/54C9A5FC6149007E9B727FCCCDAFBBD4/)\n\n[8AFC9F287EF0F3495B259E497B30F39E](https://opentip.kaspersky.com/8AFC9F287EF0F3495B259E497B30F39E/)\n\n[Cybercrime](https://securelist.com/tag/cybercrime/)\n[Data leaks](https://securelist.com/tag/data-leaks/)\n[Doxing](https://securelist.com/tag/doxing/)\n[Exploit Kits](https://securelist.com/tag/exploit-kits/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Phishing](https://securelist.com/tag/phishing/)\n[Ransomware](https://securelist.com/tag/ransomware/)\n[Trojan](https://securelist.com/tag/trojan/)\n\nAuthors\n\nFedor Sinitsyn\n\n\n-----\n\nNikita Galimov\n\n[Vladimir Kuskov](https://securelist.com/author/vladimirkuskov/)\n\nLife of Maze ransomware\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-21 - Life of Maze ransomware.pdf"
    ],
    "report_names": [
        "2020-10-21 - Life of Maze ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535938,
    "ts_updated_at": 1743041357,
    "ts_creation_date": 1653766579,
    "ts_modification_date": 1653766579,
    "files": {
        "pdf": "https://archive.orkl.eu/ed32c33130254e66aba82a37d9f64c7a32a1e1c8.pdf",
        "text": "https://archive.orkl.eu/ed32c33130254e66aba82a37d9f64c7a32a1e1c8.txt",
        "img": "https://archive.orkl.eu/ed32c33130254e66aba82a37d9f64c7a32a1e1c8.jpg"
    }
}