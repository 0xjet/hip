{
    "id": "3a13c30f-3cd2-4390-92aa-d3cdece56280",
    "created_at": "2023-01-12T15:08:19.832487Z",
    "updated_at": "2025-03-27T02:09:29.555766Z",
    "deleted_at": null,
    "sha1_hash": "68c7c487360ae9c0441ff5a2db8639333f4c9a59",
    "title": "2020-09-02 - Inside the “fallguys” malware that steals your browsing data and gaming IMs; Continued attack on open source software",
    "authors": "",
    "file_creation_date": "2022-05-28T19:27:31Z",
    "file_modification_date": "2022-05-28T19:27:31Z",
    "file_size": 3011279,
    "plain_text": "# Inside the “fallguys” malware that steals your browsing data and gaming IMs; Continued attack on open source software\n\n**blog.sonatype.com/inside-the-fallguys-malware**\n\n\n-----\n\nThis weekend a report emerged of mysterious npm malware stealing sensitive information\nfrom Discord apps and web browsers installed on a user’s machine.\n\nThe malicious component called “fallguys” lived on npm downloads impersonating an API\n[for the widely popular video game, Fall Guys: Ultimate Knockout. Its actual purpose,](https://en.wikipedia.org/wiki/Fall_Guys)\nhowever, was rather sinister.\n\nAs first reported by _[ZDNet and analyzed by the npm security team, the component when](https://www.zdnet.com/article/malicious-npm-package-caught-trying-to-steal-sensitive-discord-and-browser-files/)_\nincluded in your development builds would run alongside your program, and access the\nfollowing files:\n\n1. /AppData/Local/Google/Chrome/User\\x20Data/Default/Local\\x20Storage/leveldb\n2. /AppData/Roaming/Opera\\x20Software/Opera\\x20Stable/Local\\x20Storage/leveldb\n3. /AppData/Local/Yandex/YandexBrowser/User\\x20Data/Default/Local\\x20Storage/leveldb\n4. /AppData/Local/BraveSoftware/Brave\nBrowser/User\\x20Data/Default/Local\\x20Storage/leveldb\n5. /AppData/Roaming/discord/Local\\x20Storage/leveldb\n\nThe file list comprises the local storage leveldb files of different web browsers, such as\nChrome, Opera, Yandex, and Brave, along with any locally installed Discord apps.\n\n[LevelDB is a key-value storage format mainly used by web browsers to store data especially](https://en.wikipedia.org/wiki/LevelDB)\nthat relates to a user’s web browsing sessions.\n\n\n-----\n\nThe fallguys component would pry on these files and upload them to a third-party Discord\nserver, e.g. via [webhooks.](https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks)\n\n## A peek inside npm “fallguys”\n\nNpm [removed the malicious package, but fortunately we retain a copy of all components in a](https://www.npmjs.com/advisories/1552)\nsecure archive, so the Sonatype Security Research team was able to quickly analyze the\nmalware. In fact, we got this into our data well before the news broke so Nexus users are\nsafe!\n\nIn this Nexus Intelligence Insights post, we share a first look inside “fallguys”.\n\n**Vulnerability identifier: sonatype-2020-0774**\n\n**Vulnerability type: Embedded Malicious Code**\n\n**Impacted package:** _fallguys as formerly present in npm downloads_\n\n**CVSS 3.1 Severity Metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H**\n\n**CVSS3.1 Score: 10 (Critical)**\n\nWhile “fallguys” package was likely created with malicious intent from the beginning, the\npackage exhibits outright suspicious behavior in version 1.0.6.\n\nThere are three files found in version 1.0.6. One is a README which touts the malware\nbeing a Fall Guys game API to gain some trust from the user and the other two files include\nthe application manifest (“package.json”), and the main “index.js”.\n\n\n-----\n\n**The README.MD file present in“fallguys” npm malware**\n\nImage source: Sonatype\n\nThe manifest reveals nothing out of the blue, but in “index.js” we see a whole lot going on:\n\nThe very first constant “_0x13e5” is a cryptic array containing different strings and locations\nof multiple “leveldb” files the malware would eventually begin reading. This is all part of the\nobfuscation process, to jam different strings the application would need into a single array\nand read from this array.\n\nFor example, on line 28, the variable assignment obtains a value from this very “_0x13e5”\narray at an obfuscated subscript address “_0xe64ed6” (15093462).\n\nThere is also mention of strings such as “username”, “email”, “phone”, “Token grabber”, etc.\nbut their purpose doesn’t become immediately obvious to an analyst.\n\n\n-----\n\n**Obfuscated code in index.js file of “fallguys” with Discord webhooks**\n(Spread out by us to make it more legible)\nImage source: Sonatype\n\nOn line 35, we see the “webhook” variable containing the URL to the attacker’s Discord app\nwhich is where data read from the “leveldb” files we list above, would be posted to:\n\nvar webhook =\n'https://discordapp[.]com/api/webhooks/746189410042904617/RQVJEOhzAblK5FlkQWIXkWfKfg5BFCdsjTeVueAIrVLaQMTvHgbuhuqFafPZYHfwnEq'\n\nAt the time of writing, our tests confirm the webhook endpoint is no longer responsive and\nwas likely brought down by Discord:\n\n**Discord webhook where “fallguys” malware would post sensitive information to**\n\n\n-----\n\nThe send function also has a nested JSON object which appears to contain the profile\nmetadata with bits such as the author name, avatar thumbnail, username, email, etc.\n\n**The “send” function within the malicious “fallguys” component**\n\nImage source: Sonatype\n\n## Mostly your browser data, nothing else\n\nIn an age where adversaries find innovative ways to pollute the software supply chain via\nattacks such as [Octopus Scanner, or leverage typosquatting techniques to mine Bitcoins, it](https://blog.sonatype.com/octopus-scanner-compromises-26-oss-projects-on-github)\nis certainly odd for malware to exclusively target browser data stores and Discord files\nwithout touching more sensitive areas of a system.\n\n“The malicious package appears to have been performing some sort of reconnaissance,\ngathering data on victims, and trying to assess what sites the infected developers were\naccessing, before delivering more targeted code via an update to the package later down the\nroad,” states the ZDNet report.\n\nThankfully, this malware was caught early and has only been downloaded around 300 times.\nHowever, we may not always be so lucky.\n\n## Our New Normal\n\n[According to our 2020 State of the Software Supply Chain report, next-generation software](https://www.sonatype.com/2020ssc)\nsupply chain “attacks” are far more sinister because bad actors are no longer waiting for\npublic vulnerability disclosures. Instead, they are taking the initiative and actively injecting\nmalicious code into open source projects that feed the global supply chain.\n\n\n-----\n\nBy shifting their focus upstream, such as with open-source malware in fallguys, bad\nactors can infect a single component, which will then be distributed “downstream” using\nlegitimate software workflows and update mechanisms.\n\nOur 2020 report also shows that this is happening at a rapidly increased rate. In fact, there\nwas a 430% increase in next-generation software supply chain attacks over the past year.\nKeeping this in mind, it is virtually impossible to manually chase and keep track of such\ncomponents.\n\nSonatype’s world-class security research data, combined with our automated malware\ndetection technology safeguards your developers, customers, and software supply chain\nfrom infections like these.\n\nDevOps-native organizations with the ability to continuously deploy software releases have\nan automation advantage that allows them to stay one step ahead of malicious intent.\nSonatype Nexus customers were notified of sonatype-2020-0774 within hours of the\ndiscovery, and their development teams automatically received instructions on how to\nremediate the risk. Their browsing history and gaming IMs are safe.\n\nIf you're not a Sonatype customer and want to find out if your code is vulnerable, you can\nuse Sonatype's free [Nexus Vulnerability Scanner to find out quickly.](https://www.sonatype.com/appscan)\n\nVisit the [Nexus Intelligence Insights page for a deep dive into other vulnerabilities like this](https://www.sonatype.com/nexus-intelligence-insights)\none or subscribe to automatically receive Nexus Intelligence Insights hot off the press.\n\nTags: [vulnerabilities,](https://blog.sonatype.com/topic/vulnerabilities) [featured,](https://blog.sonatype.com/topic/featured) [Nexus Intelligence Insights](https://blog.sonatype.com/topic/nexus-intelligence-insights)\n\n\n-----\n\n### Written by Ax Sharma\n\nAx is a Security Researcher at Sonatype and Engineer who holds a passion for perpetual\nlearning. His works and expert analyses have frequently been featured by leading media\noutlets. Ax's expertise lies in security vulnerability research, reverse engineering, and\nsoftware development. In his spare time, he loves exploiting vulnerabilities ethically and\neducating a wide range of audiences.\n\nFollow me on:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-02 - Inside the “fallguys” malware that steals your browsing data and gaming IMs; Continued attack on open source software.pdf"
    ],
    "report_names": [
        "2020-09-02 - Inside the “fallguys” malware that steals your browsing data and gaming IMs; Continued attack on open source software.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536099,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653766051,
    "ts_modification_date": 1653766051,
    "files": {
        "pdf": "https://archive.orkl.eu/68c7c487360ae9c0441ff5a2db8639333f4c9a59.pdf",
        "text": "https://archive.orkl.eu/68c7c487360ae9c0441ff5a2db8639333f4c9a59.txt",
        "img": "https://archive.orkl.eu/68c7c487360ae9c0441ff5a2db8639333f4c9a59.jpg"
    }
}