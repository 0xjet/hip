{
    "id": "8cd4449b-9716-4d89-8ca6-513dbcfca40b",
    "created_at": "2022-10-25T16:48:24.36569Z",
    "updated_at": "2025-03-27T02:16:20.869192Z",
    "deleted_at": null,
    "sha1_hash": "5780a1382be59719a980376feb783590e422b1aa",
    "title": "BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents",
    "authors": "Kaspersky",
    "file_creation_date": "2016-04-04T03:08:53Z",
    "file_modification_date": "2016-04-04T03:08:53Z",
    "file_size": 442079,
    "plain_text": "# BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents\n\n###### By GReAT on January 28, 2016. 11:01 am\n\n\n[RESEARCH](https://securelist.com/all?category=24)\n\n\n[APT](https://securelist.com/all?tag=538) [BLACKENERGY](https://securelist.com/all?tag=580) [DDOS-ATTACKS](https://securelist.com/all?tag=533) [SCADA](https://securelist.com/all?tag=730) [SOCIAL ENGINEERING](https://securelist.com/all?tag=29) [WIPER](https://securelist.com/all?tag=214)\n\n##### GReAT\n\nKaspersky Lab's Global Research & Analysis Team\n\n\n[@e_kaspersky/great](http://twitter.com/e_kaspersky/great)\n\n\nLate last year, a wave of cyber­attacks hit several critical\n\nsectors in Ukraine. Widely discussed in the media, the\n\n[attacks took advantage of known BlackEnergy Trojans as](https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/)\n\nwell as several new modules.\n\nBlackEnergy is a Trojan that was created by a hacker known\n\nas Cr4sh. In 2007, he reportedly stopped working on it and\n\n[sold the source code for an estimated $700. The source code](http://archive.is/RFBU)\n\nappears to have been picked by one or more threat actors\n\nand was used to conduct DDoS attacks against Georgia in\n\n[2008. These unknown actors continued launching DDoS](https://securelist.com/analysis/publications/36309/black-ddos/)\n\n[attacks over the next few years. Around 2014, a specific user](https://securelist.com/analysis/publications/36309/black-ddos/)\n\ngroup of BlackEnergy attackers came to our attention when\n\nthey began deploying SCADA­related plugins to victims in the\n\nCS d d h ld hi i di d\n\n\n-----\n\nFor simplicity, we’re calling them the BlackEnergy APT group.\n\nOne of the prefered targets of the BlackEnergy APT has\n\nalways been Ukraine. Since the middle of 2015, one of the\n\npreferred attack vectors for BlackEnergy in Ukraine has been\n\nExcel documents with macros that drop the Trojan to disk if\n\nthe user chooses to run the script in the document.\n\nA few days ago, we discovered a new document that appears\n\nto be part of the ongoing BlackEnergy APT group attacks\n\nagainst Ukraine. Unlike previous Office files used in previous\n\nattacks, this is not an Excel workbook, but a Microsoft Word\n\ndocument. The lure used a document mentioning the Ukraine\n\n“Right Sector” party and appears to have been used against a\n\ntelevision channel.\n\n## Introduction\n\nAt the end of the last year, a wave of attacks hit several\n\ncritical sectors in Ukraine. Widely discussed in the media and\n\nby our colleagues from ESET, iSIGHT Partners and other\n\ncompanies, the attacks took advantage of both known\n\nBlackEnergy Trojans as well as several new modules. A very\n\ngood analysis and overview of the BlackEnergy attacks in\n\nUkraine throughout 2014 and 2015 was published by the\n\nUkrainian security firm Cys Centrum (the text is only available\n\n_in Russian for now, but can be read via Google Translate)._\n\nIn the past, we have written about BlackEnergy, focusing on\n\ntheir destructive payloads, Siemens equipment exploitation\n\nand router attack plugins. You can read blogs published by\n\nmy GReAT colleagues Kurt Baumgartner and Maria\n\n[Garnaeva here and here. We also published about the](https://securelist.com/blog/research/68838/be2-extraordinary-plugins-siemens-targeting-dev-fails/)\n\n[BlackEnergy DDoS attacks.](https://securelist.com/analysis/publications/36309/black-ddos/)\n\nSince mid­2015, one of the preferred attack vectors for\n\nBlackEnergy in Ukraine has been Excel documents with\n\nmacros which drop the trojan to disk if the user chooses to\n\n\n-----\n\nFor the historians out there, Office documents with macros\n\nwere a huge problem in the early 2000s, when Word and\n\nExcel supported Autorun macros. That meant that a virus or\n\ntrojan could run upon the loading of the document and\n\nautomatically infect a system. Microsoft later disabled this\n\nfeature and current Office versions need the user to\n\nspecifically enable the Macros in the document to run them.\n\nTo get past this inconvenience, modern day attackers\n\ncommonly rely on social engineering, asking the user to\n\nenable the macros in order to view “enhanced content”.\n\nFew days ago, we came by a new document that appears to\n\nbe part of the ongoing attacks BlackEnergy against Ukraine.\n\nUnlike previous Office files used in the recent attacks, this is\n\nnot an Excel workbook, but a Microsoft Word document:\n\n“$RR143TB.doc” (md5:\n\ne15b36c2e394d599a8ab352159089dd2)\n\nThis document was uploaded to a multiscanner service from\n\nUkraine on Jan 20 2016, with relatively low detection. It has a\n\ncreation_datetime and last_saved field of 2015­07­27\n\n10:21:00. This means the document may have been created\n\nand used earlier, but was only recently noticed by the victim.\n\nUpon opening the document, the user is presented with a\n\ndialog recommending the enabling of macros to view the\n\ndocument.\n\n\n-----\n\nInterestingly, the document lure mentions “Pravii Sektor” (the\n\n[Right Sector), a nationalist party in Ukraine. The party was](https://en.wikipedia.org/wiki/Right_Sector)\n\nformed in November 2013 and has since played an active\n\nrole in the country’s political scene.\n\nTo extract the macros from the document without using Word,\n\nor running them, we can use a publicly available tool such as\n\noledump by Didier Stevens. Here’s a brief cut and paste:\n\n\n-----\n\nAs we can see, the macro builds a string in memory that\n\ncontains a file that is created and written as “vba_macro.exe”.\n\nThe file is then promptly executed using the Shell command.\n\nThe vba_macro.exe payload (md5:\n\nac2d7f21c826ce0c449481f79138aebd) is a typical\n\nBlackEnergy dropper. It drops the final payload as\n\n“%LOCALAPPDATA%\\FONTCACHE.DAT”, which is a DLL\n\nfile. It then proceeds to run it, using rundll32:\n\nrundll32.exe “%LOCALAPPDATA%\\FONTCACHE.DAT”,#1\n\nTo ensure execution on every system startup, the dropper\n\ncreates a LNK file into the system startup folder, which\n\nexecutes the same command as above on every system\n\nboot.\n\n%APPDATA%\\Microsoft\\Windows\\Start\n\nMenu\\Programs\\Startup\\{D0B53124­E232­49FC­9EA9­\n\n75FA32C7C6C3}.lnk\n\n\n-----\n\n3fa9130c9ec44e36e52142f3688313ff) is a minimalistic\n\nBlackEnergy (v3) trojan that proceeds to connect to its\n\nhardcoded C&C server, 5.149.254.114, on Port 80. The\n\nserver was previously mentioned by our colleagues from\n\n[ESET in their analysis earlier this month. The server is](http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/)\n\ncurrently offline, or limits the connections by IP address. If the\n\nserver is online, the malware issues as HTTP POST request\n\nto it, sending basic victim info and requesting commands.\n\nThe request is BASE64 encoded. Some of the fields contain:\n\nb_id=BRBRB­…\n\nb_gen=301018stb\n\nb_ver=2.3\n\nos_v=2600\n\nos_type=0\n\nThe b_id contains a build id and an unique machine identifier\n\nand is computed from system information, which makes it\n\nunique per victim. This allows the attackers to distinguish\n\nbetween different infected machines in the same network.\n\nThe field b_gen seems to refer to the victim ID, which in this\n\ncase is 301018stb. STB could refer to the Ukrainian TV\n\n[station “STB”, http://www.stb.ua/ru/. This TV station has been](http://www.stb.ua/ru/)\n\npublicly mentioned as a victim of the BlackEnergy Wiper\n\nattacks in October 2015.\n\n## Conclusions\n\nBlackEnergy is a highly dynamic threat actor and the current\n\nattacks in Ukraine indicate that destructive actions are on\n\ntheir main agenda, in addition to compromising industrial\n\ncontrol installations and espionage activities.\n\n\n-----\n\nbeen actively targeted in recent years. If your organization\n\nfalls into these categories, then you should take BlackEnergy\n\ninto account when designing your defences:\n\nICS, Energy, government and media in Ukraine\n\nICS/SCADA companies worldwide\n\nEnergy companies worldwide\n\nThe earliest signs of destructive payloads with BlackEnergy\n\ngo back as far as June 2014. However, the old versions were\n\ncrude and full of bugs. In the recent attacks, the developers\n\nappear to have gotten rid of the unsigned driver which they\n\nrelied upon to wipe disks at low level and replaced it with\n\nmore high level wiping capabilities that focus on file\n\nextensions as opposed on disks. This is no less destructive\n\nthan the disk payloads, of course, and has the advantage of\n\nnot requiring administrative privileges as well as working\n\nwithout problems on modern 64­bit systems.\n\nInterestingly, the use of Word documents (instead of Excel)\n\n[was also mentioned by ICS­CERT, in their alert 14­281­01B.](https://ics-cert.us-cert.gov/alerts/ICS-ALERT-14-281-01B)\n\nIt is particularly important to remember that all types of Office\n\ndocuments can contain macros, not just Excel files. This also\n\nincludes Word, as shown here and alerted by ICS­CERT and\n\nPowerPoint, as previously mentioned by Cys Centrum.\n\nIn terms of the use of Word documents with macros in APT\n\nattacks, we recently observed the Turla group relying on\n\nWord documents with macros to drop malicious payloads\n\n_(Kaspersky Private report available). This leads us to believe_\n\nthat many of these attacks are successful and their popularity\n\n\n-----\n\nWe will continue to monitor the BlackEnergy attacks in\n\nUkraine and update our readers with more data when\n\navailable.\n\nMore information about BlackEnergy APT and extended IOCs\n\nare available to customers of Kaspersky Intelligence\n\n[Services. Contact intelreports@kaspersky.com.](mailto:///intelreports@kaspersky.com)\n\nKaspersky Lab products detect the various trojans mentioned\n\nhere as: Backdoor.Win32.Fonten.* and\n\nHEUR:Trojan­Downloader.Script.Generic.\n\n**To know more about countering BlackEnergy and similar**\n\n**[offensives, read this article on Kaspersky Business Blog.](https://business.kaspersky.com/black-energy/5091/)**\n\n## Indicators of compromise\n\n#### Word document with macros (Trojan- Downloader.Script.Generic):\n\ne15b36c2e394d599a8ab352159089dd2\n\n#### Dropper from Word document (Backdoor.Win32.Fonten.y):\n\nac2d7f21c826ce0c449481f79138aebd\n\n#### Final payload from Word document (Backdoor.Win32.Fonten.o):\n\n3fa9130c9ec44e36e52142f3688313ff\n\n#### BlackEnergy C&C Server:\n\n5.149.254[.]114\n\n\n-----\n\n###### PNG\n\n\n###### PLUGX\n\n\n###### MALWARE: A GOOD HACKER IS AN APOLOGETIC\n\n\n###### EMBEDDED – MALICIOUS PAYLOAD HIDDEN IN A\n\n\n###### “ALL YOUR\n\n CREDS ARE BELONG TO US”\n\n\n##### THERE IS 1 COMMENT\n\n[If you would like to comment on this article you must first login](https://securelist.com/wp-login.php)\n\n\nLarry Seltzer\n\nPosted on January 28, 2016. 6:28 pm\n\nYou’d think Office would view writing an EXE file as inherently\n\nsuspicious behavior. Unless they have a lot of customers writing\n\ncompilers in Word macros.\n\n\n[Reply](https://securelist.com/blog/research/73440/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/?replytocom=623032#respond)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/igygz8ihex1hok5r1dp215ui0gz1ghwr"
    ],
    "report_names": [
        "Kaspersky_BlackEnergy-APT-Attacks-in-Ukraine-employ-spearphishing-with-Word-documents(Jan-28-16)"
    ],
    "threat_actors": [
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1459739333,
    "ts_modification_date": 1459739333,
    "files": {
        "pdf": "https://archive.orkl.eu/5780a1382be59719a980376feb783590e422b1aa.pdf",
        "text": "https://archive.orkl.eu/5780a1382be59719a980376feb783590e422b1aa.txt",
        "img": "https://archive.orkl.eu/5780a1382be59719a980376feb783590e422b1aa.jpg"
    }
}