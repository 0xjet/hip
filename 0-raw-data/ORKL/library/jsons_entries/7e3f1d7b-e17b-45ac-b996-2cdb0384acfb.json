{
    "id": "7e3f1d7b-e17b-45ac-b996-2cdb0384acfb",
    "created_at": "2022-10-25T16:48:10.658179Z",
    "updated_at": "2025-03-27T02:17:05.859985Z",
    "deleted_at": null,
    "sha1_hash": "38acbad8aff8c9b4f21349dcd6a3e2fe44b2e9bf",
    "title": "VB2019-A Vine Climbing Over Great Firewall A Long-Term Attack to China",
    "authors": "",
    "file_creation_date": "2019-10-03T12:11:12Z",
    "file_modification_date": "2019-10-03T12:11:12Z",
    "file_size": 12425339,
    "plain_text": "## A vine climbing over the Great Firewall:\n A long-term attack against China\n\n##### Lion Gu, Bowen Pan\n\n Qi An Xin Threat Intelligence Center\n\n\n-----\n\n### About us.\n\n#### RedDrip Team (@RedDrip7)\n\n##### • A team of Qi-AnXin Threat Intelligence Center\n\n • Focus on threat intelligence and advanced targeted\n\n attacks tracing.\n\n • APT threat monitoring and tracing, uncovered several\n\n APT Groups.\n\n\n-----\n\n### Agenda\n\n#### • Introduction of PoisonVine\n\n • Capabilities and resources\n\n • Tactics, techniques and procedures(TTP)\n\n • Impact\n\n • Attribution\n\n • Conclusion\n\n\n-----\n\n### PoisonVine\n\n#### • PoisonVine（APT-C-01）\n\n##### • a rarely known APT group targeted China\n\n#### • Intent\n\n##### • political & military intelligence\n\n#### • Targets\n\n##### • government agencies\n • military person\n • research institutes\n • maritime agencies\n\n\n-----\n\n### PoisonVine Timeline\n\n\n###### 2007.12\n\n First discovered\n\n trojan which\n\n targeted a large\n\n shipping company\n\n\n###### Using “API string\n\n reverse” and “error\n\n API parameters” to\n\n evade detection\n\n\n###### 2009-2011 2013\n\n\n###### attacked. Website compromised\n\n with watering hole.\n\n\n###### 2018\n\n First disclosed.\n\n\n###### 2015.2\n\n Kanbox RAT\n\n\n###### Several military and\n\n government targets was\n\n\n###### 2008-2009 2012.12 2014. 9. 12\n\n\n###### Universities and\n\n military industry in\n\n China was attacked.\n\n\n###### First variant of\n\n ZxShell was\n\n found.\n\n\n###### 0day was\n\n discovered(CVE\n 2014-6352)\n\n\n###### 2017.10\n\n Several spear\n\n phishing attacks\n\n and using CVE\n 2017-8759\n\n\n-----\n\n### Capabilities and Resources\n\n#### • RATs\n\n##### • Commercial or open-source RAT\n\n • Poison Ivy, ZxShell\n • Customized\n\n • Kanbox RAT\n\n#### • Exploits\n\n##### • some document vulnerabilities\n\n • CVE-2012-0158\n • CVE-2014-6352 (0day)\n • CVE-2017-8759\n\n#### • Infrastructures\n\n##### • Dynamic domains\n\n\n###### PoisonVine\n\n\n###### Capabilities\n • Tools\n • Exploits\n\n\n###### Resources\n • Infrastructures\n\n\n-----\n\n### Capabilities and Resources\n\n#### • Poison Ivy\n\n\n-----\n\n### Capabilities and Resources\n\n#### • ZxShell Open source version\n\n###### Customized command\n\n\n-----\n\n### Capabilities and Resources\n\n#### • Kanbox RAT\n\n##### • keywords filtering for collection\n\n • “军”或“军事”(War)、“部队”(Army)\n • Cloud storage API for exfiltration\n\n\n-----\n\n### Capabilities and Resources\n\n#### • Customized shellcode loader\n\n##### • discovered in early 2018\n • .hta -> CVE-2017-8759\n\n###### 1 triggered .hta execute with CVE-2017-8759 2 drive-by download & execution\n\n\n-----\n\n### Capabilities and Resources\n\n#### • CVE-2014-6352\n\n##### • bypass the patch of CVE-2014-4114 used\n by Sandworm\n • 0-day\n\n • sample creation time on 4[th] Sep 2014\n • patched on Oct 2014\n\n\n-----\n\n### Capabilities and Resources\n\n#### • Infrastructure\n\n###### Dynamic Domains\n\n\n###### Domain registers\n C&C Legitimate website\n Website of Chinese\n chinamil.lflink.com Military\n www.chinamil.com.cn soagov.sytes.net State Oceanic soagov.zapto.org Administration soasoa.sytes.net www.soa.gov.cn\n\n\n###### Xinhua News xinhua.redirectme.net www.xinhuanet.com 126mailserver.serveftp.c Famous mail service om provider in China mail163.mypop3.net 126.com, 163.com\n kav2011.mooo.com safe360.dns05.com\n Chinese anti-virus\n cluster.safe360.dns05.co\n software\n m\n\n|DDNS Service Provider|Domains|\n|---|---|\n|ChangeIP|30|\n|No-IP|9|\n|DynDNS|2|\n|Afraid(FreeDNS)|1|\n|dnsExit|1|\n\n\n-----\n\n### Tactics, techniques and procedures\n\n#### • PoisonVine has a simple TTP.\n\n • Reconnaissance\n\n##### • on targets\n • important conferences in China\n mainland\n\n\n###### “Chinese Asia-Pacific Annual Meeting in 2013”\n\n\n-----\n\n### Tactics, techniques and procedures\n\n#### • Initial Access & Established Foothold\n\n##### • Spear-phishing with delivery decoys\n\n###### archived PE\n\n SFX\n\n\n###### RLO\n\n\n###### Filename paddings\n\n\n-----\n\n### Tactics, techniques and procedures\n\n#### • Collection & Exfiltration\n\n##### • documents, .doc/.ppt/.xls/.wps\n###### Hardcoded keywords:\n\n##### • keywords filtering\n###### military, international, technology, national\n\n\n-----\n\n### Tactics, techniques and procedures\n\n#### • Defense Evasion\n\n###### API name in reverse order\n\n\n###### Pass zero window handler to GetClientRect.\n • Real system Failed\n • AV heuristic detection Pass\n\n\n-----\n\n### Tactics, techniques and procedures\n\n#### • ATT&CK Matrix\n\n##### • T1193 Spearphishing Attachment\n • T1203 Exploitation for Client Execution\n • T1204 User Execution\n • T1170 Mshta\n • T1064 Scripting\n • T1102 Web Service\n • T1022 Data Encrypted\n • T1005 Data from Local System\n\n\n-----\n\n### Impact\n\n#### • Cloud Storage\n\n##### • Token hardcoded in payloads\n • 3GB file exfiltrated\n\n\n-----\n\n### Attribution\n\n#### • Language • Encoding\n\n##### • PMingLiU\n\n\n-----\n\n### Attribution\n\n#### • Identify information\n\n##### • email\n • phone number\n • region\n • name or ID\n\n###### Cloud Storage API leak\n\n\n###### Whois registration\n\n\n###### Whois protect service GDPR\n\n\n###### GDPR\n\n\n###### {\"status\":\"ok\",\"email\":\"\",\"phone\":\"15811848796\",\"spaceQuota\":1700807049216,\"spaceU\n\n\n-----\n\n### Attribution\n\n#### • Similar but different with another APT group “BlueMashroom”\n\n##### • same region\n • different ways of Execution & Persistence\n\n • hijacking shortcut file in startup paths\n • use regsvr32 to execute DLL\n\n\n-----\n\n### Conclusion\n\n#### • APT actors not always advanced, PoisonVine find its ways to\n\n improve efficient.\n\n • APT actors always considered reduce its signature in investigate\n\n and hide the attribution.\n\n • In the APT tracing process, finding intent of threat and attribution\n\n can always be an interesting game.\n\n\n-----\n\n# Thank you!\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://www.virusbulletin.com/uploads/pdf/conference_slides/2019/VB2019-GuPan.pdf"
    ],
    "report_names": [
        "VB2019-GuPan.pdf"
    ],
    "threat_actors": [
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1570104672,
    "ts_modification_date": 1570104672,
    "files": {
        "pdf": "https://archive.orkl.eu/38acbad8aff8c9b4f21349dcd6a3e2fe44b2e9bf.pdf",
        "text": "https://archive.orkl.eu/38acbad8aff8c9b4f21349dcd6a3e2fe44b2e9bf.txt",
        "img": "https://archive.orkl.eu/38acbad8aff8c9b4f21349dcd6a3e2fe44b2e9bf.jpg"
    }
}