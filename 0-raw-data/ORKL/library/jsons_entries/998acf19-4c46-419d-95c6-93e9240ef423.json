{
    "id": "998acf19-4c46-419d-95c6-93e9240ef423",
    "created_at": "2023-01-12T15:11:00.303941Z",
    "updated_at": "2025-03-27T02:13:50.356585Z",
    "deleted_at": null,
    "sha1_hash": "cfbc11b516a88cc9fc4694f04be0a10ef4b73e89",
    "title": "2021-03-26 - 20 Million Miners- Finding Malicious Cryptojacking Images in Docker Hub",
    "authors": "",
    "file_creation_date": "2022-05-28T19:07:02Z",
    "file_modification_date": "2022-05-28T19:07:02Z",
    "file_size": 363569,
    "plain_text": "# 20 Million Miners: Finding Malicious Cryptojacking Images in Docker Hub\n\n**[unit42.paloaltonetworks.com/malicious-cryptojacking-images/](https://unit42.paloaltonetworks.com/malicious-cryptojacking-images/)**\n\nAviv Sasson March 26, 2021\n\nBy [Aviv Sasson](https://unit42.paloaltonetworks.com/author/aviv-sasson/)\n\nMarch 26, 2021 at 6:00 AM\n\n[Category: Cloud,](https://unit42.paloaltonetworks.com/category/cloud/) [Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [cryptojacking,](https://unit42.paloaltonetworks.com/tag/cryptojacking/) [Cryptominers,](https://unit42.paloaltonetworks.com/tag/cryptominers/) [Docker,](https://unit42.paloaltonetworks.com/tag/docker/) [Docker Hub,](https://unit42.paloaltonetworks.com/tag/docker-hub/) [Monero](https://unit42.paloaltonetworks.com/tag/monero/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/malicious-cryptojacking-images/)\n\n## Executive Summary\n\nAs a cybercriminal, there are many ways to make a profit. One of the easiest ways is\ncryptojacking – the illegal use of someone else’s computing resources to mine\ncryptocurrencies. Container images are known as a simple way to distribute software, yet\nmalicious cryptojacking images are also a simple way for attackers to distribute their\ncryptominers.\n\nI decided to take an extensive look into Docker Hub and discovered 30 malicious images\n[with a total number of 20 million pulls (which means the images were downloaded 20 million](https://docs.docker.com/engine/reference/commandline/pull/)\ntimes) together accounting for cryptojacking operations worth US$200 000 In this post I will\n\n\n-----\n\nelaborate on my findings and why it is reasonable to assume that there are many other\nundiscovered malicious images on Docker Hub and other public registries.\n\n[Palo Alto Networks Prisma Cloud customers are protected from these threats through the](https://www.paloaltonetworks.com/prisma/cloud)\n[Cryptominers Runtime Detection feature and the Trusted Images feature. In addition, Palo](https://blog.paloaltonetworks.com/2020/05/cloud-container-image-trust-groups/)\n[Alto Networks Next-Generation Firewall customers with the Threat Prevention security](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\nsubscription are protected against the delivery of these images.\n\n## Finding Malicious Cryptojacking Images\n\nIn the last several years, Unit 42 researchers have been witnessing cloud-based\n[cryptojacking attacks in which miners are deployed using an image in Docker Hub.](https://unit42.paloaltonetworks.com/cryptojacking-docker-images-for-mining-monero/)\n\nThe cloud is popular for cryptojacking attacks due to two main reasons:\n\nThe cloud consists of many instances for each target (e.g. lots of CPUs, lots of\ncontainers, lots of virtual machines), which can translate to big mining profits.\nThe cloud is hard to monitor. Miners can run undetected for a long time, and without\nany detection mechanisms in place, they may run until the user finds an inflated cloud\nusage bill and realizes that something is wrong.\n\nModern cloud technology is largely based on containers, and in some environments, Docker\nHub is the default container registry. Attackers can take advantage of it to deploy miners on\ncompromised clouds.\n\nBecause of all of the facts mentioned above, I wanted to see if I could find malicious\ncryptojacking images in Docker Hub. In my research, I found 30 images from 10 different\nDocker Hub accounts that account for over 20 million pulls.\n\n[Individuals improve their mining efficiency by using mining pools, and so do adversaries.](https://en.wikipedia.org/wiki/Mining_pool)\n\nIt is possible to check how many cryptocurrencies were mined to a mining pool account by\ninspecting the mining pool. Half of the images I found used a mining pool that shares this\ninformation, and by extrapolating from that half I estimated that, in total, in all of the attacks,\nUS$200,000 worth of cryptocurrencies were mined.\n\n\n-----\n\nFigure 1. Research findings.\nIn order to better understand the findings, I began classifying the results. With the help of\npublic mining pools, I checked which cryptocurrency is mined, which cryptominer is used and\nhow many coins have been mined.\n\n## Coin Distribution\n\nMy first discovery, perhaps not surprising to our returning readers, is that the most popular\n[cryptocurrency for attackers to mine is Monero, just as we saw with Pro-Ocean,](https://unit42.paloaltonetworks.com/pro-ocean-rocke-groups-new-cryptojacking-malware/) [Cetus and](https://unit42.paloaltonetworks.com/cetus-cryptojacking-worm/)\nmany more.\n\nAttackers favor Monero for three reasons:\n\nMonero provides maximum anonymity. One of its features is that, unlike for other coins,\nMonero transitions are hidden. This privacy is perfect for cybercriminals because it\nmeans their activity is hidden. Hence, they won’t get banned from exchanges and it is\neasier for them to evade attempts to track their funds.\nThe Monero mining algorithm favors CPU mining, unlike many other cryptos that\nrequire ASICs or GPU for mining. This is convenient because all computers have\nCPUs. Thus, the miner can run effectively on any machine. This is even more suitable\nfor containers, of which the vast majority run without a GPU.\n[Monero is a popular coin, and its exchange volume is around US$100 million a day,](https://www.google.com/url?q=https://finance.yahoo.com/quote/XMR-USD/history?p%3DXMR-USD&sa=D&ust=1606727628435000&usg=AOvVaw3RCOii98QIhB-7oUPyfHEk)\nmaking it easy for the attackers to sell their coins.\n\nThe figure below demonstrates the cryptocurrency distribution of the cryptojacking images\nfound on Docker Hub.\n\n\n-----\n\nFigure 2. Cryptocurrency distribution.\n\n## Cryptominer Distribution\n\n[In most attacks that mine Monero, the attackers used XMRig, just as we saw with Hildegard](https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/)\n[and Graboid. XMRig is a popular Monero miner and is preferred by attackers because it’s](https://unit42.paloaltonetworks.com/graboid-first-ever-cryptojacking-worm-found-in-images-on-docker-hub/)\neasy to use, efficient and, most importantly, open source. Hence, attackers can modify its\ncode.\n\nFor example, most Monero cryptominers forcibly donate some percentage of their mining\ntime to the miner’s developers. One common modification attackers make is to change the\ndonation percentage to 0.\n\n\n-----\n\nFigure 3. Cryptominer distribution.\n\n## Image Tags\n\nContainer registries allow users to upgrade their images and in that process upload a new\ntag to the registry. Tags are a way to reference different versions of the same image.\n\nWhen examining the tags of the images, I found that some images have different tags for\ndifferent CPU architectures or operating systems. It seems like some attackers are versatile\nand add these tags in order to fit a broad range of potential victims that includes a number of\noperating systems (OS) and CPU architectures.\n\nIn some images, there are even tags with different types of cryptominers. This way, the\nattacker can choose the best cryptominer for the victim’s hardware.\n\nThe only thing that is common for all the tags in a certain image is the wallet address or the\nmining pool credentials. With the help of these identifiers, I could classify each campaign.\nAfter digging deeper, in some cases, I could see that there are numerous Docker Hub\naccounts that belong to the same campaign. For example, in previous research, Unit 42\n[found the malicious account azurenql. Now, we discovered that the campaign is broader and](https://unit42.paloaltonetworks.com/cryptojacking-docker-images-for-mining-monero/)\nincludes the accounts 021982, dockerxmrig, ggcloud1 and ggcloud2.\n\nIn my research, I was able to find additional images mining Monero for the same campaign\n[described in recent Unit 42 findings on azurenql, adding over 10 million more pulls under the](https://unit42.paloaltonetworks.com/cryptojacking-docker-images-for-mining-monero/)\nattacker’s name.\n\n\n-----\n\n## Conclusion\n\nThe cloud presents big opportunities for cryptojacking attacks. In my research, I used a\ncryptomining scanner that only detects simple cryptomining payloads. I also made sure any\nidentified image was malicious by correlating the wallet address to previous attacks. Even\nwith these simple tools, I was able to discover tens of images with millions of pulls. I suspect\nthat this phenomenon may be bigger than what I found, with many instances in which the\npayload is not easily detectable.\n\n[Palo Alto Networks Prisma Cloud customers are protected from these threats through the](https://www.paloaltonetworks.com/prisma/cloud)\n[Cryptominers Runtime Detection feature and the Trusted Images feature. In addition, Palo](https://blog.paloaltonetworks.com/2020/05/cloud-container-image-trust-groups/)\n[Alto Networks Next-Generation Firewall customers with the Threat Prevention security](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\nsubscription are protected against the delivery of these images.\n\nFigure 4. Prisma Cloud container incident notification.\n\n**Indicators of Compromise**\n\n**Docker Images**\n\n021982/155_138\n\n021982/66_42_53_57\n\n021982/66_42_93_164\n\n021982/xmrig\n\n021982/xmrig1\n\n021982/xmrig2\n\n021982/xmrig3\n\n021982/xmrig4\n\n021982/xmrig5\n\n021982/xmrig6\n\n021982/xmrig7\n\n\n-----\n\navfinder/gmdr\n\navfinder/mdadmd\n\ndocheck/ax\n\ndocheck/health\n\ndockerxmrig/proxy1\n\ndockerxmrig/proxy2\n\nggcloud1/ggcloud\n\nggcloud2/ggcloud\n\nkblockdkblockd/kblockd\n\nosekugatty/picture124\n\nosekugatty/picture128\n\ntempsbro/tempsbro\n\ntempsbro/tempsbro1\n\ntoradmanfrom/toradmanfrom\n\ntoradmanfrom/toradmanfrom1\n\nxmrigdocker/docker2\n\nxmrigdocker/docker3\n\nxmrigdocker/xmrig\n\nxmrigdocker/xmrig\n\nzenidine/nizadam\n\n**Get updates from**\n**Palo Alto**\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n\n-----\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-26 - 20 Million Miners- Finding Malicious Cryptojacking Images in Docker Hub.pdf"
    ],
    "report_names": [
        "2021-03-26 - 20 Million Miners- Finding Malicious Cryptojacking Images in Docker Hub.pdf"
    ],
    "threat_actors": [
        {
            "id": "7c053836-8f50-4d40-bc5c-7088967e1b57",
            "created_at": "2022-10-25T16:07:24.549525Z",
            "updated_at": "2025-03-27T02:02:10.278474Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra",
                "Iron Group",
                "Rocke"
            ],
            "source_name": "ETDA:Rocke",
            "tools": [
                "Godlua",
                "Kerberods",
                "LSD",
                "Pro-Ocean",
                "Xbash"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "905eabd9-2b7f-483d-86bd-0c72f96b4162",
            "created_at": "2023-01-06T13:46:39.02749Z",
            "updated_at": "2025-03-27T02:00:02.980813Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra"
            ],
            "source_name": "MISPGALAXY:Rocke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0b02af5f-2027-42b7-a6f2-51e2fd49ba7f",
            "created_at": "2022-10-25T15:50:23.360509Z",
            "updated_at": "2025-03-27T02:00:55.45329Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Rocke"
            ],
            "source_name": "MITRE:Rocke",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536260,
    "ts_updated_at": 1743041630,
    "ts_creation_date": 1653764822,
    "ts_modification_date": 1653764822,
    "files": {
        "pdf": "https://archive.orkl.eu/cfbc11b516a88cc9fc4694f04be0a10ef4b73e89.pdf",
        "text": "https://archive.orkl.eu/cfbc11b516a88cc9fc4694f04be0a10ef4b73e89.txt",
        "img": "https://archive.orkl.eu/cfbc11b516a88cc9fc4694f04be0a10ef4b73e89.jpg"
    }
}