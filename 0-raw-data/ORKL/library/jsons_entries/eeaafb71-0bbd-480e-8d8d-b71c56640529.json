{
    "id": "eeaafb71-0bbd-480e-8d8d-b71c56640529",
    "created_at": "2023-01-12T14:59:17.186232Z",
    "updated_at": "2025-03-27T02:06:07.02657Z",
    "deleted_at": null,
    "sha1_hash": "a6826a0683acbf496f1803e584ea50c0cfb59fb0",
    "title": "2020-11-20 - 360 File-less Attack Protection Intercepts the Banker Trojan BBtok Active in Mexico",
    "authors": "",
    "file_creation_date": "2022-05-28T03:46:43Z",
    "file_modification_date": "2022-05-28T03:46:43Z",
    "file_size": 976426,
    "plain_text": "# 360 File-less Attack Protection Intercepts the Banker Trojan BBtok Active in Mexico\n\n**[blog.360totalsecurity.com/en/360-file-less-attack-protection-intercepts-the-banker-trojan-bbtok-active-in-mexico/](https://blog.360totalsecurity.com/en/360-file-less-attack-protection-intercepts-the-banker-trojan-bbtok-active-in-mexico/)**\n\nNovember 20, 2020\n\nNov 20, 2020kate\n\n[Tweet](https://twitter.com/share)\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\nRecently, 360 Security Center has detected that a new banking Trojan BBtok has become\npopular in Mexico through its file-less attack protection function. The Trojan sends a\ncompressed package containing malicious lnk files to users through phishing emails or other\nmeans. When the user clicks on the malicious lnk, the carried powershell script will be\nactivated to execute subsequent attack payloads.\n\nThe overall virus operation process is as follows:\n\n\n-----\n\nThe content of the opened pdf is as follows:\n\nAfter BBtok is deployed on the victim’s machine, it will run a backdoor module. The attacker\ncan execute different malicious functions by issuing control commands, including creating a\nfalse bank security detection window to trick the user into entering login credentials, thereby\nstealing the user’s account password.\n\n## File-less Attack\n\nThe file of Lnk carries malicious powershell commands to trick the user into clicking, activate\nthe malicious code, download and execute the subsequent malicious payload:\n\n\n-----\n\nBase64 encrypted and stored the downloaded shellcode. After decryption, it is a Loader\nwritten by .Net.\n\n## Persistence\n\nLoader will replace winmm.dll in the system directory to realize virus residency and self-start:\n\nWinmm.dll loads malicious dynamic libraries:\n\n\n-----\n\n## Anti-virus\n\nLoader will then load the anti-virus driver. When the user is a 64-bit system, it uses the open\nsource KDU (Kernel Driver Utility) to load:\n\nKDU (https://github.com/hfiref0x/KDU) uses a vulnerable driver of legitimate software to\naccess arbitrary kernel memory with read/write attributes:\n\n\n-----\n\nThe loaded confrontation driver will violently enumerate and remove all registry callbacks:\n\nThen delete all the registry entries of mainstream anti-virus software to make the anti-virus\nsoftware invalid:\n\n\n-----\n\n## Bypass Antivirus\n\n\n-----\n\nBBtok extracts the main backdoor control program from the compressed package. Hackers\ncan control the victim’s machine by issuing the backdoor instructions in the picture, including\nwindow control, process management, key logger, clipboard hijacking and other functions.\n\n## Banker Trojan\n\nHackers can also choose to simulate different bank false security verification interfacs\nthrough backdoor control commands, and steal user login credentials for Santander,\nBanBajio, ScotiaBank, AFIRME, Banregio, Banco Azteca, Multiva, Inbursa, HSBC, Banorte,\nCitiBanamex, BBVA, etc.\n\n\n-----\n\nThe picture below shows the fake interface 1:\n\n\n-----\n\nFake interface 2:\n\n\n-----\n\nFake interface 3:\n\n\n-----\n\nFake interface 4:\n\n\n-----\n\nFake interface 5:\n\n\n-----\n\nFake interface 6:\n\n\n-----\n\n## Security Advice：\n\n(1) Do not open emails from unknown sources. You should forward such emails to the\nsecurity department for investigation, and then open them after confirming security.\n\n(2) Using the 360 file-less attack protection function can effectively block malicious scripts,\nmalicious documents, LOLBins and other file-less attacks.\n\n(3) 360 Total Security can detect and block the latest malicious attacks in time to protect the\ninformation security of users. It is recommended to use the official website.\n\n\n-----\n\nMD5:\n\nf0bb745b4ab8b3eb36a5a6bd0c31d9c3\n\nURL:\n\nhttp[:]//bIt.dO/fJZR3\n\nhttp[:]//diprolisa.mx/archivos/project/a9sid9aisd9\n\nhttp[:]//diprolisa.mx/archivos/pdf\n\nhttp[:]//mexicanagm.mx/contacto/gambler.php\n\n[Learn more about 360 Total Security](https://www.360totalsecurity.com/en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-20 - 360 File-less Attack Protection Intercepts the Banker Trojan BBtok Active in Mexico.pdf"
    ],
    "report_names": [
        "2020-11-20 - 360 File-less Attack Protection Intercepts the Banker Trojan BBtok Active in Mexico.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535557,
    "ts_updated_at": 1743041167,
    "ts_creation_date": 1653709603,
    "ts_modification_date": 1653709603,
    "files": {
        "pdf": "https://archive.orkl.eu/a6826a0683acbf496f1803e584ea50c0cfb59fb0.pdf",
        "text": "https://archive.orkl.eu/a6826a0683acbf496f1803e584ea50c0cfb59fb0.txt",
        "img": "https://archive.orkl.eu/a6826a0683acbf496f1803e584ea50c0cfb59fb0.jpg"
    }
}