{
    "id": "10675082-733d-403e-b523-f7cb65db2c4a",
    "created_at": "2022-10-25T16:48:16.666291Z",
    "updated_at": "2025-03-27T02:05:58.980217Z",
    "deleted_at": null,
    "sha1_hash": "d99e814a50f3a186eb705aef6803f4df1b44094e",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-07-31T15:47:58Z",
    "file_modification_date": "2018-08-01T15:24:32Z",
    "file_size": 3923296,
    "plain_text": "# Recommended Practice: Updating Antivirus in an Industrial Control SystemU.S. Department of Homeland Security Seal, NCCIC, National Cybersecurity and Communications Integration Center\n\n\nRecommended Practice: Updating\nAntivirus in an Industrial Control System\n\nIrregular Issuance Report\n\nIR-18-214\n\nAugust 2, 2018\n\n\n-----\n\n##### Recommended Practice: Updating Antivirus in an Industrial Control System\n\nIR-18-214 NUMBER\n\nIrregular Issuance Report August 2, 2018 DATE\n\n\n#### Table of Contents\n\n\n1. Overview.............................................................3\n\n2. Antivirus Update Strategies...............................3\n\n3. Considerations...................................................5\n\n4. Test and Validation............................................6\n\n\n#### Figures\n\n\nFigure 1 Recommended secure network\narchitecture............................................................4\n\n_DISCLAIMER: This report is provided “as is” for informational purposes only. The Department of Homeland Security (DHS)_\n_does not provide any warranties of any kind regarding any information within. DHS does not endorse any commercial_\n_product or service referenced in this advisory or otherwise. This document is distributed as TLP:White: Sources are at_\n_liberty to specify additional intended limits of the sharing: these must be adhered to. For more information on the Traffic_\n_Light Protocol, see https://www.us-cert.gov/tlp._\n\n\n-----\n\n#### Acronyms\n\n\nAV antivirus\n\nCRC cyclic redundancy check\n\nDMZ demilitarized zone\n\nDODIN APL Department of Defense Information Network Approved Products List\n\nHMI human-machine interface\n\nICS industrial control systems\n\nIT information technology\n\nLAN local area network\n\nOT operations technology\n\nWSUS Windows Server Update Services\n\n\n-----\n\n## Irregular Issuance Report Recommended Practice:  Updating Antivirus in an Industrial Control System\n\n 1. Overview\n\nWhen properly deployed and up-to-date, antivirus software is an important part of a defensein-depth strategy to guard against malicious software (malware) in industrial control systems\n(ICS)[1]. Antivirus is widely used in both ICS and information technology (IT) systems since it is\nan effective defensive measure against malware. The term “antivirus” covers anti-malware\napplications, which are not limited to defending only against viruses, but also other forms of\nmalicious software.\n\nIn business IT environments, it is common practice to configure each antivirus client to update\ndirectly from the antivirus vendor or to update from the organization’s servers, located in\na secured subnet within the enterprise network (which get their updates from the antivirus\nvendor).\n\nICS and IT systems should be separated by an ICS demilitarized zone (DMZ), which should\ncontain only the ICS servers that are accessible from the IT network[2]. Maintaining separation\nbetween general IT and ICS systems makes keeping antivirus software up to date more\ncomplicated and requires a different antivirus update method.\n## 2. Antivirus Update Strategies\n\nThe recommended secure network architecture for ICS (Figure 1) places the antivirus, Windows\nServer Update Services, and patch server(s) in the control center LAN DMZ[3]. In this architecture,\neach level should only send or receive traffic to a directly adjacent level. This precludes the\nAV/WSUS/patch server from communicating directly with either the vendor antivirus servers\n(which are outside of the organization entirely) or the organizational antivirus servers (which are\nnormally in the enterprise network).\n\nRestricting the flow of data only to adjacent zones complicates the antivirus update process, so\nwe need a better method. One method is to download the updates from the vendor antivirus\nservers to a dedicated host, write the updates to removable media, and use that media to\nupdate the AV/WSUS/patch server. Although at first glance this method appears to be time\nconsuming, in practice, it is not. If the asset owner uses this method, it is important to take\nprecautions to reduce the risk of introducing malware or otherwise compromising the ICS. This\nwould include verifying that the update source is legitimate, that the hash values of the updates\nare correct, and that staff members handle distribution media securely. Asset owners should\nalso ensure that staff members handle media in accordance with the organization’s removable\nmedia policy and other guidance.\n\n1 Keith Stouffer, Victoria Pillitteri, Suzanne Lightman, Marshall Abrams, Adam Hahn, NIST Special Publication 800-82\nRevision 2, Guide to Industrial Control Systems (ICS) Security: Supervisory Control and Data Acquisition (SCADA) systems,\nDistributed Control Systems (DCS), and other control system configurations such as Programmable Logic Controllers (PLC):\nrecommendations of the National Institute of Standards and Technology. (U.S. Dept. of Commerce, National Institute of\nStandards and Technology, 2015), 6-39.\n2 Ibid, 5-6\n3 Industrial Control Systems Cyber Emergency Response Team, Recommended Practice: Improving Industrial Control System\n\nCybersecurity with Defense-in-Depth Strategies, (U.S. Department of Homeland Security, 2016), 17.\n\n\n-----\n\n_Figure 1. Recommended secure network architecture.Recommended Secure Network Architecture \r\nInternet DMZ, Level 5, Web Servers, Email Servers\r\nEnterprise Zone, Level 4, Domain Controller, Web Servers, Business Servers, Enterprise Desktops\r\nControl Center LAN DMZ, DMZ, AV/WSUS/Patch Server, Historian, Remote Access/Jump Server\r\nManufacturing Zone, Control Center/Processing LAN, Level 3, HMI, Production/Application Server, Database Server, I/O Server, Historian, Domain Controller, Engineering Workstation\r\nCell/Area Zone, SCADA, DCS or Hybrid System #1, Remote SCADA, DCS or Hybrid System #2\r\nLocal HMI LAN Level 2, Local HMI, Local HMI\r\nController LAN Level 1, Field Controllers, Field Controllers,\r\nField I/O Devices Instrument Bus Level 0, Field Devices, Sensors, Process, Field Devices, Sensor, SIS, Field Devices, Sensors, Process, Field Devices, Sensor, SIS\r\nLegend: blue dash equals local field bus/hard wired, green line equals vendor-specific bus, blue line equals Ethernet TCP/IP, and green dash equals SIS status only_\n\n\n-----\n\nThis method of transferring antivirus updates uses the following steps:\n\n - Verify the source of the update.\n\n - Download the update file(s) to a dedicated host (server or workstation).\n\n - Scan the downloaded file(s) for malware.\n\n - Verify the cryptographic hash of each downloaded file(s).\n\n - Scan the removable media for malware or other unexpected data before use to verify its\n\nintegrity. The safest options are to securely erase the removable media and reformat the\ndrive with the appropriate file system (for flash or magnetic media) or to use a new CD or DVD\n(for optical media) for each update.\n\n - Write the file(s) to the removable media. Dedicate this media exclusively for updates.\n\n - Lock the media so others cannot write to it.\n\n - Load the media into the test environment and verify that it has no adverse impact to the test\n\nsystem.\n\n - Re-scan the media for malware or other unexpected data to verify that nothing transferred to\n\nthe removable media from the test environment host.\n\n - Install the update on a non-critical endpoint or segment of the system and verify that it has\n\nno adverse impact to the production system.\n\n - Install the update on the remaining hosts.\n\n - Monitor the system for any unusual behavior and verify proper operation of the ICS.\n\nThis method, informally known as “sneaker net,” is common in air-gapped networks. While this\nmethod is more labor intensive than an automatic chaining of updates, it is not prohibitively\ntime-consuming.\n\nAnother method is to automatically “daisy chain” the updates. In this method, the update\nserver in the control center LAN DMZ automatically takes its updates from another server in the\nenterprise zone, which, in turn, automatically gets it updates from the antivirus vendor’s servers.\n## 3. Considerations\n\nThe verification of the update and its source, along with the testing of updates, is very important.\nAttackers have compromised update servers and “spoofed” update sources and placed malware\non those servers disguised as updates; these malicious updates then compromised the systems\nof users who thought they were downloading legitimate updates. Verifying the update requires\nmore than merely checking the URL or the source IP address of the vendor; asset owners must\nalso verify that each file used in the update is legitimate by verifying that the cryptographic hash\nfor the file is correct.\n\nAutomatic updates often have no means of integrity checking other than the cyclic redundancy\ncheck (CRC) in the application or the communication protocol. A check of the cryptographic\nhash of the update provides greater assurance that no one has tampered with the update file.\nAlthough it is possible for an attacker to compromise an antivirus vendor’s web site and replace\nboth the update file and the cryptographic hash value, it would require more effort from the\nattacker, and the vendor would more likely catch and prevent the attempt. This may affect the\nchoice of an antivirus solution. Asset owners should ensure that they can manually update the\nparticular AV application.\n\nAnother issue that arises from chaining automatic updates is that staff might not follow the\norganization’s change management process. For many products, automatic updates are\nconvenient and easy to configure, which makes ignoring change management procedures\n\n\n-----\n\nvery tempting for busy support personnel. Since ICS environments are very sensitive and the\nimpacts of downtime can be serious, it is important for staff to follow strict change management\nprocedures and update antivirus software when operations are minimally impacted. Asset\nowners should require this as part of a facility’s regular maintenance.\n\nAlthough antivirus software is not commonly thought of as being part of an organization’s supply\nchain, it is. All software and firmware should be reviewed as part of the product evaluation\nbecause either one could be an attack vector. In 2014, a Chinese company installed malware\non handheld scanning devices and in their updates in the ZombieZero campaign[4]. Preferably,\nan organization should have a program to evaluate vendors and their products to ensure\nthat they meet operational and security criteria before adding them to an approved products\nlist. Examples of this include the FIPS 201 Evaluation Program, GSA IT Schedule 70, and the\nDepartment of Defense Information Network Approved Products List (DODIN APL). The specific\ncriteria and process of a product evaluation program should vary to meet the organization’s\nneeds and capabilities.\n\nAlthough an antivirus client normally resides on the same host as other applications, this is not\nalways the case. An antivirus scanner can be a designated computer that can “reach out” to\nother hosts and scan them remotely; however, the level of protection may vary and the scanning\ncomputer will need sufficient access to each scanned host. This also limits the effectiveness of\nantivirus. Since there is not a client always functioning on endpoints and because scans occur at\nintervals, the time between scans is a gap in protection.\n\nThe recommended secure network architecture diagram (Figure 1) depicts the AV/WSUS/\npatch server as a single server hosting three separate applications. This increases the risk of\na compromise of either the server’s operating system or the applications. If possible, these\napplications (AV/WSUS/patch) should reside on their own hosts, either physical or virtual, and\nthe hosts hardened and traffic restricted.\n\nIn addition, many “next-generation” firewalls and intrusion prevention systems can inspect\ntraffic and block detected malware from traversing a network, which prevents the malware from\ninfecting endpoints. This, however, must be a configured capability of the device.\n## 4. Test and Validation\n\nRegardless of the configuration, there is always the possibility of an incompatibility or constraint\nhaving an adverse impact to the system, so testing is prudent. It is also important to back up\nany production endpoint (if possible) before updating it. If there is an adverse impact from\nthe update, it will be easier and faster to recover from it with a backup. Asset owners should\ndocument the transfer and testing of updates as part of a comprehensive change management\nprogram. This should be a written procedure and staff tasked with performing updates.\n\nTesting is a critical step since updates can adversely affect ICS environments; there have\nbeen cases where ICS applications have malfunctioned due to the installation or updating of\nantivirus software. Since antivirus scanning can significantly increase CPU and/or memory\nutilization, it can interfere with applications and processes on servers or workstations that have\noutdated or otherwise insufficient hardware. This is one reason why it is important to maintain\ntest environments that closely approximate the production environments. Updates should be\ninstalled on a test system and the proper operation of the system checked for adverse impacts\nor anomalous behavior first. If there are no issues, deploy the update into operational systems\nin order of least criticality: first, the corporate IT network; next, the ICS DMZ; and finally, the ICS\nnetwork. In each operational system, update non-critical assets first since any adverse impact\nwould less likely interrupt or otherwise degrade operations. For example, update the backup HMI\n\n4 Kelly Higgens, “Chinese Hackers Target Logistics & Shipping Firms With Poisoned Inventory Scanners.” Dark Reading,\nUBM Technology Group, 2014.\n\n\n-----\n\nserver before the primary HMI. Some organizations forego having a test environment and roll out\nupdates in the IT and OT production systems. Unfortunately, this increases the risk of an adverse\nimpact because there are significant differences in the makeup of IT and OT systems. An IT\nsystem is simply not an accurate reflection of an OT system, so an accurate test environment is\nimportant.\n\nThe purpose of updating antivirus software is to ensure a higher level of protection. The\nresulting higher level of protection reduces downtime and other adverse impacts that are the\nconsequences of a compromise of the ICS. The method should be tailored to the environment to\nsupport both the operational and security needs of the organization, but it should always include\nverification of the updates, maintain separation of levels to support defense in depth, and\nprovide adequate testing of each update.\n\n_DISCLAIMER: This report is provided “as is” for informational purposes only. The Department of Homeland Security (DHS)_\n_does not provide any warranties of any kind regarding any information within. DHS does not endorse any commercial_\n_product or service referenced in this advisory or otherwise. This document is distributed as TLP:White: Sources are at_\n_liberty to specify additional intended limits of the sharing: these must be adhered to. For more information on the Traffic_\n_Light Protocol, see https://www.us-cert.gov/tlp._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://us-cert.cisa.gov/sites/default/files/recommended_practices/Recommended%20Practice%20Updating%20Antivirus%20in%20an%20Industrial%20Control%20System_S508C.pdf"
    ],
    "report_names": [
        "Recommended%20Practice%20Updating%20Antivirus%20in%20an%20Industrial%20Control%20System_S508C.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041158,
    "ts_creation_date": 1533052078,
    "ts_modification_date": 1533137072,
    "files": {
        "pdf": "https://archive.orkl.eu/d99e814a50f3a186eb705aef6803f4df1b44094e.pdf",
        "text": "https://archive.orkl.eu/d99e814a50f3a186eb705aef6803f4df1b44094e.txt",
        "img": "https://archive.orkl.eu/d99e814a50f3a186eb705aef6803f4df1b44094e.jpg"
    }
}