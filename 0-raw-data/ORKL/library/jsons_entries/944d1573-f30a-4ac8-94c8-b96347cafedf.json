{
    "id": "944d1573-f30a-4ac8-94c8-b96347cafedf",
    "created_at": "2023-01-12T15:02:03.989035Z",
    "updated_at": "2025-03-27T02:16:57.894727Z",
    "deleted_at": null,
    "sha1_hash": "120cbc9526ac2273bc9be8e0092553fa87779154",
    "title": "2021-11-04 - Understanding the Windows JavaScript Threat Landscape",
    "authors": "",
    "file_creation_date": "2022-05-29T01:12:18Z",
    "file_modification_date": "2022-05-29T01:12:18Z",
    "file_size": 1400537,
    "plain_text": "# Understanding the Windows JavaScript Threat Landscape\n\n**[deepinstinct.com/blog/understanding-the-windows-javascript-threat-landscape](https://www.deepinstinct.com/blog/understanding-the-windows-javascript-threat-landscape)**\n\nNovember 4, 2021\n\n## 100% Prevention Score in the 2022 MITRE ATT&CK Evaluation for\n Enterprise\n\n[Learn more](https://www.deepinstinct.com/news/deep-instinct-shows-100-percent-score-in-mitre-evaluations)\n\nNovember 4, 2021 | [Shaul Vilkomir-Preisman](https://www.deepinstinct.com/author/shaul-vilkomir-preisman)\n\nScript-based attacks have become a significant threat in recent years, with some estimates\nputting these attacks at 40 percent or more of all global cyberattacks. A script can be\nanything from a sequence of simple commands used for system configuration, task\n\n\n-----\n\nautomation, and other general purposes, to much more advanced, multi-layered, and often\nobfuscated code. Among the most commonly used scripting languages are PowerShell,\nVBScript, and JavaScript.\n\nWhile PowerShell attacks are most commonly used, Windows JavaScript is also used by\nmalicious threat actors for many of the same purposes. Outside of a browser — which\nexecutes JavaScript in an encapsulated fashion, greatly limiting that code’s interaction with\nthe operating system — Windows provides facilities for JavaScript execution with Windows\nScript Host (WSH), which executes JavaScript (and other Windows-supported scripting\nlanguages) under the wscript.exe and cscript.exe Windows processes, providing an attack\nsurface for adversaries to exploit.\n\nJavaScript malware can range from a simple dropper intended to deliver additional malware\nto being fully-featured, multi-purpose pieces of malware in their own right.\n\nIn this blog we will provide an overview of five prominent malware strains in the JavaScript\nlandscape, with an emphasis on several “pure” JavaScript malware which often challenge\nstatic detection signatures through heavy code obfuscation and not employing compiled\nbinaries. Please note that this will not be an in-depth analysis of the different malware, but a\nhigher-level review of each malware.\n\nVJw0rm\n\n[“Vengeance Justice Worm” was first discovered in 2016 and is a highly multifunctional,](https://cofense.com/vjw0rm-malware-heres-watch/)\nmodular, publicly available “commodity malware”, i.e., it can be purchased by those\ninterested through various cybercrime and hacking related forums and channels.\n\nVJwOrm is a JavaScript-based malware and combines characteristics of Worm, Information\nStealer, Remote-Access Trojan (RAT), Denial-of-Service (DOS) malware, and spam-bot.\n\nVJw0rm is propagated primarily by malicious email attachments and by infecting removeable\nstorage devices.\n\nOnce executed by the victim, the very heavily obfuscated VJw0rm will enumerate installed\ndrives and, if a removeable drive is found, VJwOrm will infect it if configured to do so.\n\nIt will continue to gather victim information such as operating system details, user’s details,\ninstalled anti-virus product details, stored browser cookies, the presence of vbc.exe on the\nsystem (Microsoft’s .NET Visual Basic Compiler, this indicates that .NET is installed on the\nsystem and can affect the actor’s choice of additional malware delivery), and whether the\nsystem has been previously infected.\n\nVJw0rm will then report this information back to its command-and-control server and await\nfurther commands, such as downloading and executing additional malware or employing any\nof its other numerous capabilities.\n\n\n-----\n\nFinally, VJw0rm establishes persistency in the form of registry auto-runs, system startup\nfolders, a scheduled-task, or any combination of these methods.\n\n_Figure 1: Obfuscated VJw0rm snippet_\n\n_Figure 2: VJw0rm check if previously infected_\n\n_Figure 3: VJw0rm Command-and-Control contact_\n\n_Figure 4: VJw0rm establishes persistency_\n\nWSHRat\n\nWSHRat, also known as Houdini, H-worm, Dunihi, and several other aliases, is another\n“commodity malware” and can trace its roots to 2013 when it was originally developed in\nVBS. The WSHRat variant, itself, emerged in 2019 as a JavaScript-based version of the\npreviously known Houdini/H-Worm, which was written in VBS.\n\nAs with all Remote-Access Trojans (RATs), WSHRat’s primary purpose is to maintain access\nto the machine, executing remote commands, and downloading additional malware.\n\nWSHRat is propagated primarily by malicious email attachments and is also capable of\ninfecting removable storage drives.\n\nOnce executed by the victim, the very heavily obfuscated WSHRat will follow a course\nsimilar to that of the above described VJw0rm – gather operating system and user’s details,\ninstalled anti-virus product details, report this back it’s command-and-control, perform\n\n\n-----\n\nremoveable storage drive infection if configured to do so and await further commands.\n\n“Houdini” VBS based variants of the malware are known to have been involved in a recently\nreported, very protracted, [espionage campaign that targeted the aviation industry.](https://blog.talosintelligence.com/2021/09/operation-layover-how-we-tracked-attack.html)\n\nNJrat/Bladabindi and Remcos RAT are two common follow-up payloads of Houdini/WSHRat.\n\n_Figure 5: Obfuscated WSHRat snippet_\n\n_Figure 6:WSHRat Command-and-Control contact_\n\n_Figure 7: WSHRat establishes persistency_\n\nSTRRAT\n\nSTRRAT is a Java-based RAT with a JavaScript wrapper/dropper that was discovered in\n2020. Its core payload (a .JAR file) is contained under several layers of obfuscation and\nencoding inside the JavaScript wrapper/dropper.\n\nSTRRAT is propagated by malicious email attachments. Its capabilities include standard RAT\nfunctionalities (remote access, remote command execution), browser and email-client\ncredential harvesting, and a unique ransomware-like functionality – if instructed, it will add a\n“.crimson” extension to files on the device, rendering them inoperable (though they can be\neasily recovered because their content is not modified).\n\nUnlike many Java-based malware, STRRAT does not require Java to be installed on the\ninfected system in order to operate. When the JavaScript wrapper/dropper is executed, if a\nsuitable Java runtime installation is not found, one will be downloaded and installed in order\nto assure the contained Java payload can execute.\n\n\n-----\n\n_Figure 8: STRRAT core payload snippet, encoded and obfuscated_\n\n_Figure 9:STRRAT \"bring your own JRE\" function_\n\n_Figure 10: STRRAT deploys and runs payload_\n\nBlackByte Ransomware\n\nBlackByte is [recently discovered Ransomware with a .NET DLL core payload wrapped in](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/blackbyte-ransomware-pt-1-in-depth-analysis/)\nJavaScript. It employs heavy obfuscation both in its JavaScript wrapper and .NET DLL core.\n\nOnce the JavaScript wrapper is executed, the malware will de-obfuscate the core payload\nand execute it in memory. The core .DLL is loaded and BlackByte will check the installed\noperating system language and terminate if an eastern European language is found.\n\nIt will proceed to check for the presence of several anti-virus and sandbox-related .DLLs,\nattempt to bypass AMSI, delete system shadow-copies in order to hinder system recovery,\nand modify several other system services (including Windows Firewall) in order to “prep” the\nsystem for encryption. Once the system is “ready” for encryption, it will download a\nsymmetric key-file which will be used to encrypt files on the system. If this file is not found,\nthe malware will terminate.\n\n\n-----\n\nUnlike most Ransomware today, BlackByte uses a single symmetric encryption key, and\ndoes not generate a unique encryption key for each victim system, meaning the same key\ncan be used to decrypt all files encrypted by the malware.\n\nThis makes for substantially easier key-management for the actors behind BlackByte at the\ncost of a weaker encryption scheme and easier victim system recovery (as there is only a\nsingle online point with a single key to maintain).\n\nAs with most Ransomware today, BlackByte has worming capabilities and can infect\nadditional endpoints on the same network.\n\n_Figure 11: A snippet of BlackByte's contained encoded .NET payload_\n\n_Figure 12: BlackByte AMSI bypass_\n\nCarbanak/FIN7 JavaScript Backdoor\n\nCarbanak/FIN7 needs little introduction. Discovered in 2014, they are one of the most prolific\nand successful, financially-motivated threat actors in action today, responsible for an\n[estimated $1 billion in losses to countless financial institutions worldwide.](https://www.kaspersky.com/about/press-releases/2015_the-great-bank-robbery-carbanak-cybergang-steals--1bn-from-100-financial-institutions-worldwide)\n\nCarbanak/FIN7’s main means of spreading malware consists of highly targeted and highly\neffective spear-phishing emails.\n\nA [recently discovered JavaScript based backdoor associated with the actor, however,](https://www.anomali.com/blog/cybercrime-group-fin7-using-windows-11-alpha-themed-docs-to-drop-javascript-backdoor)\nappears to indicate a pivot in their activity — shifting from their mostly PowerShell-based\nmalware to JavaScript, likely in an attempt to become less detectable to security vendors.\n\nOnce executed, the backdoor will initiate a two-minute delay in an effort to avoid automated\nsandbox detection (analysis timeout), and then will collect the infected machine’s IP and\nMAC addresses, DNS hostname, and report back to its Command-and-Control server and\nexecute any code it receives back as response.\n\n[Carbanak/FIN7 are known to employ Cobalt Strike as their post-breach follow-up malware.](https://www.deepinstinct.com/blog/cobalt-strike-post-exploitation-attackers-toolkit)\n\n\n-----\n\n_Figure 13: Obfuscated Carbanak Backdoor snippet_\n\n_Figure 14: Carbanak Backdoor delay function_\n\n_Figure 15: Carbanak Backdoor gathers victim information_\n\n_Figure 16: Carbanak Backdoor Command-and-Control URL \"constructor\" function_\n\n\n-----\n\n_Figure 17: Carbanak Backdoor Command-and-Control contact_\n\nConclusion\n\nThe JavaScript landscape is rife with malware of all types and is highly dynamic. These are\nsignificant threats that cannot be disregarded.\n\nThreat actors around the world are developing and maintaining JavaScript-based malware\nthat is on par in its functionality and sophistication with anything in the parallel landscapes of\nother Windows-supported scripting languages, all of which are gaining popularity as more\nand more threat actors are transitioning to the “no PE needed” mentality.\n\nFor a demo of the world’s best malware-prevention solution, [request a demo.](https://www.deepinstinct.com/request-a-demo)\n\n**IOCs of examined samples:**\n\n**VJw0rm**\n\nSHA256: 080069323805f67a898f62517b17786d46cc51e9894cd490ee0ba789271e1d9c\n\nC2: 180.214.239.36:8050\n\n**WSHRat**\n\nSHA256: ec5d3e6da18db71027ea5a54ff0e4be63313b4986d3ef8b020a4a79ae3866571\n\nC2: jahblessrtd4ever.home-webserver.de:1604\n\nDrops Remcos RAT:\n52cbc7b3e3c373b8857245207f0cfca50c35b6edc49255441f74fdf45a71ac46\n\n(Remcos employs same C2 as WSHRat)\n\n**STRRAT**\n\nSHA256: 213c775b371b55c48308650f29ad041a889ef24bf58069d380b4be6e558b82e9\n\n\n-----\n\nSHA256 (JAR):\n6b723bd260b53c68c716ef218c78718d3e99ab4d4238a4bd823fd0cd6ec8007b\n\n\"bring your own JRE” URL: wshsoft.company/jre7.zip\n\nC2: str-master.pw\n\n**BlackByte Ransomware**\n\nSHA256: 884e96a75dc568075e845ccac2d4b4ccec68017e6ef258c7c03da8c88a597534\n\nKey file URL: 45.9.148.114/forest.png\n\n**Carbanak/FIN7 JavaScript Backdoor**\n\nSHA256: caa7667bfdbcb04ceb9d81df93fe805dfe4ac8a04b9dd3eaab7b5f7c87c4fc9c\n\nC2: civilizationidium.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-04 - Understanding the Windows JavaScript Threat Landscape.pdf"
    ],
    "report_names": [
        "2021-11-04 - Understanding the Windows JavaScript Threat Landscape.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4f5da0b4-5d47-4ae4-87cb-dfcb3c3524ae",
            "created_at": "2022-10-25T16:07:23.96921Z",
            "updated_at": "2025-03-27T02:02:10.054899Z",
            "deleted_at": null,
            "main_name": "Operation Layover",
            "aliases": [],
            "source_name": "ETDA:Operation Layover",
            "tools": [
                "AsyncRAT",
                "Bladabindi",
                "CyberGate",
                "CyberGate RAT",
                "Jorik",
                "Rebhip",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4e453d66-9ecd-47d9-b63a-32fa5450f071",
            "created_at": "2024-06-19T02:03:08.077075Z",
            "updated_at": "2025-03-27T02:05:17.381141Z",
            "deleted_at": null,
            "main_name": "GOLD LOTUS",
            "aliases": [
                "Hecamede ",
                "BlackByte"
            ],
            "source_name": "Secureworks:GOLD LOTUS",
            "tools": [
                " Cobalt Strike",
                " ExByte",
                " MEGA",
                " RDP",
                " SoftPerfect Network Scanner",
                "BlackByte"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535723,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1653786738,
    "ts_modification_date": 1653786738,
    "files": {
        "pdf": "https://archive.orkl.eu/120cbc9526ac2273bc9be8e0092553fa87779154.pdf",
        "text": "https://archive.orkl.eu/120cbc9526ac2273bc9be8e0092553fa87779154.txt",
        "img": "https://archive.orkl.eu/120cbc9526ac2273bc9be8e0092553fa87779154.jpg"
    }
}