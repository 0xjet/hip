{
    "id": "1dbe56c7-dd0e-45cf-a27f-3d7bc5b3aa5c",
    "created_at": "2023-01-12T15:01:25.073627Z",
    "updated_at": "2025-03-27T02:11:43.444393Z",
    "deleted_at": null,
    "sha1_hash": "6e00a21dae5e1410d1c1595fbed96b645cccf31a",
    "title": "2020-05-12 - Maze ransomware- extorting victims for 1 year and counting",
    "authors": "",
    "file_creation_date": "2022-05-28T19:46:49Z",
    "file_modification_date": "2022-05-28T19:46:49Z",
    "file_size": 1907961,
    "plain_text": "# Maze ransomware: extorting victims for 1 year and counting\n\n**[news.sophos.com/en-us/2020/05/12/maze-ransomware-1-year-counting/](https://news.sophos.com/en-us/2020/05/12/maze-ransomware-1-year-counting/)**\n\nSophos May 12, 2020\n\nIt’s been a year since the Maze ransomware gang began its rise to notoriety. Previously\nidentified as “ChaCha ransomware” (a name taken from stream cipher used by the malware\nto encrypt files), the Maze “brand” was first affixed to the ransomware in May, 2019.\n\nInitial samples of Maze were tied to fake websites loaded with exploit kits. Since then, Maze\nhas been delivered by multiple means: exploit kits, spam emails, and—as the group’s\noperations have become more targeted—Remote Desktop Protocol attacks and other\nnetwork exploitation.\n\nBut aside from the gang’s adjustments in initial compromise approaches, the Maze group has\nrisen in prominence largely because of its extortion tactics: following through on threats of\npublic exposure of victims’ data in public “dumps” of victims’ stolen data, and offering victim\ndata on cybercrime forums if no payment is made.\n\nWhile Maze did not invent the data-theft/extortion racket, it was among the first ransomware\noperations to use data theft as a way of twisting the arms of victims to pay up. The Maze\ngang has made public exposure central to their “brand” identity, and actively seeks attention\nfrom press and researchers to promote their brand—and make it easy for victims who might\nhesitate to pay them to find out their reputation.\n\n### Stepping into the spotlight\n\nMaze rose to greater attention in October of 2019, when the ransomware’s operators\nlaunched a massive spam campaign that masqueraded as messages from government\nagencies. One campaign sent messages claiming to be from Germany’s Bundeszentralamt\nfur Steuern (Ministry of Finance), while another posed as a tax message from Italy’s Agencia\nEntrate (Internal Revenue Service).\n\n\n-----\n\nThe Italian version of the attack claimed to be instructions to avoid being designated as tax\ncheats, with further details in the attached file VERDI.doc—described as an “interactive tool”,\na ploy to trick the user to enable Visual Basic for Applications (VBA) macros. When macros\nwere enabled, the scripts within the document downloaded the Maze ransomware to\n%TEMP% folder, and then executed it.\n\n\n-----\n\nThe fake\n\n\nemail sent by Maze’s operators to Italian targets.\n\n\n-----\n\nThe attachment, VERDI.doc\nSince then, Maze ransomware has gained notice largely from stealing and publishing victims’\ndata as a means to coerce payment. While threatening to expose victims’ data has long been\npart of ransomware operators’ playbook, Maze was among the first to follow through on such\na threat in a public fashion—starting with the November 2019 exposure of data from Allied\nUniversal.\n\nMaze is not alone in adopting this tactic. REvil/Sodinokibi began releasing data at about the\nsame time as Maze; the DoppelPaymer and Clop ransomware rings have followed suit, and\n[LockBit has added threats of data exposure to its ransom note. But the Maze “team” was the](https://news.sophos.com/en-us/2020/04/24/lockbit-ransomware-borrows-tricks-to-keep-up-with-revil-and-maze/)\nfirst to go as far as to engage news media to draw attention to its victims, going as far as to\ninclude a “press release” on their website.\n\n### Fame and fortune\n\nMaze’s operators seek attention in many ways, in an effort to spread their reputation—and\nincrease the likelihood that their “clients” (as they call their victims) pay quickly. Name\nrecognition is important to them, even as they remain anonymous. One way they seek\nattention through their provocation of security researchers.\n\nThe developers of Maze often drop the names of researchers into strings contained within\nransomware binaries or the “packers” that deliver them. For instance, Maze’s authors\nfrequently put researchers’ names in the filenames or file paths for the program database\n(.pdb) file generated during development.\n\nReferences to the\n\nTwitter account of researcher Michael Gillespie, the antivirus company Emisoft, and\nresearcher Marcus Hutchins in the PDB path of one Maze binary sample, along with other\nmeaningless strings.\n\n\n-----\n\nThe Maze authors have put names into the .pdb filename and path so frequently that it\nseems they may be running out of ideas about what to call them:\n\nSometimes, the Maze authors leave provocative messages to researchers within strings in\nthe code itself. Often these strings have no function, though occasionally they’re used as “kill\nswitches” that shut down the malware’s execution.\n\nThe Maze team’s provocation of researchers extends into its presence in web forums. On\none board, the Maze team uses the account name “Kremez”, after prominent ransomware\nresearcher Vitali Kremez, to post links to dumps of data from companies that failed to pay.\n\nA\n\nweb board post by the Maze team, using the account name “Kremez.”\nBut the main platform used to promote the Maze brand is the Maze team’s websites—one\nspecifically for its victims, and another to communicate with the world at large (and\nencourage victims publicly to pay up).\n\n“Keeping the world safe”\n\nThe web panel for victims features the ring’s ironic slogan, “Maze team: Keeping the World\n_safe.”_\n\n\n-----\n\nVictims arriving at the site after following the URL in the ransom note are asked to provide the\nfile DECRYPT-FILES.txt dropped by the ransomware, which contains the identification\nnumber assigned to the victim.\n\nOnce they’ve identified themselves, victims can upload three files for decryption as proof that\nthe Maze crew can truly restore their data. (Only image files are supported, so no real critical\ndata can be recovered for free.)\n\n\n-----\n\nThe site also provides a chat window, so the victim can communicate with the Maze team’s\ncustomer support representatives, who are standing by to answer any questions and\nnegotiate a payment.\n\nAside from the private web panel provided to victims, the Maze group also maintains a\n“news” site (hosted both on Tor and on the public Internet) that hosts samples of stolen data\nfor companies that have recently been hit by the ransomware, as well as “full dumps” of data\nfrom some companies that failed to negotiate a payment.\n\n\n-----\n\nOn April 17, 2020, Maze posted a ”press release” dated April 17, 2020. It is really a message\nto victims, explaining all the bad things that will happen if they ignore Maze’s ransom demand\nand do not contact them about payment. (The page has recently been updated with\ninformation about alleged victim Banco BCR.)\n\n\n-----\n\nThey assure “clients” that they honor their side of any agreement and delete stolen data, as\ntheir reputation is important to them to conduct business. And they claim to be ready to cut a\ndeal for those hurt by the COVID-19 induced global economic downturn.\n\nIn the past, the Maze group has withdrawn data posted to its site due to extenuating\ncircumstances, such as when the group backed off blackmail demands against the City of\nPensacola following the shooting of two members of the US Navy at the naval air station\n\n\n-----\n\nthere. And in March, the Maze team announced that it would stop attacks on medical\norganizations until the COVID-19 pandemic “stabilizes.”\n\nIn the most recent “press release” (dated April 17, 2020), the operators of Maze wrote:\n\nWe are living in the same reality as you are. That’s why we prefer to work under the\narrangements and we are ready for compromise. But only with those partners who can\nunderstand what is reputation and what are the real consequences of private data loss.\n\n## Evasion and anti-analysis in the Maze main binary\n\nMaze ransomware is mostly written in C++. However, it heavily uses pure assembly with\ncontrol flow obfuscation This obfuscation includes:\n\nUnconditional jumps that use combinations of conditional jump commands, such as\nputting a jz (jump if zero) instruction directly after a jnz (jump if not zero) instruction to\nthe same location.\nJumps into the middle of instructions;\nInstructions that point to strings within the .text section of the binary as a return\naddress.\nNecessary API names are hashed, and compared with the hash of the DLL function\nnames, then the matched functions are resolved dynamically with the usual LoadLibrary\nand GetProcAddress functions.\n\nThe Maze team is very proud of their main binary’s code obfuscation—in a message in the\ntext of the malware’s binary, they challenged researchers to write an IDAPython script to\n[deobfuscate it. On May 1, Crowdstrike’s Shaun Hurley published a report showing just such a](https://www.crowdstrike.com/blog/maze-ransomware-deobfuscation/)\ndeobfuscation in detail.\n\nSeveral of the Maze samples we’ve analyzed contain “kill” switches, which when triggered\nresult in the malware not encrypting files. Many of these are there just to grab the attention of\nresearchers, either to send some message or (as mentioned earlier) to name researchers\nthat they know have been examining their code.\n\n\n-----\n\nResearcher Vitali Kremez’s name is used here as a killswitch filename (C:\\\\2433\\\\kremez),\nalong with a threatening message to another researcher in the binary text.\n\nAnother killswitch setting taunts a company that did not pay Maze’s ransom.\nThere are also some samples that can be run with more meaningful, functional switches,\nsuch as:\n\n**–nomutex which allow to run multiple instances;**\n**–logging turns on detailed console output, which logs each file encrypted, the time**\nrequired to do so, and some error messages;\n**–noshares turns off encryption of network shares;**\n–path specifies a folder to be encrypted.\n\n\n-----\n\nOutput from the Maze binary with the –logging switch passed at startup.\nAside from the obfuscation, the Maze main binary’s authors applied a number of anti-analysis\ntechniques to the malware. It checks debugging environment in multiple ways. In addition to\nusing the IsDebuggerPresent API and PEB.BeingDebuggedFlag check, the Maze main\nbinary contains hardcoded hashes of the names for known analysis processes, including\nprocmon.exe, procmon64.exe, x32dbg.exe, x64dbg.exe, ollydbg.exe, procexp.exe, and\nprocexp64.exe. The code enumerates the running processes present, checks processes’\nnames against the hashed list, and terminates itself if any are detected.\n\n### Setting up shop and phoning home\n\n\n-----\n\nThe Maze binary creates persistence by adding itself to Windows autorun registry. And it\nuses a mutex to ensure that another instance of Maze doesn’t execute (unless it’s a sample\nthat has been executed with the –nomutex switch).\n\nAs with most ransomware, it deletes shadow copies with the Windows Management\nInstrumentation command line utility WMIC.exe. The binary also uses the WMI interface to\nquery for antivirus information, executing the Windows Management Instrumentation Query\nLanguage (WQL) command “Select * from AntiVirusProduct” within WMI namespace\nroot\\SecurityCenter2.\n\nThe ransomware collects information about the computer and its user, including information\nabout the system drives, operating system version, default language setting, username, and\ncomputer name. As with some other ransomware, Maze will terminate without encrypting files\nif certain languages are detected (such as those used in Commonwealth of Independent\nStates nations).\n\nInformation about the local network its target is connected is also gathered by the malware,\nby creating a null session connection and enumerating network resources. It tries to find out\nthe role of that the current machine in the network, in order to reuse it in the extortion—Maze\nvaries the amount of the ransom depending on whether the target is a home computer, or a\nworkstation or server on a corporate network.\n\nThis information is exfiltrated back to the command and control server using a standard port\n80 HTTP POST method, connecting using Windows’ socket library, WS2_32.dll. The URI\npath is created from a hard-coded string list to building up the URI path.\n\n\n-----\n\nThe malware sends information including the username, drive information, drive free space,\nlanguage, antivirus product present, and OS version back to the server.\n\n### Dear User, I’ve encrypted your files\n\nMaze uses RSA and ChaCha20 stream cipher encryption to lock victims’ files. The malware\ngenerates an RSA key pair, which is in turn encrypted using the main RSA public key\nembedded in the malware. As it traverses the file system to encrypt files, it skips the following\ndirectories:\n\n\\\\Program Files\n\n\n-----\n\n\\\\Windows\n\\\\Games\\\\\n\\\\Tor Browser\\\\\n\\\\ProgramData\\\\\n\\\\cache2\\\\entries\\\\\n\\\\Low\\\\Content.IE5\\\\\n\\\\User Data\\\\Default\\\\Cache\\\\\n\\\\All Users\n\\\\IETldCache\\\\\n\\\\Local Settings\\\\\n\\\\AppData\\\\Local\nAhnLab\n{0AFACED1-E828-11D1-9187-B532F1E9575D}\n\nMaze also doesn’t encrypt .lnk, .exe, .sys, and .dll files, and specifically avoids the following\nfiles:\n\nDECRYPT-FILES.txt (the file dropped with the victim’s ID code)\ninf\nini\nini\ndat\ndb\nbak\ndat.log\ndb\nbin\n\n\n-----\n\nThe ransom note, on the altered desktop.\nAt the end of the encryption, a desktop wallpaper .bmp is dropped—and a voice message is\nplayed:\n\n“Alert! *User* Alert! Dear *User*, Your files have been encrypted…”\n\nBoth the wallpaper and the voice message are stored in text forms within the binary. The\nbackground text is converted to bmp with the use of the DrawTextW and GetDIBits APIs, and\nis dropped as 000.bmp and set to the wallpaper. The voice message is created using the\nMicrosoft Speech API with the default voice and default audio. Just before playing the\nmessage, Before the speech, it uses the operating system’s Beep function to be sure to catch\nthe attention of the victim.\n\nIn the latest version of the ransom note, the Maze crew leaves a “friendly” warning for the IT\nsupport staff of the victim organization:\n\n## IOCs\n\nSHA256 filename\n\n4acba1590552c9b2b82f5a786cedc8a12ca457e355c94f666efef99073827f89 love.dll\n\n\n-----\n\n20ea5a9b5b2e47aa191132ac12c1d6dea6b58d7a0467ea53d48e96f8a79c6acd argfdg,\narsgt35yy,\nmaze.exe\n\n3c2be967cbaaafecf8256167ba32d74435c621e566beb06a1ead9d33d7e62d64 Attack!.rar\n\n7a84d10ac55622cdac25f52170459ae5b8181ee3fc345eb1b1dcbd958b344aa6 Ave Kim,\nEmperor.exe\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-12 - Maze ransomware- extorting victims for 1 year and counting.pdf"
    ],
    "report_names": [
        "2020-05-12 - Maze ransomware- extorting victims for 1 year and counting.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c3c864b3-fac9-4d56-8500-7c06c829fbf8",
            "created_at": "2023-01-06T13:46:39.071873Z",
            "updated_at": "2025-03-27T02:00:02.990045Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Storm-0216",
                "DEV-0216",
                "UNC2198",
                "Maze Team",
                "TWISTED SPIDER",
                "GOLD VILLAGE"
            ],
            "source_name": "MISPGALAXY:TA2101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e9f85280-337c-4321-b872-0919f8ef64a6",
            "created_at": "2022-10-25T16:07:24.261761Z",
            "updated_at": "2025-03-27T02:02:10.153781Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Gold Village",
                "Maze Team",
                "TA2101",
                "Twisted Spider"
            ],
            "source_name": "ETDA:TA2101",
            "tools": [
                "7-Zip",
                "Agentemis",
                "BokBot",
                "Buran",
                "ChaCha",
                "Cobalt Strike",
                "CobaltStrike",
                "Egregor",
                "IceID",
                "IcedID",
                "Mimikatz",
                "PsExec",
                "SharpHound",
                "VegaLocker",
                "WinSCP",
                "cobeacon",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535685,
    "ts_updated_at": 1743041503,
    "ts_creation_date": 1653767209,
    "ts_modification_date": 1653767209,
    "files": {
        "pdf": "https://archive.orkl.eu/6e00a21dae5e1410d1c1595fbed96b645cccf31a.pdf",
        "text": "https://archive.orkl.eu/6e00a21dae5e1410d1c1595fbed96b645cccf31a.txt",
        "img": "https://archive.orkl.eu/6e00a21dae5e1410d1c1595fbed96b645cccf31a.jpg"
    }
}