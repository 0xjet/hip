{
    "id": "4c8a7408-014d-463a-8f62-65119498c060",
    "created_at": "2023-01-12T15:06:35.149804Z",
    "updated_at": "2025-03-27T02:10:20.372218Z",
    "deleted_at": null,
    "sha1_hash": "404a0154aff6e951c80d337c4912431814208409",
    "title": "2022-07-12 - An Analysis of Infrastructure linked to the Hagga Threat Actor",
    "authors": "",
    "file_creation_date": "2022-07-18T18:26:57Z",
    "file_modification_date": "2022-07-18T18:26:57Z",
    "file_size": 1417933,
    "plain_text": "# An Analysis of Infrastructure linked to the Hagga Threat Actor\n\n**[team-cymru.com/blog/2022/07/12/an-analysis-of-infrastructure-linked-to-the-hagga-threat-actor](https://team-cymru.com/blog/2022/07/12/an-analysis-of-infrastructure-linked-to-the-hagga-threat-actor)**\n\nKyle Krejci\nView all posts by Kyle Krejci July 12, 2022\n\n## Summary\n\nAs this research reveals, mapping out adversary infrastructure has distinct advantages that\nenable a proactive response to future threats. A well resourced team with access to the right\ntools can monitor changes to adversary infrastructure in real time, discoveries can become\nstrategic advantages when fully exploited. This blog is geared towards the practitioner threat\nhunters and threat researchers, anyone reading this with the bottomline in mind should take\n[a look at our economic study here first.](https://team-cymru.com/report-total-economic-impact-of-pure-signal-recon/)\n\n## Introduction\n\n\n-----\n\n[We began tracking the threat actor Hagga in late 2021 following the release of an analysis by](https://yoroi.company/research/serverless-infostealer-delivered-in-est-european-countries/)\nZ-Lab (Yoroi Security’s malware research team). Z-Lab were tracking a worldwide campaign\nto distribute the Agent Tesla information stealer through an elusive multi-stage infection\nprocess. In their analysis, they shared the IOCs for this campaign, including a single\nhardcoded IP address (69.174.99.181) and a common URL directory pattern for the\nidentified C2 panels.\n\nThis blog will describe how we were able to pivot in threat telemetry, using these IOCs as\nseeds, to identify several other C2s used by this threat actor, ultimately leading us to a\nbackend MySQL server.\n\n\n-----\n\nFigure 1: C2 Panel IOCs\n\n## Key Observations\n\nHagga infrastructure is hosted on dedicated leased infrastructure, largely on\nQuadraNet and Vietnam Posts and Telecommunications (VNPT).\n\n.\nAn HTTPS certificate serves as a key indicator of Hagga C2 panels.\n\n**69.174.99.181 (QuadraNet, US)**\n\nPassive DNS data for 69.174.99.181 identified it hosting the domain\n(update.)newbotv4[.]monster from 01 November 2021 onwards. During the period 17\nSeptember – 17 December 2021, no further domains were hosted on this IP, indicating it was\nlikely dedicated infrastructure (and not a compromised / shared host).\n\nReviewing certificate data for this IP address identified an expired self-signed SSL certificate\nwith a CN value of localhost.\n\nSHA1: B0:23:8C:54:7A:90:5B:FA:11:9C:4E:8B:AC:CA:EA:CF:36:49:1F:F6\n\nWhilst examining threat telemetry for 69.174.99.181, it was noted that 97% of the observed\ndata related to communications with a single Hostinger IP address on TCP/3306 (the default\nport for MySQL servers). This activity occurred between 14 October – 17 December;\noccurring during the same time window as the Agent Tesla campaign identified by Z-Lab.\n\n**Hostinger IP Address**\n\n_Note: The Hostinger IP address is redacted throughout this report. As backend infrastructure,_\n_its identification would not provide any value to network defenders, and as explained below is_\n_likely also utilized for unconnected shared hosting purposes._\n\nPassive DNS data identified this IP as a web hosting control panel server. This is supported\nby open ports data identifying 16 TCP ports that are associated with Hostinger cPanel\nservices. Namely, ports 21, 25, 80, 110, 143, 443, 465, 587, 993, 995, 2080, 2083, 2086,\n2087, and 3306.\n\nThreat telemetry data for the Hostinger IP address identified inbound connections to\nTCP/3306 from numerous other IP addresses dating back to at least 17 September 2021. It\nwas assessed that the IP was shared amongst other Hostinger clients, who were likely\nunconnected to malicious activities.\n\n\n-----\n\n**Figure 2: Hostinger MySQL Clients**\n\n**Hostinger MySQL Clients**\n\nConsidering the likelihood that the Hostinger IP was used in shared hosting, we needed to\ninclude additional constraints to limit our scope to data of relevance to the initial (and\npotentially other) C2s.\n\nWe identified several HTTP requests to the original C2 IP address, with several ‘webpanel’\npaths using a common naming convention. These paths aligned with the Z-LAB C2\nindicators.\n\n**Table 1: 69.174.99.181 URL Requests**\n\nIn addition, we also identified requests to one of the other Hostinger MySQL clients that\nmatched one of the ‘webpanel-‘ patterns:\n\n\n-----\n\n**Table 2: 155.94.209.50 URL Requests**\n\nInterestingly, one of the 155.94.209.50 URL requests was for a ‘login.php’ page. When\nnavigating to that URL we were taken to a login page containing a “Mana Tools” logo.\n\n**Figure 3: Mana Tools C2 Panel**\n\nWhilst we did not have evidence of a URL request to 69.174.99.181 for a ‘login.php’ page,\nwhen navigating to the URL http[:]//69.174.99.181/webpanel-reza/login[.]php we were taken\nto an identical page.\n\nFirst reported in 2019 by Yoroi researchers, Mana Tools is a malware distribution and C2\npanel that was created by the threat actor Hagga. It has been associated with several wellknown malware variants, including RevengeRAT, AzoRult, Lokibot, Formbook, and Agent\nTesla.\n\nIn addition to 155.94.209.50, we identified a further three MySQL clients hosting the same\nexpired self-signed SSL certificate as 69.174.99.181.\n\n\n-----\n\nAccording to reverse DNS and WHOIS information, all the identified IPs (based on URL and\ncertificate data) are hosted on QuadraNet infrastructure.\n\n**Figure 4: Hostinger MySQL Client Relation**\n\nExamining open ports data for each of the above IPs, it appears that they are run on MSWindows based operating systems. In addition to having standard Windows ports open,\nTCP/445, TCP/3389, and TCP/445, they also returned WIN-NetBIOS Computer Names in\nthe RDP response.\n\nWe also found commonalities amongst several of the Hostinger MySQL client IPs in Passive\nDNS data.\n\nDomain bot.statusupdate[.]one (resolving to 161.129.64.49) was also observed in URL\nrequest data in connection with the Mana Tools C2 panel. 64.188.20.198 replaced the\noriginal C2 (69.174.99.181) as the hosting IP for domain update.newbotv2[.]monster.\n\nBased on threat telemetry for communications with the Hostinger IP and timestamps for the\nPassive DNS resolutions, it appears that the threat actor “rebranded” the C2 domain from\nbot.statusupdate[.]one to newbotv4[.]monster around 13 October 2021.\n\n**The X.509 Certificate**\n\n\n-----\n\nIt was identified that the certificate (Figure 3) with the serial B5C752C98781B503 was a\ndefault certificate included with OpenSSL as part of an XAMPP installation. XAMPP is a free,\nopen-source distribution that packages OpenSSL, MariaDB, PHP, and Perl with an Apache\nweb server. Its primary use is for developers, allowing them to deploy a web server on a local\nserver to test web applications without the need for an internet connection.\n\nGiven that this certificate was installed on several systems hosting Mana Tools, it appeared\nthat this threat actor was using XAMPP as the web server to host the Mana Tools C2 panel\non Windows virtual servers.\n\n**Back to the Hostinger IP**\n\nHaving identified the Hostinger IP as a common destination for MySQL traffic from several\nHagga C2s, we needed to find more evidence to connect Hagga to the cPanel server. As\nstated earlier, given the possibility that the cPanel IP is shared amongst multiple Hostinger\ncustomers, this was difficult to achieve based on threat telemetry alone. To aid this process,\n[we used insight derived from MalBeacon, in addition to further Passive DNS data.](https://www.malbeacon.com/)\n\n_Note: MalBeacon is a revolutionary system that can attribute malware campaigns to the_\n_threat actor themselves through proprietary pixel tracking technology. If you haven’t heard of_\n_it before, I urge you to check it out._\n\nMalBeacon data identified several actor IPs in the vicinity of Lahore, Pakistan, associated\nwith the C2s 69.174.99.181 and 64.188.20.198.\n\n**Table 3: Malbeacon data**\n\nWhilst examining threat telemetry data for the Hostinger IP, we found cPanel management\ntraffic to TCP/2083 from the actor IP 42.201.155.21 on 26 November 2021 and from\n42.201.155.40 between 02 December 2021 and 03 December 2021. This activity aligned\nwith the dates the IPs were associated with the Hagga C2s.\n\n\n-----\n\nWe also identified resolutions in passive DNS data that connect the newbotv4.monster and\nstatusupdate.one domains to Hostinger.\n\n**Table 4: Hostinger PDNS Results**\n\nWhilst the response IP differed from the Hostinger IP address seen in the outbound\nTCP/3306 connections, it aligned with the processes of leasing a cPanel VPS with Hostinger.\n\nWhen a user purchases their cPanel account through Hostinger, they are asked to add the\ndomain that they are seeking to host on the account to start the service. Once that domain is\nadded, Hostinger assigns several default hostnames to the domain that resolve to a second\nIP address, which differs from the cPanel management IP first provided. These default\nhostnames are what are detailed in Table 4.\n\nThe cPanel management IP can continue to be used for access to the web server control\npanel, or as an endpoint for a MySQL database.\n\n## Continued Observation of Hostinger IP\n\n\n-----\n\nBy continuously monitoring threat telemetry for the Hostinger IP and examining X.509\ncertificates and URL requests for new MySQL clients, we were able to identify additional\nrelated C2 infrastructure within hours or days of them being stood up.\n\n103.151.122.110 (VNPT-AS-VN, VN)\n72.11.157.208 (QuadraNet, US)\n192.154.226.47 (Reprise Hosting, US)\n64.188.21.227 (QuadraNet, US)\n72.11.143.125 (QuadraNet, US)\n72.11.143.47 (QuadraNet, US)\n207.32.217.137 (1G Servers, US)\n194.31.98.108 (PREFIXBROKER, NL)\n103.133.105.61 (VNPT-AS-VN, VN)\n78.138.105.142 VELIANET-FR-PINETLLC, FR)\n103.153.77.98 (VNPT-AS-VN, VN)\n\nAdditionally, we were able to identify an upgrade to the Mana Tools C2 panel.\n\n**Figure 5: New Mana Tools C2 Panel**\n\nWe revisited MalBeacon to examine beacon data for the newly discovered C2 domains and\nIP addresses to enumerate associated activity. We subsequently identified several ‘new’\nadversary IPs in the vicinity of Lahore, Pakistan. These IPs were observed in\n\n\n-----\n\ncommunications with the Hostinger IP during the same timeframe they were associated with\nthe Hagga C2 panels.\n\n**Figure 6: Hagga Activity**\n\n## Conclusion\n\nFrom the starting point of an IP address (69.174.99.181) associated with an Agent Tesla\ncommand and control server, it was possible to pivot and identify a backend server hosting a\nMySQL database operated by the threat actor Hagga. From this point a further pivot led us to\nthe identification of additional C2s hosting the Mana Tools C2 panel along with a common\ncertificate that can be used to increase confidence in attributing future infrastructure to this\nthreat actor.\n\n## Indicators of Compromise\n\n**IP Addresses**\n\n\n-----\n\n103.151.122.110\n72.11.157.208\n192.154.226.47\n64.188.21.227\n72.11.143.125\n72.11.143.47\n207.32.217.137\n194.31.98.108\n103.133.105.61\n78.138.105.142\n103.153.77.98\n69.174.99.181\n161.129.64.49\n155.94.209.50\n64.188.27.104\n64.188.20.198\n\n**Domains**\n\nmobibagugu.duckdns.org\nmobibanewdan.duckdns.org\nmohbeebnew.duckdns.org\nmubbibun.duckdns.org\ncdec22.duckdns.org\nvncgoga.duckdns.org\nbakuzamokala.duckdns.org\nwarnonmobina.duckdns.org\nabotherrdpajq.duckdns.org\nmobinomomuam.duckdns.org\nworkflowstatus.live\nheavy-dutyindustry.shop\nmicrosoftiswear.duckdns.org\nupdate.newbotv4.monster\nnewbotv4.monster\nbot.statusupdate.one\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-07-12 - An Analysis of Infrastructure linked to the Hagga Threat Actor.pdf"
    ],
    "report_names": [
        "2022-07-12 - An Analysis of Infrastructure linked to the Hagga Threat Actor.pdf"
    ],
    "threat_actors": [
        {
            "id": "28851008-77b4-47eb-abcd-1bb5b3f19fc2",
            "created_at": "2023-06-20T02:02:10.254614Z",
            "updated_at": "2025-03-27T02:00:03.130853Z",
            "deleted_at": null,
            "main_name": "Hagga",
            "aliases": [
                "TH-157",
                "Aggah"
            ],
            "source_name": "MISPGALAXY:Hagga",
            "tools": [
                "Agent Tesla"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535995,
    "ts_updated_at": 1743041420,
    "ts_creation_date": 1658168817,
    "ts_modification_date": 1658168817,
    "files": {
        "pdf": "https://archive.orkl.eu/404a0154aff6e951c80d337c4912431814208409.pdf",
        "text": "https://archive.orkl.eu/404a0154aff6e951c80d337c4912431814208409.txt",
        "img": "https://archive.orkl.eu/404a0154aff6e951c80d337c4912431814208409.jpg"
    }
}