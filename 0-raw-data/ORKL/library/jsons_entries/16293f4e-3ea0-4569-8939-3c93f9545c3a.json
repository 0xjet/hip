{
    "id": "16293f4e-3ea0-4569-8939-3c93f9545c3a",
    "created_at": "2023-01-12T15:07:30.840666Z",
    "updated_at": "2025-03-27T02:09:18.537026Z",
    "deleted_at": null,
    "sha1_hash": "95e0c4b0fa6b469bbc1b6d078478ca9c2a28ab94",
    "title": "2022-11-07 - SocGholish Diversifies and Expands Its Malware Staging Infrastructure to Counter Defenders",
    "authors": "",
    "file_creation_date": "2022-12-29T00:19:54Z",
    "file_modification_date": "2022-12-29T00:19:54Z",
    "file_size": 512183,
    "plain_text": "# SocGholish Diversifies and Expands Its Malware Staging Infrastructure to Counter Defenders\n\n**[sentinelone.com/labs/socgholish-diversifies-and-expands-its-malware-staging-infrastructure-to-counter-defenders/](https://www.sentinelone.com/labs/socgholish-diversifies-and-expands-its-malware-staging-infrastructure-to-counter-defenders/)**\n\nAleksandar Milenkoski\n\n## Executive Summary\n\nSince mid-2022, SocGholish operators have been significantly diversifying and\nexpanding their infrastructure for staging malware with new servers. This helps the\noperators to counter defensive operations against known servers and scale up their\noperation.\nSocGholish operators have been introducing on average 18 new malware-staging\nservers per month, with varying server uptimes. This marks an increase of 334%\nrelative to the same average calculated over the first half of 2022.\nThe majority of the new servers have been located in Europe, with the Netherlands, the\nUnited Kingdom, and France at the top of the list.\n\n## Overview\n\nSocGholish is a JavaScript-based framework that threat actors have used to gain initial\naccess to systems [since 2017. SocGholish uses social engineering to infect systems: it tricks](https://blog.sucuri.net/2022/08/socgholish-5-years-of-massive-website-infections.html)\nusers into running a malicious JavaScript payload that masquerades as a system or software\nupdate, such as a critical browser update.\n\n\n-----\n\n[In recent campaigns, SocGholish operators have infected legitimate websites by injecting a](https://expel.com/blog/incident-report-spotting-socgholish-wordpress-injection/)\ndrive-by-download mechanism that triggers the download of the payload through a second[stage server. A recent notable example is the infection of web assets of a media company](https://www.bleepingcomputer.com/news/security/hundreds-of-us-news-sites-push-malware-in-supply-chain-attack/)\nused by multiple major news outlets.\n\nThe rate at which SocGholish operators infect websites to establish initial points of contact\nwith victims is massive, with [reports of over 25000 newly infected websites since the](https://blog.sucuri.net/2022/08/socgholish-5-years-of-massive-website-infections.html)\nbeginning of 2022. We observe strong indications that SocGholish operators have been\nintroducing new second-stage servers since mid-2022 at a very high rate as well.\n\nAttackers conduct a variety of activities after gaining access through SocGholish, such as\nsystem and network [reconnaissance, establishing persistence, and deployment of additional](https://www.trendmicro.com/de_de/research/22/d/Thwarting-Loaders-From-SocGholish-to-BLISTERs-LockBit-Payload.html)\n[tools and malware. This includes tools for remote access, such as Cobalt Strike and](https://redcanary.com/threat-detection-report/threats/socgholish/)\n[NetSupport, and ransomware, such as WastedLocker, which has been attributed to the](https://www.sentinelone.com/labs/wastedlocker-ransomware-abusing-ads-and-ntfs-file-attributes/)\nthreat actor [EvilCorp.](https://assets.sentinelone.com/sentinellabs/sentinellabs_EvilCorp)\n\n## How Does SocGholish Stage Malware?\n\nIn [recent attack campaigns, SocGholish operators have infected legitimate websites by](https://twitter.com/ex_raritas/status/1541805780407463942)\ninjecting malicious JavaScript code into them.\n\nInjected SocGholish JavaScript code\nThe JavaScript code loads another script from a second-stage server that triggers the\ndownload of the SocGholish payload, which in turn masquerades as a legitimate system or\nsoftware update.\n\nThe SocGholish operators obfuscate the URL to the second-stage server using single or\ndouble Base-64 encoding. For example,\n```\nYUhSMGNITTZMeTlvWlcxcExtMWhiV0Z6WW1GclpYSjVMbTVsZEM5eVpYQnZjblEvY2oxa2FqRnBUbXBKTUU5WF\n\n\n```\nThe string is encoded in Base64 twice and decodes to\n```\n hxxps://hemi.mamasbakery[.]net/report?r=dj1iNjI0OWFiNTViODVhMDIxZmRjZCZjaWQ9MjYy\n\n```\nThere are currently two forms of URLs to second-stage SocGholish servers in circulation:\n\n\n-----\n\n```\n   [domain]/s_code.js?cid=[number]&v=[string]. For example,\n    hxxp://track.positiverefreshment[.]org/s_code.js?cid=220&v=24eca7c911f5e102e2ba\n   [domain]/report?r=[string], such as\n   hxxps://hemi.mamasbakery[.]net/report?r=dj1iNjI0OWFiNTViODVhMDIxZmRjZCZjaWQ9MjYy\n\n```\nwhere the value of the query parameter r is a Base-64 encoded version of the URL\nportion cid=[number]&v=[string] mentioned above.\n\n[Previous research discusses the values of the cid and v query parameters in greater](https://blog.sucuri.net/2022/08/socgholish-5-years-of-massive-website-infections.html)\ndetail.\n\n## SocGholish Diversifies and Expands Its Server Infrastructure\n\nWe observe that SocGholish operators have been introducing new second-stage servers\nsince mid-2022 at a much higher rate than before â€“ on average 18 servers per month.\n\nOver the first half of 2022, the SocGholish operators introduced 21 servers, an average of\nonly 3.5 servers per month. Between July and October 2022, they introduced 73 new\nsecond-stage servers. This marks an increase of 334% relative to the same average\ncalculated over the first half of 2022. The servers have been operational over time periods of\ndifferent lengths spanning days, weeks, and months.\n\n\n-----\n\nNew SocGholish servers since mid-2022\nIn addition to scaling up the malware staging operation, introducing new second-stage\nservers helps SocGholish operators to counter defensive operations against known servers.\nThis includes detection of network traffic to known servers as well as follow-up actions, such\nas denylisting the servers at endpoint- or network-level.\n\nFrom a geographical perspective, the majority of the new servers have been located in\nEurope, with 28 out of 73 servers being hosted in the Netherlands.\n\n\n-----\n\nGeographical distribution of the second-stage servers introduced since July 2022\nWe note that many of the servers are hosted at shadowed domains: attacker-created\nsubdomains under compromised legitimate domains. Domain shadowing allows the\nSocGholish operators to abuse the benign reputations of the compromised domains and\nmake detection more difficult.\n\nA recent [exception to the use of domain shadowing is a second-stage server hosted on the](https://twitter.com/unmaskparasites/status/1554186000112295936)\nAmazon Web Services domain d2j09jsarr75l2[.]cloudfront.net. It remains to be seen\nwhether the use of public Cloud infrastructure becomes a SocGholish trend.\n\nGiven the global impact of SocGholish, our observations are based on analyzing\nretrospective data (centered around URLs in the forms mentioned above) from the global\nsubmission-based databases urlscan.io and VirusTotal.\n\n## Conclusion\n\nSocGholish has been active since 2017. In 2022, SocGholish operators continue to infect\nwebsites at a massive scale and have been significantly expanding and diversifying their\nmalware staging infrastructure since mid-2022. The success of SocGholish in persisting on\n\n\n-----\n\nthe threat landscape emphasizes the importance of regularly auditing the security posture\nand integrity of web servers, websites, and DNS records to detect and protect against\nwebsite infections and domain shadowing.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-11-07 - SocGholish Diversifies and Expands Its Malware Staging Infrastructure to Counter Defenders.pdf"
    ],
    "report_names": [
        "2022-11-07 - SocGholish Diversifies and Expands Its Malware Staging Infrastructure to Counter Defenders.pdf"
    ],
    "threat_actors": [
        {
            "id": "6c4f98b3-fe14-42d6-beaa-866395455e52",
            "created_at": "2023-01-06T13:46:39.169554Z",
            "updated_at": "2025-03-27T02:00:03.011739Z",
            "deleted_at": null,
            "main_name": "Evil Corp",
            "aliases": [
                "GOLD DRAKE"
            ],
            "source_name": "MISPGALAXY:Evil Corp",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536050,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1672273194,
    "ts_modification_date": 1672273194,
    "files": {
        "pdf": "https://archive.orkl.eu/95e0c4b0fa6b469bbc1b6d078478ca9c2a28ab94.pdf",
        "text": "https://archive.orkl.eu/95e0c4b0fa6b469bbc1b6d078478ca9c2a28ab94.txt",
        "img": "https://archive.orkl.eu/95e0c4b0fa6b469bbc1b6d078478ca9c2a28ab94.jpg"
    }
}