{
    "id": "80bbcedf-9cf7-4140-b10b-f068108336df",
    "created_at": "2022-10-25T16:48:19.4313Z",
    "updated_at": "2025-03-27T02:16:20.78808Z",
    "deleted_at": null,
    "sha1_hash": "62d22fd778d5bf335028f9386e92f8b9aa9811a3",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-05-16T02:57:58Z",
    "file_modification_date": "2019-05-16T02:57:58Z",
    "file_size": 806300,
    "plain_text": "# Winnti: More than just Windows and Gates\n\n**[medium.com/chronicle-blog/winnti-more-than-just-windows-and-gates-e4f03436031a](https://medium.com/chronicle-blog/winnti-more-than-just-windows-and-gates-e4f03436031a)**\n\nMay 15, 2019\n\n[Chronicle](https://medium.com/@chroniclesec)\nMay 15\nThe Winnti malware family was first reported in 2013 by Kaspersky Lab¹. Since then,\nthreat actors leveraging Winnti malware have victimized a diverse set of targets for\nvaried motivations. While the name ‘Winnti’ in public reporting was previously used to\nsignify a single actor, pronounced divergence in targeting and tradecraft between\ncampaigns has led industry consensus to break up the tracking of the continued use of\nthe Winnti malware under different actor clusters. The underlying hypothesis² is that the\nmalware itself may be shared (or sold) across a small group of actors.\n\nIn April 2019, reports³ emerged of an intrusion involving Winnti⁴ malware at a German\nPharmaceutical company. Following these reports, Chronicle researchers doubled down\non efforts to try to unravel the various campaigns where Winnti was leveraged. Analysis\nof these larger convoluted clusters is ongoing. While reviewing a 2015 report⁵ of a Winnti\nintrusion at a Vietnamese gaming company, we identified a small cluster of Winnti⁶\nsamples designed specifically for Linux⁷. The following is a technical analysis of this\nvariant.\n\n## Technical Analysis\n\nThe Linux version of Winnti is comprised of two files: a main backdoor (libxselinux) and a\nlibrary (libxselinux.so) used to hide it’s activity on an infected system.\n\nAs with other versions of Winnti, the core component of the malware doesn’t natively\nprovide the operators with distinct functionality⁸. This component is primarily designed to\nhandle communications and the deployment of modules directly from the command-andcontrol servers. During our analysis, we were unable to recover any active plugins.\nHowever, prior reporting⁹ suggests that the operators commonly deploy plugins for\nremote command execution, file exfiltration, and socks5 proxying on the infected host.\nWe expect similar functionality to be leveraged via additional modules for Linux.\n\n**_‘libxselinux.so’ — the userland rootkit_**\n\n\n-----\n\nThe library used to hide Winnti’s system activity is a copy of the open-source userland\nrootkit Azazel¹⁰, with minor changes. When executed, it will register symbols for multiple\ncommonly used functions, including: open(), rmdir(), and unlink(), and modify their\nreturns to hide the malware’s operations. Below is a side-by-side comparison of the\nAzazel source code and the relevant function decompilation from ‘libxselinux.so’.\n\nDistinct changes to Azazel by the Winnti developers include the addition of a function\nnamed ‘Decrypt2’, which is used to decode an embedded configuration similar to the\ncore implant. Unlike standard Azazel which is configured to hide network activity based\n\n\n-----\n\non port ranges, the Winnti-modified version keeps a list of process identifiers and\nnetwork connections associated with the malware’s activity. This modification likely\nserves to simplify the operator’s sample configuration process by not having to denote\nspecific ports to hide.\n\nStrings within this sample associated with the malware’s operations are encoded using a\nsingle-byte XOR encoding. The following is an example Python function to decode these\nstrings.\n\n**_libxselinux_**\n\nWinnti Linux variant’s core functionality is within ‘libxselinux’. Upon execution, an\nembedded configuration is decoded from the data section using a simple XOR cipher.\nAn example Python function to decode this configuration is shown below:\n\nThe decoded configuration is similar in structure to the version Kaspersky classifies as\nWinnti 2.0¹¹, as well as samples in the 2015 Novetta report¹². Embedded in this sample’s\nconfiguration three command-and-control server addresses and two additional strings\n\n\n-----\n\nwe believe to be campaign designators. Winnti ver. 1, these values were designated as\n‘tag’ and ‘group’. A sample decoded configuration is shown below:\n\nWinnti Linux samples identified so far fall under three distinct campaign designators:\n\nFor context, embedded Winnti campaign designators have ranged from target names,\ngeographic areas, industry, and profanity.\n\n\n-----\n\n## Interactions with control servers\n\nWinnti malware handles outbound communications using multiple protocols including:\nICMP, HTTP, as well as custom TCP and UDP protocols. Use of these protocols is\nthoroughly documented in the Novetta and Kaspersky reports. While the outbound\ncommunication mechanisms are well documented, less attention has been paid to a\nfeature of recent versions of Winnti we came across in the Linux variant (as well as\nWindows) that allows the operators to initiate a connection directly to an infected host,\nwithout requiring a connection to a control server.\n\nThis secondary communication channel may be used by operators when access to the\nhard-coded control servers is disrupted. Additionally, the operators could leverage this\nfeature when infecting internet-facing devices in a targeted organization to allow them to\nreenter a network if evicted from internal hosts. This passive implant approach to\nnetwork persistence has been previously observed with threat actors like Project Sauron\nand the Lamberts.\n\nInitial technical information about this feature was shared by the Thyssenkrupp CERT in\nthe form of an Nmap¹³ script¹⁴ that could be used to identify Winnti infections through\nnetwork scanning. This script identifies infected hosts by first sending a custom hello\npacket, immediately followed by an encoded request for host information, and then\nparsing the response. The workflow of the script is diagrammed below:\n\n\n-----\n\nThe initial request, referred to as the helo/hello request in the Nmap script, is comprised\nof four DWORDs. The first three are generated by rand() and the fourth is computed\nbased on the first and third. When received by a Winnti-infected host, it will validate the\nreceived packet and listen for a second inbound request containing tasking. A\nbreakdown of this traffic is shown below.\n\nThis second request (Encoded Get System Information Request) is encoded using the\nsame method as the custom TCP protocol used for communication with command-andcontrol servers, which uses a two-byte XOR encoding. Before acting on the request,\nWinnti will validate the third DWORD contains the magic value 0xABC18CBA before\nexecuting tasking.\n\nWhile it may be possible to conduct broad scanning to identify infected systems, the\nresults would likely only be the subset that are directly Internet accessible.\n\n## Conclusion\n\nClusters of Winnti-related activity have become a complex topic in threat intelligence\ncircles, with activity vaguely attributed to different codenamed threat actors. The threat\nactors utilizing this toolset have repeatedly demonstrated their expertise in compromising\nWindows-based environments. An expansion into Linux tooling indicates iteration\noutside of their traditional comfort zone. This may indicate the OS requirements of their\nintended targets but it may also be an attempt to take advantage of a security telemitry\nblindspot in many enterprises, as is with Penquin Turla and APT28’s Linux XAgent\nvariant. Utilizing a passive listener as a communications channel is characteristic of the\nWinnti developers’ foresight in needing a failsafe secondary command-and-control\nmechanisms. Chronicle researchers maintain an active interest in clusters of Winnti\nactivity and our research is ongoing.\n\n\n-----\n\n## Additional Indicators\n\n YARA\n\n[(Click here for source rule text and additional IoCs)](https://gist.github.com/Blevene/10fe9c7a88ffd9863118db90e0a55a62)\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.05.15.Winnti_More/Winnti_%20More%20than%20just%20Windows%20and%20Gates.pdf"
    ],
    "report_names": [
        "Winnti_ More than just Windows and Gates"
    ],
    "threat_actors": [
        {
            "id": "a0d369c1-f0b7-4c70-a3a5-77aabbd17979",
            "created_at": "2022-10-25T15:50:23.311311Z",
            "updated_at": "2025-03-27T02:00:55.438117Z",
            "deleted_at": null,
            "main_name": "Strider",
            "aliases": [
                "ProjectSauron"
            ],
            "source_name": "MITRE:Strider",
            "tools": [
                "Remsec"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "99845f58-2c39-46f7-8369-bb621ebb7002",
            "created_at": "2022-10-25T16:07:24.238844Z",
            "updated_at": "2025-03-27T02:02:10.14785Z",
            "deleted_at": null,
            "main_name": "Strider",
            "aliases": [
                "ProjectSauron"
            ],
            "source_name": "ETDA:Strider",
            "tools": [
                "Backdoor.Remsec",
                "ProjectSauron",
                "Remsec"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c1ac2a5e-0225-47a4-8ac5-5fa898c96bde",
            "created_at": "2023-01-06T13:46:38.472883Z",
            "updated_at": "2025-03-27T02:00:02.84253Z",
            "deleted_at": null,
            "main_name": "ProjectSauron",
            "aliases": [
                "Sauron",
                "Project Sauron",
                "G0041"
            ],
            "source_name": "MISPGALAXY:ProjectSauron",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "23dfc9f5-1862-4510-a6ae-53d8e51f17b1",
            "created_at": "2024-05-01T02:03:08.146025Z",
            "updated_at": "2025-03-27T02:05:17.420497Z",
            "deleted_at": null,
            "main_name": "PLATINUM TERMINAL",
            "aliases": [
                "Longhorn ",
                "The Lamberts ",
                "Vault7 ",
                "APT-C-39 "
            ],
            "source_name": "Secureworks:PLATINUM TERMINAL",
            "tools": [
                " Assassin",
                " Marble Framework",
                "AfterMidnight"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e993faab-f941-4561-bd87-7c33d609a4fc",
            "created_at": "2022-10-25T16:07:23.460301Z",
            "updated_at": "2025-03-27T02:02:09.814816Z",
            "deleted_at": null,
            "main_name": "Longhorn",
            "aliases": [
                "APT-C-39",
                "Platinum Terminal",
                "The Lamberts"
            ],
            "source_name": "ETDA:Longhorn",
            "tools": [
                "Black Lambert",
                "Blue Lambert",
                "Corentry",
                "Cyan Lambert",
                "Fluxwire",
                "Gray Lambert",
                "Green Lambert",
                "Magenta Lambert",
                "Pink Lambert",
                "Plexor",
                "Purple Lambert",
                "Silver Lambert",
                "Violet Lambert",
                "White Lambert"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "70db80bd-31b7-4581-accb-914cd8252913",
            "created_at": "2023-01-06T13:46:38.57727Z",
            "updated_at": "2025-03-27T02:00:02.865012Z",
            "deleted_at": null,
            "main_name": "Longhorn",
            "aliases": [
                "the Lamberts",
                "APT-C-39",
                "PLATINUM TERMINAL"
            ],
            "source_name": "MISPGALAXY:Longhorn",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1557975478,
    "ts_modification_date": 1557975478,
    "files": {
        "pdf": "https://archive.orkl.eu/62d22fd778d5bf335028f9386e92f8b9aa9811a3.pdf",
        "text": "https://archive.orkl.eu/62d22fd778d5bf335028f9386e92f8b9aa9811a3.txt",
        "img": "https://archive.orkl.eu/62d22fd778d5bf335028f9386e92f8b9aa9811a3.jpg"
    }
}