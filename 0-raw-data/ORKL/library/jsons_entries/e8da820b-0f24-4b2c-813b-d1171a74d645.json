{
    "id": "e8da820b-0f24-4b2c-813b-d1171a74d645",
    "created_at": "2023-01-12T15:01:13.815317Z",
    "updated_at": "2025-03-27T02:10:03.222641Z",
    "deleted_at": null,
    "sha1_hash": "8cf5d3d76d5fa95a60e97cf27cf21f588ee7496f",
    "title": "2017-02-07 - Erebus Ransomware Utilizes a UAC Bypass and Request a 90 Ransom Payment",
    "authors": "",
    "file_creation_date": "2022-05-25T14:45:01Z",
    "file_modification_date": "2022-05-25T14:45:01Z",
    "file_size": 499647,
    "plain_text": "# Erebus Ransomware Utilizes a UAC Bypass and Request a $90 Ransom Payment\n\n**[bleepingcomputer.com/news/security/erebus-ransomware-utilizes-a-uac-bypass-and-request-a-90-ransom-payment](https://www.bleepingcomputer.com/news/security/erebus-ransomware-utilizes-a-uac-bypass-and-request-a-90-ransom-payment/)**\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nFebruary 7, 2017\n03:08 PM\n2\n\nA sample of a potentially new ransomware called Erebus has been discovered by\n[MalwareHunterTeam on VirusTotal. I say that this is a potentially new ransomware because](https://twitter.com/malwrhunterteam)\n[TrendMicro had reported another ransomware using the same name was previously released](http://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/ransom_erebus.a)\nback in September 2016. Though I do not have a sample of the original Erebus, from its\noutward characteristics, the one discovered today looks like either a complete rewrite or a\nnew ransomware using the same name..\n\nWhile at this time, it is not currently known how Erebus is being distributed, analysis of the\nransomware shows some interesting features. The first, and most noticeable features, is the\nlow ransom amount of ~$90 USD being requested by the ransomware. Another interesting\nfeatures is its use of a UAC bypass that allows the ransomware to run at elevated privileges\nwithout displaying a UAC prompt.\n\n## Erebus performs a UAC Bypass by Hijacking the MSC File Association\n\nWhen the installer for Erebus is executed, it will also utilize a User Account Control (UAC)\nbypass method so that victim's will not be prompted to allow the program to run at higher\nprivileges. It does this by copying itself to a random named file in the same folder. It will then\nmodify the Windows registry in order to hijack the association for the .msc file extension so\nthat it will launch the random named Erebus executed instead.\n\nThe hijacked keys are shown below.\n```\nHKEY_CLASSES_ROOT\\.msc\nHKCU\\Software\\Classes\\mscfile\nHKCU\\Software\\Classes\\mscfile\\shell\nHKCU\\Software\\Classes\\mscfile\\shell\\open\nHKCU\\Software\\Classes\\mscfile\\shell\\open\\command\nHKCU\\Software\\Classes\\mscfile\\shell\\open\\command\\ %UserProfile%\\[random].exe\n\n```\n\n-----\n\nErebus will then execute eventvwr.exe (Event Viewer), which in turn will automatically open\nthe eventvwr.msc file. As the .msc file is no longer associated with mmc.exe, but now with the\nrandom named Erebus executable, Event Viewer will launch Erebus instead. As Event Viewer\nruns in a elevated mode, the launched Erebus executable will also launch with the same\nprivileges. This allows it to bypass User Account Control.\n\nA big thanks to MalwareHunterTeam for pointing out the article that describes this bypass.\n\n## How Erebus Encrypts a Computer\n\nWhen Erebus is executed it will connect to http://ipecho.net/plain and\nhttp://ipinfo.io/country in order to determine the victim's IP address and country that they\nare located in. It will then download a TOR client and use it to connect to the site's\nCommand & Control server.\n\nErebus will then begin to scan the victim's computer and search for certain file types. When it\ndetects a targeted file type, it will encrypt the file using AES encryption. The current list of\ntargeted files are:\n```\n.accdb, .arw, .bay, .cdr, .cer, .crt, .crw, .dbf, .dcr, .der, .dng, .doc, .docm,\n.docx, .dwg, .dxf, .dxg, .eps, .erf, .indd, .jpe, .jpg, .kdc, .mdb, .mdf, .mef, .mrw,\n.nef, .nrw, .odb, .odm, .odp, .ods, .odt, .orf, .pdd, .pef, .pem, .pfx, .png, .ppt,\n.pptm, .pptx, .psd, .pst, .ptx, .raf, .raw, .rtf, .rwl, .srf, .srw, .txt, .wpd, .wps,\n.xlk, .xls, .xlsb, .xlsm, .xlsx\n\n```\n[When Erebus encrypts a file, it will encrypt the extension using ROT-23. For example, a file](https://en.wikipedia.org/wiki/Caesar_cipher)\n[called test.jpg would be encrypted and renamed as test.msj.](http://theblob.org/rot.cgi?text=msj)\n\n\n-----\n\n**Encrypted Files**\n\nDuring this process, Erebus will also clear the Windows Volume Shadow Copies so that they\ncannot be used to recover files. The command executed to clear the shadow copies is:\n```\ncmd.exe /C vssadmin delete shadows /all /quiet && exit\n\n```\nWhen it has finished encrypting the computer, it will display the ransom note located on the\nDesktop called README.HTML. This ransom note will contain a unique ID that can be\nused to login to the payment site, a list of encrypted files, and a button that takes you to the\nTOR payment site.\n\n\n-----\n\n**Erebus Ransomware Ransom Note**\n\nErebus will also display a message box on the Windows desktop alerting the victim that their\nfiles are encrypted.\n\n\n-----\n\n**Message Box Alert**\n\nWhen a victim clicks on the Recover my files button, they will be brought to Erebus' TOR\npayment site where they can get payment instructions. At this time the ransom amount is set\nto .085 bitcoins, which is approximately $90 USD.\n\n\n-----\n\n**Eerebus Ransomware Payment Site**\n\nUnfortunately, at this time there is no way to decrypt files encrypted by Erebus for free. For\nthose who wish to discuss this ransomware or receive support, you can use our dedicated\n[help topic: Erebus Ransomware Support & Help Topic.](https://www.bleepingcomputer.com/forums/t/639371/erebus-ransomware-support-help-topic-readmehtml/)\n\n### Associated Erebus Ransomware Files:\n\n\n-----\n\n```\n%UserProfile%\\AppData\\Local\\Temp\\tor\\\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Data\\\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Data\\Tor\\\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Data\\Tor\\geoip\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Data\\Tor\\geoip6\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\libeay32.dll\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\libevent-2-0-5.dll\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\libevent_core-2-0-5.dll\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\libevent_extra-2-0-5.dll\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\libgcc_s_sjlj-1.dll\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\libssp-0.dll\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\ssleay32.dll\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\tor-gencert.exe\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\tor.exe\n%UserProfile%\\AppData\\Local\\Temp\\tor\\Tor\\zlib1.dll\n%UserProfile%\\AppData\\Local\\Temp\\tor.zip\n%UserProfile%\\AppData\\Roaming\\tor\\\n%UserProfile%\\AppData\\Roaming\\tor\\cached-certs\n%UserProfile%\\AppData\\Roaming\\tor\\cached-microdesc-consensus\n%UserProfile%\\AppData\\Roaming\\tor\\cached-microdescs.new\n%UserProfile%\\AppData\\Roaming\\tor\\lock\n%UserProfile%\\AppData\\Roaming\\tor\\state\n%UserProfile%\\Desktop\\test\\xor-test.pdf\n%UserProfile%\\Desktop\\README.html\n%UserProfile%\\Documents\\README.html\n%UserProfile%\\[random].exe\n\n### Registry entries associated with the Erebus Ransomware\nHKEY_CLASSES_ROOT\\.msc\nHKCU\\Software\\Classes\\mscfile\nHKCU\\Software\\Classes\\mscfile\\shell\nHKCU\\Software\\Classes\\mscfile\\shell\\open\nHKCU\\Software\\Classes\\mscfile\\shell\\open\\command\nHKCU\\Software\\Classes\\mscfile\\shell\\open\\command\\ %UserProfile%\\[random].exe\n\n Network Communication:\nhttp://erebus5743lnq6db.onion/\n\n Hashes:\nSHA256: ed3a685ca65de70b79faf95bbd94c343e73a150e83184f67e0bdb35b11d05791\n\n Message Box Alert Text:\nFiles crypted!\nEvery important file on this computer was crypted. Please look on your documents or\ndesktop folder for a file called README.html for instructions on how to decrypt them.\n\n Ransom Note Text:\n\n```\n\n-----\n\n```\nData crypted\nEvery important file (documents,photos,videos etc) on this computer has been\nencrypted using an unique key for this computer. \nIt is impossible to recover your files without this key. You can try to open them\nthey won't work and will stay that way. \nThat is, unless you buy a decryption key and decrypt your files.\nClick 'recover my files' below to go to the website allowing you to buy the key. \nFrom now on you have 96 hours to recover the key after this time it will be deleted\nand your files will stay unusable forever \nYour id is : '[id]' you can find this page on your desktop and document folder Use it\nto \nif the button below doesn't work you need to download a web browser called 'tor\nbrowser' \ndownload by clicking here then install the browser, it's like chrome, firefox or\ninternet explorer except it allows you to browse to special websites. \nonce it's launched browse to http://erebus5743lnq6db.onion\n\n### Related Articles:\n\n```\n[Indian airline SpiceJet's flights impacted by ransomware attack](https://www.bleepingcomputer.com/news/security/indian-airline-spicejets-flights-impacted-by-ransomware-attack/)\n\n[US Senate: Govtâ€™s ransomware fight hindered by limited reporting](https://www.bleepingcomputer.com/news/security/us-senate-govt-s-ransomware-fight-hindered-by-limited-reporting/)\n\n[New RansomHouse group sets up extortion market, adds first victims](https://www.bleepingcomputer.com/news/security/new-ransomhouse-group-sets-up-extortion-market-adds-first-victims/)\n\n[Ransomware attack exposes data of 500,000 Chicago students](https://www.bleepingcomputer.com/news/security/ransomware-attack-exposes-data-of-500-000-chicago-students/)\n\n[The Week in Ransomware - May 20th 2022 - Another one bites the dust](https://www.bleepingcomputer.com/news/security/the-week-in-ransomware-may-20th-2022-another-one-bites-the-dust/)\n\n[Erebus](https://www.bleepingcomputer.com/tag/erebus/)\n[Ransomware](https://www.bleepingcomputer.com/tag/ransomware/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/security/76-popular-ios-apps-vulnerable-to-silent-interception-of-tls-encrypted-data/)\n[Next Article](https://www.bleepingcomputer.com/news/security/high-end-phishing-kit-automates-attacks-on-paypal-accounts/)\n\n### Comments\n\n\n-----\n\n[Kreppelklaus - 5 years ago](https://www.bleepingcomputer.com/forums/u/1040005/kreppelklaus/)\n\nThe registry change shouldn't work if registry is PW protected?!\nLike in a domain where users are only users?\n\n[Amigo-A - 5 years ago](https://www.bleepingcomputer.com/forums/u/998576/amigo-a/)\n\nLawrence, thanks for the detailed analysis and increased review!\n\n[Post a Comment Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-02-07 - Erebus Ransomware Utilizes a UAC Bypass and Request a 90 Ransom Payment.pdf"
    ],
    "report_names": [
        "2017-02-07 - Erebus Ransomware Utilizes a UAC Bypass and Request a 90 Ransom Payment.pdf"
    ],
    "threat_actors": [
        {
            "id": "4fe925e8-95e5-4a63-9f96-4d0f9bedac08",
            "created_at": "2022-10-25T15:50:23.469077Z",
            "updated_at": "2025-03-27T02:00:55.478056Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "DarkHydrus"
            ],
            "source_name": "MITRE:DarkHydrus",
            "tools": [
                "Mimikatz",
                "RogueRobin",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "921cea27-4410-42e4-8c11-7d40ba313225",
            "created_at": "2023-01-06T13:46:39.375789Z",
            "updated_at": "2025-03-27T02:00:03.067286Z",
            "deleted_at": null,
            "main_name": "RansomHouse",
            "aliases": [],
            "source_name": "MISPGALAXY:RansomHouse",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6efb28db-4d91-46cb-8ab7-fe9e8449ccfc",
            "created_at": "2023-01-06T13:46:38.772861Z",
            "updated_at": "2025-03-27T02:00:02.914846Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "Obscure Serpens",
                "LazyMeerkat",
                "G0079"
            ],
            "source_name": "MISPGALAXY:DarkHydrus",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5b04780e-7b64-4e62-b776-c6749ff7dec8",
            "created_at": "2022-10-25T16:07:23.531741Z",
            "updated_at": "2025-03-27T02:02:09.84903Z",
            "deleted_at": null,
            "main_name": "DarkHydrus",
            "aliases": [
                "ATK 77",
                "DarkHydrus",
                "LazyMeerkat",
                "Obscure Serpens"
            ],
            "source_name": "ETDA:DarkHydrus",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Mimikatz",
                "Phishery",
                "RogueRobin",
                "RogueRobinNET",
                "Trojan.Phisherly",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535673,
    "ts_updated_at": 1743041403,
    "ts_creation_date": 1653489901,
    "ts_modification_date": 1653489901,
    "files": {
        "pdf": "https://archive.orkl.eu/8cf5d3d76d5fa95a60e97cf27cf21f588ee7496f.pdf",
        "text": "https://archive.orkl.eu/8cf5d3d76d5fa95a60e97cf27cf21f588ee7496f.txt",
        "img": "https://archive.orkl.eu/8cf5d3d76d5fa95a60e97cf27cf21f588ee7496f.jpg"
    }
}