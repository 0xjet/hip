{
    "id": "5bf30a53-1aa1-46fe-84b3-1c6361f20176",
    "created_at": "2023-01-12T15:06:03.410404Z",
    "updated_at": "2025-03-27T02:11:41.78664Z",
    "deleted_at": null,
    "sha1_hash": "efaeb6b5d631e22577165e88f5f2f48faf277044",
    "title": "2022-10-18 - Hunting Lockbit Variation",
    "authors": "",
    "file_creation_date": "2022-12-29T00:16:25Z",
    "file_modification_date": "2022-12-29T00:16:25Z",
    "file_size": 433707,
    "plain_text": "# Hunting LockBit Variations using Logpoint\n\n**[logpoint.com/en/blog/hunting-lockbit-variations-using-logpoint/](https://www.logpoint.com/en/blog/hunting-lockbit-variations-using-logpoint/)**\n\nRasmus Plambech October 18, 2022\n\n_– Anish Bogati & Nilaa Maharjan; Logpoint Global Services & Security Research_\n\n## Executive Summary:\n\nLockBit has been implicated as the most active ransomware and has been involved in\nthe most attacks compared to others of its kind.\nLockBit emerged in September 2019 functioning as ransomware-as-a-service (RaaS).\nSince then it evolved into LockBit2.0 as a variant of the original LockBit ransomware\ngang.\n\nDuring this time, the gang started a double extortion model.\nCurrently running as LockBit3.0, or LockBit Black, the ransomware gang is actively\ntargeting multiple sectors, most commonly banking, financial services, and insurance\n(BFSI).\nLockBit shares behaviors with MegaCortex and LockerGoga. It is self-spreading,\ntargeted, and uses similar tools.\nThe largest case of LockBit includes Accenture in August 2021 which stole 6 terabytes\nof data and demanded $50 million in ransom.\nLockBit 3.0 announced its own bug bounty program to let security researchers and\nhackers alike find flaws in their projects and infrastructure hosted on the dark web.\n\n## What is LockBit?\n\nLockBit, formerly known as “ABCD” ransomware due to the conversion of encrypted files to\nthe “.abcd” extension is a ransomware-as-a-service (RaaS) malware. The threat actors have\nbeen updating this ransomware features and capabilities since it was first detected in\nSeptember 2019. It also advertised itself as the fastest ransomware to encrypt files. It shares\nsome similarities with Darkside/black matter ransomware, uses passwords to run like\nblackcat/aplhv, and is believed to be part of the LockerGoga & MegaCortex family.\n\nLockBit’s family of ransomware is known to be self-spreading, yet has been found targeting\nspecific companies that are able to pay a large ransom.\n\n\n-----\n\nImage Showing Desktop Wallpaper after Encryption Process is Completed\n\nThe LockBit creators offer access to the ransomware program and its infrastructure to thirdparty hackers known as affiliates, who break into networks and install it on systems in\nexchange for a cut of up to 75% of the ransom paid by victims. LockBit, like most similar\nRaaS gangs, employ double extortion tactics in which its associates exfiltrate data from\nvictim organizations and threaten to disclose it online.\n\n[According to research by ransomware incident response provider Coveware, LockBit was](https://www.coveware.com/lockbit-ransomware)\nresponsible for 15% of ransomware assaults seen in the first quarter of 2022, trailing only\nConti with 16%. According to a more recent assessment, LockBit was responsible for 40% of\nthe ransomware assaults seen by NCC Group in May, followed by Conti.\n\nWhile the overall number of ransomware incidents has decreased in recent months, the\npercentage that LockBit accounts for is likely to rise, partly because the Conti operation is\n[believed to have shut down or splintered into smaller groups, and partly because LockBit is](https://www.csoonline.com/article/3638056/conti-ransomware-explained-and-why-its-one-of-the-most-aggressive-criminal-groups.html)\nattempting to attract more affiliates by claiming to offer better terms than competitors.\n\n### Origin and Evolution\n\nLockBit has evolved from the early days of ABCD. The RaaS affiliate program was released\nin early 2020, followed by the data leak site and the addition of data leak extortion later that\nyear.\n\nDuring its first year of operation, LockBit remained a minor participant, with other high-profile\ngangs—Ryuk, REvil, Maze, and others—being more successful and in the spotlight. With the\nrelease of LockBit 2.0 and after some of the other gangs shut down their activities due to too\n\n\n-----\n\nmuch pressure, the LockBit ransomware gained traction in the second half of 2021.\n\n[According to researchers from Palo Alto Networks’ Unit 42, LockBit 2.0 was “the most](https://unit42.paloaltonetworks.com/lockbit-2-ransomware/)\nimpactful and widely deployed ransomware variant we have observed in all ransomware\nbreaches during the first quarter of 2022, considering both leak site data and data from\ncases handled by Unit 42 incident responders.” The group’s LockBit 2.0 site, which it uses to\npublish data from corporations whose networks it has infiltrated, names 850 victims, but the\ngang claims to have ransomed over 12,125 firms so far.\n\nThe group also claims that the LockBit 2.0 ransomware has the quickest encryption\n[procedure, which according to Splunk researchers is only partially true. LockBit 1.0 and the](http://splunk.com/en_us/blog/security/truth-in-malvertising.html)\nransomware program PwndLocker appear to be faster than LockBit 2.0, but the encryption\nprocess is still quite fast, thanks in part to the fact that these threats use partial encryption.\nLockBit 2.0, for example, encrypts only the first 4KB of each file, rendering it unreadable and\nunusable while also allowing the attack to finish quickly before incident responders have time\nto shut down systems and isolate them from the network.\n\nResearchers have found connections between the current LockBit ransomware variant and\nBlackMatter, a rebranded form of the DarkSide ransomware strain that shut down in\nNovember 2021.\n\nLockBit 3.0, also known as LockBit Black, was released in June 2022, including a new leak\nsite and the world’s first ransomware bug bounty program, with Zcash cryptocurrency as a\npayment option.\n\nIt encrypts each file by appending the extension “HLJkNskOq” or “19MqZqZ0s” and changes\nthe icons of the locked files to the “.ico” file dropped by the LockBit sample to initiate the\ninfection.\n\n## Who is LockBit targeting?\n\n[According to BlackFog’s most recent “Ransomware Trend Report,” there is a renewed](https://www.blackfog.com/the-state-of-ransomware-in-2022/)\nemphasis on weaker targets, such as education (33% increase), government (25%\nincrease), and manufacturing (24% increase).\n\nAttacks in June on the University of Pisa (which paid a $4.5 million ransom), Brooks County\nin Texas (which paid a $37,000 ransom with taxpayer money), and the Cape Cod Regional\nTransit Authority all demonstrate this.\n\nIn total, 31 publicly publicized ransomware incidents were recorded by BlackFog in June.\n\nMatt Hull, NCC Group’s worldwide lead for strategic threat intelligence, finally pointed to\n“major changes” in the ransomware threat landscape, adding that “it is evident we are in a\ntransitory phase.”\n\n\n-----\n\nThis is an ever-changing landscape that must be constantly evaluated, he said.\n\nAccording to data from LockBit’s data leak site, nearly half of the victim organizations were\nfrom the United States, followed by Italy, Germany, Canada, France, and the United\nKingdom. According to the LockBit gang member in the previous interview, the concentration\non North American and European firms is owing to a larger prevalence of cyber insurance as\nwell as higher profits in these regions. Professional and legal services, construction, the\nfederal government, real estate, retail, high tech, and manufacturing have been the most\nimpacted industry verticals. The malware also includes code that stops it from being\nexecuted on PCs configured with Eastern European language settings.\n\nBased on tweets by @VX-underground Twitter bot @RansomwareNews from May 17 to\nSeptember 221, LockBit accounted for twice as much as its closest competitor, BlackBastaa,\nAplhv/BlackCat, Hiveleak, and clop.\n\n\n-----\n\nIt should also be noted that the LockBit gang has created a separate malware application\ncalled StealBit that can be used to automate data exfiltration. This tool uploads the data\ndirectly to LockBit’s servers rather than using public file hosting sites, which may erase the\ndata in response to victim complaints. The group has also created the LockBit Linux-ESXi\nLocker, which can encrypt Linux servers and VMware ESXi virtual machines.\n\nLockBit attackers spent roughly 70 days within a network before releasing the ransomware in\nQ4 2021, 35 days in Q1 2022, and fewer than 20 days in Q2 2022. This means that\nenterprises have less time to detect network attacks in their early stages and prevent\nransomware deployment. According to Palo Alto Networks, the attackers’ willingness to\n\n\n-----\n\nbargain and lessen the ransom sum has also decreased. Last year, the attackers were\nwilling to reduce the ransom sum by more than 80%, but currently, victims may only expect a\n30% price drop on average.\n\n## LockBit Operations\n\nAfter obtaining initial access to networks, LockBit affiliates deploy various tools to expand\n[their access to other systems. These tools involve credential dumpers like Mimikatz; privilege](https://www.csoonline.com/article/3353416/what-is-mimikatz-and-how-to-defend-against-this-password-stealing-tool.html)\nescalation tools like ProxyShell, tools used to disable security products and various\nprocesses such as GMER, PC Hunter, and Process Hacker; network and port scanners to\nidentify active directory domain controllers, remote execution tools like PsExec or Cobalt\nStrike for lateral movement. The activity also involves the use of obfuscated PowerShell and\nbatch scripts and rogue scheduled tasks for persistence.\n\nOnce deployed, the LockBit ransomware can also spread to other systems via SMB\nconnections using collected credentials as well as by using Active Directory group policies.\nWhen executed, the ransomware will disable Windows volume shadow copies and delete\nvarious system and security logs.\n\nThe malware then collects system information such as hostname, domain information, local\ndrive configuration, remote shares, and mounted storage devices then will start encrypting all\ndata on the local and remote devices it can access. After encrypting all the files LockBit also\nchanges the file’s icon with their icon.\n\nAfter the registry entry is created then the icon from the “C:\\ProgramData” is loaded in the\nregistry value. When the encryption process of a file is completed then the icons of files are\nchanged to the icon present in the above mention registry key.\n\n\n-----\n\nHowever, it skips files that would prevent the system from functioning. In the end, it drops a\nransom note by changing the user’s desktop wallpaper with information on how to contact\nthe attackers.\n\nWe go into a lot of detail on how the threat actors have been operating, and the Tactic,\nTechniques, and Procedures(TTPs) they have been using through static and dynamic\nanalysis in the report attached below. We uncovered multiple files, domains, and botnet\nnetworks that are still active in the wild. All artifacts are provided as lists and the associated\nalerts are available to download as part of Logpoint’s latest release, as well as through\nLogpoint’s [download center.](https://servicedesk.logpoint.com/hc/en-us/articles/115003928409)\n\nLogpoint Emerging Threats Protection Service provides the service subscribers with\ncustomized investigation and response playbooks, tailored to your environment. Contact the\n[global services team here.](https://www.logpoint.com/en/contact/)\n\nThe report containing the analysis, infection chain, detection, and mitigation using logpoint\nSIEM and SOAR can be downloaded from the link below.\n\n[Download report](https://www.logpoint.com/wp-content/uploads/2022/10/hunting-lockbit-variations-using-logpoint-.pdf)\n\n\n-----\n\nDownload report\n\n### Contact Logpoint\n\nContact us and learn why\n\nindustry-leading companies\n\nchoose Logpoint:\n\nContact Logpoint\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-18 - Hunting Lockbit Variation.pdf"
    ],
    "report_names": [
        "2022-10-18 - Hunting Lockbit Variation.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "0fc739cf-0b82-48bf-9f7d-398a200b59b5",
            "created_at": "2022-10-25T16:07:23.797925Z",
            "updated_at": "2025-03-27T02:02:09.983353Z",
            "deleted_at": null,
            "main_name": "LockBit Gang",
            "aliases": [
                "Bitwise Spider",
                "Operation Cronos"
            ],
            "source_name": "ETDA:LockBit Gang",
            "tools": [
                "3AM",
                "ABCD Ransomware",
                "CrackMapExec",
                "EmPyre",
                "EmpireProject",
                "LockBit",
                "LockBit Black",
                "Mimikatz",
                "PowerShell Empire",
                "PsExec",
                "Syrphid"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535963,
    "ts_updated_at": 1743041501,
    "ts_creation_date": 1672272985,
    "ts_modification_date": 1672272985,
    "files": {
        "pdf": "https://archive.orkl.eu/efaeb6b5d631e22577165e88f5f2f48faf277044.pdf",
        "text": "https://archive.orkl.eu/efaeb6b5d631e22577165e88f5f2f48faf277044.txt",
        "img": "https://archive.orkl.eu/efaeb6b5d631e22577165e88f5f2f48faf277044.jpg"
    }
}