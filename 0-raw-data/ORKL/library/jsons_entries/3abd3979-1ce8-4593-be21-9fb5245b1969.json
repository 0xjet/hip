{
    "id": "3abd3979-1ce8-4593-be21-9fb5245b1969",
    "created_at": "2023-01-12T15:02:33.916461Z",
    "updated_at": "2025-03-27T02:05:25.527428Z",
    "deleted_at": null,
    "sha1_hash": "00707e915e35fc207176b74744d6858a7ce2e074",
    "title": "2021-06-23 - Ransomware- Growing Number of Attackers Using Virtual Machines",
    "authors": "",
    "file_creation_date": "2022-05-28T23:12:32Z",
    "file_modification_date": "2022-05-28T23:12:32Z",
    "file_size": 899259,
    "plain_text": "# Ransomware: Growing Number of Attackers Using Virtual Machines\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-virtual-machines](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/ransomware-virtual-machines)**\n\n\n-----\n\nThreat Hunter TeamSymantec\n\n## Tactic hides ransomware payload and lowers the risk of discovery while encryption process is underway.\n\nSymantec has found evidence that an increasing number of ransomware attackers are using\nvirtual machines (VMs) in order to run their ransomware payloads on compromised\ncomputers. The motivation behind the tactic is stealth. In order to avoid raising suspicions or\ntriggering antivirus software, the ransomware payload will “hide” within a VM while encrypting\nfiles on the host computer.\n\n[The tactic is a recent development, having been documented by Sophos in connection with](https://news.sophos.com/en-us/2020/05/21/ragnar-locker-ransomware-deploys-virtual-machine-to-dodge-security/)\nRagnarLocker last year. In that case, ransomware was run from inside an Oracle VirtualBox\nWindows XP VM.\n\n## VirtualBox usage\n\nDuring a recent investigation into an attempted ransomware attack, Symantec discovered\nthat the attackers had installed a VirtualBox VM on some compromised computers. Unlike\nthe previously documented RagnarLocker attacks, which involved Windows XP, the VM in\nthis case appeared to be running Windows 7.\n\nThe VM was delivered to the target via a malicious installer file that used various file names,\nincluding:\n\nfuckyou.msi\nfuck.msi\naa51978f.msi\ns3c.msi\n\nThe installer created a file called runner.exe, which was a Golang (Go) executable compiled\nfrom the following source file:\n\nC:/builder/runner/main.go\n\n[Apart from standard Go libraries, it used the go-ps library for process enumeration.](https://github.com/mitchellh/go-ps)\nEmbedded strings used by the executable, such as file names, process names, and\ncommands, were obfuscated using four-byte XOR keys. Each string was encrypted using a\nunique key.\n\n\n-----\n\nThis executable depended on multiple other files that were expected to be present in the\nsame directory. Its main purpose was to install a VirtualBox VM in a headless mode.\n\nWhen executed, runner.exe performed following actions:\n\nIt checked if it was running on Active Directory (AD) controller based on whether the\n_C:\\Windows\\SYSVOL directory was present. It exited if the check proved true._\nIt used a function named russianDetect to check if it was running on a system using a\nRussian keyboard layout (0x0419). It exited if the check proved true. Checks such as\nthis are a common feature of targeted ransomware attacks.\nIt enumerated running processes and services and terminated any that were present\non blacklists (procBlacklist, servicesBlacklist) using taskkill.exe and sc.exe.\n\nThe executable then dropped, executed, and deleted a file called starter.bat with the\nfollowing content in order to mount a recovery partition:\n\n_mountvol E:\\ \\\\?\\Volume{<ID>}\\_\n\nIt then decrypted and dropped VirtualBox.xml, a VirtualBox configuration file, and micro.xml,\na VM configuration file (see appendix). It created an SDRSMLINK directory and linked\nsystem files to that directory, e.g:\n\n_cmd /C mklink /j \"%SYSTEMROOT%\\SDRSMLINK\\Program Files\"_\n_\"%SYSTEMROOT%\\Program Files\"_\n\nIt also adjusted the \"<SharedFolders>\" section in micro.xml to reflect files and directories\nlinked in CSIDL_WINDOWS\\SDRSMLINK. It then initialized VirtualBox components:\n\nIt enumerated and cleared Windows system logs using WEvtUtil.exe:\n\nSymantec did not obtain a VM image, but what likely occurred next was that the ransomware\npayload was located on the VM's disk and auto started once the operating system was fully\nbooted. The VM likely had access to the host computer’s files and directories (via\n\"SharedFolders\" set up by runner.exe), allowing it to encrypt files on the host computer.\n\n## Conti or Mount Locker?\n\nWhile the payload running in the VM was not identified, there were reasonably strong\nindicators that it was Conti. A username and password combination\n[(nuuser/[email protected]) used in these attacks was previously associated with older Conti](http://10.10.0.46/cdn-cgi/l/email-protection)\nactivity, dating from April 2021.\n\n\n-----\n\nHowever, on the same computer that the VM was deployed on, Symantec also observed\nMount Locker being deployed, raising the question as to whether the payload was actually\nMount Locker. Since the main purpose of running a payload on a VM is to avoid detection, it\ndoesn’t make much sense for the attacker to also deploy the payload on the host computer.\n\nOne possible explanation is that the attacker is an affiliate operator with access to both Conti\nand Mount Locker. They may have attempted to run a payload (either Conti or Mount Locker)\non a virtual machine and, when that didn’t work, opted to run Mount Locker on the host\ncomputer instead.\n\n## Obfuscating malicious activity\n\nRansomware operators are continually refining their tactics in a bid to stay one step ahead of\ndetection. Many are now heavily relying on legitimate and dual-use tools in order to stage\nattacks on targeted networks. The ransomware payload itself is often the stage of the attack\nmost likely to raise red flags and, by hiding it in a virtual machine, there is an expectation that\nit may not be discovered. Organizations should exercise increased vigilance in relation to the\nunauthorized installation of virtual machines on their networks.\n\n## Protection/Mitigation\n\n[For the latest protection updates, please visit the Symantec Protection Bulletin.](https://www.broadcom.com/support/security-center/protection-bulletin)\n\n## Indicators of Compromise\n\n2eae8e1c2e59527b8b4bb454a51b65f0ea1b0b7476e1c80b385f579328752836 Installer\n9f801a8d6b4801b8f120be9e5a157b0d1fc3bbf6ba11a7d202a9060e60b707d8\n\n   - runner.exe\ne5291bae18b0fa3239503ab676cacb12f58a69eb2ec1fd3d0c0702b5a29246cb\n\n   - VirtualBox\nd89bd47fb457908e8d65f705f091372251bae3603f5ff59afb2436abfcf976d8\n\n   - Mountlocker\n8f247e4149742532b8a0258afd31466f968af7b5ac01fdb7960ac8c0643d2499\n\n   - Mountlocker\n\n## Appendix\n\nVirtualBox.xml - VirtualBox configuration file\n\nMicro.xml - virtual machine configuration file\n\n\n-----\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-23 - Ransomware- Growing Number of Attackers Using Virtual Machines.pdf"
    ],
    "report_names": [
        "2021-06-23 - Ransomware- Growing Number of Attackers Using Virtual Machines.pdf"
    ],
    "threat_actors": [
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535753,
    "ts_updated_at": 1743041125,
    "ts_creation_date": 1653779552,
    "ts_modification_date": 1653779552,
    "files": {
        "pdf": "https://archive.orkl.eu/00707e915e35fc207176b74744d6858a7ce2e074.pdf",
        "text": "https://archive.orkl.eu/00707e915e35fc207176b74744d6858a7ce2e074.txt",
        "img": "https://archive.orkl.eu/00707e915e35fc207176b74744d6858a7ce2e074.jpg"
    }
}