{
    "id": "e67f0d18-8f04-4f06-8bf9-6e0468bae2e7",
    "created_at": "2023-04-05T02:08:56.122142Z",
    "updated_at": "2025-03-27T02:05:57.430781Z",
    "deleted_at": null,
    "sha1_hash": "616f6943044d1d653138eb2c6434fb77360489c1",
    "title": "2023-03-21 - Nexus- a new Android botnet-",
    "authors": "",
    "file_creation_date": "2023-04-03T08:48:23Z",
    "file_modification_date": "2023-04-03T08:48:23Z",
    "file_size": 5093361,
    "plain_text": "# Nexus: a new Android botnet?\n\n**cleafy.com/cleafy-labs/nexus-a-new-android-botnet**\n\n,\n\n## Download your PDF guide to TeaBot \n\nGet your free copy to your inbox now\n\nDownload PDF Version\n\n## Key point\n\nOn January 2023, a new Android banking trojan appeared on multiple hacking forums\nunder the name of Nexus. However, Cleafy’s Threat Intelligence & Response Team\ntraced the first Nexus infections way before the public announcement in June 2022.\nNexus is promoted via a Malware-as-a-Service (MaaS) subscription a particular type\nof cybercrime in which malware creators or distributors provide their services to other\ncriminals or individuals on a rental or subscription basis. Developers offer their\nservices on underground forums or through private channels (e.g., Telegram), and their\nclients pay a fee to use the malware.\n**Nexus appears to be in its early stages of development (BETA). Multiple**\ncampaigns active worldwide confirm that multiple TAs are already using this thread to\nconduct fraudulent campaigns.\nNexus provides all the main features to perform ATO attacks (Account Takeover)\nagainst banking portals and cryptocurrency services, such as credentials stealing and\nSMS interception. It also provides a built-in list of injections against 450 financial\napplications.\nDespite Nexus being promoted as a brand-new malware, it contains some relations\nwith the [SOVA banking trojan, suggesting that developers adopted and reused old](https://www.cleafy.com/cleafy-labs/sova-malware-is-back-and-is-evolving-rapidly)\ndevelopments.\n\n## Introduction\n\nAt the beginning of January 2023, a new Android banking botnet named Nexus was\npromoted by a user on multiple underground hacking forums. The following image\nrepresents the original thread promoted by the author:\n\n\n-----\n\nFigure 1 - Nexus thread on a hacking forum\nFollowing the discussion, the authors claim that the source code of Nexus has been entirely\nwritten from scratch, but it is still in its early development days. Despite this, the authors\nbehind Nexus announced that it was already available for rent at a steep price of $3000 per\n**month through a MaaS subscription. MaaS stands for Malware-as-a-Service, and it is a**\nmodel used in the cybercrime world to offer their malware for rent or sale to other TAs who\nlack the technical expertise to develop their malware.\n\n**This model is prevalent in Android banking trojans, where malware authors use MaaS**\nplatforms to distribute their malware to a broader audience. The MaaS model allows\ncriminals to monetize their malware more efficiently by providing a ready-made infrastructure\nto their customers, who can then use the malware to attack their targets.\n\nIt is common for MaaS providers to impose restrictions on the geographies where their\ncustomers can conduct attacks using rented or purchased malware. The Nexus authors, for\nexample, have a \"code of conduct\" rule prohibiting using their malware in Russia and\n**CIS countries.**\n\n\n-----\n\nFigure 2 - Nexus code of conduct for customers\n\n## Previous activities and linking with SOVA\n\nDespite the official launch of the Nexus MaaS program on 27th January 2023, our internal\ntelemetries identified previous related activities behind this botnet, as shown in the following\nFigure:\n\nFigure 3 - Nexus activities (Cleafy telemetries)\nOn August 2022, during the analysis of those samples, technical indicators suggested\n**some code similarity between Nexus samples and SOVA, an Android banking trojan**\nemerged in mid-2021. At that time, it was considered a new variant of SOVA, as described in\nour [previous blog article.](https://www.cleafy.com/cleafy-labs/sova-malware-is-back-and-is-evolving-rapidly)\n\nDespite the new MaaS program launched under the name Nexus, the authors may have\nreused some parts of SOVA internals, to write new features (and rewrite some of the existing\nones).\n\nRecently, the SOVA author, who operates under the alias “sovenok”, started sharing some\ninsights on Nexus and its relationship with SOVA, calling out an affiliate who previously\nrented SOVA for stealing the entire source code of the project.\n\n\n-----\n\nFigure 4 - sovenok accusing other TAs of stealing SOVA source code\n**This event could explain why parts of the SOVA source code have been passing**\n**through multiple banking trojans. In fact, sovenok identified another Android botnet that**\noperates under the name of POISON, which he considers to be highly linked to Nexus:\n\nFigure 5 - ‘sovenok’ linking Nexus andPOISON banking trojans\nFocusing on technical indicators, the following Figure shows the overlap found between the\ncommands on SOVA and Nexus. As a result, it appears that most of the SOVA commands\n(marked in green) were also reused on Nexus:\n\nFigure 6 - Commands overlap between Nexus and SOVA\nAnother similarity between Nexus and SOVA is how geographic location is checked.\nAnalyzing the bootstrap of the infection, it was possible to discover that Nexus implements a\nfunction called preloadCheck() to identify if the victim is actually in a country “allowed” to be\nattacked. If the check succeeds, it starts the infection chain. Otherwise, the application\nsimply terminates the activity.\n\n\n-----\n\nFigure 7 - Checking the geographic location of the device\nCurrently, countries that are ignored are: AZ (Azerbaijan), AM (Armenia), BY (Belarus), KZ\n(Kazakhstan), KG (Kyrgyzstan), MD (Moldova), RU (Russian Federation), TJ (Tajikistan), UZ\n(Uzbekistan), UA (Ukraine), ID (Indonesia).\n\nFigure 8 - Excluded countries\nMoreover, another routine is deployed to discern if the victim is eligible to become part of the\nbotnet. In this case, the attackers try to verify if the official Sberbank (Russia's biggest bank)\napplication is installed.\n\nFigure 9 - Check the presence of the Sberbank mobile application\nLastly, there are many APIs similarities used by both SOVA and Nexus to communicate with\nthe C2 server, as confirmed by sovenok.\n\nFigure 10 - sovenok accuses other TAs of stealing SOVA APIs\n\n## Technical Analysis: Main features and Commands\n\nNexus contains all the main features to perform Account Takeover attacks (ATO) against\nbanking apps from all over the world and cryptocurrency services. In particular, it can:\n\nPerform Overlay attacks and keylogging activities to steal users' credentials.\n\n\n-----\n\nFigure 11 - Nexus overlay attack\n\n**Steal SMS messages to obtain the two-factor authentication codes.**\nThrough the abuse of the Accessibility Services, Nexus can steal some information\nfrom crypto wallets (such as seeds and balance), the 2FA codes of Google\n**Authenticator app, and the cookies from specific websites.**\n\nComparing the list of commands of two Nexus samples (one from August 2022 and one from\nMarch 2023), it is possible to note the addition of some new commands, such as the\nability to remove received SMS and the feature to activate or stop the 2FA stealer module.\n\nThe following evidence, in addition to some claims by the Nexus author concerning the\npossibility of adding a VNC module, underlines the desire to further improve the malware\nwith new features.\n\n\n-----\n\nFigure 12 - New Nexus commands in recent samples\n\n## Update Capacity\n\n**Nexus is also equipped with a mechanism for autonomous updating. A dedicated**\nfunction asynchronously checks against its C2 server for updates when the malware is\nrunning. More specifically, it performs a check towards a dedicated endpoint asking for the\nlast version; the query look like the following line:\n\n_http(s)://C2_domain/lastversion?access=XXXXX&key=XXXXXXXX_\n\nIf the value sent back from the C2 does not correspond to the one installed on the device,\nthe malware starts the update process. Otherwise, it ignores the value and continues with all\nits routine activities. The update begins concatenating the URL related to the C2 and a key\nthat will be used as an authorization token.\n\n\n-----\n\nFigure 13 - Update APK routine\nAt the time of writing, the version available is related to the build 7.20.\n\nFigure 14 - Latest build version available\nAnalysts could use the “key” value to keep track of different custom versions of Nexus, it was\npossible to identify a slightly modified version of the malware for each key. This suggests that\nmore actors are renting customized samples that aim to hit specific targets and countries.\n\nFigure 15 - Latest build version available\n\n## Ransomware module?\n\nAccording to the information retrieved from various samples, Nexus is equipped with\n**encryption capabilities. However, this module seems to be under development due to the**\npresence of debugging strings and the lack of usage references (especially within the C2\ncommand list).\n\nHowever, we can’t exclude that this function is a “typo” associated with the cut-and-paste\nactivities that seem to involve many parts of the code.\n\nFigure 16 - AES encryption routine (not in use)\nIt is reasonable to ask why this encryption paradigm has been implemented. An explanation\ncould be found in an attempt of making it harder for the user to realize what happened. A\n[similar approach, even more destructive, has been used by Brata, where TAs adopted the](https://www.cleafy.com/cleafy-labs/brata-is-evolving-into-an-advanced-persistent-threat)\n\n\n-----\n\nstrategy of factory resetting the device right after an unauthorized wire transfer attempt to\nreduce the evidence.\n\nAccording to our experience, it’s also hard to think about a ransomware modus operandi on\nmobile devices since most information stored is synced with cloud services and easily\nrecoverable. In fact, as confirmed by sanovek it started to design a ransomware capability in\nSOVA, but it was pointless for a banking trojan on mobile devices.\n\nFigure 17 - SOVA author explains his initial goal of a ransomware module\n\n## Noisy Logs\n\nAnother interesting characteristic of Nexus that strengthens the hypothesis of its\ndevelopment stage is the number of logging messages spread throughout the code. Those\nmessages are intended to track all actions performed, and some of them are paired with a\ndebugging string that contains the message “plz report this accident”.\n\nFigure 18 - Logging strings\nLogging messages are not limited to local devices. In fact, it was possible to discover that\nmost of the messages are also intended to be sent over the C2 communication channel. The\nmessage should follow this syntax: [ botId : Log Message]. However, at the time of writing,\ndue to the lack of references to the variable botID related to the logging class, this capability\nstill seems to be in the development phase.\n\n## C2 web panel\n\nOnce Nexus is installed on a victim's device, it connects to its C2 server. This server is used\nby TAs to remotely control the malware, issue commands, and receive stolen data.\n\n\n-----\n\nNexus provides a C2 web panel, which is an essential tool for cyber criminals who are using\nmalware or a botnet to carry out attacks. It provides a centralized interface for managing the\nmalware and the data it collects, making it easier for attackers to carry out their malicious\nactivities.\n\nTypically Nexus C2 web panels expose the login page on the Internet through port 80 or\n5000 as follows:\n\nFigure 19 - Management console: Home page\nThe string “Jojo no Kimyou na Bouken: Eyes of Heaven” references an action video game\nbased on the “Jo Jo's Bizarre Adventure” manga series by Hirohiko Araki, a Japanese\nmanga artist.\n\nOnce logged in, the panel offers the following features:\n\n**Dashboard: displays the status of the botnet, including the number of infected devices,**\ndata collected, and any recent activity.\n**Bots: a detailed list of the infected devices, locations, and other metrics.**\n**Data** **Collection: tools for collecting and analyzing data from infected devices. This**\nincludes login credentials, cookies, credit card details, and other sensitive information.\n**Injects: a comprehensive list of 450 banking application login pages for grabbing valid**\ncredentials.\n**Builder: interface for creating customized versions of Nexus, allowing TAs to**\ncustomize various aspects, such as the command-and-control server (C&C) address,\nthe icon and name of the app, and more.\n\n\n-----\n\nFigure 20 - Dashboard with detailed botnet information\n\nFigure 21 - Details of exfiltrated data (known as “logs”)\nAs the alleged author claimed on multiple hacking forums, the complete list of injections has\n450 different targets, which are searchable through the panel. They also offer the possibility\nto create custom injections.\n\n\n-----\n\nFigure 22 - Injection list\nPivoting C2 fingerprints through Internet search engines, such as Shodan, could provide\nexcellent information, and in this case, it confirms that the growing trend began in the very\nfirst of 2023 when Nexus was officially promoted on multiple hacking forums:\n\nFigure 23 - C2 fingerprinting over time (source: Shodan Trends)\n\n## Conclusion\n\nNexus is an emerging malware that allegedly has taken more than a few “ideas” from SOVA\n(a threat that hit the international landscape in the last year). According to the similarities\nobserved in the code, and the insights retrieved from underground forums, it is possible to\nconfirm that Nexus represents a new malware, guided by an entirely new group, which was\ncapable of retrieving parts of SOVA source code after they were stolen by an Android botnet\noperator called POISON.\n\n\n-----\n\nBy analyzing the latest retrieved samples, we can say that Nexus is still in an early stage of\ndevelopment, still including snippets of code that seem to belong to its ancestor.\n\nAs always, the main question here is: Does it represent a threat to Android users?\n\nAt the time of writing, the absence of a VNC module limits its action range and its\n**capabilities; however, according to the infection rate retrieved from multiple C2 panels,**\n**Nexus is a real threat that is capable of infecting hundreds of devices around the**\n**world. Because of that, we cannot exclude that it will be ready to take the stage in the next**\nfew months.\n\n‍\n\n**Appendix 1: IOCs**\n**‍**\n\n**IoC** **Description**\n\nd4c6871dbd078685cb138a499113d280 MD5 of Nexus\n\n193.42.32.]87 C2\n\n193.42.32.]84 C2\n\n‍\n\n**Meet the authors**\n\n[Francesco Iubatti - Mobile Malware Analyst & Threat Intelligence Analyst.](https://www.cleafy.com/authors/francesco-iubatti)\n\n[Federico Valentini - Head of Threat Intelligence and Incident Response.](https://www.cleafy.com/authors/federico-valentini)\n\n[Alessandro Strino - Malware Analyst.](https://www.cleafy.com/authors/alessandro-strino)\n\n‍\n\n**Meet the authors**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-21 - Nexus- a new Android botnet-.pdf"
    ],
    "report_names": [
        "2023-03-21 - Nexus- a new Android botnet-.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1680660536,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1680511703,
    "ts_modification_date": 1680511703,
    "files": {
        "pdf": "https://archive.orkl.eu/616f6943044d1d653138eb2c6434fb77360489c1.pdf",
        "text": "https://archive.orkl.eu/616f6943044d1d653138eb2c6434fb77360489c1.txt",
        "img": "https://archive.orkl.eu/616f6943044d1d653138eb2c6434fb77360489c1.jpg"
    }
}