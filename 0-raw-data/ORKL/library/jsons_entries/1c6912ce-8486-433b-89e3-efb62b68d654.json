{
    "id": "1c6912ce-8486-433b-89e3-efb62b68d654",
    "created_at": "2022-10-25T16:48:15.129905Z",
    "updated_at": "2025-03-27T02:12:54.778187Z",
    "deleted_at": null,
    "sha1_hash": "fc6943b4d2cf6cf18b6628685cacb72d9e3e09f6",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-11-25T19:26:49Z",
    "file_modification_date": "2019-11-27T10:06:24Z",
    "file_size": 2878404,
    "plain_text": "###### Simple Spyware Androids Invisible Foreground Services and How to (Ab)use Them\n\n December 2019\n\n\n-----\n\n###### Who am I\n\n Thomas Sutter\n\n → ZHAW: Research Assistant in Information Security @ Zurich University of Applied Sciences → Student: Master of Science in Engineering → Contact: suth@zhaw.ch or via Twitter @Me7e0r232\n\n\n-----\n\n###### Let’s start with the latest privacy changes\n\n\n-----\n\n###### Background\n Limitations\n\n\n###### Background Sensor Access\n\n\n###### Background Location Access\n\n\n###### 2018 2019 2017 2020\n\n\n###### Background\n\n\n-----\n\n### LIVE DEMO\n\n\n-----\n\n##### But that’s nothing new!\n So what’s new?\n\n\n-----\n\n-----\n\n###### How to run stuff in Background?\n\n\n-----\n\n###### Alarm Manager Job Scheduler\n\n Started by an app, but lives outside the app lifecycle.\n\n\n-----\n\n###### Code – Job Scheduler\n\n public void scheduleJob(){\n long interval = 1000 * 60L; ComponentName serviceComponent = new ComponentName(this, JobScheduler.class); JobInfo.Builder builder = new JobInfo.Builder( JOB_ID, serviceComponent); → builder.setPeriodic(interval) // Minimum is 15 minutes → builder.setOverrideDeadline(interval * 2);  // Sets the maximum scheduling latency → builder.setMinimumLatency(interval);     // Run after delay\n JobScheduler jobScheduler = this.getSystemService(JobScheduler.class); jobScheduler.schedule(builder.build());     // Schedule the job }\n\n\n-----\n\n###### JobInfo.builder\n\n → setPersisted(true); → setRequiredNetwork(NetworkRequest networkRequest) → setRequiredNetworkType(int networkType) → setRequiresBatteryNotLow(boolean batteryNotLow) → setRequiresCharging(boolean requiresCharging)\n\n\n-----\n\n###### Second step\n\n How to access the data?\n Foreground Service\n\n\n###### Second step\n\n How to access the data?\n\n\n-----\n\n###### Forground Services\n\n →Needs to show a sticky notification\n\n → Notification design is set by the app\n\n →Can be started from background job\n\n →Do not have sensor limitations\n\n →Has to be started within a 5 seconds\n\n\n-----\n\n-----\n\n###### How to get rid of the notification?\n\n We just don’t…\n\n\n-----\n\n###### Code – Foreground Service:\n\n @Override public int onStartCommand(Intent intent, int flags, int startId) {\n // ~4.9999.. seconds to call startForeground(...) Notification notification = createCustomNotification(); → this.startForeground(1, notification) // Sensor access not restricted anymore.\n accessCamera(); accessMicrophone(); // … some malicious code → stopForeground(true); //Stop the service before notification is loaded\n return START_STICKY; }\n\n\n-----\n\n###### Long Running Tasks\n\n →MediaPlayer API → Apps do not run recording in their own lifecycle context.\n\n\n-----\n\n###### Does this work on Android10 (Q)?\n\n\n-----\n\n###### New permission level: “Allow only while using the app”\n\n Let’s track from “background*”\n\n\n-----\n\n-----\n\n#### Conclusion\n\n###### It’s a bug… no, it’s a feature!\n\n\n-----\n\n###### Limitations\n\n Timing Access Visibility Permissions\n\n\n###### Visibility\n\n\n-----\n\n###### Mitigation\n\n → CVE-2019-2219 – Patch is coming soon\n\n → Probably hard to patch, since as you have seen it’s a kind of a design problem as well.\n\n → Security by visibility might not be a good idea?\n\n → Some vendors have permission minitors\n\n\n-----\n\n###### No Silver Bullet\n\n\n###### Secure Design &\n\n\n###### Permission\n\n\n###### Monitoring\n\n\n-----\n\n###### Takeaways\n\n Stop Apps Revoke Access\n\n\n-----\n\n###### Demo\n\n → Test: Test yourself! Don’t worry, it’s safe :-D\n\n → Code: https://github.com/7homasSutter/SimpleSpyware\n\n → APK: https://github.com/7homasSutter/SimpleSpyware/releases\n\n\n-----\n\n###### I hope you enjoyed this short talk…\n\n## Thank you!\n\n###### there is some more info in the appendix and the whitepaper\n\n\n-----\n\n# ? ?\n\n###### Contact: suth@zhaw.ch or via Twitter @Me7e0r232\n\n\n# ?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://i.blackhat.com/eu-19/Thursday/eu-19-Sutter-Simple-Spyware-Androids-Invisible-Foreground-Services-And-How-To-Abuse-Them.pdf"
    ],
    "report_names": [
        "eu-19-Sutter-Simple-Spyware-Androids-Invisible-Foreground-Services-And-How-To-Abuse-Them.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041574,
    "ts_creation_date": 1574710009,
    "ts_modification_date": 1574849184,
    "files": {
        "pdf": "https://archive.orkl.eu/fc6943b4d2cf6cf18b6628685cacb72d9e3e09f6.pdf",
        "text": "https://archive.orkl.eu/fc6943b4d2cf6cf18b6628685cacb72d9e3e09f6.txt",
        "img": "https://archive.orkl.eu/fc6943b4d2cf6cf18b6628685cacb72d9e3e09f6.jpg"
    }
}