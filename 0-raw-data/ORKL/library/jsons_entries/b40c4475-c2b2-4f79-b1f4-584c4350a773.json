{
    "id": "b40c4475-c2b2-4f79-b1f4-584c4350a773",
    "created_at": "2023-01-12T15:10:00.511671Z",
    "updated_at": "2025-03-27T02:16:34.830894Z",
    "deleted_at": null,
    "sha1_hash": "d65db6e8d6df376724615b892905be07a0766855",
    "title": "2015-07-22 - Duke APT group's latest tools- cloud services and Linux support",
    "authors": "",
    "file_creation_date": "2022-05-28T15:09:50Z",
    "file_modification_date": "2022-05-28T15:09:50Z",
    "file_size": 245494,
    "plain_text": "# January 2004 to September 2015\n\n**f-secure.com/weblog/archives/00002822.html**\n\n[<<<](https://www.f-secure.com/weblog/archives/00002821.html) NEWS FROM THE LAB - Wednesday, July 22, 2015 [>>>](https://www.f-secure.com/weblog/archives/00002823.html)\n\n**[ARCHIVES |](https://www.f-secure.com/weblog/archives/)** **[SEARCH](https://www.bing.com/search?q=site:f-secure.com/weblog)**\n\n\n**Duke APT group's latest tools: cloud services and**\n**Linux support**\n\n\nPosted by Artturi @ 11:59\nGMT\n\n\nRecent weeks have seen the outing of two new additions to the Duke group's toolset,\nSeaDuke and CloudDuke. Of these, SeaDuke is a simple trojan made interesting by the\nfact that it's written in Python. And even more curiously, SeaDuke, with its built-in\nsupport for both Windows and Linux, is the first cross-platform malware we have\nobserved from the Duke group. While SeaDuke is a single - albeit cross-platform - trojan,\nCloudDuke appears to be an entire toolset of malware components, or \"solutions\" as the\nDuke group apparently calls them. These components include a unique loader,\ndownloader, and not one but two different trojan components. CloudDuke also greatly\nexpands on the Duke group's usage of cloud storage services, specifically Microsoft's\nOneDrive, as a channel for both command and control as well as the exfiltration of stolen\ndata. Finally, some of the recent CloudDuke spear-phishing campaigns have born a\nstriking resemblance to CozyDuke spear-phishing campaigns from a year ago.\n\nLinux support added with the cross-platform SeaDuke malware\n\n[Last week, both Symantec and](http://www.symantec.com/connect/blogs/forkmeiamfamous-seaduke-latest-weapon-duke-armory) [Palo Alto Networks published research on SeaDuke, a](http://researchcenter.paloaltonetworks.com/2015/07/unit-42-technical-analysis-seaduke/)\nnewer addition to the arsenal of trojans being used by the Duke group. While older\nmalware by the Duke group has always been written with a combination of the C and\nC++ programming languages as well as assembly language, SeaDuke is peculiarly\nwritten in Python with multiple layers of obfuscation. This Python code is usually then\ncompiled into Windows executables using py2exe or pyinstaller. However, the Python\n\n\n-----\n\ncode itself has been designed to work on both Windows and Linux. We therefore\nsuspect, that the Duke group is also using the same SeaDuke Python code to target\nLinux victims. This is the first time we have seen the Duke group employ malware to\ntarget Linux platforms.\n\nAn example of the cross-platform support found in SeaDuke.\n\nA new set of solutions with the CloudDuke malware toolset\n\n[Last week, we also saw Palo Alto Networks and](http://researchcenter.paloaltonetworks.com/2015/07/tracking-minidionis-cozycars-new-ride-is-related-to-seaduke/) [Kaspersky Labs publish research on](https://securelist.com/blog/research/71443/minidionis-one-more-apt-with-a-usage-of-cloud-drives/)\nmalware components they respectively called MiniDionis and CloudLook. MiniDionis and\nCloudLook are both components of a larger malware toolset we call CloudDuke. This\ntoolset consists of malware components that provide varying functionality while partially\nrelying on a shared code framework and always using the same loader. Based on PDB\nstrings found in the samples, the malware authors refer to the CloudDuke components\nas \"solutions\" with names such as \"DropperSolution\", \"BastionSolution\" and\n\"OneDriveSolution\". A list of PDB strings we have observed is below:\n\nC:\\DropperSolution\\Droppers\\Projects\\Drop_v2\\Release\\Drop_v2.pdb�\nc:\\BastionSolution\\Shells\\Projects\\miniDionis4\\miniDionis\\obj\\Release\\miniDionis.pdb�\nc:\\BastionSolution\\Shells\\Projects\\miniDionis2\\miniDionis\\obj\\Release\\miniDionis.pdb�\n�\nc:\\OneDriveSolution\\Shells\\Projects\\OneDrive2\\OneDrive\\obj\\x64\\Release\\OneDrive.pdb\n\nThe first of the CloudDuke components we have observed is a downloader internally\ncalled \"DropperSolution\". The purpose of the downloader is to download and execute\nadditional malware on the victim's system. In most observed cases, the downloader will\nattempt to connect to a compromised website to download an encrypted malicious\npayload which the downloader will decrypt and execute. Depending on the way the\ndownloader has been configured, in some cases it may first attempt to log in to\nMicrosoft's cloud storage service OneDrive and retrieve the payload from there. If no\npayload is available from OneDrive, the downloader will revert to the previously\nmentioned method of downloading from compromised websites.\n\nWe have also observed two distinct trojan components in the CloudDuke toolset. The\nfirst of these, internally called \"BastionSolution\", is the trojan that Palo Alto Networks\ndescribed in their research into \"MiniDionis\". Interestingly, BastionSolution appears to\nfunctionally be an exact copy of SeaDuke with the only real difference being the choice\nof programming language. BastionSolution also makes significant use of a code\nframework that is apparently internally called \"Z\". This framework provides classes for\nfunctionality such as encryption, compression, randomization and network\ncommunications.\n\n\n-----\n\nA list of classes in the BastionSolution trojan, including multiple classes from the \"Z\"\nframework.\n\nClasses from the same \"Z\" framework, such as the encryption and randomization\nclasses, are also used by the second trojan component of the CloudDuke toolset. This\nsecond component, internally called \"OneDriveSolution\", is especially interesting\nbecause it relies on Microsoft's cloud storage service OneDrive as its command and\ncontrol channel. To achieve this, OneDriveSolution will attempt to log into OneDrive with\na preconfigured username and password. If successful, OneDriveSolution will then\nproceed to copy data from the victim's computer to the OneDrive account. It will also\nsearch the OneDrive account for files containing commands for the malware to execute.\n\nA list of classes in the OneDriveSolution trojan, including multiple classes from the \"Z\"\nframework.\n\nAll of the CloudDuke \"solutions\" use the same loader, a piece of code whose primary\npurpose is to decrypt the embedded, encrypted solution, load it in memory and execute\nit. The Duke group has often employed loaders for their malware but unlike the previous\nloaders they have used, the CloudDuke loader is much more versatile with support for\nmultiple methods of loading and executing the final payload as well as the ability to write\nto disk and execute additional malware components.\n\nCloudDuke spear-phishing campaigns and similarities with CozyDuke\n\n\n-----\n\nCloudDuke has recently been spread via spear phishing emails with targets reportedly\nincluding organizations such as the US Department of Defense. These spear-phising\nemails have contained links to compromised websites hosting zip archives that contain\nCloudDuke-laden executables. In most cases, executing these executables will have\nresulted in two additional files being written to the victim's hard disk. The first of these\nfiles has been a decoy, such as an audio file or a PDF file while the second one has\nbeen a CloudDuke loader embedding a CloudDuke downloader, the so-called\n\"DropperSolution\". In these cases, the victim has been presented with the decoy file\nwhile in the background the downloader has proceeded to download and execute one of\nthe CloudDuke trojans, \"OneDriveSolution\" or \"BastionSolution\".\n\nExample of one of the decoy documents employed in the CloudDuke spear-phishing\n[campaigns. It has apparently been copied by the attackers from here.](https://www.ndi.org/files/NDI%20Georgia_April%202015%20Poll_Public%20Issues_ENG_VF_0.pdf)\n\nInterestingly, however, some of the other CloudDuke spear-phishing campaigns we have\nobserved this July have born a striking resemblance to CozyDuke spear-phishing\ncampaigns seen almost exactly a year ago, in the beginning of July 2014. In both spearphishing campaigns, the decoy document has been the exact same PDF file, a \"US\nletter fax test page\" (28d29c702fdf3c16f27b33f3e32687dd82185e8b). Similarly, the\nURLs hosting the malicious files have, in both campaigns, purported to be related to\neFaxes. It is also interesting to note, that in the case of the CozyDuke-inspired\nCloudDuke spear-phishing campaign, the downloading and execution of the malicious\narchive linked to in the emails has not resulted in the execution of the CloudDuke\ndownloader but in the execution of the \"BastionSolution\" component thereby skipping\none step from the process described for the other CloudDuke spear-phishing\ncampaigns.\n\n\n-----\n\nThe \"US letter fax test page\" decoy employed in both CloudDuke and CozyDuke spearphishing campaigns.\n\nIncreasingly using cloud services to evade detection\n\nCloudDuke is not the first time we have observed the Duke group use cloud services in\ngeneral and Microsoft OneDrive specifically as part of their operations. Earlier this spring\n[we released research on CozyDuke where we mentioned observing CozyDuke](https://www.f-secure.com/documents/996508/1030745/CozyDuke)\nsometimes either directly use a OneDrive account to exfiltrate stolen data or alternatively\n\n\n-----\n\nCozyDuke downloading Visual Basic scripts that would copy stolen files to a OneDrive\naccount and sometimes even retrieve files containing additional commands from the\nsame OneDrive account.\n\nIn these previous cases the Duke group has only used OneDrive as a secondary\ncommunication channel but still relied on more traditional C&C channels for most of their\nactions. It is therefore interesting to note that CloudDuke actually enables the Duke\ngroup to rely solely on OneDrive for every step of their operation from downloading the\nactual trojan, passing commands to the trojan and finally exfiltrating stolen data.\n\nBy relying solely on 3rd party web services, such as OneDrive, as their command and\ncontrol channel, we believe the Duke group is trying to better evade detection. Large\namounts of data being transferred from an organization's network to an unknown web\nserver easily raises suspicions. However, data being transferred to a popular cloud\nstorage service is normal. What better way for an attacker to surreptitiously transfer\nlarge amounts of stolen data than the same way people are transferring that same data\nevery day for legitimate reasons. (Coincidentally, the implications of 3rd party web\nservices being used as command and control channels is also the subject of an\nupcoming talk at the VirusBulletin 2015 conference).\n\nDirecting limited resources towards evading detection and staying ahead of defenders\n\nDeveloping even a single multipurpose malware toolset, never mind many, requires time\nand resources. Therefore it seems logical to attempt to reuse code such as supporting\nframeworks between different toolsets. The Duke group, however, appear to have taken\nthis a step further with SeaDuke and the CloudDuke component BastionSolution, by\nrewriting the same code in multiple programming languages. This has the obvious\nbenefits of saving time and resources by providing two malware toolsets, that while\nsimilar on the inside, appear completely different on the outside. This way, the discovery\nof one toolset does not immediately lead to the discovery of the second toolset.\n\nThe Duke group, long suspected of ties to the Russian state, have been running their\nespionage operation for an unusually long time and - especially lately - with unusual\nbrazenness. These latest CloudDuke and SeaDuke campaigns appear to be a clear sign\nthat the Duke's are not planning to stop any time soon.\n\n[Research and post by Artturi (@lehtior2)](https://twitter.com/lehtior2)\n\nF-Secure detects CloudDuke as Trojan:W32/CloudDuke.B and\nTrojan:W64/CloudDuke.B\n\nSamples:\n\n04299c0b549d4a46154e0a754dda2bc9e43dff76\n2f53bfcd2016d506674d0a05852318f9e8188ee1\n317bde14307d8777d613280546f47dd0ce54f95b\n476099ea132bf16fa96a5f618cb44f87446e3b02\n4800d67ea326e6d037198abd3d95f4ed59449313\n52d44e936388b77a0afdb21b099cf83ed6cbaa6f\n6a3c2ad9919ad09ef6cdffc80940286814a0aa2c\n78fbdfa6ba2b1e3c8537be48d9efc0c47f417f3c\n9f5b46ee0591d3f942ccaa9c950a8bff94aa7a0f\nbfe26837da22f21451f0416aa9d241f98ff1c0f8\n\n\n-----\n\nc16529dbc2987be3ac628b9b413106e5749999ed\ncc15924d37e36060faa405e5fa8f6ca15a3cace2\ndea6e89e36cf5a4a216e324983cc0b8f6c58eaa8\ne33e6346da14931735e73f544949a57377c6b4a0\ned0cf362c0a9de96ce49c841aa55997b4777b326\nf54f4e46f5f933a96650ca5123a4c41e115a9f61\nf97c5e8d018207b1d546501fe2036adfbf774cfd\n\nCompromised servers used for command and control:\n\nhxxps://cognimuse.cs.ntua.gr/search.php\nhxxps://portal.sbn.co.th/rss.php\nhxxps://97.75.120.45/news/archive.php\nhxxps://portal.sbn.co.th/rss.php\nhxxps://58.80.109.59/plugins/search.php\n\nCompromised websites used to host CloudDuke:\n\nhxxp://flockfilmseries.com/eFax/incoming/5442.ZIP\nhxxp://www.recordsmanagementservices.com/eFax/incoming/150721/5442.ZIP\nhxxp://files.counseling.org/eFax/incoming/150721/5442.ZIP\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-07-22 - Duke APT group's latest tools- cloud services and Linux support.pdf"
    ],
    "report_names": [
        "2015-07-22 - Duke APT group's latest tools- cloud services and Linux support.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6c4e4b91-1f98-49e2-90e6-435cea8d3d53",
            "created_at": "2022-10-25T16:07:23.693797Z",
            "updated_at": "2025-03-27T02:02:09.924056Z",
            "deleted_at": null,
            "main_name": "Gorgon Group",
            "aliases": [
                "ATK 92",
                "Pasty Draco",
                "Subaat",
                "TAG-CR5"
            ],
            "source_name": "ETDA:Gorgon Group",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "Atros2.CKPN",
                "Bladabindi",
                "CinaRAT",
                "Crimson RAT",
                "ForeIT",
                "Jorik",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "MSIL",
                "MSIL/Crimson",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Negasteal",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Origin Logger",
                "Quasar RAT",
                "QuasarRAT",
                "Recam",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "SEEDOOR",
                "Scarimson",
                "Socmer",
                "Yggdrasil",
                "ZPAQ",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "18278778-fa63-4a9a-8988-4d266b8c5c1a",
            "created_at": "2023-01-06T13:46:38.769816Z",
            "updated_at": "2025-03-27T02:00:02.914024Z",
            "deleted_at": null,
            "main_name": "The Gorgon Group",
            "aliases": [
                "ATK92",
                "G0078",
                "Pasty Gemini",
                "Gorgon Group",
                "Subaat"
            ],
            "source_name": "MISPGALAXY:The Gorgon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536200,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1653750590,
    "ts_modification_date": 1653750590,
    "files": {
        "pdf": "https://archive.orkl.eu/d65db6e8d6df376724615b892905be07a0766855.pdf",
        "text": "https://archive.orkl.eu/d65db6e8d6df376724615b892905be07a0766855.txt",
        "img": "https://archive.orkl.eu/d65db6e8d6df376724615b892905be07a0766855.jpg"
    }
}