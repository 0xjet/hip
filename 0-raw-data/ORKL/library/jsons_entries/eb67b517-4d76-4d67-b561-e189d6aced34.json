{
    "id": "eb67b517-4d76-4d67-b561-e189d6aced34",
    "created_at": "2023-01-12T15:04:35.419356Z",
    "updated_at": "2025-03-27T02:05:26.506694Z",
    "deleted_at": null,
    "sha1_hash": "fb98069f95e7a6d3d4badc037a32b3458b9c6e9e",
    "title": "2021-03-18 - Buer Loader Found in an Unusual Email Attachment",
    "authors": "",
    "file_creation_date": "2022-05-28T04:59:35Z",
    "file_modification_date": "2022-05-28T04:59:35Z",
    "file_size": 1694117,
    "plain_text": "# Buer Loader Found in an Unusual Email Attachment\n\n**labs.vipre.com/buer-loader-found-in-an-unusual-email-attachment/**\n\nPosted by VIPRE Labs\n\nThe COVID-19 pandemic has resulted in people ramping up online activities working from home, online shopping and relying more on online\nservices. Recently, we came across a spam email lurking in the wild. This spam email is disguised as a known logistics company and has an\nunusual attachment. Malicious attackers trick the victim into believing that the email is legitimate by using a legitimate domain in the sender’s\nemail address. The content is also properly constructed and also uses a known logo making it difficult to spot that it is a malicious email.\n\n_Figure 1.0 Spam email with .jnlp attachment_\n\nAs threats become more prominent, we should always be cautious. These are some indicators that will show that this email is suspicious and\nnot legitimate:\n\n_Figure 2.0 The email header_\n\nChecking the email header, we can see that the “received from” which is in the green box in Figure 2.0, didn’t match with the “from” field\n(the visible sender of the email). The “received from” data is the most reliable and it is where we can see the real sender of the email.\nUpon researching, the domain in the “received from” header is not related to DHL. With this, the email header is forged.\n\n\n-----\n\ndd t o a c ec e s t e ece ed S so t a t says t at t e do a o CO does ot des g ate 5 88 05 9 as pe tted\nsender”. Upon checking, the IP address 45.88.105.192 in the “received from” is not also related to DHL.\nThe attachment of the email is a .jnlp file is a Java Network Launch Protocol which is an unusual attachment for an email.\n\n**Analyzing the attachment**\n\nWe will now proceed on the analysis of the jnlp file attachment that has a filename “invoice.jnlp”. We said earlier that .jnlp stands for Java\nNetwork Launch Protocol, that’s used for launching java applications from a hosted web server on a remote desktop client. Checking the jnlp\nfile, we can see that the file will download invoice.jar from a web server hxxp://invoicesecure[.]net/documents when executed.\n\n_Figure 3.0 The jnlp file_\n\nThe downloaded file is an invoice.jar file which is a Java Archive file. When we tried to launch the file it will show this output:\n\n_Figure 4.0 The error message upon launching invoice.jar_\n\nWith this message, the victim will think that it was an error and will ignore the file. But upon analyzing the invoice.jar, we found out that this\nmessage is just a decoy. The attackers just made this technique to trick their victims and make the malware run without suspicion. Based on its\ncode after showing an error message, it will start to read the data from “hxxp://invoicesecure[.]net/img/footer[.]jpg” and saved it as\n“C:\\\\ProgramData\\\\drvr32.exe”. Then use Desktop.getDesktop().open() to open drvr32.exe.\n\n\n-----\n\n_gu e 5 0_ _e deco_ _p ed_ _o ce ja_\n\n_Figure 6.0 The HTTP GET Request once invoice.jar was executed_\n\n**The Buer Loader**\n\nThe malicious downloaded file was named “drvr32.exe” and disguised as a legitimate xls viewer application:\n\n_Figure 7.0 Disguising as a legitimate file_\n\nThis file was identified as a type of a malware loader known as Buer Loader. This loader was first seen in 2019 and commonly distributed\nthrough malicious spam email campaigns.\n\n_Figure 8.0 The buer loader_\n\nWhen executed, it will first create its installation folder “zsadsadsad” at the Startup folder and create a copy of itself in %AppData%. The\ncreated folder “zsadsadsad” contains LNK shortcut file. We decoded the LNK file to analyze all the available information it contains and we\nfound out that it will link to the created copy.\n\n_Figure 9.0 The installation folder “zsadsadsad” and the lnk shortcut file_\n\n\n-----\n\n_Figure 10.0 The decoded information of LNK file linking to the created copy_\n\nThroughout our analysis, we found out that this loader has an anti-analysis. It will check if the following DLLs are existing in the place where\nthe malware is running:\n\n_Figure 11.0 The DLLs to check_\n\nAs per checking, some of the checked DLLs above are related to anti-virus and debuggers.\n\nThen, it will call functions like GetCurrentHwProfileA, GetComputerNameW, and GetVolumeInformation to collect the information of the\ninfected machine. The collected information will be combined in an allocated memory and will be formatted using wsprintfw function.\n\n_Figure 12.0 Routine for formatting the collected information_\n\n\n-----\n\n_Figure 13.0 The formatted string of victim’s machine information_\n\nAfter this, it will call other functions to retrieve more information of the infected machine and to use these information for the malware’s next\nactions:\n\nRtlGetVersion\nGetNativeSystemInfo\nGetComputerNameW\nGetDriveTypeA\nGetDiskFreeSpaceExA\nGetUserNameW\nNetWkstaGetInfo\n\nAll of the other retrieved information will be combined to the formatted string above and the output is this:\n\n**cb9f1daacc0545c0e5bf0c67ead614d24884570889cf7435572fa55e134b1012|bc31re1bs5a8d1fc4ddb3cc4b75594c31b8c00de3fdfa31fgg1ad1**\n**7|x32|1|User|WIN-SPF5F5SH244|14/59|WORKGROUP|test|0**\n\nThen, this output will be formatted again using wsprintfw function and the result is this:\n\n_Figure 14.0 The 2nd round formatting of string of the victim’s machine information_\n\nAfter retrieving and formatting the needed information of the victim’s machine, Buer Loader will make it to a base64 string:\n\n\n-----\n\n_Figure 15.0 Converting to base64 string_\n\nDigging deeper into our analysis, we encountered InternetOpenA function to initialize a use of the WinINet functions. Then, it will try to open an\nhttp session to “verstudiosan[.]com” using InternetConnectW function.\n\n_Figure 16.0 Opens an HTTP session_\n\nIt has GET method to download additional malware and POST method to send the collected victim’s machine information to the server:\n\n_Figure 17.0 HTTP POST Request method_\n\n_Figure 18.0 Sending the specified request_\n\nWe searched the domain and found out that this domain was just recently created. We also learned that this domain is no longer reachable\nand possibly just used for malicious activity.\n\n_Figure 19.0 The recently created domain_\n\n\n-----\n\n_Figure 20.0 Unreachable server_\n\n## Attack Flow\n\nVIPRE detects and prevents this kind of malware and associated infections.\n\n### IOCs:\n\nThe Spam Email\n\n66f13fa2c9e34705bbbc4645462188ca57c0fdc3a17418c96c0ed9371055f3bc\nJNLP File\n\n368b409080e9389b342e33a014cd7daf3fd984fdc2b0e5ecc8ac4d180759a1c4\nJar File\n\n064fe7ef429f373d38813a05c9d2286a86337c1fc1b12c740b729f1f76de1811\nPE File\n\ndbdc38dee1c9c9861a36cf6462dca55dcef6c1f128b2270efd99d4347568292c\nMalicious website\n\nverstudiosan[.]com\nhxxp://invoicesecure[.]net/documents\n\nAnalysis by #Farrallel\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-18 - Buer Loader Found in an Unusual Email Attachment.pdf"
    ],
    "report_names": [
        "2021-03-18 - Buer Loader Found in an Unusual Email Attachment.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535875,
    "ts_updated_at": 1743041126,
    "ts_creation_date": 1653713975,
    "ts_modification_date": 1653713975,
    "files": {
        "pdf": "https://archive.orkl.eu/fb98069f95e7a6d3d4badc037a32b3458b9c6e9e.pdf",
        "text": "https://archive.orkl.eu/fb98069f95e7a6d3d4badc037a32b3458b9c6e9e.txt",
        "img": "https://archive.orkl.eu/fb98069f95e7a6d3d4badc037a32b3458b9c6e9e.jpg"
    }
}