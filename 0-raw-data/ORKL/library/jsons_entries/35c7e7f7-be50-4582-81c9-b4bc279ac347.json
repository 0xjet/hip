{
    "id": "35c7e7f7-be50-4582-81c9-b4bc279ac347",
    "created_at": "2022-10-25T16:48:19.442164Z",
    "updated_at": "2025-03-27T02:13:09.670776Z",
    "deleted_at": null,
    "sha1_hash": "edb93a3ba0243acaaff29dc0534fcd8c51485210",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-08-16T02:12:07Z",
    "file_modification_date": "2019-08-16T02:12:07Z",
    "file_size": 608377,
    "plain_text": "# Inception Attackers Target Europe with Year-old Office Vulnerability\n\n**[unit42.paloaltonetworks.com/unit42-inception-attackers-target-europe-year-old-office-vulnerability](https://unit42.paloaltonetworks.com/unit42-inception-attackers-target-europe-year-old-office-vulnerability/)**\n\nBy Tom Lancaster November 5, 2018\n\nThe Inception attackers have been active since at least 2014 and have been documented\npreviously by both [Blue Coat and](https://www.symantec.com/connect/blogs/blue-coat-exposes-inception-framework-very-sophisticated-layered-malware-attack-targeted-milit) [Symantec; historical attacks used custom malware for a variety](https://www.symantec.com/blogs/threat-intelligence/inception-framework-hiding-behind-proxies)\nof platforms, and targeting a range of industries, primarily in Russia, but also around the world.\nThis blog describes attacks against European targets observed in October 2018, using CVE2017-11882 and a new PowerShell backdoor we’re calling POWERSHOWER due to the attention\nto detail in terms of cleaning up after itself, along with the malware being written in PowerShell.\n\nUnit 42 has previously observed attacks from the group in 2017 against government targets in\nEurope, Russia, and Central Asia and expects these to remain the primary regions this threat is\nseen.\n\nIn the last writeup by Symantec they describe a two-stage spear phishing process used by the\nInception attackers, whereby the attackers first send a reconnaissance spear phish, and follow\nthis up with a second spear phish containing a remote template, which if loaded delivers a first\nstage payload.\n\nIn their most recent attacks it appears that only one document is used, but in a way that allows\nthem to not reveal their final payload immediately; however, the use of templates remains the\nsame.\n\nRemote Templates are Great\n\n[Remote templates are a feature of Microsoft Word which allow a document to load a template to](https://docs.microsoft.com/en-us/dotnet/api/documentformat.openxml.wordprocessing.attachedtemplate?view=openxml-2.8.1)\nbe used in a document – this template can be externally hosted, either on a file share, or on the\ninternet. The template is then loaded when the document is opened. The Inception attackers use\nthis feature in a malicious context as shown in Figure 1 below:\n\n\n-----\n\n_Figure 1. Overview of how the attack takes place._\n\nUsing a remote template in this way has been a consistent feature of the Inception attackers’\nattacks for the past 4 years and has three main benefits to the attacker:\n\n1. The initial document does not contain any explicitly malicious object, it simply references an\n\nexternal object, meaning it should bypass static analysis techniques, an example of how\nthis appears in the document is shown in Figure 2.\n2. The attacker has the option to deploy malicious content to the victim based upon initial data\n\nreceived from the target, such as Microsoft Word version (sent in the User-Agent) and the\nIP address of the target, see: Figure 1.\n3. Once the attack is over, and the server hosting the remote template is down, it is difficult for\n\nresearchers to analyze the attack as the remote content is unlikely to be available to them.\n\n_Figure 2. Example of how remote templates are referenced in Inception documents._\n\nWhen opened, the documents display decoy content and attempts to fetch a malicious remote\npayload via HTTP. The decoy content is usually copied from media reports, often with political\nthemes in the target regions, some examples of decoys observed are shown in Figure 3,\nincluding invites to international conferences and news articles on the current situation in Crimea.\n\n\n-----\n\n_Figure 3. Examples of decoys shown in Inception attacks in 2018. The first is taken from a_\n_[VGOPAD invitation sent on Facebook in 2017, the second is from a](https://www.facebook.com/jltgroup/posts/dear-colleague-on-behalf-of-volunteer-group-on-peace-and-development-i-am-please/1855877617760413/)_ _European Policy center_\n_summary._\n\nOn most occasions the remote server did not return a malicious template, however we recently\nobserved two cases where a malicious template containing two exploits was served. In both\ncases the template contained exploits for both [CVE-2012-1856 and](https://blog.ropchain.com/2015/07/27/analyzing-vupens-cve-2012-1856/) [CVE-2017-11882, which](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882)\ntarget vulnerabilities in Word disclosed and patched in 2012 and 2017 respectively.\n\nThe payload for the exploits was VBScript in an OLE package object, which in turn decodes and\nexecutes POWERSHOWER, a simple PowerShell backdoor.\n\nPOWERSHOWER – Malware that Cleans up After Itself\n\nEarlier, we mentioned that previous attacks were apparently delivered over two spear phishing\nemails, with the first only being used for reconnaissance. In the latest cases we only observed a\nsingle document being sent to the targets, with reconnaissance, exploitation, and payload delivery\nhappening on the first attempt.\n\nThe dropped payload, POWERSHOWER, acts as an initial reconnaissance foothold and is almost\ncertainly used to download and execute a secondary payload with a more complete set of\nfeatures. By only using this simple backdoor to establish a foothold, the attacker can hold back\ntheir most sophisticated and complex malware for later stages, making them less likely to be\ndetected.\n\nIn a nutshell, POWERSHOWER allows the attacker to:\n\nFingerprint the machine, and upload this information to the initial C&C.\nClean up a significant amount of forensic evidence from the dropper process, as we detail\nbelow.\n\n\n-----\n\nPOWERSHOWER first checks if Microsoft Word is currently running, if it is, then the malware\nassumes it is the first run through of the malware and performs the following operations:\n\n1. Writes itself to %AppData%\\Microsoft\\Word\\log.ps1\n2. Sets up persistence for this file, using a run key.\n3. Adds a registry key so that future powershell.exe instances are spawned off-screen by\n\ndefault – this trick is explained [here.](https://cantoriscomputing.wordpress.com/2016/07/22/powershell-malware/)\n4. Kills the Microsoft Word process.\n5. Removes all files created during the dropper process, including evidence the original\n\ndocument was opened, the initial .VBS file, and all temporary files associated with the\nretrieval of the remote template in the IE temporary files directory.\n6. Removes all registry entries that are left behind during the dropper process.\n7. Collects system information on the infected machine and POSTS it to the C2.\n\nIf Microsoft Word is not running, the malware enters its main communications loop, performing\nthe following actions in sequence, this loop should only be entered after a reboot of the machine:\n\n1. Collects system information and POSTs it to the C2.\n2. Performs a GET request\n3. Based on the status code of the GET request it will branch operations:\n\nIf the status code is not 200, the malware sleeps for a random amount of time\nbetween approximately 25 minutes and 35 minutes, based on a randomly generated\nnumber.\nIf the status code is 200 the malware expects the response to:\n\nBegin with an “P”; in which case the malware writes the response to disk,\npresumably to be executed or used in a subsequent command.\nBegin with an “O”; in which case the malware assumes the response contains\nVBS code which is saved to disk, then executed.\nIf not beginning with either these characters, it is assumed to be an XML file\ncontaining PowerShell expression, which is written to disk, read into memory,\ndeleted, and then executed.\n\nThe code behind the main C&C loop is shown in Figure 4.\n\n\n-----\n\nAlthough the malware is simple, it s fairly effective, giving the attacker options on how to run their\nnext, more sophisticated, payload.\n\nConclusion\n\nThe Inception attacks continue to mostly stay under the radar, which in part is down to the effort\nput in by the attackers to make their attacks harder to analyze. In the latest wave of attacks,\nthey’ve done this through:\n\nUse of remote templates, hindering analysis of historical attacks.\nAnti-forensics techniques used during the dropper process to prevent clues as to how the\nmalware was installed – being left on disk or in the registry.\nUse of the new basic POWERSHOWER backdoor as a first stage, making it harder for\nresearchers to get copies of more sophisticated payloads used by the attackers.\n\nPalo Alto Networks customers are protected from this threat in the following ways:\n\nWildfire detects all current Inception remote template documents, and the downloaded\nCVE-2017-11882 RTFs with malware verdicts.\nAutoFocus customers can track associated samples with the [InceptionRemoteTemplate](https://autofocus.paloaltonetworks.com/#/tag/Unit42.InceptionRemoteTemplate)\nand [PowerShower](https://autofocus.paloaltonetworks.com/#/tag/Unit42.POWERSHOWER)\nTraps blocks all of the files we are aware of that are associated with this campaign.\n\nIndicators of Compromise\n\n**Remote Template Documents where we have the matching payload**\n\n13de9678279b6ce6d81aeb32c0dd9f7458ad1f92aee17f3e052be9f06d473bed\n\nd547773733abef19f2720d4def2356d62a532f64bcb002fb2b799e9ae39f805f\n\n**Remote templates analyzed.**\n\n687ee860fd5cd9902b441c26d72788d5a52052d03047a9b071808fc4c53a7e8b\n\n72eb022f395cc15bbe9582ee02f977ea0692932461a8b0bd608d9f0971125999\n\n**PowerShower sample**\n\n8aef4975d9c51821c4fa8ee1cbfe9c1f4a88c8784427d467ea99b2c1dabe15ae\n\n**Other related templates and exploit documents from 2018**\n\n49dbcf1fc8d3381e495089f396727a959885c1dd2ab6cd202cf3c4dbd1d27c4f\n\n8b212ee2d65c4da033c39aebaf59cc51ade45f32f4d91d1daa0bd367889f934d\n\ncc64a68ba52283f6cf5521cf75567b3c5b5143f324d37c59906ee63f1bbafcaf\n\n2bcb8a4ddc2150b25a44c292db870124c65687444f96e078f575da69bbf018e0\n\n**Infrastructure**\n\n\n-----\n\n13 August 2018th 188.165.62[.]40 Remote template host\n\n\n10 October 2018th 200.122.128[.]208 POWERSHOWER C2\n\n22nd October 2018 108.170.52[.]158 Remote template host\n\n_Table 1 – IP Addresses associated with Inception Remote Template documents_\n\n## Get updates from Palo Alto Networks!\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.11.05.Inception_Attackers_Target_Europe/Inception%20Attackers%20Target%20Europe%20with%20Year-old%20Office%20Vulnerability.pdf"
    ],
    "report_names": [
        "Inception Attackers Target Europe with Year-old Office Vulnerability"
    ],
    "threat_actors": [
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04a7ebaa-ebb1-4971-b513-a0c86886d932",
            "created_at": "2023-01-06T13:46:38.784965Z",
            "updated_at": "2025-03-27T02:00:02.91817Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "G0100"
            ],
            "source_name": "MISPGALAXY:Inception Framework",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041589,
    "ts_creation_date": 1565921527,
    "ts_modification_date": 1565921527,
    "files": {
        "pdf": "https://archive.orkl.eu/edb93a3ba0243acaaff29dc0534fcd8c51485210.pdf",
        "text": "https://archive.orkl.eu/edb93a3ba0243acaaff29dc0534fcd8c51485210.txt",
        "img": "https://archive.orkl.eu/edb93a3ba0243acaaff29dc0534fcd8c51485210.jpg"
    }
}