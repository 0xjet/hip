{
    "id": "f269122a-e468-4ea7-90bf-0f59c0fad555",
    "created_at": "2022-10-25T16:48:18.525452Z",
    "updated_at": "2025-03-27T02:05:23.339004Z",
    "deleted_at": null,
    "sha1_hash": "b6217ea7fe6b4dd5e27b2a1b4b84432db2e1b2f3",
    "title": "Operation Red October",
    "authors": "McAfee",
    "file_creation_date": "2013-01-18T08:54:20Z",
    "file_modification_date": "2013-01-18T08:55:11Z",
    "file_size": 984162,
    "plain_text": "-----\n\nThe following picture clearly shows how the targeted attack happens in the Red October Campaign.\n\n\n#### Microsoft Document Exploitation (CVE-2012-0158, CVE-2010-3333, CVE-2009-3129):\n\nThe phishing email contains an attachment with the malicious office document. This file, when opened, exploits\none of the above mentioned vulnerabilities and drops the payload file “msmx21.exe”.\n\n#### Payload Information:\n\nAfter successful exploitation of the vulnerability, the embedded executable file (msmx21.exe) is dropped in the\n%temp% folder.\n\nmsmx21.exe creates and executes the following files:\n\n%Temp%\\msc.bat\n%ProgramFiles%\\Windows NT\\svchost.exe\n%ProgramFiles%\\Windows NT\\wsdktr.ltp (Encrypted payload) -> random name\n\n\n-----\n\nThe use of “chcp 1251” in the batch file is to switch the codepage of an infected system to handle Cyrillic\ncharacters. This might suggest that either the attack originates from Russia or was also targeted towards\ngovernment agencies in Russia.\n\nSvchost.exe is an installer component that decrypts and loads the main backdoor (wsdktr.ltp). It connects to the\nfollowing Microsoft hosts to check for a live Internet connection:\n\nupdate.microsoft.com\nwww.microsoft.com\nsupport.microsoft.com\n\nwsdktr.ltp is an encrypted executable file (UPX packed dll) that is decrypted and loaded into memory by\nsvchost.exe.\n\n\nThe use of “chcp 1251” in the batch file is to switch the codepage of an infected system to handle\n\n\nEncrypted wsdktr.ltp file:\n\n\nDecrypted file:\n\n\n-----\n\nin the following image.\n\nThe following domains are used for C&C :\n\nnt-windows-online.com\nnt-windows-update.com\nnt-windows-check.com\ncsrss-check-new.com\n\n#### Exploitation Using Java (CVE-2011-3544):\n\nIn Java Rhino Script Engine Vulnerability, security manager is disabled during JavaScript execution, which would\nenable full permission to the system during its execution. When the user clicks the link that came through the\nspam mail, the exploit would be triggered on the vulnerable system.\n\nThe downloaded payload creates and executes the following files:\n\n%Temp%\\ tmp42e76b5f.bat -> random name\n%Application Data%\\Keucot\\ qagi.exe -> random name\n%Application Data%\\ Okurp \\ dezaa.ufy-> random name (encrypted content)\n\nThe following debugged code shows the batch being created while execution.\n\n\nThe following domains are used for C&C :\n\n\nThe batch file has the following content:\n\n\nThe following debugged code shows the batch being created while execution.\n\n\n-----\n\nactivities in the targeted browsers (Chrome, Firefox, Safari, and IE).\n\n\nactivities in the targeted browsers (Chrome, Firefox, Safari, and IE).\n\n\n### Restart Mechanism\n\n#### Description\nThe following registry entry would enable the Trojan to execute every time when Windows starts.\n\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon  \"Userinit\"\n\"C:\\WINDOWS\\system32\\userinit.exe,\"\"C:\\WINDOWS\\system32\\userinit.exe, C:\\Program Files \\WindowsNT\\svchost.exe\"\n\n\n#### 5% 7%\n\n 86%\n\n\n-----\n\nSettings\\Home\\Application Data\\Keucot\\qagi.exe\"\"\n\n#### Mitigation\nUsers are requested to exercise caution while opening unsolicited emails and unknown links. Users are\nadvised to update Windows and third-party application security patches and virus definitions on a regular\nbasis and have proper filtering rules.\n\n  - Use Access Protection Rules from accessing such run keys.\n\n  - Please keep your anti-virus updated.\n\n  - Keep software up-to-date with the latest available patches.\n\n  - It is advisable to use your firewall to monitor unusual traffic.\n\n  - Disable AutoPlay to prevent the automatic launching of executable files on network and removable drives.\n\n### Getting Help from the McAfee Foundstone Services team\n\nThis document is intended to provide a summary of current intelligence and best practices to ensure the highest\nlevel of protection from your McAfee security solution. The McAfee Foundstone Services team offers a full range\nof strategic and technical consulting services that can further help to ensure you identify security risk and build\neffective solutions to remediate security vulnerabilities.\n\nYou can reach them here: https://secure.mcafee.com/apps/services/services-contact.aspx\n\n\n© 2011 McAfee, Inc. All rights reserved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/yzybkh6neofhi2wonyn7abjyn2hlfa8f",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.01.18.Operation_Red_Oct/McAfee_Labs_Threat_Advisory_Exploit_Operation_Red_Oct.pdf"
    ],
    "report_names": [
        "McAfee_Labs_Threat_Advisory_Exploit_Operation_Red_Oct"
    ],
    "threat_actors": [
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041123,
    "ts_creation_date": 1358499260,
    "ts_modification_date": 1358499311,
    "files": {
        "pdf": "https://archive.orkl.eu/b6217ea7fe6b4dd5e27b2a1b4b84432db2e1b2f3.pdf",
        "text": "https://archive.orkl.eu/b6217ea7fe6b4dd5e27b2a1b4b84432db2e1b2f3.txt",
        "img": "https://archive.orkl.eu/b6217ea7fe6b4dd5e27b2a1b4b84432db2e1b2f3.jpg"
    }
}