{
    "id": "0b2d608f-3a5a-4eaf-9e95-17a99340f0b6",
    "created_at": "2023-01-12T15:02:34.179094Z",
    "updated_at": "2025-03-27T02:09:18.569241Z",
    "deleted_at": null,
    "sha1_hash": "5f93388f55ef360c18e0db802e29279a62a9b23c",
    "title": "2021-01-05 - [Threat Analysis] CLOP Ransomware that Attacked Korean Distribution Giant",
    "authors": "",
    "file_creation_date": "2022-05-28T23:07:22Z",
    "file_modification_date": "2022-05-28T23:07:22Z",
    "file_size": 2757488,
    "plain_text": "# [Threat Analysis] CLOP Ransomware that Attacked Korean Distribution Giant\n\n**asec.ahnlab.com/en/19542/**\n\nJanuary 5, 2021\n\n**In November last year, there was a case that shocked not only the security industry, but also**\n**all of the Korean industries. The system of E-Land Group, the distribution giant, was**\n**infected by the ‘CLOP Ransomware.’ According to the press report that quoted an associate**\n**of the company, over half of the brick-and-mortar stores were affected by the ransomware,**\n**leading to disruption of business. This incident showed that the ransomware attacks can**\n**occur regardless of company size, and Korean industries must now face such threats that**\n**made themselves tangible.**\n\n**AhnLab, the leader of the Korean security industry, published an in-depth analysis report of**\n**CLOP Ransomware’s distribution path, whether infected PCs can be restored, course of the**\n**attack, and trend of change. This paper will briefly examine the content of the report.**\n\n\n-----\n\nBefore discussing the case of attack against E-Land, the CLOP Ransomware must be analyzed as\nhaving knowledge on CLOP Ransomware’s attack process and trend of change can help\nunderstand the case better.\n\n**Target of CLOP Ransomware Attack and Process**\n\n**Attack Target**\n\nCLOP Ransomware targeted companies that operate Active Directory (AD). AD is more commonly\nused by companies than individual users as it allows companies to manage multiple Windows\nsystems efficiently via centralized management. The attacker abused this advantage to steal AD\nserver administrator privilege and attacked various systems within companies.\n\nAhnLab estimates that in 2019, 369 companies and 13,497 systems (PC and server) suffered\ndamage due to CLOP Ransomware. As only the attacks against companies were taken into\naccount, there may be many more systems that suffered damage if taking unconfirmed systems\ninto account.\n\nVarious industries were targeted including but not limited to public institutions, education,\nbroadcasting, finance/security/insurance, manufacturing, IT, distribution, communications, etc.\nBased on the first half of 2019 and in terms of percentage, most of the ransomware attacks were\ndone against the manufacturing industry (53%), followed by finance (15%), information service\n(11%), and retails industry (9%).\n\nThe attacker utilized meticulously-made spear-phishing attacks to target companies. They\nattempted attacks after pinpointing email recipients and meticulously wrote the email content in\nlanguages their targets use. One notable thing is that the attacker targeted non-Russian countries.\nThe attacker designed the ransomware to first check keyboard layout and character set, and if the\ntarget is Russian or that of CIS nation’s it does not run\n\n\n-----\n\n**Ransomware Variants**\n\nNext is the change in the number of CLOP Ransomware variants that were found in the first half of\n2019. In February 2019, a large number of CLOP Ransomware variants were found. Note that\n‘ClopReadMe.txt,’ CLOP Ransomware’s ransom note, was first revealed in Pastebin.com on\nFebruary 8, 2019.\n\nFigure 1. Change in numbers of CLOP Ransomware variants in 2019\n**Attack Process**\n\nThe attack is carried out through preparation, domination, and execution phase. Specifically, there\nare 10 phases in total. The actual distribution and execution of CLOP Ransomware are the very last\nphase. The 3 big phases and the phases divided into 10 specific phases are as follows:\n\n**Preparation** **Sends malicious document attachment file via email to the first attack target**\n**and install remote control malware**\n\n1 User opens malicious document file (Excel, Word) attached to an email\n\n2 Runs remote control malware downloader via macro inserted to a document file\n\n3 If the system is added to AD (Active Directory) and operated in it,downloads\nremote control malware file and runs it (targeting AD environment)\n\n4 Remote control malware file installs Cobalt Strike Beacon to the system\n\n**Domination** **Dominates system within AD using Cobalt Strike**\n\n5 Checks AD domain configuration info\n\n6 Escalates run privilege using vulnerability\n\n7 Runs Mimikatz module with escalated privilegeand obtains local administrator\naccount or credential of AD domain administrator account\n\n8 If AD domain administrator account is successfully obtained,connects to domain\ncontroller server and dominates system connected to domain\n\n\n-----\n\n**Execution** **Attempts CLOP Ransomware infection on system within AD**\n\n9 Prepares malware such as CLOP Ransomware in the domain controller’s shared\nfolder\n\n10 Distributes and runs CLOP Ransomware by using task scheduler or remote\ncommand to the system connected to AD domain\n\nTable 1. CLOP Ransomware’s attack process\n**CLOP Ransomware’s Change Trend**\n\nCompared to the past, CLOP Ransomware did not change fundamentally in terms of encryption\nmethod and operation as a service. The difference is that it now compares after obtaining CRC\ninstead of strings in process termination routine and encryption exception path.\n\n**Recent Changes in CLOP Ransomware**\n\nAdditional change was confirmed in CLOP Ransomware collected in the second half of 2020. The\npast version worked by adding a symmetric-key that is encrypted with public-key along with\nsignature to the back of the encrypted file, but the recently-confirmed CLOP Ransomware works by\nadding ‘.Cllp’ extension to the same name, saving signature and encrypted key to a newly-created\nfile.\n\n\n-----\n\nFigure 2.\n\n\nPrevious CLOP Ransomware – Symmetric key added to back of the encrypted file\n\n\n-----\n\nFigure 3. Recently-found CLOP Ransomware – Saves symmetric key to .Clip file\nMoreover, routine that terminates other processes and routine that deletes volume shadow copy got\nremoved. However, the file with the identical certificate that is in charge of the process termination\nroutine was discovered along, which can be assumed that the method of CLOP Ransomware\nchanged. It has changed to make the additional file become capable of such a feature instead of\nCLOP Ransomware binary.\n\nFigure 4. Discovery of file with process termination feature\n\n\n-----\n\nPacking method is also one of the changes. CLOP Ransomware has the appearance of a packer\njust like other malware such as FlawedAmmyy. This means that it keeps encoded binary to bypass\nfile detection, and upon execution, runs the original binary decoded in memory.\n\n**Change of Ransom Note**\n\nIn 2019, there were no big changes made to the content of the ransom note file of CLOP\nRansomware. It mostly consists of notice that the files are encrypted, note of caution, and email\naddress of the attacker. However, CLOP Ransomware discovered since October 2020 not only\nincludes contact to recover encrypted files, but also a message of threat against the victim that they\nwill publish sensitive data of the company on a deep-web. Leaked information of the company was\npublished on a deep website mentioned in the ransom note below.\n\n\n-----\n\nHELLO DEAR SOFTWARE AG\nYOUR NETWORK IS ENCRYPTED!\nALL YOUR FILES ARE ENCRYPTED!\nAlso a lot of sensitive data has been downloaded from your network.\nFor example:\n\n\\\\10.137.1.81\\Finance\\Private\n\\\\10.137.1.81\\Finance\\Share\n\\\\10.66.20.19\\Finance\n\\\\10.66.20.19\\Contracts\n\\\\10.21.32.57\\MandAProjects\n\nThis is a small part, about 10%.\nIf you refuse to cooperate, all data will be published for free download on our portal:\n[http://ekbgzchl6x2ias37.onion/ (use TOR browser)](http://ekbgzchl6x2ias37.onion/)\nmirror [http://ekbgzchl6x2ias37.onion.dog/](http://ekbgzchl6x2ias37.onion.dog/)\nTo get access to your files back, contact us by email:\nunlock@goldenbay.su\nor\nunlock@graylegion.su\nAND\ndromotelllinghoettd@tutanota.com\nor write to the chat at:\nhttp://geqwmtbpciqqhs7nsw5crgwtqw7mncatrz65bkrpcfpwtv424uszsbid.onion/?\nu=FR1GMMX2WCE4XI3Z3H38Q7CG628J7OOS5VEX71594937HCWQJ5OFI7LFFZ4SDIAO&nbsp;\n(use TOR browser)\n\n!!! DO NOT ATTEMPT TO RESTORE OR MOVE THE FILES YOURSELF. THIS MAY DESTROY\nTHEM !!!CI0p-_^\n\nFigure 5. Ransom note containing information leakage threat\n**Analysis of Attack on Distribution Giant E-Land**\n\nThis paper will now take a brief look on the attack against E-Land based on the analysis of CLOP\nRansomware attack.\n\nLike the previous CLOP Ransomware, a system infected by CLOP Ransomware used in the attack\nagainst company A cannot be restored. This ransomware uses a symmetric key algorithm to\nencrypt each file, and an encrypted symmetric key with a public key that exists within the binary.\nThis means that if a private key corresponding to the public key is unknown, the encrypted files\ncannot be restored.\n\nHowever, the previous CLOP Ransomware and the new CLOP Ransomware have different\nmethods of saving the encrypted key. As explained in the ‘CLOP Ransomware’s Change Trend’\nsection, the early version used a method of attaching encrypted keys along with specific signatures\nin the back of the encrypted file. However, the recently discovered CLOP Ransomware creates an\nadditional file with an added ‘.Clip’ extension that has the same filename (normal filename kept) as\nthe encrypted file, and saves the relevant key to that ‘.Clip’ file. The CLOP Ransomware used for\nthe attack on E-Land is the latter.\n\n\n-----\n\nFiles cannot be restored as the attacker s secret key is unknown, but unlike the previous version,\nthe ransomware does not have the command to delete volume shadow copy (a basic feature of\nWindows which is a saved copy of a file, folder, or a volume of a specific time). Hence, if a recovery\npoint before ransomware affection exists, it is possible to revert the system to the uninfected state.\n\nFigure 6. The infected file (upper) and the restored file (below)\n\n\n-----\n\nFurthermore, CLOP Ransomware file used in attack against E-Land contains info of the following\ndigital signature certificate.\n\nFigure 7. Certificate used by CLOP Ransomware during attack against E-Land\nAhnLab confirmed various files with certificates identical to CLOP Ransomware that was used to\nattack E-Land. According to the analysis result, other files with the certificate were distributed since\nOctober, and were created as not only ransomware, but also files to disable Windows Defender\n\n\n-----\n\nanti-malware products. This means that the same group is developing CLOP Ransomware as well\nas another various ransomware using the same certificate.\n\nIn conclusion, the attacker utilized meticulous and carefully-planned strategy to attack E-Land. The\nattacker utilized and distributed CLOP Ransomware malware to abuse the fact that multiple\nsystems can be controlled at once through AD. In this process, the attacker installs remote control\nmalware and obtains system administrator privilege. The target company takes tremendous\ndamage as their system is infected with CLOP Ransomware, their internal information is leaked,\nand administrator accounts are stolen. The attacker blackmails the company by threatening not\nonly to encrypt the files, but also publish the fact that the company is infected with ransomware and\nstolen information to the public if they don’t pay the ransom. The attacker of CLOP Ransomware is\nfollowing the recent trend of threatening companies with two hostages: file encryption and internal\ninformation leakage.\n\nCLOP Ransomware attack that occurred since 2019 is still on-going in 2020. The attacker is\nevolving by changing the method of malware distribution and attack. There are also reported cases\nof the attacker taking control of a company’s AD server and letting it stay dormant, not running the\nransomware immediately. Because of the time disruption factor, it is even harder to reverse track\nthe attack when the ransomware attack occurs.\n\nBoth individuals and companies must work together to defend against CLOP Ransomware attacks.\nAbove all, it is crucial for individuals to improve their security awareness. Adequate user education\nmust be provided to prevent falling victim to spear-phishing, and also frequently check whether\nsoftware is updated to the latest version and whether they are functioning properly. Additionally, the\nusers must backup important documents and files in case of accidents. Companies must pay extra\nattention to AD security and tightly manage account info. If a security product has been installed,\nthe system must be monitored periodically so that signs of the system abnormality can be found in\na timely manner.\n\n[Categories:Malware Information](https://asec.ahnlab.com/en/category/malware-information/)\n\n[Tagged as:clop ransomware](https://asec.ahnlab.com/tag/clop-ransomware/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-05 - [Threat Analysis] CLOP Ransomware that Attacked Korean Distribution Giant.pdf"
    ],
    "report_names": [
        "2021-01-05 - [Threat Analysis] CLOP Ransomware that Attacked Korean Distribution Giant.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535754,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653779242,
    "ts_modification_date": 1653779242,
    "files": {
        "pdf": "https://archive.orkl.eu/5f93388f55ef360c18e0db802e29279a62a9b23c.pdf",
        "text": "https://archive.orkl.eu/5f93388f55ef360c18e0db802e29279a62a9b23c.txt",
        "img": "https://archive.orkl.eu/5f93388f55ef360c18e0db802e29279a62a9b23c.jpg"
    }
}