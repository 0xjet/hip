{
    "id": "5196702b-8190-476b-9db2-b588f9dbc45b",
    "created_at": "2023-01-12T15:10:02.090505Z",
    "updated_at": "2025-03-27T02:16:26.850873Z",
    "deleted_at": null,
    "sha1_hash": "571e95d54b4a889fefdd6dcbfbf3229c4e882d6c",
    "title": "2018-08-21 - Supply Chain Attack Operation Red Signature Targets South Korean Organizations",
    "authors": "",
    "file_creation_date": "2022-05-28T02:42:55Z",
    "file_modification_date": "2022-05-28T02:42:55Z",
    "file_size": 333684,
    "plain_text": "# Operation Red Signature Targets South Korean Companies\n\n**blog.trendmicro.com/trendlabs-security-intelligence/supply-chain-attack-operation-red-signature-targets-south-korean-**\norganizations/\n\nAugust 21, 2018\n\n[Together with our colleagues at IssueMakersLab, we uncovered Operation Red Signature,](http://www.issuemakerslab.com/)\nan information theft-driven supply chain attack targeting organizations in South Korea. We\ndiscovered the attacks around the end of July, while the media reported the attack in South\nKorea on August 6.\n\nThe threat actors compromised the update server of a remote support solutions provider to\ndeliver a remote access tool called 9002 RAT to their targets of interest through the update\nprocess. They carried this out by first stealing the company’s certificate then using it to sign\nthe malware. They also configured the update server to only deliver malicious files if the\nclient is located in the range of IP addresses of their target organizations.\n\n9002 RAT also installed additional malicious tools: an exploit tool for Internet Information\n[Services (IIS) 6 WebDav (exploiting CVE-2017-7269) and an SQL database password](https://blog.trendmicro.com/en_us/research/17/c/iis-6-0-vulnerability-leads-code-execution.html)\ndumper. These tools hint at how the attackers are also after data stored in their target’s web\nserver and database.\n\n_Figure 1. Operation Red Signature’s attack chain_\n\nHere’s how Operation Red Signature works:\n\n\n-----\n\n1. The code-signing certificate from the remote support solutions provider is stolen. It s\n\npossible that the certificate was stolen as early as April 2018, as we found a ShiftDoor\nmalware (4ae4aed210f2b4f75bdb855f6a5c11e625d56de2) on April 8 that was signed\nwith the stolen certificate.\n2. Malicious update files are prepared, signed with the stolen certificate, and uploaded to\n\nthe attacker’s server (207[.]148[.]94[.]157).\n3. The update server of the company is hacked.\n4. The update server is configured to receive an update.zip file from the attackers’ server\n\nif a client is connecting from a specific range of IP addresses belonging to their\ntargeted organizations.\n5. The malicious update.zip file is sent to the client when the remote support program is\n\nexecuted.\n6. The remote support program recognizes the update files as normal and executes the\n\n9002 RAT malware inside it.\n7. 9002 RAT downloads and executes additional malicious files from the attackers’ server.\n\n**Technical analysis**\n\nThe update.zip file contains an update.ini file, which has the malicious update configuration\nthat specifies the remote support solution program to download file000.zip and file001.zip\nand extract them as rcview40u.dll and rcview.log to the installation folder.\n\nThe program will then execute rcview40u.dll, signed with the stolen certificate, with Microsoft\nregister server (regsvr32.exe). This dynamic-link library (DLL) is responsible for decrypting\nthe encrypted rcview.log file and executing it in memory. 9002 RAT is the decrypted\n_rcview.log payload, which connects to the command-and-control (C&C) server at_\n66[.]42[.]37[.]101.\n\n_Figure 2. Contents of the malicious update configuration_\n\n_Figure 3. How the compromised update process launches the 9002 RAT malware_\n\n_Figure 4. Known 9002 RAT string pattern inside the decrypted payload of the rcview.log file_\n\n**Correlating 9002 RAT**\n\nDelving into 9002 RAT, we found that it was compiled on July 17, 2018, and that the\nconfiguration files inside update.zip were created on July 18. Our analysis of an update log\nfile we found reveals the remote support program’s update process started around 13:35 on\n\n\n-----\n\nJuly 18, with the 9002 RAT being downloaded and launched. We also saw the RAT file used\nfor this specific attack was set to be inactive in August, so we can construe that the RAT’s\nactivity was rather short-lived (from July 18 to July 31).\n\n_Figure 5. Compilation timestamp on 9002 RAT sample (top), timestamp of the malicious_\n_configuration (center), and snapshot of the program’s update log (bottom)_\n\n_Figure 6. Code snippet showing 9002 RAT checking the system time and setting itself to_\n_sleep in August 2018_\n\n**Additional malware tools**\n\nThe 9002 RAT also serves as a springboard for delivering additional malware. Most of these\nare downloaded as files compressed with the Microsoft cabinet format (.cab). This is most\nlikely done to avoid detection by antivirus (AV) solutions.\n\nHere’s a list of files that 9002 RAT retrieves and delivers to the affected system:\n\n**Filename** **Tool** **Purpose**\n\ndsget.exe DsGet View active directory objects\n\ndsquery.exe DsQuery Search for active directory objects\n\nsharphound.exe SharpHound Collect active directory information\n\naio.exe All In One (AIO) Publicly available hack tool\n\nssms.exe SQL Password dumper Dump password from SQL database\n\nprintdat.dll RAT (PlugX variant) Remote access tool\n\nw.exe IIS 6 WebDav Exploit Tool Exploit tool for CVE-2017-7269 (IIS 6)\n\nWeb.exe WebBrowserPassView Recover password stored by browser\n\nsmb.exe Scanner Scans the system’s Windows version\nand computer name\n\n\nm.exe Custom Mimikatz (including\n32bit / 64bit file)\n\n\nVerify computer password and active\ndirectory credentials\n\n\n-----\n\n_Figure 7. Downloaded Web.ex_ cabinet file (left) and decompressed Web.exe file (right)_\n\nOne of the downloaded files printdat.dll, which is another RAT. It is a variant of PlugX\nmalware, and connects to the same C&C server (66[.]42[.]37[.]101).\n\n_Figure 8. Internal PlugX date dword value inside the printdat.dll file_\n\n**Mitigating supply chain attacks**\n\nSupply chain attacks don’t just affect users and businesses — they exploit the trust between\nvendors and its clients or customers. By trojanizing software/applications or manipulating the\ninfrastructures or platforms that run them, supply chain attacks affects the integrity and\n[security of the goods and services that organizations provide. In healthcare, for instance,](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/internet-of-things/exposed-medical-devices-and-supply-chain-attacks-in-connected-hospitals)\n[where the industry heavily relies on third-party and cloud-based services, supply chain](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/virtualization-and-cloud/-misconfigured-cloud-services-pose-high-security-risks-for-organizations)\nattacks can risk the privacy of personally identifiable data and intellectual property, disrupt\nhospital operations, and even endanger patient health. And when stacked up with\n[regulations such as the EU General Data Protection and Regulation (GDPR), the impact can](https://www.trendmicro.com/vinfo/tmr/?/us/security/definition/eu-general-data-protection-regulation-gdpr)\nbe exacerbated.\n\nHere are some best practices:\n\n[Oversee third-party products and services; apart from ensuring the security of the](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/data-breaches-highlight-the-need-for-managed-detection-and-response#thirdparty)\norganization’s own online premises (e.g., patching, authentication mechanisms),\nsecurity controls must also be in place in third-party applications being used.\nDevelop a proactive incident response strategy: Supply chain attacks are often\ntargeted; organizations must be able to fully understand, manage, and monitor the risks\ninvolved in third-party vendors.\n[Proactively monitor the network for anomalous activities; firewalls and](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/best-practices-deploying-an-effective-firewall) intrusion\ndetection and prevention systems help mitigate network-based threats.\nEnforce the [principle of least privilege:](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/how-can-the-network-be-protected-from-targeted-attacks) [Network segmentation,](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/protecting-data-through-network-segmentation) [data categorization,](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/keeping-digital-assets-safe-need-for-data-classification)\n[restriction of system administration](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/best-practices-securing-sysadmin-tools) [tools, and application control help deter lateral](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/security-101-the-rise-of-fileless-threats-that-abuse-powershell)\nmovement and minimize data being exposed.\n\n**Trend Micro Solutions**\n\nThe Trend Micro™ [Deep Discovery™ solution provides detection, in-depth analysis, and](https://blog.trendmicro.com/en_us/business/products/network/advanced-threat-protection/deep-discovery-threat-intelligence-network-analytics.html)\nproactive response to today’s stealthy malware and targeted attacks in real time. It provides\na comprehensive defense tailored to protect organizations against targeted attacks and\n[advanced threats through specialized engines, custom sandboxing, and seamless](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/security-technology/how-can-advanced-sandboxing-techniques-thwart-elusive-malware)\ncorrelation across the entire attack life cycle, allowing it to detect threats even without any\nengine or pattern update. Trend Micro endpoint solutions such as the Smart Protection\nSuites and [Worry-Free Business Security solutions can protect users and businesses from](https://blog.trendmicro.com/en_us/small-business/worry-free.html)\nthreats by detecting malicious files and blocking all related malicious URLs.\n\n\n-----\n\n**Indicators of Compromise (IoCs):**\n\n_Related hashes (SHA-256):_\n\n0703a917aaa0630ae1860fb5fb1f64f3cfb4ea8c57eac71c2b0a407b738c4e19\n(ShiftDoor) — detected by Trend Micro as BKDR_SETHC.D\nc14ea9b81f782ba36ae3ea450c2850642983814a0f4dc0ea4888038466839c1e\n(aio.exe) — HKTL_DELOG\na3a1b1cf29a8f38d05b4292524c3496cb28f78d995dfb0a9aef7b2f949ac278b (m.exe) —\nHKTL_MIMIKATZ\n9415ca80c51b2409a88e26a9eb3464db636c2e27f9c61e247d15254e6fbb31eb\n(printdat.dll) — TSPY_KORPLUG.AN\n52374f68d1e43f1ca6cd04e5816999ba45c4e42eb0641874be25808c9fe15005\n(rcview.log) — TROJ_SIDELOADR.ENC\nbcfacc1ad5686aee3a9d8940e46d32af62f8e1cd1631653795778736b67b6d6e\n(rcview40u.dll) — TROJ_SIDELOADR.A\n279cf1773903b7a5de63897d55268aa967a87f915a07924c574e42c9ed12de30\n(sharphound.exe) — HKTL_BLOODHOUND\ne5029808f78ec4a079e889e5823ee298edab34013e50a47c279b6dc4d57b1ffc\n(ssms.exe) — HKTL_PASSDUMP\ne530e16d5756cdc2862b4c9411ac3bb3b113bc87344139b4bfa2c35cd816e518 (w.exe)\n— TROJ_CVE20177269.MOX\n28c5a6aefcc57e2862ea16f5f2ecb1e7df84b68e98e5814533262595b237917d\n(Web.exe) — HKTL_BROWSERPASSVIEW.GA\n\n_URLs related to the malicious update file:_\n\nhxxp://207[.]148[.]94[.]157/update/rcv50/update.zip\nhxxp://207[.]148[.]94[.]157/update/rcv50/file000.zip\nhxxp://207[.]148[.]94[.]157/update/rcv50/file001.zip\n\n_URLs related to additionally downloaded malicious files:_\n\nhxxp://207[.]148[.]94[.]157/aio.exe\nhxxp://207[.]148[.]94[.]157/smb.exe\nhxxp://207[.]148[.]94[.]157/m.ex_\nhxxp://207[.]148[.]94[.]157/w\nhxxp://207[.]148[.]94[.]157/Web.ex_\n\n_Related C&C server (9002 RAT and PlugX variant):_\n\n66[.]42[.]37[.]101\n\nAPT & Targeted Attacks\n\n\n-----\n\nWe uncovered Operation Red Signature, an information theft-driven supply chain attack\ntargeting organizations in South Korea. We discovered the attacks around the end of July,\nwhile the media reported the attack in South Korea on August 6.\n\nBy: Jaromir Horejsi, Joseph C Chen, Kawabata Kohei, Kenney Lu August 21, 2018 Read\ntime: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-21 - Supply Chain Attack Operation Red Signature Targets South Korean Organizations.pdf"
    ],
    "report_names": [
        "2018-08-21 - Supply Chain Attack Operation Red Signature Targets South Korean Organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8860d9ac-afa8-454d-9d86-926aa8dd5019",
            "created_at": "2024-02-08T02:00:04.313581Z",
            "updated_at": "2025-03-27T02:00:03.327864Z",
            "deleted_at": null,
            "main_name": "Operation Red Signature",
            "aliases": [],
            "source_name": "MISPGALAXY:Operation Red Signature",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "446025dc-d003-448e-a5ea-43ce24bc883d",
            "created_at": "2022-10-25T16:07:23.997281Z",
            "updated_at": "2025-03-27T02:02:10.06756Z",
            "deleted_at": null,
            "main_name": "Operation Red Signature",
            "aliases": [],
            "source_name": "ETDA:Operation Red Signature",
            "tools": [
                "9002 RAT",
                "HOMEUNIX",
                "HidraQ",
                "Homux",
                "Hydraq",
                "McRAT",
                "MdmBot",
                "Roarur"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536202,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653705775,
    "ts_modification_date": 1653705775,
    "files": {
        "pdf": "https://archive.orkl.eu/571e95d54b4a889fefdd6dcbfbf3229c4e882d6c.pdf",
        "text": "https://archive.orkl.eu/571e95d54b4a889fefdd6dcbfbf3229c4e882d6c.txt",
        "img": "https://archive.orkl.eu/571e95d54b4a889fefdd6dcbfbf3229c4e882d6c.jpg"
    }
}