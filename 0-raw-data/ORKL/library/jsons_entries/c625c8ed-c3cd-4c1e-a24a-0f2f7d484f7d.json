{
    "id": "c625c8ed-c3cd-4c1e-a24a-0f2f7d484f7d",
    "created_at": "2023-01-12T15:04:20.209686Z",
    "updated_at": "2025-03-27T02:15:35.693026Z",
    "deleted_at": null,
    "sha1_hash": "52d973cf628ef1aabbf1b7fead37a8d649062e14",
    "title": "2022-08-18 - Luca Stealer Targets Password Managers and Cryptocurrency Wallets",
    "authors": "",
    "file_creation_date": "2022-09-01T10:15:05Z",
    "file_modification_date": "2022-09-01T10:15:05Z",
    "file_size": 2643135,
    "plain_text": "# Luca Stealer Targets Password Managers and Cryptocurrency Wallets\n\n**[blogs.blackberry.com/en/2022/08/luca-stealer-targets-password-managers-and-cryptocurrency-wallets](https://blogs.blackberry.com/en/2022/08/luca-stealer-targets-password-managers-and-cryptocurrency-wallets)**\n\nThe BlackBerry Research & Intelligence Team\n\n[Threat actors carried out an attack on the Solana blockchain network on Aug. 3, 2022, with](https://watcher.guru/news/heres-everything-we-know-about-the-solana-exploit-so-far)\n$7 million being drained from over 8,000 individual crypto wallets. The apparent culprit in\nthe attack: a little-known piece of malware called Luca Stealer.\n\nEarlier this summer, threat actors released the source code for the previously unknown\n[Rust-based malware, since](https://blogs.blackberry.com/en/2021/07/old-dogs-new-tricks-attackers-adopt-exotic-programming-languages) [dubbed Luca Stealer, on underground hacking forums. While](https://watcher.guru/news/heres-everything-we-know-about-the-solana-exploit-so-far)\nthe malware has several information-stealing functions, its primary targets appear to be\npassword management software and cryptocurrency wallets.\n\nAlthough the malware has thus-far only been seen targeting Windows® devices, because it\nis written in the programming language Rust, the source code could be ported easily to\nother operating systems, such as MacOS® or Linux® in the future.\n\n### Operating System\n\n\n-----\n\n### Risk & Impact\n\n Technical Analysis\n\nThe source code posting, as seen in Figure 1, made the Rust-based malware publicly\navailable on GitHub, though it has since been removed from the site.\n\n\n-----\n\n_Figure 1 – The malware author’s post on underground forum_\n\nSince the code became open source, Luca Stealer has begun showing up in public\nmalware repositories, often with modifications by the various threat actors that have since\nincorporated the malware into their own individual campaigns.\n\nUpon execution, the malware creates a compressed folder called “out.zip,” which is located\nwithin the %Temp% directory. This folder, which contains the files shown in Figure 2 below,\nis used to store harvested data for exfiltration.\n\n\n-----\n\n_Figure 2 - Zip file containing harvested data_\n\n### Screengrab\n\nThe attack begins with the stealer taking a screenshot of the victim’s screen at the time of\ninfection, using the functionality shown in the code snippet in Figure 3. The captured image\nis stored under the file name “screen-1.png.”\n\n_Figure 3 - Screengrab functionality_\n\n### Discord\n\nAfter taking the screengrab, the malware then attempts to steal Discord tokens from the\ntarget machine. A Discord token is an encryption of the victim’s Discord username. This\ntoken is created when the user logs in to Discord; it is essentially an authorization code\nused to verify authentication. Luca Stealer searches through known Discord directories on\nthe target machine (as shown in Figure 4) and stores any tokens it finds into the\n“discord_tokens.txt” file.\n\n_Figure 4 - Malware attempting to steal Discord tokens_\n\n\n-----\n\n### Fingerprinting\n\nLuca Stealer also creates a digital fingerprint of the victim’s system, gathering information\nabout the target machine and storing it in two text files, called “info.txt” and\n“system_info.txt.” These files are placed into the “out.zip” folder mentioned above. The\n“system_info.txt” file is used for storing the following information:\n\nLocal network information\nPercentage of CPU usage\nA list of all current running processes\nInstalled antivirus (AV) information\n\nThe “info.txt” file is used to store information that is more personal to the user, such as the\nfollowing:\n\nThe victim’s username\nThe language of the victim’s machine\nThe device’s name\nThe city/time zone of the victim’s device\n\n### Browsers\n\nLuca Stealer next scans the infected device to collect sensitive information related to\npopular Chromium-based web browsers.\n\nThe malware targets the following browsers:\n\nMicrosoft Edge Chromium 7Star Amigo Brave-Browser\n\nCentBrowser Chedot Google Chrome CocCoc Comodo\n\nElements Epic-Privacy Chrome Canary Kometa Orbitum\n\nSputnik Torch uCozMedia Vivaldi Atom\n\nOpera Opera GX ChromePlus Iriduium Sleipnir\n\nCitrio Coowoo Liebao Qip Surf 360 Browser\n\nPersonal information that the malware gathers includes login data, cookies, browser\nextensions, auto-fill information, payment card details, and more. All of this harvested data\nis saved to a text file for exfiltration\n\n\n-----\n\n### Cryptocurrency\n\nOne of the primary functionalities of Luca Stealer is cryptocurrency stealing, where it targets\na pre-set list of crypto wallets. Cryptocurrency can be stored using either “cold storage” or\n“hot storage.” Hot storage involves the digital currency being stored in an application or\nonline platform. Cold storage involves the currency being stored offline, often on a physical\ndevice such as a USB thumb drive or an external hard drive. Unfortunately for the victims\ninvolved in these attacks, Luca targets both hot and cold methods of storage.\n\nWhen targeting cold-stored crypto wallets, Luca Stealer scours the target machine in search\nof any data associated with the crypto wallet extensions shown in the table and Figure 5\nbelow.\n\nAtomic Exodus Jaxx Electrum Bytecoin\n\nEthereum Guarda Coinomi Armory Zcash\n\n_Figure 5 - Malware functionality targeting “cold” crypto wallets_\n\nWhen targeting hot-stored crypto information, the malware targets browser extensions for\nthe following crypto wallets:\n\nMetaMask TronLink BinanceChain Coin98 iWallet\n\nWombat MEW CX NeoLine Terra Station Keplr\n\nSollet ICONex KHC TezBox Byone\n\n\n-----\n\nOneKey DAppPlay BitClip Steem Keychain\n\nIn the Solana blockchain attack, users reported funds being drained from their personal hot\nwallets, including Phantom, Slope, and TrustWallet. The result of the attack was a loss of\nover $7 million in customers’ cryptocurrency. As Luca Stealer has recently become open\nsource, and with its effectiveness in pilfering from hot-storage wallets, researchers are\nidentifying it as the malware most likely to have been used to carry out this attack.\n\n### Password Manager Browser Add-Ons\n\nOne feature that sets Luca apart from typical infostealers is its focus on targeting browser\nadd-ons used for password management. The malware targets the locally stored data of the\nfollowing 17 password manager browser extensions.\n\nBitwarden EOS Auth KeePassXC Dashlane 1Password NordPass\n\nKeeper RoboForm LastPass BrowserPass MYKI Splikity\n\nCommonKey Zoho Vault Norton Avira Trezor\n\nThe stealer searches the target machine’s %AppData% directory, using the unique IDs of\neach of the preset browser extensions listed above, as seen in Figure 6. It does so in hopes\nof stealing sensitive information such as login credentials and cookies.\n\n_Figure 6 - Searching browser directories with the unique extension IDs_\n\n**Additional Functionality**\n\nIn addition to harvesting the data mentioned above, the stealer also targets a range of\nadditional applications, including the following (also shown in Figure 7):\n\nSteam\n\n\n-----\n\nTelegram\nElement\nICQ\nUbisoft Play\nSkype\n\nFigure 7 - Additional software targeted by Luca Stealer\n\n### Exfiltration\n\nOnce harvested information is stored in the “out.zip” file, the archive file is sent back to the\nthreat actor via Discord web hooks or a Telegram bot. Because Telegram bots have a\nmaximum file upload size of 50MB, transfers larger than this use Discord web hooks.\n\nAlong with the stolen data, the stealer will send back a chat message which outlines a\nsummary of all the information that has been stolen. The format of this can be seen in\nFigure 8 below.\n\n\n-----\n\n_Figure 8 - Data exfiltration chat summary message_\n\n### Conclusion\n\nLuca Stealer contains much of the functionality expected from a typical infostealer, with an\nadded focus on crypto wallets and password management software. This malware is likely\nto continue to see a steady rise in unique samples available in malware repositories online,\nas more and more threat actors get their hands on the open-source code.\n\n### Who is Affected?\n\nAs the malware is freely available and written in the Rust programming language, all\npersonal and corporate users are potential targets. The malware is likely to further evolve\nover time to use different distribution methods, and to target different operating systems.\n\n\n-----\n\nThis means no one is safe from this threat, and everyone should continue to be vigilant.\n\n### Mitigation Tips\n\nSteps to mitigate the effects of a Luca Stealer attack include:\n\nAvoid downloading “cracked” or pirated software, or software from unknown/unverified\nlinks, and create rules that prevent employees from doing this.\nMake sure corporate login credentials and personal passwords are not saved in your\nbrowser.\nFor those who store cryptocurrencies on their local devices (cold storage), ensure you\nhave sufficient security measures in place to prevent any unauthorized people from\ngaining access to your devices.\nEmploy user data transfer analysis to analyze the amount of data transferred by a\n[user (MITRE D3FEND™ technique D3-UDTA).](https://d3fend.mitre.org/technique/d3f:UserDataTransferAnalysis)\n[Implement multi-factor authentication (MITRE D3FEND technique D3-MFA).](https://d3fend.mitre.org/technique/d3f:Multi-factorAuthentication)\nUse outbound traffic filtering to restrict network traffic originating from a private host or\n[enclave destined towards untrusted networks. (MITRE D3FEND technique D3-OTF).](https://d3fend.mitre.org/technique/d3f:OutboundTrafficFiltering/)\nAs the malware exfiltrates stolen data through Telegram and Discord, restricting\noutbound traffic to these hosts can prevent data from being stolen.\n\n### YARA Rule\n\nThe following YARA rule was authored by the BlackBerry Research & Intelligence Team to\ncatch the threat described in this document:\n\n\n-----\n\nimport \"pe\"\n\nrule LucaStealer {\n\nmeta:\ndescription = \"Detects Luca Stealer\"\n\nauthor = \"BlackBerry Threat Research Team\"\n\ndate = \"2022-08-06\"\n\nlicense = \"This Yara rule is provided under the Apache License 2.0\n(https://www.apache.org/licenses/LICENSE-2.0) and open to any user or organization, as\nlong as you use it under this license and ensure originator credit in any derivative to The\nBlackBerry Research & Intelligence Team\"\n\nstrings:\n\n$s1 = \"\\\\logsxc\\\\passwords_.txt\" ascii wide\n\n$s2 = \"\\\\logsxc\\\\cookies_\" ascii wide\n\n$s3 = \"\\\\logsxc\\\\telegram\\\\\" ascii wide\n\n$s4 = \"\\\\logsxc\\\\sensfiles.zip\" ascii wide\n\n$s5 = \"\\\\screen-.png\" ascii wide\n\n$s6 = \"\\\\system_info.txt\" ascii wide\n\n$s7 = \"out.zip\" ascii wide\n\n$s8 = \"\\\\info.txt\" ascii wide\n\n$s9 = \"\\\\system_info.txt\"\n\n$s10 = \"data.png\\\\screen-1.png\"\n\n$s11 = \"\\\\dimp.sts\"\n\n$s12 = \"Credit Cards:\"\n\n$s13 = \"Wallets:\"\n\ncondition:\n\n(\n\n//PE File\n\nuint16(0) == 0x5a4d and\n\n//All Strings\n\n12 of ($s*) )\n\n}\n\n### Indicators of Compromise (IoCs)\n\n**SHA-256**\n\n99331a27afa84009e140880a8739d96f97baa1676d67ba7a3278fe61bfb79022 – Stealer\n\n2e9a2e5098bf7140b2279fb2825ea77af576f36a93f36cad7938f4588d234d3a – Stealer\n\n### BlackBerry Assistance\n\n\n-----\n\nIf you re battling this malware or a similar threat, you ve come to the right place, regardless\nof your existing BlackBerry relationship.\n\n[The BlackBerry Incident Response team is made up of world-class consultants dedicated to](https://www.blackberry.com/us/en/services/incident-response)\nhandling response and containment services for a wide range of incidents, including\nransomware and Advanced Persistent Threat (APT) cases.\n\nWe have a global consulting team standing by to assist you, providing around-the-clock\nsupport where required, as well as local assistance. Please contact us\nhere: https://www.blackberry.com/us/en/forms/cylance/handraiser/emergency-incidentresponse-containment\n\n**Related Reading**\n\n## About The BlackBerry Research & Intelligence Team\n\nThe BlackBerry Research & Intelligence team examines emerging and persistent threats,\nproviding intelligence analysis for the benefit of defenders and the organizations they serve.\n\nBack\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-18 - Luca Stealer Targets Password Managers and Cryptocurrency Wallets.pdf"
    ],
    "report_names": [
        "2022-08-18 - Luca Stealer Targets Password Managers and Cryptocurrency Wallets.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535860,
    "ts_updated_at": 1743041735,
    "ts_creation_date": 1662027305,
    "ts_modification_date": 1662027305,
    "files": {
        "pdf": "https://archive.orkl.eu/52d973cf628ef1aabbf1b7fead37a8d649062e14.pdf",
        "text": "https://archive.orkl.eu/52d973cf628ef1aabbf1b7fead37a8d649062e14.txt",
        "img": "https://archive.orkl.eu/52d973cf628ef1aabbf1b7fead37a8d649062e14.jpg"
    }
}