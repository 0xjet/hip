{
    "id": "826bc4a5-0d41-4590-999f-7e66b05ae4e3",
    "created_at": "2022-10-25T16:48:16.782908Z",
    "updated_at": "2025-03-27T02:09:20.689276Z",
    "deleted_at": null,
    "sha1_hash": "cf011cca773f812145c8e81d8f1bade04e716732",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-09-11T02:27:23Z",
    "file_modification_date": "2019-09-11T02:27:23Z",
    "file_size": 657829,
    "plain_text": "# 09/06/2019 - BITTER APT: Not So Sweet\n\n**[meltx0r.github.io/tech/2019/09/06/bitter-apt-not-so-sweet.html](https://meltx0r.github.io/tech/2019/09/06/bitter-apt-not-so-sweet.html)**\n\nMeltX0R Security September 6, 2019\n\n## Summary\n\nBITTER, an APT group which has been active since 2015, has been observed ramping up their\nactivity lately. In this post, I will review recent infrastructure that is actively being used by this APT,\nwhich is suspected of being used to carry out attacks against Pakistani organizations.\n\n## Analysis\n\nThe BITTER APT group has notably been observed targeting Chinese and Pakistani interests in\nthe past, and is suspected of being belonging to a country in South Asia. Recent reports from\nQiAnXin Technology’s “RedDrip” team, a Chinese security vendor, suggest that the BITTER APT\ngroup is actively launching attacks targeting Pakistani organizations. According to this, they are\nseeing malicious documents causing users to download payloads from maq.com.pk/wehs, which\nlooks to be ArtraDownloader. ArtraDownloader is a Trojan Downloader that was discovered by\nPaloAlto’s UNIT42, and has also been observed downloading BitterRAT Remote Access Trojan,\nboth of which have been associated with BITTER APT groups operations.\n\nResearching for activity related to ArtraDownloader on App.Any.Run reveals numerous examples\nof malicious Microsoft Word documents exploiting the CVE-2017-11882 vulnerability to download\nan executable payload from the aforementioned URL identified by RedDrip (maq.com.pk). CVE2017-11882, which was patched by Microsoft in November of 2017, is a memory corruption\nvulnerability which grants the attacker RCE (remote code execution) upon the user opening a\n[specially crafted file (see here for the Microsoft advisory). These Any.Run analyses indicate that,](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882)\nafter exploitation and download of the ArtraDownloader from maq.com.pk, there is Command &\nControl activity beaconing to the URL onlinejohnline99.org/kvs06v.php.\n\nShown above: App.Any.Run samples of ArtraDownloader\n\nPivoting off of Any.Run and into VirusTotal we can see that onlinejohnline99.org appears to be the\nCommand & Control for several binaries, which are actively being distributed from several\n\n\n-----\n\nrelational graphing abilities, we are able to see that these binaries are also being served from\n_biocons.pk, gandharaart.org, and sartetextile.com. One thing of interest, however notable, is all of_\nthe domains delivering these binaries are hosted by the same ISP (COMSATS, a Pakistani ISP).\nDigging deeper into the IP addresses hosting these domains (203.124.44.31, 203.124.44.66,\n_203.124.44.93, and 203.124.43.227) revealed that they were only hosting a very limited amount_\nof domains, many of which appeared to be very suspect in naming convention or content. While\nthese were suspicious, I could not directly relate them to BITTER APT activity at this time.\n\nShown above: VirusTotal Graph of this campaign’s infrastructure\n\nAnalysis of the discovered binaries confirm them to be ArtraDownloader samples, with variations\nin naming and hash values (such as intelx.exe, lsasw.exe, advrt.exe, wehs.exe,\nreportstableregular.doc.exe, and more). I won’t go into details surrounding the actual analysis of\nthe malware samples as PaloAlto’s UNIT42 has already gone over this at length in their article\n[found here and the binaries I reviewed do not appear to differ significantly from what was](https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/)\ndescribed in their write-up. All of the samples I reviewed utilized onlinejohnline99.org as their\nprimary Command & Control infrastructure, with the exception of one sample which instead\nbeaconed to the domain advas.zhongwenchuantongqiye.com, which was documented as being\nrelated to BITTER operations targeting the Chinese government in May of 2019 by 360-CERT.\n\nThe Command & Control communications are typical for what we would see from\nArtraDownloader with all of the samples performing HTTP POST requests to their respective\n\n\n-----\n\nShown above: Packet capture of ArtraDownloader C2\n\nVarious strings within these samples are obfuscated by adding or subtracting from each byte\nwithin a string, and the data being POST’d to these C2 servers is no exception. In order to\ndecode this data, you can use the following Python script provided by UNIT42 in their analysis of\nthe downloader.\n\ndef decode(data):\nout = \"\"\nfor d in data:\nout += chr(ord(d)-1)\nreturn out\n\n(decode(\"your obfuscated data here\"))\n\nOnce you have deobfuscated the data, you’ll quickly see that it contains the typical identifying\ninformation that is obtained during initial infections, such as hostname, Windows version,\nusername, unique identifier, and a Boolean value indicating if the second stage payload was\ndownloaded and executed successfully.\n\n**Vari‐** **Description** **Decoded**\n\n\n-----\n\nUME Windows Version Windows 7 Professional\n\nOPQ Username admin\n\nIVR Unique Identifier USER-PC##admin@@00371461-2203502-85564\n\n\nst Boolean value indicating if the second stage payload was\ndownloaded and executed successfully\n\n\n0\n\n\nDuring my analysis, I was unable to obtain a second stage payload to further examine the\nBITTER APT infrastructure. However the additional payload would likely have been the BitterRAT\nRemote Access Trojan, which is routinely distributed by ArtraDownloader variants. Once installed,\nthe BITTER actors could then pivot and perform various other action on objectives. At this time,\nthe motives of this group is unknown, however it is likely that this campaign is in pursuit of some\nform of espionage due to the reports of them being backed by a south Asian country (some\nreports indicate India). Based on much of the infrastructure observed being hosted in Pakistan, I\nwould agree with the initial suspicion that Pakistan is being targeted in these attacks. This would\nalso further reaffirm the possible Indian attribution to BITTER APT, due to the long-running unrest\nregarding the Kashmir territorial conflict between India and Pakistan over the Kashmir region.\n\n## Indicators\n\n**Indicator** **Type** **Description**\n\nadvas.zhongwenchuantongqiye.com/Mcx2svc.php URL URL for ArtraDownloader C2\n\nonlinejohnline99.org/ms2u1p.php URL URL for ArtraDownloader C2\n\nonlinejohnline99.org/kvs06v.php URL URL for ArtraDownloader C2\n\nonlinejohnline99.org/index.htm URL URL for ArtraDownloader C2\n\nonlinejohnline99.org/lax05u.php URL URL for ArtraDownloader C2\n\ngandharaart.org/news/lsasw URL URL delivering ArtraDownloader\n\ngandharaart.org/images/advrt URL URL delivering ArtraDownloader\n\nbiocons.pk/ReportsTableRegular.doc.exe URL URL delivering ArtraDownloader\n\nsartetextile.com/news/pq URL URL delivering ArtraDownloader\n\nsartetextile.com/demo/suo URL URL delivering ArtraDownloader\n\nsartetextile.com/news/ctf URL URL delivering ArtraDownloader\n\nmaq.com.pk/wehs URL URL delivering ArtraDownloader\n\n72eb6896fa9326f38d3745cc442611dc MD5 ArtraDownloader hash for advrt.exe\nobtained from gandharaart.org\n\n66b3039067e4f7b8ad1b3166b5dbcacf MD5 ArtraDownloader hash for advrt.exe\nobtained from gandharaart.org\n\n\n-----\n\n73c297f059dd94671ca4e4c7dbfa6241 MD5 ArtraDownloader hash for wehs.exe\nobtained from maq.com.pk\n\n3964665ec90decc41c7c38b42c5a7ce7 MD5 ArtraDownloader hash for suo.exe ob‐\ntained from sartetextile.com\n\neec2828cb4a9032ab1177bb472f1977b MD5 ArtraDownloader hash for ctf.exe ob‐\ntained from sartetextile.com\n\n## References/Further Reading\n\n1. https://en.wikipedia.org/wiki/Kashmir_conflict\n2. https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to\ntarget-pakistan/\n3. https://www.anomali.com/blog/suspected-bitter-apt-continues-targeting-government-of\nchina-and-chinese-organizations\n4. https://cert.360.cn/report/detail?id=137867e159331b7a968aa45050502d13\n5. https://unit42.paloaltonetworks.com/unit42-analysis-of-cve-2017-11882-exploit-in-the-wild/\n6. https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882\n7. https://twitter.com/RedDrip7/status/1164855381052416002\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.09.06.BITTER_APT_Not_So_Sweet/BITTER%20APT_%20Not%20So%20Sweet.pdf"
    ],
    "report_names": [
        "BITTER APT_ Not So Sweet"
    ],
    "threat_actors": [
        {
            "id": "bf6cb670-bb69-473f-a220-97ac713fd081",
            "created_at": "2022-10-25T16:07:23.395205Z",
            "updated_at": "2025-03-27T02:02:09.777308Z",
            "deleted_at": null,
            "main_name": "Bitter",
            "aliases": [
                "T-APT-17",
                "TA397"
            ],
            "source_name": "ETDA:Bitter",
            "tools": [
                "Artra Downloader",
                "ArtraDownloader",
                "Bitter RAT",
                "BitterRAT",
                "Dracarys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "655f7d0b-7ea6-4950-b272-969ab7c27a4b",
            "created_at": "2022-10-27T08:27:13.133291Z",
            "updated_at": "2025-03-27T02:00:55.490812Z",
            "deleted_at": null,
            "main_name": "BITTER",
            "aliases": [
                "T-APT-17"
            ],
            "source_name": "MITRE:BITTER",
            "tools": [
                "ZxxZ"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041360,
    "ts_creation_date": 1568168843,
    "ts_modification_date": 1568168843,
    "files": {
        "pdf": "https://archive.orkl.eu/cf011cca773f812145c8e81d8f1bade04e716732.pdf",
        "text": "https://archive.orkl.eu/cf011cca773f812145c8e81d8f1bade04e716732.txt",
        "img": "https://archive.orkl.eu/cf011cca773f812145c8e81d8f1bade04e716732.jpg"
    }
}