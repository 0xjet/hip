{
    "id": "2c1cfa75-1aec-4c05-b9ab-fb7b59b56fc9",
    "created_at": "2023-01-12T15:08:06.622537Z",
    "updated_at": "2025-03-27T02:16:25.572812Z",
    "deleted_at": null,
    "sha1_hash": "eb3d46b8eab85e818a390e304e5b3eed389aadc4",
    "title": "2019-06-25 - Riltok mobile Trojan- A banker with global reach",
    "authors": "",
    "file_creation_date": "2022-05-28T19:30:56Z",
    "file_modification_date": "2022-05-28T19:30:56Z",
    "file_size": 1308061,
    "plain_text": "# Riltok mobile Trojan: A banker with global reach\n\n**securelist.com/mobile-banker-riltok/91374/**\n\nAuthors\n\n[Tatyana Shishkova](https://securelist.com/author/tatyanashishkova/)\n\nRiltok is one of numerous families of mobile banking Trojans with standard (for such\nmalware) functions and distribution methods. Originally intended to target the Russian\naudience, the banker was later adapted, with minimal modifications, for the European\n“market.” The bulk of its victims (more than 90%) reside in Russia, with France in second\nplace (4%). Third place is shared by Italy, Ukraine, and the United Kingdom.\n\n\n-----\n\n_Geographic spread of the Riltok banking Trojan_\n\n[We first detected members of this family back in March 2018. Like many other bankers, they](https://securelist.com/the-rotexy-mobile-trojan-banker-and-ransomware/88893/)\nwere disguised as apps for popular free ad services in Russia. The malware was distributed\nfrom infected devices via SMS in the form “%USERNAME%, I’ll buy under a secure\ntransaction. youlabuy[.]ru/7*****3” or “%USERNAME%, accept 25,000 on Youla youlaprotect[.]ru/4*****7”, containing a link to download the Trojan. Other samples were also\nnoticed, posing as a client of a ticket-finding service or as an app store for Android.\n\nIt was late 2018 when Riltok climbed onto the international stage. The cybercriminals behind\nit kept the same masking and distribution methods, using names and icons imitating those of\npopular free ad services.\n\n_Icons most frequently used by the Trojan: Avito, Youla, Gumtree, Leboncoin, Subito_\n\nIn November 2018, a version of the Trojan for the English market appeared in the shape of\nGumtree.apk. The SMS message with a link to a banker looked as follows:\n“%USERNAME%, i send you prepayment gumtree[.]cc/3*****1”.\n\n\n-----\n\nItalian (Subito.apk) and French (Leboncoin.apk) versions appeared shortly afterwards in\nJanuary 2019. The messages looked as follows:\n\n“%USERNAME%, ti ho inviato il soldi sul subito subito-a[.]pw/6*****5” (It.)\n“% USERNAME%, ti ho inviato il pagamento subitop[.]pw/4*****7” (It.)\n“%USERNAME%, je vous ai envoyé un prepaiement m-leboncoin[.]top/7*****3” (Fr.)\n“%USERNAME%, j’ai fait l’avance (suivi d’un lien): leboncoin-le[.]com/8*****9” (Fr.)\n\nLet’s take a more detailed look at how this banking Trojan works.\n\n## Infection\n\nThe user receives an SMS with a malicious link pointing to a fake website simulating a\npopular free ad service. There, they are prompted to download a new version of the mobile\napp, under which guise the Trojan is hidden. To be installed, it needs the victim to allow\ninstallation of apps from unknown sources in the device settings.\n\nDuring installation, Riltok asks the user for permission to use special features in\nAccessibilityService by displaying a fake warning:\n\n\n-----\n\nIf the user ignores or declines the request, the window keeps opening ad infinitum. After\nobtaining the desired rights, the Trojan sets itself as the default SMS app (by independently\nclicking Yes in AccessibilityService), before vanishing from the device screen.\n\n\n-----\n\n_After enabling AccessibilityService, the malware sets itself as the default SMS app_\n\nNow installed and having obtained the necessary permissions from the user, Riltok contacts\nits C&C server.\n\nIn later versions, when it starts, the Trojan additionally opens a phishing site in the browser\nthat simulates a free ad service so as to dupe the user into entering their login credentials\nand bank card details. The entered data is forwarded to the cybercriminals.\n\n\n-----\n\n_Phishing page from the French version of the Trojan_\n\n## Communication with C&C\n\nRiltok actively communicates with its C&C server. First off, it registers the infected device in\nthe administrative panel by sending a GET request to the relative address gate.php (in later\nversions gating.php) with the ID (device identifier generated by the setPsuedoID function in a\npseudo-random way based on the device IMEI) and screen (shows if the device is active,\npossible values are “on”, “off”, “none”) parameters.\n\nThen, using POST requests to the relative address report.php, it sends data about the device\n(IMEI, phone number, country, mobile operator, phone model, availability of root rights, OS\nversion), list of contacts, list of installed apps, incoming SMS, and other information. From\nthe server, the Trojan receives commands (for example, to send SMS) and changes in the\nconfiguration.\n\n\n-----\n\n## Trojan anatomy\n\nThe family was named Riltok after the librealtalk-jni.so library contained in the APK file of the\nTrojan. The library includes such operations as:\n\nGet address of cybercriminal C&C server\nGet configuration file with web injects from C&C, as well as default list of injects\nScan for app package names that generated AccessibilityEvent events in the list of\nknown banking/antivirus/other popular apps\nSet malware as default SMS app\nGet address of the phishing page that opens when the app runs, and others\n\n_getStartWebUrl function – get address of phishing page_\n\nThe configuration file contains a list of injects for mobile banking apps – links to phishing\npages matching the mobile banking app used by the user. In most so-called Western\nversions of the Trojan, the package names in the default configuration file are erased.\n\n\n-----\n\n_Sample configuration file of the Trojan_\n\n\n-----\n\nThrough AccessibilityService, the malware monitors AccessibilityEvent events. Depending\non which app (package name) generated the event, Riltok can:\n\nOpen a fake Google Play screen requesting bank card details\nOpen a fake screen or phishing page in a browser (inject) mimicking the screen of the\nrelevant mobile banking app and requesting user/bank card details\nMinimize the app (for example, antivirus applications or device security settings)\n\nAdditionally, the Trojan can hide notifications from certain banking apps.\n\n_List of package names of apps on events from which the Trojan opens a fake Google Play window_\n\n_(for the Russian version of the Trojan)_\n\n_Example of Trojan screen overlapping other apps_\n\n\n-----\n\nWhen bank card details are entered in the fake window, Riltok performs basic validation\nchecks: card validity period, number checksum, CVC length, whether the number is in the\ndenylist sewn into the Trojan code:\n\n\n-----\n\n-----\n\n_Examples of phishing pages imitating mobile banks_\n\nAt the time of writing, the functionality of most of the Western versions of Riltok was\nsomewhat pared down compared to the Russian one. For example, the default configuration\nfile with injects is non-operational, and the malware contains no fake built-in windows\nrequesting bank card details.\n\n## Conclusion\n\nThreats are better prevented than cured, so do not follow suspicious links in SMS, and be\nsure to install apps only from official sources and check what permissions you are granting\nduring installation. As Riltok shows, cybercriminals can apply the same methods of infection\nto victims in different countries with more or less the same success.\n\nKaspersky products detect the above-described threat with the verdict TrojanBanker.AndroidOS.Riltok.\n\n## IoCs\n\n**C&C**\n\n100.51.100.00\n108.62.118.131\n172.81.134.165\n172.86.120.207\n185.212.128.152\n185.212.128.192\n185.61.000.108\n185.61.138.108\n185.61.138.37\n188.209.52.101\n5.206.225.57\nalr992.date\navito-app.pw\nbackfround2.pw\n\n\n-----\n\nbackground1.xyz\nblacksolider93.com\nblass9g087.com\nbrekelter2.com\nbroplar3hf.xyz\nbuy-youla.ru\ncd78cg210xy0.com\ncopsoiteess.com\nfarmatefc93.org\nfirstclinsop.com\nholebrhuhh3.com\nholebrhuhh45.com\nkarambga3j.net\nle22999a.pw\nleboncoin-bk.top\nleboncoin-buy.pw\nleboncoin-cz.info\nleboncoin-f.pw\nleboncoin-jp.info\nleboncoin-kp.top\nleboncoin-ny.info\nleboncoin-ql.top\nleboncoin-tr.info\nmyyoula.ru\nsell-avito.ru\nsell-youla.ru\nsentel8ju67.com\nsubito-li.pw\nsubitop.pw\nweb-gumtree.com\nwhitehousejosh.com\nwhitekalgoy3.com\nyoulaprotect.ru\n\n**Examples of malware**\n\n0497b6000a7a23e9e9b97472bc2d3799caf49cbbea1627ad4d87ae6e0b7e2a98\n417fc112cd0610cc8c402742b0baab0a086b5c4164230009e11d34fdeee7d3fa\n54594edbe9055517da2836199600f682dee07e6b405c6fe4b476627e8d184bfe\n6e995d68c724f121d43ec2ff59bc4e536192360afa3beaec5646f01094f0b745\nbbc268ca63eeb27e424fec1b3976bab550da304de18e29faff94d9057b1fa25a\ndc3dd9d75120934333496d0a4100252b419ee8fcdab5d74cf343bcb0306c9811\ne3f77ff093f322e139940b33994c5a57ae010b66668668dc4945142a81bcc049\n\n\n-----\n\nebd0a8043434edac261cb25b94f417188a5c0d62b5dd4033f156b890d150a4c5\nf51a27163cb0ddd08caa29d865b9f238848118ba2589626af711330481b352df\n\n[Malware](https://securelist.com/tag/malware/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Mobile Malware](https://securelist.com/tag/mobile-malware/)\n[Trojan Banker](https://securelist.com/tag/trojan-banker/)\n\nAuthors\n\n[Tatyana Shishkova](https://securelist.com/author/tatyanashishkova/)\n\nRiltok mobile Trojan: A banker with global reach\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-06-25 - Riltok mobile Trojan- A banker with global reach.pdf"
    ],
    "report_names": [
        "2019-06-25 - Riltok mobile Trojan- A banker with global reach.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536086,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653766256,
    "ts_modification_date": 1653766256,
    "files": {
        "pdf": "https://archive.orkl.eu/eb3d46b8eab85e818a390e304e5b3eed389aadc4.pdf",
        "text": "https://archive.orkl.eu/eb3d46b8eab85e818a390e304e5b3eed389aadc4.txt",
        "img": "https://archive.orkl.eu/eb3d46b8eab85e818a390e304e5b3eed389aadc4.jpg"
    }
}