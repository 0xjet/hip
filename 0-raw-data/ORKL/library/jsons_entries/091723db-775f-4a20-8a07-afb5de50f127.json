{
    "id": "091723db-775f-4a20-8a07-afb5de50f127",
    "created_at": "2023-01-12T14:59:09.894862Z",
    "updated_at": "2025-03-27T02:05:33.001138Z",
    "deleted_at": null,
    "sha1_hash": "1553ae1b7a60b63db33a8d3e8af8881e201f6ba5",
    "title": "2016-11-02 - Linux-Moose- Still breathing",
    "authors": "",
    "file_creation_date": "2022-05-28T18:05:40Z",
    "file_modification_date": "2022-05-28T18:05:40Z",
    "file_size": 1198133,
    "plain_text": "# Linux/Moose: Still breathing\n\n**[welivesecurity.com/2016/11/02/linuxmoose-still-breathing/](http://www.welivesecurity.com/2016/11/02/linuxmoose-still-breathing/)**\n\nNovember 2, 2016\n\nFor the past year, ESET and the security firm GoSecure combined their skills in order to\nresearch Linux/Moose further. Here's some of what was uncovered.\n\n[Editor](https://www.welivesecurity.com/author/editorla/)\n2 Nov 2016 - 01:20PM\n\nFor the past year, ESET and the security firm GoSecure combined their skills in order to\nresearch Linux/Moose further. Here’s some of what was uncovered.\n\n\n-----\n\n## What is a Moose – Introduction\n\nLinux/Moose is a malware family that primarily targets Linux-based consumer routers but\nthat can also infect other Linux-based embedded systems in its path. The compromised\ndevices are used to steal unencrypted network traffic and offer proxying services to the\nbotnet operator. In practice, these capabilities are used to steal HTTP Cookies on popular\nsocial network sites and perform fraudulent actions such as non-legitimate “follows”, “views”\nand “likes”.\n\n[In May 2015 ESET released a whitepaper on the malware family we named Linux/Moose.](http://www.welivesecurity.com/2015/05/26/moose-router-worm/)\nAfter publication, Linux/Moose’s command and control servers went down and we lost track\n[of the animal. A few months later, in September 2015, we got a new sample of Linux/Moose](https://www.virusbulletin.com/uploads/pdf/conference_slides/2015/Bilodeau-VB2015.pdf)\n—with, as expected, some evolution after our publication.\n\nFor the past year, ESET and the security firm GoSecure combined their skills in order to\nresearch Linux/Moose further. GoSecure investigated the social media fraud aspect and\nshed some light on an unknown market they called “The Ego Market”. This market is\n[highlighted in a new whitepaper published by GoSecure. This blog will cover the technical](http://gosecure.net/2016/11/02/exposing-the-ego-market-the-cybercrime-performed-by-the-linux-moose-botnet/)\nchanges between the Moose variants we described in our whitepaper and the new variants\nthat appeared in September 2015.\n\n## Moose in the bushes – Hiding the address of C&C\n\nThe first thing we noticed when we got the new sample was that there was no more\ncommand and control (C&C) IP address inside the binary. It seems that the operators read\nour report carefully and decided to make things a little bit harder for us. In this new version\nthe C&C IP address is given as an encrypted command line argument, as shown in the\nfollowing output:\n\nThis new feature implies that we can no longer run the sample by ourselves; our test\nmachines need to be compromised by an embedded device spreading the threat in-the-wild\nin order to retrieve the C&C IP address. The attentive reader will notice that the IP address\nshown is in 32-bit integer format.\n\n\n-----\n\nThe purpose of encrypting the IP address here is, if the binary is found alone, useless\nwithout the value passed as argument. Also, the value alone makes no sense without the\nbinary having the correct value to decrypt the argument. The value is XORed with a static\nvalue as shown in the following code:\n\nDecompiler output\n\nTo the best of our knowledge, this value has stayed the same over the last few months.\nHere is a Python snippet to decrypt the C&C 32-bit Integer value:\n\nDecrypt C&C IP address\n\n## Moose molted – Network communication\n\nThe network protocol changed but it kept the basis of its protocol and added new layers.\nHere is a quick look of a packet capture from both samples. By the look of things the main\nchange here is from binary protocol to ASCII printable protocol. In Figure 1, on the left side\nthere is the old network protocol and on the right side there is the new one.\n\n\n-----\n\nFigure 1: Network Protocol Differences\n\nIn the old sample the configuration was sent by the C&C server to the malware, and\ncontains various fields like bits field to determine what feature to enable, IP address fields,\nwhitelist list field and password list field. These fields are still present in the new version, but\nseparated in three keys (see Table 1). The operator uses the Cookie: and Set-Cookie:\n[HTTP headers to send these config fields. This config is encrypted by a simple XOR loop](https://tools.ietf.org/html/rfc6265)\nlike in the first version but it’s also encoded in order to be printable in the HTTP headers\nthanks to the following function:\n\nDecompiler output\n\nTable 1 (key-value table) summarizes the main configuration of Moose v.2:\n\n**key** **value**\n\nPHPSESSID main config (local/external scan, sniffer, kill process)\n\n\n-----\n\n**key** **value**\n\nLP password list\n\nWL whitelist list\n\nThe PHPSESSID key contains the encrypted value of bit fields that allow to enable or\ndisable some features on Moose (local/external scan, sniffer, kill process). The LP key\ncontains the password list. Linux/Moose still tries to spread itself by bruteforcing Telnet\ncredentials. There was a big change in this list, from around 300 logins and passwords in\n2015 versus around 10 in 2016. See below:\n\nThe WL key contains the whitelist list. Again the list was shorted from 50 to 10 IP\naddresses. These IP addresses are in the IoC section. Linux/Moose still has the ability to\nrun a proxy service by listening on TCP port 20012. The previous variant used to listen on\nport 10073. The proxy feature allows IP addresses from the whitelist to interact with the\nmalware.\n\n## Conclusion\n\nLinux/Moose’s authors have clearly done a lot of work to stay under the radar with the new\nversion by hiding its C&C server location more effectively and changing the network\nprotocol. By doing this, Moose avoids the Indicators of Compromise (IoCs) released with\nESET’s 2015 whitepaper. Shortening the whitelist and password list shows a more delicate\napproach with Moose. Still, some misleading traces are inside the binary like the fake\ndomain www.challpok.cn found in cleartext in the list of strings or even filenames that can\ncorrespond to bitcoinminer or DDoS malware. Linux/Moose stays exclusively a memoryresident threat; rebooting the embedded device will end its execution.\n\n## Indicators of Compromise\n\n\n-----\n\n### Hashes\n\n**version 0x1F (31)**\n\nc6edfa2bf916d374e60f1b5444be6dbbee099692\n\nc9ca4820bb7be18f36b7bad8e3044b2d768a5db8\n\n5b444f1ac312b4c24b6bde304f00a5772a6a19a4\n\nf7574b3eb708bd018932511a8a3600d26f5e3be9\n\n**version 0x20 (32)**\n\n34802456d10efdf211a7d486f7108319e052cd17\n\n0685cb1d72107de63fa1da52930322df04a72dbc\n\n2876cad26d6dabdc0a9679bb8575f88d40ebd960\n\nf94b6cc5aea170cee55a238eaa9339279fba962f\n\n274ef5884cb256fd4edd7000392b0e326ddd2398\n\nc3f0044ffa9d0bc950e9fd0f442c955b71a706b6\n\nf3daea1d06b1313ec061d93c9af12d0fe746839a\n\n**version 0x21 (33)**\n\n7767c8317fb0bbf91924bddffe6a5e45069b0182\n\n1caac933ae6ca326372f7e5dd9fff82652e22e34\n\n5dea6c0c4300e432896038661db2f046c523ce35\n\ne8dc272954d5889044e92793f0f637fe4d53bb91\n\n0843239b3d0f62ae6c5784ba4589ef85329350fa\n\n1d1d46c312045e17f8f4386adc740c1e7423a24a\n\nd8b45a1114c5e0dbfa13be176723b2288ab12907\n\n**version 0x22 (34)**\n\nc35d6812913ef31c20404d9bbe96db813a764886\n\n### IP addresses\n\n**Primary C&C servers**\n\n192.3.8.218\n\n192.3.8.219\n\n**Whitelist**\n\n155.133.18.64\n\n178.19.111.181\n\n151.80.8.2\n\n\n-----\n\n151.80.8.19\n151.80.8.30\n62.210.6.34\n\nMoose’s IoCs are also available and updated on ESET’s [malware-ioc Github repository.](https://github.com/eset/malware-ioc)\n\n2 Nov 2016 - 01:20PM\n\n### Sign up to receive an email update whenever a new article is published in our Ukraine Crisis – Digital Security Resource Center\n\n Newsletter\n\n Discussion\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-11-02 - Linux-Moose- Still breathing.pdf"
    ],
    "report_names": [
        "2016-11-02 - Linux-Moose- Still breathing.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535549,
    "ts_updated_at": 1743041133,
    "ts_creation_date": 1653761140,
    "ts_modification_date": 1653761140,
    "files": {
        "pdf": "https://archive.orkl.eu/1553ae1b7a60b63db33a8d3e8af8881e201f6ba5.pdf",
        "text": "https://archive.orkl.eu/1553ae1b7a60b63db33a8d3e8af8881e201f6ba5.txt",
        "img": "https://archive.orkl.eu/1553ae1b7a60b63db33a8d3e8af8881e201f6ba5.jpg"
    }
}