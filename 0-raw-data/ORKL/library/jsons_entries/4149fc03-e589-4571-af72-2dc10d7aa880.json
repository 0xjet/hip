{
    "id": "4149fc03-e589-4571-af72-2dc10d7aa880",
    "created_at": "2022-10-25T16:48:10.449746Z",
    "updated_at": "2025-03-27T02:13:58.883963Z",
    "deleted_at": null,
    "sha1_hash": "9a4dcfa7178cccc6283a92bc768be1374eb347f9",
    "title": "Evasive Tactics: Terminator Rat",
    "authors": "FireEye",
    "file_creation_date": "2014-07-09T14:40:30Z",
    "file_modification_date": "2014-07-09T14:40:30Z",
    "file_size": 2523565,
    "plain_text": "### FireEye Labs has been tracking a variety of advanced persistent threat (APT) actors that have been\n\n slightly changing their tools, techniques, and procedures (TTPs) in order to evade network\n\n defenses. Earlier, we documented changes to Aumlib, the malware used in the attack against the\n\n New York Times, and Taidoor, a malware family that is being used in ongoing cyber-espionage\n\n campaigns particularly against entities in Taiwan. In this post we will explore changes made to\n\n Terminator RAT (Remote Access Tool) by examining a recent attack against entities in Taiwan.\n\n We recently analyzed a sample that we suspect was sent via spear-phishing emails to targets in\n\n Taiwan. As shown in Figure 1, the adversary sends a malicious Word document, “103.doc” (md5:\n\n a130b2e578d82409021b3c9ceda657b7), that exploits CVE-2012-0158, which subsequently drops a\n\n malware installer named “DW20.exe”. This particular malware is interesting because of the\n\n following:\n\n It evades sandbox by terminating and removing itself (DW20.exe) after installing. Malicious\n\n behavior will only appear after reboot.\n\n It deters single-object based sandbox by segregation of roles between collaborating malwares.\n\n The RAT (svchost_.exe) will collaborate with its relay (sss.exe) to communicate with the\n\n command and control server.\n\n It deters forensics investigation by changing the startup location.\n\n It deters file-based scanning that implements a maximum file size filter, by expanding the size\n\n of svchost_.exe to 40MB.\n\n The ultimate payload of the attack is Terminator RAT, which is also known as FakeM RAT. This\n\n RAT does not appear to be exclusively used by a single APT actor, but is most likely being used in a\n\n variety (of possibly otherwise unrelated) campaigns. In the past, this RAT has been used against\n\n Tibetan and Uyghur activists, and we are seeing an increasing number of attacks targeting Taiwan\n\n as well.\n\n However, these attacks use some evasive tactics that demonstrate the evolution of Terminator RAT.\n\n First, the attackers have included a component that relays traffic between the malware and a proxy\n\n server. Second, they have modified the 32-byte magic header that in previous versions attempted to\n\n disguise itself to look like either MSN Messenger, Yahoo! Messenger, or HTML code.\n\n These modifications appear to be an attempt to evade network defenses, perhaps in response to\n\n defender’s increasing knowledge of the indicators of compromise associated with this malware. We\n\n\n-----\n\n### Figure 1\n\n## 1.  DW20.exe (MD5: 7B18E1F0CE0CB7EEA990859EF6DB810C)\n\n### DW20.exe was found to be the installation executable file. It will first create its working folders\n\n located at “%UserProfile%\\Microsoft” and “%AppData%\\2019”. The former is used to store the\n\n configurations and executable files (svchost_.exe and sss.exe) and the latter is used to store the\n\n shortcut link files. This folder “2019” was then configured to be the new start up folder location by\n\n changing the registry\n\n “HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Shell\n\n Folders\\Startup” with the location of its path (see Figure 2).\n\n\n-----\n\n### Figure 2\n\n The executable file “sss.exe” was found to be the decrypted form of the resource named 140 with\n\n type “ACCELORATOR” (likely misspelling of Accelerator – see Figure 3). This resource was\n\n decrypted using customized XTEA algorithm and appended with an encrypted configuration for the\n\n domains and ports.\n\n Figure 3\n\n After installation, DW20.exe deletes and terminates itself. The malwares will only run after reboot.\n\n This is one effective way to evade sandbox automatic analysis, as malicious activity will only reveal\n\n after a reboot.\n\n## 2.  sss.exe (MD5: 93F51B957DA86BDE1B82934E73B10D9D)\n\n### sss.exe is an interesting malware component. As a researcher would analyze it independently, it is\n\n not considered a malicious program. This component plays the role as a network relay between the\n\n malware and the proxy server, by listening over port 8000. To achieve this, it first tries to identify\n\n\n-----\n\n### WinHttpGetIEProxyConfigForCurrentUser, and the discovered proxy servers and related ports\n\n are stored in the same directory in a file named “PROXY” (see Figure 4).\n\n Figure 4\n\n When there is a new incoming TCP connection over port 8000, it will attempt to create a local to\n\n proxy socket connection. With that, it will check connectivity with the CnC server. If the response is\n\n 200, it will then start to create a “relay link” between the malware and the CnC server (see Figure\n\n 5). The “relay link” was created using two threads, where one thread will transfer data from socket 1\n\n to socket 2 (see Figure 6) and the other will do vice versa.\n\n\n-----\n\n### Figure 5\n\n Figure 6\n\n\n-----\n\n### malicious traffic, as Internet Explorer 6 is significantly outdated and MSIE 6.0.1.3 is not a valid\n\n version token.\n\n Figure 7\n\n The configurations for the malicious domains and ports to use are located at the last 188 bytes of\n\n the executable file (see Figure 8). The first 16 bytes is the key (boxed in red) to decrypt the\n\n remaining content using modified XTEA algorithm (see Figure 9). The two malicious domains\n\n found were “liumingzhen.zapto.org” and “liumingzhen.myftp.org”\n\n Figure 8\n\n\n-----\n\n### Figure 9\n\n## 3.  Network Traffic\n\n### The Terminator sample we analyzed, “103.doc” (md5: a130b2e578d82409021b3c9ceda657b7) was\n\n not configured with fake HTML, Yahoo Messenger, or Windows Messenger traffic header as it had\n\n in past variants. However, the content is encrypted in exactly the same way as previous versions of\n\n Terminator RAT.\n\n Figure 10\n\n The decrypted content reveals that the malware is sending back the user name, the computer name\n\n and a campaign mark of “zjz1020”.\n\n\n-----\n\n### Figure 11\n\n This particular sample is configured to one of two command and control servers:\n\n liumingzhen.zapto.org / 123.51.208.69\n\n liumingzhen.myftp.org / 123.51.208.69\n\n We have located another malicious document that has a Taiwan-related decoy document that drops\n\n this same version of Terminator RAT.\n\n Figure 12\n\n The sample we analyzed (md5: 50d5e73ff8a0693ed2ee2d320af3b304) exploits CVE-2012-0158\n\n and has the following command and control server:\n\n\n-----\n\n### The command and control servers for both samples resolved to IP addresses in the same class C\n\n network.\n\n## 4.  Campaign Connections\n\n### In June 2013, we investigated an attack against entities in Taiwan that used spear-phishing emails\n\n to deliver a malicious attachment.\n\n Figure 13\n\n The malicious attachment “標案資料.doc” (md5: bfc96694731f3cf39bcad6e0716c5746) exploited a\n\n vulnerability in Microsoft Office (CVE-2012-0158), however, the payload in this case was a different\n\n malware family known as WinData. The malware connected to the same command and control\n\n\n-----\n\n### XYZ /WinData.DLL?HELO-STX-1*1[IP Address]*[Computer Name]*0605[MAC:[Mac Address]]$\n\n In a separate case where liumingzhen.zapto.org has been used as the command and control server,\n\n the payload was neither WinData nor Terminator RAT, but another type of malware known as\n\n Protux. The sample we analyzed in August 2012 for this case was “幹!.doc” (md5:\n\n 01da7213940a74c292d09ebe17f1bd01).\n\n This particular threat actor has access to a variety of malware families and has been using them to\n\n target entities in Taiwan for more than a year.\n\n## Conclusion\n\n### Terminator RAT is an example of how malware are increasingly becoming more sophisticated and\n\n harder to detect. There is a need for continual research to understand various techniques, tactics,\n\n and procedures used by the adversaries. Detection of exploitation and identification of anomalous\n\n callbacks are becoming extremely critical in preventing the malware from installing into the system\n\n or phoning back to the command control servers.\n\n This entry was posted in Advanced Malware, Targeted Attack, Threat Intelligence, Threat Research\n\n by Geok Meng Ong, Nart Villeneuve and Chong Rong Hwa. Bookmark the permalink.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/zesgiuff58vejn97rad0w9tt827cusg0",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.10.25.Terminator_RAT/FireEye-Terminator_RAT.pdf"
    ],
    "report_names": [
        "FireEye-Terminator_RAT"
    ],
    "threat_actors": [
        {
            "id": "71b19e59-b5f7-4bc6-816d-194be0f02af0",
            "created_at": "2022-10-25T16:07:24.301036Z",
            "updated_at": "2025-03-27T02:02:10.165121Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Budminer",
                "Earth Aughisky"
            ],
            "source_name": "ETDA:Taidoor",
            "tools": [
                "Dripion",
                "Masson",
                "Taidoor",
                "simbot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "50bd4a6c-7542-4bdd-8b37-ab468fc428ef",
            "created_at": "2023-01-06T13:46:38.998658Z",
            "updated_at": "2025-03-27T02:00:02.973354Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "G0015",
                "Earth Aughisky"
            ],
            "source_name": "MISPGALAXY:Taidoor",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "478e9b27-39b9-49e4-a3c5-81569a767275",
            "created_at": "2022-10-25T15:50:23.417339Z",
            "updated_at": "2025-03-27T02:00:55.464624Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Taidoor"
            ],
            "source_name": "MITRE:Taidoor",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1404916830,
    "ts_modification_date": 1404916830,
    "files": {
        "pdf": "https://archive.orkl.eu/9a4dcfa7178cccc6283a92bc768be1374eb347f9.pdf",
        "text": "https://archive.orkl.eu/9a4dcfa7178cccc6283a92bc768be1374eb347f9.txt",
        "img": "https://archive.orkl.eu/9a4dcfa7178cccc6283a92bc768be1374eb347f9.jpg"
    }
}