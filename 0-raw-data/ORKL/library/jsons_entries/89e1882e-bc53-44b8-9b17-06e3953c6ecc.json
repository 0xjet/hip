{
    "id": "89e1882e-bc53-44b8-9b17-06e3953c6ecc",
    "created_at": "2023-01-12T15:04:53.455292Z",
    "updated_at": "2025-03-27T02:16:01.207263Z",
    "deleted_at": null,
    "sha1_hash": "2fbd2a91a7ba85dc6439b7cc6ac516b33c14e3c9",
    "title": "2018-10-14 - Godzilla Loader and the Long Tail of Malware",
    "authors": "",
    "file_creation_date": "2022-05-28T02:37:16Z",
    "file_modification_date": "2022-05-28T02:37:16Z",
    "file_size": 621531,
    "plain_text": "# Godzilla Loader and the Long Tail of Malware\n\n**[research.checkpoint.com/godzilla-loader-and-the-long-tail-of-malware/](https://research.checkpoint.com/godzilla-loader-and-the-long-tail-of-malware/)**\n\nOctober 14, 2018\n**Research by: Ben Herzog**\n\n\nOctober 15, 2018\n\n\nTo most victims, malware is a force of nature. Zeus, Wannacry, Conficker are all vengeful\ngods, out to punish the common man for clicking the wrong link. Even for a security analyst,\nit’s easy to fall into the kind of thinking where malicious tools and campaigns emerge out of\nthe ether, forged by an invisible hand. But of course, that’s not true; the world of cybercrime\nis a fully-formed market, with its own advertisements, discounts, brands, information\nasymmetries, established vendors and disruptive neophytes. In this day and age, you can\nassemble a malicious campaign via a shopping list with a fraction of the technical knowledge\nthat was once required.\n\nEnter Godzilla Loader, a malware being advertised on Dark Web forums, and being actively\ndeveloped right now. Godzilla fills the “downloader” or “dropper” niche, offering a level of\nindirection such that the binary that first runs on the victim machine does not contain any of\n\n\n-----\n\nthe actual payload, and instead downloads the payload from a remote server. Godzilla is\nactively maintained, with new features being added periodically, and retails for $500, around\na quarter of the asking price of its better-established competitor, [Emotet.](https://research.checkpoint.com/emotet-tricky-trojan-git-clones/)\n\n**Figure 1: Web panel of Godzilla Loader**\n\n**Godzilla Features and What They Are For**\n\nTo get you in the right mindset for considering Godzilla vs. Emotet, here’s our own\ndownloader, written in Python:\n\nWe graciously charge $0 for this piece of code, which is really more like a haiku. It should\nnow be clear why downloaders such as Godzilla justify their price tag not by their core\nfunctionality (of downloading and execution), but by their shiny list of impressive-sounding\nfeatures. Godzilla’s full advertisement opens as follows:\n\n\n-----\n\n_The opening of the Godzilla Loader ad. This is followed by the list of features and version_\n_history._\n\nAccording to our investigation, this marketing effort is running into difficulties. We’ve tried\nvarious methods of measuring the number of victims that get hit by Godzilla Loader each\nday, and all those methods agree that the answer is “not that many”. Even accounting for\npossible blind spots, the infection rate is almost certainly a tiny fraction compared to the\nnumbers for Emotet.\n\nEmotet’s top three features are its lateral movement, its abuse of third-party libraries and its\nwonky control flow. To better understand how Godzilla Loader’s top features fare in\ncomparison, we’ll look at some of the highlights from the brochure.\n\n**Bypassing the UAC not-a-security-boundary**\n\nEarly MS-Windows had little in the way of access control, and UAC was introduced in\nWindows Vista as a stop-gap measure to remedy this. You are probably familiar with the\ndialogue box prompt that informs you that this-or-another process “wants to make changes\nto your computer”, which is a layman’s translation for “wants to have administrator\nprivileges”. UAC originally achieved infamy for driving early Vista adopters out of their minds\nwith constant prompts that froze the entire rest of the screen and stole focus from all other\napplications.\n\nSince UAC’s debut, its user interface has seen major improvement, but the same cannot be\nsaid for its ability to get in the way of malicious actors. While UAC did present a certain\nbarrier to entry for malware (for example) turning off your AV product, that barrier turned out\nto be surmountable, with some effort. If you want an idea of what we mean by that, consider\nthe [UACME github repository, maintined by infosec personality @hFireF0X; the repository is](https://github.com/hfiref0x/UACME/tree/master/Source)\nan educational exhibit which currently lists over 50(!) different attack vectors for bypassing\n\n\n-----\n\nUAC and their corresponding implementations. The battle for UAC as a fully robust security\nfeature has long since been lost. It was nearly a decade ago that Microsoft sighed and\n[declared that UAC is not a Security Boundary.](https://blogs.msdn.microsoft.com/e7/2009/02/05/update-on-uac/)\n\nAs alluded to in the ad, Godzilla loader comes with a built-in UAC bypass — to be specific,\n[the one described here. This UAC bypass relies on a behavioral quirk in the privileged](https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/)\nprocess eventvwr.exe; when consulting the registry for the location of the Microsoft\nManagement Console, it consults a key which can be modified with no privilege\nrequirements. An attacker can therefore specify whichever executable they please, and this\nexecutable will run with administrator privileges. (Let’s not get into the icky discussion of\nwhether this can be classified as a “bug” or a “feature” or a “vulnerability” or what, and agree\nthat this is a Bad Thing).\n\n_Manifest of eventvwr.exe, including auto-elevate request._\n\n**When all you have is an IUNKNOWN interface, everything looks like a COM Object**\n\nIf you come away from this piece remembering only one thing about Godzilla Loader,\nremember that it has a borderline-obsession with COM objects.\n\nConsider the problem of network communication with the C&C server. Garden-variety\nmalware will use the WinInet API (e.g. HTTPSendRequest, InternetCrackURL…) to perform\nthis communication, or maybe it would go the socket programming route and directly invoke\nws2_32 for stealth of for implementing a homebrew protocol on top of TCP. Instead, Godzilla\nLoader:\n\n1. Calls CreateWindowEx to create a 0x0 pixel window belonging to the AtlaxWin class\n2. Uses the window’s built-in IUnknown COM interface to invoke the QueryInterface\n\nmethod, which is used to request a IWebBrowser2 COM interface to the window\n3. Invokes the IWebBrowser2 COM interface’s Navigate method on the C&C URL\n\n\n-----\n\n4. Polls the window using the IWebBrowser2 COM interface s get_ReadyState method\n\nuntil the window resports a ‘ready’ state\n5. Retrieves the downloaded document using the IWebBrowser2 COM interface’s\n\nget_Document method\n6. Requests an IHTMLDocument3 COM interface to the document by using the IUnknown\n\nCOM interface to invoke QueryInterface\n7. Calls the IHTMLDocument3 COM interface’s getElementsByName method in order to\n\ncollect the payloads in the server response, which are enclosed by element tags; this\nreturns a collection of elements which is accessible by the COM interface\nIHTMLElementCollection\n8. Drains the IHTMLElementCollection COM interface’s underlying iterator by repeated\n\ncalls to its built-in item method\n9. Requests a IHTMLElement COM interface to each HTML element by using the\n\nIUnknown COM interface to invoke QueryInterface\n10. Invokes the IHTMLElement COM interface’s get_innerText method in order to collect\n\nthe data enclosed by the tag\n\nThis functionality was already present in earlier versions of Godzilla. In later versions, the\nauthor boasts that they have converted even more of the control flow to rely entirely on COM\ninterfaces; persistence is achieved via the IPresistFile interface and shell executions of\nprograms on the local disk are triggered via the IShellDispatch interface.\n\n_Godzilla’s first request for a COM interface, among very many._\n\nThis is a highly unusual stylistic choice, and all the more notable for the consistency across\nthe malware’s core features. By taking this route, the author of Godzilla Loader diminishes\nthe chances of the downloader being caught by behavioral sandbox analysis, and gives his\ncreation some flair that might help it stand out from the competition.\n\n**Ransomware Housekeeping as a Service**\n\n\n-----\n\nOne other feature that caught our eye in particular is the automatic deletion of file backup\nshadow copies on the victim system. For most types of malicious campaigns, this feature\nwon’t make a difference one way or the other; the only possible reason for it being there is to\nfoil a very specific anti-Ransomware measure which operates by recovering the original files\nfrom the shadow file backups.\n\nTo begin with, “recover the shadow files” sits relatively low on the totem pole of antiRansomware attacks. On top of that, the vast majority of ransomware will come with this\n[feature built-in; while ransomware authors typically aren’t brilliant cryptographic minds, they](https://blog.checkpoint.com/wp-content/uploads/2016/10/GreatCryptoFailuresWhitepaper_Draft2.pdf)\n_have picked up the basics, and the basics have come to include “make sure to delete the_\nshadow files”. Only the lowliest-tier of low-tier ransomware efforts fail to check this tick-box.\n\nWho’s the target audience for this feature? That’s a very good question.\n\n**More Feature Highlights**\n\nGodzilla loader employs RSA-2048 to verify the identity of the C&C server — that is,\nthe server response is signed, and the client verifies the signature before acting on the\nserver’s orders. In the event of a DNS-level takeover of the C&C domain, the malicious\noperation will be down but the domain’s new owner will not be able to issue new\ncommands. It’s a neat little feature, but just a teaser for the full hypothetical power of\nasymmetric crypto in this context; mostly it makes us think, “God help us all if the\ningenuity that produced TOR ever goes into the malware business”.\nIn the feature list, the author boasts of a double-layered fail-safe for C&C\ncommunication. First, if communication with the server is not successful, the malware\ndefaults to its DGA implementation; then, if that’s not successful, either, it checks\nTwitter for a specific hashtag (which is pseudo-randomly generated depending on the\nday, similarly to the DGA). The campaign controller can announce new C&C sites by\ngenerating the hashtag themselves and tweeting the new C&C domain with this\nhashtag.\nThe latest major version of Godzilla, which has been in development as early as\nDecember of last year, is set to include a full plugin Ecosystem — including a\npropagation module, keylogger module and password stealing module.\n\n**Conclusion**\n\nAt first glance, the existence and adoption rate of Godzilla both seem to be a simple example\n[of the principle of the Long Tail. Like mobile phone models and programming languages, we](https://en.wikipedia.org/wiki/Long_tail)\n[expect the popularity of malicious downloaders to follow a Pareto distribution where a few](https://en.wikipedia.org/wiki/Pareto_principle)\nactors dominate most of the market, and the rest is occupied by an ocean of small niche\nactors. That’s definitely a part of the story, but not all of it. It beggars belief that a sane,\ntransparent market built of fully rational actors would give birth to these two wildly divergent,\n\n\n-----\n\narbitrarily-priced grab-bags of partially-superfluous features, both aimed at exactly the same\ntarget audience with exactly the same needs, with the apparently arbitrary asking price ratio\nof 1:4 between them.\n\nThis state of affairs becomes much more understandable once we assume that many\ncampaign managers don’t operate based on an explicit model of malware vs. security at all,\nbut rather on the general knowledge that more obfuscation and better features will shield\nthem from security vendors’ scrutiny. “Without a threat model, there is no security, only\nparanoia” — this is equally applicable from the attackers’ point of view, and in a market of\nparanoia, brand recognition holds great sway. Emotet’s feature set isn’t literally worth four\ntimes as much as Godzilla’s; it’s worth either much more or much less than that, depending\non who you are and what your needs are, as a dastardly cybercriminal. But Emotet’s brand is\nworth about four times as much as Godzilla’s, or at least that’s the case according to their\nrespective authors’ estimates.\n\nEvery now and then, an incident response team will quizically stare at a sandbox report,\nfurrow their brow and say, “What is that”. When they furrow their brow, that’s when you know\nyou got hit with a contender from the Long Tail of Malware. Your sysadmin may be horrified,\nbut somewhere out there, some dark-web dweller is thrilled to finally have a customer.\n\n**Signature and Prevention**\n\nThe following Check Point Products detect the Godzilla Downloader:\n\n**Anti-Bot:Win32.Godzilla.A**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-10-14 - Godzilla Loader and the Long Tail of Malware.pdf"
    ],
    "report_names": [
        "2018-10-14 - Godzilla Loader and the Long Tail of Malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535893,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1653705436,
    "ts_modification_date": 1653705436,
    "files": {
        "pdf": "https://archive.orkl.eu/2fbd2a91a7ba85dc6439b7cc6ac516b33c14e3c9.pdf",
        "text": "https://archive.orkl.eu/2fbd2a91a7ba85dc6439b7cc6ac516b33c14e3c9.txt",
        "img": "https://archive.orkl.eu/2fbd2a91a7ba85dc6439b7cc6ac516b33c14e3c9.jpg"
    }
}