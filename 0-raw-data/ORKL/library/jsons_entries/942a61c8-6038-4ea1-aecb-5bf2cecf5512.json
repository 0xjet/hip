{
    "id": "942a61c8-6038-4ea1-aecb-5bf2cecf5512",
    "created_at": "2023-01-12T15:08:23.169828Z",
    "updated_at": "2025-03-27T02:05:18.498139Z",
    "deleted_at": null,
    "sha1_hash": "543f83f7509a0ad1d44d4775875f7e66bbbf04e4",
    "title": "2018-06-01 - Satan Ransomware Spawns New Methods to Spread",
    "authors": "",
    "file_creation_date": "2022-05-28T18:58:22Z",
    "file_modification_date": "2022-05-28T18:58:22Z",
    "file_size": 1089284,
    "plain_text": "# Satan Ransomware Spawns New Methods to Spread\n\n**[alienvault.com/blogs/labs-research/satan-ransomware-spawns-new-methods-to-spread](https://www.alienvault.com/blogs/labs-research/satan-ransomware-spawns-new-methods-to-spread)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nJune 1, 2018 | [Javier Ruiz](https://www.alienvault.com/blogs/author/javier-ruiz)\nToday, we are sharing an example of how previously known malware keeps evolving and\nadding new techniques to infect more systems.\n\n[BleepingComputer first reported on Satan ransomware in January 2017. Recently, Satan](https://www.bleepingcomputer.com/news/security/new-satan-ransomware-available-through-a-ransomware-as-a-service-/)\nRansomware was identified as using the EternalBlue exploit to spread across compromised\n[environments (BartBlaze’s blog). This is the same exploit associated with a previous](https://bartblaze.blogspot.com.es/2018/04/satan-ransomware-adds-eternalblue.html)\nWannaCry Ransomware campaign. While Microsoft patched the vulnerability associated with\nEternalBlue in March 2017, many environments remain vulnerable.\n\nUnusually, we’ve identified samples of Satan Ransomware that not only include\nEternalBlue,but also a far larger set of propagation methods:\n\nThis Satan variant attempts to propagate through:\n\nJBoss CVE-2017-12149\nWeblogic CVE-2017-10271\nEternalBlue exploit CVE-2017-0143\nTomcat web application brute forcing\n\n\n-----\n\n## Malware Analysis\n\nBelow is a sample from early May 2018 of Satan Ransomware using all the previously\nmentioned techniques, which we are going to analyze.\n\nName: sts.exe\n\nFile size: 1.7 Mb\n\nMD5: [c290cd24892905fbcf3cb39929de19a5](https://www.virustotal.com/#/file/3e3f8570c11dff0b5a0e061eae6bdd66cf9fa01d815658a0589d98873500358d)\n\nThe first thing we see in the analyzed sample is that the malware was packed with the\nMPRESS packer:\n\nThe main goal of this sample is to drop Satan Ransomware,encrypt the victim's host, and\nthen request a Bitcoin payment. Afterwards, the sample will also try to spread in the network\nusing exploits such as EternalBlue.\n\n## EternalBlue\n\nThe malware drops several EternalBlue files in the victim’s host. These files are a public\nversion of the exploit without any modifications or custom implementations. All are dropped\nin the folder C:UsersAll Users in the infected system:\n\n\n-----\n\nSts.exe initiates the process of spreading across the network by scanning all the systems\nwithin the same network segment. Through the following command line, systems vulnerable\nto SMB EternalBlue exploit will execute the previously dropped library down64.dll.\n\nThe down64.dll attempts to load code in the target’s memory, and then downloads sts.exe,\nusing the legitimate Microsoft certutil.exe tool. This is a known download technique\n[described as Remote File Copy - T1105 in Mitre ATT&CK.](https://attack.mitre.org/wiki/Technique/T1105)\n\n\n-----\n\n## So Many Exploits....\n\nThe sample uses some other network activity to continue to spread across the network.\n\nA compromised system will make a HTTP PUT request to /Clist1.jsp to execute a jsp file that\ndownloads another sample of sts.exe in the target server.\n\nAnother interesting technique used to infect other systems is the ability to identify an Apache\nTomcat server and bruteforce it. It makes an HTTP GET request to /manager/html, and if the\nresponse is “401 not authorized,” it then begins to bruteforce access to the file, using a list of\nmost common usernames and passwords:\n\n## Encryption\n\nAfter infecting other systems in the same network, the sample finally drops Satan\nRansomware into C:Satan.exe file. This executable is also packed with MPRESS as the\noriginal sample.\n\n\n-----\n\nExecuting Satan.exe starts the ransomware attack, which first stops the following processes:\n\nSatan.exe creates a file named KSession located in “C:WindowsTempKSession” and stores\na host identifier inside it.\n\nEncrypted files are renamed with [satan_pro@mail.ru]..satan file name. Then the process\nstarts sending data to the Command and Control server, making GET requests using the\nparameter value stored in KSession file.\n\nGET /data/token.php?status=ST&code=XXXXXXXXXXXXXXXXXXXXXXXXX HTTP/1.1\nConnection: Keep-Alive\n\nUser-Agent: Winnet Client\n\nHost: 45.124.132.119\n\nAfter encryption, Satan.exe creates a note in C:_How_to_decrypt_files.txt with instructions,\nand then executes notepad to open the note.\n\n\n-----\n\nThe note contains the instructions to decrypt the system and a contact email address:\nsatan_pro@mail[.]ru, requesting a Bitcoin payment as seen below in a sample of the note:\n\nTracking the previously mentioned Bitcoin wallet:\n\n14hCK6iRXwRkmBFRKG8kiSpCSpKmqtH2qo, has only received a handful of payments so\nfar, with the latest payment made on May 12, 2018. It has a balance of 0.5 BTC, worth\napproximately $3600 at the time of writing.\n\n## Conclusion\n\n\n-----\n\nIt s a worrying trend that ransomware isn t going away, and it is adapting to include the recent\nand diverse exploits/techniques to spread in more innovative and successful ways.\n\n## Detect Satan Ransomware with AlienVault USM\n\nBecause threats like Satan Ransomware are constantly evolving with new methods, it’s\ncritical that your detection tools always have the latest threat intelligence. AlienVault USM\nreceives continuous threat intelligence updates from the AlienVault Labs Security Research\nTeam and OTX. Using multiple built-in security capabilities, AlienVault USM detect many\ncommon behaviours of malware that change less frequently. The techniques used to spread\nSatan ransomware will trigger the following alarms in AlienVault USM:\n\nSystem Compromise - Suspicious Behavior - OTX Indicators of Compromise\nDelivery & Attack - Suspicious Behavior - Certutil.exe used to download a file\nDelivery & Attack - Vulnerability Scanning - JBoss Scan\nSystem Compromise - Suspicious Behavior - Command executed from an Oracle\nWebLogic process\n\nAnd also the following network activity:\n\nWeblogic XMLDecoder RCE (CVE-2017-10271) - Exploit - Code Execution\nTomcat Server - Environmental Awareness - Default Credentials\nPossible ETERNALBLUE Exploit M3 MS17-010 - Exploit - Code Execution ETERNALBLUE\nSatan Ransomware - System Compromise - Ransomware infection\n\n## Detect Satan Ransomware with OTX Endpoint Threat Hunter\n\nYou can hunt for malware and other threats for free using the OTX Endpoint Threat\nHunter.This free service uses the indicators of compromise (IOCs) catalogued in OTX,\nenabling you to scan for threats on your endpoints. OTX Endpoint Threat Hunter detects\nSatan through:\n\nFile and Network based indicators (below, and in [OTX)](https://otx.alienvault.com/pulse/5ae76e6a0009fd0d0acea525)\nGeneric detection of exploits.\n\n## Detection - Indicators of Compromise\n\nFile-Hashes:\n\n3e3f8570c11dff0b5a0e061eae6bdd66cf9fa01d815658a0589d98873500358d\n\n15ffbb8d382cd2ff7b0bd4c87a7c0bffd1541c2fe86865af445123bc0b770d13\n\nb556b5c077e38dcb65d21a707c19618d02e0a65ff3f9887323728ec078660cc3\n\n\n-----\n\n15292172a83f2e7f07114693ab92753ed32311dfba7d54fe36cc7229136874d9\n\n0439628816cabe113315751e7113a9e9f720d7e499ffdd78acbac1ed8ba35887\n\n93027b47ef0b6f7d933017320951bbbeef792a8f1bc43b3fe96c2b61f1dc2636\n\ncde45f7ff05f52b7215e4b0ea1f2f42ad9b42031e16a3be9772aa09e014bacdb\n\n85b936960fbe5100c170b777e1647ce9f0f01e3ab9742dfc23f37cb0825b30b5\n\nca63dbb99d9da431bf23aca80dc787df67bb01104fb9358a7813ed2fce479362\n\ndb0831e19a4e3a736ea7498dadc2d6702342f75fd8f7fbae1894ee2e9738c2b4\n\naa8adf96fc5a7e249a6a487faaf0ed3e00c40259fdae11d4caf47a24a9d3aaed\n\nbe8eb97d8171b8c91c6bc420346f7a6d2d2f76809a667ade03c990feffadaad5\n\n0259d41720f7084716a3b2bbe34ac6d3021224420f81a4e839b0b3401e5ef29f\n\n50f329e034db96ba254328cd1e0f588af6126c341ed92ddf4aeb96bc76835937\n\naceb27720115a63b9d47e737fd878a61c52435ea4ec86ba8e58ee744bc85c4f3\n\ncf25bdc6711a72713d80a4a860df724a79042be210930dcbfc522da72b39bb12\n\nb7d8fcc3fb533e5e0069e00bc5a68551479e54a990bb1b658e1bd092c0507d68\n\nb2a3172a1d676f00a62df376d8da805714553bb3221a8426f9823a8a5887daaa\n\nf0df80978b3a563077def7ba919e2f49e5883d24176e6b3371a8eef1efe2b06a\n\n5f30aa2fe338191b972705412b8043b0a134cdb287d754771fc225f2309e82ee\n\ncf12eca0e10dc3370d7917e7678dc09629240d3e7cc71c5ac0df68576bea0682\n\n### IP Addresses:\n\n45.124.132.119\n\n### URI paths:\n\n/invoker/readonly\n\n/orders.xhtml\n\n/Clist1.jsp\n\n/manager/html\n\n\n-----\n\n/wls-wsat/CoordinatorPortType\n\n**_Thanks to Fernando Martinez and Chris Doman for collaborations._**\n\n### Share this with others\n\nTags: [malware,](https://www.alienvault.com/blogs/tag/malware) [ransomware,](https://www.alienvault.com/blogs/tag/ransomware) [alienvault labs,](https://www.alienvault.com/blogs/tag/alienvault+labs) [satan](https://www.alienvault.com/blogs/tag/satan)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-06-01 - Satan Ransomware Spawns New Methods to Spread.pdf"
    ],
    "report_names": [
        "2018-06-01 - Satan Ransomware Spawns New Methods to Spread.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536103,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1653764302,
    "ts_modification_date": 1653764302,
    "files": {
        "pdf": "https://archive.orkl.eu/543f83f7509a0ad1d44d4775875f7e66bbbf04e4.pdf",
        "text": "https://archive.orkl.eu/543f83f7509a0ad1d44d4775875f7e66bbbf04e4.txt",
        "img": "https://archive.orkl.eu/543f83f7509a0ad1d44d4775875f7e66bbbf04e4.jpg"
    }
}