{
    "id": "20a621b8-d152-46c8-afc1-d4fdb73460ce",
    "created_at": "2023-01-12T15:03:49.843581Z",
    "updated_at": "2025-03-27T02:08:40.309205Z",
    "deleted_at": null,
    "sha1_hash": "e6044d55984b949d581625c4f376014f9a681a33",
    "title": "2022-09-06 - Mirai Variant MooBot Targeting D-Link Devices",
    "authors": "",
    "file_creation_date": "2022-10-02T12:09:10Z",
    "file_modification_date": "2022-10-02T12:09:10Z",
    "file_size": 1068981,
    "plain_text": "# Mirai Variant MooBot Targeting D-Link Devices\n\n**unit42.paloaltonetworks.com/moobot-d-link-devices/**\n\nChao Lei, Zhibin Zhang, Cecilia Hu, Aveek Das September 6, 2022\n\nBy [Chao Lei,](https://unit42.paloaltonetworks.com/author/chao-lei/) [Zhibin Zhang,](https://unit42.paloaltonetworks.com/author/zhibin-zhang/) [Cecilia Hu and](https://unit42.paloaltonetworks.com/author/mengying-hu/) [Aveek Das](https://unit42.paloaltonetworks.com/author/aveek-das/)\n\nSeptember 6, 2022 at 6:00 AM\n\n[Category: Malware,](https://unit42.paloaltonetworks.com/category/malware-2/) [Vulnerability](https://unit42.paloaltonetworks.com/category/vulnerability/)\n\nTags: [CVE-2015-2051,](https://unit42.paloaltonetworks.com/tag/cve-2015-2051/) [CVE-2018-6530,](https://unit42.paloaltonetworks.com/tag/cve-2018-6530/) [CVE-2022-26258,](https://unit42.paloaltonetworks.com/tag/cve-2022-26258/) [CVE-2022-28958,](https://unit42.paloaltonetworks.com/tag/cve-2022-28958/) [IoT,](https://unit42.paloaltonetworks.com/tag/iot/) [Mirai,](https://unit42.paloaltonetworks.com/tag/mirai/) [MooBot,](https://unit42.paloaltonetworks.com/tag/moobot/) [SOHO](https://unit42.paloaltonetworks.com/tag/soho/)\n\nThis post is also available in: 日本語 [(Japanese)](https://unit42.paloaltonetworks.jp/moobot-d-link-devices/)\n\n## Executive Summary\n\nIn early August, Unit 42 researchers discovered attacks leveraging several vulnerabilities in devices made by DLink, a company that specializes in network and connectivity products. The vulnerabilities exploited include:\n\n[CVE-2015-2051: D-Link HNAP SOAPAction Header Command Execution Vulnerability](https://nvd.nist.gov/vuln/detail/CVE-2015-2051)\n[CVE-2018-6530: D-Link SOAP Interface Remote Code Execution Vulnerability](https://nvd.nist.gov/vuln/detail/CVE-2018-6530)\n[CVE-2022-26258: D-Link Remote Command Execution Vulnerability](https://nvd.nist.gov/vuln/detail/CVE-2022-26258)\n[CVE-2022-28958: D-Link Remote Command Execution Vulnerability](https://nvd.nist.gov/vuln/detail/CVE-2022-28958)\n\nIf the devices are compromised, they will be fully controlled by attackers, who could utilize those devices to conduct\nfurther attacks such as distributed denial-of-service (DDoS) attacks. The exploit attempts captured by Unit 42\nresearchers leverage the aforementioned vulnerabilities to spread MooBot, a Mirai variant, which targets exposed\nnetworking devices running Linux.\n\nWhile D-Link has published security bulletins regarding all the vulnerabilities mentioned here, some users may be\nrunning unpatched or older versions or devices. Unit 42 strongly recommends applying upgrades and patches\nwhere possible.\n\n[Palo Alto Networks Next-Generation Firewall customers receive protections through cloud-delivered security](https://www.paloaltonetworks.com/network-security/next-generation-firewall)\nservices such as IoT Security, Advanced Threat Prevention, WildFire and Advanced URL Filtering, which can\ndetect and block the exploit traffic and malware.\n\n\n-----\n\nRelated Unit 42 Topics [IoT,](https://unit42.paloaltonetworks.com/tag/iot/) [Mirai](https://unit42.paloaltonetworks.com/tag/mirai-variant/)\n\n## Table of Contents\n\nCampaign Overview\n\nExploited Vulnerabilities\n\nD-Link Exploit Payloads\n\nMalware Analysis\n\nConclusion\n\nIndicators of Compromise\n\nAdditional Resources\n\n## Campaign Overview\n\nThe whole attack process is shown in Figure 1.\n\nFigure 1. Campaign overview.\n\n## Exploited Vulnerabilities\n\nFour known vulnerabilities were exploited in this attack. Upon successful exploitation, the wget utility executes to\ndownload MooBot samples from the malware infrastructure and then executes the downloaded binaries.\nVulnerability-related information is shown in Table 1.\n\n**ID** **Vulnerability** **Description** **Severity**\n\n\n1 CVE-20152051\n\n2 CVE-20186530\n\n3 CVE-202226258\n\n4 CVE-202228958\n\n\nD-Link HNAP SOAPAction Header Command Execution\nVulnerability\n\n\nD-Link SOAP Interface Remote Code Execution Vulnerability CVSS Version 3.0: 9.8\nCritical\n\nD-Link Remote Command Execution Vulnerability CVSS Version 3.0: 9.8\nCritical\n\nD-Link Remote Command Execution Vulnerability CVSS Version 3.0: 9.8\nCritical\n\n\nCVSS Version 2.0: 10.0\nHigh\n\n\n-----\n\n_Table 1. List of exploited vulnerabilities._\n\n## D-Link Exploit Payloads\n\nThe attacker utilizes four D-Link vulnerabilities that could lead to remote code execution and download a MooBot\ndownloader from host 159.203.15[.]179.\n\n**1. CVE-2015-2051: D-Link HNAP SOAPAction Header Command Execution Vulnerability**\n\nFigure 2. CVE-2015-2051 exploit payload.The exploit targeting the older D-Link routers takes advantage of\nvulnerabilities in the HNAP SOAP interface. An attacker can perform code execution through a blind OS command\ninjection.\n\n**2. CVE-2018-6530: D-Link SOAP Interface Remote Code Execution Vulnerability**\n\nFigure 3. CVE-2018-6530 exploit payload.The exploit works due to the older D-Link router's unsanitized use of the\n“service” parameters in requests made to the SOAP interface. The vulnerability can be exploited to allow\nunauthenticated remote code execution.\n\n**3. CVE-2022-26258: D-Link Remote Code Execution Vulnerability**\n\n\n-----\n\nFigure 4. CVE-2022-26258 exploit payload.The exploit targets a command injection vulnerability in the /lan.asp\ncomponent. The component does not successfully sanitize the value of the HTTP parameter DeviceName, which in\nturn can lead to arbitrary command execution.\n\n**4. CVE-2022-28958: D-Link Remote Code Execution Vulnerability**\n\nFigure 5. CVE-2022-28958 exploit payload.The exploit targets a remote command execution vulnerability in the\n/shareport.php component. The component does not successfully sanitize the value of the HTTP parameter value,\nwhich can lead to arbitrary command execution.\n\n## Malware Analysis\n\nAll the artifacts related to this attack are shown in the following table:\n\n\n**File**\n**Name**\n\n\n**SHA256** **Description**\n\n\n-----\n\nrt B7EE57A42C6A4545AC6D6C29E1075FA1628E1D09B8C1572C848A70112D4C90A1 A script\ndownloader.\nIt downloads\nMooBot onto\nthe\ncompromised\nsystem and\nrenames the\nbinary files to\nRealtek.\n\nwget[.]sh 46BB6E2F80B6CB96FF7D0F78B3BDBC496B69EB7F22CE15EFCAA275F07CFAE075 The script\ndownloader.\nIt downloads\nMooBot onto\nthe\ncompromised\nsystem, and\nrenames the\nbinary files to\nAndroid.\n\narc 36DCAF547C212B6228CA5A45A3F3A778271FBAF8E198EDE305D801BC98893D5A MooBot\nexecutable\nfile.\n\narm 88B858B1411992509B0F2997877402D8BD9E378E4E21EFE024D61E25B29DAA08 MooBot\nexecutable\nfile.\n\narm5 D7564C7E6F606EC3A04BE3AC63FDEF2FDE49D3014776C1FB527C3B2E3086EBAB MooBot\nexecutable\nfile.\n\narm6 72153E51EA461452263DBB8F658BDDC8FB82902E538C2F7146C8666192893258 MooBot\nexecutable\nfile.\n\narm7 7123B2DE979D85615C35FCA99FA40E0B5FBCA25F2C7654B083808653C9E4D616 MooBot\nexecutable\nfile.\n\ni586 CC3E92C52BBCF56CCFFB6F6E2942A676B3103F74397C46A21697B7D9C0448BE6 MooBot\nexecutable\nfile.\n\ni686 188BCE5483A9BDC618E0EE9F3C961FF5356009572738AB703057857E8477A36B MooBot\nexecutable\nfile.\n\nmips 4567979788B37FBED6EEDA02B3C15FAFE3E0A226EE541D7A0027C31FF05578E2 MooBot\nexecutable\nfile.\n\nmipsel 06FC99956BD2AFCEEBBCD157C71908F8CE9DDC81A830CBE86A2A3F4FF79DA5F4 MooBot\nexecutable\nfile.\n\nsh4 4BFF052C7FBF3F7AD025D7DBAB8BD985B6CAC79381EB3F8616BEF98FCB01D871 MooBot\nexecutable\nfile.\n\n\n-----\n\nx86_64 4BFF052C7FBF3F7AD025D7DBAB8BD985B6CAC79381EB3F8616BEF98FCB01D871 MooBot\nexecutable\nfile.\n\n_Table 2. Attack-related artifacts._\n\nUnit 42 researchers conducted analysis on the downloaded malware sample. Based on its behavior and patterns,\nwe believe that the malware samples that were hosted on 159.203.15[.]179 relate to a variant of the Mirai botnet\ncalled MooBot.\n\nFigure 6. MooBot random string generator.\nThe most obvious feature of MooBot is the executable file containing the string\nw5q6he3dbrsgmclkiu4to18npavj702f, which will be used to generate random alphanumeric strings.\n\nUpon execution, the binary file prints get haxored! to the console, spawns processes with random names and wipes\nout the executable file.\n\nFigure 7. MooBot creates processes.\nAs a variant, MooBot inherits Mirai’s most significant feature – a data section with embedded default login\ncredentials and botnet configuration – but instead of using Mirai’s encryption key, 0xDEADBEEF, MooBot encrypts\nits data with 0x22.\n\n\n-----\n\nFigure 8. MooBot configuration decode function.\nAfter decoding its C2 server vpn.komaru[.]today from configuration, MooBot will send out a message to inform the\nC2 server that a new MooBot is online. The message starts with the hardcoded magic value 0x336699.\n\nAt the time of our analysis, the C2 server was offline. According to the code analysis, MooBot will also send\nheartbeat messages to the C2 server and parse commands from C2 to start a DDoS attack on a specific IP address\nand port number.\n\n## Conclusion\n\nThe vulnerabilities mentioned above have low attack complexity but critical security impact that can lead to remote\ncode execution. Once the attacker gains control in this manner, they could take advantage by including the newly\ncompromised devices into their botnet to conduct further attacks such as DDoS.\n\nTherefore, we strongly recommend applying patches and upgrades when possible.\n\nPalo Alto Networks customers receive protections from the vulnerability and malware through the following products\nand services:\n\nNext-Generation Firewalls with a Threat Prevention security subscription can block the attacks with Best\n[Practices via Threat Prevention signatures 38600,](https://threatvault.paloaltonetworks.com/?query=38600) [92960,](https://threatvault.paloaltonetworks.com/?query=92960) [92959 and](https://threatvault.paloaltonetworks.com/?query=92959) [92533.](https://threatvault.paloaltonetworks.com/?query=92533)\n[WildFire can stop the malware with static signature detections.](https://www.paloaltonetworks.com/products/secure-the-network/wildfire)\nThe Palo Alto Networks IoT security platform can leverage network traffic information to identify the vendor,\nmodel and firmware version of a device and identify specific devices that are vulnerable to the aforementioned\nCVEs.\n[Advanced URL Filtering and](https://www.paloaltonetworks.com/network-security/advanced-url-filtering) [DNS Security are able to block the C2 domain and malware hosting URLs.](https://www.paloaltonetworks.com/network-security/dns-security)\nIn addition, [IoT Security has an inbuilt machine learning-based anomaly detection that can alert the customer](https://www.paloaltonetworks.com/network-security/iot-security)\nif a device exhibits non-typical behavior, such as a sudden appearance of traffic from a new source, an\nunusually high number of connections or an inexplicable surge of certain attributes typically appearing in IoT\napplication payloads.\n\n## Indicators of Compromise\n\n### Infrastructure\n\n**MooBot C2**\n\n\n-----\n\nvpn.komaru[.]today\n\n**Malware Host**\n\nhttp://159.203.15[.]179/wget.sh\n\nhttp://159.203.15[.]179/wget.sh3\n\nhttp://159.203.15[.]179/mips\n\nhttp://159.203.15[.]179/mipsel\n\nhttp://159.203.15[.]179/arm\n\nhttp://159.203.15[.]179/arm5\n\nhttp://159.203.15[.]179/arm6\n\nhttp://159.203.15[.]179/arm7\n\nhttp://159.203.15[.]179/sh4\n\nhttp://159.203.15[.]179/arc\n\nhttp://159.203.15[.]179/sparc\n\nhttp://159.203.15[.]179/x86_64\n\nhttp://159.203.15[.]179/i686\n\nhttp://159.203.15[.]179/i586\n\n### Artifacts\n\n**Shell Script Downloader**\n\n**Filename** **SHA256**\n\nrt B7EE57A42C6A4545AC6D6C29E1075FA1628E1D09B8C1572C848A70112D4C90A1\n\nwget[.]sh 46BB6E2F80B6CB96FF7D0F78B3BDBC496B69EB7F22CE15EFCAA275F07CFAE075\n\n_Table 3. Shell script downloader._\n\n**MooBot Sample**\n\n**Filename** **SHA256**\n\narc 36DCAF547C212B6228CA5A45A3F3A778271FBAF8E198EDE305D801BC98893D5A\n\narm 88B858B1411992509B0F2997877402D8BD9E378E4E21EFE024D61E25B29DAA08\n\narm5 D7564C7E6F606EC3A04BE3AC63FDEF2FDE49D3014776C1FB527C3B2E3086EBAB\n\narm6 72153E51EA461452263DBB8F658BDDC8FB82902E538C2F7146C8666192893258\n\narm7 7123B2DE979D85615C35FCA99FA40E0B5FBCA25F2C7654B083808653C9E4D616\n\ni586 CC3E92C52BBCF56CCFFB6F6E2942A676B3103F74397C46A21697B7D9C0448BE6\n\ni686 188BCE5483A9BDC618E0EE9F3C961FF5356009572738AB703057857E8477A36B\n\nmips 4567979788B37FBED6EEDA02B3C15FAFE3E0A226EE541D7A0027C31FF05578E2\n\nmipsel 06FC99956BD2AFCEEBBCD157C71908F8CE9DDC81A830CBE86A2A3F4FF79DA5F4\n\nsh4 4BFF052C7FBF3F7AD025D7DBAB8BD985B6CAC79381EB3F8616BEF98FCB01D871\n\nx86_64 3B12ABA8C92A15EF2A917F7C03A5216342E7D2626B025523C62308FC799B0737\n\n_Table 4. MooBot samples._\n\n\n-----\n\n## Additional Resources\n\n[New Mirai Variant Targeting Network Security Devices - Unit 42, Palo Alto Networks](https://unit42.paloaltonetworks.com/mirai-variant-iot-vulnerabilities/)\n[Network Attack Trends: Internet of Threats (November 2020-January 2021) - Unit 42, Palo Alto Networks](https://unit42.paloaltonetworks.com/network-attack-trends-winter-2020/)\n\n**Get updates from**\n\n**Palo Alto**\n\n**Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-06 - Mirai Variant MooBot Targeting D-Link Devices.pdf"
    ],
    "report_names": [
        "2022-09-06 - Mirai Variant MooBot Targeting D-Link Devices.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535829,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1664712550,
    "ts_modification_date": 1664712550,
    "files": {
        "pdf": "https://archive.orkl.eu/e6044d55984b949d581625c4f376014f9a681a33.pdf",
        "text": "https://archive.orkl.eu/e6044d55984b949d581625c4f376014f9a681a33.txt",
        "img": "https://archive.orkl.eu/e6044d55984b949d581625c4f376014f9a681a33.jpg"
    }
}