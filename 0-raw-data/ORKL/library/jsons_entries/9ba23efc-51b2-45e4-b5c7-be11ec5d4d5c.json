{
    "id": "9ba23efc-51b2-45e4-b5c7-be11ec5d4d5c",
    "created_at": "2023-01-12T15:07:30.502681Z",
    "updated_at": "2025-03-27T02:16:06.068351Z",
    "deleted_at": null,
    "sha1_hash": "bab3b02ab17525689c42d3f9ff39499b26f101f8",
    "title": "2019-07-24 - Updated Karagany Malware Targets Energy Sector",
    "authors": "",
    "file_creation_date": "2022-05-28T22:00:14Z",
    "file_modification_date": "2022-05-28T22:00:14Z",
    "file_size": 1562316,
    "plain_text": "# Updated Karagany Malware Targets Energy Sector\n\n**[secureworks.com/research/updated-karagany-malware-targets-energy-sector](https://www.secureworks.com/research/updated-karagany-malware-targets-energy-sector)**\n\nCounter Threat Unit Research Team\n\nWednesday, July 24, 2019 By: Counter Threat Unit Research Team\nThe following analysis was compiled and published to Threat Intelligence clients in July 2018. The\nSecureworks® Counter Threat Unit™ (CTU) research team is publicly sharing insights about the IRON\n[LIBERTY threat group, as well as details about the Karagany and MCMD malware used exclusively by](https://www.secureworks.com/research/mcmd-malware-analysis)\n[IRON LIBERTY, to supplement the discussion of the man-on-the-side technique described in the](https://www.secureworks.com/blog/own-the-router-own-the-traffic)\n[Secureworks Incident Response Insights Report 2019.](https://www.secureworks.com/resources/rp-incident-response-insights-report-2019)\n\n\n-----\n\n## Summary\n\nIn early 2018, Secureworks Counter Threat Unit™ (CTU) researchers identified and analyzed a number®\nof Karagany (originally known as xFrost) malware family variants and associated plugins. Karagany is a\nmodular remote access trojan (RAT) linked to the threat group CTU™ researchers track as IRON\nLIBERTY (also known as DragonFly2.0 and Energetic Bear). CTU analysis indicates that the malware is\nstill under active development as of July 2018. The authors have made a number of updates and changes\nto the core RAT component, as well as to a number of the plugins commonly used in conjunction with the\nframework.\n\n\n## Background\n\nDating from at least 2010, the Karagany malware family originated from criminal malware known as\n\"Dream Loader.\" [Reports indicate that Dream Loader was leaked onto underground forums and that](https://www.symantec.com/connect/blogs/dream-loader-new-bot-cc-engine-your-dreams)\nlimited use was seen in the wild.\n\nCTU researchers have linked Karagany to the IRON LIBERTY threat group. Although Karagany is based\non the leaked Dream Loader source code, IRON LIBERTY invested time to significantly develop and\nupdate the malware for its own operations. CTU researchers are unaware of Karagany being used by any\nother threat groups as of this publication.\n\nActive since at least 2010, IRON LIBERTY targets the energy vertical, including energy companies and\norganizations financing the energy vertical in the U.S. and Europe. The Russian government likely tasked\nIRON LIBERTY with collecting intelligence and possibly pre-positioning for sabotage operations.\n[Following public reporting of IRON LIBERTY's capabilities in 2014, CTU monitoring of the group's activity](https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Dragonfly_Threat_Against_Western_Energy_Suppliers.pdf)\nsuggests that it stopped using its known tools and retired its infrastructure. In late 2016, IRON LIBERTY\nre-emerged with a campaign targeting the energy vertical. Analysis of Karagany samples from 2016\nthrough 2018 shows continuous development throughout the course of that campaign.\n\n## Technical details\n\nCTU analysis provides insight into Karagany's functionality, how the malware is delivered and installed,\nand its typical plugins.\n\n### Core capability\n\nKaragany does not have a wealth of built-in capability at its core. Its main purpose is to provide the ability\nfor a remote threat actor to maintain persistent access to a victim's network, upload/download files, and\ndownload and execute additional plugin modules. CTU researchers observed the following plugins:\n\nListrix — file enumeration and directory listing\nIKLG — keylogger\nScreenUtil — screen capture utility\n[MCMD — interactive command shell module](https://www.secureworks.com/research/mcmd-malware-analysis)\nSysInfo — system information enumeration\nBrowser Data Viewer — browser data and credential theft\nLogKatz — custom Mimikatz script for credential theft\n\n\n-----\n\nIn addition to the plugin functionality, the core module contains a limited capability to harvest browser\npasswords stored in the Windows Credential Store (see Figure 1).\n\n_Figure 1. Karagany credential enumeration via standard API calls. (Source: Secureworks)_\n\n### Delivery\n\n\n-----\n\nIRON LIBERTY has used existing access to target environments to manually install Karagany on victims\nmachines using stolen privileged credentials. CTU researchers assess that each victim was specifically\ntargeted based on their role and access within the organization. An example of this process is the use of\nthe legitimate Microsoft tool PsExec to gain a remote command session on the victim's machine using a\ncompromised Active Directory service account that has local administrator privileges.\n\nAs shown in Figure 2, once on the victim's machine, the threat actors use the Microsoft Sysinternals tool\nProcDump to dump the LSASS process. This dump file is then RAR-compressed and retrieved by the\nthreat actor in order to recover the passwords of the machine's legitimate users.\n\n_Figure 2. Red Cloak process tree showing user profiling/password dumping. (Source: Secureworks)_\n\nCTU researchers assess that the threat actors used compromised privileged credentials sparingly for\ninitial access and then ran the malware in the context of the user to enable granular victim targeting and\nto camouflage the malware and its subsequent operations.\n\n### Installation\n\nUnlike pre-2017 Karagany variants, which either installed the malware into the directory it initially\nexecuted from or picked a name and path from a list of locations, all of the variants observed by CTU\nresearchers during this campaign were hard-coded to install to a specific path:\n%LOCALAPPDATA%\\SearchIndexer\\SearchIndexer.exe.\n\nA number of other files are created at installation time but remained empty in all observed infections:\n\n%LOCALAPPDATA%\\SearchIndexer\\up_stat.txt\n%LOCALAPPDATA%\\SearchIndexer\\stat_ag.txt\n%LOCALAPPDATA%\\SearchIndexer\\serv_stat.txt\n%LOCALAPPDATA%\\SearchIndexer\\proxy.txt\n\nAny plugins downloaded by the malware are dropped into %LOCALAPPDATA%\\SearchIndexer\\settings\nand executed. Regardless of which plugin is dropped and executed, the filename convention svchost<[0_9]+>.txt is used (e.g., %LOCALAPPDATA%\\SearchIndexer\\settings\\svchost1328525.txt). Plugin files_\ndropped to this directory are only ever executed once. Even if the same plugin is executed multiple times,\nit will be re-downloaded per execution.\n\n\n-----\n\nThe core Karagany implant does not delete any of the plugins it downloads, although some of the plugins\nare designed to self-delete. This oversight facilitates high-fidelity forensic analysis of the majority of plugin\nactivity carried out over the duration of the intrusion and allows a detailed timeline of threat actor activity\nto be compiled. The malware also creates a directory that is used for storing both plugin output data and\nto stage data for exfiltration. The value is hard-coded, and CTU researchers have observed the three\nvariants listed in Table 1. The ascending numerical value of these directories likely indicates malware\nversioning.\n\nCompilation date File path\n\n2016 %APPDATA%\\Update\\Tmp\\3.0\\\n\n2017 %APPDATA%\\Update\\Tmp\\7.0\\\n\n2017/2018 %APPDATA%\\Update\\Tmp\\9.0\\\n\n_Table 1. Karagany directories created for storing data._\n\n### Persistence\n\nIn all versions analyzed, the malware uses the Windows Startup folder of the infected system for\npersistence between reboots. An LNK file is added and usually retains the name of the malware as\nwritten to disk. In all of the 2017 and 2018 samples analyzed by CTU researchers, this name is\n\"SearchIndexer.LNK\":\n```\n%UserProfile%\\Start Menu\\Programs\\Startup\\SearchIndexer.LNK\n\n### Command and control\n\n```\nCTU analysis of the command and control (C2) capabilities of the Karagany malware show a number of\nchanges designed to reduce detection.\n\n**C2 operations**\n\nSamples compiled in 2017 and 2018 were hard-coded with specific URI patterns to communicate with the\nC2 server via HTTP POST requests. The alphanumeric filename string is pseudo-random and differs for\neach transmission to the server. It does not contain any identifying information about the host.\n\nPattern: https://<domain>/picture/<[a-z]{3}[0-9]{3}>.<jpeg | tiff | bmp>\nExample: https://<domain>/picture/zzz123.tiff\n\nVariants compiled in 2016 used subtly different URI paths (e.g., https://<domain>/get_image/<[0-9]{6}>.\n_<(jpg | png | gif)>). This change is likely an attempt to evade any basic network intrusion detections that_\nrely on tight string matching.\n\nThe hard-coded User-Agent string \"Mozilla/7.0 (Windows NT 7.0; WOW64; rv:7.0) Gecko/15103\nFirefox/46.0\" is used by the malware during communications with the C2 server. This User-Agent is the\nsame across all 2017 and 2018 samples. The \"Mozilla/7.0\" portion of this User-Agent string is invalid and\nis not used by any known products as of this publication.\n\n\n-----\n\nOnce the malware has checked in with the C2 server, if the threat actor has scheduled additional tasking,\na different URI path is used to retrieve the specified plugins:\n```\nhttps://<C2 IP address>/template/collection.php?a=tasks/<plugin path>\n\n```\n**C2 traffic encryption**\n\nAlthough the C2 traffic is secured by SSL/TLS, Karagany also encrypts and encodes the packet payloads\nbefore transmission to its C2 server using the AES-128-CBC algorithm and a pseudo-randomly generated\ninitialization vector (IV) (see Figure 3).\n\n\n-----\n\n_Figure 3. Unpacked Karagany binary strings showing AES key. (Source: Secureworks)_\n\nThe AES encryption key used is hard-coded in the binary as an ASCII string of hexadecimal values and\nwas the same in all 2017 and 2018 samples analyzed by CTU researchers. The string is visible within the\nunpacked Karagany binary and is not itself encrypted. Once the payload has been AES-encrypted, it is\n\n\n-----\n\nprepended with the IV value and Base64-encoded for transmission. Figures 4 and 5 show an example\ndecode and decryption based on sinkhole data obtained by CTU researchers of a Karagany beacon\npayload.\n\n_[Figure 4. Base64 decoding Karagany C2 beacon with CyberChef. (Source: Secureworks)](https://github.com/gchq/CyberChef)_\n\n_[Figure 5. AES decrypting Karagany C2 beacon using CyberChef. (Source: Secureworks)](https://github.com/gchq/CyberChef)_\n\n**C2 configuration decryption**\n\nAlthough a large number of strings are visible in the unpacked Karagany executable file, the details of the\nhard-coded C2 servers are still obfuscated and are decrypted in memory as needed during execution.\nThe relatively simple XOR encryption function uses the value 0xF for the first byte of the key and adds\n0x1 to this value for each further byte: 0x0F, 0x10, 0x11, 0x12 [...]. In the samples observed by CTU\nresearchers, a number of parameters were obfuscated using this technique, including the C2 IP address\nas well as the URL and URI path used for communication with the C2 server.\n\nOn some infected machines, the %LOCALAPPDATA%\\SearchIndexer\\ngate.txt file was present and\ncontained RC4-encrypted C2 IP addresses. The RC4 decryption key for this file is hard-coded in the\nKaragany malware and was the same across all observed samples:\n```\n8fPa,i.h-dookmipxRFAp$'z8[%@b*U#:oXQXXa\n\n### Plugins\n\n```\nThe main purpose of Karagany is to provide a threat actor the capability to remotely execute additional\nplugins on the victim's machine. CTU researchers observed a wide range of plugins dropped and\nexecuted via Karagany in 2017 and 2018. In addition to the plugins described below, CTU researchers\nhave observed a few others compiled on-the-fly specifically to interact with other tools deployed by the\nIRON LIBERTY group on victims' networks.\n\n\n-----\n\n**Listrix**\n\nThe most commonly observed plugin downloaded and executed by far was Listrix, a simple file-searching\nutility. The 2017 and 2018 versions of the module include the following hard-coded list of file extensions to\nsearch for:\n```\n*.txt,*.bat,*.pcf,*.vsd,*.zip,*.pfx,*.cer,*.crt,*.pem,*.key,*.cfg,*.conf,*.rar,*.docx,\n*.xlsx,*.pst,*.doc,*.rtf,*.pass*.*,*.pdf,*.xls\n\n```\nDuring execution, a temporary file is used to stored results under %LOCALAPPDATA%\\Temp\\<random\n_characters>.tmp. Once complete, this file is moved to %APPDATA%\\Update\\Tmp\\fls.txt for collection by_\nthe threat actor. The fls.txt file uses a tab-delimited format for the three fields: file path, file size, and last\nwrite time.\n\nUpon completion, the plugin is configured to self-delete via the following command:\n```\ncmd.exe /c del <plugin binary path> >> NUL\n\n```\nCTU researchers have observed multiple variants of the Listrix plugin. The main differences are the file\nextensions searched for and the excluded paths.\n\n**SysInfo**\n\nThe SysInfo plugin runs a selection of basic reconnaissance commands on the victim's machine via a\ncmd.exe process:\n```\nsysteminfo\ncmdkey /list\ntasklist /v\nnetstat -nao\nnetstat -rn\nipconfig /all\narp -a\nnet share\nnet use\nnet user %username%\nnet user %username% /domain\nset\ndir %systemdrive%\\Users*.*\ndir %appdata%\\Microsoft\\Windows\\Recent*.*\ndir %userprofile%\\Desktop\\*.*\n\n```\n\n-----\n\n```\nd %p og a es( 86)\ndir %programfiles%\ndir %appdata%\nwhoami /all\n\n```\nThe results of these commands are piped to a hard-coded output file: %APPDATA%\\Update\\Tmp\\res.txt.\nAs with other plugins, the plugin self-deletes from disk following successful execution.\n\n**ScreenUtil**\n\n[The ScreenUtil module, which was first reported in 2017, takes a screenshot of the current user's](https://www.symantec.com/blogs/threat-intelligence/dragonfly-energy-sector-cyber-attacks)\ndesktop. All variants analyzed by CTU researchers were hard-coded to drop the captured image files to\n%APPDATA%\\Update\\Tmp\\.\n\nA number of variants of ScreenUtil have been observed by CTU researchers, showing clear changes in\nhow the plugin operates over time.\n\nPre-2017 variants are much simpler in function and simply leverage the Windows GDI library to capture\nthe screen to a file called picture.png file before self-deleting. Multiple executions of this plugin overwrite\nthe previous screenshot if it has not been moved or renamed.\n\nThe version compiled in 2017 is much more complex, is multi-threaded, and has additional functionality:\n\nCreates system events \"__pickill__\" and \"__pic__\" that act as mutexes and facilitate self-removal.\nInstalls itself to %APPDATA%\\Roaming\\Microsoft\\ScreenUtil.exe.\nCreates an entry in the user's Startup folder for persistence.\nMonitors the current foreground window title for a list of hard-coded keywords (headtime, total,\noutlook, passw, auth, login, message, letter, enter, request, reply, scheme, plan, secret, graf, bank,\nmail, passview). If a window is open with any of these keywords in the title, a screenshot is taken in\nBMP format before being converted to a JPG file and stored to the install path as \"pic.jpg\". This file\nis then copied to the main Karagany plugin data folder %APPDATA%\\Roaming\\Update\\Tmp and\ngiven a unique name of pic%d.jpg, where %d is the current system tick count.\n\nDue to the persistence capability of 2017 and 2018 variants, this plugin remains resident on disk, allowing\nfor detection through persistence mechanism monitoring.\n\n**Keylogger**\n\nCTU researchers observed a standalone keylogger plugin compiled in March 2016 on a number of\ninfected machines. This plugin was deployed via multiple variants of Karagany and does not seem to\nhave been subject to additional development activity.\n\nThe keylogger is similar in design to the 2017 ScreenUtil plugins and has the following characteristics:\n\nCreates events \"__klg__\" and \"__klgkillsoft__\" to act as mutexes and facilitate self-removal.\nInstalls itself to %APPDATA%\\Intel Corporation\\IAStorIcon.exe.\nCreates an entry in the user's Startup folder for persistence.\nUses the SetWindowsHookExW API function to capture keystrokes system-wide.\n\n\n-----\n\nFormats and writes the keylogger output to %APPDATA%\\Update\\Tmp\\k%d.txt, where %d is the\ncurrent system tick count.\n\n**LogKatz**\n\nThe LogKatz plugin is a .NET C# binary compiled in 2015. It contains a Base64-encoded, Gzipcompressed version of the Invoke-Mimikatz PowerShell script (see Figure 6). The version of the script\n[specifically embedded in variants analyzed by CTU researchers was pushed to GitHub on February 17,](https://github.com/clymb3r/PowerShell/commit/204afde07cc602a4c8ba170d2f11b1669900c9f3#diff-2b359b258b5401eebf649d68d57d54cb)\n2015.\n\n_Figure 6. DNSpy output showing Main function of LogKatz. (Source: Secureworks)_\n\nThe binary decodes both the Invoke-Mimikatz payload and the required command-line arguments using\nthe \"GetKatz\" and \"GetCommand\" functions (see Figure 7). It then executes these elements directly via\nthe C# PowerShell.Invoke method.\n\n\n-----\n\n_Figure 7. DNSpy output showing GetKatz/GetCommand function of LogKatz. (Source: Secureworks)_\n\nThe decoded command-line arguments are standard Mimikatz arguments:\n```\nInvoke-Mimikatz -Command \"privilege::debug sekrulsa::logonpasswords exit\"\n\n```\nThe output from this command is logged to %APPDATA%\\LogKatz.dat and then moved to\n%APPDATA%\\Update\\Tmp\\LogKatz.dat for extraction.\n\nThere is also an unused function inside the binary called \"isDomainJoined\", which returns a Boolean\nresult indicating if the machine is part of an Active Directory domain.\n\n**Browser Data Viewer**\n\nThe Browser Data Viewer plugin is another binary compiled in 2015. It is used to extract credentials, form\ndata, and browsing history entries from commonly used Internet browsers such as Chrome, Firefox, and\nInternet Explorer. The methods used are typical of other browser data extraction tools and do not merit indepth analysis. The output from this plugin is stored in %APPDATA%\\Update\\Tmp and is dependent on\nwhich web browsers are installed and have data to extract. Possible output files include outGo.txt,\noutFF.txt, outIE.txt, outGA.txt, outFA.txt, and outIA.txt. This plugin does not self-delete on completion of its\nexecution.\n\n**MCMD**\n\nThe MCMD plugin is a Windows binary that provides a custom reverse command shell to the threat actor\nvia a compromised PHP web page. As Karagany does not provide command shell access, CTU\nresearchers have observed this tool being used to deploy additional binaries to a victim's machine, carry\nout initial reconnaissance, and configure other tools. In some incidents, a standalone version of MCMD\nwas used to deploy the Karagany malware.\n\n### Links to IRON LYRIC\n\n\n-----\n\nMany of the plugins deployed via Karagany contain various links and similarities to tools used by a threat\ngroup tracked by CTU researchers as IRON LYRIC (also known as the TeamSpy group). IRON LYRIC\nwas last known to be active in 2013, and CTU researchers assess that it may have been operated by a\nRussian intelligence service and tasked with covert surveillance of individuals.\n\n[A 2013 third-party report on the TeamSpy group describes a keylogger that is similar to samples analyzed](https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/20134928/theteamspystory_final_t2.pdf)\nby CTU researchers in 2018. The connections are many, including the two system events \"__klg__\" and\n\"__klgkillsoft__\", the keylogger naming convention, the program flow, and the use of \"preferences.xml\".\nCTU researchers assess that the Karagany keylogger is derived from the codebase detailed in the report.\n\nThe Listrix plugin dropped by Karagany bears uncanny similarity to the \"FileList2\" plugin in the 2013\nreport. The temporary file naming convention, output format, and overall program flow are almost\nidentical. The file header mentioned in the 2013 report is not included in the Listrix plugin, likely due to the\nease with which it could be detected by antivirus vendors. It is highly likely that the Listrix plugin is derived\nfrom the same codebase as the \"FileList2\" plugin used by IRON LYRIC.\n\nAdditional similarities also exist in the file metadata of some 2017 Karagany plugins and historic IRON\nLYRIC binaries. A 2017 SysInfo plugin analyzed by CTU researchers has the version information shown\nin Figure 8. Identical metadata can be found in an IRON LYRIC TeamBot sample from 2012 (see Figure\n9).\n\n_Figure 8. PE metadata from SysInfo plugin. (Source: Secureworks)_\n\n\n-----\n\n_Figure 9. 2012 TeamBot metadata. (Source: VirusTotal)_\n\n### Binary analysis\n\nThe majority of 2017 and 2018 Karagany samples analyzed by CTU researchers were packed using a\ncustom packer, albeit a reasonably simple one that performs a number of binary shifts and logic\noperations. Karagany campaigns in 2016 and prior typically used the UPX packer as an additional layer of\nobfuscation, but this behavior was not observed in 2017-2018 samples. Once unpacked, the malware\ncreates a copy of its own process with a suspended thread and injects the unpacked code into the new\nprocess before calling the ResumeThread API. Breaking on this function call in a debugger allows an\nanalyst to dump the process and extract the unpacked Karagany binary for further analysis.\n\nPrior to executing fully, Karagany uses a robust anti-VM detection function that can detect most commonly\nused virtualization platforms such as VMWare, VirtualBox, VPC, and generic virtualization techniques. A\nsample that was compiled in May 2018 had the anti-VM routine completely re-factored and thinned down.\nOnly the VMWare and VirtualBox checks retained, mainly based on loaded drivers and file paths. This\nchange dramatically reduced the file size of the malware. In all cases, the anti-VM checks return a\nBoolean value and can be easily patched out or evaded with a debugger as shown in Figure 10.\n\n_Figure 10. Karagany VM detection evasion. (Source: Secureworks)_\n\n## Conclusion\n\n\n-----\n\nKaragany is only one of a variety of tools operated by IRON LIBERTY. Its presence indicates a much\nwider compromise that utilizes and combines many other tools, techniques, and procedures. Karagany as\na malware family is not particularly sophisticated, and although it has been subject to continued\ndevelopment since its adoption by IRON LIBERTY, its core functionality has not changed. It does not\ncontain kernel-mode components, and many of its plugins do not require privileged access.\n\nIncremental changes to format strings, C2 paths, and the use of custom packers have allowed Karagany\nto evade the majority of traditional antivirus products. Deployment of anomaly-based tools, such as an\nendpoint detection and response (EDR) agent, could quickly identify Karagany without signatures based\non its installation, persistence, and modus operandi.\n\nBasic security controls such as least privilege, software restriction policies, and application whitelisting\ncan prevent malware such as Karagany from executing. Inspection of SSL traffic at the perimeter and\nmonitoring of unusual or rare User-Agent strings can also aid analysts in detecting the unusual behavior\nexhibited by the malware variants discussed in this analysis.\n\n## Threat indicators\n\nThe threat indicators in Table 2 can be used to detect activity related to the Karagany malware and\nassociated plugins, as used by IRON LIBERTY. Note that IP addresses can be reallocated. The domains,\nURLs, and IP addresses may contain malicious content, so consider the risks before opening them in a\nbrowser.\n\nIndicator Type Context\n\n\nsatanal.info Domain\nname\n\n188.42.223.39 IP\naddress\n\ntureg.info Domain\nname\n\n185.103.110.210 IP\naddress\n\ndoublestats.online Domain\nname\n\n5.135.104.77 IP\naddress\n\n\nC2 server for\nKaragany\ncore malware\n(sinkholed by\nSecureworks)\n\nHistorical C2\nserver for\nKaragany\ncore malware\n\nC2 server for\nKaragany\ncore malware\n(sinkholed by\nSecureworks)\n\nHistorical C2\nserver for\nKaragany\ncore malware\n\nC2 server for\nKaragany\ncore malware\n\nC2 server for\nKaragany\ncore malware\n\n\n-----\n\nIndicator Type Context\n\nhttps://ecco0.b13x.org/ajax/base/include/list.php URL C2 server for\nMCMD plugin\n\nhttps://smarttoys.com.ua/bitrix/services/ajax/refresh/refresh.php URL C2 server for\nMCMD plugin\n\nhttps://kanri.rbridal.net/json/renew.php URL C2 server for\nMCMD plugin\n\n\n418e58b78731546089eb1b7fa6e1d99f MD5\nhash\n\n79c110e585934cd3756a5a7a259329eac4c6550c SHA1\nhash\n\n00a1b9fd9af9c5e366ef19908f028e9cca0462ec16adab9763e8c8b017b0f6bc SHA256\nhash\n\n874295e9512c668a7df493c8975c081b MD5\nhash\n\n2a876d27689a4947e01c785b42c45c09788ee4d4 SHA1\nhash\n\n7b2c9bb78867319e8d907c48eb24e51dffc6a81edf5166dc4409ed07227402f3 SHA256\nhash\n\n418e58b78731546089eb1b7fa6e1d99f MD5\nhash\n\n79c110e585934cd3756a5a7a259329eac4c6550c SHA1\nhash\n\n00a1b9fd9af9c5e366ef19908f028e9cca0462ec16adab9763e8c8b017b0f6bc SHA256\nhash\n\n8aeacf3fde1b49940fb4d08226dccbc4 MD5\nhash\n\n7f3511b7e6cad7274c2450afd88544910c0ae33b SHA1\nhash\n\nadf809c93f6bc1f758e7e3a4aeeb39d00e34e762ac4ff48dce59de5efb0f80fd SHA256\nhash\n\n990e2e3ab8e2c8126214e667b0dc282f MD5\nhash\n\n53a4eae9858f4876fde02f7666ef6e0f69e8f70b SHA1\nhash\n\ne644771565fb2144d018e8ce89fa116fc7e564007f941ce712fa5f929b86e338 SHA256\nhash\n\n20ec7658254eddd917e1b351e1728534 MD5\nhash\n\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\n\n-----\n\nIndicator Type Context\n\n\nda97e4cda8eeef12c6540c6b060451a1369b7638 SHA1\nhash\n\n9a1a196f6f5afa19643856cf8545b3401fc2dae8f79ec08a32456b3e9f8bbdbd SHA256\nhash\n\nfff6dc1216fe549fa1d700f1ccfcd754 MD5\nhash\n\n18a4ab7f7783c06d6fd782908f8495e7c1ea15fa SHA1\nhash\n\nde0d3aaee6254074222d9bdf35fa67218d9738f05e1dfb75173cf982c03a0811 SHA256\nhash\n\n4ad06a76e1ad423b13e03587a887ede0 MD5\nhash\n\n95ba7f7b073bbf60f85d4c7b1bd76adfec8299aa SHA1\nhash\n\n20d20c9dda1f922786f95132eb64753b38f7db695d29a7b9993b880e44043b59 SHA256\nhash\n\nfca1fa07afa1b3ff9f67f2a377de51ae MD5\nhash\n\nca2776624f2e0c1b1b478c77f63cf5ed1075b62a SHA1\nhash\n\n8aaa1b931610122a1908d9bfe1806881b430b57462a2147d403bb495183bd592 SHA256\nhash\n\n6851cbfa790eb56b68942ee86a045c36 MD5\nhash\n\n644ccf37af908d79da496c06b85b9060550149d9 SHA1\nhash\n\n656fe7c362b7421d5e94ab186e0beca01c00b55eecefa25270805fca6ad96d9a SHA256\nhash\n\n6cd47d4c2fd8997683baa1f278d2dd94 MD5\nhash\n\n3019f121e6cc3a955c1a8005fd78328ab7c1d479 SHA1\nhash\n\n5179d5874383b3c6a45350f77e86098ae7be606df490afbd57d98bed8e3bc2cd SHA256\nhash\n\n2dbdeef42699730635abdc657775e4af MD5\nhash\n\n94a1ec29f5d55edc67eee98ea086e4dbc98e5a56 SHA1\nhash\n\n\nKaragany\ncore malware\n\nKaragany\ncore malware\n\nKeylogger\nplugin binary\n\nKeylogger\nplugin binary\n\nKeylogger\nplugin binary\n\nListrix plugin\nbinary\n\nListrix plugin\nbinary\n\nListrix plugin\nbinary\n\nListrix plugin\nbinary\n\nListrix plugin\nbinary\n\nListrix plugin\nbinary\n\nListrix plugin\nbinary\n\nListrix plugin\nbinary\n\nListrix plugin\nbinary\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\n\n-----\n\nIndicator Type Context\n\n\n4877050e41f269bab1013649f747f1bd2a1f53e07825c21778f4b1a9a882c7bb SHA256\nhash\n\n336b6f0108a23b95f3141afc787a31dd MD5\nhash\n\nda6f24b1bf61ad233ac9bf6709951db57c59ad2e SHA1\nhash\n\n7aa8cd8a2669537631b8ac7b892f51d4c74056c1369007c474277ebdf82fb74e SHA256\nhash\n\n8b8b33a14f7be027fdb1aec1555fa8a8 MD5\nhash\n\n425346c68fa8e113c4e243d1193c050548839c86 SHA1\nhash\n\n172be9ebd26946bdfe19150e304c8abd59d43a7bf92afa270f028c9a4a29fd99 SHA256\nhash\n\n6449cff2a0497cae0c3fb780da287e2c MD5\nhash\n\n3a7927fa71d43e3856761f2bf7d5441e6b310e30 SHA1\nhash\n\n1fd5b0b1a218b65443d7088e47dd79018bf46935375b061f5f78fbe1cadb50dc SHA256\nhash\n\nfd6145bbc722ef52eed6b94dd520170c MD5\nhash\n\nf65425f95d84bd7efc71e402f40e59542bdd83db SHA1\nhash\n\nc605a771730cc618f2f85a8bee9d9cbdabc6f5f47d803976b4923f64f9aea282 SHA256\nhash\n\nade68f4e5b03c6cf86b851613dbc3629 MD5\nhash\n\n4af90d010586d7153345dc563722cdb12fd607e1 SHA1\nhash\n\n9d994710941540fe6bdf43196679b6a667f6370f1aa9b538836a509f4e4c42c4 SHA256\nhash\n\n195ec5fb2d5ccd344b655a955f20db81 MD5\nhash\n\n8c5e6df90795fbbb3f6396abfe05887d4ad82982 SHA1\nhash\n\na35ace92645e8a62536031784f60679200252a2a4ec1dc287f93797be34dfed2 SHA256\nhash\n\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\nMCMD plugin\nbinary\n\nScreenUtil\nplugin binary\n\nScreenUtil\nplugin binary\n\nScreenUtil\nplugin binary\n\nScreenUtil\nplugin binary\n\nScreenUtil\nplugin binary\n\nScreenUtil\nplugin binary\n\nLogKatz\nplugin binary\n\nLogKatz\nplugin binary\n\nLogKatz\nplugin binary\n\nSysInfo\nplugin binary\n\nSysInfo\nplugin binary\n\nSysInfo\nplugin binary\n\n\n-----\n\nIndicator Type Context\n\n\n2618ab729dea68dfbcb11dce2e66c8c2 MD5\nhash\n\n4ff23bc0b3a0fc08ac9f6bd7bbff73a15dc00d8e SHA1\nhash\n\n47a3f4fbe7984e3ae3d2088e2898bea371a0aeaee8fca6a6b6d59d6e938393fa SHA256\nhash\n\n_Table 2. Indicators for this threat._\n\n## References\n\n\nBrowser Data\nViewer plugin\nbinary\n\nBrowser Data\nViewer plugin\nbinary\n\nBrowser Data\nViewer plugin\nbinary\n\n\nKaspersky Lab Global Research and Analysis Team (GReAT). \"The ‘TeamSpy' Story - Abusing\nTeamViewer in Cyberespionage Campaigns.\" March 20, 2013.\nhttps://media.kasperskycontenthub.com/wpcontent/uploads/sites/43/2018/03/20134928/theteamspystory_final_t2.pdf\n\nLellia, Andrea. \"Dream Loader: the new bot C&C engine of your dreams.\" Symantec. December 20, 2010.\n[https://www.symantec.com/connect/blogs/dream-loader-new-bot-cc-engine-your-dreams](https://www.symantec.com/connect/blogs/dream-loader-new-bot-cc-engine-your-dreams)\n\nSecureworks. \"MCMD Malware Analysis.\" July 11, 2019. https://www.secureworks.com/research/mcmdmalware-analysis\n\nSecureworks. \"Resurgent IRON LIBERTY Targeting Energy Sector.\" July 11, 2019.\n[https://www.secureworks.com/research/resurgent-iron-liberty-targeting-energy-sector](https://www.secureworks.com/research/resurgent-iron-liberty-targeting-energy-sector)\n\nSymantec. \"Dragonfly: Cyberespionage Attacks Against Energy Suppliers.\" July 7, 2014.\nhttps://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/Dragonfly_Thr\neat_Against_Western_Energy_Suppliers.pdf\n\nSymantec. \"Dragonfly: Western energy sector targeted by sophisticated attack group.\" October 20, 2017.\n[https://www.symantec.com/blogs/threat-intelligence/dragonfly-energy-sector-cyber-attacks](https://www.symantec.com/blogs/threat-intelligence/dragonfly-energy-sector-cyber-attacks)\n\n[Footnote: We also suggest reading the CTU blog titled Own The Router, Own The Traffic: As threat\n[actors increasingly target supply chains, man-on-the-side techniques introduce another layer of](https://www.secureworks.com/blog/own-the-router-own-the-traffic)\ncomplexity that organizations must consider, June 24, 2019.]\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-07-24 - Updated Karagany Malware Targets Energy Sector.pdf"
    ],
    "report_names": [
        "2019-07-24 - Updated Karagany Malware Targets Energy Sector.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d2bd376-fcdc-4c6a-bc2c-17ebbb5b81a4",
            "created_at": "2022-10-25T16:07:23.667223Z",
            "updated_at": "2025-03-27T02:02:09.916086Z",
            "deleted_at": null,
            "main_name": "GCHQ",
            "aliases": [
                "Government Communications Headquarters",
                "Operation Socialist"
            ],
            "source_name": "ETDA:GCHQ",
            "tools": [
                "Prax",
                "Regin",
                "WarriorPride"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1d8dd2ca-5592-482e-b89d-6a7e1a49f4f6",
            "created_at": "2023-01-06T13:46:38.408359Z",
            "updated_at": "2025-03-27T02:00:02.826069Z",
            "deleted_at": null,
            "main_name": "TeamSpy Crew",
            "aliases": [
                "TeamSpy",
                "Team Bear",
                "Anger Bear",
                "IRON LYRIC"
            ],
            "source_name": "MISPGALAXY:TeamSpy Crew",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "90307967-d5eb-4b7b-b8de-6fa2089a176e",
            "created_at": "2022-10-25T15:50:23.501119Z",
            "updated_at": "2025-03-27T02:00:55.486295Z",
            "deleted_at": null,
            "main_name": "Dragonfly 2.0",
            "aliases": [
                "Dragonfly 2.0",
                "IRON LIBERTY",
                "DYMALLOY",
                "Berserk Bear"
            ],
            "source_name": "MITRE:Dragonfly 2.0",
            "tools": [
                "netsh",
                "Impacket",
                "MCMD",
                "CrackMapExec",
                "Trojan.Karagany",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4a2aaa17-e108-4a3f-8b0f-8c6bcba3db49",
            "created_at": "2022-10-25T16:07:24.30783Z",
            "updated_at": "2025-03-27T02:02:10.166694Z",
            "deleted_at": null,
            "main_name": "TeamSpy Crew",
            "aliases": [
                "Anger Bear",
                "Iron Lyric",
                "SIG39",
                "Team Bear"
            ],
            "source_name": "ETDA:TeamSpy Crew",
            "tools": [
                "SpY-Agent",
                "TVRAT",
                "TVSpy",
                "TeamSpy",
                "TeamViewer",
                "TeamViewerENT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673536050,
    "ts_updated_at": 1743041766,
    "ts_creation_date": 1653775214,
    "ts_modification_date": 1653775214,
    "files": {
        "pdf": "https://archive.orkl.eu/bab3b02ab17525689c42d3f9ff39499b26f101f8.pdf",
        "text": "https://archive.orkl.eu/bab3b02ab17525689c42d3f9ff39499b26f101f8.txt",
        "img": "https://archive.orkl.eu/bab3b02ab17525689c42d3f9ff39499b26f101f8.jpg"
    }
}