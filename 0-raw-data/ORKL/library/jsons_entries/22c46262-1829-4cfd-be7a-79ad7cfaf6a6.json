{
    "id": "22c46262-1829-4cfd-be7a-79ad7cfaf6a6",
    "created_at": "2023-01-12T15:08:00.491909Z",
    "updated_at": "2025-03-27T02:17:24.741167Z",
    "deleted_at": null,
    "sha1_hash": "6e1a8e842124dbf90a4d4585a13a3ba93614f4e1",
    "title": "2022-04-29 - The LOTUS PANDA Is Awake, Again. Analysis Of Its Last Strike.",
    "authors": "",
    "file_creation_date": "2022-05-27T22:52:57Z",
    "file_modification_date": "2022-05-27T22:52:57Z",
    "file_size": 1500804,
    "plain_text": "# THE LOTUS PANDA IS AWAKE, AGAIN. ANALYSIS OF ITS LAST STRIKE.\n\n**cluster25.io/2022/04/29/lotus-panda-awake-last-strike/**\n\nApril 29, 2022\n\n[APT +](https://cluster25.io/category/general/apt/) [Intelligence Cluster25 todayApril 29, 2022](https://cluster25.io/category/intelligence/)\n\n**NAIKON is the name of an APT (Advanced Persistent Threat) which is believed to originate from China.**\nThe Naikon hacker group was first tracked over a decade ago, back in 2010. Naikon APT hit the\nheadlines in 2015 when malware researchers discovered the infrastructure used by cybercriminals.\n\n\n-----\n\nThanks to this, one of the members of the hacker group was caught by law enforcement. After this\noversight, cybersecurity analysts suggested that Naikon APT went out of business. However, Naikon has\nresurfaced in the last weeks.\n\nThe geolocalization and the sectors targeted by Naikon cyberattacks could likely suggest their intention\nto strategically attempt ASEAN members like Brunei, Cambodia, Indonesia, Laos, Malaysia, Myanmar,\nthe Philippines, Singapore, Thailand, and Vietnam. Because of their more capitalist economic model,\nand their partnerships with the West, those countries could likely have important and classified foreign\naffairs or military information, which could likely be acquired and exploited by the Chinese threat actor. In\nfact, the group focused its previous attacks on high profile targets such as government agencies and\n**military organizations in the South Asian region. Most government bodies targeted by Naikon APT**\ncybercriminals are usually in the foreign affairs or science and technology sectors. Some state-owned\nbusinesses and companies have also reportedly been targeted by the threat actor.\n\nBy observing Naikon APT’s hacking arsenal, it was concluded that this group tends to conduct long-term\nintelligence and espionage operations, typical for a group that aims to conduct attacks on foreign\ngovernments and officials. To avoid detection and maximize the result, it changed different TTPs and\n**tools over time.**\n\nIn this attack analyzed by C25, the Chinese APT used a spear phishing email to deliver a beacon of a\n**Red Team framework known as “Viper”. The killchain includes an artifact that is already known and**\nthat was attributed to Naikon one year ago and it is used to load and execute a custom shellcode. The\ntarget of this attack is currently unknown but with high probability, given the previous history of the attack\nperpetrated by the group, it might be a government institution from a South Asian country.\n\n## INITIAL ACCESS\n\nThe attack starts with a spear phishing email containing a weaponized document. The file, written in\nChinese, seems to be a reply to a call for tenders. Its title translated in English is “Tender Documents\nfor Centralized Procurement of Web Application Firewall (WAF) Equipment of China Mobile from 2022 to\n2024”.\n\n\n-----\n\nThe Office document contains two different payloads that are hidden as document properties. As\nvisible in the following VBA snippet, when opening the document, the Macro code extracts the\nembedded data from Comments and Subject properties and writes it in the file system.\n\nThe files are written under “%Temp%\\rad543C7.tmp.ini” and “%Temp%\\rad543C7.tmp.exe“. The VBA\ncode is simple and short and doesn’t have trace of any obfuscation. The created INI file contains a\npayload encoded as hexstring, as shown below.\n\n\n-----\n\n## HEXINI LOADER\n\nThe file rad543C7.tmp.exe is an artifact already known to the community since the last year and it was\nnamed HexINI. It is a small executable that acts like a loader for a shellcode. Its name comes from its\ncharacteristic to be a loader for a hex-encoded shellcode saved as INI file in the same folder. So, also in\nthis specific case the final code is contained into the same loader file, rad543C7.tmp.ini.\n\nIn the image is shown the core of HexINI loader. It simply opens and reads the INI file using the fopen\nand fread functions, then converts the hexadecimal string to a byte array. Then this array is loaded into\nprocess memory space using VirtualAlloc and memcpy. Finally, the code is executed on a new thread\nthrough the CreateThread function.\n\n\n-----\n\nAs shown in this picture, the hex bytes in the memory space the lpStartAddress is pointing to are the\nsame already seen into the previous INI file.\n\n## SHELLCODE\n\nOnce the shellcode is executed, it proceeds with the creation of a suspended process of svchost.exe\nthat can inject the final beacon.\n\nThe injection mechanism uses the classic flow composed by VirtualAllocEx, WriteProcessMemory\nand CreateRemoteThreadEx WinApi functions.\n\nThis remote thread seems to be a sort of HTTP beacon that tries to get new commands to execute every\n7899 milliseconds from\n**https://175.27.164.228:57784/NYMLEDfq/IOH9E0Nq2YMEVQVXZgqYUAOI5wWcN5LMe**\n\nThe beacon embeds the following user-agent:\n\n**Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)**\n**Chrome/58.0.3029.110 Safari/537.36**\n\nThat corresponds to Google Chrome v58 on Windows 7.\n\n\n-----\n\nAt first glance, the code of this artifact might look like a CobaltStrike beacon. However, after a deep\nanalysis C25 team discovered the beacon derives from a less popular RedTeam framework known as\n**Viper.**\n\nOn the command-and-control server, using a passive approach, C25 found the presence of a Viper\n**framework and ARL dashboards (both tools are briefly described in the next section).**\n\nA graphic representation of the described kill-chain is shown below.\n\n## NAIKON ARSENAL\n\nDuring the analysis it was discovered part of Naikon APT arsenal. Starting from what we observed we\ncan assert that this Chinese group is using open-source tools like Viper and ARL (Asset\n**Reconnaissance Lighthouse). Both tools seem to be developed by a Chinese programmer, as most of**\ntheir documentation is written in Mandarin.\n\n**[Viper [https://github.com/FunnyWolf/Viper]](https://github.com/FunnyWolf/Viper)**\n\nViper is a graphical penetration tool, which modularizes and weaponizes the tactics and technologies\ncommonly used in the process of Intranet penetration. As stated in its Github page, Viper integrates 80+\nmodules, covering almost all the known Techniques (such as Resource Development, Initial Access,\nExecution, Persistence and so on).\n\nLike CobaltStrike, Viper allows easy payload generation, such as Meterpreter, ReverseShell and other\ncustom beacons.\n\nIn the following image is shown a Meterpreter usage example directly through the Viper GUI.\n\n\n-----\n\n**[ARL [https://github.com/TophantTechnology/ARL]](https://github.com/TophantTechnology/ARL)**\n\nARL (Asset Reconnaissance Lighthouse) is a tool to assist security team or penetration tester to make\nreconnaissance and retrieval of assets, discovering existing weak points and attack surfaces.\n\nThe tool has a lot of functionalities such as port scanning and service identification, website\nfingerprinting, Domain name asset discovery and so on.\n\nAs visible from the Github page, the tool exposes a user-friendly Web view that make easier most of its\nfunctionalities.\n\n## INDICATORS OF COMPROMISE\n\n\n-----\n\n**CATEGORY** **TYPE** **VALUE**\n\nMALDOC SHA256 05936ed2436f57237e7773d3b6095e8df46821a62da49985c98be34136594ebd\n\nEXE SHA256 8b831ee82975d43456ee861115272d3923e17f07a702eb057feeed8ce76ff4ca\n\nFAKE INI SHA256 ee50160fdd7cacb7d250f83c48efa55ae0479e47a1eece9c08fe387453b9492a\n\nSHELLCODE SHA256 eeb5dc51e3828ffbefc290dc1a973c5afc89ba7ff43ab337d5a3b3dc6ca4216f\n\nC&C IPV4 175.27.164.228\n\n## ATT&CK MATRIX\n\n**TACTIC** **TECHNIQUE** **NAME**\n\nInitial Access T1566.001 Phishing: Spearphishing Attachment\n\nExecution T1204 User Execution\n\nDefense Evasion T1055 Process Injection\n\nDefense Evasion T1406 Obfuscated Files or Information\n\nCommand and Control T1573 Encrypted Channel\n\nCommand and Control T1105 Ingress Tool Transfer\n\nCommand and Control T1071 Application Layer Protocol\n\nCommand and Control T1571 Non-Standard Port\n\n## HUNTING AND DETECTION\n\nCustomers with access to Cluster25 intelligence portal can get more indicators and threat hunting rules\nabout this attack following the link\n\n[https://intelligence.cluster25.io/analysis/64a25cf2-e115-4526-b236-4a8e5275d8c3](https://intelligence.cluster25.io/analysis/64a25cf2-e115-4526-b236-4a8e5275d8c3)\n\n[For more information about this campaign it’s possibile to send an email to [email protected]](https://cluster25.io/cdn-cgi/l/email-protection#52263a203733263b3c26373e12313e272126372060677c3b3d)\n\nWritten by: [Cluster25](https://cluster25.io/author/cluster25/)\n\nTagged as: [APT,](https://cluster25.io/tag/apt/) [Malware,](https://cluster25.io/tag/malware/) [phishing,](https://cluster25.io/tag/phishing/) [Naikon,](https://cluster25.io/tag/naikon/) [China.](https://cluster25.io/tag/china/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-29 - The LOTUS PANDA Is Awake, Again. Analysis Of Its Last Strike..pdf"
    ],
    "report_names": [
        "2022-04-29 - The LOTUS PANDA Is Awake, Again. Analysis Of Its Last Strike..pdf"
    ],
    "threat_actors": [
        {
            "id": "a1ce86c2-3efc-4115-a85e-92c5fa461838",
            "created_at": "2022-10-25T16:47:55.561071Z",
            "updated_at": "2025-03-27T02:05:17.261424Z",
            "deleted_at": null,
            "main_name": "BRONZE ELGIN",
            "aliases": [
                "Lotus Blossom ",
                "Lotus Panda ",
                "Lstudio",
                "Spring Dragon ",
                "CTG-8171 "
            ],
            "source_name": "Secureworks:BRONZE ELGIN",
            "tools": [
                " Lzari",
                "Elise"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "30ed778d-15b3-484e-a90b-e1e05b36a42f",
            "created_at": "2023-01-06T13:46:38.290626Z",
            "updated_at": "2025-03-27T02:00:02.795711Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "G0013"
            ],
            "source_name": "MISPGALAXY:APT30",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ad154227-6fcf-43c5-a540-0c09534e040f",
            "created_at": "2024-05-01T02:03:07.952927Z",
            "updated_at": "2025-03-27T02:05:17.267077Z",
            "deleted_at": null,
            "main_name": "BRONZE GENEVA",
            "aliases": [
                "BRONZE STERLING ",
                "CTG-5326 ",
                "Naikon ",
                "Override Panda ",
                "APT30 "
            ],
            "source_name": "Secureworks:BRONZE GENEVA",
            "tools": [
                " ShadowPad",
                "Lecna"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2912fc0-c34e-4e4b-82e9-665416c8fe32",
            "created_at": "2023-04-20T02:01:50.979595Z",
            "updated_at": "2025-03-27T02:00:02.79494Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "BRONZE GENEVA",
                "G0019",
                "Naikon",
                "BRONZE STERLING",
                "G0013",
                "PLA Unit 78020",
                "OVERRIDE PANDA",
                "Camerashy"
            ],
            "source_name": "MISPGALAXY:Naikon",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "87a20b72-ab72-402f-9013-c746c8458b0b",
            "created_at": "2023-01-06T13:46:38.293223Z",
            "updated_at": "2025-03-27T02:00:02.796483Z",
            "deleted_at": null,
            "main_name": "LOTUS PANDA",
            "aliases": [
                "Lotus BLossom",
                "Spring Dragon",
                "ST Group",
                "DRAGONFISH",
                "BRONZE ELGIN",
                "ATK1",
                "G0030",
                "Red Salamander"
            ],
            "source_name": "MISPGALAXY:LOTUS PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f1ce7e3-77cd-4af0-bedb-1643f55c9baf",
            "created_at": "2022-10-25T15:50:23.31611Z",
            "updated_at": "2025-03-27T02:00:55.439974Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "Naikon"
            ],
            "source_name": "MITRE:Naikon",
            "tools": [
                "ftp",
                "netsh",
                "WinMM",
                "Systeminfo",
                "RainyDay",
                "RARSTONE",
                "HDoor",
                "Sys10",
                "SslMM",
                "PsExec",
                "Tasklist",
                "Aria-body"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b69484be-98d1-49e6-aed1-a28dbf65176a",
            "created_at": "2022-10-25T16:07:23.886782Z",
            "updated_at": "2025-03-27T02:02:10.014032Z",
            "deleted_at": null,
            "main_name": "Naikon",
            "aliases": [
                "Hellsing",
                "ITG06",
                "Lotus Panda",
                "Naikon",
                "Operation CameraShy"
            ],
            "source_name": "ETDA:Naikon",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "AR",
                "ARL",
                "Agent.dhwf",
                "Aria-body",
                "Aria-body loader",
                "Asset Reconnaissance Lighthouse",
                "BackBend",
                "Creamsicle",
                "Custom HDoor",
                "Destroy RAT",
                "DestroyRAT",
                "Flashflood",
                "FoundCore",
                "Gemcutter",
                "HDoor",
                "JadeRAT",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "LadonGo",
                "Lecna",
                "Living off the Land",
                "NBTscan",
                "Naikon",
                "NetEagle",
                "Neteagle_Scout",
                "NewCore RAT",
                "Orangeade",
                "PlugX",
                "Quarks PwDump",
                "RARSTONE",
                "RainyDay",
                "RedDelta",
                "RoyalRoad",
                "Sacto",
                "Sandboxie",
                "ScoutEagle",
                "Shipshape",
                "Sisfader",
                "Sisfader RAT",
                "Sogu",
                "SslMM",
                "Sys10",
                "TIGERPLUG",
                "TVT",
                "TeamViewer",
                "Thoper",
                "WinMM",
                "Xamtrav",
                "XsFunction",
                "ZRLnk",
                "nbtscan",
                "nokian",
                "norton",
                "xsControl",
                "xsPlus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536080,
    "ts_updated_at": 1743041844,
    "ts_creation_date": 1653691977,
    "ts_modification_date": 1653691977,
    "files": {
        "pdf": "https://archive.orkl.eu/6e1a8e842124dbf90a4d4585a13a3ba93614f4e1.pdf",
        "text": "https://archive.orkl.eu/6e1a8e842124dbf90a4d4585a13a3ba93614f4e1.txt",
        "img": "https://archive.orkl.eu/6e1a8e842124dbf90a4d4585a13a3ba93614f4e1.jpg"
    }
}