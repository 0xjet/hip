{
    "id": "00741187-198a-435e-a6b9-499a1e7807d7",
    "created_at": "2023-01-12T14:59:36.997939Z",
    "updated_at": "2025-03-27T02:16:26.337467Z",
    "deleted_at": null,
    "sha1_hash": "6a103c359fa1e70755a84f5a0a0dcff69c85b013",
    "title": "2020-10-19 - GravityRAT- The spy returns",
    "authors": "",
    "file_creation_date": "2022-05-28T19:31:01Z",
    "file_modification_date": "2022-05-28T19:31:01Z",
    "file_size": 1617848,
    "plain_text": "# GravityRAT: The spy returns\n\n**securelist.com/gravityrat-the-spy-returns/99097/**\n\nAuthors\n\n[Tatyana Shishkova](https://securelist.com/author/tatyanashishkova/)\n\n[In 2018, researchers at Cisco Talos published a post on the spyware GravityRAT, used to](https://blog.talosintelligence.com/2018/04/gravityrat-two-year-evolution-of-apt.html)\ntarget the Indian armed forces. The Indian Computer Emergency Response Team (CERT-IN)\nfirst [discovered the Trojan in 2017. Its creators are believed to be Pakistani hacker groups.](https://nic-cert.nic.in/NIC_CERT/pdf/13-Advisory%20for%20Malicious%20Targeted%20Attack%20Campaign.pdf)\nAccording to our information, the campaign has been active since at least 2015, and\npreviously targeted Windows machines. However, it underwent changes in 2018, with\nAndroid devices being added to the list of targets.\n\n## Malicious guide\n\nIn 2019, on VirusTotal, we encountered a curious piece of Android spyware which, when\nanalyzed, seemed connected to GravityRAT. The cybercriminals had added a spy module to\nTravel Mate, an Android app for travelers to India, the source code of which is available on\n\n\n-----\n\n[Github.](https://project-travel-mate.github.io/)\n\n**_Clean Travel Mate app on Google Play_**\n\n\n-----\n\nThe attackers used a version of the app published on Github in October 2018, adding\nmalicious code and changing the name to Travel Mate Pro.\n\n**_The app requests permissions at startup_**\n\n\n-----\n\n**_The Trojan’s manifest file includes Services and Receiver, which are not in the app_**\n**_from Github_**\n\n**_List of Trojan classes_**\n\nThe spyware’s functions are fairly standard: it sends device data, contact lists, e-mail\naddresses, and call and text logs to the C&C server. In addition, the Trojan searches for files\nin the device memory and on connected media with the extensions jpg jpeg log png txt\n\n\n-----\n\n.pdf, .xml, .doc, .xls, .xlsx, .ppt, .pptx, .docx, and .opus, and sends these to C&C as well.\n\nThe malware does not resemble a “typical” Android spy in that the choice of app is rather\nspecific and the malicious code is not based on that of any known spyware app, as is often\nthe case. As such, we decided to look for connections with known APT families.\n\n**_C&C addresses hardcoded into the Trojan_**\n\nThe simplest thing to do is to check the C&C addresses used by the Trojan:\n\nnortonupdates[.]online:64443\nnortonupdates[.]online:64443\n\nAs it turned out, n3.nortonupdates[.]online:64443 was used by another piece of malware to\ndownload data about files found on the computer (.doc, .ppt, .pdf, .xls, .docx, .pptx, .xlsx)\ntogether with data about the infected machine. With the aid of Threat Intelligence, we found\nthis malware: a malicious PowerShell script called Enigma.ps1 that executes C# code.\n\nThe PowerShell script was run using a VBS script:\n\nNext, we detected a very similar VBS script template with no specifiedpaths under the name\niV.dll:\n\n\n-----\n\nIt was located inside the PyInstaller container enigma.exe signed by E-Crea Limited on\n09.05.2019. The installer was downloaded from the site enigma.net[.]in under the guise of a\nsecure file sharing app to protect against ransomware Trojans:\n\n\n-----\n\nBesides the VBS template, inside the container were XML templates for Windows Task\nScheduler under the names aeS.dll, rsA.dll, eA.dll, and eS.dll:\n\nAnd in the main program, the required paths and\nnames were written into the templates and a\n\nscheduled task had\nbeen added:\n\nThe\n\nprogram communicated with the server at the address\ndownload.enigma.net[.]in/90954349.php (note that 90954349A is the start of the MD5 hash\nof the word “enigma”). It featured a simple graphical interface and encryption and file\nexchange logic:\n\n\n-----\n\nThe Mac version has a similar functionality and adds a cron job:\n\nSimilar in functionality to enigma.exe is the app Titanium (titaniumx.co[.]in), signed on\n04.14.2019 by Plano Logic Ltd, certificate revoked on 09.08.2019.\n\nAlongside the Enigma and Titanium payloads were the following spyware Trojans:\n\nWpd.exe, signed 09.17.2018 by Plano Logic Ltd, certificate revoked\nTaskhostex.exe, signed 02.18.2020 by Theravada Solutions Ltd\nWCNsvc.exe, signed on 09.17.2018 by Plano Logic Ltd, certificate revoked\nSMTPHost.exe, signed 12.21.2018 by Plano Logic Ltd, certificate revoked\nCSRP.exe\n\nTheir C&Cs:\n\n\n-----\n\nwindowsupdates[.]eu:46769\nwindowsupdates[.]eu:46769\nmozillaupdates[.]com:46769\nmozillaupdates[.]com:46769\nmozillaupdates[.]us\n\nWe focused on port 46769, used by the above Trojans. The same port was used by the\nGravityRAT family. A further search of nortonupdates[.]online led us to the PE file Xray.exe:\n\nThis version collected data and sent it to n1.nortonupdates[.]online and\nn2.nortonupdates[.]online.\n\nThe domains n*.nortonupdates[.]online resolved to the IP address 213.152.161[.]219. We\nchecked our Passive DNS database for other domains previously found at this address, and\ndiscovered the suspicious looking u01.msoftserver[.]eu. A search of this domain led us to the\napp ZW.exe, written in Python and packaged using the same PyInstaller (signed on\n04.10.2019 by Plano Logic Ltd, certificate revoked on 09.08.2019).\n\nThe C&C addresses called by ZW.exe are decrypted by the AES algorithm from the file\nExtras\\SystemEventBrokerSettings.dat:\n\nmsoftserver[.]eu:64443\nmsoftserver[.]eu:64443\nmsoftserver[.]eu:64443\nmsoftserver[.]eu:64443\n\nCommunication with the server takes place at the relative address /ZULU_SERVER.php.\n\nThe spyware receives commands from the server, including to:\n\n\n-----\n\nget information about the system\nsearch for files on the computer and removable disks with the extensions .doc, .docx,\n.ppt, .pptx, .xls, .xlsx, .pdf, .odt, .odp, and .ods, and upload them to the server\nget a list of running processes\nintercept keystrokes\ntake screenshots\nexecute arbitrary shell commands\nrecord audio (not implemented in this version)\nscan ports\n\nThe code is multiplatform:\n\nThe [characteristic path also confirms that we are dealing with a new version of GravityRAT:](https://blog.talosintelligence.com/2018/04/gravityrat-two-year-evolution-of-apt.html)\n\nThe newer variants of the malware with similar functionality that we detected using Threat\nIntelligence — RW.exe and TW.exe — were signed by Theravada Solutions Ltd on\n10.01.2019 and 02.20.2020, respectively; the certificates are valid.\n\nRW.exe called the C&C server at the relative address /ROMEO/5d907853.php, and TW.exe\nat /TANGO/e252a516.php, so we can assume that the first letter in the name of the\nexecutable file indicates the version of the C&C server.\n\nC&Cs of this instance:\n\nmozillaupdates[.]us\nmozillaupdates[.]us\nmozillaupdates[.]us\nmozillaupdates[.]us\nmicrosoftupdate[.]in\nmicrosoftupdate[.]in\nmicrosoftupdate[.]in\n\n\n-----\n\nmicrosoftupdate[.]in\n\n## Other versions of GravityRAT\n\n### lolomycin&Co\n\nAn older version of GravityRAT, Whisper, in addition to the string “lolomycin2017” (whose\nbyte representation was used as a salt for AES encryption in the component lsass.exe),\ncontained in the component whisper.exe the string “lolomycin&Co” for use as a password to\nunpack downloaded ZIP archives with the payload:\n\nThrough this string, we found newer .NET versions of GravityRAT in the apps:\n\nWeShare\nTrustX\nClick2Chat\nBollywood\n\n## New versions of GravityRAT\n\nAll sites that distribute malware examined below are hidden behind Cloudflare to make it\nhard to determine the real IP.\n\n### .NET versions\n\nSharify\nMelodyMate (signed by E-Crea Limited on 11.05.2019)\n\n\n-----\n\n### Python version\n\n**GoZap**\n\nAnother PyInstaller container. Note that the code explicitly mentions the names of the\npotential payload already familiar to us:\n\n\n-----\n\nDepending on the specific payload, the destination directory is selected, as well as the name\nof the task for Windows Task Scheduler:\n\n**Payload Name** **Path** **Task Name**\n\nZW %APPDATA%\\Programs WinUpdate\n\nSMTPHost %APPDATA%\\WinUpdates Disksynchronization\n\nWCNsvc %APPDATA%\\System Windows_startup_update\n\nCSRP %APPDATA%\\Applications Antivirus_Update\n\nWindows-Portable-Devices %APPDATA%\\ System Updates System_Update\n\n### Electron versions\n\nThe following versions are multiplatform for Windows and Mac based on the Electron\nframework. The logic is as before: the Trojan checks if it is running on a virtual machine,\ncollects information about the computer, downloads the payload from the server, and adds a\nscheduled task.\n\nStrongBox (signed by E-Crea Limited on 11.20.2019)\nTeraSpace (signed by E-Crea Limited on 11.20.2019)\nOrangeVault\nCvStyler (signed by E-Crea Limited 02.20.2020)\n\n\n-----\n\n### Android versions\n\n**SavitaBhabi exists for Windows and Android.**\n\n\n-----\n\nThe Windows version is based on .NET. The functionality is standard: the Trojan checks if it\nis running on a virtual machine and if security software is installed on the computer, transmits\ninformation about the computer to the server, and receives commands in response. It uses\nWindows Task Scheduler to launch the payload. Communication with the server is through\nPOST requests to download.savitabhabi.co[.]in/A5739ED5.php.\n\nThe second file, downloaded from the same site, is the Android app Savitabhabi.apk, which\nis an adult comic strip with an embedded spyware module. Unlike the Travel Mate Pro\nversion, this time it seems that the cybercriminals took a bottom-up approach and wrote the\napp themselves.\n\n\n-----\n\n**_The app requests suspicious permissions at startup_**\n\nThe malicious functionality of this Android app is identical to that of Travel Mate Pro; the C&C\naddresses and code (save for minor details) also coincide:\n\n\n-----\n\n**_List of Trojan classes_**\n\n### Conclusion\n\n[In 2019, The Times of India published an article about the cybercriminal methods used to](https://timesofindia.indiatimes.com/city/lucknow/pakistan-spy-lured-98-targets-with-bots/articleshow/69867201.cms)\ndistribute GravityRAT during the period 2015-2018. Victims were contacted through a fake\nFacebook account, and asked to install a malicious app disguised as a secure messenger in\norder to continue the conversation. Around 100 cases of infection of employees at defense,\npolice, and other departments and organizations were identified.\n\nIt is safe to assume that the current GravityRAT campaign uses similar infection methods —\ntargeted individuals are sent links pointing to malicious apps.\n\nThe main modification seen in the new GravityRAT campaign is multiplatformity: besides\nWindows, there are now versions for Android and macOS. The cybercriminals also started\nusing digital signatures to make the apps look more legitimate.\n\n## IoCs\n\n\n-----\n\nMD5\n\n[Travel Mate Pro — df6e86d804af7084c569aa809b2e2134](https://opentip.kaspersky.com/df6e86d804af7084c569aa809b2e2134/)\n\niV.dll — [c92a03ba864ff10b8e1ff7f97dc49f68](https://opentip.kaspersky.com/c92a03ba864ff10b8e1ff7f97dc49f68/)\n\n[enigma.exe — b6af1494766fd8d808753c931381a945](https://opentip.kaspersky.com/b6af1494766fd8d808753c931381a945/)\n\nTitanium — [7bd970995a1689b0c0333b54dffb49b6](https://opentip.kaspersky.com/7bd970995a1689b0c0333b54dffb49b6/)\n\nWpd.exe — [0c26eb2a6672ec9cd5eb76772542eb72](https://opentip.kaspersky.com/0c26eb2a6672ec9cd5eb76772542eb72/)\n\n[Taskhostex.exe — 0c103e5d536fbd945d9eddeae4d46c94](https://opentip.kaspersky.com/0c103e5d536fbd945d9eddeae4d46c94)\n\nWCNsvc.exe — [cceca8bca9874569e398d5dc8716123c](https://opentip.kaspersky.com/cceca8bca9874569e398d5dc8716123c/)\n\nSMTPHost.exe — [7bbf0e96c8893805c32aeffaa998ede4](https://opentip.kaspersky.com/7bbf0e96c8893805c32aeffaa998ede4/)\n\nCSRP.exe — [e73b4b2138a67008836cb986ba5cee2f](https://opentip.kaspersky.com/e73b4b2138a67008836cb986ba5cee2f/)\n\n[Chat2Hire.exe — 9d48e9bff90ddcae6952b6539724a8a3](https://opentip.kaspersky.com/9d48e9bff90ddcae6952b6539724a8a3)\n\nAppUpdater.exe — [285e6ae12e1c13df3c5d33be2721f5cd](https://opentip.kaspersky.com/285e6ae12e1c13df3c5d33be2721f5cd/)\n\nXray.exe — [1f484cdf77ac662f982287fba6ed050d](https://opentip.kaspersky.com/1f484cdf77ac662f982287fba6ed050d/)\n\nZW.exe — [c39ed8c194ccf63aab1db28a4f4a38b9](https://opentip.kaspersky.com/c39ed8c194ccf63aab1db28a4f4a38b9)\n\nRW.exe — [78506a097d96c630b505bd3d8fa92363](https://opentip.kaspersky.com/78506a097d96c630b505bd3d8fa92363/)\n\nTW.exe — [86c865a0f04b1570d8417187c9e23b74](https://opentip.kaspersky.com/86c865a0f04b1570d8417187c9e23b74/)\n\nWhisper — [31f64aa248e7be0be97a34587ec50f67](https://opentip.kaspersky.com/31f64aa248e7be0be97a34587ec50f67/)\n\n[WeShare —e202b3bbb88b1d32dd034e6c307ceb99](https://opentip.kaspersky.com/e202b3bbb88b1d32dd034e6c307ceb99/)\n\nTrustX — [9f6c832fd8ee8d8a78b4c8a75dcbf257](https://opentip.kaspersky.com/9f6c832fd8ee8d8a78b4c8a75dcbf257/)\n\n[Click2Chat — defcd751054227bc2dd3070e368b697d](https://opentip.kaspersky.com/defcd751054227bc2dd3070e368b697d/)\n\n[Bollywood — c0df894f72fd560c94089f17d45c0d88](https://opentip.kaspersky.com/c0df894f72fd560c94089f17d45c0d88/)\n\nSharify — [2b6e5eefc7c14905c5e8371e82648830](https://opentip.kaspersky.com/2b6e5eefc7c14905c5e8371e82648830/)\n\nMelodyMate — [ee06cfa7dfb6d986eef8e07fb1e95015](https://opentip.kaspersky.com/ee06cfa7dfb6d986eef8e07fb1e95015/)\n\nGoZap — [6689ecf015e036ccf142415dd5e42385](https://opentip.kaspersky.com/6689ecf015e036ccf142415dd5e42385/)\n\n\n-----\n\nStrongBox — [3033a1206fcabd439b0d93499d0b57da (Windows),](https://opentip.kaspersky.com/3033a1206fcabd439b0d93499d0b57da)\n[f1e79d4c264238ab9ccd4091d1a248c4 (Mac)](https://opentip.kaspersky.com/f1e79d4c264238ab9ccd4091d1a248c4)\n\nTeraSpace — [ee3f0db517f0bb30080a042d3482ceee (Windows),](https://opentip.kaspersky.com/ee3f0db517f0bb30080a042d3482ceee/)\n[30026aff23b83a69ebfe5b06c3e5e3fd (Mac)](https://opentip.kaspersky.com/30026aff23b83a69ebfe5b06c3e5e3fd/)\n\nOrangeVault — [f8da7aaefce3134970d542b0e4e34f7b (Windows),](https://opentip.kaspersky.com/f8da7aaefce3134970d542b0e4e34f7b%20/)\n[574bd60ab492828fada43e88498e8bd2 (Mac)](https://opentip.kaspersky.com/574bd60ab492828fada43e88498e8bd2/)\n\nCvStyler — [df1bf7d30a502e6388e2566ada4fe9c8](https://opentip.kaspersky.com/df1bf7d30a502e6388e2566ada4fe9c8/)\n\n[SavitaBhabi — 092e4e29e784341785c8ed95023fb5ac (Windows),](https://opentip.kaspersky.com/092e4e29e784341785c8ed95023fb5ac/)\n[c7b8e65e5d04d5ffbc43ed7639a42a5f (Android)](https://opentip.kaspersky.com/c7b8e65e5d04d5ffbc43ed7639a42a5f/)\n\n### URLs\n\ndaily.windowsupdates[.]eu\n\nnightly.windowsupdates[.]eu\n\ndailybuild.mozillaupdates[.]com\n\nnightlybuild.mozillaupdates[.]com\n\nu01.msoftserver[.]eu\n\nu02.msoftserver[.]eu\n\nu03.msoftserver[.]eu\n\nu04.msoftserver[.]eu\n\nn1.nortonupdates[.]online\n\nn2.nortonupdates[.]online\n\nn3.nortonupdates[.]online\n\nn4.nortonupdates[.]online\n\nsake.mozillaupdates[.]us\n\ngyzu.mozillaupdates[.]us\n\nchuki.mozillaupdates[.]us\n\nzen.mozillaupdates[.]us\n\n\n-----\n\nud01.microsoftupdate[.]in\n\nud02.microsoftupdate[.]in\n\nud03.microsoftupdate[.]in\n\nud04.microsoftupdate[.]in\n\nchat2hire[.]net\n\nwesharex[.]net\n\nclick2chat[.]org\n\nx-trust[.]net\n\nbollywoods[.]co[.]in\n\nenigma[.]net[.]in\n\ntitaniumx[.]co[.]in\n\nsharify[.]co[.]in\n\nstrongbox[.]in\n\nteraspace[.]co[.]in\n\ngozap[.]co[.]in\n\norangevault[.]net\n\nsavitabhabi[.]co[.]in\n\nmelodymate[.]co[.]in\n\ncvstyler[.]co[.]in\n\n[Cyber espionage](https://securelist.com/tag/cyber-espionage/)\n[Phishing](https://securelist.com/tag/phishing/)\n[Phishing websites](https://securelist.com/tag/phishing-websites/)\n[Trojan-Spy](https://securelist.com/tag/trojan-spy/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n\nAuthors\n\n\n-----\n\n[Tatyana Shishkova](https://securelist.com/author/tatyanashishkova/)\n\nGravityRAT: The spy returns\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-19 - GravityRAT- The spy returns.pdf"
    ],
    "report_names": [
        "2020-10-19 - GravityRAT- The spy returns.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535576,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653766261,
    "ts_modification_date": 1653766261,
    "files": {
        "pdf": "https://archive.orkl.eu/6a103c359fa1e70755a84f5a0a0dcff69c85b013.pdf",
        "text": "https://archive.orkl.eu/6a103c359fa1e70755a84f5a0a0dcff69c85b013.txt",
        "img": "https://archive.orkl.eu/6a103c359fa1e70755a84f5a0a0dcff69c85b013.jpg"
    }
}