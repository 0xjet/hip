{
    "id": "9b237cc8-2941-4bd1-935c-835192f7c1a3",
    "created_at": "2023-01-12T15:10:28.242957Z",
    "updated_at": "2025-03-27T02:06:06.181646Z",
    "deleted_at": null,
    "sha1_hash": "6c508a30d0c27145c66fb6cc96f388e5afd05138",
    "title": "2019-02-12 - Trickbot Adds Remote Application Credential-Grabbing Capabilities to Its Repertoire",
    "authors": "",
    "file_creation_date": "2022-05-28T16:00:57Z",
    "file_modification_date": "2022-05-28T16:00:57Z",
    "file_size": 142531,
    "plain_text": "# Trickbot Adds Credential-Grabbing Capabilities\n\n**blog.trendmicro.com/trendlabs-security-intelligence/trickbot-adds-remote-application-credential-grabbing-capabilities-**\nto-its-repertoire/\n\nFebruary 12, 2019\n\n[In November 2018, we covered a Trickbot variant that came with a password-grabbing](https://blog.trendmicro.com/trendlabs-security-intelligence/trickbot-shows-off-new-trick-password-grabber-module/)\nmodule, which allowed it to steal credentials from numerous applications. In January 2019,\nwe saw Trickbot (detected as TrojanSpy.Win32.TRICKBOT.AZ and\nTrojan.Win32.MERETAM.AD) with new capabilities added to its already extensive bag of\ntricks. Its authors clearly aren't done updating Trickbot — we recently found a new variant\nthat uses an updated version of the pwgrab module that lets it grab remote application\ncredentials.\n\n**Infection Chain**\n\n[FIGURE 1Figure 1. Infection chain for the malware](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-1.png)\n\n**Technical Analysis**\n\nThe malware arrives via an email disguised as a tax incentive notification from a major\nfinancial services company. This email includes a macro enabled (XLSM) Microsoft Excel\nspreadsheet attachment (detected as Trojan.W97M.MERETAM.A) that purportedly contains\nthe details of the tax incentive. However, as these attachments usually go, this macro is\nmalicious and will download and deploy Trickbot on the user’s machine once activated.\n\n[FIGURE 2](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-2-1.png)\n\n\n-----\n\n_Figure 2. The spam email containing the malicious macro-enabled attachment._\n\n[FIGURE 3](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-3.png)\n\n_Figure 3. Screenshot of the attached spreadsheet document_\n\nThis Trickbot variant is largely similar to the variant we discovered in November. However,\nthe 2019 version adds three new functions, one each for the Virtual Network Computing\n(VNC), PuTTY, and Remote Desktop Protocol (RDP) platforms.\n\n[FIGURE 4](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-4.png)\n\n_Figure 4. Comparison of the pwgrab modules from November 2018 (top) and January 2019_\n_(bottom). Note the added functions in the code._\n\n[FIGURE 5](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-5-1.png)\n\n_Figure 5. C&C traffic with the RDP credentials being sent._\n\nOne of the techniques enforced by these new functions encrypts the strings it uses via\nsimple variants of XOR or SUB routines.\n\n[FIGURE 6](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-6.png)\n\n_Figure 6. XOR routine (top) and SUB routine (bottom) string encryption._\n\nIt also makes use of API hashes for indirect API calling, which was prominently attributed to\n[the Carberp trojan source code leak from 2013.](https://threatpost.com/carberp-source-code-leaked/101070/)\n\n[FIGURE 7](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-7.png)\n\n_Figure 7. API hashing artifact from the Carberp Source Code._\n\n**VNC**\n\nTo grab VNC credentials, the pwgrab module searches for files using the “*.vnc.lnk” affix that\nare located in the following directories:\n\n_%APPDATA%\\Microsoft\\Windows\\Recent_\n_%USERPROFILE%\\Documents, %USERPROFILE%\\Downloads_\n\nThe stolen information includes the target machine's hostname, port, and the proxy settings.\n\n[FIGURE 8](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-8.png)\n\n_Figure 8. Screenshot of how pwgrab locates “.vnc.lnk” files on the_\n_%USERPROFILE%\\Downloads directory._\n\n\n-----\n\nThe module will send the required data via POST, which is configured through a downloaded\nconfiguration file using the filename “dpost.” This file contains a list of command-and-control\n(C&C) servers that will receive the exfiltrated data from the victim.\n\n[FIGURE 9](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-9.png)\n\n_Figure 9. Stolen Information being exfiltrated to the C&C server._\n\n**PuTTY**\n\nTo retrieve the PuTTY credentials, it queries the registry key\n_Software\\SimonTatham\\Putty\\Sessions to identify the saved connection settings, which_\nallows the module to retrieve information such as the Hostname and Username, and Private\nKey Files used for authentication.\n\n[FIGURE 10](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2019/02/Trickbot-Remote-Application-10.png)\n\n_Figure 10. Registry traversal for Putty data exfiltration (left), code showing hostname,_\n_username and Private Key Files (right)._\n\n**RDP**\n\nIts third function related to RDP uses the CredEnumerateA API to identify and steal saved\ncredentials. It then parses the string “target=TERMSRV” to identify the hostname,\nusername, and password saved per RDP credential.\n\n**Recommendations**\n\nThese new additions to the already “tricky” Trickbot show one strategy that many authors use\nto improve the capabilities of their creations: gradual evolution of existing malware. While this\nnew variant is not groundbreaking in terms of what it can do, it proves that the groups or\nindividuals behind Trickbot are not resting on their laurels and continuously improve it,\nmaking an already-dangerous malware even more effective.\n\n[Fortunately, users can nip these attacks in the bud simply by following the best practices](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/infosec-guide-email-threats)\nagainst spam. This includes being aware of the main characteristics of a spam email, such\nas a suspicious sender address and multiple grammatical errors. We also recommended that\nusers refrain from opening email attachments unless they are sure that it is from a legitimate\nsource.\n\n**Trend Micro solutions**\n\n[The following Trend Micro solutions, powered by XGen™ security, protect systems from all](https://blog.trendmicro.com/en_us/business/products/network/intrusion-prevention/threat-intelligence.html)\ntypes of threats, including malware such as Trickbot:\n\n[Trend Micro™ Security](https://blog.trendmicro.com/en_us/forHome/products.html)\n[Smart Protection Suites and](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [Worry-Free™ Business Security](https://blog.trendmicro.com/en_us/small-business.html)\n\n\n-----\n\n[Trend Micro Network Defense](https://blog.trendmicro.com/en_us/business/products/network.html)\n\n**Indicators of Compromise (IOCs)**\n\n**Trickbot (Detected as TrojanSpy.Win32.TRICKBOT.AZ)**\n\n374ef83de2b254c4970b830bb93a1dd79955945d24b824a0b35636e14355fe05\n\n**Trickbot (Detected as Trojan.Win32.MERETAM.AD)**\n\nFcfb911e57e71174a31eae79433f12c73f72b7e6d088f2f35125cfdf10d2e1af\n\nMalware\n\nTrickbot's authors clearly aren't done updating it — we recently found a new variant that uses\nan updated version of the pwgrab module that lets it grab remote application credentials.\n\nBy: Noel Anthony Llimos, Carl Maverick Pascual February 12, 2019 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-12 - Trickbot Adds Remote Application Credential-Grabbing Capabilities to Its Repertoire.pdf"
    ],
    "report_names": [
        "2019-02-12 - Trickbot Adds Remote Application Credential-Grabbing Capabilities to Its Repertoire.pdf"
    ],
    "threat_actors": [
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536228,
    "ts_updated_at": 1743041166,
    "ts_creation_date": 1653753657,
    "ts_modification_date": 1653753657,
    "files": {
        "pdf": "https://archive.orkl.eu/6c508a30d0c27145c66fb6cc96f388e5afd05138.pdf",
        "text": "https://archive.orkl.eu/6c508a30d0c27145c66fb6cc96f388e5afd05138.txt",
        "img": "https://archive.orkl.eu/6c508a30d0c27145c66fb6cc96f388e5afd05138.jpg"
    }
}