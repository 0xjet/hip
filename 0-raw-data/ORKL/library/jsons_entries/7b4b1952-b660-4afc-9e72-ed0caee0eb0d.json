{
    "id": "7b4b1952-b660-4afc-9e72-ed0caee0eb0d",
    "created_at": "2023-01-12T15:01:35.488697Z",
    "updated_at": "2025-03-27T02:16:17.061333Z",
    "deleted_at": null,
    "sha1_hash": "51258b4135312d81a17174577ba5380c66708be7",
    "title": "2021-12-08 - Chasing Shadows- A deep dive into the latest obfuscation methods being used by ShadowPad",
    "authors": "",
    "file_creation_date": "2022-05-28T17:44:22Z",
    "file_modification_date": "2022-05-28T17:44:22Z",
    "file_size": 135832,
    "plain_text": "# Chasing Shadows: A deep dive into the latest obfuscation methods being used by ShadowPad\n\n**pwc.co.uk/issues/cyber-security-services/research/chasing-shadows.html**\n\n08 December, 2021\n\n**By Adam Prescott, Cyber Threat Intelligence Analyst, PwC**\n\nWhile monitoring for the backdoor known as ShadowPad, our threat intel practice discovered a bespoke packing\nmechanism – which we named ScatterBee – being used to obfuscate malicious 32-bit and 64-bit payloads for\nShadowPad binaries. The obfuscation mechanism has been briefly touched on in open source;1 however in this blog we\ndetail how the technique works, ways to analyse binaries obfuscated in this manner, and how to find further samples\nobfuscated with this bespoke method. This content has previously been made available privately to clients via PwC’s\nintelligence subscription service.\n\nDuring our analysis, further malicious samples were uncovered which indicate that one or more users of ShadowPad\nhave access to ScatterBee, and have highly likely delivered some of these malicious payloads via watering hole attacks\non sites that are used to deliver Adobe Flash update files.\n\nMost of the malicious ScatterBee files can be directly linked back to a China-based threat actor that we are currently\ntracking as Red Dev 10.\n\n## Analysis\n\nThroughout the rest of this blog we will detail a series of obfuscation techniques that, when combined, we assess is the\nresult of a packing mechanism we call ScatterBee. The ScatterBee packing mechanism consists of control flow\nobfuscation, string encoding, dynamic API resolutions, several anti-analysis techniques and shellcode\ndecoding/decrypting.\n\n[For anyone wanting to replicate the analysis detailed in this blog, we have provided an accompanying GitHub repository](https://github.com/PwCUK-CTO/ScatterBee_Analysis)\ncontaining scripts and a walkthrough.\n\n### The malicious DLL loader\n\n\n-----\n\nDiscovery of the ScatterBee obfuscation began with a file tagged by ESET on an online multi antivirus scanner as a\nvariant of Win32/Shadowpad.L”.\n\n**SHA-256** a8e5a1b15d42c4da97e23f5eb4a0adfd29674844ce906a86fa3554fc7e58d553\n\n**Filename** log.dll\n\n**File type** Win32 DLL\n\n**File size** 209,408 bytes\n\n**Compilation timestamp** 31/07/2020 08:08:43\n\nThis DLL exports one seemingly benign function called “log”, which just writes a given string to %TEMP%\\log.txt, as well\nas exporting its entry point function.\n\nThe entry point function, which is automatically called when an executable loads this DLL, contains guardrails to make\nsure the executable loading log.dll has specific bytes at specific offsets, as seen in Figure 1.\n\n**Figure 1 - Checking bytes in calling executable**\n\nSearching for files with these bytes at these positions returns an MPRESS packed file that is likely a legitimate version\nof BDReinit.exe, a component of BitDefender. We have observed a similar guardrail technique in previous ShadowPad\nsamples.2\n\nOnce the malicious DLL has verified it is being loaded by the target version of BDReinit.exe it will overwrite the parent\nexecutable’s entry point with a call into its own code.\n\n**Figure 2 - Overwriting the entry point of the parent executable**\n\nThis is a common technique used by various malware families originating from China-based threat actors – notably in\nPlugX loaders – to gain execution of the malicious DLL’s code while running as the original and legitimate executable’s\nprocess.\n\nOnce the parent executable has finished loading its required DLLs, it will then execute code from its entry point, which\nnow points to code in the malicious DLL. This is where the first unique obfuscation technique employed by ScatterBee is\nfound.\n\nFigure 3 - Calls to an obfuscated jump routine\n\nEach of the calls to loc_100095f1 in Figure 3 are used to calculate where the next instruction to be executed is located.\nThe code in this function makes use of pairs of inverted conditional branches to identical locations to further obfuscate\nhow the destination is calculated, as seen in Figure 4.\n\nFigure 4 - Opposing conditional branches\n\nThe result of the obfuscated code is to take the return address (the memory location immediately after the call) that is on\nthe stack, get the next four bytes from memory, add them to the return address and then jump to the calculated address.\n\nFigure 5 - Offsets used to calculate destination addresses\n\nIn the first highlighted example in Figure 5 the current return address is 0x100128c0; adding the 32-bit value 0xffff81ed\nto this address results in a target address of 0x1000aaad. From this point on every single instruction in the malicious\nDLL is followed by an obfuscated jump to the next address, preventing disassemblers from being able to follow the\ncontrol flow of the sample. As a first attempt at deobfuscating the malicious code we replaced the calls to the obfuscated\naddress calculation function by jmp instructions which jump to the correct location. The results of this can be seen in\nFigure 6.3\n\nFigure 6 - Fixed control flow\n\n\n-----\n\nThe resulting code has similar instructions to a standard function epilogue (push ebp; mov ebp, esp) but then has a\nstrange comparison instruction comparing the stack register – esp – to 0xe1cf. This is the second technique that\nScatterBee employs to obfuscate control flow. Throughout the malicious code, the stack is compared to various low\nvalues and then a conditional jump is placed after the check. This fools disassemblers into thinking the code could take\nthe jump if the current stack register is a small value. In practice, it is impossible for the stack register to be a small\nvalue, as on x86 and x64 systems the stack is placed in high memory ranges. Further, the targets of the conditional\njumps are often into the middle of existing instructions, or to code halfway through functions which prevents\ndisassemblers and decompilers from correctly analysing the flow of execution.\n\nBoth of these techniques are likely applied as part of a custom compiler pass4 as they significantly modify the control\nflow of the binary, which is easiest to do before the final assembly instructions have been generated. It is uncommon for\nChina-based actors to employ such extensive custom obfuscation techniques and indicates either a greater level of\ncapability or a greater need to avoid detailed analysis once discovered than other China-based threat actors. Similar\ntechniques have been seen used by financially motivated threat actors (e.g. DoppelPaymer ransomware binaries) who\ngo to extreme lengths to avoid their malware being analysed.\n\nThere are several approaches that could aid in statically analysing code obfuscated in this way, however we have taken\nthe route of rebuilding the malicious binary with the jump and stack obfuscations removed. In doing this, the resulting\nbinary will be very close to what would be produced from compiling the original source code with a standard compiler.\n\nFigure 7 - Deobfuscated code from Figure 6\n\nThe results of this deobfuscation can be seen in Figure 7.5 This demonstrates the benefit of this approach as in Figure 6\nonly the first three meaningful instructions were able to be displayed in an analysis tool, whereas in the deobfuscated\nbinary a plain disassembly listing is evident, showing many more instructions while taking up less space.\n\nWe chose to leave the stack comparison instructions in the deobfuscated binary while removing the fake branches for\ntwo reasons; firstly they do not affect execution of the sample as the obfuscation technique ensures they are never\nplaced between a valid comparison instruction and its resulting conditional jump; and secondly each numerical value\nused in the obfuscated comparison instruction occurs exactly once in the original obfuscated sample; this means that\nwhen analysing the deobfuscated sample an analyst can verify that the output of the deobfuscation tool is accurate by\nsearching for the constant value used in the original binary and checking the expected instructions in both binaries\nmatch up.\n\nWith a rebuilt binary, decompilation tools were then able to successfully analyse the malicious binary. The differences in\noutputs are clearly demonstrated in Figure 8 and Figure 9 with the same code being attempted to be decompiled in both\nfigures.\n\nFigure 8 - Decompilation before deobfuscation\n\nFigure 9 - Decompilation after deobfuscation\n\nThe next obfuscation technique employed by ScatterBee is to resolve API functions dynamically at runtime. This is\nachieved by decoding strings specifying the library and function names required, then searching the Process\nEnvironment Block (PEB) for the kernel32 functions LoadLibraryA and GetProcAddress and using them to retrieve a\npointer to the needed function. The string encoding algorithm is used extensively by ScatterBee obfuscated binaries for\nAPI call obfuscation, data obfuscation and string obfuscation.6\n\nThe encoding algorithm is a stream cipher that takes a 32-bit value as a seed and for each byte in the encoded string:\n\nMultiplies the current seed by 17;\nSubtracts the 32-bit constant value 0x443246ba from the seed;\nStores the result as the seed for the next iteration; and,\nSums each byte of the resulting seed to give the final XOR byte to use with the current encoded byte.\n\nThis algorithm will generate a pseudo random sequence of bytes that will be different for each seed used. Different\nvalues have been observed being used as the subtraction value in the algorithm. Sometimes the algorithm terminates\nwhen it decodes a null character, while other implementations have it run over a fixed number of bytes.\n\n\n-----\n\nOnce these obfuscation methods have been dealt with, it is possible to analyse the functionality of this malicious DLL. It\nwill look for a file in the same folder called log.dll.dat and read the contents. The first four bytes of the file are a littleendian integer to use as the seed value with the previously described encoding algorithm. In this instance, the value\n0x107e666d is added to the seed during each iteration instead of having 0x443246ba subtracted.7\n\nA buffer is created in memory for the decoded payload, using VirtualAlloc with a length 4,096 bytes greater than the\nlength of the payload. The extra space is so that the malware can generate a random number less than 4,096 via a call\nto QueryPerformanceCounter, and then use the value as an offset into the buffer to write the payload. This will prevent\nsome detection methods that rely on malicious payloads being written at the start of memory segments and also hinder\nanalysts in determining the entry point of the payload when analysing the sample dynamically.\n\n### The malicious payload\n\n**SHA-256** 8065da4300e12e95b45e64ff8493d9401db1ea61be85e74f74a73b366283f27e\n\n**Filename** log.dll.dat\n\n**File type** Binary\n\n**File size** 861,074 bytes\n\nThe payload is position independent shellcode that uses the same ScatterBee obfuscation techniques as the loader.\nAfter deobfuscating the payload to rebuild analysable code there are numerous calls to addresses that are outside the\npayload’s loaded memory (Figure 10).\n\nFigure 10 - Calls using invalid memory locations\n\nThis is caused by a further obfuscation technique that is employed by ScatterBee shellcode to patch specific parts of the\nshellcode at run time. The logic for how the shellcode finds and applies the patches to its own memory is described\nbelow.\n\nThe first function that the shellcode calls searches through its own memory for a configuration data section by checking\nthat there are six specific integer values consecutively in memory. It XORs every four bytes in the shellcode with\n0xAD48FB1D, checking whether the following integer matches the result. Once a match is found it then checks that the\nnext following integer, XORed with 0xE642D205, matches its subsequent integer value and that the integer after that,\nXORed with 0x868910EE, also matches its subsequent integer value. The valid data in this sample that signifies the\nstart of the configuration information is shown in Figure 11.\n\nFigure 11 – XOR bytes at start of config\n\nThe three integers that immediately follow these XOR bytes represent the size of the code section (0xC9000), data\nsection (0x3000) and patch metadata section (0x5AD0) of the shellcode. It further checks the integrity of the payload by\nchecking that the first byte of the shellcode is 0xE9, which corresponds to the initial jmp instruction used by the\nmalware. This is designed to thwart a common malware analysis technique of loading a payload into memory with a\nbreakpoint on the first instruction which has the effect of replacing the first byte (0xE9) with 0xCC.\n\nOnce the shellcode has passed these checks it uses the patch metadata section to overwrite data in its own memory.\nThe metadata section is an array of pairs of four-byte integer values, the second integer value in each pair is used as\nthe value to overwrite the four bytes in the shellcode at the offset specified by the first integer value.8\n\nThe same code from Figure 10 after the patching has been applied can be seen in Figure 12.\n\nFigure 12 - Patched function calls\n\n\nAfter we have removed the ScatterBee obfuscation layers from the shellcode, the final payload can be analysed in\ndetail. In this instance, the payload matches what is described as ShadowPad.4 in open source.9\n\nAn example of configuration information in a 32-bit sample is shown in the following structure:\n\n\n-----\n\ng\n\n**Offset** **Size** **Description**\n\n0x0 6 DWORDs Used to mark the start of the config\n\n0x18 DWORD Size of code section of shellcode\n\n0x1c DWORD Size of data section of shellcode\n\n0x20 DWORD Size of patch metadata section\n\n0x24 DWORD Space for pointer to obfuscated data written at runtime\n\n0x28 DWORD Value of 0,1,2 or 3 used to determine the operating mode of the backdoor\n\n0x2c DWORD If set; target PID queried during backdoor operation\n\n0x34 19 WORDs An array containing relative offsets to obfuscated strings\n\n0x5a Six DWORDs Null padding\n\n0x72 4 WORDs An array containing relative offsets to obfuscated strings\n\n0x7a 16 BYTEs 0x08 repeated – reason unknown\n\n0x8a DWORD Value 0x1e – reason unknown\n\n0x8e DWORD Null padding\n\n0x92 DWORD Value 0x350b – reason unknown\n\n0x96 10 DWORDs Null padding\n\n0xbe Variable Start of obfuscated string data used with relative offset arrays\n\nEach of the offsets in the arrays at 0x34 and 0x72 in the configuration structure point to an obfuscated string that is used\nby the ScatterBee encoded ShadowPad payloads to specify sample specific variables such as C2s and filenames to\nuse. The obfuscated strings consist of one WORD to use as a decoding seed, a WORD specifying the length of the\nencoded string, and then the encoded data.\n\nExamples of each of these decoded strings with a description of possible usage is shown in the table below. The first 19\nentries correspond to the array starting at 0x34 and the final four entries correspond to the array starting at 0x72.\n\nTable 2 - Configuration strings\n\n**Description** **Example data (multiple shown where configs have differences across samples)**\n\nTimestamp “2020/10/26 16:31:13”, “6/30/2020 1:25:52 PM”\n\nCampaign code “Chrome.exe”, “ccc”\n\nFilepath “%ALLUSERSPROFILE%\\\\DRM\\\\Chrome\\\\”, “%PROGRAMDATA%\\\\”\n\nSpoofed name “Chrome.exe”, “msdn.exe”\n\nLoader filename “log.dll”\n\nPayload filename “log.dll.dat”\n\nService name “Chrome_update”, “WMNetworkSvc”\n\nAlternative service name “Chrome_update”, “WMNetworkSvc”\n\nAlternative service name “Chrome_update”, “WMNetworkSvc”\n\n\n-----\n\nRegistry key path “SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run”\n\nPossibly service description “Chrome_update”, “WMSVC”\n\nProgram to inject into “%ProgramFiles%\\\\Windows Media Player\\\\wmplayer.exe”\n\nAlternative injection target “%windir%\\\\system32\\\\svchost.exe”\n\nAlternative injection target “%windir%\\\\system32\\\\winlogon.exe”\n\nAlternative injection target “%windir%\\\\explorer.exe”\n\nC2 “TCP://207.148.98[.]61:443”\n\nAlternative C2 “UDP://cigy2jft92[.]kasprsky[.]info:53”\n\nAlternative C2 Empty string\n\nAlternative C2 Empty string\n\nProxy info string “SOCKS4\\n\\n\\n\\n\\n”\n\nProxy info string “SOCKS4\\n\\n\\n\\n\\n”\n\nProxy info string “SOCKS5\\n\\n\\n\\n\\n”\n\nProxy info string “SOCKS5\\n\\n\\n\\n\\n”\n\n### 64-bit variations\n\nAs alluded to previously, we also found 64-bit versions of ShadowPad obfuscated with ScatterBee. The following table\nshows the details of one of the 64-bit loaders.\n\n**SHA-256** c72436969d708905901ac294d835abb1c4513f8f26cb16c060d2fd902e1d5760\n\n**Filename** secur32.dll\n\n**File type** Win64 DLL\n\n**File size** 142,848 bytes\n\n**Compilation timestamp** 2040-04-30 05:32:44\n\nWhereas all of the 32-bit loaders found so far have had the filename log.dll, we have found that the 64-bit ScatterBee\nloaders are named either mscoree.dll or secur32.dll. The functionality of these loaders is identical to the 32-bit variants,\nin that they search the current directory for a file with the same name as themselves with “.dat” appended\n(secur32.dll.dat or mscoree.dll.dat), then deobfuscate and load it into memory.\n\nIn 32-bit versions of ScatterBee loader files, there are a limited number of strings in plaintext in the .data section of the\nmalicious binary, along with plaintext stack strings for kernel32, LoadLibraryA and GetProcAddress, whereas in the 64bit samples there are no strings relating to the ScatterBee encoded sections. Some 64-bit ScatterBee files also employ\na different encoding algorithm to the stream cipher in various places, and may hint that several different users of\nScatterBee have added their own take on obfuscation to the tool.\n\nThe encoding algorithm predominantly seen in 64-bit ScatterBee samples uses a combination of MD5 and AES to\ndecode data. The process is as follows:\n\nTakes 16 hardcoded bytes from the shellcode, along with the final four bytes of the encoded data and MD5 hash\nthem;\nUses CryptDeriveKey with the resulting hash as input to generate an AES-128 key; and,\nCalls CryptDecrypt on the encoded data (minus the final four bytes used to create the key).\n\n\n-----\n\nThe below table shows the details of an encoded, 64 bit ScatterBee payload.\n\n**SHA-256** 943778353ce3af1043ec161ef18c9ba3e1ad6a9915dfe1783dff7aac8b53df16\n\n**Filename** secur32.dll.dat\n\n**File type** Binary\n\n**File size** 608,679 bytes\n\nThe configuration data in these samples starts with a similar section of six DWORDs that are used as XOR markers,\nalong with the sizes of the code, data, and patch sections of the payload. However the subsequent data is a series of\nobfuscated chunks.\n\nEach chunk begins with a four-byte marker that contains the chunk ID in the high byte, and the length of the chunk in\nthe lowest three bytes. For example, the DWORD 0x80000774 has a chunk type of 0x80 and a length of 0x774 bytes.\nThe chunks are decoded by using either of the previously described algorithms - the stream cipher, or the MD5 and AES\nalgorithm.\n\nIn the payloads that we have access to, these chunks contain various different IDs. The chunks with 0x80 as their chunk\ntype contain similar data to the 32-bit configuration data,10 although the encoded strings can use either the AES\nencoding algorithm or the stream cipher algorithm. Chunks with an ID of 0x02 contain 0x20 bytes of unknown data\nfollowed by a valid PE file. These PE files are ShadowPad modules that further enhance the capabilities of the running\nbackdoor. In files seen by PwC, some are obfuscated with ScatterBee techniques and some are not. We have not seen\nany other IDs in chunks from samples that we have analysed, however, from the code in the ShadowPad backdoor it\nsupports further chunks with IDs of 0x83, 0x84, 0x90, 0x91, 0x92 and 0xa0.\n\n### Further malicious files\n\nPivoting on the names of the DLL loaders and the code sequences used to calculate the obfuscated jumps uncovered\n25 malicious DLLs obfuscated with ScatterBee and 10 further malicious payload files that use ScatterBee\nobfuscation/packing.\n\nPivoting on the stack comparison code also uncovered trojanised flash installers, a malicious loader and a ZIP archive\n(detailed in Table 3). All of these malicious files are part of an execution chain that executes variants of ShadowPad,\nand so far PwC has not found any files obfuscated with ScatterBee that do not deliver ShadowPad, likely indicating that\nScatterBee is a core part of the build process of one or more ShadowPad users.\n\nTable 3 - Early stage ScatterBee files\n\n**SHA-256** **Description**\n\n\nf7ef194f2dcc341ba03f76872cb7c0dfbae8f79118f99cf73dfccfb146c4e966\n\n\nDrops and executes a DLL search\norder hijacked Oleview.exe.\n\n\n39f92aed5dfa2cd20ae7df11e16acce9bb2e80c7e6539bc81f352d42ab578eb6 Trojanised flash installer.\n\nebe4347e993c81d145b68a788522d5c554edfa74c35e9e61ededd6c510e80c75 Trojanised flash installer.\n\ndbb02aaea56a1f0200b76f3f5b2d3596622503633285c7798b4248e0a558f01c ZIP archive containing Oleview.exe\nalong with a malicious DLL and\npayload.\n\nThe trojanised installers both contain the same logic for executing their embedded payloads. The initial file is a 64-bit\nWindows executable that writes two files from its resource section to disk in the folder returned by GetTempPathA. The\nnames and descriptions of the files dropped are as follows:\n\nA hack tool, named “Microsoft.Win32.TaskScheduler.dll”, for carrying out operations relating to Windows Task\nScheduler ;11 and,\nA malicious second stage loader named “td Principal UserId = exe”\n\n\n-----\n\n**SHA-256** 2a3cf204dcc977df6347a039428ae863066700cecfac965dcaeb7b9bd61bc1b6\n\n**Filename** td.Principal.UserId =.exe\n\n**File type** 64-bit .NET executable\n\n**File size** 9,757,184 bytes\n\n**Compilation timestamp** 2042-06-11 00:17:24\n\nThe Task Scheduler hack tool is not executed by this or any other stage seen by PwC, and is highly likely an artefact of\nthe build process that supports a persistence mechanism not used by this sample. However, the second stage loader\n(“td.Principal.UserId =.exe”) is executed by the trojanised installer in a call to CreateProcessA. This second stage loader\nis a .NET executable responsible for dropping and executing a legitimate Adobe Flash installer and a DLL search order\nhijacked copy of Oleview.exe, as well as creating a task that runs as a LogonTrigger.\n\nFirst, the malicious loader will attempt to disable all network adapters returned by a query of “SELECT * From\nWin32_NetworkAdapter”. Then, it reads five resources from its own resources section and writes them to disk as the\nfollowing:\n\nTable 4 - Dropped files\n\n**File path** **SHA-256**\n\n%TMP%\\OLEVIEW.exe12 2e642afdd36c129e6b50ae919ca608ac0006ce337f2a5a7a6fb1eef6a4ad99e7\n\n\n%TMP%\\IVIEWERS.dll e328060057f454232aab79a2c521414ee110c13925ac53e1bfacd7f2155e38d2\n\n%TMP%\\IVIEWERS.dll.dat 9cbfa03a65e6cd4b62b2aa60a4cc4785b824378f735de2596a1195b75f71ecf3\n\n%TMP%\\helper.exe f4effcf4d7321be824fd637b27f404250d0b1f03205bbc0682022d61aba5801e\n\n%TMP%\\flashplayerax_install_cn_fc.exe c4edf7b8cdffb67fcd62ef81485c04648b11a14a8452f407133f131e2f74a57a\n\nNext it will create a new TaskDefinition (registered as “FlashUpdate”) with an action that is triggered by LogonTrigger\nwith the following details:\n\nTable 5 - Persistence task details\n\n**Field** **Value**\n\nRegistrationInfo.Description Adobe Tech.co\n\nRegistrationInfo.Author Adobe Tech.co\n\nPrincipal.UserId system\n\nActions ExecAction with an argument of %TMP%\\helper.exe\n\nWith the persistence task registered, the .NET executable reenables the network adapters and creates three processes\nto execute the dropped .exe files.\n\nThe first three files in Table 4 are a DLL search order hijacking triplicate of files with similar functionality to the\nScatterBee files described earlier in this report. When the legitimate Oleview.exe is executed by the .NET executable it\nwill load the malicious IVIEWERS.dll, which will in turn load and execute the malicious ScatterBee obfuscated\nShadowPad payload contained in IVIEWERS.dll.dat.\n\nflashplayerax_install_cn_fc.exe is also executed by the .NET executable and is a legitimate Adobe Flash installer.\n\n\n-----\n\nhelper.exe is a binary written in Go, which acts as a HTTP server and serves up the response Hello! when any client\nconnects to it. It is highly likely that this is another artefact left in the loader by accident, or that is still under\ndevelopment, to allow the threat actor to gain persistence on the victim machine via a secondary backdoor.\n\nThe file f7ef194f2dcc341ba03f76872cb7c0dfbae8f79118f99cf73dfccfb146c4e966, from Table 3, is a similar dropper to\nthe first stage of the trojanised installers; however, in this case it simply drops the three OLEVIEW related files straight\nto disk and executes them.\n\nThese first stage droppers also have strings and logic embedded in them to support dropping and executing two further\nfiles that were not present in these samples - %TMP%\\flsh.exe and %TMP%\\schost.exe.\n\nAmong the additional DLLs discovered, there was a cluster of eight files that stand out from the rest.\n\nTable 6 – Xiamen submitted DLLs\n\n**SHA-256** **Filename**\n\n8396e35b19f906f9c6e342e6cd90ab8bbbecc90f9090b0afe68f4fa53530bc33 ALTTEST.dll\n\n15371908d89caef3f4487298a452e58732d9f671f2c6a1f07036d123ce3c840d ALTTEST.dll\n\na41348407e01886e76baf7cb8bb0efcf790b213cab87924b8a4f6bf8a9502350 ALTTEST.dll\n\n02a18df00e241f82cecb7477f661ebe3f26012cdfc5b8172d634c07af4468130 ALTTEST.dll\n\n7c8b6dfcdbcb6e0d87513eec841302a202e7371cdff16101d1594ea34a8dd1af ATLTEST.dll13\n\n\nc951a1d1294c46c995189dce4a70da0460dd19c0b7136a4905f41212cdead0c7 ALTTEST.dll\n\nf768bd36e88ffa496e7b6c538f2259cbdab0317e88432a99050f550b4c9f2f12 ALTTEST.dll\n\nc738af04c5b531abdb303a68cfb8994bb8db6e088bf99b45f85bdb863d3fb3e5 MyDRes.dll\n\nAll of the files in Table 6 were submitted to an online multi-antivirus scanner from locations in Xiamen, China. All of the\nfiles have an exported DLL name of Dll.dll, and all apart from the last one were also submitted by the same submitter ID\nwithin the space of about 20 minutes. Each of these files are slightly different DLLs: some are MFC binaries, some are\nmeant to be run as Service DLLs; however, all of them contain almost identical copies of ScatterBee packed shellcode\nto load a .dat file into memory. Only two of these samples have code that would enable the ScatterBee shellcode to run\nif loaded with an appropriate executable file:\n\nf768bd36e88ffa496e7b6c538f2259cbdab0317e88432a99050f550b4c9f2f12; and,\nc738af04c5b531abdb303a68cfb8994bb8db6e088bf99b45f85bdb863d3fb3e5.\n\nAll the other files either, will not run the packed shellcode, or would require another loader beyond just an executable\nimporting their DLL.\n\nThe clustering of file submissions from the same location, the similarity of the files exported names, the presence of\nalmost identical copies of ScatterBee packed shellcode, the mixture of functioning and none-functioning samples, and\nthe submission name of ALTTEST.dll in many of these samples all add weight to the possibility that a developer or user\nof ScatterBee is based in Xiamen, and was testing and/or developing the ScatterBee packer during January 2021.\nAlternatively, there is a possibility that these submissions are from a researcher related to Positive Technologies, as\ntheir public blog on this malware family was published the day after these submissions to the online multi-antivirus\nscanner.\n\n## Targeting\n\nBased on submissions to an online multi-antivirus scanner of the obfuscated payloads, it is highly likely that the threat\nactor using the ScatterBee obfuscated ShadowPad binaries has targeted:\n\nA military organisation in Afghanistan;\n\n\n-----\n\nAn aviation organisation in Hong Kong; and,\nA company with a security operations centre based in India.\n\nThere are also numerous submissions from users based in China, some of which may represent testing whether the\ncurrent version of the malicious file is detected by antivirus vendors, and others that are likely organisations based in\nChina that are being targeted by a ShadowPad user. This targeting is consistent with our historical tracking of\nShadowPad victims, based on communications with known command and control servers.\n\n## Infrastructure\n\nWhen extracting the ShadowPad payloads from the ScatterBee encoded payloads we found the following C2s in use in\nthe configuration sections of the backdoors:\n\nTable 7 - ScatterBee encoded ShadowPad C2s\n\n**SHA-256** **Configured C2s**\n\n5f1a21940be9f78a5782879ad54600bd67bfcd4d32085db7a3e8a88292db26cc cigy2jft92[.]kasprsky[.]info\n\n0371fc2a7cc73665971335fc23f38df2c82558961ad9fc2e984648c9415d8c4e ti0wddsnv[.]wikimedia[.]vip\n\nc602456fae02510ff182b45d4ffb69ee6aae11667460001241685807db2e29c3 6czumi0fbg[.]symantecupd[.]com\n\n04089c1f71d62d50cbd8009dfd557aa1e6db1492a9fa2b35902182c07a0ed1c1 yjij4bpade[.]nslookup[.]club\n\n8065da4300e12e95b45e64ff8493d9401db1ea61be85e74f74a73b366283f27e 207.148.98[.]61\n\nfb17b3886685887aeb8f7c3496c6f7ef06702ec1232567278286c2f8ec4351bb 172.18.165[.]105 (private IP)\n\n943778353ce3af1043ec161ef18c9ba3e1ad6a9915dfe1783dff7aac8b53df16 kazehaya0110[.]chickenkiller[.]com\n\n7579e864d47898f1322bb189bdd21b537b40e549149318ce8409f1d57233fa48 fljhcqwe[.]com\n\n9cbfa03a65e6cd4b62b2aa60a4cc4785b824378f735de2596a1195b75f71ecf3 a[.]fljhcqwe[.]com\n\nThe first four domains in Table 7 were already tracked by us as Red Dev 10, and have resolved to IP addresses that\nhave previously shown up in our scans for ShadowPad C2s. Pivoting on these domains and IPs uncovers a highly\nconnected set of infrastructure that includes the following domains, most of which also have numerous subdomains that\nhave been observed used as C2 addresses in other variants of ShadowPad.\n\nTable 8 - Red Dev 10 domains\n\n\n**Domains**\n\n\ndnslookup[.]services\n\n\nlivehost[.]live\n\n\nwindowshostnamehost[.]club\n\n\nkasprsky[.]info\n\n\nsymantecupd[.]com\n\n\nwikimedia[.]vip\n\nnslookup[.]club\n\nRed Dev 10 has made a habit of using NameCheap and Namesilo when registering its domains, and this activity follows\nthat pattern. In addition, the subdomains under several of these domains also follow a pattern of having between 8 and\n12 random alphanumeric characters, which, combined with domains registered by NameCheap and Namesilo that\n\n\n-----\n\nresolve to IP addresses assigned to The Constant Company, as well as being parked resolving to 127.0.0[.]1 when not\nin use, allows analysts to pivot and find more potentially malicious domains.\n\nWhile investigating this cluster of infrastructure, several of the domains shared self-signed SSL certificates that were\nthemed around Microsoft. This, together with the domain names chosen in Table 8, shows a general pattern of trying to\nspoof the legitimacy of infrastructure employed by these campaigns.\n\nThe remaining C2s from Table 7 are not easily linked together beyond being found in ScatterBee encoded ShadowPad\nsamples, which leaves open the possibility that there may be multiple groups using the packer, or that for some\noperations that greater care is taken to compartmentalise the activity.\n\nPutting together the use of ShadowPad (predominantly a tool used by China-based threat actors), C2 infrastructure that\nwe have previously tracked as Red Dev 10, and the likely targeting of targets aligning to previous ShadowPad usage,\nwe assess that most of this activity is highly likely Red Dev 10, with the possibility that a small subset of this activity\ncould be an as yet unknown China-based threat actor.\n\n## Conclusion\n\nPwC has been tracking ShadowPad since 2017 and has observed numerous evolutions of the technical capability.\nDuring this time, there has also been widespread reporting about its use in supply chain attacks. Despite this, multiple\nthreat actors continue to use ShadowPad for long term compromise of sensitive organisations, including in the military\nand telecommunications sectors. This activity aligns extremely closely to the threat actor we track as Red Dev 10, which\nis a known ShadowPad user.\n\nThe ScatterBee obfuscation technique documented in this report is likely the latest attempt to minimise detection in\nvictim networks. Whether this technique is exclusively used by one threat actor, or a general development of\nShadowPad capability, remains to be seen.\n\nMore detailed information on each of the techniques used in this blog, along with mitigations, can be found on the\nfollowing MITRE pages:\n\n[1] ‘Higaisa or Winnti? APT41 backdoors, old and new’, Positive Technologies, https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/ (14th January 2021)[2] CTO-TIB-20210324-02A - Threat actors change, but memory dumps last forever[3] See https://github.com/PwCUK-CTO/ScatterBee_Analysis/blob/main/Scripts/ScatterJump.py for the IDA plugin that fixes these jumps[4] ‘Writing an LLVM Pass’, LLVM, https://llvm.org/docs/WritingAnLLVMPass.html#introduction-what-is-a-pass[5] See https://github.com/PwCUK-CTO/ScatterBee_Analysis/blob/main/Scripts/ScatterRebuildPayload.py for an IDA python script which can rebuild ScatterBeecode.[6] See https://github.com/PwCUK-CTO/ScatterBee_Analysis/blob/main/Scripts/ScatterDecodeAPICalls.py for an IDA python script to rename the functions thatcall API functions.[7] See https://github.com/PwCUK-CTO/ScatterBee_Analysis/blob/main/Scripts/ScatterDecodePayload.py for a script that can take an encoded payload file anddecode it to its ScatterBee encoded shellcode.[8] See GitHub repo – ScatterBeePatch.py for a python script that applies the patches to a payload file.[9] Dr.WEB, ‘BackDoor.ShadowPad.4’, https://vms.drweb.com/virus/?i=21932847[10] The layout of these configuration chunks is slightly different, however, they contain all the same information as previously detailed in the 32-bit analysis. Ofnote, all of the 64-bit samples seen to date have had the timestamp string removed from the configuration.[11] GitHub, ‘dahall/TaskScheduler’, https://github.com/dahall/TaskScheduler[12] The legitimate Oleview.exe file is always seen named in capitals when dropped by ScatterBee related files.[13] The spelling variation here was present in the name of the file submitted\n\n\nAppendix A – Indicators of compromise\n\nIndicator Type\n\n9cbfa03a65e6cd4b62b2aa60a4cc4785b824378f735de2596a1195b75f71ecf3 SHA-256\n\ndbb02aaea56a1f0200b76f3f5b2d3596622503633285c7798b4248e0a558f01c SHA-256\n\nd29113e3417dcba9d0e2d540fc53f702869dc7dc018a6b053bc3f70b4e55e436 SHA-256\n\n5f1a21940be9f78a5782879ad54600bd67bfcd4d32085db7a3e8a88292db26cc SHA-256\n\n0371fc2a7cc73665971335fc23f38df2c82558961ad9fc2e984648c9415d8c4e SHA-256\n\nfb17b3886685887aeb8f7c3496c6f7ef06702ec1232567278286c2f8ec4351bb SHA-256\n\n26de542f77da51071389463fad1a50c687b70d902bbd0800db6c959e40dff755 SHA-256\n\n8065da4300e12e95b45e64ff8493d9401db1ea61be85e74f74a73b366283f27e SHA-256\n\nc0fbb71af4863db0cd82942974957088908f815ef7f02b197834e22d02d4a460 SHA-256\n\nc0aae2d5e77acb8b35037f3cd3b76e92eebdb1c53cf3775921bd6f64d94e9a99 SHA-256\n\n\n-----\n\n991511785a05f4dfbf1212e3fb69ff3b666659ecba5f3e5e9c8fbe9804afd23c SHA-256\n\n943778353ce3af1043ec161ef18c9ba3e1ad6a9915dfe1783dff7aac8b53df16 SHA-256\n\n7579e864d47898f1322bb189bdd21b537b40e549149318ce8409f1d57233fa48 SHA-256\n\nc951a1d1294c46c995189dce4a70da0460dd19c0b7136a4905f41212cdead0c7 SHA-256\n\n7c8b6dfcdbcb6e0d87513eec841302a202e7371cdff16101d1594ea34a8dd1af SHA-256\n\nc602456fae02510ff182b45d4ffb69ee6aae11667460001241685807db2e29c3 SHA-256\n\n5e7e336bc7b489c3d4c59af861580ed73a5731d26560488bce03befdef9faadf SHA-256\n\nc72436969d708905901ac294d835abb1c4513f8f26cb16c060d2fd902e1d5760 SHA-256\n\ndbb32cb933b6bb25e499185d6db71386a4b5709500d2da92d377171b7ff43294 SHA-256\n\n37417f300e1382b5b1b93e0be675ba8ab2d418747ea3fa015329f7ca405ae603 SHA-256\n\nc738af04c5b531abdb303a68cfb8994bb8db6e088bf99b45f85bdb863d3fb3e5 SHA-256\n\nffc5bc143ab2320ae6989ccdf8c37a3d7c3c51c09eabf5a94ada86ab7c3abebd SHA-256\n\na8e5a1b15d42c4da97e23f5eb4a0adfd29674844ce906a86fa3554fc7e58d553 SHA-256\n\n1e06fd5b9aa0e5260369e52ec2d9f87060941de835234afd198b1d4c0b161678 SHA-256\n\n7cbd4339c33af40c70d27256cf3ec473bea588ac33ddfa64a8771344c82d9e6c SHA-256\n\ncb5f8759831829614b82ed4a3bf1ac3f27f1640faf2a1f15ba728751e2fa44fa SHA-256\n\n04089c1f71d62d50cbd8009dfd557aa1e6db1492a9fa2b35902182c07a0ed1c1 SHA-256\n\n531e54c055838f281d19fed674dbc339c13e21c71b6641c23d8333f6277f28c0 SHA-256\n\n042541cc39bafdcb0565ee468359ef575256f5adfda0e53c915ecdbbedd91316 SHA-256\n\n5a151aa75fbfc144cb48595a86e7b0ae0ad18d2630192773ff688ae1f42989b7 SHA-256\n\nf768bd36e88ffa496e7b6c538f2259cbdab0317e88432a99050f550b4c9f2f12 SHA-256\n\n8d1a5381492fe175c3c8263b6b81fd99aace9e2506881903d502336a55352fef SHA-256\n\na41348407e01886e76baf7cb8bb0efcf790b213cab87924b8a4f6bf8a9502350 SHA-256\n\nf8c5e93d6114f5a69d1544504d9d7f6a1d7397e3e5e0cce8e24e6d7b884c109e SHA-256\n\n2a3cf204dcc977df6347a039428ae863066700cecfac965dcaeb7b9bd61bc1b6 SHA-256\n\n15371908d89caef3f4487298a452e58732d9f671f2c6a1f07036d123ce3c840d SHA-256\n\n96dc16bbc0f3e6e80fba447e3a3e1085fddf8e97edf286ee8b3fd82954f565bb SHA-256\n\n39f92aed5dfa2cd20ae7df11e16acce9bb2e80c7e6539bc81f352d42ab578eb6 SHA-256\n\n8396e35b19f906f9c6e342e6cd90ab8bbbecc90f9090b0afe68f4fa53530bc33 SHA-256\n\nebe4347e993c81d145b68a788522d5c554edfa74c35e9e61ededd6c510e80c75 SHA-256\n\n02a18df00e241f82cecb7477f661ebe3f26012cdfc5b8172d634c07af4468130 SHA-256\n\nf7ef194f2dcc341ba03f76872cb7c0dfbae8f79118f99cf73dfccfb146c4e966 SHA-256\n\nf4effcf4d7321be824fd637b27f404250d0b1f03205bbc0682022d61aba5801e SHA-256\n\n06539163f71f8bd496db75ccb41db820 MD5\n\n\n-----\n\n493698b1d7acfbf57848b964b4b0ae97 MD5\n\n69be59f365f74b406e505a8c0e128047 MD5\n\nbf98b795957d40ed8e0c52403af659d2 MD5\n\n8b9436c358a1d7f0ca61eca81b5025f7 MD5\n\n4ad23aae3409c31d3d72e1d10e9d957d MD5\n\nffbadead054d1eac270f1a24d02e8a1f MD5\n\n3520e591065d3174999cc254e6f3dbf5 MD5\n\na22fce6e7c1b2d129602ff938a2ac039 MD5\n\nad82d23accb10b4c0fc7f8c9782ae6ad MD5\n\n2a4976a82a07016bd1b5de1a372d8e15 MD5\n\n3e372906248b215ea0ee853cb4e29dd8 MD5\n\nab8b13f3a93baaa36b730cb42434620a MD5\n\n67329d4239551b51c481062b5d38a687 MD5\n\n18b391d91883979fc2df9e13c8aee075 MD5\n\n529e9edc37b668e13be6b077a399f195 MD5\n\n42988a0bd2bbdf4454d5d15a2733aa31 MD5\n\nea6be331b5fa349a2fa464b062043b0e MD5\n\nd50b9ca68a3a650016e64ab4c3ff8e4c MD5\n\n409b27c8eab8b043cfe8854ca22799b3 MD5\n\n70477683ea5a7e193bb80c6cf01da8dd MD5\n\n373eacf3ffd1b5722f9d3c1595092b4c MD5\n\nd7e153c2957a519a1ee6734820e5efbd MD5\n\n9563df80a0f9709baa909c25bdd64214 MD5\n\n64cc83ba22f67c6c8c82c162f64a7c92 MD5\n\n25f3713b9ff40b7fb1293213916c1dbc MD5\n\nc486da41dda4f55f5bafa4f22d877495 MD5\n\naf10f874ee9a24d4a8d5e515af9c24a2 MD5\n\n9d3aaaf04c684bf6c90ada2030ceaea3 MD5\n\n21779cdfbe7ce838d3adc11f42b64191 MD5\n\n5f3093473ae4167fd51d4282fce73741 MD5\n\n42794ad1300ed3edb1ed2d1a473b77ad MD5\n\n52c28bdb6b1fc4d77b1ea58dc8c1c810 MD5\n\n73790e781a0b3c7f1e1e8f9fa8f9d239 MD5\n\n5fe99a8f8cbfe46832478aa9c9634ed6 MD5\n\n\n-----\n\n263b7fb02bb4c05c789d2c1de92e0007 MD5\n\n24f73d5f67bc6cf0bccaade97e04fbca MD5\n\nd2b97a3391c91d1577fb46963b8ef18a MD5\n\naf78467a6cdbb4efa3894a30edef608b MD5\n\n9d3a9edec791cb3eb7225be225337c1e MD5\n\n7c8c3700757ddb5c6d423d88dd944065 MD5\n\n4d6705979b4ba29e44d3178ac979e1c6 MD5\n\n5fcdb89a3b2eb7ff31c5122e8f145277 MD5\n\nff46982c58cf9cd0371e187a6c0dd6f7712c084c SHA-1\n\n880fa69a6efd8de68771d3df2f9683107fb484c0 SHA-1\n\n0cfba69898627c620575cadfff92130429dcd019 SHA-1\n\nea43dbef69af12404549bc45fda756bfefcb3d88 SHA-1\n\ncad05dec778a6dbdeb170a63bbbd18271b56d719 SHA-1\n\naddf67b8bcb8074927431bdfe3e3c867b07f5333 SHA-1\n\n7db78548aae9e4872b06ee9e79c29553947db3d6 SHA-1\n\nc73329dfbe99de4abb93b4fda6310a0c5eedd8f9 SHA-1\n\n47cdaf6c5c3fffeeff1f2c9e6c7649f99ab54932 SHA-1\n\n3342ad3a686be7a873409ae01cfab2eb0b621840 SHA-1\n\n215404d27c6a63a47561d6ab5258af26843b1769 SHA-1\n\n34ce0df62814e3a2430784836914c629d49f22b1 SHA-1\n\nc62b977c93979effb48a1614956c2a788abb22fe SHA-1\n\nfa397effbb1d2d9b276d9d109e79ef89790729bc SHA-1\n\n6512750a9da8c81c6b7c5b5301a60d4962c0c41b SHA-1\n\nb885b9c4a9cd7872cd995198834471e52219ae41 SHA-1\n\nf8e4b7bd1cc973be7540f731028953073430759a SHA-1\n\n6966687463365f08cfb25fd2c47c6e9a27af22b0 SHA-1\n\n9605ad1bf0432ffb148d422099e23eaa26bed4c8 SHA-1\n\n30c63b1e252ea0dc72b97785c1874ab7b6ddef43 SHA-1\n\n48daf01f86cfc9f22c446d602f0cdbd4b763dfc8 SHA-1\n\nb73134449329fd640a6de94a36cbcbebb4d5f541 SHA-1\n\n363e32fafd2732b3cfb53dfd39bef56da1affd7f SHA-1\n\ne96759fcb766744a7aae9692947b4ed4ba77ce37 SHA-1\n\n55811e2fade5fa4412bd5ff7f17eca79887d6aff SHA-1\n\na36e63f41ee3fdfaf2a826c0b6e7728af546981e SHA-1\n\n\n-----\n\n44fc5b13ac3947a3be3fff7808d5d664d7258cb9 SHA-1\n\n03a47494b76aa6feed68053e44c0a2fde6172ea5 SHA-1\n\n494d8239650f3acb0b946f0d00f6dbc9c2c05be0 SHA-1\n\n1c997ddb204bc597f937a07665511ae7d9d98661 SHA-1\n\nc227d3cdcb39b56eddb7ab62d0da62f006207764 SHA-1\n\nd4086a747566d5a7b0e80f0c977e1e6db3410d26 SHA-1\n\ne2898e362dd19a0fb6f317d559cbdb78eac6488c SHA-1\n\n9853fe35e1b6e06b53ad2234d4fa2156fa5ccf97 SHA-1\n\nf6f6f352fa58d587c644953e4fd1552278827e14 SHA-1\n\nb224ae9ffd8119d773dedb1863d46725c29143f8 SHA-1\n\n7cd459821ef2daea764df2f52c896e6ab00ed263 SHA-1\n\n3f2ec5d5ae8be0394baff82bd5c08fcf8df0e754 SHA-1\n\nfd492b013d52e061f101b6086c5c4902abb4b0e0 SHA-1\n\nba985d268bca9ff3bf0b09ab63085b57f52d3574 SHA-1\n\n1bbc81db4d2d98a1cf29d4f84d065c6556f7caed SHA-1\n\n12118603b97e6b3d3a8cb6e48ec7351e160da445 SHA-1\n\n93fec58769f40285b5a76106377644924d0c1dd0 SHA-1\n\n5zsi53pi6uu[.]livehost[.]live Domain\n\ncoivo2xo[.]livehost[.]live Domain\n\nui79zm8o9b[.]livehost[.]live Domain\n\nqrvc7pdnbf[.]symantecupd[.]com Domain\n\npow2u24h7[.]wikimedia[.]vip Domain\n\nvt[.]livehost[.]live Domain\n\nc5t7dvucq[.]symantecupd[.]com Domain\n\n1dfpi2d8kx[.]wikimedia[.]vip Domain\n\ndns[.]dnslookup[.]services Domain\n\nbsyu[.]dnslookup[.]services Domain\n\n2og8qfrkrk[.]symantecupd[.]com Domain\n\ntest[.]wikimedia[.]vip Domain\n\ndust[.]dnslookup[.]services Domain\n\ndntc[.]livehost[.]live Domain\n\nfljhcqwe[.]com Domain\n\n5q4qp9trwi[.]dnslookup[.]services Domain\n\nwww[.]livehost[.]live Domain\n\n\n-----\n\nbj0wyck5v5[.]livehost[.]live Domain\n\n7ec8txihoa[.]dnslookup[.]services Domain\n\nwikimedia[.]vip Domain\n\n4yti11wlo5[.]livehost[.]live Domain\n\ncigy2jft92[.]kasprsky[.]info Domain\n\n6q4qp9trwi[.]dnslookup[.]services Domain\n\nsci[.]livehost[.]live Domain\n\n524ce3dm8h[.]symantecupd[.]com Domain\n\nlmogv[.]dnslookup[.]services Domain\n\ndlbo92v2ef[.]livehost[.]live Domain\n\nbctu[.]dnslookup[.]services Domain\n\nwcuhk[.]livehost[.]live Domain\n\nhccadkml89[.]dnslookup[.]services Domain\n\nr1d3wg7xofs[.]livehost[.]live Domain\n\njn3thp2wl6[.]symantecupd[.]com Domain\n\nd89o0gm34t[.]livehost[.]live Domain\n\ncoivotek[.]livehost[.]live Domain\n\na[.]fljhcqwe[.]com Domain\n\nevbyo7jj0v[.]livehost[.]live Domain\n\nwww[.]wikimedia[.]vip Domain\n\nbm2l41risv[.]livehost[.]live Domain\n\nwntc[.]livehost[.]live Domain\n\n69gy9k6wc2[.]symantecupd[.]com Domain\n\nwvt[.]livehost[.]live Domain\n\nm2[.]livehost[.]live Domain\n\ndns[.]livehost[.]live Domain\n\n8hh3aktk2[.]kasprsky[.]info Domain\n\n1160idswz5[.]kasprsky[.]info Domain\n\nfiles[.]windowshostnamehost[.]club Domain\n\n8hh3aktk[.]kasprsky[.]info Domain\n\nwiki[.]windowshostnamehost[.]club Domain\n\nwindowshostnamehost[.]club Domain\n\n6lh9bgi4n[.]symantecupd[.]com Domain\n\nv2ray[.]windowshostnamehost[.]club Domain\n\n\n-----\n\n5s2zm07ao[.]wikimedia[.]vip Domain\n\nb3d3fn9n[.]kasprsky[.]info Domain\n\n6czumi0fbg[.]symantecupd[.]com Domain\n\nns2[.]windowshostnamehost[.]club Domain\n\ndbtwcse10sd[.]kasprsky[.]info Domain\n\nmx[.]windowshostnamehost[.]club Domain\n\nwfftm5kcj[.]kasprsky[.]info Domain\n\nwlamazcsrv1[.]windowshostnamehost[.]club Domain\n\ncde858l2yf[.]kasprsky[.]info Domain\n\nbnmyphvq[.]wikimedia[.]vip Domain\n\nlocal[.]windowshostnamehost[.]club Domain\n\njuv0cumdo3[.]kasprsky[.]info Domain\n\nfelzeaxrs8hd[.]kasprsky[.]info Domain\n\nc2[.]windowshostnamehost[.]club Domain\n\n687eb876e047[.]kasprsky[.]info Domain\n\na6olaxgd[.]kasprsky[.]info Domain\n\nur1lwzh2qp[.]kasprsky[.]info Domain\n\nhostmaster[.]wikimedia[.]vip Domain\n\nbc[.]windowshostnamehost[.]club Domain\n\ndb311secsd[.]kasprsky[.]info Domain\n\narress[.]windowshostnamehost[.]club Domain\n\nwww[.]kasprsky[.]info Domain\n\n7hln9yr3y6[.]symantecupd[.]com Domain\n\nvwlamazcsrv1[.]windowshostnamehost[.]club Domain\n\nv3hagesrj[.]symantecupd[.]com Domain\n\nz16sxt822s[.]symantecupd[.]com Domain\n\ndnslookup[.]services Domain\n\nybk47i6z8q[.]wikimedia[.]vip Domain\n\nd89o0gm35t[.]livehost[.]live Domain\n\nzk4c9u55[.]wikimedia[.]vip Domain\n\ndsyu[.]livehost[.]live Domain\n\nwsyu[.]livehost[.]live Domain\n\nsc[.]livehost[.]live Domain\n\nw0eew6nkmb[.]livehost[.]live Domain\n\n\n-----\n\nr315imowtg[.]symantecupd[.]com Domain\n\no56n1tosy[.]livehost[.]live Domain\n\nti0wddsnv[.]wikimedia[.]vip Domain\n\nsymantecupd[.]com Domain\n\nwctu[.]livehost[.]live Domain\n\n4iiiessb[.]wikimedia[.]vip Domain\n\ntei1sw0d98[.]symantecupd[.]com Domain\n\nlivehost[.]live Domain\n\nnslookup[.]club Domain\n\nkasprsky[.]info Domain\n\n60.250.18[.]188 IPv4\n\n141.164.35[.]117 IPv4\n\n139.180.135[.]175 IPv4\n\n66.42.44[.]130 IPv4\n\n182.162.136[.]235 IPv4\n\n128.199.232[.]13 IPv4\n\n182.16.112[.]226 IPv4\n\n149.28.145[.]214 IPv4\n\n207.148.78[.]244 IPv4\n\n207.148.99[.]56 IPv4\n\n149.28.152[.]196 IPv4\n\n139.180.135[.]200 IPv4\n\n158.247.219[.]236 IPv4\n\n207.148.98[.]61 IPv4\n\n45.76.100[.]224 IPv4\n\n139.180.187[.]35 IPv4\n\n158.247.217[.]102 IPv4\n\n45.76.148[.]41 IPv4\n\n141.164.61[.]70 IPv4\n\n141.164.63[.]174 IPv4\n\n202.182.96[.]238 IPv4\n\n139.180.141[.]227 IPv4\n\n\n-----\n\n158.247.206[.]194 IPv4\n\n139.180.156[.]26 IPv4\n\n112.121.168[.]2 IPv4\n\n141.164.62[.]81 IPv4\n\n108.160.134[.]80 IPv4\n\n5bcd1346428b6d7f1f19c0f175d96800c5a0951d SSL SHA-1 fingerprint\n\n743f1ef860a1cad5c046cb0099c479acf6815b97 SSL SHA-1 fingerprint\n\n61c39c6c60f7a45ff18806ed855985ef48d954ef SSL SHA-1 fingerprint\n\nf1f5fe0dd96e165e049b8a7d508ccd951c7cca0b SSL SHA-1 fingerprint\n\n9575b444beeed7a16d639223b08e18e29b5eb5a4 SSL SHA-1 fingerprint\n\nc9b276bd2166c95726fbe33f126fa0a014f84a36 SSL SHA-1 fingerprint\n\n5aa19bfcbc980d65df184e644053bf4732929d8e SSL SHA-1 fingerprint\n\nlog.dll.dat Filename\n\nsecur32.dll.dat Filename\n\nmscoree.dll.dat Filename\n\n## Related content\n\n### Cyber security: Research\n\nExplore our latest cyber security research, developed to share new knowledge on critical cyber security issues.\n\n## Contact us\n\n[Form](https://cloud.uk.info.pwc.com/cyber-security-sign-up-to-updates)\n\nHide\n\n© 2015 - Sat May 28 13:50:16 UTC 2022 PwC. All rights reserved. PwC refers to the PwC network and/or one or more\n[of its member firms, each of which is a separate legal entity. Please see www.pwc.com/structure for further details.](http://www.pwc.com/structure)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-08 - Chasing Shadows- A deep dive into the latest obfuscation methods being used by ShadowPad.pdf"
    ],
    "report_names": [
        "2021-12-08 - Chasing Shadows- A deep dive into the latest obfuscation methods being used by ShadowPad.pdf"
    ],
    "threat_actors": [
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "873919c0-bc6a-4c19-b18d-c107e4aa3d20",
            "created_at": "2023-01-06T13:46:39.138138Z",
            "updated_at": "2025-03-27T02:00:03.005534Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [],
            "source_name": "MISPGALAXY:Higaisa",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "30c9c492-afc6-4aa1-8fe6-cecffed946e0",
            "created_at": "2022-10-25T15:50:23.400822Z",
            "updated_at": "2025-03-27T02:00:55.461334Z",
            "deleted_at": null,
            "main_name": "Higaisa",
            "aliases": [
                "Higaisa"
            ],
            "source_name": "MITRE:Higaisa",
            "tools": [
                "PlugX",
                "certutil",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535695,
    "ts_updated_at": 1743041777,
    "ts_creation_date": 1653759862,
    "ts_modification_date": 1653759862,
    "files": {
        "pdf": "https://archive.orkl.eu/51258b4135312d81a17174577ba5380c66708be7.pdf",
        "text": "https://archive.orkl.eu/51258b4135312d81a17174577ba5380c66708be7.txt",
        "img": "https://archive.orkl.eu/51258b4135312d81a17174577ba5380c66708be7.jpg"
    }
}