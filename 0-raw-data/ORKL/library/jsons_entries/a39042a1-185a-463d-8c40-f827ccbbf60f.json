{
    "id": "a39042a1-185a-463d-8c40-f827ccbbf60f",
    "created_at": "2023-01-12T15:03:47.823329Z",
    "updated_at": "2025-03-27T02:05:22.816659Z",
    "deleted_at": null,
    "sha1_hash": "4580d5e0c43cd5392ec447272d209b343768bdd8",
    "title": "2021-01-06 - A Trump Sex Video- No, It's a RAT!",
    "authors": "",
    "file_creation_date": "2022-05-28T15:19:27Z",
    "file_modification_date": "2022-05-28T15:19:27Z",
    "file_size": 699457,
    "plain_text": "# A Trump Sex Video? No, It's a RAT!\n\n**trustwave.com/en-us/resources/blogs/spiderlabs-blog/updated-qnode-rat-downloader-distributed-as-trump-video-**\nscandal/\n\nLoading...\n\nBlogs & Stories\n\n## SpiderLabs Blog\n\nAttracting more than a half-million annual readers, this is the security community's go-to\ndestination for technical breakdowns of the latest threats, critical vulnerability disclosures\nand cutting-edge research.\n\nWhile reviewing our spam traps, a particular campaign piqued our interest primarily\nbecause the attachment to the email does not coincide with the theme of the email body.\nWhen we investigated further, we discovered that its attachment is a variant of the QRAT\n[downloader we blogged about last August.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/rats-and-spam-the-nodejs-qrat/)\n\n### The Mailspam\n\n\n-----\n\nThe email, with the Subject GOOD LOAN OFFER!!, at first glance, looks like a usual\ninvestment scam. No obfuscation in the email headers or body is found. Interestingly,\nattached to the email is an archive containing a Java Archive (JAR) file called\n“TRUMP_SEX_SCANDAL_VIDEO.jar”. We suspect that the bad guys are attempting to ride\nthe frenzy brought about by the recently concluded Presidential elections since the filename\nthey used on the attachment is totally unrelated to the email’s theme.\n\n_Figure 1: The malspam_\n\n### The Qrat Downloader Variant\n\nThe JAR file “TRUMP_SEX_SCANDAL_VIDEO.jar”, dubbed as “QNODE DOWNLOADER”,\nhas the same purpose as the Node.Js QRAT downloaders we previously analyzed – to\ninstall into the infiltrated system the Qnode RAT. Other similarities with the older variants are\nas follows:\n\n[the JAR file is obfuscated using Allatori Obfuscator;](http://www.allatori.com/)\nthe installer of Node.Js is retrieved from the official website nodejs.org; and,\nthis downloader still supports Windows platforms only.\n\n\n-----\n\n_Figure 2: The QNODE DOWNLOADER_\n\nWe decided to examine the notable new features and changes of this variant, and the rest\n[of the blog will tackle these variations. We recommend you read our earlier blog in](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/rats-and-spam-the-nodejs-qrat/)\nconjunction with this one.\n\nFirst, this JAR sample is significantly larger than the older samples we examined. Aside\nfrom the classes the same file name and length but with different cases, this JAR file also\nhas data streams with just numbers in the filename. The malicious code of this downloader\nis split up among these numbered files, along with some junk data that were added to them.\n\n_Figure 3: The JAR attachment classes viewed using the tools Java Decompiler and Hiew_\n\n[Second, a GUI and a supposed Microsoft ISC License are added into the JAR’s code. Upon](https://en.wikipedia.org/wiki/ISC_license)\nthe execution of the file “TRUMP_SEX_SCANDAL_VIDEO.jar”, a copy of it is created and\nthen executed from the %temp% folder. Then, a GUI informing the victim that the malicious\nJAR file is a remote access software used for penetration testing is launched. The malicious\nbehaviors of this sample start to manifest once the button “Ok, I know what I am doing.” is\nclicked. This pop-up is a little odd and is perhaps an attempt to make the application look\nlegitimate, or deflect responsibility from the original software authors.\n\n\n-----\n\n_Figure 4: The pop-up User Interface and its code snippet_\n\n_Figure 5: The ISC License named owner is Microsoft_\n\nThird, the string “qnodejs“ which previously identified the files associated with this threat, is\nnot in this variant. The folder name and the file names within this JAR file no longer\ncontains this string. The Node.Js installation folder is still at %userprofile%, however, the\n[folder is not prepended with “qnodejs-“ anymore. Also, in contrast to our first blog, this JAR](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/rats-and-spam-the-nodejs-qrat/)\nsaves its downloaded files at a QHub folder %temp%\\_qhub_node_{random string} instead\nof at a folder named “qnodejs“ under the path of the installed Node.Js.\n\n_Figure 6: The code comparison of the installation of Node.Js platform from the first blog_\nFourth, when downloading next stage malware, only the argument “--hub-domain” is\nrequired when communicating to the command-and-control servers (C&Cs). After setting up\nthe Node.Js platform, a Node.Js process is created to download the next malware in the\n\n\n-----\n\ninfection chain. The argument _--hub-domain along with the C&Cs is the only data supplied_\nto the process. The information about the QHub service subscription user we observed in\nthe earlier variant is no longer contained in the JAR file.\n\n_Figure 7: The Node.Js process when initially contacting the C&Cs_\n\nLastly, the JAR file downloads a file named “boot.js” and saves it at\n%temp%\\_qhub_node_{random}. Unfortunately, we were not able to replicate this part of\nthe infection chain.\n\n_Figure 8: The code snippet of the installation of second-stage malware_\n\nTo get an idea of what the downloaded file “boot.js” might be, we looked in VirusTotal for a\nsimilar file with the same filename, tagged as text, and filesize at least 10MB, and we were\nable to find this [sample. It appears that with this variant, the malware chain has been](https://www.virustotal.com/gui/file/8d19e156776805eb800ad47f85ff36b99b8283b721ebab3d47a16e2ae597fe13/detection)\nshortened. The second-stage downloader has been removed and that the jar file\nimmediately downloads the payload “boot.js”, which is the Node.Js QRAT.\n\n_Figure 9: The boot.js sample from VirusTotal_\n\nWe checked the file “boot.js” for the characteristics and activities it will perform which are\nsimilar to the payload ‘qnodejs-win32-ia32.js SHA1:\n31F541074C73D02218584DF6C8292B80E6C1FF7D’ from our first blog and below are our\nfindings:\n\nCode is encrypted with base64\nModules are obfuscated\nObtains network information from the service hxxps://wtfismyip[.]com\nPassword-recovery functionality supports the same applications Chrome, Firefox,\nThunderbird, and Outlook\n\n\n-----\n\nWith regards to the persistence, which was the task of the second stage downloader\n“wizard.js” in previous samples, the payload “boot.js” now accomplishes this. A VBS script\n_%userprofile%\\qhub\\node\\2.0.10\\boot.vbs which launches the payload is created and then_\nset to run at the typical registry key\n_HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run._\n\nThe commands that this variant of QRAT supports are simpler than previous versions, as\nshown below.\n\n_Figure 10: The code snippet of the commands this version of QRAT accepts_\n\n### Summary\n\nThis threat has been significantly enhanced over the past few months since we first\nexamined it. To achieve the same end goal, which is to infect the system with a QNode RAT,\nthe JAR file downloader characteristics and behavior were improved.\n\n\n-----\n\nTo increase the chances of this threat being executed by the email recipient, the\nattachment name was based on a prominent figure, and a GUI indicating that the\nmalicious JAR is a tool used in penetration testing.\nTo evade detection, the malicious code of the downloader was split-up into different\nbuffers inside the JAR. Also, the string “qnodejs” which can distinguish the files related\nto this threat was not used anymore.\nTo challenge the existing remediations of this threat, the names of the other files it\ncreated and downloaded were changed and they are put into different locations, not\ninside the Node.Js installation folder.\nTo deliver the final payload into the system, the infection chain was modified – the\nJAR directly downloads the payload.\n\nWhile the attachment payload has some improvements over previous versions, the email\ncampaign itself was rather amateurish, and we believe that the chance this threat will be\ndelivered successfully is higher if only the email was more sophisticated. The spamming out\nof malicious JAR files, which often lead to RATs such as this, is quite common. Email\nadministrators should be looking to take a hard line against inbound JARs and block them\nin their email security gateways.\n\n### IOCs\n\n**Files:**\n\nTRUMP_SEX_SCANDAL_VIDEO.jar (61762 bytes) SHA1:\nB12542229561341F028D09D3B864F9732B431891\n\nboot.js (13293765 bytes) SHA1: 7bf154c9ddf3a71abf15906cdb60773e8ae07b62\n\n**URLs:**\n\ngatherlozx[.]hopto[.]org\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-06 - A Trump Sex Video- No, It's a RAT!.pdf"
    ],
    "report_names": [
        "2021-01-06 - A Trump Sex Video- No, It's a RAT!.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535827,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1653751167,
    "ts_modification_date": 1653751167,
    "files": {
        "pdf": "https://archive.orkl.eu/4580d5e0c43cd5392ec447272d209b343768bdd8.pdf",
        "text": "https://archive.orkl.eu/4580d5e0c43cd5392ec447272d209b343768bdd8.txt",
        "img": "https://archive.orkl.eu/4580d5e0c43cd5392ec447272d209b343768bdd8.jpg"
    }
}