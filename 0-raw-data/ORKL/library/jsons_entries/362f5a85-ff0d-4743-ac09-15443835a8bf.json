{
    "id": "362f5a85-ff0d-4743-ac09-15443835a8bf",
    "created_at": "2023-01-12T14:59:36.480228Z",
    "updated_at": "2025-03-27T02:08:40.76164Z",
    "deleted_at": null,
    "sha1_hash": "158e9b4f35c59e03b06282a9b35d75189fc950f4",
    "title": "2019-10-30 - Emotet is back in action after a short break",
    "authors": "",
    "file_creation_date": "2022-05-28T19:33:57Z",
    "file_modification_date": "2022-05-28T19:33:57Z",
    "file_size": 1945078,
    "plain_text": "# Emotet is back in action after a short break\n\n**zscaler.com/blogs/research/emotet-back-action-after-short-break**\n\nIt’s common for cybercriminals to launch an attack, then shortly thereafter stop the campaign before they are detected. These breaks also\ngive these bad actors a chance to change tactics to, once again, attempt to avoid detection. That’s what operators using the Emotet malware\ndid, taking a short break before bringing Emotet back in a new, more dangerous form.\n\nEmotet operators took about a two-month break as command and control (C&C) servers went down in late May and came back online around\nthe end of August. Then, we began observing a new version of this malware around mid-September.\n\nEmotet started as a banking trojan in 2014. However, it has morphed into a very prominent threat. Now, it is mostly used for spamming and\ndownloading additional malware threats on a target system. Based on the unique sample count of malware threats seen by the Zscaler Cloud\nSandbox, Emotet and its downloaders appear to be among the most prevalent threats in 2019, followed by banking trojans and loaders, such\nas TrickBot and Ursnif, remote-access trojans (RATs), and off-the-shelf password stealers, such as LokiBot and AZORult.\n\nEmotet is modular by design, as it supports multiple modules for different tasks, such as stealing information, spamming, and more. It is also\nknown to download and to be downloaded by other malware families, such as TrickBot and Ursnif. It has also been associated with the Ryuk\nransomware.\n\n## Email conversation hijacking\n\nThis year, Emotet employed a new tactic of using stolen email content in spam campaigns. The hijacking of existing email threads can be\nvery effective as recipients are tricked into believing that the email was sent by the other person in the email thread. This trust factor can lead\nto the victim opening the email (and attachment) and getting infected with Emotet, effectively making the infected system part of an\nEmotet botnet.\n\n\n-----\n\n_gu e_ _otet act_ _ty_ _o_ _t e beg_ _g o Ju e_ _0 9 to_ _d Septe_ _be_ _0 9_\n\n_Figure 2: The new Emotet campaign after the break._\n\n## New campaign, new document templates, and new botnets?\n\nWe observed the following new templates in spammed malicious documents (maldocs) during this new campaign.\n\n\n-----\n\n_Figures 3 and 4: New macro templates (Product Notice and Protected View)_\n\nEarlier, there were two Emotet botnets, known as Epoch 1 (E1) and Epoch2 (E2), that were using unique RSA keys to communicate with their\nC&C. After the break, we noticed three new RSA keys being used, which suggests the possibility of a botnet splitting into multiple botnets.\nEarlier keys were no longer seen in use and the latest three keys are now being used, which means operators are reorganizing their botnet\ninfrastructure.\n\n\n-----\n\n**Already existing RSA keys**\n-----BEGIN PUBLIC KEY----\\nMHwwDQYJKoZIhvcNAQEBBQADawAwaAJhAMPLgcO0RQdJg/LTgiku57nH4KcLwHCx\\nS0lbynOUhHhKjTnmENrMA2idUbK6hI0JRZtii9oJSlb\n----END PUBLIC KEY----\n-----BEGIN PUBLIC KEY----\\nMHwwDQYJKoZIhvcNAQEBBQADawAwaAJhAL9KRKWqcld40xbUZ6hRh+fPNkgJe7K+\\n0y1rR0UFqc2SBmnyoR/2Ctd+8MRvU8zri2eNVkVBx\n----END PUBLIC KEY----\n**New RSA keys**\n-----BEGIN PUBLIC KEY----MHwwDQYJKoZIhvcNAQEBBQADawAwaAJhALk+KlHgOKXm9eDkWu2yN9lanjwOm6W2\\nPV0tgr4msNVby2pOJ6S1MZQnQwxl7y6WWzT4kve\n-----END PUBLIC KEY----\n-----BEGIN PUBLIC KEY----MHwwDQYJKoZIhvcNAQEBBQADawAwaAJhAM426uN11n2LZDk/JiS93WIWG7fGCQmP\\n4h5yIJUxJwrjwtGVexCelD2WKrDw9sa/xKwmQKk3b2\n-----END PUBLIC KEY----\n-----BEGIN PUBLIC KEY----MHwwDQYJKoZIhvcNAQEBBQADawAwaAJhAOzoTryw1r9RxRJPFKalO4+q7JaDZWSB\\nKZlEc22H6ITuE06tvJspue42TF1yk8xN+1bqW++QeV\n-----END PUBLIC KEY----\n_Figure 5: Emotet RSA keys used before and after the break._\n\nRSA1 and RSA2 were used before the break. In this new campaign, we saw Emotet using RSA3, RSA4, and RSA5. (1, 2, 3, 4, and 5 are\nassigned based on their first observation sequence in the wild).\n\nBefore the break, the two RSA keys didn't share any C&C infrastructure. In this new campaign, two sub-botnets are sharing some\ninfrastructure (as shown in the following screenshots).\n\n\n-----\n\n_Figure 6: Emotet RSA keys and C&C infrastructure before the break._\n\n_Figure 7: RSA keys and C&C infrastructure of the new Emotet campaign._\n\nIf we check the overall C&C infrastructure and RSA key relationships before and after the break, we can clearly see a reorganization of the\nC&C infrastructure, which is now divided among three new Epochs. One Epoch is divided into two while the other one is used to create a\nsingle botnet with some new C&Cs.\n\n\n-----\n\n_Figure 8: The Emotet RSA key and C&C infrastructure relationships before and after the break._\n\n## Emotet Downloader payload - Technical analysis\n\nThe Emotet infection cycle generally starts with spam emails containing malicious macro documents that drop a JavaScript file. This\nJavaScript file further downloads the Emotet payload from a compromised WordPress website. Almost all the samples we observed were\nserved from compromised WordPress websites (mostly version 5.2.3).\n\nWe will take a look at one such malicious document for the purpose of analysis here \nMD5 – 359696113a2156617c28d4f79cc7d44b (“file 20190924 LTR6051.doc”)\n\nThe macro in the documents is quite simple and straightforward but contains lots of junk.\n\n_Figure 9: Macro code containing junk instructions._\n\nAfter removing the junk, this is how the macro code looks.\n\n\n-----\n\n_Figure 10: Cleaned macro code._\n\nIt gets its text from TextBox1 in UserForm2, then saves that in a \"JS\" file before executing that file.\n\n_Figure 11: A user form containing javascript code._\n\nThis JavaScript file is heavily obfuscated. More obfuscation is being added to the \"JS\" code incrementally. As in earlier versions of this\ndownloader, some of the strings and function names were readable and now almost every string is obfuscated.\n\n\n-----\n\n_Figure 12: Heavily obfuscated script_\n\nThis script contains an array of strings in variable “a.” First, the elements of the array are shuffled using an anonymous function just after the\narray definition. Then there is function “b,” which is used to decrypt strings and is extensively used throughout the script. Using this function,\nwe can log the decrypted strings just before they return. Some of the interesting strings include:\n\n_\\+\\+ *(?:_0x(?:[a-f0-9]){4,6}|(?:\\b|\\d)[a-z0-9]{1,4}(?:\\b|\\d))_\n_while (true) {}_\n_return (function()_\n_{}.constructor(\"return this\")( )_\n_4|0|7|5|3|1|8|2|6_\n_2|1|0|6|3|5|4_\n_split_\n_debug_\n_error_\n_exception_\n_trace_\n_http://thewomentour.com/wp-includes/f8yezb9/_\n_WScript.Shell_\n_ResponseBody_\n_ActiveXObject_\n_https://www.marquedafrique.com/k9c5qh/eb1wiw8192/_\n_Scripting.FileSystemObject_\n_CreateObject_\n_https://thecrystaltrees.com/nofij3ksa/o5523/_\n_http://4excellent.com/wp-includes/ii950106/_\n_WScript.Shell_\n_Popup_\n_MSXML2.XMLHTTP_\n_GET_\n_open_\n_send_\n_http://www.davidleighlaw.com/wp-content/wlfsj15707/_\n_Position_\n_Open_\n_Type_\n_SaveToFile_\n_random_\n_toString_\n_substr_\n_0|1|3|4|2_\n_11|15|13|4|6|9|8|7|5|0|2|3|1|10|16|14|12_\n_return (function()_\n\n\n-----\n\n_{} co st ucto ( etu_ _t s )( )_\n_7|2|8|0|5|1|4|6|3_\n_2|0|3|4|1_\n_0|14|11|8|3|6|13|9|5|2|1|12|4|10|7_\n_Not Supported File Format_\n_There was an error opening this document. The file is damaged and could not be repaired (for example, it was sent as an email_\n_attachment and wasn't correctly decoded)._\n\nThe script's functionality can be clearly determined from the decrypted strings. It downloads, saves, and runs its payload from a list of URLs\nand shows the following message box to trick a user into believing the file is corrupt:\n\n_Figure 13: An error message to trick a user into believing the file is corrupt._\n\nThere are multiple URLs embedded in the script files. The following URLs were extracted from this script:\n\nhttp://thewomentour[.]com/wp-includes/f8yezb9/\nhttps://www[.]marquedafrique[.]com/k9c5qh/eb1wiw8192/\nhttps://thecrystaltrees[.]com/nofij3ksa/o5523/\nhttp://4excellent[.]com/wp-includes/ii950106/\nhttp://www[.]davidleighlaw[.]com/wp-content/wlfsj15707/\n\nIn this case, the Emotet loader is downloaded from “http://thecrystaltrees[.]com/nofij3ksa/o5523/” (MD5 –\n402b20268d64acded1c48ce760c76c47).\n\nThe Emotet loader already has been extensively analyzed and blogged about, so we won't be getting into technical details of the loader here.\nBelow are artifacts extracted from this sample:\n\n**RSA key extracted from this sample:**\n\n-----BEGIN PUBLIC KEY----\\nMHwwDQYJKoZIhvcNAQEBBQADawAwaAJhAOzoTryw1r9RxRJPFKalO4+q7JaDZWSB\\nKZlEc22H6ITuE06tvJspue42TF1yk8xN+1bqW++Qe\n----END PUBLIC KEY----\n**C&C server addresses from the sample:**\n\n187[.]188[.]166[.]192:80,\n200[.]57[.]102[.]71:8443,\n200[.]21[.]90[.]6:8080,\n46[.]41[.]134[.]46:8080,\n178[.]249[.]187[.]151:8080,\n217[.]199[.]160[.]224:8080,\n71[.]244[.]60[.]230:7080,\n119[.]59[.]124[.]163:8080,\n185[.]86[.]148[.]222:8080,\n190[.]230[.]60[.]129:80,\n178[.]79[.]163[.]131:8080,\n186[.]83[.]133[.]253:8080,\n179[.]62[.]18[.]56:443,\n91[.]205[.]215[.]57:7080,\n217[.]113[.]27[.]158:443,\n181[.]36[.]42[.]205:443,\n190[.]19[.]42[.]131:80,\n183[.]82[.]97[.]25:80,\n77[.]245[.]101[.]134:8080,\n109[.]104[.]79[.]48:8080,\n159[.]203[.]204[.]126:8080,\n5[ ]77[ ]13[ ]70:80\n\n\n-----\n\n89[ ] 8 [ ] [ ] 5 50000,\n46[.]28[.]111[.]142:7080,\n46[.]21[.]105[.]59:8080,\n189[.]166[.]68[.]89:443,\n183[.]87[.]87[.]73:80,\n190[.]200[.]64[.]180:7080,\n79[.]143[.]182[.]254:8080,\n119[.]92[.]51[.]40:8080,\n187[.]155[.]233[.]46:443,\n89[.]188[.]124[.]145:443,\n201[.]163[.]74[.]202:443,\n62[.]75[.]160[.]178:8080,\n51[.]15[.]8[.]192:8080,\n46[.]29[.]183[.]211:8080,\n62[.]75[.]143[.]100:7080,\n114[.]79[.]134[.]129:443,\n190[.]230[.]60[.]129:80,\n190[.]117[.]206[.]153:443,\n203[.]25[.]159[.]3:8080,\n217[.]199[.]175[.]216:8080,\n80[.]85[.]87[.]122:8080,\n190[.]1[.]37[.]125:443,\n23[.]92[.]22[.]225:7080,\n81[.]169[.]140[.]14:443,\n46[.]163[.]144[.]228:80,\n5[.]196[.]35[.]138:7080,\n189[.]129[.]4[.]186:80,\n151[.]80[.]142[.]33:80,\n190[.]221[.]50[.]210:8080,\n190[.]104[.]253[.]234:990,\n71[.]244[.]60[.]231:7080,\n91[.]83[.]93[.]124:7080,\n181[.]81[.]143[.]108:80,\n181[.]188[.]149[.]134:80,\n50[.]28[.]51[.]143:8080,\n123[.]168[.]4[.]66:22,\n211[.]229[.]116[.]97:80,\n201[.]184[.]65[.]229:80,\n77[.]55[.]211[.]77:8080,\n212[.]71[.]237[.]140:8080,\n190[.]38[.]14[.]52:80,\n46[.]41[.]151[.]103:8080,\n149[.]62[.]173[.]247:8080,\n87[.]106[.]77[.]40:7080,\n86[.]42[.]166[.]147:80,\n109[.]169[.]86[.]13:8080,\n88[.]250[.]223[.]190:8080,\n138[.]68[.]106[.]4:7080,\n200[.]58[.]171[.]51:80\n\nConclusion\n\nEmotet is an ever-evolving threat, employing new tricks and tactics. Although it started as a banking trojan, Emotet is now associated with\nseveral different malware campaigns, including ransomware and infostealers. The Zscaler ThreatLabZ team proactively tracks and ensures\ncoverage to block downloaders, payloads, and C&C activity from Emotet and other threats.\n\n_ThreatLabZ is the research division of Zscaler. To learn more about ThreatLabZ and Zscaler cloud activity,_\n_[visit https://www.zscaler.com/threatlabz/cloud-activity-dashboard](https://www.zscaler.com/threatlabz/cloud-activity-dashboard)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-10-30 - Emotet is back in action after a short break.pdf"
    ],
    "report_names": [
        "2019-10-30 - Emotet is back in action after a short break.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535576,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653766437,
    "ts_modification_date": 1653766437,
    "files": {
        "pdf": "https://archive.orkl.eu/158e9b4f35c59e03b06282a9b35d75189fc950f4.pdf",
        "text": "https://archive.orkl.eu/158e9b4f35c59e03b06282a9b35d75189fc950f4.txt",
        "img": "https://archive.orkl.eu/158e9b4f35c59e03b06282a9b35d75189fc950f4.jpg"
    }
}