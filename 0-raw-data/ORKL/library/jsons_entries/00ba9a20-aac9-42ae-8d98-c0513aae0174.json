{
    "id": "00ba9a20-aac9-42ae-8d98-c0513aae0174",
    "created_at": "2023-05-06T02:08:23.253244Z",
    "updated_at": "2025-03-27T02:06:08.563937Z",
    "deleted_at": null,
    "sha1_hash": "b1df473d1c5e5eaae762aaebec5cc197e2ec1503",
    "title": "2023-03-09 - Malvertising through search engines",
    "authors": "",
    "file_creation_date": "2023-05-05T01:48:20Z",
    "file_modification_date": "2023-05-05T01:48:20Z",
    "file_size": 3904365,
    "plain_text": "# Malvertising through search engines\n\n**[securelist.com/malvertising-through-search-engines/108996/](https://securelist.com/malvertising-through-search-engines/108996/)**\n\nAuthors\n\n[Victoria Vlasova](https://securelist.com/author/victoria-vlasova/)\n\nHaim Zigel\n\nIlya Tyunkin\n\n\n-----\n\nIn recent months, we observed an increase in the number of malicious campaigns that use\nGoogle Advertising as a means of distributing and delivering malware. At least two different\nstealers, Rhadamanthys and RedLine, were abusing the search engine promotion plan in\norder to deliver malicious payloads to victims’ machines. They seem to use the same\ntechnique of mimicking a website associated with well-known software like Notepad++ and\nBlender 3D.\n\n[The treat actors create copies of legit software websites while employing typosquatting](https://encyclopedia.kaspersky.com/glossary/typosquatting/?utm_source=securelist&utm_medium=blog&utm_campaign=termin-explanation)\n(exploiting incorrectly spelled popular brands and company names as URLs) or\ncombosquatting (using popular brands and company names combined with arbitrary words\nas URLs) to make the sites look like the real thing to the end user—the domain names allude\nto the original software or vendor. The design and the content of the fake web pages look the\nsame as those of the original ones. Threat actors then pay to promote the website in the\nsearch engine in order to push it to the top search results. The technique is called\n“malvertising”.\n\n## Our observations\n\nIn the following snapshots, we can see Google ads promoting fake pages for AMD drivers\nand the Blender 3D software. If we take a closer look at the URLs, we will see that the\ndomain names incorporate the software name but are in fact unrelated to the real AMD or\nBlender 3D vendors. In most cases, the top-level domains are different from those of the\nofficial sites as well. The use of less common TLDs enables the threat actors to register\nsecond-level domains that are similar to the real ones. These domains lure victims to click on\nthe link and access the fake website more often than random domains registered in a more\ncommon domain zone, such as COM, because they may look more like a legitimate website.\n\n**_Fake AMD and Blender 3D websites in search results_**\n\nWe visited some of the promoted sites and obtained the malicious payloads they were\ndistributing. In this article, we will focus mainly on the “Blender 3D” fake websites.\n\n\n-----\n\n**_Fake Blender 3D web pages_**\n\nThe size of the downloaded file (ZIP archive) is 269 MB, which is close to the original\nBlender installer size. The size of 257 MB stated on the fake web page matches that of the\noriginal Blender 3D installer, but it does not match the size of the fake download.\n\nWhen the user clicks the “Download” button, the archive blender-3.4.1-windows-x64.zip\n(E0BDF36E4A7CF1B332DC42FD8914BA8B) is downloaded.\n\n\n-----\n\nThe size of the file (BBA8AA93FCDDA5AC7663E90C0EEFA2E7) extracted from the archive\nis 657 MB. When launched, it drops two files into the temp directory:\n\nThe original Blender 3D MSI installer (marked green on the screenshot below), whose\nsize is also 657 MB;\nA PE file that acts as a next-stage loader for a malicious PE file (marked red), which\nalso has the same size as the original installer: 657 MB.\n\n**_Dropped files: the original Blender 3D MSI installer and the malicious loader_**\n\nThe size of the dropped malicious loader is this big because it is inflated with junk bytes\nwhen the PE file is created. The deflated malicious loader size is about 330 KB, and the rest\nis junk.\n\n\n-----\n\n**_Junk bytes inflating the loader_**\n\nAfter the initial installer (extracted from the archive) drops these two files, it runs the\nmalicious PE file using the CMD method (cmd.exe /c [Filename] command) to hide it from\nthe user. Additionally, the initial installer also runs the original Blender 3D MSI to make the\nvictim believe that the desired software is running.\n\nThus, the threat actors disguise their malicious payload through the installation of another\nsoftware product by creating a “pre-installer” for the legitimate software, which will put both\nthe malware and the desired genuine software on the victim’s machine.\n\n\n-----\n\n**_Blender 3D installer launched by the “pre-installer”_**\n\nThe screenshot above shows the actual software installer running, but if we take a closer\nlook at the processes, we will notice a short-lived sub-process (cmd.exe /c ->\n“SetupFileProgram”) run by the “pre-installer”. This short-lived process is the loader for the\nmalware.\n\n## The loader\n\nThe loader is a .NET file protected by an unregistered version of .NET Reactor. It seems to\nuse an anti-debugging technique in order to prevent a debugger from executing and\ndynamically analyzing the binary. In a nutshell, the loader runs a new powershell.exe\nprocess and manipulates it to execute numerous PowerShell commands, which instruct it to\naccess a third-party URL in order to get the payload. The payload is a base64-encoded,\nAES-encrypted fileless binary. Further commands are related to decoding and decrypting\nthat binary, then running it in memory, within a newly created aspnet_compiler.exe process, a\nlegitimate Windows .NET framework compilation tool.\n\nIn this case, we observed two detection evasion tricks during the runtime:\n\nThe fileless technique, which involves getting a payload from an online source and\nloading it directly into the memory of a process;\n\n\n-----\n\nLOLBAS (living-off-the-land binaries and scripts), which, in this case, is the use of a\n.NET compilation tool to run the malicious binary.\n\nBelow, we provide a more detailed analysis of the loader execution chain. After passing the\nloader anti-debugger, we can see that it starts a PowerShell process, so we will put a\nbreakpoint at the CreateProcessW WinAPI call to observe the behavior.\n\n**_Call of CreateProcessW to spawn a PowerShell process_**\n\nSince we did not see any command passed to the PowerShell process when initializing it via\nthe CreateProcessW call, we can conclude that it will be passed at some point later, so we\ncan observe the passing of the PowerShell command(s) by putting a breakpoint at WinAPI\nWriteFile in order to see the command lines for the powershell.exe process.\n\nSo, after letting it run and reach the breakpoint, we will check the result in the return of the\nfunction call, and we can see in the stack that the first command pushed to the\npowershell.exe process was #Start-Sleep -seconds 30;.\n\n\n-----\n\n**_Observing the pushed command(s)_**\n\nWe can try checking the memory section where the command is stored and searching for\nother commands that are being kept in the memory for later use by the loader.\n\n**_Memory address of the pushed PowerShell commands_**\n\n\n-----\n\nAfter taking all the data from this memory section, we will see all the commands passed to\nthe powershell.exe process via the WriteFile WinAPI call.\n\n**_PowerShell commands_**\n\nIf we read the commands, we will see exactly what the powershell.exe process is about to\ndo. The commands instruct it to perform the following actions:\n\n1. Download string data, which is part of the following URL, namely the name of the file:\n\n_http[:]//45.93.201[.]114/docs/[RandomChars].txt. The downloaded data is a Base64-_\nencoded string that is decoded into encrypted data.\n2. Prepare the decryption method, AES-CBC, as can be seen in the screenshot above.\n\nWe can also easily see and decode the Base64-encoded key and IV (initialization\nvector) used for decryption in the PowerShell command.\n3. Decrypt the data into a Gzip-compressed binary.\n4. Decompress the binary.\n5. Invoke the binary to run it.\n\n\n-----\n\n**_Decrypted binary_**\n\n## The extracted binary (RedLine stealer)\n\nThe binary that we obtained is the dropper of known malware, the RedLine stealer. The\nversion of the stealer at hand uses an interesting technique to hide its malicious payload: it is\nencoded in the least significant bit of images stored in the resource section of the dropper, as\nwell as the key and the IV bytes for its AES decryption.\n\n\n-----\n\n**_Embedded images with a malicious payload_**\n\n\n-----\n\n**_Payload decryption routine_**\n\nAfter decrypting the payload, the dropper starts a legitimate process named\n“aspnet_compiler.exe”, which is part of the Microsoft .NET framework, and injects the\npayload into it.\n\n\n-----\n\n**_Injecting a payload routine_**\n\n## Infrastructure\n\nTo deploy decoy pages, the malefactors register deceptive domain names, such as\nblender3d-software[.]net or blender3d-software[.]org. We have found more than fifty similar\ndomains hosted at the same IP address: 91.229.23[.]200. These domain names mimic other\nsoftware distribution sites as well, for example, afterburner-software[.]org, tradingviewssoftware[.]org, and unity-download[.]com.\n\nThe malicious payload could be stored on the same site (for example,\nhxxps[://]blahder3dsoft[.]store/Blender[.]rar) as the landing page or on a public service that\ncan be used as the file hosting service (MediaFire or GitHub).\n\n## Conclusion\n\nWe are seeing an increase in the spread of malware families through Google Ads\ncampaigns, specifically through search ads. Threat actors use fake websites to mimic\nlegitimate software vendor websites to lure victims, and pay for ads to promote these. They\nuse typosquatting and combosquatting for their malicious website domains, which have\nbecome common techniques in recent months. In some cases, such as the one described in\nthis article, the threat actors also make sure to install the desired software alongside their\nmalicious payload.\n\nIn recent campaigns, we observed mainly stealer-type malware, such as RedLine or the\nnotorious Rhadamanthys, which is also known to use malvertising techniques to reach\nvictims and steal data from their compromised machines.\n\nThis kind of distribution suggests that the threat actors are targeting victims, both individual\nand corporate, all around the world.\n\n## Indicators of Compromise\n\n**IoC** **Description**\n\n[E0BDF36E4A7CF1B332DC42FD8914BA8B](https://opentip.kaspersky.com/E0BDF36E4A7CF1B332DC42FD8914BA8B/?utm_source=SL&utm_medium=SL&utm_campaign=SL) _blender-3.4.1-windows-x64.zip_\n\n[BBA8AA93FCDDA5AC7663E90C0EEFA2E7](https://opentip.kaspersky.com/BBA8AA93FCDDA5AC7663E90C0EEFA2E7/?utm_source=SL&utm_medium=SL&utm_campaign=SL) _blender-3.4.1-windows-x64.exe_\n\n[4b6249bea60eec2d9e6890162a7fca5f](https://opentip.kaspersky.com/4b6249bea60eec2d9e6890162a7fca5f/?utm_source=SL&utm_medium=SL&utm_campaign=SL) _Blender.rar_\n\n[8d709a5ce84504f83303afda88649b24](https://opentip.kaspersky.com/8d709a5ce84504f83303afda88649b24/?utm_source=SL&utm_medium=SL&utm_campaign=SL) RedlLine stealer\n\n[d0915b6057eb60c3878ce88d71efc351](https://opentip.kaspersky.com/d0915b6057eb60c3878ce88d71efc351/?utm_source=SL&utm_medium=SL&utm_campaign=SL) RedlLine stealer\n\n\n-----\n\nhxxps[:]//download2392.mediafire.com/bb289kqoibyg/\n\n1udjwornnpwxlua/blender-3.4.1-windows-x64.zip/\n\nhxxps[:]//github.com/sup6724/blender3d13/releases/\n\ndownload/updates/blender-3.4.1-windows-x64.zip\n\n\nLink to malicious file\n\nLink to malicious file\n\n\n[hxxps[://]blahder3dsoft[.]store/Blender[.]rar](https://opentip.kaspersky.com/https%3A%2F%2Fblahder3dsoft.store%2FBlender.rar/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Link to malicious file\n\nhttp[:]//45.93.201[.]114/docs/[RandomChars].txt URL with malware data string\n\n[91.229.23[.]200](https://opentip.kaspersky.com/91.229.23.200/?utm_source=SL&utm_medium=SL&utm_campaign=SL) IP address common for some\nmalicious landing pages\n\n[blahder3dsoft[.]store](https://opentip.kaspersky.com/blahder3dsoft.store/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Fake Blender websites\n\n[blender3d-download[.]com](https://opentip.kaspersky.com/blender3d-download.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3d-download[.]net](https://opentip.kaspersky.com/blender3d-download.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3d-download[.]org](https://opentip.kaspersky.com/blender3d-download.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3ds-download[.]com](https://opentip.kaspersky.com/blender3ds-download.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3ds-download[.]net](https://opentip.kaspersky.com/blender3ds-download.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3ds-download[.]org](https://opentip.kaspersky.com/blender3ds-download.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3d-software[.]com](https://opentip.kaspersky.com/blender3d-software.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3d-software[.]net](https://opentip.kaspersky.com/blender3d-software.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3d-software[.]org](https://opentip.kaspersky.com/blender3d-software.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3ds-software[.]com](https://opentip.kaspersky.com/blender3ds-software.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3ds-software[.]net](https://opentip.kaspersky.com/blender3ds-software.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender3ds-software[.]org](https://opentip.kaspersky.com/blender3ds-software.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender-download[.]com](https://opentip.kaspersky.com/blender-download.com/https:/opentip.kaspersky.com/blender-download.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender-download[.]net](https://opentip.kaspersky.com/blender-download.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blender-download[.]org](https://opentip.kaspersky.com/blender-download.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blenders3d-download[.]com](https://opentip.kaspersky.com/blenders3d-download.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blenders3d-download[.]net](https://opentip.kaspersky.com/blenders3d-download.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[blenders3d-download[.]org](https://opentip.kaspersky.com/blenders3d-download.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n\n-----\n\n[afterburnermsi-download[.]com](https://opentip.kaspersky.com/afterburnermsi-download.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Other suspicious software-themed\ndomains related through the same\nIP address\n\n[afterburner-software[.]net](https://opentip.kaspersky.com/afterburner-software.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[afterburner-software[.]org](https://opentip.kaspersky.com/afterburner-software.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[desktop-tradingview[.]net](https://opentip.kaspersky.com/desktop-tradingview.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[desktop-tradingview[.]org](https://opentip.kaspersky.com/desktop-tradingview.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[download-tradingview[.]net](https://opentip.kaspersky.com/download-tradingview.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[download-tradingview[.]org](https://opentip.kaspersky.com/download-tradingview.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[overclock-msi[.]com](https://opentip.kaspersky.com/overclock-msi.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[overclock-msi[.]net](https://opentip.kaspersky.com/overclock-msi.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[overclock-msi[.]org](https://opentip.kaspersky.com/overclock-msi.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[project-obs[.]com](https://opentip.kaspersky.com/project-obs.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[project-obs[.]net](https://opentip.kaspersky.com/project-obs.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[project-obs[.]org](https://opentip.kaspersky.com/project-obs.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[studio-obs[.]com](https://opentip.kaspersky.com/studio-obs.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[studio-obs[.]net](https://opentip.kaspersky.com/studio-obs.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[studio-obs[.]org](https://opentip.kaspersky.com/studio-obs.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[tradingview-software[.]com](https://opentip.kaspersky.com/tradingview-software.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[tradingview-software[.]net](https://opentip.kaspersky.com/tradingview-software.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[tradingview-software[.]org](https://opentip.kaspersky.com/tradingview-software.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[tradingviews-software[.]com](https://opentip.kaspersky.com/tradingviews-software.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[tradingviews-software[.]net](https://opentip.kaspersky.com/tradingviews-software.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[tradingviews-software[.]org](https://opentip.kaspersky.com/tradingviews-software.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[unity-download[.]com](https://opentip.kaspersky.com/unity-download.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[unity-download[.]net](https://opentip.kaspersky.com/unity-download.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[unity-download[.]org](https://opentip.kaspersky.com/unity-download.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n\n-----\n\n[unityhub-download[.]com](https://opentip.kaspersky.com/unityhub-download.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[unityhub-download[.]net](https://opentip.kaspersky.com/unityhub-download.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[unityhub-download[.]org](https://opentip.kaspersky.com/unityhub-download.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[unity-software[.]net](https://opentip.kaspersky.com/unity-software.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[unity-software[.]org](https://opentip.kaspersky.com/unity-software.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[webull-download[.]com](https://opentip.kaspersky.com/webull-download.com/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[webull-download[.]net](https://opentip.kaspersky.com/webull-download.net/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[webull-download[.]org](https://opentip.kaspersky.com/webull-download.org/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n\n[Google](https://securelist.com/tag/google/)\n[Malvertizing](https://securelist.com/tag/malvertizing/)\n[Malware](https://securelist.com/tag/malware/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Search engines](https://securelist.com/tag/search-engines/)\n[Trojan](https://securelist.com/tag/trojan/)\n[Trojan-stealer](https://securelist.com/tag/trojan-stealer/)\n\nAuthors\n\n[Victoria Vlasova](https://securelist.com/author/victoria-vlasova/)\n\nHaim Zigel\n\nIlya Tyunkin\n\nMalvertising through search engines\n\nYour email address will not be published Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-09 - Malvertising through search engines.pdf"
    ],
    "report_names": [
        "2023-03-09 - Malvertising through search engines.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1683338903,
    "ts_updated_at": 1743041168,
    "ts_creation_date": 1683251300,
    "ts_modification_date": 1683251300,
    "files": {
        "pdf": "https://archive.orkl.eu/b1df473d1c5e5eaae762aaebec5cc197e2ec1503.pdf",
        "text": "https://archive.orkl.eu/b1df473d1c5e5eaae762aaebec5cc197e2ec1503.txt",
        "img": "https://archive.orkl.eu/b1df473d1c5e5eaae762aaebec5cc197e2ec1503.jpg"
    }
}