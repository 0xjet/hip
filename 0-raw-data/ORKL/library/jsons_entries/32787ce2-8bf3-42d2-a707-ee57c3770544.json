{
    "id": "32787ce2-8bf3-42d2-a707-ee57c3770544",
    "created_at": "2023-01-12T15:02:14.346323Z",
    "updated_at": "2025-03-27T02:06:10.925331Z",
    "deleted_at": null,
    "sha1_hash": "28fef20d5ae488248a42d3fa1b81e30cdadfe924",
    "title": "2017-12-04 - Microsoft teams up with law enforcement and other partners to disrupt Gamarue (Andromeda)",
    "authors": "",
    "file_creation_date": "2022-05-28T21:55:42Z",
    "file_modification_date": "2022-05-28T21:55:42Z",
    "file_size": 1380890,
    "plain_text": "# Microsoft teams up with law enforcement and other partners to disrupt Gamarue (Andromeda)\n\n**[blogs.technet.microsoft.com/mmpc/2017/12/04/microsoft-teams-up-with-law-enforcement-and-other-partners-to-disrupt-gamarue-andromeda/](https://blogs.technet.microsoft.com/mmpc/2017/12/04/microsoft-teams-up-with-law-enforcement-and-other-partners-to-disrupt-gamarue-andromeda/)**\n\nDecember 4, 2017\n\n[Today, with help from Microsoft security researchers, law enforcement agencies around the globe, in cooperation](https://www.europol.europa.eu/newsroom/news/andromeda-botnet-dismantled-in-international-cyber-operation)\n[with Microsoft Digital Crimes Unit (DCU), announced the disruption of Gamarue, a widely distributed malware](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Gamarue)\nthat has been used in networks of infected computers collectively called the Andromeda botnet.\n\nThe disruption is the culmination of a journey that started in December 2015, when the Microsoft Windows\nDefender research team and DCU activated a Coordinated Malware Eradication (CME) campaign for Gamarue.\n[In partnership with internet security firm ESET, we performed in-depth research into the Gamarue malware and](https://www.eset.com/us/about/newsroom/press-releases/eset-unites-with-microsoft-and-law-enforcement-agencies-to-disrupt-gamarue-botnets/)\nits infrastructure.\n\nOur analysis of more than 44,000 malware samples uncovered Gamarue’s sprawling infrastructure. We provided\ndetailed information about that infrastructure to law enforcement agencies around the world, including:\n\n1,214 domains and IP addresses of the botnet’s command and control servers\n464 distinct botnets\nMore than 80 associated malware families\n\nThe coordinated global operation resulted in the takedown of the botnet’s servers, disrupting one of the largest\nmalware operations in the world. Since 2011, Gamarue has been distributing a plethora of other threats,\nincluding:\n\n[Petya and](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Petya) [Cerber ransomware](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Cerber)\n[Kasidet malware (also known as Neutrino bot), which is used for DDoS attacks](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Kasidet)\n[Lethic, a spam bot](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Lethic)\n[Info-stealing malware Ursnif,](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?name=win32/ursnif) [Carberp, and](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Carberp) [Fareit, among others](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Fareit)\n\n## A global malware operation\n\nFor the past six years, Gamarue has been a very active malware operation that, until the takedown, showed no\nsigns of slowing down. Windows Defender telemetry in the last six months shows Gamarue’s global prevalence.\n\n\n-----\n\n_Figure 1. Gamarue’s global prevalence from May to November 2017_\n\nWhile the threat is global, the list of top 10 countries with Gamarue encounters is dominated by Asian countries.\n\n_Figure 2. Top 10 countries with the most Gamarue encounters from May to November 2017_\n\nIn the last six months, Gamarue was detected or blocked on approximately 1,095,457 machines every month on\naverage.\n\n\n-----\n\n_Figure 3. Machines, IPs, and unique file encounters for Gamarue from May to November 2017; data does not_\n_include LNK detections_\n\n## The Gamarue bot\n\nGamarue is known in the underground cybercrime market as Andromeda bot. A bot is a program that allows an\nattacker to take control of an infected machine. Like many other bots, Gamarue is advertised as a crime kit that\nhackers can purchase.\n\nThe Gamarue crime kit includes the following components:\n\n**Bot-builder, which builds the malware binary that infects computers**\n**Command-and-control application, which is a PHP-based dashboard application that allows hackers to**\nmanage and control the bots\n**Documentation on how to create a Gamarue botnet**\n\nA botnet is a network of infected machines that communicate with command-and-control (C&C) servers, which\nare computer servers used by the hacker to control infected machines.\n\nThe evolution of the Gamarue bot has been the subject of many thorough analyses by security researchers. At\nthe time of takedown, there were five known active Gamarue versions: 2.06, 2.07, 2.08, 2.09, and 2.10. The\nlatest and the most active is version 2.10.\n\nGamarue is modular, which means that its functionality can be extended by plugins that are either included in the\ncrime kit or available for separate purchase. The Gamarue plugins include:\n\n**Keylogger ($150) – Used for logging keystrokes and mouse activity in order to steal user names and**\npasswords, financial information, etc\n**Rootkit (included in crime kit) – Injects rootkit codes into all processes running on a victim computer to**\ngive Gamarue persistence\n**Socks4/5 (included in crime kit) – Turns victim computer into a proxy server for serving malware or**\nmalicious instructions to other computers on the internet\n**Formgrabber ($250) – Captures any data submitted through web browsers (Chrome, Firefox, and Internet**\nExplorer)\n\n\n-----\n\n**Teamviewer ($250)** Enables attacker to remotely control the victim machine, spy on the desktop, perform\nfile transfer, among other functions\n**Spreader – Adds capability to spread Gamarue malware itself via removable drives (for example, portable**\nhard drives or flash drives connected via a USB port); it also uses Domain Name Generation (DGA) for the\nservers where it downloads updates\n\n## Gamarue attack kill-chain\n\nOver the years, various attack vectors have been used to distribute Gamarue. These include:\n\nRemovable drives\nSocial media (such as Facebook) messages with malicious links to websites that host Gamarue\nDrive-by downloads/exploit kits\nSpam emails with malicious links\nTrojan downloaders\n\nOnce Gamarue has infected a machine, it contacts the C&C server, making the machine part of the botnet.\nThrough the C&C server, the hacker can control Gamarue-infected machines, steal information, or issue\ncommands to download additional malware modules.\n\n_Figure 4. Gamarue’s attack kill-chain_\n\nGamarue’s main goal is to distribute other prevalent malware families. During the CME campaign, we saw at\nleast 80 different malware families distributed by Gamarue. Some of these malware families include:\n\n[Petya (ransomware)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Petya)\n[Cerber (ransomware)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Cerber)\n[Troldesh (ransomware)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Troldesh)\n[Ursnif (info-stealing and banking trojan)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Ursnif)\n[Carberp (info-stealing and banking trojan)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Carberp)\n[Fareit (info-stealing and DDoS malware)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Fareit)\n[Kasidet (worm and DDoS malware)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Kasidet)\n\n\n-----\n\n[Lethic (spam bot)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Lethic)\n[Cutwail (spam bot)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Cutwail)\n[Neurevt (click-fraud malware)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Neurevt)\n[Ursnif (click-fraud malware)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?name=win32/ursnif)\n[Fynloski (backdoor)](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Win32/Fynloski)\n\nThe installation of other malware broadens the scale of what hackers can do with the network of infected\nmachines.\n\n### Command-and-control communication\n\nWhen the Gamarue malware triggers the infected machine to contact the C&C server, it provides information like\nthe hard disk’s volume serial number (used as the bot ID for the computer), the Gamarue build ID, the operating\nsystem of the infected machine, the local IP address, an indication whether the signed in user has administrative\nrights, and keyboard language setting for the infected machine. This information is sent to the C&C server via\nHTTP using the JSON format:\n\n_Figure 5. Information sent by Gamarue to C&C server_\n\nThe information about keyboard language setting is very interesting, because the machine will not be further\ninfected if the keyboard language corresponds to the following countries:\n\nBelarus\nRussia\nUkraine\nKazahkstan\n\nBefore sending to the C&C server, this information is encrypted with RC4 algorithm using a key hardcoded in the\nGamarue malware body.\n\n_Figure 6. Encrypted C&C communication_\n\nOnce the C&C server receives the message, it sends a command that is pre-assigned by the hacker in the\ncontrol dashboard.\n\n\n-----\n\n_Figure 7. Sample control dashboard used by attackers to communicate to Gamarue bots_\n\nThe command can be any of the following:\n\nDownload EXE (i.e., additional executable malware files)\nDownload DLL (i.e., additional malware; removed in version 2.09 and later)\nInstall plugin\nUpdate bot (i.e., update the bot malware)\nDelete DLLs (removed in version 2.09 and later)\nDelete plugins\nKill bot\n\nThe last three commands can be used to remove evidence of Gamarue presence in machines.\n\nThe reply from the C&C server is also encrypted with RC4 algorithm using the same key used to encrypt the\nmessage from the infected machine.\n\n_Figure 8. Encrypted reply from C&C server_\n\nWhen decrypted, the reply contains the following information:\n\nTime interval in minutes – time to wait for when to ask the C2 server for the next command\nTask ID – used by the hacker to track if there was an error performing the task\nCommand – one of the command mentioned above\nDownload URL – from which a plugin/updated binary/other malware can be downloaded depending on the\ncommand.\n\n_Figure 9. Decrypted reply from C&C server_\n\n### Anti-sandbox techniques\n\nGamarue employs anti-AV techniques to make analysis and detection difficult. Prior to infecting a machine,\nGamarue checks a list hashes of the processes running on a potential victim’s machine. If it finds a process that\nmay be associated with malware analysis tools, such as virtual machines or sandbox tools, Gamarue does not\ninfect the machine. In older versions, a fake payload is manifested when running in a virtual machine.\n\n\n-----\n\n_Figure 10. Gamarue checks if any of the running processes are associated with malware analysis tools_\n\n### Stealth mechanisms\n\nGamarue uses [cross-process injection techniques to stay under the radar. It injects its code into the following](https://blogs.technet.microsoft.com/mmpc/tag/cross-process-injection/)\nlegitimate processes:\n\nmsiexec.exe (Gamarue versions 2.07 to 2.10)\nwuauclt.exe, wupgrade.exe, svchost.exe (version 2.06)\n\nIt can also use a rootkit plugin to hide the Gamarue file and its autostart registry entry.\n\nGamarue employs a stealthy technique to store and load its plugins as well. The plugins are stored fileless, either\nsaved in the registry or in an alternate data stream of the Gamarue file.\n\n### OS tampering\n\nGamarue attempts to tamper with the operating systems of infected computers by disabling Firewall, Windows\nUpdate, and User Account Control functions. These functionalities cannot be re-enabled until the Gamarue\ninfection has been removed from the infected machine. This OS tampering behavior does not work on Windows\n10\n\n_Figure 11. Disabled Firewall and Windows Update_\n\n### Monetization\n\nThere are several ways hackers earn using Gamarue. Since Gamarue’s main purpose is to distribute other\nmalware, hackers earn using pay-per-install scheme. Using its plugins, Gamarue can also steal user information;\nstolen information can be sold to other hackers in cybercriminal underground markets. Access to Gamarueinfected machines can also be sold, rented, leased, or swapped by one criminal group to another.\n\n## Remediation\n\nTo help prevent a Gamarue infection, as well as other malware and unwanted software, take these precautions:\n\nBe cautious when opening emails or social media messages from unknown users.\nBe wary about downloading software from websites other than the program developers\n\n\n-----\n\nMore importantly, ensure you have the right security solutions that can protect your machine from Gamarue and\nother threats. Windows Defender Antivirus detects and removes the Gamarue malware. With advanced machine\nlearning models, as well as generic and heuristic techniques, Windows Defender AV detects new as well as\n[never-before-seen malware in real-time via the cloud protection service. Alternatively, standalone tools, such as](https://blogs.technet.microsoft.com/mmpc/2017/07/18/windows-defender-antivirus-cloud-protection-service-advanced-real-time-defense-against-never-before-seen-malware?ocid=cx-blog-mmpc)\n[Microsoft Safety Scanner and the](https://www.microsoft.com/wdsi/products/scanner) [Malicious Software Removal Tool (MSRT), can also detect and remove](https://www.microsoft.com/download/malicious-software-removal-tool-details.aspx)\nGamarue.\n\n[Microsoft Edge can block Gamarue infections from the web, such as those from malicious links in social media](https://docs.microsoft.com/en-us/microsoft-edge/deploy/index?ocid=cx-blog-mmpc)\nmessages and drive-by downloads or exploit kits. Microsoft Edge is a secure browser that opens pages within\nlow privilege app containers and uses reputation-based blocking of malicious downloads.\n\nIn enterprise environments, additional layers of protection are available. Windows Defender Advanced Threat\nProtection can help security operations personnel to detect Gamarue activities, including cross-process injection\ntechniques, in the network so they can investigate and respond to attacks. Windows Defender ATP’s enhanced\nbehavioral and machine learning detection libraries flag malicious behavior across the malware infection process,\nfrom delivery and installation, to persistence mechanisms, and command-and-control communication.\n\nTo test how Windows Defender ATP can help your organization detect, investigate, and respond to advanced\nattacks, **[sign up for a free trial.](https://www.microsoft.com/en-us/windowsforbusiness/windows-atp?ocid=cx-blog-mmpc)**\n\n[Microsoft Exchange Online Protection (EOP) can block Gamarue infections from email uses built-in anti-spam](https://products.office.com/en-us/exchange/exchange-email-security-spam-protection?ocid=cx-blog-mmpc)\nfiltering capabilities that help protect Office 365 customers. [Office 365 Advanced Threat Protection helps secure](https://products.office.com/en-us/exchange/online-email-threat-protection?ocid=cx-blog-mmpc)\nmailboxes against email attacks by blocking emails with unsafe attachments, malicious links, and linked-to files\nleveraging time-of-click protection.\n\n[Windows Defender Exploit Guard can block malicious documents (such as those that distribute Gamarue) and](https://blogs.technet.microsoft.com/mmpc/2017/10/23/windows-defender-exploit-guard-reduce-the-attack-surface-against-next-generation-malware/)\nscripts. The [Attack Surface Reduction (ASR) feature in Windows Defender Exploit Guard uses a set of built-in](https://docs.microsoft.com/en-us/windows/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard?ocid=cx-blog-mmpc)\nintelligence that can block malicious behaviors observed in malicious documents. ASR rules can also be turned\non to [block malicious attachments from being run or launched from Microsoft Outlook or webmail (such as Gmail,](https://docs.microsoft.com/en-us/windows/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard?ocid=cx-blog-mmpc)\nHotmail, or Yahoo).\n\nMicrosoft is also continuing the collaborative effort to help clean Gamarue-infected computers by providing a one[time package with samples (through the Virus Information Alliance) to help organizations protect their customers.](https://www.microsoft.com/en-us/wdsi/alliances/virus-information-alliance)\n\n**_Microsoft Digital Crimes Unit and Windows Defender Research team_**\n\nGet more info on the Gamarue (Andromeda) takedown from the following sources:\n\nEuropol: [Andromeda botnet dismantled in international cyber operation](https://www.europol.europa.eu/newsroom/news/andromeda-botnet-dismantled-in-international-cyber-operation)\nESET: [ESET unites with Microsoft and law enforcement agencies to disrupt Gamarue botnets](https://www.eset.com/us/about/newsroom/press-releases/eset-unites-with-microsoft-and-law-enforcement-agencies-to-disrupt-gamarue-botnets/)\n\n\n-----\n\n**Talk to us**\n\n[Questions, concerns, or insights on this story? Join discussions at the Microsoft community and](https://answers.microsoft.com/en-us/protect) Windows\nDefender Security Intelligence.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-12-04 - Microsoft teams up with law enforcement and other partners to disrupt Gamarue (Andromeda).pdf"
    ],
    "report_names": [
        "2017-12-04 - Microsoft teams up with law enforcement and other partners to disrupt Gamarue (Andromeda).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535734,
    "ts_updated_at": 1743041170,
    "ts_creation_date": 1653774942,
    "ts_modification_date": 1653774942,
    "files": {
        "pdf": "https://archive.orkl.eu/28fef20d5ae488248a42d3fa1b81e30cdadfe924.pdf",
        "text": "https://archive.orkl.eu/28fef20d5ae488248a42d3fa1b81e30cdadfe924.txt",
        "img": "https://archive.orkl.eu/28fef20d5ae488248a42d3fa1b81e30cdadfe924.jpg"
    }
}