{
    "id": "788c2837-7b91-4599-82ac-205c3c31073f",
    "created_at": "2023-01-12T14:59:51.891102Z",
    "updated_at": "2025-03-27T02:16:34.885911Z",
    "deleted_at": null,
    "sha1_hash": "98b4aa64a424063e28d4c14a68bb3aee6ba377fb",
    "title": "2022-06-13 - BumbleBee- a new trendy loader for Initial Access Brokers",
    "authors": "",
    "file_creation_date": "2022-07-02T23:12:16Z",
    "file_modification_date": "2022-07-02T23:12:16Z",
    "file_size": 873940,
    "plain_text": "# BumbleBee: a new trendy loader for Initial Access Brokers\n\n**[blog.sekoia.io/bumblebee-a-new-trendy-loader-for-initial-access-brokers/](https://blog.sekoia.io/bumblebee-a-new-trendy-loader-for-initial-access-brokers/)**\n\n[Threat & Detection Research Team\nJune 13 2022](https://blog.sekoia.io/author/tdr/)\n850\n0\n\nRead it later\nRemove\n\n7 minutes reading\n\n_This blog post on BumbleBee malware was originally published as a FLINT report_\n_[(SEKOIA.IO Flash Intelligence) sent to our clients on June 02, 2022.](https://www.sekoia.io/en/sekoia-io-cti/)_\n\n\nJune 13, 2022\n\n\n**BumbleBee is a new malicious loader, first reported by Google TAG in March 2022, that is**\nbeing used by several Initial Access Brokers (IABs) to gain an initial foothold within victims’\nnetworks.\n\nIn recent weeks, many campaigns distributing BumbleBee have been observed in the wild\nand the successful compromises often lead to ransomware attacks. Indeed, affiliates of\n[several ransomware gangs (Conti, LockBit, AvosLocker, Diavol) were observed delivering](https://blog.sekoia.io/an-insider-insights-into-conti-operations-part-one/)\nBumbleBee in order to drop another payload [(Cobalt Strike, Meterpreter, Sliver, IcedID,](https://blog.sekoia.io/hunting-and-detecting-cobalt-strike/)\n\n\n-----\n\n[Redline, and more) and deploy ransomware. Furthermore, SEKOIA.IO analysts observed the](http://sekoia.io/)\nmalware is still in development with new features, and improvements. All these reasons\nmake the BumbleBee loader a major threat that companies must deal with at the moment.\n\n[SEKOIA.IO analysts have been tracking this threat since early April 2022 and have seen](http://sekoia.io/)\na significant increase in the number of active BumbleBee C2 servers, and observed\nsamples. The analysis of multiple BumbleBee samples allowed us to identify several\n**versions and improvements made to the product.**\n\n## Technical Analysis\n\nIn this section, we briefly describe the typical infection chain used to deliver the BumbleBee\nloader. We then share technical details on the modifications made in the latest versions of\nthe malware, and how we track the active C2 server and the malware samples.\n\nBefore getting into the technical details, the BumbleBee malware is a sophisticated loader\nthat aims to download and execute a second payload. It implements several defense and\nevasion techniques to hide from detection systems, and to make it harder for security\nresearchers to analyze the payload.\n\n### Typical infection chain\n\nMost of the spearphishing campaigns distributing the BumbleBee loader use the same attack\npattern: an email is sent to the victim with a ZIP archive which contains an ISO file. The\nbeginning of the attack chain consists of using an ISO file which contains a Windows link\n(LNK) used to execute the payload (DLL).\n\nIn the following example, the ISO file contains two files:\n\n1. a LNK file New Folder.lnk\n2. a DLL executed by the LNK file\n\nAs shown in the figure below, when the LNK file is executed, it runs the command below to\nstart the malicious DLL using `rundll32.exe :` `C:\\\\Windows\\\\System32\\\\rundll32.exe`\n```\nprocsvc.dll,HWgullOFkZ\n\n```\n\n-----\n\n_Figure 1. Example of an attachment (uncompressed ISO file) from a spearphishing campaign_\n_distributing BumbleBee_\n\nThis infection vector is more and more used by various actors: APT (such as NOBELIUM),\nIABs (to distribute IcedID, BazarLoader, BumbleBee, and more) and other threat actors. This\ntrend appears to be the consequence of the disabling by default of VBA macros in Microsoft\nOffice products, which is one (code execution via Office macros) of the most used\ntechniques by adversaries to get into the network.\n\n[Discover our CTI and XDR products](http://sekoia.io/en/contact/)\n\n### Modifications in the latest version\n\nThe BumbleBee DLL uses a crypter to deobfuscate another PE that is loaded in a new\nmemory section. This specific section is quickly identifiable: a simple pattern search in a\ndebugger on “DOS mode” can highlight the newly allocated memory with read-write-execute\npermission.\n\nOnce the new section is dumped, the BumbleBee payload can be analyzed. Before anything\nelse, it is worth noting that the malware used almost a full copy/paste of al-khaser github\nproject, as mentioned in others articles or related BumbleBee discussions. The al-khaser\ncode implements several anti-detection techniques. The figure below shows that the main\nfunction of the BumbleBee payload avoids execution if one of the anti-virtual environments is\nspotted.\n\n\n-----\n\n_Figure 2. Anti-virtual machine checks in the BumbleBee code_\n\nOnce the loaded PE is ready and anti-VM checks are passed, the malware decrypts its\nCommand and Control (C2) IP addresses with a key stored in cleartext in\nthe `.data section using RC4 algorithm. This decryption routine is also used to deobfuscate`\nits campaign ID.\n\n_Figure 3. Deobfuscation routine in BumbleBee loader_\n\nIn most of the payloads we investigate, three blobs of data are obfuscated using RC4:\n\n1. A list of C2 IP addresses with their associated port\n2. A campaign identifier, other analysts identify this ID as the botnet ID\n3. A number (often 444 or 4444)\n\n\n-----\n\n_Figure 4. Recipe in CyberChef to get the obfuscated data_\n\nOnce, the C2 IP addresses have been deobfuscated, the malware contacts one of its C2 and\nthen loads the final payload (Meterpreter, Cobalt Strike, or else).\n\nIn the initial BumbleBee versions analyzed in April 2022, the malware did not implement any\nC2 obfuscation: the IP addresses were stored in clear in the PE. This evolution shows that\nBumbleBee is still under development.\n\n_NB: We observed a massive usage of the key “ BLACK ” in the dataset of samples we_\n_analyzed and also the key “ iKInPE9WrB “._\n\n[Discover our CTI and XDR products](http://sekoia.io/en/contact/)\n\n### Tracking BumbleBee\n\n**C2 infrastructure**\n\nTracking the BumbleBee C2 infrastructure is not much different from other botnets such as\nBazarLoader, Qakbot and IcedID. The SSL certificates used for the BumbleBee C2 server\nare quite specific. After some analysis of malware samples and thanks to search engines for\nInternet-connected devices, we were able to identify a common and unique pattern to find\nthe BumbleBee C2 servers. The final heuristic is based on the SSL certificate and the HTTP\nresponse.\n\nThe heuristic results have increased, from 5 C2 servers at the beginning of April to over 130\nat the time of writing this FLINT, as shown by the following figure.\n\n\n-----\n\n_Figure 5. Number of active BumbleBee C2 servers by date_\n\nThis shows that the BumbleBee loader has gained in popularity among the threat actors,\nparticularly for the Initial Access Brokers.\n\n**Samples**\n\nAt the same time, we have written a YARA rule to find BumbleBee samples – it can be found\nin the section of IOCs & Technical Details. The results of the YARA rule uploaded on a\nsample sharing platform confirm the trend described previously.\n\nBumbleBee has become in two months a major threat, mostly deployed by Initial Access\nBrokers to gain a foothold within a network and drop a second payload. With the malware\nbeing used by affiliates of ransomware gangs, companies need to monitor this\n**threat and protect their assets from possible BumbleBee compromises.**\n\n## IOCs & Technical Details\n\n**BumbleBee’s C2 servers**\n\n\n-----\n\n```\n23.82.140[.]133\n\n23.254.217[.]20\n\n23.254.227[.]144\n\n37.120.198[.]248\n\n49.12.241[.]35\n\n51.68.144[.]94\n\n51.68.146[.]200\n\n51.68.147[.]233\n\n51.75.62[.]99\n\n51.83.251[.]245\n\n51.83.253[.]244\n\n51.83.254[.]164\n\n54.37.130[.]166\n\n54.37.131[.]107\n\n54.38.136[.]187\n\n54.38.137[.]18\n\n54.38.138[.]141\n\n54.38.139[.]20\n\n64.44.101[.]250\n\n64.44.102[.]6\n\n64.44.102[.]150\n\n64.44.135[.]230\n\n64.44.135[.]250\n\n70.34.216[.]103\n\n104.168.156[.]224\n\n145.239.29[.]119\n\n145.239.30[.]26\n\n146.70.95[.]244\n\n146.70.106[.]47\n\n167.235.245[.]35\n\n176.107.177[.]124\n\n192.236.161[.]191\n\n192.236.162[.]127\n\n192.236.194[.]136\n\n193.29.104[.]147\n\n193.233.203[.]156\n\n194.37.97[.]135\n\n209.141.52[.]25\n\n```\n**BumbleBee’s SHA-25**\n\n\n-----\n\n```\ne2147cb6039d1b065b0d59d6e60a1e5f526415afefdfddcbbd7b1e8a33194d64\n064d21a62fc8718a707c3cf6ca91fddeb2fd407dfee47a923638a91a57b338a4\n7140becbc882cab84038ad87e977cd3cb0dc864d2437eb1e2aebab78cc3eb193\n0f78561577ce1a5ab8b98634fb9b2ff0392e173fb354e3625f6bab53e0f28b05\n94f7bc1e910866c5ed1b06242e82c8d5379d143123ff255b87fc78db98c49ae2\n2ca8fcce17d0ca5dc6c260c34b14b969fbc20c4a4520e19aed0a0be23a199243\n7b3a33baf89095f9b7d2be8dfa184c274e7f27a05a7e57faf8b32882a60bfe5c\n3a2112ed78bbec16929d9f39aca09efe2eb44abb80bbfa765e451a87aef84a99\n85019644110b9473b93e3757ed9b324666ac515a1b91afdfbc3b17241b2d9376\n873aa6d30e38c79b478eb04a83104bb31fd62989d3cca4b61164065038dadd29\n7413426f5afd78b7abc0ca0a3035c2f8578c41e18548ad530ead3ee93f638a3c\n86984171de311b006bc86780e5a415b3698edb864d42e72f851a7d64c2656748\n9d6808021c1336763e212c787a669eb0400b089e586457b88373dd87dfcf41c9\nea6690f028157aec343e21484eab136379e35c6296b3e8eab4a7ba7bdfe13e5d\n8709e8dfe6bf8b8fdc91c342fc2da948d5b77b05e7a6dba79866f42dfe8ca04b\n1389ec4bde4a8970e95d8a48438395578ae81e0649f33c5ca0febe062e56712c\nfad36c037c93c48ef5cdf31b8ed31e452a100ad14b75dce88597ef1eea115e9e\n\n```\n**YARA rule**\n```\nrule loader_win_bumblebee {\n\n  meta:\n\n   version = \"1.0\"\n\n   malware = \"BumbleBee\"\n\n   reference = \"https://blog.sekoia.io/bumblebee-a-new-trendy-loader-for-initialaccess-brokers/\"\n\n   source = \"SEKOIA.IO\"\n\n   classification = \"TLP:WHITE\"\n\n  strings:\n\n   $str0 = { 5a 00 3a 00 5c 00 68 00 6f 00 6f 00 6b 00 65 00 72 00 32 00 5c 00 43\n00 6f 00 6d 00 6d 00 6f 00 6e 00 5c 00 6d 00 64 00 35 00 2e 00 63 00 70 00 70 00 } //\nZ:\\hooker2\\Common\\md5.cpp\n\n   $str1 = \"/gates\" ascii\n\n   $str2 = \"3C29FEA2-6FE8-4BF9-B98A-0E3442115F67\" wide\n\n  condition:\n\n   uint16be(0) == 0x4d5a and all of them\n\n}\n\n## External References\n\n Chat with our team!\n\n```\nWould you like to know more about our solutions? Do you want to discover our XDR and CTI\nproducts? Do you have a cybersecurity project in your organization? Make an appointment\nand meet us!\n\n**[Contact us](https://www.sekoia.io/en/contact/)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-13 - BumbleBee- a new trendy loader for Initial Access Brokers.pdf"
    ],
    "report_names": [
        "2022-06-13 - BumbleBee- a new trendy loader for Initial Access Brokers.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535591,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1656803536,
    "ts_modification_date": 1656803536,
    "files": {
        "pdf": "https://archive.orkl.eu/98b4aa64a424063e28d4c14a68bb3aee6ba377fb.pdf",
        "text": "https://archive.orkl.eu/98b4aa64a424063e28d4c14a68bb3aee6ba377fb.txt",
        "img": "https://archive.orkl.eu/98b4aa64a424063e28d4c14a68bb3aee6ba377fb.jpg"
    }
}