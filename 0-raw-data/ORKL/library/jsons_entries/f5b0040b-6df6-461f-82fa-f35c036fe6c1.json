{
    "id": "f5b0040b-6df6-461f-82fa-f35c036fe6c1",
    "created_at": "2022-10-25T16:48:20.926815Z",
    "updated_at": "2025-03-27T02:17:27.599265Z",
    "deleted_at": null,
    "sha1_hash": "661bde223c85c5dbd8e47c68e35b6a6c97e657a3",
    "title": "Fox Kittens report  18.2.2020",
    "authors": "",
    "file_creation_date": "2020-02-23T14:08:10Z",
    "file_modification_date": "2020-02-23T14:08:10Z",
    "file_size": 2487559,
    "plain_text": "# Fox Kitten Campaign\n\n## Widespread Iranian Espionage-Offensive Campaign\n\n### February 2020\n\n#### TLP:White\n\n2020 © All rights reserved to ClearSky Security Ltd. [www.clearskysec.com](http://www.clearskysec.com/)\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n#### 1. Executive Summary\n\nDuring the last quarter of 2019, ClearSky research team has uncovered a widespread Iranian offensive\ncampaign which we call “Fox Kitten Campaign”; this campaign is being conducted in the last three\nyears against dozens of companies and organizations in Israel and around the world. Though the\ncampaign, the attackers succeeded in gaining access and persistent foothold in the networks of\nnumerous companies and organizations from the IT, Telecommunication, Oil and Gas, Aviation,\nGovernment, and Security sectors around the world.\n\nWe estimate the campaign revealed in this report to be among Iran’s most continuous and\ncomprehensive campaigns revealed until now. Aside from malware, the campaign enfolds an entire\ninfrastructure dedicated to ensuring long-lasting capability to control and fully access the targets\nchosen by the Iranians. The revealed campaign was used as reconnaissance infrastructure; however,\nit can also be used as a platform for spreading and activating destructive malware such as ZeroCleare\nand Dustman, tied to APT34.\n\nDuring our analysis, we have found an overlap, with medium-high probability, between this\ncampaign’s infrastructure and the activity of an Iranian offensive group APT34-OilRig. Additionally, we\nhave identified, with medium probability, a connection between this campaign and the APT33-Elfin\nand APT39-Chafer groups. The campaign was first revealed by Dragos, named “Parisite” and attributed\nto APT33; we call the comprehensive campaign revealed in this report “Fox Kitten”.\n\nWe assess with medium probability that the Iranian offensive groups (APT34 and APT33) have been\nworking together since 2017, though the infrastructure that we reveal, vis-à-vis a large number of\ncompanies in Israel and around the world.\n\nThe campaign infrastructure was used to:\n\n  - Develop and maintain access routes to the targeted organizations\n\n  - Steal valuable information from the targeted organizations\n\n  - Maintain a long-lasting foothold at the targeted organizations\n\n  - Breach additional companies through supply-chain attacks\n\nThe campaign was conducted by using a variety of offensive tools, most of which open source code\nbased and some – self-developed.\n\nThe initial breach of the targeted organizations was performed, in most cases, by exploiting 1-day\nvulnerabilities in different VPN services such as: Pulse Secure VPN, Fortinet VPN, and Global Protect by\nPalo Alto Networks. Upon gaining foothold at the target, the attackers tried to maintain the access to\nthe networks by opening a variety of communication tools, including opening RDP links over SSH\ntunneling, in order to camouflage and encrypt the communication with the targets. At the final stage,\nafter successfully infiltrating the organization, the attackers have performed a routine process of\nidentification, examination, and filtering of sensitive, valuable information from every targeted\norganization. The valuable information was sent back to the attackers for reconnaissance, espionage,\nor further infection of connected networks.\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nOur main insights:\n\n  - The Iranian APT groups have succeeded to penetrate and steal information from dozens of\ncompanies around the world in the past three years.\n\n  - The most successful and significant attack vector used by the Iranian APT groups in the last\nthree years has been exploitation of known vulnerabilities in systems with unpatched VPN and\nRDP services, in order to infiltrate and take control over critical corporate information storages.\n\n  - This attack vector is not used exclusively by the Iranians APT groups; it became a main attack\nvector for cybercrime groups, ransomware attacks, and other state-sponsored offensive\ngroups.\n\n  - We assess this attack vector to be significant also in 2020 apparently by exploiting new\nvulnerabilities in VPN’s and other remote systems (such as the latest one existing in Citrix).\n\n  - Iranian APT groups have developed good technical offensive capabilities and are able to\nexploit 1-day vulnerabilities in relatively short periods of time, starting from several hours to a\nweek or two.\n\n  - Since 2017, we identify Iranian APT groups’ focusing on IT companies that provide wide range\nof services to thousands of companies. Breaching those IT companies is especially valuable,\nbecause through them one can reach the networks of additional companies.\n\n  - After breaching the organizations, the attackers usually maintain foothold and operational\nredundancy by installing and creating several more access points to the core corporate\nnetwork. As a result, identifying and closing one access point does not necessarily deny the\ncapability to carry on operations inside the network.\n\n  - We assess with medium-high probability that Iranian APT groups (APT34 and APT33) share\nattack infrastructures. Furthermore, it can be one group that was artificially marked in recent\nyears as two or three separate APT groups.\n\n  - The time needed to identify an attacker on a compromise network is long and varies between\nmonths to not at all. The existing monitoring capability for organizations to identify and block\nan attacker that entered through remote communication tools, is difficult to impossible.\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nIn this report, we survey the attack stages and tools used in the campaign by matching it to the MITRE\nATT&CK model. The first part of the report contains a short review of the offensive tools found in the\nbreached organizations or uploaded to public repositories for analysis. Throughout the attacks, no\ncoherent scenario was identified. The attackers changed their modus operandi and thus the tools are\nnot necessarily presented in their chronological attack vector. In the following chapters we expand on\nthe techniques and methods used in analyzing the tools. After that, an attribution to the different APT\ngroups is being made, and finally we present some recommendations and IoCs.\n\nWe would like to thank Dragos [1]researchers who found the first signs of the campaign (Called by them\nas “Parisite”) and shared with us valuable information that helped us reveal the whole Fox -Kitten\ncampaign presented in this report.\n\nAlso, we would like to thank the companies that chose to share with us information. Without their\nsharing of malicious tools, the scale and depth infrastructure would not have been revealed.\n\n1 [https://dragos.com/](https://dragos.com/)\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n#### 2. Table of Contents\n\n1. Executive Summary ................................................................................................................................... 2\n\n2. Table of Contents ...................................................................................................................................... 5\n\n3. Fox Kitten Campaign’s Offensive Tools .................................................................................................... 6\n\n3.1 Tools Used in Fox Kitten Campaign ............................................................................................... 6\n\n3.2 Tools and Attack Techniques’ Classification According to MITRE ATT&CK .................................. 7\n\n4. Techniques and Methods ........................................................................................................................ 10\n\n4.1 Pre-access and Access Tools ....................................................................................................... 10\n\n4.1.1 Main Attack Vector – Exploiting Vulnerabilities in VPN Systems ................................................ 10\n\n4.1.2 Pre-access tool for unifying file chunks hex-encoded in TXT files into one executable ......... 11\n\n4.2 Local Privilege Escalation Tools ................................................................................................... 14\n\n4.2.1 “Juicy Potato” ................................................................................................................................... 15\n\n4.2.2 “Procdump” and “Mimikatz” .......................................................................................................... 16\n\n4.2.3 “Sticky Keys” and Other Accessibility Tools’ Settings ................................................................. 17\n\n4.2.4 Local Admin User ............................................................................................................................. 17\n\n4.3 Lateral Movement Tools ............................................................................................................. 17\n\n4.3.1 “STSRCheck” ..................................................................................................................................... 17\n\n4.3.2 “PORT.EXE” ....................................................................................................................................... 18\n\n4.3.3 “Invoke the Hash” ............................................................................................................................ 19\n\n4.4 Backdoor Installation and C&C Communication Tools ............................................................... 20\n\n4.4.1 “POWSSHNET” .................................................................................................................................. 21\n\n4.4.2 Socket-based Backdoor for Socket Opening ............................................................................... 24\n\n4.4.3 “Servo”, “Ngrok”, and “FRP” ........................................................................................................... 26\n\n4.4.4 Internal and External Webshells .................................................................................................... 27\n\n4.4.5 Archives (WinRAR or 7-zip) .............................................................................................................. 30\n\n5. Attribution to Iranian APT Groups .......................................................................................................... 31\n\n6. Insights and Recommendations .............................................................................................................34\n\n7. Indicators .................................................................................................................................................35\n\nHashes ............................................................................................................................................... 35\n\nIP Addresses ...................................................................................................................................... 36\n\nGUID ID .............................................................................................................................................. 37\n\nMutex ................................................................................................................................................ 37\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n#### 3. Fox Kitten Campaign’s Offensive Tools\n\nIn this chapter, we will shortly survey the offensive tools used during the campaign. In the first part we\nreview the main tools used during the campaign. In the second part of the chapter we will match the\ntools to the cyber event kill chain. At the end of the chapter, we present a summary table with all the\nindicators from the “Fox Kitten” campaign.\n\n##### 3.1 Tools Used in Fox Kitten Campaign\n\nDuring the Fox Kitten campaign, the attackers have used many different offensive tools to maintain\nfoothold at the organization they have infiltrated. Upon initial compromise of the corporate network,\nthe attackers focused on establishing strong grip in the organization by installing a set of remote access\nand communication tools.\n\nAfter finishing the breaching process, the attackers establish their “grip” on the organization by\ninstalling several backdoors at the systems they have compromised. Those backdoors allowed the\nattackers to connect to the network secretly and steadily. In many cases, the attackers have connected\nto the organization through a regular encrypted RDP connection.\n\nThe attackers created for their self-developed tools versions that match the operational systems at\ntarget organizations. Thus, in 2017 the tools were developed and fitted to 32-bit systems, while in 2019\nthe tools were developed for 64-bit systems.\n\nThe tools used by the Iranian attackers can be divided into several groups:\n\n1. Self-developed tools – tools developed by the attacker and fitted to the attacked. In this\n\ncampaign we have identified a few self-developed tools. The most important tool is a\nbackdoor that opens a SSH tunnel between the attacker and the target, and allows the former\nto connect to the latter through RDP.\nFollowing is a list of self-developed tools used by the Iranians in this campaign:\n\n      - STSRCheck – Self-development databases and open ports mapping tool.\n\n      - POWSSHNET - Self-Developed Backdoor malware – RDP over SSH Tunneling.\n\n      - VBScript – download TXT files from the command-and-control (C2 or C&C) server and\nunify these files to a portable executable file.\n\n      - Socket-based backdoor over cs.exe – An exe file used to open a socket-based\nconnection to a hardcoded IP address.\n\n      - Port.exe – tool to scan predefined ports an IP’s\n2. Open source-based tools taken from the internet and adjusted to the attackers’ use, either by\n\nmaking changes to the tool or by using it as it is.\nFollowing is a list of open-source tools used by the Iranians in this campaign:\n\n      - Invoke the Hash – PowerShell commands in order to perform “Pass the Hash”\nmethods.\n\n      - JuicyPotato – Local Privilege Escalation tool.\n3. Seemingly legitimate tools used by the Iranians for their needs. Following are two examples\n\nfor this kind of tools:\n\n      - Ngrok, FRP, Serveo - Free Command and Control Protocol\n\n      - Putty and Plink – Remote services\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n##### 3.2 Tools and Attack Techniques’ Classification According to MITRE ATT&CK\n\nThe tools and attack techniques’ table are divided into three types:\n\n1. Exploitation technique of VPN tools’ vulnerabilities at the initial compromise stage in targeted\n\norganizations.\n2. Tools designed for privilege escalation, foothold ensuring, and creating a gap for RDP\n\nconnection and information theft.\n3. Post-exploitation tools used for C2 server communication and files’ exfiltration, after the\n\ncampaign has ensured its foothold on the target.\n\nThe table presents an overlap between techniques and tools identified during the Fox Kitten campaign,\nand those of three Iranian offensive groups: APT33 and APT34, the campaign’s main groups, and APT\n39, a sub-group of APT34 to which we have found matchings in several characteristics of the Fox Kitten\ncampaign[2]. Malicious offensive tools are highlighted in red.\n\n###### Kill Chain Techniques, Title MITRE ATT&CK Known Iranian\n\n Tools and group or tool (if\n Phase\n Procedures exists)\n\nExploit Technique CVE-2019-11510 External Remote APT34\n\nServices - T1133\n\nCVE-2018-13379\n\nCVE-2018-1579\n\nExecute Technique HEX in TXT files Data Staged – T1074 \nTool Putty and Plink Remote Services - Legitimate tools,\n\nT1021 used by APT33,\n\nAPT34\n\nRemote File Copy –\n\nT1105\n\nProcedures Stealing credentials Credential Dumping – APT33, APT34,\n\nvia Procdump to T1003 APT39\n\nlsass.exe and\n\nMimikatz – S0002\n\nMimikatz\n\nTools STSRCheck  - Self- Network Service APT34, APT39\n\ndevelopment Scanning – T1046\n\ndatabases and open\n\nports mapping tool\n\n2 attack.mitre.org/groups/G0064/\nattack.mitre.org/groups/G0049/\nattack.mitre.org/groups/G0087/\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n|Kill Chain Phase|Techniques, Tools and Procedures|Title|MITRE ATT&CK|Known Iranian group or tool (if exists)|\n|---|---|---|---|---|\n|Exploit|Technique|CVE-2019-11510 CVE-2018-13379 CVE-2018-1579|External Remote Services - T1133|APT34|\n|Execute|Technique|HEX in TXT files|Data Staged – T1074|-|\n||Tool|Putty and Plink|Remote Services - T1021 Remote File Copy – T1105|Legitimate tools, used by APT33, APT34|\n||Procedures|Stealing credentials via Procdump to lsass.exe and Mimikatz|Credential Dumping – T1003 Mimikatz – S0002|APT33, APT34, APT39|\n||Tools|STSRCheck - Self- development databases and open ports mapping tool|Network Service Scanning – T1046|APT34, APT39|\n\n\n-----\n\n|Kill Chain Phase|Techniques, Tools and Procedures|Title|MITRE ATT&CK|Known Iranian group or tool (if exists)|\n|---|---|---|---|---|\n||Tools + Techniques|Invoke the Hash|PowerShell – T1086 Pass the Hash – T1075|Open Source tool. Techniques used by: APT33, APT34|\n||Procedures|Local Admin / User|Create Account – T1136|-|\n||Techniques|Accessibility tool (Sticky Keys) abuse|Command-Line Interface – T1059 Accessibility Features – T1015|APT34|\n||Tools|JuicyPotato – Local Privilege Escalation tool|Exploitation for Privilege Escalation – T1068|Open Source Tool, also used by: APT33|\n||Procedures|Scheduled Task|Scheduled Task|Common mechanism, also utilized by: APT33, APT34, APT39|\n||Techniques|RDP connection (over SSH)|Custom Command and Control Protocol – T1094 Remote Desktop Protocol – T1076|APT34, APT39|\n||Tools|Port.exe|Network Service Scanning -T1046)||\n||Tools|Ngrok|Connection Proxy - T1090|Free tool|\n||Tools|FRP|Connection Proxy - T1090|Open Source Tool|\n||Tools|Serveo|Connection Proxy - T1090|Free tool|\n\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n|Kill Chain Phase|Techniques, Tools and Procedures|Title|MITRE ATT&CK|Known Iranian group or tool (if exists)|\n|---|---|---|---|---|\n|C&C|Tools|POWSSHNET - Self- Developed Backdoor– RDP over SSH Tunneling|Credentials in Files – T1081 Remote Services – T1021 Remote Desktop Protocol - T1076|APT34, APT39|\n||Tools|VBScript – downloading files from C2|Scripting - T1064|APT34|\n||Tools|Socket-based backdoor – cs.exe|Uncommonly Used Port - T1065|APT33|\n||Techniques|External Webshell over the internet|Web Shell – T1100 Remote Services – T1021|APT33, APT34|\n||Techniques|Local Webshell – Local IIS|Web Shell – T1100|APT34|\n||Techniques|Local Webshell – Virtual Directory|Web Shell – T1100 Connection Proxy – T1090|APT34|\n||Techniques|Communication with C2|Web Service – T1102|APT33, APT34, APT39|\n||Procedures|Archives (WinRAR or 7- ZIP)|Data Compressed – T1002|APT39|\n\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n#### 4. Techniques and Methods\n\nThis chapter presents a review of techniques employed in the Fox Kitten campaign. The techniques\ncan be divided into four main categories:\n\n1. Achieving access to target network through vulnerabilities’ exploitation.\n2. Achieving persistent foothold on target network using privilege escalation and users’\n\ncredentials.\n3. Moving along the network by lateral movement.\n4. Different techniques for relevant files’ exfiltration back to Iran.\n\nDuring research on the campaign, several techniques, aimed to maintain persistent foothold on target\nnetwork and exploiting completely legitimate tools, have been identified. One of those is exploiting the\nMicrosoft accessibility tools: the Iranians appear to exploit different accessibility tools built for the\nWindows OS, while the most used method is exploiting the “sticky keys” tool to create a shell. The\naccessibility tools, originally designed to create an accessible environment for people with certain\nphysical limitations, are used for privilege escalation on the targeted system[3].\n\n##### 4.1 – Pre-access and Access Tools\n\n 4.1.1 Main Attack Vector – Exploiting Vulnerabilities in VPN Systems\n\n###### MITRE ATT&CK Tactic: Initial Access (TA0001)\n\n MITRE ATT&CK Technique: External Remote Services (T1133)\n\nCorporate network blueprint – the infiltration zone is marked with red\n\nIn most cases, the corporate networks were compromised by exploiting discovered and published\nvulnerabilities in VPN systems in order to access the target network. The main VPN systems exploited\nby the attackers are Pulse Secure Connect, Global Protect (by Palo Alto Networks), and Fortinet\n\n3 attack.mitre.org/techniques/T1015/\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nFortiOS. We assess with high probability that vulnerabilities in Citrix will be used by the attackers as\nwell.\n\nExploiting VPN gateway vulnerabilities on the targets, the group successfully acquires access to the\ntargets’ core systems, downloads different files, and continues with lateral movement and foothold\nensuring. The main system exploited is Pulse Secure Connect, through the CVE-2019-11510\nvulnerability.\n\nFollowing are the vulnerabilities in different access systems used by the attackers:\n\nCVE-2019-11510 Pulse Secure\n\nIn Pulse Secure – Pulse Connect Secure (PCS) 8.2 before 8.2R12.1, 8.3 before 8.3R7.1, and 9.0 before\n9.0R3.4, an unauthenticated remote attacker can send a specially crafted URI to perform an arbitrary\nfile reading vulnerability.\n\nCVE-2018-13379 Fortinet FortiOS\n\nAn Improper Limitation of a Pathname to a Restricted Directory (\"Path Traversal\") in Fortinet FortiOS\n6.0.0 to 6.0.4, 5.6.3 to 5.6.7 under SSL VPN web portal allows an unauthenticated attacker to download\nsystem files via special crafted HTTP resource requests.\n\nCVE-2018-1579 Palo Alto Networks VPN\n\nThis vulnerability in Palo Alto Networks VPN appliances affects PAN-OS 7.1.18 and earlier, PAN-OS\n8.0.11-h1 and earlier, and PAN-OS 8.1.2 and earlier with GlobalProtect Portal or GlobalProtect Gateway\nInterface enabled. An attacker who successfully exploits this vulnerability by sending a specially crafted\npacket can execute arbitrary code on the device. The vulnerability allows an attacker to modify the\ndevice and access sensitive information.\n\nThose vulnerabilities are still relevant and were recently used in a destructive malware attack on the\nnational oil company of Bahrain[4].\n\n###### 4.1.2 Pre-access tool for unifying file chunks hex-encoded in TXT files into one executable\n\n MITRE ATT&CK Tactic: Execution (TA0002)\n\n MITRE ATT&CK Technique: Scripting (T1064)\n\nUpon gaining an initial access to the organization, some different files are downloaded to the\ncompromised computer, in order to run additional tools. First, a few VBScript files will be downloaded\nfrom the C2 servers, designed to download additional files from different servers. The VBS files are\ngenerically named – like ‘down’ or different English letters, like “vvv”, “v1”, “v” etc. – and those titles are\nnot unique for this particular attack and can be found on the internet[5]. Based on the tool’s description\nby the source code’s author, the code is designed to download a binary using XMLHTTP. Following is a\nscreenshot of one of the files, called “Down”:\n\n4 zdnet.com/article/new-iranian-data-wiper-malware-hits-bapco-bahrains-national-oil-company/\n5 blog.netnerds.net/2007/01/vbscript-download-and-save-a-binary-file/\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nRunning different VBS scripts, one can download an array of files on the infected computer, and those\nwill be used by the attacker to establish foothold and move laterally. As it can be seen in the code, the\n“Download” function will perform a GET request to an internal address using the object\nMSXML2.ServerXMLHTTP in order to download a file. At the end of this process, throughout which\nseveral VBScript scripts will be run, several txt files will be created on the computer.\n\nEvery such txt file contains a string of numbers and letter which are an encoded piece of code, in\nhexadecimal. Following is a screenshot of one of these files, followed by the hex decoded:\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nSeveral such files are downloaded to the computer, each one comprises a different piece of a\nbackdoor’s code. The purpose of this dissection of an executable into several files is to avoid detection\nby anti-virus programs installed on the attacked computer. In addition, a batch file, named\n“combine.bat”, is downloaded to the computer and its goal is to combine all those files and create an\nexecutable. Following is a screenshot of the entire EXE file represented in hex editor:\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nFollowing is a summary of processes happening on the attacked computer:\n\nRequest to the server Downloading a batch\n\nand downloading of file named\n\nDownloading and\n\ntext files containing combine.bat which\n\nrunning of VBS files\n\nhex-encoded pieces combines the text\n\nof code files into an EXE file\n\n##### 4.2 Local Privilege Escalation Tools\n\nAfter the vulnerabilities in the VPN systems have been used for initial access, the attackers perform\nseveral actions to ascertain their foothold in the network and maintain high privileges there. During\nthe attacks that we have observed, we didn’t identify one consistent attack scenario and one kill chain.\nTherefore, the tools reviewed in this chapter do not necessarily comprise a continuous, chronological\norder. In this chapter, we will present the different tools and techniques based on the MITRE ATT&CK\nmodel, divided into the following techniques:\n\n###### Execution, Persistence, Privilege Escalation, Credential Access\n\n Discovery, Lateral Movement.\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n###### 4.2.1 “Juicy Potato” MITRE ATT&CK Tactic: Privilege Escalation (TA0004)\n\n MITRE ATT&CK Technique: Exploitation for Privilege Escalation (T1068)\n\nJuicy Potato is an open-source tool found on GitHub[6] and based on RottenPotatoNG. It can perform\nlocal privilege escalation from NT AUTHORITY\\LOCAL SERVICE to NT AUTHORITY\\SYSTEM using the\n“BITS Service” and “COM servers” processes. The tool searches for errors in privileges given to the users\nin the credentials manager in order to give a local user higher access.\n\nIn order for this tool to run properly on the computer, the attacker has to have one of the following two\npermissions:\n\n  - SeImpersonate – to create a process with a certain token\n\n  - Se AssignPrimaryToken – to create a process as a certain user\n\nFollowing is an example of the tool being used, whereas the CMD window is activated under the Local\nService permissions, and through a command that activates “Juicy Potato” another CMD is opened,\nnow with System permissions[7]:\n\nThe tool is downloaded from the command-and-control server used by the attackers in this campaign\n– 95.211.215[.]255. This file is 64-bit system compatible, and this in contrast with the one used in 2017\nand fitted to 32-bit systems. The file is downloaded to the computer under the title “psexec.exe”, while\nat the C2 server it’s called “j.exe” and found at the following address: hxxp://95.211.215[.]225/upd/j.exe.\n\nThis URL address leads to downloading a file name “JuicyPotato.exe” and sometimes “jp.exe” – both\nare versions of this tool.\n\n6 github.com/ohpe/juicy-potato\n7 hunter2.gitbook.io/darthsidious/privilege-escalation/juicy-potato\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nIn several versions of this file there is an embedded evasion technique through which the tool identifies\nvirtual machines and doesn’t activate. The “CPUID trick” artifact, used to identify virtual machines and\nperform an anti-VM trick, appears in the file downloaded to the computer:\n\n###### 4.2.2 “Procdump” and “Mimikatz” MITRE ATT&CK Tactic: Credential Access (TA0006) MITRE ATT&CK Technique: Credential Dumping (T1003) MITRE ATT&CK Tool: Mimikatz (S0002)\n\nDuring this process, users’ credentials are stolen from the Lsass.exe process using ProcDump and\nMimikatz. In order to perform this process, the attacker needs to have admin permissions on the target\ncomputer.\n\nIn this attack scenario, after gaining initial access to the computer, ProcDump, a legitimate Microsoft\ntool that dumps the Lsass.exe process, is run. This tool is not identified by anti-virus solutions, unlike\nMimikatz.\n\nFollowing is an example of using this command as a local user (also executable remotely):\n\nC:\\procdump.exe -accepteula -ma lsass.exe lsass.dmp\n\nAt this point, a dump file of Lsass.exe which contains the relevant credentials, is produced. The file is\npassed to Mimikatz for further extraction – an action which requires local admin privileges.\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n###### 4.2.3 “Sticky Keys” and Other Accessibility Tools’ Settings\n\n MITRE ATT&CK Tactic: Privilege Escalation (TA0004)\n\nAfter getting the passwords in the previous stage, the attackers created another mechanism to gain\nlocal admin permissions on target station.\n\nAnother tool used by the attackers is abuse of the settings of the “sticky keys” accessibility tool. First,\nthe attackers delete the “sticky keys” file – sethc.exe – from the computer. Next, they copy the local\nadmin’s CMD file and switched it with the “sticky keys” process. As a result, when a user connects to\nthe infected station via RDP and presses five times on a sticky key, for example “Shift”, a high-privileged\nShell will be run at the station[8].\n\ncopy /y C:\\windows\\system32\\cmd.exe C:\\windows\\system32\\sethc.exe\n\n###### 4.2.4 Local Admin User MITRE ATT&CK Tactic: Persistence (TA0003) MITRE ATT&CK Technique: Create Account (T1136)\n\nDuring analysis, we found that the attackers created a special local admin user at the infected stations.\nThis move allows the attackers to maintain high permissions at the station even if the password of the\nstation owner’s main user will be changed.\n\n##### 4.3 Lateral Movement Tools\n\nAfter establishing foothold, finding credentials, and acquiring high permissions, the attackers started\nperforming lateral movement in the target network. In this part of the report we will elaborate on three\nprevalent tools used by the attackers at this stage. The tools are used to map servers and open ports,\nperform specialized scan for servers and predefined ports, and also perform “pass the hash” attacks.\n\n###### 4.3.1 “STSRCheck” MITRE ATT&CK Tactic: Discovery (TA0007) MITRE ATT&CK Technique: Network Service Scanning (T1046)\nWhile building the campaign, the attackers have individually developed a tool for databases, servers,\nand open ports’ mapping in the targeted network. The tool is called “STSRCheck” and it can evaluate\nthe possibility to access different IP addresses over the following protocols:\n\n  - SSH – port 22\n\n  - Telnet – port 23\n\n  - SMB – port 445\n\n  - RDP – port 3389\n\n  - HTTP – port 80\n\n8 thewindowsclub.com/sticky-keys-backdoor-scanner\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n  - MySQL and MsSQL – ports 3306 and 1433, respectively\n\nAfter the mapping is done, the tool will try to brute-force the usernames and passwords of the targets.\nThe tool will try by default to log in using generic usernames, like Root or Administrator, combined with\ncommon passwords. The tool also accepts additional list of credentials.\n\n###### 4.3.2 “PORT.EXE” MITRE ATT&CK Tactic: Discovery (TA0007) MITRE ATT&CK Technique: Network Service Scanning (T1046)\nThe “port.exe” tool is a short piece of code written by the attackers to scan servers and predefined\nports. The tool accepts an input of a server address and a port for scanning, checks whether the port is\nopen on this server, and return an answer. Unlike STSRCheck, the tool allows to define any port to be\nscanned.\n\nLike other files in this infrastructure, it is possible that the file was prepared and deployed already back\nin 2017, this according to the file’s time date stamp, which could have been edited by the attackers.\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nAnother characteristic that can be learned by examining this file is the “Copyright 2017” stamp,\ncommon among the group’s self-developed files:\n\nOther files in this infrastructure, used by the attackers in the second wave of attacks, in late 2019, also\nhave this stamp.\n\nIn 2017, Iran has attacked, through the APT34 espionage group, a large number of Israeli companies\nand organizations, most of them in the IT sector. ClearSky revealed in 2017 the campaign’s activity in\nIsrael, which included attempts to breach Israeli IT companies by impersonating Juniper VPN,\ninstalling a backdoor at the company, and exfiltrating files[9]. In parallel, the Israeli CERT has published\nadditional indicators of this infrastructure, from which it can be learned about exploitation of VPN\nvulnerabilities and targets that we identified in the Fox Kitten campaign as well[10]. Recently, we also\nidentified a reactivation of some of the indicators from the 2017 campaign.\n\n###### 4.3.3 “Invoke the Hash” MITRE ATT&CK Tactic: Lateral Movement (TA0008) MITRE ATT&CK Technique: Pass the Hash (T1075)\n\nThe attackers performed pass-the-hash attacks, using an open-source tool found on GitHub, called\n“Invoke the Hash”[11]. The tool contains several PowerShell commands designed to perform pass-thehash attacks in WMI and SMB tasks through .NET TCPCLient. This action is carried out when the\nattacker successfully bypasses the NT Lan Manager (NTLM) and connects to the system without having\n\n9 clearskysec.com/oilrig/\n10 gov.il/BlobFolder/reports/attack_il/en/CERT-IL%20Incident%20report%20-%20Phishing%20attempts.pdf\n11 github.com/Kevin-Robertson/Invoke-TheHash\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\naccess to the target’s passwords in clear text. This package does not require local administrator\nprivilege on target station.\n\nThis package is not downloaded directly from GitHub, but rather downloaded through the VBS files\npresented at the beginning of the chapter. After that, PowerShell commands are run in order to gain\naccess to WMI and SMB on another computer on the network.\n\nFollowing is a screenshot form the package’s GitHub page, running the Invoke-SMBclient module[12]:\n\n##### 4.4 Backdoor Installation and C&C Communication Tools\n\nAfter the attackers gained access to the target computers and in parallel to the lateral movement, they\nstarted leaking files from the attacked systems back to their own computers. Our understanding is that\nthis is the goal of the campaign – information theft, and this even though the campaign possibly\ncooperated with APT33, known for its destructive malware-spreading capabilities, which we didn’t\nidentify in this campaign.\n\nIn this chapter we will review several tools used to leak the information and communicate with the\ntargeted computers. This stage’s main concept is establishing the ability to connect, through RDP, to\nthe target company, categorizing relevant files either by looking at them online or through file name\nlists, and then exfiltrating them to the attacker in different ways. Note, that the tools and techniques\nchanged between different attacks, and therefore this chapter lists them, again, not necessarily in\nchronological order.\n\nThe following scheme represents the different ways for the attackers to connect to the targets:\n\n12 github.com/Kevin-Robertson/Invoke-TheHash\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nReverse Proxy / SSH\n\nForwarding\n\n\nSocket\n\n\nNgrok\n\n\nBackdoor - RDP over\nServeo\n\nInfiltrate Network SSH with malware\n\nExfiltration channel C&C\n\nWebshells\n\nLocal IIS\n\nLocal Webshell via\n\nIIS\n\nVirtual Directory in\n\nIIS\n\n###### 4.4.1 “POWSSHNET” MITRE ATT&CK Tactic: Lateral Movement, Credential Access (TA0008, TA0006) MITRE ATT&CK Technique: Remote Services, Remote Desktop Protocol, Credentials in Files (T1021, T1076, T1081)\n“Backdoor POWSSHNET -RDP over SSH Tunneling” is a self-developed tool used by the attackers to\nopen an SSH tunneling through an executable that allows RDP connection to the computer. Most of\nthe files used in the campaign are PE EXE files. The use of those files is divided into two periods: in 2017\nthe attackers used files for 32-bit systems, while in 2019 they used files for 64-bit systems. It should be\nnoted that this kind of files is very rarely identified by the different anti-virus engines. Thus, the files\nrelevant to the 2017 attacks are completely unidentified as infect by Virus Total; the files used in 2019\nare identified only by a few AV companies.\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\nVirtual Directory in\n\nIIS\n\n\nRDP over SSH\n\nTunneling\n\n\nFRP\n\n\nC&C\n\n\nInfiltrate Network\n\n\nRDP over SSH\n\nTunneling\n\n\n-----\n\nDuring the attack, the attackers install on target computers an exe file that is named differently, while\nthe naming mainly has the term “SSH”. Several examples of the files’ naming: Svchosts.exe, Sshnet.exe,\nSsh2.exe, Isaa.exe, cssrss.exe.\n\nThose malwares have the following PDB path:\n\nC:\\Users\\Administrator\\Desktop\\sshnet\\sshnet\\obj\\Release\\sshnet.pdb\n\nThose files share some common characteristics. First, those files share the same VS version,\nFEEF04BDh, that is otherwise uncommon.\n\nAll the files, both from 2017 and 2019, share the same version that is characterized by a file description\nthat has the word “sshnet” and a copyright for 2017:\n\nThese files are characterized by a global unique identifier (GUID) that is common to most of the infected\nfiles in this infrastructure: $68c4e12f-221f-4580-9631-940208a4306c.\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nWhen the file is run on the attacked computer (after the appropriate credentials are acquired), an SSH\ntunnel will be opened to an SSH server, whose address and authentication credentials are embedded\nin the malware’s source code. It should be noted that in each file there were two different pairs of\nusername and password embedded. Analyzing the files used to attack in Israel, we have found several\nimportant points:\n\n1. The first username used to attempt establish a connection is “Arbab”. This word exists in the\n\nPersian language and means “boss”, “manager”, “lord” or, in a more archaic context, “tribe\nchief”. It should be noted the “Arbab” is also the name of a Saudi VPN operator, and it’s\npossible that it was another target in this campaign.\n2. The first password used in the files repeats itself in all the files in the infrastructure, both from\n\n2017 and 2019. The password is “G654g654!”.\n3. The attacker connects twice – once to a proxy, in order to connect the destination C2 server,\n\nand once again to the C2 itself. These credentials are both hard-coded.\n\nAs it can be seen in the screenshot, the malware connects to the proxy, that was passed by the attacker\nvia the command line while starting a program before the C2 connection. Later, it connects to C2 server\n(redacted for privacy reasons). To connect to the C2 server, a legitimate DLL called Renci.SshNet and\nthe “Idstr” value are used. As can be seen from the source code sample, this action invokes a specific\ncontent from a string found in the metadata. Another meaningful credential is the “VPNADM”\nusername, which is a username used during the connection to the SSH service running on the C2.\nFollowing is a list of processes that occur during the malware’s run and communication with the server:\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nAfter successful installation and connection, the attacker connects by RDP to a user that he/she had\ncreated on the server, collects relevant files (mainly documents), and then compiles and uploads them\nin different ways, also through different webshells.\n\nAdditionally, the attacker can change the code remotely, by using remote procedures (RPC). This can\nbe seen by the string we’ve found in several files:\n\nRPC Control\\ConsoleLPC-0x00000D00--4464068031611364423-1927407092290757144346557972141428712-859675490-1693773642\n\n###### 4.4.2 Socket-based Backdoor for Socket Opening MITRE ATT&CK Tactic: Command and Control (TA0005) MITRE ATT&CK Technique: Uncommonly Used Port (T1065)\nThis is a tool which allows opening sockets and it’s based on several publicly available scripts, modified\nby the group. The attackers use the tool, named “cs.exe” on target network, to create a backdoor as an\nadditional communication channel. As part of the tool’s activity, it allows creating a communication\nchannel based on two-way, connection-based byte streams between to end points. The piece of code\nthat defines the channel’s properties is called “eifHEY”, and with it the type of the socket\n(SocketType.Stream) and the protocol over which the information will be transmitted\n(ProtocolType.Tcp) are defined as well:\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nIn the main function, the hard-coded IP address (95.211.104[.]253) and the port (2255) are defined:\n\nUpon starting a connection with this tool to the C2 server, the “Idstr” value will contain the server’s\naddress:\n\nThe backdoor is identified by 39 Anti-Virus engines:\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nAdditionally, we’ve identified several files connected to this backdoor, called\n“ConsoleApplication5.exe”, and establishing a connection with the same server at 95.211.104[.]253.\nThe PDB route of the files is:\n\nC:\\users\\administrator\\documents\\visual studio\n2015\\Projects\\ConsoleApplication5\\ConsoleApplication5\\obj\\Release\\ConsoleApplication5.pdb\n\n###### 4.4.3 “Servo”, “Ngrok”, and “FRP” MITRE ATT&CK Tactic: Command And Control, Defense Evasion (TA0011, TA0005) MITRE ATT&CK Technique: Connection Proxy (T1090)\nDuring analysis, we have identified three public tools used as reverse proxy/SSH forwarding by the\nattackers – Ngrok, Servo, and FRP.\n\nNgrok\n\nNgrok is a publicly available tool that allows a free, secure connection between the corporate\nnetwork’s localhost and the internet[13]. Using Ngrok, the attacker can securely exfiltrate any file present\non the corporate network, including those that the attacker created him/herself. The attacker can\nconnect to the target station with RDP, activate a webshell, for example, and remotely access files that\nare not supposed to be exposed. In parallel, the attacker can monitor any HTTP connection attempt\nto Ngrok’s address and see its exposure to the outside world. Moreover, the attacker can create\ndomains even for services that don’t use HTTP, e.g. SSH tunneling, which can be useful for the\noperation of the tools discussed earlier. An example of this tool being used is the IP address\n18.211.150[.]202, operated by Amazon and used by the Iranians for this campaign.\n\n13 ngrok.com/\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nServeo\n\nServeo is a free tool for opening outside-facing servers and applications on a corporate network[14],\nwhether on localhost or elsewhere. Unlike Ngrok, Serveo is an SSH-only server; also, any port that will\nbe defined to it (safe for 22, 80, and 443 which are accessible from outside) will get another, unassigned\nTCP port instead. Using this service, the attacker was operating different services inside the network.\nThus, for instance, the attacker had operated an RDP connection through the localhost on port 3389\n(RDP); using Serveo, the attacker has opened this RDP for the outside world through port 12618 (TCP).\nThe attacker has opened an SSH tunneling to another port in order to maintain an encrypted RDP on\nthe attacked target.\n\nMoreover, like with the backdoor that had hardcoded and predefined credentials, here too the attacker\nseparated every server that was opened to the outside world. In the example above (whereas the\noriginal credentials were omitted), the attacker had created a personal user in Serveo for a specific\nserver.\n\nFRP\n\nFast Reverse Proxy (FRP)[15] is a method for revealing servers behind NAT or a firewall to the outside\nworld. To bypass it, the attacker uses the company’s original proxy and from there goes out.\n\n###### 4.4.4 Internal and External Webshells MITRE ATT&CK Tactic: Persistence, Command And Control (TA0008, TA0011) MITRE ATT&CK Technique: WebShell, Connection Proxy, Remote Services (T1100, T1090, T1021)\nThe attacker used a variety of methods to maintain his/her access to the numerous servers inside the\ntargeted organization. This access allowed the attacker to continue establishing the foothold in the\norganization and exfiltrate stolen files. These actions were carried out, amongst other things, through\nwebshells of two kinds:\n\n  - A webshell inside the organization accessible to the network.\n\n  - An external webshell where files can be uploaded to.\n\nLocal IIS webshells and virtual directory\n\nUpon breaching the network, the attacker creates a webshell using IIS on a server to which the attacker\ngot the permissions. The webshell is either downloaded directly, using aspx files, some of which the\nattacker finds on the internet, or using a self-developed webshell, hidden under other file extensions,\ne.g. .gif or .jpg.\n\nOne of the webshell files was uploaded to Virus Total from Iran on November 27[th], 2019, close to the\npeak of attacks against Israeli companies. This file, called warn.aspx, contains a form that will be\nestablished in the company and will allow CMD run inside the corporate network. The script allowing\n\n14 serveo.net/\n15 github.com/fatedier/frp\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nit is written in C. This file will be part of the applications used by the attacker, through IIS, on the client\nside:\n\nAnother file was written in Jscript and contains evidence of using base64 encoding (note the\n“admin@123” user):\n\nFor reasons unclear to us at this time, we have found the attackers executing a process focused on\nnumerous servers on the company’s internal network. First, the attackers created a webshell through\nIIS exposed to the world. Parallelly, they created a virtual directory on another server to which they also\nhad access. In this directory the attackers installed the aspx file. Thus, when the attackers wanted to\ncommunicate with another server sitting on the same corporate LAN, they could do this using one\nwebshell. Following is a scheme of this action:\n\nExfiltration channel – communicating with the C2 server\n\nWe have found open directories, exposed through port 80 to the outside world on external servers used\nthroughout the campaign.\n\nOn one of the PHP files we have found a form that allows to upload files directly to the server\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nIn the attack scenarios discovered by us, four C2 servers were used. Each server has four open ports –\n80, 443, and 22 (OpenSSH). The address of the chosen server was hardcoded in the malware’s source\ncode and the connection to it was performed using methods elaborated earlier. It appears that only in\nsingular cases the same server was reused. The servers active throughout the October 2019 attacks\nwere of the Apache type. Every such server got a separate and server-specific key.\n\nIn 2017, the APT34 group attacked several IT companies in Israel, similar to the targeting in this\ncampaign. In order to perform the initial infection of the company, the group has used the CVE-20170199 vulnerability to salvage and HTA script from an RTF file.\n\nUsing a tool called “rtfdump”, we have analyzed the aforementioned file, in order to understand\nwhether there are OLE actions, for instance, which could allow the activation of the vulnerability.\n\nAs can be seen from the output, those components were not used. However, in Level 3, under the\nGenerator title, there is data that can be salvaged and describes the file’s version and language:\n\n{\\*\\generator LibreOffice/5.0.6.2\nLibreOffice_project/00m02}{\\info{\\creatim\\yr2017\\mo3\\dy27\\hr14\\min10\n\nAs one can see, the file exists since March 27[th], 2017, close to the APT34 attacks in Israel using RTF files.\nAlso, the file’s language is “Arabic – Saudi Arabia”:\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n###### 4.4.5 Archives (WinRAR or 7-zip) MITRE ATT&CK Tactic: Exfiltration (TA0010) MITRE ATT&CK Technique: Data Compressed (T1002)\nDuring our analysis of the different targets, we have seen that the attackers are manually sifting the\nrelevant intelligence before sending it back to Iran. After marking all the desired files, the material will\nbe compressed into WinRAR or 7-ZIP files, and only then will be sent to the attackers.\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n#### 5. Attribution to Iranian APT Groups \n\nThe Fox Kitten campaign is a continuous campaign operated, with high probability, by statesponsored Iranian APT groups whose purpose is espionage against numerous companies mainly in\nthe sectors of IT, defense, electricity, oil and gas and aviation companies.\n\nThis campaign was operated against companies in Israel, USA, Saudi Arabia, Lebanon, Kuwait, UAE,\nAustralia, France, Poland, Germany, Finland, Hungary, Italy and Austria, in two main attack waves.\nFollowing is a map that summarizes the countries where we have identified the targets of the\ncampaign. The main targets, where we saw high activity, are marked with red (Israel, US, and the Gulf\ncountries), while the rest are marked with orange.\n\nThe attribution of the campaign to Iranian offensive groups is based on several characteristics,\nincluding reuse of an Iranian attack infrastructure, parts of which were revealed and marked in the\npast; based on previous intelligence reports; strings in Persian found in code pieces.\n\nDuring our analysis, we have identified, with medium-high confidence, connections to the APT34\ngroup, also called OilRig, based on overlaps with an offensive infrastructure from 2017, widespread use\nof webshells, and similar victim profile.\n\nThrough cooperation with Dragos, we have identified, with medium confidence, a connection between\nthis campaign and the Iranian attack group APT33, also called Elfin. We didn’t identify destructive\nmalware in this campaign. Also, in this campaign, similar to the Dustman[16] malware event, which is\nconsidered a variant of the ZeroCleare[17] destructive malware, vulnerabilities were exploited in VPN\nservices such as Pulse Secure Connect, Fortinet VPN, and Palo Alto Networks’ Global Protect. IBM has\nattributed the ZeroCleare distribution campaign to APT34 with an additional Iranian group known for\n\n16 zdnet.com/article/new-iranian-data-wiper-malware-hits-bapco-bahrains-national-oil-company/\n17 ibm.com/downloads/cas/OAJ4VZNJ\nscribd.com/document/442225568/Saudi-Arabia-CNA-report\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nCAN capabilities, and we assess that this means APT33. We have also found an overlap, with medium\nconfidence and based on the MITRE ATT&CK model, between the Fox Kitten campaign and the TTPs\nof APT39, also called Chafer, which is a sub-group of APT34.\n\nIn this chapter, we will try to propose explanations to our assessment regards the Iranian groups’\nstanding behind this infrastructure.\n\nThe connection to APT34:\n\nThe first wave of attacks in the Fox Kitten campaign took place in November-December 2017, while the\nsecond wave took place in October 2019. The Iranian offensive group APT34 (aka OilRig and\nHelixKitten) has attacked in recent years companies in the IT, oil and gas, aviation, and security sectors,\nwhile companies from the same sectors were attack in the Fox Kitten campaign as well. In the\nwidespread campaign of 2017, the group has tried to breach a group of Israeli IT companies[18].\nMoreover, in the campaign that we have revealed there is a reuse of a small part of the attack\ninfrastructures used by the group in 2017. Several companies which were attacked in the 2017\ncampaign, were attacked again in this campaign.\n\nAnother characteristic – while not indicative in itself – is the widespread use of webshells, which fits\nthe group’s past TTPs. In April-May 2019, a number of webshells belonging to OilRig were revealed\nthroughout the Middle East, most of which against companies in the Gulf and in Israel – in Israel, a\nwebshell-based attack was revealed in one of the country’s leading universities, while in the Gulf\nseveral webshells were found in aviation companies and ministries[19].\n\nThe connection to APT33:\n\nDragos, in a report from January 12[th], 2020, revealed that this campaign, which they call “Parisite”, was\ndesigned, amongst other things, to attack American electricity companies shortly after the demise of\nQassem Soleimani[20]. Dragos researchers mentioned a connection that they have found between the\n“Parisite” campaign and the APT33 group, and emphasized the focus on IT companies, in a similar way\nwe did in our research in Israel. In our research we found overlaps between some of the files used in\nthe “Parisite” campaign and the files and tools used in the “Fox Kitten” campaign.\n\nCooperation between Iranian groups:\n\nIn this part, we will try to explain the connection between the APT34-APT33 cooperation and the “Fox\nKitten” campaign. In January 2020, IBM and the Saudi National Cybersecurity Authority published\nreports on destructive malwares called “ZeroCleare” and “Dustman”, which were spread in the Middle\nEast and specifically in the Gulf. These malwares resemble the APT33-attributed Shamoon malware. In\nIBM’s report it was mentioned that the attack was divided into two main parts – breach and access to\nthe network be APT34, and then distribution of a destructive capability by another Iranian group, which\nwe assess to be APT33. In the Saudi NCA report, it was mentioned that “Dustman” was initially\ndistributed by exploiting VPN vulnerabilities. Judging from the report’s recommendations regards the\nproducts of Palo Alto, Pulse Secure, and Fortinet, it can be inferred that, like in the “Fox Kitten”\ncampaign, in the campaign revealed in the Gulf similar vulnerabilities were exploited.\n\n18 clearskysec.com/oilrig/\n19 misterch0c.blogspot.com/2019/04/apt34-oilrig-leak.html\n20 https://www.wired.com/story/iran-apt33-us-electric-grid/\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\nThe cooperation between the groups, revealed in the IBM report, the VPN vulnerabilities’ exploitation,\nand the overlap between files used in the “Parisite” campaign and “Fox Kitten” campaign lead us to\nassess, with medium confidence, that the groups used a similar infrastructure in this campaign as well.\n\nThe connection to APT39:\n\nDuring analysis, we have found, with medium confidence, a connection between “Fox Kitten” and the\nAPT39 group, also called Chafer and considered a sub-group of APT34. This connection is based on a\ncertain overlap in the tools and work methods used, based on the MITRE ATT&CK model, and based\non 2018-2019 reports by FireEye and Symantec[21]. The most apparent overlap in methods includes the\nuse of stolen VPN credentials, lateral movement through RDP, and exfiltration based on file\ncompression in ZIP or RAR formats (T1003, T1046, T1090, T1094, T1076, T1002).\n\nIn conclusion, we attribute the “Fox Kitten” campaign, with medium-high confidence, to the APT34\ngroup, and with medium confidence to the APT33 and APT39 groups, and we assess that there is a\ncooperation between the groups in infrastructure and possible beyond that. We assess this campaign’s\nmain goal to be intelligence collection on the targets and creating a supply-chain attack. In our\nanalysis, we have not identified distribution of destructive malware in the attacked organizations.\n\n21 fireeye.com/blog/threat-research/2019/01/apt39-iranian-cyber-espionage-group-focused-on-personalinformation.html\nsymantec.com/blogs/threat-intelligence/chafer-latest-attacks-reveal-heightened-ambitions\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n#### 6. Insights and Recommendations\n\nThe Attackers\n\n  - The Iranian offensive establishment has reached the level of knowledge and flexibility which\nallows it to use “Day 1” malware, i.e. development and distribution of malware using revealed\nvulnerabilities, in a period of hours to days since their publication.\n\n  - The Iranians understand that a direct attack on defense systems is difficult, while infiltration\nusing VPN systems that bring you directly to the target’s core systems is much more cost\neffective.\n\n  - This report reveals a strong connection to two groups that were analyzed until today as\nseparate units. In recent months, several reports dealing with tool common to APT34 and\nAPT33 were published, while this report exemplifies the cooperation between the two as one\nbig espionage establishment. We know that both groups work in many tracks – infection and\nsocial engineering, reconnaissance and espionage, and even sabotage, while emphasizing\neach group’s specialty. We assess such recon campaigns to be convertible to disseminate\ndestructive attacks after studying the target organization, similar to the “ZeroCleare” events in\nthe Gulf.\n\nThe Attack Infrastructure\n\n  - VPN systems which allow remote access to corporate systems comprise a significant risk,\nbecause they essentially bypass all defense systems deployed vis-à-vis the internet. Review\nand assessment are needed to understand whether the systems are controlled and monitored\ncompletely by the organization.\n\n  - The timeframe given to install a security patch after the vulnerability has been published has\nshortened and we assess it to be between 24 hours and a week between the vulnerability’s\npublication and the moment it becomes a real threat for the organization.\n\n  - Checking outward facing systems, including different VPN systems, is critically important for\nthe company. There is a need of constant monitoring, making sure that the systems are\nconstantly updated, and preventing unneeded exposure of the administration interfaces to\nthe outside world. We also assess that there is a need to try and minimize the systems to the\nbare minimum. Recheck of security updates to VPN systems is to be routinely preformed as\nwell.\n\n  - After each update performed on core corporate systems, including VPN systems, it is\nrecommended to reset all password to all end users in the organization and to oblige all users\nto re-connect to the services, in order to identify unwanted connections. Additionally, if it is\npossible, it is recommended to create a two-step authentication to the corporate core\nsystems.\n\n  - It is recommended to use VPN services that keep logs on a different media (preferably nonerasable) during communication.\n\n  - Users’ permissions and active users on each station should be monitored constantly. In this\ncampaign, the attackers have created, multiple times, local users that allowed them to act\nfreely.\n\n###### • The attack infrastructure attached to this report should be monitored and blocked.\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n#### 7. Indicators\n\n##### Hashes\n\nMD5 Description Uploads to Virus Initial upload\n\nTotal from date to Virus\n\nsignificant Total\n\ncountries\n\nExploit\n\n364F57928FC5FB0019B73F3FBD57F99B STSRCHECK - Self-Development - Port and DB Scanner + Brute\nForce tool\n\nWebshell\n\n0F7D3D33D7235B13D0FAC4329E0D2420 Webshell – ASPX file (cmd.aspx) IR 27/11/18\n\n41CDA77C69614A0FBFCC4A38EBAE659B Webshell – ASPX files\n\n6FEA7A30B2BD6014C1B15DEFE8963273\n\n6FEA7A30B2BD6014C1B15DEFE8963273\n\n6FEA7A30B2BD6014C1B15DEFE8963273\n\n9DC9BBD0C6B0A946489CCD8793D22F28 Webshell – GIF file - \nExecution\n\nac9993f1124d404a08531df9a0ae28c9 Combine.bat - \n95ee534f32f305a895a1842898a4880e HEX in TXT - \n62de35201acc8833e04221d9343e73e0\n\n7819bf37930edcdbb74b0535bc12558c\n\n06d882d4c601a086f3b0f13d5f756830\n\n5def1ab33ddf4455aaf8b7b70ad69e04\n\n3741f987c9bd14263ffb4824dce8c147 Down VBS - \n62de35201acc8833e04221d9343e73e0\n\n5c9d14c8eef4e9b8c0b4bd0d28c5a77a\n\n94a47463e0b8d52aec5e90a5177e0a9b V VBS\n\n54603feea3c4f3585011a5940c2f6b6f\n\n3587cabf61366a7b5f0ba0d63d009b36\n\nf9103618c1b86e073b89ce28ba2679cc\n\na84549691a492ad081bf177b6c4518b0 Juicy Potato - Local Privilege IL 07/10/19\n\nEscalation tool\n\n808502752ca0492aca995e9b620d507b\n\n5C67064F8FD83FDCCEAB49728495C3F4 LPManager (Schtask)\n\n01a9293fb10985204a4278006796ea3f Port.exe ZZ 14/12/2017\n\nInvoke the Hash\n\nA87D59456F323BD373CB958273DFE8BB Invoke-SMBClient.ps1\n\nB4FCB52673089CAF3E6E76379F2604D8 Invoke-SMBEnum.ps1\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n|7. Indicators Hashes|Col2|Col3|Col4|\n|---|---|---|---|\n|MD5|Description|Uploads to Virus Total from significant countries|Initial upload date to Virus Total|\n|Exploit||||\n|364F57928FC5FB0019B73F3FBD57F99B|STSRCHECK - Self-Development Port and DB Scanner + Brute Force tool|-|-|\n|Webshell||||\n|0F7D3D33D7235B13D0FAC4329E0D2420|Webshell – ASPX file (cmd.aspx)|IR|27/11/18|\n|41CDA77C69614A0FBFCC4A38EBAE659B 6FEA7A30B2BD6014C1B15DEFE8963273 6FEA7A30B2BD6014C1B15DEFE8963273 6FEA7A30B2BD6014C1B15DEFE8963273|Webshell – ASPX files|||\n|9DC9BBD0C6B0A946489CCD8793D22F28|Webshell – GIF file|-|-|\n|Execution||||\n|ac9993f1124d404a08531df9a0ae28c9|Combine.bat|-|-|\n|95ee534f32f305a895a1842898a4880e 62de35201acc8833e04221d9343e73e0 7819bf37930edcdbb74b0535bc12558c 06d882d4c601a086f3b0f13d5f756830 5def1ab33ddf4455aaf8b7b70ad69e04|HEX in TXT|-|-|\n|3741f987c9bd14263ffb4824dce8c147 62de35201acc8833e04221d9343e73e0 5c9d14c8eef4e9b8c0b4bd0d28c5a77a|Down VBS|-|-|\n|94a47463e0b8d52aec5e90a5177e0a9b 54603feea3c4f3585011a5940c2f6b6f 3587cabf61366a7b5f0ba0d63d009b36 f9103618c1b86e073b89ce28ba2679cc|V VBS|||\n|a84549691a492ad081bf177b6c4518b0 808502752ca0492aca995e9b620d507b|Juicy Potato - Local Privilege Escalation tool|IL|07/10/19|\n|5C67064F8FD83FDCCEAB49728495C3F4|LPManager (Schtask)|||\n|01a9293fb10985204a4278006796ea3f|Port.exe|ZZ|14/12/2017|\n|Invoke the Hash||||\n|A87D59456F323BD373CB958273DFE8BB|Invoke-SMBClient.ps1|||\n|B4FCB52673089CAF3E6E76379F2604D8|Invoke-SMBEnum.ps1|||\n\n\n-----\n\n|MD5|Description|Uploads to Virus Total from significant countries|Initial upload date to Virus Total|\n|---|---|---|---|\n|31B431DF84EAF71848C8B172C40124EC|Invoke-SMBExec.ps1|||\n|0C4DB17ED145310F336AB4887914F80C|Invoke-TheHash.ps1|||\n|836D61745E087E6017832233701218A4|Invoke-TheHash.psd1|||\n|54AF54C9E0AA4B26C4BE803C44C5F473|Invoke-TheHash.psm1|||\n|B63DE834AB7CC8FCD0E71003C6786213|Invoke-WMIExec.ps1|||\n|Backdoor||||\n|783dc28185837c8e66dca34e9a519c7c|RDP over SSH (SSHNET) Backdoor|IL|03/10/19|\n|29fb089328e78f67ff86739583a9e63a|RDP over SSH (SSHNET) Backdoor|US IL|11/12/17|\n|f064ff619ebf67a59566c0dd54c5d05c|RDP over SSH (SSHNET) Backdoor|ZZ US Zero detections|14/12/17|\n|475f89de6031db2158231eafa07b8b72|SOCKET-Based Backdoor (cs.exe)|NL US|11/12/17|\n|cfcbb6472cac07ea138379578d80845b 155837e476b50c93b6522b310a684a33 cb84fc4682a74ba81ef477bc1359959b|Console Application Backdoor|ZZ IL|14/12/17|\n\n\n##### IP Addresses\n\nIP ASN Type\n\nNot Unique – Non-Malicious\n\n18.221.150[.]202 AS 16509 (Amazon.com, Inc.) Ngrok\n\n185.32.178[.]176 AS 21450 (HOT Mobile Ltd.) Webshell\n\nUnique – Malicious IP\n\n93.177.75[.]180 AS 9009 (M247 Ltd) C&C Rotten Fish\n\n95.211.210[.]55 AS 60781 (LeaseWeb C&C RDP over SSH\n\nNetherlands B.V.) Backdoor - 2017\n\n95.211.213[.]168\n\n95.211.215.[.]226\n\n95.211.213[.]177\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n|dresses|Col2|Col3|\n|---|---|---|\n|IP|ASN|Type|\n|Not Unique – Non-Malicious|||\n|18.221.150[.]202|AS 16509 (Amazon.com, Inc.)|Ngrok|\n|185.32.178[.]176|AS 21450 (HOT Mobile Ltd.)|Webshell|\n|Unique – Malicious IP|||\n|93.177.75[.]180|AS 9009 (M247 Ltd)|C&C Rotten Fish|\n|95.211.210[.]55 95.211.213[.]168 95.211.215.[.]226 95.211.213[.]177|AS 60781 (LeaseWeb Netherlands B.V.)|C&C RDP over SSH Backdoor - 2017|\n\n\n-----\n\n|95.211.104[.]253|AS 60781 (LeaseWeb Netherlands B.V.)|C&C communication SOCKET|\n|---|---|---|\n\n\n##### GUID ID\n\n$6f1aaf94-fa2e-4768-afdb-cde8944498a4\n\n$68c4e12f-221f-4580-9631-940208a4306c\n\n##### Mutex\n\n@ANIqnNScCaIQ\n\n@SISqnq\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n-----\n\n### ClearSky Cyber Intelligence Report\n\n\n____________________________________________________________________________________________________\n[©All rights reserved to ClearSky Cyber Security ltd. www.clearskysec.com](http://www.clearskysec.com/)\n\n\n2020 All rights reserved to ClearSky Security Ltd.\n\nTLP: White\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.clearskysec.com/wp-content/uploads/2020/02/ClearSky-Fox-Kitten-Campaign.pdf"
    ],
    "report_names": [
        "ClearSky-Fox-Kitten-Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "ce10c1bd-4467-45f9-af83-28fc88e35ca4",
            "created_at": "2022-10-25T15:50:23.458833Z",
            "updated_at": "2025-03-27T02:00:55.475188Z",
            "deleted_at": null,
            "main_name": "APT34",
            "aliases": null,
            "source_name": "MITRE:APT34",
            "tools": [
                "netstat",
                "Systeminfo",
                "PsExec",
                "SEASHARPEE",
                "Tasklist",
                "Mimikatz",
                "POWRUNER",
                "certutil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d070e12b-e1ce-4d8d-b5e3-bc71960cc0cb",
            "created_at": "2022-10-25T15:50:23.676504Z",
            "updated_at": "2025-03-27T02:00:55.521901Z",
            "deleted_at": null,
            "main_name": "Fox Kitten",
            "aliases": [
                "Fox Kitten",
                "UNC757",
                "Parisite",
                "Pioneer Kitten",
                "RUBIDIUM",
                "Lemon Sandstorm"
            ],
            "source_name": "MITRE:Fox Kitten",
            "tools": [
                "China Chopper",
                "Pay2Key",
                "ngrok",
                "PsExec",
                "Ngrok"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "bee22874-f90e-410b-93f3-a2f9b1c2e695",
            "created_at": "2022-10-25T16:07:23.45097Z",
            "updated_at": "2025-03-27T02:02:09.808919Z",
            "deleted_at": null,
            "main_name": "Chafer",
            "aliases": [
                "APT 39",
                "Cobalt Hickman",
                "ITG07",
                "Radio Serpens",
                "Remix Kitten",
                "TA454"
            ],
            "source_name": "ETDA:Chafer",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Antak",
                "CACHEMONEY",
                "EternalBlue",
                "HTTPTunnel",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MechaFlounder",
                "Metasploit",
                "Mimikatz",
                "NBTscan",
                "NSSM",
                "Non-sucking Service Manager",
                "POWBAT",
                "Plink",
                "PuTTY Link",
                "Rana",
                "Remcom",
                "Remexi",
                "RemoteCommandExecution",
                "SafetyKatz",
                "UltraVNC",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "nbtscan",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2c348851-5036-406b-b2d1-1ca47cfc7523",
            "created_at": "2022-10-25T16:07:24.039861Z",
            "updated_at": "2025-03-27T02:02:10.08844Z",
            "deleted_at": null,
            "main_name": "Parisite",
            "aliases": [
                "Cobalt Foxglove",
                "Fox Kitten",
                "Lemon Sandstorm",
                "Parisite",
                "Pioneer Kitten",
                "Rubidium",
                "UNC757"
            ],
            "source_name": "ETDA:Parisite",
            "tools": [
                "Cobalt",
                "FRP",
                "Fast Reverse Proxy",
                "Invoke the Hash",
                "JuicyPotato",
                "Ngrok",
                "POWSSHNET",
                "Pay2Key",
                "Plink",
                "Port.exe",
                "PuTTY Link",
                "SSHMinion",
                "STSRCheck",
                "Serveo"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "871acc40-6cbf-4c81-8b40-7f783616afbc",
            "created_at": "2023-01-06T13:46:39.156237Z",
            "updated_at": "2025-03-27T02:00:03.010146Z",
            "deleted_at": null,
            "main_name": "Fox Kitten",
            "aliases": [
                "PIONEER KITTEN",
                "PARISITE",
                "UNC757",
                "Lemon Sandstorm",
                "RUBIDIUM"
            ],
            "source_name": "MISPGALAXY:Fox Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b23e717c-0b27-47e0-b3c8-4defe6dd857f",
            "created_at": "2023-01-06T13:46:38.367369Z",
            "updated_at": "2025-03-27T02:00:02.815758Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "ATK35",
                "Peach Sandstorm",
                "TA451",
                "APT 33",
                "Elfin",
                "Refined Kitten",
                "MAGNALLIUM",
                "HOLMIUM",
                "COBALT TRINITY",
                "G0064"
            ],
            "source_name": "MISPGALAXY:APT33",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9fe49a5b-f3e6-4fbf-99a1-db15dad460c3",
            "created_at": "2024-05-01T02:03:08.045004Z",
            "updated_at": "2025-03-27T02:05:17.325038Z",
            "deleted_at": null,
            "main_name": "COBALT TRINITY",
            "aliases": [
                "Elfin ",
                "HOLMIUM ",
                "MAGNALIUM ",
                "Peach Sandstorm ",
                "Refined Kitten ",
                "TA451 ",
                "APT33 "
            ],
            "source_name": "Secureworks:COBALT TRINITY",
            "tools": [
                " Cadlotcorg",
                " Dello RAT",
                " Imminent Monitor",
                " KDALogger",
                " Koadic",
                " NanoCore",
                " NetWire",
                " POWERTON",
                " PoshC2",
                " Poylog",
                " PupyRAT",
                " Schoolbag",
                "AutoCore"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3eebdb3f-f4e3-42e5-bb4d-f02a13328316",
            "created_at": "2024-05-01T02:03:08.014303Z",
            "updated_at": "2025-03-27T02:05:17.306592Z",
            "deleted_at": null,
            "main_name": "COBALT EDGEWATER",
            "aliases": [
                "Cold River ",
                "DNSpionage ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT EDGEWATER",
            "tools": [
                " DNSpionage",
                " Karkoff",
                " MailDropper",
                " SideTwist",
                " TWOTONE",
                "AgentDrable"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1b3a247f-6186-4482-8b92-c3fb2d767c7d",
            "created_at": "2023-01-06T13:46:38.883911Z",
            "updated_at": "2025-03-27T02:00:02.942724Z",
            "deleted_at": null,
            "main_name": "APT39",
            "aliases": [
                "COBALT HICKMAN",
                "G0087",
                "Radio Serpens",
                "TA454",
                "REMIX KITTEN"
            ],
            "source_name": "MISPGALAXY:APT39",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a761f2a6-26ba-47fd-89c3-6a74f847a3b2",
            "created_at": "2024-05-01T02:03:08.025289Z",
            "updated_at": "2025-03-27T02:05:17.312292Z",
            "deleted_at": null,
            "main_name": "COBALT HICKMAN",
            "aliases": [
                "Chafer ",
                "ITG07 ",
                "APT39 "
            ],
            "source_name": "Secureworks:COBALT HICKMAN",
            "tools": [
                " Mimikatz",
                " Remexi",
                " TREKX",
                "MechaFlounder"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b9f25498-8035-483c-871e-01cd45e7317f",
            "created_at": "2024-05-01T02:03:08.020262Z",
            "updated_at": "2025-03-27T02:05:17.309453Z",
            "deleted_at": null,
            "main_name": "COBALT FOXGLOVE",
            "aliases": [
                "Lemon Sandstorm ",
                "Parisite ",
                "Pioneer Kitten ",
                "RUBIDIUM ",
                "UNC757 ",
                "Fox Kitten "
            ],
            "source_name": "Secureworks:COBALT FOXGLOVE",
            "tools": [
                " FRP (Fast Reverse Proxy)",
                " Mimikatz",
                " Ngrok",
                " POWSSHNET",
                " STSRCheck",
                " Servo",
                " n3tw0rm ransomware",
                " pay2key ransomware",
                "Chisel"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e5ff825b-0456-4013-b90a-971b93def74a",
            "created_at": "2022-10-25T15:50:23.824058Z",
            "updated_at": "2025-03-27T02:00:55.553346Z",
            "deleted_at": null,
            "main_name": "APT33",
            "aliases": [
                "APT33",
                "HOLMIUM",
                "Elfin",
                "Peach Sandstorm"
            ],
            "source_name": "MITRE:APT33",
            "tools": [
                "PowerSploit",
                "AutoIt backdoor",
                "PoshC2",
                "Mimikatz",
                "NanoCore",
                "DEADWOOD",
                "StoneDrill",
                "POWERTON",
                "LaZagne",
                "TURNEDUP",
                "NETWIRE",
                "Pupy",
                "ftp",
                "Shamoon"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "6b6155e4-94ec-4909-b908-550afe758ad6",
            "created_at": "2022-10-25T15:50:23.365074Z",
            "updated_at": "2025-03-27T02:00:55.455014Z",
            "deleted_at": null,
            "main_name": "APT39",
            "aliases": [
                "APT39",
                "ITG07",
                "Remix Kitten"
            ],
            "source_name": "MITRE:APT39",
            "tools": [
                "NBTscan",
                "MechaFlounder",
                "Remexi",
                "CrackMapExec",
                "pwdump",
                "Mimikatz",
                "Windows Credential Editor",
                "Cadelspy",
                "PsExec",
                "ASPXSpy",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b938e2e3-3d1b-4b35-a031-ddf25b912557",
            "created_at": "2022-10-25T16:07:23.35582Z",
            "updated_at": "2025-03-27T02:02:09.750954Z",
            "deleted_at": null,
            "main_name": "APT 33",
            "aliases": [
                "APT 33",
                "ATK 35",
                "Cobalt Trinity",
                "Curious Serpens",
                "Elfin",
                "Holmium",
                "Magnallium",
                "Peach Sandstorm",
                "Refined Kitten",
                "TA451",
                "Yellow Orc"
            ],
            "source_name": "ETDA:APT 33",
            "tools": [
                "Atros2.CKPN",
                "AutoIt backdoor",
                "Breut",
                "CinaRAT",
                "DROPSHOT",
                "DarkComet",
                "DarkKomet",
                "DistTrack",
                "EmPyre",
                "EmpireProject",
                "FYNLOS",
                "FalseFont",
                "Filerase",
                "Fynloski",
                "JuicyPotato",
                "Krademok",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "Mimikatz",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "NetWeird",
                "NetWire",
                "NetWire RAT",
                "NetWire RC",
                "NetWired RC",
                "Notestuk",
                "POWERTON",
                "PoshC2",
                "PowerBand",
                "PowerShell Empire",
                "PowerSploit",
                "PsList",
                "Pupy",
                "PupyRAT",
                "Quasar RAT",
                "QuasarRAT",
                "Recam",
                "Remcos",
                "RemcosRAT",
                "Remvio",
                "SHAPESHIFT",
                "Shamoon",
                "Socmer",
                "StoneDrill",
                "TURNEDUP",
                "Tickler",
                "Yggdrasil",
                "Zurten",
                "klovbot",
                "pupy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1582466890,
    "ts_modification_date": 1582466890,
    "files": {
        "pdf": "https://archive.orkl.eu/661bde223c85c5dbd8e47c68e35b6a6c97e657a3.pdf",
        "text": "https://archive.orkl.eu/661bde223c85c5dbd8e47c68e35b6a6c97e657a3.txt",
        "img": "https://archive.orkl.eu/661bde223c85c5dbd8e47c68e35b6a6c97e657a3.jpg"
    }
}