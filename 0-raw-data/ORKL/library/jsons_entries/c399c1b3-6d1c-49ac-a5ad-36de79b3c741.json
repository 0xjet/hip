{
    "id": "c399c1b3-6d1c-49ac-a5ad-36de79b3c741",
    "created_at": "2022-10-25T16:48:21.307065Z",
    "updated_at": "2025-03-27T02:16:58.031083Z",
    "deleted_at": null,
    "sha1_hash": "dc03a067735360acad3b1053e3fb9302e6609192",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-02-17T12:19:01Z",
    "file_modification_date": "2017-02-17T12:19:08Z",
    "file_size": 1551691,
    "plain_text": "# Read The Manual\n\n### A Guide to the RTM Banking Trojan\n\n## Matthieu Faou & Jean-Ian Boutin\n\nFebruary 2017\n\n\n-----\n\n# Read The Manual\n\n### A Guide to the RTM Banking Trojan\n\n## Matthieu Faou & Jean-Ian Boutin\n\nFebruary 2017\n\n\n-----\n\n#### Table of Content\n\n**1. Targets** **5**\n\n**2. Infection vectors** **8**\n\n2.1. Is the malware related to Buhtrap? 9\n\n**3. Evolution** **10**\n\n3.1. Versioning 10\n\n3.2. Timeline 11\n\n**4. Technical analysis** **11**\n\n4.1. Installation and persistence 12\n\n4.3. Network 14\n\n4.4. Fingerprint 17\n\n4.5 Monitoring 19\n\n4.6. Uninstall 20\n\n4.7. Config 21\n\n4.8. Other functions 21\n\n**5. Conclusion** **24**\n\n**6. Indicators of Compromise** **25**\n\n6.1. ESET detection names 25\n\n6.2. File names 25\n\n6.3. Registry indicators 25\n\n6.4. Hashes 25\n\n6.5. C&C server domain names 27\n\n6.6. C&C server IP addresses 27\n\n6.7. PDB paths 27\n\n6.8. Strings 28\n\n**7. Bibliography** **30**\n\n\n-----\n\n#### List of Tables\n\nTable 1 Code-signing certificates used by RTM 10\n\nTable 2 List of botnet prefixes 10\n\nTable 3 Possible values of the action field 16\n\nTable 4 Targeted software 18\n\nTable 5 Targeted URLs 18\n\nTable 6 Identifier for a banking related machine 19\n\nTable 7 Banking windows targeted 19\n\nTable 8 Configuration keys 21\n\n#### List of Figures\n\nFigure 1 RTM telemetry 5\n\nFigure 2 Decoy document used in recent RTM campaigns 6\n\nFigure 3 “1C: Enterprise 8” software export window 7\n\nFigure 4 `1c_to_kl.txt example` 7\n\nFigure 5 Infection vectors timeline 8\n\nigure 6 Code-signing certificate used by both RTM and Buhtrap 9\n\nFigure 7 Timeline of the RTM malware 11\n\nFigure 8 DLL name for sample F4C746696B0F5BB565D445EC49DD912993DE6361 12\n\nFigure 9 Additional step in the RC4 algorithm 13\n\nFigure 10 Encrypted strings structure 14\n\nFigure 11 C&C feed hosted on livejournal 14\n\nFigure 12 C&C requests protocol 15\n\nFigure 13 C&C replies protocol 16\n\nFigure 14 Login page for the RTM panel 17\n\nFigure 15 Cleaning DLL name 20\n\nFigure 16 Configuration values xor key 21\n\nFigure 17 Bogus registry check dialog 22\n\nFigure 18 Fake registry error 23\n\nFigure 19 Actual UAC prompt from Windows 23\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nThere are several groups actively and profitably targeting businesses in Russia. A trend that we have\nseen unfold before our eyes lately is these cybercriminals’ use of simple backdoors to gain a foothold\nin their targets’ networks. Once they have this access, a lot of the work is done manually, slowly\ngetting to understand the network layout and deploying custom tools the criminals can use to steal\nfunds from these entities. Some of the groups that best exemplify these trends are Buhtrap, Cobalt\nand Corkow.\n\nThe group discussed in this white paper is part of this new trend. We call this new group RTM [1];\nit uses custom malware, written in Delphi, that we cover in detail in later sections. The first trace\nof this tool in our telemetry data dates back to late 2015. The group also makes use of several\ndifferent modules that they deploy where appropriate to their targets. They are interested in users\nof remote banking systems (RBS), mainly in Russia and neighboring countries.\n\nIn this paper, we cover the details of their tools, whom they target, and offer a rare glimpse into\nthe type of operation they are carrying out.\n\n#### 1. Targets\n\nThat this group is mostly targeting businesses is apparent from the processes they are looking\nfor on a compromised system. They look for software that is usually only installed on accountants’\ncomputers, such as remote banking software or tools to help with accounts payable. The full list\nof the processes they target is detailed in Section 4.4.2.\n\nWhile both RTM and Buhtrap [2] are looking for a quite similar process list, the infection vectors\nare quite different. While the latter mostly used spear phishing campaigns, this group uses typical\ncrimeware distribution channels such as drive-by downloads and spam. From our telemetry data,\nwe see this threat actor focusing mostly on Russia and neighboring countries, with a few hits\nelsewhere. However, due to the mass spreading mechanism used, seeing detections outside\nthe presumed primary region of interest is not surprising.\n\n**Russia**\n\n**Germany**\n\n**Kazakhstan**\n\n**Ukraine**\n\n**Czech Republic**\n\nFigure 1 RTM telemetry\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nThe total number of detections we have for this threat is low and the complexity of the malware\nis high, indicating that this group is targeting specific, high-value targets in the Russian region.\n\nIn fact, the latest campaigns we have seen using the RTM malware contained interesting decoy\ndocuments as depicted in Figure 2.\n\nFigure 2 Decoy document used in recent RTM campaigns\n\nWe found several types of decoy documents used by this group, such as contracts, invoices or tax-related\nforms. The nature of these decoy documents combined with the type of software targeted by this group\nlead us to believe they are going after accounting departments in Russian firms. These targets were\nalso attacked by the Buhtrap group in 2014-2015.\n\nWhile researching this group, we were able to interact with a few command and control (C&C) servers.\nThe full list of commands that can be received from a C&C server will be covered in the following\nsections, but for now we can say that the client sends keylogger logs directly to the C&C, which\nthen may respond with additional commands.\n\nHowever, the days where you could just connect to the C&C and gather all the interesting interactions\nyou wanted are mostly gone. To receive commands from the server, we had to provide realistic logs.\nWe were rewarded for our efforts by seeing several relevant commands.\n\nThe first one was a request for the bot to hand over a specific file: 1c_to_kl.txt. This file is an export\nfrom popular accounting software called “1C: Enterprise 8” which, conveniently enough, is present\nin the process list that the bot is actively seeking. This software can work in tandem with different\nRemote Banking Systems (RBS) by exporting transfer data to a text file. This text file can then\nbe imported into an RBS to automate the payment order as seen in Figure 3.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nFigure 3 “1C: Enterprise 8” software export window\n\nAs the data in this file contain information about the transfer, it is possible for the fraudsters to modify\nthe information in the file in order to steal money from the victim.\n\nFigure 4 `1c_to_kl.txt example`\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nAbout a month after these files were requested from the C&C server, we saw the apparition\nof a new module: 1c_2_kl.dll. This module was pushed as a plugin to compromised systems\nand has the capacity to parse the export file automatically by injecting itself in the accounting\nsoftware process. This module will be detailed in a later section.\n\nInterestingly, FinCERT, a Russian CERT responsible for fighting cybercrime targeting Russian\nfinancial institutions, issued a statement warning potential victims against criminals going after\n```\n1c_to_kl.txt export files in late 2016. Also, the developers of “1C: Enterprise 8” are already aware\n\n```\nof this scheme and issued a statement [3] acknowledging the problem and enumerating the possible\nprotective measures the user can take to prevent this attack.\n\nWe also saw additional modules being downloaded once the bots reported to the C&C, such as\na VNC module. This VNC module has both a 32 and 64-bits variants and is similar to a VNC module\nalready seen in used in Dridex campaigns. We hypothesize that once the bot installs this VNC module,\nthe criminals will use it to connect to the computer remotely and look around to see what they could\ndo to take full advantage of the system. Organized groups like these usually then try to move laterally\nin the network, recovering account passwords through tools such as mimikatz and using other\noffensive tactics to learn more about the network and make the malware’s presence as persistent\nas possible.\n\n#### 2. Infection vectors\n\nThe following figure shows the different infection vectors’ first-seen date gathered throughout\nour tracking.\n\n#### 2015\n**December 22**\n\n\nBuhtrap Downloader\n\n\nRIG Exploit Kit\n\n\nDouble Extension spam\n\n\nDropBox Link - spam\n\n\nFigure 5 Infection vectors timeline\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nThis group has used a large array of infection vectors, mostly revolving around drive-by downloads\nand spam. These channels are well suited for targeted attacks, since for the former, cybercriminals\ncan pick websites likely to be visited by their targets, and for the latter, send emails with attachments\ndirectly to businesses or individuals the cybercriminals are attacking.\n\nThe fact that their malware is distributed through several different channels – such as the RIG [4]\nand Sundown exploit kits or spam runs – also shows that this group has strong ties with criminals\nin the underground market who are selling these services.\n\n##### 2.1. Is the malware related to Buhtrap?\n\nAs RTM exhibits some operational similarities to what we have seen with Buhtrap, one might\nlegitimately wonder whether they are related.\n\nIn September 2016, we saw an RTM sample being distributed by a Buhtrap downloader. We also\nsaw two code-signing certificates used to sign samples of both Buhtrap and RTM. The first one,\nissued to a company allegedly called TOV DNISTER-M, was used to sign a Delphi second stage\n(SHA-1: 025C718BA31E43DB1B87DC13F94A61A9338C11CE) as well as a Buhtrap DLL\n(SHA-1: 1E2642B454A2C889B6D41116CCDBA83F6F2D4890).\n\nFigure 6 Code-signing certificate used by both RTM and Buhtrap\n\nThe second one, issued to a company allegedly called Bit-Tredj, was used to sign\nBuhtrap downloaders (SHA-1: 7C1B6B1713BD923FC243DFEC80002FE9B93EB292 and\n```\nB74F71560E48488D2153AE2FB51207A0AC206E2B) fetching and installing an RTM payload. \n\n```\nTable 1 highlights key characteristics of these certificates.\n\nAlthough they shared the code-signing certificate with other malware families, they also used one that,\naccording to our telemetry, was used only by them. It was issued to a company allegedly called Kit-SD\nand was used to sign some RTM malware (e.g. SHA-1: 42A4B04446A20993DDAE98B2BE6D5A797376D4B6).\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nTable 1 Code-signing certificates used by RTM\n\n\nCompany Name Validity Period Thumbprint & Serial\n\n\nBit-Tredj 29/05/2016 – 30/05/2017\n\nTOV DNISTER-M 19/04/2016 – 20/04/2017\n\nKit-SD, OOO 21/06/2016 – 22/06/2017\n\n\nThumbprint\n```\n2c14b428c4f5e260db13cff1b6b28d22beb59d7f\n\n```\nSerial\n```\n54460e1fcd612cd3377ac2cd76e4240f\n\n```\nThumbprint\n```\n457880da8899679870ad5b87312d882c006c9559\n\n```\nSerial\n```\n2567a463a84bb9d4207a11ec979205ac\n\n```\nThumbprint\n```\nb79d75191b3c0e3742b42c82e0a40dff9976708a\n\n```\nSerial\n```\n1e21a4adcda618adc7b53193ef4aaf62\n\n```\n\nBecause they used the same Buhtrap downloader, they also shared some network indicators, since\nan RTM payload was downloaded from Buhtrap infrastructure. That said, as RTM has been using\nseveral different ways to distribute their malware besides the Buhtrap downloader, we believe that\nthe groups using these two malware families are not the same. However, they are using a similar\nmodus operandi. They are both targeting businesses using accounting software, are fingerprinting\nsystems of interest similarly, are looking for smart card readers, and finally, they deploy an array\nof malicious tools to spy on their victims.\n\n#### 3. Evolution\n\nIn this section, we will cover the different versions of the malware we have seen during our tracking,\nbut first we need to define a way to follow its evolution.\n\n##### 3.1. Versioning\n\nRTM stores configuration data in registry keys and a particularly interesting piece of information\nis called botnet-prefix. A list of all the values we have seen in the samples we analyzed is presented\nin Table 2.\n\n\nTable 2 List of botnet prefixes\n\n\n0.1.6.4 0.1.6.6 0.1.7.6 0.1.9.0\n\nbit bit2 bit3 hit3\n\nmtr KL2 kosmos main\n\nWe are not sure of the purpose of this value. It may be used to record a version of the malware. However,\nwe observed very few changes between consecutive versions such as bit2 and bit3 or 0.1.6.4 and 0.1.6.6.\nMoreover, one of the prefixes, main, has existed since the beginning and even evolved from typical\nC&C domains to .bit domains, as we will explain in Section 4.3.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n##### 3.2. Timeline\n\nUsing telemetry data, we created a timeline of the first appearance of the samples we have seen.\nThis is presented in Figure 7.\n\n\n#### 2015\n**October**\n\n\n#### 2016\n**March**\n\n\n#### 2016\n**April**\n\n\nFigure 7 Timeline of the RTM malware\n\n#### 4. Technical analysis\n\nIn this section, we describe the main functions of the RTM banker. These include the persistence\nmechanism, their custom version of the RC4 algorithm, the network protocol, the spying\nabilities and some other miscellaneous functions. In particular, we will focus on the samples\nSHA-1 AA0FA4584768CE9E16D67D8C529233E99FF1BBF0 and\n```\n48BC113EC8BA20B8B80CD5D4DA92051A19D1032B.\n\n```\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n##### 4.1. Installation and persistence\n\n4.1.1. Executable\n\nThe core of the RTM malware is a DLL but it is dropped onto the disk by a .EXE. That executable file\nis generally packed and contains the DLL code. When it is launched it only extracts the DLL and runs\nit using the following command:\n\n```\nrundll32.exe “%PROGRAMDATA%\\Winlogon\\winlogon.lnk”,DllGetClassObject host\n\n```\n\n4.1.2. DLL\n\nThe main DLL is always dropped on the disk as winlogon.lnk in the %PROGRAMDATA%\\Winlogon\nfolder. This file extension usually refers to a shortcut [5] but this file is actually a DLL written in Delphi,\nwhich was called core.dll by its developers as shown in Figure 8.\n\nFigure 8 DLL name for sample F4C746696B0F5BB565D445EC49DD912993DE6361\n\nJust after being launched, the malware sets up its persistence mechanism. It can do this in two\ndifferent ways, depending on the victim’s level of user privileges. That is, if running as admin, it can\nadd an entry in the HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ registry under\nthe name “Windows Update”. The commands that are in the data of the “Windows Update” value will\nbe executed at the start of the user session.\n\n```\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Windows Update [REG_SZ] \n= rundll32.exe “%PROGRAMDATA%\\winlogon.lnk”,DllGetClassObject host\n\n```\n\nIt will also try to add a task in the Windows Task Scheduler. This task will launch the winlogon.lnk\nDLL with the same export and parameter as explained before.\n\nIf running as an ordinary user, it will add a value in the HKCU\\SOFTWARE\\Microsoft\\Windows\\\n```\nCurrentVersion\\Run\\ registry under the same name, “Windows Update” and with the same data:\n\n```\n```\nrundll32.exe “%PROGRAMDATA%\\winlogon.lnk”,DllGetClassObject host\n\n```\n\n##### 4.2. Modified RC4 algorithm\n\nDespite its known weaknesses, the RC4 algorithm is regularly used by malware authors. However,\nRTM’s programmers have decided to modify it slightly, possibly to slow down analysis by security\nresearchers. This variant of RC4 is widely used in RTM in its malware to encrypt strings, network\ndata, configuration and modules.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n4.2.1. Differences\n\nThe original RC4 algorithm is divided into two main parts: the Key-Scheduling Algorithm (KSA)\nand the Pseudo-Random Generation Algorithm (PRGA) [6]. The KSA part consists of the initialization\nof the s table using the key. In the PRGA part, the plain text is processed, using the s table, to obtain\nthe ciphertext.\n\nIn the RTM malware, the authors added an intermediate step between the initialization of the s table\nand the encryption of the plaintext, meaning that it comes between the KSA and the PRGA. Before\nencrypting data, the s table is XORed with a four-byte number. This additional key is variable and\nis given at the same time as the data to encrypt or decrypt. The function that performs this\nadditional step is given in Figure 9.\n\n```\nunsigned int __fastcall TCrypt_RC4_variant_xor_stable(int a1, char *s_table, char\n*xored_s_table, int iv)\n{\n  unsigned int i; // eax@1\n  unsigned int v5; // eax@2\n  i = 0;\n  do\n  {\n    *&xored_s_table[i] = iv ^ *&s_table[i];\n    v5 = i + 4;\n    *&xored_s_table[v5] = iv ^ *&s_table[v5];\n    v5 += 4;\n    *&xored_s_table[v5] = iv ^ *&s_table[v5];\n    v5 += 4;\n    *&xored_s_table[v5] = iv ^ *&s_table[v5];\n    v5 += 4;\n    *&xored_s_table[v5] = iv ^ *&s_table[v5];\n    v5 += 4;\n    *&xored_s_table[v5] = iv ^ *&s_table[v5];\n    v5 += 4;\n    *&xored_s_table[v5] = iv ^ *&s_table[v5];\n    v5 += 4;\n    *&xored_s_table[v5] = iv ^ *&s_table[v5];\n    i = v5 + 4;\n  }\n  while ( i < 255 );\n  return i;\n}\n\n```\n\nFigure 9 Additional step in the RC4 algorithm\n\n4.2.2. String encryption\n\nAt first glance, there are few strings readable in the main DLL. The others are encrypted with\nthe previous algorithm using the structure described in Figure 10. We found more than 25 different\nRC4 keys used for string encryption in the samples we analyzed while the XOR key is different\nfor each string. The value of the integer field separating each string structure is always 0xFFFFFFFF.\n\nAt the beginning of its execution, the malware decrypts the strings into a global variable. Then,\nwhen it needs to access a string, it dynamically computes the address of the decrypted strings based\non a base address and an offset.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nThe strings contain interesting information about the functions of the malware. Some examples\nof these strings are found in Section 6.8.\n\n```\nstruct struct_encrypted_string\n{\n    int separator; //constant - 0xFFFFFFFF\n    int size;\n    int xor_key[4];\n    char encrypted_data[size];\n};\n\n```\n\nFigure 10 Encrypted strings structure\n\n##### 4.3. Network\n\nThe way the malware contacts the C&C has changed over the different versions. The first few\nsamples, from October 2015 to April 2016, used traditional domain names along with an RSS feed\nhosted on livejournal.com to update the C&C list. Starting in April 2016, we observed in our telemetry\ndata a move toward the use of .bit domains, which provides, as explained in Section 4.3.2, more\nresilience against domain takedown. The move is confirmed by the registration date of the C&C\ndomains: the first RTM C&C .bit domain, fde05d0573da.bit, was registered on March 13th, 2016.\n\nAll C&C URLs we saw during our tracking shared a common path: /r/z.php. As this path is uncommon,\nit helps to identify RTM requests in network flows.\n\n4.3.1. C&C feed\n\nOlder samples used a feed to update their list of C&C servers. This is hosted on livejournal.com\nand at the time of writing it is still up at the URL hxxp://f72bba81c921(.)livejournal(.)com/\n```\ndata/rss. Livejournal [7] is a US/Russian company providing social network services such \n\n```\nas a blog-hosting platform. The RTM operators simply created a blog on livejournal and posted\nan article containing the feed of encrypted C&Cs. A screenshot of this blog is presented in Figure 11.\n\nFigure 11 C&C feed hosted on livejournal\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nThe C&C strings are encrypted with the RC4 algorithm variant presented in Section 4.2. The actual\nversion (November 2016) of the feed contains the following C&C addresses:\n\n- hxxp://cainmoon(.)net/r/z.php\n\n- hxxp://rtm(.)dev/0-3/z.php\n\n- hxxp://vpntap(.)top/r/z.php\n\n4.3.2 .bit domains\n\nIn the most recent versions of the RTM malware, the authors switched to C&C domains that use\nthe .bit Top-Level Domain (TLD) [8]. This is not in the Internet Corporation for Assigned Names and\nNumbers (ICANN) list of TLDs [9]. Instead, it relies on the Namecoin cryptocurrency, a fork of the wellknown Bitcoin. Malware authors do not frequently use the .bit TLD for their C&C domains, though\nan example of such use was previously seen in a version of the Necurs botnet [10].\n\nUnlike Bitcoin, Namecoin blockchain users are able to store data. One of the main uses for this feature\nis the top level domain .bit. It is possible to register domains that will be stored in the blockchain.\nThe associated record in the blockchain also includes the IP addresses the domain is resolving\nto. Thus, this TLD is said to be “censorship-resistant” because only the registrant can change\nthe resolution of a .bit domain. That means it is much more difficult to disrupt a malicious\ndomain using this kind of TLD.\n\nHowever, the RTM malware does not embed any of the software needed to read the Namecoin\nblockchain. It relies on DNS tier servers like dns.dot-bit.org or OpenNic servers to resolve the .bit\ndomains. Hence, it has the same resilience as the DNS servers it uses. We observed that some C&C\ndomains stopped being resolved after they were mentioned in a blogpost.\n\nAnother advantage to the attackers of the .bit TLD is the cost. To register a domain, the operators\nonly need to pay 0.01NC which corresponds to 0.00185 USD (as of December 5th, 2016). By comparison,\na .com domain costs at least 10 USD.\n\n4.3.3. Protocol\n\nTo contact its C&C, the malware uses HTTP POST requests with data formatted using a custom\nprotocol. The path is always /r/z.php and User-Agent set to Mozilla/5.0 (compatible; MSIE\n```\n9.0; Windows NT 6.1; Trident/5.0).\n\n```\nIn the requests to the C&C server, the data are formatted as follows, where the offset values\nare in bytes:\n\n\n**0** **4**\n\n\n**6**\n\n\n**10**\n\n\n**14**\n\n\n**26**\n\n\n**34** **38** **39**\n\n\nxored\nbotnet id\n\nFigure 12 C&C requests protocol\n\nThe bytes 0 to 6 are not encrypted while the bytes starting at 6 are encrypted with the RC4 algorithm\nvariant.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nThe packet structure of the C&C’s replies is simpler. The bytes from 4 to packet size are encrypted.\n\n**0** **4** **8** **9**\n\nxor key CRC32 #action optional data\n\nFigure 13 C&C replies protocol\n\nA list of the possible values of the action byte is provided in Table 3.\n\n\nTable 3 Possible values of the action field\n\n\nValue Action\n\n0 OK (ACK)\n\n1 Core. Optional: a string that contains a command.\n\n3 Unrecognized request type\n\n4 Unexpected request type\n\n5 Install module\n\n6 Execute downloaded executable\n\nExecute downloaded executable. If the process does not have\n7 administrative rights, it will try to elevate its privileges using\nthe method presented in Section 4.8.2.\n\n8 Load downloaded DLL\n\n9 Load and execute an MZ executable in memory without using a file.\n\n10 Add a certificate to the windows store\n\n11 Self-Update\n\nWrite a file into the common app data folder.\n12\n(Usually C:\\ProgramData)\n\nThe malware always computes the CRC32 of the decrypted data and compares it with the one\nprovided in the packet. If they differ, it will simply drop the packet.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nThe optional data can contain different objects such as a PE file, a file to search in the file system\nor a new C&C URL.\n\n4.3.4. Panel\n\nInterestingly, we note that a panel is available on the C&C servers used by RTM. A screenshot\nof the login page is shown in Figure 14.\n\nFigure 14 Login page for the RTM panel\n\n##### 4.4. Fingerprint\n\nThe RTM malware is a banking Trojan so it is not surprising that its operators need information\nabout the victim’s machine. The information gathered by the bot can be divided into two parts.\nOn one hand, we find common information about the OS attributes. On the other hand,\nthe malware checks whether the compromised machine contains artefacts related to Russian\nremote banking systems.\n\n4.4.1. Common information\n\nAfter the malware is installed or launched after a reboot, a report containing common information\nis sent to the C&C server. It contains:\n\n- The time zone\n\n- The default language identifier\n\n- The privileges of the logged-in user\n\n- The process integrity level\n\n- The username\n\n- The computer name\n\n- The OS version\n\n- The additional modules installed\n\n- The security software installed\n\n- The list of smart card readers\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n4.4.2. Remote banking system\n\nA typical target for banking Trojans is the remote banking system [11] _[2]. RTM is not an exception,_\nas one of its classes is called TBdo. Bdo is the Russian translation for RBS (Remote Banking System)\nso it is clear that RBS is a target for this malware. This class is able to perform several tasks including\nthe scanning of drives and of browsing history.\n\nWhen the malware scans the drive, its sole aim is to determine whether banking software is installed\non the machine. A full list of targeted software is available in Table 4. If it finds an interesting file,\nit reports the information to the C&C server. The next actions performed by the malware depend\non the logic, which is on the C&C server-side.\n\n\nTable 4 Targeted software\n\n\n_ftcgpk.exe 1cv8s.exe CLBANK.EXE iscc.exe sbis.dll wclnt.exe\n\n1cv7.exe bicrypt client.jks ISClient.exe sbis.exe webmoney.exe\n\n1cv7l.exe bssax.ocx faktura maratl.exe SGBClient.exe winpost.exe\n\nSGBClient.exe\n1cv7s.exe cbmain.ex ifobsclient.exe npbssplugin.dll\n\n1cv8.exe cbsmain.dll internetbanktools.exe qiwicashier.exe transaq.exe\n\ncft - bank\n1cv8c.exe intpro.exe rclient.exe wallet.dat\nclient\n\nThe RTM malware also looks for banking URL patterns in IE’s browsing history and in\nthe opened tabs. For the history, it browses using the functions FindNextUrlCacheEntryA\nand FindFirstUrlCacheEntryA and for each entry, it checks to see if the URL matches one\nof the patterns shown in Table 5.\n\nFor opened tabs, it connects to Internet Explorer and Firefox through the Dynamic Data Exchange\n(DDE) [12] mechanism to access the current URL of tabs opened. For each tab, it also checks if that\nmatches a pattern shown in Table 5.\n\nThe browsing history and the opened tabs check is executed in a WHILE loop with a sleep of 1 second\nbetween the checks. The other data monitored in real time will be detailed in Section 4.5.\n\n\nTable 5 Targeted URLs\n\n\nbsi.dll? faktura.ru elba.raiffeisen\n\nonline.payment.ru /iclient/ handybank.\n\nbankline.ru ibank2 wupos.westernunion\n\n/ic/login.zhtml bco.vtb24.ru online.sberbank\n\n/servlets/ibc elbrus.raiffeisen\n\nIf a pattern is found, it is reported to the C&C using the list of strings presented in Table 6.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nTable 6 Identifier for a banking related machine\n\n\nBSS RosBank BiCrypt SberBank_Fiz ISCC\n\nBSS_PC SberBank_BO VTB24 CFT WebMoney\n\niBank2_PC INIST SGB WinPost XTC\n\nFaktura Inversion Raiffeisen SBIS iFOBS\n\nPCB Interbank HandyBank ClBank TRANSAQ\n\nInterPro iBank2 WU QiwiCashier OSMP\n\n##### 4.5 Monitoring\n\nWhen the malware starts, various fingerprint information is sent to the C&C server, including\nthe presence of banking software. This fingerprinting occurs only when the malware first starts\nmonitoring the system, just after the initial scan is finished.\n\n4.5.1. Remote banking system\n\nThe previously discussed class TBdo is also responsible for monitoring banking-related events.\nAs in the initial scan, it uses DDE to check tabs in Firefox and Internet Explorer; another class,\n```\nTShell, is also used to monitor shell windows (Internet Explorer and Explorer windows).\n\n```\nThis class uses the COM interfaces IShellWindows, iWebBrowser, DWebBrowserEvents2\nand IConnectionPointContainer to monitor the windows. When the user navigates to a new\nwebpage, the malware is notified. It then checks the URL against the patterns provided in Table 5.\nIf a match is found, it will take six consecutive screenshots, waiting 5 seconds between each one.\nFinally, it sends the screenshots to the C&C server.\n\nIt also checks for some window titles, related to banking software. A full list of these titles is available\nin Table 7.\n\n\nTable 7 Banking windows targeted\n\n\nWindow name Class name\n\nClBank SunAwtFrame\n\nClBank SunAwtDialog\n\nЛогин (Login) TLoginWindow\n\nNull TfmISClient\n\nКлюч электронной подписи\nTInitialForm\n(Key Electronic Signature)\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n4.5.2. Smart card\n\nThe RTM malware has the ability to monitor smart card readers connected to the infected computers.\nThese devices are used in some countries to validate banking related orders. So, if this kind\nof device is attached to the computer, it may indicate that these machines are used to perform\nbanking transactions.\n\nHowever, unlike other banking Trojans [13], it is not able to interact with these smartcards.\nSuch features may be included in an additional module we have not yet seen.\n\n4.5.3. Keylogger\n\nAn important part of the monitoring of the victim’s computer is to record the keystrokes. Moreover,\nit seems that the RTM developers did not want to miss any information, as they monitor not only\nthe keyboard but also the virtual keyboard and the clipboard.\n\nTo do so, they use the SetWindowsHookExA function to hook the keyboard and the mouse. When\nan event occurs, they log the key pressed, or the key corresponding to the click on the virtual\nkeyboard, along with the software name and the date. Then, the buffer is sent to the C&C.\n\nFor the clipboard, they use the SetClipboardViewer function. They only log the clipboard content\nwhen the data is text. As for the keyboard, they also log the software name and the date before\nsending the buffer to the C&C.\n\n4.5.4. Screenshots\n\nThe last monitoring feature is the ability to make screenshots. This is used when the shell monitoring\nclass detects an interesting website or when a banking software window is detected. The screenshot\nis taken using the GDI library before being sent to the C&C.\n\n##### 4.6. Uninstall\n\nThe C&C can send a command to stop all the malware activities and clean the computer.\nIt will clean all the files and the registry entries created during the execution of RTM on the victim’s\nmachine. Then, using an additional DLL encrypted in the malware, it will kill the malware and delete\nthe winlogon file. Finally, it shuts down the computer. As shown in Figure 15, this DLL was called\n```\nerase.dll by its developers.\n\n```\nFigure 15 Cleaning DLL name\n\nA more destructive command can be sent to the malware, called uninstall-lock. If the malware has\nadministrative rights it will try to erase the MBR. If it fails, it tries to move the MBR to a random path.\nIf it succeeds, the computer will no longer boot after the shutdown. In this event, it would probably\nlead to a full reinstallation of the machine, erasing all possible forensic evidence. If the program has\nlow privileges, the malware writes a .EXE that is encrypted in the main RTM DLL. This .EXE is really\nsmall and only implements the code needed to shut down the computer. It will also register this\nexecutable in the HKCU\\CurrentVersion\\Run registry key. Thus, each time the user starts\na session, the computer will immediately shut down.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n##### 4.7. Config\n\nBy default, the RTM malware doesn’t really have a config file. However, the C&C can push config\nvalues that will be stored in the registry and used by the malware. A list of configuration keys\nis presented in Table 8.\n\n\nTable 8 Configuration keys\n\n\nkeylogger.last-data botnet-id cc.url.1\n\nkeylogger.last-wnd-caption cc.connect-interval cc.url.2\n\nkeylogger.last-exe-path scan-files scards.monitoring-interval\n\nbotnet-prefix post-install-report dbo.detected\n\nscan-files multiinstance-off post-install-report-url\n\nmodules-data.%modulename% keylogger-off dbo-detector-off\n\nscard-off modules-off modules.%modulename%\n\nThe configuration is stored in the registry Software\\[Pseudo-random string] key. In this registry\nkey, each value corresponds to one of the strings presented in the previous table. However, the values\nand the associated data are encrypted using RTM’s custom RC4 algorithm.\n\nThe data has the same structure as the network or the strings. The four-byte XOR key is added\nat the beginning of the encrypted data.\n\nFor the configuration values, the XOR key is different and depends on the size of the value.\nIt can be computed as follows:\n\n```\nxor_key = (len(config_value) << 24) | (len(config_value) << 16) | len(config_\nvalue)| (len(config_value) << 8)\n\n```\n\nFigure 16 Configuration values xor key\n\n##### 4.8. Other functions\n\nThis malware has many other functions that we present here.\n\n4.8.1. Additional modules\n\nIt can run additional modules that are DLL files. They are sent over the network by the C&C server and\ncould be run as external programs. They can also be mapped in memory and launched in new threads.\n\nFor storage, they are saved in .dtt files and encrypted using the custom RC4 algorithm with the\nsame key used for the network communications.\n\nAt this time, we have seen only the VNC module (8966319882494077C21F66A8354E2CBCA0370464),\nthe browser data exfiltration module (03DE8622BE6B2F75A364A275995C3411626C4D9F) and\nthe 1c_2_kl module (B1EE562E1F69EFC6FBA58B88753BE7D0B3E4CFAB) being installed\non an infected machine.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nFor the VNC module, the C&C server later sent a command, asking to connect to a VNC server\nat a specific IP address on port 44443.\n\nThe browser data exfiltration plugin implements the class TBrowserDataCollector, which\nis able to read the IE’s browsing history. It then sends the full list of visited URLs to the C&C server.\n\nThe last discovered module is called 1c_2_kl and is able to interact with the 1C software suite,\nwhich was described in Section 1. This module is divided in two parts: a main DLL and two agents\n(32 and 64 bits) that will be injected in every process by registering a hook to the WH_CBT event.\nIf the agent is injected in a process of the 1C suite, it hooks the CreateFile and WriteFile functions.\n\nWhenever the hooked CreateFile function is called, it keeps in memory the file path should\nits filename be 1c_to_kl.txt. Then, when a call to WriteFile is intercepted, it calls the genuine\n```\nWriteFile function and sends the 1c_to_kl.txt file’s path to the main module DLL by sending \n\n```\nit a crafted WM_COPYDATA Windows message.\n\nFinally, the main module DLL opens and parses the file to identify payment orders. It extracts\nboth the total amount and number of transactions contained in the file. Ultimately, it sends\nthis information to the C&C server. At this time, we believe this module is still in development\nas it contains debug messages and it cannot modify automatically the 1c_to_kl.txt file.\n\n4.8.2. Privilege elevation\n\nThis malware can try to elevate its privileges by showing fake error messages. First, it mimics\na registry check by using a similar design to typical Windows progress bars, as shown in Figure 17.\nIt also uses the real regedit icon. We could also note the spelling mistake in “whait”. After a few\nseconds, the scan is finished and a fake error message is displayed.\n\nFigure 17 Bogus registry check dialog\n\nThis fake error message, shown in Figure 18, would easily fool a typical end user. Once again, the design\nis similar to that of a regular Windows error message, but again there are telltale grammatical errors\nnot found in real Windows error dialogs. If the user clicks on one of the two choices, it will try\nto elevate the malware’s privileges.\n\nImmediately after the user clicks on one of the restore choices, the malware launches the DLL using\nthe runas option in the ShellExecute function. This will run the program with administrative\nprivileges. However, the user will be prompted with a real UAC prompt coming from the Windows\nsystem, shown in Figure 19, asking the user to allow the privilege elevation. If thus allowed,\nthe malware will run with administrative privileges.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\nThus, rather than depending on a vulnerability, it tries to confuse the user. Moreover, depending\non the machine’s default language, error messages will be displayed in English or in Russian.\n\nFigure 18 Fake registry error\n\nFigure 19 Actual UAC prompt from Windows\n\n4.8.3. Certificates\n\nThe malware can also add certificates to the Windows store and it is able to validate the addition\nby automatically clicking “Yes” on the csrss.exe dialog box. This behavior is not new, as the Retefe\nbanking Trojan is also able to self-validate a new certificate installation [14].\n\n4.8.4. Backconnect\n\nThe malware authors also implemented a Backconnect TCP tunnel. We have not seen any usage\nof this functionality but it may be used to control the infected machines remotely.\n\n4.8.5. Host file management\n\nThe C&C can send a command to the malware to modify Windows’ etc/hosts file. The hosts file\nis used on Windows systems to make custom DNS resolutions.\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n4.8.6. Find and send a file\n\nThe C&C can ask the malware to find a file on the file system and to upload it to the server.\nFor instance, during our investigation, we received a command from the C&C server asking\nfor the file 1c_to_kl.txt. As explained before, this file can be generated by the accounting\nsoftware 1C: Enterprise 8.\n\n4.8.7. Update\n\nFinally, the authors can update the malware by sending a new DLL that will replace the current version.\n\n#### 5. Conclusion\n\nOur research on the RTM malware shows that the Russian banking system is still a target of choice\nfor criminals. Other groups, such as Buhtrap, Corkow and Carbanak, were already known to target\nand successfully steal money from financial institutions and their customers in Russia. Thus, RTM\nis another player in this profitable game.\n\nAccording to our telemetry, this piece of malware has been used since the end of 2015 or earlier.\nEven though it does not use previously unknown techniques, it implements a full range of spying\ncapabilities including smart card reading, keylogging and real-time monitoring of banking-related\nactivities. It can also search for export files created by accounting software such as 1C: Enterprise 8.\nFinally, its command and control infrastructure is highly resilient, since it uses the decentralized and\nnon-censurable .bit top-level domain.\n\n[The Indicators of Compromise (IOCs) are detailed in Section 6 and on GitHub. If you have any questions](https://github.com/eset/malware-ioc/tree/master/rtm)\n[related to this investigation, please contact us at threatintel@eset.com.](mailto:threatintel@eset.com)\n\n###### Acknowledgements\n\n_Special thanks to our colleagues Anton Cherepanov and Jan Matušík for their help in this research._\n\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n#### 6. Indicators of Compromise\n\n##### 6.1. ESET detection names\n```\n   Win32/Spy.RTM.A\n   Win32/Spy.RTM.B\n   Win32/Spy.RTM.C\n   Win32/Spy.RTM.D\n   Win32/Spy.RTM.E\n   Win32/Spy.RTM.F\n   Win32/Spy.RTM.G\n   Win32/Spy.RTM.H\n   Win32/Hvnc.AD\n   Win64/Spy.RTM.A\n\n 6.2. File names\n   C:\\ProgramData\\Winlogon\\winlogon.lnk\n\n 6.3. Registry indicators\n   HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run :\n   Windows Update = rundll32.exe “%PROGRAMDATA%\\Winlogon\\winlogon.lnk”,DllGetClassObject\n   host\n   HKLU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run :\n   Windows Update = rundll32.exe “%PROGRAMDATA%\\Winlogon\\winlogon.lnk”,DllGetClassObject\n   host\n\n 6.4. Hashes\n\n```\n6.4.1. DLLs\n```\n   30c8b60ccd66eafb4c861584f45fe80dab71ee22\n   471a8fd0aa32ce61cf5e4ebece95527d1b234de6\n   42b990344d77b22578b0a35adda62c0bc02a09a5\n   be06b838e8b4b2e6bf59ceaafa3fbbb4cebdc522\n   f9183b6e29fee2c3467fc591bae9bb5fe9975027\n   c8f0c4a88397c16695e1352a48c538fb02f1cb16\n   e942145c0f3549bf7be79cbf5a4031cf6614af19\n   0705bda19096b05130e5768ea8efdaa864ddaff0\n   c75273cd886c3ea18a5be7e99b11044f88abd3ef\n   e0f377551d5b6553eedf9a0c3ef23eabfc7a937e\n   e7777db52fc9d34d57253db242f9c195d24836d8\n   ef7de8d746c413a8925aa6a01f7130cfc7eac2df\n   00fe6cf9c85821a2a2479083acb538ee49c8c141\n   5d6a96466e60f15b296d9b0d4cb3e095957d0aa4\n   9172dd756893fe9e68b2dcc85613e7346d1a25ef\n   5f357fbb6ae832f7a0fcfa824fa4026db4000a0a\n   ebdd585edfe6ff9359a38cb7fb65871f418c6c33\n   c3ba475f4e160a153c3baada8042b6aca5d06618\n   f6755195445ce89f61df8ad6aaf2bf491804224a\n   4a670cc34e59ea94e88c19eef6a4106cf5411624\n   5153886fec6cfed815601e68678286633bc564ec\n   4d83f2f601036bc770857f96ab16017b0afb6927\n   be83dd98b269bb2faf9e28e35734d3bfcf635166\n   f4c746696b0f5bb565d445ec49dd912993de6361\n   d8f3c6a1bb43d014fa34eaaae41a8d9eefd7c3b6\n   31b7215c892a0064a6f59c16d68a1decf39012a9\n   5521cce3e5e68eb6b8f7fa129daf143151436b2d\n   da0c6236909ea861b2d24794e88ff44c051ade64\n   822e05f998f5d727d5a663d06273da507ef5f135\n\n```\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n```\n   5b7355ea8152b95a7ab9bb91e5836bf7acc39993\n   1f100e41213be79deacc86a9246e1d0b8a76d64b\n   fd4b98893de80ef3fe83b58017df9718993d8bcb\n   6f036c802384826b630aec70d9833b5b0ed735eb\n   1e4b84be1e4287c9787cd56009e1e2adb3348db8\n   6cf45111b2d71862803cf91f2a79780149c46a27\n   af862050a01972db36589653dc8b155e2b3e2f8c\n   b31a565e7c29b861b182c9880b5d38cb4211ab8f\n   dde57ff3b630a1b4052c3ef290bb361de96eab06\n   bdf77429c785514bf308f7c1d1e9ddca63a33ac8\n   2f6fd3b5a7611d72f9f9eb60b04471f9bebc738f\n   0b40873f86c2e6c676dfc003c232aa3167654172\n   d6004423e7b80d47b6215c9d1875122e128899ed\n   c4834a4e548b82ffe5d90042c78311b537564fe6\n   5cc1ac4f0cc6df3f0dbe2b53864a0f47899939c8\n   4733cf689dcc588b94fd0fba7ad4d93973486752\n   7175b734aa1273710008a2af6398f8bfc55f7f6b\n   cab9247484a6c7a10672b7ca8849dd7b4577be02\n   daa0673cb1d3eb7dbe8aa435997ecd9e1da228fd\n   f04300e901870efa9c9e49c440baaac23b0ce96c\n   9a131fc27f5397e32596e81df22260885b53cdfd\n   094ac3c414a9e6028afa5cdc0d4b4f3aa98b92ca\n   9a3e89d62795a1cb0747d279a6fdf65bfc8d5c8d\n   df1a4c99791570a2d203075581a6aeef59ece02b\n   94e21bac5c0fc0d8d583a0b9b1daf5d18528cc9f\n   aa0fa4584768ce9e16d67d8c529233e99ff1bbf0\n\n```\n6.4.2. Droppers/Downloaders\n```\n   0961119783365e8b4dff12df7c7ae9f7388a410c\n   662b4daea4b07e7c95f4a58cf0be0f0281c81c67\n   859f66a7057304e72eaff58ded1a2aeae29a41dc\n   42a4b04446a20993ddae98b2be6d5a797376d4b6\n   48bc113ec8ba20b8b80cd5d4da92051a19d1032b\n   025c718ba31e43db1b87dc13f94a61a9338c11ce\n   059a114c2ec56434251cec7db4828418335cf29a\n   4a084e70fa2e6425c68c692b560acae68f89e69f\n   77a7735d0f83610e4d581850dd89ea15b6c5f699\n   83db465d10e6f403cf28ed714fbdf5e218b8fb41\n   8b77419e6c006303f078e77e6c1ca21547b8bdd1\n   9ac461ef9848367f46bf64649d46de955c4afc66\n   a1c7b51747ad13c5a1df470098a4585e1f24a5c4\n   a6d3e97d832d17d589c1a0aa24baaeccd73a2b39\n   e9fe3259bceb852ec1b8e5a01ff19eb7e3b08fbc\n   f539f5f3847d60ef6b6bfe32be76fe190b9298b0\n   e36f88d67cd50a9bc2e5d30cbf26577ffadd4a90\n   d125a868c393c3490d2d24016edb159a2a5ad0a9\n   92a1c9fc9069744653d4d3733ebf8669a84351b9\n   9d2fd31c086f0e982f6b973ee5951173ab69d0b2\n   cca9ade798a61450adbbcac5e433dadde11867ba\n   fca3d02a53e66d8975997ff2b03c8008a254a508\n   312a487b2830c62845f6feaf11d4af7c25783f1a\n   c4844acd88eeb104a05a775e475bc48e05a238e7\n   c824ee17138d2002a712744c3012fc51355fb044\n   85a6d6938680b30bac2c755a502f6b4f104643a3\n   d0390f4bcd5c0a952c012fbd034e78dbe88ed184\n   43a4c65da2c112c42e910f4e6ea359c759064d52\n   5b38be812c5e21fb9efb01eea845704cf9978a6d\n   c6e3aa123a52762bf2690b97cc79148eedd0e1e0\n   136185555755c537522e5ccc8a0d7487dc9dcffa\n   7c48114467776541032206fd9ae22be8490c45ba\n   f89e56dd9ca78cec02d0a2b95803843c59234082\n   1e3061c49cf62821ca17b835b7ff8d9d8a3bb6c2\n   f667d946acbc69d70ea0978b9b6878d232665cad\n   49994863baffba440212bd24232df21fbf93d812\n   7c1b6b1713bd923fc243dfec80002fe9b93eb292\n   b f d fb b\n\n```\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n6.4.3. Modules\n```\n   03DE8622BE6B2F75A364A275995C3411626C4D9F\n   8966319882494077C21F66A8354E2CBCA0370464\n   B1EE562E1F69EFC6FBA58B88753BE7D0B3E4CFAB\n\n##### 6.5. C&C server domain names\n   f72bba81c921(.)livejournal(.)com/data/rss\n   webstatisticaonline(.)tech\n   vpntap(.)top\n   rtm(.)dev\n   cainmoon(.)net\n   micro4n(.)top\n   ssdcool(.)top\n   cash-money-analitica(.)bit\n   money-cash-analitica(.)bit\n   vpnomnet(.)bit\n   vpnkeep(.)bit\n   fde05d0573da(.)bit\n   d47ea26b7faa(.)bit\n   feb96eb2aa59(.)bit\n\n 6.6. C&C server IP addresses\n   5.154.190(.)167\n   5.154.190(.)168\n   5.154.190(.)189\n   5.154.191(.)57\n   5.154.191(.)154\n   5.154.191(.)174\n   5.154.191(.)225\n   37.1.206(.)78\n   88.208.28(.)147\n   91.207.7(.)69\n   91.215.153(.)31\n   93.170.168(.)218\n   93.190.139(.)66\n   95.183.52(.)182\n   109.236.82(.)150\n   109.248.32(.)152\n   131.72.138(.)169\n   138.201.104(.)161\n   154.70.153(.)125\n   158.255.6(.)150\n   158.255.208(.)197\n   185.61.149(.)70\n   185.61.149(.)78\n   185.82.201(.)45\n   185.82.216(.)14\n   185.128.42(.)237\n   185.141.27(.)249\n   185.169.229(.)42\n   188.138.71(.)117\n   200.74.240(.)80\n   200.74.240(.)134\n   212.48.90(.)155\n   213.184.127(.)137\n   217.23.6(.)29\n\n 6.7. PDB paths\n   getapulab.pdb\n\n```\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n##### 6.8. Strings\n```\n   ZKRT, winhttp.dll, WinHttpOpen, WinHttpCloseHandle, WinHttpConnect, WinHttpOpenRequest,\n   WinHttpReadData, WinHttpCrackUrl, WinHttpSendRequest, WinHttpReceiveResponse,\n   WinHttpSetOption, Software\\\\, keylogger.last-data, keylogger.last-wnd-caption,\n   keylogger.last-exe-path, FRTnBm6glKEZf60, kosmos, botnet-prefix, botnet-id,\n   cc.connect-interval, GetSystemDefaultUILanguage, RTM_ModuleEP, scan-files, crypt32.\n   dll, CryptUnprotectData, post-install-report, cc.url.1, cc.url.2, __, x32, x64,,,\n   modules., modules-data., core, msg, del-module, unload, uninstall, uninstall-lock,\n   find-files, shutdown, reboot, cfg-set-str-a, cfg-set-str-w, cfg-set-dw, cfg-get-str-a,\n   cfg-get-str-w, cfg-get-dw, cfg-del-param, screenshot, dns, lpe-runas-flags, SOFTWARE\\\\\n   Microsoft\\\\Windows NT\\\\CurrentVersion, EditionID, Service Pack, SP, CSDVersion,\n   CurrentVersion, CurrentBuildNumber, scards.monitoring-interval, files found, image/\n   png, .png, ROOT, csrss.exe, OldFile, Updated, dbo.detected, bsi.dll?, online.payment.\n   ru, bankline.ru, /ic/login.zhtml, /servlets/ibc, faktura.ru, /iclient/, ibank2,\n   bco.vtb24.ru, elbrus.raiffeisen, elba.raiffeisen, handybank., wupos.westernunion,\n   online.sberbank., Unk, SberBank_PC, BSS, BSS_PC, iBank2_PC, Faktura, PCB, InterPro,\n   RosBank, SberBank_BO, INIST, Inversion, Interbank, iBank2, BiCrypt, VTB24, 1C, SGB,\n   Raiffeisen, HandyBank, WU, SberBank_Fiz, CFT, WinPost, SBIS, ClBank, QiwiCashier, ISCC,\n   WebMoney, XTC, iFOBS, TRANSAQ, OSMP, IExplore, Firefox, 0xFFFFFFFF, WWW_GetWindowInfo,\n   \\”,\\”, gdiplus.dll, GdipGetImageEncodersSize, GdipGetImageEncoders, GdiplusStartup,\n   GdiplusShutdown, GdipCreateBitmapFromHBITMAP, GdipDisposeImage, GdipSaveImageToStream,\n   ole32.dll, GetHGlobalFromStream, CreateStreamOnHGlobal, kernel32.dll, CloseHandle,\n   user32.dll, ToUnicode, CloseClipboard, WinSCard.dll, SCardFreeMemory, SCardListReadersW,\n   SCardEstablishContext, SCardReleaseContext, SCardGetStatusChangeW, SeShutdownPrivilege,\n   auto-elevate, Elevating success, Elevating failed, reload, Reloaded, ntdll.dll,\n   RtlAdjustPrivilege, ZwShutdownSystem, new-cc, hosts-add, hosts-clear, dbo-scan,\n   scard-off, modules-off, dbo-detector-off, multiinstance-off, keylogger-off, dnsapi.\n   dll, DnsQuery_A, DnsRecordListFree, dns.dot-bit.org, 193.183.98.154, 106.186.17.181,\n   50.116.23.211, 130.255.73.90, 109.69.8.34, File already updated, post-install-report   url, 527D67BF-0D37-46D8-895F-D662E8A12190, 3998A1EC-1726-42CA-830C-D6E966D21411,\n   5B42B658-6029-44FD-9561-1ED64E89A0AA, 692B2F88-60F4-45A4-88E2-946F98E12773, A69D400E   70E8-45F4-9438-80734E1FEA72, SYSTEM\\\\CurrentControlSet\\\\services\\\\Disk\\\\Enum, sdtf, D2,\n   GET, POST, HTTP/1.1, Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0),\n   Accept: text/html, application/xhtml+xml, */*\\r\\nAccept-Language: en-US\\r\\nConnection:\n   Close, Accept: t, http://vpnomnet.bit/r/z.php, http://vpnkeep.bit/r/z.php, non,\n   ?a=started&fid=, *.*, *.dtt, .dtt, rundll32.exe, open, regedit.exe, BUTTON, STATIC,\n   msctls_progress32, DISPLAY, Windows Registry Error, Windows >\\u00041\\u0004=\\u00040\\\n   u0004@\\u0004C\\u00046\\u00048\\u0004;\\u00040\\u0004 ?\\u0004>\\u00042\\u0004@\\u00045\\u00046\\\n   u00044\\u00045\\u0004=\\u0004=\\u0004K\\u00045\\u0004 7\\u00040\\u0004?\\u00048\\u0004A\\u00048\\\n   u0004 @\\u00045\\u00045\\u0004A\\u0004B\\u0004@\\u00040\\u0004, Windows has encountered a\n   corrupted registry records, \\u0018\\u0004A\\u0004?\\u0004@\\u00040\\u00042\\u00048\\u0004B\\\n   u0004L\\u0004 7\\u00040\\u0004?\\u00048\\u0004A\\u00048\\u0004, Restore records, \\u0018\\\n   u0004A\\u0004?\\u0004@\\u00040\\u00042\\u00048\\u0004B\\u0004L\\u0004 7\\u00040\\u0004?\\u00048\\\n   u0004A\\u00048\\u0004 8\\u0004 ?\\u0004@\\u0004>\\u00042\\u00045\\u0004@\\u00048\\u0004B\\u0004L\\\n   u0004 =\\u00040\\u0004 >\\u0004H\\u00048\\u00041\\u0004:\\u00048\\u0004, Restore records and\n   check for errors, \\u001f\\u0004>\\u00044\\u0004@\\u0004>\\u00041\\u0004=\\u00045\\u00045\\u0004\n   >\\u00041\\u0004 M\\u0004B\\u0004>\\u00049\\u0004 >\\u0004H\\u00048\\u00041\\u0004:\\u00045\\u0004,\n   More details about this error, \\u001e\\u00041\\u0004=\\u00040\\u0004@\\u0004C\\u00046\\u00045\\\n   u0004=\\u0004K\\u0004 ?\\u0004>\\u00042\\u0004@\\u00045\\u00046\\u00044\\u00045\\u0004=\\u0004=\\\n   u0004K\\u00045\\u0004 7\\u00040\\u0004?\\u00048\\u0004A\\u00048\\u0004 2\\u0004 @\\u00045\\u00045\\\n   u0004A\\u0004B\\u0004@\\u00045\\u0004 Windows., Multiple corrupted records has been found\n   in Windows registry., \\u0014\\u0004;\\u0004O\\u0004 C\\u0004A\\u0004B\\u0004@\\u00040\\u0004=\\\n   u00045\\u0004=\\u00048\\u0004O\\u0004 >\\u0004H\\u00048\\u00041\\u0004:\\u00048\\u0004, Windows\n   8\\u0004A\\u0004?\\u0004@\\u00040\\u00042\\u00048\\u0004B\\u0004 ?\\u0004>\\u00042\\u0004@\\u00045\\\n   u00046\\u00044\\u00045\\u0004=\\u0004=\\u0004K\\u00045\\u0004 7\\u00040\\u0004?\\u00048\\u0004A\\\n   u00048\\u0004., To resolve this problem, Windows restore these records., \\u0014\\u00045\\\n   u0004B\\u00040\\u0004;\\u00048\\u0004 >\\u0004H\\u00048\\u00041\\u0004:\\u00048\\u0004: \\u001d\\\n   u00045\\u00042\\u00045\\u0004@\\u0004=\\u0004K\\u00049\\u0004 4\\u00045\\u0004A\\u0004:\\u0004@\\\n   u00048\\u0004?\\u0004B\\u0004>\\u0004@\\u0004, Error details: Incorrect descriptor, \\u001f\\\n   u0004>\\u00042\\u0004@\\u00045\\u00046\\u00044\\u00045\\u0004=\\u0004=\\u0004K\\u00045\\u0004 7\\\n   u00040\\u0004?\\u00048\\u0004A\\u00048\\u0004:, Corrupted records:, \\u001a\\u0004>\\u0004;\\\n   u00048\\u0004G\\u00045\\u0004A\\u0004B\\u00042\\u0004>\\u0004 7\\u00040\\u0004?\\u00048\\u0004A\\\n   u00045\\u00049\\u0004: 3, Corrupted records count: 3, \\u001e\\u0004B\\u0004<\\u00045\\u0004=\\\n   u00040\\u0004, Cancel, \\u001e\\u0004H\\u00048\\u00041\\u0004:\\u00040\\u0004: \\u001d\\u00045\\\n   u00042\\u00045\\u0004@\\u0004=\\u0004K\\u00049\\u0004 4\\u00045\\u0004A\\u0004:\\u0004@\\u00048\\\n\n```\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n```\nu0004?\\u0004B\\u0004>\\u0004@\\u0004\\r\\n\\u001a\\u0004>\\u00044\\u0004 >\\u0004H\\u00048\\u00041\\\nu0004:\\u00048\\u0004: 0xc0005071, Error: Incorrect descriptor\\r\\nError code: 0xc0005071,\nMicrosoft Windows, \\u001f\\u0004@\\u0004>\\u00042\\u00045\\u0004@\\u0004:\\u00040\\u0004 4\\\nu00045\\u0004A\\u0004:\\u0004@\\u00048\\u0004?\\u0004B\\u0004>\\u0004@\\u0004>\\u00042\\u0004 @\\\nu00045\\u00045\\u0004A\\u0004B\\u0004@\\u00040\\u0004 Windows, Windows checking registry\ndescriptors, \\u001f\\u0004>\\u00046\\u00040\\u0004;\\u0004C\\u00049\\u0004A\\u0004B\\u00040\\\nu0004, ?\\u0004>\\u00044\\u0004>\\u00046\\u00044\\u00048\\u0004B\\u00045\\u0004..., Please,\nwhait..., runas, \\”,DllGetClassObject host, .1, #32770, SysCredential, ComboBoxEx32,\nComboBox, Edit, CLIPBOARD, .exe, WbemScripting.SWbemLocator, localhost, root\\\\CIMV2,\nSELECT * FROM Win32_NetworkAdapterConfiguration Where IPEnabled = True, WQL, root\\\\\nSecurityCenter, SELECT * FROM AntiVirusProduct, \\\\VarFileInfo\\\\Translation, \\\\\nStringFileInfo\\\\, ProductVersion, wclnt.exe, cbmain.ex, ibank.odb, internetbanktools.\nexe, LegalCopyright, ProductName, bicrypt, faktura, client.jks, intpro.exe, npbssplugin.\ndll, bssax.ocx, cbsmain.dll, isclient.exe, 1cv8.exe, 1cv8c.exe, 1cv8s.exe, 1cv7.exe,\n1cv7l.exe, 1cv7s.exe, sgbclient.exe, rclient.exe, cft - bank client, winpost.exe,\nsbis.exe, sbis.dll, clbank.exe, qiwicashier.exe, iscc.exe, webmoney.exe, _ftcgpk.exe,\nwallet.dat, ifobsclient.exe, transaq.exe, maratl.exe, 1\\u00040\\u0004=\\u0004:\\u0004,\nbank, SunAwtFrame, SunAwtDialog, \\u0012\\u0004E\\u0004>\\u00044\\u0004 2\\u0004 A\\u00048\\\nu0004A\\u0004B\\u00045\\u0004<\\u0004C\\u0004, MozillaWindowClass, IEFrame, \\u001b\\u0004>\\\nu00043\\u00048\\u0004=\\u0004, TLoginWindow, TfmISClient, TInitialForm, \\u001a\\u0004;\\\nu0004N\\u0004G\\u0004 M\\u0004;\\u00045\\u0004:\\u0004B\\u0004@\\u0004>\\u0004=\\u0004=\\u0004>\\\nu00049\\u0004 ?\\u0004>\\u00044\\u0004?\\u00048\\u0004A\\u00048\\u0004, obj_button, obj_static,\ntpanel, tbsvkcontrolscroller, Tahoma, *.pif, pif, .job, Software\\\\Microsoft\\\\Windows\\\\\nCurrentVersion\\\\Run, Windows Update, Tasks\\\\, Microsoft Corporation, Updating Windows\ncomponents., Author, PT0S, schedule, Winlogon, \\\\winlogon.lnk, \\”,DllGetClassObject,\nSOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon, Shell, \\\\\\\\.\\\\PhysicalDrive,\nbootmgr, ntldr, Global\\\\, drivers\\\\etc\\\\hosts, ipconfig /flushdns, iexplore.exe,\nfirefox.exe, xb\n\n```\n\n-----\n\nA Guide to the RTM Banking Trojan\n\n\n#### 7. Bibliography\n\n_1._ [Kafeine, 20 10 2016. [Online]. Available: https://twitter.com/kafeine/status/789063680507912192.](https://twitter.com/kafeine/status/789063680507912192)\n\n_2._ J.-I. Boutin, «Operation Buhtrap, the trap for Russian accountants,» ESET, 09 04 2015. [Online].\n[Available: http://www.welivesecurity.com/2015/04/09/operation-buhtrap/.](http://www.welivesecurity.com/2015/04/09/operation)\n\n_3._ «Информация для пользователей и партнеров №22531 от 20.01.2017,» [Online].\n[Available: https://1c.ru/news/info.jsp?id=22531. [Accessed 05 02 2017].](https://1c.ru/news/info.jsp?id=22531.)\n\n_4._ «Rig Exploit Kit via EiTest delivers malicious payloads,» 19 10 2016. [Online].\n[Available: http://www.broadanalysis.com/2016/10/19/rig-exploit-kit-via-eitest-delivers-malicious-payloads/.](http://www.broadanalysis.com/2016/10/19/rig)\n\n_5._ «Shortcut (computing),» 07 12 2016. [Online].\n[Available: https://en.wikipedia.org/wiki/Shortcut_(computing)#Microsoft_Windows.](https://en.wikipedia.org/wiki/Shortcut_)\n\n_6._ [«RC4,» [Online]. Available: https://en.wikipedia.org/wiki/RC4#Key-scheduling_algorithm_.28KSA.29.](https://en.wikipedia.org/wiki/RC4)\n\n_7._ [«Livejournal,» [Online]. Available: http://www.livejournal.com.](http://www.livejournal.com)\n\n_8._ [McArdle, Robert; Sancho, David;, «Bitcoin Domains,» 2013. [Online]. Available: http://www.trendmicro.com.au/](http://www.trendmicro.com.au/cloud-content/us/pdfs/security-intelligence/white-papers/wp-bitcoin-domains.pdf)\n[cloud-content/us/pdfs/security-intelligence/white-papers/wp-bitcoin-domains.pdf.](http://www.trendmicro.com.au/cloud-content/us/pdfs/security-intelligence/white-papers/wp-bitcoin-domains.pdf)\n\n_9._ «List of Top-Level Domains,» ICANN, 14 12 2016. [Online].\n[Available: http://data.iana.org/TLD/tlds-alpha-by-domain.txt.](http://data.iana.org/TLD/tlds-alpha-by-domain.txt)\n\n_10._ «Necurs – C&C domains non-censorable,» Bluecoat, 09 09 2013. [Online].\n[Available: https://www.bluecoat.com/security-blog/2013-09-10/necurs-%E2%80%93-cc-domains-non-censorable.](https://www.bluecoat.com/security-blog/2013-09-10/necurs)\n\n_11._ A. Matrosov, E. Rodionov, D. Volkov and D. Harley, «Win32/Carberp: When You’re in a Black Hole, Stop Digging,» 2012.\n\n[[Online]. Available: http://www.welivesecurity.com/media_files/white-papers/carberp.pdf.](http://www.welivesecurity.com/media_files/white-papers/carberp.pdf)\n\n_12._ “About Dynamic Data Exchange,” Microsoft, [Online].\n[Available: https://msdn.microsoft.com/en-us/library/windows/desktop/ms648774(v=vs.85).aspx.](https://msdn.microsoft.com/en-us/library/windows/desktop/ms648774)\n\n_13._ A. Matrosov, «Smartcard vulnerabilities in modern banking malware,» ESET, 05 06 2012. [Online].\n[Available: http://www.welivesecurity.com/2012/06/05/smartcard-vulnerabilities-in-modern-banking-malware/.](http://www.welivesecurity.com/2012/06/05/smartcard)\n\n_14._ J. Hořejší, «Retefe banking Trojan targets UK banking customers,» AVAST, 22 06 2016. [Online].\n[Available: https://blog.avast.com/retefe-banking-trojan-targets-uk-banking-customers.](https://blog.avast.com/retefe)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://www.welivesecurity.com/wp-content/uploads/2017/02/Read-The-Manual.pdf",
        "http://www.welivesecurity.com/wp-content/uploads/2017/02/Read-The-Manual.pdf"
    ],
    "report_names": [
        "Read-The-Manual.pdf"
    ],
    "threat_actors": [
        {
            "id": "89542ecf-606b-4913-87c5-21512f9b82b9",
            "created_at": "2022-10-25T15:50:23.681673Z",
            "updated_at": "2025-03-27T02:00:55.522794Z",
            "deleted_at": null,
            "main_name": "RTM",
            "aliases": [
                "RTM"
            ],
            "source_name": "MITRE:RTM",
            "tools": [
                "RTM"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3b046db2-f60e-49ae-8e16-0cf82a4be6fb",
            "created_at": "2022-10-25T16:07:23.427162Z",
            "updated_at": "2025-03-27T02:02:09.79482Z",
            "deleted_at": null,
            "main_name": "Buhtrap",
            "aliases": [
                "Buhtrap",
                "Operation TwoBee",
                "Ratopak Spider",
                "UAC-0008"
            ],
            "source_name": "ETDA:Buhtrap",
            "tools": [
                "AmmyyRAT",
                "Buhtrap",
                "CottonCastle",
                "FlawedAmmyy",
                "NSIS",
                "Niteris EK",
                "Nullsoft Scriptable Install System",
                "Ratopak"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a58aedbc-e89f-4e0c-8147-c6406a616cfa",
            "created_at": "2022-10-25T16:07:23.494355Z",
            "updated_at": "2025-03-27T02:02:09.831373Z",
            "deleted_at": null,
            "main_name": "Corkow",
            "aliases": [
                "Corkow",
                "Metel"
            ],
            "source_name": "ETDA:Corkow",
            "tools": [
                "Corkow",
                "Metel"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6a99bf81-8ed4-4233-82e2-575e4f9bf282",
            "created_at": "2022-10-25T16:07:24.137248Z",
            "updated_at": "2025-03-27T02:02:10.119569Z",
            "deleted_at": null,
            "main_name": "RTM",
            "aliases": [],
            "source_name": "ETDA:RTM",
            "tools": [
                "AtNow",
                "RTM",
                "RTM Banker",
                "Redaman"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "01d569b1-f089-4a8f-8396-85078b93da26",
            "created_at": "2023-01-06T13:46:38.411615Z",
            "updated_at": "2025-03-27T02:00:02.826863Z",
            "deleted_at": null,
            "main_name": "BuhTrap",
            "aliases": [],
            "source_name": "MISPGALAXY:BuhTrap",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041818,
    "ts_creation_date": 1487333941,
    "ts_modification_date": 1487333948,
    "files": {
        "pdf": "https://archive.orkl.eu/dc03a067735360acad3b1053e3fb9302e6609192.pdf",
        "text": "https://archive.orkl.eu/dc03a067735360acad3b1053e3fb9302e6609192.txt",
        "img": "https://archive.orkl.eu/dc03a067735360acad3b1053e3fb9302e6609192.jpg"
    }
}