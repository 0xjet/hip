{
    "id": "8fa2af11-aaa6-40f2-a5bf-398454d62fae",
    "created_at": "2023-01-12T15:03:47.585061Z",
    "updated_at": "2025-03-27T02:16:01.964674Z",
    "deleted_at": null,
    "sha1_hash": "dc950fa74b958428ce215f19fee59d86a1643eb5",
    "title": "2021-07-28 - I Knew You Were Trouble- TA456 Targets Defense Contractor with Alluring Social Media Persona",
    "authors": "",
    "file_creation_date": "2022-05-28T16:06:55Z",
    "file_modification_date": "2022-05-28T16:06:55Z",
    "file_size": 1488963,
    "plain_text": "# I Knew You Were Trouble: TA456 Targets Defense Contractor with Alluring Social Media Persona\n\n**[proofpoint.com/us/blog/threat-insight/i-knew-you-were-trouble-ta456-targets-defense-contractor-alluring-social-media](https://www.proofpoint.com/us/blog/threat-insight/i-knew-you-were-trouble-ta456-targets-defense-contractor-alluring-social-media)**\n\nJuly 23, 2021\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nI Knew You Were Trouble: TA456 Targets Defense Contractor with Alluring Social Media\nPersona\n\n\n-----\n\nJuly 28, 2021 JOSHUA MILLER, MICHAEL RAGGI, & CRISTA GIERING\n\n## Key Takeaways\n\nTA456, an Iranian-state aligned actor, spent years masquerading as the persona\n“Marcella Flores” in an attempt to infect the machine of an employee of an aerospace\ndefense contractor with malware.\nThe malware, dubbed by Proofpoint as LEMPO, was designed to establish\npersistence, perform reconnaissance, and exfiltrate sensitive information.\nTA456 actively targets smaller subsidiaries and contractors in support of efforts\nto compromise larger defense contractors using a supply chain compromise.\nWhile targeting defense contractors is not new for TA456, this campaign uniquely\nestablishes the group as one of the most determined Iranian-aligned threat actors\ntracked by Proofpoint because of its significant use of social engineering, cross platform\ncommunication, and general persistence.\n\n## Overview\n\nProofpoint researchers have identified a years-long social engineering and targeted malware\ncampaign by the Iranian-state aligned threat actor TA456. Using the social media persona\n“Marcella Flores,” TA456 built a relationship across corporate and personal communication\nplatforms with an employee of a small subsidiary of an aerospace defense contractor. In early\nJune 2021, the threat actor attempted to capitalize on this relationship by sending the target\nmalware via an ongoing email communication chain. Designed to conduct reconnaissance on\nthe target’s machine, the macro-laden document contained personalized content and\ndemonstrated the importance TA456 placed on the target. Once the malware, which is an\n[updated version of Liderc that Proofpoint has dubbed LEMPO, establishes persistence,](https://blog.talosintelligence.com/2019/09/tortoiseshell-fake-veterans.html)\nit can perform reconnaissance on the infected machine, save the reconnaissance details to\nthe host, exfiltrate sensitive information to an actor-controlled email account via SMTPS, and\nthen cover its tracks by deleting that day’s host artifacts.\n\n\n-----\n\nThis campaign exemplifies the persistent nature of certain state aligned threats and\nthe human engagement they are willing to conduct in support of espionage operations. In\nmid-July, Facebook disrupted a network of similar personas they attributed to\nTortoiseshell. LEMPO, the malware, whose delivery Proofpoint disrupted, along with the\nnetwork of personas, are attributed to TA456. This actor is believed to be loosely aligned with\nthe Islamic Revolutionary Guard Corps (IRGC) via association with the Iranian\ncompany Mahak Rayan Afraz (MRA), according to Facebook’s analysis.\n\n## Campaign Breakdown\n\nProofpoint data shows that over at least eight months, “Marcella (Marcy) Flores” sent TA456’s\ntarget benign email messages, photographs, and a video to establish her veracity and build\nrapport with the intended victim. At one time, TA456 attempted to send a benign,\nbut flirtatious video via a OneDrive URL. In early June, a TA456 actor self-identified\nas “Marcy” sent another OneDrive link, this time masquerading as a diet survey (Figure 1).\n\n\n-----\n\n_Figure 1. The diet survey email sent to the target._\n\nThe OneDrive URL delivered a\n.rar file (dfddbd09ccea598c4841f1abbc927f1c661d85d4bd9bcb081f7c811212d8a64a) containing\na .xlsm (Figure\n2) (612bdfb4f6eaf920a7a41fa06de8d99f6ecf6ad147374efa6eb1d5aff91df558). Using\nprevious conversation topics with the target, the .xlsm purported to be pandemic diet\nassistance and requested that the user enable content to access the privacy protected\nportions of the file. If the content is enabled, the macro will create and hide the directory\n\\Appdata\\Perflog and then write LEMPO, a very simple but ingenious plaintext stealer\ncomprised of Visual Basic Script (VBS), to that directory (Schedule.vbs\n1534f95f49ddf2ada38561705f901e5938470c1678d6a81f0f4177ba7412ef5b). After authoring\nthe VBS, the Excel macro will add a registry\nkey (HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run /v Schedule /t REG_SZ /d\nC:\\Users\\[redacted_username]\\AppData\\Perflog\\Schedule.vbs /f) to ensure LEMPO is\nrun upon user login.\n\n_Figure 2. The diet survey .xlsm file._\n\nThe macro in the Excel document also contains code to connect via HTTP POST\nto showip[.]net. The response, along with the results of \"net use\" and \"netstat -nao\" are\nstored in a hidden sheet within the .xlsm, reminiscent of the technique described in\n\n\n-----\n\nFacebook s July 15th announcement. Proofpoint analysts assess this may indicate code\npartially remaining from an earlier iteration of the tool that came before LEMPO or a desire for\nredundancy in TA456's reconnaissance tooling.\n\n## LEMPO\n\nThe LEMPO reconnaissance tool is a Visual Basic Script dropped\nby an Excel macro. Leveraging built-in Windows commands it enumerates the host in a\nvariety of ways, records the collected data and then exfiltrates the intelligence to an actorcontrolled email account using Microsoft’s Collaboration Data Objects (CDO).\nCDO, previously known as OLE Messaging or Active Messaging, is an application\nprogramming interface included with Microsoft Windows and Microsoft Exchange Server\nproducts. While most of this analysis is based off the sample blocked by Proofpoint\n(1534f95f49ddf2ada38561705f901e5938470c1678d6a81f0f4177ba7412ef5b) in June 2021,\nwe also identified a similar sample\n(da65aa439e90d21b2cf53afef6491e7dcdca19dd1bbec50329d53f3d977ee089) uploaded to a\npublic malware repository with an upload date of June 2020.\n\n## Reconnaissance\n\nLEMPO collects the following information and records it to %temp%\\Logs.txt\n\nDate and time\nComputer and usernames\nSystem information via\nWMIC os, sysaccount, environment, and computer system commands\nAntivirus products located in the “SecurityCenter2” path\nDrives\nTasklist\nSoftware and version\nNet users and user details\n\nFollowing the connectivity check, detailed in the following section, LEMPO writes the\nfollowing to %temp%\\Logs.txt\n\nFirewall rules\nList of running processes via Powershell Get-Process\nIP config\nDomain hosts, users, computers, and local groups\nTrusted domains\nNetwork shares\nArp cache\nTracert\nExternal IP (via showip.net)\n\n\n-----\n\nConnections (netstat -nao)\n\n## Connectivity\n\nPrior to the network focused reconnaissance, LEMPO checks connectivity by reaching out to\nYandex, Google, Yahoo, Github, Mailchimp, Mega, Arxiv (an online academic repository\nspecializing in electrical engineering and scientific research), and Twitter using ping and\ncurl (Figure 3). The June 2020 version of LEMPO includes only a connectivity check to\nford[.]com.\n\n_Figure 3._\n\nAfter finishing that additional recon, LEMPO moves Logs.txt from %temp% to \\Perflog.\nLEMPO then checks to ensure the Registry Key previously mentioned has been added and\nthen uses the findstr command to identify files containing “user,” “pass,” and\n“vpn.” The findstr command returns any matching lines which could collect usernames and\npasswords from the computer. Logs.txt is then compressed into Logs.zip\n\n## Exfiltration\n\n\n-----\n\nLEMPO uses hardcoded credentials with Microsoft s CDO to exfiltrate the information over\nSMTPS on port 465. In the June 2021 version of LEMPO, TA456 uses the same Yahoo email\naddress to send and receive the exfiltrated information. In the 2020 version of LEMPO,\nTA456 sent from a Yandex account to a Tutanota email account. Notably, the Yandex email\nwithin the 2020 version of the LEMPO implant masqueraded as large technology company\nfocused on supporting the energy industry. After exfiltrating the information,\nLEMPO sleeps for 30 seconds and then deletes both Logs.txt and Logs.zip.\n\n## There’s Something About Marcy\n\n“Marcella (Marcy) Flores” was conversing with the targeted aerospace employee since at\nleast November 2020 and was friends with them on social media since at least 2019. Besides\nthe Gmail account used for attempted malware delivery, Marcella maintained a now\n[suspended Facebook profile.](https://web.archive.org/web/*/https:/www.facebook.com/marcella.flores.14019)\n\n\n-----\n\n_Figure 4._\n\nOpen-source research indicates “Marcella” interacted with TA456’s target on social media\nstarting in late 2019. The earliest publicly available Facebook profile photo of “Marcella” was\nuploaded on May 30, 2018. Proofpoint’s analysis indicates the profile bears strong similarities\nto fictitious profiles previously used by Iranian APTs to socially engineer targets of intelligence\nvalue. The “Marcella” profile appeared to be friends with multiple individuals who publicly\nidentify as defense contractor employees and who are geographically dispersed\nfrom “Marcella’s” alleged location in Liverpool, UK. On July 15, 2021, Facebook\nannounced they had disrupted a network of Facebook and Instagram personas, including\n“Marcella’s,” they attributed to the Iranian-aligned actor.\n\n## Targets\n\nTA456 routinely conducts reconnaissance campaigns disguised as news related spam that\ntarget individuals employed by aerospace defense contractors. The targeting of U.S. defense\ncontractors, particularly those supporting contracts in the Middle East, is consistent with\nhistorical Iranian cyber activity. Additionally, Proofpoint has\nobserved TA456 targeting individuals employed at multiple subcontractors and subsidiaries of\nlarger defense companies. This is possibly an effort to target the primary contractor via less\nsecure downstream component suppliers that share a network environment. Opensource research indicated the individual targeted by “Marcella” in this campaign works as\na supply chain manager. This is consistent with TA456’s TTP of targeting\nbusiness and information technology-related individuals within their target organization.\n\n## Attribution\n\nProofpoint attributes this campaign to TA456, an Iranian-aligned adversary focused on\nespionage efforts against defense industrial base employees and contractors, particularly\nthose supporting efforts in the Middle East. TA456 overlaps with activity tracked as\n[Tortoiseshell, and Imperial Kitten. On July 15, 2021, Facebook attributed a portion of](https://about.fb.com/news/2021/07/taking-action-against-hackers-in-iran/)\nTortoiseshell’s activity to Mahak Rayan Afraz (MRA), an Iranian IT company with ties to the\nIRGC. Based on previous malware analysis and historical open-source research, Proofpoint\nconcurs with this attribution.\n\n[Additionally, LEMPO shares multiple similarities with Tortoiseshell’s Liderc, including](https://blog.talosintelligence.com/2019/09/tortoiseshell-fake-veterans.html)\nextensive machine reconnaissance, exfiltration via email, hardcoded email addresses with\nsimilar formatting, and overall pattern of targeting companies and individuals aligned with the\nAmerican defense industrial base.\n\n## Outlook\n\nTA456 demonstrated a significant operational investment by cultivating a relationship with\na target’s employee over years in order to deploy LEMPO to conduct reconnaissance into a\nhighly secured target environment within the defense industrial\n\n\n-----\n\nbase. Facebook s announcement demonstrated TA456 had established an extensive network\nof these personas dedicated to enabling cyberespionage operations. While Proofpoint did not\nobserve the delivery of any remote access trojans or command and\ncontrol channels like TA456’s [Syskit, the information potentially gathered by LEMPO could be](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/tortoiseshell-apt-supply-chain)\noperationalized in a variety of ways. These include the utilization of stolen VPN credentials,\nexploitation of vulnerabilities in the identified software, or the customization of more\nadvanced malware delivered from “Marcella.”\n\nTA456’s dedication to significant social engineering engagement, benign reconnaissance of\ntargets prior to deploying malware, and their cross platform kill chain establish TA456 to be\none of the most resourceful Iranian-aligned threats tracked by Proofpoint. The “Marcella\nFlores” persona is likely not the only one in use by TA456, making it important for those\nworking within or tangentially to the defense industrial base to be vigilant when engaging\nwith unknown individuals regardless of whether it is via work or personal accounts.\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-07-28 - I Knew You Were Trouble- TA456 Targets Defense Contractor with Alluring Social Media Persona.pdf"
    ],
    "report_names": [
        "2021-07-28 - I Knew You Were Trouble- TA456 Targets Defense Contractor with Alluring Social Media Persona.pdf"
    ],
    "threat_actors": [
        {
            "id": "84a3dd71-1d65-4997-80fc-7fbe55b267f2",
            "created_at": "2023-04-26T02:03:02.969306Z",
            "updated_at": "2025-03-27T02:00:55.450032Z",
            "deleted_at": null,
            "main_name": "CURIUM",
            "aliases": [
                "CURIUM",
                "Crimson Sandstorm",
                "TA456",
                "Tortoise Shell",
                "Yellow Liderc"
            ],
            "source_name": "MITRE:CURIUM",
            "tools": [
                "IMAPLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3ce91297-e4c0-4957-8dd7-9047a3e23dc7",
            "created_at": "2023-01-06T13:46:39.054248Z",
            "updated_at": "2025-03-27T02:00:02.985963Z",
            "deleted_at": null,
            "main_name": "Tortoiseshell",
            "aliases": [
                "IMPERIAL KITTEN",
                "Yellow Liderc",
                "Imperial Kitten",
                "TA456",
                "DUSTYCAVE",
                "Crimson Sandstorm"
            ],
            "source_name": "MISPGALAXY:Tortoiseshell",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "583cdac5-eb9d-46e9-a0f9-7594c4b18281",
            "created_at": "2024-05-01T02:03:08.017491Z",
            "updated_at": "2025-03-27T02:05:17.30797Z",
            "deleted_at": null,
            "main_name": "COBALT FIRESIDE",
            "aliases": [
                "CURIUM ",
                "DEV-0228 ",
                "HIVE0095 ",
                "Imperial Kitten ",
                "TA456 ",
                "Tortoiseshell ",
                "UNC3890 ",
                "Yellow Liderc ",
                "Crimson Sandstorm "
            ],
            "source_name": "Secureworks:COBALT FIRESIDE",
            "tools": [
                " LEMPO",
                " LiderBird",
                "FireBAK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b5b24083-7ba6-44cc-9d11-a6274e2eee00",
            "created_at": "2022-10-25T16:07:24.337332Z",
            "updated_at": "2025-03-27T02:02:10.177597Z",
            "deleted_at": null,
            "main_name": "Tortoiseshell",
            "aliases": [
                "Crimson Sandstorm",
                "Curium",
                "Houseblend",
                "Imperial Kitten",
                "Marcella Flores",
                "Operation Fata Morgana",
                "TA456",
                "Yellow Liderc"
            ],
            "source_name": "ETDA:Tortoiseshell",
            "tools": [
                "IMAPLoader",
                "Infostealer",
                "IvizTech",
                "LEMPO",
                "MANGOPUNCH",
                "SysKit",
                "get-logon-history.ps1",
                "liderc",
                "stereoversioncontrol"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bdbf873a-048d-4c5d-9d92-922327cc83a8",
            "created_at": "2023-01-06T13:46:39.387696Z",
            "updated_at": "2025-03-27T02:00:03.071819Z",
            "deleted_at": null,
            "main_name": "DEV-0586",
            "aliases": [
                "Ruinous Ursa",
                "Cadet Blizzard"
            ],
            "source_name": "MISPGALAXY:DEV-0586",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535827,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1653754015,
    "ts_modification_date": 1653754015,
    "files": {
        "pdf": "https://archive.orkl.eu/dc950fa74b958428ce215f19fee59d86a1643eb5.pdf",
        "text": "https://archive.orkl.eu/dc950fa74b958428ce215f19fee59d86a1643eb5.txt",
        "img": "https://archive.orkl.eu/dc950fa74b958428ce215f19fee59d86a1643eb5.jpg"
    }
}