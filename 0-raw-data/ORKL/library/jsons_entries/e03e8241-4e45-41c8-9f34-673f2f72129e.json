{
    "id": "e03e8241-4e45-41c8-9f34-673f2f72129e",
    "created_at": "2023-01-12T15:07:32.344961Z",
    "updated_at": "2025-03-27T02:05:56.87723Z",
    "deleted_at": null,
    "sha1_hash": "0335445e0319d32b055d4ce1aff20cd5765085f3",
    "title": "2020-01-07 - Hold My Beer Mirai – Spinoff Named ‘LiquorBot’ Incorporates Cryptomining",
    "authors": "",
    "file_creation_date": "2022-05-27T19:59:30Z",
    "file_modification_date": "2022-05-27T19:59:30Z",
    "file_size": 621130,
    "plain_text": "# Hold My Beer Mirai – Spinoff Named ‘LiquorBot’ Incorporates Cryptomining\n\n**[labs.bitdefender.com/2020/01/hold-my-beer-mirai-spinoff-named-liquorbot-incorporates-cryptomining/](https://labs.bitdefender.com/2020/01/hold-my-beer-mirai-spinoff-named-liquorbot-incorporates-cryptomining/)**\n\n[Anti-Malware Research](http://10.10.0.46/blog/labs/tag/antimalware-research/)\n\n5 min read\n\n[Liviu ARSENE](http://10.10.0.46/blog/labs/author/larsene/)\nJanuary 07, 2020\n\nOne product to protect all your devices, without slowing them down.\n\n[Free 90-day trial](http://10.10.0.46/media/html/consumer/new/get-your-90-day-trial-opt/index.html)\n\n\n-----\n\nHold My Beer Mirai – Spinoff Named LiquorBot Incorporates Cryptomining\n\n\n-----\n\nThe Mirai botnet that made headlines in 2016 for taking out infrastructure through largescale network attacks has become a reference point in the security industry for the damage\nthat large IoT botnets can inflict. Since its source code was published and made available to\nanyone interested in building their own botnet, many Mirai variants have shown up, each\npacking unique features. While most are used for disruptive purposes, others seem to use\nthe collective power of compromised devices to mine for cryptocurrency.\n\nBitdefender researchers tracked the development of a Mirai-inspired botnet, dubbed\nLiquorBot, which seems to be actively in development and has recently incorporated\nMonero cryptocurrency mining features.\n\nInterestingly, LiquorBot is written in Go (also known as Golang), which offers some\nprogramming advantages over traditional C-style code, such as memory safety, garbage\ncollection, structural typing, and even CSP-style concurrency.\n\nLiquorBot appears to use the same command and control server as a Mirai-related variant,\nand they have even featured together in dropper scripts, meaning attackers used both\nLiquorBot and the Mirai variant in various campaigns.\n\nThe LiquorBot IoT botnet was identified using Bitdefender’s deceptive technologies, when\nthe first LiquorBot samples infected our honeypots in May 2019. Since then, Bitdefender\nsecurity researchers tracked the development of the main package, as well as all its other\nversions associated with feature updates and upgrades.\n\n**Key Findings**\n\nRe-implementation of Mirai written in Go\nCross-compiled to several architectures (ARM, ARM64, x86, x64, MIPS)\nIncorporates cryptocurrency-mining features\nPropagation through SSH brute-forcing and exploitation of unpatched vulnerabilities in\nselect router models\n\n**Timeline**\n\nThe following table (Fig. 1) follows the evolution of the botnet, listing SHA-1 hashes, the\ndevelopment path of the main package and the date they were first seen by our honeypots\ntelemetry. Though each version has samples associated to multiple CPU architectures, for\nsimplicity, we have included only hashes for ARM64.\n\n\n-----\n\nFig. 1 – Timeline of LiquorBot sample\nWhile some of the samples analyzed include versioning strings, they do not seem to\naccurately reflect the evolution of the botnet. For instance, the Oct 1 sample is labeledst\n“0.2” and it’s the one actually introducing the cryptocurrency mining feature. This feature is\nnot present in the July 24 sample, labeled “0.6”, which features additional propagationth\nmethods.\n\n**Dropper Script**\n\nLiquorBot is cross-compiled to several architectures, targeting a wide range of CPU\narchitectures ranging from ARM and ARM64 to x86, x64 and MIPS. During the infection\nprocess, the dropper script downloads all the bot payloads, without having any filtration\nlogic based on the found CPU architecture.\n\nThe dropper script itself is relatively short and involves fetching the binaries from an\nattacker-controlled server. Another interesting feature of the script is the use of “#!/bin/sh”,\nwhich is more reliable than “#!/bin/bash” when pointing to the preferred POSIX-compatible\nsystem shell in any installation. In addition, because the script does not appear to load any\nspecific features supported by “bash”, the “sh” variant chosen by the malware developers is\nconsidered the default shell that system scripts should use.\n\n\n-----\n\nFig. 2 – Dropper code\nThe miner configuration script used by threat actors seems to set different hashrates for the\nCPU mining algorithm (Fig. 3)\n\n\n-----\n\nFig. 3 – Miner configuration code\n\n**Features**\n\nLike Mirai, LiquorBot obfuscates its strings and stores them into a map. Each time an entry\ndis accessed, the string is decrypted by adding the vadlue 0x51 to each character. The\nfigure below lists the decrypted strings for LiquorBot.\n\n\n-----\n\nFig. 4 – LiquorBot strings map\nAnother feature borrowed from Mirai ensures that a single bot runs on a machine by\nattempting to bind to a port. The host and port used as arguments to “net.Listen” are from\nthe configuration map (entry number 9). Other versions of the bot have the port set to\n42007.\n\nFig. 5 – Infection command\nUpon execution, the bot relaunches itself, while attempting to disguise the new process as\nthe sshd daemon.\n\nThe bot updates the DNS resolver by writing to /etc/resolv.conf the following:\n\nFig. 6 – DNS Namesevers\n\n\n-----\n\nThe bot s lifecycle contains a cleanup phase, in which it deletes any dropped files\n(/tmp/.lmr,/tmp/.ldrop, /tmp/config.json) and erases bash history.\n\nThe bot communicates with multiple servers:\n\nCnC; the bot reports vulnerable devices to this server and receives commands from it\nmining server\nserver hosting the binaries\n\nThroughout its evolution, the domains used for these purposes have been changed and\ninterchanged from the following:\n\nwpceservice.hldns.ru\nardp.hldns.ru\nbpsuck.hldns.ru\n\nLiquorBot periodically pings its C&C though a HTTP GET targeting this resource:\n\nFig. 7 – LiquorBot C&C resource\nThe query parameters represent fingerprinting data for the device and bot: OS, bot version,\nCPU architecture, number of CPUs, etc.\n\nThe C&C can respond with one of the following commands:\n\ndownload\nrget\nexec\nshutdown\n\nThe first command downloads a resource from a provided URL into /tmp/.ldrop. The second\ncommand does the same, but also executes the file using “sh -c”.\n\nThe miner goroutine downloads the miner into /tmp/.lmr, formats the config and writes it to\n/tmp/config.json, then runs the miner with the config. The config is the JSON found in the\nconfiguration map formatted to fill out the server with the address of the mining server (entry\n2 for host and entry 3 for port) and the username (randomly generated string formed of 17\nuppercase letters).\n\n**Propagation**\n\nAmong the analyzed LiquorBot samples, we have seen various methods of propagation.\nMost versions use SSH brute-forcing as the sole propagation method.\n\n\n-----\n\nThe samples from July 24th include SSH brute-forcing, by using a hardcoded list of 82\nusername/password combinations, while also using exploits for various models of\nvulnerable routers.\n\nIn terms of exploited vulnerabilities, LiquorBot exploits some critical CVEs (CVE-2015-2051,\nCVE-2016-1555, CVE-2016-6277) as well as a series of command injection and remote\ncommand execution vulnerabilities found in various router models (CVE-2018-17173, CVE2017-6884, CVE-2018-10562, CVE-2017-6077, CVE-2017-6334, CVE-2016-5679, CVE2018-9285, CVE-2013-3568, CVE-2019-12780).\n\n**IoCs**\n\n**Hashes:**\n```\n14592719e2a354633131bc238f07aa0cb9cce698 \n1611a8445085d1687c72b7e5a7c5602cbe580c8b \n1f15195ddc1e4174674fbf5d1fc95ed0a7726f7b \n2784a122089c20d5c02665da1241fe02f9ac90cc \n2901d4ee7f289bf0b1a863bec716d751f66a4324 \n2d1d294aac29fab2041949d4cb5c58d3169a31d3 \n31176239ab5187af5d89666f37038340b95a5a4e \n31d9ca734c5f4c1787131d3a1b6b91ca60e57794 \n331ec23c250b86d912fa34e0e700bfcac1a7c388 \n3453a96414e63a813b82c6d98fa3b76c1824abd8 \n36382165bb53a7ed9387a02e5b9baee36fe23f64 \n48c863e4ad23fb946386320f3a85391b54ba50ad \n49602256c8d65d0620d5abe8011a78425c7ae177 \n54bdfa936c9eb4ea329ca35b95e471d51daef1d5 \n5821ff8eb9b23035a520e1fb836e43b1ec87ffaf \n61abc90c20930c7615880ac9931778b48b9e6ebd \n63b556a0afcf643337310254cc7f57c729188f36 \n65cd6a0371bdfffd7383907ba9a816e8e2e95da5 \n6c7a92d5d68b68ddba10af7ca6350cfb24b2595f \n6d24c472b06e6f9ac3204ca768319d2b035a210a \n8364c272e0c95ed214c71dbcb48f89c468544bc8 \n8df16857cb914f5eded0249cfde07f1c01697db1 \na69f9f5f2ac15aec393ab68277ec268c0624fe91 \nb40f4f13b2b144946b165a2e4284c96fbc0d4682 \nb9dd4d230d103b3db458d752d4917466ec1cb9b0 \nba55d92e3d7dba70205597433f1a98b35e4911b8 \nbb07341ab6b203687845ae38cd8c17dfc947e79f \nc59dd90f7cefadaa80d9c0113f8af39e4ed0c1a1 \nc5adabbdbf641f3e53e3268af60ac1b26088aa6b \nc6d850e264d7d8d6978cd85d69c22b29378e34e4 \nc7ed7241e2d21fa471b6bfd6b97b24b514b3c5f2 \nd216f33695421dfb17e69ed05aec46cf84b544b7 \nd59175ffacd8895362253a3bcb18637ced765fcd \nd62cdd8f16a8f6b6cde5e8da633c224eab4765f2 \ne91f2d5df4ef43cb4c69b15de9a68c7ff2d4951d \nfd65e6c5ae07c50c7d7639e2712c45324d4cf8de\n\n```\n**Related domains:**\n\n\n-----\n\n```\nardp.hldns.ru \nbpsuck.hldns.ru \nWpceservice.hldns.ru\nsystemservice.hldns.ru\n\n```\n_Note: The information in this article was made available courtesy to Bitdefender research_\n_team._\n\n**TAGS**\n\n[anti-malware research](http://10.10.0.46/blog/labs/tag/antimalware-research/)\n\n**AUTHOR**\n\n## Liviu ARSENE\n\nLiviu Arsene is the proud owner of the secret to the fountain of never-ending energy. That's\nwhat's been helping him work his everything off as a passionate tech news editor for the\npast few years.\n\n[View all posts](http://10.10.0.46/blog/labs/author/larsene/)\n\n\n## Liviu ARSENE\n\nLiviu Arsene is the proud owner of the secret to the fountain of never-ending energy. That's\nwhat's been helping him work his everything off as a passionate tech news editor for the\npast few years.\n\n[View all posts](http://10.10.0.46/blog/labs/author/larsene/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-07 - Hold My Beer Mirai – Spinoff Named ‘LiquorBot’ Incorporates Cryptomining.pdf"
    ],
    "report_names": [
        "2020-01-07 - Hold My Beer Mirai – Spinoff Named ‘LiquorBot’ Incorporates Cryptomining.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536052,
    "ts_updated_at": 1743041156,
    "ts_creation_date": 1653681570,
    "ts_modification_date": 1653681570,
    "files": {
        "pdf": "https://archive.orkl.eu/0335445e0319d32b055d4ce1aff20cd5765085f3.pdf",
        "text": "https://archive.orkl.eu/0335445e0319d32b055d4ce1aff20cd5765085f3.txt",
        "img": "https://archive.orkl.eu/0335445e0319d32b055d4ce1aff20cd5765085f3.jpg"
    }
}