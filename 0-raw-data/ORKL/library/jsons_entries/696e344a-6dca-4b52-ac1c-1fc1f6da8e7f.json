{
    "id": "696e344a-6dca-4b52-ac1c-1fc1f6da8e7f",
    "created_at": "2023-01-12T15:09:29.201921Z",
    "updated_at": "2025-03-27T02:16:59.226555Z",
    "deleted_at": null,
    "sha1_hash": "d8a5a5bf1cc213272d438659792d31a994f4b858",
    "title": "2017-02-14 - REMCOS- A New RAT In The Wild",
    "authors": "",
    "file_creation_date": "2022-05-27T21:07:52Z",
    "file_modification_date": "2022-05-27T21:07:52Z",
    "file_size": 2167479,
    "plain_text": "# REMCOS: A New RAT In The Wild\n\n**[blog.fortinet.com/2017/02/14/remcos-a-new-rat-in-the-wild-2](https://blog.fortinet.com/2017/02/14/remcos-a-new-rat-in-the-wild-2)**\n\nThreat Research\n\nBy [Floser Bacurio and](https://blog.fortinet.com/blog/search?author=Floser+Bacurio) [Joie Salvio | February 14, 2017](https://blog.fortinet.com/blog/search?author=Joie+Salvio)\n\n\nFebruary 14, 2017\n\n\n[Remcos is another RAT (Remote Administration Tool) that was first discovered being sold in](https://blog.fortinet.com/2016/08/29/german-speakers-targeted-by-spam-leading-to-ozone-rat)\nhacking forums in the second half of 2016. Since then, it has been updated with more\nfeatures, and just recently, we’ve seen its payload being distributed in the wild for the first\ntime.\n\nThis article demonstrates how this commercialized RAT is being used in an attack, and what\nits latest version (v1.7.3) is capable of doing. Remcos is currently being sold from $58 to\n$389, depending on the license period and the maximum number of masters or clients\nneeded.\n\n## Macro Executes Malware with High System Privilege\n\n\n-----\n\nWe discovered that the Remcos RAT is being distributed through malicious Microsoft Office\ndocuments going by the filenames of Quotation.xls or Quotation.doc, which are most\nprobably attached to SPAM emails. The structure and behavior of these documents are very\n[similar to the ones that we documented in our previous article, which details a malicious](https://blog.fortinet.com/2016/12/16/malicious-macro-bypasses-uac-to-elevate-privilege-for-fareit-malware)\ndocument macro designed to bypass Microsoft Windows’ UAC security and execute malware\nwith high privilege.\n\n_Figure 1: Malicious MS Office documents_\n\nThe affected documents contain an obfuscated macro that executes a shell command that\ndownloads and runs the malware. Its obfuscation is simply achieved by adding garbage\ncharacters to the actual string.\n\nTo execute the downloaded malware with high system privilege, it utilizes an already known\nUAC-bypass technique. It attempts to execute it under Microsoft’s Event Viewer\n(eventvwr.exe) by hijacking a registry (HKCU\\Software\\Classes\\mscfile\\shell\\open\\command\n) that it queries to find the path of the Microsoft Management Console (mmc.exe). The Event\nViewer simply executes whatever is in that path. Since the macro’s shell command replaces\nthe value from that registry entry to the malware’s location, the malware is executed instead\nof the legitimate mmc.exe.\n\n\n-----\n\n_Figure 2: Execution of the malware from macro_\n\nIn figure 2 we can see that when the command shell executed the downloaded malware, the\nintegrity level was unexpectedly only set to “Medium.” At this point, the UAC bypass should\nhave worked and the malware should have been executed with “High” integrity. So we took a\ncloser look at the shell command and found erroneous slashes (“\\”) in the registry path that\ncaused the unsuccessful replacement of the registry value data. It was first thought that the\ntechnique worked, since the malware was executed with a “High” integrity level in the end.\nHowever, it was not executed under the Event Viewer. Since that attempt did not work, and\nyet the malware was still executed with “High” integrity level, we suspected that the malware\nbinary itself has its own UAC-bypass technique, which was proven to be the case, as we\ndemonstrate in the later part of this article.\n\n## Multi-packed Payload Binary\n\nRemcos only includes UPX and MPRESS1 packers to compress and obfuscate its server\ncomponent. In this sample, however, the attacker went further by adding another layer of\ncustom packer on top of MPRESS1.\n\n\n-----\n\n_Figure 3: Hex dumps of the packed and unpacked server component_\n\nObfuscation of the malware practically ended after the two packers. As seen in the\nscreenshots below, the strings from the unpacked binary reveals that it’s the server\ncomponent built from the latest Remcos v1.7.3 Pro. According to their website, Breaking_Security[.]Net, this version was just released in Jan. 23, 2017._\n\n_Figure 4: Un-obfuscated strings identifying the Remcos server component_\n\nNumerous commands that the server can carry out can also be seen in plain text.\n\n\n-----\n\n_Figure 5: Snippet of some commands_\n\nFiguring out all the commands through code analysis is tedious work. Fortunately, their\nwebsite allows anyone to download a stripped down version of the Remcos client for free.\n\n## Remcos v.1.7.3 and its Capabilities\n\nThe Remcos Client has five main tabs with different specific functions. Although most of the\nparameters are disabled in the free version, we were able to simulate its client-server\nconnection.\n\nThe Connections Tab is where all the active connections can be monitored. Each entry\ncontains some basic information about the installed server component and the infected\nsystem. This is also the main tab for sending commands to the infected system. The image\nbelow shows the list of commands that can be executed in the infected system. It illustrates\n\n\n-----\n\nhow much control the attacker can gain over an infected system. Most of them are fairly\ncommon with RAT applications, and as usual some of the commands may lean more\ntowards intrusive spying than consented monitoring.\n\n_Figure 6: REMCOS command list_\n\n_Automatic Tasks is probably the most interesting feature of Remcos, as we haven’t seen_\nanything like it on other RATs. This feature configures the server component to automatically\nexecute functions without any manual action from the client once a connection has been\nestablished. This makes it easy and convenient to create an infiltrate-exfiltrate-exit scheme\nwithout any trigger from the attacker, which is just how a common spyware or malware\ndownloader behaves.\n\n\n-----\n\n_Figure 7: Automatic Tasks tab_\n\nThe Local Settings tab consists of settings for the client side. Ports where the client machine\nwaits for a connection from its servers are set here, together with the passwords to be used.\nSince Remcos uses the password for encryption, the listening port and the connecting server\nshould have the same passwords for a successful connection. So basically, the password is\nused for both authentication and network traffic encryption.\n\n_Figure 8: Local Settings tab_\n\nRemcos uses a simple RC4 algorithm, using the password as the key to encrypt and decrypt\nnetwork traffic between its client and server.\n\n\n-----\n\n_Figure 9: Uses RC4 algorithm to encrypt network traffic_\n\nThe Builder tab is where the parameters of the created server binary can be customized. It\ncan be divided into several sub-sections, as shown in the image below.\n\n\n-----\n\n_Figure 10: Builder tab sub-sections_\n\n_Connection – sets the client IP addresses and ports where the server connects to upon_\ninstallation. It also allows a password to be set for authentication and encryption.\n\n_Installation – configures the installation path, autorun registries, and a watchdog module that_\nprevents termination of the process and deletion of its files and registries. Also included in\nthis section is the setting for having its own UAC bypass, which we suspected to exist earlier\nin our article.\n\nSo, it is possible that the attacker only used the document macro as a template to download\nand execute the binary, and never intended to use the script’s UAC bypass since the server\nbinary itself already has the same function. In fact, it uses the same UAC bypass technique,\nbut this time with an added routine to revert the modified registry after gaining privilege. This\nis logical, because not restoring the registry can produce system errors that can cause\nsuspicion from the user every time a .msc file needs to be opened.\n\n_Stealth – this section dictates whether the server should appear on the system’s tray icon. It_\nalso includes the settings for some basic anti-analysis/anti-sandbox routines and an option to\nhide the process through injection.\n\n\n-----\n\n_Keylogger – this includes the usual parameters for a basic keylogger function. Interestingly_\nenough, though, it can also provide the server component with a function to remove browser\ncookies and stored passwords. The hope is that that the user will have to re-type their\npasswords when logging in to websites and they can be captured using the keylogger.\n\n_Surveillance – gives the server an option to take periodic screenshots of the system or when_\nspecific windows are active. It also features audio capture, which can be saved locally for\nlater retrieval.\n\n_Build – gives the option to pack the server binary using UPX and MPRESS._\n\nThe Event Log displays connection logs with the server, along with some information\nregarding the client’s status (updates, ports, etc.).\n\n_Figure 11: Event Logs tab_\n\nThe About tab contains acknowledgements and some promotions on other products that\nhave been developed by an author named Viotto.\n\n\n-----\n\n_Figure 12: About tab_\n\n## Conclusion\n\nThis article proves once again that one does not have to be an expert to launch fairly\nsophisticated malware attacks. More and more applications like Remcos are being released\npublicly, luring new perpetrators with their easy usage. And all it takes to be infected by one\nare a few clicks.\n\nAs for many RAT authors, the developer discourages malicious usage of the tool through a\nlicense ban if reported. This in most cases is nothing but a false shield to guard them liability\nwhen the thin veil of its being an administration tool is removed and it is exposed as a fullblown malware builder.\n\n-= FortiGuard Lion Team =\n### Samples (SHA256)\n\nfc0fa7c20adf0eaf0538cec14e37d52398a08d91ec105f33ea53919e7c70bb5a _W32/Remcos.A!tr_\n\n8710e87642371c828453d59c8cc4edfe8906a5e8fdfbf2191137bf1bf22ecf81 _W32/Remcos.A!tr_\n\n8e6daf75060115895cbbfb228936a95d8fb70844db0f57fe4709007a11f4a6bb _WM/Agent.9BF1!tr.dldr_\n\na58a64fce0467acbcaf7568988afc6d2362e81f67fc0befd031d3a6f3a8a4e30 _WM/Agent.9BF1!tr.dldr_\n\n\n-----\n\n### IOC\n\nDownload URL:\n\nlegacyrealestateadvisors[.]net/brats/remmy.exe\n\nC&C:\n\nremcos2.legacyrealestateadvisors[.]net\n\nremcos.legacyrealestateadvisors[.]net\n\nAdded Files (paths can be changed in the builder):\n\n%temp%\\remmy.exe – copy of server\n\n%ProgramFiles%\\AudioHD\\Drivers.dat – keylog data\n\n%ProgramFiles%\\AudioHD\\AudioHD.exe or %ProgramFiles%\\SvchostHD\\svchost.exe –\n_copy of server_\n\nAdded Registries:\n\nKey: HKCU \\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nValue Name: SvchostHD\n\nData: %ProgramFiles%\\SvchostHD\\svchost.exe\n\nOr\n\nKey: HKCU \\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nValue Name: AudioHD\n\nData: %ProgramFiles%\\ AudioHD\\AudioHD.exe\n\nKey: HKCU \\Software\\\nValue Name: EXEpath\n\n### Related Posts\n\nCopyright © 2022 Fortinet, Inc. All Rights Reserved\n\n[Terms of ServicesPrivacy Policy](https://www.fortinet.com/corporate/about-us/legal.html)\n| Cookie Settings\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-02-14 - REMCOS- A New RAT In The Wild.pdf"
    ],
    "report_names": [
        "2017-02-14 - REMCOS- A New RAT In The Wild.pdf"
    ],
    "threat_actors": [
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536169,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653685672,
    "ts_modification_date": 1653685672,
    "files": {
        "pdf": "https://archive.orkl.eu/d8a5a5bf1cc213272d438659792d31a994f4b858.pdf",
        "text": "https://archive.orkl.eu/d8a5a5bf1cc213272d438659792d31a994f4b858.txt",
        "img": "https://archive.orkl.eu/d8a5a5bf1cc213272d438659792d31a994f4b858.jpg"
    }
}