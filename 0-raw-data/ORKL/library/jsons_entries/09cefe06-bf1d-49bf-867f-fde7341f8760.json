{
    "id": "09cefe06-bf1d-49bf-867f-fde7341f8760",
    "created_at": "2022-10-25T16:48:22.635014Z",
    "updated_at": "2025-03-27T02:17:23.257121Z",
    "deleted_at": null,
    "sha1_hash": "aaf7d59ff3499b6a8c078bc790143342f906cb75",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-04-06T10:00:52Z",
    "file_modification_date": "2022-04-06T10:02:35Z",
    "file_size": 11371091,
    "plain_text": "-----\n\n#### TABLE OF CONTENTS\n\n###### I N T R O D U C T I O N            3\n\n M E T H O D O L O G Y            4\n\n T R E N D S  8\n\nIntroduction 9\n\nRansomware 11\n\nSupply chain compromise 14\n\nVulnerabilities 17\n\nAffiliates 21\n\nCrypters-as-a-service 24\n\nCommon web shells 26\n\nUser-initiated initial access 29\n\nMalicious macOS installers 31\n\nRemote monitoring and\nmanagement abuse 32\n\nLinux coinminers **33**\n\nAbusing remote procedure calls 36\n\nDefence validation and testing 39\n\n\n###### T H R E AT S           41\n\nIntroduction 42\n\nTop ten threat highlights 44\n\nCobalt Strike 44\n\nImpacket 47\n\nSocGholish 50\n\nYellow Cockatoo 53\n\nGootkit 56\n\nBloodHound 58\n\nNew activity clusters 60\n\nRose Flamingo 60\n\nSilver Sparrow 63\n\nRelevant threats of 2021 65\n\nBazar 65\n\nLatent threats 66\n\n###### T E C H N I Q U E S  71\n\nSummary of most\nprevalent techniques of 2021 72\n\n###### C O N C L U S I O N  79\n\n\n-----\n\n###### I N T R O D U C T I O N\n\n### Welcome to the 2022 Threat Detection Report\n\nWelcome to Red Canary’s 2022 Threat Detection Report. Based on in-depth\n\nanalysis of over 30,000 confirmed threats detected across our customers’\n\nenvironments, this research arms security leaders and their teams with\n\nactionable insight into the threats we observe, techniques adversaries most\n\ncommonly leverage, and trends that help you understand what is changing\n\nand why. This is our most expansive report to date, but our intention remains\n\nthe same: The Threat Detection Report exists to help you understand and\n\ndetect threats.\n\n###### How to use the report:\n\n- [Start perusing the most prevalent techniques, trends, and threats to see](https://redcanary.com/threat-detection-report/techniques/)\n\nwhat we’ve observed in our customers’ environments.\n\n- Explore how to detect, mitigate, and simulate specific threats\n\nand techniques.\n\n- Talk with your team about how the ideas, recommendations, and priorities\n\nmap to your security controls and your overall strategy.\n\n###### New trends section\n\nRed Canary’s security operations team performs three primary activities:\n\n- Our Intelligence team seeks to identify and understand distinct threats.\n\n- Our Detection Enablement and Detection Engineering teams seek to\n\nunderstand these threats and engineer solutions that reliably detect them\n\nand enable timely investigation.\n\n- Our Incident Handling team is charged with responding to threats before\n\nthey harm customers.\n\nIn each of these areas, we’ve identified trends that help us understand how\n\nthreats are evolving and how we as defenders must evolve in kind. From the\n\ncontinued scourge of ransomware to high-impact vulnerabilities and supply\n\nchain attacks, this section synthesizes intelligence with insights from the front\n\nlines of threat detection and response.\n\n\n###### ACKNO WLEDG EMEN TS\n\nThanks to the 100+ security\n\nexperts, writers, editors, designers,\n\ndevelopers, and project managers who\n\ninvested countless hours to produce\n\nthis report. And a huge thanks to\n\n[the MITRE ATT&CK® team, whose](https://redcanary.com/mitre-attack/)\n\nframework has helped the community\n\ntake a giant leap forward in\n\nunderstanding and tracking adversary\n\nbehaviors. Also a huge thanks to all\n\nthe Canaries—past and present—who\n\nworked on the 2019, 2020, and 2021\n\nThreat Detection Reports. The Threat\n\nDetection Report is iterative, and parts\n\nof the 2022 report are derived from\n\nprevious years.\n\n**This report wouldn’t be**\n**possible without all of you!**\n\n\n-----\n\n## Methodology\n\nSince 2013, Red Canary has delivered high-quality threat detection to\n\norganizations of all sizes. Our platform collects as much as a petabyte of security\n\ntelemetry every day and leverages a library of roughly 3,000 detection analytics\n\nto surface potential threats that are analyzed by our Cyber Incident Response\n\n[Team (CIRT). Confirmed threats are tied to corresponding MITRE ATT&CK®](https://redcanary.com/mitre-attack/)\n\ntechniques and specific threats to help our customers clearly understand what\n\nis happening in their environments. A significant portion of this report is a\n\nsummary of confirmed threats derived from this data.\n\nCreating metrics around techniques and threats is a challenge for any\n\norganization. To help you better understand the data behind this report and\n\nto guide you as you create your own metrics, we wanted to share some details\n\nabout our methodology.\n\n### Behind the data\n\nTo understand our data, you need to understand how we detect malicious\n\nand suspicious behavior in the first place. We gather telemetry from our\n\ncustomers’ environments and feed it through a constantly evolving library of\n\ndetection analytics. Our detection analytics are mapped to one or more ATT&CK\n\ntechniques and sub-techniques, as appropriate. When telemetry matches the\n\nlogic in one of our detection analytics, an event is generated for review by our\n\ndetection engineers.\n\nWhen a detection engineer determines that one or more events for a specific\n\nendpoint surpasses the threshold of suspicious or malicious behavior, they\n\n\n-----\n\ncreate a confirmed threat documenting the activity on that endpoint. These\n\nconfirmed threats inherit the ATT&CK techniques that were mapped to the\n\nanalytics that first alerted us to the malicious or suspicious behaviors.\n\nIt’s important to understand that the techniques and sub-techniques we’re\n\ncounting are based on our analytics—and not on the individual review\n\nperformed by our detection engineers, during which they add more context to\n\ndetections. We’ve chosen this approach to maximize efficiency and consistency.\n\nHowever, the limitation of this approach is that context gleaned during the\n\ninvestigation of a threat does not inform its technique mapping,\n\nand by extension, some small percentage of threats may be mapped incorrectly\n\nor incompletely. That said, we continually review these confirmed threats,\n\nand we do not believe that there are a significant number of mapping errors in\n\nour dataset.\n\n###### How do you count? \n\nYou may be wondering how we tally the scores for the Threat Detection Report.\n\nOur methodology for counting technique prevalence has largely remained\n\nconsistent since our first Threat Detection Report in 2019. For each malicious\n\nor suspicious detection we published during the year, we incremented the\n\ncount for each technique reflected by a detection analytic that contributed\n\nto that detection (excluding data from detections of unwanted software). If\n\nthat detection was remediated and the host was reinfected at a later date, a\n\nnew detection would be created, thus incrementing the counts again. While\n\nthis method of counting tends to overemphasize techniques that get reused\n\nacross multiple hosts in a single environment (such as when a laterally moving\n\nadversary generates multiple detections within a single environment), this\n\ngives appropriate weight to the techniques you are most likely to encounter\n\nas a defender.\n\nFor the purposes of this report, we decided to set our rankings based on\n\ntechniques, even though the majority of our analysis and detection guidance will\n\nbe based on sub-techniques. This seemed to be the most reasonable approach,\n\nconsidering the following:\n\n- Sometimes we map to a technique that doesn’t have sub-techniques\n\n- Sometimes we map to sub-techniques\n\n- Sometimes we map generally to a technique but not to its sub-techniques\n\nIn cases where a parent technique has no subs or subs that we don’t map to, we\n\nwill analyze the parent technique on its own and provide appropriate detection\n\nguidance. However, in cases where sub-technique detections are rampant for\n\na given parent technique, we will focus our analysis and detection guidance\n\n\n-----\n\nentirely on sub-techniques that meet our requirements for minimum detection\n\nvolume. To that point, we decided to analyze sub-techniques that represented\n\nat least 20 percent of the total detection volume for a given technique. If no\n\nsub-technique reached the 20 percent mark, then we analyzed the parent.\n\n###### What about threats?\n\nOur Intelligence team seeks to provide additional context about threats to\n\nhelp improve decision-making. By understanding what threats are present\n\nin a detection, customers can better understand how they should respond.\n\nThroughout 2021, the Intelligence team sought to improve how we identified\n\nand associated threats in detections. We chose to define “threats” broadly as\n\nmalware, tools, threat groups, or activity clusters. We took two main approaches\n\nto associating a detection to a threat: automatically associating them based on\n\npatterns identified for each specific threat and manually associating them based\n\non analysts’ assessments conducted while reviewing each detection.\n\nIn contrast to our technique methodology, we counted threats by the unique\n\nenvironments affected. Whereas for techniques we counted multiple detections\n\nwithin the same customer environment as distinct tallies, for threats we\n\ndecided to only count by the number of customers who encountered that threat\n\nduring 2021. This is due to the heavy skew introduced by incident response\n\nengagements for laterally moving threats that affect nearly every endpoint in an\n\nenvironment (think ransomware).\n\nHad we counted threats by individual detections, ransomware—and the\n\nlaterally moving threats that lead up to it (e.g., Cobalt Strike)—would have\n\nbeen disproportionately represented in our data. We believe our approach to\n\ncounting gives an appropriate measure of how likely each threat is to affect\n\nany given organization, absent more specific threat modeling details for that\n\norganization. It also serves as a check against the acknowledged bias in the way\n\nwe count technique prevalence.\n\n###### Limitations\n\nThere are a few limitations to our methodology for counting threats, as there are\n\nfor any approach. Due to the nature of our visibility (i.e., that we predominantly\n\n[leverage endpoint detection and response data), our perspective tends to](https://redcanary.com/solutions/endpoint-detection-and-response/)\n\nweigh more heavily on threats that made it through the external defenses—such\n\nas email and firewall gateways—and were able to gain some level of execution\n\non victim machines. As such, our results are likely different than what you may\n\nsee from other vendors focused more on network or email-based detection.\n\nWhile the top threats are worth focusing on, they are not the only threats\n\nto consider, since other impactful ones may be unidentified and therefore\n\n\n-----\n\nunderreported. The analysis and detection guidance in this report is reflective\n\nof the overall landscape, and, if implemented, offers a great deal of defense-in\ndepth against the threats that most organizations are likely to encounter.\n\nKnowing the limitations of any methodology is important as you determine\n\nwhat threats your team should focus on. While we hope our top 10 threats and\n\ndetection opportunities help you and your team prioritize, we recommend\n\nbuilding your own threat model by comparing the top threats we share in\n\nour report with what other teams publish and what you observe in your\n\nown environment.\n\n\n-----\n\n-----\n\n## Trends\n\nRed Canary performed an analysis of emerging and significant trends that we’ve\nencountered in confirmed threats, intelligence reporting, and elsewhere over\nthe past year. We’ve compiled the most prominent trends of 2021 in this report\nto show major themes that may continue into 2022.\n\n[The technique and threat sections of this report are focused on detection data](https://redcanary.com/threat-detection-report/techniques/)\nand identifying prevalent ATT&CK techniques and threats in those detections.\nThe trends section takes us one step beyond that data and allows us to narrate\nevents that might not be prevalent but may be emergent or otherwise deserve\nyour attention.\n\n###### How to use our analysis\n\nThe next page highlights the most prevalent threats occurring in our customer\nenvironments, so we can assume they are prevalent elsewhere. We include\nadvice for responding to each threat and offer detection opportunities so you\ncan better defend your organization. Some defenders may be able to take our\ndetection guidance and apply it directly, while others may not. Regardless,\ndefenders without a detection engineering function can still make use of the\nactionable analysis of each threat written by our Intelligence team experts.\n\n\n-----\n\n###### Vulnerabilities\n\nAdversaries exploited\nvulnerabilities affecting\npopular enterprise platforms\nto drop web shells, spread\nransomware, and more.\n\n\n###### Ransomware\n\nRansomware continued to\ndominate the 2021 threat\nlandscape, and we observed\noperators take new\napproaches.\n\n\n###### Supply chain  compromises\n\nSupply chain compromises were\na major theme, starting with\nSolarWinds, Kaseya and NPM\npackage compromises mid-year,\nand ending with Log4j.\n\n\n###### Affiliates\n\nThe threat landscape continued\nits trend toward a softwareas-a-service (SaaS) economy,\nmuddying the already murky\nwaters of attribution.\n\n\n###### Crypters-as-a-service\n\nCrypters like HCrypt and Snip3\njoined the ranks of other “as-aservice” threats.\n\n\n###### Common web shells\n\nAdversaries exploited web\napplications with help from\nweb shells such as China\nChopper, Godzilla, and\nBehinder.\n\n\n###### User-initiated  initial access\n\nWe observed an uptick in\nthreats that occurred after\nusers sought out content\nwhich, often unbeknownst\nto them, was malicious.\n\n\n###### Malicious macOS  installers\n\nMalicious installers led to\nrotten Apples and adware, as\nmacOS systems continued to\nbe targeted.\n\n\n###### Remote monitoring and management abuse\n\nAdversaries continued to use\nand abuse legitimate remote\nmonitoring and management\n(RMM) software to move data\nand control infected hosts.\n\n\n###### Linux coinminers\n\nCoinminers once again\ndominated the Linux\nthreat landscape.\n\n\n###### Abusing remote  procedure calls\n\nIntrusions leveraging remote\nprocedure calls (RPC) made\nwaves, particularly PetitPotam\nand PrintNightmare.\n\n\n###### Defense validation  and testing\n\nConfirmed testing comprised\nalmost one quarter of our\ndetections in 2021, with many\ncoming from open source tools.\n\n\n-----\n\n###### TR END\n\n## Ransomware\n\n###### Ransomware continued to dominate the 2021 threat landscape, with operators taking new approaches.\n\nThroughout 2021, ransomware remained one of the top threats to every\n\norganization. While some groups focused on traditional encryption, 2021 also\n\nmarked the rise of additional tactics such as double extortion, which amplifies\n\nan adversary’s leverage and further compels victims to pay up. Ransomware has\n\nbecome particularly challenging to track and prevent due to several trends we\n\nobserved in 2021, discussed below.\n\n###### The affiliate model\n\nOne challenge in responding to ransomware intrusions is that different\n\nadversaries are often involved at different phases of the intrusion. Ransomware\n\ngroups usually rely on multiple affiliates to give them initial access to an\n\nenvironment before they encrypt files or take other actions. This makes tracking\n\nransomware groups even more difficult, as intrusions can be a “mix and match”\n\nof different affiliates providing access to different ransomware groups.\n\nRed Canary carefully tracks affiliates of ransomware groups and the malware\n\nthey use, since these adversaries are the ones who sometimes gain initial access\n\n[to an environment. These affiliates frequently use crimeware such as Bazar](https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/)\n\n[and Qbot to gain initial access to an environment, later passing off access to](https://redcanary.com/threat-detection-report/threats/qbot/)\n\nransomware groups. A few common combinations of malware and ransomware\n\nwe observed in 2021 include:\n\n**MALWARE FAMILY (PRECURSOR)** **RANSOMWARE GROUP**\n\nQbot Egregor\n\nQbot Sodinokibi/REvil\n\nQbot Conti\n\nBazar Conti\n\nIcedID Conti\n\n|MALWARE FAMILY (PRECURSOR)|RANSOMWARE GROUP|\n|---|---|\n|Qbot|Egregor|\n|Qbot|Sodinokibi/REvil|\n|Qbot|Conti|\n|Bazar|Conti|\n\n\n-----\n\n###### Some things change, but some things  stay the same\n\nChallenges in understanding the ransomware landscape are not limited\n\nto tracking affiliates and payloads. Defenders must also contend with new\n\ngroups emerging and others seemingly disappearing (often to be reincarnated\n\nin a different form as another group). Some of the ransomware families we\n\nbid farewell to in 2021 were Egregor, Sodinokibi/REvil, BlackMatter, and\n\nDoppelpaymer. While some seemed to fade away due to law enforcement\n\nactions, others disappeared for reasons that researchers haven’t pinned down.\n\nWhere one ransomware family disappeared, however, another was ready to\n\nstep into its place. 2021 saw the dawn of many new ransomware families,\n\n[including BlackByte, Grief, Hive, Yanluowang, Vice Society, and CryptoLocker/](https://redcanary.com/blog/blackbyte-ransomware/)\n\nPhoenix Locker. Many new ransomware families displayed close similarities\n\nto old families that “disappeared,” leading analysts to assess that known\n\n[adversaries simply resurfaced using a new name. For example, Grief](https://redcanary.com/blog/grief-ransomware/)\n\n**[ransomware displayed many similarities to Doppelpaymer, including its](https://redcanary.com/blog/grief-ransomware/)**\n\ndeployment following Dridex malware.\n\n###### Beyond encryption\n\nA significant ransomware trend in 2021 was the increase in adversaries\n\nexpanding their threats beyond data encryption. Multiple ransomware groups\n\npivoted to stealing and exfiltrating data before encrypting it, then demanding\n\npayment to prevent the data from leaking publicly on a dark web site. While this\n\npractice isn’t new (it dates back to at least 2019), what was significant in 2021\n\nwas the number of groups who adopted this approach—to the point where it\n\nbecame the standard.\n\nAdversaries realized they could demand payment for more than just the\n\n[threat of a data leak or encryption. An adversary known as Fancy Lazarus (no](https://www.proofpoint.com/us/blog/threat-insight/ransom-ddos-extortion-actor-fancy-lazarus-returns)\n\naffiliation with Fancy Bear or Lazarus Group) extorted victims by threatening to\n\nconduct a distributed denial of service (DDoS) intrusion if they didn’t pay.\n\n\n-----\n\n###### TA K E ACT ION\n\nThere is no one simple way to prevent ransomware. The same security approaches\n\nyou take to prevent any malware also should help prevent ransomware. It’s critical\n\nto regularly update software, as we often see ransomware after operators exploit a\n\nvulnerability in an internet-facing application. Additionally, internet-facing remote\n\ndesktop protocol (RDP) connections without multi-factor authentication (MFA) are\n\na common ransomware vector, making MFA for any accounts that can log in via RDP\n\na high priority.\n\nRansomware also frequently gets into an environment as a follow-on payload\n\nfor malware delivered via phishing emails. Looking for these malware families,\n\n[such as Qbot, Bazar, and IcedID, can be an effective way to identify a potential](https://redcanary.com/threat-detection-report/threats/qbot/)\n\nransomware intrusion chain early and stop it in its tracks. Robust detection for\n\n[other common post-exploitation behaviors and tools like Cobalt Strike are also](https://redcanary.com/threat-detection-report/threats/cobalt-strike/)\n\neffective in limiting the impact of ransomware, as adversaries conduct multiple\n\nphases before data exfiltration and encryption.\n\nIt’s also important to remember that backups are no longer sufficient ransomware\n\nprotection. While creating offline backups is an excellent security practice and may\n\nhelp restore an environment after a ransomware intrusion, organizations cannot\n\nrely on this entirely because adversaries regularly exfiltrate data before encryption,\n\nalthough this too offers potential opportunities for detection. Backups will allow\n\nan organization to get back up and running more easily, but will not protect you\n\nagainst leaked data.\n\nWhile this report focuses on what security teams can do, when it comes to\n\nransomware, it’s also important to remember that this problem is monumental\n\nand extends beyond defenders. Policymakers are also taking a close look at\n\nransomware, and it’s necessary for the security community to help them better\n\nunderstand what we do so they can make better decisions.\n\n\n-----\n\n###### TR END\n\n## Supply chain compromise\n\n###### Supply chain compromises were a major theme in 2021, starting with SolarWinds, Kaseya and NPM package compromises mid-year, and ending  with Log4j.\n\nSupply chain compromises were prevalent in 2021, and these incidents aren’t\n\ngoing away any time soon. It’s important to understand the different types\n\nof supply chain compromises. To state it simply, a supply chain compromise\n\noccurs when an adversary compromises a software developer, hardware\n\nmanufacturer, or service provider and uses that access to target customers who\n\nuse the affected software, hardware, or service. For example, the SolarWinds\n\nand Kaseya incidents involved an adversary compromising update servers\n\nto target customers of the companies’ IT management software. Separately,\n\nNPM package and Log4j incidents involved adversaries exploiting open source\n\nlibraries in sweeping compromises that impacted products that use Log4j or\n\nNPM packages as a dependency—as well as anyone who uses those products\n\ndirectly. Each of these incidents made headlines in mainstream media as well as\n\ninfosec publications.\n\n###### SolarWinds\n\nAdversaries compromised SolarWinds, accessed the update infrastructure for its\n\nOrion IT management software, and sent backdoored updates to the company’s\n\nthousands of customers in December 2020, affecting organizations well into\n\n2021. The trojanized Orion platform updates included a legitimately signed\n\ndynamic link library (DLL) file, and some featured backdoor functionality that,\n\nafter a dormancy period lasting as long as two weeks, initiated communication\n\nwith command and control (C2) servers. Adversaries identified targets of\n\ninterest for further exploitation and conducted follow-on activity such as\n\ninstalling additional malicious binaries. These malicious binaries were used\n\nto install a backdoor where adversaries could access the victim organizations’\n\naccounts. SolarWinds had a massive impact across many networks, and it took\n\nmonths for enterprises to investigate and respond. This compromise initiated\n\nimportant discussions about supply chain risks that remain relevant in 2022\n\nand beyond.\n\n###### Kaseya\n\nIn July 2021, adversaries exploited vulnerabilities in Kaseya VSA IT Management\n\nsoftware in a campaign ultimately designed to deploy Sodinokibi ransomware,\n\nalso known as REvil VSA is popular among managed service providers (MSP)\n\n\n-----\n\nthat use it to remotely administer IT systems. The adversaries exploited zero\n\ndays to gain remote control over the MSPs’ VSA installations, which they\n\nused to infect the MSPs’ customers’ endpoints with ransomware. Kaseya\n\n**[estimated that about 50 direct customers who were running Kaseya VSA](https://www.kaseya.com/press-release/kaseya-responds-swiftly-to-sophisticated-cyberattack-mitigating-global-disruption-to-customers/)**\n\nsystems—and between 800 and 1,500 other businesses—were impacted by\n\n[this breach. While the damage was not as bad as it could have been, this](https://www.huntress.com/blog/security-researchers-hunt-to-discover-origins-of-the-kaseya-vsa-mass-ransomware-incident)\n\nincident further highlights the importance of tracking supply chain threats.\n\nIt also resulted in significant attention from the U.S. government, which later\n\n**[indicted the adversaries responsible for the intrusion. Read about how Red](https://www.justice.gov/opa/pr/ukrainian-arrested-and-charged-ransomware-attack-kaseya)**\n\n**[Canary responded to the compromises and protected several customers from](https://redcanary.com/blog/uncompromised-kaseya/)**\n\nransomware infections.\n\n###### NPM package compromises\n\nNode Package Manager (NPM) is a repository for publishing node.js projects,\n\nincluding libraries that developers download and incorporate into their software\n\nto perform specific mathematical functions, process data in specific ways,\n\nvisualize data, and more. In October 2021, adversaries compromised an open\n\nsource JavaScript library with more than 7 million weekly downloads and\n\nused it to distribute password stealers and coinminers. At the time, the NPM\n\nregistry did not require author accounts to use multifactor authentication (MFA),\n\nwhich led to an unknown adversary hijacking the registry accounts of multiple\n\npackage authors. After hijacking, the adversary published malicious versions\n\nof the legitimate packages that contained malware. Victims included package\n\nauthors and end users of applications relying on those packages. One package,\n\n**ua-parser-js, was downloaded around 8 million times a week at the time and is**\n\nused by Google, Amazon, Facebook, IBM, and Microsoft. The U.S. Cybersecurity\n\n[and Infrastructure Agency (CISA) published a security alert about the incident,](https://www.cisa.gov/uscert/ncas/current-activity/2021/10/22/malware-discovered-popular-npm-package-ua-parser-js)\n\nwarning victims to update to a safe version.\n\nThere were many other NPM compromises throughout the year, most notably\n\n**[ua-parser-js. Prior to this compromise, an adversary copied the legitimate](https://www.bleepingcomputer.com/news/security/popular-npm-library-hijacked-to-install-password-stealers-miners/)**\n\n**ua-parser-js library and combined it with malicious code to publish a malicious**\n\n[library. Following this compromise, an adversary took control of two NPM](https://thehackernews.com/2021/11/two-npm-packages-with-22-million-weekly.html)\n\npackages, coa and rc. These incidents used a combination of XMRig coinminer\n\non macOS and Danabot on Windows. Red Canary continues to track\n\nthis activity.\n\n###### Log4j\n\nLog4j is a popular Java logging library underlying many third-party applications\n\nthat was hit with a remote code execution vulnerability in December 2021.\n\nThe primary threats initially exploiting this vulnerability were coinminers and\n\nbotnets, though the community feared exploitation would expand because\n\nof Log4j’s massive intrusion surface. In some scenarios, the Log4j library was\n\nff d b d i l bili\n\n\n-----\n\nOne reason the community didn’t observe a large volume of exploitation in the\n\nfirst few days may be that these vulnerabilities are highly application-specific,\n\ndepending on how they’ve implemented Log4j. This means an adversary could\n\nnot have crafted a single exploit that would have had a broad impact on many\n\ntypes of applications at once. Though it took adversaries a few weeks to ramp\n\nup targeting, in late December 2021 and early 2022, internet-facing VMware\n\nHorizon servers using vulnerable versions of Log4j became a target for multiple\n\noperators. Adversaries were likely attracted to VMware Horizon because it is\n\nwidely used and often internet-facing. We anticipate the continued targeting of\n\ninternet-facing applications using vulnerable versions of Log4j for months\n\nto come.\n\n\n###### TA K E ACT ION\n\nOne of the best ways organizations can be prepared is by accurately inventorying\n\nall of the hardware, software, and service providers they rely on and trust. This will\n\nassist in quick response when an inevitable supply chain concern arises. While it\n\nsounds commonplace, normal defense-in-depth strategies can also help prevent\n\nsupply chain compromises from turning into impactful intrusions. Endpoint\n\ndetection and response (EDR) tools coupled with network detection tools will help\n\nyou detect malicious post-exploitation activity in the event an adversary gains\n\naccess to your network through a trusted third party. While there may be nothing\n\nyou can do to prevent a dependency or a vendor from being compromised, there\n\nis quite a lot you can do to detect and prevent follow-on compromise, including\n\ndetection opportunities we’ve shared throughout the rest of this report.\n\n\n-----\n\n###### TR END\n\n## Vulnerabilities\n\n###### In 2021, adversaries exploited vulnerabilities affecting popular enterprise platforms to drop web shells, spread ransomware, and more.\n\nSeveral high-profile vulnerabilities made it into the collective consciousness of\n\nthe security community in 2021. ProxyLogon and ProxyShell targeted Microsoft\n\nExchange servers and affected a massive number of systems, sometimes leading\n\nto ransomware deployment. The exploitation of vulnerabilities in Kaseya’s\n\nVSA appliance software also led to ransomware deployment on some of the\n\nthousands of organizations that used Kaseya software for remote administration\n\nof endpoints. In the latter half of the year, adversaries exploited multiple\n\nvulnerabilities in Zoho’s ManageEngine suite of products. PrintNightmare and\n\nan MSHTML vulnerability caused a ruckus among the security community and\n\nmedia; however, their actual impact appears to have been limited.\n\nAn important nuance to call out is that vulnerabilities are just flaws in code—a\n\nthreat must exploit that vulnerability. Given the frequency with which\n\nvulnerabilities are disclosed and the ease with which adversaries can exploit\n\nnewly reported weaknesses, particularly in common applications, Red Canary\n\nfocuses on identifying and detecting the behavior we observe surrounding\n\nexploitation of a vulnerability. We recommend other organizations do the\n\nsame. Understanding the threats and the ways in which adversaries operate in\n\ncompromised networks allows defenders to protect against malicious activity\n\nregardless of the means by which their environment is accessed.\n\n###### ProxyLogon (CVE-2021-26855, CVE-2021-26857, CVE-2021-26858, CVE-2021-27065)\n\n[In March 2021, Microsoft released details of four Exchange Server](https://msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server/)\n\n**[vulnerabilities collectively known as “ProxyLogon.” If chained together, the](https://msrc-blog.microsoft.com/2021/03/02/multiple-security-updates-released-for-exchange-server/)**\n\nvulnerabilities would allow an adversary remote code execution on a targeted\n\nExchange server. Multiple adversaries, including the suspected Chinese state\nsponsored group HAFNIUM, used the vulnerability chain to drop web shells and\n\ncollect data from thousands of Exchange servers. Other adversaries used the\n\n**[DearCry ransomware to target unpatched servers as well. Microsoft released](https://twitter.com/MsftSecIntel/status/1370236539427459076?s=20)**\n\npatches for these vulnerabilities at the time of initial reporting.\n\n\n###### TAKE ACTIO N\n\nWe’ve outlined several of 2021’s\n\nmajor vulnerabilities below,\n\nalong with some detection\n\nguidance. Detecting exploitation\n\nof a vulnerability from an endpoint\n\nperspective can be difficult and\n\ndepends on how exploitation occurs\n\nin practice. We have tried to supply\n\ndetection guidance as close to the\n\npoint of exploitation as possible. In\n\nother cases, we provide detection\n\nopportunities that would most likely\n\nappear as follow-on behavior, such\n\nas suspicious child processes or\n\nregistry modifications. The targeting\n\nof vulnerabilities in enterprise\n\napplications and platforms is\n\nunlikely to slow down in 2022, so it’s\n\nimportant to detect the threats that\n\nexploit them head-on.\n\n\n-----\n\n###### Microsoft Exchange Mailbox Replication service writing Active Server pages\n\nAdversaries exploited ProxyLogon to drop web shells on vulnerable systems,\n\nwhich manifested through the msexchangemailboxreplication.exe service\n\nwriting an ASPX file to disk. Malicious web shells will likely be placed on the\n\nweb server in a web-accessible directory. The following analytic looks for the\n\nExchange mailbox replication service creating ASPX files.\n\nprocess == msexchangemailboxreplication.exe\n\n&&\n\nfilemod_extension == .aspx\n\n###### ProxyShell (CVE-2021-31207, CVE-2021-34523, CVE-2021-34473)\n\nExchange servers remained a target throughout 2021. In July, Microsoft\n\nreleased details of three new vulnerabilities in the Exchange server, which\n\nwere dubbed “ProxyShell.” ProxyShell exploitation allows an adversary to\n\n**[remotely execute code without authentication. Following the exploitation,](https://www.mandiant.com/resources/pst-want-shell-proxyshell-exploiting-microsoft-exchange-servers)**\n\nadversaries dropped web shells to conduct reconnaissance, move laterally,\n\n[and in some instances, deploy ransomware. Where ProxyLogon seemed](https://redcanary.com/blog/blackbyte-ransomware/)\n\nto have a high impact over a short period of time, ProxyShell seemed to\n\npersist throughout the year; we detected exploitation as late as December.\n\nDetectingProxyShell exploitation is similar to ProxyLogon mentioned above,\n\nspecifically msexchangemailboxreplication.exe writing an ASPX web shell\n\nto disk.\n\n###### PrintNightmare (CVE-2021-34527)\n\nOn July 1, security researchers and Microsoft released details of a new\n\nvulnerability dubbed “PrintNightmare” (CVE-2021-34527). PrintNightmare\n\npermits an unprivileged user to remotely obtain elevated privileges on any\n\nsystem running the print spooler service, which is enabled by default. It abuses\n\na vulnerability in how the print spooler service fails to properly authenticate\n\nusers attempting to load a printer driver dynamic link library (DLL). This zero day\n\naffected all editions of Windows, allowing code execution with local SYSTEM\nlevel privileges.\n\nThough the vulnerability was concerning, there were not many reported\n\n[campaigns exploiting it. That said, ransomware operators such as Vice Society](https://blog.talosintelligence.com/2021/08/vice-society-ransomware-printnightmare.html)\n\n[and Magniber have exploited the vulnerability to gain initial access, and](https://www.crowdstrike.com/blog/magniber-ransomware-caught-using-printnightmare-vulnerability/)\n\ntherefore it’s worth looking out for. We observed a single malicious instance of\n\n\n-----\n\n###### Windows print spooler service  spawning cmd.exe\n\nPrintNightmare exploitation results in a shell being opened on the targeted\n\nsystem as a child process of the spooler service. This detection analytic\n\nidentifies the Windows print spooler service spawning a shell on the system.\n\nparent_process == spoolsv.exe\n\n&&\n\nprocess == cmd.exe\n\n###### Kaseya VSA (CVE-2021-30116)\n\nOn July 2, adversaries leveraged multiple vulnerabilities in Kaseya Virtual\n\nSystems Administrator (VSA) to distribute Sodinokibi ransomware, also known\n\nas REvil. VSA allows IT administrators to remotely administer endpoints. By\n\ncompromising this software, an adversary gains remote execution capability\n\nto a large subset of customer endpoints, especially if Kaseya is operated by a\n\nmanaged service provider (MSP).\n\nRed Canary detected the initial behavioral activity using a preexisting\n\nanalytic for identifying certutil.exe decoding content, as detailed below. Our\n\nIntelligence team had tracked Sodinokibi prior to this, which helped us identify\n\nthe malicious registry modification of blacklivesmatter seen below and\n\nattribute it to Sodinokibi.\n\n###### Certificate utility tool (certutil.exe )  decoding content\n\nThis detection analytic will detect certutil.exe running with the -decode option.\n\nAdversaries frequently leverage certutil to decode Base 64-encoded content.\n\nprocess == certutil.exe\n\n&&\n\ncommand_line_includes (decode)\n\n\n-----\n\n###### ManageEngine products (CVE-2021-40539, CVE- 2021-44077, CVE-2021-44515)\n\nIn November and December, we observed likely exploitation of remote code\n\nexecution vulnerabilities in two different Zoho ManageEngine products:\n\n**[ADSelfService Plus](https://www.manageengine.com/products/self-service-password/kb/how-to-fix-authentication-bypass-vulnerability-in-REST-API.html)** (CVE-2021-40539) and **[ServiceDesk Plus](https://www.manageengine.com/products/service-desk/security-response-plan.html)** (CVE-2021-44077).\n\nIn one case, an incident response partner determined that ADSelfService\n\nPlus was used for initial access prior to deploying ransomware. The FBI noted\n\nthat advanced adversaries exploited a vulnerability in a third ManageEngine\n\nproduct, **[Desktop Central. ManageEngine products are widely used among](https://www.manageengine.com/products/desktop-central/cve-2021-44515-authentication-bypass-filter-configuration.html)**\n\nIT departments to manage various services across the enterprise. As such,\n\nthis presents adversaries with a wide attack surface. Organizations using\n\nManageEngine products in their environment should update accordingly.\n\nPatches for all the vulnerabilities listed here are available via **[ManageEngine.](https://www.manageengine.com/)**\n\n###### Keytool.exe spawning system shell  or PowerShell\n\nFor the vulnerability in ADSelfService Plus (CVE-2021-40539), we\n\nobserved adversaries use the Java utility Keytool to move a web shell from\n\nthe initial directory it was dropped into. As such, keytool.exe spawning shells\n\nshould be investigated, and the following detection analytic should surface\n\nrelated activity.\n\nparent_process == keytool.exe\n\n&&\n\nprocess == (cmd.exe || powershell.exe)\n\n\n-----\n\n###### TR END\n\n## Affiliates\n\n###### The threat landscape continued moving toward a software-as-a-service (SaaS) economy, muddying the already murky waters of attribution.\n\nThe term “affiliate” has been increasingly used to describe the cybercrime\n\necosystem’s evolution into a software-as-a-service (SaaS) economy. Borrowed\n\nfrom the subscription-based software specialization strategy, an “affiliate”\n\nrefers to the provider-customer relationship of malicious services. In the\n\n[cybercrime ecosystem, several SaaS variants have emerged, from phishing-](https://resources.infosecinstitute.com/topic/phishing-as-a-service/)\n\n**[as-a-service (PhaaS) to access-as-a-service to crypter-as-a-service to](https://resources.infosecinstitute.com/topic/phishing-as-a-service/)**\n\n**[ransomware-as-a-service (Raas). It has never been easier to find an adversary](https://www.crowdstrike.com/cybersecurity-101/ransomware/ransomware-as-a-service-raas/)**\n\nfor hire.\n\nThis service specialization across the phases of an intrusion has led to a\n\nproliferation of partnering, muddying the waters of what was once a relatively\n\nconsistent collection of tactics across campaigns. As adversaries swap\n\nsubscribers and pass off payloads, identifying and anticipating the progression\n\nof a compromise becomes more challenging. To meet this challenge, we need to\n\ndistinguish the affiliate activity at each stage of the campaign.\n\n###### Tracking threats at Red Canary\n\nTracking affiliates is tricky, and to help explain why we think it’s so important,\n\nwe want to share some background on our threat tracking journey. At Red\n\nCanary, we primarily track threats by documenting their observable behaviors\n\nin the form of tactics, techniques and procedures (TTP). When we first set out\n\non this intelligence mission, we began by clustering the most prominent and\n\nprevalent threats within our data. We often focused on the primary payload as\n\n[a means of referring to the threat within a detection—think Qbot, TrickBot, or](https://redcanary.com/threat-detection-report/threats/qbot/)\n\n**[Cobalt Strike. Often we would see one or more of these threats progressing](https://redcanary.com/threat-detection-report/threats/cobalt-strike/)**\n\nto another threat, especially in the wild west of active incident response\n\nengagements.\n\nThroughout 2021, we realized that referring to activity as an Emotet phishing\n\ncampaign or a Qbot phishing campaign was confusing. The activity we observed\n\nbefore and after Emotet or Qbot sometimes varied, while other times, we\n\nnoticed the same patterns in how different malware families gained initial\n\naccess. This realization helped us determine that patterns within filenames or\n\ninfrastructure indicated that these characteristics likely belonged to their own\n\ninitial access cluster—a delivery affiliate—rather than a simple malware payload\n\nas we had initially been referring to them. Understanding the relationships\n\nbetween these related threats enables us to better understand and respond to\n\n\n-----\n\n###### Prominent affiliates in 2021\n\nThe process of teasing out the distinguishing characteristics that allow us to\n\nseparate distinct clusters into more granular components is constantly evolving,\n\nas are the threats themselves. While we’ve been tracking some affiliates, such as\n\n**[TA551 (named by Proofpoint), for quite some time, others came into focus more](https://redcanary.com/threat-detection-report/threats/ta551/)**\n\nrecently as our research progressed throughout the course of 2021. Breaking\n\ndown intrusions into their component parts helps us better keep pace with the\n\nnature of the affiliate-based economy adversaries operate in today.\n\nIn 2021, we began identifying patterns in multiple phishing affiliates dropping\n\n[variants of the Bazar family of malware, also referred to as “Baza.” Derived](https://redcanary.com/threat-detection-report/threats/bazar/)\n\nfrom the use of .bazar top-level domains for C2 when it was first observed in the\n\nwild, this family has lent its name to multiple initial access vectors, campaigns,\n\nand components, including BazarLoader, BazarCall, and BazarISO. The multiple\n\ncomponents under the umbrella of the Bazar family highlight the importance of\n\ndifferentiating the initial access from the payload. We have seen BazarBackdoor\n\ndelivered by other prominent phishing affiliates, such as TA551, and have\n\neven seen behavior echoing some of the earliest campaigns that delivered\n\nBazarBackdoor surface in the latter half of 2021, delivering a resurgent Emotet\n\nas its payload.\n\nIncorporating findings from other researchers helped us test hypotheses\n\nand add context to our understanding of several other affiliated threats. The\n\nprominence of Qbot in our detections and as a ransomware precursor led us\n\nto further scrutinize the XLSX phishing lures that delivered it. As a result of this\n\nresearch, we created a distinct profile for the TR delivery affiliate (which we also\n\nobserved delivering IcedID). Distinguishing these components would not have\n\nbeen possible without other researchers who shared their findings, such as\n\n**[Brad Duncan.](https://twitter.com/malware_traffic/status/1440847489876185091)**\n\nShifting away from phishing affiliates, we appreciated Morphisec’s great\n\n[reporting on HCrypt and Snip3 in the first half of the year, the first time crypter-](https://blog.morphisec.com/tracking-hcrypt-an-active-crypter-as-a-service)\n\n**[as-a-service crossed our radar. This helped us better break down several other](https://redcanary.com/threat-detection-report/trends/crypters)**\n\nclusters of activity to distinguish the hallmarks of the crypter from the initial\n\nphishing campaigns, such as Aggah, or the myriad RAT payloads HCrypt typically\n\ndelivered.\n\n\n-----\n\n###### TA K E ACT ION\n\nAnalysts can better track affiliates by focusing on patterns in each phase of\n\nan intrusion and comparing similarities and differences to help distinguish\n\nwhen activity has passed from one affiliate to the next. To do this, you can ask\n\nquestions of the data and compare answers across distinct incidents where you\n\nobserved overlaps.\n\nHere are some example questions to consider:\n\n- Does the email that delivered this payload belong to a phishing affiliate, or is\n\nthis entire campaign a cohesive cluster?\n\n- What about the attachment or link within the email—is that a commodity\n\nmaldoc? Is it part of access broker infrastructure, or does it belong to the\n\nadversary operating the later-stage payload?\n\n- Is the download cradle and loader the beginning of the next-stage payload,\n\nor the last vestige of the delivery affiliate before handing off execution to the\n\ndelivered payload?\n\nBy honing in on the handoff between one affiliate and the next, you gain better\n\ninsight into the potential pivot points in the progression of an incident, hopefully\n\ndetecting adversaries closer to the start of an intrusion. Distinguishing phishing\n\naffiliates such as TA551 or TR from the IcedID or Qbot payloads they deliver not only\n\nhelps delineate the handoff between the affiliates, but allows you to dive deeper\n\ninto delivery patterns to identify differences when the deployed payload changes.\n\nAnticipating the next stage of a threat’s progression based on early observables\n\nenables defenders and incident responders to implement mitigations before that\n\ninitial access can progress to lateral movement, data exfiltration, or ransomware.\n\n\n-----\n\n###### TR END\n\n## Crypters-as-a-service\n\n###### In 2021, crypters like HCrypt and Snip3 joined the ranks of other  “as-a-service” threats.\n\nThroughout 2021, Red Canary observed operators using crypters HCrypt and\n\nSnip3 to deliver various remote access trojans (RAT). Like other “as-a-service”\n\nthreats, the developers sell or lease these crypters to affiliates who use them\n\nto carry out campaigns, expanding the threat landscape and creating new\n\neconomies of scale. The “as-a-service” ecosystem lowers the technical barrier\n\nto entry, allowing operators to purchase capabilities rather than develop them.\n\n###### HCrypt\n\nHCrypt is a crypter designed to evade detection and facilitate the download\n\nof secondary payloads, often commodity RATs like ASyncRAT, Quasar RAT, and\n\nLimeRAT. We’ve seen adversaries leveraging HCrypt to gain initial access via\n\nphishing attachments, often relying on image files (IMG or ISO) containing a\n\nscript (VBS or JavaScript) that launches HCrypt. The malicious script downloads\n\nan additional script hosted on various publicly accessible sites such as GitHub\n\nand Discord. Without intervention, this execution chain ultimately leads to\n\na RAT infection.\n\n###### Snip3\n\nLike HCrypt, Snip3 is a crypter designed to evade detection and download\n\nadditional malware. Snip3 is often delivered via phishing emails that prompt\n\nvictims to download a VBA file. To evade detection, Snip3 leverages obfuscated\n\nPowerShell commands that contain the RemoteSigned flag. We’ve observed\n\nthese PowerShell commands connecting to top4top[.]io, a legitimate file-sharing\n\nservice popular in Egypt, Algeria, and Yemen.\n\nBecause these crypters are used by various adversaries delivering different\n\npayloads, it can be difficult to cluster seemingly disparate activity. However,\n\nas public reporting on Snip3 has discussed specific targeting of victims in the\n\naviation sector, and we know of at least one set of operators that consistently\n\nrelies on phishing emails with lures related to travel or cargo, we’ve associated\n\nactivity we saw in 2021 with a campaign Cisco calls Operation Layover. We\n\nassess with high confidence that certain activity we observed in 2021 overlaps\n\nwith this long-running operation, also chronicled by researchers from Morphisec\n\nand Microsoft. While this campaign involved attempts to deliver ASyncRAT\n\nor RevengeRAT to victims, similar intrusion chains deliver other publicly\n\n\n-----\n\n###### TA K E ACT ION\n\nAs HCrypt and Snip3 operate “as-a-service,” groups that purchase these\n\ncapabilities may leverage them in different ways. The detection analytic below\n\nrepresents one opportunity to detect both crypters, empowering defenders to\n\nintervene before adversaries deliver additional malware.\n\n\n### Detection opportunities\n\n###### WScript spawning Powershell using  Invoke-Expression \n\nThis detection analytic will identify wscript.exe spawning PowerShell that\n\nuses Invoke-Expression or one of its aliases. HCrypt and Snip3 use PowerShell\n\nInvoke-Expression cmdlets to execute downloaded PowerShell content\n\nfilelessly, without the downloaded scripts touching disk.\n\nprocess == powershell.exe\n\n&&\n\nparent_process== wscript.exe\n\n&&\n\ncommand_line_includes (iex || invoke || invoke-expression)\n\n\n-----\n\n###### TR END\n\n## Common web shells\n\n###### In 2021, adversaries exploited web applications with help from web shells such as China Chopper, Godzilla, and Behinder.\n\nWeb shells seriously affected many environments in 2021 due in large part to\n\nMicrosoft Exchange and Zoho ManageEngine web server exploitation. Throughout\n\nthe year, adversaries exploited ProxyShell, a Microsoft Exchange vulnerability, to\n\ngain privileged access to email systems owned by thousands of organizations. In\n\nthese cases, the adversaries left behind a China Chopper web shell, a small and\n\nextensible bit of code that runs arbitrary ASP.NET, PHP, JSP, and other languages.\n\nSome versions of China Chopper require authentication with a preset password,\n\nbut many adversaries fail to implement this, meaning that multiple adversaries\n\ncan use the same web shell in different campaigns at once.\n\nWe also observed adversaries exploiting Oracle WebLogic servers to install the\n\nGodzilla web shell. Like China Chopper, Godzilla supports execution in ASP.NET,\n\nJSP, and PHP. Unlike China Chopper variants though, Godzilla web shells use a\n\ncombination of simple password authentication with an additional encryption key\n\nvalue to require adversaries to have two pieces of information to communicate\n\nwith the shell. The authentication ensures that only a single adversary can use\n\nthe web shell. This encryption also obfuscates network traffic and confounds\n\nnetwork-based analysis.\n\nFinally, we observed the Behinder web shell following adversaries exploiting a\n\nJava-based web application made by Chinese cloud software company Yonyou.\n\nBehinder can load and execute compiled payloads in addition to standard\n\ncommands. As with Godzilla, Behinder supports encryption and goes the extra\n\nmile by randomizing User-Agent strings in network traffic to hinder network and\n\nlog analysis.\n\n###### Why web shells matter\n\nWeb shells are malicious scripts designed to maintain persistent access to\n\ncompromised web servers and facilitate remote code execution. Some are simple,\n\nallowing adversaries to issue a single command in a text box on a web page, while\n\nothers include extensive capabilities where the adversary’s imagination is the\n\nlimit. Web shells execute with the same user account privileges as the exploited\n\nweb application. If the application runs as an administrator, sensitive databases\n\nand systems may be accessible. Most web shells have simple or non-existent\n\nauthentication mechanisms. Adversaries often leave web shells on public-facing\n\nweb servers with no authentication mechanisms so they can return to the systems\n\n\n-----\n\nlater. In some incidents, responders may find many web shells on a single server or\n\nevidence of multiple adversaries using an abandoned web shell. Web shells should\n\nbe removed as soon as possible to prevent further access.\n\n###### TA K E ACT ION\n\nPatching should be the first step for remediating vulnerable web applications like\n\n**[Exchange, to prevent web shells from being dropped at all. Look for evidence](https://msrc-blog.microsoft.com/2021/03/05/microsoft-exchange-server-vulnerabilities-mitigations-march-2021/)**\n\nof an existing breach by following guidance from the application developers.\n\n[For example, Microsoft recommends using the Microsoft Support Emergency](https://github.com/microsoft/CSS-Exchange/blob/main/Security/Defender-MSERT-Guidance.md)\n\nResponse Tool (MSERT) to scan the Exchange server for exploitation.\n\nIf you cannot patch your web applications, consider creating IIS rewrite rules,\n\ndisabling Unified Messaging services, and disabling multiple Internet Information\n\nServices (IIS) application pools. These stopgap measures may affect the internal\n\nand external availability of your applications, depending on which products your\n\n[organization uses. For more remediation advice, check out our blog Microsoft](https://redcanary.com/blog/microsoft-exchange-attacks/)\n\n**[Exchange server exploitation: how to detect, mitigate, and stay calm.](https://redcanary.com/blog/microsoft-exchange-attacks/)**\n\nTo detect web shells, start by examining file modifications and process executions.\n\nFor Exchange servers, look for suspicious ASPX file modifications that may indicate\n\nan adversary wrote a web shell to disk. For other web applications like ASP.NET,\n\nPHP, and JSP applications, look for suspicious process behaviors. For example,\n\nyou may be able to identify web shell activity by watching for web server worker\n\nprocesses spawning cmd.exe and PowerShell, certutil on Windows, or curl on\n\nLinux systems.\n\n###### Windows IIS Worker process spawning  certutil.exe\n\nThis detection analytic will identify unusual activity originating from w3wp.exe\n\nexecuting certutil to download files.\n\nparent == w3wp.exe\n\n&&\n\ncommand_line_includes (certutil && -split)\n\n\n-----\n\n###### Linux PHP or Java processes spawning wget or curl\n\nThis detection analytic will identify unusual activity originating from Linux web\n\nservers executing wget or curl to download files.\n\nparent_process == (php || java)\n\n&&\n\ncommand_line_includes (wget || curl)\n\n\n-----\n\n###### TR END\n\n## User-initiated initial access\n\n###### We observed an uptick in threats that occurred after users sought out content which, often unbeknownst to them, was malicious.\n\nIn 2021, Red Canary observed adversaries use a range of initial access mechanisms\n\nto gain a foothold into victims’ environments. Much of the activity we saw was\n\nconsistent with our expectations, with many detections resulting from malicious\n\nemails, attempts to harvest victims’ credentials, and breaches by way of a trusted\n\nparty. Additional details on trends associated with these initial access vectors\n\nand follow-on activity such as webstall installation can be found throughout the\n\nreport.\n\nUnderstanding initial access can help defenders protect their environments\n\nearly on. Prioritizing detections related to initial access saves money, time and\n\neffort; lessens pain points for users; and reduces impact to a business. From an\n\nintelligence perspective, understanding common patterns in initial access and\n\nfollow-on activity helps build confidence in determining if relationships exist\n\nbetween threats that co-occur in an environment.\n\nNotably, over the past year, we observed a rise in what we refer to as “user\ninitiated activity:” cases where victims downloaded a malicious executable after\n\nengaging with content they purposefully sought out. This often occurs without the\n\nvictim’s knowledge, particularly in cases where adversaries poison search engine\n\nresults to direct victims to compromised websites.\n\nThough user-initiated activity can be just as dangerous as adversary-initiated\n\nactivity, it can be more challenging to triage because it often involves unwanted\n\nsoftware or riskware, which many organizations deem lower-risk. However, it is\n\ncritical to respond to this type of activity immediately, as follow-on threats can\n\ninclude infostealers and ransomware.\n\n###### Top threats relying on user-initiated activity \n\n[Several of our top 10 threats—SocGholish, Yellow Cockatoo, and Gootkit—rely](https://redcanary.com/threat-detection-report/threats/socgholish)\n\non variants of user-initiated activity for initial access. Though not as pervasive,\n\nwe also saw similar tradecraft with Rose Flamingo, an activity cluster involved\n\nin intrusion chains where we later observed various payloads such as STOP\n\nransomware.\n\n- Adversaries behind both Gootkit and Yellow Cockatoo abuse search engine\n\noptimization (SEO) to display malicious content at the top of a victim’s\n\n\n-----\n\nand presented to the victim from a trusted search engine, victims are often\n\neasily “lured” to these sites. They are then prompted to download malicious\n\ncontent masquerading as legitimate content. For example, if a user searched\n\nfor “this is my query,” the binary they downloaded would be named this\n**is-my-query.exe. Because the file looks familiar, users are less likely to**\n\nscrutinize it closely or look for red flags.\n\n- Rose Flamingo’s initial access occurs via file-sharing websites purporting to\n\nprovide free or “cracked” software.\n\n- Similarly, SocGholish leverages drive-by-downloads masquerading as\n\nsoftware updates. SocGholish itself is embedded in legitimate websites\n\nthat have been compromised to prompt users about the need to download\n\nsupposed required updates.\n\nIn each case, the tradecraft allows the operators to carry out seemingly targeted\n\nsocial engineering intrusions at scale.\n\n\n-----\n\n###### TR END\n\n## Malicious macOS installers\n\n###### Malicious installers led to rotten Apples and adware, as macOS systems continued to be targeted in 2021.\n\nWe’ve come a long way from hearing cries of “Macs don’t get viruses!,” and in\n\n2021, the information security community saw more and more malware targeting\n\nmacOS systems. In contrast to Windows systems, we observe far fewer malicious\n\ndocuments or email attachments on macOS systems. Instead, the majority of\n\nmalware we observe on macOS stems from malicious installers that trick victims\n\ninto thinking they’re downloading legitimate content. This approach is particularly\n\ninsidious, as victims on macOS systems usually possess administrative privileges.\n\n**[Shlayer, Bundlore, and Silver Sparrow followed this malicious installer trend.](https://redcanary.com/blog/shutting-down-osx-shlayer/)**\n\nAlso, four of the eight macOS malware threats Objective-See covered in their\n\n**[review of 2021 relied on malicious installers for deployment.](https://objective-see.com/blog/blog_0x6B.html)**\n\nMost macOS threats we observe are malicious adware. Malicious adware is an\n\nunwanted program designed to show advertisements on a victim’s screen, often\n\nwithin a web browser. A good example of the potential impact of malicious adware\n\ncomes from the activity cluster Red Canary tracks as Silver Toucan. This cluster\n\ndiscloses its own terms of service that victim hosts may use for proxy activities.\n\nMalicious macOS adware often includes tools such as MITMProxy for ad injection,\n\nwhich raises the privacy concern of web traffic inspection on affected hosts.\n\n**Figure 1: Malicious adware lure**\n\nThreats like Shlayer pose as fake Flash Player downloads to look legitimate.\n\n\n###### TAKE ACTIO N\n\nUpdating the operating system and\n\napplying antimalware controls are\n\nthe best defenses against malicious\n\nsoftware on macOS. Patching to\n\nthe latest version possible ensures\n\nthat malware exploits are less likely\n\nto succeed. Malware authors still\n\ncirculate versions of installers that\n\nexploit patched vulnerabilities,\n\nknowing that not everyone can patch\n\ntheir macOS system. Antimalware\n\ncontrols help mitigate this threat.\n\nWhere possible, obtain software\n\ndirectly from trusted sources that\n\nsign the installers and seek\n\nnotarization from Apple. Malicious\n\nsoftware has been mistakenly\n\nnotarized in the past, but each case\n\nhas been rapidly found and remedied.\n\n\n-----\n\n###### TR END\n\n## Remote monitoring and management abuse\n\n###### Adversaries continue to use and abuse legitimate remote monitoring and management (RMM) software to move data and control infected hosts.\n\nAdversaries regularly abuse remote monitoring and management (RMM) tools\n\nbecause they’re widely used for legitimate reasons and seem benign. Along\n\nwith the ability to blend in while moving laterally, these tools offer adversaries\n\na reliable way to communicate with and pass information in and out of infected\n\nhosts.\n\nIn 2021 we identified an uptick of ransomware operators abusing RMM to\n\nremotely control victim machines and deploy additional malicious payloads.\n\nRMM has typically been used by help desk technicians to resolve issues on client\n\ncomputers. These software suites allow users to remotely control hosts, providing\n\nadversaries with a user-friendly graphical interface, secure network connections\n\nvia cloud hosted infrastructure, and host persistence. This makes it a challenge for\n\ndefenders to catch the early stages of intrusions. It became increasingly clear to us\n\nthroughout the year that being able to initially detect abnormal installation and\n\nexecution of these tools can help thwart ransomware or slow further deployment\n\nof malicious payloads.\n\nNot all ransomware operators or affiliates use these tools as part of their intrusion\n\nchain, meaning other security controls are still important to cover other access\n\n[paths. Community reporting has identified ransomware groups like REvil, Conti,](https://www.huntandhackett.com/blog/revil-the-usage-of-legitimate-remote-admin-tooling)\n\n**[Avos Locker, and Blackheart using software suites such as ScreenConnect, Atera,](https://twitter.com/SophosLabs/status/1473673822654107653?s=20)**\n\nand Anydesk to gain persistent footholds to hosts after compromising them. In\n\nmany instances, this led to the deployment of ransomware. Identifying rogue\n\ninstances of these management tools is a great starting point to help understand\n\nand defend your endpoints.\n\n\n###### TAKE ACTIO N\n\nWe see the use of RMM tools as a way\n\nfor adversaries to blend into the vast\n\nswath of endpoint telemetry that\n\ndefenders rely on heavily for finding\n\nand eradicating evil. We all need to\n\ntake a different approach when it\n\ncomes to detecting this behavior.\n\nRather than solely focusing on\n\nblocking known malware samples or\n\nwriting detection logic surrounding\n\nbuilt-in operating system tool abuse\n\n(e.g., living off-the-land binaries),\n\nkeep legitimate third-party software\n\ninventory in mind as well.\n\nEnterprises purchase and use\n\nhundreds, if not thousands, of\n\nsoftware suites, but accounting for\n\nwhat’s legitimate in your organization\n\nis important. We’re not suggesting\n\nthe near impossible, which is to keep\n\ntabs on all abnormal behavior of your\n\nnumerous applications, but merely\n\nsuggesting to stay up to date on the\n\npermissibility of their presence.\n\nCorrelating with the legendary\n\n**[Pyramid of Pain, malicious use of](https://detect-respond.blogspot.com/2013/03/the-pyramid-of-pain.html)**\n\nRMM tools finds itself near the top of\n\nthe pyramid, under “Known Tools”\n\nand “TTPs.” Gathering laundry lists of\n\nlegitimate software and comparing\n\nthem against process execution\n\nlogs will prove valuable for your\n\n[defensive posture. SANS has a great](https://sansorg.egnyte.com/dl/wmhPNjxznO)\n\nwhite paper on how defenders can\n\nuse open source utilities to collect\n\nthis information remotely from their\n\nmanaged devices. We’ve also covered\n\nthis topic more in-depth with multiple\n\ndetection opportunities in our\n\n[“Misbehaving RATs” blog post.](https://redcanary.com/blog/misbehaving-rats/)\n\n\n-----\n\n###### TR END\n\n## Linux coinminers\n\n###### Coinminers continued to dominate the Linux threat landscape in 2021.\n\nWhile coinminers affect all operating systems, they made up the majority of the\n\nthreats we saw on Linux environments in 2021, just as we’ve seen in years prior. As\n\n**[Log4j vulnerabilities consumed the information security news cycle in December](https://redcanary.com/news/log4j-what-you-need-to-know/)**\n\n[2021, researchers reported adversaries exploiting Log4j to deliver XMRig payloads](https://businessinsights.bitdefender.com/technical-advisory-zero-day-critical-vulnerability-in-log4j2-exploited-in-the-wild)\n\n[and other](https://www.lacework.com/blog/lacework-labs-identifies-log4j-attackers/) **[coinminers. Being able to detect and respond to common threats like](https://forensicitguy.github.io/analyzing-log4shell-muhstik/)**\n\ncoinminers will help any blue team detect a wide range of activity—even when it\n\nemanates from unknown exploits.\n\nMany of our Linux coinminer detections began with a Secure Shell (SSH) daemon\n\nor a web server process. While we often did not know the exact method of initial\n\naccess, the intrusion chains we observed suggested that many of them began\n\nwith weak user authentication or exploitation of web applications. After gaining\n\ninitial access, adversaries usually leveraged system utilities such as curl or wget\n\nto download additional utilities like shell scripts and coinmining binaries from\n\nexternal sources.\n\nThe shell scripts we identified performed various actions, including host\n\nreconnaissance, inhibition of competing miners, defense evasion, and persistence.\n\nTwo common persistence methods we’ve observed with miner threats like Kinsing\n\nand TeamTNT are adding SSH keys to a user’s authorized_keys file and creating\n\nscheduled tasks via the crontab command, two relatively easy techniques. A\n\nsingle shell command can be added to a script and establish hooks without much\n\neffort on the part of the adversary.\n\nThe coinmining binaries that we observed most commonly were XMRig\n\npayloads, which were often delivered by adversaries who targeted unpatched\n\n[endpoints. We observed threats such as Outlaw authenticating via SSH to](https://yoroi.company/research/outlaw-is-back-a-new-crypto-botnet-targets-european-organizations/)\n\nendpoints, presumably as a result of brute-force attempts, followed by executing\n\nshell scripts that initiated XMRig payloads named kswapd0. We also saw z0miner\n\n[exploiting vulnerabilities in Confluence to deploy XMRig payloads by executing](https://www.imperva.com/blog/attackers-exploit-cve-2021-26084-for-xmrig-crypto-mining-on-affected-confluence-servers/)\n\nvarious shell scripts.\n\n[Finally, Bird Miner tried to execute XMRig payloads on macOS hosts by using](https://blog.malwarebytes.com/mac/2019/06/new-mac-cryptominer-malwarebytes-detects-as-bird-miner-runs-by-emulating-linux/)\n\n**[Qemu to emulate a Linux environment. No matter how elaborate their initial](https://blog.malwarebytes.com/mac/2019/06/new-mac-cryptominer-malwarebytes-detects-as-bird-miner-runs-by-emulating-linux/)**\n\naccess techniques, the commonality between these threats is XMRig payloads.\n\nDue to its popularity, XMRig artifacts provide excellent opportunities for\n\ndetection, including several discussed below.\n\n\n-----\n\n###### TA K E ACTION\n\nCompromises involving coinmining have been surprisingly consistent over the last\n\n[few years, and many of the detection opportunities we have shared previously](https://redcanary.com/blog/frankenstein-was-a-hack-the-copy-paste-cryptominer/)\n\nare still relevant. Focusing on post-exploitation activity should help, regardless\n\nof whether the initial access method is a weak SSH password, outdated web\n\n[application, or exploitation of a vulnerability like Log4Shell.](https://www.lunasec.io/docs/blog/log4j-zero-day/)\n\nThe best defense against many of the coinminer compromises we observed is\n\npatch management. Many of the coinminers we saw exploited flaws in outdated\n\napplications like JBoss and WebLogic, so keeping systems updated will deter\n\nadversaries who are simply scanning for applications with known vulnerabilities.\n\nStrong authentication policies, such as multi-factor authentication (MFA) or locking\n\nauthentication to just SSH keys, should mitigate techniques like SSH brute forcing.\n\nHere are some additional detection analytics to help identify potential Linux\n\ncoinminer activity.\n\n\n###### Bash authorized_keys file modification \n\nThis detection analytic will identify instances of Bash processes making file\n\nmodifications to a user’s authorized_keys file. Kinsing coinmining malware is\n\none Linux threat that uses this technique for persistence.\n\nprocess == bash\n\n&&\n\nfilemod_filepath == .ssh/authorized_keys\n\n_*Note: There are many shells on Linux endpoints, and this analytic will likely need_\n\n_to be modified to specify the shells that are used within your Linux environment._\n\n\n-----\n\n###### Pkill with xmr in command line \n\nThis detection analytic will identify processes named pkill that have command\nline options containing the string xmr, which may be observed\n\nprior to new XMRig processes executing on infected endpoints.\n\nprocess == pkill\n\n&&\n\ncommand_line == xmr\n\n###### Renamed coinminers \n\nThis detection analytic will identify processes that have command-line\n\noptions specific to XMRig and similar miners. While command-line arguments\n\ncan be brittle, this is a great way to catch “lazy” adversaries who do little to\n\nhide their activities.\n\ncommand_line_includes (stratum || --coin || --donate-level ||\n\n**cryptonight || moneropool)**\n\n||\n\ncommand_line_includes [at least 2 of the following] (--cpu-priority ||\n\n**--max-cpu-storage || --algo || --url)**\n\n###### Process connecting to known mining pools \n\nThis detection analytic will identify non-web browser processes that initiate\n\nnetwork connections to known mining pools.\n\nprocess != (chrome || firefox || msedge || iexplore || safari)\n\n&&\n\nnetwork _connection_includes == (supportxmr || xmrpool || xmr ||\n\n**nanopool || monero)**\n\n_*Note: This is a non-exhaustive list of pools and web browsers, which you can_\n\n_add to with additional research. Additionally, this analytic will likely need to_\n\n_be tuned to your specific environment, depending on your use of browsers and_\n\n_business purposes._\n\n\n-----\n\n###### TR END\n\n## Abusing remote procedure calls\n\n###### Intrusions leveraging remote procedure calls (RPC) made waves in 2021, particularly PetitPotam and PrintNightmare.\n\nRemote procedure calls (RPC) facilitate local and remote communication\n\nbetween client and server programs. Many Windows services leverage RPCs for\n\ncommunication, and many RPCs expose functions to end users. Depending on\n\nprivilege levels and the security checks that are (or are not) performed when\n\nthese functions are implemented, adversaries can abuse RPCs to perform many\n\nmalicious actions.\n\n[We covered RPC abuse in depth on the Red Canary blog last year, but two](https://redcanary.com/blog/msrpc-to-attack/)\n\nmethods of RPC abuse stood out in 2021: PetitPotam and PrintNightmare. Both\n\nemerged over the summer, and adversaries quickly adapted them from theoretical\n\nproofs of concept for privilege escalation into real-world intrusions. Both were\n\nreportedly leveraged in ransomware campaigns, underscoring the urgency behind\n\nthese threats. We’ve done extensive testing to replicate these techniques and\n\nvalidate detective and preventive controls for them. What follows is a summary of\n\nthese compromises and what you can do to defend your organization.\n\n###### PetitPotam \n\n[First published as a proof-of-concept intrusion by researcher Gilles Lionel in July](https://twitter.com/topotam77)\n\n2021, PetitPotam allows an adversary to hijack server authentication sessions and\n\ngain access to highly sensitive systems like Active Directory Certificate Services\n\n[(AD CS). Microsoft published a security bulletin (CVE-2021-36942) in August](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-36942)\n\nthat raised the barrier of entry for PetitPotam, requiring that adversaries first\n\nauthenticate themselves with legitimate credentials to conduct the intrusion.\n\nPetitPotam enables an adversary to force authentication of a machine by\n\n[performing an NTLM relay-like intrusion against the Encrypting File System](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-efsr/08796ba8-01c8-4872-9221-1000ec2eff31)\n\n**[Remote Protocol (EFSRPC), which manages data encrypted by the Encrypting](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-efsr/08796ba8-01c8-4872-9221-1000ec2eff31)**\n\n**[File System (EFS) on remote servers. PetitPotam was particularly troubling](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-efsr/230807ac-20be-494f-86e3-4c8ac23ea584#gt_3bd30c20-9517-4030-a48c-380362e209a1)**\n\nbecause the EFSRPC exposed functionality through a DLL (efslsaext.dll)\n\n[that enabled unauthenticated communication through the LSASS pipe via](https://redcanary.com/threat-detection-report/techniques/lsass-memory/)\n\n[the EfsRpcOpenFileRaw method. Depending on the patch status, either an](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-efsr/ccc4fb75-1c86-41d7-bbc4-b278ec13bfb8)\n\nunauthenticated or an authenticated adversary can call the EfsRpcOpenFileRaw\n\n\n-----\n\n[method, intercept the authentication response (NTLM relay) between the client](https://attack.mitre.org/techniques/T1187/)\n\nand a server, and use that to authenticate to another workstation. If they target a\n\ndomain controller, an adversary could potentially compromise the entire domain\n\n[by relaying that authentication to an AD CS server. James Forshaw’s detailed](https://www.tiraniddo.dev/2021/08/how-to-secure-windows-rpc-server-and.html)\n\n**[article from August is a great place to learn more.](https://www.tiraniddo.dev/2021/08/how-to-secure-windows-rpc-server-and.html)**\n\n###### TA K E ACT ION\n\nSecurity teams seeking to observe and detect PetitPotam intrusions have multiple\n\noptions. We’ll describe relevant telemetry that can be gathered from EDR tools and\n\nnative operating system logs.\n\n[Start by monitoring the Window Security Event 4624 log for anonymous and](https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624)\n\nother suspicious logins. Many EDR products collect named pipe data, so you can\n\nalso monitor for lsarpc or efsrpc named pipe connections to domain controllers.\n\nThis will show when an unauthenticated user is trying to communicate with the\n\ndomain controller over those transport protocols.\n\n[Microsoft has published extensive mitigation guidance describing many](https://support.microsoft.com/en-gb/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429)\n\ncontrols that administrators can implement to prevent NTLM intrusions in\n\ngeneral—some of them more than a decade old—and many of these protections\n\napply to PetitPotam. If it’s feasible in your environment, the following can help to\n\nmitigate PetitPotam intrusions:\n\n - Update domain controllers and workstations to patch machines\n\nagainst CVE-2021-36942.\n\n - • **[Disable or set EFS Service startup type to disabled if service is not](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/set-service?view=powershell-7.2#:~:text=%2D-,StartupType,-Specifies%20the%20start)**\n\nbeing used.\n\n - [Enable SMB signing to prevent relay intrusions.](https://support.microsoft.com/en-gb/topic/kb5005413-mitigating-ntlm-relay-attacks-on-active-directory-certificate-services-ad-cs-3612b773-4043-4aa9-b23d-b87910cd3429)\n\n - [Apply an RPC filter to only allow authenticated connection to the EFS service](https://github.com/jsecurity101/MSRPC-to-ATTACK/blob/main/documents/MS-EFSR.md)\n\nover Kerberos.\n\n###### PrintNightmare \n\n[In July 2021, researchers Zhiniang Peng and Xuefeng Li disclosed a Windows](https://twitter.com/edwardzpeng/)\n\n[vulnerability called “PrintNightmare” (CVE 2021-34527) that enabled adversaries](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34527)\n\nto perform remote code execution and privilege escalation in two different ways.\n\nThe objective of each is to connect to a remote host without authentication and\n\ncause it to load a malicious DLL One method abuses the driver installation feature\n\n\n-----\n\nof the Print System Remote Protocol (MS-RPRN) protocol, while the other abuses\n\na similar driver installation feature of a different protocol, the Print System\n\nAsynchronous Remote Protocol (MS-PAR) protocol. In both cases, an inbound\n\n[connection is accepted by the print spooler service (running as SYSTEM), which](https://docs.microsoft.com/en-us/windows/win32/printdocs/print-spooler)\n\nallows the creation of a separate process also running as SYSTEM. Once an\n\nadversary gains SYSTEM level privileges, they effectively have full control over\n\nthat host.\n\n\n-----\n\n###### TR END\n\n## Defense validation and testing\n\n###### Confirmed testing comprised almost one quarter of our detections in 2021, with many coming from open source tools.\n\nWe see a lot of testing. In fact, 23.4 percent of all the confirmed threats we\n\ndetected in 2021 were confirmed by customers to be testing. We’re all for testing\n\n[(as you can hopefully tell by our work with Atomic Red Team), and we wanted to](https://atomicredteam.io)\n\nshare what we’ve observed about testing when compared to “proper villains.”\n\nWe also have some suggestions for how to make testing more effective.\n\nIn aggregate, confirmed testing behaviors we observed in 2021 differed\n\nsignificantly when compared to non-testing behaviors. When comparing the\n\ntop 10 detection analytics that appeared in detections marked by customers\n\nas testing to those that fired in detections not marked as testing, only three\n\nanalytics overlapped. Here are some patterns we observed in testing\n\ndetections during 2021.\n\n###### Common testing tools \n\nUnsurprisingly, a large volume of the testing detections we observed were from\n\ncommon breach and intrusion simulation tools and open source testing tools.\n\n[For example, a detection analytic on CrackMapExec execution from cmd.exe](https://github.com/byt3bl33d3r/CrackMapExec)\n\nappeared in our top testing techniques, but not in our non-testing detections.\n\nCrackMapExec is a post-exploitation tool to audit and assess security in Active\n\nDirectory environments, so it is a natural choice for testing. This suggests that\n\nCrackMapExec is more widely used by testers than non-testers.\n\n[Throughout 2021, we also frequently observed Mimikatz, BloodHound,](https://redcanary.com/threat-detection-report/threats/mimikatz)\n\n**[Impacket, Cobalt Strike, and Metasploit in testing—so much so that testing](https://redcanary.com/threat-detection-report/threats/impacket)**\n\n[detections involving these tools helped all of them make it into our top 10](https://redcanary.com/threat-detection-report/threats/)\n\n**[threats this year. We consider all of these tools to be “dual-use”—they are used](https://redcanary.com/threat-detection-report/threats/)**\n\nby both adversaries and legitimate users. These dual-use tools present a challenge\n\nbecause it can be difficult to determine if their use is malicious or benign without\n\nadditional context and understanding of what is normal in an environment. We\n\nrecommend all organizations have a clear understanding of authorized use of\n\nthese tools in their environments and treat unconfirmed testing as malicious\n\nactivity until proven otherwise.\n\n\n-----\n\n###### Credential theft methods \n\nWe frequently observe credential theft during testing, which is a positive because\n\nadversaries frequently do this as well. However, we’ve noticed that testers often\n\nfocus narrowly on two approaches for credential dumping. One analytic that\n\nfires frequently in testing detections identifies cross-process injection or access\n\nactivity from rundll32.exe to lsass.exe. Another analytic identifies instances of\n\n**rundll32.exe dumping process memory using MiniDump, a built-in code library.**\n\nPart of the reason we observe these behaviors so frequently is because they are\n\nintegrated into multiple automated breach and intrusion simulation tools, making\n\nit more likely for this behavior to occur at scale.\n\n###### Noisy discovery commands \n\nAnother pattern in our testing detections is quick execution of a series of discovery\n\ncommands such as ipconfig, whoami, and others. This is in opposition to what\n\nwe see from many adversaries, who often perform fewer discovery commands in\n\na more targeted way. For example, one of the top analytics we used for detecting\n\ntesting was for enumeration of Windows Domain Administrator accounts with\n\ncommands like net domain admins. While non-testers use this command as well,\n\nwe found that testers use it more frequently.\n\n\n###### TA K E ACT ION\n\nBased on our findings, we encourage organizations to be thoughtful about their\n\ntesting goals. One approach is to test atomic behaviors without considering the\n\nsurrounding behavior. This can be helpful to determine if you have the ability to\n\npotentially detect that behavior. However, consider also adopting a goal to test a\n\nfull intrusion chain. This may look different than testing for atomic behaviors—for\n\nexample, instead of executing 20 discovery commands in quick sequence, you\n\ncould execute one or two discovery commands followed by other activity, then\n\nreturn to additional discovery commands.\n\nOne approach that can help ensure you’re testing based on real-world threats that\n\nmatter is to enhance testing with threat intelligence. Adversary emulation, in which\n\ntesters use threat intelligence to try to carefully mimic threats of concern as closely\n\nas possible, is a widespread methodology that can provide significant value and\n\n[help organizations improve testing. MITRE’s adversary emulation plans provide](https://github.com/center-for-threat-informed-defense/adversary_emulation_library)\n\na helpful starting point.\n\nWe also recommend changing up your toolset. Automated red teaming and testing\n\ntools are powerful, but they are often easier for defenders to detect. To ensure your\n\norganization has robust detection capabilities for a range of behaviors, consider\n\ndifferent ways you could test the same techniques. For example, instead of just\n\nusing Mimikatz for credential dumping, try using Gsecdump, NPPSpy, or other tests\n\n[from Atomic Red Team.](https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1003/T1003.yaml)\n\n\n-----\n\n-----\n\n## Top threats\n\nThe following chart illustrates the specific threats Red Canary detected most\nfrequently across our customer environments in 2021. We ranked these threats\nby the percentage of customer organizations affected to prevent a single, major\nmalware outbreak from skewing the metrics.\n\n[As discussed in our Methodology section, we chose to define “threats” broadly](https://redcanary.com/threat-detection-report/methodology/)\nas malware, tools, threat groups, or activity clusters. Eight of our top 10 threats\nare malware families or tools, while one (TA551) is a threat group named by\nanother team (Proofpoint) and another an activity cluster created by Red\nCanary (Yellow Cockatoo). This is expected because distinct malware families\nand tools are often more straightforward to identify, while associating activity\nto threat groups or activity clusters requires longer-term analysis that may\nextend beyond the year.\n\nThis was our second year tracking top threats. When compared to the top\nthreats in 2020, the overall percentage of customers affected by each threat was\ndown. For example, in 2020, 15.5 percent of customers were affected by TA551,\ncompared to 10.2 percent of customers in 2021. While it’s unclear whether this is\nanything more than a natural ebb and flow of activity, we suspect one factor is\nthe overall increase in detection volume we observed in 2021.\n\n###### How to use our analysis\n\nThese are the most prevalent threats occurring in our customer environments,\nso we can assume they are prevalent elsewhere. We include advice for\nresponding to each threat and offer detection opportunities so you can better\ndefend your organization. Some defenders may be able to take our detection\nguidance and apply it directly, while others may not. Regardless, defenders\nwithout a detection engineering function can still make use of the actionable\nanalysis of each threat written by our Intelligence team experts.\n\n\nwithout a detection engineering function can still make use of the actionable\n\n\n-----\n\n## Top threats\n\n\n50%\n\n\n###### 1\n\n 2\n\n 3\n\n 4\n\n 5\n\n 6\n\n 7\n\n 8\n\n 9\n\n 9\n\n\n###### 8.8%\n\n\n###### TA551\n\n Mimikatz\n\n Cobalt Strike\n\n Qbot\n\n Impacket\n\n SocGholish\n\n Yellow Cockatoo\n\n Metasploit Framework\n\n Gootkit\n\n BloodHound\n\n\n###### 7.9%\n\n\n###### 6.8%\n\n\n###### 5.9%\n\n\n###### 5.5%\n\n\n###### 5.0%\n\n\n###### 3.9%\n\n\n###### 3.8%\n\n\n###### 3.8%\n\n\n_Note: We analyzed each of the top 10 threats in last year’s Threat Detection report._\n_However, since there is significant overlap between the top threats for 2021 and_\n_2022, we opted only to analyze new entrants to the top 10 or reanalyze existing top_\n_10 threats that have changed significantly._\n\n\n-----\n\n###### TOP T EN T HR EAT HIG HLIGHTS\n\n## Cobalt Strike\n\n###### Cobalt Strike continues to be a favorite C2 tool among adversaries, as many rely on its functionality to maintain a foothold into victim organizations.\n\n### Analysis\n\nCobalt Strike has never been more popular, as adversaries are increasingly\n\nadopting it as their favorite C2 tool. Adversaries—ransomware operators in\n\nparticular—rely substantially on Cobalt Strike’s core functionalities as they seek\n\nto deepen their foothold in their victims’ environments. Its speed, flexibility,\n\nand advanced features are likely contributing factors as to why ransomware\n\nattacks have been ticking upward in recent years. Some of the most notorious\n\n[ransomware operators— including groups like Conti, Ryuk, and REvil/](https://www.cisa.gov/uscert/ncas/alerts/aa21-265a)\n\n**[Sodinokibi—are known to rely heavily on Cobalt Strike in their attacks.](https://unit42.paloaltonetworks.com/revil-threat-actors/)**\n\nThe security community is embracing the fact that whatever functional label you\n\nplace on Cobalt Strike, it’s here to stay, it’s implicated in all variety of intrusions,\n\nand it’s our duty to defend against it. Luckily for defenders, over the course of\n\nthis past year the security community has produced a plethora of great technical\n\nanalysis and detection opportunities around preventing and investigating\n\nCobalt Strike. Some of the more common detection strategies documented in\n\npublic reporting include:\n\n- command-line monitoring\n\n- public network infrastructure scanning\n\n- in-memory scanning\n\n- dynamic/static binary analysis\n\n- abnormal process lineage\n\n- network traffic monitoring\n\n- baselining the prevalence of reconnaissance commands\n\nKeep in mind that although many of these methods of detection can be easily\n\nbypassed with changes to the Cobalt Strike configurations, we highly suggest\n\nusing them as a stopgap until your teams develop more advanced methods.\n\nThe security community has shared invaluable public resources on analyzing\n\n[and detecting Cobalt Strike. Our detection opportunities from last year’s](https://redcanary.com/threat-detection-report/threats/cobalt-strike/)\n\n**[Threat Detection Report remain effective. For defenders getting started with](https://redcanary.com/threat-detection-report/threats/cobalt-strike/)**\n\nunderstanding how the tool works and operates, we highly recommend reading\n\n\n-----\n\neach of the following resources because they all have unique takeaways and\n\ncover a majority of the most effective detection techniques:\n\n- **[https://www.mandiant.com/resources/defining-cobalt-strike-components](https://www.mandiant.com/resources/defining-cobalt-strike-components)**\n\n- **[https://blog.talosintelligence.com/2020/09/coverage-strikes-back-cobalt-strike-paper.html](https://blog.talosintelligence.com/2020/09/coverage-strikes-back-cobalt-strike-paper.html)**\n\n- **[https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/](https://thedfirreport.com/2021/08/29/cobalt-strike-a-defenders-guide/)**\n\n- **[https://thedfirreport.com/2022/01/24/cobalt-strike-a-defenders-guide-part-2/](https://thedfirreport.com/2022/01/24/cobalt-strike-a-defenders-guide-part-2/)**\n\n- **[https://go.recordedfuture.com/hubfs/reports/mtp-2021-0914.pdf](https://thedfirreport.com/2022/01/24/cobalt-strike-a-defenders-guide-part-2/)**\n\n### Detection opportunities\n\n###### Cobalt Strike beacon implant\n\nThis detection analytic identifies an adversary using a Cobalt Strike beacon\n\nimplant to pivot and issue commands over SMB through the use of configurable\n\nnamed pipes. Cobalt Strike beacons have configurable options to allow SMB\n\ncommunication over named pipes, utilizing a host of default names commonly\n\nused by adversaries. Analysis should focus on any file modifications to a\n\nsuspicious named pipe within this process.\n\nfile_modifications_include (pipe\\msagent_ || pipe\\interprocess_ ||\n\n**pipe\\lsarpc_ || pipe\\samr_ || pipe\\netlogon_ || pipe\\wkssvc_ ||**\n\n**pipe\\srvsvc_ || pipe\\mojo_ || pipe\\postex || pipe\\status_ || pipe\\msse-)**\n\n###### ​Rundll32.exe to spawn SQL Server Client Configuration Utility\n\nThis analytic identifies instances of ​rundll32.exe spawning the SQL Server\n\nClient Configuration Utility ( ​cliconfg.exe ). We often see this pattern of process\n\nexecution when Cobalt Strike leverages DLL Search Order Hijacking as a method\n\nof UAC bypass.\n\nparent_process == **​rundll32.exe**\n\n&&\n\nprocess == **​cliconfg.exe**\n\n\n-----\n\n###### Command-line patterns for Cobalt Strike beacons via GetSystem\n\nThis analytic identifies commonly observed command-line patterns when\n\n[Cobalt Strike beacons escalate privileges via the GetSystem feature.](https://redcanary.com/blog/getsystem-offsec/)\n\n[Adversaries use GetSystem to impersonate a token for the SYSTEM account.](https://www.cobaltstrike.com/blog/what-happens-when-i-type-getsystem/)\n\nThis level of access allows an adversary to perform privileged actions beyond\n\nthat of an administrator.\n\nprocess == **​cmd**\n\n&&\n\ncommand_line_includes (/(?i)echo\\s+[0-9a-f]{11}\\s+\\>\\;?\\s+\\\\\\\\\\.\\\\\n\n**pipe\\\\[0-9a-f]{6}/.match)**\n\n_*Note: The above regular expression will match on the following example what of_\n\n_using GetSystem may look like via a Cobalt Strike beacon:_\n\n**C:\\Windows\\system32\\cmd.exe /c echo 92d8cc45954 >; \\\\.\\**\n\n**pipe\\446b3c**\n\n\n-----\n\n###### TOP T EN T HR EAT HIG HLIGHTS\n\n## Impacket\n\n###### Though Impacket is used legitimately for testing, it is often abused by ransomware operators and other adversaries, thanks in large part to  its versatility.\n\n### Analysis\n\nAt its core, Impacket is a collection of Python libraries that plug into\n\napplications like vulnerability scanners, allowing them to work with Windows\n\nnetwork protocols. These Python classes are used in multiple tools, including\n\npost-exploitation and vulnerability-scanning products, to facilitate command\n\nexecution over Server Message Block (SMB) and Windows Management\n\nInstrumentation (WMI). Oftentimes the popular Python scripts ​smbexec, ​\n\n**wmiexec, or ​dcomexec are used directly without referring to Impacket, as**\n\nthey are versatile and easily implemented code samples. This is the first year\n\nthat Impacket made it into our top 10 threat rankings, which we attribute to\n\nincreased use by adversaries and testers alike.\n\nImpacket is an interesting tool as we consider it “dual-use”—it’s leveraged by\n\nboth adversaries and legitimate users. It’s often used “behind the scenes” by\n\nadministration and vulnerability-scanning applications, including Linux tools\n\nthat manage or scan Windows environments. While Impacket is fairly easy to\n\ndetect, it can be challenging to determine if it is malicious or benign without\n\nadditional context and understanding of what is normal in an environment.\n\nWhile threats such as FIN8 malware BADHATCH and multiple ransomware\n\noperators have used Impacket, approximately one third of the Impacket\n\ndetections we saw in 2021 were from confirmed testing. We recommend all\n\norganizations have a clear understanding of authorized use of Impacket in their\n\nenvironments, and consider any activity outside of that to be malicious until\n\nproven otherwise.\n\nThroughout 2021, operators of Conti, SunCrypt, Yanluowang, Cring, and\n\nVice Society ransomware all used Impacket at some point during intrusions.\n\nImpacket acted as a sort of swiss army knife during intrusions, allowing\n\nadversaries to:\n\n- retrieve credentials using ​secretsdump.py functionality (SunCrypt)\n\n- issue commands on remote systems during lateral movement (SunCrypt)\n\n- deliver a ransomware binary using ​smbexec.py (Cring and Vice Society)\n\n\n-----\n\n###### Responding to Impacket\n\nResponse actions may vary depending on the Impacket script component the\n\nadversary is leveraging. If you detect a malicious instance of Impacket, seriously\n\nconsider isolating the endpoint because there’s likely an active adversary in\n\nyour environment.\n\nOnce the endpoint is isolated, evaluate if the adversary loaded other tools, if\n\nthey were able to move laterally from the device, and if they stole credentials.\n\nIf the adversary moved laterally, isolate any devices they may have accessed. If\n\nthere is evidence of credential theft, reset passwords for the impacted accounts.\n\nPlease note that if the adversary leveraged Kerberos, passwords will need a\n\ndouble reset over the course of 10 hours (based on the default 10-hour ticket\n\nTime to Live setting) to reset and invalidate existing tickets.\n\nFollowing the initial response steps above, stop any active processes\n\nassociated with Impacket, remove any malicious files written to disk, and\n\nremove any changes to the device made by the adversary. Reimaging impacted\n\ndevices is not out of the question, since an adversary may have installed other\n\ntools or established persistence.\n\n### Detection opportunities\n\n###### ​WMIexec execution\n\nThis detection analytic uses a regular expression to identify commands from the\n\nImpacket ​wmiexec script, which allows a semi-interactive shell used via WMI.\n\nThis analytic shows output being redirected to the localhost ​ADMIN$ share. The\n\nregular expression identifies an output file named as a Unix timestamp (similar\n\nto 1642629756.323274) generated through the script.\n\nparent_process == **​wmiprvse.exe**\n\n&&\n\nprocess == **​cmd.exe**\n\n&&\n\ncommand_line_includes (/(?i)cmd.exe \\/Q \\/c .*\\\\\\\\127.0.0.1\\\\\n\n**ADMIN\\$\\\\__[0-9]{1,10}\\.[0-9]{1,10} 2>&1/))**\n\n###### ​SMBexec execution\n\nThis detection analytic uses a regular expression to identify commands from the\n\n\n-----\n\nImpacket ​smbexec script, which allows a semi-interactive shell used through\n\nSMB. The regular expression identifies the name of a file share used to store\n\noutput from the commands for interaction.\n\nparent_process == **​services.exe**\n\n&&\n\nprocess == **​cmd.exe**\n\n&&\n\ncommand_line_includes (/(?i)cmd.exe \\/Q \\/c echo cd \\^>\n\n**\\\\\\\\127.0.0.1\\\\[a-zA-Z]{1,}\\$\\\\__output 2\\^>\\^&1 > .* & /)**\n\n\n-----\n\n###### TOP T EN T HR EAT HIG HLIGHTS\n\n## SocGholish\n\n###### SocGholish leverages drive-by-downloads masquerading as software updates to trick visitors of compromised websites into executing malware.\n\n### Analysis\n\nSocGholish is an initial access threat that leverages drive-by-downloads\n\nmasquerading as software updates. Active since at least April 2018, SocGholish\n\n[has been linked to the suspected Russian cybercrime group Evil Corp (also](https://www.truesec.com/hub/blog/are-the-notorious-cyber-criminals-evil-corp-actually-russian-spies)\n\nknown as Indrik Spider). Red Canary encountered SocGholish in a wide variety\n\nof industry verticals in 2021. These drive-by-downloads placed SocGholish\n\ninside the top five most prevalent threats we track. This ranking was fueled\n\nby an increasing number of detections as the year went on, culminating in\n\nSocGholish peaking as the most prevalent threat we encountered in December.\n\n###### Red Canary customers affected by SocGholish in 2021\n\n\n-----\n\nA SocGholish drive-by-download occurs when an unsuspecting user visits\n\na compromised website and downloads a malicious ZIP file. In one incident\n\ndescribed by Expel earlier this year, adversaries compromised an organization’s\n\nsite that was running a vulnerable version of WordPress. Employee endpoints\n\nwere then infected with drive-by-downloads of SocGholish directly from\n\nthe company’s own website. SocGholish relies on social engineering to gain\n\nexecution, tricking unsuspecting users into running a malicious JavaScript\n\npayload stored within a downloaded ZIP file. These files typically masquerade\n\nas browser updates, though other lures include Adobe Flash or Microsoft\n\nTeams. Once executed, the JavaScript payload connects back to SocGholish\n\ninfrastructure, where it shares details about the infected host and can retrieve\n\nadditional malware.\n\nIn 2021, Red Canary observed NetSupport RAT and BLISTER malware delivered\n\nby SocGholish. In the past, we have seen SocGholish deploy a Cobalt Strike\n\npayload that led to WastedLocker ransomware. The connection between\n\nSocGholish and BLISTER is notable, as this malware loader was only identified\n\nby Elastic in late December 2021. Following BLISTER deployment in an\n\nenvironment initially compromised with SocGholish, we detected several\n\npost-exploitation reconnaissance behaviors on the affected endpoint.\n\nThe majority of SocGholish infections we’ve detected did not result in a second\nstage payload, sometimes due to existing mitigations or rapid response to\n\nisolate the host. In most cases, we observed reconnaissance activity that only\n\nidentified the infected endpoint and user. In some cases, Active Directory and\n\ndomain enumeration followed user discovery. Both of these can be a precursor\n\nto lateral movement, however, the hosts were isolated before any lateral\n\nmovement activity could begin. Much of the reconnaissance conducted by the\n\nmalicious JavaScript file happens in memory, with data being exfiltrated directly\n\nvia POST commands to the C2 domain. One good source of insight into this\n\nbehavior comes from collecting script load content, if such telemetry is available\n\nfrom your endpoint detection and response (EDR) sensor. Collecting this data\n\nprovides key insight into the specific commands executed and data exfiltrated.\n\n### Detection opportunities\n\n###### JavaScript executing from a ZIP file and making external network connections\n\nExecuting script contents from within a ZIP file is unusual, especially when that\n\nscript is making external network connections. This detection analytic regularly\n\nidentifies the initial execution and network connections from a SocGholish\n\nJavaScript payload extracted from a ZIP file.\n\n\n-----\n\nprocess == **​wscript.exe**\n\n&&\n\ncommand_line_includes ( **.zip** && **​.js** )\n\n&&\n\nhas_external_netconn\n\n###### Script files conducting reconnaissance with whoami and writing the output to a file\n\nSocGholish employs several scripted reconnaissance commands. While much of\n\nthis activity occurs in memory, one that stands out is the execution of whoami\n\nwith the output redirected to a local temp file with the naming convention\n\n**rad<5-hex-chars>.tmp.**\n\nparent_process == **​wscript.exe**\n\n&&\n\nprocess == **​cmd.exe**\n\n&&\n\ncommand_line_includes ( **​whoami/all>>** )\n\n###### Enumerating domain trusts activity  with ​nltest.exe\n\nLeft unchecked, SocGholish may lead to domain discovery. This type of behavior\n\nis often a precursor to ransomware activity, and should be quickly quelled to\n\nprevent further progression of the threat.\n\nprocess == **​nltest.exe**\n\n&&\n\ncommand_line_includes (/domain_trusts || /all_trusts)\n\n\n-----\n\n###### TOP T EN T HR EAT HIG HLIGHTS\n\n## Yellow Cockatoo\n\n###### Yellow Cockatoo is an activity cluster involving a remote access trojan (RAT) that filelessly delivers various other malware modules.\n\n### Analysis\n\nAs Yellow Cockatoo uses effective search engine poisoning tactics, can stealthily\n\npersist in a compromised environment, and appears to affect a wide array of\n\norganizations across various sectors and geographies, we weren’t surprised\n\nto see it crack our top 10 threats in 2021. In September the volume of Yellow\n\nCockatoo detections increased substantially (relative to earlier in the year). This\n\nmay have been the result of a new installation mechanism, chronicled in detail\n\nby researchers from Morphisec (they call this threat “Jupyter”).\n\nWhile much of the public reporting, notably a robust profile published by\n\nMorphisec, covers an infostealer component of Yellow Cockatoo, we often\n\nobserve behaviors that occur earlier in the Yellow Cockatoo kill chains. This\n\ntypically includes installation mechanisms, which deliver code that runs\n\npersistently. This code later downloads and executes additional modules that\n\nare never written to disk. In many of the instances of Yellow Cockatoo activity\n\nwe observed, the payloads were a minimal version of the original components\n\ndocumented by Morphisec, with the infostealer functionality delegated to\n\nadditional modules.\n\nYellow Cockatoo tradecraft is wide-ranging, and there are several variations on\n\nits attack chain. Over time, the most significant detection opportunities stem\n\nfrom the behaviors we observe consistently. These include but are not limited to\n\nthe tradecraft outlined below.\n\n###### Initial access: Search engine redirects enable Yellow Cockatoo operators to\n\nperform seemingly targeted social engineering attacks at scale. Initial access\n\nby Yellow Cockatoo often occurs via a search engine redirect that directs a\n\nuser from a legitimate search engine to a site that downloads a malicious file\n\nbearing the victim’s search query as its name (for example: “this-is-my-search\nquery.msi” or “this-is-my-search-query.exe”). Because potential victims are\n\ndirected to a site based on a search they initiated, they may be more inclined\n\nto engage with its content. Though many adversaries craft tailored attacks and\n\nleverage familiar themes, Yellow Cockatoo is unique in its ability to dynamically\n\n“customize” its attacks based on victims’ real-time searches.\n\n\n-----\n\n###### Execution: Following installation, the EXE or MSI file spawns a command line\n\nand creates a similarly named TMP file that launches PowerShell. All of this is\n\nprecursor activity that leads to the execution of a malicious dynamic link library\n\n(DLL). This is a remote access trojan (RAT) implemented as a .NET assembly\n\ndesigned to be reflectively loaded into PowerShell.\n\n###### Defense evasion: Since Yellow Cockatoo’s follow-on activity occurs in \n\nmemory, it poses a unique challenge to defenders. Yellow Cockatoo uses XOR\n\nand Base64 encoding to ensure its files are obfuscated and do not exist in\n\ncleartext on disk. Cleartext is only present in memory and only exists after it is\n\ninvoked by its loader. Accordingly, static detection rules for files on disk may\n\nmiss malware components.\n\nTo harden your attack surface against the search engine redirects commonly\n\nused by Yellow Cockatoo, we recommend taking steps to prevent access to\n\nmalicious domains and other malicious content on the internet. This could\n\ninvolve configuring your web proxy to block newly registered and low\nreputation domains (e.g.,*.tk, *.top, and *.gg) and block advertisements.\n\n### Detection opportunities\n\n###### PowerShell writing startup shortcuts\n\nWe frequently observe adversaries using PowerShell to write malicious LNK files\n\ninto the startup directory to establish persistence. Accordingly, this detection\n\nopportunity is likely to identify persistence mechanisms in multiple threats. In\n\nthe context of Yellow Cockatoo, this persistence mechanism eventually launches\n\nthe command-line script that leads to the installation of a malicious DLL:\n\nprocess == **​powershell.exe**\n\n&&\n\ncommand_line_includes ( **​appdata** )\n\n&&\n\nfilemod_path_includes (start menu\\programs\\startup)\n\n&&\n\nfilemod_extension == **​.Ink**\n\n_*Note: You can test the efficacy of this detection opportunity by running this Atomic_\n\n_Red Team test in PowerShell with elevated privileges._\n\n\n-----\n\n###### PowerShell utilizing System.Reflection. Assembly to load a DLL\n\nThis detection analytic identifies PowerShell using System.Reflection.\n\n**Assembly. to load a DLL. However, this analytic may generate false positives in**\n\nyour environment and likely requires tuning.\n\nprocess == **​powershell.exe**\n\n&&\n\ncommand_line_includes ( **​reflection.assembly** )\n\n&&\n\ncommand_line_regex_encoded == /(?i)::\\(?load\\)?(?:|file)\\(/\n\n\n-----\n\n###### TOP T EN T HR EAT HIG HLIGHTS\n\n## Gootkit\n\n###### Gootkit is a banking trojan that can deliver additional payloads, siphon data from victims, and stealthily persist in a compromised environment.\n\n### Analysis\n\nA malware threat with a JavaScript loader component, Gootkit has been actively\n\nobserved in the wild for more than a decade. Over the past several years, it has\n\nevolved into a multi-stage tool used to facilitate a range of hands-on-keyboard\n\nactivity in multi-pronged attacks, wherein more than one objective is likely\n\n[accomplished. Gootkit was originally delivered via spam email campaigns and](https://securityintelligence.com/gootkit-bobbing-and-weaving-to-avoid-prying-eyes/)\n\nolder exploit kits, but over time its initial access has shifted to SEO poisoning\n\ntactics. Specifically, operators alter search engine results to direct victims\n\n[to legitimate but compromised websites hosting Gootkit. Upon visiting](https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/)\n\na compromised website, victims are prompted to download a ZIP archive\n\ncontaining a malicious JavaScript file, which if executed can allow an adversary\n\n[to remotely access a victim’s system. While some researchers track the delivery](https://news.sophos.com/en-us/2021/03/01/gootloader-expands-its-payload-delivery-options/)\n\nmechanism as “Gootloader” and the trojan activity as “Gootkit,” Red Canary\n\ntracks both components as “Gootkit.” Our classification may shift as we gather\n\nadditional information.\n\nFollow-on activity varies. In 2021, Red Canary saw operators use Gootkit\n\nto deliver Cobalt Strike. Though we didn’t observe any ransomware in that\n\nintrusion, the intrusion chain mirrored public reporting of compromises\n\nwhere victims’ networks were ultimately encrypted with Sodinokibi (REvil)\n\n[ransomware. Based on public research and follow-on activity observed in](https://www.proofpoint.com/us/threat-insight/post/danabot-new-banking-trojan-surfaces-down-under-0)\n\ncustomer environments last year, it’s likely that Gootkit operators facilitate\n\nransomware-as-a-service (RaaS) activity in some cases, either deploying other\n\npayloads directly or selling access to environments with Gootkit infections. We\n\nhave also observed Gootkit dropping the Osiris banking trojan.\n\nWhile we’ve observed Gootkit detections in customer environments across\n\nmultiple sectors, almost without exception, infections occurred after victims\n\nvisited compromised websites purporting to host content related to legal or\n\n[financial agreements. Victims were likely directed to these sites after initiating](https://threatpost.com/malware-loader-google-seo-payload/164377/)\n\nqueries in common search engines with keywords such as “agreement,”\n\n“contract,” and the names of various financial institutions. Given the volume\n\nof Gootkit detections and the range of victims, this threat is likely more\n\nopportunistic than targeted to a specific industry or organization. Accordingly,\n\nGootkit remains a threat to all organizations.\n\n\n-----\n\nOne hypothesis as to why we observe Gootkit so frequently is that it is\n\ndownloaded from sites victims navigated to based on search results they\n\ninitiated themselves, as we further discuss in the user-initiated initial\n\naccess section.\n\n### Detection opportunities\n\n###### Windows Scripting Host executing  JavaScript files\n\nThis detection analytic will identify unusual activity originating from ​wscript.\n\n**exe executing JavaScript files from the ​%APPDATA% directory. This applies**\n\nto GootKit because the initial loader for the threat is implemented in JavaScript\n\nthat gets executed via ​wscript.exe when the victim double-clicks on the\n\ndownloaded loader.\n\nprocess == **​wscript.exe**\n\n&&\n\nfile_path_includes ( **​%APPDATA%** )\n\n###### PowerShell using a shortened ​ EncodedCommand flag\n\nThis detection analytic will identify use of the shortened ​EncodedCommand\n\nflag in PowerShell, a tactic often used by Gootkit operators and others to\n\nobfuscate malicious code on an endpoint. Like all detection analytics, this may\n\ngenerate some false positives in your environment that require tuning. This\n\napplies to GootKit at multiple stages after the loader, when this threat uses\n\nPowerShell to deobfuscate and execute downloaded payloads.\n\nprocess == **​powershell.exe**\n\n&&\n\ncommand_line_includes == [any variation of the **​-encodedcommand**\n\nswitch]*\n\n_*Note: the encoded command switch has many variations, including_ **​**\n\n**-encodedcommand** _,_ **​-e** _,_ **​-enc** _, and many other variations_\n\n\n-----\n\n###### TOP T EN T HR EAT HIG HLIGHTS\n\n## BloodHound\n\n###### BloodHound is an open source tool that provides visibility into Active Directory environments. It is a common precursor to follow-on activity, whether that’s further testing or ransomware.\n\n### Analysis\n\n**[BloodHound is an open source tool that can be used to identify attack paths](https://github.com/BloodHoundAD/BloodHound)**\n\n[and relationships in an Active Directory (AD) environment. Like Impacket, this is](https://redcanary.com/threat-detection-report/threats/impacket)\n\nthe first year BloodHound made it into our top 10 threat rankings, thanks to both\n\ntesting activity and adversary use. It is popular among adversaries and testers\n\nbecause having information about an AD environment can enable further lateral\n\nmovement throughout a network. BloodHound has multiple components,\n\nincluding SharpHound, which is a data collector for BloodHound written in\n\nC#. Throughout 2021, SharpHound was one of the most common BloodHound\n\ncomponents we observed.\n\n[Multiple adversaries used BloodHound during 2021, including FIN12 and](https://www.mandiant.com/resources/fin12-ransomware-intrusion-actor-pursuing-healthcare-targets)\n\noperators of Yanluowang ransomware. We also observed BloodHound being\n\n[used by operators in conjunction with Cobalt Strike only 75 minutes after a](https://redcanary.com/threat-detection-report/threats/cobalt-strike)\n\n[user first opened a malicious XLS phishing lure that initiated a SquirrelWaffle](https://twitter.com/redcanary/status/1455928677061971971)\n\nmalware payload.\n\nBecause adversaries often leverage BloodHound early in their intrusion,\n\ndefenders should be prepared with robust detection and a quick response to\n\nstop the malware in its tracks. BloodHound’s role as a dual-use tool can make it\n\nparticularly challenging to determine if its presence is authorized or malicious,\n\nmeaning that a solid understanding of its allowed use in an environment is\n\ncritical to respond appropriately.\n\nIdentifying SharpHound components gathering data can be challenging. To\n\ngather AD data, SharpHound connects to multiple hosts over ports 137 and 445,\n\nalong with multiple named pipe connections. As your environment scales larger,\n\nthe noise from SharpHound will scale accordingly. For most organizations,\n\nSharpHound activity will likely appear to be SMB scanning activity until\n\ninvestigated further.\n\n\n-----\n\n### Detection opportunities\n\n###### High-volume port 445 connections\n\nThis detection opportunity identifies a single process exceeding a set threshold\n\nfor a normal volume of network connections to port 445. We did not specify logic\n\nfor this detection analytic, since the normal number of connections will differ\n\nin each environment. While it takes some tuning, this analytic helps detect not\n\nonly BloodHound, but also various types of post-exploitation SMB scanning and\n\nlateral movement.\n\n###### Common BloodHound command-line options\n\nThis detection analytic identifies processes that contain common command\n\nlines consistent with the execution of BloodHound. While this is a simple\n\nanalytic, we’ve found it to be effective in identifying BloodHound. It’s a good\n\nsupplement to the port 445 analytic, which can require more tuning.\n\ncommand_line_includes (-collectionMethod || invoke-bloodhound ||\n\n**get-bloodHounddata)**\n\n\n-----\n\n###### THR EAT: NEW ACT IV ITY CLUSTER\n\n## Rose Flamingo\n\n###### Rose Flamingo relies on search engine optimization (SEO) poisoning to trick victims into infecting themselves.\n\n### Analysis\n\nRose Flamingo is an activity cluster named by Red Canary that focuses on\n\nopportunistic, financially motivated malware as an initial access broker. Rose\n\nFlamingo targets victims who are looking to download licensed software\n\nwithout having to pay for it. Payloads related to Rose Flamingo typically arrive\n\nas archive files that are distributed via phony file-sharing websites purporting to\n\nprovide users with “free” cracked software packages. To lure potential victims,\n\n[the adversaries behind Rose Flamingo use search engine optimization (SEO)](https://blog.malwarebytes.com/cybercrime/hacking/2018/05/seo-poisoning-is-it-worth-it/)\n\n**[poisoning to elevate a malicious site’s search ranking.](https://blog.malwarebytes.com/cybercrime/hacking/2018/05/seo-poisoning-is-it-worth-it/)**\n\nRose Flamingo victims will typically download a ZIP archive file containing two\n\nfiles at a minimum. Archives related to Rose Flamingo may contain words like ​\n\n**free, ​key, ​download, ​license, ​latest, ​ISO, and ​crack . While these archives**\n\nusually appear as ZIP files, they infrequently appear as other compressed\n\narchive formats as well. The files in a typical Rose Flamingo archive are a\n\n“password” text file and one password-protected archive. Some iterations\n\nof these “password” files contain the password and some classic ASCII art,\n\nas shown below, though the purpose behind the art is unknown. This type of\n\ndelivery method conceals the malicious payloads that are contained within the\n\npassword-protected archive from any prying security software\n\n**Fi** **2 Th** t t f “ d” t t fil i t d ith R Fl i\n\n\n-----\n\nWhile we created the Rose Flamingo naming convention to help us track\n\nactivity we consider to be related, there’s a growing body of external research\n\ndocumenting components that partially overlap with what we define as Rose\n\nFlamingo. Much of this emerging research dropped in 2021, and it’s worth\n\nreviewing for anyone who is interested in learning more about related activity:\n\n- [In January 2021, CSIS Security Group released research referencing](https://medium.com/csis-techblog/gcleaner-garbage-provider-since-2019-2708e7c87a8a)\n\ninfrastructure and payloads that overlap with Rose Flamingo.\n\n- [In March 2021, Fortinet detailed a threat called Netbounce, which uses a](https://www.fortinet.com/blog/threat-research/netbounce-threat-actor-tries-bold-approach-to-evade-detection)\n\nsimilar file-naming convention and has some overlapping infrastructure.\n\n- Just about a week later in March 2021, Proofpoint published research about\n\n[a threat they call CopperStealer (Mingloa), describing infrastructure and](https://www.proofpoint.com/us/blog/threat-insight/now-you-see-it-now-you-dont-copperstealer-performs-widespread-theft)\n\npayload-naming conventions that are very similar to Rose Flamingo’s.\n\n- [In June 2021, an Ahnlab report described a threat called Cryptbot,](https://asec.ahnlab.com/en/23727/)\n\ndetailing files used for delivery that appear to overlap with Rose Flamingo’s\n\nfile-naming conventions.\n\n- In late July 2021, BitDefender joined the party, helping corroborate many of\n\n[our own observations with their MosaicLoader whitepaper, a great report](https://www.bitdefender.com/files/News/CaseStudies/study/400/Bitdefender-PR-Whitepaper-MosaicLoader-creat5540-en-EN.pdf)\n\nthat touches on much of the initial loader activity we’ve observed in Rose\n\nFlamingo-related incidents.\n\n- Last but not least, in September 2021, SophosLabs released research that\n\n[focuses on a content delivery network that has many infrastructure and](https://news.sophos.com/en-us/2021/09/01/fake-pirated-software-sites-serve-up-malware-droppers-as-a-service/)\n\npayload overlaps with our analysis.\n\nBecause none of us have perfect visibility, we appreciate that other teams share\n\ntheir perspective and how they track these threats.\n\nAs seen in our Intelligence Insights rankings from month to month, Rose\n\nFlamingo made our top 10 list for the first time in July 2021, climbing to\n\neighth place for most prevalent threats that month. It also made our top 10\n\n[in September and October 2021. Red Canary has observed Rose Flamingo](https://redcanary.com/blog/intel-insights-sept-2021/)\n\ndelivering various stealers such as Cryptbot, RedLine, and Raccoon, in addition\n\n[to more concerning payloads such as STOP ransomware. We will continue](https://blog.emsisoft.com/en/40786/ransomware-statistics-for-2021-q4-report/)\n\nbirdwatching as we look for new opportunities to observe and take action\n\nwhen threats like Rose Flamingo find a new place to roost.\n\n\n-----\n\n### Detection opportunities\n\n###### Archive containing ZIP and TXT files \n\n containing ​password\n\nThis detection analytic will identify processes making file modifications for\n\nZIP archive files and TXT files with the string ​password in them, which we\n\ncommonly observe in Rose Flamingo activity. The password files may contain\n\ndifferent naming variations, such as p@ssword or ​passw0rd . Detecting TXT\n\nfiles with these strings may generate fewer false positives. If you have trouble\n\ngetting this detection opportunity to work, you may find further success\n\n[focusing on application processes that are responsible for handling archives in](https://docs.microsoft.com/en-us/windows-hardware/manufacture/desktop/export-or-import-default-application-associations?view=windows-11)\n\n[your organization, such as 7zip.](https://en.wikipedia.org/wiki/7-Zip)\n\nfilemod_includes ( **​zip** )\n\n&&\n\nfilemod_includes ( **​password** && **​txt** )\n\n###### Potential Rose Flamingo loader\n\nThis detection analytic will identify unusual processes that contain\n\nnaming schemas that have been observed in use by loaders related to\n\nRose Flamingo archives.\n\nprocess_name_includes ( **​main-** || **​installer-v** || **​main_setup_x86x64**\n\n|| **​x86_x64_setup** || **​setup_x84_x64** )\n\n###### Potential Rose Flamingo loader\n\nThis detection analytic will identify files and file paths that contain strings\n\ncommonly observed in archives delivered by Rose Flamingo.\n\nfilepath_includes ( **​-free** || **​-crack** || **​-download** || **-key** || **​-license** ||\n\n**​-iso** || **-Install** )\n\n||\n\nfilename_includes ( **​-free** || **​-crack** || **​-download** || **-key** || **​-license** ||\n\n**​-iso** || **-Install** )\n\n&&\n\nfil i l d ( i || || )\n\n\n-----\n\n###### THR EAT: NEW ACT IV ITY CLUSTER\n\n## Silver Sparrow\n\n###### Silver Sparrow is a macOS activity cluster with fully functional distribution methods and infrastructure but no final payload.\n\n[In February 2021, Red Canary discovered an activity cluster we named Silver](https://redcanary.com/blog/clipping-silver-sparrows-wings/)\n\n**[Sparrow when we identified a strain of macOS malware using a ​LaunchAgent](https://redcanary.com/blog/clipping-silver-sparrows-wings/)**\n\nto establish persistence. Distributed via downloads from AWS S3 buckets,\n\nmalware dropped by Silver Sparrow relies on installation through macOS PKG\n\nfiles. We analyzed two versions of Silver Sparrow malware: The first version\n\ncontained a Mach-O binary compiled for Intel x86_64 architecture only, and\n\nthe second version included a Mach-O binary compiled for Intel x86_64 and M1\n\nARM64 architectures. The downloader was novel because of the way it used\n\nJavaScript for execution and the appearance of a related binary compiled\n\nfor Apple’s new M1 ARM64 architecture. During installation, the malware\n\nexecuted JavaScript commands to orchestrate the creation of files and scripts\n\nfor persistent execution. These files attempted to download a future payload\n\ndetermined by a file from an additional S3 bucket retrieved every hour.\n\nSince we observed multiple files and components on victim machines, we\n\ndecided to cluster all the suspicious artifacts under the Silver Sparrow activity\n\ncluster, including an unusual ​._insu file that seems to instruct the malware to\n\nremove itself from an endpoint.\n\n[Thanks to our friends at MalwareBytes, we determined that the Silver Sparrow](https://blog.malwarebytes.com/mac/2021/02/the-mystery-of-the-silver-sparrow-mac-malware/)\n\nactivity cluster affected tens of thousands of macOS endpoints across 164\n\ncountries as of February 2021, including high volumes of detection in the\n\nUnited States, the United Kingdom, Canada, France, and Germany. Although we\n\nnever observed Silver Sparrow delivering additional malicious payloads, it was\n\noperationally mature and affected many thousands of machines worldwide.\n\nOverall, Silver Sparrow is interesting and unique because:\n\n- At the time of analysis, its malware was compatible with M1 ARM64 and\n\nIntel chipsets. Researchers have uncovered very few threats for the M1\n\nARM64 architecture because the architecture is young.\n\n- Its installer packages leverage the macOS Installer JavaScript API to\n\nexecute suspicious commands. This is the first malware we’ve seen do this.\n\n- Its infrastructure was hosted on AWS S3, making it hard to block\n\noutright. The decision to use AWS infrastructure suggests an operationally\n\nmature adversary\n\n\n-----\n\n### Detection opportunities\n\n###### ​PlistBuddy utility manipulating ​LaunchAgent\n\nThe ​PlistBuddy command is a built-in tool in macOS that allows administrators\n\nto manipulate property list, or plist, files used to configure various parts of the\n\nmacOS operating system. Silver Sparrow used the command to manipulate ​\n\n**LaunchAgent plists and allow persistence. ​PlistBuddy with the command**\n\nline including ​RunAtLoad indicates an adversary is specifically manipulating a\n\n**LaunchAgent or LaunchDaemon ’s capability to execute code at boot.**\n\nprocess == **​PlistBuddy**\n\n&&\n\ncommand_line_includes ( **​RunAtLoad** )\n\n###### Sqlite3 loading the Quarantine file\n\nThe Quarantine feature of macOS prevents certain file types from easily\n\nexecuting after being downloaded from the internet. The system keeps a record\n\nof all downloaded files in a SQLITE database at ~/Library/Preferences/com.\n\n**apple.LaunchServices.QuarantineEventsV*. Silver Sparrow malware and other**\n\nmacOS threats commonly query this record using the ​sqlite3 command to\n\ndetermine where they were downloaded from to report back to the adversary\n\nfor metrics (i.e., whether or not the deployment path was successful).\n\nprocess_name == ( **​sqlite3** )\n\n&&\n\ncommand_line_includes ( **​LSQuarantineURLString** )\n\n\n###### TAKE ACTIO N\n\nWe included some detection\n\nopportunities to help identify\n\nSilver Sparrow activity. Also, see\n\nthe macOS trends page for defense\n\nstrategies to protect yourself from\n\nmacOS threats.\n\n\n-----\n\n###### REL EVA NT T HR EATS O F 2021\n\n## Bazar\n\n###### The Bazar family of malware continued to be active in 2021, spurring ransomware infections.\n\nThe Bazar malware family was quite active in 2021, spreading via multiple\n\n[delivery affiliates, including TA551 and BazaCall. There are many names](https://redcanary.com/threat-detection-report/threats/TA551/)\n\nfor Bazar (sometimes referred to as “Baza”) floating around that refer to\n\nvarious parts of the intrusion chain. Bazar is relevant because of its role as\n\na malware precursor, and many 2021 intrusions starting with Bazar led to\n\n[ransomware like Ryuk and Conti. The Bazar malware family encompasses a](https://redcanary.com/blog/how-one-hospital-thwarted-a-ryuk-ransomware-outbreak/)\n\nloader, BazarLoader, and backdoor, BazarBackdoor. These components have\n\nbeen delivered via multiple delivery affiliates. As we discuss in the Affiliates\n\nsection of this report, differentiating initial delivery affiliates from loaders and\n\npayloads will help you understand each phase of the threat and how to better\n\nprotect your organization.\n\nOne affiliate we’ve been tracking for a while, TA551, began delivering Bazar\n\nduring 2021. While TA551 relied on email attachments to deliver Bazar, another\n\n[affiliate behind a 2021 phishing campaign known as BazaCall opted to trick](https://www.microsoft.com/security/blog/2021/07/29/bazacall-phony-call-centers-lead-to-exfiltration-and-ransomware/)\n\nusers into calling a phone number sent in an email. After a victim called\n\nthe number, an adversary provided step-by-step instructions that led to\n\n[downloading Bazar malware. (Check out Brad Duncan’s video for an example](https://www.youtube.com/watch?v=uAkeXCYcl4Y)\n\nof how this intrusion plays out.) Once BazaLoader was installed, BazaCall led to\n\nCobalt Strike and eventually, ransomware.\n\n### Detection opportunities\n\n###### Microsoft Certificate Services using ​certutil.exe to initiate download\n\nThis detection analytic looks for instances of the Microsoft Certificate\n\nUtility ( ​certutil.exe ) initiating a download, a technique used to download\n\nBazar payloads.\n\nprocess == **​certutil.exe**\n\n&&\n\ncommand_line_includes ( **​urlcache** )\n\n\n-----\n\n###### REL EVA NT T HR EATS O F 2021\n\n## Latent threats\n\n###### Threats come and go, but some—like USB stowaways and network worms—like to stick around.\n\nLatent threats demonstrate that most adversaries do not need to be advanced\n\nor sophisticated to execute code or persist in an organization. They can simply\n\n[settle to be an adequate persistent threat, using techniques and artifacts](https://redcanary.com/blog/frameworkpos-and-the-adequate-persistent-threat/)\n\nthat virtually anyone can find. This section outlines opportunities to detect and\n\nrespond to tried-and-true threats like USB stowaways and network worms.\n\n### USB stowaways\n\nIn this section we characterize “USB stowaways” as threats that leverage USB\n\nthumb drives to find their victims.\n\n###### Floxif (ranked #75 in 2021)\n\nFloxif, short for “FloodFix,” is a type of file-infecting malware that researchers\n\n[have observed spreading to some of the farthest reaches of organizations’](https://www.mandiant.com/resources/pe-file-infecting-malware-ot)\n\n[networks since 2012. In the detections that we’ve observed, Floxif most](https://www.virusbulletin.com/virusbulletin/2012/12/compromised-library)\n\ncommonly arrived on endpoints via USB thumb drive. Floxif self-replicates by\n\nidentifying processes running in memory that are eligible for infection and\n\nreplaces them with new, Floxif-compromised binaries. Many variants of Floxif\n\nmalware rely on writing the accompanying DLL ​symsrv.dll to a unique location,\n\nso detecting this threat can be done with relatively high confidence\n\n###### Floxif DLL file modification\n\nThis detection analytic identifies file modifications that are consistent with\n\nFloxif malware execution.\n\nfile_modification_includes ( ​Common files / System / symsrv.dll )\n\n\n-----\n\n###### Gamarue (ranked #12 in 2021)\n\nGamarue is a malware family that was first observed by researchers in 2011\n\n[and rendered inactive after a joint takedown operation in 2017. While many](https://www.microsoft.com/security/blog/2017/12/04/microsoft-teams-up-with-law-enforcement-and-other-partners-to-disrupt-gamarue-andromeda/)\n\n[variants of Gamarue exist, the variant we observed most frequently in 2021](https://redcanary.com/blog/intelligence-insights-november-2021/)\n\nwas an Autorun worm that spread primarily via infected USB drives. This is\n\nno different from what we saw in 2020, and we expect to continue seeing it for\n\nas long as users keep deploying infected USB drives to ferry files from one\n\nendpoint to another.\n\n###### Explorer launching Rundll32 without any DLL in the command line\n\nprocess == **​rundll2.exe**\n\n&&\n\nparent_process == **​explorer.exe**\n\n&&\n\ncommand_line_does_not_include ( **​.dll** )\n\n###### Conficker (ranked #28 in 2021)\n\nBridging the gap between USB worms and network worms, Conficker is a worm\n\nthat feverishly spread across the internet in late 2008, leveraging the NetBIOS\n\n[vulnerability MS08-067. As more sophisticated variants were developed, USB](https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-067)\n\nAutorun worming functionality was soon baked into Conficker as well, helping\n\n[to further spread this worm via sneakernet. Fourteen years later, Red Canary](https://en.wikipedia.org/wiki/Sneakernet)\n\nstill detects artifacts related to Conficker, most of which are leftover persistence\n\nmechanisms from incomplete remediation. While antivirus products may be\n\ndoing most of the heavy lifting in terms of remediating active instances of\n\nConficker, those errant scheduled tasks may still be out there trying to launch\n\nConficker DLLs of bygone days.\n\n###### Rundll32 executing with command lines consistent with Conficker\n\nThis detection analytic will identify unusual activity originating from\n\nthe ​rundll32.exe process. Werfault typically spawns with command-line\n\nparameters when a process crashes, providing the program with input to create\n\nan error report. If you are having trouble getting this detection opportunity to\n\nwork in your environment, you may find additional success by focusing only on\n\n\n-----\n\nprocesses where ​taskeng.exe or ​​svchost.exe are the parents of Rundll32.\n\nprocess _name == **​rundll32.exe**\n\n&&\n\ncommand_line == **​rundll32\\.exe** **[a-z]{5,8}\\.[a-z]{1,3},[a-z]{5,8}**\n\n### Network worms\n\nIn this section we characterize “network worms” as threats that exploit\n\nvulnerabilities in software to infect and establish control over an endpoint.\n\nFollowing initial access, adversaries leverage the infected endpoints’ network\n\nconnections to identify additional assets to infect and repeat the cycle.\n\n###### WannaCry ransomware (ranked #31  in 2021)\n\nWannaCry, often shortened to “WCry,” is a ransomware variant that spreads as\n\n[an SMB worm leveraging the ETERNALBLUE vulnerability, MS17-010. WannaCry](https://www.sentinelone.com/blog/eternalblue-nsa-developed-exploit-just-wont-die/)\n\nwas first observed in May 2017, indiscriminately spreading across many\n\norganizations. Early variations of WannaCry had code built in to discontinue\n\nransomware operations, but later versions of did not include this functionality.\n\nHalf a decade later, some might laugh that we’re including WannaCry in a report\n\nreleased now, and we must admit that seeing WannaCry so high in our rankings\n\nwas a bit of a shock for us too, but here we are. Simply put, there’s a reason\n\n[why the vulnerability WannaCry targets, MS17-010, is known as ETERNALBLUE.](https://docs.microsoft.com/en-us/security-updates/securitybulletins/2017/ms17-010)\n\n[Just like MS08-067 is to Conficker, MS17-010 is so reliable that we are likely to](https://docs.microsoft.com/en-us/security-updates/securitybulletins/2008/ms08-067)\n\ncontinue seeing WannaCry for quite some time. If you are concerned that your\n\nendpoints might be afflicted by WannaCry, Microsoft provides guidance on how\n\n[to identify endpoints that may be susceptible to SMBv1 exploitation, as well as](https://support.microsoft.com/en-us/topic/how-to-verify-that-ms17-010-is-installed-f55d3f13-7a9c-688c-260b-477d0ec9f2c8)\n\n**[mitigation techniques that are still applicable today.](https://msrc-blog.microsoft.com/2017/05/12/customer-guidance-for-wannacrypt-attacks/)**\n\n###### Process names that are consistent with  WannaCry binaries\n\nThis detection analytic will identify processes that are executing with process\n\nnames that are consistently observed in use by WannaCry binaries.\n\nprocess_name == **​​mssecsvc.exe**\n\n||\n\n\n-----\n\n###### LSASS spawning processes\n\nThis detection analytic will identify instances of the **[Local Security Authority](https://redcanary.com/threat-detection-report/techniques/lsass-memory/)**\n\n**[Subsystem Service (](https://redcanary.com/threat-detection-report/techniques/lsass-memory/)** **​​lsass.exe** ) spawning processes that are not typically\n\nobserved being launched by **​lsass.exe** . LSASS is an injection target for\n\nWannaCry, as detailed by **[Microsoft.](https://www.microsoft.com/security/blog/2017/06/30/exploring-the-crypt-analysis-of-the-wannacrypt-ransomware-smb-exploit-propagation/)**\n\nparent_process == **​​lsass.exe**\n\n&&\n\nprocess_name != **​werfault.exe || lsass.exe**\n\n###### WannaMine cryptominer (ranked #57  in 2021)\n\nWannaMine, a portmanteau of WannaCry and Mine, is a malware family that\n\nfocuses on deploying coinmining payloads. The “Wanna” part of the name of\n\nthis threat comes from the use of the same ETERNALBLUE vulnerability that\n\nWannaCry leveraged. While WannaMine may be **[old news to some, Red Canary](https://redcanary.com/blog/cryptomining-enabled-by-native-windows-tools/)**\n\nobserved new infections throughout the course of 2021. There’s a reason why\n\nvendors are still producing articles providing guidance around WannaMine\n\n**[cleanup and remediation.](https://support.sophos.com/support/s/article/KB-000037977?language=en_US)**\n\n###### PowerShell executing with NoProfile and NonInteractive CLI parameters\n\nThis detection analytic identifies instances of **​powershell.exe** executing with\n\nthe strings **-nop** and **​-noni in the command line, which are shortenings for**\n\nthe PowerShell **[parameters](https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_powershell_exe?view=powershell-5.1)** **​NoProfile** and **NonInteractive . These command-**\n\nline parameters are rarely observed together legitimately, making for another\n\nanalytic that can be used to identify a **[multitude](https://redcanary.com/blog/microsoft-dde-exploit-email/)** of threats, not\n\njust **[WannaMine.](https://redcanary.com/blog/cryptomining-enabled-by-native-windows-tools/)**\n\nprocess == **​powershell.exe**\n\n&&\n\ncommand_line_includes ( **-nop** && **​-noni** )\n\n\n-----\n\n### Honorable mention\n\nZloader is neither a “USB stowaway” nor a “network worm,” and though it never\n\ncauses enough of a stir to breach our top rankings, it still deserves an **[honorable](https://redcanary.com/blog/intelligence-insights-october-2021/)**\n\n**[mention](https://redcanary.com/blog/intelligence-insights-october-2021/)** as a latent threat. The adversaries behind Zloader typically devise\n\n**[innovative ways](https://www.sentinelone.com/labs/hide-and-seek-new-zloader-infection-chain-comes-with-improved-stealth-and-evasion-mechanisms/)** to reach their victims before making the news with their next\n\ncampaign, yet even with the latest passing headline, they often still rely on **[less](https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/)**\n\n**[novel TTPs](https://news.sophos.com/en-us/2022/01/19/zloader-installs-remote-access-backdoors-and-delivers-cobalt-strike/)** that can give their presence away.\n\n###### Zloader (ranked #53 in 2021)\n\nZloader is a banking trojan that has targeted victims through a variety of\n\navenues since 2016. Though its TTPs have changed over the years, the driving\n\nforce behind Zloader continues to appear to be financial motivation. In mid\n\n2020, Zloader’s operators began delving into delivering **[ransomware](https://www.sentinelone.com/labs/enter-the-maze-demystifying-an-affiliate-involved-in-maze-snow/)** alongside\n\ntheir more typical banking trojan payloads, elevating our concern whenever we\n\ndetect a threat that is consistent with Zloader activity. Zloader makes this list\n\nbecause it is another threat that you may not hear much from for a few months\n\nbut is always likely to creep its way back.\n\n###### PowerShell modifying Windows  Defender exclusions\n\nThis detection analytic identifies instances of PowerShell issuing commands\n\nto modify Windows Defender exclusion policies. This activity is consistent\n\nwith ZLoader activity that occurs prior to the execution of follow-on payloads.\n\nAdditional threats, such as Purple Fox, leverage this TTP as well.\n\nprocess == **​powershell.exe**\n\n&&\n\ncommand_line_includes ( **​Add-MpPreference** || **​Set-MpPreference** )\n\n&&\n\ncommand_line_includes ( **​ExclusionExtension** || **​ExclusionPath** ||\n\n**​ExclusionProcess** )\n\n\n###### TAKE ACTIO N\n\nEven if you’re not seeing them\n\nin headlines, it is important to\n\nevaluate threats that have been\n\nknown to be problems in the past.\n\nIf your least favorite adversary has\n\ngone dormant, there’s a chance\n\nthat they may come back using\n\nmany of the same TTPs. Make sure\n\nyour endpoints are up to date with\n\nthe latest patches, and if you find\n\nyourself to be afflicted by the many\n\nthreats that we have outlined today\n\nthat abuse Autorun functionality,\n\n[you may want to consider disabling](https://docs.microsoft.com/en-us/windows/win32/shell/autoplay-reg)\n\n**[Autorun across the organization.](https://docs.microsoft.com/en-us/windows/win32/shell/autoplay-reg)**\n\n\n-----\n\n-----\n\n## Top techniques\n\nThe purpose of this section is to help you detect malicious activity in its\nearly stages so you don’t have to deal with the consequences of a serious\nsecurity incident.\n\n[The following chart represents the most prevalent MITRE ATT&CK®](https://redcanary.com/mitre-attack/)\ntechniques observed in confirmed threats across the Red Canary customer\n\n[base in 2021. To briefly summarize what’s explained in detail in the](https://redcanary.com/threat-detection-report/methodology/)\n\n**[Methodology section, we have a library of roughly 3,000 detection analytics](https://redcanary.com/threat-detection-report/methodology/)**\nthat we use to surface potentially malicious and suspicious activity across our\ncustomers’ environments. These are mapped to corresponding MITRE ATT&CK\ntechniques whenever possible, allowing us to associate the behaviors that\ncomprise a confirmed threat detection with the industry standard for classifying\nadversary activity.\n\n\n-----\n\n###### TOP T EC HNIQUES\n\n**TECHNIQUE RANK**\n**NAME**\n**(SUB-TECHNIQUE RANK)**\n\n**T1059: Command and Scripting Interpreter** **1**\n\n   - T1059.001: PowerShell (1)\n\n   - T1059.003: Windows Command Shell (2)\n\n**T1218: Signed Binary Proxy Execution** **2**\n\n   - T1218.011: Rundll32 (3)\n\n**T1047: Windows Management Instrumentation** **3**\n\n**T1003: Credential Dumping** **4**\n\n   - T1003.001: LSASS Memory (6)\n\n**T1105: Ingress Tool Transfer** **5**\n\n**T1055: Process Injection** **6**\n\n**T1053: Scheduled Task/Job** **7**\n\n   - T1053.005: Scheduled Task (4)\n\n**T1027: Obfuscated Files or Information** **8**\n\n**T1036: Masquerading** **9**\n\n   - T1036.003: Rename System Utilities (7)\n\n   - T1036.005: Match Legitimate Name or Location (11)\n\n**T1574: Hijack Execution Flow** **10**\n\n   - T1574.001: DLL Search Order Hijacking (5)\n\n_*Note: We chose not to include analysis for each technique in the PDF supplement to the report,_\n\n_[but, as always, they’re available in full on the Threat Detection Report website.](https://redcanary.com/threat-detection-report/techniques/)_\n\n|NAME|TECHNIQUE RANK (SUB-TECHNIQUE RANK)|% OF CUSTOMERS AFFECTED|\n|---|---|---|\n|T1059: Command and Scripting Interpreter • T1059.001: PowerShell • T1059.003: Windows Command Shell|1 (1) (2)|53.4% (35.0%) (28.1%)|\n|T1218: Signed Binary Proxy Execution • T1218.011: Rundll32|2 (3)|34.8% (23.3%)|\n|T1047: Windows Management Instrumentation|3|15.4%|\n|T1003: Credential Dumping • T1003.001: LSASS Memory|4 (6)|18.3% (13.3%)|\n|T1105: Ingress Tool Transfer|5|20.4%|\n|T1055: Process Injection|6|21.7%|\n|T1053: Scheduled Task/Job • T1053.005: Scheduled Task|7 (4)|14.7% (12.2%)|\n|T1027: Obfuscated Files or Information|8|19.4%|\n|T1036: Masquerading • T1036.003: Rename System Utilities • T1036.005: Match Legitimate Name or Location|9 (7) (11)|22.1% (15.6%) (7.9%)|\n|T1574: Hijack Execution Flow • T1574.001: DLL Search Order Hijacking|10 (5)|8.4% (7.8%)|\n\n\n-----\n\n###### What’s included in this section?\n\nWe’ve written extensive analysis of 12 ATT&CK techniques and sub-techniques.\n\nEach technique-specific section includes:\n\n- a brief analysis of how and why adversaries leverage a given technique\n\n- descriptions of data sources that offer visibility into the technique (e.g.,\n\ncommand monitoring, process monitoring, etc.)\n\n- guidance on the tooling or logs that will enable you to collect those data\n\nsources (e.g., EDR, Sysmon, AMSI, Windows Events. etc.)\n\n- specific examples of how you can use that telemetry to detect adversaries\n\nabusing the technique\n\n- individual tests for emulating how adversaries abuse the technique to\n\nvalidate that you can observe or detect it\n\n###### The bottom line\n\nExamined holistically, the list of prevalent techniques showcased in this report\n\nsuggests that if you can detect threats relatively early in the intrusion lifecycle,\n\nyou’re much less likely to face the consequences of a significant cyber attack.\n\nThis principle has saved many of our customers from immeasurable grief over\n\nthe years.\n\nTo that point, we mostly detect adversaries as they’re setting the stage for later,\n\nmore impactful actions. We catch them attempting to abuse native operating\n\nsystem utilities to execute code or bring in custom tooling. We catch them\n\nelevating their privilege levels to get deeper access to compromised systems.\n\nWe catch them establishing persistence so they can maintain their presence. We\n\ncatch them manipulating our customers’ defensive controls to evade prevention\n\nor detection. These are necessary means to an end—whether the goal is to\n\nconduct espionage, a ransomware attack, or something else altogether. When\n\nwe disrupt these means, we prevent their ends.\n\nThis is precisely why exfiltration and impact techniques (e.g., ransomware) don’t\n\nrank highly on our list. The following heatmap shows the distribution of the 20\n\nmost prevalent techniques across the ATT&CK matrix.\n\n\n-----\n\n**Figure 3: MITRE ATT&CK Navigator layer showing the 20 most prevalent ATT&CK techniques detected by Red Canary**\n\nThis isn’t to suggest that we never encounter ransomware. In fact, we routinely\n\n[encounter ransomware threats through short-term engagements with our](https://redcanary.com/ransomware/)\n\n[many incident response partners. However, we monitor far more customers](https://redcanary.com/products/red-canary-for-consultants/)\n\nfull time than we do via IR engagements, and therefore, these ransomware\n\nincidents represent only a small fraction of our overall detection volume.\n\n\n-----\n\nInterestingly, if we create a heatmap like the one above where we only include\n\ndetections from our incident response work, we see a slightly different\n\narrangement of techniques that does include impact tactics—as well as more\n\ndefense evasion, more lateral movement, and less execution. This makes sense\n\nbecause in incident response engagements we are entering environments\n\nwhere a lot of the preliminary activity—the stuff we generally catch early for our\n\nfull-time customers—has already occurred. In other words, we’re already at the\n\nimpactful part of the incident.\n\n**Figure 4: MITRE ATT&CK Navigator layer showing the 20 most prevalent ATT&CK techniques detected by Red Canary**\nduring incident response engagements\n\n\n-----\n\n###### How to use our analysis\n\nIf your organization is able to follow the visibility, collection, and\n\ndetection guidance in this report, you can effectively improve your defense\nin-depth against the adversary actions that often lead to a serious incident.\n\nOf course, this is easier said than done. There are countless prerequisites\n\nto operationalizing this report, ranging from configuration challenges to\n\ndeveloping plumbing that allows you to move telemetry from its source to its\n\ndestination—whether that’s a SIEM or some other aggregation point.\n\nHowever, this analysis is still useful for practitioners or leaders who aren’t\n\nimmediately ready to operationalize it. For leaders, the most prevalent\n\ntechniques can help you identify gaps as you develop a road map for improving\n\ncoverage. You can assess your existing sources of collection against the ones\n\nlisted in this report to inform your investments in new tools and personnel.\n\nAs a practitioner, you’ll gain a better understanding of common adversary\n\nactions and what’s likely to occur if an adversary gains access to your\n\nenvironment. You’ll learn what malicious looks like in the form of telemetry and\n\nthe many places you can look to find that telemetry. You’ll gain familiarity with\n\nthe principles of detection engineering by studying our detection opportunities.\n\nAt a bare minimum, you and your team will be armed with hyper-relevant and\n\n[easy-to-use Atomic Red Team tests that you can leverage to ensure that your](https://redcanary.com/atomic-red-team/)\n\nexisting security tooling does what you think it’s supposed to do.\n\n###### What’s missing and why?\n\nRed Canary is actively adopting new data sources that reach beyond the\n\nendpoint to enhance our detection, investigation, and incident handling\n\ncapabilities, and you’ll see evidence of this throughout the techniques\n\nsection—particularly in the visibility, collection, and detection subsections.\n\nEven so, the majority of our detection analytics are based on endpoint\n\ntelemetry and the majority of the endpoints we monitor are client workstations.\n\nThis reality shapes our perspective and the contents of this report.\n\nGiven our vantage point and the defense-in-depth our detection analytics offer,\n\nwe tend to detect the adversary behaviors that happen just after initial access.\n\nAs a result, execution, privilege escalation, persistence, and defense evasion\n\ntechniques are probably over-emphasized in our report. On the other hand, one\n\nof the most prevalent forms of initial access—email-based phishing—is under\nrepresented. Under no circumstance should anyone interpret these findings to\n\nsuggest that phishing protection is unimportant. To the contrary, phishing is\n\namong the most prevalent ways that adversaries initially access our customers’\n\nenvironments, and the data in this report does reflect a great number of\n\n\n-----\n\nemail-borne threats. However, Red Canary doesn’t have as much early-stage\n\nvisibility into phishing as we do into other techniques, which is precisely why\n\nthis report works best as a complement to other reports from vendors with\n\ndifferent vantage points—like those who make firewalls or email-monitoring\n\nproducts.\n\nFurther, discovery techniques are also underrepresented in this report. This is\n\nbecause discovery techniques can be incredibly noisy, generating prohibitively\n\nhigh volumes of false positives for our detection engineers. Beyond that,\n\ndiscovery-related alerts aren’t always actionable since, for example, you can’t\n\nreally prevent someone from scanning a public-facing resource. This isn’t to\n\nsay we don’t inform our customers of discovery activity. We absolutely do, but\n\nit’s typically done manually by our detection engineers as they’re analyzing\n\npotentially malicious events. Since our ATT&CK mapping happens at the\n\ndetection-analytic level, prior to human analysis, the discovery activity isn’t\n\nincluded in this report.\n\nOne final note: we overwhelmingly monitor Windows endpoints, and therefore\n\nwe’ve included only limited information about macOS and Linux techniques\n\nin this section. To be very clear, we have robust detection coverage for macOS\n\nand Linux threats, but this report reflects the reality that Windows continues to\n\ndominate the enterprise marketplace.\n\n**[Learn more about our top techniques](https://redcanary.com/threat-detection-report/techniques/)**\n\n\n-----\n\n### Conclusion\n\nThank you for devoting your time to absorbing this report; we appreciate your dedication to\n\nprotecting your organization. We understand there are lots of reports floating around the\n\ninformation security community, and we take pride in our work to muffle the noise, opting\n\ninstead for curated and actionable content. We hope the information encompassed in this\n\nreport offers insights into how to improve your security posture and what you can do if you\n\nencounter any of the most prevalent threats, trends, and techniques. We will continue to\n\n[update the Red Canary blog with relevant resources related to the Threat Detection Report](https://redcanary.com/blog/)\n\nand many other valuable resources you can use to take action.\n\nIf you have any questions or concerns, or just want to chat, please feel free to reach out to us\n\n[at info@redcanary.com.](mailto:info@redcanary.com)\n\n###### Contributors\n\nThank you to all our contributors who helped make this report possible.\n\n\nJimmy Astle\n\nKelsey Budnick\n\nSusannah Clark\n\nAaron Dider\n\nBrian Donohue\n\nJeff Felling\n\nThomas Gardner\n\nMatt Graeber\n\nDominic Heidt\n\nDave Hull\n\nChristina Johns\n\nJonny Johnson\n\n\nMilan Klusacek\n\nTony Lambert\n\nAdam Mashinchi\n\nKeith McCammon\n\nPaul Michaud\n\nKatie Nickels\n\nLauren Podber\n\nJustin Schoenfeld\n\nAnna Seitz\n\nHarrison Van Riper\n\nPhillip Wells\n\nErin York\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://resource.redcanary.com/rs/003-YRU-314/images/2022_ThreatDetectionReport_RedCanary.pdf"
    ],
    "report_names": [
        "2022_ThreatDetectionReport_RedCanary.pdf"
    ],
    "threat_actors": [
        {
            "id": "72d09c17-e33e-4c2f-95db-f204848cc797",
            "created_at": "2022-10-25T15:50:23.832551Z",
            "updated_at": "2025-03-27T02:00:55.554841Z",
            "deleted_at": null,
            "main_name": "FIN8",
            "aliases": [
                "FIN8",
                "Syssphinx"
            ],
            "source_name": "MITRE:FIN8",
            "tools": [
                "BADHATCH",
                "PUNCHBUGGY",
                "Ragnar Locker",
                "PUNCHTRACK",
                "dsquery",
                "Nltest",
                "Sardonic",
                "PsExec",
                "Impacket"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a7d4fe31-d92f-425a-ba8c-c70219f52fb8",
            "created_at": "2022-10-25T15:50:23.466009Z",
            "updated_at": "2025-03-27T02:00:55.477162Z",
            "deleted_at": null,
            "main_name": "Frankenstein",
            "aliases": [
                "Frankenstein"
            ],
            "source_name": "MITRE:Frankenstein",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "26a04131-2b8c-4e5d-8f38-5c58b86f5e7f",
            "created_at": "2022-10-25T15:50:23.579601Z",
            "updated_at": "2025-03-27T02:00:55.50292Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "TA551",
                "GOLD CABIN",
                "Shathak"
            ],
            "source_name": "MITRE:TA551",
            "tools": [
                "QakBot",
                "IcedID",
                "Valak",
                "Ursnif"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "fc80a724-e567-457c-82bb-70147435e129",
            "created_at": "2022-10-25T16:07:23.624289Z",
            "updated_at": "2025-03-27T02:02:09.892602Z",
            "deleted_at": null,
            "main_name": "FIN8",
            "aliases": [
                "ATK 113",
                "Syssphinx"
            ],
            "source_name": "ETDA:FIN8",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BadHatch",
                "BlackCat",
                "Noberus",
                "PSVC",
                "PUNCHTRACK",
                "PoSlurp",
                "Powersniff",
                "PunchBuggy",
                "Ragnar Locker",
                "RagnarLocker",
                "Sardonic",
                "ShellTea"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a2d3f35f-3b29-4509-bff5-af2638140d39",
            "created_at": "2022-10-25T16:07:23.633982Z",
            "updated_at": "2025-03-27T02:02:09.898653Z",
            "deleted_at": null,
            "main_name": "FIN12",
            "aliases": [],
            "source_name": "ETDA:FIN12",
            "tools": [
                "Agentemis",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "KEGTAP",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4f5da0b4-5d47-4ae4-87cb-dfcb3c3524ae",
            "created_at": "2022-10-25T16:07:23.96921Z",
            "updated_at": "2025-03-27T02:02:10.054899Z",
            "deleted_at": null,
            "main_name": "Operation Layover",
            "aliases": [],
            "source_name": "ETDA:Operation Layover",
            "tools": [
                "AsyncRAT",
                "Bladabindi",
                "CyberGate",
                "CyberGate RAT",
                "Jorik",
                "Rebhip",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "04e34cab-3ee4-4f06-a6f6-5cdd7eccfd68",
            "created_at": "2022-10-25T16:07:24.578896Z",
            "updated_at": "2025-03-27T02:02:10.286803Z",
            "deleted_at": null,
            "main_name": "TA551",
            "aliases": [
                "Gold Cabin",
                "Monster Libra",
                "Shathak",
                "TA551"
            ],
            "source_name": "ETDA:TA551",
            "tools": [
                "BokBot",
                "CRM",
                "Gozi",
                "Gozi CRM",
                "IceID",
                "IcedID",
                "Papras",
                "Snifula",
                "Ursnif",
                "Valak",
                "Valek"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6c4f98b3-fe14-42d6-beaa-866395455e52",
            "created_at": "2023-01-06T13:46:39.169554Z",
            "updated_at": "2025-03-27T02:00:03.011739Z",
            "deleted_at": null,
            "main_name": "Evil Corp",
            "aliases": [
                "GOLD DRAKE"
            ],
            "source_name": "MISPGALAXY:Evil Corp",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5bdde906-0416-42ee-9100-5ebd95dda77a",
            "created_at": "2023-01-06T13:46:38.601977Z",
            "updated_at": "2025-03-27T02:00:02.870694Z",
            "deleted_at": null,
            "main_name": "FIN8",
            "aliases": [
                "ATK113",
                "G0061"
            ],
            "source_name": "MISPGALAXY:FIN8",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "90f216f2-4897-46fc-bb76-3acae9d112ca",
            "created_at": "2023-01-06T13:46:39.248936Z",
            "updated_at": "2025-03-27T02:00:03.031127Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "Shakthak",
                "TA551",
                "ATK236",
                "G0127",
                "Monster Libra"
            ],
            "source_name": "MISPGALAXY:GOLD CABIN",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d706edf6-cb86-4611-99e1-4b464e9dc5b9",
            "created_at": "2023-01-06T13:46:38.839083Z",
            "updated_at": "2025-03-27T02:00:02.93205Z",
            "deleted_at": null,
            "main_name": "INDRIK SPIDER",
            "aliases": [],
            "source_name": "MISPGALAXY:INDRIK SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "28851008-77b4-47eb-abcd-1bb5b3f19fc2",
            "created_at": "2023-06-20T02:02:10.254614Z",
            "updated_at": "2025-03-27T02:00:03.130853Z",
            "deleted_at": null,
            "main_name": "Hagga",
            "aliases": [
                "TH-157",
                "Aggah"
            ],
            "source_name": "MISPGALAXY:Hagga",
            "tools": [
                "Agent Tesla"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "84aa9dbe-e992-4dce-9d80-af3b2de058c0",
            "created_at": "2024-02-02T02:00:04.041676Z",
            "updated_at": "2025-03-27T02:00:03.297502Z",
            "deleted_at": null,
            "main_name": "Vanilla Tempest",
            "aliases": [
                "DEV-0832",
                "Vice Society"
            ],
            "source_name": "MISPGALAXY:Vanilla Tempest",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b0d34dd6-ee90-483b-bb6c-441332274160",
            "created_at": "2022-10-25T16:07:23.296754Z",
            "updated_at": "2025-03-27T02:02:09.724313Z",
            "deleted_at": null,
            "main_name": "Aggah",
            "aliases": [
                "Operation Red Deer",
                "Operation Roma225"
            ],
            "source_name": "ETDA:Aggah",
            "tools": [
                "AgenTesla",
                "Agent Tesla",
                "AgentTesla",
                "Aggah",
                "Atros2.CKPN",
                "Bladabindi",
                "Jorik",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Negasteal",
                "Origin Logger",
                "Revenge RAT",
                "RevengeRAT",
                "Revetrat",
                "Warzone",
                "Warzone RAT",
                "ZPAQ",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "56b3eb1d-6baf-4ee4-a098-ec0081280315",
            "created_at": "2024-09-28T02:05:36.599884Z",
            "updated_at": "2025-03-27T02:05:17.250078Z",
            "deleted_at": null,
            "main_name": "ALUMINUM THORN",
            "aliases": [
                "WIRTE ",
                "Frankenstein "
            ],
            "source_name": "Secureworks:ALUMINUM THORN",
            "tools": [
                " Powershell Empire",
                "FruityC2"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d1f8bd4e-bcd4-4101-9158-6158f1806b38",
            "created_at": "2023-01-06T13:46:39.487358Z",
            "updated_at": "2025-03-27T02:00:03.107568Z",
            "deleted_at": null,
            "main_name": "BazarCall",
            "aliases": [
                "BazaCall",
                "BazzarCall"
            ],
            "source_name": "MISPGALAXY:BazarCall",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b296f34c-c424-41da-98bf-90312a5df8ef",
            "created_at": "2024-06-19T02:03:08.027585Z",
            "updated_at": "2025-03-27T02:05:17.350153Z",
            "deleted_at": null,
            "main_name": "GOLD DRAKE",
            "aliases": [
                "Indrik Spider ",
                "Evil Corp"
            ],
            "source_name": "Secureworks:GOLD DRAKE",
            "tools": [
                " Cobalt Strike",
                " Covenant",
                " Donut",
                " Dridex",
                " Hades",
                " Koadic",
                " LockBit",
                " Macaw Locker",
                " Mimikatz",
                " Payload.Bin",
                " Phoenix CryptoLocker",
                " PowerSploit",
                " Powershell Empire",
                " SocGholish",
                " WastedLocker",
                "BitPaymer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "40b623c7-b621-48db-b55b-dd4f6746fbc6",
            "created_at": "2024-06-19T02:03:08.017681Z",
            "updated_at": "2025-03-27T02:05:17.342829Z",
            "deleted_at": null,
            "main_name": "GOLD CABIN",
            "aliases": [
                "TA551 ",
                "Shathak"
            ],
            "source_name": "Secureworks:GOLD CABIN",
            "tools": [
                ""
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "600a0c3b-b595-4d10-b84b-cc2cf89289ac",
            "created_at": "2024-06-19T02:03:08.134296Z",
            "updated_at": "2025-03-27T02:05:17.402638Z",
            "deleted_at": null,
            "main_name": "GOLD VICTOR",
            "aliases": [
                "STAC5279 ",
                "Vanilla Tempest ",
                "Vice Society",
                "DEV-0832 "
            ],
            "source_name": "Secureworks:GOLD VICTOR",
            "tools": [
                " Advanced Port Scanner",
                " HelloKitty ransomware",
                " MEGAsync",
                " Neshta",
                " PAExec",
                " PSexec",
                " PortStarter",
                " SystemBC",
                " Zeppelin ransomware",
                "Advanced IP Scanner"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4e453d66-9ecd-47d9-b63a-32fa5450f071",
            "created_at": "2024-06-19T02:03:08.077075Z",
            "updated_at": "2025-03-27T02:05:17.381141Z",
            "deleted_at": null,
            "main_name": "GOLD LOTUS",
            "aliases": [
                "Hecamede ",
                "BlackByte"
            ],
            "source_name": "Secureworks:GOLD LOTUS",
            "tools": [
                " Cobalt Strike",
                " ExByte",
                " MEGA",
                " RDP",
                " SoftPerfect Network Scanner",
                "BlackByte"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1649239252,
    "ts_modification_date": 1649239355,
    "files": {
        "pdf": "https://archive.orkl.eu/aaf7d59ff3499b6a8c078bc790143342f906cb75.pdf",
        "text": "https://archive.orkl.eu/aaf7d59ff3499b6a8c078bc790143342f906cb75.txt",
        "img": "https://archive.orkl.eu/aaf7d59ff3499b6a8c078bc790143342f906cb75.jpg"
    }
}