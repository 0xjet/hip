{
    "id": "f7ca4f4c-6293-44d3-99fc-208aa951332c",
    "created_at": "2023-01-12T15:04:07.312112Z",
    "updated_at": "2025-03-27T02:06:12.857111Z",
    "deleted_at": null,
    "sha1_hash": "4c72cfb5e29b8a02217756bd664c3d8e74b394a0",
    "title": "2022-02-28 - Daxin- Stealthy Backdoor Designed for Attacks Against Hardened Networks",
    "authors": "",
    "file_creation_date": "2022-05-28T23:22:17Z",
    "file_modification_date": "2022-05-28T23:22:17Z",
    "file_size": 570477,
    "plain_text": "# Daxin: Stealthy Backdoor Designed for Attacks Against Hardened Networks\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/daxin-backdoor-espionage](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/daxin-backdoor-espionage)**\n\nThreat Hunter TeamSymantec\n\n## Espionage tool is the most advanced piece of malware Symantec researchers have seen from China-linked actors.\n\nNew research by the Symantec Threat Hunter team, part of Broadcom Software, has\nuncovered a highly sophisticated piece of malware being used by China-linked threat actors,\nexhibiting technical complexity previously unseen by such actors. The malware appears to\nbe used in a long-running espionage campaign against select governments and other critical\ninfrastructure targets.\n\nThere is strong evidence to suggest the malware, Backdoor.Daxin, which allows the attacker\nto perform various communications and data-gathering operations on the infected computer,\nhas been used as recently as November 2021 by attackers linked to China. Most of the\n\n\n-----\n\ntargets appear to be organizations and governments of strategic interest to China. In\naddition, other tools associated with Chinese espionage actors were found on some of the\nsame computers where Daxin was deployed.\n\nDaxin is without doubt the most advanced piece of malware Symantec researchers have\nseen used by a China-linked actor. Considering its capabilities and the nature of its deployed\nattacks, Daxin appears to be optimized for use against hardened targets, allowing the\nattackers to burrow deep into a target’s network and exfiltrate data without raising\nsuspicions.\n\nThrough Broadcom’s membership in the Joint Cyber Defense Collaborative (JCDC),\nSymantec researchers worked with the Cyber Security and Infrastructure Security Agency\n(CISA) to engage with multiple foreign governments targeted with Daxin and assisted in\ndetection and remediation.\n\nThis is the first in a series of blogs. This blog provides an overview of Daxin’s capabilities and\nwill be followed with additional blogs providing further in-depth analysis.\n\n## Daxin technical overview\n\nAs described in more detail below, Daxin comes in the form of a Windows kernel driver, a\nrelatively rare format for malware nowadays. It implements advanced communications\nfunctionality, which both provides a high degree of stealth and permits the attackers to\ncommunicate with infected computers on highly secured networks, where direct internet\nconnectivity is not available. These features are reminiscent of Regin, an advanced\nespionage tool discovered by Symantec in 2014 that others have linked to Western\nintelligence services.\n\nDaxin’s capabilities suggest the attackers invested significant effort into developing\ncommunication techniques that can blend in unseen with normal network traffic on the\ntarget’s network. Specifically, the malware avoids starting its own network services. Instead,\nit can abuse any legitimate services already running on the infected computers.\n\nDaxin is also capable of relaying its communications across a network of infected computers\nwithin the attacked organization. The attackers can select an arbitrary path across infected\ncomputers and send a single command that instructs these computers to establish requested\nconnectivity. This use case has been optimized by Daxin’s designers.\n\nDaxin also features network tunneling, allowing attackers to communicate with legitimate\nservices on the victim’s network that can be reached from any infected computer.\n\n## Daxin in detail\n\n\n-----\n\nDaxin is a backdoor that allows the attacker to perform various operations on the infected\ncomputer such as reading and writing arbitrary files. The attacker can also start arbitrary\nprocesses and interact with them. While the set of operations recognized by Daxin is quite\nnarrow, its real value to attackers lies in its stealth and communications capabilities.\n\nDaxin is capable of communicating by hijacking legitimate TCP/IP connections. In order to do\nso, it monitors all incoming TCP traffic for certain patterns. Whenever any of these patterns\nare detected, Daxin disconnects the legitimate recipient and takes over the connection. It\nthen performs a custom key exchange with the remote peer, where two sides follow\ncomplementary steps. The malware can be both the initiator and the target of a key\nexchange. A successful key exchange opens an encrypted communication channel for\nreceiving commands and sending responses. Daxin’s use of hijacked TCP connections\naffords a high degree of stealth to its communications and helps to establish connectivity on\nnetworks with strict firewall rules. It may also lower the risk of discovery by SOC analysts\nmonitoring for network anomalies.\n\nDaxin’s built-in functionality can be augmented by deploying additional components on the\ninfected computer. Daxin provides a dedicated communication mechanism for such\ncomponents by implementing a device named “\\\\.\\Tcp4”. The malicious components can\nopen this device to register themselves for communication. Each of the components can\nassociate a 32-bit service identifier with the opened \\\\.\\Tcp4 handle. The remote attacker is\nthen able to communicate with selected components by specifying a matching service\nidentified when sending messages of a certain type. The driver also includes a mechanism to\nsend back any responses.\n\nThere are also dedicated messages that encapsulate raw network packets to be transmitted\nvia the local network adapter. Daxin then tracks network flows, such that any response\npackets are captured and forwarded to the remote attacker. This allows the attacker to\nestablish communication with legitimate services that are reachable from the infected\nmachine on the target’s network, where the remote attacker uses network tunnels to interact\nwith internal servers of interest.\n\n\n-----\n\nFigure 1. Daxin can create stealthy communications channels in order to interact with\ncomputers on highly secured networks.\nPerhaps the most interesting functionality is the ability to create a new communications\nchannel across multiple infected computers, where the list of nodes is provided by the\nattacker in a single command. For each node, the message includes all the details required\nto establish communication, specifically the node IP address, its TCP port number, and the\ncredentials to use during custom key exchange. When Daxin receives this message, it picks\nthe next node from the list. Then it uses its own TCP/IP stack to connect to the TCP server\nlisted in the selected entry. Once connected, Daxin starts the initiator side protocol. If the\npeer computer is infected with Daxin, this results in opening a new encrypted communication\nchannel. An updated copy of the original message is then sent over this new channel, where\nthe position of the next node to use is incremented. The process then repeats for the\nremaining nodes on the list.\n\nWhile it is not uncommon for attackers’ communications to make multiple hops across\nnetworks in order to get around firewalls and generally avoid raising suspicions, this is\nusually done step-by-step, such that each hop requires a separate action. However, in the\ncase of Daxin, this process is a single operation, suggesting the malware is designed for\nattacks on well-guarded networks, where attackers may need to periodically reconnect into\ncompromised computers.\n\n\n-----\n\n## Timeline\n\nThe Symantec Threat Hunter team has identified Daxin deployments in government\norganizations as well as entities in the telecommunications, transportation, and\nmanufacturing sectors. Several of these victims were identified with the assistance of the\nPwC Threat Intelligence team.\n\nWhile the most recent known attacks involving Daxin occurred in November 2021, the\nearliest known sample of the malware dates from 2013 and included all of the advanced\nfeatures seen in the most recent variants, with a large part of the codebase having already\nbeen fully developed. This suggests that the attackers were already well established by\n2013, with Daxin features reflecting their expertise at that time.\n\nWe believe that before commencing development of Daxin, the attackers were already\nexperimenting for some time with the techniques that become part of Daxin. An older piece\nof malware – Backdoor.Zala (aka Exforel) – contained a number of common features but did\nnot have many of Daxin’s advanced capabilities. Daxin appears to build on Zala’s networking\ntechniques, reusing a significant amount of distinctive code and even sharing certain magic\nconstants. This is in addition to a certain public library used to perform hooking that is also\ncommon between some variants of Daxin and Zala. The extensive sharing indicates that\nDaxin designers at least had access to Zala’s codebase. We believe that both malware\nfamilies were used by the same actor, which became active no later than 2009.\n\n## Links to known espionage actors\n\nThere are several examples of attacks where tools known to be associated with Chinese\nespionage actors have been observed along with what we believe to be variants of Daxin.\n\nIn a November 2019 attack against an information technology company, the attackers used a\nsingle PsExec session to first attempt to deploy Daxin before then resorting to\nTrojan.Owprox. Owprox is associated with the China-linked Slug (aka Owlproxy).\n\nIn May 2020, malicious activity involving both Backdoor.Daxin and Trojan.Owprox occurred\non a single computer belonging to another organizations, a technology company.\n\nIn a July 2020 attack against a military target, the attackers made two unsuccessful attempts\nto deploy a suspicious driver. When these attempts failed, the attackers resorted to different\nmalware instead, a variant of Trojan.Emulov. Symantec did not obtain either of the two\nsuspicious drivers used in this attack. However, very strong similarities between this attack\nand earlier activity in which Daxin was used suggests that it is highly likely the attackers\nattempted to deploy Daxin before falling back on the other malware.\n\n## Developing analysis\n\n\n-----\n\nIn summary, Daxin includes some of the most complex features we have seen in a highly\nprobable China-linked malware campaign. We will publish follow-up blogs over the coming\ndays with more detailed technical analysis and other insights from our research and\ncollaborations.\n\n## Protection/Mitigation\n\n[For the latest protection updates, please visit the Symantec Protection Bulletin.](https://www.broadcom.com/support/security-center/protection-bulletin)\n\n## Indicators of Compromise\n\n**Malware related to Daxin activity:**\n\n81c7bb39100d358f8286da5e9aa838606c98dfcc263e9a82ed91cd438cb130d1\nBackdoor.Daxin (32-bit core)\n\n06a0ec9a316eb89cb041b1907918e3ad3b03842ec65f004f6fa74d57955573a4\nBackdoor.Daxin (64-bit core)\n\n0f82947b2429063734c46c34fb03b4fa31050e49c27af15283d335ea22fe0555\nBackdoor.Daxin (64-bit core)\n\n3e7724cb963ad5872af9cfb93d01abf7cd9b07f47773360ad0501592848992f4\nBackdoor.Daxin (64-bit core)\n\n447c3c5ac9679be0a85b3df46ec5ee924f4fbd8d53093125fd21de0bff1d2aad Backdoor.Daxin\n(64-bit core)\n\n49c827cf48efb122a9d6fd87b426482b7496ccd4a2dbca31ebbf6b2b80c98530\nBackdoor.Daxin (64-bit core)\n\n5bc3994612624da168750455b363f2964e1861dba4f1c305df01b970ac02a7ae\nBackdoor.Daxin (64-bit core)\n\n5c1585b1a1c956c7755429544f3596515dfdf928373620c51b0606a520c6245a\nBackdoor.Daxin (64-bit core)\n\n6908ebf52eb19c6719a0b508d1e2128f198d10441551cbfb9f4031d382f5229f Backdoor.Daxin\n(64-bit core)\n\n7867ba973234b99875a9f5138a074798b8d5c65290e365e09981cceb06385c54\nBackdoor.Daxin (64-bit core)\n\n7a08d1417ca056da3a656f0b7c9cf6cd863f9b1005996d083a0fc38d292b52e9\nBackdoor.Daxin (64-bit core)\n\n\n-----\n\n8d9a2363b757d3f127b9c6ed8f7b8b018e652369bc070aa3500b3a978feaa6ce\nBackdoor.Daxin (64-bit core)\n\nb0eb4d999e4e0e7c2e33ff081e847c87b49940eb24a9e0794c6aa9516832c427\nBackdoor.Daxin (64-bit core)\n\nb9dad0131c51e2645e761b74a71ebad2bf175645fa9f42a4ab0e6921b83306e3\nBackdoor.Daxin (64-bit core)\n\ncf00e7cc04af3f7c95f2b35a6f3432bef990238e1fa6f312faf64a50d495630a Backdoor.Daxin\n(64-bit core)\n\ne7af7bcb86bd6bab1835f610671c3921441965a839673ac34444cf0ce7b2164e\nBackdoor.Daxin (64-bit core)\n\nea3d773438c04274545d26cc19a33f9f1dbbff2a518e4302addc1279f9950cef Backdoor.Daxin\n(64-bit core)\n\n08dc602721c17d58a4bc0c74f64a7920086f776965e7866f68d1676eb5e7951f\nBackdoor.Daxin (dropper)\n\n53d23faf8da5791578c2f5e236e79969289a7bba04eee2db25f9791b33209631\nBackdoor.Daxin (dropper)\n\n7a7e8df7173387aec593e4fe2b45520ea3156c5f810d2bb1b2784efd1c922376 Backdoor.Zala\n(32-bit core)\n\n8dafe5f3d0527b66f6857559e3c81872699003e0f2ffda9202a1b5e29db2002e Backdoor.Zala\n(32-bit core)\n\n96bf3ee7c6673b69c6aa173bb44e21fa636b1c2c73f4356a7599c121284a51cc\nBackdoor.Trojan (32-bit core)\n\n9c2f3e9811f7d0c7463eaa1ee6f39c23f902f3797b80891590b43bbe0fdf0e51 Backdoor.Trojan\n(32-bit core)\n\nc0d88db11d0f529754d290ed5f4c34b4dba8c4f2e5c4148866daabeab0d25f9c\nBackdoor.Trojan (32-bit core)\n\ne6a7b0bc01a627a7d0ffb07faddb3a4dd96b6f5208ac26107bdaeb3ab1ec8217\nBackdoor.Trojan (32-bit core)\n\n**File names attributed to Daxin activity:**\n\n\"ipfltdrvs.sys\"\n\n\"ndislan.sys\"\n\n\n-----\n\nndislan_win2008_x64.sys\n\n\"ntbios.sys\"\n\n\"patrol.sys\"\n\n\"performanceaudit.sys\"\n\n\"print64.sys\"\n\n\"printsrv64.sys\"\n\n\"prv64.sys\"\n\n\"sqlwriter.sys\"\n\n\"srt.sys\"\n\n\"srt64.sys\"\n\n\"syswant.sys\"\n\n\"usbmrti.sys\"\n\n\"vncwantd.sys\"\n\n\"wantd.sys\"\n\n\"win2k8.sys\"\n\n\"wmipd.sys\"\n\n\"[CSIDL_SYSTEM]\\drivers\\pagefile.sys\"\n\n\"[CSIDL_SYSTEM]\\spool\\drivers\\ntds.sys\"\n\n**Malware observed during overlapping activities:**\n\n705be833bd1880924c99ec9cf1bd0fcf9714ae0cec7fd184db051d49824cbbf4 suspected\nBackdoor.Daxin\n\nc791c007c8c97196c657ac8ba25651e7be607565ae0946742a533af697a61878 suspected\nBackdoor.Daxin\n\n514d389ce87481fe1fc6549a090acf0da013b897e282ff2ef26f783bd5355a01 Trojan.Emulov\n(core)\n\n\n-----\n\n1a5c23a7736b60c14dc50bf9e802db3fcd5b6c93682bc40141d6794ae96138d3\nTrojan.Emulov (dropper)\n\na0ac5f7d41e9801b531f8ca333c31021c5e064f13699dbd72f3dfd429f19bb26 Trojan.Owprox\n(core)\n\naa7047a3017190c66568814eb70483bf74c1163fb4ec1c515c1de29df18e26d7\nTrojan.Owprox (dropper)\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-28 - Daxin- Stealthy Backdoor Designed for Attacks Against Hardened Networks.pdf"
    ],
    "report_names": [
        "2022-02-28 - Daxin- Stealthy Backdoor Designed for Attacks Against Hardened Networks.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535847,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1653780137,
    "ts_modification_date": 1653780137,
    "files": {
        "pdf": "https://archive.orkl.eu/4c72cfb5e29b8a02217756bd664c3d8e74b394a0.pdf",
        "text": "https://archive.orkl.eu/4c72cfb5e29b8a02217756bd664c3d8e74b394a0.txt",
        "img": "https://archive.orkl.eu/4c72cfb5e29b8a02217756bd664c3d8e74b394a0.jpg"
    }
}