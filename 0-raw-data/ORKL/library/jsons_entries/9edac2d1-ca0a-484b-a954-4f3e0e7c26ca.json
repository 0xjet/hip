{
    "id": "9edac2d1-ca0a-484b-a954-4f3e0e7c26ca",
    "created_at": "2023-01-12T15:00:50.477033Z",
    "updated_at": "2025-03-27T02:09:18.142887Z",
    "deleted_at": null,
    "sha1_hash": "a3691f058830aaf9fe67c2e6713b77ac7dee73f2",
    "title": "2021-05-18 - DarkSide Ransomware Behavior and Techniques",
    "authors": "",
    "file_creation_date": "2022-05-27T22:37:10Z",
    "file_modification_date": "2022-05-27T22:37:10Z",
    "file_size": 419012,
    "plain_text": "# DarkSide Ransomware Behavior and Techniques\n\n**[blogs.keysight.com/blogs/tech/nwvs.entry.html/2021/05/18/darkside_ransomware-QfsV.html](https://blogs.keysight.com/blogs/tech/nwvs.entry.html/2021/05/18/darkside_ransomware-QfsV.html)**\n\n2021-05-18 |  5 min read\n\nA modern ransomware, DarkSide offers their ransomware-as-a-service to other cyber-criminal groups for a percentage of the profits. Both\nWindows and Linux versions of the ransomware have been found in the wild. It encrypts files using the lightweight Salsa20 encryption\nalgorithm with an RSA-1024 public key. Victims are presented with Bitcoin and Monero wallets to pay the cyber-criminal sums varying from two\nthousand to two million dollars for the decryption key. According to TrendMicro, the actor behind this ransomware family is believed\nto be Eastern European.\n\nGroups leveraging DarkSide have recently been targeting manufacturing, insurance, healthcare, and energy organizations. Multiple strains of\nthe ransomware were released either to attack specific high-value targets or to hamper the detection effort. Following the attack on Colonial\n[Pipeline, another DarkSide strain also managed to successfully infected a Toshiba Tech business unit in France. Meanwhile, another eastern-](https://www.cnbc.com/2021/05/14/toshiba-business-unit-says-it-has-been-hacked-by-darkside-reuters.html)\n[European ransomware (calling themselves Conti) has](https://malpedia.caad.fkie.fraunhofer.de/details/win.conti) [infected the Ireland’s national health service.](https://tech.slashdot.org/story/21/05/14/1414203/significant-ransomware-attack-forces-irelands-health-service-to-shut-down-it-systems)\n\nDarkSide uses phishing, weak credentials, and exploitation of known vulnerabilities (such as CVE-2021-20016, a SQL injection in the\nSonicWall SMA100 SSL VPN product) as tactics to gain system access.\n\nKeysight's Application and Threat Intelligence (ATI) research team has released a DarkSide kill chain assessment, simulating the\nmalware’s behavior. In this blog post, we'll walk you through what happens when the DarkSide malware infects a system, in terms of MITRE\nATT&CK techniques.\n\n**T1082 - System Information Discovery**\n\nThe malware checks whether its process is being debugged by a user-mode debugger. If that is the case, then the malware will exit. It is a\ncommon malware anti-debugging mechanism.\n\n\n-----\n\nOther WIN APIs associated with system information discovery that this malware showcases include:\n\n**GetSystemInfo: Used to return the processor count. This API can be used to determine if the malware is being run in a**\nvirtualized environment.\n\n**CheckRemoteDebuggerPresent: Used to determine if a remote process is being debugged.**\n\n**GetSystemDefaultUILanguage, GetUserDefaultLangID: Used to detect the configured language on the system. The malware will not**\ninfect the host if the following languages are installed:\n\nRussian - 419 Azerbaijani (Latin) - 42C Uzbek (Latin) - 443 Uzbek (Cyrillic) - 843\n\nUkranian - 422 Georgian - 437 Tatar - 444 Arabic (Syria) - 2801\n\nBelarusian - 423 Kazakh - 43F Romanian (Moldova) - 818\n\nTajik - 428 Kyrgyz (Cyrillic) - 440 Russian (Moldova) - 819\n\nArmenian - 42B Turkmen - 442 Azerbaijani (Cyrillic) - 82C\n\n**T1543.003: Create or Modify System Process: Windows Service**\n\nThe malware will attempt to attain persistence by calling the CreateServiceA WIN API that creates a system service pointing to the malware\nexecutable file, which will start automatically after restart:\n\nThe malicious service hides itself using the name .021e895b, a pseudo-random string of eight lowercase hexadecimal\ncharacters, [generated based on either the system’s MAC address or MachineGuid registry value.](https://gist.github.com/Demonslay335/f82b8d9f94040b875ceb2386f9533362)\n\n**T1548.002: Abuse Elevation Control Mechanism, Bypass User Account Control**\n\n[If the operating system is Windows 10 or newer, the malware attempts a UAC bypass through a CMSTPLUA COM interface. A proof of](https://cqureacademy.com/cqure-labs/cqlabs-how-uac-bypass-methods-really-work-by-adrian-denkiewicz)\n[concept is available here.](https://github.com/cnsimo/BypassUAC)\n\n**T1553.002: Subvert Trust Controls, Code Signing**\n\nTo be able to run on systems where only signed code is allowed to execute, the malware is signed with Cobalt Strike stager’s certificate.\n\n\n-----\n\n**T1490: Inhibit System Recovery**\n\nBefore encrypting the files on the system, the ransomware uses the CreateProcess API to execute the following command:\n```\npowershell -ep bypass -c \"(0..61)|%{$s+=[char][byte]\n('0x'+'4765742D576D694F626A6563742057696E33325F536861646F77636F7079207C20466F72456163682D4F626A656374207B245F2E44656C657\n$s\"\n\n```\nBy decoding the content of the byte stream, we obtain:\n\nThe PowerShell command is querying the WMI to obtain the list of the system’s shadow copies and deletes them before encrypting the user\nfiles, thus avoiding post-infection system recovery.\n\n**T1486: Data Encrypted for Impact**\n\nThe found system files are encrypted using the lightweight Salsa20 encryption algorithm. Each key is encrypted using the embedded RSA1024 public key. In each traversed directory, the malware writes the ransom note shown below.\n\n\n-----\n\n## Conclusion \n\nDarkside has above-average anti-VM/anti-debugging protections. Written in C and highly modular, it was released in different versions, with\nmultiple packers, which made it hard to pin down with signature-based detection. For more details, please inspect joint CISA-FBI\ncybersecurity [advisory on the DarkSide ransomware.](https://us-cert.cisa.gov/ncas/alerts/aa21-131a)\n\nUsing the knowledge gleaned from reverse engineering, we have released a complete Darkcloud killchain assessment for our Threat\nSimulator customers. Now you can test your endpoint and network security controls for coverage of this and many other threats in your\nproduction environment safely.\n\n© Keysight Technologies 2000–2022\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-18 - DarkSide Ransomware Behavior and Techniques.pdf"
    ],
    "report_names": [
        "2021-05-18 - DarkSide Ransomware Behavior and Techniques.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535650,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653691030,
    "ts_modification_date": 1653691030,
    "files": {
        "pdf": "https://archive.orkl.eu/a3691f058830aaf9fe67c2e6713b77ac7dee73f2.pdf",
        "text": "https://archive.orkl.eu/a3691f058830aaf9fe67c2e6713b77ac7dee73f2.txt",
        "img": "https://archive.orkl.eu/a3691f058830aaf9fe67c2e6713b77ac7dee73f2.jpg"
    }
}