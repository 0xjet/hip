{
    "id": "9fdbb15c-7022-48da-8f13-2a55b8e579a8",
    "created_at": "2023-01-12T15:01:09.747644Z",
    "updated_at": "2025-03-27T02:05:24.838593Z",
    "deleted_at": null,
    "sha1_hash": "85990af646e60242127bd6b97e51493d126e81e1",
    "title": "2022-06-08 - Attackers Exploit MSDT Follina Bug to Drop RAT, Infostealer",
    "authors": "",
    "file_creation_date": "2022-08-18T03:22:41Z",
    "file_modification_date": "2022-08-18T03:22:41Z",
    "file_size": 946011,
    "plain_text": "# Attackers Exploit MSDT Follina Bug to Drop RAT, Infostealer\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/follina-msdt-exploit-malware](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/follina-msdt-exploit-malware)**\n\nKarthikeyan C KasiviswanathanPrincipal Threat Analysis Engineer\n\nYuvaraj MegavarnaduSenior Threat Analysis Engineer\n\n## Symantec has observed threat actors exploiting remote code execution flaw to drop AsyncRAT and information stealer.\n\n\n-----\n\n[Symantec, a division of Broadcom Software, has observed threat actors exploiting the](https://software.broadcom.com/)\nremote code execution (RCE) vulnerability known as Follina to drop malware onto vulnerable\nsystems just days after the flaw became public on May 27, 2022.\n\n## What is Follina?\n\nFollina (CVE-2022-30190) is a vulnerability in the Microsoft Support Diagnostic Tool (MSDT)\nthat allows remote code execution on vulnerable systems through the ms-msdt protocol\nhandler scheme. The bug is present in all supported versions of Windows.\n\nThe vulnerability can be easily exploited by a specially crafted Word document that\ndownloads and loads a malicious HTML file through Word’s remote template feature. The\nHTML file ultimately allows the attacker to load and execute PowerShell code within\nWindows. The vulnerability can also be exploited through the RTF file format.\n\nExploiting the flaw does not require the use of macros, eliminating the need for an attacker to\ntrick victims into enabling macros for an attack to work.\n\nMicrosoft has since released advisories and workarounds to mitigate the vulnerability.\n\n## Attackers quick to take advantage\n\nSince the details of the vulnerability started surfacing online, attackers were quick to start\ntaking advantage of the flaw to install their payloads. Symantec has observed attackers\nusing a similar HTML file to that used in the initial attack.\n\nFigure 1. HTML file similar to that used in initial attack\nWhen the HTML document is executed in the context of WinWord, msdt.exegets spawned as\na child process. That is because of the protocol handler entry in the registry.\n\nFigure 2. Protocol handler entry in the registry\n\n\n-----\n\nSdiagnhost.exe is then invoked, which is the Scripted Diagnostics Native Host, and under\nthis process the final payload process is created - in our case PowerShell.\n\nFigure 3.\n\nPowerShell is created under the Scripted Diagnostics Native Host process\nMultiple attackers are using a variety of payloads at the end of successful exploitation. In one\nof the instances, Symantec observed the attackers deploying the remote access Trojan\nAsyncRAT, which had a valid digital signature.\n\nWhen AsyncRAT runs, it carries out the anti-analysis checks shown in Figure 4.\n\nFigure 4. AsyncRAT carries out anti-analysis checks\nLater, AsyncRAT collects information about the infected system, including hardware\nidentification, user name, executed path, and operating system information, and sends it to a\ncommand-and-control (C&C) server.\n\nFigure 5. AsyncRAT collects information from the infected system\nAsyncRAT then waits for commands from the C&C server and executes those commands on\nthe victim machine.\n\nSymantec has also observed attackers deploying an information stealer as a payload. The\ncode shown in Figure 6 is a snippet from the malware, which steals information including\ncookies and saved login data from web browsers such as Firefox, Chrome, and Edge.\n\n\n-----\n\nFigure 6. Snippet of code from information-stealing malware dropped by attackers exploiting\nFollina bug\n\n## Protection/Mitigation\n\n[For the latest protection updates, please visit the Symantec Protection Bulletin.](https://www.broadcom.com/support/security-center/protection-bulletin)\n\nSymantec protects against these attacks with the following definitions:\n\n**File-based**\n\nDownloader\nBackdoor.ASync\nInfoStealer\n\n**Network-based**\n\n[33748 [Web Attack: MSDT Remote Code Execution CVE-2022-30190]](https://www.broadcom.com/support/security-center/attacksignatures/detail?asid=33748)\n\n## Indicators of Compromise\n\nIf an IOC is malicious and the file available to us, Symantec Endpoint products will detect\nand block that file.\n\ne7faa6c18d4906257652253755cf8f9a739c10938db369878907f8ed7dd8524d\n\nb63fbf80351b3480c62a6a5158334ec8e91fecd057f6c19e4b4dd3febaa9d447\n\n8e0be5e1035777f2ea373593c214d29ad146dd0453e9b8a1cad16d787c0be632\n\n\n-----\n\n## About the Author\n\n### Karthikeyan C Kasiviswanathan\n\n**Principal Threat Analysis Engineer**\n\nKarthikeyan is a member of Symantec’s Security Technology and Response team which is\nfocused on providing round-the-clock protection against current and future cyber threats.\n\n## About the Author\n\n### Yuvaraj Megavarnadu\n\n**Senior Threat Analysis Engineer**\n\nYuvaraj is a member of Symantec's Security Technology and Response team, whose work\nincludes analyzing malware and providing generic protection for various Symantec products.\n\n## Want to comment on this post?\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-08 - Attackers Exploit MSDT Follina Bug to Drop RAT, Infostealer.pdf"
    ],
    "report_names": [
        "2022-06-08 - Attackers Exploit MSDT Follina Bug to Drop RAT, Infostealer.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535669,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1660792961,
    "ts_modification_date": 1660792961,
    "files": {
        "pdf": "https://archive.orkl.eu/85990af646e60242127bd6b97e51493d126e81e1.pdf",
        "text": "https://archive.orkl.eu/85990af646e60242127bd6b97e51493d126e81e1.txt",
        "img": "https://archive.orkl.eu/85990af646e60242127bd6b97e51493d126e81e1.jpg"
    }
}