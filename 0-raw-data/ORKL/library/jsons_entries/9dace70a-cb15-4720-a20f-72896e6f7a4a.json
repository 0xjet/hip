{
    "id": "9dace70a-cb15-4720-a20f-72896e6f7a4a",
    "created_at": "2023-01-12T15:03:10.553553Z",
    "updated_at": "2025-03-27T02:10:07.545885Z",
    "deleted_at": null,
    "sha1_hash": "f2c711b0490183235e6c786aeb8f0cdae23f0eff",
    "title": "2021-01-24 - VisualDoor- SonicWall SSL-VPN Exploit",
    "authors": "",
    "file_creation_date": "2022-05-28T15:44:43Z",
    "file_modification_date": "2022-05-28T15:44:43Z",
    "file_size": 314574,
    "plain_text": "# VisualDoor: SonicWall SSL-VPN Exploit\n\n**[darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/amp/](https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/amp/?__twitter_impression=true)**\n\ndarrenmart January 24, 2021\n\ndarrenmart\n1 year ago\n\nI’ve been sitting on this one for quite a while now, and figured what with SonicWall back in\nthe news for getting [owned via some 0days in their own shit products, it would be somewhat](https://www.zdnet.com/article/sonicwall-says-it-was-hacked-using-zero-days-in-its-own-products/)\namusing to release this. I’m fairly sure its patched by now. Anyway, its lockdown 3.0 so you\nshould stay inside and do crime bug bounties. I’ve shared various versions of this exploit in\nthe past with people, so its not exactly a huge secret.\n\nThis bug isn’t even mine, it comes courtesy of Phineas Fisher, who used it to breach Hacking\nTeam and later some other organisations. I would seriously advise aspiring hackers of any\nhat colour to closely study the work of Phineas for ideas on how they can improve their\nhacking. It’s very instructive.\n\nTL;DR: SonicWall “Virtual Office” SSL-VPN Products ship a fucking ancient version of Bash\nvulnerable to ShellShock, and are therefore vulnerable to unauthenticated remote code\nexecution (as a “nobody” user) via the `/cgi-bin/jarrewrite.sh URL.`\n\nThe exploit is incredibly trivial. We simply spaff a shellshock payload containing a bash\n/dev/tcp backconnect at it, and we get a shell. Now, the environment on these things is\nincredibly limited – its stripped down Linux. But we have bash, openssl, and FTP. So you\ncould always download your own toolkit for further exploitation.\n\nAnyway, here is the public exploit. It is incredibly trivial and recycles the telnetlib handler for\nreverse shells from exploits released by Stephen Seeley.\n[https://github.com/darrenmartyn/visualdoor.](https://github.com/darrenmartyn/visualdoor)\n\n\n-----\n\nExploit in Action.\nThere is also a couple of ways to get root on these, the `dos2unix program is setuid-root for`\na start. This can be abused by someone clever enough to get root. I’ve decided to leave this\nas an exercise for the reader and remove that function from the published exploit. The kernel\nis painfully ancient as well.\n\nIt should also be noted that these things talk to AD for authentication, and that in the ones\nI’ve come across while working, the /tmp directory is often littered with Kerberos\nauthentication things. Phineas had another way of getting inside AD by simply replacing a\nCGI script with a trojan version that you could probably implement.\n\nAs for how many of these there are in the wild? A few thousand at least. I’ve not done any\nreal scanning for obvious reasons of “I don’t commit crimes”, but the following Shodan\nsearches show up a decent number of them:\n\n```\nhttp.favicon.hash:-1153950306\n\n```\n\n-----\n\n```\nhttp.favicon.hash:-2012355198 .\n\n```\nYou can likely work out other Shodan queries for these and find a bunch more of them. I’m\nnot particularly willing to bother poking random peoples VPN servers, and only have\nfingerprints for ones I encountered on engagements.\n\nAnyway, the only recommendation I have if you use these products is to unplug them, douse\nthem in kerosene, and set them on fire. It is the only way to be safe from something\nseemingly developed with this level of negligence.\n\nFootnote: the webserver in use seems to be called “EasyAccess”, with the CGI script living in\nthe path: `/usr/src/EasyAccess/www/cgi-bin . A very apt name, really.`\n\n[Footnote 2.0, the other foot drops: SonicWall claim this was fixed in 2015, in this tweet.](https://twitter.com/SonicWall/status/1353750484188848128)\nFinally! Some answers! Good sports they were about it and all! SMA 8.0.0.4 is where it is\nfinally killed off.\nStill doesn’t answer why they were using a Bash version from 2002, or a kernel version from\nlike, 2005, but whatever. Nothing new in the world of appliances, really.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-24 - VisualDoor- SonicWall SSL-VPN Exploit.pdf"
    ],
    "report_names": [
        "2021-01-24 - VisualDoor- SonicWall SSL-VPN Exploit.pdf"
    ],
    "threat_actors": [
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535790,
    "ts_updated_at": 1743041407,
    "ts_creation_date": 1653752683,
    "ts_modification_date": 1653752683,
    "files": {
        "pdf": "https://archive.orkl.eu/f2c711b0490183235e6c786aeb8f0cdae23f0eff.pdf",
        "text": "https://archive.orkl.eu/f2c711b0490183235e6c786aeb8f0cdae23f0eff.txt",
        "img": "https://archive.orkl.eu/f2c711b0490183235e6c786aeb8f0cdae23f0eff.jpg"
    }
}