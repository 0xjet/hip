{
    "id": "521daef8-e133-46d7-a737-e9fadadd8ed9",
    "created_at": "2022-10-25T16:48:15.475274Z",
    "updated_at": "2025-03-27T02:16:20.784502Z",
    "deleted_at": null,
    "sha1_hash": "7f978cc7c21fa0cc47c0f13d09854c54bc0282dd",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-05-28T17:03:22Z",
    "file_modification_date": "2020-05-28T17:03:22Z",
    "file_size": 1362406,
    "plain_text": "##### CYBER SECURITY DIVISION\n\n## MALWARE TECHNICAL INSIGHT\n\n TURLA “Penquin_x64”\n\n#### Last update: May 29th 2020\n\nThe information contained in this document is proprietary to Leonardo S.p.a. This document and the information contained herein may\nnot be copied, reproduced, used or disclosed in whole or in part in any form without the prior written consent of Leonardo S.p.a.\n\n**© Copyright Leonardo S.p.a. – All rights reserved**\n\n\n-----\n\n# INDEX\n\n**EXECUTIVE SUMMARY……………………………………………..………………………………….....1**\n\n**1. SCENARIO……..……..………………………………………………………………………………....2**\n\n**2. EVOLUTION OF THE “PENQUIN”…………....…………………………………………………......4**\n\n**3. BUILD DATE ESTIMATION…………………………………………………………………………...7**\n\n**4. MALWARE CAPABILITIES………………………………………………………………………….10**\n\n**5. CONCLUSION………………………………………………………………………………………....22**\n\n**6. MITRE ATT&CK TTPs………………………………………………………………………………..23**\n\n**7. INDICATORS OF COMPROMISE…………………………………………….……………....…….25**\n\n**REFERENCES………………………………………………………………………………………..........28**\n\n**APPENDIX A: BUILD DATE ESTIMATION…………………………………………………………….29**\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### EXECUTIVE SUMMARY\n\nThe APT group known as Turla (aka Snake, Venomous Bear, Group 88, Uroburos, Waterbug\nand others) is a well-established collective that has been operational since at least 2004. Turla\nis one of the most advanced APTs in the world; it is famous for developing new and very\nadvanced techniques to avoid detection and to ensure the persistence on the targeted\nnetwork. This adversary is known for targeting, among the others, government, defense and\neducation sectors all around the globe.\n\nIn December 2014, Kaspersky reported on a tool attributed to the Turla intrusion set used to\ntarget the Linux Operating System: they named it “Penquin” Turla. In 2017, more information\nabout this threat was discovered[1]. Since then, almost three years have passed with no new\ninformation being discovered about this specific threat, until now.\n\nIn this technical report we analyse new samples of the toolkit spotted in April 2020, and\ndubbed “Penquin_x64”. We describe in depth the capabilities of this stealth backdoor,\ncomparing it to the older known versions, and we also investigate the possible build dates of\nthese samples. The threat actor put in place a considerable amount of effort to avoid the\nimproper activation of the backdoor. In this report we shed light on the communication\nprotocol, providing a tool to efficiently detect a “Penquin_x64” infection in enterprise networks.\n\nThe discovery of this Turla module still raises the same question of the 2014 Kaspersky’s\nreport about how many other unknown Turla variants exist.\n\n**MITRE ATT&CK TTPs**\n\nT1059 T1205 T1105 T1094 T1024 T1032 T1158 T1222\n\n### 8% 8% 25% 17% 42%\n\nEXECUTION MOVEMENTLATERAL DEFENCE EVASION PERSISTENCE COMMAND AND  CONTROL\n\n**Figure 1 – Evaluation of “Penquin_x64” tactics and techniques**\n\n1\nPENQUIN’S MOONLIT MAZE: The Dawn of Nation-State Digital Espionage; by Juan Andres GuerreroSaade (GReAT), Costin Raiu (GReAT), Daniel Moore (King’s College London), Thomas Rid (King’s College\nLondon). April 2017. REMOTE FILE COPYCOMMAND-LINE INTERFACEPORT KNOCKINGCUSTOM CRYPTOGRAPHIC PROTOCOLSTANDARD CRYPTOGRAPHIC PROTOCOLHIDDEN FILES AND DIRECTORIESFILE AND DIRECTORY PERMISSIONS MODIFICATIONCUSTOM COMMAND AND CONTROL PROTOCOL\n\n\n**MITRE ATT&CK TTPs**\n\n\n### 8%\n\n\n### 25%\n\n\n### 42%\n\n\nDEFENCE\n\nEVASION\n\n\nEXECUTION\n\n\nT1094\n\n\nT1105\n\n\nT1032\n\n\nT1059\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### 1. SCENARIO\n\nIn April 2020, a few other samples similar to those detected in 2014 have been uploaded to a\nmulti-scanner service. They let us discover the existence of an additional version of Turla\n“Penquin” that has not been analysed yet: we named it “Penquin_x64”.\n\nNew samples of “Penquin_x64”\n\nFirst Penquin A few more information\n\nRise of TURLA APT discovered and analysed by\n\ndiscovery about Penquin backdoor\n\nLeonardo’s cybersecurity analysts\n\n**2004** **2014** **2017** **2020**\n\n**Figure 2 – Timeline of “Penquin” events**\n\n“Penquin_x64” is a stealth backdoor that, in addition, tries to hide itself from the eyes of the\nsystem administrators mimicking the “cron” binary, that is a system utility used to create prescheduled and periodic background jobs on Linux servers and clients.\n\nThe analysis we performed allowed us to fully understand all the malware\ncapabilities and the network protocol used to activate the backdoor. Consequently,\nwe built a python code that can be used by system administrators to check the\npresence of “Penquin_x64” on their networks.\n\n“Penquin_x64” is a brand new piece of the Turla puzzle that remained uncovered for years. It\nis not possible to identify the exact date of build for this version. However, the analysis\nperformed allowed us to estimate with high confidence that the most recent sample we\ndiscovered has been built between 2016 and 2017. We cannot state that this component is still\nin use by Turla, but there is the possibility that additional versions that target the Linux OS\nhave not been discovered yet. Even though we do not have concrete data to support this\nstatement, we can confirm that the most recent samples we found are still able to run on the\ncurrent stable version of Ubuntu.\n\nConsidering that Turla is one of the most complex APTs in the world, and since it is highly\nlikely that this malware has been used more often than what we currently know, we\nrecommend to verify its presence on Linux OS servers and clients by using the tool we have\nbuilt and the indicators of compromise attached to the end of this report. Based on our\nanalysis, we have a high degree of confidence that this malware has been used as a post\ncompromise tool on Virtual Private Servers that successively played a role in the Turla network\ninfrastructure (Figure 3).\n\n\nNew samples of “Penquin_x64”\n\ndiscovered and analysed by\nLeonardo’s cybersecurity analysts\n\n\nFirst Penquin\n\ndiscovery\n\n\nRise of TURLA APT\n\n\n**2014**\n\n\n**2020**\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n\nVICTIMS INFECTED\nBY ANOTHER TYPE\n**OF TURLA’S**\n**IMPLANT**\n\n\n**Figure 3 – Hypothesis about the role of the Penquin family within the Turla’s infrastructure**\n\nThe behavior of this implant suggests that it starts to operate at the “Installation” phase of the\nCyber Kill Chain®, and, successively, once the stealth backdoor is activated by the attacker, it\noperates at the “Command and Control” phase also (Figure 4). At the same time, we do not\nexclude that the “Actions on Objectives” phase could be up and running on the compromised\ninfrastructure or on other infrastructures that are reachable from the infected one. However,\nsince we did not have the chance to investigate an actual incident involving this implant, it is\nnot possible to be confident about this last statement.\n\n\nRECONNAISSANCE DELIVERY\n\n\nACTIONS ON\nINSTALLATION\nOBJECTIVES\n\nEXPLOITATION COMMAND\nAND CONTROL\n\n\nCOMMAND\nAND CONTROL\n\n\nWEAPONIZATION\n\n\nINSTALLATION\n\n\n**Figure 4 – Penquin killchain phases**\n\n\nACTIONS ON\nOBJECTIVES\n\n\nEXPLOITATION\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### 2. EVOLUTION OF THE “PENQUIN”\n\nThe birth of the “Penquin” toolkit goes back years, at the dawn of Nation-State digital\nespionage. Two important reports of extremely high quality about this threat have been\npublished by Kaspersky GReAT, in 2014 and in 2017 respectively: “The Penquin Turla” [1] and\n“Penquins Moonlit Maze” [2]. While the former is a technical analysis of a set of samples found\nin the wild, the latter gives a very broad but specific context about Turla intrusion set, and how\nit evolved since the early 2000s. A third important report that mentioned features of the\n“Penquin” family has been published by the Swiss CERT in 2016 detailing a prolonged\ncampaign against the defence contractor Ruag [3].\n\nIn April 2020, we detected three new “Penquin” samples. With respect to those already known,\nthese new samples target 64 bits architectures. We analysed them, and we compared them\nwith the old ones. In the rest of this document we will report the result of this deep technical\nanalysis that allowed us to understand much more about this specific threat. In the following\nsection we will describe the three different versions of “Penquin” we have been able to identify.\nWe will provide an estimation of the build date of the new samples in Section 2, while in\nSection 3 we will report on the capabilities of this malware, also providing a discussion about\ndifferences and commonalities of the different versions.\n\n##### 2.1 “Penquin” versions\n\nHaving at our disposal new and old samples, we have been able to categorise them in three\ndifferent sets that have many commonalities, but also a few important differences.\n\nThe first set, that we will call “Penquin”, is the one firstly analysed by Kaspersky in\n\n**1**\n\n2014. One of its peculiar features is the sniffing technique initially attributed to the cd00r\n[project (http://www.phenoelit.org/stuff/cd00r.c) [1], and successively to LOKI2 [2]. This](http://www.phenoelit.org/stuff/cd00r.c)\nfeature allows the samples belonging to this set to become stealth backdoors that are\ndifficult to detect, and that can be potentially used as post-compromise tools. Indeed,\nthe sample will connect back to a C2 only after a sniffed packet matches a series of\npredefined mathematical conditions. Note that the IP address of the C2 is encoded in\nthe activation packet, and therefore it is not possible to foresee it in advance.\n\nWe named the second set of samples “Penquin_2.0”. One sample belonging to this set\n\n**2**\n\nhas been detected by Kaspersky after the first publication of their 2014 report, which\nhas been updated to include it. The other three samples we know about have been first\nseen in the wild in 2014, 2016 and 2017 respectively. All of them have been included\namong the indicators of compromise reported in [2]. “Penquin_2.0” shares most of the\ncapabilities with his ancestor, but there is a fundamental difference: it doesn’t use the\nnetwork sniffing technique anymore. On the contrary, it includes a hardcoded\n\n\n**2**\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\nCommand and Control server, specified by IP address and port, that is immediately\ncontacted. This IP address belonged to LunaSat ISP. In 2015, it already came out that\nseveral other IP addresses belonging to the same Lebanese satellite Internet Service\nProvider have been leveraged by Turla.\n\nThe third set of samples is the most interesting one, as a matter of fact it has not been\n\n**3**\n\npublicly disclosed yet: we named it “Penquin_x64”. Two samples belonging to this set\nhave been submitted to VirusTotal service in April 2020 from the Czech Republic and\nItaly respectively. We have reason to believe that the sample submitted from Italy is\nrelated to an incident investigation that could reveal more details about Turla TTPs. We\nare not aware of the identity of who submitted it, even though we are based in the same\nCountry. The two samples submitted in 2020 let us discover a third one that has been\nsubmitted to the Virus Total service in December 2017.\n\nAll “Penquin_x64” samples are compiled to work on 64 bits architectures and they embed a\nlegitimate linux binary trying to mimic: “cron”. Furthermore, they implement the same sort of\nport knocking technique[2] of the first “Penquin” version, using a different filter to activate the\nbackdoor. In Table 1, we provide a comparison of the main features of the three sets of\nsamples we analysed, for the STIX 2.1 standard. More details about commonalities and\ndifferences of the three malware versions will be reported in Section 3.\n\n**Features** **Malware Versions** **Description**\n\n**Name** Penquin Penquin_2.0 Penquin_x64\n\n**Estimated Date**   -   - After mid-2016 The date of build that we estimate\n**of build**\n\n**First Seen ITW** November December December Date that the malware instance or family was\n2014 2014 2017 first seen.\n\n**Architecture** x86 x86 x86-64 The processor architectures that the malware\n**execution envs** instance or family is executable on.\n\n**Implementation** c c c The programming language(s) used to\n**languages** implement the malware instance or family.\n\n**Capabilities** controls-local- controls-local- controls-local- Specifies any capabilities identified for the\nmachine machine, machine malware instance or family.\n\ncommunicateswith-c2\n\n2\nSince it does not open a local port but it connects back to a C2 specified in the incoming packet, formally it\nshould not be considered an actual port knocking. However, the way it is used recalls it.\n\n|Features|Malware Versions|Col3|Col4|Description|\n|---|---|---|---|---|\n|Name|Penquin|Penquin_2.0|Penquin_x64||\n|Estimated Date of build|-|-|After mid-2016|The date of build that we estimate|\n|First Seen ITW|November 2014|December 2014|December 2017|Date that the malware instance or family was first seen.|\n|Architecture execution envs|x86|x86|x86-64|The processor architectures that the malware instance or family is executable on.|\n|Implementation languages|c|c|c|The programming language(s) used to implement the malware instance or family.|\n|Capabilities|controls-local- machine|controls-local- machine, communicates- with-c2|controls-local- machine|Specifies any capabilities identified for the malware instance or family.|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n**Features** **Malware Versions** **Description**\n\n**Name** Penquin Penquin_2.0 Penquin_x64\n\n**Kill-chain** Installation, C2 Installation, C2 Installation, C2 The list of kill chain phases for which this\n**Phases** Malware instance can be used.\n\n**Malware Types** backdoor, backdoor, backdoor, The type of malware being described.\nremote- remote-access- remote-accessaccess-trojan trojan trojan\n\n**OS execution** linux linux linux The operating systems that the malware\n**envs** family or malware instance is executable on.\n\n**Malware** 1d5e4466a6c5 8856a68d95e4 8ccc081d4940 Specific malware samples belonging to the\n**Instances** 723cd30caf8b e79301779770 c5d8aa6b782c corresponding families\n\n1c3d33d1a3d4 a83e3fad8f122 16ed82528c08\n\n**(SHA256)** c94c25e2ebe1 b849a9e9e31cf 85bbb08210a8\n\n86c02b8b41da e06bf3418fa66 d0a8c519c542\nf905, 7, 15bc\n3e138e4e34c6 2dabb2c5c04d 67d9556c695ef\need3506efc7c a560a6b56dba 6c51abf6fbab1\n805fce19af13b a565d1eab818 7acb3466e314\nd62aeb35544f 9d1fa4a85557a 9cf4d20cb64d6\n81f111e83b5d 22157877065e d34dc969b650\n0d4 a08, 2\n\n5a204263cac1 d9f2467ff11efa\n12318cd162f1c e921ec83e074\n372437abf7f20 e4f8d2eac7881\n92902b05e943 d76bff60a872a\ne8784869629d 801bd45ce3d5\nd8,\nd49690ccb82ff\n9d42d3ee9d7d\na693fd7d30273\n4562de088e92\n98413d56b86e\nd0\n\n**C2 Domains** news- C2 hardcoded domains\nbbc.podzone[.]\norg\n\n**C2 IP and Ports** 82.146.175[.]43 C2 hardcoded IP addresses and ports\n:1773\n\n**Table 1 - Features of the three different “Penquin” versions discovered**\n\n|Features|Malware Versions|Col3|Col4|Description|\n|---|---|---|---|---|\n|Name|Penquin|Penquin_2.0|Penquin_x64||\n|Kill-chain Phases|Installation, C2|Installation, C2|Installation, C2|The list of kill chain phases for which this Malware instance can be used.|\n|Malware Types|backdoor, remote- access-trojan|backdoor, remote-access- trojan|backdoor, remote-access- trojan|The type of malware being described.|\n|OS execution envs|linux|linux|linux|The operating systems that the malware family or malware instance is executable on.|\n|Malware Instances (SHA256)|1d5e4466a6c5 723cd30caf8b 1c3d33d1a3d4 c94c25e2ebe1 86c02b8b41da f905, 3e138e4e34c6 eed3506efc7c 805fce19af13b d62aeb35544f 81f111e83b5d 0d4|8856a68d95e4 e79301779770 a83e3fad8f122 b849a9e9e31cf e06bf3418fa66 7, 2dabb2c5c04d a560a6b56dba a565d1eab818 9d1fa4a85557a 22157877065e a08, 5a204263cac1 12318cd162f1c 372437abf7f20 92902b05e943 e8784869629d d8, d49690ccb82ff 9d42d3ee9d7d a693fd7d30273 4562de088e92 98413d56b86e d0|8ccc081d4940 c5d8aa6b782c 16ed82528c08 85bbb08210a8 d0a8c519c542 15bc 67d9556c695ef 6c51abf6fbab1 7acb3466e314 9cf4d20cb64d6 d34dc969b650 2 d9f2467ff11efa e921ec83e074 e4f8d2eac7881 d76bff60a872a 801bd45ce3d5|Specific malware samples belonging to the corresponding families|\n|C2 Domains|news- bbc.podzone[.] org|||C2 hardcoded domains|\n|C2 IP and Ports||82.146.175[.]43 :1773||C2 hardcoded IP addresses and ports|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### 3. BUILD DATE ESTIMATION\n\nSince the first confirmed reporting of Turla “Penquin” dates back to the end of 2014, we\nconsidered extremely important for the current analysis to estimate the build date of the new\nsamples we found to be extremely important to our analysis. Indeed, when we started this\nanalysis, one of the first hypotheses we considered was that the new samples we detected\ncould have been built before the publication of the first Kaspersky’s report in 2014.\n\nIn comparison to the Windows Portable Executable which has a compile timestamp field, the\nELF file format does not provide any corresponding field that can be used for such a purpose.\nTherefore, we considered several different approaches, which are fully described in Appendix\nA, such as analyzing the EI_ABIVERSION, or the epoch of the statically linked libraries. As for\nthe “Penquin_x64” set, the approach that in our opinion turned out to be the most reliable is\nbased on the analysis of the embedded cron binaries, which is detailed in the following\nsubsection.\n\n##### 3.1 Estimated date of the embedded binaries\n\nAnalyzing the “Penquin_x64” malware set, we found that these samples embed and execute\nthe cron binary, used in linux OS to create pre-scheduled and periodic background jobs.\nIndeed, samples belonging to this set try to mimic cron in order to hide themselves from the\neyes of the user or system administrator, and they need the actual version of the binary to run\nit after their execution. To support this hypothesis, we immediately verified that the cron binary\neach malware embeds was not trojanized, and that it was launched by the malware as a child\nprocess. After extracting the embedded cron from the samples, we also noticed that each\nsample embeds a different version of the binary.\n\nTherefore, we analysed the ABI field of the cron binaries we recovered, and we found the\nindicative time windows they have been built. It was discovered that they included three\ndifferent versions of cron, that have been built in three different time windows, but still the\ninformation that we have got was too inexact. Table 2 reports the outcome of this first analysis.\n\n**Cron hashes** **ABI** **GCC** **Year**\n\n3309e8f29e53d56d177ab2ad4b814cd3d8215944a0bbe233e498766 2.6.32 >= 4.9.1 >=2014\n1d1db5afd < 7.2.0 <2017\n\ndc17065fac8ce24aa6c344a45f12a0d0e3e4928d23b8aa6edad769b2 2.6.18 - 4.4.4 >2010\n4f4c7a39 < 4.8.2 <2013\n\n3609f24f314d2b95f9d607be8205ed8722b1457897d1eb222d950e38f 2.6.24 >= 4.8.2 >=2013\n84aa728 < 4.9.1 <2014\n\n**Table 2 -** Cron build date estimation based on the ABI field of the ELF\n\n|Cron hashes|ABI|GCC|Year|\n|---|---|---|---|\n|3309e8f29e53d56d177ab2ad4b814cd3d8215944a0bbe233e498766 1d1db5afd|2.6.32|>= 4.9.1 < 7.2.0|>=2014 <2017|\n|dc17065fac8ce24aa6c344a45f12a0d0e3e4928d23b8aa6edad769b2 4f4c7a39|2.6.18|> 4.4.4 < 4.8.2|>2010 <2013|\n|3609f24f314d2b95f9d607be8205ed8722b1457897d1eb222d950e38f 84aa728|2.6.24|>= 4.8.2 < 4.9.1|>=2013 <2014|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\nIn addition to the analysis of the ABI field of the cron instances, we also tried a different\napproach that is based on the following simple hypothesis: if these binaries have not been recompiled by the attacker, then it is probable they have been taken from a Linux distribution.\nTherefore, we downloaded the cron binary packages of several distributions, and we found\nwith a simple sha256 comparison that those we were interested in have been released in\nUbuntu and CentOS.\n\nFurthermore, one of the three cron binaries has been released with Ubuntu 16.04 and 17.04,\nin April 2016 and April 2017 respectively. Therefore, it is with high confidence that we can\nstate that “Penquin_x64” was still being developed during those years, and that the last\nversion we currently know about was compiled after April 2016. Table 3 summarises the\nresults of the build date estimation based on this analysis.\n\n**Cron SHA256** **Penquin_x64 SHA256** **Possible Linux** **First known**\n**embedding the cron** **Distributions** **release date**\n\n3309e8f29e53d56d177ab2ad4b814c d9f2467ff11efae921ec83e074e4f8 >= Ubuntu 1604 April 2016 - April\nd3d8215944a0bbe233e4987661d1d d2eac7881d76bff60a872a801bd4 <= Ubuntu 1704 2017\nb5afd 5ce3d5\n\ndc17065fac8ce24aa6c344a45f12a0d 67d9556c695ef6c51abf6fbab17ac Centos 6.7 Sep 2015- July\n0e3e4928d23b8aa6edad769b24f4c7 b3466e3149cf4d20cb64d6d34dc9 Centos 6.8 2016\na39 69b6502\n\n3609f24f314d2b95f9d607be8205ed8 8ccc081d4940c5d8aa6b782c16ed Ubuntu 13.10 October 2013 722b1457897d1eb222d950e38f84aa 82528c0885bbb08210a8d0a8c51 Ubuntu 14.04 April 2014\n728 9c54215bc\n\n**Table 3 - Release date of the Linux distributions that include the cron binaries found in**\n\n“Penquin_x64”\n\nIt can be observed that the results reported in Table 3 do not intersect perfectly those reported\nin Table 2, but from our analysis we believe this is the most reliable finding to give a lower\nbound to the build date of each sample belonging to the “Penquin_x64” set (Figure 5).\n\n|Cron SHA256|Penquin_x64 SHA256 embedding the cron|Possible Linux Distributions|First known release date|\n|---|---|---|---|\n|3309e8f29e53d56d177ab2ad4b814c d3d8215944a0bbe233e4987661d1d b5afd|d9f2467ff11efae921ec83e074e4f8 d2eac7881d76bff60a872a801bd4 5ce3d5|>= Ubuntu 1604 <= Ubuntu 1704|April 2016 - April 2017|\n|dc17065fac8ce24aa6c344a45f12a0d 0e3e4928d23b8aa6edad769b24f4c7 a39|67d9556c695ef6c51abf6fbab17ac b3466e3149cf4d20cb64d6d34dc9 69b6502|Centos 6.7 Centos 6.8|Sep 2015- July 2016|\n|3609f24f314d2b95f9d607be8205ed8 722b1457897d1eb222d950e38f84aa 728|8ccc081d4940c5d8aa6b782c16ed 82528c0885bbb08210a8d0a8c51 9c54215bc|Ubuntu 13.10 Ubuntu 14.04|October 2013 - April 2014|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n**Figure 5 - Build date lower bound estimation for “Penquin_x64” samples, based on the first**\n\nknown date of release of the embedded cron.\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### 4. MALWARE CAPABILITIES\n\nIn order to understand all the differences among the three Turla “Penquin” versions we have\nidentified, we conducted deep analysis of all the available samples, including those already\nreported in 2014 and 2017. A very important piece of code, that was not previously described\nin any analysis we know about, is used by the three malware sets:\n\nresult = trybuiltin(a2, v9, v10);\nif ( !result ):\nresult = runcmd((int)v4, v9, (int)v10, a4);\n\nThe runcmd function is the one described by Kaspersky: “[the malware] reports its own PID and\nIP to the remote address, and starts an endless loop for receiving remote commands. When a\ncommand arrives, it is executed with a ‘/bin/sh -c’ script” [1]. However, the code snippet above\nhighlights that before calling the runcmd function (that uses the /bin/sh technique previously\ndescribed), it checks the result of another function, called trybuiltin in one of the rare samples\nthat didn’t have the symbols stripped.\n\nThe trybuiltin function checks the received parameters against a hardcoded data structure,\nnamed cmdtab, and calls the corresponding command implemented in the malware, without\nresorting to the command line. These commands are specified through command codes that\nare mapped to a list of functions (the full list with a detailed description is reported in the\nSection 3.3), that include: a do_upload function to send back to the C2 a file, a do_download\nfunction to download a remote file from the C2, and a do_exec function to download and\nexecute a file. These commands add to the known stealth backdoor capabilities of this\nmalware also the capabilities of a remote access trojan.\n\nAdditional implemented commands are: do_vsupload, do_vsdownlod, do_vslist, do_vsdelete,\ndo_vsshutdown and do_vstat. All the commands preceded by the string do_vs have something\nvery important in common: they can be executed on a remote IP address and port that is\nreceived as input parameter, that is potentially, and highly probably, different from the C2.\nThese commands will therefore establish a new encrypted connection with a third peer that is\nspecified by the attacker. The very detailed Ruag report published in 2016 already mentioned\nthis capability of “Penquin”, but it didn’t give too many details. In particular, the report by the\nGovCERT.ch says:\n\nIt [the malware] even contains a feature to access a linear filesystem at a third IP\naddress (like a file repository), but we never found the corresponding server\nimplementation [3].\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\nAs for the do_vsdelete and the do_vsshutdown functions, they are used to send two commands\nto the remote peer. The binary code available in the malware does not allow to confirm what\nshould be the result on the remote peer, but their names suggest that they will respectively\ndelete and shutdown something. It is highly possible that the do_vsdelete deletes a file on the\nremote peer, and that the do_vsshutdown executes the shutdown of the machine or kills the\nmalware process. The do_vslist function lists the files of the peer and sends back to the C2 a\nlist with the following information: Description, File Name, Size and Status. We presume at this\ntime, that the presence of fields such as Status and Description may be related to some peer\nto peer file system functionalities.\n\n##### 4.1  “Penquins” differences and commonalities\n\nThe three malware sets have the same code base. As a matter of fact, they share a lot of\nbinary code. For example, one of the features that remained unchanged among all the three\nmalware sets is related to the encryption algorithm used to obfuscate the strings included in\nthe binary. This kind of technique is also peculiar of other tools used by Turla:\n\nindex = 0;\ndo{\n_decrypted__buffer[index] = _xored__buffer[index] ^ (index + 0x5);\n++index;\n}\nwhile ( index <= _xored__buffer_size);\n\nAnother commonality of the three sets is related to the encryption algorithm used to\ncommunicate through the network. Indeed, all the communications are encrypted with the\nBlowFish algorithm, and a symmetric key exchanged with Diffie Hellman. Furthermore, the\nvalues that are used for the initialisation vector are always the same.\n\nint __cdecl bf_crypt(int len, int a2, int key, int a4)\n{\nint iv; // eax\nint num = 0; // [esp+20h] [ebp-8h]\n\nif ( a4 )\niv = key + 0x386C;\nelse\niv = key + 0x3864;\nBF_ofb64_encrypt((_BYTE *)a2, (_BYTE *)a2, len, key + 10268, iv, &num);\nreturn len;\n}\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\nCommonalities are more noticeable when considering the set of commands they can receive\nfrom the network, and the corresponding binary code to handle and execute them. “Penquin”\nand “Penquin_2.0” share exactly the same set of commands, together with the main function\nthat handles all of them. These commands are organised in a data structure that the malware\nauthors called cmdtab, previously mentioned, which will be fully described in Section 3.2.\nThese two malware versions, after the initialisation phase, basically share the same code to\nprocess the received commands:\n\nwhile ( !feof(v10) )\n{\nmemset(&v20, 0, 10240);\nreceiveData(srvfd, &v20, 10240, (int)&CStruct);\ncommand(&v20, (int)&cmdtab, 1, srvfd);\nfflush((int)v10);\nsendEndOfData(srvfd, (int)&CStruct);\n}\n\nOnly a small part of code is slightly different, that is mainly related to the way “Penquin_2.0”\nrecovers the hardcoded IP address and port of the C2 it has to connect to. As a matter of fact,\n“Penquin_2.0” is the only one that has the C2 IP address and port hardcoded in itself at the\nend of the file.\n\nAs for the stealth backdoor capabilities, “Penquin_x64” and “Penquin” use the same technique\nto interact with the attacker: they leverage the _libpcap library to sniff the network traffic,_\napplying a filter to match a ‘magic’ packet. The filters they use are slightly different (they are\nreported in detail in Section 3.3). On the contrary, “Penquin_2.0” malware set does not use the\n_libpcap library to sniff the network traffic and it does not require root privileges to run. The IP_\naddress of the C2 is hardcoded at the very end of each sample. However, the only IP address\nand port we have been able to recover is equal to 82.146.175[.]43:1773. This IP address\nbelonged to LunaSat ISP, a Lebanese satellite Internet Service Provider that has been used\nby Turla also in other cases [4]. We think that other samples belonging to this set have been\npadded or resubmitted with the last portion of the binary modified, producing therefore\nadditional IP addresses that may not be really used by the attacker. For this reason, we do not\nreport them as indicators of compromise.\n\n“Penquin_x64” is the only one that embeds the cron binary. With respect to the other samples,\nseveral strings have been encrypted or removed, probably to avoid detection. Furthermore,\nsome portions of code have been removed. “Penquin_x64” uses the do_start method as the\nmain function. This function was present in the other versions already, available in cmdtab\nstructure, but it has been slightly modified. Indeed, in “Penquin” and “Penquin_2.0”, it was\nused to download an executable from the network, to save it to /tmp/.xdfg, and to execute and\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\ndelete it after the execution. “Penquin_x64” uses a different way to parse the incoming\ncommands, and the do_start function seems to be related to this new feature. In particular, the\ncmdtab data structure containing the codes of the commands to execute and the corresponding\nfunctions to call is not present anymore, even though the implementation of the functions is\nstill there. Therefore, the do_start function downloads a file (not an executable anymore) from\nthe network, and it saves it to /root/.session.\n\nThe sample expects that the .session file must be encoded with the linux utility named uuencode,\ngenerally used to transmit binary files over transmission mediums that do not support other\nthan simple ASCII data. The resulting encoding will include both the binary file and its\nmetadata, such as the original filename and the permissions. “Penquin_x64” embeds the\nimplementation of the counterpart of uuencode, that is the uudecode utility, that is then used to\ndecode the file, leveraging the included metadata. Since the binary code of “Penquin_x64”\nexpects to execute a file named /root/.hsperfdata just after the decoding, we guess that this is the\noriginal name of the file that is received from the network, encoded in /root/.session. The file\n\n/root/.hsperfdata is then executed through the command ‘/bin/sh -c’, capturing the standard\noutput that is then redirected to a file.\n\n##### 4.2 Commands description\n\nTable 4 reports the full list of commands that are built-in in to the malware code of the three\nmalware versions. This information is directly derived from the cmdtab data structure that is\npresent in “Penquin” and “Penquin_2.0”. Indeed, this data structure contains the command\ncode, the corresponding function to execute when such a command code is received, the\nminimum and the maximum number of input parameters allowed. As for “Penquin_x64”, the\ncmdtab data structure has been removed, but all the implemented functions are still present.\n\n|Function name|Command code|Description|Num of input params|\n|---|---|---|---|\n|do_exit|quit|It makes the malware exit returning 0. It doesn’t return any feedback to the C2.|0|\n|do_setenv|setenv|It adds a new environment variable or modifies it if it does not exist. It does not return any feedback to the C2.|2|\n|do_cd|0x80D13E9|It re-implements the ‘cd’ command logic. HOME value is set to /tmp during the malware init code.|0 or 1|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n|Function name|Command code|Description|Num of input params|\n|---|---|---|---|\n|do_download|___123!@#|It opens a local file in write mode. Its path is passed by the C2 as an input parameter. If there are no errors, it sends back to the C2 the message \"__we_are_happy__\", and receives the content of the file to write on the disk.|1 or 2|\n|do_upload|___456$$$|It opens a local file in read mode. If there are no errors, it sends back to the C2 the message “__we_are_happy__”, followed by the file content.|1 or 2|\n|do_start|___789&*(|It downloads an executable in /tmp/.xdfg. It changes its permissions by adding the executable flag, and then it starts it by using a fork and the arguments passed as input parameters. Finally, the executable is deleted from the file system. [This function has been modified in “Penquin_x64”]|1 to 24|\n|do_exec|___243)!#|It downloads an executable in /tmp/.xdfg (“Penquin” and “Penquin_2.0”) or in /tmp/.sync.pid (Penquin_x64). It changes its permissions by adding the executable flag, and then it runs it by using a fork the arguments passed as input parameters. Finally, the executable is deleted from the file system.|0 to 24|\n|do_vslist|___4396#?|It establishes a new encrypted connection to an IP and port passed as argument from the network, and it sends to this peer the message “0x10”. Note that IP and port of the peer can be different from the C2 that sent the input command. Successively, it sends back to the C2 files information received from the remote peer that are organized with the following fields: Description, FileName, Size, and Status. Finally, it sends back to the C2 the message “Done!\\n”. The status can have one of the following values: “Ok”, “Size mismatch”,\"Unknown err\",\"Remote VS is empty !\\n\".|2|\n|do_vsupload|___43()*#|It establishes a new encrypted connection to an IP and port passed as argument from the network, and it sends to this peer the message “0x11”. Successively, it reads a local file that is then sent to the peer through the established SSL channel, encrypted with the BlowFish algorithm. It checks different error cases and when the command execution ends, it sends back to the C2 the message “Done!\\n”.|3 to 4|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n**_Function name_** **_Command_** **_Description_** **_Num of_**\n**_code_** **_input_**\n\n**_params_**\n\ndo_vsdownlod ___526((@ It establishes a new encrypted connection to an IP and 3 to 4\nport passed as argument from the network, and it\nsends to this peer the message “0x12”. Successively, it\ndownloads a remote file in chunks (1024 bytes each) to\na local file, which path is passed as argument. If the\nnumber of downloaded bytes is zero, the local file is\nremoved. Finally, it sends back to the C2 the message\n“Done!\\n” once the operation is completed.\n\ndo_vsdelete ___*32)(2 It establishes a new encrypted connection to an IP and 3\nport passed as argument from the network, and it\nsends to this peer the message “0x13”, followed by\nanother argument. At the end, it sends back to the C2\nthe message “Done!\\n”.\nWe speculate that one of the arguments is the remote\npath of the file to delete.\n\ndo_vsshutdown ___(@#*$5 It establishes a new encrypted connection to a remote 2\npeer (IP and port passed as arguments), and it sends\nto it the message “0x14”. Successively, it sends the\nmessage “Done!\\n” to the C2.\n\ndo_vsstat ___@&#872 It establishes a new encrypted connection to a remote 2\npeer (IP and port passed as arguments), and it sends\nto it the message “0x15”. It receives data from the peer\nand successively, it sends back to the C2 the peer file\nsystem type and information about its available disk\nspace.\n\n**Table 4 - List of commands that can be executed**\n\n##### 4.3 Magic packets for remote command execution\n\nOnce “Penquin_x64” completes the startup sequence, it is not ready to receive commands\nfrom the attacker yet. It does not start a reverse shell, nor does it try to listen for incoming\nconnections on any local port of the infected host. It passively starts sniffing the incoming data\non _eth0 interface, searching for the right packet that matches all the required conditions. The_\nthreat actor that is behind this tool, has taken considerable effort (and a lot of math) in such a\nsmall piece of code in order to make sure that only properly crafted packets can trigger an\naction on the running sample. This is also due to the fact that, encoded in the activation\npacket, lies the IP address that the sample will try to contact to if all the conditions are\nmatched. In this section we will describe such conditions and explain how to build the _magic_\npacket to make the Penquin happy (cit.).\n\n|Function name|Command code|Description|Num of input params|\n|---|---|---|---|\n|do_vsdownlod|___526((@|It establishes a new encrypted connection to an IP and port passed as argument from the network, and it sends to this peer the message “0x12”. Successively, it downloads a remote file in chunks (1024 bytes each) to a local file, which path is passed as argument. If the number of downloaded bytes is zero, the local file is removed. Finally, it sends back to the C2 the message “Done!\\n” once the operation is completed.|3 to 4|\n|do_vsdelete|___*32)(2|It establishes a new encrypted connection to an IP and port passed as argument from the network, and it sends to this peer the message “0x13”, followed by another argument. At the end, it sends back to the C2 the message “Done!\\n”. We speculate that one of the arguments is the remote path of the file to delete.|3|\n|do_vsshutdown|___(@#*$5|It establishes a new encrypted connection to a remote peer (IP and port passed as arguments), and it sends to it the message “0x14”. Successively, it sends the message “Done!\\n” to the C2.|2|\n|do_vsstat|___@&#872|It establishes a new encrypted connection to a remote peer (IP and port passed as arguments), and it sends to it the message “0x15”. It receives data from the peer and successively, it sends back to the C2 the peer file system type and information about its available disk space.|2|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\nThe first condition, that we call **pcap_condition, is the simplest one (it has also been described**\nin previous analysis [1]): it consists of a pcap filter which is implemented through the _libpcap_\nlibrary that is statically linked in the binary. However, the filter applied by the stealth backdoor\ncapability of “Penquin” and “Penquin_x64” is slightly different as reported below:\n\n**“Penquin” magic packet filter**\n\n(tcp[8:4] & 0xe007ffff = 0xe003bebe) or (udp[12:4] & 0xe007ffff = 0xe003bebe)\n(tcp[8:4] & 0xe007ffff = 0x1bebe) or (udp[12:4] & 0xe007ffff = 0x1bebe)\n\n**“Penquin_x64” magic packet filter**\n\n(tcp[8:4] & 0xe007ffff = 0x6005bdbd) or (udp[12:4] & 0xe007ffff = 0x6005bdbd)\n\nIt can be noticed that in both cases the malware checks for a specific four bytes value of the\nincoming packet. TCP or, alternatively, UDP packets are considered by the filters. However,\nsince both constraints and actions taken by the sample are the same in either case, for the\nsake of simplicity, in the rest of this analysis we will focus on UDP packets only.\n\nEven though the bitmask remained the same for all versions (0xe007ffff), the result value has\nchanged between different releases (0xe003bebe or 0x1bebe became 0x6005bdbd). As will be detailed\nbelow, some bits of that DWORD are used to generate the final IP address that the sample will\ntry to connect to. In particular, this value influences four bits of the two most significant bytes of\nthe C2 IP address. We have no evidence of the motivation that led the threat actor to change\nsuch bits.\n\nHowever, the pcap_condition is only the tip of the iceberg since the constraints also involve\nthe first 8 bytes of the packet (namely the **first dword** and the **second dword) together with the**\nsource port used to send the packet. It is worth noting that this part of “Penquin_x64” didn’t\nchange too much from the first version. A comparison between the control flow graph of\n“Penquin” and “Penquin_x64” is reported in Figure 6.\n\nIn the first part of the control flow graph, highlighted in Figure 6, both versions filter out\nprotocols different from TCP or UDP. The central portion seems to be different, but a closer\nlook shows that they are very similar since the 32 bits version uses a call to an external\nfunction, while the 64 bits version uses the inlining of the same function. The bottom part is\nagain very similar, and it is related to the payload and source port constraints.\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\nTransport protocol\n\nconstraints\n\nPayload and source\n\nport constraints\n\n**Figure 6 –** Comparison of the control flow graph of “Penquin” and “Penquin_x64” related to\n\nthe magic packet that activates the backdoor\n(1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905 vs\n\n67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502).\n\nThe commented C code that we generated during the analysis is reported in the following\ncode snippet. This piece of code replicates the behaviour of Penquin when it receives a packet\nthat passes the pcap_condition. In particular, it is used by the malware to retrieve the IP\naddress it has to connect back to. Note that in case the packet does not satisfy the\nmathematical constraints reported in this code snippet, then the sample will not open back any\nconnection.\n\n\nTransport protocol\n\nconstraints\n\nPayload and source\n\nport constraints\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\nAt first sight, it is not the easiest piece of C code you can find. The relation between the final IP\naddress and the input values depends on several bitwise operations that must be fully\nunderstood in order to make further considerations.\n```\nUINT64 get_final_ip(UINT32 first_dword, UINT32 second_dword, UINT16 src_port)\n{\n  UINT16 src_port_ror;\n  BYTE final_check_1; \n  BYTE final_check_2;\n  UINT32 final_check_3;\n  UINT32 final_check_5;\n  UINT32 ip_final; \n  UINT64 result;\n  src_port_ror = __ROR2__(src_port, 8);\n  /* Calculates conditions from input data */\n  final_check_1 = ((__ROR2__(second_dword, 8) & 0xE000) >> 10) | __ROR2__(second_dword, 8) & 7;\n  final_check_2 = (__ROR2__(second_dword, 8) & 0x18) >> 3;\n  final_check_3 = ((first_dword & 0x200) << 6) | 2 * (first_dword & 0x1C0) | src_port_ror & 0x7C7F;\n  final_check_5 = (first_dword & 0x3C00000u) >> 22;\n  ip_final = ((src_port_ror & 0x8000) >> 6) | ((src_port_ror & 0x380) >> 1) |\n((__ROR2__(second_dword, 8) & 0x1E0) << 17) | first_dword & 0xFC3FFC3F;\n  /* Verify the conditions on the input data */\n  if (\n    ((unsigned __int8)final_check_5 | (unsigned __int8)((__ROR2__(second_dword, 8) & 0x1E00) >>\n5)) \n     !=\n    ((unsigned __int8)(HIBYTE(ip_final) ^ BYTE1(ip_final) ^ BYTE1(final_check_3)) ^ \n      (unsigned __int8)(BYTE2(ip_final) ^ ip_final ^ final_check_3 ^ \n      (final_check_1 | (final_check_2 << 6))))\n    )\n    result = 0;\n  else\n    result = ip_final;\n  return result;\n}\n\n```\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n**Figure 7 - Representation of the checks made by “Penquin” in order to retrieve the command**\n\nand control IP address from a sniffed incoming activation packet.\n\nA different representation of the commented C code is reported in Figure 7 where the relation\nbetween the input packets and the final destination IP address, as well as the conditions\nrequired by Penquin, are summarised. Every field is represented with a bit-level granularity\nsince most of the operations are performed bitwise and do not align to the byte boundaries. On\ntop, there is the input data (that consists of two DWORDS and the source port) and the final IP\naddress. The first DWORD is not considered by the pcap_condition so it can be set to an\narbitrary value. The second DWORD should appear familiar since it corresponds to the value\nspecified in the pcap filter (for example, 0xbdbd0560 for “Penquin_x64” samples). This DWORD is\nsubject to the constraints of the pcap_condition. In the figure, the values of “Penquin_x64” are\nreported; the bits marked with an ‘x’ can be chosen as desired, as long as they match the\nconditions represented in the bottom section of the figure.\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n**Figure 8 - Portion of code of “Penquin_x64” executed when a valid incoming activation packet**\n\nis received\n\nAnother interesting portion of the code of “Penquin_x64” is reported in Figure 8. These\ninstructions are executed when the conditions we discussed are matched. However, it is\nimportant to note that **final_check_1** must be equal to `1Dh` in order to be accepted by this\nsample. Such value was specified as a command line parameter in “Penquin” version and it\nwas hardcoded in “Penquin_x64”.\n\nFigure 8 also reports an important detail about **final_check_2. This value is used as a status**\nflag. Whenever the execution reaches the final basic block, the sample changes its internal\nstatus according to the value of **final_check_2** and stores it into the register **r15d. This value**\ndepends on the values marked with ‘x’ of the second DWORD of the packet. This means that\na correctly formatted activation packet is accepted only if the state of the stored final_check_2\nvalue is different from the one generated from the incoming packet. However **final_check_2**\nseems to have only two possible values that are 0 or 2. Since the status is zero-initialized, the\nfirst packet to activate Penquin must have **final_check_2** equal to 2.\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### 4.4 Is the Penquin in the house? \n\nWith the knowledge and understanding of the portion of binary code related to the magic\npacket, we have been able to forge packets that are compliant with all the conditions of the\nPenquin protocol. The python code reported below triggers the sample to connect back to an\nIP address that is encoded inside the payload. It can be used by blue teams to check if their\nLinux servers are infected by this version of “Penquin_x64”.\n```\n  import socket\n  tc_remote_port = 0x9999\n  outgoing_if = \"192.168.202.1\" # local IP\n  remote_tc_host = \"192.168.202.130\" # potentially infected machine IP\n  #send UDP packet with final_check2 equal to 2 and callback IP address equal to 10.11.60.129 \n  tc_local_port = 65105\n  tc_sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\n  tc_sock.bind((outgoing_if, tc_local_port))\n  tc_sock.sendto(b\"\\x4a\\x0a\\x3c\\x83\\x60\\x95\\xbd\\xbd\", (remote_tc_host,tc_remote_port))\n  #send UDP packet with final_check2 equal to 0 and callback IP address equal to 10.188.60.129\n  tc_local_port = 30846\n  tc_sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\n  tc_sock.bind((outgoing_if, tc_local_port))\n  tc_sock.sendto(b\"\\x0a\\xbc\\x3c\\x80\\x62\\x85\\xbd\\xbd\", (remote_tc_host,tc_remote_port))\n\n```\nThe variables that can be freely configured are: `tc_remote_port,` `outgoing_if` and\n\n`remote_tc_host.` Since we are unable to establish the value of the status flag in advance,\ntwo packets are sent in order to trigger the connection to one of the two private IP addresses\n10.11.60.129 or 10.188.60.129, that should be used by the system administrators to monitor\nthe call back home traffic of “Penquin_x64”.\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### 5. CONCLUSION\n\nThis report is based on the outcome of a deep technical analysis of a set of malware samples\nthat have been uploaded to a multi-scanner service in the last few years. Since we didn’t have\nthe chance to investigate an actual incident involving them, or to analyse a single\ncompromised machine, we have not been able to collect and analyse additional context\ninformation that could add important information about the victimology, the TTPs of the threat\nactor and the timeline of the events.\n\nThe analysis we performed proved that Turla continued to develop new versions of\n“Penquin_x64” at least up to April 2016. Furthermore, it revealed the enormous effort put in\nplace by the threat actor to avoid the activation of the backdoor not controlled by themselves.\nNevertheless, we have been able to completely understand the network protocol that is used,\nand to build a tool that is able to activate the backdoor and call back an IP address that we can\ncontrol. This tool can be used by system administrators for defensive purposes.\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### 6. MITRE ATT&CK TTPs\n\n|T1059|Command-Line Interface|Command-line interfaces provide a way of interacting with computer systems and is a common feature across many types of operating system platforms. One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software. Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc. Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g. Scheduled Task).|\n|---|---|---|\n|T1205|Port Knocking|Port Knocking is a well-established method used by both defenders and adversaries to hide open ports from access. To enable a port, an adversary sends a series of packets with certain characteristics before the port will be opened. Usually this series of packets consists of attempted connections to a predefined sequence of closed ports, but can involve unusual flags, specific strings or other unique characteristics. After the sequence is completed, opening a port is often accomplished by the host based firewall, but could also be implemented by custom software.|\n|T1105|Remote File Copy|Files may be copied from one system to another to stage adversary tools or other files over the course of an operation. Files may be copied from an external adversary-controlled system through the Command and Control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.|\n|T1094|Custom Command and Control Protocol|Adversaries may communicate using a custom command and control protocol instead of encapsulating commands/data in an existing Standard Application Layer Protocol. Implementations include mimicking well-known protocols or developing custom protocols (including raw sockets) on top of fundamental protocols provided by TCP/IP/another standard network stack.|\n|T1024|Custom Cryptographic Protocol|Adversaries may use a custom cryptographic protocol or algorithm to hide command and control traffic. A simple scheme, such as XOR-ing the plaintext with a fixed key, will produce a very weak ciphertext.|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n|T1032|Standard Cryptographic Protocol|Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.|\n|---|---|---|\n|T1158|Hidden Files and Directories|To prevent normal users from accidentally changing special files on a system, most operating systems have the concept of a ‘hidden’ file. These files don’t show up when a user browses the file system with a GUI or when using normal commands on the command line. Users must explicitly ask to show the hidden files either via a series of Graphical User Interface (GUI) prompts or with command line switches (dir /a for Windows and ls –a for Linux and macOS).|\n|T1222|File and Directory Permissions Modification|File and directory permissions are commonly managed by discretionary access control lists (DACLs) specified by the file or directory owner. File and directory DACL implementations may vary by platform, but generally explicitly designate which users/groups can perform which actions (ex: read, write, execute, etc.).|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### 7. INDICATORS OF COMPROMISE\n\n Hashes\n\n1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905\n8dc3d053e5008ab92a17dc47fed43213a9873db0\n0994d9deb50352e76b0322f48ee576c6\n\n3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4\n04686b0d2fdafa7cb6c17adc551abade334d7b85\n14ecd5e6fc8e501037b54ca263896a11\n\n8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667\n7f043eb95d74d051ac780aee52ebf1c497c43060\n19fbd8cbfb12482e8020a887d6427315\n\n2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08\n4594453e2e4002101481dc44f203d3ffebe079ae\nedf900cebb70c6d1fcab0234062bfc28\n\n5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8\n09580f1deb096bb50d082bd169271d41756adf73\nea06b213d5924de65407e8931b1e4326\n\nd49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0\n9d133d7e0616573a7d1c822cc878149e7aa7bad6\ne079ec947d3d4dacb21e993b760a65dc\n\n8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc\n0675329cfa4d13ee35f74c1cc236bc630b7de464\nad6731c123c4806f91e1327f35194722\n\n67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502\nf5a1a9180913bbeb1641af48660fbb756325f91e\nb4587870ecf51e8ef67d98bb83bc4be7\n\nd9f2467ff11efae921ec83e074e4f8d2eac7881d76bff60a872a801bd45ce3d5\nc67abb20ae5100f12ce084279827632fdbcb222a\n7533ef5300263eec3a677b3f0636ae73\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### Yara Rules\n\nrule APT_MAL_LNX_Turla_Apr202004_1 {\nmeta:\ndescription = \"Detects Turla Linux malware x64 x32\"\ndate = \"2020-04-24\"\nhash1 = \"67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502\"\nhash2 = \"8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc\"\nhash3 = \"8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667\"\nhash4 = \"1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905\"\nhash5 = \"2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08\"\nhash6 = \"3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4\"\nhash7 = \"5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8\"\nhash8 = \"8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667\"\nhash9 = \"d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0\"\n\nstrings:\n$s1 = \"/root/.hsperfdata\" ascii fullword\n$s2 = \"Desc|   Filename   | size |state|\" ascii fullword\n$s3 = \"VS filesystem: %s\" ascii fullword\n$s4 = \"File already exist on remote filesystem !\" ascii fullword\n$s5 = \"/tmp/.sync.pid\" ascii fullword\n$s6 = \"rem_fd: ssl \" ascii fullword\n$s7 = \"TREX_PID=%u\" ascii fullword\n$s8 = \"/tmp/.xdfg\" ascii fullword\n$s9 = \"__we_are_happy__\" ascii fullword\n$s10 = \"/root/.sess\" ascii fullword\n$s11 = \"ZYSZLRTS^Z@@NM@@G_Y_FE\" ascii fullword\ncondition:\nuint16(0) == 0x457f and\nfilesize < 5000KB and\n4 of them\n}\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\nrule APT_MAL_LNX_Turla_Apr202004_1_opcode {\nmeta:\ndescription = \"Detects Turla Linux malware x64 x32\"\ndate = \"2020-04-24\"\nhash1 = \"67d9556c695ef6c51abf6fbab17acb3466e3149cf4d20cb64d6d34dc969b6502\"\nhash2 = \"8ccc081d4940c5d8aa6b782c16ed82528c0885bbb08210a8d0a8c519c54215bc\"\nhash3 = \"8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667\"\nhash4 = \"1d5e4466a6c5723cd30caf8b1c3d33d1a3d4c94c25e2ebe186c02b8b41daf905\"\nhash5 = \"2dabb2c5c04da560a6b56dbaa565d1eab8189d1fa4a85557a22157877065ea08\"\nhash6 = \"3e138e4e34c6eed3506efc7c805fce19af13bd62aeb35544f81f111e83b5d0d4\"\nhash7 = \"5a204263cac112318cd162f1c372437abf7f2092902b05e943e8784869629dd8\"\nhash8 = \"8856a68d95e4e79301779770a83e3fad8f122b849a9e9e31cfe06bf3418fa667\"\nhash9 = \"d49690ccb82ff9d42d3ee9d7da693fd7d302734562de088e9298413d56b86ed0\"\n\nstrings:\n$op0 = { 8D 41 05 32 06 48 FF C6 88 81 E0 80 69 00 } /* Xor string loop_p1 x32*/\n$op1 = { 48 FF C1 48 83 F9 49 75 E9 } /* Xor string loop_p2 x32*/\n$op2 = { C7 05 9B 7D 29 00 1D 00 00 00 C7 05 2D 7B 29 00 65 74 68 30 C6 05 2A 7B 29 00 00 E8 }\n/* Load eth0 interface*/\n$op3 = { BF FF FF FF FF E8 96 9D 0A 00 90 90 90 90 90 90 90 90 90 90 89 F0}\n/* Opcode exceptions*/\n$op4 = { 88 D3 80 C3 05 32 9A C1 D6 0C 08 88 9A 60 A1 0F 08 42 83 FA 08 76 E9  }\n/* Xor string loop x64*/\n$op5 = { 8B 8D 50 DF FF FF B8 09 00 00 00 89 44 24 04 89 0C 24 E8 DD E5 02 00 } /* Kill call x32 */\n$op6 = { 8D 5A 05 32 9A 60 26 0C 08 88 9A 20 F4 0E 08 42 83 FA 48 76 EB } /* Decrypt init str */\n$op7 = { 8D 4A 05 32 8A 25 26 0C 08 88 8A 20 F4 0E 08 42 83 FA 08 76 EB} /* Decrypt init str */\ncondition:\nuint16(0) == 0x457f and\nfilesize < 5000KB and\n2 of them\n}\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### REFERENCES\n\n[1] The ‘Penquin’ Turla: A Turla/Snake/Uroburos Malware for Linux; by Kurt\n\nBaumgartner, Costin Raiu. December 2014.\n\n[2] Penquin’s Moonlit Maze: The Dawn of Nation-State Digital Espionage; by Juan\n\nAndres Guerrero-Saade (GReAT), Costin Raiu (GReAT), Daniel Moore (King’s\nCollege London), Thomas Rid (King’s College London). April 2017.\n\n[3] APT Case RUAG; by GovCERT.ch: Technical Report about the Espionage Case\n\nat RUAG. May 2016.\n\n[4] Satellite Turla: APT Command and Control in the Sky. How the Turla operators\n\nhijack satellite Internet links, by Stefan Tanase. September 2015.\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n##### APPENDIX A: BUILD DATE ESTIMATION\n\nThe ELF file format does not contain an explicit compile timestamp field, and therefore we had\nto consider different approaches. Due to these limitations, we have been able to outline a\nrough timeline of events only, but we have no evidence that such dates have been\ntimestomped in some way or that some behaviour has been deliberately put in place by the\nthreat actor in order to hinder such kind of analysis.\n\n##### Statically linked libraries and compilers\n\nAll the samples we analysed statically include a few libraries, such as _libpcap,_ _openssl and_\n_glibc which have strings suggesting their version. Furthermore, even though debugging_\ninformation has been stripped off, the samples still embed GCC compiler versions into the\nsection named _.comment. Therefore, our first thought was to estimate the release date of_\nthese libraries and compilers in such a way to have a lower bound on the build date of the\nmalware. Unfortunately, as for “Penquin” and “Penquin_2.0”, most of the temporal references\ndate back to 2000-2004, as reported in Table 5. These dates may suggest that the samples\nbelonging to these two sets have been built almost ten years before the publication of the first\nreport on this threat. It is also likely that the threat actor included these old libraries for other\nreasons, such as to preserve compatibility.\n\nThe “Penquin_x64” set is far more recent. Indeed, these samples introduced the usage of\nOpenSSL 1.0.1j that has been released at the end of 2014, more specifically on October 15th,\n2014. Therefore, taking into account this information only, “Penquin_x64” must have a build\ndate that is post mid-October 2014. At this point, we almost lost the hope that “Penquin_x64”\ncould be more recent than 2014, but we wanted to look at it closer. Therefore, we tried harder\n(and did more).\n\n|Library Included|Penquin|Penquin_2.0|Penquin_x64|Year (>=)|\n|---|---|---|---|---|\n|OpenSSL 0.9.6||||2000|\n|OpenSSL 0.9.7e||||2004|\n|OpenSSL 1.0.1j||||2014|\n|libpcap (several with a date between 2000 and 2001)||||2000 - 2001|\n|libpcap version 1.1.1||||2010|\n|glibc 2.3.2||||2004|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\nglibc 2.3.6 2006\n\nGCC: (GNU) 3.3.2 20031022 (Red Hat 2003\nLinux 3.3.2-1)\n\nGCC: (GNU) 3.3.2 20031218 (Red Hat 2003\nLinux 3.3.2-5)\n\nGCC: (GNU) 3.3.5 (Debian 1:3.3.5-13) 2004\n\nGCC: (GNU) 3.3.6 2005\n\nGCC: (GNU) 4.1.0 2006\n\n**Table 5 - Compilers and Libraries statically included in the three “Penquin” versions**\n\n##### EI_ABIVERSION Analysis\n\nWe made a second attempt to estimate the build date using the EI_ABIVERSION embedded\nwithin the samples. This field of the ELF binary file format specifies the version of the\nApplication Binary Interface to which the object is targeted. This version is mainly related to\nwhat version of the compiler (typically GCC) was used to build the sample. Although a table of\n[the GCC releases can be obtained easily (https://gcc.gnu.org/releases.html), the ABI version](https://gcc.gnu.org/releases.html)\nassociated with each version is not immediately available. To this aim we downloaded several\nGCC versions and tried to derive which ABI corresponds to each version. Partial results of this\npreliminary task are reported in Table 6.\n\n|glibc 2.3.6|Col2|Col3|Col4|2006|\n|---|---|---|---|---|\n|GCC: (GNU) 3.3.2 20031022 (Red Hat Linux 3.3.2-1)||||2003|\n|GCC: (GNU) 3.3.2 20031218 (Red Hat Linux 3.3.2-5)||||2003|\n|GCC: (GNU) 3.3.5 (Debian 1:3.3.5-13)||||2004|\n|GCC: (GNU) 3.3.6||||2005|\n|GCC: (GNU) 4.1.0||||2006|\n\n|GCC|ABI|Release date|\n|---|---|---|\n|4.4.4|2.6.15|April 29, 2010|\n|4.8.2|2.6.24|October 16, 2013|\n|4.9.1|2.6.32|July 16, 2014|\n|6.2.0|2.6.32|August 22, 2016|\n|6.3.0|2.6.32|December 21, 2016|\n|7.2.0|3.2|August 14, 2017|\n\n\n-----\n\n**MALWARE TECHNICAL INSIGHT: TURLA Penquin_x64**\n\n7.3.0 3.2 January 25, 2018\n\n7.5 3.2 November 14, 2019\n\n9.2.1 3.2 August 12, 2019\n\n**Table 6 - ABI and GCC versions release date**\n\nUnfortunately, as reported in Table 6, the ABI remains quite stable over time (e.g. ABI 2.6.32\nhas been out for 2.5 years at least), as such this analysis didn’t provide us a smaller time\nwindow with respect to the analysis of the linked libraries (see Table 7).\n\n**ABI Version** **Penquin** **Penquin_2.0** **Penquin_x64** **Year (>=)**\n\n2.2.0 2004\n\n2.2.5 2003\n\n2.4.18 2006\n\n**Table 7 - Penquin build date estimation based on the ABI field of the ELF**\n\nSection 3 describes the approach that was taken to estimate the build date of the\n“Penquin_x64” samples, achieving what we consider the most accurate result.\n\n|7.3.0|3.2|January 25, 2018|\n|---|---|---|\n|7.5|3.2|November 14, 2019|\n|9.2.1|3.2|August 12, 2019|\n\n|ABI Version|Penquin|Penquin_2.0|Penquin_x64|Year (>=)|\n|---|---|---|---|---|\n|2.2.0||||2004|\n|2.2.5||||2003|\n|2.4.18||||2006|\n\n\n-----\n\nPiazza Monte Grappa, 4\n00195 Rome\nT +39 06324731\nF +39 063208621\n\n**leonardocompany.com**\n\n**© Copyright Leonardo S.p.a. – All rights reserved**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.leonardo.com/documents/20142/10868623/Malware+Technical+Insight+_Turla+%E2%80%9CPenquin_x64%E2%80%9D.pdf"
    ],
    "report_names": [
        "Malware+Technical+Insight+_Turla+%E2%80%9CPenquin_x64%E2%80%9D.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716495,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1590685402,
    "ts_modification_date": 1590685402,
    "files": {
        "pdf": "https://archive.orkl.eu/7f978cc7c21fa0cc47c0f13d09854c54bc0282dd.pdf",
        "text": "https://archive.orkl.eu/7f978cc7c21fa0cc47c0f13d09854c54bc0282dd.txt",
        "img": "https://archive.orkl.eu/7f978cc7c21fa0cc47c0f13d09854c54bc0282dd.jpg"
    }
}