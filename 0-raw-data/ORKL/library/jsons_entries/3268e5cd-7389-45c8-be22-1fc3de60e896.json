{
    "id": "3268e5cd-7389-45c8-be22-1fc3de60e896",
    "created_at": "2022-10-25T16:48:18.235942Z",
    "updated_at": "2025-03-27T02:10:07.451584Z",
    "deleted_at": null,
    "sha1_hash": "9274731159b20b87c00c2fd3eb4cdd92e9523242",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-03-25T18:55:57Z",
    "file_modification_date": "2022-03-25T18:55:57Z",
    "file_size": 1541584,
    "plain_text": "# A Look Into Purple Fox’s New Arrival Vector\n\n#### Technical Brief\n\n\n-----\n\n## Introduction\n\nIn previous blogs[1], we analyzed the post infection modules that were delivered from an intrusion\nlinked to the Purple Fox botnet. We discussed the initial access techniques for this malware,\nwhich, in earlier activities, included targeting SQL databases. The malware, as observed from\nTrend Micro telemetry, was launched for the sole purpose of mining cryptocurrency.\n\nThis technical brief focuses on the same group’s recent activities. We cover a new arrival vector\nand the early access loaders that we believe are highly associated with the intrusion set behind\nthis botnet. This recent infection chain is mainly targeting user’s machines via trojanized\nsoftware packages masquerading as legitimate installers. The installers are actively distributed\nonline to lure users into downloading and executing them in an effort to increase the botnet’s\noverall infrastructure.\n\nUpon analysis, we found that the infrastructure hosting the attacker’s malware shows regular\nupdates to the backdoor samples that are installed on the victims’ systems (we detect as\nTrojan.Win64.PFSHELLOADER.SM). This indicates that the group behind Purple Fox may still\nbe optimizing their malware arsenal in preparation for new campaigns. We believe this new\narrival vector and the various early access loaders for Purple Fox will eventually lead to a new\nexpansion in the overall botnet infrastructure.\n\nWe also discussed some links to previous malware that we observed during the analysis of\nseveral artifacts from these activities, particularly their kernel-based modules. The artifacts\nseem to be connected with previously known malware families (specifically, the Zegost info\nstealer and the FatalRAT remote access trojan). We believe these families have been reused\nby the threat actor behind Purple Fox, or it is likely that the actors had access to the malware’s\nbase code.\n\n## Delivery via Weaponized Execution Parents \n\nWe started with tracking the new infection chain and the software packages used to\nencapsulate the first stage loader. First, we analyzed the following samples to observe how this\ninfection starts. We start at this point since the weaponized installer distributed online will\ndetermine the next stage payloads that will be loaded on the victim’s system (the chain is shown\nin Figure 1).\n\nThe second stage payload is added as a single character in the request sent by the execution\nparent to the first stage command and control (C&C) server. It is retrieved from the module\nfilename’s last character (highlighted in Figure 1 as “r”), then the first stage C&C server will log\nthe execution timestamp sent in the request alongside the single character. The single character\nwill determine what payloads will be sent back for the malicious installer to drop on the infected\nmachine.\n\n\n-----\n\nFigure 1. Malicious installer requests the second stage payloads\n\nFigure 2. Hardcoded stage 1 C&C address, and generated single character index from module\n\nfilename\n\nReviewing the disguised software packages, we saw that some of the software they were\nimpersonating were commonly used by Chinese users. The following list shows the recently\nused software and the corresponding malicious payload for the second stage. The different\npayloads will be served by the C&C upon execution based on the last character in the module\nfilename.\n\n|Package Description|Weaponized Filename|Distribution Date|\n|---|---|---|\n|Telegram Installer|TextInputh.exe|2021-12-08|\n|360BDoctor software|客户账单明细j.exe|2021-10-17|\n|PPHelper Tool for Windows to Jailbreak iDevices|pphelper5.exe|2021-12-01|\n|Vmware KVM|极品新茶上线到付服务项目以及联系方式r.exe|2021-09-13|\n\n\n-----\n\nQuickQ Installer QuickQr.exe 2022-02-21\nTable 1. Disguised packages and weaponized filename, highlighted last characters will\n\ndetermine the type of malicious payload dropped on victim\n\nThe malicious URLs that were actively distributing some of these installers are listed in the\nIndicators of Compromise (IOC) document.\n\n## Infection Chain\n\nThe execution of any of the execution parents from the previous table starts with resolving the\n**ShellExecuteA and URLDownloadToFileA application programming interfaces (API) to**\ndownload and execute the next stage from a hardcoded C&C server. This C&C address hosts\nall the variants for the second stage payloads.\n\nFigure 3. First stage loader APIs\n\nBy analzying a set of C&C addresses hosting the second stage samples, we identified a list of\nmore than 60 servers that had previously hosted the samples. At the time of writing, only six\nservers were found active in the recently generated execution parent installers — in the first\ncolumn of Table 1 we can see the variations of software that these malicious installers were\nimpersonating.\n\nFigure 4 shows an exposed HTTP file server (HFS) that’s used to host all the second stage\nsamples with their update timestamps. HFS servers were previously used by Purple Fox in their\nearlier 2019 campaigns to run their C&C servers that host files on the infected bots. This\nattribution link will be discussed further in the similarity analysis section.\n\n|ScreenRecorderPro|Apowersoft.ScreenRecorderPro3.exe|2022-01-02|\n|---|---|---|\n|Network Scanner|zenmap.exe|2022-01-18|\n|chrome_pwa_launcher|x.exe|2022-01-22|\n|Whats app installer|whatsappsetupr.exe|2022-01-28|\n|Proxifier Proxy Client|(奇迹娱乐12月总账单z.exe)|2022-01-06|\n|Adobe flash installer|flashc.exe|2022-02-07|\n|Micro Focus Net Express|mfcss.exe|2022-02-19|\n|QuickQ Installer|QuickQr.exe|2022-02-21|\n\n\n-----\n\nFigure 4. Exposed HFS server acts as a first stage C&C server used for hosting the next stage\n\npayloads\n\nWe tracked the frequency of the second stage updated packages pushed to this exposed server\nusing the timestamp data. Figure 5 shows the number of different second stage malicious\npackages that received updates. They updated many of the packages hosted on their servers\non February 19 and February 26, 2022. Earlier payloads that got pushed to this server were in\nAugust 2021 (that was the attacker’s last update for the module). They are still actively updating\ntheir components at the time of writing.\n\n\n-----\n\nFigure 5. Second stage payloads update count\n\nEach package found on these servers is named using a single character (a-z, 0-9) or a special\ncharacter. The server holds a compressed RAR archive that includes the second stage\nloaders, and the main file inside the archive is svchost.txt that has all the malicious PE\nmodules components that will be dropped in the second stage.\n\nUpon clustering all the collected unique svchost.txt samples (40 unique samples), we found\nthey could be split into seven unique clusters. Each cluster has a different set of malicious PE\nmodules that serve different purposes. The purposes are determined from the single character\nsent by the first stage execution parent to retrieve the right package. The following table shows\nthe current status of the available packages on the first stage C&C server at the time of writing.\n\n|Malicious Archive Cluster|PE Modules inside svchost.txt|Unique archive per cluster|Size of archive member|Archive Name (Request character)|\n|---|---|---|---|---|\n|1|9 PE Modules|5|1.1 MB|a, g, j, s, x|\n|2|15 PE Modules|6|2.5 MB|0, 1, @, +, m, t|\n|3|13 PE Modules|4|2.6 MB|2, 8, k, q|\n|4|8 PE Modules|1|1015.8 MB|i|\n|5|8 PE Modules|17|1016.1 KB|3, 5, 9, -, =, b, c, d, e, f, h, l, n, o, p, v, y|\n|6|8 PE Modules|6|1016.2 KB|4, 7, r, u, w, z|\n|7|8 PE Modules|1|1016.5 KB|6|\n\n\n-----\n\n|7z Legitimate Tool|Col2|1|572.1 KB|77|\n|---|---|---|---|---|\n\n\nTable 2. Second stage payload clusters\n\nInside each unique cluster, we found that the portable executable (PE) modules are only slightly\ndifferent from each other. The differences center in some configuration parameters related to\nthe second stage communications.\n\nThe order of the PE modules inside svchost.txt is dependent on the package requested by the\nmalicious execution parents (files masquerading as legitimate installers). As previously\nmentioned, the last character in the installer filename will determine the final set of the auxiliary\nmodules that will be stuffed inside svchost.txt.\n\nAll the svchost.txt clusters share a shellcode prologue at the beginning, then a variable number\nof auxiliary PE modules immediately after the main backdoor. Some of these are observed to be\ndropped on the victim machines while others seem to be loaded only if a specific condition is\nmet on the system.\n\nFigure 6 shows the overall infection chain from the malicious installer until the second stage is\nloaded.\n\n\n-----\n\nFigure 6. Infection chain showing steps until second stage payload is loaded\n\n\n-----\n\n## Svchost.txt Portable Executable (PE) Components\n\nThis section provides the analysis of a specific set of portable executable (PE) modules found in\none of the clusters. This set was found to be the most distributed. We focused on this specific\ncluster for the following reasons:\n\n   - It has significant links to other malware families — an old campaign previously\ndocumented to be Purple Fox, and an info stealer known as Zegost.\n   - It was observed to be loading the previously documented Purple Fox MSI installer after\nthe second stage.\n   - Different rootkit capabilities are found in the auxiliary PE modules.\n\nThe uniqueness of this cluster is the wide capabilities the attackers implemented in terms of\nantivirus (AV) evasion, the attribution links that could be concluded from the signing certificates\nfor the PE modules, and the deployed malicious signed kernel drivers. Also, the main backdoor\nsupported functionalities dropped in the second stage, and we believe it acts as a loader for the\nPurple Fox MSI installer.\n\n### Shellcode Execution Analysis\n\nAfter analyzing all the observed malicious execution parents delivering different clusters, we\nfound that the shellcode component at the prologue of the dropped svchost.txt was similar\nacross all the different variants, regardless of the actual payloads embedded after the\nshellcode.\n\nIt has two different implementations across all the clusters. A detailed look into both the\nimplementations and the significant PE components found after the shellcode are provided in\nthe next sections.\n\n**Shellcode Hash** **Size** **Executed DLL**\n**Export**\n25da2ebdbe2136f07bd414795082364cafda79d8271d099e78891 8.12 KB Fun1, Fun2, Fun3\nb079158ed1b\n\n492fdcbdf81ed196b35cdbb7fac85e3a8ee1edebe0803034df900f5 3 KB TestFunction\ne1a5049b6\n\nTable 3. Shellcode to load and invoke the backdoor export function\n\n#### First Shellcode Analysis\nThe first shellcode\n(25da2ebdbe2136f07bd414795082364cafda79d8271d099e78891b079158ed1b) implements\nfour main functions for the intended functionality, as shown in the Figure 7 call graph diagram.\n\n|Shellcode Hash|Size|Executed DLL Export|\n|---|---|---|\n|25da2ebdbe2136f07bd414795082364cafda79d8271d099e78891 b079158ed1b|8.12 KB|Fun1, Fun2, Fun3|\n|492fdcbdf81ed196b35cdbb7fac85e3a8ee1edebe0803034df900f5 e1a5049b6|3 KB|TestFunction|\n\n\n-----\n\nFigure 7. Shellcode main functions for loading a PE module in memory\n\nThe shellcode initially identifies its current location in the memory where it was loaded so that it\ncan get to its end location and retrieve the next PE modules. Then, it performs several sanity\nchecks for the first PE module header to make sure it is a valid PE header.\n\nFigure 8. Parsing the PE header structure for the next PE module\n\nAfter getting all the required offsets, the shellcode will resolve a specific set of API addresses\nfrom kernel32.dll and ntdll.dll to support more functions. The resolved addresses are seen in\nFigure 9.\n\nFigure 9. Hashed list of APIs inside the shellcode\n\nThe required APIs that need to be resolved are searched by a custom hashing function called\nthe Resolve_APIs subroutine, which mimics GetProcAddress API. It will parse and enumerate\nkernel32.dll and ntdll.dll exports for those specific APIs, then hash each export name to check\nagainst a set of hardcoded hashes stored inside the shellcode.\n\n\n-----\n\nFigure 10. Enumerate export names and compare with APIs hashes\n\nThe execution flow continues with preparing the first PE module for execution by calling in the\n**Load_PE subroutine. It takes the start address of the first PE module from svchost.txt and the**\nresolved API address table so it can enumerate the section headers and allocate the required\nmemory chunks for loading each section using a sequence of VirtualAlloc calls.\n\nFigure 11. Loading PE sections header\n\nFinally, it will return the start address of the newly initialized memory space loaded with the first\nPE module.\n\nFigure 12. Loading the full PE module\n\nThe last step performed by this shellcode is searching for a specific hardcoded exported\nfunction name from the loaded PE module and identifying its address to be able to call into this\nmodule.\n\n\n-----\n\nFigure 13. Calling export name \"func1\" from the loaded PE backdoor\n\nThe code stub responsible for parsing the export table and enumerating is made efficient by\nusing the system APIs previously resolved for sorting an array of the export table using the\n**qsort API function. Then bsearch is called to perform a binary search on the sorted array to**\nefficiently look for the required export name by ordinals.\n\nFigure 14. Binary search for the export name\n\nIf for some reason the “Fun1” export name cannot be resolved, the shellcode will try to get the\naddress of “Fun2” and “Fun3” respectively by calling into any of the exports from the first PE\nmodule that are implementing the main backdoor. The execution will be transferred to it as\nshown in Figure 15.\n\n\n-----\n\nFigure 15. Transfer the execution to the main backdoor export function\n\n#### Second Shellcode Analysis\nA new implementation for the shellcode prologue component\n(492fdcbdf81ed196b35cdbb7fac85e3a8ee1edebe0803034df900f5e1a5049b6) was captured\nfrom the new droppers in another cluster. The new shellcode is more minimalistic because it\nimplements only important functions to load a PE in memory and parse several system APIs\naddresses. It resolves different system APIs from the first one we mentioned.\n\nFigure 16. Resolved system APIs by the second shellcode sample\n\nAlso, the final export call is different for this sample, it calls an export named “TestFunction”\nfrom the next PE module that gets loaded.\n\nFigure 17. Final export call by the second shellcode after loading the PE in memory\n\n\n-----\n\n#### Implementing user-mode loader\nThe attackers behind Purple Fox opt for implementing a customized user-mode loader in order\nto minimize the amount of bookkeeping entries that their malicious code would register with the\nsystem’s internal data structures.\n\nIt doesn't leave any bookkeeping entries because the native loader isn’t invoked at all, thus, a\nuser-mode shellcode loader is a good design choice if attackers are concerned with\ncybersecurity forensics. It minimizes both the quantity and quality of the forensic evidence as\nthe execution doesn’t rely on the native loader and doesn't respect the PE format for a\nsuccessful execution. The attacker can execute arbitrary code in svchost.txt without any PE\nheader at all as they already implemented a custom loader. The consequence is that the OS will\nnot log such an execution, leading to fewer forensic artifacts from this infection chain.\n\nTo compare, if the LoadLibrary API is used to load a module into the address space of a\nprocess, the call will only succeed if the specified module is a PE file that resides on the disk. In\nthe case of a stand-alone user mode loader, all it needs for a successful execution is to parse\nthe executable headers and make the necessary adjustments as the native Windows loader\ntakes care of three basic tasks: mapping a module into memory, populating the module’s Import\nAddress Table (IAT), and implementing relocation fixes.\n\nFigure 18. LoadLibrary expect a PE file on the disk as input\n\nThis is implemented in shellcode because of its nature of being small, self-contained, having\nminimal footprint, and being position independent. However, there is still an anti-forensics flaw:\nit assumes the required modules inside svchost.txt are residing on the disk. If the threat actor\nmainly implements this for the purpose of anti-forensics and to minimize the loader footprint, to\nfully gain the anti-forensics benefits, the whole invocation should be carried out in a fileless way\n(i.e through an exploit), so it will not leave any traces.\n\nWe didn't observe the invocation of this chain via any exploits as an arrival vector, however,\nlinks to a similar family (the Zegost info stealer which was invoked mainly through shellcode via\nsome exploits) are discussed in the last section. This may mean that there is a group behind the\ntwo families that just reused their old techniques from an earlier campaign, specifically invoking\ntheir backdoors through customized shellcode loaders.\n\n### Second Stage Backdoor\n\nAfter the shellcode loads and allocates memory for loading the stuffed PE modules inside\n**svchost.txt, the execution flow will call into the first PE module found after the shellcode. The**\nmodule is a remote access trojan that inherits its functionality from a malware reported by\nAT&T[2] on August 2021 known as FatalRAT.\n\nIt is a sophisticated C++ RAT that implements a wide set of capabilities for the remote attackers\ncontrolling it. The following figure shows the evolution of these family variants, which are all\n\n\n-----\n\nstemmed from the old Gh0st RAT previously leaked on github.[3] Some pivot points, which link\nthis module to the previously documented info stealer malware Zegost, are discussed in the last\nsection.\n\nFigure 19. The evolution of the updated FatalRAT samples found in this chain\n\nA comparison between the new samples observed from the Purple Fox activities and the early\n**FatalRAT samples from an AT&T report[4] reveals a lot of code similarities between their core**\ninternal functions.\n\nFigure 19. BinDiff statistics from the updated FatalRAT(primary) vs. Older FatalRAT(secondary)\n\nshowing high basic blocks match\n\n\n-----\n\nThe first stage C&C server 202[.]8.123[.]98 links FatalRAT operators with the Purple Fox, as it\nwas hosting the malicious compressed archives in this campaign and was used before by\n**FatalRAT as their main C&C server.**\n\nFigure 20. C&C hosting compressed archives\n\nThe executed FatalRAT variants shown in Figure 21 and 22 differ across each cluster, this\nshows that the attackers are incrementally updating it.\n\nFigure 21. Updated FatalRAT variant from cluster-1\n\n\n-----\n\nFigure 22. Updated FatalRAT variant from a more recent cluster with more added functionality\n\nThe remote access trojan is responsible for loading and executing the auxiliary modules\naccording to several checks performed on the victim systems (i.e., changes happen if specific\nAV agents are running or registry keys are found). Then, it executes them in a specific order\nhardcoded in the backdoor code instead of waiting for a command from its C&C server.\n\nThe auxiliary modules are intended as support for a specific objective that needs to be done.\nFor example, the cluster dropped modules shown in Figure 23 focuses on AV evasion and\nremoval capabilities served from the kernel via various dropped rootkit components.\n\nFigure 23. Dropping various PE modules from memory\n\n\n-----\n\nIt also initiates a second stage C&C channel with another set of servers. It sends all the\nfingerprinting logs collected from the victim’s system and then waits for new commands from the\nC&C server. The configuration parameters for the second stage C&C address is hardcoded\nafter the 7z_dll module in this cluster.\n\nFigure 24. Second Stage config parameters from two variants from the same cluster\n\nFigure 25. FatalRAT encrypted fingerprinting traffic\n\n\n-----\n\nFigure 26. Dispatching commands from C&C as a new worker thread is created\n\nThe following table shows the details of the various PE modules from one of the analyzed\nclusters:\n\n**PE** **Module Description** **Code section MD5 hash** **Size**\n**Module**\n**Order**\n\n1 Purple fox second stage updated cd4462856c4fd8b466aa621adac70ded 5399 KB\n**FatalRAT**\n\n2 545a30.dll drop and decrypt PE_3 72442AD98A13CA8D1F956D95F98E8AED 71 KB\n3 222.dll dropped by 545a30.dll 24D5DAC4C6006A7EC58FD11838543953 361 KB\n4 RAMNIT file infector A0272708E1DE3F323B71B5D723BEDD5A 328 KB\nmasquerading as Pure Player\nsoftware\n\n5 7z_EXE (Legitimate 7z installer) 70E470D6244A85221ADD5E4571B82DAB 303 KB\n6 7z_dll (includes the second stage F2FEEB586039BE21DF852A77C3F0F621 1132 KB\nconfig)\n\n7 luohua Dlldll (for UAC bypass) 4A59658BCC4205A2CA9BE1F13FDAE02B 52 KB\n8 User-mode client interface (x64) 6046DC00F75D92877B847A959C4E01F6 75 KB\n9 Mini-filter Killer Driver(x64) 842CD635A2662745ED3242CFC21C1C35 136 KB\n10 A signed Hidden rootkit variant 1 C9385EE4D39A4BC7EF9DA02F70849EAB 62 KB\n11 A signed Hidden rootkit variant 2 2DD4534BF273C23DC641AB0D3B3E192C 384 KB\nTable 4. Various PE modules inside svchost.txt cluster\n\nIn the recently updated clusters, the attackers started to deliver some new perl modules\nalongside an interpreter to be executed on the victim machines. We are currently tracking the\nnew payloads delivered by this threat.\n\n|PE Module Order|Module Description|Code section MD5 hash|Size|\n|---|---|---|---|\n|1|Purple fox second stage updated FatalRAT|cd4462856c4fd8b466aa621adac70ded|5399 KB|\n|2|545a30.dll drop and decrypt PE_3|72442AD98A13CA8D1F956D95F98E8AED|71 KB|\n|3|222.dll dropped by 545a30.dll|24D5DAC4C6006A7EC58FD11838543953|361 KB|\n|4|RAMNIT file infector masquerading as Pure Player software|A0272708E1DE3F323B71B5D723BEDD5A|328 KB|\n|5|7z_EXE (Legitimate 7z installer)|70E470D6244A85221ADD5E4571B82DAB|303 KB|\n|6|7z_dll (includes the second stage config)|F2FEEB586039BE21DF852A77C3F0F621|1132 KB|\n|7|luohua Dlldll (for UAC bypass)|4A59658BCC4205A2CA9BE1F13FDAE02B|52 KB|\n|8|User-mode client interface (x64)|6046DC00F75D92877B847A959C4E01F6|75 KB|\n|9|Mini-filter Killer Driver(x64)|842CD635A2662745ED3242CFC21C1C35|136 KB|\n|10|A signed Hidden rootkit variant 1|C9385EE4D39A4BC7EF9DA02F70849EAB|62 KB|\n|11|A signed Hidden rootkit variant 2|2DD4534BF273C23DC641AB0D3B3E192C|384 KB|\n\n\n-----\n\n### Kernel-mode AV-killer Driver Analysis\n\nOne of the analyzed executables embedded in svchost.txt is a user-mode client used to\ninterface with the accompanying rootkit module shown in the next section. This client supports\nfive different commands, each command implements a specific functionality to be executed from\nthe kernel driver that has the appropriate IOCTL interface exposed. The following table shows\nthe details of each command:\n\n**IOCTL Description** **IOCTL** **User-** **ARGC** **User Mode Client Arguments**\n**Mode**\n**Command**\n\n**Kill a Mini-Filter Driver** 0x222000 **m** **1** Mini-Filter driver name\n\nCopy Files from Kernel 0x222004 **c** **2** Source path, Destination path\n\nDelete Files from Kernel 0x222008 **d** **1** File Path to delete\n\nKill/Wipe User-mode Process 0x22200c **k** **2** Operation Type, Process name\n\nNA NA **i** **1** Install Service (only in the x86\nsample)\n\nTable 1. IOCTL interface implemented by Purple Fox AV killer rootkit\n\n#### Mini-filter killer driver\nFile systems are targets for input-output (I/O) operations to access files. File system filtering is\nthe mechanism by which the drivers can intercept calls sent to the file system, which is useful\nfor AV agents. The model called ‘file system mini-filters’ was developed to replace the legacy\nfilter mechanism. Mini-filters are easier to write and are the preferred way to develop file system\nfiltering drivers in almost all AV engines.\n\nWhen an application accesses or creates a file, whether legitimate or malicious, it sends IRPs to\nthe Windows File System Driver at the kernel. These IRPs are handled by the Windows I/O\nManager and are then intercepted by the Windows Filter Manager. I/O Manager allows the\nregistered mini-filter drivers to filter the intercepted information. The Windows Filter Manager\nthen passes the IRPs to its registered mini-filter drivers, allowing the protection agent to detect\nfile access and modification events on the file system level.\n\nFigure 27. File system mini-filter model\n\n|IOCTL Description|IOCTL|User- Mode Command|ARGC|User Mode Client Arguments|\n|---|---|---|---|---|\n|Kill a Mini-Filter Driver|0x222000|m|1|Mini-Filter driver name|\n|Copy Files from Kernel|0x222004|c|2|Source path, Destination path|\n|Delete Files from Kernel|0x222008|d|1|File Path to delete|\n|Kill/Wipe User-mode Process|0x22200c|k|2|Operation Type, Process name|\n|NA|NA|i|1|Install Service (only in the x86 sample)|\n\n\n-----\n\nWe looked deeper into the mini-filter driver killer and how the attackers implemented this\nfunctionality. The driver first enumerates all the registered mini filter drivers on the system using\nthe system API FltEnumerateFilters, then it gets the targeted mini-filter object information it is\nsearching for by calling FltGetFilterInformation. Lastly, it creates a new system thread to\nunregister the mini-filter driver and terminate the created system thread\n(PsCreateSystemThread and FltUnregisterFilter).\n\nFigure 28 shows the specific call graph for the system APIs used for this functionality.\n\nFigure 28. System APIs calls for unregistering mini-filter drivers\n\nWhen testing this rootkit functionality to remove a mini-filter driver from an unprotected system,\nas shown in Figure 29, the driver logged the issued command when it successfully removed the\nsystem mini-filter driver.\n\nFigure 29. Testing \"m\" command on an unprotected system\n\nThis functionality was observed being used against 360 safeguard AV agent components. It was\nfound in the bat script shown in the next sections.\n\n#### Killing user-mode processes\nThis kernel driver implements two different techniques for killing the user-mode process. The\nchoice is made from the user mode client provided after the “k” command; it receives either 1\nor 0.\n\n\n-----\n\nThe first technique is when the passed command is k 0 <PROCESS_NAME>. It starts with\ncalling PsLookupProcessByProcessId to get a referenced pointer to the EPROCESS\n**structure of the target process. Then, it attaches the current execution thread to the address**\nspace of the target process by calling KeStackAttachProcess. After this call, the current thread\ncan directly alter the address space of the target process and wipe all the content directly from\nthe kernel. It enumerates the address space starting from the memory address 0x10000 and\nstarts to wipe the memory contents in chunks of 0x1000 bytes each. It verifies that each\naddress is a valid virtual memory before trying to write it using MmIsAddressValid API to avoid\ncrashing the system.\n\nFigure 30. Removing the process content from kernel-space\n\nFigure 31. Testing \"k\" command on unprotected system\n\n\n-----\n\nThe second implemented method is when the passed command is k 1 <PROCESS_NAME>. It\nwill kill the process by using APC (Asynchronous Procedure Call).\n\nAPC is a system mechanism in Windows systems that makes it possible to queue a job to be\nexecuted in the context of a target thread. This makes it possible to implement any kind of\nasynchronous callbacks in Windows systems. It’s been known to be abused by other malware,\nmainly to inject other processes in kernel mode. The APIs for dealing with kernel APCs are\n**undocumented, indicating a mature threat actor with a wide range of capabilities.**\n\nThe code shown in Figure 32 shows an enumeration of all the thread IDs running on the\nsystems to identify any thread running under the target process to be killed. It does so by\n**PsLookupThreadByThreadId, which takes the thread ID as it is input and returns a referenced**\npointer to the ETHREAD structure for the thread, starting by TID 0x4 adding 4 by each iteration.\nThen, the IoThreadToProcess API returns a pointer to the process for the current thread. If this\npointer is equal to the target EPROCESS structure, it will use the KeInitializeApc and\n**KeInsertQueueApc undocumented kernel APIs to queue a kernel APC to the thread queue.**\nThe KAPC callback will eventually call PsTerminateSystemThread, which is sent along with\nthe IOCTL buffer sent by the user-mode client.\n\nFigure 32. Killing user-mode process using kernel APCs\n\n#### Bat script invoker\nA sample usage for the previously discussed kernel driver is illustrated in Figure 33. The usermode client that interfaces with the kernel driver is invoked by the APC mechanism to kill a\nprocess called ZhuDongFangYu.exe. Then, it unregisters a mini-filter driver called 360FsFlt.\nFinally, it kills other processes by the first mechanism (360safe.exe, 360tray.exe, 360sd.exe,\n**QQPCTray.exe, QQPCRTP.exe).** Killing these processes helps with AV evasion, stopping the\ntargeted AV agents from running so that the attackers can continue with their activities.\n\n\n-----\n\nFigure 33. Invoking the user-mode client that interfaces with the kernel driver to kill a specific\n\nprocess\n\n## Similarity Analysis\n\n### Stolen Code Signing Certificate\n\nAnalyzing the artifacts dropped by this chain, we looked for the stolen code signing certificates\nused to sign the kernel drivers’ modules so that the modules can be successfully loaded into the\nWindows kernel. Pivoting with these certificates led us to analyze other signed malicious\nsamples in our malware repository, and these samples can help attribute malicious activity to\npreviously known intrusion sets.\n\nThis section will describe the use of three different stolen code signing certificates confirmed to\nbe related to this campaign, and the evidence that links different analyzed samples together.\n\n|Name|Serial Number|Valid Usage|Issuer|Status|\n|---|---|---|---|---|\n|Hangzhou Hootian Network Technology Co., Ltd.|08 7F CE CC 8E CF 05 F7 4C C3 B8 AF AD 4C 06 5D|Code Signing|VeriSign Class 3 Code Signing 2010 CA|Revoked|\n|上海域联软件技 术有限公司|5F 78 14 9E B4 F7 5E B1 74 04 A8 14 3A AE AE D7|Code Signing|VeriSign Class 3 Code Signing 2010 CA|Revoked|\n|Shanghai easy kradar Information|55 2B 41 BE 12 D9 40 43 7D F4 5D 48 87 38 CC 51|Code Signing|Thawte Code Signing CA - G2|Revoked|\n\n\n-----\n\n|Consulting Co. Ltd.|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n\n\nTable 2. Code Signing certificates related to Purple Fox\n\nRetrospectively studying “Hangzhou Hootian Network” signed files from our repository, we\nfound a strong connection to early activity of the Purple Fox botnet that started in 2019 (reported\nby Guardicore[5]).\n\nThe threat actors behind Purple Fox used this certificate to sign their rootkit component used to\nhide the deployed crypto miner module in the earlier campaign in 2019. It mainly used this\nrootkit to hide its registry keys and achieve file system-level stealth. These drivers were\nprotected and obfuscated with the VMProtect tool to increase the difficulty of reverseengineering the samples.\n\nThe fact that this certificate appeared again in the previously analyzed mini-filter removal driver\nand the other modules appeared in the svchost.txt cluster indicates that it is still the same\nthreat actor behind these new activities.\n\nThe following table shows an analysis for this malicious certificate from a statistical point of view\nin terms of the number of captured samples signed with this same malicious certificate.\n\nFigure 34. Signed executables with “Hangzhou Hootian” statistics\n\nAnalysis of the second certificate, 上海域联软件技术有限公司 “Shanghai Oceanlink Software\n\n**Technology Co. Ltd.,” revealed several clusters of malicious kernel modules. Most of them**\nwere compiled drivers that stemmed from two open source projects: Hidden[6] rootkit and\nBlackbone[7] Windows memory hacking library. Both modules are known to have been utilized in\nprevious Purple Fox activities.\n\nAnother interesting link regarding the third certificate, “Shanghai easy kradar Information\n**Consulting Co. Ltd.,”is that it overlaps with “Hangzhou Hootian Network” in signing a**\n\n\n-----\n\ncommon cluster of kernel drivers of imphash 2bef7e40cd07bc587b2db765364884d9, which\nwas also seen in previous Purple Fox activities.\n\nThe earlier certificate was found to be explicitly blocked by the digitally-signed rootkit FiveSys\nthat was reported in October 2021 by Bitdefender[8]. It shows the competition between different\nthreat actors behind these campaigns as each group tries to exclusively control their victims. It\nalso shows how they identify and block each other using the stolen certificate signatures. This\nsame intelligence over the stolen certificates gives us the ability to cluster, track, and attribute\ntheir campaigns.\n\nFigure 5. FiveSys Rootkit blocking list includes Shanghai easy kradar certificate\n\nFigure 36. Purple Fox stolen code signing certificates graph\n\n\n-----\n\n### Similarities with Zegost Info Stealer\n\nThe FatalRAT dropped from the malicious archive found on the first stage C&C server had\nmany similarities in code with a previously documented info stealer known as Zegost.[9] This\nmalware has been historically attributed to Chinese cybercriminals that focus their campaigns\non Chinese government agencies, but it has also been observed in various global campaigns.\nThe previously documented motive behind this info stealer was to gather intelligence, which is\nconfirmed by the information-stealing capabilities found in Zegost malware samples.\n\nThe following are some of the commonalities that were found between these Purple Fox\ncampaign modules and the old Zegost samples. It implies with strong confidence that the same\nactor is behind the two campaigns. The actors also probably reused some of the old\ncomponents for this campaign, or they are at least both forked from the same codebase.\n\n- Process name mssecess.exe typo:\n\n**Svchost.txt backdoor implements a process checker list for common AV and EDR products.**\nThe two malware share the same list that includes Microsoft Security Essentials process spelled\nas ‘mssecess.exe’ instead of 'msseces.exe'\n\nFigure 37. The process 'mssecess.exe' typo in the new Purple Fox backdoor\n\n- **Sgaiycl string:**\n\nThe mini-filter killer driver\n(638fa26aea7fe6ebefe398818b09277d01c4521a966ff39b77035b04c058df60) inside\nsvchost.txt samples has a PDB path\n“C:\\Users\\sgaiycl\\Desktop\\RunDrive\\AddTrustDriver\\x64\\Release\\Driver.pdb”. This username is\ncorrelated with an old Zegost sample\n(9b0401ed25b9852928fea88b68f386c89c1fd594043a65432307b477b9f841f7) which resolved\nthe malicious sub-domain sgaiycl[.]gnway[.]net. Moreover, this Zegost sample is also digitally\nsigned with the same “Hangzhou Hootian” code signing certificate.\n\nFigure 38. Purple Fox driver PDB path\n\nFigure 39. Zegost sample C&C sub-domain\n\n\n-----\n\n- Logging of the number and speed of the victims’ processors:\n\nBoth families start with fingerprinting their victims’ machines and sending the collected data to\nthe second stage C&C server. They query the registry key\n**“HKLM\\\\HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor\\\\0\\\\\\\"~MHz\\” to identify the**\nresources of the infected machine. Knowledge of the system hardware resources are important\ninformation for Purple Fox attacks when the objective is to add their victims to their crypto\nmining pool.\n\nFigure 40. Sending the victim hardware resources to the second stage C&C\n\n- Heavy usage of COM programming:\n\nBoth use a similar COM APIs sequence to find video capture devices installed on the victims’\nmachines, such as a webcams.\n\nFigure 41. the DirectShow capture filter is being used to enumerate the infected machine for\n\nvideo capture devices\n\n- Keylogging Capabilities:\n\nBoth implement a similar keylogging functionality, as seen in Figure 42.\n\n\n-----\n\nFigure 42. Different keystrokes logged by Purple Fox malware\n\n- Invoking Zegost through shellcode and similar Svchost nomenclature for their parent\npackages:\n\nAs shown previously, the updated FatalRAT was invoked through a shellcode that implements a\nuser- mode loader. According to documentation[10] of an old attack chain, Zegost was deployed\nthrough an embedded shellcode. The two chains (svchost.txt and svchost.exe) also used a\nsimilar nomenclature to encapsulate the malicious modules.\n\nFigure 43. Zegost infection chain from Zscaler report[11]\n\n- Similar configurations string:\n\nThe string “6gkIBfkS+qY=\" was found in the new Purple Fox backdoor configuration, which is\nthe same string that a Zegost sample loaded in the registry\n**HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services ConnectGroup =**\n**\"6gkIBfkS+qY=\".**\n\n\n-----\n\nFigure 44. Config parameters from Purple Fox updated FatalRAT\n\n### Similarities with Earlier Purple Fox Campaigns\n\nThis campaign shares some similarities with earlier Purple Fox activities. We will list some of the\ncommonalities between both in terms of how the operators are running their attack infrastructure\nand the malware they are hosting on the first stage C&C servers of this campaign:\n\n  - The attacker’s servers that store the first stage malicious compressed archives were all\nrunning HFS – an HTTP File Server – serving different packages according to the\nexecution parent request. This aligns with the Nansh0u campaign in 2019 reported by\nGuardicore.[12]\n\n  - They are still experiencing some bad SecOps. They keep their whole infrastructure on a\nfile server with no activated authentication controls, even all their binary clusters\n(including old samples) with their original timestamps, and a text file that includes all the\nvictims IPs (around 23,000 unique public IPs). However, in this campaign, they removed\nany logs, or username traces previously left on their file servers in the old campaign.\n\nFigure 45. Old Purple Fox server from 2019 campaign running old HFS HTTP server, exposing\n\nall the victim’s data\n\n\n-----\n\nFigure 46. The new HFS servers running the first stage C&C servers only exposing the second\n\nstage binaries\n\nFigure 47. Victim list of 23,000 unique IPs found hosted on one of their servers\n\n  - One of the first stage servers (194.146.84.245) hosted an old module for the MSI\ninstaller for Purple Fox (e1f3ac7f.moe) that will eventually load the crypto miner\ndiscussed in the previous blogs.\n\nFigure 48. hosting old purple fox MSI installer on the new servers\n\n  - They are still building their infrastructure from compromising vulnerable servers running\nunpatched services (compromised servers as an infrastructure).\n\n\n-----\n\n## Revoked Kernel Drivers Tell-tales\n\nKernel-mode drivers are executable files that run within the operating system’s kernel with highprivileged access to sensitive data structures and sensitive system resources. To control the\nquality of the code that runs in the address space of the kernel-land, Microsoft only allows\nsigned drivers to run in kernel mode through enforcing kernel-mode code signing (KMCS)\nmechanisms.\n\nDue to performance issues and backward compatibility, Windows allows the loading of a kernel\ndriver signed by a revoked code signing certificate. So, by testing a previous kernel driver, it can\nbe loaded successfully as Windows allows a driver signed with a revoked certificate to load.\n\nIn the case of user-mode signed executables, the digital signatures are verified by checking the\nCRL list obtained from certificate issuers remotely. However, in the kernel drivers’ case, it\ncannot be queried online like user-mode signed executables due to the absence of network\nconnectivity during the kernel initialization and bootup. The kernel boot must be fast and\nefficient, so only primitive services are available.\n\nThis justifies the design choice of code signing verification for the Windows drivers that is\nenforced by the kernel to verify the signature offline. It cannot check the latest revocation list as\nall the system cryptographic services and network access are not available. A primitive version\nof the signature verification is used for kernel drivers compared with user-mode executable\nverification. As a result, the kernel drivers signed with these revoked certificates can still be\nloaded into a 64-bit Windows kernel despite their revoked status.\n\nThis design choice tradeoff allows mature threat actors to chase and pursue any stolen code\nsigning certificate and add it to their malware arsenal. If the malware authors acquire any\ncertificate that has been verified by a trusted subordinate CA and by Microsoft, even if it was\nrevoked, they can use this certificate for malicious purposes.\n\nThus, the leaked and compromised certificates of a trusted driver vendor will still be a target for\na threat actor with a mature and sophisticated arsenal.\n\n## Conclusion\n\nThe attackers behind the Purple Fox botnet are still active and updating their arsenal with\nmalware that includes a new variant of FatalRAT, which itself seems to be regularly updated\nwith new functionalities. Moreover, they are trying to improve their signed rootkit arsenal for AV\nevasion to be able to bypass the detection mechanisms by targeting them with customized\nsigned kernel drivers. Obtaining a code signing certificate is not a trivial technique and requires\nlots of planning. However, mature actors can afford this effort for the benefit of advanced stealth\nopportunities coupled with the high privileged access that they can achieve.\n\nThis activity aligns with the return of low-level attacks and the increase of signed rootkits\nusage,[13] which are trends we have been observing. These revitalized techniques are mainly due\nto the increasing protection on the user-land processes by endpoint protection platform (EPP)\nand endpoint detection and response (EDR) technologies, either on the users’ desktop or\n\n\n-----\n\nservers. Because of these added protections, the attackers will opt for the path of least\nresistance — getting some of their code running from the kernel.\n\nThe trends of using stolen code signing certificates to sign customized kernel drivers (i.e. the\nrecent NVIDIA data breach[14]) or even abusing unprotected legitimate drivers (i.e. the\nHermeticWiper abuse of EaseUS used against Ukraine[15]) are growing, and predictions show\nthey are expected to grow further in the future. These are vital reasons why software driver\nvendors must effectively secure their obtained code signing certificates and follow secure\npractices in the Windows kernel drivers development process.\n\n## References\n\n1 Jay Yaneza, Abdelrhman Sharshar, and Sherif Magdy. (Dec. 13, 2021). Trend Micro. “A Look\nInto Purple Fox’s Server Infrastructure.” Accessed on Mar. 24, 2022 at\n[https://www.trendmicro.com/en_us/research/21/l/a-look-into-purple-fox-server-](https://www.trendmicro.com/en_us/research/21/l/a-look-into-purple-fox-server-infrastructure.html)\n[infrastructure.html.](https://www.trendmicro.com/en_us/research/21/l/a-look-into-purple-fox-server-infrastructure.html)\n\n2Ofer Caspi. (Aug. 2, 2021). AT&T Cybersecurity. “New sophisticated RAT in town: FatalRat\n[analysis.” Accessed on Mar. 24, 2022 at https://cybersecurity.att.com/blogs/labs-research/new-](https://cybersecurity.att.com/blogs/labs-research/new-sophisticated-rat-in-town-fatalrat-analysis)\n[sophisticated-rat-in-town-fatalrat-analysis?.](https://cybersecurity.att.com/blogs/labs-research/new-sophisticated-rat-in-town-fatalrat-analysis)\n\n3Github. (May 9, 2013). Github. “gh0st.” Accessed on Mar. 24, 2022 at\n[https://github.com/sin5678/gh0st.](https://github.com/sin5678/gh0st)\n\n4Ofer Caspi. (Aug. 2, 2021). AT&T Cybersecurity. “New sophisticated RAT in town: FatalRat\n[analysis.” Accessed on Mar. 24, 2022 at https://cybersecurity.att.com/blogs/labs-research/new-](https://cybersecurity.att.com/blogs/labs-research/new-sophisticated-rat-in-town-fatalrat-analysis)\n[sophisticated-rat-in-town-fatalrat-analysis?.](https://cybersecurity.att.com/blogs/labs-research/new-sophisticated-rat-in-town-fatalrat-analysis)\n\n5Ophir Harpaz and Daniel Goldberg. (n.d.). Guardicore. “The Nansh0u Campaign – Hackers\n[Arsenal Grows Stronger”. Accessed on Mar. 24, 2022 at https://www.guardicore.com/labs/the-](https://www.guardicore.com/labs/the-nansh0u-campaign-hackers-arsenal-grows-stronger/)\n[nansh0u-campaign-hackers-arsenal-grows-stronger/.](https://www.guardicore.com/labs/the-nansh0u-campaign-hackers-arsenal-grows-stronger/)\n\n6 JKornev. (Feb. 28, 2022). Github. “Hidden.” Accessed on Mar. 24, 2022 at\n[https://github.com/JKornev/hidden.](https://github.com/JKornev/hidden)\n\n7 DarthTon. (Jun. 21, 2022). Github. “Blackbone.” Accessed on Mar. 24, 2022 at\nhttps://github.com/DarthTon/Blackbone.\n\n8Cristian Alexandru et al. (Oct. 20, 2021). Bitdefender. “Digitally-Signed Rootkits are Back – A\nLook at FiveSys and Companions.” Accessed on Mar. 24, 2022 at\n[https://www.bitdefender.com/blog/labs/digitally-signed-rootkitsare-back-a-look-atfivesys-and-](https://www.bitdefender.com/blog/labs/digitally-signed-rootkitsare-back-a-look-atfivesys-and-companions/)\n[companions/.](https://www.bitdefender.com/blog/labs/digitally-signed-rootkitsare-back-a-look-atfivesys-and-companions/)\n\n9 FortiGuard SE Team. (Jul. 26, 2019). Fortinet. “Zegost from Within – New Campaign Targeting\n[Internal Interests.” Accessed on Mar. 24, 2022 at https://www.fortinet.com/blog/threat-](https://www.fortinet.com/blog/threat-research/zegost-campaign-targets-internal-interests)\n[research/zegost-campaign-targets-internal-interests.](https://www.fortinet.com/blog/threat-research/zegost-campaign-targets-internal-interests)\n\n\n-----\n\n10Deepen Desai. (Oct. 16, 2015). Zscaler. “Chinese Backdoor Zegost Delivered Via Hacking\n[Team Exploit.” Accessed on Mar. 24, 2022 at https://www.zscaler.com/blogs/security-](https://www.zscaler.com/blogs/security-research/chinese-backdoor-zegost-delivered-hacking-team-exploit)\n[research/chinese-backdoor-zegost-delivered-hacking-team-exploit.](https://www.zscaler.com/blogs/security-research/chinese-backdoor-zegost-delivered-hacking-team-exploit)\n\n11Deepen Desai. (Oct. 16, 2015). Zscaler. “Chinese Backdoor Zegost Delivered Via Hacking\n[Team Exploit.” Accessed on Mar. 24, 2022 at https://www.zscaler.com/blogs/security-](https://www.zscaler.com/blogs/security-research/chinese-backdoor-zegost-delivered-hacking-team-exploit)\n[research/chinese-backdoor-zegost-delivered-hacking-team-exploit.](https://www.zscaler.com/blogs/security-research/chinese-backdoor-zegost-delivered-hacking-team-exploit)\n\n12Ophir Harpaz and Daniel Goldberg. (n.d.). Guardicore. “The Nansh0u Campaign – Hackers\n[Arsenal Grows Stronger”. Accessed on Mar. 24, 2022 at https://www.guardicore.com/labs/the-](https://www.guardicore.com/labs/the-nansh0u-campaign-hackers-arsenal-grows-stronger/)\n[nansh0u-campaign-hackers-arsenal-grows-stronger/.](https://www.guardicore.com/labs/the-nansh0u-campaign-hackers-arsenal-grows-stronger/)\n\n13Kaspersky. (May 6, 2021). Kaspersky. “Operation TunnelSnake: Formerly unknown rootkit\nused to secretly control networks in Asia and Africa.” Accessed on Mar. 24, 2022 at\n[https://usa.kaspersky.com/about/press-releases/2021_operation-tunnel-snake-formerly-](https://usa.kaspersky.com/about/press-releases/2021_operation-tunnel-snake-formerly-unknown-rootkit-used-to-secretly-control-networks-in-asia-and-africa)\n[unknown-rootkit-used-to-secretly-control-networks-in-asia-and-africa.](https://usa.kaspersky.com/about/press-releases/2021_operation-tunnel-snake-formerly-unknown-rootkit-used-to-secretly-control-networks-in-asia-and-africa)\n\n14Katie Wickens. (Mar. 7, 2022). PC Gamer. “Nvidia's stolen data is being used to disguise\n[malware as GPU drivers.” Accessed on Mar. 24, 2022 at https://www.pcgamer.com/nvidias-](https://www.pcgamer.com/nvidias-stolen-data-is-being-used-to-disguise-malware-as-gpu-drivers/)\n[stolen-data-is-being-used-to-disguise-malware-as-gpu-drivers/.](https://www.pcgamer.com/nvidias-stolen-data-is-being-used-to-disguise-malware-as-gpu-drivers/)\n\n15Juan Andrés Guerrero-Saade. (Feb. 23, 2022). Sentinel Labs. “HermeticWiper New\nDestructive Malware Used In Cyber Attacks on Ukraine.” Accessed on Mar. 24, 2022 at\n[https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/.](https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://www.trendmicro.com/content/dam/trendmicro/global/en/research/22/c/purple-fox-uses-new-arrival-vector-and-improves-malware-arsenal/Technical%20Brief%20-%20A%20Look%20Into%20Purple%20Fox%E2%80%99s%20New%20Arrival%20Vector.pdf"
    ],
    "report_names": [
        "Technical%20Brief%20-%20A%20Look%20Into%20Purple%20Fox%E2%80%99s%20New%20Arrival%20Vector.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c390b96-8206-4194-81d8-ebbabb9910ff",
            "created_at": "2023-12-03T02:00:05.147496Z",
            "updated_at": "2025-03-27T02:00:03.259538Z",
            "deleted_at": null,
            "main_name": "TunnelSnake",
            "aliases": [],
            "source_name": "MISPGALAXY:TunnelSnake",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4b48e4b6-09b0-4f4d-a78c-6b455d122e67",
            "created_at": "2022-10-25T16:07:24.020115Z",
            "updated_at": "2025-03-27T02:02:10.08247Z",
            "deleted_at": null,
            "main_name": "Operation TunnelSnake",
            "aliases": [],
            "source_name": "ETDA:Operation TunnelSnake",
            "tools": [
                "Moriya"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041407,
    "ts_creation_date": 1648234557,
    "ts_modification_date": 1648234557,
    "files": {
        "pdf": "https://archive.orkl.eu/9274731159b20b87c00c2fd3eb4cdd92e9523242.pdf",
        "text": "https://archive.orkl.eu/9274731159b20b87c00c2fd3eb4cdd92e9523242.txt",
        "img": "https://archive.orkl.eu/9274731159b20b87c00c2fd3eb4cdd92e9523242.jpg"
    }
}