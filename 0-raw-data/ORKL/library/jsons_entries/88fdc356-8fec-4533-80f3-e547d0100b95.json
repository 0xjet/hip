{
    "id": "88fdc356-8fec-4533-80f3-e547d0100b95",
    "created_at": "2022-10-25T16:48:22.62957Z",
    "updated_at": "2025-03-27T02:17:02.310869Z",
    "deleted_at": null,
    "sha1_hash": "67f46c74653725c4e385c800f438eb8fd8805d05",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-05-13T06:22:24Z",
    "file_modification_date": "2022-05-13T06:22:24Z",
    "file_size": 640553,
    "plain_text": "# UNC3524: Eye Spy on Your Email\n\n**mandiant.com/resources/unc3524-eye-spy-email**\n\nSince December 2019, Mandiant has observed advanced threat actors increase their investment in tools to facilitate bulk email collection from\nvictim environments, especially as it relates to their support of suspected espionage objectives. Email messages and their attachments offer a rich\nsource of information about an organization, stored in a centralized location for threat actors to collect. Most email systems, whether on-premises\n[or in the cloud, offer programmatic methods to search and access email data across an entire organization, such as eDiscovery and the Graph API.](https://docs.microsoft.com/en-us/microsoft-365/compliance/ediscovery?view=o365-worldwide)\n[Mandiant has observed threat actors use these same tools to support their own collection requirements and to target the mailboxes of individuals](https://www.mandiant.com/resources/remediation-and-hardening-strategies-for-microsoft-365-to-defend-against-unc2452)\nin victim organizations.\n\nIn this blog post, we introduce UNC3524, a newly discovered suspected espionage threat actor that, to date, heavily targets the emails of\nemployees that focus on corporate development, mergers and acquisitions, and large corporate transactions. On the surface, their targeting of\nindividuals involved in corporate transactions suggests a financial motivation; however, their ability to remain undetected for an order of\n[magnitude longer than the average dwell time of 21 days in 2021, as reported in M-Trends 2022, suggests an espionage mandate. Part of the](https://www.mandiant.com/resources/m-trends-2022)\ngroup’s success at achieving such a long dwell time can be credited to their choice to install backdoors on appliances within victim environments\nthat do not support security tools, such as anti-virus or endpoint protection. The high level of operational security, low malware footprint, adept\nevasive skills, and a large Internet of Things (IoT) device botnet set this group apart and emphasize the “advanced” in Advanced Persistent Threat.\nUNC3524 also takes persistence seriously. Each time a victim environment removed their access, the group wasted no time re-compromising the\nenvironment with a variety of mechanisms, immediately restarting their data theft campaign. We are sharing the tools, tactics, and procedures\nused by UNC3524 to help organizations hunt for and protect against their operations.\n\n## Attack Lifecycle\n\n### Initial Compromise and Maintain Presence\n\nAfter gaining initial access by unknown means, UNC3524 deployed a novel backdoor tracked by Mandiant as QUIETEXIT, which is based on the\nopen-source Dropbear SSH client-server software. For their long-haul remote access, UNC3524 opted to deploy QUIETEXIT on opaque network\nappliances within the victim environment; think backdoors on SAN arrays, load balancers, and wireless access point controllers. These kinds of\ndevices don’t support antivirus or endpoint detection and response tools (EDRs), subsequently leaving the underlying operating systems to\nvendors to manage. These appliances are often running older versions of BSD or CentOS and would require considerable planning to compile\nfunctional malware for them. By targeting trusted systems within victim environments that do not support any type of security tooling, UNC3524\nwas able to remain undetected in victim environments for at least 18 months.\n\nQUIETEXIT works as if the traditional client-server roles in an SSH connection were reversed. Once the client, running on a compromised\nsystem, establishes a TCP connection to a server, it performs the SSH server role. The QUIETEXIT component running on the threat actor’s\ninfrastructure initiates the SSH connection and sends a password. Once the backdoor establishes a connection, the threat actor can use any of the\noptions available to an SSH client, including proxying traffic via SOCKS. QUIETEXIT has no persistence mechanism; however, we have observed\nUNC3524 install a run command (rc) as well as hijack legitimate application-specific startup scripts to enable the backdoor to execute on system\nstartup.\n\nFigure 1: How QUIETEXIT works with IoT devices\n\nOn startup, QUIETEXIT attempts to change its name to cron, but the malware author did not implement this correctly, so it fails. During our\nincident response investigations, we recovered QUIETEXIT samples that were renamed to blend in with other legitimate files on the file system.\nIn one case with an infected node of a NAS array, UNC3524 named the binary to blend in with a suite of scripts used to mount various filesystems\nto the NAS\n\n\n-----\n\nWhen run with command line arguments `-X -p <port> the malware connects to a hard-coded command and control (C2) address on the`\nspecific port. If this fails, it will attempt to connect to a second hard coded C2 if one is configured. The user can also specify a hostname or IP\naddress on the command line in the -p argument as well, e.g. `-X -p <host>:<port> .The -X command line argument is case sensitive. If the`\nlower-case x option is used, then the malware will only attempt to connect to the C2 server once. If the upper-case X option is used, then the\nmalware will sleep for a random number of minutes between a hard-coded time range and fork to reattempt the connection. It re-attempts the\nconnection regardless of whether a connection has already been established. In our investigations we observed UNC3524 use C2 domains that\nintended to blend in with legitimate traffic originating from the infected appliances. Using the example of an infected load balancer, the C2\ndomains contained strings that could plausibly relate to the device vendor and branded operating system name. This level of planning\ndemonstrates that UNC3524 understands incident response processes and tried to make their C2 traffic appear as legitimate to anyone that might\nscroll through DNS or session logs.\n\nAll QUIETEXIT C2 domains that Mandiant observed used Dynamic DNS providers. Dynamic DNS allows for threat actors to update the DNS\nrecords for domains in a near seamless fashion. When the C2s where inactive, the threat actor had the domains resolve to 127.0.0.1. However,\noccasionally the port numbers would change or VPS infrastructure would be used rather than compromised camera botnet. We suspected that\nwhen the threat actor experienced issues accessing a victim, they would troubleshoot using new infrastructure or different ports.\n\nIn some cases, the threat actor deployed a secondary backdoor as a means of alternate access into victim environments. This alternate access was\n[a REGEORG web shell previously placed on a DMZ web server. REGEORG is a web shell that creates a SOCKS proxy, keeping with UNC3524’s](https://advantage.mandiant.com/malware/malware--33065e77-067e-5554-a325-86f0e95968dc)\npreference for tunneling malware. Once inside the victim environment, the threat actor spent time to identify web servers in the victim\nenvironment and ensure they found one that was Internet accessible before copying REGEORG to it. They also took care to name the file so that it\nblended in with the application running on the compromised server. Mandiant also observed instances where UNC3542 used timestomping to\nalter the Standard Information timestamps of the REGEORG web shell to match other files in the same directory.\n\nUNC3542 only used these web shells when their QUIETEXIT backdoors stopped functioning and only to re-establish QUIETEXIT on another\nsystem in the network. Rather than use the public version of REGEORG published by Sensepost, UNC3542 used a still public but little-known\nversion of the web shell that is heavily obfuscated. This allowed them to bypass common signature-based detections for REGEORG.\n\n### Move Laterally\n\nOnce UNC3524 established a foothold in the network they demonstrated a very low malware footprint and instead relied on built-in Windows\nprotocols. During our incident response investigations, we traced most accesses to a victim appliance infected with QUIETEXIT. QUIETEXIT\nsupports the full functionality of SSH, and our observation is consistent with UNC3524 using it to establish a SOCKS tunnel into the victim\nenvironments. By standing up a SOCKS tunnel, the threat actor effectively plugs in their machine to an ethernet jack within the victim’s network.\nBy tunneling over SOCKS, the threat actor can execute tools to steal data from their own computer, leaving no traces of the tooling itself on victim\ncomputers.\n\nFigure 2: Tunneling through QUIETEXIT\n\n[To perform lateral movement to systems of interest, UNC3524 used a customized version of Impacket’s WMIEXEC. WMIEXEC uses Windows](https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py)\nManagement Instrumentation to establish a semi-interactive shell on a remote host. The utility provides a semi-interactive shell by writing\ncommand outputs to a file on the remote host and then printing the output to the terminal. The default Impacket version uses a hardcoded file\npath and filename structure for these output files, providing a detection opportunity. Mandiant has observed UNC3524 modifying the hardcoded\nfile path (\\\\127.0.0.1\\ADMIN$\\debug\\DEBUG.LOG) to evade basic detections for filenames such as Impacket’s default double underscore files.\nWe also observed the threat actor using the built-in `reg save command to save registry hives and extract LSA secrets offline.`\n\n\n-----\n\n### Complete Mission\n\nOnce UNC3524 successfully obtained privileged credentials to the victim’s mail environment, they began making Exchange Web Services (EWS)\nAPI requests to either the on-premises Microsoft Exchange or Microsoft 365 Exchange Online environment. In each of the UNC3524 victim\nenvironments, the threat actor would target a subset of mailboxes, focusing their attention on executive teams and employees that work in\ncorporate development, mergers and acquisitions, or IT security staff. It’s likely that the threat actor was targeting the IT security team as a\nmethod to determine if their operation had been detected.\n\nThe methods that UNC3524 used to authenticate to the Exchange infrastructure evolved throughout the course of the intrusions; this may be a\nresult of them periodically losing access due to the natural changes in corporate infrastructure or simply updating their tactics. They\nauthenticated to Exchange using the username and password of targeted accounts, using accounts holding ApplicationImpersonation rights, or\nusing Service Principal credentials. Each of these methods, their detections, and configuration recommendations can be found at Mandiant's\nUNC2452 Microsoft 365 Hardening Guide.\n\nOnce authenticated to the exchange infrastructure, UNC3524 made a series of EWS API requests to extract mail items from the target mailbox.\nFor each mailbox, the threat actor made a series of `GetFolder and` `FindFolder requests that returned data describing the mailbox, such as`\nthe number of unread messages and sub-folders within the specified folder.\n\n```\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n```\n```\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\n\n```\n```\n  xmlns:t=\"https://schemas.microsoft.com/exchange/services/2006/types\">\n <soap:Header>\n\n```\n```\n  <t:RequestServerVersion Version=\"Exchange2013\" />\n\n```\n```\n  <t:ExchangeImpersonation>\n\n```\n```\n  <t:ConnectingSID>\n\n```\n```\n   <t:PrimarySmtpAddress>target@victimorg.com</t:PrimarySmtpAddress>\n\n```\n```\n  </t:ConnectingSID>\n\n```\n```\n </t:ExchangeImpersonation>\n\n```\n```\n </soap:Header>\n\n```\n```\n <soap:Body>\n\n```\n```\n  <GetFolder xmlns=\"https://schemas.microsoft.com/exchange/services/2006/messages\"\n        xmlns:t=\"https://schemas.microsoft.com/exchange/services/2006/types\">\n\n```\n```\n   <FolderShape>\n\n```\n```\n    <t:BaseShape>Default</t:BaseShape>\n\n```\n```\n   </FolderShape>\n\n```\n```\n   <FolderIds>\n\n```\n```\n    <t:DistinguishedFolderId Id=\"Root\"/>\n\n```\n```\n   </FolderIds>\n\n```\n```\n  </GetFolder>\n\n```\n```\n </soap:Body>\n\n```\n```\n</soap:Envelope>\n\n```\n\nFigure 3: Sample EWS GetFolder request\n\nAfter the enumeration of the mailbox structure, the threat actor issued a `FindItem request with a Query Filter that selected all messages from a`\nspecific folder with a `DateTimeCreated greater than a specific date. The date in the filter corresponded to the last time the threat actor accessed`\nthe mailbox. This meant that the threat actor would acquire all newly created items in the mailbox since the last time they had extracted data. This\nfollows an approach that Mandiant has previously observed with APT29. Rather than target a mailbox using specific keywords, the threat actor\ninstead extracted the entire contents over a particular date range.\n\n\n-----\n\n```\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n```\n```\n<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\n```\n```\n  xmlns:m=\"https://schemas.microsoft.com/exchange/services/2006/messages\"\n\n```\n```\n  xmlns:t=\"https://schemas.microsoft.com/exchange/services/2006/types\"\n\n```\n```\n  xmlns:soap=\"https://schemas.xmlsoap.org/soap/envelope/\">\n\n```\n```\n <soap:Header>\n\n```\n```\n  <t:RequestServerVersion Version=\"Exchange2013\" />\n\n```\n```\n  <t:ExchangeImpersonation>\n\n```\n```\n  <t:ConnectingSID>\n\n```\n```\n   <t:PrimarySmtpAddress>target@victimorg.com</t:PrimarySmtpAddress>\n\n```\n```\n  </t:ConnectingSID>\n\n```\n```\n </t:ExchangeImpersonation>\n\n```\n```\n </soap:Header>\n\n```\n```\n <soap:Body>\n\n```\n```\n  <m:FindItem Traversal=\"Shallow\">\n\n```\n```\n   <m:ItemShape>\n\n```\n```\n    <t:BaseShape>IdOnly</t:BaseShape>\n\n```\n```\n    <t:AdditionalProperties>\n\n```\n```\n     <t:FieldURI FieldURI=\"item:Subject\" />\n\n```\n```\n     <t:FieldURI FieldURI=\"item:DateTimeCreated \" />\n\n```\n```\n    </t:AdditionalProperties>\n\n```\n```\n   </m:ItemShape>\n\n```\n```\n   <m:IndexedPageItemView MaxEntriesReturned=\"100\" Offset=\"0\" BasePoint=\"Beginning\" />\n\n```\n```\n   <m:Restriction>  \n\n```\n```\n    <t:IsGreaterThan>\n\n```\n```\n     <t:FieldURI FieldURI=\"item:DateTimeCreated \" />\n\n```\n```\n     <t:FieldURIOrConstant>\n\n```\n```\n      <t:Constant Value=\"2022-01-01T00:00:00\" />\n\n```\n```\n     </t:FieldURIOrConstant>\n\n```\n```\n    </t:IsGreaterThan>\n\n```\n```\n   </m:Restriction>\n\n```\n```\n   <m:SortOrder>\n\n```\n```\n    <t:FieldOrder Order=\"Descending\">\n\n```\n```\n     <t:FieldURI FieldURI=\"item:DateTimeCreated\" />\n\n```\n```\n    </t:FieldOrder>\n\n```\n```\n   </m:SortOrder>\n\n```\n```\n   <m:ParentFolderIds>\n\n```\n```\n    <t:DistinguishedFolderId Id=\"inbox\" />\n\n```\n```\n   </m:ParentFolderIds>\n\n```\n```\n  </m:FindItem>\n\n```\n```\n </soap:Body>\n\n```\n\nFigure 4: Sample EWS FindItem request\n\nFinally, the threat actor iterated through each message identifier returned in the `FindItem response and made a` `GetItem request. The threat`\nactor set the `IncludeMimeContent parameter to true for the request, which resulted in Exchange returning the message in MIME format. This`\nis important because the MIME message includes both the message body and any attachments. It is worth noting that if the messages were\n\n\n-----\n\nencrypted using PGP, SMIME, Office 365 Message Encryption (OME), or other encryption technology, then the `GetItem response will only`\ncontain the ciphertext or in the case of OME, a link to authenticate and view the real message.\n\n```\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n\n```\n```\n<soap:Envelope\n\n```\n```\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\n```\n```\n xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n\n```\n```\n xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"\n\n```\n```\n xmlns:t=\"https://schemas.microsoft.com/exchange/services/2006/types\">\n\n```\n```\n <soap:Body>\n\n```\n```\n  <GetItem\n\n```\n```\n   xmlns=\"https://schemas.microsoft.com/exchange/services/2006/messages\"\n   xmlns:t=\"https://schemas.microsoft.com/exchange/services/2006/types\">\n\n```\n```\n   <ItemShape>\n\n```\n```\n    <t:BaseShape>Default</t:BaseShape>\n\n```\n```\n    <t:IncludeMimeContent>true</t:IncludeMimeContent>\n\n```\n```\n   </ItemShape>\n\n```\n```\n   <ItemIds>\n\n```\n```\n    <t:ItemId Id=\"<ID OF MESSAGE>\" ChangeKey=\"CQAAAB\" />\n\n```\n```\n   </ItemIds>\n\n```\n```\n  </GetItem>\n </soap:Body>\n\n```\n```\n</soap:Envelope>\n\n```\n\nFigure 5: Sample EWS GetItem request\n\n## Operational Security and Infrastructure\n\nThroughout their operations, the threat actor demonstrated sophisticated operational security that we see only a small number of threat actors\ndemonstrate. The threat actor evaded detection by operating from devices in the victim environment’s blind spots, including servers running\nuncommon versions of Linux and network appliances running opaque OSes. These devices and appliances were running versions of operating\nsystems that were unsupported by agent-based security tools, and often had an expected level of network traffic that allowed the attackers to\nblend in. The threat actor’s use of the QUIETEXIT tunneler allowed them to largely live off the land, without the need to bring in additional tools,\nfurther reducing the opportunity for detection. This allowed UNC3524 to remain undetected in victim environments for, in some cases, upwards\nof 18 months.\n\nThe C2 systems that Mandiant identified were primarily legacy conference room camera systems sold by LifeSize, Inc. and in one instance, a DLink IP camera. These camera systems appeared to be infected, likely with the server component of QUIETEXIT. These cameras were directly\nInternet exposed, possibly through an improper UPnP configuration, and may have been running older firmware. Mandiant suspects that default\ncredentials, rather than an exploit, were the likely mechanism used to compromise these devices and form the IoT botnet used by UNC3524.\nSimilar to the use of embedded network devices, UNC3524 can avoid detection by operating from compromised infrastructure connected directly\nto the public Internet such as IP cameras where typical antivirus and security monitoring may be absent.\n\n## Detection\n\nUNC3524’s use of compromised appliances makes host-based hunting and detection extremely difficult. The best opportunity for detection\nremains in network-based logging, specifically monitoring traffic at the layer 7 level. Mandiant recommends hunting for traffic tagged as the\n“SSH” application egressing environments over ports other than 22. This traffic should be relatively small, and any findings should be\ninvestigated. Organizations can also look for outbound SSH traffic originating from IP addresses that are unknown or not in asset management\nsystems. These source systems are more likely to be appliances that aren’t centrally managed. Finally, large volumes of network traffic originating\nfrom the “management” interfaces of appliances such as NAS arrays and load balancers should be investigated as suspicious as well.\n\nUNC3524 targets opaque network appliances because they are often the most unsecure and unmonitored systems in a victim environment.\nOrganizations should take steps to inventory their devices that are on the network and do not support monitoring tools. Each device likely has\nvendor-specific hardening actions to take to ensure that the proper logging is enabled, and logs are forwarded to a central repository.\nOrganizations can also take steps to use network access controls to limit or completely restrict egress traffic from these devices.\n\n\n-----\n\nFor host-based hunting, Mandiant recommends hunting for QUIETEXIT on devices using the provided grep commands. Most appliances that\nprovide shell access should have the grep binary available.\n\nFind QUIETEXIT hard-coded byte string using grep:\n\n```\ngrep \"\\x48\\x8b\\x3c\\xd3\\x4c\\x89\\xe1\\xf2\\xae\" -rs /\n\n```\n\nFind QUIETEXIT by looking for the hard-coded password value:\n\n```\ngrep '\\xDD\\xE5\\xD5\\x97\\x20\\x53\\x27\\xBF\\xF0\\xA2\\xBA\\xCD\\x96\\x35\\x9A\\xAD\\x1C\\x75\\xEB\\x47' -rs /\n\n```\n\nFind QUIETEXIT persistence mechanisms in the appliance’s rc.local directory by looking for the command line arguments:\n\n```\ngrep -e \" -[Xx] -p [[:digit:]{2,6}]\" -rs /etc\n\n```\n\n## Remediation and Hardening\n\n[Mandiant has published remediation and hardening strategies for Microsoft 365.](https://www.mandiant.com/resources/remediation-and-hardening-strategies-for-microsoft-365-to-defend-against-unc2452)\n\n## Attribution\n\nThe methodologies Mandiant observed during UNC3524 intrusions overlapped with techniques used by multiple Russia-based espionage threat\n[actors including both EWS impersonation and SPN credential addition. Mandiant has only observed APT29 performing SPN credential addition;](https://www.mandiant.com/resources/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor)\nhowever, this technique has been reported on publicly since early 2019. The NSA has previously reported automated password spraying using\n[Kubernetes, Exchange Exploitation, and REGEORG as associated with APT28. While the activity reported by the NSA used TOR and commercial](https://media.defense.gov/2021/Jul/01/2002753896/-1/-1/1/CSA_GRU_GLOBAL_BRUTE_FORCE_CAMPAIGN_UOO158036-21.PDF)\nVPNs, UNC3524 primarily used compromised internet facing devices. One interesting aspect of UNC3524’s use of REGEORG was that it matched\nidentically with the version publicly reported by the NSA as used by APT28. At the time of writing, Mandiant cannot conclusively link UNC3524 to\nan existing group currently tracked by Mandiant.\n\n## Acknowledgements\n\nWe would like to thank our incident response consultants, Managed Defense responders, and FLARE reverse engineers who enabled this\nresearch. Thanks to Kirstie Failey, Jake Nicastro, John Wolfram, Sarah Hawley and Nick Richard for technical review, and Ryan Hall and Alyssa\nRahman for research contributions.\n\n## MITRE ATT&CK\n\nMandiant has observed UNC3524 use the following techniques.\n\n**ATT&CK Tactic Category** **Techniques**\n\nDefense Evasion T1027: Obfuscated Files or Information\n\nDiscovery T1012: Query Registry\n\nT1016: System Network Configuration Discovery\n\nT1049: System Network Connections Discovery\n\nT1057: Process Discovery\n\nT1518: Software Discovery\n\nCredential Access T1003.004: LSA Secrets\n\nT1003.006: DCSync\n\nT1111: Two-Factor Authentication Interception\n\nCollection T1114: Email Collection\n\nT1114.002: Remote Email Collection\n\nLateral Movement T1021.004: SSH\n\n\n-----\n\nPersistence T1037.004: RC Scripts\n\nT1098.001: Additional Cloud Credentials\n\nT1505.003: Web Shell\n\nCommand and Control T1071: Application Layer Protocol\n\nT1090.003: Multi-hop Proxy\n\nT1095: Non-Application Layer Protocol\n\nT1572: Protocol Tunneling\n\nT1573.002: Asymmetric Cryptography\n\nResource Development T1583.003: Virtual Private Server\n\nT1584: Compromise Infrastructure\n\nT1608.003: Install Digital Certificate\n\nExecution T1059.001: PowerShell\n\nT1059.003: Windows Command Shell\n\n## YARA Signatures\n\nNote: These rules are designed to broadly capture suspicious files and are not designed to detect a particular malware or threat.\n\n```\nrule QUIETEXIT_strings\n\n```\n```\n{\n\n```\n```\n  meta:\n\n```\n```\n    author = \"Mandiant\"\n\n```\n```\n    date_created = \"2022-01-13\"\n\n```\n```\n    date_modified = \"2022-01-13\"\n\n```\n```\n    rev = 1\n\n```\n```\n  strings:\n\n```\n```\n    $s1 = \"auth-agent@openssh.com\"\n\n```\n```\n    $s2 = \"auth-%.8x-%d\"\n\n```\n```\n    $s3 = \"Child connection from %s:%s\"\n\n```\n```\n    $s4 = \"Compiled without normal mode, can't run without -i\"\n\n```\n```\n    $s5 = \"cancel-tcpip-forward\"\n\n```\n```\n    $s6 = \"dropbear_prng\"\n\n```\n```\n    $s7 = \"cron\"\n\n```\n```\n  condition:\n\n```\n```\n    uint32be(0) == 0x7F454C46 and filesize < 2MB and all of them\n\n```\n```\n}\n\n```\n\n-----\n\n```\nrule REGEORG_Tuneller_generic\n\n```\n```\n{\n\n```\n```\n  meta:\n\n```\n```\n    author = \"Mandiant\"\n\n```\n```\n    date_created = \"2021-12-20\"\n\n```\n```\n    date_modified = \"2021-12-20\"\n\n```\n```\n    md5 = \"ba22992ce835dadcd06bff4ab7b162f9\"\n\n```\n```\n  strings:\n\n```\n```\n    $s1 = \"System.Net.IPEndPoint\"\n\n```\n```\n    $s2 = \"Response.AddHeader\"\n\n```\n```\n    $s3 = \"Request.InputStream.Read\"\n\n```\n```\n    $s4 = \"Request.Headers.Get\"\n\n```\n```\n    $s5 = \"Response.Write\"\n\n```\n```\n    $s6 = \"System.Buffer.BlockCopy\"\n\n```\n```\n    $s7 = \"Response.BinaryWrite\"\n    $s8 = \"SocketException soex\"\n\n```\n```\n  condition:\n\n```\n```\n    filesize < 1MB and 7 of them\n\n```\n```\n}\n\n```\n```\nrule UNC3524_sha1\n\n```\n```\n{\n\n```\n```\n  meta:\n\n```\n```\n    author = \"Mandiant\"\n\n```\n```\n    date_created = \"2022-01-19\"\n\n```\n```\n    date_modified = \"2022-01-19\"\n\n```\n```\n  strings:\n\n```\n```\n    $h1 = { DD E5 D5 97 20 53 27 BF F0 A2 BA CD 96 35 9A AD 1C 75 EB 47 }\n\n```\n```\n  condition:\n\n```\n```\n    uint32be(0) == 0x7F454C46 and filesize < 10MB and all of them\n\n```\n```\n}\n\n```\n\n## Indicators\n\n**MALWARE FAMILY** **Indicator**\n\nQUIETEXIT Dynamic DNS cloudns.asia\n\ndynu.net\n\nmywire.org\n\nwebredirect.org\n\n\n**MALWARE**\n**FAMILY**\n\n\nREGEORG\nGitHub\nversion\n\n\n**MD5** **SHA1** **SHA256**\n\nba22992ce835dadcd06bff4ab7b162f9 3d4dcc859c6ca7e5b36483ad84c9ceef34973f9a 7b5e3c1c06d82b3e7309C258dfbd4bfcd476c8ffcb4\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2022/2022.05.02.UNC3524/UNC3524_%20Eye%20Spy%20on%20Your%20Email%20_%20Mandiant.pdf"
    ],
    "report_names": [
        "UNC3524_ Eye Spy on Your Email _ Mandiant"
    ],
    "threat_actors": [
        {
            "id": "ff183540-67fb-4514-bd30-b4a264795901",
            "created_at": "2022-10-25T16:07:24.367762Z",
            "updated_at": "2025-03-27T02:02:10.192778Z",
            "deleted_at": null,
            "main_name": "UNC3524",
            "aliases": [],
            "source_name": "ETDA:UNC3524",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "94890f31-3a6c-447b-8995-5c5958efea28",
            "created_at": "2023-01-06T13:46:39.352776Z",
            "updated_at": "2025-03-27T02:00:03.05845Z",
            "deleted_at": null,
            "main_name": "UNC3524",
            "aliases": [],
            "source_name": "MISPGALAXY:UNC3524",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1652422944,
    "ts_modification_date": 1652422944,
    "files": {
        "pdf": "https://archive.orkl.eu/67f46c74653725c4e385c800f438eb8fd8805d05.pdf",
        "text": "https://archive.orkl.eu/67f46c74653725c4e385c800f438eb8fd8805d05.txt",
        "img": "https://archive.orkl.eu/67f46c74653725c4e385c800f438eb8fd8805d05.jpg"
    }
}