{
    "id": "52e4840f-73ff-46a8-b9c4-1a1e36db077a",
    "created_at": "2022-10-25T16:48:11.603447Z",
    "updated_at": "2025-03-27T02:13:09.673348Z",
    "deleted_at": null,
    "sha1_hash": "474e2d3e3f4a8c45f73a2c34ff568c3c7d51e400",
    "title": "Recent Cloud Atlas activity",
    "authors": "Kaspersky",
    "file_creation_date": "2019-09-16T18:04:45Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 330169,
    "plain_text": "# Recent Cloud Atlas activity\n\n**securelist.com/recent-cloud-atlas-activity/92016**\n\nBy GReAT\n\nAlso known as Inception, Cloud Atlas is an actor that has a long history of cyber-espionage\noperations targeting industries and governmental entities. We first reported Cloud Atlas in\n2014 and we’ve been following its activities ever since.\n\nFrom the beginning of 2019 until July, we have been able to identify different spear-phishing\ncampaigns related to this threat actor mostly focused on Russia, Central Asia and regions of\nUkraine with ongoing military conflicts.\n\n\n**Countries targeted by Cloud Atlas recently**\n\n\nCloud Atlas hasn’t changed its TTPs (Tactic Tools and Procedures) since 2018 and is still\nrelying on its effective existing tactics and malware in order to compromise high value\ntargets.\n\nThe Windows branch of the Cloud Atlas intrusion set still uses spear-phishing emails to\ntarget high profile victims. These emails are crafted with Office documents that use\nmalicious remote templates – whitelisted per victims – hosted on remote servers. We\n[described one of the techniques used by Cloud Atlas in 2017 and our colleagues at Palo Alto](https://securelist.com/an-undocumented-word-feature-abused-by-attackers/81899/)\nNetworks also wrote about it in November 2018.\n\nPreviously, Cloud Atlas dropped its “validator” implant named “PowerShower” directly, after\nexploiting the Microsoft Equation vulnerability (CVE-2017-11882) mixed with CVE-2018-0802.\nDuring recent months, we have seen a new infection chain, involving a polymorphic HTA, a\n\n\n-----\n\nnew and polymorphic VBS implant aimed at executing PowerShower, and the Cloud Atlas\nsecond stage modular backdoor that we disclosed five years ago in our first blogpost about\nthem and which remains unchanged.\n\n## Let’s meet PowerShower\n\nPowerShower, named and previously disclosed by Palo Alto Networks in their blogspot (see\nabove), is a malicious piece of PowerShell designed to receive PowerShell and VBS modules\nto execute on the local computer. This malware has been used since October 2018 by Cloud\nAtlas as a validator and now as a second stage. The differences in the two versions reside\nmostly in anti-forensics features for the validator version of PowerShower.\n\nThe PowerShower backdoor – even in its later developments – takes three commands:\n\n**Command** **Description**\n\n\n0x80 (Ascii\n“P”)\n\n0x79 (Ascii\n“O”)\n\n\nIt is the first byte of the magic PK. The implant will save the received content as a\nZIP archive under %TEMP%\\PG.zip.\n\nIt is the first byte of “On resume error”. The implant saves the received content as\na VBS script under “%APPDATA%\\Microsoft\\Word\\[A-Za-z]{4}.vbs” and executes it\nby using Wscript.exe\n\n\nDefault If the first byte doesn’t match 0x80 or 0x79, the content is saved as an XML file\nunder “%TEMP%\\temp.xml”. After that, the script loads the content of the file,\nparses the XML to get the PowerShell commands to execute, decodes them from\nBase64 and invokes IEX.\nAfter executing the commands, the script deletes “%TEMP%\\temp.xml” and sends\nthe content of “%TEMP%\\pass.txt” to the C2 via an HTTP POST request.\n\nA few modules deployed by PowerShower have been seen in the wild, such as:\n\nA PowerShell document stealer module which uses 7zip (present in the received\nPG.zip) to pack and exfiltrate *.txt, *.pdf, *.xls or *.doc documents smaller than 5MB\n\n\n-----\n\nmodified during the last two days;\nA reconnaissance module which retrieves a list of the active processes, the current\nuser and the current Windows domain. Interestingly, this feature is present in\nPowerShower but the condition leading to the execution of that feature is never met\nin the recent versions of PowerShower;\nA password stealer module which uses the opensource tool LaZagne to retrieve\npasswords from the infected system.\n\nWe haven’t yet seen a VBS module dropped by this implant, but we think that one of the VBS\nscripts dropped by PowerShower is a dropper of the group’s second stage backdoor\n[documented in our article back in 2014.](https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/)\n\n## And his new friend, VBShower\n\nDuring its recent campaigns, Cloud Atlas used a new “polymorphic” infection chain relying\nno more on PowerShower directly after infection, but executing a polymorphic HTA hosted\non a remote server, which is used to drop three different files on the local system.\n\nA backdoor that we name VBShower which is polymorphic and replaces\nPowerShower as a validator;\nA tiny launcher for VBShower ;\nA file computed by the HTA which contains contextual data such as the current user,\ndomain, computer name and a list of active processes.\n\nThis “polymorphic” infection chain allows the attacker to try to prevent IoC-based defence,\nas each code is unique by victim so it can’t be searched via file hash on the host.\n\n\n-----\n\nThe VBShower backdoor has the same philosophy of the validator version of PowerShower.\nIts aim is to complicate forensic analysis by trying to delete all the files contained in\n“%APPDATA%\\..\\Local\\Temporary Internet Files\\Content.Word” and “%APPDATA%\\..\\Local\nSettings\\Temporary Internet Files\\Content.Word\\”.\n\nOnce these files have been deleted and its persistence is achieved in the registry, VBShower\nsends the context file computed by the HTA to the remote server and tries to get via HTTP a\nVBS script to execute from the remote server every hour.\n\nAt the time of writing, two VBS files have been seen pushed to the target computer by\nVBShower. The first one is an installer for PowerShower and the second one is an installer\nfor the Cloud Atlas second stage modular backdoor which communicates to a cloud storage\nservice via Webdav.\n\n## Final words\n\nCloud Atlas remains very prolific in Eastern Europe and Central Asia. The actor’s massive\nspear-phishing campaigns continue to use its simple but effective methods in order to\ncompromise its targets.\n\n\n-----\n\nUnlike many other intrusion sets, Cloud Atlas hasn’t chosen to use open source implants\nduring its recent campaigns, in order to be less discriminating. More interestingly, this\n[intrusion set hasn’t changed its modular backdoor, even five years after its discovery.](https://securelist.com/cloud-atlas-redoctober-apt-is-back-in-style/68083/)\n\n## IoCs\n\n### Some emails used by the attackers\n\ninfocentre.gov@mail.ru\nmiddleeasteye@asia.com\nsimbf2019@mail.ru\nworld_overview@politician.com\ninfocentre.gov@bk.ru\n\n### VBShower registry persistence\n\nKey : HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\[a-f0-9A-F]{8}\nValue : wscript //B “%APPDATA%\\[A-Za-z]{5}.vbs”\n\n### VBShower paths\n\n%APPDATA%\\[A-Za-z]{5}.vbs.dat\n%APPDATA%\\[A-Za-z]{5}.vbs\n%APPDATA%\\[A-Za-z]{5}.mds\n\n### VBShower C2s\n\n176.31.59.232\n144.217.174.57\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/i3x6bxmcche1jwn0j91tll3ln3shzyk6"
    ],
    "report_names": [
        "Kaspersky_Recent-Cloud-Atlas-activity(08-12-2019)"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "02c9f3f6-5d10-456b-9e63-750286048149",
            "created_at": "2022-10-25T16:07:23.722884Z",
            "updated_at": "2025-03-27T02:02:09.945869Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK 116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "Inception Framework",
                "Operation Cloud Atlas",
                "Operation RedOctober",
                "The Rocra"
            ],
            "source_name": "ETDA:Inception Framework",
            "tools": [
                "Lastacloud",
                "PowerShower",
                "VBShower"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "04a7ebaa-ebb1-4971-b513-a0c86886d932",
            "created_at": "2023-01-06T13:46:38.784965Z",
            "updated_at": "2025-03-27T02:00:02.91817Z",
            "deleted_at": null,
            "main_name": "Inception Framework",
            "aliases": [
                "ATK116",
                "Blue Odin",
                "Clean Ursa",
                "Cloud Atlas",
                "G0100"
            ],
            "source_name": "MISPGALAXY:Inception Framework",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041589,
    "ts_creation_date": 1568657085,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/474e2d3e3f4a8c45f73a2c34ff568c3c7d51e400.pdf",
        "text": "https://archive.orkl.eu/474e2d3e3f4a8c45f73a2c34ff568c3c7d51e400.txt",
        "img": "https://archive.orkl.eu/474e2d3e3f4a8c45f73a2c34ff568c3c7d51e400.jpg"
    }
}