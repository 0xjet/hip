{
    "id": "3d160f4c-af9f-4d3f-8e8f-40e876f610b5",
    "created_at": "2023-01-12T15:03:54.90713Z",
    "updated_at": "2025-03-27T02:16:25.884113Z",
    "deleted_at": null,
    "sha1_hash": "f69068574572d2cf8bdd3dacf2c86b834c73598c",
    "title": "2020-12-21 - SolarWinds-SUNBURST- DGA or DNS Tunneling-",
    "authors": "",
    "file_creation_date": "2022-05-28T18:58:48Z",
    "file_modification_date": "2022-05-28T18:58:48Z",
    "file_size": 13449132,
    "plain_text": "# SolarWinds/SUNBURST: DGA or DNS Tunneling?\n\n**[ironnet.com/blog/a-closer-look-at-the-solarwinds/sunburst-malware-dga-or-dns-tunneling](https://www.ironnet.com/blog/a-closer-look-at-the-solarwinds/sunburst-malware-dga-or-dns-tunneling)**\n\n[Back to IronNet Blog](https://www.ironnet.com/blog)\n[Threat Research](https://www.ironnet.com/blog/tag/threat-research)\n\n## It's a subtle, but important, distinction for identifying attackers' behaviors — and predicting their next moves\n\nBy Peter Rydzynski, IronNet Threat Analysis Lead\n\n\n-----\n\nDec 21, 2020\n\n[As we continue unpacking and analyzing the SolarWinds attack, which FireEye has](https://www.ironnet.com/blog/analysis-solarwinds-supply-chain-attack)\n[described as a “highly evasive” Domain Generation Algorithm (DGA) incident, we first need](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\nto agree on terminology before we can move forward with identifying and analyzing the\nobservable behaviors.\n\nWhile much of the reporting about the SUNBURST malware describes its use of DGA for\ncommand and control, we must consider whether “true” DGA behavior was at play. Could it\nreally be DNS Tunneling? There is a subtle difference -- but this difference could have a\nsignificant impact on how we identify behaviors and start to discern the adversary’s possible\n[next steps. See, for example, previous analysis on how to detect DNS Tunneling.](https://www.ironnet.com/blog/chirp-of-the-poisonfrog)\n\n## DGA or DNS ? A question that’s worth a deeper look.\n\n[The](https://attack.mitre.org/) [MITRE ATT&CK Ⓡ](https://attack.mitre.org/) [Framework describes DGA (technique T1568.002) as follows:](https://attack.mitre.org/techniques/T1568/002/)\n\n_“Adversaries may make use of Domain Generation Algorithms (DGAs) to dynamically identify_\n_a destination domain for command and control traffic rather than relying on a list of static_\n_IP addresses or domains. This has the advantage of making it much harder for defenders to_\n_block, track, or take over the command and control channel, as there potentially could be_\n_thousands of domains that malware can check for instructions.”_\n\n\n-----\n\nATT&CK does not have an explicit technique assigned for DNS Tunneling; instead, itⓇ\nidentifies this technique as a sub-technique of Command and Control Over Application Layer\nProtocol, described as follows:\n\n_“Adversaries may communicate using the Domain Name System (DNS) application layer_\n_protocol to avoid detection/network filtering by blending in with existing traffic. Commands to_\n_the remote system, and often the results of those commands, will be embedded within the_\n_protocol traffic between the client and server.”_\n\nTo summarize the two descriptions above, DGA is the means for malicious code to identify\ncommand and control servers and avoid blocking or other defensive measures. On the other\nhand, DNS Tunneling is the means for malicious code to pass information to the command\nand control server and allow the server, in turn, to pass commands or other information back\nto the implanted malware.\n\nThis distinction may seem subtle, but is critical when identifying behaviors, as well as\ndiscerning which actions the malicious actor could possibly take.\n\nWorking off the two descriptions above, we can see that the main distinction between DGA\nand DNS Tunneling is the structure of the queries and, most notably, the intent behind the\nqueries. The effectiveness of DGA heavily relies on the structure of the queries and the\nhierarchical nature of the DNS protocol. Specifically, the top level domain under the registry\nsuffix (“google” in “drive.google.com”) must be dynamically generated; otherwise,\nidentification of C2 traffic and subsequent blocking becomes relatively simple. Relating this\nback to the SUNBURST example, if defenders were to have put in firewall block rules to stop\nall queries to “*.avsvmcloud[.]com”, it would effectively stop all C2 communications, thereby\nmaking this a less viable option for resilient C2. The intent behind the DNS communications\nobserved does not appear to be identifying where a malicious C2 server is and how to reach\nit. Due to the ownership of the domain and control over the authoritative domain name\nserver, the malicious code was already able to communicate with its C2 server.\n\n## SUNBURST: a case for DNS Tunneling\n\nThis second look leads us to the DNS Tunneling angle. The use case for DNS Tunneling is\nto enable communication between malware and C2 servers over the DNS protocol. Again,\nwith SUNBURST, research around the structure and content of the DNS queries to\n“avsvmcloud[.]com” has shown that the lowest level subdomain label used for these queries\nis encoded data that corresponds to the active directory domain name of the infected\nnetwork. This does not lend itself to the DGA use case, as the top domain under the registry\nsuffix is not changing and makes blocking such traffic at the firewall trivial. This does,\nhowever, provide the threat actor with accurate information about which network — and\npossibly even which infected host — was making the query, a critical function when\nmanaging a vast number of infections across a broad set of environments. Furthermore, the\n\n\n-----\n\nresponses to these queries are not indicative of the actual IP addresses for C2 servers.\nRather, they indicate the command or action that the threat actor wants the malicious\nimplants to take. This is exactly the way DNS Tunneling functions.\n\n## IronNet’s DNS Tunneling analytic\n\nIronNet’s DNS Tunneling analytic detects the use of DNS traffic as a covert network channel.\nData can be hidden in DNS messages using encoded subdomain labels and resource\nrecords, and then transferred through the normal domain name resolution process. DNS\nTunneling may indicate the presence of adversary communications with implanted malware\nor covert transmission of sensitive information from the enterprise. There are a number of\nmalicious tools that have leveraged this technique, including Pisloader and ALMA\nCommunicator, as well as point-of-sale malware, such as Multigrain/NewPosThings, which\nhave used DNS Tunneling to transfer credential and credit card information.\n\nIn the case of SUNBURST, the malware utilized DNS Tunneling to relay information about\nthe infected network. Researchers have determined that the encoded subdomain labels at a\nminimum transmit the domain name of the infected host (which IronNet has validated) and\nlikely pass additional information about the infected system. The resolved IP addresses,\ntransmitted in the returned A record response, are in turn used to provide instructions back to\nthe malware.\n\n## Moving forward post-SUNBURST\n\n[The gravity of the SolarWinds/SUNBURST attack is yet to be determined. In the meantime,](https://www.nytimes.com/2020/12/17/us/politics/russia-cyber-hack-trump.html)\n[we will continue to share our analysis, including updates by my colleague Adam Hlavek on](https://www.ironnet.com/blog/russian-cyber-attack-campaigns-and-actors)\nthe Russian cyber attack threat landscape at large, for the greater good of collective,\nwidespread, and fast recovery of this rampant attack.\n\nAbout Ironnet\n\nFounded in 2014 by GEN (Ret.) Keith Alexander, IronNet, Inc. (NYSE: IRNT) is a global\ncybersecurity leader that is transforming how organizations secure their networks by\ndelivering the first-ever Collective Defense platform operating at scale. Employing a number\nof former NSA cybersecurity operators with offensive and defensive cyber experience,\nIronNet integrates deep tradecraft knowledge into its industry-leading products to solve the\nmost challenging cyber problems facing the world today.\n\n[Back to IronNet Blog](https://www.ironnet.com/blog)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-21 - SolarWinds-SUNBURST- DGA or DNS Tunneling-.pdf"
    ],
    "report_names": [
        "2020-12-21 - SolarWinds-SUNBURST- DGA or DNS Tunneling-.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535834,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1653764328,
    "ts_modification_date": 1653764328,
    "files": {
        "pdf": "https://archive.orkl.eu/f69068574572d2cf8bdd3dacf2c86b834c73598c.pdf",
        "text": "https://archive.orkl.eu/f69068574572d2cf8bdd3dacf2c86b834c73598c.txt",
        "img": "https://archive.orkl.eu/f69068574572d2cf8bdd3dacf2c86b834c73598c.jpg"
    }
}