{
    "id": "49060ddb-6020-48df-bb73-4b90bc43cf89",
    "created_at": "2023-01-12T15:02:28.960134Z",
    "updated_at": "2025-03-27T02:16:28.876962Z",
    "deleted_at": null,
    "sha1_hash": "b0375a2df073a1ef4209557ee54c751815fe3cb4",
    "title": "2022-03-07 - PHOREAL Malware Targets the Southeast Asian Financial Sector",
    "authors": "",
    "file_creation_date": "2022-05-28T19:53:09Z",
    "file_modification_date": "2022-05-28T19:53:09Z",
    "file_size": 1167654,
    "plain_text": "# PHOREAL Malware Targets the Southeast Asian Financial Sector\n\n**[elastic.github.io/security-research/intelligence/2022/03/02.phoreal-targets-southeast-asia-financial-sector/article/](https://elastic.github.io/security-research/intelligence/2022/03/02.phoreal-targets-southeast-asia-financial-sector/article/)**\n\n[PHOREAL](https://elastic.github.io/security-research/tags/#phoreal) [RIZZO](https://elastic.github.io/security-research/tags/#rizzo) [Malware](https://elastic.github.io/security-research/tags/#malware) [Backdoor](https://elastic.github.io/security-research/tags/#backdoor)\n\n\n-----\n\n-----\n\n2022-03-07\n\n## Preamble¶\n\nElastic Security has identified an ongoing campaign targeting a Vietnamese financial services institution with the PHOREAL/RIZZO\nbackdoor. While this malware has been in use for some time, this is the first time that we have observed it loading into memory as a\ndefense evasion and campaign protection technique. Upon analysis of our own observations and previously reported information, we are\ntracking this activity group (malware + technique + victimology) as REF4322.\n\n### What is the threat?¶\n\nPHOREAL/RIZZO is a backdoor allowing initial victim characterization and follow-on post-exploitation operations to compromise the\nconfidentiality of organizations’ data. It has been reported in other research as being used exclusively by APT32 (AKA SeaLotus,\nOceanLotus, APT-C-00, Group G0050).\n\n### What is the impact?¶\n\nAPT32 largely targets victims with political or economic interests in Southeast Asia, specifically Vietnam.\n\n### What is Elastic doing about it?¶\n\nElastic Security detailed how to triage one of these threat alerts, extracted observables for endpoint and network filtering, and produced a\nnew malware signature for identification and mitigation of the threat across the fleet of deployed Elastic Agents.\n\n## Investigation Details¶\n\nWhile conducting Threat Discovery & Monitoring operations, Elastic Security researchers identified a cluster of `shellcode_thread`\nWindows memory protection alerts generated from an Elastic Agent endpoint sensor. These particular alerts were interesting because they\nall occurred within the same cluster, and unusually they targeted the `control.exe process. The Windows` `control.exe process`\nhandles the execution of Control Panel items, which are utilities that allow users to view and adjust computer settings.\n\nGenerally when we observe false positives for the `shellcode_thread protection, it is identified across a broad user-base and in many`\ncases it is attributed to various gaming anti-cheat or DRM (Digital Rights Management) mechanisms. In this case, a single cluster and a\nMicrosoft signed target process was atypical, and worthy of further investigation.\n\nNote\n\nYou can read more about Elastic Security’s memory protections [HERE and about in-memory attacks HERE.](https://www.elastic.co/blog/whats-new-elastic-security-7-15-0#:~:text=Memory%20threat%20protection%20for%20Windows%20endpoints)\n\nWith our interest piqued from the outlier characteristics of the alerts, we investigated further to validate and characterize the threat:\n\nTargeted process is a signed Windows binary\nUnsigned loaded .dll\n\n\n-----\n\n```\n  \"Ext\": {\n   \"mapped_address\": 1945501696,\n   \"mapped_size\": 21135360\n  },\n  \"path\": \"C:\\\\Windows\\\\SysWOW64\\\\tscon32.dll\",\n  \"code_signature\": [\n   {\n    \"exists\": false\n   }\n  ],\n  \"name\": \"tscon32.dll\",\n  \"hash\": {\n   \"sha1\": \"007970b7a42852b55379ef4cffa4475865c69d48\",\n   \"sha256\": \"ec5d5e18804e5d8118c459f5b6f3ca96047d629a50d1a0571dee0ac8d5a4ce33\",\n   \"md5\": \"2b6da20e4fc1af2c5dd5c6f6191936d1\"\n  }\n },\n...\n\n```\nStarting module from the alerting thread\n```\n...\n \"pe\": {\n  \"original_file_name\": \"CONTROL.EXE\"\n },\n \"name\": \"control.exe\",\n \"pid\": 5284,\n \"thread\": {\n  \"Ext\": {\n   \"start_address_module\": \"C:\\\\Windows\\\\SysWOW64\\\\tscon32.dll\",\n...\n\n```\nAlerting memory region metadata\n```\n...\n\"memory_region\": {`\n  \"region_size\": 73728,\n  \"region_protection\": \"RWX\",\n  \"allocation_base\": 81395712,\n  \"bytes_allocation_offset\": 0,\n  \"allocation_type\": \"PRIVATE\",\n  \"memory_pe_detected\": true,\n  \"region_state\": \"COMMIT\",\n  \"strings\": [\n   \"QSSSSSSh \",\n   ...\n   \"bad cast\",\n   \"Local\\\\{5FBC3F53-A76D-4248-969A-31740CBC8AD6}\",\n   \"Netapi32.dll\",\n   \"NetWkstaGetInfo\",\n   \"NetApiBufferFree\",\n   \"\\\\\\\\.\\\\pipe\\\\{A06F176F-79F1-473E-AF44-9763E3CB34E5}\",\n   \"list<T> too long\",\n   \"{FD5F8447-657A-45C1-894B-D533926C9B66}.dll\",\n   \"DllEntry\",\n   ...\n   \".?AVbad_alloc@std@@\",\n   \"C:\\\\Windows\\\\syswow64\\\\control.exe\",\n   \":z:zzzzzz7\",\n   ...\n   \"InternalName\",\n   \"mobsync.exe\",\n   \"LegalCopyright\",\n...\n\n```\nThread data for pivoting\n```\n...\n\"thread\": {\n \"Ext\": {\n  \"start_address_bytes\": \"8bff558bece8e6430000e8db43000050e8bb43000085c0751fff7508e8c94300\",\n  ...\n  \"start_address_bytes_disasm\": \"mov edi, edi\\npush ebp\\nmov ebp, esp\\ncall 0x000043f0\\ncall 0x000043ea\\npush eax\\ncall\n0x000043d0\\ntest eax, eax\\njnz 0x00000038\\npush dword ptr [ebp+0x08]\"\n },\n...\n\n```\n\n-----\n\nFrom the example alert we first identify the `start_address_module which is the dll/module where the thread began.`\n```\nC:\\\\Windows\\\\SysWOW64\\\\tscon32.dll is the start_address_module for the thread that we’ve alerted on. It’s also the only unsigned\n\n```\ndll loaded, so a great place to focus our efforts. When checking the hash value in VirusTotal, to identify previously disclosed information\nabout the sample, we did not see any results.\n\nDigging deeper, we looked at the `start_address_bytes, which are the first` `32 bytes of our alerting thread. We can use the value of the`\n```\nstart_address_bytes ( 8bff558bece8e6430000e8db43000050e8bb43000085c0751fff7508e8c94300 ) to search for pivots in\n\n```\nVirusTotal by querying `content: {8bff558bec56e83f3e0000e8343e000050e8143e000085c0752a8b750856e821} . We identified`\n[relatively few results, but they included the below entry first submitted in July 2021. \\](https://www.virustotal.com/gui/file/88f073552b30462a00d1d612b1638b0508e4ef02c15cf46203998091f0aef4de)\n\nVT result matching `start_address_bytes`\n[In researching the results from VirusTotal, we could see that threat researcher Felix Bilstein (@fxb_b) authored a crowdsourced YARA rule](https://twitter.com/fxb_b)\n[identifying this as the PHOREAL backdoor. Moving on to the](https://attack.mitre.org/software/S0158/) `CONTENT tab, we can compare some of the strings from our alert with what`\nhas been previously reported to VirusTotal.\n\nVT result CONTENT tab\nUsing the unique strings we identified above and the `start_address_bytes, we can create a YARA signature by converting the unique`\nstrings ( $a ) and the `start_address_bytes ( $b ) into hex values as shown below.`\n\nConverted YARA strings\n\n\n-----\n\n```\n     \\\\ \"\\\\.\\pipe\\{A06F176F-79F1-473E-AF44-9763E3CB34E5}\" ascii wide\n  $a1 = { 5C 00 5C 00 2E 00 5C 00 70 00 69 00 70 00 65 00 5C 00 7B 00 41 00 \n      30 00 36 00 46 00 31 00 37 00 36 00 46 00 2D 00 37 00 39 00 46 00 \n      31 00 2D 00 34 00 37 00 33 00 45 00 2D 00 41 00 46 00 34 00 34 00 \n      2D 00 39 00 37 00 36 00 33 00 45 00 33 00 43 00 42 00 33 00 34 00 \n      45 00 35 00 7D 00 }\n     \\\\ \"Local\\{5FBC3F53-A76D-4248-969A-31740CBC8AD6}\" ascii wide\n  $a2 = { 4C 00 6F 00 63 00 61 00 6C 00 5C 00 7B 00 35 00 46 00 42 00 43 00 \n      33 00 46 00 35 00 33 00 2D 00 41 00 37 00 36 00 44 00 2D 00 34 00 \n      32 00 34 00 38 00 2D 00 39 00 36 00 39 00 41 00 2D 00 33 00 31 00 \n      37 00 34 00 30 00 43 00 42 00 43 00 38 00 41 00 44 00 36 00 7D 00 }\n     \\\\ \"{FD5F8447-657A-45C1-894B-D533926C9B66}.dll\" ascii\n  $a3 = { 7B 46 44 35 46 38 34 34 37 2D 36 35 37 41 2D 34 35 43 31 2D 38 39 \n      34 42 2D 44 35 33 33 39 32 36 43 39 42 36 36 7D 2E 64 6C 6C }\n     \\\\ PHOREAL start_address_bytes sequence\n     \\\\ mov edi, edi; push ebp; mov ebp, esp; call 0x000043f0;\n     \\\\ call 0x000043ea; push eax; call 0x000043d0; test eax, eax;\n     \\\\ jnz 0x00000038; push dword ptr [ebp+0x08]\n  $str_addr = { 8B FF 55 8B EC 56 E8 3F 3E 00 00 E8 34 3E 00 00 50 E8 14 3E \n      00 00 85 C0 75 2A 8B 75 08 56 E8 21 }\ncondition:\n  2 of them\n\n```\nThis rule when deployed to the Elastic Agent will identify PHOREAL to customers and backstop prevention already provided through the\n```\nshellcode_thread memory protection (in customer environments with memory protection turned on). In our case this rule’s deployment\n\n```\n[also enabled the collection of the malicious thread using the same mechanism detailed in our Collecting Cobalt Strike Beacons article.](https://www.google.com/url?q=https://elastic.github.io/security-research/intelligence/2022/01/02.collecting-cobalt-strike-beacons/article/&sa=D&source=docs&ust=1646086759623888&usg=AOvVaw1ZQYkn2x6t_ARNPrNIKMBV)\n\nShortly after the new YARA artifact was deployed we had a new `malware_signature alert in hand with the malicious thread captured`\nfrom memory. Manual binary triage from our Malware Analysis and Reverse Engineering (MARE) Team quickly confirmed the sample was\nPHOREAL/RIZZO by comparing the structure and functions between our sample and past reporting. Further, they were able to extract an\n[RC4 encrypted domain from an RCDATA resource as described in a 2018 CYLANCE OceanLotus whitepaper.](https://docs.microsoft.com/en-us/windows/win32/menurc/rcdata-resource)\n\nRC4 decrypting binary embedded URL\nThe domain identified by MARE ( thelivemusicgroup[.]com ) currently resolves to `103.75.117[.]250 which is owned by`\nOneprovider[.]com, a dedicated server hosting company based out of Canada with data centers distributed globally.\n\nhttps://ipinfo.io/ query results for 103.75.117[.]250\n\n\n-----\n\n```\n \"ip\": \"103.75.117[.]250\",\n \"city\": \"Hong Kong\",\n \"region\": \"Central and Western\",\n \"country\": \"HK\",\n \"loc\": \"22.2783,114.1747\",\n \"org\": \"AS133752 Leaseweb Asia Pacific pte. ltd.\",\n \"timezone\": \"Asia/Hong_Kong\",\n \"asn\": {\n  \"asn\": \"AS133752\",\n  \"name\": \"Leaseweb Asia Pacific pte. ltd.\",\n  \"domain\": \"leaseweb.com\",\n  \"route\": \"103.75.117[.]0/24\",\n  \"type\": \"hosting\"\n },\n \"company\": {\n  \"name\": \"Oneprovider.com - Hong Kong Infrastructure\",\n  \"domain\": \"oneprovider[.]com\",\n  \"type\": \"hosting\"\n },\n \"privacy\": {\n  \"vpn\": false,\n  \"proxy\": false,\n  \"tor\": false,\n  \"relay\": false,\n  \"hosting\": true,\n  \"service\": \"\"\n },\n \"abuse\": {\n  \"address\": \"1500 Ste-Rose LAVAL H7R 1S4 Laval Quebec, Canada\",\n  \"country\": \"CA\",\n  \"email\": \"info@oneprovider.com\",\n  \"name\": \"ONE PROVIDER\",\n  \"network\": \"103.75.117[.]0/24\",\n  \"phone\": \"+1 514 286-0253\"\n },\n \"domains\": {\n  \"ip\": \"103.75.117[.]250\",\n  \"total\": 2,\n  \"domains\": [\n   \"thelivemusicgroup[.]com\",\n   \"cdn-api-cn-1[.]com\"\n  ]\n }\n\n```\nMost of the interesting information about the domain is privacy guarded, but the “Updated” and “Created” dates in the below figure might be\nuseful for bounding how long this domain has been used maliciously.\n\n\n-----\n\n[https://lookup.icann.org/lookup for](https://lookup.icann.org/lookup) `thelivemusicgroup[.]com`\n\nThe Elastic Agent appears to have been deployed post-compromise which limited our ability to determine the vector of initial access. A\n[2017 Mandiant report indicates that PHOREAL may be deployed in an “establish foothold” capacity to allow for victim triage and follow-on](https://www.mandiant.com/resources/cyber-espionage-apt32)\npost-exploitation tools.\n\n## Analysis¶\n\n[Elastic Security utilizes the Diamond Model to describe high-level relationships between the adversaries and victims of intrusions.](https://www.activeresponse.org/wp-content/uploads/2013/07/diamond.pdf)\n\n\n-----\n\nREF4322 Diamond Model Analysis\n\n### Adversary Assessment Justification¶\n\n[We assess with high confidence based on observed activity and previous reporting that REF4322 is APT32/OceanLotus and the actor](https://attack.mitre.org/groups/G0050/)\n[behind this incident. APT32 has been active since 2014 notably targeting Southeast Asian governments and businesses or other](https://www.mandiant.com/resources/cyber-espionage-apt32)\ninternational businesses with interests in Vietnam. APT32 is the only group currently identified as operating the PHOREAL backdoor, and\nour victim matches the geographic and industry vertical profile of typical and specific prior APT32 victims.\n\n## Conclusion¶\n\n### YARA Rules¶\n\nWe have created a YARA rule to identify this PHOREAL activity.\n\n### Defensive Recommendations¶\n\nThe following steps can be leveraged to improve a network’s protective posture:\n\n1. Enable Elastic Security Memory Protection on Windows endpoints\n2. Leverage the included YARA signatures above to determine if PHOREAL activity exists within your organization\n3. Monitor or block network traffic to or from identified network IOCs and remediate impacted systems accordingly.\n\n### References¶\n\nThe following research was referenced throughout the document:\n\n### Observables¶\n\n**Indicator** **Type** **Reference** **Notes**\n\n\n`thelivemusicgroup[.]com` domainname\n\n`103.75.117[.]250` ipv4addr\n\n`ec5d5e18804e5d8118c459f5b6f3ca96047d629a50d1a0571dee0ac8d5a4ce33` SHA256\n\n## Artifacts¶\n\nArtifacts are also available for download in both ECS and STIX format in a combined zip bundle.\n\n[Download indicators.zip](https://elastic.github.io/security-research/intelligence/2022/03/02.phoreal-targets-southeast-asia-financial-sector/indicators.zip)\n\nLast update: March 8, 2022\nCreated: March 7, 2022\n\n\nC2 domain encrypted in\nmalware\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-07 - PHOREAL Malware Targets the Southeast Asian Financial Sector.pdf"
    ],
    "report_names": [
        "2022-03-07 - PHOREAL Malware Targets the Southeast Asian Financial Sector.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535748,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1653767589,
    "ts_modification_date": 1653767589,
    "files": {
        "pdf": "https://archive.orkl.eu/b0375a2df073a1ef4209557ee54c751815fe3cb4.pdf",
        "text": "https://archive.orkl.eu/b0375a2df073a1ef4209557ee54c751815fe3cb4.txt",
        "img": "https://archive.orkl.eu/b0375a2df073a1ef4209557ee54c751815fe3cb4.jpg"
    }
}