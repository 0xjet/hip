{
    "id": "1b592252-7f29-4e3c-b229-f7d582c7df2b",
    "created_at": "2022-10-25T16:48:18.803667Z",
    "updated_at": "2025-03-27T02:16:25.629713Z",
    "deleted_at": null,
    "sha1_hash": "514d58015cd8abe0f9d65a85100dded872d707f8",
    "title": "Group5: Syria and the Iranian Connection - The Citizen Lab",
    "authors": "",
    "file_creation_date": "2016-08-03T09:51:31Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 5781235,
    "plain_text": "**Projects** **GLA2010** **In the News** **About**\n\n**Publications** **Newsletter** **People**\n\n**Archives** **Events** **Opportunities**\n\n**Contact**\n\n\n# Group5: Syria and the Iranian Connection\n\n**_August 2, 2016_**\n\n**[Tagged: Android, Cybersecurity, Iran, Malware, Mobile security, Surveillance, Syria, Targeted Threats](https://citizenlab.org/tag/android/)**\n\n**[Categories: Adam Hulcoop, Bahr Abdul Razzak, John Scott-Railton, Katie Kleemola, Matt Brooks, Reports and Briefings�](https://citizenlab.org/category/author/adam-hulcoop/)**\n\n## By John Scott-Railton,* Bahr Abdulrazzak,* Adam Hulcoop,* Matt Brooks,* & Katie Kleemola**\n\n***The Citizen Lab at the Munk School of Global Affairs, University of Toronto; **Lookout Inc.**\n\n**[Read the Associated Press exclusive.](http://bigstory.ap.org/article/6ab1ab75e89e480a9d12befd3fea4115/experts-iranian-link-attempted-hack-syrian-dissident)**\n\n**[Read the op-ed by Citizen Lab Director Ron Deibert.](https://www.washingtonpost.com/posteverything/wp/2016/08/02/how-foreign-governments-spy-using-email-and-powerpoint/)**\n\n**[Media coverage: BoingBoing.](https://boingboing.net/2016/08/02/iranians-connected-to-phishing.html)**\n\n# Executive Summary\n\n**This report describes an elaborately staged malware operation with targets in the Syrian opposition. The operators have used use a**\n\n**range of techniques to target Windows computers and Android phones with the apparent goal of penetrating the computers of well-**\n\n**connected individuals in the Syrian opposition.**\n\n**We first discovered the operation in late 2015 when a member of the Syrian opposition spotted a suspicious e-mail containing a�**\n\n**PowerPoint slideshow. From this initial message, we uncovered a watering hole website with malicious programs, malicious**\n\n**PowerPoint files, and Android malware, all apparently designed to appeal to members of the opposition.�**\n\n**Elements of the Syrian opposition have been targeted by malware campaigns since the early days of the conflict: regime-linked�**\n\n**malware groups, the Syrian Electronic Army, ISIS, and a group linked to Lebanon reported by FireEye in 2015 have all attempted to**\n\n**penetrate opposition computers and communications. Some of these operations are still active as of the time of writing. This report**\n\n**adds one more threat actor to the list: Group5, which we name to reflect the four other known malware groups.�**\n\n**Group5 stands out from the operations that have already been reported on: some of the tactics and tools used have not been**\n\n**observed in this conflict; the operators seem comfortable with Iranian Persian dialect tools and Iranian hosting companies; and they�**\n\n**appear to have run elements of the operation from Iranian IP space.**\n\n\n-----\n\n**Like a chameleon, Group5 borrows opposition text and slogans for e-mail messages and watering holes, showing evidence of good**\n\n**social engineering and targeting. However, Group5’s technical quality is low, and their operational security uneven. This is a**\n\n**common feature of many operations in the Syrian context: since the baseline security of many of the targets is very low, many**\n\n**successful threat actors seem to conserve (and in some cases not possess) more sophisticated techniques. We believe we**\n\n**identified Group5 early in its lifecycle, before all of the malware that had been staged and prepared could be deployed in a full�**\n\n**campaign.**\n\n**Our analysis indicates that Group5 is likely a new entrant in Syria, and we outline the circumstantial evidence pointing to an Iranian**\n\n**nexus. We do not conclusively attribute Group5 to a sponsor, although we suspect the interests of a state are present, in some**\n\n**form. Group5 is just the latest addition to an expanding cast of actors targeting Syrian opposition groups, and its entry into the**\n\n**conflict shows the continuing information security risks that they face.�**\n\n# Background: The Perpetual Targeting of the Syrian Opposition\n\n**[Syrians have experienced monitoring and blocking of their electronic communications for many years. As a result, many more](https://citizenlab.org/2014/11/citizen-lab-research-on-blue-coat-in-article-on-censorship-syria/)**\n\n**technically literate Syrians have familiarized themselves with VPNs and other tools to circumvent simple blocking, and achieve a**\n\n**degree of privacy. After the 2011 Uprising began, the regime disconnected telecommunications services in many areas controlled by**\n\n**opposition groups. This led, in these areas, to the widespread adoption of satellite internet connectivity, mostly via VSAT (Very Small**\n\n**Aperture Terminal) services like Tooway and iDirect, and to a lesser extent the use of BGAN (Broadband Global Area Network)**\n\n**terminals.**\n\n**At the same time, the Syrian opposition’s activities outside the country, both in neighboring countries like Turkey, as well as in the**\n\n**diaspora, dramatically increased. Much of this activity takes place over social networks, free e-mail accounts like Gmail (and Google**\n\n**Apps for Work), and via tools like Skype’s VoIP services.**\n\n\n-----\n\n**However, the shift towards social networks and other online tools has created new opportunities for the regime to target the**\n\n**opposition. Opposition members constantly share information, files, tools and programs, via social media. This highly-connected�**\n\n**environment enables them to be highly aware of changing events, and quickly mobilize resources. In addition, a number of online**\n\n**services, such as the Google Play Store, are blocked or restricted for Syria. As a result, a culture of sharing Android APK files has�**\n\n**also developed.**\n\n**The heavy reliance on popular online platforms, and regular sharing of tools, presents many opportunities to seed malicious files.�**\n\n**For the regime, a successful operation means a chance to regain visibility into the activities of groups within the geographic borders**\n\n**of Syria, while extending their reach outside into the diaspora. For other groups, such as ISIS, the digital vulnerability of the**\n\n**opposition presents an opportunity to develop a capability against opposition communications. The following section outlines several**\n\n**of these known threat actors.**\n\n## Regime-Linked Groups\n\n**The most well-known threat actor to target the Syrian Revolution is the Syrian Electronic Army (SEA). However, many of the targets**\n\n**of the SEA have been Western organizations, although the SEA continues to conduct lower-profile operations that include malware�**\n\n**against the opposition. Less notorious, although still the subject of reporting, are malware groups linked to the regime. These**\n\n**malware groups have been active since 2011, and have used a wide range of Commercial-Off-The-Shelf (COTS) Remote Access**\n\n**Trojans (RATs) to target the opposition. Typically, these groups bundle RATs with a wide range of documents and programs**\n\n**designed to appeal to the opposition. Over the years, these campaigns have included everything from “revolution plans,” lists of**\n\n**“wanted suspects,” to fake security and encryption tools. These campaigns have been extensively characterized by reports from the**\n\n**Citizen Lab, The Electronic Frontier Foundation, and private companies like TrendMicro and Kaspersky. A range of reports have**\n\n**documented these regime-linked campaigns over the years.**\n\n## Pro-Regime Groups Outside Syria\n\n**There is also evidence of pro-Assad groups outside Syria participating in malware campaigns against opposition. Notably, a group**\n\n**reported on in 2015 by FireEye (in collaboration with one of the authors of this report) used female avatars to send trojaned**\n\n**documents to high profile figures in opposition politics, aid, and armed groups. The operation yielded over 31,000 conversations,�**\n\n**and a trove of sensitive information about a variety of groups’ plans and activities. This group also made use of fake matchmaking**\n\n**websites and social media accounts to backstop their deception.**\n\n## ISIS-Linked Groups\n\n**[On a different side of conflict, the Citizen Lab �documented a malware operation linked to ISIS against the group ‘Raqqa is Being](https://citizenlab.org/2014/12/malware-attack-targeting-syrian-isis-critics/)**\n\n**Slaughtered Silently’ (RBSS) in 2015. The operators, masquerading as a group of RBSS sympathizers based in Canada, targeted**\n\n**victims with a file that claimed to contain locations of ISIS forces and US Airstrikes within Syria. The file actually contained custom�**\n\n**malware that collected and transmitted information about the infected computer. The report concluded that there was strong**\n\n**circumstantial evidence linking the malware to members of ISIS.**\n\n## Many Groups, Similar Tactics\n\n**Each of these groups has distinct Tactics, Techniques and Procedures (TTPs). However, one common thread among the many**\n\n**publicly-reported groups is that they rarely use exploits in their campaigns, instead relying heavily on social engineering and trickery**\n\n**to convince targets to execute malicious files, disguised as innocuous documents.�**\n\n**This may reflect some of these groups’ lack of technical sophistication. For example, many regime-linked groups seem to have very�**\n\n**limited skills and technical resources, and rely almost entirely on RATs coupled with well-informed social engineering. These**\n\n**techniques have evolved, but not improved radically since 2011. In other cases, such as the Lebanon-linked group reported on by**\n\n**FireEye, operators may have access to more sophisticated techniques, but see little reason to use them against their targets, given**\n\n**the limited technical capabilities of the opposition.**\n\n# Part 1: Discovering Group5\n\n**_This section describes the e-mails that first alerted us to an operation targeting the Syrian political opposition in October 2015.�_**\n\n**On October 3rd 2015, Noura Al-Ameer, a well-connected Syrian opposition political figure, negotiator, and former Vice President of�**\n\n**the opposition Syrian National Council (SNC), received a suspicious e-mail.[1] The e-mail purported to come from a human rights**\n\n**documentation organization she had never heard of: “Assad Crimes.” The sender, using the e-mail address**\n\n**office@assadcrimes[.]info claimed to be sharing information about Iranian “crimes,” a theme familiar to many in the opposition.�**\n\n\n-----\n\n**_Fig. 1: Noura Al-Ameer, former SNC Vice President and a target of the operation. An activist from Homs, Syria, Al-Ameer was detained and_**\n\n**_tortured in the security branches, later moved to the infamous Adra prison in Damascus, prior to fleeing the country several years ago. Today,�_**\n\n**_she is a delegate to the SNC’s political council and works to document war crimes committed during the conflict. Her identity was falsely used�_**\n\n**_to register the assadcrimes website._**\n\n**Interestingly, Al-Ameer’s own name was used in the assadcrimes[.]info domain registration, along with other false information (we**\n\n**speculate on the reason for using her name in Part 6: Analysis of Competing Hypotheses).**\n\n**Along with a brief pretext in the Subject and Body, the e-mail also contains an attached Microsoft PowerPoint Slideshow (PPSX)**\n\n**document that, when clicked, directly opens and runs a PowerPoint slideshow.**\n\n## E-mail 1: The Initial Message (Dropper Doc 1)\n\n**On October 3rd 2015, Al-Ameer received the initial e-mail message, containing the first malicious file:�**\n\n**Translation:**\n\n\n**From: office@assadcrimes[.]info�**\n**To:**\n**Subject: Iran is killing the Pilgrims in Mina**\n**Body: Iran’s Crimes in the Kingdom of Saudi Arabia**\n\n\n**Examination of the header of the message indicates that the message was sent via 88.198.222[.]163, the same IP address as the**\n\n\n-----\n\n**MD5 : 76F8142B4E52C671871B3DF87F10C30C**\n\n\n**Communication with the Operator**\n\n**Al-Ameer, who is no stranger to digital threats, recognized that the e-mail was suspicious, and on our instruction made contact with**\n\n**the operator, hoping to elicit further malware.**\n\n**Al-Ameer’s E-mail:**\n\n**Translation:**\n\n\n**From: [Redacted]**\n**To: office@assadcrimes[.]info�**\n**Body:**\n**Hello**\n**The file didn’t work …. Please send a correct version�**\n\n\n## E-mail 2: The Operator Replies (Dropper Doc 2)\n\n**Shortly after the target’s message, the operator replied with an updated file, sent via a webmail client (RoundCube):�**\n\n**Translation:**\n\n\n**From: office@assadcrimes[.]info�**\n**To:[Redacted]**\n**Body:**\n**inf* download**\n\n\n**We are unsure why the second e-mail does not contain additional social engineering text. It is possible this was an oversight, or that**\n\n**the Group5 operator at the time was not comfortable writing in Arabic.**\n\n\n**Assadcrimes1.ppsx**\n**MD5: F1F84EA3229DCA0CCACB7381A2F49F99**\n\n\n## Bait Content: Syria and Iran-Themed PowerPoint Slideshows\n\n**The PPSX documents (assadcrimes.ppsx & assadcrimes1.ppsx) contain a series of images and Arabic text, including cartoons and**\n\n**photographs describing politically sensitive events, such as aggressions launched by Iran against Saudi Arabia, and the politics**\n\n**surrounding the current Syrian conflict. The documents also provide a historical overview of Iranian-linked “attacks” and other�**\n\n**events in the Kingdom of Saudi Arabia.**\n\n\n-----\n\n**_Figure 2: Screenshot from a slide referred to an Iranian attack in 1984 against petrochemical facilities in Saudi Arabia._**\n\n\n**Translation:**\n\n\n**On 1404 A.H – 1984 A.D Iranian warship attacked Saudi Arabia**\n**On 1404 A.H, two Iranian war planes headed to Jubail industrial city, to bomb and hit critical factories (Petrochemical factory) and by**\n**god’s well, the Saudi’s air forces was able to hit one plane, while the other managed to escape.**\n\n\n**When opened, both files download malware onto the victim’s machine. Malware from these files is analyzed in �Part 3: Windows**\n\n**Malware.**\n\n# Part 2: The Assadcrimes Website\n\n**_Group5 operated a website, assadcrimes[.] info that served as a watering hole for Android and Windows malware. This section_**\n\n**_outlines the various files hosted on the site.�_**\n\n**After the initial e-mails, we began to monitor a website linked to the e-mails: assadcrimes[.]info. At the time of these e-mails (Oct. 3,**\n\n**2015), the site was not fully functional. However, within a few days (Oct. 11, 2015) the main page displayed “Posts Tagged Bashar**\n\n**[Assad Crimes” with content apparently critical of Bashar Assad. The content appears to have been scraped from an opposition blog,](https://syriatopics.wordpress.com/)**\n\n**[as well as from other opposition sites. This blog was created in the name of Tal al-Mallohi, known as Syria’s youngest prisoner of](http://syrian-mirror.net/en/cat/syria-mirror/who-is-caesar-the-man-who-leaked-crime-of-the-century/)**\n\n**conscience. The original blog creation predates the current unrest in Syria.**\n\n\n-----\n\n**_Figure 3 : Screenshot of the website taken in April 2016 (assadcrimes[.]info)._**\n\n**Shortly before this publication of Group5, the website was listed as “expired” and parked, indicating that the owner chose not to**\n\n**renew the domain.**\n\n\n-----\n\n**_Group5 Staging and Targeting_**\n\n## Malware Seeding on the Website (Dropper Doc 3)\n\n**While monitoring the website, we identified several directories that auto-download a further malicious file (assadcrimes.info.ppsx).�**\n\n**These links seem designed for other forms of social engineering, perhaps using similar bait to the messages targeting Al-Ameer.**\n\n**The Assadcrimes.info.ppsx file concerns the Syrian conflict, with characters and cartoons culled from social media and online sites.�**\n\n\n-----\n\n**_Figure 4 : A slide from the file Assadcrimes.info.ppsx�_**\n\n\n**Translation:**\n\n\n**A new Play in Syria**\n**Russian-American plan to divide the Syrian cake.**\n\n\n**When viewed, the victim’s computer is silently infected with malware (See Part 3: Windows Malware).**\n\n\n**Assadcrimes.info.ppsx**\n**MD5: 30BB678DB3AD0140FC33ACD9803385C3**\n\n\n## Martyred Children (Decoy Dropper 4)\n\n**Elsewhere on the site we found several HTML pages that, when visited, triggered the downloading of a malicious executable named**\n\n**“martyred children” (alshohadaa alatfal.exe). When executed, the program pulls images hosted on assadcrimes[.]info of the Ghouta**\n\n**Chemical Attacks, while simultaneously infecting the target machine with malware.**\n\n\n-----\n\n**_Figure 5 : showing screenshot of ‘alshohadaa alatfal.exe’ running. Images blurred by the authors._**\n\n**Malware from the website is described in Part 3: Windows Malware**\n\n\n**alshohadaa alatfal.exe**\n**MD5: 2FC276E1C06C3C78C6D7B66A141213BE**\n\n\n## Android Malware\n\n**While examining the assadcrimes[.]info website, we identified Android malware, seeded via a fake Adobe Flash Player update�**\n\n**notification. We describe this Android malware in detail in: Part 4: Android Malware.�**\n\n\n**adobe_flash_player.apk�**\n**MD5: 8EBEB3F91CDA8E985A9C61BEB8CDDE9D**\n\n\n# Part 3: Windows Malware\n\n**Group5 used (or was staging) a range of malware in this operation, ranging from malicious PowerPoint slideshows using exploits to**\n\n**executable files that directly drop malware. A comprehensive analysis of their malware is found in �Appendix A: Windows Malware**\n\n**Analysis.**\n\n## Malicious PowerPoint\n\n**The initial Group5 targeting that we observed in the e-mails to Al-Ameer included PPSX documents as a vehicle for malware using**\n\n**two different techniques: (1) executing OLE objects using animation actions within a PowerPoint slideshow and; (2) using CVE-**\n\n**2014-4114 to drop and execute malicious code.**\n\n**In assadcrimes.ppsx the operators embed an OLE Package object within a PowerPoint slideshow. When displayed as an**\n\n**[animation, the object is executed while the slideshow is viewed, a technique that has been previously described (for more detail, see](http://phishme.com/powerpoint-and-custom-actions/)**\n\n**Appendix A: Dropper Doc 1 & Appendix A: Dropper Doc 3). In this case the user is presented with a prompt asking whether**\n\n**they wish to run the object.**\n\n\n-----\n\n**_Figure 6: The malicious executable within the PowerPoint slideshow, when viewed in edit mode. A victim double clicking on the slideshow_**\n\n**_would not be shown the object._**\n\n**In the assadcrimes1.ppsx, the operator has created a PowerPoint file that leverages CVE-2014-4114, a vulnerability in the OLE�**\n\n**packager component of the Windows operating system (See Appendix A: Dropper Doc 2).**\n\n**Decoy Applications**\n\n**The operators have also created a decoy application, hosted on assadcrimes[.]info, that displays images of child victims of the 2013**\n\n**Ghouta Chemical Attacks. When executed, the application silently decrypts and drops the malware (See Appendix A: Decoy**\n\n**Dropper 4).**\n\n\n-----\n\n## The RATs\n\n**The operators use these techniques to deliver two commonly available Remote Access Trojans (RATs): njRat and NanoCore RAT. In**\n\n**both cases, Group5 disguised the malicious binaries with several layers of obfuscation, including crypting and packing to reduce the**\n\n**possibility of detection by antivirus software.**\n\n**Both RATs provide a wide range of functionality on the target machine, ranging from collecting files, watching the screen, to�**\n\n**capturing passwords and keystrokes. The RATs also enable the operator to remotely delete files, and spy on the computer user via�**\n\n**the microphone or webcam.**\n\n\n-----\n\n**_Figure 7 : Screenshot of njRAT working, and accessing the victim’s files.�_**\n\n## Antivirus Detection\n\n**On July 26, 2016 we conducted a VirusTotal search for the MD5 hashes of each of the files encountered during this operation. The�**\n\n**results, provided in Appendix D: File Hashes, were consistent with a highly focused or targeted operation in that only two of the 16**\n\n**(12.5%) unique MD5s were found.**\n\n# Part 4: The Android Malware\n\n**_While examining assadcrimes[.]info, we determined that the site was also hosting a decoy Flash Player update page. This page,_**\n\n**_located on a subdomain, included a download link to a malicious Android APK. For a full analysis of this malware see Appendix B:_**\n\n**_Android Malware._**\n\n**While examining the website we found that the operators had prepared Android malware masquerading as an Adobe Flash Player**\n\n**update notification. Clicking on the “Update” link (See Figure 8) downloads a malicious file, masquerading as a software update.�**\n\n\n-----\n\n**_Figure 8: Screenshot from the subdomain that was used to host the fake Flash Player update page._**\n\n**[The APK is an instance of DroidJack. According to Symantec, this malware evolved from an older codebase known as SandroRAT.](http://www.symantec.com/connect/blogs/droidjack-rat-tale-how-budding-entrepreneurism-can-turn-cybercrime)**\n\n**The RAT provides a wide range of functionality, enabling the operator to capture messages, contacts, photos and other materials**\n\n**from the device. In addition, DroidJack can also remotely activate the phone camera and microphone, without notifying the victim.**\n\n**Figure 9 shows some of the functionality available.**\n\n\n-----\n\n**_Figure 9: DroidJack server list of commands._**\n\n**A more extensive analysis of the DroidJack malware, can be found in Appendix B: Android Malware. Interestingly, DroidJack has**\n\n**[also emerged recently, bundled with versions of Pokémon Go.](https://www.proofpoint.com/us/threat-insight/post/droidjack-uses-side-load-backdoored-pokemon-go-android-app)**\n\n**This approach to mobile malware seeding, while cumbersome, might be assumed to have greater success in the target group of**\n\n**Syrians than other populations. It is common for Syrians to share Android APK files outside the Google Play Store, as Google Play�**\n\n**Services are not available within Syria. This practice carries over to the Syrian diaspora in other countries, despite the availability of**\n\n**Google Play. As a result, we suspect that most devices are set to accept APK files from unknown developers.�**\n\n# Part 5: Attribution\n\n**_Group5 left a number of clues as to their origin and identity, including the tools they used, where they hosted their website and C2,_**\n\n**_and how they accessed the website. Notably, Group5 may have also been using a customized version of an Iranian obfuscation tool._**\n\n**This section provides an overview of the clues left by Group5 on the website, and in the malware. First, we analyze logs that the**\n\n**operator mistakenly left publicly visible on the assadcrimes[.]info website. These logs include not only the visitors to the site, but also**\n\n**the IP addresses and user agent strings that belong to the operator as she or he logged into the site during the development phase.**\n\n**These artifacts provide interesting clues as to the operator’s identity and operational security practices, such as using a VPN, and**\n\n**suggest a strong Iranian nexus.**\n\n**Second, we note the use of Persian-language tools in Group5, from the mailer to the packer.**\n\n**Finally, we analyze a recurrent theme in the binaries: “Mr. Tekide” – a name that appears regularly in the implants. We link this name**\n\n**to the Iranian developer of a series of malware tools, several of which were used in this operation. Additionally, we examine the**\n\n**circumstantial evidence connecting this developer to Group5’s activities.**\n\n## Unprotected Logs\n\n**Several key directories on the assadcrimes[.]info site were left as public, including a folder containing the website logs, a feature**\n\n**Group5 seems to have enabled early in the operation. These logs date to the early development and operation of the website, and**\n\n**reveal interesting clues about operator origin and operational security.**\n\n**After processing the logs to remove crawlers belonging to Google, Bing, Yandex and others, we scrutinized the logs of the site for**\n\n**evidence of victims, but were unable to locate any victim IPs with high confidence.�**\n\n**Identifying the Operator from Website Logs**\n\n\n-----\n\n**p** **y** **p** **g** **g** **p** **g**\n\n**site hourly from an Iranian IP block as the development continues.**\n\n**_Figure 10: Screenshot of 11th October 2015 log, showing list of IP’s and referrer from hostnegar[.]com_**\n\n**The first logged visits to the site come from the IP address 37.137.131[.]70, which belongs to a block registered to ‘Rightel�**\n\n**Communication’, an Iranian mobile phone network operator.**\n\n\n**inetnum: 37.137.128[.]0 – 37.137.255[.]255**\n**netname: RighTel**\n**descr: “Rightel Communication Service Company PJS”**\n**country: IR**\n**admin-c: RP12366-RIPE**\n**tech-c: RP12366-RIPE**\n**status: ASSIGNED PA**\n**mnt-by: TA59784-MNT**\n**created: 2013-08-20T11:13:17Z**\n**last-modified: 2014-05-17T05:28:10Z�**\n**source: RIPEperson: RighTel PJS**\n**address: 9th floor, Chooka Building, No 8, west Armaghan Street, Vali-e-Asr Street�**\n**(After Niayesh Highway), Tehran, Iran**\n**phone: + 982127654530**\n**nic-hdl: RP12366-RIPE**\n**mnt-by: TA59784-MNT**\n**created: 2014-05-17T05:23:47Z**\n**last-modified: 2014-05-17T05:23:47Z�**\n**source: RIPE**\n\n\n**Further confirming the link is that the operator’s traffic includes a referrer from the Iranian hosting company (hostnegar[.]com) for the�**\n\n**site.**\n\n\n-----\n\n**_Figure 11: Hostnegar’s login page_**\n\n**Tracing the operator through an initial UserAgent string (a version of Windows NT 6.3)[2] and IP address, we found them accessing**\n\n**the site from an iPhone, other Iranian IP addresses, as well as VPNs.**\n\n**_Figure 12: User agents for the site owner, accessing the website from Iranian IPs and VPN._**\n\n**Additionally, the operator accessed the site directly from the malware’s C2 server (88.198.222[.]163).**\n\n\n-----\n\n**_Figure 13 : User agents for the site owner, accessing the website from the C2, and using VPNs._**\n\n**These links provide evidence for an Iranian nexus, and suggest that the operator may have been taking steps to conceal their true**\n\n**origin IP. However, these steps were not well executed, which enabled us to track Group5 as they continued to access the site.**\n\n**Interestingly, after the flurry of activity in October 2015, by November-December the operator accessed the site only 7 times, and�**\n\n**between January-February 2016 only twice (it is possible we have missed some access attempts that appear to be innocuous**\n\n**traffic). We concluded from this that Group5 may have stepped back from the site at some point after the New Year.�**\n\n## A Persian-language Mailer\n\n**Before the assadcrimes[.]info page was fully populated with decoy content, we found that the site was hosting a Persian-language**\n\n**mailer (See Figure 14 below). We were not able to determine how the mailer was being used by Group5, as it was not observed**\n\n**sending any of the e-mails we were able to analyze.**\n\n\n-----\n\n**Group5 appears to have used only a single shared web hosting provider and a single command and control IP address for this**\n\n**operation. We are unsure whether this strategy was the product of limited resources, an effort to compartmentalise the operation**\n\n**from other activities, or simply a highly targeted operation with a specific focus.�**\n\n**The narrow infrastructure and small number of observed targets limited our search base for potential infrastructure overlap with**\n\n**known groups. In a holistic evaluation of the campaign, we failed to identify links with the TTPs of previously documented threat**\n\n**actors or groups active in Syria. We also failed to find a link in searches of malware databases and open source searching.�**\n\n**On the level of TTPs, superficially there is similarity between this group and other active groups originating in Iran. The group�**\n\n**[multiply](http://researchcenter.paloaltonetworks.com/2016/05/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/)** **[documented by Palo Alto Networks, which they call “Infy,” is also known to use PowerPoint files in their targeting, although�](http://researchcenter.paloaltonetworks.com/2016/06/unit42-prince-of-persia-game-over/)**\n\n**we found no overlap in infrastructure. Furthermore, their targeting (according to what Palo Alto Networks has said publicly) is slightly**\n\n**different, and involved PowerPoint 97-2003 documents (not PPSX files) during the same period in which Group5 was using a�**\n\n**different tactic.**\n\n**We cannot not rule out the possibility that a known group is behind this operation, and that we missed or lacked access to a key**\n\n**piece of evidence that would link such a group to Group5’s infrastructure or tools. One interesting direction for further investigation**\n\n**came from analysis of the tool used to obfuscate the RATs, which yielded a number of interesting connections to known threat actors**\n\n**and tools. Notably, the PAC Crypt tool, and Mr. Tekide, the alias of an Iranian malware developer.**\n\n**PAC Crypt**\n\n**Commonly used in malware campaigns, crypters are programs which are designed to disguise the underlying malicious binary by**\n\n**hiding it within a layer of obfuscation which is then deobfuscated at the time of execution. In this way, crypting a malicious binary**\n\n**provides a level of protection against signature-based endpoint security tools such as antivirus. In Appendix A we describe the**\n\n**discovery of a series of strings which suggest that both the njRAT and NanoCore RAT payloads were built, and then subsequently**\n\n**obfuscated using a crypter tool named ‘PAC Crypt’.**\n\n**Careful inspection revealed that the crypter in this case had been compiled in debug mode, thus preserving PDB reference data.**\n\n**PDB file references are common in .Net applications when compiled in ‘debug’ mode, and they frequently reveal the original file�**\n\n**path of the application source code on the developer’s computer.**\n\n**Below are the PDB strings discovered when examining the ‘crypted’ njRAT and NanoCore files:�**\n\n**Reference: Doc Dropper 1 Crypter** **MD5: a4f1f4921bb11ff9d22fad89b19b155d** **Compile Time: 9/30/2015 00:02:51**\n\n**c:\\users\\mr.tekide\\documents\\visual studio 2013\\projects\\paccryptnano core dehgani -vds\\windowsapplication2\\obj\\debug\\launch**\n\n**manager.pdb**\n\n**Reference: Doc Dropper 3 Crypter** **MD5:6161083021b695814434450c1882f9f3** **Compile Time: 10/6/2015 02:13:45**\n\n**C:\\Users\\mr.tekide\\Documents\\Visual Studio 2013\\Projects\\paccrypt11njratmalii\\paccryptalipnahzade\\obj\\Debug\\LManager.pdb**\n\n**These PDB strings reveal two facts relevant to the discussion of attribution. The first is that the username of the individual who�**\n\n**compiled the .Net application in both cases was ‘mr.tekide’. The second is that in both PDB strings we find not only a reference to�**\n\n**the malware crypter used (a tool called ‘PAC Crypt’), but also an explicit reference to the crypted malware payloads – ‘nano core’**\n\n**and ‘njrat’.**\n\n**These two facts together suggest that an individual having the username ‘mr.tekide’ compiled a copy of PAC Crypt for specific�**\n\n**projects involving njRAT and NanoCore RAT.**\n\n**A common usage scenario for a malware crypter involves an operator purchasing a copy of the crypter in a compiled form (or using**\n\n**a cracked version), then using the crypter to obfuscate the malware executable which is to be distributed. In this scenario the**\n\n**developer of the crypter has no knowledge of what specific malware the threat actor will eventually choose to encrypt with the�**\n\n**purchased copy of the crypter.**\n\n**The fact that the ‘PAC Crypt’ PDB strings discovered in this case contained the ‘njrat’ and ‘nano core’ references is therefore**\n\n**noteworthy because it indicates the possibility of prior knowledge of the precise malware payload which was to be crypted.**\n\n**Research into the PAC Crypt tool revealed that this program is developed and sold by an Iranian malware developer known as ‘Mr.**\n\n**Tekide’.**\n\n**Mr. Tekide**\n\n**Mr Tekide is the online alias of an Iranian malware developer who is also the administrator of the website http://crypter[ ]ir an**\n\n|Reference: Doc Dropper 1 Crypter|MD5: a4f1f4921bb11ff9d22fad89b19b155d|Compile Time: 9/30/2015 00:02:51|\n|---|---|---|\n|c:\\users\\mr.tekide\\documents\\visual studio 2013\\projects\\paccryptnano core dehgani -vds\\windowsapplication2\\obj\\debug\\launch manager.pdb|||\n\n|Reference: Doc Dropper 3 Crypter|MD5:6161083021b695814434450c1882f9f3|Compile Time: 10/6/2015 02:13:45|\n|---|---|---|\n|C:\\Users\\mr.tekide\\Documents\\Visual Studio 2013\\Projects\\paccrypt11njratmalii\\paccryptalipnahzade\\obj\\Debug\\LManager.pdb|||\n\n\n-----\n\n**_Figure 15: Crypter[.]ir main page (left), and contact page (right)_**\n\n**In addition to the crypter[.]ir forum and shop, Mr. Tekide appears to be in the midst of creating a new online storefront for selling his**\n\n**various malware tools and services. The content shown in Figure 16 below, obtained from http://crypting[.]org, shows a ‘rat service’**\n\n**being offered to visitors. The store also touts a Windows Rootkit (“coming soon”) and various ‘exploits.’**\n\n**_Figure 16: Crypting[.]org main page (left), list of hacking services offered (right)_**\n\n**Mr. Tekide also maintains an active presence as a moderator on the Ashiyane forums,[3] an Iranian security discussion board run by**\n\n**the Ashiyane Digital Security Team (ADST). The ADST is a well-known Iranian security and hacking group which has earned**\n\n**notoriety for its prolific website defacement activities. These defacements invariably contain a list of ADST ‘defacers’ alongside the�**\n\n**phrase ‘We Love Iran’.**\n\n**Web site defacements conducted by ADST have explicitly named Mr. Tekide as a member, as shown in Figure 17 below.**\n\n**_Figure 17: an Ashiyane Digital Security Team defacement page, naming Mr. Tekide_**\n\n**In addition to its defacement activities, ADST has been recently linked to the indictment by the US Department of Justice of seven**\n\n**[Iranian nationals for cyber attacks against the US financial sector. �In its indictment, the Department of Justice alleges that members](https://www.justice.gov/opa/pr/seven-iranians-working-islamic-revolutionary-guard-corps-affiliated-entities-charged)**\n\n\n-----\n\n**behalf of the Iranian Government.**\n\n**Additional open source information about Mr. Tekide is included in Appendix C: Mr. Tekide.**\n\n## A Consistent Iranian Nexus\n\n**We cannot conclude with certainty that Group5 is Iran-based, although the confluence of information outlined above provides a�**\n\n**circumstantial case. The IP addresses observed during early stages of development of the Assadcrimes website, as well as the**\n\n**Iranian hosting provider and the Persian language mailer, all speak to a level of Iranian presence. The additional apparent**\n\n**involvement of an Iranian malware developer with ties to a known Iranian cyber actor, whether his involvement was unwitting or**\n\n**intentional, only strengthens the Iranian connection.**\n\n# Part 6: Analysis of Competing Hypotheses\n\n**This section evaluates several competing hypotheses for explaining the identity of the operator. While we cannot conclusively**\n\n**support one of these hypotheses, we think the most plausible is that this operation is the work of an Iranian group newly active in**\n\n**Syria.**\n\n**We believe we found Group5 fairly early in the process of preparing a larger malware campaign, thanks to Noura Al-Ameer’s**\n\n**vigilance. This gave us unique visibility into some of their staging, but we had only a limited view of other possible targeting.**\n\n**Group5’s reliance on a narrow infrastructure limited our ability to connect the operation to other known groups, as discussed above.**\n\n**With these caveats and limitations in mind, we outline the known elements of the operation, and evaluate several hypotheses:**\n\n**(Hypothesis 1) an Iranian group newly active in Syria; (Hypothesis 2) that the operation is from known regime-linked groups, like the**\n\n**Syrian malware groups; and (Hypothesis 3) that it is from some other unknown group. After addressing the fit of each hypothesis�**\n\n**with available evidence, we provide an overall evaluation of the three, and conclude that Hypothesis 1 provides the best explanation**\n\n**for what we have observed.**\n\n# Hypothesis 1: Iranian Group Newly Active in Syria\n\n**_A group previously unreported in Syria with uneven skills but displaying thought and care in selecting the target, and preparing the_**\n\n**_operation, with an Iranian nexus and a possible government connection._**\n\n**Previously Unseen in Syria: We have been unable to find a high-confidence overlap in infrastructure or malware to previously-�**\n\n**reported groups active around Syria. We also had difficulty connecting the operation to other known groups in the global threat actor�**\n\n**space. Furthermore, the use of exploits, as well as DroidJack and other tools, is inconsistent with the TTPs of known groups**\n\n**targeting the Syrian opposition, especially the regime-linked groups. Notably, these groups have shown little ability or appetite for:**\n\n**(a) standing up multifaceted seeding websites; (b) targeting Android users; (c) using exploits in PowerPoint files.�**\n\n**Previously reported groups, especially regime-linked groups, have had a tendency to re-use infrastructure, and repurpose similar**\n\n**tools and approaches. It would be surprising for them to suddenly abandon tactics that still “work,” and cease using a C2**\n\n**infrastructure that cannot be taken down (because it is inside Syria).**\n\n**[While Group5’s tactics have more in common with the group reported in this FireEye report, such as the use of a fake website,](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-behind-the-syria-conflict.pdf)**\n\n**COTS .Net malware, and Android malware, there is no direct infrastructure or tool overlap, and only limited evidence of social**\n\n**engineering sophistication (e.g. the use of avatars).**\n\n**Furthermore, the lack of technical sophistication, combined with low operational security, suggest that, had this group been**\n\n**previously active for any length of time, it would have run the risk of discovery, perhaps especially given all of the existing reporting**\n\n**about pro-Regime malware groups in Syria.**\n\n**Uneven Technical Sophistication: The operators showed familiarity with a range of cybercrime tools, yet also committed a range**\n\n**of operational security oversights, such as leaving their logs open and public-facing, connecting via their C2 server, and leaving**\n\n**debugging strings in compiled files. These characteristics would be inconsistent with the work of an in-house government capability.�**\n\n**Iranian Connection: Analysis of the malware and seeding yields a consistent Iranian presence. The binary contains Iranian and**\n\n**Iranian-Persian traces, as do the tools used for obfuscation, which are popular in Iranian cybercrime forums. Similarly, the mailer**\n\n**discovered on the assadcrimes[.]info website is in Persian. There is also the intriguing, but ultimately unproven speculation that the**\n\n**crypter may have been sold to Group5 by a known Iranian malware developer. Furthermore, logs of access to the assadcrimes[.]info**\n\n**site suggest that the operators are working from within Iranian IP space. In addition, the bait content also contains substantial**\n\n**Iranian themes. Finally, the hosting provider (Hostnegar) is Iranian. A final piece of highly circumstantial evidence is that PowerPoint�**\n\n**documents containing exploits, albeit often with quite different (and sometimes custom) malware, is a commonly reported feature of**\n\n**[many recently-reported](http://researchcenter.paloaltonetworks.com/2016/05/prince-of-persia-infy-malware-active-in-decade-of-targeted-attacks/)** **[Iranian campaigns.](https://www.iranhumanrights.org/2016/04/cyber-attacks-iranian-officials/)**\n\n\n-----\n\n**multilateral negotiations, yet not highly visible outside of informed circles. Speculatively, the choice of target is indicative of the**\n\n**interests and resources of a state-level actor, or a group receiving direction or providing information to such an actor. A number of**\n\n**governments and non-state actors in the region have an interest in the workings of the opposition, and several are providing direct**\n\n**or indirect support to the Assad Regime. We discuss this possibility in greater detail below in Evaluating Hypotheses.**\n\n# Hypothesis 2: Known Regime-Linked Group\n\n**_A known Regime-linked group has modified its tactics to operate against familiar targets�_**\n\n**Familiar Targets: The most widely documented threat against the Syrian opposition comes from regime-linked groups, notably**\n\n**malware groups and the Syrian Electronic Army (to a lesser degree). These groups benefit from known links to the regime of Bashar�**\n\n**al-Assad, which has a direct and strong interest in monitoring members of the Syrian Opposition, including the groups apparently**\n\n**targeted in this operation. We are familiar with previous operations by regime-linked groups targeting the same organizations.**\n\n**Modified Tactics:� We cannot rule out the possibility that existing groups have added a range of new TTPs to their existing set as**\n\n**the conflict continues.�**\n\n**Regime-linked groups certainly have the motivation to conduct this operation. Do known groups have the skills to conduct such an**\n\n**operation? There are a range of features of this operation that suggest Group5 may not be a regime-linked group. First, known**\n\n**regime-linked Syrian groups have tended to use a limited set of C2 servers, almost always with at least one server (or a fallback)**\n\n**located within a narrow set of servers within Syria. Group5 does not have a fallback C2 in Syria. Similarly, the servers that Group5**\n\n**does use are not from companies previously associated with Syrian regime groups, nor is there any prior evidence of regime-linked**\n\n**groups making use of Persian-language tools, or Iranian IP space. Further, known Syrian groups have been active for almost 5**\n\n**years without evidence of familiarity with PPSX exploits. It is unclear why they would deploy so many new tactics all at once, even**\n\n**they continue to gently iterate on techniques familiar to them.**\n\n**Other Syria-Focused Groups? In the introduction we mentioned two other groups that have previously targeted the Syrian**\n\n**opposition: a Lebanon-linked group uncovered in 2014, and an ISIS-linked operation in 2015. The first group, described in a �2015**\n\n**FireEye Report, coauthored by one of the authors of this report, conducted an extensive campaign against the Syrian opposition.**\n\n**The campaign relied heavily on Arabic-speaking female avatars to flirt with opposition figures and trick them into downloading�**\n\n**malware for Windows or Android. That campaign, however, differed in malware tools, infrastructure, and social engineering style**\n\n**from Group5. In addition, it lacked any Persian-language elements, or connection to Iranian IP space.**\n\n**[In late 2014 a Citizen Lab report coauthored by one of the authors of this report, identified a malware operation linked to ISIS that�](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-behind-the-syria-conflict.pdf)**\n\n**[targeted Raqqa is Being Slaughtered Silently, a documentation and media group working to uncover human rights abuses in Raqqa](http://www.raqqa-sl.com/en/)**\n\n**and other ISIS-controlled territories. That malware was apparently custom-made but very unsophisticated. Lacking the functionality**\n\n**of a RAT, and exfiltrating via e-mail, the operation was substantially less sophisticated than Group5’s activities. We think it unlikely�**\n\n**that the operator behind that malware has (a) grown much more sophisticated, or (b) begun to rely on Iranian tools and hosting**\n\n**providers.**\n\n# Hypothesis 3: Other Unknown Group\n\n**_An unknown group, not located in Iran and not linked to prior groups_**\n\n**It is possible that the operation is the work of some other unknown group. One possibility that we consider is that the operation is a**\n\n**false flag from another state sponsor, deliberately crafted to appear to be an Iranian group. In another, we also consider the other�**\n\n**common motivations for such operations, including financial crime.�**\n\n**A False Flag: Certainly, many other governments are actively interested in information about the Syrian opposition. Given the**\n\n**extensive circumstantial evidence strewn throughout the operation that points to a group based in Iran, one possibility we consider**\n\n**is that the operators are deliberately masquerading as an Iranian group, while acting on behalf of another sponsor.**\n\n**In such a scenario, each of the pieces of circumstantial evidence we have assembled is a string of deliberately planted artifacts,**\n\n**intended to deflect from the threat actor’s true identity. This hypothesis is an intriguing possibility that cannot be conclusively ruled�**\n\n**out. However, it is worth asking why, given the noisiness of existing groups targeting the Syrian opposition, a false flag operation�**\n\n**would not simply be populated with the many publicly reported strings and other tools associated with pro-regime groups. Similarly,**\n\n**we wonder why a threat actor sophisticated enough to mount such an operation would not also have used more sophisticated**\n\n**malware or seeding techniques.**\n\n**Financial / Commercial Hacking: We find no evidence to suggest that financial crime or commercial espionage played a part in�**\n\n**this operation. For a narrowly focused operation, the targeting, for example, does not appear to be geared towards wealthy**\n\n**individuals, or those with access to serious financial resources.�**\n\n\n-----\n\n**g** **p** **y** **p** **g** **p** **g** **y** **g** **g** **p**\n\n**The important caveat is that, perhaps partially by design, we have a limited view on the targets of the campaign, and it is possible**\n\n**that this analysis would change.**\n\n**We further believe that Group5 shows some signs of being state-directed, however we do not have sufficient evidence to link�**\n\n**Group5 to a particular government. Two possibilities seem likely: (1) Group5 is working under the control or direction of a**\n\n**government entity within Iran, or sympathetic to such an entity and receiving and sharing information with them; (2) Group5 is**\n\n**collaborating or working on behalf of a government entity within Syria for ideological or mercenary reasons. Both governments are**\n\n**belligerents within the Syrian conflict, and both would have a strong interest in accessing the communications of the Syrian�**\n\n**opposition.**\n\n**The Iranian government has been a strong supporter of the regime throughout the conflict, and clearly has an interest in learning�**\n\n**and frustrating the political maneuvering of the Syrian opposition. Iranian intelligence and security services have reportedly provided**\n\n**[a wide range of military and intelligence gathering assistance to the regime, ranging from troops and training, to electronic](http://www.understandingwar.org/sites/default/files/IranianStrategyinSyria-1MAY.pdf)**\n\n**[monitoring capabilities. At minimum, operators based in Iran certainly would be unlikely to face punishment from their government](https://www.foreignaffairs.com/articles/iran/2011-08-25/how-iran-keeps-assad-power-syria)**\n\n**for work against the Syrian opposition. Speculatively, sponsoring such an operation (held at arms length and consigned to a**\n\n**deniable, less experienced group) could provide useful information about the activities and thinking of key individuals within the**\n\n**Syrian Opposition, such as advanced knowledge of negotiating points in multilateral meetings, or internal disagreements.**\n\n**Importantly, there is no evidence to directly connect Group5 to any entities within the Iranian government, security establishment, or**\n\n**military. Nor can we rule out the possibility that Group5 is Iran-based, but working on behalf of some other entity.**\n\n**The most perplexing part of the activity we observe is that the operation appears to have been extensively prepared, and then**\n\n**apparently paused after initial seeding. This pause took place not long after Al-Ameer was initially targeted: the website**\n\n**development continued for a period after she had received the initial e-mail, and then ceased. Group5 may have initially targeted Al-**\n\n**Ameer hoping to leverage her well-connected position and digital identity to target others within the Syrian opposition. Theft of her**\n\n**digital identity would explain why her name was used in the WHOIS for assadcrimes[.]info, and why, after failing to infect Al-Ameer,**\n\n**the campaign did not appear to receive much further work, and the infrastructure was ultimately abandoned.**\n\n**Other explanations for the pause in activity are possible, and we cannot discount them based on our limited evidence: Group5 may**\n\n**have undergone a shift in the focus of its targeting, concluded that their campaign was ‘blown’ and abandoned it, experienced**\n\n**human resources or political issues, or simply concluded that the operation was using an ineffective technique.**\n\n# Conclusion\n\n**When Syrian opposition figure Noura Al-Ameer sensed something wrong and refrained from clicking, she frustrated a reasonably�**\n\n**well put together deception. We suspect she may have been targeted in order to steal her digital identity for the purposes of**\n\n**mounting a larger campaign. Beginning with this initial message, we were able to identify and characterize Group5, a seemingly**\n\n**new entrant into the game.**\n\n**With the identification of Group5, the number of publicly identified operations known to have targeted the opposition with malware�**\n\n**[has risen to five, at least: Regime-linked groups (Syrian malware groups and the Syrian Electronic Army), �a Lebanese Group, ISIS,](https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/rpt-behind-the-syria-conflict.pdf)**\n\n**and most recently Group5. We believe that the most compelling explanation of Group5’s activities is that a group in Iran may be**\n\n**attempting to compromise the communications of the opposition. The circumstantial evidence pointing to an Iranian group is**\n\n**unsurprising, given Iran’s active military engagement in Syria, and the sympathies of many in that country for the Assad regime.**\n\n**However, mindful of the limits of our investigation, we stop short of conclusive statements of attribution about the identity of the**\n\n**operators, or their possible sponsors. We hope that by publishing this report and sharing indicators, our work will be helpful to other**\n\n**researchers who may see pieces of the puzzle that we do not.**\n\n**Despite the diversity of the groups targeting the Syrian opposition, they share general features: uneven or low technical**\n\n**sophistication plus good social engineering and well-informed targeting. These elements are characteristic of the majority of**\n\n**malware and phishing operations targeting the Syrian opposition over the past several years.**\n\n**The continued targeting, and entry of new groups, reflects the continued weakness in the Syrian opposition’s digital security, and�**\n\n**more generally the risks groups face when using popular online platforms for contested political activities.**\n\n**Operators targeting the Syrian opposition plainly do not need sophisticated tools, because easily available malware continues to**\n\n**“work,” when paired with good social engineering. The technical requirement for entering the game is low, enabling unsophisticated**\n\n**groups to achieve successes, while permitting more advanced groups to conserve better techniques for harder targets.**\n\n**The lack of a centralized communications hierarchy can make opposition groups responsive, and quick to adapt. However,**\n\n**decentralization also provides many opportunities for digital exploitation. Operators can target groups for long periods while**\n\n**remaining unnoticed, without fear of being spotted and blocked by a security team. Even when exploitation attempts are noticed,**\n\n**because the security of these groups relies on the behavior of individuals, it can be extremely difficult to ensure that more secure�**\n\n\n-----\n\n**continuing to pursue efforts to target the opposition. We hope to reinforce the message that continued vigilance is necessary to**\n\n**defend against these operations.**\n\n**[Click here for some suggestions about how to improve your digital hygiene. If you believe you may have been targeted by this](https://www.johnscottrailton.com/jsrs-digital-security-low-hanging-fruit/)**\n\n**[operation, or other Syrian malware, you are welcome to get in touch with our researchers at submit@citizenlab.ca.](mailto:submit@citizenlab.ca)**\n\n# Acknowledgements\n\n**We thank Noura Al-Ameer for collaborating with this investigation, and for graciously agreeing to be included in this report. The**\n\n**targeted nature of many cases means that, without the help of brave targets and victims, we are often left with a very limited view of**\n\n**what is taking place.**\n\n**We are exceptionally grateful to colleagues at Citizen Lab for comments, critical feedback, and assistance with document**\n\n**preparation including Ron Deibert, Bill Marczak, Morgan Marquis-Boire, Sarah McKune, Masashi Nishihata, Irene**\n\n**Poetranto,Christine Schoellhorn, and Adam Senft.**\n\n**Thanks also to Justin Kosslyn and Brandon Dixon for helpful feedback.**\n\n**We would also like to thank the following teams: Lookout, PassiveTotal and RiskIQ, VirusTotal, and Cisco’s AMP Threat Grid Team**\n\n**for data correlation.**\n\n**Very special thanks to other investigators who wished to remain anonymous but provided exceptionally helpful assistance,**\n\n**especially TNG and Tuka.**\n\n**Note: the night sky image of Syria used as background for several illustrations is from CIMSS at the University of Wisconsin**\n\n**Madison.**\n\n# Appendix A: Windows Malware Analysis\n\n**_This section analyzes the malware used by Group5. It walks through the distinct droppers, which range from malicious OLEs in a_**\n\n**_PowerPoint Slideshow file (PPSX) combined with an exploit, to executable files directly containing malware.�_**\n\n## Dropper Doc 1 (From E-mail 1)\n\n\n**Assadcrimes.ppsx**\n**MD5: 76F8142B4E52C671871B3DF87F10C30C**\n\n\n**This slideshow deploys its malicious payload by (ab)using the OLE object embedding capabilities of PowerPoint.[4] Specifically, the�**\n\n**malware executable is embedded into the slideshow as an OLE Object of type Package:**\n\n**_Figure 18: Adding an OLE Package to a PowerPoint document_**\n\n\n-----\n\n**In one of the malicious PPSX files, we can see the embedded package object by viewing the slides in normal view mode:�**\n\n**_Figure 19: The malicious OLE Package, visible when editing the PPSX_**\n\n**Once activated, the embedded object is saved to disk as %TEMP%\\putty.exe, and then executed. This executable is a .Net**\n\n**downloader.**\n\n**_Figure 20: showing putty.exe (.Net downloader)_**\n\n\n-----\n\n**g** **_p_** **[** **]** **[** **]**\n\n**The %temp%\\dwm.exe file has the following hashes:�**\n\n**MD5** **SHA256**\n\n**7d898530d2e77f15f5badce8d7df215e c19bc1ff5f8472fb7ba64f33c2168b42ea881a6ae6e134a1cc142e984fb6647f**\n\n**The malware downloaded and executed by the .Net downloader is NanoCore, a well-known RAT (Remote Access Trojan) that**\n\n**enables the remote monitoring of victims via their computers. The NanoCore binary is wrapped using several layers of code**\n\n**obfuscation, which we describe in detail below.**\n\n## Deobfuscating the Malware\n\n**The malware was obfuscated first with crypting, followed by packing before being distributed.�**\n\n**We will unwrap these steps in reverse order below.**\n\n**Unpacking**\n\n**The packer used on this executable employs a simple technique of base64 encoding the PE file and breaking it up into numerous�**\n\n**lines which are then embedded into the resource section of the .Net packer stub file. At runtime, the packer reverses this process,�**\n\n**then invokes the resulting .Net assembly from memory.**\n\n**_Figure 21: Base64 strings found in the resource section of the packed executable._**\n\n**Extracting this packed code reveals a .Net assembly which is yet another layer of code protection applied using a ‘crypter’. This**\n\n**binary has the following hashes:**\n\n**MD5** **SHA256**\n\n**a4f1f4921bb11ff9d22fad89b19b155d d81ec563387e2ea47bc8ed50fd36e1de955cb2331d6eaae9f966b5d7ab094806**\n\n**Decrypting**\n\n**This executable is stub code which performs in-memory AES decryption of a base64 encoded string variable. This string variable**\n\n**holds an encrypted copy of the NanoCore RAT binary.**\n\n|MD5|SHA256|\n|---|---|\n|7d898530d2e77f15f5badce8d7df215e|c19bc1ff5f8472fb7ba64f33c2168b42ea881a6ae6e134a1cc142e984fb6647f|\n\n|MD5|SHA256|\n|---|---|\n|a4f1f4921bb11ff9d22fad89b19b155d|d81ec563387e2ea47bc8ed50fd36e1de955cb2331d6eaae9f966b5d7ab094806|\n\n\n-----\n\n**_Figure 22: the AES decryption routines_**\n\n**This encryption of the underlying malware is typically employed to bypass detection by endpoint security controls such as antivirus**\n\n**programs. Many ‘crypter’ tools, as they are known, are available for purchase or trade on various hacking forums.**\n\n**Of particular note, this decrypting stub code retained its PDB (short for Program Database) information. PDB file references are�**\n\n**common in .Net applications when compiled in ‘debug’ mode, and they frequently reveal the original file path of the application�**\n\n**source code on the developer’s computer.**\n\n**This executable revealed the following PDB file path:�**\n\n\n**c:\\users\\mr.tekide\\documents\\visual studio 2013\\projects\\paccryptnano core dehgani -vds\\windowsapplication2\\obj\\debug\\launch**\n**manager.pdb**\n\n\n**This PDB string indicates that ‘mr.tekide’ was the username of the developer who compiled this particular stub, and further that it**\n\n**was compiled as part of a Visual Studio project named ‘paccryptnano core dehgani -vds’. In addition, a single subroutine found**\n\n**inside the decrypting stub was named ‘tekide’. The relevance of this PDB string was discussed above in Part 5: Attribution.**\n\n**In order to obtain the intended malware payload from this decrypting stub executable, we created a small .Net application to mimic**\n\n**the decryption steps and output the file to disk. Once complete, we obtained a malicious executable with hashes:�**\n\n**MD5** **SHA256**\n\n**dd5bedd915967c5efe00733cf7478cb4 a9db5a548ea17d6606bfbdb20306a3a08b38dbfe720f9f709f4d3369288be104**\n\n**Original NanoCore binary**\n\n**Now that we have arrived at the original NanoCore binary, we can examine the configuration as specified by the operator. In order to�**\n\n**[extract the configuration settings from this copy of NanoCore, we used Kevin Breen’s �RATDecoders.](https://github.com/kevthehermit/RATDecoders)**\n\n**Using Breen’s tool we arrived at the following configuration:�**\n\n|MD5|SHA256|\n|---|---|\n|dd5bedd915967c5efe00733cf7478cb4|a9db5a548ea17d6606bfbdb20306a3a08b38dbfe720f9f709f4d3369288be104|\n\n\n-----\n\n**_Figure 23: The NanoCore configuration, using Kevin Breen’s RATDecoders�_**\n\n**Notably, 88.198.222[.]163 port 8081 is the command and control channel for this malware. As noted in Part 1, the same IP was also**\n\n**present in the seeding e-mail header.**\n\n## Dropper Doc 2\n\n\n**assadcrimes1.ppsx**\n**MD5:F1F84EA3229DCA0CCACB7381A2F49F99**\n\n\n**This PowerPoint document leverages CVE-2014-4114, a vulnerability in the OLE packager component of the Windows operating**\n\n**[system. As described in previous reporting, this vulnerability causes a file embedded within the PowerPoint document to be copied�](https://citizenlab.org/2015/06/targeted-attacks-against-tibetan-and-hong-kong-groups-exploiting-cve-2014-4114/)**\n\n**to disk and executed silently on vulnerable systems.**\n\n**The document under examination drops a file named �dvm.gif to disk, renames it to dvm.exe and then executes it. This dvm.exe is**\n\n**the same packed and crypted copy of NanoCore as retrieved and executed by the .Net downloader described in the previous**\n\n**section.**\n\n## Dropper Doc 3\n\n\n**assadcrimes.info.ppsx**\n**MD5: 30BB678DB3AD0140FC33ACD9803385C3**\n\n\n**This malicious PowerPoint document uses the same weaponization method described above with respect to Dropper Doc 1. The**\n\n**executable is embedded as an OLE package object, and subsequently executed using animation actions within the PowerPoint**\n\n**slideshow.**\n\n\n-----\n\n**_Figure 24: The malicious OLE Package, visible when editing the PPSX_**\n\n**As with Dropper Doc 1, activation of the OLE Package object saves the embedded executable to disk as %TEMP%\\putty.exe, then**\n\n**executes it. This file is a .Net application employing the same layers and methods of packing and crypting as seen in the payloads�**\n\n**delivered by Dropper Docs 1 and 2. However, the ultimate malware payload in this case is njRat, another well-known RAT tool.**\n\n**After unpacking the OLE embedded executable putty.exe, we again arrive at a decrypting stub file which will AES decrypt a base64�**\n\n**string variable and run it from memory. The hashes of this file are:�**\n\n**MD5** **SHA256**\n\n**6161083021b695814434450c1882f9f3 d72676bbf8de82486c3cebfdad2961cc68a6b564a43f9f987c95320fcd6a330a**\n\n**Similar to the case of Dropper Doc 1 above, we find a PDB entry present in the decrypting stub executable:�**\n\n|MD5|SHA256|\n|---|---|\n|6161083021b695814434450c1882f9f3|d72676bbf8de82486c3cebfdad2961cc68a6b564a43f9f987c95320fcd6a330a|\n\n\n**C:\\Users\\mr.tekide\\Documents\\Visual Studio 2013\\Projects\\paccrypt11njratmalii\\paccryptalipnahzade\\obj\\Debug\\LManager.pdb**\n\n\n**Again we can observe the same username of ‘mr.tekide’ in the project source code path within the PDB string. Further, we note the**\n\n**development path components paccrypt11njratmalii and paccryptalipnahzade.**\n\n**To obtain the malicious njRat executable from this decrypting stub we used the same .Net program we built for use in the Dropper**\n\n**Doc 1 example above. The resulting njRat binary had the following hashes:**\n\n**MD5** **SHA256**\n\n**b4121c3a1892332402000ef0d587c0ee 1a287331e2bfb4df9cfe2dab1b77c9b5522e923e52998a2b1934ed8a8e52f3a8**\n\n**Interestingly, the njRat executable appears to have been compiled from source by the same user who compiled the crypter**\n\n**described above. Note the PDB strings found inside the njRat executable:**\n\n|MD5|SHA256|\n|---|---|\n|b4121c3a1892332402000ef0d587c0ee|1a287331e2bfb4df9cfe2dab1b77c9b5522e923e52998a2b1934ed8a8e52f3a8|\n\n\n**C:\\Users\\mr.tekide\\Documents\\Visual Studio 2013\\Projects\\njrat7stubsoures – Copy\\njrat7stubsoures\\obj\\Debug\\dvvm.pdb**\n\n\n**A quick look at the configuration data embedded within this njRat binary reveals the command and control IP address and port:�**\n\n\n-----\n\n**_Figure 25: The njRAT configuration, showing the C2 and port.�_**\n\n\n## Decoy Dropper 4\n\n\n**alshohadaa alatfal.exe**\n**MD5: 2FC276E1C06C3C78C6D7B66A141213BE**\n\n\n**This file is a .Net application designed to act as a decoy by displaying a window depicting images of dead children (see Figure: 5).�**\n\n**While displaying these images, the decoy application also silently extracts an executable file from the .Net assembly’s resource�**\n\n**section, copies it to %TEMP%\\dvm.exe, and then launches a new process from this newly created file. See Figure 26 below:�**\n\n\n-----\n\n**The dropper also includes a PDB reference:**\n\n\n**C:\\users\\enterok\\desktop\\slideshow\\slideshow\\obj\\x86\\debug\\alshohadaa alatfal.pdb**\n\n\n**The dvm.exe file is itself a .Net executable which is packed using the same .Net packer used above in the cases of Dropper Docs 1�**\n\n**– 3. Once unpacked, the resulting file is the same crypted .Net application analysed above from Dropper Doc 3, having MD5 hash�**\n\n**6161083021b695814434450c1882f9f3, and containing the njRat payload.**\n\n## Malware Infrastructure\n\n**Command and Control Server**\n\n**Each of the three distinct RAT tools used by Group5 (njRAT, NanoCore RAT, and DroidJack) were configured to communicate with a�**\n\n**single command and control server operating on IP address 88.198.222[.]163.**\n\n**IP** **Reverse DNS PTR** **Assignee**\n\n**88.198.222[.]163 static.88-198-222-163.clients.your-server.de [HETZNER-RZ-NBG-BLK4]**\n\n**Hetzner Online GmbH**\n\n**This server was the sole point of data exfiltration for each of the malware components. As detailed above for njRAT and NanoCore,�**\n\n**and below in Appendix B for DroidJack, the TCP ports used for command and control for each of the RAT tools were as follows:**\n\n**_Figure 27: RAT ports on the C2 server_**\n\n**Additionally, we believe a controller for yet another remote access trojan, XpertRAT, was also hosted on this IP in November 2015;**\n\n**however, we did not uncover any samples designed to communicate with this XpertRAT controller.**\n\n**As noted in the above table, the IP address 88.198.222[.]163 is assigned to Hetzner Online, a Germany based web hosting provider.**\n\n**Hetzner offers web hosting services as well as virtual and dedicated server rentals. Contact was made with Hetzner technical**\n\n**personnel subsequent to the discovery of the malicious activity outlined in this report. A synopsis of this contact is provided in**\n\n**Appendix F: Notification�.**\n\n**Current data available for this IP address suggests that it was likely reprovisioned to a different Hetzner customer in early February**\n\n**2016 at the latest, and then possibly again in May. A series of domain names associated with online multi-player games were**\n\n**[directed to this Hetzner IP, one of which was apparently hosting a malicious HTML document.](https://www.virustotal.com/en/file/dd55d13621a905d0f4c4dfe84c4d2b68769debe7a79cf1ce514940306da47c25/analysis/)**\n\n**Assadcrimes Web Hosting**\n\n**The assadcrimes[.]info domain name was registered in June 2015, but it remained parked until early October, at which time it was**\n\n**migrated to an Iran-based shared web hosting provider named Hostnegar. This action coincided with the delivery of the initial e-**\n\n**mails outlined in Part 1.**\n\n**The assadcrimes[.]info website was hosted on a shared hosting platform, and as such the IP address associated was also shared**\n\n**by a significant number of other, unrelated, websites.�**\n\n|IP|Reverse DNS PTR|Assignee|\n|---|---|---|\n|88.198.222[.]163|static.88-198-222-163.clients.your-server.de|HETZNER-RZ-NBG-BLK4 Hetzner Online GmbH|\n\n|IP|Reverse DNS PTR|\n|---|---|\n\n\n-----\n\n**g** **pp** **g** **g**\n\n**accessing the webmail application from the IP address of the command and control server discussed above.**\n\n**_Figure 28: Headers from the initial e-mail_**\n\n**Finally, available domain name service data indicates that the assadcrimes[.]info domain name was moved back to its original**\n\n**parked location on May 4, 2016.**\n\n# Appendix B: Android Malware Analysis\n\n## The Malicious APK – Overall Description\n\n**Figure 29: The malicious application is installed, and appears in the Apps tab (left), while hidden from the Apps list from the Drawer**\n\n**(right)**\n\n**Upon execution, the malware is installed and then hidden from the list of installed applications in order to remain covert.**\n\n\n-----\n\n**_Figure 30 : The malicious app gives an error ‘App isn’t installed’ when the_**\n\n**_user tries to open the malware before it disappears from the list._**\n\n**After the installation, the Application icon will be removed from the installed applications list, yet it will still be running in the**\n\n**background.**\n\n**The APK package in question had the following characteristics:**\n\n\n**Adobe_Flash_Player.apk**\n**MD5: 8EBEB3F91CDA8E985A9C61BEB8CDDE9D**\n\n\n**[This APK is an instance of DroidJack. According to Symantec, this application evolved from an older codebase known as](http://www.symantec.com/connect/blogs/droidjack-rat-tale-how-budding-entrepreneurism-can-turn-cybercrime)**\n\n**SandroRAT.**\n\n**The discovered APK sample also contains references to both names, as shown in Figure 31 below:**\n\n\n-----\n\n**The APK Manifest file reveals important information about the sample’s capabilities and the intentions of its operator. The Android�**\n\n**operating system requires information from the Manifest file before the application can execute. This application will request the�**\n\n**following permissions and use the following features from the device:**\n\n**_Figure 32: screenshot from Manifest file with the requested permissions for the APK�_**\n\n**In the Android system, Activities are components typically used to let the user of the device perform an action. The Main Activity is**\n\n**also defined in the Manifest, pictured in Figure 33.�**\n\n**_Figure 33: Main activity defined in the manifest�_**\n\n**In this case, the Main Activity is designed to start the Controller as a Service and finish. The controller will be discussed in more�**\n\n**detail in the next section.**\n\n**Android applications can also have Services and Receivers defined. Services are used for background operations while Receivers�**\n\n**define the types of broadcast messages the application can receive from other applications as well as the device. These messages�**\n\n**are known as Intents.**\n\n**This APK sample enables several services including “Controller,” “GPSLocation” and “Toaster” (See Figure 34).**\n\n**_Figure 34: Services enabled by the APK_**\n\n**The Controller class, referred to by the Main Activity and started as a service on the device, handles the malware operator’s**\n\n**interaction with the application while the GPSLocation class is responsible for obtaining the GPS position from the device’s**\n\n**LocationManager. The Toaster class is not implemented in this APK; however, it is implemented in older SandroRAT samples.**\n\n**The APK file has several Receiver classes defined to handle specific messages from the device (See Figure 35).�**\n\n\n-----\n\n**_Figure 35: Defined receiver classes�_**\n\n**Receiver**\n\n**Usage**\n\n**Intent**\n\n**Connectivity** **Allows the application to monitor any connectivity changes, including moving between mobile data and Wi-Fi. The**\n\n**Change** **constant value is set every time a change occurs.**\n\n**Boot** **Allows the application to re-connect when the device restarts. The constant value is broadcast when the device**\n\n**Completed** **finishes booting.�**\n\n**Phone State** **Allows the application to monitor incoming calls. The constant value is set when the call state is changed.**\n\n**The Connector Receiver simply starts the Controller Service when the phone boots allowing the malware to run in the background**\n\n**upon start up.**\n\n**The CallListener Receiver allows the operator to log when the target makes calls, and record calls (if the operator has enabled it) as**\n\n**an .amr file that can then be sent to the command and control server.�**\n\n**Lastly, in the Manifest file, the Application enables two additional Activities, “CAMSNAP” and “VIDEOCAP,” as shown in Figure 36.�**\n\n**_Figure 36: Activities enabling camera and video capture_**\n\n**These allow the operator to use the infected device’s camera to take pictures and record video. This activity is hidden from the victim**\n\n**using a translucent theme.**\n\n**The Malicious APK – The Controller**\n\n**As previously mentioned, the Controller class is ultimately responsible for the rest of the functionality. The instance we analyzed was**\n\n**configured to use the same host as the Windows malware for command and control communication: 88.198.222[.]163.�**\n\n**_Figure 37: DroidJack configuration showing that it shares a host�_**\n\n**_with the other Group5 malware_**\n\n|Receiver Intent|Usage|\n|---|---|\n|Connectivity Change|Allows the application to monitor any connectivity changes, including moving between mobile data and Wi-Fi. The constant value is set every time a change occurs.|\n|Boot Completed|Allows the application to re-connect when the device restarts. The constant value is broadcast when the device finishes booting.�|\n|Phone State|Allows the application to monitor incoming calls. The constant value is set when the call state is changed.|\n\n\n-----\n\n**Features offered include:**\n\n**File browsing**\n\n**SMS and call logging**\n\n**Contacts**\n\n**Browser history**\n\n**Application Manager**\n\n**Location history**\n\n**WhatsApp Reader (only works on rooted devices)**\n\n**Remote camera and microphone**\n\n**_Figure 38: DroidJack browsing WhatsApp logs for an infected device._**\n\n**Some features will only work on rooted devices. For example, the ability to read WhatsApp messages requires the victim’s device to**\n\n**be rooted. Android apps are unable to access the data from other applications unless they are signed with the same certificate or if�**\n\n**the app has been given permission to execute commands as root. If DroidJack is able to acquire root access it can then upload the**\n\n**database on the device where WhatsApp stores its message history.**\n\n# Appendix C: Mr. Tekide\n\n**This appendix provides more context on Mr. Tekide, first delving into how we have identified his crypter (PAC Crypt) in strings in the�**\n\n**binaries, and second highlighting the results of open source searching for his aliases and related strings.**\n\n## Sample Correlation With PDB Strings\n\n**In the Group5 malware samples, we have several PDB file references that suggest that the crypter used with the two distinct RAT�**\n\n**tools (njRat and NanoCore) was Mr. Tekide’s ‘PAC Crypt’. For the njRat sample from Dropper Doc 3, we can see the malware stub**\n\n**was compiled by ‘mr.tekide’ as well.**\n\n|Reference: Doc Dropper 1 Crypter|MD5: a4f1f4921bb11ff9d22fad89b19b155d|Compile Time: 9/30/2015 00:02:51|\n|---|---|---|\n|c:\\users\\mr.tekide\\documents\\visual studio 2013\\projects\\paccryptnano core dehgani -vds\\windowsapplication2\\obj\\debug\\launch manager.pdb|||\n\n|Reference: Doc Dropper 3 Crypter|MD5:6161083021b695814434450c1882f9f3|Compile Time: 10/6/2015 02:13:45|\n|---|---|---|\n\n\n-----\n\n|Reference: Doc Dropper 3 njRat Payload|MD5:b4121c3a1892332402000ef0d587c0ee|Compile Time: 10/6/2015 01:23:31|\n|---|---|---|\n|C:\\Users\\mr.tekide\\Documents\\Visual Studio 2013\\Projects\\njrat7stubsoures – Copy\\njrat7stubsoures\\obj\\Debug\\dvvm.pdb|||\n\n\n**The Visual Studio project folders listed above suggest the particular version of PAC Crypt compiled by Mr. Tekide was being**\n\n**prepared in one case for an njRat payload, and another for a NanoCore payload. The strings ‘dehgani –vds’, ‘malii’ and**\n\n**‘alipnahzade’ may have additional significance or relevance.�**\n\n**We conducted searches across online malware repositories and analysis services (such as VirusTotal, Malwr, and TotalHash) in an**\n\n**effort to acquire additional data relating to the use of PAC Crypt. These searches revealed very little in relation to PAC Crypt**\n\n**specifically, so we instead examined the data for instances of ‘tekide’ related strings found in PDB files.�**\n\n**It is our hope that the data or avenue of investigation presented below may be of value to other researchers.**\n\n**The results we examined contained over 200 samples which we then clustered into sets based on compile time and PDB reference**\n\n**as shown in the table below:**\n\n**The following compile time / PDB references were also observed in singular instances:**\n\n\n-----\n\n**Keeping in mind the limitations of reliance on compile times, we nevertheless were able to compare the noted compile times against**\n\n**the first time samples appeared in common malware repositories such as VirusTotal, Malwr, and TotalHash. In most instances,�**\n\n**samples began to appear in malware repositories within hours of the files being compiled. Dynamic analysis of the samples in these�**\n\n**sets revealed multiple different payloads and C2 configurations. For example, analysis of the samples in Set A yielded the following�**\n\n**payloads and configurations:�**\n\n**Finally, analysis of the compile times observed across the acquired samples suggest a period of activity falling in the latter half of**\n\n**2014. There are many possible explanations as to why so few samples were observed with compile times beyond 2014: conscious**\n\n**removal of PDB information, a change in personal circumstances, or possibly even a shift to less public malware development**\n\n**activities.**\n\n**Mr. Tekide on the Internet**\n\n**Mr. Tekide maintains a visible profile across various malware related web forums, as well as on social media. Searches conducted�**\n\n\n-----\n\n**_Figure 39: Mr. Tekide showcasing his ‘ashiyane crypter v.7’ on the Ashiyane forums_**\n\n\n-----\n\n**_Figure 40: Mr.Tekide’s administrator_**\n\n**_profile on the crypter[.]ir forums�_**\n\n\n-----\n\n**_Figure 41: PAC Crypt page on the crypter[.]ir online shop_**\n\n**[A link found on the ‘Contact’ page of the crypter[.]ir website led to a Facebook profile� in the name of ‘Pezhman Blackhat.’ In addition](https://www.facebook.com/tekide)**\n\n**[to this Facebook profile, we also identified a �LinkedIn profile� in which he refers to himself as a ‘crypter,’ and states that he works for](https://ir.linkedin.com/in/pezhman-tekide-a87054bb)**\n\n**[the ashiyane digital security team. He also maintains an Instagram profile�.](https://www.instagram.com/tekide/)**\n\n# Appendix D: File Hashes\n\n## Full Table of Binaries\n\n**VirusTotal (26-Jul-** **First Sub. on**\n**File** **MD5**\n\n**2016)** **VT**\n\n**Dropper Doc 1**\n\n**assadcrimes.ppsx** **76F8142B4E52C671871B3DF87F10C30C** **N/A** **N/A**\n\n**putty.exe [stage1 downloader]** **366908F6C5C4F4329478D60586ECA5BC** **N/A** **N/A**\n\n**dvm.exe [stage 2 payload]** **7D898530D2E77F15F5BADCE8D7DF215E** **N/A** **N/A**\n\n**Unpacked dvm.exe** **A4F1F4921BB11FF9D22FAD89B19B155D** **N/A** **N/A**\n\n**NanoCore RAT payload** **DD5BEDD915967C5EFE00733CF7478CB4** **N/A** **N/A**\n\n**Dropper Doc 2**\n\n**assadcrimes1.ppsx** **F1F84EA3229DCA0CCACB7381A2F49F99** **N/A** **N/A**\n\n**dvm.exe** **7D898530D2E77F15F5BADCE8D7DF215E** **N/A** **N/A**\n\n**Dropper Doc 3**\n\n**assadcrimes.info.ppsx** **30BB678DB3AD0140FC33ACD9803385C3** **N/A** **N/A**\n\n**putty.exe** **5C4EC3D93A664E4BFA1CE6286CCF0249** **N/A** **N/A**\n\n**Unpacked putty.exe** **6161083021B695814434450C1882F9F3** **N/A** **N/A**\n\n**njRAT payload** **B4121C3A1892332402000EF0D587C0EE** **N/A** **N/A**\n\n**Decoy Dropper 4**\n\n**alshohadaa alatfal.exe [decoy app]** **2FC276E1C06C3C78C6D7B66A141213BE** **N/A** **N/A**\n\n**dvm.exe [dropped by decoy app]** **494BAB7FD0B42B0B14051ED9ABBD651F** **14 / 55** **2-Mar-2016**\n\n**Unpacked dvm.exe** **6161083021B695814434450C1882F9F3** **N/A** **N/A**\n\n|File|MD5|VirusTotal (26-Jul- 2016)|First Sub. on VT|\n|---|---|---|---|\n|Dropper Doc 1||||\n|assadcrimes.ppsx|76F8142B4E52C671871B3DF87F10C30C|N/A|N/A|\n|putty.exe [stage1 downloader]|366908F6C5C4F4329478D60586ECA5BC|N/A|N/A|\n|dvm.exe [stage 2 payload]|7D898530D2E77F15F5BADCE8D7DF215E|N/A|N/A|\n|Unpacked dvm.exe|A4F1F4921BB11FF9D22FAD89B19B155D|N/A|N/A|\n|NanoCore RAT payload|DD5BEDD915967C5EFE00733CF7478CB4|N/A|N/A|\n|Dropper Doc 2||||\n|assadcrimes1.ppsx|F1F84EA3229DCA0CCACB7381A2F49F99|N/A|N/A|\n|dvm.exe|7D898530D2E77F15F5BADCE8D7DF215E|N/A|N/A|\n|Dropper Doc 3||||\n|assadcrimes.info.ppsx|30BB678DB3AD0140FC33ACD9803385C3|N/A|N/A|\n|putty.exe|5C4EC3D93A664E4BFA1CE6286CCF0249|N/A|N/A|\n|Unpacked putty.exe|6161083021B695814434450C1882F9F3|N/A|N/A|\n|njRAT payload|B4121C3A1892332402000EF0D587C0EE|N/A|N/A|\n|Decoy Dropper 4||||\n|alshohadaa alatfal.exe [decoy app]|2FC276E1C06C3C78C6D7B66A141213BE|N/A|N/A|\n|dvm.exe [dropped by decoy app]|494BAB7FD0B42B0B14051ED9ABBD651F|14 / 55|2-Mar-2016|\n\n\n-----\n\n**2016)** **VT**\n\n**njRAT payload** **B4121C3A1892332402000EF0D587C0EE** **N/A** **N/A**\n\n**Android Malicious APK (DroidJack)**\n\n**adobe_flash_player.apk�** **8EBEB3F91CDA8E985A9C61BEB8CDDE9D 23 / 53** **5-Jul-2016**\n\n**[These hashes are also available via the Citizen Lab Github.](https://github.com/citizenlab/malware-signatures/blob/master/Group5/hashes)**\n\n# Appendix E: Email Information\n\n**Date** **Sender** **subject** **IP** **Binary attached**\n\n**03 Oct 2015 06:05:41 -0700**\n\n**office@assadcrimes.info����** **��** **ا����ج** **����** **ا��ان** **88.198.222.163** **assadcrimes.ppsx**\n\n**(PDT)**\n\n**04 Oct 2015 05:47:00 -0700** **�** **ا����ج** **����** **ا��ان** **RoundCube**\n\n**office@assadcrimes.info�[Re: ]** **[�]** **assadcrimes1.ppsx**\n\n**(PDT)** **���** **(212.7.195.171)**\n\n# Appendix F: Notification�\n\n**On April 12, 2016 we contacted Hetzner via e-mail as well as their abuse form, and informed them that the server was being used to**\n\n**host malware. We also provided network logs as well as a malware sample. We subsequently followed up with two phone calls. On**\n\n**a telephone call, a Hetzner representative refused to investigate, stating that they would take no investigative action before sharing**\n\n**the content of our complaint with the customer, who would then have 24 hours to take action. When we suggested that this might**\n\n**result in the deletion of evidence, and highlighted the special nature of the case, the representative refused any further action.**\n\n**Footnotes[1] Noura has given her permission for us to disclose her role in this case, and use her photograph.**\n\n**2 Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/39.0**\n\n**3 http://ashiyane[.]org/forums**\n\n**[4 This technique has been documented previously.](http://phishme.com/powerpoint-and-custom-actions/)**\n\n## Post a Comment\n\n**Your email is never shared. Required fields are marked �***\n\n**Name ***\n\n**Email ***\n\n**Website**\n\n**Comment**\n\n**© Citizenlab 2016 |** **|**\n**[Contact](https://citizenlab.org/contact)** **[RSS](https://citizenlab.org/feed/)**\n\n|File Post Comment|MD5 Post Comment|VirusTotal (26-Jul- 2016) Post Comment|First Sub. on VT Post Comment|\n|---|---|---|---|\n|njRAT payload|B4121C3A1892332402000EF0D587C0EE|N/A|N/A|\n|Android Malicious APK (DroidJack)||||\n|adobe_flash_player.apk�|8EBEB3F91CDA8E985A9C61BEB8CDDE9D|23 / 53|5-Jul-2016|\n\n|Date|Sender|subject|IP|Binary attached|\n|---|---|---|---|---|\n|03 Oct 2015 06:05:41 -0700 (PDT)|office@assadcrimes.info|�\u0003 \u0002\u0001 \u0005 \u0004 ج \b\u0007ا \u000f\u000e نا\u0011\u0010ا|88.198.222.163|assadcrimes.ppsx|\n|04 Oct 2015 05:47:00 -0700 (PDT)|office@assadcrimes.info|Re: \u0005 \u0004 ج \b\u0007ا \u000f\u000e نا\u0011\u0010ا � \u0003\u0002\u0001|RoundCube (212.7.195.171)|assadcrimes1.ppsx|\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.08.02.group5-syria/group5-syria.pdf"
    ],
    "report_names": [
        "group5-syria"
    ],
    "threat_actors": [
        {
            "id": "cf0704ab-99e4-44d7-96d9-3cba91339229",
            "created_at": "2022-10-25T15:50:23.485375Z",
            "updated_at": "2025-03-27T02:00:55.482473Z",
            "deleted_at": null,
            "main_name": "Group5",
            "aliases": [
                "Group5"
            ],
            "source_name": "MITRE:Group5",
            "tools": [
                "njRAT",
                "NanoCore"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9aa9b489-a297-4dbd-8601-8fc0370201a6",
            "created_at": "2022-10-25T16:07:23.696796Z",
            "updated_at": "2025-03-27T02:02:09.928416Z",
            "deleted_at": null,
            "main_name": "Group5",
            "aliases": [],
            "source_name": "ETDA:Group5",
            "tools": [
                "Atros2.CKPN",
                "Bladabindi",
                "DroidJack",
                "Jorik",
                "Nancrat",
                "NanoCore",
                "NanoCore RAT",
                "Zurten",
                "njRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "59c9f31b-e032-44b9-bf3b-4f2cb3d17e39",
            "created_at": "2022-10-25T16:07:23.734244Z",
            "updated_at": "2025-03-27T02:02:09.952685Z",
            "deleted_at": null,
            "main_name": "Infy",
            "aliases": [
                "APT-C-07",
                "Infy",
                "Operation Mermaid",
                "Prince of Persia"
            ],
            "source_name": "ETDA:Infy",
            "tools": [
                "Foudre",
                "Infy",
                "Tonnerre"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9663cdbf-646e-4579-881a-a8ebc3aabf63",
            "created_at": "2023-01-06T13:46:38.360862Z",
            "updated_at": "2025-03-27T02:00:02.814167Z",
            "deleted_at": null,
            "main_name": "Cutting Kitten",
            "aliases": [
                "ITsecTeam"
            ],
            "source_name": "MISPGALAXY:Cutting Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f498e6b-3f0e-4f26-8cc7-52121e675643",
            "created_at": "2023-01-06T13:46:38.447274Z",
            "updated_at": "2025-03-27T02:00:02.835821Z",
            "deleted_at": null,
            "main_name": "Deadeye Jackal",
            "aliases": [
                "SyrianElectronicArmy"
            ],
            "source_name": "MISPGALAXY:Deadeye Jackal",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "094d8210-4c64-4457-ad97-a94fc7af7630",
            "created_at": "2023-01-06T13:46:38.98103Z",
            "updated_at": "2025-03-27T02:00:02.968603Z",
            "deleted_at": null,
            "main_name": "Group5",
            "aliases": [
                "G0043"
            ],
            "source_name": "MISPGALAXY:Group5",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "76fc6d92-0710-4640-bfa7-3000fe3940a5",
            "created_at": "2022-10-25T16:07:24.251595Z",
            "updated_at": "2025-03-27T02:02:10.151254Z",
            "deleted_at": null,
            "main_name": "Syrian Electronic Army (SEA)",
            "aliases": [
                "ATK 196",
                "Deadeye Jackal",
                "Syria Malware Team",
                "Syrian Electronic Army",
                "TAG-CT2"
            ],
            "source_name": "ETDA:Syrian Electronic Army (SEA)",
            "tools": [
                "AndoServer",
                "CypherRat",
                "SLRat",
                "SandroRAT",
                "SilverHawk",
                "SpyNote",
                "SpyNote RAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f763fd1f-f697-40eb-a082-df6fd3d13cb1",
            "created_at": "2023-01-06T13:46:38.561288Z",
            "updated_at": "2025-03-27T02:00:02.861874Z",
            "deleted_at": null,
            "main_name": "Infy",
            "aliases": [
                "Operation Mermaid",
                "Prince of Persia",
                "Foudre"
            ],
            "source_name": "MISPGALAXY:Infy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716498,
    "ts_updated_at": 1743041785,
    "ts_creation_date": 1470217891,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/514d58015cd8abe0f9d65a85100dded872d707f8.pdf",
        "text": "https://archive.orkl.eu/514d58015cd8abe0f9d65a85100dded872d707f8.txt",
        "img": "https://archive.orkl.eu/514d58015cd8abe0f9d65a85100dded872d707f8.jpg"
    }
}