{
    "id": "6c3bb0d6-d2ae-430a-ad63-7241e2975a11",
    "created_at": "2023-05-06T02:08:37.003762Z",
    "updated_at": "2025-03-27T02:06:12.111423Z",
    "deleted_at": null,
    "sha1_hash": "db340b4ada6e08e84f0315b137da96eabf1ae15e",
    "title": "2023-03-30 - 3CX Desktop App Compromised (CVE-2023-29059)",
    "authors": "",
    "file_creation_date": "2023-05-05T01:44:31Z",
    "file_modification_date": "2023-05-05T01:44:31Z",
    "file_size": 588785,
    "plain_text": "# 3CX Desktop App Compromised (CVE-2023-29059)\n\n**fortinet.com/blog/threat-research/3cx-desktop-app-compromised**\n\nFortiGuard Labs Threat Research\n\nBy [FortiGuard Labs | March 30, 2023](https://www.fortinet.com/blog/search?author=FortiGuard+Labs+)\n\n\nMarch 30, 2023\n\n\n_This is a developing story. Please check back for the latest updates from FortiGuard Labs. For a report of this event,_\n_[please visit our Threat Signal Reports page.](https://www.fortiguard.com/threat-signal-report/5102/supply-chain-attack-through-3cx-desktop-app?utm_source=blog&utm_medium=blog&utm_campaign=3cx-threat)_\n\nOn March 29, a number of reports surfaced that a legitimate signed file from VoIP/IP PBX solutions provider 3CX\n(3CXDesktop App) had been trojanized due to a code-level compromise. This is the latest high-profile supply chain\n[attack, beginning with SolarWinds and Kaseya a few years ago. This issue has been assigned CVE-2023-29059.](https://www.cvedetails.com/cve/CVE-2023-29059/)\n\n3CXDesktop App is a multi-platform softphone application for desktops (Linux, MacOS, and Windows). The\n3CXDesktop App allows users to interact via chat, messaging, video, and voice. Initial reports suggested that all\nplatforms of the 3CXDesktop App were compromised. But at the time of writing, it appears that only the Electron\nframework versions of MacOS (versions 18.11.1213, 18.12.402, 18.12.407, and 18.12.416) and Windows (versions\n[18.12.407 and 18.12.416) of the 3CX Desktop App are affected. 3CX has stated that they are working on a new version](https://www.3cx.com/blog/news/desktopapp-security-alert/)\nof the Windows app and have revoked the certificate for the previous version. Initially, there was some confusion about\n\n\n-----\n\nwhether the MacOS version was affected, as the CEO of 3CX issued a statement that only the Windows version of the\napp was affected. However, this statement was later [retracted. Currently, no status on the availability of the MacOS](https://www.3cx.com/blog/news/desktopapp-security-alert-updates/)\nversion has been provided at the time of writing.\n\nThe company’s website boasts that 3CX is available in over 190 countries worldwide, with over 12 million daily users\nand a 600,000-plus customer base. Companies listed on its website include high-profile organizations in the automobile,\naerospace, finance, food and beverage, government, hospitality, and manufacturing sectors, to name a few.\n\nThe trojanized 3CX Desktop App is part of a multi-stage attack that utilizes a malicious sideloaded DLL (ffmpeg.dll SHA256: 7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896) that contains instructions and\na payload within another DLL via an encrypted blob (d3dcompiler_47.dll – SHA256:\n11be1803e2e307b647a8a7e02d128335c448ff741bf06bf52b332e0bbf423b03). This blob also contains the shellcode,\nwhich tries to pull ICO files from GitHub (currently down) that contain various URIs for download, where the payload is\nultimately loaded and installed to the target environment. However, we could not confirm further details as the repository\nis currently down.\n\n## Discovery of Two 3CXDesktopApp.exes – but Only One Sideloads the Malicious DLL\n\nLooking at the Windows installer\n(SHA256:aa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868), it drops TWO\n3CXDesktopApp.exe files.\n\nThe SECOND (inside app-18.12.407 folder) is the one that sideloads the ffmpeg.dll file.\n\nC:\\Users\\Admin\\AppData\\Local\\Programs\\3CXDesktopApp\\3CXDesktopApp.exe\n\nFilesize: 541KB\n\nMD5: 08d79e1fffa244cc0dc61f7d2036aca9\n\nSHA1: 480dc408ef50be69ebcf84b95750f7e93a8a1859\n\nSHA256: 54004dfaa48ca5fa91e3304fb99559a2395301c570026450882d6aad89132a02\n\nC:\\Users\\Admin\\AppData\\Local\\Programs\\3CXDesktopApp\\app-18.12.407\\3CXDesktopApp.exe\n\nFilesize: 142MB\n\nMD5: bb915073385dd16a846dfa318afa3c19\n\nSHA1: 6285ffb5f98d35cd98e78d48b63a05af6e4e4dea\n\nSHA256: dde03348075512796241389dfea5560c20a3d2a2eac95c894e7bbed5e85a0acc\n\nFigure 1. Ffmpeg.dll starts call to \"malicious_payload\"\n\nFigure 2. Searching for the FEEDFACE marker\n\nFigure 3. “3jB(2bsG#@c7” string used to decrypt d3dcompiler_47.dll blob\n\n## Heatmap - Focus on Europe and North America\n\nBelow is a heat map based on recent connections to known malicious domains associated with this attack that\nFortiGuard Labs observed at the time of writing (March 31, 2023):st\n\nFigure 4. Heat map of the network activities associated with the 3CX supply chain attack\n\nBased on our telemetry, we see that the top 10 countries highlight the geographic spread of victim machines calling out\nto known actor controlled infrastructure; which appears to target European and North American victims more:\n\n\n-----\n\nFigure 5. Breakdown of the network activities by country\n\nThe following chart reveals a regional breakdown that further proves this point as close to 80 percent of the connections\nto the attacker controlled infrastructure are concentrated in Europe and North America. This may indicate that the threat\nactor is mainly targeting enterprises in those regions – however, this is uncertain. This could be indicative of 3CX\nproduct's geographic customer base - including the possibility of various multinational corporations operating inside\nthose regions.\n\nFigure 6. Regional breakdown of 3CX network activities\n\n## What Mitigations Are Available?\n\n3CX [suggests that users migrate to the PWA app in the meantime. The PWA app is web-based and is unaffected by the](https://www.3cx.com/user-manual/web-client/#h.85vdwzu7eh2a)\nsupply chain attack. Customers on 3CXHosted and StartUP are not affected. Additional details on updates and best\n[practices can be found here. FortiGuard Labs suggests that all older variants of the 3CX Desktop App be discontinued](https://www.3cx.com/blog/news/desktopapp-security-alert-updates/)\nimmediately until newer unaffected versions are available.\n\n## What is the Status of Coverage?\n\nFortinet Customers running the latest definitions are protected by the following AV signatures:\n\nW64/Agent.CFM!tr\n\nOSX/Agent.CN!tr\n\nRiskware/Sphone_XC3\n\nAll known network IOCs related to this attack are blocked by the WebFiltering client. For a detailed overview of all\n[Fortinet protections for this event, please visit our Outbreak Alerts page.](https://www.fortiguard.com/outbreak-alert/3cx-supply-chain-attack?utm_source=blog&utm_medium=blog&utm_campaign=outbreaks-alert)\n\n\n### Indicators of Compromise (IOCs) Hash\n\n\n### Detections\n\n\naa124a4b4df12b34e74ee7f6c683b2ebec4ce9a8edcf9be345823b4fdcf5d868 SHA2 Riskware/Sphone_XC3\n\n59e1edf4d82fae4978e97512b0331b7eb21dd4b838b850ba46794d9c7a2c0983 SHA2 Riskware/Sphone_XC3\n\n92005051ae314d61074ed94a52e76b1c3e21e7f0e8c1d1fdd497a006ce45fa61 SHA2 Riskware/Sphone_XC3\n\n5407cda7d3a75e7b1e030b1f33337a56f293578ffa8b3ae19c671051ed314290 SHA2 OSX/Agent.CN!tr\n\nb86c695822013483fa4e2dfdf712c5ee777d7b99cbad8c2fa2274b133481eadb SHA2 Riskware/Sphone_XC3\n\ne6bbc33815b9f20b0cf832d7401dd893fbc467c800728b5891336706da0dbcec SHA2 Riskware/Sphone_XC3\n\n11be1803e2e307b647a8a7e02d128335c448ff741bf06bf52b332e0bbf423b03 SHA2 W64/Agent.CFM!tr\n\n7986bbaee8940da11ce089383521ab420c443ab7b15ed42aed91fd31ce833896 SHA2 Riskware/Sphone_XC3\n\n\n-----\n\nc485674ee63ec8d4e8fde9800788175a8b02d3f9416d0e763360fff7f8eb4e02 SHA2 Riskware/Sphone_XC3\n\nb5e318240401010e4453e146e3e67464dd625cfef9cd51c5015d68550ee8cc09 SHA2 W64/Agent.CFM!tr\n\naa4e398b3bd8645016d8090ffc77d15f926a8e69258642191deb4e68688ff973 SHA2 W64/Sphone_XC3.INFS!tr.dldr\n\na64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67 SHA2 Riskware/Sphone_XC3\n\ndde03348075512796241389dfea5560c20a3d2a2eac95c894e7bbed5e85a0acc SHA2 Riskware/Sphone_XC3\n\nfad482ded2e25ce9e1dd3d3ecc3227af714bdfbbde04347dbc1b21d6a3670405 SHA2 Riskware/Sphone_XC3\n\nFortiEDR detects installation of the 3CX Desktop App with a dynamic code exception event:\n\nFortiEDR also blocks the final payload making a network connection to C2:\n\nFortiGuard Labs has released a new Application Control signature that will detect attempted 3CX access activity which\nwas released in definitions set (23.528):\n\n3CX\n\nRegarding FortiAnalyzer, a knowledge base article that contains detailed insight on how to detect activities related to the\n[3CX Supply Chain attack can be found here.](https://community.fortinet.com/t5/FortiAnalyzer/Technical-Tip-Using-FortiAnalyzer-to-detect-activities-related/ta-p/250880)\n\n## Network IOCs\n\nakamaicontainer[.]com\n\nakamaitechcloudservices[.]com\n\nazuredeploystore[.]com\n\nazureonlinecloud[.]com\n\nazureonlinestorage[.]com\n\ndunamistrd[.]com\n\nglcloudservice[.]com\n\njournalide[.]org\n\nmsedgepackageinfo[.]com\n\nmsstorageazure[.]com\n\nmsstorageboxes[.]com\n\nofficeaddons[.]com\n\nofficestoragebox[.]com\n\npbxcloudeservices[.]com\n\npbxphonenetwork[.]com\n\n\n-----\n\npbxsources[.]com\n\nqwepoi123098[.]com\n\nsbmsa[.]wikisourceslabs[.]com\n\nvisualstudiofactory[.]com\n\nzacharryblogs[.]com\n\nazureonlinestorage.com\n\nconvieneonline[.]com\n\nSoyoungjun[.]com\n\n### Related Posts\n\nCopyright © 2023 Fortinet, Inc. All Rights Reserved\n\n[Terms of ServicesPrivacy Policy](https://www.fortinet.com/corporate/about-us/legal.html)\n| Cookie Settings\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-30 - 3CX Desktop App Compromised (CVE-2023-29059).pdf"
    ],
    "report_names": [
        "2023-03-30 - 3CX Desktop App Compromised (CVE-2023-29059).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1683338917,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1683251071,
    "ts_modification_date": 1683251071,
    "files": {
        "pdf": "https://archive.orkl.eu/db340b4ada6e08e84f0315b137da96eabf1ae15e.pdf",
        "text": "https://archive.orkl.eu/db340b4ada6e08e84f0315b137da96eabf1ae15e.txt",
        "img": "https://archive.orkl.eu/db340b4ada6e08e84f0315b137da96eabf1ae15e.jpg"
    }
}