{
    "id": "2b372d48-46e9-45df-a7f9-93b6d13f8ed8",
    "created_at": "2022-10-25T16:48:11.437065Z",
    "updated_at": "2025-03-27T02:16:11.546757Z",
    "deleted_at": null,
    "sha1_hash": "26d05e39aa461719fe2b2cf00ac510e976374624",
    "title": "The Return of The Charming Kitten",
    "authors": "",
    "file_creation_date": "2018-12-23T06:48:20Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 87815,
    "plain_text": "# The Return of The Charming Kitten\n\n**blog.certfa.com/posts/the-return-of-the-charming-kitten/**\n\n### A review of the latest wave of organized phishing attacks by Iranian state- backed hackers\n\nCertfa Lab · 2018.12.13\n\n\nA review of the latest wave of organized phishing attacks by Iranian state-backed hackers\n\n\n# Abstract\n\nPhishing attacks are the most common form of infiltration used by Iranian state-backed\n[hackers to gain access into accounts. Certfa reviews the latest campaign of phishing](https://certfa.com/)\nattacks that has been carried out and dubbed as “The Return of The Charming Kitten”.\n\nIn this campaign, hackers have targeted individuals who are involved in economic and\nmilitary sanctions against the Islamic Republic of Iran as well as politicians, civil and\nhuman rights activists and journalists around the world.\n\nOur review in Certfa demonstrates that the hackers - knowing that their victims use twostep verification - target verification codes and also their email accounts such as Yahoo!\nand Gmail. As a result, Certfa believes the safest existing way to confront these attacks is\nusing Security Keys such as YubiKey.\n\n# Introduction\n\n[In early October 2018, MD0ugh, a Twitter user,1](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fn:1) revealed phishing attacks of a group of\nIranian hackers against US financial institution infrastructure. According to this user, these\nattacks could possibly be a reaction to new sanctions against Iran.\n\n\nThe account mentioned a domain with the address _accounts[-]support[.]services for the_\nfirst time. This domain is linked to a group of hackers who are supported by the Iranian\ngovernment, and that we believe have close ties with the Islamic Revolutionary Guard\n[Corps (IRGC). ClearSky2](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fn:2) has previously published detailed reports on their activities.\n\nA month after these attacks, the administrators of _accounts-support[.]services expanded_\ntheir activities and started targeting civil and human rights activists, political figures and\nalso Iranian and Western journalists.\n\n# Methods of Attacks\n\n\n-----\n\ntheir attacks. These methods can be put into two categories:\n\n1. Phishing attacks through unknown email or social media and messaging accounts\n2. Phishing attacks through email or social media and messaging accounts of public\n\nfigures, which have been hacked by the attackers\n\nWe have also found that the hackers have collected information on their targets prior to the\nphishing attack. The hackers design specific plans for each target based on the level of\ntargets’ cyber knowledge, their contacts, activities, working time, and their geographic\nsituation.\n\nWe also noticed that, unlike in previous phishing campaigns, in some cases the hackers did\nnot change the password of their victims’ accounts in these latest attacks. This allows\nthem to remain undetected and monitor a victim’s communications via their email in real\ntime.\n\n## Fake alerts of unauthorised access\n\nAccording to the samples of phishing attacks, the main trick used by these hackers to\ndeceive their targets is that of sending fake alerts through email addresses such as\n_notifications.mailservices@gmail[.]com, noreply.customermails@gmail[.]com,_\n_customer]email-delivery[.]info etc. stating that unauthorised individuals have tried to access_\ntheir accounts.\n\n\nFigure1. Illustration of safe and secure looking fake links\n\n\n### Figure1. Illustration of safe and secure looking fake links\n\nBy using this method, attackers pretend that the email provider has sent security alerts to\nthe targets and they should immediately review and restrict suspicious accesses. More\ndetails are available in the “Destination Link” section.\n\n## Fake file sharing on Google Drive\n\nSending links with titles such as share files from Google Drive has been one of the most\ncommon tricks that hackers have used in recent years. A unique point of these attacks in\n[comparison with the previous ones is that they use Google Site,3](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fn:3) which allows the hackers\nto show a fake download page of Google Drive, which tricks the users into thinking it’s a\nreal Google Drive page.\n\n\nFigure 2. A fake page of Google Drive file sharing page\n\n\n### Figure 2. A fake page of Google Drive file sharing page\n\nFor example, the hacker had used _hxxps://sites.google[.]com/view/sharingdrivesystem to_\ndeceive the users and convince them the page is the authentic Google Drive as users can\nsee google.com in the address bar of their browsers. Certfa has reported this link and\nsimilar links to Google and Google has now terminated them.\n\n\n-----\n\nhackers pretend to be sharing a file with the user, which they should download and run it on\ntheir devices. They use hacked Twitter, Facebook and Telegram accounts to send these links\nand target new users. The truth is there is not any file and the hackers use this page to direct\ntheir targets to the fake Google login page, which the users enter their credential details\nincluding 2 factor authentication.\n\n# The Attack Structure\n\nMost of these attacks are currently occurring through phishing emails. As a result, it would\nbe useful to take a look the original content in recent phishing campaigns.\n\n\nFigure 3. An example of codes of phishing email sent to the user\n\n\n### Figure 3. An example of codes of phishing email sent to the user\n\n## 1. Destination link\n\n**1.1. Trusted Stage: Internet users around the world consider Google’s main domain**\n(google.com) to be a safe and secure address. The attackers misuse this fact and create\nfake pages on sites.google.com (which is a subdomain of Google) to deceive their targets.\nGoogle’s Site service gives its users an ability to show various contents on it. The attackers\nuse this ability to send fake alerts and redirect their targets to insecure websites or\nembedded phishing pages as a iframe on those pages.\n\n\nFigure 4. How attackers misuse site.google.com\n\n\n### Figure 4. How attackers misuse site.google.com\n\n**1.2. Untrusted Stage: Since Google can quickly recognise and eliminate suspicious and**\nmalicious links on sites.google.com, the hackers use their own website. The links of\nphishing websites have similar patterns to a previous phishing campaign which was\nlaunched in the past years. For example, attackers use words such as “management”,\n“customize”, “service”, “identification”, “session”, “confirm” etc. in the domains name and\nphishing URLs to deceive users who want to verify their website addresses.\n\n## 2. Clickable image in emails\n\nThe hackers use an image, instead of texts, in the body of their emails, to bypass Google’s\nsecurity and anti-phishing system. For this purpose, attackers have also used third party\n[services such as Firefox Screenshot 4](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fn:4) to host their email images.\n\n\nFigure 5. An example of a planted image of fake alarm in a phishing email\n\n\n### Figure 5. An example of a planted image of fake alarm in a phishing email\n\n## 3. Hidden tracking image on emails\n\n\n-----\n\ntheir targets open the email. This trick helps the hackers to act immediately after the target\nopens the email and clicks on the phishing link.\n\n# Phishing Pages\n\nApart from the content structure of the emails and phishing links, we are sure that\nattackers use a customized platform to create and store users’ credential details. We have\nalso noticed that they have designed the phishing pages for both desktop and mobile\nversions of Google and Yahoo! mail services and they might use other services in the\nfuture.\n\nAn interesting technique they have used in recent attacks was once their target enters their\nusername and password, attackers check those credentials on-the-fly and if that\ninformation was given correctly, they then ask for 2-step verification code.\n\nIn other words, they check victims’ usernames and passwords in realtime on their own\nservers, and even if 2 factor authentication such as text message, authenticator app or\none-tap login are enabled they can trick targets and steal that information too.\n\nFigures 6 to 9 demonstrate some examples of the phishing pages, which have been sent to\nthe targets by the Iranian hackers.\n\n\nFigure 6. A fake page for entering password of Gmail accounts\n\n\n### Figure 6. A fake page for entering password of Gmail accounts\n\n\nFigure 7. A fake page for entering 2-step verification code for Gmail accounts\n\n\n### Figure 7. A fake page for entering 2-step verification code for Gmail accounts\n\n\nFigure 8. A fake page for entering password of Yahoo! accounts\n\n\n### Figure 8. A fake page for entering password of Yahoo! accounts\n\n\nFigure 9. A fake page for entering 2-step verification code for Yahoo! accounts\n\n\n### Figure 9. A fake page for entering 2-step verification code for Yahoo! accounts\n\n# Hacker’s Footprints\n\nOur primary reviews of the phishing websites linked to this campaign show that hackers\nhave set up a remarkable number of domains. Our latest findings show that for this\nphishing campaign in a relatively short period of time, (September to November 2018), they\nhave used more than 20 domain names. The number of phishing domains has increased at\nthe time of writing this report. Closer investigation of these servers revealed how their\nnetwork of domain names have been used in recent attacks.\n\n\n-----\n\n### gathered by Certfa5\n\nMoreover, our technical reviews reveal that the individuals, who are involved in this\ncampaign used Virtual Private Networks (VPNs) and proxies with Dutch and French IP\naddresses to hide their original location. In spite of their efforts, we have uncovered enough\nevidence to prove that the attackers were using their real IP addresses (i.e 89.198.179[.]103\nand 31.2.213[.]18 from Iran during the preparation phase of their campaign).\n\nAlso, some domain names and servers of this campaign are very similar to the methods,\ntechniques and targets that been used by Charming Kitten, a group of hackers who are\nlinked to the Iranian government. Consequently, we believe Charming Kitten and the Iranian\nhacker(s) belonging to this group have returned and launched new cyber attacks against\nvarious people around the world and with more focus on Israeli and American citizens.\n\n# Conclusion\n\nPhishing attacks are the most popular method of stealing data and hacking account\namongst Iranian hackers, but the most significant fact about this campaign is its timing.\nThis campaign launched weeks before 4 November 2018 which is when the U.S. imposed\nnew sanctions on Iran. This campaign tries to collect information by infiltrating the\naccounts of non-Iranian political figures and authorities who work on economic and\nmilitary sanctions against Iran.\n\nIn other words, hackers who are supported by the Iranian government pick their targets\naccording to policies and international interests for the Iranian government and also where\nIran wants to have impact indirectly.\n\nA a result, we propose a series of recommendations to tech companies, policymakers, civil\nsociety actors and internet users to effectively lessen the threat of this type of attack and\neven thwart them.\n\nOur recommendations to tech companies and policy makers:\n\nStop using 2 factor authentication by text plain message/SMS.\nStart using Security Keys (i.e. YubiKey) for 2 factor authentication for high ranking\nindividuals who have sensitive jobs or activities.\nDo not use one-tap login verification process.\n\nOur recommendations to civil society and the Iranian diaspora media:\n\nInform employees and colleagues about any phishing threats and encourage them to\nuse Security Keys such as Yubikey for 2 factor authentication and activate Google’s\nAdvanced Protection Program.\nAlways use company and institution email accounts instead of personal email for\n[sensitive communications. Change Sender Policy Framework or SPF6](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fn:6) settings\naccording to the communication policy of the company/organisation such as\nrestricting receiving emails from outside of the working network. For example, G\n\n\n-----\n\nEncourage the public to enable 2 factor authentication on their account by mobile\napps such as Google Authenticator.\n\nOur recommendations to users:\n\nDo not click on unknown links. For reviewing suspicious activities on your account or\nchange the password, instead of clicking on any link, you can go to your “My\nAccount” settings from your email directly which is more safer.\nUse email encryption such PGP for sensitive emails which prevent hackers reading\nyour emails in the first place.\nDo not store classified and sensitive information as a plain text in your mailbox.\nHTTPS being before a domain names in a URL does not mean that the content of a\nwebsite is secure or trusted - it’s just a secure extension of the HTTP protocol. Do not\nforget many phishing websites are currently operating under HTTPS protocol too.\n\n## IOCs\n\n178.162.132[.]65\n190.2.154[.]34\n190.2.154[.]35\n190.2.154[.]36\n190.2.154[.]38\n46.166.151[.]211\n51.38.87[.]64\n51.38.87[.]65\n51.68.185[.]96\n51.38.107[.]113\n95.211.189[.]45\n95.211.189[.]46\n95.211.189[.]47\n213.227.139[.]148\n54.37.241[.]221\n54.38.144[.]250\n54.38.144[.]251\n54.38.144[.]252\n85.17.127[.]172\n85.17.127[.]173\n85.17.127[.]174\n85.17.127[.]175\n89.198.179[.]103\n31.2.213[.]18\naccounts-support[.]services\nbroadcast-news[.]info\nbroadcastnews[.]pro\n\nid tifi i l [ ]i f\n\n\n-----\n\ncom-identifier-userservicelog[.]com\nconfirm-session-identification[.]info\nconfirm-session-identifier[.]info\nconfirmation-service[.]info\ncustomer-recovery[.]info\ncustomize-identity[.]info\ndocument-share[.]info\ndocument.support-recoverycustomers[.]services\ndocumentofficupdate[.]info\ndocuments.accounts-support[.]services\ndocumentsfilesharing[.]cloud\nemail-delivery[.]info\nmobile-sessionid.customize-identity[.]info\nmobiles-sessionid.customize-identity[.]info\nmy-scribdinc[.]online\nmyyahoo.ddns[.]net\nnotificationapp[.]info\nonlinemessenger.com-identifier-servicelog[.]name\npodcastmedia[.]online\nrecoveryusercustomer[.]info\nsession-management[.]info\nsupport-recoverycustomers[.]services\ncontinue-session-identifier[.]info\nmobilecontinue[.]network\nsession-identifier-webservice.mobilecontinue[.]network\ncom-messengersaccount[.]name\ninvitation-to-messenger[.]space\nconfirm-identification[.]name\nmobilecontinue[.]network\nmobile.confirm-identification[.]name\nservices.confirm-identification[.]name\nmobile-messengerplus[.]network\nconfirm.mobile-messengerplus[.]network\ncom-messengercenters[.]name\nsecuremail.mobile-messengerplus[.]network\ndocuments.mobile-messengerplus[.]network\nconfirm-identity[.]net\nidentifier-sessions-mailactivityid[.]site\nactivatecodeoption.ddns[.]net\nbroadcastpopuer.ddns[.]net\nbooks.com-identifier-servicelog[.]name\nmb.sessions-identifier-memberemailid[.]network\nsessions-identifier-memberemailid[.]network\nsessions.mobile-messengerplus[.]network\n\n[ ]\n\n\n-----\n\nbroadcastnews.ddns[.]net\naccount-profile-users[.]info\nus2-mail-login-profile[.]site\nus2.login-users-account[.]site\nlogin-users-account[.]site\nlive.account-profile-users[.]info\nsignin.account-profile-users[.]info\naol.account-profile-users[.]info\nusers-account[.]site\n\n## Footnotes:\n\n1. [https://s.certfa.com/q1514c](https://s.certfa.com/q1514c)\n\n[https://s.certfa.com/eNnnag](https://s.certfa.com/eNnnag)\n[https://s.certfa.com/ur93p2](https://s.certfa.com/ur93p2) [⇆](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fnref:1)\n2. ClearSkye Cyber Security (2018), “Charming Kitten, Iranian cyber espionage against\n\nhuman rights activists, academic researchers and media outlets - and the HBO\n[hacker connection”. Accessed November 15, 2018. https://s.certfa.com/1ulIxk](https://s.certfa.com/1ulIxk) [⇆](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fnref:2)\n3. Sites. Accessed November 23, 2018. [https://sites.google.com/](https://sites.google.com/) [⇆](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fnref:3)\n4. Firefox Screenshots. Accessed November 15, 2018. [https://screenshots.firefox.com/](https://screenshots.firefox.com/)\n\n[⇆](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fnref:4)\n5. VirusTotal Graph. Accessed November 25, 2018. [https://s.certfa.com/OgQUSC](https://s.certfa.com/OgQUSC) [⇆](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fnref:5)\n6. Sender Policy Framework or SPF is an email authentication method to detect forged\n\nsender addresses in emails. SPF allows the recipient to check that an email claiming\nto come from a specific domain comes from an IP address authorized by that\n[domain’s administrators. ⇆](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fnref:6)\n7. G Suite Administrator Help (2018), “Restrict messages to authorized addresses or\n\ndomains”. Accessed November 29, 2018.\n[https://support.google.com/a/answer/2640542?hl=en](https://support.google.com/a/answer/2640542?hl=en) [⇆](https://blog.certfa.com/posts/the-return-of-the-charming-kitten/#fnref:7)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.12.13.Charming_Kitten_Return/The%20Return%20of%20The%20Charming%20Kitten.pdf"
    ],
    "report_names": [
        "The Return of The Charming Kitten"
    ],
    "threat_actors": [
        {
            "id": "82b92285-4588-48c9-8578-bb39f903cf62",
            "created_at": "2022-10-25T15:50:23.850506Z",
            "updated_at": "2025-03-27T02:00:55.501372Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Charming Kitten"
            ],
            "source_name": "MITRE:Charming Kitten",
            "tools": [
                "DownPaper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "029625d2-9734-44f9-9e10-b894b4f57f08",
            "created_at": "2023-01-06T13:46:38.364105Z",
            "updated_at": "2025-03-27T02:00:02.815023Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Parastoo",
                "iKittens",
                "Group 83",
                "NewsBeef",
                "G0058",
                "CharmingCypress"
            ],
            "source_name": "MISPGALAXY:Charming Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041771,
    "ts_creation_date": 1545547700,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/26d05e39aa461719fe2b2cf00ac510e976374624.pdf",
        "text": "https://archive.orkl.eu/26d05e39aa461719fe2b2cf00ac510e976374624.txt",
        "img": "https://archive.orkl.eu/26d05e39aa461719fe2b2cf00ac510e976374624.jpg"
    }
}