{
    "id": "e06fc49f-281a-4a8b-aced-a9eb4434bc32",
    "created_at": "2023-05-06T02:09:51.223479Z",
    "updated_at": "2025-03-27T02:09:30.331586Z",
    "deleted_at": null,
    "sha1_hash": "cb6d3b29cb212be4f57cb2e0f737a8fc10f24699",
    "title": "2023-03-30 - GoatRAT Attacks Automated Payment Systems",
    "authors": "",
    "file_creation_date": "2023-05-05T02:04:59Z",
    "file_modification_date": "2023-05-05T02:04:59Z",
    "file_size": 617866,
    "plain_text": "# GoatRAT Attacks Automated Payment Systems\n\n**[labs.k7computing.com/index.php/goatrat-attacks-automated-payment-systems/](https://labs.k7computing.com/index.php/goatrat-attacks-automated-payment-systems/)**\n\nBy Lathashree K March 30, 2023\n\nRecently, we came across a detection in our telemetry report named “com.goatmw” which\ngained our attention. We decided to investigate further and the malware was found to be a\nbanking trojan.\n\nGoatRAT banking trojan is an Android Remote Administration Tool to gain access and\ncontrol targeted devices which carries out fraudulent money transactions using PIX key.\nThe domain goatrat[.]com (Fig.1) serves as the admin panel (which is not live as of writing\nthis blog) and contains telegram ids in its contact (Fig.2 and Fig.3).\n\nFig.1: Admin Panel (goatrat[.]com)\n\n\n-----\n\nFig.2: Telegram ID\n\nFig.3: Telegram ID\n\n## Technical Analysis\n\nOnce “com.goatmw” is installed, the malware initiates a service named “Server” (Fig.4)\nwhich establishes contact (Fig.5) with the C2 server (Fig.6) to obtain the PIX Key required\nto carry out fraudulent transactions.\n\n\n-----\n\nFig.4: Service is initiated\n\nFig.5: Establishes connection to C2\n\nFig.6:\nC2 server\nPIX key is used to make instant money transfer and is generated by encrypting personal\ndata such as Taxpayer ID number (CPF for individuals, CNPJ for companies) telephone\nnumber and email address (Fig.7).\n\nFig.7:\n\nPIX Key\nThe RAT then requests users to grant accessibility and overlay permission (Fig.8). Overlay\npermission enables it to present an overlay screen on targeted banking applications,\nmaking it look like a legitimate app’s screen so that the user enters their valid credentials\nwithout suspecting, which is then used to perform fraudulent money transfers.\n\nFig.8: Permissions requested\n\n\n-----\n\nThis malware targets certain Brazilian banks (Fig.9). When the user opens a banking\napplication it checks the package name with the targeted banking application’s package\nname.\n\nFig.9: Targeted banks\n\nWhen the targeted application is opened, the malware displays an overlay window that\nappears above the legitimate banking application (Fig.10). This overlay screen gets all the\nvalid credentials and sends it to C2 and it initiates the money transfer based on the bank\nbalance available (“Saldo disponivel” – balance available) in the user’s account (Fig.11).\n\nFig.10: Add Overlay screen\n\nFig.11: Balance available\n\nOnce the malware takes control, it requests a PIX key to initiate transfer (Fig.12). The\nmalware then enters the amount and PIX key to enable the money transfer and executes\nthe clicks and confirmation automatically “Pagar”- Pay, “CONFIRMAR” – Confirm (Fig.13),\nfrom the user logged in bank account without the user’s knowledge.\n\nFig.12: Request PIX key\n\n\n-----\n\nFig.13:\n\nConfirm and Pay\nOnce the money transfer is done using PIX key, the malware removes the overlay window\nfrom the targeted legitimate application (Fig.14).\n\nFig.14: Removes Overlay\nAndroid Banking Trojans are increasing rapidly. Malware authors are finding new\ntechniques to steal money from the users. One such technique was seen exploiting the\nPIX instant payment platform targeting Brazilian banks. This GoatRAT uses the ATS\nframework to carry out fraudulent money transactions. ATS is an Automated Transfer\nSystem, a new technique employed by banking malware wherein once the user logs in to\na banking app and enters their credentials, the malware would take control and\nautomatically enter the amount and initiate the transaction without the user’s knowledge.\nWe protect users from all these threats. Users are requested to install a reputable security\nproduct such as “K7 Mobile Security” and keep it updated to stay safe from such threats.\n\n## IOCs\n\n**PACKAGE_NAME** **DETECTION_NAME** **APK_MD5**\n\ncom.goatmw Trojan(0001140e1) ba5833b49e2c6501f5bbce90b7948a85\n\n\n-----\n\n### Targeted banking applications\n\nbr.com.intermedium\n\ncom.nu.production\n\nbr.com.uol.ps.myaccount\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-30 - GoatRAT Attacks Automated Payment Systems.pdf"
    ],
    "report_names": [
        "2023-03-30 - GoatRAT Attacks Automated Payment Systems.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338991,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1683252299,
    "ts_modification_date": 1683252299,
    "files": {
        "pdf": "https://archive.orkl.eu/cb6d3b29cb212be4f57cb2e0f737a8fc10f24699.pdf",
        "text": "https://archive.orkl.eu/cb6d3b29cb212be4f57cb2e0f737a8fc10f24699.txt",
        "img": "https://archive.orkl.eu/cb6d3b29cb212be4f57cb2e0f737a8fc10f24699.jpg"
    }
}