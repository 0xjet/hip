{
    "id": "ae80ad1b-c05f-4ba3-8003-7abbfa1caf89",
    "created_at": "2023-01-12T15:06:22.834161Z",
    "updated_at": "2025-03-27T02:05:29.822106Z",
    "deleted_at": null,
    "sha1_hash": "b8437c7700cffb0dd3b52f9348c6281ce4d05b14",
    "title": "2015-01-09 - Chanitor Downloader Actively Installing Vawtrak",
    "authors": "",
    "file_creation_date": "2022-05-29T10:49:26Z",
    "file_modification_date": "2022-05-29T10:49:26Z",
    "file_size": 751688,
    "plain_text": "# Chanitor Downloader Actively Installing Vawtrak\n\n**[zscaler.com/blogs/research/chanitor-downloader-actively-installing-vawtrak](https://www.zscaler.com/blogs/research/chanitor-downloader-actively-installing-vawtrak)**\n\nWe at ThreatLabZ are keeping an eye on a fairly active downloader called Chanitor. This\nmalware is being delivered via phishing emails purporting to be \"important\" documents, for\nexample, voicemails, invoices, and faxes; all are actually screensaver executables with the\nextension ‘.scr’. Another unique feature of this downloader Trojan family is the usage of\ntor2web.org and tor2web.ru over SSL for its Command & Control (C2) communication.\n\nUpon execution, Chanitor copies itself to ‘%APPDATA%\\Roaming\\Windows\\winlogin.exe’ by\nrunning the following command:\n\ncmd /D /R type \"C:\\<path-to-binary>\\winlogin.exe\" > ___ && move /Y ___ \"C:\\Users\\\n<username>\\AppData\\Roaming\\Windows\\winlogin.exe\"\n\nIt then waits for a few seconds before deleting the original file, and executes the copy via\nthe following command:\n\ncmd /D /R ping -n 10 localhost && del \"C:\\<path to original exe>\" && start /B \"\" \"C:\\Users\\\n<username>\\AppData\\Roaming\\Windows\\winlogin.exe\" && exit\n\nOnce the command executes, it creates a registry entry for persistence:\n\n\n-----\n\nChanitor encrypts some key components like C2 server locations that is decrypted only\nwhen used on run time. For example, \"tor2web.org\" is decrypted using a xor loop:\n\nThe next step is enumeration of functions for making outbound SSL connections and\nmaking connections to the command and control server. These connections are shown in\nthe screenshot below.\n\nThe first connection (#1 above) is to retrieve the public IP of the infected host. The success\nor failure of this request isn’t checked though, so the next request happens regardless. This\nrequest (#2) is a beacon to the command and control server on TOR via tor2web.org.\nChanitor uses SSL for all communication and beacons via POST requests to /gate.php. If\nthe request is successful, the C2 server will provide further instructions which during our\nanalysis was to download additional binary payload. The download is shown in session #3\nabove. Once the download finishes, there is a subsequent beacon which presumably\nmeans success (#4). Strangely enough, there is a failed request to tor2web.ru (#5). This\ndomain does not exist, so the purpose of this request is unknown.\n\nThe screenshot below shows detail of the initial beacon (#2) and server response to\ndownload a stage 2 binary:\n\nEach beacon takes the following form:\n\n\n-----\n\n{<MALWARE GENERATED UNIQUE IDENTIFIER>}<SHORT STRING><4 SPACE\nPADDING>}<USERDOMAIN><58 SPACE PADDING>}<IP ADDRESS>\n\nIf the request to api.ipify.org is unsuccessful, the IP address will be the machine's RFC1918\naddress instead of a public IP. The C2 server replies with an instruction to download a file\n(highlighted in red above) and the download is initiated immediately. The beacon\ninformation, with the exception of the IP address, is also stored in the registry:\n\nAfter downloading and reporting success, the original binary will then sleep for\napproximately 5 minutes (there's some variation for slightly longer and slightly shorter)\nbefore beaconing again:\n\n### Downloaded Binary\n\nThe downloaded binary is a dropper Trojan and is saved as C:\\Users\\\n<username>\\AppData\\Local\\Temp\\__<4 alphanumeric characters>.exe. Chanitor will run\nthe downloaded payload via the following command:\n\ncmd /D /R start /B \"\" \"C:\\Users\\<username>\\AppData\\Local\\Temp\\___16AE.exe\" && exit\n\nUpon execution, the binary checks for the presence of a debugger. If no debugger is found,\nthe binary then unpacks an embedded DLL and writes it to disk. This DLL is a new variant\nof the Vawtrak Trojan.\n\n\n-----\n\nThe DLL is registered with regsvr32.exe via the following command to ensure persistence:\n\nThe Vawtrak dropper Trojan then deletes itself from the target system. The Vawtrak dropper\nbinary and the DLL are compressed using aPLib v1.01 library as seen below:\n\nVawtrak, also known as NeverQuest and Snifula, is a powerful information stealing\nbackdoor Trojan that has been gaining momentum over past few months. It primarily targets\nuser's bank account via online banking websites.\n\n### Indicators of Compromise\n\n**C2 Domains**\n\nhttps://svcz25e3m4mwlauz.tor2web[.]org/gate.php\n\nhttps://ho7rcj6wucosa5bu.tor2web[.]org/gate.php\n\n\n-----\n\nhttps://o3qz25zwu4or5mak.tor2web[.]org/gate.php\nhttps://lctoszyqpr356kw4.tor2web[.]org/gate.php\n\n**File Locations**\n\nC:\\Users\\<username>\\AppData\\Roaming\\Windows\\winlogin.exe\n\nC:\\ProgramData\\TigaPjopw\\VofcOhhel.zvv -- these names appear random\n\nC:\\Users\\<username>\\AppData\\Local\\Temp\\~004BFD62.tmp -- this name appears random\n\nC:\\Users\\<username>\\AppData\\Local\\Temp\\___16AE.exe -- this name appears random\n\n### Conclusions\n\nThe samples collected date back to the beginning of October 2014 and have changed in\nmeasurable ways over the past few months. The first samples would not run on Windows 7\nunless in compatibility mode, required administrative privileges, and did not have icons that\nmatched the purported filetype or theme, but the recent samples have evolved to run\nwithout errors and appear to be more refined. We attempted to contact tor2web at\n\n[[email protected] and at](https://www.zscaler.com/cdn-cgi/l/email-protection#4d2c2f383e280d39223f7f3a282f63223f2a) [[email protected] and received bouncebacks followed a few days](https://www.zscaler.com/cdn-cgi/l/email-protection#5f363139301f2b302d6d283a3d71302d38)\nlater by a delivery failure notification. Since the C2 servers are hosted on TOR, tracking the\nindividuals behind this campaign may prove difficult, but blocking access to tor2web would\nbe effective for the time being.\n\n## Stay up to date with the latest digital transformation tips and news.\n\n[By submitting the form, you are agreeing to our privacy policy.](https://www.zscaler.com/privacy-compliance/privacy-policy)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-01-09 - Chanitor Downloader Actively Installing Vawtrak.pdf"
    ],
    "report_names": [
        "2015-01-09 - Chanitor Downloader Actively Installing Vawtrak.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535982,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1653821366,
    "ts_modification_date": 1653821366,
    "files": {
        "pdf": "https://archive.orkl.eu/b8437c7700cffb0dd3b52f9348c6281ce4d05b14.pdf",
        "text": "https://archive.orkl.eu/b8437c7700cffb0dd3b52f9348c6281ce4d05b14.txt",
        "img": "https://archive.orkl.eu/b8437c7700cffb0dd3b52f9348c6281ce4d05b14.jpg"
    }
}