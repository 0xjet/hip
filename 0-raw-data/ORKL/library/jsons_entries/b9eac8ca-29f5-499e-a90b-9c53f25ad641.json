{
    "id": "b9eac8ca-29f5-499e-a90b-9c53f25ad641",
    "created_at": "2023-06-05T02:07:10.092071Z",
    "updated_at": "2025-03-27T02:10:10.311663Z",
    "deleted_at": null,
    "sha1_hash": "8c4da0cfbc8f26d668620eb56fa8586d99ce585b",
    "title": "2023-05-11 - Stealthier version of Linux BPFDoor malware spotted in the wild",
    "authors": "",
    "file_creation_date": "2023-06-04T12:45:44Z",
    "file_modification_date": "2023-06-04T12:45:44Z",
    "file_size": 824256,
    "plain_text": "# Stealthier version of Linux BPFDoor malware spotted in the wild\n\n**[bleepingcomputer.com/news/security/stealthier-version-of-linux-bpfdoor-malware-spotted-in-the-wild/](https://www.bleepingcomputer.com/news/security/stealthier-version-of-linux-bpfdoor-malware-spotted-in-the-wild/)**\n\nBill Toulas\n\nBy\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nMay 11, 2023\n06:02 PM\n0\n\nA new, stealthier variant of the Linux malware 'BPFDoor' has been discovered, featuring\nmore robust encryption and reverse shell communications.\n\nBPFDoor is a stealthy backdoor malware that has been active since at least 2017 but was\n[only discovered by security researchers around 12 months ago.](https://www.bleepingcomputer.com/news/security/bpfdoor-stealthy-linux-malware-bypasses-firewalls-for-remote-access/)\n\nThe malware gets its name from the use of the 'Berkley Packet Filter' (BPF) for receiving\ninstructions while bypassing incoming traffic firewall restrictions.\n\nBPFDoor is designed to allow threat actors to maintain lengthy persistence on breached\nLinux systems and remain undetected for extended periods.\n\n\n-----\n\n## New BPFDoor version\n\nUntil 2022, the malware used RC4 encryption, bind shell and iptables for communication,\nwhile commands and filenames were hardcoded.\n\n[The newer variant analyzed by Deep Instinct features static library encryption, reverse shell](https://www.deepinstinct.com/blog/bpfdoor-malware-evolves-stealthy-sniffing-backdoor-ups-its-game)\ncommunication, and all commands are sent by the C2 server.\n\n**Differences between the old and new versions** _(Deep Instinct)_\nBy incorporating the encryption within a static library, the malware developers achieve better\nstealth and obfuscation, as the reliance on external libraries like one featuring the RC4\ncipher algorithm is removed.\n\nThe main advantage of the reverse shell against the bind shell is that the former establishes\na connection from the infected host to the threat actor's command and control servers,\nallowing communication to the attackers' servers even when a firewall protects the network.\n\nFinally, removing hardcoded commands makes it less likely for anti-virus software to detect\nthe malware using static analysis like signature-based detection. It theoretically also gives it\nmore flexibility, supporting a more diverse command set.\n\nDeep Instinct reports that the latest version of BPFDoor is not flagged as malicious by any\navailable AV engines on VirusTotal, despite its first submission on the platform dating\nFebruary 2023.\n\n## Operation logic\n\nUpon first execution, BPFDoor creates and locks a runtime file at \"/var/run/initd.lock,\" and\nthen forks itself to run as a child process, and finally sets itself to ignore various OS signals\nthat could interrupt it.\n\n\n-----\n\n**OS signals the malware is set to ignore** _(Deep Instinct)_\nNext, the malware allocates a memory buffer and creates a packet sniffing socket that it'll\nuse for monitoring incoming traffic for a \"magic\" byte sequence\n(\"\\x44\\x30\\xCD\\x9F\\x5E\\x14\\x27\\x66\").\n\n**Looking for the magic byte sequence** _(Deep Instinct)_\nAt this stage, BPFDoor attaches a Berkley Packet Filter to the socket to read only UDP, TCP,\nand SCTP traffic through ports 22 (ssh), 80 (HTTP), and 443 (HTTPS).\n\n\n-----\n\nAny firewall restrictions present on the breached machine won t impact this sniffing activity\nbecause BPFDoor operates at such a low level that they're not applicable.\n\n**BPF on a**\n\n**socket** _(Deep Instinct)_\n\"When BPFdoor finds a packet containing its \"magic\" bytes in the filtered traffic, it will treat it\nas a message from its operator and will parse out two fields and will again fork itself,\"\nexplains Deep Instinct.\n\n\"The parent process will continue and monitor the filtered traffic coming through the socket\nwhile the child will treat the previously parsed fields as a Command & Control IP-Port\ncombination and will attempt to contact it.\"\n\nAfter establishing a connection with the C2, the malware sets up a reverse shell and waits for\na command from the server.\n\n\n-----\n\n**Operational diagram**\n\n_(Deep Instinct)_\nBPFDoor [remains undetected by security software, so system admins may only rely on](https://web.archive.org/save/https://www.virustotal.com/gui/file/afa8a32ec29a31f152ba20a30eb483520fe50f2dce6c9aa9135d88f7c9c511d7)\nvigorous network traffic and logs monitoring, using state-of-the-art endpoint protection\nproducts, and monitor the file integrity on \"/var/run/initd.lock.\"\n\n[Also, a May 2022 report by CrowdStrike highlighted that BPFDoor used a 2019 vulnerability](https://www.bleepingcomputer.com/news/security/bpfdoor-malware-uses-solaris-vulnerability-to-get-root-privileges/)\nto achieve persistence on targeted systems, so applying the available security updates is\nalways a crucial strategy against all types of malware.\n\n### Related Articles:\n\n[New PowerExchange malware backdoors Microsoft Exchange servers](https://www.bleepingcomputer.com/news/security/new-powerexchange-malware-backdoors-microsoft-exchange-servers/)\n\n[RomCom malware spread via Google Ads for ChatGPT, GIMP, more](https://www.bleepingcomputer.com/news/security/romcom-malware-spread-via-google-ads-for-chatgpt-gimp-more/)\n\n[‘Operation Magalenha’ targets credentials of 30 Portuguese banks](https://www.bleepingcomputer.com/news/security/operation-magalenha-targets-credentials-of-30-portuguese-banks/)\n\n\n-----\n\n[Cybercrime gang pre-infects millions of Android devices with malware](https://www.bleepingcomputer.com/news/security/cybercrime-gang-pre-infects-millions-of-android-devices-with-malware/)\n\n[VirusTotal AI code analysis expands Windows, Linux script support](https://www.bleepingcomputer.com/news/security/virustotal-ai-code-analysis-expands-windows-linux-script-support/)\n\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nBill Toulas is a technology writer and infosec news reporter with over a decade of experience\nworking on various online publications. An open source advocate and Linux enthusiast, is\ncurrently finding pleasure in following hacks, malware campaigns, and data breach incidents,\nas well as by exploring the intricate ways through which tech is swiftly transforming our lives.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-05-11 - Stealthier version of Linux BPFDoor malware spotted in the wild.pdf"
    ],
    "report_names": [
        "2023-05-11 - Stealthier version of Linux BPFDoor malware spotted in the wild.pdf"
    ],
    "threat_actors": [
        {
            "id": "d58052ba-978b-4775-985a-26ed8e64f98c",
            "created_at": "2023-09-07T02:02:48.069895Z",
            "updated_at": "2025-03-27T02:02:10.181465Z",
            "deleted_at": null,
            "main_name": "Tropical Scorpius",
            "aliases": [
                "DEV-0978",
                "RomCom",
                "Storm-0978",
                "Tropical Scorpius",
                "UNC2596",
                "Void Rabisu"
            ],
            "source_name": "ETDA:Tropical Scorpius",
            "tools": [
                "COLDDRAW",
                "Cuba",
                "Industrial Spy",
                "PEAPOD",
                "ROMCOM",
                "ROMCOM RAT",
                "SingleCamper",
                "SnipBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "555e2cac-931d-4ad4-8eaa-64df6451059d",
            "created_at": "2023-01-06T13:46:39.48103Z",
            "updated_at": "2025-03-27T02:00:03.105297Z",
            "deleted_at": null,
            "main_name": "RomCom",
            "aliases": [
                "Storm-0978",
                "UAT-5647"
            ],
            "source_name": "MISPGALAXY:RomCom",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1685930830,
    "ts_updated_at": 1743041410,
    "ts_creation_date": 1685882744,
    "ts_modification_date": 1685882744,
    "files": {
        "pdf": "https://archive.orkl.eu/8c4da0cfbc8f26d668620eb56fa8586d99ce585b.pdf",
        "text": "https://archive.orkl.eu/8c4da0cfbc8f26d668620eb56fa8586d99ce585b.txt",
        "img": "https://archive.orkl.eu/8c4da0cfbc8f26d668620eb56fa8586d99ce585b.jpg"
    }
}