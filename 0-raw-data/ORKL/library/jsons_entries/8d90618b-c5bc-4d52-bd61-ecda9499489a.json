{
    "id": "8d90618b-c5bc-4d52-bd61-ecda9499489a",
    "created_at": "2022-10-25T16:48:20.1462Z",
    "updated_at": "2025-03-27T02:16:59.243587Z",
    "deleted_at": null,
    "sha1_hash": "10c2d6c60b4a34422a12c7583624c4764b815ba6",
    "title": "“Red October”. Detailed Malware Description 3. Second Stage of Attack",
    "authors": "",
    "file_creation_date": "2018-12-21T03:33:56Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 121974,
    "plain_text": "# “Red October”. Detailed Malware Description 3. Second Stage of Attack\n\n**[securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)**\n\nBy GReAT\n\n## First stage of attack\n\n1. [Exploits](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#exploits)\n2. [Dropper](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#dropper)\n3. [Loader Module](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#loader)\n4. [Main component](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#main-component)\n\n## Second stage of attack\n\n1. [Modules, general overview](https://securelist.com/red-october-detailed-malware-description-2-second-stage-of-attack/36842/)\n2. [Recon group](https://securelist.com/red-october-detailed-malware-description-2-second-stage-of-attack/36842/)\n3. [Password group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n4. [Email group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n5. [USB drive group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n6. [Keyboard group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n7. [Persistence group](https://securelist.com/red-october-detailed-malware-description-4-second-stage-of-attack/36884/)\n8. [Spreading group](https://securelist.com/red-october-detailed-malware-description-4-second-stage-of-attack/36884/)\n9. [Mobile group](https://securelist.com/red-october-detailed-malware-description-5-second-stage-of-attack/36879/)\n10. [Exfiltration group](https://securelist.com/red-october-detailed-malware-description-5-second-stage-of-attack/36879/)\n\n## 3. Password group\n\n### PswSuperMailRu module\n\nKnown variants:\n\n**MD5** **Size** **Compilation date (payload)**\n\n7b669c32e6ee2c65bec5e09024fc5415 237,568 January 14th, 2011\n\nb7327bfa4a101a21f0cc1b366aa8e107 237,568 March 29th, 2011\n\na39fa7340b2f1d7b42342b3e2f06df71 266,24 August 16th, 2010\n\ncd170625655424149573c88c59716cc4 270,336 February 11, 2011\n\nf60436b984962e741b81720ea604ad27 241,664 August 16th, 2010\n\n2cf23cd8a7f85529576ba6c759f8cf37 270,336 March 29th, 2011\n\n9bb32272be87a4dde8c8b05f49ded9f7 266,24 January 14th, 2011\n\ned72b6150e9fbc8f71e61dfea682a303 237,568 February 11th, 2011\n\n\n-----\n\nStudio 2005. It is written in C/C++.\n\n#### Entrypoint, unpacking stub, and obfuscation\n\nRelated binaries are heavily packed with a custom packer. The packer disrupts basic\nsoftware breakpoints and some api hooking techniques, because it decrypts the original\nexe’s section contents onto heaps in-memory and then writes the decrypted code and\n.data, .rdata contents back over the original sections, hopping back into the decrypted code\nand executing from there.\n\n#### Summary\n\nAt its OEP, the module further retrieves environment information, and then creates a mutex\nwith the string “SUPER MUTEX”. Then the module steals authentication credentials from\nmail.ru agent software and attempts to steal open and saved attachments on the system\nfrom the Outlook Secure Temp Folder. The executable then fails to write its own contents\nto another executable file in tmp and maintain persistence on the system. Network\nfunctionality is absent from this module.\n\n#### Credential Stealing\n\nThe module steals Mail.Ru Mail Agent account credentials by reading relevant registry in\norder to extract the passwords or decrypt them depending of the version. The two locations\nthis data is accessed are\n\nRegistry key/value pair for Mail.Ru Agent version < 5.2\nRegistry key: HKCUSoftwareMail.RuAgentmagent_logins,\nbinary value: ####password\nRegistry key/value pair for Mail.Ru Agent version 5.2 to 5.6\nRegistry key: HKCUSoftwareMail.RuAgentmagent_logins2\nbinary value: ####password\nRegistry key/value pair for Mail.Ru Agent version >= 5.7 (Last version 6 is also\nsupported)\nRegistry key: HKCUSoftwareMail.RuAgentmagent_logins3\nbinary value: ####password\nText file used by Mail.Ru Agent to store Blowfish encryption key\n%APPDATA%MraUpdatever.txtThe contents of this registry keys are read and the\nblowfish key stored inside “ver.txt” is used to decrypt the passwords, in version 5.7\nand above.All actions are logged with time stamp, and then encrypted and written to\n%temp%~avp2.log.The module will attempt to access “ver.txt” which is protected on\nthe system. If it can read it using standard API functions, it uses NTFS low level\n**access.In order to do so, it uses the DeviceIoControl API function with the**\n“FSCTL_GET_NTFS_VOLUME_DATA” and “FSCTL_GET_NTFS_FILE_RECORD”\nIOCTLs.The data of this file will also be written to %temp%~mslog.tmp, which is a\nbackup of “ver.txt”After the module will build a new string with the current timestamp\nfollowed by delimiting dashes and indication that the module has finished running,\nlike “2012:11:10:10:22:34——-PROGA END“ This string will be written to the\n\n\n-----\n\n2012:11:22:17:21:44”——-PROGA START—–\n“2012:11:22:17:21:44″ERROR ACCESS file ver.txt\n“2012:11:22:17:21:44″FILE SYSTEM NTFS\n“2012:11:22:17:21:44″PROBING GET FILE LOW LIVEL\n“2012:11:22:17:21:44″ACCESS LOW LIVEL OK!!!!\n“2012:11:22:17:21:44″REG OPEN KEY[SoftwareMail.RuAgentmagent_logins3]\n“2012:11:22:17:21:44″SUB KEY[000#victim@mail.ru] “2012:11:22:17:21:44″uin(0)\n\n[000#victim@mail.ru] passwd(0)[%removed%] “2012:11:22:17:21:44”——-PROGA END\n—–\nThe string between “[” and “]” is binary value of MD5 Hash of the Mail.ru Agent\npassword.All restored credentials are also stored encrypted in the “~pass2.pwl” file\nwithout the time stamp information and how they were accessed.Meanwhile\n“PROGA” word used in here might refer to transliteration of Russian slang\n“ПРО”which literally means an application or a program.\n#### Attachment stealing\n\nThe module will finally attempt to steal open attachments or attachments that were\nopen when the machine or Outlook application shutdown unexpectedly. It identifies\nand collects these files from a directory path that looks like “C:\\Documents and\nSettings\\%username%\\Local Settings\\Temporary Internet Files\\OLK%xxx%“.\n\n#### Failed persistence\n\nThe module then attempts to maintain some persistence on the system by repeating\nthe routine. It creates %temp%\\19d400.msv, and attempts to write a copy of its own\nexecutable contents to it. Oddly, the WriteFile size parameter is set to “0” and the\nwrite fails. It then attempts to run this 19d400.msv file by calling CreateProcessA on\nit, which also fails. The module thread terminates the process.\n\nFinally, it is interesting that network functionality is absent from this module.\n\n#### Interesting decrypted runtime strings:\n\n19d400.msv\nSoftware\\Mail.Ru\\Agent\\magent_logins2\nSoftware\\Mail.Ru\\Agent\\magent_logins\n~pass.pwl\n~avp.log\nwww.mail.ru\nProcessRead ok!\nOPEN PROCESS agent_mail.ru OK!\n%s——-PROGA END—–\n——-PROGA START—–\nSUPER MUTEX\n19d400.msv\n~mslog.tmp\n%sPROBING GET FILE LOW LIVEL\n%sACCESS LOW LIVEL OK!!!!\n\n\n-----\n\n#### PswOutlook module\n\nKnown variants:\n\n**MD5** **Compilation date**\n\nf6e1637e04b33a3e0c57ab355d3e677e 2010.11.30 07:10:32 (GMT)\n\nfa66821fd895b3814e501b804176ef98 2011.02.23 12:41:29 (GMT)\n\n#### Summary\n\nThe file is a PE EXE file, compiled with Microsoft Visual Studio 2008. All the\nfunctionality is implemented in the WinMain function. There are 2 known variants of\nthis module in over 50 files with identical behavior.\n\nLike PswSuperMailru, this highly-obfuscated module is very different from others. Its\nmain purpose is to steal email credential information of the current user. This is\nachieved by reading system protected storage and system registry. The result is\nstored in an encrypted file, after that the application self-removes.\n\n#### Main function\n\nThis module starts from decrypting pieces of information carefully puzzled in the file\nbody. The puzzle contains extra library names, export function names, their\nparameters and set of internal references. The encryption algorithm reminds PKZIP\nencryption but seems to be modified.\n\nDecrypted data is carefully collected and filled in a set of internal objects. Next,\nmodule connects to the local registry using RegConnectRegistry system API call.\nThis is not clear why the developers decided to use RegConnectRegistry call. They\neither tried to bypass some local IDS/IPS systems by avoiding usage of\nRegOpenKey/RegOpenKeyEx calls or the application was designed to connect to\nremote computers as well. In all samples we have\nobserved, lpMachineName parameter is set to NULL meaning to connect to local\nregistry.\n\nIt dumps MS Outlook account information from the following registry keys:\n\nHKCU\\Software\\Microsoft\\Internet Account Manager\nHKCU\\Software\\Microsoft\\Office\\Outlook\\OMI Account Manager\\Accounts\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging\nHKCU\\Subsystem\\Profiles\\Microsoft\\Outlook Internet Settings\nHKCU\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windows Messaging\nSubsystem\\Profiles\\Outlook\n\nAfter that it attempts to access and dump local protected storage identities\ninformation via PStorec.dllAPI.\n\nCollected information is stored in encrypted file: %Temp%\\{B30BD41D-46E7-458B\n\n-----\n\ntool. In the end of execution before exiting application it runs self-removal procedure\nas described below.\n\n#### Self-removal procedure\n\nWhen the module needs to end the execution and self-remove, it spawns a\n%COMSPEC% process (cmd.exe or command.com on older\nsystems) HKCU\\Software\\Microsoft\\Internet Account Managerusing the following\ncommandline:\n\ncmd.exe /c del /F /A “%MODULE_PATH%”>> NULL\n\nThis procedure is very unreliable as it is prone to race-condition issues which might\nresult in modules remaining undeleted.\n\n#### MSHash module\n\nKnown variants:\n\n**MD5** **Compilation date**\n\n3538fea2c2f9a7117a6a919c87112731 2011.11.01 15:04:58 (GMT)\n\na008d1ec659c3758e95bc3f0aafbe3a5 2011.08.05 07:40:37 (GMT)\n\n68d72e12c402038195175b568b3dd0bb 2012.10.22 07:01:30 (GMT)\n\n4b62cc78508b46d74cdd172dc493ec8a 2011.11.01 15:04:58 (GMT)\n\n#### Summary\n\nThis module is a standalone executable, which is essentially a tool to dump cached\ndomain password hashes, and locally stored sensitive information, such as LSA\nsecrets. It uses direct disk access to bypass system registry ACLs. After execution\nthe module self-removes.\n\nFirst, it uses direct disk access to copy registry files from %SYSTEM%\\config\\\ndirectory:\n\n%SYSTEM%\\config\\sam -> %Temp%\\ksm\n%SYSTEM%\\config\\system -> %Temp\\kss\n%SYSTEM%\\config\\SECURITY -> %Temp%\\kse\n\nThen module fetches available cached domain account hashes as well as local\nsystem LSA secrets. The later may contain logins and passwords from various\nservices in plaintext. Also, it fetches Syskey bootkey secret and appends it to the\noutput.\n\nThe result is stored in an encrypted file of custom binary format which is located\nin%TMP%\\smrdprev.tmp. The contents of the file contains internal file reference\nstring, including date and time when it was created, i.e.\n“@MSHASH\\SAMHASH_2_20121002_034519.txt“. This is probably suggested\nrelative path and file name during data extraction procedure on the attackers system\n\n\n-----\n\nexecution. It is stored in similar file “%TMP%\\smrdprev.tmp“, the hex number\ndepends on current system boot time. It is encrypted in the same way as the main\noutput file, using custom cryptoalgorithm based on AMPRNG cryptomethod.\n\nCurrent module also tags current system by changing the following registry keys:\n\nHKCU\\Software\\Microsoft\\ADOSoftware32\\ProductID = binary value of 20 bytes\n(System ID)\nHKLM\\Software\\Microsoft\\ADOSoftware32\\ProductID = binary value of 20 bytes\n(System ID)\n\nSystem ID is calculated as SHA1-hash of System Drive Volume Serial Number and\nHKLM\\SOFTWARE\\Microsoft\\Internet Explorer\\Registration\\ProductID value. These\nkeys remain after malware self-removes an may serve as good way to identify if your\nsystem was hit by this module in the past.\n\nMost of the cryptoroutines such as DES, RC4, HMAC_MD5, MD4 are used from\nstatically linked OpenSSL 0.9.8g library.\n\nAfter the end of execution it deletes temporary files and self-removes with simple\nmsc.bat file of the following contents:\n\nchcp 1251\n:Repeat\nattrib -a -s -h -r “”\ndel “”\nif exist “” goto Repeat\ndel “msc.bat”\n\nNote, that current batch file sets current codepage to CP1251, which is used\nto display Cyrillic characters in console output.\n\n## 4. Email group\n\n#### MAPIClient module\n\nKnown variants:\n\n**MD5** **Compilation date**\n\n09e75477e03a968eead17a28d8aef0ce 2012.10.26 07:02:24 (GMT)\n\n10603f7ec89c3472b238e9342f5ba62b 2011.10.10 11:37:27 (GMT)\n\nC196e32764dc698bb88714adfb874667 2012.05.04 11:31:35 (GMT)\n\n0fe600e06a69ccebbb5baf6c9f5f51a6 2011.12.02 07:34:41 (GMT)\n\nc3a50d78669cd58b2cd4e38e30c1e986 2011.11.11 07:13:55 (GMT)\n\n298c4562c8463bed3039ff2d12669adc 2011.09.02 05:08:00 (GMT)\n\n1f91b25d0893d4e1b0418ffeb21f1f03 2011.10.10 11:37:27 (GMT)\n\n\n-----\n\n7883b174ce69ffed41d3aea54855ff97 2011.06.10 06:11:48 (GMT)\n\n3975b42d9bb39741e988f78020edeb44 2011.11.11 07:13:55 (GMT)\n\n### Summary\n\nThe file is a PE EXE file, compiled with Microsoft Visual Studio 2010. All the\nfunctionality is implemented in the WinMain function.\n\nThis module is used to steal email information of the current user by getting most\nvaluable information about messages, starting from general fields\n(To/From/Date/Subj), copying full MIME headers and message body, and stealing\nattachments if extension looks interesting (documents, archives, cryptokeys). The\nresult is stored in a set of encrypted and compressed files, after that the application\nself-removes.\n\n#### Main function\n\nIt starts from creating a new encrypted log file in current directory of the executable,\nnamed “system32ocxms.dat”. The first log entries contain the following:\n\nProgram started\nV: MSG_26.10.12 This probably indicate internal module name (MSG) and version\n(set after date of creation 26.10.12). Current application hasn’t got an embedded\nconfig/script file in resource section, all parameters are hardcoded.\n\nNext it fetches the current system general information and default application\npreferences from the registry, including the following:\n\nUser name\nComputer name\nUser domain name (from %USERDOMAIN% and %USERDNSDOMAIN%)\nDefault system HTTP protocol handler from HKCR\\HTTP\\shell\\open\\command\nDefault system HTTPS protocol handler from HKCR\\https\\shell\\open\\command\nDefault system application for html files from HKCR\\htmlfile\\shell\\open\\command\nDefault system e-mail client from HKCR\\mailto\\shell\\open\\command\n\nThis information is added to the log file.\n\nNext it checks if MS Outlook is installed, if it is actively running, whether it is system\ndefault e-mail client. This is appended to the log either.\n\nDuring next step, it creates a watchdog thread, which every checks foreground\nwindow every 10 milliseconds and in case current foreground window belongs to\ncurrent process it spawns self-removal batch-file (see description in section below)\nand terminates current process. This is done in case Microsoft Windows MAPI\nframework creates a popup message with some connection error report, or asks the\nuser to enter credentials from the mailbox. The developers obviously wanted to\n\n\n-----\n\nshutdown and self-remove the module without collecting any information instead of\ngetting caught by attracting attention.\n\nAfter watchdog thread was created the module lists local user mail addresses by\nconnecting to system MAPI. It gets User Email, Address Type and User Name. Next it\niterates through existing MAPI storages for current user and dumps full information\nabout all messages to the main log file, including e-mail header values, such as\n\nSubject\nFrom\nTo\nDate\nAttachmentID\nAttachmentName\nAttachmentSize\n\nThe emails of attackers’ interest with attachments are saved in a separate encrypted\nand Zlib-compressed storage file (new storage file is created for each directory):\n\n%CurrentDir%\\sys_%HexNumber%\\winocx_%IntegerCounter%_rdtp.tmp\n\nThe attachment storage file is limited to 60Mb, RC4 encryption key is\n\n1 specialforoutlookattachments!\n\nThe filter for interesting emails is defined in a list of regular expressions (PCRE lib is\nused to process those):\n\n.doc .xls .txt .vcf .p7m .mdb .msgz .dcx .egk .zm9 .docx .xlsx .eml .CCC .cif .fas .msg\n.kum .key .out .rtf .pdf .enc .TOK .wps .sbox .lock .ass .cer .pem .odt .rar .html .xia\n.sec .cm5 .xps .pgp .wfh .cbu .ods .zip .htm .xis .dat .rhs .x05 .xiti .grp .sig .dot .gpg\nmht .p7s .dth .max .y05 .egm .pot .ftil\n\nCurrent module is also capable of dumping full contents of local system **Address**\n**Book, however this functionality is currently disabled by the developer (probably**\nbecause of some bugs in the code).\n\nThis module never communicates with the C&C server and works as a standalone\ntool. In the end of execution before exiting application it runs self-removal procedure\nas described below.\n\n#### Self-removal procedure\n\nWhen the module needs to end the execution and self-remove, it creates a batch-file\nwith pseudo-random name: %HOMEDRIVE%%HOMEPATH%\\Local\nSettings\\Temp\\.bat.\n\nIf it couldn’t create random name, the name will be set to “syspart.bat”.\n\nThe file contains:\n\n\n-----\n\ndel /F /A ”\nif exist “” goto Repeat\ndel /F /A “”\n\n#### POP3Client module\n\nKnown variants:\n\n**MD5**\n\n\n**Compilation date**\n\n**(encrypted)**\n\n\n**Compilation date**\n\n**(payload)**\n\n2011.05.25 11:49:19\n(GMT)\n\n2011.05.25 11:49:19\n(GMT)\n\n\n224c382316be4be7e0009f08b84cd91e 2011.09.26 06:54:09\n(GMT)\n\n100e53ee8fbeb4546b31eb7e0aad8752 2011.07.27 07:37:01\n(GMT)\n\n### Summary\n\n\nThe file is a PE EXE file, compiled with Microsoft Visual Studio 2005.\n\nThis module is responsible for receiving and storing email messages on a local\ncomputer from a POP3 server specified in a configuration file. All the actions and\nimportant info are written to a log file.\n\n#### Main function\n\nCreates mutex “208D2C60-3AEA-1069-A2D7-08002B30309D”\n\nCreates a directory and a log file in it: %ALLUSERSPROFILE%\\Application\nData\\System\\smrdprev.%d%d.tmp (%d values correspond to time64() ^ 0x1F3E231\nand GetTickCount()).\n\nInstalls in system AutoRun:\n\n>HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n“LgfxTray”= PathToExe\n\nOther Registry entries:\n\nHKLM\\SOFTWARE\\Microsoft\\ADOSoftware32\nHKCU\\SOFTWARE\\Microsoft\\ADOSoftware32\n“ProductID” = SHA1(MAC, AdapterIP, VolumeSerialNumber, IE Product ID)\n\nAlways starts the log file from:\n\n@LOG\\CMAIL_LOCAL_v1_ %YEAR%%MONTH%%DAY%_%HOUR%%MIN%%\nSEC%.txt Software version: 0.8\nCurrent Directory: %s\n“——–PROGA START——-”\n\nOpens mutex “huiofwhfiowjcpowjkcwcophwvurweionwopmcvopwkvpwjnhopv”, if it\n\n\n-----\n\nexist, then terminates. Checks file MD5 hash in file header (first 16 bytes), if it was\nchanged after the last saved MD5 (in memory as a variable), then updates it and\nwrites the new hash to log file.\n\nIf calculated hash of the file buffer matched the header hash then module decrypts\nand parses config file and launches POP3 client thread, otherwise terminates.\n\nParameters in config file:\n\ncommon\naccount\nconfig_id\nemail_hash_path\nstorage_path\nstorage_size\nload_period\ntime_delta\nsize_min\nsize_max\nstorage_hash_size\nuninstall\nlogin\npassword\npop3server\nimapserver\nuse\nemail\n\nIf “unistall” parameter is set in config file, then module deletes AutoRun keys in\nregistry, config filejusched32s.dat and terminates.\n\n#### POP3 client thread\n\nBy default all connections are not encrypted with SSL. There is a variable which for\nsome reason is not initialized, that is used to control the network communication, i.e.\nto use SSL encryption or not.\n\nEstablishes a connection based on ‘pop3server’ (or ‘imapserver’), ‘login’ and\n‘password’ parameter values in config file.\n\nAfter receiving the number of emails as a response on STAT command starts\nprocessing emails in cycle.\n\nForms an MD5 hash from a string in format “%s%s%s” with ‘login’ parameter,\n‘pop3server’ parameter and the value that depends on current processed email\nnumber and UIDL response.\n\nSeeks in directory specified in ’email_hash_path’ for *mso.dat files, reads their\n\nd h h h d i h i h l l d h h\n\n\n-----\n\ncurrent email, otherwise gets email message size from a POP3 server with a LIST\ncommand.\n\nCreates File %email_hash_path%\\%s%.mso.dat (%s – CRC32(GetUserName)) and\nappends counted hash to it. If the new File Size is bigger than ‘storage_hash_size’\nthan rewrites the file with the latest data so it’s size doesn’t exceed\n‘storage_hash_size’.\n\nIf email size is in the range ‘size_min’-‘size_max’ then the module retrieves email\nheaders and email message body, otherwise stops email processing. Then the\nmodule parses the response, retrieves the date of email, counts days elapsed and\ncompares it to ‘time_delta’. If it’s bigger than ‘time_delta’ then breaks the email\nprocessing cycle.\n\nCreates file: %storage_path%\\bcmntc.%d.tmp (%d – time64 ^ 0x1F3E231.tmp) with\ndecrypted contents including email\nheader: @CMAIL_LOCAL\\%s_%04u%02u%02u_%02u%02u%02u\\%d.eml (’email’ field,\nDate, Email number) and email contents itself. Some buffers are compressed with\nzlib.\n\nAll the collected data is stored locally and isn’t uploaded to any C&C by this module.\n\n## 5. USB Drive group\n\n#### USBContainer module\n\nKnown files\n\n**Compilation date**\n\n**MD5** **(encrypted)**\n\nb9568a91d6f6b0904de8b2e9d9a2d32c 2010.06.01 11:24:07 (GMT)\n\nf0eaec0b25afc24a416810fe46242590 2010.06.01 11:24:07 (GMT)\n\n865ba7958efe7e54501dcf2c19dcd99e 2010.06.01 11:24:07 (GMT)\n\n#### Summary\n\nThis is a standalone EXE application module which is used to drop and run\nUSBStealer module (IGFXTRAYMS.exe) along with its configuration file\n(imapisync32.dat)\n\nThose two files are zlib compressed and stored in the overlay of the dropper.\n\n#### Main function\n\nUpon execution, the dropper reads its overlay and decompresses it in memory.\n\nThe configuration file “imapisync32.dat” is dropped first followed by the opening of a\nsystem event named “ScxinWordSid_0129211FA”. This event is created by the\nUSBStealer module.\n\n\n-----\n\nor not.\n\nThe USBStealer module is then dropped using the following file\nname: “IGFXTRAYMS.EXE” and executed. Both files are dropped in the same\ndirectory of the dropper.\n\nFinally, the following will be executed 3 times before exiting:\n\nC:\\WINDOWS\\system32\\cmd.exe /c del C:\\DOCUME~1\\%PATH_TO_DROPPER.EXE%\n>> NUL\n\nThis module doesn’t create any execution log files, nor does it connect to the C&C\nservers.\n\n## USBRestore\n\n### Known files\n\n**Compilation date**\n\n**MD5** **(encrypted)**\n\n9572cc04fd442027cfd61178bdf73c0c 2011.07.15 12:30:29 (GMT)\n\nfeba0bbead1a810c223cf8252b529d65 2011.06.02 12:30:50 (GMT)\n\n4aabfd510ef66e066946087617638090 2011.06.02 12:30:50 (GMT)\n\n1d124d06666cfa6b33768f1147208b9c 2011.07.15 12:30:29 (GMT)\n\n260ad160972ca6bc071b7cb518a9b5fa 2011.06.02 12:30:50 (GMT)\n\nab72d7ed99c3c18f2582b6e9cd5ec875 2011.06.02 12:30:50 (GMT)\n\nef6751567cbf7c92cd3880fc7aa425c9 2011.07.15 12:30:29 (GMT)\n\n56c06123e34dcc8a8e464da9acd852bb 2011.05.23 11:33:26 (GMT)\n\na6d549d7c90c412a20fc9e7abc829eb5 2011.07.15 12:30:29 (GMT)\n\nbe6f3c214d2a579728fc3537c6454f8c 2011.07.15 12:30:29 (GMT)\n\n0883d6533aa4fb0e40a6e48a66ea84d4 2011.05.23 11:33:26 (GMT)\n\nc3e70e9b50cd3f6cfcd0ac75a60b3464 2011.06.02 12:30:50 (GMT)\n\n75b824c5a6a9b950ccbdaee577fe964b 2011.07.29 10:59:44 (GMT)\n\n9bb26fb5179db8515cdc81cb9f40387d 2011.07.29 10:59:44 (GMT)\n\nd9851c67bfeec5cc37db99be07061857 2011.06.02 12:30:50 (GMT)\n\n07999110cab8c6558be11684d2c02793 2011.07.15 12:30:29 (GMT)\n\n9d5bb8f9441d31148bf4f190e27764cc 2011.06.02 12:30:50 (GMT)\n\necd7bec9522e64df7b179b512e71c154 2011.06.02 12:30:50 (GMT)\n\n5e215b9272e4a0ff0d9725ac94bd1541 2011.06.02 12:30:50 (GMT)\n\n9a9dbd2a398fda91167169b0866047d1 2011.07.15 12:30:29 (GMT)\n\n\n-----\n\nd4d959bffa33b0e3076421a02e69f13b 2011.07.15 12:30:29 (GMT)\n\nf2bb34acdebcbbd335e6cc2816a0c5f0 2011.06.02 12:30:50 (GMT)\n\nca25ca44ef0106c4080415f1c2090400 2011.07.15 12:30:29 (GMT)\n\n83ee5deb488d58d924134781e76c416c 2011.06.02 12:30:50 (GMT)\n\n9aa8f3ed12ef1003d24c771af69879f8 2011.07.15 12:30:29 (GMT)\n\n19cc111e41d804f20e5f65c6d0a48953 2011.07.15 12:30:29 (GMT)\n\nacfc7040304b19422ba0a1278b4d9c48 2011.05.23 11:33:26 (GMT)\n\na515279eee527f7d20f82ef673308151 2011.06.02 12:30:50 (GMT)\n\n### Summary\n\nThis module is a standalone Windows executable which is automatically started on\nsystem boot and runs secretly in the background. It expects removable media arrival\nand recovers deleted files of attackers’ interest from it. This lets the attacker copy\ndeleted docs as well as ZIP and RAR archives from attached removable media.\n\n### Initialization\n\nUpon start the module creates a general purpose log file in %TMP%\\smrdprev..tmp,\nwhere DWORD is a current time value xored with 0x1F3E231, DWORD2 is value of\nGetTickCount() API call.\n\nSo, basically log file path is %TMP%\\smrdprev..tmp. Same xor value is used among\nall variants we have seen (20+ files).\n\nGeneral log starts with internal module name which is essentially “USB_RESTOREv1”.\nIt also logs software version which is “0.5” for current module. Other modules had\ndifferent hardcoded versions. The variants we have seen had 0.3, 0.5 and 0.6.\nHowever, there are few files which didn’t have any indication of internal module\nversion and are probably the earliest versions. The log file also includes detailed\ninformation about the system it was launched on. Example of system info:\n\nTIME: “2012-11-12 18:07:26 514”\nADMIN: “1”\nUserName: “user”\nComputerName: “WIN_XP_105”\nTimeZone: “Russian Standard Time”\nLOCALE: “Russian_Russia.1251”\nOEMCP: “866”\nACP: “1251”\nOwnFile: “C:\\wusb.exe”\n\nThe module changes registry to run automatically during system start:\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\ctfmon32rt =\n\n\n-----\n\nNext step, it checks if current user has local administrator rights and logs this as well\n(“—-ADMIN MODE—-” or “—-USER MODE—-“).\n\nOne more string is added to the log which indicates end of initialization stage and\nstart of main functionality: “WUSB: begin”. This is probably a reference to another\nmodule internal name: “WUSB”.\n\n### Main Procedure\n\nIt creates an invisible window named “sbw” (Unicode) with window class\n“Win32UserHost“. The module calls RegisterDeviceNotification() API to receive\nsysten notifications from particular device GUIDs:\n\nF18A0E88-C30C-11D0-881500A0C906BED8 (GUID_DEVINTERFACE_USB_HUB)\nA5DCBF10-6530-11D2-901F00C04FB951ED (GUID_DEVINTERFACE_USB_DEVICE)\n\nSo far, the module waits for notifications from USB hubs or USB devices attached to\nthe local system. According to the notification handler code, the module is only\ninterested in new attached volumes except those which were mapped to letter A:\n(reserved for Floppy drives). Once the new volume appears in the system the module\nstarts a separate thread to process this event. Device is never processed twice until it\nis plugged in again, the module stores currently mounted devices and handles device\nremoval events properly.\n\nWhen new USB drive is attached, the module obtains USB device software and\nvendor ID, drive character, volume name, filesystem type, volume serial number,\nnumber of free and used bytes. Then it reads the filesystem using direct disk access\nand own parser of FAT-based filesystems. It is unable to read other filesystems\nincluding NTFS.\n\nOwn filesystem parser code allows to avoid using system API to access files, and\nthus bypass various IDS/IPS software and at the same time look into slack space of\nthe disk. This lets the attackers reveal already deleted files on removable drives. The\nmodule creates additional debug log which traces execution events and records all\nproblems that have occured. The filesystem parser log files are located\nin %TMP%\\hsperfdata32sys\\bcmntc_rt_*\n\nThe parser log includes all discovered filenames, including deleted files. The same\nmodule is capable of recovering deleted files. It can recognize file types and recover\noriginal files depending on format. It is designed to recognize the following file\nheaders: DOCX, XLSX, DOC, XLS, RAR, ZIP . Recovered files are saved\nin %TMP%\\hdbrt32sys\\ms32jxtr.dat.\n\nAll files created by the module, including logs are stored in custom binary format,\nwhich may use Zlib compression, and custom encryption.\n\nThis module doesn’t communicate with any C&c server, all files are stored locally.\n\n\n-----\n\n**MD5**\n\n\n**Compilation date**\n\n**(encrypted)**\n\n\n51d5f5a5c7de6a175e269236c2c574b0 2010.10.14 07:07:58 (GMT)\n\nbbe23b8baec0afbd54154820f4a9d7ea 2010.10.14 07:07:58 (GMT)\n\n6abd3d906ebd0e6bf4fb8d00273fdc66 2010.10.14 07:07:58 (GMT)\n\nb9114882ed3a184f8a58284f3fe57cb0 2011.03.02 09:54:14 (GMT)\n\n657f0f4f6183cd2e87fdfd8a88f927c9 2010.10.14 07:07:58 (GMT)\n\n900ab792a9dc9ae35c821cce98164d81 2010.10.14 07:07:58 (GMT)\n\n18bd71030b18f3bc93d08b650ae0d43d 2011.03.02 09:54:14 (GMT)\n\n187adc0380142c61224c53eac9a70955 2011.03.02 09:54:14 (GMT)\n\n78f2c84fefe80bc84361c40d2bbd0501 2010.10.14 07:07:58 (GMT)\n\nb2c60688dc2de4dd4de1f393ae59e317 2010.10.14 07:07:58 (GMT)\n\n3b4125c8dc55ae54fa244a8fdcea8bc9 2011.03.02 09:54:14 (GMT)\n\n760333093fbcc38f6b8d7e1667d192b8 2010.10.14 07:07:58 (GMT)\n\nffd4096c5d2a2a4801ac6e8ab250a0d0 2011.03.02 09:54:14 (GMT)\n\n92b6b580f1d2e5409a6feb5c8883de2b 2011.03.02 09:54:14 (GMT)\n\ndaf244aacbac081693b914a4a1486fa5 2010.10.14 07:07:58 (GMT)\n\n2b08ae138fd27ba62b7ea1e35d38b56f 2010.10.14 07:07:58 (GMT)\n\n48c4e2386cbae6a71b4eccab21ead6e5 2011.03.02 09:54:14 (GMT)\n\na39636c2fb253ae9ff7b7c0294abf8ac 2011.03.02 09:54:14 (GMT)\n\nf27870dd7bfa952636850a76205f4ba3 2010.10.14 07:07:58 (GMT)\n\nc64343fad7c1f98a8342bd29829fcdf1 2010.06.01 12:13:42 (GMT)\n\n58fbcf7d9146eba51c22e91bdf7128d0 2010.10.14 07:07:58 (GMT)\n\n5c563e849ec86a542daf492b31dde2bb 2010.10.14 07:07:58 (GMT)\n\n4c205fc9c7dbd95316f9ed5aafa34712 2010.10.14 07:07:58 (GMT)\n\nb0e2f3c972477e750d5adbed3650ae81 2010.10.14 07:07:58 (GMT)\n\n### Summary\n\nThis is a standalone EXE application module which is used to automatically track and\nsteal interesting files on removable disks attached to infected system. It starts\nautomatically on system boot. Criterias for files are defined in external encrypted\nbinary config file which must be deployed during setup. It creates own database of\nknown files’ hashes and registers a listener for filesystem changes to do that\nefficiently.\n\n### Initiali ation\n\n\n-----\n\nnamed “ScxinWordSid_0129211FA” (used to signal end of execution) and a log file\nat %TMP%\\imapispool..0x.ids.\n\nIt collects basic system information such as current computer name, current\nusername, and path to original executable module where it started from.\n\nThis information is put in the log file in the first place along with current date and\ntime. Every time module adds anything to the log file, it checks if the log file\nexceeds 15MB size. If that’s true it deletes current log file and opens a new one using\nthe same path.\n\nIt changes registry settings to start automatically on system boot. The changes are\nmade to\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\winns32comp value.\n\n### Main Procedure\n\nIt creates an invisible window named “sbw” with window class “Win32UserHost“. This\nwindow receives notifications from specific device types. The module calls\nRegisterDeviceNotification() API to listen for notification from the system on\nparticular device GUIDs:\n\nF18A0E88-C30C-11D0-881500A0C906BED8 (GUID_DEVINTERFACE_USB_HUB)\nA5DCBF10-6530-11D2-901F00C04FB951ED (GUID_DEVINTERFACE_USB_DEVICE)\n\nAt the same time it create configs monitoring thread which reacts on file changes\nand reloads new values. The config files are stored in the same directory where\ncurrent executable module is and named “imapisync32.dat“,\n“wmilibrt.dat“. imapisync32.dat is encrypted using some custom algorithm, and has\ninformation about file targets to track and copy if found. There are common criterias\nof file size, file age, etc. The module utilizes PCRE (Perl Compatible Regular\nExpressions) library to effectively apply regular expression white and blacklists\nagainst filenames. The criterias are splitted into groups and parameters are names\nwith specific prefix of the group (a, d, s, sd, fa). If group is ended with “a”, that is used\nas a whitelist, filenames that match against such regexps are to be stolen. Groups\nending with “d” represent blacklist, files will be ignored. Below is full decrypted config\n(imapisync32.dat) with our comments after “#” character:\n\nmagic=/lddata/ # magic string identifying config file start\n_st_size=/300000000/ # max size of the storage (300MB)\n_id=/00020/ # internal storage id\n_fdeltatime= /2592000/ # files must be not older than 2592000 seconds or 30 days\n_max_size=/20000000/ # maximum size of a single file must be not larger than\n20MB\n_min_size=/1/ # files must not be smaller than 1 byte\na=/\\.txt$/\na=/\\.csv$/ # Comma-Separated Values, tabular data file\na=/\\ eml$/ # exported e mail file\n\n\n-----\n\na=/\\.vsd$/ # MS Visio document file\na=/\\.sxw$/ # StarOffice/OpenOffice document file\na=/\\.odt$/ # OpenOffice document file\na=/\\.docx$/\na=/\\.rtf$/\na=/\\.pdf$/\na=/\\.mdb$/ # MS Access database file\na=/\\.doc\\./ # *.doc.* files, could be for an archive of MS Word document file\na=/\\.odt\\./ # *.odt.* files, could be for an archive of OpenOffice document file\na=/\\.docx\\./ # etc\na=/\\.rtf\\./\na=/\\.pdf\\./\na=/\\.xls\\./\na=/\\.wab$/ # Windows Address Book file (used in Outlook Express)\na=/accounts\\.ini/ # could be Opera browser accounts and settings file\na=/account\\.cfn/ # TheBat! e-mail client accounts and settings file\na=/signons\\.txt/ # saved user names and passwords in Thunderbird, Sunbird, and\nearlier versions of Firefox\na=/ScribeOptions\\.xml/ # probably settings of Scribe crossplatform e-mail client\na=/wand\\.dat/ # Opera browser password manager database\na=/bpftp\\.dat/ # BulletProof FTP client password database\na=/sm\\.dat/ # CuteFTP password database\na=/smdata\\.dat/ # CuteFTP password database\na=/FileZilla\\.xml/ # FileZilla FTP client password and settings database\na=/ftplist\\.txt/ # TotalCommander ftp upload file list (may contain credential\ninformation)\na=/addrbk\\.dat/ # TurboFTP password and settings file\na=/wcx_ftp\\.ini/ # Total Commander cached FTP credentials database\na=/ws_ftp\\.ini/ # WS_FTP client password and settings file\na=/andrq\\.ini/ # &RQ ICQ client password and settings file\na=/account\\.xml/ # Very generic name, used in various software\na=/odigo\\.com\\.odu/ # Odigo instant messenger settings file\na=/TheBee\\.ini/ # Some “The Bee” software ini file, unclear which software it is\n\n# The following subgroup defines useless files that will not be taken.\n\nd=/\\\\~wordspool.*\\.tmp\\.doc$/\nd=/\\\\~wordspool.*\\.srt\\.doc$/\nd=/\\\\~wordspool.*\\.rtc\\.doc$/\n\n_s_fctime= /1990-01-01 01:02:03/ # files of group “s” after 1990-01-01 are interesting\n_s_max_size=/20000000/ # max size for group “s” is 20MB as well\n_s_min_size=/1/ # min size is 1 byte\n\n# Some patterns of filenames below seem to be related to some other malware seen\non usb drives. It may contain stolen credentials, so they copy it as well.\n\n\n-----\n\nsa=/.*\\.cab\\.bak/\nsa=/.*list\\.tlb/\nsa=/.*drive\\.tlb/\nsa=/.+\\\\\\$lddata\\$\\\\.+/\nsa=/.+\\\\NT.Config\\\\.+/\nsa=/.*\\\\ldupver\\.txt/\nsa=/\\w:\\\\[\\d\\w]+\\.dll/\nsa=/\\w:\\\\[\\d\\w]+\\.exe/\nsa=/.*autorun\\.inf/\nsa=/.*thumb\\.dd/\nsa=/.*thumb\\.db/\nsa=/.*msnmsngr\\.exe/\nsa=/.*svchost\\.exe/\nsa=/.*EXPLORER\\.EXE/\nsa=/.+\\.iau/\nsa=/.+\\.rst/\nsa=/\\.xps/ # This is a subgroup of various files with secrets, such as digital\ncertificates, configs and password databases\nsa=/\\.cif$/\nsa=/\\.key$/\nsa=/\\.crt$/\nsa=/\\.cer$/\nsa=/\\.hse$/\nsa=/\\.pgp$/\nsa=/\\.gpg$/\nsa=/\\.conf$/\nsa=/passw/\nsa=/secret/\nsa=/crypt/\nsa=/krypt/\nsa=/cypher/\nsa=/cipher/\nsa=/\\.ovpn$/\nsa=/\\.xia$/\nsa=/\\.xiu$/\nsa=/\\.xis$/\nsa=/\\.xio$/\nsa=/\\.xig$/\nsa=/pubring.*/\nsa=/secring.*/\nsa=/\\.acidcsa$/\nsa=/\\.acidsca$/\nsa=/\\.aciddsk$/\nsa=/\\.acidpvr$/\n\n$\n\n\n-----\n\nsa=/\\\\ACIDInstallv.*\\.exe$/\nsa=/\\\\ACIDdirInstallv.*\\.exe$/ sa=/\\\\Acid Technologies\\\\/ # Probably this and above\nrefers to Acid Cryptofiler military grade encryption software\nsa=/.*cisco.*\\.txt$/\nsa=/.*cisco.*\\.cfg$/\n_f_fctime= /1999-02-03 02:03:07/\n_f_max_size=/10000000/\n_f_min_size=/1/\nfa=/~WRD32cache.*\\.doc$/\nfa=/glxcrt.*\\.dat/\nfa=/bcmntc.*\\.tmp/\nfa=/smrdprev.*\\.tmp/\na=/\\.ttr$/ # maybe TTR Backup software?\na=/\\.tbe$/ # unclear\na=/\\.tte$/ # unclear\na=/\\._ok$/ # unclear\na=/\\.ki$/ # unclear\na=/\\.txt$/\na=/\\.tvt$/\na=/\\.txr$/ # CorelDraw file?\na=/\\.tvr$/\na=/\\.tbr$/\na=/\\.kin$/\n\nConfig file may change during module work and there is a special thread that\nmonitors config file changes and loads new configuration when it is changed.\n\nThe module lists all available attached removable drives, iterates through all of them\nexcept A: and B: (reserved for floppy disks). It collects full file paths and file metainformation, compresses, encrypts and stores this\nin %TMP%\\mrtdsync\\win64esrt_* database. Additionally, files from the list of interest\nare copied to win64berts* files, which also have full information and body of the file.\nIt is encrypted and compressed twice.\n\nThere is a separate thread to monitor filesystem changes and every time new\nfile/directory is created or changed on the monitored drives updated information\ngoes to %TMP%\\mrtdsync\\win64esrt_* in separately spawned thread, additionally all\nchanged or created files are copied to a new win64berts* file.\n\nThis module works offline and doesn’t communicate with any other host on the\nnetwork.\n\n## 6. Keyboard group\n\n### Keylogger module\n\nKnown variants:\n\n\n-----\n\n**MD5** **(encrypted)** **(payload)**\n\n\n33bda0e77b840809e66e12d020e054c5 2011.04.14 12:00:26\n(GMT)\n\n3cb7318ed40239f7219d86343a17b54b 2011.05.10 07:45:02\n(GMT)\n\ndfcce19f2852db652071088bf9461b4a 2011.05.10 07:44:55\n(GMT)\n\n6079a0746e76c1090dc110e08de645e2 2011.05.20 11:00:18\n(GMT)\n\n57897c997c699135b9460c0be7a4b27e 2011.10.10 07:59:41\n(GMT)\n\necc7a5ef3f5e92f0c7da0bef8d392b5f 2011.05.12 10:47:39\n(GMT)\n\n\n2010.10.05 10:53:49\n(GMT)\n\n2010.10.05 10:53:49\n(GMT)\n\n2010.10.05 10:53:49\n(GMT)\n\n2010.10.05 10:53:49\n(GMT)\n\n2010.10.05 10:53:49\n(GMT)\n\n2010.10.05 10:53:49\n(GMT)\n\n\nThe file is a PE EXE file, compiled with Microsoft Visual Studio 2005. Its main\npurpose is to log keystrokes, copy input texts and make screenshots.\n\n### Main function\n\nOpens and Creates Event WIN_%08X%08X%08X%08X%08X (SHA1(first 512 bytes of\nself file)), if exists, terminates. Sets in AutoRun, using the following registry keys:\n\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\n“Mspmr32” = %Path to the module%\n\nDeletes file “Keylogger.log” (this filename is not used anywhere else). Registers a\nwindow class with RegisterClassEx API using ClassName “svchost.exe“, assigns a\nwindow procedure that implements main module functionality. Creates window with\nCreatWindowEx API using ClassName “svchost.exe“, window name “svchost” and\nassociates it with a registered class.\n\nRegisters a device with RegisterRawInputDevices API and associates it with created\nwindow with a flag RIDEV_INPUTSINK which enables the caller to receive the input\neven when the caller is not in the foreground.\n\n### Window procedure\n\nAll the logging actions are implemented basing on receiving WM_INPUT window\nmessage, if raw input for GetRawInputData API comes from keyboard and\nGetRawInputData received WM_KEYDOWN message.\n\n### Collected information\n\nIt collects some general information about current user and opened\nwindows/processes:\n\nForeground window text or WT_UNKNOWN\nModule FileName or MN_UNKNOWN\n\n\n-----\n\nIt is capable of making full desktop screenshots, copying clipboard data of password\ninput fields (to check a window EM_GETPASSWORDCHAR is sent to the window).\n\nIf “Shift+Insert”, “Ctrl+C”, “”Ctrl+V”,”Ctrl+X”, “Ctrl+Insert” is pressed then it copies\nclipboard data.\n\nCreates File %TMP%\\SSDPserv32\\ssdtrbs%08x%.sys.%d% (%08x – Random Hex\nvalue, %d – time64()). All the collected information is compressed with Zlib and RC4\nencrypted with the key “qefwljkfnw3l;fjwe;fklwejfw;eflkwe;flwe”and written to this file.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.01.14.Red_October_Campaign/securelist.com-Red%20October%20Detailed%20Malware%20Description%203%20Second%20Stage%20of%20Attack.pdf"
    ],
    "report_names": [
        "securelist.com-Red October Detailed Malware Description 3 Second Stage of Attack"
    ],
    "threat_actors": [
        {
            "id": "4b076dcb-516e-42fb-9c8f-f153902cd5e9",
            "created_at": "2022-10-25T16:07:23.708745Z",
            "updated_at": "2025-03-27T02:02:09.935617Z",
            "deleted_at": null,
            "main_name": "Hidden Lynx",
            "aliases": [
                "Aurora Panda",
                "Group 8",
                "Hidden Lynx",
                "Operation SMN"
            ],
            "source_name": "ETDA:Hidden Lynx",
            "tools": [
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "BlackCoffee",
                "HiKit",
                "MCRAT.A",
                "Mdmbot.E",
                "Moudoor",
                "Naid",
                "PNGRAT",
                "Trojan.Naid",
                "ZoxPNG",
                "gresim"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1545363236,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/10c2d6c60b4a34422a12c7583624c4764b815ba6.pdf",
        "text": "https://archive.orkl.eu/10c2d6c60b4a34422a12c7583624c4764b815ba6.txt",
        "img": "https://archive.orkl.eu/10c2d6c60b4a34422a12c7583624c4764b815ba6.jpg"
    }
}