{
    "id": "658e29fa-711a-44de-987c-500a550fe72f",
    "created_at": "2023-01-12T14:59:35.768859Z",
    "updated_at": "2025-03-27T02:16:26.108013Z",
    "deleted_at": null,
    "sha1_hash": "452f0d215af032e28701a5a0566d84bf461992d6",
    "title": "2020-12-28 - Never upload ransomware samples to the Internet",
    "authors": "",
    "file_creation_date": "2022-05-27T21:13:21Z",
    "file_modification_date": "2022-05-27T21:13:21Z",
    "file_size": 289530,
    "plain_text": "# Never upload ransomware samples to the Internet\n\n**[0xc0decafe.com/2020/12/28/never-upload-ransomware-samples-to-the-internet/](https://0xc0decafe.com/2020/12/28/never-upload-ransomware-samples-to-the-internet/)**\n\nDecember 28, 2020\n\nRansomware is our contemporary plague. It is a thriving business that attracts more and\n[more cybercriminals every month. New ransomware gangs sprout like mushrooms. These](https://www.zdnet.com/article/the-ransomware-landscape-is-more-crowded-than-you-think/)\nself-proclaimed “security teams” test the security of many small to large enterprises. But their\nunsolicited penetration tests are not that cheap. What they leave behind is pure mayhem and\na huge bill for the victims. Furthermore, some attacks are really disgusting since ransomware\ngangs have targeted non-profit organizations, schools, and even hospitals on various\noccasions.\n\nThere are hundreds of articles on the Internet about ransomware. For instance, the No More\nRansom project educates on ransomware and offers help for victims. There are technical\napproaches to stop ransomware. Of course, the cyber security industry offers many products\nto protect against or mitigate ransomware. There are also community approaches like\n[Raccine that help to stop ransomware.](https://github.com/Neo23x0/Raccine)\n\nBut once ransomware has been deployed on your network and you are in a ransomware\nincident, the headless chicken mode is very common. Unfortunately, there is one golden rule\nthat I often see getting broken due to headless chicken mode:\n\n\n-----\n\nNEVER EVER upload ransomware samples to the Internet!\n\n_Some random incident responder_\n\nEven though I thought that this would be common knowledge, I’ve been proven wrong many\ntimes. Therefore, this is my take at explaining what information a ransomware sample\ncontains, why you should never upload them to the Internet, and what actually happens if\nyou upload them after all.\n\n**Audience: This is definitively not an article for the seasoned Cyber Threat Intelligence**\nanalyst or the alike. This is an article dedicated to the ones in many smaller to medium\nbusinesses, schools, hospitals, and so on that do not have a dedicated security team: the\nnon-security IT staff including system administrators that are typically the firsts to encounter\nthe mess ransomware gangs leave behind. But also entry-level cyber security professionals\ncan benefit from reading this article and understand how analysts hunt for ransomware\nsamples.\n\n## What kind of information does a ransomware sample contain?\n\nRansomware is only the last step of a network intrusion. It may have started with a spearphishing mail, later on, some undetected lateral movement, and subsequently the take over\nof your Windows Domain Controller. At this point in time, the attacker may deploy the\nransomware on the network on a lonely Friday night.\n\nThese ransomware samples are often compiled for the victim at hand. They are therefore\n_unique. Hence, they contain a lot of information related to the victim that should not be made_\npublic. This information includes:\n\na ransom note with\n\nthe name of the victim\nnames of network shares\nnames of computers in the network\nnames of employees (as part of network share paths)\nnames of clients\ntype of stolen data (e.g. accounting data, executive data, …)\nlinks to screenshots as proof (e.g. data listings, bank account balances, …)\nmeta-information\n\nthe timestamp of the ransomware sample that can be used to estimate the date\nof the attack\n\nThe following ransom note that I’ve extracted from a ransomware sample uploaded to the\nInternet illustrates my point:\n\n\n-----\n\nExample ransom note containing a lot of information about the victim\nNeedless to say that this information should not turn up on the Internet. I know that some will\nargue that this information will be public soon anyway if the victim does not pay the ransom.\n[Because modern ransomware gangs use the double extortion tactic. In a nutshell, before](https://www.infosecurity-magazine.com/blogs/double-extortion-ransomware/)\ndeploying the ransomware, these gangs steal (sometimes) terabytes of data from a network\nand threaten to publish this information on the Darknet or sell/auction it off.\n\n[By the way, paying the ransom is something that is never recommended. Above all, because](https://www.nomoreransom.org/en/ransomware-qa.html)\nthis proves to cybercriminals that this is an effective way of making money. Furthermore, this\nmay have severe consequences for a business, if it pays cybercriminals residing somewhere\nin an embargoed region.\n\n## Why shouldn’t I upload ransomware samples to the Internet?\n\n\n-----\n\nAs you ve seen, there is a lot of information related to the victim that a ransomware sample\ncontains. Once IT staff is confronted with a ransomware incident, they may start their own\ninvestigation, trying to find the root of all evil. One of these steps is typically uploading many\nof the suspicious files found on the network to online services like VirusTotal. Consequently,\nthese samples are public on the Internet.\n\nUnfortunately, this is a common mistake that IT staff unaware of cyber security subtleties\ncommits. What do you gain by uploading ransomware samples? You probably know already\nthat the sample at hand is malware because it encrypted most of your network. Often the\nclassification of the malware, if that really matters at this particular moment, is often proudly\npresented by the malware itself. Either as a file extension of all the encrypted files or in the\nransom note. Therefore, you are not gaining anything, but possibly losing a lot.\n\n[Services like VirusTotal are very good to check if a file is malicious and you suspect that it is](https://www.virustotal.com/)\ncommodity malware. Therefore, the first step is never to upload a file but rather check its file\nhash, e.g. sha256. Somebody else usually has uploaded the sample for us anyway. There\n[are great tools like malwoverview that help you with this task.](https://github.com/alexandreborges/malwoverview)\n\nIf a hash does not yield a result then there are several explications. First, the sample is too\nfresh that somebody has uploaded it yet, check back a couple of minutes later. Second, the\nthreat actor uses hash busting and changes the hash of each sample. Third, this sample is\nunique because it was utilized in a targeted attack.\n\nThe third point is the point that applies to ransomware. The sample is unique. Ransomware\nthreat actors compile their samples typically for each victim just before the deployment. Even\nthough this is not a nation-state actor that attacked your network, you should treat the\nsample as if it were from one due to the information leakage that would occur on upload.\n\nEven though not uploading ransomware samples to the Internet won’t fix the core problem\nyou may have, i.e. an encrypted network, this will likely make your (at this point in time\nmiserable) life a little bit brighter.\n\nBecause you have much more time to focus on the actual incident and you do not have to\ndeal with a media disaster right from the beginning! Perhaps this gives your press relations\nofficer some time to prepare a proper statement.\n\nFurthermore, note that this is a way to identify ransomware victims that paid the ransom and\nnever showed up on any ransomware portal. The proof that they fall victim and paid will be\nout there forever. Mind the possible consequences I’ve stated above.\n\n## What happens if I upload a ransomware sample to the Internet?\n\nThere are many analysts out there that hunt for these samples for several reasons. One of\nthem is not that noble but very common: public discussion of who got ransomwared by\nwhom This is then picked up by the press and it is something that you do not need when\n\n\n-----\n\nalready in a ransomware incident, possibly in headless chicken mode anyway.\n\nLet me illustrate by the example of VirusTotal what happens. The following applies to similar\nservices on the Internet. I choose VirusTotal because it probably the most common choice of\nIT staff to upload malicious samples. It is not that I am blaming anything on this very useful\n[service. Actually, VirusTotal tells you this in their Terms of Service, their](https://support.virustotal.com/hc/en-us/articles/115002145529-Terms-of-Service) [Privacy Policy, and](https://support.virustotal.com/hc/en-us/articles/115002168385-Privacy-Policy)\nagain right about the time you click on “Submit”:\n\n[By submitting data below, you are agreeing to our Terms of Service and](https://support.virustotal.com/hc/en-us/articles/115002145529-Terms-of-Service) [Privacy Policy,](https://support.virustotal.com/hc/en-us/articles/115002168385-Privacy-Policy)\nand to the sharing of your Sample submission with the security community.\nPlease do not submit any personal information; VirusTotal is not responsible for the\ncontents of your submission.\n\n_VirusTotal_\n\nSo, you’ve been warned a lot!\n\nBut you may ask: how do analysts find my sample in the endless stream of files uploaded to\n[VirusTotal? This is where LiveHunt comes into play. This is a service that is offered to](https://support.virustotal.com/hc/en-us/articles/360001315437-Livehunt)\ncustomers and researchers to hook into the never-ending stream of files uploaded. Each file\n[is checked against custom signatures (YARA rules). Furthermore, these samples are shared](http://virustotal.github.io/yara/)\nwith AV companies who will likely have other ways to find the needle in the haystack.\n\nIf you know exactly what you are looking then it is quite easy to find the needle in the\nhaystack. This means once you have analyzed one sample of a certain ransomware family,\nwritten a YARA rule for it, then you will likely detect it in the future again. Actually, you do not\n[have to write many rules on your own because there are plenty on Github. For instance, the](https://github.com/advanced-threat-research/Yara-Rules/tree/master/ransomware)\n[following is a YARA rule for the ransomware family Ryuk:](https://github.com/advanced-threat-research/Yara-Rules/blob/master/ransomware/RANSOM_Ryuk.yar)\n\n\n-----\n\n```\nrule Ransom_Ryuk_sept2020 {         \n  meta:    \n   description = \"Detecting latest Ryuk samples\"     \n   author = \"McAfe ATR\"     \n   date = \"2020-10-13\"      \n   malware_type = \"ransomware\"    \n   malware_family = \"Ransom:W32/Ryuk\"      \n   actor_type = \"Cybercrime\"     \n   actor_group = \"Unknown\"      \n   hash1 = \"cfdc2cb47ef3d2396307c487fc3c9fe55b3802b2e570bee9aea4ab1e4ed2ec28\"   \n  strings:      \n   $x1 = \"\\\" /TR \\\"C:\\\\Windows\\\\System32\\\\cmd.exe /c for /l %x in (1,1,50) do\nstart wordpad.exe /p \" fullword ascii     \n   $x2 = \"cmd.exe /c \\\"bcdedit /set {default} recoveryenabled No & bcdedit /set\n{default}\\\"\" fullword ascii     \n   $x3 = \"cmd.exe /c \\\"bootstatuspolicy ignoreallfailures\\\"\" fullword ascii    \n   $x4 = \"cmd.exe /c \\\"vssadmin.exe Delete Shadows /all /quiet\\\"\" fullword ascii \n   $x5 = \"C:\\\\Windows\\\\System32\\\\cmd.exe\" fullword ascii      \n   $x6 = \"cmd.exe /c \\\"WMIC.exe shadowcopy delete\\\"\" fullword ascii      \n   $x7 = \"/C REG ADD\n\\\"HKEY_CURRENT_USER\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\" /v \\\"EV\\\" /t\nREG_SZ /d \\\"\" fullword wide     \n   $x8 = \"W/C REG DELETE\n\\\"HKEY_CURRENT_USER\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\" /v \\\"EV\\\"\n/f\" fullword wide       \n   $x9 = \"\\\\System32\\\\cmd.exe\" fullword wide      \n   $s10 = \"Ncsrss.exe\" fullword wide        \n   $s11 = \"lsaas.exe\" fullword wide       \n   $s12 = \"lan.exe\" fullword wide       \n   $s13 = \"$WGetCurrentProcess\" fullword ascii      \n   $s14 = \"\\\\Documents and Settings\\\\Default User\\\\sys\" fullword wide      \n   $s15 = \"Ws2_32.dll\" fullword ascii      \n   $s16 = \" explorer.exe\" fullword wide      \n   $s17 = \"e\\\\Documents and Settings\\\\Default User\\\\\" fullword wide       \n   $s18 = \"\\\\users\\\\Public\\\\\" fullword ascii       \n   $s19 = \"\\\\users\\\\Public\\\\sys\" fullword wide       \n   $s20 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\System\\\\\"\nfullword ascii    \n   $seq0 = { 2b c7 50 e8 30 d3 ff ff ff b6 8c }    \n   $seq1 = { d1 e0 8b 4d fc 8b 14 01 89 95 34 ff ff ff c7 45 }      \n   $seq2 = { d1 e0 8b 4d fc 8b 14 01 89 95 34 ff ff ff c7 45 }    \n  condition:      \n   ( uint16(0) == 0x5a4d and       \n   filesize < 400KB and        \n   ( 1 of ($x*) and 5 of them ) and         \n   all of ($seq*)) or ( all of them )    \n}\n\n```\nThis rule comprises several strings and a condition that is checked against each file. The\ncondition matches, roughly speaking, Windows binaries that are less than 400 kilobytes in\nsize and comprise a certain number of the aforementioned strings.\n\n\n-----\n\nLet s say you uploaded a ransomware sample to VirusTotal, which belongs to one of the\nheavily tracked ransomware families then there are likely several YARA rules going off, and\n[researchers notified. Notifications are either seen in the VirusTotal WebGUI or via email](https://support.virustotal.com/hc/en-us/articles/360001315437-Livehunt#h_cfdf3cbc-ec4f-4076-82bf-f3a0dadf6da8)\nnotification as shown in the following screenshot.\n\nSample notification received for a ransomware sample\nNow even further meta information is attached to the ransomware sample. For instance, the\ncountry from where the sample was uploaded, which might be used to track down the exact\nlocation of the victim if it is a branch of an enterprise operating in many countries.\n\nAnd finally, at some point, you will contract an incident responder because it is very likely that\nyour in-house capabilities won’t be enough. If you tell them that you’ve just uploaded the\nsample to some online service, chances are that they will not be amused. I’ve never come\nalong an incident responder that was happy when their client uploaded a ransomware\nsample to the Internet…\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-28 - Never upload ransomware samples to the Internet.pdf"
    ],
    "report_names": [
        "2020-12-28 - Never upload ransomware samples to the Internet.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535575,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653686001,
    "ts_modification_date": 1653686001,
    "files": {
        "pdf": "https://archive.orkl.eu/452f0d215af032e28701a5a0566d84bf461992d6.pdf",
        "text": "https://archive.orkl.eu/452f0d215af032e28701a5a0566d84bf461992d6.txt",
        "img": "https://archive.orkl.eu/452f0d215af032e28701a5a0566d84bf461992d6.jpg"
    }
}