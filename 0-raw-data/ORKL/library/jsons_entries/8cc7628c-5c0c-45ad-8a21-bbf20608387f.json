{
    "id": "8cc7628c-5c0c-45ad-8a21-bbf20608387f",
    "created_at": "2023-02-02T02:08:31.420461Z",
    "updated_at": "2025-03-27T02:16:20.758322Z",
    "deleted_at": null,
    "sha1_hash": "1dc350e97394d1cc92778d17e858154ef2a55a69",
    "title": "2023-01-05 - Turla- A Galaxy of Opportunity",
    "authors": "",
    "file_creation_date": "2023-02-01T07:43:27Z",
    "file_modification_date": "2023-02-01T07:43:27Z",
    "file_size": 3616351,
    "plain_text": "# Turla: A Galaxy of Opportunity\n\n**mandiant.com/resources/blog/turla-galaxy-opportunity**\n\n_Warning: An indicator within this post contains offensive language._\n\nIn September 2022, Mandiant discovered a suspected Turla Team operation, currently tracked as UNC4210, distributing the\n[KOPILUWAK reconnaissance utility and QUIETCANARY backdoor to ANDROMEDA malware victims in Ukraine. Mandiant](https://advantage.mandiant.com/malware/malware--8d50876d-42fe-5b5b-82d4-b5c0c2162e10)\ndiscovered that UNC4210 re-registered at least three expired ANDROMEDA command and control (C2) domains and\nbegan profiling victims to selectively deploy KOPILUWAK and QUIETCANARY in September 2022.\n\nANDROMEDA was a common commodity malware that was widespread in the early 2010’s. The particular version whose\nC2 was hijacked by UNC4210 was first uploaded to VirusTotal in 2013 and spreads from infected USB keys. Mandiant\n[Managed Defense continues to observe ANDROMEDA malware infections across a wide variety of industries, however,](https://www.mandiant.com/advantage/managed-defense)\nMandiant has only observed suspected Turla payloads delivered in Ukraine.\n\n\n-----\n\nFigure 1: Timeline of ANDROMEDA to Turla Team intrusion\n\n## USB Spreading\n\nAs Mandiant recently wrote about in our blog post, Always Another Secret: Lifting the Haze on China-nexus Espionage in\nSoutheast Asia, USB spreading malware continues to be a useful vector to gain initial access into organizations. In this\nincident, a USB infected with several strains of older malware was inserted at a Ukrainian organization in December 2021.\nWhen the system's user double clicked a malicious link file (LNK) disguised as a folder within the USB drive, a legacy\nANDROMEDA sample was automatically installed and began to beacon out.\n\n## ANDROMEDA or 2013 Wants Its Malware Back\n\nThe version of ANDROMEDA that was installed to C:\\Temp\\TrustedInstaller.exe (MD5:\n[bc76bd7b332aa8f6aedbb8e11b7ba9b6), was first uploaded on 2013-03-19 to VirusTotal and several of the C2 domains had](https://www.virustotal.com/gui/file/9535a9bb1ae8f620d7cbd7d9f5c20336b0fd2c78d1a7d892d76e4652dd8b2be7/details)\neither expired or been sinkholed by researchers. When executed, the ANDROMEDA binary established persistence by\ndropping another ANDROMEDA sample to C:\\ProgramData\\Local Settings\\Temp\\mskmde.com (MD5:\n[b3657bcfe8240bc0985093a0f8682703) and adding a Run Registry Key to execute it every time the system user logged on.](https://www.virustotal.com/gui/file/5f4b0aa22ce65b30fb232421673fad4c126970928207ade256d3bfee33dc3687/details)\nOne of its C2 domains, “suckmycocklameavindustry[.]in,” which had expired, was found to be newly re-registered on 202201-19 by a privacy protected registrant using Dynadot as the registrar. UNC4210 used this C2 to profile victims before\nsending the first stage KOPILUWAK dropper if the victim was deemed interesting.\n\nMandiant identified several different hosts with beaconing ANDROMEDA stager samples. However, we only observed one\ncase in which Turla-related malware was dropped in additional stages, suggesting a high level of specificity in choosing\nwhich victims received a follow-on payload. During the time Mandiant monitored the C2s used to deliver the next stage\npayloads, the servers only remained up for a short period of a few days before going offline for several weeks at a time.\n\n## Recon with Ol’ Reliable KOPILUWAK\n\nAfter several months of ANDROMEDA beaconing without any significant activity observed, UNC4210 downloaded and\nexecuted a WinRAR Self-Extracting Archive (WinRAR SFX) containing KOPILUWAK (MD5:\n2eb6df8795f513c324746646b594c019) to the victim host on September 6, 2022. Interestingly, the attackers appeared to\ndownload and run the same WinRAR SFX dropper containing KOPILUWAK seven times between September 6 and\nSeptember 8. Each time the KOPILUWAK cast its net, it attempted to transfer significant amounts of data to the C2\nmanager.surro[.]am. It is unclear why UNC4210 did this as the profiling commands are hard coded in KOPILUWAK and\nwould not yield different sets of data from the same host.\n\nKOPILUWAK is a JavaScript-based reconnaissance utility used to facilitate C2 communications and victim profiling. It was\nfirst reported publicly by Kaspersky and has been tracked by Mandiant since 2017. Historically, the utility has been delivered\nto victims as a first-stage malicious email attachment. This is consistent with Turla’s historical reuse of tools and malware\necosystems, including KOPILUWAK, in cyber operations.\n\n\n-----\n\nThe ANDROMEDA injected process wuauclt.exe made a GET request to yelprope.cloudns[.]cl with the target URL\n\"/system/update/version.” yelprope.cloudns[.]cl is a ClouDNS dynamic DNS subdomain which was previously used by\nANDROMEDA and was re-registered by UNC4210. The ANDROMEDA injected process then downloaded and executed a\nWinRAR SFX containing KOPILUWAK to C:\\Users\\[username]\\AppData\\Local\\Temp\\0171ef74.exe (MD5:\n2eb6df8795f513c324746646b594c019). Notably, this filename format has also been observed being utilized in\nTemp.Armageddon operations. Upon execution, the self-extracting archive created and executed KOPILUWAK from\nC:\\Windows\\Temp\\xpexplore.js (MD5: d8233448a3400c5677708a8500e3b2a0).\n\nIn this case, UNC4210 used KOPILUWAK as a “first-stage” profiling utility as KOPILUWAK was the first custom malware\nused by this suspected Turla Team cluster following ANDROMEDA. Through KOPILUWAK, UNC4210 conducted basic\nnetwork reconnaissance on the victim machine with whoami, netstat, arp, and net, looking for all current TCP connections\n(with PID) and network shares. The attackers also checked the logical disks and list of current running processes on the\nmachine. Each command result was piped into %TEMP%\\result2.dat, before being uploaded to KOPILUWAK's C2\n\"manager.surro[.]am\" via POST requests.\n\n## QUIETCANARY in the Mine\n\nTwo days after the initial execution of and reconnaissance performed with KOPILUWAK, on September 8, 2022, Mandiant\ndetected UNC4210 download QUIETCANARY to a host twice, but only executing commands through it on the second time.\nQUIETCANARY is a lightweight .NET backdoor also publicly reported as “Tunnus” which UNC4120 used primarily to gather\nand exfiltrate data from the victim. Please see the QUIETCANARY analysis in the annex for technical details regarding the\nmalware.\n\nFollowing the extensive victim profiling by KOPILUWAK, the ANDROMEDA injected process \"wuauclt.exe\" made a GET\nrequest to \"yelprope.cloudns[.]cl\" with the target URL \"/system/update/cmu\", which downloaded and executed\nQUIETCANARY. QUIETCANARY (MD5: 403876977dfb4ab2e2c15ad4b29423ff) was then written to disk.\n\nUNC4210 then interacted with the QUIETCANARY backdoor, proceeding to utilize QUIETCANARY for compressing,\nstaging, and exfiltrating data approximately 15 minutes later.\n\n## Data Theft\n\nMandiant observed interactive commands sent to and executed by QUIETCANARY. In one command observed, UNC4210\nmade a typo “netstat -ano -p tcppp” and had to reissue the command suggesting the following data theft was manual\nprocess rather than automated collection.\n\nUNC4210 attempted to collect documents and data using WinRAR:\n\n**Data Collection Command** **Primary Command Operational Choices**\n\n```\nrar a c:\\\\programdata\\\\win_rec.rar\n\"%appdata%\\\\microsoft\\\\windows\\\\\" -u\n-y -r -m2 -inul\n\n```\n\nCreation of “win_rec.rar” archive containing files recursively found in\ndirectories within “% AppData%\\Microsoft\\Windows\\”, which would have\nexpanded to “C:\\Users\\\n\n[Username]\\AppData\\Roaming\\Microsoft\\Windows\\” as QUIETCANARY\nwas executed under the compromised user’s context.\n\n```\nrar a c:\\\\programdata\\\\win_rec.rar\n\"c:\\\\users\\\\\" -u -y -r -m2 -inul n*.lnk\n\n```\n\nCreation of “win_rec.rar” archive containing files with .lnk extension\n(namely Windows LNK shortcuts), recursively found in directories within\n“C:\\Users\\”\n\n```\nrar a c:\\\\programdata\\\\win_files.rar\n\"c:\\\\users\\\\\" \"d:\\\\\" -u -y -r -m2 inul -n*.pdf -n*.xls* -n*.txt n*.doc* -hp[redacted] -v3M ta20210101000000\n\n```\n\nCreation of “win_files.rar” password (redacted) encrypted archive split in\n3MB parts, containing files with extensions .pdf, .xls(x), .txt and .doc(x),\nwhich were modified after 2021-01-01, recursively found in directories\nwithin “C:\\Users\\” and “D:\\”\n\n\n-----\n\n```\nrar a c:\\\\programdata\\\\win_txt.rar\n\"c:\\\\users\" \"d:\\\\\" -u -y -r -m2 -inul\n-n*.txt -hp[redacted] -v3M\n\n```\n\nCreation of “win_txt.rar” password (redacted) encrypted archive split in\n3MB parts, containing files with extension .txt, recursively found in\ndirectories within “C:\\Users\\” and “D:\\”\n\n\nNotably, UNC4210 appeared to only exfiltrate files created after 2021/01/01.\n\n## ANDROMEDA C2s\n\nAs Mandiant began to review additional ANDROMEDA domains, we observed several more similarly re-registered domains\nfrom older malware. One domain “anam0rph[.]su”, was re-registered on 2022-08-12 and resolved to the same IP as\nyelprope.cloudns[.]cl during the same period. Mandiant assesses with high confidence that “anam0rph[.]su” is also\ncontrolled by UNC4210, though we have not observed the domain being used in UNC4210 operations.\n\n**Domain** **Suspected Date of Re-Registration** **IP Resolution**\n\nanam0rph[.]su 2022-08-12 212.114.52[.]24\n\nyelprope.cloudns[.]cl Unknown (Dynamic DNS) 212.114.52[.]24\n\nsuckmycocklameavindustry[.]in 2022-01-19 35.205.61[.]67\n\n## Conclusion\n\nAs older ANDROMEDA malware continues to spread from compromised USB devices, these re-registered domains pose a\nrisk as new threat actors can take control and deliver new malware to victims. This novel technique of claiming expired\ndomains used by widely distributed, financially motivated malware can enable follow-on compromises at a wide array of\nentities. Further, older malware and infrastructure may be more likely to be overlooked by defenders triaging a wide variety\nof alerts.\n\nThis is Mandiant’s first observation of suspected Turla targeting Ukrainian entities since the onset of the invasion. The\ncampaign’s operational tactics appear consistent with Turla’s considerations for planning and advantageous positioning to\nachieve initial access into victim systems, as the group has leveraged USBs and conducted extensive victim profiling in the\npast. In this case, the extensive profiling achieved since January possibly allowed the group to select specific victim\nsystems and tailor their follow-on exploitation efforts to gather and exfiltrate information of strategic importance to inform\nRussian priorities. However, we note some elements of this campaign that appear to be a departure from historical Turla\noperations. Both KOPILUWAK and QUIETCANARY were downloaded in succession at various times, which may suggest\nthe group was operating with haste or less concern for operational security, experiencing some aspect of operational\ndeficiency, or using automated tools.\n\n## Acknowledgements\n\nWith thanks to Nick Richard and Parnian Najafi for technical review. Special thanks to all the Mandiant Consultants,\nMandiant Managed Defense, and Pokemon Masters supporting Ukraine engagements.\n\n## Indicators\n\n**Family** **Indicator**\n\nANDROMEDA bc76bd7b332aa8f6aedbb8e11b7ba9b6 TrustedInstaller.exe\n\nANDROMEDA b3657bcfe8240bc0985093a0f8682703 mskmde.com\n\n\n-----\n\nKOPILUWAK WinRAR SFX 2eb6df8795f513c324746646b594c019\n\nKOPILUWAK d8233448a3400c5677708a8500e3b2a0 xpexplore.js\n\nQUIETCANARY 403876977dfb4ab2e2c15ad4b29423ff 00c3df3b.exe\n\nQUIETCANARY 8954caa2017950e0f6269d6f6168b796 file.exe16\n\nUNC4210 ANDROMEDA C2 suckmycocklameavindustry[.]in\n\nUNC4210 ANDROMEDA C2 yelprope.cloudns[.]cl\n\nUNC4210 ANDROMEDA C2 anam0rph[.]su\n\nUNC4210 ANDROMEDA C2 212.114.52[.]24\n\nUNC4210 KOPILUWAK C2 manager.surro[.]am\n\nQUIETCANARY C2 194.67.209[.]186:443\n\n## YARA Rules\n\n### KOPILUWAK\n```\n rule M_APT_Kopiluwak_Recon_1\n {\n   meta:\n     author = \"Mandiant\"\n   strings:\n     $rc4_1 = \".charCodeAt(i %\"\n     $rc4_2 = \".length)) % 256\"\n     $b64_1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\"\n     $b64_3 = \".charAt(parseInt(\"\n     $recon_1 = \"WScript.CreateObject\"\n     $recon_2 = \".Run(\"\n     $Arguments = \"WScript.Arguments\"\n   condition:\n     ($rc4_1 and $rc4_2 and $b64_1) and ($Arguments or ($b64_3 and $recon_1 and $recon_2))\n }\n\n QUIETCANARY\n\n```\n\n-----\n\n```\n rule M_HUNTING_QUIETCANARY_STRINGS {\n  meta:\n     author=\"Mandiant\"\n  strings:\n   $pdb1 =\n \"c:\\\\Users\\\\Scott\\\\source\\\\repos\\\\Kapushka.Client\\\\BrowserTelemetry\\\\obj\\\\Release\\\\CmService.pdb\" ascii\n wide nocase\n   $pdb2 =\n \"c:\\\\Users\\\\Scott\\\\source\\\\repos\\\\Kapushka.Client\\\\BrowserTelemetry\\\\obj\\\\Release\\\\BrowserTelemetry.pdb\"\n ascii wide nocase\n   $pdb3 =\n \"c:\\\\Users\\\\Scott\\\\source\\\\repos\\\\BrowserTelemetry\\\\BrowserTelemetry\\\\obj\\\\Release\\\\BrowserTelemetry.pdb\"\n ascii wide nocase\n   $orb1 = { 68 00 74 00 74 00 70 00 73 00 3A 00 2F 00 2F }\n   $orb2 = { 68 00 74 00 74 00 70 00 3A 00 2F 00 2F }\n   $command1 = \"get_Command\" ascii wide nocase\n   $command2 = \"set_Command\" ascii wide nocase\n   $command3 = \"DownloadCommand\" ascii wide nocase\n   $command4 = \"UploadCommand\" ascii wide nocase\n   $command5 = \"AddCommand\" ascii wide nocase\n   $command6 = \"ExeCommand\" ascii wide nocase\n   $command7 = \"KillCommand\" ascii wide nocase\n   $command8 = \"ClearCommand\" ascii wide nocase\n    $rc4 = {21 00 62 00 76 00 7A 00 65 00 26 00 78 00 61 00 62 00 72 00 39 00 7C 00 38 00 5B 00 3F 00\n 78 00 77 00 7C 00 7C 00 79 00 26 00 7A 00 6C 00 23 00 74 00 70 00\n 6B 00 7A 00 6A 00 5E 00 62 00 39 00 61 00 38 00 6A 00 5D 00 40 00 6D 00 39 00 6E 00 28 00 67 00 67 00 24\n 00 40 00 74 00 74 00 65 00 33 00 33 00 6E 00 28 00 32 00 72 00 7A\n 00 62 00 7A 00 69 00 74 00 75 00 31 00 2A 00 66 00 61 00 00 80 E9 4D 00 6F 00 7A 00 69 00 6C 00 6C 00 61\n }\n  condition:\n   (1 of ($pdb*)) and (1 of ($orb*)) and (all of ($command*)) or ($rc4)\n }\n\n## Network Rules\n\n### ANDROMEDA\n alert tcp any any -> any any ( msg:\"503 irc_bot_cmd Trojan.Downloader.Andromeda AI callback-trojan\n block\"; content:\".php HTTP/1\"; nocase; content:\"|0a|\"; content:\"|0a|\"; within:4; content:\"POST \";\n content:\"Mozilla/4.0|0d 0a|\"; content:!\"Referer: \"; nocase; content:!\"Cookie: \"; nocase;\n content:!\"Accept-Language: \"; nocase; content:!\"Accept-Encoding: \"; nocase; content:!\"pharma\"; nocase;\n content:!\"|0d0a|TE:\"; nocase; pcre:\"/POST (http\\:\\/\\/\\S*\\.[a-z0-9]{1,4})?/[a-z]{1,3}\\.php HTTP/\";\n reference:fe_date,2013-07-11; reference:a_type,mal.dsh;\n reference:mal_hash,bc76bd7b332aa8f6aedbb8e11b7ba9b6; priority:90; sid:89039193; rev:3; )\n\n## MITRE ATT&CK\n\n```\n\n-----\n\n**ATT&CK Tactic Category** **Techniques**\n\n**Defense Evasion**\n\n[T1027:](https://attack.mitre.org/techniques/T1027/) Obfuscated Files or Information\n\n[T1055:](https://attack.mitre.org/techniques/T1055/) Process Injection\n\n[T1070.004:](https://attack.mitre.org/techniques/T1070/004/) File Deletion\n\n[T1112:](https://attack.mitre.org/techniques/T1112/) Modify Registry\n\n[T1564.003:](https://attack.mitre.org/techniques/T1564/003/) Hidden Window\n\n[T1622:](https://attack.mitre.org/techniques/T1622/) Debugger Evasion\n\n**Persistence**\n\n[T1547.001](https://attack.mitre.org/techniques/T1547/001/) Registry Run Keys / Startup Folder\n\n**Discovery**\n\n[T1010:](https://attack.mitre.org/techniques/T1010/) Application Window Discovery\n\n[T1012:](https://attack.mitre.org/techniques/T1012/) Query Registry\n\n[T1033:](https://attack.mitre.org/techniques/T1033/) System Owner/User Discovery\n\n[T1049:](https://attack.mitre.org/techniques/T1049/) System Network Connections Discovery\n\n[T1057:](https://attack.mitre.org/techniques/T1057/) Process Discovery\n\n[T1082:](https://attack.mitre.org/techniques/T1082/) System Information Discovery\n\n[T1083:](https://attack.mitre.org/techniques/T1083/) File and Directory Discovery\n\n[T1518:](https://attack.mitre.org/techniques/T1518/) Software Discovery\n\n**Collection**\n\n[T1560:](https://attack.mitre.org/techniques/T1560/) Archive Collected Data\n\n[T1560.001:](https://attack.mitre.org/techniques/T1560/001/) Archive via Utility\n\n**Resource Development**\n\n[T1584:](https://attack.mitre.org/techniques/T1584/) Compromise Infrastructure\n\n\n-----\n\n**Command and Control**\n\n**Impact**\n\n\n[T1608.003:](https://attack.mitre.org/techniques/T1608/003) Install Digital Certificate\n\n[T1071.001:](https://attack.mitre.org/techniques/T1071/001/) Web Protocols\n\n[T1573.002:](https://attack.mitre.org/techniques/T1573/002/) Asymmetric Cryptography\n\n[T1529:](https://attack.mitre.org/techniques/T1529/) System Shutdown/Reboot\n\n\n## Annex: QUIETCANARY Analysis\n\nQUIETCANARY is a .NET backdoor that can handle commands from C2. The communications between QUIETCANARY\nand the hard-coded C2 are RC4 encrypted and Base64 encoded over HTTPS. QUIETCANARY samples often contain the\nartifact “Kapushka” in the PDB path of the malware. All samples of QUIETCANARY we have identified in the wild have been\nnearly identical with the only differences being the hardcoded C2 and RC4 key used. Notably as well, each sample of\nQUIETCANARY we found contains but does not use the class ServerInfoExtractor.\n\n### QUIETCANARY Execution\n\nUpon execution, QUIETCANARY initializes the hard-coded variables within it for C2 communication, including the RC4 key,\nuser agent, and C2. It then attempts to connect to the C2 via GET request.\n\nQUIETCANARY checks to see if the initial response from the C2 is longer than 13 characters and begins with the string\n\"use.\" If so, it takes the substring between the third and tenth characters from the response and replaces the initial RC4 key\nwith a new key. If this initial connection or exchange of a new RC4 key is not completed, the malware sleeps for five\nminutes and tries again. If the malware fails to connect to the C2 again, it quits execution. Otherwise, QUIETCANARY\nbegins a loop that waits for a response from the C2, and, when it receives one, parses and executes the command.\n\nQUIETCANARY does not contain a persistence method and thus relies on an external tool or technique to maintain\npersistence.\n\n### QUIETCANARY Commands\n\nQUIETCANARY uses a custom parsing routine to decode the command codes and additional parameters from the C2\nbefore executing the command routines.\n\nQUIETCANARY expects the following structure for a command from the C2:\n\n**i** <id> **s** <code val> **l** <length of parameter> **c** < parameter>\n\nWhere:\n\n<id> is a decimal command ID, which can be up to ten digits\n<code val> is a three-digit command code\n<length of parameter> is the length of an expected parameter, which can be up to six digits\n<parameter> immediately follows the \"c\" character in the array and is the length specified by <length of parameter>\n\nFor example, a command from the C2 could look like:\n\ni123456789s220l26ccmd.exe echo \"hello world\"\n\nWhen a command is successfully parsed the command code is queried and returned\n\n\n-----\n\nQUIETCANARY can parse multiple commands in a single response from the C2. Upon receiving and successfully parsing a\ncommand, QUIETCANARY adds it to a command queue.\n\nQUIETCANARY can handle the following command codes from the C2:\n\nCommand codes\n\n**Command Code** **Command Name** **Command Description**\n\n0 ClearCommand Aborts current command execution thread and starts a new one\n\n220 ExeCommand Execute a command with arguments\n\n265 TimeoutCommand Sets a new time until C2 loop execution times out\n\n420 UploadCommand Uploads a command to a given path\n\n479 DownloadCommand Reads all bytes from a filepath and converts to Base64 encoding\n\n666 KillCommand Kills execution after a specified delay\n\nGiven the different encodings of each command, we detail here how QUIETCANARY processes each command from the\nC2 before execution.\n\n_0: ClearCommand_\n\nAborts current thread of command execution and clears current command in the queue. Starts new command execution\nthread.\n\n_220: ExeCommand_\n\nChecks to see if parameter starts with the \" character. If so, creates a new string that begins with the \"\\\" character and\nconsists of each following character in the parameter until it reaches a second \" character.\n\nIf the parameter does not start with the \" character, splits the parameter into substrings by space characters. Arguments\ndirectly follow the filename to execute. Then executes the process name with arguments in a hidden window.\n\n_265: TimeoutCommand_\n\nTakes an integer parameter and changes the timeout value in seconds for the execution of the C2 loop.\n\n_420: UploadCommand_\n\nTakes a \"|\" delimited parameter and splits into substrings. The first substring is the path to which the command should be\nuploaded. Converts each substring following the first from Base64 then writes to the given path on the infected machine.\n\n_479: DownloadCommand_\n\nChecks to see if the file passed to the function within the parameter exists. If it does exist, prepends \"file:\" to the Base64encoded bytes of the specified filepath. If it does not, returns \"not found.\" Results of execution are stored in memory and\nlater sent to C2.\n\n_666: KillCommand_\n\nTakes an integer it uses to calculate a time for the malware to sleep. Then kills the process after the sleep.\n\n\n-----\n\nQUIETCANARY separates the commands into two categories: fast commands and long commands. Fast commands are\nexecuted outside the timeout command structure. The commands will execute once received, and results will immediately\nbe generated after execution. QUIETCANARY interprets ClearCommand and KillCommand as fast commands. Every other\nsupported command is a long command. Long commands are held to a timeout structure. Once the commands are parsed,\nthey are queued. Access to and execution of the commands is synchronized using the C# Monitor class.\n\nIt then generates a response string in the following format:\n\n**i<command id>l<length of result>r<result of command execution>**\n\nWhere the value following the \"r\" character is \"ok\" if the command was successful, and, if the command execution was\nunsuccessful, the type of command followed by \"error\" (i.e., \"kill error,\" \"command error,\" etc.).\n\nQUIETCANARY appends the response string to the string \"rep\" and sends a POST request to the C2. If the C2s response\nto the POST request is greater than 3 characters long and the first 3 characters are \"per,\" it returns the string after the first 3\ncharacters to be parsed.\n\n### QUIETCANARY’s Unused Code\n\nThe sample of QUIETCANARY we analyzed had an unused class called ServerInfoExtractor. The class contains a function\nthat would get some Base64-encoded value from the following registry key:\n\n**Key: HKCU\\Software\\Microsoft\\Fax\\Verification**\n\nIf the value within the key is \"No,\" the function returns the result \"No.\" Otherwise, it Base64 decodes the contents and\nreturns them.\n\nWe suspect this registry value may be used to store some configuration in other versions of QUIETCANARY. Since no code\nis present in the QUIETCANARY sample that would set this configuration value, we assume this would be set by some\nmethod outside the malware.\n\n### QUIETCANARY Network Communications\n\nAll network communications between QUIETCANARY and the C2 are RC4-encrypted and then Base-64 encoded.\nQUIETCANARY is proxy-aware and uses the System.Net.HttpWebRequest class to get any default proxy specified on the\nvictim computer. The malware also dynamically generates a random PHP session ID to use when sending a GET request to\nthe C2, which is added to the Cookie field in the request header.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-01-05 - Turla- A Galaxy of Opportunity.pdf"
    ],
    "report_names": [
        "2023-01-05 - Turla- A Galaxy of Opportunity.pdf"
    ],
    "threat_actors": [
        {
            "id": "81bd7107-6b2d-45c9-9eea-1843d4b9b308",
            "created_at": "2022-10-25T15:50:23.320841Z",
            "updated_at": "2025-03-27T02:00:55.441723Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Gamaredon Group",
                "IRON TILDEN",
                "Primitive Bear",
                "ACTINIUM",
                "Armageddon",
                "Shuckworm",
                "DEV-0157",
                "Aqua Blizzard"
            ],
            "source_name": "MITRE:Gamaredon Group",
            "tools": [
                "QuietSieve",
                "Pteranodon",
                "PowerPunch"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "61940e18-8f90-4ecc-bc06-416c54bc60f9",
            "created_at": "2022-10-25T16:07:23.659529Z",
            "updated_at": "2025-03-27T02:02:09.912404Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Actinium",
                "Aqua Blizzard",
                "Armageddon",
                "Blue Otso",
                "BlueAlpha",
                "Callisto",
                "DEV-0157",
                "Iron Tilden",
                "Operation STEADY#URSA",
                "Primitive Bear",
                "SectorC08",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder"
            ],
            "source_name": "ETDA:Gamaredon Group",
            "tools": [
                "Aversome infector",
                "BoneSpy",
                "DessertDown",
                "DilongTrash",
                "DinoTrain",
                "EvilGnome",
                "FRAUDROP",
                "Gamaredon",
                "GammaDrop",
                "GammaLoad",
                "GammaSteel",
                "Gussdoor",
                "ObfuBerry",
                "ObfuMerry",
                "PlainGnome",
                "PowerPunch",
                "Pteranodon",
                "Pterodo",
                "QuietSieve",
                "Remote Manipulator System",
                "Resetter",
                "RuRAT",
                "SUBTLE-PAWS",
                "UltraVNC"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "236a8303-bf12-4787-b6d0-549b44271a19",
            "created_at": "2024-06-04T02:03:07.966137Z",
            "updated_at": "2025-03-27T02:05:17.410356Z",
            "deleted_at": null,
            "main_name": "IRON TILDEN",
            "aliases": [
                "Aqua Blizzard ",
                "Armageddon",
                "Blue Otso ",
                "BlueAlpha ",
                "Dancing Salome ",
                "Gamaredon",
                "Gamaredon Group",
                "Hive0051 ",
                "Primitive Bear ",
                "Shuckworm ",
                "Trident Ursa ",
                "UAC-0010 ",
                "UNC530 ",
                "WinterFlounder ",
                "ACTINIUM "
            ],
            "source_name": "Secureworks:IRON TILDEN",
            "tools": [
                "Pterodo"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1675303711,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1675237407,
    "ts_modification_date": 1675237407,
    "files": {
        "pdf": "https://archive.orkl.eu/1dc350e97394d1cc92778d17e858154ef2a55a69.pdf",
        "text": "https://archive.orkl.eu/1dc350e97394d1cc92778d17e858154ef2a55a69.txt",
        "img": "https://archive.orkl.eu/1dc350e97394d1cc92778d17e858154ef2a55a69.jpg"
    }
}