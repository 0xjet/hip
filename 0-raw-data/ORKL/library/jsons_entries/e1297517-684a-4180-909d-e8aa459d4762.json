{
    "id": "e1297517-684a-4180-909d-e8aa459d4762",
    "created_at": "2023-01-12T15:02:03.933374Z",
    "updated_at": "2025-03-27T02:06:04.927237Z",
    "deleted_at": null,
    "sha1_hash": "bf48b98859dc00f9c7fd48e4b2dbed200c957abe",
    "title": "2021-08-04 - Pegasus Spyware- How It Works and What It Collects",
    "authors": "",
    "file_creation_date": "2022-05-29T10:40:13Z",
    "file_modification_date": "2022-05-29T10:40:13Z",
    "file_size": 2279380,
    "plain_text": "# Pegasus Spyware: How It Works and What It Collects\n\n**[zetter.substack.com/p/pegasus-spyware-how-it-works-and](https://zetter.substack.com/p/pegasus-spyware-how-it-works-and)**\n\nKim Zetter\n\nShare this post\n\nPegasus Spyware: How It Works and What It Collects\n\nzetter.substack.com\n\n## An NSO document leaked to the internet reveals how the Pegasus spyware - sold to intelligence and law enforcement agencies around the world - can be used to spy on targeted mobile phones.\n\n[Kim Zetter](https://substack.com/profile/9134384-kim-zetter)\nAug 4, 2021\n\n13\n\n1\n\nShare this post\n\nPegasus Spyware: How It Works and What It Collects\n\nzetter.substack.com\n\n\n-----\n\nScreenshot from a leaked NSO Group marketing brochure showing how the Pegasus control\npanel looks on a customer’s desktop computer as they view data siphoned from a target’s\nmobile phone.\nRevelations about Pegasus surveillance software continue to come a week after a\nconsortium of 17 media outlets began publishing stories about the spy tool.\n\n[To recap, the media outlets that participated in the Pegasus Project consortium, reported that](https://forbiddenstories.org/case/the-pegasus-project/)\nthe software sold to governments for monitoring terrorists and criminals has been abused by\nrepressive regimes with bad human rights records to spy on journalists, human-rights\nactivists and their families and associates — contrary to claims by these governments and\nthe company that makes the surveillance tool.\n\nThe stories were based in part on a leaked list of 50,000 phone numbers believed to have\nbeen chosen for surveillance by governments using the Pegasus software. But they also\nwere backed by forensic analysis on several dozen of those phones conducted by Amnesty\nInternational. That analysis found that of 67 phones on the list that were forensically\nexamined, 23 of those showed signs of a successful Pegasus infection, and 14 showed\nsigns of at least an attempted infection.\n\nNSO Group, the Israeli company that sells the software, has denied that its spy tool has\nbeen misused by governments and accuses the media outlets of basing their stories on false\n[assumptions. But the company also announced last week that it had temporarily blocked](https://www.npr.org/2021/07/29/1022409865/nso-suspended-govvernment-contracts-spyware-pegasus-project)\nseveral customers from using Pegasus while it investigates the accusations.\n\n\n-----\n\nTwo new stories published this week would seem to support the findings of the Pegasus\nconsortium. In the first, government investigators in France, conducting their own analysis\n[independent of Amnesty International and the consortium of media outlets, found evidence](https://www.theguardian.com/news/2021/aug/02/pegasus-spyware-found-on-journalists-phones-french-intelligence-confirms)\nthat the surveillance software had been used to target the mobile phones of three journalists\nin that country, including a senior staff member at the French television channel France 24.\n\nAnd British human rights activist and attorney, David Haigh, also found that his mobile phone\n[had been hacked using Pegasus, following a forensic examination of the phone by Amnesty](https://www.theguardian.com/world/2021/aug/02/princess-latifa-campaigner-david-haigh-phone-compromised-pegasus-spyware)\nInternational. Haigh’s phone number was not on the list of 50,000 numbers and had not been\npart of the original Amnesty investigation.\n\nHaigh presumably was targeted because he had been assisting Dubai’s Princess Latifa bint\nMohammed al-Maktoum in her campaign to flee her family and country — whom she\naccused of imprisoning her in her home — when his phone was targeted with the Pegasus\nsoftware in August 2020.\n\nFrench journalist Lénaïg Bredoux, whose phone was also allegedly targeted, told The\n_Guardian that “it’s extremely unpleasant to think that one is being spied on, that photos of_\nyour husband and children, your friends – who are all collateral victims – are being looked at;\nthat there is no space in which you can escape…. As journalists, what is even more worrying\nis that sources and contacts may have been compromised, that these are violations not just\nof your privacy and private life, but of the freedom of the press.”\n\nMost people will not be a target of this particular surveillance tool — which is sold to\ngovernment intelligence agencies and law enforcement. But it’s representative of other tools\nutilized by criminal and nation-state hackers, who don’t limit their use to tracking terrorists,\ncriminals, journalists, activists, and princesses. They target anyone who might have valuable\ninformation they want.\n\nSo what exactly does Pegasus software do?\n\n## What is Pegasus?\n\nAs noted, Pegasus is made by the NSO Group, a company based in Israel that claims the\nsoftware was developed by “veterans of intelligence and law enforcement agencies.” The\n_Washington Post has a_ [good piece describing how the company entered the surveillance](https://www.washingtonpost.com/world/2021/07/21/shalev-hulio-nso-surveillance/)\nspace after initially launching as something entirely different — NSO helped phone carriers\ntroubleshoot the mobile phones of their customers by sending the phones an SMS link that\ngave the carriers remote access to phones. You can see why law enforcement agencies\nmight have thought this could be useful for other purposes and therefore urged NSO to\ndevelop surveillance software.\n\nThe Pegasus tool gives NSO clients powerful abilities to remotely and surreptitiously extract\nstored and real-time data from phones without tipping off the user that their device is spilling\nits secrets\n\n\n-----\n\nWhy use Pegasus? It gives governments a way around encryption. If targets are using\nSignal or WhatsApp or any other application that encrypts communication end-to-end (from\nthe sender’s device to the recipient’s device), this prevents anyone from intercepting that\nprotected communication. Similarly, mobile phone protocols like 3G and 4G also use\nencryption to protect mobile voice communications from most types of interception. So a spy\ntool that sits on a user’s phone or iPad and records conversations in real-time or intercepts\nwritten communication before its encrypted and leaves the device — or after it arrives to the\ndevice and gets decrypted — has a natural appeal for spies and law enforcement.\n\n## What are its capabilities?\n\nSo how does Pegasus work and what does it capture? Based on a Pegasus marketing\nbrochure that was leaked online and appears to have been created in 2016, Pegasus can\ncollect usernames and passwords — for unlocking the device itself or for gaining access to\nthe target’s email account or other accounts like Skype, WhatsApp, Twitter, and Facebook. It\ncan extract all data stored on the phone, including the user’s database of contacts, text\nmessages sent and received, emails, photos, voice memos, calendar entries, call history,\nand browsing history. It can also activate the phone’s camera to grab images of the user or\ntheir surroundings, and it can activate the microphone to eavesdrop and record voice and\nVoIP calls in real time or monitor conversations occurring in the vicinity of a phone — for\nexample, while it sits atop a restaurant table or the desk in a worker’s office. And it can\ncollect GPS data from the phone to track the user’s location and movements on a map.\n\n\n-----\n\nAn illustration of the data collected by Pegasus (from leaked Pegasus marketing brochure)\nPegasus customers can either collect all data from a target’s phone or configure it to retrieve\nonly specific types of information or only when specific events occur. For example,\ncustomers can request the spyware to send an alert and record information only when the\ntarget is communicating with a specific phone or the target arrives at a specific location or\ntravels to a geographical area.\n\n“Instead of just waiting for information to arrive, hoping this is the information you were\nlooking for, the operator actively retrieves important information from the device, getting the\nexact information he was looking for,” the marketing literature states.\n\n\n-----\n\nExcerpt from Pegasus marketing brochure describing the options available to customers for\nspying on mobile phones.\n\n## How does Pegasus transmit the collected data?\n\nPegasus copies the information, compresses it and encrypts it (using AES 128-bit), then\ntransmits it from the phone to a command and control server set up on the Pegasus\ncustomer’s network. It sends the data to these servers at regular intervals or when the device\nis turned on and has internet connectivity.\n\nUntil the data gets transmitted, NSO says it’s stored in a “hidden and encrypted buffer” that is\nconfigured to hold no more than 5 percent of the device’s available space. If the device has\n1GB of free space, for example, the buffer can store up to 50 MB of data before it starts to\ndelete the oldest data.\n\n\n-----\n\nThe data is transmitted via WiFi when available, or via cellular networks. Though if the target\nis traveling in areas where expensive roaming charges might apply for transmitting data,\nWiFi is used, or the transmissions will stop altogether until the target is in a WiFi zone again.\n\nThe compressed data usually takes up only a few hundred bytes so that it won’t affect the\nperformance of the device or, if it’s sent via cellular networks, won’t show up as excess data\nusage on a victim’s phone plan.\n\nNSO Group says the transmitted data passes through anonymizing nodes located in different\nparts of the world in order to mask where the data is going and prevent a victim, or anyone\nelse intercepting the encrypted data, from tracing the spying activity to a government\nagency’s network. NSO says anonymizing nodes are set up for each customer so that only\ndata collected from phones targeted for surveillance by that particular customer gets passed\nthrough the nodes.\n\n## How does Pegasus infect mobile phones?\n\nPegasus can be installed on mobile phones in one of three ways: physically, remotely via a\ntext message or email, remotely via a silent message pushed to the phone. Physical\ninfection occurs when someone has direct access to a mobile phone they want to infect. The\ncompany says it takes less than five minutes to install the spy tool on a device.\n\nFor remote infections, a phishing text message or email is sent to the user — sometimes\nspoofed to make it appear to come from a trusted family member or friend — along with a\nlink. When the user clicks on the link, it takes their phone’s browser to a malicious page\nwhere Pegasus gets downloaded silently in the background without the user knowing it. All\nthat’s required is the target’s phone number or email address, and the system sends the\nmessage automatically. The system provides customers with examples for crafting a text\nmessage or email that is likely to entice the user to click on the malicious link.\n\nPerhaps most alarming, Pegasus can be delivered to phones using a no-click or zero-click\nexploit that doesn’t require the recipient to click on anything to be infected. This more\ninsidious method involves sending a silent iMessage in the background to the user’s phone\nso the user won’t see a text message on their screen. The customer creates iCloud accounts\nto send the messages. \"The installation is totally silent and invisible and cannot be prevented\nby the target,” Pegasus says in its marketing literature.\n\n\n-----\n\nWhere the victim is unlikely to click on a malicious link, Pegasus can also be injected into a\nphone using a stingray (also known as a rogue cell tower or rogue base station) in the\nvicinity of the phone — doing what is called a network-injection attack or man-in-the-middle\nattack. This can be useful when a target’s phone number is unknown. The Pegasus literature\nisn’t clear about how this would be used, but police or intelligence agencies can use a\nstingray that causes any phone in its vicinity to connect to the stingray instead of to a\nlegitimate cell tower. The stingray can then direct the device to a malicious web page where\n[Pegasis is silently downloaded to it. In 2019, Business Insider photographed a device being](https://www.businessinsider.com/nso-group-hacking-hardware-photo-jeff-bezos-mbs-saudi-hack-2020-1)\nsold by NSO Group at a surveillance tradeshow in Paris that appeared to be a rogue base\nstation or stingray. NSO had the device sitting in the back of a van at the tradeshow, to\ndemonstrate its portability. A 2019 [report by Amnesty indicates that a stingray was likely](https://www.amnesty.org/en/latest/research/2019/10/morocco-human-rights-defenders-targeted-with-nso-groups-spyware/)\nused to infect the phone of Moroccan human rights defender Maati Monjib with Pegasus.\n\nPegasus is able to infect phones — even iPhones and iPads with the latest security patches\ninstalled — because NSO Group uses zero-day exploits that attack software vulnerabilities\nthat are yet unknown to the phone maker and are therefore unpatched. In its recent analysis\nof Pegasus, Amnesty International found that Pegasus was using exploits that were\nsuccessful against iPhones running iOS 14.6 software, which was the latest version of\nApple’s mobile phone operating system at the time of Amnesty’s analysis. Each time Apple\npatches its operating system, NSO Group has been able to find or purchase new zero-day\nexploits attacking software vulnerabilities in different parts of the iPhone operating system,\n[keeping one or two steps ahead of Apple’s patches.](https://9to5mac.com/2021/07/19/zero-click-imessage-exploit/)\n\n## Can Pegasus be detected on a phone or iPad?\n\nAccording to NSO Group, no. According to Amnesty International and other groups that have\nconducted forensic investigations of infected devices, yes.\n\n“Detecting [Pegasus] is almost impossible,” the company’s marketing brochure states. “The\nPegasus agent is installed at the kernel level of the device, well concealed and is\nuntraceable by antivirus and antispy software.” And once the spyware is uninstalled from a\ndevice “it leaves no traces whatsoever or indications it was ever existed there,” the company\nclaims.\n\nPegasus also includes a self-destruct mechanism that can be activated remotely. “In cases\nwhere a great probability of exposing the [software] exists, a self-destruct mechanism is\nautomatically being activated and the agent is uninstalled. [The software] can be once again\ninstalled at a later time…. In cases where the [software] is not responding and did not\ncommunicate with the servers for a long time, the [software] will automatically uninstall itself\nto prevent being exposed or misused,” the company’s brochure states.\n\n[But Amnesty International’s technical report describes many artifacts left behind on mobile](https://www.amnesty.org/en/latest/research/2021/07/forensic-methodology-report-how-to-catch-nso-groups-pegasus/)\ndevices by Pegasus that have helped them identify phones that were infected or were\ntargeted with an attempted infection.\n\n\n-----\n\nAmnesty has also released a tool for detecting Pegasus on devices. It s designed primarily\nfor detecting Pegasus on iPhones, because Android phones don’t preserve the kind of\nevidence needed to detect Pegasus. But Amnesty says the tool can still help detect some\n[Pegasus artifacts on Android phones. The Verge has a good explainer for using the tool.](https://www.theverge.com/2021/7/21/22587234/amnesty-international-nso-pegasus-spyware-detection-tool-ios-android-guide-windows-mac)\n\nClaudio Guarnieri, head of Amnesty International's Security Lab, which conducted the\nforensic investigations for the Pegasus Project, says phone developers make it difficult to\naudit their devices to find spyware and has called on phone makers to rectify this.\n\n“It wasn't thanks to any dark wizardry [that] NSO kept secret,” Guarnieri wrote in his\nnewsletter this week, “but because of the difficulty to audit mobile devices why Pegasus for\nso long enjoyed an undeserved reputation of being undetectable, and why for so long\ntechnologists gave up even trying to check activists' phones….\n\n“[C]ollecting forensic evidence is harder than it should be,” Guarnieri continued. “While we\ndeveloped a decent process for [detecting Pegasus on] iPhones, we still wander in the dark\non most Android devices. Manufacturers ought to explore more opportunities to enable users\nto securely gather more diagnostic information useful to validate the integrity of their devices\nand identify potential traces of compromise. What we have now is not enough.”\n\nSee also:\n\n**[The NSO “Surveillance List”: What It Is and What It Isn’t](https://zetter.substack.com/p/the-nso-surveillance-list-what-it)**\n\n_If you liked this article or found it useful, fee free to share it:_\n\n[Share](https://zetter.substack.com/p/pegasus-spyware-how-it-works-and?utm_source=substack&utm_medium=email&utm_content=share&action=share)\n\n_If you’d like to receive other articles like this directly to your inbox, subscribe here:_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-04 - Pegasus Spyware- How It Works and What It Collects.pdf"
    ],
    "report_names": [
        "2021-08-04 - Pegasus Spyware- How It Works and What It Collects.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535723,
    "ts_updated_at": 1743041164,
    "ts_creation_date": 1653820813,
    "ts_modification_date": 1653820813,
    "files": {
        "pdf": "https://archive.orkl.eu/bf48b98859dc00f9c7fd48e4b2dbed200c957abe.pdf",
        "text": "https://archive.orkl.eu/bf48b98859dc00f9c7fd48e4b2dbed200c957abe.txt",
        "img": "https://archive.orkl.eu/bf48b98859dc00f9c7fd48e4b2dbed200c957abe.jpg"
    }
}