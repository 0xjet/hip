{
    "id": "66b79adb-cb51-4993-96b3-44afdd780ec3",
    "created_at": "2023-01-12T15:03:50.438287Z",
    "updated_at": "2025-03-27T02:16:21.024867Z",
    "deleted_at": null,
    "sha1_hash": "32b52971548e6fcf7ce71cc5cefbbfd0730aa142",
    "title": "2016-01-28 - BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents",
    "authors": "",
    "file_creation_date": "2022-05-28T02:01:29Z",
    "file_modification_date": "2022-05-28T02:01:29Z",
    "file_size": 972218,
    "plain_text": "# BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents\n\n**[securelist.com/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/73440/](https://securelist.com/blackenergy-apt-attacks-in-ukraine-employ-spearphishing-with-word-documents/73440/)**\n\nAuthors\n\nGReAT\n\nLate last year, a wave of cyber-attacks hit several critical sectors in Ukraine. Widely\n[discussed in the media, the attacks took advantage of known BlackEnergy Trojans as well as](https://securelist.com/be2-custom-plugins-router-abuse-and-target-profiles/67353/)\nseveral new modules.\n\nBlackEnergy is a Trojan that was created by a hacker known as Cr4sh. In 2007, he\n[reportedly stopped working on it and sold the source code for an estimated $700. The source](http://archive.is/RFBU)\ncode appears to have been picked by one or more threat actors and was used to conduct\nDDoS attacks against Georgia in 2008. These unknown actors continued launching DDoS\nattacks over the next few years. Around 2014, a specific user group of BlackEnergy\n\n\n-----\n\nattackers came to our attention when they began deploying SCADA-related plugins to\nvictims in the ICS and energy sectors around the world. This indicated a unique skillset, well\nabove the average DDoS botnet master.\n\nFor simplicity, we’re calling them the BlackEnergy APT group.\n\nOne of the prefered targets of the BlackEnergy APT has always been Ukraine. Since the\nmiddle of 2015, one of the preferred attack vectors for BlackEnergy in Ukraine has been\nExcel documents with macros that drop the Trojan to disk if the user chooses to run the\nscript in the document.\n\nA few days ago, we discovered a new document that appears to be part of the ongoing\nBlackEnergy APT group attacks against Ukraine. Unlike previous Office files used in\nprevious attacks, this is not an Excel workbook, but a Microsoft Word document. The lure\nused a document mentioning the Ukraine “Right Sector” party and appears to have been\nused against a television channel.\n\n## Introduction\n\nAt the end of the last year, a wave of attacks hit several critical sectors in Ukraine. Widely\ndiscussed in the media and by our colleagues from ESET, iSIGHT Partners and other\ncompanies, the attacks took advantage of both known BlackEnergy Trojans as well as\nseveral new modules. A very good analysis and overview of the BlackEnergy attacks in\nUkraine throughout 2014 and 2015 was published by the Ukrainian security firm Cys\nCentrum (the text is only available in Russian for now, but can be read via Google Translate).\n\nIn the past, we have written about BlackEnergy, focusing on their destructive payloads,\nSiemens equipment exploitation and router attack plugins. You can read blogs published by\n[my GReAT colleagues Kurt Baumgartner and Maria Garnaeva here and here. We also](https://securelist.com/be2-extraordinary-plugins-siemens-targeting-dev-fails/68838/)\n[published about the BlackEnergy DDoS attacks.](https://securelist.com/black-ddos/36309/)\n\nSince mid-2015, one of the preferred attack vectors for BlackEnergy in Ukraine has been\nExcel documents with macros which drop the trojan to disk if the user chooses to run the\nscript in the document.\n\nFor the historians out there, Office documents with macros were a huge problem in the early\n2000s, when Word and Excel supported Autorun macros. That meant that a virus or trojan\ncould run upon the loading of the document and automatically infect a system. Microsoft later\ndisabled this feature and current Office versions need the user to specifically enable the\nMacros in the document to run them. To get past this inconvenience, modern day attackers\ncommonly rely on social engineering, asking the user to enable the macros in order to view\n“enhanced content”.\n\n\n-----\n\nFew days ago, we came by a new document that appears to be part of the ongoing attacks\nBlackEnergy against Ukraine. Unlike previous Office files used in the recent attacks, this is\nnot an Excel workbook, but a Microsoft Word document:\n\n“$RR143TB.doc” (md5: e15b36c2e394d599a8ab352159089dd2)\n\nThis document was uploaded to a multiscanner service from Ukraine on Jan 20 2016, with\nrelatively low detection. It has a creation_datetime and last_saved field of 2015-07-27\n10:21:00. This means the document may have been created and used earlier, but was only\nrecently noticed by the victim.\n\nUpon opening the document, the user is presented with a dialog recommending the enabling\nof macros to view the document.\n\n[Interestingly, the document lure mentions “Pravii Sektor” (the Right Sector), a nationalist](https://en.wikipedia.org/wiki/Right_Sector)\nparty in Ukraine. The party was formed in November 2013 and has since played an active\nrole in the country’s political scene.\n\nTo extract the macros from the document without using Word, or running them, we can use a\npublicly available tool such as oledump by Didier Stevens. Here’s a brief cut and paste:\n\n\n-----\n\nAs we can see, the macro builds a string in memory that contains a file that is created and\nwritten as “vba_macro.exe”.\n\nThe file is then promptly executed using the Shell command.\n\nThe vba_macro.exe payload (md5: ac2d7f21c826ce0c449481f79138aebd) is a typical\nBlackEnergy dropper. It drops the final payload as\n“%LOCALAPPDATA%\\FONTCACHE.DAT”, which is a DLL file. It then proceeds to run it,\nusing rundll32:\n\nrundll32.exe “%LOCALAPPDATA%\\FONTCACHE.DAT”,#1\n\n\n-----\n\nTo ensure execution on every system startup, the dropper creates a LNK file into the system\nstartup folder, which executes the same command as above on every system boot.\n\n%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\{D0B53124-E232-49FC9EA9-75FA32C7C6C3}.lnk\n\nThe final payload (FONTCACHE.DAT, md5: 3fa9130c9ec44e36e52142f3688313ff) is a\nminimalistic BlackEnergy (v3) trojan that proceeds to connect to its hardcoded C&C server,\n5.149.254.114, on Port 80. The server was previously mentioned by our colleagues from\nESET in their [analysis earlier this month. The server is currently offline, or limits the](http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/)\nconnections by IP address. If the server is online, the malware issues as HTTP POST\nrequest to it, sending basic victim info and requesting commands.\n\nThe request is BASE64 encoded. Some of the fields contain:\n\nb_id=BRBRB-…\nb_gen=301018stb\nb_ver=2.3\nos_v=2600\nos_type=0\n\nThe b_id contains a build id and an unique machine identifier and is computed from system\ninformation, which makes it unique per victim. This allows the attackers to distinguish\nbetween different infected machines in the same network. The field b_gen seems to refer to\nthe victim ID, which in this case is 301018stb. STB could refer to the Ukrainian TV station\n“STB”, [http://www.stb.ua/ru/. This TV station has been publicly mentioned as a victim of the](http://www.stb.ua/ru/)\nBlackEnergy Wiper attacks in October 2015.\n\n## Conclusions\n\nBlackEnergy is a highly dynamic threat actor and the current attacks in Ukraine indicate that\ndestructive actions are on their main agenda, in addition to compromising industrial control\ninstallations and espionage activities.\n\n\n-----\n\nOur targeting analysis indicates the following sectors have been actively targeted in recent\nyears. If your organization falls into these categories, then you should take BlackEnergy into\naccount when designing your defences:\n\nICS, Energy, government and media in Ukraine\nICS/SCADA companies worldwide\nEnergy companies worldwide\n\nThe earliest signs of destructive payloads with BlackEnergy go back as far as June 2014.\nHowever, the old versions were crude and full of bugs. In the recent attacks, the developers\nappear to have gotten rid of the unsigned driver which they relied upon to wipe disks at low\nlevel and replaced it with more high level wiping capabilities that focus on file extensions as\nopposed on disks. This is no less destructive than the disk payloads, of course, and has the\nadvantage of not requiring administrative privileges as well as working without problems on\nmodern 64-bit systems.\n\nInterestingly, the use of Word documents (instead of Excel) was also mentioned by ICSCERT, in their [alert 14-281-01B.](https://ics-cert.us-cert.gov/alerts/ICS-ALERT-14-281-01B)\n\nIt is particularly important to remember that all types of Office documents can contain\nmacros, not just Excel files. This also includes Word, as shown here and alerted by ICSCERT and PowerPoint, as previously mentioned by Cys Centrum.\n\nIn terms of the use of Word documents with macros in APT attacks, we recently observed\nthe Turla group relying on Word documents with macros to drop malicious payloads\n_(Kaspersky Private report available). This leads us to believe that many of these attacks are_\nsuccessful and their popularity will increase.\n\nWe will continue to monitor the BlackEnergy attacks in Ukraine and update our readers with\nmore data when available.\n\n\n-----\n\nMore information about BlackEnergy APT and extended IOCs are available to customers of\nKaspersky Intelligence Services. Contact [intelreports@kaspersky.com.](http://10.10.0.46/mailto:///intelreports@kaspersky.com)\n\nKaspersky Lab products detect the various trojans mentioned here as:\nBackdoor.Win32.Fonten.* and\nHEUR:Trojan-Downloader.Script.Generic.\n\n**To know more about countering BlackEnergy and similar offensives, read** **[this article](https://www.kaspersky.com/blog/black-energy/5091/)**\n**on Kaspersky Business Blog.**\n\n## Indicators of compromise\n\n**Word document with macros (Trojan-Downloader.Script.Generic):**\n\ne15b36c2e394d599a8ab352159089dd2\n\n**Dropper from Word document (Backdoor.Win32.Fonten.y):**\n\nac2d7f21c826ce0c449481f79138aebd\n\n**Final payload from Word document (Backdoor.Win32.Fonten.o):**\n\n3fa9130c9ec44e36e52142f3688313ff\n\n**BlackEnergy C&C Server:**\n\n5.149.254[.]114\n\n[APT](https://securelist.com/tag/apt/)\n[BlackEnergy](https://securelist.com/tag/blackenergy/)\n[DDoS-attacks](https://securelist.com/tag/dos-attacks/)\n[Scada](https://securelist.com/tag/scada/)\n[Social engineering](https://securelist.com/tag/social-engineering/)\n[Wiper](https://securelist.com/tag/wiper/)\n\nAuthors\n\nGReAT\n\n\n-----\n\nBlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-01-28 - BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents.pdf"
    ],
    "report_names": [
        "2016-01-28 - BlackEnergy APT Attacks in Ukraine employ spearphishing with Word documents.pdf"
    ],
    "threat_actors": [
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535830,
    "ts_updated_at": 1743041781,
    "ts_creation_date": 1653703289,
    "ts_modification_date": 1653703289,
    "files": {
        "pdf": "https://archive.orkl.eu/32b52971548e6fcf7ce71cc5cefbbfd0730aa142.pdf",
        "text": "https://archive.orkl.eu/32b52971548e6fcf7ce71cc5cefbbfd0730aa142.txt",
        "img": "https://archive.orkl.eu/32b52971548e6fcf7ce71cc5cefbbfd0730aa142.jpg"
    }
}