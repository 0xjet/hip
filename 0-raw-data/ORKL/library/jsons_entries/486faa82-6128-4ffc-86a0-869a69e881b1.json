{
    "id": "486faa82-6128-4ffc-86a0-869a69e881b1",
    "created_at": "2023-01-12T15:04:01.471313Z",
    "updated_at": "2025-03-27T02:05:57.744958Z",
    "deleted_at": null,
    "sha1_hash": "7a381cc20bdabe7a345df0365d8dcf4ba558385f",
    "title": "2022-01-26 - BotenaGo strikes again - malware source code uploaded to GitHub",
    "authors": "",
    "file_creation_date": "2022-05-27T22:17:26Z",
    "file_modification_date": "2022-05-27T22:17:26Z",
    "file_size": 1898099,
    "plain_text": "# BotenaGo strikes again - malware source code uploaded to GitHub\n\n**[cybersecurity.att.com/blogs/labs-research/botenago-strike-again-malware-source-code-uploaded-to-github](https://cybersecurity.att.com/blogs/labs-research/botenago-strike-again-malware-source-code-uploaded-to-github)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nJanuary 26, 2022 | [Ofer Caspi](https://cybersecurity.att.com/blogs/author/ofer-caspi)\n\n## Executive summary\n\nIn November 2021, AT&T Alien Labs™ first published research on our discovery of new\nmalware written in the open-source programming language Golang. The team named this\n[malware “BotenaGo.” (Read previous article here.) In this article, Alien Labs is updating that](https://cybersecurity.att.com/blogs/labs-research/att-alien-labs-finds-new-golang-malwarebotenago-targeting-millions-of-routers-and-iot-devices-with-more-than-30-exploits)\nresearch with new information.\n\nRecently BotenaGo source code was uploaded to GitHub, potentially leading to a significant\nrise of new malware variants as malware authors will be able to use the source code and\nadapt it to their objectives. Alien Labs expects to see new campaigns based on BotenaGo\nvariants targeting routers and IoT devices globally. As of the publishing of this article,\nantivirus (AV) vendor detection for BotenaGo and its variants remains behind with very low\ndetection coverage from most of AV vendors.\n\n## Key takeaways:\n\n\n-----\n\nBotenaGo malware source code is now available to any malicious hacker or malware\ndeveloper.\nNew BotenaGo samples were found with very low AV detection (3/60 engines).\nWith only 2,891 lines of code, BotenaGo has the potential to be the starting point for\nmany new variants and new malware families using its source code.\n\n## Background\n\n[In September 2016, source code of one of the most popular botnets named Mirai was leaked](https://krebsonsecurity.com/2016/10/source-code-for-iot-botnet-mirai-released/)\n[and uploaded to one of the hacking community forums, and later uploaded to GitHub with](https://github.com/jgamblin/Mirai-Source-Code/blob/master/ForumPost.md)\ndetailed information on the botnet, its infrastructure, configuration and how to build it.\n\nSince the release of that information, the popularity of Mirai has increased dramatically.\nMultiple malware variants such as Moobot, Satori, Masuta, and others use the source code\nof Mirai. They then add unique functionality, which has resulted in these multiple variants\ncausing millions of infections. The Mirai botnet targets mostly routers and IoT devices, and it\nsupports different architectures including Linux x64, different ARM versions, MIPS,\nPowerPC, and more. Since the Mirai botnet can be now modified and compiled by different\nadversaries, many new variants have become available over time featuring new capabilities\nand new exploits.\n\nIn our November 2021 research article, Alien Labs first described its findings about the new\n[BotenaGo malware along with technical details. We used online tools such as Shodan to](https://www.shodan.io/)\nshow the potential damage the BotenaGo malware could cause, and its potential for putting\nmillions of IoT devices at risk.\n\nAlien Labs recently discovered that the source code of BotenaGo malware was uploaded to\n[GitHub on October 16th 2021, allowing any malicious hacker to use, modify, and upgrade it](https://github.com/Egida/kek/blob/19991ef983f838287aa9362b78b4ed8da0929184/loader_multi.go)\n— or even simply compile it as is and use the source code as an exploit kit, with the\npotential to leverage all BotenaGo’s exploits to attack vulnerable devices. The original source\nof the code is yet unknown. In the same repository, we have found additional hacking tools\ncollected from several different sources.\n\n## Source code analysis\n\nThe malware source code, containing a total of only 2,891 lines of code (including empty\nlines and comments), is simple yet efficient. It includes everything needed for a malware\nattack, including but not limited to:\n\nReverse shell and telnet loader, which are used to create a backdoor to receive\ncommands from its operator\nAutomatic set up of the malware’s 33 exploits, giving the hacker a “ready state” to\nattack a vulnerable target and infect it with an appropriate payload based on target type\nor operating system\n\n\n-----\n\nThe top of the source code on GitHub shows a comment with the list of current exploits for\n“supported” vendors and software, as shown in Figure 1.\n\nFigure 1 shows BotenaGo’s available exploits for multiple vendors.\n\nAs described in our previous blog, the malware initiates a total of 33 exploit functions\ntargeting different routers and IoT devices by calling the function \"scannerInitExploits” (see\nfigure 2).\n\n\n-----\n\nFigure 2 shows the initialization of 33 exploits.\n\nEach exploit function contains the exploit configuration (such as a specific “GET” request)\nand specific payload for the targeted system (see figure 3). Some exploits are a chain of\ncommands, such as multiple “GET” requests (see figures 4 and 5).\n\n\n-----\n\nFigure 3 shows the specific payload for different targets.\n\nFigure 4 shows the implementation of CVE-2020-10987.\n\n\n-----\n\nFigure 5 shows the implementation of CVE-2020-10173\n\nThe code contains additional configuration for a remote server, including available payloads\nand a path to folders that contains additional script files to execute on infected devices (see\nfigure 6).\n\nFigure 6 shows an example of additional configuration.\n\nOn top of all that, the main function calls together all of the necessary pieces: setting up a\nbackdoor, loading additional payload scripts, initializing exploit functions, and waiting for\ncommands (see figure 7). It is simple and clean malware creation in just 2,891 lines of code.\n\n\n-----\n\nFigure 7 shows BotenaGo’s main function.\n\n## Additional updates\n\nSince our first article on BotenaGo, the samples have continued to be used to exploit routers\nand IoT devices, spreading Mirai botnet malware. Even more worrisome, the samples\n[continue to have a very low AV detection rate, as shown below in VirusTotal (figure 8).](https://www.virustotal.com/gui/file/fef2b32e34ac1b64281c5083e7fc6e055c885820a38fa5eed1f563e38e04c6db)\n\n\n-----\n\nFigure 8 shows the low level of antivirus detections for BotenaGo s new variants.\n\nOne of the variants is configured to use a new Command and Control (C&C) server (see\nfigure 9).\n\nIt’s worth noting that the IP address for one of BotenaGo’s payload storage servers is\nincluded in the list of indicators of compromise (IOC) for detecting exploitation of the Apache\nLog4j security vulnerabilities. Read the [Alien Labs Report on Log4Shell.](https://cybersecurity.att.com/blogs/labs-research/global-outbreak-of-log4shell)\n\nFigure 9 shows a command to configure a C&C server for a BotenaGo variant.\n\n## Recommended actions\n\n1. Maintain minimal exposure to the Internet on Linux servers and IoT devices and use a\n\nproperly configured firewall.\n2. Install security and firmware upgrades from vendors, as soon as possible.\n\n\n-----\n\n3. Check your system for unnecessary open ports and suspicious processes.\n\n## Conclusion\n\nToday, BotenaGo variants serve as a standalone exploit kit and as a spreading tool for other\nmalware. Now with its source code available to any malicious hacker, new malicious activity\ncan be added easily to the malware. Alien Labs sees the potential for a significant increase\nin these malware variants, giving rise to potentially new malware families that could put\nmillions of routers and IoT devices at risk of attack.\n\n## Detection methods\n\nThe following associated detection methods are in use by Alien Labs. They can be used by\nreaders to tune or deploy detections in their own environments or for aiding additional\nresearch.\n\nSURICATA IDS SIGNATURES\n\n4001488: AV TROJAN Mirai Outbound Exploit Scan, D-Link HNAP RCE (CVE-2015-2051)\n\n4000456: AV EXPLOIT Netgear Device RCE (CVE-2016-1555)\n\n4000898: AV EXPLOIT Netgear DGN2200 ping.cgi - Possible Command Injection ( CVE2017-6077 )\n\n2027093: ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6077)\n\n2027881: ET EXPLOIT NETGEAR R7000/R6400 - Command Injection Inbound (CVE2019-6277)\n\n2027882: ET EXPLOIT NETGEAR R7000/R6400 - Command Injection Outbound (CVE2019-6277)\n\n2830690: ETPRO EXPLOIT GPON Authentication Bypass Attempt (CVE-2018-10561)\n\n2027063: ET EXPLOIT Outbound GPON Authentication Bypass Attempt (CVE-201810561)\n\n2830690: ETPRO EXPLOIT GPON Authentication Bypass Attempt (CVE-2018-10561)\n\n\n-----\n\n2027063: ET EXPLOIT Outbound GPON Authentication Bypass Attempt (CVE-201810561)\n\n2831296: ETPRO EXPLOIT XiongMai uc-httpd RCE (CVE-2018-10088)\n\n4001914: AV EXPLOIT DrayTek Unauthenticated root RCE (CVE-2020-8515)\n\n2029804: ET EXPLOIT Multiple DrayTek Products Pre-authentication Remote RCE\nOutbound (CVE-2020-8515) M1\n\n2029805: ET EXPLOIT Multiple DrayTek Products Pre-authentication Remote RCE\nInbound (CVE-2020-8515) M1\n\n2029806: ET EXPLOIT Multiple DrayTek Products Pre-authentication Remote RCE\nOutbound (CVE-2020-8515) M2\n\n2029807: ET EXPLOIT Multiple DrayTek Products Pre-authentication Remote RCE\nInbound (CVE-2020-8515) M2\n\n4002119: AV EXPLOIT Comtrend Router ping.cgi RCE (CVE-2020-10173)\n\n2030502: ET EXPLOIT Possible Authenticated Command Injection Inbound - Comtrend\nVR-3033 (CVE-2020-10173)\n\n4001814: AV EXPLOIT TOTOLINK Router PostAuth RCE (CVE-2019-19824)\n\n2029616: ET EXPLOIT Zyxel NAS RCE Attempt Inbound (CVE-2020-9054) M1\n\n2029617: ET EXPLOIT Zyxel NAS RCE Attempt Inbound (CVE-2020-9054) M2\n\n4001142: AV EXPLOIT ManagedITSync - Kaseya exploitation (CVE-2017-18362) v1\n\n4001143: AV EXPLOIT ManagedITSync - Kaseya exploitation (CVE-2017-18362) v2\n\n2032077: ET EXPLOIT ZTE Cable Modem RCE Attempt (CVE-2014-2321)\n\n4000897: AV EXPLOIT Netgear DGN2200 dnslookup.cgi Lookup - Possible Command\nInjection (CVE-2017-6334)\n\n\n-----\n\n2027094: ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6334)\n\n### Associated indicators (IOCs)\n\nThe following technical indicators are associated with the reported intelligence. A list of\nindicators is also available in an Alien Labs Open Threat Exchange™ (OTX™) pulse. You\n[can access the OTX pulse here. If you are not an OTX member, it is free to](https://otx.alienvault.com/pulse/61894367200f8ce537dda952) [join our global,](https://cybersecurity.att.com/open-threat-exchange)\nopen-source threat intelligence community of more than 200,000.\n\nTYPE INDICATOR DESCRIPTION\n\n\nIP\nADDRESS\n\nIP\nADDRESS\n\nIP\nADDRESS\n\nIP\nADDRESS\n\n\n\n[86].110.32.167:80 BotenaGo C&C\n\n[179].43.187.197 Malware payload\nserver\n\n[2].56.56.78 Malware payload\nserver\n\n[209].141.59.56 Malware payload\nserver\n\n\nSHA1 cca00b32d610becf3c5ae9e99ce86a320d5dac87 BotenaGo malware\nhash\n\nSHA1 eb6bbfe8d2860f1ee1b269157d00bfa0c0808932 BotenaGo malware\nhash\n\nSHA1 01dc59199691ce32fd9ae77e90dad70647337c25 BotenaGo malware\nhash\n\nSHA1 97d5d30a4591df308fd62fa7ffd30ff4e7e4fab9 BotenaGo Payload\n\nSHA1 e9aa2ce4923dd9e68b796b914a12ef298bff7fe9 BotenaGo Payload\n\nSHA1 251b02ea2a61b3e167253546f01f37b837ad8cda BotenaGo Payload\n\n\n-----\n\nSHA1 fa10e8b6047fa309a73d99ec139627fd6e1debe1 BotenaGo Payload\n\nSHA1 154fc9ea3b0156fbcdcb6e7f5ba849c544a4adfd BotenaGo Payload\n\nSHA1 0c9ddad09cf02c72435a76066de1b85a2f5cf479 BotenaGo Payload\n\nSHA1 b4af080ad590470eefaadc41f777a2d196c5b0ba BotenaGo Payload\n\nSHA1 87ef2fd66fdce6f6dcf3f96a7146f44836c7215d BotenaGo Payload\n\nSHA1 3c2f4fcd66ca59568f89eb9300bb3aa528015e1c BotenaGo Payload\n\n## Mapped to MITRE ATT&CK\n\n[The findings of this report are mapped to the following MITRE ATT&CK Matrix techniques:](https://attack.mitre.org/)\n\nTA0008: Lateral Movement\n\nT1210: Exploitation of Remote Services\nT1570: Lateral Tool Transfer\nTA0011: Command and Control\n\nT1571: Non-Standard port\n\n*Current as of the publishing of this article.\n\n### Share this with others\n\nTags: [malware research,](https://cybersecurity.att.com/blogs/tag/malware+research) [threat intellligence,](https://cybersecurity.att.com/blogs/tag/threat+intellligence) [botenago](https://cybersecurity.att.com/blogs/tag/botenago)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-26 - BotenaGo strikes again - malware source code uploaded to GitHub.pdf"
    ],
    "report_names": [
        "2022-01-26 - BotenaGo strikes again - malware source code uploaded to GitHub.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535841,
    "ts_updated_at": 1743041157,
    "ts_creation_date": 1653689846,
    "ts_modification_date": 1653689846,
    "files": {
        "pdf": "https://archive.orkl.eu/7a381cc20bdabe7a345df0365d8dcf4ba558385f.pdf",
        "text": "https://archive.orkl.eu/7a381cc20bdabe7a345df0365d8dcf4ba558385f.txt",
        "img": "https://archive.orkl.eu/7a381cc20bdabe7a345df0365d8dcf4ba558385f.jpg"
    }
}