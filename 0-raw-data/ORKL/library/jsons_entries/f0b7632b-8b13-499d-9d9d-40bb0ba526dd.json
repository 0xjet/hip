{
    "id": "f0b7632b-8b13-499d-9d9d-40bb0ba526dd",
    "created_at": "2022-10-25T16:48:19.456694Z",
    "updated_at": "2025-03-27T02:11:26.83109Z",
    "deleted_at": null,
    "sha1_hash": "c7d0387067ba747e3a3d9b43b7349d7888bf574e",
    "title": "The Msupdater Trojan And Ongoing Targeted Attacks",
    "authors": "Seculert, Zscaler",
    "file_creation_date": "2012-01-31T20:44:35Z",
    "file_modification_date": "2012-01-31T20:44:35Z",
    "file_size": 3604712,
    "plain_text": "# The \r “MSUpdater” \r Trojan \r  \r  And \r Ongoing \r Targeted \r Attacks \r \n### A \r Zscaler \r and \r Seculert \r Joint \r Report \r \n\n## Contents \r \n**CONTENTS \r ................................................................................................................... \r 1**\n**OVERVIEW \r ................................................................................................................... \r 1**\n**“MSUPDATER” \r TROJAN \r INCIDENTS \r OBSERVED \r ............................................................. \r 2**\n**OSINT \r AGGREGATION \r AND \r CORRELATION \r ................................................................... \r 2**\n**INFECTION** **VECTOR:** **PHISHING** **EMAIL** **WITH** **MALICIOUS** **ATTACHMENT \r ........................ \r 3**\n**RELATED** **BACKDOOR** **/** **BEACONING** **PATTERN \r .................................................................. \r 3**\n**SEPTEMBER \r 2010 \r CVE-­‐2010-­‐2883 \r PDF \r PHISH \r ................................................................ \r 5**\n**SEPTEMBER \r 23, \r 2010 \r ISSNIP \r PHISHING \r EMAIL \r WITH \r MALICIOUS \r ATTACHMENT………….8**\n**RELATED** **ANTIVIRUS** **VENDOR** **“FAMILY”** **NAMES \r .......................................................... \r 9**\n**“CONFERENCE” \r LURE \r ................................................................................................. \r 10**\n**CLOSING \r REMARKS \r .................................................................................................... \r 11**\n**APPENDIX \r A: \r CONSOLIDATED \r LIST \r OF \r MALICIOUS \r MD5 \r HASHES \r ................................ \r 13**\n\n## Overview \r \nResearchers \r from \r Zscaler \r and \r Seculert \r separately \r identified \r incidents \r and \r threats \r discussed \r in \r this\nreport. \r  \r Within \r a \r private \r security \r forum \r we \r discussed \r and \r determined \r that \r we \r had \r identified \r related\nincidents. \r Zscaler \r and \r Seculert \r collaborated \r on \r this \r report \r to \r aggregate \r and \r correlate \r our \r findings \r along\nwith \r open-­‐source \r intelligence \r (OSINT) \r to \r detail \r a \r lesser-­‐known \r “MSUpdater” \r remote \r access \r Trojan \r (RAT)\nand \r its \r linkage \r to \r current \r targeted \r attacks \r and \r others \r dating \r back \r to \r at \r least \r early \r 2009. \r Foreign \r and\ndomestic \r (United \r States) \r companies \r with \r intellectual \r property \r dealing \r in \r aero/geospace \r and \r defense\nseem \r to \r be \r some \r of \r the \r recent \r industries \r targeted \r in \r these \r attacks.\n\nThe \r goal \r of \r this \r report \r is \r to \r aggregate \r information, \r draw \r some \r correlations, \r and \r provide \r an \r overview \r of\nthis \r threat \r to \r facilitate \r its \r identification, \r detection, \r and \r functionality. \r  \r With \r this \r goal \r in \r mind, \r we \r also \r aim\nnot \r to \r reveal \r anything \r that \r might \r disrupt \r any \r investigations \r or \r state \r something \r without \r additional \r open-­‐\nsource \r corroboration. \r  \r We \r as \r security \r researchers \r believe \r that \r our \r success \r is \r not \r measured \r by \r how\nmuch \r information \r we \r collect, \r but \r in \r how \r we \r use \r and \r share \r the \r information \r to \r better \r secure \r and \r protect\nthe \r Internet \r community \r from \r threats. \r  \r We \r hope \r that \r the \r information \r within \r this \r report \r helps \r to \r detect\nand \r remediate \r this \r threat \r within \r organizations.\n\n\n©2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\n## “MSUpdater” \r Trojan \r Incidents \r Observed \r \nZscaler \r and \r Seculert \r separately \r identified \r security \r incidents \r where \r infected \r customers \r in \r the \r fore-­‐\nmentioned \r industries \r had \r command \r and \r control \r (C&C) \r beacons \r matching \r the \r below \r patterns. \r  \r Standard\nMicrosoft \r Internet \r Explorer \r user-­‐agent \r strings \r (versions \r 6 \r – \r 8) \r were \r observed \r for \r the \r C&C\ncommunications.\n\nThe \r most \r often \r observed \r pattern, \r and \r likely \r the \r C&C \r “check-­‐in” \r behavior \r followed \r the \r pattern:\n\n  - HTTP \r GET \r requests \r to \r the \r path:\n/microsoftupdate/getupdate/default.aspx?ID=[num1]para1=[num2]para2=[num3]para3=[num4\n]\nWhere \r the \r [num] \r fields \r are \r placeholders \r for \r parameters \r passed \r by \r the \r victim \r in \r the \r form \r of \r numbers.\n\nOther \r patterns \r observed \r from \r the \r infected \r hosts \r to \r the \r C&Cs \r were:\n\n  - HTTP \r GET \r and \r POST \r requests \r to \r the \r path:\n/microsoft/errorpost/default/connect.aspx?ID=[num1]\n\n  - HTTP \r POSTs \r to \r the \r path: \r /microsoft/errorpost/default.aspx?ID=[num1]\n\nClearly \r the \r above \r patterns \r are \r trying \r to \r appear \r as \r though \r they \r are \r related \r to \r Microsoft’s \r “Windows\nUpdate” \r service \r versus \r something \r malicious. \r  \r A \r clear, \r common \r name \r for \r this \r particular \r threat \r did \r not\nseem \r to \r emerge \r in \r the \r open-­‐source, \r so \r we \r have \r commonly \r referred \r to \r this \r threat \r family \r as \r the\n“MSUpdater” \r Trojan.\n\nThe \r first \r time \r this \r pattern \r was \r logged \r in \r traffic \r traversing \r Zscaler’s \r Cloud \r infrastructure \r was \r on\n12/25/2010 \r (Christmas \r day). \r  \r It \r is \r likely \r that \r the \r Christmas \r day \r infection \r resulted \r from \r a \r targeted\nphishing \r email \r as \r related \r attacks \r in \r this \r report \r identify \r this \r as \r the \r infection \r vector. \r  \r No \r suspicious \r web\ntransactions \r were \r observed \r from \r the \r infected \r host \r prior \r to \r the \r C&C \r beaconing. \r  \r Seculert \r FogSense\nCloud-­‐based \r service \r observed \r instances \r of \r this \r same \r infected \r beaconing \r pattern \r for \r their \r customers \r as\nearly \r as \r March \r 2010. \r  \r Zscaler \r and \r Seculert \r each \r identified \r these \r infections \r separately \r by \r conducting\ntraffic \r analysis \r to \r identify \r previously \r unknown \r threats \r to \r then \r protect \r their \r customers. \r  \r Open-­‐source\nintelligence \r (OSINT) \r on \r the \r beaconing \r patterns \r we \r observed \r provided \r additional \r information \r to \r this\nprevious \r threat.\n\n## OSINT \r Aggregation \r and \r Correlation \r \nIn \r addition \r to \r industry \r collaboration \r to \r better \r understand \r and \r protect \r against \r threats, \r “Google” \r or \r more\nspecifically \r OSINT \r is \r a \r valuable \r resource \r when \r looking \r into \r “unidentified” \r threats. \r  \r The \r following\nprovides \r some \r details \r about \r what \r is \r known \r and \r has \r been \r discussed \r in \r the \r open-­‐source \r related \r to \r this\nthreat.\n\n\n2\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\n## Infection \r Vector: \r Phishing \r Email \r with \r Malicious \r Attachment \r \nA \r publicly \r available \r presentation \r from \r Sword \r & \r Shield \r Enterprise \r Security \r Inc.[1] \r includes \r a \r slide \r discussing\nthe \r correlation \r of \r a \r malicious \r phishing \r attachment \r to \r C&C \r beaconing \r that \r resembles \r the \r same \r pattern\nidentified \r above. \r Specifically, \r the \r presentation \r provides \r a \r screenshot \r of \r an \r associated \r malicious \r phishing\nemail \r showing \r that \r it \r was \r sent \r April \r 28, \r 2011 \r with \r the \r subject \r “Information \r for \r Contractor” \r and\n“chap6.pdf” \r attachment:\n\n**Figure \r 1 \r Screenshot \r of \r 4/28/2011 \r Phish**\n\nThe \r presentation \r then \r goes \r on \r to \r show \r that \r opening \r the \r PDF \r attachment \r exploited \r a \r vulnerability \r and\ncaused \r a \r process \r named \r “GoogleTray.exe” \r to \r launch \r and \r connect \r to:\n\n  - mail.hfmforum.com/microsoftupdate/getupdate/default.aspx\n\n## Related \r Backdoor \r / \r Beaconing \r Pattern \r \nBy \r linking \r domain \r registration \r information \r from \r some \r of \r the \r C&Cs \r observed, \r we \r were \r able \r to \r determine\nother \r C&C \r domains \r used \r by \r this \r malicious \r actor/group. \r  \r A \r specific \r example \r of \r this \r was \r the \r following\nregistration \r information \r observed \r in \r a \r “MSUpdater” \r Trojan \r C&C \r domain:\n\n1 http://ilta.ebiz.uapps.net/ProductFiles/productfiles/782804/2011siems.pptx\n\n\n-----\n\n**Figure \r 2 \r WHOIS \r information \r for \r C&C \r domains**\n\nThis \r contact \r information \r was \r used \r in \r other \r domains \r that \r have \r some \r open-­‐source \r reports \r on \r C&C \r usage,\nfor \r example:\n\n  - SISEAU.COM\n\n  - VSSIGMA.COM\n\nThese \r domains \r have \r open-­‐source \r reports \r tied \r to \r malware \r samples \r with \r MD5 \r hashes:\n\n  - 3459BC37967480DEE405A5AC678B942D[2]\n\n  - 6631815D4AB2A586021C24E02E5CC451[3]\n\nCommunication \r to \r these \r domains \r was \r also \r observed \r with \r the \r following \r C&C \r communication \r path\npattern:\n\n  - /search[RndNum1]?h1=[Num1]&h2=[Num2]&h3=[String1]&h4=[String2]\nFor \r example:\n\n  - /search521649?h1=51&h2=1&h3=N07630&h4=FKFDFDAHAEBAEPFLFK\n\nThe \r number \r of \r parameters \r in \r these \r “search” \r beacons \r closely \r resembles \r that \r in \r the \r previously\nmentioned \r “para” \r beacons. \r  \r However, \r the \r previously \r mentioned \r “para” \r beacons \r appear \r to \r use \r a\ndifferent \r encoding. \r  \r These \r related \r samples \r also \r have \r VirusTotal \r reports[4],[5] \r which \r provide \r additional\ndetails \r about \r the \r binaries \r and \r how \r they \r are \r being \r detected. \r  \r Specifically:\n\n2 http://www.malware-­‐control.com/statics-­‐pages/3459bc37967480dee405a5ac678b942d.php\n\n3 http://www.threatexpert.com/report.aspx?md5=6631815d4ab2a586021c24e02e5cc451\n\n4 https://www.virustotal.com/file/6a237ffe0f7d84ffd9652662a2638a9b5212636b414ce15ea2e39204d2a24e7f/analysis/1267308842/\n\n5 https://www.virustotal.com/file/75d3c3875744196cedff55d179bc62412adeba5e769fbfc85b2b891ff32b4f9f/analysis/1265252262/\n\n\n4\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\nMD5: \r 3459BC37967480DEE405A5AC678B942D\n\n  - VirusTotal \r timeframe: \r 02/06/2010 \r – \r 02/27/2010\n\n  - The \r file \r name \r is \r wuauclt.exe \r with \r “Microsoft \r Corporation” \r as \r the \r publisher \r (this \r publisher \r string\nwas \r observed \r in \r other \r related \r samples \r as \r well)\n\nMD5: \r 6631815D4AB2A586021C24E02E5CC451\n\n  - VirusTotal \r timeframe: \r 08/18/2009 \r – \r 02/04/2010\n\n  - ThreatExport \r report \r shows \r backdoor \r on \r 1033/TCP\n\n  - Packed \r with \r Armadillo \r (identified \r in \r other \r related \r samples \r as \r well)\n\nAntivirus \r detection \r for \r both \r samples \r indicate \r that \r it \r is \r a \r “Backdoor \r Agent”, \r however, \r DrWeb \r specifically\ncalls \r these \r samples \r something \r a \r bit \r unique: \r “BackDoor.Calla.5” \r where \r “Calla” \r is \r the \r family \r (added \r to\ntheir \r detection \r 02/02/2009)[6] \r and \r 5 \r is \r the \r variant.\n\nSearching \r for \r other \r malware \r / \r incidents \r that \r exhibit \r this \r similar \r “search” \r / \r “h1” \r beaconing \r pattern\nshows \r a \r number \r of \r related \r open-­‐source \r examples, \r as \r discussed \r in \r the \r following \r sections.\n\n## September \r 2010 \r CVE-­‐2010-­‐2883[7] \r PDF \r Phish \r \nSeptember \r 16, \r 2010 \r the \r blog \r Contagio \r detailed \r a \r malicious \r phishing \r campaign \r exploiting \r a \r buffer\noverflow \r vulnerability \r in \r the \r Adobe \r PDF \r reader[8]. \r At \r the \r time, \r this \r was \r a \r 0-­‐day \r exploit, \r as \r a \r patch \r was \r not\nreleased \r by \r Adobe \r until \r October \r 5, \r 2010. \r  \r The \r exploit \r was \r contained \r in \r the \r attachment:\n\n- INTEREST_&_FOREIGN_EXCHANGE_RATES.pdf\n`o` MD5: \r 4EF704239FA63D1C1DFCF2EA2DA0D711[9]\n\nThis \r PDF \r dropped \r a \r similar \r set \r of \r files:\n\n- setup.exe:\n`o` MD5: \r 95D42D365489A6E5EBDF62565C5C8AA2\n`o` Sophos \r uniquely \r detects[10] \r as \r Mal/Ovoxual-­‐A \r (detection \r added \r 07/19/2010)[11]\n`o` Which \r creates \r FAVORITES.DAT \r (data \r file) \r and \r launches \r msupdater.exe[12]\n\n- msupdater.exe:\n`o` MD5: \r 374075CE8B6E8F0CD1F90009FD5A703B\n\n6 http://vms.drweb.com/virus/?i=225137\n\n7 http://www.adobe.com/support/security/advisories/apsa10-­‐02.html\n8 http://contagiodump.blogspot.com/2010/09/sep-­‐16-­‐cve-­‐2010-­‐2883-­‐pdf-­‐interest.html\n9 https://www.virustotal.com/file/daac83fc4af5c53068c4e5a29dadfdc5200e3b3fc2b491eebe0a4bc19ec9e3f2/analysis/1285731514/\n10 https://www.virustotal.com/file/ecefcd2f2b862e987ea4b6b7d475c924d9662ad955096872a2c5b822901c63b3/analysis/\n11 http://www.sophos.com/en-­‐us/threat-­‐center/threat-­‐analyses/viruses-­‐and-­‐spyware/Mal~Ovoxual-­‐A/detailed-­‐analysis.aspx\n12 http://anubis.iseclab.org/?action=result&task_id=14495366b24a64d242d1946aa1e3a88be&format=html\n\n\n5\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\n`o` Sophos \r uniquely \r detects[13] \r as \r Mal/ \r Ovoxual-­‐B \r (added \r 07/19/2010)[14]\n`o` Sandbox \r reports \r for \r this \r sample \r generally \r fail[15] \r showing \r the \r following \r dialog \r box:\n\n**Figure \r 3 \r ThreatExpert \r Malware \r Failure \r Dialog \r Box**\n\nSystem \r runtime \r analysis \r showed \r an \r initial \r malformed \r Google \r query:\n\n- www.google.com/search?qu=\n\n**Figure \r 4 \r Malformed \r Google \r PCAP \r During \r Run-­‐Time \r Analysis**\n\nFollowed \r by \r failed \r connection \r attempts \r to:\n\n- 140.112.19.195 \r (National \r Taiwan \r University)\n\nA \r further \r detailed \r static \r analysis \r on \r this \r msupdate.exe \r / \r FAVORITES.DAT \r sample \r was \r completed \r by\nCyberESI[16]. \r  \r In \r their \r report \r they \r discuss \r that \r the \r setup.exe \r dropper \r is \r virtual \r machine \r (VM) \r aware \r by\nusing \r the \r SIDT \r instruction[17] \r – \r if \r a \r VM \r is \r detected, \r the \r msupdate.exe \r Trojan \r is \r not \r dropped. \r  \r The\nmsupdate.exe \r Trojan \r too \r is \r VM \r aware \r using \r the \r same \r SIDT \r method \r – \r if \r a \r VM \r is \r not \r detected \r then \r the\nTrojan \r RC4 \r decrypts \r the \r FAVORITES.DAT \r file \r and \r spawns \r a \r svchost.exe \r process \r which \r conducts \r the\nnetwork \r C&C \r check-­‐ins. \r  \r This \r evasion \r is \r the \r reason \r for \r the \r above \r shown \r failed \r sandboxing \r analysis \r that\ndoes \r not \r include \r any \r network \r activity.\n\nThe \r decrypted \r FAVORITES.DAT \r executable \r for \r this \r sample \r had \r an \r MD5 \r hash \r of:\n\n13 www.virustotal.com/file-­‐scan/report.html?id=043935374ce39637a4816d0a484d30bed1d3054bbe89625fbc22f83ef4cb3e04-­‐1285736283\n14 http://www.sophos.com/en-­‐us/threat-­‐center/threat-­‐analyses/viruses-­‐and-­‐spyware/Mal~Ovoxual-­‐B/detailed-­‐analysis.aspx\n15 http://www.threatexpert.com/report.aspx?md5=374075ce8b6e8f0cd1f90009fd5a703b\n16 http://www.cyberesi.com/2011/03/17/msupdate-­‐exe-­‐favorites-­‐dat-­‐analysis/\n17 http://www.securiteam.com/securityreviews/6Z00H20BQS.html\n\n\n-----\n\n- 5E3EACA3806769836C3AD9D46A209644[18]\n\n`o` Microsoft \r and \r a \r few \r other \r A/V \r vendors \r detect \r as \r Backdoor \r Matchaldru.B\n`o` DrWeb \r uses \r their \r same \r “Calla” \r family: \r “Backdoor.Calla.16”\n`o` The \r VirusTotal \r timeframe \r for \r submissions \r of \r this \r decrypted \r executable \r are \r from:\n\n03/15/2011 \r – \r 04/20/2011.\n\nHere \r is \r the \r Google \r “decoy \r beacon” \r made \r by \r the \r Trojan:\n\n**Figure \r 5 \r Initial \r Malformed \r Google \r HTTP \r Request**\n\nFollowed \r by \r the \r initial \r C&C \r check-­‐in \r request:\n\n**Figure \r 6 \r Related \r Malware \r C&C \r Initial \r Check-­‐In \r Request**\n\nThe \r check-­‐in \r request \r values \r correspond \r to \r the \r following \r meanings:\n\n    - The \r h1 \r parameter \r value \r corresponds \r to \r the \r Windows \r version, \r 51 \r = \r Windows \r XP \r (version\n5.1)\n\n    - The \r h4 \r parameter \r value \r is \r a \r victim \r identification \r string \r created \r by \r encoding \r the \r volume\nserial \r number \r of \r the \r victim’s \r system \r concatenated \r with \r a \r random \r number\n\n    - The \r string \r within \r the \r user-­‐agent \r (BKANAHEAFPEM) \r is \r the \r result \r of \r an \r encoding \r of \r the \r victim\nmachine \r name\n\n    - The \r number \r following \r “search5” \r in \r the \r path \r is \r random\n\n    - The \r remaining \r are \r hard-­‐coded \r in \r the \r Trojan. \r  \r The \r “BHI06233” \r string \r is \r thought \r to \r be \r related\nto \r the \r actor’s \r group \r of \r related \r targets \r or \r campaign, \r where \r BHI \r may \r stand \r for \r “Baker \r Hughes\n\n18 https://www.virustotal.com/file/d8a976979d4eeaf7485249c49d4a31824638a49dac308c5114c113b4a3eed9c9/analysis/1300216834/\n\n\n7\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\nInternational” \r who \r along \r with \r other \r companies \r in \r the \r oil, \r gas, \r and \r energy \r sector \r were \r the\nfocus \r of \r some \r targeted \r attacks.[19]\n\nThe \r data \r in \r the \r check-­‐in \r HTTP \r communication \r to \r and \r from \r the \r C&C \r are \r encoded \r using \r single-­‐byte\nXORing \r and \r is \r treated \r as \r authentication \r into \r the \r botnet. \r  \r Once \r authenticated, \r the \r victim \r uses \r the\nfollowing \r check-­‐in \r beacons:\n\n    - HTTP \r GET: \r /search6[RndNum]?h1=[VictimId]\n\n`o` Where \r VictimId \r is \r the \r same \r string \r identifying \r the \r victim \r machine \r as \r the \r previously\n\nused \r h4 \r parameter \r value.\n\n    - User-­‐Agent: \r Mozilla/5.0 \r (compatible; \r Windows \r NT \r 5.2)\n\n`o` Note \r that \r the \r user-­‐agent \r changed \r to \r a \r hard-­‐coded \r string \r versus \r using \r the \r encoded\n\nsystem \r name \r in \r the \r initial \r check-­‐in.\n\nSome \r of \r the \r Trojan \r functionality \r includes:\n\n    - Download \r file \r from \r C&C:\n\n`o` HTTP \r GET: \r /download7[RndNum]?h1=[VictimId]\n\n    - Upload \r file \r to \r C&C:\n\n`o` HTTP \r POST: \r /upload8[RndNum]?h1=[VictimId]\n\n    - Command \r execution \r response \r to \r C&C:\n\n`o` HTTP \r POST: \r /search2[RndNum]?h1=[VictimId]\n\nThere \r are \r over \r a \r dozen \r other \r commands \r identified \r in \r the \r Trojan \r listed \r in \r the \r CyberESI \r report.\n\n## September \r 23, \r 2010 \r ISSNIP \r Phishing \r Email \r with \r Malicious \r Attachment \r \nA \r few \r days \r later \r following \r the \r previously \r detailed \r incident, \r another \r incident \r with \r information \r publicly \r available \r was\nreported \r in \r which \r a \r phishing \r email \r was \r sent \r from \r a \r Yahoo \r account \r to \r a \r defense \r contractor \r with \r content \r about \r a\nconference \r and \r malicious \r attachment, \r “ISSNIP_2010.pdf” \r (MD5 \r hash: \r 3D966CD90D320EA4A319452D1CCB11AA):\n\n**Figure \r 7 \r Phish \r Email \r (9/23/2010)**\n\nFrom \r the \r analysis, \r the \r malicious \r attachment \r appeared \r to \r have \r the \r same \r functionality \r as \r listed \r in \r the\nprevious \r incident \r – \r to \r include \r the \r unique \r dropped \r files \r “msupdater.exe” \r and \r “FAVORITES.DAT”.\n\n19 http://www.bloomberg.com/news/2011-­‐02-­‐24/exxon-­‐shell-­‐bp-­‐said-­‐to-­‐have-­‐been-­‐hacked-­‐through-­‐chinese-­‐internet-­‐servers.html\n\n\n8\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\n## Related \r Antivirus \r Vendor \r “Family” \r Names \r \nIn \r the \r previously \r identified \r samples \r we \r have \r pointed \r out \r that \r certain \r A/V \r malware \r family \r names \r are\nused \r to \r identify \r and \r classify \r the \r fore-­‐mentioned \r threat. \r  \r For \r example,\n\n    - DrWeb \r uses \r “Backdoor.Calla”\n\n    - Microsoft \r and \r a \r few \r other \r vendors \r use \r “Backdoor.Matchaldru”\n\n    - Sophos \r uses \r “Mal/ \r Ovoxual”\n\nUsing \r these \r identifiers, \r a \r number \r of \r related \r samples \r can \r be \r found \r in \r the \r open-­‐source. \r  \r The \r following\nprovides \r a \r brief \r list \r of \r additional \r samples \r believed \r to \r be \r related \r to \r this \r threat \r group:\n\n    - MD5: \r 92DBDB7E240E7D7C42B4793380782735[20]\n\n`o` “msupdate.exe” \r packed \r with \r Armadillo\n`o` First/Last \r submitted \r to \r VirusTotal: \r 2011-­‐11-­‐04\n`o` Sophos \r identifies \r as \r “Mal/Ovoxual-­‐B”\n`o` McAfee \r identifies \r as \r “Muster.d”\n\n    - MD5: \r 3A0FC856F343B730EE58C00BAB09F9E5[21]\n\n`o` “Backdoor.Calla.16”, \r “Mal/Ovoxual-­‐A”, \r packed \r with \r Armadillo\n`o` First \r seen \r 2010-­‐10-­‐08, \r Last \r seen: \r 2011-­‐03-­‐24\n`o` Drops[22]:\n\n         - MD5: \r 7C3C964D7F164F2CC277B41541732546[23]\n`o` “msupdater.exe”, \r “Mal/Ovoxual-­‐B”\n`o` First/Last \r seen: \r 2010-­‐09-­‐27\n\n         - MD5: \r B7424AA1C92107E03DBA8915CEB1FE4D\n`o` “FAVORITES.DAT” \r (encrypted)\n\n    - MD5: \r 21816D6934F608E0E3F76AA43831D959[24]\n\n`o` “Backdoor.Calla.16”, \r “Mal/Ovoxual-­‐A”, \r 2010-­‐10-­‐06\n\n    - MD5: \r 53547213038C093EB427974FA0FB4F65[25]\n\n`o` “Mal/Ovoxual-­‐A”, \r 2010-­‐09-­‐23 \r – \r 2011-­‐06-­‐14\n\n    - MD5: \r 0A229293FD0639C722FD7ABD1D1A9C93[26]\n\n`o` “Matchaldru.B”, \r “Mal/Ovoxual-­‐A”, \r 2011-­‐11-­‐01 \r – \r 2011-­‐11-­‐30\n\nFrom \r the \r above \r VirusTotal \r results, \r it \r appears \r that \r McAfee \r detects \r some \r of \r these \r as \r the \r “Muster” \r threat\ngroup. \r  \r Using \r other \r A/V \r vendor \r names \r and \r searching \r and \r correlating \r samples \r in \r the \r same \r way \r that \r we\ndid \r above \r reveals \r additional \r likely \r related \r samples. \r  \r The \r following \r provides \r a \r brief \r abbreviated \r list \r of\nsamples \r listed \r in \r the \r open-­‐source \r for \r the \r purposes \r of \r showing \r the \r breadth \r of \r the \r threat \r operation\ntimeframe \r and \r some \r PDF \r names \r that \r shed \r some \r light \r on \r the \r types \r of \r phishing \r messages \r used.\n\n20 https://www.virustotal.com/file/08039422c11ee405af02558704f19c8c53e82749493386a226243ac0f85de20c/analysis/1320449843/\n21 https://www.virustotal.com/file/da3e95eb33c33908ab35b269802ba35fe015e0ad3f0ec7481bcca8b5b96477ca/analysis/\n22 http://www.threatexpert.com/report.aspx?md5=3a0fc856f343b730ee58c00bab09f9e5\n23 https://www.virustotal.com/file/fe0e58b5cad9b1dde19ad87f2470c14879d148c0d271d54e00bb94449a8980fd/analysis/\n24 https://www.virustotal.com/file/d076b318db751cd43e303d26dcaad2d0eab2779185a5facb9aee3754219a322f/analysis/\n25 https://www.virustotal.com/file/5f14bf0b5838f85edcb1bc32a198ec09cf4d73980e73a0783d649e00c91d6771/analysis/\n26 https://www.virustotal.com/file/735fd8ce66e6f0e412f18242d37c12fb38f26f471051eac2f0fe2df89d0e4966/analysis/\n\n\n9\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\n    - MD5: \r FD5DFFEBD39E9ACA4F79107B6889699D \r (09/24/2010)\n\n    - MD5: \r 95AFBECB0BDDE89254DBE07A42685B24 \r (10/11/2010)\n\n    - MD5: \r 6FF3C8495873AEC4390250EC1ECAA0B1 \r (04/08/2009)\n\n    - MD5: \r 2EFBF514FBF58E78C259CC87A668BC35 \r (06/16/2009), \r drops:\n\n`o` MD5: \r AEDCE18F64EB988F342663EC2C01D017 \r (COMSWARE_2009.1.pdf)\n`o` MD5: \r BDDD2042F5024D2AFC6AA50920E27897 \r (IEUpd.exe)\n`o` MD5: \r EA12A0DBA22B8B2D2D5662437BED8169 \r (IEXPLORE.hlp)\n`o` MD5: \r 7F37F7CD9B0C1CE6574FF5C385FCF26F \r (WMupdate.exe)\n\n    - MD5: \r 9687E53495898232949DBCD15556B619 \r (06/16/2009), \r drops:\n\n`o` MD5: \r 2F71666B76EC0E51A40EF5DF3170604A\n\n(2009_IEEE_Aerospace_Conference_1.pdf)\n`o` MD5: \r 5622E46F27B8BD7665218E26B024E74D \r (IEUpd.exe)\n`o` MD5: \r D69BB7935DB5FC15542B98845CF83B89 \r (IEXPLORE.hlp)\n`o` MD5: \r A2B6C71A153E61EAA1FEA0F2A3A0232B \r (WMupdate.exe)\n\n    - MD5: \r 6AD5D9C546AC603E18FC109025E2F5B7 \r (03/19/2010), \r drops:\n\n`o` MD5: \r 9C738176C74B7392DD22009736AFC49F \r (Who \r will \r be \r fired.pdf)\n`o` MD5: \r 1ABC034E85704A0699D598B16C16A37E \r (WMupdate.exe)\n\n    - MD5: \r 7B470C530794342632F5025C1B948BB0 \r (04/08/2009)\n\n    - MD5: \r 1006e295156b354d9ec4b6d5b6b0ba65 \r (04/13/2009) \r drops:\n\n`o` MD5: \r 2F71666B76EC0E51A40EF5DF3170604A\n\n(2009_IEEE_Aerospace_Conference_1.pdf)\n`o` MD5: \r 9AA8DD1A765C44B82654581977C7F2FA \r (WMupdate.exe)\n\n    - MD5: \r D78CBD630A1937233B3E4217B19FF5CA \r (4/13/2009) \r drops:\n\n`o` MD5: \r BECDA5D5A1C3199A99018A57E43BA2C7\n\n(Bomber_kills_33_at_Iraq_peace_conference.pdf)\n`o` MD5: \r 7B470C530794342632F5025C1B948BB0 \r (WMupdate.exe)\n\n    - MD5: \r 08EB27A6D8F0260D6853BC5A3F5CAA73 \r (09/15/2009)\n\n## “Conference” \r Lure \r \nAs \r noted \r in \r the \r section \r on \r the \r September \r 23, \r 2010 \r malicious \r phishing \r incident, \r the \r name \r of \r the\nparticular \r malicious \r attachment \r was \r “ISSNIP_2010.pdf” \r (see \r screenshot \r below) \r related \r to \r the\nInternational \r Conference \r on \r Intelligent \r Sensors, \r Sensor \r Networks \r and \r Information \r Processing \r (ISSNIP)[27].\nThe \r use \r of \r conference \r related \r subjects \r seems \r to \r be \r the \r popular \r lure \r in \r this \r actor’s \r phishing \r messages \r as\nnoted \r in \r the \r above \r section \r of \r related \r malware. \r  \r For \r example;\n\n    - IEEE \r Aerospace \r Conference\n\n    - Iraq \r Peace \r Conference\n\n    - International \r Conference \r on \r Communication \r System \r Software \r and \r Middleware\n(COMSWARE)\n\n27 http://www.issnip.org\n\n\n10\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\n**Figure \r 8 \r ISSNIP \r 2010 \r PDF \r Screenshot**\n\n## Closing \r Remarks \r \nZscaler \r and \r Seculert \r experienced \r separate \r security \r incidents \r against \r various \r customers \r dealing \r with \r a\nthreat \r appearing \r to \r be \r related \r to \r specific \r targeted \r attacks. \r  \r This \r report \r provided \r some \r insight \r into \r the\nthreat \r and \r draws \r in \r information \r available \r in \r the \r open-­‐source. \r In \r particular, \r beaconing \r patterns \r and\nindicators \r were \r identified \r to \r facilitate \r detection \r of \r the \r threat. \r  \r Additionally, \r related \r malware \r samples\n(see \r Appendix \r A) \r and \r malware \r family \r names, \r such \r as \r “Ovoxual”, \r have \r been \r listed \r for \r further\nidentification \r of \r related \r samples.\n\nBased \r on \r the \r information \r available, \r the \r threat \r arrives \r in \r phishing \r emails \r with \r a \r PDF \r attachment, \r possibly\nrelated \r to \r conferences \r for \r the \r particular \r targeted \r industry. \r  \r The \r PDF \r exploits \r vulnerabilities \r within\nAdobe \r (for \r example, \r a \r 0-­‐day \r exploit \r was \r used \r against \r CVE-­‐2010-­‐2883) \r and \r drops \r a \r series \r of \r files \r to \r begin\ncommunicating \r with \r the \r command \r and \r control \r (C&C). \r  \r The \r binary \r dropped \r and \r launched \r from \r the \r PDF\nexploit \r is \r virtual \r machine \r (VM) \r aware \r in \r order \r to \r prevent \r analysis \r within \r a \r sandbox. \r  \r If \r a \r VM \r is \r not\ndetected, \r it \r will \r drop \r an \r executable \r (often \r named \r “msupate.exe”), \r which \r is \r also \r VM \r aware, \r and \r an\nencrypted \r file \r (often \r named \r “FAVORITES.DAT”). \r  \r Again, \r if \r no \r VM \r is \r detected \r this \r executable \r will \r decrypt\nand \r run \r the \r contents \r in \r memory \r as \r a \r process \r (often \r the \r svchost.exe \r process).\n\nOnce \r the \r infected \r system \r communicates \r with \r the \r C&C, \r two \r versions \r of \r the \r beaconing \r pattern \r have\nbeen \r observed. \r  \r The \r most \r well \r documented \r version \r of \r the \r C&C \r beaconing \r adhere \r to \r the \r general\nformats:\n\n    - /search[RndNum]?h1=[Num1]&h2=[Num2]&h3=[String1]&h4=[String2]\n\n    - /search[RndNum]?h1=[String1]\n\n    - /upload[RndNum]?h1=[String1]\n\n    - /download[RndNum]?h1=[String1]\n\n\n11\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\nA \r lesser-­‐known \r beaconing \r pattern \r that \r both \r Zscaler \r and \r Seculert \r have \r observed \r related \r to \r this \r threat\nadhere \r to \r the \r general \r formats:\n\n    - /microsoftupdate/getupdate/default.aspx?ID=[num1]para1=[num2]para2=[num3]para3=[n\num4]\n\n    - /microsoft/errorpost/default/connect.aspx?ID=[num1]\n\n    - /microsoft/errorpost/default.aspx?ID=[num1]\n\nPrior \r to \r beaconing \r with \r these \r patterns \r the \r malware \r may \r issue \r an \r initial \r malformed \r Google \r query:\n\n    - GET \r path: \r “/search?qu=”\n\n    - GET \r data: \r “news”\n\nUse \r these \r indicators \r to \r help \r provide \r detection \r and \r remediation \r of \r this \r threat \r within \r your \r enterprise.\nThis \r was \r the \r overall \r goal \r of \r releasing \r this \r information. \r Note \r however, \r that \r the \r overall \r targeted \r threat\nwill \r likely \r adapt \r and \r remain \r a \r constant \r adversary \r – \r that \r is, \r if \r your \r particular \r organization \r is \r the \r target \r of\nan \r attack \r it \r is \r likely \r that \r it \r will \r continue \r to \r be \r targeted. \r  \r Use \r this \r knowledge \r to \r adapt \r your \r organization’s\nsecurity \r policies \r and \r resources \r appropriately.\n\n\n12\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----\n\n## Appendix \r A: \r Consolidated \r List \r of \r Malicious \r MD5 \r Hashes \r \nThe \r following \r list \r is \r a \r consolidation \r of \r all \r malicious \r MD5 \r hashes \r listed \r in \r this \r report.\n\n\n3459BC37967480DEE405A5AC678B942D\n\n6631815D4AB2A586021C24E02E5CC451\n\n3D966CD90D320EA4A319452D1CCB11AA\n\n4EF704239FA63D1C1DFCF2EA2DA0D711\n\n95D42D365489A6E5EBDF62565C5C8AA2\n\n374075CE8B6E8F0CD1F90009FD5A703B\n\n5E3EACA3806769836C3AD9D46A209644\n\n92DBDB7E240E7D7C42B4793380782735\n\n3A0FC856F343B730EE58C00BAB09F9E5\n\n7C3C964D7F164F2CC277B41541732546\n\nB7424AA1C92107E03DBA8915CEB1FE4D\n\n21816D6934F608E0E3F76AA43831D959\n\n53547213038C093EB427974FA0FB4F65\n\n0A229293FD0639C722FD7ABD1D1A9C93\n\nFD5DFFEBD39E9ACA4F79107B6889699D\n\n95AFBECB0BDDE89254DBE07A42685B24\n\n6FF3C8495873AEC4390250EC1ECAA0B1\n\n2EFBF514FBF58E78C259CC87A668BC35\n\nAEDCE18F64EB988F342663EC2C01D017\n\n\nBDDD2042F5024D2AFC6AA50920E27897\n\nEA12A0DBA22B8B2D2D5662437BED8169\n\n7F37F7CD9B0C1CE6574FF5C385FCF26F\n\n9687E53495898232949DBCD15556B619\n\n2F71666B76EC0E51A40EF5DF3170604A\n\n5622E46F27B8BD7665218E26B024E74D\n\nD69BB7935DB5FC15542B98845CF83B89\n\nA2B6C71A153E61EAA1FEA0F2A3A0232B\n\n6AD5D9C546AC603E18FC109025E2F5B7\n\n9C738176C74B7392DD22009736AFC49F\n\n1ABC034E85704A0699D598B16C16A37E\n\n7B470C530794342632F5025C1B948BB0\n\n1006e295156b354d9ec4b6d5b6b0ba65\n\n2F71666B76EC0E51A40EF5DF3170604A\n\n9AA8DD1A765C44B82654581977C7F2FA\n\nD78CBD630A1937233B3E4217B19FF5CA\n\nBECDA5D5A1C3199A99018A57E43BA2C7\n\n7B470C530794342632F5025C1B948BB0\n\n08EB27A6D8F0260D6853BC5A3F5CAA73\n\n\n13\n© \r 2012 \r Zscaler \r Inc. \r and \r Seculert \r Ltd. \r All \r Rights \r Reserved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/gh8m5os2jewj2adleu2xqivj9qzf9ok8",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2010/2010.09.03.MSUpdater.Trojan/MSUpdaterTrojanWhitepaper.pdf"
    ],
    "report_names": [
        "MSUpdaterTrojanWhitepaper"
    ],
    "threat_actors": [
        {
            "id": "abd17060-62f6-4743-95e8-3f23c82cc229",
            "created_at": "2022-10-25T15:50:23.428772Z",
            "updated_at": "2025-03-27T02:00:55.466186Z",
            "deleted_at": null,
            "main_name": "Putter Panda",
            "aliases": [
                "Putter Panda",
                "APT2",
                "MSUpdater"
            ],
            "source_name": "MITRE:Putter Panda",
            "tools": [
                "pngdowner",
                "3PARA RAT",
                "4H RAT",
                "httpclient"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "468b7acd-895c-4c93-b572-b42f4035b4d4",
            "created_at": "2023-01-06T13:46:38.265636Z",
            "updated_at": "2025-03-27T02:00:02.788514Z",
            "deleted_at": null,
            "main_name": "APT2",
            "aliases": [
                "G0024",
                "PLA Unit 61486",
                "PUTTER PANDA",
                "MSUpdater",
                "4HCrew",
                "SearchFire",
                "TG-6952"
            ],
            "source_name": "MISPGALAXY:APT2",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041486,
    "ts_creation_date": 1328042675,
    "ts_modification_date": 1328042675,
    "files": {
        "pdf": "https://archive.orkl.eu/c7d0387067ba747e3a3d9b43b7349d7888bf574e.pdf",
        "text": "https://archive.orkl.eu/c7d0387067ba747e3a3d9b43b7349d7888bf574e.txt",
        "img": "https://archive.orkl.eu/c7d0387067ba747e3a3d9b43b7349d7888bf574e.jpg"
    }
}