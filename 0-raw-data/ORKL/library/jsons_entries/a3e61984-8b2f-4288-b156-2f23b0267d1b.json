{
    "id": "a3e61984-8b2f-4288-b156-2f23b0267d1b",
    "created_at": "2022-10-25T16:48:25.041147Z",
    "updated_at": "2025-03-27T02:05:40.521908Z",
    "deleted_at": null,
    "sha1_hash": "1c6623db3c2b89f3d02c27dbfe556fa16d2787a2",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-06-16T07:55:10Z",
    "file_modification_date": "2020-06-16T07:55:10Z",
    "file_size": 3079841,
    "plain_text": "# GuLoader? No, CloudEyE.\n\n**research.checkpoint.com/2020/guloader-cloudeye**\n\nJune 8, 2020\n\n\nJune 8, 2020\n\n\n#### Italian company exposed on Clearnet earned up to $ 500,000 helping cybercriminals to deliver malware using cloud drives.\n\n[Recently, we wrote about the network dropper known as GuLoader, which has been very](https://research.checkpoint.com/2020/threat-actors-migrating-to-the-cloud/)\nactively distributed in 2020 and is used to deliver malware with the help of cloud services\nsuch as Google Drive. The delivery of malware through cloud drives is one of the fastest\ngrowing trends of 2020.\n\nWe see hundreds of attacks involving GuLoader every day; up to 25% of all packed\nsamples are GuLoaders. The dropper delivers a huge number of malware types, including\ndifferent malicious campaigns apparently related to many different threat actors.\n\n\n-----\n\n**Figure 1 – Percentage of GuLoader samples and malware distributed by GuLoader.**\n\nThe dropper is constantly updated: we see new versions with sandbox evasion techniques,\ncode randomization features, C&C URL encryption, and additional payload encryption.\nAs a result, we can reasonably assume that behind GuLoader there is a major new service\naiming to replace traditional packers and crypters.\n\nWe did indeed manage to find this service, which is created and maintained by an Italian\ncompany that pretends to be completely legitimate and aboveboard, and even has a\nwebsite in Clearnet that uses the .eu domain zone. But first things first.\n\n## DarkEyE\n\nWhile monitoring GuLoader, we repeatedly encountered samples that were detected as\nGuLoader, but they did not contain URLs for downloading the payload. During manual\nanalysis of such samples, we found that the payload is embedded in the sample itself.\nThose samples appear to be related to DarkEyE Protector:\n\n**Figure 2 – DarkEyE sample.**\n\nThe DarkEyE samples have a lot in common with the GuLoader samples. They both are\nwritten in VisualBasic, contain a shellcode encrypted with 4-bytes XOR key, and have the\nsame payload decryption procedure:\n\n**Figure 3 – Comparison of GuLoader and DarkEyE samples.**\n\nWe searched for “DarkEyE Protector” on the web and easily found a very old thread from\n2014 in which it was advertised by a user known as “xor”:\n\n\n-----\n\n**Figure 4 – DarkEyE advertisement on a hacker forum.**\n\nWe also found some earlier ads for DarkEyE on the same website, these posted by the\nuser “sonykuccio.” The ads describe DarkEyE as a crypter that can be used with\ndifferent malware such as stealers, keyloggers, and RATs (remote access Trojans), and\nmakes them fully undetectable for antiviruses (FUD). This left us with no doubt that this\nsoftware was developed to protect malware from discovery by anti-viruses, as the authors\ndidn’t forget to emphasize that they “don’t take any responsibility for the use” of\nDarkEyE:\n\n**Figure 5 – DarkEyE advertisement on a hacker forum.**\n\nThe user “sonykuccio” also posted contact emails for anyone interested in buying\nDarkEyE (remember this for later):\n\n\n-----\n\n**Figure 6 – Contact emails mentioned in DarkEyE ads.**\n\nFinally, we found the website securitycode.eu, whose URL is mentioned in one of the\nads above.\n\n## DarkEyE evolved into CloudEyE\n\nIndeed, the website securitycode.eu is connected to DarkEyE. However, currently this\nwebsite focuses on another product – CloudEyE:\n\n**Figure 7 – securiticode.eu website.**\n\nThe company selling CloudEyE pretends to be legitimate. As said on their website,\nCloudEyE is security software intended for “Protecting windows applications from\n_cracking, tampering, debugging, disassembling, dumping.”_\n\nBut let’s look at the rest of the securitycode.eu website. It contains several YouTube video\ntutorials on how to use CloudEyE, and, as it turned out, how to abuse Google Drive and\nOneDrive:\n\n[“Protecting an application using google drive.” (https://youtu.be/TOdfOBmeAx8)](https://youtu.be/TOdfOBmeAx8)\n“Protecting using an already exsisting project, with a saved profile.”\n[(https://youtu.be/8siii5x0Q3k)](https://youtu.be/8siii5x0Q3k)\n“Protecting file using VPS/Cloud or any dedicated server.”\n[(https://youtu.be/4JLEXGevpfg)](https://youtu.be/4JLEXGevpfg)\n[“Protecting file using backup domains.” (https://youtu.be/4JJWL4-OCDM)](https://youtu.be/4JJWL4-OCDM)\n[“CloudEyE avoiding debugging of application.” (https://youtu.be/v1CS_Q7LZpg)](https://youtu.be/v1CS_Q7LZpg)\n\n\n-----\n\n[“Protecting ’putty’ application using OneDrive.” (https://youtu.be/Y2ZNLVC6yfk)](https://youtu.be/Y2ZNLVC6yfk)\n[“CloudEyE memory protection in action!” (https://youtu.be/76IVgS88WTg)](https://youtu.be/76IVgS88WTg)\n\n**Figure 8 – YouTube videos published on the securitycode.eu website.**\n\nWatching one of the videos on this website (https://youtu.be/TOdfOBmeAx8?t=74), we\nnoticed the same URL patterns as we have seen earlier in GuLoader:\n\n\n-----\n\n**Figure 9 – The same URL pattern in the CloudEyE YouTube video and GuLoader**\nsamples.\n\nThis is a placeholder for a URL that is used in some of GuLoader samples for\ndownloading joined files (decoy images in our previous research). Way too much\ncoincidence for us to find it here!\n\nWe decided to obtain CloudEyE to see for ourselves if it is related to GuLoader.\n\n## CloudEyE\n\nTo test CloueEyE Protector, we decided to encrypt the calc.exe application:\n\n**Figure 10 – CloudEyE builder: choosing a file to protect.**\n\nThe XOR encryption key (password) is generated automatically and can’t be entered\nmanually.\n\nAfter clicking “Next”, we got the encrypted file. Then we placed it on a local HTTP server\nand put the URL in the next window:\n\n\n-----\n\n**Figure 11 – CloudEyE builder: choosing a URL where the protected file will be**\ndownloaded from.\n\nAfter clicking “Next”, we see the window with the known URL template\n```\nhttp://myurl/myfile.bin :\n\n```\n\n-----\n\n**Figure 12 – CloudEyE builder: protection options.**\n\nWe assumed that most customers don’t use additional options, so we decided to leave\neverything else as the default value.\n\nCloudEyE also allows you to set up autorun, select an icon, change the file size and choose\nthe extension:\n\n**Figure 13 – CloudEyE builder: additional options.**\n\nFinally, we got the build.\n\nAt the next step, we submitted the build to our sandbox and, unsurprisingly, we got the\nexpected verdict:\n\n\n-----\n\n**Figure 14 – Emulation results of the CloudEyE-produced sample.**\n\nHowever, to be completely sure that CloudEyE produces samples that are universally\nacknowledged as GuLoader malware, we decided to analyze it manually and compare\nwith a real GuLoader sample that we saw in the wild.\n\nGuLoader was slightly upgraded a few weeks ago. Therefore, we chose one of the recent\nsamples which downloads the Formbook malware:\n\n\n-----\n\n**GuLoader MD5:** **3d1fd9bcef7cbe915bb49857461ad781**\n\n**Payload URL:** hxxps://drive.google.com/uc?\nexport=download&id=1cs40Db_dgZugASem90KebWJ2mVl6LmjR\n\n\n**Encrypted Pay-**\n**load MD5:**\n\n\n95f29abac9c887639efc2d4e22b5350f\n\n\n**Decrypted Pay-**\n**load MD5:**\n\n\n3b72bf861b5d2907bb2d76d3d4d9d816\n\n\n**Figure 15 – Researched GuLoader sample details.**\n\nThe CloudEyE-produced sample that we got has the same structure as GuLoader. Just\nlike GuLoader, it is compiled with Visual Basic and contains shellcode encrypted with a\nrandom 4-bytes XOR key. Therefore, we decrypted the shellcode from both samples\n(CloudEyE and GuLoader).\n\nTo make it harder for automatic analysis and probably also to prevent automatic\ndecryption, the shellcode starts from a random stub and is prepended with a jump over\nthis stub. In both samples, the same space on the stack is reserved for a structure with\nglobal variables.\n\n**Figure 16 – Comparison of CloudEyE and GuLoader samples: shellcode randomization.**\n\n\n-----\n\nVariables in the structure have the same offset. Most of the code chunks differ only due to\nthe applied randomization techniques. The useful code is the same in both samples.\n\n**Figure 17 – Comparison of CloudEyE and GuLoader samples: URL decryption.**\n\nThe URLs for downloading the payload and the “joined file” (i.e. the decoy image) in the\nnew version of GuLoader are stored encrypted. GuLoader decrypts the URLs using the\nsame key as used for decrypting the payload. After extracting the XOR keys, we can easily\nfind and decrypt URLs in both samples.\n\n**Figure 18 – Comparison of CloudEyE and GuLoader encrypted URLs.**\n\nWe can therefore conclude that the samples are almost identical and differ only generally\ndue to applied code randomization techniques.\n\n\n-----\n\n### Identities behind CloudEyE\n\nLet’s refer to the contact emails posted by the user “sonykuccio” in the DarkEyE ads:\n\nxsebyx@hotmail.it (Sebyno)\nthedoktor2007@hotmail.it (EveryThing)\n\nWe looked for the emails and usernames in publically available leaked email databases\nand managed to find several entries related to “sonykuccio”:\n\n**Figure 19 – Emails and usernames found in publically available databases.**\n\nAlso, we surprisingly found a PDF containing a lot of real names and emails of Italian\ncitizens, including the email “xsebyx@hotmail.it” and the corresponding name\n“Sebastiano Dragna”:\n\n**Figure 20 – A PDF with emails of Italian citizens.**\n\nLet’s now refer to the Privacy Policy section on the website securitycode.eu. We see the\nsame name! The owners of this business must sincerely believe in their own innocence if\nthey dare to publish real names on the website:\n\n\n-----\n\n**Figure 21 – securitycode.eu privacy policy.**\n\nTherefore, “sonykyccio”, “xsebyx”, “Sebyno”, “decrypter@hotmail.it”,\n“xsebyx@hotmail.it”, “sonykuccio@gmail.com” are avatars and emails of the same\nperson: Dragna Sebastiano Fabio.\n\nUnfortunately, we didn’t manage to find any relation between another name published on\nthe website (Ivano Mancini) and names used on popular hacker forums.\n\n**Figure 22 – Identities behind CloudEyE.**\n\nSonykuccio is an old and established visitor to hacker forums. We saw that he started\nselling DarkEyE in the beginning of 2011. But even before creating DarkEyE protector,\nSonykuccio was already providing services for protecting malware against anti-viruses\n\n\n-----\n\n(FUD service) and a spreading service for malware:\n\n**Figure 23 – Malicious services advertised by sonykuccio.**\n\n## CloudEyE and Covid-19\n\nAs we said, we see hundreds of attacks every day in different campaigns. Some of the\nCloudEyE users have been cynically using the name “Coronavirus” as a way to deceive\nand mislead victims, using the fear and desire for information about the pandemic to\ninfect people with malware.\n\n**Figure 24 – CloudEyE and Coronavirus email subjects.**\n\n## Revenue\n\nThe securitycode.eu website claims that their customer base numbers over 5,000. As they\nsell their basic package for $ 100 per month, this allows us to estimate their monthly\nincome at $ 500,000.\n\n\n-----\n\n**Figure 25 – CloudEyE pricing.**\n\n## Conclusion\n\nCloudEyE operations may look legal, but the service provided by CloudEyE has been a\ncommon denominator in thousands of attacks over the past year. Tutorials published on\nthe CloudEyE website show how to store payloads on cloud drives such as Google Drive\nand OneDrive. Cloud drives usually perform anti-virus checking and technically don’t\nallow the upload of malware. However, payload encryption implemented in CloudEyE\nhelps to bypass this limitation. Code randomization, evasion techniques, and payload\nencryption used in CloudEyE protect malware from being detected by many of the\nexisting security products on the market. Surprisingly, such a service is provided by a\nlegally registered Italian company that operates a publically available website which has\nexisted for more than four years.\n\nMany of CloudEyE customers are threat actors with no deep technical knowledge, they\nare using publically available malware or leaked hacking tools for stealing passwords,\ncredentials, private information, and gaining control of the victim’s environment.\n\n## Appendix: Hashes of samples\n\n\n-----\n\n**Description** **MD5**\n\n**Researched GuLoader sample** 3d1fd9bcef7cbe915bb49857461ad781\n\n\n**Encrypted GuLoader payload**\n**(Formbook)**\n\n\n95f29abac9c887639efc2d4e22b5350f\n\n\n**Formbook sample dropped by**\n**GuLoader**\n\n\n3b72bf861b5d2907bb2d76d3d4d9d816\n\n\n**GuLoader Shellcode** 0284062f9a7415e413ed319c13dc0988\n\n**CloudEyE Shellcode** 5c4ed372836487562aa22ab9cd2798d9\n\n_Check Point Threat Emulation provides protection against this threat:_\n\n_Dropper.Win.CloudEyE.A_\n_Dropper.Wins.CloudEyE.B_\n_Dropper.Win.CloudEyE.I_\n_Dropper.Win.CloudEyE.gl.J_\n_Dropper.Win.CloudEyE.gl.L_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.06.08.GuLoader_CloudEyE/GuLoader_%20No%2C%20CloudEyE.%20-%20Check%20Point%20Research.pdf"
    ],
    "report_names": [
        "GuLoader_ No, CloudEyE. - Check Point Research"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716505,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1592294110,
    "ts_modification_date": 1592294110,
    "files": {
        "pdf": "https://archive.orkl.eu/1c6623db3c2b89f3d02c27dbfe556fa16d2787a2.pdf",
        "text": "https://archive.orkl.eu/1c6623db3c2b89f3d02c27dbfe556fa16d2787a2.txt",
        "img": "https://archive.orkl.eu/1c6623db3c2b89f3d02c27dbfe556fa16d2787a2.jpg"
    }
}