{
    "id": "4e413c5a-e3b1-4f90-8431-c7a839f7ab50",
    "created_at": "2023-01-12T15:04:18.714032Z",
    "updated_at": "2025-03-27T02:09:29.127359Z",
    "deleted_at": null,
    "sha1_hash": "d3579fed324b95039622f28ffb2395e0e3457e81",
    "title": "2022-05-22 - PDF smuggles Microsoft Word doc to drop Snake Keylogger malware",
    "authors": "",
    "file_creation_date": "2022-05-28T23:47:20Z",
    "file_modification_date": "2022-05-28T23:47:20Z",
    "file_size": 3012775,
    "plain_text": "# PDF smuggles Microsoft Word doc to drop Snake Keylogger malware\n\n**[bleepingcomputer.com/news/security/pdf-smuggles-microsoft-word-doc-to-drop-snake-keylogger-malware/](https://www.bleepingcomputer.com/news/security/pdf-smuggles-microsoft-word-doc-to-drop-snake-keylogger-malware/)**\n\nBill Toulas\n\nBy\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nMay 22, 2022\n12:15 PM\n0\n\nThreat analysts have discovered a recent malware distribution campaign using PDF\nattachments to smuggle malicious Word documents that infect users with malware.\n\nThe choice of PDFs is unusual, as most malicious emails today arrive with DOCX or XLS\nattachments laced with malware-loading macro code.\n\nHowever, as people become more educated about opening malicious Microsoft Office\nattachments, threat actors switch to other methods to deploy malicious macros and evade\ndetection.\n\n[In a new report by HP Wolf Security, researchers illustrate how PDFs are being used as a](https://threatresearch.ext.hp.com/pdf-malware-is-not-yet-dead/#)\ntransport for documents with malicious macros that download and install information-stealing\nmalware on victim's machines.\n\n## Embedding Word in PDFs\n\n\n-----\n\nIn a campaign seen by HP Wolf Security, the PDF arriving via email is named \"Remittance\nInvoice,\" and our guess is that the email body contains vague promises of payment to the\nrecipient.\n\nWhen the PDF is opened, Adobe Reader prompts the user to open a DOCX file contained\ninside, which is already unusual and might confuse the victim.\n\nBecause the threat actors named the embedded document \"has been verified,\" the Open\nFile prompt below states, \"The file 'has been verified.\" This message could trick recipients\ninto believing that Adobe verified the file as legitimate and that the file is safe to open.\n\n**Dialog requesting**\n\n**action approval** _(HP)_\n\n\n-----\n\nWhile malware analysts can inspect embedded files in PDFs using parsers and scripts,\nregular users who receive these tricky emails wouldn’t go that far or even know where to\nstart.\n\nAs such, many may open the DOCX in Microsoft Word, and if macros are enabled, will\ndownload an RTF (rich text format) file from a remote resource and open it.\n\n**GET request to fetch the RTF file** _(HP)_\nThe download of the RTF is the result of the following command, embedded in the Word file\nalong with the hardcoded URL “vtaurl[.]com/IHytw”, which is where the payload is hosted.\n\n**URL that hosts the RTF file (HP)**\n\n\n-----\n\n## Exploiting old RCE\n\nThe RTF document is named “f_document_shp.doc” and contains malformed OLE objects,\nlikely to evade analysis. After some targeted reconstruction, HP’s analysts found that it\nattempts to abuse an old Microsoft Equation Editor vulnerability to run arbitrary code.\n\n**Decrypted**\n\n**shellcode presenting the payload** _(HP)_\nThe deployed shellcode exploits CVE-2017-11882, a remote code execution bug in Equation\nEditor [fixed in November 2017 but still available for exploitation in the wild.](https://www.bleepingcomputer.com/news/microsoft/microsoft-november-patch-tuesday-fixes-53-security-issues/)\n\n[That flaw immediately caught the attention of hackers when it was disclosed, while the slow](https://www.bleepingcomputer.com/news/security/a-hacking-group-is-already-exploiting-the-office-equation-editor-bug/)\n[patching that followed resulted in it becoming one of the most exploited vulnerabilities in](https://www.bleepingcomputer.com/news/security/80-percent-of-the-top-exploited-vulnerabilities-targeted-microsoft-in-2018/)\n2018.\n\nBy exploiting CVE-2017-11882, the shellcode in the RTF downloads and runs Snake\nKeylogger, a modular info-stealer with powerful persistence, defense evasion, credential\naccess, data harvesting, and data exfiltration capabilities.\n\n### Related Articles:\n\n[Historic Hotel Stay, Complementary Emotet Exposure included](https://www.bleepingcomputer.com/news/security/historic-hotel-stay-complementary-emotet-exposure-included/)\n\n[FluBot Android malware targets Finland in new SMS campaigns](https://www.bleepingcomputer.com/news/security/flubot-android-malware-targets-finland-in-new-sms-campaigns/)\n\n[German automakers targeted in year-long malware campaign](https://www.bleepingcomputer.com/news/security/german-automakers-targeted-in-year-long-malware-campaign/)\n\n\n-----\n\n[Ukraine warns of chemical attack phishing pushing stealer malware](https://www.bleepingcomputer.com/news/security/ukraine-warns-of-chemical-attack-phishing-pushing-stealer-malware/)\n\n[Phishing attacks target countries aiding Ukrainian refugees](https://www.bleepingcomputer.com/news/security/phishing-attacks-target-countries-aiding-ukrainian-refugees/)\n\n[Bill Toulas](https://www.bleepingcomputer.com/author/bill-toulas/)\n\nBill Toulas is a technology writer and infosec news reporter with over a decade of experience\nworking on various online publications. An open source advocate and Linux enthusiast, is\ncurrently finding pleasure in following hacks, malware campaigns, and data breach incidents,\nas well as by exploring the intricate ways through which tech is swiftly transforming our lives.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-22 - PDF smuggles Microsoft Word doc to drop Snake Keylogger malware.pdf"
    ],
    "report_names": [
        "2022-05-22 - PDF smuggles Microsoft Word doc to drop Snake Keylogger malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535858,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653781640,
    "ts_modification_date": 1653781640,
    "files": {
        "pdf": "https://archive.orkl.eu/d3579fed324b95039622f28ffb2395e0e3457e81.pdf",
        "text": "https://archive.orkl.eu/d3579fed324b95039622f28ffb2395e0e3457e81.txt",
        "img": "https://archive.orkl.eu/d3579fed324b95039622f28ffb2395e0e3457e81.jpg"
    }
}