{
    "id": "a8fab1d2-604e-446b-841f-0f0c1d73d591",
    "created_at": "2023-01-12T15:07:44.752747Z",
    "updated_at": "2025-03-27T02:05:54.895582Z",
    "deleted_at": null,
    "sha1_hash": "4a669f0502b746db643c0b619859841e98350976",
    "title": "2021-04-16 - Combating Sleeper Threats With MTTD",
    "authors": "",
    "file_creation_date": "2022-05-28T03:11:46Z",
    "file_modification_date": "2022-05-28T03:11:46Z",
    "file_size": 927215,
    "plain_text": "# Combating Sleeper Threats With MTTD\n\n**[securityintelligence.com/articles/sleeper-threats-mean-time-to-detect/](https://securityintelligence.com/articles/sleeper-threats-mean-time-to-detect/)**\n\n[Advanced Threats April 16, 2021](https://securityintelligence.com/category/x-force/threats/)\nBy [Koen Van Impe 6 min read](https://securityintelligence.com/author/koen-van-impe/)\nDuring the SolarWinds Orion supply chain compromise, threat actors lurked in the victim’s\nnetwork for more than a year. Discovered by [FireEye in December 2020, the earliest traces](https://www.fireeye.com/blog/threat-research/2020/12/evasive-attacker-leverages-solarwinds-supply-chain-compromises-with-sunburst-backdoor.html)\n[of a modified SolarWinds Orion go back as early as October 2019. Although these early](https://krebsonsecurity.com/2021/01/solarwinds-what-hit-us-could-hit-others/)\n\n\n-----\n\nversions did not contain the malicious backdoor (this was added in March 2020), it means\nattackers were able to remain hidden for a long time. This sleeper threat affected\ncorporations and government agencies around the world. To counter these, we need to be\naware of mean time to detect (MTTD) and mean time to response (MTTR) when detecting\nthis kind of attack.\n\nTo pull off such a long-lasting con, the attackers required a high level of refinement and\nplanning. That’s something you associate with an advanced persistent threat (APT). These\nAPTs, often launched by nation-states or state-sponsored actors, are stealthy and strive to\nremain hidden for a long time. (Contrast this with hacktivists, who often intend to make a\nvisible statement, like internet graffiti.) APTs choose their targets carefully and tread as lightly\nas possible until they reach their final goal.\n\nThese objectives are often political or economic. They go beyond the financial gain sought\nby those who deploy ransomware. And while single components of these attacks are maybe\nnot considered advanced, their operations and planning are top notch. When they do attack,\nthey avoid interrupting business since that would give away their presence. In a later stage,\nthey can still decide to push the destruct button, though. For example, they might want to\ncover up tracks, as revenge or a statement.\n\n## Sleeper Threats\n\nThe global median dwell time, or the number of days before an intrusion is detected and the\n[threat is neutralized, was 56 days in 2019. These 56 days already provide ample time for](https://content.fireeye.com/m-trends/rpt-m-trends-2020)\nattackers to do their work. What about the fact that 12% of the investigations had dwell times\ngreater than 700 days? This provides plenty of chances to access confidential data, exfiltrate\nsecrets and cause financial and legal harm.\n\nBefore jumping into specifics on how to reduce this dwell time, let’s look at the performance\nmetrics to describe the time to detection and response.\n\n## MTTD and MTTR\n\nMTTD is the average time it takes for your security team to discover an incident. This metric\ncan be found by adding up the total time it takes to detect incidents and dividing that by the\nnumber of incidents. The mean time to detect covers three phases. First, you collect event\ndata, then apply some logic to this data to discover strange behavior. As a final step, do an\nassessment to determine if the activity is indeed a threat.\n\nMeanwhile, MTTR measures the average time it takes to contain and repair a threat.\n(Sometimes this is also referred to as the mean time to recover.) The mean time to respond\nfollows when your assessment indicates there is a likelihood of a threat. Your team then\nlooks at the data to determine the exact nature and impact of the incident. Following this, you\ncan start repairs to neutralize the intrusion.\n\n\n-----\n\nThe MTTD and MTTR metrics can serve as a barometer for the strength of your defenses.\nShortening the MTTD and MTTR and stopping an attack not only limits the impact of a\nbreach and prevents loss of money and standing, it also prevents legal harm. For example,\nthe Network and Information Security (NIS) Directive and the General Data Protection\nRegulation (GDPR) require timely notifications of incidents.\n\nSo, how can you lower the dwell time and reduce MTTR and MTTD?\n\n## Reduce the MTTD\n\nOne of the essential elements for detecting attacks is not really that novel. It’s about having\nfine-grained insight into what’s happening in your landscape. You can do this by employing\ntargeted log management. Make sure the logs contain information that is actually helpful\nwhen spotting strange events. Then, centralize the collected logs, events and alerts. Use\nthem for correlation, such as in a SIEM. In addition, you can use network sensors that\ncapture network packets and flows, and use end-point alert and activity tracking.\n\nCollecting the data is only the first step in reducing the MTTD. The sheer volume of data is\nmost likely staggering. There are always too many alerts and not enough time to chase them\nall. To make things worse, defense teams have to work with different tools, confusing user\ninterfaces and different event formats and log types. Wading through all the data to do an\nassessment is impossible. How can we cut out these obstacles and assess if a certain event\nposes a real threat?\n\n[The answer lies in using automated incident response to reduce the dwell time, often](https://securityintelligence.com/reducing-dwell-time-with-automated-incident-response/)\nreferred to as SOAR. This automates routine investigative tasks and automatically launches\nresponses when an alert is detected, greatly reducing the MTTR. It completely removes the\ntime needed to inform analysts and wait for a human follow-up, which also greatly reduces\nMTTD and MTTR. A [SOAR system can interact with different tools and then provide a single](https://www.ibm.com/security/intelligent-orchestration)\noverview pane for your analysts. This type of integration cannot happen overnight, though.\nStart small, assess what works within your environment and extend your model with more\nsources.\n\n[Take a proactive approach to threats](https://www.ibm.com/security/digital-assets/proactive-approach-to-security-threats-with-soar/)\n\n## Define ‘Normal’\n\n[Automation requires you to do some prep work. First, you need to set a baseline and define](https://securityintelligence.com/know-your-data-and-your-enemies-establishing-a-baseline-for-proactive-threat-hunting/)\nwhat is normal. This alone can already be very challenging. But if you want to identify\npotential sleeper technology hiding in your environment, you need to know what’s likely and\nwhat’s unlikely in each case.\n\nStart from a base image installation and find the installed programs, running services\nand the typical system utilization.\n\n\n-----\n\nProfile not only the behavior of systems and apps but also the behavior of users. For\nexample business hours, device usage, volume of files accessed and internet usage.\nBaselining the network traffic helps to identify odd ports and protocols. It also highlights\nabnormal packet sizes, suspicious volumes of transferred data or lengthy connections.\nUnderstand which domain names your group commonly uses. Isolate domain names\nthat are used by only a couple of devices or users or only during specific timeframes.\n\n## Visualize All Things\n\nAnother good method is visualizing the event and alert data of your environment. Although\nvisualizing performance indicators have their merits, they are only a subset of what’s\nimportant to represent in dashboards. Other items to include are:\n\nEvent, log and alert timelines\nEvents matching with threat data\nVPN and network usage by protocol, sources, destinations, port usage, length of\nconnection and volume\nDomain name analysis\nSystem and service activity\nUser activities on multiple or different systems in a short timespan, including lateral\nmovement of users between systems\nNew devices, apps, services and processes\nChanges in roles, users, groups and group memberships\nLogon activity, failures, logouts and credential changes\nFile volume and user file activity\n\n## Security Monitoring With MTTD\n\nAlthough a large portion of the alerts can be handled via your automated responses, you still\nneed a team of specialists to monitor what’s happening. They can use the centrally collected\nalerts, events and visualizations to spot anomalies. This team, often in the form of a security\noperations center, plays a crucial role in looking after your environment, responding to alerts\nand reducing the MTTD. The playbooks help them to execute this response in a consistent\nand uniform way.\n\nAs in the case of the SolarWinds attacks, the threat actors aren’t ordinary ‘script kiddies’.\nSome of the threat groups have their foundation in traditional espionage and can be very\ndetermined to breach your environment. Stopping just one technique or putting a halt to a\nfirst intrusion doesn’t make these groups give up. They’ll just attempt another approach.\nAutomation, baselining, visualization and monitoring is not your only answer to reduce the\nMTTD and uncover the activity of these groups.\n\n## Improve Your MTTD Maturity\n\n\n-----\n\nAnother important element is to improve and work on the maturity of your team in an ongoing\nmanner. The [Security Incident Management Maturity Model is a good guide to improving](https://opencsirt.org/maturity/sim3/)\nyour incident detection and response capabilities. This framework focuses on organizational\naspects such as establishing a sufficient set of policies and having a governance framework.\nAn important aspect of this is to create robust incident response plans and document the\nroles and responsibilities in your incident response workflow. These incident response plans\nalso serve as the basis for your playbooks, which then steer the automated detection and\nmitigation.\n\nPeople are still the driving force behind a well-functioning detection and response program.\nEnsure that your incident response plans take into account the way departments work\ntogether and talk among themselves. Carefully sort the workflows between different teams to\nprevent snags.\n\n[Training and regular exercises help your team to stay alert and practice their skills. Your](https://www.ibm.com/security/services/managed-security-services/command-center-mobile)\nsecurity team must understand the incident response processes and have insights into\ncommon attacks, threat actor techniques, and best practices for how to defend against them.\nFocus on these key points in trainings:\n\nDetermine how reliable and accurate the information received from your detection\ncapabilities is. Train your team to understand the blurry areas and explore those that do\nnot always provide conclusive information.\nWhich weaknesses can you find where actors can bypass detection?\nTrain your team to be fluent in making records of their findings, and use this to improve\nplaybooks and plans.\nDocument other steps required to confirm or deny false positives.\n\n## What’s Next for MTTD?\n\nBecause attackers keep improving their game, you’ll have to make sure you keep up with\nthem. There is, however, a limit to what you can do with alert-based monitoring to reduce the\nMTTD. We already covered baselining and using it to detect anomalies in system and user\nactivities. But there’s more. You can also use machine analytics and implement scenarios\n[based on real life tools, techniques and procedures to improve your workflows and anomaly](https://attack.mitre.org/)\ndetections.\n\nIn the end, the key is to extend your detection capabilities with a well-functioning threat\nintelligence platform that can look out for sleeper threats in your sector.\n\n[Koen Van Impe](https://securityintelligence.com/author/koen-van-impe/)\nSecurity Analyst\n\nKoen Van Impe is a security analyst who worked at the Belgian national CSIRT and is now\nan independent security researcher. He has a twitter feed (@cudes...\n\n\n-----\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-16 - Combating Sleeper Threats With MTTD.pdf"
    ],
    "report_names": [
        "2021-04-16 - Combating Sleeper Threats With MTTD.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536064,
    "ts_updated_at": 1743041154,
    "ts_creation_date": 1653707506,
    "ts_modification_date": 1653707506,
    "files": {
        "pdf": "https://archive.orkl.eu/4a669f0502b746db643c0b619859841e98350976.pdf",
        "text": "https://archive.orkl.eu/4a669f0502b746db643c0b619859841e98350976.txt",
        "img": "https://archive.orkl.eu/4a669f0502b746db643c0b619859841e98350976.jpg"
    }
}