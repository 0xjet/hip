{
    "id": "3ce41f65-6886-45b9-b59c-e68f4d308061",
    "created_at": "2023-01-12T15:09:11.030409Z",
    "updated_at": "2025-03-27T02:06:12.265944Z",
    "deleted_at": null,
    "sha1_hash": "a88c99a7e75527ed24f0228ed2f81b0ecf3e41fd",
    "title": "2018-08-29 - BusyGasper – the unfriendly spy",
    "authors": "",
    "file_creation_date": "2022-05-28T00:41:55Z",
    "file_modification_date": "2022-05-28T00:41:55Z",
    "file_size": 669908,
    "plain_text": "# BusyGasper – the unfriendly spy\n\n**securelist.com/busygasper-the-unfriendly-spy/87627/**\n\nAuthors\n\nAlexey Firsh\n\nIn early 2018 our mobile intruder-detection technology was triggered by a suspicious Android sample\nthat, as it turned out, belonged to an unknown spyware family. Further investigation showed that the\nmalware, which we named BusyGasper, is not all that sophisticated, but demonstrates some unusual\nfeatures for this type of threat. From a technical point of view, the sample is a unique spy implant with\nstand-out features such as device sensors listeners, including motion detectors that have been\nimplemented with a degree of originality. It has an incredibly wide-ranging protocol – about 100\ncommands – and an ability to bypass the Doze battery saver. As a modern Android spyware it is also\ncapable of exfiltrating data from messaging applications (WhatsApp, Viber, Facebook). Moreover,\nBusyGasper boasts some keylogging tools – the malware processes every user tap, gathering its\ncoordinates and calculating characters by matching given values with hardcoded ones.\n\nThe sample has a multicomponent structure and can download a payload or updates from its C&C\nserver, which happens to be an FTP server belonging to the free Russian web hosting service Ucoz. It\nis noteworthy that BusyGasper supports the IRC protocol which is rarely seen among Android\nmalware. In addition, the malware can log in to the attacker’s email inbox, parse emails in a special\nfolder for commands and save any payloads to a device from email attachments.\n\nThis particular operation has been active since approximately May 2016 up to the present time.\n\n\n-----\n\n## Infection vector and victims\n\nWhile looking for the infection vector, we found no evidence of spear phishing or any of the other\ncommon vectors. But some clues, such as the existence of a hidden menu for operator control, point\nto a manual installation method – the attackers used physical access to a victim’s device to install the\nmalware. This would explain the number of victims – there are less than 10 of them and according to\nour detection statistics, they are all located in the Russia.\n\nIntrigued, we continued our search and found more interesting clues that could reveal some detailed\ninformation about the owners of the infected devices. Several TXT files with commands on the\nattacker’s FTP server contain a victim identifier in the names that was probably added by the\ncriminals:\n\nCMDS10114-Sun1.txt\n\nCMDS10134-Ju_ASUS.txt\n\nCMDS10134-Tad.txt\n\nCMDS10166-Jana.txt\n\nCMDS10187-Sun2.txt\n\nCMDS10194-SlavaAl.txt\n\nCMDS10209-Nikusha.txt\n\nSome of them sound like Russian names: Jana, SlavaAl, Nikusha.\n\nAs we know from the FTP dump analysis, there was a firmware component from ASUS firmware,\nindicating the attacker’s interest in ASUS devices, which explains the victim file name that mentions\n“ASUS”.\n\nInformation gathered from the email account provides a lot of the victims’ personal data, including\nmessages from IM applications.\n\n**Gathered file** **Type** **Description**\n\nlock Text Implant log\n\nldata sqlite3 Location data based on network (cell_id)\n\ngdata sqlite3 Location data based on GPS coordinates\n\nsdata sqlite3 SMS messages\n\nf.db sqlite3 Facebook messages\n\nv.db sqlite3 Viber messages\n\nw.db sqlite3 WhatsApp messages\n\n\n-----\n\nAmong the other data gathered were SMS banking messages that revealed an account with a\nbalance of more than US$10,000.But as far as we know, the attacker behind this campaign is not\ninterested in stealing the victims’ money.\n\nWe found no similarities to commercial spyware products or to other known spyware variants, which\nsuggests BusyGasper is self-developed and used by a single threat actor. At the same time, the lack\nof encryption, use of a public FTP server and the low opsec level could indicate that less skilled\nattackers are behind the malware.\n\n## Technical details\n\nHere is the meta information for the observed samples, certificates and hardcoded version stamps:\n\n**Certificate** **MD5** **Module** **Version**\n\n\nSerial Number: 0x76607c02\n\nIssuer: CN=Ron\n\nValidity: from = Tue Aug 30 13:01:30\nMSK 2016\n\nto = Sat Aug 24 13:01:30 MSK 2041\n\nSubject: CN=Ron\n\n\n9e005144ea1a583531f86663a5f14607 1 –\n\n\n18abe28730c53de6d9e4786c7765c3d8 2 2.0\n\n\nSerial Number: 0x6a0d1fec\n\nIssuer: CN=Sun\n\nValidity: from = Mon May 16 17:42:40\nMSK 2016\n\nto = Fri May 10 17:42:40 MSK 2041\n\nSubject: CN=Sun\n\n\n9ffc350ef94ef840728564846f2802b0 2 v2.51sun\n\n\n6c246bbb40b7c6e75c60a55c0da9e2f2 2 v2.96s\n\n7c8a12e56e3e03938788b26b84b80bd6 2 v3.09s\n\nbde7847487125084f9e03f2b6b05adc3 2 v3.12s\n\n2560942bb50ee6e6f55afc495d238a12 2 v3.18s\n\nIt’s interesting that the issuer “Sun” matches the “Sun1” and “Sun2” identifiers of infected devices from\nthe FTP server, suggesting they may be test devices.\n\nThe analyzed implant has a complex structure, and for now we have observed two modules.\n\n## First (start) module\n\nThe first module, which was installed on the targeted device, could be controlled over the IRC protocol\nand enable deployment of other components by downloading a payload from the FTP server:\n\n\n-----\n\n_@install command_\n\nAs can be seen from the screenshot above, a new component was copied in the system path, though\nthat sort of operation is impossible without root privileges. At the time of writing we had no evidence of\nan exploit being used to obtain root privileges, though it is possible that the attackers used some\nunseen component to implement this feature.\n\nHere is a full list of possible commands that can be executed by the first module:\n\n**Command name** **Description**\n\n@stop Stop IRC\n\n@quit System.exit(0)\n\n@start Start IRC\n\n@server Set IRC server (default value is “irc.freenode.net”), port is always 6667\n\n@boss Set IRC command and control nickname (default value is “ISeency”)\n\n@nick Set IRC client nickname\n\n@screen Report every time when screen is on (enable/disable)\n\n@root Use root features (enable/disable)\n\n@timer Set period of IRCService start\n\n@hide Hide implant icon\n\n@unhide Unhide implant icon\n\n@run Execute specified shell\n\n\n-----\n\n@broadcast Send command to the second module\n\n@echo Write specified message to log\n\n@install Download and copy specified component to the system path\n\nThe implant uses a complex intent-based communication mechanism between its components to\nbroadcast commands:\n\n_Approximate graph of relationships between BusyGasper components_\n\n## Second (main) module\n\nThis module writes a log of the command execution history to the file named “lock”, which is later\nexfiltrated. Below is a fragment of such a log:\n\n\n-----\n\n_Log with specified command_\n\nLog files can be uploaded to the FTP server and sent to the attacker’s email inbox. It’s even possible\nto send log messages via SMS to the attacker’s number.\n\nAs the screenshot above shows, the malware has its own command syntax that represents a\ncombination of characters while the “#” symbol is a delimiter. A full list of all possible commands with\ndescriptions can be found in Appendix II below.\n\nThe malware has all the popular capabilities of modern spyware. Below is a description of the most\nnoteworthy:\n\nThe implant is able to spy on all available device sensors and to log registered events.\nMoreover, there is a special handler for the accelerometer that is able to calculate and log the\ndevice’s speed:\n\nThis feature is used in particular by the command “tk0” that mutes the device, disables\nkeyguard, turns off the brightness, uses wakelock and listens to device sensors. This allows it to\nsilently execute any backdoor activity without the user knowing that the device is in an active\nstate. As soon as the user picks up the device, the implant will detect a motion event and\nexecute the “tk1” and “input keyevent 3” commands.\n\n“tk1” will disable all the effects of the “tk0” command, while “input keyevent 3” is the shell\ncommand that simulates the pressing of the ‘home’ button so all the current activities will be\nminimized and the user won’t suspect anything.\n\n\n-----\n\nLocation services to enable (GPS/network) tracking:\n\nThe email command and control protocol. The implant can log in to the attackers email inbox,\nparse emails for commands in a special “Cmd” folder and save any payloads to a device from\nemail attachments.\n\n_Accessing the “Cmd” folder in the attacker’s email box_\n\nMoreover, it can send a specified file or all the gathered data from the victim device via email.\n\nEmergency SMS commands. If an incoming SMS contains one of the following magic strings: ”\n2736428734″ or ” 7238742800″ the malware will execute multiple initial commands:\n\n## Keylogger implementation\n\nKeylogging is implemented in an original manner.\n\nImmediately after activation, the malware creates a textView element in a new window with the\nfollowing layout parameters:\n\n\n-----\n\nAll these parameters ensure the element is hidden from the user.\n\nThen it adds onTouchListener to this textView and is able to process every user tap.\n\nInterestingly, there is an allowlist of tapped activities:\n\nui.ConversationActivity\nui.ConversationListActivity\nSemcInCallScreen\nQuadrapop\nSocialPhonebookActivity\n\nThe listener can operate with only coordinates, so it calculates pressed characters by matching given\nvalues with hardcoded ones:\n\nAdditionally, if there is a predefined command, the keylogger can make a screenshot of the tapped\ndisplay area:\n\n## Manual access and operator menu\n\n\n-----\n\nThere is a hidden menu (Activity) for controlling implant features that looks like it was created for\nmanual operator control. To activate this menu the operator needs to call the hardcoded number\n“9909” from the infected device:\n\nA hidden menu then instantly appears on the device display:\n\n\n-----\n\nThe operator can use this interface to type any command for execution. It also shows a current\nmalware log.\n\n## Infrastructure\n\n### FTP server\n\nThe attackers used ftp://213.174.157[.]151/ as a command and control server. The IP belongs to the\nfree Russian web hosting service Ucoz.\n\n\n-----\n\n**Files** **Description**\n\nCMDS*.txt Text files with commands to execute\n\nsupersu.apk SuperSU (eu.chainfire.supersu,\nhttps://play.google.com/store/apps/details?id=eu.chainfire.supersu)\ntool\n\n\n-----\n\n246.us\nus.x\n\nsupersu.cfg\nsupersu.cfg.ju\nsupersu.cfg.old\n\n\nSuperSU ELF binaries\n\nSuperSU configs with spyware implant mention\n\n\nbb.txt BusyBox v1.26.2 ELF file\n\nbdata.xml Config file for excluding malware components from Android battery\n[saver feature Doze](https://android.stackexchange.com/a/143236)\n\nbdatas.apk Main implant module\n\ncom.android.network.irc.apk Start implant module\n\nMobileManagerService.apk ASUS firmware system component (clean)\n\nmobilemanager.apk Corrupted archive\n\nprivapp.txt Looks like a list of system applications (including spyware\ncomponents) from the infected device\n\n\nrun-as.x\nrun-as.y\n\n\nRun-as tool ELF file\n\n\nSuperSU config fragment for implant components and the busybox tool supersu.cfg:\n\nThis config allows the implant to use all root features silently.\n\nContent of bdata.xml file:\n\nIt can be added to the /system/etc/sysconfig/ path to allowlist specified implant components from the\nbattery saving system.\n\n\n-----\n\n### Email account\n\nA Gmail account with password is mentioned in the sample’s code:\n\nIt contains the victim’s exfiltrated data and “cmd” directory with commands for victim devices.\n\n## Appendix I: Indicators of compromise\n\n### MD5\n\n9E005144EA1A583531F86663A5F14607\n\n18ABE28730C53DE6D9E4786C7765C3D8\n\n2560942BB50EE6E6F55AFC495D238A12\n\n6C246BBB40B7C6E75C60A55C0DA9E2F2\n\n7C8A12E56E3E03938788B26B84B80BD6\n\n9FFC350EF94EF840728564846F2802B0\n\nBDE7847487125084F9E03F2B6B05ADC3\n\n### C2\n\nftp://213.174.157[.]151/\n\n## Appendix II: List of all possible commands\n\nThese values are valid for the most recently observed version (v3.18s).\n\n**Decimal** **Char** **Description**\n\n33 ! Interrupt previous command execution\n\n36 $ Make a screenshot\n\n48 0 Execute following shell: rm c/*; rm p/*; rm sdcard/Android/system/tmp/r/*\n(wipe environment paths?)\n\n63 ? Log device info and implant meta information\n\n66(98) B(b) Broadcast specified command to another component\n\n\n-----\n\n67(99) C(c) Set specified command on timer to execute\n\nDebug\n\n\nLog last 10 tasks by getRecentTasks api\n\nLog info about device sensors (motion, air temperature and pressure, etc.)\n\nLog stack trace and thread information\n\n\n68(100)\n65(97)\n\n68(100)\n83(115)\n\n68(100)\n84(116)\n\nGPS module\n\n\nD(d)\nA(a)\n\nD(d)\nS(s)\n\nD(d)\nT(t)\n\n\n101 e Broadcast command to GPS-tracking external component\n\n71(103) G(g) Location tracking GPS/network\n\nInteraction\nwith operators\n\n\n73(105) 102\n114\n\n73(105) 102\n115\n\n73(105)\n73(105)\n\n73(105)\n76(108)\n\n73(105)\n77(109)\n\n73(105)\n82(114)\n\n73(105)\n83(115)\n\nNetwork\ngeolocation\n\n\nI(i) f r Get specified file from FTP (default – CMDS file with commands)\n\n\nI(i) f\ns\n\nI(i)\nI(i)\n\nI(i)\nL(l)\n\nI(i)\nM(m)\n\nI(i)\nR(r)\n\nI(i)\nS(s)\n\n\nUpload exfiltrated data\n\nStart/stop IRC service\n\nSend current location to IRC\n\nPush specified message to IRC\n\nRead commands from the email inbox\n\nSend specified file or all gathered data in email with UID as a subject\n\n\n76(108) L(l) Get info on current cell_id\n\nCamera\nfeatures\n\n\n77(109) 99 M(m)\nc\n\n77(109) 108 M(m)\nl\n\n\nCapture photo\n\nLog information about available cameras\n\n\n-----\n\n77(109) 114\n97\n\n77(109) 114\n98\n\n77(109) 114\n44(114)\n\n77(109) 114\n115\n\n77(109) 114\n116\n\n\nM(m)\nr a\n\nM(m)\nr b\n\nM(m)\nr,(r)\n\nM(m)\nr s\n\nM(m)\nr t\n\n\nStart/stop audio recording (default duration – 2 minutes)\n\nStart/stop audio recording with specified duration\n\nStart fully customizable recording (allow to choose specific mic etc.)\n\nStop previous recording\n\nSet recording duration\n\nCapture video with specified duration and quality\n\nHard stop of implant services, unregister receivers\n\nStart main implant service with all components\n\n\n77(109) 118 M(m)\nv\n\nCommon\n\n79(111) 102 O(o)\nf\n\n79(111) 110 O(o)\nn\n\n\n80(112) P(p) Find specified images and scale them with “inSampleSize” API\n\n81(113) Q(q) Stop main implant service\n\n82(114) R(r) Execute specified shell command\n\nShared\npreferences\nsetup\n\n\n83(115) 33 S(s)\n!\n\n83(115) 61 S(s)\n=\n\n83(115) 98 S(s)\nb\n\n83(115) 99 S(s)\nc\n\n83(115) 100 S(s)\nd\n\n83(115) 101 S(s)\ne\n\n83(115) 102 S(s)\nf\n\n\nOn/off hidden operator activity\n\nShared preferences control (set/remove specified value)\n\nOn/off sending SMS message after device boot\n\nPut boolean value in shared preference “cpyl”\n\nPut boolean value in shared preference “dconn”\n\nOn/off periodically reenabling data connectivity\n\nSet GPS location update period\n\n\n-----\n\n83(115) 105 S(s) i Put boolean value in shared preference “imsg”\n\n\n83(115) 108\n97\n\n83(115) 108\n99\n\n83(115) 108\n102\n\n83(115) 108\n108\n\n83(115) 108\n116\n\n83(115) 108\n118\n\n83(115) 108\n119\n\n\nS(s) l\na\n\nS(s) l\nc\n\nS(s) l\nf\n\nS(s) l\nl\n\nS(s) l\nt\n\nS(s) l\nv\n\nS(s) l\nw\n\n\nOn/off foreground process activity logging\n\nStart watching on captured photos and videos\n\nStart watching on Facebook messenger database changes\n\nOn/off browser history logging\n\nStart watching on Telegram messenger cache database changes\n\nStart watching on Viber messenger database changes\n\nStart watching on WhatsApp messenger database changes\n\nOn/off sending log SMS messages\n\nSet operator telephone number (for SMS logging)\n\nSet implant stop-mode (full or only main service)\n\nOn/off execution shell as root\n\nOn/off screen state logging\n\nOn/off screen touches logging and number of related screenshots\n\nOn/off debug logging mode with system thread info\n\nUse FTP connection via busybox or default Socket API\n\nOn/off screen brightness\n\nOn/off network data (internet)\n\n\n83(115) 109 S(s)\nm\n\n\n83(115)\n110(112)\n\n\nS(s)\no(p)\n\n\n83(115) 113 S(s)\nq\n\n83(115) 114 S(s)\nr\n\n83(115) 115 S(s)\ns\n\n83(115) 116 S(s)\nt\n\n83(115) 117 S(s)\nu\n\n83(115) 120 S(s)\nx\n\nSensor and\ndisplay control\n\n84(116) 98 T(t)\nb\n\n84(116) 100 T(t)\nd\n\n\n-----\n\n84(116)\n75(107) 48\n\n84(116)\n75(107) 49\n\n84(116)\n75(107) 50\n\n84(116)\n75(107) 51\n\n84(116) 115\n48\n\n84(116) 115\n49\n\n84(116) 115\n108\n\n84(116) 119\n48\n\n84(116) 119\n49\n\n84(116) 119\n108\n\nCommon\nbackdoor\ncommands\n\n\nT(t)\nK(k)\n0\n\nT(t)\nK(k)\n1\n\nT(t)\nK(k)\n2\n\nT(t)\nK(k)\n3\n\nT(t) s\n0\n\nT(t) s\n1\n\nT(t) s\nl\n\nT(t)\nw 0\n\nT(t)\nw 1\n\nT(t)\nw l\n\n\nMute, turn off brightness, disable keyguard, use wakelock and listen on\ndevice sensors.\n\nDisable features from previous command\n\nDisable Keyguard instance\n\nWrite “userActivity” to log\n\nDisable sensor listener\n\nRegister listener for specified sensor\n\nLog int value from file /dev/lightsensor\n\nTurn WiFi off\n\nTurn WiFi on\n\nControl WiFi lock\n\n\n85(117) U(u) Download payload, remount “system” path and push payload there. Based\non the code commentaries, this feature might be used to update implant\ncomponents\n\n87(119) W(w) Send SMS with specified text and number\n\nUpdates from\nthe newest\nversion\n\n122 33 z ! Reboot device\n\n122 99 z c Dump call logs\n\n122 102 z f p Send gathered data to FTP\n\n122 102 z f g Get CMDS* text file and execute contained commands\n\n122 103 z g Get GPS location (without log, only intent broadcasting)\n\n\n-----\n\n122 108 102 z l f Dump Facebook messages during specified period\n\n122 108 116 z l t Dump Telegram cache\n\n122 108 118 z l v Dump Viber messages during specified period\n\n122 108 119 z l w Dump WhatsApp messages during specified period\n\n122 110 z n Get number of all SMS messages\n\n122 111 z o Set ringer mode to silent\n\n122 112 z p Open specified URL in webview\n\n122 114 z r Delete all raw SMS messages\n\n122 116 z t Set all internal service timers\n\n122 122 z z Remove shared preferences and restart the main service\n\n126 ~ On/off advanced logging mode with SMS and UI activity\n\n[Google Android](https://securelist.com/tag/google-android/)\n[Keyloggers](https://securelist.com/tag/keyloggers/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Mobile Malware](https://securelist.com/tag/mobile-malware/)\n[Spyware](https://securelist.com/tag/spyware/)\n[Targeted attacks](https://securelist.com/tag/targeted-attacks/)\n\nAuthors\n\nAlexey Firsh\n\nBusyGasper – the unfriendly spy\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-08-29 - BusyGasper – the unfriendly spy.pdf"
    ],
    "report_names": [
        "2018-08-29 - BusyGasper – the unfriendly spy.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536151,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1653698515,
    "ts_modification_date": 1653698515,
    "files": {
        "pdf": "https://archive.orkl.eu/a88c99a7e75527ed24f0228ed2f81b0ecf3e41fd.pdf",
        "text": "https://archive.orkl.eu/a88c99a7e75527ed24f0228ed2f81b0ecf3e41fd.txt",
        "img": "https://archive.orkl.eu/a88c99a7e75527ed24f0228ed2f81b0ecf3e41fd.jpg"
    }
}