{
    "id": "0a97d827-9529-4758-81c0-98be2340d126",
    "created_at": "2023-01-12T15:04:50.294014Z",
    "updated_at": "2025-03-27T02:09:07.372552Z",
    "deleted_at": null,
    "sha1_hash": "ca9fc4222833402276317c08ebe2ca10b351c5a2",
    "title": "2020-06-30 - GoldenSpy- Chapter Two - The Uninstaller",
    "authors": "",
    "file_creation_date": "2022-05-28T02:49:49Z",
    "file_modification_date": "2022-05-28T02:49:49Z",
    "file_size": 439752,
    "plain_text": "# GoldenSpy: Chapter Two – The Uninstaller\n\n**[trustwave.com/en-us/resources/blogs/spiderlabs-blog/goldenspy-chapter-two-the-uninstaller/](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/goldenspy-chapter-two-the-uninstaller/)**\n\nLoading...\n\nBlogs & Stories\n\n## SpiderLabs Blog\n\nAttracting more than a half-million annual readers, this is the security community's go-to\ndestination for technical breakdowns of the latest threats, critical vulnerability disclosures\nand cutting-edge research.\n\n**_On June 25, 2020 Trustwave SpiderLabs published research showing that the_**\n**_Intelligent Tax software, published by Aisino Corporation and required by a Chinese_**\n\n**_bank, actually contained a hidden backdoor that surrendered complete command_**\n**_and control of the victim’s network. This story received international news coverage_**\n\n**_and was widely discussed in security circles. To review the original blog post click_**\n\n**_[here.](https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/the-golden-tax-department-and-the-emergence-of-goldenspy-malware/?utm_source=sl-blog&utm_medium=chapter-two-click&utm_campaign=goldenspy)_**\n\nOn June 28, 2020, our Threat Fusion team identified a new file being downloaded by the\nAisino Intelligent Tax product. But this time it had nothing to do with remote command and\ncontrol of the victim. Rather, this new sample’s sole mission is to delete GoldenSpy and\n\n\n-----\n\nremove any trace it existed. Including the deletion of registry entries, all files and folders\n(including the GoldenSpy log file), and finally, the uninstaller deletes itself with the following\ncommand: cmd.exe /c del /q C:\\Users\\admin\\AppData\\Local\\Temp\\AWX.exe. Note the “/c”\nwhich will terminate the Windows Command-line interface after the operation is completed\nand “/d” which will delete without asking permission or giving any notification.\n\nGone without a trace, or even knowing it was there.\n\nIn our testing, this GoldenSpy uninstaller will automatically download and execute, and\neffectively, will negate the direct threat of GoldenSpy in your environment, however, as the\ndeployment of this uninstaller is delivered directly from the supposedly legitimate tax\nsoftware, this has to leave users of Intelligent Tax concerned about what else could be\ndownloaded and executed in a similar manner.\n\nWhile the SpiderLabs team is gratified to see GoldenSpy research and analysis result in\nsuch a rapid course reversal in the Golden Tax threat campaign, we are not so optimistic as\nto believe that this new development signifies a slow-down in threat actor activity. This\nthreat is a clear and present danger, driven by incredibly smart and innovative adversaries.\nWe will allow for the briefest of pats on the back and then return to hunting for the next\nthreat.\n\nOrganizations must continuously be vigilant, always threat hunting, because our\nadversaries will continue to find new ways to trick, manipulate, and socially engineer their\nway into environments. The value of the GoldenSpy case-study is not the IOCs we\nprovided, it’s the lesson that malware can be cleverly hidden in any software, regardless of\nits source or supposed legitimacy.\n\nFull Analysis of the GoldenSpy Uninstaller below:\n\n## GoldenSpy Uninstaller\n\n### Description:\n\nTrustwave SpiderLabs investigated the main tax software executable again for the\nexecution flow because we observed the software execution is derived from the command\ngiven to upgrade or install new software on the infected machines.\n\nOnce installed, the main tax module will send a POST request for any software upgrades\nthat are needed. Initially, it would download the SVMinstaller module to implant the\nGoldenSpy malware, but as of June 28, we have identified a new flow that downloads and\nexecutes a customized GoldenSpy uninstaller called “AWX.exe”. Currently, Aisino Intelligent\nTax Software is deploying the GoldenSpy Uninstaller, instead of GoldenSpy itself. This does\nraise the question as to what it might deploy next.\n\n\n-----\n\nThe GoldenSpy Uninstaller, called AWX.exe is silently pushed to infected machines from\n223.112.21.2:8090 and it cleans up all the traces of GoldenSpy’s existence. The following\nflow begins the process:\n\nThe command “PROTOCOL_00” will request any software upgrades\nReceives command to install “AWX.exe”\nThe command “PROTOCOL_99” downloads and executes “AWX.exe”\n\nhttp://223.112.21[.2:8090]/download/AWX.exe\n\n### Analysis:\n\nMD5: 735AC19B261DC66D5850BEA21F3D54FE\n\nSHA256:\n7F5ED71F18937ECC6DB9520CA9A9D16E3C113609C7A9A99A29BA74687F1349D2\n\nSHA1: 4755B68996B53AD3F734127FE46723B60681856E\n\nPDB path : D:\\日常工作\\客户端软件\\VCProject\\dgs\\Release\\del.pdb\n\nTranslated : D:\\day-to-day work\\Client software\\VCProject\\dgs\\Release\\del.pdb\n\nCreated TImeStamp : 28 June 2020 04:15PM GMT\n\nUpon installation, AWX.exe takes the following actions:\n\n1. Identify the executables \"svm.exe\" and \"svmm.exe\"\n2. Stop the “GoldenSpy” services\n3. Kills both “svm.exe” and “svmm.exe” processes.\n4. Log the Processes the svm error logs\n\nC:\\Program Files (x86)\\svm\\log\\{yearmonthdate}-svm.log\nC:\\Program Files (x86)\\svm\\log\\{yearmonthdate}-svmm.log\n\nThe contents of the log entries are shown below:\n\n[yeardatemonth time] [ERROR][SVM](5056): 1063\n\n[yeardatemonth time] [ERROR][SVMM](3880): 1063\n\n1. Uninstall the autostart services and delete all files and folders containing any\n\nreference to GoldenSpy. To include:\n\nC:\\Program Files (x86)\\svm\\svm.exe\nC:\\Program Files (x86)\\svm\\svmm.exe\nC:\\Program Files (x86)\\svm\n\n*Note, this deletion operation also deletes the log file it just generated.\n\n\n-----\n\n1. Delete the registry entries\n\n1. Self-Delete “GoldenSpy Uninstaller” AWX.exe\n\n_cmd.exe /c del /q C:\\Users\\admin\\AppData\\Local\\Temp\\AWX.exe_\n\n**Second Sample Identified – BWXT.EXE**\n\nIn the early morning hours of June 29, a second version of this GoldenSpy Uninstaller was\nidentified to be downloaded by the Intelligent Tax software, only a few hours after the\noriginal was identified. The new sample was compiled on 29 June 2020 at 10:38PM GMT.\nBehaviorally, it was identical to AWX.EXE, however, this version obfuscated its variables\nwith Base64 encoding. SpiderLabs cannot verify the reason for this change, but we\nhypothesize that it may have been to evade antivirus, as several AV engines began to alert\non AWX.EXE.\n\nStrings within the AWX.EXE include:\n\nProject path:\nD:\\日常工作\\客户端软件\\VCProject\\dgs\\Release\\BWXT.pdb\nTranslated Project Path:\nD:\\day-to-day work\\Client software\\VCProject\\dgs\\Release\\BWXT.pdb\n\n### Observation:\n\nDuring our analysis, we found that the GoldenSpy threat actors followed our removal\nrecommendations step by step with their uninstaller. The table below shows our\nrecommendations, compared to their installer.\n\nTrustwave Recommendations GoldenSpy Uninstaller\n\n\nFreeze both svm.exe and svmm.exe\nprocesses\n\n\nStops the “GoldenSpy” services\n\n\nKill SVM processes Looks “svm.exe” and “svmm.exe” and kills\nboth processes\n\n\nGo to SVM directory and permanently\ndelete related files\n\n\nUninstall the service and delete the files\nand folder\n\n\nRemove all registry artifacts related to\nSVM service\n\n\nRemove all registry artifacts related to SVM\nservice\n\n\n-----\n\nN/A Self-delete \"AWX.exe\"\n\n### Indicators of Compromise:\n\n**AWX.exe**\n\nMD5 735AC19B261DC66D5850BEA21F3D54FE\n\nSHA256 7F5ED71F18937ECC6DB9520CA9A9D16E3C113609C7A9A99A29BA74687F1\n\nSHA1 4755B68996B53AD3F734127FE46723B60681856E\n\nNetwork http://223.112.21[.2:8090]/download/AWX.exe\n\n**BWXT.exe**\n\nMD5 F2A7363CF43B5900BB872B0D4C627A48\n\nSHA256 7D48F65FF9E904AC98E0F41B94F04723CE907FC221EFFFBBF83545CA167F\n\nSHA1 3DFF337E2B3E1D3DC995A4B6965AE09C1BF5B137\n\nNetwork http://223.112.21[.2:8090]/download/BWXT.exe\n\n### GoldenSpy Uninstaller YARA Rule:\n\nrule Goldenspy_Uninstaller\n\n{\nmeta:\n\nauthor = \"SpiderLabs\"\n\nmalware_family = \"GoldenSpy\"\n\nfiletype = \"exe_dll\"\n\nstrings:\n\n\n-----\n\n$str1 = taskkill /IM svm.exe /IM svmm.exe /F ascii  //Kill the running process\n$str2 = \"\\\\svm.exe -stopProtect\" ascii                //Stop the service\n$str3 = \"\\\\svmm.exe -u\" ascii                          //Uninstall the malware\n$str4 = \"\\\\VCProject\\\\dgs\\\\Release\\\\\" ascii            //Project path\n$str5 = \"dGFza2tpbGwgL0lNIHN2bS5leGUgL0lNIHN2bW0uZXhlIC9GIA\" ascii\n$str6 = \"c3ZtLmV4ZSAtc3RvcFByb3RlY3Q\" ascii\n$str7 = \"XHN2bW0uZXhlIC11\" ascii\n$str8 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Uninstall\\\\svm\" ascii\n$str9 =\n\"U29mdHdhcmVcTWljcm9zb2Z0XFdpbmRvd3NcQ3VycmVudFZlcnNpb25cVW5pbnN0YWx\nascii\n\ncondition:\n\n(uint16(0) == 0x5A4D) and 4 of ($str*)\n\n}\n\n_Special Thanks to SpiderLabs Threat Hunter Reegun Richard Jayapaul for his analysis of_\n_this new GoldenSpy threat actor activity._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-30 - GoldenSpy- Chapter Two - The Uninstaller.pdf"
    ],
    "report_names": [
        "2020-06-30 - GoldenSpy- Chapter Two - The Uninstaller.pdf"
    ],
    "threat_actors": [
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535890,
    "ts_updated_at": 1743041347,
    "ts_creation_date": 1653706189,
    "ts_modification_date": 1653706189,
    "files": {
        "pdf": "https://archive.orkl.eu/ca9fc4222833402276317c08ebe2ca10b351c5a2.pdf",
        "text": "https://archive.orkl.eu/ca9fc4222833402276317c08ebe2ca10b351c5a2.txt",
        "img": "https://archive.orkl.eu/ca9fc4222833402276317c08ebe2ca10b351c5a2.jpg"
    }
}