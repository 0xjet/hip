{
    "id": "957ae79c-41d1-480e-8b97-e3c8ab175c19",
    "created_at": "2023-01-12T15:06:56.094249Z",
    "updated_at": "2025-03-27T02:05:24.828779Z",
    "deleted_at": null,
    "sha1_hash": "822626dcec6b5ef8f99c031446172f9db0c8403a",
    "title": "2020-08-24 - Emotet Update increases Downloads",
    "authors": "",
    "file_creation_date": "2022-05-28T04:52:03Z",
    "file_modification_date": "2022-05-28T04:52:03Z",
    "file_size": 435510,
    "plain_text": "# Emotet Update increases Downloads\n\n**[hornetsecurity.com/en/security-information/emotet-update-increases-downloads/](https://www.hornetsecurity.com/en/security-information/emotet-update-increases-downloads/)**\n\nSecurity Lab August 24, 2020\n\n## Summary\n\nThe Hornetsecurity Security Lab observed a 1000 % increase in downloads of the Emotet\nloader. The increase in Emotet loader downloads is linked to a change in Emotet’s packer,\nwhich causes the loader to be less frequently detected by AV software. The data we have\ngathered suggests that the increase in Emotet loader downloads stems from the fact that it’s\nless frequently being detected. This makes security mechanisms to less likely to block its\ndownload URLs. Our data, however, also suggests that AV vendors are already closing the\ngap in detection, so the detection rates for the Emotet loader should increase, and the\namount of downloads should decrease again. This analysis shows the impact of the changes\nmade to the packer of the Emotet loader.\n\n## Background\n\nThe malware now commonly known as Emotet was first observed in 2014. Back then, it was\na banking trojan stealing banking details and login credentials from its victims. Later,\nhowever, it pivoted to a malware-as-a-service (MaaS) operation providing malware\ndistribution services to other cybercriminals.\n\n\n-----\n\nWe have already reported on Emotet multiple times in previous blogposts. The following\ntimeline shows its recent developments:\n\nOn 2020-08-18, changes to Emotet’s loader were observed. The Emotet loader is now\npacked with a different packer. Various researchers have observed that this packer change\nhas led to a lower detection rate of the Emotet loader by AV software .1 The unpacked loader\nhas also received updates previously, but these have not caused any considerable impact on\nEmotet loader downloads. The changes performed on 2020-08-07 in order to fix a buffer\noverflow problem exploited by an Emotet “vaccine” called EmoCrash had no impact on the\npresented Emotet loader download statistics, since the “vaccine” only comes into effect after\nthe Emotet loader has been downloaded.\n\n## Technical Analysis\n\n\nWe gathered download statistics from the Emotet download URLs by the methods outlined in\nour [previous article about Emotet webshells .2](https://www.hornetsecurity.com/en/security-informationen-en/webshells-powering-emotet/) For those that have not read our previous\narticle, the PHP code Emotet uses to facilitate its downloads returns a JSON output stating\nthe number of downloads of the Emotet payloads on that particular domain. We did not\nchange our acquisition or analysis methods from the previous article to ensure our results\nare directly comparable and any observed changes are caused by the distribution operation\nof Emotet and not a collection of analysis artifacts caused by methodological changes.\n\nThere are two types of Emotet download URLs: those pointing to an Emotet maldoc and\nthose pointing to the Emotet loader. The Emotet maldocs, which can be sent by email,\ncontain download URLs. A VBA macro code uses them to download the Emotet loader, the\nactual Emotet malware that installs itself on the victim’s computer.\n\n\n-----\n\nIn our previous analysis, the share of download URLs pointing to the Emotet loader was of\n15 %. Now, on 2020-08-19, its share is of 20 %. This is due to the fact that Emotet maldocs\nnow use 6 or sometimes even 7 Emoter loader download URLs instead of the “classic” 5, as\ncan be seen from this decoded PowerShell command issued by a recently released Emotet\nmaldoc:\n\nHowever, the number of downloads of the Emotet loader we have gathered from hidden\nstatistic pages on compromised websites has increased more than 5 %.\n\nThe Emotet download statistics from 2020-07-29 indicated that the Emotet loader was\ndownloaded at a rate of around 2500 times per hour in average. The following plot shows the\nratio between loader and maldoc downloads as well as their volume for 2020-07-29:\n\n\n-----\n\nTwo days after the packer change, on 2020-08-19, the Emotet download statistics indicate\nthat the Emotet loader was downloaded at a rate of around 25000 times per hour on\naverage, a 1000 % increase. The following plot shows the ratio between Emotet loader and\nEmotet maldoc downloads as well as their volume for 2020-08-19:\n\n\n-----\n\nWe attribute this increase to the recent changes to the Emotet packer. The new packer is not\ndetected very well by AV vendors yet. So, most of the new download URLs after the Emotet\npacker change were not detected by any vendors listed on VirusTotal:\n\n\n-----\n\nWhile VirusTotal results do not represent the true dynamic detection of AV software of\nEmotet, the lower detection rates, especially when analyzing the download URLs for the\nEmotet loader, clearly suggest that the updates to the Emotet packer has indeed decreased\nthe detection likelihood. Since many of the Emotet loader download URLs used to be flagged\nas malicious immediately, many security products were likely to block downloads by potential\nvictims, thus leading to very few downloads of the Emotet loader overall.\n\nOn 2020-08-20, the Emotet loader downloads dropped to 7500 per hour, which constitutes a\ndecrease of 70 % compared to 2020-08-19:\n\nThis is likely because AV vendors are now starting to improve the detection of the new\nEmotet packer. At least, VirusTotal detections of new Emotet loader download URLs have\nstarted to be flagged again by AV vendors:\n\n\n-----\n\nThis further supports our hypothesis that the increase in Emotet loader downloads was\ncaused by the new packer and, to a lesser extent, by the increase of Emotet loader\ndownload URLs inside the Emotet maldocs.\n\n## Conclusion and Countermeasure\n\nOur analysis has shown the impact caused by the changes to the Emotet packer. We\nobserved a 1000 % increase in Emotet loader downloads which was closely related to the\ndetections of the Emotet loader download URLs by AV vendors.\n\nTo protect against Emotet the US CERT recommends to “implement filters at the email\ngateway to filter out emails with known malspam indicators” .3\n\n[Hornetsecurity Spam Filter and Malware Protection, with the highest detection rates on the](https://www.hornetsecurity.com/en/services/spam-filter/)\nmarket, is not impacted by the updates to the Emotet packer (as the packer is never sent\ndirectly via emails) and will thus continue to block all Emotet malspam indicators, such as\nmacro documents used for infection as well as known Emotet download URLs.\nHornetsecurity’s [Advanced Threat Protection extends this protection by also detecting still](https://www.hornetsecurity.com/en/services/advanced-threat-protection/)\nunknown malicious links by dynamically downloading and executing the potentially malicious\ncontent in a monitored and sandboxed environment. Thus, even in the event the Emotet\nloader changes is accompanied by a change in delivery tactics, Hornetsecurity will be\nprepared.\n\n\nIn addition to blocking the incoming Emotet emails, defenders should use the publicly\navailable information by the Cryptolaemus team, a voluntary group of IT security people\nbanding together to fight Emotet. They provide new information daily on their website .4 There\nyou can obtain the latest C2 IP list for finding and/or blocking C2 traffic. For real-time\nupdates, you can follow their Twitter account .5\n\n## References\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-08-24 - Emotet Update increases Downloads.pdf"
    ],
    "report_names": [
        "2020-08-24 - Emotet Update increases Downloads.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536016,
    "ts_updated_at": 1743041124,
    "ts_creation_date": 1653713523,
    "ts_modification_date": 1653713523,
    "files": {
        "pdf": "https://archive.orkl.eu/822626dcec6b5ef8f99c031446172f9db0c8403a.pdf",
        "text": "https://archive.orkl.eu/822626dcec6b5ef8f99c031446172f9db0c8403a.txt",
        "img": "https://archive.orkl.eu/822626dcec6b5ef8f99c031446172f9db0c8403a.jpg"
    }
}