{
    "id": "e1dae48a-f1dc-4af7-b1b8-6e1d4eb4a8b8",
    "created_at": "2023-01-12T15:04:54.469069Z",
    "updated_at": "2025-03-27T02:16:14.127978Z",
    "deleted_at": null,
    "sha1_hash": "51a484fa942809e76d8ffb74c9b08f8a8d840154",
    "title": "2020-02-26 - Business as Usual For Iranian Operations Despite Increased Tensions",
    "authors": "",
    "file_creation_date": "2022-05-28T18:16:34Z",
    "file_modification_date": "2022-05-28T18:16:34Z",
    "file_size": 556376,
    "plain_text": "# Business as Usual For Iranian Operations Despite Increased Tensions\n\n**[secureworks.com/blog/business-as-usual-for-iranian-operations-despite-increased-tensions](https://www.secureworks.com/blog/business-as-usual-for-iranian-operations-despite-increased-tensions)**\n\nCounter Threat Unit Research Team\n\n_In spite of concerns regarding Iran’s threatened retaliation for geopolitical events, Iranian_\n_threat groups continue to focus on long-running cyberespionage activity. Wednesday,_\nFebruary 26, 2020 By: Counter Threat Unit Research Team\n\n\n-----\n\nCyberespionage operations by governments with mature cyber capabilities persist\nregardless of geopolitical events. Espionage typically focuses on broader long-term strategic\ngoals.\n\n[Secureworks® Counter Threat Unit™ (CTU) researchers monitor Iranian cyber operations,](https://www.secureworks.com/resources/wc-understanding-the-iranian-cyber-threat)\nincluding the potential for retaliation after a January 2, 2020 U.S. drone strike killed Islamic\nRevolutionary Guard Corps (IRGC) Quds Force General Qasem Soleimani. Although there\n[was ballistic missile bombardment of U.S. military personnel in Iraq on January 8, no](https://en.wikipedia.org/wiki/Operation_Martyr_Soleimani)\ngovernment-directed cyber retaliation has been observed as of this publication.\n\nDespite the lack of retaliatory activity, CTU™ researchers have observed the continuation of\nseveral espionage-focused campaigns. A series of spearphishing campaigns that occurred\nbetween mid-2019 and mid-January 2020 targeted governmental organizations in Turkey,\nJordan, Iraq, as well as global intergovernmental organizations and unknown entities in\nGeorgia and Azerbaijan. Most of this activity commenced prior to the U.S. drone strike.\nVictimology and code similarity between the macros in the analyzed samples and macros\n[documented in open-source reporting suggest that these campaigns were conducted by the](https://community.rsa.com/community/products/netwitness/blog/2019/11/21/detecting-a-muddywater-apt-using-the-rsa-netwitness-platform)\n[COBALT ULSTER threat group (also known as MuddyWater,](https://unit42.paloaltonetworks.com/unit42-muddying-the-water-targeted-attacks-in-the-middle-east/) [Seedworm,](https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group) [TEMP.Zagros, and](https://www.fireeye.com/blog/threat-research/2018/03/iranian-threat-group-updates-ttps-in-spear-phishing-campaign.html)\nStatic Kitten), which is tasked by the Iranian government.\n\n## Multiple paths to compromise\n\nIn one compromised environment, threat actors conducted multiple rounds of spearphishing\nwith malicious attachments to gain initial access. Some of the email messages contained a\nlink to a compromised website, passing the name of the target organization as a parameter\nin the URL. These links were likely intended to track when messages were viewed, a tactic\nknown as a [web bug.](https://en.wikipedia.org/wiki/Web_beacon)\n\nCTU researchers analyzed two different infection chains. One chain delivered a malicious\ndocument via a ZIP archive attached to a spearphishing message. The archive contained a\nMicrosoft Excel Spreadsheet (XLS) file with a filename that was thematically aligned with the\nspearphishing lure.\n\nIn [historic COBALT ULSTER campaigns, the documents used a government agency,](https://securelist.com/muddywater/88059/)\nuniversity, or intelligence organization-related theme with blurred content and a prompt to\nenable macros. In mid-2019, the threat actors adopted a more generic style. In this\napproach, recipients who open the attachment are presented with a seemingly innocuous\ndocument that requests they “enable” the content to view the document (see Figure 1). This\naction disables security controls on active content in the document and runs the embedded\nmalicious code.\n\n\n-----\n\n_Figure 1. View presented to spearphishing recipients who open the malicious Excel files._\n_(Source: Secureworks)_\n\nThe embedded VBScript macro is concealed using multiple layers of obfuscation. It drops a\ncopy of the legitimate Microsoft 32-bit wscript.exe binary (MD5:\nd1ab72db2bedd2f255d35da3da0d4b16) into a non-standard directory path (see Figure 2)\nand uses it to run additional VBScript code. This binary typically runs from a location such as\nC:\\Windows\\SysWOW64\\wscript.exe. The identification of this hash, or command lines that\ninclude /E:vbs, running from non-standard directories could indicate a compromise from this\ncampaign.\n\n_Figure 2. Examples of unusual locations where wscript.exe binary is dropped. (Source:_\n_Secureworks)_\n\nAn HKU\\<Security Identifier>\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\ registry key\nis set for persistence. Another executed block of VBScript and PowerShell (e.g., the jjcpquui\nfile shown in Figure 2) downloads a second-stage obfuscated PowerShell downloader (see\nFigure 3).\n\n_Figure 3. Truncated extract of obfuscated PowerShell downloader using custom encoding_\n_scheme. (Source: Secureworks)_\n\nThis code downloads additional payloads from an IP address hard-coded in the script (see\nFigure 4). CTU researchers have observed four different IP addresses. Although many threat\ngroups use multiple layers of obfuscation and multiple stages of activity to deploy payloads,\nthese practices are common in COBALT ULSTER operations.\n\n\n-----\n\n_Figure 4. Deobfuscated version of the obfuscated PowerShell downloader. (Source:_\n_Secureworks)_\n\nThe second infection chain analyzed by CTU researchers also used a spearphishing email to\ndeliver a ZIP archive containing a malicious Excel file. In this case, the Excel file uses an\nobfuscated macro to drop and execute a previously unobserved remote access trojan (RAT)\nthat CTU researchers refer to as ForeLord. The malicious document uses cmd.exe to\nexecute a batch script (tt.bat) that adds a key to the registry for persistence when the system\nrestarts. In parallel, a PowerShell script uses rundll32.exe to execute the ForeLord malware\n(Exchange.dll) (see Figure 5).\n\n_Figure 5. Process tree showing the malicious Excel file creating the ForeLord persistence_\n_mechanism. (Source: Secureworks)_\n\nThe DNS-based command and control (C2) protocol uses DNS_TYPE_TEXT records to\ntransfer data. The ForeLord name reflects one of the DNS responses that the malware looks\nfor as part of the C2 protocol: “lordlordlordlord”. This string is received from the C2 servers\nand acknowledges reception of the message. The ForeLord malware uses DNS request\nformats that correspond to one of the patterns shown in Figure 6.\n\n_Figure 6. Format of ForeLord DNS requests. (Source: Secureworks)_\n\n\n-----\n\nThe use of DNS tunneling means the requests are initially directed to legitimate DNS\nservers, which relay the requests to malicious nameservers controlled by the threat actors.\nPivoting on elements of the C2 protocol, CTU researchers identified 14 additional domains\npossibly registered by COBALT ULSTER.\n\nFigure 7 provides an overview of the interplay of the two infection chains analyzed by CTU\nresearchers. A variety of additional tools were deployed to compromised systems after the\nfinal stage, and telemetry indicates interactive access from the threat actors.\n\n_Figure 7. Overview of the two infection chains observed in January 2020 campaigns._\n_(Source: Secureworks)_\n\nAfter gaining initial access to a host, the threat actors dropped several tools to collect\ncredentials, test those credentials on the network, and create a reverse SSL tunnel to\nprovide an additional access channel to the network. These tools included PASS32.dll,\nPASS64.dll (see Figure 8), PasswordDumper.exe, and a Mimikatz variant named Caller.dll.\nThe Caller.dll command line included Base64-encoded arguments, potentially as an evasion\ntechnique to hide the nature of this tool.\n\n_Figure 8. Example command line used to run PASS64.dll. (Source: Secureworks)_\n\n[CredNinja.ps1 (see Figure 9) is an open-source tool that allows penetration testers to quickly](https://github.com/Raikia/CredNinja)\ntest collected credentials or hashes to determine which will work on a targeted Windows\ndomain. The threat actors used a list of valid user accounts from the target domain in\nconjunction with a weak password list to determine potentially accessible accounts. The\npassword list could be augmented to test credentials captured from credential-dumping tools.\n\n\n-----\n\n_Figure 9. CredNinja ASCII splash screen showing available options. (Source: GitHub)_\n\nThe [open-source Secure Socket Funneling TCP and UDP port forwarding tool forwards data](https://github.com/securesocketfunneling/ssf)\nfrom multiple sockets through a single secure TLS tunnel to a remote computer. This\nforwarding provides the threat actor with an additional remote access mechanism. The -F\noption runs a SOCKS proxy on the local host, which is accessible from the server, and -p\ndefines the remote port to use when connecting to the server (see Figure 10). It is possible\nthat this mechanism was used to allow remote access to the compromised host via Remote\nDesktop Protocol (RDP).\n\n_Figure 10. Command line used to run ssf.exe. (Source: Secureworks)_\n\n## Conclusion\n\nAlthough Iran has not launched a cyber retaliation for Soleimani’s death as of this\npublication, CTU researchers acknowledge that planning and coordinating for a response\ntakes time. Iran has destructive and disruptive capabilities that it has historically employed\nfor retaliatory purposes against organizations. In some cases, these responses materialized\nseveral months after provocations toward Iran occurred. However, Iran's cyberespionage\noperations continue.\n\nFrom a threat management and risk assessment perspective, CTU researchers advise\norganizations not to conflate ongoing espionage operations with a retaliatory response.\nHowever, continually leveraging threat intelligence to assess and improve controls will help\nnetwork defenders secure their environments against malicious activity regardless of intent.\n\n\n-----\n\nMany Iranian intrusions observed by CTU researchers between 2018 and early 2020 began\nwith the collection of valid credentials in the victim's environment via social engineering,\nphishing, password spraying, brute-force attacks, and exploitation of publicly available\nsystems. Organizations concerned about threats from Iran should review prevention,\ndetection, and response procedures:\n\nApply security updates to all systems, particularly those that are Internet-facing.\nProtect user credentials within the environment through periodic user awareness\ntraining and multi-factor authentication (MFA). Employ MFA for remote access solutions\nand web-based email access, including Office365.\nAs most of the observed Iranian intrusions involved malware or abuse of native system\ntools, employ endpoint detection technology that detects those types of activity.\nEstablish and test procedures for responding to denial of service activity. If appropriate,\na distributed denial of service mitigation service provider can ensure continuity of\nInternet-facing services.\n\nTo mitigate exposure to this malware, CTU researchers recommend that organizations use\navailable controls to review and restrict access using the indicators listed in Table 1. The\ndomains and URLs may contain malicious content, so consider the risks before opening\nthem in a browser.\n\n**Indicator** **Type** **Context**\n\n\nlalindustries.com Domain\nname\n\nlinkupdate.org Domain\nname\n\ncfm.com.pk Domain\nname\n\ngraphixo.net Domain\nname\n\nksahosting.net Domain\nname\n\nassignmenthelptoday.com Domain\nname\n\nampacindustries.com Domain\nname\n\n\nCompromised website hosting COBALT\nULSTER C2 infrastructure\n\nCompromised website hosting COBALT\nULSTER C2 infrastructure\n\nCompromised website hosting COBALT\nULSTER C2 infrastructure\n\nCompromised website hosting COBALT\nULSTER C2 infrastructure\n\nCompromised website hosting COBALT\nULSTER C2 infrastructure\n\nCompromised website hosting COBALT\nULSTER C2 infrastructure\n\nCompromised website hosting COBALT\nULSTER C2 infrastructure\n\n\nhttp://lalindustries.com/wpcontent/upgrade/editor.php?ac=1&n=\n\n\nURL Compromised website hosting COBALT\nULSTER C2 infrastructure\n\n\n-----\n\nhttp://linkupdate.org/js/js.php?\nac=1&n=\n\nhttp://cfm.com.pk/wpincludes/utf8.php?ac=1&n=\n\nhttp://advanceorthocenter.com/wpincludes/editor.php?ac=1&n=\n\nhttp://graphixo.net/wpincludes/utf8.php?ac=1&n=\n\nhttp://ksahosting.net/wpincludes/utf8.php\n\nhttps://assignmenthelptoday.com/wpincludes/utf8.php\n\n\nURL Compromised website hosting COBALT\nULSTER C2 infrastructure\n\nURL Compromised website hosting COBALT\nULSTER C2 infrastructure\n\nURL Compromised website hosting COBALT\nULSTER C2 infrastructure\n\nURL Compromised website hosting COBALT\nULSTER C2 infrastructure\n\nURL Compromised website hosting COBALT\nULSTER C2 infrastructure\n\nURL Compromised website hosting COBALT\nULSTER C2 infrastructure\n\n\noutlook-accounts.tk Domain\nname\n\noutlook-accounts.ml Domain\nname\n\nofficex64.ml Domain\nname\n\nwindows-patch.tk Domain\nname\n\nwindows-patch.ml Domain\nname\n\nwindowscortana.tk Domain\nname\n\nmsdn-social.tk Domain\nname\n\nmsdn-social.ml Domain\nname\n\nspacex.gq Domain\nname\n\nspacex.cf Domain\nname\n\ngooglecloud.gq Domain\nname\n\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\n\n-----\n\ngooglecloud.cf Domain\nname\n\ndevice-update.tk Domain\nname\n\nbing-search.ml Domain\nname\n\n_Table 1. Indicators for this threat._\n\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\nSuspected ForeLord C2 infrastructure\nlinked via bing-search.ml\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-02-26 - Business as Usual For Iranian Operations Despite Increased Tensions.pdf"
    ],
    "report_names": [
        "2020-02-26 - Business as Usual For Iranian Operations Despite Increased Tensions.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "31e69945-6c1e-40c3-ba8e-a77e81dd142a",
            "created_at": "2024-05-01T02:03:08.047377Z",
            "updated_at": "2025-03-27T02:05:17.326452Z",
            "deleted_at": null,
            "main_name": "COBALT ULSTER",
            "aliases": [
                "ENT-11 ",
                "ITG17 ",
                "MERCURY ",
                "Mango Sandstorm ",
                "MuddyWater ",
                "STAC 1171 ",
                "Seedworm ",
                "Static Kitten ",
                "TEMP.Zagros ",
                "UNC3313 ",
                "Yellow Nix ",
                "Earth Vetala "
            ],
            "source_name": "Secureworks:COBALT ULSTER",
            "tools": [
                " Canopy",
                " CrackMapExec",
                " CredNinja",
                " Empire",
                " FORELORD",
                " Koadic",
                " LaZagne",
                " Ligolo",
                " MKL64",
                " Metasploit",
                " Mimikatz",
                " MiniDump",
                " Mori",
                " MuddyC2Go",
                " MuddyC3",
                " PhonyC2",
                " Plink",
                " PowGoop",
                " PowerStats",
                " RemoteUtilities",
                " Revsocks",
                " ScreenConnect",
                " SimpleHelp",
                " Small Sieve",
                " Syncro",
                " Venom Proxy",
                " WMIExec",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535894,
    "ts_updated_at": 1743041774,
    "ts_creation_date": 1653761794,
    "ts_modification_date": 1653761794,
    "files": {
        "pdf": "https://archive.orkl.eu/51a484fa942809e76d8ffb74c9b08f8a8d840154.pdf",
        "text": "https://archive.orkl.eu/51a484fa942809e76d8ffb74c9b08f8a8d840154.txt",
        "img": "https://archive.orkl.eu/51a484fa942809e76d8ffb74c9b08f8a8d840154.jpg"
    }
}