{
    "id": "37fd6e6e-718a-438b-af35-18d09414088e",
    "created_at": "2023-01-12T15:02:48.346134Z",
    "updated_at": "2025-03-27T02:06:01.242192Z",
    "deleted_at": null,
    "sha1_hash": "775e181d1e56d6ed0382006539354ce42458cb51",
    "title": "2021-05-05 - Smishing campaign in NL spreading Cabassous and Anatsa",
    "authors": "",
    "file_creation_date": "2022-05-28T23:39:40Z",
    "file_modification_date": "2022-05-28T23:39:40Z",
    "file_size": 1066663,
    "plain_text": "# Smishing campaign in NL spreading Cabassous and Anatsa\n\n**[threatfabric.com/blogs/smishing-campaign-in-nl-spreading-cabassous-and-anatsa.html](https://www.threatfabric.com/blogs/smishing-campaign-in-nl-spreading-cabassous-and-anatsa.html)**\n\nMay 2021\n\n## Introduction\n\nIn early December 2020 ThreatFabric discovered Cabassous, which was later renamed by PRODAFT to\nFluBot. This is a classic Android bot, equipped with credential stealing capabilities such as the use of\noverlays (fake login screens) for crypto-currency wallet apps and Android banking apps. Besides\nharvesting credentials, the bot also gathers all contact information (phone numbers) from a victim’s device\nto spread itself using SMS messages (smishing).\n\n[Another banking trojan named Anatsa was discovered by ThreatFabric analysts in January 2021. It](https://twitter.com/ThreatFabric/status/1348936359436804096)\nshould be considered a stronger threat compared to Cabassous, due to its more extensive and advanced\nset of features. Anatsa’s functionalities include the classic credential-stealing overlay attacks, which are\nfirst downloaded and stored on the device, and then launched locally. Other features include keylogging,\ncontact information and device information exfiltration, and accessibility logging. This last feature is very\nadvanced and very dangerous for victims. It grants information to the malicious actors about everything\ndisplayed in the device’s screen, allowing the bot to interact with the UI elements and record all the\n[information that is displayed in them. We also covered this threat in our latest blog.](https://www.threatfabric.com/blogs/the-rage-of-android-banking-trojans.html)\n\nAnatsa has been relatively quiet in the first months of the year, but it has recently increased its activity\nnow including Dutch banks in its target list.\n\nWith this threat update we want to inform the users about a new SMS phishing campaign we spotted in\nthe Netherlands masquerading as UPS apps and distributing both Cabassous and Anatsa.\n\n\n-----\n\n## Previous campaigns\n\nOn April 18th, Cabassous began to use multiple DGA seeds in every sample allowing it to be more\nscalable: the Trojan generates corresponding C2 server address to receive the overlay target list specific\nfor the victim’s country. This means that every botnet can have its own overlay specific to country of the\ntargeted banking and wallet apps.\n\nAs [reported by ThreatFabric, enormous SMS phishing campaigns reported by major telecom operators](https://twitter.com/ThreatFabric/status/1386663113525800962)\nhave been observed in multiple new targeted countries, including the UK, Norway, Sweden, Finland,\n[Denmark, Netherlands, and Japan. This also matches with the current smishing campaign reported in the](https://twitter.com/VodafoneUK/status/1385326486144618497)\nUK masquerading as UPS and DHL apps.\n\n\n-----\n\nUsually, the SMS contains some link that claims to provide the information about your parcel from DHL or\nUPS. The link leads to the page with a localized text corresponding to the region defined by the victim’s IP\nlocation. The text contains instructions to download and install an application, which is the Cabassous\nTrojan itself.\n\n\n-----\n\n## Latest developments\n\nOn May 5th, ThreatFabric analysts spotted a new smishing campaign in the Netherlands masquerading\nas UPS apps. That is a common MO for Cabassous that has been described above.\n\nHowever, besides Cabassous, ThreatFabric analysts were able to obtain the Anatsa Trojan from the\nsame links. That means that at the moment of writing this blog, Anatsa and Cabassous are distributed\nside-by-side in the Netherlands both masquerading as UPS apps. Nevertheless, there is no solid proof\nthat the actor(s) behind these families are the same.\n\n\n-----\n\nAt the moment of writing Cabassous does not target any application of Netherlands banks, the C2\nresponsible for the campaign targeting Norway, Sweden, Finland, Denmark, Netherlands and Poland only\nserves the target list for banking apps in Poland. Anatsa however does have the banking apps from the\nNetherlands in its target list. The following images are examples of overlays used for the Dutch banks:\n\n\n-----\n\n-----\n\nThe full lists of targeted applications used by Anatsa and Cabassous can be found in the Appendix.\n\n## The danger of Anatsa\n\n\n-----\n\nWhen comparing Cabassous with Anatsa, the more dangerous of the two appears to be Anatsa due to its\nRAT capability. The Trojan can receive a command called “start_client” from the C2 and initiate a\nconnection to a specified IP and port. This connection is used to send and receive data that enables\nactor(s) to do the following:\n\nObserve the screen of the victim’s device on a real-time basis\nPerform clicks and actions on behalf of the victim\nOpen applications (like banking application or web-browser)\nManipulate text input\n\nThis capability leads to another type of fraud - so called on-device fraud, when actor(s) perform the actual\nfraud from the device of the victim. The following code snippet represents the actor(s) ability to\nmanipulate text input:\n```\nwhile (counter < numberOfActions) {\n  int leftBound = byteBuffer.getShort();\n  int bottomBound = byteBuffer.getShort();\n  byteBuffer.getShort();\n  byteBuffer.getShort();\n  int length = byteBuffer.getShort();\n  byte[] textBytes = new byte[length];\n  byteBuffer.get(textBytes, 0, length);\n  String setText = new String(textBytes, StandardCharsets.UTF_8);\n  AccessibilityNodeInfo rootNodeInfo =\nMainAccessibilityService.service.getRootInActiveWindow();\n  if (rootNodeInfo != null) {\n    for(Object editTextNode: Utils.getAllNodes(rootNodeInfo, \"EditText\")) {\n      AccessibilityNodeInfo accNodeInfo = (AccessibilityNodeInfo)editTextNode;\n      Rect v9_1 = new Rect();\n      accNodeInfo.getBoundsInScreen(v9_1);\n      if (v9_1.left != leftBound || v9_1.bottom != bottomBound) { // check position\n        continue;\n      }\n      Bundle bundle = new Bundle();\n      bundle.putString(\"ACTION_ARGUMENT_SET_TEXT_CHARSEQUENCE\", setText);\n      accNodeInfo.performAction(0x200000, bundle);\n    }\n  }\n  ++counter;\n}\n\n### Bot commands\n\n```\nThe Anatsa bot supports the following commands:\n\n**Command** **Description**\n\nactivate_screen Enables the screen\n\napp_delete Uninstalls application\n\nask_syspass Shows the request for device password/PIN/gesture\n\nask_perms Trigger the bot to request for permissions\n\nstop_pers Stops persistence mechanisms for 40 seconds\n\n\n-----\n\n**Command** **Description**\n\nget_accounts Triggers stealing the list of accounts on the device\n\nkill_bot Removes the bot from the infected device\n\nmute_phone Mutes the device\n\nswipe_down Performs a swipe down gesture\n\nopen_inject Triggers the overlay attack for specified application\n\nopen_activity Opens the specified application\n\nchange_pass Prompts the user to change the password\n\nreset_pass Clears cached device password (in the bot’s runtime)\n\nstart_client Starts RAT client\n\ngrab_google_auth Triggers stealing of google authenticator codes\n\n## Getting rid of the malware\n\nIn general, we recommend doing a factory reset when your device is infected with malware. This will put\nthe device back to the state it was in when it was first turned on. For Anatsa and Cabassous it is also\nenough to uninstall the malware apps from the device (through the Android Settings menu), assuming\nyou know which app is the malware (in this campaign the app name “UPS” is used).\n\nBecause both malware variants prevent removing the app through the Android Settings menu, you will\nhave to boot the phone into safe mode (preventing the malware from running) to be able to uninstall the\napp. Another option, for tech-savvy users, is to use [ADB (Android Debug Bridge) to connect to the device](https://developer.android.com/studio/command-line/adb)\nvia USB and run the command `adb uninstall <malware_package_name> .`\n\nAnatsa makes it even more difficult to remove it, because in addition to preventing the app to be\nuninstalled through the Android Settings, it also prevents rebooting or shutting down the device (required\nfor safe mode). If you can’t use ADB, the easiest option is to simply wait until the device turns off because\nit runs out of power (optionally in the meantime turning off Wi-Fi and data connections to stop the RAT\nfrom communicating with its C2) and then boot into safe mode and perform the actions described above.\n\n## Client Side Detection\n\n[ThreatFabric CSD can be used to detect customers infected with such threats in real-time, therefore](https://www.threatfabric.com/csd.html)\navoiding fraud and keeping the risk under control.\n\n## Appendix\n\n### Cabassous\n\nOne of the latest Cabassous samples found in the wild:\n\n\n-----\n\n**AppApp** **PackagePackage**\n**namename** **namename** **SHA-256 hashSHA-256 hash**\n\n\nUPS\nMobile\n\n\nkit.stem.iron 83ac4c915546ff9c7bda78cf9cbbc23c7f6f5b1d33967d2040ce8f0f22031a2b\n\n\nThe list of targeted applications contains 30 applications:\n\n**App name** **Package name**\n\nPibank es.pibank.customers\n\nBanca Móvil Laboral Kutxa com.tecnocom.cajalaboral\n\nEVO Banco móvil es.evobanco.bancamovil\n\nIbercaja es.ibercaja.ibercajaapp\n\nBBVA Spain com.bbva.bbvacontigo\n\nPeoPay softax.pekao.powerpay\n\nBankinter Móvil com.bankinter.launcher\n\nCajasur com.cajasur.android\n\nBank Millennium wit.android.bcpBankingApp.millenniumPL\n\nruralvía com.rsi\n\nimaginBank - Your mobile bank com.imaginbank.app\n\nBinance - Buy & Sell Bitcoin Securely com.binance.dev\n\nSantander es.bancosantander.apps\n\nBlockchain Wallet. Bitcoin, Bitcoin Cash, Ethereum piuk.blockchain.android\n\nIKO pl.pkobp.iko\n\nOpenbank – banca móvil es.openbank.mobile\n\nBNP Paribas GOMobile com.finanteq.finance.bgz\n\nSantander mobile pl.bzwbk.bzwbk24\n\nBankia es.cm.android\n\nGmail com.google.android.gm\n\nBanca Digital Liberbank es.liberbank.cajasturapp\n\nMoje ING mobile pl.ing.mojeing\n\nGrupo Cajamar com.grupocajamar.wefferent\n\nUnicajaMovil es.univia.unicajamovil\n\n\n-----\n\n**App name** **Package name**\n\nIdea Bank PL pl.ideabank.mobilebanking\n\nCoinbase – Buy & Sell Bitcoin. Crypto Wallet com.coinbase.android\n\nCA24 Mobile com.finanteq.finance.ca\n\nAlior Mobile pl.aliorbank.aib\n\nKutxabank com.kutxabank.android\n\nING España. Banca Móvil www.ingdirect.nativeframe\n\n### Anatsa\n\nOne of the latest Anatsa samples found in the wild:\n\n**App**\n**name** **Package name** **SHA-256 hash**\n\nUPS brave.crowd.home c8dbba4ff6c71e7cdb6637f59694d96398b5da4aed50b5d650b0b532f1b07682\n\nThe list of targeted applications contains 39 applications:\n\n**App name** **Package name**\n\nDeutsche Bank Mobile com.db.pwcc.dbmobile\n\nLa Mia Banca com.db.pbc.miabanca\n\nKnab Bankieren bvm.bvmapp\n\nVR Banking Classic de.fiducia.smartphone.android.banking.vr\n\nING Bankieren com.ing.mobile\n\nIbercaja es.ibercaja.ibercajaapp\n\nABN AMRO Mobiel Bankieren com.abnamro.nl.mobile.payments\n\nBBVA Spain com.bbva.bbvacontigo\n\nmyAlpha Mobile com.mobileloft.alpha.droid\n\nCommerzbank Banking - The app at your side de.commerzbanking.mobil\n\nRabo Bankieren nl.rabomobiel\n\nCajasur com.cajasur.android\n\nBanco Sabadell App. Your mobile bank net.inverline.bancosabadell.officelocator.android\n\nTriodos Bankieren NL com.triodos.bankingnl\n\nruralvía com.rsi\n\n\n-----\n\n**App name** **Package name**\n\nHVB Mobile Banking eu.unicreditgroup.hvbapptan\n\nBinance - Buy & Sell Bitcoin Securely com.binance.dev\n\nSantander es.bancosantander.apps\n\nSpardaSecureApp de.sdvrz.ihb.mobile.secureapp.sparda.produktion\n\nBlockchain Wallet. Bitcoin, Bitcoin Cash, Ethereum piuk.blockchain.android\n\nPostbank Finanzassistent de.postbank.finanzassistent\n\nOpenbank – banca móvil es.openbank.mobile\n\nBankia es.cm.android\n\nBanca Digital Liberbank es.liberbank.cajasturapp\n\nING Banking to go de.ingdiba.bankingapp\n\nASN Mobiel Bankieren nl.asnbank.asnbankieren\n\nUnicajaMovil es.univia.unicajamovil\n\nGrupo Cajamar com.grupocajamar.wefferent\n\nSantander Banking de.santander.presentation\n\ncomdirect mobile App de.comdirect.android\n\nWiZink, tu banco senZillo app.wizink.es\n\nCoinbase – Buy & Sell Bitcoin. Crypto Wallet com.coinbase.android\n\nSparkasse Ihre mobile Filiale com.starfinanz.smob.android.sfinanzstatus\n\nRegioBank - Mobiel Bankieren nl.regiobank.regiobankieren\n\nKutxabank com.kutxabank.android\n\nCaixaBank es.lacaixa.mobile.android.newwapicon\n\ntractorpool de.traktorpool\n\nVivid: Investments & Banking & Crypto vivid.money\n\nING España. Banca Móvil www.ingdirect.nativeframe\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-05 - Smishing campaign in NL spreading Cabassous and Anatsa.pdf"
    ],
    "report_names": [
        "2021-05-05 - Smishing campaign in NL spreading Cabassous and Anatsa.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535768,
    "ts_updated_at": 1743041161,
    "ts_creation_date": 1653781180,
    "ts_modification_date": 1653781180,
    "files": {
        "pdf": "https://archive.orkl.eu/775e181d1e56d6ed0382006539354ce42458cb51.pdf",
        "text": "https://archive.orkl.eu/775e181d1e56d6ed0382006539354ce42458cb51.txt",
        "img": "https://archive.orkl.eu/775e181d1e56d6ed0382006539354ce42458cb51.jpg"
    }
}