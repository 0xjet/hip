{
    "id": "a5728273-d9ab-4e6e-b25a-e6d52cf56077",
    "created_at": "2022-10-25T16:48:25.208722Z",
    "updated_at": "2025-03-27T02:05:18.293928Z",
    "deleted_at": null,
    "sha1_hash": "6b624d6d80b412a10260344f244ed93e3718e003",
    "title": "Surtr: Malware Family Targeting The Tibetan Community",
    "authors": "Citizen Lab",
    "file_creation_date": "2014-01-15T22:26:21Z",
    "file_modification_date": "2014-01-15T22:26:21Z",
    "file_size": 512871,
    "plain_text": "Projects\n\nPublications\n\nArchives\n\n\nGLA2010 In the News\n\nNewsletter\n\nEvents\n\n\nAbout\n\nPeople\n\nOpportunities\n\nContact\n\n\nSearch\n\n# Surtr: Malware Family Targeting the Tibetan Community\n\n_August 2, 2013_\n\nTagged: Malware, targeted threats, Tibet\n\nCategories: Reports and Briefings, Research News\n\nby Katie Kleemola and Seth Hardy\n\n# Background\n\nAs part of our ongoing study into targeted attacks on human rights groups and civil society organizations, the Citizen Lab\n\nanalyzed a malicious email sent to Tibetan organizations in June 2013. The email in question purported to be from a prominent\n\nmember of the Tibetan community and repurposed content from a community mailing list. Attached to the email were what\n\nappeared to be three Microsoft Word documents (.doc), but which were trojaned with a malware family we call “Surtr”.[1] All three\n\nattachments drop the exact same malware. We have seen the Surtr malware family used in attacks on Tibetan groups dating back\n\nto November 2012.\n\n# Delivery Mechanism\n\nWhile the malicious attachments appear to be DOC files due to their file extension, they are actually RTFs crafted to exploit a\n\nvulnerability in Microsoft Word: CVE-2012-0158.\n\nThis particular vulnerability was first exploited in early April 2012 and a patch was released by Microsoft on April 10, 2012.\n\nCurrently, the sample is detected as malicious by 34 percent of antivirus (AV) engines on VirusTotal (VT).\n\nThe malicious attachment is created using a shared template that we have seen used against multiple Tibetan groups. This\n\ntemplate was created in March 2013 and, instead of specifically using the vulnerable ActiveX controls described in the\n\nvulnerability description, it utilizes the Chartspace Office Web Component. This component either suffers from the same\n\nvulnerability or uses one of the named ActiveX controls resulting in the attacker being able to execute malicious code.\n\nFigure 1: Hexdump of the malicious attachment\n\n\n-----\n\nAlthough CVE-2012-0158 was first published and used in the wild in April 2012, samples using this template were only initially\n\ndetected by three AV engines (on VT). Therefore, while a third of AV engines had a detection signature for CVE-2012-0158 as\n\nlate as April 2013, it was possible to design a document using a year old vulnerability that was recognized as malicious by very\n\nfew AV products. This number has since risen and it is currently being detected by 34 percent of the AV products listed on VT.\n\nThis vulnerability highlights the need to keep both operating systems and applications up to date as well as to exercise vigilance\n\nconcerning links and email attachments.\n\nMalicious attachments with this template all use a similar dropper which originally drops the payload to the temporary file\n\ndirectory.\n\n# Payload\n\nSurtr creates either a new explorer or iexplore process and injects itself into this new process using CreateRemoteThread\n\nfunction.\n\nIt also creates the following folders:\n\n%ALL USERS%/Application Data/Microsoft/Windows/123\n\n%ALL USERS%/Application Data/Microsoft/Windows/Burn\n\n%ALL USERS%/Application Data/Microsoft/Windows/LiveUpdata_Mem\n\nIt creates multiple copies of the payload including in both the Burn and LiveUpdata_Mem folders. The copy in the Burn folder is\n\ncalled [VICTIM COMPUTER NAME].dll and there are three copies in the LiveUpdata_Mem folder whose names consist of 6\n\nrandom alphanumeric characters which are then appended with .dll, _Fra.dll and _One.dll. These copies will differ from the\n\noriginal payload dropped in the %TEMP% folder by filling the resource section with varying amounts of 00 bytes. This also results\n\nin the malware having a much larger file size (30-50mb) possibly in an attempt to evade antivirus heuristics.\n\nSurtr connects to a command and control server (C2) and downloads a stage two component to %ALL USERS%/Application\n\nData/Microsoft/Windows/Burn/_[VICTIM COMPUTER NAME].log. This particular sample connects to internet.3-a.net on port 9696.\n\nIn May 2012, internet.3-a.net resolved to the same IP (184.82.123.143) as android.uyghur.dnsd.me, which is a C2 used in\n\nAndroid malware attacks that targeted the Tibetan community as previously documented by the Citizen Lab.\n\nThe stage two component that was downloaded in this particular case has an internal name of x86_GmRemote.dll, however we\n\nhave seen an alternate stage two used with the name Remote.dll as well. Our analysis in this post focuses on the GmRemote\n\nvariation as it has been seen in multiple attacks.\n\nSurtr’s capabilities include listing of file directories and contents on the victim computer and any USB drives connected to a victim\n\nmachine, viewing web cache, executing remote commands and logging keystrokes.\n\nIn order to store temporary information, Surtr creates the following folders:\n\n%ALL USERS%/Application Data/Microsoft/Windows/MpCache\n\n\n-----\n\npp _\n\n%ALL USERS%/Application Data/Microsoft/Windows/UsbLoydb\n\nFor example, in nView_DiskLoydb, a file called FileList.db that contains file and directory listings will be placed and\n\nnView_KeyLoydb will contain text files with keylogger output. The keylogger output is disguised by adding a constant to the\n\nordinal value of the character.\n\nThis data can then be sent to the C2. It is compressed using zlib DEFLATE so the network traffic is not human readable without\n\ndecompression.\n\nIt can also download additional malware onto the victim computer, which can provide attackers with further abilities like accessing\n\nthe victim computer’s webcam or microphone. In particular, we have seen Surtr used in conjunction with the Gh0st RAT derived\n\nLURK0 malware.\n\nFor persistency, Surtr adds a key to the registry to ensure it runs when the infected computer is restarted. It also stores its C2\n\ninformation and a campaign code in the registry.\n\nDepending on the configuration, Surtr will either create multiple registry keys in Software\\Microsoft\\Windows Media in HKU (hkey\n\nusers) with text data or a single key called XC consisting of binary data. These are usually xor encrypted with a key of 0×1.\n\nFigure 2: Encrypted data in XC key\n\nFigure 3: Decrypted data (note: e0 25 is 0x25e0 which is 9696 in hex)\n\n\n-----\n\n# Other Samples & Variations\n\nWe have seen a large number of similar samples sent to Tibetan groups that use the same stage two (GmRemote) and\n\ncommunicate with the following C2s: dtl.dnsd.me, dtl.eatuo.com, dtl6.mooo.com and tbwm.wlyf.org. These C2s were also used in\n\nprevious attacks documented in an earlier Citizen Lab post on LURK0 malware targeting the Tibetan community.\n\nOne particular sample (md5: ad9e5f79585eb62bc40b737e98bfd62e) which connects to C2 domain dtl6.mooo.com (which\n\nresolved to the same IP as the other dtl domains mentioned above) on port 6178 was seen to download LURK0 malware after the\n\ninitial Surtr infection. This LURK0 sample had the campaign code ZQ6 that connects to C2 domain tbwm.wlyf.org on port 3103.\n\nThis domain also resolved to the same IP as the dtl domains.\n\nWe have also found reports of other Surtr stage 2 (GmRemote) samples that have campaign codes which suggest they may be\n\ntargeted at commercial and government targets.\n\nThe first sample was found via ThreatExpert. It uses campaign code kmlg-0308, and connects to a C2 at flyoutside.com. This\n\ndomain and eight others are registered to toucan6712@163.com:\n\nflyoutside.com 67.198.227.162\n\n52showfly.com 112.121.169.189\n\nmydreamfly.com 112.121.186.60\n\ndreaminshy.com 119.42.147.101\n\n52flyfeel.com 119.42.147.101\n\neyesfeel.com 180.178.63.10 (now registered to lili@nuo.cn)\n\noutsidefly.com 74.55.57.85\n\nshowflyfeel.com 199.119.101.40\n\n51aspirin.com not resolving\n\nSearching for more samples in Virus Total Intelligence (VTI) using domains and other identifying features reveals four related\n\n|flyoutside.com|67.198.227.162|\n|---|---|\n|52showfly.com|112.121.169.189|\n|mydreamfly.com|112.121.186.60|\n|dreaminshy.com|119.42.147.101|\n|52flyfeel.com|119.42.147.101|\n|eyesfeel.com|180.178.63.10 (now registered to lili@nuo.cn)|\n|outsidefly.com|74.55.57.85|\n|showflyfeel.com|199.119.101.40|\n|51aspirin.com|not resolving|\n\n\n-----\n\ng g\n\n58ff38412ebbedb611a3afe4b3dbd8b0 – connects to C2 IP 112.121.182.149 (similar to above), campaign code lly-0311\n\n81bc8974967e1c911b107a9a91e3178b – connects to C2 domain www.paulfrank166.2waky.com (192.198.85.102), campaign code 02012116\n\n44758b9a7a6cafd1b8d1bd4c773a2577 – connects to C2 domain www.flyoutside.com (same as the first sample found on ThreatExpert),\ncampaign code lg-0109\n\n\nMost of these samples have campaign codes that suggest commercial targets. However, we do not have information about where\n\nthese samples were submitted from, so the target sector and victims cannot be confirmed.\n\nA second GmRemote sample was found via the web, called Trojan/Subxe.89E1 by Anchiva. This sample connects to\n\ngoogle.djkcc.com and uses campaign code in1102. Other subdomains under djkcc.com include:\n\nairforce.djkcc.com\n\ndomain.djkcc.com\n\ngoogle.djkcc.com\n\nindianembassy.djkcc.com\n\nmailnic.djkcc.com (MailNIC is an Indian email site at the National Informatics Centre)\n\nmicrosoft.djkcc.com\n\nrediffmail.djkcc.com (Rediffmail is an Indian email site)\n\nWhile we do not have information about what victims these samples target, the campaign code, C2 domain, and related\n\nsubdomains give some possible indications.\n\nOne additional find via VTI is a GmRemote sample internally named: GmKeyBoradServer_DLL.dll (MD5\n\ne7e1c69496ad7cf093945d3380a2c6f4).\n\nIt exports functions (GmFunctionType, GmInitPoint, GmMyInitPoint, GmRecvPoint, GmShutPoint, GmVerSion) that are referenced\n\nin other GmRemote samples, although none of them have any real content.\n\nThese additional samples suggest that Surtr is being used to target groups beyond the Tibetan community and is possibly being\n\nutilized by multiple threat actors.\n\n# Conclusions and Recommendations\n\nThe attacks we have observed that use the Surtr malware family are another example of the persistent targeted malware\n\ncampaigns the Tibetan community faces. The specific attack reported in this post demonstrates that attackers are actively monitor\n\nmailing lists and discussion groups used by the Tibetan community and repurpose the content for use in targeted malware\n\nattacks.\n\nFor communities under persistent threat from targeted malware campaigns, user vigilance and education are essential for\n\nreducing risk.\n\nUsers should carefully examine the sender’s email address of emails and exercise caution in opening unexpected or\n\nunsolicited attachments or opening unverified links.\n\nSee Citizen Lab’s Recommendations for defending against targeted cyber threats for additional information, and Tibet\n\nAction Institute’s Detach from Attachments and Think Before You Click campaigns.\n\nThe Citizen Lab is continuing to monitor targeted malware campaigns using Surtr and will post updates as they are available.\n\n–\n\n# Appendix MD5’s & Identifiers\n\n## Email Attachment Names & MD5s:\n\n\n-----\n\n**Stage 1**\n\n\nSection: .text\nMD5 hash: d4f9b3b573a8f1d70d58aa8daf9cb256\nSHA-1 hash: a1d5128cd50959bc7008be1fdfe2cf6339ed7098\nSHA-256 hash: aef9f55931d054dbf027639e30d0abf587696b13d8993aab6c22eb7d47f0de83\n\n\nSection: .rdata\nMD5 hash: e130ff2adbf4515b1af88b451396e1f6\nSHA-1 hash: 248691810ae34407aa3486ef3faca6fe3286f630\nSHA-256 hash: adae7b2306d7fc145ebd90fd1147bc352c56937d58e1996b89d5368cebdb438d\n\n\nSection: .data\nMD5 hash: c4fc864da3ee8462c5c25054f00e703f\nSHA-1 hash: b28a02f68cbacdaa89cf274dc79b3c802a21599d\nSHA-256 hash: 203ca80897fd63ca3fc55ec4be22cd302d5d81729ee8f347bd8f22c73ad1b61d\n\n\nSection: .reloc\nMD5 hash: bc2c349c1f4c338c6834a79c03c461fb\nSHA-1 hash: c71504a96ea72656ef826677a53f9a5230fcb049\nSHA-256 hash: 58c192f73afe761b42493a36ded1a5724f06e14f44304b946341eb46b3bdfa7d\n\n\nThe hashes of the resource section vary based on how much it is padded.\n\nNotable Strings:\n\ncScCssvdcfhgshtj\n\nCrtRunTime.log\n\naCvVpR\n\n_One.dll\n\n_Fra.dll\n\nasasdasrqwfsdvctyqwm\n\nefskdfjaslkfjlaksd\n\ndksfjasdklfjasd\n\ncasfjaklsdjfaskdlf\n\nbakjfasdkljfkldfjaslkd\n\nadskjfksldjfklsad\n\nsoul\n\nLiveUpdata_Mem\\\n\nBurn\\\n\n**Stage 2 (downloaded component)**\n\nMD5: 21aa9dd44738d5bf9d8a8ecf53c3108c\n\nNotable Strings:\n\nx86_GmRemote.dll\n\nMark\n\nD:\\Project\\GTProject\\Public\\List\\ListManager.cpp\n\n# Footnote\n\n\n-----\n\n## Post a Comment\n\nYour email is never shared. Required fields are marked *\n\nName *\n\nEmail *\n\nWebsite\n\nComment\n\nPost Comment\n\n© Citizenlab 2013 | |\nContact RSS\n\n\nPost Comment\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/m57wv4yn4wsa0j2bj6yuj23bzyrq5rg8",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.08.02.Surtr_Targeting_Tibetan/Surtr_Malware_Tibetan.pdf"
    ],
    "report_names": [
        "Surtr_Malware_Tibetan"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716505,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1389824781,
    "ts_modification_date": 1389824781,
    "files": {
        "pdf": "https://archive.orkl.eu/6b624d6d80b412a10260344f244ed93e3718e003.pdf",
        "text": "https://archive.orkl.eu/6b624d6d80b412a10260344f244ed93e3718e003.txt",
        "img": "https://archive.orkl.eu/6b624d6d80b412a10260344f244ed93e3718e003.jpg"
    }
}