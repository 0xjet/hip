{
    "id": "495bc48a-d1be-408a-9fed-b10ef689898c",
    "created_at": "2022-10-25T16:48:21.836302Z",
    "updated_at": "2025-03-27T02:14:34.099832Z",
    "deleted_at": null,
    "sha1_hash": "878dfa6ec75c711215f74a8761c62bd1fbbcf130",
    "title": "Malware Used by “Rocke” Group Evolves to Evade Detection by Cloud Security Products",
    "authors": "",
    "file_creation_date": "2019-01-22T01:40:37Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 758060,
    "plain_text": "# Malware Used by “Rocke” Group Evolves to Evade Detection by Cloud Security Products\n\n**[unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/](https://unit42.paloaltonetworks.com/malware-used-by-rocke-group-evolves-to-evade-detection-by-cloud-security-products/)**\n\nBy Xingyu Jin and Claud Xiao January 17, 2019\n\nPalo Alto Networks Unit 42 recently captured and investigated new samples of the Linux coin mining malware used by\nthe Rocke group. The family was suspected to be developed by the Iron cybercrime group and it’s also associated with\n[the Xbash malware we reported on in September of 2018. The threat actor Rocke was originally revealed by Talos in](https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/)\n[August of 2018 and many remarkable behaviors were disclosed in their blog post. The samples described in this report](https://blog.talosintelligence.com/2018/08/rocke-champion-of-monero-miners.html)\nwere collected in October of 2018, and since that time the command and control servers they use have been shut\ndown.\n\nDuring our analysis, we realized that these samples used by the Rocke group adopted new code to uninstall five\ndifferent cloud security protection and monitoring products from compromised Linux servers. In our analysis, these\nattacks did not compromise these security products: rather, the attacks first gained full administrative control over the\nhosts and then abused that full administrative control to uninstall these products in the same way a legitimate\nadministrator would.\n\nThese products were developed by Tencent Cloud and Alibaba Cloud (Aliyun), the two leading cloud providers in China\nthat are expanding their business globally. To the best of our knowledge, this is the first malware family that developed\nthe unique capability to target and remove cloud security products. This also highlights a new challenge for products\nin the Cloud Workload Protection Platforms market defined by Gartner.\n\nTechnical Details\n\nThe Coin Miner used by Rocke Group\n\nThe threat actor Rocke was first reported by Cisco Talos in late July 2018. The ultimate goal of this threat is to mine\nMonero cryptocurrency in compromised Linux machines.\n\nTo deliver the malware to the victim machines, the Rocke group exploits vulnerabilities in Apache Struts 2, Oracle\nWebLogic, and Adobe ColdFusion. For example, by exploiting Oracle WebLogic vulnerability CVE-2017-10271 in Linux\nshown in Figure 1, a compromised Linux victim machine downloads backdoor 0720.bin and opens a shell.\n\n_Figure 1. Exploit CVE-2017-10271_\n\nOnce the C2 connection is established, malware used by the Rocke group downloads shell script named as “a7” to the\nvictim machine. The behaviors of a7 include:\n\nA hi i t th h j b\n\n\n-----\n\nUninstall agent based cloud security products\nDownload and run UPX packed coin miner from blog[.]sydwzl[.]cn\nHide process from Linux ps command by using the open source tool “libprocesshider” with LD_PRELOAD trick\nAdjust malicious file date time\n\nCloud Workload Protection Platforms\n\n[According to Gartner, Cloud Workload Protection Platforms (CWPPs) are the agent-based workload-centric security](https://www.gartner.com/reviews/market/cloud-workload-protection-platforms)\nprotection solutions. To mitigate the impact of malware intrusion in public cloud infrastructure, cloud service providers\ndevelop their own CWPPs as the server security operation and management products.\n\nFor example, Tencent Cloud offers [Tencent Host Security (HS, aka YunJing云镜) with various security protection](https://intl.cloud.tencent.com/product/hs)\nservices. According to its “Product Overview” document, Tencent Host Security provides key security features like\ntrojan detection and removal based on machine learning, password cracking alert, logging activity audit, vulnerability\nmanagement, and asset management as shown in Figure 2.\n\n_Figure 2. Tencent Host Security Key Features_\n\nAlibaba Cloud (Aliyun) also offers a cloud security product called [Threat Detection Service (TDS, aka Aegis 安骑士).](https://www.alibabacloud.com/products/sas)\nAlibaba Cloud Threat Detection Service provides security services like malware scanning and removal, vulnerability\nmanagement, log analysis, and threat analysis based on big data.\n\nThird-party cybersecurity companies also provide CWPPs. For instance, Trend Micro, Symantec, and Microsoft have\ntheir own cloud security products for public cloud infrastructure. As with all security products, adversaries inevitably\nwork to evade these systems to be able to achieve their ultimate goals.\n\nEvading Detection from Cloud Workload Protection Platforms\n\n\n-----\n\nRocke group gradually developed the capability to evade detection before exhibiting any malicious behaviors. To be\nmore specific, the malware uninstalls cloud security products by Alibaba Cloud and Tencent Cloud.\n\nIn the early version of the malware used by Rocke, it only attempts to kill Tencent Cloud Monitor process as shown in\nFigure 3.\n\n_Figure 3. Malware kills Tencent Cloud Monitor process_\n\nRealizing that killing the cloud monitor service alone is not enough to evade detection by agent-based cloud security\nproducts, the malware authors continued developing more effective methods to evade detection by killing more agentbased cloud security services.\n\nThe Tencent Cloud and Alibaba Cloud official websites provide documents to guide users about how to uninstall their\ncloud security products. The document for uninstalling Alibaba Threat Detection Service is shown in Figure 4.\n\n_Figure 4. Official guide for uninstalling Alibaba Threat Detection Service_\n\nThe document for uninstalling Tencent Cloud Host Security is shown in Figure 5.\n\n\n-----\n\n_Figure 5. Official guide for uninstalling Tencent Cloud Host Security Product_\n\nThe malware used by the Rocke group follows the uninstallation procedure provided by Alibaba Cloud and Tencent\nCloud as well as some random blog posts on the Internet. The key uninstall function is shown in Figure 6.\n\n_Figure 6. Key function for malware to evade detection_\n\nThis function can uninstall:\n\n1. Alibaba Threat Detection Service agent.\n2 Alib b Cl dM it t (M it CPU & ti t k ti it )\n\n\n-----\n\n5. Tencent Cloud Monitor agent.\n\nAfter agent-based cloud security and monitor products are uninstalled, the malware used by the Rocke group begins to\nexhibit malicious behaviors. We believe this unique evasion behavior will be the new trend for malware which targets\npublic cloud infrastructure.\n\nMitigations\n\nPalo Alto Networks Unit 42 has been cooperating with Tencent Cloud and Alibaba Cloud to address the malware\nevasion problem and its C2 infrastructure. Additionally, the malicious C2 domains are identified by our PAN-DB URL\nFiltering.\n\nConclusion\n\nPublic cloud infrastructure is one of the main targets for this cybercrime group. Realizing the existing cloud monitor\nand security products may detect the possible malware intrusion, malware authors continue to create new evasion\ntechnologies to avoid being detected by cloud security product.\n\nThe variant of the malware used by the Rocke group is an example that demonstrates that the agent-based cloud\nsecurity solution may not be enough to prevent evasive malware targeted at public cloud infrastructure.\n\n# Indicators of Compromise\n\n**Samples with the evasion behavior**\n\n2e3e8f980fde5757248e1c72ab8857eb2aea9ef4a37517261a1b013e3dc9e3c4\n\n2f603054dda69c2ac1e49c916ea4a4b1ae6961ec3c01d65f16929d445a564355\n\n28ea5d2e44538cd7fec11a28cce7c86fe208b2e8f53d57bf8a18957adb90c5ab\n\n232c771f38da79d5b8f7c6c57ddb4f7a8d6d44f8bca41be4407ed4923096c700\n\n893bdc6b7d2d7134b1ceb5445dbb97ad9c731a427490d59f6858a835525d8417\n\n9300f1aa56a73887d05672bfb9862bd786230142c949732c208e5e019d14f83a\n\n27611b92d31289d023d962d3eb7c6abd194dbdbbe4e6977c42d94883553841e8\n\nd341e3a9133e534ca35d5ccc54b8a79f93ff0c917790e7d5f73fedaa480a6b93\n\ned038e9ea922af9f0bf5e8be42b394650fa808982d5d555e6c50c715ff2cca0c\n\n4b74c4d66387c70658238ac5ab392e2fe5557f98fe09eadda9259ada0d87c0f1\n\ne391963f496ba056e9a9f750cbd28ca7a08ac4cfc434bee4fc57a292b11941e6\n\n017dee32e287f37a82cf6e249f8a85b5c9d4f090e5452118ccacaf147e88dc66\n\n**Domains for C2 Communication**\n\ndwn[.]rundll32[.]ml\n\nwww[.]aybc[.]so\n\na[.]ssvs[.]space\n\nsydwzl[.]cn\n\n**IPs for C2 Communication**\n\n118.24.150[.]172 (on Tencent Cloud)\n\n120.55.54[.]65 (on Alibaba Cloud)\n\n**URLs for Code Update**\n\n\n-----\n\nhxxps://pastebin[.]com/raw/rjPGgXQE\n\nhxxps://pastebin[.]com/raw/1NtRkBc3\n\nhxxps://pastebin[.]com/raw/tRxfvbYN\n\nhxxps://pastebin[.]com/raw/SSCy7mY7\n\nhxxps://pastebin[.]com/raw/VVt27LeH\n\nhxxps://pastebin[.]com/raw/Fj2YdETv\n\nhxxps://pastebin[.]com/raw/JNPewK6r\n\nhxxps://pastebin[.]com/raw/TzBeq3AM\n\nhxxps://pastebin[.]com/raw/eRkrSQfE\n\nhxxps://pastebin[.]com/raw/5bjpjvLP\n\nhxxps://pastebin[.]com/raw/Gw7mywhC\n\n**XMR Wallet Address**\n\n42im1KxfTw2Sxa716eKkQAcJpS6cwqkGaHHGnnUAcdDhG2NJhqEF1nNRwjkBsYDJQtDkLCTPehfDC4zjMy5hefT81Xk2h7V.v7\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.01.17.Rocke_Group/Malware%20Used%20by%20Rocke%20Group%20Evolves%20to%20Evade%20Detection%20by%20Cloud%20Security%20Products.pdf"
    ],
    "report_names": [
        "Malware Used by Rocke Group Evolves to Evade Detection by Cloud Security Products"
    ],
    "threat_actors": [
        {
            "id": "7c053836-8f50-4d40-bc5c-7088967e1b57",
            "created_at": "2022-10-25T16:07:24.549525Z",
            "updated_at": "2025-03-27T02:02:10.278474Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra",
                "Iron Group",
                "Rocke"
            ],
            "source_name": "ETDA:Rocke",
            "tools": [
                "Godlua",
                "Kerberods",
                "LSD",
                "Pro-Ocean",
                "Xbash"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "905eabd9-2b7f-483d-86bd-0c72f96b4162",
            "created_at": "2023-01-06T13:46:39.02749Z",
            "updated_at": "2025-03-27T02:00:02.980813Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Aged Libra"
            ],
            "source_name": "MISPGALAXY:Rocke",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "0b02af5f-2027-42b7-a6f2-51e2fd49ba7f",
            "created_at": "2022-10-25T15:50:23.360509Z",
            "updated_at": "2025-03-27T02:00:55.45329Z",
            "deleted_at": null,
            "main_name": "Rocke",
            "aliases": [
                "Rocke"
            ],
            "source_name": "MITRE:Rocke",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716501,
    "ts_updated_at": 1743041674,
    "ts_creation_date": 1548121237,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/878dfa6ec75c711215f74a8761c62bd1fbbcf130.pdf",
        "text": "https://archive.orkl.eu/878dfa6ec75c711215f74a8761c62bd1fbbcf130.txt",
        "img": "https://archive.orkl.eu/878dfa6ec75c711215f74a8761c62bd1fbbcf130.jpg"
    }
}