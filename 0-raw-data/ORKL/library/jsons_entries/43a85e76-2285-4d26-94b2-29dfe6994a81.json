{
    "id": "43a85e76-2285-4d26-94b2-29dfe6994a81",
    "created_at": "2023-01-12T15:06:47.657096Z",
    "updated_at": "2025-03-27T02:16:17.290623Z",
    "deleted_at": null,
    "sha1_hash": "11a56b3cac8f8e2c6da774ce11a7c2888c980b80",
    "title": "2022-04-02 - Cyber Espionage Actor Deploying Malware Using Excel",
    "authors": "",
    "file_creation_date": "2022-05-28T16:50:08Z",
    "file_modification_date": "2022-05-28T16:50:08Z",
    "file_size": 305469,
    "plain_text": "# Cyberespionage Actor Deploying Malware Using Excel\n\n**[govinfosecurity.com/cyber-espionage-actor-deploying-malware-using-excel-a-18830](https://www.govinfosecurity.com/cyber-espionage-actor-deploying-malware-using-excel-a-18830)**\n\n[Cybercrime,](https://www.govinfosecurity.com/cybercrime-c-416) [Cybercrime as-a-service,](https://www.govinfosecurity.com/cybercrime-as-a-service-c-417) [Cyberwarfare / Nation-State Attacks](https://www.govinfosecurity.com/cyberwarfare-nation-state-attacks-c-420)\n\nThreat Actors Luring Ukrainian Phishing Targets to Download Malicious Files [Prajeet Nair](https://www.govinfosecurity.com/authors/prajeet-nair-i-3483)\n[(@prajeetspeaks) â€¢ April 2, 2022](https://www.twitter.com/@prajeetspeaks)\n\nExample of email lure used by attackers (Source: Malwarebytes)\nResearchers have found that cyberespionage actor UAC-0056, also known as SaintBear,\nUNC2589 and TA471, is now using a macro-embedded Excel document to target several\n[entities in Ukraine, including ICTV, a private TV channel.](https://twitter.com/h2jazi/status/1509382428296728580)\n\n**See Also:** [2021 Cost Of A Data Breach](https://www.govinfosecurity.com/whitepapers/2021-cost-data-breach-w-10190)\n\n\"Unlike previous attacks that were trying to convince victims to open a URL and download a\nfirst-stage payload or distributing fake translation software, in this campaign the threat actor\nis using a spear-phishing attack that contains macro-embedded Excel documents,\"\n[researchers at cybersecurity firm Malwarebytes say.](https://blog.malwarebytes.com/threat-intelligence/2022/04/new-uac-0056-activity-theres-a-go-elephant-in-the-room/)\n\n[The UAC-0056 group, which cybersecurity firm SentinelOne recently reported was targeting](https://www.sentinelone.com/blog/threat-actor-uac-0056-targeting-ukraine-with-fake-translation-software/)\nUkrainians with fake translation software, is known to have performed a wiper attack in\nJanuary 2022 on multiple Ukrainian government computers and websites.\n\n\n-----\n\nIn March, [Cert-UA reported the group targeting state organizations in Ukraine using](https://cert.gov.ua/article/37704)\nmalicious implants called GrimPlant, GraphSteel and Cobalt Strike Beacon.\n\n[The group is also known to have performed the WhisperGate disruptive attack against the](https://www.databreachtoday.asia/feds-advise-shields-up-as-russian-cyberattack-defense-a-18619)\nUkrainian government entities in early 2022.\n\n## Technical Analysis\n\nThe attack starts with a phishing email in which a document attachment containing a\nmalicious macro drops an embedded payload. Then, further payloads are downloaded from\nthe attacker server in Base64 format.\n\nThe researchers observed phishing emails being distributed from at least March 23 to March\n28, with the subject \"wage arrears\" and with the body of all the emails containing a similar\nmessage: \"Wage arrears. Updated automatically. Please send your offer to reduce your\nsalary arrears.\" The attached document contains a similar message to the email body: \"This\ndocument contains an embedded macro that drops the first stage payload called 'baseupdate.exe'. The payload has been saved in a 'very hidden sheet' named\n'SheetForAttachedFile,'\" the researchers say.\n\nMalwarebytes researchers found that this sheet contains the filename, the date the payload\nis attached (March 21, 2022), the file size and the content of the attached file in hex format.\n\n\"The macro reads the content of the embedded file in the hidden sheet and writes it into the\ndefined location for this payload which is the 'AppDataLocalTemp' directory. The macro used\nby the actor is taken from a website that described and provided code for a method to attach\nand extract the files from an Excel workbook,\" the researchers say.\n\nExample of decoy Excel document (Source: Malwarebytes)\n\n\n-----\n\n## Extracted Files\n\n**Elephant Dropper**\n\nResearchers say that the Elephant dropper is the initial executable deployed in this attack; it\nis a simple dropper that deploys further stages. This dropper is written in the Go\nprogramming language and is signed with a stolen Microsoft certificate.\n\n\"The strings in the binary suggest that it was actually named as Elephant Dropper by the\nattackers themselves,\" the researchers say. \"It checks if the 'C:Users{user}.java-sdk'\ndirectory exists on the system and creates it if it does not. The strings in the binary are\nencoded and are only decoded when they are required to be used.\"\n\nThe dropper also decodes the command-and-control address from a string and then\ndownloads a Base64 encoded binary from the C2 and writes it to \"C:Users{user}.javasdkjava-sdk.exe.\"\n\n**Elephant Downloader**\n\nElephant Downloader, which is also written in the Go programming language, is executed by\nthe Dropper. The purpose of this payload is to maintain persistence and to deploy the next\ntwo stages of the attack.\n\n\"The strings in this executable are encoded in the same way as in the Dropper. It makes\nitself persistent through the auto-run registry key,\" the researchers say. \"The downloader is\nresponsible for getting the implant and the client; the URL paths for the payloads are stored\nin encoded form in the binary. It downloads the implant and the client.\"\n\nIn the next stage, the Elephant downloader decodes the file names, which are also stored in\nan encoded format and create a file. The file name of the implant is oracle-java.exe, and the\nclient is microsoft-cortana.exe.\n\n**Elephant Implant**\n\nElephant Implant, also tracked as GrimPlant backdoor, seems to be one of the most\nimportant payloads in this attack, the researchers say. They describe how it communicates\nwith the C2 on port 80 and gets the C2 address encrypted from its parent process.\n\n\"The implant makes use of gRPC to communicate with the C2, it has a TLS certificate\nembedded in the binary and makes use of SSL/TLS integration in gRPC. This allows the\nmalware to encrypt all the data that is being sent to the C2 via gRPC,\" the researchers say.\n\nThis implant also uses the MachineID library to derive a unique ID for each machine and\ngets the IP address of the machine by making a request to https://api.ipify.org/.\n\n\n-----\n\nThe implant collects information related to the OS in a function named GetOSInfo. As part of\nthis, the malware collects the hostname, OS name and number of CPUs in the system, and a\nfunction named GetUserInfo collects name, username and path to Home directory of the\ncurrent user.\n\n**Elephant Client**\n\nThe last payload that the researchers detailed is named elephant_client by the actor. It is\nalso tracked as the GraphSteel backdoor. This final payload is a data stealer, the\nresearchers say.\n\n\"Similar to other payloads in this attack chain, this payload receives the C2 server as a\nparameter in Base64 format which is AES encrypted format of the server. Decoding the\nBase64 string gives the C2 IP address in AES encrypted format. The actor uses a key to\nAES decrypt (ECB-NoPadding mode) the C2 address,\" the researchers say.\n\nUpon successful connection with its C2 server, it starts collecting data and exfiltrating it into\nthe server.\n\nInitially, it collects basic information about the users and sends it to the server. The collected\ndata is Base64 encoded and includes hostname, OS name(windows), number of CPUs, IP\naddress, Name, Username and home directory.\n\nOnce this is finished, the client tries to steal credentials from the victim's machine. The actor\nsteals data from these services: Browser credentials, Wi-Fi information, Credentials manager\ndata, Mail accounts, Putty connections data and Filezilla credentials.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-02 - Cyber Espionage Actor Deploying Malware Using Excel.pdf"
    ],
    "report_names": [
        "2022-04-02 - Cyber Espionage Actor Deploying Malware Using Excel.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c28760b2-5ec6-42ad-852f-be00372a7ce4",
            "created_at": "2022-10-27T08:27:13.172734Z",
            "updated_at": "2025-03-27T02:00:55.511386Z",
            "deleted_at": null,
            "main_name": "Ember Bear",
            "aliases": [
                "Ember Bear",
                "UNC2589",
                "Bleeding Bear",
                "DEV-0586",
                "Cadet Blizzard",
                "Frozenvista",
                "UAC-0056"
            ],
            "source_name": "MITRE:Ember Bear",
            "tools": [
                "P.A.S. Webshell",
                "CrackMapExec",
                "ngrok",
                "WhisperGate",
                "Saint Bot",
                "PsExec",
                "Rclone",
                "Impacket",
                "OutSteel"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "083d63b2-3eee-42a8-b1bd-54e657a229e8",
            "created_at": "2022-10-25T16:07:24.143338Z",
            "updated_at": "2025-03-27T02:02:10.12138Z",
            "deleted_at": null,
            "main_name": "SaintBear",
            "aliases": [
                "Ember Bear",
                "FROZENVISTA",
                "Lorec53",
                "Nascent Ursa",
                "Nodaria",
                "SaintBear",
                "Storm-0587",
                "TA471",
                "UAC-0056",
                "UNC2589"
            ],
            "source_name": "ETDA:SaintBear",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Elephant Client",
                "Elephant Implant",
                "GraphSteel",
                "Graphiron",
                "GrimPlant",
                "OutSteel",
                "Saint Bot",
                "SaintBot",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "eecf54a2-2deb-41e5-9857-fed94a53f858",
            "created_at": "2023-01-06T13:46:39.349959Z",
            "updated_at": "2025-03-27T02:00:03.057647Z",
            "deleted_at": null,
            "main_name": "SaintBear",
            "aliases": [
                "UAC-0056",
                "Nascent Ursa",
                "Nodaria",
                "FROZENVISTA",
                "Storm-0587",
                "Lorec53",
                "Lorec Bear",
                "UNC2589",
                "TA471",
                "DEV-0587",
                "Saint Bear",
                "EMBER BEAR",
                "Bleeding Bear"
            ],
            "source_name": "MISPGALAXY:SaintBear",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "03a6f362-cbab-4ce9-925d-306b8c937bf1",
            "created_at": "2024-11-01T02:00:52.635907Z",
            "updated_at": "2025-03-27T02:00:55.474243Z",
            "deleted_at": null,
            "main_name": "Saint Bear",
            "aliases": [
                "Saint Bear",
                "Storm-0587",
                "TA471",
                "UAC-0056",
                "Lorec53"
            ],
            "source_name": "MITRE:Saint Bear",
            "tools": [
                "OutSteel",
                "Saint Bot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536007,
    "ts_updated_at": 1743041777,
    "ts_creation_date": 1653756608,
    "ts_modification_date": 1653756608,
    "files": {
        "pdf": "https://archive.orkl.eu/11a56b3cac8f8e2c6da774ce11a7c2888c980b80.pdf",
        "text": "https://archive.orkl.eu/11a56b3cac8f8e2c6da774ce11a7c2888c980b80.txt",
        "img": "https://archive.orkl.eu/11a56b3cac8f8e2c6da774ce11a7c2888c980b80.jpg"
    }
}