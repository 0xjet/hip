{
    "id": "cb83af8e-c8f1-4c93-84e2-8a096a50bbdf",
    "created_at": "2022-10-25T16:48:19.80776Z",
    "updated_at": "2025-03-27T02:13:58.841597Z",
    "deleted_at": null,
    "sha1_hash": "a486fb5b0b485796f0b2d1248c948e7c64c6b49a",
    "title": "The Heartbeat Apt Campaign",
    "authors": "Trend Micro",
    "file_creation_date": "2012-12-21T14:33:39Z",
    "file_modification_date": "2012-12-21T14:33:51Z",
    "file_size": 3138306,
    "plain_text": "##### Trend Micro Incorporated\n Research Paper\n 2012\n\n# The HeartBeat APT Campaign\n\n###### Roland Dela Paz\n\n\n-----\n\n#### Contents\n\nAbout This Paper................................................................................................................................... 1\nIntroduction............................................................................................................................................ 1\nCampaign Targets................................................................................................................................. 2\nContext.................................................................................................................................................... 2\nAttack Vector......................................................................................................................................... 3\nInfection Flow........................................................................................................................................4\nThe RAT Component............................................................................................................................5\n\nBackdoor Functionalities.............................................................................................................5\nInstallation and Persistence........................................................................................................5\nC&C Communication.....................................................................................................................6\nCommand and Control.........................................................................................................................8\nHeartBeat Campaign Codes and Decoy Documents....................................................................8\nRelationships among C&C Domains, IPs, and Campaigns...........................................................9\nAttribution.............................................................................................................................................10\nConclusion.............................................................................................................................................10\nTimeline..................................................................................................................................................10\nDefending against the HeartBeat Campaign.................................................................................11\nTrend Micro Threat Protection Against The HeartBeat Campaign Components.................12\n\n\n-----\n\n#### About This Paper Introduction\n\nThis paper exposes a targeted attack called “HeartBeat,” Today’s cybercriminals try to infect as many users as\nwhich has been persistently pursuing the South Korean possible. Their goal is simple—to monetize the resources or\ngovernment and related organizations since 2009. This data from infected machines in any way they can. Behind\npaper will discuss how their specifically crafted campaigns such attacks are highly covert targeted campaigns known\ninfiltrate their targets. as APTs.\n\nCompared to most advanced persistent threat (APT) While targeted campaigns continue to increase, research\ncampaigns with diverse targeted industries, the HeartBeat efforts by the security industry reveal that some of these\ncampaign is an isolated case. Furthermore, we will examine attacks have existed for several years.[1] Depending on the\ntheir attack methodologies which include their attack motive, APT campaigns may attack various industries,\nvector, the remote administration tool (RAT) component, organizations or communities from different regions and\nand command-and-control servers. Finally, we will discuss countries. For instance, the Luckycat campaign targeted\nhow this information can be useful in developing defensive the aerospace, energy, engineering, shipping, and military\nstrategies in protecting organizations as well as predicting research industries in India and Japan.[2] Additionally,\nfuture targets. they targeted the Tibetan activists’ community. The\n\nIXESHE campaign, on the other hand, targeted East Asian\ngovernments, Taiwanese electronics manufacturers,\nand a telecommunications company.[3] While most of\nthese campaigns have multiple targets, smaller, more\nsubtle campaigns with exceedingly specific targets are\nalso present. The Taidoor campaign is an example of\nthis, where all of the compromise victims were from\nTaiwan, and the majority of which were government\norganizations.[4]\n\nThis research paper will delve into a targeted campaign\nthat targets organizations and communities within South\nKorea. We call this malicious operation the “HeartBeat\ncampaign.”\n\n1 [http://www.trendmicro.com/cloud-content/us/pdfs/security-](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_dissecting-lurid-apt.pdf)\n[intelligence/white-papers/wp_dissecting-lurid-apt.pdf](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_dissecting-lurid-apt.pdf)\n[2 http://www.trendmicro.com/cloud-content/us/pdfs/security-](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_luckycat_redux.pdf)\n\n[intelligence/white-papers/wp_luckycat_redux.pdf](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_luckycat_redux.pdf)\n[3 http://www.trendmicro.com/cloud-content/us/pdfs/security-](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_ixeshe.pdf)\n\n[intelligence/white-papers/wp_ixeshe.pdf](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_ixeshe.pdf)\n\n\n-----\n\n#### Campaign Targets Context\n\nThe HeartBeat campaign appears to target government The first HeartBeat campaign remote access tool (RAT)[5]\norganizations and institutions or communities that are component was discovered in June 2012 in a Korean\nin some way related to the South Korean government. newspaper company network. Further investigation\nSpecifically, we were able to identify the following targets: revealed that the campaign has been actively distributing\n\ntheir RAT component to their targets in 2011 and the first\n\n       - Political parties half of 2012. Furthermore, we uncovered one malware\n\ncomponent that dates back to November 2009. This\n\n       - Media outfits indicates that the campaign started during that time or\n\nearlier.\n\n       - A national policy research institute\n\nEarlier versions of the HeartBeat campaign’s RAT\n\n       - A military branch of South Korean armed forces component contained the following strings in their codes:\n\n       - A small business sector organization Thus, the campaign name “HeartBeat.”\n\n       - Branches of South Korean government\n\nThe profile of their targets suggests that the motive\nbehind the campaign may be politically motivated.\n\n_Figure 1. Code used in the HeartBeat campaign’s RAT component_\n\n\n-----\n\nBased on the samples we collected, the campaign’s decoy\n\n#### Attack Vector\n\ndocuments used the file formats .JPG, .PDF, XLS, and HWP,\nthe Korean government standard word processor format.\nOne of the previous HeartBeat attacks even dropped a\npornographic .JPG image as decoy. Below is a screenshot\n\nIn order to gain control over targets systems, HeartBeat\n\nof a Hangul Word Processor (.HWP) document used as bait\n\nperpetrators install a RAT in prospective victims’ systems.\n\nin November 2011. Its document title roughly translates to\n\nThis RAT arrives as a disguised or fake document which\n\n“Information to the President.hwp.”\n\nis actually a bundled file. The bundled file contains both\na decoy document and the RAT installer that has been\npackaged together using a binder tool. Once it runs, the\ndecoy document is displayed to the user while the RAT\nunknowingly executes in the background.\n\nIt is unclear how these packaged files specifically arrive on\nvictims’ systems, but we highly suspect that spearphishing\nemails[6] containing these packaged malware were primarily\nused to distribute them. In fact, the packaged malware\nused the icon of the decoy document in order to look\nlegitimate. For instance, if the decoy is an XLS file, the\npackage will appear to have an XLS document icon. In\naddition, some of the decoy files required passwords in\norder to be viewed.\n\n_Figure 3. A decoy .HWP document_\n\n_Figure 2. Example of a decoy Adobe Reader document_\n\nThe previously mentioned techniques are commonly used\nin spearphishing attacks where prospective victims are\nlured to open a seemingly benign document attachment.\nIn order to appear more legitimate, some of these emails\ncontain password protected documents. A password is\nthen provided in the email body as a social engineering\ntechnique.\n\n\n-----\n\n#### Infection Flow\n\nOnce users open the packaged malicious file, the actual document is displayed to the user while a RAT installer in\n.EXE format runs in the background. The RAT installer, on the other hand, drops a .DLL file that is then injected to the\nlegitimate process svchost.exe. The injected code in svchost.exe then connects to the malware command and control\n(C&C) server to register infection and wait for remote commands.\n\n_Figure 4. Infection diagram for the HeartBeat campaign_\n\nTREND MICRO INCORPORATED TREND MICRO INC.\n\nTrend Micro Incorporated (TYO: 4704; TSE: 4704), a global cloud security 10101 N. De Anza Blvd.\nleader, creates a world safe for exchanging digital information with its In­ Cupertino, CA 95014\nternet content security and threat management solutions for businesses\nand consumers. A pioneer in server security with over U.S. toll free: 1 +800.228.5651\n20 years’ experience, we deliver top-ranked client, server and cloud- Phone: 1 +408.257.1500\nbased security that fits our customers’ and partners’ needs, stops Fax: 1 +408.257.2003\nnew threats faster, and protects data in physical, virtualized and cloud www.trendmicro.com\nenvironments. Powered by the industry-leading Trend Micro™ Smart Pro­\ntection Network™ cloud computing security infrastructure, our products\nand services stop threats where they emerge—from the Internet. They are\nsupported by 1,000+ threat intelligence experts around the globe.\n\n\n-----\n\nThe RAT installer in turn drops a .DLL component which\n\n#### The RAT Component\n\ncontains the backdoor capabilities. In order to stay hidden,\nthe .DLL uses file names similar to legitimate applications.\nBelow is a list of file names used:\n\n##### Backdoor Functionalities • %Program Files%\\Common Files\\Services\\6to4nt.dll\n\n_•_ _%Program Files%\\Common Files\\System\\6to4nt.dll_\n\nThe HeartBeat campaign’s RAT component allows\nattackers to remotely execute the following commands on\n\n_•_ _%Program Files%\\Windows NT\\Accessories\\6to4nt.dll_\n\naffected hosts:\n\n_•_ _%Program Files%\\Windows NT\\htrn.dll_\n\n       - List running processes and their respective process\n\nIDs\n\n_•_ _%Program Files%\\Windows NT\\htrn_jls.dll_\n\n       - Download and execute file(s)\n\n_•_ _%Program Files%\\Windows NT\\hyper.dll_\n\n       - Update itself\n\n_•_ _%System%\\Network Remote.dll_\n\n       - Uninstall itself\n\n_•_ _%System%\\SvcHost.dll_\n\n       - Create or terminate a process\n\nSome these dropped .DLL files use fake file properties\nin order to not appear suspicious. The following is an\n\n       - List available removable and fixed drives\n\nexample:\n\n       - List existing files and their creation date/time\n\n       - Upload file(s)\n\n       - Delete file(s)\n\n       - Get the file creation date/time of a specific file\n\n       - Open a remote command shell access\n\n       - Reboot the system\n\nThese commands give the attackers complete control over\ntheir victims’ systems. Attackers also have the option to\nuninstall the RAT any time to cover their tracks and avoid\nbeing discovered.\n\n##### Installation and Persistence\n\nThe RAT installer is initially dropped and executed by the\npackaged file using any of the following file names:\n\n_•_ _%System%\\msrt.exe_\n\n_•_ _%Program Files%\\Common Files\\AcroRd32.exe_\n\n_•_ _%Program Files%\\Common Files\\config.exe_\n\n_Figure 5. A.DLL that uses fake file properties_\n\n\n-----\n\nIn some cases, the RAT installer drops 2 .DLL files where C&C Communication\none of the .DLLs serves as a loader of the other .DLL file\nwhich contains the backdoor payload.\n\nOnce the RAT’s .DLL component has been injected to\n\nThe .DLL component is then registered as a service _svchost.exe, the malware attempts to register itself to the_\nthrough the following added registries: C&C server by sending the following information from the\n\naffected system:\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\{service name}     - Computer name\nType = “20”\nStart = “2”     - Local IP address\nErrorControl = “1”\nImagePath = “%SystemRoot%\\System32\\svchost.exe     - Service pack\n-k netsvcs”\nObjectName = “LocalSystem”\n\nThese data are sent along with a campaign code and the\nstring “qawsed”. While the “qawsed” string is not present\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\n\nin earlier versions of their RAT, we suspect that the\n\nServices\\{service name}\\Parameters\nServiceDll = C:\\Program Files\\Windows NT\\htrn. attackers only recently added this as a default campaign\ndll password.\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\nServices\\{service name}\\Security The RAT’s C&C communication is encrypted with XOR\nSecurity = {values} encryption using a single byte key, 02H. Furthermore, the\n\ndata being transferred and received by the RAT C&C are\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\\n\n800H (2,048 bytes) in size.\n\nServices\\{service name}\\Enum\n0 = “Root\\LEGACY_{service name}\\0000”\nCount = “1”\nNextInstance = “1”\n*{service name} may be “6to4”, “Ias” or\n“Irmon”.\n\nThe service is then invoked once installed. This results\nin the .DLL being injected to svchost.exe process. This\nregistry modification allows the RAT to execute upon every\nsystem startup.\n\nAfter installation the RAT installer deletes itself, which\nleaves only the disguised .DLL and related registry entries\non the affected system.\n\nNote that the presence of any of the files or registries\nabove may be an indication of a possible HeartBeat\ninfection in a system.\n\n_Figure 6. RAT’s encryption algorithm before sending data to its_\n\n_C&C server_\n\n\n-----\n\n_Figure 7. RAT’s decryption code upon receiving data from the C&C server_\n\nDuring the RAT’s phone home, the following TCP traffic is observed on the network:\n\nWhen decrypted, the above traffic looks as follows:\n\nThe majority of the RAT variants used port 80. Recent Earlier RAT variants did not use encryption on their C&C\nvariants, however, were observed to use port 443. Other communication. Moreover, they only sent the computer\nports we have seen being utilized are port 5600 and port name and campaign code during phone home. Below is a\n_8080._ screenshot of the unencrypted C&C communication.\n\n\n-----\n\n|Campaign code|Password|\n|---|---|\n|1119HWP|None|\n|kris0315|None|\n|PDF-0417|None|\n|gh-0525|None|\n|0909-jpg|qawsed|\n|0916|qawsed|\n|jpg-jf-0925|qawsed|\n|army-1022|qawsed|\n|1103-ghui|qawsed|\n|1113-minzhu|qawsed|\n|ajh7884@han|qawsed|\n|001|qawsed|\n|0305-ziyoudang|qawsed|\n|0326-xuehui|qawsed|\n|0328-junf|qawsed|\n|0329-mnd|qawsed|\n|1q2w3e4r|None|\n|0520-tiegang|qawsed|\n|guohui-0604|qawsed|\n\n|Domain|IP Address|\n|---|---|\n|ahnlab.myfw.us|XXX.XXX.217.123 /XXX.XX.121.84|\n|kissyou01.myfw.us|XX.XXX.203.122 / XX.XXX.20.103|\n|kita.myfw.us|XXX.XXX.217.123 / XXX.XX.121.84|\n|login.sbs.com.PassAs.us|XXX.XXX.178.50|\n|mail2.myfw.us|XX.XXX.15.63 / XXX.XXX.198.93|\n|park007.myfw.us|unknown|\n|snrp.UglyAs.com|XXX.XXX.169.45|\n|www.banking.com.PassAs.us|XXX.XXX.178.50|\n|www.huyang.go.kr.PassAs.us|XXX.XXX.217.123 / XX.XXX.136.115|\n|www.kinu.or.kr.rr.nu|XXX.XXX.178.50|\n|www.kndu.ac.kr.myfw.us|XXX.XXX.4.180|\n|young03.myfw.us|XX.XXX.203.122|\n\n\nThe C&C traffic size also varied in previous versions. Some\n\n#### HeartBeat Campaign Codes and Decoy\n\nearly variants used traffic that are 28H (40 bytes) and\n1004H (4,100 bytes) in size. Documents\n\nAdditionally, the port, C&C address, campaign code and\npassword are hardcoded in the RAT’s malware body\nin plain text. In some RAT versions, however, they are The campaign codes and decoy documents used by the\nencrypted and are decrypted only during run-time, HeartBeat attackers provided valuable insights on their\npossibly to protect the RAT from static analysis by security campaigns. In fact, majority of their campaign codes\nresearchers. included number combinations which represented the\n\nmonth and date in MMDD format when the attack attempt\n\nThese variations in their RAT component indicate that it was executed. The rest of the campaign code string\nhas since been undergoing development. often describes the decoy document that was used in a\n\nspecific campaign. For instance, a campaign code from\nOctober 2011 is “army-1022” where attackers used a decoy\n\n#### Command and Control\n\ndocument containing military-related information.\n\nCampaign code Password\n\nThe HeartBeat campaign’s C&C domains appear to utilize 1119HWP _None_\na site redirection service. Their C&C sites redirect to IP kris0315 _None_\naddresses from ISPs in Armenia, USA, Japan, India and\n\nPDF-0417 _None_\n\nKorea. We observed that they updated the IP address\n\ngh-0525 _None_\n\nof some of their C&C domains. Likewise, all of their IP\naddresses belong to legitimate ISPs. Considering this, 0909-jpg qawsed\nwe suspect that these IP addresses are compromised 0916 qawsed\nhosts that act as proxy servers which redirects traffic to jpg-jf-0925 qawsed\nthe actual C&C servers. Again, this adds another layer of\n\narmy-1022 qawsed\n\nanonymity to the HeartBeat perpetrators.\n\n1103-ghui qawsed\n\n1113-minzhu qawsed\n\nDomain IP Address\n\najh7884@han qawsed\n\n_ahnlab.myfw.us_ _XXX.XXX.217.123 /XXX.XX.121.84_\n\n001 qawsed\n\n_kissyou01.myfw.us_ _XX.XXX.203.122 / XX.XXX.20.103_\n\n0305-ziyoudang qawsed\n\n_kita.myfw.us_ _XXX.XXX.217.123 / XXX.XX.121.84_\n\n0326-xuehui qawsed\n\n_login.sbs.com.PassAs.us_ _XXX.XXX.178.50_\n\n0328-junf qawsed\n\n_mail2.myfw.us_ _XX.XXX.15.63 / XXX.XXX.198.93_\n\n0329-mnd qawsed\n\n_park007.myfw.us_ _unknown_\n\n1q2w3e4r _None_\n\n_snrp.UglyAs.com_ _XXX.XXX.169.45_\n\n0520-tiegang qawsed\n\n_www.banking.com.PassAs.us_ _XXX.XXX.178.50_\n\nguohui-0604 qawsed\n\n_www.huyang.go.kr.PassAs.us_ _XXX.XXX.217.123 / XX.XXX.136.115_\n\n_www.kinu.or.kr.rr.nu_ _XXX.XXX.178.50_ _Table 2. Campaign codes used_\n\n_www.kndu.ac.kr.myfw.us_ _XXX.XXX.4.180_\n\nOn the other hand, decoy documents’ contents were\n\n_young03.myfw.us_ _XX.XXX.203.122_\n\nalso very specific to their targets. For example, some of\nthese documents included logos of specific groups. This\n\n_Table 1. List of HeartBeat C&Cs_\n\ninformation helped us identify their targeted organizations\nand communities in their previous campaigns.\n\n\n-----\n\n-----\n\n|Campaign Date (MM/DD/YY)|MD5 (.DLL component)|Compile Date (MM/DD/YY)|\n|---|---|---|\n|11/19/09|7c6b44d8d87898e7e5deeeb1961b5ae6|9/17/2009|\n|03/15/11|fcf42cadb3a932989c8e2b29cef68861|12/24/2010|\n|04/17/11|aab129ffd3bf5ceeae2e0f332217bebc|3/18/2011|\n|05/25/11|86547d674e7c7da55e8cae359819832f|5/6/2011|\n|09/09/111|f947e63b14853a69b8ed2648869b5e10|7/25/2011|\n|09/16/11|7f1a633384ec97fae9d95d1df9e1135a|7/25/2011|\n|09/25/11|8816c5be1305488019769c81259dad2a|9/21/2011|\n|10/22/11|874025a66c2b9d9831c03d1bc114876a|10/17/2011|\n|11/03/11|4046dec1aa0eebb01fe7469184a95398|10/31/2011|\n|11/13/11|ba370b17dc9eb1d1e1c3187f0768064f|10/31/2011|\n|12/2011|51274cefb01cee981a09db83c984213d|11/28/2011|\n|02/2012|d1a2253361045f91ed1902e9ffe2cec3|7/18/2011|\n|03/05/12|20bb652e1d2679ed230102aa9676eca0|3/1/2012|\n|03/26/12|c5c0fea23138cddab96fe22b657f9132|3/8/2012|\n|03/28/12|ef2bc66ea69327d11d1859af26f5aef9|3/8/2012|\n|03/29/12|8e50af054d2c0b45c88082d53c4fc423|3/8/2012|\n|04/2012|b1e47ecd68c1c151866cec275716aa67|4/18/2012|\n|05/20/12|6d205e78fb7730066c116b0c2dffa398|5/2/2012|\n|06/04/12|5ec175512ba3c6e78597af48bbe6ca60|5/2/2012|\n\n\nUnderstanding targeted campaigns and their\n\n#### Attribution\n\nmethodologies is fundamental in protecting both end\nusers and organizations. Not only does it help in coming\nup with effective defensive strategies through multiple\nprotection layers, it also helps with predicting possible\n\nClues relating to the attackers remain very limited. Using\n\ntargets in the future and ultimately, raise awareness. As\n\ncompromised hosts as C&C proxy servers minimizes the\n\nof this writing, the HeartBeat APT campaign remains an\n\npossibility of tracking potential threat actors. While a\n\nactive targeted campaign.\n\nnumber of their campaign codes included Chinese words\nsuch as guohui, xuehui and minzhu, they appear to be\ncomfortable using the English language. Some of the C&C Timeline\ndomain names even contained English words. In addition,\nthe binder tool and the RAT component are written\nin English. For instance, some text from the packaged\ncomponents’ body included “Select Files!” and “Bind We collected 19 set of samples related to HeartBeat\n_Success!”, while the RAT component included strings_ campaign from November 2009 to June 2012. This\nsuch as “Uninstall…ok” and the name of the RAT itself, translates to 19 campaigns where the vast majority\n_“HeartBeat.”_ of which were distributed between 2011 and 2012.\n\nNonetheless, the limited number of samples we were\n\nThreat actors and entities that use collected information able to obtain still means that the campaign is indeed\nfrom targets may be two separate parties that are only persistent. The isolated nature of this targeted attack\nrelated in a professional and malicious manner. In this and its small user base may only require the HeartBeat\ncase, determining the latter may be impossible. Likewise, perpetrators to carry out minimal campaigns in order to\nit is very difficult to identify the threat actors behind infiltrate their targets.\nthe HeartBeat campaign given the limited amount of\ninformation available.\n\nCampaign Compile\n\nDate MD5 (.DLL component) Date\n\n#### Conclusion (MM/DD/YY) (MM/DD/YY)\n\n11/19/09 7c6b44d8d87898e7e5deeeb1961b5ae6 9/17/2009\n\n03/15/11 fcf42cadb3a932989c8e2b29cef68861 12/24/2010\n\n04/17/11 aab129ffd3bf5ceeae2e0f332217bebc 3/18/2011\n\nThe Heartbeat campaign has been successfully executing\n\n05/25/11 86547d674e7c7da55e8cae359819832f 5/6/2011\n\ntargeted attacks since 2009. In order for attackers to\nproperly track their campaigns and victims, they used 09/09/111 f947e63b14853a69b8ed2648869b5e10 7/25/2011\ncampaign codes that contained the campaign dates and 09/16/11 7f1a633384ec97fae9d95d1df9e1135a 7/25/2011\nstrings that described specific campaigns. These campaign 09/25/11 8816c5be1305488019769c81259dad2a 9/21/2011\ncodes are embedded in their RAT binaries and were sent 10/22/11 874025a66c2b9d9831c03d1bc114876a 10/17/2011\nto their C&C servers along with information regarding the\n\n11/03/11 4046dec1aa0eebb01fe7469184a95398 10/31/2011\n\ntargets’ system. Additionally, they used a commercial site\nredirection service for their C&C domains. These domains 11/13/11 ba370b17dc9eb1d1e1c3187f0768064f 10/31/2011\nredirected to various IP addresses that belonged to 12/2011 51274cefb01cee981a09db83c984213d 11/28/2011\nlegitimate ISPs, which may be compromised hosts that act 02/2012 d1a2253361045f91ed1902e9ffe2cec3 7/18/2011\nas proxy servers. This effectively hides the real location of 03/05/12 20bb652e1d2679ed230102aa9676eca0 3/1/2012\nthe attackers behind HeartBeat. While having an isolated\ntarget may have helped them stay under the security 03/26/12 c5c0fea23138cddab96fe22b657f9132 3/8/2012\nindustry’s radar, the attackers illustrated that they were 03/28/12 ef2bc66ea69327d11d1859af26f5aef9 3/8/2012\nvery careful but persistent. 03/29/12 8e50af054d2c0b45c88082d53c4fc423 3/8/2012\n\n04/2012 b1e47ecd68c1c151866cec275716aa67 4/18/2012\n\n05/20/12 6d205e78fb7730066c116b0c2dffa398 5/2/2012\n\n06/04/12 5ec175512ba3c6e78597af48bbe6ca60 5/2/2012\n\n_Table 3. Specific dates of HeartBeat campaigns_\n\n\n-----\n\nWe did not obtain a campaign sample from 2010. However, that contain file attachments using extensions such as\nwe highly suspect that their operation was also active .VBS, .BAT, .EXE, .PIF and .SCR files.\nduring that year. In fact, we can see in the second MD5\nabove that the sample was compiled in December 24, 2010.     - Avoid opening email attachments and clicking\nAlso, it is possible that some of the campaign’s attacks embedded links from unknown sources\nmay not have been escalated to antivirus firms by infected\nusers, or simply remains undiscovered.     - Block any file with more than one file type extension.\n\n                                                  - When a computer is compromised, isolate it\n\n#### Defending against the HeartBeat\n\nimmediately from the network.\n\n#### Campaign\n\n                                                  - Configure your system to show hidden files and folders\n\nand display file extensions.\n\nEssential components of defense against the HeartBeat     - Don’t save login credentials on the local computer.\ncampaign are security-related policies within enterprises.\nOnce an attack is identified, a good cleanup strategy\nshould focus on determining the attack vector and cutting\noff communications with the C&C server. It is also vital to\ndetermine the scope of the compromise and assessing the\ndamage through data analysis and forensics.\n\nThe following best practices are also advised:\n\n       - Disable services that are related to the HeartBeat RAT\n\ncomponent.\n\n       - Enable system’s firewall\n\n       - Keep software and operating systems updated\n\nwith latest patches released by vendors to address\nvulnerabilities and exploits.\n\n       - Block unused ports to disallow malware from\n\nusing these ports to communicate and/or enforce\ncommands.\n\n       - Monitor network connections for any suspicious\n\nconnection or connectivity.\n\n       - Regularly update list of sites that are trusted.\n\n       - Configure your email server to block or remove email\n\n\n-----\n\n|Attack Component|Protection Technology|Trend Micro Solution|\n|---|---|---|\n|HeartBeat TCP communication is blocked in the network layer as TCP_HBEAT_REQUEST|Web Reputation|Endpoint (Titanium, Worry-Free Business Security, OfficeScan) Server (Deep Security) Messaging (InterScan Messaging Security, ScanMail Suite for Microsoft Exchange) Network (Deep Discovery) Gateway (InterScan Web Security, InterScan Messaging Security) Mobile (Mobile Security)|\n|TROJ_DRPBEAT and BKDR_HBEAT variants|File Reputation (Antivirus/Anti-malware)|Endpoint (Titanium, Worry-Free Business Security, OfficeScan) Server (Deep Security) Messaging (InterScan Messaging Security, ScanMail Suite for Microsoft Exchange) Network (Deep Discovery) Gateway (InterScan Web Security, InterScan Messaging Security) Mobile (Mobile Security)|\n|XXX.XXX.217.123 XXX.XX.121.84 XX.XXX.203.122 XX.XXX.20.103 XXX.XXX.217.123 XXX.XX.121.84 XXX.XXX.178.50 XX.XXX.15.63 XXX.XXX.198.93 XXX.XXX.169.45 XXX.XXX.178.50 XXX.XXX.217.123 XX.XXX.136.115 XXX.XXX.178.50 XXX.XXX.4.180 XX.XXX.203.122 ahnlab.myfw.us kissyou01.myfw.us kita.myfw.us login.sbs.com.PassAs.us mail2.myfw.us park007.myfw.us snrp.UglyAs.com www.banking.com.PassAs.us www.huyang.go.kr.PassAs.us www.kinu.or.kr.rr.nu www.kndu.ac.kr.myfw.us young03.myfw.us|Web, Domain, and IP Reputation|Endpoint (Titanium, Worry-Free Business Security, OfficeScan) Server (Deep Security) Messaging (InterScan Messaging Security, ScanMail Suite for Microsoft Exchange) Network (Deep Discovery) Gateway (InterScan Web Security, InterScan Messaging Security) Mobile (Mobile Security)|\n\n\n#### Trend Micro Threat Protection Against The HeartBeat Campaign Components\n\nThe following table summarizes the Trend Micro solutions for the components of the HeartBeat campaign. Trend Micro\nrecommends a comprehensive security risk management strategy that goes further than advanced protection to meet\nthe real-time threat management requirements of dealing with targeted attacks.\n\nAttack Component Protection Technology Trend Micro Solution\n\nHeartBeat TCP communication is blocked in the Web Reputation Endpoint (Titanium, Worry-Free Business\nnetwork layer as TCP_HBEAT_REQUEST _Security, OfficeScan)_\n\nServer (Deep Security)\nMessaging (InterScan Messaging Security,\n_ScanMail Suite for Microsoft Exchange)_\nNetwork (Deep Discovery)\nGateway (InterScan Web Security, InterScan\n_Messaging Security)_\nMobile (Mobile Security)\n\nTROJ_DRPBEAT and BKDR_HBEAT variants File Reputation Endpoint (Titanium, Worry-Free Business\n(Antivirus/Anti-malware) _Security, OfficeScan)_\n\nServer (Deep Security)\nMessaging (InterScan Messaging Security,\n_ScanMail Suite for Microsoft Exchange)_\nNetwork (Deep Discovery)\nGateway (InterScan Web Security, InterScan\n_Messaging Security)_\nMobile (Mobile Security)\n\n_XXX.XXX.217.123_ Web, Domain, and IP Reputation Endpoint (Titanium, Worry-Free Business\n_XXX.XX.121.84_ _Security, OfficeScan)_\n_XX.XXX.203.122_ Server (Deep Security)\n_XX.XXX.20.103_ Messaging (InterScan Messaging Security,\n_XXX.XXX.217.123_ _ScanMail Suite for Microsoft Exchange)_\n_XXX.XX.121.84_ Network (Deep Discovery)\n_XXX.XXX.178.50_ Gateway (InterScan Web Security, InterScan\n_XX.XXX.15.63_ _Messaging Security)_\n_XXX.XXX.198.93_ Mobile (Mobile Security)\n_XXX.XXX.169.45_\n_XXX.XXX.178.50_\n_XXX.XXX.217.123_\n_XX.XXX.136.115_\n_XXX.XXX.178.50_\n_XXX.XXX.4.180_\n_XX.XXX.203.122_\n_ahnlab.myfw.us_\n_kissyou01.myfw.us_\n_kita.myfw.us_\n_login.sbs.com.PassAs.us_\n_mail2.myfw.us_\n_park007.myfw.us_\n_snrp.UglyAs.com_\n_www.banking.com.PassAs.us_\n_www.huyang.go.kr.PassAs.us_\n_www.kinu.or.kr.rr.nu_\n_www.kndu.ac.kr.myfw.us_\n_young03.myfw.us_\n\n\n-----\n\nUnlike indiscriminate cybercrime attacks, spam, web threats, and the like, APTs are much harder to detect because\nof the targeted nature of related components and techniques. Also, while cybercrime focuses on stealing credit card\nand banking information to gain profit, APTs are better thought of as cyber espionage.\n## HEARTBEAT\n\n### • First Seen\n\nIndividual targeted attacks are not one-off attempts. Attackers continually try to get inside the target’s network.\n\nThe “HeartBeat” campaign has been persistently pursuing government agencies since 2009. The samples collected related to this campaign covered\nattacks seen from November 2009 to June 2012, although majority of the attacks were seen in 2011 and 2012.\n\n### • Victims and Targets\n\nAPT campaigns target specific industries or communities of interest in specific regions.\n\nThe HeartBeat campaign targets South Korean government organizations and institutions like political parties, media outfits, a national policy\nresearch institute, a military branch of South Korean armed forces, a small business sector organization, and branches of the South Korean\ngovernment.\n\n### • Operations\n\nThe 1st-stage computer intrusions often use social engineering. Attackers custom-fit attacks to their targets.\n\nThe threat actors behind HeartBeat install a RAT in system. The RAT arrives as a disguised or fake document which is actually a bundled file. The\nbundled file contains both a decoy document and the RAT installer that has been packaged together using a binder tool. The campaign’s decoy\ndocuments used the file formats .JPG, .PDF, XLS, and HWP, the Korean government standard word processor format.\n\n### • Possible Indicators of Compromise\n\nAttackers want to remain undetected as long as possible. A key characteristic of these attacks is stealth.\n\nThe following indicators suggest an infection by the HeartBeat campaign: contiguous 02H bytes communication in the network, the presence of\ncertain files and registries as detailed in the paper, and network connections to certain IPs and domains, including the presence of files detected as\n**TROJ_DRPBEAT and BKDR_HBEAT.**\n\n### • Relationship with other APT Campaigns\n\nThis attack does not seem to have any relationship with other APT campaigns.\n\n\n-----\n\nTREND MICRO INCORPORATED TREND MICRO INC.\n\nTrend Micro Incorporated (TYO: 4704; TSE: 4704), a global cloud security 10101 N. De Anza Blvd.\nleader, creates a world safe for exchanging digital information with its In- Cupertino, CA 95014\nternet content security and threat management solutions for businesses\nand consumers. A pioneer in server security with over U.S. toll free: 1 +800.228.5651\n20 years’ experience, we deliver top-ranked client, server and cloud- Phone: 1 +408.257.1500\nbased security that fits our customers’ and partners’ needs, stops Fax: 1 +408.257.2003\nnew threats faster, and protects data in physical, virtualized and cloud www.trendmicro.com\nenvironments. Powered by the industry-leading Trend Micro™ Smart Pro-\ntection Network™ cloud computing security infrastructure, our products\nand services stop threats where they emerge—from the Internet. They are\nsupported by 1,000+ threat intelligence experts around the globe.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/4qfg9m8wrdgsdf7k3fwrz7zmg2tkfxno",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2012/2012.01.03.HeartBeat_APT/wp_the-heartbeat-apt-campaign.pdf"
    ],
    "report_names": [
        "wp_the-heartbeat-apt-campaign"
    ],
    "threat_actors": [
        {
            "id": "71b19e59-b5f7-4bc6-816d-194be0f02af0",
            "created_at": "2022-10-25T16:07:24.301036Z",
            "updated_at": "2025-03-27T02:02:10.165121Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Budminer",
                "Earth Aughisky"
            ],
            "source_name": "ETDA:Taidoor",
            "tools": [
                "Dripion",
                "Masson",
                "Taidoor",
                "simbot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "50bd4a6c-7542-4bdd-8b37-ab468fc428ef",
            "created_at": "2023-01-06T13:46:38.998658Z",
            "updated_at": "2025-03-27T02:00:02.973354Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "G0015",
                "Earth Aughisky"
            ],
            "source_name": "MISPGALAXY:Taidoor",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7c8cf02c-623a-4793-918b-f908675a1aef",
            "created_at": "2023-01-06T13:46:38.309165Z",
            "updated_at": "2025-03-27T02:00:02.801298Z",
            "deleted_at": null,
            "main_name": "APT15",
            "aliases": [
                "BRONZE PALACE",
                "Nylon Typhoon",
                "VIXEN PANDA",
                "Playful Dragon",
                "BRONZE DAVENPORT",
                "BRONZE IDLEWOOD",
                "G0004",
                "Red Vulture",
                "Ke3Chang",
                "Metushy",
                "Lurid",
                "Social Network Team",
                "Royal APT"
            ],
            "source_name": "MISPGALAXY:APT15",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "478e9b27-39b9-49e4-a3c5-81569a767275",
            "created_at": "2022-10-25T15:50:23.417339Z",
            "updated_at": "2025-03-27T02:00:55.464624Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Taidoor"
            ],
            "source_name": "MITRE:Taidoor",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c39b0fe6-5642-4717-9a05-9e94265e3e3a",
            "created_at": "2022-10-25T16:07:24.332084Z",
            "updated_at": "2025-03-27T02:02:10.175452Z",
            "deleted_at": null,
            "main_name": "Tonto Team",
            "aliases": [
                "Bronze Huntley",
                "CactusPete",
                "Earth Akhlut",
                "HartBeat",
                "Karma Panda",
                "LoneRanger",
                "Operation Bitter Biscuit",
                "TAG-74",
                "Tonto Team"
            ],
            "source_name": "ETDA:Tonto Team",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Bioazih",
                "Bisonal",
                "CONIME",
                "Dexbia",
                "Korlia",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716499,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1356100419,
    "ts_modification_date": 1356100431,
    "files": {
        "pdf": "https://archive.orkl.eu/a486fb5b0b485796f0b2d1248c948e7c64c6b49a.pdf",
        "text": "https://archive.orkl.eu/a486fb5b0b485796f0b2d1248c948e7c64c6b49a.txt",
        "img": "https://archive.orkl.eu/a486fb5b0b485796f0b2d1248c948e7c64c6b49a.jpg"
    }
}