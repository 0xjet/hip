{
    "id": "4e7f76a8-8867-4898-92d5-1e58b96cd6ee",
    "created_at": "2023-01-12T14:59:58.909792Z",
    "updated_at": "2025-03-27T02:16:26.136318Z",
    "deleted_at": null,
    "sha1_hash": "f093863640df4db37f8122cbc7bbd237eb90967d",
    "title": "2017-05-25 - EternalRocks (a.k.a. MicroBotMassiveNet)",
    "authors": "",
    "file_creation_date": "2022-05-28T19:52:07Z",
    "file_modification_date": "2022-05-28T19:52:07Z",
    "file_size": 407541,
    "plain_text": "# EternalRocks (a.k.a. MicroBotMassiveNet)\n\n**github.com/stamparm/EternalRocks**\n\nstamparm\n\nEternalRocks is a network worm (i.e. self-replicating), emerged in first half of\nMay 2017, with oldest known sample\n```\n    fc75410aa8f76154f5ae8fe035b9a13c76f6e132077346101a0d673ed9f3a0dd\n\n```\ndating to 2017-05-03. It spreads through public (The Shadow Brokers NSA\ndump) SMB exploits: `ETERNALBLUE,` `ETERNALCHAMPION,` `ETERNALROMANCE`\nand `ETERNALSYNERGY, along with related programs:` `DOUBLEPULSAR,`\n\n\n-----\n\nFirst stage malware `UpdateInstaller.exe (got through remote exploitation`\nwith second stage malware) downloads necessary .NET components (for later\nstages) [TaskScheduler and](http://api.nuget.org/packages/taskscheduler.2.5.23.nupkg) [SharpZLib from Internet, while dropping](http://api.nuget.org/packages/sharpziplib.0.86.0.nupkg)\n\n`svchost.exe (e.g.` [sample) and](https://raw.githubusercontent.com/stamparm/EternalRocks/master/samples/589af04a85dc66ec6b94123142a17cf194decd61f5d79e76183db026010e0d31) `taskhost.exe (e.g.` [sample). Component](https://raw.githubusercontent.com/stamparm/EternalRocks/master/samples/aedd0c47daa35f291e670e3feadaed11d9b8fe12c05982f16c909a57bf39ca35)\n```\nsvchost.exe is used for downloading, unpacking and running Tor from\narchive.torproject.org along with C&C ( ubgdgno5eswkhmpy.onion )\n\n```\ncommunication requesting further instructions (e.g. installation of new\ncomponents).\n\nSecond stage malware `taskhost.exe (Note: different than one from first`\nstage) (e.g. [sample) is being downloaded after a predefined period (24h) from](https://raw.githubusercontent.com/stamparm/EternalRocks/master/samples/cf8533849ee5e82023ad7adbdbd6543cb6db596c53048b1a0c00b3643a72db30)\n```\nhttp://ubgdgno5eswkhmpy.onion/updates/download?id=PC and run.\n\n```\n[After initial run it drops the exploit pack shadowbrokers.zip and unpacks](https://raw.githubusercontent.com/stamparm/EternalRocks/master/samples/70ec0e2b6f9ff88b54618a5f7fbd55b383cf62f8e7c3795c25e2f613bfddf45d)\ncontained directories `payloads/,` `configs/ and` `bins/ . After that, starts a`\nrandom scan of opened 445 (SMB) ports on Internet, while running contained\nexploits (inside directory `bins/ ) and pushing the first stage malware through`\npayloads (inside directory `payloads/ ). Also, it expects running Tor process`\nfrom first stage to get further instructions from C&C.\n\n\n-----\n\n## Update (2017-05-25)\n\nAuthor (\" tmc \") suddenly drops the whole campaign after a recent fuzz. C&C\npage currently holds this moment the following (new) message:\n\nAfter a successful registration, user can find following messages from malware\nauthor (\" tmc \") himself:\n```\nIts not ransomware, its not dangerous, it just firewalls \nthe smb port and moves on. I wanted to play some games with \nthem, considering I had visitors, but the news has to much \nabout weaponized doomsday worm eternal rocks payload. much \nthought to be had... ps: nsa exploits were fun, thanks \nshadowbrokers!\nbtw, all I did, was use the NSA tools for what they were \nbuilt, I was figuring out how they work, and next thing I \nknew I had access, so what to do then, I was ehh, I will \njust firewall the port, thank you for playing, have a nice \na day. \n\n```\n\n-----\n\nAlso, malware doesn't update any more to the (shadowbrokers exploit pack)\n[second stage, but to the dummy executable:](https://raw.githubusercontent.com/stamparm/EternalRocks/master/samples/48b1024f599c3184a49c0d66c5600385265b9868d0936134185326e2db0ab441)\n\n## Host Based indicators\n\n### Paths\n```\n   c:\\Program Files\\Microsoft Updates\\SharpZLib.zip # in\n   newer variants\n\n```\n```\nc:\\Program Files\\Microsoft Updates\\svchost.exe\n\n```\n```\nc:\\Program Files\\Microsoft Updates\\installed.fgh\n\n```\n\n-----\n\n```\nc:\\Program Files\\Microsoft\n\n```\n```\nUpdates\\ICSharpCode.SharpZipLib.dll # in newer variants\nc:\\Program Files\\Microsoft\nUpdates\\Microsoft.Win32.TaskScheduler.dll\nc:\\Program Files\\Microsoft Updates\\SharpZLib\\ # in newer\nvariants\n\n```\n```\nc:\\Program Files\\Microsoft Updates\\temp\\tor.zip\n\n```\n```\nc:\\Program Files\\Microsoft Updates\\temp\\Tor\\\n\n```\n```\nc:\\Program Files\\Microsoft Updates\\required.glo\n\n```\n```\nc:\\Program Files\\Microsoft Updates\\taskhost.exe\n\n```\n```\nc:\\Program Files\\Microsoft Updates\\TaskScheduler.zip\n\n```\n```\nc:\\Program Files\\Microsoft Updates\\TaskScheduler\\\n\n```\n\n### Persistence\n\nTwo scheduled tasks `ServiceHost and` `TaskHost having multiple`\ntriggers\n\n### Mutexes\n\n```\n{8F6F00C4-B901-45fd-08CF-72FDEFF}\n\n```\n```\n{8F6F0AC4-B9A1-45fd-A8CF-72FDEFF}\n\n```\n```\n20b70e57-1c2e-4de9-99e5-69f369006912\n\n```\n\n## Samples\n\n\n-----\n\n### First stage\n\ne049d8f69ddee0c2d360c27b98fa9e61b7202bb0d3884dd3ca63f8aa2884\n22dc `# UpdateInstaller.exe (captured)`\n1ee894c0b91f3b2f836288c22ebeab44798f222f17c255f557af2260b8c6a3\n2d `# UpdateInstaller.exe (variant)`\n64442cceb7d618e70c62d461cfaafdb8e653b8d98ac4765a6b3d8fd1ea3b\nce15 `# UpdateInstaller.exe (variant)`\n94189147ba9749fd0f184fe94b345b7385348361480360a59f12adf477f61\nc97 `# UpdateInstaller.exe (variant)`\n9bd32162e0a50f8661fd19e3b26ff65868ab5ea636916bd54c244b0148bd\n9c1b `# UpdateInstaller.exe (variant)`\na7c387b4929f51e38706d8b0f8641e032253b07bc2869a450dfa3df5663d\n7392 `# UpdateInstaller.exe (variant)`\nad8965e531424cb34120bf0c1b4b98d4ab769bed534d9a36583364e9572\n332fa `# UpdateInstaller.exe (variant)`\nb2ca4093b2e0271cb7a3230118843fccc094e0160a0968994ed9f10c8702\nd867 `# UpdateInstaller.exe (variant)`\nc999bf5da5ea3960408d3cba154f965d3436b497ac9d4959b412bfcd956c\n8491 `# UpdateInstaller.exe (variant)`\nd43c10a2c983049d4a32487ab1e8fe7727646052228554e0112f6651f483\n3d2c `# UpdateInstaller.exe (variant)`\nd86af736644e20e62807f03c49f4d0ad7de9cbd0723049f34ec79f8c7308fd\nd5 `# UpdateInstaller.exe (variant)`\nfc75410aa8f76154f5ae8fe035b9a13c76f6e132077346101a0d673ed9f3a\n0dd `# UpdateInstaller.exe (variant)`\n\n### Second stage\n\ncf8533849ee5e82023ad7adbdbd6543cb6db596c53048b1a0c00b3643a7\n2db30 `# taskhost.exe (captured)`\n3b4497c7f8c89bf22c984854ac7603573a53b95ed147e80c0f19e549e2b6\n5693 `# taskhost.exe (variant)`\na77c61e86bc69fdc909560bb7a0fa1dd61ee6c86afceb9ea17462a97e711\n4ab0 `# taskhost.exe (variant)`\n[70ec0e2b6f9ff88b54618a5f7fbd55b383cf62f8e7c3795c25e2f613bfddf45d](https://raw.githubusercontent.com/stamparm/EternalRocks/master/samples/70ec0e2b6f9ff88b54618a5f7fbd55b383cf62f8e7c3795c25e2f613bfddf45d)\n\n```\n# shadowbrokers.zip (exploits)\n\n```\n\n## Network indicators\n\n### C&C server(s)\n\n```\nubgdgno5eswkhmpy.onion\n\n```\n\n-----\n\n### Downloading required .NET components (first stage)\n```\n   http://api.nuget.org/packages/taskscheduler.2.5.23.nupkg\n   http://api.nuget.org/packages/sharpziplib.0.86.0.nupkg #\n   in newer variants\n\n## Appendix\n\n### Decompilation of an older sample\n\n```\n[C# source](https://raw.githubusercontent.com/stamparm/EternalRocks/master/misc/svchost.7z) `#`\n```\n   1ee894c0b91f3b2f836288c22ebeab44798f222f17c255f557af2260b8c6a32d\n\n### Network traffic capture (PCAP)\n\n```\n[Windows 7 x64 SP1 Honeypot](https://raw.githubusercontent.com/stamparm/EternalRocks/master/misc/exploitation.pcap) `# initial exploitation capture`\n\n```\n(2017-05-17)\n\n```\n\n### Yara rules\n\n[EternalRocks.yara](https://raw.githubusercontent.com/stamparm/EternalRocks/master/EternalRocks.yara)\n\n### Debug strings\n\n```\nC:\\Program Files (x86)\\Microsoft Visual Studio\\VB98\\VB6.OLB\n\n```\n```\nC:\\Users\\tmc\\Documents\\DownLoader\\Project1.vbp\n\n```\n\n-----\n\n```\nC:\\Users\\tmc\\Documents\\TorUnzip\\Project1.vbp\n\n```\n```\n   c:\\Users\\tmc\\Documents\\Visual Studio\n   2015\\Projects\\MicroBotMassiveNet\\taskhost\\obj\\x86\\Debug\\taskhost.pdb\n   C:\\Users\\tmc\\Documents\\Visual Studio\n   2015\\Projects\\WindowsServices\\svchost\\bin\\svchost.pdb\n\n### Indicators of Compromise (IOC)\n\n```\n**SHA256**\n```\n1ee894c0b91f3b2f836288c22ebeab44798f222f17c255f557af2260b8c6a32d\n20240431d6eb6816453651b58b37f53950fcc3f0929813806525c5fd97cdc0e1\n2094d105ec70aa98866a83b38a22614cff906b2cf0a08970ed59887383ee7b70\n23eeb35780faf868a7b17b8e8da364d71bae0e46c1ababddddddecbdbd2c2c64\n3b4497c7f8c89bf22c984854ac7603573a53b95ed147e80c0f19e549e2b65693\n44472436a5b46d19cb34fa0e74924e4efc80dfa2ed491773a2852b03853221a2\n48b1024f599c3184a49c0d66c5600385265b9868d0936134185326e2db0ab441\n589af04a85dc66ec6b94123142a17cf194decd61f5d79e76183db026010e0d31\n64442cceb7d618e70c62d461cfaafdb8e653b8d98ac4765a6b3d8fd1ea3bce15\n6bc73659a9f251eef5c4e4e4aa7c05ff95b3df58cde829686ceee8bd845f3442\n70ec0e2b6f9ff88b54618a5f7fbd55b383cf62f8e7c3795c25e2f613bfddf45d\n7b8674c8f0f7c0963f2c04c35ae880e87d4c8ed836fc651e8c976197468bd98a\n94189147ba9749fd0f184fe94b345b7385348361480360a59f12adf477f61c97\n9bd32162e0a50f8661fd19e3b26ff65868ab5ea636916bd54c244b0148bd9c1b\na77c61e86bc69fdc909560bb7a0fa1dd61ee6c86afceb9ea17462a97e7114ab0\na7c387b4929f51e38706d8b0f8641e032253b07bc2869a450dfa3df5663d7392\nad8965e531424cb34120bf0c1b4b98d4ab769bed534d9a36583364e9572332fa\naedd0c47daa35f291e670e3feadaed11d9b8fe12c05982f16c909a57bf39ca35\nb2ca4093b2e0271cb7a3230118843fccc094e0160a0968994ed9f10c8702d867\nc4762489488f797b4b33382c8b1b71c94a42c846f1f28e0e118c83fe032848f0\nc999bf5da5ea3960408d3cba154f965d3436b497ac9d4959b412bfcd956c8491\ncf8533849ee5e82023ad7adbdbd6543cb6db596c53048b1a0c00b3643a72db30\nd43c10a2c983049d4a32487ab1e8fe7727646052228554e0112f6651f4833d2c\nd86af736644e20e62807f03c49f4d0ad7de9cbd0723049f34ec79f8c7308fdd5\ne049d8f69ddee0c2d360c27b98fa9e61b7202bb0d3884dd3ca63f8aa288422dc\ne77306d2e3d656fa04856f658885803243aef204760889ca2c09fbe9ba36581d\nf152ed03e4383592ce7dd548c34f73da53fc457ce8f26d165155a331cde643a9\nfc75410aa8f76154f5ae8fe035b9a13c76f6e132077346101a0d673ed9f3a0dd\n\n```\n**Imphash**\n```\n8ef751c540fdc6962ddc6799f35a907c # older (VB6) variants of\nUpdateInstaller.exe\n\n```\n**Mutexes**\n```\n{8F6F00C4-B901-45fd-08CF-72FDEFF}\n{8F6F0AC4-B9A1-45fd-A8CF-72FDEFF}\n{8F6F0AC4-B9A1-45fd-A8CF-727220DE8F}\n20b70e57-1c2e-4de9-99e5-69f369006912\n\n```\n\n-----\n\n**File paths**\n```\nc:\\Program Files\\Microsoft Updates\\\n\n```\n**Scheduled tasks**\n```\nServiceHost -> C:\\Program Files\\Microsoft Updates\\svchost.exe #\nsystem start, log on, daily\nTaskHost -> C:\\Program Files\\Microsoft Updates\\taskhost.exe #\nsystem start, log on, daily\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-05-25 - EternalRocks (a.k.a. MicroBotMassiveNet).pdf"
    ],
    "report_names": [
        "2017-05-25 - EternalRocks (a.k.a. MicroBotMassiveNet).pdf"
    ],
    "threat_actors": [
        {
            "id": "d4f7cf97-9c98-409c-8b95-b80d14c576a5",
            "created_at": "2022-10-25T16:07:24.561104Z",
            "updated_at": "2025-03-27T02:02:10.281202Z",
            "deleted_at": null,
            "main_name": "Shadow Brokers",
            "aliases": [],
            "source_name": "ETDA:Shadow Brokers",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "171b85f2-8f6f-46c0-92e0-c591f61ea167",
            "created_at": "2023-01-06T13:46:38.830188Z",
            "updated_at": "2025-03-27T02:00:02.929729Z",
            "deleted_at": null,
            "main_name": "The Shadow Brokers",
            "aliases": [
                "Shadow Brokers",
                "ShadowBrokers",
                "The ShadowBrokers",
                "TSB"
            ],
            "source_name": "MISPGALAXY:The Shadow Brokers",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535598,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653767527,
    "ts_modification_date": 1653767527,
    "files": {
        "pdf": "https://archive.orkl.eu/f093863640df4db37f8122cbc7bbd237eb90967d.pdf",
        "text": "https://archive.orkl.eu/f093863640df4db37f8122cbc7bbd237eb90967d.txt",
        "img": "https://archive.orkl.eu/f093863640df4db37f8122cbc7bbd237eb90967d.jpg"
    }
}