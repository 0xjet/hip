{
    "id": "c20e96b1-c186-4f0e-9762-ed652d39f75a",
    "created_at": "2023-01-12T15:09:59.850412Z",
    "updated_at": "2025-03-27T02:08:41.195515Z",
    "deleted_at": null,
    "sha1_hash": "805db226788db581b305b2792019efb4e7e40465",
    "title": "2020-01-09 - Not so nice after all - Afrodita Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T01:28:31Z",
    "file_modification_date": "2022-05-28T01:28:31Z",
    "file_size": 1510860,
    "plain_text": "# Not so nice after all - Afrodita Ransomware\n\n**[dissectingmalwa.re/not-so-nice-after-all-afrodita-ransomware.html](https://dissectingmalwa.re/not-so-nice-after-all-afrodita-ransomware.html)**\n\n#### Thu 09 January 2020 in Ransomware\n\n A new Ransomware strain spread by malicious Office documents targeted at Croatian systems - let's check it out\n\n This strain was first discovered by Korben Dallas on Twitter on the 9th of January. As I already mentioned the Malware is delivered via a Malspam/Maldoc attack crafted for Users / Companies from Croatia. Researchers that were involved in the initial analysis: @KorbenD_Intel, @James_inthe_box, @Malwageddon, @pollo290987 and I (@f0wlsec). Thank you for your contributions!\n\n @James_inthe_box @malwrhunterteam @Malwageddon\n 69450923d812f3696e8280508b636955 XLS 12/60 VT scan detections. Not nice.. upped to Malshare: https://t.co/jXxXrJxcB9 pic.twitter.com/TPfP0BCZOB\n\n — Korben Dallas (@KorbenD_Intel) January 9, 2020\n\n\n-----\n\n#### A general disclaimer as always: downloading and running the samples linked below will lead to the encryption of your personal data, so be f$cking careful. Also check with your local laws as owning malware binaries/ sources might be illegal depending on where you live.\n\n Afrodita @ AnyRun | VirusTotal | HybridAnalysis --> sha256\n```\n9b6681103545432cd1373492297a6a12528f327d14a7416c2b71cfdcbdafc90b\n\n Here you can see three images extracted from the malicious Excel Docs. Funny how they didn't even bother to think of a fake company name for the second Logo :D\n\n Afrodita uses a sleep routine for Sandbox evasion. In my Tests it took 30-60mins until the system was infected.\n\n After unpacking the sample with UPX, Detect it easy returns the following:\n\n```\n\n-----\n\n#### It was likely build with a very new Version\n\n of Visual Studio (2019)\n\n Below you can see a screenshot of PEBear from the Imports-Tab.\n\n The extracted strings tell us quite a lot in this case. It looks like the internal name of the Project is Afrodita and it utilizes the CryptoPP Library. There are some references to .key files, but I haven't found a path or file on a infected machine yet. README_RECOVERY .txt is will be the filename of the Ransomnote. It's contents are embeded in the binary's .data section with Base64 encoding. Lastly Afrodita.dll is the rewritten file that is downloaded as a payload (originally notnice.jpg or verynice.jpg). It's executed via rundll32.exe Afrodita.dll,Sura.\n\n The following filetypes will be encrypted by Afrodita:\n\n\n-----\n\n```\n.TXT, .ZIP, .DAT, .JPE, .JPG, .PNG, .JPEG, .GIF, .BMP, .EXIF, .MP4, .RAR, .M4A, .WMA,\n.AVI, .WMV, .MKV, .CSV, .M3U, .FLV, .WALLET, .JAVA, .CLASS, .HTML, .HTM, .CSS, .LUA,\n.ASP, .PHP, .INCPAS, .ASM, .HPP, .CPP, .SLN, .ACCDB, .MDB, .PPTM, .PPTX, .PPT, .XLK,\n.XLSB, .XLSM, .XLSX, .XLS, .WPS, .DOCM, .DOCX, .DOC, .ODB, .ODC, .ODM, .ODP, .ODS,\n.ACCDR, .ACCDT, .ACCDE, .D3DBSP, .SIE, .SQL, .BACKUPDB, .BACKUP, .BAK, .SUM, .IBANK,\n.T13, .T12, .QDF, .GDB, .TAX, .PKPASS, .SLDM, .SLDX, .PPSM, .PPSX, .PPAM, .POTM,\n.POTX, .PPS, .POT, .XLW, .XLL, .XLAM, .XLA, .XLTM, .XLTX, .XLM, .XLT, .DOTM, .DOTX,\n.DOT, .BC6, .BC7, .BKP, .QIC, .BKF, .SIDN, .SIDD, .MDDATA, .ITL, .ITDB, .ICXS, .HVPL,\n.HPLG, .HKDB, .MDBACKUP, .SYNCDB, .GHO, .CAS, .SVG, .MAP, .WMO, .ITM, .FOS, .MOV,\n.VDF, .ZTMP, .SIS, .SID, .NCF, .MENU, .LAYOUT, .DMP, .BLOB, .ESM, .VCF, .VTF, .DAZIP,\n.FPK, .MLX, .IWD, .VPK, .TOR, .PSK, .RIM, .W3X, .FSH, .NTL, .ARCH00, .LVL, .SNX,\n.CFR, .VPP_PC, .LRF, .MCMETA, .VFS0, .MPQGE, .KDB, .DB0, .DBA, .ROFL, .HKX, .BAR.\n.UPK, .DAS, .IWI, .LITEMOD, .ASSET, .FORGE, .LTX, .BSA, .APK, .RE4, .SAV, .LBF, .SLM,\n.BIK, .EPK, .RGSS3A, .PAK, .BIG, .WOTREPLAY, .XXX, .DESC, .P7C, .P7B, .P12, .PFX,\n.PEM, .CRT, .CER, .DER, .X3F, .SRW, .PEF, .PTX, .R3D, .RW2, .RWL, .RAW, .RAF, .ORF,\n.NRW, .MRWREF, .MEF, .ERF, .KDC, .DCR, .CR2, .CRW, .BAY, .SR2, .SRF, .ARW, .3FR,\n.DNG, .CDR, .INDD, .EPS, .PDF, .PDD, .PSD, .DBF, .MDF, .WB2, .RTF, .WPD, .DXG, .DWG,\n.PST, .ODT, .DXF, .MP3,.MRW, .NEF, .JFIF, .DRF, .BLEND, .APJ, .3DS, .SDA, .PAT, .FXG,\n.FHD, .DXB, .DRW, .DESIGN, .DDRW, .DDOC, .DCS, .CSL, .CSH, .CPI, .CGM, .CDX, .CDRW,\n.CDR6, .CDR5, .CDR4, .CDR3, .AWG, .AIT, .AGD1, .YCBCRA, .STX, .ST8, .ST7, .ST6, .ST5,\n.ST4, .SD1, .SD0, .RWZ, .RA2, .PCD, .NWB, .NOP, .NDD, .MOS, .MFW, .MDC, .KC2, .IIQ,\n.GRY, .GREY, .GRAY, .FPX, .FFF, .EXF, .DC2, .CRAW, .CMT, .CIB, .CE2, .CE1, .3PR,\n.MPG, .SQLITEDB, .SQLITE3, .SQLITE, .SDF, .SAS7BDAT, .S3DB, .RDB, .PSAFE3, .NYF,\n.NX2, .NX1, .NSH, .NSG, .NSF, .NSD, .NS4, .NS3, .NS2, .MYD, .KPDX, .KDBX, .IDX, .IBZ,\n.IBD, .FDB, .ERBSQL, .DB3, .DB-JOURNAL, .CLS, .BDB, .ADB, .MONEYWELL, .MMW, .HBK,\n.FFD, .DGC, .DDD, .DAC, .CFP, .CDF, .BPW, .BGT, .ACR, .AC2, .AB4, .DJVU, .SXM, .ODF,\n.MSG, .STD, .SXD, .OTG, .STI, .SXI, .OTP, .ODG, .STC, .SXC, .OTS, .SXG, .STW, .SXW,\n.OTH, .OTT\n\n#### The Ransomware encrypts the first 512 Bytes of the File Header which will render most filetypes useless. It does not leave any Signature in the data of the files and neither does it append a custom extension to the filename.\n\n```\n\n-----\n\n#### Another IOC: It creates the following Mutex: 835821AM3218SAZ\n\n\n-----\n\n## Update 10.01.2020:\n\n#### The criminals obviously failed to properly display the key / victim ID in the Ransomnote. This was also a problem because the screwed encoding killed this Blogs Atom RSS Feed :D To resolve this issue I removed the malformed section from this page. If you want to have a look at the original note plus a couple of encrypted jpegs, download the zip file.\n\n Also this Malware family isn't as new as I originally thought. According to Michael Gillespie the MalwareHunterTeam found the first Maldoc in Late November. A few days later Checkpoint research found it as well:\n\n #Afrodita Ransomware, appears to be a new strain. Targeting businesses in Croatia via legitimate looking Excel spreadsheets.\n Subject: “Poziv na placanje” DZ: http://content-delivery[.]in/verynice.jpg XLSM: 597ec6887f3bcdc5077939bdf1fb69f1 DLL: ebacbff99234887d9f27719e48bafe59 pic.twitter.com/IM0h4fHUDT\n\n — Check Point Research (@CPResearch) December 3, 2019\n\n Today Michael also asked if anyone was able to parse the main-public.key because the format seems off. I extracted it from the binary:\n\n\n-----\n\n#### A quick look into the CryptoPP Wiki revealed that the key was in raw (uncooked) ASN.1 format (you can identify it by hex 30 82). Using an online ASN.1 decoder (Link) yields us the public key:\n\n\n-----\n\n```\n-----BEGIN RSA PUBLIC KEY----MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQEAxs2xkeHRygZBupFc2+Z//dLnMbWR/NiXQBmP\n10Q7nbG/5jaDcik+eGDh2zz6XYr2Ur+sS1yD4/1XQeIZ/zjcjC43H090nUlELTtq9ED8LqevnrOaMQFy\nUIhQU+plY5eJd6KuW2dCdv8n0uBDAzBQRnpjJr0AmnkEzRGD5XCoYtrR061kBAerXQjBxhQSnsMWxE2R\nexcq38tgf/szXPaoSD1vsSmIwXbc3nTkadYPfjLu6aWWYmikWIi3z+RoUOm7OhmaOu+azPCPBjHc93cB\nKsLnxzSHiKRFN4cd0Tu+uvehGl1+v3CK0Zj+nr5OfeNjMGYQj80t0+AqnDQkzwdA/wIBEQ==\n-----END RSA PUBLIC KEY----\n## MITRE ATT&CK\n\n#### T1179 --> Hooking --> Persistence\n\n T1179 --> Hooking --> Privilege Escalation\n\n T1045 --> Software Packing --> Defense Evasion\n\n T1179 --> Hooking --> Credential Access\n\n T1114 --> Email Collection --> Collection\n\n## IOCs\n\n### Afrodita\nnotnice.jpg --> SHA256:\n9b6681103545432cd1373492297a6a12528f327d14a7416c2b71cfdcbdafc90b\n        SSDEEP:\n6144:EXrm0zIiAhjC7Cqa5ZhiIJDQ13Xdksm1Cx2tJk:EbNQaCq6iIJcdksmJtJ\n\n Payload Servers\nhxxp://riskpartner[.]hr/wp-content/notnice.jpg\nhxxp://content-delivery[.]in/verynice.jpg\n\n E-Mail Addresses / Contact\n\n```\n\n-----\n\n```\nafroditateam@tutanota.com\nafroditasupport@mail2tor.com\nhxxps://t[.]me/RecoverySupport\n\n### Ransomnote\n~~~ Greetings ~~~\n[+] What has happened? [+]\nYour files are encrypted, and currently unavailable. You are free to check.\nEvery file is recoverable by following our instructions below.\nEncryption algorithms used: AES256(CBC) + RSA2048 (military/government grade).\n[+] Guarantees? [+]\nThis is our daily job. We are not here to lie to you - as you are 1 of 10000's.\nOur only interest is in us getting payed and you getting your files back.\nIf we were not able to decrypt the data, other people in same situation as you\nwouldn't trust us and that would be bad for our buissness -So it's not in our interest.\nTo prove our ability to decrypt your data you have 1 file free decryption.\nIf you don't want to pay the fee for bringing files back that's okey,\nbut remeber that you will lose a lot of time - and time is money.\nDon't waste your time and money trying to recover files using some file\nrecovery \"experts\", we have your private key - only we can get the files back.\nWith our service you can go back to original state in less then 30 minutes.\n[+] Service [+]\nIf you decided to use our service please follow instructions below.\nContact us:\nInstall Telegram(available for Windows,Android,iOS) and contact us on chat:\nTelegram contact: https://t.me/RecoverySupport\nAlso available at email afroditateam@tutanota.com cc: afroditasupport@mail2tor.com\nMake sure you are talking with us and not impostor by requiring free 1 file\ndecryption to make sure we CAN decrypt!!\n[Removed victim ID because it breaks the RSS Feed :D]\n\n#### Title Image by Robert Drózd, modified\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-09 - Not so nice after all - Afrodita Ransomware.pdf"
    ],
    "report_names": [
        "2020-01-09 - Not so nice after all - Afrodita Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536199,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653701311,
    "ts_modification_date": 1653701311,
    "files": {
        "pdf": "https://archive.orkl.eu/805db226788db581b305b2792019efb4e7e40465.pdf",
        "text": "https://archive.orkl.eu/805db226788db581b305b2792019efb4e7e40465.txt",
        "img": "https://archive.orkl.eu/805db226788db581b305b2792019efb4e7e40465.jpg"
    }
}