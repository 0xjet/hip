{
    "id": "f23cd795-69b1-4ac6-97af-50e7749ba058",
    "created_at": "2023-01-12T15:00:16.613802Z",
    "updated_at": "2025-03-27T02:06:04.486683Z",
    "deleted_at": null,
    "sha1_hash": "b1b5c3cbfdb18b4eeed39530e161176d4aedf20c",
    "title": "2017-05-01 - Another OSX.Dok dropper found installing new backdoor",
    "authors": "",
    "file_creation_date": "2022-05-28T17:59:28Z",
    "file_modification_date": "2022-05-28T17:59:28Z",
    "file_size": 531276,
    "plain_text": "# Another OSX.Dok dropper found installing new backdoor\n\n**[blog.malwarebytes.com/threat-analysis/2017/05/another-osx-dok-dropper-found-installing-new-backdoor/](https://blog.malwarebytes.com/threat-analysis/2017/05/another-osx-dok-dropper-found-installing-new-backdoor/)**\n\nThomas Reed May 1, 2017\n\nOn Friday [a sophisticated Mac Trojan was discovered, called OSX.Dok, which installs](https://blog.malwarebytes.com/threat-analysis/2017/04/new-osx-dok-malware-intercepts-web-traffic/)\nmalware designed to intercept all HTTP and HTTPS traffic. This morning, Adam Thomas, a\nMalwarebytes researcher, found a variant of the OSX.Dok dropper that behaves altogether\ndifferently and installs a completely different payload.\n\n## Distribution method\n\nThis variant has the same form as the dropper for OSX.Dok – a zipped app named\nDokument.app, masquerading as a document. It is signed with the same (now revoked)\ncertificate as the previous OSX.Dok dropper and it was first uploaded to VirusTotal around\nthe same time.\n```\nOSX.Dok.B SHA-256:\n54ee71f6ad1f91a6f162bd5712d1a2e3d3111c352a0f52db630dcb4638101938\n\n```\nAs with the previous variant, this one also copies itself to /Users/Shared/AppStore.app, and\ndisplays the same alert claiming that the app is damaged:\n\n\n-----\n\nHowever, this variant never displays the fake “OS X Updates Available” window, covering the\nentire screen. After a minute or so, it simply closes and deletes itself.\n\nInstead of installing OSX.Dok, this dropper installs an open-source backdoor named Bella,\ncreated by someone who identifies himself on GitHub only as “Noah.”\n\n## Behavior analysis\n\nNoah first joined GitHub back in 2015 but was not active there until August of 2016, when he\nbegan creating Python scripts to attack various macOS data, such as stealing iCloud\nauthorization tokens, or password and credit card information from Chrome.\n\nIn February of this year, he published the code for Bella, a Python script with some\nfrightening capabilities, including:\n\nExfiltration of iMessage and SMS chat transcripts\nLocation of devices via Find My iPhone and Find My Friends\nPhishing of passwords\nExfiltration of the keychain\nCapture of data from the microphone and webcam\nCreation and exfiltration of screenshots\nRemote shell and screen sharing\n\nBella even includes the capability to escalate to root privileges via vulnerabilities in the\nsystem (which only work on macOS 10.12.1 and earlier) or phishing to obtain an admin user\npassword. Some of the above capabilities rely on gaining root privileges, while others do not.\n\n\n-----\n\nBella comes with a script named BUILDER that can be used to customize some aspects of\nits behavior. This particular copy of Bella has been configured to connect to the following\nC&C server:\n```\nhost = '185.68.93.74' #Command and Control IP (listener will run on)\nport = 4545 #What port Bella will operate over\n\n```\nThis address is owned by a hosting company located in Moscow, Russia.\n\nThe malware has also been set to install the script, database, and launch agent files in the\nfollowing locations:\n```\n~/Library/Containers/.bella/Bella\n~/Library/Containers/.bella/bella.db\n~/Library/LaunchAgents/com.apple.iTunes.plist\n\n```\n\n-----\n\nIf root access can be achieved, it will instead be placed in the corresponding locations in the\nroot Library folder, rather than the user’s Library folder.\n\n## Conclusion\n\nOf course, since the code signing certificate on the Dokument.app dropper for this malware\nhas been revoked, no one can be newly-infected by this particular variant of this malware at\nthis point. However, since Bella is open-source and surprisingly powerful for a Python script,\nit’s quite likely it will be dropped by other malicious installers in the future.\n\nIt is unknown whether there is any connection between Noah, the author of Bella, and the\ncreators of the OSX.Dok malware. Bella may simply have been used by unrelated hackers\nsince it is freely available as open-source software.\n\n[Malwarebytes for Mac detects this malware as OSX.Bella. If you’ve been infected with this](https://malwarebytes.com/mac)\nmalware, after removing it, be sure to change all your passwords as well.\n\nBusiness users should be aware that this malware could exfiltrate a large amount of\ncompany data, including passwords, code signing certificates, hardware locations and much\nmore. If you’ve been infected, contact your IT department.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-05-01 - Another OSX.Dok dropper found installing new backdoor.pdf"
    ],
    "report_names": [
        "2017-05-01 - Another OSX.Dok dropper found installing new backdoor.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535616,
    "ts_updated_at": 1743041164,
    "ts_creation_date": 1653760768,
    "ts_modification_date": 1653760768,
    "files": {
        "pdf": "https://archive.orkl.eu/b1b5c3cbfdb18b4eeed39530e161176d4aedf20c.pdf",
        "text": "https://archive.orkl.eu/b1b5c3cbfdb18b4eeed39530e161176d4aedf20c.txt",
        "img": "https://archive.orkl.eu/b1b5c3cbfdb18b4eeed39530e161176d4aedf20c.jpg"
    }
}