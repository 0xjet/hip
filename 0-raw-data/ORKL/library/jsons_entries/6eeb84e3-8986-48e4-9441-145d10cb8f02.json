{
    "id": "6eeb84e3-8986-48e4-9441-145d10cb8f02",
    "created_at": "2023-01-12T15:05:13.264355Z",
    "updated_at": "2025-03-27T02:06:09.772254Z",
    "deleted_at": null,
    "sha1_hash": "34512c1e5a4989a61d173fa5c1de7896df821a91",
    "title": "2020-01-23 - German language malspam pushes Ursnif",
    "authors": "",
    "file_creation_date": "2022-05-27T23:29:45Z",
    "file_modification_date": "2022-05-27T23:29:45Z",
    "file_size": 2955081,
    "plain_text": "# SANS ISC: German language malspam pushes Ursnif - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training SANS ISC InfoSec Forums\n\n**[isc.sans.edu/forums/diary/German+language+malspam+pushes+Ursnif/25732/](https://isc.sans.edu/forums/diary/German+language+malspam+pushes+Ursnif/25732/)**\n\n**_Introduction_**\n\nOn Tuesday 2020-01-21, a wave of malicious spam (malspam) hit various recipients in\nGermany. Messages from this German malspam were email chains associated with infected\nWindows hosts, and these emails all had password-protected zip archives as attachments.\nA closer look revealed this malspam was pushing Ursnif.\n\nToday's diary reviews this malspam and an Ursnif infection from one of the attachments on\nTuesday 2020-01-21.\n\n_Shown above: Flow chart for an infection from this wave of German malspam._\n\n\n-----\n\n**_The malspam_**\n\nSee the next three images for examples from this wave of malspam. Of note, this campaign\noften used 777 as the password for the attached zip archive. In this wave of malspam, we\nsaw passwords 111, 333, and 555. Other passwords were probably used as well in\nexamples we have not yet reviewed.\n\n_Shown above: An example of the malspam from Tuesday 2020-01-21 (1 of 3)._\n\n\n-----\n\n_Shown above: An example of the malspam from Tuesday 2020-01-21 (2 of 3)._\n\n\n-----\n\n_Shown above: An example of the malspam from Tuesday 2020-01-21 (3 of 3)._\n\n**_The attachments_**\n\nUsing the password from the email, you can extract a Microsoft Word document from the\npassword-protected zip archive. The message in the Word document is in German, and it\ndirects you to enable macros. All of the Word documents are named info_01_21.doc. Of\nnote, in recent versions of Microsoft Office, you must disable Protected Mode and bypass\nsome other security features to enable macros and infect a vulnerable Windows host.\n\n\n-----\n\n_Shown above: Extracting a Word document from one of the password-protected zip_\n_archives._\n\n_Shown above: An example of an extracted Word document._\n\n**_The infection traffic_**\n\nInfection traffic is typical for Ursnif infections in recent months. Other examples of Ursnif\ntraffic can be found [here, which contains infections from 2019. Of note, the follow-up](https://unit42.paloaltonetworks.com/wireshark-tutorial-examining-ursnif-infections/)\nmalware for this Ursnif infection was another Ursnif variant.\n\n\n-----\n\n_Shown above: Traffic from an infection filtered in Wireshark._\n\n**_Forensics on an infected Windows host_**\n\nThe infected windows host contained artifacts commonly seen with these type of Ursnif\ninfections. See the images below for details.\n\n_Shown above: Artifacts in seen the C:\\Windows\\Temp directory after enabling macros._\n\n\n-----\n\n_Shown above: Follow-up malware found on the infected Windows host._\n\n_Shown above: Update to the Windows registry caused by Ursnif to keep it persistent on the_\n_infected host._\n\n**_Indicators of Compromise (IoCs)_**\n\nInfection traffic from the initial Ursnif infection:\n\n80.85.157[.]246 port 80 - emblareppy[.]com GET /gunshu/lewasy.php?l=ambobi9.cab\nport 80 - settings-win.data.microsoft[.]com - GET /images/[long string].avi\n80.85.153[.]218 port 80 - pzhmnbarguerite4819[.]com - GET /images/[long string].avi\n95.169.181[.]33 port 80 - n60peablo[.]com - GET /images/[long string].avi\n\n\n-----\n\nport 443 - settings-win.data.microsoft[.]com - HTTPS traffic\n45.141.103[.]204 port 443 - nk47yicbnnsi[.]com - HTTPS traffic\n\nRequest for the follow-up malware:\n\n104.193.252[.]157 port 80 - 104.193.252[.]157 - GET /fonelsid.rar\n\nInfection traffic caused by the follow-up malware (another Ursnif variant):\n\nport 80 - google[.]com - GET /\nport 80 - www.google[.]com - GET /\nDNS queries for onionpie[.]at - no response from the server\nDNS queries for tahhir[.]at - no response from the server\n80.249.145[.]116 port 80 - limpopo[.]at - GET /images/[long string]\n109.175[.]7.8 port 80 - estate-advice[.]at - GET /images/[long string]\n5.56.73[.]146 port 80 - sweetlights[.]at - GET /g32.bin\n5.56.73[.]146 port 80 - sweetlights[.]at - GET /g64.bin\n5.56.73[.]146 port 80 - estate-advice[.]at - POST /images/[long string]\n185.95.185[.]58 port 80 - estate-advice[.]at - GET /images/[long string]\n80.249.145[.]116 port 80 - limpopo[.]at - POST /images/[long string]\n51.223.47[.]15 port 80 - estate-advice[.]at - POST /images/[long string]\n\nMalware info:\n\nSHA256 hash:\n[957573dc5e13516da0d01f274ab28a141dddc8b6609fa35fde64a4900cb793e6](https://www.virustotal.com/gui/file/957573dc5e13516da0d01f274ab28a141dddc8b6609fa35fde64a4900cb793e6/)\n\nFile size: 127,243 bytes\nFile name: info_12_21.doc\nFile description: Word doc with macro for Ursnif\n\n[SHA256 hash: 05ec03276cdbb36fdd8433beca53b6c4a87fa827a542c5d512dcbb2cf93023c9](https://www.virustotal.com/gui/file/05ec03276cdbb36fdd8433beca53b6c4a87fa827a542c5d512dcbb2cf93023c9/)\n\nFile size: 3,651 bytes\nFile location: C:\\Windows\\Temp\\axsUG8.xsl\nFile description: XSL file dropped by Word macro\n\nSHA256 hash:\n[c7f801c491d705cd5e6a202c7c5084874235e19b5505d8e0201111cb3789a9c8](https://www.virustotal.com/gui/file/c7f801c491d705cd5e6a202c7c5084874235e19b5505d8e0201111cb3789a9c8/)\n\nFile size: 265,216 bytes\nFile location: hxxp://emblareppy[.]com/gunshu/lewasy.php?l=ambobi9.cab\nFile location: C:\\Windows\\Temp\\aaNuLh.dll\nFile description: Ursnif DLL file retrieved using XSL file\n\n\n-----\n\nDLL note: C:\\Windows\\System32\\rundll32.exe\nc:\\Windows\\Temp\\aaNuLh.dll,DllRegisterServer\n\nSHA256 hash:\n[df824e3e5bb15c7b74d5e8a021f3cbcd867100a02399b9c383488c660ae920b4](https://www.virustotal.com/gui/file/df824e3e5bb15c7b74d5e8a021f3cbcd867100a02399b9c383488c660ae920b4/)\n\nFile size: 873,472 bytes\nFile location: hxxp://104.193.252[.]157/fonelsid.rar\nFile location: C:\\Users\\[username]\\AppData\\Local\\Temp\\[random digits].exe\nFile description: Follow-up malware, another Ursnif variant\nFile location note: binary returned from fonelsid.rar URL was encoded/encrypted as it\nwas sent over the network\n\n**_Final words_**\n\nA pcap of the infection traffic, the associated malware and artifacts, and some malspam\n[examples can be found here.](https://www.malware-traffic-analysis.net/2020/01/21/index.html)\n\n--\nBrad Duncan\nbrad [at] malware-traffic-analysis.net\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-23 - German language malspam pushes Ursnif.pdf"
    ],
    "report_names": [
        "2020-01-23 - German language malspam pushes Ursnif.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535913,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1653694185,
    "ts_modification_date": 1653694185,
    "files": {
        "pdf": "https://archive.orkl.eu/34512c1e5a4989a61d173fa5c1de7896df821a91.pdf",
        "text": "https://archive.orkl.eu/34512c1e5a4989a61d173fa5c1de7896df821a91.txt",
        "img": "https://archive.orkl.eu/34512c1e5a4989a61d173fa5c1de7896df821a91.jpg"
    }
}