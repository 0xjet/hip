{
    "id": "bfbdb46d-ee18-4bb7-96f4-12a72bb7fd35",
    "created_at": "2022-10-25T16:48:24.369553Z",
    "updated_at": "2025-03-27T02:15:02.66784Z",
    "deleted_at": null,
    "sha1_hash": "d4ac9a7d29ae849228c231d4a329a0de75db03f5",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-03-04T08:11:16Z",
    "file_modification_date": "2020-03-04T08:11:16Z",
    "file_size": 132434,
    "plain_text": "# Longhorn: Tools used by cyberespionage group linked to Vault 7\n\n**[web.archive.org/web/20190222221536/https://www.symantec.com/connect/blogs/longhorn-tools-used-](https://web.archive.org/web/20190222221536/https://www.symantec.com/connect/blogs/longhorn-tools-used-cyberespionage-group-linked-vault-7)**\n\nApril 10, 2017\n\nSpying tools and operational protocols detailed in the recent Vault 7 leak have been used in\ncyberattacks against at least 40 targets in 16 different countries by a group Symantec calls\nLonghorn. Symantec has been protecting its customers from Longhorn’s tools for the past three\nyears and has continued to track the group in order to learn more about its tools, tactics, and\nprocedures.\n\nThe tools used by Longhorn closely follow development timelines and technical specifications laid\nout in documents disclosed by WikiLeaks. The Longhorn group shares some of the same\ncryptographic protocols specified in the Vault 7 documents, in addition to following leaked\nguidelines on tactics to avoid detection. Given the close similarities between the tools and\ntechniques, there can be little doubt that Longhorn's activities and the Vault 7 documents are the\nwork of the same group.\n\n## Who is Longhorn?\n\nLonghorn has been active since at least 2011. It has used a range of back door Trojans in\naddition to zero-day vulnerabilities to compromise its targets. Longhorn has infiltrated\ngovernments and internationally operating organizations, in addition to targets in the financial,\ntelecoms, energy, aerospace, information technology, education, and natural resources sectors.\nAll of the organizations targeted would be of interest to a nation-state attacker.\n\nLonghorn has infected 40 targets in at least 16 countries across the Middle East, Europe, Asia,\nand Africa. On one occasion a computer in the United States was compromised but, following\ninfection, an uninstaller was launched within hours, which may indicate this victim was infected\nunintentionally.\n\n#Vault7 linked #Longhorn group infiltrated governments, international orgs, other targets\n\n## The link to Vault 7\n\nA number of documents disclosed by WikiLeaks outline specifications and requirements for\nmalware tools. One document is a development timeline for a piece of malware called Fluxwire,\ncontaining a changelog of dates for when new features were incorporated. These dates align\n[closely with the development of one Longhorn tool (Trojan.Corentry) tracked by Symantec. New](https://www.symantec.com/security_response/writeup.jsp?docid=2015-111823-1849-99)\nfeatures in Corentry consistently appeared in samples obtained by Symantec either on the same\ndate listed in the Vault 7 document or several days later, leaving little doubt that Corentry is the\nmalware described in the leaked document.\n\nEarly versions of Corentry seen by Symantec contained a reference to the file path for the\nFluxwire program database (PDB) file. The Vault 7 document lists removal of the full path for the\nPDB as one of the changes implemented in Version 3.5.0.\n\n\n-----\n\nUp until 2014, versions of Corentry were compiled using GCC. According to the Vault 7\ndocument, Fluxwire switched to a MSVC compiler for version 3.3.0 on February 25, 2015. This\nwas reflected in samples of Corentry, where a version compiled on February 25, 2015 had used\nMSVC as a compiler.\n\n\n### Coren try com‐ piler\n\n\n### Em‐ bed‐ ded Core ntry ver‐ sion num ber\n\n\n### Vault 7 changelog number\n\n\n### Vault 7 changelog date\n\n Jan 12, 2011 - Feb 28, 2013\n\n\n### Corentry sample (MD5 hash)\n\n\n### Date/time of sample compila‐ tion\n\n\n### N/A N/A N/A N/A 2.1.0 - 2.4.1\n\n\n### e20d5255d8ab1ff5f157847d2f3ffb25 23/08/2013 10:20\n\n\n### 5d‐ f76f1ad59e019e52862585d27f1de2\n\n 318d8b61d642274d‐ d0513c293e535b38\n\n\n### 21/02/2014 11:07\n\n 15/05/2014 09:01\n\n\n### 3.0.0 GCC 3.0.0 Aug 23, 2013\n\n 3.1.0 GCC 3.1.0 Feb 20, 2014\n\n 3.1.1 GCC 3.1.1 May 14, 2014\n\n\n### N/A N/A N/A N/A 3.2.0 Jul 15, 2014\n\n\n### 511a473e26e7f10947561d‐ ed8f73ffd0\n\n c06d422656‐ ca69827f63802667723932\n\n\n### 03/09/2014 00:12\n\n 25/02/2015 16:50\n\n\n### 3.2.1 GCC 3.2.1 Aug 18, 2014\n\n N/A MSVC 3.3.0 Feb 25, 2015\n\n\n### N/A N/A N/A N/A 3.3.1 -> 3.5.0\n\n\n### May 17, 2015 -> Nov 13, 2015\n\n\n_Table. Corentry version numbers and compilation dates compared to Fluxwire version numbers_\n_and changelog dates disclosed in Vault 7_\n\nA second Vault 7 document details Fire and Forget, a specification for user-mode injection of a\npayload by a tool called Archangel. The specification of the payload and the interface used to\n[load it was closely matched in another Longhorn tool called Backdoor.Plexor.](https://www.symantec.com/security_response/writeup.jsp?docid=2017-040703-3623-99)\n\nA third document outlines cryptographic protocols that malware tools should follow. These include\nthe use of inner cryptography within SSL to prevent man-in-the-middle (MITM) attacks, key\nexchange once per connection, and use of AES with a 32-byte key. These requirements align\n\n\n-----\n\nwith the cryptographic practices observed by Symantec in all of the Longhorn tools.\n\nOther Vault 7 documents outline tradecraft practices to be used, such as use of the Real-time\nTransport Protocol (RTP) as a means of command and control (C&C) communications, employing\nwipe-on-use as standard practice, in-memory string de-obfuscation, using a unique deploymenttime key for string obfuscation, and the use of secure erase protocols involving renaming and\noverwriting. Symantec has observed Longhorn tools following all of these practices. While other\nmalware families are known to use some of these practices, the fact that so many of them are\nfollowed by Longhorn makes it noteworthy.\n\n## Global reach: Longhorn’s operations\n\nWhile active since at least 2011, with some evidence of activity dating back as far as 2007,\nLonghorn first came to Symantec’s attention in 2014 with the use of a zero-day exploit (CVE2014-4148) embedded in a Word document to infect a target with Plexor.\n\nThe malware had all the hallmarks of a sophisticated cyberespionage group. Aside from access\nto zero-day exploits, the group had preconfigured Plexor with elements that indicated prior\nknowledge of the target environment.\n\nTo date, Symantec has found evidence of Longhorn activities against 40 targets spread across 16\ndifferent countries. Symantec has seen Longhorn use four different malware tools against its\n[targets: Corentry, Plexor, Backdoor.Trojan.LH1, and Backdoor.Trojan.LH2.](https://www.symantec.com/security_response/writeup.jsp?docid=2017-040703-1537-99)\n\nBefore deploying malware to a target, the Longhorn group will preconfigure it with what appears\nto be target-specific code words and distinct C&C domains and IP addresses for communications\nback to the attackers. Longhorn tools have embedded capitalized code words, internally\nreferenced as “groupid” and “siteid”, which may be used to identify campaigns and victims. Over\n40 of these identifiers have been observed, and typically follow the theme of movies, characters,\nfood, or music. One example was a nod to the band The Police, with the code words REDLIGHT\nand ROXANNE used.\n\nLonghorn’s malware has an extensive list of commands for remote control of the infected\ncomputer. Most of the malware can also be customized with additional plugins and modules,\nsome of which have been observed by Symantec.\n\nLonghorn’s malware appears to be specifically built for espionage-type operations, with detailed\nsystem fingerprinting, discovery, and exfiltration capabilities. The malware uses a high degree of\noperational security, communicating externally at only select times, with upload limits on\nexfiltrated data, and randomization of communication intervals—all attempts to stay under the\nradar during intrusions.\n\nFor C&C servers, Longhorn typically configures a specific domain and IP address combination\nper target. The domains appear to be registered by the attackers; however they use privacy\nservices to hide their real identity. The IP addresses are typically owned by legitimate companies\noffering virtual private server (VPS) or webhosting services. The malware communicates with\nC&C servers over HTTPS using a custom underlying cryptographic protocol to protect\ncommunications from identification.\n\n\n-----\n\nPrior to the Vault 7 leak, Symantec’s assessment of Longhorn was that it was a well-resourced\norganization which was involved in intelligence gathering operations. This assessment was based\non its global range of targets and access to a range of comprehensively developed malware and\nzero-day exploits. The group appeared to work a standard Monday to Friday working week,\nbased on timestamps and domain name registration dates, behavior which is consistent with\nstate-sponsored groups.\n\nSymantec’s analysis uncovered a number of indicators that Longhorn was from an Englishspeaking, North American country. The acronym MTWRFSU (Monday Tuesday Wednesday\nThuRsday Friday Saturday SUnday) was used to configure which day of the week malware would\ncommunicate with the attackers. This acronym is common in academic calendars in North\nAmerica. Some of the code words found in the malware, such as SCOOBYSNACK, would be\nmost familiar in North America. In addition to this, the compilation times of tools with reliable\ntimestamps indicate a time zone in the Americas.\n\n## Distinctive fingerprints\n\nLonghorn has used advanced malware tools and zero-day vulnerabilities to infiltrate a string of\ntargets worldwide. Taken in combination, the tools, techniques, and procedures employed by\nLonghorn are distinctive and unique to this group, leaving little doubt about its link to Vault 7.\n\nThroughout its investigation of Longhorn, Symantec’s priority has been protection of its\ncustomers. Through identifying different strains of Longhorn malware, connecting them to a single\nactor, and learning more about the group’s tactics and procedures, Symantec has been able to\nbetter defend customer organizations against this and similar threats. In publishing this new\ninformation, Symantec’s goal remains unchanged: to reassure customers that it is aware of this\nthreat and actively working to protect them from it.\n\n## Protection\n\nSymantec and Norton products have been protecting against Longhorn malware for a number of\nyears with the following detections:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2017/2017.04.10_Longhorn/Longhorn_%20Tools%20used%20by%20cyberespionage%20group%20linked%20to%20Vault%207.pdf"
    ],
    "report_names": [
        "Longhorn_ Tools used by cyberespionage group linked to Vault 7"
    ],
    "threat_actors": [
        {
            "id": "23dfc9f5-1862-4510-a6ae-53d8e51f17b1",
            "created_at": "2024-05-01T02:03:08.146025Z",
            "updated_at": "2025-03-27T02:05:17.420497Z",
            "deleted_at": null,
            "main_name": "PLATINUM TERMINAL",
            "aliases": [
                "Longhorn ",
                "The Lamberts ",
                "Vault7 ",
                "APT-C-39 "
            ],
            "source_name": "Secureworks:PLATINUM TERMINAL",
            "tools": [
                " Assassin",
                " Marble Framework",
                "AfterMidnight"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e993faab-f941-4561-bd87-7c33d609a4fc",
            "created_at": "2022-10-25T16:07:23.460301Z",
            "updated_at": "2025-03-27T02:02:09.814816Z",
            "deleted_at": null,
            "main_name": "Longhorn",
            "aliases": [
                "APT-C-39",
                "Platinum Terminal",
                "The Lamberts"
            ],
            "source_name": "ETDA:Longhorn",
            "tools": [
                "Black Lambert",
                "Blue Lambert",
                "Corentry",
                "Cyan Lambert",
                "Fluxwire",
                "Gray Lambert",
                "Green Lambert",
                "Magenta Lambert",
                "Pink Lambert",
                "Plexor",
                "Purple Lambert",
                "Silver Lambert",
                "Violet Lambert",
                "White Lambert"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "70db80bd-31b7-4581-accb-914cd8252913",
            "created_at": "2023-01-06T13:46:38.57727Z",
            "updated_at": "2025-03-27T02:00:02.865012Z",
            "deleted_at": null,
            "main_name": "Longhorn",
            "aliases": [
                "the Lamberts",
                "APT-C-39",
                "PLATINUM TERMINAL"
            ],
            "source_name": "MISPGALAXY:Longhorn",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041702,
    "ts_creation_date": 1583309476,
    "ts_modification_date": 1583309476,
    "files": {
        "pdf": "https://archive.orkl.eu/d4ac9a7d29ae849228c231d4a329a0de75db03f5.pdf",
        "text": "https://archive.orkl.eu/d4ac9a7d29ae849228c231d4a329a0de75db03f5.txt",
        "img": "https://archive.orkl.eu/d4ac9a7d29ae849228c231d4a329a0de75db03f5.jpg"
    }
}