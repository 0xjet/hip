{
    "id": "35f69eef-a4e4-4c71-83a6-0f190d5b98ed",
    "created_at": "2022-10-25T16:48:22.017311Z",
    "updated_at": "2025-03-27T02:13:58.851173Z",
    "deleted_at": null,
    "sha1_hash": "52d49ad4a638382c49d28dce427c5723ebd8abd3",
    "title": "Evasive Tactics: Taidoor « Threat Research | FireEye Inc",
    "authors": "",
    "file_creation_date": "2015-11-24T14:49:56Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1051266,
    "plain_text": "**September 06, 2013 | By Nart Villeneuve, Thoufique Haq, Ned Moran | Threat Intelligence, Threat Research**\n\n**The Taidoor malware has been used in many ongoing cyber espionage campaigns. Its victims include**\n**government agencies, corporate entities, and think tanks, especially those with interests in Taiwan. [1] In a**\n**typical attack, targets receive a spear-phishing email which encourages them to open an attached file. If**\n**opened on a vulnerable system, malware is silently installed on the target’s computer while a decoy document**\n**with legitimate content is opened that is intended to alleviate any suspicions the target may have. Taidoor has**\n**been successfully compromising targets since 2008, and continues to be active today.**\n\n**Despite being around for a long time – and quite well known – Taidoor is a constantly evolving, persistent**\n**threat. We observed significant tactical changes in 2011 and 2012, when the malicious email attachments did**\n**not drop the Taidoor malware directly, but instead dropped a “downloader” that then grabbed the traditional**\n**Taidoor malware from the Internet. [2]**\n\n**Recently, we observed a new variant of Taidoor, which was used in targeted attacks. It has evolved in two**\n**ways. Instead of downloading the traditional Taidoor malware from a command-and-control (CnC) server, the**\n**“downloader” reaches out to Yahoo Blogs and retrieves encrypted text from blog posts. When decrypted by**\n**the “downloader”, this text is actually a modified version of the traditional Taidoor malware. This new version**\n**of Taidoor maintains similar behavior, but has been changed enough to avoid common network detection**\n**signatures.**\n\n**Traditional Taidoor Malware**\n\n**The Taidoor malware is traditionally delivered as an email attachment. If opened, the Taidoor malware is**\n**dropped onto the target’s system, and starts to beacon to a CnC server. Taidoor connects to its CnCs using**\n**HTTP, and the “GET” request has been consistent since 2008. It follows a simple pattern:**\n\n\n**GET /[5 characters].php?id=[6 numbers][12**\n**characters/numbers]**\n\n\n**The last set of 12 characters is actually the encrypted MAC address of the compromised computer. The**\n**values of the MAC address are incremented by 1, and this is used as an RC4 key to encrypt the data that is**\n**passed between the compromised computer and its CnC server.**\n\n**The New Taidoor**\n\n**In the past, other APT campaigns have used blog hosting platforms as a mechanism to transmit CnC server**\n**information to compromised targets. [3] Attackers using Taidoor have leveraged this model as well.**\n\n**We analyzed a sample (be1d972819e0c5bf80bf1691cc563400) that when opened exploits a vulnerability in**\n**Microsoft Office (CVE-2012-0158) to drop malware on the target’s computer.**\n\n\n-----\n\n**The decoy document contains background information on trade liberalization between the People’s Republic**\n**of China (PRC) and Taiwan.**\n\n**The various strings in the file are XOR-encoded with the key \"0x02\" or \"0x03\".**\n\n**This malware is a simple “downloader” that, instead of connecting to a CnC server, connects to a Yahoo Blog**\n**and downloads the contents of a blog post.**\n\n\n**GET /jw!JRkdqkKGAh6MPj9MlwbK6iMgScE-**\n**HTTP/1.1**\n\n\n**Accept:**\n**/**\n\n\n**Accept-Language: en-**\n**us**\n\n\n**User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET**\n**CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; InfoPath.2)**\n\n\n**Accept-Encoding: gzip, deflate**\n\n\n**Host:**\n**tw myblog yahoo com**\n\n\n-----\n\n**The content of the blog post between the markers “ctxugfbyyxyyyxyy” and “yxyyyxyyctxugfby” is encoded with**\n**base64 and encrypted using the RC4 cipher. The encryption key, which we discovered to be \"asdfasdf\", is**\n**also present in the contents of the base64 blog data in an encrypted form. The decrypted content of the blog**\n**post is a DLL file – that is in fact the Taidoor malware.**\n\n\n-----\n\n**CnC servers: roudan.serveftp.com (69.95.218.31) and mac.gov.hpc.tw (120.50.40.145). However, the network**\n**traffic (its “callback”) has been modified from the traditional version.**\n\n\n**GET /default.jsp?vx=vsutnh191138F9744C**\n**HTTP/1.1**\n\n\n**User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET**\n**CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)**\n\n\n**Host: mac.gov.hpc.tw:443**\n\n\n**Connection: Keep-Alive**\n\n\n**Cache-Control: no-**\n**cache**\n\n\n**Rather than having “[five characters].php”, this new file path ends in “.jsp” and may have any of the following**\n**file names:**\n\n**process**\n**page**\n**default**\n**index**\n**user**\n**parse**\n**about**\n**security**\n**query**\n**login**\n\n**The new format is:**\n\n\n**/[file name].jsp?[2 random characters]=[6 random characters][encrypted MAC**\n**address]**\n\n\n**In addition to the use of other malicious Word documents (b0fd4d5fb6d8acb1ccfb54d53c08f11f), we have**\n**also seen this new Taidoor variant distributed as a Windows ScreenSaver file (.scr) posing as a PDF**\n**(d9940a3da42eb2bb8e19a84235d86e91) or a Word document (c4de3fea790f8ff6452016db5d7aa33f).**\n\n\n-----\n\n**It remains unclear whether all of this Taidoor activity is related or different groups are using the same malware**\n**for different purposes. The fact that Taidoor is not off-the-shelf malware that can simply be downloaded or**\n**purchased in the cybercrime underground suggests that all of this activity may be connected in some way.**\n\n**So far, we have found only one large cluster of activity associated with this new Taidoor variant. This cluster,**\n**which made use of Yahoo Blogs, appears to have targeted entities in Taiwan. We found that traditional**\n**versions of Taidoor have also been using this infrastructure. [4]**\n\n**_Malware Connections_**\n\n**We found that another, possibly related, malware family known as “Taleret” is using the same technique that**\n**this Taidoor variant has used. We found that samples (such as 6cd1bf0e8adcc7208b82e1506efdba8d,**\n**525fd346b9511a84bbe26eb47b845d89 and 5c887a31fb4713e17c5dda9d78aab9fe) connect to Yahoo Blogs**\n**in order to retrieve a list of CnC servers.**\n\n\n-----\n\n**The content between the two markers “XXXXX” is encoded with base64 and encrypted with the RC4 cipher.**\n**The encryption key is “c37f12a0” in hex, and hardcoded in the malware.**\n\n\n-----\n\n**We extracted the following CnC servers from these blog posts:**\n\n**opp.gov.taiwans.tw**\n**nscnet.gov.medicare.tw**\n**mac.gov.skies.tw**\n**klserver.servehttp.com**\n**kllserver.serveftp.com**\n**202.142.153.154**\n**80.149.239.139**\n**202.142.172.131**\n**www.facebook.trickip.NET**\n**www.braintrust.AlmostMy.COM**\n\n**As with Taidoor, there appears to be a frequent association with Taiwan, in addition to a similar CnC naming**\n**scheme – such as mac.gov.hpc.tw (Taidoor) and mac.gov.skies.tw (Taleret).**\n\n\n-----\n\n**The Taidoor malware has been used to successfully compromise targets since 2008. This threat has evolved**\n**over time, and has recently leveraged Yahoo Blogs as a mechanism to drop the Taidoor malware as a**\n**“second stage” component. In addition, the well-known Taidoor network traffic pattern has been modified,**\n**likely as a new way to avoid network-based detection.**\n\n**Notes**\n\n**1. http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/trojan_taidoor-**\n**targeting_think_tanks.pdf**\n\n**2. http://blog.trendmicro.com/trendlabs-security-intelligence/taidoor-update-taidoor-gang-tags-its-victims/ and**\n**http://about-threats.trendmicro.com/us/spam/222/A%20Malware%20Treat%20this%20Halloween**\n\n**3. http://www.nartv.org/mirror/shadows-in-the-cloud.pdf and reports of associated malware here**\n**http://www.welivesecurity.com/2013/05/23/syndicasec-in-the-sin-bin/ and here**\n**http://www.cybersquared.com/apt_targetedattacks_within_socialmedia/**\n\n**4. MD5 hashes of traditional Taidoor samples 811aae1a66f6a2722849333293cbf9cd**\n**454c9960e89d02e4922245efb8ef6b49 5efc35315e87fdc67dada06fb700a8c7**\n**bc69a262bcd418d194ce2aac7da47286**\n\n**This entry was posted on Fri Sep 06 04:00:06 EDT 2013 and filed under Blog, Nart Villeneuve, Ned Moran,**\n**Thoufique Haq, Threat Intelligence and Threat Research.**\n\n\n**Be the first to receive information on major cyber attacks from the industry leader!**\n\n\n-----\n\n## Last Name\n\n\n## First Name\n\n\n**Subscribe**\n\n\n## Email Address\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2013/2013.09.06.EvasiveTactics_Taidoor/evasive-tactics-taidoor-3.pdf"
    ],
    "report_names": [
        "evasive-tactics-taidoor-3"
    ],
    "threat_actors": [
        {
            "id": "71b19e59-b5f7-4bc6-816d-194be0f02af0",
            "created_at": "2022-10-25T16:07:24.301036Z",
            "updated_at": "2025-03-27T02:02:10.165121Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Budminer",
                "Earth Aughisky"
            ],
            "source_name": "ETDA:Taidoor",
            "tools": [
                "Dripion",
                "Masson",
                "Taidoor",
                "simbot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "50bd4a6c-7542-4bdd-8b37-ab468fc428ef",
            "created_at": "2023-01-06T13:46:38.998658Z",
            "updated_at": "2025-03-27T02:00:02.973354Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "G0015",
                "Earth Aughisky"
            ],
            "source_name": "MISPGALAXY:Taidoor",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "478e9b27-39b9-49e4-a3c5-81569a767275",
            "created_at": "2022-10-25T15:50:23.417339Z",
            "updated_at": "2025-03-27T02:00:55.464624Z",
            "deleted_at": null,
            "main_name": "Taidoor",
            "aliases": [
                "Taidoor"
            ],
            "source_name": "MITRE:Taidoor",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041638,
    "ts_creation_date": 1448376596,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/52d49ad4a638382c49d28dce427c5723ebd8abd3.pdf",
        "text": "https://archive.orkl.eu/52d49ad4a638382c49d28dce427c5723ebd8abd3.txt",
        "img": "https://archive.orkl.eu/52d49ad4a638382c49d28dce427c5723ebd8abd3.jpg"
    }
}