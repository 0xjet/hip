{
    "id": "cc85219c-253a-4eb6-b177-e1d9a352b352",
    "created_at": "2022-10-25T16:48:23.123131Z",
    "updated_at": "2025-03-27T02:12:54.787235Z",
    "deleted_at": null,
    "sha1_hash": "6f6191debf6d1b800e5a5a9bee250c33255a6da2",
    "title": "Microsoft PowerPoint - When ransomware hits an ATM giant - The Diebold Nixdorf case dissected - Group-IB CyberCrimeCon2020.pptx",
    "authors": "",
    "file_creation_date": "2020-11-26T11:30:52Z",
    "file_modification_date": "2020-11-26T11:31:00Z",
    "file_size": 3539921,
    "plain_text": "# When ransomware hits an ATM giant\n#### The Diebold Nixdorf case dissected\n\n\n# When ransomware hits an ATM giant\n\n\n#### The Diebold Nixdorf case dissected\n\n\n-----\n\n## Who am I?\n\n### Frank Boldewin\n\n   - Executive Expert Security Operations & Defense at Fiducia & GAD IT AG\n\n   - EAST EGAF + EPTF member\n\n   - Reverser, Malware Researcher, Threat Intelligence dude\n\n   - Focused on hunting APTs targeting the financial industry\n\n### Fiducia & GAD IT AG\n\n   - IT service provider for Germany‘s Cooperative Financial Network\n\n   - Customers ~900 Volksbanken and Raiffeisenbanken, as well as numerous private Banks\n\n   - Providing a range of IT solutions, IT infrastructure services and hardware products\n\n   - Administering ~82 million banking accounts\n\n   - ~34000 ATMs and self service terminals\n\n\n-----\n\n## Background story 1/2\n\n###  At the end of April 2020, Diebold Nixdorf, one of the world's largest ATM manufacturers experienced an IT outage of some of their services.\n  This included the company's homepage and some of its mail servers, which were temporarily unavailable.\n\n\n-----\n\n## Background story 2/2\n\n###  On May 11, 2020 Krebsonsecurity.com reported about a ransomware incident at Diebold Nixdorf.\n  Some key statements:\n\n####  According to DN, the company‘s security team discovered a ransomware attack on April 25, 2020.\n  An investigation determined that the attackers installed the ProLock ransomware.\n  The incident did not affect the ATMs customers networks or the general public and its impact was not material to their business.\n  DN informed their customers about the situation and how they addressed it.\n\n\nSource: https://krebsonsecurity.com/2020/05/ransomware-hit-atm-giant-diebold-nixdorf/\n\n\n-----\n\n## Risk situation from customers perspective 1/2\n\n###  Unfortunately, the detail level in the blog post was not comprehensive enough to adequately clarify the question of how the attacks could spread to the company's own IT infrastructure.\n  Due to the increasing number of supply chain attacks in the last three years, the risk situation in the financial sector has also changed significantly.\n  Manufacturer This has led us to consider some worst-case scenarios which were already observed in the wild in a similar form.\n\n\n-----\n\n## Risk situation from customers perspective 2/2\n\n###  Assuming threat actors successfully implemented a sophisticated backdoor in the manufacturer’s ATM sources, they could gain unauthorized access to all devices on which the modified code has been deployed.\n  Furthermore, stolen credentials typically intended for customer support access, Manufacturer could also lead to attacker opportunities.\n\n\n-----\n\n## How the investigation started 1/3\n\n###  Looking for more details about the perpetrators, their actions and objectives, Fiducia & GAD conducted its own investigation to better understand the risk situation.\n  A specific search on the Virustotal resulted in two documents that were uploaded at the beginning of May 2020.\n\n\n-----\n\n## How the investigation started 2/3\n\n###  Inspecting the file with hash 5267cc… reveals information about its origin, its creator and another editor of the document.\n  In addition, there is also the date of initial creation on April 28, 2020 and the date of the last editing on May 1, 2020.\n\n\n-----\n\n## How the investigation started 3/3\n\n#####  The document was uploaded from Slovakia by an unknown user.\n  Based on the DN job openings (as of May 2020) available in that country, it is reasonable to assume that an incident response analyst from the Security Operations Center decided to scan the file for viruses before execution and uploaded it to Virustotal.\n  An OpSec failure unfortunately occurring quite often, even among people with security know-how.\n\n\n-----\n\n## Examination of the document content 1/2\n\n#### (hash 5267cc…)\n\n###  The forensic traces confirm the statements on Krebsonsecurity.com that files were encrypted with the ProLock ransomware.\n  Another interesting IOC is the reference to a Qakbot payload.\n  On May 4, 2020 the FBI issued a security alert reporting the ProLock gang gains initial access to victim networks via the Qakbot trojan since March 2020.\n  Files such as rdp.bat, Psexec.exe and adfind.exe were likely used for lateral movement to gain access to the domain controller or other interesting targets.\n\n\n-----\n\n## Examination of the document content 2/2\n\n#### (hash 5267cc…)\n\n###  In addition to the Qakbot sample, the payload domain can also be  found in the IOC document sollight.com[.]hk\n  Apparently, IP addresses of the range 172.x.x.x also showed malicious activity, which will be discussed later.\n\n\n-----\n\n## Infection timeline\n\n####  A Netflow analysis of the Qakbot payload domain sollight.com[.]hk reveals a top talker with a source IP 208.87.12.248 (belonging to Diebold- Nixdorf US).\n  As the chart illustrates the communication to the C2 has been terminated on April 26, 2020 after the company's employees noticed the attack and disconnected systems from their network to contain the spread of the malware. This coincides with the statements in the report on Krebsonsecurity.com\n\n\n-----\n\n## Reconstructed infection process\n\n\n-----\n\n## Malicious file analysis\n\n#### Operating Agreement_1.doc\n\n##### Compressed OLE stream containing obfuscated malicious macro code\n\n\n##### Deobfuscated macro code reveals PowerShell script downloading and executing the Qakbot payload.\n\n\n-----\n\n## Payload staging\n\n##### Based on the 172.x.x.x IP addresses from the IOC report, payloads were identified involved in the attack. For staging purposes attackers spawned a PowerShell script on infected systems, which in turn applies a Cobalt Strike shellcode.\n\n\n-----\n\n## ProLock Ransomware installation process 1/3\n\n#### There are usually 4 files involved in the installation of the ProLock ransomware:\n\n#####  run.bat\n  WinMgr.xml\n  clean.bat\n  WinMgr.bmp\n\n#### Filenames can vary, e.g. next to .BMP files also other formats have been spotted itw.  Diebold-Nixdorf case A fake .DIB file, which is preceded by a random 8-character name, e.g. 8A67B05B.dib, as the IOC report reveals.\n\n The file Run.bat is used to install a scheduled task on the Windows target systems.\n\n\n-----\n\n## ProLock Ransomware installation process 2/3\n\n### Schtasks.exe parses the configuration data from the file WinMgr.xml and then executes clean.bat.\n\n Clean.bat then executes a Base64-encoded PowerShell script.\n …\n\n\n-----\n\n## ProLock Ransomware installation process 3/3\n\n####  The decoded PowerShell script then reads the content of WinMgr.bmp\n  At first sight it appears to be a legitimate image file, but at a certain position the file contains the actual ProLock Ransomware shellcode, which the PowerShell script reads and then executes in memory.\n\n\n-----\n\n## Runtime decryption\n\n#### ProLock decrypts suspicious strings at runtime, trying to stay under the radar as long as possible.\n\n\n-----\n\n## YARA rule to detect ProLock\n\n#### https://raw.githubusercontent.com/fboldewin/YARA-rules/master/Prolock.Malware.yar\n\n\n-----\n\n## Conclusion\n\n###  Ransomware attacks have increased massively in the last two years, and the success rate even at large companies illustrates how sophisticated and professional the perpetrators operate to reach their goal.\n  If companies become victims of such an attack, a quick response is essential before the attackers can encrypt systems and/or exfiltrate sensitive data.\n  Keeping in mind that supply chain attacks are a growing threat, affected companies should provide customers with as much as information as possible, including TTPs, IOCs and recommendation for actions.\n  Gaining threat intelligence can help to get more insights even without having first hand information.\n\n\n-----\n\n## The end\n\n### Thanks to @Cocaman for exchanging ideas!\n\n Acknowledgement to Diebold Nixdorf for being cooperative after sharing my analysis with them, which allowed us to get further insights into their internal DFIR process of this case.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://raw.githubusercontent.com/fboldewin/When-ransomware-hits-an-ATM-giant---The-Diebold-Nixdorf-case-dissected/main/When%20ransomware%20hits%20an%20ATM%20giant%20-%20The%20Diebold%20Nixdorf%20case%20dissected%20-%20Group-IB%20CyberCrimeCon2020.pdf"
    ],
    "report_names": [
        "When%20ransomware%20hits%20an%20ATM%20giant%20-%20The%20Diebold%20Nixdorf%20case%20dissected%20-%20Group-IB%20CyberCrimeCon2020.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041574,
    "ts_creation_date": 1606390252,
    "ts_modification_date": 1606390260,
    "files": {
        "pdf": "https://archive.orkl.eu/6f6191debf6d1b800e5a5a9bee250c33255a6da2.pdf",
        "text": "https://archive.orkl.eu/6f6191debf6d1b800e5a5a9bee250c33255a6da2.txt",
        "img": "https://archive.orkl.eu/6f6191debf6d1b800e5a5a9bee250c33255a6da2.jpg"
    }
}