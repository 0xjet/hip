{
    "id": "47516a0f-faa8-45b2-9bf6-16c55145f4e9",
    "created_at": "2023-01-12T15:05:10.665322Z",
    "updated_at": "2025-03-27T02:08:00.119211Z",
    "deleted_at": null,
    "sha1_hash": "0e0a7a4e5903c6e82b2c04bb25a8225c263490c8",
    "title": "2021-05-24 - [RE022] Part 1- Quick analysis of malicious sample forging the official dispatch of the Central Inspection Committee",
    "authors": "",
    "file_creation_date": "2022-05-28T15:23:38Z",
    "file_modification_date": "2022-05-28T15:23:38Z",
    "file_size": 929430,
    "plain_text": "# [RE022] Part 1: Quick analysis of malicious sample forging the official dispatch of the Central Inspection Committee\n\n**blog.vincss.net/2021/05/re022-part1-quick-analysis-of-malicious-sample-forging-the-official-dispach-of-the-Central-**\nInspection-Committee.html\n\nThrough continuous cyber security monitoring, VinCSS has discovered a document\ncontaining malicious code with Vietnamese content that was found by ShadowChaser\nGroup(@ShadowChasing1) group. We think, this is maybe a cyberattack campaign that was\ntargeted in Vietnam, we have downloaded the sample file. Through a quick assessment, we\ndiscovered some interesting points about this sample, so we decided to analyze it. This is\nthe first part in a series of articles analyzing this sample.\n\nFile Name: Thông cáo báo chí Kỳ họp thứ nhất của Ủy ban Kiểm tra Trung ương khóa\n_XIII.docx_\n_SHA-256:_\n_[6f66faf278b5e78992362060d6375dcc2006bcee29ccc19347db27a250f81bcd](https://www.virustotal.com/gui/file/6f66faf278b5e78992362060d6375dcc2006bcee29ccc19347db27a250f81bcd)_\nFile size: 23.51 KB (24072 bytes)\nFile type: Office Open XML Document\n\nExtracting this .docx file and examining the extracted .xml files, we discovered that this\n**[.docx file was created and modified on Kingsoft Office software, which is a popular word](https://www.wps.cn/)**\nprocessing and document creation in China.\n\n\n-----\n\nWe found KSOProductBuildVer = 2052-11.1.0.10228. Search by this value, we guess it\ncould be Kingsoft Office 2019 version.\n\nContinue analyzing file with olevba tool:\n\n[With olevba’s results, it can be seen that this document applies Template Injection technique.](https://attack.mitre.org/techniques/T1221/)\n\nThe advantage of this technique is that when the user open the file, it will automatically\ndownload the Main.jpg file from the address hxxp://45[.]121[.]146[.]88/Apricot/Main.jpg.\n\n\n-----\n\nUp to the time of our analysis, the [Main.jpg file is still downloadable:](https://www.virustotal.com/gui/file/0c346972a2ccebb2642ced34213f43595896da233f06f6251967517ae342908f)\n\n**Main.jpg is an RTF file:**\n\nAccording to our analysis experience, these RTF files are often used to exploit vulnerabilities\nin Equation Editor. Check the file with rtfobj:\n\n\n-----\n\nBased on the results in above picture, we can determine that when executing the Main.jpg\nfile, it will drop the 5.t file into the %Temp% directory, through exploiting the vulnerability in\nthe Equation Editor to execute the shellcode, and then decode 5.t and execute this file. At\nthis point, there are two methods to decode 5.t:\n\n**Method 1: use** [rr_decoder.](https://github.com/nao-sec/rr_decoder)\n\nUse rtfobj to extract 5.t.\n\nUse rr_decode.py for decoding to get payload:\n\n**Method 2: Let’s the malware to perform its task by opening the RTF file, it will decrypt**\nthe 5.t payload and create a scheduled task to execute this file:\n\n\n-----\n\nCheck the decrypted file\n[(d198c4d82eba42cc3ae512e4a1d4ce85ed92f3e5fdff5c248acd7b32bd46dc75), this is a dll](https://www.virustotal.com/gui/file/d198c4d82eba42cc3ae512e4a1d4ce85ed92f3e5fdff5c248acd7b32bd46dc75)\nfile with the original name Download.dll. This file has only one exported function which is\n**StartW:**\n\nThrough examining the Download.dll file, we see it was built with Visual Studio 2019, linker\nversion 14.28. TimeDateStamp at build time is Thursday, 01.04.2021 01:59:48 UTC. This\nvalue is consistent in TimeDateStamp in FileHeader and Debug Info, type ILTCG.\n\n\n-----\n\nRichID information identified that the version of Visual Studio 2019 that the hacker is using is\n16.8. The current version of Visual Studio 2019 is 16.9(.6).\n\nDuring the analysis of this Download.dll file, we discovered indicators of the same code\nbase, reused from a previous campaign of an APT Panda group that was targeted in\n[Vietnam. The decoy document of that campaign is Dt-CT-cua-TTg.doc. Dt-CT-cua-TTg.doc](https://www.virustotal.com/gui/file/52aa0924797e3600d9a2d2f9f55526358aba19bcc25b5d22c98ce05d2b6cfc25/detection)\nfile is also an RTF file, which also takes advantage of Equation's bug to execute shellcode\n[and drop the first stage payload. For more information please read here.](https://medium.com/@sp1d3rm4n/apt-covid-19-v%C3%A0-nh%E1%BB%AFng-m%E1%BA%A3nh-%C4%91%E1%BB%9Di-61f224ee26cf)\n\nIn the next part, we will analyze Download.dll file in detail, showing the similarities in the\nsource code in this file and other PE files in the later payloads of the above campaign\nanalysis.\n\n_[Click here for Vietnamese version.](https://blog.vincss.net/2021/05/re022-phan-1-phan-tich-nhanh-mau-ma-doc-gia-mao-cong-van-cua-uy-ban-kiem-tra-tw-VietNam.html)_\n\n\n-----\n\n**Truong Quoc Ngan (aka HTC)**\n\n**Tran Trung Kien (aka m4n0w4r)**\n\n**Malware Analysis Expert**\n\n**R&D Center - VinCSS (a member of Vingroup)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-24 - [RE022] Part 1- Quick analysis of malicious sample forging the official dispatch of the Central Inspection Committee.pdf"
    ],
    "report_names": [
        "2021-05-24 - [RE022] Part 1- Quick analysis of malicious sample forging the official dispatch of the Central Inspection Committee.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535910,
    "ts_updated_at": 1743041280,
    "ts_creation_date": 1653751418,
    "ts_modification_date": 1653751418,
    "files": {
        "pdf": "https://archive.orkl.eu/0e0a7a4e5903c6e82b2c04bb25a8225c263490c8.pdf",
        "text": "https://archive.orkl.eu/0e0a7a4e5903c6e82b2c04bb25a8225c263490c8.txt",
        "img": "https://archive.orkl.eu/0e0a7a4e5903c6e82b2c04bb25a8225c263490c8.jpg"
    }
}