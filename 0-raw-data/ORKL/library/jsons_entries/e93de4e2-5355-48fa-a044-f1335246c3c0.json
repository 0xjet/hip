{
    "id": "e93de4e2-5355-48fa-a044-f1335246c3c0",
    "created_at": "2023-01-12T15:03:50.7908Z",
    "updated_at": "2025-03-27T02:09:18.125795Z",
    "deleted_at": null,
    "sha1_hash": "78e59cf12ef30c3e2ac701af9dd797320f468b72",
    "title": "2020-09-29 - CobaltStrikeScan",
    "authors": "",
    "file_creation_date": "2022-05-27T19:10:44Z",
    "file_modification_date": "2022-05-27T19:10:44Z",
    "file_size": 189857,
    "plain_text": "# CobaltStrikeScan\n\n**github.com/Apr4h/CobaltStrikeScan**\n\nApr4h\n\nScan files or process memory for Cobalt Strike beacons and parse their configuration.\n\nCobaltStrikeScan scans Windows process memory for evidence of DLL injection (classic or\nreflective injection) and/or performs a YARA scan on the target process' memory for Cobalt\nStrike v3 and v4 beacon signatures.\n\nAlternatively, CobaltStrikeScan can perform the same YARA scan on a file supplied by\nabsolute or relative path as a command-line argument.\n\nIf a Cobalt Strike beacon is detected in the file or process, the beacon's configuration will be\nparsed and displayed to the console.\n\n## Cloning This Repo\n\n[CobaltStrikeScan contains GetInjectedThreads as a submodule. Ensure you use](https://github.com/Apr4h/GetInjectedThreads) `git clone`\n```\n--recursive https://github.com/Apr4h/CobaltStrikeScan.git when cloning\n\n```\nCobaltStrikeScan so that the submodule's code is also downloaded/cloned.\n\n## Building the Solution\n\n\n-----\n\nCostura.Fody is configured to embed CommandLine.dll and libyara.NET.dll in the compiled\nCobaltStrikeScan.exe assembly. CobaltStrikeScan.exe should then serve as a static,\nportable version of CobaltStrikeScan. For this to occur, ensure that the \"Active Solution\nPlatform\" is set to x64 when building.\n\n## Acknowledgements\n\nThis project is inspired by the following research / articles:\n\n[SpecterOps - Defenders Think in Graphs Too](https://posts.specterops.io/defenders-think-in-graphs-too-part-1-572524c71e91)\n[JPCert - Volatility Plugin for Detecting Cobalt Strike](https://blogs.jpcert.or.jp/en/2018/08/volatility-plugin-for-detecting-cobalt-strike-beacon.html)\nSentinelLabs - The Anatomy of an APT Attack and CobaltStrike Beaconâ€™s Encoded\nConfiguration\n[Neo23x0's Signature Base for high-quality YARA signatures used to detect Cobalt](https://github.com/Neo23x0/signature-base)\nStrike's encoded configuration block.\n\n## Requirements\n\n64-bit Windows OS\n.NET Framework 4.6\nAdministrator or SeDebugPrivilege is required to scan process memory for injected\nthreads\n\n## Usage\n```\n -d, --directory-scan     Scan all process/memory dump files in a directory for\nCobalt Strike beacons\n -f, --scan-file        Scan a process/memory dump for Cobalt Strike beacons\n -i, --injected-threads    Scan running (64-bit) processes for injected threads\nand Cobalt Strike beacons\n -p, --scan-processes     Scan running processes for Cobalt Strike beacons\n -v, --verbose         Write verbose output\n -w, --write-process-memory  Write process memory to file when injected threads\nare detected\n -h, --help          Display Help Message\n --help            Display this help screen.\n --version           Display version information.\n\n Example\n\n```\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-09-29 - CobaltStrikeScan.pdf"
    ],
    "report_names": [
        "2020-09-29 - CobaltStrikeScan.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535830,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653678644,
    "ts_modification_date": 1653678644,
    "files": {
        "pdf": "https://archive.orkl.eu/78e59cf12ef30c3e2ac701af9dd797320f468b72.pdf",
        "text": "https://archive.orkl.eu/78e59cf12ef30c3e2ac701af9dd797320f468b72.txt",
        "img": "https://archive.orkl.eu/78e59cf12ef30c3e2ac701af9dd797320f468b72.jpg"
    }
}