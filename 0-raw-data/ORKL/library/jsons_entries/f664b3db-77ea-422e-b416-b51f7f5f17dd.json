{
    "id": "f664b3db-77ea-422e-b416-b51f7f5f17dd",
    "created_at": "2022-10-25T16:48:24.395472Z",
    "updated_at": "2025-03-27T02:17:05.704Z",
    "deleted_at": null,
    "sha1_hash": "ec503a9fa1206124e53d35eaba1c9d1a0d780202",
    "title": "BE2 Custom Plugins, Router Abuse, and Target Profiles - Securelist",
    "authors": "",
    "file_creation_date": "2016-01-29T10:23:47Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 1532622,
    "plain_text": "# 125\n\n\n# 101\n\n\n**Google**\n\n\n**The BlackEnergy malware is crimeware turned APT tool and is used in significant geopolitical**\n\n**operations lightly documented over the past year. An even more interesting part of the BlackEnergy**\n\n**story is the relatively unknown custom plugin capabilities to attack ARM and MIPS platforms, scripts for**\n\n**Cisco network devices, destructive plugins, a certificate stealer and more. Here, we present available**\n\n**data – it is difficult to collect on this APT. We will also present more details on targets previously**\n\n**unavailable and present related victim profile data.**\n\n**These attackers are careful to hide and defend their long-term presence within compromised**\n\n**environments. The malware’s previously undescribed breadth means attackers present new technical**\n\n**challenges in unusual environments, including SCADA networks. Challenges, like mitigating the**\n\n**attackers’ lateral movement across compromised network routers, may take an organization’s**\n\n**defenders far beyond their standard routine and out of their comfort zone.**\n\n\n-----\n\n**BlackEnergy2 and BlackEnergy3 are known tools. Initially, cybercriminals used BlackEnergy custom**\n\n**plugins for launching DDoS attacks. There are no indications of how many groups possess this tool.**\n\n**BlackEnergy2 was eventually seen downloading more crimeware plugins – a custom spam plugin and**\n\n**a banking information stealer custom plugin. Over time, BlackEnergy2 was assumed into the toolset of**\n\n**the BE2/Sandworm actor. While another crimeware group continues to use BlackEnergy to launch**\n\n**DDoS attacks, the BE2 APT appears to have used this tool exclusively throughout 2014 at victim sites**\n\n**and included custom plugins and scripts of their own. To be clear, our name for this actor has been the**\n\n**BE2 APT, while it has been called “Sandworm Team” also.**\n\n**Before evidence of BlackEnergy2 use in targeted attacks was uncovered, we tracked strange activity**\n\n**on one of the BlackEnergy CnC servers in 2013. This strangeness was related to values listed in**\n\n**[newer BlackEnergy configuration files. As described in Dmitry’s 2010 Black DDoS’ analysis, a](http://securelist.com/analysis/36309/black-ddos/)**\n\n**configuration file is downloaded from the server by main.dll on an infected system. The config file**\n\n**provides download instructions for the loader. It also instructs the loader to pass certain commands to**\n\n**the plugins. In this particular case in 2013, the config file included an unknown plugin set, aside from**\n\n**the usual ‘ddos’ plugin listing. Displayed below are these new, xml formatted plugin names “weap_hwi”,**\n\n**“ps”, and “vsnet” in a BlackEnergy configuration file download from a c2 server. This new module push**\n\n**must have been among the first for this group, because all of the module versions were listed as**\n\n**“version 1”, including the ddos plugin:**\n\n\n-----\n\n**_Config downloaded from BE2 server_**\n\n**The ‘ps’ plugin turned out to be password stealer. The ‘vsnet’ plugin was intended to spread and launch**\n\n**a payload (BlackEnergy2 dropper itself at the moment) in the local network by using PsExec, as well as**\n\n**gaining primary information on the user’s computer and network.**\n\n**Most surprising was the ‘weap_hwi’ plugin. It was a ddos tool compiled to run on ARM systems:**\n\n\n-----\n\n**_Weap_hwi plugin_**\n\n**At first, we didn’t know whether the ARM plugin was listed intentionally or by mistake, so we proceeded**\n\n**to collect the CnC’s config files. After pulling multiple config files, we confirmed that this ARM object**\n\n**inclusion was not a one-off mistake. The server definitely delivered config files not only for Windows,**\n\n**but also for the ARM/MIPS platform. Though unusual, the ARM module was delivered by the same**\n\n**server and it processed the same config file.**\n\n**Over time we were able to collect several plugins as well as the main module for ARM and MIPS**\n\n**architectures. All of these ARM/MIPS object files were compiled from the same source and later pushed**\n\n**out in one config: “weap_msl”, “weap_mps”, “nm_hwi”, “nm_mps”, “weap_hwi”, and “nm_msl”. It’s**\n\n**interesting that the BE2 developers upgraded the ddos plugin to version 2, along with the nm_hwi,**\n\n**nm_mps, and nm_msl plugins. They simultaneously released version 5 of the weap_msl, weap_mps,**\n\n**and weap_hmi plugins. Those assignments were not likely arbitrary, as this group had developed**\n\n**BlackEnergy2 for several years in a professional and organized style:**\n\n\n-----\n\n**_Config with a similar set of plugins for different architectures_**\n\n**Here is the list of retrieved files and related functionality:**\n\n**weap** **DDoS Attack (various types)**\n\n**password stealer handling a variety of network protocols**\n**ps**\n\n**(SMTP, POP3, IMAP, HTTP, FTP, Telnet)**\n\n**nm** **scans ports, stores banners**\n\n**snif** **logs IP source and destination, TCP/UDP ports**\n\n**hook** **main module: CnC communication, config parser, plugins loader**\n\n**uper** **rewrites hook module with a new version and launches it**\n\n\n-----\n\n**_Weap, Snif, Nm plugin grammar mistakes and mis-spellings_**\n\n**The developers’ coding style differed across the ‘Hook’ main module, the plugins, and the Windows**\n\n**main.dll. The hook main module contained encrypted strings and handled all the function calls and**\n\n**strings as the references in a large structure. This structure obfuscation may be a rewrite effort to better**\n\n**modularize the code, but could also be intended to complicate analysis. Regardless, it is likely that**\n\n**different individuals coded the different plugins. So, the BE2 effort must have its own small team of**\n\n**plugin and multiplatform developers.**\n\n\n-----\n\n**_Hook module structure_**\n\n**After decrypting the strings, it became clear that the Linux Hook main module communicated with the**\n\n**same CnC server as other Windows modules:**\n\n**_The CNC’s IP address in the Linux module_**\n\n**This Linux module can process the following commands, some of which are similar to the Windows**\n\n**version:**\n\n\n-----\n\n**die** **delete all BlackEnergy2 files and system traces**\n\n**kill** **delete all BlackEnergy2 files and system traces and reboot**\n\n**lexec** **launch a command using bin/sh**\n\n**rexec** **download and launch file using ‘fork/exec’**\n\n**update** **rewrite self file**\n\n**migrate** **update the CnC server**\n\n**After the disclosure of an unusual CnC server that pushed Linux and the new Windows plugins we paid**\n\n**greater attention to new BE2 samples and associated CnCs.**\n\n**During an extended period, we were able to collect many Windows plugins from different CnC servers,**\n\n**without ever noticing Linux plugins being downloaded as described above. It appears**\n\n**the BE2/SandWorm gang protected their servers by keeping their non-Windows hacker tools and**\n\n**plugins in separate servers or server folders. Finally, each CnC server hosts a different set of plugins,**\n\n**meaning that each server works with different victims and uses plugins based on its current needs.**\n\n**Here is the summary list of all known plugins at the moment:**\n\n**fs** **searches for given file types, gets primary system and network information**\n\n**ps** **password stealer from various sources**\n\n**ss** **makes screenshots**\n\n**spreads payload in the local network (uses psexec, accesses admin**\n**vsnet**\n\n**shares), gets primary system and network information**\n\n**rd** **remote desktop**\n\n**scan** **scans ports of a given host**\n\n**grc** **backup channel via plus.google.com**\n\n**file infector (local, shares, removable devices) with the given payload**\n**jn**\n\n**downloaded from CnC**\n\n**cert** **certificate stealer**\n\n\n**logs traffic, extracts login-passwords from different protocol (HTTP, LDAP,**\n**sn**\n\n**FTP, POP3, IMAP, Telnet )**\n\n**tv** **sets password hash in the registry for TeamViewer**\n\n**prx** **Proxy server**\n\n**Destroys hard disk by overwriting with random data (on application level**\n**dstr**\n\n**and driver level) at a certain time**\n\n**kl** **keylogger**\n\n**upd** **BE2 service file updater**\n\n\n**gathers information on connected USBs (Device instance ID, drive**\n**usb**\n\n**geometry)**\n\n\n-----\n\n**We are pretty sure that our list of BE2 tools is not complete. For example, we have yet to obtain the**\n\n**router access plugin, but we are confident that it exists. Evidence also supports the hypothesis that**\n\n**there is a encryption plugin for victim files (see below).**\n\n**Our current collection represents the BE2 attackers’ capabilities quite well. Some plugins**\n\n**remain mysterious and their purpose is not yet clear, like ‘usb’ and ‘bios’. Why would the attackers need**\n\n**information on usb and bios characteristics? It suggests that based on a specific USB and BIOS**\n\n**devices, the attackers may upload specific plugins to carry out additional actions. Perhaps destructive,**\n\n**perhaps to further infect devices. We don’t know yet.**\n\n**It’s also interesting to point out another plugin – ‘grc’. In some of the BE2 configuration files, we can**\n\n**notice an value with a “gid” type:**\n\n**_The addr number in the config_**\n\n**This number is an ID for the plus.google.com service and is used by the ‘grc’ plugin to parse html. It**\n\n**then downloads and decrypts a PNG file. The decrypted PNG is supposed to contain a new config file,**\n\n**but we never observed one. We are aware of two related GooglePlus IDs. The first one,**\n\n**plus.google.com/115125387226417117030/, contains an abnormal number of views. At the time of**\n\n**writing, the count is 75 million:**\n\n\n-----\n\n**_BE2 plus profile_**\n\n**The second one – plus.google.com/116769597454024178039/posts – is currently more modest at a**\n\n**little over 5,000 views. All of that account’s posts are deleted.**\n\n**During observation of the described above “router-PC” CnC we tracked the following commands**\n\n**delivered in the config file before the server went offline. Our observation of related actions here:**\n\n**u ps** **start password stealing (Windows)**\n\n**Ps_mps/ps_hwi start** **start password stealing (Linux, MIPS, ARM)**\n\n**rewrite hook module with a new version and launch it (Linux,**\n**uper_mps/uper_hwi start**\n\n**MIPS, ARM)**\n\n\n**Nm_mps/nm_hwi start –ban**\n\n**-middle**\n\n\n**Scan ports and retrieve banners on the router subnet (Linux,**\n\n**MIPS, ARM)**\n\n\n**U fsget * 7 *.docx, *.pdf, *.doc**\n\n**search for docs with the given filetypes (Windows)**\n*****\n\n**retrieve information on installed programs and launch**\n\n\n**S sinfo**\n\n**weap_mps/weap_hwi**\n\n**host188.128.123.52**\n\n**port[25,26,110,465,995]**\n\n**typetcpconnect**\n\n**weap_mps/weap_hwi**\n\n**typesynflood port80**\n\n**cnt100000 spdmedium**\n\n**host212.175.109.10**\n\n\n**commands: systeminfo, tasklist, ipconfig, netstat, route print,**\n\n**[tracert www.google.com (Windows)](http://www.google.com)**\n\n**DDoS on 188.128.123.52 (Linux, MIPS, ARM)**\n\n**DDoS on 212.175.109.10 (Linux, MIPS, ARM)**\n\n\n**The issued commands for the Linux plugins suggest the attackers controlled infected MIPS/ARM**\n\n**devices. We want to pay special attention to the DDoS commands meant for these routers.**\n\n**188.128.123.52 belongs to the Russian Ministry of Defense and 212.175.109.10 belongs to the Turkish**\n\n**Ministry of Interior’s government site. While many researchers suspect a Russian actor is behind BE2,**\n\n**j d i** **b th i t** **k d** **ti iti** **d th** **i ti** **fil** **it’** **till** **l** **h** **i t** **t th** **t**\n\n\n-----\n\n**mistakes and mis-typing. They are highlighted in the image below:**\n\n**_BE2 config file mistakes_**\n\n**First, these mistakes suggest that the BE2 attackers manually edit these config files. Secondly, it shows**\n\n**that even skilled hackers make mistakes.**\n\n**The contents of the config files themselves are fairly interesting. They all contain a callback c2 with a**\n\n**hardcoded ip address, contain timeouts, and some contain the commands listed above. We include a**\n\n**list of observed hardcoded ip C2 addresses here, along with the address owner and geophysical**\n\n**location of the host:**\n\n**C2 IP address** **Owner** **Country**\n\n**184.22.205.194** **hostnoc.net** **US**\n\n**5.79.80.166** **Leaseweb** **NL**\n\n**46.165.222.28** **Leaseweb** **NL**\n\n**95 211 122 36** **Leaseweb** **NL**\n\n\n-----\n\n**46.165.222.6** **Leaseweb** **NL**\n\n**89.149.223.205** **Leaseweb** **NL**\n\n**85.17.94.134** **Leaseweb** **NL**\n\n**46.4.28.218** **Hetzner** **DE**\n\n**78.46.40.239** **Hetzner** **DE**\n\n**95.143.193.182** **Serverconnect** **SE**\n\n**188.227.176.74** **Redstation** **GB**\n\n**93.170.127.100** **Nadym** **RU**\n\n**37.220.34.56** **Yisp** **NL**\n\n**194.28.172.58** **Besthosting.ua** **UA**\n\n**124.217.253.10** **PIRADIUS** **MY**\n\n**84.19.161.123** **Keyweb** **DE**\n\n**109.236.88.12** **worldstream.nl** **NL**\n\n**212.124.110.62** **digitalone.com** **US**\n\n**5.61.38.31** **3nt.com** **DE**\n\n**5.255.87.39** **serverius.com** **NL**\n\n**It’s interesting that one of these servers is a Tor exit node. And, according to the collected config files,**\n\n**the group upgraded their malware communications from plain text http to encrypted https in October**\n\n**2013.**\n\n**BlackEnergy2 victims are widely distributed geographically. We identified BlackEnergy2 targets and**\n\n**victims in the following countries starting in late 2013. There are likely more victims.**\n\n**Russia**\n\n**Ukraine**\n\n**Poland**\n\n**Lithuania**\n\n**Belarus**\n\n**Azerbaijan**\n\n**Kyrgyzstan**\n\n**Kazakhstan**\n\n**Iran**\n\n**Israel**\n\n**Turkey**\n\n**Libya**\n\n**Kuwait**\n\n**Taiwan**\n\n**Vietnam**\n\n\n-----\n\n**Germany**\n\n**Belgium**\n\n**Sweden**\n\n**Victim profiles point to an expansive interest in ICS:**\n\n**power generation site owners**\n\n**power facilities construction**\n\n**power generation operators**\n\n**large suppliers and manufacturers of heavy power related materials**\n\n**investors**\n\n**However, we also noticed that the target list includes government, property holding, and technology**\n\n**organizations as well:**\n\n**high level government**\n\n**other ICS construction**\n\n**federal land holding agencies**\n\n**municipal offices**\n\n**federal emergency services**\n\n**space and earth measurement and assessment labs**\n\n**national standards body**\n\n**banks**\n\n**high-tech transportation**\n\n**academic research**\n\n**We gained insight into significant BE2 victim profiles over the summer of 2014. Interesting BE2**\n\n**incidents are presented here.**\n\n**Victim #1**\n\n**The BE2 attackers successfully spearphished an organization with an exploit for which there is no**\n\n**current CVE, and a metasploit module has been available This email message contained a ZIP archive**\n\n**with EXE file inside that did not appear to be an executable. This crafted zip archive exploited a**\n\n**WinRAR flaw that makes files in zip archives appear to have a different name and file extension.**\n\n\n-----\n\n**_BE2 spearphish example_**\n\n**The attached exe file turned out to be ‘BlackEnergy-like’ malware, which researchers already dubbed**\n\n**‘BlackEnergy3’ – the gang uses it along with BlackEnergy2. Kaspersky Lab detects ‘BlackEnergy3’**\n\n**malware as Backdoor.Win32.Fonten – naming it after its dropped file “FONTCACHE.DAT”**\n\n**When investigating computers in the company’s network, only BE2 associated files were found,**\n\n**suggesting BE3 was used as only a first-stage tool on this network. The config files within BE2**\n\n**contained the settings of the company’s internal web proxy:**\n\n**_BE2 config file contains victim’s internal proxy_**\n\n**As the APT-specific BE2 now stores the downloaded plugins in encrypted files on the system (not seen**\n\n**in older versions – all plugins were only in-memory), the administrators were able to collect BE2 files**\n\n**from the infected machines. After decrypting these files, we could retrieve plugins launched on infected**\n\n**machines: ps, vsnet, fs, ss, dstr.**\n\n**By all appearances, the attackers pushed the ‘dstr’ module when they understood that they were**\n\n**l d** **d** **t d t** **hid** **th i** **th** **hi** **S** **hi** **l** **d l** **h d th**\n\n\n-----\n\n**_Destructive dstr command in BE2 config file_**\n\n**Also, on some machines, documents were encrypted, but no related plugin could be found.**\n\n**Victim #2**\n\n**The second organization was hacked via the first victim’s stolen VPN credentials. After the second**\n\n**organization was notified about the infection they started an internal investigation. They confirmed that**\n\n**some data was destroyed on their machines, so the BE2 attackers have exhibited some level of**\n\n**destructive activity. And, they revealed that their Cisco routers with different IOS versions were hacked.**\n\n**They weren’t able to connect to the routers any more by telnet and found the following “farewell” tcl**\n\n**scripts in the router’s file system:**\n\n**Ciscoapi.tcl – contains various wrappers over cisco EXEC-commands as described in the comments.**\n\n**The comment includes a punchy message for “kasperRsky”:**\n\n\n-----\n\n**_BE2 ciscoapi.tcl fragment_**\n\n**Killint.tcl – uses Ciscoapi.tcl, implements destroying functions:**\n\n\n-----\n\n**_BE2 killint.tcl fragment_**\n\n**The script tries to download ciscoapi.tcl from a certain FTP server which served as a storage for BE2**\n\n**files. The organization managed to discover what scripts were hosted on the server before**\n\n**BE/SandWorm gang deleted them, and unfortunately couldn’t restore them after they were deleted. The**\n\n**BE2 actor performs careful, professional activity covering their tracks:**\n\n**ciscoapi.tcl**\n\n**killint.tcl**\n\n**telnetapi2.tcl**\n\n**telnetu.tcl**\n\n**stub.tcl**\n\n**stub1.tcl**\n\n**There is evidence that the logs produced by some scripts were also stored on the FTP server, in**\n\n**particular the information on CDP neighbors which is provided by one of the procedures of ciscoapi.tcl.**\n\n**Victim #3**\n\n**Th** **thi d** **i** **ti** **t** **i** **d b th** **t** **f** **tt** **k** **th** **fi** **t** **(** **EXE fil**\n\n\n-----\n\n**no revelation of hacked network devices on their side and no destroyed data. The noticeable thing is**\n\n**that many computers contained both BE2 and BE3 files and some config files contained the following**\n\n**URL:**\n\n**hxxps://46.165.222(dot)28/upgrade/f3395cd54cf857ddf8f2056768ff49ae/getcfg.php**\n\n**The URL contains the md5 of the string ‘router’. One of the discovered config files contained a URL**\n\n**with an as yet unidentified md5:**\n\n**hxxps://46.165.222(dot)28/upgrade/bf0dac805798cc1f633f19ce8ed6382f/upgrade.php**\n\n**Victim set #4**\n\n**A set of victims discovered installed Siemens SCADA software in their ICS environment was**\n\n**responsible for downloading and executing BlackEnergy. Starting in March 2014 and ending in July**\n\n**2014, Siemens “ccprojectmgr.exe” downloaded and executed a handful of different payloads hosted**\n\n**at 94.185.85.122/favicon.ico. They are all detected as variants of “Backdoor.Win32.Blakken”.**\n\n**Each config file within BE2 main.dll has a field called build_id which identifies the malware version for**\n\n**the operators. Currently this particular BE/SandWorm gang uses a certain pattern for the build ids**\n\n**containing three hex numbers and three letters, as follows:**\n\n**0C0703hji**\n\n**The numbers indicate the date of file creation in the format: Year-Month-Day. Still, the purpose of the**\n\n**letters is unknown, but most likely it indicates the targets. The hex numbers weren’t used all the time,**\n\n**sometimes we observed decimal numbers:**\n\n**100914_mg**\n\n**100929nrT**\n\n**Most interesting for us was the earliest build id we could find. Currently it is “OB020Ad0V”, meaning**\n\n**that the BE2/SandWorm APT started operating as early as the beginning of 2010.**\n\n**Since BE dropper installs its driver under a randomly picked non-used Windows driver name, there is**\n\n**no a static name for a driver to use it as IOC. The driver is self-signed on 64-bit systems**\n\n\n-----\n\n**%system32%\\drivers\\winntd_.dat**\n\n**%system32%\\drivers\\winntd.dat**\n\n**%system32%\\drivers\\wincache.dat**\n\n**%system32%\\drivers\\mlang.dat**\n\n**%system32%\\drivers\\osver32nt.dat**\n\n**%LOCALAPPDATA%\\adobe\\wind002.dat**\n\n**%LOCALAPPDATA%\\adobe\\settings.sol**\n\n**%LOCALAPPDATA%\\adobe\\winver.dat**\n\n**%LOCALAPPDATA%\\adobe\\cache.dat**\n\n**BE2 also uses start menu locations for persistence:**\n\n**Users\\user\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\flashplayerapp.exe**\n\n**BE3 uses the following known filenames:**\n\n**%USERPROFILE%\\NTUSER.LOG**\n\n**%LOCALAPPDATA%\\FONTCACHE.DAT**\n\n**BE2 MD5s:**\n\n**d57ccbb25882b16198a0f43285dafbb4**\n\n**7740a9e5e3feecd3b7274f929d37bccf**\n\n**948cd0bf83a670c05401c8b67d2eb310**\n\n**f2be8c6c62be8f459d4bb7c2eb9b9d5e**\n\n**26a10fa32d0d7216c8946c8d83dd3787**\n\n**8c51ba91d26dd34cf7a223eaa38bfb03**\n\n**c69bfd68107ced6e08fa22f72761a869**\n\n**3cd7b0d0d256d8ff8c962f1155d7ab64**\n\n**298b9a6b1093e037e65da31f9ac1a807**\n\n**d009c50875879bd2aefab3fa1e20be09**\n\n**88b3f0ef8c80a333c7f68d9b45472b88**\n\n**17b00de1c61d887b7625642bad9af954**\n\n**27eddda79c79ab226b9b24005e2e9b6c**\n\n**48937e732d0d11e99c68895ac8578374**\n\n**82418d99339bf9ff69875a649238ac18**\n\n**f9dcb0638c8c2f979233b29348d18447**\n\n**72372ffac0ee73dc8b6d237878e119c1**\n\n**c229a7d86a9e9a970d18c33e560f3dfc**\n\n**ef618bd99411f11d0aa5b67d1173ccdf**\n\n**383c07e3957fd39c3d0557c6df615a1a**\n\n**105586891deb04ac08d57083bf218f93**\n\n**1deea42a0543ce1beeeeeef1ffb801e5**\n\n\n-----\n\n**d10734a4b3682a773e5b6739b86d9b88**\n\n**632bba51133284f9efe91ce126eda12d**\n\n**a22e08e643ef76648bec55ced182d2fe**\n\n**04565d1a290d61474510dd728f9b5aae**\n\n**3c1bc5680bf93094c3ffa913c12e528b**\n\n**6a03d22a958d3d774ac5437e04361552**\n\n**0217eb80de0e649f199a657aebba73aa**\n\n**79cec7edf058af6e6455db5b06ccbc6e**\n\n**f8453697521766d2423469b53a233ca7**\n\n**8a449de07bd54912d85e7da22474d3a9**\n\n**3f9dc60445eceb4d5420bb09b9e03fbf**\n\n**8f459ae20291f2721244465aa6a6f7b9**\n\n**4b323d4320efa67315a76be2d77a0c83**\n\n**035848a0e6ad6ee65a25be3483af86f2**\n\n**90d8e7a92284789d2e15ded22d34ccc3**\n\n**edb324467f6d36c7f49def27af5953a5**\n\n**c1e7368eda5aa7b09e6812569ebd4242**\n\n**ec99e82ad8dbf1532b0a5b32c592efdf**\n\n**391b9434379308e242749761f9edda8e**\n\n**6bf76626037d187f47a54e97c173bc66**\n\n**895f7469e50e9bb83cbb36614782a33e**\n\n**1feacbef9d6e9f763590370c53cd6a30**\n\n**82234c358d921a97d3d3a9e27e1c9825**\n\n**558d0a7232c75e29eaa4c1df8a55f56b**\n\n**e565255a113b1af8df5adec568a161f3**\n\n**1821351d67a3dce1045be09e88461fe9**\n\n**b1fe41542ff2fcb3aa05ff3c3c6d7d13**\n\n**53c5520febbe89c25977d9f45137a114**\n\n**4513e3e8b5506df268881b132ffdcde1**\n\n**19ce80e963a5bcb4057ef4f1dd1d4a89**\n\n**9b29903a67dfd6fec33f50e34874b68b**\n\n**b637f8b5f39170e7e5ada940141ddb58**\n\n**c09683d23d8a900a848c04bab66310f1**\n\n**6d4c2cd95a2b27777539beee307625a2**\n\n**e32d5c22e90cf96296870798f9ef3d15**\n\n**64c3ecfd104c0d5b478244fe670809cc**\n\n**b69f09eee3da15e1f8d8e8f76d3a892a**\n\n**294f9e8686a6ab92fb654060c4412edf**\n\n**6135bd02103fd3bab05c2d2edf87e80a**\n\n**b973daa1510b6d8e4adea3fb7af05870**\n\n**8dce09a2b2b25fcf2400cffb044e56b8**\n\n**6008f85d63f690bb1bfc678e4dc05f97**\n\n**1bf8434e6f6e201f10849f1a4a9a12a4**\n\n**6cac1a8ba79f327d0ad3f4cc5a839aa1**\n\n\n-----\n\n**6bbc54fb91a1d1df51d2af379c3b1102**\n\n**8b152fc5885cb4629f802543993f32a1**\n\n**6d1187f554040a072982ab4e6b329d14**\n\n**3bfe642e752263a1e2fe22cbb243de57**\n\n**c629933d129c5290403e9fce8d713797**\n\n**1c62b3d0eb64b1511e0151aa6edce484**\n\n**811fcbadd31bccf4268653f9668c1540**\n\n**0a89949a3a933f944d0ce4c0a0c57735**\n\n**a0f594802fbeb5851ba40095f7d3dbd1**\n\n**bf6ce6d90535022fb6c95ac9dafcb5a5**\n\n**df84ff928709401c8ad44f322ec91392**\n\n**fda6f18cf72e479570e8205b0103a0d3**\n\n**39835e790f8d9421d0a6279398bb76dc**\n\n**fe6295c647e40f8481a16a14c1dfb222**\n\n**592c5fbf99565374e9c20cade9ac38aa**\n\n**ad8dc222a258d11de8798702e52366aa**\n\n**bc21639bf4d12e9b01c0d762a3ffb15e**\n\n**3122353bdd756626f2dc95ed3254f8bf**\n\n**e02d19f07f61d73fb6dd5f7d06e9f8d2**\n\n**d2c7bf274edb2045bc5662e559a33942**\n\n**ac1a265be63be7122b94c63aabcc9a66**\n\n**e06c27e3a436537a9028fdafc426f58e**\n\n**6cf2302e129911079a316cf73a4d010f**\n\n**38b6ad30940ddfe684dad7a10aea1d82**\n\n**f190cda937984779b87169f35e459c3a**\n\n**698a41c92226f8e444f9ca7647c8068c**\n\n**bc95b3d795a0c28ea4f57eafcab8b5bb**\n\n**82127dc2513694a151cbe1a296258850**\n\n**d387a5e232ed08966381eb2515caa8e1**\n\n**f4b9eb3ddcab6fd5d88d188bc682d21d**\n\n**8e42fd3f9d5aac43d69ca740feb38f97**\n\n**a43e8ddecfa8f3c603162a30406d5365**\n\n**ea7dd992062d2f22166c1fca1a4981a1**\n\n**7bf6dcf413fe71af2d102934686a816b**\n\n**cf064356b31f765e87c6109a63bdbf43**\n\n**4a46e2dc16ceaba768b5ad3cdcb7e097**\n\n**2134721de03a70c13f2b10cfe6018f36**\n\n**7add5fd0d84713f609679840460c0464**\n\n**cc9402e5ddc34b5f5302179c48429a56**\n\n**9803e49d9e1c121346d5b22f3945bda8**\n\n**c5f5837bdf486e5cc2621cc985e65019**\n\n**2b72fda4b499903253281ebbca961775**\n\n**7031f6097df04f003457c9c7ecbcda1c**\n\n**6a6c2691fef091c1fc2e1c25d7c3c44c**\n\n**9bd3f 59f30df5d54 2df385 b 710 5**\n\n\n-----\n\n**0a2c2f5cf97c65f6473bdfc90113d81e**\n\n**30b74abc22a5b75d356e3a57e2c84180**\n\n**a0424e8436cbc44107119f62c8e7491b**\n\n**c1ba892d254edd8a580a16aea6f197e9**\n\n**e70976785efcfaeed20aefab5c2eda60**\n\n**397b5d66bac2eb5e950d2a4f9a5e5f2c**\n\n**4e9bde9b6abf7992f92598be4b6d1781**\n\n**54d266dee2139dd82b826a9988f35426**\n\n**5b4faa2846e91e811829a594fecfe493**\n\n**907448af4388072cdc01e69b7b97b174**\n\n**ccad214045af69d06768499a0bd3d556**\n\n**1395dfda817818c450327ab331d51c1b**\n\n**715e9e60be5a9b32075189cb04a0247e**\n\n**3835c8168d66104eed16c2cd99952045**\n\n**f32c29a620d72ec0a435982d7a69f683**\n\n**95e9162456d933fff9560bee3c270c4e**\n\n**da01ef50673f419cf06b106546d06b50**\n\n**2dd4c551eacce0aaffedf4e00e0d03de**\n\n**34f80f228f8509a67970f6062075e211**\n\n**81ca7526881a0a41b6721048d2f20874**\n\n**d642c73d0577dd087a02069d46f68dac**\n\n**BE3 MD5s:**\n\n**f0ebb6105c0981fdd15888122355398c**\n\n**7cb6363699c5fd683187e24b35dd303e**\n\n**4d5c00bddc8ea6bfa9604b078d686d45**\n\n**f37b67705d238a7c2dfcdd7ae3c6dfaa**\n\n**46649163c659cba8a7d0d4075329efa3**\n\n**628ef31852e91895d601290ce44650b1**\n\n**723eb7a18f4699c892bc21bba27a6a1a**\n\n**8b9f4eade3a0a650af628b1b26205ba3**\n\n**f6c47fcc66ed7c3022605748cb5d66c6**\n\n**6c1996c00448ec3a809b86357355d8f9**\n\n**faab06832712f6d877baacfe1f96fe15**\n\n**2c72ef155c77b306184fa940a2de3844**\n\n**2e62e8949d123722ec9998d245bc1966**\n\n**b0dc4c3402e7999d733fa2b668371ade**\n\n**93fa40bd637868a271002a17e6dbd93b**\n\n**f98abf80598fd89dada12c6db48e3051**\n\n**8a7c30a7a105bd62ee71214d268865e3**\n\n**2f6582797bbc34e4df47ac25e363571d**\n\n**81d127dd7957e172feb88843fe2f8dc1**\n\n**3e25544414030c961c196cea36ed899d**\n\n\n-----\n\n**[Botnet History Illustrated by BlackEnergy 2](http://2014.phdays.com/program/tech/37998/)** **, PH Days, Kaspersky Lab – Maria Garnaeva and Sergey**\n\n**Lozhkin, May 2014**\n\n**[BlackEnergy and Quedagh (pdf), F-Secure, September 2014](https://www.f-secure.com/documents/996508/1030745/blackenergy_whitepaper.pdf)**\n\n**[Sandworm, iSIGHT Partners, October 2014](http://www.isightpartners.com/2014/10/cve-2014-4114)**\n\n**Alert (ICS-ALERT-14-281-01A) Ongoing Sophisticated Malware Campaign Compromising ICS (Update**\n\n**A), ICS-CERT, October 2014**\n\n**24** **31** **0** **0** **35** **31** **0** **1**\n\n**94** **141** **0** **0**\n\n**jayaram Bharathi**\n\n**Posted on November 4, 2014. 12:52 am**\n\n**It is very helpful for understanding the threat available in the real world. It is good to receive the regular posts on any**\n\n**posts related to threat**\n\n**[Reply](https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/?replytocom=297254#respond)**\n\n**KevinUK**\n\n\n**24** **31** **0** **0**\n\n\n**35** **31** **0** **1**\n\n\n**[Reply](https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/?replytocom=297254#respond)**\n\n\n-----\n\n**Quote ” The decrypted PNG is supposed to contain a new CNC address, but we never observed one.”**\n\n**Did you consider steganography may be being employed at that time?**\n\n**[Reply](https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/?replytocom=307503#respond)**\n\n**Maria Garnaeva**\n\n**Posted on November 7, 2014. 10:50 am**\n\n**Yes, steganography is used here. What we meant is that we never observed a PNG file itself**\n\n**[Reply](https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/?replytocom=307723#respond)**\n\n**frederick**\n\n**Posted on November 12, 2014. 8:13 am**\n\n**“…remain mysterious and their purpose is not yet clear, like ‘usb’ and ‘bios’. …”**\n\n**This COULD be for infecting USB firmware and UEFI bugs.**\n\n**If this is successfull your Antivirus software can search and search and will find nothing.**\n\n**When you find something suspicious on your harddrive or in memory the infection vector still stays active.**\n\n**[Reply](https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/?replytocom=308674#respond)**\n\n**Your email address will not be published. Required fields are marked ***\n\n\n**[Reply](https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/?replytocom=307503#respond)**\n\n\n**[Reply](https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/?replytocom=308674#respond)**\n\n\n**Enter your comment here**\n\n\n**Name ***\n\n**Email ***\n\n\n**[Reply](https://securelist.com/blog/research/67353/be2-custom-plugins-router-abuse-and-target-profiles/?replytocom=307723#respond)**\n\n\n-----\n\n**I'm not a robot**\n\n**reCAPTCHA**\n\n\n**Notify me of follow-up comments by email.**\n\n**Notify me of new posts by email.**\n\n\n**24** **31** **_0_**\n\n\n**I'm not a robot**\n\n**reCAPTCHA**\n\n\n**_0_**\n\n\n-----\n\n**206** **101**\n\n\n**206** **101** **_0_**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.01.28.BlackEnergy_APT/reference/be2-custom-plugins-router-abuse-and-target-profiles.pdf"
    ],
    "report_names": [
        "be2-custom-plugins-router-abuse-and-target-profiles"
    ],
    "threat_actors": [
        {
            "id": "a66438a8-ebf6-4397-9ad5-ed07f93330aa",
            "created_at": "2022-10-25T16:47:55.919702Z",
            "updated_at": "2025-03-27T02:05:17.412024Z",
            "deleted_at": null,
            "main_name": "IRON VIKING",
            "aliases": [
                "ATK14 ",
                "BlackEnergy Group",
                "Blue Echidna ",
                "CTG-7263 ",
                "ELECTRUM ",
                "FROZENBARENTS ",
                "Hades/OlympicDestroyer ",
                "IRIDIUM ",
                "Qudedagh ",
                "Sandworm Team ",
                "Seashell Blizzard ",
                "TEMP.Noble ",
                "Telebots ",
                "Voodoo Bear ",
                "APT44 "
            ],
            "source_name": "Secureworks:IRON VIKING",
            "tools": [
                " BlackEnergy",
                " GCat",
                " GreyEnergy",
                " Industroyer",
                " KillDisk",
                " NotPetya",
                " PSCrypt",
                " TeleBot",
                " TeleDoor",
                " xData",
                "BadRabbit"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b3e954e8-8bbb-46f3-84de-d6f12dc7e1a6",
            "created_at": "2022-10-25T15:50:23.339976Z",
            "updated_at": "2025-03-27T02:00:55.446795Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "Sandworm Team",
                "ELECTRUM",
                "Telebots",
                "IRON VIKING",
                "BlackEnergy (Group)",
                "Quedagh",
                "Voodoo Bear",
                "IRIDIUM",
                "Seashell Blizzard",
                "FROZENBARENTS",
                "APT44"
            ],
            "source_name": "MITRE:Sandworm Team",
            "tools": [
                "Bad Rabbit",
                "Mimikatz",
                "Exaramel for Linux",
                "Exaramel for Windows",
                "GreyEnergy",
                "PsExec",
                "Prestige",
                "P.A.S. Webshell",
                "VPNFilter",
                "Cyclops Blink",
                "SDelete",
                "AcidRain",
                "Industroyer",
                "Industroyer2",
                "BlackEnergy",
                "Cobalt Strike",
                "NotPetya",
                "KillDisk",
                "PoshC2",
                "Impacket",
                "Invoke-PSImage",
                "Olympic Destroyer"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8941e146-3e7f-4b4e-9b66-c2da052ee6df",
            "created_at": "2023-01-06T13:46:38.402513Z",
            "updated_at": "2025-03-27T02:00:02.824555Z",
            "deleted_at": null,
            "main_name": "Sandworm",
            "aliases": [
                "G0034",
                "IRIDIUM",
                "Blue Echidna",
                "FROZENBARENTS",
                "Seashell Blizzard",
                "IRON VIKING",
                "ELECTRUM",
                "TeleBots",
                "UAC-0113",
                "UAC-0082",
                "APT44",
                "Quedagh",
                "VOODOO BEAR",
                "TEMP.Noble"
            ],
            "source_name": "MISPGALAXY:Sandworm",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7bd810cb-d674-4763-86eb-2cc182d24ea0",
            "created_at": "2022-10-25T16:07:24.1537Z",
            "updated_at": "2025-03-27T02:02:10.126127Z",
            "deleted_at": null,
            "main_name": "Sandworm Team",
            "aliases": [
                "APT 44",
                "ATK 14",
                "BE2",
                "Blue Echidna",
                "CTG-7263",
                "FROZENBARENTS",
                "IRIDIUM",
                "Iron Viking",
                "Quedagh",
                "Sandworm",
                "Sandworm Team",
                "Seashell Blizzard",
                "TEMP.Noble",
                "UAC-0082",
                "UAC-0113",
                "UAC-0125",
                "UAC-0133",
                "Voodoo Bear"
            ],
            "source_name": "ETDA:Sandworm Team",
            "tools": [
                "AWFULSHRED",
                "ArguePatch",
                "BIASBOAT",
                "Black Energy",
                "BlackEnergy",
                "CaddyWiper",
                "Colibri Loader",
                "Cyclops Blink",
                "CyclopsBlink",
                "DCRat",
                "DarkCrystal RAT",
                "Fobushell",
                "GOSSIPFLOW",
                "Gcat",
                "IcyWell",
                "Industroyer2",
                "JaguarBlade",
                "JuicyPotato",
                "Kapeka",
                "KillDisk.NCX",
                "LOADGRIP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "ORCSHRED",
                "P.A.S.",
                "PassKillDisk",
                "Pitvotnacci",
                "PsList",
                "QUEUESEED",
                "RansomBoggs",
                "RottenPotato",
                "SOLOSHRED",
                "SwiftSlicer",
                "VPNFilter",
                "Warzone",
                "Warzone RAT",
                "Weevly"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716504,
    "ts_updated_at": 1743041825,
    "ts_creation_date": 1454063027,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/ec503a9fa1206124e53d35eaba1c9d1a0d780202.pdf",
        "text": "https://archive.orkl.eu/ec503a9fa1206124e53d35eaba1c9d1a0d780202.txt",
        "img": "https://archive.orkl.eu/ec503a9fa1206124e53d35eaba1c9d1a0d780202.jpg"
    }
}