{
    "id": "4c42a3f0-201d-4c06-b043-fc8f5b3480a2",
    "created_at": "2023-01-12T15:03:39.110208Z",
    "updated_at": "2025-03-27T02:05:23.694683Z",
    "deleted_at": null,
    "sha1_hash": "055eea5fc5b073e85b532d4265a2154ad6b31f0a",
    "title": "2021-05-11 - Analysis of a series of attacks by the suspected Lazarus organization using Daewoo Shipyard as relevant bait",
    "authors": "",
    "file_creation_date": "2022-05-28T03:18:01Z",
    "file_modification_date": "2022-05-28T03:18:01Z",
    "file_size": 2194833,
    "plain_text": "# 疑似Lazarus组织利用大宇造船厂为相关诱饵的系列攻击活动 分析 - FreeBuf网络安全行业门户\n\n**freebuf.com/articles/paper/272517.html**\n\n## 概述\n\nLazarus APT组织是疑似具有东北亚背景的APT团伙，该组织攻击活动最早可追溯到2007年，\n其早期主要针对韩国、美国等政府机构，以窃取敏感情报为目的。自2014年后，该组织开始\n针对全球金融机构 、虚拟货币交易所等为目标，进行以敛财为目的的攻击活动。\n\n据公开情报显示，2014 年索尼影业遭黑客攻击事件，2016 年孟加拉国银行数据泄露事件，\n2017年美国国防承包商、美国能源部门及英国、韩国等比特币交易所被攻击等事件都出自\nLazarus之手。\n\n近日，奇安信红雨滴团队使用内部高价值样本狩猎流程捕获多个Lazarus组织新攻击样本，此\n类样本以东亚某知名造船厂（大宇造船：Daewoo Shipbuilding）、居民登记表等信息为诱\n饵，采用bmp文件隐藏RAT的方式进行载荷隐藏。\n\n## 样本信息\n\n捕获的样本均是韩语相关诱饵，都采用类似的VBA脚本进行攻击，样本信息如下:\n\n文件名 **MD5**\n\n참가신청서양식.doc ed9aa858ba2c-4671ca373496a4dd05d4\n\n결의대회초안.doc d5e974a3386fc99d2932756ca165a451\n\n생활비지급.doc 71759cca8c700646b4976b19b9abd6fe\n\n受害者启用宏后，将展示诱饵文档信息迷惑受害者，诱饵包括东亚某造船厂收购、居民登记表\n等相关信息。诱饵内容入下图所示：\n\n\n-----\n\n## 样本分析\n\n我们以MD5为d5e974a3386fc99d2932756ca165a451的样本进行分析。\n\n**MD5** d5e974a3386fc99d2932756ca165a451\n\n文件名 결의대회초안.doc\n\n创建时间 2021-03-31 00:01:00\n\n创建者 William\n\n文件名中文原意为决议会议草案。诱导用户点击按钮，则会执行宏代码。\n\n启用宏，将展示诱饵信息内容，诱饵信息是关于韩国出售大宇造船厂给现代重工的相关言论。\n\n\n-----\n\n之后宏使用MsgBoxOKCancel函数会进行弹窗，并收集用户点击结果。如果用户点击yes的话\n会进行后续的载荷解密释放。\n\n使用base64将代码中所需字符进行解码。\n\n将image003.png转换为bmp格式进行解密，然后使用mshta运行其中的js代码。\n\n\n-----\n\n从binwalk中可看见image003.png存在Zlib压缩数据。\n\nBMP文件中包含HTA文件。解压缩后的JS代码如下图所示，包含OpenTextFile，\nCreateTextFile，fromCharCode，Close，Write，C:/Users/Public/Downloads/Winvoke.exe等\n值。\n\n当脚本执行时，会去解析第一个数组获取索引值。同时使用CreateTextFile创建\nWinvoke.exe，将“MZ”写入。然后通过fromCharCode将data数组转换为字符串，写入\nWincoke.exe中。最后Wscript.Run执行落地的载荷。\n\n**MD5** f4d46629ca15313b94992f3798718df7\n\n\n-----\n\n文件名 Winvoke.exe\n\n释放执行的Winvoke.exe是一个加载器，主要功能为内存解密并加载后续远控文件。\n\n标记处为密钥，程序运行后会使用该密钥通过异或解密.KDATA的后续字段。\n\n解密函数如下，解密后的数据是一个可执行文件，解密完成后将跳转到该文件中执行。\n\n解密加载的可执行文件信息如下：\n\n**MD5** 7d7ad10a5d9fa1789b9a918625dbfe35\n\n时间戳 2020-11-24,20:18:03\n\n执行后，首先创建Microsoft32互斥量，保持单一进程执行。获取函数地址，使用了\nMicrosoftCorporationValidation@#$%^&*()!US作为S盒的Rivest Cipher 4解密。\n\n\n-----\n\n解密url。\n\n解密函数如下：\n\n\n-----\n\n利用python还原解密函数逻辑如下图：\n\n将该文件通过com接口shellLink在开机启动文件夹中创建“Visor 2010 Launcher.lnk”的指定快捷\n方式，实现持久化。\n\n\n-----\n\n与C2进行通信，获取命令执行。\n\n与C2成功建立通信后，将从返回数据中读取指令并执行。\n\n\n-----\n\n该后门支持的指令功能介绍如下表所示\n\n指令码 功能\n\n8888 下载执行\n\n9876 退出程序\n\n9999 命令执行（创建线程，通过cmd执行命令）\n\n8877 下载文件\n\n1111 更改休眠时间\n\n1234 创建线程内存加载执行代码\n\n3333 删除自身\n\n\n-----\n\n4444 关机\n\n## 溯源关联\n\n奇安信威胁情报中心红雨滴团队结合威胁情报中心ALPHA威胁分析平台\n（https://ti.qianxin.com/），对此次攻击活动的手法、恶意代码等方面关联分析发现：此次攻\n击活动与Lazarus组织样本存在高度相似性。该样本与ed9aa858ba2c4671ca373496a4dd05d4 和d5e974a3386fc99d2932756ca165a451中使用的宏和第二阶段内\n存载入的木马存在一致性。同时该样本的RAT为更全功能的版本，增加了移动自身到开机自启\n动文件夹的功能，实现了持久化。\n\n同时该样本使用的加密算法与之前Lazarus使用的BISTROMATH RAT的加密算法有一定的相\n似度。\n\n\n-----\n\n## 总结\n\n此次捕获的样本主要针对东亚地区开展攻击活动，暂未发现影响国内用户，但防范之心不可\n无，奇安信威胁情报中心再次提醒各企业用户，加强员工的安全意识培训是企业信息安全建设\n中最重要的一环，如有需要，企业用户可以建设态势感知，完善资产管理及持续监控能力，并\n积极引入威胁情报，以尽可能防御此类攻击。\n\n目前，基于奇安信威胁情报中心的威胁情报数据的全线产品，包括威胁情报平台（TIP）、天\n眼高级威胁检测系统、NGSOC、奇安信态势感知等，都已经支持对此APT攻击团伙攻击活动\n的精准检测。\n\n## IOCs\n\nd5e974a3386fc99d2932756ca165a451\n\nf4d46629ca15313b94992f3798718df7\n\n\n-----\n\n0ecfa51cd4bf1a9841a07bdb5bfcd0ab\n\ned9aa858ba2c-4671ca373496a4dd05d4\n\n71759cca8c700646b4976b19b9abd6fe\n\n118cfa75e386ed45bec297f8865de671\n\n53648bf8f0121130edb42c626d7c2fc-4\n\n4d30612a928faf7643b14bd85d8433cc\n\n0812ce08a75e5fc774a114436e88cd06\n\n1bb267c96ec2925f6ae3716d831671cf\n\nhttp://mail.namusoft.kr/jsp/user/eam/board.jsp\n\nhttp://www.jinjinpig.co.kr/Anyboard/skin/board.php\n\nhttp://snum.or.kr/skin_img/skin.php\n\nhttp://www.ddjm.co.kr/bbs/icon/skin/skin.php\n\n本文作者：， [转载请注明来自FreeBuf.COM](https://www.freebuf.com/)\n\n# APT组织 # Lazarus # 东亚地区\n\n\n-----",
    "language": "ZH",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-11 - Analysis of a series of attacks by the suspected Lazarus organization using Daewoo Shipyard as relevant bait.pdf"
    ],
    "report_names": [
        "2021-05-11 - Analysis of a series of attacks by the suspected Lazarus organization using Daewoo Shipyard as relevant bait.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535819,
    "ts_updated_at": 1743041123,
    "ts_creation_date": 1653707881,
    "ts_modification_date": 1653707881,
    "files": {
        "pdf": "https://archive.orkl.eu/055eea5fc5b073e85b532d4265a2154ad6b31f0a.pdf",
        "text": "https://archive.orkl.eu/055eea5fc5b073e85b532d4265a2154ad6b31f0a.txt",
        "img": "https://archive.orkl.eu/055eea5fc5b073e85b532d4265a2154ad6b31f0a.jpg"
    }
}