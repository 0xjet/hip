{
    "id": "faf83572-60d8-42e8-91a8-d721e46ddfad",
    "created_at": "2023-01-12T15:10:28.83213Z",
    "updated_at": "2025-03-27T02:05:37.654957Z",
    "deleted_at": null,
    "sha1_hash": "74d0f03527b4dffb4e3a3774fe314c2611c762f8",
    "title": "2016-07-07 - New threat dubbed Zepto Ransomware is spreading out with a new email spam campaign. It is a variant of the recent Locky Ransomware.",
    "authors": "",
    "file_creation_date": "2022-05-28T17:11:21Z",
    "file_modification_date": "2022-05-28T17:11:21Z",
    "file_size": 2103057,
    "plain_text": "# New Locky variant – Zepto Ransomware Appears On The Scene\n\n**[securityaffairs.co/wordpress/49094/malware/zepto-ransomware.html](http://securityaffairs.co/wordpress/49094/malware/zepto-ransomware.html)**\n\nJuly 7, 2016\n\nJuly 7, 2016 By [Pierluigi Paganini](https://securityaffairs.co/wordpress/author/paganinip)\n\n## New threat dubbed Zepto Ransomware is spreading out with a new email spam campaign. It is a variant of the recent Locky Ransomware.\n\n[The news was recently reported in a blog post by the Cisco Talos team:](http://blog.talosintel.com/2016/06/gotta-be-swift-for-this-spam-campaign.html)\n\n_“We are watching Zepto very carefully. It’s closely tied to Locky, sharing many of the same_\n_attributes,” said Craig Williams, senior technical leader and global outreach manager at_\n_Cisco Talos._\n\n_“There is still a lot to learn about Zepto. As far as we can tell, it’s either a new variant of_\n_Locky or an entirely new ransomware with many copycat Locky features,” he said._\n\nIn the last week, experts observed more than 140,000 emails using a particular naming\nconvention to deliver a malicious attachment.\n\nThat email is generated by a template body text, where it fetches the header greeting\nrandomly from an array followed by the [NAME] of the receiver.\n\nAs previous variants of the same malware family, the text of the email attempts to trick the\nvictim to open the attachment.\n\n\n-----\n\nThe attachment is a .zip archive containing the hard-coded js downloader.\nThe naming conventions used to rename the js downloader have the following format “swift\n\n[XXX|XXXX].js” where X are some combination of letters (a-f) and numbers (0-9).\n\nOnce the js file is executed through wscript it downloads the main payload binary from the\nC2 Servers.\nMany of them have a list of hardcoded domains for download the binary, other variations use\njust a few domains.\nThat is done through HTTP GET requests to define C2 domains and the server\nfunctionalities are implemented in PHP.\n\nWe observed through dynamic analysis that it uses the same technique of Locky\nransomware to decode the main payload, spawning the process through wScript with the\nargument ‘321’, otherwise, the decryption routine will produce junk code and the execution\nflow will jump into that junk code and crash the process.\n\nThe encrypted files have the “.zepto” extensions and it targets the same extensions files of\nLocky taking care of the system files, it uses a lot of code of Locky ransomware to implement\nits malicious behaviors.\nOne of the smartest features of the ransomware is the fact they do not encrypt all the files\nneeded for the correct functioning of the OS, otherwise, how can the victims pay?\n\nOnce the encryption routine of all the files is over, it shows the instructions on how to get the\nfiles back:\none picture (_HELP_instructions.jpg) and one html page (_HELP_instructions.html) are\nprompted to the victim for the explanation on how to unlock the files.\n\nFollowing an image of a machine infected by the Zepto Ransomware:\n\n\n-----\n\nCisco Talos researchers tracked all the attachment they found and on 137,731 spam emails\n[and discovered that there were 3,305 unique samples.They collected them here.](http://blogs.cisco.com/wp-content/uploads/2016_06_30-zepto-hashes.txt)\n\n**OUR ANALYSIS**\n\nOur main contribution will be to find the actual code that differs from the previous version of\nthe [Locky Ransomware. We hope to help in detecting variation on some core features (as](http://securityaffairs.co/wordpress/48725/malware/locky-ransomware-back.html)\nencryption routine, files enumeration, drive enumeration…), and to allow experts to\n[distinguish the Locky ransomware family from the Zepto ransomware family.](http://securityaffairs.co/wordpress/45273/cyber-crime/locky-ransomware-spam-campaign.html)\n\n[We will do this through bindiff software that let us to compare two binary files and calculate](https://www.zynamics.com/bindiff.html)\nthe differences, we will use a Locky Ransomware sample with the following hash\nSHA256:e5a6828f732bea6b66c4f6d850b235f6c1f139b10f8d9f2c3760298cfd88c163.\n\nSo Cisco Talos researchers give us a good advice on where to start for this new variant,\nunfortunately, they didn’t publish some samples to use in our analysis so we found some way\nto get them.\n\n\n-----\n\nWe grabbed the most recent one in order to study the most recent variant.\n\nThe file name is “swift ca6.js”\nSHA256:068e08f01e117f66f607a27492a500cc7c3ffa91cac76dcebbe97667394a9cde.\n\nAs we can see, the file has the same name pattern discovered by Cisco Talos researchers.\n\nNow we will need to extract the main payload from the execution of the JavaScript file.\n\nWe will monitor our file system activities with procMon tools and we will take care on the\ndropped files of the malicious js.\n\nIn the above image, we can see in (1) that the script creates the binary file and create a\nprocess launching it (2).\n\nWe found interesting that the js downloader calls the binary with an argument needed for\n\n\n-----\n\ndecoding the main payload like the Locky ransomware and most weird is that it uses the\nsame argument for the decryption routine:\n\nOnce identified the dir location of the ransomware payload we could identify him:\nSHA256:5bbc9afa3128956b3f6116037cc97d0ea1c79d8bb5d3e15473d1e9c5c8eecfdf\n\nThe only problem we face executing it is that the ransomware does not execute itself but it\nchanges its behavior killing its main thread and it auto-delete itself maybe because it detects\nthe virtual environment.\nSo start to patch that binary in order to study our sample:\n\nWe open the executable with the Olly debugger with the argument 321 and starting\nanalyzing the code searching for some tricks used for vm detection.\nLooking at the list of the intermodular calls we investigated on the GetProcAddress syscall\nand we found something interesting:\n\n\n-----\n\nThis ransomware uses the RDTSC anti-vm technique:\n\n_“The Time Stamp Counter (TSC) is a 64-bit register present on all x86 processors since the_\n_Pentium. It counts the number of cycles since reset”. (Wikipedia)_\n\nIf the code is being emulated then, there will be a change in the time stamp between. The\nResult in stored in EDX:EAX format.\n\nNow the time difference in a real host machine would be usually less than 100, but if the\ncode is emulated the difference will be huge.\n\nFilling those instructions with NOP and patching the executable let us successfully launch\nthe ransomware.\n\nNow we wait until it decodes itself and, when it will contact the domains to take the RSA key\n(it means it decoded itself and loaded in memory), we will suspend the process in order to\ndump it from the memory for our further analysis.\n\n[We will use a useful tool for dump a process loaded into the memory: Process Dump.](http://split-code.com/processdump.html)\n\n\n-----\n\nThe highlighted file will be our unpacked sample of Zepto Ransomware.\n\nNow we have our fresh and unpacked sample of Zepto Ransomware and we need to\nproduce the .idb files of the two ransomware used for the comparison in the bindiff software,\nida Pro will do this easily.\n\nSo let’s compare our two ransomware and look at the results:\n\n\n-----\n\nThe first result returned by the tool are pretty pie graphs where we have the numbers of\nFunctions, Calls, Basic Blocks and Jumps.\n\nIn green there are the matched elements (included also the changed), in red we have the\nnew Zepto ransomware elements that aren’t present in the Locky ransomware and in gray\nwe have the Locky elements that aren’t present in Zepto Ransomware.\n\nOverall, the two binary have a similarity coefficient of 0.86 that is high for two different\nfamilies of a ransomware.\n\nAs we can see from the lower part of the image there is a table representing our results, the\nZepto ransomware has more functions, calls, basic blocks, jumps and instructions than locky\nransomware.\n\nAnd interesting enough are the results shown in Secondary Call Graph window saying that\nthe 99.9% on 821 functions of locky ransomware are matched with the Zepto ransomware\nand 15 functions changed (1.8%), impressive is that just 1 (0.1%) function unmatched.\n\nOn the left window, we can see that 149 functions are unmatched (15.4%), it means there\nare added functions to the new version of that ransomware.\n\nIn the overall instructions of Locky ransomware (24,947) we have the 96.9% of identical\ncodes and just 3.1% of different instructions.\n\n\n-----\n\nHow much changed Zepto Ransomware and how many new features it has?\nWell, answering exactly can’t be that easy, but we can give you some good statistical\nnumbers.\nWe can tell you that the Zepto ransomware has, of course, more overall instructions than\nlocky ransomware, it has 32,292 and over that there are 8,110 new instructions, so 25.1%\nnew code.\nIt means that for sure that Zepto ransomware will have some new behavior than locky\nransomware, but in most aspects, it will act as locky ransomware, but also with\nlittle improvements it will still avoid the av engine.\nIt looks like the author of the ransomware take the previous code of the locky ransomware\nand added new features and changed some code to evade signature-based detection.\n\nLet’s investigate on some changed functions and try to extract some big difference.\nLooking at the list of the matched functions, we can easily identify the functions that changed\nfor this new version of the ransomware thank at the similarity coefficient computed by\nbindiff tool:\n\nWe can realize from the above image that on the 820 matched functions, just 15 functions\nare changed, and 805 functions are identical.\n\nIt means that 98.1% of the Locky ransomware functions are identical to the Zepto\nransomware.\n\nFor that, we can confirm that the Zepto ransomware is just an extension of the Locky\nransomware adding it new features.\n\nAnalyzing the changed functions the most notable discover was on the encryption routine\nfunction used to encrypt the files because it has the same CFG and changes are made just\nin adding the final extension of the files:\n\n\n-----\n\nThe Encryption routine implemented in the Zepto ransomware is similar to the Locky one.\n\nOn the left and right sides we can realize that the CFG graphs are identical if we look just at\nbranching instructions and calls, it changed just the instructions in the yellow basic blocks.\n\nIn fact, the report for that function say us exactly that:\n\n**CONCLUSION**\n\n_“If Zepto sticks with this attack vector it may never become a serious threat. However, it’s_\n_very likely Zepto moves into exploit kits as time goes on,” Williams said. “A move by Zepto to_\n_malvertising, for example, could get bad very fast,” he said._\n\n\n-----\n\nWhat we can say is that Zepto Ransomware isn t a new variant of the Locky Ransomware\nthat uses some copycat, because there are too much identical code.\nIf an av engine tracked the main behaviors of Locky, ransomware as drive enumeration or\nencryption routine will still spot this threat as a Locky ransomware because, as we saw, this\nnew version of Locky doesn’t change the inner logic of the most crucial behaviors.\nWe can define Zepto ransomware as Locky Ransomware 2.0 and with a lot of probability, the\nauthors of that new variant are the same behind Locky Ransomware.\n\n**REFERENCES**\n\n**[http://securityaffairs.co/wordpress/48725/malware/locky-ransomware-back.html](http://securityaffairs.co/wordpress/48725/malware/locky-ransomware-back.html)**\n**http://www.iswatlab.eu/wp-**\n**content/uploads/2015/09/Technical_Report_Ransomware.pdf**\n**[http://blog.talosintel.com/2016/06/gotta-be-swift-for-this-spam-campaign.html](http://blog.talosintel.com/2016/06/gotta-be-swift-for-this-spam-campaign.html)**\n**[https://threatpost.com/locky-variant-zepto-debuts-with-big-spam-push/119017/](https://threatpost.com/locky-variant-zepto-debuts-with-big-spam-push/119017/)**\n**http://resources.infosecinstitute.com/anti-debugging-and-anti-vm-techniques-**\n**and-anti-emulation/**\n\n**Written by the IT Security Expert** **[Antonio Cocomazzi](https://it.linkedin.com/in/antonio-cocomazzi-66973411a)**\n\nAntonio Cocomazzi is an IT Security Expert specialized in the\nmalware analysis field. Young and recently graduated, he conducts\na 6 months research focused on Ransomware giving a full\ncharacterization of the recent families defining a new methodology\nfor dissecting this kind of malware.\n\n**Edited by** **[Pierluigi Paganini](http://www.linkedin.com/pub/pierluigi-paganini/b/742/559)**\n\n**[(Security Affairs – Locky Ransomware, Zepto ransomware)](http://securityaffairs.co/wordpress/)**\n\n[CybercrimeLockymalwareransomwareZepto](https://securityaffairs.co/wordpress/tag/cybercrime)\n\nShare On\n\n\n-----\n\nYou might also like\n\n**[The strange link between Industrial Spy and the Cuba ransomware operation](https://securityaffairs.co/wordpress/131754/cyber-crime/industrial-spy-cuba-ransomware.html)**\n\nMay 28, 2022 By [Pierluigi Paganini](https://securityaffairs.co/wordpress/author/paganinip)\n\n**[GhostTouch: how to remotely control touchscreens with EMI](https://securityaffairs.co/wordpress/131714/hacking/ghosttouch-touchscreens-attack.html)**\n\nMay 27, 2022 By [Pierluigi Paganini](https://securityaffairs.co/wordpress/author/paganinip)\n\nCopyright 2021 Security Affairs by Pierluigi Paganini All Right Reserved.\nBack to top\n\n[Home](http://securityaffairs.co/wordpress/)\n[Cyber Crime](https://securityaffairs.co/wordpress/category/cyber-crime)\n[Cyber warfare](https://securityaffairs.co/wordpress/category/cyber-warfare-2)\n[APT](https://securityaffairs.co/wordpress/category/apt)\n[Data Breach](https://securityaffairs.co/wordpress/category/data-breach)\n[Deep Web](https://securityaffairs.co/wordpress/category/deep-web)\n[Digital ID](https://securityaffairs.co/wordpress/category/digital-id)\n[Hacking](https://securityaffairs.co/wordpress/category/hacking)\n[Hacktivism](https://securityaffairs.co/wordpress/category/hacktivism)\n[Intelligence](https://securityaffairs.co/wordpress/category/intelligence)\n[Internet of Things](https://securityaffairs.co/wordpress/category/iot)\n\n\n-----\n\n[Laws and regulations](https://securityaffairs.co/wordpress/category/laws-and-regulations)\n[Malware](https://securityaffairs.co/wordpress/category/malware)\n[Mobile](https://securityaffairs.co/wordpress/category/mobile-2)\n[Reports](https://securityaffairs.co/wordpress/category/reports)\n[Security](https://securityaffairs.co/wordpress/category/security)\n[Social Networks](https://securityaffairs.co/wordpress/category/social-networks)\n[Terrorism](https://securityaffairs.co/wordpress/category/terrorism)\n[ICS-SCADA](https://securityaffairs.co/wordpress/category/ics-scada)\n[EXTENDED COOKIE POLICY](https://securityaffairs.co/wordpress/extended-cookie-policy)\n[Contact me](https://securityaffairs.co/wordpress/contact)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-07-07 - New threat dubbed Zepto Ransomware is spreading out with a new email spam campaign. It is a variant of the recent Locky Ransomware..pdf"
    ],
    "report_names": [
        "2016-07-07 - New threat dubbed Zepto Ransomware is spreading out with a new email spam campaign. It is a variant of the recent Locky Ransomware..pdf"
    ],
    "threat_actors": [
        {
            "id": "0a03e7f0-2f75-4153-9c4f-c46d12d3962e",
            "created_at": "2022-10-25T15:50:23.453824Z",
            "updated_at": "2025-03-27T02:00:55.473216Z",
            "deleted_at": null,
            "main_name": "Ke3chang",
            "aliases": [
                "Ke3chang",
                "APT15",
                "Vixen Panda",
                "GREF",
                "Playful Dragon",
                "RoyalAPT",
                "Nylon Typhoon"
            ],
            "source_name": "MITRE:Ke3chang",
            "tools": [
                "Okrum",
                "Systeminfo",
                "netstat",
                "spwebmember",
                "Mimikatz",
                "Tasklist",
                "MirageFox",
                "Neoichor",
                "ipconfig"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "7c8cf02c-623a-4793-918b-f908675a1aef",
            "created_at": "2023-01-06T13:46:38.309165Z",
            "updated_at": "2025-03-27T02:00:02.801298Z",
            "deleted_at": null,
            "main_name": "APT15",
            "aliases": [
                "BRONZE PALACE",
                "Nylon Typhoon",
                "VIXEN PANDA",
                "Playful Dragon",
                "BRONZE DAVENPORT",
                "BRONZE IDLEWOOD",
                "G0004",
                "Red Vulture",
                "Ke3Chang",
                "Metushy",
                "Lurid",
                "Social Network Team",
                "Royal APT"
            ],
            "source_name": "MISPGALAXY:APT15",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536228,
    "ts_updated_at": 1743041137,
    "ts_creation_date": 1653757881,
    "ts_modification_date": 1653757881,
    "files": {
        "pdf": "https://archive.orkl.eu/74d0f03527b4dffb4e3a3774fe314c2611c762f8.pdf",
        "text": "https://archive.orkl.eu/74d0f03527b4dffb4e3a3774fe314c2611c762f8.txt",
        "img": "https://archive.orkl.eu/74d0f03527b4dffb4e3a3774fe314c2611c762f8.jpg"
    }
}