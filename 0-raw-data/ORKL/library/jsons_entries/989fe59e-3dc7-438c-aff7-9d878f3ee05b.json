{
    "id": "989fe59e-3dc7-438c-aff7-9d878f3ee05b",
    "created_at": "2022-10-25T16:48:16.309065Z",
    "updated_at": "2025-03-27T02:16:20.949494Z",
    "deleted_at": null,
    "sha1_hash": "fa52103ec752e0b604a908f72f6d68376f982c6a",
    "title": "",
    "authors": "",
    "file_creation_date": "2017-04-03T15:33:12Z",
    "file_modification_date": "2017-04-03T18:17:37Z",
    "file_size": 3967123,
    "plain_text": "# PENQUIN’S MOONLIT MAZE\n\n## The Dawn of Nation-State Digital Espionage\n\n### Juan Andres Guerrero-Saade, Costin Raiu (GReAT)\n\n Daniel Moore, Thomas Rid (King’s College London)\n\n\n# PENQUIN’S MOONLIT MAZE\n\n\n-----\n\nThe origins of digital espionage remain hidden in the dark. In most cases, codenames and\nfragments of stories are all that remains of the ‘prehistoric’ actors that pioneered the nowubiquitous practice of computer network exploitation. The origins of early operations, tools, and\ntradecraft are largely unknown: official documents will remain classified for years and decades\nto come; memories of investigators are eroding as time passes; and often precious forensic\nevidence is discarded, destroyed, or simply lost as storage devices age. Even ‘Moonlight\nMaze,’ perhaps the oldest publicly acknowledged state actor, has evaded open forensic\nanalysis.\n\nIntrusions began as early as 1996. The early targets: a vast number of US military and\ngovernment networks, including Wright Patterson and Kelly Air Force Bases, the Army\nResearch Lab, the Naval Sea Systems Command in Indian Head, Maryland, NASA, and the\nDepartment of Energy labs. By mid-1998 the FBI and Department of Defense investigators had\nforensic evidence pointing to Russian ISPs. After a Congressional hearing in late February\n\n\n-----\n\n1999, news of the FBI’s vast investigation leaked to the public.[1] However, little detail ever\nsurfaced regarding the actual means and procedures of this threat actor. Eventually the code\nname was replaced (with the attackers’ improved intrusion set dubbed Storm Cloud’, and later\n‘Makers Mark’) and the original ‘MM’ faded into obscurity without proper technical forensic\nartefacts to tie these cyberespionage pioneers to the modern menagerie of APT actors we are\nnow all too familiar with.\n\n_Two files exfiltrated from the US Navy via the London relay site in 1998, showing satellite tracks used for oceanic_\n_research into sea surface dynamic height._\n\nWhile investigating for _[Rise of the Machines, Thomas Rid came across a curious claim from](http://amzn.to/1qHGmds)_\nformer investigators in three different countries: that the Moonlight Maze threat actor would\n_eventually evolve into the modern day Turla._\n\nTurla, a Russian-speaking threat actor, is one of the true greats of the cyberespionage scene.\nAlso known as Snake, Uroburos, Venomous Bear, and Krypton, the APT group is conventionally\n[believed to have been active since 2007, employing diverse infection vectors, an](https://securelist.com/analysis/publications/65545/the-epic-turla-operation/) [ever-changing](https://securelist.com/blog/research/77429/kopiluwak-a-new-javascript-payload-from-turla/)\n[toolkit, interesting](https://securelist.com/blog/research/77429/kopiluwak-a-new-javascript-payload-from-turla/) [exfiltration tactics, and even](https://securelist.com/blog/research/72081/satellite-turla-apt-command-and-control-in-the-sky/) [deception techniques. The idea that the Turla](https://securelist.com/files/2016/10/Bartholomew-GuerreroSaade-VB2016.pdf)\nthreat actor may be related to this historic attack piqued our interest, as substantiating this claim\nwould effectively set it as a historical counterpart to the [Equation Group in extraordinary](https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf)\n[longevity.](https://securelist.com/files/2015/02/Equation_group_questions_and_answers.pdf)\n\n1 “Target Pentagon: Cyber-Attack Mounted Through Russia,” ABC Nightly News, 4 March 1999.\n“Pentagon probes \"serious\" computer hacking,” AFP, 4 March 1999, 01:11 GMT. See also Jim\n[Miklaszewski, “Pentagon and hackers in ‘cyberwar,’” ZDNet, 5 March 1999.](https://web.archive.org/web/20170401225346/http:/www.zdnet.com/article/pentagon-and-hackers-in-cyberwar-5000101740/)\n\n\n-----\n\n### The Beginning of a Parallel Investigation\n\nThe MM–Turla claim was not implausible. But we had nothing to substantiate a strictly technical\nconnection. So we decided to set out on a parallel investigation to prove this curious\nprogression. Even well-sourced claims would be challenged and it would be far more satisfying\nto a technical audience to provide technical artefacts that would set Turla into the league of\nprehistoric titans as the counterpart to the Equation Group.\n\nAs if this tall order were not difficult enough on its own, our initial assessment was grim. Firstly,\nwe had no samples from the MM intrusion set to compare with. As researchers, we often\nbemoan visibility issues in investigating modern attacks where all the blinky boxes and security\nsoftware in the world is already generating mountains of forensic evidence. How much greater\nwould the visibility barrier be for a twenty year old investigation?\n\nSecondly, were we to find forensic artefacts, what exactly would we be comparing those MM\nsamples with? There’s a rich history of Turla samples spanning around ten years worth of\nWindows-based malware operations, from userland malware to rootkits to plugins and on. So\nmight it be possible to simply hunt backwards for the oldest Windows sample? Our attempt\nwould not be the first time that archeological research would challenge a conception of Turla’s\nlongevity.\n\n#### The First Historical Correction\n\nAt the 2015 VirusBulletin conference, a different historic gap was bridged by our own Kurt\n[Baumgartner who revealed a solid connection between Turla and the old-school](https://www.virusbulletin.com/uploads/pdf/conference_slides/2015/Baumgartner-VB2015.pdf) [Agent.BTZ.](http://blog.threatexpert.com/2008/11/agentbtz-threat-that-hit-pentagon.html)\nThough the connection between the two would not be regarded with as much skepticism, Kurt\nprovided yet another solid link by finding samples of Agent.BTZ that connect to Turla hijacked\nsatellite infrastructure. This adds to [research](https://blog.gdatasoftware.com/2014/11/23937-the-uroburos-case-new-sophisticated-rat-identified) by Paul Rascagneres tying the two. The Turla–\nBTZ link is solid, but it only gets us as far back as 2008. Unpublished third-party research\nindicates that the internal development of this codebase can be traced back to a start date in\n2006, when Turla’s modern Windows toolkits began. The resulting decade-long gap seemed to\nfrustrate any attempt to forensically recreate the more ambitious connection to Moonlight Maze.\n\n|Date|Context|Code Name|\n|---|---|---|\n|1996, Oct|Intrusions detected|Unnamed|\n|1998, July|FBI investigation starts|MOONLIGHT MAZE|\n|1999, March|ABC reveals investigation||\n|1999, April|FBI Task Force trip to Moscow||\n|1999, July|Sunday Times reveals code name||\n|1999/2000||STORM CLOUD|\n\n\n-----\n\n|2001|WSJ reveals new code name|Col3|\n|---|---|---|\n|2003||MAKERS MARK|\n|2008, Oct|DoD detects intrusion|Agent.BTZ|\n|2008|Removal campaign revealed|BUCKSHOT YANKEE|\n|2014, Dec|Kaspersky report published|PENQUIN TURLA|\n|2015, Jan|“MAKERS MARK” revealed in Snowden files2||\n|2016, May|Swiss GovCERT (MELANI) published RUAG report|PENQUIN TURLA confirmed in-the-wild|\n\n\n#### A Dead End?\n\nWith epic odds against us, we hit the drawing board once again with little to go on. One key\nfinding from the interviews for Rise kept us going: ‘MM’ was in fact a Solaris/*nix-based attack\nand not actually Windows-based, as outsiders might’ve assumed. This small detail sent us in an\nentirely different direction. Rather than futilely attempting to unearth the MM intrusion set by\nhunting for older Turla Windows samples, we were reminded of some very rare samples\n[discovered by GReAT in late 2014, called ‘Penquin Turla’. This was a strange Linux backdoor](https://securelist.com/blog/research/67962/the-penquin-turla-2/)\nby the Turla actor originally discovered on a multiscanner, with no evidence of deployment in[the-wild at the time, but including the telltale use of hijacked satellites](https://securelist.com/blog/research/72081/satellite-turla-apt-command-and-control-in-the-sky/) for exfiltration Turla loves\nso much.\n\nRevisiting these samples with fresh eyes, we noticed interesting signs pointing in the direction of\nan exceptionally old codebase developed and maintained from 1999 to 2004. Moreover, despite\nthe blogs assertion that Penquin was based on cd00r, a fresh investigation would point instead\nto an older backdoor called LOKI2.\n\nThe LOKI2 lead revived our hope of finding a connecting thread between the ancient MM and\nmodern Turla. Our working hypothesis is that, out of necessity, Turla dusted-off and reused its\n_old *nix code for a present-day target. But without MM samples and fragments we would be_\nunable to test this hypothesis. Moreover, Thomas dug up documents that revealed that the FBI,\nfollowing standard evidentiary procedures, had in due course destroyed the remaining evidence\nfrom this investigation. Other sources confirmed that all forensic evidence may have been lost to\nhistory.\n\n2 “Pay attention to that man behind the curtain: discovering aliens on CNE infrastructure,” CSEC CounterCNE, Target Analytics thread SIGDEV Conference, NSA, June 2010, p. 17, in “NSA Preps America for\nFuture Battle,” Der Spiegel, 17 January 2015.\n\n\n-----\n\n_FBI destruction notice of stored evidence including “computer disks” on Moonlight Maze, Feb 2008._\n_Source: FBI FOIA release, 1300712-000, 21 November 2014._\n\nOur last hope was that someone with a passion for history had held onto artefacts that were\nnow collecting dust in some cupboard somewhere ...\n\n#### The Cupboard Samples\n\n_The still functioning ‘HRTest’ server was used as a key relay site by_\n_the Moonlight Maze operators for around six months in late 1998/1999_\n\nIn computer network intrusions, proxying is one of the ways in which operators muddy the\nattribution waters. By relaying their connections through a server or a hacked endpoint, the final\n\n\n-----\n\ndestination will only be aware of the latest hop. The Moonlight Maze operators were early\nadopters of this technique. They popped a series of servers like universities, libraries, and\nvulnerable institutions in different countries that would go on to be used as staging servers to\npull archives full of tools and exploits and to relay through on their way to victims in order to\nthrow early investigators off the scent of the attackers. In the end, it didn’t turn out exactly how\nthe stealthy attackers intended.\n\nOne of the institutions targeted by the MM operators was a company in the U.K. Upon discovery\nof its use as a relay site, the FBI and Scotland Yard contacted their system administrator and\nset out to turn this server against the attackers. HRTest was set up to collect logs, save all\narchives, capture packets, and particularly to monitor a user named ‘it.’ This move proved a\ncoup for the investigators, who received a six month snapshot of MM operations through that\nrelay site from 1998–1999. Nearly a decade later, we would too.\n\n_Thomas Rid, David Hedges, Daniel Moore, and Juan Andres Guerrero-Saade at King’s College London, March 2016_\n\nIn one meeting, the now retired system administrator pulled a bulky vintage HP laptop from his\nbag. As he walked us through the old logs and exfiled documents, it became clear that it may be\npossible after all to shed light into this dimly lit ancient maze. The HRTest intercepts contained\n45 binaries, including 28 SunOS SPARC binaries and 17 IRIX MIPS binaries, as well as 9\nscripts. An extensive analysis of these is provided in a separate technical report (Appendix B).\nHe would also provide extensive logs, generated by both EtherPeek as well as the attackers\nthemselves (Appendix A below). Fascinated by this treasure trove, we would spend months\nreconstructing deep-diving into these materials.\n\n\n-----\n\n### Entering the Moonlit Maze\n\n_A 27 May 1997 US Navy Incident Report mentioning the /cgi-bin/phf exploit and the link to citiline.ru._\n_Source: US Navy FOIA Release, SEROOLJF/12U6048, 19 December 2012._\n\n[It all began with a single borrowed exploit. Documents FOIA requested by Karl Grindal describe](http://karlgrindal.com/)\nmultiple intrusion attempts on military systems by abusing a vulnerability in a specific common\ngateway interface (CGI) binary. The binary, named <phf>, was commonly bundled with the\nHTTP daemon at the time and thereby often present on outfacing web servers. Some time in\n[early 1996, an exploit against <phf> started making the rounds. The vulnerability could be](http://insecure.org/sploits/phf-cgi.html)\nexploited with a web request crafted in the following way:\n\nhttp://<server>/cgi-bin/phf?Qalias=%ff/bin/cat%20/etc/passwd\n\nThe server was thereby primed to spit out the contents of the password file—thus allowing the\nattackers to simply telnet or ftp into the server and login under the guise of a legitimate user. In\nsome cases these attempts failed, simply based on the absence of the vulnerable <phf> binary.\nIn others, they clearly succeeded and paved the way for an onslaught of attacks that would\nprove hard to root out even years later.\n\n#### A Toolkit Forged through Trial-and-Error\n\nThis opportunistic trial-and-error approach would come to describe much of the early days of\nMoonlight Maze, as evident in the toolkit leveraged on different victim boxes. Upon connecting\nto a victim server, the attackers would retrieve a TAR archive containing a series of exploits\n\n\n-----\n\ncompiled into binaries, tools (both custom and open-source), and configuration or automation\nscripts. Early tool archives contained a wide spread of exploits and tools, almost all drawn from\npublicly available source code. These were essentially hit or miss attempts, testing different\nexploits with no certainty that the victims would be vulnerable to these. Similarly, some of the\ntools worked while others were broken and in need of retooling or replacing.\n\nComing from a time before packers and fancy obfuscation, the binaries are largely\nstraightforward tools that showcase the attackers' pragmatic approach and a purity of\nfunctionality seldom encountered in modern malware. The binaries often borrow code and\nexploits from forums and security mailing lists.\n\n#### An Improved ‘solsniffer’\n\nThe evolution of sniffers within MM illustrates how the operators grew from nation-state script\nkiddies to developers in their own right. After a broken sniffer failed (<ora>), sniffers were built\nusing tcpdump, libpcap, and a 1994 rootkit called ‘solsniffer’ (<tdn>). The operators eventually\ncombined both styles into the more successful <td_tr>. These sniffers collected data\npromiscuously on victim networks and generated logs of connections on ports like telnet, pop3,\nftp, rlogin. This sniffer would continue to be used for the remainder of our visibility and yield\nsome of the most interesting forensic artefacts[3].\n\n#### LOKI2 — The Evolving Norse God of Covert Channel Comms\n\n_The development tree of LOKI2 in the Moonlight Maze samples from 1997–1999._\n\nSimilarly, the attackers found another favorite in LOKI2. The small tool was an ingenious covert\nchannel backdoor written by Alhambra and daemon9 and published in Phrack from 1996-1997.\n\n3 See Appendix A for an analysis of the log files.\n\n\n-----\n\nThe purpose of LOKI2 is to tunnel traffic through unusual protocols like ICMP. The attackers\nbegan by leveraging a straightforward compilation of LOKI2 named <lc> and, not knowing how\nto better interact with the daemon, wrote their own client, which they internally named ‘spy_cli.c’.\nLOKI2 became a favorite and received the most sustained development effort based on our\nvisibility into the campaign.\n\nLOKI2 would be further developed. The <lc> and <cli> combination described above would\nevolve to <lo>, one stripped of obvious strings and error messages to throw off investigators\nthat may check strings in search of infections. The next iteration reflects their preference for this\nsuccessful covert channel tool as they start to integrate custom functionality. The most\nimportant development is a put/get backdoor that would allow the intruders to bypass the need\nfor FTP by being able to move files as needed. This suggests further limitations in our visibility:\nwe have not been able to observe such covert traffic. The final evolution within the span of\nHRTest’s visibility is named <lopg>. It too includes the custom put/get backdoor along with\n<slok>, a strange utility that invokes a hidden instance of pine (an old school mail client) for\nsome sort of command-line usage we have yet to observe. Additionally, the developers baked in\na utmp log cleaner as an added measure of stealth to remove any logs of their intrusions. This\n_trend of a notable preference for LOKI2 and its further development would play a key role in our_\n_parallel investigation._\n\n#### Parallel Development\n\nDepending on the victim system, the attackers would retrieve archives full of tools designed for\nSunOS SPARC or IRIX MIPS. The latter would usually include an 'i' in the name, both for the\narchive and the binaries inside. The IRIX toolkit consists of largely the same tools as the\nSPARC toolkit, though a greater number of samples and binary development suggests that, at\nleast for the period of our visibility, the operators were more prone to interact with SunOS\nsystems. Development between both toolkits was bi-directional. If something worked on one\nplatform, it would likely be ported or cross-compiled for the other architecture. Interestingly, one\ntool (a log cleaner) appears to have been ported to IRIX by the operators themselves, including\nthe wiping of IRIX log files not present on SunOS systems.\n\n#### A Note on the Exploits\n\nThe exploits were leveraged in a trial-and-error approach almost entirely for the sole purpose of\nprivilege escalation. With little previous reconnaissance on new victims, the attackers would\noften retrieve an archive with half a dozen exploits onto a new victim system and proceed to\nexecute different ones. If none worked, they might attempt a different archive or move onto\nanother system on the same network and resume their attempts there. This isn't the hypercognizant modern attacker that studies a victim and prepares specifically tailored tools for an\nattack but given MM's proliferation and overall success, we should perhaps reserve judgment\nfor lack of surgical precision.\n\nGiven the intensity of the modern debate on responsible disclosure of vulnerabilities, it’s worth\nnoting that the Moonlight Maze campaign achieved much of its success exfiltrating sensitive\n\n\n-----\n\ninformation by using many exploits, but none of these were developed by the attackers\nthemselves. All the exploits that we have identified came from public resources. In most cases,\nthe exploits were developed as proofs-of-concept by benign system administrators hoping to\ninform others of the vulnerabilities present in their own systems. Two important contextual\nobservations must be made:\n\nFirst, software manufacturers and maintainers in the mid-90s were not too troubled by\nsecurity patch cycles. According to the discoverers, some of the vulnerabilities publicized\nwere going unpatched for periods of six months to a year after having been reported to\ncompanies like Silicon Graphics (developers of IRIX).\n\nSecondly, system administrators at the time were more likely to be capable of rolling\nsome of their own patches or workarounds and could thereby benefit from awareness of\nthese vulnerabilities.\n\nThe true menace came from the disclosure of weaponized proof-of-concept code, rather than\ndescriptions of the vulnerabilities themselves. This allowed the Moonlight Maze operators to\ncopy-paste their way into the history books.\n\n#### Pseudo-Automation\n\nIn our experience, the most advanced modern cyberespionage operations tend to be\ncharacterized by extremely sophisticated development efforts whose byproducts are generally\ndeployed by lesser skilled operators. This becomes clear in incident response engagements\nthat reveal the operators’ keyboard fumbling, misspellings, or retries.\n\nThat is not the case with the MM operators. In fact, the situation is inverted. The MM operators\nappear to be skilled *NIX users, who are crafty and pragmatic, and in no way intimidated by onkeyboard operations, all the while using a lesser-grade largely open-source toolkit. This\noperator intensive modus operandi is documented in the logs and codified into the binaries and\nscripts that allow them to pseudo-automate a stunningly vast network of victims without reliance\non modern command-and-control infrastructure nor sophisticated malware capable of\nperforming more complex operations on its own and serving up results without interaction.\n\nSample sniffer configuration script from the 1996–1999 Moonlight Maze samples\n\nThe operators developed different types of scripts that they relied on to set the tasking for\ndifferent malware components. In turn, malware meant to stay resident on the victim system\nwould check specifically named files in the ‘/var/tmp/’ directory for instructions or configuration.\nIn later phases of their campaign, this allowed the operators to simply connect to a system or\nnetwork and change these tasking files as necessary in order to instruct all infected systems to\nconduct certain operations.\n\n\n-----\n\n_Infostealer (left) and IP listing and hostname resolution (right) scripts from 1996–1999 samples_\n\nSimilarly, information stealing, lateral movement and exfiltration relied on well-crafted scripts\nmeant to cut salient information from logs and other byproducts of the malware implanted on\nvictim machines. The operators would always process sniffer logs for lists of domains that they\nwould then run through a custom tool to get the hostnames associated with these. These lists\nwould then be used to spread onto other victim networks associated with the already infected\nmachines, likely leveraging passwords they had also exfiltrated at this time.\n\nMoonlight Maze was artisanal digital espionage: an operator- and labor- intensive campaign\nwith little tolerance for error and only rudimentary automation.\n\n#### Meet Max, Iron, and Rinat\n\n_Compilation paths with usernames for Max, Iron, and Rinat from three different Moonlight Maze binaries._\n\nDespite their early adoption of operational security in the form of their extensive use of relays,\nthe Moonlight Maze operators made many mistakes resulting in small attributory indicators and\nthe creation of extensive forensic artifacts. These include indications of their lackluster English\nproficiency, the consistent use of a Russian word, and binary compilation information that\nserved as the ELF equivalent of PDB paths. The latter revealed some of the integrants of the\nMoonlight Maze crew as Max, Iron, and Rinat[4]. Though it’s possible these were compiled on\nvictim machines, the three users are seen in conjunction with paths like ‘/myprg/’, ‘/mytdn/’\n(<tdn> is the MM name for a set of sniffers), and ‘/exploits/’. Also noteworthy is the internal\nconvention for one of Iron’s early programs: <cli>, a client meant to function alongside an early\n\n4 Rinat is a common Tatar given name meaning “Labour” or “Revolution”.\n\n\n-----\n\nversion of the LOKI2 backdoor, was internally named ‘spy_cli.c’. That small fact may suggest an\nearly awareness that the intention of the operation was not ‘hacking for fun’ as was popular in\nthe 90s but rather espionage proper.\n\n_A transliteration of the Russian “внук”._\n\nTwo binaries (<de> and the later improved <deg>) consistently use the transliterated Russian\nword ‘vnuk’, meaning “grandchild” or “grandson”, to print out the PID of a twice-forked process.\n\n_One of many examples of charmingly broken English in the Moonlight Maze binaries._\n\nOn the other hand, the developers’ evidenced English proficiency was nothing to marvel at.\nBinaries included strings with misspellings like “Hiding complit...n”, “receving message\", and\n\"Error in parametrs”. They also included awkwardly phrased strings like “ERROR: Can not open\nsocket....\", \"open file for read\", \"Connect successful....\", and \"ERROR: Not connect...\".\n\nAll of the tool configuration and execution, lateral movement, and exfiltration visible to us\noccurred while the operators were connected to the systems through the HRTest relay site. Due\nto our visibility into backend connections, we were able to profile timestamps of these\nconnections to serve the equivalent of a histogram as might normally be done with compilation\ntimestamps from PE files. The histogram places hours of operation as apparently conforming to\nan 8AM workday at UTC+3[5].\n\n### Penquin Turla Revisited\n\nA prescient statement by Kurt Baumgartner in the original discovery blogpost for Penquin Turla\n\nIn December 2014, Kaspersky announced the discovery of a Linux-based Turla toolkit named\nPenquin Turla. The [blogpost was based on one sample and another broken file and described a](https://securelist.com/blog/research/67962/the-penquin-turla-2/)\nquirky statically-linked backdoor that applies a BPF-filter to look for certain magic packets. It\n[also misidentifies the source code used as cd00r, an open-source backdoor by fx. The actual](http://www.phenoelit.org/stuff/cd00r.c)\nsource code was in fact LOKI2. At the time, there was no evidence of use in-the-wild but the\nbackdoor was lumped into the larger cluster of Turla activity by its use of a hardcoded Turla\ndomain (news-bbc.podzone[.]org). Since then, we would go on to discover five additional\nfunctional samples, including variants, and a very rare trojanized version. Among these, two\n\n5 See Appendix A for more details.\n\n\n-----\n\nsamples would point to an additional known Turla IP (82.146.175[.]43) from a Lebanese satellite\nconnection provider.\n\n#### Dating the Penquin Codebase\n\nMost of the Penquin Turla samples found were not stripped of debugging symbols at compile\ntime, aiding in the process of reverse engineering these by maintaining some original names\nand compilation information. These samples are statically-compiled 32-bit Linux ELF binaries\nlinked with C libraries for GNU/Linux kernel versions 2.2.0 and 2.2.5. The former kernel was on\nJanuary 20th, 1999, while version 2.2.5 was released later that year. A very rare Penquin Turla\nsample trojanized into a Linux network time protocol daemon was linked for kernel version\n2.2.18, released on December 11th, 2000, and stripped of debugging symbols.\n\nThe code statically linked into these samples includes versions of open-source libraries like\nlibpcap and OpenSSL from 1999-2004:\n\nWhile these headers are not equivalent to the compilation timestamps available in the PE file\nformat, they provide start date delimiters for active development in the codebase.\nSimilarly, a private report detailing an incident with another Penquin Turla variant not in our\ncollection, details a version statically linked with both libpcap version 0.7 (2001-2002) and\nSSLeay version 0.9.0b (Jan 1999). These findings lead the researchers to independently\nconclude that the Penquin Turla codebase was old and likely developed in 2002.\n\n#### The RUAG Report – Penquin In-the-Wild\n\n_MELANI Swiss GovCERT’s insightful analysis of an active Penquin Turla infection at RUAG_\n\n\n-----\n\n[In May, 2016, the Swiss CERT published a report detailing a prolonged campaign against the](https://www.melani.admin.ch/melani/en/home/dokumentation/reports/technical-reports/technical-report_apt_case_ruag.html)\ndefence contractor, Ruag. The report, which is of extremely high quality and displays great\ntalent on the part of the Swiss GovCERT researchers, publicly discloses the first known case of\na Penquin Turla infection in-the wild.\n\nThe sample analyzed by MELANI involves a further development suggesting that Turla finally\ntook the advice proffered in the original Phrack article describing LOKI2:\n\n_Source: LOKI2 – the implementation (Phrack Magazine: Volume 7, Issue 51 September 01, 1997)_\n\nThe original LOKI2 developers recognized that, though the purpose of their backdoor was to\nenable covert communications in an infected network, the backdoor itself was not ‘clandestine’\nand could be detected while operating on the infected system. Their advice was to implement\nLOKI2 as a loadable kernel module or to patch the backdoor directly into the operating System.\nTurla went for a version of the latter. They took the source code for a Linux system component,\nthe Network Time Protocol daemon (ntpd) and trojanized it to include a version of the Penquin\nTurla sniffer variant, thus making it harder to spot operating in the victim system.\n\nThe RUAG report provided us with the first public victim data of a campaign leveraging Penquin\nTurla in-the-wild. All samples before that had been derived from multiscanners and thereby\ndeprived of context. The exceptional work of MELANI not only confirmed our finding that the\nPenquin samples were derived from LOKI2 but also provided a glimpse Turla’s selective\ndeployment of Penquin. Turla deploys the Penquin backdoor after the victim network exhibits\nresilience by means of a successful cleanup of their initial incursion. The Penquin backdoor is\nthen leveraged to provide a beachhead during a second incursion as well as enabling\ninconspicuous communications within the breached network.\n\nWhile our Penquin samples don’t appear on multiscanners until late 2014, the RUAG incident\nplaces the Penquin infection at 2011. It’s worth noting that a previously unseen sample of\nPenquin Turla was uploaded to VirusTotal from a machine in Germany in March 2017.\n\n### The Argument as it Stands\n\nAn analysis of our trove of samples shows a clear development trend in which the operators\nproduced successive iterations of LOKI2, a favorite tool in their arsenal. In the later versions, the\nMoonlight Maze team begins to bake other tools and custom functionality into LOKI2 as they\nmove towards a standalone malware family that would no longer require the leveraging of\nmultiple separate tools. Our visibility ends right where we expect the development of the modern\n\n\n-----\n\nPenquin Turla to start. The first press reports on the investigation had the effect that the MM\noperators dropped the London relay site—and then improved their tools and operational\nsecurity. As a result it has been difficult to forensically link MM to Turla. We were able to detail a\ndevelopment trend as well as smaller overlaps in their adoption of the LOKI2 source code as\nwell as similar functional patterns. The two toolkits follow a consistent linear development trend.\n```\nMoonlight Maze LOKI2 Samples Penquin Turla Samples\nLOKI2 adopted and developed sometime Penquin Turla codebase actively\nin 1998 or earlier. developed from 1999-2004.\nMalware starts by implementing the Malware starts by reading a hidden\noperators pseudo-automation trick of file in a temp or root directory\nreading a hardcoded file (‘/tmp/.xdfg’, ‘/root/.xfdshp1’) for\n‘/var/tmp/taskpid’ for instructions configuration.\nand configuration.\nProgressive iterations of LOKI2 Malware contains none of the strings\nobvious references to LOKI2 and error or overt references removed from the\nmessages, shorten strings printed out MM implementations of LOKI2.\nto the command-line, and later remove\nthem altogether.\nLater versions remove some command- All of the original command-line\nline switches present in the original switches have been removed.\nsource code and alter the remaining\nones to begin with a ‘!’ instead of\n‘/’.\n\n```\nThe forensic trendline supports our argument of continuity, but more hard technical evidence is\nneeded to confirm that Moonlight Maze is Turla. In the 1990s, it was rare to be a nation-state\nattacker but the LOKI2 backdoor was accessible and perhaps common. In 2017, it is far more\ncommon to be a nation-state attacker but incredibly rare to use LOKI2—or any twenty-year-old\nmalware code for that matter. After extensive hunting, Turla is currently still the only known\nmodern threat actor leveraging the LOKI2 source code. In short: the provenance is likely, but\none link is still missing. We believe that missing link is the Storm Cloud intrusion set.\nRemarkably the Wall Street Journal reported in 2001 that LOKI2 is at the base of Storm Cloud,\nand thus likely the lost bridge to the Penquin Turla samples.\n\n#### More Light into the Maze\n\nInvestigating a historical case flips the role of disclosure and publicity. Disclosing details from an\nongoing investigation runs the risk of alerting intruders to the fact that they have been caught. A\ndisciplined adversary will retune their operational security and drop known infrastructure,\nleading to a loss of visibility for investigators. Publicity tends to be a problem, as we know from\nMM: when the operation was first covered in the press on 4 March 1999, even without a\n\n|Moonlight Maze LOKI2 Samples|Penquin Turla Samples|\n|---|---|\n|LOKI2 adopted and developed sometime in 1998 or earlier.|Penquin Turla codebase actively developed from 1999-2004.|\n|Malware starts by implementing the operators pseudo-automation trick of reading a hardcoded file ‘/var/tmp/taskpid’ for instructions and configuration.|Malware starts by reading a hidden file in a temp or root directory (‘/tmp/.xdfg’, ‘/root/.xfdshp1’) for configuration.|\n|Progressive iterations of LOKI2 obvious references to LOKI2 and error messages, shorten strings printed out to the command-line, and later remove them altogether.|Malware contains none of the strings or overt references removed from the MM implementations of LOKI2.|\n|Later versions remove some command- line switches present in the original source code and alter the remaining ones to begin with a ‘!’ instead of ‘/’.|All of the original command-line switches have been removed.|\n\n\n-----\n\nmention of the code name, the operators instantly dropped HRTest as a hop point, cutting off\nmuch visibility for the investigators. Publicity degrades visibility in ongoing investigations.\n\nThe reverse applies for historical cases: publicity increases visibility in historic investigations.\nAgain MM illustrates this effect: presenting our research at The Security Analysts Summit (SAS)\nin 2016 brought the historic research to the attention of more former investigators and sources.\nPublished research, if done well, builds trust. Published research also means more eyes-on-theball. We now turn to the SAS once again to share the research we’ve been working on for the\npast nine months with the hope that the larger InfoSec community will feel motivated to conduct\nfurther research into these forgotten operations. Our hope in particular is to shine a light on\nSTORM CLOUD, the next phase of the MM campaign. Little is known about Storm Cloud in\npublic circles. We know the codename designates an improved toolkit still based on LOKI2,\naccording to public reports.[6] We also know it should overlap with the apparent period of\ndevelopment of the Penquin Turla codebase. Given our findings so far, we expect these\nsamples to be of critical importance. We would therefore ask everybody who may have old\nsamples, especially from the early 2000s, to reach out to us and enable the next step in this\nhistoric research—the great Moonlight Maze retro-hunt continues.\n\n[Please reach out to <penquin@kaspersky.com>, or to one of us individually.](mailto:penquin@kaspersky.com)\n\n6 Bridis, Ted, “Net Espionage Rekindles Tensions as US Tries to Identify Attackers,” Wall Street Journal,\n27 June 2001.\n\n\n-----\n\n### Appendix A: The Log Files\n\nThe malware itself opened up a second, unexpected angle into the wider campaign: by\nexamining network sniffer log files created on victim computers, we were able to reconstruct\nsurprisingly granular network topology. Better yet, we managed to identify several instances in\nwhich the operators unwittingly recorded themselves conducting live terminal sessions. From\nexploit attempts to performing cleanup functions, we were able to study the operators’ detailed\nmodus operandi twenty years after the fact.\n\nThe network analysis procedure included two primary datasets: sniffer log files produced by the\nmalware and then exfiltrated to their staging servers, and the relay server’s own EtherPeek logs\nrecorded by David Hedges in cooperation with Scotland Yard and the FBI. But sifting the old\nlogs was hard at first. To do a proper analysis, we needed a platform to both visualize\nconnections and hunt for specific sessions. Thus Rapyd was born, a dedicated interface created\nspecifically to parse out and structure the various log formats.\n\n_Overview of generated graphs of Moonlight Maze traffic with histogram and search functionality in Rapyd, April 2016._\n\nNetwork forensics showed just how far deeply the remote intruders had penetrated U.S.\ngovernment and academic networks. Roughly 1,600 unique IP addresses spanned computers\nand servers in the US Navy, Air Force, Army Corps of Engineers, Marine Corps, NASA, the\nNational Oceanic and Atmospheric Administration and numerous U.S. universities. Even the\nlimited snapshot of data afforded to us by several months of log data was highly instructive. The\n\n\n-----\n\nlogs illustrated what the operators cared about, how they worked, and just how expansive the\ncampaign truly was.\n\nYet this analysis hinges on a relatively limited dataset. The op likely started in 1996, and\ncontinued well into the twenty-first-century. The MM logs examined only included months of\ndata and telemetry, from October 1998 to March 1999. What looks like a gargantuan network\nanalysis therefore only encompasses a small fraction of the overall campaign. Even within our\ntime window, visibility was limited — we only have access to material received from one single\nstaging server in the UK. There were more in Canada, Norway, and Thailand. But the operation\nwas long, vast, and skillfully executed, so the number of staging servers could be much larger.\n\n#### Retracing the Operation\n\nThe network analysis opened a unique window into the behavior of a professional intruder\npredating many of the considerations we take for granted today for malicious actor. Most\ncommunication wasn’t encrypted, patterns are easily discernible, and assets such as malicious\nfilenames were frequently reused. There was a clear routine to the operation spanning several\nyears and dozens of networks. Even so, retracing much of the operation was difficult, as the\nnetwork sniffer output only recorded four protocols; FTP, POP3, Telnet, and rlogin. Whatever\nprotocol was in use for potential command-and-control communication by persistent malware\nwas not visible to us.\n\nThe FTP logs from HRtest show that the operators predominantly relied on dynamically\nassigned Russian IPs for the operation. Creating a time-of-day histogram for traffic with the\nrelay server correlated significantly with a GMT+3 timezone.\n\n_Time-of-day histogram (GMT) for file transfers with HRTest. Blue denotes operator connections, orange is retrieval by_\n\n_targeted hosts, and green is file exfiltration. April 2016._\n\nCommunication with HRTest was facilitated through FTP for sending and receiving payloads.\nNearly all files were compressed to TGZ bundles, a format used for both exfiltrating content and\nretrieving modules to be used by operators. Files never persisted on the relay server and were\ninstead repeatedly uploaded on demand. Exfiltrated file bundles would usually conform to an\nabbreviated hostname naming convention, with some variations clearly indicative of at least a\n\n\n-----\n\nsemi-manual naming scheme — scooby becomes scoo.tgz, sco.tgz, sco1.tgz and other similar\npermutations.\n\n_Example of FTP communications between US Navy server Scooby and the staging server in London._\n\nLooking for anomalies in the graph, we discovered two instances in which the operators\naccidentally recorded their own live terminal sessions on victim servers. Operators would turn\non the network capture module on a compromised server as a part of their routine procedures.\nThen the operators would tunnel from one server to another in a live terminal session, seeking\nto move laterally through the network. As a result, the session would be recorded on the first\nserver, and subsequently exfiltrated to HRTest. Discovering these recorded sessions was a a bit\nlike finding fossilized remains of network behavior where none should have existed.\n\n#### Session 1 — Attempted Lateral Movement\n\nThe first unusual session was detected when dissecting how exploit bundles were being\npropagated through the affected networks. When searching for one such bundle, eee.tar.z, a\nsecond-tier connection unexpectedly appeared.\n\n\n-----\n\n_Search results for eee.tar.z highlighted in yellow. The connection between two non-relay nodes was unexpected._\n\nThe unusual highlighted result was between two endpoints in the University of Illinois at UrbanaChampaign, or UIUC. The first, hspark.ece.uiuc.edu was a server in the Electrical and\nComputer Engineering department and already communicating regularly with the staging server.\nThe second — ux10.cso.uiuc.edu — was part of the university’s Computer and Communications\nServices Office. This machine had only one direct session with the staging server, in which it\nretrieved two exploit bundles.\n\n\n-----\n\n_Live operator privilege escalation attempt between two University of Illinois servers, hspark and ux10._\n\nThe session between hspark and ux10 indicated that the operators used the valid credentials of\none student to achieve initial access to the server. The intruders then proceeded to open an\nFTP connection to HRTest, retrieve the module package eee.tar.z, decompress and attempt to\nrun several of the exploits in sequence. After ufsr and rdi failed to gain root access, the\noperators retrieved a second module. Several additional privilege escalation attempts failed.\nThe operators eventually giving up and tunneling through to a different server on the same\nnetwork, ux4.\n\nThe session revealed that the exploit attempts were largely manual, relying on direct operator\ninteraction with the targeted machine. Some exploits were unusually verbose, corroborating the\n\n\n-----\n\nfinding that they were compiled from existing code rather than developed originally by the\nattackers. Operators dropped additional exploits on the system that were part of the\ndownloaded bundle but otherwise unused, an unnecessary risk. Lastly, verification attempts by\nthe operators were also visible. One such case included running the id command to check the\ncurrent session user, and another included checking a folder for a modified file.\n\n#### Session 2 — OPSEC\n\nA second operator session was discovered when examining the movement of exfiltrated data\nthrough the network. While searching for permutations of files named “milo” — corresponding to\na compromised server by the same name — our interface highlighted a session between two\ncompletely unrelated servers within the same network.\n\nHighlighted path represents all sessions that mentioned “milo.tar”\n\nWhile “milo” was indeed a US Navy endpoint previously seen communicating with the relay\nserver, there was no reasonable explanation for milo.tar to occur in a session between winkle\nand scylla, two other endpoints within the same network. Examining the session, it was revealed\nto indeed be a second accidental capture of a live session.\n\n\n-----\n\n_Part of the recorded session, showing log audits and looking for active sessions with the staging server._\n\nThe session showed the operators iterating through various logs and status checks on the\nendpoint. Among these:\n\n  - **last | egrep -e 194.201.203 — Look for last active sessions from HRTest. This is**\n\nparticularly interesting, as an outbound FTP connection should not register here, only\ninbound logins. This may reinforce the assessment that some non-FTP connections do\noccur between the staging server and targeted endpoints.\n\n  - **less asppp.log — Examining PPP logs.**\n\n  - **less sulog — Examining all attempts to run the su (superuser) command.**\n\n  - **less authlog — Examining all local authentication attempts.**\n\n  - **less idled.log — Examining all users currently connected to the endpoint.**\n\nThe operators appeared to self-examine their forensic footprint in this session. Standard\nreconnaissance efforts are commonplace when moving laterally through a network — but here\n\n\n-----\n\nthe logs show a focus on operational security. That the operators were looking for inbound\nsessions from HRtest was highly instructive, as we have previously only observed outbound\nconnections from affected endpoints. Finally, the intruders compressed milo.tar locally on a\ncompletely unrelated system, thus indicating that in some cases exfiltrated files may have been\ntunneled through the internal network prior to finally transferring them to the staging server.\nWe suspect this tunneling could have been done through the use custom file transfer\nfunctionality added to the\n\nthrough the use of custom put/get functionality added to their more advanced covert\ncommunications backdoor built on top of LOKI2 (detailed in the Technical Appendix B, under\n<lopg>).\n\n### Appendix B: Binaries, Exploits, and Scripts\n\nAn in-depth technical analysis of all Moonlight Maze binaries, exploits, and scripts is available\nas a separate document ‘Appendix B: Moonlight Maze Technical Report.’\n\n\n-----\n\n### Indicators of Compromise\n\n#### Moonlight Maze Samples\n\n IRIX Binaries\n\n|Filename|MD5|Size|Modification Date|\n|---|---|---|---|\n|df3|008ea82f31f585622353bd47fa1d84be|12KB|Feb 13, 1998|\n|eject|864e1d74e610a48c885ac719b5564eb1|17KB|Feb 13, 1998|\n|ig|4110c87e966d4ce6a03c5375353969af|77KB|Jul 27, 1998|\n|ilok|155d251e6e0dabce21ab26bd03487066|18KB|Oct 6, 1998|\n|lo (2)|f8df359c909ae12f313d9444a6d958d2|41KB|Jul 27, 1998|\n|log|a26bad2b79075f454c83203fa00ed50c|12KB|Jan 11, 1997|\n|loi|dabee9a7ea0ddaf900ef1e3e166ffe8a|29KB|Jan 3, 1997|\n|los|e59f92aadb6505f29a9f368ab803082e|37KB|Oct 25, 1998|\n|pset|86499f8e6cfc90770a65dc30f1c9939b|17KB|Feb 13, 1998|\n|sc (2)|59198b97f29fcf6e17f8653a99732a74|12KB|Feb 13, 1998|\n|snc|c73bf945587aff7bc7761b16fc85b5d7|12KB|Aug 24, 1996|\n|tdni|74af85d293ceb1cfd1a47c0d794e44d5|277KB|Aug 21, 1996|\n|ua|73a518f0a73ab77033121d4191172820|17KB|Oct 25, 1998|\n|ux (2)|dc9d91e8b2a90df6d25663778a312014|17KB|Jul 28, 1998|\n|xconsole|f67fc6e90f05ba13f207c7fdaa8c2cab|13KB|Feb 13, 1998|\n|xlock|5937db3896cdd8b0beb3df44e509e136|16KB|Feb 13, 1998|\n|xterm|f4ed5170dcea7e5ba62537d84392b280|13KB|Feb 13, 1998|\n\n\n-----\n\n#### Solaris Binaries\n\n|Filename|MD5|Size|Modification Date|\n|---|---|---|---|\n|cle|647d7b711f7b4434145ea30d0ef207b0|9.3KB|Apr 15, 1998|\n|cli|f106ab64b0dc773167a82da7635dfe27|10KB|Aug 7, 1998|\n|de|4bc7ed168fb78f0dc688ee2be20c9703|7.8KB|Jul 16, 1998|\n|deg|8b56e8552a74133da4bc5939b5f74243|8.5KB|Aug 7, 1998|\n|dt25|e32f9c0dac812bc7418685fa5dda6329|7.3KB|Jun 9, 1998|\n|dt26|7dc4f81ed408ff5a369cca737dff064c|10KB|Jun 11, 1998|\n|eje|7bc9d8da363091ad57456f8bd5027ab0|4.1KB|Apr 16, 1998|\n|ffb|26143b006710455888e01df9b58e1913|5.8KB|May 20, 1998|\n|g|338f20250b99d8dc064ba7ce8a9f48e1|68KB|Jun 2, 1997|\n|get|7c930162a676c46ac590342c91402dca|9.5KB|Jul 14, 1998|\n|lc|14cce7e641d308c3a177a8abb5457019|14KB|Jul 14, 1998|\n|lo|a3164d2bbc45fb1eef5fde7eb8b245ea|18KB|Apr 16, 1998|\n|lopg|9ab532cd3c16b66d98e0e738ddbe05a1|40KB|Oct 21, 1998|\n|lopg (2)|1980958afffb6a9d5a6c73fc1e2795c2|45KB|Nov 16, 1998|\n|ora|7b86f40e861705d59f5206c482e1f2a5|20KB|Apr 16, 1998|\n|p9|2213867345a51ecf09d3a747046af78c|6.2KB|Sep 30, 1998|\n|rdi|34c3ea4d6cc814a174579d295bdd028d|25KB|Oct 20, 1998|\n|sc|f684ecccd69cca88ba8508711f140240|3.4KB|Apr 16, 1998|\n|slok|d0f208486c90384117172796dc07f256|8.4KB|Feb 13, 1998|\n|snc (2)|99a4a154ddecffdab5f0bf91f8bfabb8|5.1KB|Sep 23, 1998|\n|spl|b4755c24e6a84e447c96b29ca6ed8633|6.1KB|Oct 25, 1998|\n|td_tr|66c8fa9569d6b5446eb865544ed67312|187KB|Jul 20, 1998|\n\n\n-----\n\n|tdn|927426b558888ad680829bd34b0ad0e7|91KB|Jul 13, 1998|\n|---|---|---|---|\n|u|d98796dcda1443a37b124dbdc041fe3b|9KB|Apr 16, 1998|\n|ufsr|07f070302f42219d37419d23ff9df091|5.9KB|Jun 30, 1998|\n|ux|b831cbffa1aee70252bb0f6862265cc9|7.4KB|Apr 16, 1998|\n|wp|e69efc504934551c6a77b525d5343241|11KB|Nov 5, 1998|\n|xk|4065d2a24240426f6e9912a22bbfbab5|8.4KB|Apr 16, 1998|\n\n\n#### Scripts\n\n|Filename|MD5|Size|Modification Date|\n|---|---|---|---|\n|daynotify.sh|10096abc73b7b7540b607c0ac1a27b49|1.3KB|Feb 13, 1998|\n|f|b17c00d6af4f8ab74af168db3fc7e6b5|209 bytes|Jun 11, 1998|\n|gr|d8347b2e32086bd25d41530849472b8d|342 bytes|Jul 14, 1998|\n|gr (2)|534a1a3212894cf44d8071bdd96ba738|261 bytes|Sep 15, 1998|\n|io|25bcfc394d44d717f20d416354d2126e|176 bytes|Oct 12, 1998|\n|tr|35f87672e8b7cc4641f01fb4f2efe8c3|177 bytes|Jul 12, 1998|\n|ts|84218bfec08af6a329a277cad9e0044a|60 bytes|Jan 22, 1997|\n|ts (2)|7a0d6b2fdc43b1b2a96b6409d4eed6e4|74 bytes|Sep 15, 1998|\n|tsa|58e4aa80f14c16e9292bd8f4535fb0cd|74 bytes|Aug 11, 1998|\n\n|Penquin Turla Samples|Col2|Col3|\n|---|---|---|\n|MD5|Size|Compilation Attributes|\n|0994d9deb50352e76b0322f48ee576c6|642KB|Stripped – Broken file|\n|edf900cebb70c6d1fcab0234062bfc28|802KB|Statically compiled for GNU/Linux 2.2.0|\n|19fbd8cbfb12482e8020a887d6427315|802KB|Statically compiled for GNU/Linux|\n\n\n-----\n\n|Col1|Col2|2.2.0|\n|---|---|---|\n|e079ec947d3d4dacb21e993b760a65dc|802KB|Statically compiled for GNU/Linux 2.2.0|\n|ea06b213d5924de65407e8931b1e4326|799KB|Statically compiled for GNU/Linux 2.2.0|\n|14ecd5e6fc8e501037b54ca263896a11|653KB|Statically compiled for GNU/Linux 2.2.5|\n\n\n_Note: Linux kernel version 2.2.0 was released on January 20th, 1999, while version 2.2.5 was_\n_released later that year._\n\n#### Penquin Turla Trojan Variant\n```\nMD5 Size Compilation Attributes\n296dc63ba0e62a33e9821f878f9b650d 855KB Statically compiled for GNU/Linux\n                         2.2.18, stripped\n                         (Kernel released: December 11\n                         2000)\n\n Yara Rules\n\n```\n/*\n\nMoonlight Maze Yara rules — TLP_GREEN\nAuthor: Kaspersky Lab, 2017\nVersion: 1.0\nDate: 2017-03-28\n\n*/\n\nrule apt_RU_MoonlightMaze_customlokitools {\n\nmeta:\n\nauthor = \"Kaspersky Lab\"\ndate = \"2017-03-15\"\nversion = \"1.1\"\nlast_modified = \"2017-03-22\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\ndescription = \"Rule to detect Moonlight Maze Loki samples by custom attackerauthored strings\"\n\n|MD5|Size|Compilation Attributes|\n|---|---|---|\n|296dc63ba0e62a33e9821f878f9b650d|855KB|Statically compiled for GNU/Linux 2.2.18, stripped (Kernel released: December 11 2000)|\n\n\n-----\n\nhash = \"14cce7e641d308c3a177a8abb5457019\"\nhash = \"a3164d2bbc45fb1eef5fde7eb8b245ea\"\nhash = \"dabee9a7ea0ddaf900ef1e3e166ffe8a\"\nhash = \"1980958afffb6a9d5a6c73fc1e2795c2\"\nhash = \"e59f92aadb6505f29a9f368ab803082e\"\n\nstrings:\n\n$a1=\"Write file Ok...\" ascii wide\n$a2=\"ERROR: Can not open socket....\" ascii wide\n$a3=\"Error in parametrs:\" ascii wide\n$a4=\"Usage: @<get/put> <IP> <PORT> <file>\" ascii wide\n$a5=\"ERROR: Not connect...\" ascii wide\n$a6=\"Connect successful....\" ascii wide\n$a7=\"clnt <%d> rqstd n ll kll\" ascii wide\n$a8=\"clnt <%d> rqstd swap\" ascii wide\n$a9=\"cld nt sgnl prcs grp\" ascii wide\n$a10=\"cld nt sgnl prnt\" ascii wide\n\n//keeping only ascii version of string ->\n$a11=\"ork error\" ascii fullword\n\ncondition:\n\n((any of ($a*)))\n\n}\n\nrule apt_RU_MoonlightMaze_customsniffer {\n\nmeta:\n\nauthor = \"Kaspersky Lab\"\ndate = \"2017-03-15\"\nversion = \"1.1\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\ndescription = \"Rule to detect Moonlight Maze sniffer tools\"\nhash = \"7b86f40e861705d59f5206c482e1f2a5\"\nhash = \"927426b558888ad680829bd34b0ad0e7\"\noriginal_filename = \"ora;tdn\"\n\nstrings:\n\n//strings from ora ->\n$a1=\"/var/tmp/gogo\" fullword\n$a2=\"myfilename= |%s|\" fullword\n$a3=\"mypid,mygid=\" fullword\n$a4=\"mypid=|%d| mygid=|%d|\" fullword\n\n\n-----\n\n//strings from tdn ->\n$a5=\"/var/tmp/task\" fullword\n$a6=\"mydevname= |%s|\" fullword\n\ncondition:\n\n((any of ($a*)))\n\n}\n\nrule loki2crypto {\n\nmeta:\n\nauthor = \"Costin Raiu, Kaspersky Lab\"\ndate = \"2017-03-21\"\nversion = \"1.0\"\ndescription = \"Rule to detect hardcoded DH modulus used in 1996/1997 Loki2\nsourcecode; #ifdef STRONG_CRYPTO /* 384-bit strong prime */\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\nhash = \"19fbd8cbfb12482e8020a887d6427315\"\nhash = \"ea06b213d5924de65407e8931b1e4326\"\nhash = \"14ecd5e6fc8e501037b54ca263896a11\"\nhash = \"e079ec947d3d4dacb21e993b760a65dc\"\nhash = \"edf900cebb70c6d1fcab0234062bfc28\"\n\nstrings:\n\n$modulus={DA E1 01 CD D8 C9 70 AF C2 E4 F2 7A 41 8B 43 39 52 9B 4B 4D E5 85\nF8 49}\n\ncondition:\n\n(any of them)\n\n}\n\nrule apt_RU_MoonlightMaze_de_tool {\n\nmeta:\n\nauthor = \"Kaspersky Lab\"\ndate = \"2017-03-27\"\nversion = \"1.0\"\nlast_modified = \"2017-03-27\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\ndescription = \"Rule to detect Moonlight Maze 'de' and 'deg' tunnel tool\"\n\n\n-----\n\nhash = \"4bc7ed168fb78f0dc688ee2be20c9703\"\nhash = \"8b56e8552a74133da4bc5939b5f74243\"\n\nstrings:\n\n$a1=\"Vnuk: %d\" ascii fullword\n$a2=\"Syn: %d\" ascii fullword\n\n//%s\\r%s\\r%s\\r%s\\r ->\n$a3={25 73 0A 25 73 0A 25 73 0A 25 73 0A}\n\ncondition:\n\n((2 of ($a*)))\n\n}\n\nrule apt_RU_MoonlightMaze_cle_tool {\n\nmeta:\n\nauthor = \"Kaspersky Lab\"\ndate = \"2017-03-27\"\nversion = \"1.0\"\nlast_modified = \"2017-03-27\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\ndescription = \"Rule to detect Moonlight Maze 'cle' log cleaning tool\"\nhash = \"647d7b711f7b4434145ea30d0ef207b0\"\n\nstrings:\n\n$a1=\"./a filename template_file\" ascii wide\n$a2=\"May be %s is empty?\" ascii wide\n$a3=\"template string = |%s|\"  ascii wide\n$a4=\"No blocks !!!\"\n$a5=\"No data in this block !!!!!!\" ascii wide\n$a6=\"No good line\"\n\ncondition:\n\n((3 of ($a*)))\n\n}\n\nrule apt_RU_MoonlightMaze_xk_keylogger {\n\nmeta:\n\n\n-----\n\nauthor = \"Kaspersky Lab\"\ndate = \"2017-03-27\"\nversion = \"1.0\"\nlast_modified = \"2017-03-27\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\ndescription = \"Rule to detect Moonlight Maze 'xk' keylogger\"\n\nstrings:\n\n$a1=\"Log ended at => %s\"\n$a2=\"Log started at => %s [pid %d]\"\n$a3=\"/var/tmp/task\" fullword\n$a4=\"/var/tmp/taskhost\" fullword\n$a5=\"my hostname: %s\"\n$a6=\"/var/tmp/tasklog\"\n$a7=\"/var/tmp/.Xtmp01\" fullword\n$a8=\"myfilename=-%s-\"\n$a9=\"/var/tmp/taskpid\"\n$a10=\"mypid=-%d-\" fullword\n$a11=\"/var/tmp/taskgid\" fullword\n$a12=\"mygid=-%d-\" fullword\n\ncondition:\n\n((3 of ($a*)))\n\n}\n\nrule apt_RU_MoonlightMaze_encrypted_keylog {\n\nmeta:\n\nauthor = \"Kaspersky Lab\"\ndate = \"2017-03-27\"\nversion = \"1.0\"\nlast_modified = \"2017-03-27\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\ndescription = \"Rule to detect Moonlight Maze encrypted keylogger logs\"\n\nstrings:\n\n$a1={47 01 22 2A 6D 3E 39 2C}\n\ncondition:\n\n($a1 at 0)\n\n}\n\n\n-----\n\nrule apt_RU_MoonlightMaze_IRIX_exploit_GEN {\n\nmeta:\n\nauthor = \"Kaspersky Lab\"\ndate = \"2017-03-27\"\nversion = \"1.0\"\nlast_modified = \"2017-03-27\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\ndescription = \"Rule to detect Irix exploits from David Hedley used by Moonlight Maze\nhackers\"\nreference2 = \"https://www.exploit-db.com/exploits/19274/\"\nhash = \"008ea82f31f585622353bd47fa1d84be\" //df3\nhash = \"a26bad2b79075f454c83203fa00ed50c\" //log\nhash = \"f67fc6e90f05ba13f207c7fdaa8c2cab\" //xconsole\nhash = \"5937db3896cdd8b0beb3df44e509e136\" //xlock\nhash = \"f4ed5170dcea7e5ba62537d84392b280\" //xterm\n\nstrings:\n\n$a1=\"stack = 0x%x, targ_addr = 0x%x\"\n$a2=\"execl failed\"\n\ncondition:\n\n(uint32(0)==0x464c457f) and (all of them)\n\n}\n\nrule apt_RU_MoonlightMaze_u_logcleaner {\n\nmeta:\n\nauthor = \"Kaspersky Lab\"\ndate = \"2017-03-27\"\nversion = \"1.0\"\nlast_modified = \"2017-03-27\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\ndescription = \"Rule to detect log cleaners based on utclean.c\"\nreference2 = \"http://cd.textfiles.com/cuteskunk/Unix-Hacking-Exploits/utclean.c\"\nhash = \"d98796dcda1443a37b124dbdc041fe3b\"\nhash = \"73a518f0a73ab77033121d4191172820\"\n\nstrings:\n\n$a1=\"Hiding complit...n\"\n$a2=\"usage: %s <username> <fixthings> [hostname]\"\n$a3=\"ls -la %s* ; /bin/cp ./wtmp.tmp %s; rm ./wtmp.tmp\"\n\n\n-----\n\ncondition:\n\n(uint32(0)==0x464c457f) and (any of them)\n\n}\n\nrule apt_RU_MoonlightMaze_wipe {\n\nmeta:\n\nauthor = \"Kaspersky Lab\"\ndate = \"2017-03-27\"\nversion = \"1.0\"\nlast_modified = \"2017-03-27\"\nreference = \"https://en.wikipedia.org/wiki/Moonlight_Maze\"\ndescription = \"Rule to detect log cleaner based on wipe.c\"\nreference2 = \"http://www.afn.org/~afn28925/wipe.c\"\nhash = \"e69efc504934551c6a77b525d5343241\"\n\nstrings:\n\n$a1=\"ERROR: Unlinking tmp WTMP file.\"\n$a2=\"USAGE: wipe [ u|w|l|a ] ...options...\"\n$a3=\"Erase acct entries on tty :  wipe a [username] [tty]\"\n$a4=\"Alter lastlog entry    :  wipe l [username] [tty] [time] [host]\"\n\ncondition:\n\n(uint32(0)==0x464c457f) and (2 of them)\n\n}\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://securelist.com/files/2017/04/Penquins_Moonlit_Maze_PDF_eng.pdf",
        "https://media.kasperskycontenthub.com/wp-content/uploads/sites/43/2018/03/07180251/Penquins_Moonlit_Maze_PDF_eng.pdf"
    ],
    "report_names": [
        "Penquins_Moonlit_Maze_PDF_eng.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dfee8b2e-d6b9-4143-a0d9-ca39396dd3bf",
            "created_at": "2022-10-25T16:07:24.467088Z",
            "updated_at": "2025-03-27T02:02:10.241387Z",
            "deleted_at": null,
            "main_name": "Circles",
            "aliases": [],
            "source_name": "ETDA:Circles",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c3c864b3-fac9-4d56-8500-7c06c829fbf8",
            "created_at": "2023-01-06T13:46:39.071873Z",
            "updated_at": "2025-03-27T02:00:02.990045Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Storm-0216",
                "DEV-0216",
                "UNC2198",
                "Maze Team",
                "TWISTED SPIDER",
                "GOLD VILLAGE"
            ],
            "source_name": "MISPGALAXY:TA2101",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "33eef76c-a6fa-4855-a77e-9a1e92fe8474",
            "created_at": "2023-11-21T02:00:07.393519Z",
            "updated_at": "2025-03-27T02:00:03.250084Z",
            "deleted_at": null,
            "main_name": "Storm Cloud",
            "aliases": [],
            "source_name": "MISPGALAXY:Storm Cloud",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e9f85280-337c-4321-b872-0919f8ef64a6",
            "created_at": "2022-10-25T16:07:24.261761Z",
            "updated_at": "2025-03-27T02:02:10.153781Z",
            "deleted_at": null,
            "main_name": "TA2101",
            "aliases": [
                "Gold Village",
                "Maze Team",
                "TA2101",
                "Twisted Spider"
            ],
            "source_name": "ETDA:TA2101",
            "tools": [
                "7-Zip",
                "Agentemis",
                "BokBot",
                "Buran",
                "ChaCha",
                "Cobalt Strike",
                "CobaltStrike",
                "Egregor",
                "IceID",
                "IcedID",
                "Mimikatz",
                "PsExec",
                "SharpHound",
                "VegaLocker",
                "WinSCP",
                "cobeacon",
                "nmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08c8f238-1df5-4e75-b4d8-276ebead502d",
            "created_at": "2023-01-06T13:46:39.344081Z",
            "updated_at": "2025-03-27T02:00:03.056208Z",
            "deleted_at": null,
            "main_name": "Copy-Paste",
            "aliases": [],
            "source_name": "MISPGALAXY:Copy-Paste",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "19ac84cc-bb2d-4e0c-ace0-5a7659d89ac7",
            "created_at": "2022-10-25T16:07:23.422755Z",
            "updated_at": "2025-03-27T02:02:09.791931Z",
            "deleted_at": null,
            "main_name": "Bronze Highland",
            "aliases": [
                "Daggerfly",
                "Evasive Panda",
                "Storm Cloud",
                "StormBamboo",
                "TAG-102",
                "TAG-112"
            ],
            "source_name": "ETDA:Bronze Highland",
            "tools": [
                "Agentemis",
                "CDDS",
                "CloudScout",
                "Cobalt Strike",
                "CobaltStrike",
                "DazzleSpy",
                "KsRemote",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MacMa",
                "Macma",
                "MgBot",
                "Mgmbot",
                "NetMM",
                "Nightdoor",
                "POCOSTICK",
                "RELOADEXT",
                "Suzafk",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "578f8e62-2bb4-4ce4-a8b7-6c868fa29724",
            "created_at": "2022-10-25T16:07:24.344358Z",
            "updated_at": "2025-03-27T02:02:10.182282Z",
            "deleted_at": null,
            "main_name": "Tropic Trooper",
            "aliases": [
                "APT 23",
                "Bronze Hobart",
                "Earth Centaur",
                "KeyBoy",
                "Operation Tropic Trooper",
                "Pirate Panda",
                "Tropic Trooper"
            ],
            "source_name": "ETDA:Tropic Trooper",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "ByPassGodzilla",
                "CHINACHOPPER",
                "CREDRIVER",
                "China Chopper",
                "Chymine",
                "Darkmoon",
                "Gen:Trojan.Heur.PT",
                "KeyBoy",
                "Neo-reGeorg",
                "PCShare",
                "POISONPLUG.SHADOW",
                "Poison Ivy",
                "RoyalRoad",
                "SPIVY",
                "ShadowPad Winnti",
                "SinoChopper",
                "Swor",
                "TSSL",
                "USBferry",
                "W32/Seeav",
                "Winsloader",
                "XShellGhost",
                "Yahoyah",
                "fscan",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1491233592,
    "ts_modification_date": 1491243457,
    "files": {
        "pdf": "https://archive.orkl.eu/fa52103ec752e0b604a908f72f6d68376f982c6a.pdf",
        "text": "https://archive.orkl.eu/fa52103ec752e0b604a908f72f6d68376f982c6a.txt",
        "img": "https://archive.orkl.eu/fa52103ec752e0b604a908f72f6d68376f982c6a.jpg"
    }
}