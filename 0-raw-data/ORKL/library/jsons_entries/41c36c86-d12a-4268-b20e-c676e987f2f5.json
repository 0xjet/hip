{
    "id": "41c36c86-d12a-4268-b20e-c676e987f2f5",
    "created_at": "2023-01-12T15:09:06.819931Z",
    "updated_at": "2025-03-27T02:15:59.322796Z",
    "deleted_at": null,
    "sha1_hash": "b9dccc4737c7501ef0f43d7c9ce9698b2e8d87cc",
    "title": "2020-06-30 - Electric Company Ransomware Attack Calls for $14 Million in Ransom",
    "authors": "",
    "file_creation_date": "2022-05-28T22:05:34Z",
    "file_modification_date": "2022-05-28T22:05:34Z",
    "file_size": 2830672,
    "plain_text": "# Electric Company Ransomware Attack\n\n**[appgate.com/blog/electric-company-ransomware-attack-calls-for-14-million-in-ransom](https://www.appgate.com/blog/electric-company-ransomware-attack-calls-for-14-million-in-ransom)**\n\n**Light S.A., a Brazilian based electrical energy company was recently affected by**\n**ransomware where the cybercriminals demanded a payment of 14 million U.S. dollars.**\n\n[The company issued comments to a local newspaper confirming the attack, however, technical](https://vejario.abril.com.br/cidade/hackers-invadem-light-resgate/)\ndetails were not disclosed by the company.\n\n\n-----\n\n_Twitter Post from Light SA Official Account, Confirming the Attack_\n\nOur malware analysis team had access to the binary that was likely used in the attack and we\nwere able to confirm that the sample is from a family known as Sodinokibi (aka REvil). Althought\nwe can't confirm that this was the exact same file used in the attack, the evidence points to being\nconnected to the Light SA breach, such as the ransom price, for example. The sample was\nautomatically collected by AppGate Labs on June 17, 2020 through our live hunting process, and\nas the binary was sent to a public sandbox, this suggests someone from the company submitted\nthat file attempting to understand how it works.\n\n_Machine Infected with Sodinokibi Sample._\n\nThe sample is packed and works the same as other binaries that we have already identified from\nthis family, and once unpacked, we were able to decrypt its configuration and access relevant data\nabout the threat, such as the actor / campaign ID, and the URL in which the victim must access to\nget instructions.\n\n_Ransomware Attack Asking 14,000,000 USD._\n\nAccording to the page that is hosted in the deep web, the ransom amount must be paid using the\n\n\n-----\n\nvirtual currency Monero, and prior to June 19, the total was 106,870.19 XMR, which is equivalent\nto 7 million USD. However, since the deadline has passed, the price has doubled to 14 million US\ndollars. The whole attack looks very professional, the web page even includes a chat support,\nwhere the victim can speak directly with the attacker. Sodinokibi works as a RaaS (Ransomware\nas a Service) model, and the group behind the operation seems to be affiliated to \"Pinchy Spider\",\n[which is the same group behind GandCrab ransomware[1].](https://www.appgate.com/blog/electric-company-ransomware-attack-calls-for-14-million-in-ransom#_ftn1)\n\nDeep Web Panel\n\nWith the URL collected from the binary, we were able to access the webpage (hosted on deep\nweb) and confirm details about the attack. First thing of notice is the ransom price, which is\nextremely high and likely due to the affected company belonging to an important sector.\n\n_Ransomware Asking for 7,000,000 USD Before Deadline._\n\nThere is an ‘About Us’ which contains a small overview about the Sodinokibi family.\n\n\n-----\n\n_Sodinokibi Description According to the Web Page._\n\nAlso, it provides an online chat support, where the victim can interact with the attackers. In the\nimages below, we can see that someone reached out to the attacker. We decided to censor the\nimages to reduce the exposure of the person involved.\n\n\n-----\n\n_Sodinokibi Chat Support._\n\nAt the end of the chat we can see that the attacker sends a file that is supposedly confidential,\nproving to the victim that the data can be decrypted and also suggesting that file was probably\nstolen from the company's network.\n\n_Decrypted “_Confidencial.xlsx” File Sent by Attacker._\n\nTechnical Details\n\nThe main file is packed and it uses two shellcodes streams for unpacking and execution process.\n[First, it allocates a memory space using “LocalAlloc[2]” API, writes an encrypted shellcode to it,](https://www.appgate.com/blog/electric-company-ransomware-attack-calls-for-14-million-in-ransom#_ftn1)\nand transfers execution once decrypted.\n\n\n-----\n\n_Sodinokibi Decrypting First Shellcode._\n\nThis shellcode unpacks Sodinokibi along with a second shellcode, which will eventually load the\nfinal binary to memory.\n\n_Second Shellcode Along with Unpacked Sodinokibi._\n\nFinally, the shellcode injects the unpacked Sodinokibi binary into the same process space, by\nwiping the original PE file from memory and writing the new PE.\n\n_Sodinokibi Self-Injection._\n\n\n-----\n\nThe binary is highly configurable, the setting is encrypted with RC4 and it s usually stored in a\nrandomly named section, and in this case the section name is “.cfg”.\n\n_Sodinokibi Encrypted Configuration Stored on PE Section._\n\nUpon execution, it will decrypt the content of this section into an allocated memory space.\n\n\n-----\n\n_Sodinokibi Decrypting its Configuration._\n\nThe decrypted configuration is presented in a JSON format and contains several options used by\nthe Malware.\n\nKey Type Description\n\ndbg Boolean If true, ignores keyboard layout check\n\ndmn List of strings List of domains for communication (C2 servers)\n\nexp Boolean If true, enables privilege escalation using CVE-2018-8453 as exploit\n\nfast Boolean If true, it encrypts just a part of the file\n\nimg String Message displayed on desktop background\n\nnbody String Contents of the “readme” file (base64 encoded)\n\nnet Boolean If true, sends POST requests to the C2 servers\n\nnname String Name of “readme” file\n\npid String Actor ID\n\npk String Public encryption key (base64 encoded)\n\nprc List of strings Process to terminate\n\n\n-----\n\nsub String Campaign ID\n\nwfld List of strings List of folders to wipe\n\nwht Dictionary Contains information about whitelist (to skip encryption)\n\nwht.ext List of strings Whitelisted extensions\n\nwht.fld List of strings Whitelisted folders\n\nwht.fls List of strings Whitelisted files\n\nwipe Boolean If true, wipes the folders specified in “wfld”\n\nAn interesting capability not utilized by this specific sample is if “exp” is “true”, it tries to escalate\n[privileges by exploiting a vulnerability in “win32k.sys” (CVE-2018-8453[3]) with both 32-bit and 64-](https://www.appgate.com/blog/electric-company-ransomware-attack-calls-for-14-million-in-ransom#_ftn1)\n[bit versions of the exploit, using a technique known as “Heaven’s Gate[4]” to execute 64 bit code](https://www.appgate.com/blog/electric-company-ransomware-attack-calls-for-14-million-in-ransom#_ftn1)\nin a 32 bit process, located in the “.rdata” section of the PE file.\n\n_Code Decrypting and Executing the Shellcode._\n\nAlso, if the “dbg” option is set to “false”, the malware will check the UI language and the keyboard\nlayout of the infected machine.\n\n\n-----\n\n_Keyboard Layout Verification._\n\n[Above, we can see that this Ransomware has a whitelist based on location, if the return value[5]](https://www.appgate.com/blog/electric-company-ransomware-attack-calls-for-14-million-in-ransom#_ftn1)\nmatches any value of the list, it will not encrypt files in the machine.\n\nFurthermore, it uses PowerShell to delete Windows shadow copies.\n\n_Sodinokibi Deleting Windows Shadow Copies._\n\nOnce encrypting all the files, it changes the background with the following image:\n\n\n-----\n\n_Sodinokibi Background._\n\nLastly, it appends a ransom note to every folder where encrypted files can be found.\n\n_Sodinokibi Ransom Note._\n\nUnfortunately, there is no global decryptor for the family, which means that the attacker's private\nkey is required to decrypt the files.\n\nDuring the period of the attack, we noticed that the company’s website was offline, presenting an\nerror message related to the database, which could be related to the attack.\n\n\n-----\n\n_Light WebSite Offline During Ransomware Attack._\n\nIOCs\n\n**SHA1:**\n\nf09e5e72b433d11a32efe2e5d63db0bc7b8def59\n\n**SHA256:**\n\n140f831ddd180861481c9531aa6859c56503e77d29d00439c1e71c5b93e01e1a\n\n**SSDEEP:**\n\n3072:oCc99moUMXv84IHesgkSx+oN/7KzTKDyOX6wKamrJPlM8dj09br:oCc9wHRtg9xkNq6wK7dq40\n\n**Mutex:**\n\nGlobal\\57E6EA0F-4648-EF95-9F98-C3221B4D31F9\n\n**Registry Keys:**\n\nHKLM\\SOFTWARE\\Facebook_Assistant\\s17\n\nHKLM\\SOFTWARE\\Facebook_Assistant\\JYhB\n\nHKLM\\SOFTWARE\\Facebook_Assistant\\jH5dJ\n\nHKLM\\SOFTWARE\\Facebook_Assistant\\nsWSeU\n\nHKLM\\SOFTWARE\\Facebook_Assistant\\CSGtvzp\n\nHKLM\\SOFTWARE\\Facebook_Assistant\\cDQ1QZoS\n\n**Sodinokibi Actor ID**\n\n$2a$10$D/hOr8pZfTXyeVodyREcseBOlXf2dcLmqmQJTa4y2uSfGkhEZXq62\n\n**Sodinokibi Campaign ID**\n\n4430\n\n**Public Encryption Key (base64 encoded)**\n\n\n-----\n\n5OflM/v+EILgBXm+0q5qAVIHbpAd3zVkD2aFdBKJe0g=\n\n**C2 Servers:**\n\nPlease find a list here:\n\n[https://pastebin.com/nf0i13zc](https://pastebin.com/nf0i13zc)\n\n_[1]_ _[https://malpedia.caad.fkie.fra...](https://malpedia.caad.fkie.fraunhofer.de/actor/pinchy_spider)_\n\n_[2]_ _[https://docs.microsoft.com/en-...](https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-localalloc)_\n\n_[3]_ _[https://www.cvedetails.com/cve...](https://www.cvedetails.com/cve/CVE-2018-8453)_\n\n_[4]_ _[http://www.alex-ionescu.com/?p...](http://www.alex-ionescu.com/?p=300)_\n\n_[5]_ _[https://docs.microsoft.com/en-...](https://docs.microsoft.com/en-us/windows/win32/intl/language-identifier-constants-and-strings)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-30 - Electric Company Ransomware Attack Calls for $14 Million in Ransom.pdf"
    ],
    "report_names": [
        "2020-06-30 - Electric Company Ransomware Attack Calls for $14 Million in Ransom.pdf"
    ],
    "threat_actors": [
        {
            "id": "8610b0d9-a6af-4010-818f-28671efc5d5e",
            "created_at": "2023-01-06T13:46:38.897477Z",
            "updated_at": "2025-03-27T02:00:02.945669Z",
            "deleted_at": null,
            "main_name": "PINCHY SPIDER",
            "aliases": [],
            "source_name": "MISPGALAXY:PINCHY SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c84bbd2e-003d-4c43-8a46-d777455db2c7",
            "created_at": "2022-10-25T15:50:23.701006Z",
            "updated_at": "2025-03-27T02:00:55.527357Z",
            "deleted_at": null,
            "main_name": "GOLD SOUTHFIELD",
            "aliases": [
                "GOLD SOUTHFIELD",
                "Pinchy Spider"
            ],
            "source_name": "MITRE:GOLD SOUTHFIELD",
            "tools": [
                "ConnectWise",
                "REvil"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9df68733-9bcd-43b1-88f1-24b110fa3d56",
            "created_at": "2022-10-25T16:07:24.051993Z",
            "updated_at": "2025-03-27T02:02:10.091553Z",
            "deleted_at": null,
            "main_name": "Pinchy Spider",
            "aliases": [
                "Gold Garden",
                "Gold Southfield",
                "Pinchy Spider"
            ],
            "source_name": "ETDA:Pinchy Spider",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "GandCrab",
                "GrandCrab",
                "REvil",
                "Sodin",
                "Sodinokibi",
                "VIDAR",
                "Vidar Stealer",
                "certutil",
                "certutil.exe",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536146,
    "ts_updated_at": 1743041759,
    "ts_creation_date": 1653775534,
    "ts_modification_date": 1653775534,
    "files": {
        "pdf": "https://archive.orkl.eu/b9dccc4737c7501ef0f43d7c9ce9698b2e8d87cc.pdf",
        "text": "https://archive.orkl.eu/b9dccc4737c7501ef0f43d7c9ce9698b2e8d87cc.txt",
        "img": "https://archive.orkl.eu/b9dccc4737c7501ef0f43d7c9ce9698b2e8d87cc.jpg"
    }
}