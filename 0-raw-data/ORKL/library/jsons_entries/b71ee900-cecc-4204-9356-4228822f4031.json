{
    "id": "b71ee900-cecc-4204-9356-4228822f4031",
    "created_at": "2023-02-21T02:07:01.91761Z",
    "updated_at": "2025-03-27T02:16:39.964023Z",
    "deleted_at": null,
    "sha1_hash": "27347da34823c3285c11f2c90185603d923f723b",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-10-11T16:33:27Z",
    "file_modification_date": "2022-10-11T16:33:34Z",
    "file_size": 1091653,
    "plain_text": "## GraceWrapper: The new TA505’s post-exploitation enabler\n# 2022\n\n\n-----\n\n##### 1. Introduction\b���������������������������������������������������������������������������������3\n\n 2. MirrorBlast Campaign Recap\b�����������������������������������������������������3\n\n 3. Technical Analysis\b�����������������������������������������������������������������������5\n###### 3.1. Anti-Analysis\b��������������������������������������������������������������������������������������������������5 3.1.1. Packer\b����������������������������������������������������������������������������������������������������������������������������������������������5\n\n 3.2. Obfuscation\b���������������������������������������������������������������������������������������������������6 3.2.1. Random Sleeps\b����������������������������������������������������������������������������������������������������������������������������10 3.2.2. Heavy Use of Low-Level Windows Functions\b�����������������������������������������������������������������������11\n\n 3.3. Command Line Arguments\b����������������������������������������������������������������������12 3.4. Injection Mechanisms\b�������������������������������������������������������������������������������12 3.4.1. Leveraging APC queues and ROP\b�������������������������������������������������������������������������������������������12 3.4.2. Fallback Injection Routine\b���������������������������������������������������������������������������������������������������������18\n\n 3.5. Configuration\b����������������������������������������������������������������������������������������������19 3.6. Payload Execution\b��������������������������������������������������������������������������������������24 3.6.1. Building the Payload\b�������������������������������������������������������������������������������������������������������������������24 3.6.2. Unprivileged Execution\b��������������������������������������������������������������������������������������������������������������26 3.6.3. Injection to Remote Processes\b������������������������������������������������������������������������������������������������26\n\n##### 4. Conclusions\b��������������������������������������������������������������������������������28\n\n 5. YARA\b��������������������������������������������������������������������������������������������29\n\n 6. References\b����������������������������������������������������������������������������������29\n\n 7. Appendix\b�������������������������������������������������������������������������������������31\n###### 7.1. Appendix A: Original Import Address Table\b����������������������������������������31 7.2. Appendix B: Original Strings\b��������������������������������������������������������������������34\n\n© 2022 Leap In Value S.L. & Outpost24 All rights reserved.\n\nThe information provided in this document is the property of Blueliv, and any modification or use of all or part of the content of this document without\nthe express written consent of Blueliv is strictly prohibited. Failure to reply to a request for consent shall in no case be understood as tacit authorization\nfor the use thereof.\n\nBl li ® i i t d t d k f © 2021 L I V l S L & O t t24 All i ht d All th b d d t t d k\n\n\n-----\n\n### 1. Introduction\n\nTA505 is an infamous, financially motivated threat actor group believed to have been operating for\nalmost a decade. Operating the Necurs botnet, the group started its core business by selling access\nto compromised networks to other malware operators, through which it was able to operate some of\nthe most notorious spam campaigns in recent memory.\n\nIn addition to this, it is believed that TA505, or a subset of the group, started conducting ransomware\noperations. This was likely motivated by the estimated $25 million income that the nefarious group\nwas generating back in 2016 [1]. This signaled the group’s first steps in the ransomware game as\n[it teamed up with none other than the Locky gang, one of the most successful ransomware-as-a-](https://threatpost.com/ransomware-gang-arrested-locky-hospitals/155842/)\nservice (RaaS) providers to date [2].\n\nSince then, a vast number of tools have been claimed to belong to the group’s arsenal, and the attacks\nattributed to them have demonstrated a diverse set of tactics, techniques and procedures (TTPs).\nThus, attributing them to a specific attack has always been a challenging task.\n\n[Today it is believed that the group is responsible for operating the Clop ransomware after compromising](https://www.bleepingcomputer.com/news/security/operation-cyclone-deals-blow-to-clop-ransomware-operation/)\ncorporate networks by using a variety of remote administration malware such as SDBbot, FlawedAmmy\nand FlawedGrace, which were downloaded via Get2, Gelup or Mirrorblast.\n\n[In this research, Outpost24’s Blueliv Labs shares findings from the analysis of the Mirrorblast spam](https://outpost24.com/products/cyber-threat-intelligence)\ncampaign, the last known spam operation attributed to TA505. Within the convoluted sequence of\nmalware pieces involved in the attack, one is believed to be an updated version of the FlawedGrace\nRAT, due to the evident relations in its code and behaviour similarities.\n\nHowever, a thorough inspection reveals a very interesting component belonging to the Grace family,\nwhose main purpose appears to be hindering the detection of the actual RAT and its modules while\nfacilitating the deployment of post-exploitation tools in the infected machine. The rest of this report\nshows the technical details of this new component that we have named GraceWrapper.\n\n### 2. MirrorBlast Campaign Recap\n\n[Back in September 2021, Proofpoint detected a new malware, dubbed MirrorBlast, used in large spam](https://www.scmagazine.com/brief/phishing/new-mirrorblast-phishing-campaign-targets-financial-entities)\ncampaigns that replicated the modus operandi of previous TA505 attacks. The last member of the\n[infection chain was none other than a fresh version of FlawedGrace, which was already identified to](https://threatpost.com/ta505-retooled-flawedgrace-rat/175559/)\nhave a close bond with the group. [3]\n\nLike many other spam campaigns, the MirrorBlast attacks started with a phishing email containing a\nlink to a malicious XLS document that, upon opening and allowing its macros to run, would trigger the\ndownload and execution of the next stage of malware. The first downloaded executable would be an\nMSI containing a script written in the KiXtar scripting language that would download the MirrorBlast\n\n\n-----\n\nmalware.\n\nMirrorBlast is a Rebol script, contained within another MSI file, which would generate a unique\nidentifier for the victim’s machine and access its command and control for the next stage of malware,\nthe ReflectiveGnome loader. That loader would be responsible for downloading FlawedGrace and\nexecuting it within its own process memory.\n\nSend PC/User/Domain names and process list\n\nKXL\nCNC Receive Next CnC\n1\nKiXtar Loader\n\nGet next stage malware\n\nKXL\nCNC\n2\n\nSend PC/User/Domain names, OS Version and arch\n\nReceive unique identifier\n\nMB MirrorBlast\nCnC\n\nSend uuid until next stage / Rebol script ready\n\nReflectiveGnome\n\nRun payload in memory\n\nRG Download Shellcode\nCnC\n\nGraceWrapper\n\nDuring the analysis of the MirrorBlast infection chain, we identified notable differences between\nReflectiveGnome’s payload and previous FlawedGrace RAT samples Naturally we decided to take a\n\n\nSend PC/User/Domain names and process list\n\nKXL\nCNC Receive Next CnC\n1\nKiXtar Loader\n\nGet next stage malware\n\nKXL\nCNC\n2\n\nSend PC/User/Domain names, OS Version and arch\n\nReceive unique identifier\n\nMB MirrorBlast\nCnC\n\nSend uuid until next stage / Rebol script ready\n\nReflectiveGnome\n\nRun payload in memory\n\nRG Download Shellcode\nCnC\n\nGraceWrapper\n\n\n-----\n\ncloser look at the sample.\n\n### 3. Technical Analysis\n\n###### 3.1. Anti-Analysis\n\n 3.1.1. Packer\n\nEven after that many stages, ReflectiveGnome’s payload is still packed. Again, this packer is a small\npiece of code with the sole purpose of allocating, decoding and executing its payload. An interesting\ncharacteristic of this sample is that it tries to impersonate ATMLIB.DLL, a library belonging to Adobe\nType Manager, which is present on many workplace computers.\n\n_Figure 1: ATM related metadata._\n\nThe malicious library does not contain any export, as it is designed to be executed straight from\nthe memory of a (down)loader process. Additionally, it does not specify any import as it employs a\ndynamic API resolution function to obtain the addresses of the Windows functions needed.\n\nBy only using three low-level API functions (i.e., LdrGetProcedureAddress, ZwAllocateVirtualMemory\nand ZwFreeVirtualMemory) and a simple decoding function, the packer loads the payload to its own\nmemory and executes it by a call to its entry point.\n\n\n-----\n\n_Figure 2: Packer’s decoding routine._\n\n_Figure 3: Main packer’s function after some renaming._\n\n###### 3.2. Obfuscation\n\nAfter unpacking, a first look at the obtained sample with a disassembler reveals that it contains\ndifferent obfuscation mechanisms designed to complicate the malware analysis tasks. The malware\nhas been filled with plenty of junk code in a bid to discourage reverse engineers from analyzing the\n\n\n-----\n\nsample.\n\n_Figure 4: Main function of the obtained sample showing many lines of junk code._\n\n_Figure 5: Main function after deobfuscation jobs._\n\nIn order to properly analyze the sample, this junk code needs to be removed Once the code has been\n\n\n-----\n\nrecovered, it is possible to find two other common obfuscation mechanisms present in most modern\nmalware: string encryption and dynamic Windows API resolutions. Combined, these mechanisms\nprevent analysts from obtaining an approximate picture of a program’s capabilities at first sight.\n\nThe string encryption function consists of a xor loop that takes three parameters: the bytes of the\nencrypted string, a hardcoded encryption key contained in the sample and a single byte passed as an\nargument to the function. After replicating its code, it is possible to recover all the original strings from\nthe binary. As an extra defense against memory analysis techniques, the strings are decrypted only\nwhen they are needed and erased from the memory once they have been used.\n\n_Figure 6: String decryption function._\n\nWithin the decrypted strings, the original import address table (IAT) function names are found. As a\nresult, this process offers a good first picture of the capabilities of this software. Both the original IAT\nand the plain text strings can be found in the appendix of this document.\n\nAt this point of the analysis, it is obvious that the sample does not correspond to a FlawedGrace\nbinary, as it lacks some of its capabilities. For example, it does not have any means to communicate\nwith its command and control.\n\nThe dynamic Windows API resolution function is quite simple; it will receive a number as an argument\nand translate it to its corresponding function address.\n\n\n-----\n\n_Figure 7: Dynamic Windows API resolution code._\n\nCombining all the knowledge exposed in this section, it is possible to alter the disassembly of the\nbinary to further simplify its analysis.\n\n\n-----\n\n_Figure 8: Start of main’s thread function code before deobfuscation._\n\n_Figure 9: Cleaned code._\n\n###### 3.2.1. Random Sleeps\n\nGraceWrapper’s developers included a function to put the malware to sleep before executing some\n\n\n-----\n\nimportant parts of the code, either to add extra noise to behaviour logs or to confuse malware detection\nsoftware. The function will randomly call Sleep, or create a thread that randomly chooses between\nSleep or WaitForSingleObject for its purpose.\n\n_Figure 10: Randomly sleeping or creating a new thread._\n\n_Figure 11: Randomly choosing between Sleep or WaitForSingleObject._\n\nAs mentioned above, this function is called before executing some crucial code within the malware,\nsuch as:\n\n  - Creating the main execution thread.\n\n  - First call within the main thread.\n\n  - After config initialization.\n\n  - Various times within the main injection routine.\n\n  - During the payload loading thread.\n\nThe developers also added a way to prevent these periods of sleep from being executed by employing\nthe command line argument –nm.\n\n###### 3.2.2. Heavy Use of Low-Level Windows Functions\n\nAfter obtaining the original IAT of the sample, it is possible to observe how GraceWrapper’s developers\nmake frequent use of low-level (Rtl*, Nt*, Zw*) Windows functions. This is a well-known technique to\nevade analysis tooling that monitors only the higher-level libraries while also complicating manual\n\n\n-----\n\n###### 3.3. Command Line Arguments\n\nGraceWrapper’s behaviour can be manipulated by the command line parameters listed below:\n\n  - -cs [dword]: allows setting up a different value for encoding the identifiers of the config.\n\n  - -nm: prevents the random sleep function from executing if present. Also causes the self-injection\nroutine not to execute.\n\n  - -em: after injecting itself into another process, if it has not been run from powershell.exe or\nrundll32.exe and this argument is not present, the program exits by calling ExitThread instead of\nRtlExitUserProcess. It is likely that more functionalities will be added.\n\n  - -ss [s]: sets the program to sleep for s seconds before executing the self-injection routine.\n\n  - -sf [file path]: creates the specified empty file.\n\n  - -wf [file path]: wipes the specified file.\n\n‘\n\n_Figure 12: -ss command line arg being checked._\n\n###### 3.4. Injection Mechanisms\n\n 3.4.1. Leveraging APC queues and ROP\n\nGraceWrapper’s main purpose is to make its payload as evasive as possible, and the painstaking\nimplementation of its main injection routine is unmistakable evidence of that. This software combines\nReturn-Oriented Programming (ROP) and heavy use of Windows’s Asynchronous Procedure Calls\n(APC) to make its execution unnoticed.\n\nROP [4] is a well-known software exploitation technique which consists of searching for small code\nfragments, referred to as gadgets, within the code section of a program. After getting all gadgets\nneeded for the exploitation, the stack of the program is manipulated so that the gadgets will be\nexecuted in a specific order, which is known as the ROP chain. This technique allows bypassing\noperating systems to implement ‘write or execute’ policies which prevent memory regions from being\nwritable and executable at the same time, as the malicious code is already present in an executable\nmemory area.\n\nTo begin its injection routine, GraceWrapper builds an array of ROP gadgets present in NTDLL.DLL.\nh l b d d h l l d d h\n\n\n‘\n\n\n-----\n\naddress for each system startup, making it the perfect target for building ROP chains that can be\nexecuted in any remote process.\n\nTo further complicate things, instead of searching for the gadgets at the code section of the currently\nloaded NTDLL, which would cause a huge amount of memory accesses in its address space that\ncould potentially trigger some alarms, GraceWrapper loads a copy of the library from the filesystem.\n\n_Figure 13: Loading NTDLL from the filesystem to search the ROP gadgets._\n\nAfter reading NTDLL’s contents, the malware walks its .text section to find the following gadgets:\n```\n • pop esp; ret\n • pop eax; ret\n • pop ecx; ret\n • pop ebx; ret\n • pop esi; ret\n • pop r8; ret\n • add rsp 0x8; ret\n • add rsp 0x28; ret\n • mov qw [ecx], rax; ret\n • add rsp, 0x50; pop rbx; ret\n • mov rdx, rbx; call rax\n • mov r9, rsi; call rax\n • pop r9; pop r8; pop rdx; pop rcx; jmp rax\n • pop rdx; pop rcx; pop r8; pop r9; pop r10; pop r11; ret\n • pop rdx; pop rcx; pop r8; pop r9; ret\n\n```\nOnce the offsets of the gadgets have been found, GraceWrapper translates them into their absolute\n\n\n-----\n\n_Figure 14: ROP Gadgets being built before searching them._\n\nFollowing the collection of ROP gadgets, GraceWrapper will programmatically pick a thread of the\nhost process using APC tasks [8]. Here, the code chooses between explorer.exe or lsass.exe, electing\nthe former when executed under Administrator privileges. After enumerating all target threads, the\nsame number of events will be created by calling CreateEventW as many times as necessary. The\npurpose of these events is to create an event-thread relationship by duplicating each handle into a\nsingle thread by means of NtDuplicateObject.\n\nOnce every target’s thread has an event handle, NtQueueApcThreadEx is used to submit a call to\nSetEvent for each thread’s APC queue that will signal its corresponding event handle. By means of\nWaitForMultipleObjects, GraceWrapper receives the first event signalled and keeps the corresponding\nthread handle to use for the injection.\n\n\n-----\n\n_Figure 15: Picking the first thread executing its APC queue as the victim of the injection._\n\nAfter deciding its victim thread, the loader proceeds to build the payload that will trigger the execution.\nOn one side, a named image mapping is created and filled with a small code stub, embedded in\nGraceWrapper’s executable, which is followed by the contents of the injected binary. The sole purpose\nof this stub is to calculate and jump at the address of the binary’s original entry point.\n\n\n-----\n\n_Figure 17: Named mapping creation, filled with the payload to be executed._\n\nAt this stage, the ROP chain is finally built. This is due to a function that combines the array of ROP\ngadgets, the addresses of OpenFileMappingW, NtMapViewOfSection and RtlCreateUserThread and\nthe CONTEXT structure of the elected thread. The ROP chain’s code will open the previously described\nfile mapping, load its contents and create a new thread within the target process to execute the\nmalware.\n\nGraceWrapper’s developers took exceptional care in developing this routine, as causing a thread to\nmalfunction within the Explorer’s process might cause the entire system to freeze, followed by an\nExplorer’s restart, which will terminate the malware’s execution.\n\n\n-----\n\n_Figure 18: ROP chain_\n\nAfter all the important pieces have been gathered, GraceWrapper will proceed to replace the contents\nof the targeted thread stack with those from the ROP chain buffer. It employs APC tasks to accomplish\nthis objective.\n\nBy issuing calls per byte to the memset function using ZwQueueApcThreadEx, GraceWrapper\noverrides the stack of the host thread with the ROP chain to finally call NtResumeThread, finishing\nwith this twisted injection routine.\n\n\n-----\n\n_Figure 19: Overriding the stack of the host thread with the ROP chain, using one APC task per byte._\n\nThis routine is employed firstly to inject the whole GraceWrapper binary and restart its execution in a\nsafer environment (which can be avoided if executed with –nm, or if the process name is TestStart.\nexe or TestService.exe), and secondly to inject the embedded FlawedGrace binary into winlogon.exe\nand other processes, if the malware is being run with Administrator privileges.\n\nThe use of the APC functions to execute evasive payloads is a well know technique employed by\nsome red teaming tools. However, it is not yet popular in modern malware; just a few families or\nactors, such as IcedID or FIN8, have been reported to actively use this Windows feature during their\nmalicious activities [5]. With this piece of software, TA505 goes a step further by combining APC\nprocess injection together with ROP in an intensive effort to prevent the detection of new FlawedGrace\nsamples.\n\n###### 3.4.2. Fallback Injection Routine\n\nIn case the main injection routine fails or if the operating system version is not new enough to make\nuse of APC, GraceWrapper’s developers created a more conservative mechanism of injection. By\nmeans of NtAllocateVirtualMemory, NtWriteVirtualMemory and RtlCreateUserThread, the remote\nprocess gets the payload written in its memory, and a new thread is created to execute the malware.\n\nThis function will also check if the process is running under the Windows on Windows subsystem\n(WoW), which allows running 32-bit applications on 64-bit systems in order to perform the good old\nHeaven’s Gate technique, which adds the capability to inject a 64-bit payload from a 32-bit version of\nthis loader.\n\n\n-----\n\n_Figure 20: Heaven’s Gate code to switch contexts within GraceWrapper’s .rdata section._\n\n###### 3.5. Configuration\n\nDuring its first execution on a machine, GraceWrapper will obtain its configuration file from an\nembedded resource included in its binary. By means of LdrFindResource_U and LdrAccessResource,\nthe encrypted config file is read.\n\nThe original file is compressed using the LZMA algorithm and then encrypted with AES before being\nembedded in the binary. That process is reversed to access the plain contents of the configuration file.\n\n_Figure 21: Obtaining original config file._\n\n\n-----\n\n_Figure 22: Grace config file._\n\nThe resulting file is employed to instantiate a custom data collection. The implementation of this data\ncollection is accomplished by a complex and carefully thought out set of classes and plenty of data\nstructures, all belonging to FlawedGrace. Oversimplifying its inners, the Grace malware family organizes\nits config data as a set of named entries which contain data streams and/or other named entries in\na similar way to a traditional dictionary. The implementation also contains memory management\nfeatures and supports concurrency, allowing different instances or threads of the malware and its\nmodules to access and modify its data safely.\n\nThe configuration has many different named entries. It is remarkable that in previous FlawedGrace\nversions [6], the names were significative strings such as ‘port’ or ‘servers’, whereas in this\nGraceWrapper sample, just a few letters represent each entry. During the analysis of the wrapper’s\nsample, the following entry names have been identified:\n\n  - Sr: used to store if the current execution is running as Administrator.\n\n  - P1, p2: contain a binary to be used to hide FlawedGrace executable.\n\n  - L1, l2: contain the FlawedGrace executable.\n\n  - Hv: set to the hardcoded value of 1074. Unknown purpose.\n\n  - Hnu: if present, a PE will be extracted from h and executed in a new thread.\n\n  - H: the entry is created during GraceWrapper’s first execution, containing its own executable.\n\n\n-----\n\n  - Avt: set to a number that represents the vendor of the installed anti-virus, if any. The supported\nAV products/vendors are Windows Defender (2), Symantec (3), Norton (4), TrendMicro (5),\nBitdefender (6), Sophos (7). If no listed AV is detected, avt Is set to 1.\n\n  - Ni: this entry is assigned to a GUID generated by CoCreateGuid the first time the wrapper\nexecutes in a machine. It is also the parent entry for ‘mt’ and ‘mo’. The code shows that such\nGUID can be used to format different config entry names if provided with the wildcard character\n‘%’. For example, instead of having a ‘p1’ entry, the config could contain a ‘p1%’, that will be\nconverted to ‘p1[ni-GUID]’ before its usage. The specific use of this feature cannot be inferred\nfrom the analysis of a sample but, hypothetically, this could allow setting different configuration\nparameters for different running executions of the Grace family. The entries that support this\nkind of formatting are at least: p1, p2, hv, hnu, hfu, h and m.\n\n  - Mt: contains ‘se’ and ‘mo’ entries.\n\n  - Mo, se and huf purposes are unknown currently.\n\n  - H1: C&C IP.\n\nTo hide all the binaries embedded in the config file from memory analysis, the configuration is never\nallowed to be loaded in memory while it is not being used. The Grace malware family employs\nWindows’s file mapping objects to keep an encrypted copy of the serialized configuration that is\nloaded and decrypted on demand.\n\nThe name for the configuration file mapping is generated by combining data from the victim’s machine\nand data from GraceWrapper’s binary itself, a cautious approach to preventing third parties from\nbeing able to generate those artefacts for detection purposes. To further complicate the process, the\noperators of the malware can use the –cs command line argument to provide a different encoding\nkey that will replace the one embedded in the binary.\n\n\n-----\n\n_Figure 23: Using -cs to alter the result of the name generation algorithm._\n\nTo generate machine-bound strings, the Grace family retrieves the computer name and the volume’s\nserial number to construct a stream of 16 bytes. The first 8 bytes are the result of a xor operation\nbetween the encoding key and the volume’s serial number. Whereas the last bytes are produced\nby, again, a xor operation using the computer name, the volume’s serial number and the previously\ngenerated bytes. The resulting buffer is passed to a string formatting function to obtain the final name.\n\n_Figure 24: Name generation function._\n\nAfter obtaining the corresponding name, GraceWrapper will create the named mapping and assign a i\n\n\n-----\n\nor processes from manipulating the configuration while it is being used. If executed with Administrator\nprivileges, a global file mapping will be created, which means processes from other logon sessions\nwill have access to it.\n\nOnce the file mapping is created, it is filled with the config contents re-encrypted. GraceWrapper again\nuses AES for this, but instead of employing the hardcoded key used during decryption after obtaining\nit from the binary’s resources, it will instead generate a key bound to the infected machine by using\nthe function described above.\n\nTo store the changes made to the config, GraceWrapper stores an encrypted copy at the registry. To\ndo so, the malware opens the HKCU key, or HKLM if executed with enough privileges, and creates a\nsubkey under Software\\Classes\\CLSID\\{[CLSID]}. The CLSID is created using the same function that\ngenerates the encryption key and the config mapping name.\n\n_Figure 25: Config subkey generation._\n\nThis way, the data stored by the Grace family is masked as COM object data. The encrypted config\ncontents are split into blocks of 524288 bytes and stored in enumerated values that combine its index\nwith another generated CLSID. Additionally, the InprocServer32 subkey is created empty, most likely in\norder to further improve its impersonation of a COM object.\n\n_Figure 26: Encrypted conf stored_\n\n\n-----\n\n###### 3.6. Payload Execution\n\nOnce the wrapper has hidden its own execution within another process and its configuration is ready to\nfunction, it can execute its payload. Depending on the privileges of the current process, GraceWrapper\nwill allocate memory within its own process and execute FlawedGrace by creating a new thread or\nchoosing a remote process to inject its payload using the mechanisms previously exposed.\n\n###### 3.6.1. Building the Payload\n\nAnother additional defense against analysis included in this malware is the capability to hide the\noriginal FlawedGrace executable, or any other PE file, by encoding its contents and appending them\nto another embedded executable that will decode and run it upon its execution.\n\n_Figure 27: Grace contents within GraceWrapper’s configuration file._\n\nFirst, GraceWrapper will source the fields l1 and p1 or l2 and p2 for 32-bit or 64-bit executions from its\nconfig, respectively. After calculating their combined size, the same amount multiplied by five will be\nused to allocate that many bytes and fill them with random values.\n\nThen, the contents of the pX field (i.e., the packer executable) will be placed at the beginning of the\nrandomized memory area. Notably, the packer is the same one used to distribute GraceWrapper,\nwhich we described at the beginning of the analysis.\n\nBy parsing its headers, the last entry of its section table [7] is retrieved to modify the fields\nSizeOfVirtualData and SizeOfRawData to match the size it will have after appending the guest binary.\nThe SizeOfImage, as well as either SizeOfInitializedData, SizeOfUninitializedData or SizeOfCode, are\nused depending on the type of section, and PE optional header fields are patched accordingly.\n\nAfter patching pX’s header, lX contents are appended to it; the malware will encode its contents to\nhide the actual malware from memory analysis tools, but before that, it will crawl pX’s code to find a\npattern and replace it with lX’s start position.\n\n\n-----\n\n_Figure 28: Patching packer’s code with lX’s start position._\n\nGraceWrapper’s code contains three different encoding sequences depending on the exported name\nof the host binary, indicating that at least three different packer binaries exist. In any case, the first four\nbytes of the guest binary are patched with their own size.\n\nIf the pX PE doesn’t contain any library name, or if it matches ‘b.dll’, the fifth byte will be replaced by\na randomly generated value that will be combined in an XOR operation with a key embedded within\nGraceWrapper’s data sections.\n\n_Figure 29: Encoding function for binaries with no exports, ‘b.dll’ and other names different than ‘c.dll’_\n\nIf the exported library name matches ‘c.dll’, a 56 random bytes buffer will be generated, replacing\nthe bytes following the patched binary size, resulting in most of the DOS Header being overridden.\nAfterwards, the buffer is used in an XOR operation against the rest of the binary to hide its contents.\n\n\n-----\n\n_Figure 30: Encoding function used for ‘c.dll’_\n\nIf the exported name is other than the ones mentioned, the same process as with ‘b.dll’ is replicated,\nbut this time the single-byte key is a fixed value that is not patched into the memory of the binary.\n\nIn this sample, the ‘c.dll’ packer is used, which matches the one used to pack GraceWrapper itself.\n\n###### 3.6.2. Unprivileged Execution\n\nIf the current process does not have Administrator privileges, GraceWrapper will build the payload,\nallocate memory for each of the regions within its own process and call its entry point. At the state\nof development manifested by the analyzed sample, GraceWrapper would not support binaries that\nneed relocations or have an actual IAT.\n\n_Figure 31: Incomplete PE loader._\n\n###### 3.6.3. Injection to Remote Processes\n\nIf executed with enough privileges, GraceWrapper will target the winlogon.exe process to inject\nFlawedGrace by using the routine combining APC and ROP described within this report. It will also\nmake use of the function WTSEnumerateSessionsExW to get a list of the currently active user sessions\non the infected computer and attempt the infection of the corresponding explorer.exe instance of\nevery section\n\n\n-----\n\nThis course of action was likely designed to allow it to execute FlawedGrace and its modules under\ndifferent user sessions, which is a very valuable capability for post exploitation tasks.\n\n_Figure 32: Targeting other users’ explorer.exe to inject FlawedGrace in._\n\n###### Explorer.exe\n\n1. Injects itself\n\n###### GraceWrapper GraceWrapper\n\n2. Load and run\n\nGrace\n\n_Figure 33: Unprivileged execution._\n\n\n###### Explorer.exe\n\n1. Injects itself\n\n###### GraceWrapper GraceWrapper\n\n2. Load and run\n\nGrace\n\n\n-----\n\nLSASS WINLOGON\n\nGraceWrapper GraceWrapper Grace\n\nUser 1 EXPLORER\n\nGrace\n\nUser 2 EXPLORER\n\nGrace\n\nUser N EXPLORER\n\nGrace\n\n\n_Figure 34: Privileged execution_\n\n### 4. Conclusions\n\nWe know that during the MirrorBlast campaign, TA505 deployed a fully refurbished toolkit. Employing\na set of easily replaceable new downloaders as intermediate links of the infection chain, the group\nwas able to bypass detection mechanisms while disguising the attribution of the attacks.\n\nNot content with stopping there, TA505 deployed an evolved multi-component Grace version. The\ncharacteristics and features included in GraceWrapper show that the developers of this malware\nfamily are taking a step forward to protect and hide their tools from both analysts and automatic\ndetection tools. In addition, by compromising the LSASS, WINLOGON and all EXPLORER process\ninstances, the Grace family has positioned itself as a strong enabler for post-exploitation tasks.\n\n\n-----\n\nDue to the appearance of testing and death code within the sample, we strongly believe the Grace\nfamily was under active development during the MirrorBlast campaign, and it is likely that newer\nversions of the malware exist at this moment.\n\nAt Outpost24 Kraken Labs, we consider the monitoring of the evolution of this sophisticated family a\ncrucial task if we are to better understand the activities of TA505 and its allies.\n\n### 5. YARA\n```\n rule atmlib_packer\n {\n   meta:\n     description = “Rule to detect the packer used with the Grace family during MirrorBlast campaign.”\n     author = “David Catalán at Outpost24 Kraken Labs.”\n     date = “2022-08-1”\n   strings:\n     $c1 = {48 B8 00 60 00 00 00 00 00 00 C3}\n     $c2 = {C6 44 24 59 4D C6 44 24 5A 65 C6 44 24 5B 6D C6 44 24 5C 6F C6 44 24 5D 72 C6 44 24 5E 79}\n   condition:\n     all of them\n }\n\n```\nrule flawedgrace64_2021\n```\n {\n   meta:\n     description = “Rule to detect FlawedGrace”\n     author = “David Catalán at Outpost24 Kraken Labs”\n   strings:\n     $o1 = {B8 ?? ?? 00 00 48 6B C0 ?? 48 8B 0D ?? ?? ?? ?? 0F BE 04 01 83 F8 ?? 75 ?? B8 ?? ?? 00 00 48\n 6B C0 ?? 48 8B 0D ?? ?? ?? ?? C6 04 01 ??}\n     $o2 = {0F B7 05 ?? ?? ?? ?? 69 C0 ?? ?? ?? ?? 66 89 05 ?? ?? ?? ??}\n     $o3 = {48 B8 ?? ?? ?? ?? ?? ?? ?? ?? 48 8B 0D ?? ?? ?? ?? 48 ?? C8 48 8B C1 48 89 05 ?? ?? ?? ??}\n   condition:\n     #o1 > 70 and #o2 > 400 and #o3 > 2000\n }\n\n### 6. References\n\n```\n1. [https://ucsdnews.ucsd.edu/pressrelease/google_uc_san_diego_and_nyu_estimate_25_million_in_ransomware_payouts](https://ucsdnews.ucsd.edu/pressrelease/google_uc_san_diego_and_nyu_estimate_25_million_in_ransomware_payouts)\n\n2. [https://outpost24.com/blog/a-history-of-ransomware](https://outpost24.com/blog/a-history-of-ransomware)\n\n3. [https://www.proofpoint.com/us/blog/threat-insight/whatta-ta-ta505-ramps-activity-delivers-new-flawedgrace-variant](https://www.proofpoint.com/us/blog/threat-insight/whatta-ta-ta505-ramps-activity-delivers-new-flawedgrace-variant)\n\n4. [https://hovav.net/ucsd/dist/rop.pdf](https://hovav.net/ucsd/dist/rop.pdf)\n\n5. [https://attack.mitre.org/techniques/T1055/004/](https://attack.mitre.org/techniques/T1055/004/)\n\n6. [https://www.msreverseengineering.com/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace](https://www.msreverseengineering.com/blog/2021/3/2/an-exhaustively-analyzed-idb-for-flawedgrace)\n\n7. [https://docs.microsoft.com/en-us/windows/win32/debug/pe-format#section-table-section-headers](https://docs.microsoft.com/en-us/windows/win32/debug/pe-format#section-table-section-headers)\n\n8. https://repnz.github.io/posts/apc/user-apc/\n\n\n-----\n\n### 7. Appendix\n\n###### 7.1. Appendix A: Original Import Address Table\n```\nLdrFindResource_U\nLdrAccessResource\nRtlInitUnicodeString\nRtlGetVersion\nRtlDeleteRegistryValue\nRtlCompareUnicodeString\nRtlGetNtVersionNumbers\nRtlGetCompressionWorkSpaceSize\nRtlCompressBuffer\nRtlDecompressBuffer\nRtlCompareString\nRtlAnsiStringToUnicodeString\nRtlUnicodeStringToAnsiString\nRtlRandomEx\nRtlCreateUserThread\nRtlUnicodeStringToInteger\nRtlEqualString\nNtCreateKey\nNtFlushKey\nNtClose\nNtOpenKey\nNtRenameKey\nNtEnumerateKey\nNtEnumerateValueKey\nNtDeleteKey\nNtSetValueKey\nNtQueryValueKey\nNtCreateFile\nNtOpenFile\nNtQueryInformationFile\nNtReadFile\nNtWriteFile\nNtFlushBuffersFile\nNtSetInformationFile\nNtQueryDirectoryFile\nNtDeviceIoControlFile\nNtQuerySystemInformation\nNtSetInformationProcess\nNtQueryInformationProcess\n\n```\n\n-----\n\n```\nNtDuplicateObject\nNtAllocateVirtualMemory\nNtOpenProcess\nNtFreeVirtualMemory\nNtCreateEvent\nNtLoadDriver\nNtQueueApcThreadEx\nNtOpenThread\nNtResumeThread\nNtMapViewOfSection\nNtOpenSection\n_wcsicmp\n_snprintf\n_snwprintf\nNtProtectVirtualMemory\nNtWriteVirtualMemory\nNtReadVirtualMemory\nNtCreateThreadEx\nWow64EnableWow64FsRedirection\nWow64DisableWow64FsRedirection\nCreateRemoteThreadEx\nIsWow64Process\nHeapFree\nSleep\nCloseHandle\nCreateThread\nGetCurrentProcessId\nGetProcessHeap\nTerminateProcess\nGetSystemDirectoryW\nResumeThread\nExitProcess\nCreateProcessW\nGetSystemTimeAsFileTime\nGetProcAddress\nGetModuleHandleW\nHeapAlloc\nOpenProcess\nGetLastError\nCreateFileW\nGetCurrentProcess\nMultiByteToWideChar\nWideCharToMultiByte\nCompareStringA\nCompareStringW\nWriteFile\n\n```\n```\nSetFilePointerEx\nFindClose\nVirtualProtect\nGetCurrentThreadId\nVirtualQuery\nFlushFileBuffers\nGetStringTypeW\nGetFileType\nGetStdHandle\nGetACP\nSetConsoleCtrlHandler\nVirtualFree\nWaitForMultipleObjects\nTerminateThread\nWTSGetActiveConsoleSessionId\nGetConsoleWindow\nGetTickCount\nLocalFree\nGetFullPathNameW\nSetEvent\nResetEvent\nWaitForSingleObject\nCreateEventW\nOpenEventW\nVirtualAlloc\nGetCommandLineW\nFreeLibrary\nLoadLibraryW\nGetWindowsDirectoryW\nGetVolumeInformationW\nGetComputerNameA\nCreateDirectoryW\nGetModuleFileNameW\nCreateToolhelp32Snapshot\nProcess32FirstW\nProcess32NextW\nLoadLibraryExW\nOutputDebugStringA\nVirtualFreeEx\nReleaseMutex\nCreateMutexW\nMapViewOfFile\nUnmapViewOfFile\nCreateFileMappingW\nOpenFileMappingW\nGetSystemTime\n\n```\n\n-----\n\n```\nGetLocalTime\nOpenMutexW\nGetModuleFileNameA\nGetModuleHandleExW\nDeleteCriticalSection\nLeaveCriticalSection\nEnterCriticalSection\nSetLastError\nLCMapStringW\nFindFirstFileExA\nFindNextFileA\nIsValidCodePage\nGetOEMCP\nGetCPInfo\nGetCommandLineA\nGetEnvironmentStringsW\nFreeEnvironmentStringsW\nSetStdHandle\nHeapSize\nGetConsoleCP\nGetConsoleMode\nWriteConsoleW\nProcessIdToSessionId\nInterlockedFlushSList\nRtlUnwindEx\nGetStartupInfoW\nIsDebuggerPresent\nInitializeSListHead\nRtlCaptureContext\nRtlLookupFunctionEntry\nRtlVirtualUnwind\nUnhandledExceptionFilter\nSetUnhandledExceptionFilter\nIsProcessorFeaturePresent\nQueryPerformanceCounter\nHeapReAlloc\nRaiseException\nInitializeCriticalSectionAndSpinCount\nTlsAlloc\nTlsGetValue\nTlsSetValue\nWaitForSingleObjectEx\nEncodePointer\nReleaseSemaphore\nGetSystemInfo\nSetThreadIdealProcessor\n\n```\n```\nCreateSemaphoreW\nGetModuleHandleA\nGetNativeSystemInfo\nOutputDebugStringW\nRtlPcToFileHeader\nDuplicateHandle\nGetExitCodeProcess\nSetHandleInformation\nCreatePipe\nPeekNamedPipe\nDeviceIoControl\nGetFirmwareEnvironmentVariableW\nGetComputerNameW\nGetLocaleInfoW\nThread32First\nThread32Next\nSuspendThread\nGetThreadContext\nRegCloseKey\nRegDeleteValueW\nRegFlushKey\nRegOpenKeyExW\nRegQueryValueExW\nRegSetValueExW\nConvertStringSecurityDescriptorToSecurityDescriptorW\nCheckTokenMembership\nLookupPrivilegeValueW\nSetSecurityDescriptorDacl\nInitializeSecurityDescriptor\nFreeSid\nAllocateAndInitializeSid\nEqualSid\nAdjustTokenPrivileges\nGetTokenInformation\nOpenProcessToken\nInitiateSystemShutdownW\nRegDeleteTreeW\nRegDeleteKeyW\nRegCreateKeyExW\nRegOpenCurrentUser\nConvertSidToStringSidW\nRegisterServiceCtrlHandlerExW\nSetServiceStatus\nStartServiceCtrlDispatcherW\nCreateProcessAsUserW\nGetUserNameW\n\n```\n\n-----\n\n```\nMessageBoxW\nMessageBoxA\nShowWindow\nGetSystemMetrics\nwsprintfW\nReleaseDC\nGetDC\nIsCharAlphaA\nSendMessageA\nPostMessageA\nGetWindowTextA\nEnumWindows\nCommandLineToArgvW\nSHFileOperationW\nSHGetFolderPathW\nCoCreateGuid\nCoSetProxyBlanket\nCoInitializeSecurity\nCoInitializeEx\nCoCreateInstance\nCoUninitialize\nWTSFreeMemory\nWTSEnumerateSessionsW\nWTSQueryUserToken\nGetModuleFileNameExW\nStrStrIW\nCreateEnvironmentBlock\nDestroyEnvironmentBlock\nNetApiBufferFree\nNetWkstaGetInfo\nGetFileVersionInfoSizeW\nGetFileVersionInfoW\nVerQueryValueW\nGetDeviceCaps\nCryptBinaryToStringA\nSeDebugPrivilege\n\n```\n\n-----\n\n```\npsapi dll\n\n```\n\n-----\n\n#### About Outpost24 outpost24.com\n\nThe Outpost24 group is pioneering cyber risk management\nwith vulnerability management, application security testing, info@outpost24.com\nthreat intelligence and access management – in a single\nsolution. Over 2,500 customers in more than 65 countries\ntrust Outpost24’s unified solution to identify vulnerabilities,\n\n[twitter.com/outpost24](https://twitter.com/outpost24)\n\nmonitor external threats and reduce the attack surface with\nspeed and confidence.\n\nDelivered through our cloud platform with powerful automation [linkedin.com/outpost24](https://se.linkedin.com/company/outpost24)\nsupported by our cyber security experts, Outpost24 enables\norganizations to improve business outcomes by focusing on Blueliv ® is part of the Outpost24 Group. is a registred trademark of Leap inValue S.L. in the United States and other countries. All brand names, product names or\n\ntrademarks belong to their respective owners.\n\nthe cyber risk that matters © LEAP INVALUE S L ALL RIGHTS RESERVED\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://outpost24.com/sites/default/files/2022-10/Outpost24_Gracewrapper_Report_2022.pdf?_hsmi=229071559"
    ],
    "report_names": [
        "Outpost24_Gracewrapper_Report_2022.pdf?_hsmi=229071559"
    ],
    "threat_actors": [
        {
            "id": "72d09c17-e33e-4c2f-95db-f204848cc797",
            "created_at": "2022-10-25T15:50:23.832551Z",
            "updated_at": "2025-03-27T02:00:55.554841Z",
            "deleted_at": null,
            "main_name": "FIN8",
            "aliases": [
                "FIN8",
                "Syssphinx"
            ],
            "source_name": "MITRE:FIN8",
            "tools": [
                "BADHATCH",
                "PUNCHBUGGY",
                "Ragnar Locker",
                "PUNCHTRACK",
                "dsquery",
                "Nltest",
                "Sardonic",
                "PsExec",
                "Impacket"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "fc80a724-e567-457c-82bb-70147435e129",
            "created_at": "2022-10-25T16:07:23.624289Z",
            "updated_at": "2025-03-27T02:02:09.892602Z",
            "deleted_at": null,
            "main_name": "FIN8",
            "aliases": [
                "ATK 113",
                "Syssphinx"
            ],
            "source_name": "ETDA:FIN8",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BadHatch",
                "BlackCat",
                "Noberus",
                "PSVC",
                "PUNCHTRACK",
                "PoSlurp",
                "Powersniff",
                "PunchBuggy",
                "Ragnar Locker",
                "RagnarLocker",
                "Sardonic",
                "ShellTea"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5bdde906-0416-42ee-9100-5ebd95dda77a",
            "created_at": "2023-01-06T13:46:38.601977Z",
            "updated_at": "2025-03-27T02:00:02.870694Z",
            "deleted_at": null,
            "main_name": "FIN8",
            "aliases": [
                "ATK113",
                "G0061"
            ],
            "source_name": "MISPGALAXY:FIN8",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2864e40a-f233-4618-ac61-b03760a41cbb",
            "created_at": "2023-12-01T02:02:34.272108Z",
            "updated_at": "2025-03-27T02:02:10.209072Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "ETDA:WildCard",
            "tools": [
                "RustDown",
                "SysJoker"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1db21349-11d6-4e57-805c-fb1e23a8acab",
            "created_at": "2022-10-25T16:07:23.630365Z",
            "updated_at": "2025-03-27T02:02:09.897138Z",
            "deleted_at": null,
            "main_name": "FIN11",
            "aliases": [
                "DEV-0950",
                "Lace Tempest",
                "Operation Cyclone"
            ],
            "source_name": "ETDA:FIN11",
            "tools": [
                "AZORult",
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "BLUESTEAL",
                "Cl0p",
                "EMASTEAL",
                "FLOWERPIPE",
                "FORKBEARD",
                "FRIENDSPEAK",
                "FlawedAmmyy",
                "GazGolder",
                "Get2",
                "GetandGo",
                "JESTBOT",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MINEDOOR",
                "MIXLABEL",
                "Meterpreter",
                "NAILGUN",
                "POPFLASH",
                "PuffStealer",
                "Rultazo",
                "SALTLICK",
                "SCRAPMINT",
                "SHORTBENCH",
                "SLOWROLL",
                "SPOONBEARD",
                "TiniMet",
                "TinyMet",
                "VIDAR",
                "Vidar Stealer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "256a6a2d-e8a2-4497-b399-628a7fad4b3e",
            "created_at": "2023-11-30T02:00:07.299845Z",
            "updated_at": "2025-03-27T02:00:03.257794Z",
            "deleted_at": null,
            "main_name": "WildCard",
            "aliases": [],
            "source_name": "MISPGALAXY:WildCard",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1676945221,
    "ts_updated_at": 1743041799,
    "ts_creation_date": 1665506007,
    "ts_modification_date": 1665506014,
    "files": {
        "pdf": "https://archive.orkl.eu/27347da34823c3285c11f2c90185603d923f723b.pdf",
        "text": "https://archive.orkl.eu/27347da34823c3285c11f2c90185603d923f723b.txt",
        "img": "https://archive.orkl.eu/27347da34823c3285c11f2c90185603d923f723b.jpg"
    }
}