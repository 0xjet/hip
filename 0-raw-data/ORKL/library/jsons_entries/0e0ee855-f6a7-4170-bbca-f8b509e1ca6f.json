{
    "id": "0e0ee855-f6a7-4170-bbca-f8b509e1ca6f",
    "created_at": "2023-01-12T15:08:12.271043Z",
    "updated_at": "2025-03-27T02:06:09.28695Z",
    "deleted_at": null,
    "sha1_hash": "57fa27c4883b14cffe0ee8a08fcefbfd17c48d1c",
    "title": "2017-01-11 - Post-holiday spam campaign delivers Neutrino Bot",
    "authors": "",
    "file_creation_date": "2022-05-28T19:21:12Z",
    "file_modification_date": "2022-05-28T19:21:12Z",
    "file_size": 684421,
    "plain_text": "# Post-holiday spam campaign delivers Neutrino Bot\n\n**[blog.malwarebytes.com/cybercrime/2017/01/post-holiday-spam-campaign-delivers-neutrino-bot/](https://blog.malwarebytes.com/cybercrime/2017/01/post-holiday-spam-campaign-delivers-neutrino-bot/)**\n\nMalwarebytes Labs January 11, 2017\n\n_[This post was co-authored by @hasherezade and](https://twitter.com/hasherezade)_ _[Jérôme Segura](https://blog.malwarebytes.com/author/jeromesegura/)_\n\nDuring the Christmas season and early into the new year, we noticed a sharp decrease in\nspam volume, perhaps as online criminals took a break from their malicious activities and\npopped the champagne to celebrate. It could also have been a time to regroup and plan new\nstrategies for the upcoming year.\n\nIn any case, over the weekend we observed a large new campaign purporting to be an email\nfrom ‘Microsoft Security Office’ with a link to a full security report (Microsoft.report.doc). This\nwas somewhat unexpected, as typically the malicious Office files are directly attached to the\nemail. Instead, the files are hosted on various servers with a short time to live window.\n\n\n-----\n\nThe booby-trapped document asks users to enable macros in order to launch the malicious\ncode.\n\n\n-----\n\n## Neutrino Bot\n\nIf the macro executes, the final payload will be downloaded and executed. This is Neutrino\n[bot – which we had analyzed over a year ago and that can:](https://blog.malwarebytes.com/threat-analysis/2015/08/inside-neutrino-botnet-builder/)\n\nperform DDoS attacks\ncapture keystrokes, do form grabbing, take screenshots\nspoof DNS requests\ndownload additional malware\n\n**Analyzed sample**\n\n[2b796c0e248b02aa0c6fda288cb62531 – original sample](https://virustotal.com/en/file/87b7e57140e790b6602c461472ddc07abf66d07a3f534cdf293d4b73922406fe/analysis/)\n\n**Details**\n\nAfter deploying the sample, it installs itself in %APPDATA% in a folder called “UmJn“. This\nfolder name is typical for the particular edition of Neutrino Bot:\n\n\n-----\n\nIt starts connecting to the C&C in order to fetch the commands and perform the malicious\nactions by querying a script called “tasks.php“.\n\nThe list of URLs is hardcoded in the bot in the form of a Base64 string:\n\nURLs extracted from this sample:\n```\nhttp://saferunater.top/n/tasks.php\nhttp://saferunater.xyz/n/tasks.php\nhttp://saferunater.space/n/tasks.php\nhttp://godomenbit.bit/n/tasks.php\n\n```\nNeutrino uses a very simple method of authentication – it sends a cookie with a hardcoded\nvalue:\n```\nPOST %s HTTP/1.0\nHost: %s\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:39.0) Gecko/20100101 Firefox/38.0\nContent-type: application/x-www-form-urlencoded\nCookie: auth=bc00595440e801f8a5d2a2ad13b9791b\nContent-length: %i\n\n```\nIn the [previously described version it was md5(“admin”). This time it is:](https://blog.malwarebytes.com/threat-analysis/2015/08/inside-neutrino-botnet-builder/)\n```\n\"bc00595440e801f8a5d2a2ad13b9791b\" -> md5(\"just for fun\")\n\n```\nWhile the goals of the bot and major features didn’t change much, the code seems to be\n[partially rewritten in comparison to the leaked version 3.9.4.](https://blog.malwarebytes.com/threat-analysis/2015/08/inside-neutrino-botnet-builder/)\n\nHere is the old version, reporting to the CnC:\n\n\n-----\n\nThe new version – that seems to be 5.2 – is much less verbose. It doesn’t use any strings\nthat will indicate purpose of any particular value. Additionally, some of the used functions are\nloaded dynamically and identified by checksums for the purpose of decreasing code\nreadability:\n\nThe features are also reorganized. For example, there is still a feature of making\nscreenshots of the victim’s desktop – but its implementation details have changed:\n\n\n-----\n\nScreen grabbing is a triggered by a command from the C&C:\n\n\n-----\n\nThe created screenshot is immediately sent to the C&C.\n\nIn the past, the same feature was implemented along with the keylogger.\n\nThe responsible thread is deployed and the screenshot taken periodically and saved to the\nlogs along with other grabbed content. When the logs’ size exceeds a defined threshold, they\nare uploaded to the C&C:\n\n\n-----\n\nThe implemented changes improved code quality separating the particular features and\ngive the operator more control on its execution. Still, the code is not obfuscated but the\nauthors tried to hide some strings that explicitly show the purpose of the particular\ncommands.\n\nJust like in the previous case we are dealing with a fully-fledged multipurpose bot – with\nvarious features allowing to steal data and invade privacy, but also to use infected computers\nfor DDoS attacks or download other malware.\n\n## Protection\n\nIt is important to remember to be particularly careful with Office documents masquerading as\ninvoices, or other such reports that leverage the macro feature to execute code that will\ndownload and retrieve the actual payload. As an end user, do not enable macros unless you\ncompletely trust the file or are running it in a virtualized environment. As an IT admin, you\n[can set policies to permanently disable macros.](https://blogs.technet.microsoft.com/mmpc/2016/03/22/new-feature-in-office-2016-can-block-macros-and-help-prevent-infection/)\n\nMalwarebytes users are protected from this threat via the web or exploit protection modules.\n\n## IOCs:\n\n\n-----\n\nMalicious doc:\n\n_agranfoundation[.]org/Microsoft[.]report[.]doc_\n_xn--hastabakc-2pbb[.]net/Microsoft[.]report[.]doc_\n_ecpi[.]ro/Microsoft[.]report[.]doc_\n_ilkhaberadana[.]com/Microsoft[.]report[.]doc_\n_cincote[.]com/Microsoft[.]report[.]doc_\n_mallsofjeddah[.]com/Microsoft[.]report[.]doc_\n_dianasoligorsk[.]by/Microsoft[.]report[.]doc_\n\n_8dd66dd191c9f0d2f4b5407e5d94e815e8007a3de21ab16de49be87ea8a92e8d_\n\nNeutrino bot:\n\n_www.endclothing[.]cu[.]cc/nn.exe_\n\n_87b7e57140e790b6602c461472ddc07abf66d07a3f534cdf293d4b73922406fe_\n_b1ae6fc1b97db5a43327a3d7241d1e55b20108f00eb27c1b8aa855f92f71cb4b_\n_ca64848f4c090846a94e0d128489b80b452e8c89c48e16a149d73ffe58b6b111_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-01-11 - Post-holiday spam campaign delivers Neutrino Bot.pdf"
    ],
    "report_names": [
        "2017-01-11 - Post-holiday spam campaign delivers Neutrino Bot.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536092,
    "ts_updated_at": 1743041169,
    "ts_creation_date": 1653765672,
    "ts_modification_date": 1653765672,
    "files": {
        "pdf": "https://archive.orkl.eu/57fa27c4883b14cffe0ee8a08fcefbfd17c48d1c.pdf",
        "text": "https://archive.orkl.eu/57fa27c4883b14cffe0ee8a08fcefbfd17c48d1c.txt",
        "img": "https://archive.orkl.eu/57fa27c4883b14cffe0ee8a08fcefbfd17c48d1c.jpg"
    }
}