{
    "id": "987c623a-77f0-4edf-9cb0-7d7d778ac764",
    "created_at": "2023-01-12T15:01:04.165868Z",
    "updated_at": "2025-03-27T02:09:29.456637Z",
    "deleted_at": null,
    "sha1_hash": "b679d60d66d9eef6cd364fb0a2d82b27059d183f",
    "title": "2021-04-09 - Investigating a unique “form” of email delivery for IcedID malware",
    "authors": "",
    "file_creation_date": "2022-05-28T02:18:02Z",
    "file_modification_date": "2022-05-28T02:18:02Z",
    "file_size": 612876,
    "plain_text": "# Investigating a unique “form” of email delivery for IcedID malware\n\n**[microsoft.com/security/blog/2021/04/09/investigating-a-unique-form-of-email-delivery-for-icedid-malware/](https://www.microsoft.com/security/blog/2021/04/09/investigating-a-unique-form-of-email-delivery-for-icedid-malware/)**\n\nApril 9, 2021\n\nMicrosoft threat analysts have been tracking activity where contact forms published on websites are abused to deliver malicious links to\nenterprises using emails with fake legal threats. The emails instruct recipients to click a link to review supposed evidence behind their\nallegations, but are instead led to the download of IcedID, an info-stealing malware. Microsoft Defender for Office 365 detects and blocks these\nemails and protects organizations from this threat.\n\nIn this blog, we showcase our analysis on this unique attack and how the techniques behind it help attackers with their malicious goals of\nfinding new ways to infect systems. This threat is notable because:\n\n1. Attackers are abusing legitimate infrastructure, such as websites’ contact forms, to bypass protections, making this threat highly evasive.\n\nIn addition, attackers use legitimate URLs, in this case Google URLs that require targets to sign in with their Google credentials.\n2. The emails are being used to deliver the IcedID malware, which can be used for reconnaissance and data exfiltration, and can lead to\n\nadditional malware payloads, including ransomware.\n3. This threat shows attackers are always on the hunt for attack paths for infiltrating networks, and they often target services exposed to the\n\ninternet. Organizations must ensure they have protections against such threats.\n\nWhile this specific campaign delivers the IcedID malware, the delivery method can be used to distribute a wide range of other malware, which\ncan in turn introduce other threats to the enterprise. IcedID itself is a banking trojan that has evolved to become an entry point for more\nsophisticated threats, including human-operated ransomware. It connects to a command-and-control server and downloads additional implants\nand tools that allow attackers to perform hands-on-keyboard attacks, steal credentials, and move laterally across affected networks to\ndelivering additional payloads.\n\nWe continue to actively investigate this threat and work with partners to ensure that customers are protected. We have already alerted security\ngroups at Google to bring attention to this threat as it takes advantage of Google URLs.\n\n[Microsoft 365 Defender defends organizations by using advanced technologies informed by Microsoft Defender for Office 365 and backed by](https://www.microsoft.com/en-us/microsoft-365/security/microsoft-365-defender)\nsecurity experts. Microsoft 365 Defender correlates signals on malicious emails, URLs, and files to deliver coordinated defense against\nevasive threats, their payloads, and their spread across networks.\n\nMicrosoft Defender for Office 365 supports organizations throughout an attack’s lifecycle, from prevention and detection to investigation,\nhunting, and remediation–effectively protecting users through a coordinated defense framework.\n\n## Tracking malicious content in contact forms\n\nWebsites typically contain contact form pages as a way to allow site visitors to communicate with site owners, removing the necessity to reveal\ntheir email address to potential spammers.\n\nHowever, in this campaign, we observed an influx of contact form emails targeted at enterprises by means of abusing companies’ contact\nforms. This indicates that attackers may have used a tool that automates this process while circumventing CAPTCHA protections.\n\n\n-----\n\n_Figure 1. Sample contact form that attackers take advantage of by filling in malicious content, which gets delivered to the target enterprises_\n\nIn this campaign, we tracked that the malicious email that arrives in the recipient’s inbox from the contact form query appears trustworthy as it\nwas sent from trusted email marketing systems, further confirming its legitimacy while evading detection. As the emails are originating from the\nrecipient’s own contact form on their website, the email templates match what they would expect from an actual customer interaction or inquiry.\n\nAs attackers fill out and submit the web-based form, an email message is generated to the associated contact form recipient or targeted\nenterprise, containing the attacker-generated message. The message uses strong and urgent language (“Download it right now and check this\nout for yourself”), and pressures the recipient to act immediately, ultimately compelling recipients to click the links to avoid supposed legal\naction.\n\n\n-----\n\n_gu e_ _sa_ _p e e_ _a de_ _e ed_ _a co tact o_ _s t at co ta_ _a c ous co te t added by attac e s_\n\nAlong with the fake legal threats written in the comments, the message content also includes a link to a sites.google.com page to view the\nalleged stolen photos for the recipient to view.\n\nClicking the link brings the recipient to a Google page that requires them to sign in with their Google credentials. Because of this added\nauthentication layer, detection technologies may fail in identifying the email as malicious altogether.\n\nAfter the email recipient signs in, the sites.google.com page automatically downloads a malicious ZIP file, which contains a heavily obfuscated\n.js file. The malicious .js file is executed via WScript to create a shell object for launching PowerShell to download the IcedID payload (a .dat\nfile), which is decrypted by a dropped DLL loader, as well as a Cobalt Strike beacon in the form of a stageless DLL, allowing attackers to\nremotely control the compromised device.\n\nThe downloaded .dat file loads via the rundll32 executable. The rundll32 executable then launches numerous commands related to the\nfollowing info-stealing capabilities:\n\nMachine discovery\nObtaining machine AV info\nGetting IP and system information\nDomain information\nDropping SQLite for accessing credentials stored in browser databases\n\n## Contact form email campaign attack chains lead to IcedID malware\n\nThe diagram in Figure 3 provides a broad illustration of how attackers carry out these malicious email campaigns, starting from identifying their\ntargets’ contact forms and ending with the IcedID malware payload.\n\n_Figure 3. Contact form attack chain results in the IcedID payload_\n\nWe noted a primary and secondary attack chain under the execution and persistence stages. The primary attack chain follows an attack flow\nfrom downloading malicious .zip file from the sites.google.com link, all the way to the IcedID payload. The secondary attack chain, on the other\nhand, appears to be a backup attack flow for when the sites.google.com page in the primary attack chain has already been taken down.\n\nIn the secondary chain, users are redirected to a .top domain, while inadvertently accessing a Google User Content page, which downloads\nthe malicious .ZIP file. Further analysis reveals that the forms contain malicious sites.google.com links that download the IcedID malware.\n\nWhen run, IcedID connects to a command-and-control server to download modules that run its primary function of capturing and exfiltrating\nbanking credentials and other information. It achieves persistence via schedule tasks. It also downloads implants like Cobalt Strike and other\ntools, which allow remote attackers to run malicious activities on the compromised system, including collecting additional credentials, moving\nlaterally, and delivering secondary payloads.\n\n## Using legal threats as a social engineering tactic\n\nThis campaign is not only successful because it takes advantage of legitimate contact form emails, but the message content also passes as\nsomething that recipients would expect to receive. This creates a high risk of attackers successfully delivering email to inboxes, thereby\nallowing for “safe” emails that would otherwise be filtered out into spam folders.\n\nIn the samples we found, attackers used legal threats as a scare tactic while claiming that the recipients allegedly used their images or\nillustrations without their consent, and that legal action will be taken against them. There is also a heightened sense of urgency in the email\nwording, with phrases such as “you could be sued,” and “it’s not legal.” It’s a sly and devious approach since everything else about this email is\nauthentic and legitimate.\n\n\n-----\n\ne obse ed o e e a s se t by attac e s o ot e co tact o s t at co ta s a o d g a ou d ega t eats e essages\nconsistently mention a copyright claim lure by a photographer, illustrator, or designer with the same urgency to click the sites.google.com link.\n\n_Figure 4. Samples of contact form emails that use the photographer copyright lure with a sites.gooogle.com link_\n\nIn a typical contact form, users are required to input their name, email address, and a message or comment. In the samples we obtained,\nattackers used fake names that start with “Mel,” such as “Melanie” or “Meleena,” and used a standard format for their fake email addresses\nthat include a portion of their fake name + words associated photography + three numbers. Some examples include:\n\nmphotographer550@yahoo.com\nmephotographer890@hotmail.com\nmgallery487@yahoo.com\nmephoto224@hotmail.com\nmegallery736@aol.com\nmshot373@yahoo.com\n\n## Defending against sophisticated attacks through coordinated defense\n\nAs this research shows, adversaries remain motivated to find new ways to deliver malicious email to enterprises with the clear intent to evade\ndetection. The scenarios we observed offer a serious glimpse into how sophisticated attackers’ techniques have grown, while maintaining the\ngoal of delivering dangerous malware payloads such as IcedID. Their use of submission forms is notable because the emails don’t have the\ntypical marks of malicious messages and are seemingly legitimate.\n\n[To protect customers from this highly evasive campaign, Microsoft Defender for Office 365 inspects the email body and URL for known](https://www.microsoft.com/en-us/microsoft-365/security/office-365-defender)\npatterns. Defender for Office 365 enables this by leveraging its deep visibility into email threats and advanced detection technologies powered\nby AI and machine learning, backed by Microsoft experts who constantly monitor the threat landscape for new attacker tools and techniques.\nExpert monitoring is especially critical in detecting this campaign given the delivery method and the nature of the malicious emails.\n\nIn addition, the protection delivered by Microsoft Defender for Office 365 is enriched by signals from other Microsoft 365 Defender services,\nwhich detect other components of this attack. For example, Microsoft Defender for Endpoint detects the IcedID payload and surfaces this\nintelligence across Microsoft 365 Defender. With its cross-domain optics, Microsoft 365 Defender correlates threat data on files, URLs, and\nemails to provide end-to-end visibility into attack chains. This allows us to trace detections of malware and malicious behavior to the delivery\nmethod, in this case, legitimate-looking emails, enabling us to build comprehensive and durable protections, even as attackers continue to\ntweak their campaigns to further evade detection.\n\nBy running custom queries using advanced hunting in Microsoft 365 Defender, customers can proactively locate threats related to this attack.\n\n[To locate emails that may be related to this activity, run the following query:](https://security.microsoft.com/hunting?query=H4sIAAAAAAAEAG2SzU4CQRCE62ziO0y4gImRs1w0MZBwkIOGG4nhZ1kW2R3DLiJR392vG9ggIRNme7pqqqt76CrXWJlWGmrN3lehuaKudaUfBW21UAKSEO8ZwW9UmjpScjY05fdF_KiGRpqQz-AYPtIdaGSl3E78POWUE7X1CS-hisUtPajDeaYbohHfb93rVr-u2Kg9Lbmd4TOoW7vvopSQq9xRdHRApkI74vBdz-6mhG9e-6ibXptlzOhuO8QvfD9QHOPSuq68z-BTWbEiilY9JVdqg7Ml-BReADVkP5WtT2BxohAdC16_8KmOveqM3EQ79h2cDXm7nZxMsemKT65QubOqrp7DKZ2573ru_eZEGXEgFw9vZPzVYUJrn43VKpxZeKUMbetxd_H9X8-6XcAu9cZecKOFy3OHQ_AmLxjYB_7OR5X_ro-c8_u9Qy9HvFf3dqn3Jv-bP2MYzmvQAgAA&runQuery=true&timeRangeId=month)\n```\nEmailUrlInfo\n| where Url matches regex @\"\\bsites\\.google\\.com\\/view\\/(?:id)?\\d{9,}\\b\"\n| join EmailEvents on NetworkMessageId\n// Note: Replace the following subject lines with the one generated by your website's Contact submission form if no\nresults return initially\n| where Subject has_any('Contact Us', 'New Submission', 'Contact Form', 'Form submission')\n\n```\n[To find malicious downloads associated with this threat, run the following query:](https://security.microsoft.com/hunting?query=H4sIAAAAAAAEAKWS3WrCQBCFz7XgO8heKRRvfQEr9KIqgteiJprQxJSsrT-UPrvfji4UI3hRwuwyM-ec-dkMlepbudbcI-6C-5VIqp328mqrpR91dFBGrMY6eiOXk821tHOnrabkKlPxfFFpDKI0TkD9qiuH74kkcFL1sSPm9ALGwc9Mp3yQC94nqpV1UTfyA52p-96Ib6gdGBuYx0Z2ZfUO1lOtxc3_uKvQe7iHOOUEP2eeMOPMKgXEtcs5VoDN2IS3in2myDCHt4SR_ENpT6_PlSIzcheGPtlrbFGoOAPn67aFNZHw-td_IG7qLzLGEntzbxu6ADunZbJKAgAA&runQuery=true&timeRangeId=month)\n```\nDeviceFileEvents\n| where InitiatingProcessFileName in~\n(\"msedge.exe\", \"chrome.exe\", \"explorer.exe\", \"7zFM.exe\", \"firefox.exe\", \"browser_broker.exe\")\n| where FileOriginReferrerUrl has \" php\" and FileOriginReferrerUrl has \" top\" and FileOriginUrl has any(\"googleusercont\n\n```\n\n-----\n\ns t s attac abuses eg t ate se ces, t s a so po ta t o custo e s to e e a o u es to c ec o b oad e cept o s, suc t ose\nrelated to IP ranges and domain-level allow lists, that may be letting these emails through.\n\nWe also encourage customers to continuously build organizational resilience against email threats by educating users about identifying social\n[engineering attacks and preventing malware infection. Use Attack simulation training in Microsoft Defender for Office 365 to run attack](https://docs.microsoft.com/en-us/microsoft-365/security/office-365-security/attack-simulation-training-get-started?view=o365-worldwide)\nscenarios, increase user awareness, and empower employees to recognize and report these attacks.\n\n**_Emily Hacker with Justin Carroll_**\n_Microsoft 365 Defender Threat Intelligence Team_\n\n## Additional resources\n\n[Listen to Episode 28 of the Security Unlocked podcast, Contact Us; Phish You!, where threat analyst Emily Hacker speaks about this new form](https://securityunlockedpodcast.com/episodes/contact-us-fish-you)\nof phishing email delivery\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-09 - Investigating a unique “form” of email delivery for IcedID malware.pdf"
    ],
    "report_names": [
        "2021-04-09 - Investigating a unique “form” of email delivery for IcedID malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535664,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653704282,
    "ts_modification_date": 1653704282,
    "files": {
        "pdf": "https://archive.orkl.eu/b679d60d66d9eef6cd364fb0a2d82b27059d183f.pdf",
        "text": "https://archive.orkl.eu/b679d60d66d9eef6cd364fb0a2d82b27059d183f.txt",
        "img": "https://archive.orkl.eu/b679d60d66d9eef6cd364fb0a2d82b27059d183f.jpg"
    }
}