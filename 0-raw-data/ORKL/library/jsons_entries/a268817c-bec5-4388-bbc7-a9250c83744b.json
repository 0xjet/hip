{
    "id": "a268817c-bec5-4388-bbc7-a9250c83744b",
    "created_at": "2023-01-12T15:09:23.679527Z",
    "updated_at": "2025-03-27T02:15:45.266376Z",
    "deleted_at": null,
    "sha1_hash": "a2d2cbdf233083b31b7ba339cb019e49fcd809e8",
    "title": "2022-08-12 - LuckyMouse uses a backdoored Electron app to target MacOS",
    "authors": "",
    "file_creation_date": "2022-09-01T10:11:05Z",
    "file_modification_date": "2022-09-01T10:11:05Z",
    "file_size": 1148852,
    "plain_text": "# LuckyMouse uses a backdoored Electron app to target MacOS\n\n**[blog.sekoia.io/luckymouse-uses-a-backdoored-electron-app-to-target-macos/](https://blog.sekoia.io/luckymouse-uses-a-backdoored-electron-app-to-target-macos/)**\n\n12 August 2022\n\n[Threat & Detection Research Team\nAugust 12 2022](https://blog.sekoia.io/author/tdr/)\n2473\n0\n\nRead it later\nRemove\n\n7 minutes reading\n\n_This blog post on LuckyMouse is an extract of the “FLINT 2022-045 – LuckyMouse uses a_\n**_[backdoored Electron app to target MacOS” report (SEKOIA.IO Flash Intelligence) sent to](https://www.sekoia.io/en/sekoia-io-cti/)_**\n_our clients on August 10, 2022._\n\n_Note: TrendMicro has published on the same campaign under the title : “Iron Tiger_\n_Compromises Chat Application Mimi, Targets Windows, Mac, and Linux Users“._\n\n## Table of contents\n\nSummary\n\nRShell Mach-O implant\nIOCs & Technical Details\n\n## Summary\n\nDuring a review of the HyberBro Command and Control (C2) infrastructure linked to Chinanexus LuckyMouse intrusion set, SEKOIA spotted an unusual connection with an application.\nFurther investigation led to identify this application as “MìMì” (秘秘 – “secret”, aka Mi). Mimi\nis a Chinese-speaking Electron App developed by Xiamen Baiquan Information Technology\nCo. Ltd. SEKOIA established that “MìMì” Messenger’s MacOS version is trojanized\n**since May 26, 2022 to download and execute a Mach-O binary dubbed “rshell”.**\n\nAt this stage, SEKOIA is not able to assess the objective of this campaign. As this\n**application’s use in China appears low, it is plausible it was developed as a targeted**\n**surveillance tool. It is also likely that, following social engineering carried out by the**\noperators, targeted users are encouraged to download this application, purportedly to\ncircumvent Chinese authorities’ censorship.\n\n\n-----\n\nThis is not the first time a messaging application dropping an implant connecting to the\nLuckyMouse infrastructure is observed. In 2020, our **ESET fellows uncovered**\n**compromised versions of Able Desktop, a messaging application widely used in**\n**Mongolia in the “StealthyTrident” operation. In this campaign, Able Desktop was used to**\ndrop several implants, including PlugX, Tmanger and HyperBro, known to be a part of the\nLuckyMouse tool set.\n\nHowever, this is the first time that SEKOIA observed LuckyMouse targeting MacOS.\nMoreover, if this application is exclusively used by Chinese citizens, it would be the first\n**time that we identified LuckyMouse involved in domestic surveillance. This FLINT**\npresents our findings on this campaign, including a description of the Rshell implant, and\nassociated IOCs.\n\n## “MìMì” Messenger backdooring\n\nThe “Mi” Application is an Electron messaging app available for Android, iOS, Windows and\nMacOS platforms. As Mi is not widely promoted, and its related website\n(www.mmimchat[.]com) doesn’t display a detailed description, general conditions of use or\nsocial media links, SEKOIA rapidly questioned its legitimacy.\n\nFigure 1. Mimi website at www.mmimchat[.]com\nMoreover, the website hosted files were last modified on July 26. Based on the Apple Store\nchange logs and Passive DNS, we figured that the first traces of this application dates back\nto June 2020. However, SEKOIA was not able to assess whether this application is\n**legit, or if it was designed or repurposed as a surveillance tool. Additionally, based on**\nour open source investigations, it is not possible to assess whether Xiamen Baiquan\nInformation Technology Co. Ltd. is a legit or a shell company.\n\n\n-----\n\nThe MacOS version of the Mi Application is an ElectronApp packaged in an Apple Disk\nImage file. This application seems to be functional, where end users simply register\nthemselves to be able to discuss with their contacts. However, in version 2.3.0, published\n**on May 26 2022, the ./mimi.app/Contents/Resources/app/electron-main.js file was**\n**trojanized. As shown below, this was implemented by placing a Dean Edwards Packed**\nJavaScript code at the beginning of the module.exports function.\n\nFigure 2. Backdoored electron-main.js file.\nThis code, executed at the runtime, checks if the environment is MacOS (darwin) and then\ndownloads the “rshell” implant from 139.180.216.65, an IP address already associated to\nLuckyMouse HyperBro C2. The retrieved payload is written in the temp folder, chmoded with\nexecution permission and then, executed as shown in the deobfuscated code:\n\n\n-----\n\n**Figure 3. Code responsible for downloading and executing RShell.**\nWhile SEKOIA analysts checked Windows, iOS, and Android versions of the app, no\nbackdoor was found in the current versions. However, TrendMicro found old Linux and\n**Windows versions backdoored.** **[Read their analysis here.](https://www.trendmicro.com/en_us/research/22/h/irontiger-compromises-chat-app-Mimi-targets-windows-mac-linux-users.html)**\n\n### RShell Mach-O implant\n\nThe downloaded implant, named RShell by its developers, is written in C++ and embeds the\nBoost.Asio and nlohmann/json libraries. This backdoor uses BJSON (Binary JSON) over\nTCP sockets to communicate with its command and control server, without any encryption\nand does not display a persistence mechanism.\n\nUpon execution, RShell backdoor attempts to connect with the C2 server. This “Hello\nmessage” to the C2 server contains:\n\na random GUID, added to each response to the C2 server\nthe hostname\nthe IPv4 adresses\nthe type of connection (“login” for instance)\nthe current username\nthe kernel version.\n\n\n-----\n\nFigure 4. Hello\n\npacket from the implant.\nRShell backdoor accepts two “types” of commands: “cmd” and “file”.\n\nThe group “cmd” contains three commands:\n\ninit(): start a bash\ndata(data): write data to the bash\nclose(): ends up the bash.\n\nThe second type of commands, “file”, enable interactions with the filesystem:\n\ndir(path): returns a list of files and subdirectories for the specified path\ninit(): returns a list of files and subdirectories for the root filesystem (equivalent to\ndir(“/”))\ndown(path): opens a file in binary and read-only mode and returns the size of the file\nread(path): reads the specified file. The file must first have been opened with the down\ncommand\nupload(path): opens a file in binary and write-only mode\nwrite(data, path): writes data to the specified file. As for the read command, the file\nmust first have been opened with the upload command before\ndel(path): delete the specified file or directory\nclose(path): closes the file\n\nThe following figures present an example of request and response for the dir command.\n\n\n-----\n\nFigure 5. Example of dir request\n\nFigure 6. Example of\n\n**dir response**\n\nA keepalive message is sent to the C2 server every 40 seconds. The server must echo this\nmessage. Based on this observation, we created a Suricata rule to spot this threat in your\nnetwork flows (see Appendix).\n\n### Links with LuckyMouse\n\nInfrastructure links were established between China-nexus Intrusion Set LuckyMouse and\nthis operation.\n\n\n-----\n\nOf note, in the course of our investigation, the same HTTP server also served a HyperBro\nwhich was configured to communicate over HTTPs to 139.180.216[.]65. The malicious DLL\nof this HyperBro sample was signed by a certificate known to be stolen and then used by\nLuckyMouse. The files launching this sample were accessible at the following URLs:\n\nhttp://139.180.216.65/dlpumgr32.exe\nhxxp://139.180.216.65/dlpprem32.dll\nhxxp://139.180.216.65/dlpprem32.bin\n\nSecondly, both LuckyMouse and RShell operators use the same IP range, namely\n103.79.76.0/22.\n\nWhile this IP range was recently used by LuckyMouse, notably to host three HyperBro C2\nservers (103.79.77[.]200, 103.79.76[.]232, 103.79.78[.]48), two RShell C2 were also\nidentified at 103.79.76[.]88 and 103.79.77[.]178.\n\nFinally, as documented by ESET, compromised messaging applications were already\nleveraged by LuckyMouse in past activities and this Intrusion Set was observed using Dean\nEdwards Javascript packer in previous watering hole campaigns.\n\n### Conclusion\n\nBased on our investigations, SEKOIA associate this activity to LuckyMouse with high\n**confidence. It is plausible this activity indicates an expansion of LuckyMouse’s mandate,**\nnow including surveillance. However, as this Intrusion Set was mostly observed continuously\ncarrying out espionage activities, notably against the technology and governmental sectors,\nSEKOIA assess this hypothesis is unlikely.\n\nAt the time of writing, [SEKOIA refrains from making any assessment on the Intrusion Set’s](https://blog.sekoia.io/)\nmotivation and will continue to closely monitor their activities. Regardless of LuckyMouse’s\ngoals, it is of particular interest to observe the targeting of MacOS environment. SEKOIA\nassess this Intrusion Set will continue updating and improving their capabilities in the shortterm.\n\n[Discover our CTI and XDR products](https://sekoia.io/en/contact/)\n\n## IOCs & Technical Details\n\n**Related infrastructure**\n```\n103.79.76[.]88\n\n103.79.77[.]178\n\n139.180.216[.]65\n\n```\n**RShell hashes**\n\n\n-----\n\n```\n8c3be245cbbe9206a5d146017c14b8f965ab7045268033d70811d5bcc4b796ec  rshell\n\n3a9e72b3810b320fa6826a1273732fee7a8e2b2e5c0fd95b8c36bbab970e830a  rshell\n\n```\n**Compromised DMG images**\n```\nf6e0e5c9b9d43e008805644d937770b399f859cbba475ad837805d9adec13a2c  2.3.0.dmg\n\n4742c1987fdd968d7f094dc5a3ea3e9b5340b47e5a61846ac6ac7ae03fc7288f  2.3.1.dmg\n\n64e771c894616100202e83f3574f8accc8453138af6709367c99157e33bb613a  2.3.2.dmg\n\n466981b6aa38ae35a2c0e21a2066b4e803cc0bf76409eeb605892604c20ccf3a  2.3.3.dmg\n\n```\n**HyperBro implant**\n\n_Warning: dlpumgr32.exe is a legit file_\n```\nef2f20d1016cd39ff44f1399c8aa5c1ff5bfd4850d611ba375fbeff7f7e3eaf6  dlpprem32.bin\n\n22c3c2bf77a94ed5f207c00e240f558d6411308d237779ffb12e04bbe2c90356  dlpprem32.dll\n\n07758c93ba33843a9c5603f900f2ad0231c64ec77f6bba6de83ed6e2902022e4  dlpumgr32.exe\n\n\n```\n**YARA rules**\n\n\n-----\n\n```\nrule apt_LuckyMouse_RShell_strings {\n\n  meta:\n\n    id = \"89f18013-ea3e-440f-821e-cef102a43b7b\"\n\n    version = \"1.0\"\n\n    malware = \"RShell\"\n\n    intrusion_set = \"LuckyMouse\"\n\n    description = \"Detects LuckyMouse RShell Mach-O implant\"\n\n    source = \"SEKOIA\"\n\n    creation_date = \"2022-08-05\"\n\n    classification = \"TLP:WHITE\"\n\n  strings:\n\n    $ = { 64 69 72 00 70 61 74 68\n\n       00 64 6F 77 6E 00 72 65\n\n       61 64 00 75 70 6C 6F 61\n\n       64 00 77 72 69 74 65 00\n\n       64 65 6C }\n\n    $ = { 6C 6F 67 69 6E 00 68 6F\n\n       73 74 6E 61 6D 65 00 6C\n\n       61 6E 00 75 73 65 72 6E\n\n       61 6D 65 00 76 65 72 73\n\n       69 6F 6E }\n\n  condition:\n\n    uint32be(0) == 0xCFFAEDFE and\n\n    filesize < 300KB and\n\n    all of them\n\n}\n\nrule apt_LuckyMouse_Compromised_ElectronApp {\n\n  meta:\n\n    id = \"7702217d-771f-47af-8eaa-d5acf1e14f4d\"\n\n    version = \"1.0\"\n\n    intrusion_set = \"LuckyMouse\"\n\n    description = \"Detects compromised ElectronApp\"\n\n    source = \"SEKOIA\"\n\n    creation_date = \"2022-08-05\"\n\n    classification = \"TLP:WHITE\"\n\n  strings:\n\n    $s = \"module.exports=function(t){eval(function(p,a,c,k,e,r)\"\n\n  condition:\n\n    $s at 0 and filesize < 100KB\n\n}\n\n```\n**Suricata rule**\n```\nalert tcp $HOME_NET any -> $EXTERNAL_NET any (flow: from_client,\nestablished;content:\"|19 00 00 00 02 74 79 70 65 00 0a 00 00 00 6b 65 65 70 61 6c 69\n76 65 00 00|\";dsize:25;msg:\"Detects a LuckyMouse RShell beaconing\npacket\";sid:XXXXXXXXX; rev:001; threshold: type limit, track by_src, seconds 500,\ncount 1;)\n\n```\nYou can find out [how we track threats on our SOC platform SEKOIA.IO.](https://www.sekoia.io/en/continuously-tracking-threats/)\n\n\n-----\n\n## Chat with our team!\n\nWould you like to know more about our solutions? Do you want to discover our XDR and CTI\nproducts? Do you have a cybersecurity project in your organization? Make an appointment\nand meet us!\n\n**[Contact us](https://www.sekoia.io/en/contact/)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-12 - LuckyMouse uses a backdoored Electron app to target MacOS.pdf"
    ],
    "report_names": [
        "2022-08-12 - LuckyMouse uses a backdoored Electron app to target MacOS.pdf"
    ],
    "threat_actors": [
        {
            "id": "f3b19931-3751-4ece-a235-15b397951dc2",
            "created_at": "2022-10-25T16:07:23.889537Z",
            "updated_at": "2025-03-27T02:02:10.015565Z",
            "deleted_at": null,
            "main_name": "Nazar",
            "aliases": [
                "SIG37"
            ],
            "source_name": "ETDA:Nazar",
            "tools": [
                "Distribute.exe",
                "EYService",
                "GpUpdates.exe",
                "Microolap Packet Sniffer",
                "TCPDUMP for Windows"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e3492534-85a6-4c87-a754-5ae4a56d7c8c",
            "created_at": "2022-10-25T15:50:23.819113Z",
            "updated_at": "2025-03-27T02:00:55.552554Z",
            "deleted_at": null,
            "main_name": "Threat Group-3390",
            "aliases": [
                "Threat Group-3390",
                "Earth Smilodon",
                "TG-3390",
                "Emissary Panda",
                "BRONZE UNION",
                "APT27",
                "Iron Tiger",
                "LuckyMouse"
            ],
            "source_name": "MITRE:Threat Group-3390",
            "tools": [
                "Systeminfo",
                "gsecdump",
                "PlugX",
                "ASPXSpy",
                "Cobalt Strike",
                "Mimikatz",
                "Impacket",
                "gh0st RAT",
                "certutil",
                "China Chopper",
                "HTTPBrowser",
                "Tasklist",
                "netstat",
                "SysUpdate",
                "HyperBro",
                "ZxShell",
                "RCSession",
                "ipconfig",
                "Clambling",
                "pwdump",
                "NBTscan",
                "Pandora",
                "Windows Credential Editor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2c980ea7-04c4-4193-8535-52f87e66a96e",
            "created_at": "2024-05-01T02:03:07.994126Z",
            "updated_at": "2025-03-27T02:05:17.293799Z",
            "deleted_at": null,
            "main_name": "BRONZE UNION",
            "aliases": [
                "Budworm ",
                "Emissary Panda ",
                "Iron Tiger ",
                "Lucky Mouse ",
                "TG-3390 ",
                "Temp.Hippo ",
                "APT27 "
            ],
            "source_name": "Secureworks:BRONZE UNION",
            "tools": [
                " ASPXSpy",
                " China Chopper",
                " Enfal",
                " Gh0st RAT",
                " HttpBrowser",
                " Hunter",
                " HyperBro",
                " OwaAuth",
                " PlugX",
                " PoisonIvy",
                " Sysupdate",
                " ZxShell",
                "9002"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c63ab035-f9f2-4723-959b-97a7b98b5942",
            "created_at": "2023-01-06T13:46:38.298354Z",
            "updated_at": "2025-03-27T02:00:02.798255Z",
            "deleted_at": null,
            "main_name": "APT27",
            "aliases": [
                "TG-3390",
                "EMISSARY PANDA",
                "TEMP.Hippo",
                "Budworm",
                "Group 35",
                "BRONZE UNION",
                "Lucky Mouse",
                "Iron Taurus",
                "GreedyTaotie",
                "Red Phoenix",
                "ZipToken",
                "Iron Tiger",
                "G0027",
                "Earth Smilodon"
            ],
            "source_name": "MISPGALAXY:APT27",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536163,
    "ts_updated_at": 1743041745,
    "ts_creation_date": 1662027065,
    "ts_modification_date": 1662027065,
    "files": {
        "pdf": "https://archive.orkl.eu/a2d2cbdf233083b31b7ba339cb019e49fcd809e8.pdf",
        "text": "https://archive.orkl.eu/a2d2cbdf233083b31b7ba339cb019e49fcd809e8.txt",
        "img": "https://archive.orkl.eu/a2d2cbdf233083b31b7ba339cb019e49fcd809e8.jpg"
    }
}