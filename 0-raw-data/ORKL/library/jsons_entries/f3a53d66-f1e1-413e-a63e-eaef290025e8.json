{
    "id": "f3a53d66-f1e1-413e-a63e-eaef290025e8",
    "created_at": "2023-01-12T15:01:04.956182Z",
    "updated_at": "2025-03-27T02:15:41.654739Z",
    "deleted_at": null,
    "sha1_hash": "8a6e1a8a9a0734be6d175be4b1608714267d8284",
    "title": "2016-10-03 - On the StrongPity Waterhole Attacks Targeting Italian and Belgian Encryption Users",
    "authors": "",
    "file_creation_date": "2022-05-27T21:26:21Z",
    "file_modification_date": "2022-05-27T21:26:21Z",
    "file_size": 843809,
    "plain_text": "# On the StrongPity Waterhole Attacks Targeting Italian and Belgian Encryption Users\n\n**[securelist.com/blog/research/76147/on-the-strongpity-waterhole-attacks-targeting-italian-and-belgian-encryption-users/](https://securelist.com/blog/research/76147/on-the-strongpity-waterhole-attacks-targeting-italian-and-belgian-encryption-users/)**\n\nAuthors\n\n[Kurt Baumgartner](https://securelist.com/author/kurtb/)\n\nThe StrongPity APT is a technically capable group operating under the radar for several\nyears. The group has quietly deployed zero-day in the past, effectively spearphished targets,\nand maintains a modular toolset. What is most interesting about this group’s more recent\nactivity however, is their focus on users of encryption tools, peaking this summer. In\nparticular, the focus was on Italian and Belgian users, but the StrongPity watering holes\naffected systems in far more locations than just those two. Adding in their creative\nwaterholing and poisoned installer tactics, we describe the StrongPity APT as not\nonly determined and well-resourced, but fairly reckless and innovative as well.\n\n## Encryption Tools\n\nClearly this APT is interested in encrypted data and communications. The tools targeted by\nthis group enable practices for securing secrecy and integrity of data. For example, WinRAR\npacks and encrypts files with strong suites like AES-256, and TrueCrypt encrypts full hard\ndrives all in one swoop. Both WinRAR and TrueCrypt help provide strong and reliable\n\n\n-----\n\nencryption. WinRAR enables a person to encrypt a file with AES-256 in CBC mode with a\nstrong PBKDF2 HMAC-SHA256 based key. And, TrueCrypt provides an effective opensource full disk encryption solution for Windows, Apple, Linux, and Android systems. Using\nboth of these tools together, a sort of one off, poor man’s end-to-end encryption can be\nmaintained for free by putting these two solutions together with free file sharing services.\n\nOther software applications help to support encrypted sessions and communications. Well\nknown applications supporting end-to-end encryption are used by hundreds of millions of\nfolks, sometimes unknowingly, every day. IM clients like Microsoft’s Skype implement 256-bit\nAES encrypted communications, while Putty, Winscp and Windows Remote Desktop help\nprovide private communications and sessions with fully encrypted communications as well.\nMost of these communications across the wire are currently unbreakable when intercepted,\nat least, when the applications are configured properly.\n\n## Summer 2016 Watering Hole Resources and Trickery – WinRAR and TrueCrypt\n\nThis actor set up a particularly clever site to deliver trojanized WinRAR installers in the\nsummer of 2016, appears to have compromised another, and this activity reminds us\n[somewhat of the early 2014 Crouching Yeti activity. Much of the Crouching Yeti](https://securelist.com/energetic-bear-more-like-a-crouching-yeti/65240/)\nintrusions were enabled by trojanizing legitimate ICS-related IT software installers like\nSCADA environment vpn client installers and industrial camera software driver installers.\nThen, they would compromise the legitimate company software distribution sites and replace\nthe legitimate installers with the Crouching Yeti trojanized versions. The tactics effectively\ncompromised ICS and SCADA related facilities and networks around the world. Simply put,\neven when visiting a legitimate company distribution site, IT staff was downloading and\ninstalling ICS-focused malware. StrongPity’s efforts did much the same.\n\nIn the case of StrongPity, the attackers were not focused on ICS or SCADA. They set up a\ndomain name (ralrab[.]com) mimicking the legitimate WinRAR distribution site (rarlab[.]com),\nand then placed links on a legitimate “certified distributor” site in Europe to redirect to their\npoisoned installers hosted on ralrab[.]com. In Belgium, the attackers placed a\n“recommended” link to their ralrab[.]com site in the middle of the localized WinRAR\ndistribution page on winrar[.]be. The big blue recommended button (here in French) linked to\nthe malicious installer, while all the other links on the page directed to legitimate software:\n\n\n-----\n\n_Winrar[.]be site with “recommended link” leading to malicious ralrab[.]com_\n\nThe winrar[.]be site evaluated what “recommended” package a visitor may need based on\nbrowser localization and processor capability, and accordingly offered up appropriate\ntrojanized versions. Installer resources named for french and dutch versions, along with 32bit versus 64-bit compiled executables were provided over the summer:\n\nhxxp://www.ralrab[.]com/rar/winrar-x64-531.exe\nhxxp://www.ralrab[.]com/rar/winrar-x64-531fr.exe\nhxxp://www.ralrab[.]com/rar/winrar-x64-531nl.exe\nhxxp://www.ralrab[.]com/rar/wrar531.exe\nhxxp://www.ralrab[.]com/rar/wrar531fr.exe\nhxxp://www.ralrab[.]com/rar/wrar531nl.exe\nhxxp://ralrab[.]com/rar/winrar-x64-531.exe\nhxxp://ralrab[.]com/rar/winrar-x64-531nl.exe\nhxxp://ralrab[.]com/rar/wrar531fr.exe\nhxxp://ralrab[.]com/rar/wrar531nl.exe\nhxxp://ralrab[.]com/rar/wrar53b5.exe\n\n\n-----\n\n_Directory listing, poisoned StrongPity installers, at rarlrab[.]com_\n\nThe first available visitor redirects from winrar[.]be to ralrab[.]com first appeared on May\n28th, 2016, from the dutch speaking version of the winrar.be site. And around the same time,\nanother “certified distributor” winrar[.]it served trojanized installers as well. The major\ndifference here is that we didn’t record redirections to ralrab[.]com, but it appears the site\ndirectly served StrongPity trojanized installers:\n\nhxxps://www.winrar[.]it/prelievo/WinRAR-x64-531it.exe\nhxxps://www.winrar[.]it/prelievo/WRar531it.exe\n\nThe site started serving these executables a couple of days earlier on 5/24, where a large\nmajority of Italian visitors where affected.\n\n\n-----\n\n_Download page, winrar[.]it_\n\nQuite simply, the download links on this site directed visitors to trojanized WinRAR installers\nhosted from the winrar.it site itself. It’s interesting to note that both of the sites are\n“distributors”, where the sites are owned and managed not by rarlabs, but by local owners in\nindividual countries.\n\nStrongPity also directed specific visitors from popular, localized software sharing sites\ndirectly to their trojanized installers. This activity continued into late September 2016. In\nparticular, the group redirected visitors from software aggregation and sharing site\ntamindir[.]com to their attacker-controlled site at true-crypt[.]com. The StrongPity controlled\nTruecrypt site is a complete rip of the legitimate site, now hosted by Sourceforge. Here is the\nTamindir truecrypt page, looks harmless enough.\n\n\n-----\n\n_TrueCrypt page, tamindir software sharing site_\n\nUnlike the newer poisoned WinRAR installers, StrongPity hosted several Much like the\npoisoned WinRAR installers, multiple filenames have been used to keep up with visitor\ninterests. Visitors may have been directed to the site by other means and downloaded\ndirectly from the ripped and persuasive site.\n\n\n-----\n\n_true-crypt[.]com malicious StrongPity distribution site_\n\nAt the very bottom of the page, there are a couple of links to the poisoned installers:\n\nhxxp://www.true-crypt[.]com/download/TrueCrypt-Setup-7.1a.exe\nhxxp://true-crypt[.]com/files/TrueCrypt-7.2.exe\n\nReferrers include these localized software aggregates and sharers:\n\ngezginler[.]net/indir/truecrypt.html\ntamindir[.]com/truecrypt/indir\n\nIt’s interesting that Ksn recorded appearance of the the file on two unique systems in\nDecember 2015, a third in January 2016, all in Turkey, and then nothing until May 2016.\nThen, deployment of the installers continued mostly within Turkey in July and September\n2016.\n\n\n-----\n\n## Summer 2016 Watering Hole Victim Geolocations – WinRAR and TrueCrypt\n\nOver the course of a little over a week, malware delivered from winrar.it appeared on over\n600 systems throughout Europe and Northern Africa/Middle East. Likely, many more\ninfections actually occurred. Accordingly, the country with the overwhelming number of\ndetections was in Italy followed by Belgium and Algeria. The top countries with StrongPity\nmalware from the winrar.it site from May 25th through the first few days of June are\nItaly, Belgium, Algeria, Cote D’Ivoire, Morroco, France, and Tunisia.\n\n_winrar[.]it StrongPity component geolocation distribution_\n\nIn a similar time-span, the over sixty visitors redirected from winrar.be to ralrab.com for\nmalicious file download were overwhelmingly located in one country. The top countries\ndirected to StrongPity malware from the winrar.be site from May 25th through the first few\ndays of June are Belgium, Algeria, Morroco, Netherlands, Canada, Cote D’Ivoire,\nand Tunisia.\n\n\n-----\n\n_winrar[.]be StrongPity component geolocation distribution_\n\nStrongPity previously set up TrueCrypt themed watering holes in late 2015. But their\noffensive activity surged in late summer 2016. The group set up a site directly pulled from the\ncontents of the legitimate TrueCrypt website. From mid July to early September, dozens of\nvisitors were redirected from tamindir[.]com to true-crypt[.]com with unsurprisingly almost all\nof the focus on systems in Turkey, with victims in the Netherlands as well.\n\n_tamindir[.]com to true-crypt[.]com poisoned TrueCrypt installer redirects_\n\n## StrongPity Malware\n\n\n-----\n\nThe StrongPity droppers were often signed with unusual digital certificates, dropping multiple\ncomponents that not only provide complete control of the victim system, but effectively steal\ndisk contents, and can download components for further collection of various\ncommunications and contacts. Because we are talking about StrongPity watering holes, let’s\ntake a quick look at what is being delivered by the group from these sites.\n\nWhen we count all systems from 2016 infected with any one of the StrongPity components or\na dropper, we see a more expansive picture. This data includes over 1,000 systems infected\nwith a StrongPity component. The top five countries include Italy, Turkey, Belgium, Algeria,\nand France.\n\nIn the case of the winrar[.]be/ralrab[.]com watering hole malware, each one of the six\ndroppers that we observed created a similar set of dropped components on disk. And, in\nthese cases, the attackers did not re-use their fake digital certificates. In addition to installing\nthe legitimate version of WinRAR, the dropper installed the following StrongPity components:\n\n%temp%\\procexp.exe\n%temp%\\sega\\\nnvvscv.exe\nprst.cab\nprst.dll\nwndplyr.exe\nwrlck cab\n\n\n-----\n\nwrlck.dll\n\nOf these files, two are configurable and encrypted with the same keyless cipher, “wrlck.cab”\nand “prst.cab”. While one maintains several callback c2 for the backdoor to fetch more\ninstructions and upload installed software and file paths, the other maintains something a bit\nmore unusual. “prst.cab” maintains an encrypted list of programs that maintain encrypted\nconnections. This simple encoding takes the most significant nibble for each character,\nswaps the nibbles of that byte, and xors the result against the original value. Its code looks\nsomething like this:\n\nx = s[i];\nj = ((x & 0xF0)>>4);\ny = x ^ j;\n\nUsing that cipher in the ralrab[.]com malware, the package is configured to seek out several\ncrypto-enabled software applications, highlighting the group’s interest in users of more\nencryption-supported software suites.\n\nputty.exe (a windows SSH client)\nfilezilla.exe (supports ftps uploads)\nwinscp.exe (a windows secure copy application, providing encrypted and secure file\ntransfer)\nmstsc.exe (Windows Remote Desktop client, providing an encrypted connection to\nremote systems)\nmRemoteNG.exe (a remote connections manager supporting SSH, RDP, and other\nencrypted protocols)\n\nAlso included in StrongPity components are keyloggers and additional data stealers.\n\n## Conclusion\n\nWidely available, strong cryptography software tools help provide secure and\nprivate communications that are now easily obtained and usable. In the summer of 2016,\nmultiple encryption-enabled software applications were targeted with watering hole, social\nengineering tactics, and spyware by the StrongPity APT. While watering holes and poisoned\ninstallers are tactics that have been effectively used by other APT, we have never seen the\nsame focus on cryptographic-enabled software. When visiting sites and downloading\nencryption-enabled software, it has become necessary to verify the validity of the distribution\nsite and the integrity of the downloaded file itself. Download sites not using PGP or strong\ndigital code signing certificates need to re-examine the necessity of doing so for their own\ncustomers. We have seen other APT such as Crouching Yeti and Darkhotel distribute\npoisoned installers and poisoned executable code, then redistribute them through similar\n\n\n-----\n\ntactics and over p2p networks. Hopefully, simpler verification systems than the current batch\nof PGP and SSL applications will arise to be adopted in larger numbers. Until then, strong\nanti-malware and dynamic allowlisting solutions will be more necessary than ever.\n\n_More information about the StrongPity APT group is available to customers of Kaspersky_\n_Intelligent Services. Contact:_ _[intelreports@kaspersky.com](http://10.10.0.46/mailto:intelreports@kaspersky.com)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-10-03 - On the StrongPity Waterhole Attacks Targeting Italian and Belgian Encryption Users.pdf"
    ],
    "report_names": [
        "2016-10-03 - On the StrongPity Waterhole Attacks Targeting Italian and Belgian Encryption Users.pdf"
    ],
    "threat_actors": [
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67fbc7d7-ba8e-4258-b53c-9a5d755e1960",
            "created_at": "2022-10-25T16:07:24.077859Z",
            "updated_at": "2025-03-27T02:02:10.101173Z",
            "deleted_at": null,
            "main_name": "Promethium",
            "aliases": [
                "APT-C-41",
                "Promethium",
                "StrongPity"
            ],
            "source_name": "ETDA:Promethium",
            "tools": [
                "StrongPity",
                "StrongPity2",
                "StrongPity3",
                "Truvasys"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "cbede712-4cc3-47c6-bf78-92fd9f1beac6",
            "created_at": "2022-10-25T15:50:23.777222Z",
            "updated_at": "2025-03-27T02:00:55.544919Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "PROMETHIUM",
                "StrongPity"
            ],
            "source_name": "MITRE:PROMETHIUM",
            "tools": [
                "Truvasys",
                "StrongPity"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4660477f-333f-4a18-b49b-0b4d7c66d482",
            "created_at": "2023-01-06T13:46:38.511962Z",
            "updated_at": "2025-03-27T02:00:02.852307Z",
            "deleted_at": null,
            "main_name": "PROMETHIUM",
            "aliases": [
                "StrongPity",
                "G0056"
            ],
            "source_name": "MISPGALAXY:PROMETHIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535664,
    "ts_updated_at": 1743041741,
    "ts_creation_date": 1653686781,
    "ts_modification_date": 1653686781,
    "files": {
        "pdf": "https://archive.orkl.eu/8a6e1a8a9a0734be6d175be4b1608714267d8284.pdf",
        "text": "https://archive.orkl.eu/8a6e1a8a9a0734be6d175be4b1608714267d8284.txt",
        "img": "https://archive.orkl.eu/8a6e1a8a9a0734be6d175be4b1608714267d8284.jpg"
    }
}