{
    "id": "74f1ce77-f295-4711-8432-fa3b721c0bb5",
    "created_at": "2022-10-25T16:48:16.237331Z",
    "updated_at": "2025-03-27T02:13:57.335728Z",
    "deleted_at": null,
    "sha1_hash": "e5e69cfd5429be15882d043f1938318d889b9f13",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-07-18T01:41:33Z",
    "file_modification_date": "2019-07-18T01:41:33Z",
    "file_size": 1741207,
    "plain_text": "# EvilGnome: Rare Malware Spying on Linux Desktop Users\n\n**[intezer.com/blog-evilgnome-rare-malware-spying-on-linux-desktop-users](https://www.intezer.com/blog-evilgnome-rare-malware-spying-on-linux-desktop-users/)**\n\nJuly 17, 2019\n\n**Introduction**\n\nLinux desktop remains an unpopular choice among mainstream desktop users, making\nup a little more than [2% of the desktop operating system market share. This is in](https://netmarketshare.com/operating-system-market-share.aspx?options=%7B%22filter%22%3A%7B%22%24and%22%3A%5B%7B%22deviceType%22%3A%7B%22%24in%22%3A%5B%22Desktop%2Flaptop%22%5D%7D%7D%5D%7D%2C%22dateLabel%22%3A%22Trend%22%2C%22attributes%22%3A%22share%22%2C%22group%22%3A%22platform%22%2C%22sort%22%3A%7B%22share%22%3A-1%7D%2C%22id%22%3A%22platformsDesktop%22%2C%22dateInterval%22%3A%22Monthly%22%2C%22dateStart%22%3A%222018-07%22%2C%22dateEnd%22%3A%222019-06%22%2C%22segments%22%3A%22-1000%22%7D)\ncontrast to the web server market share, which consists of [70% of Linux-based operating](https://w3techs.com/technologies/overview/operating_system/all)\nsystems. Consequently, the Linux malware ecosystem is plagued by financial driven\ncrypto-miners and DDoS botnet tools which mostly target vulnerable servers.\n\nThis explains our surprise when in the beginning of July, we discovered a new, fully\nundetected Linux backdoor implant, containing rarely seen functionalities with regards\nto Linux malware, targeting desktop users.\n\nThroughout our investigation, we have found evidence that shows operational\nsimilarities between this implant and Gamaredon Group. We have investigated this\nconnection and in this blog we will present a technical analysis of the tool.\n\nWe have named the implant EvilGnome,for its disguise as a Gnome extension. The\nmalware is currently fully undetected across all major security solutions:\n\nFigure 1: VirusTotal detections of an EvilGnome sample\n\n\n-----\n\nWe believe this is a test version that was uploaded to VirusTotal, perhaps by mistake.\nThe implant contains an unfinished keylogger functionality, comments, symbol names\nand compilation metadata which typically do not appear in production versions.\nEvilGnome’s functionalities include desktop screenshots, file stealing, allowing capturing\naudio recording from the user’s microphone and the ability to download and execute\nfurther modules.\n\n**Gamaredon Group Connection**\n\n[Gamaredon Group is an alleged Russian threat group. It has been active since at least](https://unit42.paloaltonetworks.com/unit-42-title-gamaredon-group-toolset-evolution/)\n2013, and has targeted individuals likely involved with the Ukrainian government.\nGamaredon Group infects victims using malicious attachments, delivered via\nspear phishing techniques. The group’s implants are characterized by the employment of\ninformation stealing tools—among them being screenshot and document stealers\ndelivered via a SFX, and made to achieve persistence through a scheduled task.\nGamaredon Group primarily makes use of Russian hosting providers in order to\ndistribute its malware.\n\nOur investigation into EvilGnome yielded several similarities between the threat actors\nbehind EvilGnome and Gamaredon Group:\n\n**Hosting Similarities**\n\nThe operators of EvilGnome use a hosting provider that has been used by Gamaredon\nGroup for years, and continues to be used by the group.\n\nMore specifically, EvilGnome’s C2 IP address (195.62.52.101) was resolved two months\nago by the domains gamework.ddns.net and workan.ddns.net, [associated with the](https://x.threatbook.cn/nodev4/vb4/article?threatInfoID=1417)\nGamaredon Group:\n\nFigure 2: RiskIQ EvilGnome C2 IP query\n\nWe used [RiskIQ to map the history of the gamework.ddns.net domain:](https://community.riskiq.com/search/gamework.ddns.net)\n\n\n-----\n\nFigure 3: gamework.ddns.net DNS timeline\n\nThe finding shows that EvilGnome operates on an IP address that was controlled by the\nGamaredon group two months ago.\n\n**Infrastructure Similarities**\n\nWhile investigating the EvilGnome C2, we observed that it served SSH over port 3436.\n\nWe then checked for the 3436 port over three currently operating Gamaredon Group C2\nservers, and found one server with this port open, serving SSH:\n\nFigure 4: SSH served on port 3436 both on EvilGnome C2 and Gamaredon’s rnboua.ddns.net\n\nWe proceeded to scan for this network fingerprint under EvilGnome’s host provider and\nwe identified two additional servers with domain names similar to the naming pattern of\nGamaredon domains (the use of the .space TTLD and ddns):\n\n185.158.115.44 -> [kotl.space](https://community.riskiq.com/search/kotl.space)\n185.158.115.154 -> [clsass.ddns.net](https://community.riskiq.com/search/clsass.ddns.net)\n\n**Tool Similarities**\n\n\n-----\n\nGamaredon Group does not use any known Linux implants. It is difficult to make\ncomparisons between tools built for different operating systems because they are\ndeveloped with different challenges and objectives in mind. We can, however, observe\nsimilarities at a high-level. The techniques and modules employed by EvilGnome—that\nis the use of SFX, persistence with task scheduler and the deployment of information\nstealing tools—remind us of Gamaredon Group’s Windows tools. We present a thorough\nanalysis of EvilGnome in the following section.\n\n**Technical Analysis**\n\n**Deployment with Makeself SFX**\n\nThis implant is delivered in the form of a self-extracting archive shell script created with\n[makeself:](https://github.com/megastep/makeself)\n\n[“makeself.sh is a small shell script that generates a self-extractable compressed](http://makeself.io/)\ntar archive from a directory. The resulting file appears as a shell script (many of\nthose have a .run suffix), and can be launched as is. The archive will then\nuncompress itself to a temporary directory and an optional arbitrary command will\nbe executed (for example an installation script). This is pretty similar to archives\ngenerated with WinZip Self-Extractor in the Windows world.”\n\nInterestingly, the tool’s operator did not omit metadata from the generated makeself SFX.\nThe packaging date, development paths and the tool’s filename were all left exposed.\nWe can observe that the sample is very recent, created on Thursday, July 4:\n\nFigure 5: Makeself packaging metadata and the archived files’ metadata\n\nAs can be observed in the illustration above, the makeself script is instructed to run\n_./setup.sh after unpacking._\n\nUsing makeself’s options, we are able to instruct the script to unpack itself without\nexecuting:\n\n\n-----\n\nFigure 6: Unpacking Makeself\n\nThe archive contains four files:\n\n1. gnome-shell-ext – the spy agent executable\n2. gnome-shell-ext.sh – checks if gnome-shell-ext is already running and if not,\n\nexecutes it\n3. rtp.dat– configuration file for gnome-shell-ext\n4. setup.sh – the setup script that is run by makeself after unpacking\n\nThe setup script installs the agent to ~/.cache/gnome-software/gnome-shell**extensions/, in an attempt to masquerade itself as a Gnome shell extension. Gnome**\nshell extensions allow tweaking the Gnome desktop and add functionalities. They are\nthe desktop equivalent to browser extensions.\n\nPersistence is achieved by registering gnome-shell-ext.sh to run every minute in\ncrontab.\n\nFinally, the script executes gnome-shell-ext.sh, which in turn launches the main\nexecutable gnome-shell-ext:\n\nFigure 7: setup.sh\n\n**The Spy Agent**\n\nAnalyzing the agent with Intezer Analyze demonstrated to us that the code was never\nseen before by the system:\n\n\n-----\n\nFigure 8: [Intezer Analyze report of the Spy Agent sample](https://analyze.intezer.com/#/analyses/8db39fae-8f82-42b2-9816-b353a7dbb16b)\n\nThis large amount of unique genes located within this file is not a trend we regularly see\nin Linux files and therefore it seems suspicious.\n\nThe Spy Agent was built in C++, using classes with an object oriented structure. The\nbinary was not stripped, which allowed us to read symbols and understand the\ndeveloper’s intentions.\n\nAt launch, the agent forks to run in a new process. The agent then reads the\n_rtp.dat configuration file and loads it directly into memory:_\n\nFigure 9: Loading configuration from rtp.dat\n\nWe marked interesting fields within the configuration file:\n\nFigure 10: Configuration dissection\n\nThe first four bytes are a hexadecimal representation of the C2’s IP address:\n\n\n-----\n\n0x65343ec3 -> 0xc3.0x3e.0x34.0x65 -> 195.62.52.101\n\n**Modules**\n\nThe spy agent contains five modules called “Shooters”:\n\nFigure 11: “Shooter” modules\n\n**ShooterSound – captures audio from the user’s microphone and uploads to C2**\n\n**ShooterImage – captures screenshots and uploads to C2**\n\n**ShooterFile – scans the file system for newly created files and uploads them to C2**\n\n**ShooterPing – receives new commands from C2**\n\n**ShooterKey – unimplemented and unused, most likely an unfinished keylogging module**\n\nEach module is run in a separate thread, and access to shared resources (such as the\nconfiguration) is safeguarded by mutexes.\n\nThe modules encrypt their output and decrypt data from the C2 with RC5 with the key\n“sdg62_AS.sa$die3”, using a modified version of a Russian open source library\n[https://webhamster.ru/site/page/index/articles/projectcode/157:](https://webhamster.ru/site/page/index/articles/projectcode/157)\n\nFigure 12: RC5 library\n\n\n-----\n\nOn connection failure, or if instructed by the C2, these modules store their output at\n**~/.cache/gnome-software/gnome-shell-extensions/tmp/:**\n\nFigure 13: Stored files\n\nWe will now dive into each of the five modules and their options:\n\n**ShooterPing**\n\nThe ShooterPing module processes commands received from the C2:\n\nFigure 14: C2 commands\n\nThese include:\n\nDownload & execute new files\nSet new filters for file scanning\nDownload & set new runtime\nconfiguration\nExfiltrate stored output to C2\nStop the shooter modules from running\n\nThe other modules run at a constant interval between each run, as defined by one of the\nconfiguration parameters. The C2 is able to control this interval via downloading new\nparameters through ShooterPing.\n\n**ShooterFile**\n\nThe ShooterFile module uses a filter list to scan the filesystem, while ignoring specific\nfiles and folders as shown in the following illustration:\n\n\n-----\n\nFigure 15: File scanning filter\n\nWe can see from the filter_accepted_files list that the agent’s purpose is to steal\ndocument related files. However, the list is not used by the malware and further indicates\nthat this is a work in progress.\n\n**ShooterAudio**\n\nFigure 16: Capturing audio with PulseAudio\n\nThe ShooterAudio module uses PulseAudio to capture audio from the user’s\nmicrophone.\n\n\n-----\n\nUsing default configuration from rtp.dat, the module records only a size of 80,000 bytes\nof audio per iteration. Consequently, the module only records audio for a brief moment,\nmaking this module non-functional until a larger recording size is set by the C2.\n\n**ShooterImage**\n\nThis module opens a connection to the XOrg Display Server, which is the backend to the\nGnome desktop. It uses the Cairo open source library to take screenshots of the user’s\ndesktop.\n\nFigure 17: Screenshot capturing using XOrg Server\n\n**Prevention and Response**\n\nWe recommend to Linux users who want to check whether they are infected to check the\n“~/.cache/gnome-software/gnome-shell-extensions” directory for the “gnome-shell-ext”\n[executable. We have also created a customYARA rule, based on code reuse technology,](https://github.com/intezer/yara-rules/blob/master/EvilGnome.yar)\nfor detecting future variants of EvilGnome.\n\n**Conclusion**\n\nEvilGnome is a rare type of malware due to its appetite for Linux desktop users.\nThroughout this post, we have presented detailed infrastructure-related evidence to\nconnect EvilGnome to the actors behind the Gamaredon Group. We believe this is a\npremature test version. We anticipate newer versions to be discovered and reviewed in\nthe future, which could potentially shed more light into the group’s operations.\n\n**Genetic Analysis**\n\nThe EvilGnome malware variant is now indexed in Intezer’s genetic database. If you\nhave a suspicious file that you suspect to be EvilGnome, you can upload it to Intezer\nAnalyze in order to detect code reuse to this threat family and many others. You are\n[welcome totry it for free in our community edition.](https://analyze.intezer.com/#/)\n\n\n-----\n\nFigure 18: [Intezer Analyze report of the Spy Agent sample](https://analyze.intezer.com/#/analyses/eeec2273-82ac-4190-b434-8ffb304deeef)\n\n**IOCs**\n\n**EvilGnome:**\n\na21acbe7ee77c721f1adc76e7a7799c936e74348d32b4c38f3bf6357ed7e8032\n\n82b69954410c83315dfe769eed4b6cfc7d11f0f62e26ff546542e35dcd7106b7\n\n7ffab36b2fa68d0708c82f01a70c8d10614ca742d838b69007f5104337a4b869\n\n195.62.52[.]101\n\n**Gamaredon Group:**\n\n185.158.115[.]44\n\n185.158.115[.]154\n\nclsass.ddns[.]net\n\nkotl[.]space\n\nBy Paul Litvak\nPaul is a malware analyst and reverse engineer at Intezer. He previously served as a\ndeveloper in the Israel Defense Force (IDF) Intelligence Corps for three years.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.07.17.EvilGnome/EvilGnome_%20Rare%20Malware%20Spying%20on%20Desktop%20Users.pdf"
    ],
    "report_names": [
        "EvilGnome_ Rare Malware Spying on Desktop Users"
    ],
    "threat_actors": [
        {
            "id": "81bd7107-6b2d-45c9-9eea-1843d4b9b308",
            "created_at": "2022-10-25T15:50:23.320841Z",
            "updated_at": "2025-03-27T02:00:55.441723Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Gamaredon Group",
                "IRON TILDEN",
                "Primitive Bear",
                "ACTINIUM",
                "Armageddon",
                "Shuckworm",
                "DEV-0157",
                "Aqua Blizzard"
            ],
            "source_name": "MITRE:Gamaredon Group",
            "tools": [
                "QuietSieve",
                "Pteranodon",
                "PowerPunch"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d5156b55-5d7d-4fb2-836f-861d2e868147",
            "created_at": "2023-01-06T13:46:38.557326Z",
            "updated_at": "2025-03-27T02:00:02.861124Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Aqua Blizzard",
                "Actinium",
                "DEV-0157",
                "Blue Otso",
                "G0047",
                "PRIMITIVE BEAR",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder",
                "ACTINIUM",
                "BlueAlpha",
                "IRON TILDEN"
            ],
            "source_name": "MISPGALAXY:Gamaredon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61940e18-8f90-4ecc-bc06-416c54bc60f9",
            "created_at": "2022-10-25T16:07:23.659529Z",
            "updated_at": "2025-03-27T02:02:09.912404Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Actinium",
                "Aqua Blizzard",
                "Armageddon",
                "Blue Otso",
                "BlueAlpha",
                "Callisto",
                "DEV-0157",
                "Iron Tilden",
                "Operation STEADY#URSA",
                "Primitive Bear",
                "SectorC08",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder"
            ],
            "source_name": "ETDA:Gamaredon Group",
            "tools": [
                "Aversome infector",
                "BoneSpy",
                "DessertDown",
                "DilongTrash",
                "DinoTrain",
                "EvilGnome",
                "FRAUDROP",
                "Gamaredon",
                "GammaDrop",
                "GammaLoad",
                "GammaSteel",
                "Gussdoor",
                "ObfuBerry",
                "ObfuMerry",
                "PlainGnome",
                "PowerPunch",
                "Pteranodon",
                "Pterodo",
                "QuietSieve",
                "Remote Manipulator System",
                "Resetter",
                "RuRAT",
                "SUBTLE-PAWS",
                "UltraVNC"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "236a8303-bf12-4787-b6d0-549b44271a19",
            "created_at": "2024-06-04T02:03:07.966137Z",
            "updated_at": "2025-03-27T02:05:17.410356Z",
            "deleted_at": null,
            "main_name": "IRON TILDEN",
            "aliases": [
                "Aqua Blizzard ",
                "Armageddon",
                "Blue Otso ",
                "BlueAlpha ",
                "Dancing Salome ",
                "Gamaredon",
                "Gamaredon Group",
                "Hive0051 ",
                "Primitive Bear ",
                "Shuckworm ",
                "Trident Ursa ",
                "UAC-0010 ",
                "UNC530 ",
                "WinterFlounder ",
                "ACTINIUM "
            ],
            "source_name": "Secureworks:IRON TILDEN",
            "tools": [
                "Pterodo"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041637,
    "ts_creation_date": 1563414093,
    "ts_modification_date": 1563414093,
    "files": {
        "pdf": "https://archive.orkl.eu/e5e69cfd5429be15882d043f1938318d889b9f13.pdf",
        "text": "https://archive.orkl.eu/e5e69cfd5429be15882d043f1938318d889b9f13.txt",
        "img": "https://archive.orkl.eu/e5e69cfd5429be15882d043f1938318d889b9f13.jpg"
    }
}