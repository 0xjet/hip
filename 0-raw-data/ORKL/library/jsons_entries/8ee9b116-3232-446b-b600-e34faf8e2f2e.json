{
    "id": "8ee9b116-3232-446b-b600-e34faf8e2f2e",
    "created_at": "2022-10-25T16:48:20.663598Z",
    "updated_at": "2025-03-27T02:16:59.210722Z",
    "deleted_at": null,
    "sha1_hash": "c0017fe5d8637b3848db4e8783cb05aeefd152ca",
    "title": "Breaking The Weakest Link Of The Strongest Chain",
    "authors": "Kaspersky",
    "file_creation_date": "2017-03-07T02:52:37Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 343485,
    "plain_text": "# g g\n\n**[securelist.com /blog/incidents/77562/breaking-the-weakest-link-of-the-strongest-chain/](https://securelist.com/blog/incidents/77562/breaking-the-weakest-link-of-the-strongest-chain/)**\n\nAround July last year, more than a 100 Israeli servicemen were hit by a cunning threat actor. The attack compromised their\ndevices and exfiltrated data to the attackers’ command and control server. In addition, the compromised devices were\npushed Trojan updates, which allowed the attackers to extend their capabilities. The operation remains active at the time of\nwriting this post, with attacks reported as recently as February 2017.\n\nThe campaign, which experts believe is still in its early stages, targets Android OS devices. Once the device is\ncompromised, a process of sophisticated intelligence gathering starts, exploiting the ability to access the phone’s video and\naudio capabilities, SMS functions and location.\n\nThe campaign relies heavily on social engineering techniques, leveraging social networks to lure targeted soldiers into both\nsharing confidential information and downloading the malicious applications.\n\nCharacterized by relatively unsophisticated technical merit, and extensive use of social engineering, the threat actor targets\nonly IDF soldiers.\n\nIDF C4I & the IDF Information Security Department unit, with Kaspersky Lab researchers, have obtained a list of the victims;\namong them IDF servicemen of different ranks, most of them serving around the Gaza strip.\n\n## Attack Flow\n\nThe operation follows the same infection flow across the different victims:\n\n_Figure 1: Campaign’s attack flow_\n\n## Social Engineering\n\nThe threat actor uses social engineering to lure targets into installing a malicious application, while continuously attempting\nto acquire confidential information using social networks. We’ve seen a lot of the group’s activity on Facebook Messenger.\nMost of the avatars (virtual participants in the social engineering stage) lure the victims using sexual innuendo, e.g. asking\nthe victim to send explicit photos, and in return sending fake photos of teenage girls. The avatars pretend to be from\n\n\n-----\n\nAfter the victim downloads the APK file from the malicious URL, the attacker expects the victim to install the package\nmanually. The dropper requires common user permissions as shown in the following screenshot.\n\n_Figure 2: Dropper permissions once installed on a victim mobile device_\n\n### Key features\n\nThe dropper relies on the configuration server which uses queries in order to download the best fitting payload for the\nspecified device.\n\nDownloader & Watchdog of the main payload\n\nPayload update mechanism\n\nCustomized payload – the dropper sends a list of installed apps, and receives a payload package based on it\n\nObfuscation – The dropper package is obfuscated using ProGuard, which is an open source code obfuscator and\nJava optimizer, observed in the LoveSongs dropper.\n\n### Network Protocols\n\nThe network protocol between the dropper and the configuration server is based on HTTP POST requests. The following\nservers implement a RESTful API:\n\nLoveSongs – http://endpointup[.]com/update/upfolder/updatefun.php\n\nYeeCall, WowoMessanger – http://droidback[.]com/pockemon/squirtle/functions.php\n\n_Figure 3: Communication with C&C server over HTTP_\n\nMost of the communication with the server is in clear-text, except for specific commands which are encrypted using an AES128 hard coded-key.\n\n\n-----\n\n_Figure 4: WowoMessanger REST-API POST packet capture_\n\n_Figure 5: Fake WowoMessanger app – logic flow_\n\nAlong with an ID existence check, the dropper sends a list of the device’s installed apps – if it hasn’t done so already.\n\nThe flow between different variants of the dropper is similar, with minor changes. One variant pretends to be a YouTube\nplayer, while others are chat apps:\n\nLoveSongs has YouTube player functionality, whereas WowoMessanger does not have any legitimate functionality\nwhatsoever; it erases its icon after the first run.\n\n## Payload\n\nThe payload is installed after one of the droppers mentioned above has been downloaded and executed on the victim\ndevice. The only payload we have seen so far is “WhatsApp_Update”.\n\nThe payload is capable of two collection mechanisms:\n\nExecute “On demand” commands – manual commands that are triggered by the operator\n\n\n-----\n\n## C&C Commands\n\nThe payload uses the WebSocket protocol, which gives the attacker a real-time interface to send commands to the payload\nin a way that resembles ‘reverse shell’. Some of the commands are not yet implemented (as shown in the table below). The\ncommands gives the operator basic yet dangerous RAT capabilities:\n\nCollect general information about the device e.g. Network operator, GPS location, IMEI etc.\n\nOpen a browser and browse to a chosen URL\n\nRead & send SMS messages, and access contacts\n\nEavesdrop at a specific time and period\n\nTake pictures (using the camera) or screenshots\n\nRecord video and audio.\n\n**COLL_AUDIO_RECORDS** **COLL_CALL_RECORDS** **GET_LOCATION** **CHECK_AVAILABILITY**\n\n**OPEN_WEBPAGE** **GET_IMAGE** **GET_DEVICE_INFO** **COLL_CAPTURED_PHOTOS**\n\n**GET_TELEPHONY_INFO** **GET_CELLS_INFO** **TAKE_SCREENSHOT** **CALL_PHONE**\n\n**GET_SEC_GALL_CACHE** **GET_SMS** **SEND_SMS** **GET_CONTACTS**\n\nGET_BOOKMARKS TAKE_BACK_PIC **CHANGE_AUDIO_SOURCE** **RECORD_AUDIO**\n\nGET_SEARCHES CLOSE_APP GET_HISTORY OPEN_APP\n\nGET_CALENDER_EVENTS RESTART GET_USER_DICTIONARY SHUTDOWN\n\nUNINSTALL_APP GET_ACCOUNTS INSTALL_APK GET_INSTALLED_APPS\n\nGET_WHATSAPP_KEY RECORD_FRONT_VIDEO GET_WHATSAPP_BACKUP GET_FILE\n\nGET_CALLS GET_ROOT_STATUS TAKE_FRONT_PIC RECORD_BACK_VIDEO\n\nINVALID_COMMAND REMOVE_FILE\n\n*Commands which were implemented are in bold.\n\n## Scheduled Process\n\nBesides the C&C commands, the payload periodically collects data using various Android APIs. The default time interval is\n30 seconds. The process collects the following data:\n\nGeneral data about the device (as mentioned in the C&C command)\n\nSMS messages, WhatsApp database along with the encryption key (requires root permissions which is not yet fully\nimplemented)\n\nBrowsing & search history along with bookmarks\n\nDocuments and archives ( < 2MB ) found in storage (doc, docx, ppt, rar, etc)\n\nPictures taken, auto captures while on an active call\n\nList of contacts and call logs\n\nRecords calls and eavesdrops\n\n\n-----\n\nautomatic call recording feature is implemented entirely using Android s API.\n\n_Figure 6: Call-Recording implementation in WhatsApp_update_\n\n## Conclusions\n\nThe IDF, which led the research along with Kaspersky Lab researchers, has concluded that this is only the opening shot of\nthis operation. Further, that it is by definition a targeted attack against the Israeli Defense Force, aiming to exfiltrate data on\nhow ground forces are spread, which tactics and equipment the IDF is using and real-time intelligence gathering.\n\nKaspersky Lab GReAT researchers will disclose more behind-the-scenes details of the operation at the upcoming Security\nAnalyst Summit.\n\n## IOCs\n\n### Domain names & APK hashes\n\nandroidbak[.]com\ndroidback[.]com\nendpointup[.]com\nsiteanalysto[.]com\ngoodydaddy[.]com\n10f27d243adb082ce0f842c7a4a3784b01f7248e\nb8237782486a26d5397b75eeea7354a777bff63a\n09c3af7b0a6957d5c7c80f67ab3b9cd8bef88813\n9b923303f580c999f0fdc25cad600dd3550fe4e0\n0b58c883efe44ff010f1703db00c9ff4645b59df\n0a5dc47b06de545d8236d70efee801ca573115e7\n782a0e5208c3d9e8942b928857a24183655e7470\n5f71a8a50964dae688404ce8b3fbd83d6e36e5cd\n03b404c8f4ead4aa3970b26eeeb268c594b1bb47\n\n### Certificates – SHA1 fingerprints\n\n10:EB:7D:03:2A:B9:15:32:8F:BF:68:37:C6:07:45:FB:DF:F1:87:A6\n9E:52:71:F3:D2:1D:C3:22:28:CB:50:C7:33:05:E3:DE:01:EB:CB:03\n44:52:E6:4C:97:4B:6D:6A:7C:40:AD:1E:E0:17:08:33:87:AA:09:09\n\n\n-----\n\nB4:D5:0C:8B:73:CB:A9:06:8A:B3:F2:49:35:F8:58:FE:A2:3E:2E:3A\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/wlwdugbbup1g3kb0ol71eh74qo6e67pd"
    ],
    "report_names": [
        "Kaspersky_Breaking-Weakest-Link-IDF(02-16-2017)"
    ],
    "threat_actors": [
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1666716500,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1488855157,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/c0017fe5d8637b3848db4e8783cb05aeefd152ca.pdf",
        "text": "https://archive.orkl.eu/c0017fe5d8637b3848db4e8783cb05aeefd152ca.txt",
        "img": "https://archive.orkl.eu/c0017fe5d8637b3848db4e8783cb05aeefd152ca.jpg"
    }
}