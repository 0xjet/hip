{
    "id": "5cdad5b3-81dc-4cae-9186-cf6bff1bea04",
    "created_at": "2023-01-12T15:07:26.453923Z",
    "updated_at": "2025-03-27T02:05:43.170725Z",
    "deleted_at": null,
    "sha1_hash": "9143acd1a832ff81a63c4a8eb0f6d189f0b7c8b1",
    "title": "2021-03-08 - SUPERNOVA Web Shell Deployment Linked to SPIRAL Threat Group",
    "authors": "",
    "file_creation_date": "2022-05-28T18:16:49Z",
    "file_modification_date": "2022-05-28T18:16:49Z",
    "file_size": 608454,
    "plain_text": "# SUPERNOVA Web Shell Deployment Linked to SPIRAL Threat Group\n\n**[secureworks.com/blog/supernova-web-shell-deployment-linked-to-spiral-threat-group](https://www.secureworks.com/blog/supernova-web-shell-deployment-linked-to-spiral-threat-group)**\n\nCounter Threat Unit Research Team\n\n\n-----\n\nIn late 2020, Secureworks Counter Threat Unit™ (CTU) researchers observed a threat\nactor exploiting an internet-facing SolarWinds server to deploy the SUPERNOVA web shell.\nAdditional analysis revealed similarities to intrusion activity identified on the same network\nearlier in 2020, suggesting the two intrusions are linked. CTU™ researchers attribute the\nintrusions to the SPIRAL threat group. Characteristics of the activity suggest the group is\nbased in China.\n\n## SPIRAL threat group’s SUPERNOVA deployment\n\nDuring a November 2020 incident response engagement, Secureworks analysts observed a\nthreat actor exploiting a vulnerability in the SolarWinds Orion Platform to deliver the\n[SUPERNOVA web shell. CTU analysis indicates that this activity is unrelated to the](https://us-cert.cisa.gov/ncas/analysis-reports/ar21-027a)\n[SUNBURST supply chain attack that trojanized the SolarWinds Orion business software](https://www.solarwinds.com/securityadvisory#anchor1)\nupdates. CTU researchers attribute the SUPERNOVA activity to the SPIRAL espionage\ngroup.\n\nThe threat actor exploited a SolarWinds Orion API authentication bypass vulnerability (CVE2020-10148) to execute a reconnaissance script and then write the SUPERNOVA web shell\nto disk (see Figure 1).\n\n_Figure 1. Sample HTTP POST requests sent to the SolarWinds server and corresponding_\n_commands executed on the host. (Source: Secureworks)_\n\nThe reconnaissance script consisted of a series of commands concatenated using “&”. The\nscript wrote the output to C:\\inetpub\\SolarWinds\\license.txt (see Figure 2).\n\n\n-----\n\n_Figure 2. Reconnaissance script executed by exploiting CVE-2020-10148. (Source:_\n_Secureworks)_\n\nThe SUPERNOVA web shell was written to disk using a PowerShell command (see Figure\n3). SUPERNOVA is written in .NET C# and is a trojanized version of the legitimate DLL\n(app_web_logoimagehandler.ashx.b6031896.dll) used by the SolarWinds Orion Platform.\n\n_Figure 3. Threat actor writing the SUPERNOVA web shell to disk. (Source: Secureworks)_\n\nThe attacker interacted with the SUPERNOVA web shell to conduct additional\nreconnaissance activity using net, dir, and whoami commands. The threat actor obtained\n[credentials by dumping the content of the LSASS process using the legitimate comsvcs.dll](https://www.ired.team/offensive-security/credential-access-and-credential-dumping/dump-credentials-from-lsass-process-without-mimikatz)\nlibrary (see Figure 4). The output of this process dump was also piped to the license.txt file,\nwhich the attacker subsequently retrieved and then deleted from disk.\n\n_Figure 4. LSASS process dumped using comsvcs.dll library. (Source: Secureworks)_\n\nThe threat actor then mapped network shares on two hosts: a domain controller and a server\nthat could provide access to sensitive business information. The immediate and targeted\nnature of the lateral movement suggests that SPIRAL had prior knowledge of the network.\nIntervention and remediation by Secureworks incident responders blocked additional\nmalicious activity.\n\n## Similarities to previous intrusion activity\n\nEarlier in 2020, Secureworks incident responders identified intrusion activity on the same\nnetwork. Analysis suggested that the threat actor initially gained access as early as 2018 by\nexploiting a vulnerable public-facing ManageEngine ServiceDesk server. The attacker used\nthe access to periodically harvest and exfiltrate domain credentials. In August 2020, the\nthreat actor returned to the network via the ManageEngine ServiceDesk server, harvested\n\n\n-----\n\ncredentials from two servers (see Figure 5), likely exfiltrated these credentials through the\nManageEngine server, and then used them to access files from Office 365-hosted\nSharePoint and OneDrive services.\n\n_Figure 5. Threat actor running ntdsutil to dump the Active Directory database containing_\n_domain credentials. (Source: Secureworks)_\n\nCTU researchers were initially unable to attribute the August activity to any known threat\ngroups. However, the following similarities to the SPIRAL intrusion in late 2020 suggest that\nthe SPIRAL threat group was responsible for both intrusions:\n\nThe threat actors used identical commands to dump the LSASS process via\ncomsvcs.dll and used the same output file path (see Figure 6).\n\n_Figure 6. LSASS process dump from August 2020 using an identical command to the_\n_November 2020 incident. (Source: Secureworks)_\n\nThe same two servers were accessed: a domain controller and a server that could\nprovide access to sensitive business data.\nThe same ‘c:\\users\\public’ path (all lowercase) was used as a working directory.\nThree compromised administrator accounts were used in both intrusions.\n\n## Connections to China?\n\nCTU researchers have associated Chinese threat groups with network intrusions involving\nthe targeting of ManageEngine servers, maintenance of long-term access to periodically\nharvest credentials and exfiltrate data, and espionage or theft of intellectual property.\nAlthough SPIRAL activity shares these characteristics, the characteristics are insufficient for\nattributing SPIRAL’s country of origin. However, an additional characteristic of the August\n2020 intrusion strengthens the Chinese connection.\n\nA Secureworks endpoint detection and response (EDR) agent checked in from a host that\ndid not belong to the compromised organization and used an IP address geolocated to\nChina. The naming convention of this host was the same as another host used by the threat\nactor to connect to the network via a VPN connection. This ‘<Username>-PC’ naming\n[convention is the default hostname for a Windows 7 host, but it is not the victim’s standard](https://social.technet.microsoft.com/wiki/contents/articles/2713.changing-computer-name-in-windows-7.aspx)\n\n\n-----\n\nnaming convention for hosts. CTU analysis suggests the threat group likely downloaded the\nendpoint agent installer from the network and executed it on the attacker-managed\ninfrastructure. The exposure of the IP address was likely unintentional, so its geolocation\nsupports the hypothesis that the SPIRAL threat group operates out of China.\n\n## Conclusion\n\nSimilarities between SUPERNOVA-related activity in November and activity that CTU\nresearchers analyzed in August suggest that the SPIRAL threat group was responsible for\nboth intrusions. Characteristics of these intrusions indicate a possible connection to China.\n\nThe abuse of vulnerabilities in both intrusions reinforces the importance of applying security\nupdates as soon as possible. However, network breaches can occur even with preventative\nmeasures in place. Organizations should consider implementing an EDR solution for realtime network monitoring and alerting. CTU researchers also advise organizations to prepare\nand test a robust incident response plan.\n\nAttribution is difficult, and members of the security community often have varying insights\nand perspectives. To facilitate information sharing, the CTU research team has published\n[threat group profiles since](https://www.secureworks.com/research/threat-profiles/) [May 2020. Fostering discussion within the community can lead to](https://www.secureworks.com/blog/counter-threat-unit-researchers-publish-threat-group-definitions)\na better understanding of the threats. CTU researchers welcome insights about the SPIRAL\n[threat group and its activity (threatgroupfeedback@secureworks.com).](http://10.10.0.46/mailto:threatgroupfeedback@secureworks.com)\n\n## Threat indicators\n\nTo mitigate exposure to this threat, CTU researchers recommend that organizations use\navailable controls to review and restrict access using the indicators listed in Table 1. Note\nthat IP addresses can be reallocated. The IP addresses may contain malicious content, so\nconsider the risks before opening them in a browser.\n\nIndicator Type Context\n\n\n24.59.231.58 IP\naddress\n\n24.59.231.62 IP\naddress\n\n24.59.231.60 IP\naddress\n\n24.59.231.61 IP\naddress\n\n\nSPIRAL C2 server\n\nSPIRAL C2 server\n\nSPIRAL C2 server\n\nSPIRAL C2 server\n\n\n-----\n\nIndicator Type Context\n\n\n24.59.231.59 IP\naddress\n\n23.236.125.20 IP\naddress\n\n76.237.140.245 IP\naddress\n\n117.21.187.144 IP\naddress\n\n56ceb6d0011d87b6e4d7023d7ef85676 MD5\nhash\n\n75af292f34789a1c782ea36c7127bf6106f595e8 SHA1\nhash\n\n\nc15abaf51e78ca56c0376522d699c978217bf041a3bd3\n\nc71d09193efa5717c71\n\n_Table 1. Indicators for this threat._\n\n\nSHA256\nhash\n\n\nSPIRAL C2 server\n\nSPIRAL C2 server\n\nSPIRAL C2 server\n\nSPIRAL infrastructure\nlocated in China\n\nSUPERNOVA web\nshell delivered\nfollowing exploitation\nof SolarWinds via\nCVE-2020-10148\n\nSUPERNOVA web\nshell delivered\nfollowing exploitation\nof SolarWinds via\nCVE-2020-10148\n\nSUPERNOVA web\nshell delivered\nfollowing exploitation\nof SolarWinds via\nCVE-2020-10148\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-08 - SUPERNOVA Web Shell Deployment Linked to SPIRAL Threat Group.pdf"
    ],
    "report_names": [
        "2021-03-08 - SUPERNOVA Web Shell Deployment Linked to SPIRAL Threat Group.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536046,
    "ts_updated_at": 1743041143,
    "ts_creation_date": 1653761809,
    "ts_modification_date": 1653761809,
    "files": {
        "pdf": "https://archive.orkl.eu/9143acd1a832ff81a63c4a8eb0f6d189f0b7c8b1.pdf",
        "text": "https://archive.orkl.eu/9143acd1a832ff81a63c4a8eb0f6d189f0b7c8b1.txt",
        "img": "https://archive.orkl.eu/9143acd1a832ff81a63c4a8eb0f6d189f0b7c8b1.jpg"
    }
}