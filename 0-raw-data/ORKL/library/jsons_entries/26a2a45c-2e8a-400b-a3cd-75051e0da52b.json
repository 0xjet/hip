{
    "id": "26a2a45c-2e8a-400b-a3cd-75051e0da52b",
    "created_at": "2023-01-12T15:08:32.559395Z",
    "updated_at": "2025-03-27T02:09:29.847452Z",
    "deleted_at": null,
    "sha1_hash": "804018bb304cca6e327b550d59ea9ef744503dd9",
    "title": "2022-04-04 - Ransomware Spotlight- AvosLocker",
    "authors": "",
    "file_creation_date": "2022-05-28T18:15:53Z",
    "file_modification_date": "2022-05-28T18:15:53Z",
    "file_size": 868360,
    "plain_text": "# Ransomware Spotlight: AvosLocker\n\n**[trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-avoslocker](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-avoslocker)**\n\nX\n\nAvosLocker\n\nBy Trend Micro Research\n\nAvosLocker is a relatively new ransomware variant that sports the staples of modern ransomware, namely a layered extortion scheme that\nbegins with stolen data. We shed light on this emerging ransomware family and its key techniques.\n\n\n-----\n\nView infographic of \"Ransomware Spotlight: AvosLocker\"\n\n[AvosLocker is one of the newer ransomware families that came to fill the void left by](https://www.trendmicro.com/vinfo/us/security/definition/ransomware) [REvil. While not as prominent or active as LockBit or](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-revil)\n[Conti, it is slowly making a name for itself, with the US Federal Bureau of Investigation (FBI) releasing an advisory on this threat. According to](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-conti)\nthe report, AvosLocker has been targeting critical infrastructure in different sectors of the US, with attacks also observed in other countries like\nCanada, UK, and Spain. Although detections are low, its clever use of familiar tactics makes it a ransomware variant worth monitoring today.\n\n## What do organizations need to know about AvosLocker?\n\n[AvosLocker is another variant that runs on a ransomware-as-a-service (RaaS) model. It was first spotted in July 2021 and has since come up](https://www.trendmicro.com/vinfo/us/security/definition/ransomware-as-a-service-raas)\nwith several variants released over time. The following are the key characteristics of AvosLocker:\n\n**It uses the remote administration tool AnyDesk. One of the notable characteristics of AvosLocker campaigns is its use of AnyDesk, a**\nremote administration tool (RAT) to connect to victim machines. Using this tool, the operator can manually operate and infect the\nmachine.\n**It runs on safe mode. Another key element of AvosLocker is running itself on safe mode as part of its evasion tactics. The attacker**\nrestarts the machine, disables certain drivers, and runs on safe mode, thus avoiding certain security measures that are unable to run in\nthis mode. Operators also set up certain drivers to make sure that AnyDesk would run even in safe mode. It is important to note that this\nwas a tactic previously employed by the now defunct REvil.\n**Operators auction stolen data. AvosLocker again takes a leaf from REvil’s page by auctioning stolen data on its site, on top of its**\n[double extortion scheme. This could be the group’s way of further monetizing a single successful attack or salvaging a failed one.](https://www.trendmicro.com/vinfo/us/security/news/cybercrime-and-digital-threats/ransomware-double-extortion-and-beyond-revil-clop-and-conti)\n\nAs mentioned, AvosLocker operators have also released multiple versions of this ransomware. The tactic of running itself on safe mode was\nseen in the second version of AvosLocker. Following the trend of targeting Linux machines, AvosLocker also released a Linux variant as\n[advertised by the group on October 2021. This variant is capable of attacking ESXi virtual machines (VMs), which makes it a variant to watch](https://www.bleepingcomputer.com/news/security/linux-version-of-avoslocker-ransomware-targets-vmware-esxi-servers/)\nout for.\n\nOperating as an RaaS, the actors behind AvosLocker conduct reconnaissance before each campaign. Actors choose their targets based on\ntheir ability to pay the demanded ransom and tailor their attacks accordingly.\n\nIn the next sections, we look at which regions and industries the group has targeted most often, based on our detections and information from\ntheir leak site.\n\n## Top affected industries and countries\n\n\n-----\n\nOu te e et y s o s data o os oc e act ty o attac atte pts e e obse ed os oc e act ty o a o e t e o d, d a a d\nCanada showed top detections from July 1, 2021 to February 28, 2022.\n\nFigure 1. Countries with the highest number of attack attempts per machine for AvosLocker ransomware (July 1, 2021 to February 28, 2022)\n\n_Source: Trend Micro™ Smart Protection Network™_\n\nBased on our detections, AvosLocker was the most active in the food and beverage sector, followed by the technology and finance sectors.\nHowever, there is only by a slim margin given the small sample size.\n\nFigure 2. Based on our detections, AvosLocker was the most active in the food and beverage sector, followed by the technology and finance\nsectors. However, there is only a slim margin given the small sample size.\n\n_Source: Trend Micro Smart Protection Network_\n\nAs of this writing, the highest number of AvosLocker-related detections we have seen was in the month of February, which continues the\nsudden increase observed at the start of the year.\n\nFigure 3. AvosLocker monthly detections per machine (July 1, 2021 to February 28, 2022)\n_Source: Trend Micro Smart Protection Network_\n\n## Targeted regions and sectors according to AvosLocker leak site\n\n\n-----\n\ne a so e tu ed to os oc e s ea s te, c o e ed a d e e t pe spect e o ts ta gets o ece be, 0 to eb ua y 8,\n2022 we found 15 listed entities. The organizations listed in the site were successfully attacked and have not, in that period, paid the\ndemanded ransom.\n\nBy grouping the list according to regions, we found that AvosLocker focused its efforts on targets from North America.\n\nFigure 4. Regional distribution of AvosLocker victims according to the group’s leak site (December 1, 2021 to February 28, 2022)\n\nMore than half of the 15 entities we found in the leak site were small enterprises. With respect to the targets’ specific industries, we saw no\ntrend emerging, as no one industry stood out from the others. This can be seen in Figure 6, where no single industry stood out from the rest.\n\nFigure 5. Sector distribution of AvosLocker victims according to the group’s leak site (December 1, 2021 to February 28, 2022)\n\nWe do note, however, that AvosLocker has showed relatively less activity compared to other more prominent ransomware families in terms of\nour detections and observations from its leak site. Because of the limited sample size, further monitoring might be necessary to identify trends.\n\n## Infection chain and techniques\n\nThe AvosLocker infection chain, which operates on the RaaS model, can vary depending on the target. The following infection chain shows a\nvariety of tactics and tools employed by this RaaS.\n\n\n-----\n\nFigure 6. AvosLocker infection chain\n\n**Initial Access**\n\nAvosLocker uses Zoho ManageEngine ServiceDesk Plus and its exploit for initial access and to download of web shell and AnyDesk.\nIt has been reported to make use of compromised accounts to access its victims via RDP or virtual private network (VPN).\n\n**Defense Evasion, Discovery, and Credential Access**\n\nIt uses Avast Anti-Rootkit Driver and a PowerShell script to disable certain antivirus processes.\nIt uses a BAT script to disable antivirus services that can run on Windows Safe Mode.\nIt uses Mimikatz and XenArmor Password Recovery Pro Tool to get credentials.\nIt also uses Nmap, NetScan, and native Windows commands (such as ipconfig, nslookup, and others) to perform discovery on the target\nnetwork.\nIt avoids writing the ransomware payload in target systems.\n\n**Lateral Movement and Command and Control**\n\nAvosLocker installs AnyDesk to gain control of the targeted systems.\nIt uses PDQ Deploy to push out and execute the Windows batch script on the targeted systems.\n\n**Impact**\n\nIt then executes the ransomware payload (AvosLocker) to perform its encryption routine once all other routines are done.\nIt now has both Windows and Linux version of this ransomware payload. The Linux version is also known to terminate ESXi virtual\nmachines.\nIn its latest attacks, the Windows version was executed after restarting in safe mode to inhibit security software from detecting the\nransomware variant.\n\n\n-----\n\no de to e ecute o sa e ode, t adds a u O ce eg st y e t y u de autosta t u t e est gat o e ea ed u t p e ays\nAvosLocker can be executed via the RunOnce registry, which are the following:\n\n1. Direct execution of the ransomware payload\n2. Execute a PowerShell script that will download and execute the ransomware payload\n3. Execute a PowerShell script that will decode and execute the ransomware payload from a disguised .jpg file.\nIt drops a ransom note similar to the one in Figure 7.\n\nFigure 7. Sample ransom note used by AvosLocker\n\n**Other technical details**\n\nIt avoids the following directories:\n\nAll Users\nAppData\nboot\nbootmgr\nGames\nIntel\nMicrosoft. (Directory name starts with “Microsoft.)\nProgram Files\nProgramData\nPublic\nSophos\nSystem Volume Information\nWindows\nWindows.old\nWinNT\nIt avoids encrypting the following files with strings in their file name:\n\nautorun.inf\nboot.ini\nbootfont.bin\nbootsect.bak\nconfig.msi\ndesktop.ini\niconcache.db\nntldr\nntuser.dat\nntuser.dat.log\nntuser.ini\nthumbs.db\nThumbs.db\n\n\n-----\n\nt a o ds e c ypt g es t t e o o g e te s o s\n.386\n.adv\n.ani\n.avos\n.avos2\n.avos2j\n.avoslinux\n.bat\n.bin\n.cab\n.cmd\n.com\n.cpl\n.cur\n.deskthemepack\n.diagcab\n.diagcfg\n.diagpkg\n.dll\n.drv\n.exe\n.hlp\n.hta\n.icl\n.icns\n.ico\n.ics\n.idx\n.key\n.ldf\n.lnk\n.lock\n.mod\n.mpa\n.msc\n.msi\n.msp\n.msstyles\n.msu\n.nls\n.nomedia\n.ocx\n.pdb\n.prf\n.ps1\n.rom\n.rtp\n.scr\n.shs\n.spl\n.sys\n.theme\n.themepack\n.wpx\n\n\n-----\n\nt te ates t e o o g p ocesses\nencsvc\nthebat\nmydesktopq os\nxfssvccon\nfirefox\ninfopath\nwinword\nsteam\nsynctime\nnotepad\nocomm\nonenote\nmspub\nthunderbird\nagntsvc\nsql\nexcel\npowerpnt\noutlook\nwordpad\ndbeng50\nisqlplussvc\n\n## MITRE tactics and techniques\n\n**Initial Access** **Execution** **Persistence** **Defense Evasion**\n\n\n**Credential**\n**Access** **Discovery**\n\n\n**Lateral**\n**Movement**\n\n\n**Command**\n**and**\n**Control** **Imp**\n\n\n-----\n\n**Command**\n**and**\n**Control** **Imp**\n\n\n**Initial Access** **Execution** **Persistence** **Defense Evasion**\n\n\n**Credential**\n**Access** **Discovery**\n\n\n**T1190 - Exploit**\npublic-facing\napplication\n\n_Arrives by_\n_exploiting_\n_Zoho_\n_ManageEngine_\n_ServiceDesk_\n_Plus Exploit to_\n_download web_\n_shell and_\n_AnyDesk_\n\n_As it operates_\n_as a RaaS,_\n_depending on_\n_the affiliate,_\n_the following_\n_exploits might_\n_be used for_\n_initial access:•_\n_CVE-2021-_\n_31206• CVE-_\n_2021-_\n_31207• CVE-_\n_2021-_\n_34473• CVE-_\n_2021-_\n_34523• CVE-_\n_2021-26855_\n\n**T1078 - Valid**\naccounts\n\n_Have been_\n_reported to_\n_make used of_\n_compromised_\n_accounts to_\n_access victims_\n_via RDP or_\n_VPN_\n\n\n**T1059 -**\nCommand and\nscripting\ninterpreter\n\n_Uses various_\n_scripting_\n_interpreters like_\n_PowerShell and_\n_Windows_\n_Command shell_\n\n**T1072 - Software**\ndeployment tools\n\n_Used PDQ_\n_Deploy to_\n_distribute the_\n_batch file and_\n_payload on_\n_target computers_\n\n\n**T1136 -**\nCreate\naccount\n\n_Creates a_\n_new user to_\n_ensure_\n_automatic_\n_login when_\n_machine is_\n_restarted in_\n_safe mode_\n\n**T1547**\n\n- Boot or\nlogon\nautostart\nexecution\n\n_Creates an_\n_autostart_\n_entry to_\n_ensure_\n_execution of_\n_ransomware_\n_when_\n_restarted in_\n_safe mode_\n\n\n**T1112 - Modify registry**\n\n_Modifies registry entry to_\n_allow AnyDesk on safe mode_\n_and to enable automatic_\n_login when restarted in safe_\n_mode_\n\n**T1562 - Impair defenses**\n\n_Abuses Avast Anti-Rootkit_\n_Driver and a PowerShell_\n_script to disable certain_\n_processes related to security_\n_tools and also restarts the_\n_machine in safe mode to_\n_inhibit security tools from_\n_executing_\n\n**T1140 - Deobfuscate/Decode**\nfiles or information\n\n_Some ransomware samples_\n_are decoded using CertUtil_\n_and strings to be used by the_\n_ransomware are encrypted_\n_using XOR._\n\n**T1070 - Indicator removal on**\nhost\n\n_It deletes created registry_\n_entries, scripts, and_\n_ransomware binary after_\n_encryption._\n\n\n**T1003 - OS**\ncredential\ndumping\n\n_Might utilize_\n_Mimikatz to_\n_dump_\n_credentials_\n\n**T1552**\n\n- Unsecured\ncredentials\n\n_Might utilize_\n_Mimikatz or_\n_XenArmor_\n_Password_\n_Recovery_\n_Pro tool to_\n_gather_\n_credentials_\n\n**T1555**\n\n- Credentials\nfrom\npassword\nstores\n\n_Might utilize_\n_XenArmor_\n_Password_\n_Recovery_\n_Pro tool to_\n_gain_\n_credentials_\n\n\n**T1083 - File**\nand\ndirectory\ndiscovery\n\n_Searches_\n_for specific_\n_files and_\n_directory_\n_related to its_\n_ransomware_\n_encryption_\n\n**T1135 -**\nNetwork\nshare\ndiscovery\n\n_Makes use_\n_of tools to_\n_enumerate_\n_network_\n_share_\n\n**T1057**\n\n- Process\ndiscovery\n\n_Discovers_\n_certain_\n_processes_\n_for process_\n_termination_\n\n**T1018**\n\n- Remote\nsystem\ndiscovery\n\n_Makes use_\n_of tools for_\n_network_\n_scans_\n\n\n**Lateral**\n**Movement**\n\n**T1021 -**\nRemote\nservices\n\n_Might use_\n_AnyDesk to_\n_remotely_\n_connect_\n_and_\n_transfer_\n_files_\n\n**T1072 -**\nSoftware\ndeployment\ntools Used\n_PDQ_\n_Deploy to_\n_distribute_\n_the batch_\n_file and_\n_payload on_\n_target_\n_computers_\n\n\n**T1219 -**\nRemote\naccess\nsoftware\n\n_Makes use_\n_of tools for_\n_network_\n_scans_\n\n\n**T14**\nenc\nimp\n_Mig_\n_Any_\n_rem_\n_con_\n_tran_\n_It us_\n_sals_\n_stre_\n_to e_\n_victi_\n_Old_\n_vers_\n_use_\n_adv_\n_enc_\n_stan_\n_(AE_\n_256_\n_RSA_\n_enc_\n_and_\n_resp_\n\n**T14**\n\n- Se\nstop\n_Con_\n_list o_\n_serv_\n_be_\n_term_\n_ens_\n_enc_\n\n**T14**\n\n- Inh\nsyst\nreco\n_Dele_\n_sha_\n_cop_\n\n**T14**\n\n- De\n_Rep_\n_des_\n_wall_\n_with_\n_rans_\n\n\n## Summary of malware, tools, and exploits used\n\nSecurity teams can watch out for the presence of the following malware tools and exploits that are typically used in AvosLocker attacks:\n\n\n**Defense**\n**Evasion**\n\n**BAT file**\n**Avast Anti-**\n**Rootkit**\n**Scanner**\n**PowerShell**\n**script**\n\n\n**Command**\n**and Control**\n\n**AnyDesk**\n\n\n**Initial Access** **Execution** **Credential Access** **Discovery**\n\n\n**Exploit for Zoho**\n**ManageEngine**\n**ServiceDesk Plus**\n\n## Recommendations\n\n\n**PowerShell**\n**Windows**\n**command**\n**shell**\n\n\n**Mimikatz**\n**XenArmor**\n**Password**\n**Recovery**\n**Tool Pro**\n\n\n**NetScan**\n**Nmap**\n\n\n**Lateral**\n**Movement**\n\n**PDQ**\n**Deploy**\n\n\n-----\n\ne os oc e s ot yet as p o e t as ot e a so a e a es e oc [t, Co t, a d C op, t see](https://www.trendmicro.com/vinfo/us/security/news/ransomware-spotlight/ransomware-spotlight-conti) s to o o t e ootsteps o\nthese more established players. It also reuses tactics that worked for infamous ransomware families, namely REvil. This should be enough\nreason for organizations to keep an eye on this ransomware family as well as to stay abreast with the latest trends and tactics employed by\nthreat actors today.\n\nTo help defend systems against similar threats, organizations can establish security frameworks that can allocate resources systematically for\nestablishing solid defenses against ransomware.\n\nHere are some best practices that can be included in these frameworks:\n\n**Audit and inventory**\n\nTake an inventory of assets and data.\nIdentify authorized and unauthorized devices and software.\nMake an audit of event and incident logs.\n\n**Configure and monitor**\n\nManage hardware and software configurations.\nGrant admin privileges and access only when necessary to an employee’s role.\nMonitor network ports, protocols, and services.\nActivate security configurations on network infrastructure devices such as firewalls and routers.\nEstablish a software allowlist that only executes legitimate applications.\n\n**Patch and update**\n\nConduct regular vulnerability assessments.\nPerform patching or virtual patching for operating systems and applications.\nUpdate software and applications to their latest versions.\n\n**Protect and recover**\n\nImplement data protection, back up, and recovery measures.\nEnable multifactor authentication (MFA).\n\n**Secure and defend**\n\nEmploy sandbox analysis to block malicious emails.\nDeploy the latest versions of security solutions to all layers of the system, including email, endpoint, web, and network.\nDetect early signs of an attack such as the presence of suspicious tools in the system.\nUse advanced detection technologies such as those powered by AI and machine learning.\n\n**Train and test**\n\nRegularly train and assess employees on security skills.\nConduct red-team exercises and penetration tests.\n\nA multilayered approach can help organizations guard possible entry points into the system (endpoint, email, web, and network). Security\nsolutions that can detect malicious components and suspicious behavior can also help protect enterprises.\n\n[Trend Micro Vision One™ provides multilayered protection and behavior detection, which helps block questionable behavior and tools](https://www.trendmicro.com/en_us/business/products/detection-response.html)\nbefore the ransomware can do any damage.\n[Trend Micro Cloud One™ Workload Security protects systems against both known and unknown threats that exploit vulnerabilities. This](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\nprotection is made possible through techniques such as virtual patching and machine learning.\n[Trend Micro™ Deep Discovery™ Email Inspector employs custom sandboxing and advanced analysis techniques to effectively block](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-inspector.html)\nmalicious emails, including phishing emails that can serve as entry points for ransomware.\n[Trend Micro Apex One™ offers next-level automated threat detection and response against advanced concerns such as fileless threats](https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint.html)\nand ransomware, ensuring the protection of endpoints.\n\n\n-----\n\n## Indicators of Compromise (IOCs)\n\nThe IOCs for this article can be found [here. Actual indicators might vary per attack.](https://documents.trendmicro.com/images/TEx/ioc_avoslocker_spotlightRSJK7Pc.txt)\n\nHIDE\n\n**Like it? Add this infographic to your site:**\n1. Click on the box below.  2. Press Ctrl+A to select all.  3. Press Ctrl+C to copy.  4. Paste the code into your page (Ctrl+V).\n\nImage will appear the same size as you see above.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-04-04 - Ransomware Spotlight- AvosLocker.pdf"
    ],
    "report_names": [
        "2022-04-04 - Ransomware Spotlight- AvosLocker.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536112,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1653761753,
    "ts_modification_date": 1653761753,
    "files": {
        "pdf": "https://archive.orkl.eu/804018bb304cca6e327b550d59ea9ef744503dd9.pdf",
        "text": "https://archive.orkl.eu/804018bb304cca6e327b550d59ea9ef744503dd9.txt",
        "img": "https://archive.orkl.eu/804018bb304cca6e327b550d59ea9ef744503dd9.jpg"
    }
}