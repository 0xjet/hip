{
    "id": "d65923c6-a7bd-45d8-bcd1-9124b977e5f5",
    "created_at": "2022-10-25T16:48:23.863821Z",
    "updated_at": "2025-03-27T02:16:20.807681Z",
    "deleted_at": null,
    "sha1_hash": "316cd38c3939a4f862b611888a489672c014b651",
    "title": "Turla group using Neuron and Nautilus tools alongside Snake malware",
    "authors": "NCSC",
    "file_creation_date": "2017-11-23T15:59:55Z",
    "file_modification_date": "2017-11-23T15:59:55Z",
    "file_size": 971478,
    "plain_text": "#### TLP WHITE\n\n TLP WHITE\n\nPage 1 of 27\n\n\n-----\n\n#### TLP WHITE\n\n### About this document\n\nThis report provides new intelligence by the NCSC on two tools used by the Turla\ngroup to target the UK. It contains IOCs and signatures for detection by network\ndefenders.\n\n### Handling of the Report\n\nInformation in this report has been given a Traffic Light Protocol (TLP) of WHITE,\nwhich means it can be shared within and beyond the CiSP community with no\nhandling restrictions.\n\n### Disclaimer\n\nThis report draws on reported information and NCSC investigations into Turla activity\nin the UK.\n\n#### TLP WHITE\n\nPage 2 of 27\n\n\n-----\n\n#### TLP WHITE\n\n Contents\n\nIntroduction ............................................................................................................................................ 4\n\nNeuron Analysis ................................................................................................................................... 5\n\nNeuron Service ................................................................................................................................. 6\n\nAssociated Files ........................................................................................................................... 6\n\nInfection Vector & Install ............................................................................................................. 7\n\nPersistence .................................................................................................................................... 7\n\nNetwork Communications ........................................................................................................... 8\n\nCapabilities .................................................................................................................................. 10\n\nNeuron Client .................................................................................................................................. 10\n\nAssociated Files ......................................................................................................................... 10\n\nPersistence .................................................................................................................................. 11\n\nConfiguration ............................................................................................................................... 12\n\nNetwork Communications ......................................................................................................... 12\n\nCapability ..................................................................................................................................... 13\n\nAssociated Files ......................................................................................................................... 15\n\nConfiguration ............................................................................................................................... 15\n\nCommunications ......................................................................................................................... 17\n\nCapability ..................................................................................................................................... 18\n\nAppendix A .......................................................................................................................................... 20\n\nNeuron Client .................................................................................................................................. 20\n\nNeuron Service ............................................................................................................................... 21\n\nNeuron Yara .................................................................................................................................... 22\n\nNautilus ................................................................................................................................................ 25\n\nNautilus Yara................................................................................................................................... 25\n\nAdditional Indicators for Forensic Analysis .................................................................................... 27\n\n#### TLP WHITE\n\nPage 3 of 27\n\n\n-----\n\n#### TLP WHITE\n\n### Introduction\n\nNeuron and Nautilus are malicious tools designed to operate on Microsoft Windows\nplatforms, primarily targeting mail servers and web servers. The NCSC has observed\nthese tools being used by the Turla group to maintain persistent network access and\nto conduct network operations.\n\nThe Turla group use a range of tools and techniques, many of which are custom. Using\ntheir advanced toolkit, the Turla group compromise networks for the purposes of\nintelligence collection. The Turla group is known to target government, military,\ntechnology, energy and commercial organisations.\n\nThe Turla group has operated on targets using a rootkit known as Snake for many\nyears. Like Neuron and Nautilus, Snake provides a platform to steal sensitive data,\nacts as a gateway for internal network operations and is used to conduct onward\nattacks against other organisations.\n\nThe Turla group are experienced in maintaining covert access through incident\nresponse activities. They infect multiple systems within target networks and deploy a\ndiverse range of tools to ensure that they retain a foothold back onto a victim even\nafter the initial infection vector has been mitigated.\n\nThe NCSC has observed both Neuron and Nautilus being used in conjunction with the\nSnake rootkit. In a number of instances, one or both of these tools has been deployed\nfollowing the successful installation of Snake. The NCSC believes that Neuron and\nNautilus are another component of the wider Turla campaign and are not acting as\nreplacements for the Snake rootkit. It is likely that these tools have seen wider\ndeployment since the Snake rootkit has been reported on by the information security\nindustry, providing the group with additional methods of access.\n\nThis advisory provides information to detect Neuron and Nautilus infections. The\nNCSC encourages any organisation that has previously experienced a compromise\nby the Turla group to be diligent in checking for the presence of these additional tools.\nWhilst they are commonly deployed alongside the Snake rootkit, these tools can also\nbe operated independently.\n\n#### TLP WHITE\n\nPage 4 of 27\n\n\n-----\n\n#### TLP WHITE\n\n### Neuron Analysis\n\nNeuron consists of both client and server components. The Neuron client and Neuron\nservice are written using the .NET framework with some codebase overlaps.\n\nThe Neuron client is used to infect victim endpoints and extract sensitive information\nfrom local client machines. The Neuron server is used to infect network infrastructure\nsuch as mail and web servers, and acts as local Command & Control (C2) for the client\ncomponent. Establishing a local C2 limits interaction with the target network and\nremote hosts. It also reduces the log footprint of actor infrastructure and enables client\ninteraction to appear more convincing as the traffic is contained within the target\nnetwork.\n\nThe main method of communication between the Neuron client and service is via\nHTTP requests. The Neuron service creates its own HTTP listener and waits for\nrequests to a configured Neuron URL endpoint. These endpoint names are themed\naround legitimate web services, such as Microsoft Exchange and Microsoft IIS, which\nfurther helps malware traffic appear legitimate. Details of these endpoints are provided\nin the Neuron service communications section of this advisory.\n\nA subset of Neuron services analysed by the NCSC can receive communications via\npipes alongside the HTTP listener, however this functionality is missing from some\nsamples.\n\nOne of the main pieces of functionality implemented within Neuron is the synchronising\nof “StorageFile” objects and “StorageScript” objects between the client and service.\nThese are described in more detail in the Network Communications section.\n\nThis malware is referred to as “Neuron” due to the presence of a PDB string within the\nbinary and various other references throughout.\n```\n c:\\Develop\\internal\\neuron-client\\dropper-svc\\obj\\Release\\dropper-svc.pdb\n\n#### TLP WHITE\n\n```\nPage 5 of 27\n\n\n-----\n\n#### TLP WHITE\n\n Neuron Service\n\nThe Neuron service is typically installed on compromised infrastructure such as mail\nand web servers, and listens for HTTP requests from infected clients. In this way,\nNeuron service acts as a Command & Control (C2) server inside the victim network\nfor infected Neuron clients. While Neuron service examples observed by the NCSC\nhave been running on servers, it is also possible for it to be run on Windows clients.\n\nThe installation of a C2 server inside the victim network allows the actor to evade\ndetection by network gateway based monitoring. While external communications are\nrequired for the actor to make connections back to their upstream C2 infrastructure,\nthese communications are often encrypted using the legitimate TLS configuration of\nthe victim network.\n\nThe Neuron service and client model enables the communications to appear\nlegitimate, with endpoint victims running the client, and the actor initiating connections\nto the (typically) outward-facing Neuron infected server.\n\n##### Associated Files\n```\n Name Microsoft.Exchange.Service.exe\n Description Neuron Service\n MD5 0f12268221e27406351a6313f902b498\n SHA1 b0dbdc81a0e367330007b7e593d8dabf92ca7afd\n SHA256 d1d7a96fcadc137e80ad866c838502713db9cdfe59939342b8e3beacf9c7fe29\n Size 43008\n Name w3wpdiag.exe\n Description Neuron Service\n MD5 371b4380080e3d94ffcae1a7e9a0d5e2\n SHA1 f7088075d1c798f27b0d269c97dc877ff16f1401\n SHA256 2986bae15cfa78b919d21dc070be944e949a027e8047a812026e35c66ab17353\n Size 59392\n Name Updater.exe\n Description Neuron Service\n MD5 8229622a9790d75e09a099e8758d5703\n SHA1 10586913ceeecd408da4e656c29ed4e91c6b758e\n SHA256 2f4d6a3c87770c7d42d1a1b71ed021a083b08f69ccaf63c15428c7bc6f69cb10\n Size 44544\n\n#### TLP WHITE\n\n```\nPage 6 of 27\n\n|Name Microsoft.Exchange.Service.exe|Col2|\n|---|---|\n|Description Neuron Service||\n|MD5 0f12268221e27406351a6313f902b498||\n|SHA1 b0dbdc81a0e367330007b7e593d8dabf92ca7afd||\n|SHA256 d1d7a96fcadc137e80ad866c838502713db9cdfe59939342b8e3beacf9c7fe29||\n|Size|43008|\n\n|Name w3wpdiag.exe|Col2|\n|---|---|\n|Description Neuron Service||\n|MD5 371b4380080e3d94ffcae1a7e9a0d5e2||\n|SHA1 f7088075d1c798f27b0d269c97dc877ff16f1401||\n|SHA256 2986bae15cfa78b919d21dc070be944e949a027e8047a812026e35c66ab17353||\n|Size|59392|\n\n|Name Updater.exe|Col2|\n|---|---|\n|Description Neuron Service||\n|MD5 8229622a9790d75e09a099e8758d5703||\n|SHA1 10586913ceeecd408da4e656c29ed4e91c6b758e||\n|SHA256 2f4d6a3c87770c7d42d1a1b71ed021a083b08f69ccaf63c15428c7bc6f69cb10||\n|Size|44544|\n\n\n-----\n\n#### TLP WHITE\n```\n Name w3wpdiag.exe\n Description Neuron Service\n MD5 a3bdc385cf68019449027bd6d8cecb4d\n SHA1 fe8da5a1e62a8d4f627834b0f26c802a330d8d45\n SHA256 0f4e9e391696ed8b9172985bb43cca7d7f2c8a4ae0493e4bf1f15b90f7138259\n Size 58880\n Name dropper-svc.exe\n Description Dropper for the Neuron service\n MD5 d6ef3c8f2c3f3ddffbb70f5dadfa982c\n SHA1 934b288075c122165897276b360c61e77cb7bde0\n SHA256 fa543de359d498150cbcb67c1631e726a4b14b0a859573185cede5b12ad2abfb\n Size 85008\n\n##### Infection Vector & Install\n\n```\nThe infection vector for the Neuron service is typically via exploitation of application\nlayer vulnerabilities in server software, server misconfigurations, or brute-force attacks\non administrative accounts.\n\nNeuron service requires a dropper that essentially performs the same actions as the\nclient dropper, embedding the final payload using the same method detailed in the\nNeuron client section. The service dropper takes a parameter of the path where the\npayload will be dropped.\n\nFollowing execution, the dropper modifies the last access time of the deployed files to\nmatch the timestamps of the legitimate file “EdgeTransport.exe”. It is advised that\nforensic investigators conduct a search for files that have this timestamp applied.\n\nFinally, the dropper executes the following command to remove all installation log files:\n```\n cmd.exe /c del *.InstallLog *.InstallState\n\n##### Persistence\n\n```\nIn order to persist on the compromised hosts, Neuron service installs itself as an\nautomatic service, allowing the infection to persist through a server restart. The\nNeuron service can be manually stopped and removed, and contains no method of reestablishing execution.\n\n#### TLP WHITE\n\nPage 7 of 27\n\n|Name w3wpdiag.exe|Col2|\n|---|---|\n|Description Neuron Service||\n|MD5 a3bdc385cf68019449027bd6d8cecb4d||\n|SHA1 fe8da5a1e62a8d4f627834b0f26c802a330d8d45||\n|SHA256 0f4e9e391696ed8b9172985bb43cca7d7f2c8a4ae0493e4bf1f15b90f7138259||\n|Size|58880|\n\n|Name dropper-svc.exe|Col2|\n|---|---|\n|Description Dropper for the Neuron service||\n|MD5 d6ef3c8f2c3f3ddffbb70f5dadfa982c||\n|SHA1 934b288075c122165897276b360c61e77cb7bde0||\n|SHA256 fa543de359d498150cbcb67c1631e726a4b14b0a859573185cede5b12ad2abfb||\n|Size|85008|\n\n\n-----\n\n#### TLP WHITE\n\nThe Neuron service attempts to masquerade as legitimate Microsoft Exchange or\nMicrosoft IIS services. A list of the service names and descriptions used within Neuron\nsamples is as follows:\n\n**SERVICE NAME** **DISPLAY NAME** **DESCRIPTION**\n```\n MSExchangeService Microsoft Exchange Host service for the Microsoft Exchange\n           Service Server management provider. If this service\n                         is stopped or disabled, Microsoft Exchange\n                         cannot be managed.\n W3WPDIAG Microsoft IIS Host service for the Microsoft IIS management\n           Diagnostics Service provider. If this service is stopped or\n                         disabled, Microsoft IIS cannot be managed.\n Updater Updater Host service for software update. If this\n                         service is stopped or disabled, software\n                         cannot be update.\n\n##### Network Communications\n\n```\nCommunications between the client and service are via HTTP requests. The service\nwill establish a HTTP listener, commonly on port 443 (https), however instances have\nbeen analysed where port 80 (http) is used instead. The listener waits for requests on\nthe host matching specific URIs defined by the configuration. The following have been\ndefined in the configuration in Neuron samples analysed by the NCSC:\n```\n https://*:443/ews/exchange/\n https://*:443/W3SVC/\n https://*:80/W3SVC/\n\n```\nNeuron clients send requests to the defined endpoint in order to communicate with the\nservice. In order to make the traffic from clients look legitimate, the actor has chosen\nto name their endpoints with common Microsoft Windows terms.\n\nCommunications are encrypted using RC4 as an additional layer of security. The RC4\nkey is sent to the connecting client using a pre-configured RSA key.\n\nParameters for a request are sent in the POST body, with the following values\npossible:\n```\n cid\n cadataKey\n cadata\n cadataSig\n\n#### TLP WHITE\n\n```\nPage 8 of 27\n\n|SERVICE NAME DISPLAY NAME DESCRIPTION|Col2|Col3|\n|---|---|---|\n|MSExchangeService Microsoft Exchange Host service for the Microsoft Exchange Service Server management provider. If this service is stopped or disabled, Microsoft Exchange cannot be managed.|||\n|W3WPDIAG Microsoft IIS Host service for the Microsoft IIS management Diagnostics Service provider. If this service is stopped or disabled, Microsoft IIS cannot be managed.|||\n|Updater|Updater|Host service for software update. If this service is stopped or disabled, software cannot be update.|\n\n\n-----\n\n#### TLP WHITE\n\nThe values for these parameters are base64 encoded and RC4 encrypted using the\nkey exchanged between the client and service. Each parameter performs a different\ntask within the service; for example, “cid” requests the current RC4 key and “cadata”\nsends an instruction to be run.\n\nAn example HTTP communication is shown below:\n```\n POST https://<domain>/ews/exchange/exchange.asmx HTTP/1.1\n Content-Type: application/x-www-form-urlencoded\n Host: <domain>\n Content-Length: <variable>\n Expect: 100-continue\n Connection: Keep-Alive\n cadata=<url_encoded_b64>\n\n```\nThe following SNORT rules can be used to alert on this traffic. Network collection will\nneed to be in place between the client and server; in most instances, this is between\ntwo machines within the same LAN:\n```\n alert tcp $HOME_NET any -> $EXTERNAL_NET any (flow: established,from_client; msg:\n \"Web/request\\:POST - Neuron A\"; content: \"cadata=\"; fast_pattern; content: \"Content Type|3a| application/x-www-form-urlencoded\"; content: \"Expect|3a| 100-continue\"; pcre:\n \"/\\ncadata=[a-zA-Z0-9%]{1,5000}/\"; content: \"POST\"; http_method; rev: 1; priority: 1;)\n alert tcp $HOME_NET any -> $EXTERNAL_NET any (flow: established,from_client; msg:\n \"Web/request\\:POST - Neuron B\"; content: \"cadata=\"; fast_pattern; content: \"Content Type|3a| application/x-www-form-urlencoded\"; content: \"Expect|3a| 100-continue\"; pcre:\n \"/\\ncadataKey=[a-zA-Z0-9%]{1,5000}/\"; content: \"POST\"; http_method; rev: 1; priority:\n 1;)\n alert tcp $HOME_NET any -> $EXTERNAL_NET any (flow: established,from_client; msg:\n \"Web/request\\:POST - Neuron C\"; content: \"cadata=\"; fast_pattern; content: \"Content Type|3a| application/x-www-form-urlencoded\"; content: \"Expect|3a| 100-continue\"; pcre:\n \"/\\ncid=[a-zA-Z0-9%]{1,5000}/\"; content: \"POST\"; http_method; rev: 1; priority: 1;)\n alert tcp $HOME_NET any -> $EXTERNAL_NET any (flow: established,from_client; msg:\n \"Web/request\\:POST - Neuron D\"; content: \"cadata=\"; fast_pattern; content: \"Content Type|3a| application/x-www-form-urlencoded\"; content: \"Expect|3a| 100-continue\"; pcre:\n \"/\\ncadataSig=[a-zA-Z0-9%]{1,5000}/\"; content: \"POST\"; http_method; rev: 1; priority:\n 1;)\n\n```\nIn addition to HTTP communications, some observed Neuron service samples have\nfunctionality that enables the clients to communicate with it via pipes, for example:\n```\n pipe://*/Winsock2/w3svc\n\n#### TLP WHITE\n\n```\nPage 9 of 27\n\n\n-----\n\n#### TLP WHITE\n\n##### Capabilities\n\nThe main functionality of the Neuron service is to return and synchronise StorageFile\nand StorageScript objects between the client and service.\n\nA StorageFile object contains information about a file including its name, modified date\nand the file contents; a StorageScript object contains “instructions”. There are multiple\ninstruction types, including the following:\n\n  - Executing a command using cmd.exe\n\n  - Creating new StorageFiles\n\n  - Downloading specified or all StorageFiles\n\n#### Neuron Client\n\nThe Neuron client component is typically installed on endpoint machines within a\nvictim network. Command & Control (C2) is conducted by the Neuron service. The\nclient is designed to collect, package and send documents to the service component\nfor onward exfiltration.\n\n##### Associated Files\n```\n Name neuron-client.exe\n Description Neuron Client\n MD5 4ed42233962a89deaa89fd7b989db081\n SHA1 cf731ee0af5c19231ff51af589f7434c0367d508\n SHA256 a96c57c35df18ac20d83b08a88e502071bd0033add0914b951adbd1639b0b873\n Size 55808\n Name Sign.exe\n Description Dropper for the Neuron client\n MD5 3cd5fa46507657f723719b7809d2d1f9\n SHA1 34ddc14b9a04eba98c3aa1cb27033e12ec847e03\n SHA256 a6dbc36c472b3ba70a98efd0db35e75c340086be15d3c3ab4e39033604d0bcf9\n Size 115712\n Name mydoc.doc\n Description Macro document that drops and runs Sign.exe (client dropper)\n MD5 66f4f1384105ce7ee1636d34f2afb1c9\n SHA1 3f23d152cc7badf728dfd60f6baa5c861a500630\n SHA256 42fbb2437faf68bae5c5877bed4d257e14788ff81f670926e1d4bbe731e7981b\n Size 591360\n\n#### TLP WHITE\n\n```\nPage 10 of 27\n\n|Name neuron-client.exe|Col2|\n|---|---|\n|Description Neuron Client||\n|MD5 4ed42233962a89deaa89fd7b989db081||\n|SHA1 cf731ee0af5c19231ff51af589f7434c0367d508||\n|SHA256 a96c57c35df18ac20d83b08a88e502071bd0033add0914b951adbd1639b0b873||\n|Size|55808|\n\n|Name Sign.exe|Col2|\n|---|---|\n|Description Dropper for the Neuron client||\n|MD5 3cd5fa46507657f723719b7809d2d1f9||\n|SHA1 34ddc14b9a04eba98c3aa1cb27033e12ec847e03||\n|SHA256 a6dbc36c472b3ba70a98efd0db35e75c340086be15d3c3ab4e39033604d0bcf9||\n|Size|115712|\n\n|Name mydoc.doc|Col2|\n|---|---|\n|Description Macro document that drops and runs Sign.exe (client dropper)||\n|MD5 66f4f1384105ce7ee1636d34f2afb1c9||\n|SHA1 3f23d152cc7badf728dfd60f6baa5c861a500630||\n|SHA256 42fbb2437faf68bae5c5877bed4d257e14788ff81f670926e1d4bbe731e7981b||\n|Size|591360|\n\n\n-----\n\n#### TLP WHITE\n```\n Name N/A\n Description Macro document that drops and runs Sign.exe (client dropper)\n MD5 0e430b6b203099f9c305681e1dcff375\n SHA1 845f3048fb0cfbdfb35bf6ced47da1d91ff2e2b1\n SHA256 bbe3700b5066d524dd961bd47e193ab2c34565577ce91e6d28bdaf609d2d97a8\n Size 590336\n\n##### Infection Vector and Install\n\n```\nThe Neuron client infection vector appears to be via spear-phishing victims with\ndocuments containing macros. When a document is opened, and macros are enabled,\na base64 encoded blob is constructed and written to the %temp% directory as\n“Signature.crt”; this is then decoded using the legitimate Microsoft binary “certutil.exe”,\nfor example:\n```\n certutil.exe -decode %TEMP%\\Signature.crt %TEMP%\\Sign.exe\n\n```\nThe resulting executable is the Neuron client dropper, which is responsible for setting\nup any initial configuration, establishing persistence and dropping the main payload to\ndisk.\n\nThe main payloads are embedded in the dropper executable and are GZIP\ncompressed and RC4 encrypted with a hardcoded key. The dropper is also\nresponsible for deploying any legitimate DLLs that may also be required – these are\nstored in the same way.\n\nAll files are placed into the directory from which the dropper was executed.\n\n##### Persistence\n\nThe Neuron client executable contains no functionality to establish persistence.\nInstead, the dropper handles this for the client by creating a scheduled task, enabling\nit to persist after a reboot.\n\nThe task is scheduled to run every 12 minutes (PT12M), with a task ID of “Microsoft\nCorporation” and a task description constructed from a string retrieved from a\nrandomly selected registry value. To build the task description, a list of value names\nof length 9 or greater but not containing \"\\\" are retrieved from\nHKLM\\\\Software\\\\Microsoft registry. One of these values is selected and prefixed to\nthe string \" updater\". This is then used as the description for the scheduled task.\n\n#### TLP WHITE\n\nPage 11 of 27\n\n|Name N/A|Col2|\n|---|---|\n|Description Macro document that drops and runs Sign.exe (client dropper)||\n|MD5 0e430b6b203099f9c305681e1dcff375||\n|SHA1 845f3048fb0cfbdfb35bf6ced47da1d91ff2e2b1||\n|SHA256 bbe3700b5066d524dd961bd47e193ab2c34565577ce91e6d28bdaf609d2d97a8||\n|Size|590336|\n\n\n-----\n\n#### TLP WHITE\n\n##### Configuration\n\nThe Neuron client configuration is stored in the registry as JSON; it must be set up by\nthe dropper before the client is run as no defaults are specified.\n\nThe configuration includes the domains where Neuron service implants have been\ndeployed, so that the client can communicate with them. The configuration also\nspecifies a beacon interval for each domain, along with a keep alive interval and time\nwait interval.\n\nAn example of the server configuration in JSON representation, taken from a Neuron\nclient dropper, is as follows:\n```\n “Connect”: [\n  {\n   “URL”: “https://<removed>/ews/exchange/exchange.asmx”,\n   “Interval”: 17\n  },\n   “URL”: “https://<removed>//ews/exchange/exchange.asmx”,\n   “Interval”: 32\n  {\n  }\n ],\n “KeepAliveInterval”: 7,\n “CmdTimeWait”: 5\n\n##### Network Communications\n\n```\nCommunications are detailed in the Neuron service section. The Neuron client and\nservice primarily communicate via HTTP requests.\n\nAs an extra layer of security, the client RC4 encrypts any data being sent. The key\nused is the Machine GUID retrieved from the registry\n(SOFTWARE\\Microsoft\\Cryptography\\MachineGuid); if this is not set then the default\nkey “8d963325-01b8-4671-8e82-d0904275ab06” is used.\n\n#### TLP WHITE\n\nPage 12 of 27\n\n\n-----\n\n#### TLP WHITE\n\n##### Capability\n\nOnce loaded the Neuron Client will loop indefinitely, performing a sync of storage files\nwith the Neuron service. The interval between synchronisations is specified in the\nconfiguration by the “CmdTimeWait” value.\n\nIn order to synchronise with the service, the client will retrieve all local StorageFile\nobjects and all StorageFiles on the service (without file data) and compare these for\ndifferences. The client retrieves the StorageFiles from the service by sending a POST\nrequest with the following data within the parameter “cadata”:\n```\n {\n  “cmd”: 0,\n  “data”: “”\n }\n\n```\nThis is encrypted with RC4 and then base64 encoded before being sent.\n\nThe service will respond with a list of all StorageFile metadata (i.e. name and date of\neach StorageFile). This is then used to determine which StorageFiles the client is\nmissing, as well as any files which the service is missing.\n\nThe client will send any required files (including file data) to the service by sending the\nfollowing command data:\n```\n {\n  “cmd”: 1,\n  “data”: [\n   <list_of_storage_files>\n  ]\n }\n\n```\nWhere a storage file object has a JSON representation as follows:\n```\n{\n “name”: name,\n “data”: data,\n “date”: date\n}\n\n```\nFinally, the client will download all missing StorageFiles from the service by sending\nthe following command data:\n```\n {\n  “cmd”: 2,\n  “data”: <array_of_request_storage_files>\n }\n\n#### TLP WHITE\n\n```\nPage 13 of 27\n\n\n-----\n\n#### TLP WHITE\n\nWhere the sent data contains the required StorageFile names, as follows:\n```\n [\n  {\n   “name”: “storage.file.1”\n  },\n  {\n   “name”: “storage.file.2”\n  }\n ]\n\n```\nThese new files are then written to disk, and added to the clients list of StorageFiles.\n\n#### TLP WHITE\n\nPage 14 of 27\n\n\n-----\n\n#### TLP WHITE\n\n Nautilus\n\nNautilus is very similar to Neuron both in the targeting of mail servers and how client\ncommunications are performed. This malware is referred to as Nautilus due to its\nembedded internal DLL name “nautilus-service.dll”, again sharing some resemblance\nto Neuron.\n\nThe main payload and configuration of Nautilus is encrypted within a covert store on\ndisk which is located in “\\ProgramData\\Microsoft\\Windows\\Caches\\”. The loader DLL\nwill access this covert store to decrypt the payload (oxygen.dll), which is then loaded\ninto a target process via reflective loading.\n\nThe Nautilus service listens for HTTP requests from clients to process tasking\nrequests such as executing commands, deleting files and writing files to disk.\n\n##### Associated Files \n```\n Name dcomnetsrv.dll\n Description Nautilus Loader DLL\n MD5 2f742ec3bb7590602bc3e97326f2476a\n SHA1 9d280e3ef1b180449086dda5b92a7b9bbe63dee4\n SHA256 a415ab193f6cd832a0de4fcc48d5f53d6f0b06d5e13b3c359878c6c31f3e7ec3\n Size 121344\n Name oxygen.dll\n Description Nautilus Injected payload\n MD5 ea874ac436223b30743fc9979eed5f2f\n SHA1 5ed61ec7de11922582f07c3488ef943b439ee226\n SHA256 cefc5cf4d46abb86fb0f7c81549777cf1a2a5bfbe1ce9e7d08128ab8bfc978f8\n Size 620568\n\n Persistence\n\n```\nNautilus achieves persistence by running as a service, dcomnetsrv, which is set to\nautomatically start. It is very likely that this is established by the Nautilus dropper,\nsimilar to the Neuron service dropper; however, the NCSC has not yet analysed a\nsample of this file.\n\n##### Configuration\n\nThe configuration for Nautilus is stored encrypted within a covert store that was located\nin “\\ProgramData\\Microsoft\\Windows\\Caches\\”.\n\n#### TLP WHITE\n\nPage 15 of 27\n\n|Name dcomnetsrv.dll|Col2|\n|---|---|\n|Description Nautilus Loader DLL||\n|MD5 2f742ec3bb7590602bc3e97326f2476a||\n|SHA1 9d280e3ef1b180449086dda5b92a7b9bbe63dee4||\n|SHA256 a415ab193f6cd832a0de4fcc48d5f53d6f0b06d5e13b3c359878c6c31f3e7ec3||\n|Size|121344|\n\n|Name oxygen.dll|Col2|\n|---|---|\n|Description Nautilus Injected payload||\n|MD5 ea874ac436223b30743fc9979eed5f2f||\n|SHA1 5ed61ec7de11922582f07c3488ef943b439ee226||\n|SHA256 cefc5cf4d46abb86fb0f7c81549777cf1a2a5bfbe1ce9e7d08128ab8bfc978f8||\n|Size|620568|\n\n\n-----\n\n#### TLP WHITE\n\nThe server configuration block, which defines the port and URL for Nautilus to listen\non, is passed in the identifier “config_listen.system”. A sample configuration is shown\nbelow:\n```\n proto=https\n host=+\n port=443\n param=OWA-AUTODISCOVER-EWS\n\n```\nNautilus also stores several other pieces of contextual information within the covert\nstore under the identifier “ctx.system”, including an RSA public key:\n```\n -----BEGIN PUBLIC KEY---- MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAg4r6SSnj2PnYbe6C4H8c\n M7162eRS+RTE8BYW8cTGdFPSiDiVOblImyddBLu/fW7MSc+BUsmg2l9SVyvJrHJk\n 0xnr7PRH9Dq7IcTYzQPMSsG1nC2Lej09EtilKwAQP08MIpiredzgXwom3rlH0Trc\n HiKxjLhQcuK0Mllsq+54gYPaoi6LkZG/lUxhWuGI1M2i3/dHp40vbwaaL5Sotxuv\n jSytDsU75U5T+rCAHVMykiLi/x7PKg40JQoYGMSOPUJsx87i/uy3uHoecl2ns038\n b70Gh6KJ4x5mwaKjMRsSm8PUN6ccHSyqetpXuTXoKU5dEDIQLNAwXTZY40d/aTEx\n uQIDAQAB\n -----END PUBLIC KEY----\n```\nThe covert store uses a proprietary format to store data. This format stores separate\nstreams (i.e. one for the config and one for the context) with each split into chunks of\n4096 bytes and encrypted using RC4. The offset to the next chunk is calculated by\ntaking the decrypted int value at offset 0xFF8 of the decrypted chunk, shifting this left\nby 0xC and then adding 0x10000. For the first chunk, this initial int value is at offset\n0xB4 of the header.\n\nA default RC4 key is used to decrypt the first chunk; this key is hardcoded into Nautilus\nas _“1B1440D90FC9BCB46A9AC96438FEEA8B” but is passed into a function that_\ntrims the length to 31 bytes, resulting in the final 32 byte initial RC4 key being\n_“1B1440D90FC9BCB46A9AC96438FEEA8\\x00”._\n\nThe RC4 implementation used for encryption of the covert store has been modified\nfrom a standard implementation. This may be an attempt to frustrate decryption;\nhowever, it is easily spotted when reverse engineering the sample.\n\n#### TLP WHITE\n\nPage 16 of 27\n\n\n-----\n\n#### TLP WHITE\n\nThe following Python implementation duplicates the modified RC4 XOR loop:\n```\ndef rc4(data, key):\n    x = 0\n    box = range(256)\n    for i in range(256):\n        x=(x + box[i] + ord(key[i%len(key)])) % 256\n        box[i], box[x] = box[x], box[i]\n    out = []\n    key = []\n    i = box[1]\n    j = box[i]\n    box[i] = i\n    box[1] = j\n    for char in data:\n        sbb = box[i % 256]\n        i += 1\n        sbb += j\n        kb = box[sbb % 256]\n        out.append(chr(ord(char) ^ kb))\n    return ''.join(out)\n\n```\nA covert store can be identified by RC4 decrypting the 4 bytes at offset 0xFFFC with the\ndefault RC4 key followed by comparison with the magic bytes 0x3a29bd32.\n\n##### Communications\n\nCommunication with clients is performed in a similar fashion to Neuron. Nautilus\nlistens for incoming connections from clients on port 443 that are addressed to the\nURL “/OWA-AUTODISCOVER-EWS”; this URL path could be modified. Nautilus is\ncommonly installed on a victim mail server, enabling the pre-installed TLS\nconfiguration to be used.\n\nData sent to the service is encoded in the referrer header, which is masquerading as\na legitimate Bing search. The format string used to create this is as follows:\n```\n Referer: http://www.bing.com/search?q=%s&go=Submit&qs=n&pq=%s&sc=0-11&sp= 1&sk=&cvid=%s&first=21&FORM=%s\n\n#### TLP WHITE\n\n```\nPage 17 of 27\n\n\n-----\n\n#### TLP WHITE\n\n##### Capability\n\nThe malware can take commands from connecting clients to perform on the infected\nhost. The commands take the format \"O_001\", \"O_002\" and so on. A subset of these\ncommands allow Nautilus to be tasked with the following:\n\n  - O_001: Execute a cmd.exe command\n\n  - O_002: Read file\n\n  - O_003: Write file\n\n  - O_007: Delete file\n\n  - O_008: GetTempPathA\n\n  - O_009: Sleep\n\n  - O_010: Create directory\n\n  - O_011: Check if directory\n\n  - O_012 Duplicate of O_011\n\nThere also appear to be some separately processed commands containing the\nfollowing functionality:\n\n  - O_100 Shutdown (implant)\n\n  - O_101 Uninstall\n\n#### TLP WHITE\n\nPage 18 of 27\n\n\n-----\n\n#### TLP WHITE\n\n### ErrorFE.aspx\n\nAlongside the Neuron and Nautilus toolkits, the NCSC identified a file named\n“errorFE.aspx”. This file was installed on a number of victims following the successful\nexploitation of web application software, and provides additional persistence to enable\nthe deployment of further tools.\n\nThe script defines its working directory as the value of the Windows environment\nvariable “temp”, using this location to drop and execute files and collect data.\n\nThis script accepts web requests and extracts the cookie parameter; valid data in the\ncookie is base64 encoded and AES encrypted using hardcoded values.\n\nThe script supports the processing of multiple cookies from a single request, indicating\nit is possible to issue multiple commands in a single request. When the cookie value\nis decoded and decrypted, the script expects one of the following commands followed\nby any additional parameters:\n```\n Command Function\n put Accepts a file name and writes the contents\n                          of “data” request parameter to a file in\n                          the working directory\n update Overwrites the shell itself with the\n                          content of the “data” request parameter\n time Updates the timestamp on a specific file\n                          with a specified timestamp (creation, last\n                          write and access).\n cmd Executes a provided command using “cmd.exe”\n del Deletes a specified file\n get Gets a specified filename from the working\n                          directory and returns its contents to the\n                          requestor\n\n#### TLP WHITE\n\n```\nPage 19 of 27\n\n|Command Function|Col2|\n|---|---|\n|put Accepts a file name and writes the contents of “data” request parameter to a file in the working directory||\n|update Overwrites the shell itself with the content of the “data” request parameter||\n|time Updates the timestamp on a specific file with a specified timestamp (creation, last write and access).||\n|cmd Executes a provided command using “cmd.exe”||\n|del Deletes a specified file||\n|get|Gets a specified filename from the working directory and returns its contents to the requestor|\n\n\n-----\n\n#### TLP WHITE\n\n### Appendix A\n#### Neuron Client\n```\n File Name neuron-client.exe\n Description Neuron Client\n File Size 55808\n (bytes)\n MD5 4ed42233962a89deaa89fd7b989db081\n SHA1 cf731ee0af5c19231ff51af589f7434c0367d508\n SHA256 a96c57c35df18ac20d83b08a88e502071bd0033add0914b951adbd1639b0b873\n File Name Sign.exe\n Description Dropper for the Neuron Client\n File Size 115712\n (bytes)\n MD5 3cd5fa46507657f723719b7809d2d1f9\n SHA1 34ddc14b9a04eba98c3aa1cb27033e12ec847e03\n SHA256 a6dbc36c472b3ba70a98efd0db35e75c340086be15d3c3ab4e39033604d0bcf9\n File Name mydoc.doc\n Description Macro document that drops and runs Sign.exe (client dropper)\n File Size 591360\n (bytes)\n MD5 66f4f1384105ce7ee1636d34f2afb1c9\n SHA1 3f23d152cc7badf728dfd60f6baa5c861a500630\n SHA256 42fbb2437faf68bae5c5877bed4d257e14788ff81f670926e1d4bbe731e7981b\n File Name N/A\n Description Macro document that drops and runs Sign.exe (client dropper)\n File Size 590336\n (bytes)\n MD5 0e430b6b203099f9c305681e1dcff375\n SHA1 845f3048fb0cfbdfb35bf6ced47da1d91ff2e2b1\n SHA256 bbe3700b5066d524dd961bd47e193ab2c34565577ce91e6d28bdaf609d2d97a8\n\n TLP WHITE\n\n```\nPage 20 of 27\n\n|File Name neuron-client.exe|Col2|\n|---|---|\n|Description Neuron Client||\n|File Size 55808 (bytes)||\n|MD5 4ed42233962a89deaa89fd7b989db081||\n|SHA1 cf731ee0af5c19231ff51af589f7434c0367d508||\n|SHA256|a96c57c35df18ac20d83b08a88e502071bd0033add0914b951adbd1639b0b873|\n\n|File Name Sign.exe|Col2|\n|---|---|\n|Description Dropper for the Neuron Client||\n|File Size 115712 (bytes)||\n|MD5 3cd5fa46507657f723719b7809d2d1f9||\n|SHA1 34ddc14b9a04eba98c3aa1cb27033e12ec847e03||\n|SHA256|a6dbc36c472b3ba70a98efd0db35e75c340086be15d3c3ab4e39033604d0bcf9|\n\n|File Name mydoc.doc|Col2|\n|---|---|\n|Description Macro document that drops and runs Sign.exe (client dropper)||\n|File Size 591360 (bytes)||\n|MD5 66f4f1384105ce7ee1636d34f2afb1c9||\n|SHA1 3f23d152cc7badf728dfd60f6baa5c861a500630||\n|SHA256|42fbb2437faf68bae5c5877bed4d257e14788ff81f670926e1d4bbe731e7981b|\n\n|File Name N/A|Col2|\n|---|---|\n|Description Macro document that drops and runs Sign.exe (client dropper)||\n|File Size 590336 (bytes)||\n|MD5 0e430b6b203099f9c305681e1dcff375||\n|SHA1 845f3048fb0cfbdfb35bf6ced47da1d91ff2e2b1||\n|SHA256|bbe3700b5066d524dd961bd47e193ab2c34565577ce91e6d28bdaf609d2d97a8|\n\n\n-----\n\n#### TLP WHITE\n\n Neuron Service\n```\n File Name Microsoft.Exchange.Service.exe\n Description Neuron Service\n File Size (bytes) 43008\n MD5 0f12268221e27406351a6313f902b498\n SHA1 b0dbdc81a0e367330007b7e593d8dabf92ca7afd\n SHA256 d1d7a96fcadc137e80ad866c838502713db9cdfe59939342b8e3beacf9c7fe29\n File Name w3wpdiag.exe\n Description Neuron Service\n File Size (bytes) 59392\n MD5 371b4380080e3d94ffcae1a7e9a0d5e2\n SHA1 f7088075d1c798f27b0d269c97dc877ff16f1401\n SHA256 2986bae15cfa78b919d21dc070be944e949a027e8047a812026e35c66ab17353\n File Name Updater.exe\n Description Neuron Service\n File Size (bytes) 44544\n MD5 8229622a9790d75e09a099e8758d5703\n SHA1 10586913ceeecd408da4e656c29ed4e91c6b758e\n SHA256 2f4d6a3c87770c7d42d1a1b71ed021a083b08f69ccaf63c15428c7bc6f69cb10\n File Name w3wpdiag.exe\n Description Neuron Service\n File Size (bytes) 58880\n MD5 a3bdc385cf68019449027bd6d8cecb4d\n SHA1 fe8da5a1e62a8d4f627834b0f26c802a330d8d45\n SHA256 0f4e9e391696ed8b9172985bb43cca7d7f2c8a4ae0493e4bf1f15b90f7138259\n File Name dropper-svc.exe\n Description Dropper for the Neuron service\n File Size (bytes) 85008\n MD5 d6ef3c8f2c3f3ddffbb70f5dadfa982c\n SHA1 934b288075c122165897276b360c61e77cb7bde0\n SHA256 fa543de359d498150cbcb67c1631e726a4b14b0a859573185cede5b12ad2abfb\n\n TLP WHITE\n\n```\nPage 21 of 27\n\n|Neuron Service|Col2|\n|---|---|\n|File Name Microsoft.Exchange.Service.exe||\n|Description Neuron Service||\n|File Size (bytes) 43008||\n|MD5 0f12268221e27406351a6313f902b498||\n|SHA1 b0dbdc81a0e367330007b7e593d8dabf92ca7afd||\n|SHA256|d1d7a96fcadc137e80ad866c838502713db9cdfe59939342b8e3beacf9c7fe29|\n\n|File Name w3wpdiag.exe|Col2|\n|---|---|\n|Description Neuron Service||\n|File Size (bytes) 59392||\n|MD5 371b4380080e3d94ffcae1a7e9a0d5e2||\n|SHA1 f7088075d1c798f27b0d269c97dc877ff16f1401||\n|SHA256|2986bae15cfa78b919d21dc070be944e949a027e8047a812026e35c66ab17353|\n\n|File Name Updater.exe|Col2|\n|---|---|\n|Description Neuron Service||\n|File Size (bytes) 44544||\n|MD5 8229622a9790d75e09a099e8758d5703||\n|SHA1 10586913ceeecd408da4e656c29ed4e91c6b758e||\n|SHA256|2f4d6a3c87770c7d42d1a1b71ed021a083b08f69ccaf63c15428c7bc6f69cb10|\n\n|File Name w3wpdiag.exe|Col2|\n|---|---|\n|Description Neuron Service||\n|File Size (bytes) 58880||\n|MD5 a3bdc385cf68019449027bd6d8cecb4d||\n|SHA1 fe8da5a1e62a8d4f627834b0f26c802a330d8d45||\n|SHA256|0f4e9e391696ed8b9172985bb43cca7d7f2c8a4ae0493e4bf1f15b90f7138259|\n\n|File Name dropper-svc.exe|Col2|\n|---|---|\n|Description Dropper for the Neuron service||\n|File Size (bytes) 85008||\n|MD5 d6ef3c8f2c3f3ddffbb70f5dadfa982c||\n|SHA1 934b288075c122165897276b360c61e77cb7bde0||\n|SHA256|fa543de359d498150cbcb67c1631e726a4b14b0a859573185cede5b12ad2abfb|\n\n\n-----\n\n##### Neuron Yara\n\n\n#### TLP WHITE\n```\n  description = \"Rule for detection of Neuron based on commonly used strings\"\n  hash = \"d1d7a96fcadc137e80ad866c838502713db9cdfe59939342b8e3beacf9c7fe29\"\n\"PFJTQUtleVZhbHVlPjxNb2R1bHVzPnZ3WXRKcnNRZjVTcCtWVG9Rb2xuaEVkMHVwWDFrVElFTUNTNEFnRkRCclNm\nclpKS0owN3BYYjh2b2FxdUtseXF2RzBJcHV0YXhDMVRYazRoeFNrdEpzbHljU3RFaHBUc1l4OVBEcURabVVZVklVb\nHlwSFN1K3ljWUJWVFdubTZmN0JTNW1pYnM0UWhMZElRbnl1ajFMQyt6TUhwZ0xmdEc2b1d5b0hyd1ZNaz08L01vZH\n  $strB64RegKeySubstring = \"U09GVFdBUkVcTWljcm9zb2Z0XENyeXB0b2dyYXBo\" wide\n  (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $dotnetMagic and 6 of\n\n TLP WHITE\n\n```\nPage 22 of 27\n\n\n-----\n\n#### TLP WHITE\n```\n  description = \"Rule for detection of Neuron based on a standalone signature from .NET\n  hash = \"d1d7a96fcadc137e80ad866c838502713db9cdfe59939342b8e3beacf9c7fe29\"\n{eb073d151231011234080e12818d1d051281311d1281211d1281211d128121081d1281211d1281211d128121\n1d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211\nd1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281211d1281}\n  (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and all of them\n\n TLP WHITE\n\n```\nPage 23 of 27\n\n\n-----\n\n#### TLP WHITE\n```\n  description = \"Rule for detection of Neuron based on .NET function, variable and\n  hash = \"d1d7a96fcadc137e80ad866c838502713db9cdfe59939342b8e3beacf9c7fe29\"\n  (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $dotnetMagic and 6 of\n\n TLP WHITE\n\n```\nPage 24 of 27\n\n\n-----\n\n#### TLP WHITE\n\n Nautilus\n```\n File Name dcomnetsrv.dll\n Description Nautilus Loader DLL\n File Size (bytes) 121344\n MD5 2f742ec3bb7590602bc3e97326f2476a\n SHA1 9d280e3ef1b180449086dda5b92a7b9bbe63dee4\n SHA256 a415ab193f6cd832a0de4fcc48d5f53d6f0b06d5e13b3c359878c6c31f3e7ec3\n File Name oxygen.dll\n Description Nautilus Injected payload\n File Size (bytes) 620568\n MD5 ea874ac436223b30743fc9979eed5f2f\n SHA1 5ed61ec7de11922582f07c3488ef943b439ee226\n SHA256 cefc5cf4d46abb86fb0f7c81549777cf1a2a5bfbe1ce9e7d08128ab8bfc978f8\n\n##### Nautilus Yara\n rule nautilus_modified_rc4_loop {\n  meta:\n   description = \"Rule for detection of Nautilus based on assembly code for a modified\n RC4 loop\"\n   author = \"NCSC UK\"\n   hash = \"a415ab193f6cd832a0de4fcc48d5f53d6f0b06d5e13b3c359878c6c31f3e7ec3\"\n  strings:\n   $a = {42 0F B6 14 04 41 FF C0 03 D7 0F B6 CA 8A 14 0C 43 32 14 13 41 88 12 49 FF C2\n 49 FF C9}\n  condition:\n   (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and $a\n }\n\n#### TLP WHITE\n\n```\nPage 25 of 27\n\n|Nautilus|Col2|\n|---|---|\n|File Name dcomnetsrv.dll||\n|Description Nautilus Loader DLL||\n|File Size (bytes) 121344||\n|MD5 2f742ec3bb7590602bc3e97326f2476a||\n|SHA1 9d280e3ef1b180449086dda5b92a7b9bbe63dee4||\n|SHA256|a415ab193f6cd832a0de4fcc48d5f53d6f0b06d5e13b3c359878c6c31f3e7ec3|\n\n|File Name oxygen.dll|Col2|\n|---|---|\n|Description Nautilus Injected payload||\n|File Size (bytes) 620568||\n|MD5 ea874ac436223b30743fc9979eed5f2f||\n|SHA1 5ed61ec7de11922582f07c3488ef943b439ee226||\n|SHA256|cefc5cf4d46abb86fb0f7c81549777cf1a2a5bfbe1ce9e7d08128ab8bfc978f8|\n\n\n-----\n\n#### TLP WHITE\n```\n  description = \"Rule for detection of Nautilus based on a hardcoded RC4 key\"\n  hash = \"a415ab193f6cd832a0de4fcc48d5f53d6f0b06d5e13b3c359878c6c31f3e7ec3\"\n  $key = {31 42 31 34 34 30 44 39 30 46 43 39 42 43 42 34 36 41 39 41 43 39 36 34 33 38\n  description = \"Rule for detection of Nautilus based on common plaintext strings\"\n  hash = \"a415ab193f6cd832a0de4fcc48d5f53d6f0b06d5e13b3c359878c6c31f3e7ec3\"\n  $ = \"C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Caches\\\\{%s}.2.ver0x0000000000000001.db\"\n  (uint16(0) == 0x5A4D and uint16(uint32(0x3c)) == 0x4550) and 3 of them\n\n TLP WHITE\n\n```\nPage 26 of 27\n\n\n-----\n\n#### TLP WHITE\n\n Additional Indicators for Forensic Analysis\n\nThe following indicators can be used to search for the presence of Neuron and\nNautilus malware within forensic analysis tools.\n```\n $zf(-1,\n $zf(-2,\n {\"instructions\":[{\"type\":\n App_Web_juvjerf3.dll\n App_Web_vcplrg8q.dll\n ar_all2.txt\n ar_sa.txt\n Convert.FromBase64String(temp[1])\n D68gq#5p0(3Ndsk!\n dx11.exe\n ERRORF~1.ASP\n errorFE.aspx\n errorfe.aspx.f5dba9b9.compiled\n intelliAdminRpc\n J8fs4F4rnP7nFl#f\n lsa.exe\n Msnb.exe\n msrpc.exe\n Neuron_service\n owa.exe\n owa_ar2.bat\n rexec.exe\n payload.x64.dll.system\n service.x64.dll.system\n\n#### TLP WHITE\n\n```\nPage 27 of 27\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/316mbg901wxjdarmtdlj6v4qv29a0ge8"
    ],
    "report_names": [
        "NCSC_Turla-Neuron-Nautilus-Snake-malware_1(11-22-2017)"
    ],
    "threat_actors": [
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1511452795,
    "ts_modification_date": 1511452795,
    "files": {
        "pdf": "https://archive.orkl.eu/316cd38c3939a4f862b611888a489672c014b651.pdf",
        "text": "https://archive.orkl.eu/316cd38c3939a4f862b611888a489672c014b651.txt",
        "img": "https://archive.orkl.eu/316cd38c3939a4f862b611888a489672c014b651.jpg"
    }
}