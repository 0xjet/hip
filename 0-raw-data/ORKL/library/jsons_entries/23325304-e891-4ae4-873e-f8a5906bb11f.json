{
    "id": "23325304-e891-4ae4-873e-f8a5906bb11f",
    "created_at": "2023-01-12T15:00:05.635855Z",
    "updated_at": "2025-03-27T02:08:36.21163Z",
    "deleted_at": null,
    "sha1_hash": "3afd383504e37022acf1390235550db06111cf60",
    "title": "2014-12-17 - Dyre Banking Trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T19:56:51Z",
    "file_modification_date": "2022-05-28T19:56:51Z",
    "file_size": 568123,
    "plain_text": "# Dyre Banking Trojan\n\n**secureworks.com/research/dyre-banking-trojan**\n\nWednesday, December 17, 2014\n\n**Author: Brett Stone-Gross and Pallav Khandhar, Dell SecureWorks Counter Threat Unit™**\nThreat Intelligence\n**Date: 17 December 2014**\n\n**Summary**\n\nThreat actors regularly develop new Trojan horse malware to fuel their operations and to ensure\nthe longevity of their botnets. After the takedowns of the Gameover Zeus and Shylock botnets,\nresearchers predicted that a new breed of banking malware would fill the void. In early June\n2014, the Dell SecureWorks Counter Threat Unit™ (CTU™) research team discovered the Dyre\nbanking trojan, which was being distributed by Cutwail botnet spam emails that included links to\neither Dropbox or Cubby file storage services. The threat actors later shifted to distribution via\nthe Upatre downloader trojan. Dyre is also known as Dyreza, Dyzap, and Dyranges by the\nantivirus industry.\n\n**Capabilities**\n\nDyre harvests credentials, primarily targeting online banking websites to perform Automated\nClearing House (ACH) and wire fraud. The malware includes a modular architecture, man-in-thebrowser functionality, and a backconnect server that allows threat actors to connect to a bank\nwebsite through the victim's computer. The man-in-the-browser functionality is based on a unique\ncombination of redirects to fake websites controlled by the threat actor (\"web fakes\") and a\ndynamic web inject system that allows the threat actors to manipulate a financial institution's\nwebsite content. Similar to other banking trojans, Dyre hooks into the most popular web browsers\nto intercept traffic from a victim's system, stealing information and manipulating website content\nbefore it is rendered by the browser.\n\nEarly Dyre versions were relatively primitive, sending command and control (C2)\ncommunications and stolen data via unencrypted HTTP. Recent iterations of Dyre use SSL to\nencrypt all C2 communications, as well as a custom encryption algorithm. Dyre also uses RSA\ncryptography to digitally sign configuration files and malware plugins to prevent tampering.\n\n**Malware distribution**\n\nEach Dyre binary has an ID value that allows the malware operators to identify the campaign\nassociated with each compromise. These campaigns are often localized to target specific\ngeographic regions. Since Dyre's introduction, the CTU research team has identified 21 unique\n\n\n-----\n\nDyre campaigns (see Figure 1). As of this publication, Dyre has targeted more than 242 financial\ninstitutions.\n\n_Figure 1. Distribution of active Dyre campaigns observed by CTU researchers as of this_\n_publication. (Source: Dell SecureWorks)_\n\n**_Malware distribution vector_**\n\nDyre is downloaded and installed on compromised systems by the Upatre downloader trojan,\nwhich is distributed through spam emails sent by the Cutwail botnet and at least two other spam\nbotnets. The emails contain Upatre as an embedded malware executable in a ZIP attachment\n(see Figure 2) or as a malicious URL. In both instances, user interaction is required to\ncompromise the targeted system. Dyre campaigns use different lures, such as impersonating\nFedEx invoices, electronic faxes, and payroll or financial documents.\n\n_Figure 2. Spam email lure samples dropping Dyre via Upatre downloader as an attachment._\n_(Source: Dell SecureWorks)_\n\n**Architecture**\n\n\n-----\n\nThe Dyre malware is packed and obfuscated in multiple layers, and it is divided into two\nmodules: the dropper and the main DLL module. The DLL module is stored in two distinct\nresources named payload32 and payload64, which Dyre activates on 32-bit or 64-bit Windows\nplatforms, respectively. The malware drops a slightly modified copy of itself, using a random\nfilename like \"tlBTyLNuJkruXja.exe,\" in the C:\\Windows folder (see Figure 3). When Dyre\nlaunches this file, malicious code is injected into svchost.exe.\n\n_Figure 3. Default location for dropped Dyre files. (Source: Dell SecureWorks)_\n\nFor persistence, Dyre registers as a system service under \"Google Update Service\" by adding an\nHKLM\\SYSTEM\\ControlSet001\\Services\\googleupdate registry key (see Figure 4).\n\n_Figure 4. Dyre's persistence mechanism. (Source: Dell SecureWorks)_\n\nThe malware hides its base configuration file, RSA key, and other important data within the\nresource section of the Dyre DLL (see Figure 5).\n\n_Figure 5. Dyre resource section containing important data. (Source: Dell SecureWorks)_\n\n\n-----\n\nDyre beacons to the hard-coded IP addresses listed in the base configuration file. The first\nrequest registers a bot on the C2 server. The malware sends the compromised system's\noperating system information to the C2 server and continues beaconing requests.\n\nDyre's web inject engine uses a slightly different approach than other banking trojans. The\ninjected process hooks code into Mozilla Firefox, Google Chrome, and Microsoft Internet\nExplorer, intercepting victims' credentials when they log into a bank account or other financial\nservice. For each web browser, Dyre hooks different functions within the loaded DLLs:\n\nFirefox: PR_Read and PR_Write functions within nspr4.dll\nChrome: ssl_read and ssl_write functions within chrome.dll\nInternet Explorer: functions within wininet.dll\n\nWhen a victim on a compromised system visits one of the targeted banking websites and enters\nlogin credentials, Dyre intercepts the data and sends a POST request to the threat actor's drop\nserver. The request includes cookies and browser information. The malware can also manipulate\nbanking website content dynamically, which can be used to circumvent two-factor authentication\nschemes.\n\n**Command and control traffic**\n\nDyre contacts Google to check network connectivity and then submits a Session Traversal\n[Utilities for NAT (STUN) binding request (see Figure 6). STUN allows a system located behind a](http://en.wikipedia.org/wiki/STUN)\nnetwork address translator (NAT) to discover a public IP address.\n\n_Figure 6. Dyre's network connectivity check and STUN requests. (Source: Dell SecureWorks)_\n\nThe STUN servers listed in Table 1 are hard-coded in the Dyre binary.\n\nstun1.voiceeclipse.net stun.callwithus.com stun.sipgate.net\n\nstun.ekiga.net stun.ideasip.com stun.internetcalls.com\n\nstun.noc.ams-ix.net stun.phonepower.com stun.voip.aebc.com\n\nstun.voipbuster.com stun.voxgratia.org stun.ipshka.com\n\nstun.faktortel.com.au stun.iptel.org stun.voipstunt.com\n\n\n-----\n\nstunserver.org s1.taraba.net s2.taraba.net\n\nstun.l.google.com:19302 stun1.l.google.com:19302 stun2.l.google.com:19302\n\nstun3.l.google.com:19302 stun4.l.google.com:19302 stun.schlund.de\n\nstun.rixtelecom.se stun.voiparound.com numb.viagenie.ca\n\nstun.stunprotocol.org stun.2talk.co.nz\n\n_Table 1. Hard-coded STUN servers._\n\nTo hide its backend infrastructure, Dyre deploys a set of proxy servers that act as C2 servers. As\nshown in Figure 7, these servers are primarily located in North America and Europe. The threat\nactors have also implemented additional methods to maintain control of the botnet.\n\n_Figure 7. Geographic distribution of Dyre C2 servers. (Source: Dell SecureWorks)_\n\nDyre uses SSL to communicate with its C2 server. The requests use a standard structure,\nsubstituting appropriate values for the <Campaign ID>, <Bot ID>, and <Architecture> variables:\n\n\n-----\n\n```\nGET / Campaign ID / Bot ID /5/cert/EXT IP/HTTP/1.1 (Register the Bot)\nGET /<Campaign ID>/<Bot ID>/0/Win_XP_32bit/1023/EXT-IP/HTTP/1.1 (Register OS of Bot)\nGET /<Campaign ID>/<Bot ID>/1/FcJgUwyCWvgLPymGiJGwUkwCVcBMmiD/EXT-IP/(Send live signal)\nGET /<Campaign ID>/<Bot ID>/5/httprdc/EXT-IP/HTTP/1.1 (Ask for web fakes configuration\ndata with target list)\nGET /<Campaign ID>/<Bot ID>/5/respparser/EXT-IP/HTTP/1.1 (Request dynamic web inject\nconfiguration)\nGET /<Campaign ID>/<Bot ID>/5/twg<Architecture>/EXT-IP/HTTP/1.1 (Request grabber plugin)\nGET /<Campaign ID>/<Bot ID>/5/i2p<Architecture>/EXT-IP/HTTP/1.1 (Request I2P plugin)\nGET /<Campaign ID>/<Bot ID>/5/n_vnc<Architecture>/EXT-IP/HTTP/1.1 (Request VNC plugin)\nGET /<Campaign ID>/<Bot ID>/5/n_tv<Architecture>/EXT-IP/HTTP/1.1 (Request TV plugin)\nGET /<Campaign ID>/<Bot ID>/5/cfg_bc/EXT-IP/HTTP/1.1 (Request back connect configuration)\nGET /<Campaign ID>/<Bot ID>/14/NAT/Port%20restricted%20NAT/0/EXT-IP/(NAT status)\n\n```\nFigure 8 shows a Dyre request for the configuration file identifying the list of URLs to redirect to\nthe malicious server hosting the web fake. The C2 server's reply is encrypted with a custom\nencryption algorithm, and the payload is digitally signed using a 1024-bit RSA key.\n\n_Figure 8. Dyre's configuration request to the C2 server. (Source: Dell SecureWorks)_\n\nDyre performs a man-in-the-browser attack to steal data sent to a legitimate bank website. The\nmalware sends the stolen data to its exfiltration server in an HTTP POST request (see Figure 9).\n\n\n-----\n\n_Figure 9. Dyre HTTP POST request to exfiltration server. (Source: Dell SecureWorks)_\n\n**Command and control resiliency**\n\nSince Dyre’s inception, it has relied upon a set of hard-coded proxy servers to communicate with\nits backend infrastructure. The threat actors have implemented two mechanisms to maintain\ncontrol of the botnet if the proxies are unreachable: a domain generation algorithm and a plugin\nthat integrates with an anonymization network called I2P.\n\n**_Domain generation algorithm_**\n\nSimilar to other malware families, Dyre uses a domain generation algorithm (DGA) that is seeded\nby the current date. It generates 1,000 34-character domains per day, which are appended to\none of eight country code top-level domains (ccTLDs) in Asia and the Pacific Islands: .cc, .ws,\n.to, .in, .hk, .cn, .tk, and .so. The following domains were generated on December 8, 2014:\n\ny3aaa48a7056d7075c3760cdbd90a75b8f.cc\nz376dfe4955a257a78944864dd0158d172.ws\na8377c5a7c390331b15c1df94fa745e38a.to\nba3be71036fc2c06d603a2b17d41ffe71a.in\nc9cca04cec2588918820cf33ba4337cca8.hk\ndec4f75e53d7202136164e2b26456dabdf.cn\ne3d68349d47efa0d5a9a92b1239bc4d48c.tk\nf85db5ce8675f53b61f00ca0e822a33312.so\n\nCTU researchers sinkholed a Dyre DGA domain to identify sources of infection and to ascertain\nthe number of compromised systems that resorted to the DGA for command and control. During\na 24-hour interval, the sinkhole received requests from 8,815 unique IP addresses. The U.S. led\nthe number of compromised systems with 59%, followed by Canada with 8%, Portugal with 7%,\nthe UK with 5%, and Turkey with 3% (see Figure 10).\n\n\n-----\n\n_Figure 10. Infected Dyre bots reaching out to DGA domains. (Source: Dell SecureWorks)_\n\n**_I2P_**\n\nThe Invisible Internet Project (I2P) is an overlay network similar to Tor that offers anonymity. It\nprovides anonymous hosting known as eepSites, which are similar to Tor's hidden services.\neepSites allow users to access websites in a way that masks the true location of the server, so\nthat it cannot be easily identified and taken down. On December 3, 2014, CTU researchers\nobserved a Dyre sample that included the following I2P eepSite domain:\nnhgyzrn2p2gejk57wveao5kxa7b3nhtc4saoonjpsy65mapycaua.b32.i2p.\n\nDyre's implementation of an I2P plugin has several tradeoffs. It makes the malware's backend\nserver more difficult to trace, and the encapsulation of Dyre requests using I2P's encrypted\nprotocol could complicate development of network-based signatures. However, I2P has not been\nwidely adopted, so its presence may also be used to identify compromises.\n\n**Connection to Gozi Neverquest**\n\nCTU researchers have observed a relationship between the Dyre trojan and the Neverquest\nvariant of Gozi. On several occasions, Gozi Neverquest pushed commands to download and\nexecute a Dyre executable, and there have been other instances of Dyre issuing commands to\ndownload and execute a Gozi Neverquest executable. These examples suggest that one or more\nof the same threat actors are involved with both botnets, and they may leverage each trojan\naccording to their specific needs.\n\n**Conclusion**\n\nDyre has emerged from its early stages of development to become one of the most prominent\nbanking trojans. Each iteration included refinements and new features to make it more powerful\nand robust. The version of Dyre being distributed as of this publication provides advanced\ncapabilities with web fakes, dynamic web injects, a modular design, and multiple methods for\nmaintaining command and control. The introduction of Dyre shortly after the takedown of\nGameover Zeus shows the determination of threat actors targeting the financial vertical.\n\n**Threat indicators**\n\n\n-----\n\nThe threat indicators in Table 2 can be used to detect activity related to the Dyre banking\nmalware. The IP addresses listed in the indicators table may contain malicious content, so\nconsider the risks before opening them in a browser.\n\nIndicator Type Context\n\n\n0a77a39285d6bc816791320bb13408e5 MD5\nhash\n\nc3980a6228b68f88a0718de7a0362116 MD5\nhash\n\nb5b3af636f545da62f87c2773aa99016 MD5\nhash\n\nec525c578d14a15d8d913e83ec5c557b MD5\nhash\n\n32d32802a97b9c24e1eafcea6af52440 MD5\nhash\n\n2d8923ef39b1fa0a091965735f3490f3 MD5\nhash\n\n1a52993e4546c3d6adad037af74ce2a8 MD5\nhash\n\n156f730bbb6b6cada4ef89e22ddc68ab MD5\nhash\n\n3597f17748f9bb7d008840a4b1391582 MD5\nhash\n\nc6315a09e06e2ba775e5be0979d23755 MD5\nhash\n\n5.79.86.19 IP\naddress\n\n212.56.214.154 IP\naddress\n\n202.153.35.133 IP\naddress\n\n80.248.224.75 IP\naddress\n\n109.228.17.152 IP\naddress\n\n166.78.103.85 IP\naddress\n\n\nDyre trojan\n\nDyre trojan\n\nDyre trojan\n\nDyre trojan\n\nDyre trojan\n\nDyre trojan\n\nDyre trojan\n\nDyre trojan\n\nDyre trojan\n\nDyre trojan\n\nDyre\nexfiltration/web\ninject server\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\n\n-----\n\n109.228.17.158 IP\naddress\n\n109.228.17.155 IP\naddress\n\n176.114.0.58 IP\naddress\n\n85.25.134.53 IP\naddress\n\n217.172.181.164 IP\naddress\n\n217.172.184.75 IP\naddress\n\n213.239.209.196 IP\naddress\n\n212.56.214.130 IP\naddress\n\n37.59.2.42 IP\naddress\n\n93.190.139.178 IP\naddress\n\n85.25.138.12 IP\naddress\n\n85.25.145.179 IP\naddress\n\n217.172.179.9 IP\naddress\n\n203.183.172.196 IP\naddress\n\n94.23.61.172 IP\naddress\n\n94.23.196.90 IP\naddress\n\n217.23.8.68 IP\naddress\n\n193.203.50.17 IP\naddress\n\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre C2\nserver\n\n\n-----\n\n193.203.50.69 IP\naddress\n\nnhgyzrn2p2gejk57wveao5kxa7b3nhtc4saoonjpsy65mapycaua.b32.i2p I2P\ndomain\n\n\nDyre C2\nserver\n\nDyre C2\nserver\n\nDyre UserAgent\n\nDyre UserAgent\n\n\nMozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101\nFirefox/33.0\n\nMozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36\n(KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36\n\n\nUserAgent\n\nUserAgent\n\n\ncd2sd48za09 Mutex Mutex created\nby Dyre\n\n5efw48e8re54 Mutex Mutex created\nby Dyre\n\n_Table 2. Threat indicators for the Dyre trojan._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-12-17 - Dyre Banking Trojan.pdf"
    ],
    "report_names": [
        "2014-12-17 - Dyre Banking Trojan.pdf"
    ],
    "threat_actors": [
        {
            "id": "77b28afd-8187-4917-a453-1d5a279cb5e4",
            "created_at": "2022-10-25T15:50:23.768278Z",
            "updated_at": "2025-03-27T02:00:55.5423Z",
            "deleted_at": null,
            "main_name": "Inception",
            "aliases": [
                "Inception Framework",
                "Cloud Atlas"
            ],
            "source_name": "MITRE:Inception",
            "tools": [
                "PowerShower",
                "VBShower",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535605,
    "ts_updated_at": 1743041316,
    "ts_creation_date": 1653767811,
    "ts_modification_date": 1653767811,
    "files": {
        "pdf": "https://archive.orkl.eu/3afd383504e37022acf1390235550db06111cf60.pdf",
        "text": "https://archive.orkl.eu/3afd383504e37022acf1390235550db06111cf60.txt",
        "img": "https://archive.orkl.eu/3afd383504e37022acf1390235550db06111cf60.jpg"
    }
}