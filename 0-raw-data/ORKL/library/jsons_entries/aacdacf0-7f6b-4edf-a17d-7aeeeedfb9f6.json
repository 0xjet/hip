{
    "id": "aacdacf0-7f6b-4edf-a17d-7aeeeedfb9f6",
    "created_at": "2023-02-02T02:07:33.519453Z",
    "updated_at": "2025-03-27T02:13:11.614055Z",
    "deleted_at": null,
    "sha1_hash": "6e127606768e4691439bb48b8b38349913ad1b7a",
    "title": "2022-10-31 - APT10- Tracking down LODEINFO 2022, part I",
    "authors": "",
    "file_creation_date": "2023-02-01T07:37:46Z",
    "file_modification_date": "2023-02-01T07:37:46Z",
    "file_size": 1762350,
    "plain_text": "# APT10: Tracking down LODEINFO 2022, part I\n\n**[securelist.com/apt10-tracking-down-lodeinfo-2022-part-i/107742/](https://securelist.com/apt10-tracking-down-lodeinfo-2022-part-i/107742/)**\n\nAuthors\n\n[Suguru Ishimaru](https://securelist.com/author/suguru/)\n\n## New infection vector using SFX file and DOWNIISSA downloader\n\nKaspersky has been tracking activities involving the LODEINFO malware family since 2019,\nlooking for new modifications and thoroughly investigating any attacks utilizing those new\n[variants. LODEINFO is sophisticated fileless malware first named in a blogpost from](https://blogs.jpcert.or.jp/en/2020/02/malware-lodeinfo-targeting-japan.html)\nJPCERT/CC in February 2020. The malware was regularly modified and upgraded by the\ndevelopers to target media, diplomatic, governmental and public sector organizations and\nthink-tanks in Japan.\n\n\n-----\n\n**_Japan is likely the main target of LODEINFO_**\n\nResearchers continued tracking LODEINFO after that. JPCERT/CC and Macnica Networks\n[shared](https://blogs.jpcert.or.jp/en/2021/02/LODEINFO-3.html) [additional](https://vb2020.vblocalhost.com/uploads/VB2020-66.pdf) [updates on LODEINFO activities in a later publication. Kaspersky](https://www.macnica.co.jp/business/security/cyberespionage_report_2021_6.pdf)\n[researchers also shared new findings during the HITCON 2021 conference, covering](https://hitcon.org/2021/en/agenda/6d88317b-4d90-4249-ba87-d81c80a21382/)\nLODEINFO activities from 2019 to 2020, and revealing high-confidence attribution to APT10.\n\nIn March 2022, we observed a Microsoft Word file that was used as the infection vector in\nsome attacks. In June of the same year, a SFX file was discovered targeting the Japanese\ngovernment or related organizations using a decoy file with Japanese content, as well as\nutilizing the name of a famous Japanese politician in the filename. A new downloader\nshellcode named DOWNIISSA that is used to deploy the LODEINFO backdoor was also\nobserved.\n\nThe first part of this report will provide technical analysis of the new infection methods such\nas SFX files and DOWNIISSA along with our findings. The second part will provide technical\nanalysis of the LODEINFO backdoor and the related shellcode for each version of the\nbackdoor with the latest LODEINFO IoCs and related information discovered in 2022.\n\nCustomers of Kaspersky Threat Intelligence Service have access to additional private APT\nreports describing past LODEINFO activities.\n\n\n-----\n\n## Initial infection #1: VBA + DLL sideloading\n\nDuring our investigation of the attacks in March 2022, we observed a spear-phishing email\nwith a malicious attachment installing malware persistence modules, which consisted of a\nlegitimate EXE file and a malicious DLL file loaded via the DLL sideloading technique. For\nexample, the following section describes a malicious Microsoft Word file (MD5:\n[da20ff8988198063b56680833c298113) that was uploaded to Virustotal. Once the target](https://opentip.kaspersky.com/da20ff8988198063b56680833c298113/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nopens the malicious doc file, a message in Japanese is displayed (インターネットセキュリ\nティ設定によると、ファイルを開くために、上の黄色のドキュメントバーの「編集を有効に\nする」と「コンテンツの有効化」をクリックしてください。Translation: “According to your\n_internet security settings, click “Enable Editing” and “Enable Content” on the yellow_\n_document bar above to open this file.”) to trick the victims into clicking “Enable Content” and_\nenabling the embedded macro.\n\n**_The message in Japanese to trick the target into clicking “Enable Content” and_**\n**_embedded VBA code_**\n\nThe embedded VBA code creates the folder C:\\Users\\Public\\TMWJPA\\ and drops a zip file\nnamed GFIUFR.zip (MD5: [89bd9cf51f8e01bc3b6ec025ed5775fc) in the same folder. The](https://opentip.kaspersky.com/89bd9cf51f8e01bc3b6ec025ed5775fc/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nGFIUFR.zip contains two files named NRTOLF.exe and K7SysMn1.dll. NRTOLF.exe (MD5:\n[7f7d8c9c1b6735807aefb0841b78f389) is a digitally signed legitimate EXE file from the](https://opentip.kaspersky.com/7f7d8c9c1b6735807aefb0841b78f389/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nK7Security Suite software used for DLL sideloading. K7SysMn1.dll (MD5:\n[cb2fcd4fd44a7b98af37c6542b198f8d) is a malicious DLL sideloaded by NRTOLF.exe. The](https://opentip.kaspersky.com/cb2fcd4fd44a7b98af37c6542b198f8d/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nmalicious DLL file contains a loader of the LODEINFO shellcode. This DLL is a known loader\nmodule of LODEINFO. It contains a one-byte XOR-encrypted LODEINFO shellcode\ninternally identified by version 0.5.9. This infection method was also used by the threat actor\nin the previous attacks we investigated.\n\n\n-----\n\nApart from this, we discovered two more implants related to LODEINFO that were used in\nother infection methods in 2022.\n\n## Initial infection #2: SFX + DLL sideloading\n\nOne of the implants is a self-extracting archive (SFX) file in RAR format (MD5\n[76cdb7fe189845a0bc243969dba4e7a3) that was also uploaded to Virustotal. Similarly, the](https://opentip.kaspersky.com/76cdb7fe189845a0bc243969dba4e7a3/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\narchive contains three files named 1.docx, K7SysMn1.dll and K7SysMon.exe, with the selfextracting script commands shown below. There is also a comment added by the malware\nauthor written in Japanese that can be translated as “The following comment contains a self_extracting script command”:_\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n\nComment = ;以下のコメントは自己解凍スクリプトコマンドを含んでいます(\n\nPath=%temp%\\\n\nSetup=%temp%\\1.docx\n\nSetup=%temp%\\K7SysMon.Exe\n\nSilent=1\n\nOverwrite=1\n\nDate   Time  Attr     Size  Compressed Name\n\n------------------- ----- ------------ ------------ -----------------------\n2022-06-14 03:47:04 ....A    11900     9181 1.docx\n\n2021-08-18 18:58:58 ....A    342528    169345 K7SysMn1.dll\n\n2022-04-19 09:44:45 ....A    91464    45247 K7SysMon.Exe\n\n------------------- ----- ------------ ------------ -----------------------\n2022-06-14 03:47:04       445892    223773 3 files\n\n\nWhen a targeted user executes this SFX file, the archive drops other files to %temp% dir and\nopens 1.docx as a decoy containing just a few Japanese words such as 申込書\n(“Application”), 名前 (“name”) and メールアドレス (“email address”), as shown on the\nfollowing screenshot.\n\n\n-----\n\n**_Simple decoy document content from 1.docx_**\n\nWhile showing the decoy file to the user, the archive script starts K7SysMon.exe, which\n[loads the malicious DLL from K7SysMn1.dll (MD5: a8220a76c2fe3f505a7561c3adba5d4a)](https://opentip.kaspersky.com/a8220a76c2fe3f505a7561c3adba5d4a/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nvia DLL sideloading. The K7SysMn1.dll contains a BLOB with an obfuscated routine not\nobserved in past activities. The embedded BLOB is divided into four-byte chunks, and each\npart is stored in one of the 50 randomly named export functions of the DLL binary. These\nexport functions reconstruct the BLOB in an allocated buffer and then decode the\nLODEINFO shellcode using a one-byte XOR key.\n\n\n-----\n\n**_Reassembling the payload BLOB from parts_**\n\nThe payload that is eventually deployed by this implant is the LODEINFO v0.6.3.\n\n## Initial infection #3: SFX + DLL sideloading + additional BLOB file\n\nWe also discovered another similar SFX file named <masked>[1]sns用動画 拡散のお願\nい.exe (Translation: The spreading request for sns movie of <masked>). The attackers\nexploited the name of a well-known Japanese politician. The embedded self-extracting script\nand files are very similar to the previous sample discussed in the Initial Infection #2 section\nof this article. However, this sample contains an additional file named K7SysMon.Exe.db.\nPreviously observed loader modules had a BLOB with the encrypted shellcode embedded in\nthe executable file, but in this sample K7SysMn1.dll does not contain the BLOB. Instead, the\nloader module reads the K7SysMon.Exe.db file as the encrypted BLOB and decrypts the\nshellcode, which is the LODEINFO v0.6.3 backdoor. The title of the SFX file, as well as the\ndocument content, displays a request to spread a video of the famous politician for SNS\n\n\n-----\n\n(Social Network Service). We believe this SFX file was spread via a spear-phishing email on\nJune 29, 2022, based on the last archiving timestamp. The file name and the decoy\ndocument suggest the target was the Japanese ruling party or a related organization.\n\n[On July 4, 2022, another SFX file (MD5 edc27b958c36b3af5ebc3f775ce0bcc7) was](https://opentip.kaspersky.com/edc27b958c36b3af5ebc3f775ce0bcc7/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\ndiscovered. The archived files, the payload and also the C2 address were very similar to the\nprevious sample set. The only notable difference was the Japanese title of the decoy\ndocument: “取材のお願い” (“Request for coverage”). We think this SFX file was probably\nused to target Japanese media companies.\n\n## Initial infection #4: VBA + undiscovered downloader shellcode DOWNIISSA\n\nBack in August 2020, we discovered a fileless downloader shellcode dubbed DOWNJPIT, a\n[variant of the LODEINFO malware, and gave a presentation on it at HITCON 2021. In June](https://hitcon.org/2021/en/agenda/6d88317b-4d90-4249-ba87-d81c80a21382/)\n2022, we found another fileless downloader shellcode delivered by a password-protected\nMicrosoft Word file. The filename is 日米同盟の抑止力及び対処力の強化.doc (“Enhancing the\ndeterrence and coping power of the Japan-US alliance.doc”). The document file contains\nmalicious macro code that is completely different from previously investigated samples. Once\nopened, the doc file shows a Japanese message to enable the following VBA code.\n\n\n-----\n\n**_Malicious VBA code inside MS Word file found in June 2022_**\n\nUnlike past samples, such as the one described in the Initial Infection #1 section of this\narticle, where the malicious VBA macro was used to drop different components of the DLL\nsideloading technique, in this case the malicious macro code injects and loads an embedded\nshellcode in the memory of the WINWORD.exe process directly. This implant was not\npresent in past activities and the shellcode is also a newly discovered multi-stage\ndownloader shellcode for LODEINFO v0.6.5.\n\nThis downloader shellcode was completely different from the DOWNJPIT variant. The new\ndownloader shellcode has two URLs inside:\n\nhttp://172.104.112[.]218/11554.htm\nhttp://www.dvdsesso[.]com/11554.htm\n\nWe named this new downloader DOWNIISSA, where IISSA is a string derived from 11554 in\nthe file names found in the URLs. The following diagram shows the complicated infection\nflow from the malicious document file to the final payload downloaded by DOWNIISSA.\n\n\n-----\n\n**_LODEINFO infection process via DOWNIISSA_**\n\nAs mentioned earlier, the embedded macro generates the DOWNIISSA shellcode and injects\nit in the current process (WINWORD.exe). The main downloader code is base64-encoded\nand placed at the beginning of the DOWNIISSA shellcode, which gets decoded and patched\nby the shellcode itself.\n\n**_DOWNIISSA base64 decode and self-patch_**\n\nAfter it has been decoded, some important strings are found with a one-byte XOR\nencryption. For example, the two C2 destination addresses are decrypted in the following\ncode.\n\n\n-----\n\n**_XORed C2 destinations embedded in the main function of DOWNIISSA shellcode_**\n\nDOWNIISSA uses the URLDownloadToFileA() API function to download the BLOB from the\nURL addresses and drop it as %TEMP%/${temp}.tmp. Then it reads the file into allocated\nmemory in the current process and deletes the downloaded temp file immediately. We\nconfirmed that both URLs served the same binary data that was XORed with the one-byte\nXOR key stored at the end of the BLOB itself. After XOR decryption, the LODEINFO\nbackdoor shellcode v0.6.5 was found. For the final stage of the infection, DOWNIISSA\ncreates an instance of msiexec.exe and injects the LODEINFO backdoor shellcode in the\nmemory of the process.\n\nThis new infection flow involving the DOWNIISSA shellcode has not been seen in previous\nactivities using LODEINFO and is a new TTP in 2022.\n\nApart from the 11554.htm file found in this sample, we also discovered files with other names\nsuch as 3390.htm, 5246.htm and 16412.htm, hosted on the same C2 servers in July 2022.\n[3390.htm (MD5: 0fcf90fe2f5165286814ab858d6d4f2a) and 11554.htm (MD5:](https://opentip.kaspersky.com/0fcf90fe2f5165286814ab858d6d4f2a/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[f7de43a56bbb271f045851b77656d6bd) were one-byte XORed LODEINFO v0.6.5 shellcodes](https://opentip.kaspersky.com/f7de43a56bbb271f045851b77656d6bd/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\ndownloaded via DOWNIISSA malware. The XOR key for each sample was found at the end\nof the file. The 5246.htm (MD5: [6780d9241ad4d8de6e78d936fbf5a922) and 16412.htm](https://opentip.kaspersky.com/6780d9241ad4d8de6e78d936fbf5a922/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[(MD5: 15b80c5e86b8fd08440fe1a9ca9706c9) files are one-byte XORed unique data](https://opentip.kaspersky.com/15b80c5e86b8fd08440fe1a9ca9706c9/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nstructures. The data structure found in the 5246.htm file is shown below:\n\n**Offset** **Data example** **Descriptions**\n\n0x000000 265715 Memory allocation size (probably)\n\n\n-----\n\n0x000004 265712 The size of this data structure\nwithout memory allocation size and\ndata size\n\n0x000008 3 Number of embedded files\n\n0x000009 91464 Data size of embedded file1\n\n0x00000D 13 Filename size of embedded file1\n\n0x00000E ‘K7SysMon.Exe’,0 Filename of file1\n\n\n0x00001B 4D 5A 90 00 03 00 00 00 04 00 00 00\nFF FF 00 00\nB8 00 00 00 00 00 00 00 40 00 00 00\n00 00 00 00\n\n[SKIPPED]\n\n\nThe legitimate EXE file for DLL\nsideloading\n\n\n0x016563 57856 Data size of embedded file2\n\n0x016567 13 Filename size of embedded file2\n\n0x016568 ‘K7SysMn1.dll’,0 Filename of file2\n\n\n0x016575 4D 5A 90 00 03 00 00 00 04 00 00 00\nFF FF 00 00\nB8 00 00 00 00 00 00 00 40 00 00 00\n00 00 00 00\n\n[SKIPPED]\n\n\nMalicious DLL file that is the loading\nmodule of LODEINFO without\nembedded BLOB\n\n\n0x024775 116335 Data size of embedded file3\n\n0x024779 16 Filename size of embedded file3\n\n0x02477A ‘K7SysMon.Exe.db’,0 Filename of file3\n\n\n0x02478A 73 3A 3C 9B 9A CF 11 76 11 DF 8A\n1F 5A EF 9F 11 DF 92 C7 59 CC 11\nEF 96 CD 11 E7 92 A1 64 EC BF\n\n[SKIPPED]\n\n\nA byte XORed BLOB is read by the\nloading module to infect LODEINFO\nv0.6.5. The key is at the end of the\ndata\n\n\nThis data structure contains the names of three files: K7SysMon.exe, K7SysMn1.dll (MD5:\n[c5bdf14982543b71fb419df3b43fbf07) and K7SysMon.exe.db (MD5:](https://opentip.kaspersky.com/c5bdf14982543b71fb419df3b43fbf07/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\n[c9d724c2c5ae9653045396deaf7e3417). This suggests that an undiscovered downloader](https://opentip.kaspersky.com/c9d724c2c5ae9653045396deaf7e3417/?utm_source=SL&utm_medium=SL&utm_campaign=SL)\nmodule downloads 5246.htm from the C2 to assist with the installation of some embedded\nfiles on the victim’s machine.\n\n## Conclusions\n\n\n-----\n\nLODEINFO was first discovered in 2019. LODEINFO and its infection methods have been\nconstantly updated and improved to become a more sophisticated cyber-espionage tool\nwhile targeting organizations in Japan. The LODEINFO implants and loader modules were\nalso continuously updated to evade security products and complicate manual analysis by\nsecurity researchers.\n\nThese modifications may serve as a confirmation that the threat actors track publications by\nsecurity researchers and learn how to update their TTPs and improve their malware. In fact,\nwe haven’t detected any activities involving the LILIMRAT and the DOWNJPIT malware from\n[this threat actor since publishing our investigation results at HITCON 2021. We believe this](https://hitcon.org/2021/en/agenda/6d88317b-4d90-4249-ba87-d81c80a21382/)\ncat-and-mouse game will continue in the future.\n\n[To be continued in Part II…](https://securelist.com/apt10-tracking-down-lodeinfo-2022-part-ii/107745/)\n\n[1] Personal name of Japanese politician was masked to protect their identity.\n\n[APT](https://securelist.com/tag/apt/)\n[Backdoor](https://securelist.com/tag/backdoor/)\n[DLL sideloading](https://securelist.com/tag/dll-sideloading/)\n[Fileless malware](https://securelist.com/tag/fileless-malware/)\n[LODEINFO](https://securelist.com/tag/lodeinfo/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[Malware Technologies](https://securelist.com/tag/malware-technologies/)\n[Microsoft Word](https://securelist.com/tag/microsoft-word/)\n\nAuthors\n\n[Suguru Ishimaru](https://securelist.com/author/suguru/)\n\nAPT10: Tracking down LODEINFO 2022, part I\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-10-31 - APT10- Tracking down LODEINFO 2022, part I.pdf"
    ],
    "report_names": [
        "2022-10-31 - APT10- Tracking down LODEINFO 2022, part I.pdf"
    ],
    "threat_actors": [
        {
            "id": "ec14074c-8517-40e1-b4d7-3897f1254487",
            "created_at": "2023-01-06T13:46:38.300905Z",
            "updated_at": "2025-03-27T02:00:02.799108Z",
            "deleted_at": null,
            "main_name": "APT10",
            "aliases": [
                "TA429",
                "STONE PANDA",
                "POTASSIUM",
                "Red Apollo",
                "HOGFISH",
                "Cloud Hopper",
                "BRONZE RIVERSIDE",
                "ATK41",
                "G0045",
                "Menupass Team",
                "happyyongzi",
                "CVNX",
                "Granite Taurus"
            ],
            "source_name": "MISPGALAXY:APT10",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ba3fff0c-3ba0-4855-9eeb-1af9ee18136a",
            "created_at": "2022-10-25T15:50:23.298889Z",
            "updated_at": "2025-03-27T02:00:55.433541Z",
            "deleted_at": null,
            "main_name": "menuPass",
            "aliases": [
                "menuPass",
                "POTASSIUM",
                "Stone Panda",
                "APT10",
                "Red Apollo",
                "CVNX",
                "HOGFISH",
                "BRONZE RIVERSIDE"
            ],
            "source_name": "MITRE:menuPass",
            "tools": [
                "certutil",
                "FYAnti",
                "UPPERCUT",
                "SNUGRIDE",
                "P8RAT",
                "RedLeaves",
                "SodaMaster",
                "pwdump",
                "Mimikatz",
                "PlugX",
                "PowerSploit",
                "ChChes",
                "cmd",
                "QuasarRAT",
                "AdFind",
                "Cobalt Strike",
                "PoisonIvy",
                "EvilGrab",
                "esentutl",
                "Impacket",
                "Ecipekac",
                "PsExec",
                "HUI Loader"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba9fa308-a29a-4928-9c06-73aafec7624c",
            "created_at": "2024-05-01T02:03:07.981061Z",
            "updated_at": "2025-03-27T02:05:17.28602Z",
            "deleted_at": null,
            "main_name": "BRONZE RIVERSIDE",
            "aliases": [
                "CTG-5938 ",
                "CVNX ",
                "Hogfish ",
                "MenuPass ",
                "POTASSIUM ",
                "Red Apollo ",
                "Stone Panda ",
                "APT10 "
            ],
            "source_name": "Secureworks:BRONZE RIVERSIDE",
            "tools": [
                " ChChes",
                " Cobalt Strike",
                " PlugX",
                " PoisonIvy",
                " QuasarRAT",
                " QuasarRAT Loader",
                " RedLeaves",
                "ANEL"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1675303653,
    "ts_updated_at": 1743041591,
    "ts_creation_date": 1675237066,
    "ts_modification_date": 1675237066,
    "files": {
        "pdf": "https://archive.orkl.eu/6e127606768e4691439bb48b8b38349913ad1b7a.pdf",
        "text": "https://archive.orkl.eu/6e127606768e4691439bb48b8b38349913ad1b7a.txt",
        "img": "https://archive.orkl.eu/6e127606768e4691439bb48b8b38349913ad1b7a.jpg"
    }
}