{
    "id": "0197fd23-3eaf-44f8-8047-7e8bc4131c6e",
    "created_at": "2023-01-12T15:02:52.981428Z",
    "updated_at": "2025-03-27T02:16:16.924947Z",
    "deleted_at": null,
    "sha1_hash": "2e067bbbc5b27f5f8fc131660e3be135300db3cf",
    "title": "2022-08-04 - Likely Iranian Threat Actor Conducts Politically Motivated Disruptive Activity Against Albanian Government Organizations",
    "authors": "",
    "file_creation_date": "2022-08-18T03:55:16Z",
    "file_modification_date": "2022-08-18T03:55:16Z",
    "file_size": 5101050,
    "plain_text": "# Likely Iranian Threat Actor Conducts Politically Motivated Disruptive Activity Against Albanian Government Organizations\n\n**[mandiant.com/resources/likely-iranian-threat-actor-conducts-politically-motivated-disruptive-activity-against](https://www.mandiant.com/resources/likely-iranian-threat-actor-conducts-politically-motivated-disruptive-activity-against)**\n\n## Executive Summary\n\nMandiant identified the ROADSWEEP ransomware family and a Telegram persona which targeted the Albanian\ngovernment in a politically motivated disruptive operation ahead of an Iranian opposition organization’s\nconference in late July 2022.\nA previously unknown backdoor CHIMNEYSWEEP and a new variant of the ZEROCLEAR wiper may also have\nbeen involved.\nCHIMNEYSWEEP malware distribution data and decoy content, the operation’s timing and politically themed\ncontent, and the possible involvement of the ZEROCLEAR wiper indicate an Iranian threat actor is likely\nresponsible.\nThis activity is a geographic expansion of Iranian disruptive cyber operations, conducted against a NATO\nmember state. It may indicate an increased tolerance of risk when employing disruptive tools against countries\nperceived to be working against Iranian interests.\nPlease see the Technical Annex for relevant Yara rules and MITRE ATT&CK Techniques\n\n(T1007, T1012, T1027, T1033, T1055, T1057, T1070.004, T1070.006, T1082, T1083, T1087, T1112, T1113,\nT1134, T1489, T1497.001, T1518, T1543.003, T1569.002, and T1622).\n\n### Threat Detail\n\nIn mid-July 2022, Mandiant identified a new ransomware family dubbed ROADSWEEP which drops a politically\nthemed ransom note suggesting it targeted the Albanian government. In addition, a front named “HomeLand Justice”\nclaimed credit for the disruptive activity that affected Albanian government websites and citizen services on July 18,\n2022. The “HomeLand Justice” front posted a video of the ransomware being executed on its website and Telegram\n\n\n-----\n\nchannel alongside alleged Albanian government documents and residence permits of ostensible members of the\nMujahedeen-e-Khalq/People’s Mojahedin Organization of Iran (MEK, also known as MKO or PMOI), an Iranian\nopposition organization that was formerly designated as a terrorist group by the U.S. Department of State.\n\n[On July 18, 2022, the Albanian government published a statement announcing it had to “temporarily close](https://albaniandailynews.com/news/cyber-attacks-forces-akshi-close-government-online-systems)\naccess to online public services and other government websites” due to disruptive cyber activity.\nOn July 22, 2022, a ROADSWEEP ransomware sample was submitted to a public malware repository from\n[Albania. Upon successful execution, this ROADSWEEP sample drops a ransom note including the text “Why](https://balkaninsight.com/2022/07/22/us-warns-of-threat-to-iranian-opposition-summit-in-albania/)\nshould our taxes be spent on the benefit of DURRES terrorists?” (Figure 1). Durrës is a port city and the second\nmost populous city in Albania.\n\nFigure 1: ROADSWEEP ransom note\nOn July 21, 2022, a front named “HomeLand Justice” leveraged the website “homelandjustice.ru” to start publishing\nostensible news stories on the ransomware operation against the Albanian government along with a link to a Telegram\nchannel named “HomeLand Justice.” The website, which implies that it is run by Albanian citizens, claimed credit for\nthe ransomware activity with a video of “wiper activity,” and posted documents ostensibly internal to the Albanian\ngovernment along with what it claimed to be Albanian residence permits of MEK members.\n\nThe website “homelandjustice[.]ru” and the Telegram channel both use a banner that appears identical to the\nwallpaper used by ROADSWEEP and contains the same politically themed language as the ransom note above\n(Figure 2). The platforms also posted a video of an alleged wiper executed on a host using this banner.\n\n\n-----\n\nFigure 2: ROADSWEEP wallpaper and HomeLand Justice banner\n\nAfter posting multiple links to news stories on the disruptive activity against the Albanian government on July 26,\n2022, HomeLand Justice directly claimed credit for the operation on its Telegram channel in a message alleging\ncorruption in the Albanian government and repeating the message from the ransom note (Figure 3). Notably, the\nposts used the hashtags #MKO, #ISIS, #Manez, and #HomeLandJustice. Manëz is a town in the Durrës County\nand the location for the World Summit of Free Iran conference which was set to take place on July 23-24.\n\nFigure 3: HomeLand Justice claims credit\n\nBoth the homelandjustice.ru website and the Telegram channel posted documents ostensibly belonging to\nAlbanian government organizations along with what appear to be residence permits, marriage certificates,\npassports, and other personal documents belonging to alleged members of the MEK.\n\n### CHIMNEYSWEEP Backdoor Likely Targets Iranian Diaspora and Dissidents\n\n\n-----\n\nMandiant further identified CHIMNEYSWEEP, a backdoor that uses either Telegram or actor owned infrastructure for\ncommand-and-control and is capable of taking screenshots, listing and collecting files, spawning a reverse shell, and\nsupports keylogging functionality. CHIMNEYSWEEP shares code with ROADSWEEP and based on observed decoy\ncontent has likely been used to target Farsi and Arabic speakers as far back as 2012.\n\nCHIMNEYSWEEP and ROADSWEEP share multiple code overlaps, including identical dynamic API resolution\ncode. The shared code includes an embedded RC4 key to decrypt Windows API function strings at run time,\nwhich are resolved using LoadLibrary and GetProcAddress calls once decrypted. Both capabilities also share\nthe same Base64 custom alphabet, one used to encode the decryption key, the other for command and control.\n\nBoth CHIMNEYSWEEP and ROADSWEEP use the RC4 key “8c e4 b1 6b 22 b5 88 94 aa 86 c4 21 e8 75\n9d f3” and the custom Base64 alphabet “wxyz0123456789.JKLMNOPghijklmnopqrstuvQRSTUVWXYZabcdefABCDEFGHI”.\nCHIMNEYSWEEP is dropped by a self-extracting archive signed with a valid digital certificate alongside either\nan Excel, Word, or video file which are likely used as benign decoy documents. However, these documents do\nnot appear to be automatically opened when CHIMNEYSWEEP is executed.\n\nThe decoy documents have included Arabic-language lists of names, ostensibly of individuals in Lebanon,\nand a figure of Massoud Rajavi, the former leader of the Mujahedeen-e-Khalq (MEK), an Iranian opposition\ngroup (Figure 2).\nWe identified iterations of CHIMNEYSWEEP used as early as 2012.\n\nFigure 4: Image of Massoud Rajavi in a Word document used as decoy content alongside CHIMNEYSWEEP in\nAugust 2021\n\n### ZEROCLEAR\n\nOn July 19, 2022, one day after the Albanian government announcement of the disruptive activity, an Albanian user\nsubmitted a ZEROCLEAR wiper payload to a public malware repository. The ZEROCLEAR payload takes in\ncommand line arguments from the operator and results in corruption of the file system using the RawDisk driver.\n\n\n-----\n\nWhile we are unable to independently prove or disprove whether the ZEROCLEAR sample was used in this or any\n[disruptive operation, the malware has previously been publicly reported to have links to Iran-nexus threat actors](https://www.ibm.com/downloads/cas/OAJ4VZNJ)\ndeploying it in support of disruptive activity in the Middle East as recently as 2020.\n\n## Attribution\n\nMandiant does not have evidence linking this activity to a named threat actor but assesses with moderate confidence\nthat one or multiple threat actors who have operated in support of Iranian goals are involved. This is based on the\ntiming of the disruptive activity, the MEK-focused content of the HomeLand Justice persona’s Telegram channel, and\nthe long history of CHIMNEYSWEEP malware targeting Farsi and Arabic speakers.\n\nThe city of Manëz, Durrës County, which were mentioned in the ROADSWEEP ransom note and on the\nHomeLand Justice Telegram channel, was set to host a conference “The World Summit of Free Iran” on July 23[24, 2022. Albanian media announced that on July 22 that the conference had been postponed due to a “terrorist](https://euronews.al/en/albania/2022/07/22/iran-summit-postponed-following-terrorist-threats-in-durres/)\nattack threat.”\nThe World Summit of Free Iran is a conference convening entities opposed to the government of Iran,\nspecifically members of the MEK, in Manëz, Durrës County, Albania.\nIranian and pro-Iran information operations have frequently targeted the MEK with antagonistic messaging,\nincluding that leveraging fabricated material such as forged documents. For example, the pro-Iran campaign\n[Roaming Mayfly has promoted falsified narratives alleging various Western countries’ support for the MEK.](https://www.mandiant.com/resources/information-operations-surrounding-ukraine)\n[We have previously reported on the suspected Iran-nexus ZEROCLEAR and](https://advantage.mandiant.com/reports/20-00001090) [DUSTMAN wipers, which have](https://advantage.mandiant.com/malware/malware--58ea86c6-706e-5b6d-aaf2-84a6d55aa281)\nreportedly targeted entities in Bahrain and Saudi Arabia.\n\nHowever, we do note that the ransomware attack is significantly more complex than prior CHIMNEYSWEEP\noperations, which raises the possibility of a cross-team collaboration or other scenarios that we lack insight into at this\ntime. We are continuing to investigate this cluster and will provide updates as we are able.\n\n### Outlook and Implications\n\nMandiant has frequently reported on Iranian threat activity targeting Iranian dissidents and opposition groups abroad\n[by cyber espionage groups such as UNC788 and malware such as SCRAPWOOD, publicly known as MarkiRAT.](https://advantage.mandiant.com/actors/threat-actor--20ea26fa-d7ef-51c1-905f-28a2982a0bb5)\n[Additionally, numerous recent lock-and-leak operations by suspected Iran-nexus personas such as Black Shadow and](https://advantage.mandiant.com/reports/21-00010874)\n[Moses Staff have involved disruptive activity against primarily Israeli organizations in an attempt to embarrass them.](https://advantage.mandiant.com/reports/21-00023167)\n\nThe use of ransomware to conduct a politically motivated disruptive operation against the government websites and\ncitizen services of a NATO member state in the same week an Iranian opposition groups’ conference was set to take\nplace would be a notably brazen operation by Iran-nexus threat actors. As negotiations surrounding the Iran nuclear\ndeal continue to stall, this activity indicates Iran may feel less restraint in conducting cyber network attack operations\ngoing forward. This activity is also a geographic expansion of Iranian disruptive cyber operations, conducted against a\nNATO member state. It may indicate an increased tolerance of risk when employing disruptive tools against countries\nperceived to be working against Iranian interests.\n\n### Technical Annex A: ROADSWEEP Ransomware\n\nROADSWEEP is a newly discovered ransomware tool, which upon execution will enumerate files on the device and\nencrypts the content in blocks using RC4. Window API names, malware configuration parameters, and the basis of a\nransomware note are RC4 encrypted within ROADSWEEP. During execution, ROADSWEEP will decrypt these\nencrypted strings and dynamically resolve necessary imports.\n\nGoXml.exe (MD5: bbe983dba3bf319621b447618548b740)\n\nROADSWEEP disruptive payload\nCompiled on 2016/04/30 17:08:19\n\nROADSWEEP requires four command line arguments to execute correctly, otherwise ROADSWEEP will produce a\nmessage box and halt execution. Upon successful execution, ROADSWEEP creates the following global mutex:\n\n\n-----\n\nabcdefghijklmnoklmnopqrstuvwxyz01234567890abcdefghijklmnopqrstuvwxyz01234567890\n\nFollowing initialization, ROADSWEEP will begin resolving the necessary APIs using the Windows GetProcAddress\nAPI. The function names are encrypted using RC4 with the hardcoded key \"8c e4 b1 6b 22 b5 88 94 aa 86 c4 21 e8\n75 9d f3\".\n\nROADSWEEP contains multiple embedded scripts which are used to either execute additional commands or to\nremove itself from the victim’s device. These scripts are never written to disk, instead ROADSWEEP will create a new\ncommand prompt (cmd.exe), then send these commands to the process with a pipe. The scripts are embedded within\nthe binary as RC4 encrypted blocks and are decrypted at runtime by the payload. The first script decrypted by\nROADSWEEP is responsible for disabling settings like SystemRestore and Volume Shadow Copies, along with\ndisabling critical services and processes.\n\nFigure 5: Embedded script responsible for disabling system settings and processes\nROADSWEEP also decrypts the following script, which is used to delete itself after execution:\n\nping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q \"%s\"\n\nNext, ROADSWEEP extracts configuration values that are RC4 encrypted and embedded within the binary itself. The\nfirst is a list of extensions that should be avoided when the encryption occurs:\n\n.exe\n.dll\n.sys\n.lnk\n.lck\n\nROADSWEEP also decrypts the filename for the ransomware note, \"How_To_Unlock_MyFiles.txt\" (MD5:\n44d1c75815724523a58b566d95378825) and the note itself as shown in Figure 1.\n\nAfter creating the file, the encryption key that is used to encrypt each file is computed. The key is derived through\nproducing a random data stream using the algorithm shown in Figure 6, then hashing this value with MD5 and using\nthis as an RC4 key\n\n\n-----\n\nFigure 6: Key generation algorithm\nROADSWEEP then encrypts this key with an embedded RSA public key and proceeds to format the ransomware\nmessage by appending the Base64 encoded and encrypted “recovery key” to the message itself. The Base64\nencoding uses a custom alphabet of \"wxyz0123456789.JKLMNOPghijklmnopqrstuvQRSTUVWXYZabcdefABCDEFGHI\".\n\nFigure 7: ROADSWEEP recovery key encryption and ransom note formatting\nNext, ROADSWEEP enumerates all logical drives on the victim's device and checks whether the drive is one of the\nfollowing:\n\nDRIVE_REMOVABLE\nDRIVE_FIXED\nDRIVE_REMOTE\nDRIVE_CDROM\n\n\n-----\n\nFigure 8: Drive selection and wiper thread creation\nFor each discovered drive, ROADSWEEP will initialize a new thread which is responsible for encrypting all files within\nthat drive. This thread enumerates the file system using the Windows FindFirstFileW and FindNextFileW APIs. For\neach root directory, a ransomware note is created with the content and filename noted above.\n\nFollowing this, ROADSWEEP will check whether the files within the directory match the extracted extension list, if they\ndo not the file is encrypted. The encryption process takes place by renaming the file with the “.lck” extension.\nROADSWEEP then takes the creation time, last access time, and last write time for the file and stores these internally.\nThese values are then used after the wipe to preserve the file times, although the purpose of this is currently\nunknown.\n\nROADSWEEP will then open the file and compute the size using the GetFileSize API. Then by chunking the file’s\ncontent into blocks of 0x100000, ROADSWEEP will read in the data, encrypt the chunk using RC4, and then overwrite\nthe file to disk. This is completed until the entire file is overwritten.\n\nFollowing this, the aforementioned self-delete script is executed and the process exits.\n\n### Technical Annex B: ZEROCLEAR Variant\n\nWe identified a ZEROCLEAR payload which takes in command line arguments from the operator and results in\ncorruption of the file system using the RawDisk driver.\n\ncl.exe (MD5: 7b71764236f244ae971742ee1bc6b098)\n\nZEROCLEAR disruptive payload\nCompiled on 2022/07/15 13:26:28\n\nThe first command line argument must be one of the following:\n\n\"wp\" (default) – Wipes the disk using the ElDos driver, this expects the driver to be running for the wiper activity\nto occur.\n\"in\" – Installs and starts the driver named rwdsk.sys, which is expected to be located in the same directory as\nZEROCLEAR.\n“un” – Uninstalls the driver named rwdsk and deletes the file on disk.\n\nThe second argument is the drive letter that the operator wants to corrupt, previous variants of ZEROCLEAR only\nwiped the system drive, determined from calling the GetSystemDirectoryW API.\n\nZEROCLEAR then opens a handle to the RawDisk driver by opening a handle to the following:\n\n\"\\\\?\n\\RawDisk3<arg2>#B4B615C28CCD059CF8ED1ABF1C71FE03C0354522990AF63ADF3C911E2287A4B906D47D\"\n\n\n-----\n\nIt then computes the disk size using the Windows IOCTL_DISK_GET_DRIVE_GEOMETRY_EX,\nIOCTL_DISK_GET_DRIVE_GEOMETRY and IOCTL_DISK_GET_LENGTH_INFO DeviceIoControl calls. The ElDos\ndriver is used to overwrite the data with the value \"0\".\n\n### Technical Annex C:CHIMNEYSWEEP Backdoor\n\nWhile Mandiant was unable to uncover the infection vector for CHIMNEYSWEEP, we note that the dropper has a valid\ndigital signature. In addition to dropping the CHIMNEYSWEEP installer, this dropper also contains either an Excel or\nWord document or an MP4 video file.\n\nThe dropper is a signed version of a Windows Cabinet self-extracting file, which is signed by the now revoked\ncertificate \"Atheros Communications Inc.\" As of 2022-07-28, the certificate used in the ROADSWEEP campaign has\nnot been revoked. Historically we have seen APT41 also use this signature, although as noted by [DUO the password](https://duo.com/decipher/dude-you-got-dell-d-publishing-your-privates)\nfor this certificate was widely available. The threat actor’s choice of signing certificate and dropper is likely based on\nthe fact the legitimate Atheros certificate was used to distribute legitimate drivers using the legitimate dropper. This\nindicates the threat actors have a high degree of operational security.\n\nUpon execution, the self-extracting tool finds the resource named “Cabinet”, drops it to disk, and then executes a\nprocess named unpack.exe.\n\n### CHIMNEYSWEEP Samples\n\nUNAVAILABLE (MD5: df9ab47726001883b5fcf58b56b34b41)\n\nCHIMNEYSWEEP backdoor\nInstalled by unpack.exe (MD5: 8c8bbe3a4a23cd4cc96c12af5fb1199b)\nContained in wextract.exe.mui (MD5: 19068e8228b6b8f5528489fa70779b2b)\nCompile time: 2021/07/26 13:39:17\nC&C servers:\n\ntelegram-update[.]com\navira[.]ltd\nwindowsupadates[.]com\n\nAppxProviders.dll (MD5: f3c977830bf616b9061d7aee5ce0b2f2)\n\nCHIMNEYSWEEP backdoor\nCompile time: 2021/07/26 13:39:17\nC&C servers:\n\ntelegram-update[.]com\navira.ltd\nwindowsupadates[.]com\n\nAppxProviders.dll (MD5: 7f6db4493c6a76eb44534306291ea85f)\n\nCHIMNEYSWEEP backdoor\nCompile time: 2021/07/26 13:39:17\nC&C servers:\n\ntelegram-update[.]com\navira.ltd\nwindowsupadates[.]com\n\nAppxProviders.dll (MD5: 3a1033cb1eb06c2cd5e91c539cf8a519)\n\nCHIMNEYSWEEP backdoor\nCompile time: 2021/07/26 13:39:17\nC&C servers:\n\ntelegram-update[.]com\navira.ltd\nwindowsupadates[ ]com\n\n\n-----\n\nUNAVAILABLE (MD5: 23643b7bd48a200889a4613a0e0a86e4)\n\nCHIMNEYSWEEP backdoor\nInstalled by: UNAVAILABLE (MD5: 49d72f9212d5653f5be9f764d8c9df24)\nCompile time: 2021/06/11 22:53:53\nC&C servers:\n\ntelegram-update[.]com\navira.ltd\nwindowsupadates[.]com\n\nUNAVAILABLE (MD5: 9c09d147dfbc98d5e6e051fe1ed0033d)\n\nCHIMNEYSWEEP backdoor\nInstalled by unpack.exe (MD5: 38e0fa41e9519d4783766992c203e794)\nCompile time: 2020/01/25 18:11:10\nC&C servers:\n\ntelegram-update[.]com\navira.ltd\nwindowsupadates[.]com\n\nUNAVAILABLE (MD5: 5cc183702fae8cc23a55037c1efab5e5)\n\nCHIMNEYSWEEP backdoor\nInstalled by UNAVAILABLE (MD5: 92c61e3047297136701c25deb658b35a)\nCompile time: 2020/09/21 11:44:32\nC&C servers:\n\ntelegram-update[.]com\navira.ltd\nwindowsupadates[.]com\n\nssv.dll (MD5: 77a369e5e49e7e62d8eef2c00cd02950)\n\nCHIMNEYSWEEP backdoor\nCompile time: 2018/10/08 17:28:39\nC&C servers:\n\ncloud-avira[.]com\npgp.eu[.]com\nserver-avira[.]com\nskype.se[.]net\nuk2privat[.]com\nupdate-pgp[.]com\n\n## Execution\n\nAfter being dropped by the dropper, the installer is executed. The installer, some of which are padded with null bytes\n(0x00) to inflate their size, is responsible for deploying an embedded executable to disk and then executing the\nbackdoor itself. The installer initially drops the payload as “m.d” in the covert store (\"C:\\ProgramData\\Microsoft\nInstaller{EA2C6B24-C590-457B-BAC8-4A0F9B13B5B8}\\Force\"). Some of the installers forge the dropped file’s\nCreationTime, LastAccessTime, and LastWrite time from C:\\Windows\\System32\\smss.exe\n\nThe installer then executes the “Alloc” export which checks whether the device is currently running DeepFreeze by\nFaronics, although this is not applicable for the samples analysed by Mandiant. If the process name contains\n“creensaver.”, the backdoor will write the image to %SYSTEM32%\\Slui and then execute a task named\n\"\\\\Microsoft\\\\Windows\\\\License Manager\\\\LicenseExchange\\\". Alloc ultimately calls the Control_Provider export, which\nwill initiate the backdoor.\n\nThe main functionality is provided in the next export called by the installer, “RatingSetupUI”. This export is responsible\nfor all the command-and-control (C&C) interactions and backdoor capabilities.\n\n\n-----\n\nThe last two exports are related to the update process. Control_Provider manages the update process whereas\n“Telephon” executes the “Control_Provider” function.\n\nIf the backdoor is not running as an administrator, the backdoor may use embedded payloads to escalate privileges. A\nmutex named “rerunadmn” is used internally by the backdoor and the two RC4 encrypted payloads are extracted. The\nfirst payload is a .NET loader, which loads the second payload and calls the type \"vjp5ZPP9AidVjXxofy\" and method\n\"s7tajdxvX”. The loader (MD5: 779940f675ff4ab4e8cab7a1b7cf5d3c) will first enumerate the loaded .NET modules\nlooking for the above class and methods. If they exist, it will execute that module. If the module is not loaded, the\nassembly is loaded and then executed in memory. The backdoor will then pass through the string “AD” if the payload\nis already executing as Administrator or the path to a temporary file on disk, directly to the loaded .net module. This\ntemporary file is created by writing the content of the Software\\AppDataLoad\\GLX\\aex and writing the content to the\nWindows %TEMP% directory with the name APPX.<random_values>.tmp. This file is a copy of the backdoor itself. If\nthe payload can’t resolve the export CP from the loader, it reverts to invoking PowerShell with the following command,\npassing in the path to the second payload, the type and method and either AD or the path to the second module:\n\n[Reflection.Assembly]::LoadFile(\\\"%s\\\")\\n$i=\\\"\\\"\\n$r=[%s]::%s(\\\"%s\\\",[ref] $i)\\necho $r,$i\\n\n\nExecution will then proceed within the second payload (MD5: 3633b3d69060a5882656b69f81655f0a), responsible for\nensuring that the payload is running with administrator privileges. This payload is obfuscated by reactor and contains\nencrypted strings used throughout the execution. Upon execution, the payload will create the mutex “rerunadmn” and\n“subttoadmn”. The module utilises the following techniques to execute the payload as administrator:\n\n1. Makes use of the Windows “SilentCleanup” scheduled task. This task executes the executable running in\n\n%windir%\\system32\\cleanmgr.exe, and the payload uses the Windows Registry Environment key to change the\n%windir% variable to point to c:\\Windows. Next, the payload creates a new System32 folder and copies an\nembedded payload called cleanmgr.exe (MD5: 779940f675ff4ab4e8cab7a1b7cf5d3c) into this folder, alongside\na .cfg file with the content “slc”. Following this, the task is executed. This technique is similar to a technique\nwithin [Metasploit called bypassuac_silentcleanup.](https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/local/bypassuac_silentcleanup.rb)\n2. Makes use of the windows CMSTP.exe binary to install a malicious Microsoft Connection Manager Profile on the\n\ndevice. This technique drops cln.vbs to the c:\\windows\\temp folder (MD5:\n7a77c2930f0457ed2dd622e9739c7d3d), then creates a .ini file for the Ethernet service. Within this ini file, the\npayload contains two RunPreSetupCommandsSection values, one for the payload itself, and the second for\nexecuting the cln.vbs script. The legitimate cmstp.exe will then be executed on the host which executes the\nbackdoor and then the clean-up script. This technique is identical to a technique made public in 2017 by Oddvar\nMoe.\n\nCHIMNEYSWEEP has the following major functionality:\n\nScreenshot collection: Takes screenshots of the compromised device on a timer and stores to disk or can be\ntasked to take a screenshot and upload.\nFile collection and listing: Monitors for new removable drives and performs directory listing on demand,\nenumerates directories for files that match a set list, and can be tasked to upload a file to the command-andcontrol server.\nKeylogging: Monitors the content of the clipboard and performs key logging to disk.\nReverse shell: Contains a reverse shell which can be utilised by the attacker.\n\n### Initial configuration format\n\nThe backdoor contains settings that are found either encrypted within the payload or stored in the registry\n(Software\\AppDataLow\\GLX\\Setting). The values stored in the registry will be provided from the update mechanism.\nThe configuration is split using the tags {BEGIN} and &{END}, and each value within the settings are referenced by an\ninteger. For extracting the C&C values, the parser stores a reference to values 30-39 where each reference can be a\ndifferent C&C and URI in order.\n\n\n-----\n\nFigure 9: Example C&C configuration\nBased on our analysis we assess that the IDs correspond to the following settings:\n\nTable 1: Configuration keys\n\n**Id** **Purpose**\n\n1 Perform file collection\n\n2 Perform directory listing of new drives\n\n3 Perform key logging\n\n4 Monitor clipboard data\n\n5 Boolean value as to whether the actor should take screenshots\n\n6 The timeout value between each screenshot\n\n7 Default JPEG quality for BMP2JPGpourVBFrance export\n\n8 Execute system information command\n\n9-29 Missing\n\n30-39 C&C information\n\n40 File collection config\n\n### Network communications and commands\n\n\n-----\n\nDuring the initialisation of CHIMNEYSWEEP, a thread is created which makes HTTP GET requests\nto https://api.telegram.org/<random_value>. The response is checked for the string \"{\"ok\":false,\" and if that string is\npresent, the threat actor attempts to use Telegram for C&C communications.\n\nThe threat actor used the following Telegram bots:\n\nTable 2: Telegram channels by actor\n\n\n**URI Path** **bot**\n**username**\n\n\n**bot real**\n**name**\n\n\n**channel id**\n\n\nbot661217919:AAG9PrAybrKF5y8HxMA14THNZtWXw5Sv4w net21007bot net21007 -1001262963819\n\nbot692407219:AAFlfj9N3gx7vCJlsFi3Ej0qzZgpL8CNmj0 net11007bot net11007 -1001188059110\n\nThese Telegram channels appear to have been in use by the threat actor for a significant period and have messages\nin the hundreds of thousands which relate to individual tasks. The backdoor uses Telegram’s GetUpdates API\nendpoint, which returns a list of messages for the bot. The backdoor then parses this data to execute specific\ncommands, download additional payloads, or to create a reverse shell. Data sent and received by the Telegram\nchannel are encoded using Base64 and the same alphabet as ROADSWEEP.\n\nWithin the context of Telegram, CHIMNEYSWEEP uses a unique identifier for the victim based on the computer name\nand username prepended by TL. This ID is used for filtering commands for the specific device:\n\nTL_<computer_name>-<user_name>\n\nFollowing the victim identifier, the backdoor uses the string 1 to indicate a task for the update process and 2 to\nindicate a command to execute on the host.\n\nIf Telegram is not available, the threat actor communicates to threat actor-owned infrastructure. This infrastructure is\nembedded within the payload and may include one or multiple of the following:\n\nhttp://skype.se.net/cm.php\nhttp://update-real.com/cm.php\nhttp://windowsupadates.com/cm.php\nhttp://update-pgp.com/cm.php\nhttp://uk2privat.com/cm.php\nhttp://server-avira.com/cm.php\nhttp://pgp.eu.com/cm.php\nhttp://cloud-avira.com/cm.php\nhttp://telegram-update.com/cm.php\nhttp://avira.ltd/cm.php\n\nThe C&C communication protocol consists of several HTTP requests to the server using the argument “do” to specify\nthe command id and “arg” to transfer associated data. Communication to these servers is done with a specific UserAgent, which includes the victim's computer name and username in the following format:\n\n<status_code>:---:<Computer_Name>-<User_Name>:---:init:---:www:---:MNEW\n\nUpon initialization, the backdoor will create two networking threads, one for managing updates and the second for\nmanaging tasking:\n\nTable 3: Update communications\n\n\n-----\n\n**Command**\n**Id**\n\n\n**Purpose** **Response**\n\n\n0 Start the\nplugin\nupdate\nprocess\n\n2 Update\nthe core\nbackdoor\n\n20 Download\nand\nexecute a\nfile\n\n22-28 Download\nadditional\nplugins\n\n## Update process \n\n\nUpdates settings within the backdoor like the current C&C for this communication channel\nor the settings in the registry\n\n\nRC4 encrypted executable, which is written to the disk, time stomped to be between\n2010-2021, then executed. The backdoor uses the mutex \"runupdate\" before executing\nthe executable, then after the process returns, will check for the mutex \"runupdateok\". If\nthis mutex exists, the backdoor instance who requested the update is terminated.\n\n\nRC4 encrypted data which is written to disk, then executed.\n\n\nRC4 encrypted data which will be written to registry values. The purpose of these plugins\nis not fully understood, although Mandiant were able to ascertain that \"p22jpd\" is used for\nthe screenshot converter.\n\n\nCHIMNEYSWEEP can update itself by downloading an executable. Mandiant was unable to obtain a copy of this\nupdater. However, this update mechanism likely executes the Control_Provider export. This export establishes a\nnumber of mutexes including: runupdateok, baserun, heyirunadmn and corerun. The updater logic first creates the\nmutex runupdate, that is checked by the Control_Provider, then waits for the runupdateok mutex before killing itself.\n\n### Tasking communications\n\nA second thread is started to handle incoming tasking from either the C&C server or Telegram. The command\neffectively works by downloading a request from the server, then parsing this request into a format that is then parsed\nby CHIMNEYSWEEP. Payloads are delivered either using the custom Base64 algorithm for Telegram, or in plain text\nfor the standard C&C server.\n\nMandiant was unable to identify each individual field used and believe these may be reserved for future, or used with\nhistoric iterations of the backdoor.\n\nCommands are made up of 12 distinct arguments encased in square braces. As shown in Figure 10:\n\nFigure 10: Tasking command structure\nThe backdoor checks for the existence of the \"[Z]\", and that the string ends with a \"]\". The arguments are then passed\nback to the main C&C loop. The timeout is the value in seconds that is slept prior to executing any command on the\nsystem.\n\n\n-----\n\nFigure 11: CHIMNEYSWEEP command parsing\nThe following commands are supported in variants analysed by Mandiant:\n\nTable 4: Tasking communication task list\n\n\n**Command**\n**Id**\n\n\n**Purpose** **Response**\n\n\n40 Execute a task on host See Tasking\n\n41 Upload a screenshot Uploads a sc\n\n\n200 Update screenshot settings\nand upload a screenshot\n\n### Tasking\n\n\nTakes a screenshot using either the b.j file from the covert store or the\nWindows APIs, store the screenshot on disk then upload to the C2.\n\n\nCHIMNEYSWEEP enables two distinct routes to execute commands on the box, a reverse shell and an interactive\ncustom command prompt. In addition to this, the backdoor enables the threat actor to reboot or shutdown the system\nor logoff the current user.\n\nTable 5: Command options for local task\n\n**Command** **Action**\n\n100 Start the custom command prompt\n\n101 Start a reverse shell\n\n102 Shutdown the system using shutdown /s /t 0 /f\n\n\n-----\n\n103 Reboot the system using shutdown /r /t 0 /f\n\n104 Logoff the current user using shutdown /l /f\n\nFigure 12: Command options\nFor both shells, the command creates a socket to the address and port in the original packet. For the reverse shell, a\ncmd.exe process is started with the pipes set to the socket. A packet is sent to the C&C server to inform it that a shell\nis starting. This packet consists of the following string \"CSP><computer_identifier>>\", upon termination of the shell by\nthe user, the string \"DC><computer_idenitifer>>\" is sent.\n\nThe custom command prompt allows the following commands:\n\nCS - Used to indicate the start of a command session along with the computer_identifier\nLD - List drivers\nLP - list files in path\nLPG - Not implemented\nSF - Opens a file, returns the file size\nSFG - Opens the file and uploads the content in chunks of 0x400 bytes\nRF - Retrieves a file and writes to disk\nREN - Rename a file\nDEL - Delete a file\nDELF - Delete a directory\nCRTD - Creates a directory\nEXEC - Executes a command on disk\nDC - Disconnects the shell\nHI - Return \"OOK>\"\n\n**Screenshot function**\n\n\n-----\n\nCHIMNEYSWEEP can be configured to take the screenshots and if the JPEG converter plugin (stored in the p22jpd\nregistry value) is present, convert the images to JPEG. The JPEG settings can be configured by the threat actor in the\nrequest as discussed above. Screenshots are taken using the Windows APIs and written to disk in the covert store\nwith the name APPX.%x%x%x%x%x.tmp, where each %x is a random value.\n\nDepending on whether the JPEG plugin exists, CHIMNEYSWEEP will either copy the temporary file into the\nrequested file, or using the plugin, convert the bitmap into a JPEG as defined by the command.\n\nThe output value is then either uploaded to Telegram or the C&C server using command 41. Mandiant was able to\nobtain a JPEG plugin with the MD5 hash 87574fa34cfbe592d6097b8d36e00313.\n\nFigure 13: Example C&C\n\ntasking to collect a screenshot\n**Sys info commands**\n\n@echo off\n\n@CHCP 65001\n\n@set t=\"%cd%\\ni\"\n\n@set f=\"%cd%\\i1\"\n\n@cd %SystemRoot%\\system32\n\n@echo {{WMIC_AntiVirusProduct}}>%t%\n\n@wmic /failfast:on /append:%t% /namespace:\\\\root\\SecurityCenter2 path AntiVirusProduct get /value\n\n@echo {{WMIC_AntiSpywareProduct}}>>%t%\n\n@wmic /failfast:on /append:%t% /namespace:\\\\root\\SecurityCenter2 path AntiSpywareProduct get /value\n\n@echo {{WMIC_FirewallProduct}}>>%t%\n\n@wmic /failfast:on /append:%t% /namespace:\\\\root\\SecurityCenter2 path FirewallProduct get /value\n\n@echo {{WMIC_OS}}>>%t%\n\n@wmic /failfast:on /append:%t% OS get /value\n\n@echo {{WMIC_TIMEZONE}}>>%t%\n\n@wmic /failfast:on /append:%t% TIMEZONE get /value\n\n@echo {{WMIC_LOGON}}>>%t%\n\n@wmic /failfast:on /append:%t% LOGON get /value\n\n@echo {{WMIC_DESKTOP}}>>%t%\n\n@wmic /failfast:on /append:%t% DESKTOP get /value\n\n@echo {{WMIC_DESKTOPMONITOR}}>>%t%\n\n@wmic /failfast:on /append:%t% DESKTOPMONITOR get /value\n\n@echo {{WMIC_BASEBOARD}}>>%t%\n\n@wmic /failfast:on /append:%t% BASEBOARD get /value\n\n@echo {{WMIC_BIOS}}>>%t%\n@wmic /failfast:on /append:%t% BIOS get /value\n\n@echo {{WMIC_CPU}}>>%t%\n\n@wmic /failfast:on /append:%t% CPU get /value\n\n@echo {{WMIC_SOUNDDEV}}>>%t%\n\n@wmic /failfast:on /append:%t% SOUNDDEV get /value\n\n@echo {{WMIC_LOGICALDISK}}>>%t%\n\n@wmic /failfast:on /append:%t% LOGICALDISK get /value\n\n@echo {{WMIC_CDROM}}>>%t%\n\n@wmic /failfast:on /append:%t% CDROM get /value\n\n@echo {{WMIC_PRINTERCONFIG}}>>%t%\n\n@wmic /failfast:on /append:%t% PRINTERCONFIG get /value\n\n@echo {{WMIC_USERACCOUNT}}>>%t%\n\n@wmic /failfast:on /append:%t% USERACCOUNT get /value\n\n@echo {{WMIC SHARE}}>>%t%\n\n\n-----\n\n@wmic /failfast:on /append:%t% SHARE get /value\n@echo {{WMIC_STARTUP}}>>%t%\n\n@wmic /failfast:on /append:%t% STARTUP get /value\n\n@echo {{WMIC_PROCESS}}>>%t%\n@wmic /failfast:on /append:%t% PROCESS get /value\n\n@echo {{WMIC_SERVICE}}>>%t%\n\n@wmic /failfast:on /append:%t% SERVICE get /value\n@echo {{WMIC_SYSDRIVER}}>>%t%\n\n@wmic /failfast:on /append:%t% SYSDRIVER get /value\n\n@echo {{WMIC_PAGEFILE}}>>%t%\n\n@wmic /failfast:on /append:%t% PAGEFILE get /value\n\n@echo {{WMIC_PAGEFILE}}>>%t%\n\n@wmic /failfast:on /append:%t% PAGEFILE get /value\n@echo {{SYSTEMINFO}}>>%t%\n\n@SYSTEMINFO>>%t%\n\n@echo {{Reg_Uninstall}}>>%t%\n\n@REG QUERY \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\" /s>>%t%\n\n@echo {{Reg_TerminalServerClient}}>>%t%\n\n@REG QUERY \"HKEY_CURRENT_USER\\Software\\Microsoft\\Terminal Server Client\\Default\" /s>>%t%\n\n@echo {{BOOTCFG}}>>%t%\n\n@BOOTCFG>>%t%\n\n@echo {{IPCONFIG/All}}>>%t%\n@IPCONFIG /ALL>>%t%\n\n@echo {{whoami}}>>%t%\n\n@whoami>>%t%\n\n@echo {{net user /domain}}>>%t%\n\n@net user /domain>>%t%\n\n@echo {{net user}}>>%t%\n\n@net user>>%t%\n\n@echo {{net user Administrator}}>>%t%\n\n@net user Administrator>>%t%\n\n@echo {{net localgroup administrators}}>>%t%\n\n@net localgroup administrators>>%t%\n\n@echo {{net group /domain }}>>%t%\n\n@net group /domain>>%t%\n\n@echo {{net group \"domain admins\" /domain}}>>%t%\n\n@net group \"domain admins\" /domain>>%t%\n\n@echo {{net view}}>>%t%\n\n@net view>>%t%\n\n@echo {{net use}}>>%t%\n\n@net use>>%t%\n\n@echo {{net share}}>>%t%\n\n@net share>>%t%\n\n@echo {{route print}}>>%t%\n\n@route print>>%t%\n\n@echo {{net localgroup}}>>%t%\n\n@net localgroup>>%t%\n\n@echo {{net group \"Exchange Trusted Subsystem\" /domain}}>>%t%\n\n@net group \"Exchange Trusted Subsystem\" /domain>>%t%\n\n@echo {{net accounts /domain}}>>%t%\n\n@net accounts /domain>>%t%\n\n@echo {{net accounts}}>>%t%\n\n\n-----\n\n@net accounts>>%t%\n@echo {{netstat -an}}>>%t%\n\n@netstat -an>>%t%\n\n@echo {{set}}>>%t%\n\n@set>>%t%\n\n@echo {{tasklist}}>>%t%\n\n@tasklist>>%t%\n\n@echo {{dir c:\\ }}>>%t%\n@dir c:\\ >>%t%\n\n@echo {{dir d:\\ }}>>%t%\n\n@dir d:\\ >>%t%\n\n@echo {{dir e:\\ }}>>%t%\n\n@dir e:\\ >>%t%\n\n@echo {{dir f:\\}}>>%t%\n@dir f:\\>>%t%\n\n@echo {{dir g:\\}}>>%t%\n\n@dir g:\\>>%t%\n\n@echo {{dir Desktop}}>>%t%\n\n@dir %appdata%\\..\\..\\Desktop>>%t%\n\n@echo {{dir C:\\Users}}>>%t%\n\n@dir C:\\Users>>%t%\n\n@echo {{dir \"C:\\Program Files\"}}>>%t%\n\n@dir \"C:\\Program Files\">>%t%\n\n@echo {{dir \"C:\\Program Files (x86)\"}}>>%t%\n\n@dir \"C:\\Program Files (x86)\">>%t%\n\n@echo {{dir C:\\ProgramData}}>>%t%\n\n@dir C:\\ProgramData>>%t%\n\n@echo {{tracert -d -4 -w 1500 8.8.8.8}}>>%t%\n\n@tracert -d -4 -w 1500 8.8.8.8>>%t%\n\n@echo {{ping 8.8.8.8}}>>%t%\n\n@ping 8.8.8.8>>%t%\n\n@echo {{ping gitlab.com}}>>%t%\n\n@ping gitlab.com>>%t%\n\n@echo {{ping mail.google.com}}>>%t%\n\n@ping mail.google.com>>%t%\n\n@echo {{ping google.com}}>>%t%\n\n@ping google.com>>%t%\n\n@echo {{ping mf.local}}>>%t%\n\n@ping mf.local>>%t%\n\n@echo {{DATE-TIME}}>>%t%\n\n@date /T>>%t%\n\n@time /T>>%t%\n\n@echo {{END}}>>%t%\n\n@del /q /f %f%\n\n@more<%t%>%f%\n\n@del /q /f %t%\n\n@exit\n\n## MITRE ATT&CK Techniques\n\n**ID** **Technique**\n\n\n-----\n\nT1007 System Service Discovery\n\nT1012 Query Registry\n\nT1027 Obfuscated Files or Information\n\nT1033 System Owner/User Discovery\n\nT1055 Process Injection\n\nT1057 Process Discovery\n\nT1070.004 File Deletion\n\nT1070.006 Timestomp\n\nT1082 System Information Discovery\n\nT1083 File and Directory Discovery\n\nT1087 Account Discovery\n\nT1112 Modify Registry\n\nT1113 Screen Capture\n\nT1134 Access Token Manipulation\n\nT1489 Service Stop\n\nT1497.001 System Checks\n\nT1518 Software Discovery\n\nT1543.003 Windows Service\n\nT1569.002 Service Execution\n\nT1622 Debugger Evasion\n\n## Yara Rules\n```\nrule M_Disrupt_ROADSWEEP_1\n{\nmeta:\nauthor = \"Mandiant\"\ndescription = \"Identifies the encryption\nkey used within ROADSWEEP\"\nstrings:\n$ = {C6 45 D5 E4 C6 45 D6 B1 C6 45 D7 6B C6 45 D8 22 C6 45\nD9 B5 C6 45 DA 88 C6 45 DB 94 C6 45 DC AA C6 45 DD 86 C6 45 DE C4 C6 45 DF 21 C6 45 E0 E8 C6 45\nE1 75 C6 45 E2 9D C6 45 E3 F3 C7 44 24 10 00 00 00 F0}\ncondition:\nall of them\n}\nrule\n\n```\n\n-----\n\n```\nM_Disrupt_ZEROCLEAR_1 { meta: author Mandiant description Identifies code sequences in\nZEROCLEAR\"\nstrings:\n$ = \"B4B615C28CCD059CF8ED1ABF1C71FE03C0354522990AF63ADF3C911E2287A4B906D47D\"\nwide\n$ = \"wp starts!\"\n$ = \"un start!\"\n$ = \"in start!\"\ncondition:\nall of them }\nrule\nM_Backdoor_CHIMNEYSWEEP_1\n{\nmeta:\nauthor = \"Mandiant\"\ndescription = \"Detects strings found in\nCHIMNEYSWEEP\"\nstrings:\n$ = \"%sAPPX.%x%x%x%x%x.tmp\"\n$ = \"rerunadmn\"\n$ = \"runupdate\"\n$ =\n\"runupdateok\"\n$ = \"baserun\"\n$ = \"heyirunadmn\"\n$ = \"subttoadmn\"\n$ = \"ttrundll\"\n$ = \"\n{\\\"ok\\\":false,\"\n$ = \"TL_%s-%s\"\n$ = \"|**|Net1NOFILE|**|\"\n$ = \"%s:---:%s-%s:---:%s:---:www:--:MNEW\"\ncondition:\nuint16(0) == 0x5A4D and 8 of them\n}\nimport \"pe\"\nrule\nM_Backdoor_CHIMNEYSWEEP_2\n{\nmeta:\nauthor = \"Mandiant\"\ndescription = \"Detects encrypted data\nfound in CHIMNEYSWEEP\"\nstrings:\n$key = {C6 45 D5 E4 C6 45 D6 B1 C6 45 D7 6B C6 45 D8 22 C6 45 D9\nB5 C6 45 DA 88 C6 45 DB 94 C6 45 DC AA C6 45 DD 86 C6 45 DE C4 C6 45 DF 21 C6 45 E0 E8 C6 45 E1\n75 C6 45 E2 9D C6 45 E3 F3 C7 44 24 10 00 00 00 F0}\n$encoded_config = {FA c0 c7 e5}\n$encoded_bot\n= {AE E0 ED D6}\ncondition:\nuint16(0) == 0x5A4D and all of them and (pe.exports(\"RatingSetupUI\")\nor pe.exports(\"A\"))\n}\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-08-04 - Likely Iranian Threat Actor Conducts Politically Motivated Disruptive Activity Against Albanian Government Organizations.pdf"
    ],
    "report_names": [
        "2022-08-04 - Likely Iranian Threat Actor Conducts Politically Motivated Disruptive Activity Against Albanian Government Organizations.pdf"
    ],
    "threat_actors": [
        {
            "id": "527e04ee-7f5f-49aa-8653-f893b43730bd",
            "created_at": "2022-10-25T16:07:24.512541Z",
            "updated_at": "2025-03-27T02:02:10.266333Z",
            "deleted_at": null,
            "main_name": "Moses Staff",
            "aliases": [
                "Abraham's Ax",
                "Cobalt Sapling",
                "DEV-0500",
                "Marigold Sandstorm",
                "Vengeful Kitten",
                "White Dev 95"
            ],
            "source_name": "ETDA:Moses Staff",
            "tools": [
                "DCSrv",
                "DCrSrv",
                "PyDCrypt",
                "StrifeWater",
                "StrifeWater RAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "20c759c2-cd02-45bb-85c6-41bde9e6a7cf",
            "created_at": "2024-01-18T02:02:34.189827Z",
            "updated_at": "2025-03-27T02:02:09.937024Z",
            "deleted_at": null,
            "main_name": "HomeLand Justice",
            "aliases": [
                "Karma",
                "Storm-842",
                "Void Manticore"
            ],
            "source_name": "ETDA:HomeLand Justice",
            "tools": [
                "BABYWIPER",
                "BiBi Wiper",
                "BiBi-Linux Wiper",
                "BiBi-Windows Wiper",
                "Cl Wiper",
                "LowEraser",
                "No-Justice Wiper",
                "Plink",
                "PuTTY Link",
                "RevSocks",
                "W2K Res Kit"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "21e01940-3851-417f-9e90-1a4a2da07033",
            "created_at": "2022-10-25T16:07:23.299369Z",
            "updated_at": "2025-03-27T02:02:09.725295Z",
            "deleted_at": null,
            "main_name": "Agrius",
            "aliases": [
                "AMERICIUM",
                "Agonizing Serpens",
                "BlackShadow",
                "DEV-0227",
                "Pink Sandstorm",
                "SharpBoys"
            ],
            "source_name": "ETDA:Agrius",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agrius",
                "BFG Agonizer",
                "BFG Agonizer Wiper",
                "DEADWOOD",
                "DETBOSIT",
                "Detbosit",
                "IPsec Helper",
                "Moneybird",
                "MultiLayer Wiper",
                "PW",
                "PartialWasher",
                "PartialWasher Wiper",
                "SQLShred",
                "Sqlextractor"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d0e8337e-16a7-48f2-90cf-8fd09a7198d1",
            "created_at": "2023-03-04T02:01:54.091301Z",
            "updated_at": "2025-03-27T02:00:03.119447Z",
            "deleted_at": null,
            "main_name": "APT42",
            "aliases": [
                "UNC788",
                "CALANQUE"
            ],
            "source_name": "MISPGALAXY:APT42",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7f25e108-e694-49b6-a494-c8458b33eb3f",
            "created_at": "2024-01-09T02:00:04.199217Z",
            "updated_at": "2025-03-27T02:00:03.278805Z",
            "deleted_at": null,
            "main_name": "HomeLand Justice",
            "aliases": [],
            "source_name": "MISPGALAXY:HomeLand Justice",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "47fa514e-15a8-4adb-a782-e2ffb12944d8",
            "created_at": "2024-04-24T02:00:49.644637Z",
            "updated_at": "2025-03-27T02:00:55.560836Z",
            "deleted_at": null,
            "main_name": "UNC788",
            "aliases": [
                "UNC788"
            ],
            "source_name": "MITRE:UNC788",
            "tools": [
                "HilalRAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ba5bc606-8b26-416a-881d-76cdefc6c75c",
            "created_at": "2024-06-04T02:03:07.777739Z",
            "updated_at": "2025-03-27T02:05:17.322164Z",
            "deleted_at": null,
            "main_name": "COBALT SAPLING",
            "aliases": [
                "Moses Staff",
                "Abraham's Ax"
            ],
            "source_name": "Secureworks:COBALT SAPLING",
            "tools": [
                " PyDcrypt",
                " StrifeWater RAT",
                "DCSrv"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bef06c82-0f51-44ba-8451-049cd4ad8a52",
            "created_at": "2023-01-06T13:46:39.325635Z",
            "updated_at": "2025-03-27T02:00:03.05159Z",
            "deleted_at": null,
            "main_name": "MosesStaff",
            "aliases": [
                "Moses Staff",
                "Marigold Sandstorm",
                "DEV-0500"
            ],
            "source_name": "MISPGALAXY:MosesStaff",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c4d0e4e1-5ad3-4455-8291-ce72a1e09e46",
            "created_at": "2022-10-27T08:27:13.055675Z",
            "updated_at": "2025-03-27T02:00:55.458634Z",
            "deleted_at": null,
            "main_name": "Moses Staff",
            "aliases": [
                "Moses Staff",
                "DEV-0500",
                "Marigold Sandstorm"
            ],
            "source_name": "MITRE:Moses Staff",
            "tools": [
                "PyDCrypt",
                "PsExec",
                "DCSrv",
                "StrifeWater"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535772,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1660794916,
    "ts_modification_date": 1660794916,
    "files": {
        "pdf": "https://archive.orkl.eu/2e067bbbc5b27f5f8fc131660e3be135300db3cf.pdf",
        "text": "https://archive.orkl.eu/2e067bbbc5b27f5f8fc131660e3be135300db3cf.txt",
        "img": "https://archive.orkl.eu/2e067bbbc5b27f5f8fc131660e3be135300db3cf.jpg"
    }
}