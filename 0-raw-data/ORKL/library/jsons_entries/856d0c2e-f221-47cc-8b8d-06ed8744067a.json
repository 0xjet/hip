{
    "id": "856d0c2e-f221-47cc-8b8d-06ed8744067a",
    "created_at": "2023-01-12T15:09:14.548196Z",
    "updated_at": "2025-03-27T02:05:42.398934Z",
    "deleted_at": null,
    "sha1_hash": "01742bd91e6bab1c97de280fb891d68054cf5e66",
    "title": "2022-01-17 - AvosLocker Ransomware Linux Version Targets VMware ESXi Servers",
    "authors": "",
    "file_creation_date": "2022-05-27T23:06:19Z",
    "file_modification_date": "2022-05-27T23:06:19Z",
    "file_size": 961484,
    "plain_text": "# AvosLocker Ransomware Linux Version Targets VMware ESXi Servers\n\n**[blog.cyble.com/2022/01/17/avoslocker-ransomware-linux-version-targets-vmware-esxi-servers/](https://blog.cyble.com/2022/01/17/avoslocker-ransomware-linux-version-targets-vmware-esxi-servers/)**\n\nJanuary 17, 2022\n\nRansomware is a category of malware that uses various encryption algorithms to encrypt crucial data on the\n[user’s machine and demands the user for ransom. AvosLocker is a ransomware group identified in 2021,](https://blog.cyble.com/2021/07/23/deep-dive-analysis-avoslocker-ransomware/)\n[specifically targeting Windows machines. Additionally, Cyble Research Labs have come across a Twitter post](https://twitter.com/ChristiaanBeek/status/1480551019310469120)\nthat mentioned a new Linux variant of AvosLocker ransomware targeting VMware ESXi servers. In this blog\npost, we will discuss AvosLocker Linux ransomware in detail.\n\nCyble Research Labs found through dark/deepweb research that the Threats Actors (TAs) or affiliates of\nAvosLocker ransomware groups are using Proxyshell to exploit Microsoft Exchange Server vulnerabilities\n[compromising victim’s network, such as CVE-2021-34473,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34473) [CVE-2021-31206,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-31206) [CVE-2021-34523, and](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-34523) CVE[2021-31207. Once the TAs access the machine, they deploy mimikatz to dump passwords. TAs can get RDP](https://attack.mitre.org/software/S0002/)\naccess to the domain controller by using the identified passwords, exfiltrating data from the compromised\nmachine. Finally, AvosLocker ransomware gets deployed on the victim system by the attacker to encrypt the\nvictim’s documents and files.\n\n## Technical analysis\n\n\n-----\n\nBased on static analysis, we found that the malicious file is an x64 based Executable and Linkable Format\n(ELF) file, as shown in Figure 1.\n\nFigure 1 – Static\n\nELF File Details\nUpon executing the AvosLocker ransomware on Linux machines, it instructs the user to run a command which\nhas the parameter that specifies the path of the directory to be encrypted. Also, the command has another\nparameter that denotes the number of threads to be involved in the encryption process. The in-built\nmultithreading functionality helps TAs to encrypt the files faster, as shown in Figure 2.\n\nFigure 2 – Malware Instructs\n\nfor Drive Path\nAfter execution, the AvosLocker checks the presence of VMware Elastic Sky X Integrated (ESXi), Virtual\nMachine File System (VMFS), and kills the Virtual Machines (VMs) if they are running using the command\ngiven in the figure below.\n\nFigure 3 – Command to Kill ESXi VMs\nThe below figure demonstrates that the malware appends the extension as .avoslinux after encrypting the files\non the victim’s machine.\n\n\n-----\n\nFigure 4 – Appends the File Extension after Encryption\n\nBefore encrypting the files, the malware performs thread synchronization operation using mutex lock/unlock\nAPIs to avoid overlapping the encryption process, as shown in Figure 5.\n\nFigure 5 – Thread Synchronization Encrypting the Files\n\nThe content of an encrypted file has base64 encoded content at the end of the file. As shown in the figure\nbelow, we suspect that the base64 encoded data contains a cryptographic key used to encrypt the file.\n\nFigure 6 – Encrypted File Contents\nBefore starting the encryption process, the malware drops ransom notes with the name\nREADME_FOR_RESTORE.txt in the specific drive. Then, like other ransomware groups, the attackers instruct\nthe victims to visit the TOR website as shown in the figure below\n\n\n-----\n\nFigure 7 – Ransom note\nWhen the victim visits AvosLocker’s TOR website, it asks for the ID given on the ransom note to proceed with\nthe payment process, as shown in the below figure.\n\nFigure 8 – AvosLocker’s\n\nTOR Website\nOnce the victim enters the ID, the website redirects to the payment page where TAs instructs victims to pay\nUSD 1,000,000.00/ 4629.63 XMR/ 28.61 BTC (25% processing fee) – the ransom amount would double if the\nvictim does not pay the ransom before the deadline.\n\nFor payment through Monero, the TAs has provided Monero ID and the payment ID, as shown in Figure 9.\n\n\n-----\n\nFigure 9 – AvosLocker’s Payment Page\n\n## Other Observations\n\nCyble Research Labs had found that the TAs leaked their victim’s details on their leak website when victims\nfailed to pay the ransom. The following figure showcases the Avoslocker leak website with recent victims.\n\nFigure 10 – List of Victims Mentioned on the Leak Site\nAlso, the leak site noted that TAs had mentioned an affiliate program that provides Ransomware as a Service\n(RaaS), which includes Affiliate panels, Calling Services, etc., as shown in the below figure.\n\n\n-----\n\nFigure 11 –\n\nAvosLocker’s Partnership Program\nThe ransomware groups are looking for support to expand their cybercrime ransomware business in the\ncountries such as the USA, Canada, the United Kingdom, and Australia, as shown in the figure below.\n\nFigure 12 – TA’s Post on\n\nCyber Crime Forum\n\n## Conclusion\n\nThere is likely a new version of AvosLocker ransomware for the Linux platform. The latest version is where\ncybercriminals added a unique code to evolve their Raas services with new Tactics, Techniques, and\nProcedures (TTP), which targets ESXi and VMFS machines. Therefore, we believe that there may be an\nenhancement in the form of an upcoming variant of the AvosLocker ransomware.\n\nWe are continuously monitoring AvosLocker’s extortion campaign and updating our readers with the latest\ninformation as and when we find it.\n\n## Our Recommendations\n\nWe have listed some essential cybersecurity best practices that create the first line of control against\nattackers. We recommend that our readers follow the best practices given below:\n\n### Safety measures needed to prevent ransomware attacks\n\nConduct regular backup practices and keep those backups offline or in a separate network.\n\n\n-----\n\nTurn on the automatic software update feature on your computer, mobile, and other connected devices\nwherever possible and pragmatic.\nUse a reputed anti-virus and Internet security software package on your connected devices, including\nPC, laptop, and mobile.\nRefrain from opening untrusted links and email attachments without verifying their authenticity.\n\n### Users should take the following steps after a ransomware attack\n\nDetach infected devices on the same network.\nDisconnect external storage devices if connected\nInspect system logs for doubtful events.\n\n### Impacts and cruciality Of AvosLocker Ransomware\n\nLoss of Valuable data.\nLoss of organizations reliability or integrity.\nLoss of organisation’s businesses information.\nDisruption in organization operation.\nEconomic loss.\n\n## MITRE aTT&CK® tECHNIQUES\n\n**Tactic** **Technique ID** **Technique Name**\n\n\n**Initial Access** [T1190](https://attack.mitre.org/techniques/T1190/)\n\n[T1189](https://attack.mitre.org/techniques/T1189/)\n\n\n– Exploit Public-Facing Application\n\n– Drive-by Compromise\n\n\n**Execution** [T1059](https://attack.mitre.org/techniques/T1059/) – Command and Scripting Interpreter\n\n**Credential Access** [T1555](https://attack.mitre.org/techniques/T1555/) – Credentials from Password Stores\n\n**Discovery** [T1082](https://attack.mitre.org/techniques/T1082/) – System Information Discovery\n\n**Collection** [T1530](https://attack.mitre.org/techniques/T1530) – Data from Cloud Storage Object\n\n\n**Impact** [T1490](https://attack.mitre.org/techniques/T1490/)\n\n[T1489](https://attack.mitre.org/techniques/T1489/)\n\n[T1486](https://attack.mitre.org/techniques/T1486/)\n\n\n– Inhibit System Recovery\n\n– Service Stop\n\n– Data Encrypted for Impact\n\n\n## indicators Of Compromise (IOCs)\n\n**Indicators** **Indicator**\n**type**\n\n\n**Description**\n\n\n**0cd7b6ea8857ce827180342a1c955e79c3336a6cf2000244e5cfd4279c5fc1b6** SHA256 AvosLocker\nELF\n\n**10ab76cd6d6b50d26fde5fe54e8d80fceeb744de8dbafddff470939fac6a98c4** SHA256 AvosLocker\nELF\n\n**7c935dcd672c4854495f41008120288e8e1c144089f1f06a23bd0a0f52a544b1** SHA256 AvosLocker\nELF\n\n\n-----\n\n**e737c901b80ad9ed2cd800fec7c2554178c8afab196fb55a0df36acda1324721** SHA256 Archive File\nContaining\nAvosLocker\nELF\n\n**hxxp://avosjon4pfh3y7ew3jdwz6ofw7lljcxlbk7hcxxmnxlh5kvf2akcqjad[.]onion** URL AvosLocker’s\nTOR Website\n\n**hxxp://avosqxh72b5ia23dl5fgwcpndkctuzqvh2iefk5imp3pi5gfhel5klad[.]onion** URL AvosLocker’s\nleak website\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-17 - AvosLocker Ransomware Linux Version Targets VMware ESXi Servers.pdf"
    ],
    "report_names": [
        "2022-01-17 - AvosLocker Ransomware Linux Version Targets VMware ESXi Servers.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536154,
    "ts_updated_at": 1743041142,
    "ts_creation_date": 1653692779,
    "ts_modification_date": 1653692779,
    "files": {
        "pdf": "https://archive.orkl.eu/01742bd91e6bab1c97de280fb891d68054cf5e66.pdf",
        "text": "https://archive.orkl.eu/01742bd91e6bab1c97de280fb891d68054cf5e66.txt",
        "img": "https://archive.orkl.eu/01742bd91e6bab1c97de280fb891d68054cf5e66.jpg"
    }
}