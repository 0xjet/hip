{
    "id": "7a1fc761-5883-4dfa-836a-d865cb3d56e7",
    "created_at": "2023-04-05T02:09:14.52162Z",
    "updated_at": "2025-03-27T02:05:47.80308Z",
    "deleted_at": null,
    "sha1_hash": "30d89a70500d63d896705aa3ead80424db23a0ee",
    "title": "2023-03-13 - CatB Ransomware - File Locker Sharpens Its Claws to Steal Data with MSDTC Service DLL Hijacking",
    "authors": "",
    "file_creation_date": "2023-04-03T08:28:17Z",
    "file_modification_date": "2023-04-03T08:28:17Z",
    "file_size": 1047366,
    "plain_text": "# CatB Ransomware | File Locker Sharpens Its Claws to Steal Data with MSDTC Service DLL Hijacking\n\n**[sentinelone.com/blog/decrypting-catb-ransomware-analyzing-their-latest-attack-methods/](https://www.sentinelone.com/blog/decrypting-catb-ransomware-analyzing-their-latest-attack-methods/)**\n\nMarch 13, 2023\n\nThe CatB ransomware family, sometimes referred to as CatB99 or Baxtoy, was first observed\nin late 2022, with campaigns being observed steadily since November. The group’s activities\n[have gained attention due to their ongoing use of DLL hijacking via Microsoft Distributed](https://minerva-labs.com/blog/new-catb-ransomware-employs-2-year-old-dll-hijacking-technique-to-evade-detection/)\nTransaction Coordinator (MSDTC) to extract and launch ransomware payloads.\n\nString similarities in the ransom notes as well as modifications left by the ransomware\npayloads suggest that CatB may be either an evolution or direct rebrand of the Pandora\nransomware, which was active in early to mid-2022 and targeted the automotive industry.\n\nIn this post, we offer a technical analysis of the CatB ransomware and its abuse of the\nlegitimate MSDTC service, describing its evasion tactics, encryption behavior, and its\nattempts to steal credentials and browser data.\n\n## CatB Ransomware Technical Information\n\nCatB payloads are distributed as a two DLL set. A dropper DLL is responsible for initial\nevasive environmental checks as well as dropping and launching the second DLL, which\nserves the ransomware payload\n\n\n-----\n\nCatB Ransomware Process Graph\nFirst, the dropper is distributed in the form of a UPX-packed DLL (versions.dll). This\ndropper deposits the second DLL payload (oci.dll) onto the target host. The dropper DLL is\nresponsible for any sandbox evasion techniques required by the threat actor. Sandbox\nevasion inhibits the analysis process and ultimately leads to more time in the target\nenvironment for the attacker.\n\nCatB performs three primary checks in an attempt to determine if the payload is being\nexecuted within a virtual environment. These are direct checks for type and size of physical\nRAM, type and size of physical hard disks, and checking for odd or anomalous combinations\nof processors and cores.\n\n[Upon execution, CatB payloads rely on DLL search order hijacking to drop and load the](https://attack.mitre.org/techniques/T1574/001/)\nmalicious payload. The dropper (versions.dll) drops the payload (oci.dll) into the\nSystem32 directory.\n\n\n-----\n\n_Oci.dll payloads in System32 (view from Singularity™ Console)_\nThe malware then abuses the MSDTC service, manipulating the permissions and startup\nparameters. As a result, the system will inject the malicious oci.dll into the service’s\nexecutable (msdtc.exe) when the MSDTC service is restarted. Taskill.exe is used to\nterminate the msdtc.exe process once the service configuration changes have been made.\n\n_Msdtc.exe termination syntax_\nCatB ransomware excludes the following files and extensions from the encryption process:\n```\n.msi, .dll, .sys, .iso and NTUSER.DAT.\n\n```\nEncryption\n\nexclusions in payload DLL\nIn addition to the hardcoded exclusions, the local disk volumes to be encrypted are also\nconfigured in a similar manner. By default, the oci.dll payload will attempt to encrypt\n```\nC:\\users (crawl whole tree), I:, H:, G:, F:, E:, and D:.\n\n```\n\n-----\n\nLocal encryption targets in oci.dll\nThe lack of post-encryption alterations is a trait that sets CatB apart from other\ncontemporaries. Once encrypted, there is no blatant indicator – no separate ransom note\ndropped, no change to the desktop wallpaper, and no antagonizing file extensions. Instead,\nwhat could be considered the ransom note is inserted into the beginning of each encrypted\nfile.\n\nRansom note appended to head of encrypted file (catb991 variation)\nPer the ransom note, the only way to engage the threat actor is via email at the provided\ncatB9991 protonmail address. Beyond that, a single Bitcoin (BTC) address is provided for\npayment submissions. The ransom price is set to increase each day for five days and,\nfollowing the fifth day, there will be “permanent data loss” if the victim does not comply.\n\nBased on observations, there is no evidence to indicate that CatB operators are generating\npayment wallets for each victim as the Bitcoin address provided is not unique to each\nsample.\n\n\n-----\n\nGeneration of unique key file\nA key file is deposited onto each infected host in c:\\users\\public\\. This file must be\nincluded in email correspondence with the attackers as it is, ideally, a unique identifier for\neach victim or host.\n\nfile dropped for each victim\n\nExample CatB ‘key’ file\n\n## Credential and Browser Data Theft\n\nIn addition to file encryption and obfuscation, the CatB malware will attempt to gather\nspecific, sensitive information from targeted systems. This includes browser session and\ncredential data.\n\n\nKey\n\n\n-----\n\nThe ransomware contains functionality to discover and extract user data from Mozilla Firefox,\nGoogle Chrome, Microsoft Edge as well as Internet Explorer. Data extracted from browsers\nincludes bookmarks, blocklists, crash logs, history, user profile data, autofill data,\nenvironmental settings, browser session keys, and more.\n\nCatB malware will also attempt to locate and extract sensitive information from Windows Mail\nprofile data (\\AppData\\Local\\Microsoft\\Windows Mail\\).\n\n## Variations of CatB Threat Campaigns\n\nSamples pulled from a November 2022 campaign feature a different contact email address,\n```\nfishA001[@]protonmail.com. This later changes to the catB9991 protonmail address\n\n```\nmentioned above. This is the only difference with regards to the ransom notes. Other details\nsuch as payment-per-day breakdowns and the BTC payment address are identical.\n\nAlternate ransom note (fisha001)\nWe have also encountered variations which include both email addresses. When these\n‘double email’ notes are appended to the head of files, it looks as follows:\n\n\n-----\n\nAlternate ransom note (double-email, no BTC)\nThese ransom notes display all the same features minus the BTC payment address. Also\nmissing is the requirement to submit the key file in c\\users\\public\\key. Notes that are\nmissing the key submission feature suggest that they are artifacts of an earlier ‘test’ version\nof the ransomware.\n\n## BTC Payment / Blockchain Status\n\nAs the time of writing, the BTC address associated with CatB ransomware have zero\ntransactions and a zero balance.\n\n\n-----\n\nBTC Balance for Wallet – bc1qakuel0s4nyge9rxjylsqdxnn9nvyhc2z6k27gz\n\n## Conclusion\n\nCatB joins a long line of ransomware families that embrace semi-novel techniques and\natypical behaviors such as appending notes to the head of files. These behaviors appear to\nbe implemented in the interest of detection evasion and some level of anti-analysis trickery.\nFor example, many environments rely solely on the appearance of ransom notes to alert\nthem to the potential of a ransomware outbreak. This is not the case with CatB.\n\nDespite that, the threat lacks in overall sophistication, and a modern, properly configured,\nXDR/EDR solution should alert quickly upon initiation of a CatB attack in the environment.\n\n[SentinelOne Singularity™ fully prevents and protects customers against malicious behaviors](https://www.sentinelone.com/platform)\nassociated with CatB Ransomware.\n\n## Indicators of Compromise\n\n### SHA1 CatB Samples\n\n\n-----\n\n1028a0e6cecb8cfc4513abdbe3b9d948cf7a5567\n\n8c11109da1d7b9d3e0e173fd24eb4b7462073174\n\n951e603af10ec366ef0f258bf8d912efedbb5a4b (early version note example)\n\ndb99fc79a64873bef25998681392ac9be2c1c99c\n\ndd3d62a6604f28ebeeec36baa843112df80b0933\n\n### Email addresses\n\ncatB9991[at]protonmail[.]com\n\nfishA001[at]protonmail[.]com\n\n### BTC Wallets\n```\nbc1qakuel0s4nyge9rxjylsqdxnn9nvyhc2z6k27gz\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-03-13 - CatB Ransomware - File Locker Sharpens Its Claws to Steal Data with MSDTC Service DLL Hijacking.pdf"
    ],
    "report_names": [
        "2023-03-13 - CatB Ransomware - File Locker Sharpens Its Claws to Steal Data with MSDTC Service DLL Hijacking.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1680660554,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1680510497,
    "ts_modification_date": 1680510497,
    "files": {
        "pdf": "https://archive.orkl.eu/30d89a70500d63d896705aa3ead80424db23a0ee.pdf",
        "text": "https://archive.orkl.eu/30d89a70500d63d896705aa3ead80424db23a0ee.txt",
        "img": "https://archive.orkl.eu/30d89a70500d63d896705aa3ead80424db23a0ee.jpg"
    }
}