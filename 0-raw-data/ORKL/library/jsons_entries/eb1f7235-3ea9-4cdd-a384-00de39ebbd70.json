{
    "id": "eb1f7235-3ea9-4cdd-a384-00de39ebbd70",
    "created_at": "2023-01-12T15:00:06.854748Z",
    "updated_at": "2025-03-27T02:15:38.168983Z",
    "deleted_at": null,
    "sha1_hash": "96e1de157097adf51f1cda2a82d018fff05fad16",
    "title": "2020-10-12 - Trickbot disrupted",
    "authors": "",
    "file_creation_date": "2022-05-28T22:07:19Z",
    "file_modification_date": "2022-05-28T22:07:19Z",
    "file_size": 348971,
    "plain_text": "# Trickbot disrupted\n\n**[microsoft.com/security/blog/2020/10/12/trickbot-disrupted/](https://www.microsoft.com/security/blog/2020/10/12/trickbot-disrupted/)**\n\nOctober 12, 2020\n\nAs announced today, Microsoft took [action against the Trickbot botnet, disrupting one of the](https://blogs.microsoft.com/on-the-issues/2020/10/12/trickbot-ransomware-cyberthreat-us-elections/)\nworld’s most persistent malware operations. Microsoft worked with telecommunications\nproviders around the world to disrupt key Trickbot infrastructure. As a result, operators will no\nlonger be able to use this infrastructure to distribute the Trickbot malware or activate\ndeployed payloads like ransomware.\n\nMicrosoft actively tracks the threat landscape, monitoring threat actors, their campaigns,\nspecific tactics, and evolution of malware. We share this intelligence with the community and\nuse our research to continuously improve our products. Below, we will detail the evolution of\nthe Trickbot malware, associated tactics, recent campaigns, and dive into the anatomy of a\nparticular attack we observed.\n\nTrickbot was first spotted in 2016 as a banking trojan that was created as a successor to\nDyre and designed to steal banking credentials. Over the years, Trickbot’s operators were\nable to build a massive botnet, and the malware evolved into a modular malware available\nfor malware-as-a-service. The Trickbot infrastructure was made available to cybercriminals\nwho used the botnet as an entry point for human-operated campaigns, including attacks that\nsteal credentials, exfiltrate data, and deploy additional payloads, most notably Ryuk\nransomware, in target networks.\n\nTrickbot was typically delivered via email campaigns that used current events or financial\nlures to entice users to open malicious file attachments or click links to websites hosting the\nmalicious files. Trickbot campaigns usually used Excel or Word documents with malicious\nmacro codes, but other types of attachments have been used. The campaigns were\nobserved in a wide range of verticals and geolocation, with operators frequently reusing\npreviously compromised email accounts from earlier campaigns to distribute emails without\nnarrowing targets.\n\nIn addition to phishing emails, Trickbot was also deployed through lateral movement via\nServer Message Block (SMB) or as a second-stage payload of other malware like Emotet.\nOnce Trickbot was launched, operators utilized it to install reconnaissance tools like\nPowerShell Empire, Metasploit, and Cobalt Strike. They used these tools to steal credentials\nand network configuration information, move laterally to high-value assets, or deliver\nadditional malicious payloads.\n\nThreat data from [Microsoft 365 Defender, which correlates signals from endpoints, email and](https://www.microsoft.com/en-us/security/business/threat-protection/integrated-threat-protection)\ndata, identities, and cloud apps to deliver comprehensive protection against threats, shows\nthat Trickbot showed up in both large and small enterprises across the globe, helped no\n\n\n-----\n\ndoubt by its modular nature and widespread misconception of it being a commodity banking\ntrojan.\n\n## Anatomy of a Trickbot campaign\n\nTrickbot is one of the most prolific malware operations in the world, churning out multiple\ncampaigns in any given period. In one specific campaign, the Trickbot operators used\nseveral disparate compromised email accounts to send out hundreds of malicious emails to\nboth enterprise and consumer accounts. Recipients were from a variety of industry verticals\nand geolocations and do not appear to have been specifically targeted. This campaign used\na shipping and logistics theme, and had the following subject lines:\n\nShipment receipt\nDelivery finished\nUrgent receipt comment\nEssential receipt reminder\nRequired declaration\n\nThe emails contained a malicious Excel attachment that, when opened, prompted the user to\nenable macros. If enabled, the macro wrote a malicious JScript Encoded (JSE) file to the\ndisk, which is then executed via WScript. The JSE script connected to the affected\norganization’s domain controller and performed several LDAP queries to gather information\nabout Active Directory, including the schema and user lists. The script then exfiltrated the\ninformation to attacker-controlled infrastructure. The script used the jscript.encode command\nto encode both server-side and client-side files in order to obfuscate content and evade\ndetection.\n\n\n-----\n\nNext, the JSE file performed several reconnaissance queries to obtain information about the\ndevice’s network adapter, antivirus products, domain role, and email. Once the exfiltration\nwas completed, a dropped .bat file established a connection with two separate C2 servers:\nan IP address and a domain hosted on a separate IP address. Trickbot used both these C2\nservers to evade network filtering configurations. The .bat file performed reconnaissance\ncommands to find domain administrators on the network. It then dropped and launched the\nGreenshot screenshot tool and Cobalt Strike beacon on the device.\n\nAt this point, the operators had gained control of the affected device, only 8.5 hours after the\nuser opened the malicious email attachment. The operators then started to copy the\nfreeware tool ADFind.exe, which they used for discovery as well as for gathering domain\nconfiguration and organization information. They then archived data found during this\ndiscovery to a .7z file for later exfiltration.\n\nThe attackers ran several commands to obtain information about the domain controller and\ngather Kerberos tickets, conducted port scanning on SMB port 445, NetBIOS 139, and\nqueried LDAP for multiple server devices. Using the information gathered, attackers pinged\nseveral potentially high-value devices. From there, they viewed the contents of specific text\nand log files, likely gleaned from their reconnaissance. Upon finding a device with an open\nport 445, they used runas /netonly (logon type 9, which is intentionally used to confuse\nanalysis of logon events) for authentication and interactively executed commands on the\ndevice.\n\nOnce authenticated, the attackers viewed existing RDP files from prior unrelated sessions for\nRDP settings and credentials. From there, they dropped a Trickbot executable and stole\ncredentials from the Windows Vault and Credentials Manager, allowing the attackers to\nevade many well-known security mechanisms that monitor processes accessing Local\nSecurity Authority Subsystem Service (LSASS) memory to dump the credentials. They used\na .bat file to view multiple shares, ping additional servers, and read several text files. Finally,\nthe attackers exfiltrated all gathered data.\n\nThe attackers persisted in the network via a copy of the malicious .jse file in the Startup\nfolder. Using this .jse file, they have the capability to return to this network later and attempt\nto log on to other, more valuable devices and steal additional information or drop additional\npayloads. This highlights the importance of comprehensive response to “commodity\nmalware” like Trickbot: the original banking trojan infection may be triaged and remediated,\nbut without a full understanding of Trickbot as an entry vector to human adversaries, the real\nthreat remains in the network.\n\n\n-----\n\n## Modular, multi-stage malware\n\nTrickbot is a multi-stage malware typically composed of a wrapper, a loader, and a main\nmalware module. The wrapper, which uses multiple templates that constantly change, is\ndesigned to evade detection by producing unique samples, even if the main malware code\nremains the same.\n\nWhen the wrapper process runs, it runs the loader fully in its memory. The loader has a\nhighly modular design. It decrypts each function at runtime before running it, and then\nencrypts it back. Likewise, all human-readable strings are decrypted and all APIs are\nresolved at runtime. In some scenarios, Trickbot uses UAC bypasses to elevate the\nprivileges of its processes. On 64-bit systems, Trickbot uses the “Heaven’s Gate” technique\nto switch 32-bit code to 64-bit, and has an additional stage where a 64-bit loader injects the\nmain module into the suspended process.\n\nThe loader runs the main malware module directly in memory. After creating scheduled tasks\nfor persistence, the main malware module decrypts a configuration file, which contains the\ninformation it needs for its next steps:\n\nEstablish HTTPS communication with command and control (C2) server\nDownload modules from the C2 server\nMonitor the status of the downloaded modules\nSynchronize communication between the main module and the downloaded modules\n\nThe modules are likewise run in memory via injection into the suspended process. Over the\nyears, Trickbot has used a wide range of modules for various malicious activities. These\ninclude the following:\n\n**Modules** **Purpose**\n\n\n-----\n\npwgrab Gathers credentials, autofill data, history and so on from browsers\n\nnetworkDll Gathers network and system information\n\nimportDll Gathers browser data\n\ninjectDll Main banker module; uses static and dynamic web browser injection and\ndata theft\n\ntabDll Propagates Trickbot via EternalRomance Exploit\n\nPropagates Trickbot via SMB EternalBlue Exploit\n\nshareDll Propagates Trickbot via Windows network shares\n\n\nvncDll,\nBCTestDll\n\n\nRemote control/Virtual Network Computing module; provides backdoor for\nfurther module downloads\n\n\nrdpscanDll Launches brute force attacks against selected Windows systems running\nRemote Desktop Protocol (RDP) connection exposed to the Internet\n\nSysteminfo Gathers system information\n\nmailsearcher Searches all files on disk and compares their extensions to a predefined list\nto harvest emails addresses\n\noutlookDll Gather Outlook credentials\n\npsfin Gathers point of sale (POS) software credentials\n\nsqulDll Gathers email addresses stored in SQL servers\n\naDll Runs various commands on a Windows domain controller to steal Active\nDirectory credentials\n\nTrickbot sends information like domain names and IP ranges of compromised networks back\nto operators, who then select some of these networks for additional exploitation and\nreconnaissance activities. On selected networks, Trickbot operators installed additional tools\nlike Cobalt Strike, and switch to a hands-on-keyboard attacks. Once the operators gain\nfoothold on a network, they used tools like Mimikatz and LaZagne to steal additional\ncredentials and tools like BloodHound and ADFind to perform reconnaissance actions. Apart\nfrom using the stolen credentials and collected data to further the attack, operators also\nexfiltrated data. They then leave multiple persistence points on the network to enable the\neventual delivery of other payloads like Ryuk ransomware.\n\nWhile much has been made of the Trickbot’s supposed antivirus evasion capabilities, it’s a\nsimple PowerShell command being run to turn off Microsoft Defender Antivirus, but it can\nperform this action only if the user has administrative rights.\n\n\n-----\n\n## Recent prominent Trickbot campaigns\n\nIn June 2020, we tracked multiple Trickbot campaigns. As is typical with Trickbot, some of\nthe email campaigns took advantage of current events as lures to entice users to click on\nmalicious attachments. These lures include Black Lives Matter and COVID-19. Earlier in the\nyear, we [reported that Trickbot was the most prolific malware operation using COVID-19-](https://twitter.com/MsftSecIntel/status/1251181180281450498)\nthemed lures. Many other simultaneous campaigns used more generic lures, such as\nshipping and logistics, invoicing and payments, customer complaints, and various financial\nlures.\n\nThe email body was often simple but maintained consistency with the lure used in the\nsubject line. The emails used a wide range of attachment types, including:\n\nWord macro attachments\nExcel VBA macro attachments\nExcel 4.0 macro attachments\nJava Network Launch Protocol (.jnlp) attachments\n\nSome campaigns do away with the attachments and instead use malicious links to websites\nthat host malicious files.\n\nThe sender infrastructure for all these emails varied as well. In most campaigns, operators\nused compromised legitimate email accounts and compromised marketing platforms to\ndistribute the malicious emails. However, in one instance, the operators registered several\ndomains using less popular top-level domains (TLDs) such as “.monster” and “.us” to create\ntheir own mail server and send malicious emails from attacker-defined email addresses. At\nleast one of these campaigns used attacker-owned email sender infrastructure that was later\nused to deliver Dridex malware in a separate campaign. The Dridex malware is known to be\nassociated with the CHIMBORAZO (also known as TA505) crime group. Additionally,\nCHIMBORAZO ran simultaneous campaigns that delivered Trickbot.\n\nThe following graphic illustrates the various campaigns, tactics, and techniques used by the\noperators. The complexity of these simultaneous campaigns and techniques indicates that\nthis is a coordinated and professional effort conducted by a sophisticated activity group.\n\n\n-----\n\n## Extended detection and response for the full range of threats\n\nThe action against Trickbot is one of the ways in which Microsoft provide real-world\nprotection against threats. This action will result in protection for a wide range of\norganizations, including financial services institutions, government, healthcare, and other\nverticals from malware and human-operated campaigns delivered via the Trickbot\ninfrastructure.\n\n[In the recently released Microsoft Digital Defense Report, we called out that cybercriminals](https://blogs.microsoft.com/on-the-issues/2020/09/29/microsoft-digital-defense-report-cyber-threats/)\nof all skill sets take advantage of the perception that commodity threats are less impactful to\nbusinesses. Trickbot is proof that this assumption is obsolete, and organizations need to\ntreat and address Trickbot and other malware infections as the broadly damaging threats that\nthey are.\n\nTo help protect customers from the full range of threats, from common malware to highly\nmodular, multi-stage threats like Trickbot, as well as nation-state level attacks, Microsoft 365\nDefender delivers coordinated protection for identities, endpoints, cloud apps, email and\n[documents. Microsoft Defender for Office 365 detects malicious attachments and links in](https://www.microsoft.com/en-us/microsoft-365/security/office-365-defender)\n[email campaigns. Microsoft Defender for Endpoint detects and blocks the Trickbot malware](https://www.microsoft.com/en-us/microsoft-365/security/endpoint-defender)\nand all related components, as well as malicious activities on endpoints. Microsoft Defender\nfor Identity identifies and detects suspicious user activities and compromised identities.\n\nThis breadth of cross-domain visibility allows Microsoft 365 Defender to correlate signals and\ncomprehensively detect and resolve attack chains. Security operations teams can then use\nthe rich set of tools in Microsoft 365 Defender to further hunt for threats and gain insights for\nhardening networks from compromise.\n\n_Microsoft 365 Defender Threat Intelligence Team_\n\n_Microsoft 365 Defender Research Team_\n\n_Digital Crimes Unit (DCU)_\n\n_Detection and Response Team (DART)_\n\n### Talk to us\n\nQuestions, concerns, or insights on this story? Join discussions at the Microsoft 365\nDefender tech community.\n\n[Read all Microsoft security intelligence blog posts.](https://www.microsoft.com/security/blog/microsoft-security-intelligence/)\n\nFollow us on Twitter **[@MsftSecIntel.](https://twitter.com/MsftSecIntel)**\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-10-12 - Trickbot disrupted.pdf"
    ],
    "report_names": [
        "2020-10-12 - Trickbot disrupted.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "99cb4e5b-8071-4f9e-aa1d-45bfbb6197e3",
            "created_at": "2023-01-06T13:46:38.860754Z",
            "updated_at": "2025-03-27T02:00:02.937438Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "SectorJ04 Group",
                "Dudear",
                "G0092",
                "ATK103",
                "Hive0065",
                "Spandex Tempest",
                "GRACEFUL SPIDER",
                "GOLD TAHOE",
                "CHIMBORAZO",
                "SectorJ04"
            ],
            "source_name": "MISPGALAXY:TA505",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5e6b31a6-80e3-4e7d-8b0a-d94897ce9b59",
            "created_at": "2024-06-19T02:03:08.128175Z",
            "updated_at": "2025-03-27T02:05:17.400394Z",
            "deleted_at": null,
            "main_name": "GOLD TAHOE",
            "aliases": [
                "SectorJ04 ",
                "Spandex Tempest ",
                "TA505 ",
                "FIN11 "
            ],
            "source_name": "Secureworks:GOLD TAHOE",
            "tools": [
                " Cobalt Strike",
                " FlawedAmmy",
                " Get2",
                " GraceWire",
                " Malichus",
                " SDBbot",
                " ServHelper",
                " TrueBot",
                "Clop"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75d4d6a9-b5d1-4087-a7a0-e4a9587c45f4",
            "created_at": "2022-10-25T15:50:23.5188Z",
            "updated_at": "2025-03-27T02:00:55.489882Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "TA505",
                "Hive0065",
                "Spandex Tempest",
                "CHIMBORAZO"
            ],
            "source_name": "MITRE:TA505",
            "tools": [
                "AdFind",
                "Azorult",
                "FlawedAmmyy",
                "Mimikatz",
                "Dridex",
                "TrickBot",
                "Get2",
                "FlawedGrace",
                "Cobalt Strike",
                "ServHelper",
                "Amadey",
                "SDBbot",
                "PowerSploit"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e447d393-c259-46e2-9932-19be2ba67149",
            "created_at": "2022-10-25T16:07:24.28282Z",
            "updated_at": "2025-03-27T02:02:10.159466Z",
            "deleted_at": null,
            "main_name": "TA505",
            "aliases": [
                "ATK 103",
                "Chimborazo",
                "Gold Evergreen",
                "Gold Tahoe",
                "Graceful Spider",
                "Hive0065",
                "Operation Tovar",
                "Operation Trident Breach",
                "SectorJ04",
                "Spandex Tempest",
                "TA505",
                "TEMP.Warlock"
            ],
            "source_name": "ETDA:TA505",
            "tools": [
                "Amadey",
                "AmmyyRAT",
                "AndroMut",
                "Azer",
                "Bart",
                "Bugat v5",
                "CryptFile2",
                "CryptoLocker",
                "CryptoMix",
                "CryptoShield",
                "Dridex",
                "Dudear",
                "EmailStealer",
                "FRIENDSPEAK",
                "Fake Globe",
                "Fareit",
                "FlawedAmmyy",
                "FlawedGrace",
                "FlowerPippi",
                "GOZ",
                "GameOver Zeus",
                "GazGolder",
                "Gelup",
                "Get2",
                "GetandGo",
                "GlobeImposter",
                "Gorhax",
                "GraceWire",
                "Gussdoor",
                "Jaff",
                "Kasidet",
                "Kegotip",
                "Kneber",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Locky",
                "MINEBRIDGE",
                "MINEBRIDGE RAT",
                "MirrorBlast",
                "Neutrino Bot",
                "Neutrino Exploit Kit",
                "P2P Zeus",
                "Peer-to-Peer Zeus",
                "Philadelphia",
                "Philadephia Ransom",
                "Pony Loader",
                "Rakhni",
                "ReflectiveGnome",
                "Remote Manipulator System",
                "RockLoader",
                "RuRAT",
                "SDBbot",
                "ServHelper",
                "Shifu",
                "Siplog",
                "TeslaGun",
                "TiniMet",
                "TinyMet",
                "Trojan.Zbot",
                "Wsnpoem",
                "Zbot",
                "Zeta",
                "ZeuS",
                "Zeus"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535606,
    "ts_updated_at": 1743041738,
    "ts_creation_date": 1653775639,
    "ts_modification_date": 1653775639,
    "files": {
        "pdf": "https://archive.orkl.eu/96e1de157097adf51f1cda2a82d018fff05fad16.pdf",
        "text": "https://archive.orkl.eu/96e1de157097adf51f1cda2a82d018fff05fad16.txt",
        "img": "https://archive.orkl.eu/96e1de157097adf51f1cda2a82d018fff05fad16.jpg"
    }
}