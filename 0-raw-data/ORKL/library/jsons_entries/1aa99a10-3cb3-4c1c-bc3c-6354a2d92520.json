{
    "id": "1aa99a10-3cb3-4c1c-bc3c-6354a2d92520",
    "created_at": "2022-10-25T16:48:16.662344Z",
    "updated_at": "2025-03-27T02:10:54.466673Z",
    "deleted_at": null,
    "sha1_hash": "f7f4af75a1514fd3ede9f55d515306ef022c940a",
    "title": "Copy of Back to Black(Tech) - VB Localhost",
    "authors": "",
    "file_creation_date": "0001-01-01T00:00:00Z",
    "file_modification_date": "0001-01-01T00:00:00Z",
    "file_size": 2337972,
    "plain_text": "### An analysis of recent BlackTech operations & an open directory full of exploits\n\n###### Sveva Vittoria Scenarelli and Adam Prescott October 2021\n\n\n-----\n\n###### Senior Cyber Threat Intelligence Analyst\n\n APAC-based APTs Infrastructure hunter CONFidence 2021&2020 VirusBulletin 2020 Cyberpunk\n\n @cyberoverdrive\n\n Malware Reverse Engineering Lead\n\n C2 protocols Obfuscation techniques IDA automations\n\n @malworms\n\n\n-----\n\n###### A history of BlackTech (PwC alias: Red Djinn)\n\n Intrusion chain analysis\n\n ● Document lures\n ● Macros\n ● Flagpro\n ● BTSDoor\n ● Infrastructure\n\n The open directory\n\n ● Times.exe\n ● Citrix exploit\n ● Mikrotik exploits\n ● Other tools\n\n Back to Black(Tech)\n\n\n-----\n\n#### y\n\n\n**BlackTech uses**\n**router-level MitM**\n\n**attack to deploy**\n\n\n**Industry Company**\n**digital certificate**\n\n\n**2010: Shrouded**\n**Crossbow first**\n**operations begin**\n\n|Col1|2 C o|\n|---|---|\n|||\n\n|Col1|2 n T|\n|---|---|\n|||\n\n|Col1|l|\n|---|---|\n|||\n\n|s r, w|Col2|\n|---|---|\n|||\n\n|ar e g|Col2|\n|---|---|\n|||\n\n|r o W, o a|Col2|\n|---|---|\n|||\n\n|Col1|v f|\n|---|---|\n|||\n\n\n**First known**\n\n\n**ELF variants of**\n**TSCookie and**\n**PLEAD used in**\n\n\n-----\n\n###### Spearphishing email\n\n BlackTech sends an email to the target, spoofing the address of a legitimate company.\n\n\n###### Malicious Excel document\n\n The Excel file is protected with a password, and asks the user to “Enable content” to view the page.\n\n\n###### VBA macros\n\n\n###### Macros concatenate a decimal-encoded array and decode it to a PE payload, then drop it in the Startup folder.\n\n\n###### Victim profiling\n\n\n###### BlackTech can issue commands, such as whoami, to Flagpro implants to profile the infected victim.\n\n\n###### BTSDoor\n\n\n###### Flagpro downloader\n\n The downloader can perform C2 via the IWebBrowser2 interface and execute basic commands.\n\n\n###### If the victim is of interest to the threat actor, Flagpro can download and execute a backdoor.\n\n\n-----\n\n|SHA-256|ba27ae12e6f3c2c87fd2478072dfa274 7d368a507c69cd90b653c9e707254a1d|\n|---|---|\n|Filename|线路信息.xlsm|\n|File type|MS Excel document|\n|Creation date|2006-09-16 00:00:00|\n|Last modified date|2021-07-14 02:40:12|\n\n\n-----\n\n###### Malicious document requires victim to “Enable content” hence need trust from target\n\n Decodes decimal-encoded string to EXE, drops into Startup as dwm.exe to execute on reboot In other macros, the payload is immediately executed via ShellExecute\n\n 2018 and 2020: dropping TSCookie, likely to target Taiwan 2021: dropping FlagPro\n\n\n###### 2018 and 2020: dropping TSCookie, likely to target Taiwan FlagPro\n\n\n-----\n\n###### 32-bit executable\n\n Persistence Written by the dropper macros to the Startup folder\n\n Mutex 71564__40Fllk293_DD71_4715_A3177782516DB5__71564_ Other samples have very similar ones (only the first-to-last chunk of the mutex string changes)\n\n Download files Writes data received from the C2 to the path %TEMP%\\MY[random chars].tmp. Can then append .exe extension to the file and execute\n\n Backdoor status strings Lots of strings left in plaintext in the downloader:\n\n|Filename|dwm.exe|\n|---|---|\n|File type|Win32 EXE|\n|Compile timestamp|2021-06-22 07:01:31|\n|File size|467,968 bytes|\n\n\n-----\n\n-----\n\n###### IWebBrowser2 interface\n\n C2 responses\n\n Base64-encoded commands, for example\n\n Exec|Exec|cmd.exe /c \"whoami \"|600000\n\n URLs\n\n ● index.htmld?flag=\n\n [base64 results of the command received from the C2]\n\n ● index.htmld?flagpro=\n\n [base64 results of the enumerated credentials]\n\n\n-----\n\n###### 32-bit executable\n\n No persistence mechanisms\n\n Becomes inactive if its C2 resolves to: 111.111.111[.]111 or 222.222.222[.]222\n\n Relatively few strings, no obfuscation\n\n|SHA-256|ee6ed35568c43fbb5fd510bc86374221 6bba54146c6ab5f17d9bfd6eacd0f796|\n|---|---|\n|Filename|ChtIME.exe|\n|File type|Win32 EXE|\n\n\n**Compile timestamp** 2018-09-20 07:30:16\n\n\n###### 2018 sample\n\n\n-----\n\n-----\n\n###### Domain naming themes:\n ●update\n ●product (CentOS, McAfee,\n Symantec)\n\n\n-----\n\n###### Pivoting on one of the domains,  update[.]centosupdates[.]com led us to tweets by user @r3dbU7z showing the contents of an open directory in May and July 2021\n\n Several files from it are on VirusTotal\n\n Contents:\n\n ● Known BlackTech tools:\n\n ○ Consock\n ○ FlagPro\n\n ● Exploits\n ● Vulnerability scanner\n ● Post-exploitation utilities\n\n\n###### Several files added to the folder be tween May (above) / July (right) - notably, folders ccc.zip, chajian.rar, poc.rar, PocList-main (new).zip\n\n Also added: Consock Flagpro and\n\n\n###### Several files added to the folder be tween May (above) / July (right) - notably, folders ccc.zip, chajian.rar, poc.rar, PocList-main (new).zip\n\n Also added: Consock Flagpro and\n\n\n-----\n\n###### Win32 interactive GUI implant controller\n\n Version 1.2 as compiled on 25th February 2021\n\n Controller for Consock (depending on hardcoded password)\n\n\n**File size** 3,284,992 bytes\n\n###### “Setting” requires:\n\n ●a port to listen on;\n ●seconds to listen for;\n ●a password.\n\n\n-----\n\n###### Designed for a Chinese language pack -> If system is configured in another language, resources won’t display\n\n Requires a specific password to start the server\n\n Range of commands:\n\n ● Gathering user and victim system information (incl. Virtual Machine detection and whether it’s a workstation, a DC…\n ● Executing operator-defined shell commands\n ● Filesystem interaction;\n ● Warning the controller’s operator of the presence of antivirus programs on the victim machine;\n ● Compressing and exfiltrating files chosen by the operator.\n\n\n###### PICTURES HERE\n\n\n-----\n\n###### Exploits for known CVEs in routers, cloud platforms, and databases\n\n All the exploits are implemented in the pocsuite3 framework\n\n Most exploits reference the Chinese vulnerability and exploit database Seebug\n\n Most of these vulnerabilities first submitted to Seebug in April 2021 (e.g. Oracle weblogic released in April, vuln score 7.5)\n\n|Folder name|Contents|\n|---|---|\n|Cisco CVE-2021-1472 + CVE-2021-1473|Cisco RV series Authentication Bypass and Remote Command Execution exploit|\n|Hongdian CVE-2021-28149 + CVE-2021-28152|Hongdian H8922 router Directory Traversal and Remote Command Execution as root exploit|\n|Ricon Telnet RCE|Described in the code as “ricon industrial router telnet backdoor rce”|\n|VMWare vRealize RCE CVE-2021-21975 + CVE-2021-21983|VMware vRealize Operations Unauthenticated code execution exploit|\n|Oracle weblogic 10.3.x RCE|Weblogic ‘marshallobject’ RCE exploit|\n|Weblogic RCE CVE-2021-2135|Oracle WebLogic Server unauthenticated access and takeover exploit|\n\n\n-----\n\n###### An exploit for a Citrix NetScaler vulnerability. Similar ones have been explored here: https://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html\n\n\n-----\n\n-----\n\n-----\n\n#### g g\n\n\n###### Targeted sectors BlackTech focus\n\n\n**Government** **Financial services** **Media**\n\n\n**Engineering /**\n**Construction**\n\n\n**Manufacturing** **Professional /**\n**Managed services**\n\n\n###### BlackTech is a China-based, espionage-motivated threat actor.\n\n Some of it main aims include:\n\n ● stealing intellectual property and proprietary technologies;\n ● gathering information about the activities of companies of interest;\n ● compromising governments (including the Taiwanese one) and entities relevant to Chinese strategic objectives.\n\n Targeting has concentrated on Taiwan, occasionally Japan and Hong Kong, but also includes China and the US.\n\n\n###### All eyes are on Taiwan as a crucial supplier of semiconductors, as well as on Japanese manufacturing.\n\n\n-----\n\n###### Attribution is never as simple as just one item or just one connection\n\n ● Macros (Excel in both cases) seen in 2018 dropping TSCookie now Flagpro\n\n ● Arrived at open directory by pivoting from BlackTech infrastructure\n\n ● Open directory contained:\n\n ○ Consock, attributed firmly to BlackTech due to ties to previous infrastructure\n ○ Flagpro (substantiating the link)\n\n ● Targeting of Chinese subsidiaries of Japanese companies, MSPs\n\n\n-----\n\n# Thank you!\n\n##### For any questions...\n\n###### @cyberoverdrive\n pwc.co.uk/cybersecurity\n\n @malworms\n\nThis publication has been prepared for general guidance on matters of interest only, and does not constitute professional advice. You should not act upon the information contained in this\npublication without obtaining specific professional advice. No representation or warranty (express or implied) is given as to the accuracy or completeness of the information contained in this\npublication, and, to the extent permitted by law, PricewaterhouseCoopers LLP, its members, employees and agents do not accept or assume any liability, responsibility or duty of care for\n\n\n-----\n\n-----\n\n###### ‘Plead malware distributed via MitM attacks at router level, misusing ASUS WebStorage’, ESET: Anton Cherepanov,\n\n**[https://www.welivesecurity.com/2019/05/14/plead-malware-mitm-asus-webstorage/](https://www.welivesecurity.com/2019/05/14/plead-malware-mitm-asus-webstorage/)** (14th May 2019)\n\n\n###### ‘Malware Used by BlackTech after Network Intrusion’, JPCERT: Shusei Tomonaga, https://blogs.jpcert.or.jp/en/2019/09/tscookie-loader.html (18th September 2019)\n\n ‘Downloader IconDown used by the attack group BlackTech, JPCERT: Shintaro Tanaka,\n\n**[https://blogs.jpcert.or.jp/ja/2019/10/IconDown.html (23rd October 2019)](https://blogs.jpcert.or.jp/ja/2019/10/IconDown.html)**\n\n###### ‘Waterbear Returns, Uses API Hooking to Evade Security’, Trendmicro: Vickie Su, Anita Hsieh, Dove Chiu,\n\n**[https://www.trendmicro.com/en_gb/research/19/l/waterbear-is-back-uses-api-hooking-to-evade-security-product-detection.html](https://www.trendmicro.com/en_gb/research/19/l/waterbear-is-back-uses-api-hooking-to-evade-security-product-detection.html)** (11th December 2019)\n\n###### ‘Evil hidden in shellcode: The evolution of DBGPrint’, Team T5: CiYi \"YCY\" Yu, Aragorn Tseng,\n\n**[https://jsac.jpcert.or.jp/archive/2020/pdf/JSAC2020_2_ycy-aragorn_en.pdf (January 2020)](https://jsac.jpcert.or.jp/archive/2020/pdf/JSAC2020_2_ycy-aragorn_en.pdf)**\n\n###### ‘ELF_TSCookie - Linux Malware Used by BlackTech’, JPCERT: Shusei Tomonaga, https://blogs.jpcert.or.jp/en/2020/03/elf-tscookie.html (5th March 2020)\n\n ‘調查局首度揭露國內政府委外廠商成資安破口的現況，近期至少10個公家單位與4家資訊服務供應商遇害’, ITHome: Luo Zhenghan, https://www.ithome.com.tw/news/139504 (19th August 2020)\n\n\n-----\n\n###### ‘Taiwan urges blocking 11 China-linked phishing domains’, Taiwan News: Sophia Yang, https://www.taiwannews.com.tw/en/news/3991160 (20th August 2020)\n\n\n###### ‘Palmerworm: Espionage Gang Targets the Media, Finance, and Other Sectors’, Symantec,\n\n**[https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/palmerworm-blacktech-espionage-apt](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/palmerworm-blacktech-espionage-apt)** (29th September 2020)\n\n###### ‘Taiwan Government Targeted by Multiple Cyberattacks in April 2020’, Cycraft Technology Corp,\n\n**[https://medium.com/cycraft/taiwan-government-targeted-by-multiple-cyberattacks-in-april-2020-1980acde92b0 (8th October 2020)](https://medium.com/cycraft/taiwan-government-targeted-by-multiple-cyberattacks-in-april-2020-1980acde92b0)**\n\n###### ‘ELF_PLEAD - Linux Malware Used by BlackTech’, JPCERT: Shusei Tomonaga, https://blogs.jpcert.or.jp/en/2020/11/elf-plead.html (16th November 2020)\n\n ‘BendyBear: Novel Chinese Shellcode Linked With Cyber Espionage Group BlackTech’, PaloAlto Unit42: Mike Harbison,\n\n**[https://unit42.paloaltonetworks.com/bendybear-shellcode-blacktech/ (9th February 2021)](https://unit42.paloaltonetworks.com/bendybear-shellcode-blacktech/)**\n\n###### ‘Exposing the Password Secrets of Internet Explorer’, SecurityXploded, https://securityxploded.com/iepasswordsecrets.php\n\n ‘Adventures in Citrix security research’, Unauthorized Access Blog: Donny Maasland,\n\n[https://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html (7th July 2020)](https://blog.unauthorizedaccess.nl/2020/07/07/adventures-in-citrix-security-research.html)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://vblocalhost.com/uploads/VB2021-50.pdf"
    ],
    "report_names": [
        "VB2021-50.pdf"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c93a7f58-3f75-487c-9bd6-e705b73fc07f",
            "created_at": "2023-01-06T13:46:38.330916Z",
            "updated_at": "2025-03-27T02:00:02.806744Z",
            "deleted_at": null,
            "main_name": "RADIO PANDA",
            "aliases": [
                "Shrouded Crossbow"
            ],
            "source_name": "MISPGALAXY:RADIO PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041454,
    "ts_creation_date": 0,
    "ts_modification_date": 0,
    "files": {
        "pdf": "https://archive.orkl.eu/f7f4af75a1514fd3ede9f55d515306ef022c940a.pdf",
        "text": "https://archive.orkl.eu/f7f4af75a1514fd3ede9f55d515306ef022c940a.txt",
        "img": "https://archive.orkl.eu/f7f4af75a1514fd3ede9f55d515306ef022c940a.jpg"
    }
}