{
    "id": "32025a95-ca37-40f4-838b-8ce404261666",
    "created_at": "2023-01-12T15:08:29.496216Z",
    "updated_at": "2025-03-27T02:17:23.485635Z",
    "deleted_at": null,
    "sha1_hash": "4e92f7b26c75e22b6927a237e449c3627776c19a",
    "title": "2019-09-23 - Hello! My name is Dtrack",
    "authors": "",
    "file_creation_date": "2022-05-29T10:52:46Z",
    "file_modification_date": "2022-05-29T10:52:46Z",
    "file_size": 334377,
    "plain_text": "# Hello! My name is Dtrack\n\n**securelist.com/my-name-is-dtrack/93338/**\n\nAuthors\n\n[Konstantin Zykov](https://securelist.com/author/konstantinzykov/)\n\nOur investigation into the Dtrack RAT actually began with a different activity. In the late\nsummer of 2018, we discovered ATMDtrack, a piece of banking malware targeting Indian\nbanks. Further analysis showed that the malware was designed to be planted on the victim’s\nATMs, where it could read and store the data of cards that were inserted into the machines.\nNaturally, we wanted to know more about that ATM malware, so we used YARA and\nKaspersky Attribution Engine to uncover more interesting material: over 180 new malware\nsamples of a spy tool that we now call Dtrack.\n\nAll the Dtrack samples we initially found were dropped samples, as the real payload was\nencrypted with various droppers — we were able to find them because of the unique\nsequences shared by ATMDtrack and the Dtrack [memory dumps. After that, it got very](https://encyclopedia.kaspersky.com/glossary/dump/?utm_source=securelist&utm_medium=blog&utm_campaign=termin-explanation)\ninteresting, because once we decrypted the final payload and used Kaspersky Attribution\n[Engine again, we saw similarities with the DarkSeoul](https://unit42.paloaltonetworks.com/tdrop2-attacks-suggest-dark-seoul-attackers-return/) [campaign, dating back to 2013 and](https://securelist.com/operation-blockbuster-revealed/73914/)\n\n\n-----\n\nattributed to the Lazarus group. It seems that they reused part of their old code to attack the\nfinancial sector and research centers in India. According to our telemetry, the last activity of\nDTrack was detected in the beginning of September 2019.\n\n## Technical details\n\nThe dropper has its encrypted payload embedded as an overlay of a PE file as extra data\nthat will never be used in normal execution steps. Its decryption routine, part of an\nexecutable physical patch, begins somewhere between the start() and WinMain() functions.\nA fun fact is that the malware authors embedded their malicious code into a binary that was\na harmless executable. In some cases, it was the default Visual Studio MFC project, but it\ncould be any other program.\n\nThe decrypted overlay data contains the following artifacts:\n\nan extra executable;\n[process hollowing shellcode;](https://attack.mitre.org/techniques/T1093/)\na list of predefined executable names, which the malware uses as a future process\nname.\n\nAfter decryption of the data, the process hollowing code is started, taking the name of the\nprocess to be hollowed as an argument. The name comes from the predefined list found\nwithin the decrypted overlay. All the names come from the %SYSTEM32% folder, as you can\nsee in the decrypted file list below.\n\nfontview.exe\ndwwin.exe\nwextract.exe\nrunonce.exe\ngrpconv.exe\nmsiexec.exe\nrasautou.exe\nrasphone.exe\nextrac32.exe\nmobsync.exe\nverclsid.exe\nctfmon.exe\ncharmap.exe\nwrite.exe\nsethc.exe\ncontrol.exe\npresentationhost.exe\nnapstat.exe\nsystray.exe\n\n\n-----\n\nmstsc.exe\ncleanmgr.exe\n\nWhat is inside the dropper?\n\nAfter execution, the target of the process hollowing is suspended until its memory is\noverwritten with the decrypted executable payload from the dropper overlay. After this, the\ntarget process resumes.\n\nThe droppers contain a variety of executables, all of these intended for spying on the victim.\nBelow is an incomplete functionality list for the various Dtrack payload executables found:\n\nkeylogging,\nretrieving browser history,\ngathering host IP addresses, information about available networks and active\nconnections,\nlisting all running processes,\nlisting all files on all available disk volumes.\n\nAt this point, the design philosophy of the framework becomes a bit unclear. Some of the\nexecutables pack the collected data into a password protected archive and save it to the\ndisk, while others send the data to the C&C server directly.\n\nAside from the aforementioned executables, the droppers also contained a remote access\nTrojan (RAT). The RAT executable allows criminals to perform various operations on a host,\nsuch as uploading/downloading, executing files, etc. For a full list of operations, see the table\nbelow.\n\n**command id** **description**\n\n1003 upload a file to the victim’s computer\n\n1005 make target file persistent with auto execution on the victim’s host start\n\n1006 download a file from the victim’s computer\n\n1007 dump all disk volume data and upload it to a host controlled by criminals\n\n1008 dump a chosen disk volume and upload it to a host controlled by criminals\n\n1011 dump a chosen folder and upload it to a host controlled by criminals\n\n1018 set a new interval timeout value between new command checks\n\n1023 exit and remove the persistence and the binary itself\n\ndefault execute a process on the victim’s host\n\n\n-----\n\n## Dtrack and ATMDTrack malware similarities\n\nATMDTrack is a subset of the DTrack family. They naturally look different despite their\nsimilarities. For example, Dtrack’s payload is encrypted within a dropper—unlike the\nATMDTrack samples, which were not encrypted at all. But after decrypting the Dtrack\npayload, it becomes clear that the developers are the same group of people: both projects\nhave the same style and use the same implemented functions. The most obvious function\nthey have in common is the string manipulation function. It checks if there is a CCS_\nsubstring at the beginning of the parameter string, cuts it out and returns a modified one.\nOtherwise, it uses the first byte as an XOR argument and returns a decrypted string.\n\nFunctions common to the two families (the functions/arguments were named by the researchers)\n\n## Conclusions\n\nWhen we first discovered ATMDtrack, we thought we were just looking at another ATM\nmalware family, because we see new ATM malware families appearing on a regular base.\nHowever, this case proved once again that it is important to write proper YARA rules and\nhave a solid working attribution engine, because this way you can uncover connections with\n\n\n-----\n\nmalware families that have appeared in the past. One of the most memorable examples of\nthis was the [WannaCry attribution case. Now we can add another family to the Lazarus](https://securelist.com/wannacry-and-lazarus-group-the-missing-link/78431/)\ngroup’s arsenal: ATMDtrack and Dtrack.\n\nThe vast amount of Dtrack samples that we were able to find shows that the Lazarus group\nis one of the most active APT groups in terms of malware development. They continue to\ndevelop malware at a fast pace and expand their operations. We first saw early samples of\nthis malware family in 2013, when it hit Seoul. Now, six years later, we see them in India,\nattacking financial institutions and research centers. And once again, we see that this group\nuses similar tools to perform both financially-motivated and pure espionage attacks.\n\nTo succeed in spying, the criminals should be able to gain at least partial control over the\ninternal network. This means that the target organizations may have a number of security\nissues, such as:\n\nweak network security policies,\nweak password policies,\nlack of traffic monitoring.\n\nWe therefore advise the companies to:\n\ntighten their network and password policies,\nuse traffic monitoring software, such as Kaspersky Anti Targeted Attack Platform\n(KATA),\nuse antivirus solutions.\n\n## IoCs\n\n8f360227e7ee415ff509c2e443370e56\n3a3bad366916aa3198fd1f76f3c29f24\nF84de0a584ae7e02fb0ffe679f96db8d\n\n[ATM](https://securelist.com/tag/atm/)\n[Dropper](https://securelist.com/tag/dropper/)\n[Financial malware](https://securelist.com/tag/financial-malware/)\n[Lazarus](https://securelist.com/tag/lazarus/)\n[Malware Descriptions](https://securelist.com/tag/malware-descriptions/)\n[RAT Trojan](https://securelist.com/tag/rat-trojan/)\n\nAuthors\n\n\n-----\n\n[Konstantin Zykov](https://securelist.com/author/konstantinzykov/)\n\nHello! My name is Dtrack\n\nYour email address will not be published. Required fields are marked *\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-23 - Hello! My name is Dtrack.pdf"
    ],
    "report_names": [
        "2019-09-23 - Hello! My name is Dtrack.pdf"
    ],
    "threat_actors": [
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "68cc6e37-f16d-4995-a75b-5e8e2a6cbb3d",
            "created_at": "2024-05-01T02:03:07.943593Z",
            "updated_at": "2025-03-27T02:05:17.259709Z",
            "deleted_at": null,
            "main_name": "BRONZE EDISON",
            "aliases": [
                "DarkSeoul",
                "Maverick Panda ",
                "Sykipot ",
                "TG-0623 ",
                "getkys",
                "APT4 "
            ],
            "source_name": "Secureworks:BRONZE EDISON",
            "tools": [
                " Wkysol",
                " ZxPortMap",
                "Gh0st RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536109,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1653821566,
    "ts_modification_date": 1653821566,
    "files": {
        "pdf": "https://archive.orkl.eu/4e92f7b26c75e22b6927a237e449c3627776c19a.pdf",
        "text": "https://archive.orkl.eu/4e92f7b26c75e22b6927a237e449c3627776c19a.txt",
        "img": "https://archive.orkl.eu/4e92f7b26c75e22b6927a237e449c3627776c19a.jpg"
    }
}