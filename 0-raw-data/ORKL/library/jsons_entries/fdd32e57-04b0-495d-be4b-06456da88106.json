{
    "id": "fdd32e57-04b0-495d-be4b-06456da88106",
    "created_at": "2023-12-01T02:05:49.218972Z",
    "updated_at": "2025-03-27T02:17:02.727917Z",
    "deleted_at": null,
    "sha1_hash": "5ce4bd83cb908381c1a7238dc1d7de421c9848fc",
    "title": "",
    "authors": "",
    "file_creation_date": "2023-11-21T20:25:25Z",
    "file_modification_date": "2023-11-21T20:25:25Z",
    "file_size": 721420,
    "plain_text": "# Threat Spotlight Report Scattered Spider Attack Analysis\n\n## Key Points\n\n       - ReliaQuest recently observed an abuse of access to a customer’s internal IT documentation, and a lateral\nmove from the customer’s identity-as-a-service (IDaaS) provider to their on-premises assets in less than one\nhour. We determined, with high confidence, that the highly capable “Scattered Spider” cybercrime group\nperpetrated the attack.\n\n\nIn early September, an automated retroactive indicator of compromise (IoC) threat hunt identified an indicator of\ncompromise (IoC) in the environment of one of our customers. The detected IP address, 144.76.136[.]153, was\npreviously used by the cybercrime group Scattered Spider to perform exfiltration via the domain transfer.sh.\nFollowing a thorough investigation, we uncovered additional evidence of intrusion, involving tools previously\nassociated with Scattered Spider, but also techniques, tactics, and procedures (TTPs) that were new to the group.\nBased on this evidence, our team concluded with high confidence that Scattered Spider was responsible for the\nattack, which spanned multiple days across cloud and on-premises environments. This report presents our findings\nfrom the investigation.\n\n## Scattered Spider Overview\n\nScattered Spider recently emerged as a significant cybercrime group focused on compromising large enterprises.\nThis report highlights the scale and operations of the group, which have spanned various sectors and regions. The\ngroup has also demonstrated the ability to abuse resources in compromised environments, discovering additional\nattack vectors to infiltrate deeper.\n\nScattered Spider’s TTPs are highly significant to the wider threat landscape and ReliaQuest customers, as attacks\nare being aided by gaps in identification and insufficient help-desk user verification policies. Scattered Spider pivots\nand targets applications with remarkable precision, using access to internal IT documentation for extremely efficient\nlateral movement. As other threat actors become more sophisticated and learn from successful patterns, they will be\nable to exploit similar TTPs. Considering the high threat posed by Scattered Spider and similarly sophisticated/skilled\ngroups—and the potential severe consequences—organizations should take appropriate measures to protect\nthemselves, including those recommended later in this report.\n\n\n## Key Points\n\n     - ReliaQuest recently observed an abuse of access to a customer’s internal IT documentation, and a lateral\nmove from the customer’s identity-as-a-service (IDaaS) provider to their on-premises assets in less than one\nhour. We determined, with high confidence, that the highly capable “Scattered Spider” cybercrime group\nperpetrated the attack.\n\n     - Scattered Spider, an “ALPHV”/“BlackCat” ransomware affiliate, infiltrates cloud and on-premises environments\nvia social engineering. The recent compromise revealed remarkable sophistication when infiltrating cloud\nservices and speed in pivoting to the on-premises environment: evidence that the group is extremely\nknowledgeable about how to abuse common enterprise applications.\n\n     - Scattered Spider and similar malicious actors will continue to pose a high threat to entities in various sectors\nand regions. Mitigation recommendations include MFA fatigue rules, help-desk challenge-response policies,\nand privileged identity management.\n\n\n-----\n\n## Attack Path\n\nThe intrusion began in the customer’s cloud environment, where the group gained access to an IT administrator’s\naccount, via Okta single sign-on (SSO). During the investigation, the initial access vector was unclear, but weeks\nlater, the customer reported that the intrusion was attributed to a social-engineering attack, in which the user’s\ncredentials were reset by the attackers. This tactic of social engineering strongly aligns with Scattered Spider’s\nprevious TTPs, which are used to elicit valid account credentials from a target. We are highly confident that the\ngroup attained the IT administrator’s credentials that way.\n\n\n-----\n\nWith valid account credentials acquired, the group conducted an MFA fatigue attack, attempting four MFA challenges\nwithin two minutes. The last challenge resulted in successful authentication, with a “new device sign-in” being\nobserved from IP address 99.25.84[.]9 (Florida, US). This IP address was later published as an IoC in an Okta article\nthat highlighted cross-tenant impersonation[1]. In this case, the group used a US-based IP address not connected to\nVPN infrastructure. We believe the threat actor exhibited a strong sense of operational security, used to evade\ntypical rules that raise alerts of risky sign-ons or anomalous location sign-ons. In this event, Okta did not flag the\nsign-on as a suspected threat, even though the Okta enriched security data would denote numerous indicators as\nanomalous. Once Scattered Spider gained access to the account, the group enrolled a new MFA device.\n\nThe Okta authentication log (with enriched information) details are as follows.\n```\n    \"threatSuspected\":\"false\",\"url\":\"/idp/idx/identify?\",\"logOnlySecurityDa\n    ta\":\"{\\\"risk\\\":{\\\"reasons\\\":\\\"AnomalousLocation,AnomalousDevice\\\",\\\"lev\n    el\\\":\\\"HIGH\\\"},\\\"behaviors\\\":{\\\"NewGeo    Location\\\":\\\"POSITIVE\\\",\\\"NewDevice\\\":\\\"POSITIVE\\\",\\\"NewIP\\\":\\\"POSITIVE\n    \\\",\\\"NewState\\\":\\\"POSITIVE\\\",\\\"NewCountry\\\":\\\"NEGATIVE\\\",\\\"Velocity\\\":\\\n    \"POSITIVE\\\",\\\"NewCity\\\":\\\"POSITIVE\\\"}}\"}},\"legacyEventType\":null,\"trans\n    action\":{\"type\":\"WEB\",\"id\":<Redacted>\"detail\":{}},\"uuid\":<Redacted>\"\",\"\n    version\":\"0\",\"request\":{\"ipChain\":[{\"ip\":\"99.25.84.9\",\"geographicalCont\n    ext\":{\"city\":\"Orlando\",\"state\":\"Florida\",\"country\":\"UnitedStates\",\"post\n    alCode\":\"32804\",\"geolocation\":{\"lat\":28.5759,\"lon\":81.3957}},\"version\":\n    \"V4\",\"source\":null}]},\"target\":[{\"id\":\"\":<Redacted>\"\",\"type\":\"AppInstan\n    ce\",\"alternateId\":\"OktaDashboard\",\"displayName\":\"OktaDashboard\",\"detail\n    Entry\":{\"signOnModeType\":\"OPENID_CONNECT\",\"signOnModeEvaluationResult\":\n    \"AUTHENTICATED\"}},{\"id\":\"\":<Redacted>\"\",\"type\":\"Rule\",\"alternateId\":\"un\n    known\",\"displayName\":\"SignInRule\",\"detailEntry\":null},{\"id\":\"\":<Redacte\n    d>\"\",\"type\":\"Rule\",\"alternateId\":\"unknown\",\"displayName\":\"OktaDashboard\n    Rule\",\"detailEntry\":null}]}\n\n### File Discovery and Lateral Movement\n\n```\nThe group used the Okta SSO Dashboard to access Microsoft 365 and Microsoft Azure AD. As the IT administrator’s\naccount accessed Microsoft 365 resources, several file-access events indicated file and directory discovery in the\norganization’s SharePoint platform. These resources gave the attackers enough information to pivot deeper into the\nenvironment, via documents on:\n\n- Accessing VDIs\n\n- Implementing privileged IAM\n\n- Virtualization servers (including asset inventory spreadsheets)\n\n- Network architecture diagrams\n\n- Password management solutions\n\n- Cybersecurity planning and budgeting\n\n1 hxxps://sec.okta[.]com/articles/2023/08/cross-tenant-impersonation-prevention-and-detection\n\n\n-----\n\nSharePoint file and directory discovery details are as follows.\n```\n    \"Operation\": \"FileAccessed\",\"OrganizationId\":\n    \"\":<Redacted>,\"\",\"RecordType\": 6,\"UserKey\":\n    \"i:0h.f|membership|\":\"<Redacted>\",\"\",\"UserType\": 0, \"Version\": 1,\n    \"Workload\": \"SharePoint\",\"ClientIP\": \"99.25.84.9\",\"ObjectId\":\n    \"https://CUSTOMER.sharepoint.com/sites/GenericITDocuments/Shared\n    Documents/Documents/Documents on accessing VDIs.docx\",\"UserId\":\n    \"<Redacted>\",\"AuthenticationType\": \"FormsCookieAuth\",\n\n### Citrix VDI Abuse\n\n```\nFrom here, Scattered Spider authenticated to Citrix Workspace via the IT administrator’s Okta SSO credentials. They\nwere prompted to complete MFA, but the prompt was sent to the newly registered device under the group’s control.\nAfter accessing Citrix Workspace, there is evidence that the group conducted additional actions on objective in the\non-premises environment.\n\nThe Citrix session disconnect event details are as follows.\n\n```\n<13>Jan 1 00:00:00\nGenericCitrixAPPServer.customer.com\nAgentDevice=WindowsLog AgentLogFile=Security\nPluginVersion=<Redacted> Source=Microsoft-WindowsSecurity-Auditing Computer=\nGenericCitrixAPPServer.customer.com\nOriginatingComputer=<Redacted> User= Domain=\nEventID=4779 EventIDCode=4779 EventType=8\nEventCategory=12551 RecordNumber= <Redacted>\nTimeGenerated= <Redacted> TimeWritten= <Redacted>\nLevel=Log Always Keywords=Audit Success\nTask=SE_ADT_LOGON_OTHERS Opcode=Info Message=A\nsession was disconnected from a Window Station.\nSubject: Account Name: <Redacted> Account Domain:\ncustomer Logon ID: <Redacted> Session: Session\nName: ICA-CGP#100 Additional Information: Client\nName: HTML-1234-56789 Client Address: 0.0.0.0 This\nevent is generated when a user disconnects from an\nexisting Terminal Services session, or when a user\nswitches away from an existing desktop using Fast\nUser Switching.\n\n```\n\n**Time to Lateral Movement**\n\nThe surprisingly swift transition\nfrom the cloud environment to the\non-premises environment is a\nunique attack path, indicating the\ngroup members’ advanced\nknowledge of both environments.\nAs threat intelligence on\nScattered Spider shows, this indepth understanding stems from\na combination of pre-existing\nknowledge and additional\ninformation gleaned from files\nand documents during the\nintrusion. The time it took the\ngroup to pivot from the\ncustomer’s cloud environment to\ntheir on-premises environment\nwas less than one hour.\n\n\nScattered Spider hijacked active Citrix VDI sessions on the host GenericCitrixAPPServer.CUSTOMER.com to\nperform Active Directory (AD) discovery. In these sessions, the group downloaded AD Explorer from the Sysinternals\nwebsite and executed it. Despite our lack of visibility into these VDI hosts, we correlated the download and execution\nof AD Explorer to session disconnect events on the host GenericCitrixAPPServer.CUSTOMER.com: These events\ncited ICA-CGP#XXX as the session, which is the protocol used by Citrix desktop and application sessions.\nFurthermore, it cited the client name HTML-1234-56789, which corresponds to the attackers accessing Citrix\nWorkspace via a browser. This also means active Citrix VDI sessions were hijacked.\n\n\n-----\n\nPalo Alto log download event details for ADExplorer.exe are as follows:\n```\n    <13>Jan 1 00:00: GenerticPAFirewall.customer.com LEEF:1.0|Palo Alto\n    Networks|PAN-OS Syslog Integration| <Redacted> |Windows Executable\n    (EXE)(52020)|ReceiveTime= <Redacted> |SerialNumber= <Redacted>\n    |cat=THREAT|Subtype=file|devTime= <Redacted> T|src=<Redacted>|dst=\n    <Redacted> |srcPostNAT=0.0.0.0|dstPostNAT=0.0.0.0|RuleName=General\n    WebAccess|usrName=customer\\user|SourceUser=\n    customer\\user|DestinationUser=|Application=web-browsing|VirtualSystem=\n    <Redacted> |SourceZone= <Redacted> |DestinationZone= <Redacted>\n    |IngressInterface=ethernet1/24|EgressInterface=ethernet1/23|LogForwardi\n    ngProfile= <Redacted>\n    G|SessionID=<Redacted>|RepeatCount=1|srcPort=64875|dstPort=443|srcPostN\n    ATPort=0|dstPostNATPort=0|Flags=0x1002000|proto=tcp|action=alert|Miscel\n    laneous=\"ADExplorer.exe\"|ThreatID=Windows Executable\n    (EXE)(52020)|URLCategory=low-risk|sev=2|Severity=low|Direction=server    to-client|sequence= <Redacted> |ActionFlags= <Redacted>\n    |SourceLocation= <Redacted>|DestinationLocation=United\n    States|ContentType=|PCAP_ID=0|FileDigest=|Cloud=|URLIndex=1|RequestMeth\n    od=|Subject=|DeviceGroupHierarchyL1= <Redacted>|DeviceGroupHierarchyL2=\n    <Redacted> |DeviceGroupHierarchyL3= <Redacted>|DeviceGroupHierarchyL4=\n    <Redacted>|vSrcName=|DeviceName= <Redacted>\n    |SrcUUID=|DstUUID=|TunnelID=<Redacted>|MonitorTag=|ParentSessionID=0|Pa\n    rentStartTime= <Redacted>\n    |TunnelType=N/A|ThreatCategory=unknown|ContentVer=AppThreat-8745-8229\n\n```\nWe identified a concerning series of events originating from the Citrix VDI. The compromised user within the VDI\naccessed a file located in the organization's AWS S3 bucket, specifically at: customer.s3.us-east_1.amazonaws.com/lastpass_export%20cleaned.xlsx?X-Amz-Security-Token=[REDACTED]. The file,_\nlastpass_export cleaned.xlsx, was then downloaded onto the VDI host. Soon after, we noticed web traffic directed\ntoward lastpass.com. Upon sandboxing the URLs accessed during this time, we discovered that the threat actor had\nattempted to access the company's LastPass page. Multiple redirects to the same LastPass login page suggested\nunsuccessful authentication attempts.\n\nWe also observed traffic directed to lastpass.com/protected.php, a page that denies login and locks the account after\nit detects compromised credentials. That page allows a user to reset their master password using their associated\nemail address, and we witnessed an eventual successful web request to the page lastpass.com/company/. We are\nmoderately confident that Scattered Spider managed to gain access to the customer's LastPass Vault.\n\n\n-----\n\n_Figure 1: LastPass failed-login page that enables a master password reset_\n\nAdditionally, we observed a range of malicious process execution events on the Citrix VDI, albeit without complete\nvisibility. The following are relevant critical indicators:\n\n- We observed numerous application crashes during the adversary's presence on the host\n\n(C:\\PROGRA~1\\dynatrace\\oneagent\\agent\\lib64\\oneagentdumpproc.exe -> Werfault.exe). This event likely\nreflects attempts to deploy a beacon on the host.\n\n- Later we found highly suspicious process execution events, such as notepad.exe spawning control.exe, and then\n\nnotepad spawning mstsc.exe. This potentially indicates process injection into notepad.exe.\n\n- Between these events, we observed the use of RDP for lateral movement to additional hosts. We saw explicit\n\nlogins using the credentials of two compromised service accounts belonging to Microsoft SQL Data Warehouse\n(MSSSQLDW-Analysis and MSSSQLDW-Reporting). These accounts were revealed as compromised by events\nlater in the intrusion; they were almost certainly the primary accounts that Scattered Spider used to download\nmalicious tools.\n\n\n-----\n\n### Okta and Azure AD Abuse\n\nShortly thereafter, Scattered Spider shifted focus back to Okta and Azure AD. In Okta, we saw an IT infrastructure\narchitect authenticating and passing MFA from the same malicious IP address (99.25.84[.]9). The IT infrastructure\narchitect also served as the organization’s virtualization engineer and had a highly privileged account. After the\nauthentication, we observed this user checking out CyberArk credentials for the VMWareVCenterSharedCreds\nfolder. This event proved more notable later in the intrusion.\n\nAt the same time, we saw a second IT Administrator (“IT administrator 2”) authenticating in Okta from the same\nmalicious IP address and targeting the customer’s Okta and Azure AD administrator settings. It remains unclear how\nthe group had valid credentials to this account, but we again observed MFA fatigue attacks, with at least eight MFA\nattempts sent in bulk. With regard to IT administrator 2, we saw the Okta event system.org.rate_limit.violation for too\nmany challenges in a short timeframe. URL filtering events show evidence of attempts to abuse Okta’s delegated\nauthentication with traffic observed to customer.kerberos.okta.com. Using IT administrator 2’s account, we saw\nfurther evidence of access to Okta’s system administration pages: customer-admin.okta.com and\n_oinmanager.okta.com._\n\nIT administrator 2 was also seen performing the following suspicious discovery events in Azure AD.\n\n- Configuring Azure API access\n\n- Making Azure billing changes\n\n- Updating Azure Portal settings\n\n- Enumerating Azure AD Permission\n\n- Performing Azure AD user, group, onPremSync, PIM role, enumeration queries\n\nThe following day, the IT infrastructure architect was observed configuring Okta with a secondary identity provider\n(IdP). As a result of the configuration change, we saw the Okta events system.idp.lifecycle.activate and\nsystem.idp.lifecycle.update: the exact event that allows cross-tenant Okta impersonation of a privileged user. In\neffect, this would allow the attacker to authenticate via their external IdP to access the customer’s Okta environment.\nSuch a change would give the attacker the ability to impersonate and use any Okta account through the secondary\nIdP. The change would also strengthen the group’s persistence in the environment.\n\nActivation of external IdP details are as follows.\n```\n    \"displayMessage\": \"Activate an Identity Provider\", \"eventType\":\n    \"system.idp.lifecycle.activate\", \"outcome\": {  \"result\": \"SUCCESS\",  \n    \"reason\": null }, \"published\": \"2023-08-19T09:48:43.618Z\", \n    \"securityContext\": {  \"asNumber\": <Redacted>,  \"asOrg\": \"customer\n    company inc.\",  \"isp\": \"customer\",  \"domain\": \".\",  \"isProxy\":\n    false }, \"severity\": \"INFO\", \"debugContext\": {  \"debugData\": {   \n    \"protocol\": \"SAML 2.0\",   \"requestId\":\n    \"<Redacted>\",\"dtHash\":\"<Redacted>\",\"requestUri\":\"/api/v1/idps/0oaaaa12b\n    3cDDD4eF5g6/lifecycle/activate\",\"url\":\"/api/v1/idps/0oaaaa12b3cDDD4eF5g\n    6/lifecycle/activate?\" }\n\n```\nLater that day, Scattered Spider used the newly created IdP to authenticate as another highly privileged user: a\nsecurity architect. We correlated authentication user.authentication.auth_via_IDP using the malicious IdP, by tracing\nback the external IdP ID. In creating that external IdP, the threat group misconfigured how user attributes in the\nexternal IdP are matched to the customer’s Okta tenant, which would later cause authentication errors when linking\ncorresponding users during authentication.\n\n\n-----\n\nAuthentication errors due to mismatching IdP attributes are detailed as follows.\n```\n    \"displayMessage\": \"Authenticate user via IDP\", \"eventType\":\n    \"user.authentication.auth_via_IDP\", \"outcome\": {\"result\":\n    \"FAILURE\",\"reason\": \"Unable to match transformed\n    username\"},\"published\":\"<Redacted>\",\"securityContext\": {\"asNumber\":\n    <Redacted>,\"asOrg\": CUSTOMER company inc.\",\"isp\": \"CUSTOMER\", \"domain\":\n    \".\",\"isProxy\": false},\"severity\": \"WARN\",\"debugContext\": {\"debugData\":\n    {\"authnRequestId\": \" <Redacted>\",\"requestId\": \" <Redacted\",\"dtHash\": \"\n    <Redacted>\",\"requestUri\": \"/idp/idx/introspect\",\"threatSuspected\":\n    \"false\",\"transformedUserName\": \"generic-admin \",\"url\":\n    \"/idp/idx/introspect?\"}},\"legacyEventType\":\n    \"core.user_auth.idp.no_matching_users\",\"transaction\": {\"type\":\n    \"WEB\",\"id\": \" <Redacted>\",\"detail\": {}},\"uuid\": \"\n    <Redacted>\",\"version\": \"0\",\"request\": {\"ipChain\": [{\"ip\": \"\n    <Redacted>\",\"geographicalContext\": {\"city\": \" <Redacted>\",\"state\": \"\n    <Redacted>a\",\"country\": \"United States\",\"postalCode\": \"\n    <Redacted>\",\"geolocation <Redacted> version\": \"V4\",\"source\":\n    null}]},\"target\": [{\"id\":0oaaaa12b3cDDD4eF5g6\",\"type\":\n    \"AppInstance\",\"alternateId\": \" Generic SSO for Desktop\",\"displayName\":\n    \"SAML 2.0 IdP\",\"detailEntry\": null}]}\n\n### On-Premises Compromise\n\n```\nThe attackers pivoted back to the on-premises environment with the previously compromised service accounts for\nAzure SQL Data Warehouse (MSSSQLDW-Analysis and MSSSQLDW-Reporting). Multiple tools were seen\ningressed on different hosts within the environment, including:\n\n- MobaXterm_Portable_v23.2.zip (lateral movement)\n\n- WindowsDefenderATPOffboardingPackage_valid_until_2023-XX-XX.zip (defense evasion)\n\n- sysadminanywhere.exe (privilege escalation)\n\n- gosecretsdump_win_v0.3.1.exe (credential access)\n\n- Forensia.exe (defense evasion)\n\n- BleachBit.exe (defense evasion)\n\nScattered Spider was also observed ingressing the same tool on more than one occasion on different hosts. In each\ninstance, the adversary chose to re-download the tools from legitimate websites and default GitHub repositories,\nwhere they are normally hosted.\n\nTo maintain persistence, the group used RMM and reverse proxy solutions; use of Ngrok was shortly followed by a\nURL request to retrieve Ngrok keys from paste.ee. Sandboxing the webpage, while it was still up, showed Ngrok\nauthentication tokens being hosted.\n\nNgrok authentication tokens from paste.ee/abcd1234/ were:\n```\n ngrok config add-authtoken 12345678910qwerty\n\n```\n\n-----\n\nExfiltration was observed via the IP address 144.76.136[.]153, which was the original IoC picked up by the\nautomated retroactive threat hunt. The exfiltration domain transfer.sh is associated with this IP address. The\nfollowing are persistence tools that Scattered Spider deployed on various hosts in the customer’s environment:\n\n- PDQConnectAgent\n\n- ScreenConnect\n\n- Fleet.io\n\n- rsocx\n\n### CyberArk and vCenter activity\n\nWe also observed Scattered Spider performing discovery of vCenter-based documentation within the customer’s\nSharePoint. This was paired with discovery of CyberArk-based documentation, such as\nCyberArk_Architecture_Diagrams_v2_0.pdf; the attackers were later seen exploiting CyberArk to check out vCenterrelated credentials.\n\nThe group used CyberArk access for lateral movement, which included SSH access to vCenter hosts, such as\nCUSTOMERvCenter100. Even with limited visibility, we saw suspicious commands being pushed to vCenter servers\nthat included reverting hosts to their latest snapshot and deleting all snapshots. Shortly thereafter, the adversary\ndeleted some CyberArk files for vCenter-related credentials, seemingly in an attempt to disrupt access to the hosts\nafter earlier actions.\n```\n    <134> <Redacted> customervCenter100 envoy-access - - - <Redacted> info\n    envoy[<Redacted>] [Originator@1234 sub=Default <Redacted>POST\n    /ui/actionsService/actions/evaluations?actionUids=vsphere.core.vm.takeS\n    napshotAction&actionUids=vsphere.core.vm.manageSnapshotsAction&actionUi\n    ds=vsphere.core.vm.revertToLatestSnapshotAction&actionUids=vsphere.core\n    .vm.consolidateSnapshots&actionUids=vsphere.core.vm.deleteAllSnapshots&\n    actionUids=vsphere.core.vm.actions.snapshots&actionUids=vsphere.core.vm\n    .suspendAction&skipActionFilteringStage=true HTTP/2 200 via_upstream     <Redacted>\n\n### Outcome\n\n```\nAlthough our analysis reached its conclusion at this point, further reporting by the customer indicates that the\nattackers successfully accomplished their objectives of data exfiltration and widespread encryption.\n\nIn summary, we observed the following TTPs in connection with Scattered Spider: social engineering of help-desk\nemployees, IDaaS cross-tenant impersonation, file enumeration and discovery, abuse of specific enterprise\napplications, and use of persistence tools. As we concluded our investigation, we determined that several of the\nTTPs observed had a historical connection to Scattered Spider, leading us to attribute the attack to that group with\nhigh confidence.\n\n## Forecast \n\nWe predict, with high confidence, that attacks from Scattered Spider will persist into the long term (beyond one year).\nThe group’s ongoing activity is a testament to the capabilities of a highly skilled threat actor or group having an\nintricate understanding of cloud and on-premises environments, enabling them to navigate with sophistication. We\n\n\n-----\n\nrecently observed another intrusion that seems to be associated with Scattered Spider. The attacker employed the\nsame social-engineering and file-discovery actions as seen in previous Scattered Spider attacks. Although they were\nunable to access critical resources, it is evident that as long as Scattered Spider’s preferred initial access vectors\nremain unmitigated, attacks will continue.\n\nGiven the consistent threat posed by Scattered Spider and similar malicious actors, organizations should prioritize\nconstant vigilance. By strengthening security protocols, conducting regular assessments, and staying informed about\nemerging threats, organizations can effectively combat the risk posed by Scattered Spider (more details below),\nmitigating the impact of any attacks and protecting their invaluable assets.\n\n## Recommendations and Best Practices\n\n### Logging and Visibility\n\nConsidering the potential for compromises to move laterally from the cloud and affect on-premises environments,\nsecurity teams should centralize logs in a unified location. This enables the deployment of correlation-based\ndetections and facilitates thorough investigations of relevant events. In these complex intrusions, establishing a\ncomprehensive timeline of events is of utmost importance, to accurately assess and address security incidents.\n\n### Principle of Least Privilege\n\nThe customer intrusion underscored the importance of adhering to the principle of least privilege, particularly given\nthe misuse of Okta super administrator credentials. The super administrator role should be restricted as it grants the\npotential to alter various settings, such as to register an external IdP or deactivate strong authentication\n[requirements. Users assigned to this role should use a form of MFA that demonstrates substantial resistance to MFA](https://www.reliaquest.com/blog/mfa-bypass-techniques/)\n[bypass attacks. ReliaQuest recommends that new sign-ons, or the enrollment of an MFA factor for super](https://www.reliaquest.com/blog/mfa-bypass-techniques/)\nadministrator accounts, be accompanied by a notification.\n\nThis recommendation also applies to internal IT documentation. Many organizations do not adequately limit access\nto internal IT documents or knowledge-base articles, enabling staff to access information related to specific IT\nprocesses or sensitive information on network architecture. Such accessibility could inadvertently provide a threat\nactor with valuable documents, and potentially enable an attacker to glean more information about the environment.\n\n### Help-Desk Policies\n\nHelp-desk users should adhere to rigorous policies concerning the verification of end users' identities, particularly for\nprocedures involving the reset of credentials or MFA factors. With the growing prevalence of social-engineering\ntactics, we highly recommend implementing a challenge-response process or mandating user identity confirmation\nprior to any help-desk action. Additionally, consider using out-of-band communication methods to facilitate these\nchanges (e.g., avoiding password reset requests via email if the user is potentially compromised).\n\nWe also recommend a stringent escalation process for resetting credentials belonging to administrators, considering\nthe elevated privileges associated with these accounts. Implement a comprehensive procedure before any such\ncredential resets are permitted. At a minimum, the security team should be alerted to investigate when changes to an\nadministrator account occur.\n\nCopyright © 2023 ReliaQuest, LLC. All Rights Reserved. ReliaQuest, GreyMatter, Digital Shadows, and all related logos, product and services names, designs, and slogans are\ntrademarks or registered trademarks of ReliaQuest, LLC or its affiliates or licensors. All other product names or slogans mentioned in this document may be trademarks or registered\ntrademarks of their respective owners or companies. The ReliaQuest software, platform, portal and its entire contents, features, and functionality are owned by ReliaQuest, LLC and\nits affiliates. These materials are protected by United States and international copyright, trademark, patent, trade secret, and other intellectual property or proprietary rights laws. All\nother information presented is provided for informational purposes with no representations or warranties provided of any kind and should not be relied upon for any purpose.\nReliaQuest has no obligation to amend, modify, or update the information contained in this document in the event that such information changes or subsequently becomes\ninaccurate. Printed in the USA.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        }
    ],
    "references": [
        "https://www.reliaquest.com/wp-content/uploads/2023/11/231121_EXTERNAL_ScatteredSpiderThreatReport.pdf"
    ],
    "report_names": [
        "231121_EXTERNAL_ScatteredSpiderThreatReport.pdf"
    ],
    "threat_actors": [
        {
            "id": "9ddc7baf-2ea7-4294-af2c-5fce1021e8e8",
            "created_at": "2023-06-23T02:04:34.386651Z",
            "updated_at": "2025-03-27T02:02:10.009484Z",
            "deleted_at": null,
            "main_name": "Muddled Libra",
            "aliases": [
                "0ktapus",
                "Scatter Swine",
                "Scattered Spider"
            ],
            "source_name": "ETDA:Muddled Libra",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7da6012f-680b-48fb-80c4-1b8cf82efb9c",
            "created_at": "2023-11-01T02:01:06.643737Z",
            "updated_at": "2025-03-27T02:00:55.454098Z",
            "deleted_at": null,
            "main_name": "Scattered Spider",
            "aliases": [
                "Scattered Spider",
                "Roasted 0ktapus",
                "Octo Tempest",
                "Storm-0875"
            ],
            "source_name": "MITRE:Scattered Spider",
            "tools": [
                "WarzoneRAT",
                "LaZagne",
                "Mimikatz",
                "ngrok",
                "BlackCat"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c3b908de-3dd1-4e5d-ba24-5af8217371f0",
            "created_at": "2023-10-03T02:00:08.510742Z",
            "updated_at": "2025-03-27T02:00:03.139677Z",
            "deleted_at": null,
            "main_name": "Scattered Spider",
            "aliases": [
                "Scatter Swine",
                "Storm-0971",
                "UNC3944",
                "Scattered Swine",
                "Octo Tempest",
                "0ktapus",
                "DEV-0971",
                "Starfraud",
                "Muddled Libra",
                "Oktapus"
            ],
            "source_name": "MISPGALAXY:Scattered Spider",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e424a2db-0f5a-4ee5-96d2-5ab16f1f3824",
            "created_at": "2024-06-19T02:03:08.062614Z",
            "updated_at": "2025-03-27T02:05:17.373121Z",
            "deleted_at": null,
            "main_name": "GOLD HARVEST",
            "aliases": [
                "Scatter Swine ",
                "Scattered Spider ",
                "UNC3944 ",
                "Roasted 0ktapus "
            ],
            "source_name": "Secureworks:GOLD HARVEST",
            "tools": [
                " ConnectWise Control",
                " LogMeIn",
                "AnyDesk"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "6e23ce43-e1ab-46e3-9f80-76fccf77682b",
            "created_at": "2022-10-25T16:07:23.303713Z",
            "updated_at": "2025-03-27T02:02:09.727245Z",
            "deleted_at": null,
            "main_name": "ALPHV",
            "aliases": [
                "ALPHV",
                "ALPHVM",
                "BlackCat Gang",
                "UNC4466"
            ],
            "source_name": "ETDA:ALPHV",
            "tools": [
                "ALPHV",
                "ALPHVM",
                "BlackCat",
                "GO Simple Tunnel",
                "GOST",
                "Impacket",
                "LaZagne",
                "MEGAsync",
                "Mimikatz",
                "Munchkin",
                "Noberus",
                "PsExec",
                "Remcom",
                "RemoteCommandExecution",
                "WebBrowserPassView"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d093e8d9-b093-47b8-a988-2a5cbf3ccec9",
            "created_at": "2023-10-14T02:03:13.99057Z",
            "updated_at": "2025-03-27T02:02:09.728121Z",
            "deleted_at": null,
            "main_name": "Scattered Spider",
            "aliases": [
                "0ktapus",
                "LUCR-3",
                "Muddled Libra",
                "Octo Tempest",
                "Scatter Swine",
                "Scattered Spider",
                "Star Fraud",
                "Storm-0875",
                "UNC3944"
            ],
            "source_name": "ETDA:Scattered Spider",
            "tools": [
                "ADRecon",
                "AnyDesk",
                "ConnectWise",
                "DCSync",
                "FiveTran",
                "FleetDeck",
                "Govmomi",
                "Hekatomb",
                "Impacket",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "Lumma Stealer",
                "LummaC2",
                "Mimikatz",
                "Ngrok",
                "PingCastle",
                "ProcDump",
                "PsExec",
                "Pulseway",
                "Pure Storage FlashArray",
                "Pure Storage FlashArray PowerShell SDK",
                "RedLine Stealer",
                "Rsocx",
                "RustDesk",
                "ScreenConnect",
                "SharpHound",
                "Socat",
                "Spidey Bot",
                "Splashtop",
                "Stealc",
                "TacticalRMM",
                "Tailscale",
                "TightVNC",
                "VIDAR",
                "Vidar Stealer",
                "WinRAR",
                "WsTunnel",
                "gosecretsdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1701396349,
    "ts_updated_at": 1743041822,
    "ts_creation_date": 1700598325,
    "ts_modification_date": 1700598325,
    "files": {
        "pdf": "https://archive.orkl.eu/5ce4bd83cb908381c1a7238dc1d7de421c9848fc.pdf",
        "text": "https://archive.orkl.eu/5ce4bd83cb908381c1a7238dc1d7de421c9848fc.txt",
        "img": "https://archive.orkl.eu/5ce4bd83cb908381c1a7238dc1d7de421c9848fc.jpg"
    }
}