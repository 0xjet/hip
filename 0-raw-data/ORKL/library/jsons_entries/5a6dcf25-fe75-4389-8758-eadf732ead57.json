{
    "id": "5a6dcf25-fe75-4389-8758-eadf732ead57",
    "created_at": "2023-01-12T15:09:37.667833Z",
    "updated_at": "2025-03-27T02:05:36.056437Z",
    "deleted_at": null,
    "sha1_hash": "85a8e58c75f67ad07c59b9bdcc0cd73c4183ab38",
    "title": "2021-11-03 - Webinject Panel Administration- A Vantage Point into Multiple Threat Actor Campaigns - A Case Study on the Value of Threat Reconnaisance",
    "authors": "",
    "file_creation_date": "2022-05-28T21:49:22Z",
    "file_modification_date": "2022-05-28T21:49:22Z",
    "file_size": 246535,
    "plain_text": "# Webinject Panel Administration: A Vantage Point into Multiple Threat Actor Campaigns\n\n**[team-cymru.com/blog/2021/11/03/webinject-panel-administration-a-vantage-point-into-multiple-threat-actor-campaigns/](https://team-cymru.com/blog/2021/11/03/webinject-panel-administration-a-vantage-point-into-multiple-threat-actor-campaigns/)**\n\nS2 Research Team View all posts by S2 Research Team November 3, 2021\n\n**The contents of this blog were shared with Team Cymru’s community partners in the**\n**first half of 2021 and were subsequently presented by our analysts at** **[RISE Las Vegas](https://team-cymru.com/company/events/)**\n**(September 2021).**\n\n[Much has been written about the role of webinjects in the evolution of banking trojans,](https://www.virusbulletin.com/uploads/pdf/conference/vb2014/VB2014-Boutin.pdf)\nfacilitating the interception and manipulation of victim connections to the customer portals of\na burgeoning list of targets which now includes e-commerce, retail, and telecommunications\nbrands.\n\n_Figure 1 – An overview of the webinject process_\n\nPrevious community research has also the highlighted the emergence of third-party\nwebinject panel “providers” within the underground economy. For example, the moniker\n[Yummba has long been associated with the creation/maintenance of webinject panels](https://www.xylibox.com/2014/05/atsengine.html)\n[favored by many of the most ubiquitous banking trojan families, including IcedID,](https://securityintelligence.com/icedid-operators-using-atsengine-injection-panel-to-hit-e-commerce-sites/) [QakBot](https://www.virusbulletin.com/virusbulletin/2017/06/vb2016-paper-diving-pinkslipbots-latest-campaign/)\n[and ZLoader.](https://www.lac.co.jp/lacwatch/people/20201106_002321.html)\n\n\n-----\n\nIn this blog we will explain how we were able to track webinject infrastructure used by\nmultiple threat actors over a period of more than six months. Using the concept of ‘Threat\nReconnaissance’ to stay ahead of new campaigns, we were able to identify panels as they\nwere set up and therefore limit their impact on potential victims.\n\n**agentsjs[.]com**\n\nDuring investigations into IcedID (see our previous blog Tracking BokBot (a.k.a. IcedID)\nInfrastructure for further insights) in late 2020, a webinject panel used by the threat actors\nwas identified hosted on agentsjs[.]com. A domain which at the time, based on Passive\nDNS information, resolved to 193.34.166[.]57 (assigned to SNEL, NL).\n\nWhilst examining traffic to 193.34.166[.]57, UDP connections with 95.213.129[.]178\n(assigned to SELECTEL, RU) were identified using symmetrical source/destination ports –\nconsistently UDP/23985.\n\nPivoting to look at traffic associated with 95.213.129[.]178, further connections involving\nUDP/23985 were identified with fifteen other IP addresses within the 193.34.166.0/23\nnetblock. This activity was most recently observed on 9th January 2021.\n\n**95.213.129[.]178 was also observed connecting to the above referenced IP addresses on**\nTCP/22 and TCP/443 – activity likely related to the setup and management of the panels.\n\nPassive DNS information was used to enrich these IP addresses, as summarized in Table 1.\n\n**IP Address** **Domain**\n\n193.34.166[.]17 knockdout[.]com\n\n193.34.166[.]172 batchjs[.]com\n\n193.34.166[.]210 toughjs[.]com\n\n193.34.166[.]241 queryfrm[.]com\n\n193.34.166[.]243 minifyscss[.]com\n\n193.34.166[.]246 authdetect[.]com\n\n193.34.166[.]36 entryquery[.]com\n\n193.34.166[.]87 navsjs[.]com\n\n193.34.167[.]109 wellsoffice[.]net\n\n193.34.167[.]116 acceptjs[.]com\n\n193.34.167[.]198 authfw[.]com\n\n\n-----\n\n193.34.167[.]209 intellix[.]site\n\n193.34.167[.]227 cdnreact[.]com\n\n193.34.167[.]248 huntinqton[.]net\n\n193.34.167[.]94 onedriveregistration[.]com\n\n_Table 1: IP addresses in communication with_\n_95.213.129[.]178_\n\n[Through our botnet analysis efforts, we were able to link several of the domains contained in](https://team-cymru.com/products/threat-intelligence-feeds/bars-feed/)\nTable 1 to webinject panels attributable to specific threat actor groups; Dridex, IcedID and\nQakBot.\n\nOur initial assessment of these findings was that 95.213.129[.]178 was being used as some\nform of management channel for these panels and given the attributions to multiple distinct\ncampaigns, likely associated with a third-party webinject vendor.\n\nHowever, from 10 January 2021 onwards, we did not observe any further communications of\nnote involving this IP address.\n\n**31.131.249[.]98**\n\nWe continued to monitor traffic associated with the 193.34.166.0/23 netblock, looking for\nsimilar UDP connections to known / unknown panels.\n\nCommencing on 18 January 2021, we noticed connections involving 31.131.249[.]98 (also\nassigned to SELECTEL, RU) with a handful of ‘new’ IP addresses. These connections\nsimilarly used symmetrical ports – in this case consistently UDP/23743.\n\nBetween 18 January and 24 May 2021, we identified ten additional panels based on\nconnections with 31.131.249[.]98. Of note was the apparent re-use of 193.34.167[.]248 (see\nTable 1) which had hosted huntinqton[.]net in November 2020 and then reappeared in\nMarch 2021 hosting outresult[.]com.\n\nAs was the case with 95.213.129[.]178, 31.131.249[.]98 was also further observed\nconnecting to the above referenced IP addresses on TCP/22 and TCP/443.\n\nAs previously, passive DNS information was used to enrich these IP addresses (Table 2).\n\n**IP Address** **Domain**\n\n193.34.166[.]159 widgetcdn[.]com\n\n193.34.166[.]223 tagscdn[.]com\n\n\n-----\n\n193.34.166[.]27 typescdn[.]com\n\n193.34.166[.]98 fetchjs[.]com\n\n193.34.167[.]145 bacassets[.]com\n\n193.34.167[.]200 servjs[.]com\n\n193.34.167[.]203 toughjs[.]com\n\n193.34.167[.]24 procjs[.]com\n\n193.34.167[.]248 outresult[.]com\n\n193.34.167[.]52 authframework[.]com\n\n_Table 2: IP addresses in communication with 31.131.249[.]98_\n\nWe were able to link several of the domains contained in Table 2 to webinject panels\nassociated with IcedID and QakBot campaigns.\n\n**Passive DNS**\n\nGiven the apparent concentration of webinject panels hosted within the 193.34.166.0/23\nnetblock, as well as some apparent commonalities in domain naming convention:\n\nfrequent references to ‘cdn’ or ‘js’\nreferences to terms associated with content and website delivery, e.g., ‘auth’, ‘fetch’,\n‘query’, and ‘tags’\nsome targeting of specific financial entities, e.g., ‘huntinqton’ and ‘wellsoffice’\n\nWe decided to review passive DNS data for the entire netblock.\n\nFrom a total of over 1,000 domains, a further 17 were highlighted as likely relevant to this\nanalysis (Table 3).\n\n**IP Address** **Domain**\n\n193.34.166[.]12 backedjs[.]com\n\n193.34.166[.]217 minifycdn[.]com\n\n193.34.166[.]230 querymask[.]com\n\n193.34.166[.]35 elementquery[.]com\n\n193.34.166[.]42 jqrequire[.]com\n\n193.34.166[.]55 jquerylibs[.]com\n\n\n-----\n\n193.34.166[.]8 purejscdn[.]com\n\n193.34.167[.]120 interqu[.]com\n\n193.34.167[.]134 requiredjs[.]com\n\n193.34.167[.]229 projectsjs[.]com\n\n193.34.167[.]237 jqueryslib[.]com\n\n193.34.167[.]25 statecdn[.]com\n\n193.34.167[.]35 requirejscdn[.]com\n\n193.34.167[.]41 jscdn[.]cyou\n\n193.34.167[.]65 widgetcdn[.]com\n\n193.34.167[.]72 sublimejs[.]com\n\n193.34.167[.]89 zefjs[.]com\n\n_Table 3: Webinject panels hosted in 193.34.166.0/23_\n\nAs previously, we were able to link several of the domains contained in Table 3 to webinject\npanels associated with Dridex, IcedID and QakBot campaigns, additionally one of the\ndomains was linked to ZLoader.\n\n**Conclusion**\n\nBy identifying the upstream IP addresses described above and subsequently monitoring\ntraffic, we were able to observe threat actor infrastructure being set up in the days and hours\nbefore it was used to target victims. This allowed us to work with our community partners to\nlimit the impact on potential victims.\n\nThe concept of ‘Threat Reconnaissance’ that we seek to promote using our Pure Signal™\nRecon platform, is the idea of proactively tracking threat actors so that Threat Intelligence\nbecomes more than just a reactionary function.\n\nBy focusing on the webinjects element of the banking trojan attack model, we were able to\napply this idea to multiple threat actor groups within the same reporting strand.\n\nWe hope that this research adds to the collective understanding of webinject panels, in\nparticular how they are managed and distributed within the underground economy. Figure 2\n(below) illustrates our understanding of how the operation described in this blog takes place.\n\n\n-----\n\n**_Note that Figure 2 makes specific reference to 193.34.167[.]248 which, as previously_**\n**_mentioned, was used to host two webinject panels and was observed in connections_**\n**_with both 95.213.129[.]178 and 31.131.249[.]98._**\n\n_Figure 2 – An overview of the identified infrastructure_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-03 - Webinject Panel Administration- A Vantage Point into Multiple Threat Actor Campaigns - A Case Study on the Value of Threat Reconnaisance.pdf"
    ],
    "report_names": [
        "2021-11-03 - Webinject Panel Administration- A Vantage Point into Multiple Threat Actor Campaigns - A Case Study on the Value of Threat Reconnaisance.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536177,
    "ts_updated_at": 1743041136,
    "ts_creation_date": 1653774562,
    "ts_modification_date": 1653774562,
    "files": {
        "pdf": "https://archive.orkl.eu/85a8e58c75f67ad07c59b9bdcc0cd73c4183ab38.pdf",
        "text": "https://archive.orkl.eu/85a8e58c75f67ad07c59b9bdcc0cd73c4183ab38.txt",
        "img": "https://archive.orkl.eu/85a8e58c75f67ad07c59b9bdcc0cd73c4183ab38.jpg"
    }
}