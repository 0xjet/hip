{
    "id": "48302b55-cdfa-4574-8e97-20bf01e25b53",
    "created_at": "2023-01-12T15:06:50.605564Z",
    "updated_at": "2025-03-27T02:05:53.919444Z",
    "deleted_at": null,
    "sha1_hash": "d727d1fcc76907b717d8fc921e41d02001e893ed",
    "title": "2019-09-11 - Ryuk Related Malware Steals Confidential Military, Financial Files",
    "authors": "",
    "file_creation_date": "2022-05-27T01:58:41Z",
    "file_modification_date": "2022-05-27T01:58:41Z",
    "file_size": 1400112,
    "plain_text": "# Ryuk Related Malware Steals Confidential Military, Financial Files\n\n**[bleepingcomputer.com/news/security/ryuk-related-malware-steals-confidential-military-financial-files/](https://www.bleepingcomputer.com/news/security/ryuk-related-malware-steals-confidential-military-financial-files/)**\n\nLawrence Abrams\n\nBy\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nSeptember 11, 2019\n03:44 PM\n1\n\nA new malware with strange associations to the Ryuk Ransomware has been discovered to\nlook for and steal confidential financial, military, and law enforcement files.\n\nWhile Ryuk Ransomware encrypts a victim's files and then demands a ransom, it is not\nknown for actually stealing files from an infected computer. A new infection discovered\ntoday by [MalwareHunterTeam, does exactly that by searching for sensitive files and](https://twitter.com/malwrhunterteam)\nuploading them to a FTP site under the attacker's control.\n\nTo make this sample even more interesting, this data exfiltrating malware also contains\nsome strange references to Ryuk within the code.\n\n## Searching for confidential files\n\n[In conversations with reverse engineer and security researcher Vitali Kremez, we get an](https://twitter.com/VK_Intel/status/1171782155581689858)\nidea of how the file stealer works. When executed, the stealer will perform a recursive\nscan of all the files on a computer and look for Word .docx and Excel .xlsx files to steal.\n\nWhen looking for files, if it encounters any folders or files that match certain strings, it will\nstop checking the file and move to the next one, similar to how ransomware would operate.\n\n\n-----\n\nA full list of the blacklisted files and folders are at the end of this article, including your\nstandard ones such as \"Windows\", \"Intel\", \"Mozilla\", \"Public\", etc.\n\nIn addition, it also skips over any files that are associated with Ryuk such as\n\"RyukReadMe.txt\" and files with the \".RYK\" extension.\n\n**Blacklisted Strings**\nIf the file passes the blacklist, the stealer will then check if it is a .docx or .xlsx file as shown\nbelow.\n\n\n-----\n\n**Searching for .docx and .xlsx files**\nWhen a .docx or .xlsx file is located, the stealer will use libzip and the zip_open and\nzip_trace functions to verify if the file is a valid Word or Excel document. It does this by\nchecking and validating the presence of the word/document.xml (word) or\nxl/worksheets/sheet (excel) files in the Office document.\n\n\n-----\n\n**Verifying Word**\n\n**Document**\nIf it is a valid file, it will then compare the file's name against a list of 77 strings. All of the\nstrings are listed at the end of the document and include entries like \"marketwired\", \"10-Q\",\n\"fraud\", \"hack\", \"tank\", \"defence\", \"military\", \"checking\", \"classified\", \"secret\", \"clandestine\",\nundercover\", \"federal\", etc.\n\n\n-----\n\n**Word of**\n\n**interest**\nAs you can see the actor is looking for confidential military secrets, banking information,\nfraud, criminal investigation documents, and other sensitive information.\n\nStrangely, it also looks for files that contain the first names \"Emma\", \"Liam\", \"Olivia\",\"Noah\",\n[\"William\", \"Isabella\", \"James\", \"Sophia\", and \"Logan\". It is suspected that these names](https://twitter.com/OLRowley/status/1171812072319062016)\ncomes from the [top baby names of 2018 as listed by the U.S. Social Security department.](https://www.ssa.gov/oact/babynames/)\n\nAny files that match a string are then uploaded via FTP to the 66.42.76.46/files_server/a8_5 server as seen in the code below._\n\n\n-----\n\n**Stealing files by uploading to FTP Server**\nAfter scanning the local machine, the malware will then get a list of IP addresses from the\ncomputer's ARP table. It then proceeds to search for files on any available shares.\n\n**Getting ARP Table**\nIt is not known how this malware is being installed, but it was theorized by\nBleepingComputer, Kremez, and MalwareHunterTeam, that this infection could be run prior\nto infecting a machine to harvest interesting files before they are encrypted.\n\n## Strange ties to Ryuk Ransomware\n\n\n-----\n\nAs we already discussed, this stealer purposely skips files associated with the Ryuk\nRansomware such as RyukReadMe.txt, UNIQUE_ID_DO_NOT_REMOVE, and any files\nthat have the .RYK extension.\n\nIn addition, there are code similarities that the stealer and Ryuk Ransomware share in\ncommon. For example, the stealer contains a function that creates a new file and appends\nthe .RYK extension as if it was encrypting the file. This function is not utilized by the stealer.\n\n**Stealer contains Ryuk's create file method**\nThe stealer also checks for the presence of a file named Ahnlab as shown below.\n\n\n-----\n\n**Stealer searching for Ahnlab**\nKremez told BleepingComputer that Ryuk Ransomware also checks for the presence of this\nfile as shown below.\n\n**Ryuk Ransomware searching for Ahnlab**\nWhile there are definite ties between this stealer and Ryuk, it is not known if the actually\nfrom the same group or someone gained access to the code and utilized it in their own\nprogram.\n\n\n-----\n\nIt might indicate someone with source access to Ryuk ransomware simply copy/pasted and\nmodified code to make it a stealer or look like it,\" Kremez told BleepingComputer in a\nconversation about this malware.\n\nFurthermore, Ryuk runs without any dependencies when tested by BleepingComputer in\nthe past, while this stealer appears to be a MingW executable that requires numerous DLLs\nto be present in order to properly execute.\n\nThis could indicate that the stealer is being installed manually or dropped as a package with\nall of the necessary components.\n\nAs more samples become available, we will hopefully see its install process in the future.\n\n**Update 9/11/19: Added info about the names in the match list.**\n\n### Related Articles:\n\n[Industrial Spy data extortion market gets into the ransomware game](https://www.bleepingcomputer.com/news/security/industrial-spy-data-extortion-market-gets-into-the-ransomware-game/)\n\n[Quantum ransomware seen deployed in rapid network attacks](https://www.bleepingcomputer.com/news/security/quantum-ransomware-seen-deployed-in-rapid-network-attacks/)\n\n[New Industrial Spy stolen data market promoted through cracks, adware](https://www.bleepingcomputer.com/news/security/new-industrial-spy-stolen-data-market-promoted-through-cracks-adware/)\n\n[Snap-on discloses data breach claimed by Conti ransomware gang](https://www.bleepingcomputer.com/news/security/snap-on-discloses-data-breach-claimed-by-conti-ransomware-gang/)\n\n[Shutterfly discloses data breach after Conti ransomware attack](https://www.bleepingcomputer.com/news/security/shutterfly-discloses-data-breach-after-conti-ransomware-attack/)\n\n## IOCs\n\n### Hashes:\n```\nc64269a64b64b20108df89c4f1a415936c9d9923f8761d0667aa8492aa057acb\ne6762cb7d09cd90d5469e3c3bfc3b47979cd67aa06c06e893015a87b0348c32c\n\n Network communication:\nFTP: 66.42.76.46/files_server/a8-5 \n\n Blacklisted files and folders:\n\n```\n\n-----\n\n```\nSample\nlog\n.dll\nSample\n$Recycle.Bin\nTor\nPackage\nRyukReadMe.txt\nmicrosoft\nUNIQUE_ID_DO_NOT_REMOVE\nPUBLIC\nWindows\nIntel\nPerfLogs\nwindows\nFirefox\nMozilla\nMicrosoft\n$WINDOWS\nProgram\n\\\\Users\\\\Public\\\\Pictures\nMySQL\n\n### Targeted file name strings:\n\n```\n\n-----\n\n```\nSECURITYN CSR10 SBEDGAR\nmarketwired10-Q10Q8KfraudhackNSAFBI\nCSI\nsecret\nprivate\nconfident\nimportant\npass\nhidden\nundercover\nclandestine\ninvestigation\nfederal\nbureau\ngovernment\nsecurity\nunclassified\nconcealed\nnewswire\nmarketwired\npersonal\nsecurityN-CSR10-SBEDGAR spy radaragentnewswire\nmarketwired                  \n10-Q\nfraud                     \nhack                     \ndefence                    \nattack                    \nmilitary                   \ntank                     \nsecret                    \nbalance                    \nstatement                   \nchecking                   \nsaving                    \nrouting                    \nfinance                    \nagreement                   \nSWIFT                     \nIBAN                     \nlicense                    \nCompilation                  \nreport                    \nsecret                    \nconfident                   \nhidden                    \nclandestine                  \nillegal                    \ncompromate                  \nprivacy                    \nprivate                    \ncontract                   \nconcealed                   \nbackdoorundercover              \nclandestine                  \n\n```\n\n-----\n\n```\ninvestigation                 \nfederal                    \nbureau                    \ngovernment                  \nsecurity                   \nunclassified                 \nseed                     \npersonal                   \nconfident                   \nmail                     \nletter                    \npassport                   \nscans                     \nEmma                     \nLiam                     \nOlivia                    \nNoah                     \nWilliam                    \nIsabella                   \nJames                     \nSophia \nLogan\n\n```\n[Data Exfiltration](https://www.bleepingcomputer.com/tag/data-exfiltration/)\n[Ryuk](https://www.bleepingcomputer.com/tag/ryuk/)\n[Ryuk Stealer](https://www.bleepingcomputer.com/tag/ryuk-stealer/)\n[Steal](https://www.bleepingcomputer.com/tag/steal/)\n\n[Lawrence Abrams](https://www.bleepingcomputer.com/author/lawrence-abrams/)\n\nLawrence Abrams is the owner and Editor in Chief of BleepingComputer.com. Lawrence's\narea of expertise includes Windows, malware removal, and computer forensics. Lawrence\nAbrams is a co-author of the Winternals Defragmentation, Recovery, and Administration\nField Guide and the technical editor for Rootkits for Dummies.\n\n[Previous Article](https://www.bleepingcomputer.com/news/technology/google-chrome-may-let-sites-block-your-screen-from-powering-down/)\n[Next Article](https://www.bleepingcomputer.com/news/microsoft/windows-10-build-18980-released-for-all-insiders-with-new-cortana-app/)\n\n### Comments\n\n\n-----\n\n[tko - 2 years ago](https://www.bleepingcomputer.com/forums/u/1153137/tko/)\n\nThanks for sharing these details and screenshots.\n\nCurious to know, how do you set up a safe lab that you can use to test malware?\n\nPost a Comment [Community Rules](https://www.bleepingcomputer.com/posting-guidelines/)\n\nYou need to login in order to post a comment\n\n[Not a member yet? Register Now](https://www.bleepingcomputer.com/forums/index.php?app=core&module=global&section=register)\n\n### You may also like:\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-09-11 - Ryuk Related Malware Steals Confidential Military, Financial Files.pdf"
    ],
    "report_names": [
        "2019-09-11 - Ryuk Related Malware Steals Confidential Military, Financial Files.pdf"
    ],
    "threat_actors": [
        {
            "id": "6c4f98b3-fe14-42d6-beaa-866395455e52",
            "created_at": "2023-01-06T13:46:39.169554Z",
            "updated_at": "2025-03-27T02:00:03.011739Z",
            "deleted_at": null,
            "main_name": "Evil Corp",
            "aliases": [
                "GOLD DRAKE"
            ],
            "source_name": "MISPGALAXY:Evil Corp",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "50068c14-343c-4491-b568-df41dd59551c",
            "created_at": "2022-10-25T15:50:23.253218Z",
            "updated_at": "2025-03-27T02:00:55.408128Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Indrik Spider",
                "Evil Corp",
                "Manatee Tempest",
                "DEV-0243",
                "UNC2165"
            ],
            "source_name": "MITRE:Indrik Spider",
            "tools": [
                "Mimikatz",
                "PsExec",
                "Dridex",
                "WastedLocker",
                "BitPaymer",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9806f226-935f-48eb-b138-6616c9bb9d69",
            "created_at": "2022-10-25T16:07:23.73153Z",
            "updated_at": "2025-03-27T02:02:09.950784Z",
            "deleted_at": null,
            "main_name": "Indrik Spider",
            "aliases": [
                "Blue Lelantos",
                "DEV-0243",
                "Evil Corp",
                "Gold Drake",
                "Gold Winter",
                "Manatee Tempest",
                "UNC2165"
            ],
            "source_name": "ETDA:Indrik Spider",
            "tools": [
                "Advanced Port Scanner",
                "Agentemis",
                "Babuk",
                "Babuk Locker",
                "Babyk",
                "BitPaymer",
                "Bugat",
                "Bugat v5",
                "Cobalt Strike",
                "CobaltStrike",
                "Cridex",
                "Dridex",
                "EmPyre",
                "EmpireProject",
                "FAKEUPDATES",
                "FakeUpdate",
                "Feodo",
                "FriedEx",
                "Hades",
                "IEncrypt",
                "LINK_MSIEXEC",
                "MEGAsync",
                "Macaw Locker",
                "Metasploit",
                "Mimikatz",
                "PayloadBIN",
                "Phoenix Locker",
                "PowerShell Empire",
                "PowerSploit",
                "PsExec",
                "QNAP-Worm",
                "Raspberry Robin",
                "RaspberryRobin",
                "SocGholish",
                "Vasa Locker",
                "WastedLoader",
                "WastedLocker",
                "cobeacon",
                "wp_encrypt"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536010,
    "ts_updated_at": 1743041153,
    "ts_creation_date": 1653616721,
    "ts_modification_date": 1653616721,
    "files": {
        "pdf": "https://archive.orkl.eu/d727d1fcc76907b717d8fc921e41d02001e893ed.pdf",
        "text": "https://archive.orkl.eu/d727d1fcc76907b717d8fc921e41d02001e893ed.txt",
        "img": "https://archive.orkl.eu/d727d1fcc76907b717d8fc921e41d02001e893ed.jpg"
    }
}