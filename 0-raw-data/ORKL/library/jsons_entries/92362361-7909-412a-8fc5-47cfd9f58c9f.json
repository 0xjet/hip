{
    "id": "92362361-7909-412a-8fc5-47cfd9f58c9f",
    "created_at": "2023-01-12T15:01:01.662346Z",
    "updated_at": "2025-03-27T02:09:55.049971Z",
    "deleted_at": null,
    "sha1_hash": "2fe1627cc43c288294be181fe38368bc70c60f5b",
    "title": "2022-02-07 - Decrypted- TargetCompany Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T23:21:40Z",
    "file_modification_date": "2022-05-28T23:21:40Z",
    "file_size": 1632911,
    "plain_text": "# Decrypted: TargetCompany Ransomware\n\n**[decoded.avast.io/threatresearch/decrypted-targetcompany-ransomware/](https://decoded.avast.io/threatresearch/decrypted-targetcompany-ransomware/)**\n\nby [Threat Research TeamFebruary 7, 20225 min read](https://decoded.avast.io/author/threatresearch/)\n\n\nFebruary 7, 2022\n\n\nOn `January 25, 2022, a victim of a ransomware attack reached out to us for help. The`\nextension of the encrypted files and the ransom note indicated the `TargetCompany`\n```\nransomware (not related to Target the store), which can be decrypted under certain\n\n```\ncircumstances.\n\n### Modus Operandi of the TargetCompany Ransomware\n\nWhen executed, the ransomware does some actions to ease its own malicious work:\n\n1. Assigns the `SeTakeOwnershipPrivilege and` `SeDebugPrivilege for its process`\n2. Deletes special file execution options for tools like `vssadmin.exe,` `wmic.exe,`\n```\n   wbadmin.exe, bcdedit.exe, powershell.exe, diskshadow.exe, net.exe\n\n```\nand `taskkil.exe`\n3. Removes shadow copies on all drives using this command:\n```\n   %windir%\\sysnative\\vssadmin.exe delete shadows /all /quiet\n\n```\n4. Reconfigures boot options:\n```\n   bcdedit /set {current} bootstatuspolicy ignoreallfailures\n   bcdedit /set {current} recoveryenabled no\n\n```\n5. Kills some processes that may hold open valuable files, such as databases:\n\nList of processes killed by the TargetCompany ransomware\n\nMsDtsSrvr.exe ntdbsmgr.exe\n\nReportingServecesService.exe oracle.exe\n\nfdhost.exe sqlserv.exe\n\nfdlauncher.exe sqlservr.exe\n\n\n-----\n\nmsmdsrv.exe sqlwrite\n\nmysql.exe\n\nAfter these preparations, the ransomware gets the mask of all logical drives in the system\nusing the `GetLogicalDrives()` Win32 API. Each drive is checked for the drive type by\n```\nGetDriveType() . If that drive is valid (fixed, removable or network), the encryption of the\n\n```\ndrive proceeds. First, every drive is populated with the ransom note file (named `RECOVERY`\n```\nINFORMATION.txt ). When this task is complete, the actual encryption begins.\n\n### Exceptions\n\n```\nTo keep the infected PC working, `TargetCompany avoids encrypting certain folders and`\nfile types:\n\nList of folders avoided by the\nTargetCompany ransomware\n\n\nmsocache boot Microsoft\nSecurity\nClient\n\n$windows.~ws $windows.~bt Internet\nExplorer\n\n\nMicrosoft MPI\n\nWindows Kits\n\n\nsystem volume information mozilla Reference Microsoft.NET\n\nintel boot Assemblies Windows Mail\n\n\n-----\n\nappdata windows.old Windows\nDefender\n\nperflogs Windows Microsoft\nASP.NET\n\n\nMicrosoft\nSecurity\nClient\n\nPackage\nStore\n\nMicrosoft\nAnalysis\nServices\n\n\nprogramdata\n\ngoogle\n\napplication data\n\n\nWindowsPowerShell Core\nRuntime\n\n\ntor browser Windows NT Package Windows\nPortable\nDevices\n\nWindows Store Windows\nPhoto Viewer\n\n\nCommon Files Microsoft\nHelp\nViewer\n\n\nWindows\nSidebar\n\n\nList of file types avoided by\nthe TargetCompany\nransomware\n\n.386 .cpl .exe .key .msstyles .rtp\n\n.adv .cur .hlp .lnk .msu .scr\n\n.ani .deskthemepack .hta .lock .nls .shs\n\n.bat .diagcfg .icl .mod .nomedia .spl\n\n.cab .diagpkg .icns .mpa .ocx .sys\n\n.cmd .diangcab .ico .msc .prf .theme\n\n.com .dll .ics .msi .ps1 .themepack\n\n.drv .idx .msp .rom .wpx\n\nThe ransomware generates an encryption key for each file (0x28 bytes). This key splits into\n```\nChacha20 encryption key ( 0x20 bytes ) and n-once ( 0x08 ) bytes. After the file is\n\n```\n[encrypted, the key is protected by a combination of Curve25519 elliptic curve +](https://github.com/agl/curve25519-donna/blob/master/curve25519-donna.c) `AES-128`\nand appended to the end of the file. The scheme below illustrates the file encryption. Redmarked parts show the values that are saved into the file tail after the file data is encrypted:\n\n\n-----\n\nThe exact structure of the file tail, appended to the end of each encrypted file, is shown as a\nC-style structure:\n\nEvery folder with an encrypted file contains the ransom note file. A copy of the ransom note\nis also saved into `c:\\HOW TO RECOVER !!.TXT`\n\n\n-----\n\nThe personal ID, mentioned in the file, is the first six bytes of the personal_id, stored in\neach encrypted file.\n\n## How to use the Avast decryptor to recover files\n\nTo decrypt your files, please, follow these steps:\n\n1. Download the free Avast decryptor. Choose a build that corresponds with your\n\nWindows installation. The 64-bit version is significantly faster and most of today’s\nWindows installations are 64-bit.\n\n[If you have 64-bit Windows, choose the 64-bit build.](https://files.avast.com/files/decryptor/avast_decryptor_targetcompany64.exe)\n[If you have 32-bit Windows, choose the 32-bit build.](https://files.avast.com/files/decryptor/avast_decryptor_targetcompany.exe)\n2. Simply run the executable file. It starts in the form of a wizard, which leads you\n\nthrough the configuration of the decryption process.\n3. On the initial page, you can read the license information, if you want, but you really\n\nonly need to click “Next”\n\n\n-----\n\n1. On the next page, select the list of locations which you want to be searched and\n\ndecrypted. By default, it contains a list of all local drives:\n\n\n-----\n\n1. On the third page, you need to enter the name of a file encrypted by the\n\nTargetCompany ransomware. In case you have an encryption password created by a\nprevious run of the decryptor, you can select the “I know the password for decrypting\nfiles” option:\n\n\n-----\n\n1. The next page is where the password cracking process takes place. Click “Start”\n\nwhen you are ready to start the process. During password cracking, all your available\nprocessor cores will spend most of their computing power to find the decryption\npassword. The cracking process may take a large amount of time, up to tens of hours.\nThe decryptor periodically saves the progress and if you interrupt it and restart the\ndecryptor later, it offers you an option to resume the previously started cracking\nprocess. Password cracking is only needed once per PC – no need to do it again for\neach file.\n\n\n-----\n\n1. When the password is found, you can proceed to the decryption of files on your PC by\n\nclicking “ Next ”.\n\n\n-----\n\n1. On the final wizard page, you can opt-in whether you want to backup encrypted files.\n\nThese backups may help if anything goes wrong during the decryption process. This\noption is turned on by default, which we recommend. After clicking “ Decrypt ”, the\ndecryption process begins. Let the decryptor work and wait until it finishes.\n\n\n-----\n\n### IOCs\n\nSHA256 File\nExtension\n\n`98a0fe90ef04c3a7503f2b700415a50e62395853bd1bab9e75fbe75999c0769e` .mallox\n\n`3f843cbffeba010445dae2b171caaa99c6b56360de5407da71210d007fe26673` .exploit\n\n`af723e236d982ceb9ca63521b80d3bee487319655c30285a078e8b529431c46e` .architek\n\n`e351d4a21e6f455c6fca41ed4c410c045b136fa47d40d4f2669416ee2574124b` .brg\n\n[Tagged asanalysis,](https://decoded.avast.io/tag/analysis/) [decryptors,](https://decoded.avast.io/tag/decryptors/) [malware,](https://decoded.avast.io/tag/malware/) [ransomware,](https://decoded.avast.io/tag/ransomware/) [reversing](https://decoded.avast.io/tag/reversing/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-07 - Decrypted- TargetCompany Ransomware.pdf"
    ],
    "report_names": [
        "2022-02-07 - Decrypted- TargetCompany Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f5bf6853-3f6e-452c-a7b7-8f81c9a27476",
            "created_at": "2023-01-06T13:46:38.677391Z",
            "updated_at": "2025-03-27T02:00:02.889755Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "MISPGALAXY:Careto",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535661,
    "ts_updated_at": 1743041395,
    "ts_creation_date": 1653780100,
    "ts_modification_date": 1653780100,
    "files": {
        "pdf": "https://archive.orkl.eu/2fe1627cc43c288294be181fe38368bc70c60f5b.pdf",
        "text": "https://archive.orkl.eu/2fe1627cc43c288294be181fe38368bc70c60f5b.txt",
        "img": "https://archive.orkl.eu/2fe1627cc43c288294be181fe38368bc70c60f5b.jpg"
    }
}