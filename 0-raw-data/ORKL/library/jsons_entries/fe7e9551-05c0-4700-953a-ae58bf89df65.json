{
    "id": "fe7e9551-05c0-4700-953a-ae58bf89df65",
    "created_at": "2023-05-06T02:08:40.057266Z",
    "updated_at": "2025-03-27T02:16:11.540843Z",
    "deleted_at": null,
    "sha1_hash": "f2bcbf10cbc41c6b56f582329b416274c75eb6cf",
    "title": "2023-04-18 - Nation-state threat actor PHOSPHORUS refines tradecraft to attack high-value targets",
    "authors": "",
    "file_creation_date": "2023-05-05T02:01:03Z",
    "file_modification_date": "2023-05-05T02:01:03Z",
    "file_size": 386895,
    "plain_text": "# Nation-state threat actor Mint Sandstorm refines tradecraft to attack high- value targets\n\n**[microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/](https://www.microsoft.com/en-us/security/blog/2023/04/18/nation-state-threat-actor-mint-sandstorm-refines-tradecraft-to-attack-high-value-targets/)**\n\nApril 18, 2023\n\nOver the past several months, Microsoft has observed a mature subgroup of Mint Sandstorm, an Iranian nation-state\nactor previously tracked as PHOSPHORUS, refining its tactics, techniques, and procedures (TTPs). Specifically, this\nsubset has rapidly weaponized N-day vulnerabilities in common enterprise applications and conducted highly-targeted\nphishing campaigns to quickly and successfully access environments of interest. This Mint Sandstorm subgroup has also\ncontinued to develop and use custom tooling in selected targets, notably organizations in the energy and transportation\nsectors. Given this subgroup’s capabilities, the profile of past targets, and the potential for cascading effects, Microsoft is\npublishing details on known tradecraft alongside corresponding detections and mitigations to help organizations protect\nagainst this and similar threats.\n\n## Who is Mint Sandstorm?\n\nMint Sandstorm is Microsoft’s new name for PHOSPHORUS, an Iranian nation-state actor. This new name is part of the\n[new threat actor naming taxonomy we announced today, designed to keep pace with the evolving and growing threat](https://aka.ms/threatactorsblog)\nlandscape.\n\n[Mint Sandstorm is known to pursue targets in both the private and public sectors, including political dissidents, activist](https://blogs.microsoft.com/on-the-issues/2019/03/27/new-steps-to-protect-customers-from-hacking/)\nleaders, the Defense Industrial Base (DIB), journalists, and employees from multiple government agencies, including\nindividuals protesting oppressive regimes in the Middle East. Activity Microsoft tracks as part of the larger Mint\nSandstorm group overlaps with public reporting on groups known as APT35, APT42, Charming Kitten, and TA453.\n\nMint Sandstorm is a composite name used to describe several subgroups of activity with ties to the same organizational\n[structure. Microsoft assesses that Mint Sandstorm is associated with an intelligence arm of Iran’s military, the Islamic](https://sgp.fas.org/crs/mideast/R47321.pdf)\nRevolutionary Guard Corps (IRGC), an assessment that has been corroborated by multiple credible sources including\n[Mandiant,](https://www.mandiant.com/resources/blog/apt42-charms-cons-compromises) [Proofpoint, and](https://www.proofpoint.com/us/blog/threat-insight/badblood-ta453-targets-us-and-israeli-medical-research-personnel-credential) [SecureWorks. In 2022, the US Department of Treasury](https://www.secureworks.com/blog/cobalt-illusion-masquerades-as-atlantic-council-employee) [sanctioned elements of Mint](https://home.treasury.gov/news/press-releases/jy0948)\nSandstorm for past cyberattacks citing sponsorship from the IRGC.\n\nToday, Microsoft is reporting on a distinct Mint Sandstorm subgroup that specializes in hacking into and stealing sensitive\ninformation from high-value targets. This Mint Sandstorm subgroup is technically and operationally mature, capable of\ndeveloping bespoke tooling and quickly weaponizing N-day vulnerabilities, and has demonstrated agility in its operational\nfocus, which appears to align with Iran’s national priorities.\n\nMicrosoft Threat Intelligence consistently tracks threat actor activity, including Mint Sandstorm and its subgroups, and\nworks across Microsoft Security products and services to build detections into our products that improve protection for\ncustomers. As with any observed nation state actor activity, Microsoft directly notifies customers that have been targeted\nor compromised, providing them with the information they need to secure their accounts. Microsoft is sharing details on\nthese operations to raise awareness on the risks associated with their activity and to empower organizations to harden\ntheir attack surfaces against tradecraft commonly used by this Mint Sandstorm subgroup.\n\n## Recent operations\n\nFrom late 2021 to mid-2022, this Mint Sandstorm subgroup moved from reconnaissance to direct targeting of US critical\ninfrastructure including seaports, energy companies, transit systems, and a major US utility and gas entity potentially in\nsupport of retaliatory destructive cyberattacks. This targeting was likely in response to Iran’s attribution of cyberattacks\nthat [halted maritime traffic at a major Iranian seaport in May 2020, delayed Iranian trains in July 2021, and crashed gas](https://www.washingtonpost.com/national-security/officials-israel-linked-to-a-disruptive-cyberattack-on-iranian-port-facility/2020/05/18/9d1da866-9942-11ea-89fd-28fb313d1886_story.html.)\nstation payment systems throughout Iran in late 2021. Of note, a senior cybersecurity-focused IRGC official and others\nclose to the Iranian Supreme Leader pinned the attack affecting [gas station payment systems on Israel and the United](https://www.iranintl.com/en/20211028899666)\nStates.\n\n\n-----\n\nThis targeting also coincided with a broader increase in the pace and the scope of cyberattacks attributed to Iranian threat\nactors, including another Mint Sandstorm subgroup, that Microsoft observed beginning in September 2021. The increased\naggression of Iranian threat actors appeared to correlate with other moves by the Iranian regime under a new national\n[security apparatus, suggesting such groups are less bounded in their operations. Given the hardline consensus among](https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE5bUvv?culture=en-us&country=us)\npolicymakers in Tehran and sanctions previously levied on Iran’s security organizations, Mint Sandstorm subgroups may\nbe less constrained in carrying out malicious cyber activity.\n\n## Mint Sandstorm tradecraft\n\nMicrosoft has observed multiple attack chains and various tools in compromises involving this Mint Sandstorm subgroup.\nThe TTPs detailed below are a sampling of new or otherwise notable tradecraft used by this actor.\n\n### Rapid adoption of publicly disclosed POCs for initial access and persistence\n\nMicrosoft has increasingly observed this Mint Sandstorm subgroup adopting publicly disclosed proof-of-concept (POC)\ncode shortly after it is released to exploit vulnerabilities in internet-facing applications. Until 2023, this subgroup had been\nslow to adopt exploits for recently-disclosed vulnerabilities with publicly reported POCs, often taking several weeks to\nsuccessfully weaponize exploits for vulnerabilities like Proxyshell and Log4Shell. However, beginning in early 2023,\nMicrosoft observed a notable decrease in the time required for this subgroup to adopt and incorporate public POCs. For\n[example, Mint Sandstorm began exploiting CVE-2022-47966 in Zoho ManageEngine on January 19, 2023, the same day](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-47966)\n[the POC became public. They later exploited CVE-2022-47986 in Aspera Faspex within five days of the POC being made](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-47986)\npublic on February 2, 2023.\n\nWhile this subgroup has demonstrated their ability to rapidly incorporate new public POCs into their playbooks, Microsoft\nhas also observed that Mint Sandstorm continues to use older vulnerabilities, especially Log4Shell, to compromise\nunpatched devices. As this activity is typically opportunistic and indiscriminate, Microsoft recommends that\n**organizations regularly patch vulnerabilities with publicly available POCs, regardless of how long the POC has**\n**been available.**\n\nAfter gaining initial access to an organization by exploiting a vulnerability with a public POC, this Mint Sandstorm\nsubgroup deploys a custom PowerShell script designed for discovery. In some cases, the subgroup does not act on the\ninformation they collect, possibly because they assess that a victim does not meet any targeting requirements or because\nthe subgroup wishes to wait and focus on more valuable targets. In cases where Mint Sandstorm operators continue their\npursuit of a given target, Microsoft typically observes one of two possible attack chains.\n\n\n-----\n\n_Figure 1. The two attack chains used by the Mint Sandstorm subgroup_\n\n**Attack chain 1: The Mint Sandstorm subgroup proceeds using Impacket to move laterally through a compromised**\norganization and relies extensively on PowerShell scripts (rather than custom implants) to enumerate admin\naccounts and enable RDP connections. In this attack chain, the subgroup uses an SSH tunnel for command and\ncontrol (C2), and the final objective in many cases is theft of the Active Directory database. If obtained, the Mint\nSandstorm subgroup can use the Active Directory database to access credentials for users’ accounts. In cases\nwhere users’ credentials are accessed and the target organization has not reset corresponding passwords, the\nactors can log in with stolen credentials and masquerade as legitimate users, possibly without attracting attention\nfrom defenders. The actors could also gain access to other systems where individuals may have reused their\npasswords.\n**Attack chain 2: As is the case in attack chain 1, the Mint Sandstorm subgroup uses Impacket to move laterally.**\nHowever, in this progression, the operators use webhook.site for C2 and create scheduled tasks for persistence.\nFinally, in this attack chain, the actors deploy a custom malware variant, such as Drokbk or Soldier. These custom\nmalware variants signal an increase in the subgroup’s level of sophistication, as they shift from using publicly\navailable tools and simple scripts to deploying fully custom developed malicious code.\n\n### Use of custom tools to evade detection\n\nSince 2022,Microsoft has observed this Mint Sandstorm subgroup using two custom implants, detected by Microsoft\nsecurity products as Drokbk and Soldier, to persist in target environments and deploy additional tools. Drobkbk and\nSoldier both use Mint Sandstorm-controlled GitHub repositories to host a domain rotator containing the operators’ C2\ndomains. This allows Mint Sandstorm to dynamically update their C2 infrastructure, which may help the operators stay a\nstep ahead of defenders using list-based domain blocking.\n\n**Drokbk: Drokbk.exe is a custom .NET implant with two components: an installer, sometimes accessed from a**\ncompressed archive on a legitimate file-sharing platform, and a secondary backdoor payload. The Drokbk backdoor\nissues a web request to obtain the contents of a README file on a Mint Sandstorm-controlled GitHub repo. The\n_README file contains a list of URLs that direct targets to the C2 infrastructure associated with Drokbk._\n**Soldier: Soldier is a multistage .NET backdoor with the ability to download and run additional tools and uninstall**\nitself. Like Drokbk, Soldier C2 infrastructure is stored on a domain rotator on a GitHub repository operated by Mint\nSandstorm. Microsoft Threat Intelligence analysts assess that Soldier is a more sophisticated variant of Drokbk.\n\n\n-----\n\nIn certain cases, this Mint Sandstorm subgroup has used TTPs outside of these attack chains, notably when they have\nfailed to achieve short-term objectives. In one instance, Microsoft also observed the subgroup using TTPs from both\nattack chains in a single compromised environment. However, in most cases, Mint Sandstorm activity displays one of the\nabove discussed attack chains.\n\n### Low-volume phishing campaigns using template injection\n\nMicrosoft has also observed this Mint Sandstorm subgroup using a distinct attack chain involving low-volume phishing\ncampaigns and a third custom implant.In these operations, the group crafts bespoke phishing emails, often purporting to\ncontain information on security policies that affect countries in the Middle East, to deliver weaponized documents to\nindividuals of interest. Recipients are typically individuals affiliated with high-profile think tanks or universities in Israel,\nNorth America, or Europe with ties to the security and policy communities. Unlike their initial exploitation of vulnerable\ninternet-facing applications, which is largely indiscriminate and affects organizations across sectors and geographies,\nactivity associated with this campaign was highly targeted and affected fewer than 10 organizations..\n\nThe initial emails are most commonly lures designed to social engineer recipients into clicking a OneDrive link hosting a\nPDF spoofed to resemble information on a topic involving security or policy in the Middle East. The PDF contains a link to\na macro-enabled template file (dotm) hosted on Dropbox. This file has been weaponized with macros to perform remote\ntemplate injection, a technique that allows operators to obtain and launch a payload from a remote C2, often OneDrive.\nTemplate injection is an attractive option for adversaries looking to execute malicious code without drawing scrutiny from\ndefenders. This technique can also be used to persist in a compromised environment if an adversary replaces a default\ntemplate used by a common application.\n\nIn these attacks, Microsoft has observed the Mint Sandstorm subgroup using CharmPower, a custom implant, in attacks\nthat began with targeted phishing campaigns.CharmPower is a modular backdoor written in PowerShell that this\n[subgroup delivers in phishing campaigns that rely on template injection. CharmPower can read files, gather information](https://www.pwc.com/gx/en/issues/cybersecurity/cyber-threat-intelligence/old-cat-new-tricks.html)\n[on an infected host, and send details back to the attackers. Reporting from](https://www.pwc.com/gx/en/issues/cybersecurity/cyber-threat-intelligence/old-cat-new-tricks.html) [Checkpoint indicates that at least one version](https://research.checkpoint.com/2022/apt35-exploits-log4j-vulnerability-to-distribute-new-modular-powershell-toolkit/)\nof CharmPower pulls data from a specific text file that contains a hardcoded victim identifier.\n\n_Figure 2. Template injection technique_\n\n## What’s next\n\nCapabilities observed in intrusions attributed to this Mint Sandstorm subgroup are concerning as they allow operators to\nconceal C2 communication, persist in a compromised system, and deploy a range of post-compromise tools with varying\ncapabilities. While effects vary depending on the operators’ post-intrusion activities, even initial access can enable\nunauthorized access and facilitate further behaviors that may adversely impact the confidentiality, integrity, and availability\nof an environment. A successful intrusion creates liabilities and may harm an organization’s reputation, especially those\nresponsible for delivering services to others such as critical infrastructure providers, which Mint Sandstorm has targeted in\nthe past.\n\nAs these operators increasingly develop and use sophisticated capabilities, organizations must develop corresponding\ndefenses to harden their attack surfaces and raise costs for these operators. Microsoft will continue to monitor Mint\nSandstorm activity and implement protections for our customers. The current detections, advanced detections, and IOCs\nin place across our security products are detailed below and shared with the broader security community to help detect\nand prevent further attacks.\n\n## Mitigation and protection guidance\n\n\n-----\n\nThe techniques used by this subset of Mint Sandstorm can be mitigated through the following actions:\n\n### Hardening internet-facing assets and understanding your perimeter\n\nOrganizations must identify and secure perimeter systems that attackers might use to access the network. Public\n[scanning interfaces, such as Microsoft Defender External Attack Surface Management, can be used to improve data.](https://www.microsoft.com/security/business/cloud-security/microsoft-defender-external-attack-surface-management)\n\nVulnerabilities observed in recent campaigns attributed to this Mint Sandstorm subgroup that defenders can identify and\nmitigate include:\n\nIBM Aspera Faspex affected by CVE-2022-47986: Organizations can remediate CVE-2022-47986 by upgrading to\nFaspex 4.4.2 Patch Level 2 or using Faspex 5.x which does not contain this vulnerability. More details are available\nin IBM’s security advisory [here.](https://www.ibm.com/support/pages/node/6952319)\nZoho ManageEngine affected by CVE-2022-47966: Organizations using Zoho ManageEngine products vulnerable\n[to CVE-2022-47966 should download and apply upgrades from the official advisory as soon as possible. Patching](https://www.manageengine.com/security/advisory/CVE/cve-2022-47966.html)\nthis vulnerability is useful beyond this specific campaign as several adversaries are exploiting CVE-2022-47966 for\ninitial access.\n[Apache Log4j2 (aka Log4Shell) (CVE-2021-44228 and](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44228) [CVE-2021-45046): Microsoft’s guidance for organizations](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-45046)\n[using applications vulnerable to Log4Shell exploitation can be found here. This guidance is useful for any](https://msrc-blog.microsoft.com/2021/12/11/microsofts-response-to-cve-2021-44228-apache-log4j2/)\n[organization with vulnerable applications and useful beyond this specific campaign, as several adversaries exploit](https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/)\nLog4Shell to obtain initial access.\n\nThis Mint Sandstorm subgroup has demonstrated its ability to rapidly adopt newly reported N-day vulnerabilities into its\nplaybooks. To further reduce organizational exposure, Microsoft Defender for Endpoint customers can use the threat and\nvulnerability management capability to discover, prioritize, and remediate vulnerabilities and misconfigurations.\n\n### Reducing the attack surface\n\n[Microsoft 365 Defender customers can also turn on attack surface reduction rules to harden their environments against](https://docs.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction?view=o365-worldwide)\ntechniques used by this Mint Sandstorm subgroup. These rules, which can be configured by all Microsoft Defender\nAntivirus customers and not just those using the EDR solution, offer significant protection against the tradecraft discussed\nin this report.\n\n[Block executable files from running unless they meet a prevalence, age, or trusted list criterion](https://learn.microsoft.com/microsoft-365/security/defender-endpoint/attack-surface-reduction-rules-reference?view=o365-worldwide#block-executable-files-from-running-unless-they-meet-a-prevalence-age-or-trusted-list-criterion)\nBlock Office applications from creating executable content\nBlock process creations originating from PSExec and WMI commands\n\n[Additionally, in 2022, Microsoft changed the default behavior of Office applications to block macros in files from the](https://techcommunity.microsoft.com/t5/microsoft-365-blog/helping-users-stay-safe-blocking-internet-macros-by-default-in/ba-p/3071805)\ninternet, further minimizing the attack surface for operators like this subgroup of Mint Sandstorm.\n\n### Microsoft 365 Defender detections\n\n**Microsoft Defender Antivirus**\n\nMicrosoft Defender Antivirus detects the Drokbk implant as the following malware:\n\n[Trojan:MSIL/Drokbk.A!dha](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/Drokbk.A!dha&threatId=-2147147037)\n[Trojan:MSIL/Drokbk.B!dha](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/Drokbk.B!dha&threatId=-2147147036)\n[Trojan:MSIL/Drokbk.C!dha](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/Drokbk.C!dha&threatId=-2147123260)\n[Trojan:Win32/Drokbk.C!dha](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/Drokbk.C!dha&threatId=-2147123261)\n\nMicrosoft Defender Antivirus detects the Soldier implant as the following malware:\n\n[Trojan:MSIL/SoldierAudio.A!dha](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/SoldierAudio.A!dha&threatId=-2147123264)\n[Trojan:MSIL/SoldierAudio.B!dha](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/SoldierAudio.B!dha&threatId=-2147123263)\n[Trojan:MSIL/SoldierAudio.C!dha](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/SoldierAudio.C!dha&threatId=-2147123262)\n\nMicrosoft Defender Antivirus detects the CharmPower implant as the following malware:\n\n\n-----\n\n[TrojanDownloader:O97M/RooftopMelt.A!dha](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:O97M/RooftopMelt.A!dha&threatId=-2147123265)\n\n**Microsoft Defender for Endpoint**\n\nThe following Microsoft Defender for Endpoint alerts can indicate associated threat activity:\n\nPhosphorus Actor activity detected\n\n### Hunting queries\n\n**Microsoft 365 Defender**\n\nMicrosoft 365 Defender customers can run the following query to find related activity in their networks:\n\n**ManageEngine Suspicious Process Execution.**\n```\nDeviceProcessEvents\n\n| where InitiatingProcessFileName hasprefix \"java\"\n\n| where InitiatingProcessFolderPath has @\"\\manageengine\\\" or InitiatingProcessFolderPath has @\"\\ServiceDesk\\\"\n\n| where (FileName in~ (\"powershell.exe\", \"powershell_ise.exe\") and\n\n      (ProcessCommandLine has_any (\"whoami\", \"net user\", \"net group\", \"localgroup administrators\",\n\"dsquery\", \"samaccountname=\", \" echo \", \"query session\", \"adscredentials\", \"o365accountconfiguration\", \"dumpmode\", \"-ssh\", \"usoprivate\", \"usoshared\", \"Invoke-Expression\", \"DownloadString\", \"DownloadFile\",\n\"FromBase64String\", \"System.IO.Compression\", \"System.IO.MemoryStream\", \"iex \", \"iex(\", \"Invoke-WebRequest\",\n\"set-MpPreference\", \"add-MpPreference\", \"certutil\", \"bitsadmin\") // \"csvhost.exe\", \"ekern.exe\", \"svhost.exe\",\n\".dmp\"\n\n       or ProcessCommandLine matches regex @\"[-/–][Ee^]{1,2}[ncodema^]*\\s[A-Za-z0-9+/=]{15,}\"))\n\n      or (FileName =~ \"curl.exe\" and ProcessCommandLine contains \"http\")\n\n      or (FileName =~ \"wget.exe\" and ProcessCommandLine contains \"http\")\n\n      or ProcessCommandLine has_any (\"E:jscript\", \"e:vbscript\")\n\n      or ProcessCommandLine has_all (\"localgroup Administrators\", \"/add\")\n\n      or ProcessCommandLine has_all (\"reg add\", \"DisableAntiSpyware\", @\"\\Microsoft\\Windows Defender\")\n\n      or ProcessCommandLine has_all (\"reg add\", \"DisableRestrictedAdmin\", @\"CurrentControlSet\\Control\\Lsa\")\n\n      or ProcessCommandLine has_all (\"wmic\", \"process call create\")\n\n      or ProcessCommandLine has_all (\"net\", \"user \", \"/add\")\n\n      or ProcessCommandLine has_all (\"net1\", \"user \", \"/add\")\n\n      or ProcessCommandLine has_all (\"vssadmin\", \"delete\", \"shadows\")\n\n      or ProcessCommandLine has_all (\"wmic\", \"delete\", \"shadowcopy\")\n\n      or ProcessCommandLine has_all (\"wbadmin\", \"delete\", \"catalog\")\n\n      or (ProcessCommandLine has \"lsass\" and ProcessCommandLine has_any (\"procdump\", \"tasklist\",\n\"findstr\"))\n\n | where ProcessCommandLine !contains \"download.microsoft.com\" and ProcessCommandLine !contains\n\"manageengine.com\" and ProcessCommandLine !contains \"msiexec\"\n\n\n```\n**Ruby AsperaFaspex Suspicious Process Execution.**\n\n\n-----\n\n```\n| where InitiatingProcessFileName hasprefix \"ruby\"\n\n| where InitiatingProcessFolderPath has @\"aspera\"\n\n| where (FileName in~ (\"powershell.exe\", \"powershell_ise.exe\") and\n\n      (ProcessCommandLine has_any (\"whoami\", \"net user\", \"net group\", \"localgroup administrators\",\n\"dsquery\", \"samaccountname=\", \" echo \", \"query session\", \"adscredentials\", \"o365accountconfiguration\", \"dumpmode\", \"-ssh\", \"usoprivate\", \"usoshared\", \"Invoke-Expression\", \"DownloadString\", \"DownloadFile\",\n\"FromBase64String\", \"System.IO.Compression\", \"System.IO.MemoryStream\", \"iex \", \"iex(\", \"Invoke-WebRequest\",\n\"set-MpPreference\", \"add-MpPreference\", \"certutil\", \"bitsadmin\", \"csvhost.exe\", \"ekern.exe\", \"svhost.exe\",\n\".dmp\")\n\n       or ProcessCommandLine matches regex @\"[-/–][Ee^]{1,2}[ncodema^]*\\s[A-Za-z0-9+/=]{15,}\"))\n\n      or (FileName =~ \"curl.exe\" and ProcessCommandLine contains \"http\")\n\n      or (FileName =~ \"wget.exe\" and ProcessCommandLine contains \"http\")\n\n      or ProcessCommandLine has_any (\"E:jscript\", \"e:vbscript\")\n\n      or ProcessCommandLine has_all (\"localgroup Administrators\", \"/add\")\n\n      or ProcessCommandLine has_all (\"reg add\", \"DisableAntiSpyware\", @\"\\Microsoft\\Windows Defender\")\n\n      or ProcessCommandLine has_all (\"reg add\", \"DisableRestrictedAdmin\", @\"CurrentControlSet\\Control\\Lsa\")\n\n      or ProcessCommandLine has_all (\"wmic\", \"process call create\")\n\n      or ProcessCommandLine has_all (\"net\", \"user \", \"/add\")\n\n      or ProcessCommandLine has_all (\"net1\", \"user \", \"/add\")\n\n      or ProcessCommandLine has_all (\"vssadmin\", \"delete\", \"shadows\")\n\n      or ProcessCommandLine has_all (\"wmic\", \"delete\", \"shadowcopy\")\n\n      or ProcessCommandLine has_all (\"wbadmin\", \"delete\", \"catalog\")\n\n      or (ProcessCommandLine has \"lsass\" and ProcessCommandLine has_any (\"procdump\", \"tasklist\",\n\"findstr\"))\n\n```\n**Log4J Wstomcat Process Execution.**\n```\nDeviceProcessEvents\n\n| where InitiatingProcessFileName has \"ws_tomcatservice.exe\" and FileName !in~(\"repadmin.exe\")\n\n\n```\n**Encoded watcher Function.**\n```\nDeviceProcessEvents\n\n| where FileName =~ \"powershell.exe\" and ProcessCommandLine hasprefix \"-e\"\n\n| extend SplitString = split(ProcessCommandLine, \" \")\n\n| mvexpand SS = SplitString\n\n| where SS matches regex \"^[A-Za-z0-9+/]{50,}[=]{0,2}$\"\n\n| extend base64_decoded = replace(@'\\0', '', make_string(base64_decode_toarray(tostring(SS))))\n\n| where not(base64_decoded has_any(@\"software\\checker\", \"set folder to watch\"))\n\n| where base64_decoded has_all(\"$hst\", \"$prt\") or base64_decoded has_any(\"watcher\", @\"WAt`CH`Er()\")\n\n\n```\n**Microsoft Sentinel**\n\nMicrosoft Sentinel customers can use the TI Mapping analytic (a series of analytics all prefixed with “TI map”) to\nautomatically match the indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not\ncurrently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have\nthe analytics rule deployed in their Sentinel workspace. More details on the Content Hub can be found here:\n[https://learn.microsoft.com/azure/sentinel/sentinel-solutions-deploy](https://learn.microsoft.com/azure/sentinel/sentinel-solutions-deploy)\n\nIn addition, Microsoft Sentinel customers can leverage the following content to hunt for and detect related activity in their\nenvironments:\n\n## Indicators of compromise\n\n**Indicator** **Type** **Description**\n\n\nSoldier.exe File\nname\n\nad55b4a40f9e52682d9d4f069914e09c941e8b77ca7b615e9deffccdfbc54145 SHA256\n\n\nSoldier backdoor\n\nSoldier backdoor hash\n\n\n-----\n\nDrokbk.exe File\nname\n\n64f39b858c1d784df1ca8eb895ac7eaf47bf39acf008ed4ae27a796ac90f841b SHA256\n\n\nDrokbk backdoor\n\nDrokbk backdoor hash\n\n\nsync-system-time[.]cf Domain Drokbk C2 infrastructure\n\nupdate-windows-security[.]tk Domain Drokbk C2 infrastructure\n\ndns-iprecords[.]tk Domain Drokbk C2 infrastructure\n\nuniversityofmhealth[.]biz Domain Drokbk C2 infrastructure\n\noracle-java[.]cf Domain Drokbk C2 infrastructure\n\n\n54.39.202[.]0 IP\naddress\n\n51.89.135[.]15 IP\naddress\n\n51.89.169[.]201 IP\naddress\n\n51.89.187[.]222 IP\naddress\n\nNY.docx.docx File\nname\n\n57cc5e44fd84d98942c45799f367db78adc36a5424b7f8d9319346f945f64a72 SHA256\n\nAbraham%20Accords%20Du.[.]docx File\nname\n\n3dcdb0ffebc5ce6691da3d0159b5e811c7aa91f6d8fc204963d2944225b0119d SHA256\n\nDocTemplate.dotm File\nname\n\n65e48f63f455c94d3bf681acaf115caa6e1e60499362add49ca614458bbc4f85 SHA256\n\nDntDocTemp.dotm File\nname\n\n444075183ff6cae52ab5b93299eb9841dcd8b0321e3a90fb29260dc12133b6a2 SHA256\n\n\nDrokbk C2 infrastructure\n\nDrokbk C2 infrastructure\n\nDrokbk C2 infrastructure\n\nDrokbk C2 infrastructure\n\nCharmPower lure document\nused for template injection\n\nNY.docx.docx hash\n\nCharmPower lure document\nused for template injection\n\nAbraham%20Accords%20Du.\n\n[.]docx hash\n\nMalicious remote template\ndocument used in intrusions\ninvolving CharmPower\n\nDocTemplate.dotm\n\nMalicious remote template\ndocument used in intrusions\ninvolving CharmPower\n\nDntDocTemp.dotm hash\n\n\n0onlyastep0[.]xyz Domain CharmPower C2\ninfrastructure\n\n0readerazone0[.]xyz Domain CharmPower C2\ninfrastructure\n\n0tryamore0[.]xyz Domain CharmPower C2\ninfrastructure\n\n### References\n\n[Iran: Background and U.S. Policy. Congressional Research Service](https://sgp.fas.org/crs/mideast/R47321.pdf)\n\n\n-----\n\n[Cobalt Illusion Masquerades as Atlantic Council Employee. Secureworks](https://www.secureworks.com/blog/cobalt-illusion-masquerades-as-atlantic-council-employee)\n\n[Apt42: Crooked Charms, Cons, and Compromises. Mandiant](https://www.mandiant.com/resources/blog/apt42-charms-cons-compromises)\n\n[Badblood: TA453 Targets US & Israel in Credential Phishing. Proofpoint](https://www.proofpoint.com/us/blog/threat-insight/badblood-ta453-targets-us-and-israeli-medical-research-personnel-credential)\n\n[Treasury Sanctions IRGC-Affiliated Cyber Actors for Roles in Ransomware Activity. U.S. Department of the Treasury](https://home.treasury.gov/news/press-releases/jy0948)\n\n[Officials: Israel Linked to a Disruptive Cyberattack on Iranian Port Facility. The Washington Post](https://www.washingtonpost.com/national-security/officials-israel-linked-to-a-disruptive-cyberattack-on-iranian-port-facility/2020/05/18/9d1da866-9942-11ea-89fd-28fb313d1886_story.html.)\n\n[Iran Says Cyberattack Causes Widespread Disruption at Gas Stations. Thomson Reuters](https://www.reuters.com/world/middle-east/iran-says-cyberattack-behind-widespread-disruption-gas-stations-2021-10-26/)\n\n[Iran’s Evolving Approach to Asymmetric Naval Warfare. The Washington Institute for Near East Policy](https://web.archive.org/web/20200504225030/https:/www.washingtoninstitute.org/uploads/Documents/pubs/PolicyFocus164-Nadimi-v2.pdf)\n\n[Hackers breach Iran rail network, disrupt service | Reuters. Reuters](https://www.reuters.com/world/middle-east/hackers-breach-iran-rail-network-disrupt-service-2021-07-09/)\n\n[APT35 Exploits Log4J Vulnerability to Distribute New Modular PowerShell Toolkit. Checkpoint](https://research.checkpoint.com/2022/apt35-exploits-log4j-vulnerability-to-distribute-new-modular-powershell-toolkit/)\n\n[Iran Says Gas Stations Were Target Of Cyberattack To Foment Unrest (iranintl.com)](https://www.iranintl.com/en/20211028778677)\n\n[Complaint – Summons – Civil Cover Sheet.pdf (noticeofpleadings.com)](https://noticeofpleadings.com/phosphorus/files/Complaint.pdf)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-18 - Nation-state threat actor PHOSPHORUS refines tradecraft to attack high-value targets.pdf"
    ],
    "report_names": [
        "2023-04-18 - Nation-state threat actor PHOSPHORUS refines tradecraft to attack high-value targets.pdf"
    ],
    "threat_actors": [
        {
            "id": "82b92285-4588-48c9-8578-bb39f903cf62",
            "created_at": "2022-10-25T15:50:23.850506Z",
            "updated_at": "2025-03-27T02:00:55.501372Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Charming Kitten"
            ],
            "source_name": "MITRE:Charming Kitten",
            "tools": [
                "DownPaper"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d0e8337e-16a7-48f2-90cf-8fd09a7198d1",
            "created_at": "2023-03-04T02:01:54.091301Z",
            "updated_at": "2025-03-27T02:00:03.119447Z",
            "deleted_at": null,
            "main_name": "APT42",
            "aliases": [
                "UNC788",
                "CALANQUE"
            ],
            "source_name": "MISPGALAXY:APT42",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae26d287-8ba7-447e-9391-cf13c02d7481",
            "created_at": "2023-03-04T02:01:54.0962Z",
            "updated_at": "2025-03-27T02:00:03.120665Z",
            "deleted_at": null,
            "main_name": "TA453",
            "aliases": [],
            "source_name": "MISPGALAXY:TA453",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d8af157e-741b-4933-bb4a-b78490951d97",
            "created_at": "2023-01-06T13:46:38.748929Z",
            "updated_at": "2025-03-27T02:00:02.908256Z",
            "deleted_at": null,
            "main_name": "APT35",
            "aliases": [
                "Newscaster Team",
                "Magic Hound",
                "G0059",
                "Phosphorus",
                "Mint Sandstorm",
                "TunnelVision",
                "COBALT MIRAGE"
            ],
            "source_name": "MISPGALAXY:APT35",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "04888f75-158b-47f9-8ad9-4ff83f618ece",
            "created_at": "2024-05-01T02:03:08.03763Z",
            "updated_at": "2025-03-27T02:05:17.319276Z",
            "deleted_at": null,
            "main_name": "COBALT MIRAGE",
            "aliases": [
                "Nemesis Kitten ",
                "PHOSPHORUS ",
                "TunnelVision ",
                "UNC2448 ",
                "DEV-0270 "
            ],
            "source_name": "Secureworks:COBALT MIRAGE",
            "tools": [
                " Custom powershell scripts",
                " DiskCryptor",
                " Drokbk",
                " FRPC",
                " Fast Reverse Proxy (FRP)",
                " Impacket wmiexec",
                " Ngrok",
                " Plink",
                " PowerLessCLR",
                " TunnelFish",
                "BitLocker"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "029625d2-9734-44f9-9e10-b894b4f57f08",
            "created_at": "2023-01-06T13:46:38.364105Z",
            "updated_at": "2025-03-27T02:00:02.815023Z",
            "deleted_at": null,
            "main_name": "Charming Kitten",
            "aliases": [
                "Parastoo",
                "iKittens",
                "Group 83",
                "NewsBeef",
                "G0058",
                "CharmingCypress"
            ],
            "source_name": "MISPGALAXY:Charming Kitten",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "08a3b64c-8e18-455d-af57-28dca63808c4",
            "created_at": "2024-05-01T02:03:08.027871Z",
            "updated_at": "2025-03-27T02:05:17.313679Z",
            "deleted_at": null,
            "main_name": "COBALT ILLUSION",
            "aliases": [
                "APT42 ",
                "Charming Kitten ",
                "CharmingCypress ",
                "ITG18 ",
                "Magic Hound ",
                "Mint Sandstorm sub-group ",
                "NewsBeef ",
                "Newscaster ",
                "PHOSPHORUS sub-group ",
                "TA453 ",
                "UNC788 ",
                "Yellow Garuda ",
                "APT35 "
            ],
            "source_name": "Secureworks:COBALT ILLUSION",
            "tools": [
                " MagicHound Toolset",
                " PupyRAT",
                "Browser Exploitation Framework (BeEF)"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3676dfe-3d40-4b3a-bfbd-4fc1f8c896f4",
            "created_at": "2022-10-25T15:50:23.808974Z",
            "updated_at": "2025-03-27T02:00:55.550912Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "Magic Hound",
                "TA453",
                "COBALT ILLUSION",
                "Charming Kitten",
                "ITG18",
                "Phosphorus",
                "APT35",
                "Mint Sandstorm"
            ],
            "source_name": "MITRE:Magic Hound",
            "tools": [
                "Impacket",
                "CharmPower",
                "FRP",
                "Mimikatz",
                "Systeminfo",
                "ipconfig",
                "netsh",
                "PowerLess",
                "Pupy",
                "DownPaper",
                "PsExec",
                "Havij",
                "sqlmap"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1699fb41-b83f-42ff-a6ec-984ae4a1031f",
            "created_at": "2022-10-25T16:07:23.83826Z",
            "updated_at": "2025-03-27T02:02:09.995863Z",
            "deleted_at": null,
            "main_name": "Magic Hound",
            "aliases": [
                "APT 35",
                "Ballistic Bobcat",
                "Charming Kitten",
                "CharmingCypress",
                "Cobalt Illusion",
                "Cobalt Mirage",
                "Educated Manticore",
                "Magic Hound",
                "Mint Sandstorm",
                "Operation BadBlood",
                "Operation Sponsoring Access",
                "Operation SpoofedScholars",
                "Operation Thamar Reservoir",
                "Phosphorus",
                "TA453",
                "TEMP.Beanie",
                "Tarh Andishan",
                "Timberworm",
                "TunnelVision",
                "UNC788",
                "Yellow Garuda"
            ],
            "source_name": "ETDA:Magic Hound",
            "tools": [
                "7-Zip",
                "AnvilEcho",
                "BASICSTAR",
                "CORRUPT KITTEN",
                "CWoolger",
                "CharmPower",
                "ChromeHistoryView",
                "CommandCam",
                "DistTrack",
                "DownPaper",
                "FRP",
                "Fast Reverse Proxy",
                "FireMalv",
                "Ghambar",
                "GoProxy",
                "GorjolEcho",
                "HYPERSCRAPE",
                "Havij",
                "MPK",
                "MPKBot",
                "Matryoshka",
                "Matryoshka RAT",
                "MediaPl",
                "Mimikatz",
                "MischiefTut",
                "NETWoolger",
                "NOKNOK",
                "PINEFLOWER",
                "POWERSTAR",
                "PowerLess Backdoor",
                "PsList",
                "Pupy",
                "PupyRAT",
                "SNAILPROXY",
                "Shamoon",
                "TDTESS",
                "WinRAR",
                "WoolenLogger",
                "Woolger",
                "pupy",
                "sqlmap"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338920,
    "ts_updated_at": 1743041771,
    "ts_creation_date": 1683252063,
    "ts_modification_date": 1683252063,
    "files": {
        "pdf": "https://archive.orkl.eu/f2bcbf10cbc41c6b56f582329b416274c75eb6cf.pdf",
        "text": "https://archive.orkl.eu/f2bcbf10cbc41c6b56f582329b416274c75eb6cf.txt",
        "img": "https://archive.orkl.eu/f2bcbf10cbc41c6b56f582329b416274c75eb6cf.jpg"
    }
}