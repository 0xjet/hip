{
    "id": "47680fd5-da83-4727-9a0b-cb7fd9c13073",
    "created_at": "2023-01-12T15:09:39.072742Z",
    "updated_at": "2025-03-27T02:12:03.955061Z",
    "deleted_at": null,
    "sha1_hash": "d21e855259667b31a270bb0eeed7260dfc13394a",
    "title": "2021-03-09 - Remediation Steps for the Microsoft Exchange Server Vulnerabilities",
    "authors": "",
    "file_creation_date": "2022-05-25T14:26:23Z",
    "file_modification_date": "2022-05-25T14:26:23Z",
    "file_size": 1344138,
    "plain_text": "# Remediation Steps for the Microsoft Exchange Server Vulnerabilities\n\n**[unit42.paloaltonetworks.com/remediation-steps-for-the-Microsoft-Exchange-Server-vulnerabilities](https://unit42.paloaltonetworks.com/remediation-steps-for-the-Microsoft-Exchange-Server-vulnerabilities/)**\n\nMarch 9, 2021\n\nBy [Unit 42](https://unit42.paloaltonetworks.com/author/unit42/)\n\nMarch 9, 2021 at 9:40 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\nTags: [CVE-2021-26855,](https://unit42.paloaltonetworks.com/tag/cve-2021-26855/) [CVE-2021-26857,](https://unit42.paloaltonetworks.com/tag/cve-2021-26857/) [CVE-2021-26858,](https://unit42.paloaltonetworks.com/tag/cve-2021-26858/) [CVE-2021-27065,](https://unit42.paloaltonetworks.com/tag/cve-2021-27065/) Microsoft\nExchange Server, [vulnerabilities](https://unit42.paloaltonetworks.com/tag/vulnerability/)\n\n[This post is also available in: 日本語 (Japanese)](https://unit42.paloaltonetworks.jp/remediation-steps-for-the-microsoft-exchange-server-vulnerabilities/)\n\n## Background\n\nOn March 2, the security community became aware of four critical zero-day Microsoft\n[Exchange Server vulnerabilities (CVE-2021-26855,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26855) [CVE-2021-26857,](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26857) [CVE-2021-26858 and](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-26858)\n[CVE-2021-27065).](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27065)\n\nThese vulnerabilities let adversaries access Exchange Servers and potentially gain long-term\naccess to victims’ environments. While the Microsoft Threat Intelligence Center (MSTIC)\n[attributes the initial campaign with high confidence to HAFNIUM, a group they assess to be](https://blogs.microsoft.com/on-the-issues/?p=64505)\nstate-sponsored and operating out of China, multiple threat intelligence teams, including\nMSTIC and Unit 42, are also seeing multiple threat actors now exploiting these zero-day\nvulnerabilities in the wild. Estimated number of potentially compromised organizations is in\nthe tens of thousands globally – and very importantly, these vulnerabilities were being\nactively exploited for at least two months before the security patches were available. As a\nresult, even if you patched immediately, your Exchange Servers could still be compromised.\nFurther, based on telemetry collected from the Palo Alto Networks Expanse platform, we\nestimate there remain over 125,000 unpatched Exchange Servers in the world.\n\n\n-----\n\nBelow you will find a concise playbook that enterprises can follow to respond to this potential\nthreat in their environments.\n\n## 1) Locate all Exchange Servers and determine whether they need to be patched.\n\nExchange Online is not affected.\n\nVulnerable Exchange Server versions include 2013, 2016, and 2019. While Exchange 2010 is\nnot vulnerable to the same attack chain as Exchange 2013/2016/2019, Microsoft has released\n[a patch for CVE-2021-26857 for this version of the software. Microsoft has recently released](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2010-service-pack-3-march-2-2021-kb5000978-894f27bf-281e-44f8-b9ba-dad705534459)\n[additional guidance for older, unsupported versions of Exchange.](https://techcommunity.microsoft.com/t5/exchange-team-blog/march-2021-exchange-server-security-updates-for-older-cumulative/ba-p/2192020)\n\nMicrosoft is recommending to install updates on all Exchange Servers, prioritising those that\nare externally/internet facing. Even if Exchange Servers are not internet facing, the\nvulnerabilities can still be exploited if access to the network has been achieved through other\nmethods.\n\nMicrosoft has published information about the updates for the following specific versions of\nExchange Server:\n\n[Exchange Server 2019 (update requires Cumulative Update (CU) 8 or CU 7).](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-march-2-2021-kb5000871-9800a6bb-0a21-4ee7-b9da-fa85b3e1d23b)\n\n[Exchange Server 2016 (update requires CU 19 or CU 18).](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-march-2-2021-kb5000871-9800a6bb-0a21-4ee7-b9da-fa85b3e1d23b)\n\n[Exchange Server 2013 (update requires CU 23).](https://support.microsoft.com/en-us/topic/description-of-the-security-update-for-microsoft-exchange-server-2019-2016-and-2013-march-2-2021-kb5000871-9800a6bb-0a21-4ee7-b9da-fa85b3e1d23b)\n\nExchange Server 2010 (update requires SP 3 or any SP 3 RU – this is a Defense in Depth\nupdate).\n\n\n-----\n\n## 2) Patch and secure all Exchange Servers.\n\nInstall the out-of-band security updates for your version of Exchange Server.\n\nIf you cannot update and/or patch an Exchange Server immediately, there are some\n[mitigations and workarounds that may reduce the chances of an attacker exploiting an](https://msrc-blog.microsoft.com/2021/03/05/microsoft-exchange-server-vulnerabilities-mitigations-march-2021/)\nExchange Server; these mitigations should only be temporary until patching can be\n[completed. Palo Alto Networks Next-Generation Firewalls (NGFWs) updated to Threat](https://www.paloaltonetworks.com/network-security/next-generation-firewall)\nPrevention Content Pack 8380 or later protect against these vulnerabilities if SSL decryption\n[is enabled for inbound traffic to the Exchange Server. Cortex XDR running on your Exchange](https://www.paloaltonetworks.com/cortex/cortex-xdr)\nServer will detect and prevent webshell activity commonly used in these attacks.\n\nThe initial attack requires the ability to make an untrusted connection to Exchange Server\nport 443. You can protect against this by restricting access to the system from untrusted\nusers. This can be achieved by only allowing access to the system from users who have\nalready authenticated through a VPN, or by using a firewall to limit access to specific hosts or\nIP ranges. Using this mitigation will only protect against the initial portion of the attack.\nOther portions of the chain can still be triggered if an attacker already has access to the\nnetwork or can convince an administrator to open a malicious file.\n\nMore information about using Palo Alto Networks products, including firewalls with security\nsubscriptions, Cortex XSOAR for automation and Cortex XDR for endpoint protection, can\n[be found in our Threat Assessment.](https://unit42.paloaltonetworks.com/microsoft-exchange-server-vulnerabilities/)\n\n## 3) Determine whether an Exchange Server has already been compromised.\n\nThese vulnerabilities have been in the wild and actively exploited for over a month, with the\nearliest indications of exploitation leading back to Jan. 3. Any organization running the\nvulnerable software must evaluate if their server has been compromised. Patching the system\nwill not remove any malware already deployed on the system. It would be prudent to assume\nExchange Servers that exposed Outlook Web Access or Exchange Web Services to the\ninternet are compromised until proven otherwise.\n\nCheck for suspicious process and system behavior, especially in the context of Internet\nInformation Service (IIS) and Exchange application processes, such as PowerShell,\nCommand shells (cmd.exe) and other programs executed in the applications’ address space.\nWe describe how to use Palo Alto Networks Cortex XDR Pro endpoint protection to hunt for\nthis attack in your environment in “Hunting for the Recent Attacks Targeting Microsoft\nExchange.”\n\n[Microsoft has released PowerShell and Nmap scripts for checking your Exchange Server for](https://github.com/microsoft/CSS-Exchange/tree/main/Security)\nindicators of compromise of these exploits. They have also released another script, available\nat the same link, that highlights differences in files from the virtual directories of your\n\n\n-----\n\nExchange Server against those expected for your specific Exchange version. The\nCybersecurity and Infrastructure Security Agency (CISA) has also published a list of tactics,\ntechniques and procedures (TTPs).\n\nAs documented in the Unit 42 Threat Assessment Courses of Action table, the post-intrusion\nTTPs used by the initial actors conducting the Exchange attacks included the following:\n\nUsing Procdump to dump the LSASS process memory.\nUsing 7-Zip to compress stolen data into ZIP files for exfiltration.\nAdding and using Exchange PowerShell snap-ins to export mailbox data.\nUsing the Nishang Invoke-PowerShellTcpOneLine reverse shell.\nDownloading PowerCat from GitHub, then using it to open a connection to a remote\nserver.\n\nSince the initial attacks, we believe that other actors are trying to capitalize on the Exchange\nvulnerabilities, but their motivations and objectives may differ vastly, and so could their\nTTPs.\n\n## 4) Engage an Incident Response team if you think you have been compromised.\n\nIf, at any point, you think your Exchange Server has been compromised, you should still take\naction to secure it against the vulnerabilities as described above. This will prevent additional\nadversaries from further compromising the system. Installing the out-of-band security\nupdates for your version of Exchange Server is very important, but this will not remove any\nmalware already installed on systems and will not evict any threat actors present in the\nnetwork.\n\nThe potential impact of this situation is critical due to the ongoing activity described, the\nvulnerabilities exploited to deliver the attack and the adversaries who could be behind\ncompromises. While exploits of these vulnerabilities may not halt business operations, access\nto sensitive information and systems is certainly possible, and should be assumed to have\noccurred. Access to corporate emails could also lead to followup phishing attacks.\n\nIf you believe you have been compromised, you should enact your incident response plan. If\nyou need such services, our Palo Alto Networks Crypsis incident response team is available to\n[help: crypsis-investigations@paloaltonetworks.com.](mailto:crypsis-investigations@paloaltonetworks.com)\n\n## Additional Resources:\n\n**Get updates from Palo Alto Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n\n-----\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-03-09 - Remediation Steps for the Microsoft Exchange Server Vulnerabilities.pdf"
    ],
    "report_names": [
        "2021-03-09 - Remediation Steps for the Microsoft Exchange Server Vulnerabilities.pdf"
    ],
    "threat_actors": [
        {
            "id": "529c1ae9-4579-4245-86a6-20f4563a695d",
            "created_at": "2022-10-25T16:07:23.702006Z",
            "updated_at": "2025-03-27T02:02:09.93109Z",
            "deleted_at": null,
            "main_name": "Hafnium",
            "aliases": [
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "ETDA:Hafnium",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "7c969685-459b-4c93-a788-74108eab6f47",
            "created_at": "2023-01-06T13:46:39.189751Z",
            "updated_at": "2025-03-27T02:00:03.017103Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "ATK233",
                "G0125",
                "Operation Exchange Marauder",
                "Red Dev 13",
                "Silk Typhoon"
            ],
            "source_name": "MISPGALAXY:HAFNIUM",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2704d770-43b4-4bc4-8a5a-05df87416848",
            "created_at": "2022-10-25T15:50:23.306305Z",
            "updated_at": "2025-03-27T02:00:55.43633Z",
            "deleted_at": null,
            "main_name": "HAFNIUM",
            "aliases": [
                "HAFNIUM",
                "Operation Exchange Marauder",
                "Silk Typhoon"
            ],
            "source_name": "MITRE:HAFNIUM",
            "tools": [
                "Tarrask",
                "ASPXSpy",
                "Impacket",
                "PsExec",
                "China Chopper"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536179,
    "ts_updated_at": 1743041523,
    "ts_creation_date": 1653488783,
    "ts_modification_date": 1653488783,
    "files": {
        "pdf": "https://archive.orkl.eu/d21e855259667b31a270bb0eeed7260dfc13394a.pdf",
        "text": "https://archive.orkl.eu/d21e855259667b31a270bb0eeed7260dfc13394a.txt",
        "img": "https://archive.orkl.eu/d21e855259667b31a270bb0eeed7260dfc13394a.jpg"
    }
}