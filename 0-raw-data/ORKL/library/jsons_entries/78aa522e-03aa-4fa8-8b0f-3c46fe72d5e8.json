{
    "id": "78aa522e-03aa-4fa8-8b0f-3c46fe72d5e8",
    "created_at": "2023-01-12T15:02:52.829453Z",
    "updated_at": "2025-03-27T02:15:55.624266Z",
    "deleted_at": null,
    "sha1_hash": "822d0e48fe4aa969f238f13f8c0b6d4a5db10972",
    "title": "2020-12-21 - What We Have Learned So Far about the “Sunburst”-SolarWinds Hack",
    "authors": "",
    "file_creation_date": "2022-05-29T01:37:58Z",
    "file_modification_date": "2022-05-29T01:37:58Z",
    "file_size": 239235,
    "plain_text": "# What We Have Learned So Far about the “Sunburst”/SolarWinds Hack\n\n**[fortinet.com/blog/threat-research/what-we-have-learned-so-far-about-the-sunburst-solarwinds-hack](https://www.fortinet.com/blog/threat-research/what-we-have-learned-so-far-about-the-sunburst-solarwinds-hack)**\n\n## Introduction\n\n\nDecember 21, 2020\n\n\nRecently, it was reported that a nation-state threat-actor managed to infiltrate a large number\nof organizations—including multiple US government agencies. They did this by distributing\nbackdoor software, dubbed SunBurst, by compromising SolarWind’s Orion IT monitoring and\nmanagement software update system. Based on SolarWind’s data, 33,000 organizations use\nOrion’s software, and [18,000 were directly impacted by this malicious update. As more and](https://www.theverge.com/2020/12/15/22176053/solarwinds-hack-client-list-russia-orion-it-compromised)\nmore details have become available, it has become clear that this is one of the most evasive\nand significant cyberattacks to date.\n\nOver the past week, the FortiGuard Labs research teams have worked tirelessly to uncover\nmore details on the attack to ensure our customers are protected, details of which can be\n[found in our Threat Signal Blog. In this blog, we share more detail on what we have learned,](https://www.fortiguard.com/threat-signal-report/3770/supply-chain-attack-on-solarwinds-orion-platform-affecting-multiple-organizations-worldwide-apt29)\nthe protections currently provided by products in our portfolio, as well as the proactive steps\nwe have taken leveraging our FortiEDR platform to ensure the security of our customers.\n\n## SunBurst Campaign Overview\n\n\n-----\n\nTo help readers better understand this campaign, I will describe at a high-level the steps\ntaken by the SunBurst malware and the threat actor after the initial infiltration.\n\nAfter a successful infiltration of the supply-chain, the SunBurst backdoor— a file named\nSolarWinds.Orion.Core.BusinessLayer.dll—was inserted into the software distribution system\nand installed as part of an update package from the vendor. Once downloaded, it then lies\ndormant for 12 to 14 days before taking any action. Once the waiting period is over, the\nBackdoor takes steps to ensure it is running in one of the environments targeted by the\nattacker, as opposed to a lower value organization, or in a sandbox or other malware\nanalysis environment. The attacker appears to have wanted to stay as far below the\nindustry’s radar as possible while carrying out its specific mission.\n\n### Here is a high-level overview of the steps it takes to do so:\n\nMachine domain name validation. It checks the domain name of the compromised\nmachine to ensure:\n\nIt doesn’t contain certain strings.\nIt is not a SolarWinds domain.\nIt doesn’t contain the string ‘test’.\nIt validates that no analysis tools, such as WireShark, are running.\nIt also checks to ensure that unwanted security software is not running.\n\nOnce all of the validations are completed, it calls home to the threat actor and sends\ninformation to identify the breached organization. Note: Since most of the organizations\nbreached by this malware were NOT a target of the threat actor, this is where the attack\nappears to have ended for many organizations.\n\nThe C2 domain name is composed from a prefix that is generated based on data from the\nmachine. An example domain can be seen in Figure 1:\nFigure 1: Example of SunBurst-generated domain\n\nAs a next step, the threat actor leverages a memory-only payload called TEARDROP to\ndeliver a CobaltStrike BEACON, among other payloads. CobaltStrike is a commercially\navailable, full-featured penetration testing toolkit that advertises itself as \"adversary\nsimulation software.” However, it is also commonly used by attackers. To date, FortiEDR has\nactively detected and blocked many attacks leveraging CobaltStrike in real-time, including\nthis one.\n\n## Proactive SunBurst Campaign Mitigations\n\nAs soon as the IOCs were disclosed, or otherwise uncovered though investigation, the\nFortiGuard Labs and other teams analyzed all of the data on “Sunburst” and then devised a\nproactive strategy to mitigate the attack as well as to help organizations understand its\nimpact.\n\n\n-----\n\nAs mentioned, most organizations were not targeted, and therefore the existence of the\nmalicious DLL file does not necessarily mean that actual damage was done.\n\n### Steps Fortinet is Taking to Ensure the Security of our Customers:\n\n1. All published and subsequent IOCs were immediately added to our Cloud intelligence and\nsignatures databases to ensure detection of the malicious files by Fortinet’s security\n[solutions, including FortiGate,](https://www.fortinet.com/products/next-generation-firewall.html?utm_source=blog&utm_campaign=2018-q2-fortigate-main-page) [FortiSIEM,](https://www.fortinet.com/products/siem/fortisiem.html?utm_source=blog&utm_campaign=2018-q2-fortisiem-main-page) [FortiSandbox,](https://www.fortinet.com/products/sandbox/fortisandbox.html?utm_source=blog&utm_campaign=2018-q2-fortisandbox-main-page) [FortiEDR,](https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&utm_campaign=2020-q1-fortiedr) [FortiAnalyzer,](https://www.fortinet.com/products/management/fortianalyzer.html?utm_source=blog&utm_campaign=2018-q2-fortianalyzer-main-page)\n[and FortiClient. As new IOCs are uncovered, they will also be immediately added to our](https://www.fortinet.com/products/endpoint-security/forticlient.html?utm_source=blog&utm_campaign=2018-q2-endpoint-web-page)\ndatabases.\n\n2. In order to reconstruct the attack and gain more insights and indicators, FortiGuard Labs\nresearch and intelligence teams started to hunt for more indicators based on the initially\ndisclosed data. As part of this effort, we have discovered and analyzed a new variant of\nTEARDROP. In Figure 2, you can see this TEARDROP variant read the fake jpeg header\nand its main unpacking routine:\n\nFigure 2: TEARDROP under the microscope\n\n[3. We also proactively scanned our FortiEDR Cloud data lake for indicators to determine if](https://www.fortinet.com/products/endpoint-security/fortiedr.html?utm_source=blog&utm_campaign=2020-q1-fortiedr)\ncustomers may have been breached. Customers that were potentially impacted are being\ncontacted.\n\n4. Our MDR and FortiEDR research teams have also devised tools that can help\norganizations understand the scope of a breach in case they have been impacted by this\nsupply-chain attack. These tools are being shared with customers upon request. As\nmentioned, most organizations were not targeted, and understanding the scope of the\nbreach is critical for determining follow-up steps.\n\n## TEARDROP and CobaltStrike Detection\n\nIn addition to detection based on specific IOCs, analysis by our research teams has\ndetermined that the FortiEDR platform is and was capable of protecting devices against\nCobaltStrike and TEARDROP—out-of-the-box and without any prior knowledge of the threat\n—using its memory code tracing technology. FortiEDR has proven countless times that it is\ncapable of blocking CobaltStrike in real-time during live incidents. An example of such a\ndetection can be seen in Figure 3:\n\nFigure 3: Real-World Detection of Cobalt-Strike by FortiEDR\n\n## Summary and Recommendations\n\n1. Endpoint protection - Fortinet and SolarWinds Orion 2019.4 through 2020.2.1 HF1\ncustomers\n\n\n-----\n\na. [FortiClient, FortiEDR, and FortiGate all detect and block the execution of these malicious](https://www.fortinet.com/products/endpoint-security/forticlient.html?utm_source=blog&utm_campaign=2018-q2-endpoint-web-page)\nfiles.\n\nb. By design, any supported version of FortiEDR will detect and protect against the\nweaponized, post-execution consequences of this attack out of the box. No change or\nupgrade to the platform is required.\n\ni. Make sure to set post-execution policies to blocking mode. This will allow you to block\nmalicious behavior even if the system is already compromised through a trusted source,\nsuch as this supply chain attack.\n\nii. Apply contextual pre-canned policies that can enable proactive actions in case of\nmalicious or inconclusive activities. In this case, these actions would have removed the\nassociated DLL file.\n\nc. If you subscribe to the MDR service or were not in protection mode at the time of the\nattack, please work with the MDR team to assist you with proactive threat hunting.\n\n2. Endpoint protection - Non-Fortinet and SolarWinds Orion 2019.4 through 2020.2.1 HF1\ncustomers\n\na. Run forensics to validate the existence of the known malicious files based on published\nIOCs (SHA-1 hashes):\n\nd130bd75645c2433f88ac03e73395fba172ef676\n76640508b1e7759e548771a5359eaed353bf1eec\n2f1a5a7411d015d01aaee4535835400191645023\n395da6d4f3c890295f7584132ea73d759bd9d094\n1acf3108bf1e376c8848fbb25dc87424f2c2a39c\ne257236206e99f5a5c62035c9c59c57206728b28\n6fdd82b7ca1c1f0ec67c05b36d14c9517065353b\nbcb5a4dcbc60d26a5f619518f2cfc1b4bb4e4387\n16505d0b929d80ad1680f993c02954cfd3772207\nd8938528d68aabe1e31df485eb3f75c8a925b5d9\nc8b7f28230ea8fbf441c64fdd3feeba88607069e\n2841391dfbffa02341333dd34f5298071730366a\n2546b0e82aecfe987c318c7ad1d00f9fa11cd305\ne2152737bed988c0939c900037890d1244d9a30e\n\nb. Threat hunt your memory for IOCs looking for TEARDROP or COBALT STRIKE. The\n[relevant YARA signatures are listed here.](https://github.com/fireeye/sunburst_countermeasures/blob/main/all-yara.yar)\n\nc. Hunt for suspicious dropped files based on the timeline of initial infections in your\norganization. One potential IOC is the existence of the following malicious DLL file:\n\n\n-----\n\nc:\\Windows\\SysWOW64\\netsetupsvc.dll file.\n\nd. If any of these IOCs are detected, consider all affected machines—along with all user\naccounts on these machines—as compromised. Revoke all account credentials and isolate\nthe devices for further investigation.\n\n## Best Practices\n\nThis event reemphasizes the need for best practices when it comes to maintaining software\nand systems. Here are three essential security best practices every organization should\nadopt:\n\nAll new updates and patches should be run through a sandbox or similar analysis tool\nbefore being deployed to identify malware and supply-chain attacks. In this case,\nFortiSandbox would have identified the offending DLL file as malicious and removed it\nbefore it could impact the network.\nAdvanced Endpoint Detection and Response technology is now an essential\ncomponent of any security strategy. Deploying FortiEDR on endpoints and servers\nwould have prevented malware such as CobaltStrike and TEARDROP from executing.\nNetwork segmentation is another critical security strategy required to protect today’s\n[advanced networks. Deploying a segmentation firewall as part of a Zero-Trust Network](https://www.fortinet.com/solutions/enterprise-midsize-business/network-access.html?utm_source=blog&utm_campaign=2020-q2-zero-trust-network-access)\nstrategy, such as the FortiGate platform, would prevent malware from spreading across\nthe network.\n\n## Additional Help\n\nEnterprises seeking assistance in understanding their organizations exposure to this cyber\ncampaign and/or who are leveraging the FortiEDR solution for prevention or detection of\nsimilar attacks can [contact us (at no charge for a limited time) through the FortiGuard](https://www.fortinet.com/support/support-services/fortiguard-security-subscriptions/incident-response?utm_source=blog&utm_campaign=2020-q4-incident-response)\nIncident Response services webpage.\n\n_[Learn more about FortiGuard Labs threat research and the FortiGuard Security](https://www.fortinet.com/fortiguard/labs?utm_source=blog&utm_campaign=fortiguard-labs)_\n_[Subscriptions and Services portfolio.](https://www.fortinet.com/fortiguard/labs?tab=security-bundles&utm_source=blog&utm_campaign=security-bundles)_\n\n_Learn more about Fortinet’s_ _[free cybersecurity training initiative or about the Fortinet](https://www.fortinet.com/blog/business-and-technology/fortinet-offers-free-cybersecurity-training-courses?utm_source=blog&utm_campaign=free-cybersecurity-training-courses)_ _NSE_\n_Training program,_ _[Security Academy program, and](https://training.fortinet.com/local/staticpage/view.php?page=fnsa&utm_source=blog&utm_campaign=fnsa)_ _[Veterans program.](https://www.fortinet.com/corporate/careers/vets.html?utm_source=blog&utm_campaign=fortivet)_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-21 - What We Have Learned So Far about the “Sunburst”-SolarWinds Hack.pdf"
    ],
    "report_names": [
        "2020-12-21 - What We Have Learned So Far about the “Sunburst”-SolarWinds Hack.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535772,
    "ts_updated_at": 1743041755,
    "ts_creation_date": 1653788278,
    "ts_modification_date": 1653788278,
    "files": {
        "pdf": "https://archive.orkl.eu/822d0e48fe4aa969f238f13f8c0b6d4a5db10972.pdf",
        "text": "https://archive.orkl.eu/822d0e48fe4aa969f238f13f8c0b6d4a5db10972.txt",
        "img": "https://archive.orkl.eu/822d0e48fe4aa969f238f13f8c0b6d4a5db10972.jpg"
    }
}