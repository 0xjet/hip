{
    "id": "7f21de53-2cb7-48af-b626-149baf72c046",
    "created_at": "2022-10-25T16:48:23.417693Z",
    "updated_at": "2025-03-27T02:09:30.166772Z",
    "deleted_at": null,
    "sha1_hash": "d164a25d51d00fab7f36a58e18cc3d93764a8e52",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-07-08T15:02:24Z",
    "file_modification_date": "2021-07-08T15:02:30Z",
    "file_size": 4776079,
    "plain_text": "###### Neutralize Threat Before they Do\n\n .\n\n# Kaseya: Another Massive\n Heist by REvil\n\n#### July 2021\n\n\n-----\n\n## Kaseya: Another Massive Heist by REvil\n\n\n###### OBJECTIVES: FINANCIAL GAIN\n\n\n###### STATUS: ONGOING\n\n\n###### INTRUSION SET: REVIL aka SODINOKIBI\n\n\n###### AFFECTED SECTORS: TECHNOLOGY, RETAIL (AT LEAST FOR CONFIRMED VICTIMS)\n\n IMPACTED GEOGRAPHIES: WORLDWIDE\n\n\n##### SUMMARY\n\nOn July 2, 2021, the threat actor undoubtedly carried out one of its largest ransomware heists known so far through\na third party attack.\n\nThe group managed to compromise Kaseya VSA, a solution used by Managed Service Providers (MSPs) to manage\ntheir client systems. According to an updated Kaseya notice, fewer than 60 of the company’s customers using the\nVSA on-premises product were directly compromised, with a global impact to fewer than 1.500 downstream bu­\nsinesses. A patch for on-premises clients is to be released within 24 hours after the SaaS Data Center restoration.\n\nOn July 5, 2021 REvil group claimed responsibility for the attack on “more than a million systems” and demanded a\n$70 million ransom payment to release a “universal decryptor”.\n\n\n-----\n\n##### ANALYSIS\n\n###### A zero day vulnerability to get initial access\n\nThe REvil group got the initial access by exploiting a zero day vulnerability, CVE-2021–30116, in Kaseya VSA. The\nvulnerability was identified a few weeks ago by a researcher from DIVD, a cybersecurity organization, that reported\nthe vulnerability to Kaseya under responsible disclosure guidelines. Hence, it is likely that Kaseya ran out of time\nbefore the vulnerability was exploited in the attack.\n\nAt that time, the nature and details of the vulnerability are still undisclosed, however some indications point towards\nan authentication bypass in the VSA web interface.\n\n###### A fake update to spread REvil ransomware\n\nOnce the attackers have set foot in the VSA system, they dropped a base64-encoded malicious payload agent.crt that\nwas delivered through the ‘Kaseya VSA Agent Hot-fix’ update. A PowerShell command was then executed to carry out\nmany well-known Impair Defenses techniques that led to Windows Defender deactivation.\n\nThese types of attacks are detected by SEKOIA.IO since many rules related to Impair Defenses and other techniques\nare implemented in our solution.\n\nThe powershell command was also designed to masquerade as Windows system utility certutil.exe, which is an ad­\nmin command line tool intended to be used for manipulating certificates’ data and components. Hence, the Power­\nShell command copied certutil.exe to another location that is not the original one. It was then renamed to cert.\nexe. This latter was then used to decode the base64-encoded payload agent.crt and save it as agent.exe. To harden\nforensic analysis, both cert.exe and agent.crt were removed from victim systems.\n\nThen, the execution of agent.exe led to the extraction of two files:\n\n- mpsvc.dll which is the DLL used by REvil to encrypt victim’s systems.\n\n- an older version of the legitimate Microsoft Defender executable which was used as a living-off-the-land binary\n(LOLBin). Hence, this binary which is a trusted Windows executable, was used to launch mpsvc.dll file with DLL\nside-loading to encrypt the systems.\n\n\n-----\n\n###### A complex cryptographic scheme\n\nThe unique encryption system (file key – system key – affiliate key) made it possible for REvil affiliates to ask for cus­\ntomized ransoms for each individual encrypted file extension found on a victim’s network. However, REvil group is\nalso selling a universal decryption key that would alledgedly be able to decode all victim’s data.\n\nUnlike other previous attacks, this time the group is apparently not exfiltrating data so it is not using data theft ex­\ntortion to force payments.\n\n###### Anti-virus and Firewall exclusions in the spotlight once again\n\nFor the Kaseya Agent to function properly, Kaseya asks its customers to disable anti-virus protection for some sys­\ntem components on which it’s running. In fact, this is a very common practice among a considerable number of\nvendors, which may result in overlooking security incidents.\n\nThis is a particularly increasing concern, also knowing that Kaseya already faced a ransomware attack performed by\nGrandCrab in 2019. The precursors of the REvil group then targeted the same VSA remote monitoring and manage­\nment tool.\n\n###### Kaseya response to the incident\n\nFollowing the incident, Kaseya shut down its cloud-based infrastructures and urged its VSA customers to take ser­\nvers offline.\n\nAccording to DIVD, two days after the attack, only 140 servers were still online while they were 2.200 before the at­\ntack. This response has probably helped to mitigate the severity of the attack, which could have been much worse.\n\n###### Victimology\n\nThe main victims of the attack were the endpoints (mostly small businesses) managed by the Kaseya’s MSP cus­\ntomers. According to TheRecord, five MSPs have publicly admitted to being impacted by the REvil attacks on Kaseya\nservers, namely VelzArt, Hoppenbrouwers, Visma EssCom, Synnex, and Avtex.\n\nCoop supermarket chain is one of the indirect victims, whose overall picture is not well known yet. After cross\nchecking different sources, the attack appears to have a global scale, with victims in at least 29 countries all over the\nworld.\n\nThis is the result of the dramatic amplification effect of a successful third-party attack. The wide third-party attack\nsurface is a real appetizer for ransomware operators, as it provides high returns in case of successful attack.\n\n###### A well-planned attack timeline\n\nThe Kaseya attack occurred on late Friday, just before the 4th of July extended weekend. There is quite a common\n_modus operandi behind the most severe attacks operated by REvil: the deployment of ransomware is often perfor­_\nmed over a weekend or on holidays to take advantage of understaffed security teams.\n\n###### Third-party attacks, a further proof of the power of their impact\n\nApart from Kaseya, one of the most recent third-party attacks targeted SolarWinds. While these campaigns have\ndifferent goals, i.e: massive intelligence operation vs attempt to extort money, they showed us how powerful and\ndevastating their effects can be.\n\nHence, the risks associated with a third-party attack are no longer to be demonstrated, and an increasing number of\nattacks are now taking advantage of third party trusts. At the same time, businesses are relying more and more on\noutside providers. Thus, it is recommended for organizations to look closely at their software providers, particularly\nthose with privileged access to their systems and implement the least privileges principles as far as possible.\n\n\n-----\n\n###### Keep your VSA servers offline until further Kaseya instruc­ tions on when it is safe to resume operations.\n\n Apply the VSA patch as soon as Kaseya releases it and keep software patches up to date.\n\n Hunt for indicators of compromise on your network and block malicious traffic.\n\n##### IOCS & TECHNICAL DETAILS\n\n###### IP addresses:\n\n_•_ _35.226.94[.]113_\n\n_•_ _161.35.239[.]148_\n\n_•_ _162.253.124[.]162_\n\n###### Hashes (SHA256):\n\n_•_ _cc0cdc6a3d843e22c98170713abf1d6ae06e8b5e34ed06ac3159adafe85e3bd6 (Mpsvc.dll)_\n\n_•_ _d5ce6f36a06b0dc8ce8e7e2c9a53e66094c2adfc93cfac61dd09efe9ac45a75f (Mpsvc.dll)_\n\n_•_ _d55f983c994caa160ec63a59f6b4250fe67fb3e8c43a388aec60a4a6978e9f1e (C:\\kworking\\agent.exe)_\n\n_•_ _0496ca57e387b10dfdac809de8a4e039f68e8d66535d5d19ec76d39f7d0a4402 (MpsVc.dll, MpsVc, mpsvc.dll, MpsVc_._\n_dll)_\n\n_•_ _d8353cfc5e696d3ae402c7c70565c1e7f31e49bcf74a6e12e5ab044f306b4b20 (Mpsvc.dll)_\n\n_•_ _8dd620d9aeb35960bb766458c8890ede987c33d239cf730f93fe49d90ae759dd (Mpsvc.dll)_\n\n_•_ _dc6b0e8c1e9c113f0364e1c8370060dee3fcbe25b667ddeca7623a95cd21411f (Updater.exe)_\n\n_•_ _aae6e388e774180bc3eb96dad5d5bfefd63d0eb7124d68b6991701936801f1c7 (p.exe.TXT)_\n\n_•_ _66490c59cb9630b53fa3fa7125b5c9511afde38edab4459065938c1974229ca8 (svchost.exe)_\n\n_•_ _8e846ed965bbc0270a6f58c5818e039ef2fb78def4d2bf82348ca786ea0cea4f (Revil12_browsingDll.dll)_\n\n_•_ _2093c195b6c1fd6ab9e1110c13096c5fe130b75a84a27748007ae52d9e951643 (agent.crt)_\n\n_•_ _f2d6ef0450660aaae62c429610b964949812df2da1c57646fc29aa51c3f031e (Revil1_browsingExe.exe)_\n\n###### Additional indicators are available here:\n\n_•_ _https://github.com/pgl/kaseya-revil-cnc-domains/blob/main/revil-kaseya-cnc-domains.txt_\n\n_•_ _https://otx.alienvault.com/pulse/60e02f9e498dfdf25caf7753_\n\n_•_ _https://community.sophos.com/b/security-blog/posts/active-ransomware-attack-on-kaseya-customers_\n\n_•_ _https://www.cadosecurity.com/post/resources-for-dfir-professionals-responding-to-the-revil-ransomware-kaseya-sup­_\n_ply-chain-attack_\n\nCado-security provided resources, including IOCs, for DFIR Professionals Responding to the REvil Ransomware Ka­\nseya Attack.\n\n\n-----\n\n##### TTPS (ATT&CK)\n\nExploit Public-Facing Application (T1190)\n\nSupply Chain Compromise: Compromise Software\nSupply Chain (T1195.002)\n\nCommand and Scripting Interpreter: PowerShell\n(T1059.001)\n\nHijack Execution Flow: DLL Side-Loading (T1574.002)\nMasquerading (T1036)\n\nImpair Defenses: Disable or Modify Tools (T1562.001)\n\n\nDeobfuscate/Decode Files or Information (T1140)\n\nIndicator Removal on Host (T1070)\n\nSubvert Trust Controls: Code Signing (T1553.002)\n\nModify Registry (T1112)\n\nData Encrypted for Impact (T1486)\n\n\n###### CONFIDENCE\n HIGH\n\n\n###### REFERENCES\n\n- SEKOIA.IO Investigation\n\n- [Kaseya] Updates Regarding VSA Security\n\nIncident\n\n- [Sophos] Kaseya VSA Supply-Chain Ran­\n\nsomware Attack\n\n- [Sophos] Independence Day: REvil uses\n\nsupply chain exploit to attack hundreds of\nbusinesses\n\n- [DFIR] DFIR Resources REvil Kaseya github\n\nrepository\n\n- [Doublepulsar] Kaseya supply chain attack\n\ndelivers mass ransomware event to US\ncompanies\n\n- [Welivesecurity] Kaseya supply‑chain at­\n\ntack: What we know so far\n\n- [Picus] TTPs Used by REvil (Sodinokibi) Ran­\n\nsomware Gang in Kaseya MSP Supply-Chain\nAttack\n\n\n-----\n\n### NEUTRALIZE THREATS BEFORE THEY DO\n\n###### www.sekoia.io Follow our news\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        }
    ],
    "references": [
        "https://f.hubspotusercontent10.net/hubfs/7095517/FLINT-Kaseya-Another%20Massive%20Heist%20by%20REvil.pdf"
    ],
    "report_names": [
        "FLINT-Kaseya-Another%20Massive%20Heist%20by%20REvil.pdf"
    ],
    "threat_actors": [
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041370,
    "ts_creation_date": 1625756544,
    "ts_modification_date": 1625756550,
    "files": {
        "pdf": "https://archive.orkl.eu/d164a25d51d00fab7f36a58e18cc3d93764a8e52.pdf",
        "text": "https://archive.orkl.eu/d164a25d51d00fab7f36a58e18cc3d93764a8e52.txt",
        "img": "https://archive.orkl.eu/d164a25d51d00fab7f36a58e18cc3d93764a8e52.jpg"
    }
}