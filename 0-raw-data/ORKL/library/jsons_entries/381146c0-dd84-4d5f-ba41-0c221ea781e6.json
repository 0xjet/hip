{
    "id": "381146c0-dd84-4d5f-ba41-0c221ea781e6",
    "created_at": "2023-01-12T15:00:40.535235Z",
    "updated_at": "2025-03-27T02:05:36.234187Z",
    "deleted_at": null,
    "sha1_hash": "0b0418f802d0b001a0921fb02510f4b052acb146",
    "title": "2019-03-01 - Breakdown of a Targeted DanaBot Attack",
    "authors": "",
    "file_creation_date": "2022-05-28T21:59:05Z",
    "file_modification_date": "2022-05-28T21:59:05Z",
    "file_size": 103528,
    "plain_text": "# Breakdown of a Targeted DanaBot Attack\n\n**[fortinet.com/blog/threat-research/breakdown-of-a-targeted-danabot-attack.html](https://www.fortinet.com/blog/threat-research/breakdown-of-a-targeted-danabot-attack.html)**\n\n**_A FortiGuard SE Team Threat Analysis Report_**\n\n\nMarch 1, 2019\n\n\nOn Feb 5th, 2019, the FortiGuard SE team discovered a targeted attack aimed at an\nunknown individual working for a government department in Queensland State in Australia.\nWithin a span of a few days, we had observed additional activity targeting various members\nof this organization, specifically in the form of spearphishing attacks. We can safely surmise\nthat it is very likely that this threat was specifically targeting this organization at this time for\nreasons unknown to us.\n\nThe threat being delivered is known as DanaBot. It is a modular banking Trojan that has\nbeen historically linked to combining operations with other malware operators, such as those\nbehind Gootkit. Other modules associated with DanaBot include remote desktop through\nVNC, information stealing, and keylogging. While it appears that this recent attack may be\nlooking to establish a foothold in the network, the reasons behind this are currently unknown.\n\n**Following the Attack Chain**\n\nThe attack begins with a seemingly innocuous email:\n\nAs can be seen, this email was sent in early February through a legitimate free email service\navailable to everyone. In addition, the sender has not been registered as a spam-related\nemail address, which adds to the analysis that this is a specifically targeted attack.\n\nThe link in the email (hxxp://users.xxxx.com.au/soniamatas/9302030002_993.zip?33505757)\nalso points to an ISP that offers file hosting services.\n\nBased on our telemetry for this server, the DanaBot authors’ method of operation appears to\nbe concentrated in Australia. In this most recent case, it is focused on a .gov.au email\naddress, which coincides with this latest attack.\n\nThe link leads to a zip archive that contains a single .VBS file. Once deobfuscated, a shortcut\nlink to a popular website is created in the temp folder, and after that, the script downloads a\nfile from hxxp://corp.invest.preferredweb.org/dMJbnufMVu.php into the same temp folder and\nnames it as inv.exe.\n\nThis domain has seen a recent surge in activity:\n\n\n-----\n\nAlso, most of the visitors come from Australia.\n\nThe domain itself was recently registered (February 03), as can be observed in the\nscreenshot below.\n\nData shows that while the server was registered through a registrar in the United States, it\nwas ultimately hosted by what appears to be a Russian webhosting service, as evidenced by\nthe Russian name servers.\n\nIt’s clear that the DanaBot authors also follow basic operational security practices, as\nindicated by their low visitor numbers. Aside from sending targeted emails, they also prevent\nanyone outside of Australia from downloading the malware. This may be in hopes of\npreventing security researchers, law enforcement agencies, and other curious onlookers\nfrom finding their campaigns.\n\nIn addition, the threat first contacts certain IP addresses to check for a valid Internet\nconnection. This is a failsafe system for the malware in the very case of it’s being analyzed\n(i.e. sandbox/isolated network) to avoid and thwart further analysis. If there is no connection,\nthe threat will not continue to run.\n\nUpon initiation, Danabot connects to a variety of benign IP addresses belonging to seemingly\nrandomly-selected organizations to see if it is online. Other IP addresses not known to be\nDanabot C2 were not investigated due to time constraints, as well the difficulty of analyzing\nbanking Trojans in the allocated timeframe before publication.\n\n**A New Attack?**\n\nDuring the time of our initial analysis, as early as in the first week of February, the threat itself\nwas completely new. Interestingly, the recorded compilation time of the threat was actually\nahead of the time it was downloaded. This suggests that it is most likely because the threat\nwas compiled in a time zone ahead of the United States.\n\nThe threat can also create a service for persistence purposes, as well as build custom\ndirectories and files to hold collect data. The threat can also inject malware into other\nprocesses, such as winlogon.exe, explorer.exe, and svchost.exe. Functionality on older\n[systems include rootkit capabilities, including the ability to hide newly created services along](https://www.fortinet.com/resources/cyberglossary/rootkit?utm_source=blog&utm_campaign=rootkit)\nwith the directories the threat uses.\n\nUsing a custom tool to reveal hidden services yields the following.\n\nAs mentioned, because of the embedded rootkit, browsing the folder does not reveal\nanything.\n\nHowever, if the folder name is known, it is possible to manually navigate to the DanaBot\ndirectory.\n\n\n-----\n\n**DanaBot Modularity**\n\nBecause of its modularity, DanaBot is known to install different modules, such as a remote\ndesktop through VNC, information stealing, keylogging, and as expected, injecting malware\ninto banking web pages, which ultimately makes it one of the more advanced and evolved\nbanking Trojans.\n\n**Technical Details**\n\n**Overview**\n\n9302030002_993.zip (detected as: VBS/Agent.QQN!tr.dldr )\n\n- Size: 2135 bytes\n\n- MD5: B827896DCA0E874A976595D027E27D0E\n\n- SHA256:\nCE96E325F79BA07871489DB205E9ACA9FAC5AB3C15BDCA60E562CBAB65CC6447\n\n9302030002_993.vbs (detected as: VBS/Agent.QQN!tr.dldr )\n\n- Size: 5294 bytes\n\n- MD5: 1E0E503EF61BCF30CED17777FFD263DE\n\n- SHA256:\n4D542B11FF7B3DFAB52D4C9E64AE209EF9AFBDFCEA1910CA24815EEC54944F21\n\ninv.exe (detected as: W32/Generic.AC.4399AE!tr )\n\n- Size: 455168 bytes\n\n- MD5: 75FD221DEA39A4AEA27998F4FB071041\n\n- SHA256:\n1991548C135E4653CD18F969102A3225661AE70102AC7C3D5FF8A69E75FFB644\n\n- creates %temp%\\inv.dll\n\ninv.dll (detected as: W32/Danabot.I!tr )\n\n- Size: 286224 bytes\n\n- MD5: AB2C3D293C442C351A0B04CE9F4DEA3F\n\n- SHA256:\nF2EA70B5131E88D8B9B354D618E03B35A2B3FFE980CF6B871E1BE3A88625BFE9\n\n**MITRE ATT&CK – Tactics and Techniques**\n\nThis analysis shows how DanaBot functionality maps to the MITRE ATT&CK model.\n\n**ATT&CK TTP Summary**\n\n**Initial Access**\n\n\n-----\n\nSpearphishing – a link is provided in the email that points to an archive containing a\nmalicious VBS script to continue on to the next stage of infection.\n\n**Execution**\n\nRegsvr32 – DanaBot file\nRundll32 – DanaBot file\nScripting – VBS file\nService Execution – custom startup service\nUser Execution – phishing link, unzipping archive, executing VBS file\n\n**Persistence**\n\nHidden Files and Directories – DanaBot files\nNew Service – execute on startup\n\n**Privilege Escalation**\n\nNew Service – rootkit\n\n**Defense Evasion**\n\nHidden Files and Directories – Danabot files\nObfuscated Files or Information – data files, keylogging file\nProcess Injection – explorer, winlogon, services, browser\nRootkit – hiding files, directories, custom service\nRundll32 – launching DanaBot dll\nScripting - VBS\n\n**Discovery**\n\nProcess Discovery – For injection\n\n**Exfiltration**\n\nData Encrypted – SSL + custom\nExfiltration over Command and Control Channel – SSL port 443\n\n**Command and Control**\n\nCommonly Used Port – TCP port 443\nStandard Application Layer Protocol – HTTPS\n\n**Known Defenses and Mitigations**\n\n\n-----\n\n**Initial Access: FortiMail or other mail solutions can be used to block specific file types.**\nFortiMail can also be configured to send attachments to the FortiSandbox solution (ATP)\neither on-premise or in the cloud to determine if a file displays malicious behavior. FortiGate\nfirewalls with Anti-Virus enabled alongside a valid subscription will detect and block this\nthreat if configured to do so.\n\n**Execution: User Awareness Training – Since it has been observed that this threat has been**\ndelivered via spearphishing distribution mechanisms, it is crucial that end users within an\norganization are made aware of various types of attacks delivered via this method. This can\nbe accomplished through regularly occurring training sessions and impromptu tests using\npredetermined templates by internal security departments within an organization. Simple\nuser awareness training on how to spot emails with malicious attachments or links could stop\nthe initial access into the network. If user awareness training fails, and the user opens the\nattachment or link, FortiClient running with the latest up to date virus signatures will detect\nand block files associated with this threat. The files analyzed in this report are detected as\nVBS/Agent.QQN!tr.dldr, W32/Generic.AC.4399AE!tr, W32/Danabot.I!tr.\n\n**Exfiltration & C&C: FortiGates located in all your ingress and egress points with the Web**\nFiltering service enabled and up-to-date definitions and or Botnet Security will detect and\nblock any observable outbound connections if configured correctly.\n\nIt is important to note that attacks continue to become more sophisticated and can\nsometimes circumvent your security defenses for a number of reasons. This is why it is\nimportant to ensure you have the ability to detect anomalous activity that could be malicious.\nLastly, our Enterprise Bundle will address this attack as well as others. Our Enterprise\nBundle consolidates all the cyber security services you need to protect and defend against\nall the cyber-attack channels from the endpoint to the cloud, including IoT devices, providing\nyou the integrated defense to tackle today’s advanced threats. Including the technologies\nneeded to address today's challenging risk, compliance, management, and visibility and\nOperational Security (OT) concerns.\n\n**Indicators Of Compromise (IOCs)**\n\n_DanaBot only contacts the IP addresses listed below to determine its online status. These_\n_addresses appear to have been selected randomly, and it is important to emphasize that_\n_there is no indication of any vulnerabilities or exploits associated with these addresses or the_\n_DanaBot malware whatsoever. However, by identifying some or all of this list of addresses in_\n_your outbound records, you could potentially validate whether or not your organization have_\n_been infected by this malware._\n\n91.112.46.201:443\n\n52.245.17.2:443\n\n61.165.173.178:443\n\n\n-----\n\n26.64.30.13:443\n\n38.229.153.189:443\n\n61.184.194.124:443\n\n89.144.25.243:443\n\n93.145.247.149:443\n\n140.155.223.170:443\n\n147.28.140.161:443\n\n171.16.126.45:443\n\n178.209.51.211:443\n\n192.71.249.51:443\n\n226.188.219.5:443\n\n234.53.54.120:443\n\nNOTE: The FortiGuard Labs team has shared our findings, including file samples and\nindicators of compromise, in this report with our fellow Cyber Threat Alliance members. CTA\nmembers use this intelligence to rapidly deploy protections to their customers and to\nsystematically disrupt malicious cyber actors. For more information on the Cyber Threat\nAlliance, visit cyberthreatalliance.org.\n\n_[Learn more about FortiGuard Labs and the FortiGuard Security Services portfolio.](https://www.fortinet.com/fortiguard/threat-intelligence/threat-research.html?utm_source=nreleaseblog&utm_campaign=2018-q2-fortiguardlabs-cta)_ _Sign_\n_up for our weekly FortiGuard Threat Brief._\n\n_Know your vulnerabilities – get the facts about your network security. A_ _Fortinet Cyber Threat_\n_Assessment can help you better understand: Security and Threat Prevention, User_\n_Productivity, and Network Utilization and Performance._\n\n_[Read about the FortiGuard Security Rating Service, which provides security audits and best](https://www.fortinet.com/support-and-training/support-services/fortiguard-security-subscriptions/security-rating.html?utm_source=blog&utm_campaign=2018-blog-security-rating-service)_\n_practices._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-01 - Breakdown of a Targeted DanaBot Attack.pdf"
    ],
    "report_names": [
        "2019-03-01 - Breakdown of a Targeted DanaBot Attack.pdf"
    ],
    "threat_actors": [
        {
            "id": "5c13338b-eaed-429a-9437-f5015aa98276",
            "created_at": "2022-10-25T16:07:23.582715Z",
            "updated_at": "2025-03-27T02:02:09.875151Z",
            "deleted_at": null,
            "main_name": "Emissary Panda",
            "aliases": [
                "APT 27",
                "ATK 15",
                "Bronze Union",
                "Budworm",
                "Earth Smilodon",
                "Emissary Panda",
                "Group 35",
                "Iron Taurus",
                "Iron Tiger",
                "LuckyMouse",
                "Operation DRBControl",
                "Operation Iron Tiger",
                "Operation PZChao",
                "Operation SpoiledLegacy",
                "Operation StealthyTrident",
                "Red Phoenix",
                "TEMP.Hippo",
                "TG-3390",
                "ZipToken"
            ],
            "source_name": "ETDA:Emissary Panda",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Agent.dhwf",
                "AngryRebel",
                "Antak",
                "CHINACHOPPER",
                "China Chopper",
                "Destroy RAT",
                "DestroyRAT",
                "FOCUSFJORD",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HTTPBrowser",
                "HTran",
                "HUC Packet Transmit Tool",
                "HighShell",
                "HttpBrowser RAT",
                "HttpDump",
                "HyperBro",
                "HyperSSL",
                "HyperShell",
                "Kaba",
                "Korplug",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Moudour",
                "Mydoor",
                "Nishang",
                "OwaAuth",
                "PCRat",
                "PlugX",
                "ProcDump",
                "PsExec",
                "RedDelta",
                "SEASHARPEE",
                "Sensocode",
                "SinoChopper",
                "Sogu",
                "SysUpdate",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Token Control",
                "TokenControl",
                "TwoFace",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Xamtrav",
                "ZXShell",
                "gsecdump",
                "luckyowa"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535640,
    "ts_updated_at": 1743041136,
    "ts_creation_date": 1653775145,
    "ts_modification_date": 1653775145,
    "files": {
        "pdf": "https://archive.orkl.eu/0b0418f802d0b001a0921fb02510f4b052acb146.pdf",
        "text": "https://archive.orkl.eu/0b0418f802d0b001a0921fb02510f4b052acb146.txt",
        "img": "https://archive.orkl.eu/0b0418f802d0b001a0921fb02510f4b052acb146.jpg"
    }
}