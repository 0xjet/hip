{
    "id": "cdf6c8ce-e687-4027-8530-d0b208d3e5e1",
    "created_at": "2023-01-12T14:59:09.622581Z",
    "updated_at": "2025-03-27T02:05:40.29695Z",
    "deleted_at": null,
    "sha1_hash": "9c92fd70c2243f768159c1c82ab0fb17f5c47d6b",
    "title": "2022-02-03 - QR codes on Twitter deliver malicious Chrome extension",
    "authors": "",
    "file_creation_date": "2022-05-28T02:22:51Z",
    "file_modification_date": "2022-05-28T02:22:51Z",
    "file_size": 1218616,
    "plain_text": "# QR codes on Twitter deliver malicious Chrome extension\n\n**[gdatasoftware.com/blog/2022/01/37236-qr-codes-on-twitter-deliver-malicious-chrome-extension](https://www.gdatasoftware.com/blog/2022/01/37236-qr-codes-on-twitter-deliver-malicious-chrome-extension)**\n\n02/03/2022\n\nG DATA Blog\nISO file downloads are advertised via QR codes on Twitter and on supposedly free gaming\nsites, but they don't contain what they promise.\n\n## QR codes on Twitter and malvertising\n\n[The loader for the malicious Chrome extension was initially analysed by @x3ph1 who dubbed](https://twitter.com/x3ph1/status/1480385761295970305)\nit ChromeLoader. To avoid misunderstandings with legitimate Chrome components we hereby\nrefer to it as Choziosi loader. [The analysis on the loader is detailed but x3ph1 does not](https://github.com/xephora/Threat-Remediation-Scripts/tree/main/Threat-Track/CS_INSTALLER)\ndescribe the Chrome extension Choziosi, which got me intrigued.\n\nTwitter user [@th3_protoCOL found QR codes that circulate on Twitter and advertise pirated](https://twitter.com/th3_protoCOL/status/1480621526764322817)\nsoftware to lure people into downloading an ISO. Reddit users also complain about malicious\n[ISO files on websites that provide Steam games. This tweet by @StopMalvertisin says the](https://twitter.com/StopMalvertisin/status/1480972727225761794)\nISOs are downloaded via malicious advertisments.\n\n\n-----\n\nTwitter QR\n\n\ncodes promoting pirated software with Choziosi loader (click to enlarge)\n\n\n-----\n\nReddit user complaining that the infection regularly shuts down Chrome (click to enlarge)\nThe ISO file[3] has two main components. The _meta.txt contains a PowerShell script, which is\nencrypted with a substitution cipher. The downloader.exe[2] is a .NET assembly. It has a big\ndictionary with the substitution alphabet to decrypt the PowerShell script[4] in _meta.txt. It adds\nthe PowerShell commands as scheduled task named ChromeTask which runs every ten\nminutes.\n\n[Other variants of the same malware use dictionaries to combine words into a task name. The](https://twitter.com/x3ph1/status/1481454967617896450)\ndownloader.exe also shows an error message to the user, claiming that the operating system\nis incompatible with the program.\n\n\n-----\n\ndownloader.exe schedules a task named ChromeTask which executes PowerShell\nThe PowerShell script downloads the Chrome extension archive.zip[1] from a malware server\nand installs it. Due to the scheduled task this continues to happen every ten minutes. This\nexplains why some Reddit users complain that Chrome closes itself all the time. This is a\nmishap of the malware developer because the annoyance factor will make it more likely that\naffected users clean their system as soon as possible.\n\n## Malicious Chrome extension\n\nThe Chrome extension itself has not been analysed yet. Possibly because of its hefty\nobfuscation. While trying to debug the extension within Chrome, I already noticed that the\nextension settings chrome://extensions are redirected to the general settings\n**chrome://settings. This prevents users from uninstalling the extension within Chrome.**\n\nThe extension consists of four files. The application icon is called properties.png and shows a\ngearwheel. The manifest.json is part of every Chrome extension and has some metadata,\ne.g., about the icon location, extension name and permissions. The config.js contains the\nname of the extension, version number, C2 server and some form of id named _dd which is\nalways sent as parameter to the server.\n\nThe main script is the background.js. It features control flow obfuscation via switch-case\nstatement hopping which cannot be deobfuscated automatically by currently available tools.\n[JavaScript Deobfuscator is able to perform intial cleanup, but the code remains unreadable.](https://deobfuscate.io/)\nAfter identifying v0MM.T7 and v0MM.o7 as the ancor points for function string decoding, I\nreplaced the calls to these functions with their return value. A second pass to JavaScript\nDeobfuscator and manual cleanup of now unneeded functions leads to the final deobfuscated\ncode[5].\n\n\n-----\n\nControl flow obfuscation via switch-case hopping (click to enlarge)\n\n\n-----\n\nDeobfuscated code, search hijacking function (click to enlarge)\nThe extension's main functionality is to serve advertisments and hijack search requests to\nGoogle, Yahoo and Bing. Every three hours analytics are sent to the C2. The extension\nrequests advertisments from the C2 server every 30 minutes.\n\nThe following image shows the extension's request to the C2 server in the first line and the\nserver response in the second. The server provided a direct download link for a legitimate\nsoftware product.\n\nfirst line: request to the server; second line: server response with a legitimate download link.\n\n## Conclusion\n\nWhen I started to work on this, I had admittedly other expectations on the malware's\nfunctionality. For now the only purpose is getting revenue via unsolicited advertisments and\nsearch engine hijacking. But loaders often do not stick to one payload in the long run and\nmalware authors improve their projects over time. We will likely see more of this threat in the\nfuture.\n\n\n-----\n\n## File hashes\n\nAll mentioned files, including the decoded and deobfuscated files, are available for download\non [MalwareBazaar.](https://bazaar.abuse.ch/browse/tag/Choziosi/)\n\n**Description** **SHA256**\n\n\n\n[1] Chrome\nextension\n\n[2]\ndownload.exe,\n.NET file\n\n\n6b1db4f891aa9033b615978a3fcfef02f1904f4eba984ba756ff5cd755d6f0b4\n\n2d4454d610ae48bf9ffbb7bafcf80140a286898a7ffda39113da1820575a892f\n\n\n\n[3] ISO 8840f385340fad9dd452e243ad1a57fb44acfd6764d4bce98a936e14a7d0bfa6\n\n\n\n[4] Decrypted\nPowerShell\nscript\n\n[5]\nDeobfuscated\nbackground.js\n\n**Karsten Hahn**\nMalware Analyst\n\n\n2e958f481828ce7c59a3beab2ddac5561347e6f9bc25e6716c4524b845e83938\n\n1c0254f0f811aadd6f1dad1cc5926f6b32fa2fb0866c35bf6a9f3dfad25fd9ca\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-02-03 - QR codes on Twitter deliver malicious Chrome extension.pdf"
    ],
    "report_names": [
        "2022-02-03 - QR codes on Twitter deliver malicious Chrome extension.pdf"
    ],
    "threat_actors": [
        {
            "id": "81bd7107-6b2d-45c9-9eea-1843d4b9b308",
            "created_at": "2022-10-25T15:50:23.320841Z",
            "updated_at": "2025-03-27T02:00:55.441723Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Gamaredon Group",
                "IRON TILDEN",
                "Primitive Bear",
                "ACTINIUM",
                "Armageddon",
                "Shuckworm",
                "DEV-0157",
                "Aqua Blizzard"
            ],
            "source_name": "MITRE:Gamaredon Group",
            "tools": [
                "QuietSieve",
                "Pteranodon",
                "PowerPunch"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d5156b55-5d7d-4fb2-836f-861d2e868147",
            "created_at": "2023-01-06T13:46:38.557326Z",
            "updated_at": "2025-03-27T02:00:02.861124Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Aqua Blizzard",
                "Actinium",
                "DEV-0157",
                "Blue Otso",
                "G0047",
                "PRIMITIVE BEAR",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder",
                "ACTINIUM",
                "BlueAlpha",
                "IRON TILDEN"
            ],
            "source_name": "MISPGALAXY:Gamaredon Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "61940e18-8f90-4ecc-bc06-416c54bc60f9",
            "created_at": "2022-10-25T16:07:23.659529Z",
            "updated_at": "2025-03-27T02:02:09.912404Z",
            "deleted_at": null,
            "main_name": "Gamaredon Group",
            "aliases": [
                "Actinium",
                "Aqua Blizzard",
                "Armageddon",
                "Blue Otso",
                "BlueAlpha",
                "Callisto",
                "DEV-0157",
                "Iron Tilden",
                "Operation STEADY#URSA",
                "Primitive Bear",
                "SectorC08",
                "Shuckworm",
                "Trident Ursa",
                "UAC-0010",
                "Winterflounder"
            ],
            "source_name": "ETDA:Gamaredon Group",
            "tools": [
                "Aversome infector",
                "BoneSpy",
                "DessertDown",
                "DilongTrash",
                "DinoTrain",
                "EvilGnome",
                "FRAUDROP",
                "Gamaredon",
                "GammaDrop",
                "GammaLoad",
                "GammaSteel",
                "Gussdoor",
                "ObfuBerry",
                "ObfuMerry",
                "PlainGnome",
                "PowerPunch",
                "Pteranodon",
                "Pterodo",
                "QuietSieve",
                "Remote Manipulator System",
                "Resetter",
                "RuRAT",
                "SUBTLE-PAWS",
                "UltraVNC"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535549,
    "ts_updated_at": 1743041140,
    "ts_creation_date": 1653704571,
    "ts_modification_date": 1653704571,
    "files": {
        "pdf": "https://archive.orkl.eu/9c92fd70c2243f768159c1c82ab0fb17f5c47d6b.pdf",
        "text": "https://archive.orkl.eu/9c92fd70c2243f768159c1c82ab0fb17f5c47d6b.txt",
        "img": "https://archive.orkl.eu/9c92fd70c2243f768159c1c82ab0fb17f5c47d6b.jpg"
    }
}