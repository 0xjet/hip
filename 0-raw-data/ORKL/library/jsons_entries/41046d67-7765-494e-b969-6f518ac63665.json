{
    "id": "41046d67-7765-494e-b969-6f518ac63665",
    "created_at": "2023-01-12T15:00:10.791602Z",
    "updated_at": "2025-03-27T02:17:23.186681Z",
    "deleted_at": null,
    "sha1_hash": "6cd58cc495249903e1066cef892793b5e3650f3c",
    "title": "2022-05-03 - The Hermit Kingdom’s Ransomware play",
    "authors": "",
    "file_creation_date": "2022-05-27T21:28:08Z",
    "file_modification_date": "2022-05-27T21:28:08Z",
    "file_size": 584179,
    "plain_text": "# The Hermit Kingdom’s Ransomware play\n\n**[trellix.com/en-us/about/newsroom/stories/threat-labs/the-hermit-kingdoms-ransomware-play.html](https://www.trellix.com/en-us/about/newsroom/stories/threat-labs/the-hermit-kingdoms-ransomware-play.html)**\n\n## Stories\n\nThe latest cybersecurity trends, best practices,\n\nsecurity vulnerabilities, and more\n\nBy [Christiaan Beek · May 3, 2022](https://www.trellix.com/en-us/about/newsroom/stories/contributors/christiaan-beek.html)\n\n(With a special thanks to @ValidHorizon who helped and shared information)\n\nIn February 2016, news broke about what is now known as the ‘Bangladesh Bank Heist’.\nHackers attempted to transfer nearly one billion USD through the SWIFT system towards\nrecipients at other banks. The investigation, performed by several US agencies, lead to a\nNorth Korean actor, dubbed ‘Hidden Cobra’. Ever since then, the group has been active,\ncompromising numerous victims. One notable case is at a Taiwanese bank where\nransomware was used to distract the incident response team, allowing the actor to transfer\nfunds to other bank accounts in the APAC region.\n\n\n-----\n\nHidden Cobra and other groups named by the industry are part of North Korea s cyberarmy. The cyber-army of North Korea has been divided in several units, all of which have\ndifferent tasks and report to ‘Bureau (or Lab) 121’. The unit responsible for the attacks on\nforeign financial systems, including banks and cryptocurrency exchanges, is Unit 180,\nwhich is also known as APT38. While domestic nuclear and missile programs are funded\nwith stolen money, the actors of Unit 180 mostly reside in overseas countries such as\nChina, Russia, Malaysia, Thailand, Bangladesh, Indonesia, India, Kenya, and Mozambique.\nThe varying geographical locations are likely an attempt to conceal the unit’s link to the\n[hermit kingdom that is North Korea. It’s also important to note defectors have exposed that](https://www.bloomberg.com/news/features/2018-02-07/inside-kim-jong-un-s-hacker-army)\nobtaining funds for the government is done by more actors than the country’s ‘elite hackers’.\n\nOver time we have observed several methods North Korea has used to gain money.\nAlthough not as frequently observed as other groups, there have also been attempts made\nto step into the world of ransomware.\n\nWhile ransomware is mostly a cybercriminal play, in March 2020, a new malware family\nsurfaced called ‘VHD ransomware’. Another day, another ransomware family. So, what is\nnew? Many in the industry attributed the VHD ransomware to DPRK hackers. It was\ndistributed using the MATA framework, which has been attributed to the hermit kingdom.\nThe ransomware itself contained enough unique artifacts to also link it to said kingdom.\n\n[Around that time, we conducted joint research with regards to code similarity in DPRK’s](https://www.intezer.com/blog/research/examining-code-reuse-reveals-undiscovered-links-among-north-koreas-malware-families/)\nmalware. In this blog, we continue this research by looking at the VHD ransomware’s codesimilarity, artifact similarity, graph science, and Bitcoin addresses and transfers.\n\n**Let’s go hunting**\n\nUsing the source-code of the VHD ransomware family, several interesting function blocks\nwere identified as potential candidates for reusage. Why rebuild the whole car while you still\nhave usable parts? Using those blocks as a starting point, a hunt was started from March\n2020 onwards to discover related families.\n\nThe initial results were promising, and with a bit of filtering and the removal of false\npositives, the following families were identified:\n\nBEAF ransomware\nPXJ ransomware\nZZZZ ransomware\nCHiCHi ransomware\n\nAside from the code-similarity hunting, reports also mentioned the spread of the ‘Tflower\nransomware’ family via the aforementioned MATA framework. Another observation is that\nthe four letters of the ransomware “BEAF” (BEAF is the extension used for the encrypted\nfiles), are exactly the same first four bytes of the handshake of APT38’s tool known as\nBeefeater.\n\n\n-----\n\n**Code similarity**\n\nUsing tools like BinDiff, we started to compare the ransomware families from a code\nperspective, as is shown in the figure below.\n\nFigure 1\n\nCode Similarity based on code blocks and functions\n\nThis graph shows three families which share a significant amount of code with the VHD\nsource code. The ZZZZ ransomware is almost an exact clone of the Beaf ransomware\nfamily. The Tflower and ChiChi families do share some little code with VHD, but that would\nbe more generic functions than typical shared code and functionality, hence we did not\nvisualize that.\n\n**Code visualization**\n\nThere are several ways of looking at code, one of which entails visualizing the code and\ncomparing the images. One way to visualize data, is by creating a Hilbert curve mapping,\nwhich is used to map a string of data into an alternate dimensional space. Generating the\ngraphics for the six families results in the following overview:\n\n\n-----\n\nFigure 2 Hilbert curve graphs\n\nYou don’t have to be a malware specialist to immediately recognize that the ZZZ and BEAF\nRansomware pictures are almost identical. It also becomes apparent that both Tflower and\nChiChi are vastly different when compared to VHD.\n\nIn the code-similarity comparison between the code blocks, several overlaps were found.\nComparing the Hilbert curves of these families, similar patterns are now visualized.\n\nFigure 3 Hilbert curve similarity\n\nWhile comparing the content of the ransomware notes, the email address\nSemenov[.]akkim@protonmail[.]com was present in samples of both the ‘CHiCHi’ and\n‘ZZZZ’ ransomware families.\n\n**Follow the money**\n\n\n-----\n\nThe families we investigated were not widespread and seemed to be directed at specific\ntargets in the APAC region. Besides some reports, not much is known about the victims as\nthere were no leak pages or negotiation chats, which are now common for groups to utilize.\n\nTo understand if we could discover financial trails with an overlap between the families, we\nextracted the Bitcoin (BTC) wallet addresses and started tracing and monitoring the\ntransactions.\n\nFigure 4 BTC transaction example of VHD ransomware\nWe did not find any overlap in transfer wallets between the families. We did find, however,\nthat the paid ransom amounts were relatively small. For example, a transaction of 2.2 BTC\nin mid-2020 was worth around 20K USD. It was transferred multiple times through\nDecember 2020. At that time, a transaction took place towards a bitcoin exchange to either\ncash out (as the value had roughly doubled) or exchange for a different and less traceable\ncryptocurrency.\n\n**Summary**\n\nOver the last few years, we have followed DPRK attacks on financial institutions. Besides\nglobal banks, blockchain providers and users from South Korea were also attacked and\ninfiltrated using spear-phishing emails, fake mobile applications, and even fake companies.\nSince these attacks were predominantly observed targeting the APAC region with targets in\nJapan and Malaysia for example, we anticipate these attacks might have been executed to\ndiscover if ransomware is a valuable way of gaining income.\n\nWe suspect the ransomware families described in this blog are part of more organized\nattacks. Based on our research, combined intelligence, and observations of the smaller\ntargeted ransomware attacks, Trellix attributes them to DPRK affiliated hackers with high\nconfidence.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-05-03 - The Hermit Kingdom’s Ransomware play.pdf"
    ],
    "report_names": [
        "2022-05-03 - The Hermit Kingdom’s Ransomware play.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "32a223a8-3c79-4146-87c5-8557d38662ae",
            "created_at": "2022-10-25T15:50:23.703698Z",
            "updated_at": "2025-03-27T02:00:55.528031Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Lazarus Group",
                "Labyrinth Chollima",
                "HIDDEN COBRA",
                "Guardians of Peace",
                "NICKEL ACADEMY",
                "Diamond Sleet"
            ],
            "source_name": "MITRE:Lazarus Group",
            "tools": [
                "RawDisk",
                "Proxysvc",
                "BADCALL",
                "FALLCHILL",
                "WannaCry",
                "HOPLIGHT",
                "TYPEFRAME",
                "Dtrack",
                "HotCroissant",
                "HARDRAIN",
                "Dacls",
                "KEYMARBLE",
                "TAINTEDSCRIBE",
                "AuditCred",
                "netsh",
                "ECCENTRICBANDWAGON",
                "AppleJeus",
                "BLINDINGCAN",
                "ThreatNeedle",
                "Volgmer",
                "Cryptoistic",
                "RATANKBA",
                "Bankshot",
                "Torisma",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "9e767b38-12ae-4ef7-9878-5ce1701066d7",
            "created_at": "2024-05-01T02:03:08.131819Z",
            "updated_at": "2025-03-27T02:05:17.413497Z",
            "deleted_at": null,
            "main_name": "NICKEL ACADEMY",
            "aliases": [
                "COVELLITE ",
                "CTG-2460 ",
                "Diamond Sleet ",
                "Guardians of Peace",
                "HIDDEN COBRA ",
                "High Anonymous",
                "Labyrinth Chollima ",
                "NNPT Group",
                "New Romanic Cyber Army Team",
                "Temp.Hermit ",
                "The Lazarus Group ",
                "UNC577 ",
                "Who Am I?",
                "Whois Team",
                "ZINC ",
                "Black Artemis "
            ],
            "source_name": "Secureworks:NICKEL ACADEMY",
            "tools": [
                " DarkMessenger",
                " Destover",
                " Duuzer",
                " HOPLIGHT",
                " Joanap",
                " KorHigh",
                " LiveJinx",
                " Volgmer",
                "Brambul"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535610,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1653686888,
    "ts_modification_date": 1653686888,
    "files": {
        "pdf": "https://archive.orkl.eu/6cd58cc495249903e1066cef892793b5e3650f3c.pdf",
        "text": "https://archive.orkl.eu/6cd58cc495249903e1066cef892793b5e3650f3c.txt",
        "img": "https://archive.orkl.eu/6cd58cc495249903e1066cef892793b5e3650f3c.jpg"
    }
}