{
    "id": "f69e6502-d6bd-41d0-97d2-a46d104c7b78",
    "created_at": "2023-01-12T15:01:39.974804Z",
    "updated_at": "2025-03-27T02:06:12.795665Z",
    "deleted_at": null,
    "sha1_hash": "805d03417b5a4cf19494b8f1b4d9573c1f3d8ccf",
    "title": "2014-04-15 - Trojan banking",
    "authors": "",
    "file_creation_date": "2022-05-29T10:37:07Z",
    "file_modification_date": "2022-05-29T10:37:07Z",
    "file_size": 191246,
    "plain_text": "# Trojan banking 47d18761d46d8e7c4ad49cc575b0acc2bb3f49bb56a3d29fb1ec600447cb89a4\n\n**[zairon.wordpress.com/2014/04/15/trojan-banking-47d18761d46d8e7c4ad49cc575b0acc2bb3f49bb56a3d29fb1ec600447cb89a4/](https://zairon.wordpress.com/2014/04/15/trojan-banking-47d18761d46d8e7c4ad49cc575b0acc2bb3f49bb56a3d29fb1ec600447cb89a4/)**\n\nApril 15, 2014\n\nTwo days ago I blogged about the approach I used to start analysing the malware, today I spent some more time on\n[the target trying to get an idea of its behaviours. According to VirusTotal the file has a 21/51 revelation rate, it was 6/51](https://www.virustotal.com/it/file/47d18761d46d8e7c4ad49cc575b0acc2bb3f49bb56a3d29fb1ec600447cb89a4/analysis/1397566915/)\nsix days ago.\n\nIt has been designed for the Asian part of the world and, among all the malicious features, I noted an interesting data\nexchanges between the infected machine and a server behind 192.74.241.104/192.74.241.105 addresses.\n\n**From server to infected machine**\n\nGet\n\nFile plus.php is saved inside the infected machine. Wireshark marks the new file as an “application/zip” file, and I have\nto admit that at a first glance I thought the same thing:\n\nMisleading header\n\nI was wrong, the file is a not valid archive. To better understand what kind of file is this I put my hands on a debugger.\nAll the bytes starting from offset 0x68 are decrypted by a simple piece of code:\n```\n10007F10 decrypt_part_of_the_downloaded_file:\n10007F10 mov eax, ecx\n10007F12 push 2\n10007F14 cdq\n10007F15 pop edi\n10007F16 idiv edi\n10007F18 test edx, edx\n10007F1A jz short loc_10007F22\n10007F1C add byte ptr [ecx+esi], 3Ah\n10007F20 jmp short loc_10007F26\n10007F22 add byte ptr [ecx+esi], 4Bh\n10007F26 inc ecx\n10007F27 cmp ecx, [ebp+var_4]\n10007F2A jl short decrypt_part_of_the_downloaded_file\n\n```\nIt’s basically decrypted by an add operation, but the result is something I didn’t expect, here is a small part of the\nentire file:\n\n\n-----\n\nThe file is moved under “C:\\Windows\\System32\\drivers\\etc” directory with the new name hosts.ics. It seems to be the\n[same list described inside three articles by Nshc Security. You can find the mentioned pdf report files inside the Red](http://www.nshc.net/wp/consulting-eng/)\nAlert Reports section:\n– Internet Bank Pharming – BlackMoon\n– Internet Bank Pharming with CVE-2013-3897\n– Internet Banking Malware\nThe malware I’m checking has a lot of common things with the samples used to write the reports: it deletes antivirus\nexe related files, use a link file to run the malware at startup, create the hosts.ics file, steal certificates searching for\nNPKI folders sending them to a specific server in an encrypted format.\nOn the other hand the infection has slightly changed: dll file runs from rundll32 camouflaged into ctfmon.exe and not\ncsrss.exe, start link has a different name V2LiteExp (the name comes from AhnLab V3 Internet Security suite),\nplus.php file is available in the recent samples only. Little things of course, but these are relevant in the removal\nprocess.\n\n**From infected machine to server**\n\nSend\n\nA series of bytes are sent away, what’s behind this obscure sequence?\nAgain, a simple xor encryption is used to hide the real information to send. The message in clear view contains some\nstrings revealing info about the infected machine and the infection itself:\n– processor type, something like “Intel(R) Core(TM) i7-3770K CPU @ 3.50GHz”\n– physical free memory : “3584 MB”\n– running OS: “Win XP SP2”\n– date of infection: “20140415”\n– location of hosts file: “http://192.74.241.104:805/plus.php”\nThese information are sent following a precise time line.\n**192.74.241.104 and 192.74.241.105**\nThese addresses are under “PEG TECH INC” organization. There are many spam related complaints around the web\nfrom this organization, pay attention to 192.74.241.96/192.74.241.111 range addresses.\nTo end this post, look at the advice of a company named PegTech.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2014/2014-04-15 - Trojan banking.pdf"
    ],
    "report_names": [
        "2014-04-15 - Trojan banking.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535699,
    "ts_updated_at": 1743041172,
    "ts_creation_date": 1653820627,
    "ts_modification_date": 1653820627,
    "files": {
        "pdf": "https://archive.orkl.eu/805d03417b5a4cf19494b8f1b4d9573c1f3d8ccf.pdf",
        "text": "https://archive.orkl.eu/805d03417b5a4cf19494b8f1b4d9573c1f3d8ccf.txt",
        "img": "https://archive.orkl.eu/805d03417b5a4cf19494b8f1b4d9573c1f3d8ccf.jpg"
    }
}