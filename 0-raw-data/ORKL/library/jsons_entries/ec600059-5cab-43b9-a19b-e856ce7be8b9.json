{
    "id": "ec600059-5cab-43b9-a19b-e856ce7be8b9",
    "created_at": "2023-01-12T15:08:16.21963Z",
    "updated_at": "2025-03-27T02:17:11.652225Z",
    "deleted_at": null,
    "sha1_hash": "22d7131de4df3fbe424bf71b894773f8e641634f",
    "title": "2015-02-04 - Pawn Storm Update- iOS Espionage App Found",
    "authors": "",
    "file_creation_date": "2022-05-28T21:38:50Z",
    "file_modification_date": "2022-05-28T21:38:50Z",
    "file_size": 169784,
    "plain_text": "# Pawn Storm Update: iOS Espionage App Found\n\n**[blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-ios-espionage-app-found/](https://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storm-update-ios-espionage-app-found/)**\n\nFebruary 4, 2015\n\n_Updated February 6, 2015, 10:30 AM PST_ [Trend Micro™ Mobile Security protects users' iOS](https://blog.trendmicro.com/en_us/forHome/products/mobile-security.html)\ndevices and stops threats before they reach them. Trend Micro Mobile Security offers\nprotection and detects these malware using the cloud-based Smart Protection\nNetwork™ and Mobile App Reputation technology.\n\n_Updated February 11, 2015, 7:52 PM PST In a previous version of this blog posting, we_\nstated that the iOS device doesn’t have to be jailbroken per se for the malware to be\ninstalled. We revisited this finding and found that the iOS device indeed needs to be\njailbroken. The exact way how the actors install the espionage malware on iOS devices is\ncurrently unknown to us. It is very likely that social engineering is an important part.\n\nIn our continued research on Operation Pawn Storm, we found one interesting poisoned\npawn—spyware specifically designed for espionage on iOS devices. While spyware targeting\nApple users is highly notable by itself, this particular spyware is also involved in a targeted\nattack.\n\n**Background of Operation Pawn Storm**\n\n[Operation Pawn Storm is an active economic and political cyber-espionage operation that](http://www.trendmicro.com/vinfo/tmr/?/us/security/news/cyber-attacks/pawn-storm-espionage-attacks-use-decoys-deliver-sednit)\ntargets a wide range of entities, like the military, governments, defense industries, and the\nmedia. The actors of Pawn Storm tend to first move a lot of pawns in the hopes they come\nclose to their actual, high profile targets. When they finally successfully infect a high profile\ntarget, they might decide to move their next pawn forward: advanced espionage malware.\n\n\n-----\n\nThe iOS malware we found is among those advanced malware. We believe the iOS malware\ngets installed on already compromised systems, and it is very similar to next stage SEDNIT\nmalware we have found for Microsoft Windows’ systems. We found two malicious iOS\napplications in Operation Pawn Storm. One is called XAgent (detected as IOS_XAGENT.A)\nand the other one uses the name of a legitimate iOS game, MadCap (detected as IOS_\nXAGENT.B). After analysis, we concluded that both are applications related to SEDNIT. The\nobvious goal of the SEDNIT-related spyware is to steal personal data, record audio, make\nscreenshots, and send them to a remote command-and-control (C&C) server. As of this\npublishing, the C&C server contacted by the iOS malware is live.\n\n**Analysis of XAgent**\n\nThe XAgent app is fully functional malware. After being installed on iOS 7, the app’s icon is\nhidden and it runs in the background immediately. When we try to terminate it by killing the\nprocess, it will restart almost immediately. Installing the malware into an iOS 8 device yields\ndifferent results. The icon is not hidden and it also cannot restart automatically. This suggests\nthat the malware was designed prior to the release of iOS 8 last September 2014.\n\n**Data Theft Capabilities**\n\nThe app is designed to collect all kind of information on an iOS device. It is able to perform\nthe following routines:\n\nCollect text messages\nGet contact lists\nGet pictures\nCollect geo-location data\nStart voice recording\nGet a list of installed apps\nGet a list of processes\nGet the Wi-Fi status\n\n_Figure 1. XAgent code structure_\n\n**C&C Communication**\n\nBesides collecting information from the iOS device, the app sends the information out via\nHTTP. It uses POST request to send messages, and GET request to receive commands.\n\n**Formatted Log Messages**\n\nThe malware’s log messages are written in HTML and color coded, making it easier for\nhuman operators to read. Error messages tend to be in red, while others are in green as\nshown in the figure below.\n\n\n-----\n\n_Figure 2. Color-coded HTML log messages_\n\n**A Well-Designed Code Structure**\n\nWe can see that the code structure of the malware is very organized. The malware looks\ncarefully maintained and consistently updated.\n\n_Figure 3. XAgent code structure_\n\nThe app uses the commands watch, search, find, results, _open, and close._\n\n_Figure 4. List of base URIs_\n\n**Randomly Generated URI**\n\nThe full uniform resource identifier (URI) for C&C HTTP requests is randomly generated,\naccording to a template agreed upon with the C&C server. The base URI can be seen\nin Figure 4, and parameters are chosen from the list below and appended to the base URI.\n\n_Figure 5. List of parameters used with URIs_\n\nHere are corresponding implementations we got during our reversing:\n\n_Figures 6 and 7. Code for URI generation_\n\n**Token Format and Encoding**\n\nThe malware uses a token to identify which module is communicating. The token is Base64\nencoded data, but padded with a 5-byte random prefix so that it looks like valid Base64 data.\nSee the first line “ai=” part in the figure below.\n\n_Figure 8. Client (XAgent) request_\n\nReverse engineering also revealed additional communication functions.\n\n_Figure 9. HTTP communication functions_\n\n\n-----\n\n_Figure 10. C2 server_\n\n**FTP Communication**\n\nThe app is also able to upload files via FTP protocol.\n\n_Figure 11. FTP communication functions_\n\n**Analysis of \"MadCap\" \"**\n\nMadcap\" is similar to the XAgent malware, but the former is focused on recording audio.\n\"Madcap\" can only be installed on jailbroken devices.\n\n_Figure 12. Code structure of Madcap_\n\n**Possible Infection Methods**\n\nThe exact methods of installing these malware is unknown. As far as we can tell the iOS\ndevice has to be jailbroken to install the Xagent malware. However we have seen one\ninstance wherein a lure involving XAgent simply says “Tap Here to Install the Application.\"\n\n_Figure 13. Site used in downloading XAgent_\n\nIt is good to note that it is still possible to install the malicious app into non-jailbroken devices\nif the app is signed using Apple's enterprise certificate. Another possible scenario is infecting\nan iPhone after connecting it to a compromised or infected Windows laptop via a USB cable.\n\n_To learn more about this campaign, you may refer to our report, Operation Pawn Storm_\n_Using Decoys to Evade Detection. The hashes of the related files are:_\n\n05298a48e4ca6d9778b32259c8ae74527be33815\n176e92e7cfc0e57be83e901c36ba17b255ba0b1b\n30e4decd68808cb607c2aba4aa69fb5fdb598c64\n\nAPT & Targeted Attacks\n\nIn our continued research on Operation Pawn Storm, we found one interesting poisoned\npawn—spyware specifically designed for espionage on iOS devices.\n\nBy: Feike Hacquebord, Fernando Merces February 04, 2015 Read time: ( words)\n\n\n-----\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-02-04 - Pawn Storm Update- iOS Espionage App Found.pdf"
    ],
    "report_names": [
        "2015-02-04 - Pawn Storm Update- iOS Espionage App Found.pdf"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536096,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1653773930,
    "ts_modification_date": 1653773930,
    "files": {
        "pdf": "https://archive.orkl.eu/22d7131de4df3fbe424bf71b894773f8e641634f.pdf",
        "text": "https://archive.orkl.eu/22d7131de4df3fbe424bf71b894773f8e641634f.txt",
        "img": "https://archive.orkl.eu/22d7131de4df3fbe424bf71b894773f8e641634f.jpg"
    }
}