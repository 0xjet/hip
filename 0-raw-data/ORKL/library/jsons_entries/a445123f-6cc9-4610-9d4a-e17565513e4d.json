{
    "id": "a445123f-6cc9-4610-9d4a-e17565513e4d",
    "created_at": "2022-10-25T16:48:17.166324Z",
    "updated_at": "2025-03-27T02:15:06.280914Z",
    "deleted_at": null,
    "sha1_hash": "2cfbb7b89a5e220b21bbf64161dc880c1b644017",
    "title": "When Governments Hack Opponents: A Look At Actors And Technology",
    "authors": "Usenix Conference",
    "file_creation_date": "2014-07-24T12:48:50Z",
    "file_modification_date": "2014-07-25T19:11:38Z",
    "file_size": 5470679,
    "plain_text": "# When Governments Hack Opponents:  A Look at Actors and Technology\n\n### William R. Marczak, University of California, Berkeley, and The Citizen Lab; John Scott-Railton, University of California, Los Angeles, and The Citizen Lab; Morgan Marquis-Boire, The Citizen Lab; Vern Paxson, University of California, Berkeley,  and International Computer Science Institute\n\n##### https://www.usenix.org/conference/usenixsecurity14/technical-sessions/presentation/marczak\n\n## This paper is included in the Proceedings of the 23rd USENIX Security Symposium.\n\n### August 20–22, 2014 • San Diego, CA\n\n##### ISBN 978-1-931971-15-7\n\n\n-----\n\n### When Governments Hack Opponents: A Look at Actors and Technology\n\n##### William R. Marczak John Scott-Railton Morgan Marquis-Boire UC Berkeley, Citizen Lab UCLA, Citizen Lab Citizen Lab\n\n Vern Paxson UC Berkeley, ICSI\n\n\n##### Abstract\n\nRepressive nation-states have long monitored telecommunications to keep tabs on political dissent. The Internet and online\nsocial networks, however, pose novel technical challenges to\nthis practice, even as they open up new domains for surveillance. We analyze an extensive collection of suspicious files\nand links targeting activists, opposition members, and nongovernmental organizations in the Middle East over the past\nseveral years. We find that these artifacts reflect efforts to attack targets’ devices for the purposes of eavesdropping, stealing\ninformation, and/or unmasking anonymous users. We describe\nattack campaigns we have observed in Bahrain, Syria, and the\nUnited Arab Emirates, investigating attackers, tools, and techniques. In addition to off-the-shelf remote access trojans and\nthe use of third-party IP-tracking services, we identify commercial spyware marketed exclusively to governments, including\nGamma’s FinSpy and Hacking Team’s Remote Control System (RCS). We describe their use in Bahrain and the UAE, and\nmap out the potential broader scope of this activity by conducting global scans of the corresponding command-and-control\n(C&C) servers. Finally, we frame the real-world consequences\nof these campaigns via strong circumstantial evidence linking\nhacking to arrests, interrogations, and imprisonment.\n\n##### 1 Introduction\n\nComputer security research devotes extensive efforts to protecting individuals against indiscriminate, large-scale attacks\nsuch as those used by cybercriminals. Recently, the problem of protecting institutions against targeted attacks conducted\nby nation-states (so-called “Advanced Persistent Threats”) has\nlikewise elicited significant research interest. Where these two\nproblem domains intersect, however—targeted cyber attacks by\nnation-states against individuals—has received virtually no significant, methodical research attention to date. This new problem space poses challenges that are both technically complex\nand of significant real-world importance.\nIn this work we undertake to characterize the emergent problem space of nation-state Internet attacks against individuals\nengaged in pro-democracy or opposition movements. While\nwe lack the data to do so in a fully comprehensive fashion,\n\n\nwe provide extensive detail from both technical and operational\nperspectives as seen in three countries. We view such characterizations as the fundamental first step necessary for the rigorous,\nscientific pursuit of a new problem space.\nFor our study we draw upon several years of research we\nhave conducted into cases from Bahrain, Syria and the United\nArab Emirates. We frame the nature of these attacks, and the\ntechnology and infrastructure used to conduct them, in the context of their impacts on real people. We hope in the process to\ninspire additional research efforts addressing the difficult problem of how to adequately protect individuals with very limited\nresources facing powerful adversaries.\nAs an illustration of this phenomenon, consider the following anecdote, pieced together from public reports and court\ndocuments.\nAt dawn on 3/12/13,[1] police raided the house of 17-yearold Ali Al-Shofa, confiscated his laptop and phone, and took\nhim into custody. He was charged with referring to Bahrain’s\nKing as a “dictator” (���[�] �����[�] ) and “fallen one” (������[�] ) on a\npseudonymous Twitter account, @alkawarahnews. According to court documents, Bahrain’s Cyber Crime Unit had linked\nan IP address registered in his father’s name to the account on\n12/9/12. Operators of @alkawarahnews later forwarded a\nsuspicious private message to one of the authors. The message\nwas received on 12/8/12 on a Facebook account linked to the\nTwitter handle, and contained a link to a protest video, purportedly sent by an anti-government individual. The link redirected\nthrough iplogger.org, a service that records the IP address\nof anyone who clicks. Analytics for the link indicate that it had\nbeen clicked once from inside Bahrain. On 6/25/13, Ali was\nsentenced to one year in prison.\nAli’s case is an example of the larger phenomenon we investigate: attacks against activists, dissidents, trade unionists,\nhuman rights campaigners, journalists, and members of NGOs\n(henceforth “targets”) in the Middle East. The attacks we have\ndocumented usually involve the use of malicious links or e-mail\nattachments, designed to obtain information from a device. On\nthe one hand, we have observed attacks using a wide range of\noff-the-shelf spyware, as well as publicly available third-party\nservices, like iplogger.org. On the other hand, some attacks use so-called “lawful intercept” trojans and related equip\n1Dates in the paper are given MM/DD/YY.\n\n\n-----\n\nment, purportedly sold exclusively to governments by companies like Gamma International and Hacking Team. The latter advertises that governments need its technology to “look\nthrough their target’s eyes” rather than rely solely on “passive\nmonitoring” [1]. Overall, the attacks we document are rarely\ntechnically novel. In fact, we suspect that the majority of attacks could be substantially limited via well-known security\npractices, settings, and software updates. Yet, the attacks are\nnoteworthy for their careful social engineering, their links to\ngovernments, and their real-world impact.\nWe obtained the majority of our artifacts by encouraging individuals who might be targeted by governments to provide us\nwith suspicious files and unsolicited links, especially from unfamiliar senders. While this process has provided a rich set of\nartifacts to analyze, it does not permit us to claim our dataset is\nrepresentative.\nOur analysis links these attacks with a common class of actor: an attacker whose behavior, choice of target, or use of information obtained in the attack, aligns with the interests of a\ngovernment. In some cases, such as Ali’s, the attackers appear\nto be governments themselves; in other cases, they appear instead to be pro-government actors, ranging from patriotic, not\nnecessarily skilled volunteers to cyber mercenaries. The phenomenon has been identified before, such as in Libya, when\nthe fall of Gaddafi’s regime revealed direct government ties to\nhacking during the 2011 Civil War [2].\nWe make the following contributions:\n\n_• We analyze the technology associated with targeted at-_\ntacks (e.g., malicious links, spyware), and trace it back\nto its programmers and manufacturers. While the attacks\nare not novel—and indeed often involve technology used\nby the cybercrime underground—they are significant because they have a real-world impact and visibility, and\nare connected to governments. In addition, we often find\namateurish mistakes in either the attacker’s technology or\noperations, indicating that energy spent countering these\nthreats can realize significant benefits. We do not, however, conclude that all nation-state attacks or attackers\nare incompetent, and we suspect that some attacks have\nevaded our detection.\n\n_• When possible, we empirically characterize the attacks_\nand technology we have observed. We map out global\nuse of two commercial hacking tools by governments by\nsearching through Internet scan data using fingerprints for\ncommand-and-control (C&C) servers derived from our\nspyware analysis.\n\n_• We develop strong evidence tying attacks to govern-_\nment sponsors and corporate suppliers, countering denials, sometimes energetic and sometimes indirect, of\nsuch involvement [3, 4, 5, 6], in contrast to denials [7]\nor claims of a corporate “oversight” board [8]. Our scanning suggests use of “lawful intercept” trojans by 11 additional countries considered governed by “authoritarian\nregimes.” We believe that activists and journalists in such\ncountries may experience harassment or consequences to\nlife or liberty from government surveillance.\n\nFinally, we do not explore potential defenses appropriate for\nprotecting the target population in this work. We believe that to\n\n\ndo so in a sufficiently well-grounded, meaningful manner first\nrequires developing an understanding of the targets’ knowledge\nof security issues, their posture regarding how they currently\nprotect themselves, and the resources (including potentially education) that they can draw upon. To this end, we are now conducting (with IRB approval) in-depth interviews with potential\ntargets along with systematic examination of their Internet devices in order to develop such an understanding.\n\n##### 2 Related Work\n\nIn the past decades, a rich body of academic work has grown to\ndocument and understand government Internet censorship, including nationwide censorship campaigns like the Great Firewall of China [9, 10, 11]. Research on governmental Internet\nsurveillance and activities like law-enforcement interception is\na comparatively smaller area [12]. Some academic work looks\nat government use of devices to enable censorship, such as keyword blacklists for Chinese chat clients [13], or the Green Dam\ncensorware that was to be deployed on all new computers sold\nin China [14]. We are aware of only limited previous work\nlooking at advanced threat actors targeting activists with hacking, though this work has not always been able to establish evidence of government connections [15].\nPlatforms used by potential targets, such as GMail [16],\nTwitter [17], and Facebook [18] increasingly make transportlayer encryption the default, obscuring communications from\nmost network surveillance. This use of encryption, along with\nthe global nature of many social movements, and the role of\ndiaspora groups, likely makes hacking increasingly attractive,\nespecially to states who are unable to request or compel content\nfrom these platforms. Indeed, the increasing use of encryption\nand the global nature of targets have both been cited by purveyors of “lawful intercept” trojans in their marketing materials [1, 19]. In one notable case in 2009, UAE telecom firm Etisalat distributed a system update to its then 145,000 BlackBerry\nsubscribers that contained spyware to read encrypted BlackBerry e-mail from the device. The spyware was discovered\nwhen the update drastically slowed users’ phones [20]. In contrast to country-scale distribution, our work looks at this kind of\npro-government and government-linked surveillance through\nhighly targeted attacks.\nThe term APT (Advanced Persistent Threat) refers to a\nsophisticated cyber-attacker who persistently attempts to target an individual or group [21]. Work outside the academic\ncommunity tracking government cyberattacks typically falls\nunder this umbrella. There has been significant work on\nAPT outside the academic community, especially among security professionals, threat intelligence companies, and human\nrights groups. Much of this work has focused on suspected\ngovernment-on-government or government-on-corporation cyber attacks [22, 23]. Meanwhile, a small but growing body\nof this research deals with attacks carried out by governments\nagainst opposition and activist groups operating within, as well\nas outside their borders. One of the most notable cases is\nGhostNet, a large-scale cyber espionage campaign against the\nTibetan independence movement [24, 25]. Other work avoids\ndrawing conclusions about the attackers [26].\n\n\n-----\n\n|Country|Date Range|Range of Targets|Number and Type of Samples|Distinct Malware C&C’s|\n|---|---|---|---|---|\n|Bahrain|4/9/12— 7/31/13|≥12 activists, dissidents, trade unionists, human rights campaigners, and journalists|8 FinSpy samples, 7 IP spy links received via private message, > 200 IP spy links observed publicly|4 distinct IP addresses|\n|Syria|2011 to present|10–20 individuals with technical back- grounds who receive suspect files from their contacts|40–50: predominantly BlackShades, DarkComet, Xtreme RAT, njRAT, ShadowTech RAT.|160 distinct IP addresses|\n|UAE|7/23/12— 7/31/13|7 activists, human rights campaigners, and journalists|31 distinct malware samples spanning 7 types; 5 dis- tinct exploits|12 distinct IP addresses|\n\n\n###### Table 1: Range of data for the study.\n\n|Country|Possible Impacts|Probable Impacts|\n|---|---|---|\n|Bahrain|1. 3 individuals arrested, sen- tenced to 1–12 mo in prison 2. Union leader questioned by police; fired|1. Activist serving 1 yr in prison 2. Police raid on house|\n|Syria|1. Sensitive opposition com- munications exposed to gov- ernment 2. Exfiltrated material used to identify and detain activists|1. Opposition members dis- credited by publishing embar- rassing materials 2. Exfiltrated materials used during interrogation by secu- rity services|\n|UAE|Contacts targeted via mal- ware|Password stolen, e-mail downloaded|\n\n\n###### Table 2: Negative outcomes plausibly or quite likely aris- ing from attacks analyzed.\n\n##### 3 Data Overview and Implications\n\nOur study is based on extensive analysis of malicious files and\nsuspect communications relevant to the activities of targeted\ngroups in Bahrain, Syria, and the UAE, as documented in Table 1. A number of the attacks had significant real-world implications, per Table 2. In many cases, we keep our descriptions\nsomewhat imprecise to avoid potential leakage of target identities.\nWe began our work when contacted by individuals concerned that a government might have targeted them for cyberattacks. As we became more acquainted with the targeted communities, in some cases we contacted targeted groups directly;\nin others, we reached out to individuals with connections to targeted groups, who allowed us to examine their communications\nwith the groups. For Bahrain and Syria, the work encompassed\n10,000s of e-mails and instant messages. For the UAE, the volume is several thousand communications.\n\n##### 4 Case Studies: Three Countries\n\nThis following sections outline recent targeted hacking campaigns in Bahrain, Syria and the UAE. These cases have a common theme: attacks against targets’ computers and devices with\nmalicious files and links. In some cases the attackers employed\nexpensive and “government exclusive” malware, while in other\ncases, attackers used cheap and readily available RATs. Across\nthese cases we find that clever social engineering often plays\na central role, which is strong evidence of a well-informed adversary. We also, however, frequently find technical and operational errors by the attackers that enable us to link attacks\nto governments. In general, the attacks we find are not welldetected by anti-virus programs.\n\n\n###### Figure 1: E-mail containing FinSpy.\n\n##### 4.1 Bahrain\n\nWe have analyzed two attack campaigns in the context of\nBahrain, where the government has been pursuing a crackdown\nagainst an Arab-Spring inspired uprising since 2/14/2011.\nThe first involved malicious e-mails containing FinSpy, a\n“lawful intercept” trojan sold exclusively to governments. The\nsecond involved specially crafted IP spy links and e-mails designed to reveal the IP addresses of operators of pseudonymous\naccounts. Some individuals who apparently clicked on these\nlinks were later arrested, including Ali (cf. §1), whose click\nappears to have been used against him in court. While both\ncampaigns point back to the government, we have not as yet\nidentified overlap between the campaigns; targets of FinSpy\nappeared to reside mainly outside Bahrain, whereas the IP spy\nlinks targeted those mainly inside the country. We examine\neach campaign in turn.\n\n###### FinSpy Campaign. Beginning in April 2012, the authors\nreceived 5 suspicious e-mails from US and UK-based activists\nand journalists working on Bahrain. We found that some\nof the attachments contained a PE (.exe) file designed to\nappear as an image. Their filenames contained a Unicode right-to-left override (RLO) character, causing Windows\nto render a filename such as gpj.1bajaR.exe instead as\nexe.Rajab1.jpg.\nThe other .rar files contained a Word document with an\nembedded ASCII-encoded PE file containing a custom macro\nset to automatically run upon document startup. Under default\nsecurity settings, Office disables all unsigned macros, so that\na user who opens the document will only see an informational\nmessage that the macro has been disabled. Thus, this attack was\napparently designed with the belief or hope that targets would\nhave reduced security settings.\n\n\n-----\n\n**Identification as FinSpy: By running the sample using**\nWindows Virtual PC, we found the following string in memory: y:\\lsvn_branches\\finspyv4.01\\finspyv2\\.\nThis string suggests FinSpy, a product of Gamma International [27]. The executables used virtualized obfuscation [28], which appeared to be custom-designed. We devised a fingerprint for the obfuscater and located a structurally\nsimilar executable by searching a large malware database.\nThis executable contained a similar string, except it identified itself as FinSpy v3.00, and attempted to connect to\ntiger.gamma-international.de, a domain registered\nto Gamma International GmbH.\n**Analysis of capabilities: We found that the spyware has**\na modular design, and can download additional modules from\na command & control (C&C) server, including password capture (from over 20 applications) and recording of screenshots,\nSkype chat, file transfers, and input from the computer’s microphone and webcam.\nTo exfiltrate data back to the C&C server, a module encrypts\nand writes it to disk in a special folder. The spyware periodically probes this folder for files that match a certain naming\nconvention, then sends them to the C&C server. It then overwrites the files, renames them several times, and deletes them,\nin an apparent effort to frustrate forensic analysis.\n**Analysis of encryption: Because the malware employed**\nmyriad known anti-debugging and anti-analysis techniques, it\nthwarted our attempts to attach debuggers. Since it did not include anti-VM code, we ran it in TEMU, an x86 emulator designed for malware analysis [29]. TEMU captures instructionlevel execution traces and provides support for taint-tracking.\nWe found that FinSpy encrypts data using a custom implementation of AES-256-CBC. The 32 byte AES key and 16 byte\nIV are generated by repeatedly reading the low-order-4-bytes of\nthe Windows clock. The key and IV are encrypted using an embedded RSA-2048 public key, and stored in the same file as the\ndata. The private key presumably resides on the C&C server.\nThe weak AES keys make decryption of the data straightforward. We wrote a program that generally can find these keys in\nunder an hour, exploiting the fact that many of the system clock\nreadings occur within the same clock-update quantum.\nIn addition, FinSpy’s AES code fails to encrypt the last block\nof data if less than the AES block size of 128 bits, leaving trailing plaintext. Finally, FinSpy’s wire protocol for C&C communication uses the same type of encryption, and thus is subject\nto the same brute force attack on AES keys. While we suspect\nFinSpy’s cryptographic deficiencies reflect bugs, it is also conceivable that the cryptography was deliberately weakened to\nfacilitate one government monitoring the surveillance of others.\n**C&C** **server:** The samples communicated with\n77.69.140.194, which belongs to a subscriber of\nBatelco, Bahrain’s main ISP. Analyzing network traffic\nbetween our infected VM and the C&C server revealed that\nthe server used a global IPID, which allowed us to infer server\nactivity by its progression.\nIn response to our preliminary work an executive at Gamma\ntold the press that Bahrain’s FinSpy server was merely a proxy\nand the real server could have been anywhere, as part of a claim\nthat the Bahrain FinSpy deployment could have been associ\n\nated with another government [4]. However, a proxy would\nshow gaps in a global IPID as it forwarded traffic; our frequent\nobservation of strictly consecutive IPIDs thus contradicts this\nstatement.\n**Exploitation of captured data: Since we suspected the spy-**\nware operator would likely seek to exploit captured credentials,\nparticularly those associated with Bahraini activist organizations, we worked with Bahrain Watch, an activist organization\ninside Bahrain. Bahrain Watch established a fake login page\non their website and provided us with a username and password. From a clean VM, we logged in using these credentials,\nsaving the password in Mozilla Firefox. We then infected the\nVM with FinSpy and allowed it to connect to the Bahrain C&C\nserver. Bahrain Watch’s website logs revealed a subsequent\nhit from 89.148.0.41—made however to the site’s homepage, rather than its login page—coming shortly after we had\ninfected the VM. Decrypting packet captures of the spyware’s\nactivity, we found that our VM sent the password to the server\nexactly one minute earlier:\n\nINDEX,URL,USERNAME,PASSWORD,USERNAME FIELD,\nPASSWORD FIELD,FILE,HTTP 1,\nhttp://bahrainwatch.org,bhwatch1,watchba7rain,\nusername,password,signons.sqlite,,\nVery Strong,3.5/4.x\n\nThe URL provided to the server did not include the path\nto the login page, which was inaccessible from the homepage. This omission reflects the fact that the Firefox password\ndatabase stores only domain names, not full login page URLs,\nfor each password. Repeating the experiment again yielded a\nhit from the same IP address within a minute. We inspected\nBahrain Watch’s logs, which showed no subsequent (or previous) activity from that address, nor any instances of the same\nUser Agent string.\n\n###### IP spy Campaign. In an IP spy attack, the attacker aims to\ndiscover the IP address of a victim who is typically the operator of a pseudonymous social media or e-mail account. The attacker sends the pseudonymous account a link to a webpage or\nan e-mail containing an embedded remote image, using one of\nmany freely-available services.[2] When the victim clicks on the\nlink or opens the e-mail, their IP address is revealed to the attacker.[3] The attacker then discovers the victim’s identity from\ntheir ISP. In one case we identified legal documents that provided a circumstantial link between such a spy link and a subsequent arrest.\nFigure 2 illustrates the larger ecosystem of these attacks. The\nattackers appear to represent a single entity, as the activity all\nconnects back to accounts that sent links shortened using a particular user account al9mood[4] on the bit.ly URL shortening\nservice.\nRecall Ali Faisal Al-Shufa (discussed in Section 1), who\nwas accused of sending insulting tweets from an account\n\n2e.g., iplogger.org, ip-spy.com, ReadNotify.com.\n3Several webmail providers and e-mail clients take limited steps to\nautomatically block loading this content, but e-mails spoofed to come\nfrom a trusted sender sometimes bypass these defenses.\n4A Romanization of the Arabic word for “steadfastness.”\n\n\n-----\n\nfeb14truth.webs.com\n\n\n###### Figure 2: The ecosystem of Bahrain “IP spy” attacks.\n\n\n@alkawarahnews (Al Kawarah News in Figure 2). An operator of the account forwarded us a suspicious private message\nsent to the Al Kawarah News Facebook account from Red Sky.\nRed Sky was purportedly arrested on 10/17/12, was convicted\nof insulting the King on his Twitter account @RedSky446,\nand was sentenced to four months prison.[5] When released, he\nfound that the passwords for his Twitter, Facebook, and e-mail\naccounts had been changed, and did not know how to recover\nhis accounts.\nThe message that Red Sky’s account sent to Al Kawarah\nNews included a link shortened using Google’s goo.gl service. We used the goo.gl API to access analytics for the link,\nfinding that it unshortened to iplogger.org/25SX and was\ncreated on 12/8/12. The link had received only one click, which\ncame from Bahrain with the referrer www.facebook.com.\nAli’s case files contained a request from the Public Prosecution for information on an IP address that it had linked to Al\nKawarah News about 22 hours after the link was created. Court\ndocuments indicate that ISP data linked the IP address to Ali,\nand on this basis he was sentenced to one year in prison.\nRed Sky also targeted M in Figure 2. M recalled clicking on a link from Red Sky while using an Internet connection from one of the houses in M’s village. The house was\nraided by police on 3/12/13, who were looking for the subscriber of the house’s internet connection. Police questioning\n\n5According to information we received from two Twitter users, one\nof whom claimed to have met Red Sky in prison; another to be a colleague.\n\n\nrevolved around Tweets that referred to Bahrain’s King as a\n“cursed one.” Red Sky had earlier targeted other users with IP\nspy links shortened using the al9mood bit.ly account.\n\nThe attack on Jehad Abdulla is noteworthy, as the account’s activity aligned with communities typically critical of\nBahrain’s opposition. However, the account also directly criticized the King on occasion, in one case referring to him as\n“weak” and “stingy.” An account linked to al9mood sent Jehad Abdulla an IP spy link on 10/2/12 in a public message. On\n10/16/12, Salman Darwish was arrested for insulting the King\nusing the Jehad Abdulla account. He was sentenced to one\nmonth in prison, partly on the basis of his confession. Salman’s\nfather claims that police denied Salman food, drink, and medical care.\n\nAnother account linked to al9mood targeted @YLUBH, the\nTwitter account of Yokogawa Union, a trade union at the\nBahraini branch of a Japanese company. @YLUBH received at\nleast three IP spy links in late 2012, sent via public Twitter messages. Yokogawa fired the leader of the trade union, Sami Abdulaziz Hassan, on 3/23/13 [30]. It later emerged that Sami was\nindeed the operator of the @YLUBH account, and that the police\nhad called him in for questioning in relation to its tweets [31].\n\n_Use of embedded remote images:_ We identified several\ntargets who received spoofed e-mails containing embedded\nremote images. Figure 2 shows two such cases, Maryam\nand Sayed Yousif. The attacker sent the e-mails using\nReadNotify.com, which records the user’s IP address upon\n\n\n-----\n\ntheir mail client downloading the remote image.[6]\n\nWhile ReadNotify.com forbids spoofing in their TOS,\nthe service has a vulnerability known to the attackers (and\nwhich we confirmed) that allows spoofing the From address\nby directly setting the parameters on a submission form on their\nwebsite We have not found evidence suggesting this vulnerability is publicly known, but it appears clear that the attacker exploited it, as the web form adds a X-Mai1er: RNwebmail\nheader not added when sending through ReadNotify.com’s\nother supported methods. The header appeared in each e-mail\nthe targets forwarded to us.\nWhen spoofing using this method, the original sender address still appears in X-Sender and other headers. According to these, the e-mails received by the targets all came from\nfatoomah85@gmail.com. A link sent in one of these emails was connected to the al9mood bit.ly account.\nIn monitoring accounts connected to al9mood, we counted\nmore than 200 IP spy links in Twitter messages and public\nFacebook posts. Attackers often used (1) accounts of prominent or trusted but jailed individuals like “Red Sky,” (2) fake\npersonas (e.g., attractive women or fake job seekers when targeting a labor union), or (3) impersonations of legitimate accounts. In one particularly clever tactic, attackers exploited\nTwitter’s default font, for example substituting a lowercase “l”\nwith an uppercase “I” or switching vowels (e.g. from “a” to\nan “e”) to create at-a-glance identical usernames. In addition,\nmalicious accounts tended to quickly delete IP spy tweets sent\nvia (public) mentions, and frequently change profile names.\n\n##### 4.2 Syria\n\nThe use of RATs against the opposition has been a welldocumented feature of the Syrian Civil War since the first reports were published in early 2012 [36, 39, 40, 32, 34]. The\nphenomenon is widespread, and in our experience, most members of the opposition know that some hacking is taking place.\nAs summarized in Table 3, the attacks often include fake or maliciously packaged security tools; intriguing, or ideological, or\nmovement-relevant content (e.g. lists of wanted persons). The\nseeding techniques and bait files suggest a good understanding\nof the opposition’s needs, fears and behavior, coupled with basic familiarity with off-the-shelf RATs. In some cases attacks\noccur in a context that points to a more direct connection to\none of the belligerents: the Syrian opposition has regularly observed that detainees’ accounts begin seeding malware shortly\nafter their arrest by government forces [41].\nResearchers and security professionals have already profiled\nmany of these RATs, including DarkComet [42, 43], Blackshades Remote Controller [38], Xtreme RAT [44], njRAT [26],\nand ShadowTech [36]. Some are available for purchase by anyone, in contrast to “government only” FinSpy and RCS. For example, Xtreme RAT retails for e350, while a version of Blackshades lists for e40. Others, like DarkComet, are free. We\nhave also observed cracked versions of these RATs on Arabiclanguage hacker forums, making them available with little effort and no payment trail. While the RATs are cheaper and less\n\n6YahooMail and the iPhone mail client automatically load these remote images, especially in e-mails spoofed from trusted senders.\n\n\nsophisticated than FinSpy and RCS, they share the same basic functionality, including screen capture, keylogging, remote\nmonitoring of webcams and microphones, remote shell, and file\nexfiltration.\nIn the most common attack sequence we observed, illustrated with three examples in Figure 3, the attacker seeds malware via private chat messages, posts in opposition-controlled\nsocial media groups, or e-mail. These techniques often limit\nthe world-visibility of malicious files and links, slowing their\ndetection by common AV products. Typically, targets receive\neither (1) a PE in a .zip or .rar, (2) a file download link, or\n(3) a link that will trigger a drive-by download. The messages\nusually include text, often in Arabic, that attempts to persuade\nthe target to execute the file or click the link.\nThe first attacks in Figure 3 date to 2012, and use bait files\nwith a DarkComet RAT payload. These attacks share the same\nC&C, 216.6.0.28, a Syrian IP address belonging to the Syrian Telecommunications Establishment, and publicly reported\nas a C&C of Syrian malware since February 2012 [45]. The\nfirst bait file presents to the victim as a PDF containing information about a planned uprising in Aleppo. In fact the file is a\nWindows Screensaver (.scr) that masquerades as a PDF using\nUnicode RLO, rendering a name such as “.fdp.scr” display to the victim as “.rcs.pdf.” The second bait file is\na dummy program containing DarkComet while masquerading\nas a Skype call encryption program, playing to opposition paranoia about government backdoors in common software. The\nthird attack in Figure 3, observed in October 2013, entices targets with e-mails purporting to contain or link to videos about\nthe current conflict, infecting victims with Xtreme RAT, and\nusing the C&C tn1.linkpc.net.\nFor seeding, the attackers typically use compromised accounts (including those of arrested individuals) or fake identities masquerading as pro-opposition. Our illustration shows\nin abstract terms the use of Victim A’s account to seed malware (“Aleppo Plan”) via (say) Skype messages to Victim(s)\n**B[n].** In the cases of Opp. Member C and NGO Worker\n**D (here, actual victims, not abstract), targeting was by e-mail**\nfrom domains apparently belonging to opposition groups, indicating a potential compromise. One domain remains active,\nhosting a website of the Salafist Al-Nusra front [46], while the\nother appears dormant. Opp. Member C received a malicious\nfile as an e-mail attachment, while NGO Worker D was sent a\nshortened link (url[.]no/Uu5) to a download from a directory\nof Mrconstrucciones[.]net,[7] a site that may have been compromised. Both attacks resulted in an Xtreme RAT infection.\nInterestingly, in the case of the fake Skype encryption\nthe deception extended to a YouTube video from “IT Security Lab” [47] demonstrating the program’s purported capabilities, as well as a website promoting the tool, skype**encryption.sytes.net.** The attackers also constructed a basic, faux GUI for their “Encryption” program (see Figure 4).\nThe fake GUI has a number of non-functional buttons like “Encrypt” and “DeCrypt,” which generate fake prompts. While distracted by this meaningless interaction, the victim’s machine is\ninfected with DarkComet 3.3 [32, 33].\nAnecdotally, campaign volume appears to track significant\n\n7Obfuscated to avoid accidental clicks on active malware URLs.\n\n\n-----\n\n|Type|Features|Examples (RATs)|\n|---|---|---|\n|Security tools|Executable files presented as a “tool” often accompanied by justifica- tions or statements of its value in the targeted seeding, for example on a social media site, at the download location, or in videos|“Skype Encryption” (DC) [32, 33], “Facebook Security” (cus- tom) [34], Anti-hacker (DC) [35], Fake Freegate VPN (ST) [36]|\n|Ideologically or movement-relevant files|A document or PE as download or attachment with accompanying en- couragement to open or act on the material, often masquerading as legitimate PDF documents or inadvertently leaked regime programs. Frequent use of RLO to disguise true extension (such as .exe or .scr)|“Names of individuals wanted by the Regime,” (DC) “Aleppo [uprising] Plan” (DC) [37], important video (BS) [38], “Hama Rebels Council” document (DC) [39], “wanted persons” database frontend (custom), movement relevant video (njRAT), file about the Free Syrian Army (Xtreme RAT)|\n|Miscellaneous tools|Tools pretending to offer functionality relevant to the opposition, such as a fake tool claiming to “mass report” regime pages on Facebook|hack facebook pro v6.9 (DC) [40]|\n\n\n###### Table 3: Campaigns and RATs employed in Syrian surveillance. BS = Blackshades, DC = DarkComet, ST = Shad- owTech.\n\n“Skype\n\nSY Malware tn1.linkpc.net skype-encription Encryption” **Xtreme Rat** Mrconstrucciones.net Url.no\nActors .sytes.net\n\nfsa@freesyria.com mohamed@jalnosra.com\n\n216.6.0.28 fsa.zip\n\n**Dark Comet**\nSY Gov't Account seeds\n\n“Aleppo Plan”\n\nE-Mail E-Mail\n\n**Victim A** Arrested Credentials\n\ngained\n\n“Aleppo Plan”\n\n**Victim(s) B[n]** Clicks **Opp. Member C** **NGO Worker D**\n\nfile Account seeds\n\n“Aleppo Plan”\n\n###### Figure 3: A sample from the ecosystem of Syrian malware campaigns.\n\nevents in the ongoing conflict. For example, campaigns dwindled and then rebounded within hours after Syria’s 2012 Internet shutdown [48]. Similarly, activity observed by the authors\nalso dwindled prior to expectation of US-led military action\nagainst Syrian government targets in September 2013. Once\nthis option appeared to be off the table, the volume of new\nsamples and campaigns we observed again increased, including the recent targeting of NGO workers per Figure 3. We are\naware of only a negligible number of cases of the opposition\nusing similar RATs against Syrian Government supporters, although evidence exists of other kinds of electronic attacks by\nthird parties.\n\n\nMrconstrucciones.net\n\n\nskype-encription\n.sytes.net\n\n\ntn1.linkpc.net\n\n\n###### Real world consequences. The logistics and activities of\nSyria’s numerous opposition groups are intentionally concealed\nfrom public view to protect both their efficacy, and the lives of\npeople participating in them. Nevertheless, Syrian opposition\nmembers are generally familiar with stories off digital compromises of high-profile figures, including those entrusted with the\nmost sensitive roles, as well as rank-and-file members. Compromise of operational security poses a documented threat to\nlife both for victims of electronic compromise, and to family\nmembers and associates.\nThe Syrian conflict is ongoing, making it difficult to assem\n\n###### Figure 4: The fake Skype program distracts the victim with the promise of encrypted communications while in- fecting their machine with DarkComet.\n\n\nUrl.no\n\n\n-----\n\nble comprehensive evidence of linkages between government\nactors and malware campaigns. Moreover, many individuals\nwhose identities have been compromised are in prison or otherwise disappeared, and thus unable to relate the evidence presented to them during interrogation. Still, strong circumstantial\nevidence links the use of RATs, phishing, and government activity, which we briefly summarize here: (1) many Syrians have\nrecounted to journalists and the authors how interrogators confronted them with material from their computers. For example:\n\nThe policeman told me, “Do you remember when\nyou were talking to your friend and you told him\nyou had something wrong [sic] and paid a lot of\nmoney? At that time we were taking information\nfrom your laptop.” [41]\n\n(2) Syrian activists have supplied cases to international journalists [41], where arrests are quickly followed by the social media accounts of detained individuals seeding malware to contact\nlists (Figure 3). (3) Finally, despite the notoriety of the attack\ncampaigns, including mention of C&C IPs in international media [45], the Syrian government has made no public statements\nabout these campaigns nor acted to shut down the servers.\nBeyond the ongoing challenges of attribution, these malware\ncampaigns have a tangible impact on the Syrian opposition, and\ngenerally align with the interests of the Syrian government’s\npropaganda operations. The case of Abdul Razzaq Tlass, a\nleader in the Free Syrian Army, is illustrative of the potential\nuses of such campaigns. In 2012 a string of videos emerged\nshowing Tlass sexting and engaged in lewd activity in front of\na webcam [49]. While he denied the videos, the harm to his reputation was substantial and he was eventually replaced [50].\n\n##### 4.3 UAE\n\nWhile the UAE has experienced no recent uprising or political unrest, it has nevertheless cracked down on its opposition,\nconcurrent with the Arab Spring.\nThe first attacks we observed in the UAE involved a\ngovernment-grade “lawful interception” trojan known as Re_mote Control System (RCS), sold by the Italian company Hack-_\ning Team. The associated C&C server indicated direct UAE\ngovernment involvement. Over time, we stopped receiving\nRCS samples from UAE targets, and instead observed a shift\nto the use of off-the-shelf RATs, and possible involvement of\ncyber-mercenary groups. However, poor attacker operational\nsecurity allowed us to link most observed attacks together.\n\n###### RCS. UAE activist Ahmed Mansoor (per Figure 5), imprisoned from April to November 2011 after signing an online prodemocracy petition [51], received an e-mail purportedly from\n“Arabic Wikileaks” in July 2012. He opened the associated attachment, “veryimportant.doc,” and saw what he described as\n“scrambled letters”. He forwarded us the e-mail for investigation.\nThe attachment exploited CVE-2010-3333, an RTF parsing vulnerability in Microsoft Office. The document did not\ncontain any bait content, and part of the malformed RTF\nthat triggered the exploit was displayed in the document.\nThe exploit loaded shellcode that downloaded a second stage\n\n\n###### Figure 5: Part of the ecosystem of UAE surveillance at- tacks.\n\nfrom ar-24.com, which in turn downloaded spyware from\nar-24.com. We denote this combination as the 3-Stage Ex**ploit Kit in Figure 5.**\nThe C&C server also ran on ar-24.com. When we obtained the sample in July 2012, ar-24.com resolved to an\nIP address on Linode, a hosting provider. Three months later, it\nresolved to a UAE address belonging to the Royal Group [52],\nan organization linked to the UAE government; it is chaired by\nSheikh Tahnoon bin Zayed Al-Nayhan, a member of the UAE\nruling family and a son of the founder of the UAE.\n**Identification as RCS: We identified strings in memory**\nthat matched those in a Symantec analysis [53] of RCS (also\nknown as DaVinci or Crisis), a product of the Italian company Hacking Team [54]. We also located a structurally similar Word document via VirusTotal. The document used the\nsame exploit and attempted to download a second stage from\nrcs-demo.hackingteam.it, which was unavailable at\nthe time of testing.\n**Analysis of capabilities: RCS has a suite of functionality**\nlargely similar to FinSpy. One difference was in the vectors\nused to install the spyware. We located additional samples (see\n_§ 5), some of which were embedded in a .jar file that installs_\nan OS-appropriate version of RCS (Windows or OSX), optionally using an exploit. If embedded as an applet, and no exploit\nis present, Java displays a security warning and asks the user\nwhether they authorize the installation. We also saw instances\nof the 3-Stage Exploit Kit where the first stage contained a\nFlash exploit; in some cases, we could obtain all stages and\nconfirm that these installed RCS. Some samples were packed\nwith the MPress packer [55], and some Windows samples were\nobfuscated to look like the PuTTY SSH client.\nAnother difference is in persistence. For example, the RCS\nsample sent to Ahmed adds a Run registry key, whereas the\nFinSpy samples used in Bahrain overwrite the hard disk’s boot\nsector to modify the boot process; the spyware is loaded be\n\n-----\n\nfore the OS, and injects itself into OS processes as they start.\nThe RCS samples we examined also had the ability to propagate to other devices, including into inactive VMWare virtual\nmachines by modifying the disk image, onto USB flash drives,\nand onto Windows Mobile phones. We did not observe similar\ncapabilities in the FinSpy samples we examined.\n\n**Exploitation of captured data: When Ahmed Mansoor re-**\nceived the RCS document, he opened it, infecting his computer\n(Figure 5). Ahmed subsequently noted several suspicious accesses to his GMail account using IMAP. Even after he changed\nhis password, the accesses continued. While corresponding\nwith Ahmed on his compromised account, an author of this paper discovered that the attackers had installed an application_specific password [56] in Ahmed’s GMail account, a secondary_\npassword that they apparently used to access his account even\nafter he changed his main password. The suspicious accesses\nstopped after removal of the application-specific password.\n\nTwo weeks after this correspondence with Ahmed, one of us\n(Author in Figure 5) received a targeted e-mail with a link to\na file hosted on Google Docs containing a commercial off-theshelf RAT, Xtreme RAT. The e-mail was sent from the UAE’s\ntimezone (as well as of other countries) and contained the terms\n“veryimportant” and “wikileaks”, just like in the e-mail received by Ahmed.\n\nThe instance of Xtreme RAT sent to Author used\nowner.no-ip.biz for its C&C, one of the domains mentioned in a report published by Norman about a year-long campaign of cyberattacks on Israeli and Palestinian targets carried\nout by a group that Norman was unable to identify [57]. Three\nmonths after Author was targeted, Ahmed received an e-mail\ncontaining an attachment with Xtreme RAT that talked to the\nsame C&C server (Figure 5), suggesting that the attackers who\ninfected Ahmed with RCS may have provided a list of interesting e-mail addresses to another group for further targeting.\n\n**Possible consequences:** Shortly after he was targeted,\nAhmed says he was physically assaulted twice by an attacker\nwho appeared able to track Ahmed’s location [58]. He also reports that his car was stolen, a large sum of money disappeared\nfrom his bank account, and his passport was confiscated [59].\nHe believes these consequences are part of a government intimidation campaign against him, but we did not uncover any\ndirect links to his infection. (Interestingly, spyware subsequently sent to others has used bait content about Ahmed.)\n\n**Further attacks: In October 2012, UAE Journalist A and**\n**Human Rights activist B (per Figure 6) forwarded us suspi-**\ncious e-mails they had received that contained a Word document corresponding to the first stage of 3-Stage Exploit Kit\n(Figure 5). The attachment contained an embedded Flash file\nthat exploited a vulnerability fixed in Adobe Flash 11.4, loading\nshell code to download a second stage from faddeha.com.\nWe were unable to obtain the second stage or the ultimate payload, as the website was unavailable at the time of testing.\nHowever, the exploit kit appears indicative of Hacking Team\ninvolvement. A page on faddeha.com found in Google’s\ncache contained an embedded .jar with the same applet class\n(WebEnhancer) as those observed in other .jar files that we\nfound to contain RCS.\n\n\n_Hosts sample that_ _Same IP_ _SameIP1_\n_talks to C&C_\n\nCVE-2013-0422 _Used by sample_\n\n_that talks to C&C_\n\n**Journalist A,**\n**H.R. activist B** njq8\n\n**Journalist F**\n\nnjRAT VB Packer upload.bz\n\nstorge.myftp.org\n\n**Relative of** SpyNet\n**political detainee D**\n\n**Journalist C**\n\n**H.R. activist E**\n\n_SameIP1_\n\nsn.all-google.com DarkComet Appin CVE 2012-0158\n\n###### Figure 6: Another part of the ecosystem of UAE surveil- lance attacks.\n\n Off-the-shelf RATs. We found a file that VirusTotal had\ndownloaded from faddeha.com, which appeared to be a remote access toolkit known as SpyNet, available for general purchase for 50 Euros [60]. The SpyNet sample communicated\nwith the C&C hamas.sytes.net.\n**SpyNet Packing: We found another instance of the first**\nstage of the 3-Stage Exploit Kit on VirusTotal. The exploit\ndownloaded a second stage, which in turn downloaded a sample of SpyNet from maile-s.com. This sample of SpyNet\ncommunicated with the same C&C hamas.sytes.net.\nThe sample was packed using ASProtect [61]. When run, the\nsample unpacks a compiled Visual Basic project that loads, via\nthe RunPE method [62], an executable packed with UPX [63].\nFinally, this executable unpacks SpyNet. SpyNet’s GUI only\noffers an option to pack with UPX, suggesting that the attackers specially added the other layers of packing. In some cases,\nthe Visual Basic project bears the name NoWayTech, which\nappears to be an underground RunPE tool, while others are\nnamed SpyVisual, which we have been unable to trace to any\npublic underground tools, and thus also may reflect customization by the attacker. The SpyVisual projects contain the string\n\nc:\\Users\\Zain\\AppData\\Local\\Temp\\OLE1EmbedStrm.wav,\nwhich we used as the fingerprint VB Packer in Figure 6.\n**Cedar Key attack: The same VB Packer was used in an**\nattack on Relative of political detainee D and H.R. activist\n**E in Figure 6. These individuals received e-mails containing a**\nlink to a web page hosted on cedarkeyrv.com impersonating YouTube. Loading the page greeted the target with “Video\n_loading please wait ...” The page redirected to a YouTube_\nvideo a few seconds later, but first loaded a Java exploit [64]—a\n\n\nupload.bz\n\n\n-----\n\nknown vulnerability with no patch at the time that the e-mails\nwere sent. Oracle released a patch 12 hours after activists began\nreceiving these links.\nThe cedarkeyrv.com domain is associated with an RV\npark in Cedar Key, Florida. The website’s hosting company\ntold us that the site had apparently suffered a compromise, but\ndid not have further details.\nThe exploit used in the attack appears to have been originally posted by a Kuwaiti user, njq8, on an Arabic-language\nexploit sharing site [65]. We contacted njq8, who told us\nthat he had obtained the exploit elsewhere and modified it\nprior to posting. The attack downloaded an instance of\nSpyNet from isteeler.com (which from our inspection did\nnot appear to have any legitimate content), which used the\nC&C storge.myftp.org. This same C&C occurred in another attack (Figure 6) targeting Relative of political detainee\n**D; in that case, the payload was a freely-available RAT known**\nas njRAT, written by the same njq8 as the exploit-poster discussed above. However, we did not find any other evidence\nsuggesting njq8’s involvement in either attack.\n**More SpyNet attacks: The domain hamas.sytes.net,**\nwhich we previously saw used by two SpyNet samples, resolved to 67.205.79.177. Historically,\ndreems.no-ip.ca also resolved to this address. An\nunidentified dropper using this C&C targeted Journalist F; a\nSpyNet attack on Relative of political detainee D also used\nthis C&C. In that latter case, the sample arrived via e-mail\nin a .rar attachment that contained an .scr file disguised\nas a Word document. The .scr file was a self-extracting\narchive that decompressed and ran both the bait document\nand the payload. The SMTP source of the e-mail was\nwebmail.upload.bz.\n**Appin: In early 2013 UAE H.R. activist E forwarded nu-**\nmerous documents that included a particular CVE-2012-0158\nexploit for Microsoft Word. In all, these totaled 17 distinct\nhashes of documents, and 10 distinct hashes of payloads (some\ndocuments that differed in their hash downloaded the same payload). The exploits primarily downloaded instances of SpyNet\nfrom upload.bz, which for the most part communicated\nwith C&C at sn.all-google.com. This domain was also\nused for C&C in other attacks, including that on Journalist C.\nTwo of the other CVE-2012-0158 exploits downloaded DarkComet from www.getmedia.us and\nwww.technopenta.com after posting system information to random123.site11.com. All three domains\nmatch those used by an Indian cybermercenary group said\nto be linked to Appin Security Group [66]. The former\ntwo domains hosted content other than spyware (i.e., they\nmay have been compromised). We alerted the owner of\nwww.getmedia.us, who removed the payloads.\n\n##### 5 Empirical characterization\n\nThe samples we received afforded us an opportunity to empirically characterize the use of FinFisher and Hacking Team\naround the world, enabling us to assess their prevalence, and\nidentify other country cases that may warrant future investigation. We analyzed the samples and the behavior of their C&C\n\n\nservers to develop indicators (fingerprints) for how the servers\nrespond to certain types of requests. We then scanned the full\nInternet IPv4 address space (“/0”) for these, along with probing results found by past scans. In many cases we do not release\nthe full details of our fingerprints to avoid compromising what\nmay be legitimate investigations.\n\n##### 5.1 FinSpy\n\n**Identifying and linking servers: We developed a number**\nof fingerprints for identifying FinSpy servers using HTTPbased probing as well as FinSpy’s custom TLV-based protocol. We leveraged quirks such as specific non-compliance\nwith RFC 2616, responses to certain types of invalid data,\nand the presence of signatures such as the bizarre “Hallo\nSteffi” that Guarnieri identified from Bahraini FinSpy C&C\nservers [67, 68]. See Appendix A for details. We then exhaustively scanned the Internet looking for matches to these fingerprints.\nGamma documentation advertises that an operator of FinSpy\ncan obscure the location of the C&C server (called the mas_ter) by setting up a proxy known as a relay. In Spring 2013_\nwe noticed FinSpy servers now issuing 302 Redirects to\ngoogle.com. However, we noticed anomalies: for example, servers in India were redirecting to the Latvian version of Google google.lv. We suspect that the server\nin India was a relay forwarding to a master in Latvia. Because the master served as a proxy for Google, we could\nuncover its IP address using a Google feature that prints a\nuser’s IP address for the query “IP address.” We created an\nadditional fingerprint based on the proxying behavior and issued GET /search?q=ip+address&nord=1 requests to\nservers We note some interesting master locations in Table 4.\n**Server locations: In all, our fingerprints matched 92 dis-**\ntinct IP addresses in 35 different countries. Probing these on\n8/8/13 revealed 22 distinct addresses still responding, sited\nin: Bahrain, Bangladesh, Bosnia and Herzegovina, Estonia,\nEthiopia, Germany, Hong Kong, Indonesia, Macedonia, Mexico, Romania, Serbia, Turkmenistan, and the United States. We\nfound servers responding to a number of our fingerprints, suggesting either that some servers lag in their updates, or a concerted effort to vary the behavior of FinSpy servers to make\ndetection harder.\nWe found: (1) 3 IP addresses in ranges registered to Gamma.\n**(2) Servers in 3 IP ranges explicitly registered to govern-**\nment agencies: Turkmenistan’s Ministry of Communications,\nQatar’s State Security Bureau, and the Bulgarian Council of\nMinisters. **(3) 3 additional IP addresses in Bahrain, all in**\nBatelco. (4) Servers in 7 countries with governments classified\nas “authoritarian regimes” by The Economist [69]: Bahrain,\nEthiopia, Nigeria, Qatar, Turkmenistan, UAE, Vietnam.\n**Additional FinSpy samples: In parallel to our scanning,**\nwe obtained 9 samples of FinSpy by writing YARA [70] rules\nfor the “malware hunting” feature of VirusTotal Intelligence.\nThis feature sends us all newly-submitted samples that match\nour signatures. We located a version of FinSpy that does not\nuse the normal FinSpy handshake, but instead uses a protocol\nbased on HTTP POST requests for communication with the\nC&C server. This did not appear to be an older or newer ver\n\n-----\n\n|Relay IP|Relay Block Assignment|Relay Country|Master IP|Master Block Assignment|Master Country|\n|---|---|---|---|---|---|\n|5.199.xxx.xxx|SynWebHost|Lithuania|188.219.xxx.xx|Vodafone|Italy|\n|46.23.xxx.xxx|UK2 VPS.net|UK|78.100.xxx.xxx|State Security Building|Qatar|\n|119.18.xxx.xxx|HostGator|India|81.198.xxx.xxx|Statoil DSL|Latvia|\n|180.235.xxx.xxx|Asia Web Services|Hong Kong|80.95.xxx.xxx|T-Systems|Czech Republic|\n|182.54.xxx.xxx|GPLHost|Australia|180.250.xxx.xxx|PT Telekom|Indonesia|\n|206.190.xxx.xxx|WestHost|USA|112.78.xxx.xxx|Biznet ISP|Indonesia|\n|206.190.xxx.xxx|Softlayer|USA|197.156.xxx.xxx|Ethio Telecom|Ethiopia|\n|209.59.xxx.xxx|Endurance International|USA|59.167.xxx.xxx|Internode|Australia|\n|209.59.xxx.xxx|Endurance International|USA|212.166.xxx.xxx|Vodafone|Spain|\n\n\n###### Table 4: Deproxifying FinSpy (mapping initial C&C IP addresses to the masters to which they forward).\n\nsion of the protocol, suggesting that our scan results may not **Country** **IPs** **Provider**\nreveal the full scope of FinSpy C&C servers. Perhaps, the United States 61 Linode\nHTTP POST protocol was only delivered to a specific Gamma United Kingdom 18 NOC4Hosts\ncustomer to meet a requirement. Italy 16 Telecom Italia\n\nJapan 10 Maroc Telecom\nMorocco 7 InfoLink\n\n##### 5.2 Remote Control System (RCS)\n\n|Country|IPs|\n|---|---|\n|United States|61|\n|United Kingdom|18|\n|Italy|16|\n|Japan|10|\n|Morocco|7|\n\n|Provider|IPs|\n|---|---|\n|Linode|42|\n|NOC4Hosts|16|\n|Telecom Italia|9|\n|Maroc Telecom|7|\n|InfoLink|6|\n\n\nWe began by analyzing the UAE RCS sample from Ahmed and\n6 samples obtained from VirusTotal by searching for AV results containing the strings “DaVinci” and “RCS.” At the time,\nseveral AV vendors had added detection for RCS based on a\nsample analyzed by Dr. Web [71] and the UAE RCS sample\nsent to Ahmed. We also similarly obtained and analyzed samples of FSBSpy [72], a piece of malware that can report system\ninformation, upload screenshots, and drop and execute more\nmalware, Based on these samples, we devised YARA signatures that yielded 23 additional samples of structurally similar\nmalware.\n**Fingerprints: We probed the C&C servers of the RCS and**\nFSBSpy samples, and found that they responded in a distinctive way to HTTP requests, and returned distinctive SSL certificates.\nWe searched sources including Shodan, 5 Internet Census\nservice probes [73], and Critical.IO scanning data [68] for the\nobserved distinctive HTTP behavior. We searched for the distinctive SSL certificates in two Internet Census service probes,\nand SSL certificate scans from ZMap [74]. We also contacted a\nteam at TU Munich [75], who applied our fingerprints to their\nSSL scanning data. Across all of these sources, we obtained\n31,345 indicator hits reflecting 555 IP addresses in 48 countries.\nOne SSL certificate returned by 175 of the servers was issued\nby “/CN=RCS Certification Authority /O=HT srl,” apparently\nreferring to the name of the spyware and the company. Servers\nfor 5 of our FSBSpy samples and 2 of our RCS samples responded with this type of certificate.\nSome servers returned these certificates in chains that included another distinctive certificate. We found 175 distinct IP\naddresses (including the C&C’s for 5 of our FSBSpy samples\nand 2 of our RCS samples) responded with this second type of\ncertificate.\nWe devised two more indicators: one that matched 125 IP\naddresses, including 7 of our FSBSpy samples’ C&C’s, and\none that matched 2 IP addresses, in Italy and Kazakhstan.\n**Server locations: On 11/4/13 we probed all of the IP ad-**\ndresses that we collected, finding 166 active addresses match\n\n###### Table 5: Top countries and hosting providers for RCS servers active on 11/4/13.\n\ning one of our fingerprints in 29 different countries. We summarize the top providers and countries in Table 5.\nThe prevalence of active servers either located in the USA or\nhosted by Linode is striking,[8] and seems to indicate a pervasive\nuse of out-of-country web hosting and VPS services.\nIn addition, we found: (1) 3 IP addresses on a /28 named\n“HT public subnet” that is registered to the CFO of Hacking\nTeam [76]. The domain hackingteam.it resolves to an\naddress in this range. (2) An address belonging to Omantel, a\nmajority-state-owned telecom in Oman. This address was unreachable when we probed it; a researcher pointed us to an FSBSpy sample that contained an Arabic-language bait document\nabout Omani poetry, which talked to a C&C in the UK. (3) 7\nIP addresses belonging to Maroc Telecom. Moroccan journalists at Mamfakinch.com were previously targeted by RCS in\n2012 [77]. (4) Overall, servers in 8 countries with governments\ndeemed “authoritarian regimes” [69]: Azerbaijan, Kazakhstan,\nNigeria, Oman, Saudi Arabia, Sudan, UAE, Uzbekistan.\n**Link to Hacking Team:** All active servers matching one of our signatures also responded peculiarly when\nqueried with particular ill-formed HTTP requests, responding with “HTTP1/1 400 Bad request” (should be\n“HTTP/1.1”) and a body of “Detected error: HTTP\ncode 400”. Googling for this response yielded a GitHub\nproject em-http-server [78], a Ruby-based webserver.\nThe project’s author is listed as Alberto Ornaghi, a software\narchitect at Hacking Team. We suspect that the Hacking Team\nC&C server code may incorporate code from this project.\n**Links between servers: We identified many cases where**\nseveral servers hosted by different providers, and in different\ncountries, returned identical SSL certificates matching our fingerprints. We also observed 30 active servers used a global\nIPID. Only one active server had neither a global IPID nor\n\n819 of the 42 Linode servers were hosted in the USA, so the two\npatterns of prevalence are mostly distinct.\n\n\n-----\n\nan SSL certificate matching our fingerprints. We assessed\nwhether servers returning SSL certificates were forwarding to\nthe servers with global IPIDs by inducing bursts of traffic at the\nformer and monitoring the IPID at the latter. For 11 servers,\nwe found that the server’s activity correlated to bursts sent to\nother servers We grouped servers by the SSL certificates they\nreturned, and found that each group forwarded to only a single server, except for one case where a group forwarded to two\ndifferent IPs (both in Morocco). We also found two groups\nthat forwarded to the same address. There was a 1:1 mapping\nbetween the remaining 8 addresses and groups. We refer to a\ngroup along with the server(s) it forwards to as a server group.\nWe identified several server groups that may be associated with\nvictims or operators in a certain country. Some of these suggest\npossible further investigation:\n**Turkey: We identified a group containing 20 servers in 9**\ncountries. Two RCS and 5 FSBSpy samples from VirusTotal communicated with various servers in the group. The RCS\nsamples also communicated with domains with lapsed registrations, so we registered them to observe incoming traffic. We exclusively received RCS traffic from Turkish IP addresses. (RCS\ntraffic is identifiable based on a distinctive user agent and URL\nin POST requests.) A sample of FSBSpy apparently installed\nfrom an exploit on a Turkish server talked to one of the servers\nin this group.[79]\nWe also found server groups containing servers in Uzbek**istan and Kazakhstan; we found FSBSpy samples on Virus-**\nTotal uploaded from these countries that communicated with\nservers in these groups.\nIn the above cases, save Turkey, the country we have identified is classified as an “authoritarian regime,” and may be using\nHacking Team products against the types of targets we profile\nin this paper. In the case of Turkey, there are hints that the tool\nmay be employed against dissidents [80].\n\n##### 6 Summary\n\nTargeted surveillance of individuals conducted by nation-states\nposes an exceptionally challenging security problem, given the\ngreat imbalance of resources and expertise between the victims\nand the attackers. We have sketched the nature of this problem\nspace as reported to us by targeted individuals in three Middle\nEastern countries. The attacks include spyware for ongoing\nmonitoring and the use of “IP spy” links to deanonymize those\nwho voice dissent.\nThe attacks, while sometimes incorporating effective social engineering, in general lack novel technical elements. Instead, they employ prepackaged tools developed by vendors\nor acquired from the cybercrime underground. This technology sometimes suffers from what strike us as amateurish mistakes (multiple serious errors implementing cryptography, broken protocol messages), as does the attackers’ employment of\nit (identifying-information embedded in binaries, C&C servers\ndiscoverable via scanning or “Google hacking”, clusters of attack accounts tied by common activity). Some of these errors\nassisted our efforts to assemble strong circumstantial evidence\nof governmental origins. In addition, we mapped out the global\nuse of two “governmental” hacking suites, including identify\n\ning 11 cases in which they appeared to be used in countries\ngoverned by “authoritarian regimes.”\nWe aim with this work to inspire additional research efforts\naddressing the difficult problem of how to adequately protect\nindividuals with very limited resources facing very powerful\nadversaries. Open questions include robust, practical detection\nof targeted attacks designed to exfiltrate data from a victim’s\ncomputer, as well as detection of and defense against novel attack vectors, like tampering with Internet connections to insert\nmalware.\nThe task is highly challenging, but the potential stakes are\nlikewise very high. An opposition member, reflecting on government hacking in Libya, speculated as to why some users\nwould execute files even while recognizing them as potentially\nmalicious [2]: “If we were vulnerable we couldn’t care less ...\n_we were desperate to get our voices out ... it was a matter of_\n_life or death ... it was just vital to get this information out.”_\n\n##### Acknowledgment\n\nThis work was supported by the National Science Foundation\nunder grants 1223717 and 1237265, and by a Citizen Lab Fellowship. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors\nand do not necessarily reflect the views of the sponsors.\nThe authors would like to thank the following individuals\nfor their help in various aspects of our analysis: Bernhard Amman, Collin D. Anderson, Brandon Dixon, Zakir Durumeric,\nEva Galperin, Claudio Guarnieri, Drew Hintz, Ralph Holz,\nShane Huntley, Andrew Lyons, Mark Schloesser, and Nicholas\nWeaver.\n\n##### References\n\n[1] “Dark Secrets—Hacking Team commercial,” accessed: 12-November-2013. [Online]. Available:\nhttp://bit.ly/1bCh57v\n\n[2] J. Scott-Railton, “Revolutionary Risks: Cyber Technology and Threats in the 2011 Libyan Revolution,” US\nNaval War College, Tech. Rep., 2013.\n\n[3] S. H. AlJalahma, “Response to The Guardian—UK\ncompanys software used against Bahrain activist,” May\n2013, accessed: 12-November-2013. [Online]. Available:\nhttp://bit.ly/19iVUUP\n\n[4] V. Silver, “Gamma Says No Spyware Sold to\nBahrain; May Be Stolen Copy,” Jul. 2012, accessed: 12-November-2013. [Online]. Available:\nhttp://bloom.bg/17SOXQs\n\n[5] A. Jeffries, “Meet Hacking Team, the company that helps\nthe police hack you,” Sep. 2013, accessed: 12-November2013. [Online]. Available: http://bit.ly/1bCajyl\n\n[6] T. Brewster, “From Bahrain To Belarus: Attack Of The\nFake Activists,” Jul. 2013, accessed: 12-November-2013.\n\n[Online]. Available: http://bit.ly/1gIgwhW\n\n[7] V. Silver, “MJM as Personified Evil Says Spyware Saves\nLives Not Kills Them,” 2011, accessed: 12-November2013. [Online]. Available: http://bloom.bg/170E8sQ\n\n\n-----\n\n[8] D. Gilbert, “Hacking Team and the Murky World of\nState-Sponsored Spying,” 2013, accessed: 12-November2013. [Online]. Available: http://bit.ly/17tBBtm\n\n[9] R. Clayton, S. J. Murdoch, and R. N. Watson, “Ignoring\nthe Great Firewall of China,” in PETS. Springer, 2006,\npp. 20–35.\n\n[10] J. R. Crandall et al., “ConceptDoppler: A Weather\nTracker for Internet Censorship,” in ACM CCS, 2007.\n\n[11] X. Xu, Z. M. Mao, and J. A. Halderman, “Internet Censorship in China: Where Does the Filtering Occur?” in\n_Proc. PAM, 2011._\n\n[12] M. Sherr, G. Shah, E. Cronin, S. Clark, and M. Blaze,\n“Can They Hear Me Now? A Security Analysis of Law\nEnforcement Wiretaps,” in ACM CCS, 2009, pp. 512–\n523.\n\n[13] J. R. Crandall, M. Crete-Nishihata, and J. Knockel, “Chat\nprogram censorship and surveillance in China: Tracking\nTOM-Skype and Sina UC,” First Monday, vol. 18, no. 7,\nJul. 2013, accessed: 8-August-2013. [Online]. Available:\nhttp://bit.ly/1fzNcHl\n\n[14] S. Wolchok, R. Yao, and J. A. Halderman, “Analysis of\nthe Green Dam Censorware System,” Tech. Rep., 2009.\n\n[15] F. Li, A. Lai, and D. Ddl, “Evidence of Advanced Persistent Threat: A case study of malware for political espionage,” in MALWARE, 2011.\n\n[16] “Default https access for Gmail,” 2010, accessed: 7August-2013. [Online]. Available: http://bit.ly/1bBktPM\n\n[17] “Making Twitter more secure: HTTPS,” 2011, accessed:\n7-August-2013. [Online]. Available: http://bit.ly/1i7l9kM\n\n[18] L. Constantin, “Facebook to roll out HTTPS by default\nto all users,” 2012, accessed: 7-August-2013. [Online].\nAvailable: http://bit.ly/1bsLBCm\n\n[19] “FinFisher: Governmental IT Intrusion and Remote\nMonitoring Solutions,” accessed: 12-November-2013.\n\n[Online]. Available: http://bit.ly/1840Lxn\n\n[20] “BlackBerry rogue software leaves sour taste in UAE,”\n2013, accessed: 11-November-2013. [Online]. Available:\nhttp://on.ft.com/HVXvJP\n\n[21] Mandiant, “The Advanced Persistent Threat,” 2010.\n\n[22] ——, “APT1: Exposing One of China’s Cyber Espionage\nUnits,” 2013.\n\n[23] S. Fagerland, M. Krakvik, J. Camp, and N. Moran, “Operation Hangover: Unveiling an Indian Cyberattack Infrastructure,” 2013.\n\n[24] R. Deibert and R. Rohozinski, “Tracking GhostNet: Investigating a Cyber Espionage Network,” Information\n_Warfare Monitor, p. 6, 2009._\n\n[25] S. Nagaraja and R. Anderson, “The snooping dragon:\nsocial-malware surveillance of the Tibetan movement,”\nTech. Rep., 2009.\n\n[26] F. C. Solutions, ““njRAT” Uncovered,” 2013, accessed:\n25-June-2013. [Online]. Available: http://bit.ly/1eJheel\n\n\n\n[27] “FinFisher - Excellence in IT Investigation,” accessed: 27-February-2014. [Online]. Available:\nhttp://www.finfisher.com/\n\n[28] R. Rolles, “Unpacking virtualization obfuscators,” in\n_USENIX WOOT, 2009._\n\n[29] “TEMU: The BitBlaze Dynamic Analysis Component,” accessed: 7-August-2013. [Online]. Available:\nhttp://bit.ly/1clcxSZ\n\n[30] “‘Reinstate sacked official’ call,” 2013, accessed: 11-November-2013. [Online]. Available:\nhttp://bit.ly/1aRUZ4b\n\n[31] “Unionist Questioned,” 2013, accessed: 23-April-2013.\n\n[Online]. Available: http://bit.ly/1gHnBiS\n\n[32] N. Villeneuve, “Fake Skype Encryption Service Cloaks\nDarkComet Trojan,” Apr. 2012, accessed: 4-August2013. [Online]. Available: http://bit.ly/17SpA1c\n\n[33] E. Galperin and M. Marquis-Boire, “Fake YouTube\nSite Targets Syrian Activists With Malware,” Mar.\n2012, accessed: 4-August-2013. [Online]. Available:\nhttp://bit.ly/HSCRet\n\n[34] ——, “New Wave of Facebook Phishing Attacks Targets\nSyrian Activists,” Apr. 2012, accessed: 4-August-2013.\n\n[Online]. Available: http://bit.ly/1hDQsG8\n\n[35] ——, “Pro-Syrian Government Hackers Target Activists\nWith Fake Anti-Hacking Tool,” Aug. 2012, accessed:\n4-August-2013. [Online]. Available: http://bit.ly/1eJj12T\n\n[36] J. Scott-Railton and M. Marquis-Boire, “A Call to Harm:\nNew Malware Attacks Target the Syrian Opposition,”\nCitizen Lab, Tech. Rep., Jun. 2013, accessed: 3-August2013. [Online]. Available: http://bit.ly/1a2l9PK\n\n[37] E. Galperin and M. Marquis-Boire, “Trojan Hidden\nin Fake Revolutionary Documents Targets Syrian Activists,” May 2012, accessed: 4-August-2013. [Online].\nAvailable: http://bit.ly/1cSJT0\n\n[38] M. Marquis-Boire and S. Hardy, “Syrian Activists Targeted with BlackShades Spy Software,” Jun. 2012,\naccessed: 12-November-2013. [Online]. Available:\nhttp://bit.ly/1a2l6mX\n\n[39] S. Fagerland, “The Syrian Spyware,” Feb. 2012,\naccessed: 4-August-2013. [Online]. Available:\nhttp://bit.ly/HLyGR9\n\n[40] Telecomix, “REPORT of a Syrian spyware,” p. 9, Feb.\n2012, accessed: 4-August-2013. [Online]. Available:\nhttp://bit.ly/1bsNcIk\n\n[41] S. Faris, “The Hackers of Damascus,” Nov.\n2012, accessed: 9-August-2013. [Online]. Available:\nhttp://buswk.co/17t8RRH\n\n[42] L. Aylward, “Malware Analysis—Dark Comet RAT,”\nNov. 2011, accessed: 4-August-2013. [Online]. Available: http://bit.ly/16ZXgag\n\n[43] Quequero, “DarkComet Analysis—Understanding the\nTrojan used in Syrian Uprising,” Mar. 2012, accessed:\n4-August-2013. [Online]. Available: http://bit.ly/19i6kEl\n\n\n-----\n\n[44] S. Denbow and J. Hertz, “Pest Control: Taming the\nRATs,” p. 14, accessed: 12-November-2013. [Online].\nAvailable: http://bit.ly/1fzLA0m\n\n[45] B. Brumfield, “Computer spyware is newest weapon in\nSyrian conflict,” Feb. 2012, accessed: 4-August-2013.\n\n[Online]. Available: http://cnn.it/HLz5TA\n\n[46] “jalnosra.com,” accessed: 27-February-2014. [Online].\nAvailable: jalnosra.com\n\n[47] “Skype Encryption.wmv,” accessed: 27-February-2014.\n\n[Online]. Available: http://bit.ly/HZ3e1y\n\n[48] E. Galperin and M. Marquis-Boire, “The Internet\nis Back in Syria and So is Malware Targeting\nSyrian Activists,” Dec. 2012, accessed: 4-August-2013.\n\n[Online]. Available: http://bit.ly/1bngqFc\n\n[49] “Free Syrian Army Sex Tape—Abdul Razzaq Tlass\n\n[NSFW],” accessed: 5-August-2013. [Online]. Available:\nhttp://bit.ly/1gHqDDH\n\n[50] A. Lund, “Holy Warriors: A field guide to Syria’s jihadi\ngroups,” Oct. 2012, accessed: 5-August-2013. [Online].\nAvailable: http://atfp.co/17t8yq5\n\n[51] “Ahmed Mansoor and Four Other Pro-Democracy\nActivists Pardoned and Freed,” 2013, accessed: 10-November-2013. [Online]. Available:\nhttp://bit.ly/18pHpis\n\n[52] “Royal Group,” accessed: 27-February-2014. [Online].\nAvailable: http://www.royalgroupuae.com/\n\n[53] T. Katsuki, “Crisis for Windows Sneaks onto Virtual\nMachines,” 2012, accessed: 27-February-2014. [Online].\nAvailable: http://bit.ly/MzheRJ\n\n[54] “Hacking Team,” accessed: 27-February-2014. [Online].\nAvailable: http://www.hackingteam.it/\n\n[55] “MPRESS,” accessed: 27-February-2014. [Online].\nAvailable: http://www.matcode.com/mpress.htm\n\n[56] “Sign in using application-specific passwords,”\naccessed: 27-February-2014. [Online]. Available:\nhttps://support.google.com/accounts/answer/185833?hl=en\n\n[57] S. Fagerland, “Systematic cyber attacks against Israeli and Palestinian targets going on for a year,”\n2012, accessed: 12-November-2013. [Online]. Available:\nhttp://bit.ly/1aSdw07\n\n[58] V. Silver, “Spyware Leaves Trail to Beaten\nActivist Through Microsoft Flaw,” 2012, accessed: 14-November-2013. [Online]. Available:\nhttp://bloom.bg/1ja2geI\n\n[59] B. Hubbard, “Emirates Balk at Activism in Region\nHit by Uprisings,” 2013, accessed: 14-November-2013.\n\n[Online]. Available: http://nyti.ms/I4n2Aw\n\n[60] “SPY NET,” accessed: 27-February-2014. [Online].\nAvailable: http://newspynetrat.blogspot.com/\n\n[61] “Asprotect SKE,” accessed: 27-February-2014. [Online].\nAvailable: http://www.aspack.com/asprotect32.html\n\n[62] “Unpacking VBInject/VBCrypt/RunPE,” 2010, accessed: 7-August-2013. [Online]. Available:\nhttp://bit.ly/1e28nS2\n\n\n\n[63] “Ultimate Packer for eXecutables,” accessed: 27-February-2014. [Online]. Available:\nhttp://upx.sourceforge.net/\n\n[64] “CVE-2013-0422,” accessed: 27-February-2014. [Online]. Available: http://bit.ly/NA1O0A\n\n[65] njq8, “New java drive-by 2013-1-11,” 2013, accessed:\n27-February-2014. [Online]. Available: http://www.devpoint.com/vb/t357796.html\n\n[66] “Appin Technology Lab,” accessed: 27-February-2014.\n\n[Online]. Available: http://www.appinonline.com/\n\n[67] C. Guarnieri, “Analysis of the FinFisher Lawful\nInterception Malware,” 2012, accessed: 7-August-2013.\n\n[Online]. Available: http://bit.ly/1eJjVMV\n\n[68] H. Moore, “Critical Research: Internet Security Survey,”\n2012.\n\n[69] “Democracy Index 2012: Democracy at a Standstill,”\n2012, accessed: 7-August-2013. [Online]. Available:\nhttp://bit.ly/HSEDMD\n\n[70] “YARA - The pattern matching swiss knife for malware\nresearchers,” accessed: 27-February-2014. [Online].\nAvailable: http://plusvic.github.io/yara/\n\n[71] “Cross-platform Trojan controls Windows and Mac\nmachines,” 2012, accessed: 7-August-2013. [Online].\nAvailable: http://bit.ly/1eJnJgZ\n\n[72] S. Golovanov, “Adobe Flash Player 0-day and HackingTeam’s Remote Control System,” 2013, accessed:\n7-August-2013. [Online]. Available: http://bit.ly/17n12ro\n\n[73] “Internet Census 2012,” 2013, accessed: 7-August-2013.\n\n[Online]. Available: http://bit.ly/1i7rRHs\n\n[74] Z. Durumeric, E. Wustrow, and J. A. Halderman, “ZMap:\nFast Internet-Wide Scanning and its Security Applications,” in USENIX Security, Aug. 2013.\n\n[75] “Home of Crossbear and OONIBear,” accessed: 27-February-2014. [Online]. Available:\nhttps://pki.net.in.tum.de/\n\n[76] “RIPE Database Query for FASTWEB-HT,” accessed: 27-February-2014. [Online]. Available:\nhttp://bit.ly/MzkigV\n\n[77] “How Government-Grade Spy Tech Used A Fake Scandal\nTo Dupe Journalists,” 2012, accessed: 7-August-2013.\n\n[78] A. Ornaghi, “em-http-server,” accessed: 27-February2014. [Online]. Available: https://github.com/alor/emhttp-server\n\n[79] SophosLabs, “Anatomy of a targeted attack—\nSophosLabs explores an Adobe zero-day “malware\nexperiment”,” 2013, accessed 7-August-2013. [Online].\nAvailable: http://bit.ly/HQ1oRc\n\n[80] K. Zetter, “American Gets Targeted by Digital\nSpy Tool Sold to Foreign Governments,” 2013,\naccessed: 14-November-2013. [Online]. Available:\nhttp://wrd.cm/1fHonth\n\n[81] M. Marquis-Boire and B. Marczak, “From Bahrain\nWith Love: FinFisher’s Spy Kit Exposed?” Jul.\n2012, accessed: 4-August-2013. [Online]. Available:\nhttp://bit.ly/1bngpB2\n\n\n-----\n\n##### A FinSpy fingerprints\n\nPrevious work by Guarnieri on scanning for FinSpy servers\nfound that in response to a request such as GET /, the\nBahraini FinSpy C&C server returns a response with the string\n“Hallo Steffi” [67]. Guarnieri searched a database of\nsuch responses compiled by the Critical.IO Internet scanning\nproject [68], locating 11 additional servers in 10 countries [67].\nWe refer to this fingerprint as α1. Concurrent with this effort, we devised our own fingerprint β1 that tested three aspects of the handshake between a FinSpy infectee and a FinSpy C&C server, which follows a custom TLV-based protocol\nrunning on ports such as 22, 53, 80, and 443. We conducted\ntargeted scanning of several countries using β1, and also confirmed Guarnieri’s findings for those servers still reachable after he published his findings.\nWe observed a trend: changes in HTTP response behavior\nby FinFisher after publication of findings about the software.\nIn July 2012, for example, after a post about Bahraini FinSpy\nsamples [81], servers closed the TCP connection in response\nto a GET / or HEAD / request (although servers continued\nto behave consistently with β1. Other changes followed later\nin 2012, including a new response to GET / requests that included an imperfect copy of an Apache server’s HTTP response\n(the Date header used UTC rather than GMT). We fingerprinted\nthis error as α2, and later in 2012 fingerprinted other distinctive\nbehavior in response to GET / requests as α3.\nSubsequent scans of /0 for α2 and α3, and five service\nprobes of the Internet Census for α1 through α3, located several\nadditional servers. In Feburary 2013 we identified and fingerprinted new HTTP response behavior with α4 and modified β1\nto produce β2, which tests only two of the three aspects of the\nFinSpy handshake (the third test of β1 was broken when FinSpy servers were updated to accept types of invalid data they\nhad previously rejected).\nAs of 3/13/13, all servers that matched any α fingerprint\nmatched β2.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/idaqxp9usqbtbo80vhemh66shyvavagu",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2014/2014.09.08.When_Governments_Hack_Opponents/sec14-paper-marczak.pdf"
    ],
    "report_names": [
        "sec14-paper-marczak"
    ],
    "threat_actors": [
        {
            "id": "3cc6c262-df23-4075-a93f-b496e8908eb2",
            "created_at": "2022-10-25T16:07:23.682239Z",
            "updated_at": "2025-03-27T02:02:09.920109Z",
            "deleted_at": null,
            "main_name": "GhostNet",
            "aliases": [
                "GhostNet",
                "Snooping Dragon"
            ],
            "source_name": "ETDA:GhostNet",
            "tools": [
                "AngryRebel",
                "Farfli",
                "Gh0st RAT",
                "Gh0stnet",
                "Ghost RAT",
                "Ghostnet",
                "Moudour",
                "Mydoor",
                "PCRat",
                "Remosh",
                "TOM-Skype"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "88854a9f-641a-4412-89db-449b4d5cbc51",
            "created_at": "2022-10-25T16:07:23.963599Z",
            "updated_at": "2025-03-27T02:02:10.051548Z",
            "deleted_at": null,
            "main_name": "Operation HangOver",
            "aliases": [
                "Monsoon",
                "Operation HangOver",
                "Viceroy Tiger"
            ],
            "source_name": "ETDA:Operation HangOver",
            "tools": [
                "AutoIt backdoor",
                "BADNEWS",
                "BackConfig",
                "JakyllHyde",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd350b-de30-4d29-bbee-28159f26c8c2",
            "created_at": "2023-01-06T13:46:38.433736Z",
            "updated_at": "2025-03-27T02:00:02.832565Z",
            "deleted_at": null,
            "main_name": "VICEROY TIGER",
            "aliases": [
                "OPERATION HANGOVER",
                "Donot Team",
                "APT-C-35",
                "SectorE02",
                "Orange Kala"
            ],
            "source_name": "MISPGALAXY:VICEROY TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e91dae30-a513-4fb1-aace-4457466313b3",
            "created_at": "2023-01-06T13:46:38.974913Z",
            "updated_at": "2025-03-27T02:00:02.967085Z",
            "deleted_at": null,
            "main_name": "GhostNet",
            "aliases": [
                "Snooping Dragon"
            ],
            "source_name": "MISPGALAXY:GhostNet",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "dabb6779-f72e-40ca-90b7-1810ef08654d",
            "created_at": "2022-10-25T15:50:23.463113Z",
            "updated_at": "2025-03-27T02:00:55.47619Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "APT1",
                "Comment Crew",
                "Comment Group",
                "Comment Panda"
            ],
            "source_name": "MITRE:APT1",
            "tools": [
                "Seasalt",
                "ipconfig",
                "Cachedump",
                "PsExec",
                "GLOOXMAIL",
                "Lslsass",
                "PoisonIvy",
                "WEBC2",
                "Mimikatz",
                "gsecdump",
                "Pass-The-Hash Toolkit",
                "Tasklist",
                "xCmd",
                "pwdump"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1406206130,
    "ts_modification_date": 1406315498,
    "files": {
        "pdf": "https://archive.orkl.eu/2cfbb7b89a5e220b21bbf64161dc880c1b644017.pdf",
        "text": "https://archive.orkl.eu/2cfbb7b89a5e220b21bbf64161dc880c1b644017.txt",
        "img": "https://archive.orkl.eu/2cfbb7b89a5e220b21bbf64161dc880c1b644017.jpg"
    }
}