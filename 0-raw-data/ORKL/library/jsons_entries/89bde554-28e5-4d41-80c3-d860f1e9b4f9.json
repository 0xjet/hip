{
    "id": "89bde554-28e5-4d41-80c3-d860f1e9b4f9",
    "created_at": "2023-01-12T15:05:09.235037Z",
    "updated_at": "2025-03-27T02:10:54.356005Z",
    "deleted_at": null,
    "sha1_hash": "ef68cfc8becfca82fe097ed4f4f99222dabab6d0",
    "title": "2022-09-15 - F5 BIG-IP Vulnerability (CVE-2022-1388) Exploited by BlackTech",
    "authors": "",
    "file_creation_date": "2022-10-02T12:13:43Z",
    "file_modification_date": "2022-10-02T12:13:43Z",
    "file_size": 1530695,
    "plain_text": "# F5 BIG-IP Vulnerability (CVE-2022-1388) Exploited by BlackTech\n\n**blogs.jpcert.or.jp/en/2022/09/bigip-exploit.html**\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\nSeptember 15, 2022\n\n[BlackTech](https://blogs.jpcert.or.jp/en/tags/blacktech/)\n\n[Email](mailto:?subject=F5%20BIG-IP%20Vulnerability%20%28CVE-2022-1388%29%20Exploited%20by%20BlackTech&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2022%2F09%2Fbigip-exploit.html)\n\nAround May 2022, JPCERT/CC confirmed an attack activity against Japanese organizations\nthat exploited F5 BIG-IP vulnerability (CVE-2022-1388). The targeted organizations have\nconfirmed that data in BIG-IP has been compromised. We consider that this attack is related\nto the activities by BlackTech attack group. This blog article describes the attack activities\nthat exploit this BIG-IP vulnerability.\n\n### Attack code that exploits the BIG-IP vulnerability\n\nBelow is a part of the attack code used in the attack. This attack tool enables attackers to\nexecute arbitrary commands on BIG-IP.\n\n\n-----\n\nFigure 1: A part of the confirmed code that exploits the BIG-IP vulnerability\nFigure 1 (grayed-out part) shows that multiple domestic BIG-IP IP addresses were listed in\nthe attack code and that they were the target of the attack. The attack code as well as\nmalware such as TSCookie and Bifrose, which is used by BlackTech, were found on the\nserver used by the attacker.\n\n\n-----\n\nFigure 2: Server where attack code was installed\nIn addition to known malware, new unidentified malware was discovered on this server,\nwhich is described in the following section.\n\n### Hipid\n\nThis malware targets Linux OS, and two types have been identified: one with a CPU\narchitecture compatible with ARM and the other with x64. It is unclear what type of device it\nwas created to run on, but it is possibly intended for IoT devices.\n\n\n-----\n\nFigure 3: A part of malware code (left: ARM type, right: x64 type)\nThis malware has a function to receive commands from the C2 server and execute arbitrary\ncommands. It uses a host command, not a system call, to resolve host names.\n\nFigure 4: A part of the\n\ncode to execute the host command\nThere are also two types in terms of sending data: one of them sends data with RC4\nencryption and the other sends data as it is. Some samples of the former have a unique\nbehavior of sending the S-Box data used for encryption to the server.\n\n\n-----\n\nFigure 5: A part of the code that sends S-Box data to the server\n\n### Distribution of Hipid using malicious PyPI packages\n\nAlthough this is not directly related to the attack that exploits the BIG-IP vulnerability, JFrog\nreports that the same type of malware as the one described above was registered as a\nmalicious PyPI package in the past[1]. Figure 6 shows the contents of the malicious\npackage's `setup.py . The attacker may not have taken control of the existing package but`\ninstalled malware on PyPi to install the package on the compromised system.\n\n\n-----\n\nFigure 6: Contents of setup.py\nThe malware itself was included in `__init.py__ encoded in Base32 as shown in Figure 7.`\nThe malware is installed after decoding, overwriting `/usr/sbin/syslogd .`\n\n\n-----\n\nFigure 7: Base64-encoded malware\nIn addition, the mount command is used for the malware process to run to hide the process,\nas shown in Figure 8.\n\nFigure 8: Process hiding using the mount command\n\n### In closing\n\n\n-----\n\nThe incident described in this report is currently under control and is no longer influential in\nmany environments. BlackTech has been observed in a number of cases in recent years in\nwhich vulnerabilities in externally accessible systems are exploited. In the case described\nhere, the vulnerability was exploited shortly after it was disclosed, and thus patch\nmanagement continues to be important.\n\nShusei Tomonaga\n\n(Translated by Takumi Nakano)\n\n### Acknowledgments\n\n[We would like to thank JFrog Shachar Menashe for his assistance with this study.](https://twitter.com/srmish)\n\n**References**\n\n[1] JFrog Discloses 3 Remote Access Trojans in PyPI\n\n[https://jfrog.com/blog/jfrog-discloses-3-remote-access-trojans-in-pypi/](https://jfrog.com/blog/jfrog-discloses-3-remote-access-trojans-in-pypi/)\n\n**Appendix A: C2 servers**\n\n139.180.201.6\n108.160.138.235\n108.160.132.108\nnaaakkk.wikaba.com\nntstore.hosthampster.com\nblog.mysecuritycamera.com\n139.162.112.74\n\n**Appendix B: Malware hash value**\n\n9603b62268c2bbb06da5c99572c3dc2ec988c49c86db2abc391acf53c1cccceb\ncb1a536e11ae1000c1b29233544377263732ca67cd679f3f6b20016fbd429817\n3d18bb8b9a5af20ab10441c8cd40feff0aabdd3f4c669ad40111e3aa5e8c54b8\n\n[Email](mailto:?subject=F5%20BIG-IP%20Vulnerability%20%28CVE-2022-1388%29%20Exploited%20by%20BlackTech&body=https%3A%2F%2Fblogs.jpcert.or.jp%2Fen%2F2022%2F09%2Fbigip-exploit.html)\n\nAuthor\n\n朝長 [秀誠 (Shusei Tomonaga)](https://blogs.jpcert.or.jp/en/shu_tom/)\n\n\n-----\n\nSince December 2012, he has been engaged in malware analysis and forensics\ninvestigation, and is especially involved in analyzing incidents of targeted attacks. Prior to\njoining JPCERT/CC, he was engaged in security monitoring and analysis operations at a\nforeign-affiliated IT vendor. He presented at CODE BLUE, BsidesLV, BlackHat USA Arsenal,\nBotconf, PacSec and FIRST Conference. JSAC organizer.\n\nWas this page helpful?\n\n0 people found this content helpful.\n\nIf you wish to make comments or ask questions, please use this form.\n\nThis form is for comments and inquiries. For any questions regarding specific commercial\nproducts, please contact the vendor.\n\nplease change the setting of your browser to set JavaScript valid.\nThank you!\n\n## Related articles\n\nJPCERT/CC Releases URL Dataset of Confirmed Phishing Sites\n\nTrends of Reported Phishing Sites and Compromised Domains in 2021\n\n\n-----\n\nAttack Exploiting XSS Vulnerability in E-commerce Websites\n\nPHP Malware Used in Lucky Visitor Scam\n\nAttacks Embedding XMRig on Compromised Servers\n\n\n[Back](https://blogs.jpcert.or.jp/en/2022/09/phishurl-list.html)\n[Top](https://blogs.jpcert.or.jp/en/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-15 - F5 BIG-IP Vulnerability (CVE-2022-1388) Exploited by BlackTech.pdf"
    ],
    "report_names": [
        "2022-09-15 - F5 BIG-IP Vulnerability (CVE-2022-1388) Exploited by BlackTech.pdf"
    ],
    "threat_actors": [
        {
            "id": "2646f776-792a-4498-967b-ec0d3498fdf1",
            "created_at": "2022-10-25T15:50:23.475784Z",
            "updated_at": "2025-03-27T02:00:55.479958Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Palmerworm"
            ],
            "source_name": "MITRE:BlackTech",
            "tools": [
                "Kivars",
                "PsExec",
                "TSCookie",
                "Flagpro",
                "Waterbear"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d3a7123c-f519-49a0-a234-de24a1ef052a",
            "created_at": "2022-10-25T16:47:55.545211Z",
            "updated_at": "2025-03-27T02:05:17.254744Z",
            "deleted_at": null,
            "main_name": "BRONZE CANAL",
            "aliases": [
                "CTG-6177 ",
                "Circuit Panda ",
                "Palmerworm ",
                "Shrouded Crossbow ",
                "BlackTech"
            ],
            "source_name": "Secureworks:BRONZE CANAL",
            "tools": [
                " DRIGO",
                " Flagpro",
                " Gh0stTimes",
                " PLEAD",
                " Spiderpig",
                " Waterbear",
                "Bifrose"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "75024aad-424b-449a-b286-352fe9226bcb",
            "created_at": "2023-01-06T13:46:38.962724Z",
            "updated_at": "2025-03-27T02:00:02.964002Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "CIRCUIT PANDA",
                "Temp.Overboard",
                "G0098",
                "Red Djinn",
                "HUAPI",
                "Palmerworm",
                "T-APT-03",
                "Manga Taurus",
                "Earth Hundun"
            ],
            "source_name": "MISPGALAXY:BlackTech",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "efa7c047-b61c-4598-96d5-e00d01dec96b",
            "created_at": "2022-10-25T16:07:23.404442Z",
            "updated_at": "2025-03-27T02:02:09.781478Z",
            "deleted_at": null,
            "main_name": "BlackTech",
            "aliases": [
                "BlackTech",
                "Circuit Panda",
                "Earth Hundun",
                "Manga Taurus",
                "Operation PLEAD",
                "Operation Shrouded Crossbow",
                "Operation Waterbear",
                "Palmerworm",
                "Radio Panda",
                "Red Djinn",
                "T-APT-03",
                "TEMP.Overboard"
            ],
            "source_name": "ETDA:BlackTech",
            "tools": [
                "BIFROST",
                "BUSYICE",
                "BendyBear",
                "Bluether",
                "CAPGELD",
                "DRIGO",
                "Deuterbear",
                "Flagpro",
                "GOODTIMES",
                "Gh0stTimes",
                "IconDown",
                "KIVARS",
                "LOLBAS",
                "LOLBins",
                "Linopid",
                "Living off the Land",
                "TSCookie",
                "Waterbear",
                "XBOW",
                "elf.bifrose"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535909,
    "ts_updated_at": 1743041454,
    "ts_creation_date": 1664712823,
    "ts_modification_date": 1664712823,
    "files": {
        "pdf": "https://archive.orkl.eu/ef68cfc8becfca82fe097ed4f4f99222dabab6d0.pdf",
        "text": "https://archive.orkl.eu/ef68cfc8becfca82fe097ed4f4f99222dabab6d0.txt",
        "img": "https://archive.orkl.eu/ef68cfc8becfca82fe097ed4f4f99222dabab6d0.jpg"
    }
}