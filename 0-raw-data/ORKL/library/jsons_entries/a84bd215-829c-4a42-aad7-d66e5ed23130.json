{
    "id": "a84bd215-829c-4a42-aad7-d66e5ed23130",
    "created_at": "2023-01-12T14:59:49.244373Z",
    "updated_at": "2025-03-27T02:09:58.793372Z",
    "deleted_at": null,
    "sha1_hash": "f632eb33fce9a601bdc0ceaaa08ca74601a66dc4",
    "title": "2019-01-25 - Toolkit collection developed to help malware analysts dissecting and detecting the packer used by GreyEnergy samples.",
    "authors": "",
    "file_creation_date": "2022-05-28T17:01:37Z",
    "file_modification_date": "2022-05-28T17:01:37Z",
    "file_size": 141614,
    "plain_text": "# NozomiNetworks/greyenergy-unpacker: Toolkit collection developed to help malware analysts dissecting and detecting the packer used by GreyEnergy samples.\n\n**github.com/NozomiNetworks/greyenergy-unpacker**\n\nNozomiNetworks\n\n## Repository\n\nToolkit collection developed to help malware analysts dissecting and detecting the packer\nused by GreyEnergy samples.\n\n## Packer Overview\n\nThe GreyEnergy dropper is protected using a custom packer with the following\ncharacteristics:\n\nCustom decryption algorithm\nLZW (variant) decompression algorithm\nJunk code & JMP instructions (anti-analysis)\nMemory wiping (anti-forensic)\nDynamically-resolved WinAPIs\nOverlay data payload (There are no suspicious sections in the PE header.)\n\nOnce the dropper has been decrypted/decompressed in memory, the packer performs the\nfollowing steps:\n\n\n-----\n\nParses the dropper s PE header, searching for the appended data\nCopies the final malware in memory, reading it from the appended data\nResolves the dropper's imports\nRelocates the dropper's executable\nJumps to the dropper's entry point\n\nThe dropper stores the final malware in the filesystem, establishing persistence.\n\n## greyenergy_unpacker.py\n\nAn easy-to-run tool that automatically extracts GreyEnergy packed files.\n\n## Usage\n\nUnpacks the malware storing it on the disk.\n```\npython3 greyenergy_unpacker.py -f suspicious.bin\nINFO : Processing the file 'suspicious.bin' (SHA256\nd4e97a18be820a1a3af639c9bca21c5f85a3f49a37275b37fd012faeffcb7c4a)\nINFO : Malware unpacked in 'suspicious.bin_malware_unpacked.bin' (SHA256\n7e154d5be14560b8b2c16969effdb8417559758711b05615513d1c84e56be076)\n\n```\nUnpacks the malware dumping also the dropper component.\n```\npython3 greyenergy_unpacker.py -d -f suspicious.bin\nINFO : Processing the file 'suspicious.bin' (SHA256\nd4e97a18be820a1a3af639c9bca21c5f85a3f49a37275b37fd012faeffcb7c4a)\nINFO : Dropper unpacked in 'suspicious.bin_dropper_unpacked.bin' (SHA256\na7d3f2b6cec72a324c375e4335e42b1f1f4d9642347d38f3de7ec706fcf25147)\nINFO : Malware unpacked in 'suspicious.bin_malware_unpacked.bin' (SHA256\n7e154d5be14560b8b2c16969effdb8417559758711b05615513d1c84e56be076)\n\n## Yara module\n\n```\nThe file `greyenergy.c is a YARA module developed to parse the GreyEnergy packer,`\ndecrypting only the first part of the appdata in order to confirm the detection.\n\nAfter the compilation, it is possible to detect the malicious file just using the new keyword\n```\nis_packed .\n\n## Installation\n\n```\n[Detailed information about the compilation can be found in the official Yara documentation](https://yara.readthedocs.io/en/v3.7.0/writingmodules.html#writing-modules)\n\nThe file `build.sh contained inside the Yara's root directory configures and compiles`\nautomatically the source code. Currently it is not mentioned in the documentation, so that\ncould be changed in the near future.\n\n\n-----\n\n## Rule example\n```\nimport \"pe\"\nimport \"greyenergy\"\nrule GreyEnergyPacker {\n condition:\n  greyenergy.is_packed(pe.overlay.offset)\n}\n\n Tested Samples\n\n```\nBoth the Yara module and the unpacker script have been successfully used to unpack the\nfollowing samples (SHA-256):\n```\nb60c0c04badc8c5defab653c581d57505b3455817b57ee70af74311fa0b65e22\nd4e97a18be820a1a3af639c9bca21c5f85a3f49a37275b37fd012faeffcb7c4a\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-01-25 - Toolkit collection developed to help malware analysts dissecting and detecting the packer used by GreyEnergy samples..pdf"
    ],
    "report_names": [
        "2019-01-25 - Toolkit collection developed to help malware analysts dissecting and detecting the packer used by GreyEnergy samples..pdf"
    ],
    "threat_actors": [
        {
            "id": "4d9cdc7f-72d6-4e17-89d8-f6323bfcaebb",
            "created_at": "2023-01-06T13:46:38.82716Z",
            "updated_at": "2025-03-27T02:00:02.928984Z",
            "deleted_at": null,
            "main_name": "GreyEnergy",
            "aliases": [],
            "source_name": "MISPGALAXY:GreyEnergy",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535589,
    "ts_updated_at": 1743041398,
    "ts_creation_date": 1653757297,
    "ts_modification_date": 1653757297,
    "files": {
        "pdf": "https://archive.orkl.eu/f632eb33fce9a601bdc0ceaaa08ca74601a66dc4.pdf",
        "text": "https://archive.orkl.eu/f632eb33fce9a601bdc0ceaaa08ca74601a66dc4.txt",
        "img": "https://archive.orkl.eu/f632eb33fce9a601bdc0ceaaa08ca74601a66dc4.jpg"
    }
}