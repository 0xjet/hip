{
    "id": "85366266-8299-4b1e-92eb-7d9f859ffd14",
    "created_at": "2023-01-12T15:02:32.428693Z",
    "updated_at": "2025-03-27T02:16:34.906101Z",
    "deleted_at": null,
    "sha1_hash": "b72762ea39876ea79cfc82602718a5f5fe1d230d",
    "title": "2021-11-17 - Ransomware (R)evolution Plagues Organizations, But CrowdStrike Protection Never Wavers",
    "authors": "",
    "file_creation_date": "2022-05-28T16:14:08Z",
    "file_modification_date": "2022-05-28T16:14:08Z",
    "file_size": 1328723,
    "plain_text": "# How CrowdStrike Prevents Volume Shadow Tampering by LockBit\n\n**[crowdstrike.com/blog/how-crowdstrike-prevents-volume-shadow-tampering-by-lockbit-ransomware/](https://www.crowdstrike.com/blog/how-crowdstrike-prevents-volume-shadow-tampering-by-lockbit-ransomware/)**\n\nThomas Moses - Sarang Sonawane - Liviu Arsene November 17, 2021\n\nECrime activities dominate the threat landscape, with ransomware as the main driver\nRansomware operators constantly refine their code and the efficacy of their operations\nCrowdStrike uses improved behavior-based detections to prevent ransomware from\ntampering with Volume Shadow Copies\nVolume Shadow Copy Service (VSS) backup protection nullifies attackers’ deletion\nattempts, retaining snapshots in a recoverable state\n\n[Ransomware is dominating the eCrime landscape and is a significant concern for](https://www.crowdstrike.com/cybersecurity-101/ransomware/)\norganizations, as it can cause major disruptions. ECrime accounted for over 75% of\ninteractive intrusion activity from July 2020 to June 2021, according to the recent\n[CrowdStrike 2021 Threat Hunting Report. The continually evolving big game hunting (BGH)](https://www.crowdstrike.com/resources/reports/threat-hunting-report-2021/)\nbusiness model has widespread adoption with access brokers facilitating access, with a\nmajor driver being dedicated leak sites to apply pressure for victim compliance. Ransomware\ncontinues to evolve, with threat actors implementing components and features that make it\nmore difficult for victims to recover their data.\n\n\n-----\n\n## Lockbit 2.0 Going for the Popularity Vote\n\nThe LockBit ransomware family has constantly been adding new capabilities, including\ntampering with Microsoft Server Volume Shadow Copy Service (VSS) by interacting with the\n[legitimate vssadmin.exe Windows tool. Capabilities such as lateral movement or destruction](https://www.crowdstrike.com/cybersecurity-101/lateral-movement/)\nof shadow copies are some of the most effective and pervasive tactics ransomware uses.\n\nFigure 1. LockBit 2.0 ransom note (Click to enlarge)\n\nThe LockBit 2.0 ransomware has similar capabilities to other ransomware families, including\nthe ability to bypass UAC (User Account Control), self-terminate or check the victim’s system\nlanguage before encryption to ensure that it’s not in a Russian-speaking country.\n\nFor example, LockBit 2.0 checks the default language of the system and the current user by\nusing the Windows API calls `GetSystemDefaultUILanguage` and\n```\nGetUserDefaultUILanguage . If the language code identifier matches the one specified,\n\n```\nthe program will exit. Figure 2 shows how the language validation is performed (function call\n```\n49B1C0 ).\n\n```\n\n-----\n\nFigure 2. LockBit 2.0 performing system language validation\n\nLockBit can even perform a silent UAC bypass without triggering any alerts or the UAC\npopup, enabling it to encrypt silently. It first begins by checking if it’s running under Admin\nprivileges. It does that by using specific API functions to get the process token\n( NTOpenProcessToken ), create a SID identifier to check the permission level\n( CreateWellKnownSid ), and then check whether the current process has sufficient admin\nprivileges ( CheckTokenMembership and `ZwQueryInformationToken` functions).\n\n\n-----\n\nFigure 3. Group SID permissions for running process\n\nIf the process is not running under Admin, it will attempt to do so by initializing a COM object\nwith elevation of the COM interface by using the elevation moniker COM initialization method\nwith guid: `Elevation:Administrator!new:{3E5FC7F9-9A51-4367-9063-`\n```\nA120244FBEC7} . A similar elevation trick has been used by DarkSide and REvil ransomware\n\n```\nfamilies in the past.\n\nLockBit 2.0 also has lateral movement capabilities and can scan for other hosts to spread to\nother network machines. For example, it calls the `GetLogicalDrives function to retrieve a`\nbitmask of currently available drives to list all available drives on the system. If the found\n\n\n-----\n\ndrive is a network share, it tries to identify the name of the resource and connect to it using\nAPI functions, such as `WNetGetConnectionW,` `PathRemoveBackslashW,`\n```\nOpenThreadToken and DuplicateToken .\n\n```\nIn essence, it’s no longer about targeting and compromising individual machines but entire\nnetworks. [REvil and LockBit are just some of the recent ransomware families that feature this](https://www.crowdstrike.com/blog/how-crowdstrike-stops-revil-ransomware-from-kaseya-attack/)\n[capability, while others such as Ryuk and WastedLocker share the same functionality. The](https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/)\nCrowdStrike Falcon OverWatch™ team found that in 36% of intrusions, adversaries can\nmove laterally to additional hosts in less than 30 minutes, according to the CrowdStrike 2021\nThreat Hunting Report.\n\nAnother interesting feature of LockBit 2.0 is that it prints out the ransom note message on all\nconnected printers found in the network, adding public shaming to its encryption and data\nexfiltration capabilities.\n\n## VSS Tampering: An Established Ransomware Tactic\n\nThe tampering and deletion of VSS shadow copies is a common tactic to prevent data\nrecovery. Adversaries will often abuse legitimate Microsoft administrator tools to disable and\nremove VSS shadow copies. Common tools include Windows Management Instrumentation\n(WMI), BCDEdit (a command-line tool for managing Boot Configuration Data) and\nvssadmin.exe. LockBit 2.0 utilizes the following WMI command line for deleting shadow\ncopies:\n```\nC:\\Windows\\System32\\cmd.exe /c vssadmin delete shadows /all /quiet & wmic shadowcopy\ndelete & bcdedit /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set\n{default} recoveryenabled no\n\n```\nThe use of preinstalled operating system tools, such as WMI, is not new. Still, adversaries\nhave started abusing them as part of the initial access tactic to perform tasks without\nrequiring a malicious executable file to be run or written to the disk on the compromised\nsystem. Adversaries have moved beyond malware by using increasingly sophisticated and\nstealthy techniques tailor-made to evade autonomous detections, as revealed by\nCrowdStrike Threat Graph®, which showed that 68% of detections indexed in April-June\n2021 were malware-free.\n\n## VSS Protection with CrowdStrike\n\nCrowdStrike Falcon takes a layered approach to detecting and preventing ransomware by\n[using behavior-based indicators of attack (IOAs) and advanced machine learning, among](https://www.crowdstrike.com/resources/white-papers/indicators-attack-vs-indicators-compromise/)\nother capabilities. We are committed to continually improving the efficacy of our technologies\nagainst known and unknown threats and adversaries.\n\n\n-----\n\nCrowdStrike s enhanced IOA detections accurately distinguish malicious behavior from\nbenign, resulting in high-confidence detections. This is especially important when\nransomware shares similar capabilities with legitimate software, like backup solutions. Both\ncan enumerate directories and write files that on the surface may seem inconsequential, but\nwhen correlated with other indicators on the endpoint, can identify a legitimate attack.\nCorrelating seemingly ordinary behaviors allows us to identify opportunities for coverage\nacross a wide range of malware families. For example, a single IOA can provide coverage\nfor multiple families and previously unseen ones.\n\nCrowdStrike’s recent innovation involves protecting shadow copies from being tampered\nwith, adding another protection layer to mitigate ransomware attacks. Protecting shadow\ncopies helps potentially compromised systems restore encrypted data with much less time\nand effort. Ultimately, this helps reduce operational costs associated with person-hours spent\nspinning up encrypted systems post-compromise.\n\nThe Falcon platform can prevent suspicious processes from tampering with shadow copies\nand performing actions such as changing file size to render the backup useless. For\ninstance, should a LockBit 2.0 ransomware infection occur and attempt to use the legitimate\nMicrosoft administrator tool (vssadmin.exe) to manipulate shadow copies, Falcon\nimmediately detects this behavior and prevents the ransomware from deleting or tampering\nwith them, as shown in Figure 4.\n\nFigure 4. Falcon detects and blocks vssadmin.exe manipulation by LockBit 2.0 ransomware (Click to\n\nenlarge)\n\n\n-----\n\nIn essence, while a ransomware infection might be able to encrypt files on a compromised\nendpoint, Falcon can prevent ransomware from tampering with shadow copies and\npotentially expedite data recovery for your organization.\n\nFigure 5. Falcon alert on detected and blocked ransomware activity for deleting VSS shadow copies (Click\n\nto enlarge)\n\nShown below is Lockbit 2.0 executing on a system without Falcon protections. Here,\nvssadmin is used to list the shadow copies. Notice the shadow copy has been deleted after\nexecution.\n\n\n-----\n\nBelow is the same Lockbit 2.0 execution, now with Falcon and VSS protection enabled. The\nshadow copy is not deleted even though the ransomware has run successfully. Please note,\nwe specifically allowed the ransomware to run during this demonstration.\n\nCrowdStrike prevents the destruction and tampering of shadow copies with volume shadow\nservice backup protection, retaining the snapshots in a recoverable state regardless of threat\nactors using traditional or new novel techniques. This allows for instant recovery of live\nsystems post-attack through direct snapshot tools or system recovery.\n\nVSS shadow copy protection is just one of the new improvements added to CrowdStrike’s\nlayered approach. We remain committed to our mission to stop breaches, and constantly\nimproving our machine learning and behavior-based detection and protection technologies\nenables the Falcon platform to identify and protect against tactics, techniques and\nprocedures associated with sophisticated adversaries and threats.\n\n## CrowdStrike’s Layered Approach Provides Best-in-Class Protection\n\nThe Falcon platform unifies intelligence, technology and expertise to successfully detect and\nprotect against ransomware. Artificial intelligence (AI)-powered machine learning and\nbehavioral IOAs, fueled by a massive data set of trillions of events per week and threat actor\nintelligence, can identify and block ransomware. Coupled with expert threat hunters that\nproactively see and stop even the stealthiest of attacks, the Falcon platform uses a layered\napproach to protect the things that matter most to your organization from ransomware and\nother threats.\n\n\n-----\n\n[CrowdStrike Falcon endpoint protection packages unify the comprehensive technologies,](https://www.crowdstrike.com/endpoint-security-products/)\nintelligence and expertise needed to successfully stop breaches. For fully managed detection\nand response (MDR), Falcon Complete™ seasoned security professionals deliver 403% ROI\nand 100% confidence.\n\n## Indicators of Compromise (IOCs)\n\n**File** **SHA256**\n\nLockBit `0545f842ca2eb77bcac0fd17d6d0a8c607d7dbc8669709f3096e5c1828e1c049`\n2.0\n\n**Additional Resources**\n\n_[Learn more about ransomware adversaries in the CrowdStrike Adversary Universe.](https://adversary.crowdstrike.com/adversary/cozy-bear/)_\n_[Download the CrowdStrike 2021 Global Threat Report for more information about](https://www.crowdstrike.com/resources/reports/global-threat-report/)_\n_adversaries tracked by CrowdStrike Intelligence in 2020._\n_[See how the powerful, cloud-native CrowdStrike Falcon® platform protects customers](https://www.crowdstrike.com/endpoint-security-products/)_\n_from the latest variants of ransomware in these blogs: DarkSide Goes Dark: How_\n_CrowdStrike Falcon Customers Were Protected and_ _Under Attack: Protecting Against_\n_Conti, DarkSide, REvil and Other Ransomware._\n_[Get a full-featured free trial of CrowdStrike Falcon Prevent™ and learn how true next-](https://go.crowdstrike.com/try-falcon-prevent.html)_\n_gen AV performs against today’s most sophisticated threats._\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-17 - Ransomware (R)evolution Plagues Organizations, But CrowdStrike Protection Never Wavers.pdf"
    ],
    "report_names": [
        "2021-11-17 - Ransomware (R)evolution Plagues Organizations, But CrowdStrike Protection Never Wavers.pdf"
    ],
    "threat_actors": [
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "46b3c0fc-fa0c-4d63-a38a-b33a524561fb",
            "created_at": "2023-01-06T13:46:38.393409Z",
            "updated_at": "2025-03-27T02:00:02.822155Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "The Dukes",
                "Minidionis",
                "Grizzly Steppe",
                "G0016",
                "Blue Kitsune",
                "BlueBravo",
                "SeaDuke",
                "Cloaked Ursa",
                "YTTRIUM",
                "ATK7",
                "Nobelium",
                "UAC-0029",
                "Group 100",
                "COZY BEAR",
                "IRON HEMLOCK",
                "TA421",
                "ITG11"
            ],
            "source_name": "MISPGALAXY:APT29",
            "tools": [
                "QUARTERRIG",
                "SNOWYAMBER",
                "HALFRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535752,
    "ts_updated_at": 1743041794,
    "ts_creation_date": 1653754448,
    "ts_modification_date": 1653754448,
    "files": {
        "pdf": "https://archive.orkl.eu/b72762ea39876ea79cfc82602718a5f5fe1d230d.pdf",
        "text": "https://archive.orkl.eu/b72762ea39876ea79cfc82602718a5f5fe1d230d.txt",
        "img": "https://archive.orkl.eu/b72762ea39876ea79cfc82602718a5f5fe1d230d.jpg"
    }
}