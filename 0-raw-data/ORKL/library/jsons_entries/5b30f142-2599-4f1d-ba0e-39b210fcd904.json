{
    "id": "5b30f142-2599-4f1d-ba0e-39b210fcd904",
    "created_at": "2022-10-25T16:48:23.661323Z",
    "updated_at": "2025-03-27T02:15:18.844668Z",
    "deleted_at": null,
    "sha1_hash": "ffa66796bd7c7f077c31285e6563ccb522b7e9b1",
    "title": "Mofang: A politically motivated information stealing adversary",
    "authors": "Fox-IT",
    "file_creation_date": "2016-05-27T11:22:58Z",
    "file_modification_date": "2016-05-27T11:23:45Z",
    "file_size": 5039105,
    "plain_text": "Lead Author: Yonathan Klijnsma\n\nCo-authors: Danny Heppener, Mitchel Sahertian,\n\nKrijn de Mik, Maarten van Dantzig,\n\nYun Zheng Hu, Lennart Haagsma,\n\nMartin van Hensbergen, Erik de Jong\n\n\n# Mofang\n\n#### A politically motivated information stealing adversary\n\n###### Version 1.0 May 17, 2016\n\n\n-----\n\n## Executive Summary\n\n###### Mofang (模仿, Mófa ̌ng, to imitate) is a threat actor that almost certainly\n\n operates out of China and is probably government-affiliated. \n\nIt is highly likely that Mofang’s targets are selected based on involvement with invest\n###### ments, or technological advances that could be perceived as a threat to the Chinese\n\nsphere of influence. This is most clearly the case in a campaign focusing on government\n###### and critical infrastructure of Myanmar that is described in this report. Chances are about even, though, that Mofang is a relevant threat actor to any organization that\n\ninvests in Myanmar or is otherwise politically involved.\n\nIn addition to the campaign in Myanmar, Mofang has been observed to attack targets\n\nacross multiple sectors (government, military, critical infrastructure and the automo\ntive and weapon industries) in multiple countries. The following countries have, in the\n\nabove named sectors, been affected, although Fox-IT suspects there to be more: India,\n\nGermany, United States, Canada, Singapore, South Korea.\n\nDespite its diverse set of targets Mofang is probably one group. This is based on the fact\n\nthat its tools (ShimRat and ShimRatReporter) are not widely used, and that campaigns\n\nare not usually observed in parallel.\n\n###### Technically, the group uses distinct tools that date back to at least February 2012: ShimRat and ShimRatReporter. The mofang group does not use exploits to infect \n\ntargets, they rely on social engineering and their attacks are carried out in three stages:\n\n1 Compromise for reconnaissance, aiming to extract key information about the target\n\ninfrastructure.\n\n2 Faux infrastructure setup, designed to avoid attracting attention.\n\n3 The main compromise, to carry out actions on the objective.\n\nThe name ShimRat is based on how its persistence is build up. It uses the so-called shims\n\nin Windows to become persistent. Shims are simply hot patching processes on the fly,\n\nto ensure backward compatibility of software on the Microsoft Windows platform.\n\n\n-----\n\nAs far as known, the Mofang group has never used exploits to infect targets, instead\n\n###### relying heavily on social engineering in order to successfully infect targets. The only\n\nexploits the group uses are privilege elevation exploits built into their own malware. The\n\nvulnerabilities that were being exploited were already known about at the time of use.\n\n###### The full report contains contextual as well as technical information about the group\n\nand its activities. These can be used, for example, for threat assessments, compromise\n\nassessments, incident response and forensics activities.\n###### Should you have any additional information or questions about this group or its \n\nactivities, please get in touch with Fox-IT through info@fox-it.com.\n\n\n-----\n\n###### Table of Contents\n\n**Executive Summary** **2**\n\n**1** **Introduction** **5**\n\n**2 \u0007Who is Mofang and who do they attack?** **6**\n\n2.1 About the Mofang group 6\n\n2.2 Mofang’s targets: a diverse set of entities 9\n\n**3** **\u0007The distinct modus operandi of Mofang** **10**\n\n3.1 Stage 1: Initial reconnoitering compromise 10\n\n3.2 Stage 2: Faux infrastructure setup 12\n\n3.3 Stage 3: The main compromise 12\n\n**4 A history of past attacks** **14**\n\n**5** **Campaigns in Myanmar** **18**\n\n5.1 Activities related to the Kyaukphyu Special Economic Zone 18\n\n5.2 Earlier campaigns in Myanmar 20\n\n**6 \u0007Other notable campaigns and attacks** **22**\n\n6.1 Attack on Indian defense expo exhibitors 22\n\n6.2 Attack on ‘seg’ 24\n\n6.3 Attack using a Citrix lure 24\n\n6.4 The global campaign 25\n\n**7** **Preferred tools** **26**\n\n7.1 ShimRat 26\n\n7.2 ShimRatReporter 33\n\n**8 Network based detection (IOCs)** **36**\n\n8.1 Snort signatures 36\n\n8.2 Domains & IP addresses 37\n\n**9 Host based detection (IOCs)** **38**\n\n9.1 yara rules 38\n\n9.2 ShimRat samples 40\n\n9.3 ShimRatReporter samples 47\n\n9.4 Antivirus hijacking components 49\n\n9.5 Observed services 50\n\n9.6 Observed shims 51\n\n\n-----\n\n## 1 Introduction\n\n\n### Imitation, in this case imitation of a target’s infrastructure, is a defining feature of  their modus operandi.\n\n\n###### This threat report gives insight into some of the information that Fox-IT has about a\n\nthreat actor that it follows, called Mofang. The name Mofang is based on the Mandarin\n\nverb 模仿 (Mófa ̌ng), which means to imitate. Imitation, in this case imitation of a target’s\n\ninfrastructure, is a defining feature of their modus operandi.\n\n###### It is highly likely that the Mofang group is a group that operates out of China and  is probably government-affiliated. Among others, one of their focus areas is the  government and critical infrastructure sector of Myanmar. Additional information \n\nwas used to contextualize and explain the observed attacks and campaigns, since there\n\nis obviously no easy insight in their actual agenda and goals. The additional research\n\ninto geopolitical and economic factors resulted in the hypotheses about the ‘why’ of\n\nthese campaigns. The full picture, however, will probably remain unknown.\n\n###### Fox-IT has chosen to release this report now, for additional context to the changing political landscape in Myanmar. This report contains contextual as well as technical information about the group and its activities. These can be used, for example,  for threat assessments, compromise assessments, incident response and forensics\n\nactivities. Should you have any additional information or questions about this group\n\nor its activities, please get in touch with Fox-IT through info@fox-it.com.\n\n###### Chapter 2 through 6 deals with Mofang, the group, its targets and some of their most notable campaigns and attacks. These chapters also contain geopolitical and\n\neconomic context. Chapter 7 explains the working of Mofang’s preferred tools: ShimRat\n###### and SimRatReporter. The final two chapters of this report, chapter 8 and 9, provide technical Indicators of Compromise for use in detecting and hunting, both at a host\n\nand at a network level.\n\n\n-----\n\n## 2 \u0007Who is Mofang and who do they attack?\n\n2.1 **About the Mofang group**\n\nDespite its diverse set of targets (described in paragraph 2.2), Mofang is probably one\n\ngroup. This is based on the fact that its tools (ShimRat and ShimRatReporter) are not\n\nwidely used, and that campaigns are not usually observed in parallel.\n\n###### Based on a numbers of factors that will be explained in more detail in this Chapter, it is highly likely that the Mofang group is a group that operates out of China and is\n\nprobably government-affiliated.\n\nThe most compelling evidence that supports this hypothesis is the fact that the targets\n\nand campaigns known so far can be persuasively correlated to important geopolitical\n\nevents and investment opportunities that align with Chinese interests. The most notable\n\n###### of these will be described in chapter 5, which describes systematic espionage in the\n\ngovernment and critical infrastructure sector of Myanmar. It describes:\n\n**•** Companies that are involved with investment possibilities that also involve\n\nChinese state owned organizations, become targets;\n\n**•** Government agencies or companies that play a role in deciding about Chinese\n\ninvestments, become targets;\n\nIn addition to the above, there are four notable technical facts. Details such as these\n\ncan, of course, be changed and manipulated without material impact to attacks, which\n\nmakes them weaker indicators of attribution than contextual evidence derived from likely\n\ncampaign goals. In this case, the technical facts support the hypothesis for attribution.\n\n\n### Based on a numbers of factors  that will be explained in more detail in this Chapter, it is highly likely  that the Mofang group is a group that operates out of China and is probably government-affiliated.\n\n\n-----\n\n1 There are many similarities at the code level between the stager used by Mofang\n###### and others stagers attributed to Chinese groups. Also striking is the method of hijacking Antivirus Products to run the malware, which Fox-IT calls ShimRat, as described in chapter chapter 7.1. This has been seen in multiple espionage cam\npaigns attributed to Chinese groups. In fact the similarities are so strong that some\n\ninvestigators have mistaken ShimRat to be another widely known piece of malware:\n\nPlugX. Based on in-depth investigation of both, Fox-IT has come to the conclusion\n###### that they are not the same. ShimRat is probably t is used by a separate group.\n\n 2 All the documents that were used for the initial attacks contain meta- data that suggests they were created with WPS Office. This product, also known as Kingsoft Office, is a Chinese product comparable to Microsoft Office. Artifacts can be seen in document metadata as shown in Figure 1.\n\n3 Simplified Chinese is set as the character set in many of the resources inside various\n\nmalware samples, as shown in Figure 2.\n\n_Figure 1 detail of decoy document metadata_\n\n_Figure 2 Resource information inside a malware sample_\n\n\n-----\n\n_Figure 3 郁, 郁! used in the 1991 Hong Kong comedy Tricky Brains_\n\n4 An earlier version of ShimRat’s C2 communication protocol used two very specific\n\nwords as keywords for requests and responses: Yuok and Yerr. Although the meaning\n\n###### is not directly obvious, it may be an approximate phonetic representation of the\n\nCantonese 郁 **佢, beat him or kill him. If this is true, it would suggest at least passive**\n\nknowledge of Cantonese on the part of the malware author. The use of Yuok and\n\n_Yerr was discontinued and replaced by ataD or Data in 2013, as shown in the side by_\n\nside comparison in Figure 4. The current communication protocol is documented\n\nin paragraph 7.1.6.\n\n_Figure 4 Side by side comparison of previous and current C2 communication_\n\n\n-----\n\n###### Canada Germany\n\n United States South Korea\n\n India Myanmar\n\n Singapore\n\nGovernment\nMilitary\nCritical Infrastructure\nAutomotive Industry*\nWeapon Industry*\n\n*R&D departments specifically\n\n\n_Figure 5 Countries and sectors targeted by Mofang_\n\n2.2 Mofang’s targets: a diverse set of entities\n###### On analysis of the organizations that were attacked by Mofang in the past, at first\n\nglance it appears that there is no particular sector or country that it targets. Figure 5\n\nshows aggregate information about known attacks from the past four years.\n\nLooking at the attacks, it is highly likely that targets are selected based on involvement\n\nwith investments, or technological advances that could be perceived as a threat to the\n###### Chinese sphere of influence. This is most clearly the case in the campaign focusing on Myanmar. In it, a company was attacked that was involved in a special economic\n\nzone[1 ]in Myanmar, which would be of specific interest to China’s National Petroleum\n\nCorporation’s investments. It is highly likely that they were targeted because of this,\n###### as new waves of attacks can be correlated with events surrounding the investments\n\nin that area.\n\n\n_1_ _\u0007Special economic zones, of_\n\n_which Myanmar currently_\n\n_has three, are specific areas_\n\n_within a country where_\n\n_certain laws and regulations_\n\n_are different from the rest of_\n\n_the country, usually with the_\n\n_aim of furthering the ‘host’_\n\n_country’s economy._\n\n\n-----\n\n## 3 \u0007The distinct modus operandi of Mofang\n\n###### The Mofang group uses distinct malware that dates back to at least February 2012.\n\nThe two tools used in their campaigns are:\n\n1 **ShimRat**\n\n2 **ShimRatReporter**\n\nAs far as known, the Mofang group has never used exploits to infect targets, instead\n\n###### relying heavily on social engineering in order to successfully infect targets. The only\n\nexploits the group uses are privilege elevation exploits built into their own malware.\n\nThe vulnerabilities that were being exploited were already known about at the time of\n\nuse. A more detailed description of the malware can be found in paragraph 7.1 and 7.2.\n\nThe Mofang group has a distinct method of carrying out attacks using these two tools,\n\nwith the goal of stealing information. In short, their method, which is described below,\n\ncan be summarized as follows:\n\n1 Initial reconnoitering compromise: an initial compromise is performed on specific\n\nemployees of a targeted organization with the aim of extracting key information\n\nabout the target infrastructure to be used in stage 2;\n\n2 Faux infrastructure setup: the group sets up (external) infrastructure designed to\n\navoid attracting attention;\n\n3 The main compromise.\n\n3.1 **Stage 1: Initial reconnoitering compromise**\n\nFor the initial compromise, an ‘environment mapping tool’ known as ShimRatReporter,\n\nis delivered to suitable targets. ShimRatReporter can extract a wealth of information\n###### about an infrastructure, but the most pertinent data needed for the next stage in\n\ntheir attack are:\n\n**•** Local privileges for the infected user;\n\n**•** Local domain;\n\n**•** Local proxy setup;\n\n**•** Installed software.\n\nShimRatReporter is fully explained in chapter 7.2.\n\nThe delivery method of ShimRatReporter is most likely through emails pointing to an\n\nexecutable placed on a compromised (and trusted) website.\n\nFox-IT has observed targeted and untargeted variations of the initial stage of the attack:\n\n1 Untargeted: the ShimRatReporter sends out the report with the information and\n###### immediately downloads the ShimRat malware from a hardcoded location. This\n variation is probably less targeted, with victims added to the global campaign C2 for check-in and control. For more information about the global campaign, see\n\nparagraph 6.4.\n###### 2 Targeted: the ShimRatReporter sends out the report and exits afterwards. The\n\nShimRatReporter tool was only used to map out the victim but in no way to auto\nmate further infection (yet).\n\n\n-----\n\n###### Modus operandi of the Mofang group\n\n Targeted campaign Global campaign\n\n\nin\n\n\nin\n\n\nSpear phishing attack\nwith ShimRatReporter\n\n###### Target organization Target\n\n1\n\n2 2\n\n###### Operators\n\nSetting up the customized Setting up the\ninfrastructure 3 infrastructure\n\n\ncontrol\n\n\ninformation\n\n\nThe main attack with\na customized ShimRat version\n\n\nThe main attack\nwith ShimRat\n\n\nVictim’s PCs and servers\nwith classified information\n\n\n-----\n\n3.2 Stage 2: Faux infrastructure setup\n\nThe second stage of an attack is setting up a faux infrastructure, specifically to mimic\n###### the anti-virus products used by the target or the target itself. The ShimRat malware then communicates over HTTP with preconfigured command and control servers. \n\nA combination of typo-squatting and closely related names are used to register domains\n\nunder the same or different tlds.\n\nThis method of setting up command and control infrastructure is customized for each\n###### target and campaign. Anything outside of campaigns targeting specific companies is added to the ‘global campaign’ which is described in paragraph 6.4. The global\n\ncampaign infrastructure mimics the Microsoft Windows or Microsoft Office software.\n\n3.3 **Stage 3: The main compromise**\n\nAfter having gathered all necessary information about the locally configured proxies\n###### and having set up a faux infrastructure, a custom built version of the ShimRat mal\nware will be deployed to infect users with preconfigured local proxies, C2 servers and\n\npersistence information.\n\nAs mentioned before, delivery of ShimRat relies heavily on social engineering, through\n\nthe use of emails enticing targets to open an attached (decoy) document. These doc\numents contain actual text to make the target think it was indeed a legitimate Word\n###### document, pdf file or Excel sheet. When the document is opened, an executable is\n\ndropped which decompresses the final payload and places it on disk.\n\nThe final payload consists of ShimRat bundled with extra files: legitimate application\n\nfiles which suffer from dll hijacking vulnerabilities. These vulnerabilities are used to\n\nlaunch the actual malware. The legitimate application is started which in turn runs the\n\nactual malware. A benefit of this method is that the malware runs under the process of\n\na legitimate application. When it requests higher privileges via uac, the uac warning\n\nscreen will show this legitimate application. Also, anyone inspecting running applica\ntions, would see legitimate software running.\n\n###### It is worthy to note that the Mofang group commonly exploits dll hijacking vulner\nabilities in anti-virus products for persistence purposes, presumably in order to look\n###### as harmless as possible. Over the years they’ve used application components from\n\nNorman, McAfee and Norton. A complete list of the used applications can be found in\n\nparagraph 9.4. The methods of persistence (described in paragraph 7.1.1) are sometimes\n###### adapted depending on the target. Rather than using generic texts in the persistent\n\nservices, customized names and descriptions are used, based on the installed software\n\ninformation that was extracted with the ShimRatReporter tool previously.\n\n###### Follow up actions in the attacks, such as stealing information or lateral movement through the network, are possible with the capabilities of the ShimRat malware as\n\ndescribed in paragraph 7.1.5.\n\n\n-----\n\n### As far as known, the Mofang group has never used exploits to infect targets, instead relying heavily on social engineering in order to successfully infect targets.\n\n\n-----\n\n## 4 A history of past attacks\n\n###### The first activity of the Mofang group was seen in February 2012, when\n\n the first version(s) of their malware, ShimRat, was seen in attacks.\n\n Based on compile time artifacts in the first versions of the malware, it is likely that\n\nthe project had started 2012. A program database path, a file present on the authors’\n###### machine used to aid in debugging the malware, present in early samples gives more\n\nindication that the project started in 2012:\n```\n      z:\\project2012\\remotecontrol\\winhttpnet\\amcy\\app\\win7\\installscript\\objfre_wxp_x86\\i386\\InstallScript.pdb\n      z:\\project2012\\remotecontrol\\winhttpnet\\amcy\\app\\win7\\serviceapp\\objfre_wxp_x86\\i386\\ServiceApp.pdb\n      z:\\project2012\\remotecontrol\\winhttpnet\\cqgaen\\app\\installscript\\objfre_wxp_x86\\i386\\InstallScript.pdb\n      z:\\project2012\\remotecontrol\\winhttpnet\\cqgaen\\app\\serviceapp\\objfre_wxp_x86\\i386\\ServiceApp.pdb\n\n###### The following is a timeline from early 2012 through to 2016. This timeline contains\n\n```\ndevelopment information and a small subsection of the incidents that Fox-IT is aware\n\nof related to this group. The Mofang group is currently still active.\n\n|Col1|Col2|z:\\ z:\\ z:\\ z:\\|p p p pr|ro ro ro o|je je je je|ct ct ct ct|20 20 20 20|12 12 12 12|\\r \\r \\r \\r|em em em em|o o o ot|te te te ec|co co co o|nt nt nt nt|ro ro ro ro|l\\ l\\ l\\ l\\|w w w wi|in in in nh|ht ht ht tt|tp tp tp pn|ne ne ne e|t\\ t\\ t\\ t\\c|a a cq q|mc mc g ga|y\\ y\\ ae en|ap ap n\\ \\a|p\\ p\\ ap pp|wi wi p\\ \\s|n7 n7 in er|\\installscript\\objfre_wxp_x86\\i386\\InstallScript.pdb \\serviceapp\\objfre_wxp_x86\\i386\\ServiceApp.pdb stallscript\\objfre_wxp_x86\\i386\\InstallScript.pdb viceapp\\objfre_wxp_x86\\i386\\ServiceApp.pdb|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n-----\n\n|Col1|Col2|Col3|Col4|Col5|Sh|im|Ra|t|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|S|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||An un zat ho Sh|at kn io ste im|ta ow n. d R|ck n Th on at|w So e a Re|as ut C2 co po|st h in m rt|art Ko fra pr er|ed re st om|a an ru is|ga or ct ed|in ga ur se|st ni e w rv|an - as er|.|||\n||||||Fir sa Sh|st mp im|ev le Ra|er ob t|Sh se|im rv|R ed|ep in|or a|te n a|r m tt|al ac|wa k.|re||||\n|||||f|An an C2 co ak Sh|at un in mp ed im|ta kn fr ro p Ra|ck o ast m ay t|w wn ru ise m|as U ct d en|la S ur se t d|un or e w rv oc|ch ga as er. u|ed niz h Th me|a at os e nt|gai io te lur s.|ns n. d o e|t Th n wa|e a s|||\n\n\n-----\n\n|Col1|Col2|Col3|Col4|Col5|S|hi|mR|at|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|ad po|w rt|as|||||||||||||||||||\n\n\n-----\n\n## 5 Campaigns in Myanmar\n\n5.1 **Activities related to the Kyaukphyu Special Economic Zone**\n###### Since 2009, foreign investment in Myanmar has increased substantially. While it\n\namounted to around usd 300 million in 2009–2010, it grew to usd 20 billion in the period\n\n###### of 2010–2011. To further increase and facilitate foreign investment, the government\n\nof Myanmar established special economic zones (sezs). These zones are supposed to\n###### encourage economic growth and foreign investments even more. These sezs would\n\ngive investors a variation of tax reliefs, 5 year tax holidays as well as longer land leases.\n\nIn 2011 Myanmar established the Central Body for the Myanmar Special Economic Zones,\n\na regulatory body which would oversee foreign investments in the sezs. In the same\n###### year the sez law and Dawei law were also passed, establishing a set of three sezs in\n\nMyanmar. The current sezs under development in Myanmar are the Dawei sez, Thilawa\n\nsez and the Kyaukphyu sez[2].\n\nThe Mofang group has been active in relation to the Kyaukphyu sez. The state owned\n###### China National Petroleum Corporation (cnpc) has been investing in this sez since\n\nearly 2009 after signing a memorandum of understanding (MoU) with the Myanmar\n\ngovernment. This MoU, not legally binding, established the development, operation\n\nand management of an oil and gas pipeline by the cnpc. This investment by the cnpc\n###### ensured their position to get these pipelines running from the Kyaukphyu sez to mainland China. This pipeline would be completed in combination with a seaport to be built in the sez as well. This port, and pipeline, would save the cnpc about 5,000\n\nkilometers of sailing and eliminate the need to go through the Strait of Malacca. While\n\n###### an agreement was signed, an MoU is not legally binding in any way and either party\n\ncan always step out.\n\nThis was perhaps a fear on the Chinese part when the government of Myanmar started\n###### a consulting tender for the Kyaukphyu sez in 2013. The idea behind this tender was\n\n\nDawei SEZ\n\n\n_2_ _\u0007http://www.aseanbriefing._\n\n_com/news/2013/06/28/spe-_\n\n_cial-economic-zones-in-myan-_\n\n_mar.html_\n\n_3_ _\u0007http://consult-myanmar._\n\n_com/2013/10/21/kyauk-_\n\n_pyu-special-economic-zone/_\n\n_4_ _\u0007 http://www.irrawaddy.com/_\n\n_business/singapore-led-con-_\n\n_sortium-wins-kyauk-_\n\n_phyu-sez-consulting-tender._\n\n_html_\n\n_5_ _\u0007http://consult-myanmar._\n\n_com/2015/06/19/lawmakers-_\n\n_to-seek-answers-on-stalled-_\n\n_kyaukphyu-sez/_\n\n\nto pick a consortium that would become the advisor for the Kyaukphyu sez, meaning\n###### they would oversee operations and make decisions on certain investments. In late September 2013 this tender closed[3] and in early March the results were presented[4].  A consortium led by the cpg Corporation, a company originating from Singapore, \n\nwas the winner and would become the sez consultant.\n\nIn 2014 the Myanmar government with the help of cpg Corporation initiated another\n\ntender, this time to set up infrastructure in the sez. This tender closed in November and\n\nresults would be put out early 2015. The date of the publication of the tender outcome\n\npassed but no information was published. In late June the Myanmar government still\n\nhad not put out any word who would win infrastructure investments for the sez[5]. One\n\nof the contenders for this tender was China’s citic group.\n\nAt the end of June 2015 Mofang started its campaign to gather information of a specific\n\ntarget in relation to the sezs: the cpg Corporation. The first attack started in early July\n\nwith a ShimRatReporter payload.\n\n\n-----\n\n###### The lure used in this attack is interesting and specific to this attack and location.\n\nBurmese characters are not representable in the current Unicode character sets. The\n\nZawgyi font[6] was created to accommodate for this. One can download special appli\ncations to support this font. This is usually required when submitting information on\n\nwebsites using the Burmese character set. The locations where these applications are\n\ndownloaded from are public blogs and other public download locations.\n\n###### This need to install the Zawgyi fonts by cpg employees is what Mofang used to infect initial cpg targets: the ShimRatReporter was presented as AlphaZawgyl_ font.exe. The reporter would call back to a domain set-up to mimic the official cpg  domain cpgcorp.com.sg. The C2 server for the initial ShimRatReporter payload was\n\n_cpgcorp.org with the reporting gate being located at library.cpgcorp.org/links/images/_\n\nfile/blanks.php.\n\nThere were a few attacks with ShimRatReporter using the above mentioned C2 domain.\n\nHowever, a later sample showed how the Mofang group used the information gathered\n\nby the reporter for follow up attacks. Another C2 domain, secure2.sophosrv.com, was set\n\nup, which mimicked the official secure2.sophos.com domain. This is presumably based\n\non information from the reports that the cpg Corporation internally used the Sophos\n\nAntivirus products. This ShimRatReporter sample was preconfigured to download the\n\n2[nd] stage payload, ShimRat, from the following two locations:\n```\n  library.cpgcorp.org/links/images/blanks.jpg\n  secure2.sophosrv.com/en-us/support/blanks.jpg\n\n```\nThe downloaded ShimRat payload contacted its C2 server gate at secure2.sophosrv.\n###### com/en-us/support/ms-cache_check.php. One thing to note is that while all of the\n\ncommunications by ShimRat to its C2 server used HTTPS, ShimRatReporter operates\n\nunder plain HTTP.\n\nThe actual publication of the outcome of the infrastructure tender was postponed until\n\nthe start of 2016. Early 2016 the results came in and China’s citic group had won the\n\ntender[7]. This allowed China to continue building upon their gas and oil infrastructure\n\nas well as the seaport.\n\n|library.cpgcorp.org/links/images/blanks.jpg secure2.sophosrv.com/en-us/support/blanks.jpg|Col2|Col3|Col4|Col5|\n|---|---|---|---|---|\n\n\n_Figure 6 Satellite images showing_\n\n_Kyaukphyu SEZ developments._\n\n_Image © 2016 Google Earth._\n\n\n_6_ _\u0007https://my.wikipedia.org/_\n\n_wiki/Wikipedia:Font#Why__\n\n_not_Zawgyi.3F_\n\n_7_ _\u0007http://thediplomat._\n\n_com/2016/01/chinese-com-_\n\n_pany-wins-contract-for-deep-_\n\n_sea-port-in-myanmar/_\n\n\n-----\n\n5.2 Earlier campaigns in Myanmar\n\nMyanmar has been the target of Mofang’s attacks for years before the campaign related\n\nto the sez. Throughout the years, the Mofang group has compromised countless servers\n\n###### belonging to government or other Myanmar related organizations, in order to stage\n\nattacks. A few notable ones are described below.\n\n###### The earliest activity from Mofang in Myanmar dates back to around May 2012 when\n\nthey attacked a government entity. Interestingly they abused a Myanmar government\n\nserver they had compromised earlier, to function as the C2 server. It was the website\n\nof the Ministry of Commerce located at commerce.gov.mm. The C2 gate was located\n\nat /templates/css1/logon.php.\n\nAnother compromised server from the Myanmar government used to stage a ShimRat\n\npayload that was seen around early June 2015. The payload for this campaign was located\n\n###### at 203.81.162.178/text.txt. The ip address noted here hosted the official government\n\nwebsite of the Myanmar port authorities at the time. The C2 server for this campaign\n\nwas dns.undpus.com.\n\n_Figure 7 The Myanma Port Authority website was used to stage at attack in June 2015_\n\nIn late September 2015 Mofang used the website of Myanmar’s national airline hosted\n\nat www.flymna.com for an attack against an organization in Myanmar. The payload was\n###### located at www.flymna.com/sites/photo.tar and contained ShimRatReporter. After\n\nexecuting it would send its report to a C2 server at dns.undpus.com but also download\n\na payload from a preconfigured location. This location was: dns.undpus.com/myanmar.jpg.\n\n\n-----\n\n_Figure 8 The website of Myanmar’s national airline was used to stage an attack in September 2015_\n\n\n-----\n\n## 6 \u0007Other notable campaigns and attacks\n\n###### This chapter highlights a few campaigns and attacks that provide \n\n further illustration to Mofang’s motives and attack method.\n\n6.1 **Attack on Indian defense expo exhibitors**\n\nThe ‘International MSME Sub-Contracting & Supply exhibition for Defence – Aerospace\n###### – Homeland Security’ (MSME DEFEXPO) is an annual Indian exhibition and confer\nence. It allows MSMEs[8] to show their current and new capabilities in the defense and\n\naerospace technology to various government agencies. Over the years, its exhibitors\n\nhave been a continuing target for the Mofang Group.\n\n###### In 1991 India initiated its Look East policy[9] aiming to strengthen their relations with\n\nSoutheast Asian countries, and to become a counterweight against the influences of\n###### China in the region. In addition, India, just like China, has a strategic interest in and\n\nstrong relations with Myanmar. For example, the countries hold joint military exercises.\n\nAdditional insight into the activities and capabilities of the MSMEs at the expo would\n\n\n_Figure 9 Exhibitors at the Indian MSME_\n\n_DEFEXPO are routinely attacked_\n\n\n_8_ _\u0007Micro, Small and Medium_\n\n_sized Enterprises_\n\n_9_ _\u0007https://en.wikipedia.org/wiki/_\n\n_Look_East_policy_\n\n\nbe strategically advantageous for China. Please note that there might be other reasons,\n\nwhy the Mofang Group was interested in this expo.\n\nThe changes are about even that the targets for the MSME DEFEXPO campaign were a\n\nselected group of exhibitors. They were targeted with spear phishing emails containing\n###### Word documents or Excel sheets enticing them to install the ShimRat malware. An\n\nexample of the 2013 lure is shown in Figure 10.\n\n###### In 1991 India initiated its Look East policy[9] aiming to strengthen their relations with\n\nSoutheast Asian countries, and to become a counterweight against the influences of\n###### China in the region. In addition, India, just like China, has a strategic interest in and\n\nstrong relations with Myanmar. For example, the countries hold joint military exercises.\n\nAdditional insight into the activities and capabilities of the MSMEs at the expo would\n\nbe strategically advantageous for China. Please note that there might be other reasons,\n\nwhy the Mofang Group was interested in this expo.\n\n_Figure 10 Excel document used to infect Defexpo 2013 exhibitors_\n\n\n-----\n\n###### The Excel sheet in the 2013 campaign contained an embedded ShimRat sample bea- coning out to a C2 server hosted at store.outlook-microsoft.net with the panel gate\n\nbeing located at /en-us/c/index.php. The 2013 campaign didn’t feature a target specific\n\nC2 infrastructure, but actually used infrastructure from the global campaign written\n\nabout in paragraph 6.4. The probable reason for this becomes clear when looking at a\n\ncampaign that was running at the same time as the MSME DEFEXPO 2013.\n\nThe attendees of the ESSENTIALS OF 21[st] CENTURY ELECTRONIC WARFARE COURSE,\n###### a training course for government employees in the US, held in Alexandria, Virginia\n\nwere also targeted. The lure in this case was the official registration form send out to\n\nattendees as shown in Figure 11. The infrastructure was set up to aid in two campaigns\n\ntaking place at the same time.\n\n_Figure 11 Document used to infect attendees of the Essentials of 21st Century Electronic Warfare_\n\n_Course held in Virginia, US_\n\nA year later, the MSME DEFEXPO 2014 was scheduled and again exhibitors were being\n###### targeted. This time the campaign and infrastructure was setup specifically for this\n\nattack. Lures were send out via mail once again, similar to the 2013 campaign. This time\n\nthe C2 domain followed their general methods as described in chapter 3: it mimicked\n###### the MSME DEFEXPO website. They used images.defexpoindia14.com for their C2\n\ncommunication and the panel gate was hosted on /se/index.php.\n\n\n-----\n\n6.2 Attack on ‘seg’\n\nIn December 2012 Mofang started a campaign against a new target, called ‘seg’ for the\n\npurpose of this report. The victim was compromised with at least ShimRatReporter as the\n\n2[nd] stage ShimRat payload was preconfigured with the local proxy of this organization.\n\nThe configuration for this build was interesting and reflects the method as described\n\nin chapter 3. Table 1 contains a subsection of the configuration for this build.\n\n**Configuration items** **Configuration values**\n\nCampaign ID `SCH`\n\nC2 Password `SCH2233`\n\nC2 Domain `support.f--secure.com`\n\nC2 Gate location `/cache/cache.php`\n\nProxy type `HTTP`\n\nProxy `proxy.seg.local:8080`\n\nService name `mshelpsrvs`\n\nService title `Windows Help Services`\n\nService description `Enables Help and Support Center to run`\n```\n            on this computer. If this service is\n            stopped, Help and Support Center will \n            be unavailable.\n\n```\n_Table 1 A subsection of the configuration build for the ‘seg’ attack_\n\nFrom the configuration it can be determined that the company was running F-Secure\n\nAntivirus and Mofang registered the domain to not appear suspicious. The preconfig\nured proxy and the C2 domain shows the targeted nature of this campaign. The fake\n###### F-Secure domain was in control of Mofang until March 2014, when they transferred\n\nthe domain to a domain broker. F-Secure’s brand monitoring picked up on the domain\n\nand bought it from this domain broker after it became available.\n\n6.3 Attack using a Citrix lure\n###### In September 2015 Mofang launched another attack. As per their usual modus \n\noperandi, this attack relied on social engineering to infected targets. For this campaign\n\nthe Mofang group used a domain that used to belong to a company called Citrix. The\n\nwebsite citrixmeeting.com was under control of Citrix until they let it expire on April 3rd,\n\n2015. The website used to hold information about the conferencing products from Citrix.\n\nAlmost 4 months after the domain expired, on July the 27[th], the Mofang group regis\ntered the domain and set it up for their newest campaign. A new version of ShimRat\n\nwas built on the 7[th] of September, uploaded to the server and only days later used in a\n\nnew campaign. The payload was hosted at http://www.citrixmeeting.com/download/\n\nlivechat.exe and contained a newly packaged ShimRat sample and a new dll hijacked\n\nprogram. They upgraded their dll hijacking program away from Norman and McAfee,\n###### which may be because they realized that a component of Norton Security (version\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|C2|D|om|ain||||||||\n|C2|G|ate|lo|ca|tio|n|||||\n|Pr|oxy|ty|pe||||||||\n|Pr|oxy||||||||||\n|Se|rvi|ce|na|me|||||||\n|Se|rvi|ce|titl|e|||||||\n|Se|rvi|ce|de|scr|ipt|io|n||||\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|\n|---|---|---|---|---|---|---|---|---|\n|s|u|pp|or|t.|f-|-s|e|cu|\n|/|ca|c|he|/c|ac|he|.p|h|\n|H|T|TP|||||||\n|p|r|ox|y.|se|g.|lo|c|al|\n|m|s|he|lp|sr|v|s|||\n|W|i|nd|ow|s|H|el|p|Se|\n|E o s b|n n t e|ab t op u|le hi pe na|s s d, va|He co H il|lp m e a|pu lp bl|an te a e.|\n\n\n-----\n\n22.2.0.31 specifically) was vulnerable to dll hijacking of the ‘msvcr110.dll’ dll which is\n\npart of the C++ runtime provided by Microsoft.\n\n###### The ShimRat sample contacted a C2 server located at api.officeonlinetool.com, the\n\npanel gate was hosted on /index.php.\n\n6.4 The global campaign\n###### While the Mofang group has specific targets and runs campaigns focused on them,\n\nthey also run something that Fox-IT calls the global campaign. This global campaign is a\n\nset of servers functioning as infrastructure with domains impersonating Microsoft and\n\nGoogle services to which a wide variety of victims is connected. The global campaign\n###### was observed before the ShimRatReporter tool and this makes sense given that the reporter is used to gather specific information about target infrastructures. Prior to\n\nits availability, the group could only use more generic C2 domains.\n\nWhile many attacks can be traced back to the exact targets because Mofang emulates\n###### a target’s environment, the exact victims of the global campaign are much more\n\ndifficult to identify. It appears Mofang uses the more generic service domains to play\n###### it safe. The global campaigns also share a lot of infrastructure across the different\n\ndomains. Looking at the C2 domains in Table 2 that Fox-IT has classified as the global\n###### campaign, it becomes clear that the domains of Microsoft and Google services are\n\nused for imitation purposes:\n\n\n**Typosquad Google domains** **Typosquad Microsoft domains**\n\n```\naccount.google.com.gmgoogle.com ie.update-windows-microsoft.com\nmail.upgoogle.com support.outlook-microsoft.com\n                   help.outlook-microsoft.com\n                   oem.outlook-microsoft.com\n                   windws-microsoft.com\n                   store.outlook-microsoft.com\n\n```\n|ft|.c|om|\n|---|---|---|\n|o|m||\n|om|||\n||||\n|.c|om||\n\n\n_Table 2 Global campaign C2 domains_\n\n\n-----\n\n## 7 Preferred tools\n\n7.1 **ShimRat**\n###### ShimRat is a custom developed piece of malware known as a ‘RAT’, Remote\n\nAdministration Tool. It has among others standard capabilities for filesystem interaction.\n\nThe malware was originally built in 2012 and its features were expanded over the years.\n\n###### The artifacts left in the first samples, are a good indicator that the project has been\n\nstarted in 2012. Multiple PDB paths were seen in the early versions of ShimRat. These\n\nPDB paths are not visible in the latest versions of ShimRat, due to how the samples are\n\nprepared. The PDB paths are either stripped or filled with different paths.\n\n```\nz:\\project2012\\remotecontrol\\winhttpnet\\amcy\\app\\win7\\installscript\\objfre_wxp_x86\\i386\\InstallScript.pdb\nz:\\project2012\\remotecontrol\\winhttpnet\\amcy\\app\\win7\\serviceapp\\objfre_wxp_x86\\i386\\ServiceApp.pdb\nz:\\project2012\\remotecontrol\\winhttpnet\\cqgaen\\app\\installscript\\objfre_wxp_x86\\i386\\InstallScript.pdb\nz:\\project2012\\remotecontrol\\winhttpnet\\cqgaen\\app\\serviceapp\\objfre_wxp_x86\\i386\\ServiceApp.pdb\n\n```\n\n_10_ _\u0007http://blog.cobaltstrike._\n\n_com/2014/03/20/user-ac-_\n\n_count-control-what-penetra-_\n\n_tion-testers-should-know/_\n\n_11_ _\u0007http://www.labofapenetra-_\n\n_tiontester.com/2015/09/_\n\n_bypassing-uac-with-power-_\n\n_shell.html_\n\n\nThe terms InstallScript and ServiceApp in the PDB paths are the two parts that malware\n###### consists of. InstallScript is the first stage of ShimRat which takes care of persistence,\n\nwhile ServiceApp is the second stage of the malware which performs C2 communication\n\nand exposes the infected machine to the operator.\n\nOver the years the developers of ShimRat have extended the malware with additional\n\nfunctionality, such as:\n\n**•** Persistence: originally ShimRat only supported registry startup keys and service\n\ncreation in order to become persistent. Additionally, the authors developed the\n\ncapability of installing a shim database for persistence in 2015.\n\n**•** Privilege elevation: a method to bypass Windows UAC to gain higher privileges\n\nwas implemented. The technique relied on the Migwiz Windows component.\n\nMigwiz is an application used in Windows which automatically runs in high\n\nintegrity mode[10]. The hijacked DLL will also run in this mode allowing a UAC\n\nbypass, one of many methods that exists[11]. This method was not developed\n\nby the ShimRat authors, but was public and the changes are even they simply\n\ncopied it into their malware.\n\nOne interesting technique they’ve been using is dll hijacking of antivirus components.\n###### ShimRat samples delivered from around end 2013/start 2014 on, abused legitimate\n antivirus applications to hijack. The reason for this is to hide itself even more. When  a user would check the running process list, a legitimate Antivirus process would  appear to be running. The exact list of applications is available in paragraph 9.4. \n\nThe Mofang group has a preference for Antivirus products only. Fox-IT has not observed\n\nany other vulnerable application except for antivirus products being used.\n\n\n-----\n\nMofang packages the anti-virus components with 2 files in order to run ShimRat. One\n\nis the dll to hijack. The second file is a compressed ShimRat core dll with shellcode\n\nin a .dat file. When the antivirus component is started the dll is loaded which in turn\n###### maps the .dat file in memory. The shellcode subsequently decompresses the core of\n\nShimRat which comes in the form of a dll and executes it. Usually the .dat file has the\n\nsame name as the dll file.\n\n_Figure 12 Shimrat and anti-virus components_\n\nThe way samples arrive at targets is usually in a packed form containing a lure document.\n###### The initial payload a target receives, will extract a lure document, present the user\n\nwith this, but also extracts and runs a 2[nd] stage loader which will drop ShimRat on the\n\ntarget system. This 2[nd] stage loader in the current version of ShimRat and contains the\n\nantivirus component and as well as the two auxiliary files containing the ShimRat core.\n\n7.1.1 Installation & Persistence\n\nOne of the first things ShimRat does while active is making sure it becomes persistent\n\non the system. Before actually activating any methods of persistence it will try to elevate\n\nprivileges if needed it is not running with administrative privileges.\n\n###### ShimRat elevates its privileges by performing a dll hijacking attack on vulnerable Windows components. Specifically, it abuses the migwiz.exe program by hijacking cryptbase.dll. ShimRat will try to gain higher privileges, but will continue to execute\n\nwhether the elevation was successful or not. This elevation would make sure no uac\n###### popups would be shown to the victim. Would the user get uac popups they would\n\nappear to be coming from the antivirus product ShimRat hijacked, as mentioned before.\n\nShimRat has three methods of becoming persistent on a system:\n\n1 Installing a registry startup key\n\n2 Installing a service\n\n3 Install a shim\n\n\n-----\n\n###### Internally ShimRat uses an installation configuration which is set by the builder. \n\nThe persistence configuration structure looks as follows (see Table 3):\n\n**Configuration items**\n\n|Col1|Col2|H|KC|U\\|So|f|tw|ar|e\\|m|ic|ro|so|f|t\\|wi|nd|o|ws|\\C|ur|rentVersion\\Run|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n_12_ _\u0007https://msdn.microsoft._\n\n_com/en-us/library/_\n\n_windows/desktop/_\n\n_ms685141(v=vs.85).aspx_\n\n_13_ _\u0007https://technet.microsoft._\n\n_com/en-us/en-en/library/_\n\n_dd837644%28v=ws.10%29._\n\n_aspx_\n\n\nService name\n\nService description\n\nService title\n\nInstallation folder\n\nInstallation filename\n\nInjection target process\n\n_Table 3: Persistence configuration structure._\n\nThe installation mode in the configuration structure, is a switch to decide which per\nsistence method to use. If the switch is set to 1 it will become persistent by installing a\n\nservice. If it is set to 2 it will install a shim to become persistent. As a fall back method,\n\nif either installing a service or installing a shim would fail, it will use a registry startup\n\nkey for persistence.\n\n7.1.2 Persistence through a registry startup key\n###### As explained, when persistence through a service or shim fails, ShimRat falls back to a registry based startup-key. It takes the installation filename variable from the\n\nconfiguration and uses this as the key name. The file path is based on the installation\n\nfile path variable in the configuration.\n\nThe key is registered under:\n```\n  HKCU\\Software\\microsoft\\windows\\CurrentVersion\\Run\n\n```\n7.1.3 Persistence through a service\n\nShimRat will create a new service under Windows using the information from the instal\nlation configuration shown in paragraph 7.1.1 above. This operation is performed through\n\nthe Windows API functions available for registering, updating and starting of services[12].\n\nIt will start by stopping and removing any old service (if any exist). ShimRat will register\n\n###### a new service using the information from the persistence configuration and start it,\n\nafter checking and removing any old services.\n\n7.1.4 Persistence through shims[13]\n###### Over the years Microsoft has gone to extraordinary lengths to ensure backward\n\ncompatibility on its Windows platform. One of the outcomes of this process was the\n###### creation of the Application Compatibility Framework (ACF) which helps ensure this\n\ncompatibility. Through this framework, special fixes known as Microsoft Fix It’s or just\n\nfixes can be run which can help mitigate security or compatibility problems.\n\n\n-----\n\n###### The way the ACF works is that when a process is started, it will determine if the\n\nnewly created process needs to be shimmed. If this is the case, a special flag is raised\n\nto indicate this. Based on this flag the operating system will load the installed Shims\n\nand apply the required fixes. This means shims are simply hot patching processes on\n\nthe fly. Most predefined fixes released by Microsoft are stored in:\n\n```\n%WINDIR%\\AppPatch\\sysmain.sdb\n\n```\n\nAny fix not defined in this sdb file, is called a ‘Custom Fix’ and can be installed by anyone\n\nwith knowledge of the workings of this system.\n\n|Col1|Col2|Col3|nje he fo L f or is mp t i in or n m|ct dl r b ix, pa me on ns sta ms a|DL l t ot bu tc an en tal lle th kin|L o h t h s t ls r e g e|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|%WINDIR%\\AppPatch\\Custom\\ (32 bit) %WINDIR%\\AppPatch\\AppPatch64\\Custom\\ (64 bit)||||||||||||||||||||||||\n|||m igu|dat re|ab 13|as .|||||||||||||||||||\n|HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ap HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ap|p p|Co Co|mp mp|a a|tF tF|la la|gs gs|\\C \\I|us ns|t t|om al|le|dS|D|B|||||||||\n\n\n-----\n\n_Figure 13 An example of a 32-bit ShimRat infection with shims_\n\n###### After filling the registry keys, ShimRat calls SdbRegisterDatabaseEx to register the\n\ndatabase and finally ShimFlushCache to flush the cache and enable the shim. From this\n###### point on, every newly started instance of svchost.exe will be shimmed and ShimRat\n will be. It locks itself with the use of mutexes, to ensure there aren’t multiple copies of ShimRat running. ShimRat mutexes are a combination of the string Global\\\\qwe\n\nfollowed by one or more numbers.\n\n7.1.5 Built-in capabilities of ShimRat\n\nShimRat has a set of inbuilt capabilities to give the operators control over their victim.\n\nThe following is a list of capabilities seen in one of the most recent samples.\n\nThe operators are currently able to use ShimRat for among others:\n\n**•** Enumerate connected drives\n\n**•** List, create and modify directories\n\n**•** Upload and download files\n\n**•** Delete, move, copy and rename files\n\n**•** Execute programs\n\n**•** Execute commands\n\n**•** Uninstall itself\n\n7.1.6 Command and control communication\n\nShimRat communicates over HTTP to its C2 server. While versions since 2015 have seen\n\nthe introduction of HTTPS usage, ShimRat does not appear to verify the SSL certificate\n\nof C2 servers, which are generally self-signed certificates. ShimRat does have the ability\n\n###### to use pre-configured HTTP proxies, which is useful in situations where a victim has\n\nforced local proxies in the network with authentication.\n\n\n-----\n\n###### Like with persistence, ShimRat holds a C2 communication configuration internally.\n\nThe structure of the configuration looks as follows (see Table 4):\n\n**Configuration items**\n\n\nPrimary C2 location\n\nSecondary C2 location\n\nCampaign ID\n\nC2 server password\n\nProxy\n\nProxy username\n\nProxy password\n\n_Table 4: C2 communication configuration._\n\nShimRat communicates with its C2 server through a pull and push mechanism. ShimRat\n###### constantly asks its C2 server for commands and once it has executed a command, it will send back the result. The structure of the commands exchanged with the \n\nC2 server is quite simple:\n\n**•** Every command is encapsulated within two tags, currently these tags are the\n\nword ‘Data’ which is added in front of and at the end of the command string.\n\nIn the past this used to be the string ‘Yuok’ as described in paragraph 2.1.\n\n**•** Every command has a unique ‘ID’. These IDs are notated as $$<ID number>\n\n**•** The final structure of the commands send to and from the C2 server is:\n\n<data tag><command ID><command data><data tag>\n\nFor example, when ShimRat first connects to a C2 server it registers itself. This initial\n\nregistration looks like this:\n```\n  Data$$00#DEMO-PC-0800232979FD-SYSTEM.test.0.0.01.1#WinXP Profes\n\n```\nThe aforementioned example shows the two Data tags at the start and at the end. The\n\ncommand id is 00, the registration command, followed by the associated data. In this\n###### case, the data comprises basic information including the machine name, DEMO-PC,\n\nsystem information, 0800232979FD-SYSTEM, the C2 password, test, its version and the\n\noperating system version and whether it is a 32 or 64bit operating system in the last part.\n\n###### ShimRat will continue sending the initial check-in data until the C2 server responds\n\nwith Data. Once it has received this response, which indicates it registered successfully,\n\nit will start polling for new commands to execute.\n\n|Data$$00#DEMO-PC-0800232979FD-SYSTEM.test.0.0.01.1#WinXP|Pr|o|fe|ss|io|n|al|S|P3|(|26|0|0)|(|x8|6)|Da|t|a|Col21|Col22|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n\n\n-----\n\n###### It polls the C2 for commands by sending command id 02 in combination with its\n\nsystem information:\n\n```\nData$$02#DEMO-PC-0800232979FD-SYSTEMData\n\n```\n\nThe C2 server will respond with one of 3 possible tags:\n\n**•** **Atad: returned when there is nothing to do for the malware. ShimRat will sleep**\n\nfor a specified time period before polling again.\n\n**•** **Aatd: returned when the C2 does not recognize the system information. It forces**\n\nShimRat to register itself again. After registering itself again ShimRat will\n\ncontinue polling the C2 server for commands.\n\n**•** **Data: returned when a command is available. The whole response string would**\n\nactually be Data$$<command ID> where ShimRat would parse the command\n\nID, execute the desired command and send the result back to the C2. Details of\n\nwhich command ID maps to which command can be found in Table 5.\n\n###### Table 5 lists the possible command ids that a C2 server could send (the Initiating\n\n_command id) and the corresponding responses by ShimRat (the Responding command_\n\nid). Some commands will result in one or more different responding ids based on the\n\ndata ShimRat has to send back.\n###### Please note, that there are checks when executing these commands where the key\nwords Atad _Aatd and Data are used to evaluate the outcome of the command. These_\n###### states are not described or shown in the table, nor does the table include command\n\nids 00 and 01 which are used for initial registration and command polling respectively.\n\n**Function** **Initiating command ID** **Responding command ID(s)**\n\n\nEnumerate drives 03 04\n\nList directory 06 07\n\nDownload file 09 0b, 24\n\nUpload file 0c \nDelete file 16 \nCreate directory 31 \nCopy file 29 32\n\nMove file 26 32\n\nRename file 28 \nExecute file 17 \nCommand shell 11 12, 15\n\nUninstall 22 \n_Table 5 Overview of ShimRat functions mapped to command IDs_\n\n|• Tab com d). dat Ple wo sta ds Fu En|Sh co D ac ID w le m S a S as rd te 00 nc um|im nt at tu , e hic 5 an om hi e n s A s a a tio er|R in a: all xe h lis d e m ot ta re nd n ate|at ue ret y cu co ts id) co Ra e, d no 0 d|to p ur be te m th a m t h th Aa t 1 w riv|re olli ne D th ma e nd ma as at td de hi es|gi ng d ata e n po th nd to th an scr ch|ste t wh $$ de d I ss e c s s er d ib ar|r i he e <c sir D ibl or wil en e Da ed e u|ts C n a om ed ma e re l r d are ta o se|\n|---|---|---|---|---|---|---|---|---|---|---|\n|Lis|t d|ire|ct|ory|||||||\n|Do|wn|lo|ad|fil|e||||||\n|Up|loa|d|flie||||||||\n|De|let|e f|ile||||||||\n|Cr|eat|e d|ire|ct|or|y|||||\n|Co|py|fil|e||||||||\n|Mo|ve|fil|e||||||||\n|Re|na|me|fil|e|||||||\n|Ex|ecu|te|fil|e|||||||\n|Co|m|ma|nd|sh|ell||||||\n|Un|in|sta|ll||||||||\n\n|ag er om an m to m on ult ck. he e ho fo In 0|ai ve m d m w ma di in ck use w r in iti 3|n. r f an ID an hi n ng o s d n i iti ati|Af or d i > d ch d i re ne wh to n t al ng|te co s a wh an co ds sp or en ev he re co|r r m va er d s m th on m e al ta gis m|eg ma ila e S en m at se or xe ua bl tr m|ist nd bl hi d an a s e cu te e, ati an|eri s. e. m th d c C by dif tin th no on d I|ng it The Rat w e resu an b 2 ser Shim feren g the e out r do and D|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|0|6||||||||||\n|0|9||||||||||\n|0|c||||||||||\n|16|||||||||||\n|31|||||||||||\n|29|||||||||||\n|26|||||||||||\n|28|||||||||||\n|17|||||||||||\n|11|||||||||||\n|22|||||||||||\n\n\n-----\n\n7.2 **ShimRatReporter**\n\n7.2.1 Summary\n###### ShimRatReporter is a tool first seen in late 2014. The goal of this tool is to gather important information about the target infrastructure. More details about this are\n\navailable in paragraph 7.2.2.\n\n###### Additionally the tool can be configured to download a 2[nd] stage payload from 1 or 2 preconfigured locations. The idea behind ShimRatReporter is to be able to deliver customized ShimRat builds. This can be seen in the preconfigured proxy configura\ntion in some of the attacks. In these attacks, the ShimRat builds that were sent to the\n###### target machines were already configured with the credentials for the local proxy in\n\nthe target network.\n\n7.2.2 Report generation\n\nShimRatReporter generates a text based report to send out to its C2 server. The report\n\nis constructed with the following sections.\n\n\n**Section** **Contents**\n\n\nReport header The header contains a timestamp at which the report was made and the local computer name.\n\n\nNetwork information\n\nOperating system\n\ninformation\n\nActive processes\n\ninformation\n\nBrowser and proxy\n\nconfiguration\n\n\nThe first section is titled IP-INFO and contains information about the Windows IP configuration. This includes\n\nlocal IP information, routing tables, mac address, gateway, DNS servers and whether the network has DHCP\n\nenabled. The second section is titled Network-INFO and contains a list of all the TCP and UDP endpoints\n\n(similar to the output of the Netstat command) by formatting the output of the GetExtendedUdpTable and\n\n_GetExtendedUdpTable Windows API functions._\n\nThis section is titled OS-INFO and contains the operating system name and specific windows version\n\nincluding any service packs if they are installed.\n\nThis section is titled Process-INFO and contains a list of all the running process on the machine including\n\ntheir PID and parent PID.\n\nThis section is titled Browser-INFO and contains the User-Agent of the default browser as well as any\n\nproxy configurations set in the registry.\n\n\nActive user sessions This section is titled QueryUser-INFO and contains a list of active sessions on the machine enumerated\n\nwith the WTSEnumerateSessions Windows API function.\n\nUser accounts This section is titled Users-INFO and contains a list of the non-privileged and privileged accounts that\n\nare available on the machine.\n\nInstalled software This section is titled Software-INFO and contains a list of all the installed software on the machine\n\nexcluding any Windows updates / components.\n\nReport footer The footer of the report contains some additional information on whether the 2[nd] stage payloads,\n\nif configured, were successfully downloaded and executed.\n\n|Col1|Col2|Col3|tio ay c at|n a , D ont tin|bo NS ain g t|ut ser s a he|th ve lis ou|e W rs t o tpu|in an f a t o|do d w ll t f t|ws he he he|IP th TCP Ge|co er t a tEx|nfi he nd te|gu ne UD nde|rat tw P e dU|ion or nd dp|. T k h po Ta|his as int ble|in DH s an|clu CP d|de|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||ati|ng|sy|st|em|na|m|e a|nd|sp|ec|ific|w|ind|o|ws|ve|rsi|on||\n||||st o|f a|ll t|he|ru|nn|in|g p|ro|ces|s o|n|the|m|ac|hin|e i|nc|lud|in|\n||||e U|se|r-A|ge|nt|of|th|e d|ef|aul|t b|ro|ws|er|as|we|ll a|s a|ny||\n|||ns tio|a l n.|ist|of|ac|tiv|e s|es|sio|ns|on|th|e|ma|chi|ne|en|u|me|rat|ed|\n|||st|of|the|n|on|-pr|ivi|leg|ed|an|d|pri|vil|eg|ed|acc|ou|nt|s t|ha|t|\n||in|s a|lis|t o|f al|l t|he|ins|tal|led|s|oft|wa|re|on|th|e|ma|chi|ne|||\n|ion an|al d e|inf xe|or cu|ma ted|tio .|n|on|wh|et|he|r t|he|2nd|st|ag|e p|ay|loa|ds|,|||\n\n\n-----\n\n7.2.3 Command and control communication\n\nShimRatReporter communicates over HTTP with a preconfigured C2 server. The gener\nated report is first compressed using lz compression applied with the RtlCompressBuffer\n\nWindows API function. After compression, the data is encrypted with a combination\n###### of shifting and xor using a static key. The key hardcoded in all versions seen in the\n\nwild is ‘NetMeter’.\n\nAfter a report is generated, the raw buffer with the data is taken and iterated through\n\nusing an index. If the index is divisible by two, the value in the buffer is xor-ed. If it’s not\n\ndivisible by two, the value of the key is added to the value in the buffer. This is probably\n\nbest explained by showing the code for the decryption tool that Fox-IT has created:\n\n###### For every element in the encrypted report data, the index is checked to be divisible by two, using the modulo operation to wrap the key. If this is true, the value in the\n\nencrypted report is xor-ed with a value from the static key. If it is not divisible, it will\n###### subtract the ordinal key value from the current element in the encrypted report. In\n\nthe encryption process the subtraction is just an addition.\n\nThe report is then sent out in a post request to a preconfigured C2 server and a gate\n\npath. The url parameter filename is added to the post url. Its value is the computer\n\nname, also listed in the report, and an id. The C2 servers responds with a 200 ok when\n\nthe report has been successfully received.\n\n_Figure 14 Example ShimRat report upload_\n\n|b|es|t e|xp|la|in|ed|by|s|ho|wi|ng|th|e|co|de|fo|r t|he|d|ec|ry|Col23|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||\n|F b e s t T p n t|or y nc ub he he at a he|e tw ry tr e r h. me re|ver o, pt ac ncr ep Th , a po|y us ed t t yp or e lso rt|el in re he ti t is ur li h|em g t po or on th l p ste as|en he rt di pr e ar d be|t i m is na oc n s a in en|n o xo l k es en me th s|th du r ey s t t o te e r uc|e e lo -ed v he ut r fi ep ces|nc op w alu s in le or sf|ry er it e ub a na t, a ull|pt at h a fro tra po me n y r|ed io v m ct s is d a ec|re n t alu th io t r a n i ei|p o e e n i eq dd d. ve|ort wr fro cu s j ue ed Th d.|d ap m rr us st to e|at t th en t a to t C2|a, t he e t e n a a he se||\n||||||||||||||||||||||||\n\n\n-----\n\n###### Additionally, ShimRatReporter can be configured to download a payload. Reporting is default but payload downloading is optional. Payloads are downloaded from \n\npreconfigured locations. The payloads are encrypted in a similar way. Figure 15 shows\n\nan example payload download from the same campaign as shown in Figure 14.\n\n_Figure 15 Example ShimRat payload download_\n\n\n-----\n\n## 8 Network based detection (IOCs)\n\nThe following sections contain iocs for infrastructure communication from the Mofang\n\ngroup from 2012 until the end of 2015. There are duplicate domains and ips in the list,\n\ndue to an overlap in domains for the ips and a domain having pointed at multiple ips.\n\n8.1 **Snort signatures**\n\nThe following Snort signatures provide coverage for the known HTTP based ShimRat\n\nand ShimRatReporter C2 communication protocols. One thing to keep in mind is that\n\nsome variants of ShimRat communicate over HTTPS, which these rules will not cover.\n\n###### These IOCs are also available from our Github repository located at: https://github.\n\n[com/fox-it/mofang/](https://github.com/fox-it/mofang/)\n\n|c|om|/f|ox|-it|/m|o|fa|ng|/|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||\n|||a c p c c 6 m a ( c c a s a c H c i c m a c u Ty r a|le he hp on on 00 ot le ph on on ct te le he TT on sd la ot le he ri p ef dv|rt ck H te te ; iv rt p) te te iv al rt ck P/ te at ss iv rt ck co e\" er er|t -i TT nt nt cl at t \"; nt nt it in t -i 1. nt aa ty at t -i nt ; en sa|cp n P/ :! :\" as ed cp fl :\" :! y; g- cp n 1|0 :! t: pe ed cp n\" en th ce ry|$ (D 1. \"R Da st -i $ ow |0 \"C r ad $ (Y d \"C !1 :t -i $ ; t: re :u /;|HO at \"; ef ta yp nf HO :e d0 oo ef ve HO uo 0a oo ,r ro nf HO co \". sh rl s|M a) c er \"; e: o M st a0 ki e r M k) |U ki el ja o M nt ph ol ,b id|E_ \"; on er i tr rm E_ ab d0 e: re sa E_ \"; se e: at n rm E_ en p? d: lo :2|NE fl te :\" sd o at NE li a| \"; nc ry NE f r- \"; iv -a at NE t: fli t g. 10|T ow nt ; a ja io T sh ph t e: /; T ol w Ag c e; ct io T \"P en y fo 01|an :e :\" co ta n- n- an e p hr ur s an :e en on t iv n- an OS a pe x- 85|y st |0 nt at ac st y d,t \"; es l, id y st t: te hr it st y T\" me l it 7;|-> ab d0 e :!1 ti e -> o f h bl :2 -> ab \" n e y; e -> ; =\" im .c|$ li a0 nt ,r vi al $ _s as ol og 10 $ l ; t:\" sh r al $ ht ; it om re|E s d :!\" e ty in E er t_ d: .f 01 E is fa |0 ol ef in E t co , /2 v:|XT he 0a Co la ; g- XT ve pa t ox 85 XT he s d0 d: e g- XT p_ nt tr 0 4;)|ER d, |D o ti re ad ER r; tt yp -i 5; ER d, t_ a t re ad ER me en ac 16|NA to at ki ve f ve NA c e e t. r NA to pa 0d yp nc ve NA th t: k /0|L_ _s a$ e: ; er rs L_ on rn li co ev L_ _s tt 0a e e: rs L_ o \"A b 6/|NET $HTTP_PORTS (msg:\"FOX-SRT - Trojan - ShimRat erver; content:\"POST\"; http_method; content:\". $\"; fast_pattern:only; content:!\"Content-Type\"; \"; content:\"|0d0a0d0a|\"; pcre:\"/Data\\$\\$\\d\\d/R\"; threshold: type limit, track by_src, count 1, seconds ence:url,blog.fox-it.com/2016/06/15/mofang-a-politically- ary/; sid:21001854; rev:4;) NET $HTTP_PORTS (msg:\"FOX-SRT - Trojan - ShimRat check-in tent:\"POST\"; http_method; content:\".php HTTP/1.\"; :only; content:!\"Content-Type\"; content:!\"Referer:\"; mit, track by_src, count 1, seconds 600; classtype:trojan- m/2016/06/15/mofang-a-politically-motivated-information- :4;) NET $HTTP_PORTS (msg:\"FOX-SRT - Trojan - ShimRat erver; content:\"POST\"; http_method; content:\".php ern:only; content:!\"Content-Type\"; content:!\"Referer:\"; |\"; pcre:\"/(php)?Yuok\\$\\$\\d\\d/R\"; content:\"Yuok\"; limit, track by_src, count 1, seconds 600; url,blog.fox-it.com/2016/06/15/mofang-a-politically- ary/; sid:21001856; rev:4;) NET $HTTP_PORTS (msg:\"FOX-SRT - Trojan - ShimRatReporter d; content:\"Accept-Encoding: utf-8|0d0a|\"; fast_pattern; ccept: */*\"; content:!\"Referer\"; content:!\"Content- y_src, count 1, seconds 600; classtype:trojan-activity; 15/mofang-a-politically-motivated-information-stealing-|\n\n\n-----\n\n8.2 Domains & IP addresses\n###### The following domains and associated ips have a lot of historical data. Keep in mind the listed domains could be on shared hosting machines or compromised websites. Please make sure to correlate any hits from the table below with the listed samples\n\nand their configurations in section 10.1.\n\nThis table only contains domains setup by the Mofang group themselves, it does not\n\ncontain some of the compromised shared hosting domains listed in some samples in\n\nparagraphs 9.2 and 9.3.\n\n\nDomain 116.251.216.227 October 2014\n\nvideo.today-nytimes.com 178.209.52.72 May 2014\n\n116.251.216.227 December 2013\n\n23.89.200.128 October 2013\n\n23.89.201.173 October 2013\n\napi.officeonlinetool.com 176.31.220.160 September 2015\n\nie.update-windows-microsoft.com 116.251.219.142 November 2015\n\n116.251.216.72 October 2015\n\n49.213.18.15 June 2015\n\n116.251.210.77 March 2015\n\n116.251.216.227 July 2014\n\n178.209.52.72 May 2014\n\ntravel.tripmans.com 38.109.190.55 November 2014\n\ndns.undpus.com 107.191.61.105 May 2015\n\nsecure2.sophosrv.com 178.209.52.72 May 2015\n\nupdate.nfkllyuisyahooapis.com 117.17.10.10 November 2012\n\nwww.go-gga.com 61.250.92.79 January 2013\n\nimages.defexpoindia14.com 178.209.51.164 August 2013\n\nupdate.micrdsoft.com 151.236.14.53 July 2013\n\nsupport.f--secure.com - December 2012\n\nstore.outlook-microsoft.net 116.251.216.227 October 2014\n\n178.209.52.72 April 2014\n\n151.236.14.53 September 2013\n\n\nb.support.outlook-microsoft.net 178.209.52.72 Augustus 2013\n\nlogon.had-one-job.com - September 2013\n\nwww.avgfree.us 210.245.85.83 April 2013\n\nmail.upgoogle.com 116.251.219.142 December 2015\n\n116.251.210.77 March 2015\n\n116.251.216.227 Augustus 2014\n\n178.209.52.72 July 2014\n\n50.117.47.66 June 2014\n\n50.117.47.67 June 2014\n\n192.157.229.164 March 2014\n\n198.98.103.7 Augustus 2013\n\nwbmail.city-library.com 103.229.124.1 June 2015\n\n112.213.117.52 May 2015\n\n116.251.216.165 September 2014\n\n103.39.78.131 April 2014\n\n192.157.229.164 March 2014\n\nlibrary.cpgcorp.org 38.109.190.55 May 2015\n\n|ne|t|Col3|\n|---|---|---|\n||||\n||||\n||||\n||||\n||||\n\n|I 1|P 78.|20|9.5|2.|72|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|-||||||||\n|2|10.|24|5.8|5.|83|||\n|11|6.|251|.21|9.1|42|||\n|11|6.|251|.21|0.|77|||\n|11|6.|251|.21|6.|22|7||\n|1|78.|20|9.5|2.|72|||\n|5|0.1|17.|47.|66||||\n|5|0.1|17.|47.|67||||\n|1|92.|157|.2|29.|16|4||\n|1|98.|98|.10|3.|7|||\n|1|03.|22|9.1|24|.1|||\n|11|2.|213|.11|7.5|2|||\n|11|6.|251|.21|6.1|65|||\n|1|03.|39|.78|.13|1|||\n|1|92.|157|.2|29.|16|4||\n|3|8.1|09|.19|0.|55|||\n\n|Fi A|rst ug|se ust|en us|20|13|Col7|Col8|\n|---|---|---|---|---|---|---|---|\n|S|ept|em|b|er|201|3||\n|A|pri|l 2|013|||||\n|D|ec|em|be|r 2|01|5||\n|M|ar|ch|20|15||||\n|A|ug|ust|us|20|14|||\n|Ju|ly|20|14|||||\n|Ju|ne|20|14|||||\n|Ju|ne|20|14|||||\n|M|ar|ch|20|14||||\n|A|ug|ust|us|20|13|||\n|Ju|ne|20|15|||||\n|M|ay|20|15|||||\n|S|ept|em|b|er|201|4||\n|A|pri|l 2|014|||||\n|M|ar|ch|20|14||||\n|M|ay|20|15|||||\n\n\n-----\n\n## 9 Host based detection (IOCs)\n\n9.1 **yara rules**\n###### The following yara rules can be used to detect the ShimRat and ShimRatReporter\n\nsamples.\n\n###### These IOCs are also available from our Github repository located at: https://github.\n\n[com/fox-it/mofang/](https://github.com/fox-it/mofang/)\n\nShimRat\n\n```\nrule shimrat\n{\n meta:\n\n```\ndescription = \"Detects ShimRat and the ShimRat loader\"\n\nauthor = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n\ndate = \"20/11/2015\"\n```\n strings:\n\n```\n$dll = \".dll\"\n\n$dat = \".dat\"\n\n$headersig = \"QWERTYUIOPLKJHG\"\n\n$datasig = \"MNBVCXZLKJHGFDS\"\n\n$datamarker1 = \"Data$$00\"\n\n$datamarker2 = \"Data$$01%c%sData\"\n\n$cmdlineformat = \"ping localhost -n 9 /c %s > nul\"\n\n$demoproject_keyword1 = \"Demo\"\n\n$demoproject_keyword2 = \"Win32App\"\n\n$comspec = \"COMSPEC\"\n\n$shim_func1 = \"ShimMain\"\n\n$shim_func2 = \"NotifyShims\"\n\n$shim_func3 = \"GetHookAPIs\"\n```\n condition:\n ($dll and $dat and $headersig and $datasig) or ($datamarker1 and $datamarker2) or\n($cmdlineformat and $demoproject_keyword1 and $demoproject_keyword2 and $comspec) or ($dll\nand $dat and $shim_func1 and $shim_func2 and $shim_func3)\n}\n\n```\n\n-----\n\nShimRatReporter\n\n```\nrule shimratreporter\n{\n meta:\n\n```\ndescription = \"Detects ShimRatReporter\"\n\nauthor = \"Yonathan Klijnsma (yonathan.klijnsma@fox-it.com)\"\n\ndate = \"20/11/2015\"\n```\n strings:\n\n```\n$IpInfo = \"IP-INFO\"\n\n$NetworkInfo = \"Network-INFO\"\n\n$OsInfo = \"OS-INFO\"\n\n$ProcessInfo = \"Process-INFO\"\n\n$BrowserInfo = \"Browser-INFO\"\n\n$QueryUserInfo = \"QueryUser-INFO\"\n\n$UsersInfo = \"Users-INFO\"\n\n$SoftwareInfo = \"Software-INFO\"\n\n$AddressFormat = \"%02X-%02X-%02X-%02X-%02X-%02X\"\n\n$proxy_str = \"(from environment) = %s\"\n\n$netuserfun = \"NetUserEnum\"\n\n$networkparams = \"GetNetworkParams\"\n```\n condition:\n all of them\n}\n\n```\n\n-----\n\n9.2 ShimRat samples\n\nThe following list of samples includes the core of ShimRat as well as the loader dll in\n\nthe cases where ShimRat relied on dll hijacking to start.\n\n\n**ShimRat core**\n\n\nFilename(s) `vmware-vmx.exe`\n\nRelated campaign `-`\n\nC2 URL `http://www.goodlook.sg/po/index.php`\n\nMD5 `e79b2d2934e5525e7a40d74875f9d761`\n\nSHA256 `a835baa7ffc265346443b5d6f4828d7221594bd91be8afc08152f3d68698b672`\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|Sh Fil|im en|Ra am|t c e(s|or )|e||||||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n|Sh Fil|im en|Ra am|t c e(s|or )|e||||||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|\n|---|---|---|---|---|---|---|---|---|\n|v|m|wa|re|-v|m|x.|ex|e|\n|-|||||||||\n|h|t|tp|:/|/w|ww|.g|o|od|\n|e|79|b|2d|29|34|e|55|25|\n|a|8|35|ba|a7|ff|c|26|53|\n|m|s|vc|r1|10|.d|at|||\n|“|C|it|ri|x|lu|r|e”|,|\n|h|t|tp|s:|//|ap|i.|of|fci|\n|6 0|b 4|12 8c|6c ae|d9 f9|a5 2|f ce|2a b5|f3 1|\n|2 b d|65 e 8|3 76 e6|ec bd 8d|c3 dd 2d|ea e 51|17 a6 4|e c1 1a|0d 08 4a|\n\n\n-----\n\n**ShimRat core** **ShimRat core loader DLL**\n\n\nFilename(s) `elogger.dat` Filename(s) `elogger.dll`\n\nRelated campaign `-`\n\nC2 URL `http://travel.tripmans.com/links/images/links.php`\n\n\nMD5 `23a1a7f0f30f-`\n\n\nMD5 `b4554c52f708154e529f-`\n```\n         62ba8e0de084\n\n```\nSHA256 `0cc1660e384683f2147e02ff-`\n\n\nSHA256\n\n```\n18ba4d0461829eb46766\nd834e70a524a87945f7a8880b78f5e10460c1d2b60f3e487cb6f05c8221aa4f8\n\n```\n\n**ShimRat core** **ShimRat core loader DLL**\n\n\nFilename(s) `elogger.dat` Filename(s) `elogger.dll`\n\nRelated campaign `“Myanmar”, see section 5`\n\nC2 URL `http://dns.undpus.com/index.php`\n\n\nMD5 `8c85d527340a17d267379bc-`\n\n\nMD5 `26ff9e2da06b7e90443d-`\n```\n         6190388581ab\n\n```\nSHA256 `5dc3f4a067ae125f-`\n\n\nSHA256\n\n```\nd9e5e5b1f\nf71025d47105dcd674a0b9ef0c83a83854ba20cb0eb8168da36a7908d150e44f\n\n```\n|co (s)|re|lo|ad|er|DL|L el|og|g|er|.d|ll|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||\n|es|/|li|nk|s.|ph|p|||||||||||||||\n|||||||b4 62|55 ba|4 8|c5 e0|2f de|70 08|81 4|5|4e|52|9f|-||||\n|||||||0c 76 98 82|c1 c6 43 58|66 98 3c d|0 2 3 a3|e3 2e a3 8|84 e2 61|68 b- 3b|3 b|f2 d2|14 8b|7e 9d|02 -|f|f-||\n|co (s)|re|lo|ad|er|DL|L el|og|g|er|.d|ll||||||||||\n||||||||||||||||||||||\n||||||||||||||||||||||\n|||||||26 61|ff 90|9 38|e2 8|da 58|06 1a|b7 b|e|90|44|3d|-||||\n|||||||5d 99 c7 da|c3 fa ef 5b|f 9 66 71|4a 08 7 c|06 44 35|7a bb 3e|e1 a 28|2 66 2f|5f 72 f|- 35 29|e- 71|2d|-|||\n\n\n-----\n\n**ShimRat core**\n\n\nFilename(s) `vmware-vmx.exe`\n\nRelated campaign “Global campaign”, see section 6.4\n\nC2 URL `https://ie.update-windows-microsoft.com/my/js/index.php`\n\nMD5 `2cc5bc69e24a13bfc8ea3dc679ab0efc`\n\nSHA256 `36422e6ccaa50a9ecceb7fb709a9e383552732525cb579f8438237d87aaf8377`\n\n\n**ShimRat core**\n\n\nFilename(s) `svchost.exe`\n\nRelated campaign `-`\n\nC2 URL `http://update.nfkllyuisyahooapis.com/js/js/js.php`\n\nMD5 `f9c14a8e9ceb143d959743ad8c09fdc4`\n\nSHA256 `b53b27bb3e9d02e3ec5404cf3e67debb90d9337dbb570ca8b8cfce1054428466`\n\n|Sh Fil|im en|Ra am|t c e(s|or )|e|Col7|Col8|Col9|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n|Sh Fil|im en|Ra am|t c e(s|or )|e||||||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n|Sh Fil|im en|Ra am|t c e(s|or )|e||||||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n\n|v|m|wa|re|-v|m|x.|ex|e|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|“|G|lo|ba|l|ca|m|pa|ig|||\n|h|t|tp|s:|//|ie|.u|pd|at|||\n|2|c|c5|bc|69|e2|4|a1|3b|||\n|3|6|42|2e|6c|ca|a|50|a9|||\n|e|l|og|ge|r.|da|t|||||\n|-|||||||||||\n|h|t|tp|://|ww|w|.t|in|ro|||\n|a d|3 35|f7 9|89 5c|5f 36|ae 6|0|5f|a1|||\n|3 f 1 a|c e d 6|5c 6a 6a 34|4d 70 73 4e|68 97 8b 8d|d ec b|0f 7d 00|a6 0 64|52 f- bb|||\n|s|v|ch|os|t.|ex|e|||||\n|-|||||||||||\n|h|t|tp|:/|/u|pd|at|e.|n|fk|ll|\n|f|9|c1|4a|8e|9|ce|b1|43|d9|59|\n|b|53|b|27|bb|3e|9|d0|2e|3e|c5|\n\n\n-----\n\n**ShimRat core**\n\n\nFilename(s) `svchost.exe`\n\nRelated campaign `“Myanmar”, see section 5`\n\nC2 URL `http://www.commerce.gov.mm/templates/css1/logon.php`\n\nMD5 `a4da3b820883e9808bd3ca2e02437a25`\n\nSHA256 `2b111e287d356ac4561ba4f56135b7c1361b7da32e5825028a5e300e44b05579`\n\n\n**ShimRat core**\n\n\nFilename(s) `vmware-vmx.exe`\n\nRelated campaign `-`\n\nC2 URL `http://www.ipacking.co.kr/ez/admin/data/403.php`\n\nMD5 `ca41c19366bee737fe5bc5008250976a`\n\nSHA256 `029e735581c38d66f03aa0e9d1c22959b0bc8dfe298b9e91b127c42c7f904b5e`\n\n\n**ShimRat core**\n\n\nFilename(s) `-`\n\nRelated campaign `“MSME DEFEXPO”, see section 6.1`\n\nC2 URL `http://images.defexpoindia14.com/se/index.php`\n\nMD5 `25e87e846bb969802e8db9b36d6cf67c`\n\nSHA256 `33b288455c12bf7678fb5fd028ff3d42fcaf33cf833a147cb7f0f89f7dad0d8f`\n\n\n**ShimRat core**\n\n\nFilename(s) `helpservice.exe`\n\nRelated campaign “Global Campaign”, see section 6.4\n\nC2 URL `http://update.micrdsoft.com/image/image.php`\n\nMD5 `cf883d04762b868b450275017ab3ccfa`\n\nSHA256 `eb2d3c9e15b189dd02f753f805e90493254e17d40db6f1228a4e4095c5f260c1`\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||/c|s|s1|/l|og|on|.p|h|p|||||||||||||\n|||||||||||||||||||||||||\n||||7d|a3|2e|5|82|50|28|a5|e|30|0e|44|b|05|57|9||||||\n|||||||||||||||||||||||||\n|||||||||||||||||||||||||\n||||at|a/|40|3.|ph|p||||||||||||||||\n|||||||||||||||||||||||||\n||||c8|df|e2|98|b|9e|91|b1|2|7c|42|c7|f9|04|b|5e||||||\n|||||||||||||||||||||||||\n|||||||||||||||||||||||||\n||||in|de|x|.p|hp|||||||||||||||||\n|||||||||||||||||||||||||\n||||f3|3c|f8|3|3a|14|7c|b7|f0|f|89|f7|da|d|0d|8f||||||\n|||||||||||||||||||||||||\n||.4|||||||||||||||||||||||\n||e/|im|ag|e|.p|hp||||||||||||||||||\n|||||||||||||||||||||||||\n|93|25|4|e1|7d|40|db|6|f1|22|8a|4|e4|09|5c|5|f2|60|c1||||||\n\n\n-----\n\n**ShimRat core**\n\n\nFilename(s) `svchost.exe`\n\nRelated campaign `“seg”, see section 6.2`\n\nC2 URL HTTP=proxy.seg.local:8080\n\nMD5 `http://support.f--secure.com/cache/cache.php`\n\nSHA256 `4e22e8bc3034d0df1e902413c9cfefc9`\n\n```\n577622fbf0a7bebc60844df808e75eef81a3d62ec6943f80168ac0d5ef39de5c\n\n```\n\n**ShimRat core**\n\n\nFilename(s) `Update.exe`\n\nRelated campaign “Global campaign”, see section 6.4\n\nC2 URL `http://store.outlook-microsoft.net/en-us/c/index.php`\n\nMD5 `2f14d8c3d4815436f806fc1a435e29e3`\n\nSHA256 `d2d4723f8c3bba910cade05c9ecea00cdcc647d42232bccc610d066792a95b15`\n\n\n**ShimRat core**\n\n\nFilename(s) `vmware-vmx.exe`\n\nRelated campaign “Global campaign”, see section 6.4\n\nC2 URL `https://ie.update-windows-microsoft.com/company/js/index.php`\n\nMD5 `36e057fa2020c65f2849d718f2bb90ad`\n\nSHA256 `dae17755e106be27ea4b97120906c46d4fcbb14cc8d9fc2c432f4c0cc74bb3fb`\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n|Sh Fil|im en|Ra am|t c e(s|or )|e||||||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n|Sh Fil|im en|Ra am|t c e(s|or )|e||||||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n|Sh Fil|im en|Ra am|t c e(s|or )|e||||||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|\n|---|---|---|---|---|---|---|---|---|---|---|---|\n|h|t|tp|:/|/i|ma|ge|s.|d||||\n|b|2|81|a2|e1|45|7c|d|5c||||\n|2|4|1c|66|bb|54|b|d2|7a||||\n|s|v|ch|os|t.|ex|e||||||\n|“|s|eg|”,|s|ee|s|e|ct||||\n|H|T|TP|=p|ro|x|y.|se|g.||||\n|h|t|tp|:/|/s|up|po|r|t.f||||\n|4|e|22|e8|bc|30|3|4d|0d||||\n|5|7|76|22|fb|f0|a|7b|eb||||\n|U|p|da|te|.e|xe|||||||\n|“|G|lo|ba|l|ca|m|pa|ig||||\n|h|t|tp|:/|/s|to|re|.o|ut||||\n|2|f|14|d8|c3|d|48|15|43||||\n|d|2|d4|72|3f|8c|3|bb|a9||||\n|v|m|wa|re|-v|m|x.|ex|e||||\n|“|G|lo|ba|l|ca|m|pa|ig|n|”,||\n|h|t|tp|s:|//|ie|.u|pd|at|e|-w||\n|3|6|e0|57|fa|20|2|0c|65|f2|84||\n|d|a|e1|77|55|e1|06|b|e2|7e|a4|b|\n\n\n-----\n\n**ShimRat core**\n\n\nFilename(s) `svchost.exe`\n\nRelated campaign `-`\n\nC2 URL `http://www.domesky.com/ez/admin/data/index.php`\n\nMD5 `a326e2abacc72c7a050ffe36e3d3d0eb`\n\nSHA256 `fa28559a4e0e920b70129cea95a98da9a409eaa093c63f341a7809692b31e723`\n\n\n**ShimRat core**\n\n\nFilename(s) `-`\n\nRelated campaign `-`\n\nC2 URL `http://logon.had-one-job.com/2008/vcards/log/us/index.php`\n\nMD5 `d7a575895b07b007d0daf1f15bfb14a1`\n\nSHA256 `234d62ffd83c3972a32e89685787ff3aab4548cd16e4384c3c704a059ef731ce`\n\n\n**ShimRat core**\n\n\nFilename(s) `-`\n\nRelated campaign “Global campaign”, see section 6.4\n\nC2 URL `http://store.outlook-microsoft.net/en-us/c/index.php`\n\nMD5 `888cac09f613db4505c4ee8d01d4291b`\n\nSHA256 `e01aae93f68a84829fd8c0bc5ae923897d32af3a1d78623839fcfd18c99627cc`\n\n\n**ShimRat core**\n\n\nFilename(s) `-`\n\nRelated campaign `-`\n\nC2 URL `http://www.psychologia.uni.wroc.pl/sites/default/bm.php`\n\nMD5 `916a2a20a447b10e379543a47a60b40f`\n\nSHA256 `2a1a0d8d81647c321759197a15f14091ab5e76b913eb2d7d28c6bb053166d882`\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||/i|nd|e|x.|ph|p||||||||||||||||\n|||||||||||||||||||||||||\n||||9e|aa|09|3|c6|3f|34|1a|7|80|96|92|b3|1e|7|23||||||\n|||||||||||||||||||||||||\n|||||||||||||||||||||||||\n||||ar|ds|/l|o|g/|us|/i|nd|e|x.|ph|p||||||||||\n|||||||||||||||||||||||||\n||||54|8c|d1|6|e4|38|4c|3|c7|04|a0|59|e|f7|31|ce||||||\n|||||||||||||||||||||||||\n|||||||||||||||||||||||||\n||||n-|us|/c|/|in|de|x.|ph|p|||||||||||||\n|||||||||||||||||||||||||\n||||2a|f3|a1|d|78|62|38|39|f|cf|d1|8c|9|96|27|cc||||||\n|||||||||||||||||||||||||\n|||||||||||||||||||||||||\n||pl|/s|it|es|/d|ef|a|ul|t/|bm|.p|h|p|||||||||||\n|||||||||||||||||||||||||\n|91|ab|5e|76|b|91|3e|b2|d|7d|28|c6|bb|0|53|16|6d|88|2||||||\n\n\n-----\n\n**ShimRat core**\n\n\nFilename(s) `-`\n\nRelated campaign `-`\n\nC2 URL HTTP=150.207.1.67:80\n\nMD5 `http://video.today-nytimes.com/en-us/b/index.php`\n\nSHA256 `f4b247a44be362898c4e587545c7653f`\n\n```\n558461b6fb0441e7f70c4224963490ea49f44d40c5700a4c7fd19be4c62b3d6a\n\n```\n\n**ShimRat core**\n\n\nFilename(s) `-`\n\nRelated campaign “Global campaign”, see section 6.4\n\nC2 URL `http://mail.upgoogle.com/image/image.php`\n\nMD5 `5c00ccf456135514c591478904b146e3`\n\nSHA256 `1ca75e9b1761e15968d01a6e4f0a9f6ce47ba7ee4047d1533fb838f0f6ab28e2`\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n|Sh Fil|im en|Ra am|t c e(s|or )|e||||||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n|Sh Fil|im en|Ra am|t c e(s|or )|e||||||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|C2|U|RL|||||||||\n|M|D5||||||||||\n|SH|A2|56|||||||||\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|\n|---|---|---|---|---|---|---|---|---|\n|h|t|tp|:/|/a|dv|en|tu|r|\n|4|8|4c|7f|9e|6|c9|23|3b|\n|1|92|2|27|3b|b3|6|ab|28|\n|-|||||||||\n|-|||||||||\n|H|T|TP|=1|50|.2|07|.1|.6|\n|h|t|tp|:/|/v|id|eo|.t|od|\n|f|4|b2|47|a4|4b|e|36|28|\n|5|58|4|61|b6|fb|04|4|1e|\n|-|||||||||\n|“|G|lo|ba|l|ca|m|pa|ig|\n|h|t|tp|:/|/m|ai|l.|up|g|\n|5|c|00|cc|f4|56|1|35|51|\n|1|c|a7|5e|9b|17|61|e|15|\n\n\n-----\n\n9.3 ShimRatReporter samples\n###### The following samples are the core ShimRatReporter samples. Some of these were\n\ndelivered in Zip archives or packaged in some form but those aren’t listed.\n\n###### These table blocks contain parsed configuration data for the samples, the domains\n\nlisted here are also present separately in the Network ioc paragraph 2, but added here\n\nto give an overview and outline the relationship between the iocs.\n\n\n**ShimRatReporter core**\n\n\nObserved filename(s) `vmware-vmx.exe`\n\nRelated campaign `-`\n\nConfigured C2 domain `www.ipacking.co.kr`\n\nConfigured C2 reporting gate `http://www.ipacking.co.kr/ez/admin/data/403.php`\n\nMD5 `ca41c19366bee737fe5bc5008250976a`\n\nSHA256 `029e735581c38d66f03aa0e9d1c22959b0bc8dfe298b9e91b127c42c7f904b5e`\n\n\n**ShimRatReporter core**\n\n\nObserved filename(s) `photo.exe`\n\nRelated campaign `-`\n\nConfigured C2 domain `dns.undpus.com`\n\nConfigured C2 reporting gate `http://dns.undpus.com/info.php`\n\nConfigured 2[nd] stage payload `http://dns.undpus.com/myanmar.jpg`\n\nMD5 `9a6167cf7c180f15d8ae13f48d549d2e`\n\nSHA256 `b7edbe6aee1896a952fcce2305c2bb7d8e77162bb45e305c64c7f8c9f63b3ab5`\n\n\n**ShimRatReporter core**\n\n\nObserved filename(s) `loader.exe`\n\nRelated campaign `-`\n\nConfigured C2 domain `dns.undpus.com`\n\nConfigured C2 reporting gate `http://dns.undpus.com/info.php`\n\nConfigured 2[nd] stage payload `http://dns.undpus.com/info.txt`\n\nMD5 `0067bbd63db0a4f5662cdb1633d92444`\n\nSHA256 `ac3b42453fac93e575988ba73ab24311515b090d57b1ad9f27dcbae8363f2d99`\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||\n|||at|a/|40|3.|ph|p||||||||||||||||\n||||||||||||||||||||||||\n|||c8|df|e2|98|b|9e|91|b1|2|7c|42|c7|f9|04|b|5e||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n|||1|62|bb|45|e|30|5c|64|c7|f|8c|9f|63|b3|a|b5||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n||||||||||||||||||||||||\n|51|5b|09|0|d5|7b|1a|d|9f|27|dc|ba|e|83|63|f2|d|99||||||\n\n\n-----\n\n**ShimRatReporter core**\n\n\nObserved filename(s) `-`\n\nRelated campaign “Global campaign”, see section 6.4\n\nConfigured C2 domain `ie.update-windows-microsoft.com`\n\nConfigured C2 reporting gate `http://ie.update-windows-microsoft.com/load/uplogo.php`\n\nConfigured 2[nd] stage payload `http://ie.update-windows-microsoft.com/load/logo.gif`\n\nMD5 `582e4adddfd12f7d68035c3b8e2e3378`\n\nSHA256 `722f41aa2c7d670364b7a9bb683a0025aef5893b34af67873972cdaf09490ad2`\n\n\n**ShimRatReporter core**\n\n\nObserved filename(s) AlphaZawgyl_font.exe\n\nRelated campaign `“Myanmar”, see section 5`\n\nConfigured C2 domain `library.cpgcorp.org`\n\n```\nsecure2.sophosrv.com\n\n```\n\nConfigured C2 reporting gate http://library.cpgcorp.org/links/images/file/blanks.php\n\nConfigured 2[nd] stage payload `http://library.cpgcorp.org/links/images/blanks.jpg`\n\n```\nhttps://secure2.sophosrv.com/en-us/support/blanks.jpg\n\n```\n\nMD5 `b43e5988bde7bb03133eec60daaf22d5`\n\nSHA256 `7deb75e95e8e22c6abb3b33c00b47a93122b8c744e8f66affd9748292e5a177f`\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|Re|lat|ed|ca|mp|ai|gn|||||\n|Co|nfi|gu|re|d C|2 d|o|ma|in|||\n|Co|nfi|gu|red|C|2 re|po|rti|ng|ga|te|\n|Co|nfi|gu|red|2n|d s|tag|e p|ay|loa|d|\n|M|D5||||||||||\n|SH|A2|56|||||||||\n|Sh Ob|im se|Ra rv|tR ed|ep file|or na|te m|r c e(s|ore )|||\n|Re|lat|ed|ca|mp|ai|gn|||||\n|Co|nfi|gu|re|d C|2 d|o|ma|in|||\n|Co|nfi|gu|red|C|2 re|po|rti|ng|ga|te|\n|Co|nfi|gu|red|2n|d s|tag|e p|ay|loa|d|\n|M|D5||||||||||\n|SH|A2|56|||||||||\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|\n|---|---|---|---|---|---|---|---|---|\n|“|G|lo|ba|l|ca|m|pa|ig|\n|i|e.|u|pd|at|e-|w|in|do|\n|h|t|tp|:/|/i|e.|up|da|te|\n|h|t|tp|:/|/i|e.|up|da|te|\n|5|8|2e|4a|dd|d|fd|12|f7|\n|7|2|2f|41|aa|2c|7d|6|70|\n|A|l|ph|aZ|aw|g|yl|_f|on|\n|“|M|ya|nm|a|r”|,|se|e|\n|l|i|br|ar|y.|cp|gc|o|rp|\n|s|e|cu|re|2.|so|p|ho|sr|\n|h|t|tp|:/|/l|ib|ra|ry|.c|\n|h|t|tp|:/|/l|ib|ra|ry|.c|\n|h|t|tp|s:|//|se|cu|re|2.|\n|b|4|3e|59|88|bd|e|7b|b0|\n|7|d|eb|75|e9|5e|8|e2|2c|\n\n\n-----\n\n9.4 Antivirus hijacking components\n\nAs described in section 7.2 the ShimRat malware uses certain antivirus product compo\nnents that are vulnerable to dll hijacking in order to run. The following tables contain\n\nall the indicators for these components.\n\nKeep in mind that these indicators are only useful indicators if the antivirus product\n\nthe component comes from is not installed.\n\nCompany `Norman`\n\nApplication name `Program Manager`\n\nVersion (product specific) `10.0.0.0`\n\nHijacked DLL `elogger.dll`\n\nFirst seen used `2014-04-30`\n\nMD5 `23a3f48df4b36e3d2e63cde4b85cf4fa`\n\nSHA256 `006c74c6813a6efeabea860b2718ed548eed216a319d76ceb178fc38cba458d1`\n\nCompany `McAfee`\n\nApplication name `McAfee Oem Module`\n\nVersion (product specific) `2.1.0.0`\n\nHijacked DLL `mcutil.dll`\n\nFirst seen used `2015-03-15`\n\nMD5 `884d46c01c762ad6ddd2759fd921bf71`\n\nSHA256 `3124fcb79da0bdf9d0d1995e37b06f7929d83c1c4b60e38c104743be71170efe`\n\nCompany `Symantec`\n\nApplication name `Norton Identity Safe`\n\nVersion (product specific) `2015.2.1.5`\n\nHijacked DLL `msvcr110.dll`\n\nFirst seen used `2015-09-07`\n\nMD5 `1f330f00510866522f14790398a5be59`\n\nSHA256 `33fff13b0d0e76a09100efa0b407fe8cdfd0758500dad7cc59722bf3b537de62`\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n||d2|16|a|31|9d|76|ce|b|17|8f|c3|8c|b|a4|58|d1||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n||83|c1|c4|b|60|e3|8c|1|04|74|3b|e7|11|7|0e|fe||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|||||||||||||||||||||||\n|fd|07|5|85|00|da|d|7c|c5|97|22|b|f3|b5|37|de|62||||||\n\n\n-----\n\n9.5 Observed services\n###### As explained in paragraph 7.1.3, ShimRat can become persistent through the use of services. The configuration of the service which includes the service name, title and description is configured inside the individual ShimRat samples. The list below are uniquely observed service configurations. Correlating these with the actual process\n\nthe service starts, is a good indicator of the presence of ShimRat.\n\nService name `WWebLogic`\n\nService title `Windows WebLogic Service`\n\n\nService description\n\n```\nDHCP service for windows networks.Provides Windows DHCP Net foundation frame support,through the framework, on servers that are also\nrunning the service.\n\n```\n\nService name `WNetDHCP`\n\nService title `Windows DHCP Service`\n\n```\nDHCP service for windows networks.Provides Windows DHCP Net foundation frame support,through the framework, on servers that are also\nrunning the service.\n\n```\n\nService name `helpservices`\n\nService title `Windows Help Services`\n\nService description `Enables Help and Support Center to run on this computer. If this service`\n\n```\nis stopped, Help and Support Center will be unavailable.\n\n```\n\nService name `mshelpsrvs`\n\nService title `Windows Help Services`\n\nService description `Enables Help and Support Center to run on this computer. If this service`\n\n```\nis stopped, Help and Support Center will be unavailable.\n\n```\n\nService name `mshelpsrvsv`\n\nService title `Windows Help Services`\n\nService description `Enables Help and Support Center to run on this computer. If this service`\n\n```\nis stopped, Help and Support Center will be unavailable.\n\n```\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|\n|---|---|---|---|---|---|---|---|---|---|---|---|\n|S|er|vic|e n|am|e|||||||\n|S|er|vic|e t|itle||||||||\n|S|er|vic|e d|es|cri|pti|on|||||\n|S|er|vic|e n|am|e|||||||\n|S|er|vic|e t|itle||||||||\n|S|er|vic|e d|es|cri|pti|on|||||\n|S|er|vic|e n|am|e|||||||\n|S|er|vic|e t|itle||||||||\n|S|er|vic|e d|es|cri|pti|on|||||\n|S|er|vic|e n|am|e|||||||\n|S|er|vic|e t|itle||||||||\n|S|er|vic|e d|es|cri|pti|on|||||\n\n|t r|i u|on nn|f in|ra g|m t|e he|su s|pp er|Col10|Col11|\n|---|---|---|---|---|---|---|---|---|---|---|\n|W|N|et|DH|CP|||||||\n|W|i|nd|ow|s|D|HC|P|Se|||\n|D t r|H i u|CP on nn|s f in|er ra g|v m t|ic e he|e su s|fo pp er|||\n|h|e|lp|se|rv|i|ce|s||||\n|W|i|nd|ow|s|H|el|p|Se|||\n|E i|n s|ab s|le to|s pp|He ed|lp ,|H|an el|||\n|m|s|he|lp|sr|v|s|||||\n|W|i|nd|ow|s|H|el|p|Se|||\n|E i|n s|ab s|le to|s pp|He ed|lp ,|H|an el|||\n|m|s|he|lp|sr|v|sv|||||\n|W|i|nd|ow|s|H|el|p|Se|r|vi|\n|E i|n s|ab s|le to|s pp|He ed|lp ,|H|an el|d p|Su an|\n\n\n-----\n\nService name `mshelplog`\n\nService title `Windows Help log`\n\nService description `Enables Help and Support Center to run on this computer. If this service`\n\n```\nis stopped, Help and Support Center will be unavailable.\n\n```\n\nService name `avp2015`\n\nService title `Kaspersky protect service`\n\nService description `Kaspersky protect service`\n\n9.6 Observed shims\n\nAs discussed in paragraph 7.1.4, ShimRat can obtain persistence on systems by installing\n\n###### shims. The following table contains the settings for these shims and some observed\n\nhashes. Checking for the configurations of these shims will be more effective than just\n\nchecking the listed hashes.\n\nPlatform `x86`\n\nName `Clengine_Shim`\n\nApplication name `Clengine_Apps`\n\nDatabase name `Clengine_Database`\n\nType of fix `InjectDLL`\n\nInjection target `svchost.exe`\n\nInjection DLL `elogger.dll`\n\nDatabase GUID `{503ec3d3-165a-4770-b799-099d43b833ec}`\n\nExe GUID `{e8cc2eb5-469c-43bd-9d69-de089e497302}`\n\nMD5 `cacbdf48a61ee0999da003f090027598`\n\nSHA256 `7c8f962129f9d8fef6df7ca29ee7672c30286660298e0ef8b40f6a17f029187f`\n\nPlatform `x64`\n\nName `Clengine_Shim`\n\nApplication name `Clengine_Apps`\n\nDatabase name `Clengine_Database`\n\nType of fix `InjectDLL`\n\nInjection target `svchost.exe`\n\nInjection DLL `eloggerx64.dll`\n\nDatabase GUID `{f8c4cc07-6dc4-418f-b72b-304fcdb64052}`\n\nExe GUID `{7feee735-1296-4c40-bdd4-7d4f09acc2d0}`\n\nMD5 `5f287a8082df8ed7b081137507c03638`\n\nSHA256 `286616a5124f57f165ba2a1aa540200e103e976ce181dd61fe39faf05cf5378d`\n\n|Col1|Col2|Col3|Col4|ns bs th|tal er an|lin ve ju|g d st|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n|||||c}|||||||||||||||||||||\n|||||2}|||||||||||||||||||||\n||||||||||||||||||||||||||\n|||||86|66|02|98|e|0e|f8|b|40|f6|a1|7|f0|29|18|7f||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||||||||||||||||||||||||||\n||b|64|05|2}|||||||||||||||||||||\n||9a|cc|2d|0}|||||||||||||||||||||\n||38||||||||||||||||||||||||\n|20|0e|10|3e|9|76|ce|18|1d|d|61|fe|39|fa|f|05|cf|53|78|d||||||\n\n\n-----\n\n-----\n\n|Col1|Col2|Col3|Col4|Col5|Col6|Col7|Col8|Col9|Col10|Col11|Col12|Col13|Col14|Col15|Col16|Col17|Col18|Col19|Col20|Col21|Col22|Col23|Col24|Col25|Col26|Col27|Col28|Col29|Col30|Col31|Col32|Col33|Col34|Col35|Col36|Col37|Col38|Col39|Col40|Col41|Col42|Col43|Col44|Col45|Col46|Col47|Col48|Col49|Col50|Col51|Col52|Col53|Col54|Col55|Col56|Col57|Col58|Col59|Col60|Col61|Col62|Col63|Col64|Col65|Col66|Col67|Col68|Col69|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||fox-it • Was founded in 1999. • Established one of the first Cyber Security Operations Centers in Europe. • Is Europe’s largest specialized cyber security company. • Operates in three business areas: 1 Cyber Threat Management: a solution portfolio aimed at reducing the risks of cyber threats, and includes: professional services, managed security services, and technology; 2 Web and Mobile event analytics: a solution portfolio that is aimed at reducing financial risks in (online) payment transactions; 3 High Assurance: solutions that make trusted communication possible to the highest classification levels. • Has been involved in many high-profile Incident Response cases. Most of the cases we worked on are secret. An approved selection can be shared upon request. fox-it||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||ion possible to the highest levels. d in many high-profile Incident Most of the cases we worked on proved selection can be shared fox-it|||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||possible to the highest||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||vels. many high-profile Incident st of the cases we worked on ved selection can be shared fox-it||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||ny high-profile Incident f the cases we worked on selection can be shared fox-it|||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||e cases we worked on ection can be shared fox-it||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||||tion can be shared fox-it|||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||fox-it||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||fox-it||||||||||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||||||||fox-it|||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||||||||||fox-it|||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||fox-it||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||||||||||||fox-it|||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||fox-it||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||||||||||||||fox-it|||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||fox-it||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||||||||||||||||fox-it|||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||fox-it||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||||||||||||||||||fox-it|||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||||||||||||||||||O|lof Palmestraat 6, Del|||||||ft||t|+|31|(0||||||||||||||||||||||||||\n|||||||||||||||||||||||||||||||p|o b|ox 638, 2600 ap De||||||lft||f|+|31|||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n|||||||||||||||||||||||||||||||T|he|N|||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n\n\nfox-it\n\n**•** Was founded in 1999.\n\n**•** Established one of the first Cyber Security\n\nOperations Centers in Europe.\n\n**•** Is Europe’s largest specialized cyber security\n\ncompany.\n\n**•** Operates in three business areas:\n\n1 Cyber Threat Management: a solution portfolio\n\naimed at reducing the risks of cyber threats,\n\nand includes: professional services, managed\n\nsecurity services, and technology;\n\n2 Web and Mobile event analytics: a solution\n\nportfolio that is aimed at reducing financial\n\nrisks in (online) payment transactions;\n\n3 High Assurance: solutions that make trusted\n\ncommunication possible to the highest\n\nclassification levels.\n\n**•** Has been involved in many high-profile Incident\n\nResponse cases. Most of the cases we worked on\n\nare secret. An approved selection can be shared\n\nupon request.\n\n**fox-it**\n\nOlof Palmestraat 6, Delft t +31 (0) 15 284 79 99 www.fox-it.com\npo box 638, 2600 ap Delft f +31 (0) 15 284 79 90\n\nThe Netherlands e fox@fox-it.com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "bf5be533-fa31-4590-ae37-5761c97ffa34",
            "created_at": "2022-10-25T16:13:58.389257Z",
            "updated_at": "2022-10-25T16:13:58.389257Z",
            "deleted_at": null,
            "name": "Malpedia",
            "url": "https://malpedia.caad.fkie.fraunhofer.de",
            "description": "Malpedia is a free service offered by Fraunhofer FKIE",
            "reports": null
        },
        {
            "id": "6825b8cb-7d82-43d2-b0b0-d51c7e255b42",
            "created_at": "2023-01-06T13:46:37.642134Z",
            "updated_at": "2023-01-06T13:46:37.642134Z",
            "deleted_at": null,
            "name": "MISPGALAXY",
            "url": "https://www.misp-project.org/galaxy.html",
            "description": "MISP Galaxy Clusters",
            "reports": null
        }
    ],
    "references": [
        "https://foxitsecurity.files.wordpress.com/2016/06/fox-it_mofang_threatreport_tlp-white.pdf",
        "https://app.box.com/s/p2oftago51ohnku082ztx1kbvaa1lxps",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.05.17.Mofang/fox-it_mofang_threatreport_tlp-white.pdf"
    ],
    "report_names": [
        "fox-it_mofang_threatreport_tlp-white.pdf",
        "Fox-IT_mofang_threatreport_tlp-white(05-17-2016)",
        "fox-it_mofang_threatreport_tlp-white"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a2939cf7-76f8-4080-9ba1-42ccb4016b3b",
            "created_at": "2022-10-25T15:50:23.53328Z",
            "updated_at": "2025-03-27T02:00:55.494818Z",
            "deleted_at": null,
            "main_name": "Mofang",
            "aliases": [
                "Mofang"
            ],
            "source_name": "MITRE:Mofang",
            "tools": [
                "ShimRatReporter",
                "ShimRat"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "761d1fb2-60e3-46f0-9f1c-c8a9715967d4",
            "created_at": "2023-01-06T13:46:38.269054Z",
            "updated_at": "2025-03-27T02:00:02.789278Z",
            "deleted_at": null,
            "main_name": "APT3",
            "aliases": [
                "TG-0110",
                "Group 6",
                "Buckeye",
                "Boyusec",
                "BORON",
                "BRONZE MAYFAIR",
                "Red Sylvan",
                "GOTHIC PANDA"
            ],
            "source_name": "MISPGALAXY:APT3",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "db318f04-09e6-4c57-b0e9-3f71f0b2de94",
            "created_at": "2023-01-06T13:46:38.648954Z",
            "updated_at": "2025-03-27T02:00:02.882685Z",
            "deleted_at": null,
            "main_name": "Mofang",
            "aliases": [
                "BRONZE WALKER"
            ],
            "source_name": "MISPGALAXY:Mofang",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "df9bfbf1-bb9d-492f-b381-95b9e1482267",
            "created_at": "2022-10-25T16:07:24.394491Z",
            "updated_at": "2025-03-27T02:02:10.207352Z",
            "deleted_at": null,
            "main_name": "Whitefly",
            "aliases": [
                "ATK 83",
                "Bronze Walker",
                "Mofang",
                "SectorM04",
                "TEMP.Mimic"
            ],
            "source_name": "ETDA:Whitefly",
            "tools": [
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Mimikatz",
                "Nibatad",
                "Shim RAT",
                "ShimRAT",
                "Vcrodat"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "728d2c2c-c4af-4cdc-8723-5d3aa97924a8",
            "created_at": "2024-05-01T02:03:08.002557Z",
            "updated_at": "2025-03-27T02:05:17.299162Z",
            "deleted_at": null,
            "main_name": "BRONZE WALKER",
            "aliases": [
                "Mofang ",
                "CTG-2810 "
            ],
            "source_name": "Secureworks:BRONZE WALKER",
            "tools": [
                " Superman",
                "ShimRat"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "06f622cb-3a78-49cf-9a4c-a6007a69325f",
            "created_at": "2022-10-25T16:07:23.315239Z",
            "updated_at": "2025-03-27T02:02:09.733197Z",
            "deleted_at": null,
            "main_name": "APT 3",
            "aliases": [
                "APT 3",
                "Bronze Mayfair",
                "Buckeye",
                "Gothic Panda",
                "Group 6",
                "Operation Clandestine Fox",
                "Operation Clandestine Fox, Part Deux",
                "Operation Clandestine Wolf",
                "Operation Double Tap",
                "Red Sylvan",
                "TG-0110",
                "UPS Team"
            ],
            "source_name": "ETDA:APT 3",
            "tools": [
                "APT3 Keylogger",
                "Agent.dhwf",
                "BKDR_HUPIGON",
                "Backdoor.APT.CookieCutter",
                "Badey",
                "Bemstour",
                "CookieCutter",
                "Destroy RAT",
                "DestroyRAT",
                "DoublePulsar",
                "EXL",
                "EternalBlue",
                "HTran",
                "HUC Packet Transmit Tool",
                "Hupigon",
                "Hupigon RAT",
                "Kaba",
                "Korplug",
                "LaZagne",
                "MFC Huner",
                "OSInfo",
                "Pirpi",
                "PlugX",
                "RedDelta",
                "RemoteCMD",
                "SHOTPUT",
                "Sogu",
                "TIGERPLUG",
                "TTCalc",
                "TVT",
                "Thoper",
                "Xamtrav",
                "remotecmd",
                "shareip",
                "w32times"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041718,
    "ts_creation_date": 1464348178,
    "ts_modification_date": 1464348225,
    "files": {
        "pdf": "https://archive.orkl.eu/ffa66796bd7c7f077c31285e6563ccb522b7e9b1.pdf",
        "text": "https://archive.orkl.eu/ffa66796bd7c7f077c31285e6563ccb522b7e9b1.txt",
        "img": "https://archive.orkl.eu/ffa66796bd7c7f077c31285e6563ccb522b7e9b1.jpg"
    }
}