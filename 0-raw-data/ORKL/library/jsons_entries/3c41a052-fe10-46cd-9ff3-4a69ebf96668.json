{
    "id": "3c41a052-fe10-46cd-9ff3-4a69ebf96668",
    "created_at": "2022-10-25T16:48:14.235421Z",
    "updated_at": "2025-03-27T02:08:12.808347Z",
    "deleted_at": null,
    "sha1_hash": "ad88223032e7cb6b373a458e6472870a7ca69e37",
    "title": "Using Honeynets and the Diamond Model for ICS Threat Analysis",
    "authors": "",
    "file_creation_date": "2016-05-06T10:53:51Z",
    "file_modification_date": "2016-05-06T11:24:36Z",
    "file_size": 280392,
    "plain_text": "# Using Honeynets and the Diamond Model for ICS Threat Analysis\n\nJohn Kotheimer\nKyle O’Meara\nDeana Shick\n\n**May 2016**\n\n**TECHNICAL NOTE**\nCMU/SEI-2016-TR-006\n\n**CERT Division**\n\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n[http://www.sei.cmu.edu](http://www.sei.cmu.edu)\n\n\n-----\n\nCopyright 2016 Carnegie Mellon University\n\nThis material is based upon work funded and supported by Department of Homeland Security under\nContract No. FA8721-05-C-0003 with Carnegie Mellon University for the operation of the Software\nEngineering Institute, a federally funded research and development center sponsored by the United\nStates Department of Defense.\n\nAny opinions, findings and conclusions or recommendations expressed in this material are those of the\nauthor(s) and do not necessarily reflect the views of Department of Homeland Security or the United\nStates Department of Defense.\n\nReferences herein to any specific commercial product, process, or service by trade name, trade mark,\nmanufacturer, or otherwise, does not necessarily constitute or imply its endorsement, recommendation,\nor favoring by Carnegie Mellon University or its Software Engineering Institute.\n\nThis report was prepared for the\nSEI Administrative Agent\nAFLCMC/PZM\n20 Schilling Circle, Bldg 1305, 3rd floor\nHanscom AFB, MA 01731-2125\n\nNO WARRANTY. THIS CARNEGIE MELLON UNIVERSITY AND SOFTWARE ENGINEERING\nINSTITUTE MATERIAL IS FURNISHED ON AN “AS-IS” BASIS. CARNEGIE MELLON\nUNIVERSITY MAKES NO WARRANTIES OF ANY KIND, EITHER EXPRESSED OR IMPLIED,\nAS TO ANY MATTER INCLUDING, BUT NOT LIMITED TO, WARRANTY OF FITNESS FOR\nPURPOSE OR MERCHANTABILITY, EXCLUSIVITY, OR RESULTS OBTAINED FROM USE\nOF THE MATERIAL. CARNEGIE MELLON UNIVERSITY DOES NOT MAKE ANY\nWARRANTY OF ANY KIND WITH RESPECT TO FREEDOM FROM PATENT, TRADEMARK,\nOR COPYRIGHT INFRINGEMENT.\n\n[Distribution Statement A] This material has been approved for public release and unlimited distribution. Please see Copyright notice for non-US Government use and distribution.\n\nInternal use:* Permission to reproduce this material and to prepare derivative works from this material\nfor internal use is granted, provided the copyright and “No Warranty” statements are included with all\nreproductions and derivative works.\n\nExternal use:* This material may be reproduced in its entirety, without modification, and freely distributed in written or electronic form without requesting formal permission. Permission is required for any\nother external and/or commercial use. Requests for permission should be directed to the Software En[gineering Institute at permission@sei.cmu.edu.](mailto:permission@sei.cmu.edu)\n\n- These restrictions do not apply to U.S. government entities.\n\nCarnegie Mellon[®], CERT[®] and CERT Coordination Center[®] are registered marks of Carnegie Mellon\nUniversity.\n\nDM-0003602\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## Table of Contents\n\n**Acknowledgments** **v**\n\n**Abstract** **vi**\n\n**Introduction** **1**\n\n**1** **Data Sources** **2**\n1.1 ICS Honeynet Packet Capture Data 2\n1.2 Data Issues 2\n1.2.1 Incomplete Record of Activity 2\n1.2.2 Lack of Honeynet Configuration Data 2\n1.2.3 Need for Manual Analysis of Certain Data 3\n1.3 WHOIS and DNS Data 3\n1.4 VirusTotal 3\n1.5 Palo Alto Networks’ Threat Intelligence Reports 3\n1.6 Additional Open Source Information 4\n\n**2** **Tools** **5**\n2.1 GNU Core Utilities 5\n2.2 SiLK and super_mediator 5\n2.3 Shell Scripts 5\n\n**3** **Diamond Model of Intrusion Analysis** **6**\n3.1 Core Concepts 6\n3.2 Analytic Pivoting 7\n3.3 Activity Group Creation 7\n\n**4** **Methodology** **8**\n4.1 Variables Used 8\n4.2 Partitioning and Identification of ICS Honeynet Data 8\n4.2.1 Characterizing Network Traffic Using SiLK 8\n4.2.2 Examination of HTTP POST Data 9\n4.2.3 Examination of Traffic on Common ICS Ports 9\n4.2.4 Diamond Model Event Definition 9\n4.3 Analytic Pivoting 10\n4.3.1 Host-Centered Approach 10\n4.3.2 Port-Centered Approach 11\n4.4 Grouping Potential Threat Actors 11\n4.4.1 Defining the Activity Group Creation Function 11\n\n**5** **Results** **13**\n5.1 Honeynet Configuration 13\n5.2 Characterization of Threat Actors Through Analytic Pivoting 14\n5.2.1 Host-Centered Approach 14\n5.2.2 Port-Centered Approach 15\n5.3 Using Honeynet Data to Group Actors 18\n5.3.1 Active Threat Actors 18\n5.3.2 High-Risk Actors 18\n5.3.3 Moderate-Risk Actors 19\n5.3.4 Unknown-Risk Actors / Outliers 21\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY i\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n**6** **Discussion** **22**\n6.1 Specific Threats to ICS 22\n6.2 Challenges in Configuring an ICS Honeynet 22\n6.3 Implications for the Defense of ICS Networks 23\n\n**7** **Future Work** **24**\n\n**8** **Conclusion** **25**\n\n**Appendix** **Example SiLK Queries** **26**\n\n**References** **29**\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY ii\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## List of Figures\n\nFigure 1: A Diamond Model Event (Caltagirone, Pendergast and Betz 2013) 6\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY iii\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## List of Tables\n\nTable 1: Diamond Model Variables 8\n\nTable 2: Honeynet Host Configuration 14\n\nTable 3: 'Bookworm' Hosts Observed in PCAP Data 15\n\nTable 4: Top Hosts Communicating on Port 20000 15\n\nTable 5: Top Hosts Communicating on Port 102 16\n\nTable 6: Common ICS-Related Ports Observed in Data Set 17\n\nTable 7: Selected Active Threat Actors 18\n\nTable 8: Selected High-Risk Actors 19\n\nTable 9: MT2 Exploit Attempts Observed 20\n\nTable 10: Selected Moderate-Risk Actors 21\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY iv\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## Acknowledgments\n\nWe would like to thank Leigh Metcalf for assistance with gathering data from internal databases\nthat we used in our analysis.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY v\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## Abstract\n\nThe use of a honeynet—a network of seemingly vulnerable machines designed to lure attackers—\nis an established technique for collecting threat intelligence across various network environments.\nAs a result, organizations have begun to use this approach to protect networked industrial control\nsystems (ICS). Organizations hope to observe attempts to compromise their systems in an isolated\nenvironment, enabling them to deploy mitigations and harden their networks against emerging\nthreats.\n\nThis report presents an approach to analyzing approximately 16 gigabytes of full packet capture\ndata collected from an ICS honeynet. The data is analyzed in the context of other open source information about known threats to ICS to understand how adversaries interacted with the network\nand the types of attacks they attempted. To provide a more rigorous approach to characterizing\nthese threat actors, the study employed the well-known Diamond Model of Intrusion Analysis. It\napplied this model to define and categorize several groups of potential threat actors observed\nwithin the data. The study also evaluated the effectiveness of honeynets as a tool for ICS threat\nintelligence. This report includes several recommendations for their deployment and emphasizes\nactive interaction with external hosts to generate higher quality data.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY vi\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## Introduction\n\nDefending industrial control systems (ICS) is critical to securing critical infrastructure. Given the\nhigh probability of a physical impact in the event of a cybersecurity breach, defenders of ICS networks must understand their adversaries and the capabilities of these actors. Moreover, due to the\nscale of many organizations employing these systems, prioritizing threats is a major concern when\ndeploying effective threat intelligence and monitoring. A valuable tool for supporting this mission\nis the honeynet, a sandboxed network of seemingly vulnerable honeypot hosts that mimic production machines on an organization’s network. A properly configured honeynet can observe threats\nthat may be highly specific to a particular environment, generating valuable data that can inform\nnetwork defenders. Nevertheless, the volume of data that these systems offer can be daunting and\nmakes generating actionable intelligence difficult.\n\nThis study analyzes a collection of unclassified data from an ICS honeynet in an effort to generate\nuseful threat intelligence and prioritization from the data. We applied the Diamond Model of Intrusion Analysis first described by Caltagirone, Pendergast, and Betz (Caltagirone, Pendergast and\nBetz 2013). This model allows us to characterize events in terms of multiple dimensions, each\nwith underlying data points. In doing so, it is possible to uncover relationships between seemingly\nunconnected data elements to obtain a better understanding of an organization’s threat profile and\nprovide intelligence-driven defenses.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 1\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## 1 Data Sources\n\n### 1.1 ICS Honeynet Packet Capture Data\n\nThe main data set for this study is a collection of full network packet capture (PCAP) data obtained from an undisclosed organization (Undisclosed 2016). The honeynet emulated an ICS network at a U.S.-based company in the energy sector. To the extent that could be determined, we\nobserved that hosts on the honeynet included Windows and Windows Server machines. It was not\npossible to determine the configuration of all devices on the local network, nor was this information provided with the PCAP data.\n\nSensors within this network environment captured all incoming and outgoing traffic in the standard libpcap format used by applications like tcpdump and Wireshark. This anonymized data\nshowed the 10 honeypot hosts represented by addresses in the fictitious 0.0.0.0/24 subnet. All Internet Protocol (IP) addresses external to the network remained as captured by the network sensor.\nThe PCAP data is available for the date range beginning June 23, 2015, through February 29,\n2016. The packet capture ran nearly continuously throughout this time, delivered as individual\nfiles for each day. In total, the files contain approximately 16 GB of data. The data set contains\ntraffic from at least 66,936 unique hosts communicating via Transmission Control Protocol\n(TCP), User Datagram Protocol (UDP), and Internet Control Message Protocol (ICMP), which\ncollectively account for over 99.999% of packets captured.\n\n### 1.2 Data Issues\n\n**1.2.1** **Incomplete Record of Activity**\n\nWhile very useful as a source of network interactions between the honeynet and external hosts,\nthe PCAP data used for this analysis occasionally lacks context that would aid a more thorough\nunderstanding of certain activity observed within the traffic. For instance, when observing suspected malware command-and-control (C2) traffic, it was not possible to observe the initial vector\nof compromise. It is possible that this traffic was observable at a time prior to that of the first\nPCAP received, or that the initial compromise occurred over an encrypted connection. Analysis of\nhost-based artifacts could potentially explain this, but this is beyond the scope of this report. The\ndata set is reasonably rich and provides sufficient traffic for analysis. As a selection of data from a\nlarger ongoing project, it will lack context from outside the time frame under analysis.\n\n**1.2.2** **Lack of Honeynet Configuration Data**\n\nAlthough some basic details on the honeynet have been provided and others can be inferred from\ndata appearing in packet payloads originating form honeypot machines (see Section 5.1), this\nstudy treats the honeynet itself as a black box. The configuration of the hosts was not apparent. It\nalso was not possible to reliably determine how they listened for and/or responded to network\ntraffic. This in turn complicates the understanding of adversary attack chains, as the honeynet\nmight not be replying to adversary probes in a way that will prompt further network reconnaissance or surveillance. This is a common difficulty in honeynet operation and is not specific to this\nparticular example, although the effects are highly visible in this data set.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 2\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\nA related ICS-specific issue is that it is difficult to determine which devices the network is attempting to emulate (if any). While this PCAP data originates from an explicitly ICS-based honeynet, no other specific configuration details are available. This presents a challenge in using the\nDiamond Model to analyze intrusion events, as this framework uses data about the victim as an\nintegral part of analysis. However, information derived from the PCAP data allows us to make\ncertain assumptions about the victim, albeit with a lower level of confidence.\n\n**1.2.3** **Need for Manual Analysis of Certain Data**\n\nBecause this study seeks emerging threats to ICS, it is difficult to automate many of the steps in\ndata analysis. Caltagirone and colleagues remark that this can be a limitation of the Diamond\nModel, as there may not be an existing method of automating analysis with the model for every\ncase (Caltagirone, Pendergast and Betz 2013). ICS defense is an emerging field that requires the\nanalysis of many proprietary or specialized protocols; few automated tools satisfy the objectives\nof this study. As a result, the study included manual data analysis, particularly when examining\npacket payloads. Although it is possible to engage in automated payload analysis after developing\nsignatures for traffic of interest, it is generally not an option until such traffic has been determined. Even with this possibility, automated analysis was of limited value due to the considerable\nvariety in payloads, traffic types, and hosts from which the data originated. While we may certainly draw useful conclusions from manual analysis, incorporating more automation might help\nus to discover isolated data or subtle patterns that could be valuable to the study.\n\n### 1.3 WHOIS and DNS Data\n\nIn identifying the hosts present in the honeynet data, we queried various WHOIS and DNS databases. These publicly available collections of information associate hostnames with IP addresses\nand identify the organizations responsible for address spaces and domain names. Many of the organizations that ultimately maintain this information are regional Internet registries such as ARIN\nand RIPE; we employed online tools that aggregate information from the various open databases,\nincluding services such as RobTex and DomainTools. These services also provide cross references among various DNS databases, autonomous system numbers (ASN), and blacklist information for many hosts.\n\n### 1.4 VirusTotal\n\nVirusTotal is an open source database of file analyses incorporating the detection engines of numerous commercial anti-malware solutions. In addition to filename analysis, VirusTotal scans and\nrecords information on various domains and hosts to track any malware that might have originated from them. This information helped us to determine whether a host that appeared in the\nhoneynet data had a relation to malware distribution or C2. The VirusTotal database also incorporates references to related files and hosts, plus community-submitted information and reports that\ncan provide additional information (VirusTotal 2016).\n\n### 1.5 Palo Alto Networks’ Threat Intelligence Reports\n\nIn late 2015, Palo Alto Networks’ Unit 42 group published two short reports describing a threat\nactor codenamed “Bookworm.” According to the reports, this actor used malware that primarily\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 3\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\ntargeted government organizations within the nation of Thailand. Bookworm’s malware and infrastructure featured a high degree of modularity and technical sophistication. The reports, entitled\n“Bookworm Trojan: A Model of Modular Architecture” and “Attack Campaign on the Government of Thailand Delivers Bookworm Trojan,” provide an in-depth analysis of the group’s tactics,\ntechniques, and procedures. Additionally, they include indicators of compromise such as hash values and domain names (Scott, Falcone and Cortes 2015).\n\n### 1.6 Additional Open Source Information\n\nVarious publicly available documents provided context and analysis for the PCAP data. These\ndocuments included reports by security vendors and researchers, which contained information on\nmalware families, threat actors, and alleged C2 domains that facilitated analysis of certain network traffic. Vendor documentation and other publicly available data obtained through Internet\nresearch supplied basic facts about the default configurations of applications and devices (such as\nthe default ports used by ICS devices).\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 4\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## 2 Tools\n\nA number of tools aided in rapidly analyzing and characterizing members of this large data set.\nAnalysis primarily took place within a Linux environment, supported by a large number of open\nsource tools for network traffic analysis. Research conducted using open source databases complemented the artifacts generated by these tools. This analysis and research provided the information necessary to create the data tuples necessary for analysis with the Diamond Model.\n\n### 2.1 GNU Core Utilities\n\nThe various GNU core utilities, such as grep, cut, and cat, were useful in manipulating large\namounts of network traffic data. Since the PCAP data was distributed as separate files, using these\ntools was especially helpful to analyze many or all of these files collectively.\n\n### 2.2 SiLK and super_mediator\n\nSiLK, or System for Internet-Level Knowledge, is a suite of tools for analyzing network traffic\nthat was developed by the CERT Division of the Carnegie Mellon Software Engineering Institute\n(Software Engineering Institute 2016). We used the various SiLK tools considerably throughout\nthe study. SiLK made it possible to query large amounts of network traffic data and understand\nthe overall picture of external host interaction with the honeynet, particularly in terms of time, frequency, protocol, and port. In turn, this analysis aided characterization of hosts and events within\nthe context of the Diamond Model. The SiLK tools most commonly used in this study include\nrwfilter, rwstats, and rwsetbuild. We employed the rwp2yaf2silk tool to generate\nflow records from the PCAP data.\n\nAnother tool developed by the CERT Division, super_mediator, enabled us to process payload\ndata from the PCAP files at scale. We used super_mediator in combination with YAF to extract\nspecific payload data by providing Berkeley packet filter (BPF) rules to the applications. This\ntechnique served as a useful alternative to a graphical protocol analyzer (such as Wireshark) for\napplication-layer analysis of the traffic (Software Engineering Institute 2016).\n\n### 2.3 Shell Scripts \n\nWe automated several portions of our analysis with shell scripts that were implemented in GNU\nBash. These scripts performed tasks such as converting batches of PCAPs to flow records, extracting event tuples from flow records, organizing data sets, and parsing or converting numerous\nitems from the data set at once.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 5\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## 3 Diamond Model of Intrusion Analysis\n\n### 3.1 Core Concepts\n\nThe Diamond Model of Intrusion Analysis provides a formalized way to characterize network intrusions (Caltagirone, Pendergast and Betz 2013). The Diamond Model gets its name from the\nfundamental data structure it uses to describe intrusion events: a graph of four connected features\nthat describe the adversary, capability, infrastructure, and victim involved, as shown in Figure 1.\nEach of these elements is itself a tuple of various data points, which may be tailored to the specific analysis being conducted. Generally, the tuple includes elements such as organization/actor\n(if known), IP address, application, source/destination port, and related elements (Caltagirone,\nPendergast and Betz 2013). Crucially, each element forms an ordered pair with a confidence level,\nwhich facilitates using this model to develop analytic products. In addition, an event has meta-features such as start and end time, phase, result, direction, methodology, and resources (Caltagirone,\nPendergast and Betz 2013). To understand the PCAP data, we created events (including their necessary subcomponents) to characterize and associate activities by potential threat actors. The Diamond Model’s use of tuples complements SiLK’s use of 5-tuples for capturing network flow\nmetadata, facilitating the integration of this information when generating event data.\n\n_Figure 1: A Diamond Model Event (Caltagirone, Pendergast and Betz 2013)_\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 6\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n### 3.2 Analytic Pivoting\n\nThe architects of the model describe analytic pivoting as a process that allows an analyst to obtain\nmissing information by combining data from within one of the four primary tuples with other\nsources of intelligence (Caltagirone, Pendergast and Betz 2013). Analytic pivoting is at the center\nof this study: it enabled us to assemble details of threats revealed by the honeynet into usable theses. In many cases, all but one of the data tuples was evident in an event. To obtain the missing\ninformation, we made inferences using data that was shared across seemingly disparate events.\nWe used the two methods described in Section 4.3 to enumerate and connect these data.\n\n### 3.3 Activity Group Creation\n\nThe Diamond Model architects describe the activity group (AG) as “a set of Diamond events and\nactivity threads associated by similarities in their features or processes and weighted by confidence” (Caltagirone, Pendergast and Betz 2013). In essence, an AG is a way to relate numerous\nevents in order to grasp the implications of apparently correlated activities and develop effective\ndefenses driven by a complete understanding of the potential threat actor (Caltagirone, Pendergast\nand Betz 2013). Particularly when considering such a large data set, it is important to have a\nmethod for rapidly associating events. AGs complement analytic pivoting by using salient features to develop an overall characterization of a potential threat actor. This process also makes it\npossible to establish targeted, robust network defenses.\n\nOur study does not attempt to provide threat attribution, merely the characterization of observable\nactivities relevant to ICS network defense. Additionally, we lack corroborating sources that tie the\ntechnical indicators within the PCAP data to specific individuals or organizations. While some inference might be possible in the creation of AGs, the events themselves are wholly lacking in adversary data. Caltagirone and colleagues observe that this lack of data is a likely situation for most\nDiamond Model analyses (Caltagirone, Pendergast and Betz 2013).\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 7\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## 4 Methodology\n\n### 4.1 Variables Used\n\nTable 1 contains a list of variables used in this study and their descriptions.\n\n_Table 1: Diamond Model Variables_\n\n**Variable** **Description**\n\nAdv Adversary: the suspected threat actor involved in an Event\n\nAGC Activity Group Creation function\n\nAGS Set of all activity groups in the event space\n\nCx Confidence level for feature x, used as a weighting factor\n\nCap Capability: the tools, techniques, and procedures used by the Adversary\n\nE An Event: a vector defined by Adversary, Capability, Infrastructure, and Victim\n\nET Set of all events and event threads in the data\n\nFVPR Feature vector that satisfies the analytic problem (PR)\n\nInf Infrastructure: the virtual and physical resources used to support the Adversary\n\nPR Analytic problem\n\nVic Victim: the organization or individual targeted by an Adversary during an Event\n\n### 4.2 Partitioning and Identification of ICS Honeynet Data\n\n**4.2.1** **Characterizing Network Traffic Using SiLK**\n\nDue to the large number of unique external hosts identified in the data set (nearly 67,000), it was\nessential to partition the data set in a way that prioritized the data most likely to yield useful\nevents. Initially, the most straightforward way to accomplish this was to eliminate hosts that did\nnot exchange significant traffic with the honeynet. Note that this did not entirely exclude these\nhosts from the data set. Initial exclusion of external hosts that generated 10 or fewer flow records\nreduced the set under consideration by over 90%.\n\nTo further reduce the data set, we examined the most frequently contacted hosts. We used\nWHOIS data to identify the top 10 external hosts that contacted the honeynet, including the\nGoogle Public Domain Name System (DNS) service and various Microsoft update servers. While\nsource IP addresses can be spoofed, a cursory examination of payload data showed that the traffic\nfrom these hosts appears to be legitimate.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 8\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n|Variable|Description|\n|---|---|\n|Adv|Adversary: the suspected threat actor involved in an Event|\n|AGC|Activity Group Creation function|\n|AGS|Set of all activity groups in the event space|\n|C x|Confidence level for feature x, used as a weighting factor|\n|Cap|Capability: the tools, techniques, and procedures used by the Adversary|\n|E|An Event: a vector defined by Adversary, Capability, Infrastructure, and Victim|\n|ET|Set of all events and event threads in the data|\n|FV PR|Feature vector that satisfies the analytic problem (PR)|\n|Inf|Infrastructure: the virtual and physical resources used to support the Adversary|\n|PR|Analytic problem|\n|Vic|Victim: the organization or individual targeted by an Adversary during an Event|\n\n\n-----\n\n**4.2.2** **Examination of HTTP POST Data**\n\nIn addition to conducting high-level characterization of network traffic using SiLK, we inspected\nthe payload data of traffic that we believed would be likely to yield useful information. One such\ncategory was Hypertext Transfer Protocol (HTTP) POST requests originating from the honeypot\nmachines. We focused our analysis on these requests because they are frequently used in malware\nC2 traffic. Pinpointing such traffic in a normal PCAP would be difficult because malicious POST\nrequests would be interspersed with legitimate POST requests. Due to the nature of this honeynet,\nhowever, considerably fewer POST requests were observed. Thus, we could inspect the payloads\nof these requests as generated by YAF and super_mediator to determine whether they contained\nevidence of C2 traffic or other malicious activity on the network.\n\n**4.2.3** **Examination of Traffic on Common ICS Ports**\n\nCommon ICS ports used by major vendors were also important locations for examining traffic.\nAfter conducting open source research to generate a list of common ICS ports, we used SiLK to\nrapidly discover which of these ports were frequently contacted by external hosts. We then used\nsuper_mediator to obtain payload data (where relevant) and inspect this data for signs of malicious activity.\n\n**4.2.4** **Diamond Model Event Definition**\n\nTo use the Diamond Model correctly, it is necessary to define the specific features that characterize the four components of an event. As described above, an event comprises four elements—adversary, capability, infrastructure, and victim—each paired with a corresponding confidence level.\n\n�= 〈〈���, ��〉, 〈���, ��〉, 〈���, ��〉, 〈���, ��〉〉\n\nBeyond the fundamental definition of an event provided by Caltagirone and colleagues, we are\nfree to select the data tuples that are pertinent to our analysis. We define the event features as follows. Looking first at the adversary, this feature is a null set in the context of this study.\n\n〈���, ����〉= 〈∅〉\n\nOur definition of capabilities provides an opportunity to define certain features that highlight the\nextensibility of the Diamond Model and, in turn, its usefulness as a tool for defending specialized\nnetworks. We define capability by port scanning use, exploit use, malware use, C2 use, and ICS\nawareness.\n\n〈���, ����〉\n= 〈〈��������, ���������〉, 〈�������, ��������〉,〈�������, ��������〉,〈�2, ���〉, 〈���, ����〉〉\n\nThe first four features of the capability tuple apply to many cyber threats, not just those targeting\nICS. Capabilities used against ICS networks overlap significantly with those used against traditional networks. As Assante and Lee observe, ICS attack chains tend to follow a dual-staged approach, the first of which essentially mirrors an attack on a traditional corporate network (Assante\nand Lee 2015). For this reason, we also include an ICS feature that shows an adversary’s apparent\nability to differentiate ICS networks. We can assess this ability by examining an indicator such as\nconsiderable scanning of ICS-specific ports or the use of exploits that target a control system.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 9\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\nMoving to infrastructure, we include features that account for the resources used by typical threat\nactors, including those with advanced capabilities. These resources include IP address, source\nport, operating system, domain or host name, hosting type, and proxy use.\n\n〈���, ����〉\n= 〈〈��, ���〉, 〈����, �����〉, 〈��, ���〉,〈������, �������〉,〈��������, ���������〉, 〈�����, ������〉〉\n\nThese details describe the fundamental attributes of resources used by an adversary. In some analyses, infrastructure can also include physical assets used by the attacker. This would certainly be\nrelevant to analysis of ICS threats. For instance, an advanced attacker who manages to infiltrate\nthe premises of an organization could install compromised ICS hardware or software. However,\nthis is likely not pertinent to the examination of honeynet traffic. While most of the features defining Infrastructure are relatively straightforward, hosting type is worth describing further. Hosting\ntype draws upon the observation by Caltagirone and colleagues that there are two principal types\nof infrastructure: Type 1 “is fully controlled or owned by the adversary” while a third party provides Type 2 infrastructure (whether legitimately acquired or compromised by the adversary).\n\nUnlike the adversary, we hold a significant amount of data on the victim. All targeted infrastructure is well defined and has a single operator. A honeynet again lends itself well to analysis with\nthe Diamond Model because it provides a set of known constants that facilitate further exploration. For the purposes of this analysis, we describe the victim in terms of organization, target IP\naddress, target port, and target system.\n\n〈���, ����〉\n= 〈〈���, ����〉, 〈��������, ���������〉,〈����������, �����������〉, 〈������, �������〉〉\n\nThese details are again standard descriptors of an organization targeted by threat actors. The first\nfeature (Org) is constant because all targeted hosts appear within a honeynet operated by a single\n(undisclosed) organization.The other three features (Target IP, Target Port, and System) are relatively easy to obtain from the PCAP data.\n\n### 4.3 Analytic Pivoting\n\nAfter we define event tuples for our application of the Diamond Model, we then extract useful\nevent data and attempt to find related features through analytic pivoting. The ultimate goal of the\nanalytic pivoting is to create AGs for threat prioritization. Although an analyst is generally free to\ndefine event tuples, it can be difficult to determine which events might be associated with one another. To simplify these efforts, we chose two primary methods of identifying actionable event\ndata. The host-centered approach starts with a known host (or set of hosts) believed to have a correlation and seeks an association in Layer 3 data such as IP address and hostname. The port-centered approach centers on Layer 4 data (primarily groups of targeted TCP and UDP port numbers)\nto understand the goal of certain surveillance and exploitation activities. Examples of both techniques are provided in Section 5.2.\n\n**4.3.1** **Host-Centered Approach**\n\nThe host-centered approach to analytic pivoting focuses on finding relationships among external\nhosts by examining traffic patterns or characteristics. It potentially yields considerable data, particularly in terms of capability and infrastructure. The host-centered approach generally requires\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 10\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\npayload data to be effective because it relies on relationships among transmitted and received\ndata. Despite this, it is one of the more effective approaches to analytic pivoting. It helps to categorize hosts by their activities and provides higher-confidence associations between hosts than relating them by common infrastructure (which numerous actors, malicious and otherwise, may\nshare). The Diamond Model allows us to use these features synergistically to uncover additional\nthreat actors.\n\n**4.3.2** **Port-Centered Approach**\n\nWhen we lack sufficient information to conduct host-centered analytic pivoting, we can use relationships among ports as a starting point. This is particularly useful for an ICS network, which\nfrequently contains devices that communicate on specialized ports rarely used by other services.\nAccordingly, the port-centered approach can help us to understand adversaries’ capabilities, particularly their levels of ICS awareness.\n\n### 4.4 Grouping Potential Threat Actors\n\nThe fundamental goal of our research is to define a number of AGs that reflect the particular\nthreat that various actors in the data set could pose to the target organization. Notably, we do not\ndefine the study’s AGs in an attributive manner. In other words, a single AG might contain a\nnumber of distinct actors related by the type of threat they represent instead of their shared control, infrastructure, or techniques.\n\n**4.4.1** **Defining the Activity Group Creation Function**\n\nCaltagirone and colleagues define the activity group creation (AGC) function in terms of three independent variables: an analytic problem, a feature vector that aligns with the analytic problem\nunder consideration, and the set of events that constitute the various AGs. This combination yields\na set of all AGs. In notation, the Diamond Model defines this set as follows (Caltagirone,\nPendergast and Betz 2013).\n\n������, ����, ���→���\n���= ����, ���, …, ����\n\nAs discussed previously, this study seeks to solve the analytic problem of grouping actors based\non their potential to have an adverse impact on the ICS network. One of the most important features in this context is ICS awareness. An actor whose actions demonstrate a focus on ICS gives it\nan elevated threat potential relative to one engaged in similar activities with no apparent interest\nin these systems. Beyond this, another feature in the Capability vector that helps to determine\nAGs is the presence of one or more of C2, malware, exploit attempts, or port scanning. This group\nof features helps to sort the events by severity because they correspond, in descending order, to\nsteps in a network attack chain. This means that an actor with established C2 inherently represents\na higher threat than one merely engaged in port scanning.\n\nWhile these two clusters of features from the Capability attribute provide a clear description of\nthreat potential, we can further clarify the potential threat through certain Infrastructure characteristics. IP address and domain are particularly relevant here because they correspond to infrastructure used by known (or suspected) threat actors. This information is helpful in characterizing actors within this data set.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 11\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\nUsing notation again, we define the feature vector for this analytic problem as follows.\n\n���� = 〈���, ��2 ∨�������∨�������∨���������,��, ������〉\n\nWe define the final component of the function, ET, as the entire set of honeynet data under consideration. Note that the AGC function is not required to place every event into an AG. These ungrouped events are considered to be outliers. Most of the events in this data set fall within this category, as the vast majority of external hosts send just a few packets to the honeynet machines with\nno apparent relation to other actors. This lack of data makes it difficult to categorize these hosts in\nany meaningful way.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 12\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## 5 Results\n\n### 5.1 Honeynet Configuration\n\nWe did not possess configuration details for the honeynet. Instead, we inferred its configuration\nfrom the PCAP data. There are 10 observable hosts within the honeynet. Each has an anonymized\nIP address within the 0.0.0.0/24 range. It is not clear in all instances which operating system each\nhoneypot machine is running. To investigate this further, we inspected traffic originating from the\nhoneypot hosts for banners and other artifacts that could offer a perspective on these details. Ultimately, it constitutes an integral part of our understanding of the victim in the context of the Diamond Model.\n\nAdditionally, it is worth noting the apparent behavior of these hosts with respect to network interactions. While it is unclear from the data how the hosts on the honeynet communicated with the\nwider Internet, it appears that most packets received went unanswered. For instance, most SYN\npackets observed in the apparent port scanning activities received neither an acknowledge (ACK)\npacket nor a reset (RST) in response, as might ordinarily be expected. We collected comparatively\nricher data from UDP traffic, as the connectionless nature of this protocol meant that a successful\nhandshake was not required to see the majority of traffic exchanged. The honeynet generally did\nnot respond to any datagrams it received, potentially precluding further data transfer.\n\nIt is clear from inspecting the traffic that a number of honeynet hosts are running Microsoft Windows. The various external hosts with which they communicate corroborate this assumption. This\nincludes known Windows update servers as well as the Teredo service (which is usually enabled\nby default in Windows Vista and newer, but is less common on other operating systems). Several\nhosts generate traffic of this type, asserting with high confidence that they are running a similar\nversion of Windows. One host additionally appears to be acting as a server, as it sends HTTP Status Code 200 OK responses to some external hosts reaching it on port 80. This machine’s network\ntraffic header shows that it is running Microsoft Internet Information Services (IIS) Version 7.5.\nThe version of Microsoft IIS aligns with either Windows Server 2008 R2 or a Windows 7 host\nacting as a server. Both Microsoft operating system versions support this version of IIS by default.\n\nHost 0.0.0.20 was the only other server that generated sufficient traffic to infer its configuration\nand did not appear to be Windows-based. This host made requests to servers that provide signature data for the Bro network security monitoring system, which is available only on Unix-like\noperating systems. Other traffic generated by this host, such as Online Certificate Status Protocol\n(OCSP) and Network Time Protocol (NTP), differed from requests made by the Windows hosts.\nThese protocols are implemented on a number of different platforms, however, making the mere\npresence of this traffic inconclusive as evidence of the host’s configuration.\n\nThe five remaining hosts did not generate sufficient traffic to determine their configuration from a\nPCAP file. While a few of these hosts do respond to traffic received from the external network,\nthe traffic observed consists primarily of ICMP echo responses. ICMP echo responses reveal little\nabout a given host’s underlying operating system or software.\n\nA summary of hosts and their relevant configuration details is shown in Table 2.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 13\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n_Table 2: Honeynet Host Configuration_\n\n**Host** **Suspected OS / Configuration**\n\n0.0.0.2 Microsoft Windows Server 2008 R2 / Windows 7 (Microsoft IIS 7.5)\n\n0.0.0.3 Unknown\n\n0.0.0.4 Unknown\n\n0.0.0.5 Microsoft Windows (Vista or later)\n\n0.0.0.6 Unknown\n\n0.0.0.7 Unknown\n\n0.0.0.8 Unknown\n\n0.0.0.9 Microsoft Windows (Vista or later)\n\n0.0.0.20 Linux\n\n0.0.0.21 Microsoft Windows (Vista or later)\n\n### 5.2 Characterization of Threat Actors Through Analytic Pivoting\n\nAs discussed earlier, we incorporated analytic pivoting in our analysis as a way to correlate various items of event data that might not appear related upon initial examination. This facilitated the\ncreation of AGs by providing higher quality data used in determining feature vectors.\n\n**5.2.1** **Host-Centered Approach**\n\nAn example of the host-centered approach to analytic pivoting used in this study was in the characterization of traffic believed to be associated with malware C2. This was initially discovered in\nan examination of all HTTP POST requests captured. We isolated this data using a shell script\nthat automatically extracted 100 bytes of application-layer data from all POST requests on ports\n80 and 8080 with YAF and super_mediator. (See the 0 for full queries.)\n\nA POST request with a long, encoded URI and an unfamiliar hostname in the HTTP Host header\nsuggested that this might be malicious traffic worth investigating. Searching the domain on VirusTotal revealed its possible connection to the infrastructure of an intrusion campaign reported\nby Palo Alto Networks under the codename “Bookworm” (Scott, Falcone and Cortes 2015). It is\nunclear whether this traffic corresponds to the same actor, as groups tend to abandon infrastructure upon publication of their activities. Nevertheless, it provides a starting point for the host-centered approach to analytic pivoting.\n\nBased on this information, we constructed further queries to investigate the activity present in the\nPCAP and discover more about the potential adversary. Using the list of IP addresses that Palo\nAlto Networks provided in their reports, we prepared a set file for use with SiLK’s rwfilter\ntool (Scott, Falcone and Cortes 2015). We then conducted a search of this set for additional suspicious hosts, which are listed in Table 3.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 14\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n|Host|Suspected OS / Configuration|\n|---|---|\n|0.0.0.2|Microsoft Windows Server 2008 R2 / Windows 7 (Microsoft IIS 7.5)|\n|0.0.0.3|Unknown|\n|0.0.0.4|Unknown|\n|0.0.0.5|Microsoft Windows (Vista or later)|\n|0.0.0.6|Unknown|\n|0.0.0.7|Unknown|\n|0.0.0.8|Unknown|\n|0.0.0.9|Microsoft Windows (Vista or later)|\n|0.0.0.20|Linux|\n|0.0.0.21|Microsoft Windows (Vista or later)|\n\n\n-----\n\n_Table 3: 'Bookworm' Hosts Observed in PCAP Data_\n\n**Source IP Address** **SiLK Flow Records** **% of Records** **Cumulative %**\n\n87.106.149.145 58 84.06 84.06\n\n87.106.20.192 9 13.04 97.10\n\n213.165.83.176 2 2.90 100.00\n\nIt became clear that three hosts in the PCAP data might potentially be involved with this suspicious traffic. A brief examination of payload data using YAF and super_mediator helped to confirm this. (See the 0 for full queries.) This traffic reveals that another host is communicating with\nthe potentially malicious server via Secure Sockets Layer/Transport Layer Security (SSL/TLS)encrypted communications in addition to encoded C2. Additionally, querying public WHOIS data\non the IP addresses shows that virtual hosting companies own them, providing details on this actor’s infrastructure.\n\nIn sum, the host-centered approach made it possible to engage in analytic pivoting that started\nonly with low-confidence data on the use of malware and C2 (elements of capability) and a single\nexternal host (infrastructure). It revealed two additional hosts along with further information on\nthe adversary’s capabilities, including the use of encryption.\n\n**5.2.2** **Port-Centered Approach**\n\nWe used SiLK to identify external hosts (that is, hosts that are not part of the honeynet) that might\nbe attempting surveillance or exploitation of ICS devices and traffic to common ICS ports. The\nprocess began by looking at the top external hosts communicating with port 20000, summarized\nin Table 4. This port is used principally for DNP, a common protocol used within SCADA networks. The following SiLK query revealed a number of hosts that were engaged in communication with this port, primarily in activity that appeared to be connected to scanning.\n\n_Table 4: Top Hosts Communicating on Port 20000_\n\n**Source IP Address** **SiLK Flow Records** **% of Records** **Cumulative %**\n\n66.240.192.138 12 3.592814 3.592814\n\n71.6.135.131 12 3.592814 7.185629\n\n80.82.70.198 12 3.592814 10.77844\n\n62.75.207.109 12 3.592814 14.37126\n\n71.6.165.200 12 3.592814 17.96407\n\n8.8.8.8 10 2.994012 20.95808\n\n198.20.69.98 9 2.694611 23.6527\n\n41.74.182.170 9 2.694611 26.34731\n\n94.102.49.210 8 2.39521 28.74252\n\n60.209.5.30 8 2.39521 31.13773\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 15\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n|Source IP Address|SiLK Flow Records|% of Records|Cumulative %|\n|---|---|---|---|\n|87.106.149.145|58|84.06|84.06|\n|87.106.20.192|9|13.04|97.10|\n|213.165.83.176|2|2.90|100.00|\n\n|Source IP Address|SiLK Flow Records|% of Records|Cumulative %|\n|---|---|---|---|\n|66.240.192.138|12|3.592814|3.592814|\n|71.6.135.131|12|3.592814|7.185629|\n|80.82.70.198|12|3.592814|10.77844|\n|62.75.207.109|12|3.592814|14.37126|\n|71.6.165.200|12|3.592814|17.96407|\n|8.8.8.8|10|2.994012|20.95808|\n|198.20.69.98|9|2.694611|23.6527|\n|41.74.182.170|9|2.694611|26.34731|\n|94.102.49.210|8|2.39521|28.74252|\n|60.209.5.30|8|2.39521|31.13773|\n\n\n-----\n\nPCAP data from the hosts in Table 4 may not be particularly useful on its own, as it does not include payload data or even information on TCP flags. By using the port-centered approach, we\nmay query other common ICS ports to begin building a more complete picture of reconnaissance\nactivity taking place against the honeynet. The second SiLK query examined traffic on port 102.\nA major brand of programmable logic controllers (PLC) commonly uses this port for control communications. We cross-referenced this output with the hosts communicating with port 20000.\nHosts that were present in Table 4 appear with an asterisk next to their IP address in Table 5.\n\n_Table 5: Top Hosts Communicating on Port 102_\n\n**Source IP Address** **SiLK Flow Records** **% of Records** **Cumulative %**\n\n188.138.1.218 32 6.299213 6.299213\n\n80.82.70.198* 30 5.905512 12.20472\n\n125.97.246.5 27 5.314961 17.51969\n\n52.88.94.127 19 3.740157 21.25984\n\n198.20.69.98* 16 3.149606 24.40945\n\n94.102.49.210* 14 2.755906 27.16535\n\n120.119.31.1 14 2.755906 29.92126\n\n71.6.135.131* 13 2.559055 32.48032\n\n131.107.13.100 13 2.559055 35.03937\n\n66.240.192.138* 13 2.559055 37.59843\n\nAgain, this analysis approach helps us to prioritize hosts that might have a high ICS awareness—\nand accordingly, a higher potential threat level. The top ports contacted by the first denoted host,\n80.82.70.198, were enumerated in SiLK. (See the 0 for full details.) A number of these ports had\nICS functions, including nearly all of the ports listed in Table 6, which describes the known ICSrelated ports contacted by external hosts.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 16\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n|Source IP Address|SiLK Flow Records|% of Records|Cumulative %|\n|---|---|---|---|\n|188.138.1.218|32|6.299213|6.299213|\n|80.82.70.198*|30|5.905512|12.20472|\n|125.97.246.5|27|5.314961|17.51969|\n|52.88.94.127|19|3.740157|21.25984|\n|198.20.69.98*|16|3.149606|24.40945|\n|94.102.49.210*|14|2.755906|27.16535|\n|120.119.31.1|14|2.755906|29.92126|\n|71.6.135.131*|13|2.559055|32.48032|\n|131.107.13.100|13|2.559055|35.03937|\n|66.240.192.138*|13|2.559055|37.59843|\n\n\n-----\n\n_Table 6: Common ICS-Related Ports Observed in Data Set_\n\n**TCP Port** **Device or Protocol**\n\n102 Siemens PLC\n\n502 Modbus protocol\n\n1962 Phoenix Contact ILC PLC/ProConOS\n\n2404 IEC 60870-5-104\n\n2455 Wago I/O System\n\n4592 Advantech/Broadwin\n\n4840 Certec Atvise SCADA\n\n9600 Omron PLC\n\n10001 RS-485 to Ethernet\n\n18245 GE PLC\n\n20000 DNP (SCADA/ICS common protocol)\n\n20547 ProConOS/MultiProg PLC\n\n44818 Rockwell Automation Ethernet/IP\n\n49320 Kepware KEPServerEX\n\nThe host 80.82.70.198 contacted just 19 ports, far fewer than would be targeted by a generic Network Mapper (Nmap) tool scan, which typically scans up to 1,000 ports. Examining the traffic\npayload with YAF and super_mediator also showed that these were merely TCP Synchronize\n(SYN) packets with no further traffic, a technique frequently associated with port scanning activity. Over 70% of the ports scanned have a known association with ICS, and the others may relate\nto less well-known or documented ICS protocols.\n\nExternal host 80.82.70.198 exclusively focused on these ports, revealing a high degree of ICS\nawareness that helps to characterize the actor’s capability. However, this particular host does not\nappear to be malicious. It is part of a China-based project, “ICS/SCADA/PLC Protocol Global\nCensus,” that is conducting scans on common ICS ports (Unknown 2016). The project has produced research on ICS devices, including some of those associated with ports listed in Table 6. It\nallows organizations to opt out of scanning by emailing the research team.\n\nThis case study shows the benefits of the port-centered approach. By using known associations\namong ports, analytic pivoting revealed a potential emerging threat to the ICS network. An analyst could extend and automate this technique to simplify gathering intelligence about ICS threats.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 17\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n|TCP Port|Device or Protocol|\n|---|---|\n|102|Siemens PLC|\n|502|Modbus protocol|\n|1962|Phoenix Contact ILC PLC/ProConOS|\n|2404|IEC 60870-5-104|\n|2455|Wago I/O System|\n|4592|Advantech/Broadwin|\n|4840|Certec Atvise SCADA|\n|9600|Omron PLC|\n|10001|RS-485 to Ethernet|\n|18245|GE PLC|\n|20000|DNP (SCADA/ICS common protocol)|\n|20547|ProConOS/MultiProg PLC|\n|44818|Rockwell Automation Ethernet/IP|\n|49320|Kepware KEPServerEX|\n\n\n-----\n\n### 5.3 Using Honeynet Data to Group Actors\n\nNow that we have enumerated the overall feature space and the feature vector used in our AGC,\nwe can provide relevant groupings of threat actors. This provides the rapid, actionable characterization of actors in the PCAP data in a manner that satisfies the analytic problem. The overall process aligns with the goal of this study in developing a sound methodology for categorizing threats\nto an ICS network based on the Diamond Model.\n\n**5.3.1** **Active Threat Actors**\n\nWe define active threat actors as entities whose actions provide a high-confidence indication that\nthey are actively in the process of attacking the network. This is unrelated to a focus on ICS,\nthough an active, ICS-focused attack represents the most serious type of event within this AG. To\nfall within this category, an adversary must have demonstrated the delivery of malware or the establishment of C2 communications.\n\nOne example of an active threat actor identified in the data is the adversary shown in Table 7\n(which was discussed previously). It is suspected of having established C2 with two hosts on the\nhoneynet (20% of all hosts). It is unclear which objectives are held by this actor: some of this C2\ntraffic is encrypted and no host-based artifacts are available. Nevertheless, the presence of this\ntraffic indicates with high confidence a compromise of the network.\n\nWhile this is the most useful group for generating actionable threat data, it is paradoxically the\nAG for which we have the fewest events. One possible explanation is a general lack of interaction\nfrom the honeypot machines. As mentioned in Section 5.1, the honeynet did not exhibit a great\ndeal of interaction with external hosts. It also did not accept TCP incoming connection requests\non any port. Given this situation, if it appeared to an attacker that few or no ports were listening\nfor connections, it would logically follow that few exploit attempts ensued. It would appear to the\nattacker that no service is listening for connections on this port or that a firewall is in place.\n\n_Table 7: Selected Active Threat Actors_\n\n**Actor ID** **Attributes** **Reason for grouping** **Event Timeline**\n\nIP {87.106.149.145, 87.106.20.192, High confidence indication 12/16/2015 19:41 213.165.83.176}; Port {80, 443}; Domain of malware C2 traffic 12/16/2015 20:08\n\nAT1\n\n{bkmail[.]blogdns[.]org} Malware; C2;\nProxy; Type 2 Infrastructure\n\n**5.3.2** **High-Risk Actors**\n\nWe may consider high-risk actors in the context of their demonstrated or suspected capability to\nhave an adverse impact on an ICS network. This could be due to active but unsuccessful attempts\nat exploitation that demonstrate either an interest in ICS or some familiarity with the victim’s network. An actor that appears to be sending traffic associated with common exploits en masse is not\nnecessarily a high-risk actor. Numerous botnets and other malicious hosts engage in constant attempts to compromise unpatched hosts. This should not represent a high level of risk for an organization with appropriate baseline security measures in place.\n\nReconnaissance can also represent a high level of risk. The activities of the host in Table 8 would\nplace it within the high-risk category. This host (80.82.70.198) was identified as collecting data\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 18\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n|Actor ID|Attributes|Reason for grouping|Event Timeline|\n|---|---|---|---|\n|AT1|IP {87.106.149.145, 87.106.20.192, 213.165.83.176}; Port {80, 443}; Domain {bkmail[.]blogdns[.]org} Malware; C2; Proxy; Type 2 Infrastructure|High confidence indication of malware C2 traffic|12/16/2015 19:41 - 12/16/2015 20:08|\n\n\n-----\n\nfor the “ICS Census” noted in Section 5.2.2. While this particular host appears to be connected\nwith research activities, incident responders should prioritize hosts such as this for further review\nand triage. This type of network activity could represent an early stage of an actual attack. If such\ntargeted port scanning is indeed malicious, it provides incident responders with valuable intelligence on the adversary’s capabilities and interests.\n\n_Table 8: Selected High-Risk Actors_\n\n**Actor ID** **Attributes** **Reason for grouping** **Event Timeline**\n\nIP {80.82.70.198}; Port {[19 common ICS Focused scanning of known 7/8/2015 05:19 HT1 ports]}; Domain ICS ports without clear mali- 2/17/2016 16:49\n{icsresearch[.]plcscan[.]org}; ICS; Port scan cious objective\n\n**5.3.3** **Moderate-Risk Actors**\n\nModerate-risk actors constitute the AG with the lowest level of risk that retains the potential to\nhave an impact on the network. These actors have not actively attempted to exploit hosts on the\nnetwork, but instead are engaged in reconnaissance activity. Due to the proliferation of scanning\nactivity undertaken by many parties for many purposes, a number of hosts and other groups fall\nwithin the moderate risk category.\n\nA group of moderate-risk actors is a large section of the hosts that appear to be heavily engaged in\nport scanning activity. As they all tend to originate scanning activity from port 6000, we can link\nthem through the port-centered approach. Subnet and ASN also link these actors on a host-centered basis. All of the hosts in these groups originate within address space associated with China.\nThis does not attribute those hosts as being Chinese in origin, as their immediate origins could\neasily be proxies or virtual hosts. This association shows that a considerable amount of traffic\nshares a common affiliation in terms of infrastructure and capabilities.\n\nThe remaining high-risk actors are engaged in automated attempts to exploit well-known vulnerabilities. We assigned only a moderate level of risk to these actors because we believe they do not\nrepresent a significant threat to the vast majority of enterprises. Patches are widely available to\nremediate all of these vulnerabilities, and most security solutions can detect and block these attempts at the network perimeter. It is still worth considering these three actors (MT2, MT3, and\nMT4 in Table 10) briefly to understand the characteristics of their activities.\n\nMT2 is perhaps the most interesting of the three AGs in this set that make exploit attempts. The\nhosts in this group generate two distinct types of traffic. The first is the apparent exploitation\npayload, an HTTP GET request (see Table 9 for full request). Open source research has not\nindicated the nature of this traffic. Some security blogs and forums have speculated that it is an\nattempt to scan or attack Apache servers, although it is unclear whether it is an effective exploit.\nWe observed the host 185.130.5.224 transmitting these packets. This activity did not appear to\nhave an impact on the server, possibly because it was running Microsoft IIS rather than Apache.\n\nAnother category of traffic generated by this host (and others associated through host-centered\nanalytic pivoting) initially resembled an attempt at exploiting the “Shellshock” vulnerability\n(CVE-2014-6271, etc.). However, it appears that this exploit string (see Table 9) might actually\nindicate an attempt by malware to compromise the device. Variations on the following string,\nwhich appeared to be a Linux command, appeared several times in the PCAP. While a packet\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 19\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n|Actor ID|Attributes|Reason for grouping|Event Timeline|\n|---|---|---|---|\n|HT1|IP {80.82.70.198}; Port {[19 common ICS ports]}; Domain {icsresearch[.]plcscan[.]org}; ICS; Port scan|Focused scanning of known ICS ports without clear mali- cious objective|7/8/2015 05:19 - 2/17/2016 16:49|\n\n\n-----\n\npayload such as this one resembles a Shellshock exploitation string, it was distinct because it\ntargeted UDP port 53413 rather than TCP ports 80 or 8080 (the ports most commonly targeted by\nWeb-based Shellshock attacks). UDP 53413 is not associated with any established service.\nHowever, it was tied to a vulnerability in Netcore/Netis brand routers disclosed in 2014 that can\nallow remote shell access to the device through this port (Yeh 2014).\n\n_Table 9: MT2 Exploit Attempts Observed_\n\n**Description** **Exploit String**\n\nUnknown exploit string GET /serverpossibly targeting Apache status?HTTP_POST=%”%6346#%#/&#736%”#423|;&HTTP_CGI\nservers _GET=GRESYYK”K&J#L523D2G23H23 HTTP/1.1\n\nLikely Netis/Netcore exploit busybox tftp –g –r m.sh 185.130.5.201|| tftp –g –r\nstring found in m.sh 185.130.5.201; busybox chmod +x m.sh\nGafgyt/Bashlite malware\n(other variations observed)\n\nWith this router vulnerability in mind, we discovered this string in a publicly available analysis of\na malware sample affiliated with a family of malware known as “Bashlite” or “Gafgyt”\n(VirusTotal 2016). Researchers at Avast associated this malware with distributed denial-ofservice (DDoS) attacks initiated by the Lizard Squad threat actor (Kalnai and Horejsi 2015). This\nresearch as well as analysis by security journalist Brian Krebs reveals that the group developed\nmalware that spreads by exploiting known vulnerabilities in home routers (Krebs 2015). It creates\na botnet from these devices that is then used to run an illicit online service that performs DDoS\nattacks for hire (Kalnai and Horejsi 2015). Based on an open source list of IOCs for this malware\nfamily (Malwr Posts 2015), we searched the CERT/Coordination Center (CERT/CC) Artifact\nCatalog for matching samples; nine were found. We encountered a Busybox command in eight of\nthe samples and a nearly identical string to the one found in the PCAP in four samples, offering an\nincrease in confidence that the traffic observed relates to Bashlite or Gafgyt.\n\nTwo other threat actors in this set are engaged in attempts to exploit known vulnerabilities in popular technologies. The first actor, MT3, sends traffic characteristic of an attempt to exploit CVE2013-5122. This is a vulnerability in the remote management interface of Linksys routers that facilitated the spread of a worm known as “TheMoon.” Identifying this traffic as an attempt to exploit the Linksys vulnerability was a straightforward process. The traffic payload contains HTTP\nPOST requests for the page tmUnblock.cgi, which is closely correlated with this exploit. Finally, AG MT4 contained hosts attempting to exploit several related vulnerabilities in older versions of PHP that allow for arbitrary code execution. Again, the exploit strings contained HTTP\nPOST requests that were characteristic of attempts to exploit the vulnerability.\n\nIn the context of honeynet operation, it may be advisable to identify hosts such as these for further\ninvestigation. If they are deemed merely to be part of routine scanning of the network that is unlikely to pose a further threat, implementing firewall rules that block these hosts would improve\nthe signal-to-noise ratio within the data set. However, this should take place only if the analyst understands how removing these hosts from consideration affects the data set.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 20\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n|Description|Exploit String|\n|---|---|\n|Unknown exploit string possibly targeting Apache servers|GET /server- status?HTTP_POST=%”%6346#%#/&#736%”#423|;&HTTP_CGI _GET=GRESYYK”K&J#L523D2G23H23 HTTP/1.1|\n|Likely Netis/Netcore exploit string found in Gafgyt/Bashlite malware (other variations observed)|busybox tftp –g –r m.sh 185.130.5.201|| tftp –g –r m.sh 185.130.5.201; busybox chmod +x m.sh|\n\n\n-----\n\n_Table 10: Selected Moderate-Risk Actors_\n\n**Actor ID** **Attributes** **Reason for grouping** **Event Timeline**\n\nIP {[Numerous China-based IP ad- Extensive scanning of com- 7/8/2015 05:19 –\ndresses]}; Port {TCP 6000 (source), [Nu- mon TCP ports 2/17/2016 16:49\n\nMT1\n\nmerous common destination ports]}; Port\nscan\n\nIP {185.130.5.224, 185.130.5.201, Automated scanning / ex- 12/23/2015 23:07\n46.28.207.30}; Port {TCP 80, UDP 53413}; ploitation attempt targeting – 2/22/2016 05:34\nExploit; Malware Apache Web servers; possi\nMT2\n\nble attempted exploitation of\n‘Shellshock’ vulnerability\n(CVE-2014-6271 etc.)\n\nIP {69.164.231.228, 77.70.58.205}; Port Automated attempts to ex- 11/22/2015 17:13\n{80}; Port scan; Exploit ploit TheMoon vulnerability – 12/18/2015\n\nMT3\n\n(CVE-2013-5122) in Linksys 19:07\ndevices\n\nIP {117.21.226.160, 119.235.66.243}; Port Automated attempts to ex- 7/9/2015 03:01 –\n{TCP 23, 80, 8081}; Port scan; Exploit ploit CVE-2012-1823/CVE- 10/3/2015 12:28\n\nMT4\n\n2012-2311/CVE-2012-2336\nin PHP\n\n**5.3.4** **Unknown-Risk Actors / Outliers**\n\nThe final group of events under consideration does not directly constitute an AG. Instead, it comprises the set of data that falls outside all other groups: outliers. We need to understand how to interpret the set of outliers for threat potential. Many of the events in the set of outliers are likely to\nbe non-malicious. A considerable amount of traffic observed in the PCAP data was connected to\nknown servers used for software updates, standard DNS queries, and WHOIS lookups. This traffic might correspond to malicious activities and, accordingly, we should not discard it on this basis alone. However, a review of this traffic strongly suggests that it does not represent a threat.\n\nAnother large set of events formally grouped with the set of outliers is better termed “unknown\nrisk” traffic. This data primarily falls within this category due to a lack of event data for a given\nhost, port, or application, or because it is not possible to link a specific event reliably to others\nwithin the data set. It would be unwise to treat this data as useless or classify it as certainly nonmalicious. It is important to revisit the data set in its entirety as more information becomes available. A material change in traffic observed can strongly affect the assumptions underpinning the\nAGC function. Caltagirone and colleagues recommend the periodic review of data and updating\nof the function in an effort to keep the information current and actionable (Caltagirone,\nPendergast and Betz 2013). This would certainly be a prudent recommendation for honeynet data.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 21\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n|Actor ID|Attributes|Reason for grouping|Event Timeline|\n|---|---|---|---|\n|MT1|IP {[Numerous China-based IP ad- dresses]}; Port {TCP 6000 (source), [Nu- merous common destination ports]}; Port scan|Extensive scanning of com- mon TCP ports|7/8/2015 05:19 – 2/17/2016 16:49|\n|MT2|IP {185.130.5.224, 185.130.5.201, 46.28.207.30}; Port {TCP 80, UDP 53413}; Exploit; Malware|Automated scanning / ex- ploitation attempt targeting Apache Web servers; possi- ble attempted exploitation of ‘Shellshock’ vulnerability (CVE-2014-6271 etc.)|12/23/2015 23:07 – 2/22/2016 05:34|\n|MT3|IP {69.164.231.228, 77.70.58.205}; Port {80}; Port scan; Exploit|Automated attempts to ex- ploit TheMoon vulnerability (CVE-2013-5122) in Linksys devices|11/22/2015 17:13 – 12/18/2015 19:07|\n|MT4|IP {117.21.226.160, 119.235.66.243}; Port {TCP 23, 80, 8081}; Port scan; Exploit|Automated attempts to ex- ploit CVE-2012-1823/CVE- 2012-2311/CVE-2012-2336 in PHP|7/9/2015 03:01 – 10/3/2015 12:28|\n\n\n-----\n\n## 6 Discussion\n\n### 6.1 Specific Threats to ICS\n\nThe honeynet afforded us a rich data set for consideration. The data offered an opportunity to observe a variety of different activities with over 16 GB of traffic exchanged with tens of thousands\nof external hosts. As the focus of this effort was the enumeration and characterization of threats to\nICS, it is worth discussing how these threats manifested within the data considered. Notably,\nwhile the data showed a variety of malicious traffic, few ICS-specific threats were observed. The\nvast majority of traffic was generic scanning of some of the most commonly used ports across industries, such as Telnet, Secure Shell (SSH), Virtual Network Computing (VNC), Server Message\nBlock (SMB), and other protocols. While this is relevant to ICS network defense, it does not necessarily reveal ICS-specific threats.\n\nAnalytic pivoting and AG creation unmasked potential threats to ICS. It was helpful to examine\ntraffic exchanged on common ICS ports as well as by hosts involved in ICS-focused scanning activities. While scanning activity can indicate threat potential, it ultimately reveals the adversary’s\ncapabilities to a limited extent. The PCAPs contained very little data on specific attempts to interact with ICS devices, exploit vulnerabilities, or install malware. One possible explanation is that\nan adversary would not be likely to compromise an ICS device directly from the Internet. Most\nICS attack campaigns follow the two-phased approach (Assante and Lee 2015). This leads to a\nsecond possibility: the honeynet did not attract attacks on ICS due to its configuration.\n\n### 6.2 Challenges in Configuring an ICS Honeynet\n\nGiven the lack of ICS-focused surveillance—and especially attacks—observed in the PCAP data,\nit seems plausible that the honeynet was not optimized for collecting this type of data. As mentioned above, analyzing the traffic revealed several important details, primarily that a number of\nthe hosts appeared to be standard Windows or Linux machines without an obvious ICS purpose. It\nis possible that some of the hosts with unknown configuration details were emulating ICS devices.\nHowever, there was insufficient evidence in the data set to support this view. Based on the configuration and behavior of the hosts observed in the data set, it appears that this honeynet was a\n“low-interaction” honeynet. That is, the honeypot machines provide little to no response to requests made by external hosts, and as a result, an adversary is usually unable to compromise the\nhosts. Provos and Holz observe that such a configuration is advantageous for its low resource demand as well as the decreased risk inherent in denying attackers an opportunity to compromise\neven this isolated network. However, the tradeoff made for these benefits is that low-interaction\nhoneynets generally provide sparser attack data. They are unlikely to capture evidence of zero-day\nexploits or other high-value information (Provos and Holz 2008).\n\nAlthough the evidence supports the view that this is a low-interaction honeynet, it does not intrinsically follow that it yields no actionable information about attacks on ICS. We highlighted evidence of ICS-focused network scanning and apparent malware C2, showing that a variety of useful threat data was present within the PCAP files. Nevertheless, it seems that relatively little new\ninformation on ICS defense was obtainable from the honeynet. It is possible that the low-interaction nature of the system caused scanning and enumeration tools to report that this was not an ICS\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 22\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\nnetwork. Additionally, a cursory examination of the source code of open source ICS scanning\ntools suggests that these tools expect very specific responses from a host to confirm that it is indeed the device in question. This likely inhibited further action by external actors who might otherwise attempt to compromise ICS devices.\n\n### 6.3 Implications for the Defense of ICS Networks\n\nThe configuration of this honeynet yielded a relatively small amount of useful intelligence on ICS\nthreats. An effective ICS honeynet should employ techniques to convince potential adversaries\nthat it truly hosts ICS devices. This will likely require a higher level of interaction with external\nhosts than we observed in the PCAP data. It is also likely that to be effective, an ICS honeynet\nmust faithfully emulate actual ICS devices and protocols. A passive host may collect information\non scanning and automated exploit attempts, but this does not afford a wealth of ICS-specific\nthreat intelligence. Another option is to place actual ICS devices within the honeynet, which have\narguably the greatest probability of collecting realistic attack data. Either option may yield useful\ninformation. Emulation considerably increases the complexity in configuring and maintaining the\nhoneynet, while the use of real ICS devices would likely incur substantially higher costs than either a passive or an emulated setup. However, this may reflect the difficulties inherent in using a\nhoneynet, a proven technique for determining network threats. Given this constraint, defenders\nmay wish to weigh the value of the data obtained against the cost and complexity of maintaining\nan effective ICS honeynet.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 23\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## 7 Future Work\n\nConsidering the use of honeynets in the defense of ICS and the applicability of the Diamond\nModel in generating threat intelligence from this data gives us a number of interesting directions\nfor future study. A natural question that follows this study would be whether our model can be applied to data generated from a high-interaction honeynet composed of real or emulated ICS devices. If this yielded additional information on attack patterns, exploitation techniques, and malware, we could populate the data tuples in our model with more information and higher levels of\nconfidence. This in turn could be used to create AGs that are linked by specific attack techniques,\nshared infrastructure, and other features. Another possibility for further investigation would be automating the generation of ICS threat indicators from PCAP data. This would require a larger\namount of information on tactics, techniques, and procedures used by adversaries attempting to\nattack ICS networks. It might be possible to obtain this data from the aforementioned high-interaction honeynet. Such a project would be valuable for the considerable threat intelligence it might\ngenerate.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 24\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## 8 Conclusion\n\nThis study investigated the ways in which a honeynet can generate threat intelligence for the defense of ICS networks. Using the 16 GB of PCAP data provided along with various open source\ndata, we applied the Diamond Model of Intrusion Analysis in an effort to understand and prioritize threats to a hypothetical ICS network. Sources such as WHOIS databases, VirusTotal, and reports from security vendors helped us to establish a context for understanding the significance of\nobserved traffic. With this information, we derived data tuples that adequately characterized an\nevent observed in the data and placed it within an AG that properly represents its threat.\n\nWhile we developed an approach that leverages the Diamond Model to perform threat analysis for\nan ICS honeynet, we discovered that the specialized nature of this area presents particular demands for successful data collection. Primarily, the lack of interaction with external hosts appeared to limit the potential usefulness of collected data, particularly with respect to exploitation\nand malware delivery. In future honeynet deployments, we believe it would be useful to incorporate higher levels of interaction with external hosts and high-fidelity emulation of ICS devices (if\nnot the outright placement of actual control systems on a quarantined network).\n\nIt is our hope that this study has offered both a useful approach to the analysis of data collected\nfrom an ICS honeynet as well as insights on how this data may be gathered in a way that makes it\nmost useful as a source of threat intelligence. While the difficulties inherent in proper deployment\nmay reduce the value proposition of an ICS honeynet in certain instances, organizations with a\nhigh demand for information on ICS threats may well find our techniques useful.\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 25\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## Appendix Example SiLK Queries\n\n### Investigation of “Bookworm” Traffic\n\n2015-12-16 19:42:11.461|2015-12-16 19:42:20.682|  9.221|  0.000| 6|\n0.0.0.5|59927|   12|  1402|01|00:00:00:00:00:00|\n213.165.83.176|  21|    4|   184|00|00:00:00:00:00:00|    S|   APF|\nAS|   ARS| f5cf8802|6849361c|  0|  0|000|  0| 00|   |C1\n\n-> 0000: 50 4f 53 54 20 2f 63 34 34 64 39 33 63 34 62 63 POST /c44d93c4bc\n\n-> 0010: 38 30 31 66 61 32 64 63 63 64 30 37 36 31 39 64 801fa2dccd07619d\n\n-> 0020: 61 33 33 66 38 39 61 35 31 65 39 36 65 63 32 35 a33f89a51e96ec25\n\n-> 0030: 20 48 54 54 50 2f 31 2e 31 0d 0a 48 6f 73 74 3a HTTP/1.1..Host:\n\n-> 0040: 20 62 6b 6d 61 69 6c 2e 62 6c 6f 67 64 6e 73 2e bkmail.blogdns.\n\n-> 0050: 63 6f 6d 0d 0a 43 6f 6e 6e 65 63 74 69 6f 6e 3a com..Connection:\n\n-> 0060: 20 4b 65 65\n\nrwfilter *.rw --dipset=setfiles/honeynet.set --sipset=setfiles/bookworm_susp.set -proto=0- --pass=stdout | rwstats --fields=sip --count=10\n\nINPUT: 69 Records for 3 Bins and 69 Total Records\n\nOUTPUT: Top 10 Bins by Records\n\nsIP|  Records| %Records|  cumul_%|\n\n87.106.149.145|    58| 84.057971| 84.057971|\n\n87.106.20.192|     9| 13.043478| 97.101449|\n\n213.165.83.176|     2| 2.898551|100.000000|\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 26\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n### Investigation of ICS-Scanning Hosts\n\nrwfilter *.rw --dipset=honeynet.set --proto=0,2- --dport=20000 --pass=stdout | rwstats\n\n--fields=sip --count=20\n\nINPUT: 334 Records for 102 Bins and 334 Total Records\n\nOUTPUT: Top 20 Bins by Records\n\nsIP|  Records| %Records|  cumul_%|\n\n66.240.192.138|    12| 3.592814| 3.592814|\n\n71.6.135.131|    12| 3.592814| 7.185629|\n\n80.82.70.198|    12| 3.592814| 10.778443|\n\n62.75.207.109|    12| 3.592814| 14.371257|\n\n71.6.165.200|    12| 3.592814| 17.964072|\n\n8.8.8.8|    10| 2.994012| 20.958084|\n\n198.20.69.98|     9| 2.694611| 23.652695|\n\n41.74.182.170|     9| 2.694611| 26.347305|\n\n94.102.49.210|     8| 2.395210| 28.742515|\n\n60.209.5.30|     8| 2.395210| 31.137725|\n\n[Trimmed]\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 27\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\nrwfilter *.rw --dipset=honeynet.set --proto=0,2- --dport=102 --pass=stdout |\n\nrwstats --fields=sip --count=20\n\nINPUT: 508 Records for 117 Bins and 508 Total Records\n\nOUTPUT: Top 20 Bins by Records\n\nsIP|  Records| %Records|  cumul_%|\n\n188.138.1.218|    32| 6.299213| 6.299213|\n\n80.82.70.198|    30| 5.905512| 12.204724| *\n\n125.97.246.5|    27| 5.314961| 17.519685|\n\n52.88.94.127|    19| 3.740157| 21.259843|\n\n198.20.69.98|    16| 3.149606| 24.409449| *\n\n94.102.49.210|    14| 2.755906| 27.165354| *\n\n120.119.31.1|    14| 2.755906| 29.921260|\n\n71.6.135.131|    13| 2.559055| 32.480315| *\n\n131.107.13.100|    13| 2.559055| 35.039370|\n\n66.240.192.138|    13| 2.559055| 37.598425| *\n\n[Trimmed]\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 28\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n## References\n\n_URLs are valid as of the publication date of this document._\n\nAssante, Michael, and Robert Lee. 2015. The Industrial Control System Cyber Kill Chain.\nWashington, DC: SANS Institute.\n\nCaltagirone, Sergio, Andrew Pendergast, and Christopher Betz. 2013. \"The Diamond Model of\nIntrusion Analysis.\" Center for Cyber Threat Intelligence and Threat Research, Hanover,\nMD.\n\nKalnai, Peter, and Jaromir Horejsi. 2015. DDoS Trojan: A Malicious Concept that Conquered the\n_ELF Format. Prague, Czech Republic: VirusBullitin._\n\nKrebs, Brian. 2015. \"Lizard Stresser Runs on Hacked Home Routers.\" Krebs on Security. January\n[09. Accessed April 11, 2016. http://krebsonsecurity.com/2015/01/lizard-stresser-runs-on-](http://krebsonsecurity.com/2015/01/lizard-stresser-runs-on-hacked-home-routers/)\n[hacked-home-routers/.](http://krebsonsecurity.com/2015/01/lizard-stresser-runs-on-hacked-home-routers/)\n\nMalwr Posts. 2015. IOC for GafGyt Malware with MD5 Hashes. November 18. Accessed April\n[13, 2015. https://malwrpost.wordpress.com/2015/11/18/ioc-for-gafgyt-malware-with-](https://malwrpost.wordpress.com/2015/11/18/ioc-for-gafgyt-malware-with-md5-samples/)\n[md5-samples/.](https://malwrpost.wordpress.com/2015/11/18/ioc-for-gafgyt-malware-with-md5-samples/)\n\nProvos, Niels, and Thorsten Holz. 2008. Virtual Honeypots: From Botnet Tracking to Intrusion\n_Detection. Upper Saddle River, NJ: Addison-Wesley._\n\nScott, Mike, Robert Falcone, and Juan Cortes. 2015. \"Attack Campaign on the Government of\nThailand Delivers Bookworm Trojan.\" Palo Alto Networks. November 24. Accessed\n[February 26, 2016. http://researchcenter.paloaltonetworks.com/2015/11/attack-campaign-](http://researchcenter.paloaltonetworks.com/2015/11/attack-campaign-on-the-government-of-thailand-delivers-bookworm-trojan/)\n[on-the-government-of-thailand-delivers-bookworm-trojan/.](http://researchcenter.paloaltonetworks.com/2015/11/attack-campaign-on-the-government-of-thailand-delivers-bookworm-trojan/)\n\n—. 2015. \"Attack Campaign on the Government of Thailand Delivers Bookworm Trojan.\"\nNovember 24. Accessed February 26, 2016.\n[http://researchcenter.paloaltonetworks.com/2015/11/attack-campaign-on-the-](http://researchcenter.paloaltonetworks.com/2015/11/attack-campaign-on-the-government-of-thailand-delivers-bookworm-trojan/)\n[government-of-thailand-delivers-bookworm-trojan/.](http://researchcenter.paloaltonetworks.com/2015/11/attack-campaign-on-the-government-of-thailand-delivers-bookworm-trojan/)\n\n—. 2015. \"Bookworm Trojan: A Model of Modular Architecture.\" Palo Alto Networks. November\n10. Accessed March 1, 2016.\n[http://researchcenter.paloaltonetworks.com/2015/11/bookworm-trojan-a-model-of-](http://researchcenter.paloaltonetworks.com/2015/11/bookworm-trojan-a-model-of-modular-architecture/)\n[modular-architecture/.](http://researchcenter.paloaltonetworks.com/2015/11/bookworm-trojan-a-model-of-modular-architecture/)\n\nSoftware Engineering Institute. 2016. SiLK. Pittsburgh, PA.\n\nSoftware Engineering Institute. 2016. super_mediator. Pittsburgh, PA.\n\nUndisclosed. 2016. ICS Honeynet Packet Capture Data.\n\nUnknown. 2016. ICS/SCADA/PLC protocol global census scanning. PLCscan. Accessed March\n[07, 2016. http://icsresearch2.plcscan.org.](http://icsresearch2.plcscan.org)\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 29\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n[VirusTotal. 2016. VirusTotal. Google. Accessed February 24, 2016. http://virustotal.com.](http://virustotal.com)\n\nYeh, Tim. 2014. \"Netis Routers Leave Wide Open Backdoor.\" Trend Micro TrendLabs. August\n[25. Accessed April 11, 2016. http://blog.trendmicro.com/trendlabs-security-](http://blog.trendmicro.com/trendlabs-security-intelligence/netis-routers-leave-wide-open-backdoor/)\n[intelligence/netis-routers-leave-wide-open-backdoor/.](http://blog.trendmicro.com/trendlabs-security-intelligence/netis-routers-leave-wide-open-backdoor/)\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY 30\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----\n\n|REPORT DOCUMENTATION PAGE|Col2|Col3|Col4|Form Approved OMB No. 0704-0188|Col6|\n|---|---|---|---|---|---|\n|Public reporting burden for this collection of information is estimated to average 1 hour per response, including the time for reviewing instructions, search- ing existing data sources, gathering and maintaining the data needed, and completing and reviewing the collection of information. Send comments regard- ing this burden estimate or any other aspect of this collection of information, including suggestions for reducing this burden, to Washington Headquarters Services, Directorate for information Operations and Reports, 1215 Jefferson Davis Highway, Suite 1204, Arlington, VA 22202-4302, and to the Office of Management and Budget, Paperwork Reduction Project (0704-0188), Washington, DC 20503.||||||\n|1. AGENCY USE ONLY (Leave Blank)||2. REPORT DATE May 2016||3. REPORT TYPE AND DATES COVERED Final||\n|4. TITLE AND SUBTITLE Using Honeynets and the Diamond Model for ICS Threat Analysis||||5. FUNDING NUMBERS FA8721-05-C-0003||\n|6. AUTHOR(S) John Kotheimer, Kyle O’Meara, Deana Shick||||||\n|7. PERFORMING ORGANIZATION NAME(S) AND ADDRESS(ES) Software Engineering Institute Carnegie Mellon University Pittsburgh, PA 15213||||8. PERFORMING ORGANIZATION REPORT NUMBER CMU/SEI-2016-TR-006||\n|9. SPONSORING/MONITORING AGENCY NAME(S) AND ADDRESS(ES) AFLCMC/PZE/Hanscom Enterprise Acquisition Division 20 Schilling Circle Building 1305 Hanscom AFB, MA 01731-2116||||10. SPONSORING/MONITORING AGENCY REPORT NUMBER n/a||\n|11. SUPPLEMENTARY NOTES||||||\n|12A DISTRIBUTION/AVAILABILITY STATEMENT Unclassified/Unlimited, DTIC, NTIS||||12B DISTRIBUTION CODE||\n|13. ABSTRACT (MAXIMUM 200 WORDS) The use of a honeynet—a network of seemingly vulnerable machines designed to lure attackers—is an established technique for collect- ing threat intelligence across various network environments. As a result, organizations have begun to use this approach to protect net- worked industrial control systems (ICS). Organizations hope to observe attempts to compromise their systems in an isolat-ed environ- ment, enabling them to deploy mitigations and harden their networks against emerging threats. This report presents an approach to analyzing approximately 16 gigabytes of full packet capture data collected from an ICS honeynet. The data is analyzed in the context of other open source information about known threats to ICS to understand how adversaries inter- acted with the net-work and the types of attacks they attempted. To provide a more rigorous approach to characterizing these threat actors, the study employed the well-known Diamond Model of Intrusion Analysis. It applied this model to define and categorize several groups of potential threat actors observed within the data. The study also evaluated the effectiveness of honeynets as a tool for ICS threat intelligence. This report includes several recommendations for their deployment and emphasizes active interaction with external hosts to generate higher quality data.||||||\n|14. SUBJECT TERMS Honeynet, industrial control systems, ICS, Diamond Model||||15. NUMBER OF PAGES 39||\n|16. PRICE CODE||||||\n|17. SECURITY CLASSIFICATION OF REPORT Unclassified|18. SECURITY CLASSIFICATION OF THIS PAGE Unclassified||19. SECURITY CLASSIFICATION OF ABSTRACT Unclassified||20. LIMITATION OF ABSTRACT UL|\n|NSN 7540-01-280-5500|||Standard Form 298 (Rev. 2-89) Prescribed by ANSI Std. Z39-18 298-102|||\n\n\nCMU/SEI-2016-TR-006 | SOFTWARE ENGINEERING INSTITUTE | CARNEGIE MELLON UNIVERSITY\nDistribution Statement A: Approved for Public Release; Distribution is Unlimited\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.05.09_ICS_Threat_Analysis/2016_005_001_454247.pdf"
    ],
    "report_names": [
        "2016_005_001_454247"
    ],
    "threat_actors": [
        {
            "id": "8386d4af-5cca-40bb-91d7-aca5d1a0ec99",
            "created_at": "2022-10-25T16:07:23.414558Z",
            "updated_at": "2025-03-27T02:02:09.787347Z",
            "deleted_at": null,
            "main_name": "Bookworm",
            "aliases": [],
            "source_name": "ETDA:Bookworm",
            "tools": [
                "Agent.dhwf",
                "Chymine",
                "Darkmoon",
                "Destroy RAT",
                "DestroyRAT",
                "FF-RAT",
                "FormerFirstRAT",
                "Gen:Trojan.Heur.PT",
                "Kaba",
                "Korplug",
                "PlugX",
                "Poison Ivy",
                "RedDelta",
                "SPIVY",
                "Scieron",
                "Sogu",
                "TIGERPLUG",
                "TVT",
                "Thoper",
                "Xamtrav",
                "ffrat",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716494,
    "ts_updated_at": 1743041292,
    "ts_creation_date": 1462532031,
    "ts_modification_date": 1462533876,
    "files": {
        "pdf": "https://archive.orkl.eu/ad88223032e7cb6b373a458e6472870a7ca69e37.pdf",
        "text": "https://archive.orkl.eu/ad88223032e7cb6b373a458e6472870a7ca69e37.txt",
        "img": "https://archive.orkl.eu/ad88223032e7cb6b373a458e6472870a7ca69e37.jpg"
    }
}