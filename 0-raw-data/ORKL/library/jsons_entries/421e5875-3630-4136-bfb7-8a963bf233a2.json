{
    "id": "421e5875-3630-4136-bfb7-8a963bf233a2",
    "created_at": "2022-10-25T16:48:13.525718Z",
    "updated_at": "2025-03-27T02:05:36.815585Z",
    "deleted_at": null,
    "sha1_hash": "880e01c8cadd72f8318f79d5c95cc57556b69c56",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-10-02T03:25:35Z",
    "file_modification_date": "2019-10-02T03:25:35Z",
    "file_size": 1043439,
    "plain_text": "# New Adwind Campaign targets US Petroleum Industry\n\n**[netskope.com/blog/new-adwind-campaign-targets-us-petroleum-industry-2](https://www.netskope.com/blog/new-adwind-campaign-targets-us-petroleum-industry-2)**\n\nAbhinav Singh October 1, 2019\n\nA new campaign spreading the Adwind RAT has been seen in the wild, specifically targeting the\npetroleum industry in the US. The samples are relatively new and implement multi-layer\nobfuscation to try to evade detection. We found multiple RAT samples hosted on the serving\ndomain and spread across multiple directories, all hosted within the last month. We have\n[previously reported the use of this RAT targeting the retail and hospitality industry.](https://www.netskope.com/blog/targeted-attack-campaigns-multi-variate-malware-observed-cloud)\n\nThe overall functionality of the RAT has remained the same as our previous post: It achieves\npersistence through registry modifications, performs process injection to stay under the radar,\nterminates security services (e.g., firewall, AV), and steals sensitive data. The major change is in\nthe obfuscation technique, wherein multiple embedded JAR archives are used before unpacking\nthe actual payload. Netskope Threat Protection detects the malware as ByteCodeJAVA.Trojan.Kryptik and Gen:Variant.Application.Agentus.1. This blog post provides an analysis\nof the new campaign and the new obfuscation techniques.\n\n## Responsible Disclosure\n\nThe URLs hosting the Adwind RAT were reported to Westnet on September 9th, 2019.\n\n## Analysis Details\n\n\n-----\n\nWe discovered the new campaign serving the Adwind RAT JAR payload from\n“members[.]westnet[.]com[.]au/~joeven/”. Westnet is an Australian ISP. The attacker is either a\nWestnet user or has compromised the account of one or more Westnet users. The same RAT is\nbeing hosted by multiple other Westnet users. Some of the recent uploads have multiple file\nextensions (*.png.jar.jar) to hide the actual file-type visibility from the target user. We have listed\nsome of the current upload directories in the Indicators of compromise section. At the time of\nwriting, the links were still active.\n\nWhen the victim executes the payload, there are multiple levels of JAR extractions that occur.\nFigure 1 below summarizes the execution stages at a high level.\n\n**Figure 1: Process execution stages involved in Adwind’s infection chain**\n\n### Step 1\n\nThe dropped JAR payload executes and creates the parent java process and copies itself into the\n%User% directory. Once the copy is created, the java thread performs the following three actions:\n\nExecutes the copy\nCreates a registry entry in HKCU/CurrentVersion/Run to maintain persistence.\nCreates WMI scripts in %temp% and launches them. These scripts, shown in Figure 2,\ndisable firewall and antivirus services.\n\n\n-----\n\n**Figure 2: WMI scripts created by the first stage JAR payload.**\n\n### Step 2\n\nThe new JAR dropped in Step 1:\n\nPerforms AES decryption routine on an embedded object to construct the Step 3 JAR\nWrites the Step 3 JAR in the %temp% directory and executes it as a new java thread.\n\nFigure 3 below shows the decompiled class files implementing the decryption routine on an object\nnamed “_”.\n\n**Figure 3: Embedded object which decrypts to JAR file with the JRAT class**\n\n\n-----\n\n### Step 3\n\nThe Step 3 JAR loads the JRAT class.\n\n### Step 4\n\nThis JRAT class is responsible for loading and linking the DLL which contains the major RAT\nfunctionality. It then tries connecting to its command and control server at 185[.]205[.]210[.]48.\nThe JRAT class contains multiple levels of obfuscations within itself in order to hide its features\nand functionality.\n\nWhen we last blogged about it, the RAT was cross-platform and supported Windows, Linux, and\nMac. Figure 4 below shows the OS check implemented by JRAT, indicating that the crossplatform support hasn’t changed.\n\n**Figure 4: JRAT class checking for OS environment**\n\nThe core functionalities of the RAT is shown in Figure 4 below. Some of the highlight features\ninclude:\n\nCapturing webcam images\nScanning the hard-drive for files based on extensions defined in RAT’s config.\nSpinning up multiple process threads and performing injection into known legitimate\nwindows processes.\nMonitoring system status.\nEncrypting and exfiltrating the data to its command and control server.\n\n\n-----\n\n**Figure 5: Netskope Advanced Heuristic dashboard listing key features of the RAT.**\n\n## Conclusion\n\nThe Adwind RAT is a well-known malware family that has actively been used in multiple\ncampaigns over the last couple of years. The samples we analyzed showed that the VirusTotal\ndetection ratio for the top-level JAR was 5/56 while that of the final decrypted JAR was 49/58.\nThese detection ratios indicate that attackers have largely been successful in developing new,\ninnovative obfuscation techniques to evade detection.\n\n## Indicators Of Compromise\n\n**IOC** **Type** **Description**\n\n3bdfd33017806b85949b6faa7d4b98e4 Hash WMI script created by Malware\n\na32c109297ed1ca155598cd295c26611 Hash WMI script created by Malware\n\na9175094b275a0aaed30604f7dceeb14 Hash First level JAR payload\n\n781fb531354d6f291f1ccab48da6d39f Hash Decrypted JAR file\n\n0b7b52302c8c5df59d960dd97e3abdaf Hash DLL file created by the JAR\n\n185.205.210.48 IP Command and Control IP\n\nhuup://members[.]westnet[.]com[.]au/~philchief/ URL Pages serving the malicious JAR\npayload\n\nhuup://members[.]westnet[.]com[.]au/~lionsnortham/ URL Pages serving the malicious JAR\npayload\n\n\n-----\n\nhuup://members[.]westnet[.]com[.]au/~mcleodart/ URL Pages serving the malicious JAR\npayload\n\nhuup://members[.]westnet[.]com[.]au/~jbush/ URL Pages serving the malicious JAR\npayload\n\nhuup://members[.]westnet[.]com[.]au/~joeven/ URL Pages serving the malicious JAR\npayload\n\n\nhuup://members[.]westnet[.]com[.]au/~howrahnurs‐\nery_nbn/\n\n\nURL Pages serving the malicious JAR\npayload\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.10.01.Adwind_Campaign_US_Petroleum_Industry/New%20Adwind%20Campaign%20targets%20US%20Petroleum%20Industry.pdf"
    ],
    "report_names": [
        "New Adwind Campaign targets US Petroleum Industry"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041136,
    "ts_creation_date": 1569986735,
    "ts_modification_date": 1569986735,
    "files": {
        "pdf": "https://archive.orkl.eu/880e01c8cadd72f8318f79d5c95cc57556b69c56.pdf",
        "text": "https://archive.orkl.eu/880e01c8cadd72f8318f79d5c95cc57556b69c56.txt",
        "img": "https://archive.orkl.eu/880e01c8cadd72f8318f79d5c95cc57556b69c56.jpg"
    }
}