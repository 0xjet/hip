{
    "id": "c63c3d5b-3ebb-4db5-b372-44b84f4d9261",
    "created_at": "2023-01-12T15:03:16.170793Z",
    "updated_at": "2025-03-27T02:16:26.045142Z",
    "deleted_at": null,
    "sha1_hash": "63f924f38ed8d4c22887e33324d92fe39d6680b8",
    "title": "2022-09-05 - Scam Android app steals Bank Credentials and SMS- MyPetronas APK",
    "authors": "",
    "file_creation_date": "2022-11-28T18:56:45Z",
    "file_modification_date": "2022-11-28T18:56:45Z",
    "file_size": 2952792,
    "plain_text": "# Scam Android app steals Bank Credentials and SMS: MyPetronas APK\n\n**[notes.netbytesec.com/2022/09/scam-android-app-steals-bank.html](https://notes.netbytesec.com/2022/09/scam-android-app-steals-bank.html)**\n\nFareed\n\nThis post was authored by Fareed.\n\nThis blog post is intended to give a better overall picture of a malicious Android app\ncampaign attack that believes to be targeted at Malaysians. The threat actor set up several\nmodus operandi from Maid clean services application, toward island travel based app, and\nnow they're using Petronas as their new theme.\n\nThis blog post might useful for security engineers, Android researchers, and security\nanalysts to catch up with current cybersecurity issues specifically mobile malware threats\nand Malaysia cyber security news. By the end of this blog post, readers will understand the\ninner working of this recent Android malware attack that happened to the compromised user.\nFurthermore, security analysts can collect the given IOCs extracted from the malware to\ncheck whether the environment of your organization or any contact of you has been\ncompromised or not.\n\n## Non-technical Executive Summary\n\n For non-technical background, this is an Android malicious application analysis that was conducted and investigated by the Netbytesec team to understand the behavior of the malicious Android application in a details manner so that we can verify how the scammed victims were being compromised or we can call it \"hacked\" by the scammer using this Android application installed in victim's phone. The application will phish the user to enter their bank credential in the fake payment page of FPX and credit card and also steal all victims’ SMS content. The impact of this application can expose the information of victims’ banking information to the scammer/hacker and then, the attacker might make the illegal bank transaction by leveraging the SMS stealer as an OTP number is needed to make the bank transaction.\n\n Executive Summary\n\n\n-----\n\nThe Netbytesec (NBS) team has conducted an Android malware analysis on a lure Android\nPackage Kit (APK) sample associated with Petronas as contained in the application's name\nand theme. The malicious Android application can be downloaded from a landing page set\nup by the threat actor on the internet while the campaign is going on. While using the\neCommerce-based application, the victims need to make the payment of their shopping cart\nusing a fake FPX page and fake Credit Card payment page in the application like the\ncommon banking credential stealer application targeting Malaysian banks. On top of that,\nafter the malicious APK is installed on the victim’s Android phone, the malicious APK will\nsteal all incoming SMS from the victim. The impact of such phishing methods and SMS\nstealers of this Android application can lead to the scammer could use the information to\nperform illegal bank transactions as they have got all important information to retrieve their\ngoals including online banking credentials, bank card information, and SMS records for\nstealing the OTP code. NBS threat analysts also suspect that the actor behind this\nMyPetronas application is the same as malicious Cleaning Services Malaysia, Maid4u,\nKleanHouz, Ikea and Travel scam applications as we found the same pattern of decompiled\ncode of the APK, webview and API server URLs path of the scammer.\n\n\n-----\n\nFigure 1: MyPetronas malicious APK\n\n## Graph flow of the malicious Android Application\n\nFigure 2: Graph flow of the malware\n\n## Technical Analysis\n\n### APK Metadata information\n\n\n-----\n\nApplication name: MyPetronas\nPackage Name: com.app.homecleaning\nMD5 hash: f7d4a2b5fdb45c258fccd3059d12fee9\nDangerous permission: android.permission.READ_SMS\n\nFigure 3: Metadata of the application\n\nFrom the package name, we can get the clue that the threat actor of this malicious bank\nstealer application is the same as the other home cleaning application we've heard in the\nnews that also targets Malaysian. The threat actor might use the same template of the\nAndroid source code and forgot to change the package name.\n\n### Landing page overview\n\nThe application's APK file is available to be downloaded at the landing page that has been\nset up by the threat actor at pt-gift.store. Based on the landing page UI, the scammer uses\nthe Petronas theme to lure customers to download and install the malicious application if the\ncustomer wanted to book the package of Car Service package.\n\n\n-----\n\nFigure 4: Landing page pt-gift.store.\n\n### Application behavior and interface\n\nUpon opening the application for the first time, the application will ask the user to set the\nmalicious MyPetronas application as the default SMS app in order for the application to\nsilently gets access to the SMS content.\n\n\n-----\n\nFigure 5: Set the application as default Message app\n\nThe behavior of this can be seen in the java decompile code of the APK in the MainActivity\nclass at method OnCreate.\n\n\n-----\n\nFigure 6: Code to set the application as default SMS app\n\nIf user don't set the application as the default SMS app, the application will not proceed to\nopen the main interface and exit the application right away.\n\nUpon entering the main interface of the application, the application will show the list of the\nproducts of Petronas engine oil with a price tag which can be seen in the menu \"Shop\". The\nuser needs to choose their interested Petronas engine oil in order to book the car service\npackage.\n\nFigure 7: Shop menu contains list of products\n\nUpon clicking on one of the items, the application will be brought to the description page, and\nthen proceed to book the service by clicking the \"BOOK NOW\" button.\n\n\n-----\n\nFigure 8: Product description\n\nIn the booking chart, the user will then go to the checkout page to confirm the booking by\nfilling in the personal information such as Name, IC, phone number, address, and booking\ndate. It also appeared that users have two options for payment methods which are FPX\npayment and Credit card. Once victims fill out the form and choose the payment method, the\nvictims will be served with the fake FPX page or fake iPay88 credit card page.\n\n\n-----\n\nFigure 9: User form and online payment option to confirm booking\n\nConfirming the booking will make all the information will be POST to the attacker API web\nserver served at hxxps://lapks[.]online/skyblue_888a/api/api.php?post_order. The figure\nbelow shows the filled data in the user form sent to the API server using the POST method.\n\n\n-----\n\nFigure 10: Intercept POST request of the data\n\nAfter the data successfully send to the API server, the application will redirect the user to the\npayment options page, which is either the FPX page or the iPay88 credit card payment page.\n\n### Fake payment gateway\n\nOnce the user filled the form and submits the data, the application will load an HTML file\nlocated in the malicious application asset files. In the figure below, the application load a\nlocal HTML file into the webview instead of using a remote web page served on the internet.\n\nFigure 11: Load FPX.html in webview\n\nThe HTML code web page of the FPX payment is embedded in the resources file under the\nassets folder bundled in the application. The figure below shows the FPX.html in the assets\nfolder which is being used for the fake FPX page. Each of the targeted banks has its own\nassets file such as \"AFFIN_files\" containing images, CSS files, or HTML files that are\nneeded for the page to mimic a legit the Affin bank's login page.\n\n\n-----\n\nFigure 12: FPX.html code\n\nHere in the figure below, is how the FPX payment gateway page looks like. Victims will be\nphished by this look-legit webpage and proceed to choose their bank to make the payment.\n\n\n-----\n\nFigure 13: Fake FPX webpage\n\nThe figure below is an example of the fake Maybank2u login page used to lure victims\nspecifically to scam and steal online banking credentials.\n\n\n-----\n\nFigure 14: Fake Maybank2u webpage\n\nOn the next page for the password insertion, a user should aware that the page does not\nhave the security image like the original of Maybank2u. The fake FPX page shows the\nentered username instead of the security image.\n\n\n-----\n\nFigure 15: User password form\n\nSoon after victims click the login button, both the username and password of the victims will\nbe sent to the API server via the POST method containing the username, password, bank\nname, agent id, sid, and app name which can be seen in the code in a Javascript file named\n_post.js that will be call by the HTML when the victims clicking the login button._\n\n\n-----\n\nFigure 16: JS file used for post data of online bank credential\n\nIn the figure below shows the request of the network activity happened when the button login\nis clicked using a dummy credential.\n\nFigure 17: Intercepted request\n\nThis is a critical part of the communication toward the API server (apart from the SMS stealer\nwhich will be mention in the next section) where the scammer retrieves and steals the\ncredential of Malaysian's online banking accounts.\n\nThe list of bank include:\n\nMaybank\nAffin Bank\nPublic Bank\n\n\n-----\n\nCIMB\nBSN\nRHB\nUOB\nAmbank\nBank Islam\nHong Leong Bank\nBank Muamalat\n\nWhile for the credit card payment, figure below shows the interface of the fake ipay88 credit\ncard form.\n\nFigure 18: Credit card form interface\n\n\n-----\n\nThe Javascript file for the credit card information stealer is shown below where the threat\nactor will receive the Card number, Card expired, and CVC number in the variable uname.\n\nFigure 19: JS file to post Credit Card data to API server\n\nAfter the data is sent to the attacker's API server, the application will redirect the victim to a\npage with a popup box saying \"Connection timeout. Please try again.\" just to lure the trust of\nusers.\n\n\n-----\n\nFigure 20: Redirect page after submit data\n\n### SMS stealer\n\nFor SMS stealer behavior, the malicious application statically declares a broadcast receiver\nof BROADCAST_SMS in AndroidManifest file. The APK uses the broadcast receiver to listen\nfor any incoming message and send the incoming SMS data to the attacker API server.\nIntently to get TAC code of the banking transaction for the illegal transaction.\n\n\n-----\n\nFigure 21: SMS receiver\n\nIn the class MyReciever, the method onReceive will be triggered when an SMS is coming in\nand the application will send the SMS data to the URL hxxps://sgbx.online?\n_pass=app168&cmd=sms&sid=%1$s&sms=%2$s where the sid and SMS parameter are filled_\nper the incoming message data.\n\nFigure 22: SMS broadcast receiver to send the SMS to API server\n\nFrom this point, the attacker will receive the SMS data sent by the application as well as the\nbanking information credential.\n\n\n-----\n\n## Observation\n\nOur malware researchers observe that this malicious Android uses an Android source code\ntemplate from [Solodroid by Indonesian developer. Based on the information of the template,](https://codecanyon.net/item/ecommerce-online-shop-app/10442576?s_rank=19)\nthis application should have an admin dashboard to control the application products.\n\nFigure 23: https://codecanyon.net/item/ecommerce-online-shop-app/10442576?s_rank=19\n\nDifferentiating the code of the demo application of the Solodroid eCommerce Android App\nshows the exact same as the decompiled code The only different is the permission custom\n\n\n-----\n\npage and few of malicious broadcast receiver.\n\nFigure 24: Different decompiled code of original Solodroid application and MyPetronas\n\nIf we look at the right side of the figure, the malicious application alters the MainActivity file to\nadjust the application to request permission for the default SMS application.\n\nNBS malware researchers also observed that this MyPetronas malicious application was\nlikely being developed by the same actor of the CleaningServiceMalaysia, KleanHouz,\nMaid4u, and Travel app samples where all of these samples shared the same pattern of\nmodus operand, C2 URL path (but different domain name), and also malicious code.\n\nThe below figures show the MainActivity of islandtravel.apk, KleanHouz.apk, and\n_MyPetronas.apk shared the same code which gave us the clue that the threat actor might be_\nthe same player and malware author.\n\n\n-----\n\nFigure 25: islandtravel.apk\n\nFigure 26: kleanhouz.apk\n\n\n-----\n\nFigure 27: MyPetronas.apk\n\nFrom Netbytesec's point of view, this threat actor is not the same as the Bank Negara\nMalaysia scam application and a few other scamming applications like EGrocer or\nChickFood where Netbytesec threat analysts observe the C2 infrastructure and malicious\ncode are quite different.\n\n## Summary\n\nThe Petronas fake application is used by the scammer as a decoy to phish users' online\nbanking credentials and credit card information. The APK also has capabilities such as\nstealing users' SMS data. All the retrieved and stolen data is submitted to the C2 server of\nthe attacker using the API of the C2 server. The attacker uses information such as banking\ncredentials, credit card information, and SMS content to get the OTP of the transaction to\nperform the illegal transaction. The APK has the same pattern of code and URL path of\ncollected domains which might support our assumption that the threat actor of the previous\nMaid Cleaning service app is the same as this one.\n\n## Recommendation\n\nAll banking and Android users must aware of this type of scamming activity to avoid being\none of the victims. If you are one of the victims and already installed the malicious\napplication, please uninstall the application and report it to your bank for further action. All\nthe associated Banks parties must also notify users and make awareness about this scam\nmodus operandi as it would affect the brand name of the bank where most of the victims will\ninstead accuse the bank organization if the money in their bank account got stolen and gone\n\n\n-----\n\nas this threat actor will never stop doing these illegal activities and keep evolving from time to\ntime upgrading their techniques, tactics, and procedure to steal money from victims.\n\n## Prevention\n\nDownload and install application only from official Google Play Store.\nBe very careful enabling any dangerous permissions while using the application.\n\n## Indicator of Compromises\n\n### MD5 Hash\n\nf7d4a2b5fdb45c258fccd3059d12fee9\n\n### Domain name\n\npt-gift.store – Landing page\ngpost996.online – retrieve banking information\nlapks.online – retrieve user information\nsgbx.online – retrieve SMS\n\n### URLs\n\n_hxxps://lapks.online/skyblue_888a/api/api.php?post_order – Post user information to_\nC&C server\n_hxxps://gpost996.online/post.php – Post online banking credential to C&C server_\n_hxxps://sgbx.online?pass=app168&cmd=sms&sid=%1$s&sms=%2$s – Post SMS data_\nto C&C server\n\n## Credit\n\n[Netbytesec credit to Jacob Soo for sharing and giving insight about the sample on Twitter.](https://twitter.com/_jsoo_/status/1568923163555409920?s=20&t=GD_pZ971_DYvmnNpABKFBA)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-05 - Scam Android app steals Bank Credentials and SMS- MyPetronas APK.pdf"
    ],
    "report_names": [
        "2022-09-05 - Scam Android app steals Bank Credentials and SMS- MyPetronas APK.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535796,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1669661805,
    "ts_modification_date": 1669661805,
    "files": {
        "pdf": "https://archive.orkl.eu/63f924f38ed8d4c22887e33324d92fe39d6680b8.pdf",
        "text": "https://archive.orkl.eu/63f924f38ed8d4c22887e33324d92fe39d6680b8.txt",
        "img": "https://archive.orkl.eu/63f924f38ed8d4c22887e33324d92fe39d6680b8.jpg"
    }
}