{
    "id": "02f7a99b-97b8-42d9-9a9e-6926645125dd",
    "created_at": "2023-01-12T15:00:32.543734Z",
    "updated_at": "2025-03-27T02:16:57.974945Z",
    "deleted_at": null,
    "sha1_hash": "bdab650a3cc9e1f610f5cc7e04eacba6a932317a",
    "title": "2021-06-24 - JSSLoader- Recoded and Reloaded",
    "authors": "",
    "file_creation_date": "2022-05-28T19:11:44Z",
    "file_modification_date": "2022-05-28T19:11:44Z",
    "file_size": 681794,
    "plain_text": "# JSSLoader: Recoded and Reloaded\n\n**proofpoint.com/us/blog/threat-insight/jssloader-recoded-and-reloaded**\n\n\nJune 23, 2021\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nJSSLoader: Recoded and Reloaded\n\n\n-----\n\nJune 24, 2021 Dennis Schwarz, Matthew Mesa and Crista Giering\n\n## Key Takeaways\n\nAfter a months-long absence, the malware loader JSSLoader returned in June 2021 campaigns rewritten from the\n.NET programming language to C++.\n[Rewriting the malware could be an effort by threat actors to evade current detections.](https://www.proofpoint.com/us/threat-reference/malware)\nCurrent TA543 campaigns delivering JSSLoader are using similar lures to those observed by Proofpoint researchers\nin 2019 and the emails continue to contain links to a TDS landing page.\n\n## Overview\n\nIn June 2021, Proofpoint researchers observed a new variant of the downloader JSSLoader in several campaigns\nimpacting a variety of organizations. This version of the malware loader was rewritten from .NET to the C++ programming\nlanguage. This change, while not unheard of, is not a common occurrence and could be an effort by the threat actors\nutilizing JSSLoader to evade current detections. JSSLoader is often dropped in the first or second stage of a campaign and\nhas the functionality to profile infected machines and load additional payloads.\n\nThe campaigns are ongoing and use similar lures to those initially observed by Proofpoint researchers in 2019. According\nto our data, the recent campaigns have attempted to target as many as several hundred organizations at a time across a\nwide range of industries, including finance, manufacturing, technology, retail, healthcare, education, and transportation.\n\n## Malware Analysis\n\n[Proofpoint researchers initially observed JSSLoader in September 2019. It was written in .NET at the time and being](https://malpedia.caad.fkie.fraunhofer.de/details/win.jssloader)\nactively developed. Fast forward nearly two years and Proofpoint has now identified this latest variant of the malware\nloader written in C++. It has much of the same functionality as previous iterations. The following provides a more indepth look at that early version and the changes the loader has undergone since 2019.\n\n**2019 Version of JSSLoader (.NET)**\n\nJSSLoader is an initial access malware that was written in .NET and was named after its “JSS” namespace and “jssAdmin”\ncommand and control (C&C) panel login page:\n\n_Figure 1. JSSLoader C&C panel login page from September 27, 2019 version._\n\nIts C&C used HTTPS requests with base64 encoded data:\n\n\n-----\n\n_Figure 2. Example C&C request from September 27, 2019 version._\n\nThe initial C&C beacon contained verbose system information:\n\n\n-----\n\n_Figure 3. Example system information (trimmed for readability) from September 27, 2019 version._\n\nIts commands and functionality focused on executing a next stage executable or JavaScript:\n\n\n-----\n\n_Figure 4. Commands from September 27, 2019 version._\n\n**2020-2021 JSSLoader Changes (.NET)**\n\nSince the initial version of JSSLoader, there have been gradual changes and improvements to the malware in successive\ncampaigns. Morphisec wrote about some of these in a January 2021 paper titled “Threat Profile the Evolution of the\nFIN7 JSSLoader (PDF).” Two of the most visible changes were a switch from the verbose system information to a JSON\nobject and the addition of new commands. For example, the JSSLoader used in a December 14, 2020 email-based\ncampaign sent the following system information:\n\n\n-----\n\n_Figure 5. Example system information (formatted and trimmed for readability) from December 14, 2020 version._\n\nWhile the formatting changed, the beacon contained much of the same information as the original version. In addition to the\nchanges in the C&C protocol, several new commands were added. The focus of the new commands was still on executing\na next stage:\n\n\n-----\n\n_Figure 6. Commands from December 14, 2020 version._\n\nAfter this December 2020 campaign, activity paused and the malware went through a redevelopment phase, according to\nProofpoint’s visibility.\n\n**June 2021 JSSLoader (C++)**\n\nIn June 2021, email campaigns resumed, but the JSSLoader malware had been redeveloped from using the .NET\n[programming language to C++ (this change was also noticed on infosec Twitter). It is not common for a malware to be](https://twitter.com/Arkbird_SOLG/status/1400845449515372555)\nredeveloped in a different programming language, but it does happen occasionally. Proofpoint\n\n\n-----\n\n[recently documented another initial access malware known as Buer Loader that was redeveloped from the C](https://www.proofpoint.com/us/blog/threat-insight/new-variant-buer-loader-written-rust)\nprogramming language to Rust. As noted in that blog post, rewriting a malware can enable threat actors to better evade\nexisting detection capabilities.\n\nThe C++ version of JSSLoader analyzed here is from a June 8, 2021 email-based campaign. It sets up “registry run”\npersistence using a value name of “AppJSSLoader” and has similar style of system information beacon as the later .NET\nversions:\n\n_Figure 7. Example system information (formatted and trimmed for readability) from June 8, 2021 C++ version._\n\nThe C++ version also has similar command functionality, though they switched from the “Cmd” prefix of the later .NET\nversions back to the “Task” prefix seen in the earlier .NET samples:\n\n\n-----\n\n_Figure 8. Commands from June 8, 2021 C++ version._\n\nC&C protocol and command similarity was likely a choice to remain backwards compatible with the existing\n.NET version’s C&C panel software.\n\n## Campaign Details\n\nJSSLoader appears to be exclusive to several threat actors. In fact, Proofpoint has only observed two actors using it\nsince the first email campaign in 2019.\n\nMost of the campaigns were attributed to the threat actor tracked by Proofpoint as TA543. They are characterized by\ntheir widespread distribution with opportunistic targeting. A typical campaign contains thousands of email messages and\ntargets several hundred organizations. The lures used by TA543 typically focus on invoices and delivery information of\npackages.\n\nThe following sections describe and compare the original campaigns observed by Proofpoint in 2019 to the June\n2021 campaigns.\n\n\n-----\n\n**September 2019 Campaign Example**\n\nOn September 27, 2019 Proofpoint analysts observed a TA543 campaign spoofing Intuit branding. The threat actor used a\nlikely compromised account for an email marketing service to send the malicious emails that purported to be invoices\nand contained URLs linking to a landing page hosting BlackTDS. The TDS would direct the user to the download another\nfile, a VBS downloader, hosted on SharePoint. The VBS downloader would then download JSSLoader.\n\nDuring our analysis of JSSLoader, it additionally loaded a Griffon payload which is historically associated with another\nactor, TA3546, also known as FIN7 or Carbanak. In the following months Proofpoint analysts observed TA543 shift to\nprimarily delivering JSSLoader and/or other loaders that were often observed downloading other TA3546-associated\npayloads.\n\n\n-----\n\n_Figure 9. TA543 email that leads to the download of JSSLoader._\n\n**June 2021 Campaign Example**\n\n\n-----\n\nOn June 8, 2021, Proofpoint analysts observed a TA543 campaign spoofing UPS branding (Figure 10). The email\ncontained URLs linking to a Keitaro TDS landing. In turn, the landing linked to the download of a Windows Scripting File\n(WSF) hosted on SharePoint. If executed, it downloaded an intermediate script, which then downloaded and executed the\nC++ version of JSSLoader.\n\n_Figure 10. TA543 email sample from June 8, 2021, that leads to the download of JSSLoader._\n\n## Conclusion\n\n\n-----\n\nThe threat actors behind JSSLoader have continuously made modifications since its debut in 2019 and are likely to\ncontinue doing so using the 2021 variant. With the redevelopment of the malware into C++, which was possibly done to\nevade current detections and make analysis more difficult, Proofpoint researchers have not seen the .NET version in play.\nInstead, researchers anticipate seeing small refinements being made to the 2021 version in future campaigns, keeping in\nline with the evolution of the .NET version over the past two years.\n\n**Indicators of Compromise**\n\n**Indicator** **Type** **Notes**\n\ndd86898c784342fc11c42bea4c815cb536455ee709e7522fb64622d9171c465d SHA256 September\n27, 2019 JSSLoader Sample\n\nbikweb\\.com Hostname September\n27, 2019 JSSLoader C&C\n\na062a71a6268af048e474c80133f84494d06a34573c491725599fe62b25be044 SHA256 December\n14, 2020 JSSLoader sample\n\nmonusorge\\.com Hostname December\n14, 2020 JSSLoader C&C\n\n7a17ef218eebfdd4d3e70add616adcd5b78105becd6616c88b79b261d1a78fdf SHA256 June\n8, 2021 JSSLoader Sample\n\ninjuryless\\.com Hostname June\n8, 2021 JSSLoader C&C\n\n**ET Signatures**\n\n2033072 - ET TROJAN FIN7 JSSLoader Variant Activity (POST)\n\n2033074 - ET TROJAN FIN7 JSSLoader Variant Activity (GET)\n\n2838606 - ETPRO TROJAN Win32/jssLoader CnC Activity\n\n2838607 - ETPRO TROJAN Win32/jssLoader CnC Checkin\n\n2842028 - ETPRO TROJAN JSSLoader CnC Host Checkin\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-06-24 - JSSLoader- Recoded and Reloaded.pdf"
    ],
    "report_names": [
        "2021-06-24 - JSSLoader- Recoded and Reloaded.pdf"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "1998ad13-b343-4409-9a37-b1930d156a28",
            "created_at": "2023-09-17T02:00:09.948891Z",
            "updated_at": "2025-03-27T02:00:03.137557Z",
            "deleted_at": null,
            "main_name": "Storm-0324",
            "aliases": [
                "DEV-0324",
                "Sagrid",
                "TA543"
            ],
            "source_name": "MISPGALAXY:Storm-0324",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bfded1cf-be73-44f9-a391-0751c9996f9a",
            "created_at": "2022-10-25T15:50:23.337107Z",
            "updated_at": "2025-03-27T02:00:55.445946Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "FIN7",
                "GOLD NIAGARA",
                "ITG14",
                "Carbon Spider",
                "ELBRUS",
                "Sangria Tempest"
            ],
            "source_name": "MITRE:FIN7",
            "tools": [
                "Mimikatz",
                "AdFind",
                "JSS Loader",
                "HALFBAKED",
                "REvil",
                "PowerSploit",
                "CrackMapExec",
                "Carbanak",
                "Pillowmint",
                "Cobalt Strike",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRat",
                "Lizar",
                "TEXTMATE",
                "BOOSTWRITE"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d85adfe3-e1c3-40b0-b8bb-d1bacadc4d82",
            "created_at": "2022-10-25T16:07:23.619566Z",
            "updated_at": "2025-03-27T02:02:09.890982Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "APT-C-11",
                "ATK 32",
                "Gold Niagara",
                "ITG14",
                "TAG-CR1"
            ],
            "source_name": "ETDA:FIN7",
            "tools": [
                "7Logger",
                "Agentemis",
                "Anunak",
                "Astra",
                "BIOLOAD",
                "BIRDWATCH",
                "Bateleur",
                "Boostwrite",
                "CROWVIEW",
                "Carbanak",
                "Cobalt Strike",
                "CobaltStrike",
                "DICELOADER",
                "DNSMessenger",
                "FOWLGAZE",
                "HALFBAKED",
                "JSSLoader",
                "KillACK",
                "LOADOUT",
                "Lizar",
                "Meterpreter",
                "Mimikatz",
                "POWERPLANT",
                "POWERSOURCE",
                "RDFSNIFFER",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "TEXTMATE",
                "Tirion",
                "VB Flash",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535632,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1653765104,
    "ts_modification_date": 1653765104,
    "files": {
        "pdf": "https://archive.orkl.eu/bdab650a3cc9e1f610f5cc7e04eacba6a932317a.pdf",
        "text": "https://archive.orkl.eu/bdab650a3cc9e1f610f5cc7e04eacba6a932317a.txt",
        "img": "https://archive.orkl.eu/bdab650a3cc9e1f610f5cc7e04eacba6a932317a.jpg"
    }
}