{
    "id": "e76ff7f4-d034-4284-8717-df9c40313b2b",
    "created_at": "2023-01-12T15:02:32.79897Z",
    "updated_at": "2025-03-27T02:05:30.710523Z",
    "deleted_at": null,
    "sha1_hash": "36b95abd2a0baed419204af40f58c651244e11f3",
    "title": "2019-08-12 - PsiXBot Continues to Evolve with Updated DNS Infrastructure",
    "authors": "",
    "file_creation_date": "2022-05-28T22:00:26Z",
    "file_modification_date": "2022-05-28T22:00:26Z",
    "file_size": 914566,
    "plain_text": "# PsiXBot Continues to Evolve with Updated DNS Infrastructure\n\n**[proofpoint.com/us/threat-insight/post/psixbot-continues-evolve-updated-dns-infrastructure](https://www.proofpoint.com/us/threat-insight/post/psixbot-continues-evolve-updated-dns-infrastructure)**\n\nAugust 12, 2019\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nPsiXBot Continues to Evolve with Updated DNS Infrastructure\n\n\n-----\n\nAugust 13, 2019 Proofpoint Threat Insight Team\n\n**Overview**\n\nEarlier this year, FoxIT published research regarding the evolution of a .NET based malware known as\n[“PsiXBot.”[1] We have continued to observe the malware in both malicious email and exploit kit campaigns.](https://www.proofpoint.com/us/threat-insight/post/sload-and-ramnit-pairing-sustained-campaigns-against-uk-and-italy)\n\nSince the publication of this initial research, Proofpoint researchers have observed another evolution of PsiXbot\n(v1.0.2) which exhibits some key differences, including a new and unique method of dynamically fetching its\nown DNS infrastructure by utilizing a URL shortening service to gather the server IP addresses required to\nresolve the .bit domains used for command and control (C&C).\n\n_Figure 1: Newly Observed Global Variable Version - 1.0.2_\n\n**Analysis**\n\nProofpoint researchers have observed a new version of PsiXBot in the wild. It has been historically delivered in\nboth malicious spam campaigns and as a payload for the Spleevo and RIG-v exploit-kits with indiscriminate\ngeographical targeting.\n\nAnalysts noted that in this version, the malware continued to check the infected machine’s installed language to\ndetermine if it is in Russia (RU) or not. If it is found to be RU, the PsiXbot will exit.\n\nHistorically, PsiXbot has made use of .bit domain addresses which are associated with the NameCoin\ncryptocurrency[2]. The .bit domain is not resolved in the same way as a more common TLDs, such as “.com” or\n“.net”. Rather, it requires a special DNS server to provide resolution from domain to IP address.[3] In previous\nversions of PsiXbot, an OpenNIC DNS server was hardcoded in the binary. Now, the authors are utilizing a\nURL created with the URL shortening service “tiny[.]cc” to gather the current DNS server for each C&C domain:\n\n_Figure 2: The initial GET request for a hex-encoded domain name using tiny[.]cc shortener service_\n\n\n-----\n\nThis shortened URL is a simple hex stream, which, upon decoding, provides a C&C server domain. This is also\nhardcoded in the executable. After this initial HTTP request to tiny[.]cc, the connection is upgraded to HTTPS.\nOnce the connection is upgraded to HTTPS, it performs this same request, only this time an “HTTP 303 See\nOther” response is given.\n\nWith this request, the returned “Location” header contains another hex-encoded domain, similar to what we\nobserved in the URL shortener request. This is a bit different: when the hex-encoded domain provided in the\nLocation header is decoded, it is not a domain but rather an IP address. So far, we have observed two specific\nattackers provided IP addresses returned as hex-encoded domains.\n\n_Figure 3: The GET request containing a hex-encoded C&C domain (adm4[.]bit) followed by an HTTP 303 See_\n_Other response revealing the hex-encoded DNS server IP address as a domain._\n\n_Figure 4: The GET request containing a hex-encoded C&C domain (adm2[.]bit) followed by an HTTP 303 See_\n_Other response revealing another hex-encoded DNS server IP Address as a domain._\n\nUpon learning of the intended DNS server to be used for C&C redirection, the malware will ping the IP address\ngathered from the hex-encoded domain in the Location header. This code for gathering the C&C and IP\naddress can be observed in the code snippet below.\n\n\n-----\n\n_Figure 5: Code snippet for gathering the DNS Server address_\n\nIf the malware receives a response back, indicating the DNS server is up, it will then send a DNS query for the\nC&C domain using the gathered DNS server. The following annotated code shows this process.\n\n\n-----\n\n_Figure 6: Annotated code walking through the process of retrieving the C&C IP Address via the attacker’s DNS_\n_server._\n\nFrom the network level (Figure 8), the process is as follows:\n\n_Figure 7: Annotated network traffic showing the process of gathering the DNS server to C&C traffic._\n\n1. Unintended GET request to the hex-encoded IP Address of the DNS server to be used (185.228.234.204)\n2. Ping to the DNS server IP Address to obtain connectivity status (185.228.234.204)\n3. DNS query to the .bit domain (hardcoded in the sample) which returns the C&C IP Address\n\n(185.159.129.37)\n4. Ping to the C&C IP Address for connectivity status (185.159.129.37)\n5. HTTPS traffic to the C&C domain (185.159.129.37)\n\nAn example of the HTTPS-based command and control traffic appears below:\n\n\n-----\n\n_Figure 8: A look at the initial C&C request containing system information_\n\nThe data in the POST body is encrypted with RC4. In this case, the hardcoded RC4 key was\n“63a6a2eea47f74b9d25d50879214997a”, which is the same key used in previous versions of PsiXBot. Using\nthis key, we can decrypt the C&C traffic to show particular checks in an infected system’s information:\n\n**action=call&user_name=test&bot_id=B4DCF733C9C43D10C80120CF7760B564&av=N&os_major=Microsoft**\n**Windows 7 Ultimate &permissions=Admin&os_bit=64&cpu=Intel(R) Core(TM) i3-2100 CPU&gpu=NVIDIA**\n**GeForce 8800 Ultra 768&version=1.0.2&user_group=Admin**\n\nThe bot_id in this sample is created by taking the MD5 hash of the following system details in this order:\n\nCPU\nUser Name\nGPU\nMachine Name\nOS Version\nUser Domain Name\n\nBased on previous analysis, it appears this version of PsiXBot chose not to include some system information it\npreviously gathered, such as .NET version and HDD information. Upon successful C&C check in, the server\nwill reply with a JSON blob containing a “result_code”:\n\n**{result_code:[{\"result_code\":\"200\"}]}**\n\nAs with the previously analyzed versions of PsiXBot, upon a successful check-in, the bot will then request\nsubsequent commands by POSTing a request containing an action of “command” and its specific bot_id to the\nC&C server:\n\n**action=command&bot_id=B4DCF733C9C43D10C80120CF7760B564**\n\nAfter receiving this data, the C&C server will return another JSON blob containing commands to be executed.\nBelow is an example of this:\n\n**{**\n\n**result_code:**\n\n**[**\n\n**{**\n\n**\"result_code\":\"200\"**\n\n**}**\n\n**]**\n\n**,commands:[{**\n\n**\"command_id\":\"def_1\",**\n\n**\"command_action\":\"StartSchedulerModule\",**\n\n**\"command_data\":\"\",**\n\n\n-----\n\n**command_arg :**\n\n**},{**\n\n**\"command_id\":\"def_2\",**\n\n**\"command_action\":\"StartFGModule\",**\n\n**\"command_data\":\"\",**\n\n**\"command_arg\":\"\"**\n\n**},{**\n\n**\"command_id\":\"def_3\",**\n\n**\"command_action\":\"GetSteallerPasswords\",**\n\n**\"command_data\":\"\",**\n\n**\"command_arg\":\"\"**\n\n**}]}**\n\nUpon receiving this command list, the bot will then begin to execute the modules on the infected machine and\nreport back the status of each.\n\nThe features contained in 1.0.2 are as follows, with the new features identified in bold:\n\nDownloadAndExecute\nExecute\nGetInstalledSoft\nGetOutlook\nGetSteallerCookies\nGetSteallerPasswords\n**SelfDelete**\nStartComplexModule\n**StartCryptoModule**\n**StartFGModule**\nStartKeylogger\nStartNewComplexModule\nStartSchedulerModule\n**StartSpam**\n\n**New Module Analysis**\n\n**_SelfDelete_**\n\nThe “SelfDelete” module runs a command using the cmd [.] exe shell in a hidden window to delete the running\nbot process and remove it from the infected system.\n\n**_StartCryptoModule_**\n\n\n-----\n\nThe StartCryptoModule, assembly name **LESHI, has a new module name (possibly to account for the**\nvarious cryptocurrencies included), but appears to have the same functionality as the previously analyzed\nmodule. This module will monitor the clipboard for text matching a Bitcoin, Etherium, Monero, Ripple, or\nLitecoin wallet address, and if found, replace it with a self-configured wallet address.\n\n**_StartFGModule_**\n\nThe “StartFGModule”, assembly name “omg228”, is a newly implemented “form grabbing” module. It appears\nrudimentary, as it is not targeting any traffic or domains specifically, such as banking or financial websites. This\nmodule will store GET or POST requests in a log file titled “temp.log” stored in the User’s %TEMP% directory.\nThis log is subsequently sent to the C&C server.\n\n**_StartSpam_**\n\nThe “StartSpam” module, assembly name “Spam”, is another newly implemented module which has the ability\nto send outbound email using Microsoft Outlook to send messages with varying content, crafted by the attacker\nbased on command line switches provided:\n\nSubject\nBody\nName\nAttachment\n\nThe StartSpam module is configured to delete any outbound messages after sending. In addition to this, it will\nharvest any saved Outlook email signatures to be used inside any messages sent by this module.\n\n**Conclusion**\n\nPsiXBot continues to evolve with new ways of evading detection and new features to steal information. The .bit\ndomains remain in use; however, it utilizes a new technique to retrieve the DNS servers required to connect.\nPsiXBot continues to operate as a bot with various stealer actions, but this new version expands its list of\nmodules, which pushes the bot’s capabilities in new directions. Since PsiXBot first emerged in 2017, it has\nundergone several changes, making it a competent and relevant stealer. The changes observed here\ndemonstrate that the author or group behind this malware is committed to evolving this malware to compete in\nthe threat landscape.\n\n**References**\n\n[1] [https://blog.fox-it.com/2019/03/27/psixbot-the-evolution-of-a-modular-net-bot/](https://blog.fox-it.com/2019/03/27/psixbot-the-evolution-of-a-modular-net-bot/)\n\n[2] [https://dotbit.me/](https://dotbit.me/)\n\n[3] [https://abuse.ch/blog/dot-bit-the-next-generation-of-bulletproof-hosting/](https://abuse.ch/blog/dot-bit-the-next-generation-of-bulletproof-hosting/)\n\n**Indicators of Compromise (IOCs)**\n\n\n**IOC** **IOC**\n**Type**\n\n185.228.233.135 IP\nAddress\n\n\n**Description**\n\nPsiXBot\nCommand and\nControl\n\n\n-----\n\n185.159.129.37 IP\nAddress\n\n\nPsiXBot\nCommand and\nControl\n\n\nadm1.bit Domain PsiXBot\nCommand and\nControl\n\nadm2.bit Domain PsiXBot\nCommand and\nControl\n\nadm3.bit Domain PsiXBot\nCommand and\nControl\n\nadm4.bit Domain PsiXBot\nCommand and\nControl\n\nadm5.bit Domain PsiXBot\nCommand and\nControl\n\nadm6.bit Domain PsiXBot\nCommand and\nControl\n\nadm7.bit Domain PsiXBot\nCommand and\nControl\n\nadm8.bit Domain PsiXBot\nCommand and\nControl\n\nadm9.bit Domain PsiXBot\nCommand and\nControl\n\nadm10.bit Domain PsiXBot\nCommand and\nControl\n\n\n185.228.234.204 IP\nAddress\n\n5.182.39.23 IP\nAddress\n\n\nPsiXBot DNS\nServer\n\nPsiXBot DNS\nServer\n\n\n-----\n\n588f065399bf668456f5e6c7f7f7d585536225c073c1773b766c178c27870a8a Sha256\nHash\n\na97ad5e7fdbeb53ce17eca72e064d06f09edf24ce1e18b05bc3859ba9356ee40 Sha256\nHash\n\nd86991e4aa978fbb100a5857d1eaafabcc0f40d8afb5a02fc409e5f40816139a Sha256\nHash\n\n10d14d8c05cfa166ffd120fa9e61115f23a5851920121772cd0b2e27c149cdaf Sha256\nHash\n\ndcd27c9a7ebcf778375a9d3d7892aae0f4d6419c0e7726e003bc1709605268eb Sha256\nHash\n\n8b6dcb12fe5390005d2765c026bd6fdc352d22a072e3306fbc6ae67b81e648b8 Sha256\nHash\n\n8b2d37419db1190a5af20d3201f37f9002cd59b749a20f65412291baed19e097 Sha256\nHash\n\n9b6a9e143707f288ebefcdcf4085967f64f3496612a613eea4b6c9d599a777c2 Sha256\nHash\n\n89c59e36a61b30ef04e89238ecdae64553ef533188dd7d724cbb79fdf3849be5 Sha256\nHash\n\n6a9841b7e19024c4909d0a0356a2eeff6389dcc1e2ac863e7421cca88b94e7e0 Sha256\nHash\n\nd9dc74ae8d1191300f9ef9faad3d4a771089a4acb9cd201eb96a151da54e514d Sha256\nHash\n\n1ac50fc15f7a88ce2e511f3bcdedbf899ea314f9978888184562c2256e41901e Sha256\nHash\n\n53ebcf039e45175ea6ea5bcbe3dd14dd53d341e2aafd9e87637f32187a10056f Sha256\nHash\n\nce1f110392896414e880743b902bb4e4685ceb6f36eb9d175b8a97edbdbf5fcb Sha256\nHash\n\n2ca771b70ca913d68fe329220b0fd4f856141c4e8570c1320a34f9c98d005ad7 Sha256\nHash\n\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot\nExecutable\n\nPsiXBot Android\nModule\n\nPsiXBot Browser\nModule\n\nPsiXBot\nComplex Module\n\nPsiXBot Crypto\nModule\n\nPsiXBot FG\nModule\n\nPsiXBot\nKeylogger\nModule\n\nPsiXBot\nNewComplex\nModule\n\n\n-----\n\nb01fbb8cfeb16c4232fddea6dea53212a57e73ef32ee20056cd69d29570bf55c Sha256\nHash\n\n6e123ce5c7c48132f057428c202638eb9d0e4daa690523619316a9f72b69d17f Sha256\nHash\n\n5da1b63864f9cf7728e7c581c484901a21ff0769e80335dc73487b22b3f0ce52 Sha256\nHash\n\n**ET and ETPRO Suricata/Snort Signatures**\n\n2837663 - ETPRO TROJAN PsiXbot DNS Malformed Query\n\n2837653 - ETPRO TROJAN PsiXbot DNS Server Request M1\n\n2837654 - ETPRO TROJAN PsiXbot DNS Server Request M2\n\n2837655 - ETPRO TROJAN PsiXbot DNS Server Request M3\n\n2837656 - ETPRO TROJAN PsiXbot DNS Server Request M4\n\n2837657 - ETPRO TROJAN PsiXbot DNS Server Request M5\n\n2837658 - ETPRO TROJAN PsiXbot DNS Server Request M6\n\n2837659 - ETPRO TROJAN PsiXbot DNS Server Request M7\n\n2837660 - ETPRO TROJAN PsiXbot DNS Server Request M8\n\n2837661 - ETPRO TROJAN PsiXbot DNS Server Request M9\n\n2837662 - ETPRO TROJAN PsiXbot DNS Server Request M10\n\n2837726 - ETPRO TROJAN PsiXbot DNS Malformed Query\n\n2837734 - ETPRO TROJAN Win32/PsiXBot CnC Checkin\n\n2837903 - ETPRO TROJAN Observed Malicious SSL Cert (PsiXBot CnC)\n\n\nPsiXBot Outlook\nModule\n\nPsiXBot\nScheduler\nModule\n\nPsiXBot Spam\nModule\n\n\n2837617 - ETPRO TROJAN Likely Hostile DNS Query for Hex Encoded IP Address as Domain\n\n2837616 - ETPRO POLICY OpenSSL Suspicious Demo Cert (CN=www .mydom .com)\n\n2017645 - ET CURRENT_EVENTS DNS Query Domain .bit\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-12 - PsiXBot Continues to Evolve with Updated DNS Infrastructure.pdf"
    ],
    "report_names": [
        "2019-08-12 - PsiXBot Continues to Evolve with Updated DNS Infrastructure.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535752,
    "ts_updated_at": 1743041130,
    "ts_creation_date": 1653775226,
    "ts_modification_date": 1653775226,
    "files": {
        "pdf": "https://archive.orkl.eu/36b95abd2a0baed419204af40f58c651244e11f3.pdf",
        "text": "https://archive.orkl.eu/36b95abd2a0baed419204af40f58c651244e11f3.txt",
        "img": "https://archive.orkl.eu/36b95abd2a0baed419204af40f58c651244e11f3.jpg"
    }
}