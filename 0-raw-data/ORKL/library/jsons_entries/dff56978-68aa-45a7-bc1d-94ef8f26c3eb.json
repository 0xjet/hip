{
    "id": "dff56978-68aa-45a7-bc1d-94ef8f26c3eb",
    "created_at": "2023-01-12T15:06:33.330857Z",
    "updated_at": "2025-03-27T02:06:05.171785Z",
    "deleted_at": null,
    "sha1_hash": "73e2f3197dc61230ebfdefb74ec3b305d9181e1f",
    "title": "2020-11-18 - Ranzy Ransomware - Better Encryption Among New Features of ThunderX Derivative",
    "authors": "",
    "file_creation_date": "2022-05-29T01:20:02Z",
    "file_modification_date": "2022-05-29T01:20:02Z",
    "file_size": 2511759,
    "plain_text": "# Ranzy Ransomware | Better Encryption Among New Features of ThunderX Derivative\n\n**[labs.sentinelone.com/ranzy-ransomware-better-encryption-among-new-features-of-thunderx-derivative/](https://labs.sentinelone.com/ranzy-ransomware-better-encryption-among-new-features-of-thunderx-derivative/)**\n\nJim Walter\n\n## Background\n\nRanzy ransomware emerged in September/October this year, and appears to be an\nevolution of ThunderX and, to a lesser extent, Ako ransomware. Ranzy shares many\nfeatures and under-the-hood elements with its predecessors. However there have been a\nfew key updates, including tweaks to encryption, methods of exfiltration, and the (now\ncommonplace) use of a public “leak blog” to post victim data for those who do not comply\nwith the ransom demand.\n\n## Evolution of Ranzy Ransomware\n\n\n-----\n\nAt its heart, Ranzy is a RaaS (Ransomware as a Service) offering. Payloads are typically\ndistributed via email (phishing), although there are some reports of delivery via the web\n(drive-by downloads). The “rebrand” from ThunderX to Ranzy occurred after free-decryption\nprograms for ThunderX started to appear. A free decryption tool for ThunderX was posted to\nthe [NoMoreRansom project in September of this year.](https://www.nomoreransom.org/en/decryption-tools.html)\n\nThis ‘rebrand’ distances the actors from ThunderX as well as improves upon the encryption\nmechanism so as to reduce the feasibility of future, free, decryption tools. With ThunderX\nemerging around August 2020, it would seem as though the lifecycle of this particular family\nhas been rather short throughout its evolution. Note that some early samples of Ako were\nobserved around January 2020.\n\nAs we observed with Ako and ThunderX, the primary delivery method observed is email\n(phish) with the malicious payload attached. Current samples (Ranzy Locker 1.1) append a\n```\n.ranzy extension to encrypted files (with early versions using just .RNZ ). Also of note,\n\n```\ncurrent Ranzy Locker payloads tend to include the same PDB patch as their ThunderX\nancestors:\n\n```\nC:UsersGh0StDesktopThunderXReleaseLockerStub.pdb\n\n```\n\n-----\n\n## Improved Encryption Routines\n\nRanzy uses a combination of encryption algorithms to affect targeted data. An embedded\nRSA-2048 key is built into the ransomware payloads, with Salsa20 being utilized for specific\nfile/data encryption. Ranzy contains functionality to locate and encrypt additional local drives\n( GetLogicalDrives ), as well as adjacent (and accessible) network drives\n( NetShareEnum ).\n\nRanzy, like ThunderX and Ako, will attempt to encrypt multiple file types by extension while\nexcluding specific extensions and/or paths based on strings. Files that do not contain the\n```\n.dll, .exe, .ini, .lnk, .key, .rdp are subject for inclusion. The ransomware will\n\n```\nalso exclude specific critical paths with strings including AppData, boot, PerfLogs,\n**PerfBoot, Intel, Microsoft, Windows and Tor Browser.**\n\nOnce launched, Ranzy payloads take a number of steps in order to both ensure maximum\nimpact (encryption) as well as inhibiting standard recovery options where possible. Specific\ncommands, and syntax, can vary across Windows versions and flavors. This includes the\nuse of standard system tools to manipulate VSS and boot time recovery options.\n\nAfter execution, the ransomware will swiftly call WMIC.EXE with the following syntax:\n\n```\nwmic.exe SHADOWCOPY /nointeractive\n\n```\n\nThe following WBADMIN, BCDEDIT, and VSSADMIN commands are then issued to shift the\nvictim host to the desired, compromised, state:\n```\nwbadmin DELETE SYSTEMSTATEBACKUP\nwbadmin DELETE SYSTEMSTATEBACKUP -deleteOldest\nbcdedit.exe /set {default} recoveryenabled No\nbcdedit.exe /set {default} bootstatuspolicy ignoreallfailures\n\n```\n\n-----\n\n```\nvssadmin.exe Delete Shadows /All /Quiet\n\n```\n\n[Ranzy Locker makes use of the Windows ‘Restart Manager’ API to assist in terminating any](https://docs.microsoft.com/en-us/windows/win32/rstmgr/restart-manager-portal)\nproblematic process standing in the way of encryption or further manipulation of target\nsystems. It is not uncommon for explorer.exe or other running processes to quickly exit and\nrelaunch once Ranzy’s process begins.\n\nBoth Ranzy versions analyzed appear to retain the same multithreading capabilities that first\nappeared in ThunderX. The payload will first identify the number of processors available via\n```\nGetSystemInfo() . Following this, the ransomware will leverage IoCompletionPort to\n\n```\ngenerate a queue of files which are to be encrypted. Then, the ransomware is able to\nallocate a number of threads (equal to 2x the count of processors identified). This allows for\nfairly competitive (and therefore dangerous) encryption speeds when compared to the likes\nof Maze or NetWalker.\n\n\n-----\n\n## Post Encryption Behavior\n\nRanzy’s ransom notes are deposited into each folder containing affected files/data. Across\nthe analyzed versions, these are always identified with the name readme.txt. There are\nminor variations in the ransom notes across versions of the ransomware. That being said,\nthe basic structure and content across ThunderX, Ranzy and Ranzy 1.1 are all quite similar.\n\nExamples of the Ranzy and Ranzy 1.1 ransom notes can be seen below.\n\n\n-----\n\nPerhaps the most significant difference between the ransom notes is with Ranzy 1.1, victims\nare instructed to access a TOR-based portal for payment, further instructions and “support”\n(live chat). Previous variations simply instructed victims to reach out via email for further\ninstructions.\n\nNon-compliant victims are currently being cataloged on the group’s blog, entitled “Ranzy\nLeak”. As of this writing there are 3 victims listed on the site, representing the electrical\nengineering, security & investigations, and Government administration industries.\n\n\n-----\n\n## Conclusion\n\nThe Ranzy, ThunderX and Ako family is yet another example of how nimble and aggressive\nthese threats and the actors behind them are becoming. With little to no barrier for entry\n(beyond a small investment of cash), any enterprising cybercriminal can gain access to, and\nmanage, ransomware like Ranzy, potentially causing a great deal of financial damage. As we\nknow, this damage is not limited to the direct payment of the ransom (which you should\navoid), but now also includes any penalties associated with data breaches, public posting of\nprivate data, GDPR / compliance fallout, and beyond.\n\nThese threats are very agile, and it is clear that the actors behind them are paying attention\nto the efforts on the defense side. For example, when decryptor utilities are released, they\nquickly update their code and start distributing better and stronger payloads to nullify any\nworkarounds.\n\n## Indicators of Compromise\n\n**SHA256**\n\nc4f72b292750e9332b1f1b9761d5aefc07301bc15edf31adeaf2e608000ec1c9\n\n393fd0768b24cd76ca653af3eba9bff93c6740a2669b30cf59f8a064c46437a2\n\n90691a36d1556ba7a77d0216f730d6cd9a9063e71626489094313c0afe85a939\n\nbbf122cce1176b041648c4e772b230ec49ed11396270f54ad2c5956113caf7b7\n\nade5d0fe2679fb8af652e14c40e099e0c1aaea950c25165cebb1550e33579a79\n\n**SHA1**\n\n43ccf398999f70b613e1353cfb6845ee09b393ca\n\n35a663c2ce68e48f1a6bcb71dc92a86b36d4c497\n\n38b86dacb1568af968365663c548bd9556fe0849\n\n20102532dfc58bc8256f507da4a177850f349f7a\n\n9a77e2f8bf0da35f7d84897c187e3aff322f024d\n\n**MITRE ATT&CK**\n\n[Indicator Removal on Host: File Deletion T1070.004](https://attack.mitre.org/techniques/T1107/)\n\nModify Registry [T1112](https://attack.mitre.org/techniques/T1112/)\n\n[Query Registry T1012](https://attack.mitre.org/techniques/T1012/)\n\n[System Information Discovery T1082](https://attack.mitre.org/techniques/T1082/)\n\n[Peripheral Device Discovery T1120](https://attack.mitre.org/techniques/T1120/)\n\n[Inhibit System Recovery T1490](https://attack.mitre.org/techniques/T1490/)\n\n[Create or Modify System Process: Windows Service T1031](https://attack.mitre.org/techniques/T1031/)\n\n[Exfiltration TA0010](https://attack.mitre.org/tactics/TA0010/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-18 - Ranzy Ransomware - Better Encryption Among New Features of ThunderX Derivative.pdf"
    ],
    "report_names": [
        "2020-11-18 - Ranzy Ransomware - Better Encryption Among New Features of ThunderX Derivative.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535993,
    "ts_updated_at": 1743041165,
    "ts_creation_date": 1653787202,
    "ts_modification_date": 1653787202,
    "files": {
        "pdf": "https://archive.orkl.eu/73e2f3197dc61230ebfdefb74ec3b305d9181e1f.pdf",
        "text": "https://archive.orkl.eu/73e2f3197dc61230ebfdefb74ec3b305d9181e1f.txt",
        "img": "https://archive.orkl.eu/73e2f3197dc61230ebfdefb74ec3b305d9181e1f.jpg"
    }
}