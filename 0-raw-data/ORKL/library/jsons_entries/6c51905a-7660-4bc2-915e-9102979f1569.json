{
    "id": "6c51905a-7660-4bc2-915e-9102979f1569",
    "created_at": "2023-01-12T15:08:28.126348Z",
    "updated_at": "2025-03-27T02:06:08.825497Z",
    "deleted_at": null,
    "sha1_hash": "5364edcea56a667223478dc15233d8d9a682bb68",
    "title": "2022-06-16 - Houdini is Back Delivered Through a JavaScript Dropper",
    "authors": "",
    "file_creation_date": "2022-07-02T23:12:01Z",
    "file_modification_date": "2022-07-02T23:12:01Z",
    "file_size": 683010,
    "plain_text": "# SANS ISC: Houdini is Back Delivered Through a JavaScript Dropper - SANS Internet Storm Center SANS Site Network Current Site SANS Internet Storm Center Other SANS Sites Help Graduate Degree Programs Security Training Security Certification Security Awareness Training Penetration Testing Industrial Control Systems Cyber Defense Foundations DFIR Software Security Government OnSite Training SANS ISC InfoSec Forums\n\n**[isc.sans.edu/forums/diary/Houdini+is+Back+Delivered+Through+a+JavaScript+Dropper/28746/](https://isc.sans.edu/forums/diary/Houdini+is+Back+Delivered+Through+a+JavaScript+Dropper/28746/)**\n\nHoudini is Back Delivered Through a JavaScript Dropper\n\nHoudini is a very old RAT that was discovered years ago. The first mention I found back is from 2013! Houdini is a simple remote access tool writt\n\nThe RAT implements the following commands:\n\n\n-----\n\nNothing really fancy here. Whatâ€™s more interesting is the way it is delivered to the victim. A classic technique is used: a phishing email with a ZIP a\n\nThe JavaScript is pretty well obfuscated but, once you check deeper, you quickly realize that most of the code is not used. The main function is kk\n\n\n-----\n\nThe technique used is simple: A variable is defined and set to false (example: __p_0015805216). Then code blocks are executed if the variable is\n\nJavaScript is a very beautiful/ugly language (select your best feeling) that is very permissive with the code. So, another technique is the creation o\n\n\n-----\n\nWhen I'm teaching FOR610, I like to say to students that they must find their way and go straight to the point to find what the script being analyze\n```\n$ awk '{print length, $0}' New-Order.js | sort -rn|head -1\n\n78396         return\n'dHJ5ewp2YXIgbG9uZ1RleHQxID0gImZpZ2hRWEp5WVhrdWNISnZkRzkwZVhCbExtWnZja1ZoWTJnZ1B5QkJjbkpoZVM1d2NtOTBiM1I1Y0dVdVptOXlSV0ZqYUNBOUlHWjFib\nFF... (Remaining characters removed)\n\n```\nNow, you can search for this string and find that it is just returned, again, by a simple function:\n\nThis looks like a Base64-encoded string but it won't decode \"as is\". The attacker added some bad characters that must be replaced first:\n\n\n-----\n\nThe script drops two other samples on the file system:\n```\nC:\\Windows\\System32\\wscript.exe\" //B \"C:\\Users\\admin\\AppData\\Roaming\\HUAqCSmCDP.js\n\nC:\\Windows\\System32\\wscript.exe\" \"C:\\Users\\admin\\AppData\\Local\\Temp\\hworm.vbs\n\n```\nAn interesting point: Persistence is implemented via two techniques in parallel, via the registry (HKEY_CURRENT_USER\\Software\\Microsoft\\Win\n\n[1] [https://www.virustotal.com/gui/file/402a722d58368018ffb78eda78280a3f1e6346dd8996b4e4cd442f30e429a5cf/detection](https://www.virustotal.com/gui/file/402a722d58368018ffb78eda78280a3f1e6346dd8996b4e4cd442f30e429a5cf/detection)\n\nXavier Mertens (@xme)\nXameco\nSenior ISC Handler - Freelance Cyber Security Consultant\n[PGP Key](https://keybase.io/xme/key.asc)\n\n[I will be teaching next: Reverse-Engineering Malware: Malware Analysis Tools and Techniques - SANS Amsterdam August 2022](https://www.sans.org/event/amsterdam-august-2022/course/reverse-engineering-malware-malware-analysis-tools-techniques)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-06-16 - Houdini is Back Delivered Through a JavaScript Dropper.pdf"
    ],
    "report_names": [
        "2022-06-16 - Houdini is Back Delivered Through a JavaScript Dropper.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536108,
    "ts_updated_at": 1743041168,
    "ts_creation_date": 1656803521,
    "ts_modification_date": 1656803521,
    "files": {
        "pdf": "https://archive.orkl.eu/5364edcea56a667223478dc15233d8d9a682bb68.pdf",
        "text": "https://archive.orkl.eu/5364edcea56a667223478dc15233d8d9a682bb68.txt",
        "img": "https://archive.orkl.eu/5364edcea56a667223478dc15233d8d9a682bb68.jpg"
    }
}