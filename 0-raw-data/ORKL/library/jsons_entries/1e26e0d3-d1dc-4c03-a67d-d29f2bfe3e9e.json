{
    "id": "1e26e0d3-d1dc-4c03-a67d-d29f2bfe3e9e",
    "created_at": "2023-01-12T15:03:42.133468Z",
    "updated_at": "2025-03-27T02:05:29.093102Z",
    "deleted_at": null,
    "sha1_hash": "81a6ea21b24afa0ffee8a7da9d848bc1a2ffa0d2",
    "title": "2022-03-15 - CaddyWiper- Third Wiper Malware Targeting Ukrainian Organizations",
    "authors": "",
    "file_creation_date": "2022-05-28T00:39:36Z",
    "file_modification_date": "2022-05-28T00:39:36Z",
    "file_size": 970039,
    "plain_text": "# Third Wiper Malware Targeting Ukrainian Organizations\n\n**[securityintelligence.com/posts/caddywiper-malware-targeting-ukrainian-organizations/](https://securityintelligence.com/posts/caddywiper-malware-targeting-ukrainian-organizations/)**\n\n[Home&nbsp/](https://securityintelligence.com/) [Malware](https://securityintelligence.com/category/x-force/malware-threat/)\nCaddyWiper: Third Wiper Malware Targeting Ukrainian Organizations\n\n[Malware March 15, 2022](https://securityintelligence.com/category/x-force/malware-threat/)\nBy [Christopher Del Fierro co-authored by John Dwyer 3 min read](https://securityintelligence.com/author/christopher-del-fierro/)\n\n\n-----\n\nOn March 1, 2022, ESET [reported a third destructive data wiper variant used in attacks](https://www.welivesecurity.com/2022/03/15/caddywiper-new-wiper-malware-discovered-ukraine/)\nagainst Ukrainian organizations dubbed as CaddyWiper. CaddyWiper’s method of\ndestruction is by overwriting file data with “NULL” values. This is the fourth sample of\nmalware IBM Security X-Force has released public content for which has been reportedly\n[targeted systems belonging to Ukrainian organizations (IsaacWiper,](https://securityintelligence.com/posts/new-wiper-malware-used-against-ukranian-organizations/)\n[HermeticWiper/PartyTicket). IBM Security X-Force obtained a sample of the CaddyWiper](https://securityintelligence.com/posts/new-destructive-malware-cyber-attacks-ukraine/)\nwiper and has provided the following technical analysis, indicators of compromise, and\ndetections.\n\n## CaddyWiper Analysis\n\nUpon execution, CaddyWiper first executes “DsRoleGetPrimaryDomainInformation” to\ndetermine the machine role of the system the wiper is running on. If the domain role is\n[“DsRole_RolePrimaryDomainController,” CaddyWiper terminates and does not continue with](https://docs.microsoft.com/en-us/windows/win32/api/dsrole/ne-dsrole-dsrole_machine_role)\n[any destructive functions. According to the ESET, they observed CaddyWiper being](https://twitter.com/ESETresearch/status/1503436428096716800)\n[deployed to target systems via a Domain Controller indicating the authors designed the wiper](https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-authsod/c4012a57-16a9-42eb-8f64-aa9e04698dca)\nmalware to be used in situations where the target’s Active Directory environment has been\ncompromised.\n\n_Figure 1: CaddyWiper system role check_\n\nIf the target system is not a Domain Controller, CaddyWiper begins recursively wiping all\ndata within “%SystemDrive%\\Users” including hidden and operating system files. In the\nevent a file is larger than 10 megabytes, the wiper only destroys the first 10 megabytes. If a\nfile is currently locked by another process, CaddyWiper first attempts to take ownership of\nthe file via “SeTakeOwnershipPrivilege” and then resumes wiping the file.\n\n_Figure 2: SeTakeOwnershipPrivilege attribute after running CaddyWiper on a locked file_\n\nFollowing “C:\\Users”, CaddyWiper repeats the same process for all available drives from\n“D:\\” to “Z:\\”. When all the available drives have been wiped, CaddyWiper targets wipes disk\npartitions from “\\\\.\\PHYSICALDRIVE9” to “\\\\.\\PHYSICALDRIVE0” by overwriting the first\n\n\n-----\n\n1920 bytes with NULL.\n\n## Detection\n\nIBM Security X-Force has developed the following Yara signature to help identify instances\nof the CaddyWiper malware.\n```\nrule XFTI_CaddyWiper : CaddyWiper\n{\nmeta:\nauthor = \"IBM Security X-Force\"\ndescription = \"Detects CaddyWiper\"\nthreat_type = \"Malware\"\nrule_category = \"Malware Family\"\nusage = \"Hunting and Identification\"\nhash = \"a294620543334a721a2ae8eaaf9680a0786f4b9a216d75b55cfd28f39e9430ea\"\nyara_version = \"4.0.2\"\ndate_created = \"15 March 22\"\n  strings:\n$s1 = \"DsRoleGetPrimaryDomainInformation\" ascii fullword\n$hex1 = {\nC645??43 //'C'\nC645??3A //':'\nC645??5C //'\\'\nC645??55 //'U'\nC645??73 //'s'\nC645??65 //'e'\nC645??72 //'r'\nC645??73 //'s'\n}\n$hex2 = {\nC645??44 // 'D'\nC645??65 // 'e'\nC645??76 // 'v'\nC645??69 // 'i'\nC645??63 // 'c'\nC645??65 // 'e'\nC645??49 // 'I'\nC645??6F // 'o'\nC645??43 // 'C'\nC645??6F // 'o'\nC645??6E // 'n'\nC645??74 // 't'\nC645??72 // 'r'\nC645??6F // 'o'\nC645??6C // 'l'\n}\n\n```\n\n-----\n\n```\ncondition:\nuint16(0) == 0x5A4D and all of them\n}\n\n## Indicators of Compromise\n\n```\nFile System:\n\n```\ncaddy.exe a294620543334a721a2ae8eaaf9680a0786f4b9a216d75b55cfd28f39e9430ea\n\n```\n\n## Recommendations\n\nAt this time, X-Force recommends organizations consider implementing the indicators listed\nin this report into their security operations. Additionally, global businesses should seek to\nestablish sound insight into their respective networks, supply chains, third parties, and\npartnerships that are based in, or serve in-region institutions. It is also advised that\norganizations open lines of communications between relevant information sharing entities to\nensure the receipt and exchange of actionable indicators.\n\nIf you have questions and want a deeper discussion about the malware and prevention\n[techniques, you can schedule a briefing here. Get the latest updates as more information](https://www.ibm.com/security/services/offensive-security-services?schedulerform)\n[develops on the IBM Security X-Force Exchange and the](https://exchange.xforce.ibmcloud.com/) [IBM PSIRT blog.](https://www.ibm.com/blogs/psirt/an-update-on-russia-ukraine/)\n\nIf you are experiencing cybersecurity issues or an incident, contact X-Force to help: US\nhotline 1-888-241-9812 | Global hotline (+001) 312-212-8034.\n\n[More cybersecurity threat resources can be found here.](https://www.ibm.com/security/resources/crisis-management)\n\n[Christopher Del Fierro](https://securityintelligence.com/author/christopher-del-fierro/)\nX-Force IRIS Malware Reverse Engineer\n\nChris is a seasoned malware and threat researcher, certified system security engineer, MCP,\nand ethical hacker (CEHv5). Before joining IBM, Christopher was a...\n\n\n-----\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-03-15 - CaddyWiper- Third Wiper Malware Targeting Ukrainian Organizations.pdf"
    ],
    "report_names": [
        "2022-03-15 - CaddyWiper- Third Wiper Malware Targeting Ukrainian Organizations.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535822,
    "ts_updated_at": 1743041129,
    "ts_creation_date": 1653698376,
    "ts_modification_date": 1653698376,
    "files": {
        "pdf": "https://archive.orkl.eu/81a6ea21b24afa0ffee8a7da9d848bc1a2ffa0d2.pdf",
        "text": "https://archive.orkl.eu/81a6ea21b24afa0ffee8a7da9d848bc1a2ffa0d2.txt",
        "img": "https://archive.orkl.eu/81a6ea21b24afa0ffee8a7da9d848bc1a2ffa0d2.jpg"
    }
}