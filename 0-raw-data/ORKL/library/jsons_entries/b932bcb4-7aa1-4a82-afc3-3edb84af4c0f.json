{
    "id": "b932bcb4-7aa1-4a82-afc3-3edb84af4c0f",
    "created_at": "2023-01-12T15:01:08.931247Z",
    "updated_at": "2025-03-27T02:08:40.235217Z",
    "deleted_at": null,
    "sha1_hash": "8d64e42734d5416053bb2f851b26bcdd9efaac5c",
    "title": "2020-01-23 - The Opposite of Fileless Malware - NodeJS Ransomware",
    "authors": "",
    "file_creation_date": "2022-05-28T01:28:35Z",
    "file_modification_date": "2022-05-28T01:28:35Z",
    "file_size": 3953376,
    "plain_text": "# The Opposite of Fileless Malware - NodeJS Ransomware\n\n**[dissectingmalwa.re/the-opposite-of-fileless-malware-nodejs-ransomware.html](https://dissectingmalwa.re/the-opposite-of-fileless-malware-nodejs-ransomware.html)**\n\nThu 23 January 2020 in [Ransomware](https://dissectingmalwa.re/category/ransomware.html)\n\nThis one is a few days old already but still worth a look. Have I mentioned that I hate\nJavascript?\n\nThis is not the first time that someone built a Ransomware Strain with NodeJS (check out\n[this article about Ransom32 and let's not forget about Nodersok), but it's not an everyday](https://www.bleepingcomputer.com/news/security/the-new-raa-ransomware-is-created-entirely-using-javascript/)\nsight either. This Malware Sample was first discovered by Xavier Mertens in a post to the\nSANS ISC Forum [here.](https://isc.sans.edu/forums/diary/Ransomware+in+Nodejs/25664/)\n\n**_A general disclaimer as always: downloading and running the samples linked below_**\n**_will lead to the encryption of your personal data, so be f$cking careful. Also check_**\n**_with your local laws as owning malware binaries/ sources might be illegal depending_**\n**_on where you live._**\n\n[NodeJS Ransom @ AnyRun |](https://app.any.run/tasks/f262f1ff-e0a2-44c2-8b6f-414b42343af4/) [VirusTotal |](https://www.virustotal.com/gui/file/90acae3f682f01864e49c756bc9d46f153fcc4a7e703fd1723a8aa7ec01b378c/detection) [HybridAnalysis -->](https://www.hybrid-analysis.com/sample/5e3dfe020da258c17699ee7b6ca48926d04a3c26b4643d036d27363299dc3987?environmentId=100) `sha256`\n```\n9b6681103545432cd1373492297a6a12528f327d14a7416c2b71cfdcbdafc90b\n\n```\nThe VBS \"Loader\" is 46KiB big and contains 2417 empty lines before any Code (which is not\nobfuscated at all).\n\n\n-----\n\nAs one of the first steps the Malware will download a distributable of NodeJS Version 8.x\n(which is quite old). It is also assuming the User Agent of Firefox 52.\n\nIt will add the following registry keys to gain persistence on the System. The first one will run\nthe vbs script (to prevent additional encryption it checks for AppData\\Local\\GFp0JAk\\initdone\nwhich will be created once the vbs script ran fully once), the second reg key will show the\nCLI Version of the Ransomnote prompting for the decryption key and the last one will open\nthe HTML Ransomnote.\n\nBecause the Javascript has to interact with the system components somehow the criminals\n[shipped a version of the graceful-fs npm package which is not downloaded from the Internet](https://www.npmjs.com/package/graceful-fs)\nbut rather shipped in the Script itself and written to the respective files.\n\nThe Javascript Portion requires the following dependencies: `graceful-fs, crypto, path,`\n```\nchild_process, readline, os\n\n```\n\n-----\n\nUp next it will engage a loop to kill Microsoft Word, Excel, Outlook and Autocad. (Targeting\nbusiness PCs / Workstations, no SQL or other Serives tho, so it's like not meant to infect\nservers)\n\nLooks like they implemented a custom password generator for testing purposes, so let's take\na quick look to see how terrible it is. The Length of the password is defined globally at the top\nof the VB script as 13 characters. The yellow section will set the boundaries for ASCII lower\nand upper case characters plus numbers. The variables called pCheckxxx are initialized with\n0 and will be used in the green section later.\n\nThe author is using the Randomize() function (without a defined number, so it is seeding off\nthe System timer) which is a horrible way of generating \"pseudo random numbers\". Btw. Rnd\nwill return a number less than one but but greater or equal to 0. If you would like to know\n[more about Rnd()s and Randomize()s flaws you should definitely check out this article: Link.](https://www.experts-exchange.com/articles/11114/An-Examination-of-Visual-Basic%27s-Random-Number-Generation.html)\nMoving on to the Red Section we can see how they choose their characters for Lowercase,\nUppercase and the Numbers. Funnily enough they defined an ASCII range for special\ncharacters as well but don't actually end up using it at all (which means less entropy yay) ðŸ¤“\n\nLastly the Green Section will check for atleast one Upper- Lowercase and Number in the\npassword, otherwise it will discard it and start over.\n\n\n-----\n\nAs I already mentioned this password generator was only used for testing purposes since the\nfunction call in the VB script has been commented out. This would have been a fun little\nexercise to bruteforce :D Never use Rnd() for crypto operations kids!\n\n### Work in Progress\n\nThe Public Key Blob is embedded into the Javascript code as well:\n\n\n-----\n\n```\n   BEGIN PUBLIC KEY\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA403SyYJw3sUvumo0Gsjy\\nFoPgFtOEJ4ZxIhsw9MX3\nPpM3OxQqQitQtAfaKSTYT39s9kprxuFtW6ZXB/lNUp\\nMm9IZfbYyELUMyi+zHKkIi8PKEGdASogYD84VDkVPk\naXB2YvNeyJ7Rhup2SubG\\nO7MYtOYM57TOOHT/DDCX5Q3AEXPSMvSMgPgZ6hSKuVAgOhztcvgxMH3sYNQbNwL\\\nLD1MCk6eoVDqTRvarE9IoLjdBuGhbWJQ7afWkAAEv0vriPI22F5MAhhZLhuKjCg\\nTNELFzvWQEKWsZMyZS70V\nCGqCuocrmGFPBeS4ZdHS3W94jA18a36m8V76tnlbz\\n/gnWdtY81jBPdnHiXp22tIswtrpN+5UNn7A1WHhBkfd\niyHRzTmnYmLHKHPyYkR\\nGJj74fUiAuvwlCmmE3rfwH9uBuL3v+plMCbRs3Log09Q4GyTYd2Z2OacWTE4gRCf\\\n3wCYkyeZrfXhnFmH0TGsQak0lznZBkudJOL7Ms1NUIWa1zd/gqUGROR1Mb/BYVt\\nzmBo4VMak6RCwvuXhPmR+\ngb6ul+74F0fHEsyBQoeurj9EqAVxmD4jMnzwQi1HB\\nEqOGcc2mAQvtVtgU17MQqVS3JFiYZTNn1SWuTUJCAF+\nNgVsjQuQVJZCXa2c4NL\\nK1iOlUsoOxkYTStUIdX1miUCAwEAAQ==\n-----END PUBLIC KEY----\n```\nActually the Ransomware drops two notes: The HTML File and a one similarly phrased\nversion of it in a console window:\n\n## MITRE ATT&CK\n\n_T1035 --> Service Execution --> Execution_\n\n_T1215 --> Kernel Modules and Extensions --> Persistence_\n\n_T1179 --> Hooking --> Persistence_\n\n\n-----\n\n_T1060 --> Registry Run Keys / Start Folder --> Persistence_\n\n_T1055 --> Process Injection --> Privilege Escalation_\n\n_T1179 --> Hooking --> Privilege Escalation_\n\n_T1055 --> Process Injection --> Defense Evasion_\n\n_T1112 --> Modify Registry -->Defense Evasion_\n\n_T1107 --> File Deletion --> Defense Evasion_\n\n_T1179 --> Hooking --> Credential Access_\n\n_T1012 --> Query Registry --> Discovery_\n\n_T1120 --> Peripheral Device Discovery --> Discovery_\n\n_T1057 --> Process Discovery --> Discovery_\n\n## IOCs\n\n### NodeJS Ransom\n```\nGFp0JAk.exe --> SHA256:\n3a97828f05008741097242c3e23612010c72f7b987037c30050cd283cd7cbcfb\n4cdfb03db53a05603f6a096cf477dfdc.vbs --> SHA256:\n90acae3f682f01864e49c756bc9d46f153fcc4a7e703fd1723a8aa7ec01b378c\nlLT8PCI.js --> SHA256: \n53a95c9126be8262afb0821da4d7137e6c8a4d9b363f91298249ca134d394bf4\nGFp0JAk\\node_modules\\graceful-fs\\fs.js --> SHA256:\na54b9999ae69328c2ac676e255d0f7767f2083c5c95e1db98d15ae44e3d68896\nGFp0JAk\\node_modules\\graceful-fs\\package.json --> SHA256:\n9bd1f57b72c1dede710f6f12ee3f713461d7667776d734b043884e18705505e4\nGFp0JAk\\node_modules\\graceful-fs\\graceful-fs.js --> SHA256:\nd4f59f5bea29583031919657f6a4a29554962cf48b61a6c4a5a22f37f4d3963e\nGFp0JAk\\node_modules\\graceful-fs\\legacy-streams.js --> SHA256:\n5727b9a8597dc68011961504513ca8ce7caaf6df2431b2861d4f9d7af5f9465c\nGFp0JAk\\node_modules\\graceful-fs\\polyfills.js --> SHA256:\n36b3c0109afc06172fe3a7a521700b0eb13ab58d221081c5411920b4657b5841\n\n E-Mail Addresses / Contact\n\n```\n\n-----\n\n```\nn/a\n\n### Bitcoin Address\n18aBKwKJvMCkZmpkcCbW9b9y9snAmU3kgo\n\n Ransomnote\nYour files are encrypted! Encryption was produced using a unique public key RSA-2048\ngenerated for this computer. To \ndecrypt files you need to obtain the private key.The single copy of the private key,\nwhich will allow to decrypt files,\nlocated on a remote server on the Internet.The server will destroy the key after a '\n+ tillDate + '. After that, nobody\nwill be able to restore files ...To obtain the private key for this computer, you\nneed to send\n0.4 BTC\nto bitcoin address\n18aBKwKJvMCkZmpkcCbW9b9y9snAmU3kgo\nYou can easily delete this software, but know that without it, you will never be able\nto get your original files back.\nDisable your antivirus to prevent the removal of this software.When your transaction\nwill be verified and confirmed you\nwill receive your private key.\nApproximate destruction time of your private key ' + tillDate + '\nHow to buy bitcoins\n  Xchange.cash\n  24paybank.com\n  Change.me\n  Kassa.cc\n  Change.am\n  Coinbase.com\n  more options\n  Bestchange.com\n\n```\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-01-23 - The Opposite of Fileless Malware - NodeJS Ransomware.pdf"
    ],
    "report_names": [
        "2020-01-23 - The Opposite of Fileless Malware - NodeJS Ransomware.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535668,
    "ts_updated_at": 1743041320,
    "ts_creation_date": 1653701315,
    "ts_modification_date": 1653701315,
    "files": {
        "pdf": "https://archive.orkl.eu/8d64e42734d5416053bb2f851b26bcdd9efaac5c.pdf",
        "text": "https://archive.orkl.eu/8d64e42734d5416053bb2f851b26bcdd9efaac5c.txt",
        "img": "https://archive.orkl.eu/8d64e42734d5416053bb2f851b26bcdd9efaac5c.jpg"
    }
}