{
    "id": "84f65b0e-fba5-41fd-bc4a-fb12b45bc9a1",
    "created_at": "2023-01-12T15:06:04.814574Z",
    "updated_at": "2025-03-27T02:05:47.724638Z",
    "deleted_at": null,
    "sha1_hash": "33f991b027c9839f3f2aacd394167a695e411c2d",
    "title": "2018-05-01 - Legitimate Application AnyDesk Bundled with New Ransomware Variant",
    "authors": "",
    "file_creation_date": "2022-05-27T22:19:02Z",
    "file_modification_date": "2022-05-27T22:19:02Z",
    "file_size": 604556,
    "plain_text": "# AnyDesk Bundled with New Ransomware Variant\n\n**blog.trendmicro.com/trendlabs-security-intelligence/legitimate-application-anydesk-bundled-with-new-ransomware-**\nvariant/\n\nMay 1, 2018\n\nWe recently discovered a new ransomware (Detected as\nRANSOM_BLACKHEART.THDBCAH), which drops and executes the legitimate tool known\nas AnyDesk alongside its malicious payload. This isn’t the first time that a malware abused a\nsimilar tool. TeamViewer, a tool with more than 200 million users, was abused as by a\nprevious ransomware that used the victim’s connections as a distribution method.\n\nIn this instance, however, RANSOM_BLACKHEART bundles both the legitimate program\nand the malware together instead of using AnyDesk for propagation.\n\n**Bundling a legitimate tool with ransomware**\n\nAlthough the specifics of how RANSOM_BLACKHEART enters the system remains\nunknown, we do know that users can unknowingly download the ransomware when they visit\nmalicious sites. Once downloaded, RANSOM_BLACKHEART drops and executes two files:\n\n%User Temp%\\ANYDESK.exe\n%User Temp%\\BLACKROUTER.exe\n\n[Figure 1. The files dropped by RANSOM_BLACKHEART](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2018/04/AnyDesk-1.png)\n\nFigure 1. The files dropped by RANSOM_BLACKHEART\n\n\n-----\n\nAs noted earlier, the first file contains AnyDesk, a powerful application capable of\nbidirectional remote control between different desktop operating systems, including\nWindows, macOS, Linux and FreeBSD, as well as unidirectional access on Android and iOS.\nIn addition, it can perform file transfers, provide client to client chat and can also log\nsessions. Note that the version used by the attackers is an older version of AnyDesk, and not\nthe current one.\n\n[Figure 2. The AnyDesk user interface on the sample we analyzed](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2018/04/AnyDesk-2.png)\n\nFigure 2. The AnyDesk user interface on the sample we analyzed\n\nIt will also delete shadow copies via the following process:\n\n\"cmd.exe\" /c vssadmin.exe delete shadows /all /quiet\n\nThe second file is the actual ransomware. Based on our analysis, we can determine that it's\na fairly common ransomware, with a routine that encrypts a variety of files that use different\nextensions as part of its routine. The complete list can be seen below:\n\n\n.dbf\n.doc\n.docx\n.dt\n.dwg\n.efd\n.elf\n.epf\n.erf\n.exe\n.geo\n\n\n.gif\n.grs\n.html\n.ini\n.jpeg\n.jpg\n.lgf\n.lgp\n.log\n.mdb\n\n\n.mft\n.mkv\n.mp3\n.mp4\n.mxl\n.odt\n.pdf\n.pff\n.php\n.png\n.ppt\n\n\n.pptx\n.psd\n.rar\n.rtf\n.sln\n.sql\n.sqlite\n.st\n.tiff\n.txt\n.vrp\n\n\n.webmp\n.wmv\n.xls\n.xlsx\n.xml\n.zip\n1cd\n\n\nIt will search out and encrypts all files with these extensions in the following folders:\n\n%Desktop%\n%Application Data%\n%AppDataLocal%\n%Program Data%\n%User Profile%\n%System Root%\\Users\\All Users\n%System Root%\\Users\\Default\n%System Root%\\Users\\Public\nAll Drives except for %System Root%\n\n\n-----\n\nOnce it has found and encrypted a file, it will append the .BlackRouter extension to the\naffected file. When it has accomplished its encryption routine, RANSOM_BLACKHEART will\nthen drop a ransom note, in which the attackers demand $50 or 0.006164 BTC for\ndecryption, in the following locations:\n\n{All Drives}:\\ReadME-BlackRouter.txt\n%Desktop%\\ReadME-BlackRouter.txt\n\n[Figure 3. Screenshot of the ransom note](https://blog.trendmicro.com/content/dam/trendmicro/global/en/migrated/security-intelligence-migration-spreadsheet/trendlabs-security-intelligence/2018/04/AnyDesk-3.png)\n\nFigure 3. Screenshot of the ransom note\n\nWe believe bundling AnyDesk with the ransomware might be an evasion tactic. Once\nRANSOM_BLACKHEART is downloaded, AnyDesk will start running in the affected system’s\nbackground — masking the true purpose of the ransomware while it performs its encryption\nroutine. Cybercriminals may be experimenting with AnyDesk as an alternative because\nTeamviewer’s developers have acknowledged its abuse, and have also included some antimalware protection in some of its tools.\n\nNote that we found another malicious sample that is very similar, but it's bundled with a\nkeylogger (Detected as TSPY_KEYLOGGER.THDBEAH) instead of ransomware. AnyDesk\nhas acknowledged the existence of the ransomware, and has stated that they will be\ndiscussing possible steps they can take.\n\n**Trend Micro Solutions**\n\nTrend Micro XGen™ security provides a cross-generational blend of threat defense\n[techniques against a full range of threats for data centers,](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security-data-center.html) [cloud environments,](https://blog.trendmicro.com/en_us/business/products/hybrid-cloud/deep-security-for-cloud.html) [networks,](https://blog.trendmicro.com/en_us/business/products/network.html)\n[and endpoints. It features high-fidelity machine learning to secure](https://blog.trendmicro.com/en_us/business/products/user-protection.html)\nthe [gateway,](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html) [endpoint data and applications, and protects physical, virtual, and cloud](https://blog.trendmicro.com/en_us/business/products/user-protection/sps.html)\nworkloads. With capabilities like web/URL filtering, behavioral analysis, and custom\nsandboxing, XGen™ protects against today’s purpose-built threats that bypass traditional\ncontrols, exploit known, unknown, or undisclosed vulnerabilities, and either steal or encrypt\npersonally-identifiable data. Smart, optimized, and connected, XGen™ powers Trend Micro’s\nsuite of security solutions: Hybrid Cloud Security, User Protection, and Network Defense.\n\n_Related Hash detected as RANSOM_BLACKHEART.THDBCAH:_\n\n85173ef5572f316df839e63b4e1526e97e5f123ae73f898b872baa6a5a9711f\n\nRansomware\n\n\n-----\n\nWe recently discovered a new ransomware (Detected as\nRANSOM_BLACKHEART.THDBCAH), which drops and executes the legitimate tool known\nas AnyDesk alongside its malicious payload.\n\nBy: Raphael Centeno May 01, 2018 Read time: ( words)\n\nContent added to Folio\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-05-01 - Legitimate Application AnyDesk Bundled with New Ransomware Variant.pdf"
    ],
    "report_names": [
        "2018-05-01 - Legitimate Application AnyDesk Bundled with New Ransomware Variant.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535964,
    "ts_updated_at": 1743041147,
    "ts_creation_date": 1653689942,
    "ts_modification_date": 1653689942,
    "files": {
        "pdf": "https://archive.orkl.eu/33f991b027c9839f3f2aacd394167a695e411c2d.pdf",
        "text": "https://archive.orkl.eu/33f991b027c9839f3f2aacd394167a695e411c2d.txt",
        "img": "https://archive.orkl.eu/33f991b027c9839f3f2aacd394167a695e411c2d.jpg"
    }
}