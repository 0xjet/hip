{
    "id": "5af8d6c8-1860-478c-8416-9ebe72a5f902",
    "created_at": "2023-01-12T15:02:03.388568Z",
    "updated_at": "2025-03-27T02:16:16.813246Z",
    "deleted_at": null,
    "sha1_hash": "b080a157d87008950dfee76d7079b9ebd2728f4f",
    "title": "2018-11-14 - A new exploit for zero-day vulnerability CVE-2018-8589",
    "authors": "",
    "file_creation_date": "2022-05-28T05:09:25Z",
    "file_modification_date": "2022-05-28T05:09:25Z",
    "file_size": 935077,
    "plain_text": "# A new exploit for zero-day vulnerability CVE-2018-8589\n\n**[securelist.com/a-new-exploit-for-zero-day-vulnerability-cve-2018-8589/88845/](https://securelist.com/a-new-exploit-for-zero-day-vulnerability-cve-2018-8589/88845/)**\n\n[Research](https://securelist.com/category/research/)\n\n[Research](https://securelist.com/category/research/)\n\n14 Nov 2018\n\nminute read\n\n\n-----\n\nAuthors\n\nBoris Larin\n\nAnton Ivanov\n\n[Vladislav Stolyarov](https://securelist.com/author/vladislavstolyarov/)\n\nYesterday, Microsoft published its security bulletin, which patches a vulnerability discovered\nby our technologies. We reported it to Microsoft on October 17, 2018. The company\nconfirmed the vulnerability and assigned it CVE-2018-8589.\n\n\n-----\n\nIn October 2018, our Automatic Exploit Prevention (AEP) systems detected an attempt to\nexploit a vulnerability in Microsoft’s Windows operating system. Further analysis revealed a\nzero-day vulnerability in win32k.sys. The exploit was executed by the first stage of a malware\ninstaller in order to gain the necessary privileges for persistence on the victim’s system. So\nfar, we have detected a very limited number of attacks using this vulnerability. The victims\nare located in the Middle East.\n\nKaspersky Lab products detected this exploit proactively using the following technologies:\n\nBehavioral Detection Engine and Automatic Exploit Prevention for endpoints\nAdvanced Sandboxing and Anti-Malware Engine for Kaspersky Anti Targeted Attack\nPlatform (KATA)\n\nKaspersky Lab verdicts for the artifacts in this campaign are:\n\nHEUR:Exploit.Win32.Generic\nHEUR:Trojan.Win32.Generic\nPDM:Exploit.Win32.Generic\n\nMore information about the attack is available to customers of Kaspersky Intelligence\nReports. Contact: intelreports@kaspersky.com\n\n## Technical details\n\nCVE-2018-8589 is a race condition present in win32k!xxxMoveWindow due to improper\nlocking of messages sent synchronously between threads.\n\nThe exploit uses the vulnerability by creating two threads with a class and associated\nwindow and moves the window of the opposite thread inside the callback of a\nWM_NCCALCSIZE message in a window procedure that is common to both threads.\n\n\n-----\n\n_WM_NCCALCSIZE message in win32k!xxxCalcValidRects_\n\nTermination of the opposite thread on the maximum level of recursion inside the\nWM_NCCALCSIZE callback will cause asynchronous copyin of the lParam structure\ncontrolled by the attacker.\n\n_Lack of proper message locking between win32k!xxxCalcValidRects and_\n\n_win32k!SfnINOUTNCCALCSIZE_\n\nThe exploit populates lParam with pointers to the shellcode and after being successfully\ncopyied to kernel inside win32k!SfnINOUTNCCALCSIZE, the kernel jumps to the user level.\nThe exploit found in the wild only targeted 32-bit versions of Windows 7.\n\n\n-----\n\n_BSOD on an up-to-date version of Windows 7 with our proof of concept_\n\nAs always, we provided Microsoft with a proof of concept for this vulnerability along with wellwritten source code.\n\n[Microsoft Windows](https://securelist.com/tag/microsoft-windows/)\n[Proof-of-Concept](https://securelist.com/tag/proof-of-concept/)\n[Vulnerabilities and exploits](https://securelist.com/tag/vulnerabilities-and-exploits/)\n[Zero-day vulnerabilities](https://securelist.com/tag/zero-day-vulnerabilities/)\n\nAuthors\n\nBoris Larin\n\nAnton Ivanov\n\n\n-----\n\n[Vladislav Stolyarov](https://securelist.com/author/vladislavstolyarov/)\n\nA new exploit for zero-day vulnerability CVE-2018-8589\n\nYour email address will not be published. Required fields are marked *\n\nGReAT webinars\n\n13 May 2021, 1:00pm\n\n### GReAT Ideas. Balalaika Edition\n\n26 Feb 2021, 12:00pm\n17 Jun 2020, 1:00pm\n26 Aug 2020, 2:00pm\n22 Jul 2020, 2:00pm\nFrom the same authors\n\n### MysterySnail attacks with Windows zero-day\n\n\n-----\n\n### Zero-day vulnerability in Desktop Window Manager (CVE-2021-28310) used in the wild\n\n Operation PowerFall: CVE-2020-0986 and variants\n\n\n-----\n\n### Internet Explorer and Windows zero-day exploits used in Operation PowerFall\n\n GReAT thoughts: Awesome IDA Pro plugins\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\nReports\n\n### APT trends report Q1 2022\n\nThis is our latest summary of advanced persistent threat (APT) activity, focusing on events\nthat we observed during Q1 2022.\n\n### Lazarus Trojanized DeFi app for delivering malware\n\nWe recently discovered a Trojanized DeFi application that was compiled in November 2021.\nThis application contains a legitimate program called DeFi Wallet that saves and manages a\ncryptocurrency wallet, but also implants a full-featured backdoor.\n\n### MoonBounce: the dark side of UEFI firmware\n\n\n-----\n\nAt the end of 2021, we inspected UEFI firmware that was tampered with to embed a\nmalicious code we dub MoonBounce. In this report we describe how the MoonBounce\nimplant works and how it is connected to APT41.\n\n### The BlueNoroff cryptocurrency hunt is still on\n\nIt appears that BlueNoroff shifted focus from hitting banks and SWIFT-connected servers to\nsolely cryptocurrency businesses as the main source of the group’s illegal income.\n\nSubscribe to our weekly e-mails\n\nThe hottest research right in your inbox\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-11-14 - A new exploit for zero-day vulnerability CVE-2018-8589.pdf"
    ],
    "report_names": [
        "2018-11-14 - A new exploit for zero-day vulnerability CVE-2018-8589.pdf"
    ],
    "threat_actors": [
        {
            "id": "1bdb91cf-f1a6-4bed-8cfa-c7ea1b635ebd",
            "created_at": "2022-10-25T16:07:23.766784Z",
            "updated_at": "2025-03-27T02:02:09.971636Z",
            "deleted_at": null,
            "main_name": "Bluenoroff",
            "aliases": [
                "APT 38",
                "ATK 117",
                "Alluring Pisces",
                "Black Alicanto",
                "Bluenoroff",
                "CTG-6459",
                "Copernicium",
                "Nickel Gladstone",
                "Sapphire Sleet",
                "Selective Pisces",
                "Stardust Chollima",
                "T-APT-15",
                "TA444",
                "TAG-71",
                "TEMP.Hermit"
            ],
            "source_name": "ETDA:Bluenoroff",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f426f0a0-faef-4c0e-bcf8-88974116c9d0",
            "created_at": "2022-10-25T15:50:23.240383Z",
            "updated_at": "2025-03-27T02:00:55.404232Z",
            "deleted_at": null,
            "main_name": "APT38",
            "aliases": [
                "APT38",
                "NICKEL GLADSTONE",
                "BeagleBoyz",
                "Bluenoroff",
                "Stardust Chollima",
                "Sapphire Sleet",
                "COPERNICIUM"
            ],
            "source_name": "MITRE:APT38",
            "tools": [
                "ECCENTRICBANDWAGON",
                "HOPLIGHT",
                "Mimikatz",
                "KillDisk",
                "DarkComet"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "8bc1a044-a23b-4904-903c-13f463605cb3",
            "created_at": "2024-05-01T02:03:08.136237Z",
            "updated_at": "2025-03-27T02:05:17.415795Z",
            "deleted_at": null,
            "main_name": "NICKEL GLADSTONE",
            "aliases": [
                "Bluenoroff ",
                "CTG-6459 ",
                "Citrine Sleet ",
                "HIDDEN COBRA ",
                "Lazarus Group",
                "Sapphire Sleet ",
                "Stardust Chollima ",
                "APT38 "
            ],
            "source_name": "Secureworks:NICKEL GLADSTONE",
            "tools": [
                " Bankshot",
                " CATCH22",
                " CCGC_Proxy",
                " Cur1Agent",
                " Ratankba",
                " Server_TrafficForwarder",
                " Wcry",
                "AlphaNC"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "4c68ccd0-caba-4189-9ead-86ac4c2d9b70",
            "created_at": "2024-05-01T02:03:07.930196Z",
            "updated_at": "2025-03-27T02:05:17.251237Z",
            "deleted_at": null,
            "main_name": "BRONZE ATLAS",
            "aliases": [
                "Axiom",
                "BARIUM ",
                "Blackfly ",
                "CTG-2633",
                "GREF",
                "Group 72 ",
                "Red Kelpie ",
                "TG-2633 ",
                "Wicked Panda ",
                "Winnti",
                "APT41 "
            ],
            "source_name": "Secureworks:BRONZE ATLAS",
            "tools": [
                " CCleaner v5.33 backdoor",
                " ChinaChopper",
                " Cobalt Strike",
                " Dicey MSDN",
                " ForkPlayground",
                " HUC Proxy Malware (Htran)",
                " Mimikatz",
                " PipeMon",
                " PlugX",
                " PortReuse",
                " Powershell Empire",
                " RCMD",
                " RbDoor",
                " SPEEDBOAT",
                " ShadowPad",
                " Sidewalk",
                " Speculoos",
                " TeamViewer",
                " Winnkit",
                " Winnti",
                " reg save",
                " vssadmin",
                "Acehash"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c0cedde3-5a9b-430f-9b77-e6568307205e",
            "created_at": "2022-10-25T16:07:23.528994Z",
            "updated_at": "2025-03-27T02:02:09.847683Z",
            "deleted_at": null,
            "main_name": "DarkHotel",
            "aliases": [
                "APT-C-06",
                "ATK 52",
                "CTG-1948",
                "Dubnium",
                "Fallout Team",
                "Higaisa",
                "Luder",
                "Operation DarkHotel",
                "Operation Daybreak",
                "Operation Inexsmar",
                "Operation PowerFall",
                "Operation The Gh0st Remains the Same",
                "SIG25",
                "Shadow Crane",
                "T-APT-02",
                "Tungsten Bridge",
                "Zigzag Hail"
            ],
            "source_name": "ETDA:DarkHotel",
            "tools": [
                "Asruex",
                "DarkHotel",
                "DmaUp3.exe",
                "GreezeBackdoor",
                "Karba",
                "Nemain",
                "Nemim",
                "Ramsay",
                "Retro",
                "Tapaoux",
                "Trojan.Win32.Karba.e",
                "Virus.Win32.Pioneer.dx",
                "igfxext.exe",
                "msieckc.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "4d5f939b-aea9-4a0e-8bff-003079a261ea",
            "created_at": "2023-01-06T13:46:39.04841Z",
            "updated_at": "2025-03-27T02:00:02.985296Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "G0096",
                "Grayfly",
                "BARIUM",
                "BRONZE ATLAS",
                "BRONZE EXPORT",
                "Red Kelpie",
                "HOODOO",
                "Brass Typhoon",
                "TA415",
                "WICKED SPIDER",
                "WICKED PANDA",
                "G0044",
                "Earth Baku"
            ],
            "source_name": "MISPGALAXY:APT41",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e698860d-57e8-4780-b7c3-41e5a8314ec0",
            "created_at": "2022-10-25T15:50:23.287929Z",
            "updated_at": "2025-03-27T02:00:55.43005Z",
            "deleted_at": null,
            "main_name": "APT41",
            "aliases": [
                "APT41",
                "Wicked Panda",
                "Brass Typhoon",
                "BARIUM"
            ],
            "source_name": "MITRE:APT41",
            "tools": [
                "ASPXSpy",
                "BITSAdmin",
                "PlugX",
                "Impacket",
                "gh0st RAT",
                "netstat",
                "PowerSploit",
                "ZxShell",
                "KEYPLUG",
                "ipconfig",
                "sqlmap",
                "China Chopper",
                "ShadowPad",
                "MESSAGETAP",
                "Mimikatz",
                "certutil",
                "njRAT",
                "Cobalt Strike",
                "pwdump",
                "BLACKCOFFEE",
                "ROCKBOOT",
                "dsquery",
                "Winnti for Linux",
                "DUSTTRAP",
                "Derusbi",
                "ftp"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535723,
    "ts_updated_at": 1743041776,
    "ts_creation_date": 1653714565,
    "ts_modification_date": 1653714565,
    "files": {
        "pdf": "https://archive.orkl.eu/b080a157d87008950dfee76d7079b9ebd2728f4f.pdf",
        "text": "https://archive.orkl.eu/b080a157d87008950dfee76d7079b9ebd2728f4f.txt",
        "img": "https://archive.orkl.eu/b080a157d87008950dfee76d7079b9ebd2728f4f.jpg"
    }
}