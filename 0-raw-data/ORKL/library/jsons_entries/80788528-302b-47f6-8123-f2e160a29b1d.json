{
    "id": "80788528-302b-47f6-8123-f2e160a29b1d",
    "created_at": "2022-10-25T16:48:13.365199Z",
    "updated_at": "2025-03-27T02:17:23.123976Z",
    "deleted_at": null,
    "sha1_hash": "ec0ff900599235d4e4103a9c6ea980ff54cc0a2c",
    "title": "Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets",
    "authors": "Symantec",
    "file_creation_date": "2022-05-01T13:19:47Z",
    "file_modification_date": "2022-05-01T13:19:47Z",
    "file_size": 83116,
    "plain_text": "# Stonefly: North Korea-linked Spying Operation Continues to Hit High-value Targets\n\n**[symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/stonefly-north-korea-espionage)**\n\nThe North Korean-linked Stonefly group is continuing to mount espionage attacks against\nhighly specialized engineering companies with a likely goal of obtaining sensitive intellectual\nproperty.\n\nStonefly specializes in mounting highly selective targeted attacks against targets that could\nyield intelligence to assist strategically important sectors such as energy, aerospace, and\nmilitary equipment. Virtually all of the technologies it appears to be interested in have\nmilitary as well as civilian uses and some could have applications in the development of\nadvanced weaponry.\n\n## History of ambitious attacks\n\nStonefly (aka DarkSeoul, BlackMine, Operation Troy, and Silent Chollima) first came to\nnotice in July 2009, when it mounted distributed denial-of-service (DDoS) attacks against a\nnumber of South Korean, U.S. government, and financial websites.\n\n[It reappeared again in 2011, when it launched more DDoS attacks, but also revealed an](https://www.symantec.com/connect/blogs/backdoorprioxerinf-accidentally-stealthiest-file-infector-ever)\nespionage element to its attacks when it was found to be using a sophisticated backdoor\nTrojan (Backdoor.Prioxer) against selected targets.\n\n[In March 2013, the group was linked to the Jokra (Tojan.Jokra) disk-wiping attacks against a](https://www.symantec.com/connect/blogs/south-korean-banks-and-broadcasting-organizations-suffer-major-damage-cyberattack)\nnumber of South Korean banks and broadcasters. Three months later, the group was\n[involved in a string of DDoS attacks against South Korean government websites.](https://www.symantec.com/connect/blogs/four-years-darkseoul-cyberattacks-against-south-korea-continue-anniversary-korean-war)\n\nIn recent years, the group’s capabilities have grown markedly and, since at least 2019\nSymantec has seen its focus shift solely to espionage operations against select, high-value\ntargets. It now appears to specialize in targeting organizations that hold classified or highly\nsensitive information or intellectual property. Stonefly’s operations appear to be part of a\nbroader North Korean-sponsored campaign to acquire information and intellectual property,\nwith Operation Dream Job, a more wider-ranging trawl across multiple sectors, being carried\nout by another North Korean group, Pompilus.\n\n## Latest target\n\n[The most recent attack discovered by Symantec, a division of Broadcom Software, was](https://software.broadcom.com/)\nagainst an engineering firm that works in the energy and military sectors. The attackers\n[breached the organization in February 2022, most likely by exploiting the Log4j vulnerability](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/apache-log4j-zero-day)\n\n\n-----\n\n(CVE-2021-44228) vulnerability on a public-facing VMware View server. The attackers then\nmoved across the network and compromised 18 other computers.\n\n**17 hours later: Shortly after compromising the initial server, the attackers installed an**\nupdated version of Stonefly’s Backdoor.Preft malware (aka Dtrack, Valefor). The attackers\nthen used a masqueraded version (file name: pvhost.exe) of PuTTY’s PSCP command line\napplication, presumably to exfiltrate data from the infected machine. Shortly after PSCP was\nexecuted, the credential-dumping tool Mimikatz (masquerading under the file name pl.exe)\nwas run.\n\n**[Day 2: Malicious activity resumed when 3proxy tiny proxy server, a publicly available proxy](https://github.com/3proxy/3proxy)**\ntool (file name: svhost.exe) was executed. Use of this tool continued for the next four days. A\nsecond suspected proxy tool was installed two days into this four day period (file name:\ntapi.exe). Several hours afterwards, a copy of the Preft backdoor (file name: svchost.exe) was\n[installed. Two days later, WinSCP, an open-source SSH file-transfer tool was used,](https://winscp.net/)\npresumably to exfiltrate or upload data to the compromised computer.\n\n**Day 3: The next phase of the intrusion began on the following day, when Preft was executed**\nand the attackers began moving latterly across the organization’s network, using InvokeTheHash, a publicly available PowerShell pass-the-hash utility (file name: rev.ps1), and\n[wmiexec.py, a publicly available Impacket tool used to run WMI commands (file name:](https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py)\nnotepad.exe).\n\n## Updated Preft backdoor\n\nThe attackers used an updated version of Stonefly’s custom Preft backdoor. Analysis of the\nbackdoor revealed that it is a multistage tool:\n\nStage 1 is the main binary. A python script is used to unpack the binary and shellcode.\n\nStage 2 is shellcode. It performs the following actions:\n\nSleeps for 19,999 seconds, probably in an attempt to evade sandbox detection\nOpens a mutex, with the name specified in the Stage 3 shellcode\nInstead of loading an executable file, it starts Internet Explorer (iexplore.exe) or\nexplorer.exe and injects the Stage 3 shellcode into either. It sets up a named pipe\n(\"\\.\\pipe\\pipe\") for communication. The file name of the main binary is sent over the\npipe.\n\nStage 3 is more shellcode.\n\nStage 4 is the payload. It is an HTTP remote access tool (RAT) that supports various\ncommands, including:\n\n1. Download (Download a file and save locally)\n\n\n-----\n\n2. Upload (Upload a file to a C&C server)\n3. Set Interval (Change C&C server query interval - in minutes)\n4. Shell Execute (Execute a command in the shell)\n\n5. Download Plugin\n6. Update (Download a new version and replace)\n\n7. Info (Return debug information about the current infection)\n8. Uninstall\n9. Download Executable\n\nThe malware can support four different kinds of plugins: executable files, VBS, BAT, and\nshellcode. It supports three different persistence modes: Startup_LNK, Service, Registry, and\nTask Scheduler.\n\n## Custom information stealer\n\nAlong with the Preft backdoor, Stonefly also deployed what appears to be a custom developed\ninformation stealer (infostealer). Analysis of this malware revealed that it is a three-staged\nthreat. The main binary extracts and decrypts the encrypted shellcode with a modified RC4\nalgorithm.\n\nStage 2 is shellcode which retrieves the payload and decrypts it with the same modified RC4\nalgorithm. The decrypted payload is an executable file that is loaded in-memory. It is\ndesigned to search the infected computer for files using pre-configured parameters. These\nare then copied to temporary files before being copied to a single .zip file and the temporary\nfiles are removed. The ZIP file path is %TEMP/~[XXXXXXXX].tmp, where XXXXXXXX is a\nsimple hash of the computer name (eight uppercase hex digits).\n\nCuriously, this ZIP file is not automatically exfiltrated. It is possible that the exfiltration\nfunctionality was removed and the attackers planned to use an alternative means of\nexfiltration.\n\n## High-value targets\n\nWhile Stonefly’s tools and tactics continue to evolve, there are some common threads\nbetween this recent activity and previous attacks, such as its ongoing development of the\nPreft backdoor and heavy reliance on open-source tools.\n\nThe group’s capabilities and its narrow focus on acquiring sensitive information make it one\nof the most potent North Korean cyber threat actors operating today.\n\n## Protection/Mitigation\n\n[For the latest protection updates, please visit the Symantec Protection Bulletin.](https://www.broadcom.com/support/security-center/protection-bulletin)\n\n\n-----\n\n## Indicators of Compromise\n\nIf an IOC is malicious and the file is available to us, Symantec Endpoint products will detect\nand block that file.\n\n## About the Author\n\n### Threat Hunter Team\n\n**Symantec**\n\nThe Threat Hunter Team is a group of security experts within Symantec whose mission is to\ninvestigate targeted attacks, drive enhanced protection in Symantec products, and offer\nanalysis that helps customers respond to attacks.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "d63ae2b7-445f-460d-965d-2676dacdb6de",
            "created_at": "2022-10-25T15:59:19.552139Z",
            "updated_at": "2022-10-25T15:59:19.552139Z",
            "deleted_at": null,
            "name": "APTnotes",
            "url": "https://github.com/aptnotes/data",
            "description": "APTnotes data",
            "reports": null
        }
    ],
    "references": [
        "https://app.box.com/s/aaubak30ry3tyox9elzknurce4by7lxq"
    ],
    "report_names": [
        "Symantec_Stonefly-North Korea-Continues-High-value-Targets(04-27-2022)"
    ],
    "threat_actors": [
        {
            "id": "838f6ced-12a4-4893-991a-36d231d96efd",
            "created_at": "2022-10-25T15:50:23.347455Z",
            "updated_at": "2025-03-27T02:00:55.449316Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "Andariel",
                "Silent Chollima",
                "PLUTONIUM",
                "Onyx Sleet"
            ],
            "source_name": "MITRE:Andariel",
            "tools": [
                "Rifdoor",
                "gh0st RAT"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "110e7160-a8cc-4a66-8550-f19f7d418117",
            "created_at": "2023-01-06T13:46:38.427592Z",
            "updated_at": "2025-03-27T02:00:02.830659Z",
            "deleted_at": null,
            "main_name": "Silent Chollima",
            "aliases": [
                "Subgroup: Andariel",
                "Onyx Sleet",
                "PLUTONIUM",
                "OperationTroy",
                "Guardian of Peace",
                "GOP",
                "WHOis Team",
                "Andariel"
            ],
            "source_name": "MISPGALAXY:Silent Chollima",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "4a502340-ae29-4a3a-8142-7fbbc2ec79b5",
            "created_at": "2024-05-01T02:03:08.138302Z",
            "updated_at": "2025-03-27T02:05:17.416542Z",
            "deleted_at": null,
            "main_name": "NICKEL HYATT",
            "aliases": [
                "Dark Seoul",
                "Jumpy Pisces ",
                "Onyx Sleet ",
                "RIFLE Campaign",
                "Silent Chollima ",
                "Andariel"
            ],
            "source_name": "Secureworks:NICKEL HYATT",
            "tools": [
                " DTrack",
                " Rifle",
                " UnitBot",
                " Valefor",
                "ActiveX 0-day"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "68cc6e37-f16d-4995-a75b-5e8e2a6cbb3d",
            "created_at": "2024-05-01T02:03:07.943593Z",
            "updated_at": "2025-03-27T02:05:17.259709Z",
            "deleted_at": null,
            "main_name": "BRONZE EDISON",
            "aliases": [
                "DarkSeoul",
                "Maverick Panda ",
                "Sykipot ",
                "TG-0623 ",
                "getkys",
                "APT4 "
            ],
            "source_name": "Secureworks:BRONZE EDISON",
            "tools": [
                " Wkysol",
                " ZxPortMap",
                "Gh0st RAT"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a2b92056-9378-4749-926b-7e10c4500dac",
            "created_at": "2023-01-06T13:46:38.430595Z",
            "updated_at": "2025-03-27T02:00:02.831633Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "Operation DarkSeoul",
                "APT38",
                "ATK117",
                "DEV-1222",
                "G0032",
                "APT 38",
                "Stardust Chollima",
                "APT-C-26",
                "ATK3",
                "Diamond Sleet",
                "Hidden Cobra",
                "Unit 121",
                "Subgroup: Bluenoroff",
                "NICKEL GLADSTONE",
                "DEV-0139",
                "Andariel",
                "Operation Troy",
                "COVELLITE",
                "TA404",
                "Lazarus group",
                "Dark Seoul",
                "G0082",
                "NewRomanic Cyber Army Team",
                "Bluenoroff",
                "Appleworm",
                "Nickel Academy",
                "COPERNICIUM",
                "Hastati Group",
                "Bureau 121",
                "Operation AppleJeus",
                "Whois Hacking Team",
                "Citrine Sleet",
                "Sapphire Sleet",
                "Group 77",
                "Labyrinth Chollima",
                "Operation GhostSecret",
                "BeagleBoyz"
            ],
            "source_name": "MISPGALAXY:Lazarus Group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bc6e3644-3249-44f3-a277-354b7966dd1b",
            "created_at": "2022-10-25T16:07:23.760559Z",
            "updated_at": "2025-03-27T02:02:09.968605Z",
            "deleted_at": null,
            "main_name": "Andariel",
            "aliases": [
                "APT 45",
                "Andariel",
                "Jumpy Pisces",
                "Onyx Sleet",
                "Operation BLACKMINE",
                "Operation BLACKSHEEP/Phase 3.",
                "Operation Blacksmith",
                "Operation DESERTWOLF/Phase 3",
                "Operation GHOSTRAT",
                "Operation GoldenAxe",
                "Operation INITROY/Phase 1",
                "Operation INITROY/Phase 2",
                "Operation Mayday",
                "Operation VANXATM",
                "Operation XEDA",
                "Plutonium",
                "Silent Chollima",
                "Stonefly"
            ],
            "source_name": "ETDA:Andariel",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f32df445-9fb4-4234-99e0-3561f6498e4e",
            "created_at": "2022-10-25T16:07:23.756373Z",
            "updated_at": "2025-03-27T02:02:09.966155Z",
            "deleted_at": null,
            "main_name": "Lazarus Group",
            "aliases": [
                "APT-C-26",
                "ATK 3",
                "Appleworm",
                "Citrine Sleet",
                "DEV-0139",
                "Diamond Sleet",
                "Gleaming Pisces",
                "Gods Apostles",
                "Gods Disciples",
                "Group 77",
                "Guardians of Peace",
                "Hastati Group",
                "Hidden Cobra",
                "ITG03",
                "Jade Sleet",
                "Labyrinth Chollima",
                "Lazarus Group",
                "NewRomanic Cyber Army Team",
                "Operation 99",
                "Operation AppleJeus",
                "Operation AppleJeus sequel",
                "Operation Blockbuster: Breach of Sony Pictures Entertainment",
                "Operation CryptoCore",
                "Operation Dream Job",
                "Operation Dream Magic",
                "Operation Flame",
                "Operation GhostSecret",
                "Operation In(ter)caption",
                "Operation LolZarus",
                "Operation Marstech Mayhem",
                "Operation No Pineapple!",
                "Operation North Star",
                "Operation Phantom Circuit",
                "Operation Sharpshooter",
                "Operation Ten Days of Rain / DarkSeoul",
                "Operation Troy",
                "SectorA01",
                "Slow Pisces",
                "TA404",
                "TraderTraitor",
                "UNC2970",
                "UNC4034",
                "UNC4736",
                "UNC4899",
                "UNC577",
                "Whois Hacking Team"
            ],
            "source_name": "ETDA:Lazarus Group",
            "tools": [
                "3CX Backdoor",
                "3Rat Client",
                "3proxy",
                "AIRDRY",
                "ARTFULPIE",
                "ATMDtrack",
                "AlphaNC",
                "Alreay",
                "Andaratm",
                "AngryRebel",
                "AppleJeus",
                "Aryan",
                "AuditCred",
                "BADCALL",
                "BISTROMATH",
                "BLINDINGCAN",
                "BTC Changer",
                "BUFFETLINE",
                "BanSwift",
                "Bankshot",
                "Bitrep",
                "Bitsran",
                "BlindToad",
                "Bookcode",
                "BootWreck",
                "BottomLoader",
                "Brambul",
                "BravoNC",
                "Breut",
                "COLDCAT",
                "COPPERHEDGE",
                "CROWDEDFLOUNDER",
                "Castov",
                "CheeseTray",
                "CleanToad",
                "ClientTraficForwarder",
                "CollectionRAT",
                "Concealment Troy",
                "Contopee",
                "CookieTime",
                "Cyruslish",
                "DAVESHELL",
                "DBLL Dropper",
                "DLRAT",
                "DRATzarus",
                "DRATzarus RAT",
                "Dacls",
                "Dacls RAT",
                "DarkComet",
                "DarkKomet",
                "DeltaCharlie",
                "DeltaNC",
                "Dembr",
                "Destover",
                "DoublePulsar",
                "Dozer",
                "Dtrack",
                "Duuzer",
                "DyePack",
                "ECCENTRICBANDWAGON",
                "ELECTRICFISH",
                "Escad",
                "EternalBlue",
                "FALLCHILL",
                "FYNLOS",
                "FallChill RAT",
                "Farfli",
                "Fimlis",
                "FoggyBrass",
                "FudModule",
                "Fynloski",
                "Gh0st RAT",
                "Ghost RAT",
                "Gopuram",
                "HARDRAIN",
                "HIDDEN COBRA RAT/Worm",
                "HLOADER",
                "HOOKSHOT",
                "HOPLIGHT",
                "HOTCROISSANT",
                "HOTWAX",
                "HTTP Troy",
                "Hawup",
                "Hawup RAT",
                "Hermes",
                "HotCroissant",
                "HotelAlfa",
                "Hotwax",
                "HtDnDownLoader",
                "Http Dr0pper",
                "ICONICSTEALER",
                "Joanap",
                "Jokra",
                "KANDYKORN",
                "KEYMARBLE",
                "Kaos",
                "KillDisk",
                "KillMBR",
                "Koredos",
                "Krademok",
                "LIGHTSHIFT",
                "LIGHTSHOW",
                "LOLBAS",
                "LOLBins",
                "Lazarus",
                "LightlessCan",
                "Living off the Land",
                "MATA",
                "MBRkiller",
                "MagicRAT",
                "Manuscrypt",
                "Mimail",
                "Mimikatz",
                "Moudour",
                "Mydoom",
                "Mydoor",
                "Mytob",
                "NACHOCHEESE",
                "NachoCheese",
                "NestEgg",
                "NickelLoader",
                "NineRAT",
                "Novarg",
                "NukeSped",
                "OpBlockBuster",
                "PCRat",
                "PEBBLEDASH",
                "PLANKWALK",
                "POOLRAT",
                "PSLogger",
                "PhanDoor",
                "Plink",
                "PondRAT",
                "PowerBrace",
                "PowerRatankba",
                "PowerShell RAT",
                "PowerSpritz",
                "PowerTask",
                "Preft",
                "ProcDump",
                "Proxysvc",
                "PuTTY Link",
                "QUICKRIDE",
                "QUICKRIDE.POWER",
                "Quickcafe",
                "QuiteRAT",
                "R-C1",
                "ROptimizer",
                "Ratabanka",
                "RatabankaPOS",
                "Ratankba",
                "RatankbaPOS",
                "RawDisk",
                "RedShawl",
                "Rifdoor",
                "Rising Sun",
                "Romeo-CoreOne",
                "RomeoAlfa",
                "RomeoBravo",
                "RomeoCharlie",
                "RomeoCore",
                "RomeoDelta",
                "RomeoEcho",
                "RomeoFoxtrot",
                "RomeoGolf",
                "RomeoHotel",
                "RomeoMike",
                "RomeoNovember",
                "RomeoWhiskey",
                "Romeos",
                "RustBucket",
                "SHADYCAT",
                "SHARPKNOT",
                "SIGFLIP",
                "SIMPLESEA",
                "SLICKSHOES",
                "SORRYBRUTE",
                "SUDDENICON",
                "SUGARLOADER",
                "SheepRAT",
                "SierraAlfa",
                "SierraBravo",
                "SierraCharlie",
                "SierraJuliett-MikeOne",
                "SierraJuliett-MikeTwo",
                "SimpleTea",
                "SimplexTea",
                "SmallTiger",
                "Stunnel",
                "TAINTEDSCRIBE",
                "TAXHAUL",
                "TFlower",
                "TOUCHKEY",
                "TOUCHMOVE",
                "TOUCHSHIFT",
                "TOUCHSHOT",
                "TWOPENCE",
                "TYPEFRAME",
                "Tdrop",
                "Tdrop2",
                "ThreatNeedle",
                "Tiger RAT",
                "TigerRAT",
                "Trojan Manuscript",
                "Troy",
                "TroyRAT",
                "VEILEDSIGNAL",
                "VHD",
                "VHD Ransomware",
                "VIVACIOUSGIFT",
                "VSingle",
                "ValeforBeta",
                "Volgmer",
                "Vyveva",
                "W1_RAT",
                "Wana Decrypt0r",
                "WanaCry",
                "WanaCrypt",
                "WanaCrypt0r",
                "WannaCry",
                "WannaCrypt",
                "WannaCryptor",
                "WbBot",
                "Wcry",
                "Win32/KillDisk.NBB",
                "Win32/KillDisk.NBC",
                "Win32/KillDisk.NBD",
                "Win32/KillDisk.NBH",
                "Win32/KillDisk.NBI",
                "WinorDLL64",
                "Winsec",
                "WolfRAT",
                "Wormhole",
                "YamaBot",
                "Yort",
                "ZetaNile",
                "concealment_troy",
                "http_troy",
                "httpdr0pper",
                "httpdropper",
                "klovbot",
                "sRDI"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716493,
    "ts_updated_at": 1743041843,
    "ts_creation_date": 1651411187,
    "ts_modification_date": 1651411187,
    "files": {
        "pdf": "https://archive.orkl.eu/ec0ff900599235d4e4103a9c6ea980ff54cc0a2c.pdf",
        "text": "https://archive.orkl.eu/ec0ff900599235d4e4103a9c6ea980ff54cc0a2c.txt",
        "img": "https://archive.orkl.eu/ec0ff900599235d4e4103a9c6ea980ff54cc0a2c.jpg"
    }
}