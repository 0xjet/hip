{
    "id": "5abed156-b672-4fb4-a2c2-d10582c862f0",
    "created_at": "2023-01-12T14:59:27.778595Z",
    "updated_at": "2025-03-27T02:16:26.017211Z",
    "deleted_at": null,
    "sha1_hash": "40af287448873408800a5ac5c05092d195548c25",
    "title": "2021-10-22 - New MultiloginBot Phishing Campaign",
    "authors": "",
    "file_creation_date": "2022-05-27T22:32:31Z",
    "file_modification_date": "2022-05-27T22:32:31Z",
    "file_size": 3118625,
    "plain_text": "# New MultiloginBot Phishing Campaign\n\n**[zscaler.com/blogs/security-research/new-multiloginbot-phishing-campaign](https://www.zscaler.com/blogs/security-research/new-multiloginbot-phishing-campaign)**\n\nMultilogin is an application designed to make it easier to log into multiple accounts on a\nsingle website or platform simultaneously. Recently, Zscaler ThreatLabz has come across a\nlive phishing campaign that is targeting genuine Multilogin users by tricking the users into\ndownloading a malicious installer. The installer is hosted on newly registered websites\n\"multilogin-uk[.]com\" and \"multilogin-us[.]com\" (registered on September 2nd 2021) which\nare a lookalikes of the legitimate website \"multilogin[.]com\". The threat actor has taken\ngreat care to match every detail, starting from website layout to the url pattern used for\ndownloading the application, in order to impersonate as the legitimate website.\n\nThe malicious installer installs a stealer (named as multilogin), written in Dotnet, on the\ncompromised machine. This stealer gathers sensitive information from the victim's system\nand sends it to its telegrambot in a zip format.\n\nThis blog aims to describe the behavior of the installer and the main functionalities of the\nstealer.\n\n**Attack Flow:**\n\nThe below snapshot shows the delivery mechanism and attack chain of the malware.\n\n\n-----\n\n## Technical Analysis\n\nAs a first step, the threat actors have cloned the legitimate website, giving it a similar\ndomain name, in order to trick the user into visiting the phishing website and downloading\nthe malicious installer hosted on it. The below snapshot shows the difference between the\nfake and legitimate sites.\n\n.\n\nFor the purposes of analysis, we will look at the Installer with MD5 hash:\n**9986d6836e6b4456fd38e7d5b036c727, which is an Inno package unsigned binary. The**\nbelow snapshot shows the comparison between the installer downloaded from the fake site\nand the installer from the legitimate site.\n\n\n-----\n\nLike the normal installer, the malicious installer creates a full environment, starting with\nregistry changes, then creating required folders (explained later), for the effective execution\nof the malware. In order to achieve persistence on the compromised machine, the malicious\ninstaller creates a shortcut file in the All Users startup folder as can be seen in the below\nsnapshot.\n\nIt is to be noted that the installer drops the malware at the user’s selected installation path\nat the time of installing the application.\n\n**Required folders: The installer creates a folder named “Item” and the following sub-**\nfolders, which shall be checked and used by the malware later:\n\n**AutoFills: Consists of text files containing browser’s autofill information.**\n**Cookies: Consists of text files containing browser’s cookies information.**\n**IP: Consists of a text file containing IP address information.**\n**Passwords: Consists of text files containing user's login information.**\n\nAfter successful installation, the final GUI (Graphical User Interface) comes up with an\nenabled check box to launch the application named as multilogin (hereinafter referred to as\nmalware). After clicking the “Finish” button, the malware comes into play. Now, let's get into\nthe code to understand the functionality of the malware.\n\n### Information Gathering\n\n\n-----\n\nBefore starting stealing activities, the malware checks the required folders in the system\nand then executes its functions to collect information from the compromised machine,\nexplained below:\n\n**_1.) IP Address Information:Firstly, the malware collects the IP address by making a web_**\nrequest to “checkip.dyndns.org”and stores the collected information at\n“<Installation_Path>\\Item\\IPAddress\\IPAddress.txt”, in the format <IP_Address>:\n**<Country_Name>, asexplainedin the below snippet.**\n\nIt is to be noted that the above code also acts as a checkpoint for an internet connection-that is, if the malware doesn’t get a response, then the malware crashes.\n\n**_2.) User’s Login data:_**\n\nThe steps to gather the login data of the user are as follows:\n\nCreates a copy of existing login data file to the destination file that is named as\n‘C:\\LoginData0’ in this case. The below snippet shows the detailed steps.\n\n\n-----\n\nThe below snippet shows how the SQL query is being executed against the newly\ncreated i.e C:\\LoginData0 file to carve out the login information. And then the\ninformation is decrypted and stored in a new file placed at\n**<Installation_Path>\\Item\\Password\\**\n**<Browser_name>Profile_<Integer>_PASSWORD.txt>.**\n\n\n-----\n\nThe login data contains passwords in an encrypted format, so the malware first gets\nthe key, which shall be used further to decrypt the encrypted password. The below\nsnapshots explain the same.\n\nThe next step is to get the encrypted data (password), which shall be passed to the\nnext function named “Decrypt” explained in the next step.\n\n\n-----\n\nAfter getting the key and the encrypted data, the malware will decrypt them by using\nthe below code.\n\nThe below snippet shows the format in which malware will store the user login data\ninformation.\n\n**_3.) Autofill and Cookies:_**\n\nThe malware uses a similar mechanism to the one explained above to collect autofill and\ncookies information and stores the respective data in a file placed at\n**<Installation_Path>\\Item\\Autofill\\<Browser_name>Profile_<Integer>_AUTOFILL.txt>**\nand <Installation_Path>\\Item\\cookies\\\n**<Browser_name>Profile_<Integer>_cookies.txt>, respectively. The below table depicts**\nthe targeted file and the sql queries used to extract the information.\n\n\n-----\n\n**Type** **Targeted**\n**file**\n\n\n**Newly**\n**Created file**\n**Path**\n\n\n**Sql Query** **Decryption**\n**of bytes?**\n\n\nAutofills Webdata C:\\Webdata0 **Select name, value FROM autofills** False\n\n\nCookies cookies C:\\cookies0 **SELECT host_key, is_httponly,**\n**path, is_secure, expires_utc,**\n**name, encrypted_value,**\n**creation_utc FROM cookies order**\n**by host_key,creation_utc desc**\n\n\nTrue\n\n\nThe below snippet shows the format in which malware will store the related information.\n\n**Note:- Similar code and logic is there for stealing information from other browsers (except**\n_Firefox). The below snapshot shows the list of browsers targeted by the malware author._\n\n\n-----\n\n**_<Browser>Service = Responsible for checking the targeted file location and then writing of_**\nthe decrypted data.\n\n**_<Browser>Decryptor= Responsible for decryption of the encrypted data_**\n\nIn the case of Firefox, the malware targets cookies.sqlite, signons.sqlite and logins.json files\nto carve out the sensitive information and stores the data in\n**<Installation_Path>\\Item\\cookies\\FFProfile_Cookies.txt and**\n**<Installation_Path>\\Item\\Password\\FFProfile_PASSWORD_.txt respectively. It is to be**\nnoted that for decryption of encrypted data, the malware uses PK11SDR_Decrypt” API of\n**_nss3.dll._**\n\n### Zip file creation code\n\nAfter stealing all the data from different browsers, the malware then creates a zip file which\nshall be sent to the command and control (C2) server. The below code explains the same.\n\n\n-----\n\n### Telegram Bot\n\nAfter zip creation, in order to transfer the zip file, the malware initiates C2 communication to\nits Telegram bot, using a hard-coded token. The snippets of the code are shown below.\n\nSetting up of required protocols + Reading of zip file + Sending data (labeled 1)\nFull telegram bot url (labeled 2)\n\n### Post-Stealing Activities\n\nAfter successfully performing the stealing activities, in order to leave no trace, the malware\ndisplays a pop-up with a false message to update the application and asks the user for\nconfirmation to proceed ahead. Once the user responds, then the malware opens a\nlegitimate link in the foreground and deletes the created zip file in the background,\nirrespective of the option chosen by the user. It means that even if the user selects “No,”\nthe code will execute in the same pattern.\n\n### How to Defend Against This Attack\n\n\n-----\n\nZscaler s multilayered cloud security platform detects these indicators at various levels:\n[Win32.Backdoor.MultiloginBot.](https://threatlibrary.zscaler.com/threats/95294a02-669e-4115-b49f-9e9bc6cd16e3)\n\nThe Zscaler sandbox coverage is below:\n\n### MITRE Att&ck Table\n\nT1584 Compromise Infrastructure\n\nT1547 Boot or Autostart Execution\n\nT1555 Credentials from Password Stores\n\nT1567 Exfiltration over Web Services\n\nT1059 Command and Scripting Interpreter\n\nT1005 Data from Local System\n\nT1114 Email Collection\n\nT1560 Archive Collected Data\n\n\n-----\n\nT1606 Forge Web Credentials\n\n### IOCS\n\nBelow are information on IOCs, including MD5 hashes and URLs, that should be blocked.\n\n**MD5s**\n\n9986d6836e6b4456fd38e7d5b036c727\n\nf991573756dbc778b52b84212c7a36c5\n\n**Phishing domains:**\n\nmultilogin-uk[.]com\n\nmultilogin-us[.]com\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-10-22 - New MultiloginBot Phishing Campaign.pdf"
    ],
    "report_names": [
        "2021-10-22 - New MultiloginBot Phishing Campaign.pdf"
    ],
    "threat_actors": [
        {
            "id": "75108fc1-7f6a-450e-b024-10284f3f62bb",
            "created_at": "2024-11-01T02:00:52.756877Z",
            "updated_at": "2025-03-27T02:00:55.544216Z",
            "deleted_at": null,
            "main_name": "Play",
            "aliases": null,
            "source_name": "MITRE:Play",
            "tools": [
                "Nltest",
                "AdFind",
                "PsExec",
                "Wevtutil",
                "Cobalt Strike",
                "Playcrypt",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535567,
    "ts_updated_at": 1743041786,
    "ts_creation_date": 1653690751,
    "ts_modification_date": 1653690751,
    "files": {
        "pdf": "https://archive.orkl.eu/40af287448873408800a5ac5c05092d195548c25.pdf",
        "text": "https://archive.orkl.eu/40af287448873408800a5ac5c05092d195548c25.txt",
        "img": "https://archive.orkl.eu/40af287448873408800a5ac5c05092d195548c25.jpg"
    }
}