{
    "id": "9442cc7e-d5da-4102-896e-9f2692ab41dc",
    "created_at": "2023-01-12T15:07:10.691504Z",
    "updated_at": "2025-03-27T02:05:36.822991Z",
    "deleted_at": null,
    "sha1_hash": "453521e97c3380877ffa3b76a37d7da67614fb28",
    "title": "2019-03-13 - GlitchPOS- New PoS malware for sale",
    "authors": "",
    "file_creation_date": "2022-05-28T15:55:46Z",
    "file_modification_date": "2022-05-28T15:55:46Z",
    "file_size": 5243157,
    "plain_text": "# GlitchPOS: New PoS malware for sale\n\n**[blog.talosintelligence.com/2019/03/glitchpos-new-pos-malware-for-sale.html](https://blog.talosintelligence.com/2019/03/glitchpos-new-pos-malware-for-sale.html)**\n\n[Warren Mercer and](https://twitter.com/securitybeard) [Paul Rascagneres authored this post with contributions from Ben Baker.](https://twitter.com/r00tbsd)\n\n## Executive summary\n\nPoint-of-sale malware is popular among attackers, as it usually leads to them obtaining credit\ncard numbers and immediately use that information for financial gain. This type of malware is\ngenerally deployed on retailers' websites and retail point-of-sale locations with the goal of\ntracking customers' payment information. If they successfully obtain credit card details, they\ncan use either the proceeds from the sale of that information or use the credit card data\ndirectly to obtain additional exploits and resources for other malware. Point-of-sale terminals\nare often forgotten about in terms of segregation and can represent a soft target for\nattackers. Cisco Talos recently discovered a new PoS malware that the attackers are selling\non a crimeware forum. Our researchers also discovered the associated payloads with the\nmalware, its infrastructure and control panel. We assess with high confidence that this is not\nthe first malware developed by this actor. A few years ago, they were also pushing the\nDiamondFox L!NK botnet. Known as \"GlitchPOS,\" this malware is also being distributed on\nalternative websites at a higher price than the original.\n\n\n-----\n\nThe actor behind this malware created a video, which we embedded below, showing how\neasy it is to use it. This is a case where the average user could purchase all the tools\nnecessary to set up their own credit card-skimming botnet.\n\n## GlitchPOS\n\n### Packer overview\n\nA packer developed in VisualBasic protects this malware. It's, on the surface, a fake game.\nThe user interface of the main form (which is not displayed at the execution) contains various\npictures of cats:\n\nThe purpose of the packer is to decode a library that's the real payload encoded with the\nUPX packer. Once decoded, we gain access to GlitchPOS, a memory grabber developed in\nVisualBasic.\n\n### Payload analysis\n\nThe payload is small and contains only a few functions. It can connect to a command and\ncontrol (C2) server to:\n\nRegister the infected systems\n\nReceive tasks (command execution in memory or on disk)\nExfiltrate credit card numbers from the memory of the infected system\nUpdate the exclusion list of scanned processes\nUpdate the \"encryption\" key\n\n\n-----\n\nUpdate the User Agent\nClean itself\n\n**Tasks mechanism**\n\nThe malware receives tasks from the C2 server. Here is the task pane:\n\nThe commands are executed via a shellcode directly sent by the C2 server. Here is an\nexample in Wireshark:\n\nThe shellcode is encoded with base64. In our screenshot, the shellcode is a RunPE:\n\n\n-----\n\n**\"Encryption\" key**\n\nThe \"encryption\" key of the communication can be updated in the panel. The communication\nis not encrypted but simply XORed:\n\n**Credit card grabber**\n\nThe main purpose of this malware is to steal credit card numbers (Track1 and Track2) from\nthe memory of the infected system. GlitchPOS uses a regular expression to perform this\ntask:\n\n\n-----\n\n(%B)\\d{0,19}\\ [\\w\\s\\/]{2,26}\\ \\d{7}\\w \\?\nThe purpose of this regular expression is to detect Track 1 format B\nHere is an example of Track 1:\nCardholder : M. TALOS\nCard number*: 1234 5678 9012 3445\nExpiration: 01/99\n%B1234567890123445^TALOS/M.\n\n;\\d{13,19}=\\d{7}\\w*\\?\nThe purpose of this regular expression is to detect Track 2\nHere is an example of Track 2 based on the previous example:\n;1234567890123445=99011200XXXX00000000?*\n\nIf a match is identified in memory, the result is sent to the C2 server. The malware maintains\nan exclusion list provided by the server. Here is the default list: chrome, firefox, iexplore,\nsvchost, smss, csrss, wininit, steam, devenv, thunderbird, skype, pidgin, services, dwn,\ndllhost, jusched, jucheck, lsass, winlogon, alg, wscntfy, taskmgr, taskhost, spoolsv, qml, akw.\n\n### Panel\n\nHere are some additional screenshots of the GlitchPOS panel. These screenshots were\nprovided by the seller to promote the malware.\n\nThe \"Dashboard:\"\n\n\n-----\n\nThe \"Clients\" list:\n\nThe \"Cards Date:\"\n\n\n-----\n\n## Linked with DiamondFox L!NK botnet\n\n### Author: Edbitss\n\nThe first mention of GlitchPOS was on Feb. 2, 2019 on a malware forum:\n\nEdbitss is allegedly the developer of the DiamondFox L!NK botnet in 2015/2016 and 2017 as\n[explained in a report by CheckPoint.](https://blog.checkpoint.com/wp-content/uploads/2017/05/DiamondFox_Report_170510-2.pdf)\n\n\n-----\n\nThe developer created this video to promote GlitchPOS, as well. In this video, you can see\nthe author set up the malware and capture the data from a swiped card. We apologize for the\nquality, shakiness, music, and generally anything else with this video, again, it's not ours.\n\n\n-----\n\nThe built malware is sold for $250, the builder $600 and finally, the gate address change is\ncharged at $80.\n\n### Panel similarities\n\nIn addition to the malware language (VisualBasic), we identified similarities between the\nDiamondFox panel and the GlitchPOS panel. In this section, the DiamondPOS screenshots\ncome from the CheckPoint report mentioned previously.\n\nBoth dashboards' world map are similar (image, code and color):\n\n\n-----\n\nThe author used the same terminology such ask \"Clients\" or \"Tasks\" on the left menu:\n\nThe icons are the same too in both panels, as well as the infected machine list (starting with\nthe HWID). The PHP file naming convention is similar to DiamondFox, too.\n\nThe author clearly reused code from DiamondFox panel on the GlitchPOS panel.\n\n### Comparison of GlitchPOS and the DiamondFox POS module\n\nIn 2017, the DiamondFox malware included a POS plugin. We decided to check if this\nmodule was the same as GlitchPOS, but it is not. For DiamondFox, the author decided to\nuse the leaked code of BlackPOS to build the credit card grabber. On GlitchPOS, the author\ndeveloped its own code to perform this task and did not use the previously leaked code.\n\n## Bad guys are everywhere\n\nIt's interesting to see that someone else attempted to push the same malware 25 days after\nedbitss on an alternative forum:\n\n\n-----\n\nThis attacker even tried to cash in by increasing some prices.\n\nSome members even attempted to call out the unscrupulous behaviour:\n\n\n-----\n\nWith the different information we have, we think that Chameleon101 has taken the previous\nmalware created by Edbitss to sell it on an alternative forum and with a higher price.\n\n## Conclusion\n\nThis investigation shows us that POS malware is still attractive and some people are still\nworking on the development of this family of malware. We can see that edbitss developed\nmalware years even after being publicly mentioned by cybersecurity companies. He left\nDiamondFox to switch on a new project targeting point-of-sale. The sale opened a few\nweeks ago, so we don't know yet how many people bought it or use it. We also see that bad\nguys steal the work of each other and try to sell malware developed by other developers at a\nhigher price. The final word will be a quote from Edbitss on a DiamondFox screenshot\npublished by himself \"In the future, even bank robbers will be replaced.\"\n\n\n-----\n\n## Coverage\n\nAdditional ways our customers can detect and block this threat are listed below.\n\n[Advanced Malware Protection (AMP) is ideally suited to prevent the execution of the](http://cs.co/reviewamp)\nmalware used by these threat actors. Below is a screenshot showing how AMP can protect\ncustomers from this threat. Try AMP for free [here.](https://cisco.com/go/tryamp)\n\n\n-----\n\n[Cisco Cloud Web Security (CWS) orWeb Security Appliance (WSA) web scanning prevents](https://www.cisco.com/c/en/us/products/security/cloud-web-security/index.html)\naccess to malicious websites and detects malware used in these attacks.\n\n[Email Security can block malicious emails sent by threat actors as part of their campaign.](https://www.cisco.com/c/en/us/products/security/email-security-appliance/index.html)\n\n[Network Security appliances such asNext-Generation Firewall (NGFW), Next-Generation](https://www.cisco.com/c/en/us/products/security/firewalls/index.html)\n[Intrusion Prevention System (NGIPS), and Meraki MX can detect malicious activity](https://meraki.cisco.com/products/appliances)\nassociated with this threat.\n\n[AMP Threat Grid helps identify malicious binaries and build protection into all Cisco Security](https://www.cisco.com/c/en/us/solutions/enterprise-networks/amp-threat-grid/index.html)\nproducts.\n\n[Umbrella, our secure internet gateway (SIG), blocks users from connecting to malicious](https://umbrella.cisco.com/)\ndomains, IPs, and URLs, whether users are on or off the corporate network.\n\nOpen Source SNORTâ“‡ Subscriber Rule Set customers can stay up to date by downloading\n[the latest rule pack available for purchase on Snort.org.](https://www.snort.org/products)\n\n## Indicators of Compromise (IOCs)\n\nThe following IOCs are associated to this campaign:\n\n### GlitchPOS samples\n\ned043ff67cc28e67ba36566c340090a19e5bf87c6092d418ff0fd3759fb661ab (SHA256)\n\nabfadb6686459f69a92ede367a2713fc2a1289ebe0c8596964682e4334cee553 (SHA256)\n\n### C2 server\n\ncoupondemo[.]dynamicinnovation[.]net\n\n### URLs\n\n\n-----\n\nhxxp://coupondemo[.]dynamicinnovation[.]net/cgl-bin/gate.php\nhxxp://coupondemo[.]dynamicinnovation[.]net/admin/gate.php\nhxxp://coupondemo[.]dynamicinnovation[.]net/glitch/gate.php\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-13 - GlitchPOS- New PoS malware for sale.pdf"
    ],
    "report_names": [
        "2019-03-13 - GlitchPOS- New PoS malware for sale.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536030,
    "ts_updated_at": 1743041136,
    "ts_creation_date": 1653753346,
    "ts_modification_date": 1653753346,
    "files": {
        "pdf": "https://archive.orkl.eu/453521e97c3380877ffa3b76a37d7da67614fb28.pdf",
        "text": "https://archive.orkl.eu/453521e97c3380877ffa3b76a37d7da67614fb28.txt",
        "img": "https://archive.orkl.eu/453521e97c3380877ffa3b76a37d7da67614fb28.jpg"
    }
}