{
    "id": "de8d7924-08a7-44e2-8b61-fbe73143c512",
    "created_at": "2023-01-12T15:07:57.790321Z",
    "updated_at": "2025-03-27T02:05:32.508739Z",
    "deleted_at": null,
    "sha1_hash": "0c4290d68e54490c8d6aa75d1b4970ba444f270d",
    "title": "2020-12-12 - ContiUnpacker- An automatic unpacker for Conti rasnomware",
    "authors": "",
    "file_creation_date": "2022-05-27T23:23:38Z",
    "file_modification_date": "2022-05-27T23:23:38Z",
    "file_size": 304190,
    "plain_text": "# ContiUnpacker\n\n**github.com/cdong1012/ContiUnpacker**\n\ncdong1012\n\nAn automatic unpacker for a Conti sample\n\n## Context\n\n[This was inspired by James Bennett's blog post on how to programmatically unpack](https://www.fireeye.com/blog/threat-research/2020/12/using-speakeasy-emulation-framework-programmatically-to-unpack-malware.html)\nmalware.\n\n[This unpacker unpacks this specific Conti ransomware I found on MalwareBazaar.](https://bazaar.abuse.ch/sample/03b9c7a3b73f15dfc2dcb0b74f3e971fdda7d1d1e2010c6d1861043f90a2fecd/)\n\n## Requirement\n\nPython 3\nSpeakeasy\n\n## How it works\n\n[The unpacker uses the Speakeasy Emulation Framework to run and unpack the](https://github.com/fireeye/speakeasy)\nsample.\n\nWhen I manually unpacked this, I noticed that the sample called VirtualAlloc to\nallocate memory, wrote the unpacked PE file to it, and called VirtualProtect on the\n**.text region before executing it.**\n\n\n-----\n\nFrom this, I halted the simulation at the first VirtualProtect call, dumped the PE file out,\nand mapped it accordingly to fix the IAT.\n\n## Usage\n\n### Running with Command Prompt\n```\npython ContiUnpacker.py -f conti.dll -o <output_file>\n\n## Image\n\n```\n\n-----\n\n## Note\n\n**Please don't actually run this malware I included unless you know what you're doing.**\n**I'm not responsible if you end up encrypting your machine!**\n\nAlso, I noticed that the function calls are a bit different on Speakeasy emulator compared to\nwhen running on x64dbg. During the VirtualProtect call, everything should technically be\nwritten into the allocated memory already, but that's not the case...\n\nApparently, only parts of the .rdata section is written, so the dumped executable won't be\nable to run.\n\nI can't figure out why this is happening because Speakeasy is pretty weird, so this unpacker\ndoes not work 100%.\n\nHowever, I'll still keep it here in case anyone wants to refer to this when writing their own\nunpacker using Speakeasy!\n\n## Acknowledgement\n\nJames T. Bennett - https://www.fireeye.com/blog/threat-research/2020/12/using-speakeasyemulation-framework-programmatically-to-unpack-malware.html\n\n[FireEye's Speakeasy Emulation Framework - https://github.com/fireeye/speakeasy](https://github.com/fireeye/speakeasy)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-12 - ContiUnpacker- An automatic unpacker for Conti rasnomware.pdf"
    ],
    "report_names": [
        "2020-12-12 - ContiUnpacker- An automatic unpacker for Conti rasnomware.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536077,
    "ts_updated_at": 1743041132,
    "ts_creation_date": 1653693818,
    "ts_modification_date": 1653693818,
    "files": {
        "pdf": "https://archive.orkl.eu/0c4290d68e54490c8d6aa75d1b4970ba444f270d.pdf",
        "text": "https://archive.orkl.eu/0c4290d68e54490c8d6aa75d1b4970ba444f270d.txt",
        "img": "https://archive.orkl.eu/0c4290d68e54490c8d6aa75d1b4970ba444f270d.jpg"
    }
}