{
    "id": "fb94f3b8-7b61-4338-ac29-63a466923464",
    "created_at": "2022-10-25T16:48:23.200051Z",
    "updated_at": "2025-03-27T02:16:57.88764Z",
    "deleted_at": null,
    "sha1_hash": "5e45c51ac37f98d5a77773448007d5c2d47b28f6",
    "title": "",
    "authors": "",
    "file_creation_date": "2021-01-14T02:53:02Z",
    "file_modification_date": "2021-01-14T02:53:02Z",
    "file_size": 475951,
    "plain_text": "# Shadows From the Past Threaten Italian Enterprises\n\n**[yoroi.company/research/shadows-from-the-past-threaten-italian-enterprises](https://yoroi.company/research/shadows-from-the-past-threaten-italian-enterprises/)**\n\nNovember 30, 2020\n\n11/30/2020\n\n## Introduction\n\nThe modern cyber threat landscape hides nasty surprises for companies, especially for the\nmost structured and complex companies. Many times, threat actors develop very\ndangerous and effective techniques using tools and technologies in a smart, unattended\nway. This is the case of a particular cyber criminal group operating cyber intrusion\nagainst one of the most targeted and cyber-mature industry sectors: the Banking sector.\n\nDuring the last years our defense and intelligence operations spotted and tracked some of\nthe operations of a particular Threat Group targeting financial institutions worldwide, in\nEurope and especially in Italy, at least since 2015. This particular cyber criminal group\n[has been recently publicly disclosed with the name UNC1945 by Mandiant (TH-239 in our](https://www.fireeye.com/blog/threat-research/2020/11/live-off-the-land-an-overview-of-unc1945.html)\ninternal KB), presenting the findings of a particular investigation they recently took part\nand referencing an intrusion potentially dated back to 2018.\n\nAfter the publication of the Mandiant report, we decided to reach out and de-classify\nsome technical details about this mysterious group that is threatening some of the largest\nItalian - and European - companies.\n\nIn particular, we’ll describe how the group approached the difficult task of bringing a\nmodern cyber arsenal to multi-decade old legacy systems.\n\n## The Challenge of Attribution\n\nThe attribution of this group to known threat actors is still smoky and far for certainty. In\nfact, even if CERT-Yoroi reserved intelligence information points to old intrusions\nattributed to Carbanak/Anunak romainan cells dated back 2015-2016, there is still no\nhard evidence linking to this particular group.\n\nAnyway, despite the unclear purposes of their recent intrusion reported by Mandiant one\nthing is pretty clear: the group is capable of running long lasting operations.\n\n\n-----\n\nOperations running for years are not typical of the targeted ransomware operators\nafflicting thousands of companies nowadays. Most of those intrusions last weeks or at\nleast months for a simple reason: persistence is really risky for the intruders, too much\nmight cost them the whole profit opportunity.\n\nIn our experience, the actor behind TH-239 was historically financially motivated and\nwell prepared in conducting intrusions in Enterprise grade - some time legacy environments such as old Red Hat, Solaris OS and other Linux systems as well. A\ndifferent skill set rather than most of the ransomware operators which are extremely good\non Microsoft Windows environments. These much more rare abilities are typical of\nsophisticated groups such as those targeting high complex organizations such as Financial\nand Banking institutions, extremely characterized by legacy technologies, and almost\nunknown to most cyber criminals.\n\n## Technical Analysis\n\nIn this analysis, we want to deepen one of the post exploitation TTP used by the UNC1945\ngroup to solve the huge problem of running modern attack tools on legacy systems. Do to\nso, the group in fact is using a custom QEMU linux virtual machine instance containing\nall the necessary tools adopted to achieve its objective.\n\nThis way all the operating system and dependencies issues become almost frictionless. In\nparticular their portable virtual arsenal is based on QEMU images and looks like this:\n\nFigure. Virtual Arsenal Structure\n\nLet's go to analyze the various elements:\n\n**bios.bin: is the QEMU seabios, an open source implementation of an x86 BIOS.**\n**core: is the original image of the Tiny Linux base**\n**efi-e1000.rom: QEMU custom ROM image.**\n**en-us: the mapping file for US keyboard layout.**\n**hda.mini.qcow2: QEMU QCOW2 Image (HD).**\n**kvmapic.bin: KVM in-kernel APIC support.**\n**qemu-system-i386: The QEMU PC System emulator;**\n**start.sh: the initialization script of the virtual machine.**\n\n\n-----\n\nThe content of the starting script is quite simple:\n```\n!/bin/shif [ -z \"$1\" ];then ./qemu-system-i386 -m 166 -kernel vmlinuz -initrd\ncore -hda hda.mini.qcow2 -append \"tce=sda1 home=sda1 opt=sda1 noswap nozswap\nsuperuser\" -net nic -net user,tftp=/,hostfwd=tcp::2222-:22 -curseselse ./qemusystem-i386 -m 166 -kernel vmlinuz -initrd core -hda hda.mini.qcow2 -append\n\"tce=sda1 home=sda1 opt=sda1 noswap nozswap superuser\" -net nic -net\nuser,tftp=/,hostfwd=tcp::19227-:22 -vnc none >/dev/null 2>&1 &fi\n\n```\nThe bash script is quite easy. It has the purpose to launch the QEMU emulator system: if\nno parameter is provided ($1), the script executes the first branch enabling port\nforwarding between guest 22 to host 2222, using the display library “curses”. This setup is\nto interact with the VM connecting through the host 2222 .\n\nWithout any parameter, the script configures the access through the usage of SSH,\nbecause the “curses” library is not listed and the VNC server is disabled. However, both\nthe branches allow communication through the SSH protocol, in the first case starting the\ncommunication at the port 2222, in the second at the port 19227.\n\nAfter the first overview of the configuration of the QEMU environment, we decided to\ndeepen into the Virtual Machine by executing it.\n\n## The QEMU system\n\nStarting the QEMU system, we obtained the first screen of the configuration of the QEMU\nsystem.\n\nFigure. Arsenal boot up\n\nThe specific linux distribution adopted by the attackers is Tinycore Linux 7.2, a\nlightweight distro running on a 4.2.9 Linux kernel. It is interesting to notice that the Tiny\nCore 7.2 release is about 4 years old, but we have evidence it was still part of their cyber\n\n-----\n\narsenal during 2020.\n\nSo, we can hypothesize that the creation and the configuration of the virtual QEMU\nenvironment is 2016 and the threat actor continues to use that since that period, and,\nthus, that the group is using this technique at least from 2016.\n\nNavigating the filesystem, we discovered a huge amount of tools for exploitation, privilege\nescalation, lateral movement and exfiltration.\n\n## The Users\n\nNavigating all the filesystem and dissecting every malicious capability have been a\nchallenging activity because we had to explore an entire modular VM with such many\ninteresting artifacts. So, we started to see which are the users contained inside the\n“/etc/passwd” file.\n\nFigure. Virtual arsenal users configuration\n\nBesides the “root” user, the base linux user with the highest level of privileges, we have,\n“lp” and “nobody” with no specific privileges; the first one is a sort of spooler service and\nthe other one has no privileges and we didn’t find anything regarding the directory\n“/nonexistent” inside the disk image.\n\nThe default user of the TinyCore Linux distribution is “tc” was configured with password “\n” (empty space) and it is the user basically adopted by the attackers. The confirmation of\nthis hypothesis is inside “/etc/fstab” configuration file where the user “tc” has three\nentries, as we can see below:\n\nFigure. FSTAB configuration\n\nThis mode of adding devices onto the virtual system is provided thanks to the command\nline of QEMU hypervisor application though the command “-append” which has the\npurpose of appending a new virtual disk to the basic core of the linux system.\n\n\n-----\n\nInside the virtual disk there is the complete post-exploitation arsenal adopted by this new\npowerful threat actor and this particular configuration enables it to perform a completely\nmodular arsenal. In fact, the attackers could update only the virtual device letting the core\nof the VM unaltered by simply replacing the virtual QCOW2 disk.\n\nThe three most important directories are “deploy”, “python” and “responder”.\n\nFigure. TC user folder structure\n\n### The “Deploy” Directory\n\nThis directory contains many tools part of the cyber arsenal. It is composed of many types\nof executable binaries, scripts and archives such as .py, .exe, .txz, or .js. This is an\nindication that the repository is virtual-arsenal was originally designed to target different\nkind of machines, as needed.\n\nFigure. Deploy directory contents\n\n\n-----\n\nMany of the sub-folder in this directory references known tools, most of them publicly\navailable. For instance:\n\nLaZagne: historical tool to harvest credentials from heterogeneous environments\nsuch as Microsoft Windows, Linux based systems and Apple’s OSX.\nUACME: tool to bypass user access control restrictions on Microsoft Windows\nenvironments.\nMimikatz: maybe the most popular post exploitation and privilege escalation tool\neven nowadays.\nBcwipe: a legit data wiping software able to permanently and selectively delete files\nin a unrecoverable way, showing the group have particular care in remaining\nunnoticed.\nprocdump: a sysinternal command-line utility to monitor and dump process\nmemory.\nScreen and screen_xp: contains custom recognizance tools to monitor the desktop\nscreen of their targets.\ntshd: contains a TinyShell backdoor - typical unix tool - but customized and\ncompiled for Windows environments.\n\nFigure. custom screen capture tool dynamics\n\n\n-----\n\nFigure. snippet from the customized TSHD backdoor for Windows\n\nThere are also some tools statically compiled such as winexe. The reason is to have tools\nthat are self-contained and ready to execute and does not require any additional\ninstallations on the target machine.\n\n### The “Python” Directory\n\nThis directory is quite different from the previous one. It contains various exploits mainly\nwritten in python language. The first folder contains exploits for the well known MS17010 vulnerability also known as the EternalBlue family. The code has been forked form\n[the open source github repository MS17-010 and contains python scripts to conduct](https://github.com/worawit/MS17-010)\nEternalBlue, EternalChampion, EternalSynergy, EternalRomance attacks, along with old\nWindows 2000 exploits.\n\n\n-----\n\nFigure. The “Python” directory\n\nInside the “python” directory, we also noticed the “pip-selfcheck.json” file, an installation\nartifact reporting the latest update of the cyber-arsenal dates back to 2018 as shown\nbelow:\n\n{\"last_check\":\"2018-05-26T06:06:28Z\",\"pypi_version\":\"10.0.1\"}\n\nInside the “example” sub-folder there are many reconnaissance tools able to gather\ntechnical information from the target systems via SMB, WMI, ActiveDirectory, System\nregistry, NFS, Netbios and so on. Tools really useful to gather information about the\nMicrosoft Windows perimeter of the victim network.\n\nThe tools in the “examples” folder are actually borrowed from the “Impacket” open source\n[collection available on github.](https://github.com/SecureAuthCorp/impacket/tree/master/examples.)\n\nFigure. Contents of “example” sub-folder\n\n### The “Responder” Directory\n\nThis folder hosts the homonymous “Responder” tool. Responder is a LLMNR/NBTNS/mDNS Poisoner written by Laurent Gaffie, and is able to listens on the wire for\nNetBIOS Name Service (NetBIOS) and Link-Local Multicast Name Resolution (LLMNR)\nbroadcast and multicast requests for hostnames from other machines in the local\nsubnet”. Executed with the right parameters is able to snoop on NetBios and LLMNR in\norder to steal NTLMv1/v2 password hash.\n\nThe presence of this type of tool inside the cyber arsenal of the attacker means the threat\ngroup is really dangerous: man in the middle attacks across the company network are part\nof their modus operandi so their intrusions could be really dangerous in poorly segregated\n\n\n-----\n\nnetworks.\n\nAnyway, the 2.3 version of the Responder toolkit dates back to 2016, suggesting this tool\nwas one of the first tools installed on the virtual-arsenal.\n\nFigure. Responder configuration\n\n\n-----\n\nInside the Responder directory there is also the log folder created during the first\nexecution of the tool.\n\n07/09/2016 11:39:19 PM - Responder Started: ['./Responder.py', '-I', 'eth0']\n07/09/2016 11:39:19 PM - Responder Config: Settings class:\n\n## The Virtual-Arsenal Capabilities\n\nAfter the analysis, we identified all the tools stored inside the malicious virtual machine\nand we are able to classify them into the following categories:\n\nEnumeration (T1261):\n\nUsing tools to enumerate users through various protocols such as LPAD,\nNETBIOS, Active Directory and RPC.\nNetwork communication (TA0011):\n\nNetwork pivoting communication using tcp, tftp, http tunnels\nPacket manipulation tools like inpacket or scapy\nOS Credential Dumping (T1003):\n\nHarvesting credential stored inside user and system configuration through\nopen-source tools like LaZagne.\nObtaining higher privileges and authentication tokens using escalation tools\nlike Mimikatz or system process dumping, and bypassing OS protection such\nas UAC.\nExploit (T1404):\n\ncompromising remote systems abusing known 1-Day vulnerabilities such as\nthe MS17-010 ones.\nMan-in-the-Middle (T1557):\n\nEngaging their targets with Man in the Middle attack to manipulate network\ninteraction to obtain hashes and tokens (e.g. through Responder)\nLiving-off-the-Land tools (T1218):\n\nMany legit tools such as sysinternal tools such as “procdump” are ready to be\nabused in the toolkit, also linux utilities like “winexe”, “find”, ”touch” “grep”,\n“head”, “less” or “wget” have been cross-compiled to be ready for deployment\non Windows environments too.\n\nAll of them are compiled in different ways (static or dynamic) and written in different\nlanguages (javascript, assembly, python etc.). This TTP confirms that the QEMU virtual\nmachine is a complete medium of post-exploitation framework, which could be\ncustomized according to every need coming from the attacker.\n\nIf we think about the classic Lockheed Martin Cyber Kill Chain, we can collocate the\nVirtual Machine role in its mid and latest phase, the “Lateral Movements” and the “Action\nand Objectives”. In fact, the QEMU virtual machine was manually controlled through an\nSSH tunnel by the attackers, and it has been used as a powerful framework.\n\n## Conclusion\n\n\n-----\n\nThis QEMU based virtual arsenal is not the only tool in the satchel of this blurred threat\nactor. They are also able to leverage 0Day exploits - such as the CVE-2020-14871\n[described in Early Warning bulletin N031120 - and to leverage completely custom](https://yoroi.company/warning/grave-vulnerabilita-in-solaris/)\nimplants and tools to get in and move laterally even in the most segregated network. Also,\nthe pivoting abilities of the group are really notable and the customization of the thsd\nbackdoor observed in the virtual-arsenal is just one element of their modus operandi.\n\nFollow-up reports will better describe how these actors have leveraged their edge abilities\nto threaten even the most cyber-mature companies.\n\n## Appendix\n\n### Indicator of Compromise\n\nHash:\n\n\n-----\n\n```\nfb7426ad06ee17fae29e4a46e36d92e7ba7a7cefaeeac2741eca6c535a1b3128 \ntc/deploy/LaZagne/LaZagne-32bits\nafa814290bfea15a47d3462ae32d94f82e66ee888f7c51caf34b3212723c22ad \ntc/deploy/LaZagne/laZagne.exe\nd3d4f88012dc5b7deec6c54bef21e17f720d58aa00c8a809eb36d47038ca8db8 \ntc/deploy/LaZagne/LaZagne-64bits\n05732e84de58a3cc142535431b3aa04efbe034cc96e837f93c360a6387d8faad \ntc/deploy/procdump/procdump.exe\n5b0f3ad95531dc16bb8de255186be66bf134fbdea4c1fbee38c807d98992c20c \ntc/deploy/procdump/run.bat\ndd8a9c4c59a7c7b07f21a6b3ac60405ee4c796cb3b268a9f6bd07fcdfc25cebd \ntc/deploy/screen/svhost.exe\nd6d4b69a277eac02b8b79c5e734f80d6cf1e0a4e967729a20079f7815de53794 \ntc/deploy/UACME_2.8.8/UacInfo64.exe\n5afa7bd2ec1cc2abc91b37b0f800e2af11f3c796450c618e0f40e41efe756640 \ntc/deploy/UACME_2.8.8/Akagi64.exe\n0f04ed31f345a3fcfe2e6a4c9022f02847df785ff9cd82147fccea5122646eba \ntc/deploy/UACME_2.8.8/Akagi32.exe\nb90cbef385708ae3a47b4fc96299e3f7c2979af439ed79cb20b355718fa263f4 \ntc/deploy/UserEnum/userslist.txt\nedf35acd8eeeba68af9113afdedc21dc7d4ecb549da09195a4a9f25f4eb9941f \ntc/deploy/UserEnum/UserEnum_LDAP.py\n6dd57af6bd2049a6382ac7169e44aadef9353b905feb75e96abaae57199d4188 \ntc/deploy/UserEnum/README.md\nc1f409a02ad9584551a17a7321db2ad448c6b2e5731d224201c5a173fb873cce \ntc/deploy/UserEnum/UserEnum_NBS.py\n54ecffbe2e97a127ee6820c891ba13f0b7ea5558b33e1ee731bdb772e5b97deb \ntc/deploy/UserEnum/UserEnum_RPC.py\nffa5e945163ffb23d26a5dde041802219b03692e7af409e621ef92d6692dfbaf \ntc/deploy/tshd/head.exe\ndf4e2115c80d07ca4345ba92053dcc38c4002554677a04509d02669a50ab86bf \ntc/deploy/tshd/cygwin1.dll\nc2ef6fc419630d566154f8372e94859df8141d02805bc7bce39c726a1ffef7c1 \ntc/deploy/tshd/grep.exe\n70c5e7cd2926bb9849cffa6ae1c5559baf0ec4e3c896ae28bf219c9008f4c2c7 \ntc/deploy/tshd/find.exe\n365ac8a166174bbc89fb24b21bfcd0b015950495bdf384ab830dd96d25e4cee3 \ntc/deploy/tshd/w_conf.exe\n3faebbd216d5e94b696288d3089fff6ecb29fc23e97ceb2ff355341ac740d6a5 \ntc/deploy/tshd/uudecode.exe\n2c73707fc79ff78846cc3c85383d47e46e495ef223d58e1e2933787fcfc2566a \ntc/deploy/tshd/uuencode.exe\n1ac28b748404d58b9f0c62d1ee65e3b444c9ad3ac0abea299238090b764bc25b \ntc/deploy/tshd/wget.exe\n0dd4d924c9069992dd7b3e007c0f3ca149b7fb1ce0dfb74b37c7efc6e1aebb46 \ntc/deploy/tshd/svchost.exe\nca301cde5b700ef7160cdf1f3acc6710da59958b8613dbe0abd2fd8120dfc0ed \ntc/deploy/tshd/tail.exe\n73723541d7a3c60456d69f0edff955bfde9db6e255821f6aee11f5f2a8a6466b \ntc/deploy/tshd/run.xml\ndffffc9bfaa0b41674bbffcf93764f5d04e218a454dc5ab93a830f8ee19722a7 \ntc/deploy/tshd/touch.exe\nedf649392001017219a27e07b9c33b3a1ebd074d1f0b769a6e8928833271b1c3 \ntc/deploy/nc_send/sendnc.py\na70334114ee71a28aab1f992a1a6ff5b894433066859f8bf87fe117b6b0dd288 \ntc/deploy/nc_send/outlooks.exe\n7d33f24ae4c7b3024d5cec2a31420be857f0e547de8971dd6dea169119d4f348 \ntc/deploy/nc_send/tar.exe\n875f234ed1c172ad8deca6d9c35270c1426d25765653600b2b899efa9f9a966f \n\n```\n\n-----\n\n```\ntc/deploy/nc_send/nc.tar\n50cf763baf747c0094885bc1d129fb97211c618e316ea476c0dfeffeddf9db42 \ntc/deploy/nc_send/mimi32.exe\nb3ec0b621d523f8182cf8409cb1c3d29553d56442e75dcac964dfae82d2c1bc9 \ntc/deploy/nc_send/sendncmim.py\n632be2363c7a13be6d5ce0dca11e387bd0a072cc962b004f0dcf3c1f78982a5a \ntc/deploy/nc_send/mimi64.exe\ne3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855 \ntc/deploy/nc_send/name_mimi_sysinit.exe\n23e5fd457a251d3f87920727a12bcf2e70b30901597309564015eddd12b94a1c \ntc/deploy/nc_send/mimi_old.exe\nf5c1304be270e271e902f0229ab8d876c9ed63cbf4fe926dd1ab61f7335187a4 \ntc/deploy/mimi_uac/nc32.exe\na0ee6605e8fc9fd2c397b7cd7ddd1664b08e2e6c9f72ab9e658ec5859876da67 \ntc/deploy/mimi_uac/nc64.exe\n8edb867830e81c060f715b365be834677949f3fb7b7649852e6087a0f8adb115 \ntc/deploy/mimi_uac/uac_status.txt\nc27382fd82bd4af92905144b6b219c3b75cb001081f9ae683115d50d2df8382a \ntc/deploy/mimi_uac/update.js\n24aed7103a56557d5eddf54460cc9ae59e3f1ddc695c9d403e141c61e96059af \ntc/deploy/mimi_uac/a.ps1\n43c48658feb11645b32e26b8dd3db2736083047e1088cf813da75c95d50d17c5 \ntc/deploy/domain_loginlog/domain_loginlog.exe\n77820dc7dba2412933210d7ea40c11640500b54d3ac14d317187a9c2f6a96645 \ntc/deploy/winexe-static-071026\n8530dc274a9154a916af2595c4d48824e8b4015745cd452a634ae55d2786c902 \ntc/deploy/screen_XP/svhost.exe\n0abc3962c668e457beb043c2455e30585e1da8732ab42e0130fd729a8dc7ebc4 tc/python/MS17010/mysmb.py\nf64024054e3e3c9cf011b27d768bd3692fa9430ae3ec39e4e7a18133d364300c tc/python/MS17010/infoleak_uninit.py\n515284a34b406042f0eea228a5adaf705f674826999525f2d7c7f13512d5dc72 tc/python/MS17010/nc8887.read\n1b9833f28868d5a39d927f1a18f89073b82c322574b2214228201e35088314ed tc/python/MS17010/npp_control.py\n34022a65a3eb93b109ed4c6e1233c6404197818a70f51ab654e2c7e474ee2539 tc/python/MS17010/eternalblue_exploit8.py\nf5c1304be270e271e902f0229ab8d876c9ed63cbf4fe926dd1ab61f7335187a4 tc/python/MS17010/outlooks.exe\n64cf03ed475f4486147cd2cedb78db4aa7164f57b3a2c25776ed1fb28853d7e5 tc/python/MS17010/nc8887_.py\n0b0949ea092aea52f258865b278702aa1d55558a3a349805fb970ee1439f7964 tc/python/MS17010/checker.py\nb60da0fe1946329c43fbde55fa3543510830b04959605e4b9f8ea75d4451d445 tc/python/MS17010/exploit.py\na2ccf5c039464e67ff0a372f91f6e89999ee7c0ea44a6cba493e0aec28954023 tc/python/MS17010/shellcode/eternalblue_sc_merge.py\n493e3faaef103c8afd4d713b1447c5489e551892f42eba1b9383532024cdd107 tc/python/MS17010/shellcode/eternalblue_kshellcode_x64.asm\na9fdd64ccc3dfba679dd796d4e3e42e1581f48555fb47d4662f1cb4191fe1a71 tc/python/MS17010/shellcode/sc_all.bin\n312d0e8913c9d1037669a73ce07f8df98af2a6a3c9c72cb2fbd29a7857686379 tc/python/MS17010/shellcode/eternalblue_kshellcode_x86.asm\nc174f89004c2fb3e91ab8233794d055340cd2a9520dc2be8b938ebccf1c74a74 tc/python/MS17010/eternalblue7_exploit.py\n7a0774c5872df12686735efc631aa83a78bf1b6211d77ccd9a2ae0ff0adfb58c tc/python/MS17010/nc8887.py\ne9073f672596429eab45efe3e79e36e361fb220b71f4c47b32edbc6c51544494 tc/python/MS17010/eternalsynergy_leak.py\n\n```\n\n-----\n\n```\n3f106f73b51516fccb1d62265248ee03ccadf86377d66ef53a672729096d2cf3 tc/python/MS17\n010/eternalromance_poc.py\n2e2332d9119ca0075db133111ef9dfd5577cedc8df25d6a603755005a787178c tc/python/MS17010/BUG.txt\neb53bc507b64d43b3702bcabd662eddbbf468d8144e8d611fcca78bd7101cd08 tc/python/MS17010/del_outlooks.py\n2c84ce6f127ac559658ad2f5cbb5ead99c0bce27feae2f2cffcf0f1a5bc77f19 tc/python/MS17010/eternalblue_poc.py\nc49ec4e145fa4dfc63b5fe6655a84056304e61f776e3a4125b507d9f6d5fb315 tc/python/MS17010/eternalromance_poc2.py\nd20a5fce1a3fdd7b031e1f20a78206187541d6ba10d9e2d0a6472526cea2c746 tc/python/MS17010/eternalchampion_poc.py\n8e21af3c2840ff374ef5c4f98d5bd665482241c66d7fe1172023cb67ece80079 tc/python/MS17010/README.md\n99a4ded26895422707f7c92eca9c9d64212cc033c50010fb027fe32ab55386d9 tc/python/MS17010/eternalblue_exploit7.py\n2dfe1fc676fe8f5c949ac7a15491b4081a8dd8d11a3baa3442be539fe7e12e26 tc/python/MS17010/42315.py\n896610790bfa3554722518d81cd7692ba3cc963d1fd82bc6c57f7b2df7962625 tc/python/MS17010/eternalchampion_leak.py\nd37670ef452b3850d2a7d590ab3bee83902f3644cdba4e9b52fe8a2deb85402f tc/python/MS17010/eternalsynergy_poc.py\n5e58130b5598379d83300aea616d3f21aa6037e50aa41bac59dcfb993873868c tc/python/MS17010/zzz_exploit.py\ndd4798af2c60dd83852bb9f097bf82b332e6408d0c9362a477592397468553ca tc/python/MS17010/eternalchampion_poc2.py\n89e30158f62eb2e60763bc9701d750e61ede148793b411c45898c0b36f467b78 tc/python/MS17010/deluser.py\ne2022ebe819476f715b10e441ef13171317c91cfaf553302c90b77ea686b72b5 tc/python/MS17010/eternalromance_leak.py\n5dd68dc09454edb1fa4f847819e3ae48fbedacef5413f2a9ef9957602a6ad97a tc/python/MS17010/adduser.py\n624bcdae55baeef00cd11d5dfcfa60f68710a02 responder/LICENSE            \n7ca9a5cb7034b04ea6060c7f7804997b9f8ba411 responder/README.md           \n0833c52e7c2afce7ff357ee496bc2b3c6662edba responder/Responder.conf        \naca7fc6f37f789ef7a5816dce83ac4efaaa76a35 responder/Responder.py         \n90fa9a2d1db2e143eb2999f80a615f997b916407 responder/certs/gen-self-signed-cert.sh \ncde48c263fe556d21f0dacfee746b73a9d0f843c responder/certs/responder.crt      \n9439fb0577b485bea2ab5515d22ce028b1edefd7 responder/certs/responder.key\n3c1be1e572a4a475a4499d0c87979005a4927a1a responder/files/AccessDenied.html\nda35e993ca6b2f8a73bef404a32391ae2a6f6b3e responder/files/BindShell.exe\n1bb89403f629f02091397a7c34e99c2e35b7e74 responder/poisoners/LLMNR.py\n5e4d413602268e9bdabd48c486ecf164c3a188ea responder/poisoners/LLMNR.pyc\naebe1412a78a904badfa7cbed4f3ece351af6a55 responder/poisoners/MDNS.py\na048219fd8fcef6a98cb2be309135e44efcec006 responder/poisoners/MDNS.pyc\n5860c2fd3cd1a4e7203ff943753a7fbf656951dd responder/poisoners/NBTNS.py\n27deef9453ee7102f0bc42380a355124b6ad7d6a responder/ poisoners/NBTNS.pyc\nda39a3ee5e6b4b0d3255bfef95601890afd80709 responder/poisoners/__init__.py\n3e6de0af6b7c6c1aaaae7f4b5ecc3fc43c5b7859 responder/poisoners/__init__.pyc\n874ed910bf04d409d3639c2e14776c452eb1755e responder/tools/BrowserListener.py\n8b1aac92e1a185855a4b5a2f55e14b9817f95aaa responder/tools/DHCP.py\n4b22f17fd4ec78fe4b11a98ad882970a7c55b9ef responder/tools/DHCP_Auto.sh\ncf80e9f2f99ed0778fe3ac209324bf9a84be6b1f responder/tools/FindSMB2UPTime.py\nad09d51ecbdddd57cd0e1845ed6bd7a1c863a196 responder/tools/FindSQLSrv.py\n511326ff4ed1876b6b59ccfe6b8471a27309ea00 responder/tools/Icmp-Redirect.py\n3e6b7ffe886764b31757ce1bb0fd9a1854246a97 responder/tools/RelayPackets.py\n23622c8ff7baea6cac44f08ff681b37a9ee9fdd1 responder/tools/SMBRelay.py\na29540e984808a029425be53ca93ce3f8fd79a27 responder/servers/Browser.py\n5b1f743c91c868204348de30c2ba0dcc03b87833 responder/servers/Browser.pyc\n\n```\n\n-----\n\n```\ne5dc55eecb82c1d40a4b3492ced9bf19f2dae0b4 responder/servers/DNS.py\n40fa18da8bed7c4b8c42a5a038408988ab31ff82 responder/servers/DNS.pyc\n7765a0a1b66a58ae487cf76c2ec43f88c767e8dd responder/servers/FTP.py\n6c03f7b5451a3b8bdc693a02dc61d0b78269a5d6 responder/servers/FTP.pyc\nadaa025b5cf015769213738ead37ce7f032d203d responder/servers/HTTP.py\nd21d59dd2136e5fea0634a1cc6c7b36511025f67 responder/servers/HTTP.pyc\n26939dee3f00cfca80ae62745fc4b8a987e93a49 responder/servers/HTTP_Proxy.py\n10f4d968f6410179ea03a330984136cb6fffc83c responder/servers/HTTP_Proxy.pyc\n088b3ece595950ab4e471e4763bbd400ff1fca1f responder/servers/IMAP.py\n9f8014a0150badc732d07cfc381785975dee6cd7 responder/servers/IMAP.pyc\n2e1ace2fc5a63000cf71510a02e3221880c094a4 responder/servers/Kerberos.py\n6ceee9bf498f443817d8603ac1692c639ad8a59e responder/servers/Kerberos.pyc\n0bdac1da920a1c8177cf4f2abc147710f1b5ec09 responder/servers/LDAP.py\n4cfc6d04b0311f27d170c860eb8ff7e05769a502 responder/servers/LDAP.pyc\ne62c3b201a99501a626c35dc084a2201f59e2bd6 responder/servers/MSSQL.py\nf49f6878303358fa15f87bd05041515605aab802 responder/servers/MSSQL.pyc\na095b50743189513f2c62033127dd5ab23e4c3ec responder/servers/POP3.py\n32dd92688f6ab0c57acbeb63ff3b093d90440a7e responder/servers/POP3.pyc\n8e229944b428f675d27a5c99e71496907a9a17d1 responder/servers/SMB.py\n2533c2a30cb4f06d8c5fa9259e7d3d42ea40ca22 responder/servers/SMB.pyc\na472ed6415e0c00c4c4320468dcb65256138ffa5 responder/servers/SMTP.py\nad49be1fe6e6e732b875bac888d693a7c39f8132 responder/servers/SMTP.pyc\nda39a3ee5e6b4b0d3255bfef95601890afd80709 responder/servers/__init__.py\n369a6285d5047feadc3bad34bd5d914766672b81 responder/servers/__init__.pyc     \nef7d632acf72b04b6cf7500b21c4c8efe7612d4a responder/fingerprint.py        \n 4c9b5680c7575e0c08c8ff1511e4553c0136c743 responder/fingerprint.pyc       \na8236535d40dfdd2ae9b24aecbf1ba7e65313ce3 responder/odict.py           \n718d1d180ff58c198713bb27544f5f8fe5b35fc6 responder/odict.pyc           \ncc8af2c71cc4cead9ee99c268e075d2e0cb8f32d responder/packets.py          \n de600e4c57efc08ac86c63ee3a003955fc00bdc6 responder/packets.pyc         \n2cdc364e88955d8176e32e2c35026d325883c157 responder/settings.py          \n7e73cf9b4b59db4df95c8d00915ba2370b8cb538 responder/settings.pyc         \n9e6a51c50ec8c9bec41ca2c060c2029f36997a67 responder/utils.py           \n0a26c8278351f8969e7b1c63f8e4ed69cc087925 responder/utils.pyc \n\n```\nYara Rules:\n\n\n-----\n\n```\nimport pe \nimport \"math\"\nrule svchost_backdoor_UNC1945{\n     meta:\n     description = \"Yara Rule for svchost.exe backdoor of the UNC1945 arsenal\"\n    hash=”428b47caf74ce986bc3688262355d5b7”\n     author = \"Yoroi Malware Zlab\"\n     last_updated = \"2020_11_20\"\n     tlp = \"white\"\n     category = \"informational\"\nstrings:\n$s1=\"PROXYHOST\" \n$s2=\"PROXYPORT\"\n$s3=\"USERNAME\"\n$s4=\"PASSWORD\"\n$s5=\"ENDPOINT\"\n$s6=\"/cygdrive/c/windows/system32.log\"\n$s7={40 20 36 [4] C7 40 24 36 [4] C7 40 28}\ncondition:\n  uint16(0) == 0x5A4D and\n  uint32(uint32(0x3C)) == 0x00004550 and pe.number_of_sections == 5 and\nfor any i in (0..pe.number_of_sections -1 ) : (\nmath.entropy(pe.sections[i].raw_data_offset, pe.sections[i].raw_data_size) >\n7.2781 and pe.sections[i].name==\".data\" ) and ( pe.sections[2].name==\"/4\" ) and\nall of them }\n\n```\n_This blog post was authored by Luigi Martire, Antonio Pirozzi and Luca Mella of Yoroi_\n_Malware ZLAB_\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2020/2020.11.30.UNC1945/yoroi.company-Shadows%20From%20the%20Past%20Threaten%20Italian%20Enterprises.pdf"
    ],
    "report_names": [
        "yoroi.company-Shadows From the Past Threaten Italian Enterprises"
    ],
    "threat_actors": [
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ece64b74-f887-4d58-9004-2d1406d37337",
            "created_at": "2022-10-25T16:07:23.794442Z",
            "updated_at": "2025-03-27T02:02:09.981874Z",
            "deleted_at": null,
            "main_name": "LightBasin",
            "aliases": [
                "DecisiveArchitect",
                "Luminal Panda",
                "TH-239",
                "UNC1945"
            ],
            "source_name": "ETDA:LightBasin",
            "tools": [
                "CordScan",
                "EVILSUN",
                "FRP",
                "Fast Reverse Proxy",
                "Impacket",
                "LEMONSTICK",
                "LOGBLEACH",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "OKSOLO",
                "OPENSHACKLE",
                "ProxyChains",
                "Pupy",
                "PupyRAT",
                "SIGTRANslator",
                "SLAPSTICK",
                "SMBExec",
                "STEELCORGI",
                "Tiny SHell",
                "pupy",
                "tsh"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "31c0d0e1-f793-4374-90aa-138ea1daea50",
            "created_at": "2023-11-30T02:00:07.29462Z",
            "updated_at": "2025-03-27T02:00:03.256081Z",
            "deleted_at": null,
            "main_name": "LightBasin",
            "aliases": [
                "UNC1945",
                "CL-CRI-0025"
            ],
            "source_name": "MISPGALAXY:LightBasin",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041817,
    "ts_creation_date": 1610592782,
    "ts_modification_date": 1610592782,
    "files": {
        "pdf": "https://archive.orkl.eu/5e45c51ac37f98d5a77773448007d5c2d47b28f6.pdf",
        "text": "https://archive.orkl.eu/5e45c51ac37f98d5a77773448007d5c2d47b28f6.txt",
        "img": "https://archive.orkl.eu/5e45c51ac37f98d5a77773448007d5c2d47b28f6.jpg"
    }
}