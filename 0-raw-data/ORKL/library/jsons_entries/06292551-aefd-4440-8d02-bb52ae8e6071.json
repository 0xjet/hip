{
    "id": "06292551-aefd-4440-8d02-bb52ae8e6071",
    "created_at": "2023-01-12T15:07:18.710685Z",
    "updated_at": "2025-03-27T02:16:53.043832Z",
    "deleted_at": null,
    "sha1_hash": "2a537c563c5260e38c4045562812da84c933915c",
    "title": "2021-08-01 - BazarCall to Conti Ransomware via Trickbot and Cobalt Strike",
    "authors": "",
    "file_creation_date": "2022-05-28T18:04:10Z",
    "file_modification_date": "2022-05-28T18:04:10Z",
    "file_size": 2512459,
    "plain_text": "# BazarCall to Conti Ransomware via Trickbot and Cobalt Strike\n\n**[thedfirreport.com/2021/08/01/bazarcall-to-conti-ransomware-via-trickbot-and-cobalt-strike/](https://thedfirreport.com/2021/08/01/bazarcall-to-conti-ransomware-via-trickbot-and-cobalt-strike/)**\n\nAugust 1, 2021\n\n## Intro\n\nThis report will go through an intrusion that went from an Excel file to domain wide\nransomware. The threat actors used BazarCall to install Trickbot in the environment which\ndownloaded and executed a Cobalt Strike Beacon. From there the threat actor discovered\nthe internal network before moving laterally to a domain controller for additional discovery. A\ncouple days later, the threat actors came back and executed Conti ransomware across the\ndomain.\n\n[Unfamiliar with BazaCall/BazarCall? Read more here from](https://www.microsoft.com/security/blog/2021/07/29/bazacall-phony-call-centers-lead-to-exfiltration-and-ransomware/) [@MsftSecIntel,](https://twitter.com/MsftSecIntel) [@dreadphones,](https://twitter.com/dreadphones)\n& [@JCearbhall and](https://twitter.com/JCearbhall) [here from](https://unit42.paloaltonetworks.com/bazarloader-malware/) [@Unit42_Intel &](https://twitter.com/Unit42_Intel) [@malware_traffic.](https://twitter.com/malware_traffic)\n\n## Summary\n\nIn this intrusion, we observed a number of interesting techniques being leveraged by the\nthreat actors. The threat actors were able to go from initial access to the deployment of Conti\nransomware in a matter of hours. The Conti operators chose to wait a couple days before\n\n\n-----\n\nransoming the environment. Even though most of the techniques aren t new or advanced,\nthey have proven to be effective. We have observed the same techniques in other intrusions\nand understanding these techniques will allow defenders to disrupt such intrusion activity\nand deny it in their own networks.\n\n[The Trickbot payload came from a phishing campaign associated with BazarCall, delivering](https://twitter.com/ffforward/status/1403086116463562753)\nweaponized XLSB files. Upon execution, certutil.exe was copied to %programdata% and\nrenamed with random alphanumeric characters. Certutil was used to download and load the\nTrickbot DLL into memory. Trickbot was automatically tasked to inject into the wermgr.exe\nprocess and use its well-known “pwgrab” module to steal browser credentials. As part of\nfurther automated tasking, Trickbot performed an initial reconnaissance of the environment\nusing native Windows tools such as nltest.exe and net.exe.\n\nFirst hands-on activity was observed two hours after initial compromise, when Trickbot\ndownloaded and executed Cobalt Strike Beacons. To guarantee execution on the beachhead\nhost, multiple payloads were used. One of the Cobalt Strike Beacons was the same payload\n[and command and control infrastructure as used in a prior case. The initial access method](https://thedfirreport.com/2021/07/19/icedid-and-cobalt-strike-vs-antivirus/)\nfor that case was IcedID, which shows that the threat actors utilize various initial access\nmethods to get into environments and accomplish their goals.\n\nOnce access through Cobalt Strike was established, the threat actors immediately\nproceeded with domain enumeration via Nltest, AdFind, BloodHound, and PowerSploit.\nPresence was then expanded on the beachhead by using a PowerShell loader to execute\nadditional Beacons.\n\nWe observed the threat actors having technical issues. One example being with a Beacon\nunsuccessfully injecting into a process. It is unclear if this was an untrained actor, or there\nwas a configuration issue.\n\nFifteen minutes after domain enumeration, we observed successful lateral movement to two\nendpoints on the network. Ten minutes after lateral movement, a PowerShell Cobalt Strike\nloader executed as a service on a server. Even though the execution was not successful, the\nthreat actors kept trying, a total of eight times, until it finally worked. Windows Defender realtime monitoring was then disabled, the LSASS.exe process was dumped using SysInternals\n[ProcDump, and privilege was escalated to “SYSTEM” using named pipe impersonation.](https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/)\n\nAlmost four hours after initial execution, the threat actors pivoted to a domain controller using\ndomain admin credentials and executed a Cobalt Strike Beacon. Once they had domain\n[controller access, ntdsutil was used to take a snapshot of “ntds.dit”, saved under](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc753343(v=ws.11))\n“C:\\Perflogs\\1”, for offline password hash extraction. This is a technique that we don’t see\nvery often, but effective nevertheless.\n\n\n-----\n\nThe threat actors then reran many of the same discovery techniques that were previously\nexecuted on the beachhead, including AdFind and BloodHound. This was the last observed\nhands-on-keyboard activity for awhile.\n\nTwo days later, the Cobalt Strike Beacon on the domain controller was once again actively\nengaged by the threat actors. Psexec, with two separate batch files, were used to execute\nConti ransomware on all domain-joined Windows hosts. This final deployment was executed\naround 6:45 UTC on a Monday morning.\n\nFrom the point the threat actors returned, to ransom deployment, it was less than 30\nminutes. This would give defenders little time to act if they had not identified and contained\nthe activity from the first day of the Trickbot infection.\n\n## Services\n\n[We offer multiple services including a Threat Feed service which tracks Command and](https://thedfirreport.com/services/)\nControl frameworks such as Cobalt Strike, Metasploit, Empire, PoshC2, etc. More\n[information on this service and others can be found here. Two of the Cobalt Strike servers](https://thedfirreport.com/services/)\n[used in this intrusion were added to our Threat Feed on 6/3/21 and the other one was added](https://thedfirreport.com/services/)\non 6/11/21\n\nWe also have artifacts available from this case such as pcaps, memory captures, files, event\nlogs including Sysmon, Kape packages, and more, under our Security Researcher and\nOrganization services.\n\n## Timeline\n\n\n-----\n\n-----\n\n[Analysis and reporting completed by @_pete_0 and](https://twitter.com/_pete_0) [@kostastsale.](https://twitter.com/Kostastsale)\n\n[Reviewed by @RoxpinTeddy and 1 unnamed contributor.](https://twitter.com/RoxpinTeddy)\n\n## Initial Access\n\nThe initial access was achieved as a result of the user opening what appeared to be a\nbenign workbook, a lure, requiring little user interaction.\n\nThe workbook contained hidden and password protected worksheets, these were malicious.\nModule functions also indicated code designed to obfuscate and hide true values and\nfunctions.\n\n\n-----\n\nThis document and the following DLL were noted as being associated to a BazarCall\n[campaign by @ffforward.](https://twitter.com/ffforward)\n\n1/ Today [#BazarCall dropped #TrickBot gtag mon311 from their brand new website](https://twitter.com/hashtag/BazarCall?src=hash&ref_src=twsrc%5Etfw)\n/zonerphoto.us. I guess the gangs increased activity is to show that they are alive and\n[well without that random programmer? pic.twitter.com/CVfcn7b9mJ](https://t.co/CVfcn7b9mJ)\n\n[— TheAnalyst (@ffforward) June 10, 2021](https://twitter.com/ffforward/status/1403086116463562753?ref_src=twsrc%5Etfw)\n\n## Execution\n\nFrom the [xlsb document, the following execution chain occurs. Including copying the](https://tria.ge/210610-xr9avxf7f6/behavioral2)\nWindows CertUtil program and using that to collect further Trickbot payloads.\n\nWe observed a second stage execution using regsvr32 to load a DLL from the user’s\nAppData\\Local\\Temp folder.\n\nAlmost immediately an outbound IPv4 address lookup was requested via HTTP. This is\nusually undertaken to identify the compromised environment, and to facilitate C2. The user\nagent refers to Curl – and used again for another stage of the intrusion.\n\nOn the beachhead, multiple executables were saved in a temp directory and then pushed\ninto memory by TrickBot process “wermgr.exe”. The executables were identified as Cobalt\nStrike and communicated over port 443 to C2 88.80.147[.]101.\n\n\n-----\n\nA PowerShell download cradle was then used to execute Cobalt Strike Beacon in memory:\n\n## Privilege Escalation\n\nNamed pipe impersonation was used to escalate to SYSTEM privileges – a common Cobalt\nStrike capability:\n\nWe observed several attempts by the threat actor trying to escalate to SYSTEM – ultimately\nsucceeding, as evident in several new services running under the Local SYSTEM context:\n\n\n-----\n\nService creation events System Event ID 7045, coupled with unusual commands and service\nnames are a strong indication of privilege escalation activity. RedCanary provided useful\n[background on GetSystem capabilities of offensive security tools and methods of detection.](https://redcanary.com/blog/getsystem-offsec/)\n\n## Defense Evasion\n\nTrickbot made extensive use of process injection to hide in benign operating system\nprocesses. It first injected into wermgr.exe and then later into svchost.exe.\n\nAnother defense evasion technique employed by Cobalt Strike, was to disable Windows\nDefender. WMIC was used to remotely execute ‘def.bat’. The contents of ‘def.bat’:\n```\nSet-MpPreference -DisableRealtimeMonitoring $true\n\n## Credential Access\n\n```\nTrickbot made use of esentutl to gather MSEdge history, webcache, and saved passwords\nusing TrickBot’s “pwgrab” module.\n\n\n-----\n\nLSASS was dumped remotely using ProcDump. The execution took place from the\nbeachhead using WMIC.\n\n“Ntdsutil” was used to take a snapshot of ntds.dit and save it under “C:\\Perflogs\\1”. This\ntechnique is useful for offline password hash extraction. This activity occurred twice. The\nsame batch file, ‘12.bat’, was first executed in the context of SYSTEM; and secondly, in the\ncontext of a domain admin user. The contents of ‘12.bat’:\n```\nntdsutil \"ac in ntds\" \"ifm\" \"cr fu C:\\Perflogs\\1\" q q\n\n## Discovery\n\n```\nNet and Nltest commands were used to gather network and domain reconnaissance. During\nthe intrusion, this activity was seen multiple times, on multiple hosts.\n\nOther discovery commands included:\n```\nsysteminfo\nnltest /dclist:<hidden>.local\nnltest /domain_trusts /all_trusts\nnet localgroup Administrators\nwhoami.exe\" /groups\n\n```\nAdFind.exe and adf.bat were uploaded to the beachhead. adf.bat was used to execute:\n\n\n-----\n\n```\nadfind.exe f (objectcategory person)\nadfind.exe -f \"(objectcategory=organizationalUnit)\"\nadfind.exe -f \"objectcategory=computer\"\nadfind.exe -gcb -sc trustdmp\nadfind.exe -f \"(objectcategory=group)\"\nadfind.exe -subnets -f (objectCategory=subnet)\nadfind.exe -sc trustdmp\n\n```\nAdFind results were written to the following locations:\n```\nC:\\Windows\\Temp\\adf\\ad_group.txt\nC:\\Windows\\Temp\\adf\\trustdmp.txt\nC:\\Windows\\Temp\\adf\\subnets.txt\nC:\\Windows\\Temp\\adf\\ad_ous.txt\nC:\\Windows\\Temp\\adf\\ad_computers.txt\nC:\\Windows\\Temp\\adf\\ad_users.txt\n\n```\nOn the beachhead, Cobalt Strike executed BloodHound in memory. The results were saved\nin:\n```\n\"C:\\Windows\\Temp\\Dogi\"\n\n```\nBloodHound was later executed on the domain controller as well. Once again the results\nwere stored in:\n```\n\"C:\\Windows\\Temp\\Dogi\"\n\n```\nPowerSploit was loaded into memory on the DC and the following functions were used:\n```\nGet-NetSubnet\nGet-NetComputer –ping\n\n```\nAn encoded PowerShell command was executed on the domain controller to enumerate all\nAD joined hosts and save the results to:\n```\n\"C:\\Users\\AllWindows.csv\"\n\n```\nThe decoded PowerShell command:\n\n\n-----\n\n## Lateral Movement\n\nFrom the beachhead, WMIC was used to remotely execute ‘165.bat’ on two other hosts.\n\nMultiple failed attempts were observed prior to the successful execution of a PowerShell\nCobalt Strike loader via a service with “SYSTEM” privileges.\n\nDecoded Cobalt Strike shellcode, using Cyber Chef recipe:\nhttps://github.com/mattnotmax/cyberchef-recipes#recipe-28—de-obfuscation-of-cobalt-strikebeacon-using-conditional-jumps-to-obtain-shellcode\n\n## Command and Control\n\nMultiple C2 channels were established, some were persistent whilst others appeared to be\nsingle purpose – used for payload retrieval or fallback C2. Persistent C2 activity was Cobalt\nStrike. The beachhead had multiple C2 channels, two of which were unique. We assess that\n\n\n-----\n\nthe threat actors were ensuring a loss of a single source C2 wouldn t result in losing all C2 to\nthe compromised environment.\n\nWe observed a payload being retrieved from a unique IPv4 address. An indication that the\nthreat actors were keeping C2 channels independent from payload delivery/retrieval.\n\nUsing the Curl 7.74.0 user agent:\n\nAnalysis of this binary, shows C2 activity to the following:\n\nThe binary has an unusual PDB string that indicates obfuscation:\n\nThe two persistent C2 channels were analyzed to determine the Cobalt Strike configuration.\nEach C2 channel was configured as follows:\n\n149.248.52[.]187:443\nOnlineworkercz[.]com\n\n(added to [Threat Feed on 2021-06-11)](https://thedfirreport.com/services/)\n\n\n-----\n\n```\n{\n \"x86\": {\n  \"sha1\": \"3f15a07cde64efda49670664af320603cf19e8a3\",\n  \"sha256\": \"d4ab4ed720d674d4c8c35d48006724a9cf20396e020d5bd6c12fce8d44b8ed5a\",\n  \"time\": 1623422265288,\n  \"config\": {\n   \"Method 1\": \"GET\",\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\WUAUCLT[.]exe\",\n   \"Polling\": 55490,\n   \"HTTP Method Path 2\": \"/media\",\n   \"Port\": 443,\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\WUAUCLT[.]exe\",\n   \"Jitter\": 41,\n   \"C2 Server\": \"onlineworkercz[.]com,/kj\",\n   \"Method 2\": \"POST\",\n   \"Beacon Type\": \"8 (HTTPS)\"\n  },\n  \"md5\": \"7d9cdea210ed05a1ff96d7ff3e576c11\"\n },\n \"x64\": {\n  \"sha1\": \"1d50772d506f1def4bd0659b38cf4cb41df7802c\",\n  \"sha256\": \"4f009eb4252cf29daa24d1d018815aa228f0c58aba126bff3fec4cd809cd9747\",\n  \"time\": 1623422268773.6,\n  \"config\": {\n   \"Method 1\": \"GET\",\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\WUAUCLT[.]exe\",\n   \"Polling\": 55490,\n   \"HTTP Method Path 2\": \"/zh\",\n   \"Port\": 443,\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\WUAUCLT[.]exe\",\n   \"Jitter\": 41,\n   \"C2 Server\": \"onlineworkercz[.]com,/kj\",\n   \"Method 2\": \"POST\",\n   \"Beacon Type\": \"8 (HTTPS)\"\n  },\n  \"md5\": \"23135b04a470db515db11e1364e3fcd9\"\n }\n}\n\n```\n88.80.147[.]101:80\ngmbfrom[.]com\n\n(added to [Threat Feed on 2021-06-03)](https://thedfirreport.com/services/)\n\n\n-----\n\n```\n{\n \"x86\": {\n  \"sha1\": \"b785cae596f7b68376464e3e300fe0aff5bea845\",\n  \"config\": {\n   \"Method 2\": \"POST\",\n   \"Port\": 80,\n   \"Method 1\": \"GET\",\n   \"Polling\": 5000,\n   \"Beacon Type\": \"0 (HTTP)\",\n   \"Jitter\": 10,\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost[.]exe\",\n   \"C2 Server\": \"88[.]80[.]147[.]101,/jquery-3[.]3[.]1[.]min[.]js\",\n   \"HTTP Method Path 2\": \"/jquery-3[.]3[.]2[.]min[.]js\",\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost[.]exe\"\n  },\n  \"time\": 1622753064031.5,\n  \"sha256\": \"dd0dd0b3e95ff62c45af048c0169e2631ac906da4a603cadbc7014cbcfb4e631\",\n  \"md5\": \"56830f9cc0fe712e22921a7a5a0f1a53\"\n },\n \"x64\": {\n  \"sha1\": \"11724324f8ec1940be87553ae2bd5f96b979a5d6\",\n  \"config\": {\n   \"Method 2\": \"POST\",\n   \"Port\": 80,\n   \"Method 1\": \"GET\",\n   \"Polling\": 5000,\n   \"Beacon Type\": \"0 (HTTP)\",\n   \"Jitter\": 10,\n   \"Spawn To x86\": \"%windir%\\\\syswow64\\\\dllhost[.]exe\",\n   \"C2 Server\": \"88[.]80[.]147[.]101,/jquery-3[.]3[.]1[.]min[.]js\",\n   \"HTTP Method Path 2\": \"/jquery-3[.]3[.]2[.]min[.]js\",\n   \"Spawn To x64\": \"%windir%\\\\sysnative\\\\dllhost[.]exe\"\n  },\n  \"time\": 1622753068830.2,\n  \"sha256\": \"36a5e68810f3823470fadd578efb75b5c2d1ffe9f4a16d5566f0722257cc51ce\",\n  \"md5\": \"9dde7f14a076a5c3db8f4472b87fd11e\"\n }\n}\n\n```\n\n-----\n\nTrickbot C2 Configuration:\n\n[https://tria.ge/210610-vfygj4t1yn](https://tria.ge/210610-vfygj4t1yn)\n\n## Exfiltration\n\nAs part of the discovery stage, we observed data being exfiltrated. The data ranged from\nhost discovery, running processes, and user accounts:\n\nEntire AD forest data – including usernames, DC configuration, and machine enumeration:\n\n\n-----\n\n## Impact\n\nWhen, the threat actors returned two days later, the final payloads were staged by the threat\nactors on a domain controller in the following location:\n```\nC:\\share$\n\n```\nTwo batch scripts were executed on the domain controller to automate ransomware\ndeployment via PSExec. The first was “_COPY.bat”, to stage the CONTI ransomware\npayload on all domain-joined computers. The second was “_EXE.bat”, to execute the staged\nCONTI payloads.\n\nThe batch scripts ran as expected a set of copy commands and then executed the Conti\npayload using psexec.\n```\nstart PsExec.exe -accepteula @C:\\share$\\comps1.txt -u \"domain\\User\" -p \"$PASSWORD\"\ncmd /c COPY \"\\\\DOMAINCONTROLLER\\share$\\fQumH.exe\" \"C:\\windows\\temp\\\"\nstart PsExec.exe -accepteula -d @C:\\share$\\comps5.txt -u \"domain\\User\" -p \"$PASSWORD\"\ncmd /c \"C:\\windows\\temp\\fQumH.exe\"\n\n```\nFiles were then encrypted with the following extension [KCRAO]:\n\n\n-----\n\nA readme.txt file was created in each folder:\n\nThe content of readme.txt:\n\n\n-----\n\n## IOCs\n\n**Network**\n```\nCobalt Strike\n149.248.52.187|443\n88.80.147.101|80\nonlineworkercz.com\ngmbfrom.com\nTrickbot\n116.0.6.110\n123.231.149.123\n146.196.121.219\n177.221.39.161\n180.178.106.50\n85.248.1.126\n94.142.179.179\n94.142.179.77\n88.150.240.129\n46.209.140.220\n85.175.171.246\n89.37.1.2\n94.183.237.101\n103.101.104.229\n103.124.145.98\n114.7.240.222\n131.0.112.122\n123.231.149.122\n45.5.152.39\n\n```\n**File**\n\n\n-----\n\n```\nnetscan.exe\nd1d579306a4ddf79a2e7827f1625581c\ne141562aab9268faa4aba10f58052a16b471988a\nbb574434925e26514b0daf56b45163e4c32b5fc52a1484854b315f40fd8ff8d2\n12.bat\n935fa508d2c41914f4549d3805456444\nd40b5147e93204f03f0acfb3ad4cbb1b6f296a35\nf88a59e0c1aa48aa46680f28c9e09781d3f678567f38e3b1b1ba7d2437cd9e0c\ndef.bat\nabe4a11df74f6a2f07682174b5fb2876\ne928fc3d74b976c539d55f75318b5ba89dab3f11\n8a7399c37a27c46e1d61150cba71d76737233a971e0c15b07c47bcc97e710bbe\nprocdump.exe\n6a09bc6c19c4236c0bd8a01953371a29\nd1387f3c94464d81f1a64207315b13bf578fd10c\n05732e84de58a3cc142535431b3aa04efbe034cc96e837f93c360a6387d8faad\ntdr615.exe\na53f124fc4f07a26cc3497e665d0ec63\n3f0a4ed4c0c1c5e156e4d29ac4adf109faa82cd9\n12761d7a186ff14dc55dd4f59c4e3582423928f74d8741e7ec9f761f44f369e5\ntdrE934.exe\nd803ea86227c541c54b11bb583b3910f\nf1b4faf4dfbf9ada3cc1496f9f9ad352314c2d59\n48f2e2a428ec58147a4ad7cc0f06b3cf7d2587ccd47bad2ea1382a8b9c20731c\nstart.bat\n4841c54b37729544fddcd014f09aa46e\nf7d62cdca59fc09d19fa8a465ea3b2611cf797e1\nf37b6c37e95f3fa27382f8b8e6256aa05e28703332bda54184e7223f82f02114\nGet-DataInfo.ps1\n16cde93b441e4363700dfbf34c687b08\n092ac6f8d072c4cf045e35a839d5bb8f1360f1ae\na290ce75c6c6b37af077b72dc9c2c347a2eede4fafa6551387fa8469539409c7\n62.dll\n9e7756f47e57a03e6eb5fe7d2505b870\nfb6339704bf11507038ddaf8f01324da5b71ee19\n8b9d605b826258e07e63687d1cefb078008e1a9c48c34bc131d7781b142c84ab\ncancel_sub_VCP1234567890123.xlsx\n9e1ee4a42c381eabcf2cde38a1aae7c9\n015bb306d9e54001d433b3ac2e7212b864f54ae2\nfd71a2fcc0b5dd0fb0dbff257839b67749f2cadf30e2d3dae7f0e941d93d24d3\n\n## Detections\n\n```\n**Network**\n\n\n-----\n\n```\nET POLICY OpenSSL Demo CA Internet Widgits Pty (O)\nET CNC Feodo Tracker Reported CnC Server group 1\nET CNC Feodo Tracker Reported CnC Server group 2\nET CNC Feodo Tracker Reported CnC Server group 3\nET CNC Feodo Tracker Reported CnC Server group 5\nET CNC Feodo Tracker Reported CnC Server group 8\nET CNC Feodo Tracker Reported CnC Server group 9\nET CNC Feodo Tracker Reported CnC Server group 19\nET CNC Feodo Tracker Reported CnC Server group 22\nET CNC Feodo Tracker Reported CnC Server group 23\nET CNC Feodo Tracker Reported CnC Server group 24\nET POLICY HTTP traffic on port 443 (POST)\nET POLICY PE EXE or DLL Windows file download HTTP\nET POLICY curl User-Agent Outbound\nET HUNTING SUSPICIOUS Dotted Quad Host MZ Response\nET INFO Executable Download from dotted-quad Host\nET HUNTING GENERIC SUSPICIOUS POST to Dotted Quad with Fake Browser 1\nET MALWARE Trickbot Checkin Response\nET POLICY Observed Cloudflare DNS over HTTPS Domain (cloudflare-dns .com in TLS SNI)\nET HUNTING Suspicious POST with Common Windows Process Names - Possible Process List\nExfiltration\nET MALWARE Win32/Trickbot Data Exfiltration\nET POLICY IP Check wtfismyip.com\nGPL ATTACK_RESPONSE command completed\nET HUNTING Observed Suspicious SSL Cert (External IP Lookup - ident .me)\nET INFO Dotted Quad Host DLL Request\nET MALWARE Cobalt Strike Malleable C2 JQuery Custom Profile M3\nET POLICY Possible External IP Lookup ipinfo.io\n\n```\n**Sigma**\n\nAbused Debug Privilege by Arbitrary Parent Processes –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/sysmon_abusing_debug_privilege.yml\nAccessing WinAPI in PowerShell. Code Injection –\nhttps://github.com/SigmaHQ/sigma/blob/1ff5e226ad8bed34916c16ccc77ba281ca3203ae/rul\nes/windows/powershell/powershell_code_injection.yml\nBad Opsec Powershell Code Artifacts –\nhttps://github.com/SigmaHQ/sigma/blob/5e35e387dd0dcdd564db7077da3470fbc070b975/rul\nes/windows/powershell/powershell_bad_opsec_artifacts.yml\nCobaltStrike Service Installations –\nhttps://github.com/SigmaHQ/sigma/blob/b26eece20d4c19b202185a6dce86aff147e92d0f/rule\ns/windows/builtin/win_cobaltstrike_service_installs.yml\nCreateMiniDump Hacktool –\nhttps://github.com/SigmaHQ/sigma/blob/1ff5e226ad8bed34916c16ccc77ba281ca3203ae/rul\nes/windows/process_creation/win_hktl_createminidump.yml\nDomain Trust Discovery –\nhttps://github.com/SigmaHQ/sigma/blob/99b0d32cec5746c8f9a79ddbbeb53391cef326ba/rul\nes/windows/process_creation/win_trust_discovery.yml\n\n\n-----\n\nDridex Process Pattern –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_malware_dridex.yml\nEmpire PowerShell Launch Parameters –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_powershell_empire_launch.yml\nExecution from Suspicious Folder –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_execution_path.yml\nInvocation of Active Directory Diagnostic Tool (ntdsutil.exe) –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_ntdsutil.yml\nLocal Accounts Discovery –\nhttps://github.com/SigmaHQ/sigma/blob/ff0f1a0222b5100120ae3e43df18593f904c69c0/rules\n/windows/process_creation/win_local_system_owner_account_discovery.yml\nLSASS Memory Dump –\nhttps://github.com/SigmaHQ/sigma/blob/b81839e3ce507df925d6e583e569e1ac3a3894ab/rul\nes/windows/process_access/sysmon_lsass_memdump.yml\nLSASS Memory Dump File Creation –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/file_event/sysmon_lsass_memory_dump_file_creation.yml\nLSASS Memory Dumping –\nhttps://github.com/SigmaHQ/sigma/blob/ff0f1a0222b5100120ae3e43df18593f904c69c0/rules\n/windows/process_creation/win_lsass_dump.yml\nMalicious Base64 Encoded PowerShell Keywords in Command Lines –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_powershell_hidden_b64_cmd.yml\nMalicious PowerShell Commandlets –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/powershell/powershell_malicious_commandlets.yml\nMimikatz Detection LSASS Access –\nhttps://github.com/SigmaHQ/sigma/blob/b81839e3ce507df925d6e583e569e1ac3a3894ab/rul\nes/windows/deprecated/sysmon_mimikatz_detection_lsass.yml\nNet.exe Execution –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_net_execution.yml\nNon Interactive PowerShell –\nhttps://github.com/SigmaHQ/sigma/blob/1425ede905514b7dbf3c457561aaf2ff27274724/rule\ns/windows/process_creation/win_non_interactive_powershell.yml\nPowerShell as a Service in Registry –\nhttps://github.com/SigmaHQ/sigma/blob/a80c29a7c2e2e500a1a532db2a2a8bd69bd4a63d/r\nules/windows/registry_event/sysmon_powershell_as_service.yml\n\n\n-----\n\nPowerShell Download from URL –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_powershell_download.yml\nPowerShell Execution –\nhttps://github.com/SigmaHQ/sigma/blob/8aabb58eca06cc44ae21ae4d091793d8c5ca6a23/ru\nles/windows/image_load/sysmon_powershell_execution_moduleload.yml\nPowerShell Network Connections –\nhttps://github.com/SigmaHQ/sigma/blob/c91eda766032b14eee60412a14875f91664e670f/rul\nes/windows/network_connection/sysmon_powershell_network_connection.yml\nPowerShell Scripts Installed as Services –\nhttps://github.com/SigmaHQ/sigma/blob/a80c29a7c2e2e500a1a532db2a2a8bd69bd4a63d/r\nules/windows/builtin/win_powershell_script_installed_as_service.yml\nPsexec Accepteula Condition –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_psexec_eula.yml\nPsExec Tool Execution –\nhttps://github.com/SigmaHQ/sigma/blob/ea430c8823803b9026a4e6e2ea7365dc5d96f385/rul\nes/windows/other/win_tool_psexec.yml\nRare Service Installs –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/builtin/win_rare_service_installs.yml\nRegsvr32 Anomaly –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_regsvr32_anomalies.yml\nRundll32 Internet Connection –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/network_connection/sysmon_rundll32_net_connections.yml\nSuspicious AdFind Execution –\nhttps://github.com/SigmaHQ/sigma/blob/30bee7204cc1b98a47635ed8e52f44fdf776c602/rule\ns/windows/process_creation/win_susp_adfind.yml\nSuspicious Encoded PowerShell Command Line –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_powershell_enc_cmd.yml\nSuspicious In-Memory Module Execution –\nhttps://github.com/SigmaHQ/sigma/blob/5cf7078fb3d61f2c15b01d9426f07f9197dd3db1/rules\n/windows/process_access/sysmon_in_memory_assembly_execution.yml\nSuspicious PowerShell Parent Process –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_powershell_parent_process.yml\nSuspicious Remote Thread Created –\nhttps://github.com/SigmaHQ/sigma/blob/e7d9f1b4279a235406b61cc9c16fde9d7ab5e3ba/rul\nes/windows/create_remote_thread/sysmon_suspicious_remote_thread.yml\n\n\n-----\n\nSuspicious Use of Procdump –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_procdump.yml\nSuspicious Use of Procdump on LSASS –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_procdump_lsass.yml\nSuspicious WMI Execution –\nhttps://github.com/SigmaHQ/sigma/blob/5e701a2bcb353338854c8ab47de616fe7e0e56ff/rule\ns/windows/process_creation/win_susp_wmi_execution.yml\nTrickbot Malware Recon Activity –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_malware_trickbot_recon_activity.yml\nUNC2452 Process Creation Patterns –\nhttps://github.com/SigmaHQ/sigma/blob/e7d9f1b4279a235406b61cc9c16fde9d7ab5e3ba/rul\nes/windows/process_creation/win_apt_unc2452_cmds.yml\nUsage of Sysinternals Tools –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/registry_event/sysmon_sysinternals_eula_accepted.yml\nWhoami Execution –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/process_creation/win_susp_whoami.yml\nWindows Network Enumeration –\nhttps://github.com/SigmaHQ/sigma/blob/ff0f1a0222b5100120ae3e43df18593f904c69c0/rules\n/windows/process_creation/win_net_enum.yml\nWindows PowerShell Web Request –\nhttps://github.com/SigmaHQ/sigma/blob/08ca62cc8860f4660e945805d0dd615ce75258c1/rul\nes/windows/powershell/win_powershell_web_request.yml\n\n**Yara Rules**\n\n\n-----\n\n```\n/\nYARA Rule Set\nAuthor: The DFIR Report\nDate: 2021-08-02\nIdentifier: 4641\nReference: https://thedfirreport.com\n*/\n/* Rule Set ----------------------------------------------------------------- */\nimport \"pe\"\nrule sig_4641_fQumH {\nmeta:\ndescription = \"4641 - file fQumH.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-08-02\"\nhash1 = \"3420a0f6f0f0cc06b537dc1395638be0bffa89d55d47ef716408309e65027f31\"\nstrings:\n$s1 = \"Usage: .system COMMAND\" fullword ascii\n$s2 = \"Usage: .log FILENAME\" fullword ascii\n$s3 = \"* If FILE begins with \\\"|\\\" then it is a command that generates the\" fullword\nascii\n$s4 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s5 = \"Usage %s sub-command ?switches...?\" fullword ascii\n$s6 = \"attach debugger to process %d and press any key to continue.\" fullword ascii\n$s7 = \"%s:%d: expected %d columns but found %d - extras ignored\" fullword ascii\n$s8 = \"%s:%d: expected %d columns but found %d - filling the rest with NULL\" fullword\nascii\n$s9 = \"Unknown option \\\"%s\\\" on \\\".dump\\\"\" fullword ascii\n$s10 = \"REPLACE INTO temp.sqlite_parameters(key,value)VALUES(%Q,%s);\" fullword ascii\n$s11 = \"error in %s %s%s%s: %s\" fullword ascii\n$s12 = \"UPDATE temp.sqlite_master SET sql = sqlite_rename_column(sql, type, name, %Q,\n%Q, %d, %Q, %d, 1) WHERE type IN ('trigger', 'view\" ascii\n$s13 = \"BBBBBBBBBBBBBBBBBBBB\" wide /* reversed goodware string 'BBBBBBBBBBBBBBBBBBBB'\n*/\n$s14 = \"UPDATE temp.sqlite_master SET sql = sqlite_rename_column(sql, type, name, %Q,\n%Q, %d, %Q, %d, 1) WHERE type IN ('trigger', 'view\" ascii\n$s15 = \");CREATE TEMP TABLE [_shell$self](op,cmd,ans);\" fullword ascii\n$s16 = \"SqlExec\" fullword ascii\n$s17 = \"* If neither --csv or --ascii are used, the input mode is derived\" fullword\nascii\n$s18 = \"Where sub-commands are:\" fullword ascii\n$s19 = \"max rootpage (%d) disagrees with header (%d)\" fullword ascii\n$s20 = \"-- Query %d --------------------------------\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 4000KB and\n( pe.imphash() == \"67f1f64a3db0d22bf48121a6cea1da22\" or 8 of them )\n}\nrule sig_4641_62 {\nmeta:\ndescription = \"4641 - file 62.dll\"\nauthor = \"The DFIR Report\"\n\n```\n\n-----\n\n```\nreference https://thedfirreport.com\ndate = \"2021-08-02\"\nhash1 = \"8b9d605b826258e07e63687d1cefb078008e1a9c48c34bc131d7781b142c84ab\"\nstrings:\n$s1 = \"Common causes completion include incomplete download and damaged media\"\nfullword ascii\n$s2 = \"An error occurred writing to the file\" fullword ascii\n$s3 = \"asks should be performed?\" fullword ascii\n$s4 = \"The waiting time for the end of the launch was exceeded for an unknown reason\"\nfullword ascii\n$s5 = \"Select the Start Menu folder in which you would like Setup to create the\nprograms shortcuts, then click Next. Which additional t\" ascii\n$s6 = \"HcA<E3\" fullword ascii /* Goodware String - occured 1 times */\n$s7 = \"Select the Start Menu folder in which you would like Setup to create the\nprograms shortcuts, then click Next. Which additional t\" ascii\n$s8 = \"D$([email protected]\" fullword ascii /* Goodware String - occured 1 times */\n$s9 = \"Please verify that the correct path and file name are given\" fullword ascii\n$s10 = \"Critical error\" fullword ascii\n$s11 = \"Please read this information carefully\" fullword ascii\n$s12 = \"Unknown error occurred for time: \" fullword ascii\n$s13 = \"E 3y4i\" fullword ascii\n$s14 = \"D$tOuo2\" fullword ascii\n$s15 = \"D$PH9D$8tXH\" fullword ascii\n$s16 = \"E$hik7\" fullword ascii\n$s17 = \"D$p]mjk\" fullword ascii\n$s18 = \"B):0~\\\"Z\" fullword ascii\n$s19 = \"Richo/\" fullword ascii\n$s20 = \"D$xJij\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 70KB and\n( pe.imphash() == \"42205b145650671fa4469a6321ccf8bf\" and pe.exports(\"StartW\") or 8 of\nthem )\n}\nrule sig_4641_tdrE934 {\nmeta:\ndescription = \"4641 - file tdrE934.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-08-02\"\nhash1 = \"48f2e2a428ec58147a4ad7cc0f06b3cf7d2587ccd47bad2ea1382a8b9c20731c\"\nstrings:\n$s1 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s2 =\n\"D:\\\\1W7w3cZ63gF\\\\wFIFSV\\\\YFU1GTi1\\\\i5G3cr\\\\Wb2f\\\\Cvezk3Oz\\\\2Zi9ir\\\\S76RW\\\\RE5kLijcf.p\n fullword ascii\n$s3 = \"https://sectigo.com/CPS0\" fullword ascii\n$s4 = \"2http://crl.comodoca.com/AAACertificateServices.crl04\" fullword ascii\n$s5 = \"?http://crl.usertrust.com/USERTrustRSACertificationAuthority.crl0v\" fullword\nascii\n$s6 = \"3http://crt.usertrust.com/USERTrustRSAAddTrustCA.crt0%\" fullword ascii\n$s7 = \"ntdll.dlH\" fullword ascii\n$s8 = \"http://ocsp.sectigo.com0\" fullword ascii\n$s9 = \"2http://crl.sectigo.com/SectigoRSACodeSigningCA.crl0s\" fullword ascii\n$s10 = \"2http://crt.sectigo.com/SectigoRSACodeSigningCA.crt0#\" fullword ascii\n\n```\n\n-----\n\n```\n$s11 \n\"tmnEt6XElyFyz2dg5EP4TMpAvGdGtork5EZcpw3eBwJQFABWlUZa5slcF6hqfGb2HgPed49gr2baBCLwRel8z\n fullword ascii\n$s12 = \"[email protected]\" fullword ascii\n$s13 = \"operator co_await\" fullword ascii\n$s14 = \"ZGetModuleHandle\" fullword ascii\n$s15 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s16 = \"RtlExitUserThrea`NtFlushInstruct\" fullword ascii\n$s17 = \"UAWAVAUATVWSH\" fullword ascii\n$s18 = \"AWAVAUATVWUSH\" fullword ascii\n$s19 = \"AWAVVWSH\" fullword ascii\n$s20 = \"UAWAVATVWSH\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 2000KB and\n( pe.imphash() == \"4f1ec786c25f2d49502ba19119ebfef6\" or 8 of them )\n}\nrule sig_4641_netscan {\nmeta:\ndescription = \"4641 - file netscan.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-08-02\"\nhash1 = \"bb574434925e26514b0daf56b45163e4c32b5fc52a1484854b315f40fd8ff8d2\"\nstrings:\n$s1 = \"netscan.exe\" fullword ascii\n$s2 = \"TFMREMOTEPOWERSHELL\" fullword wide\n$s3 = \"TFMREMOTEPOWERSHELLEDIT\" fullword wide\n$s4 = \"TFMBASEDIALOGREMOTEEDIT\" fullword wide\n$s5 = \"*http://crl4.digicert.com/assured-cs-g1.crl0L\" fullword ascii\n$s6 = \"*http://crl3.digicert.com/assured-cs-g1.crl00\" fullword ascii\n$s7 = \"TFMIGNOREADDRESS\" fullword wide\n$s8 = \"TREMOTECOMMONFORM\" fullword wide\n$s9 = \"TFMSTOPSCANDIALOG\" fullword wide\n$s10 = \"TFMBASEDIALOGSHUTDOWN\" fullword wide\n$s11 = \"TFMBASEDIALOG\" fullword wide\n$s12 = \"TFMOFFLINEDIALOG\" fullword wide\n$s13 = \"TFMLIVEDISPLAYLOG\" fullword wide\n$s14 = \"TFMHOSTPROPS\" fullword wide\n$s15 = \"GGG`BBB\" fullword ascii /* reversed goodware string 'BBB`GGG' */\n$s16 = \"SoftPerfect Network Scanner\" fullword wide\n$s17 = \"TUSERPROMPTFORM\" fullword wide\n$s18 = \"TFMREMOTESSH\" fullword wide\n$s19 = \"TFMREMOTEGROUPSEDIT\" fullword wide\n$s20 = \"TFMREMOTEWMI\" fullword wide\ncondition:\nuint16(0) == 0x5a4d and filesize < 6000KB and\n( pe.imphash() == \"573e7039b3baff95751bded76795369e\" and (\npe.exports(\"__dbk_fcall_wrapper\") and pe.exports(\"dbkFCallWrapperAddr\") ) or 8 of\nthem )\n}\nrule sig_4641_tdr615 {\nmeta:\ndescription = \"4641 - file tdr615.exe\"\n\n```\n\n-----\n\n```\nauthor The DFIR Report\nreference = \"https://thedfirreport.com\"\ndate = \"2021-08-02\"\nhash1 = \"12761d7a186ff14dc55dd4f59c4e3582423928f74d8741e7ec9f761f44f369e5\"\nstrings:\n$s1 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$s2 = \"I:\\\\RoDcnyLYN\\\\k1GP\\\\ap0pivKfOF\\\\odudwtm30XMz\\\\UnWdqN\\\\01\\\\7aXg1kTkp.pdb\"\nfullword ascii\n$s3 = \"https://sectigo.com/CPS0\" fullword ascii\n$s4 = \"2http://crl.comodoca.com/AAACertificateServices.crl04\" fullword ascii\n$s5 = \"?http://crl.usertrust.com/USERTrustRSACertificationAuthority.crl0v\" fullword\nascii\n$s6 = \"3http://crt.usertrust.com/USERTrustRSAAddTrustCA.crt0%\" fullword ascii\n$s7 = \"http://ocsp.sectigo.com0\" fullword ascii\n$s8 = \"2http://crl.sectigo.com/SectigoRSACodeSigningCA.crl0s\" fullword ascii\n$s9 = \"2http://crt.sectigo.com/SectigoRSACodeSigningCA.crt0#\" fullword ascii\n$s10 = \"[email protected]\" fullword ascii\n$s11 = \"operator co_await\" fullword ascii\n$s12 = \"GetModuleHandleRNtUnmapViewOfSe\" fullword ascii\n$s13 = \"+GetProcAddress\" fullword ascii\n$s14 = \"api-ms-win-appmodel-runtime-l1-1-2\" fullword wide\n$s15 = \"RtlExitUserThrebNtFlushInstruct\" fullword ascii\n$s16 = \"Sectigo Limited1$0\\\"\" fullword ascii\n$s17 = \"b<log10\" fullword ascii\n$s18 = \"D*<W -\" fullword ascii\n$s19 = \"WINDOWSPROJECT1\" fullword wide\n$s20 = \"WindowsProject1\" fullword wide\ncondition:\nuint16(0) == 0x5a4d and filesize < 10000KB and\n( pe.imphash() == \"555560b7871e0ba802f2f6fbf05d9bfa\" or 8 of them )\n}\nrule CS_DLL {\nmeta:\ndescription = \"62.dll\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\ndate = \"2021-07-07\"\nhash1 = \"8b9d605b826258e07e63687d1cefb078008e1a9c48c34bc131d7781b142c84ab\"\nstrings:\n$s1 = \"Common causes completion include incomplete download and damaged media\"\nfullword ascii\n$s2 = \"StartW\" fullword ascii\n$s4 = \".rdata$zzzdbg\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 70KB and ( pe.imphash() ==\n\"42205b145650671fa4469a6321ccf8bf\" )\nor (all of them)\n}\nrule tdr615_exe {\nmeta:\ndescription = \"Cobalt Strike on beachhead: tdr615.exe\"\nauthor = \"The DFIR Report\"\nreference = \"https://thedfirreport.com\"\n\n```\n\n-----\n\n```\ndate 2021 07 07 \nhash1 = \"12761d7a186ff14dc55dd4f59c4e3582423928f74d8741e7ec9f761f44f369e5\"\nstrings:\n$a1 = \"AppPolicyGetProcessTerminationMethod\" fullword ascii\n$a2 = \"I:\\\\RoDcnyLYN\\\\k1GP\\\\ap0pivKfOF\\\\odudwtm30XMz\\\\UnWdqN\\\\01\\\\7aXg1kTkp.pdb\"\nfullword ascii\n$b1 = \"[email protected]\" fullword ascii\n$b2 = \"operator co_await\" fullword ascii\n$b3 = \"GetModuleHandleRNtUnmapViewOfSe\" fullword ascii\n$b4 = \"RtlExitUserThrebNtFlushInstruct\" fullword ascii\n$c1 = \"Jersey City1\" fullword ascii\n$c2 = \"Mariborska cesta 971\" fullword ascii\ncondition:\nuint16(0) == 0x5a4d and filesize < 10000KB and\nany of ($a* ) and 2 of ($b* ) and any of ($c* )\n}\n\n```\n**MITRE**\n\nPhishing: Spearphishing Attachment – T1566.001\nSigned Binary Proxy Execution: Regsvr32 – T1218.010\nImpair Defenses: Disable or Modify Tools – T1562.001\nDomain Trust Discovery – T1482\nOS Credential Dumping: LSASS Memory – T1003.001\nSystem Owner/User Discovery – T1033\nCommand and Scripting Interpreter: PowerShell – T1059.001\nData Staged: Local Data Staging – T1074.001\nSystem Information Discovery – T1082\nAccount Discovery: Local Account – T1087.001\nAccount Discovery: Domain Account – T1087.002\nOS Credential Dumping: NTDS – T1003.003\nWindows Management Instrumentation – T1047\nBrowser Bookmark Discovery – T1217\nData Encrypted for Impact – T1486\nRemote Services: SMB/Windows Admin Shares – T1021.002\n\n**MITRE Software**\n\nAdFind – S0552\nBloodHound – S0521\nCobalt Strike – S0154\nSysteminfo – S0096\nNet – S0039\nNltest – S0359\n\n\n-----\n\nEsentutl – S0404\nPsExec – S0029\nCmd – S0106\n\n**References**\n\nTrickBot Malware Alert (AA21-076A), US CERT – https://us-cert.cisa.gov/ncas/alerts/aa21076a\n\n[Advisory: Trickbot, NCSC – https://www.ncsc.gov.uk/news/trickbot-advisory](https://www.ncsc.gov.uk/news/trickbot-advisory)\n\nTrickbot Still Alive and Well, The DFIR Report – https://thedfirreport.com/2021/01/11/trickbotstill-alive-and-well/\n\nHunting for GetSystem in offensive security tools, RedCanary –\n[https://redcanary.com/blog/getsystem-offsec/](https://redcanary.com/blog/getsystem-offsec/)\n\nTrickBot Banking Trojan, ThreatPost – https://threatpost.com/trickbot-banking-trojanmodule/167521/\n\nInternal case #4641\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-01 - BazarCall to Conti Ransomware via Trickbot and Cobalt Strike.pdf"
    ],
    "report_names": [
        "2021-08-01 - BazarCall to Conti Ransomware via Trickbot and Cobalt Strike.pdf"
    ],
    "threat_actors": [
        {
            "id": "4b076dcb-516e-42fb-9c8f-f153902cd5e9",
            "created_at": "2022-10-25T16:07:23.708745Z",
            "updated_at": "2025-03-27T02:02:09.935617Z",
            "deleted_at": null,
            "main_name": "Hidden Lynx",
            "aliases": [
                "Aurora Panda",
                "Group 8",
                "Hidden Lynx",
                "Operation SMN"
            ],
            "source_name": "ETDA:Hidden Lynx",
            "tools": [
                "AGENT.ABQMR",
                "AGENT.AQUP.DROPPER",
                "AGENT.BMZA",
                "AGENT.GUNZ",
                "BlackCoffee",
                "HiKit",
                "MCRAT.A",
                "Mdmbot.E",
                "Moudoor",
                "Naid",
                "PNGRAT",
                "Trojan.Naid",
                "ZoxPNG",
                "gresim"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b43e5ea9-d8c8-4efa-b5bf-f1efb37174ba",
            "created_at": "2022-10-25T16:07:24.36191Z",
            "updated_at": "2025-03-27T02:02:10.1909Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "Dark Halo",
                "Nobelium",
                "SolarStorm",
                "StellarParticle",
                "UNC2452"
            ],
            "source_name": "ETDA:UNC2452",
            "tools": [],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "70872c3a-e788-4b55-a7d6-b2df52001ad0",
            "created_at": "2023-01-06T13:46:39.18401Z",
            "updated_at": "2025-03-27T02:00:03.01553Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "DarkHalo",
                "StellarParticle",
                "NOBELIUM",
                "Solar Phoenix",
                "Midnight Blizzard"
            ],
            "source_name": "MISPGALAXY:UNC2452",
            "tools": [
                "SNOWYAMBER",
                "HALFRIG",
                "QUARTERRIG"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d18fe42c-8407-4f96-aee0-a04e6dce219a",
            "created_at": "2023-01-06T13:46:38.275292Z",
            "updated_at": "2025-03-27T02:00:02.79092Z",
            "deleted_at": null,
            "main_name": "APT12",
            "aliases": [
                "Calc Team",
                "IXESHE",
                "BRONZE GLOBE",
                "BeeBus",
                "DynCalc",
                "DNSCalc",
                "Crimson Iron",
                "NUMBERED PANDA",
                "TG-2754",
                "Group 22"
            ],
            "source_name": "MISPGALAXY:APT12",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "5cbf6c32-482d-4cd2-9d11-0d9311acdc28",
            "created_at": "2023-01-06T13:46:38.39927Z",
            "updated_at": "2025-03-27T02:00:02.823829Z",
            "deleted_at": null,
            "main_name": "ENERGETIC BEAR",
            "aliases": [
                "DYMALLOY",
                "TG-4192",
                "Crouching Yeti",
                "Group 24",
                "Havex",
                "IRON LIBERTY",
                "Blue Kraken",
                "ALLANITE",
                "Koala Team",
                "G0035",
                "ATK6",
                "ITG15",
                "Ghost Blizzard",
                "BERSERK BEAR"
            ],
            "source_name": "MISPGALAXY:ENERGETIC BEAR",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "1d3f9dec-b033-48a5-8b1e-f67a29429e89",
            "created_at": "2022-10-25T15:50:23.739197Z",
            "updated_at": "2025-03-27T02:00:55.536417Z",
            "deleted_at": null,
            "main_name": "UNC2452",
            "aliases": [
                "UNC2452",
                "NOBELIUM",
                "StellarParticle",
                "Dark Halo"
            ],
            "source_name": "MITRE:UNC2452",
            "tools": [
                "Sibot",
                "Mimikatz",
                "Cobalt Strike",
                "AdFind",
                "GoldMax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "cf7fc640-acfe-41c4-9f3d-5515d53a3ffb",
            "created_at": "2023-01-06T13:46:38.228042Z",
            "updated_at": "2025-03-27T02:00:02.775905Z",
            "deleted_at": null,
            "main_name": "APT1",
            "aliases": [
                "GIF89a",
                "G0006",
                "PLA Unit 61398",
                "Group 3",
                "TG-8223",
                "Comment Group",
                "ShadyRAT",
                "COMMENT PANDA",
                "Comment Crew",
                "Byzantine Candor",
                "Brown Fox"
            ],
            "source_name": "MISPGALAXY:APT1",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "3a0be4ff-9074-4efd-98e4-47c6a62b14ad",
            "created_at": "2022-10-25T16:07:23.590051Z",
            "updated_at": "2025-03-27T02:02:09.878211Z",
            "deleted_at": null,
            "main_name": "Energetic Bear",
            "aliases": [
                "ATK 6",
                "Blue Kraken",
                "Crouching Yeti",
                "Dragonfly",
                "Electrum",
                "Energetic Bear",
                "Ghost Blizzard",
                "Group 24",
                "ITG15",
                "Iron Liberty",
                "Koala Team",
                "TG-4192"
            ],
            "source_name": "ETDA:Energetic Bear",
            "tools": [
                "Backdoor.Oldrea",
                "CRASHOVERRIDE",
                "Commix",
                "CrackMapExec",
                "CrashOverride",
                "Dirsearch",
                "Dorshel",
                "Fertger",
                "Fuerboos",
                "Goodor",
                "Havex",
                "Havex RAT",
                "Hello EK",
                "Heriplor",
                "Impacket",
                "Industroyer",
                "Karagany",
                "Karagny",
                "LightsOut 2.0",
                "LightsOut EK",
                "Listrix",
                "Oldrea",
                "PEACEPIPE",
                "PHPMailer",
                "PsExec",
                "SMBTrap",
                "Subbrute",
                "Sublist3r",
                "Sysmain",
                "Trojan.Karagany",
                "WSO",
                "Webshell by Orb",
                "Win32/Industroyer",
                "Wpscan",
                "nmap",
                "sqlmap",
                "xFrost"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "5b748f86-ac32-4715-be9f-6cf25ae48a4e",
            "created_at": "2024-06-04T02:03:07.956135Z",
            "updated_at": "2025-03-27T02:05:17.407352Z",
            "deleted_at": null,
            "main_name": "IRON HEMLOCK",
            "aliases": [
                "ATK7 ",
                "Blue Kitsune ",
                "Cozy Bear ",
                "The Dukes",
                "UNC2452 ",
                "YTTRIUM ",
                "APT29 "
            ],
            "source_name": "Secureworks:IRON HEMLOCK",
            "tools": [
                " CozyCar",
                " CozyDuke",
                " DiefenDuke",
                " FatDuke",
                " HAMMERTOSS",
                " LiteDuke",
                " MiniDuke",
                " OnionDuke",
                " PolyglotDuke",
                " RegDuke",
                " RegDuke Loader",
                " SeaDuke",
                " Sliver",
                "CosmicDuke"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "c5f79f58-db78-4cd7-88cf-c029a2199360",
            "created_at": "2022-10-25T16:07:23.325227Z",
            "updated_at": "2025-03-27T02:02:09.738383Z",
            "deleted_at": null,
            "main_name": "APT 12",
            "aliases": [
                "APT 12",
                "BeeBus",
                "Bronze Globe",
                "CTG-8223",
                "Calc Team",
                "Crimson Iron",
                "DNSCalc",
                "DynCALC",
                "Group 22",
                "Numbered Panda"
            ],
            "source_name": "ETDA:APT 12",
            "tools": [
                "AUMLIB",
                "ETUMBOT",
                "Exploz",
                "Graftor",
                "HIGHTIDE",
                "IHEATE",
                "IXESHE",
                "RIPTIDE",
                "RapidStealer",
                "Specfix",
                "THREEBYTE",
                "bbsinfo",
                "mswab",
                "yayih"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a7aefdda-98f1-4790-a32d-14cc99de2d60",
            "created_at": "2023-01-06T13:46:38.281844Z",
            "updated_at": "2025-03-27T02:00:02.792526Z",
            "deleted_at": null,
            "main_name": "APT17",
            "aliases": [
                "G0025",
                "AURORA PANDA",
                "Group 72",
                "G0001",
                "HELIUM",
                "Group 8",
                "Hidden Lynx",
                "Tailgater Team",
                "BRONZE KEYSTONE"
            ],
            "source_name": "MISPGALAXY:APT17",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d1f8bd4e-bcd4-4101-9158-6158f1806b38",
            "created_at": "2023-01-06T13:46:39.487358Z",
            "updated_at": "2025-03-27T02:00:03.107568Z",
            "deleted_at": null,
            "main_name": "BazarCall",
            "aliases": [
                "BazaCall",
                "BazzarCall"
            ],
            "source_name": "MISPGALAXY:BazarCall",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a241a1ca-2bc9-450b-a07b-aae747ee2710",
            "created_at": "2024-06-19T02:03:08.150052Z",
            "updated_at": "2025-03-27T02:05:17.409596Z",
            "deleted_at": null,
            "main_name": "IRON RITUAL",
            "aliases": [
                "Blue Dev 5 ",
                "BlueBravo ",
                "Cloaked Ursa ",
                "CozyLarch ",
                "Dark Halo ",
                "Midnight Blizzard ",
                "NOBELIUM ",
                "StellarParticle ",
                "UNC2452 ",
                "APT29"
            ],
            "source_name": "Secureworks:IRON RITUAL",
            "tools": [
                " Cobalt Strike",
                " EnvyScout",
                " GoldFinder",
                " GoldMax",
                " NativeZone",
                " RAINDROP",
                " SUNBURST",
                " Sibot",
                " TEARDROP",
                " VaporRage",
                "Brute Ratel C4"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "20d3a08a-3b97-4b2f-90b8-92a89089a57a",
            "created_at": "2022-10-25T15:50:23.548494Z",
            "updated_at": "2025-03-27T02:00:55.49688Z",
            "deleted_at": null,
            "main_name": "APT29",
            "aliases": [
                "APT29",
                "IRON RITUAL",
                "IRON HEMLOCK",
                "NobleBaron",
                "Dark Halo",
                "NOBELIUM",
                "UNC2452",
                "YTTRIUM",
                "The Dukes",
                "Cozy Bear",
                "CozyDuke",
                "SolarStorm",
                "Blue Kitsune",
                "UNC3524",
                "Midnight Blizzard"
            ],
            "source_name": "MITRE:APT29",
            "tools": [
                "PinchDuke",
                "ROADTools",
                "WellMail",
                "CozyCar",
                "Mimikatz",
                "Tasklist",
                "OnionDuke",
                "FatDuke",
                "POSHSPY",
                "EnvyScout",
                "SoreFang",
                "GeminiDuke",
                "GoldMax",
                "FoggyWeb",
                "SDelete",
                "PolyglotDuke",
                "AADInternals",
                "MiniDuke",
                "SeaDuke",
                "Sibot",
                "RegDuke",
                "CloudDuke",
                "GoldFinder",
                "AdFind",
                "PsExec",
                "NativeZone",
                "Systeminfo",
                "ipconfig",
                "Impacket",
                "Cobalt Strike",
                "PowerDuke",
                "QUIETEXIT",
                "HAMMERTOSS",
                "BoomBox",
                "CosmicDuke",
                "WellMess",
                "VaporRage",
                "LiteDuke"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f27790ff-4ee0-40a5-9c84-2b523a9d3270",
            "created_at": "2022-10-25T16:07:23.341684Z",
            "updated_at": "2025-03-27T02:02:09.74554Z",
            "deleted_at": null,
            "main_name": "APT 29",
            "aliases": [
                "APT 29",
                "ATK 7",
                "Blue Dev 5",
                "BlueBravo",
                "Cloaked Ursa",
                "CloudLook",
                "Cozy Bear",
                "Dark Halo",
                "Earth Koshchei",
                "Grizzly Steppe",
                "Group 100",
                "ITG11",
                "Iron Hemlock",
                "Iron Ritual",
                "Midnight Blizzard",
                "Minidionis",
                "Nobelium",
                "NobleBaron",
                "Operation Ghost",
                "Operation Office monkeys",
                "Operation StellarParticle",
                "SilverFish",
                "Solar Phoenix",
                "SolarStorm",
                "StellarParticle",
                "TEMP.Monkeys",
                "The Dukes",
                "UNC2452",
                "UNC3524",
                "Yttrium"
            ],
            "source_name": "ETDA:APT 29",
            "tools": [
                "7-Zip",
                "ATI-Agent",
                "AdFind",
                "Agentemis",
                "AtNow",
                "BEATDROP",
                "BotgenStudios",
                "CEELOADER",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobalt Strike",
                "CobaltStrike",
                "CosmicDuke",
                "Cozer",
                "CozyBear",
                "CozyCar",
                "CozyDuke",
                "Danfuan",
                "EnvyScout",
                "EuroAPT",
                "FatDuke",
                "FoggyWeb",
                "GeminiDuke",
                "Geppei",
                "GoldFinder",
                "GoldMax",
                "GraphDrop",
                "GraphicalNeutrino",
                "GraphicalProton",
                "HAMMERTOSS",
                "HammerDuke",
                "LOLBAS",
                "LOLBins",
                "LiteDuke",
                "Living off the Land",
                "MagicWeb",
                "Mimikatz",
                "MiniDionis",
                "MiniDuke",
                "NemesisGemina",
                "NetDuke",
                "OnionDuke",
                "POSHSPY",
                "PinchDuke",
                "PolyglotDuke",
                "PowerDuke",
                "QUIETEXIT",
                "ROOTSAW",
                "RegDuke",
                "Rubeus",
                "SNOWYAMBER",
                "SPICYBEAT",
                "SUNSHUTTLE",
                "SeaDaddy",
                "SeaDask",
                "SeaDesk",
                "SeaDuke",
                "Sharp-SMBExec",
                "SharpView",
                "Sibot",
                "Solorigate",
                "SoreFang",
                "TinyBaron",
                "WINELOADER",
                "WellMail",
                "WellMess",
                "cobeacon",
                "elf.wellmess",
                "reGeorg",
                "tDiscoverer"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "3aaf0755-5c9b-4612-9f0e-e266ef1bdb4b",
            "created_at": "2022-10-25T16:07:23.480196Z",
            "updated_at": "2025-03-27T02:02:09.826059Z",
            "deleted_at": null,
            "main_name": "Comment Crew",
            "aliases": [
                "APT 1",
                "BrownFox",
                "Byzantine Candor",
                "Byzantine Hades",
                "Comment Crew",
                "Comment Panda",
                "GIF89a",
                "Group 3",
                "Operation Oceansalt",
                "Operation Seasalt",
                "Operation Siesta",
                "Shanghai Group",
                "TG-8223"
            ],
            "source_name": "ETDA:Comment Crew",
            "tools": [
                "Auriga",
                "Cachedump",
                "Chymine",
                "CookieBag",
                "Darkmoon",
                "GDOCUPLOAD",
                "GLOOXMAIL",
                "GREENCAT",
                "Gen:Trojan.Heur.PT",
                "GetMail",
                "Hackfase",
                "Hacksfase",
                "Helauto",
                "Kurton",
                "LETSGO",
                "LIGHTBOLT",
                "LIGHTDART",
                "LOLBAS",
                "LOLBins",
                "LONGRUN",
                "Living off the Land",
                "Lslsass",
                "MAPIget",
                "ManItsMe",
                "Mimikatz",
                "MiniASP",
                "Oceansalt",
                "Pass-The-Hash Toolkit",
                "Poison Ivy",
                "ProcDump",
                "Riodrv",
                "SPIVY",
                "Seasalt",
                "ShadyRAT",
                "StarsyPound",
                "TROJAN.COOKIES",
                "TROJAN.FOXY",
                "TabMsgSQL",
                "Tarsip",
                "Trojan.GTALK",
                "WebC2",
                "WebC2-AdSpace",
                "WebC2-Ausov",
                "WebC2-Bolid",
                "WebC2-Cson",
                "WebC2-DIV",
                "WebC2-GreenCat",
                "WebC2-Head",
                "WebC2-Kt3",
                "WebC2-Qbp",
                "WebC2-Rave",
                "WebC2-Table",
                "WebC2-UGX",
                "WebC2-Yahoo",
                "Wordpress Bruteforcer",
                "bangat",
                "gsecdump",
                "pivy",
                "poisonivy",
                "pwdump",
                "zxdosml"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536038,
    "ts_updated_at": 1743041813,
    "ts_creation_date": 1653761050,
    "ts_modification_date": 1653761050,
    "files": {
        "pdf": "https://archive.orkl.eu/2a537c563c5260e38c4045562812da84c933915c.pdf",
        "text": "https://archive.orkl.eu/2a537c563c5260e38c4045562812da84c933915c.txt",
        "img": "https://archive.orkl.eu/2a537c563c5260e38c4045562812da84c933915c.jpg"
    }
}