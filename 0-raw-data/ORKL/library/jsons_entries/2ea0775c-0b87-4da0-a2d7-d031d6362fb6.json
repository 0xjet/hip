{
    "id": "2ea0775c-0b87-4da0-a2d7-d031d6362fb6",
    "created_at": "2023-01-12T15:00:36.676382Z",
    "updated_at": "2025-03-27T02:16:28.78396Z",
    "deleted_at": null,
    "sha1_hash": "76ef25e7ad940f0892e6ea07a7364777bed00261",
    "title": "2019-03-24 - JEShell- An OceanLotus (APT32) Backdoor",
    "authors": "",
    "file_creation_date": "2022-05-28T17:32:48Z",
    "file_modification_date": "2022-05-28T17:32:48Z",
    "file_size": 1019445,
    "plain_text": "# JEShell: An OceanLotus (APT32) Backdoor\n\n**[norfolkinfosec.com/jeshell-an-oceanlotus-apt32-backdoor/](https://norfolkinfosec.com/jeshell-an-oceanlotus-apt32-backdoor/)**\n\nnorfolk March 24, 2019\n\n[Recently, various industry and media sources have publicly reported that OceanLotus, a](https://risky.biz/RB534/)\nsuspected Vietnam state-sponsored adversary, has conducted multiple targeted intrusions\nagainst auto manufacturers. This post examines a second-stage tool, JEShell, used during\none such intrusion.\n\nJEShell contains code-level overlaps with the OceanLotus KerrDown malware first publicly\n[described in a Medium post and a Palo Alto Unit42 post. At a high level, JEShell is](https://medium.com/@sp1d3rm4n/apt32-oceanlotus-m%E1%BB%99t-chi%E1%BA%BFn-d%E1%BB%8Bch-apt-b%C3%A0i-b%E1%BA%A3n-nh%C6%B0-th%E1%BA%BF-n%C3%A0o-ph%E1%BA%A7n-1-9975574e905)\nfunctionally similar to the KerrDown malware: both families decode and run layers of\nshellcode with the intention of downloading or directly installing a Cobalt Strike Beacon\nimplant. Unlike KerrDown (a Windows DLL), JEShell is written in Java. JEShell is delivered\nalongside (rather than instead of) KerrDown and other implants and in some cases shares\nthe same C2, likely as a measure of redundancy for the attacker.\n\nThis post examines one of two identified JEShell hashes:\n\nMD5: dfc78da5202a70066eba124660fd5085\n\nSHA1: 8cad6621901b5512f4ecab7a22f8fcc205d3762b\n\nSHA256: ea854e2e17615c54edbd6ee2babb874d957f094f3945992f5ac27b78b023051c\n\nC2: update.msoffice-templates[.]info\n\nThe other known file, not examined in this post, is:\n\nMD5: 74731674920c51668c36cc3c16f30553\nSHA1: 668572ba2aff5374a3536075b01854678c392c04\n\nSHA256: 040c1fcec79cd19a6aaedf9cabf3cc21cc6c30e6af4048087995d71fc4571cee\n\nC2: stream.playnetflix[.]com\n\nJEShell contains an encrypted resources with a randomized named and an XOR key\n(different between samples) used to decode it. The XOR is performed in a rolling fashion\nusing a “mod” function: the first byte of the encrypted resource is XORed by the byte\nrepresentation of the first character of the key, the second byte by the second character, and\nso on. When the end of the key is reached, it returns to the first letter. By doing this, the\nauthors ensure that the decoded resource is not revealed or detected by a brute force\nmechanism.\n\n\n-----\n\nJEShell resource (top, boxed in red) and key (middle, boxed in red) decoded into shellcode\n(bottom left)\n\nThe resource is decoded into a byte array and loaded into memory through one of two\nworkflows. On a 32-bit system, the resource is injected into the memory of the currently\nrunning process (Java.exe). On a 64-bit system a process is randomly selected and created\nfrom a hardcoded list and the array is injected into that process. The process list used on 64bit systems in this sample is:\n\n“C:\\\\Windows\\\\SysWOW64\\\\ARP.exe”, “C:\\\\Windows\\\\SysWOW64\\\\at.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\auditpol.exe”, “C:\\\\Windows\\\\SysWOW64\\\\bitsadmin.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\bootcfg.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\ByteCodeGenerator.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\cacls.exe”, “C:\\\\Windows\\\\SysWOW64\\\\chcp.com”,\n“C:\\\\Windows\\\\SysWOW64\\\\CheckNetIsolation.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\chkdsk.exe”, “C:\\\\Windows\\\\SysWOW64\\\\choice.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\cmdkey.exe”, “C:\\\\Windows\\\\SysWOW64\\\\comp.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\diskcomp.com”, “C:\\\\Windows\\\\SysWOW64\\\\Dism.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\esentutl.exe”, “C:\\\\Windows\\\\SysWOW64\\\\expand.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\fc.exe”, “C:\\\\Windows\\\\SysWOW64\\\\find.exe”,\n“C:\\\\Windows\\\\SysWOW64\\\\gpresult.exe”\n\n\n-----\n\n32-bit check and process injection routines for both 32 and 64-bit systems.\nThe injected shellcode contains multiple layers. The first layer dynamically resolves APIs and\n[decodes a second layer (a previous post contains suggestions on analyzing shellcode),](https://norfolkinfosec.com/how-to-analyzing-a-malicious-hangul-word-processor-document-from-a-dprk-threat-actor-group/)\nwriting this to a section of virtual memory and executing it with the Kernel32.CreateThread\nWindows API call:\n\nThe first-stage shellcode (top left) calling Kernel32.ResumeThread on the second layer of\nshellcode written to an executable section of memory.\n\nThe second layer of shellcode behaves similarly: it decrypts (via CryptDecrypt) a copy of the\nCobalt Strike Beacon implant into memory that is configured with a modified version of a\n[malleable C2 profile.](https://github.com/rsmudge/Malleable-C2-Profiles/tree/master/normal)\n\n\n-----\n\nSecond layer of shellcode decoding a Cobalt Strike Beacon implant into memory\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-03-24 - JEShell- An OceanLotus (APT32) Backdoor.pdf"
    ],
    "report_names": [
        "2019-03-24 - JEShell- An OceanLotus (APT32) Backdoor.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535636,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1653759168,
    "ts_modification_date": 1653759168,
    "files": {
        "pdf": "https://archive.orkl.eu/76ef25e7ad940f0892e6ea07a7364777bed00261.pdf",
        "text": "https://archive.orkl.eu/76ef25e7ad940f0892e6ea07a7364777bed00261.txt",
        "img": "https://archive.orkl.eu/76ef25e7ad940f0892e6ea07a7364777bed00261.jpg"
    }
}