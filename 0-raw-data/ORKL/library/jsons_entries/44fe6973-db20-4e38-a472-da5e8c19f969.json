{
    "id": "44fe6973-db20-4e38-a472-da5e8c19f969",
    "created_at": "2023-01-12T15:01:55.502715Z",
    "updated_at": "2025-03-27T02:08:41.29315Z",
    "deleted_at": null,
    "sha1_hash": "e8dc32f6eb29b51e1ee2e5054907dd28d4b3b433",
    "title": "2021-12-10 - New Yanluowang Ransomware Found to be Code-Signed, Terminates Database-Related Processes",
    "authors": "",
    "file_creation_date": "2022-05-28T05:03:09Z",
    "file_modification_date": "2022-05-28T05:03:09Z",
    "file_size": 238576,
    "plain_text": "# New Yanluowang Ransomware Found to be Code-Signed, Terminates Database-Related Processes\n\n**[trendmicro.com/en_us/research/21/l/yanluowang-ransomware-code-signed-terminates-database-processes.html](https://www.trendmicro.com/en_us/research/21/l/yanluowang-ransomware-code-signed-terminates-database-processes.html)**\n\nDecember 10, 2021\n\nRansomware\n\nWe analyzed new samples of the Yanluowang ransomware. One interesting aspect of these\nsamples is that the files are code-signed. They also terminate various processes which are\nrelated to database and backup management.\n\nBy: Don Ovid Ladores December 10, 2021 Read time: ( words)\n\nContent added to Folio\n\n\n-----\n\nFigure 2. Checking for arguments (pass)\nThe ransomware then encrypts the files from the provided file path on the argument,\nappends the extension (.yanluowang), then drops the ransom note (README.txt).\n\nFigure 3. Yanluowang\n\nransomware appended files\n\n\n-----\n\nFigure 4. YanLuoWang ransomnote (README.txt)\n\n## Digital signature, other features also found\n\nIt is important to highlight that the samples obtained are code-signed with a digital signature\n— and a valid one on that note, during the time of the analysis. The question remains\nwhether this signature was stolen from a company or fraudulently signed.\n\n[Code signing is performed to validate the authenticity of a piece of software; thus, code-](https://www.trendmicro.com/en/research/18/d/understanding-code-signing-abuse-in-malware-campaigns.html)\nsigned malware can appear legitimate and non-malicious, allowing it to bypass certain\nsecurity measures.\n\nFigure 5. Digital signature found\n\nwith Yanluowang ransomware samples\n\n\n-----\n\nUpon execution, the ransomware also terminates the following processes, which are related\nto managing databases and backups, through Windows API:\n\nVeeam\nSQL\n\nThe termination of database-related processes could potentially lead to loss of access to\nbackup files, which then places additional pressure on ransomware victims to pay up to\nretrieve their files.\n\nFigures 6-7.\n\nTerminating processes\nThe ransomware also attempts to terminate a few more processes through the command\nprompt if they match the following strings:\n\nmysql*\ndsa*\nveeam*\nchrome*\niexplore*\nfirefox*\noutlook*\nexcel*\ntaskmgr*\ntasklist*\n\n\n-----\n\nNtrtscan\nds_monitor*\nNotifier*\nputty*\nssh*\nTmListen*\niVPAgent*\nCNTAoSMgr*\nIBM*\nbes10*\nblack*\nrobo*\ncopy*\nsql\nstore.exe\nsql*\nvee*\nwrsa*\nwrsa.exe\npostg*\nsage*\n\nAside from processes, the malware will also forcefully stop (through net stop command line)\nthe following services:\n\nMSSQLServerADHelper100\nMSSQL$ISARS\nMSSQL$MSFW\nSQLAgent$ISARS\nSQLAgent$MSFW\nSQLBrowser\nReportServer$ISARS\nSQLWriter\nWinDefend\nmr2kserv\nMSExchangeADTopology\nMSExchangeFBA\nMSExchangeIS\nMSExchangeSA\nShadowProtectSvc\nSPAdminV4\nSPTimerV4\nSPTraceV4\n\n\n-----\n\nSPUserCodeV4\nSPWriterV4\nSPSearch4\nIISADMIN\nfirebirdguardiandefaultinstance\nibmiasrw\nQBCFMonitorService\nQBVSS\nQBPOSDBServiceV12\n\\\"IBM Domino Server (CProgramFilesIBMDominodata)\\\"\n\\\"IBM Domino Diagnostics (CProgramFilesIBMDomino)\\\"\n\\\"Simply Accounting Database Connection Manager\\\"\nQuickBooksDB1\nQuickBooksDB2\nQuickBooksDB3\nQuickBooksDB4\nQuickBooksDB5\nQuickBooksDB6\nQuickBooksDB7\nQuickBooksDB8\nQuickBooksDB9\nQuickBooksDB10\nQuickBooksDB11\nQuickBooksDB12\nQuickBooksDB13\nQuickBooksDB14\nQuickBooksDB15\nQuickBooksDB16\nQuickBooksDB17\nQuickBooksDB18\nQuickBooksDB19\nQuickBooksDB20\nQuickBooksDB21\nQuickBooksDB22\nQuickBooksDB23\nQuickBooksDB24\nQuickBooksDB25\n\nLastly, it will forcefully terminate running virtual machines (VMs) through the following\ncommand line:\n\npowershell -command \\\"Get-VM | Stop-VM -Force\\\"\n\n\n-----\n\nFigure 8. Terminating services\nWe will continue to monitor events related to the Yanluowang ransomware and share any\nupdates.\n\n## Strengthening defenses against ransomware\n\nAs new ransomware families continue to emerge, we foresee in our 2022 security predictions\nreport that ransomware operators will use more modern and sophisticated methods of\nextortion. Moving forward, enterprises must then take extra caution in applying preventive\nmeasures.\n\nIt would also help enterprises to establish frameworks that would help them with ransomware\ndefense. Here are some of the best practices that they can include in their frameworks:\n\nAudit and take inventoryof assets and data, authorized and unauthorized devices and\nsoftware, and logs of events and incidents.\nConfigure and monitorhardware and software configurations, and only grant admin\nprivileges and access when absolutely necessary to an employee’s role.\nPatch and update for operating systems and applications, perform regular vulnerability\nassessments, and conduct patching or virtual patching for operating systems and\napplications.\nProtect and recover essential information and files byenforcing stringent data\nprotection, backup, and recovery measures.\n\n\n-----\n\nPerform security skills assessment and training regularly and conduct red-team\nexercises and penetration tests.\nSecure and defend systems by employing the latest version of security solutions to all\nlayers of the system, including email, endpoint, web, and network.\n\n[Trend Micro Vision One™ offers multilayered protection and behavior detection, allowing for](https://www.trendmicro.com/en_us/business/services/managed-xdr.html)\nthe detection of and blocking ransomware early on before it can do any real damage to the\nsystem. This is done by identifying questionable behavior that might otherwise seem benign\nwhen viewed from only a single layer.\n\n[Trend Micro Cloud One™ – Workload Security defends systems against both known and](https://www.trendmicro.com/en_us/business/campaigns/cloud-one-services.html)\nunknown threats that exploit vulnerabilities through techniques such as virtual patching and\nmachine learning. It also leverages the latest in global threat intelligence to provide timely,\nreal-time protection.\n\n[Trend Micro™ Deep Discovery™ Email Inspector employs custom sandboxing and](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html)\nadvanced analysis techniques to effectively block ransomware before it gets into the system,\nblocking phishing emails that can be used by ransomware as entry points.\n\n[Trend Micro Apex One™ provides a closer inspection of endpoints through next-level](https://www.trendmicro.com/en_us/business/technologies/control-manager.html)\nautomated threat detection and response against advanced concerns such as fileless threats\nand ransomware.\n\n## Indicators of Compromise (IoCs)\n\nView the full list of IOCs [here.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/21/l/new-yanluowang-ransomware-found-to-be-code-signed-terminates-database-related-processes/New-Yanluowang-Ransomware-Family-Found-to-be-Code-Signed-Terminates-Database-Related-Processes.txt)\n\n[We analyzed new samples of the Yanluowang ransomware, a](https://www.trendmicro.com/vinfo/us/security/definition/ransomware) [recently discovered](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/yanluowang-ransomware-attacks-continue)\nransomware family. One interesting aspect of these samples is that the files are code-signed\nusing a valid digital signature, which was either stolen or fraudulently signed. They also\nterminate various processes including Veeam and SQL, which are related to database and\nbackup management.\n\n[After being uncovered a few weeks ago, the Yanluowang ransomware (named after the](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/yanluowang-targeted-ransomware)\nChinese deity Yanluo Wang) has since been associated with campaigns, and its operators\n[are said to launch targeted attacks on US corporations since at least August this year.](https://symantec-enterprise-blogs.security.com/blogs/threat-intelligence/yanluowang-ransomware-attacks-continue)\n\n## Yanluowang ransomware initial analysis\n\nThe Yanluowang ransomware samples we analyzed still have only a few detections as of this\nwriting. Just looking at the files themselves shows very little about where or how they arrived\nat a user’s system. But since the samples require certain arguments for proper execution, it\nappears that the most likely scenario for their execution is through remote desktop tools.\n\n\n-----\n\nWe also believe that the files analyzed here are merely part of a toolkit used by operators\nonce they have compromised their victims’ machines.\n\nFrom our initial analysis, the ransomware checks for the following arguments that are\nprimarily used to specify the directory where it would do its encryption:\n\n-h/--help\n-p/-path/--path\n-pass\n\nFigure 1. Checking for arguments (path)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-10 - New Yanluowang Ransomware Found to be Code-Signed, Terminates Database-Related Processes.pdf"
    ],
    "report_names": [
        "2021-12-10 - New Yanluowang Ransomware Found to be Code-Signed, Terminates Database-Related Processes.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535715,
    "ts_updated_at": 1743041321,
    "ts_creation_date": 1653714189,
    "ts_modification_date": 1653714189,
    "files": {
        "pdf": "https://archive.orkl.eu/e8dc32f6eb29b51e1ee2e5054907dd28d4b3b433.pdf",
        "text": "https://archive.orkl.eu/e8dc32f6eb29b51e1ee2e5054907dd28d4b3b433.txt",
        "img": "https://archive.orkl.eu/e8dc32f6eb29b51e1ee2e5054907dd28d4b3b433.jpg"
    }
}