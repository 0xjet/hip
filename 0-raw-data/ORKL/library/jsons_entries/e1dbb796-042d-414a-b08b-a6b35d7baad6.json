{
    "id": "e1dbb796-042d-414a-b08b-a6b35d7baad6",
    "created_at": "2023-01-12T15:02:44.332408Z",
    "updated_at": "2025-03-27T02:05:18.807789Z",
    "deleted_at": null,
    "sha1_hash": "585a3d82fc11048619d055b2a13be5124a07badf",
    "title": "2019-08-28 - Other day other malware in the way (died.exe)",
    "authors": "",
    "file_creation_date": "2022-05-28T18:21:38Z",
    "file_modification_date": "2022-05-28T18:21:38Z",
    "file_size": 1393995,
    "plain_text": "# Other day other malware in the way (died.exe)\n\n**[blog.cyttek.com/2019/08/28/other-day-other-malware-in-the-way-died-exe/](https://blog.cyttek.com/2019/08/28/other-day-other-malware-in-the-way-died-exe/)**\n\nRafael Revert August 28, 2019\n\n[ATM](https://blog.cyttek.com/tag/atm/)\n\n\n-----\n\n## Rafael Revert\n\nCTO and Co-founder of Cyttek Group and international consulting company specialized\nin providing Cyber Security, ATM, IA, Big Data and custom products for different\nsectors\n\n[More posts by Rafael Revert.](https://blog.cyttek.com/author/rafael-revert/)\n\n**[Rafael Revert](https://blog.cyttek.com/author/rafael-revert/)**\n\n28 Aug 2019 • 5 min read\n\n\n-----\n\nMost of cyber security blogs will talk about the discovery of the malware in english to reach\nmore people in the explanation and make a fancy claims that they have the solution to\nprotect everything, pero no nosotros no parte de esta misión de este blog es centralizar\nconocimiento de varios tópicos de seguridad pero centrados en canales alternos y en\nespecial ATM que hemos seguido este tópico, en este caso vamos a hablar de un nuevo\nsoftware descubierto en latino américa Died.exe o dd por los strings encontrados.\n\nPrimero que todo o existe un faltante al momento de la cuenta de efectivo por la\ntransportadora de valores o hay un software nuevo que no debería estar en el ATM.\n\nDied puede ser ejecutado desde cualquier carpeta del sistema operativo\n\nGeneralmente lo primero es que el Software tiene referencias a funciones (service provider)\nSPI y importaciones de DLLs propias del CEN XFS, para poder ver si ya de primero\ntenemos suficiente motivo para que no esté en el ATM\n\nLuego de segundo es encontrar posibles rutinas o subrutinas que puedan interaccionar con\nalgún perimetral siguiendo la lógica del WFS primero debe inicializar, luego abrir la\ncomunicación\n\n\n-----\n\nLuego en otra subrutina vemos que tiene que ejecutar la instrucción de abertura del canal\nSPI\n\n\n-----\n\nsi toda el proceso de abertura no está ocupado por otro servicio esto quiere decir que\nentonces el usuario que lo ejecuta de acuerdo a la necesidad del CEN XFS no puede estar\ncorriendo otro hserv para este servicio SPI por lo tanto el ATM debe estar sin otro servicio\nXFS para poder ejecutar el software\n\nsi el hserv se vuelve único y avanza el proceso del WFS open por la subrutina 46D8B4\n\n\n-----\n\nrevisa que en la subrutina se encuentre el Dispensador habilitado\n\nen caso de que no se encuentra habilitado la propia funcione msxfs\nWFS_CDM_DEVONLINE le entregará el status para poder procesar con la petición de\noperación con el dispensador\n\n\n-----\n\nluego entra a la función\n\ny luego como exige el SDK del CEN llama a la función de WFS CMD CDM Dispense\n\n\n-----\n\nuna peculiaridad de este software es que las funciones estan en ingles y las instrucciones\nde input de las subrutinas están en español y acepta múltiples denominaciones ISO estas\ndenominaciones después de recorrer la subrutina se las trae de los estados WFS y junto\ncon la cantidad de billetes del input esperado recorre los REGEDIT para poder traer el name\ndel dispensador en la subrutina de posibles dispensadores\n\n\n-----\n\nCualquier software que esté en el ATM que tenga funciones WFS y no tenga un firmado de\nla marca de ATM por lo tanto ya hay que sospechar cosas raras\n\nAquí el \"softwarecito\" corriendo del cual tiene una afectación principal para Diebold Agilis\n\ny así es como lo ves en VT, ninguno de los típicos como symantec o mcafee lo identifica\n\nPuntos importantes:\n\n1.-Cualquier software que esté en el ATM que tenga funciones WFS y no tenga un firmado\nde la marca de ATM por lo tanto ya hay que sospechar cosas raras\n\n2.- Algunos strings en español por lo tanto de fabricación latino americana\n\n\n-----\n\n3.- Utilización del CEN XFS estándar requiere de la importación de la librería MSXFS.dll por\nlo tanto es un software para operar ATMS\n\n4.- Soporta multi divisa pero requiere de input por lo tanto el atacante debe tener un teclado\ncerca habilitado por la ACL y seleccionar o ejecutar un Software que mediante un string\ninput al proceso de consola del software pueda insertar los 2 input que requiere\n\n5.- Tiene una función muy parecida al peralta donde rebusca los dispensadores soportados\npor el XFS y trae el utilizado actualmente para poder pasarle por el canal del SPI las\ninstrucciones\n\n6.- Al parecer esto tiene pinta de ser una fase de pruebas, puesto que no se encontro\nningun packer ni cifrado y requiere de inputs que muy probablemente en ataques masivos\nse puedan automatizar y vender licencias por cantidad de billetes como ya se ha visto en\nmalware pasados\n\n7.- con esto van 123 aproximadamente de malware y subfamilias reconocidas para atacar a\nATMs\n\nRecomendaciones :\n\n1.- Prohibir la ejecución de cualquier software no solo centrarse en el hash de este o de\ncualquier otro software /malware generalmente la ejecución por listas blancas n con\nAPPLOCKER o algún software de ACL\n\n2.- Si por desgracia te lo esconden en algún update por la red de ATM, todos los últimos\nsoftware de esta clase siempre buscan el mayor soporte de dispensadores por lo tanto\nborrar los regedit de forma remota de la denominación del dispensador y la ruta de la dll\nayuda a que provoque errores el software al no encontrar el regedit y al menos pues se\nprotege temporalmente y no se pierde dinero (ojo esta recomendación solo aplicarla en caso\nextremo ya que si no sabes operar bien lo regedit puedes terminar en que tengas que\nreinstalar el software del ATM)\n\n3.- Con [ATX podemos remotamente bloquear el I/O controller del Dispensar para que](https://blog.cyttek.com/2019/03/18/atx-security/)\ncuando busque el Hardware device CDM no esté operativo y el ataque no pueda proceder\npor mucho que se intente.\n\n4.- Tener buenas políticas de seguridad para prevenir que te suban estos ejecutables al atm\nsea por un interno o por un externo al ATM\n\nName: died.exe\n\nMD 56a7732feaa62e8b6ae60f9203c742162\n\n\n-----\n\nSHA-1 : 94dfa4d597090b34adf18576235df60e3da69b00\n\nSHA-256 d6dff67a6b4423b5721908bdcc668951f33b3c214e318051c96e8c158e8931c0\n\nAuthentihash 4cdb89b93c770995763092ee6b5ad4c1a47ba9c3a5b6ef290fb7d11a4cebde29\n\nFile type Win32 EXE MagicPE 32 executable for MS Windows (console) Intel 80386 32-bit\n\nFile size 1.06 MB (1107968 bytes)\n\n### Subscribe to Cyttek Group\n\nGet the latest posts delivered right to your inbox\n\n**Great! Check your inbox and click the link to confirm your subscription.**\n\nPlease enter a valid email address!\n\n\n-----",
    "language": "ES",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-08-28 - Other day other malware in the way (died.exe).pdf"
    ],
    "report_names": [
        "2019-08-28 - Other day other malware in the way (died.exe).pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535764,
    "ts_updated_at": 1743041118,
    "ts_creation_date": 1653762098,
    "ts_modification_date": 1653762098,
    "files": {
        "pdf": "https://archive.orkl.eu/585a3d82fc11048619d055b2a13be5124a07badf.pdf",
        "text": "https://archive.orkl.eu/585a3d82fc11048619d055b2a13be5124a07badf.txt",
        "img": "https://archive.orkl.eu/585a3d82fc11048619d055b2a13be5124a07badf.jpg"
    }
}