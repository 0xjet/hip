{
    "id": "cea2877d-63ae-46b1-b23e-ad16d82ffd2e",
    "created_at": "2023-01-12T15:02:19.822798Z",
    "updated_at": "2025-03-27T02:05:31.525841Z",
    "deleted_at": null,
    "sha1_hash": "e1ba3a956c707b204e79eef95f6c91d5ad4be0ac",
    "title": "2009-11-02 - New banking trojan W32.Silon -msjet51.dll",
    "authors": "",
    "file_creation_date": "2022-05-28T17:14:49Z",
    "file_modification_date": "2022-05-28T17:14:49Z",
    "file_size": 67343,
    "plain_text": "# New banking trojan W32.Silon -msjet51.dll\n\n**[contagiodump.blogspot.com/2009/11/new-banking-trojan-w32silon-msjet51dll.html](http://contagiodump.blogspot.com/2009/11/new-banking-trojan-w32silon-msjet51dll.html)**\n\nIf you have msjet51.dll in system32, you probably have a very dangerous banking trojan on\nyour computer.\n\n**Two-Headed Trojan Targets Online Banks. New Trojan uses \"two-pronged payload\" to**\n**swipe log-in information, steal electronic funds.**\n\n**[W32.Silon Malware Analysis - White paper from Trusteer](http://www.trusteer.com/sites/default/files/Silon_Analysis_v5_PR-MBfinal.pdf)**\n\n**http://www.virustotal.com/analisis/675eb7cf5f115dbb4e9c6dcf83de5700d36d29e0d7bf5**\n**218f508b9a3650f73e7-1256931747**\n\nSee PDF for full analysis\n\nExtracts.\n\nBrowser Penetration\n\nWhen Internet Explorer runs, it loads several DLLs into its memory to\n\nflexibly enhance its functionality. One of these DLLs is msimtf.dll (a\n\nMicrosoft-signed DLL used to record keyboard inputs), which is not a\n\ncore DLL of Internet Explorer.\n\nThe malware dropper replaces a specific GUID =>\n\nHKEY_CLASSES_ROOT\\CLSID\\{50D5107A-D278-4871-8989\nF4CEAAF59CFC} which points to msimtf.dll, with msjet51.dll (under\n\n%systemroot%\\system32).\n\n\n-----\n\nOnce infected, every time the user runs Internet Explorer, msjet51.dll\nis loaded into iexplore.exe. Apparently, this installation step is carried\nout by the dropper, and not by the DLL itself.\nThe DLL file (msjet51.dll) is located in systemroot%\\System32, and\nhas its hidden attribute turned on.\nAdditional File / Registry Key\nW32.Silon uses the disk volume serial number to generate a machinespecific\nconsistent file name and a registry key name. The disk volume\nserial number for a specific machine can easily be found by issuing the\nvol command. Assuming that the disk volume serial number is\nH1H2H3H4-H5H6H7H8, the following entries are created:\n\n- File %Systemroot%\\Temp\\H1H2H3H4H5H6H7H8 - output file of the\nmalware. The malware writes encrypted data (stolen credentials)\ninto this file.\n\n- Registry key HKCU\\CLSID\\{H1H2H3H4H5H6H7H8-H3H4H5H6H5H6H7H8-H3H4H5H6- H2H3H4H5H1H2H3H4H5H6H7H8}\\n,\nwhere the following values of n were observed:\n\n- 0 the malware configuration\n\n- 1 the C&C URLs\n\n- 3,4 additional values (probably flags)\n\nThe malware then injects itself into iexplore.exe and svchost.exe.\nIt also removes itself from the loaded-module list of iexplore.exe, in\norder to elude runtime analysis by anti-virus engines.\nThe malware writes its data into a hidden file under the\n%systemroot%\\Temp folder.\nThe file is encrypted by one-byte XOR with 0xFF (25510).\n\nConfiguration\nAs mentioned above, the registry key\nHKCU\\CLSID\\{H1H2H3H4H5H6H7H8-H3H4H5H6-H5H6H7H8-H3H4H5H6H2H3H4H5H1H2H3H4H5H6H7H8} contains four values:\n0 malware configuration\n1 C&C URLs\n3, 4 Additional values (probably flags)\n\nW32.Silon intercepts the POST request, and writes the\nlogin data into an encrypted file in the\n%systemroot%\\System32\\Temp folder.\n\nPOST request which is sent to the C&C Server. The\nserver's URL is one of a list stored in the registry.\n\n[D]:12.10.09 14:37:01 PM\n\n\n-----\n\n[[U]:https://www4. [REMOVED]/.com/internetBanking/RequestRouter](https://www4/)\n\n[R]:https://www4.[REMOVED]/.com/internetBanking/RequestRouter?requestCmdI\n\nd=DisplayLoginPage\n\n[>]:requestCmdId=VALIDATEID\nUSERID=1133123\nRESPONSE_TYPE_IND=\nNONCE=NoNonce\nMACHINEATTR=colorDepth%3D32%7Cwidth%3D1024%7Cheight%3D768%7C\navailWidth%3D1024%7CavailHeight%3D735%7Cplatform%3DWin32%7CjavaEn\nabled%3DYes%7CuserAgent%3DMozilla%2F4.0+%28compatible%3B+MSIE+6.0\n%3B+Windows+NT+5.1%3B+SV1%3B+.NET+CLR+2.0.50727%29\ndoubleclick=2\n\n[D]:12.10.09 14:37:47 PM\n\n[[U]:https://www4. [REMOVED]/.com/internetBanking/RequestRouter](https://www4/)\n\n[[R]:https://www4. [REMOVED]/.com/internetBanking/RequestRouter](https://www4/)\n\n[>]:requestCmdId=Logon\nUSERID=1133123\nPSWD=mysecret\nLOGINSESSIONID=z92VNnipxdXNNmQ_eoY0za9\nRESPONSE_TYPE_IND=\ndoubleclick=2\nUSEDSINGLEACCESSCODE=null\nW32.Silon Malware Analysis\n11\nTo identify the machine which sent the POST request, W32.Silon adds\nthe i parameter to the request:\nPOST /b/i.php?i=<Machine_ID>.\nThe machine id contains the hostname (with x replacing\nhyphens/underscores) followed by an underscore, followed by the disk\nvolume serial number (H1H2H3H4H5H6H7H8).\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2003 - 2009/2009-11-02 - New banking trojan W32.Silon -msjet51.dll.pdf"
    ],
    "report_names": [
        "2009-11-02 - New banking trojan W32.Silon -msjet51.dll.pdf"
    ],
    "threat_actors": [
        {
            "id": "e90ec9cb-9959-455d-b558-4bafef64d645",
            "created_at": "2022-10-25T16:07:24.222081Z",
            "updated_at": "2025-03-27T02:02:10.14365Z",
            "deleted_at": null,
            "main_name": "Sphinx",
            "aliases": [
                "APT-C-15"
            ],
            "source_name": "ETDA:Sphinx",
            "tools": [
                "AnubisSpy",
                "Backdoor.Oldrea",
                "Bladabindi",
                "Fertger",
                "Havex",
                "Havex RAT",
                "Jorik",
                "Oldrea",
                "PEACEPIPE",
                "njRAT",
                "yellowalbatross"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535739,
    "ts_updated_at": 1743041131,
    "ts_creation_date": 1653758089,
    "ts_modification_date": 1653758089,
    "files": {
        "pdf": "https://archive.orkl.eu/e1ba3a956c707b204e79eef95f6c91d5ad4be0ac.pdf",
        "text": "https://archive.orkl.eu/e1ba3a956c707b204e79eef95f6c91d5ad4be0ac.txt",
        "img": "https://archive.orkl.eu/e1ba3a956c707b204e79eef95f6c91d5ad4be0ac.jpg"
    }
}