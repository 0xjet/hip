{
    "id": "978ede13-dc5c-4711-a98d-fc1c89888018",
    "created_at": "2023-01-12T14:59:04.906748Z",
    "updated_at": "2025-03-27T02:05:26.528756Z",
    "deleted_at": null,
    "sha1_hash": "704cc628c4e78cbc04fa203f62f8656c66ece931",
    "title": "2017-07-25 - “Perverse” malware infecting hundreds of Macs remained undetected for years",
    "authors": "",
    "file_creation_date": "2022-05-28T01:56:12Z",
    "file_modification_date": "2022-05-28T01:56:12Z",
    "file_size": 96969,
    "plain_text": "# “Perverse” malware infecting hundreds of Macs remained undetected for years\n\n**[arstechnica.com/security/2017/07/perverse-malware-infecting-hundreds-of-macs-remained-undetected-for-years/](https://arstechnica.com/security/2017/07/perverse-malware-infecting-hundreds-of-macs-remained-undetected-for-years/)**\n\nDan Goodin\n\n[Enlarge](https://cdn.arstechnica.net/wp-content/uploads/2017/07/macbook-air.jpg)\n[Tim Malabuyo](https://www.flickr.com/photos/12313873@N00/2195491843/)\nA mysterious piece of malware that gives attackers surreptitious control over webcams,\nkeyboards, and other sensitive resources has been infecting Macs for at least five years. The\ninfections—known to number nearly 400 and possibly much higher—remained undetected\nuntil recently and may have been active for almost a decade.\n\n### Further Reading\n\n[Newly discovered Mac malware found in the wild also works well on Linux](https://arstechnica.com/information-technology/2017/01/newly-discovered-mac-malware-may-have-circulated-in-the-wild-for-2-years/)\nPatrick Wardle, a researcher with security firm Synack, said the malware is a variant of a\n[malicious program that came to light in January after circulating for at least two years.](https://arstechnica.com/security/2017/01/newly-discovered-mac-malware-may-have-circulated-in-the-wild-for-2-years/)\nDubbed Fruitfly by some, both malware samples capture screenshots, keystrokes, webcam\n\n\n-----\n\nimages, and information about each infected Mac. Both generations of Fruitfly also collect\ninformation about devices connected to the same network. After researchers from security\nfirm Malwarebytes discovered the earlier Fruitfly variant infecting four Macs, Apple updated\nmacOS to automatically detect the malware.\nThe variant found by Wardle, by contrast, has infected a much larger number of Macs while\nremaining undetected by both macOS and commercial antivirus products. After analyzing the\nnew variant, Wardle was able to decrypt several backup domains that were hardcoded into\nthe malware. To his surprise, the domains remained available. Within two days of registering\none of the addresses, close to 400 infected Macs connected to the server, mostly from\nhomes located in the United States. Although Wardle did nothing more than observe the IP\naddress and user names of Macs that connected to his server, he had the ability to use the\nmalware to spy on the users who were unwittingly infected.\n\n\"This shows that there are people who are sick in the head who are attacking everyday Mac\nusers for insidious goals,\" Wardle told Ars. Although the method of infection remains\nunknown, Wardle suspects it involves tricking users into clicking on malicious links, as\nopposed to exploiting vulnerabilities in apps or in macOS. \"A lot of Mac users are\noverconfident in the security of their Mac. [The discovery] just goes to reiterate to everyday\nusers that there are perhaps people out there trying to hack their computers.\"\n\n## Why?\n\nBesides the means of infection being unknown, the exact purpose of the malware is also\nunclear. Wardle said he found no evidence the malware can be used to install ransomware\nor collect banking credentials. That largely removes the possibility that Fruitfly developers\nwere motivated by financial profit. At the same time, the concentration of home users largely\nrules out chances the malware was designed by state-sponsored hackers to spy on targets.\n\n\"I don't know if it's just some bored person or someone with perverse goals,\" Wardle said. \"If\nsome bored teenager is spying on me, that would still be very emotionally traumatic. If it's\nturning on the webcam, that's for perverse reasons.\"\n\nWardle said the primary command-and-control server used by the malware had been shut\ndown earlier but that many of the affected Macs had never been disinfected. As a result, the\ninfected Macs reported to the backup server as soon as it became available. The researcher\nspeculated that Fruitfly was therefore abandoned by its creators. As demonstrated by the\nbackup servers, the Macs remained susceptible to spying by anyone who took the time to\nregister one of the hardcoded domains.\n\nWardle has since reported all of his findings to law enforcement officials. He said all domains\nknown to be associated with the malware are no longer available, a move that essentially\nneutralizes the threat. Apple representatives didn't respond to an e-mail seeking comment for\nthis post.\n\n\n-----\n\nWhile the backup server Wardle set up allowed him to discover the Macs that remained\ninfected by the Fruitfly variant, it also allowed him to quickly analyze how the malware\nworked. Typically, researchers must undertake a painstaking process known as reverse\nengineering to document the inner workings. By infecting a lab computer and watching how it\ninteracted with the backup server, the researcher was able to more easily understand how\nvarious commands worked. Wardle will speak about the process on Wednesday at the Black\nHat Security Conference in Las Vegas, in a briefing titled Offensive Malware Analysis:\nDissecting OSX/Fruitfly via a custom C&C Server.\n\nOne of the interesting aspects of the latest Fruitfly variant is that it flew under the radar for so\nlong. The malware relies on functions that were retired long ago and uses a crude method to\nremain installed once a Mac is infected. Compared to newer, more sophisticated malware,\nFruitfly is much easier to detect. And yet, for whatever reason, no one caught it until recently.\nTwo pieces of Mac software developed by Wardle would have given victims a strong\n[indication they were infected. One, called BlockBlock, would have warned of the suspicious](https://objective-see.com/products/blockblock.html)\n[launch agent used by the malware. A second tool, called Oversight, provides notification](https://objective-see.com/products/oversight.html)\n[anytime an app attempts to access a Mac's webcam or microphone. A recent submission to](https://www.virustotal.com/en/file/befa9bfe488244c64db096522b4fad73fc01ea8c4cd0323f1cbdee81ba008271/analysis/)\nthe VirusTotal malware detection service shows that 19 of the top 56 AV- and endpointprotection products now detect the malware.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-07-25 - “Perverse” malware infecting hundreds of Macs remained undetected for years.pdf"
    ],
    "report_names": [
        "2017-07-25 - “Perverse” malware infecting hundreds of Macs remained undetected for years.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535544,
    "ts_updated_at": 1743041126,
    "ts_creation_date": 1653702972,
    "ts_modification_date": 1653702972,
    "files": {
        "pdf": "https://archive.orkl.eu/704cc628c4e78cbc04fa203f62f8656c66ece931.pdf",
        "text": "https://archive.orkl.eu/704cc628c4e78cbc04fa203f62f8656c66ece931.txt",
        "img": "https://archive.orkl.eu/704cc628c4e78cbc04fa203f62f8656c66ece931.jpg"
    }
}