{
    "id": "30d30864-f366-431b-9bfb-8773daa6d34b",
    "created_at": "2023-01-12T15:04:05.020096Z",
    "updated_at": "2025-03-27T02:16:20.810292Z",
    "deleted_at": null,
    "sha1_hash": "3b0aeeed8f4b3aab13806cbcd8cd3fa66eea8d05",
    "title": "2021-02-27 - Nice to meet you too My name is Ryuk",
    "authors": "",
    "file_creation_date": "2022-05-25T14:30:48Z",
    "file_modification_date": "2022-05-25T14:30:48Z",
    "file_size": 281559,
    "plain_text": "# Nice to meet you, too. My name is Ryuk.\n\n**4rchib4ld.github.io/blog/NiceToMeetYouRyuk**\n\nA comprehensive Ryuk threat analysis\n\nFebruary 27, 2021 6 minute read\n\n\nFebruary 27, 2021\n\n\nThis work is a comprehensive analysis of the ransomware Ryuk. It will be break down into\nthree parts :\n\nWhat are the Ryuk operator interested in ?\nWhat tactics and tools do they typically use ?\nHow can defenders detect those tools or tactics ?\n\n## From Netflix to your enterprise\n\nRyuk is a Ransomware, [responsible for a third of all ransomware attacks in 2020. Ryuk is](https://www.securitymagazine.com/articles/93769-ryuk-ransomware-responsible-for-one-third-of-all-ransomware-attacks-in-2020)\nspecifically used to target enterprise environments, and specially in the recent times Big\nGame Hunting – going after bigger, more secure targets in tailored operations and\npotentially extract larger ransoms –. Like almost all ransomwares, Ryuk goal is to generate as\nmuch money as possible, in the shortest amount of time. They often succeed according to the\nreports, because the average ransom seems to be near $1Millions, and the highest was\n$34Millions in 2018.\n\nFor this, Ryuk will targets huge corporations and specially Windows assets (which represents\nthe most part of their infrastructure). Clients and servers will (sadly) go the same way,\ndisregarding of their version.\n\nAt the time of writing, there is no way to decrypt Ryuk Encryption. That’s because it’s the\nAES/RSA combo and restoring data without the keys is impossible (unless there is a failure\nin the implementation).\n\nRyuk is under constant development, new modules and functionalities are added over time.\n\n## How does it operates ?\n\nRyuk is most of the time delivered by TrickBot and more recently Bazar. (**), so with a\n[phishing mail (T1566).](https://attack.mitre.org/techniques/T1566)\n\n[This two malwares are attributed to the same group](https://www.zdnet.com/article/new-bazar-backdoor-linked-to-trickbot-banking-trojan-campaigns/)\n\nHowever, it was also seen to exploit accessible Remote Desktop Services on targets\n[(T1021.001).](https://attack.mitre.org/techniques/T1021/001/)\n\n\n-----\n\n[Ryuk can also exploit vulnerabilities like ZeroLogon or](https://threatpost.com/ryuk-ransomware-gang-zerologon-lightning-attack/160286/) [EternalBlue to propagate itself into](https://www.computerweekly.com/news/252489779/Ryuk-attack-downs-private-health-provider-in-major-incident)\n[the networks (T1210).](https://attack.mitre.org/techniques/T1210/)\n\nThere is actually some works done before Ryuk is run on the victim’s infrastructure. There is\n[an Active Directory reconnaissance (T1018) done using tools like :](https://attack.mitre.org/techniques/T1018/)\n\nMimikatz\nPowerShell PowerSploit\nAdFind\nBloodhound\nPsExec\n\n[Investigating the Active Directory is also a behavior seen for TrickBot.](https://www.bleepingcomputer.com/news/security/trickbot-now-steals-windows-active-directory-credentials/)\n\nThe goal here for Ryuk is to have enough knowledge and privileges to impact as much hosts\nand shares as possible, as well as estimating the victims infrastructure : A big Active\nDirectory most of the time involves a big entreprise.\n\n[There is also instances where Cobalt Strike was used, as it sometimes comes with Bazar.](https://www.advanced-intel.com/post/anatomy-of-attack-inside-bazarbackdoor-to-ryuk-ransomware-one-group-via-cobalt-strike)\n\nOnce the Active Directory has delivered all of its secrets, Ryuk is executed.\n\n**About the delivery : Even when Emotet is involved, it actually delivers Trickbot which**\nitself delivers Ryuk. This reinforce the accountancy between this two and the attribution to\nthe same group : Wizard Spider\n\n### Malware Analysis\n\nI was able to find a Ryuk Sample (5e1e2920736e1c00104e24ee). I will describe points that\nseems interesting to have in mind when dealing with Ryuk, as well as how they can be\ndetected/mitigated.\n\n**About Hermes : Ryuk is most likely built on the Hermes ransomware, which had it source**\ncode shared on various underground forums. That’s why you’ll see strings that relates to\nHermes.\n\n**Dropping itself**\n\nUpon launching, it copies itself in the current directory with a random 7 characters length\nand then launch the new file with the parameters “8 Lan” (Wake On Lan)\n\n\n-----\n\n**Anti everything**\n\nIt then creates a thread that loop thought all running processes and services and kill those\nwho might disturb it : like excel, backup services, virtual machine and such. The full list is in\n[the Appendix. The goal is to make sure not file are opened in memory (T1489), as well as](https://attack.mitre.org/techniques/T1489/)\n[performing AntiVM action (T1562.001).](https://attack.mitre.org/techniques/T1562/001)\n```\n   net stop is used for services :\n   taskkill is used for processes :\n\n```\n**Detection opportunity : It’s highly suspicious that a process kills a high number of**\nprocesses and/or services. Maybe some legit apps do it, but this behavior can be a sign of a\nmalware trying to setup its playground.\n\n[It will also performs anti forensics/recovery by executing various commands (T1059.003 and](https://attack.mitre.org/techniques/T1059/003)\n[T1490) :](https://attack.mitre.org/techniques/T1490)\n\n\n-----\n\nNote the typo for the first command, there is a missing ‘e’ on ‘delete’\n\n**Detection opportunity : This kind of commands are HIGHLY suspicious, and there**\nshould be a rule on the SIEM or EDR that monitor their usages. Also, having a lot of this\ncommands executed in the same interval can be determined in a rule\n\n**Privilege Escalation**\n\nRyuk will check for two privileges :\n```\n   SEBackupPrivilege : In order to access to any file and bypass ACL\n   SEDebugPrivilege : In order to execute the process injection\n\n```\nIn order to do so, Ryuk will open it current thread and retrieve the Thread Token.\n\n\n-----\n\nIt will then enable the wanted privilege with the function `AdjustTokenPrivileges (T1134)`\n\n\n-----\n\nThe privileges will be used on the next steps\n\n**Process Injection**\n\nRyuk injects itself into multiples processes, in order to be very fast.\n\n[It enumerates running process (T1057)checks if the process is one of](https://attack.mitre.org/techniques/T1057) `csrss.exe,`\n```\nexplorer.exe, lsaas.exe or is run under NT Admin and then injects into it, using\nWriteProcessMemory and CreateRemoteThread (T1055).\n\n```\n**Detection opportunity : It’s pretty uncommon for a process to inject itself into another, or**\neven writing to its memory. This kind of behavior can be detected by an EDR, or by Windows\nSysmon Event ID 8, for example.\n\n**Encryption**\n\n[The encryption (T1486) is done with the](https://attack.mitre.org/techniques/T1486) `CryptEncrypt Windows API with AES_256.`\n\n\n-----\n\nAll encrypted files have the string HERMES at their\nend. It is used as a marker to know whether the file has\nalready been encrypted. The file itself is encrypted, so\nthere is no deletion involves and so recovery is unlikely. A file named `RyukReadMe.html is`\ndropped on every encrypted directory.\n\nThere is a bunch of directory that are\nwhitelisted by the malware :\n\n\n-----\n\nAs well as :\n\nChrome\nMozilla\nRecycle.bin\nWindows\nMicrosoft\nAhnLab\n\nAll encrypted files are appended the `.RYK file extension.`\n\n[Any mounted drives (T1547.001)will suffer the same fate, first by having rights :](https://attack.mitre.org/techniques/T1547/001)\n\nAnd then the encryption :\n\n\n-----\n\n[Ryuk will also scan the ARP table in order to find any files or folders in remote hosts. (T1016)](https://attack.mitre.org/techniques/T1016)\n\n**Persistence**\n\nCreate a registry key named ‘svchos’ on the famous\n```\nHKEY\\_CURRENT\\_USER\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\n\n```\n[registry (T1547.001)with the full path of the executable using](https://attack.mitre.org/techniques/T1547/001) `cmd.exe (T1059.003)`\n\n**Detection opportunity : This registry is a well known location for persistence. A rule can**\nbe easily setup to monitor any suspicious addition.\n\n## What’s next ?\n\n\n-----\n\nWizard Spider seems to have built an ecosystem of malware, and still continues to develop it,\nwith the addition to Conti, a new ransomware. Some reports seems to indicate that Conti is a\nnew version of Ryuk. Maybe that’s a question I will tackle during another analysis. For now,\nRyuk is still going, and should be kept in mind.\n\n## Appendix\n\n### Blacklisted Process\n```\n- virtual\n- vmcomp\n- vmwp\n- veeam\n- backup\n- Backup\n- xchange\n- sql\n- dbeng\n- sofos\n- calc\n- ekrn\n- zoolz\n- encsvc\n- excel\n- firefoxconfig\n- infopath\n- msaccess\n- mspub\n- mydesktop\n- ocautoupds\n- ocomm\n- ocssd\n- onenote\n- oracle\n- outlook\n- powerpnt\n- sqbcoreservice\n- steam\n- synctime\n- tbirdconfig\n- thebat\n- thunderbird\n- visio\n- word\n- xfssvccon\n- tmlisten\n- PccNTMon\n- CNTAoSMgr\n- Ntrtscan\n- mbamtray\n\n Blacklisted Services\n\n```\n\n-----\n\n-----\n\n```\n vmcomp\n- vmwp\n- veeam\n- Back\n- xchange\n- ackup\n- acronis\n- sql\n- Enterprise\n- Sophos\n- Veeam\n- AcrSch\n- Antivirus\n- Antivirus\n- bedbg\n- DCAgent\n- EPSecurity\n- EPUpdate\n- Eraser\n- EsgShKernel\n- FA_Scheduler\n- IISAdmin\n- IMAP4\n- MBAM\n- Endpoint\n- McShield\n- task\n- mfemms\n- mfevtp\n- mms\n- MsDts\n- Exchange\n- ntrt\n- PDVF\n- POP3\n- Report\n- RESvc\n- sacsvr\n- SAVAdmin\n- SamS\n- SDRSVC\n- SepMaster\n- Monitor\n- Smcinst\n- SmcService\n- SMTP\n- SNAC\n- swi\n- CCSF\n- TrueKey\n- tmlisten\n- UI0Detect\n- W3S\n- WRSVC\n- NetMsmq\n\n```\n\n-----\n\n```\n ekrn\n- EhttpSrv\n- ESHASRV\n- AVP\n- klnagent\n- wbengine\n- KAVF\n- mfefire\n\n## You May Also Enjoy\n\n Turla, the Snake of Attribution\n\n```\nApril 29, 2022 3 minute read\n\nHow Turla tries to avoid attribution\n\n## Tomorrow night ? Honeymoon on Ice(loader) ?\n\nMay 14, 2021 3 minute read\n\nWrite up about the packer used by multiple threat actors during the past few months\n\n## Your attribution appears to have been applied to your life\n\nApril 25, 2021 5 minute read\n\nTo what point is attribution useful ?\n\n## IcedID on my neck I’m the coolest\n\nApril 11, 2021 4 minute read\n\nUnpacking IcedID in order to extract the C2 domain name\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-02-27 - Nice to meet you too My name is Ryuk.pdf"
    ],
    "report_names": [
        "2021-02-27 - Nice to meet you too My name is Ryuk.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "63061658-5810-4f01-9620-7eada7e9ae2e",
            "created_at": "2022-10-25T15:50:23.752974Z",
            "updated_at": "2025-03-27T02:00:55.538582Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "Wizard Spider",
                "UNC1878",
                "TEMP.MixMaster",
                "Grim Spider",
                "FIN12",
                "GOLD BLACKBURN",
                "ITG23",
                "Periwinkle Tempest",
                "DEV-0193"
            ],
            "source_name": "MITRE:Wizard Spider",
            "tools": [
                "TrickBot",
                "AdFind",
                "BITSAdmin",
                "Bazar",
                "LaZagne",
                "Nltest",
                "GrimAgent",
                "Dyre",
                "Ryuk",
                "Conti",
                "Emotet",
                "Rubeus",
                "Mimikatz",
                "Diavol",
                "PsExec",
                "Cobalt Strike"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f6f91e1c-9202-4497-bf22-9cd5ef477600",
            "created_at": "2023-01-06T13:46:38.86765Z",
            "updated_at": "2025-03-27T02:00:02.938998Z",
            "deleted_at": null,
            "main_name": "WIZARD SPIDER",
            "aliases": [
                "FIN12",
                "UNC2053",
                "Pistachio Tempest",
                "TEMP.MixMaster",
                "GOLD BLACKBURN",
                "Periwinkle Tempest",
                "DEV-0193",
                "Storm-0193",
                "Trickbot LLC",
                "DEV-0237"
            ],
            "source_name": "MISPGALAXY:WIZARD SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e6a21528-2999-4e2e-aaf4-8b6af14e17f3",
            "created_at": "2022-10-25T16:07:24.422115Z",
            "updated_at": "2025-03-27T02:02:10.216817Z",
            "deleted_at": null,
            "main_name": "Wizard Spider",
            "aliases": [
                "DEV-0193",
                "Gold Blackburn",
                "Gold Ulrick",
                "Grim Spider",
                "ITG23",
                "Operation BazaFlix",
                "Periwinkle Tempest",
                "TEMP.MixMaster",
                "Wizard Spider"
            ],
            "source_name": "ETDA:Wizard Spider",
            "tools": [
                "AdFind",
                "Agentemis",
                "Anchor_DNS",
                "BEERBOT",
                "BazarBackdoor",
                "BazarCall",
                "BazarLoader",
                "Cobalt Strike",
                "CobaltStrike",
                "Conti",
                "Diavol",
                "Dyranges",
                "Dyre",
                "Dyreza",
                "Dyzap",
                "Gophe",
                "Invoke-SMBAutoBrute",
                "KEGTAP",
                "LaZagne",
                "LightBot",
                "PowerSploit",
                "PowerTrick",
                "PsExec",
                "Ryuk",
                "SessionGopher",
                "TSPY_TRICKLOAD",
                "Team9Backdoor",
                "The Trick",
                "TheTrick",
                "Totbrick",
                "TrickBot",
                "TrickLoader",
                "TrickMo",
                "Upatre",
                "bazaloader",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bc119938-a79c-4e5f-9d4d-dc96835dfe2e",
            "created_at": "2024-06-04T02:03:07.799286Z",
            "updated_at": "2025-03-27T02:05:17.337094Z",
            "deleted_at": null,
            "main_name": "GOLD BLACKBURN",
            "aliases": [
                "Periwinkle Tempest ",
                "Wizard Spider ",
                "ITG23 "
            ],
            "source_name": "Secureworks:GOLD BLACKBURN",
            "tools": [
                " Buer Loader",
                " Dyre",
                " Team9",
                " TrickBot",
                "BazarLoader"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97cf06d-c2e2-4771-99a2-c9dee0d6a0ac",
            "created_at": "2022-10-25T16:07:24.349252Z",
            "updated_at": "2025-03-27T02:02:10.184406Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "ATK 13",
                "Belugasturgeon",
                "Blue Python",
                "CTG-8875",
                "Group 88",
                "ITG12",
                "Iron Hunter",
                "Krypton",
                "Makersmark",
                "Operation Epic Turla",
                "Operation Moonlight Maze",
                "Operation Penguin Turla",
                "Operation Satellite Turla",
                "Operation Skipper Turla",
                "Operation Turla Mosquito",
                "Operation WITCHCOVEN",
                "Pacifier APT",
                "Pensive Ursa",
                "Popeye",
                "SIG15",
                "SIG2",
                "SIG23",
                "Secret Blizzard",
                "TAG-0530",
                "Turla",
                "UNC4210",
                "Venomous Bear",
                "Waterbug"
            ],
            "source_name": "ETDA:Turla",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "ATI-Agent",
                "AdobeARM",
                "Agent.BTZ",
                "Agent.DNE",
                "BigBoss",
                "COMpfun",
                "Chinch",
                "Cloud Duke",
                "CloudDuke",
                "CloudLook",
                "Cobra Carbon System",
                "ComRAT",
                "DoublePulsar",
                "EmPyre",
                "EmpireProject",
                "Epic Turla",
                "EternalBlue",
                "EternalRomance",
                "GoldenSky",
                "Group Policy Results Tool",
                "HTML5 Encoding",
                "HyperStack",
                "IcedCoffee",
                "IronNetInjector",
                "KSL0T",
                "Kapushka",
                "Kazuar",
                "KopiLuwak",
                "Kotel",
                "LOLBAS",
                "LOLBins",
                "LightNeuron",
                "Living off the Land",
                "Maintools.js",
                "Metasploit",
                "Meterpreter",
                "MiamiBeach",
                "Mimikatz",
                "MiniDionis",
                "Minit",
                "NBTscan",
                "NETTRANS",
                "NETVulture",
                "Neptun",
                "NetFlash",
                "NewPass",
                "Outlook Backdoor",
                "Penquin Turla",
                "Pfinet",
                "PowerShell Empire",
                "PowerShellRunner",
                "PowerShellRunner-based RPC backdoor",
                "PowerStallion",
                "PsExec",
                "PyFlash",
                "QUIETCANARY",
                "Reductor RAT",
                "RocketMan",
                "SMBTouch",
                "SScan",
                "Satellite Turla",
                "SilentMoon",
                "Sun rootkit",
                "TTNG",
                "TadjMakhal",
                "Tavdig",
                "TinyTurla",
                "TinyTurla Next Generation",
                "TinyTurla-NG",
                "Topinambour",
                "Tunnus",
                "Turla",
                "Turla SilentMoon",
                "TurlaChopper",
                "Uroburos",
                "Urouros",
                "WCE",
                "WITCHCOVEN",
                "WhiteAtlas",
                "WhiteBear",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "Wipbot",
                "WorldCupSec",
                "XTRANS",
                "certutil",
                "certutil.exe",
                "gpresult",
                "nbtscan",
                "nbtstat",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8aaa5515-92dd-448d-bb20-3a253f4f8854",
            "created_at": "2024-06-19T02:03:08.147099Z",
            "updated_at": "2025-03-27T02:05:17.408118Z",
            "deleted_at": null,
            "main_name": "IRON HUNTER",
            "aliases": [
                "Belugasturgeon ",
                "Blue Python ",
                "CTG-8875 ",
                "ITG12 ",
                "KRYPTON ",
                "MAKERSMARK ",
                "Pensive Ursa ",
                "Secret Blizzard ",
                "Turla",
                "UAC-0003 ",
                "UAC-0024 ",
                "UNC4210 ",
                "Venomous Bear ",
                "Waterbug ",
                "ATK13 "
            ],
            "source_name": "Secureworks:IRON HUNTER",
            "tools": [
                " ComRAT",
                " Kazuar",
                " KopiLuwak",
                " LightNeuron",
                " Mosquito",
                " Nautilus",
                " Neuron",
                " Penquin",
                " PoisonFrog",
                " PyFlash",
                " Skipper",
                " Snake",
                " Tavdig",
                " TinyTurla",
                " Tunnus",
                "Carbon-DLL"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a97fee0d-af4b-4661-ae17-858925438fc4",
            "created_at": "2023-01-06T13:46:38.396415Z",
            "updated_at": "2025-03-27T02:00:02.823045Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Uroburos",
                "Hippo Team",
                "Pacifier APT",
                "MAKERSMARK",
                "ATK13",
                "UAC-0003",
                "IRON HUNTER",
                "Waterbug",
                "TAG_0530",
                "KRYPTON",
                "Popeye",
                "SIG23",
                "UAC-0144",
                "G0010",
                "Blue Python",
                "VENOMOUS Bear",
                "Group 88",
                "Pfinet",
                "ITG12",
                "UNC4210",
                "Secret Blizzard",
                "UAC-0024"
            ],
            "source_name": "MISPGALAXY:Turla",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d11c89bb-1640-45fa-8322-6f4e4053d7f3",
            "created_at": "2022-10-25T15:50:23.509601Z",
            "updated_at": "2025-03-27T02:00:55.487991Z",
            "deleted_at": null,
            "main_name": "Turla",
            "aliases": [
                "Turla",
                "IRON HUNTER",
                "Group 88",
                "Waterbug",
                "WhiteBear",
                "Krypton",
                "Venomous Bear",
                "Secret Blizzard",
                "BELUGASTURGEON"
            ],
            "source_name": "MITRE:Turla",
            "tools": [
                "PsExec",
                "nbtstat",
                "ComRAT",
                "netstat",
                "certutil",
                "KOPILUWAK",
                "IronNetInjector",
                "LunarWeb",
                "Arp",
                "Uroburos",
                "PowerStallion",
                "Kazuar",
                "Systeminfo",
                "LightNeuron",
                "Mimikatz",
                "Tasklist",
                "LunarMail",
                "HyperStack",
                "NBTscan",
                "TinyTurla",
                "Penquin",
                "LunarLoader"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535845,
    "ts_updated_at": 1743041780,
    "ts_creation_date": 1653489048,
    "ts_modification_date": 1653489048,
    "files": {
        "pdf": "https://archive.orkl.eu/3b0aeeed8f4b3aab13806cbcd8cd3fa66eea8d05.pdf",
        "text": "https://archive.orkl.eu/3b0aeeed8f4b3aab13806cbcd8cd3fa66eea8d05.txt",
        "img": "https://archive.orkl.eu/3b0aeeed8f4b3aab13806cbcd8cd3fa66eea8d05.jpg"
    }
}