{
    "id": "0daf8d91-e636-4ba2-8e5f-5b87471434de",
    "created_at": "2023-01-12T14:59:55.693978Z",
    "updated_at": "2025-03-27T02:05:51.271685Z",
    "deleted_at": null,
    "sha1_hash": "b3de895df5b0d58f4d635b622f49d475b92a4e28",
    "title": "2018-07-26 - Mitigating Emotet, The Most Common Banking Trojan",
    "authors": "",
    "file_creation_date": "2022-05-28T23:35:11Z",
    "file_modification_date": "2022-05-28T23:35:11Z",
    "file_size": 3807827,
    "plain_text": "# Mitigating Emotet, The Most Common Banking Trojan\n\n**[intezer.com/mitigating-emotet-the-most-common-banking-trojan/](https://www.intezer.com/mitigating-emotet-the-most-common-banking-trojan/)**\n\nJuly 26, 2018\n\n## Get Free Account\n\nJoin Now\n\n[Recently, Proofpoint released a fairly surprising report, stating that Banking Trojans have](https://www.proofpoint.com/us/resources/threat-reports/latest-quarterly-threat-research)\nsurpassed Ransomware as the top malware threat found in email. This is not too surprising,\ndue to the rising difficulty of cashing out cyber-ransom operations, and the increasing\nawareness of enterprises for these kinds of threats. In addition, Emotet created recent\n[headlines with the US-CERT alert about it.](https://www.us-cert.gov/ncas/alerts/TA18-201A)\n\nBanking Trojans usually work by logging keystrokes of unsuspected users while they log into\ntheir online bank accounts, thus stealing their credentials to their online account. Infamous\nBanking Trojans include Ursnif, Dridex, Zeus and more.\n\nMost noticable, is a malware named Emotet, which according to Proofpoint‚Äôs recent report,\nconsists of 57% of all Banking Trojans. At Intezer, we have also noticed a large amount of\nEmotet samples uploaded to our platform daily, both by our customers and our free\ncommunity users.\n\n\n-----\n\nTo help organizations and individuals cope with this threat, I decided to post an informative\nblog post on how we can assist with our technology, in the battle against Emotet.\n\nEmotet‚Äôs Components and Similarities\n\nAs you might know, at Intezer, we like to approach the malware problem by identifying code\nreuse and similarities. In the case of Emotet (and other Banking Trojans), this approach\nproves itself to be very effective.\n\nEmotet is usually composed from several different components: The initial dropper/loader,\nand the actual payload (which in many cases are several different ones). The initial dropper\nis designed to be very stealthy by constantly mutating. It‚Äôs rare to see two different Emotet\nloaders that are exactly the same, due to obfuscation or other code mutation techniques.\nThis is extremely effective in order to deal with signature-based defense.\n\nThe below report shows a code similarity analysis on the Emotet dropper. It is clear to see\nthat almost 95% of the code is unique, which illustrates the mutation and evasiveness of this\nmodule. However, we can also see 3 ‚Äúgenes‚Äù, or 5% of the file‚Äôs code that was already seen\nin other Emotet variants. We can also observe that the malware was detected only by 12\nanti-malware engines at the time of the first analysis in our system, which demonstrates the\neffectiveness of such evasion techniques.\n\nAlso, notice the file‚Äôs metadata: it tries to mimic the Microsoft Windows product details, so\nthat the file would seem legitimate to the untrained user ‚Äî although there‚Äôs absolutely no\nMicrosoft code in this binary.\n\n\n-----\n\n[https://analyze.intezer.com/#/analyses/a2e33ff7-6439-453d-885c-25305d433cc9](https://analyze.intezer.com/#/analyses/a2e33ff7-6439-453d-885c-25305d433cc9)\n\nDigging into the 3 gene connection, we can see exactly which other Emotet variants share\nsome of these genes:\n\nIn almost all Emotet cases, we noticed that although the dropper tries to mutate and evade\nsignature-based defenses, we find a small amount of similarity (usually 2-5 ‚ÄúGenes‚Äù). It‚Äôs a\nvery small connection, but it‚Äôs always there.\n\nThe dropper‚Äôs goal is to execute the final payload in memory, where the attacker has much\nmore ‚Äúfreedom‚Äù to stay hidden. Indeed, after running the dropper, we see modules in\nmemory that contain much more code (see 56 genes of the dropper vs 296 genes in one of\nthe payloads), and also have a much stronger code similarity to other Emotet variants.\n\n\n-----\n\nThis is a pattern we see time and time again with Emotet: the initial payload is\nmutated/obfuscated and contains a small connection to Emotet, whereas the final payloads\nin memory are ‚Äúunpacked‚Äù and contain code that correlates clearly to other variants.\n\nAnother interesting example of code similarities within Emotet, is the sample mentioned in\n[Check Point‚Äôs blog post where Emotet was embedding the free software Nirsoft in order to](https://research.checkpoint.com/emotet-tricky-trojan-git-clones/)\nsteal email credentials. Indeed after execution of the initial loader, we can see a module in\nmemory that shares code with Nirsoft Mail PassView:\n\n\n-----\n\nhttps://analyze.intezer.com/#/analyses/22c91372-2663-4d5c-940f7090f222cef0/sub/7fe6c86f-cc1e-4d36-80e2-6fca66f0e4cd\n\nMitigating Emotet\n\n(A) I have a suspicious file that I suspect is Emotet\n\n[You can analyze the suspicious file with Intezer‚Äôs community edition. It‚Äôs free üôÇ You‚Äôll have](https://analyze.intezer.com/)\nthe same insights as the above examples, and know instantly if the file is indeed malicious,\nand if it‚Äôs really Emotet or a different kind of threat. Search for other malicious Emotet files\nacross your network using instructions in (C).\n\n(B) I suspect that one of our machines is infected by Emotet\n\n[1. Check for scheduled tasks using Autoruns to spot binaries that are a part of Emotet‚Äôs](https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns)\n[persistence mechanism. Analyze these files using VirusTotal or](https://www.virustotal.com/) [Intezer.](https://analyze.intezer.com/)\n\n2. Since Emotet‚Äôs payload resides in memory, memory analysis is your best choice to triage\n[and analyze a suspicious endpoint. Use winpmem to obtain a memory image of the](https://github.com/google/rekall/releases)\n[computer, and then use Volatility to extract all loaded executables from memory. You can do](https://www.volatilityfoundation.org/)\n[that by using Volatility‚Äôs procdump and dlldump plugins. Once you obtain all binaries from](https://github.com/volatilityfoundation/volatility/wiki/Command-Reference)\nmemory, send them to [Intezer for analysis to identify Emotet payloads. Code similarity](https://analyze.intezer.com/)\ndetection works just fine also with memory-extracted items.\n\n3. Submit the detected Emotet payload to your anti virus vendor and update signatures. As\ninitial response, you can kill the process and remove the persistence binary using Autoruns.\n\n(C) I suspect or I don‚Äôt know if machines across my network are infected with Emotet\n\n\n-----\n\nAs mentioned before, due to the fact that Emotet resides in memory, a good approach would\nbe to search for a [YARA signature across all the network. For that, you‚Äôll need a relevant](https://virustotal.github.io/yara/)\nYARA rule that detects Emotet payloads, as well as a YARA memory scanner.\n\nI recommend checking out Loki, an open-source YARA scanner by Florian Roth\n[(@cyb3rops) that can help you scan endpoints across your network. For YARA rules to](https://twitter.com/cyb3rops)\ndetect Emotet, there‚Äôs one that GoDaddy‚Äôs security team has written:\n[https://github.com/godaddy/yara-rules/blob/master/emotet.yara, and the one within the CAPE](https://github.com/godaddy/yara-rules/blob/master/emotet.yara)\nproject: [https://github.com/ctxis/CAPE/blob/master/data/yara/CAPE/Emotet.yar.](https://github.com/ctxis/CAPE/blob/master/data/yara/CAPE/Emotet.yar)\n\nOnce a file is identified using a YARA rule, we recommend to dump the suspicious process\n[and analyze it with Intezer Analyze, to confirm the initial detection. Signature-based detection](https://analyze.intezer.com/)\nsuch as YARA may result sometimes in false-positives, especially in memory, so it‚Äôs always a\ngood practice to reconfirm.\n\nSummary\n\nEmotet and other Banking Trojans cause a huge pain for enterprise organizations and endusers alike. Usually, these types of malware are highly evasive and polymorphic, which\nposes a challenge for many security solutions to protect against them. However, time and\ntime again we observed that when utilizing code similarity detection techniques, these\nthreats can be better identified and mitigated.\n\nWe hope that the information provided in this post, together with our free malware analysis\nplatform, will help to decrease the number of Emotet victims worldwide.\n\n**Itai Tevet**\nOnce led a government CERT. Now, CEO at Intezer, changing the way we detect, analyze\nand respond to malware.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2018/2018-07-26 - Mitigating Emotet, The Most Common Banking Trojan.pdf"
    ],
    "report_names": [
        "2018-07-26 - Mitigating Emotet, The Most Common Banking Trojan.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535595,
    "ts_updated_at": 1743041151,
    "ts_creation_date": 1653780911,
    "ts_modification_date": 1653780911,
    "files": {
        "pdf": "https://archive.orkl.eu/b3de895df5b0d58f4d635b622f49d475b92a4e28.pdf",
        "text": "https://archive.orkl.eu/b3de895df5b0d58f4d635b622f49d475b92a4e28.txt",
        "img": "https://archive.orkl.eu/b3de895df5b0d58f4d635b622f49d475b92a4e28.jpg"
    }
}