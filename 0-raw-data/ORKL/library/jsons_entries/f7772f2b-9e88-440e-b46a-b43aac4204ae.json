{
    "id": "f7772f2b-9e88-440e-b46a-b43aac4204ae",
    "created_at": "2023-01-12T15:07:19.262952Z",
    "updated_at": "2025-03-27T02:08:23.136588Z",
    "deleted_at": null,
    "sha1_hash": "bb6b26e4f184d22b397fab093a87075a2e1b8685",
    "title": "2019-02-06 - Qealler – a new JAR-based information stealer",
    "authors": "",
    "file_creation_date": "2022-05-28T19:00:35Z",
    "file_modification_date": "2022-05-28T19:00:35Z",
    "file_size": 2505645,
    "plain_text": "# Qealler – a new JAR-based information stealer\n\n**zscaler.com/blogs/research/qealler-new-jar-based-information-stealer**\n\nRecently, the Zscaler ThreatLabZ team came across a new type of malware called Qealler, which is written in Java and designed to silently\nsteal sensitive information from an infected machine.\n\nQealler is a highly obfuscated Java loader that deploys a Python credential harvester.\n\n[We first saw this payload hit Zscaler Cloud Sandbox on Jan 21, 2019, and below is a screenshot of the detonation report.](https://www.zscaler.com/products/sandboxing)\n\nFig. 1: Zscaler Cloud Sandbox report\n\nThis threat makes use of social engineering techniques to initiate the infection, as the malicious JAR file has to be executed by the user.\nThese malicious JAR files are portrayed as invoice-related files, requiring the user to double-click on the file to open it.\n\nWe have been monitoring this campaign for the past two weeks, and the malware has been quite active, spiking this week.\n\n\n-----\n\nFig. 2: Hits of Qealler in a week\n\nThe malicious JAR file (named Remittance.jar), which we analyzed, was getting downloaded from a compromised site (hiexsgroup.co[.]uk). It\nis heavily obfuscated with Proguard Java obfuscator. After deobfuscation and decompilation, we saw encrypted URLs that are accessible by\na key, as shown in the figure below.\n\nFig. 3: Accessing encrypted URLs\n\nThe sample has a “synchronized” file that contains key-value pairs.\n\nFig. 4: Key-Value pair of encrypted URLs\n\nOn execution, this sample first creates two file paths in %USERPROFILE% by checksum of hardcoded strings.\n\nFig. 5: File Path creation\n\n**File path 1:**\n\n\n-----\n\n%US O %\\\\C C3 ( a890bc98aa 6c96 05 bb eadc98 8eb 633039e9e9 d833 0 ce553 e9b )\\\\C C3 ( qea e )\\\\C C3 ( b )\\\\C\n\nEquivalent to:\n\n%USERPROFILE%\\\\a60fcc00\\\\bda431f8\\\\a90f3bcc\\\\83e7cdf9\n\n**File Path 2:**\n\n%USERPROFILE%\\\\CRC32(“2a890bc98aaf6c96f2054bb1eadc9848eb17633039e9e9ffd833104ce553fe9b”)\\\\CRC32(“qealler”)\\\\CRC32(“lib”)\\\\CR\n\nEquivalent to:\n\n%USERPROFILE%\\\\a60fcc00\\\\bda431f8\\\\a90f3bcc\\\\db2bf213\n\nIf the above two files don’t exist, the malicious file decrypts the URL, downloads these two files, and stores them in the same place.\n\nFig. 6: Encrypts and drops downloaded module\n\nThe value of LIB_7Z_URL in the synchronized file is\n“xVQR4PWAw91AhkgaMsQVAVV1igV7HSOV1dqWgFN23eQtkNRd23RzTnPVGB9/iVYA” which is decoded by BASE64 and decrypted by\nAES-EBC with the hardcoded key “bbb6fec5ebef0d93”.\n\nThe final URL after decryption is hxxp://82.196.11[.]96:55326/lib/7z\n\nThe value of LIB_QEALLER_URL in the synchronized file is\n“xVQR4PWAw91AhkgaMsQVAaWhGxVQIpMxX60ZE+OpV3KjNnWvOARi0rccZaVSvle8”, it is also decrypted by the same algorithm with the\nsame key.\n\nThe final URL is hxxp://82.196.11[.]96:54869/lib/qealler\n\nThe sample downloads the data from these URLs and encrypts it using the AES algorithm with the key generated by SecureRandom() having\nhardcoded seed value “2a890bc98aaf6c96f2054bb1eadc9848eb17633039e9e9ffd833104ce553fe9b”.\n\nAES key: 39 3e df 7e fc 58 be 20 60 e4 78 bb 4a 91 38 72\n\nAfter encryption, it stores both files at the below locations to avoid further downloading in the next run:\n\n%USERPROFILE%\\\\a60fcc00\\\\bda431f8\\\\a90f3bcc\\\\83e7cdf9 (/lib/7z)\n\n%USERPROFILE%\\\\a60fcc00\\\\bda431f8\\\\a90f3bcc\\\\db2bf213 (/lib/qealler)\n\n\n-----\n\nFig. 7: Created path and dropped files\n\nAlong with these two files, the virus creates another file path with the following algorithm and stores an encrypted unique machine ID in it. The\nID is generated by a random number of system nanoTime.\n\n**Machine ID path:**\n\n%USERPROFILE%\\\\CRC32(“2a890bc98aaf6c96f2054bb1eadc9848eb17633039e9e9ffd833104ce553fe9b”)\\\\CRC32(“qealler”)\\\\CRC32(“machine\n\nEquivalent to:\n\n%USERPROFILE%\\\\a60fcc00\\\\bda431f8\\\\1505df84\\\\bf396750\\\\98dd4acc\\\\99de3ada\n\nAfter the downloading and decryption steps are completed, the sample stores a decrypted copy of 83e7cdf9 and db2bf213 in the %TEMP%\ndirectory with the name “_<SystemNanoTime>.tmp”.\n\n_502560701855008616300501457487639.tmp\n\n_502562165489004300569223733573535.tmp\n\n_502560701855008616300501457487639.tmp (/lib/7z) is again a JAR file that doesn’t have any Java code inside, but contains three PE files\ninside the libraries as shown in Fig 8.\n\nFig. 8: Content of _502560701855008616300501457487639.tmp (/lib/7z)\n\n7za.exe is a repackaged version of 7-zip to ensure the malware executes successfully even if the user does not have it installed by default.\n\nThe 7-zip (7za.exe) and its modules (7za.dll, 7zxa.dll) will be extracted from 7z.jar by the main sample and saved in the %TEMP% directory\nwith the name “7z_<SystemNanoTime>.exe” and “7z_<SystemNanoTime>.dll”.\n\n7z_502574395484008643130462441900754.exe\n\n7z_502567545558005642490654395727502.dll\n\n7z_502579570140002751296504101539829.dll\n\nAfter extraction, the 7-zip executable is called by the main sample with the following command-line options:\n\n\n-----\n\n% %\\\\ _50 5 395 8 0086 3 30 6 900 5 e e % %\\\\_50 56 65 8900 300569 3 335 3535 t p o% %\np”bbb6fec5ebef0d936db0b031b7ab19b6” -mmt -aoa -y\n\nThe downloaded Qealler module _502562165489004300569223733573535.tmp (/lib/qealler) is a password-protected file with 7-zip.\n\nThe above command will extract the Qealler module in the %TEMP% directory with the password: bbb6fec5ebef0d936db0b031b7ab19b6\n\n-mmt: use multithreading mode\n\n-aoa: set overwrite mode\n\n-y: assume yes for all the prompts\n\nThe Qealler module is the key component of this malware.\n\nThe extracted Qealler module contains Python 2.7.12 with the installed packages to ensure the malware will execute even if the user does\nnot have it installed by default.\n\n[The Qealler also has a directory named QaZaqne. It is a custom version of the open source project called LaZagne. LaZagne is used to](https://github.com/AlessandroZ/LaZagne)\nretrieve lots of passwords stored on a local computer. This is the same functionality of QaZagne, which finds and steals credentials of the\nmost commonly used software from local machines.\n\nFig. 9: Content of extracted _502562165489004300569223733573535.tmp (/lib/qealler)\n\nAfter extraction, the main sample (Remittance.jar) executes a Python file of QaZagne (main.py) with the following option and takes the JSON\noutput:\n\n%TEMP%\\\\qealler\\\\python\\\\python.exe %TEMP%\\qealler\\qazaqne\\main.py all\n\n\n-----\n\nFig. 10: Stealer functions in QaZaqne module\n\nThis will get the credentials of all the software shown in the figure below:\n\nFig. 11: Qealler steals credentials of the software in this table\n\nThe output of the QaZagne on an infected Windows machine is shown in Fig 12. It is in JSON format and contains the credentials of CoreFTP\nand a Windows credential manager. It always starts with #fs# and ends with #ff#.\n\n\n-----\n\nFig. 12: JSON output of QaZaqne module\n\nThe main sample parses this output, fetches below system information, and encrypts it using an AES-EBC algorithm with key\n“bbb6fec5ebef0d93”.\n\nFig. 13: Fetch and encrypt system info\n\nThe final information scraped from the infected machine before encryption is shown below.\n\n\n-----\n\ng Sc apped data o a ected ac e\n\nHere, machine_id is a unique ID generated by system nanoTime and uuid is encrypted in a synchronized file.\n\nThis output is encrypted and encoded with BASE64 and sent to the command-and-control (C2) server, whose URL is an encrypted value of\nthe key “d7c363a2019dac744cf076e11433547a47907e2c2f781e2d1c8f59a40c57dd03” in a synchronized file.\n\nC2 URL: hxxp://82.196.11[.]96:56636/qealler-reloaded/ping\n\nFig. 15: Data sent to C2\n\nIn the post headers, q-qealler-id is the encrypted machine ID and q-qealler-stub-id is the encrypted hash of the machine ID and system time.\n\nThe request body contains encrypted and encoded system information and stolen credentials.\n\nIf the C2 server is active and data is successfully sent to the server, it will respond with the encrypted status, which looks like the following\nafter decryption:\n\n{\"status\":\"2000\",\"message\":\"success\",\"extended\":[],\"time\":1548096059}\n\n**IOCs:**\n\nhiexsgroup.co[.]uk/?_sm_nck=1\n\nlcbodywowrksltd[.]online\n\nwillsonsolicitors[.]biz\n\nwillsonsolicitors[.]online\n\nwillsonsolicitors[.]store\n\nmcneilspecs[.]com\n\nmcneilspecs[.]org\n\nmcneilspecs[.]net\n\nprestigebuildersltd[.]com\n\nprestigebuildersltd[.]net\n\nlarrgroup.co[.]uk/remittance%20advice.jar\n\nprestonbuildersltd.co[.]uk/remittance%20advice.jar\n\notorgroup.co[.]uk/remittance%20advice.jar\n\nultrogroup.co[.]uk/remittance%20advice.jar\n\nstgeorgebuildltd.co[.]uk/remittance%20advice.jar\n\ngregoryteebuilders.co[.]uk/remittance%20advice.jar\n\n\n-----\n\nt j g oup co[ ]u / e tta ce ja\n\nkingagroup.co[.]uk/remittance%20advice.jar\n\nhiexgroup.co[.]uk/remittance%20advice.jar\n\nsalmogroup.co[.]uk/remittance%20advice.jar\n\n4f77bf588e0b721e68971059b0cefe21 (Remittance Advice.jar)\n\nb0ba5d6fdd26d81a6a2f050600ade3f0 (Remittance Advice.jar)\n\nd742beba17f7893b2b4989661652a66f (Remittance Advice.jar)\n\n61ecd8f17d405fa1c29dd78008011250 (Remittance Advice.jar)\n\nccac2b99cb4b72bc7728a8fc42ccc4ad (Remittance Advice.jar)\n\n76e87575e76b2ea28e1bb49e4c280152 (Remittance Advice.jar)\n\n7854ccf3208f805da7ec19a067ae3abe (Remittance Advice.jar)\n\nca741116466d5ddbcb76df00748bb885 (Remittance Advice.jar)\n\n9b7ebeff190cef02a7c22072d3d26ab3 (Remittance Advice.jar)\n\n639865eb7fac1b405b223cb4b7fe9ada ({E60A953D}-Remittance Advice.jar)\n\ne6fdc2140f6047fad60720cdf2157f9c (Remittance.jar)\n\naae120bf74131d04e47d99b16af41120 (Remittance.jar)\n\n3d43a83b1c8877e782ff69650ec00449 (Remittance.jar)\n\n4d433929f175c6df366aed139bf34f85 (Remittance.jar)\n\n2ed3b8cdc87a11437f5a15302ce047d6 (Remittance.jar)\n\n8e0f4cb12c6f2fef3a8ff731c195843d (Remittance.jar)\n\nfc20f0068b71cc74e9061a0ea2b5d45a (Cred_Adv043H3272.jar)\n\n791217f372c347f53003ae8a26a2fe54 (Cred_Adv043H3272.jar)\n\na593cb286e0fca1ca62e690022c6d918 (7z.jar)\n\n8d2c718599ed0aff7ab911e3f1966e8c (qealler.jar)\n\n5a8915c3ee5307df770abdc109e35083 (main.py)\n\n82.196.11[.]96:54869/lib/qealler\n\n82.196.11[.]96:443/lib/qealler\n\n128.199.60[.]13:443/lib/qealler\n\n37.139.12.136:443/lib/qealler\n\n192.81.222[.]28:41210/lib/qealler\n\n37.139.12[.]169:23980/lib/qealler\n\n37.139.12[.]169:16901/lib/qealler\n\n176.58.117[.]125:8676/lib/qealler\n\n176.58.117[.]125:8796/lib/qealler\n\n146.185.139[.]123:6521/lib/qealler\n\n159.65.84[.]42:10846/lib/qealler\n\n159.65.84[.]42:12536/lib/qealler\n\n\n-----\n\n39 59 6[ ] 000/ b/qea e\n\n128.199.60[.]13:47222/lib/7z\n\n128.199.60[.]13:443/lib/7z\n\n128.199.60[.]13:46061/lib/7z\n\n82.196.11[.]96:54869/lib/7z\n\n82.196.11[.]96:443/lib/7z\n\n37.139.12[.]136:443/lib/7z\n\n192.81.222[.]28:39871/lib/7z\n\n176.58.117[.]125:8650/lib/7z\n\n176.58.117[.]125:8796/lib/7z\n\n159.65.84[.]42:11268/lib/7z\n\n82.196.11[.]96:56636/qealler-reloaded/ping\n\n37.139.12[.]136:36561/qealler-reloaded/ping\n\n128.199.60[.]13:56636/qealler-reloaded/ping\n\n192.81.222[.]28:46871/qealler-reloaded/ping\n\n176.58.117[.]125:5797/qealler-reloaded/ping\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-06 - Qealler – a new JAR-based information stealer.pdf"
    ],
    "report_names": [
        "2019-02-06 - Qealler – a new JAR-based information stealer.pdf"
    ],
    "threat_actors": [
        {
            "id": "81dde5cc-c29f-430d-8c6e-e5e92d5015e7",
            "created_at": "2022-10-25T16:07:23.704358Z",
            "updated_at": "2025-03-27T02:02:09.932453Z",
            "deleted_at": null,
            "main_name": "Harvester",
            "aliases": [],
            "source_name": "ETDA:Harvester",
            "tools": [
                "Agentemis",
                "Cobalt Strike",
                "CobaltStrike",
                "Graphon",
                "Metasploit",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536039,
    "ts_updated_at": 1743041303,
    "ts_creation_date": 1653764435,
    "ts_modification_date": 1653764435,
    "files": {
        "pdf": "https://archive.orkl.eu/bb6b26e4f184d22b397fab093a87075a2e1b8685.pdf",
        "text": "https://archive.orkl.eu/bb6b26e4f184d22b397fab093a87075a2e1b8685.txt",
        "img": "https://archive.orkl.eu/bb6b26e4f184d22b397fab093a87075a2e1b8685.jpg"
    }
}