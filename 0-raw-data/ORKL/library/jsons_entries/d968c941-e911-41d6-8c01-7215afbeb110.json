{
    "id": "d968c941-e911-41d6-8c01-7215afbeb110",
    "created_at": "2023-01-12T15:06:21.711228Z",
    "updated_at": "2025-03-27T02:12:11.117252Z",
    "deleted_at": null,
    "sha1_hash": "afe4fe646c0ae8eee662e68261216dd9099f5150",
    "title": "2021-12-08 - Collector-stealer- a Russian origin credential and information extractor",
    "authors": "",
    "file_creation_date": "2022-05-28T19:45:46Z",
    "file_modification_date": "2022-05-28T19:45:46Z",
    "file_size": 1565438,
    "plain_text": "# Collector-stealer: a Russian origin credential and information extractor\n\n**[virusbulletin.com/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/](https://www.virusbulletin.com/virusbulletin/2021/12/collector-stealer-russian-origin-credential-and-information-extractor/)**\n\n### Aditya K Sood & Rohit Chaturvedi\n\n_Advanced Threat Research Center of Excellence, Office of the CTO, F5_\n\nTable of contents\n\nIntroduction\n\nCollector-stealer distribution mechanisms\n\nKMSAuto activation utility bundled with Collector-stealer\n\nCollector-stealer downloading via fake miner web portal\n\nTechnical analysis\n\nMalware history and objective\n\nPortable executable file structure\n\nImport address table and critical functions\n\nObfuscation routine\n\nOn-demand pseudo number generator\n\nExtracting screenshots via keyboard operations\n\nClient-side data access\n\nNetwork communication\n\nCommand-and-control panel design\n\nInference\n\nReferences\n\nAppendices\n\nAppendix 1: Threat actor profile\n\nAppendix 2: Indicators of compromise\n\nAppendix 3: Collector-stealer advertisement\n\nAppendix 4: MITRE ATT&CK TTP mapping\n\nAppendix 5: Comparison of multiple stealers\n\n## Introduction\n\nCollector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to\nexfiltrate sensitive data from end-user systems and store it in its C&C panels. The stolen\ninformation is consumed in the underground cyberspace for nefarious purposes. In this\narticle, we present a 360 analysis of the Collector-stealer malware to unearth hidden\n\n\n-----\n\nartifacts covering binary analysis, its working, and the design of associated C&C panels.\nWhile carrying out our research on Collector-stealer we found enough indicators to lead us\nto believe that the malware author is based in Russia. The attacker primarily uses Collectorstealer to target European countries, but it also affects users in other countries such as the\nUSA, China, Cambodia and others. Let’s start the analysis of Collector-stealer to unearth\nsome insights. We will refer to the malicious code as ‘Collector-stealer’ throughout this\narticle.\n\n## Collector-stealer distribution mechanisms\n\nWe began our research on the Collector-stealer malware by looking at how this malicious\ncode has been distributed across the Internet. The Collector-stealer author uses multiple\nmethods to launch infections, which include coercing users to visit phishing portals hosting\nfree game downloads, Windows activation/crack software packages, etc., to trigger drive-by\ndownload attacks that install the malware on the fly. Drive-by download attacks can be\nexecuted by exploiting vulnerabilities in client software such as browsers or abusing the\ninherent design of browsers. For Collector-stealer distribution, the phishing emails\ncontained messages that appeared to have come from legitimate authorized entities. With\nadditional efforts, we analysed the domains (or subdomains) contained in the phishing\nemails to collect more intelligence. In the following sections we discuss a few different\nexamples to explain how the attacker distributes the malware.\n\n### KMSAuto activation utility bundled with Collector-stealer\n\nKMSAuto (see Figure 1) is a free Windows/Office activation utility. In fact, KMSAuto is an\nunauthorized piece of software that allows the user to circumvent the integrity of the\noperating system to install cracked tools and is also categorized as a hack tool or ‘riskware’,\nallowing end-users to use MS Office products illegally. Generally, hack tools like KMSAuto\nenable attackers to bundle their malicious code with the cracked utility so that legitimate\napplications can be used in conjunction with malicious code, a technique known as\npiggybacking.\n\nUsing the piggybacking technique, malicious code rides on the back of the KMSAuto utility\nand activates the legitimate application illegally, to inject additional malicious payloads.\nCollector-stealer is distributed in this manner. Upon execution of the utility, KMSAuto\nactivates the application at the front, but in the backend it creates a sub-process that installs\nCollector-stealer on the victim’s machine and starts to communicate with the C&C server.\n\n\n-----\n\nFigure 1:\n\nKMSAuto crack utility.\n\nA number of other riskware utilities are used to serve the same purpose as KMSAuto. The\nmajority of these packages relate to games or Discord VPN, such as GTAV, NewWay\nModMenu, COD Manager, etc. The quote ‘Nothing comes for free on the Internet’ is worth\nmentioning here: if a user downloads any crack utility, software key generator or cracked\ngames/software from an untrusted site, there is high chance that it will lead to the user’s\nmachine being infected with malicious code.\n\n### Collector-stealer downloading via fake miner web portal\n\nKMSAuto is not the only method through which Collector-stealer is distributed. Phishing\nweb portals mimicking content from legitimate software provider sites are also used to\nspread the malware. During our research, we discovered that the attacker hosted a\nphishing web portal that replicated the content from a cryptocurrency software provider\nportal. The phishing web portal hosted Collector-stealer packages, and when the user\nvisited the web portal, Collector-stealer was downloaded on the fly. The phishing web portal\ntricked users into believing that they had downloaded legitimate miner software, which was\nnot the case.\n\nFigure 2 shows a comparison between the phishing portal and the legitimate portal.\n\n\n-----\n\nFigure 2: Phishing web portal on the left vs legitimate web portal on the right.\n\nThe phishing web portal was ethhomework[.]online and the legitimate web portal was\nhostero[.]eu. The attacker mirrored the content from the hostero[.]eu site and also added\nsocially engineered messages such as offering bitcoin after downloading, which is nothing\nbut bait for users.\n\nNow we have an understanding of the distribution mechanisms deployed by the attackers to\nspread Collector-stealer. Next, we present a technical analysis.\n\n## Technical analysis\n\n### Malware history and objective\n\nPublic reports have already been published about this malware. The malware has been\nactive since mid-2020 and is still active in the wild and actively compromising victim\nmachines. Collector-stealer, a stealth stealer written in C++, infects the victim machine to\nsteal valuable information such as stored passwords, cookies, web data and more, from the\ninfected machine. Collector-stealer, as its name suggests, is collectively used by many bad\nguys to exfiltrate data from across the world.\n\nLet’s start an in-depth analysis of the main program and have a look at the functionalities\nthis malware is equipped with.\n\n### Portable executable file structure\n\nIn this section we will present a basic structure of the Collector-stealer malware using static\nanalysis. Figure 3 shows the portable executable (PE) file structure. Overall, PE file\nstructure analysis helps us to understand the design of an executable. PE format is\ncomposed of Common Object File Format (COFF), object code, dynamic link libraries\n(DLLs), font files, and core dumps in 32-bit and 64-bit versions of Windows operating\nsystems. The PE format is a data structure that provides the information to the Windows\n\n\n-----\n\nloaders required to load the executable code in the memory. This includes dynamic library\nreferences for linking, API export and import tables, resource management data, and other\nstructures.\n\nFigure 3: PE structure of the Collector-stealer malicious code.\n\nNow we have provided a basic overview of Collector-stealer, including the basic details of\nthe PE structure. Let’s analyse the binary for more insights.\n\n### Import address table and critical functions\n\nIt is important to analyse the PE import address table (IAT) to understand the API functions\nbeing imported from the system DLLs and used during the execution of the binary. When a\nPE file is loaded into the system, the Windows loader is required to read the PE structure\nand load the image directly into the memory During this process the loader is also\n\n\n-----\n\nresponsible for loading all the DLLs that the executable is going to use into the associated\nprocess address space. The mapping of DLLs and related API functions is managed\nthrough the import address table, which contains the function pointers that the Windows\nloader copies while DLLs are loaded. In simple terms, the IAT defines which API functions\nthe executable is going to consume and performs related operations. We extracted the IAT\ntable of the Collector-stealer malware and the most critical API functions are discussed in\nTable 1 to help to understand how Collector-stealer works in the system.\n\n|DLL|Critical API functions|Basic overview|\n|---|---|---|\n|urlmon.dll|URLDownloadToFileA|Used to download files from the Internet.|\n|wininet.dll|InternetCloseHandle InternetOpenA InternetConnectA HttpSendRequestExA HttpEndRequestA InternetWriteFile HttpOpenRequestA|The library contains modules that help applications to interact with FTP and HTTP protocols to access Internet resources. This library contains Internet-related methods.|\n|crypt32.dll|CryptUnprotectData|Microsoft Cryptographic library, which implements many of the certificate and cryptographic messaging functions in the CryptoAPI, such as CryptSignMessage.|\n|ADVAPI32.dll|RegGetValueA RegOpenKeyExA|Advanced Application Programming Interface (AdvAPI32) is designed to support security calls and registry manipulation calls.|\n|Shell32.dll|SHGetFolderPathA|Designed to provide Windows Shell API functions, which are used to open web pages and files.|\n|User32.dll|CloseClipboard FindWindowA OpenClipboard keybd_event GetDesktopWindow ShowWindow GetClipboardData|Contains modules that help to implement the Windows USER component, additionally provides functions by which we can simulate user behaviour.|\n\n\n-----\n\nKernel32.dll OutputDebugStringW\nIsDebuggerPresent\nCreateFileW\nDeleteFileW\nLoadLibraryA\nTerminateProcess\nGetCurrentProcess\nFindFirstFileExW\nFindNextFileW\nGetFileAttributesEx\nVirtualProtect\nWriteFile\nReadFile\nGetStartupInfoW\n\ngdiplus.dll GdiplusShutdown\nGdipCreateBitmapFromHBITMAP\nGdipGetImageEncoders\nGdipCreateBitmapFromScan0\nGdipSaveImageToStream\nGdipGetImageEncodersSize\nGdipDisposeImage\nGdiplusStartup\n\nTable 1: Import address table.\n\n### Obfuscation routine\n\n\nKernel32.dll is one of the major\nlibraries in Windows machines. It\nprovides functions for process and\nthread creation, memory\nmanagement and more. It’s a usermode library.\n\n|gdiplus.dll|GdiplusShutdown GdipCreateBitmapFromHBITMAP GdipGetImageEncoders GdipCreateBitmapFromScan0 GdipSaveImageToStream GdipGetImageEncodersSize GdipDisposeImage GdiplusStartup|Microsoft Graphics Device Interface Library, designed to handle graphics components for images.|\n|---|---|---|\n\n\nIn this section we discuss the encryption and decryption procedures used by Collectorstealer. Listing 1 highlights the pseudocode that Collector-stealer uses to deobfuscate the\n_Windows public directory path address and other obfuscated strings using the key (string)_\n‘1A’.\n```\nStep 1 : Encoded_String : \"BB;YKXYBB6[HROIBB\"\nStep 2 : Deobfuscate_str : \"\"\nLabel 1:\n    Deobfuscate_str =Deobfuscate_str+HEX(String[i])+1A\n      If i<=Length(Encoded_String) :\ni=i+1\nGoto Label 1\n\n```\nListing 1: Pseudocode.\n\nOn successful deobfuscation of the code above and executing in a controlled manner, a\nnumber of strings were deobfuscated to obtain the clear text that clarifies how exactly\nCollector-stealer interacts with various resources in the system. Table 2 shows a number of\nclear text strings obtained after deobfuscation of the inherent routine used by Collectorstealer.\n\n\n-----\n\n|Encrypted string|Decrypted strings|\n|---|---|\n|2UMOT*GZG|Login data|\n|)UUQOKY|Cookies|\n|=KH*GZG|Web data|\n|] GRRKZJGZ|wallet.dat|\n|HXU]YKX|browser|\n|JKYQZUV0x14VTM|desktop.png|\n|0x15 0x3AKRKMXGS 0x6 0x2A KYQZUV 0x15ZJGZG|/Telegram Desktop/tdata|\n|9ZKGS6GZN|SteamPath|\n|95,:=’8+BB<GR\\KBB9ZKGS|SOFTWARE\\\\Valve\\\\Steam|\n|0x14\\JL|.vdf|\n|YZKGS|/con|\n\n\nTable 2: Decrypted strings from the binary.\n\nWhenever in the code the malware needs to use a string, it takes the encrypted string and\npasses it into functions to deobfuscate it.\n\n### On-demand pseudo number generator\n\nTo store all collected data into a file Collector-stealer performs additional operations to\ngenerate random file names by utilizing the power of Windows APIs to generate pseudorandom numbers, i.e. seed values to create random file names, determining the length of\nthe calculated strings, etc. To create a random string file name, Collector-stealer calls\nGetSystemtimeAsFileTime, as shown in Figure 4.\n\n\n-----\n\nFigure 4: Extracting the date\n\nand time from the system.\n\nThe GetSystemtimeAsFileTime API is used to obtain the current date and time of the\nsystem. The API processes 64-bit values, representing LowDateTime (low-order part of the\nfile time) and HighDateTime (high-order part of the file time) under the FILETIME structure.\nIn general, Collector-stealer validates the condition by verifying the data and time limits to\ncalculate the current time of the system. The calculated date and time value act as seed\nvalues to create a random string for generating the file name. Figure 5 shows an algorithm\nused by Collector-stealer to generate 15-word-long random strings, which are later used as\nfile names.\n\nFigure 5: Algorithm to create random string.\n\nFigure 6 shows Collector-stealer creating a new file by calling the CreateFileW [1] function\nutilizing the same algorithm as highlighted in Figure 5.\n\n\n-----\n\nFigure 6: Create\n\nrandomized named file.\n\nCollector-stealer also performs additional operations to extract the location and attempts to\ncheck the current time zone setting using the GetTimeZoneInformation function to check\nwhich time zone the victim machine belongs to, along with the computer name by calling\nthe GetComputerName method.\n\n### Extracting screenshots via keyboard operations\n\nIn this section the focus is on analysing the interaction of Collector-stealer with the Windows\nclipboard and keyboard events to take screenshots. In general, clipboard operations cover\nthe cut and copy functions that Windows provides. The clipboard history reflects the number\nof copy operations that are present in the clipboard. One of the main functionalities of\nCollector-stealer is to steal data via screenshot captures and store them in the clipboard. As\nshown in Figure 7, to capture the screenshot, the malware uses the Keybd_event function\nfrom user32.dll and simulates the user pressing ‘Take Screenshot’, bypassing\n‘VK_SNAPSHOT’ as a key parameter in the keybd_event function.\n\nFigure 7: Simulates screenshot key and stores captured image in clipboard.\n\nLater, Collector-stealer accesses the captured image from the clipboard in bitmap format\nand converts it into stream (Figure 8).\n\n\n-----\n\nFigure 8: Save captured image to stream.\n\nFigure 9: Desktop screenshot hex.\n\nFigure 9 is a byte stream of the captured screenshot, initial bytes ‘FF D8 FF E0’, which is\nthe four-byte signature of JPEG IMAGE. The malware writes a byte stream from memory\ninto a newly created file in ‘\\\\public\\\\directory’. After taking a screenshot, Collector-stealer\nstarts to look for other data such as finding Telegram data in the ‘tdata’ folder located at\n‘%Appdata%’. The ‘tdata’ folder is the directory in which Telegram Desktop keeps all mediarelated files, session details, etc.\n\n### Client-side data access\n\nIn this section we will look at how Collector-stealer searches for sensitive information stored\nin specific directories. After getting basic information, Collector-stealer starts to iterate each\nfolder and file in the location ‘C:\\Users\\alert-user\\AppData\\Roaming\\’ and looks for file login\ndata, cookie files, web data, and wallet.dat. Let’s understand the type of content stored in\nthese files. The details are discussed below:\n\n_Login data: Chrome logins are stored in the ‘Login Data’ SQLite database, within the_\n‘logins’ table.\n_Cookies: Chrome cookies are stored in the ‘Cookies’ SQLite database, within the_\n‘cookies’ table.\n_Web data: Chrome form history is stored in the ‘Web Data’ SQLite database, within_\nthe ‘autofill’ table.\n\n\n-----\n\n_Wallet.dat: the Bitcoin client stores private key information in a file named wallet.dat._\nThe wallet.dat file contains private keys, public keys, scripts (which correspond to\naddresses), key metadata (e.g. labels), and the transactions related to the wallet.\n\nOnce Collector-stealer has completed the scanning of the primary directory, it iterates the\n‘\\\\AppData\\\\Local’ directory and once again looks for file login data, cookie files, web data,\nand wallet.dat. Collector-stealer also scans all desktop files and looks for files with specific\nextensions such as .txt, .log, .rdp and others. If any file is found with such an extension, it\nreads the content of the file and stores the data in a compressed RAR file.\n\nCollector-stealer uses the URLDownloadToFile API to download sqlite3.dll from the C&C\nserver, as shown in Figure 10, and stores it in the public directory.\n\nFigure 10: Collector-stealer downloads the sqlite3 file.\n\nThe majority of modern browsers use SQLite databases to store data locally specific to\ndifferent websites and applications. The data includes cookies, login data, autofill data, web\ndata, etc. The parsing of an SQLite database requires the SQLite library. Collector-stealer\nleverages this functionality to obtain data in clear text from the SQLite database stored in\nthe compromised end‑user systems. SQLite’s library allows Collector-stealer to run SQL\nqueries for data extraction. After successfully reading the data, Collector-stealer\ncompresses all the stolen data, including directory structure, into Zip format. Figure 11\nshows how Collector-stealer structures the collected data into a single archive file.\n\nFigure 11: Malware downloads sqlite3 file.\n\n\n-----\n\nTable 3 represents the complete directory structure compressed as a Zip file and sent by\nCollector-stealer to the C&C server.\n\nInformation.txt Contains basic information such as launch time, username, etc.\n\ndesktop.png Desktop screenshot.\n\n/Browser/ Contains collected cookies data, autofill data, stored passwords.\n\n/Files/ Contains collected files from a desktop location whose file types are .txt,\n.log, .docx, .rdp.\n\n/Telegram/ Contains collected data from the data directory, i.e. Telegram data.\n\n/Steam/ Contains collected data from the steam directory as well as Steam\nregistry entries including active user details.\n\nTable 3: Archived directory insight.\n\n### Network communication\n\nLet’s understand the network communication, i.e. how this malicious code interacts with the\nC&C server and transmits the stolen data through the network. After successfully collecting\nthe sensitive data from the system, and before transmitting the data to the C&C server, as\nshown in Figure 12 Collector-stealer creates a new command line sub-process to check\nInternet connectivity on infected machines by pinging Cloudflare DNS resolver IP address\n1.1.1.1. If the ping request fails, then it deletes the executable file along with all previously\ncollected data and silently exits.\n\n|Information.txt|Contains basic information such as launch time, username, etc.|\n|---|---|\n|desktop.png|Desktop screenshot.|\n|/Browser/|Contains collected cookies data, autofill data, stored passwords.|\n|/Files/|Contains collected files from a desktop location whose file types are .txt, .log, .docx, .rdp.|\n|/Telegram/|Contains collected data from the data directory, i.e. Telegram data.|\n|/Steam/|Contains collected data from the steam directory as well as Steam registry entries including active user details.|\n\n\n-----\n\nFigure 12:\n\nCollector-stealer initiates ping request.\n\nLet’s dissect the command: ‘cmd.exe /C ping 1.1.1.1 -n 1 -w 1000 > Nul & Del /f /q \\”%s\\”’ to\nunderstand the complete operation.\n\n‘cmd.exe /C’: run the command and then terminate after receiving the response.\n‘ping 1.1.1.1 -n 1 -w 1000’\n\n‘-n 1’: total number of echo request should be 1.\n‘-w 1000’: number of milliseconds to wait for the echo reply message\ncorresponding to a given echo request message.\n‘1.1.1.1’: Cloudflare DNS server that is publicly available to trigger DNS queries\nin a fast manner.\n‘> nul’: The ‘nul’ data is a special file that discards the data written to it. Basically,\nit is used to hide the output of the command and avoid the use of the command\noutput by the other process.\n‘Del /f /q \\\\\\%s\\\\\\’: the command deletes the referenced file quietly (/q) and\nforcefully (/f) on the fly to remove its traces on the end-user system.\n\n\n-----\n\nUpon successful connectivity checks, Collector-stealer sends collected data to the C&C\nserver. Figure 13 shows the malware using HTTP POST requests to transmit stolen data\nusing zip files.\n\nFigure\n\n13: Collector-stealer exfiltrating data over HTTP channel.\n\nIf you see the ‘user-agent’ string, Collector-stealer does not use the standard browser\nidentifier, rather a custom string ‘uploader’. The data exfiltration process utilizes the HTTP\ncommunication channel. HTTP POST requests are initiated by Collector-stealer to exfiltrate\nthe data in a compressed format (zipped) to the C&C panel managed by the attacker. The\nunzipping of the data occurs in the C&C panel itself and stolen data is uploaded in the C&C\nportal for utilization.\n\n### Command-and-control panel design\n\nIn this section, you will gain an understanding of the design of Collector-stealer’s C&C\npanel. Collector-stealer C&C uses HTTP protocol for communication purposes. The data\nextracted from the compromised machine is sent to the C&C server in an archive format\nover HTTP. The Collector-stealer C&C server accepts the HTTP POST requests to receive\ndata from infected machines. The Collector-stealer C&C panel is developed using PHP\nusing openresty as a web server. Figure 14 shows the C&C login panel.\n\n\n-----\n\nFigure 14: Collector-stealer administrative C&C panel.\n\nFigure 15 shows how attackers keep stolen data in a more structured way.\n\n\n-----\n\nFigure 15: Collector-stealer: stolen logs storage functionality.\n\n## Inference\n\nInformation stealers actively target victims to exfiltrate sensitive information from the\ncompromised systems. In this article we have discussed the analysis of the Russian origin\nCollector-stealer malware. The data stolen by Collector-stealer is used for nefarious\npurposes – it may be sold in the underground market, the information may be harnessed for\nlaunching additional attacks, etc. Due to its popularity in the wild, some adversarial groups\nhave released cracked versions of Collector-stealer on the Internet and made it freely\navailable. The intelligence presented in this research can be utilized to enhance detection\nand prevention solutions to combat the risks posed by the Collector-stealer malware.\n\n## References\n\n[1] [https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilew.](https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-createfilew)\n\n## Appendices\n\n### Appendix 1: Threat actor profile\n\nAs Collector-stealer is bundled with numerous stealing features, it quickly gained popularity\non underground forums. Due to its extensive list of services offered, as shown in Figure 16,\nmany forum users were keen to buy this stealer and even some groups attempted to\nprovide cracked versions.\n\nOur research team started to investigate the malware and its author and discovered some\ninteresting facts. Collector-stealer is sold by the ‘Hack_Jopi’ group (Figure 17), and after\nsome more digging we found that the author sells this malware only to Russian users The\n\n\n-----\n\nauthor has been active on the forum since October 2018, is still active and periodically\nreleases updates. As per the forum’s updates, the last update version was v1.20 ‘aimed at\nfixing the collection of Telegram, Discord and Steam sessions’. But we also saw some\nsamples with 1.21 version (malware mentioned version_id in drop file).\n\nTo cover maximum audiences for Collector-stealer, the author uses other platforms as such\nas Telegram, where authors create their own channel and publicize their stealer. In forums,\nthey created a separate account with the name ‘CollectorSoft’. Most of the accounts were\ncreated between May and June 2020. So we can conclude that this malware started\nspreading in mid-2020 and is still active in the wild.\n\nFigure 16: Services offered.\n\n\n-----\n\nFigure 17:\n\nForum and Telegram accounts.\n\n### Appendix 2: Indicators of compromise\n\nA number of malware hashes and list of C&C servers related to Collector-stealer are\npresented in Listings 2 & 3:\n```\na9e3f9fb9cf5ae8dcbfd139ecadb961a\nbd27acd9bc0ba05847dc0d8ea443e437\n253ce038dd0e2a30165f24b18aaa34d3\neb8e99e82b6ed97f89292467aa8dc866\n\n```\nListing 2: Indicators of compromise: malware hashes.\n\n\n-----\n\n```\nf0537213[.]xsph[.]ru\nfata-collector[.]online\nf0542175[.]xsph[.]ru\nf0538564[.]xsph[.]ru\nf0537214[.]xsph[.]ru\nf0548561[.]xsph.ru\ncollector-node[.]us\ncollector-gate01[.]us\ncollector-steal[.]ga\na0556434[.]xsph[.]ru //Kpot Panel\n\n```\nListing 3: Indicators of compromise: C&C domains.\n\n### Appendix 3: Collector-stealer advertisement\n\nFigure 18 shows an example of an online advertisement for Collector-stealer presented in\nthe underground community. We can clearly see the advertisement is in Russian language.\n\nFigure 18: Advertisement on forum.\n\n### Appendix 4: MITRE ATT&CK TTP mapping\n\nIn Table 4 we correlate malware activity with MITRE ATT&CK TTP mapping\n\n\n-----\n\n|Tactic|Identifier|Name|Description|\n|---|---|---|---|\n|Collection|T1074.001|Data Staged: Local Data Staging|Store collected data at //Public// directory|\n|T1560|Archive Collected Data|Archive collected data before sending||\n|T1113|Screen Capture|Take desktop screenshot||\n|Discovery|T1083|File and Directory Discovery|Look for web data/cookies/login/desktop files|\n|T1124|System Time Discovery|Gather the system time and/or time zone||\n|T1012|Query Registry|Query HKCU for Steam entry||\n|T1082|System Information Discovery|Extract OS version||\n|T1016.001|System Network Configuration Discovery: Internet Connection Discovery|Ping 1.1.1.1 to check Internet connectivity||\n|Execution|T1059.003|Windows Command Shell|Ping 1.1.1.1 using cmd.exe|\n|Credential access|T1555|Credentials from Password Stores|Steal browser passwords|\n|T1539|Steal Web Session Cookie|Steal cookies||\n|Command and control|T1071.001|Application Layer Protocol: Web Protocols|Send data to the C&C server via POST requests|\n|T1105|Ingress Tool Transfer|Download sqlite3.dll||\n\n\nDefence\nevasion\n\n\n[T1027](https://attack.mitre.org/techniques/T1027/) Obfuscated\nFiles or\nInformation\n\n\nContain obfuscated\nstrings\n\n\n-----\n\n[T1036.001](https://attack.mitre.org/techniques/T1036/001/) Invalid Code Signature Invalid signed\nexecutables\n\nTable 4: MITRE ATT&CK TTP mapping.\n\n### Appendix 5: Comparison of multiple stealers\n\nWhile carrying out research on this malware, we tried to determine if there is any correlation\nbetween it and any other malware family. There is a strong opinion that the Collector-stealer\nauthor utilizes the same components as those found in the code of Hunter stealer. Hunter\nstealer is an information stealer whose functionality is almost identical to Collector-stealer.\nEven the file creation and file drop pattern provided by the two stealers are the same. And\nmost importantly, many buyers of this malware reported that logs go through the seller’s\nbot. Another possibility is that the author is the same for both malware families. This is not\nconcrete information, but it’s a good starting point for collecting more intelligence for\nattribution.\n\n## Latest articles:\n\n### Cryptojacking on the fly: TeamTNT using NVIDIA drivers to mine cryptocurrency\n\nTeamTNT is known for attacking insecure and vulnerable Kubernetes deployments in order\nto infiltrate organizations’ dedicated environments and transform them into attack\nlaunchpads. In this article Aditya Sood presents a new module introduced by…\n\nCollector-stealer, a piece of malware of Russian origin, is heavily used on the Internet to\nexfiltrate sensitive data from end-user systems and store it in its C&C panels. In this article,\nresearchers Aditya K Sood and Rohit Chaturvedi present a 360…\n\n### Fighting Fire with Fire\n\nIn 1989, Joe Wells encountered his first virus: Jerusalem. He disassembled the virus, and\nfrom that moment onward, was intrigued by the properties of these small pieces of selfreplicating code. Joe Wells was an expert on computer viruses, was partly…\n\n### Run your malicious VBA macros anywhere!\n\n\n-----\n\nKurt Natvig wanted to understand whether it s possible to recompile VBA macros to another\nlanguage, which could then easily be ‘run’ on any gateway, thus revealing a sample’s true\nnature in a safe manner. In this article he explains how he recompiled…\n\n### Dissecting the design and vulnerabilities in AZORult C&C panels\n\nAditya K Sood looks at the command-and-control (C&C) design of the AZORult malware,\ndiscussing his team's findings related to the C&C design and some security issues they\nidentified during the research.\n\n[Bulletin Archive](https://www.virusbulletin.com/virusbulletin/archive)\n\nWe have placed cookies on your device in order to improve the functionality of this site, as\n[outlined in our cookies policy. However, you may delete and block all cookies from this site](https://www.virusbulletin.com/about-vb/privacy-policy/cookies)\nand your use of the site will be unaffected. By continuing to browse this site, you are\n[agreeing to Virus Bulletin's use of data as outlined in our privacy policy.](https://www.virusbulletin.com/about-vb/privacy-policy/)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-12-08 - Collector-stealer- a Russian origin credential and information extractor.pdf"
    ],
    "report_names": [
        "2021-12-08 - Collector-stealer- a Russian origin credential and information extractor.pdf"
    ],
    "threat_actors": [
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673535981,
    "ts_updated_at": 1743041531,
    "ts_creation_date": 1653767146,
    "ts_modification_date": 1653767146,
    "files": {
        "pdf": "https://archive.orkl.eu/afe4fe646c0ae8eee662e68261216dd9099f5150.pdf",
        "text": "https://archive.orkl.eu/afe4fe646c0ae8eee662e68261216dd9099f5150.txt",
        "img": "https://archive.orkl.eu/afe4fe646c0ae8eee662e68261216dd9099f5150.jpg"
    }
}