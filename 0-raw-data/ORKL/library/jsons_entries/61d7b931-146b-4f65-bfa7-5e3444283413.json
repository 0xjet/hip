{
    "id": "61d7b931-146b-4f65-bfa7-5e3444283413",
    "created_at": "2023-01-12T15:06:35.839576Z",
    "updated_at": "2025-03-27T02:16:28.760421Z",
    "deleted_at": null,
    "sha1_hash": "fb5b7d0c9e7d404e653b723c08858a5ef1766150",
    "title": "2016-03-21 - OS X Malware Samples Analyzed",
    "authors": "",
    "file_creation_date": "2022-05-28T05:13:31Z",
    "file_modification_date": "2022-05-28T05:13:31Z",
    "file_size": 98048,
    "plain_text": "# OS X Malware Samples Analyzed\n\n**[alienvault.com/blogs/labs-research/os-x-malware-samples-analyzed](https://www.alienvault.com/blogs/labs-research/os-x-malware-samples-analyzed)**\n\n[1. AT&T Cybersecurity](https://cybersecurity.att.com/)\n[2. Blog](https://cybersecurity.att.com/blogs)\n\nMarch 21, 2016 | [AT&T Alien Labs](https://www.alienvault.com/blogs/author/att-alien-labs)\n_By Eddie Lee and Krishna Kona_\n\nA couple of months ago, as we rang in 2016, we thought it would be interesting to take a\nquick look back at some OSX malware from 2015 and 2014. As reported by the team at\nBit9+Carbon Black [1], 2015 marked “the most prolific year in history for OS X malware”. We\ncollected a few samples of malware named in that report, along with some samples of other\nnotable OSX malware, with the intention of learning more about them and fill in any gaps in\nour detection mechanisms (NIDS and Correlation rules). Although our primary objective was\nto capture network traffic from the malware samples, we were also interested in other\naspects of the malware like persistence mechanisms (if any) that they utilized, so we\ndocumented that activity as well.\n\nTo start off with, we reviewed Flashback, one of the most infamous pieces of OS X malware\nthat reminded everyone to the fact that OS X is not immune to malware. After that, we played\nwith KitM, which is spyware, and LaoShu, a RAT. Then we analyzed Mask, a sophisticated\nmalware that was used for cyber espionage. We also looked into CoinThief malware that\nsteals bitcoins from the infected machine and the WireLurker malware that is capable of\ninfecting iPhone devices connected to the compromised machine. Finally, we analyzed\nOceanLotus that was discovered May last year and found to be attacking Chinese\ngovernment infrastructure. Below is a summary of our findings from analyzing the samples in\na sandbox – the findings include links to fully executable samples, IDS signatures,\npersistence mechanisms and C&C details.\n\n## OS X Malware Details\n\n### Flashback\n\n**Description: Flashback masquerades as Adobe Flash player update or a signed-java**\napplet. Downloads/installs Web Traffic Interception component to inject ads into\nHTTP/HTTPS streams http://go.eset.com/us/resources/white-papers/osx_flashback.pdf [no\nlonger available].\n\n**Sample:**\nhttps://www.virustotal.com/en/file/58029f84c3826a0bd2757d2fe7405611b75ffc2094a806066\n62919dae68f946e/analysis/\n\n\n-----\n\n**Persistence mechanism: Installs a malicious file in user s home directory with the filename**\nstarting with a ‘dot' to hide itself and installs a LaunchAgent in ~/Library/LaunchAgents to\nrefer to the created malicious file.\n\n**C&C communication: Uses DGA for CnC domain names and twitter hashtags to decode**\nthe address of CnC server.\n\n**AlienVault Detections:**\n\nIDS\n\nExisting SIDs: 2014596, 2014597, 2014598, 2014599, 2014534, 2014522,\n2014523, 2014524, 2014525\nSystem Compromise, Trojan infection, Flashback\n\n### Kumar in the Mac (KitM)\n\n**Description: KitM is a signed malware that can take screenshots, download and install**\n[programs, and steal data [5].](https://www.f-secure.com/weblog/archives/00002558.html)\n\n**Sample:**\nhttps://www.virustotal.com/en/file/07062d9ecb16bd3a4ea00d434f469fe63d5c1c95d1b49037\n05de31353e9c92ce/analysis/\n\n**Persistence mechanism: Adds a Login Item at**\n~/Library/Preferences/com.apple.loginitems.plist\n\n**C&C server: liveapple[dot]eu (down)**\n\n**AlienVault Detections:**\n\nIDS rules: https://github.com/AlienVaultLabs/AlienVaultLabs/blob/master/malware_analysis/OSX_Malware/snort_kitm.rules\nSystem Compromise, Trojan infection, KitM\n\n### LaoShu\n\n**Description: LaoShu is a data stealing RAT. It has functionality to search for files, ex-filtrate**\n[files, download new file, and execute arbitrary commands [6].](https://nakedsecurity.sophos.com/2014/01/21/data-stealing-malware-targets-mac-users-in-undelivered-courier-item-attack/)\n\n**Sample:**\nhttps://www.virustotal.com/en/file/5443ad1db119b599232b91bbf0ac3d0e1e4f4894f7f4ba191\ne7b9f7a27acea0d/analysis/\n\n**Persistence mechanism: None**\n\n**C&C server: floracrunch[dot]com (down)**\n\n\n-----\n\n**AlienVault Detections:**\n\nIDS rules: https://github.com/AlienVaultLabs/AlienVaultLabs/blob/master/malware_analysis/OSX_Malware/snort_laoshu.rules\nSystem Compromise, Trojan infection, LaoShu\n\n### Appetite/Mask-Careto\n\n**Description: This is a state-of-the-art malware with Windows, Mac OS and Linux variants.**\nThe OS X variant uses a backdoor based on the open source Shadowinteger's Backdoor\n[(SBD) [7].](http://kasperskycontenthub.com/wp-content/uploads/sites/43/vlpdfs/unveilingthemask_v1.0.pdf)\n\n**Sample:**\nhttps://www.virustotal.com/en/file/0710be16ba8a36712c3cac21776c8846e29897300271f09b\na0a41983e370e1a0/analysis/ (Verified executability: tries to connect to\nitunes212[dot]appleupdt[dot]com)\n\n**Persistence mechanism: Installs a LaunchAgent at**\nLibrary/LaunchAgents/com.apple.launchport.plist and references a malicious binary in\n/Applications/.DS_Store.app\n\n**C&C servers:**\n\nitunes212[dot]appleupdt[dot]com\nitunes214[dot]appleupdt[dot]com\nitunes311[dot]appleupdt[dot]com\n\n(As of Feb 6, 2014, the above C&C domains have been suspended by Apple.)\n\n**AlienVault Detections:**\n\nIDS\n\nExisting SIDs: 2021712, 2021714, 2021715\nNew rules: https://github.com/AlienVault[Labs/AlienVaultLabs/blob/master/malware_analysis/OSX_Malware/snort_careto.r](https://github.com/AlienVault-Labs/AlienVaultLabs/blob/master/malware_analysis/OSX_Malware/snort_careto.rules)\nules\nSystem Compromise, Targeted Malware, Careto\n\n### CoinThief\n\n**Description: CoinThief installs browser extensions to steal credentials to popular Bitcoin**\n[wallet sites [8].](http://www.securemac.com/privacyscan/new-apple-mac-trojan-called-osxcointhief-discovered)\n\n**Sample:**\nhttps://www.virustotal.com/en/file/7d5eff5f83ab79e5f75acb9b84138561c8fd63ba00c050699c\n9f5be29d342f6e/analysis/\n\n\n-----\n\n**Persistence mechanism: Installs a LaunchAgent and browser extensions.**\n\nThe LaunchAgent is installed at\n~/Library/LaunchAgents/com.google.softwareUpdateAgent.plist and references a malicious\nbinary at ~/Library/Application\nSupport/.com.google.softwareUpdateAgent/com.google.softwareUpdateAgent.\n\nA Safari extensions is installed at ~/Library/Safari/Extensions/Pop-Up Blocker.safariextz.\n\nA Chrome extensions is installed at ~/Library/Application\nSupport/Google/Chrome/Default/DefaultApps/noehjlabkmejilomimnebjkdjaoomabh/1.0.0_0.\n\n**C&C server: www[dot]media02-cloudfront[dot]com (down)**\n\n**AlienVault Detections:**\n\nIDS rules: https://github.com/AlienVault[Labs/AlienVaultLabs/blob/master/malware_analysis/OSX_Malware/snort_cointhief.rule](https://github.com/AlienVault-Labs/AlienVaultLabs/blob/master/malware_analysis/OSX_Malware/snort_cointhief.rules)\ns\nSystem Compromise, Trojan infection, CoinThief\n\n### WireLurker\n\n**Description: WireLurker monitors an infected system for a USB connection to an iOS device**\n[and installs malicious applications on the device [9].](https://www.paloaltonetworks.com/content/dam/pan/en_US/assets/pdf/reports/Unit_42/unit42-wirelurker.pdf)\n\n**Sample:**\nhttps://www.virustotal.com/en/file/5d4f4fb2a663f1f79fb96edcd832374304af877938747b5844\ndaacf4beba2427/analysis/\n\n**Persistence mechanism:**\n\nInstalls LaunchDaemons\n/System/Library/LaunchDaemons/com.apple.MailServiceAgentHelper.plist\n/System/Library/LaunchDaemons/com.apple.appstore.plughelper.plist\n/System/Library/LaunchDaemons/com.apple.periodic-dd-mm-yy.plist\n/System/Library/LaunchDaemons/com.apple.systemkeychain-helper.plist\n\n**C&C servers: www[dot]comeinbaby[dot]com (down)**\n\n**AlienVault Detections:**\n\nIDS\n\nExisting SIDs: 2019660, 2019661, 2019662, 2019663, 2019664, 2019665,\n2019666, 2019667, 2019731, 2019718\n\n\n-----\n\nSystem Compromise, Malware infection, WireLurker\nSystem Compromise, Mobile trojan infection, WireLurker\n\n### OceanLotus\n\n**Description: OceanLotus is malware that has been used against Chinese targets and**\n[essentially gives attackers full control over a compromised machine [10] [11].](https://www.alienvault.com/blogs/labs-research/oceanlotus-for-os-x-an-application-bundle-pretending-to-be-an-adobe-flash-update)\n\n**Sample:**\nhttps://www.virustotal.com/en/file/83cd03d4190ad7dd122de96d2cc1e29642ffc34c2a836dbc0\ne1b03e3b3b55cff/analysis/\n\n**Persistence mechanism: Installs a LaunchAgent at**\n~/Library/LaunchAgents/com.google.plugins.plist and references a malicious binary at\n~/Library/Logs/.Logs/corevideosd\n\n**C&C servers:**\n\nkiifd[dot]pozon7[dot]net\nshop[dot]ownpro[dot]net\npad[dot]werzo[dot]net\n\n**AlienVault Detections:**\n\nIDS rules: https://github.com/AlienVault[Labs/AlienVaultLabs/blob/master/malware_analysis/OSX_Malware/snort_oceanlotus.ru](https://github.com/AlienVault-Labs/AlienVaultLabs/blob/master/malware_analysis/OSX_Malware/snort_oceanlotus.rules)\nles\n\nSystem Compromise, Targeted Malware, OceanLotus\n\n## Persistence Mechanisms\n\n[The samples we looked at used well known [2] persistence mechanisms and were not](https://www.virusbulletin.com/uploads/pdf/conference/vb2014/VB2014-Wardle.pdf)\ndifficult to detect. Specifically, the samples that we looked at use the following persistence\nmechanisms: launch agents, launch daemons, login items, and browser extensions. For\nthose that aren't familiar with how these mechanisms are used, below is a short summary.\n\n**Launch daemons: These are start-up programs that run when the system first boots up.**\n\nItems in /Library/LaunchDaemons and /System/Library/LaunchDaemons load\nwhen OSX starts up, and run as the root user.\n\n**Launch agents: These are start-up programs that are executed on a per-user basis.**\n\nItems in /Library/LaunchAgents and /System/Library/LaunchAgents load when any\nuser logs in, and run as that user.\n\n\n-----\n\nItems in ~/Library/LaunchAgents load only when that particular user logs in, and run\nas that user.\n\n**Login items**\n\nThese programs are run at the end of the login process and can be found in\n**~/Library/Preferences/com.apple.loginitems.plist. The login items can be viewed in**\nSystem Preferences -> Users & Groups -> [User Name] -> Login Items\n\n**Browser extensions**\n\nThese are plugins that are loaded when a user starts a web browser such as Safari, Chrome,\nFirefox or Opera. These plugins are often used to monitor browser activity and steal sensitive\ninformation such as login credentials. Although the samples we looked at used browser\nextensions, malicious plugins are not limited to browsers – malicious plugins can be added to\na variety of applications that support plugins.\n\n## OTX Stats\n\nIn addition to gathering samples, we also took a look at some statistics from Open Threat\nExchange (OTX). The top 3 offenders that we saw in that data were:\n\n1. OSX/Flashback User-Agent (49.5%)\n2. OSX ADWARE/Mackeeper (26.6%)\n3. OSX/WireLurker (23.7%)\n\nThis represents slightly over 20k events and includes only data prior to us enhancing our\ndetection capabilities, so it doesn't include hits for OceanLotus, LaoShu, CoinThief, or KitM.\n\n[The following pulses from Open Threat Exchange (OTX) are related to the samples we](https://www.alienvault.com/open-threat-exchange)\nexamined:\n\nLaoShu: [https://otx.alienvault.com/pulse/568da8bc4637f2624bcdc2d1/](https://otx.alienvault.com/pulse/568da8bc4637f2624bcdc2d1/)\n\nKitM: [https://otx.alienvault.com/pulse/568da7e467db8c057c6fc696/](https://otx.alienvault.com/pulse/568da7e467db8c057c6fc696/)\n\nCoinThief: [https://otx.alienvault.com/pulse/568da51b67db8c057c6fc689/](https://otx.alienvault.com/pulse/568da51b67db8c057c6fc689/)\n\n[WireLurker: https://otx.alienvault.com/pulse/55d4c6dc67db8c37b0a358ea/](https://otx.alienvault.com/pulse/55d4c6dc67db8c37b0a358ea/)\n\nMask/Careto: [https://otx.alienvault.com/pulse/5531bbbfb45ff53dc229c806/](https://otx.alienvault.com/pulse/5531bbbfb45ff53dc229c806/)\n\n## Observations\n\n\n-----\n\nWe found this exercise to be quite useful as it allowed us to get better acquainted with the\nbehavior of the above malware and we were indeed able to improve our detection\ncapabilities. Part of the process was to obtain fully functional OSX malware samples, but we\nfound that can sometimes be difficult since many samples on VirusTotal are stand-alone\nexecutables rather than full '.app' bundles. Hopefully, we have made it a little easier for you\nto perform your own analysis by including links to fully executable samples.\n\nAlthough this was an interesting exercise, we noted that most of the C&C servers have been\ntaken offline, so the risk associated with these samples is not high. However, any signs of\nactivity from these samples could be an indication of a deeper compromise so they should\nnot be summarily dismissed.\n\n## Looking Ahead\n\nApple is making strong inroads in the corporate space. Apple's rising market share is making\nit lucrative for malware authors to write more OSX malware. In the Silicon Valley (where we\nare headquartered), many startups offer Macbooks as the default laptop when onboarding\nnew hires. Therefore, it should come as no surprise that as the adoption of OSX increases,\nso will the prevalence of OSX-based malware. Furthermore, 2015 has been a tremendous\n[year for OSX-based vulnerability disclosure [3]. As the number of known vulnerabilities](http://www.cvedetails.com/product/156/Apple-Mac-Os-X.html?vendor_id=49)\nincrease, we expect more malware will take advantage of those flaws.\n\n## References:\n\n### Share this with others\n\nTags: [malware,](https://www.alienvault.com/blogs/tag/malware) [osx](https://www.alienvault.com/blogs/tag/osx)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2016/2016-03-21 - OS X Malware Samples Analyzed.pdf"
    ],
    "report_names": [
        "2016-03-21 - OS X Malware Samples Analyzed.pdf"
    ],
    "threat_actors": [
        {
            "id": "67bf0462-41a3-4da5-b876-187e9ef7c375",
            "created_at": "2022-10-25T16:07:23.44832Z",
            "updated_at": "2025-03-27T02:02:09.806007Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "Careto",
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "ETDA:Careto",
            "tools": [
                "Careto"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "cfdd35af-bd12-4c03-8737-08fca638346d",
            "created_at": "2022-10-25T16:07:24.165595Z",
            "updated_at": "2025-03-27T02:02:10.128957Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "Cosmic Wolf",
                "Marbled Dust",
                "Silicon",
                "Teal Kurma",
                "UNC1326"
            ],
            "source_name": "ETDA:Sea Turtle",
            "tools": [
                "Drupalgeddon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "faa4a29b-254a-45bd-b412-9a1cbddbd5e3",
            "created_at": "2022-10-25T16:07:23.80111Z",
            "updated_at": "2025-03-27T02:02:09.985067Z",
            "deleted_at": null,
            "main_name": "LookBack",
            "aliases": [
                "FlowingFrog",
                "LookBack",
                "LookingFrog",
                "TA410",
                "Witchetty"
            ],
            "source_name": "ETDA:LookBack",
            "tools": [
                "FlowCloud",
                "GUP Proxy Tool",
                "SodomMain",
                "SodomMain RAT",
                "SodomNormal"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f5bf6853-3f6e-452c-a7b7-8f81c9a27476",
            "created_at": "2023-01-06T13:46:38.677391Z",
            "updated_at": "2025-03-27T02:00:02.889755Z",
            "deleted_at": null,
            "main_name": "Careto",
            "aliases": [
                "The Mask",
                "Ugly Face"
            ],
            "source_name": "MISPGALAXY:Careto",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "870f6f62-84f5-48ca-a18e-cf2902cd6924",
            "created_at": "2022-10-25T15:50:23.303818Z",
            "updated_at": "2025-03-27T02:00:55.435309Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "APT32",
                "SeaLotus",
                "OceanLotus",
                "APT-C-00",
                "Canvas Cyclone"
            ],
            "source_name": "MITRE:APT32",
            "tools": [
                "Mimikatz",
                "ipconfig",
                "Kerrdown",
                "Cobalt Strike",
                "SOUNDBITE",
                "OSX_OCEANLOTUS.D",
                "KOMPROGO",
                "netsh",
                "RotaJakiro",
                "PHOREAL",
                "Arp",
                "Denis",
                "Goopy"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "af509bbb-8d18-4903-a9bd-9e94099c6b30",
            "created_at": "2023-01-06T13:46:38.585525Z",
            "updated_at": "2025-03-27T02:00:02.866727Z",
            "deleted_at": null,
            "main_name": "APT32",
            "aliases": [
                "TIN WOODLAWN",
                "OceanLotus Group",
                "OceanLotus",
                "Sea Lotus",
                "G0050",
                "Cobalt Kitty",
                "SeaLotus",
                "ATK17",
                "Ocean Lotus",
                "Ocean Buffalo",
                "POND LOACH",
                "Canvas Cyclone",
                "APT-C-00",
                "APT-32",
                "APT 32"
            ],
            "source_name": "MISPGALAXY:APT32",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f1518ac1-4710-4dd1-a422-e3801e4806cb",
            "created_at": "2024-05-01T02:03:08.147856Z",
            "updated_at": "2025-03-27T02:05:17.421275Z",
            "deleted_at": null,
            "main_name": "TIN WOODLAWN",
            "aliases": [
                "Cobalt Kitty",
                "OceanLotus",
                "WOODLAWN ",
                "APT32 "
            ],
            "source_name": "Secureworks:TIN WOODLAWN",
            "tools": [
                " Denis",
                " Goopy",
                " JEShell",
                " KerrDown",
                " Mimikatz",
                " Ratsnif",
                " Remy",
                " Rizzo",
                " RolandRAT",
                "Cobalt Strike"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "33ae2a40-02cd-4dba-8461-d0a50e75578b",
            "created_at": "2023-01-06T13:46:38.947314Z",
            "updated_at": "2025-03-27T02:00:02.959421Z",
            "deleted_at": null,
            "main_name": "Sea Turtle",
            "aliases": [
                "SILICON",
                "Teal Kurma",
                "UNC1326",
                "COSMIC WOLF",
                "Marbled Dust"
            ],
            "source_name": "MISPGALAXY:Sea Turtle",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "2439ad53-39cc-4fff-8fdf-4028d65803c0",
            "created_at": "2022-10-25T16:07:23.353204Z",
            "updated_at": "2025-03-27T02:02:09.749502Z",
            "deleted_at": null,
            "main_name": "APT 32",
            "aliases": [
                "APT 32",
                "APT-C-00",
                "APT-LY-100",
                "ATK 17",
                "Lotus Bane",
                "Ocean Buffalo",
                "OceanLotus",
                "Operation Cobalt Kitty",
                "Operation PhantomLance",
                "Pond Loach",
                "SeaLotus",
                "SectorF01",
                "Tin Woodlawn"
            ],
            "source_name": "ETDA:APT 32",
            "tools": [
                "Agentemis",
                "Android.Backdoor.736.origin",
                "AtNow",
                "Backdoor.MacOS.OCEANLOTUS.F",
                "BadCake",
                "CACTUSTORCH",
                "CamCapture Plugin",
                "CinaRAT",
                "Cobalt Strike",
                "CobaltStrike",
                "Cuegoe",
                "DKMC",
                "Denis",
                "Goopy",
                "HiddenLotus",
                "KOMPROGO",
                "KerrDown",
                "METALJACK",
                "MSFvenom",
                "Mimikatz",
                "Nishang",
                "OSX_OCEANLOTUS.D",
                "OceanLotus",
                "PHOREAL",
                "PWNDROID1",
                "PhantomLance",
                "PowerSploit",
                "Quasar RAT",
                "QuasarRAT",
                "RatSnif",
                "Remy",
                "Remy RAT",
                "Rizzo",
                "Roland",
                "Roland RAT",
                "SOUNDBITE",
                "Salgorea",
                "Splinter RAT",
                "Terracotta VPN",
                "Yggdrasil",
                "cobeacon",
                "denesRAT",
                "fingerprintjs2"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535995,
    "ts_updated_at": 1743041788,
    "ts_creation_date": 1653714811,
    "ts_modification_date": 1653714811,
    "files": {
        "pdf": "https://archive.orkl.eu/fb5b7d0c9e7d404e653b723c08858a5ef1766150.pdf",
        "text": "https://archive.orkl.eu/fb5b7d0c9e7d404e653b723c08858a5ef1766150.txt",
        "img": "https://archive.orkl.eu/fb5b7d0c9e7d404e653b723c08858a5ef1766150.jpg"
    }
}