{
    "id": "6c317856-5558-497f-90e8-7799a92c7ed8",
    "created_at": "2023-01-12T15:07:36.792808Z",
    "updated_at": "2025-03-27T02:05:41.341649Z",
    "deleted_at": null,
    "sha1_hash": "7a03335277f940091b1d81b4c2b6f79cc5b00a27",
    "title": "2020-06-22 - njRat Malware Analysis",
    "authors": "",
    "file_creation_date": "2022-05-27T19:10:09Z",
    "file_modification_date": "2022-05-27T19:10:09Z",
    "file_size": 371114,
    "plain_text": "# njRAT Malware Analysis\n\n**malwr-analysis.com/2020/06/21/njrat-malware-analysis/**\n\nHASH MD5: 88e085572a182ca102676676ec0ef802\n\nFile Type: Win32 executable\n\nSignature: Microsoft Visual C# v7.0 / Basic .NET\n\n[Link to Download Sample: Any.Run](https://app.any.run/tasks/3001f041-bfa2-4abe-885e-7e6ec443f5e5/)\n\nType: Remote Access Trojan\n\nnjRAT is a remote access Trojan. It is one of the most widely accessible\n\nRATs. I came across this while going through\n\n[Any.Run trends and thought to download sample for analysis.](https://any.run/malware-trends/)\n\nI have disassembled executable file using dnSpy.\n\nIt makes easy to analyse the code. Stub shows entry point where I can\n\nput breakpoint to start the debugging to analyse the behavior\n\n.net version v2.0.50727\n\nI start debugging and put break point at entry point\n\n\nJune 20, 2020\n\nPE file information\n\n\n-----\n\nEntry\n\n\nPoint\n\nKo() function first check the list predefined process running on victim’s\n\nmachine if they are, the malware executable\n\nwill stop execution. In this case, wireshark was running in background.\n\nIt stops calling assembly and execution process.\n\nTo avoid call to CsAntiProcess which look for the running process, I change the value of\n**anti_CH bool variable value to**\n\n**false manually. (Value of variable can change from Locals windows)**\n\n**CsAntiProcess handler look for the process and if its there, it stops execution.**\n\n\n-----\n\nClass CsAntiProcess\n\nThe list of process mentioned\n\nSN Process List Process Name\n\n1 procexp Process Explorer (Sys Internal Tool)\n\n2 SbieCtrl SbieCtrl.exe (Sandboxie)\n\n3 SpyTheSpy Spyware monitoring tool\n\n4 wireshak WireShark\n\n\n-----\n\n5 apateDNS ApteDNS tool\n\n6 IPBlocker IPBlocker\n\n7 Tiger-Firewall –\n\n8 smsniff –\n\n9 exeinfoPE Exeinfo PE Tool\n\n10 NetSnifferCS –\n\n11 SandBoxie Control –\n\n12 processhacker Process Hacker\n\n13 dnSpy .Net disassembler (I am using it for debugging here)\n\n14 CodeReflector –\n\n15 ILSpy .Net disassembler\n\n16 VGAuthService VMware Guest Authentication Service\n\n17 VBoxService Virtual Box Service\n\nThis table contains List of Process malware checks on the system on execution\n\nNOTE: To bypass process check, I also changed the names of process e.g.\nWireshark.exe to wk.exe and procexp.exe to prex.exe which helped to by pass process\ncheck when I executed malware without debugging in dnSpy because process names\nare hard coded.\n```\nOn proceed with the debugging, it drops an executable file svchost.exe on the system\nat location\n\n```\n**C:\\Users\\<user profile>\\AppData\\Roaming\\svchost.exe**\n\ncode that drops executable file.\n\nEXE is a string variable initialized as svchost.exe. It could be named svchost.exe (Windows\nService Host) to create\n\nconfusion and it make difficult to differentiate its malicious without analyzing its location and\nproperties.\n\n\n-----\n\nCaptured in process monitor, file is written at location\n\nIt also drops Tools.exe at location C:\\\n\nFile also drop at location\n\n\nFile dropped at location C:\\\n\n\nC:\\USers\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\e84128b2e0547d1dd1f8090d86c80c48\n\nand add to registry\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\n\nName: e84128b2e0547d1dd1f8090d86c80c48\n\nValue data: “C:\\Users\\IEUser\\AppData\\Roaming\\svchost.exe” ..\n\nAdding this registry value, the executable will execute everytime when user logon to the\nsystem.\n\n\n-----\n\nDropping file in this case is copying itself to the three different location. As all three files\nhave different names but same hash and code.\n\nIn code, IP address along with the port 7777 and executable names are initialized.\n\n**C2 Server** **IP Address details:**\n\nVT Score: 1/79\nStatus: Malicious\n\n\n-----\n\n[VirusTotal Score for C2 server IP address – Link](https://www.virustotal.com/gui/url/a161437d3e790f00a2e7d820348ca99a1e2e165578539de39ff2ed7794ab399f/detection)\n\nsvchost.exe has sent TCP segment with SYN control bits to C2 server but there is no\nresponse from the server. Though\n\nthe IP address exists and IP location is Russia.\n\nI used netstat to check the tcp connection.\n\nNetstat command >> netstat -a\n\n1) Command >> netstat -a -b 2) Process\n\nname svchost.exe sent TCP segment\n\n**Summary:**\n\nOn execution, malicious executable file check running process on the system.\nIf any of the process running (listed in table above), malware stops execution.\nIt copies itself to three different locations:\n\nC:\\Tools.exe\nC:\\Users\\<user profile>\\AppData\\Roaming\\svchost.exe\nC:\\USers\\AppData\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\Startup\\e84128b2e0547d1dd1f8090d86c80c48.exe\nCreates registry entry so e84128b2e0547d1dd1f8090d86c80c48.exe will execute every\ntime user logon to the system.\nCommand and Control server IP address is 85.26. 235.163 port 7777\nsvchost.exe tried to connect to C2 server, server didn’t respond.\nAccessing C2 server IP address on port 7777 in browser, gets 200 OK response with\nempty response header.\n\nThank you.\n\nComments and suggestions are welcome.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-06-22 - njRat Malware Analysis.pdf"
    ],
    "report_names": [
        "2020-06-22 - njRat Malware Analysis.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536056,
    "ts_updated_at": 1743041141,
    "ts_creation_date": 1653678609,
    "ts_modification_date": 1653678609,
    "files": {
        "pdf": "https://archive.orkl.eu/7a03335277f940091b1d81b4c2b6f79cc5b00a27.pdf",
        "text": "https://archive.orkl.eu/7a03335277f940091b1d81b4c2b6f79cc5b00a27.txt",
        "img": "https://archive.orkl.eu/7a03335277f940091b1d81b4c2b6f79cc5b00a27.jpg"
    }
}