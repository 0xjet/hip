{
    "id": "3c808f52-0c09-468c-baed-b5f72f7dc74f",
    "created_at": "2023-01-12T15:08:08.900341Z",
    "updated_at": "2025-03-27T02:15:13.897734Z",
    "deleted_at": null,
    "sha1_hash": "512a3198c7b34d9644a2fb9170f58257c90217ad",
    "title": "2019-02-27 - New Global Cyber Attack on Point of Sale Sytem",
    "authors": "",
    "file_creation_date": "2022-05-28T01:57:40Z",
    "file_modification_date": "2022-05-28T01:57:40Z",
    "file_size": 2265697,
    "plain_text": "# New Global Cyber Attack on Point of Sale Systems\n\n**[blog.morphisec.com/new-global-attack-on-point-of-sale-systems](http://blog.morphisec.com/new-global-attack-on-point-of-sale-systems)**\n\nPosted by [Morphisec Labs on February 27, 2019](https://blog.morphisec.com/author/morphisec-labs)\n\n[Tweet](https://twitter.com/share)\n\n.\n\n\n-----\n\nOver the past 8-10 weeks, Morphisec has been tracking multiple sophisticated attacks\ntargeting Point of Sale thin clients globally. More specifically, on the 6 of February weth\nidentified an extremely high number of prevention events stopping Cobalt Strike backdoor\nexecution, with some of the attacks expressly targeting Point of Sale VMWare Horizon thin\nclients.\n\nBased on the initial indicators, we identified FrameworkPOS scraping malware installed on\nsome of the thin clients, after initializing PowerShell/WMI stages that downloaded and\nreflectively loaded Cobalt-Strike beacon with PowerShell extension directly into the memory.\n\nWe found many indicators linking specifically to the FIN6 group (WMI/PowerShell,\nFrameworkPOS, lateral movement and privilege escalation), with the difference of moving\nfrom Metasploit to Cobalt-Strike). Some indicators are also tied to the EmpireMonkey group.\nAt this point, we don’t have enough data for proper attribution.\n\nIf successful, the Cobalt Strike beacon payload gives attackers full control over the infected\nsystem and the ability to move laterally to other systems, harvest user credentials, execute\ncode and more, all while evading advanced EDR scanning techniques.\n\nDigging deeper into the notification and the telemetry, we identified victims across the United\nStates, Japan and India from the finance, insurance and healthcare (diagnostic image\nprocessing) sectors, as well as additional targets globally.\n\nFollowing additional retro-hunting on Virus Total, we identified multiple servers that were, and\nstill are, delivering the Cobalt Strike beacon using the same delivery pattern and same C2\ncommunication pattern. We have notified the customers and the legal authorities about the\ncurrently active C2 servers.\n\nMorphisec Labs is currently still analyzing the infiltration methods (unknown); due to this we\nwill present only partial technical information in this report. However, we believe it important\nto publish even a partial analysis so that enterprises are aware of, and immediately block,\nany access to the URLs listed below.\n\n## Technical information:\n\n### Infiltration\n\nAs stated in the introduction, the infiltration vector is yet to be determined, although after\nretro-hunting on VT and matching it to our known telemetry events, we believe that at least\none vector is executed through HTA files that execute PowerShell scripts as part of an\nembedded VBScript.\n\n\n-----\n\n### Script stager\n\nAdditional hunting reveals additional scripts that lead to the same Cobalt Strike beacon. It is\nnot known if the scripts below are part of a lateral movement or just additional examples of\ninfiltration samples. However, at least some of them are executed through WMI which may\nindicate an intermediate stage.\n\n**POWERSHELL**\n\n**JAVASCRIPT**\n\n**BAT**\n\n\n-----\n\n### PowerShell Stager\n\nAll the various scripts are decoded to the following PowerShell pattern:\n\nThe script above decompresses an additional level of PowerShell stager (regular Gzip):\n\n\n-----\n\nClearly, the marked base64 encoded script represents the next stage shellcode that is either\nremotely injected into the existing 32 bit or into a newly created 32 bit PowerShell process (if\nthe current PowerShell is 64bit). Some samples differentiate in the way the VirtualAlloc and\nCreateThread are declared.\n\n### Shellcode Stager\n\nThe injected shellcode is a regular Metasploit downloader shellcode that traverses the PEB,\nresolves the function names by the standard ROR 13 hash, and downloads the next stage\nshellcode directly into memory from the C2. The pattern of the C2 download request\ndestination is generally URL:PORT/[a-zA-Z0-9]{4}.\n\nIt executes InternetConnectA, InternetOpenA, HttpOpenRequestA, HttpSendRequestA for\nthe purpose of downloading the next stage.\n\n\n-----\n\n### Cobalt Strike Beacon\n\nMorphisec observed 2 types of beacons during this campaign, the first one is a regular direct\nreflective loaded Cobalt Strike DLL beacon, usually XOR encoded.\n\nThe second type is a shellcode backdoor beacon with PowerShell and Mimikatz functionality.\n\n\n-----\n\n### Persistency and FrameworkPOS\n\nIn some cases, after executing the backdoors, the attackers install “WindowsHelpAssistant”\ntask in the task scheduler. In turn, this, on login, uses rundll32.exe with System privileges to\nexecute and export function “workerInstance” from a downloaded binary DLL\n_“Assistant32.dll”. We also observed similar command execution as part of the HKLM Run_\nkey.\n\nThe “Assistant32.dll” is the FrameworkPOS scraper that shares similar TTPs to a previously\nseen FrameworkPOS used by FIN6.\n\nThe malware XOR’s (xor 0xAA) the credit card information before exfiltration through DNS\ntunneling.\n\n## Conclusions\n\nThese types of advanced attacks that utilize memory to evade detection solutions either by\nreflectively loading libraries, hollowing process memory or injecting code into new processes,\nare harder and harder to attribute due to the simple fact that more and more criminals are\ntaking advantage of the strength of these evasion techniques and the weakness of runtime\ndetection technologies to cope with such evasion. The attackers have the advantage of\nchoosing where to execute their malicious code and when to execute it, while runtime\ndetection solutions cannot constantly scan the memory to detect the attack precisely when it\nmanifests without significantly impacting the performance of the process runtime.\n\nIt is important to note that Morphisec prevents these types of attacks immediately, without\nany prior knowledge of the attack form or techniques. The forensic information used in this\nanalysis was captured after the attack was already prevented.\n\n\n-----\n\n## Artifacts\n\n### Domains C2s\n\n**STILL ACTIVE:**\n\nhxxp://217.12.218[.]95:22222/c7Pr\n\nhxxp://89.105.194[.]236:443/Xaq2\n\nhxxp://46.166.173[.]109:443/Qq9a\n\nhxxp://bbing.co[.]za:443/tXY7\n\nhxxp://47.75.151[.]154:443/ZyBG\n\nhxxp://185.80.233[.]166:443/qPe6\n\n**INACTIVE:**\n\nhxxp://5.39.219[.]15:8081/JVZb\n\nhxxp://45.247.22[.]27:4444/EzFB\n\nhxxp://standardcertifications[.]com:8080/cArF\n\nhxxp://34.245.88[.]113:9090/tNDV\n\nhxxp://2.72.0[.]200/9RyX\n\nhxxp://185.202.174[.]91:443\n\nhxxp://192.81.223[.]204/rr3E\n\nhxxp://172.16.196[.]200/JSlT\n\nhxxp://37.139.21[.]20/Orb9\n\nhxxp://185.135.157[.]138:8080/9Par\n\nhxxp://188.166.105[.]24/o9ZZ\n\nhxxp://185.202.174[.]84:443/c9Fz\n\nhxxp://35.182.31[.]181:443/jquery-3.3.1.slim.min.js\n\nhxxp://209.126.106[.]228:443 (only 32 bit)\n\nhxxp://172.17.3[.]2/G9fv\n\nhxxp://104.237.131[.]29:443\n\nhxxp://93.115.26[.]171:443\n\n\n-----\n\nhxxp://188.166.105[.]24/cYj7\n\n### SCRIPT DOWNLOADERS:\n\n0328fcc8229397c7bb4d0ccc958b09caa9a116b549cf59ae95b2d030ef70d54c\n\n063060e5031ad4de170ea979e0a8e36c053904f5f4a33f147f9351328c465594\n\n0ac9795a9eb6b374250523f29f55d07bea2c4c7077ab59c1fb38b38eca1f6f2a\n\n0d8cd722c9cb741c68672612d9668aac59b3b116d11943fb4e010940272fe72f\n\n143ca82d8ce9330d45078dcfcf3a75c8bff2d9f4a796729409dcd9d4a2914a5f\n\n1d53bf1f98cab29509c9211e6dcf6d830ba602dd8886d1d9339c426a1ab4dbcf\n\n1e3a4e51b9fe9d2fb94e040d3fcdb6a7874b035233ffc7ef779bd8ba01857097\n\n20c4a40286b5fed63a322bdfc5b3fefdffb248423f2c1d3c586b4e207b7d8d06\n\n21d9044a4314474b0ee50760902e4887a504708b588a3bf33f57417edba9ac9d\n\n255eb59d84d7856bc857320e7e970e90808e7c9f2149cc29be6049ae164f965e\n\n27c5d43786c826ee5072355c5e5aa16714873e389473e7569cdbf8c14a71aefc\n\n31f55ed1989364263d9f150236baf73d73d5ab04c33b833038c983516d56718c\n\n3df945c192636020101feba5fd2587f9bedd509ae093832e7c0bcad58e3082b1\n\n4528b63bfe4ac3f5d757fdb4086f119bfd23972014ef751c10f8dae77e69ca8c\n\n457248cf03d33c33484957c5e3449ff4530ba3f9387c09f835648e57498e9735\n\n47fbbeee59236164e3a99d34c406ee36f1c6243d2e66f0019512d795de3fae1e\n\n5151e0220dc73099dc340e5158fa1a046ca26dfd55c7c8d226a9e3e69872389b\n\n5573a9e82526decf8bba7c594d919cadbb0473c33e926296772ad89c894a9ce6\n\n57c49f5724ecfcce148577456c9b9166664709515bfa266c18b0729f6dadae31\n\n588a4ca6c560b7e3d8ed4cdfcd0c57846439d34fabf32635cda12fe17d2e9d8c\n\n6176941029763c6d91d408f3d63f1006de97eba45cb891b6a55f538d299b8a8c\n\n6a1be30c9854bf7f97ebd6fb2ef85e527279dbebd8f700980718febbf53f4d6a\n\n6f4a257ffaa31402c4062b0c3f98bbdd0d083221ea071a6a6439b56753f9c3f6\n\n\n-----\n\n88987cb359a26ca6676a7904fef1e360fa37e5bc6c8be7f131b504047ce7dfd7\n\n8ad326cbbfb3486d584f5589353e23e83a8152e2eb75faa5851a09272a80c5d7\n\n900c232af659de5a5c816c756d48459a7cb78ad45f95aa8b869f694eb37551ee\n\n999a8125534fc18e25ced0e24228909b33ac2b88960716cd5b9dfbe6db2ddca7\n\na01f4bf64ef45ffaa2eee0e7eb9a8e10639cdf1551c9809fdfa5bf8262887912\n\na3fe01b478068e0215dbf16bcc70234afead415c89f791261158bed8ea42c48a\n\na608307886cada313944636d60ca7c8f6b2ecd1d5071f51f99634d84a1412ad1\n\nb44e573e2203d1e54e3c0cf8aafff15d9c9659be713710017698fe54589c1d5d\n\nb630986f6f261587d6ca4e36a81268c16840a1a0df1e960a023e10f866b1e6e5\n\nbef5d3646353b43290a6e8f905f69e3c41e5a4f5c784d76a59b44592d79d0422\n\nc018dc64321541f5a815a3688187f26436482c47702b67a6db9d0cba98506b68\n\nc1d1d2db4ec357ce93bc220412a791444bcf6e4a69307a45532457531a60cfde\n\nc6f61bfbd11a723f24122ca618b66a77ec342e26d9423a2751fe7218306b7bc0\n\nd6c41db2531b1aa5ac0a0473e6c3e5b55df47d6ef09756c3fc418583c9b418c1\n\ndeff2bb5bec2f6c7da3b5499764d695d8ad571ce1c3f0a3078bdf89aeaa9ad08\n\ne24bf8cdb99d9404ed4272f980294957b842ee308eb2cd88ab053faf67ba90bf\n\ne468a98a2bec5408437d39aeb8e6c68b83b1c26c33ba3ffa8673104bc9e4c1f7\n\ne777b733918ce04adfe6fe7961885fa9e5408fd2bb0dc97eeee4b5fee08cd77f\n\nf2cbf58594bb9cf670c16cd297e5b0d91568da5a50f92ea3c68ca046e5b25f61\n\nf3a7af069a9ca248961038a0b30f7685ace1080d59449071477798e2164c1ffd\n\nf82f563970927bb4ca5d0c7df4db610b3076a2221761c262974ae7d92be73043\n\nfb312d11d54480b6a4721fda5ede5b97165b0985e1408d206baed2d91838d5d4\n\n876e33b143741d9403f7848aac7f47e04e48d92b083e646fe49628585e4e6b0d\n\n[Contact SalesInquire via Azure](http://10.10.0.46/mailto:sales@morphisec.com)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2019/2019-02-27 - New Global Cyber Attack on Point of Sale Sytem.pdf"
    ],
    "report_names": [
        "2019-02-27 - New Global Cyber Attack on Point of Sale Sytem.pdf"
    ],
    "threat_actors": [
        {
            "id": "56daf304-dd2c-4fa1-a01f-8c0a7e5e5c30",
            "created_at": "2022-10-25T16:07:23.586985Z",
            "updated_at": "2025-03-27T02:02:09.876755Z",
            "deleted_at": null,
            "main_name": "EmpireMonkey",
            "aliases": [
                "Anthropoid Spider",
                "CobaltGoblin",
                "EmpireMonkey"
            ],
            "source_name": "ETDA:EmpireMonkey",
            "tools": [
                "AKO Doxware",
                "AKO Ransomware",
                "MedusaLocker",
                "MedusaReborn"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ee3363a4-e807-4f95-97d8-b603c31b9de1",
            "created_at": "2023-01-06T13:46:38.485884Z",
            "updated_at": "2025-03-27T02:00:02.845851Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "Camouflage Tempest",
                "MageCart Group 6",
                "G0037",
                "TA4557",
                "SKELETON SPIDER",
                "ITG08",
                "White Giant",
                "GOLD FRANKLIN",
                "ATK88"
            ],
            "source_name": "MISPGALAXY:FIN6",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "12517c87-040a-4627-a3df-86ca95e5c13f",
            "created_at": "2022-10-25T16:07:23.61665Z",
            "updated_at": "2025-03-27T02:02:09.889471Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "ATK 88",
                "Camouflage Tempest",
                "FIN6",
                "Gold Franklin",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "TAG-CR2",
                "White Giant"
            ],
            "source_name": "ETDA:FIN6",
            "tools": [
                "AbaddonPOS",
                "Agentemis",
                "AmmyyRAT",
                "Anchor_DNS",
                "BlackPOS",
                "CmdSQL",
                "Cobalt Strike",
                "CobaltStrike",
                "FlawedAmmyy",
                "FrameworkPOS",
                "Grateful POS",
                "JSPSPY",
                "Kaptoxa",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LockerGoga",
                "MMon",
                "Magecart",
                "Meterpreter",
                "Mimikatz",
                "More_eggs",
                "NeverQuest",
                "POSWDS",
                "Reedum",
                "Ryuk",
                "SCRAPMINT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Terra Loader",
                "TerraStealer",
                "Vawtrak",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "cobeacon",
                "grabnew"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "b3acfb48-b04d-4d3d-88a8-836d7376fa2e",
            "created_at": "2024-06-19T02:03:08.052814Z",
            "updated_at": "2025-03-27T02:05:17.368029Z",
            "deleted_at": null,
            "main_name": "GOLD FRANKLIN",
            "aliases": [
                "ITG08 ",
                "MageCart Group 6 ",
                "Skeleton Spider ",
                "White Giant ",
                "FIN6 "
            ],
            "source_name": "Secureworks:GOLD FRANKLIN",
            "tools": [
                " Metasploit",
                " Meterpreter",
                " Mimikatz",
                " PowerSploit",
                " PowerUpSQL",
                " RemCom",
                "FrameWorkPOS"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "186f3cc2-500c-4233-b688-8b6d6e08e2a3",
            "created_at": "2023-01-06T13:46:39.098169Z",
            "updated_at": "2025-03-27T02:00:02.996021Z",
            "deleted_at": null,
            "main_name": "ANTHROPOID SPIDER",
            "aliases": [
                "Empire Monkey",
                "CobaltGoblin"
            ],
            "source_name": "MISPGALAXY:ANTHROPOID SPIDER",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ea7bfe06-7c23-481d-b8ba-eafa6cda3bc9",
            "created_at": "2022-10-25T15:50:23.317961Z",
            "updated_at": "2025-03-27T02:00:55.440858Z",
            "deleted_at": null,
            "main_name": "FIN6",
            "aliases": [
                "FIN6",
                "Magecart Group 6",
                "ITG08",
                "Skeleton Spider",
                "TAAL",
                "Camouflage Tempest"
            ],
            "source_name": "MITRE:FIN6",
            "tools": [
                "FlawedAmmyy",
                "GrimAgent",
                "FrameworkPOS",
                "More_eggs",
                "Cobalt Strike",
                "Windows Credential Editor",
                "AdFind",
                "PsExec",
                "LockerGoga",
                "Ryuk",
                "Mimikatz"
            ],
            "source_id": "MITRE",
            "reports": null
        }
    ],
    "ts_created_at": 1673536088,
    "ts_updated_at": 1743041713,
    "ts_creation_date": 1653703060,
    "ts_modification_date": 1653703060,
    "files": {
        "pdf": "https://archive.orkl.eu/512a3198c7b34d9644a2fb9170f58257c90217ad.pdf",
        "text": "https://archive.orkl.eu/512a3198c7b34d9644a2fb9170f58257c90217ad.txt",
        "img": "https://archive.orkl.eu/512a3198c7b34d9644a2fb9170f58257c90217ad.jpg"
    }
}