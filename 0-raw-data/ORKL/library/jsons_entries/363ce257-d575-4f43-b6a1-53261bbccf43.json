{
    "id": "363ce257-d575-4f43-b6a1-53261bbccf43",
    "created_at": "2023-01-12T15:09:41.484275Z",
    "updated_at": "2025-03-27T02:17:01.055832Z",
    "deleted_at": null,
    "sha1_hash": "8d0003cbc75d95b25fafd6fcca17e6e5bfe6d9e8",
    "title": "2021-11-15 - Groups Target Alibaba ECS Instances for Cryptojacking",
    "authors": "",
    "file_creation_date": "2022-05-28T00:42:25Z",
    "file_modification_date": "2022-05-28T00:42:25Z",
    "file_size": 1365843,
    "plain_text": "# Groups Target Alibaba ECS Instances for Cryptojacking\n\n**[trendmicro.com/en_in/research/21/k/groups-target-alibaba-ecs-instances-for-cryptojacking.html](https://www.trendmicro.com/en_in/research/21/k/groups-target-alibaba-ecs-instances-for-cryptojacking.html)**\n\nNovember 15, 2021\n\nIt’s been known that threat actors are actively exploiting misconfigured Linux-powered\n[servers, regardless of whether they run on-premises or in the cloud. The compromised](https://www.trendmicro.com/vinfo//tmr/?/us/security/news/cybercrime-and-digital-threats/a-look-at-linux-threats-risks-and-recommendations)\n[devices are mostly used for cryptojacking purposes with the dominance of mining for the](https://www.trendmicro.com/en_us/research/20/i/war-of-linux-cryptocurrency-miners-a-battle-for-resources.html)\n[digital currency Monero. One notorious example is TeamTNT, one of the first hacking groups](https://www.trendmicro.com/vinfo//tmr/?/us/security/news/cybercrime-and-digital-threats/teamtnt-activities-probed)\nshifting its focus to cloud-oriented services.\n\n[The cryptojacking battlefield is shared by multiple threat actors such as Kinsing and](https://www.trendmicro.com/en_ph/research/20/k/analysis-of-kinsing-malwares-use-of-rootkit.html)\nTeamTNT, amongst others. Two common characteristics that they share in their code is to\nremove competing actors who are also mining for cryptocurrency and disable security\n[features found in the victim machine. This provides them an advantage over the hijacked](https://www.trendmicro.com/en_us/research/20/i/war-of-linux-cryptocurrency-miners-a-battle-for-resources.html)\nresources, such as the [example of an advanced system sanitation that we identified](https://www.trendmicro.com/en_us/research/21/j/actors-target-huawei-cloud-using-upgraded-linux-malware-.html#.YWB25boLh44.twitter)\ntargeting Huawei Cloud.\n\nIn this article, we focus on one common functionality that we found amongst multiple\npayloads: the disabling of features inside the Alibaba cloud service provider (CSP). We also\nlook at possible reasons that multiple threat actors and malware routines focused on Alibaba\nCloud (also known as Aliyun) and the implications of these illicit mining activities on Alibaba\nCloud users.\n\nWe have reached out to the Alibaba Cloud Team through their listed contact information prior\nto the publication of this blog, and we are waiting for their response with regard to this\nconcern.\n\nLooking into Alibaba ECS\n\nAlibaba Elastic Computing Service (ECS) instances come with a preinstalled security agent.\nAs a result, the threat actors try to uninstall it upon compromise. This is no surprise as we\nhave seen similar payloads in the past. However, this time we found a specific code in the\nmalware creating firewall rules to drop incoming packets from IP ranges belonging to internal\nAlibaba zones and regions.\n\n\n-----\n\nFigure 1. One sample of an Alibaba EC instance with the specific malicious code creating\nfirewall rules\n\nFigure 2. Disabling the Alibaba security agent\nIn addition, the default Alibaba ECS instance provides root access. While other CSPs\nprovide different options ranging from the least privileged ones — such as not allowing\nSecure Shell (SSH) authentication over user and password and only allowing asymmetric\ncryptography authentication — other CSPs do not allow the user to log in via SSH directly by\ndefault, so a less privileged user is required.\n\nFor instance, if the login secrets are leaked, having low-privilege access would require\nattackers enhanced effort to escalate the privileges. With Alibaba, however, all users have\nthe option to give a password straight to the root user inside the virtual machine (VM).\n\nFigure 3. Root permissions on a default ECS instance\n\n\n-----\n\nSecurity-wise, this is in contradiction with the principle of least privilege, and it should be\nemphasised that this is the responsibility of the user for a secure configuration. We highly\n**recommend creating a less privileged user for running applications and services within the**\nECS instance.\n\nIn this situation, the threat actor has the highest possible privilege upon compromise,\nincluding vulnerability exploitation, any misconfiguration issue, weak credentials or data\nleakage. Thus, advanced payloads such as kernel module rootkits and achieving persistence\nvia running system services can be deployed. Given this feature, it comes as no surprise that\nmultiple threat actors target Alibaba Cloud ECS simply by inserting a code snippet for\nremoving software found only in Alibaba ECS.\n\nFigure 4. A diamorphine deployment as an example of high-privilege abuse\nCryptojacking Aliyun\n\nWhen a cryptojacking malware is running inside Alibaba ECS, the security agent installed will\nsend a notification of a malicious script running. It then becomes the responsibility of the user\nto stop the ongoing infection and malicious activities. Alibaba Cloud Security provides a\nguide on how to do this. More importantly, it is always the responsibility of the user to prevent\nthis infection from happening in the first place.\n\n\n-----\n\nFigure 5. An example of cryptojacking malware\nDespite detection, the security agent fails to clean the running compromise and gets\ndisabled. Looking at another malware sample shows that the security agent was also\nuninstalled before it could trigger an alert for compromise. The samples then proceeded to\ninstall an XMRig. Examining the samples further shows that the cryptominer can easily be\nreplaced with another malware to execute in the environment.\n\n[It is also important to note that Alibaba ECS has an auto scaling feature, wherein users and](https://www.alibabacloud.com/help/product/25855.htm)\norganisations can enable the service to automatically adjust computing resources based on\nthe volume of user requests. When the demand increases, auto scaling allows the ECS\ninstances to serve the said requests according to the enumerated policies. While the feature\nis given to subscribers at no extra cost, the increase in resource usage prompts the\nadditional charges. By the time the billing arrives to the unwitting organisation or user, the\ncryptominer has likely already incurred additional costs. Additionally, the legitimate\nsubscribers have to manually remove the infection to clean the infrastructure of the\ncompromise.\n\n\n-----\n\nFigure 6. An example of a security agent uninstallation routine used by the malware\nThe samples our team acquired can be tied to campaigns targeting Alibaba, and we found\nthese samples sharing common traits, functions, and functionalities with other campaigns\n[that also target CSPs in Asia such as Huawei Cloud. There have also been other reports of](https://threatpost.com/cryptomining-malware-uninstalls-cloud-security-products/140959/)\nthese compromise detections.\n\nFigure 7. Comparing samples of compromised Alibaba Cloud (left) and Huawei Cloud (right).\nThe samples from both campaigns share common traits, especially when it comes to\nremoving “adversaries” and setting up the environment for next-phase infections, such as\nmaking sure to use a public DNS. Although the style in coding is different, the purpose of the\nfunctions is similar on both attacks.\n\nMitigating the impact of threats on Alibaba ECS workloads\n\n\n-----\n\nA performance penalty is one consequence of leaving a cryptojacking campaign running\nwithin the Alibaba cloud infrastructure, as the cryptomining process consumes a lot of\nresources. Moreover, in situations where users set their instances with the auto scaling\nfeature, they can end up with unexpected costs to their subscriptions.\n\nSeeing how easily the compromise can be scaled, attackers can also easily replace the\nmalicious cryptominer with another piece of malware that can potentially drive them more\nprofit or spread to other workloads and endpoints. Subsequent attacks can be done on the\nprojects or infrastructure as a result of how easy it is to infiltrate the environment with high\nuser privileges. We continue to study the malicious activities that can be deployed in the\ninfrastructure. We also list here some best practices for organisations to follow:\n\n[Practice a shared responsibility model. Both CSPs and users have a responsibility to](https://partners-intl.aliyun.com/vodafone/trust-center)\nensure that security configurations of workloads, projects, and environments are safe.\nRead through the guides, customise, and enable the security layers of workloads and\nprojects accordingly. Enable policies that can best help secure the cloud environment\nand ensure that it has more than one layer of malware-scanning and vulnerabilitydetection tools.\n**Customize the security features of cloud projects and workloads. Despite the**\noffered feature of your CSP, avoid running applications under root privilege and using\npasswords for SSH. Use public key cryptography for access.\n**Follow the principle of least privilege. Limit the number of users with the highest**\naccess privileges according to their respective levels of involvement in a project or an\napplication.\n\nIndicators of Compromise (IOCs)\n\n[You can find the full list of IOCs and Trend Micro detections here.](https://www.trendmicro.com/content/dam/trendmicro/global/en/research/21/k/groups-target-alibaba-ecs-instances-for-cryptojacking/IOCs-groups-target-alibaba-ecs-instances-cryptojacking.txt)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-11-15 - Groups Target Alibaba ECS Instances for Cryptojacking.pdf"
    ],
    "report_names": [
        "2021-11-15 - Groups Target Alibaba ECS Instances for Cryptojacking.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "f809bfcb-b200-4988-80a8-be78ef6a52ef",
            "created_at": "2023-01-06T13:46:39.186988Z",
            "updated_at": "2025-03-27T02:00:03.016358Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "Adept Libra"
            ],
            "source_name": "MISPGALAXY:TeamTNT",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "c3ca592f-0669-49bd-ab5c-310007ab2fb4",
            "created_at": "2022-10-25T15:50:23.334495Z",
            "updated_at": "2025-03-27T02:00:55.445098Z",
            "deleted_at": null,
            "main_name": "TeamTNT",
            "aliases": [
                "TeamTNT"
            ],
            "source_name": "MITRE:TeamTNT",
            "tools": [
                "Peirates",
                "MimiPenguin",
                "LaZagne",
                "Hildegard"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3fff98c9-ad02-401d-9d4b-f78b5b634f31",
            "created_at": "2023-01-06T13:46:38.376868Z",
            "updated_at": "2025-03-27T02:00:02.818071Z",
            "deleted_at": null,
            "main_name": "Cleaver",
            "aliases": [
                "Cobalt Gypsy",
                "G0003",
                "Operation Cleaver",
                "Op Cleaver",
                "Tarh Andishan",
                "Alibaba",
                "TG-2889"
            ],
            "source_name": "MISPGALAXY:Cleaver",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "a6c351ea-01f1-4c9b-af75-cfbb3b269ed3",
            "created_at": "2023-01-06T13:46:39.390649Z",
            "updated_at": "2025-03-27T02:00:03.072899Z",
            "deleted_at": null,
            "main_name": "Kinsing",
            "aliases": [
                "Money Libra"
            ],
            "source_name": "MISPGALAXY:Kinsing",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673536181,
    "ts_updated_at": 1743041821,
    "ts_creation_date": 1653698545,
    "ts_modification_date": 1653698545,
    "files": {
        "pdf": "https://archive.orkl.eu/8d0003cbc75d95b25fafd6fcca17e6e5bfe6d9e8.pdf",
        "text": "https://archive.orkl.eu/8d0003cbc75d95b25fafd6fcca17e6e5bfe6d9e8.txt",
        "img": "https://archive.orkl.eu/8d0003cbc75d95b25fafd6fcca17e6e5bfe6d9e8.jpg"
    }
}