{
    "id": "c2aa1ee8-b48b-48a6-b453-a5d5225ffce7",
    "created_at": "2023-01-12T15:08:32.430848Z",
    "updated_at": "2025-03-27T02:05:19.669336Z",
    "deleted_at": null,
    "sha1_hash": "2ab45a8763533bc84bfb41222ce4dc1c39ce7937",
    "title": "2022-01-06 - A “GULP” of PlugX",
    "authors": "",
    "file_creation_date": "2022-05-28T17:50:43Z",
    "file_modification_date": "2022-05-28T17:50:43Z",
    "file_size": 2069761,
    "plain_text": "# A “GULP” of PlugX – Cyber&Ramen\n\n**cyberandramen.net/2022/01/06/a-gulp-of-plugx/**\n\nJanuary 6, 2022\n\nOften attributed to Chinese-speaking threat actors, PlugX a remote access trojan(RAT), was\nidentified by security researchers in 2012. With several variants of the RAT identified by\nvendors over the year, many techniques used to compromise systems have remained the\nsame.\n\nWhile perusing public malware sandboxes for interesting new samples, I stumbled upon a\nWindows executable that at the time, had a VirusTotal score of 9 out of 68 anti-virus vendors.\n\nAs this sample was found via a sandbox, the delivery method is unknown, and will not be\ncovered in this post.\n\n## Dropper\n\n\n-----\n\nFigure 1\nSHA256: d88731851cc739ee72daf53700b0008db59ebb467e2394f9b3fc2162cd3a062f\n\nThis sample was identified by VT user PerMorten as a dropper for the reflective loading of\nPlugX. Looking a little closer at the supposed dropper file, three additional files within the PE\nare identified:\n\nWinHelp32.exe\nrscom.dll\nrscom.dll.dat\n\nFigure 2\n\n\n-----\n\nWinHelp32.exe is a legitimate software application that will be described further below. For\nPlugX aficionados, the above trio of documents likely looks familiar. A well-known technique\nof PlugX is to utilize a dropper or self-extracting RAR PE file to extract files on the victim\nsystem for execution.\n\n## The Legitimate App\n\nFigure 3\n\nSHA256: ec200f75e4884933a56e82531f3f52e64e73a3347ad4a3b9e6318df82cdca92a\n\nWinhelp32.exe is a legitimate application from the Beijing Rising IT company, a Chinese\nsoftware company that develops Rising Antivirus among other computer security software.\n\nAs the network infrastructure utilized with this malware was only recently registered as of\nNovember 2021, the reasoning for using an outdated application is unknown. The threat\nactor, in this case, may have purposefully utilized a Rising Antivirus executable in the\ntargeting of the intended victim or picked a random executable for their malware.\n\n## Rscom.dll.dat\n\nThe rscom.dll file does not contain much to write about other than its main purpose is to load\nthe .dat file, which is the compressed/encoded PlugX payload.\n\n\n-----\n\nAs the payload is what everyone is here for, let s dive a bit deeper into the data file.\n\nThe well-known magic “GULP” is visible in the .dat file through a hex editor. Additionally,\nwithin the file, MZ and PE headers are also visible.\n\nFigure 4\nThe .dat file is likely padded/compressed to evade antivirus engines. Upon execution, the file\nis decompressed via a call to the Windows API, RtlDecompressBuffer, and run in memory.\n\nFigure 5\nIdentified in a number of reports on network intrusions involving PlugX, a familiar decryption\nroutine (Figure 6) is also seen in rscom.dll.dat. The decryption routine contains multiple keys\nand shift operations, identified by the shr and shl calls below.\n\n\n-----\n\nFigure 6\n\n## Malware Flow\n\nThe unnamed dropper places the three files into “C:\\\\ProgramData\\Log’” in addition to a file\nnamed NvSmart.hlp (Figure 7). Upon running WinHelp32, the application deletes itself which\nis another interesting choice by the threat actor, as this would likely raise suspicions by the\nvictim running the antivirus software.\n\n\n-----\n\nFigure 7\nWatching the execution flow in your favorite Windows process monitoring software, oldschool PlugX is in full effect. WinHelp32.exe injects itself into svchost.exe, with the usual\nsecond injected process, msiexec.exe not being seen in this case.\n\nIn most cases, if services.exe is not the process launching svchost.exe, this would be an\neasy win for defenders to detect. It is likely the threat actor is relying on the behavior of\nantivirus software injecting itself into a process that would not raise alarms.\n\nTaking a look at the injected process read, write, executable (RWX) properties, we once\nagain see that the MZ and PE headers have been replaced with GULP, or PLUG backward.\n\nFigure 8\nA number of hardcoded values including command and control (C2) information are located\nwithin the decoded configuration:\n\n\n-----\n\nFigure 9\nUpon further research, an additional network indicator is located that appears to be a proxy\nfor the C2.\n\nFigure 10\n\n\n-----\n\nSo far we know the following about the network capabilities of this malware sample:\n\nA C2 domain of xiguamomomo[.]com\nUtilizes HTTP\nCommunicates with a proxy server of 43.129.208[.]226\n\nReferences to localhost, 127.0.0.1 can be seen in Figure 9, but the malware also seems to\nutilize the address for debug or anti-analysis purposes. This technique could possibly be\nutilized to slow researchers who may not be running the malware as needed for proper\nexecution (running only the DLL file for example).\n\nFigure 11\nIn addition to the possible debug strings seen in Figure 11, some 28 .cpp files indicating\nadditional capabilities of the RAT were also found:\n\nXJoin.cpp\nXThreadManager.cpp\nXSoUdp.cpp\nXSoTcpHttp.cpp\nXSoTcp.cpp\nXSoPipe.cpp\nXSniffer.cpp\nXSetting.cpp\nXSessionImpersonate.cpp\nXPlugTelnet.cpp\nXPlugSQL.cpp\nXPlugShell.cpp\nXPlugService.cpp\nXPlugScreen.cpp\nXPlugRegEdit.cpp\nXPlugProcess.cpp\nXPlugPortMap.cpp\nXPlugOption.cpp\nXPlugNetstat.cpp\nXPlugNetHood.cpp\nXPlugKeyLogger.cpp\nXPlugDisk.cpp\nXPlugLoader.cpp\nXPacket.cpp\nXOnline.cpp\nXInstall.cpp\nXDList.cpp\n\n\n-----\n\nXBuffer.cpp\n\nThe following interesting PDB paths were also found:\n\n12\n\n## Network Indicators\n\nAccording to PassiveDNS information, the domain xiguamomomo[.]com resolves to\n111.73.46[.]103, located in China, first seen 2021-10-12.\n\n\nFigure\n\n\nWHOIS information reveals the domain was registered through GoDaddy, with the registrant\ncountry listed as Cambodia, and the registrant identified as “ewrwer.”\n\nIn what could certainly be a coincidence, both xigua, and momo are popular apps originating\nfrom China. Xigua, an online video-sharing app with users across the world, boasts some\n160 million users. Momo, currently only available in Chinese, is a social networking app with\na large following.\n\nIt should be noted that not only are the delivery method of the RAT unknown, but also the\ntargeting. The above should be taken as low confidence at best, but certainly interesting\nnonetheless.\n\nAn additional IP address of 111.73.46[.]30 (open ports: 3389, 8000, 5985, 5987, and 24681)\nwas also identified through packet captures.\n\nThe ports 3389 (RDP), and 5985 are largely seen among many other suspected PlugX C2\ninfrastructure. This IP address belongs to the Chinanet-Backbone ASN.\n\nThe possible proxy address 43.129.208[.]226 (open ports: 22, 3306, and 8443) is located in\nHong Kong and belongs to the TENCENT-NET-AP-CN ASN.\n\nMultiple User-Agent values were also found within the decoded configuration data as seen in\nFigure 13.\n\nFigure 13\n**Featured image: Photo by Markus Spiske on Unsplash\n\n\n-----\n\n## Conclusion\n\nAs there is quite a bit of information missing with this variant of PlugX, the fresh command\nand control infrastructure and domain naming indicate that even dated versions of this RAT\nstill get the job done.\n\nPlease keep an eye out for updates to this post as I look deeper into the network\ninfrastructure to possibly tie additional domains/malware to the above findings.\n\n## Indicators\n\nFiles:\n\nDropper file:\nd88731851cc739ee72daf53700b0008db59ebb467e2394f9b3fc2162cd3a062f\nWinHelp32.exe (legitimate application):\nec200f75e4884933a56e82531f3f52e64e73a3347ad4a3b9e6318df82cdca92a\nRscom.dll (loader) :\n7af30d3c192f3fb85e1cadbf5c01f049f11eb036ca8107abb3451ffa0cc218b7\nRscom.dll.dat (PlugX payload):\nec46e04df901d7ec76ff1ad9ad6ceb54f8c2ad5e3597173365e094c5602e0049\n\nNetwork:\n\nxiguamomomo[.]com >> 111.73.46[.]103\n111.73.46[.]30\n43.129.208[.]226 (proxy)\n“/update?id=” (Callback URI in config)\nMozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\nMozilla/4.0 (compatible; MSIE 8.0; Win32)\nMozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)\nMozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko)\nChrome/31.0.1650.16 Safari/537.36\nMozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0)\nMozilla/5.0 (Windows NT 6.2; rv:12.0) Gecko/20100101 Firefox/12.0\nMozilla/5.0 (Windows NT 6.2) AppleWebKit/536.5 (KHTML, like Gecko)\nChrome/19.0.1084.52 Safari/536.5\nMozilla/5.0 (compatible; MSIE 10.0; Windows Phone 8.0; Trident/6.0; IEMobile/10.0;\nARM; Touch)\nMozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Trident/6.0)\nMozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0; Xbox)\nMozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)\nMozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)\nMozilla/5.0 (compatible; MSIE 9.0; Windows Phone OS 7.5; Trident/5.0; IEMobile/9.0)\n\n\n-----\n\nMozilla/5.0 (iPad; CPU OS 5_0 like Mac OS X) AppleWebKit/534.46 (KHTML, like\nGecko) Version/5.1 Mobile/9A334 Safari/7534.48.3\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-01-06 - A “GULP” of PlugX.pdf"
    ],
    "report_names": [
        "2022-01-06 - A “GULP” of PlugX.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673536112,
    "ts_updated_at": 1743041119,
    "ts_creation_date": 1653760243,
    "ts_modification_date": 1653760243,
    "files": {
        "pdf": "https://archive.orkl.eu/2ab45a8763533bc84bfb41222ce4dc1c39ce7937.pdf",
        "text": "https://archive.orkl.eu/2ab45a8763533bc84bfb41222ce4dc1c39ce7937.txt",
        "img": "https://archive.orkl.eu/2ab45a8763533bc84bfb41222ce4dc1c39ce7937.jpg"
    }
}