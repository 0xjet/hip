{
    "id": "d63dc75b-edeb-4811-9571-a1093fbe3929",
    "created_at": "2023-01-12T15:07:14.709829Z",
    "updated_at": "2025-03-27T02:06:00.586917Z",
    "deleted_at": null,
    "sha1_hash": "dc29d43f79a0a5ca60627a25b27046a3776625af",
    "title": "2015-10-08 - Dyre Malware Campaigners Innovate with Distribution Techniques",
    "authors": "",
    "file_creation_date": "2022-05-28T19:49:43Z",
    "file_modification_date": "2022-05-28T19:49:43Z",
    "file_size": 594367,
    "plain_text": "# Dyre Malware Campaigners Innovate with Distribution Techniques\n\n**[proofpoint.com/us/threat-insight/post/dyre-malware-campaigners-innovate-distribution-techniques](https://www.proofpoint.com/us/threat-insight/post/dyre-malware-campaigners-innovate-distribution-techniques)**\n\nOctober 9, 2015\n\n\n-----\n\n[Blog](https://www.proofpoint.com/us/blog)\n[Threat Insight](https://www.proofpoint.com/us/blog/threat-insight)\nDyre Malware Campaigners Innovate with Distribution Techniques\n\n\n-----\n\nOctober 08, 2015 Proofpoint Staff\n\nThis week, Proofpoint researchers observed the now infamous “man-in-the-browser” (MITB)\n[banking malware Dyre experimenting with new ways to deliver spam malicious attachments in](https://www.proofpoint.com/us/threat-reference/malicious-email-attachments)\nspam emails. These innovations included two significant changes in Dyre behavior:\n\nDyre employed the spambot Gophe to send thousands of randomized documents (hashes\nand file names) per spam campaign\nThe spammed attachments are using a RTF trick (or a feature of Windows OS) that allows\ndropping an executable – but not running it – simply by opening the RTF document\n\n**1. Changes in Email Campaign Behavior**\n\nIn past instances, Proofpoint researchers have observed that when Dyre actors employ\nMicrosoft Word document attachments, they have used a relatively high ratio of messages to\nunique documents (i.e., hashes): that is, using only a few unique Word document attachments\nfor a large number of messages. (This is in contrast to zipped executable attachments, where\nthey have frequently been observed using a large number of attachments for each campaign.)\n\n[1]\n\nHowever, on October 8, Proofpoint researchers observed the Gophe spammer botnet used by\nthese actors sending tens of thousands of unique Word documents in a single campaign. The\nDyre botnet propagates itself using the Gophe spambot – among others – to propagate itself,\ndownloading and running Gophe after the Dyre malware payload is successfully installed. The\nGophe bot then sends messages to all the addresses in the victim’s Outlook or Thunderbird\ncontact list, then deletes itself upon completion of this email run. Dyre downloads and runs the\nGophe spambot again when needed, as often as several times a day.\n\nIn this case, Gophe communicated with its command & control (C2) servers (62.210.182[.] 246\nand 178.162.193[.] 207) and received templates, randomized documents, and word lists for\n[additional randomization of the spam.](https://www.proofpoint.com/us/threat-reference/spam)\n\n\n-----\n\nDyre s Gophe spambot then crafted emails with the downloaded templates, filters, wordlists and\nother parameters. Appendix A includes the complete detected bot configuration, but we should\nhighlight one of the parameters, “address_in_message” with the value “5”. This parameter\ninstructs the bot to send an attachment to five recipients, and then move on to crafting an email\nwith a different attachment to next five recipients. (Fig. 1)\n\n_Figure 1: Phishing email with attachment to five recipients and zipped document with_\n_randomized name._\n\nThe attachment name was also randomized using an extensive wordlist. Below is a small\nsample of the over 60,000 words used:\n\nchariot\n\ncustom-house\n\ncomputer engineer\n\nzigzag\n\nhedge\n\nwarding\n\nsitty\n\nbeaded\n\n\n-----\n\nsphygmography\nconventional\nmannequin\n\nThe continual recombination of thousands of unique document hashes with a very wide variety\nof random words work together result in an email campaign that will virtually undetectable by\nsignature--based defenses.\n\n**2. Attachment Changes**\n\nWhen the email recipient opens the attachment, they encounter a ‘secure’ Office document. The\nlure is almost identical to the one Proofpoint researchers recently described in “Dyre\nCampaigners Set Sights on the Fulfillment and Warehousing Industry” [2]. However, instead of\nusing a macro known as Xbagging or Bartallex [3] to download the Upatre payload from the\nInternet, a different set of ruses and redirections is employed to drop an Upatre payload that is\nembedded within the document itself.\n\n_Figure 2: The malicious document attachment_\n\nThe document includes a malicious macro, which operates as follows:\n\n\n-----\n\n1. Document macro writes two RTF files in the %TMP% folder, runs one of them and sleeps.\n2. The first RTF file has an embedded Upatre executable as a Packager Shell Object. When\n\nthis RTF file is opened by the document macro, the embedded executable is dropped (but\nnot executed) into %TMP% folder without user interaction. (This seems to be a feature of\nMicrosoft Office that only works for RTFs, but not for other file formats such as DOC or\nDOCX.)\n3. The document macro finishes its sleep loop and executes the binary placed into %TMP%\n\nby the RTF.\n\nThis long chain of redirections is another example of the continued innovations threat actors and\nmalware authors employ in order to evade detection by both antivirus and behavioral defense\nsolutions.\n\nExamining the macro details closely we can see more clearly how these steps proceed. (Analyst\ncomments are inline after “###”.)\n\n_Figure 3: Malicious macro in document attachment_\n\nThe malicious macro opens “199.rtf” (Fig. 4), which includes an embedded Upatre executable\nas a Packager Shell Object. (Packager Shell Objects are bundles that can be embedded in a\ndocument and double-clicked to execute directly from the document.) A small icon – easily\nresized – representing the object is displayed in the upper left corner of the document\nattachment, and when this RTF file is opened by the document macro, the embedded\nexecutable is dropped (but not executed) into %TMP% folder as “w1.exe” without any user\ninteraction. We tested other formats such as DOC and DOCX and this behavior does not appear\n\n\n-----\n\nto be reproducible with these other formats. It should be noted that none of the Microsoft Office\nformats execute the Packager Shell Object binary automatically – the user needs to double click\nit.\n\n_Figure 4: RTF file with embedded executable by Packager Shell Object_\n\nIt should be noted that this macro appears to be a service or shared between groups, as it has\nalso been observed in other malware campaigns [4].\n\n**Conclusion**\n\nContinuous innovation is an essential trait of modern advanced threats in order for them to stay\nahead of adapting defenses. As this campaign demonstrates, techniques that have been\nobserved previously in use by one set of actors – such as cycling attachment names, high\nnumbers of unique attachments, and malicious macros that drop embedded malware payloads\n– can be adopted by threat actors to bring new life and renewed effectiveness to their\ncampaigns. This cycle of innovation and adaptation is a key aspect of many of the cybersecurity\nchallenges facing confronting organizations today, and shows no sign of abating.\n\n_References_\n\n[1] https://www.proofpoint.com/us/threat-insight/post/Dyre-Straits-Evolution-of-the-Dyre-BankingTrojan-Challenges-Traditional-Defenses\n\n\n-----\n\n[2] https://www.proofpoint.com/us/threat-insight/post/Dyre-Campaigners-Sights-On-FulfillmentWarehousing-Industry\n\n[2] [https://www.proofpoint.com/us/threat-insight/post/Its-Not-Personal-Its-Business](https://www.proofpoint.com/us/threat-insight/post/Its-Not-Personal-Its-Business)\n\n[3] [https://isc.sans.edu/forums/diary/Malicious+spam+with+Word+document/20225/](https://isc.sans.edu/forums/diary/Malicious+spam+with+Word+document/20225/)\n\n_Gophe Spam Bot Configuration Parameters_\n\nno_send_emails\nno_send_if_name_contain\npostmaster\nno_send_if_name_contain\nnoreplay\nno_send_if_name_contain\nnoreply\nno_send_if_name_contain\nadmin\nno_send_if_name_contain\nadministrator\nno_send_if_name_contain\nMailer-Daemon\nno_send_if_name_contain\nnull\nno_send_if_name_contain\nscan\nno_send_if_name_contain\nbak\nno_send_if_name_contain\ncopy\nno_send_if_name_contain\nfax\nno_send_if_domain_contain\n@sample\nno_send_if_domain_contain\n@gmail\nsend_emails_params\naddress_in_message\n5\nsend_interval_sec_min\n1\nsend_interval_sec_max\n1\nsend_order_array\n;EmailsFromAddressBook;EmailsFromOutBox;EmailsFromInBox;EmailsFromOther;\n\n\n-----\n\n**Indicators of Compromise (IOCs)**\n\n**Value** **Type**\n\n197.149.90[.]166 Upatre\nC2\n\n94ECC7D1F0FA098975A0984E55BA77EC93719B56DC3157D36311E18C51D581DC Upatre\nSHA256\n\n[hxxps://65.255.135.178/limto1.tar] Dyre\npayload\n\n[hxxps://188.93.122.150/limto1.tar] Dyre\npayload\n\n[hxxps://88.93.122.150/limto1.tar] Dyre\npayload\n\n[hxxps://67.222.201.105/limto1.tar] Dyre\npayload\n\n[hxxps://212.72.123.130/limto1.tar] Dyre\npayload\n\n[hxxps://50.24.13.21/limto1.tar] Dyre\npayload\n\n[hxxps://186.16.203.154/limto1.tar] Dyre\npayload\n\n[hxxps://93.103.20.189/limto1.tar] Dyre\npayload\n\n[hxxps://190.121.163.46/limto1.tar] Dyre\npayload\n\n[hxxps://202.79.57.155/limto1.tar] Dyre\npayload\n\n\n-----\n\n[hxxps://202.70.89.57/limto1.tar] Dyre\npayload\n\n[hxxps://190.121.164.10/limto1.tar] Dyre\npayload\n\n[hxxps://181.40.117.66/limto1.tar] Dyre\npayload\n\n[hxxps://201.217.51.92/limto1.tar] Dyre\npayload\n\n[hxxps://94.40.82.66/limto1.tar] Dyre\npayload\n\n[hxxps://69.9.204.114/limto1.tar] Dyre\npayload\n\n[hxxps://201.217.56.83/limto1.tar] Dyre\npayload\n\n[hxxps://24.33.131.116/limto1.tar] Dyre\npayload\n\n[hxxps://72.230.82.80/limto1.tar] Dyre\npayload\n\n[hxxps://173.248.31.6/limto1.tar] Dyre\npayload\n\n[hxxps://208.117.68.78/limto1.tar] Dyre\npayload\n\n[hxxps://69.144.171.44/limto1.tar] Dyre\npayload\n\n[hxxps://24.148.217.188/limto1.tar] Dyre\npayload\n\n[hxxps://173.216.247.74/limto1.tar] Dyre\npayload\n\n\n-----\n\n[hxxps://37.57.144.177/limto1.tar] Dyre\npayload\n\n[hxxps://68.70.242.203/limto1.tar] Dyre\npayload\n\n[hxxps://27.109.20.53/limto1.tar] Dyre\npayload\n\n[hxxps://67.222.201.61/limto1.tar] Dyre\npayload\n\n[hxxps://203.129.197.50/limto1.tar] Dyre\npayload\n\n[hxxps://112.133.203.43/limto1.tar] Dyre\npayload\n\n[hxxps://45.64.159.18/limto1.tar] Dyre\npayload\n\n[hxxps://150.129.49.11/limto1.tar] Dyre\npayload\n\n[hxxps://213.92.138.154/limto1.tar] Dyre\npayload\n\n[hxxps://109.199.11.51/limto1.tar] Dyre\npayload\n\n[hxxps://82.115.76.211/limto1.tar] Dyre\npayload\n\n[hxxps://78.72.233.105/limto1.tar] Dyre\npayload\n\n[hxxps://82.160.64.45/limto1.tar] Dyre\npayload\n\n[hxxps://197.210.199.21/limto1.tar] Dyre\npayload\n\n\n-----\n\n[hxxps://78.108.101.67/limto1.tar] Dyre\npayload\n\n[hxxps://94.40.82.239/limto1.tar] Dyre\npayload\n\n[hxxps://185.89.64.160/limto1.tar] Dyre\npayload\n\n[hxxps://87.126.65.67/limto1.tar] Dyre\npayload\n\n[hxxps://93.183.155.22/limto1.tar] Dyre\npayload\n\n[hxxps://87.97.168.205/limto1.tar] Dyre\npayload\n\n[hxxps://62.233.252.207/limto1.tar] Dyre\npayload\n\n[hxxps://85.11.144.37/limto1.tar] Dyre\npayload\n\n[hxxps://188.167.93.231/limto1.tar] Dyre\npayload\n\n[hxxps://91.240.236.148/limto1.tar] Dyre\npayload\n\n[hxxps://91.240.236.122/limto1.tar] Dyre\npayload\n\n[hxxps://93.115.172.232/limto1.tar] Dyre\npayload\n\n62.210.182.246 Gophe\nC2\n\n178.162.193.207 Gophe\nC2\n\n\n-----\n\nSubscribe to the Proofpoint Blog\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2015/2015-10-08 - Dyre Malware Campaigners Innovate with Distribution Techniques.pdf"
    ],
    "report_names": [
        "2015-10-08 - Dyre Malware Campaigners Innovate with Distribution Techniques.pdf"
    ],
    "threat_actors": [
        {
            "id": "2ed8d590-defa-4873-b2de-b75c9b30931e",
            "created_at": "2023-01-06T13:46:38.730137Z",
            "updated_at": "2025-03-27T02:00:02.903261Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "Boggy Serpens",
                "Mango Sandstorm",
                "TEMP.Zagros",
                "Static Kitten",
                "G0069",
                "TA450",
                "Earth Vetala",
                "Seedworm",
                "COBALT ULSTER",
                "ATK51"
            ],
            "source_name": "MISPGALAXY:MuddyWater",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "02e1c2df-8abd-49b1-91d1-61bc733cf96b",
            "created_at": "2022-10-25T15:50:23.308924Z",
            "updated_at": "2025-03-27T02:00:55.437268Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "MuddyWater",
                "Earth Vetala",
                "Static Kitten",
                "Seedworm",
                "TEMP.Zagros",
                "Mango Sandstorm",
                "TA450"
            ],
            "source_name": "MITRE:MuddyWater",
            "tools": [
                "STARWHALE",
                "POWERSTATS",
                "Out1",
                "PowerSploit",
                "Small Sieve",
                "Mori",
                "Mimikatz",
                "LaZagne",
                "PowGoop",
                "CrackMapExec",
                "ConnectWise",
                "SHARPSTATS",
                "RemoteUtilities",
                "Koadic"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3c430d71-ab2b-4588-820a-42dd6cfc39fb",
            "created_at": "2022-10-25T16:07:23.880522Z",
            "updated_at": "2025-03-27T02:02:10.010443Z",
            "deleted_at": null,
            "main_name": "MuddyWater",
            "aliases": [
                "ATK 51",
                "Boggy Serpens",
                "Cobalt Ulster",
                "ITG17",
                "Mango Sandstorm",
                "MuddyWater",
                "Operation BlackWater",
                "Operation Earth Vetala",
                "Operation Quicksand",
                "Seedworm",
                "Static Kitten",
                "T-APT-14",
                "TA450",
                "TEMP.Zagros",
                "Yellow Nix"
            ],
            "source_name": "ETDA:MuddyWater",
            "tools": [
                "Agentemis",
                "BugSleep",
                "CLOUDSTATS",
                "ChromeCookiesView",
                "Cobalt Strike",
                "CobaltStrike",
                "CrackMapExec",
                "DELPHSTATS",
                "EmPyre",
                "EmpireProject",
                "FruityC2",
                "Koadic",
                "LOLBAS",
                "LOLBins",
                "LaZagne",
                "Living off the Land",
                "MZCookiesView",
                "Meterpreter",
                "Mimikatz",
                "MuddyC2Go",
                "MuddyRot",
                "Mudwater",
                "POWERSTATS",
                "PRB-Backdoor",
                "PhonyC2",
                "PowGoop",
                "PowerShell Empire",
                "PowerSploit",
                "Powermud",
                "QUADAGENT",
                "SHARPSTATS",
                "SSF",
                "Secure Socket Funneling",
                "Shootback",
                "Smbmap",
                "Valyria",
                "chrome-passwords",
                "cobeacon",
                "prb_backdoor"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673536034,
    "ts_updated_at": 1743041160,
    "ts_creation_date": 1653767383,
    "ts_modification_date": 1653767383,
    "files": {
        "pdf": "https://archive.orkl.eu/dc29d43f79a0a5ca60627a25b27046a3776625af.pdf",
        "text": "https://archive.orkl.eu/dc29d43f79a0a5ca60627a25b27046a3776625af.txt",
        "img": "https://archive.orkl.eu/dc29d43f79a0a5ca60627a25b27046a3776625af.jpg"
    }
}