{
    "id": "7278cad9-ea8b-4245-a39a-732823c80fcd",
    "created_at": "2023-01-12T14:59:06.756754Z",
    "updated_at": "2025-03-27T02:05:34.497543Z",
    "deleted_at": null,
    "sha1_hash": "88391433181ad1bf71ad340104e05718c86da375",
    "title": "2021-08-16 - LockBit Resurfaces With Version 2.0 Ransomware Detections in Chile, Italy, Taiwan, UK",
    "authors": "",
    "file_creation_date": "2022-05-27T21:29:40Z",
    "file_modification_date": "2022-05-27T21:29:40Z",
    "file_size": 491837,
    "plain_text": "# LockBit Resurfaces With Version 2.0 Ransomware Detections in Chile, Italy, Taiwan, UK\n\n**[trendmicro.com/en_us/research/21/h/lockbit-resurfaces-with-version-2-0-ransomware-detections-in-chi.html](https://www.trendmicro.com/en_us/research/21/h/lockbit-resurfaces-with-version-2-0-ransomware-detections-in-chi.html)**\n\nAugust 16, 2021\n\nFigure 1.\n\nThe countries affected by LockBit 2.0, based on our telemetry from July 1 to Aug. 15, 2021\nLockBit 2.0 routine and updates\n\n\n-----\n\nFigure 2. The infection chain of LockBit 2.0\nLockBit 2.0 prides itself on having one of the fastest and most efficient encryption methods in today’s ransomware threat landscape. Our\nanalysis shows that while it uses a multithreaded approach in encryption, it also only partially encrypts the files, as only 4 KB of data are\nencrypted per file.\n\nLike other ransomware-as-a-service (RaaS) operations, LockBit 2.0 looks for affiliates to perform the intrusion and exfiltration on targets.\nThe group behind it also helps affiliates by providing StealBit (detected by Trend Micro as TrojanSpy.Win32.STEALBIT.YXBHM), a tool that\ncan automatically exfiltrate data. Attackers can also access victims’ systems with valid remote desktop protocol (RDP) accounts.\n\nOnce in a system, LockBit 2.0 uses a network scanner to identify the network structure and to find the target domain controller. It also uses\nmultiple batch files that can be used to terminate processes, services, and security tools. There are also batch files for enabling RDP\nconnections on the infected machine. The following are the tools and components that ensure LockBit’s smooth execution:\n\ndelsvc.bat (detected by Trend Micro as Trojan.BAT.KILLPROC.D) ensures that crucial processes, such as MySQL and QuickBooks, are\nunavailable. It also stops Microsoft Exchange and disables other related services.\nAV.bat (detected by Trend Micro as Trojan.BAT.KILLAV.WLDX) uninstalls the antivirus program ESET.\nLogDelete.bat (detected by Trend Micro as PUA.BAT.DHARMA.A) clears Windows Event Logs.\nDefoff.bat (detected by Trend Micro as Trojan.BAT.KILLAV.WLDX) disables Windows Defender features such as real-time monitoring.\n\nLockBit 2.0 also [abuses legitimate tools such as](https://www.trendmicro.com/vinfo/tmr/?/us/security/news/cybercrime-and-digital-threats/locked-loaded-and-in-the-wrong-hands-legitimate-tools-weaponized-for-ransomware-in-2021) [Process Hacker and](https://processhacker.sourceforge.io/) [PC Hunter to terminate processes and services in the victim system.](https://m.majorgeeks.com/files/details/pc_hunter.html)\nterminate processes and services in the victim system.\n\nOnce in the domain controller, the ransomware creates new group policies and sends them to every device on the network. These policies\ndisable Windows Defender, and distribute and execute the ransomware binary to each Windows machine.\n\nWe found LockBIT_7D68A5BFD028A31F.exe (detected by Trend Micro as Ransom.Win32.LOCKBIT.SMYEBGW) as the main ransomware\nmodule that appends .lockbit to every encrypted file. Once LockBit 2.0 completes encrypting a device, it drops a ransom note, Restore-MyFiles.txt (detected by Trend Micro as Ransom.Win32.LOCKBIT.SMA.note), into every encrypted directory. The note emphasizes\nthat files are not only encrypted but also at risk of being published if the ransom is not paid.\n\n\n-----\n\nFigure 4. The LockBit 2.0 ransom note dropped into every encrypted directory\nLockBit 2.0 also changes the desktop wallpaper into an image with instructions on how victims can pay for the ransom and how organization\ninsiders can be part of the “affiliate recruitment” of the group behind the ransomware. The group guarantees payouts of “millions of dollars” and\nanonymity in exchange for credentials and access.\n\nFigure 5. The LockBit\n\n2.0 ransom note as a desktop wallpaper\nRyuk and Egregor influences\n\nLockBit worked with the Maze ransomware cartel and was previously dubbed the ransomware “ABCD” because of the extension it\nappended to encrypted files before updating to the current extension. But after Maze’s [shutdown, the LockBit group went on](https://techcrunch.com/2020/11/02/maze-ransomware-group-shutting-down/)\nwith its own leak site, which led to the development of LockBit in September 2019. The previous version showed characteristics of ready-made\nransomware using the double extortion techniques of encrypting files, stealing data, and leaking the stolen data when the ransom was not\npaid. Two years later, LockBit 2.0 shows influences of and similarities to Ryuk and Egregor, particularly with regard\nto certain notable behaviors:\n\nWake-on-LAN feature inspired by Ryuk ransomware, sending the Magic Packet “0xFF 0xFF 0xFF 0xFF 0xFF 0xFF” to wake offline devices.\n\nFigure 6. Sending the Magic Packet to devices\n\nPrint bombing of the ransom note onto the victim’s network printers, similar to Egregor’s technique of attracting the victim’s attention. It\nuses Winspool APIs to enumerate and print a document on connected printers.\n\n\n-----\n\nFigure 7. Enumerating printers\n\nFigure 8. The WritePrinter API\n\nused to print ransom notes on printers\nConclusion\n\n[The group behind LockBit 2.0 recently conducted a highly publicized attack, so it should go without saying that organizations need to keep a](https://searchsecurity.techtarget.com/news/252505211/Accenture-responds-to-LockBit-ransomware-attack)\nwary eye on this ransomware variant. LockBit 2.0 is especially tricky for its fast encryption. We also assume that this group will continue to\nmake a scene for a long time, especially since it’s currently recruiting affiliates and insiders, making it more capable of infecting many\ncompanies and industries. It would also be wise to assume and prepare for upgrades and further developments in LockBit 2.0, especially now\nthat many companies are aware of its capabilities and how it works.\n\nBest practices\n\nGiven its persistence, speed of propagation, and methods of intrusion, LockBit 2.0 is likely to cause significant damage to its victims, be it\n[financial or reputational. Here are some best practices from the frameworks set by the Center of Internet Security and the](https://www.cisecurity.org/controls/) National Institute of\nStandards and Technology that can help organizations prevent and mitigate the impact of attacks involving ransomware like LockBit 2.0:\n\nAudit and inventory: Take an inventory of all organizational assets and data, and identify authorized and unauthorized devices, software,\nand personnel accessing particular systems. Audit and monitor all logs of events and incidents to identify unusual patterns and\nbehaviors.\nConfigure and monitor: Deliberately manage hardware and software configurations, and only grant administrative privileges and\naccess to specific personnel when absolutely necessary. Monitor the use of network ports, protocols, and services. Implement security\nconfigurations on network infrastructure devices such as firewalls and routers, and have a software allow list to prevent malicious\napplications from being executed.\nPatch and update: Perform periodic vulnerability assessments, and conduct regular patching or virtual patching for operating systems\nand applications. Ensure that all installed software and applications are updated to their latest versions.\nProtect and recover: Enforce data protection, backup, and recovery measures. Implement multifactor authentication in all devices and\nplatforms used whenever available.\nSecure and defend: Perform sandbox analysis to examine and block malicious emails. Employ the latest version of security solutions to\nall layers of the system, including email, endpoint, web, and network. Spot early signs of an attack such as the presence of suspicious\ntools in the system, and enable advanced detection technologies such as those powered with AI and machine learning.\n\n\n-----\n\na a d test e o secu ty s s assess e t a d t a g o a pe so e egu a y, a d co duct ed tea e e c ses a d\npenetration tests.\n\nTrend Micro solutions\n\nOrganizations can benefit from security solutions that encompass a system’s multiple layers (endpoint, email, web, and network) not only for\ndetecting malicious components but also for close monitoring of suspicious behaviors in the network.\n\n[Trend Micro™ Vision One™ provides multilayered protection and behavior detection, spotting questionable behaviors that might otherwise](https://www.trendmicro.com/en_us/business/products/detection-response.html)\n[seem benign when viewed from only a single layer. For an even closer inspection of endpoints, Trend Micro Apex One™ offers next-level](https://www.trendmicro.com/en_us/business/products/user-protection/sps.html)\nautomated threat detection and response against advanced concerns such as fileless threats and ransomware. This allows detecting and\nblocking ransomware early on before it can do any real damage to the system.\n\n[With techniques such as virtual patching and machine learning, Trend Micro™ Cloud One™ Workload Security protects systems against both](https://www.trendmicro.com/en_us/business/products/hybrid-cloud/cloud-one-workload-security.html)\nknown and unknown threats that exploit vulnerabilities. It also takes advantage of the latest in global threat intelligence to provide up-to-date,\nreal-time protection.\n\n[Ransomware often gets into the system through phishing emails. Trend Micro™ Deep Discovery™ Email Inspector employs custom](https://www.trendmicro.com/en_us/business/products/user-protection/sps/email-and-collaboration/email-inspector.html)\nsandboxing and advanced analysis techniques to effectively block ransomware before it gets into the system.\n\nIndicators of compromise\n\nSHA-256 Filename Detection\n\n0545f842ca2eb77bcac0fd17d6d0a8c607d7dbc8669709f3096e5c1828e1c049 Ransom.Win32.LOCKB\n\n0906a0b27f59b6db2a2451a0e0aabf292818e32ddd5404d08bf49c601a466744 Ransom.Win32.LOCKB\n\n21879b5a8a84c5fe5e009c85744caf74b817c57203020bf919037d7ccb6b6a58 Ransom.Win32.LOCKB\n\n255f8465962bedaf7a373da5f721aecbc1d6027ca2e4256c6c4352f2de179ca0\n\n\nRestore-My-Files.txt\n\n\nRansom.Win32.LOCKB\n\n\n4db47caf8d93e855b8364def67d3d3282fc964dc4684df6bbe172ea6e902e6fe\n\n7b64ca8fe1cace0744a28f43961f17f8ea51910a54d6629502bfb9f3f3e5f831\n\n8c0e4a6fd28f94fa17a96f6e424b122f5d1216b230a33c6dff5dbf6654d0721c\n\na05ed65787b390ba33b04b4b99c3810cbaf684b37f8839e57db8316e6f01af31 Ransom.Win32.LOCKBIT.O.note\n\na26250b8d2431b497400c8a754285a6259a81a31ae629ee25331f6030b34e543 Ransom.Win32.LOCKBIT.ENH.note\n\nb09a92dedbcb8d5faed6fcc2194ebaa24da601376b47e1edf705519a7860964e Ransom.Win32.LOCKBIT.N.note\n\nbea7aed0dfbf7ce7491d7c8cfed35a2e626fbd345bb7425a34dae6f5894629b1 Ransom.Win32.LOCKBIT.ENH.note\n\ncb29c6fbd085407e0e8a58e7cd6512c8c5dfa06f88fdeeb9a66d025fdfc6dd32\n\nf03584ecdee29e63dee1b7bf2347f605d1e1d6379a8f55e9a85c6a329bf3967b Ransom.Win32.LOCKBIT.ENG.note\n\n28042dd4a92a0033b8f1d419b9e989c5b8e32d1d2d881f5c8251d58ce35b9063 ph.exe PUA.Win32.ProcHack.A\n\n3407f26b3d69f1dfce76782fee1256274cf92f744c65aa1ff2d3eaaaf61b0b1d StealBit.exe.dangerousFile TrojanSpy.Win32.STEAL\n\n4bb152c96ba9e25f293bbc03c607918a4452231087053a8cb1a8accb1acc92fd Ransom.Win32.LOCKB\n\n4edbf2358a9820e030136dc76126c20cc38159df0d8d7b13d30b1c9351e8b277\n\nbcbb1e388759eea5c1fbb4f35c29b6f66f3f4ca4c715bab35c8fc56dcf3fa621\n\ndd8fe3966ab4d2d6215c63b3ac7abf4673d9c19f2d9f35a6bf247922c642ec2d\n\n4db7eeed852946803c16373a085c1bb5f79b60d2122d6fc9a2703714cdd9dac0 sample.exe TrojanSpy.Win32.STEAL\n\n6876eef67648a3797987745617b9fdfb31a703b7809e7f12bb52c6386e185917 CryptNN.exe Ransom.Win32.LOCKB\n\n717585e9605ac2a971b7c7537e6e311bab9db02ecc6451e0efada9b2ff38b474 Ransom.Win32.LOCKB\n\n\n-----\n\n73406e0e7882addf0f810d3bc0e386fd5fd2dd441c895095f4125bb236ae7345 Ransom.Win32.LOCKB\n\n7b5db447f6c29c939f5e0aae1b16431a132db5a2ab4420ba9818af2bf4496d21 psdelsvc.bat Trojan.BAT.KILLPROC.D\n\naae5e59d6424515c157f3c4a54e4feeb09759d028290ab0271f730e82f58f10f delsvc.bat\n\n94e6b969c100483970fc3985bf2b173f2f24d796a079114f584f42484840be28 AV.bat Trojan.BAT.KILLAV.WLD\n\na398c70a2b3bf8ae8b5ceddf53fcf6daa2b68af2fadb76a8ea6e33b8bbe06f65 defoff.bat\n\n98e4c248377b5b62121c7b9ef20fc03df3473cbd886a059998f4210e8df07f15 pchunter64.exe PUA.Win32.PCHunter.E\n\na7591e4a248c04547579f014c94d7d30aa16a01bb2a25b77df36e30a198df108 Ransom.Win32.LOCKB\n\nacad2d9b291b5a9662aa1469f96995dc547a45e391af9c7fa24f5921b0128b2c Ransom.Win32.LOCKB\n\nb3faf5d8cbc3c75d4c3897851fdaf8d7a4bd774966b4c25e0e4617546109aed5 Ransom.Win32.LOCKB\n\nbd14872dd9fdead89fc074fdc5832caea4ceac02983ec41f814278130b3f943e StealBit.exe TrojanSpy.Win32.STEAL\n\nd089d57b8b2b32ee9816338e96680127babc5d08a03150740a8459c29ab3ba78 Ransom.Win32.LOCKB\n\nd089d57b8b2b32ee9816338e96680127babc5d08a03150740a8459c29ab3ba78 LockBIT_7D68A5BFD028A31F.exe Ransom.Win32.LOCKB\n\nf32e9fb8b1ea73f0a71f3edaebb7f2b242e72d2a4826d6b2744ad3d830671202 Ransom.Win32.LOCKB\n\n**URLs**\n\nhxxp://lockbitapt6vx57t3eeqjofwgcglmutr3a35nygvokja5uuccip4ykyd[.]onion\nhxxp://lockbitsap2oaqhcun3syvbqt6n5nzt7fqosc6jdlmsfleu3ka4k2did[.]onion\nhxxp://lockbitsup4yezcd5enk5unncx3zcy7kw6wllyqmiyhvanjj352jayid[.]onion\n\n**MITRE ATT&CK Tactics and Techniques**\n\n**Tactic** **Technique**\n\nInitial access T1078: Valid accounts\n\nDefense evasion T1562.001: Impair defenses: disable or modify tools\n\nT1546.008: Event-triggered execution: accessibility features\n\nT1070.001: Indicator removal on host: clear Windows Event Logs\n\nExfiltration T1041: Exfiltration Over C2 Channel\n\nImpact T1486: Data encrypted for impact\n\nT1489: Service stop\n\nT1490: Inhibit System Recovery\n\nRansomware\n\nThe ransomware group LockBit resurfaced in June with LockBit 2.0, with reports indicating an increased number of targeted companies and\nthe incorporation of double extortion features. Our detections followed attack attempts in Chile, Italy, Taiwan, and the UK from July to August.\n\nBy: Jett Paulo Bernardo, Jayson Chong, Byron Gelera, Nikki Madayag, Mark Marti, Cris Tomboc, Sean Torre August 16, 2021 Read time: (\nwords)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2021/2021-08-16 - LockBit Resurfaces With Version 2.0 Ransomware Detections in Chile, Italy, Taiwan, UK.pdf"
    ],
    "report_names": [
        "2021-08-16 - LockBit Resurfaces With Version 2.0 Ransomware Detections in Chile, Italy, Taiwan, UK.pdf"
    ],
    "threat_actors": [],
    "ts_created_at": 1673535546,
    "ts_updated_at": 1743041134,
    "ts_creation_date": 1653686980,
    "ts_modification_date": 1653686980,
    "files": {
        "pdf": "https://archive.orkl.eu/88391433181ad1bf71ad340104e05718c86da375.pdf",
        "text": "https://archive.orkl.eu/88391433181ad1bf71ad340104e05718c86da375.txt",
        "img": "https://archive.orkl.eu/88391433181ad1bf71ad340104e05718c86da375.jpg"
    }
}