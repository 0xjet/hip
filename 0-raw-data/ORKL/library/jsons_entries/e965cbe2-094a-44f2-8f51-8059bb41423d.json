{
    "id": "e965cbe2-094a-44f2-8f51-8059bb41423d",
    "created_at": "2023-05-06T02:08:22.61475Z",
    "updated_at": "2025-03-27T02:16:55.368115Z",
    "deleted_at": null,
    "sha1_hash": "36231e2ca10982cbe581ca067409e7973d6bdabe",
    "title": "2023-04-05 - How we’re protecting users from government-backed attacks from North Korea",
    "authors": "",
    "file_creation_date": "2023-05-05T02:02:18Z",
    "file_modification_date": "2023-05-05T02:02:18Z",
    "file_size": 611245,
    "plain_text": "# How Google is protecting users from North Korean hackers\n\n**[blog.google/threat-analysis-group/how-were-protecting-users-from-government-backed-attacks-from-north-korea/](https://blog.google/threat-analysis-group/how-were-protecting-users-from-government-backed-attacks-from-north-korea/)**\n\nAdam Weidemann April 5, 2023\n\nThreat Analysis Group\n\n## How we’re protecting users from government-backed attacks from North Korea\n\nAs part of Threat Analysis Group (TAG)’s mission to counter serious threats to Google and\nour users, TAG has been tracking government-backed hacking activity tied to North Korea for\n[over a decade. Today, as a follow up to Mandiant’s report on APT43, we are sharing TAG's](https://www.mandiant.com/resources/blog/apt43-north-korea-cybercrime-espionage)\nobservations on this actor and what Google is doing to protect users from this group and\nother government-backed attackers. Because TAG’s visibility into this actor is distinct from\nMandiant’s, TAG uses the name ARCHIPELAGO to track a subset of APT43 activity.\n\nTAG began tracking ARCHIPELAGO in 2012 and has observed the group target individuals\nwith expertise in North Korea policy issues such as sanctions, human rights and nonproliferation issues. These targets include Google and non-Google accounts belonging to\ngovernment and military personnel, think tanks, policy makers, academics, and researchers\nin South Korea, the US and elsewhere.\n\nTo safeguard users at-risk, TAG uses our research on serious threat actors like\nARCHIPELAGO to improve the safety and security of Google’s products. TAG adds newly\ndiscovered malicious websites and domains to Safe Browsing to protect users from further\nexploitation. We also send all targeted Gmail and Workspace users government-backed\nattacker alerts notifying them of the activity. We encourage potential targets to enroll in\n[Google's Advanced Protection Program, enable](https://landing.google.com/advancedprotection/) [Enhanced Safe Browsing for Chrome and](https://support.google.com/accounts/answer/11577602?hl=en)\nensure that all devices are updated.\n\n## ARCHIPELAGO phishing: persistent and targeted\n\nARCHIPELAGO often sends phishing emails where they pose as a representative of a\nmedia outlet or think tank and ask North Korea experts to participate in a media interview or\nrequest for information (RFI). The emails prompt recipients to click a link to view the\ninterview questions or RFI. When the recipient clicks, the link redirects to a phishing site that\nmasquerades as a login prompt. The phishing page records keystrokes entered into the login\nform and sends them to an attacker-controlled URL. After the recipient enters their\n\n\n-----\n\npassword, the phishing page redirects to a benign document with contextually appropriate\ninterview questions, or an RFI that would make sense to the recipient based on the content\nof the original phishing email.\n\nDrive-themed phishing landing page ARCHIPELAGO used in combination with\n“interview request” phishing emails.\n\nMicrosoft 365-themed credential harvesting page\n\nAfter the recipient enters their password into the phishing page, they are redirected to a\ndocument with interview questions or an RFI as promised in the original phishing email\n\n\n-----\n\nARCHIPELAGO invests time and effort to build rapport with targets, often corresponding with\nthem by email over several days or weeks before finally sending a malicious link or file. In\none case, the group posed as a journalist for a South Korean news agency and sent benign\nemails with an interview request to North Korea experts. When recipients replied expressing\ninterest in an interview, ARCHIPELAGO continued the correspondence over several emails\nbefore finally sending a OneDrive link to a password-protected file that contained malware.\n\nARCHIPELAGO has also sent links that lead to “browser-in-the-browser” phishing pages.\nThe phishing pages present users with a fake browser window rendered inside the actual\nbrowser window. The fake browser window displays a URL and a login prompt designed to\ntrick users into thinking they are entering their password into a legitimate login page.\n\npicture of a a phishing page\nARCHIPELAGO “browser-in-the-browser” phishing page\n\n## Shifting phishing tactics\n\nARCHIPELAGO has shifted their phishing tactics over time. For several years, they sent\ntypical phishing messages that posed as Google Account security alerts. Over time this\ntechnique became less successful and ARCHIPELAGO has evolved and experimented with\nnew phishing that might be more difficult for users and common security controls to catch.\n\nimage of a phishing email\nExample from 2015 of an ARCHIPELAGO phishing email\n\nOne example of ARCHIPELAGO’s shifting phishing techniques is a campaign in late 2022\nwhere they sent links to a benign PDF file hosted in OneDrive. The PDF claimed to be a\nmessage from the State Department Federal Credit Union notifying customers they detected\nmalicious logins from their Google Account and that the customer should click the link in the\nPDF to verify activity from their Gmail account. If clicked, the link directed recipients to a\nphishing page. ARCHIPELAGO created unique PDFs for each recipient so that when the\nrecipient clicked, the phishing page was pre-populated with the recipient’s email address.\n\nimage of a cloud storage service with phishing links\nARCHIPELAGO used legitimate cloud storage services to host benign PDFs with phishing\nlinks inside\n\nBy placing the phishing link inside a benign PDF hosted on a legitimate cloud hosting\nservice, ARCHIPELAGO was likely trying to evade detection by AV services that do not scan\nlinks inside files.\n\n## Malware operations\n\n\n-----\n\nFor several years, ARCHIPELAGO focused on conducting traditional credential phishing\ncampaigns. More recently, TAG has observed ARCHIPELAGO incorporate malware into\nmore of their operations, including efforts to evade detection and develop novel malware\ntechniques. To protect their malware from AV scanning, ARCHIPELAGO commonly\npassword-protects their malware and shares the password with recipients in a phishing\nemail.\n\nimage of a phishing email\nARCHIPELAGO phishing email with a password-protected attachment. The password for\ndecrypting the attachment is included in the body of the phishing email.\n\n## Encoding malware payloads and commands in Drive file names\n\nARCHIPELAGO has experimented with their malware over time, including using novel\nmalware delivery techniques. In 2020, they began testing a then-new technique with files\nthey hosted on Google Drive. ARCHIPELAGO encoded malicious payloads in the filenames\nof files hosted on Drive, while the files themselves contained zero bytes of content. They also\nused Drive file names for C2, placing encoded commands in file names. Security\nresearchers at [Huntress and](https://www.huntress.com/blog/targeted-apt-activity-babyshark-is-out-for-blood) [IssueMakersLab publicly reported on this technique.](https://twitter.com/issuemakerslab/status/1241250182810857480)\n\nGoogle took action to disrupt ARCHIPELAGO’s use of Drive file names to encode malware\npayloads and commands. The group has since discontinued their use of this technique on\nDrive.\n\n## Malware packaged in ISO files\n\nARCHIPELAGO has also attempted to deliver malware via Drive using ISO files, a file format\nthat has gained popularity among threat actors ranging from government-backed attackers to\nfinancially motivated groups. In one case TAG recently examined, ARCHIPELAGO sent a\nphishing email with a Drive link to an ISO file, Interview_with_Voice_of_America.iso. The ISO\nfile contained a ZIP, which, in turn, contained a password-protected document. When\n[decrypted, the document installed VBS-based malware related to BabyShark.](https://unit42.paloaltonetworks.com/new-babyshark-malware-targets-u-s-national-security-think-tanks/)\n\n## Malicious Chrome Extensions\n\nARCHIPELAGO has also used malicious Chrome extensions in combination with phishing\nand malware. The earliest versions of these extensions, reported as STOLEN PENCIL in\n2018, included functionality to steal usernames, passwords and browser cookies. They were\ndelivered via phishing emails with a link that directed recipients to a lure document that\nprompted users to install the malicious Chrome extension. Google has since introduced\nseveral changes to the Chrome extension ecosystem, including enhanced transparency\nthrough the Chrome Web Store and [Manifest V3, that effectively disrupt threat actors from](https://developer.chrome.com/docs/extensions/mv3/intro/)\ndistributing malicious extensions like STOLEN PENCIL via the Chrome Web Store. In 2018,\n\n\n-----\n\n[Chrome also made improvements to the extension review process by making extensions that](https://blog.chromium.org/2018/10/trustworthy-chrome-extensions-by-default.html#:~:text=Changes%20to%20the%20extensions%20review%20process)\nrequest powerful permissions subject to additional compliance review while also conducting\nongoing monitoring of extensions that use remotely hosted code.\n\nMore recently, ARCHIPELAGO has attempted work-arounds to install a new malicious\n[Chrome extension known publicly as SHARPEXT. If successfully installed on a user system,](https://www.volexity.com/blog/2022/07/28/sharptongue-deploys-clever-mail-stealing-browser-extension-sharpext/)\nSHARPEXT can parse emails from active Gmail or AOL Mail tabs and exfiltrate them to an\nattacker-controlled system. As a result of improved security in the Chrome extension\necosystem, ARCHIPELAGO must now complete several additional steps to install the\nextension, including first successfully installing malware on the user system and then\noverwriting the Chrome Preferences and Secure Preferences files to allow the extension to\nrun.\n\n## Protecting against advanced threats\n\nTAG, in partnership with Mandiant and other security teams across Google, is committed to\nour mission of understanding and countering advanced threats. We apply our research to\nensure Google’s products are secure and our users are safe. For individuals at high risk of\n[this activity and other serious threats, Google provides advanced security resources,](https://blog.google/technology/safety-security/online-safety-resources/)\n[including Enhanced Safe Browsing and the](https://support.google.com/accounts/answer/11577602?hl=en) [Advanced Protection Program. When these tools](https://landing.google.com/advancedprotection/)\nare used in combination with Google’s [Security Checkup, they provide the fastest and](https://myaccount.google.com/security-checkup)\nstrongest level of protection against serious threats.\n\nPOSTED IN:\n\n[Threat Analysis Group](https://blog.google/threat-analysis-group/%20)\n\nRelated stories\n\nThreat Analysis Group\n**TAG Bulletin: Q1 2023**\n\nThreat Analysis Group shares their Q1 2023 bulletin.\n\nBy Shane Huntley\n\nMay 01, 2023\nThreat Analysis Group\n**Ukraine remains Russia’s biggest cyber focus in 2023**\n\nGoogle's Threat Analysis Group shares first quarter cyber updates on the threat\nlandscape from the war in Ukraine.\n\nBy Billy Leonard\n\nApr 19, 2023\n\n\n-----\n\nThreat Analysis Group\n**Spyware vendors use 0-days and n-days against popular platforms**\n\nGoogle’s Threat Analysis Group (TAG) tracks actors involved in information operations\n(IO), government backed attacks and financially motivated abuse. For years, TAG\nhas…\n\nBy Clement Lecigne\n\nMar 29, 2023\nThreat Analysis Group\n**Magniber ransomware actors used a variant of Microsoft SmartScreen bypass**\n\nNew research from Threat Analysis Group on Magniber's exploitation of Microsoft 0day vulnerability.\n\nBy Benoit Sevens\n\nMar 14, 2023\n\nThreat Analysis Group\n**Fog of war: how the Ukraine conflict transformed the cyber threat landscape**\n\nBy Shane Huntley\n\nFeb 16, 2023\n\n\n-----\n\nThreat Analysis Group\n**Over 50,000 instances of DRAGONBRIDGE activity disrupted in 2022**\n\nAn update on TAG's work to disrupt the information operation network\nDRAGONBRIDGE.\n\nBy Zak Butler Jonas Taege\n\nJan 26, 2023\n.\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2023/2023-04-05 - How we’re protecting users from government-backed attacks from North Korea.pdf"
    ],
    "report_names": [
        "2023-04-05 - How we’re protecting users from government-backed attacks from North Korea.pdf"
    ],
    "threat_actors": [
        {
            "id": "a02bb810-5dd2-46c1-a609-b44d984d96d0",
            "created_at": "2022-10-25T15:50:23.505735Z",
            "updated_at": "2025-03-27T02:00:55.487109Z",
            "deleted_at": null,
            "main_name": "Stolen Pencil",
            "aliases": [
                "Stolen Pencil"
            ],
            "source_name": "MITRE:Stolen Pencil",
            "tools": [
                "Mimikatz",
                "PsExec"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d90307b6-14a9-4d0b-9156-89e453d6eb13",
            "created_at": "2022-10-25T16:07:23.773944Z",
            "updated_at": "2025-03-27T02:02:09.974695Z",
            "deleted_at": null,
            "main_name": "Lead",
            "aliases": [
                "Casper",
                "TG-3279"
            ],
            "source_name": "ETDA:Lead",
            "tools": [
                "Agentemis",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "RbDoor",
                "RibDoor",
                "Winnti",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "aa73cd6a-868c-4ae4-a5b2-7cb2c5ad1e9d",
            "created_at": "2022-10-25T16:07:24.139848Z",
            "updated_at": "2025-03-27T02:02:10.120505Z",
            "deleted_at": null,
            "main_name": "Safe",
            "aliases": [],
            "source_name": "ETDA:Safe",
            "tools": [
                "DebugView",
                "LZ77",
                "OpenDoc",
                "SafeDisk",
                "TypeConfig",
                "UPXShell",
                "UsbDoc",
                "UsbExe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "c306e698-3b48-46d7-b571-3dfa0c828379",
            "created_at": "2023-05-16T02:02:09.957677Z",
            "updated_at": "2025-03-27T02:00:03.129777Z",
            "deleted_at": null,
            "main_name": "APT43",
            "aliases": [],
            "source_name": "MISPGALAXY:APT43",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "9f101d9c-05ea-48b9-b6f1-168cd6d06d12",
            "created_at": "2023-01-06T13:46:39.396409Z",
            "updated_at": "2025-03-27T02:00:03.074969Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "CHROMIUM",
                "ControlX",
                "Red Dev 10",
                "RedHotel",
                "Red Scylla",
                "TAG-22",
                "BRONZE UNIVERSITY",
                "AQUATIC PANDA",
                "Charcoal Typhoon",
                "BountyGlad"
            ],
            "source_name": "MISPGALAXY:Earth Lusca",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "6abcc917-035c-4e9b-a53f-eaee636749c3",
            "created_at": "2022-10-25T16:07:23.565337Z",
            "updated_at": "2025-03-27T02:02:09.868522Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Bronze University",
                "Charcoal Typhoon",
                "Chromium",
                "Red Dev 10",
                "Red Scylla"
            ],
            "source_name": "ETDA:Earth Lusca",
            "tools": [
                "Agentemis",
                "AntSword",
                "BIOPASS",
                "BIOPASS RAT",
                "BadPotato",
                "Behinder",
                "BleDoor",
                "Cobalt Strike",
                "CobaltStrike",
                "Doraemon",
                "FRP",
                "Fast Reverse Proxy",
                "FunnySwitch",
                "HUC Port Banner Scanner",
                "KTLVdoor",
                "Mimikatz",
                "NBTscan",
                "POISONPLUG.SHADOW",
                "PipeMon",
                "RbDoor",
                "RibDoor",
                "RouterGod",
                "SAMRID",
                "ShadowPad Winnti",
                "SprySOCKS",
                "WinRAR",
                "Winnti",
                "XShellGhost",
                "cobeacon",
                "fscan",
                "lcx",
                "nbtscan"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "dc78f675-b309-431d-8160-b8dcff037d4f",
            "created_at": "2024-05-01T02:03:08.142224Z",
            "updated_at": "2025-03-27T02:05:17.417972Z",
            "deleted_at": null,
            "main_name": "NICKEL KIMBALL",
            "aliases": [
                "Black Banshee ",
                "Crooked Pisces ",
                "Emerald Sleet ",
                "Kimsuky ",
                "Opal Sleet ",
                "SharpTongue ",
                "TA427 ",
                "THALLIUM ",
                "Velvet Chollima ",
                "APT43 "
            ],
            "source_name": "Secureworks:NICKEL KIMBALL",
            "tools": [
                " KONNI",
                " KimJongRAT",
                " Kimsuky",
                "BabyShark"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "a90ae795-3c01-4419-8365-07b68df72661",
            "created_at": "2024-07-02T02:00:04.158227Z",
            "updated_at": "2025-03-27T02:00:03.394622Z",
            "deleted_at": null,
            "main_name": "Dragonbridge",
            "aliases": [
                "Spamouflage Dragon"
            ],
            "source_name": "MISPGALAXY:Dragonbridge",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "760f2827-1718-4eed-8234-4027c1346145",
            "created_at": "2023-01-06T13:46:38.670947Z",
            "updated_at": "2025-03-27T02:00:02.888195Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Thallium",
                "G0086",
                "APT43",
                "Springtail",
                "Sparkling Pisces",
                "Velvet Chollima",
                "Black Banshee",
                "Operation Stolen Pencil",
                "Emerald Sleet",
                "THALLIUM"
            ],
            "source_name": "MISPGALAXY:Kimsuky",
            "tools": [
                "RevClient",
                "xrat",
                "QUASARRAT",
                "RDP Wrapper",
                "TightVNC",
                "BabyShark"
            ],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "191d7f9a-8c3c-442a-9f13-debe259d4cc2",
            "created_at": "2022-10-25T15:50:23.280374Z",
            "updated_at": "2025-03-27T02:00:55.423485Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "Kimsuky",
                "Black Banshee",
                "Velvet Chollima",
                "Emerald Sleet",
                "THALLIUM",
                "APT43",
                "TA427"
            ],
            "source_name": "MITRE:Kimsuky",
            "tools": [
                "schtasks",
                "Amadey",
                "Brave Prince",
                "CSPY Downloader",
                "gh0st RAT",
                "AppleSeed",
                "NOKKI",
                "QuasarRAT",
                "Gold Dragon",
                "PsExec",
                "KGH_SPY",
                "Mimikatz",
                "BabyShark"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "d53593c3-2819-4af3-bf16-0c39edc64920",
            "created_at": "2022-10-27T08:27:13.212301Z",
            "updated_at": "2025-03-27T02:00:55.529662Z",
            "deleted_at": null,
            "main_name": "Earth Lusca",
            "aliases": [
                "Earth Lusca",
                "TAG-22",
                "Charcoal Typhoon",
                "CHROMIUM",
                "ControlX"
            ],
            "source_name": "MITRE:Earth Lusca",
            "tools": [
                "Mimikatz",
                "PowerSploit",
                "Tasklist",
                "certutil",
                "Cobalt Strike",
                "Winnti for Linux",
                "Nltest",
                "NBTscan",
                "ShadowPad"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "71a1e16c-3ba6-4193-be62-be53527817bc",
            "created_at": "2022-10-25T16:07:23.753455Z",
            "updated_at": "2025-03-27T02:02:09.963016Z",
            "deleted_at": null,
            "main_name": "Kimsuky",
            "aliases": [
                "APT 43",
                "Black Banshee",
                "Emerald Sleet",
                "ITG16",
                "KTA082",
                "Kimsuky",
                "Larva-24005",
                "Operation Baby Coin",
                "Operation Covert Stalker",
                "Operation DEEP#DRIVE",
                "Operation DEEP#GOSU",
                "Operation Kabar Cobra",
                "Operation Mystery Baby",
                "Operation Red Salt",
                "Operation Smoke Screen",
                "Operation Stealth Power",
                "Operation Stolen Pencil",
                "SharpTongue",
                "Sparkling Pisces",
                "Springtail",
                "TA406",
                "TA427",
                "Thallium",
                "UAT-5394",
                "Velvet Chollima"
            ],
            "source_name": "ETDA:Kimsuky",
            "tools": [
                "AngryRebel",
                "AppleSeed",
                "BITTERSWEET",
                "BabyShark",
                "BoBoStealer",
                "CSPY Downloader",
                "Farfli",
                "FlowerPower",
                "Gh0st RAT",
                "Ghost RAT",
                "Gold Dragon",
                "GoldDragon",
                "GoldStamp",
                "JamBog",
                "KGH Spyware Suite",
                "KGH_SPY",
                "KPortScan",
                "KimJongRAT",
                "Kimsuky",
                "LATEOP",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Lovexxx",
                "MailPassView",
                "Mechanical",
                "Mimikatz",
                "MoonPeak",
                "Moudour",
                "MyDogs",
                "Mydoor",
                "Network Password Recovery",
                "PCRat",
                "ProcDump",
                "PsExec",
                "ReconShark",
                "Remote Desktop PassView",
                "SHARPEXT",
                "SWEETDROP",
                "SmallTiger",
                "SniffPass",
                "TODDLERSHARK",
                "TRANSLATEXT",
                "Troll Stealer",
                "TrollAgent",
                "VENOMBITE",
                "WebBrowserPassView",
                "xRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1683338902,
    "ts_updated_at": 1743041815,
    "ts_creation_date": 1683252138,
    "ts_modification_date": 1683252138,
    "files": {
        "pdf": "https://archive.orkl.eu/36231e2ca10982cbe581ca067409e7973d6bdabe.pdf",
        "text": "https://archive.orkl.eu/36231e2ca10982cbe581ca067409e7973d6bdabe.txt",
        "img": "https://archive.orkl.eu/36231e2ca10982cbe581ca067409e7973d6bdabe.jpg"
    }
}