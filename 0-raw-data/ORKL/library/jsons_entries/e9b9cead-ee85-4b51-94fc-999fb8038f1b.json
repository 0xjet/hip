{
    "id": "e9b9cead-ee85-4b51-94fc-999fb8038f1b",
    "created_at": "2022-10-25T16:48:23.70754Z",
    "updated_at": "2025-03-27T02:05:55.360191Z",
    "deleted_at": null,
    "sha1_hash": "55126780b716d34c5c6008e532a90033d711b9ce",
    "title": "",
    "authors": "",
    "file_creation_date": "2019-07-19T06:14:21Z",
    "file_modification_date": "2019-07-19T06:14:21Z",
    "file_size": 479532,
    "plain_text": "[Trend Micro](https://www.trendmicro.com/)\n[About TrendLabs Security Intelligence Blog](https://blog.trendmicro.com/trendlabs-security-intelligence/about-us/)\n\n[Home  »  Malware  »  SLUB Gets Rid of GitHub, Intensifies Slack Use](https://blog.trendmicro.com/trendlabs-security-intelligence/)\n\n# SLUB Gets Rid of GitHub, Intensifies Slack Use\n\n[Posted on:July 16, 2019 at 5:01 am](https://blog.trendmicro.com/trendlabs-security-intelligence/2019/07/)\n[Posted in:Malware, Vulnerabilities](https://blog.trendmicro.com/trendlabs-security-intelligence/category/malware/)\nAuthor:\n[Trend Micro](https://blog.trendmicro.com/trendlabs-security-intelligence/author/trend-micro/)\n\n[0](https://blog.trendmicro.com/trendlabs-security-intelligence/slub-gets-rid-of-github-intensifies-slack-use/#respond)\n\n**_by Cedric Pernet, Elliot Cao, Jaromir Horejsi, Joseph C. Chen, William Gamazo Sanchez_**\n\nFour months ago, we exposed an attack that leveraged a previously unknown malware that Trend Micro\nnamed [SLUB. The past iteration of SLUB spread from a unique watering hole website exploiting CVE-2018-](https://blog.trendmicro.com/trendlabs-security-intelligence/new-slub-backdoor-uses-github-communicates-via-slack/)\n8174, a VBScript engine vulnerability. It used GitHub and Slack as tools for communication between the\nmalware and its controller.\n\nOn July 9, we discovered a new version of SLUB delivered via another unique watering hole website. This\nmalicious site used CVE-2019-0752, an Internet Explorer vulnerability [discovered by Trend Micro’s Zero](https://www.zerodayinitiative.com/blog/2019/5/21/rce-without-native-code-exploitation-of-a-write-what-where-in-internet-explorer)\nDay Initiative (ZDI) that was just [patched this April. This is the first time we found this exploit used in the](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0752)\nwild.\n\nThis new version of the SLUB malware has stopped using GitHub as a way to communicate, heavily using\nSlack instead via two free workspaces. Slack is a collaborative messaging system that lets users create and\nuse their own workspaces through the use of channels, similar to the internet relay chat (IRC) system. Slack\nhas since shut down the relevant Workspaces.\n\nCoincidence or not, both websites that have delivered the SLUB malware are supportive of the North Korean\ngovernment.\n\n**_Infection chain_**\n\nThe SLUB malware was delivered through watering hole websites that were injected with exploits for CVE2018-8174 or CVE-2019-0752. A victim browsing the websites with an unpatched Internet Explorer browser\nwill be infected with a SLUB loader.\n\nListed below are the steps that the exploit script performs to execute the loader. The infection chain is similar\nto the previous iteration of SLUB; however, this version employs different techniques to bypass AV heuristics\nand machine learning algorithms:\n\n\n-----\n\ndll name: mfcm14u.dll) downloaded from watering hole website.\nThe malicious DLL implements export symbols following the Windows Naming Convention and\nuses actual Windows API name: AfxmReleaseManagedReferences. Note that this combination\nof naming conventions could help the attackers to bypass ML algorithms.\n\n_Figure 1. PowerShell script to download and launch SLUB loader_\n\nThe PowerShell script will look at the architecture of the system to check which malicious DLL files should\nbe downloaded. The malicious DLL files are actually the SLUB loader. In case of a x86 system, a 32-bit\nSLUB loader will be downloaded and [CVE-2019-0808, a relatively new vulnerability patched in March, will](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0808)\nbe used. In a x64 system, a 64-bit SLUB loader will be downloaded and [CVE-2019-0803, another new](https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-0803)\nvulnerability patched in April, will be leveraged. Both are exploited for privilege escalation on Windows.\nThen, the loader will check the architecture of the system to decide if it will download and use either the x86\nversion or x64 version of the SLUB malware to infect the victim.\n\nAll the exploits, loaders, and SLUB malware were directly hosted on watering hole websites.\n\n_Figure 2. Infection chain of SLUB malware_\n\n_Fi_ _3 T_ _ffi P tt_ _f SLUB_ _l_ _i f_ _ti_ _h i_\n\n\n-----\n\nSince we published out last report on SLUB, the backdoor has been updated and several improvements were\nimplemented. The most notable change is the complete adoption of Slack as an avenue to organize victim\nmachines and give commands.\n\nHere are the changes in detail:\n\nGithub is not used anymore\nOperator creates a Slack workspace\nEach infected machine joins the workspace, a separate channel named <use_name>-<pc_name> is\ncreated in the workspace\nCommand and control (C&C) communication only uses these Slack channels; if the operator wants to\nexecute a command on an infected machine, he inserts a message to a victim-specific channel and pins\nthis message\nVictim machine reads pinned messages from its dedicated channel, parses the message, and executes\nthe requested command\n\nAside from these changes we also found new information from two Slack tokens we found hardcoded into\nbinary (similar to the previous version).\n\nThese tokens can be used to query the Slack API for some metadata information, such as team info, user list,\nchannel list (which in this case would be the victims). Investigating this information reveals that, at the time\nof this research, the workspace has been active since at least the end of May and one of the users had their\ntime zone set to “Korea Standard Time.”\n\nWhen checking both token response headers, we can see the following difference in OAuth scopes:\n\nC&C token:\n\nNotify token:\n\nThe C&C token contains “admin” in its OAuth scope, which allows it to “administer your workspace.”\n\nIf the operator needs to change these tokens, then he can update them by updating the content of the\ntoni132[.]pen[.]io webpage. The source code of this webpage is parsed for certain keywords: HELLO^,\n_WHAT^, !!!._\n\nIf the desired keywords are found, tokens are parsed out and updated:\n\n\n-----\n\n**_Command communication_**\n\nIn detail, the communication works as follows: If the operator (one of the users from user list) wants to send a\ncommand to the victim, he posts and pins a message onto the corresponding channel. The text value of the\nmessage specifies which command should be executed.\n\nThe example below shows a “capture” command for taking screenshot, pinned to a certain channel by an\noperator.\n\nThe command for listing files in a given directory may look like the following:\n\nAnd listing all files on the victim’s desktop may look like the following:\n\n\n-----\n\nThe victim machine then reads the command, executes it, and (in the case of taking a screenshot) it responds\nby uploading the screenshot and sharing the link to the file. Notice the “upload” value is set to “true.”\n\nOther supported commands are exec, dnexec, capture, file, drive, reg, and tmout, which are similar to the ones\nwe described in our previous post on SLUB. In the case of running a command, the command output results\nare uploaded to file.io, the same as in the previous post.\n\nDuring this attack, we found that the SLUB malware used two Slack teams “sales-yww9809” and\n“marketing-pwx7789.” The workspaces creation time is unknown. Inside team sales-yww9809, it contained\ntwo users, Lomin (lomio8158@cumallover[.]me) and Yolo (yolo1617@cumallover[.]me) who were both\ncreated on the same day (May 23, 2019). Lomin’s timezone was GMT time and mentioned Africa/Monrovia,\nwhile Yolo’s was Korea Standard Time and mentioned Asia/Seoul. The other team, marketing-pwx7789, also\nhas two users named Boshe (boshe3143@firemail[.]cc) and Forth (misforth87u@cock[.]lu). They were also\ncreated on the same day (April 17, 2019). And similar to previous one, Boshe has the timezone set in\nAfrica/Monrovia with GMT while Forth is in Asia/Seoul with Korea Standard Time.\n\nThese email addresses used a free encrypted email service; we could not find additional information on those\nusernames.\n\n**_Conclusion_**\n\nOnce again, this attack shows a professional level when it comes to the OpSec deployed. The constant use of\nonline services like Slack, cock.li, and pen.io makes it harder to track this threat actor.\n\nSimilar to the previous variant, this one has been very discreet and has not been spread at a wide scale. We\ncould not find any other variant anywhere else, nor did we find any other ongoing campaign run by these\nattackers.\n\nWe are once again confident that this attack targets specific individuals visiting that particular watering hole,\nwith surveillance as a highly probable final goal.\n\nIn response to this incident, Slack replied with the following:\n\n_As noted in their previous post, and detailed further in this new post, Trend Micro has discovered, and_\n_is actively tracking, a third party that is attempting to use targeted malware known as SLUB, and_\n_which attempts to use Slack related to this effort. As part of the Trend Micro investigation, we were_\n_made aware of free workspaces being used in this manner. We investigated and immediately shut down_\n_the reported Slack Workspaces as a violation of our terms of service. We confirmed that Slack was not_\n_compromised in any way as part of this incident. We are committed to preventing the misuse of our_\n_platform and we will take action against anyone who violates our terms of service_\n\n[Trend Micro Deep Security customers are protected by the following rules:](https://www.trendmicro.com/en_ph/business/products/hybrid-cloud/deep-security.html)\n\n\n-----\n\n8174)\n1009655-Microsoft Internet Explorer Scripting Engine Memory Corruption Vulnerability (CVE-20190752)\n1009647-Microsoft Windows GDI Elevation Of Privilege Vulnerability (CVE-2019-0803)\n1009582-Microsoft Windows Win32k Elevation Of Privilege Vulnerability (CVE-2019-0808)\n\n**_Indicators of compromise_**\n\n**SHA 256** **Attribution** **Filename**\nAc7d144df013fdd784afec0532b8928c73983eb8edfb72\nCve-2018-8174 Board_main.php\n7f1a184ff2ad1edb67\n\n09a450e31dd9b11f5b1b7b770fef9f361e0aac84c232d4\nCve-2019-0752 Board_main.php\n329e5751f827541f90\n\nThumb\n482a8e66b49372269f204afcd3abca8cc0f73d61b65ccc Slub loader (cve\n403720952_ax14pavm_image1\n\na0981addf17d720f58 2019-0808)\n\n4.jpg\n20c807d48fecbe04672250c37b4585b3433e8e4b6205b Slub loader (cve- 637155112_zlwxf13b_eab192a\ne963e0b36d87c1e68ed 2019-0808) a14.jpg\n\nThumb\nc9933e93cae1261d0f935e1fee95238cb70a776e9689bb Slub loader (cve\n403720952_ax14pavm_image1\n\na9c28a67d9dc74b1f3 2019-0803)\n\n3.jpg\nd118fd11d0d048193f5c3e13773082c2deed203279c96 Slub loader (cve- 637155112_zlwxf13b_eab192a\n1cddc5ed4ba60a75665 2019-0803) a13.jpg\n\nThumb\n4b0650f4ddf3c4e182eea8a0d03fd44d5e76ed1d822839\nSlub malware (x32) 403720952_ax14pavm_image1\n49ddf7cb467495990d\n\n6.jpg\n4ff9f6f67c9f330e6afd32762f3d40ffea8651206c3cf935\nSlub malware (x32) [637155112_zlwxf13b_eab192a]\nfc94e57ef9f34190 a16.jpg\n\nThumb\n5dd2e2d59eb54e4a7b1756ca7a6c1e4ce0551ac793cf87\nSlub malware (x64) 403720952_ax14pavm_image1\n91211c7c81fb644561\n\n5.jpg\nC6352f9940ccf205879fcddfc69b18dfe39272689b859c\nSlub malware (x64) [637155112_zlwxf13b_eab192a]\nad3b5399a8fe37e9a3 a15.jpg\n\n8b576ae94749984fe294b96b77e28b7f5007934da5368\nSlub malware (x64) [637155112_zlwxf13b_eab192a]\n9a37ea09cf7971177a3 a17.jpg\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        }
    ],
    "references": [
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2019/2019.07.16.SLUB/SLUB%20Gets%20Rid%20of%20GitHub%2C%20Intensifies%20Slack%20Use.pdf"
    ],
    "report_names": [
        "SLUB Gets Rid of GitHub, Intensifies Slack Use"
    ],
    "threat_actors": [],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041155,
    "ts_creation_date": 1563516861,
    "ts_modification_date": 1563516861,
    "files": {
        "pdf": "https://archive.orkl.eu/55126780b716d34c5c6008e532a90033d711b9ce.pdf",
        "text": "https://archive.orkl.eu/55126780b716d34c5c6008e532a90033d711b9ce.txt",
        "img": "https://archive.orkl.eu/55126780b716d34c5c6008e532a90033d711b9ce.jpg"
    }
}