{
    "id": "07df5a07-da24-4fb6-a0dd-1f47a1376a08",
    "created_at": "2023-01-12T15:01:04.100353Z",
    "updated_at": "2025-03-27T02:11:51.200805Z",
    "deleted_at": null,
    "sha1_hash": "899bf6c865d159310ca56f236415e9d307d57ab6",
    "title": "2020-12-03 - What did DeathStalker hide between two ferns-",
    "authors": "",
    "file_creation_date": "2022-05-27T23:16:56Z",
    "file_modification_date": "2022-05-27T23:16:56Z",
    "file_size": 1690116,
    "plain_text": "# What did DeathStalker hide between two ferns?\n\n**securelist.com/what-did-deathstalker-hide-between-two-ferns/99616/**\n\nAuthors\n\n[Pierre Delcher](https://securelist.com/author/pierredelcher/)\n\nDeathStalker is a threat actor that’s been active since at least 2012, and we exposed most of their past activities in a\n[previous article, as well as during a GREAT Ideas conference in August 2020. The actor drew our attention in 2018](https://securelist.com/deathstalker-mercenary-triumvirate/98177/)\nbecause of distinctive attack characteristics that didn’t fit in with the usual cybercrime or state-sponsored activities,\nleading us to believe DeathStalker is a hack-for-hire group..\n\nDeathStalker has leveraged several malware strains and delivery chains over the years, from the Python- and\nVisualBasic-based Janicab to the PowerShell-based Powersing and the JavaScript-based Evilnum. The actor\nconsistently used what we call “dead-drop resolvers” (DDRs), which is obfuscated content hosted on major public web\nservices like YouTube, Twitter or Reddit; once decoded by malware this content reveals a command-and-control (C2)\nserver address. DeathStalker also consistently leveraged anti-detection and antivirus evasion techniques, as well as\nintricate delivery chains that drop lots of files to the target’s filesystems. To kick-start an infection, DeathStalker usually\nrelies on spear-phishing emails with attachments, or links to public file sharing services, as well as script execution\nbased on Windows shortcuts. We have identified how DeathStalker’s malware compromises in clusters or targets\nvarious types of entities in all parts of the world, with a possible focus on law and consultancy offices, as well as\nFINTECH companies, but without a clearly identifiable or consistent interest. The targeting does not seem to be\npolitically or strategically defined and doesn’t appear to be the usual financially motived crime. Because of this, we\nconclude that DeathStalker is a cyber-mercenary organization.\n\nWhile tracking DeathStalker’s Powersing-based activities in May 2020, we detected a previously unknown implant that\nleveraged DNS over HTTPS as a C2 channel, as well as parts of its delivery chain. We named this new malware\nPowerPepper. We first spotted a variant of PowerPepper in the wild in mid-July 2020, dropped from a Word document\nthat had been submitted on a public multiscanner service. Since then, the PowerPepper implant and the associated\ndelivery chain has been continuously operating and developing.\n\n\n-----\n\n## Meet PowerPepper: the spicy implant that your bland scripts setup needed\n\n### PowerPepper implant\n\nPowerPepper is a Windows in-memory PowerShell backdoor that can execute remotely sent shell commands. In strict\naccordance with DeathStalker’s traditions, the implant will try to evade detection or sandboxes execution with various\ntricks such as detecting mouse movements, filtering the client’s MAC addresses, and adapting its execution flow\ndepending on detected antivirus products.\n\nThe implant’s C2 logic stands out, as it is based on communications via DNS over HTTPS (DoH), using CloudFlare\nresponders. PowerPepper first tries to leverage Microsoft’s Excel as a Web client to send DoH requests to a C2 server,\nbut will fall back to PowerShell’s standard web client, and ultimately to regular DNS communications, if messages\ncannot get through.\n\nC2 communications content between the implant and servers is encrypted. We noticed that PowerPepper and the\npreviously described Powersing use an almost identical PowerShell implementation of AES encryption, with only the\nAES padding mode and a function input format being changed.\n\n### PowerPepper DNS command and control\n\nPowerPepper regularly polls a C2 server for commands to execute. In order to do so, the implant sends TXT-type DNS\nrequests (with DoH or plain DNS requests if the former fails) to the name servers (NS) that are associated with a\nmalicious C2 domain name. If the target which runs the implant is validated (we cover that later), the server replies with\na DNS response, embedding an encrypted command. Both requests and responses contain patterns that can be easily\ndetected with network intrusion detection systems, but the patterns have been changed across implant variants.\n\nThe command execution results are sent back to the server through a batch of variable-length A-type DNS requests,\nwhere queried hostnames contain an identifier, data length, and encrypted data.\n\nVisual Basic\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n\n# Command result feedback initialization DNS request hostname:\n\n<identifier>.be.0.0.1.0.0.0.0.<domain>\n\n# Command result feedback data slices DNS requests hostnames:\n<identifier>.ef.1.0.1.3.BDA2ADBE3C79C9EF6630.DDD4B8D4504FEC348C9C.2F53BFB60C1890585CF7.<domain>\n<identifier>.ef.2.0.1.3.72DE8DDB802C4829B2DE.40CB7163E83DE0B4A002.6B6C2E555A931721A525.<domain>\n<identifier>.ef.3.0.1.2.1699380DBABAB113D32B.7869501E5FEDD524304B.0.<domain>\n\n# Command result feedback termination DNS request hostname:\n\n<identifier>.ca.4.0.1.00.0.0.0.<domain>\n\n\nDuring the course of our investigations, we noticed that the PowerPepper C2 name servers were actually open DNS\nresolvers that always resolved arbitrary hostnames with the same IP addresses: 128.49.4.4 (a US Navy-owned server),\n91.214.6.100 and 91.214.6.101 (HSBC UK-owned servers). Using this fact and historical reverse DNS resolutions data,\nwe have been able to preemptively identify the PowerPepper C2 domains.\n\n### PowerPepper signaling and target validation\n\nOn top of the DNS C2 communication logic, PowerPepper also signals successful implant startup and execution flow\nerrors to a Python backend, through HTTPS. Such signaling enables target validation and implant execution logging,\nwhile preventing researchers from interacting further with the PowerPepper malicious C2 name servers. It has also\nbeen used directly from some of the malicious documents that were involved in PowerPepper delivery, through the\n[“Links to Files” feature in Office documents.](https://support.microsoft.com/en-us/office/embed-or-link-to-a-file-in-word-8d1a0ffd-956d-4368-887c-b374237b8d3a)\n\nThe signaling Python backends were hosted on a public and legitimate content hosting web service named\nPythonAnywhere that allows users to build websites. The discovered Python backend endpoints were shut down by\n[PythonAnywhere in coordination with us. As a result, DeathStalker tried to adapt the signaling feature by removing it](https://www.pythonanywhere.com/)\nfrom most PowerPepper delivery documents (but keeping it in the implant itself), and by adding a legitimate but\ncompromised WordPress website as a reverse-proxy between implants and backends.\n\n## PowerPepper delivery chains: a surprising journey into mercenary tricks, from Russian dolls to plant-covered steganography\n\n### The macro-based delivery chain: when you are way too much into this whole Russian dolls idea\n\nThe first type of PowerPepper delivery (or infection) chain we encountered, back in July 2020, is based on a malicious\nWord document. Although we couldn’t confirm how this document had been distributed to targets, the infection trails\nand documents we analyzed showed that the item is either embedded as a spear-phishing email body, or downloaded\nfrom a malicious link in a spear-phishing email. This infection chain varied slightly between July and November 2020:\nsome dropped file names, integrated code or remote links changed, but the logic stayed the same.\n\n\n-----\n\nWe won’t dive deep into the details of the delivery workflow, as the main tricks are addressed later. It should, however,\nbe noted that the delivery chain is based on a monolithic document that embeds all required malicious items. Notably,\nthis document contains decoy content, and the malicious logic is handled by Visual Basic for Application (VBA) macros,\nwhich ultimately run PowerPepper and set up its persistence.\n\n### The LNK-based delivery chain: your direct shortcut to spiciness\n\nThis infection chain is based on a Windows shortcut file, with a misleading .docx.lnk double extension, and constitutes a\nmore modular approach to PowerPepper delivery.\n\nThe delivery chain is very similar to the macro-based one, but implements two major changes:\n\nthe malicious macros logic is moved to malicious PowerShell scripts, and the first one is directly embedded in the\nshortcut file, so there are no more VBA macros;\nthe Word document from this chain is just a decoy and malicious files storage pack, and is downloaded from a\nremote location (a public file sharing service) instead of directly embedded somewhere.\n\nThe malicious LNK files were most likely distributed as ZIP attachments within spear-phishing emails and, of course, the\nfiles dropped from this delivery chain differ across variants as well.\n\n\n-----\n\n### A quick look at the decoy contents\n\nSome malicious documents that we managed to retrieve contained a social engineering banner asking users to enable\nmacros execution. This explains how the malicious logic from the macro-based delivery chain could actually be\ntriggered when macros are disabled by default on most modern Office settings.\n\nThe decoy contents we retrieved varied: the first we found in the wild were about carbon emissions regulations, but we\nalso identified a fake travel booking form for a very specific event that’s planned next year in Turkey, and of course\nsome are about the coronavirus.\n\n\n-----\n\nWe were able to link most of the decoy contents back to the original contents published on the internet by their initial\nauthors, meaning DeathStalker did not craft them, but instead picked out appropriate ready-made material that was\navailable on the internet. One of the decoy components impersonated a legitimate travel agent but included altered\ncontact details.\n\n### A compilation of PowerPepper tricks\n\nPowerPepper delivery chains leverage a lot of obfuscation, execution and masquerading tricks to hinder detection, or\ndeceive targets that are curious about what is happening on their computers. So, we thought we should describe some.\n\n**Trick #1: hide things in Word embedded shape properties (and make macro comments fun again)**\n\nDeathStalker hides strings in Word embedded shape and object (OLE packages) properties, like the “hyperlink”\nproperty, to obfuscate the malicious execution workflow, as well as reconstruct and execute commands or scripts.\n\nVisual Basic\n\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n15\n\n16\n\n17\n\n\nbell = \"JohnSnow123\"\n\n…\n\nDocuments.Open FileName:=best & FName, PasswordDocument:=CStr(bell), Visible:=False\n\nDocuments.Item(FName).Activate\n\nWith Application:\n\n.Run \"boat\", belt\n\n…\n\n' this function is totally legit and if you are an av you should totally let us pass\n\nFunction boat(both)\n\n…\n\n' checks if the type is 7\n\nIf .Type = 7 Then\n\n…\n\nIf .OLEFormat.Application = \"Microsoft Word\" And .OLEFormat.ClassType = \"Package\" Then\n\nband = Split(.Hyperlink.Address, \"ps://\")\n\n…\n\nball = ball & band(1)\n\n\nNotably, these properties are leveraged as a second stage PowerShell script in the LNK-based delivery chain: the first\nstage PowerShell script, which is embedded in a malicious LNK file, will parse downloaded Word document contents to\nextract and run a second PowerShell script. These property artifacts can also contain parts of URLs, dropped files\n\n\n-----\n\npaths, or commands that are directly leveraged by macros in the macro based delivery chain.\n\nWe can also see from the code extract above that DeathStalker uses macros to open another subdocument that is\nembedded in the first malicious document from the macro-based delivery chain. Last but not least, the comments are\nvery helpful.\n\n**Trick #2: use Windows Compiled HTML Help (CHM) files as archives for malicious files**\n\nIn the course of their PowerPepper delivery workflows, DeathStalker leverages CHM files as containers to better evade\n[detection, and uses a Windows built-in tool called “hh” to unpack content, from VBA macros or an LNK-embedded](https://docs.microsoft.com/en-gb/previous-versions/windows/desktop/htmlhelp/decompiling-a-help-file)\nPowerShell script.\n\nAll the files that are dropped on targeted computers from delivery chains and that are necessary to run PowerPepper\nare contained in these archives. The CHM files are embedded in the malicious Word (sub)document of the delivery\nchains.\n\n**Trick #3: masquerade and obfuscate persistent files**\n\nDeathStalker uses a Visual Basic Script (VBS) loader to start PowerPepper execution. The loader is launched\nimmediately after delivery, and then at each computer startup, thanks to a companion launcher shortcut which is placed\nin a Windows startup folder.\n\nVisual Basic\n\n\n-----\n\n1\n\n2\n\n3\n\n4\n\n5\n\n6\n\n7\n\n8\n\n9\n\n10\n\n11\n\n12\n\n13\n\n14\n\n\n' Copyright (c) GlobalSign Corporation. All rights reserved.\n\n'\n\n' Abstract:\n\n' licenseverification.vbs - Verify the GlobalSign software\n\n'\n\n' Usage:\n\n' licenseverify [-software]\n\n…\n\nconst L_Help_Help_General05_Text  = \"-a   - add a port\"\n\nconst L_Help_Help_General06_Text  = \"-d   - delete the specified port\"\n\n…\n\nconst L_Help_Help_General34_Text  = \"417079070765161B1C0eeeeeef610520C0F69331…\n\n…\n\nCreateObject(DelPort(L_Text_Msg_Port01_Text)).Run …+DelPort(L_Help_Help_General34_Text & \"7260D3…\n\n\nThis VBS loader masquerades as a GlobalSign verification tool with comments as well as deceptive variables or help\nstrings. Furthermore, the script’s malicious content is obfuscated by a custom encryption function.\n\n**Trick #4: hide your implant between two ferns…**\n\nAnd here come our plants…. The previously described VBS loader will basically do one thing: deobfuscate and run a\nPowerShell script against a picture file that was dropped earlier from the delivery chain.\n\nBut the picture is actually a steganography image (of ferns…) that will be decoded by the VBS loader-embedded script,\nand contains the PowerPepper implant. In the first delivery chains that were discovered, the steganography image\nactually displayed peppers, hence the “PowerPepper” name.\n\n\n-----\n\n**Trick #5: get lost in Windows shell command translation**\n\nThe Windows shortcut (LNK) file from the LNK-based delivery chain actually starts a Windows shell with an obfuscated\ncommand argument. The command is a specific form of a “FOR” Windows shell loop that generates the “PowerShell”\nstring from an “assoc” shell built-in result.\n\nThe malicious LNK file will fire a PowerShell script as a result, which in turn will recompose a second stage script from a\ndownloaded Word document, as seen in Trick #1.\n\n**Trick #6: kick start it all with a signed binary proxy execution**\n\nWhether it’s at the end of macros execution (for the macro-based delivery chain) or as a last step of the shortcutembedded scripts (for the LNK-based delivery chain), DeathStalker leveraged a signed binary proxy execution to start\nup PowerPepper for the first time.\n\nVisual Basic\n\n\n1\n\n2\n\n3\n\n\n$ttss=Join-Path -path $src -ChildPath ('Startup'+[char]92+'StartPrinter.url');\n\nstart-process -filepath 'rundll32.exe' -argumentlist\n\n('ieframe.dll,openurl '.replace('openurl',('o').toupper()+'pen'+('url').toupper())+$ttss)\n\n\nWhile the first (macro-based) delivery chain we retrieved fired the malicious VBS loader with “rundll32.exe\nieadvpack.dll, RegisterOCX wscript.exe <script file> <script argument> pexe”, more recent ones use a “rundll32.exe\nieframe.dll, OpenURL <Internet shortcut>” alternative combo. The very latest rely on a dropped internet shortcut file\n(.url), which simply opens an LNK launcher with a “file://” URL. The LNK launcher in turn runs the VBS loader (see Trick\n#3).\n\n\n-----\n\n## Geography of PowerPepper s targets\n\nWe of course cannot get a comprehensive view of all PowerPepper’s targets, but having tracked this implant since May\n2020, we managed to get a partial view of targeted countries before August 2020, as well as in November 2020.\n\nDue to the very partial information we sometimes get for such research, and despite our efforts to filter as much as we\ncan, we cannot rule out that some identified targets could actually be fellow researchers investigating the threat, or\nDeathStalker’s own testing infrastructure.\n\nWe could not precisely identify PowerPepper targets, but law and consultancy firms have been frequent targets of the\nactor.\n\n## Prevention and protection leads\n\nIn order to prevent successful PowerPepper execution or delivery, or to protect against related infection chains, we\ncould not but underline these standard defense measures:\n\n**Content hosts can regularly scan hosted files for malicious content, where regulations allow. They can protect**\ntheir hosting infrastructure with endpoint protection software and traffic monitoring. They can also stack protection\non privileged and remote access, with client network address filtering, multi-factor authentication (MFA), and\nauditing of authentication logs.\n**Website owners and editors need to frequently and responsively update their CMS backends as well as**\nassociated plugins. They can also stack protection on privileged and remote access, with client network address\nfiltering, MFA and access logging on all backend endpoints.\n**Enterprise IT services need to restrict script engine (i.e., PowerShell) use on end-user computers with enforced**\nexecution policies. They need to set up endpoint protection software on end-user computers and content servers.\nThey should allow DNS requests to corporate-managed resolvers and relays only, while filtering HTTP and DNS\ntraffic at the perimeter. Last but not least, they need to train employees not to open attachments and links in\nemails from unknown senders.\n**Individuals should never open Windows shortcuts that were downloaded from a remote location or attached to an**\nemail, open attachments or click links in emails from unknown senders, or enable macros in documents from\nunverified sources.\n\n## Conclusion\n\nIt only seems fair to write that DeathStalker tried hard to develop evasive, creative and intricate tools with this\nPowerPepper implant and associated delivery chains. There is nothing particularly sophisticated about the techniques\nand tricks that are leveraged, yet the whole toolset has proved to be effective, is pretty well put together, and shows\ndetermined efforts to compromise various targets around the world.\n\n\n-----\n\nThis is consistent with previous knowledge of the DeathStalker actor, which has demonstrated continuous capabilities to\ncompromise targets since 2012, and has been fast to develop new implants and toolchains. We discovered the\nPowerPepper implant in May 2020, and it has been improved or adapted regularly since then. At the same time, we\nalso uncovered another previously unknown malware strain that we strongly believe is from the same actor, though we\nhaven’t identified any Powersing-related activity since our previous article on DeathStalker in August 2020.\n\nThe DeathStalker threat is definitely a cause for concern, with the victimology for its various malware strains showing\nthat any corporation or individual in the world can be targeted by their malicious activities, provided someone has\ndecided they are of interest and passed on the word to the threat actor. Luckily for defenders, DeathStalker has, until\nnow, relied on a rather limited set of techniques to design its delivery chains, and implementing counter-measures is an\nattainable goal for most organizations.\n\n## Indicators of compromise\n\n### File hashes\n\n**IOC** **Description**\n\n[A4DD981606EA0497BF9995F3BC672951](https://opentip.kaspersky.com/A4DD981606EA0497BF9995F3BC672951/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious Word document (macro-based delivery chain)\n\n[871D64D8330D956593545DFFF069194E](https://opentip.kaspersky.com/871D64D8330D956593545DFFF069194E/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious Word document (macro-based delivery chain)\n\n[81147EDFFAF63AE4068008C8235B34AF](https://opentip.kaspersky.com/81147EDFFAF63AE4068008C8235B34AF/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious Windows shortcut (LNK-based delivery chain)\n\n[DFC2486DE9E0339A1B38BB4B9144EA83](https://opentip.kaspersky.com/DFC2486DE9E0339A1B38BB4B9144EA83/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious Word document (downloaded by LNK-based delivery chain)\n\n[74D7DF2505471EADEB1CCFC48A238AEC](https://opentip.kaspersky.com/74D7DF2505471EADEB1CCFC48A238AEC/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious CHM container\n\n[5019E29619469C74F2B826535C5A8BD8](https://opentip.kaspersky.com/5019E29619469C74F2B826535C5A8BD8/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious CHM container\n\n[B4790E70B1297215E0875CFC2A56648E](https://opentip.kaspersky.com/B4790E70B1297215E0875CFC2A56648E/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious CHM container\n\n[3A6099214F474C1501C110CE66033F3C](https://opentip.kaspersky.com/3A6099214F474C1501C110CE66033F3C/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious VBS Loader\n\n[07308FBC3D10FD476F1898ECF6762437](https://opentip.kaspersky.com/07308FBC3D10FD476F1898ECF6762437/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious VBS Loader\n\n[1F77FBE4702F787A713D394B62D27B42](https://opentip.kaspersky.com/1F77FBE4702F787A713D394B62D27B42/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious VBS Loader\n\n[6E99F6DA77B0620E89F6E88D91198C32](https://opentip.kaspersky.com/6E99F6DA77B0620E89F6E88D91198C32/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious VBS Loader\n\n[5D04D246F3E5DA6A9347EC72494D5610](https://opentip.kaspersky.com/5D04D246F3E5DA6A9347EC72494D5610/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious startup launcher LNK\n\n[BA7AE1C73A78D8DC4B3779BD6A151791](https://opentip.kaspersky.com/BA7AE1C73A78D8DC4B3779BD6A151791/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious startup launcher LNK\n\n[1DC2B849A858BC479B1EF428491E0353](https://opentip.kaspersky.com/1DC2B849A858BC479B1EF428491E0353/?utm_source=SL&utm_medium=SL&utm_campaign=SL) Malicious startup launcher LNK\n\n[9D4066C57C6E1602CE33F15DC7F3841B](https://opentip.kaspersky.com/9D4066C57C6E1602CE33F15DC7F3841B/?utm_source=SL&utm_medium=SL&utm_campaign=SL) PowerPepper steganography image (peppers)\n\n[6FF8A3D18A6EA930E87AC364379ECEC2](https://opentip.kaspersky.com/6FF8A3D18A6EA930E87AC364379ECEC2/?utm_source=SL&utm_medium=SL&utm_campaign=SL) PowerPepper steganography image (peppers)\n\n[871D64D8330D956593545DFFF069194E](https://opentip.kaspersky.com/871D64D8330D956593545DFFF069194E/?utm_source=SL&utm_medium=SL&utm_campaign=SL) PowerPepper steganography image (peppers)\n\n[9CE299BBDD7FDBF9F30F8935C89D2877](https://opentip.kaspersky.com/9CE299BBDD7FDBF9F30F8935C89D2877/?utm_source=SL&utm_medium=SL&utm_campaign=SL) PowerPepper steganography image (ferns)\n\n[34F086AE78C5319FB64BF1CAE8204D1B](https://opentip.kaspersky.com/34F086AE78C5319FB64BF1CAE8204D1B/?utm_source=SL&utm_medium=SL&utm_campaign=SL) PowerPepper steganography image (ferns)\n\n### File paths\n\n**IOC** **Description**\n\n%PROGRAMDATA%\\Support\\licenseverification.vbs Malicious VBS Loader\n\n\n-----\n\n%PROGRAMDATA%\\Support\\licenseverify.vbs Malicious VBS Loader\n\n%PROGRAMDATA%\\MyPrinter\\NewFile.vbs Malicious VBS Loader\n\n%PROGRAMDATA%\\Printers\\NewFile.vbs Malicious VBS Loader\n\n%APPDATA %\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\System.lnk Malicious startup launcher\nLNK\n\n%PROGRAMDATA%\\MyPrinter\\Web.lnk Malicious startup launcher\nLNK\n\n%PROGRAMDATA%\\Printers\\Web.lnk Malicious startup launcher\nLNK\n\n\n%APPDATA%\\Roaming\\Microsoft\\Windows\\Start\nMenu\\Programs\\StartUp\\StartPrinter.url\n\n### Domain and IPs\n\n**IOC** **Description**\n\nallmedicalpro[.]com PowerPepper C2 domain name\n\nmediqhealthcare[.]com PowerPepper C2 domain name\n\ngofinancesolutions[.]com PowerPepper C2 domain name\n\n\nMalicious startup launcher\nURL\n\n\nmailsigning.pythonanywhere[.]com PowerPepper Signaling hostname (legitimate host and root domain)\n\nmailsignature.pythonanywhere[.]com PowerPepper Signaling hostname (legitimate host and root domain)\n\nmailservice.pythonanywhere[.]com PowerPepper Signaling hostname (legitimate host and root domain)\n\nmailservices.pythonanywhere[.]com PowerPepper Signaling hostname (legitimate host and root domain)\n\nfootersig.pythonanywhere[.]com PowerPepper Signaling hostname (legitimate host and root domain)\n\nglobalsignature.pythonanywhere[.]com PowerPepper Signaling hostname (legitimate host and root domain)\n\n### URLs\n\n**IOC** **Description**\n\nhxxps://www.gsn-nettoyage[.]com/wp-snapshots/btoken.php PowerPepper Signaling hostname (legitimate but\ncompromised website)\n\n\nhxxps://www.gsn-nettoyage[.]com/wp-snapshots/etoken.php\nhxxps://www.gsn-nettoyage[.]com/wp-snapshots/1.docx\n\nhxxps://www.gsn-nettoyage[.]com/wp-snapshots/Quote 16 db\nroom.docx\n\n\nMalicious documents download location (legitimate\nbut compromised website)\n\n\nhxxps://outlookusers.page[.]link/ Malicious documents download location (legitimate\nhost and root domain)\n\n\nhxxps://1drv[.]ws/w/s!AvXRHBXCKmvYdifkocKujNavvjY?\ne=hhuBV8\n\nhxxps://1drv[.]ws/w/s!AvXRHBXCKmvYdcbz1YwTJRkOxP4?\ne=u5wtbX\n\n\nMalicious document remote location (legitimate host\nand root domain)\n\nMalicious document remote location (legitimate host\nand root domain)\n\n\n-----\n\nhxxps://1drv[.]ws/w/s!AvXRHBXCKmvYd1921tVEMKWaCUs?\ne=MyoVNF\n\nhxxps://1drv[.]ws /w/s!AvXRHBXCKmvYeFdjVtZN0Quljs4?\ne=dnA6GG\n\nhxxps://1drv[.]ws/w/s!AvXRHBXCKmvYeePNerfsAWK0qVY?\ne=e4SsYM\n\nhxxps://1drv[.]ws/w/s!AvXRHBXCKmvYejBpdekg1WUCM9M?\ne=UkhU10\n\nhxxps://1drv[.]ws/w/s!AvXRHBXCKmvYe1ulhtazjNVvCqY?\ne=WptVTC\n\n### Mail addresses\n\n**IOC** **Description**\n\n\nMalicious document remote location (legitimate host\nand root domain)\n\nMalicious document remote location (legitimate host\nand root domain)\n\nMalicious document remote location (legitimate host\nand root domain)\n\nMalicious document remote location (legitimate host\nand root domain)\n\nMalicious document remote location (legitimate host\nand root domain)\n\n\na.christy_inbox@outlook[.]com Suspected malicious spear-phishing email sender (legitimate root domain)\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-03 - What did DeathStalker hide between two ferns-.pdf"
    ],
    "report_names": [
        "2020-12-03 - What did DeathStalker hide between two ferns-.pdf"
    ],
    "threat_actors": [
        {
            "id": "059b16f8-d4e0-4399-9add-18101a2fd298",
            "created_at": "2022-10-25T15:50:23.29434Z",
            "updated_at": "2025-03-27T02:00:55.431907Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Evilnum"
            ],
            "source_name": "MITRE:Evilnum",
            "tools": [
                "More_eggs",
                "EVILNUM",
                "LaZagne"
            ],
            "source_id": "MITRE",
            "reports": null
        },
        {
            "id": "f7aa6029-2b01-4eee-8fe6-287330e087c9",
            "created_at": "2022-10-25T16:07:23.536763Z",
            "updated_at": "2025-03-27T02:02:09.85219Z",
            "deleted_at": null,
            "main_name": "Deceptikons",
            "aliases": [
                "DeathStalker",
                "Deceptikons"
            ],
            "source_name": "ETDA:Deceptikons",
            "tools": [
                "EVILNUM",
                "Evilnum",
                "Janicab",
                "PowerPepper",
                "Powersing",
                "VileRAT"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "39ea99fb-1704-445d-b5cd-81e7c99d6012",
            "created_at": "2022-10-25T16:07:23.601894Z",
            "updated_at": "2025-03-27T02:02:09.882982Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "Jointworm",
                "Operation Phantom in the [Command] Shell",
                "TA4563"
            ],
            "source_name": "ETDA:Evilnum",
            "tools": [
                "Bypass-UAC",
                "Cardinal RAT",
                "ChromeCookiesView",
                "EVILNUM",
                "Evilnum",
                "IronPython",
                "LaZagne",
                "MailPassView",
                "More_eggs",
                "ProduKey",
                "PyVil",
                "PyVil RAT",
                "SONE",
                "SpicyOmelette",
                "StealerOne",
                "Taurus Loader Stealer Module",
                "Taurus Loader TeamViewer Module",
                "Terra Loader",
                "TerraPreter",
                "TerraStealer",
                "TerraTV"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "8ce861d7-7fbd-4d9c-a211-367c118bfdbd",
            "created_at": "2023-01-06T13:46:39.153487Z",
            "updated_at": "2025-03-27T02:00:03.009422Z",
            "deleted_at": null,
            "main_name": "Evilnum",
            "aliases": [
                "TA4563",
                "EvilNum",
                "Jointworm",
                "KNOCKOUT SPIDER",
                "DeathStalker"
            ],
            "source_name": "MISPGALAXY:Evilnum",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535664,
    "ts_updated_at": 1743041511,
    "ts_creation_date": 1653693416,
    "ts_modification_date": 1653693416,
    "files": {
        "pdf": "https://archive.orkl.eu/899bf6c865d159310ca56f236415e9d307d57ab6.pdf",
        "text": "https://archive.orkl.eu/899bf6c865d159310ca56f236415e9d307d57ab6.txt",
        "img": "https://archive.orkl.eu/899bf6c865d159310ca56f236415e9d307d57ab6.jpg"
    }
}