{
    "id": "37a55ea1-27bc-4cb3-adab-01b72e55101c",
    "created_at": "2023-01-12T14:58:51.140517Z",
    "updated_at": "2025-03-27T02:05:49.512067Z",
    "deleted_at": null,
    "sha1_hash": "bfa0d42a160ea25a7b4ad41d71cd4510d7738928",
    "title": "2017-08-31 - Cobian RAT - A backdoored RAT",
    "authors": "",
    "file_creation_date": "2022-05-29T01:36:55Z",
    "file_modification_date": "2022-05-29T01:36:55Z",
    "file_size": 1830042,
    "plain_text": "# Cobian RAT – A backdoored RAT\n\n**zscaler.com/blogs/research/cobian-rat-backdoored-rat**\n\n**Introduction**\n\nThe Zscaler ThreatLabZ research team has been monitoring a new remote access Trojan (RAT) family called Cobian RAT since February\n2017. The RAT builder for this family was first advertised on multiple underground forums where cybercriminals often buy and sell exploit and\nmalware kits. This RAT builder caught our attention as it was being offered for free and had lot of similarities to the njRAT/H-Worm family,\n[which we analyzed in this report.](https://www.zscaler.com/blogs/research/njrat-h-worm-variant-infections-continue-rise)\n\nFigure 1: Cobian RAT command-and-control server application\n\nAs shown in Figure 1, the Cobian RAT control panel and features are similar to that of njRAT and H-Worm. It is noteworthy that the author\nidentified njRAT as the “theme.”\n\n**Crowdsourcing botnet model?**\n\nAs we analyzed the builder, we noticed a particularly interesting function: the builder kit is injected with a backdoor module which retrieves\nC&C information from a predetermined URL (pastebin) that is controlled by the original author. This allows the original author to control the\nsystems infected by the malware payloads that were generated using this backdoored builder kit.\n\n\n-----\n\n[Figure 2 (click to enlarge): Crowdsourced botnet model – Cobian RAT](https://www.zscaler.com/resources/industry-reports/zscaler-cobian-rat-infographic.pdf)\n\nAs shown in Figure 2, the original author of the RAT builder kit is relying on second-level operators to build the RAT payload and spread\ninfections. Then, thanks to the backdoor module, the original author can take full control of infected systems across all the Cobian RAT\nbotnets in which the operators used the backdoored builder kit. The original author can also change the C&C server information configured by\nthe second-level operators.\n\n**Evading detection by malware operator**\n\nDuring our analysis, we observed that when the machine name and username of the systems running the Cobian RAT payload (bot client)\nand the control server (bot C&C server) are the same, the backdoor module will not be activated and no communication will be sent to the\nbackdoor C&C server.\n\nThe original author of the RAT builder is assuming that there will be some testing performed by the second-level operators and that they will\nmostly likely use the same system for both bot client and server applications (C&C server of 127.0.0.1). To hide the presence of the backdoor\nmodule, there will be no traffic generated from the bot client to the backdoor C&C server in this case.\n\n**Recent in-the-wild Cobian RAT payload analysis**\n\nWe saw a unique Cobian RAT payload hit our Cloud Sandbox from a Pakistan-based defense and telecommunication solution website\n(potentially compromised). The executable payload was served inside a ZIP archive and was masquerading as a Microsoft Excel spreadsheet\nusing an embedded icon, as shown in Figure 3.\n\nFigure 3: Cobian RAT payload masquerading as Microsoft Excel spreadsheet file\n\nThe executable payload is signed with an invalid digital certificate pretending to be from VideoLAN (Figure 4), creator of the well-known VLC\nmedia player.\n\n\n-----\n\nFigure 4: Invalid digital certificate pretending to be from VideoLAN\n\nThe executable file is packed using a .NET packer with the encrypted Cobian RAT payload embedded in the resource section. There is a\nseries of anti-debugging checks performed by this dropper payload before decrypting the RAT and installing it on the victim’s system. The\ndecompiled version of the RAT payload can be seen in Figure 5 below:\n\nFigure 5: Cobian RAT — unpacked and decompiled\n\nThe bot’s configuration details are present in Class B’s constructor as shown below:\n\nFigure 6: Bot configuration details\n\n\n-----\n\ne bot atte pts to c eate a U us g t e a ue o a ab e to e su e t at o y o e sta ce o t e bot s u g e bot\nproceed to create a copy of itself as %TEMP%/svchost.exe, execute that file, and terminate itself. The newly executed copy will create an\nautostart registry key to ensure persistence upon system reboot.\n\nThe bot contains many features that are also present in the njRAT, such as:\n\nKeylogger\nScreen capture\nWebcam\nVoice recorder\nFile browser\nRemote command shell\nDynamic plugins\nInstall/Uninstall\n\n**Network C&C activity**\n\nThe bot will spawn two threads in the background, one of which will be responsible for ensuring persistence and taking screenshots. The\nsecond thread will perform a regular check-in with the remote C&C server. The function “Data” is responsible for parsing the C&C server’s\nresponse and executing bot commands on the infected system, which can be seen below:\n\nFigure 7: Bot “Data” function for parsing C&C response\n\nThe C&C server address is stored in the configuration function (Figure 6) as a base64 encoded string. The C&C server for the payload that\nwe analyzed pointed to a dynamic DNS domain, swez111.ddns[.]net:20000. Upon successful connection, the bot sends the following request\nto the C&C server to register the infected system and get further instructions.\n\nEncrypted Data Sent\n\n\n-----\n\nOG | |SG ja 8 U | |O c yQ | | jc 9 b 0 dpb d3 g gU J c b s| | o| | 0 0 |\n|Tm90ZXBhZA==||U0dGamExODRNRFV3TVRZPSxzd2V6MTExLmRkbnMubmV0LDIwMDAwLHN2Y2hvc3QuZXhlLHtKRjJOTVJBTC00NjcxMzgtUU0yVVRZLVFN\n|2017-07-13\n\nDecrypted data:\n\n[LOGIN|-|Hack_805016|-|[email protected]|-|Microsoft Windows XP Professional|-|No|-|1.0.40.7|-|Notepad|-](https://www.zscaler.com/cdn-cgi/l/email-protection)\n|SGFja184MDUwMTY=,swez111.ddns.net,20000,svchost.exe,{JF2NMRAL-467138-QM2UTY-QM2UTYHS87},TEMP,True,True,|-|2017-07-13\n\nPacket Format\n\n[LOGIN|-|BotID|-|[email protected]|-|OS|-|CAM|-|RAT Version|-|Installation Data|-|Infection Date](https://www.zscaler.com/cdn-cgi/l/email-protection)\n\nThe check-in packet includes information about the infected system such as machine name, username, operating system, BotID and\nconfiguration data of the payload installed, and the infection date.\n\nBelow is a complete list of commands that the Cobian RAT supported in the payload we analyzed.\n\n**Command** **Purpose**\n\nLg Keylogger\n\nSvr|-|@ Rename Bot/Campaign ID\n\nSvr|-|! Terminate bot process\n\nSvr|-|# Uninstall Bot\n\nSvr|-|~ Restart Bot\n\nSvr|-|$ Update C&C list\n\nFLD Stress Tester (Flood using UDP or TCP Traffic)\n\nExecute Used to run executable or script from local disk or remote URL\n\nAc Send Active Window Title\n\nSc Send Screen shot\n\nmore|-|FM File Manager\n\nmore|-|SM System Manager\n\nmore|-|CP Remote Desktop\n\nmore|-|CM Remote Webcam\n\nmore|-|MC Microphone\n\nmore|-|NF Information\n\nmore|-|CH Chat\n\nmore|-|PS Password Stealer\n\nmore|-|PT PassTime (Send message box to infected machine)\n\n\n-----\n\nC&C s pac et o at\n\nCommand|-|subcommand|-|subcommand arguments (optional based on command) |-|command data\n\n**Conclusion**\n\nCobian RAT appears to be yet another RAT that is spawned from the leaked njRAT code. It is ironic to see that the second level operators,\nwho are using this kit to spread malware and steal from the end user, are getting duped themselves by the original author. The original author\nis essentially using a crowdsourced model for building a mega Botnet that leverages the second level operators Botnet.\n\nZscaler ThreatLabZ is actively monitoring this threat and will continue to ensure coverage for Zscaler customers.\n\n**Indicators of Compromise**\n\nMD5: 94911666a61beb59d2988c4fc7003e5a\n\nZip File MD5: 7eede7047d3d785db248df0870783637\n\nSource URL: belkomsolutions[.]com/t/guangzhou%20sonicstar%20electronics%20co%20ltd.zip\n\nC&C: swez111.ddns[.]net:20000(173.254.223.81)\n\nFileName: GUANGZHOU SONICSTAR ELECTRONICS CO. LTD.exe\n\nCompilation timestamp: 2017-07-11 03:53:14\n\nDigitaly Signed: Vendor /C=FR/L=Paris/O=VideoLAN/CN=VideoLAN\n\nSigning Date: 11:24 AM 7/14/2017\n\n**Zscaler Cloud Sandbox IOCs**\n\n\n-----\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2017/2017-08-31 - Cobian RAT - A backdoored RAT.pdf"
    ],
    "report_names": [
        "2017-08-31 - Cobian RAT - A backdoored RAT.pdf"
    ],
    "threat_actors": [
        {
            "id": "bee22874-f90e-410b-93f3-a2f9b1c2e695",
            "created_at": "2022-10-25T16:07:23.45097Z",
            "updated_at": "2025-03-27T02:02:09.808919Z",
            "deleted_at": null,
            "main_name": "Chafer",
            "aliases": [
                "APT 39",
                "Cobalt Hickman",
                "ITG07",
                "Radio Serpens",
                "Remix Kitten",
                "TA454"
            ],
            "source_name": "ETDA:Chafer",
            "tools": [
                "ASPXSpy",
                "ASPXTool",
                "Antak",
                "CACHEMONEY",
                "EternalBlue",
                "HTTPTunnel",
                "LOLBAS",
                "LOLBins",
                "Living off the Land",
                "MechaFlounder",
                "Metasploit",
                "Mimikatz",
                "NBTscan",
                "NSSM",
                "Non-sucking Service Manager",
                "POWBAT",
                "Plink",
                "PuTTY Link",
                "Rana",
                "Remcom",
                "Remexi",
                "RemoteCommandExecution",
                "SafetyKatz",
                "UltraVNC",
                "WCE",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "nbtscan",
                "pwdump"
            ],
            "source_id": "ETDA",
            "reports": null
        }
    ],
    "ts_created_at": 1673535531,
    "ts_updated_at": 1743041149,
    "ts_creation_date": 1653788215,
    "ts_modification_date": 1653788215,
    "files": {
        "pdf": "https://archive.orkl.eu/bfa0d42a160ea25a7b4ad41d71cd4510d7738928.pdf",
        "text": "https://archive.orkl.eu/bfa0d42a160ea25a7b4ad41d71cd4510d7738928.txt",
        "img": "https://archive.orkl.eu/bfa0d42a160ea25a7b4ad41d71cd4510d7738928.jpg"
    }
}